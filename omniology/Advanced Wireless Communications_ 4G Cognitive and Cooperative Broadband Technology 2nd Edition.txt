www.allitebooks.com

Advanced Wireless
Communications
4G Cognitive and Cooperative
Broadband Technology
Second Edition
Savo G. Glisic
University of Oulu, Finland
www.allitebooks.com

www.allitebooks.com

Advanced Wireless
Communications
www.allitebooks.com

www.allitebooks.com

Advanced Wireless
Communications
4G Cognitive and Cooperative
Broadband Technology
Second Edition
Savo G. Glisic
University of Oulu, Finland
www.allitebooks.com

Copyright C⃝2007
John Wiley & Sons Ltd, The Atrium, Southern Gate,
Chichester, West Sussex PO19 8SQ, England
Telephone
(+44) 1243 779777
Email (for orders and customer service enquiries): cs-books@wiley.co.uk
Visit our Home Page on www.wiley.com
All Rights Reserved. No part of this publication may be reproduced, stored in a retrieval system
or transmitted in any form or by any means, electronic, mechanical, photocopying, recording,
scanning or otherwise, except under the terms of the Copyright, Designs and Patents Act 1988
or under the terms of a licence issued by the Copyright Licensing Agency Ltd, 90 Tottenham
Court Road, London W1T 4LP, UK, without the permission in writing of the Publisher.
Requests to the Publisher should be addressed to the Permissions Department, John Wiley &
Sons Ltd, The Atrium, Southern Gate, Chichester, West Sussex PO19 8SQ, England, or emailed
to permreq@wiley.co.uk, or faxed to (+44) 1243 770571.
This publication is designed to provide accurate and authoritative information in regard to
the subject matter covered. It is sold on the understanding that the Publisher is not engaged
in rendering professional services. If professional advice or other expert assistance is
required, the services of a competent professional should be sought.
Other Wiley Editorial Ofﬁces
John Wiley & Sons Inc., 111 River Street, Hoboken, NJ 07030, USA
Jossey-Bass, 989 Market Street, San Francisco, CA 94103-1741, USA
Wiley-VCH Verlag GmbH, Boschstr. 12, D-69469 Weinheim, Germany
John Wiley & Sons Australia Ltd, 42 McDougall Street, Milton, Queensland 4064, Australia
John Wiley & Sons (Asia) Pte Ltd, 2 Clementi Loop #02-01, Jin Xing Distripark, Singapore 129809
John Wiley & Sons Canada Ltd, 6045 Freemont Blvd, Mississauga, ONT, L5R 4J3, Canada
Wiley also publishes its books in a variety of electronic formats. Some content that appears
in print may not be available in electronic books.
Anniversary Logo Design: Richard J. Paciﬁco
Library of Congress Cataloging-in-Publication Data
Glisic, Savo G.
Advanced wireless communications : 4G cognitive broadband technology / Savo G. Glisic, 2nd ed.
p. cm.
ISBN 978-0-470-05977-7 (cloth)
1. Wireless communication systems.
I. Title.
TK5103.2.G55 2007
621.384–dc22
2007008848
British Library Cataloguing in Publication Data
A catalogue record for this book is available from the British Library
ISBN 978-0-470-05977-7 (HB)
Typeset in 10/12pt Times by Aptara Inc., New Delhi, India.
Printed and bound in Great Britain by Antony Rowe Ltd, Chippenham, Wiltshire.
This book is printed on acid-free paper responsibly manufactured from sustainable forestry
in which at least two trees are planted for each one used for paper production.
www.allitebooks.com

To my family
www.allitebooks.com

www.allitebooks.com

Contents
Preface to the Second Edition
xxi
1
Fundamentals
1
1.1
4G and the book layout
1
1.2
General Structure of 4G Signals
4
1.2.1
Advanced time division multiple access (ATDMA)
5
1.2.2
Code division multiple access (CDMA)
5
1.2.3
Orthogonal frequency division multiplexing (OFDM)
6
1.2.4
Multicarrier CDMA (MC CDMA)
8
1.2.5
Ultra wide band (UWB) signals
11
References
16
2
Adaptive Coding
21
2.1
Adaptive and reconﬁgurable block coding
21
2.2
Adaptive and reconﬁgurable convolutional codes
26
2.2.1
Punctured convolutional codes/code reconﬁgurability
31
2.2.2
Maximum likelihood decoding/Viterbi algorithm
32
2.2.3
Systematic recursive convolutional codes
33
2.3
Concatenated codes with interleavers
36
2.3.1
The iterative decoding algorithm
37
2.4
Adaptive coding, practice and prospects
43
2.5
Distributed source coding
44
2.5.1
Continuous valued source
46
2.5.2
Scalar quantization and trellis-based coset construction
48
2.5.3
Trellis-based quantization and memoryless
50
2.5.4
Performance examples
50
Appendix 2.1
Maximum a posteriori detection
53
References
56
www.allitebooks.com

viii
CONTENTS
3
Adaptive and Reconﬁgurable Modulation
63
3.1
Coded modulation
63
3.1.1
Euclidean distance
64
3.1.2
Examples of TCM schemes
65
3.1.3
Set partitioning
68
3.1.4
Representation of TCM
70
3.1.5
TCM with multidimensional constellation
70
3.2
Adaptive coded modulation for fading channels
72
3.2.1
Maintaining a ﬁxed distance
73
3.2.2
Information rate
74
References
75
4
Space–Time Coding
79
4.1
Diversity gain
79
4.1.1
Two-branch transmit diversity scheme with
one receiver
80
4.1.2
Two transmitters and M receivers
82
4.2
Space–time coding
84
4.2.1
The system model
84
4.2.2
The case of independent fade coefﬁcients
85
4.2.3
Rayleigh fading
86
4.2.4
Design criteria for Rayleigh space–time codes
86
4.2.5
Code construction
87
4.2.6
Reconﬁguration efﬁciency of space–time coding
91
4.2.7
Delay diversity
94
4.3
space–time block codes from orthogonal designs
96
4.3.1
The channel model and the diversity criterion
96
4.3.2
Real orthogonal designs
97
4.3.3
Space–time encoder
97
4.3.4
The diversity order
97
4.3.5
The decoding algorithm
98
4.3.6
inear processing orthogonal designs
98
4.3.7
Generalized real orthogonal designs
99
4.3.8
Encoding
99
4.3.9
The Alamouti scheme
100
4.3.10 Complex orthogonal designs
100
4.3.11 Generalized complex orthogonal designs
100
4.3.12 Special codes
101
4.3.13 Performance results
102
4.4
Channel estimation imperfections
102
4.4.1
Channel estimator
106
4.5
Quasi-orthogonal space–time block codes
107
4.5.1
Decoding
108
4.5.2
Decision metric
108
4.6
Space–time convolutional codes
109
4.7
Algebraic space–time codes
111
4.7.1
Full spatial diversity
116
4.7.2
QPSK modulation
116

CONTENTS
ix
4.8
Differential space–time modulation
116
4.8.1
The encoding algorithm
122
4.8.2
Differential decoding
123
4.9
Multiple transmit antenna differential detection from generalized
orthogonal designs
125
4.9.1
Differential encoding
126
4.9.2
Received signal
126
4.9.3
Orthogonality
127
4.9.4
Encoding
127
4.9.5
Differential decoding
128
4.9.6
Received signal
129
4.9.7
Demodulation
130
4.9.8
Multiple receive antennas
130
4.9.9
The number of transmit antennas lower than the number
of symbols
130
4.9.10 Final result
131
4.9.11 Real constellation set
131
4.10 Layered space–time coding
133
4.10.1 Receiver complexity
134
4.10.2 Group interference suppression
134
4.10.3 Suppression method
134
4.10.4 The null space
134
4.10.5 Receiver
135
4.10.6 Decision metric
135
4.10.7 Multilayered space–time coded modulation
135
4.10.8 Diversity gain
136
4.10.9 Adaptive reconﬁgurable transmit power allocation
136
4.11 Concatenated space–time block coding
140
4.11.1 System model
140
4.11.2 Product sum distance
141
4.11.3 Error rate bound
141
4.11.4 The case of low SNR
142
4.11.5 Code design
142
4.12 Estimation of MIMO channel
145
4.12.1 System model
146
4.12.2 Training
148
4.12.3 Performance measure
148
4.12.4 Deﬁnitions
148
4.12.5 Channel estimation error
148
4.12.6 Error statistic
149
4.12.7 Results
149
4.13 Space–time codes for frequency selective channels
151
4.13.1 Diversity gain properties
153
4.13.2 Coding gain properties
154
4.13.3 Space–time trellis code design
155
4.14 Optimization of a MIMO system
157
4.14.1 The channel model
157
4.14.2 Gain optimization by singular value decomposition (SVD)
158

x
CONTENTS
4.14.3 The general (M, N) case
159
4.14.4 Gain optimization by iteration for a reciprocal channel
161
4.14.5 Spectral efﬁciency of parallel channels
162
4.14.6 Capacity of the (M, N) array
163
4.15 MIMO systems with constellation rotation
163
4.15.1 System model
163
4.15.2 Performance in a Rayleigh fading channel
165
4.16 Diagonal algebraic space–time block codes
167
4.16.1 System model
167
4.16.2 The DAST coding algorithm
169
4.16.3 The DAST decoding algorithm
170
Appendix 4.1
QR Factorization
173
Appendix 4.2
Lattice code decoder for space–time codes
175
Appendix 4.3
MIMO channel capacity
176
References
180
5
Multiuser Communication
191
5.1
Pseudorandom sequences
191
5.1.1
Binary shift register sequences
191
5.1.2
Properties of binary maximal length sequences
193
5.1.3
Crosscorrelation spectra
193
5.1.4
Maximal connected sets of m-sequences
194
5.1.5
Gold sequences
194
5.1.6
Gold-like and dual-BCH sequences
195
5.1.7
Kasami sequences
196
5.1.8
JPL sequences
197
5.1.9
Kronecker sequences
197
5.1.10 Walsh functions
198
5.1.11 Optimum PN sequences
199
5.1.12 Golay code
199
5.2
Multiuser CDMA receivers
201
5.2.1
Synchronous CDMA channels
202
5.2.2
The decorrelating detector
202
5.2.3
The optimum linear multiuser detector
202
5.2.4
Multistage detection in asynchronous CDMA [43]
203
5.2.5
Non-coherent detector
205
5.2.6
Non-coherent detection in asynchronous multiuser
channels [45]
205
5.2.7
Multiuser detection in frequency non-selective Rayleigh
fading channels
207
5.2.8
Multiuser detection in frequency selective Rayleigh
fading channels
210
5.3
Minimum mean square error (MMSE) linear
multiuser detection
216
5.3.1
System model in multipath fading channels
217
5.3.2
MMSE detector structures
220
5.3.3
Spatial processing
221

CONTENTS
xi
5.4
Single user LMMSE receivers for frequency selective
fading channels
225
5.4.1
Adaptive precombining LMMSE receivers
225
5.4.2
Blind least squares receivers
230
5.4.3
Least squares (LS) receiver
230
5.4.4
Method based on the matrix inversion lemma
231
5.5
Signal subspace-based channel estimation for
CDMA systems
232
5.5.1
Estimating the signal subspace
234
5.5.2
Channel estimation
235
5.6
Iterative receivers for layered space–time coding
236
5.6.1
LST architectures
237
5.6.2
LST receivers
241
5.6.3
QR decomposition/SIC detecor
242
5.6.4
MMSE/SIC detector
244
5.6.5
Iterative LST receivers
246
Appendix 5.1
Linear and matrix algebra
253
Deﬁnitions
253
Special matrices
254
Matrix manipulation and formulas
255
Theorems
257
Eigendecompostion of matrices
257
Calculation of eigenvalues and eigenvectors
258
References
259
6
Channel Estimation and Equalization
269
6.1
Equalization in the digital data transmission system
269
6.1.1
Zero-forcing equalizers
269
6.2
LMS equalizer
275
6.2.1
Signal model
275
6.2.2
Adaptive weight adjustment
276
6.2.3
Automatic systems
276
6.2.4
Iterative algorithm
277
6.2.5
The LMS algorithm
277
6.2.6
Decision feedback equalizer (DFE)
277
6.2.7
Blind equalizers
278
6.3
Detection for a statistically known, time varying channel
279
6.3.1
Signal model
279
6.3.2
Channel model
279
6.3.3
Statistical description of the received sequence
281
6.3.4
The ML sequence (block) estimator for a statistically
known channel
281
6.4
LMS-adaptive MLSE equalization on multipath
fading channels
284
6.4.1
System and channel models
284
6.4.2
Adaptive channel estimator and LMS estimator model
285
6.4.3
The channel prediction algorithm
285

xii
CONTENTS
6.5
Adaptive channel identiﬁcation and data demodulation
288
6.5.1
System model
288
6.5.2
Joint channel and data estimation
288
6.5.3
Data estimation and tracking for a fading channel
292
6.5.4
The static channel environment
293
6.5.5
The time varying channel environment
296
6.6
Turbo equalization
301
6.6.1
Signal format
301
6.6.2
Equivalent discrete time channel model
302
6.6.3
Equivalent system state representations
302
6.6.4
Turbo equalization
302
6.6.5
Viterbi algorithm
303
6.6.6
Iterative implementation of turbo equalization
304
6.6.7
Performance
304
6.7
Kalman Filter based joint channel estimation and data
detection over fading channels
305
6.7.1
Channel model
308
6.7.2
The received signal
308
6.7.3
Channel estimation alternatives
308
6.7.4
Implementing the estimator
309
6.7.5
The Kalman ﬁlter
310
6.7.6
Implementation issues
310
6.8
Equalization using higher order signal statistics
311
6.8.1
Problem statement
311
6.8.2
Signal model
313
6.8.3
Derivation of algorithms for DFE
313
6.8.4
The equalizer coefﬁcients
314
6.8.5
Stochastic gradient DFE adaptive algorithms
315
6.8.6
Convergence analysis
316
6.8.7
Kurtosis-based algorithm
318
6.8.8
Performance results
321
References
321
7
Orthogonal Frequency Division Multiplexing—OFDM
and Multicarrier CDMA
329
7.1
Timing and frequency offset in OFDM
329
7.1.1
Robust frequency and timing synchronization
for OFDM
331
7.2
Fading channel estimation for OFDM systems
334
7.2.1
Statistics of mobile radio channels
334
7.2.2
Diversity receiver
335
7.2.3
MMSE channel estimation
335
7.2.4
FIR channel estimator
337
7.2.5
System performance
338
7.2.6
Reference generation
339
7.3
64 DAPSK and 64 QAM modulated OFDM signals
339

CONTENTS
xiii
7.4
Space–time coding with OFDM signals
344
7.4.1
Signal and channel parameters
345
7.4.2
The wireless asynchronous transfer mode system
349
7.4.3
Space–time coded adaptive modulation for OFDM
349
7.4.4
Turbo and space–time coded adaptive OFDM
349
7.5
Layered space–time coding for MIMO OFDM
351
7.5.1
System model (two times two transmit antennas)
352
7.5.2
Interference cancellation
353
7.5.3
Four transmit antennas
353
7.6
Space–time coded TDMA/OFDM reconﬁguration efﬁciency
356
7.6.1
Frequency selective channel model
356
7.6.2
Front end preﬁlter
357
7.6.3
Time-invariant channel
357
7.6.4
Optimization problem
358
7.6.5
Average channel
358
7.6.6
Preﬁltered M-BCJR equalizer
358
7.6.7
Decision
359
7.6.8
Preﬁltered MLSE/DDFSE equalizer complexity
359
7.6.9
Delayed decision feedback sequence estimation (DDFSE)
360
7.6.10
Equalization schemes for STBC
360
7.6.11
Single-carrier frequency domain equalized space–time
block coding SC FDE STBC
361
7.7
Multicarrier CDMA system
369
7.7.1
Data demodulation
370
7.7.2
Performance examples
371
7.8
Multicarrier DS-CDMA broadcast systems
371
7.9
Frame by frame adaptive rate coded multicarrier DS-CDMA system
375
7.9.1
Transmitter
377
7.9.2
Receiver
378
7.9.3
Rate-compatible punctured convolutional (RCPC) codes
379
7.9.4
Rate adaptation
380
7.10 Intermodulation interference suppression
in Multicarrier CDMA Systems
382
7.10.1
Transmitter
382
7.10.2
Non-linear power ampliﬁer model
383
7.10.3
MMSE receiver
383
7.11 Successive interference cancellation
in Multicarrier DS-CDMA systems
386
7.11.1
System and channel model
386
7.12 MMSE detection of multicarrier CDMA
387
7.12.1
Tracking the fading processes
390
7.13 Approximation of optimum multiuser receiver for space–time coded
multicarrier CDMA systems
393
7.13.1
Frequency selective fading channels
397
7.13.2
Receiver signal model of STBC MC CDMA systems
398
7.13.3
Blind approach
399

xiv
CONTENTS
7.13.4
Bayesian optimal blind receiver
400
7.13.5
Blind Bayesian Monte Carlo multiuser receiver approximation
400
7.13.6
Gibbs sampler
400
7.13.7
Prior distributions
401
7.13.8
Conditional posterior distributions
401
7.13.9
Gibbs multiuser detection
402
7.13.10
Sampling space of data
403
7.13.11
The orthogonality property
403
7.13.12
Blind turbo multiuser receiver
403
7.13.13
Decoder-assisted convergence assessment
404
7.13.14
Performance example
404
7.14 Parallel interference cancellation in OFDM systems in time-varying
multipath fading channels
405
7.15 Zero forcing OFDM equalizer in time-varying multipath
fading channels
411
7.16 Channel estimation for OFDM systems
415
7.17 Turbo processing for an OFDM-based MIMO system
418
7.18 PAPR reduction of OFDM signals
420
Appendix
424
References
425
8
Ultra Wide Band Radio
433
8.1
UWB multiple access in a gaussian channel
433
8.1.1
The multiple access channel
433
8.1.2
Receiver
434
8.2
The UWB channel
436
8.2.1
Energy capture
436
8.2.2
The received signal model
436
8.2.3
The UWB signal propagation experiment 1
436
8.2.4
UWB propagation experiment 2
437
8.2.5
Clustering models for the indoor multipath
propagation channel
438
8.2.6
Path loss modeling
440
8.3
UWB system with M-ary modulation
442
8.3.1
Performance in a Gaussian channel
442
8.3.2
Performance in a dense multipath channel
446
8.3.3
Receiver and BER performance
447
8.3.4
Time variations
447
8.3.5
Performance example
448
8.4
M-ary PPM UWB multiple access
448
8.4.1
M-ary PPM signal sets
451
8.4.2
Performance results
453
8.5
Coded UWB schemes
453
8.5.1
Performance
457
8.5.2
The uncoded system as a coded system with repetition
457
8.6
Multiuser detection in UWB radio
458

CONTENTS
xv
8.7
UWB with space–time processing
460
8.7.1
Signal model
460
8.7.2
The monopulse tracking system
464
8.8
Beamforming for UWB radio
467
8.8.1
Circular array
467
References
492
9
Linear Precoding for MIMO Channels
497
9.1
Space–time precoders and equalizers for MIMO channels
497
9.1.1
ISI modelling in MIMO channels
497
9.1.2
MIMO system precoding and equalization
499
9.1.3
Precoder and equalizer design for
STBC systems
502
9.2
Linear precoding based on convex optimization theory
504
9.2.1
Generalized MIMO systems
505
9.2.2
Convex optimization
506
9.2.3
Precoding for power optimization
507
9.2.4
Precoder for SINR optimization
510
9.2.5
Performance example
512
9.3
Convex optimization-theory-based beamforming
513
9.3.1
Multicarrier MIMO signal model
514
9.3.2
Channel diagonalization
516
9.3.3
Convex optimization-based beamforming
520
9.3.4
Constraints in multicarrier systems
526
9.3.5
Performance examples
527
References
533
10 Cognitive Radio
537
10.1 Energy-efﬁcient cognitive radio
537
10.1.1
Frame length adaptation
537
10.1.2
Frame length adaptation in ﬂat fading channels
539
10.1.3
The adaptation algorithm
542
10.1.4
Energy-efﬁcient adaptive error control
542
10.1.5
Processing gain adaptation
545
10.1.6
Trellis-based processing/adaptive maximum likelihood
sequence equalizer
547
10.1.7
Hidden Markov channel model
548
10.1.8
Link layer performance with inadequate equalization
549
10.1.9
Link layer performance with adequate equalization
551
10.2 A cognitive radio architecture for linear multiuser detection
556
10.2.1
A uniﬁed architecture for linear multiuser detection
and dynamic reconﬁgurability
556
10.2.2
Experimental results
563
10.2.3
The effects of quantization
564
10.2.4
The effect on the ‘near–far’ resistance
565
10.3 Reconﬁgurable ASIC architecture
567

xvi
CONTENTS
10.3.1
Motivation and present art
569
10.3.2
Alternative implementations
570
10.3.3
Example architecture versus an FPGA
570
10.3.4
DSP against the example architecture
571
10.3.5
Computation of a complex 16-point DFT – the Goertzel
FFT mode
571
10.3.6
Fixed coefﬁcient ﬁlters
573
10.3.7
Real FIR/correlator
574
10.3.8
Real IIR/correlator
574
10.3.9
Cascading ﬁxed coefﬁcient ﬁlters
574
10.3.10
Adaptive ﬁltering
574
10.3.11
Direct digital frequency synthesis
576
10.3.12
CORDIC algorithm [83]
577
10.3.13
Discrete Fourier transform
578
10.3.14
Goertzel algorithm
578
References
580
11 Cooperative Diversity in Cognitive Wireless Networks
587
11.1 System modeling
587
11.1.1
System capacity
588
11.1.2
Probability of outage
591
11.1.3
Cellular coverage
592
11.2 Cooperative diversity protocols
593
11.2.1
System and channel models
593
11.2.2
Coperative diversity protocols
594
11.2.3
Outage probabilities
595
11.2.4
Performance bounds for cooperative diversity
598
11.3 Distributed space–time coding
600
11.3.1
System description
600
11.3.2
BER analysis in DSTC
603
11.4 Generalization of distributed space–time-coding based
on cooperative diversity
605
11.4.1
System and channel model
605
11.4.2
Cooperative diversity based on repetition
608
11.4.3
Cooperative diversity using space–time coding
612
Appendix
11.1 Asymptotic CDF approximations
614
Appendix
11.2 Amplify-and-forward mutual information
619
Appendix
11.3 Input distributions for transmit diversity bound
620
References
621
12 Cognitive UWB Communications
625
12.1 Introduction
625
12.2 Signal and interference models
627
12.3 Receiver structure and performance
628
12.3.1
Interference rejection circuit model
629
12.4 Performance examples
635
References
641

CONTENTS
xvii
13 Positioning in Wireless Networks
645
13.1 Mobile station location in cellular networks
645
13.1.1
Introduction
645
13.1.2
MS location estimation using AD and RD measurements
646
13.1.3
The circular, hyperbolic, and mixed multilateration
646
13.1.4
WLS solution of the location problem
648
13.1.5
Accuracy measure
649
13.1.6
Circular multilateration
650
13.1.7
Hyperbolic multilateration
651
13.1.8
Mixed multilateration
652
13.1.9
Performance results for three stations
652
13.1.10
Performance results for N stations
654
13.2 Relative positioning in wireless sensor networks
655
13.2.1
Performance bounds
656
13.2.2
Relative location estimation
659
13.3 Average performance of circular and hyperbolic geolocation
664
13.3.1
Signal models and performance limits
664
13.3.2
Performance of location techniques
666
13.3.3
Average performance of location techniques
667
References
671
14 Channel Modeling and Measurements for 4G
675
14.1 Macrocellular environments (1.8 GHz)
675
14.1.1
PDF of shadow fading
677
14.2 Urban spatial radio channels in macro/microcell (2.154 GHz)
681
14.2.1
Description of environment
682
14.2.2
Results
682
14.3 MIMO channels in microcell and picocell environments
(1.71/2.05 GHz)
688
14.3.1
Simulation of channel coefﬁcients
690
14.3.2
Measurement setups
690
14.3.3
Validation of the stochastic MIMO channel
model assumptions
690
14.3.4
Input parameters to the validation of the MIMO model
692
14.3.5
The eigenanalysis method
693
14.4 Outdoor mobile channel (5.3 GHz)
696
14.4.1
Path loss models
700
14.4.2
Window length for averaging fast fading components
at 5 GHz
702
14.4.3
Spatial and frequency correlations
702
14.4.4
Path number distribution
705
14.4.5
Rotation measurements in an urban environment
706
14.5 Microcell channel (8.45 GHz)
708
14.5.1
Azimuth proﬁle
709
14.5.2
Delay proﬁle for the forward arrival waves
710
14.5.3
Short-term azimuth spread (AS) for forward
arrival waves
712
www.allitebooks.com

xviii
CONTENTS
14.6 Wireless MIMO LAN environments (5.2 GHz)
714
14.6.1
Data evaluation
715
14.6.2
Capacity computation
716
14.6.3
Measurement environments
717
14.7 Indoor WLAN channel (17 GHz)
718
14.8 Indoor WLAN channel (60 GHz)
727
14.8.1
Deﬁnition of the statistical parameters
728
14.9 UWB channel model
732
14.9.1
The large-scale statistics
736
14.9.2
The small-scale statistics
739
14.9.3
Correlation of MPCs among different delay bins
741
14.9.4
The statistical model
741
14.9.5
Simulation steps
742
References
745
15 Adaptive 4G Networks
753
15.1 Adaptive MAC layer
753
15.1.1
Signal variations and the power control problem
755
15.1.2
Spectral efﬁciency and effective load factor of the multirate
DS-CDMA PRN
755
15.1.3
CLSP/DS-CDMA packet access and trafﬁc model
756
15.1.4
Bit rate adaptation
756
15.1.5
The correlated fading model and optimal packet size
758
15.1.6
Performance
760
15.2 Minimum energy peer-to-peer mobile wireless networks
770
15.2.1
Network layer requirements
770
15.2.2
The power consumption model
771
15.2.3
Minimum power networks
772
15.2.4
Distributed network routing protocol
773
15.2.5
Distributed mobile networks
775
15.3 Least resistance routing in wireless networks
778
15.3.1
Least resistance routing (LRR)
778
15.3.2
Multimedia least resistance routing (MLRR)
779
15.3.3
Network performance examples: LRR versus MLRR
780
15.3.4
Sensitivity to the number of allowable word erasures
783
15.4 Power optimal routing in wireless networks for
guaranteed TCP layer QoS
786
15.4.1
Constant end-to-end error rate
786
15.4.2
Optimization problem
788
15.4.3
Error rate models
789
15.4.4
Properties of power optimal paths
790
References
791
16 Cognitive Networks and Game Theory
797
16.1
Cognitive power control
797
16.1.1
Noncooperative power control game
797
16.1.2
Nash equilibrium
799

CONTENTS
xix
16.1.3
Pareto optimality
800
16.1.4
Supermodular games and social optimality
801
16.2
Power control game with QOS guarantee
805
16.3
Power control game and multiuser detection
809
16.4
Power control game in MIMO systems
811
16.5
Game theory based MAC for AD HOC networks
813
16.6
Tit-for-Tat (TFT) game theory based packet forwarding strategies
in AD HOC networks
815
16.6.1
Strategy models
815
16.6.2
Network nodes dependency graph and system metamodel
817
16.6.3
The payoff of iterative game
819
16.7
TFT game theory based modeling of node cooperation
with energy constraint
823
16.7.1
Acceptance rate
823
16.7.2
Pareto optimum
823
16.7.3
Prisoner’s dilemma and TFT game
825
16.8
Packet forwarding model based on dynamic Bayesian games
828
16.9
Game theoretic models for routing in wireless sensor networks
830
16.9.1
Cognitive wireless sensor network model
830
16.9.2
Optimal rout computation
832
16.10
Proﬁt driven routing in cognitive networks
832
16.10.1
Algorithmic mechanism design
832
16.10.2
Proﬁt driven pricing mechanism
833
16.10.3
Truthful behavior in cognitive networks
835
16.10.4
Collusion of nodes in cognitive networks
836
16.11
Game theoretical model of ﬂexible spectra sharing in cognitive
networks with social awareness
838
16.12
A game theoretical modelling of slotted ALOHA protocol
839
16.13
Game-theory-based modeling of admission in competitive
wireless networks
842
16.13.1
System model
842
16.13.2
Equilibrium solutions
845
16.14
Modelling access point pricing as a dynamic game
846
16.14.1
The system model
846
16.14.2
Modelling service reselling
848
16.14.3
File transfer model
848
16.14.4
Bayesian model for unknown trafﬁc
849
References
851
Index
855


Preface to the Second Edition
Wireless communications continue to attract the attention of both the research community
and industry. In the period since the book was published, signiﬁcant research and industry
activities have brought the fourth generation of wireless communications systems closer
to implementation and standardization. Important results for this book, covering the com-
ponents of common air interface, are in the area of space time coding and multicarrier
modulation, especially OFDM. Within OFDM technology, for the application in high mo-
bility environments, the most important problems are channel estimation, synchronization,
and problems related to large peak-to-average power ratio. For this reason some new mate-
rial has been added to Chapters 4 and 7. For the same reason, Chapter 9 is completely new
and covers linear precoding in MIMO channels based on complex optimization theory. The
third important component of common air interface is media access control. This includes
problems of adjacent cell interference, ﬂexible spectra sharing and cooperation between the
nodes in ad hoc networks so new material based on game theory modelling is introduced
in Chapter 16.
This also includes material on cooperative diversity transmission, introduced in Chapter
11, which is an emerging technology that has attracted a lot of interest lately. In addition
to this, the problem of coexistence of different wireless networks is also becoming more
and more important and solutions other than frequency planning and standardizations are
needed. For this reason Chapter 12 is completely replaced and now presents the latest
schemes for interference suppression in ultra wide band (UWB) cognitive systems, like
advanced personal area networks (PAN) and discusses its performance. The schemes can
be used signiﬁcantly to improve performance of UWB systems, e.g. high speed Bluetooth,
in the presence of interference from mobile communication systems such as GSM and
WCDMA. It is also effective in the presence of WLAN systems which are nowadays
based on OFDMA technology (e.g. IEEE802.11, 16e, 20) or military communications
where the interference is generated by intentional jamming. The chapter also discusses the
effectiveness of the scheme to suppress MC CDMA, which is a candidate technology for
4G mobile communications. Chapter 13 is signiﬁcantly modiﬁed to include more details
on positioning. This is the result of anticipation that this technique will be gaining more

xxii
PREFACE TO THE SECOND EDITION
and more space in advanced wireless communications. This is also supported by activities
within the Galileo program in Europe.
In order to keep the book within acceptable limits, a part of the material from the previous
edition has been left out. Most of the material omitted is from the sections on software radio.
It is believed that this choice will make the content of the book more compact.
Savo G. Glisic
Sent Augustine, Florida

1
Fundamentals
1.1
4G AND THE BOOK LAYOUT
Currently the research community and industry in the ﬁeld of telecommunications are considering
possible choices for solutions in the fourth generation (4G) of wireless communications. This chapter
will start with a generic 4G system concept that integrates available advanced technologies and then
focuses on system adaptability and reconﬁgurability as possible options for meeting a variety of
service requirements, available resources and channel conditions. The elements of such a concept can
be found in Refs [1–51]. The chapter will also try to offer a vision beyond the state of the art, with
the emphasis on how advanced technologies can be used for efﬁcient 4G multiple access. Among the
relevant issues the focus will be on:
r adaptive and reconﬁgurable coding and modulation including distributed source coding which is
of interest in data aggregation in wireless sensor networks;
r adaptive and reconﬁgurable space–time coding including a variety of turbo receivers;
r channel estimation and equalization and multiuser detection;
r Orthogonal Frequency Division Multiple Access (OFDMA), Multi Carrier CDMA (MC CDMA)
and Ultra Wide Band (UWB) radio;
r linear precoding in MIMO systems;
r cognitive radio including discussion on strategic difference between macro and micro reconﬁgura-
bility;
r cooperative transmit diversity;
r user location in 4G;
r channel modeling;
r cross-layer optimization including adaptive and power efﬁcient MAC layer design, adaptive and
power efﬁcient routing on IP and TCP layer and concept of green wireless network;
r cognitive networks modeling based on game theory.
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

2
FUNDAMENTALS
PSTN
PLMN
IP Network 
Private
Network
Mobile
Cellular
networks
Mobile
Cellular
Networks
Access
BRAN
Access
Cognitive
Mobile
Terminals
TDMA IS 136
EDGE
UMTS WCDMA
up to 2 MBit/s
cdma2000
4G
MC CDMA
OFDMA
Space−Time
diversity
expected 100 Mbit/s
IEEE 802.11
2.4GHz (ISM)
FHSS & DSSS
5GHz 
WLAN, WPAM, WATM
IEEE 802.xx, WiMAX,
WiBRO
OFDM
Space−time-frequency
coding,  UWB/impulse radio
IEEE 802.15
4G expected data rate 1Gbit/s
Figure 1.1 IMT2000 and WLAN convergence.
Receiver
Pull of
algorithms
Reconfiguration
decision
Network
parameters and
performance
monitoring
QoS
requirements
Figure 1.2 Reconﬁgurable cognitive radio concept intersystem roaming and QoS provi-
sioning.
An important aspect of wireless system design is power consumption. This will be also incorporated
in the chapter including several layers in the network.
At this stage of the evolution of wireless communications there is a tendency to agree that 4G
will integrate mobile communications as speciﬁed by International Mobile Telecommunications
(IMT) standards and Wireless Local Area Networks (WLAN) or in general Broadband Radio Access
Networks (BRAN). The core network will be based on Public Switched Telecommunications Network
(PSTN) and Public Land Mobile Networks (PLMN) based on Internet Protocol (IP) [13, 16, 19, 24,
32, 41, 51]. This concept is summarized in Figure 1.1. Each of the segments of the system will be
further enhanced in the future. The inter-technology roaming of the mobile terminal will be based on
a reconﬁgurable cognitive radio concept presented in its generic form in Figure 1.2.

4G AND THE BOOK LAYOUT
3
The material in this book is organized as follows:
Chapter 1 we start with a general structure of 4G signals, mainly advanced time division multiple
access (ATDMA), code division multiple access (CDMA), orthogonal frequency division multiplex-
ing (OFDM), multicarrier CDMA (MC CDMA) and ultra wide band (UWB) signal. These signals
will be elaborated on later in the book.
Chapter 2 this chapter introduces Adaptive coding. The book has no intention of covering all details
of coding but rather of focusing on those components that enable code adaptability and reconﬁgura-
bility. Within this concept the chapter covers adaptive and reconﬁgurable block and convolutional
codes, punctured convolutional codes/code reconﬁgurability, maximum likelihood decoding/Viterbi
algorithm, systematic recursive convolutional code, concatenated codes with interleaver, the iterative
(turbo) decoding algorithm and a discussion on adaptive coding practice and prospective. The chapter
also includes presentation of distributed source coding, which is of interest in data aggregation in
wireless sensor networks.
Chapter 3 covers adaptive and reconﬁgurable modulation. This includes coded modulation, trellis
coded modulation (TCM) with examples of TCM schemes such as two-, four- and eight-state trellises
and QAM with 3 bits per symbol transmission. The chapter further discusses signal-set partition-
ing, equivalent representation of TCM, TCM with multidimensional constellations, adaptive coded
modulation for fading channels and adaptation to maintain ﬁxed distance in the constellation.
Chapter 4 introduces space–time coding. It starts with a discussion on diversity gain, the encoding
and transmission sequence, the combining scheme and ML decision rule for two-branch transmit
diversity scheme with one and M receivers. In the next step it introduces a general discussion on
space–time coding within a concept of space–time trellis modulation. The discussion is then extended
to introduce space–time block codes from orthogonal design, mainly linear processing orthogonal
designs and generalized real orthogonal designs. The chapter also covers channel estimation im-
perfections. It continuous with quasi-orthogonal space–time block codes, space–time convolutional
codes and algebraic space–time codes. It also includes differential space–time modulation with a
number of examples.
Layered space–time coding and concatenated space–time block coding are also discussed. Es-
timation of MIMO channel and space–time codes for frequency selective channels are discussed
in detail. MIMO system optimization, including gain optimization by singular value decomposition
(svd) are also discussed. This chapter is extended to include a variety of turbo receivers.
Chapter 5 introduces multiuser detection starting with CDMA receivers and signal subspace-based
channel estimation. Then it extends this approach to iterative space time receivers. In Chapter 7 this
approach is extended to OFDM receivers.
Chapter 6 deals with equalization, detection in a statistically known time-varying channel, adaptive
MLSE equalization, adaptive joint channel identiﬁcation and data demodulation, turbo-equalization
Kalman ﬁlter based joint channel estimation and equalization using higher order signal statistics
Chapter 7 covers orthogonal frequency division multiplexing (OFDM) and MC CDMA. The
following topics are discussed: timing and frequency offset in OFDM, fading channel estimation
for OFDM systems, 64-DAPSK and 64-QAM modulated OFDM signals, space–time coding with
OFDM signals, layered space–time coding for MIMO- OFDM, space–time coded TDMA/OFDM
reconﬁguration efﬁciency, multicarrier CDMA system, multicarrier DS-CDMA broadcast systems,
frame-by-frame adaptive rate coded multicarrier DS-CDMA systems, intermodulation interfer-
ence suppression in multicarrier DS-CDMA systems, successive interference cancellation in
multicarrier DS-CDMA systems, MMSE detection of multicarrier CDMA, multiuser receiver for
space–time coded multicarrier CDMA systems, and peak-to-average power ratio (PAPR) problem
mitigation.
Chapter 8 introduces Ultra Wide Band Radio. It covers topics like UWB multiple access in
Gaussian channels, the UWB channel, UWB systems with M-ary modulation, M-ary PPM UWB
multiple access, coded UWB schemes, multiuser detection in UWB radio, UWB with space–time
processing and beamforming for UWB radio.
Chapter 9 covers antenna array signal processing with focus on space–time receivers for
CDMA communications, MUSIC and ESPRIT DOA estimation, joint array combining and MLSE
receivers, joint combiner and channel response estimation, and complexity reduction in wide-band
beamforming.

4
FUNDAMENTALS
Chapter 10 discusses adaptive/reconﬁgurable cognitive radio. The focus is on energy efﬁcient
adaptive radio, frame length adaptation, energy-efﬁcient adaptive error control, processing-gain adap-
tation, trellis based processing/adaptive maximum likelihood sequence equalizer, a software radio
architecture for linear multiuser detection, and reconﬁgurable ASIC architecture.
Chapter 11 introduces cooperative transmit diversity as a power efﬁcient technology to increase
the coverage in multihop wireless networks. It is expected that elements of this approach will be used
in 4G cellular systems too, especially with relaying as a simple case of this approach.
Chapter 12 covers the problem of the coexistence of different wireless networks as it becomes more
and more important, and solutions other than frequency planning and standardization are needed.
For this reason Chapter 12 has been completely replaced and now presents an example of the latest
schemes for interference suppression in ultra wide band (UWB) cognitive systems, like advanced
personal area networks (PAN), and discusses its performance. The schemes can be used signiﬁcantly
to improve performance of UWB systems, e.g. high speed Bluetooth, in the presence of interference
from mobile communication systems such as GSM and WCDMA. It is also effective in the presence
of WLAN systems, which are nowadays based on OFDMA technology (e.g. IEEE802.11, 16e, 20).
The chapter also discusses the effectiveness of the scheme in suppressing MC CDMA, which is a
candidate technology for 4G mobile communications. The effectiveness decreases if the number of
subcarriers is increased.
Chapter 13 is signiﬁcantly modiﬁed to include more details on positioning. This is the result
of the anticipation that this technique will be gaining more and more space in advanced wireless
communications. This is also supported by activities within the Galileo program in Europe.
Chapter 14 discusses channel modeling and measurements for 4G. It includes macrocellular
environments (1.8 GHz), urban spatial radio channels in macro/micro cell (2.154 GHz), MIMO
channels in micro and pico cell environments (1.71/2.05 GHz), outdoor mobile channels (5.3 GHz),
microcell channels (8.45 GHz), wireless MIMO LAN environments (5.2 GHz), indoor WLAN
channels (17 GHz), indoor WLAN channel (60 GHz) and UWB channel models.
Chapter 15 includes discussion on adaptive 4G networks. It covers adaptive MAC layer, minimum
energy routing in pear-to-pear mobile wireless networks, least-resistance routing in wireless networks
and power optimal routing in wireless networks for guaranteed TCP layer QoS.
Chapter 16 represents a signiﬁcant extension of the book to include cognitive networks and models
based on game theory. The following topics are covered:
r cognitive power control as a noncooperative game, including power control games with QoS
guarantee, multiuser detection and MIMO systems;
r game-theory-based MAC for ad hoc networks;
r tit-for-tat (TFT) game-theory-based packet forwarding strategies in ad hoc networks;
r TFT game-theory-based modelling of node cooperation with energy constraints;
r packet forwarding models based on dynamic Bayesian games;
r game theoretic models for routing in wireless sensor networks;
r proﬁt driven routing in cognitive networks;
r game theoretical model of ﬂexible spectra sharing in cognitive networks with social awareness;
r a game theoretical modelling of slotted ALOHA protocol;
r game-theory-based modeling of admission in competitive wireless networks;
r modelling access point pricing as a dynamic game.
1.2
GENERAL STRUCTURE OF 4G SIGNALS
The evolution of the common air interface in wireless communications can be presented as in Table
1.1 The coding and modulation for the 4G air interface are more or less deﬁned but work on a

GENERAL STRUCTURE OF 4G SIGNALS
5
Table 1.1
Evolution of the common air interface in mobile communications
Generation
2G
3G
4G
Coding
Convolutional coding
Turbo coding
Turbo coding and
space–time coding
Modulation
GMSK, BPSK, QPSK
BPSK, QPSK,
mQAM
NmQAM (OFDM)
Multiple access
TDMA
CDMA
IIC MAC
new multiple access scheme still remains to be elaborated. In this section we refer to this solution
as intercell interference coordination (IIC) in the MAC layer (IIC MAC) as a new multiple access
scheme for 4G systems.
In this section we will summarize the signal formats used in existing wireless systems and point
out possible ways of evolution towards the 4G system. The focus will be on OFDMA, MC CDMA
and UWB signals.
1.2.1
Advanced time division multiple access (ATDMA)
In a TDMA system, each user is using a dedicated time slot within a TDMA frame as in GSM (Global
System of Mobile Communications) or in ADC (American Digital Cellular System). Additional data
about the signal format and system capacity are given in [54]. The evolution of the ADC system
resulted in TIA (Telecommunications Industry Association) Universal Wireless Communications
(UWC) Standard 136 [54]. The evolution of GSM resulted in a system known as Enhanced Data rates
for GSM Evolution (EDGE) with parameters summarized also in [54].
1.2.2
Code division multiple access (CDMA)
The CDMA technique is based on spreading the spectra of the relatively narrow information signal
Sn by a code c, generated by much higher clock (chip) rate. Different users are separated by using
different uncorrelated codes. As an example, the narrowband signal in this case can be a PSK signal
of the form
Sn = b(t, Tm) cos ωt
(1.1)
where 1/Tm is the bit rate and b = ±1 is the information. The baseband equivalent of (1.1.) is
Sb
n = b(t, Tm)
(1.1a)
A spreading operation, presented symbolically by operator ε( ), is obtained if we multiply a
narrowband signal by a pseudo noise (PN) sequence (code) c(t, Tc) = ±1. The bits of the sequence
are called chips and the chip rate is 1/Tc ≫1/Tm. The wideband signal can be represented as:
Sw = ε(Sn) = cSn = c(t, Tc)b(t, Tm) cos ωt
(1.2)
The baseband equivalent of (1.2) is
Sb
w = c(t, Tc)b(t, Tm)
(1.2a)
Despreading, represented by operator D(), is performed if we use ε() once again and bandpass
ﬁltering, with the bandwidth proportional to 2/Tm, represented by operator BPF() resulting in
D(Sw) = BPF(ε(Sw)) = BPF(cc b cos ωt) = BPF(c2 b cos ωt) = b cos ωt
(1.3)
The baseband equivalent of (1.3) is
D

Sb
w

= LPF

ε(Sb
w)

= LPF(c(t, Tc)c(t, Tc)b(t, Tm)) = LPF(b(t, Tm) = b(t, Tm)
(1.3a)
www.allitebooks.com

6
FUNDAMENTALS
where LPF() stands for low pass ﬁltering. This approximates the operation of correlating the input
signal with the locally generated replica of the code Cor(c, Sw). Nonsynchronized despreading would
result in
Dτ(); Cor(cτ, Sw) = BPF(ετ(Sw)) = BPF(cτ c b cos ωt) = ρ(τ)b cos ωt
(1.4)
In Equation (1.4) BPF would average out the signal envelope cτc resulting in E(cτc) = ρ(τ). The
baseband equivalent of Equation (1.4) is
Dτ( );
Cor

cτ, Sb
w

=
Tm

0
cτ Sb
w dt = b(t, Tm)
Tm

0
cτc dt = bρ(τ)
(1.4a)
This operation would extract the useful signal b as long as τ ∼= 0, otherwise the signal will be
suppressed because, ρ(τ) ∼= 0 for τ ≥Tc. Separation of multipath components in a RAKE receiver is
based on this effect. In other words if the received signal consists of two delayed replicas of the form
r = Sb
w(t) + Sb
w(t −τ)
the despreading process deﬁned by Equation (1.4a) would result in
Dτ( ); Cor(c,r) =
Tm

0
cr dt = b(t, Tm)
Tm

0
c(c + cτ) dt = bρ(0) + bρ(τ)
Now, if ρ(τ) ∼= 0 for τ ≥Tc, all multipath components reaching the receiver with a delay larger
than the chip interval will be suppressed.
If the signal transmitted by user y is despread in receiver x, the result is
Dxy(); BPF(εxy(Sw)) = BPF(cx cy by cos ωt) = ρxy(t)by cos ωt
(1.5)
So in order to suppress the signals belonging to other users (multiple access interference, MAI), the
crosscorrelation functions should be low. In other words, if the received signal consists of the useful
signal plus the interfering signal from the other user:
r = Sb
wx(t) + Sb
wy(t) = bxcx + bycy
(1.6)
the despreading process at receiver of user x would produce
Dxy();
Cor(cx,r) =
Tm

0
cxr dt = bx
Tm

0
cxcx dt + by
Tm

0
cxcy dt = bxρx(0) + byρxy(0)
(1.7)
When the system is properly synchronized ρx(0) ∼= 1, and if ρxy(0) ∼= 0 the second component
representing MAI will be suppressed. This simple principle is elaborated in the WCDMA standard
resulting in a collection of transport and control channels. The system is based on 3.84 Mcips rate
and up to 2 M bits/s data rate. In a special downlink, high data rate, shared channel, the data rate and
signal format are adaptive. There shall be mandatory support for QPSK and 16QAM and optional
support for 64 QAM based on UE capability which will proportionally increase the data rate. For
details see www.3gpp.com.
1.2.3
Orthogonal frequency division multiplexing (OFDM)
In wireless communications, the channel imposes a limit on data rates in the system. One way to
increase the overall data rate is to split the data stream into a number of parallel channels and use
different subcarriers for each channel. The concept is presented in Figures 1.3 and 1.4 and represents
the basic idea of OFDM system. The overall signal can be represented as
x(t) =
N−1

n=0

Dne j2π n
N fSt
;
−k1
fs
< t < N + k2
fs
(1.8)

GENERAL STRUCTURE OF 4G SIGNALS
7
Gate
Gate
Filter
Mod
Add
Gate
Gate
Filter
Filter
Filter
Mod
Mod
Mod
t
w1
cos
t
w1
sin
t
w2
cos
t
w2
sin
Clock
Clock
Figure 1.3 An early version of OFDM.
f
Figure 1.4 Spectrum overlap in OFDM.
In other words complex data symbols [D0, D1, . . . , DN−1] are mapped in OFDM symbols
[d0, d1, . . . , dN−1] such that
dk =
N−1

n=0
Dne j2π kn
N .
(1.9)
The output of the FFT block at the receiver produces data per channel. This can be represented as
˜Dm = 1
N
N−1

k=0
rke−j2πm k
2N
rk =
N−1

n=0
Hn Dne j2π n
2N k + n (k)
(1.10)
˜Dm =
 Hn Dn + N (n) , n = m
N (n) , n ̸= m
The system block diagram is given in Figure 1.5.
In order to eliminate residual intersymbol interference, a guard interval after each symbol is used
as shown in Figure 1.6.

8
FUNDAMENTALS
Block into N complex numbers
IFFT
Filter
Filter
Sample
Block
Synch
FFT
Unblock
Equalize
Data In
Rate I/T
Rate N/T
Channel
Channel
Data Out
Figure 1.5 Basic OFDM system.
f
1/T
Guard Interval
Figure 1.6 OFDM time and frequency span.
An example of an OFDM signal speciﬁed by IEEE 802.11a standard is shown in Figure 1.7.
The signal parameters are: 64 points FFT, 48 data subcarriers, 4 pilots, 12 virtual subcarriers, DC
component 0, guard interval 800 ns. Discussion on OFDM and an extensive list of references on the
topic are included in Chapter 7.
1.2.4
Multicarrier CDMA (MC CDMA)
Good performance and ﬂexibility to accommodate multimedia trafﬁc are incorporated in MC CDMA
which is obtained by combining CDMA and OFDM signal formats.
Figure 1.8 shows the DS-CDMA transmitter of the j-th user for binary phase shift keying/coherent
detection (CBPSK) scheme and the power spectrum of the transmitted signal, respectively, where
G DS = Tm/Tc denotes the processing gain and C j(t) = [C j
1C j
2 · · · C j
G DS] the spreading code of the
jth user.
Figure 1.9 shows the MC-CDMA transmitter of the jth user for the CBPSK scheme and the
power spectrum of the transmitted signal, respectively, where GMC, denotes the processing gain, NC
the number of subcarriers, and C j(t) = [C j
1C j
2 · · · C j
GMC ] the spreading code of the jth user. The

GENERAL STRUCTURE OF 4G SIGNALS
9
Figure 1.7 802.11a/HIPERLAN OFDM.
Data
stream
Scanning
correlator
Tc
2Tc
Path selector
Rake receiver
Path gain 2
Path gain GDS 
Path gain 1
j 
C  (t)
Combiner
j 
C  (t)
j 
C  (t)
j 
C  (t) 
COS(2πfot)
j 
C2 
j 
CGDS  
j 
C1 
j 
C3
Time
Power spectrum of transmitted signal
f0
Frequency
Time
GDST
LPF
LPF
LPF
Figure 1.8 DS-CDMA scheme.
 
j 
CG
j 
C2
 
j 
C1
 
j 
C3
MC
 
j 
C1 
j 
q1 
j 
q2 
j 
C2 
j 
D
 
Data 
stream
j
a
Time
Copie
cos(2πf1t
Nc=GM
cos(2πfGMCt) 
   
j
a 
Time
   j 
CGMC
   j 
qGMC
Σ
LP
LP
LP
cos(2πf1t
cos(2πf2t
Σ
cos(2πfGMC t)
cos(2πf1t
frequenc
frequency
f1     f2    f3  
Figure 1.9 MC-CDMA scheme.

10
FUNDAMENTALS
cos(2πf1t)
j 
C1 
j 
a1 
j 
a1 
Serial/parallel 
converter 
Σ
j
CGMC
cos(2πf1+(GMC-1)/TS)) 
1:P
Data 
stream 
Frequency 
Nc = P×GMC 
1           2
Figure 1.10 Modiﬁcation of MC-CDMA scheme: spectrum of its transmitted signals.
MC-CDMA scheme is discussed assuming that the number of subcarriers and the processing gain
are all the same.
However, we do not have to choose NC = GMC, and actually, if the original symbol rate is high
enough to become subject to frequency selective fading, the signal needs to be ﬁrst S/P-converted
before spreading over the frequency domain. This is because it is crucial for multicarrier transmission
to have frequency nonselective lading over each subcarrier.
Figure 1.10 shows the modiﬁcation to ensure frequency nonselective fading, where TS denotes
the original symbol duration, and the original data sequence is ﬁrst converted into P parallel seque-
nces, and then each sequence is mapped onto GMC subcarriers (NC = P × GMC).
The multicarrier DS-CDMA transmitter spreads the S/P-converted data streams using a given
spreading code in the time domain so that the resulting spectrum of each subcarrier can satisfy
the orthogonality condition with the minimum frequency separation. This scheme was originally
proposed for an uplink communications channel, because the introduction of OFDM signaling into a
DS-CDMA scheme is effective for the establishment of a quasi-synchronous channel.
Figure 1.11 shows the multicarrier DS-CDMA transmitter of the jth user and the power spectrum
of the transmitted signal, respectively, where GMD denotes the processing gain, NC the number of
subcarriers, and C j(t) = [C j
1C j
2 · · · C j
GMD] the spreading code of the jth user.
The multitone MT-CDMA transmitter spreads the S/P-converted data streams using a given
spreading code in the time domain, so that the spectrum of each subcarrier prior to the spreading
operation can satisfy the orthogonality condition with the minimum frequency separation. Therefore,
the resulting spectrum of each subcarrier no longer satisﬁes the orthogonality condition. The MT-
CDMA scheme uses longer spreading codes in proportion to the number of subcarriers, as compared
with a normal (single carrier) DS-CDMA scheme, therefore, the system can accommodate more users
than can the DS-CDMA scheme.
Figure 1.12 shows the MT-CDMA transmitter of the jth user for CBPSK scheme and the power
spectrum of the transmitted signal, respectively, where GMT denotes the processing gain, NC the
number of subcarriers, and C j(t) = [C j
1C j
2 · · · C j
GMT] the spreading code of the jth user.

GENERAL STRUCTURE OF 4G SIGNALS
11
Data
stream
Time
Serial- 
to-
parallel 
j 
C  (t)
j 
C  (t)
j 
C  (t)
j 
C  (t)
j 
C  (t)
j 
C  (t)
cos(2πf1t)
cos(2πfNct)
Time
Σ
LP
LP
LP
cos(2πf1t)
cos(2πf2t)
cos(2πf2t)
cos(2πfNct)
Parallel-
to-serial
converter
j 
C1
j 
C3
j 
C2
Time
j 
CGMD 
Power spectrum of trasmitted signal
Figure 1.11 Multicarrier DS-CDMA scheme.
GMT
Data 
stream
Time
Serial-
to-parallel
converter
j 
C  (t) 
j 
C  (t) 
j 
C  (t) 
cos(2πf1t)
cos(2πfNct) 
Time 
Σ
cos(2πf1t)
cos(2πf2t)
cos(2πf2t)
cos(2πfNct) 
Parallel 
-to-serial 
converter 
Time
Rake
combiner 1
Rake 
combiner 2
Rake 
combiner Nc
j 
C4
j 
C6
j 
C2
j 
C1
j 
C3 
j 
C5 
j
C7
j 
CGMT 
j 
  = CGDS×Nc 
f1 f2     f3 f4...fNc
Frequency
Figure 1.12 MT-CDMA scheme.
All these schemes will be discussed in detail in Chapter 7.
1.2.5
Ultra wide band (UWB) signals
For the multipath resolution in indoor environments a chip interval of the order of few nanoseconds
is needed. This results in a spread spectrum signal with the bandwidth of the order of few GHz. Such
a signal can also be used with no carrier resulting in what is called impulse radio (IR) or ultra wide
band (UWB) radio. A typical form of the signal used in this case is shown in Figure 1.13. A collection
of pulses received on different locations within the indoor environment is shown in Figure 1.14, and

12
FUNDAMENTALS
t (nanoseconds)
0.1
1
0.8
0.6
0.4
0.2
Received monocycle ωrec (t)
−0.2
−0.4
0.2
0.3
0.4
0.5
0.6
Figure 1.13 A typical ideal received monocycle ωrec (t) at the output of the antenna sub-
system as a function of time in nanoseconds.
−10
−6
−8
−4
−2
0
Time (nanoseconds)
AP17F3
1
0.8
0.6
0.4
0.2
−0.8
−0.6
−0.4
−0.2
2
4
6
8
10
Figure 1.14 A collection of received pulses in different locations [53] c⃝IEEE 2007.
a collection of channel inpulse responses in Figure 1.15. Ultra wide band radio will be discussed in
detail in Chapter 8. In this section we will initially deﬁne only a possible signal format.
A typical time-hopping format used in this case can be represented as
s(k)
tr

t(k)
=
∞

j=−∞
ωtr

t(k) −jT f −c(k)
j Tc −δd(k)
[ j/Ns]
	
(1.11)
where t(k) is the kth transmitter’s clock time and T f is the pulse repetition time. The transmitted pulse
waveform ωtr is referred to as a monocycle. To eliminate collisions due to multiple access, each user
(indexed by k) is assigned a distinctive time shift pattern {c(k)
j } called a time-hopping sequence. This
provides an additional time shift of c(k)
j Tc seconds to the jth monocycle in the pulse train, where
Tc is the duration of addressable time delay bins. For a ﬁxed T f the symbol rate, Rs, determines
the number Ns of monocycles that are modulated by a given binary symbol as Rs =

1/NsT f

s−1.
The modulation index δ is chosen to optimize performance. For performance prediction purposes,
most of the time the data sequence {d(k)
j }∞
j=−∞is modeled as a wide-sense stationary random process
composed of equally likely symbols. For data, a pulse position data modulation is used.

GENERAL STRUCTURE OF 4G SIGNALS
13
Figure 1.15 A collection of channel delay proﬁles [52] c⃝IEEE 2002.
When K users are active in the multiple-access system, the composite received signal at the output
of the receiver’s antenna is modeled as:
r (t) =
K

k=1
Aks(k)
rec (t −τk) + n (t)
(1.12)
The antenna/propagation system modiﬁes the shape of the transmitted monocycle ωtr (t) to ωrec (t)
on its output. An idealized received monocycle shape ωrec(t) for a free-space channel model with no
fading is shown in Figure 1.13.
The optimum receiver for a single bit of a binary modulated impulse radio signal in additive white
Gaussian noise (AWGN) is a correlation receiver
‘decide d(1)
0
= 0’ if
Ns−1

j=0
pulsecorrelatoroutput = α j (u)



 τ1+( j+1)T f
τ1+ jT f
r (u, t) υ

t −τ1 −jT f −c(1)
j Tc
	
dt



teststatistic = α(u)
> 0
(1.13)
where υ (t)
= ωrec (t) −ωrec (t −δ).
The spectra of a signal using TH is shown in Figure 1.16. If instead of TH a DS signal is
used the signal spectra is shown in Figure 1.17(a) for pseudorandom code and Figure 1.17(b) for a
random code. The FCC (Frequency Control Committee) mask for indoor communications is shown
in Figure 1.18. Possible options for UWB signal spectra are given in Figures 1.19 and 1.20 for single
band and Figure 1.21 for multiband signal format. For more details see http://www.uwb.org and
http://www.uwbmultiband.org.
The optimal detection in a multiuser environment, with knowledge of all time-hopping sequences,
leads to complex parallel receiver designs [2]. However, if the number of users is large and no such
multiuser detector is feasible, then it is reasonable to approximate the combined effect of the other
users’ dehopped interfering signals as a Gaussian random process. All details regarding the system
performance will be discussed in Chapter 8.

14
FUNDAMENTALS
0
2
4
6
8
10
12
−70
−60
−50
−40
−30
−20
−10
0
10
Power
(dB)
random TH
Figure 1.16 Spectra of a TH signal.
0
2
4
6
8
10
12
−70
−60
−50
−40
−30
−20
−10
0
10
Frequency (GHz)
pseudo
random DS
Power
(dB)
0
2
4
6
8
−70
−60
−50
−40
−30
−20
−10
0
10
Frequency (GHz)
Power
(dB)
random
DS
(a)
(b)
10
12
Figure 1.17 Spectra of pseudorandom DS and random DS signal.

0
2
4
6
8
10
12
-
-
-
-
-
-
-
-
-
Frequency (GHz)
Power
(dBm)
GPS band
802.11a
802.11b
Figure 1.18 FCC frequency mask.
 
FCC mask  for indoor
Gaussian pulse: 0.36 ns
Gaussian pulse: 0.72 ns
0 
2 
4 
6
8
10
12 
−95  
−90  
−85  
−80  
−75  
−70  
−65  
−60  
−55  
−50  
−45
−40
Frequency (GHz)
Power
(dBm) 
Figure 1.19 FCC mask and possible UWB signal spectra.
0
2
4
6
8
10
12
 
 
 
 
 
 
 
 
 
FCC
mask 
possible spectra
−80
−75
−70
−65
−60
−55
−50
−45
−40
Frequency (GHz)
Power
(dBm) 
Figure 1.20 Single band UWB signal.
www.allitebooks.com

16
FUNDAMENTALS
1
2
3
4
5
6
7
8
9
10
11
12
−55
−50
−45
−40
Frequency (GHz)
Power
(dBm)
Figure 1.21 Multi band UWB signal.
REFERENCES
1. Adachi, F. (2002) Evolution towards broadband wireless systems, The 5th International Sympo-
sium on Wireless Personal Multimedia Communications, 27–30 October 2002. 1, 19–26.
2. Jun-Zhao, Sun, Sauvola, J. and Howie, D. (2001) Features in future: 4G visions from a technical
perspective, IEEE Global Telecommunications Conference, 25–29 November 2001, 6, 3533–
3537.
3. Axiotis, D. I., Lazarakis, F. I., Vlahodimitropoulos, C. and Chatzikonstantinou, A. (2002) 4G
system level simulation parameters for evaluating the interoperability of MTMR in UMTS and
HIPERLAN/2, 4th International Workshop on Mobile and Wireless Communications Networks,
9–11 September 2002, pp. 559–563.
4. Mihovska, A., Wijting, C., Prasad, R., Ponnekanti, S., Awad, Y. and Nakamura, M. (2002) A
novel ﬂexible technology for intelligent base station architecture support for 4G systems. The
5th International Symposium on Wireless Personal Multimedia Communications, 27–30 October
2002. 2, 601–605.
5. Kitazawa, D., Chen, L., Kayama, H. and Umeda, N. (2002) Downlink packet-scheduling consid-
ering transmission power and QoS in CDMA packet cellular systems. 4th International Workshop
on Mobile and Wireless Communications Networks, 9–11 September 2002, pp. 183–187.
6. Dell’Uomo, L. and Scarrone, E. (2002) An all-IP solution for QoS mobility management and AAA
in the 4G mobile networks. The 5th International Symposium on Wireless Personal Multimedia
Communications, 27–30 October 2002. 2, 591–595.
7. Wallenius, E. R. (2002) End-to-end in-band protocol based service quality and transport QoS
control framework for wireless 3/4G services. The 5th International Symposium on Wireless
Personal Multimedia Communications, 27–30 October 2002. 2, 531–533.
8. Benzaid, M., Minet, P. and Al Agha, K. (2002) Integrating fast mobility in the OLSR routing
protocol. 4th International Workshop on Mobile and Wireless Communications Networks, 9–11
September 2002, pp. 217–221.
9. Kambourakis, G., Rouskas, A. and Gritzalis, S. (2002) Using SSL/TLS in authentication and
key agreement procedures of future mobile networks. 4th International Workshop on Mobile and
Wireless Communications Networks, 9–11 September 2002, pp. 152–156.
10. van der Schaar, M. and Meehan, J. (2002) Robust transmission of MPEG-4 scalable video over
4G wireless networks. Proceedings of the 2002 International Conference on Image Processing,
24–28 June 2002. 3, 757–760.

REFERENCES
17
11. Qing-Hui, Zeng, Jian-Ping, Wu, Yi-Lin, Zeng, Ji-Long, Wang and Rong-Hua, Qin (2002)
Research on controlling congestion in wireless mobile Internet via satellite, based on multi-
information and fuzzy identiﬁcation technologies. Proceedings of the 2002 International Con-
ference on Machine Learning and Cybernetics, 4–5 November 2002. 4, 1697–1701.
12. 5th International Symposium on Wireless Personal Multimedia Communications. Proceedings
of (Cat. No. 02EX568), the 5th International Symposium on Wireless Personal Multimedia
Communications, 27–30 October 2002. 1.
13. Sukuvaara, T., Mahonen, P. and Saarinen, T. (1999) Wireless Internet and multimedia services
support through two-layer LMDS system. 1999 IEEE International Workshop on Mobile Multi-
media Communications, (MoMuC ’99) 15–17 November 1999, pp 202–207.
14. Martin, C. C., Winters, J. H. and Sollenberger, N. R. (2000) Multiple-input multiple-output
(MIMO) radio channel measurements. Proceedings of the 2000 IEEE Sensor Array and Multi-
channel Signal Processing Workshop, 16–17 March 2000, pp. 45–46.
15. Pereira, J. M. (2000) Fourth generation: now it is personal! The 11th IEEE International Sympo-
sium on Personal, Indoor and Mobile Radio Communications, (PIMRC 2000) 18–21 September
2000, 2, 1009–1016.
16. Otsu, T., Umeda, N. and Yamao, Y. (2001) System architecture for mobile communications
systems beyond IMT-2000. IEEE Global Telecommunications Conference (GLOBECOM ’01)
25–29 November 2001, 1, 538–542.
17. Yi Han, Zhang, Makrakis, D., Primak, S. and Yun Bo, Huang (2002) Dynamic support of service
differentiation in wireless networks IEEE Canadian Conference on Electrical and Computer
Engineering (CCECE 2002) 12–15 May 2002, 3, 1325–1330.
18. Jun-Zhao, Sun and Sauvola, J. (2002) Mobility and mobility management: a conceptual frame-
work. 10th IEEE International Conference on Networks (ICON 2002) 27–30 August 2002, pp.
205–210.
19. Vassiliou, V., Owen, H. L., Barlow, D. A., Grimminger, J., Huth, H.-P. and Sokol, J. (2002). A radio
access network for next generation wireless networks based on multi-protocol label switching
and hierarchical Mobile IP. Proceedings of IEEE 56th Vehicular Technology Conference, 2002
(VTC 2002) 24–28 September 2002, 2, 782–786.
20. Nicopolitidis, P., Papadimitriou, G. I., Obaidat, M. S. and Pomportsis, A. S. (2002) 3G wireless
systems and beyond: a review. 9th International Conference on Electronics, Circuits and Systems,
15–18 September 2002, 3, 1047–1050.
21. 2002 IEEE Wireless Communications and Networking Conference Record, WCNC 2002 (Cat.
No. 02TH8609), IEEE Wireless Communications and Networking Conference (WCNC2002)
17–21 March 2002, 1.
22. Borras-Chia, J. (2002) Video services over 4G wireless networks: not necessarily streaming.
2002 IEEE Wireless Communications and Networking Conference (WCNC2002) 17–21 March
2002, 1, 18–22.
23. Evans, B. G. and Baughan, K. (2000) Visions of 4G, Electronics and Communication Engineering
Journal, 12(6), 293–303.
24. Kim, J. and Jamalipour, A. (2001) Trafﬁc management and QoS provisioning in future wireless
IP networks. IEEE Personal Communications, (see also IEEE Wireless Communications), 8(5),
46–55.
25. Aghvami, A. H., Le, T. H. and Olaziregi, N. (2001) Mode switching and QoS issues in software
radio. IEEE Personal Communications, (see also IEEE Wireless Communications), 8(5), 38–
44.

18
FUNDAMENTALS
26. Kanter, T. (2001) An open service architecture for adaptive personal mobile communication.
IEEE Personal Communications, (see also IEEE Wireless Communications), 8(6), 8–17.
27. Sampath, H., Talwar, S., Tellado, J., Erceg, V. and Paulraj, A. (2002) A fourth-generation MIMO-
OFDM broadband wireless system: design, performance, and ﬁeld trial results. IEEE Communi-
cations Magazine, 40(9), 143–149.
28. Kellerer, W. and Vogel, H.-J. (2002). A communication gateway for infrastructure-independent
4G wireless access. IEEE Communications Magazine, 40(3), 126–131.
29. Huang, V. and Weihua Zhuang (2002) QoS-oriented access control for 4G mobile multimedia
CDMA communications. IEEE Communications Magazine, 40(3), 118–125.
30. Smulders, P. (2002) Exploiting the 60 GHz band for local wireless multimedia access: prospects
and future directions. IEEE Communications Magazine, 40(1), 140–147.
31. Raivio, Y. (2001) 4G-hype or reality. Second International Conference on 3G Mobile Communi-
cation Technologies (Conf. Publ. No. 477), 26–28 March 2001, pp. 346–350.
32. Becchetti, L., Delli Priscoli, F., Inzerilli, T., Mahonen, P. and Munoz, L. (2001) Enhancing IP
service provision over heterogeneous wireless networks: a path toward 4G. IEEE Communications
Magazine, 39(8), 74–81.
33. Abe, T., Fujii, H. and Tomisato, S. (2002) A hybrid MIMO system using spatial correlation. The
5th International Symposium on Wireless Personal Multimedia Communications, 27–30 October
2002, 3, 1346–1350.
34. Lincke-Salecker, S. and Hood, C. S. (2003) A supernet: engineering trafﬁc across network
boundaries. 36th Annual Simulation Symposium, 30 March–2 April 2003, pp. 117–124.
35. Yamao, Y., Suda, H., Umeda, N. and Nakajima, N. (2000) Radio access network design concept
for the fourth generation mobile communication system. Proceedings of IEEE 51st Vehicular
Technology Conference (VTC 2000) 15–18 May 2000, 3, 2285–2289.
36. Ozturk, E. and Atkin, G. E. (2001) Multi-scale DS-CDMA for 4G wireless systems. IEEE Global
Telecommunications Conference (GLOBECOM ’01) 25–29 November 2001, 6, 3353–3357.
37. Dell’Uomo, L. and Scarrone, E. (2001) The mobility management and authentica-
tion/authorization mechanisms in mobile networks beyond 3G. 12th IEEE International Sympo-
sium on Personal, Indoor and Mobile Radio Communications, 30 September–3 October 2001, 1,
C-44–C-48.
38. Kumar, K. J., Manoj, B. S. and Murthy, C. S. R. (2002) On the use of multiple hops in next
generation cellular architectures. 10th IEEE International Conference on Networks, (ICON 2002)
27–30 August 2002, pp. 283–288.
39. Wang, S. S., Green, M. and Malkawi, M. (2002) Mobile positioning and location services. IEEE
Radio and Wireless Conference (RAWCON 2002) 11–14 August 2002, pp. 9–12.
40. Motegi, M., Kayama, H. and Umeda, N. (2002) Adaptive battery conservation management using
packet QoS classiﬁcations for multimedia mobile packet communications. Proceedings of IEEE
56th Vehicular Technology Conference (VTC 2002) 24–28 September 2002, 2, 834–838.
41. Ying, Li, Shibua, Zhu, Pinyi, Ren and Gang, Hu (2002) Path toward next generation wireless
internet-cellular mobile 4G, WLAN/WPAN and IPv6 backbone. Proceedings of 2002 IEEE Re-
gion 10 Conference on Computers, Communications, Control and Power Engineering (TENCOM
’02) October 28–31 2002, 2, 1146–1149.
42. Qiu, R. C., Wenwu, Zhu and Ya-Qin, Zhang (2002) Third-generation and beyond (3.5G) wireless
networks and its applications. IEEE International Symposium on Circuits and Systems (ISCAS
2002) 26–29 May 2002, 1, I-41–I-44.

REFERENCES
19
43. Bornholdt, C., Sartorius, B., Slovak, J., Mohrle, M., Eggemann, R., Rohde, D. and Grosskopf, G.
(2002) 60 GHz millimeter-wave broadband wireless access demonstrator for the next-generation
mobile internet. Optical Fiber Communication Conference and Exhibit (OFC 2002) 17–22 March
2002, pp. 148–149.
44. Jianhua, He, Zongkai, Yang, Daiqin, Yang, Zuoyin, Tang and Chun Tung, Chou (2002) Inves-
tigation of JPEG2000 image transmission over next generation wireless networks. 5th IEEE
International Conference on High Speed Networks and Multimedia Communications, 3–5 July
2002, pp. 71–77.
45. Baccarelli, E. and Biagi, M. (2003) Error resistant space–time coding for emerging 4G-WLANs.
IEEE Wireless Communications and Networking (WCNC 2003) 16–20 March 2003, 1, 72–77.
46. Mohr, W. (2002) WWRF – the Wireless World Research Forum. Electronics and Communication
Engineering Journal, 14(6), 283–291.
47. Otsu, T., Okajima, I., Umeda, N. and Yamao, Y. (2001) Network architecture for mobile commu-
nications systems beyond IMT-2000. IEEE Personal Communications (see also IEEE Wireless
Communications), 8(5), 31–37.
48. Bria, A., Gessler, F., Queseth, O., Stridh, R., Unbehaun, M., Jiang, Wu, Zander, J. and Flament, M.
(2001) 4th-generation wireless infrastructures: scenarios and research challenges. IEEE Personal
Communications (see also IEEE Wireless Communications), 8(6), 25–31.
49. Fitzek, F., Kopsel, A., Wolisz, A., Krishnam, M. and Reisslein, M. (2002) Providing application-
level QoS in 3G/4G wireless systems: a comprehensive framework based on multirate CDMA.
IEEE Wireless Communications (see also IEEE Personal Communications), 9(2), 42–47.
50. Classon, B., Blankenship, K. and Desai, V. (2002) Channel coding for 4G systems with adaptive
modulation and coding. IEEE Wireless Communications (see also IEEE Personal Communica-
tions), 9(2), 8–13.
51. Yile, Guo and Chaskar, H. (2002) Class-based quality of service over air interfaces in 4G mobile
networks. IEEE Communications Magazine, 40(3), 132–137.
52. Win, M. Z. and Scholtz, R. A. (2002) Characterization of ultra-wide bandwidth wireless indoor
channels: a communication-theoretic view. IEEE Journal on Selected Areas in Communications,
20(9), 1613–1627.
53. Cassioli, D., Win, M. Z. and Molisch, A. F. (2002) The ultra-wide bandwidth indoor channel:
from statistical model to simulations. IEEE Journal on Selected Areas in Communications, 20(6),
1247–1257.
54. Glisic, S. (2004) Advanced Wireless Communications, 4G Technologies, John Wiley & Sons,
Chichester.


2
Adaptive Coding
Channel coding is a well established technical ﬁeld that includes both strong theory and a variety of
practical applications. Both theory and practice are well documented in open literature. In this chapter
we provide a brief review of the basic principles and results in this ﬁeld, with the emphasis on those
parameters which are important for adaptability and reconﬁgurability of coding and decoding algo-
rithms. This is an important characteristic for applications in wireless systems where a strong request
for energy preservation suggests a system operation where quality of service (QoS) is met with min-
imum effort. In an environment with changing propagation conditions, this requires a possibility to
adapt the complexity of the system. This is the focus of the presentation in this chapter and for the con-
ventional details related to channel coding the reader is referred to the classical reference in the ﬁeld.
2.1
ADAPTIVE AND RECONFIGURABLE BLOCK CODING
The simplest way to improve the probability of correct detection of a bit is to repeat the transmission
of the same bit (repetition code) and base the detection of the bit on so-called majority logic. As an
example, if each bit is repeated three times, the decoder will base the decision on the observation of the
three bits. The error will now occur if two or more bits are received incorrectly. This is a simple solution
but rather inefﬁcient from the point of view of bandwidth utilization. The next option is the family of
codes based on the parity check principle. An oversimpliﬁed example is given in Figure 2.1. For every
two input bits u = (u1, u2), a parity check bit, x3 = u1 + u2, is created so that the transmitted bits are x =
(x1, x2, x3) = (u1, u2, x3) as indicated in the ﬁgure. This simple example can be further expanded
to include a number of parity check bits. For a number of input bits k, n −k parity check bits are
generated, resulting in a code word of length n. For this we use the notation (n, k) block codes. The
art of block code construction consists of ﬁnding such parity check rules that would provide the best
error correction capabilities with the minimum amount of redundant bits.
The ratio Rc = k/n is called coding rate. An example of such a code is the Hamming code (7, 4)
shown in Figure 2.2.
The Hamming code (7, 4) is deﬁned by the relations:
xi = ui, i = 1, 2, 3, 4
x5 = u1 + u2 + u3
(2.1)
x6 = u2 + u3 + u4
x7 = u1 + u2 + u4
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

22
ADAPTIVE CODING
000
011
101
110
00
01
10
11
Code words
Data words
n =3
k =2
x1 = u1, x2 = u2, x3 = u1 + u2
x3 x3 x3
u2 u2
+
000
011
101
110
00
01
10
11
Code words
Data words
n =3
k =2
x1 = u1, x2 = u2, x3 = u1 + u2
x3 x3 x3
u2 u2
`
Figure 2.1 Encoder for the parity check code (3, 2).
u4 u3 u2 u1
+
n = 7
k = 2
+
+
x7 x6 x5 x4 x3 x2 x1
u4 u3 u2 u1
+
n = 7
k = 2
+
+
x7 x6 x5 x4 x3 x2 x1
Figure 2.2 Encoder for the Hamming code (7, 4).
The output code words x(x1, x2, x3, x4, x5, x6, x7) for all possible input words u (u1, u2, u3, u4) are
shown in Table 2.1.
One can see from Table 2.1 that out of 2n possible code words, only 2k are used in the encoder.
A collection of these code words is called a code book. The decoder will decide in the favor of the
code word from the code book that is the closest to the given received code word that may contain
a certain number of errors. So, in order to minimize the bit error rate, the art of coding consists of
choosing those code words for the code book that differ from each other as much as possible. This
difference is quantiﬁed by Hamming distance d deﬁned as the number of bit positions where the two
words are different. A number of families of block codes are described in the literature. An example
is cyclic codes, represented by Bose–Chaudhuri–Hocquengham (BCH) codes and its non-binary
subclass known as Reed–Solomon (RS) codes. The RS codes operate with symbols created from
m bits, which are elements in the extension Galois ﬁeld GF(2m) of GF(2). Now, an RS code is
deﬁned as a block of n m-ary symbols deﬁned over GF(2m), constructed from k input information
symbols by adding an n −k = 2t number of redundant symbols from the same extension ﬁeld,
giving an n = k + 2t symbols code word. From now on we will use the notation for such codes:
RS(n, k, t) over GF(2m) or BCH(n, k, t) over GF(2). Such codes can correct t errors. For details of
code construction and detection the reader is referred to the classical literature [1–18].
In the case of burst errors, bit interleaving, illustrated in Figure 2.3, is used. The ﬁgure represents a
scheme for the interpretation of a (75, 25) interleaved code derived from a (15, 5) BCH code. A burst
of length b = 15 is spread into t = 3 error patterns in each of the ﬁve code words of the interleaved
code.
In general, the decoding algorithms can be based on two different options. If a hard decision is
performed for each bit separately and the detected word is compared with the possible candidates
from the code book, the process is referred to as hard decision decoding. For such a decision the

ADAPTIVE AND RECONFIGURABLE BLOCK CODING
23
Table 2.1
Hamming code (7, 4)
Data words
Code words
u(u1, u2, u3, u4)
x(x1, x2, x3, x4, x5, x6, x7)
0000
0000 000
0001
0001 011
0010
0010 110
0011
0011 101
0100
0100 111
0101
0101 100
0110
0110 001
0111
0111 010
1000
1000 101
1001
1001 110
1010
1010 011
1011
1011 000
1100
1100 010
1101
1101 001
1110
1110 100
1111
1111 111
1 
11
 6
16
21
26
31 ···
66
71
2 
12
 7
17
22
27
32 ···
67
72
3 
13
 8
18
23
28
33 ···
68
73
4 
14
 9
19
24
29
34 ···
69
74
5 
10
15
20
25
30
35 ···
70
75
Five code words
Information digits
Parity check digits
Figure 2.3 Interleaving.
probability that a wrong code word is selected is given as [1–18]:
Pw(e) ≤(M −1)

4p(1 −p)
dmin
(2.2)
where M = 2k indicates the number of code words in the code book, assumed to be equally likely,
and dmin is the minimum Hamming distance between the code words. Parameter p represents the
bit error rate. The second option is to create a sum of analog signal samples at bit positions and to
compare this sum (metrics) with the possible values created from the code book. This is referred to
in the literature as soft decision decoding. The code word error rate (WER) in this case is given as
[1–18]:
Pw(e) ≤(M −1)
2
erfc

dminRcEb
N0

(2.3)

24
ADAPTIVE CODING
Pw (e)
1
Hard
decision
Soft decision
Upper bounds
Upper bounds
(different
approximations)
Exact
10−2
10−4
10−6
10−8
Eb /N0 (dB)
4                       6
8                     10                    12
Figure 2.4 Word error probability for the (7, 4) Hamming code: hard decision and soft
decision curves. Binary antipodal transmission.
3              4              5              6              7              8              9             10
(127,64)
(63,30)
(31,16)
(255,123)
(511,259)
Uncoded
(7,4)
(15,7)
10−3
10−4
10−5   
10−2
Pb (e)
Eb/N0  (dB)
Figure 2.5 Bit error probability curves for some BCH codes, with rate Rc of about 0.5.
The word error rate for Hamming code (7,4) is given in Figure 2.4. One can see that soft decision
decoding offers better performance.
If the word error occurs, then for a high signal to noise ratio, the decoder will choose the word
with minimum distance from the correct one. It will make other choices with much lower probability.
As a consequence, the decoded word will contain 2t + 1 errors which can be anywhere in the n-bit
word. So, the bit error probability can be approximated as:
Pb(e) ∼= ((2t + 1)/n)Pw(e)
(2.4)
The bit error rate for some BCH codes is given in Figure 2.5. In general, from the ﬁgure, one can
see that the longer the code the better the performance. One should be aware that this also means
higher complexity. This represents the basis for code adaptability and reconﬁgurability. Figure 2.6
summarizes these results for a broader class of codes.

ADAPTIVE AND RECONFIGURABLE BLOCK CODING
25
Rs /W
(bits/sHz)
antipodal
Uncoded binary
(511, 502,1)
(127. 120,1)
(255,239,2)
(255,215,5)
(255,299,7)
(255,179,10)
(511,259,30)
(255,123,19)
(63,30,6)
(31,16,3)
(15,7,2)
(7,4,1)
(15,11,1)
(31,26,1)
(63,57,1)
(127,120,1)
BSC capacity
Pb (e) =10-6
2
1
Eb/N0 (dB)
0
2
4
6
8
10
12
BCH
Hamming
BCH (n,k,t)
Adaptation/reconfiguration range
Figure 2.6 Performance of different BCH and Hamming codes. Each code is identiﬁed
with three numbers: the block length n, the number of information bits k, and
the number of corrected errors t.
For a Hamming code and available signal to noise ratio in the range Eb/N0 = 9–10 dB, we
can increase the data rate Rs/W approximately by a factor of two if we reconﬁgure the code from
H(7, 4, 1) to H(511, 502, 1). A similar effect can be achieved by reconﬁguration of the BCH codes in
the range (255, 123, 19) to (255, 239, 2) if the available SNR changes in the range 6–8 dB. For a ﬁxed
data rate Rs/W ∼= 1, we can reduce the required SNR for BER = 10−6, from 9.5 to 5.5 dB (coding
gain) by reconﬁguring the BCH code from BCH(15, 7, 2) to BCH(255, 123, 19). The dependence of
power consumption on the code reconﬁguration range will be discussed in Chapter 10.
To relate these tradeoffs analytically we can use Relation (2.5), which represents a bound on
word error probability as a function of coding rate, code length and required signal to noise ratio
represented through bit error rate p.
Pw(e) ≤2−n(R0−Rc), Rc ≤R0
(2.5)
where, for the binary symmetric channel (BSC) with p(0) = p(1) = 1/2,
R0 = 1 −log2

1 + 2

p(1 −p)

(2.6)
These relations are illustrated in Figure 2.7.
Finally, adaptation/reconﬁguration efﬁciency is deﬁned as:
Eff =
−SNR
rcomplexity
=
coding gain
relative increase in complexity = 10gc(dB)/10
Dr
(2.7)
This parameter will be used throughout the book to compare different schemes.
www.allitebooks.com

26
ADAPTIVE CODING
Rc
Eb/N0 (dB)
6
0
0.2
0.4
0.6
0.8
Hard decisions
Eight-level
soft decisions
Unquantized
Channel capacity
4
2
0
−2
Figure 2.7 Cutoff rate-based bounds on the required signal to noise ratio as a function of
the code rate Rc for hard and soft decisions and binary antipodal modulation
over the AWGN channel.
2.2
ADAPTIVE AND RECONFIGURABLE CONVOLUTIONAL CODES
In order to further increase the coding gain, a new class of codes, known as convolutional codes, is
used [18–45]. A general block diagram of a convolutional encoder in serial form for an (n0, k0) code
with constraint length N is given in Figure 2.8. N blocks, k0 bits each, are used to produce a code
word n0 bits long. For every new input block a new code word is generated.
+
+
+
+
1
2
. . . . .
n0
u
x
1
2
...
k0
1
2
...
k0
1
2
...
k0
1
2
...
k0
. . . . .
1
2
N
+
+
+
+
. . . . .
u
1
2
...
1
2
...
k0
1
2
...
1
2
...
. . . . .
Figure 2.8 Convolutional encoder.

ADAPTIVE AND RECONFIGURABLE CONVOLUTIONAL CODES
27
u
ui-1
ui-2
u
u
i
+
+
+
+
x = (111100010110100...).
(a)
(b)
x
x
+
+
U = (11011...)
ui
ui-1
ui-2
u
ui-1
ui-2
i
+
+
+
+
(111100010110100...).
(a)
(b)
x
x
+
+
(11011...)
ui
ui-1
ui-2
Figure 2.9 Two equivalent schemes for the convolutional encoder of the (3, 1, 3) code.
One can show that the encoder output can be represented as:
x = uG∞
(2.8)
where
G∞=


G1
G2
· · ·
G N
G1
G2
· · ·
G N
G1
G2
· · ·
G N
G1
G2
· · ·
G N
· · ·
· · ·
· · · ·
· · · · ·


(2.9)
Submatrices Gi, containing k0 rows and n0 columns, deﬁne connectivity of the ith block of the
input register with n0 elements of the output register. In the notation, ‘1’ means a connection and ‘0’
no connection.
We will use the following notation: code rate Rc = k0/n0, memory ν = (N −1)k0 and such a
code will be denoted as an (n0, k0, N) convolutional code. An example of the encoder for k0 = 1 is
shown in Figure 2.9.
For the example in Fig. 2.9(a) we have:
G1 =
 1
1
1 
G2 =
 0
1
1 
(2.10)
G3 =
 0
0
1 
An equivalent representation is shown in Figure 2.9(b). For this representation we use notation that
might be more convenient:
G =


g1,1
· · ·
g1,n0
...
gk0,1
· · ·
gk0,n0


(2.11)
with
g1,1 = (100)
g1,2 = (110) octal numbers(110 →6)
(2.12)
g1,3 = (111)

28
ADAPTIVE CODING
+
+
x (111010100110...)
+
u
U = (11011...)
u1,i
u2,i
u1,i-1 u2,i-1
+
+
+
u
(11011...)
u1,i
u2,i
u1,i-1 u2,i-1
=
Figure 2.10 Convolutional encoder for the (3, 2, 2) code.
+
+
u1
u1,i-1
u1,i
u1,i
u
u2,i
u2
u2,i-
1
x
+
+
u1
u1,i-1
u1,i
u1,i
u
u2,i
u2
u2,i-
1
x
Figure 2.11 Parallel implementation of the same convolutional encoder shown in Fig-
ure 2.10.
An example for k0 = 2 is shown in Figure 2.10. In this case we have:
G1 =
 1
0
1
0
1
0

G2 =
 0
0
1
0
0
1

(2.13)
One can show that the same encoder can be implemented in parallel form, as shown in Figure
2.11. The N general equivalent parallel presentation is shown in Figure 2.12, and two more examples
are shown in Figures 2.13 and 2.14.
For the encoder from Figure 2.9 one can verify, and then generalize for any encoder with arbitrary
n0 and k0 = 1, that, for each input digit ui, n0 digits will be generated in accordance with:
(xi1, xi2, xi3, . . . , xin0) = uiG1 + ui−1G2 + ui−3G3 + · · · + ui−N+1GN
=
N

k=1
ui−N+1GN
(2.14)
This relation has the form of convolution, hence the name convolutional coding.
For an efﬁcient insight into the operation of the encoder, a state diagram, illustrated in Figure
2.15, is used.

Serial
To
Parallel
Parallel
To
Serial
u
u1
1
2
3
• • •
1
2
3
• • •
+
+
x1
x
0
ku
0
nx
N1
• • • •
• • • •
0
k
N
Serial
to
Parallel
Parallel
to
Serial
u
u1
1
2
3
• • •
1
2
3
• • •
+
+
x1
x
0
ku
0
nx
N1
• • • •
• • • •
0
k
N
Figure 2.12 General block diagram of a convolutional encoder in parallel form for an
(n0, k0, N) code.
X
Figure 2.13 Encoder for the (2, 1, 4) convolutional code.
u
u1
u1,i
u1,i-1
x1
x2
u2
u2,i
u2,i-2
x3
x
u
u1
u1,i
u1,i-1
x1
x2
u2
u2,i
u2,i-2
x3
x
Figure 2.14 Encoder for the (3, 2, 2) convolutional code.
S1=(00)
S2=(01)
S3=(10)
S4=(11)
)
,
(
2
1
−
−
=
lu
u
σ
111
001
110
011
100
010
S1
S3
S2
S4
1
2
3
4
1
1
2
3
4
1
S1
S3
S2
S4
ℓ
ℓ
Figure 2.15 State diagram for the (3, 1, 3) convolutional code.

30
ADAPTIVE CODING
000
000
000
000
S1
S3
S2
S4
111
111
111
111
001
001
011
011
011
110
110
100
010
100
100
010
101
101
σ
3
ℓ=
0
ℓ=
1
ℓ=
2
ℓ=
4
ℓ=
ℓ
Figure 2.16 Trellis diagram for the (3, 1, 3) convolutional code. The boldface path corre-
sponds to the input sequence 1101.
The (3, 1, 3) encoder, from Figure 2.9, has memory ν = N −1 = 2. We deﬁne the state σl of the
encoder at discrete time l as the content of its memory at the same time, σl ˆ= (ul−1, ul−2). There are
Nσ = 2ν = 4 possible states. That is, 00, 01, 10 and 11.
A solid arrow (edge) on Figure 2.15, represents a transition between two states forced by the input
digit ‘0,’ whereas a dashed arrow (edge) represents a transition forced by the input digit ‘1.’ The label
on each arrow represents the output digits corresponding to that transition. As an example we have:
u = (
1
1
0
1
1 . . .)
path S1 →S3 →S4 →S2 →S3 →S4 . . .
x = (
111
100
010
110
100 . . .
)
(2.15)
The concept of a state diagram can be applied to any (n0, k0, N) code with memory ν. The number
of states is Nσ = 2ν. There are 2k0 edges entering each state and 2k0 edges leaving each state. The
labels on each edge are sequences of length n0. The equivalent representations using a trellis diagram
or tree diagram are shown in Figure 2.16 and Figure 2.17 respectively.
An appropriate measure of the maximum likelihood decoder complexity for a convolutional code
is the number of visited edges per decoded bit. Now, a rate k0/n0 code has 2k0 edges leaving and
entering each trellis state and a number of states Nσ = 2ν, where ν is the memory of the encoder.
Thus, each trellis section, corresponding to k0 input bits, has a total number of edges equal to 2k0+ν.
As a consequence, an (n0, k0, N) code has a decoding complexity:
D = 2k0+ν
k0
(2.16)
Reconﬁguration from code 1 to code 2 can offer the coding gain g12. This process will, in general,
increase the complexity from D1 to D2 resulting in:
Dr = D2/D1 = k01
k02
2(k02−k01)+(ν2−ν1)
= k01
k02
2k0+ν = k01
k02
2(k0+ν) = k01
k02
2(k0 N)
(2.17)
where  should be used as an operator. Equation (2.7) deﬁning the reconﬁguration efﬁciency now
becomes:
Eﬀ= 10g12/10 k02
k01
2−(k0+ν)
(2.18)

ADAPTIVE AND RECONFIGURABLE CONVOLUTIONAL CODES
31
000
111
000
111
011
100
S1
S3
S1
000
011
100
001
110
010
101
S2
S4
S3
111
000
S1
001
110
000
111
011
100
S1
S3
S2
011
010
101
010
101
001
110
S2
S4
S4
100
111
S3
S1
0
1
011
100
S3
S4
Figure 2.17 Tree diagram for the (3, 1, 3) convolutional code. The boldface path corre-
sponds to the input sequence 11011.
The maximum value of Dr will be referred to as the reconﬁguration range and the maximum value
of the gain g12 as the adaptation range.
2.2.1
Punctured convolutional codes/code reconﬁgurability
The increase of complexity inherent in passing from rate l/n0 to rate k0/n0 codes can be mitigated
using so-called punctured convolutional codes. A rate k0/n0 punctured convolutional code can be
obtained by starting from a rate l/n0 and deleting parity check symbols. An example is given in
Figure 2.18.
Suppose now, that for every four parity check digits generated by the encoder, one (the last) is
punctured, i.e. not transmitted. In this case, for every two input bits, three bits are generated by the
encoder, thus producing a rate 2/3 code. The equivalent representation of the encoder is shown in
Figure 2.19.
For more details, see [18, 46–48].
From the previous example, we can derive the conclusion that a rate k0/n0 convolutional code
can be obtained considering k0 trellis sections of a rate 1/2 mother code. Measuring the decoding
complexity as before for the punctured code we have:
Dpunc = k02ν+1
k0
so that the ratio between the case of the unpunctured to the punctured solution yields:
Dr =
D
Dpunc
= 2k0
2k0

32
ADAPTIVE CODING
00
00
S1
S3
S2
S4
11
11
10
10
11
01
01
01
01
10
10
00
00
11
(b)
00
0x
S1
S3
S2
S4
11
1x
10
1x
1x
01
01
0x
0x
10
1x
00
0x
11
(c)
+
+
x
u = 101101...
(a)
x = 111000010100
x = 111000010
11
+
+
=
= 1
=
Figure 2.18 Encoder (a) and trellis (b) for a (2, 1, 3) convolutional code. The trellis (c)
refers to the rate 2/3 punctured code.
S1
S2
S3
S4
110
111
000
110
111
000
101
011
011
010
001
100
001
110
100
010
101
(b)
+
+
+
u1
u1,i
u1,i-1
u
u2
u2,i
u2,i-1
x
(a)
1
100
001
+
+
+
u1
i
Figure 2.19 Encoder (a) and trellis (b) for the (3, 2, 3) convolutional code equivalent to the
rate 2/3 punctured code described.
which shows that, for k0 > 2, there is an increasing complexity reduction. Unfortunately, in general,
this would also reduce coding gain with respect to the mother code so that the relative increase in the
reconﬁguration efﬁciency can be represented as:
Eﬀ= Dr10g12/10
(2.19)
where g12 is negative.
2.2.2
Maximum likelihood decoding/Viterbi algorithm
The maximum likelihood (ML) decoder will select the code word from the trellis, like the one in
Figure 2.16, whose distance from the received sequence is minimal. Theoretically, the decoder must

ADAPTIVE AND RECONFIGURABLE CONVOLUTIONAL CODES
33
ﬁnd the path through the trellis for which:
U(σK−1) ˆ= max
r
U (r)(σK−1) ˆ= max
r
P

y | x(r)
≡max
r

ln
K−1

l=0
P

yl | x(r)
l

= max
r
K−1

l=0
ln P

yl | x(r)
l

(2.20)
where xl and yl are n0 binary transmitted and received digits respectively between discrete times l
and l + 1. The branch metric
V (r)
l
(σl−1, σl) ˆ= ln P

yl | x(r)
l

(2.21)
for antipodal modulation (with transmitted and received energy E) and assuming that the lth branch
of the rth path has been transmitted, is:
y jl =
√
E

2x(r)
jl −1

+ ν j
So, we have:
P

yl | x(r)
l

=
n0

j=1
P

y jl | x(r)
jl

=
n0

j=1
1
√πN0
exp



−

y jl −
√
E

2x(r)
jl −1
 2
N0



(2.22)
V (r)
l
(σl−1, σl) =
n0

j=1
y jl

2x(r)
jl −1

(2.23)
In order to reduce the number of trajectories for which the metric is calculated, the Viterbi
algorithm accumulates the result only for those branches with the highest metric (survivors) that
have the best chances to be selected at the end as the ﬁnal choice [1–18]. A maximum a posteriori
probability (MAP) detector is deﬁned in Appendix 2.1.
In the remainder of this section we provide several examples of the performance results.
Figure 2.20 demonstrates that increasing the decoding delay (length of the observed trajectories)
over 30 bit intervals cannot reduce BER signiﬁcantly. In other words, for the given code, only
trajectories up to 30 bits should be observed. From Figure 2.21 one can see that soft decision
decoding provide a roughly 3 dB coding gain compared with hard decision decoding. Figures 2.22
and 2.23 present BER performance for coding rates 1/2 and 1/3 respectively. For these examples,
k0 = 1 and reconﬁguration efﬁciency, deﬁned by Equation (2.18), becomes:
Eﬀ= 10g12/102−(1+(N−1)) = 10g12/102−N
(2.24)
As an example, one can see from Figure 2.22 that for BER = 10−6, the coding gain
g12 ∼= 6.7 −4 = 2.7 dB can be achieved by reconﬁguration of the code from N = 3 to N = 9.
So the reconﬁguration efﬁciency is Eﬀ(Rc = 1/2) = 100.272−6. On the other hand, from Figure 2.23,
one can see that approximately the same coding gain can be achieved by reconﬁguration of the rate
Rc = 1/3 code from N = 3 to N = 8, giving Eﬀ(Rc = 1/3) = 100.272−5. In other words, we ﬁnd
that the efﬁciency of the Rc = 1/3 code is higher by a factor of two.
Achievable coding gains for different codes are shown in Table 2.2. These results can be used for
calculation of reconﬁguration efﬁciency for different types of code.
2.2.3
Systematic recursive convolutional codes
Systematic convolutional codes generated by feed-forward encoders yield, in general, lower free
distances than non-systematic codes. In this section, we will show how to derive a systematic encoder

34
ADAPTIVE CODING
Decoding delay
10−2
Pb(e)
10−3
20
30
40
50
Figure 2.20 Simulated bit error probability versus the decoding delay for the decoding of
the rate 1/2 (2, 1, 7) convolutional code. The signal to noise ratio E/N0 is
3 dB.
+ + + + + + + + + + + +
Soft decoding
bounds
Hard decoding
bounds
1
Pb(e)
10−2
10−4
10−6
0
2
4
6
8
10
Eb/N0 (dB)
Figure 2.21 Performance bounds with hard and soft decision maximum likelihood decod-
ing for the (3, 1, 3) convolutional code. The curve with ‘+’ refers to simulation
results obtained with the soft decision Viterbi algorithm.
from every rate 1/n0 non-systematic encoder, which generates a systematic code with the same weight
enumerating function as the non-systematic one which is relevant for the free distance [18–45]. The
systematic codes are used for turbo code construction, to be discussed later.
Consider, for simplicity, a rate 1/2 feed-forward encoder characterized by the two generators (in
polynomial form) g1,1(Z) and g1,2(Z). Using the power series u(Z) to denote the input sequence
u, and x1(Z) and x2(Z) to denote the two sequences x1 and x2 forming the code x, we have the
relationships:
x1(Z) = u(Z)g1,1(Z)
(2.25)
x2(Z) = u(Z)g1,2(Z)

10−2
Pb(e)
10−3
10−4
10−5
3
5
7
9
Eb/N0 (dB)
N=7
N=6
N=5
N=4
N=9
N=8
N=3
Uncoded
Figure 2.22 Upper bounds to the soft ML decoding bit error probability of different con-
volutional codes of rate 1/2.
10−2
Pb(e)
10−3
10−4
10−5
3
5
7
Eb/N0 (dB)
N=3
N=4
N=5
N=6
N=7
N=8
Uncoded
Figure 2.23 Upper bounds to the soft ML decoding bit error probability of different con-
volutional codes of rate 1/3.
Table 2.2
Achievable coding gains with some convolutional codes of rate Rc and con-
straint length N at different values of the bit error probability. Eight-level quan-
tization soft decision Viterbi decoding is used. The last line gives the asymptotic
upper bound 10 log10 d f Rc
Rc = 1/3
Rc = 1/2
Rc = 2/3
Rc = 3/4
N
N
N
N
Eb/N0 for
uncoded
transmission
(dB)
Pb(e)
7
8
5
6
7
6
8
6
9
6.8
10−3
4.2
4.4
3.3
3.5
3.8
2.8
3.1
2.6
2.6
9.6
10−5
5.7
5.9
4.3
4.6
5.1
4.2
4.6
3.6
4.2
11.3
10−7
6.2
6.5
4.9
5.3
5.8
4.7
5.2
3.9
4.8
→∞
→0
7.0
7.3
5.4
6.0
7.0
5.2
6.7
4.8
5.7
www.allitebooks.com

36
ADAPTIVE CODING
+
+
u(Z)
x2(Z)
x1(Z)
+
+
x
Figure 2.24 Rate 1/2, four-state feed-forward encoder generating the non-systematic code.
+
+
u(Z)
)
(
~ Z
u
)
(
~
2 Z
u
)
(
~
1 Z
u
+
+
~u
Figure 2.25 Rate 1/2, four-state recursive encoder generating the systematic code.
To obtain a systematic code we need to have either x1(Z) = u(Z) or x2(Z) = u(Z). To obtain the ﬁrst
equality, let us divide both equations by g1,1(Z), so that:
˜x1(Z) ˆ= x1(Z)
g1,1(Z) = u(Z)
(2.26)
˜x2(Z) ˆ= x2(Z)
g1,1(Z) =
u(Z)
g1,1(Z) g1,2(Z)
Deﬁning now a new input sequence ˜u(Z) as:
˜u(Z) ˆ= u(Z)
g1,1(Z)
(2.27)
the relations become:
˜x1(Z) ˆ= ˜u(Z)g1,1(Z)
˜x2(Z) ˆ= ˜u(Z)g1,2(Z)
(2.28)
2.2.3.1
Example
Let us assume that the initial encoder is deﬁned by the polynomials gA
1 (Z) = 1 + Z 2, gA
2 (Z) =
1 + Z + Z 2. Its equivalent recursive encoder is obtained as explained previously with generators
gB
1 (Z) = 1, gB
2 (Z) = (1 + Z + Z 2)/(1 + Z 2). These steps are illustrated in Figures 2.24 and 2.25.
2.3
CONCATENATED CODES WITH INTERLEAVERS
Further improvements in performance can be achieved if two codes are combined (concatenated) to
encode the same message, as illustrated in Figure 2.26 (parallel concatenation) and Figure 2.27 (serial
concatenation).

CONCATENATED CODES WITH INTERLEAVERS
37
CONVOLUTIONAL
CODE C1
RATE 1/2
N BITS
CONVOLUTIONAL
CODE C2
RATE 1/1
N BITS
INTERLEAVER
N
x1
x2
x3
u
RATE 1/3
PCCC
CONVOLUTIONAL
CODE C1
RATE 1/2
N BITS
CONVOLUTIONAL
CODE C2
RATE 1/1
N BITS
N BITS
INTERLEAVER
N
x1
x2
x3
Figure 2.26 Block diagram of a rate 1/3 parallel concatenated convolutional code (PCCC).
Rate 1/1 code could be obtained using the same rate 1/2 systematic encoder
that generates C1 and transmitting only the parity check bit.
OUTER
CONVOLUTIONAL
CODE C0
RATE
p
k
Ro
c
/
=
INNER
CONVOLUTIONAL
CODE Ci
RATE
n
p
Ri
c
/
=
INTERLEAVER
N
u
n
k
Rs
c
/
=
OUTER
CONVOLUTIONAL
CODE C0
RATE
p
k
Ro
c
/
=
C0
Rate
p
k
Ro
c
/
=
Outer
Convolutional
Code
C0
p
k
Ro
c
/
=
Inner
Convolutional
Code
Ci
Rate
n
p
Ri
c
/
=
INTERLEAVER
N
Interleaver
N
SCCC
x
OUTER
CONVOLUTIONAL
CODE C0
RATE
p
k
Ro
c
/
=
INNER
CONVOLUTIONAL
CODE Ci
RATE
n
p
Ri
c
/
=
INTERLEAVER
N
OUTER
CONVOLUTIONAL
CODE C0
RATE
p
k
Ro
c
/
=
C0
Rate
p
k
Ro
c
/
=
Outer
convolutional
code
o =
Inner
convolutional
code C i
Rate
n
p
Ri
c
/
=
INTERLEAVER
N
Interleaver
N
SCCC
Figure 2.27 Block diagram of a rate k/n serially concatenated convolutional code (SCCC).
For ML decoding we should consider an equivalent trellis characterized by 2v1+v2 states. The
complexity and reconﬁguration efﬁciency are deﬁned by the same equations as before, with v ⇒
v1 + v2. BER curves for the two types of concatenation are shown in Figures 2.28 and 2.29.
2.3.1
The iterative decoding algorithm
Due to a signiﬁcant increase in the number of states in the equivalent trellis of the concatenated codes,
the complexity of the ML decoder might become unacceptable. A suboptimal, iterative algorithm,
known as a turbo decoder, provides a sufﬁciently good approximation of the ML decoder and offers
performance approaching Shannon’s limit (channel capacity). An heuristic explanation for the itera-
tive decoder is based on the assumption that Equation (2.20) can now be expressed in the form [18]:
ˆuk ˆ= arg max
i
[APP(k, i)]
where the a posteriori probability APP (k, i) is deﬁned as:
APP (k, i) ˆ= p (uk = i, y1, y2)
=

u:uk=i
p(y1 | c1(u))p(y2 | c2(u))pa(u)
(2.29)
p(y1 | c1(u)) =
N1

j=1
p(y1 j | c1 j(u))
p(y2 | c2(u)) =
N2

m=1
p(y2m | c2m(u))
pa(u) =
K

l=1
pa(ul)

38
ADAPTIVE CODING
N=10,000
N=1,000
PCCC,N=100
CC
1
10−4
10−8
Eb/N0 (dB)
0
2
4
6
8
10
Pb(e)
Figure 2.28 Average upper bounds to the bit error probability for a rate 1/3 PCCC obtained
by concatenating two rate 1/2, four-state convolutional codes (CC), through a
uniform interleaver of sizes N = 100, 1000, 10000.
10−1
10−5
N=400
SCCC,N=200
N=1000
N=2000
N=600
N=800
0
2
4
6              8
Eb/N0 (dB)
Pb(e)
Figure 2.29 Average upper bound to the bit error probability for a rate 1/3 SCCC using as
outer code a four-state, rate 1/2, non-recursive convolutional encoder, and as
inner code a four-state, rate 2/3, recursive convolutional encoder with uniform
interleavers of various sizes.

CONCATENATED CODES WITH INTERLEAVERS
39
In other words, it is assumed that the interleaver will randomize the data stream so that the output of
the two encoders can be considered independent. Based on this assumption we can also write:
p(y1 |c1(u)) ∼=

l
˜P1l(ul)
(2.30)
p(y2 |c2(u)) ∼=

l
˜P2l(ul)
and Equation (2.29) becomes:
APP(k, i) =


u:uk=i
p(y2

c2(u))

l̸=k
˜P1l(ul)pa(ul)

˜P1k(i)pa(i)
(2.31)
APP(k, i) =


u:uk=i
p(y1

c1(u))

l̸=k
˜P2l(ul)pa(ul)

˜P2k(i)pa(i)
The solution to Equation (2.31) can be represented as:
˜P1k(i) =

u:uk=i
p(y1

c1(u))

l̸=k
˜P2l(ul)pa(ul)
˜P2k(i) =

u:uk=i
p(y2

c2(u))

l̸=k
˜P1l(ul)pa(ul)
(2.32)
Finally, Equation (2.29) becomes:
APP (k, i) = ˜P1k(i) ˜P2k(i)pa(ul)
(2.33)
The maximization of Equation (2.33) can be performed in a number of iterations as:
˜P(0)
2k = 1, k = 1, . . . , K
...
˜P(m)
1k
=

u:uk=i
p(y1

c1(u))

l̸=k
˜P(m−1)
2l
(ul)pa(ul), k = 1, . . . , K
(2.34)
˜P(0)
2k =

u:uk=i
p(y2

c2(u))

l̸=k
˜P(m)
1l (ul)pa(ul), k = 1, . . . , K
For binary signaling, uk = 0, 1 and the signal probabilities can be replaced by using log likelihood
ratios (LLR) deﬁned as:
λk(APP) ≡log

u:uk=0
p(y1 | c1(u))p(y2 | c2(u))pa(u)

u:uk=1
p(y1 | c1(u))p(y2 | c2(u))pa(u)
(2.35)

40
ADAPTIVE CODING
By introducing the following notation
λk ≡log p(yk | 0)
p(yk | 1)
λ1 j ≡log p(y1 j | 0)
p(y1 j | 1)
j = 1, . . . N1
(2.36)
λ2m ≡log p(y2m | 0)
p(y2m | 1)
m = 1, . . . N2
λa ≡log pa(0)
pa(1)
π1l ≡log
˜P1l(0)
˜P1l(1)
π2l ≡log
˜P2l(0)
˜P2l(1)
and
λk(APP) ≡log

u:uk=0
p(y1 | c1(u))
p(y1 | 0)
p(y2 | c2(u))
p(y2 | 0)
pa(u)
pa(0)

u:uk=1
p(y1 | c1(u))
p(y1 | 0)
p(y2 | c2(u))
p(y2 | 0)
pa(u)
pa(0)
(2.37)
p(y1 |c1(u))
p(y1 | 0)
=
N1

j=1
p(y1 j | c1 j(u))
p(y1 j | 0)
p(y1 j | c1 j(u))
p(y1 j | 0)
=
 exp(−λ1 j)
i f
c1 j(u) = 1
0
i f
c1 j(u) = 0
!
= exp

−λ1 j)c1 j(u)

p(y2m | c2m(u))
p(y2m | 0)
= exp [−λ2m)c2m(u)]
pa(ul)
pa(0) = exp(−ulλa)
Equation (2.35) becomes:
λk(APP) = log




u:kk=0
exp −


N1

j=1
c1 j(u)λ1 j +
N2

m=1
c2m(u)λ2m +
K

l=1
ulλa





−log




u:kk=1
exp −


N1

j=1
c1 j(u)λ1 j +
N2

m=1
c2m(u)λ2m +
K

l=1
ulλa





(2.38)

CONCATENATED CODES WITH INTERLEAVERS
41
+
+
+
SISO
1
j
1
λ
(APP)
l
λ
a
λ
l1
π
m
2
λ
π
SISO
2
interleaver and its inverse
Π-1 Π
+
+
+
SISO
1
m
2
λ
π
SISO
2
Π-1 Π
π2m
Figure 2.30 Block diagram of the iterative decoding scheme for binary convolutional codes.
and the iterative procedure (2.34) can be represented as:
π(0)
2k = 0
...
π(m)
1k = log




u:kk=0
exp −


j
c1 j(u)λ1 j +

l̸=k
ul

λa + π(m−1)
2l






−log




u:kk=1
exp −


j
c1 j(u)λ1 j +

l̸=k
ul

λa + π(m−1)
2l






(2.39)
π(m)
2k = log




u:kk=0
exp −


m
c2m(u)λ2m +

l̸=k
ul

λa + π(m)
1l






−log




u:kk=1
exp −


m
c2m(u)λ2m +

l̸=k
ul

λa + π(m)
1l






The ﬁnal value of λk (APP) is calculated as
λk(APP) = π1k + π2k + λa
(2.40)
and the MAP decision is made according to the sign of λk. The details of the numerical evaluation
of Equation (2.39) are available in standard literature [49–59], the most relevant being the original
work by Berrou [60].
These iterations contain implicitly the trellis constraints imposed by the trellis structure. For these
purposes forward and backward recursions are used [49–60].
In the block diagrams shown in Figures 2.30 and 2.31, these calculations are performed in soft
input soft output (SISO) blocks [49–59]. Performance curves are given in Figures 2.32, 2.33 and 2.34.
In order to avoid repetition, for details of iterative calculations, deﬁned by Equation (2.39), the reader
is referred to the classical literature [49–59]. Instead of going into these details we will get back, once
again, to the issue of reconﬁguration efﬁciency. As already mentioned, for two concatenated codes
with k01 = k02 and an ML decoder, Equation (2.18) becomes:
Eff = 10g12/102−(k0v)

Outer
Inner
u0
c0
ui
ci
From soft
demodulator
SISO
Inner
Not used
SISO
Outer
)
;
(
I
ic
λ
)
;
(
O
ic
λ
)
;
(
I
i
u
λ
)
;
(
O
i
u
λ
)
;
(
O
o
c
λ
)
;
(
I
o
u
λ
)
;
(
O
o
u
λ
Zero
Decision
∏
−1
∏
)
;
(
I
o
c
λ
Outer
Inner
u0
SISO
inner
SISO
outer
I
∏
−1
∏
Figure 2.31 Block diagrams of the encoder and iterative decoder for serially concatenated
convolutional codes.
0
0.4
0.8
1.2
1.6
Eb/N0 (dB)
1 iteration
2
8
9
10
1
Pb(e)
10−1
10−2
10−3
7
6
5
4
3
Figure 2.32 Bit error probability obtained by simulating the iterative decoding algorithm.
Rate 1/2 PCCC based on 16-state rate 2/3 and 2/1 CCs, and interleaver with
size N = 8920.
−0.25
−0.15
−0.05
0.05
0.15
Eb/N0 (dB)
23
10
5
6
7
8
9
11
12
13
14
15
1 iteration
Figure 2.33 Simulated bit error probability performance of a rate 1/4 serially concatenated
code obtained with two eight-state constituent codes and an interleaver yielding
an input decoding delay equal to 16 384.

ADAPTIVE CODING, PRACTICE AND PROSPECTS
43
0
0.2
0.4
0.6
0.8
1
Eb/N0 (dB)
1
Pb(e)
10-1
10-2
10-3
10-4
10-5
PCCC
SCCC
6 iterations
9
9
6
Figure 2.34 Comparison of rate 1/3 PCCC and SCCC. The PCCC is obtained concatenating
two equal rate 1/2 four-state codes, whereas the SCCC concatenates two four-
state rate 1/2 and rate 2/3 codes. The curves refer to six and nine iterations of
the decoding algorithm and to an equal input decoding delay of 16 384.
So, for the two codes with v1 = v2 = v, the reconﬁguration from a single convolutional code (CC)
to parallel concatenated CC (PCCC) with k01 = k02, gives:
Eff = 10g12/102−v
If a turbo decoder is used, the relative complexity changes and Equation (2.19) gives:
Eff = 10−|g12|/10 2v
2I
where I is the number of iterations.
2.4
ADAPTIVE CODING, PRACTICE AND PROSPECTS
Efﬁcient error control on time varying channels can be performed by implementing an adaptive
control system where the optimum code is selected according to the actual channel conditions.
There is a number of burst error correcting codes that could be used in these adaptive schemes.
Three major classes of burst error correcting code are binary ﬁre block codes, binary Iwadare–Massey
convolutional codes [61], and non-binary Reed–Solomon block codes. In practical communication
systems these are decoded by hard decision decoding methods. Performance evaluation based on
experimental data from satellite mobile communication channels [62] shows that the convolutional
codes with the soft decision decoding Viterbi algorithm are superior to all of the above burst error
correcting codes.
Superior error probability performance and availability of a wide range of code rates without
changing the basic coded structure, motivate the use of punctured convolutional codes [27–30] with
the soft decision Viterbi decoding algorithm in the proposed adaptive scheme. To obtain the full
beneﬁt of the Viterbi algorithm on bursty channels, ideal interleaving is assumed.
An adaptive coding scheme using incremental redundancy in a hybrid automatic repeat request
(ARQ) error control system is reported by Wu et al. [63]. The channel model used is BSC with time
variable bit error probability. The system state is chosen according to the channel bit error rate. The

44
ADAPTIVE CODING
error correction is performed by shortened cyclic codes with variable degrees of shortening. When
the channel bit error rate increases, the system generates additional parity bits for error correction.
An FEC adaptive scheme for matching code to the prevailing channel conditions was reported
by Chase [64]. The method is based on convolutional codes with Viterbi decoding and consists of
combining noisy packets to obtain a packet with a code rate low enough (less than 1/2) to achieve the
speciﬁed error rate. Other schemes that use a form of adaptive decoding are reported in [65–70]. Hybrid
ARQ schemes based on convolutional codes with sequential decoding on a memoryless channel were
reported by Drukarev and Costello [71, 72] while a Type-II hybrid ARQ scheme formed by concate-
nation of convolutional codes with block codes was evaluated on a channel represented by two states
[73].
In order to implement the adaptive coding scheme it is necessary again to use a return channel.
The channel state estimator (CSE) determines the current channel state, based on counting the
number of erroneous blocks. Once the channel state has been estimated, a decision is made by the
‘reconﬁguration block’ whether to change the code, and the corresponding messages are sent to the
encoder and locally to the decoder.
In FEC schemes only error correction is performed, while in hybrid ARQ schemes retransmission
of erroneous blocks is requested whenever the decoded data is labeled as unreliable.
The adaptive error protection is obtained by changing the code rates. For practical purposes it is
desirable to modify the code rates without changing the basic structure of the encoder and decoder.
Punctured convolutional codes are ideally suited for this application. They allow almost continuous
change of the code rates, while decoding is done by the same decoder.
The encoded digits at the output of the encoder are periodically deleted according to the deleting
map speciﬁed for each code. Changing the number of deleted digits varies the code rate. At the
receiver end, the Viterbi decoder operates on the trellis of the parent code and uses the same deleting
map as in the encoder in computing path metrics [47].
The Viterbi algorithm based on this metric is a maximum likelihood algorithm on channels with
Gaussian noise, since on these channels the most probable errors occur between signals that are closest
together in terms of squared Euclidean distance. However, this metric is not optimal for non-Gaussian
channels. The Viterbi algorithm allows use of channel state information for fading channels [74].
However, a disadvantage of punctured convolutional codes compared to other convolutional codes
with the same rate and memory order is that error paths are typically long. This requires quite long
decision depths of the Viterbi decoder.
A scheme with ARQ rate compatible convolutional codes was reported by Hagenauer [75]. In this
scheme, rate compatible codes are applied. The rate compatibility constraint increases the system
throughput, since in transition from a higher to a lower rate code, only incremental redundancy digits
are retransmitted. The error detection is performed by a cyclic redundancy check which introduces
additional redundancy.
2.5 DISTRIBUTED SOURCE CODING
In this section we discuss the problem of compressing correlated distributed sources, i.e. correlated
sources that are not co-located or that cannot cooperate to directly exploit their correlation. The most
interesting application is data aggregation in wireless sensor networks (WSN). This problem has
been studied in the information theory literature under the name of the Slepian–Wolf source coding
problem for the lossless coding case, and as ‘rate-distortion with side information’ for the lossy
coding case [76–105].
In a WSN, sensors transmit their highly correlated information to a central processing unit (sink)
that forms the best picture of the scene based on a fusion of the information collected by all of them.
Data aggregation is reduced to the problem of encoding of sources in the presence of side
information available only at the decoder. Consider ﬁrst the problem where X and Y are correlated
discrete-alphabet memoryless sources, and we have to compress X losslessly, with Y (referred to as
side information) being known at the decoder but not at the encoder. If Y were known at both ends
(see Figure 2.35(a)), then the problem of compressing X is well understood: one can compress X

Distributed Source Coding
45
ENCODER
DECODER
X 
X ^ 
Y 
Bits at
rate larger
than  H(x|y) 
Bits at
rate larger
than  H(x|y) 
ENCODER
DECODER
X 
X ^ 
Y 
(a) 
(b) 
Figure 2.35 Communication system: (a) both encoder and decoder have access to the side
information Y (which is correlated to X); (b) only decoder has access to the
side information Y.
at the theoretical rate of its conditional entropy [76] given Y, H(X|Y). If Y were known only at the
decoder for X and not at the encoder (see Figure 2.35(b)) one can still compress X using only H(X|Y)
bits, as is the case where the encoder does know Y. That is, by just knowing the joint distribution of
X and Y, without explicitly knowing Y, the encoder of X can perform as well as an encoder which
explicitly knows Y. This is known as the Slepian–Wolf coding theorem [78].
As an illustration, suppose X and Y are equiprobable 3-bit binary words that are correlated in the
sense that the Hamming distance between X and Y is no more than one. If Y (side information) is
available to both the encoder and the decoder, clearly we can describe X using 2 bits (there are only
four possibilities for the modulo-two binary sum of X and Y: {000, 001, 010, 100}).
If Y were revealed only to the decoder but not the encoder, it is wasteful for X to spend any bits
in differentiating between {X = 000 and X = 111}, since the Hamming distance between these two
words is 3. Thus, if the decoder knows that either X = 000 or X = 111, it can resolve this uncertainty
by checking which of them is closer in Hamming distance to Y, and declaring that as the value of X.
Note that the set {000, 111} is a 3-bit repetition code. Likewise, in addition to the set {000, 111},
each of the following three sets for X:{100, 011}, {010, 101}, and {001, 110} is composed of pairs
of words whose Hamming distance is 3. These are just simple variants or cosets of the 3-bit repetition
code, and they cover the space of all binary 3-tuples that X can assume. Thus, instead of describing
X by its 3-bit value, we encode which coset X belongs to, incurring a cost of 2 bits, just as in the case
where Y is known to both encoder and decoder.
In general, by using terminology of algebraic channel codes, a linear block channel code [94] is
speciﬁed by its 3-tuple (n, k, d), where n is the code length, k is the message length, and d is the
minimum distance of the code. In the above example, we considered the cosets of the linear (3, 1, 3)
repetition code. Every coset of a linear code is associated with a unique syndrome [95]. Recall that the
syndrome s associated with a linear channel code is deﬁned as sT = HcT, where H is the parity-check
matrix of the code, c is any valid codeword, T denotes transposition, and s, c are row vectors.
In general, for X, Y ∈{0,1}n and dH(X, Y) ≤t, the encoding of X is done in such a way that the
encoder observes X and sends the index of the coset (say l) of an appropriately chosen binary linear
code with parameters (n, k, 2t + 1), in which it resides. The decoder recovers the value of X to be that
vector in the coset l which is closest in Hamming distance to Y. The rate of transmission is (n −k)
bits per sample.
www.allitebooks.com

46
ADAPTIVE CODING
Implementation: Let H be the parity-check matrix of a binary linear (n, k, 2t + 1) code in its
systematic form, i.e., H = [A |I]. Let sT = HxT be the syndrome when the outcome of X is x.
The encoder transmits s to the decoder. Let y′ = y ⊕a, where a is any vector in the coset whose
syndrome is s (⊕denotes addition modulo-2). Find a vector x′ closest to y′ in the coset whose
syndrome is the all-zero vector. It can be seen that x = x′ ⊕a. Since any vector in the coset with
syndrome s will serve our purpose, we take the vector [0|s] to be a in all future discussions where
0 is the all-zero vector of length k.
Similarly to block codes, we can also deﬁne a syndrome sequence in convolutional codes. Let
H(D) = [A(D) |I] be the systematic parity-check polynomial matrix of a convolutional code, and let
x(D) be the source sequence in polynomial representation: x(D) = L
i=1 xi Di−1, where xi denotes
the ith element of x. The encoder sends the syndrome sequence s(D)T = H(D)x(D)T to the decoder.
Let a(D) = [0|s(D)] and y′(D) = y(D) ⊕a(D), where y(D) is the side-information sequence. In the
coset with the all-zero syndrome, let x′(D) be the sequence closest to y′(D), which can be found using
the Viterbi algorithm [96] for H(D). Now the reconstruction ˆx(D) = x′(D) ⊕a(D).
2.5.1 Continuous valued source
In this case X and Y are correlated memoryless processes characterized by independent and
identically distributed (i.i.d.) sequences {Xi}∞
i=1 and {Yi}∞
i=1, respectively. For illustration pur-
poses we use a simple case where Y is a noisy version of X, i.e. Yi = Xi + Ni, where
{Ni}∞
i=1 is also continuously valued (deﬁned on the real line R), i.i.d, and independent
of the Xis. As before, the decoder alone has access to the Y process (side information), and the
task is to compress optimally the X process. In the sequel, we consider the case where the Xis and Nis
are zero-mean Gaussian random variables with known variances, so as to benchmark our performance
against the theoretical performance bounds.
The goal is to form the best approximation ˆX to X given an encoding rate of R bits per sample.
We assume encoding in blocks of length L. Let the distortion measure be ρ(·) over the L-sequence,
deﬁned as
ρ(x, ˆx) = 1
L
L

i=1
ρ(xi, ˆxi),
ρ : R × R →R+
This problem can be posed as minimizing the rate of transmission R such that the reconstruction
ﬁdelity E[ρ(X, ˆX)] is less than a given value D, where E(·) is the expectation operator.
The encoder is a mapping from the input space to the index set: RL →{1, 2, . . . , 2L R}, and the
decoder is a mapping from the product space of the encoded index set and the correlated L-sequence
Y to the L-sequence reconstruction {1, 2, . . . , 2L R} × RL →RL. In the sequel, we focus on the
mean-squared error (MSE) distortion: ρ(x, ˆx) = (x −ˆx)2.
The encoder and the decoder, as shown in Figure 2.36 consist of ﬁve mappings: {Mi}5
i=1.
Source coding (M1, M2): The source X is quantized and a source codebook is constructed for a
given reconstruction ﬁdelity. The source space RL is partitioned into 2L Rs disjoint regions, where Rs
is deﬁned as the source rate. This is referred to as mapping M1.
Let  = {1, 2, . . . , 2L RS } denote the set of 2L Rs disjoint regions. Each region in the above
partition is associated with a representation codeword. The set of representation codewords is referred
to as the source codebook (S). This is a mapping M2. We refer to the representation codeword to which
X is quantized as the active codeword. Let the random variable characterizing the active codeword be
denoted by W.
Estimation (M3): The decoder gets the best estimate of X (minimizing the distortion) conditioned
on the outcome of the side information and the element in  containing X. This is given by
ˆx = arg min
a∈RL
E

ρ(X, a)

X ∈i
Y = y

(2.41)

Distributed Source Coding
47
SOURCE SPACE
PARTITION:
find index of
active codeword
X 
ENCODER
1
2
M ,M
COSET CODE
PARTITION:
4
M
find index of coset
containing active
codeword 
SOURCE CODE
RECOVERY:
find codeword
closest to Y in
coset U 
U 
DECODER
5
M
ES TIMATION:
estimate X from Y
and source coded
index 
3
M
X 
^ 
Y 
Figure 2.36 Encoder and decoder: X is quantized, and the index of the coset containing the
quantized codeword is sent to the decoder. The decoder ﬁnds this codeword
by decoding the side information in the given coset.
for the received message i and the side-information outcome y. It can be interpreted as a mapping M3.
The estimation error is a function of Rs, which is chosen to keep this error within the given ﬁdelity
criterion.
Channel coding (M4, M5): The random variable W characterizing the quantized source is correlated
to X, and this in turn induces a correlation between W and the side information Y. This is characterized
by a conditional distribution P(Y/W) of the side information given W. With this conditional distribution
we can associate a ﬁctitious channel with W as input, which is observed at the encoder, and Y as output,
which is observed at the decoder, whose information channel capacity is greater than 0 (due to this
correlation). Actually to communicate W to the decoder in the absence of side information requires
a transmission of Rs bits per sample. With the presence of Y at the decoder, we have this ﬁctitious
‘helper’ channel carrying an amount of information I(W; Y) about W. The remaining uncertainty in W
after observing the side information Y is H(W/Y) = H(W) −I(W; Y) and this is the desired ﬁnal
rate of transmission. The rebate in the rate of transmission is I(W; Y).
The goal is to get a rebate as close to I(W; Y) as possible by building a practical structured ‘channel
code’ (C) for this ﬁctitious channel on the space of W. Let 2L Rc denote the number of codewords in
the designed channel code where Rc is deﬁned as the channel rate. Since, in general, any codeword
in the source codebook can be a quantization outcome with a nonzero probability, we partition the
source codebook space into cosets of this channel code. The channel code is designed in such a
way that each of its cosets is also an equally good channel code for the channel P(Y/W). Thus, each
quantization outcome belongs to a coset of this channel code, and this alone has to be conveyed to
the decoder, which can then proceed to use this coset of the channel code for ﬁnding the intended
active codeword.
The encoder computes the index of the coset of the channel code containing the active codeword
using a mapping M4 : {1, 2, . . . , 2L Rs}→{1, 2, . . . , 2L R} and transmits this information with rate
R = Rs −Rc bits per sample to the decoder. The decoder recovers the active codeword in the signaled
coset by ﬁnding (channel decoding) the most likely codeword given the observed side information.
This is characterized by a mapping M5 : RL × {l, 2, . . . , 2L R}→{l, 2, . . . , 2L RS}.
In this approach, there is always a nonzero probability of decoding error, where the side information
is decoded to a wrong codeword, and this can be made arbitrarily small by designing efﬁcient channel
codes. For a given region in , the choice of the representation codeword determines I(W; Y), and
hence Rc.
Example: For a ﬁxed-rate (log2V) scalar quantizer with V = 8 levels, designed for the distribution
of X let ∇= {r0, r1, . . . , rV −1} be the set of reconstruction levels as shown in the Figure 2.37. ∇
partitions the real line into V intervals each associated with one of the reconstruction levels. Let  =
{i}V −1
i=0 be the partition of R, where i is the open interval
" ri−1+ri
2
, ri +ri +1
2
#
and we take r−1 = −∞
and rV = ∞. We ﬁrst quantize the source sample by sample using ∇. Thus, the source codebook S
is given by ∇, and Rs = 3 bits/sample. Next we construct C by partitioning the set ∇into M(≤V)
cosets. For illustration, let M = 2. We group r0, r2, r4, and r6 into one coset. Similarly, r1, r3, r5, and r7

48
ADAPTIVE CODING
0r
1r
2r
3r
4r
5r
6r
7r
Y
Y
(error)
(no error)
X
Figure 2.37 Reconstruction levels of scalar quantizer with eight levels.
are grouped into another coset. This is done to keep the minimum distance between any two words in
every coset as large as possible. Thus, the channel code is deﬁned as C = {r0, r2, r4, r6}, making Rc = 2.
The information about the coset is transmitted by R = 1 bit/sample. The representation codeword
ri is the centroid of the disjoint region i for 0 ≤i ≤V −1.
The decoder deciphers (with a small probability of error) the active codeword by ﬁnding the
codeword which is closest to Y in the coset whose index is sent by the encoder and the optimal
estimate ˆx is computed as:
ˆx = arg min
a∈R
E

ρ(X, a)

X ∈i,
Y = y

(2.42)
where y is the outcome of Y, i is the index of the active codeword.
2.5.2 Scalar quantization and trellis-based coset construction
In this section we use scalar (memoryless) quantization as before and a coset construction having
memory L. In other words we still use ﬁxed-length scalar quantizers for quantizing {Xi}L
i=1, but the
cosets are built on the space ∇L. Thus, for the previous example, the source codebook is given by S
= ∇L and Rs = 3 bits/sample.
Source coding (M1, M2): For a general Rs, M1: RL →{l, 2, . . . , 2L Rs} is the L-product scalar quan-
tizer and M2 :{1, 2, . . . , 2L Rs} →∇L is the L-sequence extension of the mapping {1, 2, . . . ,2Rs}→
∇.
For the previous example, the space ∇L has 23L distinct sequences. The task is to partition this
sequence space S into cosets of a set of sequences in such a way that the minimum distance between
any two sequences in every coset is made as large as possible, while maintaining symmetry among the
cosets. Let R = 1 bit/sample. In the following, a trellis-based partitioning with an algebraic structure is
considered based on convolutional codes and set-partitioning rules of trellis-coded scalar-quantization
(TCSQ) [99].
Consider a trellis code built on ∇with block length L, having 22L sequences (code rate is Rc = 2
bits/sample), using a rate-2/3 convolutional code and a mapping Q : {0, l}3 →∇. For this example,

Distributed Source Coding
49
0426
1537
2604
3715
1537
0426 
3715
2604
Figure 2.38 Trellis section for the trellis code built on an alphabet of size 8. The num-
ber of paths emanating from any state is four. (a) Principal trellis coset. (b)
Complementary trellis coset.
Ungerboeck’s four-state trellis as given in [99] is used. The presentation is restricted to systematic
trellis codes. ∇is partitioned into two subsets as in Section 2.5.1. A coded bitstream selects points
from one of these subsets depending on the state of the ﬁnite-state machine. The trellis for this code
is shown in Figure 2.38(a), which we refer to as the principal trellis coset. For this example, let
Q(ζ) = rη where ζ ∈{0, l}3 is the binary representation of η. In the notation Q(x) = Q(x1, x2, . . . ,
xL) = [Q(x1), Q(x2), . . . , Q(xL)], xk ∈{0, l}3 is a column vector for every 1 ≤k ≤L. We take the
set of all sequences that can be generated from the above machine (i.e., all the sequences of this
trellis code) as a channel code C for the channel P(Y/W). Clearly, C ⊂S. If H(D) be the parity-check
matrix polynomial of the underlying convolutional code, and θ any sequence in ∇L then we have
Q−1(θ) ∈{0, 1}3L. In the sequel, we associate for any syndrome s ∈{0, 1}L a coset of C, given by
C(s), which consists of all the sequences z ∈∇L such that H(D)Q−1(z) = sT . Each of 2L cosets of C
consists of 22L sequences. This has resulted in a partition of the space ∇L into 2L cosets of C. The
encoder sends the index s of the coset C(s) containing the quantized source sequence.
Coset Indexing (M4): For the case of general Rs, and for any θ ∈{1, 2, . . . , 2L Rs} we use M4(θ) =
DR[H(D){Q−1[M2(θ)]}] + 1, where DR is the R-bit representation to decimal conversion mapping:
{0, 1}RL →{0, 1, 2, . . . , 2RL −1}.
Decoder (M5): The decoder receives L bits of syndrome s, and L samples of the process Y and
searches through the list of codeword sequences in a given coset C(s) for the most likely codeword
sequence, given the side-information sequence y. Consider the kth stage of the four-state trellis as
shown in Figure 2.38(a). This is the trellis for the coset of C with the all-zero syndrome. If the kth
bit of the syndrome sequence is 1 rather than 0, we need to modify the labels on each edge of the
principal trellis coset at the kth stage. Let a = [0|0|sT , where ak = [0|0|sk]T for all 1 ≤k ≤L, and
0 is the all-zero sequence. As discussed earlier, for the trellis code under consideration, the sequence
Q[[0|0|sT ] belongs to the coset whose syndrome is s. Thus, at the kth stage of decoding, if the kth bit
of s is 1, we need to shift from the principal trellis coset to the other trellis coset (there are only two
trellis cosets in the given example: see Figure 2.38(b)).
This is done by deﬁning the trellis coset at the kth stage as having the edge labels ξ = Q[Q−1(rl) ⊕
ak], where rl ∈∇is the corresponding label in the principal trellis coset ak = [0|0|sk]T (this is possible
due to the systematic trellis codes). The set of labels on the edges starting from any given state in the
two trellis cosets forms a partition of ∇. For example, in the ﬁrst state, the edge labels of the principal
trellis coset {r0, r2, r4, r6}, and that of the complementary trellis coset {r1, r3, r5, r7} form a partition
of ∇. Thus, starting from k = 1 to k = L, at every stage we need to keep relabeling (shifting between
the principal trellis coset and the other trellis coset) the edges in the trellis used in the Viterbi decoder.
Let x′ be the sequence that is closest to y obtained using this algorithm (characterizing the mapping
M5) with relabeled edges. This is illustrated in Figure 2.39 with an example. For a general R, there
will be 2R trellis cosets. It can be noted that the minimum distance between any two words in every
coset of C has been increased from that in the memoryless coset construction.
After recovering the active codeword, the optimal estimate is given as follows:
ˆx = M3(y, θ) = arg min
a∈RL

E
 
ρ(X, a)

Y = y
X ∈
!
(2.43)

50
ADAPTIVE CODING
1 
0 
1 
1 
0 
7 
3 
2 
1 
5 
Figure 2.39 An example of computation of the syndrome ((Rs, Rc) = (3, 2) bits per sample):
let the outcome of quantization be 7, 3, 2, 1, 5. The syndrome is given by 10110
for ﬁve samples. Sample numbers 0, 2, and 3 use complementary trellis coset
and the rest use principal trellis coset.
where θ is the index of the codeword x′ in S, and  is the sequence of intervals associated with the
elements of x′. Since S is memoryless, we can simplify the preceding expression as
ˆxk = arg min
a∈R
E
 
ρ(Xk, a)

Yk = yk
Xk ∈i
!
(2.44)
where ˆxk is the kth sample of ˆx, for 1 ≤k ≤L, and x′
k = ri ∈∇(the estimation assumes correct
decoding).
2.5.3 Trellis-based quantization and memoryless
Coset construction
We now use a more efﬁcient quantizers such as TCSQ as source codebook, and construct cosets on
this space. Consider a TCSQ with rate Rs bits per sample built on a scalar quantizer alphabet ∇of
size 2Rs+1. This has a ﬁnite-state machine with a rate-Rs/(Rs + 1) convolutional code and a mapping
Q : {0, 1}Rs+1→∇. The set of 2L Rs ‘valid’ sequences of this TCSQ constitutes the source codebook
S. The source is quantized using S by applying the Viterbi algorithm.
Source coding (M1, M2): M1 corresponds to this trelliscoded quantization, and M2 corresponds to
the rule of assigning the sequences in S to their corresponding regions. In example with (Rs, Rc) =
(2, 1) bits per sample and the trellis as shown in Figure 2.38(a) we consider a TCSQ with parallel
transitions, and assign all the label points on a parallel transition to the same coset of a sequence set
C, resulting in a reduction in rate by 1 bit/sample. In other words, we partition the scalar quantizer
∇into four sets: {r0, r4}, {r1, r5}, {r2, r6}, and {r3, r7}, and the encoder does not expend bits to
differentiate between the elements of a set (i.e., labels among parallel transitions between any two
connected states in the trellis). Thus, the channel code is given by C = {r0, r4}L ⊂S. This amounts
to discarding the uncoded bit in the 2-bit representation of the TCSQ codewords and sending only
the coded bit to the decoder.
The set of codewords in the TCSQ can be viewed as a coset code [101]. ∇is partitioned into
four cosets of {r0, r4}, and a bit sequence set is used to index the valid set of L-dimensional coset
sequences.
The extension of the above techniques to the case of trellis based quantization and trellis based
coset construction is straightforward.
2.5.4 Performance examples
The following model for X and Y : Y = X + N is used in simulation, where X is i.i.d. Gaussian with zero
mean and unit variance and N is i.i.d. Gaussian with zero mean and independent of X. For memoryless
source and channel codes 4-, 8-, and 16-level scalar quantizers are used, each partitioned into two

Distributed Source Coding
51
−25
−20
−15
−10
6
8
10
12
14
16
Correlation-SNR in dB
Normalized distortion only during correct decoding in dB
−8
−7
−6
−5
−4
−3
−2
−1
0
16
17
18
19
20
21
22
Correlation-SNR in dB
Prob. of Error in exponents of 10
16−levels
8−levels
4−levels
4−levels
8−levels
16−levels
Figure 2.40 (a) Distortion performance of different quantizers during correct decoding for
a Gaussian source. (b) Probability of error for R = 1 bit/sample for memoryless
quantization and memoryless coset construction.
cosets, with each coset containing two, four, and eight codewords, respectively. Distortion during
correct decoding only is plotted versus correlation-SNR (which is the ratio of the variance of X and
N) for these three schemes in Figure 2.40(a). Figure 2.40(b) shows the probability of decoding error
(Pe) for the same system. These are the results of Monte Carlo simulations. As can be noted, there
is a tradeoff between the distortion and probability of decoding error. For a given correlation-SNR,
as the number of levels in the quantizer is increased, the distortion decreases and the probability of
decoding error increases.
For the trellis-based coset construction we use 4- and 8-state trellis built on a 4-level scalar
quantizer as shown in Figure 2.41(a). These trellises are designed based on the set partitioning rules
of [100] and [101]. Figure 2.42(a) gives the probability of decoding error versus correlation-SNR.
Note that by using trellis-based cosets, we get gains of around 3–4 dB in correlation-SNR over
memoryless coset construction. Thus, without increasing the rate, at Pe ≤10−4, we can operate at
correlation-SNRs no less than 12 dB (see Figure 2.42(a)) compared with 15.5 dB (see Figure 2.40
(b)). Similar coset constructions are done on an 8-level quantizer using 4-, 8-state trellises for R = 1
bit/sample as shown Figure 2.41(b). Figure 2.42(b) gives the performance in terms of Pe. Here again
we get 3-dB gain over memoryless coset construction with four- and eight-state trellis at Pe ≤10−4.
We now construct trellis-based quantizers and coset construction. We construct such TCSQs and
coset partitions on 8- and 16-level quantizers. The trellises for the source and the channel codes
for the 8-level quantizer are shown in Figure 2.43. Recall that the encoder uses the trellis of Figure
2.43(a) in quantization, while the receiver uses the trellis of Figure 2.43 (b) in decoding the side
information. The probability of decoding error as a function of correlation-SNR is plotted in Figure
2.44 with the number states ranging from 2 to 32. The performance of these systems is better than
that of the corresponding constructions with memoryless cosets. Using these methods we can now
operate at correlation-SNRs as low as 8.5 dB with 32 states Pe ≤10−4.
In order to analyze the system behavior for higher rates of transmission let us consider the
constructions of memoryless source codes and trellis based coset construction for R = 2 bits/sample.
For a trellis code (characterizing C with Rc = 1) built on an 8-level quantizer (characterizing S with
Rs = 3), we need a rate-1/3 convolutional code, and a mapping rule Q to maximize the coding gain. In

52
ADAPTIVE CODING
02 
13 
20 
31 
20 
31 
20 
31 
02 
13 
02 
13 
(04)(26)
(15)(37)
(26)(04)
(37)(15)
(26)(04)
(37)(15)
(26)(04)
(37)(15)
(04)(26)
(15)(37)
(04)(26)
(15)(37)
(a) 
(b) 
Figure 2.41 Trellises for the channel code C for R = 1 bit/sample using memoryless source
codes (a) for 4-level quantizer; (b) for 8-level quantizer. Both (a) and (b) have
the same structure for a given number of states.
principle, for this trellis code, the set partition rule works by increasing the alphabet size four times,
as compared to twice in most of the trellis designs. An alternative is to choose a subset (containing
four elements) of the available alphabet (eight levels), and use only them in one coset. We partition
the 8-level quantizer into two cosets (as in memoryless coset construction for R = 1), and construct
trellis codes on each of these memoryless cosets. Let Coset-1 and Coset-2 specify the codeword sets
{0, 2, 4, 6} and {l, 3, 5, 7}, respectively. A rate-1/2 convolutional code with set partitioning on
Coset-1 can be used to get trellis codes with a 4-state trellis as shown in Figure 2.45(a). The trellis
uses an alphabet of size 2Rc+2. There are four trellis cosets, with two of them built on Coset-1 and two
built on Coset-2. The index of one of the four trellis cosets containing the quantized source sample
is sent to the decoder. Figure 2.46(a) shows the decoding error performance of this construction.
Similarly to the case of R = 1, we get 3–4-dB gains over memoryless coset construction when Pe ≤
10−4. As R is increased from 1 to 2 bits/sample, for the same trellis complexity and scalar quantizer,
the probability of error is decreased, and the correlation-SNR that can be supported is decreased from
18 to 8.5 dB.
Similar codes are constructed on the 16-level quantizer using a rate-2/3 (instead of rate-2/4)
convolutional code with memoryless partitioning of the alphabet into two cosets as shown in Figure
2.45(b). The probability of decoding error is shown in Figure 2.46(b). The operating range of the
16-level quantizer has been increased (from a correlation-SNR of ≥24 dB when R = 1 bit/sample)
to ≥15 dB when R = 2 bits/sample corresponding to Pe ≤10−4.

Appendix 2.1 Maximum a posteriori detection
53
−6
−5
−4
−3
−2
−1
0
89
10
11
12
13
14
15
16
Correlation-SNR in dB
Prob. of error in exponents of 10 
uncoded
4-state
8-state
−8
−7
−6
−5
−4
−3
−2
−1
0
14
15
16
17
18
19
20
21
22
Correlation-SNR in dB
Prob. of error in exponents of 10 
uncoded
4-state
8-state
(a) 
 (b)
Figure 2.42 Probability of error for R =1 bit/sample for memoryless quantization and
trellis-based coset construction: (a) Rs = 2 bits/sample, S is 4-level quantizer;
(b) Rs = 3 bits/sample, S is 8-level quantizer.
(04)(26)
(15)(37)
04
26
15
37
(a) 
(b) 
Figure 2.43 Code structure for R =1 bit/sample on an 8-level quantizer. (a) Source code S:
rate-2 trellis code. (b) Channel code C: rate-1 trellis code.
APPENDIX 2.1 MAXIMUM A POSTERIORI DETECTION
The BCJR algorithm
The maximum likelihood decoder deﬁned by Equation (2.20) minimizes the probability that the
whole detected sequence is in error. In an alternative concept presented in this appendix we will be
interested in minimizing the symbol error probability. The starting point is the average symbol a
posteriori probability [18, 4–17]:
APP = E {p(xk/y)}
(A2.1)
that should be maximized. In other words, the detector will decide in favor of the symbol for which
the probability of correct detection is maximized. For simplicity y will now be replaced by y. For
binary transmission, this means ﬁnding out which one of the two probabilities P(xk = 0 | y) and
P(xk = 1 | y) is larger. For this we have to compare:
k = P(xk = 1 | y)
P(xk = 0 | y)

54
ADAPTIVE CODING
−7
−6
−5
−4
−3
−2
−1
0
6
8
10
12
14
Correlaton-SNR in dB
Prob. of error in exponents of 10 
2-state
4-state
8-state
32-state
−7
−6
−5
−4
−3
−2
−1
0
10
12
14
16
18
Correlation-SNR in dB
(a)
(b)
Prob. of error in exponents of 10 
2-state
4-state
8-state
32-state
Figure 2.44 Probability of error for R = 1 bit/sample, trellis-based quantization and coset
construction. (a) Rs = 2 bits/sample, S is TCSQ based on the 8-level quantizer.
(b) Rs = 3 bits/sample, S is TCSQ based on the 16-level quantizer.
(0 8)(4 12) 
(2 10)(6 14)
(4 12)(0 8) 
(6 14)(2 10)
04 
26 
40 
62 
(a) 
(b) 
Figure 2.45 Codes obtained using the same convolutional code for memoryless quanti-
zation and trellis-based coset construction for R = 2 bits/sample. (a) 4-state
trellis (of C) on the 8-level quantizer. (b) 4-state trellis (of C) on the 16-level
quantizer.
with a unit threshold. The transmitted symbol xk is associated with one or more branches of the
trellis stage at time k, and each one of these branches can be characterized by the pair of states, say
(δk, δk+1), that it joins. Thus, we can write:
k =

(δk,δk+1):xk=1
P(y, δk,δk+1)

(δk,δk+1):xk=0
P(y, δk,δk+1)

Appendix 2.1 Maximum a posteriori detection
55
-9
−8
−7
−6
−5
−4
−3
−2
−1
6
7
8
9
10
11
12
13
Correlation-SNR in dB
Prob. of error in exponents of 10 
uncoded
4-state
8-state
−7
−6
−5
−4
−3
−2
−1
13
15
17
19
Correlation-SNR in dB
Prob. of error in exponents of 10 
 (a)
(b)
uncoded
4-state
8-state
Figure 2.46 Probability of error for R = 2 bits/sample, memoryless quantization, and
trellis-based coset construction. (a) Rs = 3 bits/sample, S is 8-level quantizer.
(b) Rs = 4 bits/sample, S is 16-level quantizer.
where the two summations are over those pairs of states for which xk = 1 and xk = 0, respectively,
and the conditional probabilities from the previous equation are replaced by joint probabilities after
using the Bayesian rule and canceling out the pdf of y, common to numerator and denominator.
Next, we need to compute the pdf P(y, δk,δk+1). By deﬁning y−
k , as components of the received
vector before time k, and y+
k , as components of the received vector after time k, we can write:
y = (y−
k , yk, y+
k )
which results in:
p(y, δk, δk+1) = p(y−
k , yk, y+
k , δk, δk+1)
= p(y−
k , yk, δk, δk+1)p(y+
k | y−
k , yk, δk, δk+1)
= p(y−
k , δk)p(yk, δk+1 | y−
k , δk)p(y+
k | y−
k , yk, δk, δk+1)
Due to the dependences among observed variables and trellis states, reﬂected by the trellis structure
or, equivalently, by the Markov chain property of the trellis states, y+
k depends on δk, δk+1, y−
k , and
yk only through δk+1, and, similarly, the pair yk, δk+1 depends on δk, y−
k , only through δk. Thus, by
deﬁning the functions:
αk(δk) ≡p(y−
k , δk)
βk+1(δk+1) ≡p(y+
k | δk+1)
γk,k+1(δk, δk+1) ≡p(yk, δk+1 | δk) = p(yk | δk, δk+1)p(δk+1 | δk)
we may write
p(y, δk, δk+1) = αk(δk)γk,k+1(δk, δk+1)βk+1(δk+1)
So, the a posteriori probability ratio can be rewritten in the form:
k =

δk,δk+1:xk=1
αk(δk)γk,k+1(δk, δk+1)βk+1(δk+1)

δk,δk+1:xk=0
αk(δk)γk,k+1(δk, δk+1)βk+1(δk+1)
(A2.2)

56
ADAPTIVE CODING
Finally, we now describe how the functions αk(δk) and βk+1(δk+1) can be evaluated recursively. We
represent the forward recursion as:
αk+1(δk+1) = p(y−
k+1, δk+1)
= p(y−
k , yk, δk+1)
=

δk
p(y−
k , yk, δk, δk+1)
=

δk
p(y−
k , δk)p(yk, δk+1|δk)
=

δk
αk(δk)γk,k+1(δk, δk+1)
with the initial condition α0(s1) = 1 (s1 denotes the initial state of the trellis) and the backward
recursion as:
βk(δk) = p(y+
k−1 | δk)
=

δk+1
p(yk, y+
k , δk+1 | δk)
=

δk+1
p(yk, δk+1 | δk)p(y+
k | δk+1)
=

δk+1
γk,k+1(δk, δk+1)βk+1(δk+1)
with the ﬁnal value βK(sK) = 1. The combination of the latter two recursions with Equation (A2.2)
forms the BCJR algorithm, named after the authors who ﬁrst derived it, Bahl, Cocke, Jelinek and
Raviv [27]. Roughly speaking, we can state that the complexity of the BCJR algorithm is about three
times that of the Viterbi algorithm.
REFERENCES
1. Hocquenghem, A. (1959) Codes correcteurs d’erreurs Chiffres (Paris), 2, 147–156.
2. Bose, R. and Ray-Chaudhuri, D. (1960) On a class of error correcting binary group codes.
Information and Control, 3, 68–79.
3. Bose, R. and Ray-Chaudhuri, D. (1960) Further results on error correcting binary group codes.
Information and Control, 3, 279–290.
4. Peterson, W. (1960) Encoding and error correction procedures for the Bose–Chaudhuri codes.
IEEE Transactions On Information Theory, IT-6, 459–470.
5. Gorenstein, D. and Zierler, N. (1961) A class of cyclic linear error-correcting codes in p > n
synbols. Journal of the Society of Industrial and Applied Mathematics, 9, 107–214.
6. Reed, I. and Solomon, G. (1960) Polynomial codes over certain ﬁnite ﬁelds. Journal of the
Society of Industrial and Applied Mathematics, 8, 300–304.
7. Berlekamp, E. (1965) On decoding binary Bose–Chaudhuri–Hocquenghem codes. IEEE Trans-
actions On Information Theory, 11, 577–579.
8. Berlekamp, E. (1968) Algebraic Coding Theory McGraw-Hill, New York, USA.
9. Massey, J. (1965) Step-by-step decoding of the Bose–Chaudhuri–Hocquenghem codes, IEEE
Transactions On Information Theory, 11, 580–585.

REFERENCES
57
10. Massey, J. (1969) Shift-register synthesis and BCH decoding. IEEE Transactions On Informa-
tion Theory, IT-15, 122–127.
11. Peterson, W. and Weldon Jr, E. (1972) Error Correcting Codes, 2nd edition, MIT Press, Cam-
bridge, MA, USA.
12. Sklar, B. (1988) Digital Communications–Fundamentals and Applications: Prentice Hall, En-
glewood Cliffs, NJ, USA.
13. Clark Jr, G. and Cain, J. (1981) Error Correction Coding for Digital Communications, Plenum
Press, New York, USA.
14. Blahut, R. (1983) Theory and Practice of Error Control Codes. Addison Wesley, Reading, MA,
USA.
15. Lin, S. and Constello Jr, D. (1982) Error Control Coding: Fundamentals and Applications,
Prentice Hall, Englewood Cliffs, NJ, USA.
16. Michelson, A. and Levesque, A. (1985) Error Control Techniques for Digital Communication,
John Wiley & Sons, New York, USA.
17. Hanzo, L. et al. (2002) Turbo coding, Turbo Equalization and Space–Time Coding John Wiley
& Sons, Inc., New York.
18. Benedetto, S. et al. (1999) Principles of Digital Transmissions With Wireless Applications,
Kluwer, New York.
19. Elias, P. (1955) Coding for noisy channels, IRE Convention Record, 4, 37–47.
20. Wozencraft, J. (1957) Sequential decoding for reliable communication, IRE Natl. Convention
rec., 5(2), 11–25.
21. Wozencraft, J. and Reiffen, B. (1961) Sequential Decoding, MIT Press, Cambridge, MA, USA.
22. Fano, R. (1963) A heuristic discussion of probabilistic coding. IEEE Transactions On Informa-
tion Theory, IT-9, 64–74.
23. Massey, J. (1963) Threshold Decoding, MIT Press, Cambridge, MA, USA.
24. Viterbi, A. (1967) Error bounds for convolutional codes and an asymptotically optimum decod-
ing algorithm. IEEE Transactions On Information Theory, IT-13, 260–269.
25. Forney, G. (1973) The Viterbi algorithm. Proceedings of the IEEE, 61, 268–278.
26. Heller, J. and Jacobs, I. (1971) Viterbi decoding for satellite and space communication. IEEE
Transactions on Communication Technology, COM-19, 835–848.
27. Bahl, L. R., Cocke, J., Jelinek, F. and Raviv, J. (1974) Optimal Decoding of Linear Codes
for Minimising Symbol Error Rate. IEEE Transactions On Information Theory, 20, 284–
287.
28. Viterbi, A. J. (1965) Optimum detection and signal selection for partially coherent binary
communication, IEEE Transactions On Information Theory, IT-11, 239–246.
29. Viterbi, A. J. (1966) Principles of Coherent Communications. McGraw Hill, New York.
30. Viterbi, A. J. (1967) Error bounds for convolutional codes and an asymptotically optimum
decoding algorithm. IEEE Transactions On Information Theory, IT-13, 260–269.
31. Viterbi, A. J. and Omura, J. K. (1979) Principles of Digital Communication and Coding.
McGraw Hill, New York.
32. Clark, G. C. and Cain, J. B. (1981) Error Correction Coding for Digital Communications.
Plenum Press, New York.

58
ADAPTIVE CODING
33. Lin, S. and Costello, D. J. (1983) Error Control Coding: Fundamentals and Applications.
Prentice Hall, Englewood Cliffs, NJ, USA.
34. Forney, Jr, G. D. (1966) Concatenated Codes. MIT Press, Cambridge, MA, USA.
35. Forney, Jr, G. D. (1970) Convolutional Codes I: Algebraic structure. IEEE Transactions On
Information Theory, IT-16, 720–738.
36. Forney, Jr, G. D. (1973) The Viterbi algorithm. IEEE Proceedings, 61, 268–278.
37. Forney, Jr, G. D. (1974a) Convolutional Codes II: Maximum-likelihood decoding, Information
and Control, 25, 223–265.
38. Forney, Jr, G. D. (1974b) Convolutional Codes III: Sequential decoding, Information and
Control, 25, 267–297.
39. Wozencraft, J. M. (1957) Sequential decoding for reliable communications, Tech. Report 325,
RLE MIT, Cambridge, MA.
40. Fano, R. M. (1963) A heuristic discussion of probabilistic decoding. IEEE Transactions On
Information Theory, IT-9, 64–74.
41. Jelinek, F. (1969) Fast sequential decoding algorithm using a stack. IBM Journal of Research
and Development, 13, 675–685.
42. Zigangirov, K. S. (1966) Some sequential decoding procedures, Problemy Peredachi Informacii,
2, 13–25.
43. Wozencraft, J. M. and Jacobs, I. M. (1965) Principles of Communication Engineering. John
Wiley & Sons, New York.
44. Savage, J. E. (1966) Sequential decoding. The computational problem. Bell Systems Technical
Journal, 45, 149–176.
45. Anderson, J. B. and Mohan, S. (1991) Source and Channel Coding: An Algorithmic Approach.
Kluwer Academic Press, Boston, MA, USA.
46. Cain, J. B., Clark, G. C. and Geist, J. M. (1979) Punctured convolutional codes of rate (n −1)/n
and simpliﬁed maximum likelihood decoding. IEEE Transactions On Information Theory, IT-
25, 97–100.
47. Yasuda, Y., Hirata, Y., Nakamura, K. and Otani, S. (1983) Development of variable-rate Viterbi
decoder and its performance characteristics, in Proceedings Sixth International Conference on
Digital Satellite Communications, Phoenix, AZ, September 1983, pp. XII-24–XII-31.
48. Yasuda, Y. Kashiki, K. and Hirata, Y. (1984) High rate punctured convolutional codes for soft
decision Viterbi decoding. IEEE Transactions On Communications, COM-32, 315–319.
49. Berrou, C. and Glavieux, A. (1996) Near optimum error-correcting coding and decoding: Turbo
codes. IEEE Transactions On Communications, COM-44, 1261–1271.
50. Benedetto, S. and Montorsi, G. (1996a) Unveiling turbocodes: Some results on parallel con-
catenated coding schemes. IEEE Transactions On Information Theory, COM-44, 591–600.
51. Divsalar, D. and Pollara, F. (1995) Turbo codes for deep-space communications. TDA Progress
Report 42–120, pp. 29–39, Jet Propulsion Laboratory, Pasadena, California.
52. Divsalar, D. and McEliece, R. J. (1996) Effective free distance of turbo codes, Electronics
Letters, 32(5).
53. Perez, L. C., Seghers, J. and Costello, D. J. (1996) A distance spectrum interpretation of turbo
codes. IEEE Transactions On Information Theory, IT-42, 1698–1709.
54. Benedetto, S. and Montorsi, G. (1996b) Design of parallel concatenated convolutional codes.
IEEE Transactions On Communications, IT-43, 409–428.

REFERENCES
59
55. Bahl, L. R., Cocke, J., Jelinek, F. and Raviv, J. (1974) Optimal decoding of linear codes for
minimizing symbol error rate. IEEE Transactions On Information Theory, IT-20, 284–287.
56. Benedetto, S., Divsalar, D. and Hagenauer, J. (eds). (1998d) Concatenated coding techniques
and iterative decoding: Sailing toward channel capacity. IEEE Journal on Selected Areas in
Communications, 16(2).
57. Benedetto, S., Divsalar, D., Montorsi, G. and Pollara, F. (1998c) Soft-input soft-output modules
for the construction and distributed iterative decoding of code networks. European Transactions
on TeleCommunications, 9, 155–172.
58. Benedetto, S., Divsalar, D., Montorsi, G. and Pollara, F. (1998b) Serial concatenation of in-
terleaved codes: Performance analysis, design, and iterative decoding. IEEE Transactions On
Information Theory, 44, 909–926.
59. Hagenauer, J., Offer, E. and Papke, L. (1996) Iterative decoding of binary block and convolu-
tional codes. IEEE Transactions On Information Theory, IT-42, 429–445.
60. Berrou, C., Glavieux, A. and Thitimajshima, P. (1993) Near Shannon limit error correcting
codes: Turbo codes. IEEE International Conference on Communications (ICC’93), Geneva,
Switzerland, pp. 1064–1070.
61. Lin, S. and Costello, D. (1982) Error Control Coding: Fundamentals and Applications Prentice
Hall, Englewod Cliffs, NJ.
62. Gordon, N., Vucetic, B., Musicki, D. and Du, J. Joint error control and speech coding for
4.8 kbps digital voice transmission over satellite mobile channels. Technical Report, Sydney
University, Sydney, Australia.
63. Wu, K., Lin, S. and Miller, M. (1982) A hybrid ARQ scheme using multiple shortened cyclic
codes, in Proceedings GLOBECOM, Miami, FL, pp. C8.61–C8.65.
64. Chase, D. (1985) Code combining – A maximum likelihood decoding approach for combining
an arbitrary number of noisy packets. IEEE Transactions On Communications, COM-33, 385–
393.
65. Sovetov, B. and Stah, V. (1982) Design of adaptive transmission systems, Energoizdal,
Leningrad, in Russian.
66. Sullivan, D. (1971) A generalization of Gallagher’s adaptive error control scheme. IEEE Trans-
actions On Information Theory, IT-17, 727–735.
67. Mandelbaum, D. (1974) An adaptive-feedback coding scheme using incremental redundancy.
IEEE Transactions On Information Theory, IT-20, 388–389.
68. Vucetic, B., Drajic, D. and Perisic, D. (1988) An algorithm for adaptive error control system
synthesis, in ISIT 1985, Brighton, England; also in Proceedings IEE, Part F, 85–94.
69. Mandelbaum, D. M. (1975) On forward error correction with adaptive decoding. IEEE Trans-
actions On Information Theory, IT-21, 230–233.
70. Kallel, S. and Haccoun, D. (1988) Sequential decoding with ARQ code combining:
A robust hybrid FEC/ARQ system. IEEE Transactions On Communications, 26, 773–780.
71. Drukarev, A. and Costello, Jr, D. J. (1983) Hybrid ARQ control using sequential decoding.
IEEE Transactions On Information Theory, IT-29, 521–535.
72. Drukarev, A. and Costello, Jr, D. J. (1982) A comparison of block and convolutional codes
in ARQ error control schemes. IEEE Transactions On Communications, COM-30, 2449–
2455.
73. Lugand, L. and Costello, Jr, D. J. (1982) A comparison of three hybrid ARQ schemes on a
non-stationary channel, in Proceedings GLOBECOM, Miami, FL, pp. C8.4.1–C8.4.5.

60
ADAPTIVE CODING
74. Hagenauer, J. and Lutz, E. (1987) Forward error correction coding for fading compensation
in mobile satellite channels. IEEE Journal on Selected Areas in Communications, SAC-5,
215–225.
75. Hagenauer, J. (1988) Rate-compatible punctured convolutional codes (RCPC codes) and their
applications. IEEE Transactions On Communications, 36, 389–400.
76. Kahn, J. M., Katz, R. H. and Pister, K. S. J. (1999) Mobile networking for smart dust, in Pro-
ceedings ACM/IEEE International Conference on Mobile Computing and Networking, Seattle,
WA Aug. 1990.
77. Cover, T. M. and Thomas, J. A. (1991) Elements of Information Theory. Wiley, New York.
78. Slepian, D. and Wolf, J. K. (1973) Noiseless coding of correlated information sources, IEEE
Transactions on Information Theory, 19, 471–480.
79. Verd´u, S. (1998) Fifty years of Shannon theory, IEEE Transactions on Information Theory, 44,
2057–2078.
80. Wyner, A. D. (1974) Recent results in the Shannon theory, IEEE Transactions on Information
Theory, 20, 2–10.
81. Wyner, A. D. (1975) On source coding with side information at the decoder, IEEE Transactions
on Information Theory, 21, 294–300.
82. Wyner, A. D. and Ziv, J. (1976) The rate-distortion function for source coding with side
information at the decoder, IEEE Transactions on Information Theory, 22, 1–10.
83. Wyner, A. D. (1978) The rate-distortion function for source coding with side information at the
decoder-II. General sources, Information Contr., 38, 60–80.
84. Cover, T. M. (1975) A proof of data compression theorem of Slepian and Wolf for ergodic
sources, IEEE Transactions on Information Theory, 21, 226–228.
85. Ahlswede, R. F. and Korner, J. (1975) Source coding with side information and a converse for
degraded broadcast channels, IEEE Transactions on Information Theory, 21, 629–637.
86. Kaspi, A. H. and Berger, T. (1982) Rate-distortion for correlated sources with partially separated
encoders, IEEE Transactions on Information Theory, 28, 828–840.
87. Berger, T. (1977) Multiterminal source coding, in Information Theory Approach to Communi-
cations (CISM Courses and Lectures), Vol. 229, G. Longo (Ed.), Springer-Verlag, Vienna/New
York.
88. Han, T. S. and Kobayashi, K. (1980) A uniﬁed achievable rate region for a general class of
multiterminal source coding systems, IEEE Transactions on Information Theory, 26, 277–288.
89. Csisz´ar, I. and K¨orner, J. (1980) Toward a general theory of source networks, IEEE Transactions
on Information Theory, 26, 155–165.
90. Zamir, R. and Shamai, S. (1998) Nested linear/lattice codes for Wyner-Ziv encoding, presented
at the IEEE Information Theory Workshop, Killarney, Ireland.
91. Flynn, T. J. and Gray, R. M. (1987) Encoding of correlated observations, IEEE Transactions on
Information Theory, 33, 773–787.
92. Gersho, A. and Gray, R. M. (1992) Vector Quantization and Signal Compression. Kluwer,
Norwell, MA.
93. Shamai (Shitz), S., Verd´u, S. and Zamir, R. (1998) Systematic lossy source/channel coding,
IEEE Transactions on Information Theory, 44, 564–579.
94. MacWilliams, F. J. and Sloane, N. J. A. (1977) The Theory of Error-Correcting Codes. Van
Nostrand, Amsterdam.

REFERENCES
61
95. Conway, J. H. and Sloane, N. J. A. (1988) Sphere Packings, Lattices and Groups. Springer-
Verlag, New York.
96. Forney, G. D. (1973) The viterbi algorithm, Proceedings of IEEE, 61, 268–278.
97. Zamir, R. and Feder, M. (1996) On lattice quantization noise, IEEE Transactions on Information
Theory, 42, 1152–1159.
98. Proakis, J. G. (1995) Digital Communications. McGraw-Hill, New York.
99. Marcellin, M. W. and Fischer, T. R. (1990) Trellis coded quantization of mem-oryless and
Gauss-Markov sources, IEEE Transactions on Communications, 38, 82–93.
100. Ungerboeck, G. (1982) Channel coding with multilevel/phase signals, IEEE Transactions on
Information Theory, 28, 55–67.
101. Forney, G. D. (1988) Coset codes, Part 1: Introduction and geometrical classiﬁcation, IEEE
Transactions on Information Theory, 34, 1123–1151.
102. Armstrong, M. A. (1988) Groups and Symmetry. Springer-Verlag, New York.
103. Forney, G. D. (1991) Geometrically uniform codes, IEEE Transactions on Information Theory,
37, 1241–1260.
104. Wachsmann, U., Fischer, R. F. H. and Huber, J. B. (1999) Multilevel codes: Theoretical concepts
and practical design rules, IEEE Transactions on Information Theory, 45, 1361–1391.
105. Garello, R. and Benedetto, S. (1995) Multilevel construction of block and trellis group codes,
IEEE Transactions on Information Theory, 41, 1257–1264.


3
Adaptive and Reconﬁgurable
Modulation
3.1
CODED MODULATION
In general we can use an M = 2b point constellation to transmit b bits of information. An example
for b = 2 is shown in Figure 3.1(a). For this example the output symbol rate is Rs = Rb/2. If we
use coding, for example a rate 2/3 convolutional encoder, and the same constellation as shown in
Figure 3.1(b), the output symbol rate and the bandwidth required will be now higher, Rs = (3/4)Rb.
The third option is shown in Figure 3.1(c). Instead of 4PSK, 8PSK (8 points constellation) is used
to transmit the encoded bits and the output symbol rate now remains the same. Because there are only
22 = 4 possible code words and 23 = 8 available constellation points, a proper choice of constellation
points used in adjacent symbol intervals provides a way to encode the signal. This subset of signal
trajectories, generated in K symbol intervals will again be referred to as a trellis in Euclidean space
and the modulation is referred to as Trellis Coded Modulation (TCM) [1–38].
The above example illustrates a need to further elaborate the efﬁciency of reconﬁguration in such
a way as to explicitly incorporate constraints imposed by the limited available bandwidth. For these
purposes, let us represent the coding gain g12 as the gain in energy per bit per noise density:
g12 = E/N0 = (PT )/N0
If there is no bandwidth limitation, the coding gain may be used in a number of ways.
1. Operate with reduced power and save the battery life.
2. Keep the same transmit power and data rate and increase the coverage of the network.
3. Increase bit rate (reduce the bit interval).
If the bandwidth is ﬁxed and the coding gain is not available, we may have to reduce the data rate
in order to maintain the required Eb/N0 for a speciﬁed QoS. This suggests that the reconﬁguration
efﬁciency, deﬁned by Equation (2.18), be further modiﬁed as follows:
Eﬀ= 10g12(dB)/10br
Dr
=
k02
k01
 10g12(dB)/10
Dr
(3.1)
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

64
ADAPTIVE AND RECONFIGURABLE MODULATION
4PSK
modulator
... 00 01 01 11 ...
T
2Tb=T=Ts
Rb=2R=2R s
... 00 01 01 11 ...
... 000 011 011 ...
2T
2T
Encoder
4PSK
modulator
4Tb=2T=3Ts
Rb=2R=(4/3)R s
Encoder
8PSK
modulator
4Tb=2T=2Ts
Rb=2R=2R s
(a)
(b)
(c)
Figure 3.1 Three digital communication schemes transmitting two bits every T seconds.
(a) Uncoded transmission with 4PSK; (b) 4PSK with a rate 2/3 encoder and
bandwidth expansion; (c) 8PSK with a rate 2/3 encoder and no bandwidth
expansion.
where br = k02/k01 is the relative change in the number of bits per symbol for the same symbol period
T . One should notice, that in Chapter 2, coding gain was deﬁned by taking into account this effect
through the coding rate Rc. In the next chapter, Equation (3.1) will be further modiﬁed to replace
br by the relative change in the system capacity. This way we remove the portion of the gain due to
bit rate reduction and take into account only those contributions due to increased efﬁciency of the
decoding algorithm.
3.1.1
Euclidean distance
The demodulator will decide in favor of the trajectory in the trellis which is closest to the received
signal (minimum distance from the received trajectory). This is characterized by the Euclidean
distance, deﬁned as:
δ2 =
K−1

i=0
|ri −xi|2
(3.2)
where ri is the received signal and xi the possible transmitted signal. In other words, the Euclidean
distance is minimized by taking xi = ˆxi, i = 0, . . . , K −1, if the received sequence is closer to
ˆxi, . . . , ˆxK−1 than to any other allowable signal sequence.
By increasing the constellation size M′ to M > M′, and selecting M′K sequences as a subset of
SK, we can have sequences which are less tightly packed and hence increase the minimum distance
among them. We obtain a minimum distance, δfree, between any two sequences, which turns out to be

CODED MODULATION
65
greater than the minimum distance, δmin, between signals in S′. Hence, use of maximum likelihood
sequence detection will yield a ‘distance gain’ of a factor of δ2
free/δ2
min.
The free distance of a TCM scheme is the minimum Euclidean distance between two paths forming
an error event.
3.1.2
Examples of TCM schemes
In order to analyze Equation (3.1) in more detail, let us assume transmission with two bits per
symbol. For such transmission a 4PSK modulation (M′ = 4) would be enough. We can expand the
constellation to M = 8, as shown in Figure 3.2, and use the trellis with S = 2 states, as shown in
Figure 3.3.
The asymptotic coding gain of a TCM scheme is deﬁned as:
γ = δ2
free(M)/ε
δ2
min(M′)/ε′
For PSK signals, M′ = 4 and δ2
min/ε′ = 2. For a TCM scheme based on the 8PSK constellation whose
signals we label {0, 1, 2, . . . ,7}, as shown in Figure 3.2, we have:
ε′ =
δ′2
4 sin2 π/8
'ε
'δ
4
3    
2
1
0
6
5                                7
Figure 3.2 M = 8 point constellation.
0
4
0
S1
S2
1                  
3
7
1
6
5
S1
x
0
4
2
6
State
bits
00
11
10
01
S2
x
1
5
3
7
2
Figure 3.3 A TCM scheme based on a two-state trellis, M′ = 4 and M = 8.

66
ADAPTIVE AND RECONFIGURABLE MODULATION
3.1.2.1
Two-state trellis
If the encoder is in state S1, the subconstellation {0, 2, 4, 6} is used. In state S2, constellation {1, 3,
5, 7} is used instead, as shown in Figure 3.3. The free distance of this TCM scheme is the smallest
among the distances between signals associated with parallel transitions (error events of length 1)
and the distances associated with a pair of paths in the trellis that originate from a common node
and merge into a single node at a later time (error events of length greater than 1). The pair of paths
yielding the free distance is shown in Figure 3.3. With δ(i, j) denoting the Euclidean distance between
signals i and j, we have the following:
δ2
free
ε
= 1
ε [δ2(0, 2) + δ2(0, 1)] = 2 + 4 sin2 π
8 = 2.586
The asymptotic coding gain over 4PSK is:
γ = 2.586
2
= 1.293 ⇒1.1 dB
(3.3)
In this case, k0 = 0 and v = 1 so that reconﬁguration efﬁciency, deﬁned by Equation (3.1), gives:
Eﬀ=
k02
k01
2
γ 2−(k0+v) = 1.293/2 = 0.646
(3.4)
For a given symbol error probability, the bit error probability (BER) will depend on the mapping
of the source bits onto the signals in the modulator’s constellation (see Figure 3.3). To minimize the
BER, this mapping should be chosen in such a way that, whenever a symbol error occurs, the signal
erroneously chosen by the demodulator differs from the transmitted one by the least number of bits.
For high signal to noise ratios, most of the errors occur by mistaking a signal for one of its nearest
neighbors. So, a reasonable choice is a mapping where neighboring signal points in the constellation
correspond to binary sequences that differ in only one digit. This is called Gray mapping. In this
case, the bit and symbol error probabilities are related as Ps(e)/b = Pb(e). For the evaluation of the
symbol error probability the reader is referred to the classical references [39–42].
3.1.2.2
Four-state trellis
In this case the trellis is as given in Figure 3.4.
0
0
0
4
6
2
6
2
2
0
1
1
5
7
3
3
1
5
7
S1
S3
S4
Figure 3.4 A TCM scheme based on a four-state trellis, M′ = 4 and M = 8.

CODED MODULATION
67
0426
1537
4062
5173
2604
3715
6240
Figure 3.5 A TCM scheme based on an eight-state trellis, M′ = 4 and M = 8.
We associate the constellation {0, 2, 4, 6} with states S1 and S3, and {1, 3, 5, 7} with S2 and S4.
In this case, the error event leading to δfree has length 1 (a parallel transition).
δ2
free
ε
= δ2(0, 4) = 4
(3.5)
γ = 4
2 = 2 ⇒3 dB
In this case, v = 2 and Equation (3.4) gives Eﬀ= 2/4 = 0.5, which is lower than Equation (3.4).
This means that effort invested is larger than the gain obtained.
3.1.2.3
Eight-state trellis
For the case of eight states, the trellis is shown in Figure 3.5. The four symbols associated with the
branches emanating from each node are used as node labels. The ﬁrst symbol in each node label
is associated with the uppermost transition from the node, the second symbol with the transition
immediately below it, etc.
The coding gain is calculated as:
δ2
free
ε
= 1
ε [δ2(0, 6) + δ2(0, 7) + δ2(0, 6)] = 2 + 4 sin2 π
8 + 2 = 4.586
(3.6)
γ = 4.586
2
= 2.293 ⇒3.6 dB
In this case, v = 3 and Equation (3.4) gives Eﬀ= 2.293/8 = 0.286, which is lower than in the
previous case of the four-state trellis. This means again that effort invested is larger than the gain
obtained.
3.1.2.4
QAM 3 bits per symbol
In this case, the trellis is as given in Figure 3.6 and the signal constellation as in Figure 3.7.
In this case, we have two subsets of points {0, 2, 5, 7, 8, 10, 13, 15} and {1, 3, 4, 6, 9, 11, 12, 14}.
For the basic 8QPSK constellation we have δ2
min/ε′ = 0.8, and coding gain can be represented as:
δ2
free
ε
= 1
ε [δ2(10, 13) + δ2(0, 1) + δ2(0, 5)] = 1
ε [0.8ε + 0.4ε + 0.8ε] = 2
γ =
2
0.8 = 2.5 ⇒3.98 dB
(3.7)

68
ADAPTIVE AND RECONFIGURABLE MODULATION
0,10,2,8,5,15,7,13
1,11,3,9,4,14,6,12
2,8,0,10,7,13,5,15
3,9,1,11,6,12,4,14
5,15,7,13,0,10,2,8
4,14,6,12,1,11,3,9
7,13,5,15,2,8,0,10
Figure 3.6 A TCM scheme based on an eight-state trellis, M′ = 8 and M = 16.
0
1
2          3
4
5
6
7
8
9
10
11
12
13
14
15
Figure 3.7 The 8 QAM constellation {0, 2, 5, 7, 8, 10, 13, 15} and the 16 QAM constellation
{0, 1, . . . , 15}.
In this case, k0 = 0 and v = 3 so that reconﬁguration efﬁciency, deﬁned by Equation (3.1),
gives:
Eﬀ= 2.5 × 2−(0+3) = 0.312
(3.8)
which is higher than in the previous example. Additional results for free distances for a number
of different schemes are given in Figure 3.8. These results can be used directly to evaluate the
reconﬁguration efﬁciency.
3.1.3
Set partitioning
The M-ary constellation is successively partitioned into 2, 4, 8, . . . , subsets with size M/2, M/4,
M/8, . . . , having progressively larger minimum Euclidean distances δ(1)
min, δ(2)
min, δ(3)
min, . . . as shown in
Figure 3.9 and Figure 3.10.
Then, in accordance with Ungerboeck’s rules, the following steps are taken:
1. Members of the same partition with the largest distance are assigned to parallel transitions.
2. Members of the next largest partition are assigned to ‘adjacent’ transitions, i.e. transitions
stemming from, or merging into, the same node.

CODED MODULATION
69
Figure 3.8 Free distance versus bandwidth efﬁciency of selected TCM schemes based on
two-dimensional modulations. (Adapted from [2]) PSK and QAM c⃝1987,
IEEE.
0
)1(
=
ic
1
)1(
=
ic
1
)
2
(
=
ic
0
)
2
(
=
ic
1
)
2
(
=
ic
0
)
2
(
=
ic
0
)3
(
=
ic
0
)3
(
=
ic
1
)3
(
=
ic
1
)3
(
=
ic
0
)
3
(
=
ic
1
)3
(
=
ic
1
)3
(
=
ic
0
)
3
(
=
ic
Figure 3.9 Set partition of an 8PSK constellation.

70
ADAPTIVE AND RECONFIGURABLE MODULATION
1
0
1                           0
1
1
1                                   1
0
0
 
0                                    0
1                                   0
)1(
ic
)
2
(
ic
)
3
(
ic
Figure 3.10 Set partition of a 16 QAM constellation.
Convolutional
encoder
1
Rate
+
m
m
)
(m
ib
)1
(
−
m
ib
)1(
ib
)1
(
+
m
ic
)
(m
ic
)1(
ic
0 0
1
0 0
1
0 1
1
0 1
M−1
x i
~
Figure 3.11 Representation of TCM.
3.1.4
Representation of TCM
A TCM encoder can be represented as a convolutional encoder encoding a block of m input bits
bi = (b(1)
i , b(2)
i , b(3)
i , . . . , b(m)
i
) into a block of m + 1 output bits ci = (c(1)
i , c(2)
i , c(3)
i , . . . , c(m)
i
), followed
by a memoryless mapper into points of the constellation of size M = 2m+1 (Figure 3.11). In the
case when there are parallel transitions, not all bits are encoded, which is represented explicitly in
Figure 3.12.
Uncoded digits cause parallel transitions; a branch in the trellis diagram of the code is now
associated with 2m−˜m signals. An example for m = 2 and ˜m = 1 is shown in Figure 3.13. The trellis
nodes are connected by parallel transitions associated with two signals each. The trellis has four
states, as does the rate 1/2 convolutional encoder, and its structure is determined by the latter.
3.1.5
TCM with multidimensional constellation
In general, we can use m channels for transmission and generate an m-dimensional trellis for the
overall signal representation.

CODED MODULATION
71
)
(m
ib
)1
( −
m
ib
)1(
ib
)1(
ic
)1
( +
m
ic
)
(m
ic
Convolutional
encoder
1
~
~
Rate
+
m
m
)
~
(m
ib
)
1
~
(
+
m
ib
m~
m
m −
~
m
m+1
)
2
~
( +
m
ic
)1
~
( +
m
ic
1
~ +
m
Uncoded
digits
Coded digits
x1
Figure 3.12 A TCM encoder where the bits that are left uncoded are shown explicitly.
+
+
)
2
(
ib
)1(
ib
)
3
(
ib
)
2
(
ic
)1(
ic
x i
~
00
10
01
11
n
σ
1
+
n
σ
Figure 3.13 A TCM encoder with m = 2, ˜m = 1 and the corresponding trellis.
00, 22
00, 22
02, 20
13, 31
13, 31
11, 33
1
0
2
3
S1
S2
⇐
Figure 3.14 A two-state TCM scheme based on a 2 × 4PSK constellation. The error event
providing the free Euclidean distance is also shown.
As an example of a TCM scheme based on multidimensional signals, consider the four-
dimensional constellation obtained by pairing (m = 2) 4PSK signals. This is denoted as 2 × 4PSK.
With the signal labeling of Figure 3.14, the 42 = 16 four-dimensional signals are:
{00, 01, 02, 03, 10, 11, 12, 13, 20, 21, 22, 23, 30, 31, 32, 33}
This constellation achieves the same minimum squared distance as two-dimensional 4PSK,
δ2
min = δ2(00, 01) = δ2(0, 1) = 2

72
ADAPTIVE AND RECONFIGURABLE MODULATION
The following subconstellation has eight signals and a minimum squared distance four:
S = {00, 02, 11, 13, 20, 22, 31, 33}
With S partitioned into the four subsets:
{00, 22}
{20, 02}
{13, 31}
{11, 33}
the choice of a two-state trellis provides the TCM scheme shown in Figure 3.14. This has a squared
free distance of 8.
If m channels are used independently, the overall data rate would be k01 = mk0 and the complexity
would be m times the complexity of the demodulation per trellis. So the normalized complexity per
bit would be:
D1 = m2k0+v
mk0
= 2k0+v
k0
For m dimensional trellises, only k02 = k0 bits are transmitted:
D2 = m2k0+v
k0
and
Dr = D2
D1
= m
Now we have:
Eﬀ= g12
 k0
mk0
  1
m

= g12
m2
(3.9)
For the previous example, g12 = γ = 8/2 = 4 and m2 = 4 so that Eﬀ= 1.
For this reason, in the next chapter we will discuss multidimensional constellations obtained by
using multiple antennas.
3.2
ADAPTIVE CODED MODULATION FOR FADING CHANNELS
In this section we describe the system which uses reconﬁguration to improve performance in time
varying fading channels [43–66]. Basically, for a better signal to noise ratio ˆγ , estimated at the
receiver side, the higher constellation M is used at the receiver, as shown in Figure 3.15.
Let τ j be the average time that the adaptive modulation scheme continuously uses the constellation
Mj. Since the constellation size is adapted to an estimate of the channel fade level (instantaneous
signal to noise ratio), several symbol times may be required to obtain a good estimate. In addition,
hardware and pulse shaping considerations generally dictate that the constellation size must remain
constant over tens to hundreds of symbols. This results in the requirement that τ j ≫T ∀j, where T
is the symbol time.
Adaptive
coded
Power
adaptation
×
+
Channel
estimate
Delay: τf
Transmitter
Channel
Receiver
Data
bits
Data
bits
n(t)
Demodulation
and
decoding
Delay: τf 
Feedback
Figure 3.15 Block diagram of a system using adaptive modulation.

ADAPTIVE CODED MODULATION FOR FADING CHANNELS
73
Binary
encode
Coset
selector
Uncoded
data bits
k bits
k+r bits
Uncoded
data bits
Buffer
Uncoded
data bits
Signal point
selector
Signal
points
Adaptive
modulator
M(γ), S(γ)
n(γ)−k
One of M(γ)
constellation
points
Channel
modulation
One of 2k+r
cosets
Figure 3.16 General structure for adaptive coded modulation.
Since each constellation Mj is associated with a range of fading values called the fading region
R j, τ j is the average time that the fading stays within the region R j. The value of τ j is inversely
proportional to the channel Doppler and also depends on the number and characteristics of the
different fade regions. In Rayleigh fading with an average SNR of 20 dB and a channel Doppler
of 100 Hz, τ j ranges from 0.7–3.9 ms, and thus, for a symbol rate of 100 ksymbols/s, the signal
constellation remains constant over tens to hundreds of symbols. Similar results hold at other SNR
values.
The ﬂat fading assumption implies that the signal bandwidth B is much less than the channel
coherence bandwidth Bc = 1/TM, where TM is the root mean square (rms) delay spread of the
channel. For Nyquist pulses B = 1/T , so ﬂat fading occurs when T ≫TM. Combining T ≫TM and
τ j ≫T we get τ j ≫T ≫TM.
Wireless channels have rms delay spreads less than 30 µs in outdoor urban areas and less than
around 1 µs in indoor environments. Taking the minimum τ j = 0.8 ms, rates of the order of tens of
ksymbols/s in outdoor channels and hundreds of ksymbols/s in indoor channels are practical for an
adaptive scheme.
Modulation uses ideal Nyquist data pulses with a ﬁxed symbol period T = 1/B. We also restrict
M(γ ) to square M-QAM constellations of size M0 = 0 and M j = 22( j−1), j = 2, . . . , J. Thus, at each
symbol time a constellation from the set {M j : j = 0, 2, . . . , J} is used – the choice of constellation
depends on the fade level γ over that symbol time. Choosing the M0 constellation corresponds to no
data transmission. Since the constellation set is ﬁnite, there will be a range of γ values over which
a particular constellation M j is used. Within that range the power must also be adapted to maintain
the desired distance d0 between the trajectories in the trellis. Thus, for each constellation M j, the
power adaptation Sj(γ ) associated with that constellation is a continuous function of γ . The basic
premise for using adaptive modulation is to keep these distances constant by varying the size M(γ ),
transmit power S(γ ), and/or symbol time T (γ ) of the transmitted signal constellation relative to γ ,
subject to an average transmit power constraint ¯S on S(γ ). By maintaining dmin(t) = dmin constant,
the adaptive coded modulation exhibits the same coding gain as coded modulation designed for an
AWGN channel with minimum code word distance dmin. The detailed system block diagram is given
in Figure 3.16.
The details about the coset codes used in the scheme can be found in [67, 68].
3.2.1
Maintaining a ﬁxed distance
Deﬁne
M(γ ) = γ
γ ∗
K
(3.10)

74
ADAPTIVE AND RECONFIGURABLE MODULATION
where γ ∗
K ≥0 is a parameter which is optimized relative to the fade distribution to maximize spectral
efﬁciency. For γ < γ ∗
K M2 the channel is not used. The constellation size M j used for a given
γ ≥γ ∗
K M2 is the largest M j for which M j ≤M(γ ). The range of γ values for which M(γ ) = M j
is thus M j ≤γ/γ ∗
K M j+1, with MJ+1 ˆ= ∞. We call this range of fading values the fading region R j
associated with constellation M j.
3.2.2
Information rate
For each γ , one redundant bit per symbol is used for the channel coding, so the number of information
bits per symbol is log2 M(γ ) −1. Thus, the information rate for a single γ is Rγ = [log2 M(γ ) −
1]/T b/s, and the corresponding spectral efﬁciency is Rγ /B = log2 M(γ ) −1, since we use Nyquist
pulses (B = 1/T ).
Spectral efﬁciency is obtained by averaging the spectral efﬁciency for each γ weighted by its
probability:
R
B =
J

j−2
(log2 M j −1)p(M j ≤γ/γK < M j+1)
(3.11)
where γK is picked to maximize Equation (3.11), subject to the average power constraint:
J

j=2
 γK M j+1
γK M j
Sj(γ )p(γ ) dγ = ¯S
(3.12)
Similarly, the reconﬁguration efﬁciency will now vary in time. Equation (3.1) can now be repre-
sented as:
Eﬀ(γ ) =
k02(γ )
k01
2
2−(k0(γ )+ν(γ ))g12(γ )
(3.13)
and the average efﬁciency is obtained as:
Eﬀ=

Eﬀ(γ )p(γ ) dγ
(3.14)
Table 3.1 presents results of simulations for adaptive and non-adaptive systems with M j ∈
{0, 4, 16, 64, 256}. One can see from the table that considerable SNR gains can be achieved with
adaptive schemes.
Table 3.1
Comparison of adaptive and non-adaptive techniques
Average SNR (dB)
Spectral efﬁciency
(bps/Hz)
BER
Trellis states
Adaptive
Non-adaptive
2
10−3
4
10.5
18.5
128
9.0
13.7
10−6
4
13
36.0
128
11.3
21.0
3
10−3
8
14.2
20.8
128
13.1
16.8
10−6
8
16.4
36.5
128
15.3
24.8

REFERENCES
75
REFERENCES
1. Ungerboeck, G. (1982) Channel coding with multilevel/phase signals. IEEE Transactions On
Information Theory, IT-28, 56–67.
2. Ungerboeck, G. (1987) Trellis-coded modulation with redundant signal sets – Part I: Introduction.
IEEE Communications Magazine, 25, 5–11; and Trellis-coded modulation with redundant signal
sets – Part 11: State of the art, Ibidem, pp. 12–21.
3. Forney, Jr., G. D. (1989) Multidimensional constellation – Part II: Voronoi constellations. IEEE
Journal on Selected Areas in Communications, 7, 941–958.
4. Forney, Jr, G. D., Gallagher, R. G., Lang, G. R., Longstaff, F. M. and Qureshi, S. H. (1984) Efﬁ-
cient modulation for band-limited channels. IEEE Journal on Selected Areas in Communications,
SAC-2, 632–647.
5. Forney, Jr, G. D. and Ungerboeck, G. (1998) Modulation and coding for linear Gaussian channels.
IEEE Transactions On Information Theory, pp. 2384–2415.
6. Forney, Jr, G. D. and Wei, L.-F. (1989) Multidimensional constellation – Part I: Introduction,
ﬁgures of merit, and generalized cross constellations. IEEE Journal On Selected Areas in Com-
munications, 7, 877–892.
7. Biglieri, E. (1984) High-level modulation and coding for nonlinear satellite channels. IEEE
Transactions On Communications, COM-32, 616–626.
8. Biglieri, E. (1992) Parallel demodulation of multidimensional signals. IEEE Transactions on
Communications, 40(10), 1581–1587.
9. Biglieri, E., Divsalar, D., McLane, P. J. and Simon, M. K. (1991) Introduction to Trellis-Coded
Modulation with Applications. Macmillan, New York.
10. Imai, H. and Hirakawa, S. (1977) A new multilevel coding method using error-correcting codes.
IEEE Transactions On Information Theory, IT-23(3), 371–377.
11. Wei, L.-F. (1987) Trellis-coded modulation with multidimensional constellations. IEEE Trans-
actions On Information Theory, IT-33, 483–501.
12. Cavers, J. K. and Ho, P. (1992) Analysis of the error performance of trellis-coded modulations
in Rayleigh-fading channels. IEEE Transactions On Communications 40(1), 74–83.
13. Liu, Y. J., Oka, I. and Biglieri, E. (1990) Error probability for digital transmission over nonlinear
channels with applications to TCM. IEEE Transactions On Information Theory, IT 36, 1101–
1110.
14. Zehavi, E. (1992) 8-PSK trellis-codes for a Rayleigh channel. IEEE Transactions On Communi-
cations, 40, 873–884.
15. Zehavi, E. and Wolf, J. K. (1987) On the performance evaluation of trellis codes. IEEE Transac-
tions On Information Theory, IT 33(2), 196–201.
16. Benedetto, S., Mondin, M. and Montorsi, G. (1994) Performance evaluation of trellis-coded
modulation schemes. IEEE Proceedings, 82, 833–855.
17. Trott, M. D., Benedetto, S., Garello, R. and Mondin, M. (1996) Rotational invariance of trellis
codes–Part I: Encoders and precoders. IEEE Transactions On Information Theory, 42, 751–765.
18. Sundberg, C.-E. W. and Seshadri, N. (1993) Coded modulation for fading channels: An overview.
European Transactions on Telecommunications 4(3), 309–324.
19. Pottie, G. J. and Taylor, D. P. (1989) Multilevel codes based on partitioning, IEEE Transactions
On Information Theory, IT-35, 87–98.

76
ADAPTIVE AND RECONFIGURABLE MODULATION
20. Pellizzoni, R., Sandri, A., Spalvieri, A. and Biglieri, E. (1997) Analysis and implementation of
an adjustable-rate multilevel coded modulation system. IEE Proceedings on Communications,
144, 1–5.
21. Caire, G., Taricco, G. and Biglieri, E. (1998) Bit-interleaved coded modulation. IEEE Transac-
tions On Information Theory, 44, 927–946.
22. Divsalar, D. and Simon, M. K. (1988) The design of trellis coded MPSK for fading cha-
nnel: Performance criteria. IEEE Transactions On Communications, 36, 1004–1012.
23. Divsalar, D. and Simon, M. K. (1988) The design of trellis coded MPSK for fading channel:
Set partitioning for optimum code design. IEEE Transactions On Communications, 36, 1013–
1021.
24. Robertson, P., Worz, T. (1998) Bandwidth-efﬁcient Turbo Trellis-coded Modulation Using
Punctured Component Codes. IEEE Journal on Selected Areas in Communications, 16, 206–
218.
25. Zehavi, E. (1992) 8-PSK trellis-codes for a Rayleigh fading channel. IEEE Transactions on
Communications, 40, 873–883.
26. Li, X. and Ritcey, J. A. (1997) Bit-interleaved coded modulation with iterative decoding. IEEE
Communications Letters, 1.
27. Li, X. and Ritcey, J. A. (1999) Trellis-coded Modulation with Bit Interleaving and Iterative
Decoding. IEEE Journal on Selected Areas in Communications, 17.
28. Li, X. and Ritcey, J. A. (1998) Bit-interleaved coded modulation with iterative decoding –
Approaching turbo-TCM performance without code concatenation, in Proceedings of CISS 1998,
(Princeton University, USA).
29. Ng, S. X., Liew, T. H., Yang, L. L. and Hanzo, L. (2001) Comparative Study of TCM, TTCM,
BICM and BICM-ID schemes. IEEE Vehicular Technology Conference, p. 265 (CDROM).
30. Ng, S. X., Wong, C. H. and Hanzo, L. (2001) Burst-by-Burst Adaptive Decision Feedback
Equalized TCM, TTCM, BICM and BICM-ID. International Conference on Communications
(ICC), pp. 3031–3035.
31. Ungerboeck, G. (1987) Trellis-coded modulation with redundant signal sets. Part 1 and 2. IEEE
Communications Magazine, 25, 5–21.
32. Pietrobon, S. S., Ungerboeck, G., Perez, L. C. and Costello, D. J. (1994) Rotationally invariant
nonlinear trellis codes for two-dimensional modulation. IEEE Transactions On Information
Theory, IT-40, 1773–1791.
33. Schlegel, C. (1997) Trellis Coded Modulation, in Trellis Coding, IEEE Press, New York, USA,
pp. 43–89.
34. Cavers, J. K. and Ho, P. (1992) Analysis of the Error Performance of Trellis-coded Modulations
in Rayleigh-fading Channels. IEEE Transactions On Communications, 40, 74–83.
35. Pietrobon, S. S., Deng, R. H., Lafanechere, A., Ungerboeck, G. and Costello, D. J. (1990)
Trellis-coded Multidimensional Phase Modulation. IEEE Transactions on Information Theory,
36, 63–89.
36. Wei, L. F. (1987) Trellis-coded modulation with multidimensional constellations. IEEE Trans-
actions On Information Theory, IT-33, 483–501.
37. Caire, G., Tariceo, G. and Biglieri, E. (1998) Bit-Interleaved Coded Modulation. IEEE Transac-
tions On Information Theory, 44, 927–946,
38. Steele, R. and Webb, W. (1991) Variable rate QAM for data transmission over Rayleigh fading
channels, in Proceeedings of Wireless’ 91, Calgary, Alberta, pp. 1–14.

REFERENCES
77
39. Hanzo, L., Wong, C. H. and Yee, M. S. (2002) Adaptive Wireless Transceivers. John Wiley &
Sons, Inc., New York, USA and IEEE Press. (For detailed contents, please refer to http://www-
mobile.ecs.soton.ac.uk.).
40. Benedetto, S. and Biglieri, E. (1999) Principles of Digital Transmission With Wireless Applica-
tions, Kluwer, New York.
41. Proakis, G. (1995) Digital Communications, 3rd editon, McGraw Hill, New York.
42. Simon, M. K. et al. (1995) Digital Communication Techniques – Signal Design and Detection,
Prentice Hall, Englewood Cliffs, NJ.
43. Sampei, S., Komaki, S. and Morinaga, N. (1994) Adaptive Modulation/TDMA Scheme for Large
Capacity Personal Multi-Media Communication Systems. IEIEE Transactions on Communica-
tions, E77-B, 1096–1103.
44. Goldsmith, A. J. and Chua, S. (1997) Variable-rate variable-power MQAM for fading channels.
IEEE Transactions On Communications, 45, 1218–1230.
45. Wong, C. and Hanzo, L. (2000) Upper-bound performance of a wideband burst-by-burst adaptive
modem. IEEE Transactions On Communications, 48, 367–369.
46. Matsuoka, H., Sampei, S., Morinaga, N. and Kamio, Y. (1996) Adaptive Modulation System
with Variable Coding Rate Concatenated Code for High Quality Multi-Media Communications
Systems, in Proceedings of IEEE VTC’96, Atlanta, USA, 28 April–1 May, 1, 487–491.
47. Lau, V. and Macleod, M. (1998) Variable rate adaptive trellis coded QAM for high bandwidth
efﬁciency applications in Rayleigh fading channels, in proceedings of IEEE Vehicular Technology
Conference (VTC’98), Ottawa, Canada, 18–21 May, pp. 348–352.
48. Goldsmith, A. J. and Chua, S. (1998) Adaptive Coded Modulation for Fading Channels. IEEE
Transactions On Communications, 46, 595–602.
49. Won, C. H., Liew, T. H. and Hanzo, L. (1999) Burst-by-Burst Turbo Coded Wideband Adaptive
Modulation with Blind Modem Mode Detection, in Proceedings of 4th ACTS Mobile Communi-
cations Summit, Sorrento, Italy, pp. 303–308.
50. Goeckel, D. (1999) Adaptive Coding for Fading Channels using Outdated Fading Estimates.
IEEE Transactions On Communications, 47, 844–855.
51. Choi, B. J., Munster, M., Yang, L. L. and Hanzo, L. (2001) Performance of Rake receiver as-
sisted adaptive-modulation based CDMA over frequency selective slow Rayleigh fading channel.
Electronics Letters, 37, 247–249.
52. Alamouti, S. M. and Kallel, S. (1994) Adaptive Trellis-coded Multiple-phase-shift Keying
Rayleigh Fading Channels. IEEE Transactions On Communications, 42, 2305–2341.
53. A1-Semari, S. and Fuja, T. (1997) I-Q TCM: Reliable communication over the Rayleigh fading
channel close to the cutoff rate. IEEE Transactions On Information Theory, 43, 250–262.
54. Webb, W. and Steele, R. (1995) Variable rate QANI for mobile radio. IEEE Transactions on
Communications, 43, 2223–2230.
55. Torrance, J. and Hanzo, L. (1996) Performance upper bound of adaptive QAM in slow Rayleigh-
fading environments, in Proceedings of IEEE ICCS’96/ISPACS’96, Singapore, 25–29 November,
pp. 1653–1657.
56. Torrance, J. M., Hanzo, L. and Keller, T. (1999) Interference aspects of adaptive modems over
slow Rayleigh fading channels. IEEE Transactions on Vehicular Technology, 48, 1527–1545.
57. Matsuoka, H., Sampei, S., Morinaga, N. and Kamio, Y. (1996) Adaptive modulation systems with
variable coding rate concatenated code for high quality multi-media communication systems, in
Proceedings of IEEE VTC’96, Atlanta, USA, 28 April–1 May, pp. 487–491.

78
ADAPTIVE AND RECONFIGURABLE MODULATION
58. Chua, S. G. and Goldsmith, A. J. (1996) Variable-rate variable-power mQAM for fading channels,
in Proceedings of IEEE VTC’96, Atlanta, USA, 28 April–1 May, pp. 815–819.
59. Torrance, J. and Hanzo, L. (1996) Optimisation of switching levels for adaptive modulation in a
slow Rayleigh fading channel. Electronics Letters, 32, 1167–1169.
60. Torrance, J. and Hanzo, L. (1996) On the upper bound performance of adaptive QAM in a slow
Rayleigh fading. IEE Electronics Letters, 169–171.
61. Lau, V. and Macleod, M. (2001) Variable-rate adaptive trellis coded QAM for ﬂat-fading channels.
IEEE Transactions On Communications, 49, 1550–1560.
62. Lau, V. and Marie, S. (1999) Variable rate adaptive modulation for DS-CDMA. IEEE Transactions
On Communications, 47, 577–589.
63. Chua, S. and Goldsmith, A. (1998) Adaptive Coded Modulation for Fading Channels. IEEE
Transactions On Communications, 46, 595–602.
64. Liu, X., Ormeci, P., Wesel, R. and Goeckel, D. (2001) Bandwidth-efﬁcient, low-latency adaptive
coded modulation schemes for time-varying channels, in Proceedings of IEEE International
Conference on Communications, Helsinki, Finland.
65. Torrance, J. and Hanzo, L. (1996) Demodulation level selection in adaptive modulation. Elec-
tronics Letters, 32, 1751–1752.
66. Nanda, S., Balachandran, K. and Kumar, S. (2000) Adaptation techniques in wireless packet data
services. IEEE Communications Magazine, 38, 54–64.
67. Forney, Jr, G. D. (1988a) Coset codes – Part I: Introduction and geometrical classiﬁcation. IEEE
Transactions On Information Theory, 34, 1123–1151.
68. Forney, Jr, G. D. (1988b) Coset codes – Part II: Binary lattices and related codes. IEEE Transac-
tions On Information Theory, 34, 1152–1187.

4
Space–Time Coding
4.1
DIVERSITY GAIN
In Chapters 2 and 3 the coding gain was used as a performance measure. Before we go into a detailed
discussion on space–time coding, diversity gain will be deﬁned and discussed. In Chapter 3 we brieﬂy
discussed the multidimensional trellis and pointed out the relatively high efﬁciency of such a concept.
By using an additional dimension we provide a diversity effect which results in a considerable gain.
These new dimensions may be additional frequency bands, different time slots or delayed replicas of
the signal, or different antennas, resulting in frequency, time or space diversity respectively. In this
section we elaborate the concept of diversity gain by using space diversity. In the subsequent sections
of the chapter we will discuss space–time coding, where the concept of coding and diversity gain is
combined into an integral performance measure.
A classical space diversity set-up with one transmitting and two receiving antennas is shown in
Figure 4.1. The antenna diversity is realized in the receiver, hence the name receiver diversity. The
following notation is used in the ﬁgure: the channel between the transmit antenna and the receiver
antenna zero is denoted h0; that between the transmit antenna and the receiver antenna one is h1,
where:
h0 = α0e jθ0
h1 = α1e jθ1
(4.1)
The resulting received baseband signals at antennas zero and one are:
r0 = h0s0 + n0
r1 = h1s0 + n1
(4.2)
where n0 and n1 represent complex noise and interference.
In accordance with the discussion in Chapter 2, the ML decoder will choose signal si if and only
if:
d2(r0, h0si) + d2(r1, h1si) ≤d2(r0, h0sk) + d2(r1, h1sk)
∀i ̸= k
(4.3)
where d2(x, y) is the squared Euclidian distance between x and y:
d2(x, y) = (x −y)(x∗−y∗)
(4.4)
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

80
SPACE–TIME CODING
Channel
estimator
Channel
estimator
Maximum likelihood
detector
Interference
r0 = h0s0 + n0
r1 = h1s0 + n1
h0 =   0e
and noise
Interference
and noise
n0
n1
h0
h1
h0
*
s0
h1
*
*
*
jθ0
h1 =   0e jθ1
α
α
∼
Figure 4.1 Two branch maximum ration receiver combiner (MRRC).
A two branch Maximum Ratio Receiver Combiner (MRRC) would ﬁrst create the signal:
˜s0 = h∗
0r0 + h∗
1r1
= h∗
0(h0s0 + n0) + h∗
1(h1s0 + n1)
=

α2
0 + α2
1

s0 + h∗
0n0 + h∗
1n1
(4.5)
with an equivalent distance deﬁned as:
d2
i = (˜s0 −βsi)(˜s0 −βsi)∗;
β = α2
0 + α2
1
(4.6)
and the ML detector would choose si if:

α2
0 + α2
1
 |si|2 −˜s0s∗
i −˜s∗
0si ≤

α2
0 + α2
1

|sk|2 −˜s0s∗
k −˜s∗
0sk
∀i ̸= k
(4.7)
If Equation (4.6) is used in (4.7), the latter can also be represented in the following form. Choose
si if:

α2
0 + α2
1 −1

|si|2 + d2 (˜s0, si) ≤

α2
0 + α2
1 −1

|sk|2 + d2 (˜s0, sk)
∀i ̸= k
(4.8)
For PSK signals (equal energy constellations):
|si|2 = |sk|2 = Es
∀i, k
(4.9)
where Es is the energy of the signal. So, for PSK signals, the decision rule (4.8) may be simpliﬁed to:
Choose si if
d2 (˜s0, si) ≤d2 (˜s0, sk)
∀i ̸= k
(4.10)
4.1.1
Two-branch transmit diversity scheme with one receiver
Using two antennas in a mobile receiver might prove difﬁcult in practice. For this reason, in this sub-
section we demonstrate how the same effect and diversity gain may be obtained by using two antennas
at the transmitter and only one antenna at the receiver [1]. Implementing two antennas at the base sta-
tion in mobile communication networks is a much simpler task. The system block diagram is shown in
Figure 4.2.

DIVERSITY GAIN
81
s0
- s1
*
s1
s0
*
Channel
estimator
Combiner
Maximum likelihood detector
Interference
and noise
n0
n1
tx antenna 0
tx antenna 1
rx antenna
h0
h1
h0
h1
s1
h1 =   0e jθ1
α
h0 =   0e jθ0
α
∼
s0
∼
Figure 4.2 Two branch transmit diversity scheme with one receiver [1] c⃝1998, IEEE.
Table 4.1
Space–time coding rules
Antenna 0
Antenna 1
time t
s0
s1
time t + T
−s∗
1
s∗
0
4.1.1.1
The encoding and transmission sequence
The encoding is done in space and time (space–time (ST) coding) as deﬁned in Table 4.1. The
encoding may also be done in space and frequency. Instead of two adjacent symbol periods, two
adjacent frequency subbands may be used (space–frequency coding).
4.1.1.2
The received signal
Assuming that the fading is constant across two consecutive symbols we have:
h0(t) = h0(t + T ) = h0 = α0e jθ0
h1(t) = h1(t + T ) = h1 = α1e jθ1
(4.11)
where T is the symbol interval. The received signals in two adjacent symbol intervals can be
represented as:
r0 = r(t) = h0s0 + h1s1 + n0
r1 = r(t + T ) = −h0s∗
1 + h1s∗
0 + n1
(4.12)

82
SPACE–TIME CODING
Channel
estimator
Combiner
Maximum likelihood detector
Interference
and noise
n0
n1
tx antenna 0
tx antenna 1
h0
h1
S0
S1
h0
h1
Channel
estimator
h2
h3
Interference
and noise
n2
n3
rx antenna 1
h0
h2
h2
h1
h3
h3
~
~
Figure 4.3 Two transmitters and two receivers [1] c⃝1998, IEEE.
4.1.1.3
The combining scheme
The signals received in two adjacent symbol intervals are combined as follows:
˜s0 = h∗
0r0 + h1r∗
1
(4.13)
˜s1 = h∗
1r0 + h0r∗
1
˜s0 =

α2
0 + α2
1

s0 + h∗
0n0 + h1n∗
1
(4.14)
˜s1 =

α2
0 + α2
1

s1 −h0n∗
1 + h∗
1n0
4.1.1.4
ML decision rule
For each of the signals s0 and s1 the decision rule is the same, Inequality (4.3) or (4.10). The resulting
combined signals are equivalent to that obtained from two branch MRRC given by Equation (4.5).
The only difference is phase rotations on the noise components which do not degrade the effective
SNR. The resulting diversity order from the new branch transmit diversity scheme with one receiver
is equal to that of two branch MRRC. This is known as Alamouti code [1].
4.1.2
Two transmitters and M receivers
There may be applications where a higher order of diversity is needed and multiple receive antennas
are also feasible. In such cases, it is possible to provide a diversity order of 2M, with two transmit
and M receive antennas. Figure 4.3 represents an illustration of a special case of two transmit and two
receive antennas. The generalization to N transmit and M receive antennas will be further elaborated
in the subsequent sections. The notation is explained in Tables 4.2 and 4.3.
The space–time coding rule is given again by Table 4.1
Table 4.2
Channel notation
rx antenna 0
rx antenna 1
tr antenna 0
h0
h2
tr antenna 1
h1
h3

DIVERSITY GAIN
83
Table 4.3
Signal notation
rx antenna 0
rx antenna 1
time t
r0
r2
time t + T
r1
r3
4.1.2.1
The received signal
The received signals in two adjacent symbol intervals with notation given in Table 4.3 are:
r0 = h0s0 + h1s1 + n0
r1 = −h0s∗
1 + h1s∗
0 + n1
r2 = h2s0 + h3s1 + n2
r3 = −h2s∗
1 + h3s∗
0 + n3
(4.15)
where n0, n1, n2, and n3 are complex random variables representing receiver thermal noise and
interference.
4.1.2.2
The combiner
The combiner is deﬁned by the following rule:
˜s0 = h∗
0r0 + h1r∗
1 + h∗
2r2 + h3r∗
3
˜s1 = h∗
1r0 −h0r∗
1 + h∗
3r2 −h2r∗
3
(4.16)
˜s0 =

α2
0 + α2
1 + α2
2 + α2
3

s0 + h∗
0n0 + h1n∗
1 + h∗
2n2 + h3n∗
3
˜s1 =

α2
0 + α2
1 + α2
2 + α2
3

s1 −h0n∗
1 + h∗
1n0 −h2n∗
3 + h∗
3n2
(4.17)
So, the order of 2 × 2 = 4 diversity is achieved. For uncorrelated channel and noise, α2
i = α2, and
perfect channel estimation, the signal to noise ratio is given as:
(4α2)2/4α2N0 = 4α2/N0
(4.18)
4.1.2.3
ML decoder
The ML decoder will be operating as follows:
For s0, choose si if:

α2
0 + α2
1 + α2
2 + α2
3 −1

|si|2 + d2(˜s0, si) ≤

α2
0 + α2
1 + α2
2 + α2
3 −1

|sk|2 + d2(˜s0, sk)
(4.19)
For s1, choose si if:

α2
0 + α2
1 + α2
2 + α2
3 −1

|si|2 + d2(˜s1, si) ≤

α2
0 + α2
1 + α2
2 + α2
3 −1

|sk|2 + d2(˜s1, sk)
(4.20)
4.1.2.4
The BER performance
The BER results are shown in Figure 4.4. Signiﬁcant diversity gain measured in SNR improvements
is evident.

84
SPACE–TIME CODING
10
20
SNR (dB)
30
40
0
10−6
10−5
10−4
10−2
10−1
1
Pb
10−3
No diversity (1Tx, 1Rx)
MRRC (2Tx, 1Rx)
MRRC
gain
(1Tx, 2Rx)
(2 Tx, 2 Rx)
(1 Tx, 4 Rx)
Figure 4.4 The BER performance comparison of coherent BPSK with MRRC and two
branch transmit diversity in Rayleigh fading.
4.2
SPACE–TIME CODING
In the previous section we introduced the concept of space–time coding. We are now going to look
more closely at the general model and bring in more detail in the analysis of such a system. In general,
we will consider a system where data is encoded by a channel code and the encoded data is split into
n streams that are simultaneously transmitted using n transmit antennas. The received signal at each
receive antenna is a linear superposition of the n transmitted signals plus noise.
4.2.1
The system model
The system consists of n antennas in the base station and m antennas in the mobile. Data is encoded
by the channel encoder, S/P converted, and divided into n streams of data. Each stream of data is used
as the input to a pulse shaper. The output of each shaper is then modulated. At each time slot with
index l, the output of modulator i is a signal ci
l that is transmitted using transmit antenna (Tx antenna)
i for 1 < i < n.
The n signals are transmitted simultaneously, each from a different transmit antenna, and all of
these signals have the same transmission period T. The signal at each receive antenna is a noisy
superposition of the n transmitted signals corrupted by Rayleigh or Rician fading.
Elements of the signal constellation are contracted by a factor of √Es chosen so that the average
energy of the constellation is 1.
At the receiver, the demodulator computes a decision statistic based on the received signals arriving
at each receive antenna 1 < j < m. The signal r j
l received by antenna j at discrete time l is given by:
r j
l =
n

i=1
αi, jc j
l

Es + η j
l
(4.21)
where the noise η j
l at discrete time l is modeled as independent samples of a zero mean complex
Gaussian random variable with variance N0/2 per dimension. The coefﬁcient αi, j is the path gain
from transmit antenna ito receive antenna j. It is assumed that these path gains are constant during a
frame of t symbol intervals and vary from one frame to another (quasistatic ﬂat fading).

SPACE–TIME CODING
85
4.2.2
The case of independent fade coefﬁcients
The ML receiver will decide erroneously in favor of a signal:
e = e1
1e2
1 · · · en
1e1
2e2
2 · · · en
2 · · · e1
l e2
l · · · en
l
assuming that
c = c1
1c2
1 · · · cn
1c1
2c2
2 · · · cn
2 · · · c1
l c2
l · · · cn
l
was transmitted, with a probability that can be approximated by:
P(c →e|αi, j, i = 1, 2, . . . , n, j = 1, 2, . . . , m) ≤exp (−d2(c, e)Es/4N0)
(4.22)
where N0/2 is the noise variance per dimension and
d2(c, e) =
m

j=1
t
l=1

n

i=1
αi, j

ci
l −ei
l

2
(4.23)
is the distance between the two trajectories measured in a time frame of t symbol intervals. Setting
Ωj = (α1, j, . . . , αn, j), we rewrite Equation (4.23) as:
d2(c, e) =
m

j=1
t
l=1
n

i′=1
αi, jαi′ , j
l
t=1

ci
t −ei
t

ci′
t −ei′
t

.
where ¯x stands for the complex conjugate of x. After simple manipulations, we observe that:
d2(c, e) =
m

j=1
ΩjAΩ∗
j
(4.24)
where x∗stands for the transpose conjugate, and elements of matrix A are deﬁned as Apq = xp · xq
and xp = (cp
1 −ep
1 , cp
2 −ep
2 , . . . , cp
l −ep
l ) for 1 ≤p, q ≤n. Thus:
P(c →e|αi, j, i = 1, 2, . . . , n, j = 1, 2, . . . , m) ≤
m

j=1
exp (−ΩjA(c, e)Ω∗
j Es/4N0)
(4.25)
where Apq = 	l
t=1 (cp
t −ep
t )(cq
t −eq
t ). This can be also represented as:
A = B∗B
(4.26)
where
B = {bit} =

ei
t −ci
t

Matrix B is given in an explicit form later by Equation (4.48). From now on we will express
d2(c, e) in terms of the eigenvalues of the matrix A(c, e) deﬁned by VA(c, e)V∗= D = diag {λi}. For
details of eigenvalue decomposition, see Appendix 5.1.
If we deﬁne vector (β1, j, . . . , βn, j) = ΩjV∗, then we have:
ΩjA(c, e)Ω∗
j =
n

i=1
λi|βi, j|2
(4.27)
At this point recall that αi, j are samples of a complex Gaussian random variable with mean αi j.
Let
K j = (α1 j, α2 j, α3 j, · · · , αnj)
(4.28)
Since V is unitary, {v1, v2, . . . , vn} is an orthonormal basis of Cn and βi, j are independent complex
Gaussian random variables with variance 0.5 per dimension and mean K j · vi. If Ki, j = |βi, j|2 =
|K j · vi|2, then |βi, j| are independent Rician distributions with pdf:
p(|βi, j|) = 2|βi, j| exp(−|βi, j|2 −Ki, j)I0(2|βi, j|

Ki, j)
(4.29)

86
SPACE–TIME CODING
for |βi, j| ≥0, where I0(·) is the zero order modiﬁed Bessel function of the ﬁrst kind. To compute an
upper bound on the average probability of error, we simply average:
m

j=1
exp

−(Es/4N0)
n

i=1
λi|βi, j|2

(4.30)
with respect to independent Rician distributions of |βi, j| to arrive at:
P(c →e) ≤
m

j=1


n
i=1
1
1 + Es
4N0
λi
exp

−
Ki, j
Es
4N0
λi
1 + Es
4N0
λi




(4.31)
4.2.3
Rayleigh fading
In this case ¯α = 0, giving Ki, j = 0 for all i and j. Thus Inequality (4.31) can be written as:
P(c →e) ≤


1
n
i=1
(1 + λi Es/4N0)


m
(4.32)
Let r denote the rank of matrix A, then the kernel of A has dimension n −r and exactly n −r
eigenvalues of A are zero. Say the non-zero eigenvalues of A are λ1, λ2, . . . , λr, then it follows from
Inequality (4.32) that:
P(c →e) ≤
 r
i=1
λi
−m
(Es/4N0)−rm
(4.33)
Thus, a diversity advantage of mr and a coding advantage of (λ1λ2 · · · λr)1/r is achieved. Recall
that λ1λ2 · · · λr is the absolute value of the sum of determinants of all the principal r × r cofactors of
A, Moreover, it is easy to see that the ranks of A(c, e), and B(c, e), deﬁned as A(c, e) = B(c, e)*B(c,
e), are equal.
4.2.4
Design criteria for Rayleigh space–time codes
The rank criterion. In order to achieve the maximum diversity mn, the matrix B(c, e) has to be full
rank for any code words c and e. If B(c, e) has minimum rank r over the set of two tuples of distinct
code words, then a diversity of rm is achieved.
The determinant criterion. Suppose that a diversity beneﬁt of rm is our target. The minimum of r
roots of the sum of determinants of all r × r principal cofactors of A(c, e) = B(c, e)*B(c, e) taken
over all pairs of distinct code words e and c corresponds to the coding advantage, where r is the rank
of A(c, e). Special attention in the design must be paid to this quantity for any code words e and c.
The design target is making this sum as large as possible. If a diversity of nm is the design target,
then the minimum of the determinant of A(c, e) taken over all pairs of distinct code words e and c
must be maximized.
For large signal to noise ratios,
P(c →e) ≤
 Es
4N0
−rm  r
i=1
λi
−m 

m

j=1
r
i=1
exp(−Ki, j)


(4.34)

SPACE–TIME CODING
87
Thus, a diversity of rm and a coding advantage of:
(λ1λ2 · · · λr)−1/r


m

j=1
r
i=1
exp(−Ki, j)


1/rm
(4.35)
is achievable. The derivation in this section is based on the original work presented in [2].
4.2.5
Code construction
In the presence of one receive antenna, little can be gained in terms of capacity increase by using
more than four transmit antennas. Similarly, if there are two receive antennas, almost all the capacity
increase can be obtained using n = 6 transmit antennas.
As has been indicated earlier, we can use multidimensional trellis codes for a wireless commu-
nication system that employs n transmit antennas and (optional) receive antenna diversity where the
channel is a quasistatic ﬂat fading channel. The encoding for these trellis codes is obvious, with the
exception that at the beginning and the end of each frame, the encoder is required to be in the zero
state. At each time t, depending on the state of the encoder and the input bits, a transition branch is
chosen. If the label of this branch is q1
t q2
t · · · qn
t , then transmit antenna i is used to send constellation
symbols qi
t , i = 1, 2, · · · , n and all of these transmissions are simultaneous. Let us consider the 4PSK
and 8PSK constellations as shown in Figure 4.5.
4.2.5.1
Examples
A number of results have been published on space–time code design [1–46]. We will present several
illustrations.
In Figure 4.5 the ﬁrst signal constellation is 4PSK, where the signal points are labeled by the
elements of Z4, the ring of integers modulo 4. We consider the four-state trellis code shown in Figure
4.6 [2]. The edge label x1x2 indicates that signal x1 is transmitted over the ﬁrst antenna and that
signal x2 is transmitted over the second antenna. This code has a very simple description in terms of
1
2
0
3
2
4
0
6
5
7
3
1
Figure 4.5 4PSK and 8PSK constellations.
00 01 02 03
10 11 12 13
20 21 22 23
30 31 32 33
Figure 4.6 2-space–time code, 4PSK, four states, 2 b/s/Hz.

88
SPACE–TIME CODING
State                                  Transmitted symbols
2
1
2
3
4
5
6
7
22, 21, 22, 23
12, 11, 12, 13
22, 21, 22, 23
32, 31, 32, 33
22, 23, 22, 21
32, 33, 32, 31
22, 23, 22, 21
12, 13, 12, 11
20
22, 21, 22, 23
12, 11, 12, 13
22, 21, 22, 23
32, 31, 32, 33
22, 23, 22, 21
32, 33, 32, 31
22, 23, 22, 21
12, 13, 12, 11
00, 01, 02, 03
10, 11, 12, 13
20, 21, 22, 23
30, 31, 32, 33
22, 23, 20, 21
32, 33, 30, 31
02, 03, 00, 01
12, 13, 10, 11
(a)
)1,0
(
)2
,0
(
)0
,1(
)0,2
(
)2
,2
(
)
,
(
1
1
2
2
1
k
k
k
k
k
k
k
a
b
a
b
a
x
x
+
+
+
+
=
−
−
−
)1,0
(
)2
,0
(
)2
,1(
)
0,2
(
)0
,2
(
)2
,0
(
)
,
(
1
1
2
2
2
1
k
k
k
k
k
k
k
k
a
b
a
b
a
b
x
x
+
+
+
+
+
=
−
−
−
−
(b)
Figure 4.7 2-space–time codes, 4PSK(a), 8 and (b)16 states, 2 b/s/Hz.
a sequence (bk, ak) of binary inputs [2]. The output signal pair xk
1xk
2 at time k is given by:

xk
1, xk
2

= bk−1(2, 0) + ak−1(1, 0) + bk(0, 2) + ak(0, 1)
(4.36)
where the addition takes place in Z4.

xk
1, xk
2

= ak−2(2, 2) + bk−1(2, 0) + ak−1(1, 0) + bk(0, 2) + ak(0, 1)

xk
1, xk
2

= bk−2(0, 2) + ak−2(2, 0) + bk−1(2, 0) + ak−1(1, 2) + bk(0, 2) + ak(0, 1)
Figure 4.7 represents 2-space–time codes for the 4PSK constellation and 8 and 16 state encoders
for 2 b/s/Hz. The two output bits (xk
1, xk
2) as a function of the input bits are also shown in the ﬁgure.

SPACE–TIME CODING
89
Figure 4.8 2-space–time code, 4PSK, 32 states, 2 b/s/Hz.
Several additional examples are given in Figures 4.8–4.11 [2].

xk
1, xk
2

= ak−3(2, 2) + bk−2(3, 3) + ak−2(2, 0)
+ bk−1(2, 2) + ak−1(1, 1)
+ bk(0, 2) + ak(0, 1)
(4.37)
Assuming that the input to the encoder at time k is the three input bits (dk, bk, ak), the output of
the encoder at time k is:

xk
1, xk
2

= dk−1(4, 0) + bk−1(2, 0) + ak−1(5,0)
+ dk(0, 4) + bk(0, 2) + ak(0, 1)
(4.38)
where the computation is performed in Z8, the ring of integers modulo 8, and the elements of the
8PSK constellation have the labeling given in Figure 4.5.
If r j
t is the received signal at receive antenna j at time t, the branch metric for a transition labeled
q1
t q2
t · · · qn
t is given by:
m

j=1
r j
t −
n

i=1
αi, jqi
t

2
(4.39)

90
SPACE–TIME CODING
2
1
2
3
4
5
6
7
00, 01, 02, 03, 04, 05, 06, 07
52, 51, 52, 53, 54, 55, 56, 57
22, 21, 22, 23, 24, 25, 26, 27
72, 71, 72, 73, 74, 75, 76, 77
42, 41, 42, 43, 44, 45, 46, 47
12, 11, 12, 13, 14, 15, 16, 17
62, 61, 62, 63, 64, 65, 66, 67
32, 31, 32, 33, 34, 35, 36, 37
State                                                                 Transmitted symbols
0
1
2
3
4
5
6
7
50, 51, 52, 53, 54, 55, 56, 57
20, 21, 22, 23, 24, 25, 26, 27
70, 71, 72, 73, 74, 75, 76, 77
40, 41, 42, 43, 44, 45, 46, 47
10, 11, 12, 13, 14, 15, 16, 17
60, 61, 62, 63, 64, 65, 66, 67
30, 31, 32, 33, 34, 35, 36, 37
Figure 4.9 2-space–time code, 8PSK, eight states, 3 b/s/Hz.
2
1
2
3
4
5
6
7
22, 21, 22, 23, 24, 25, 26, 27
51, 52, 53, 54, 55, 56, 57, 52
22, 23, 24, 25, 26, 27, 22, 21
73, 74, 75, 76, 77, 72, 71, 72
44, 45, 46, 47, 42, 41, 42, 43
15, 16, 17, 12, 11, 12, 13, 14
66, 67, 62, 61, 62, 63, 64, 65
37, 32, 31, 32, 33, 34, 35, 36
State                                                                 Transmitted symbols
15, 16, 17, 12, 11, 12, 13, 14
66, 67, 62, 61, 62, 63, 64, 65
37, 32, 31, 32, 33, 34, 35, 36
22, 21, 22, 23, 24, 25, 26, 27
51, 52, 53, 54, 55, 56, 57, 52
22, 23, 24, 25, 26, 27, 22, 21
73, 74, 75, 76, 77, 72, 71, 72
44, 45, 46, 47, 42, 41, 42, 43
8
9
10
11
12
13
14
15
2
1
2
3
4
5
6
7
0
1
2
3
4
5
6
7
22, 21, 22, 23, 24, 25, 26, 27
51, 52, 53, 54, 55, 56, 57, 52
22, 23, 24, 25, 26, 27, 22, 21
73, 74, 75, 76, 77, 72, 71, 72
44, 45, 46, 47, 42, 41, 42, 43
15, 16, 17, 12, 11, 12, 13, 14
66, 67, 62, 61, 62, 63, 64, 65
37, 32, 31, 32, 33, 34, 35, 36
00, 01, 02, 03, 04, 05, 06, 07
51, 52, 53, 54, 55, 56, 57, 50
22, 23, 24, 25, 26, 27, 20, 21
73, 74, 75, 76, 77, 70, 71, 72
44, 45, 46, 47, 40, 41, 42, 43
15, 16, 17, 10, 11, 12, 13, 14
66, 67, 60, 61, 62, 63, 64, 65
37, 30, 31, 32, 33, 34, 35, 36
15, 16, 17, 12, 11, 12, 13, 14
66, 67, 62, 61, 62, 63, 64, 65
37, 32, 31, 32, 33, 34, 35, 36
22, 21, 22, 23, 24, 25, 26, 27
51, 52, 53, 54, 55, 56, 57, 52
22, 23, 24, 25, 26, 27, 22, 21
73, 74, 75, 76, 77, 72, 71, 72
44, 45, 46, 47, 42, 41, 42, 43
15, 16, 17, 10, 11, 12, 13, 14
66, 67, 60, 61, 62, 63, 64, 65
37, 30, 31, 32, 33, 34, 35, 36
00, 01, 02, 03, 04, 05, 06, 07
51, 52, 53, 54, 55, 56, 57, 50
22, 23, 24, 25, 26, 27, 20, 21
73, 74, 75, 76, 77, 70, 71, 72
44, 45, 46, 47, 40, 41, 42, 43
8
9
11
12
13
14
15
8
9
11
12
13
14
15
Figure 4.10 2-space–time code, 8PSK, 16 states, 3 b/s/Hz.
The Viterbi algorithm is then used to compute the path with the lowest accumulated metric. The
frame error probability for four different examples of the coding is shown in Figures 4.12–4.14. The
gain shown in these ﬁgures should be used in expressions for Eff discussed in Chapters 2 and 3 to
evaluate the overall reconﬁguration efﬁciency for different schemes. In general, the expression for
efﬁciency should be further modiﬁed as follows.

SPACE–TIME CODING
91
Figure 4.11 2-space–time code, 8PSK, 32 states, 3 b/s/Hz.
4.2.6
Reconﬁguration efﬁciency of space–time coding
Let rm be the diversity advantage of the system with n transmit and m receive antennas. For a block
of l symbols, with constellation Q of 2b elements, the equivalent rate of transmission R in a system
with ST coding satisﬁes:
R ≤log[A2bl (n,r)]
l
(4.40)
in bits per second per Hertz, where A2bl (n,r) is the maximum size of a code length n and minimum
Hamming distance r deﬁned over an alphabet of size 2bl [2].
On the other hand, if b is the transmission rate of a multiple antenna system employed in
conjunction with an r-space–time trellis code, the trellis complexity of the space–time code is at
least 2b(r−1) [2].
The reconﬁguration gain is deﬁned as the solution to:
P(c →e |r, m, g(ST)Es/4T ) = P(c →e |r = 1, m = 1, Es/4T )
(4.41)
Using Inequality (4.33) for Rayleigh fading, Equation (4.41) gives:
 r
i=1
λi
−m
(g(ST)Es/4N0)−rm = λ−1
1 (Es/4N0)

92
SPACE–TIME CODING
SNR[dB]
13
14
15
16
17
18
10 −2
10 −1
10 0
Frame error probability
×
×
×
×
×
×
×
×
×
×
×
×
4  states
8  states
16  states
32  states
64  states
×
×
×
×
×
×
×
×
×
×
×
×
×
×
Figure 4.12 Codes for 4PSK with rate 2 b/s/Hz that achieve diversity 2 with one receive
and two transmit antennas.
resulting in
g(ST) =

λ−1
1 (Es/4N0)
rm


Es/4N0
 r
i=1
λi
−1/r


(4.42)
The relative complexity over the signal constellation Q with 2b elements is:
Dr(ST) > 2b(r−1)/2b = 2b(r−2)
(4.43)
Now the reconﬁguration efﬁciency deﬁned by Equation (3.1) becomes:
Eff =
 R
b
 g(ST)
Dr
=
"
λ−1
1 (Es/4N0)
#rm


Es/4N0
 r
i=1
λi
−1/r


 R
b

2−b(r−2)
(4.44)
Now we continue with different examples of ST codes. Consider the 8PSK signal constellation,
where the encoder maps a sequence of three bits akbkck at time k to ii with i = 4ak + 2bk + ck.
It is easy to show that the equivalent space–time code for this delay diversity code has the trellis
representation given in Figure 4.15. The minimum determinant of this code is (2 −
√
2)2. As in the
4PSK case, one can improve the coding advantage of the above codes by constructing encoders with
more states. An example is given in Figure 4.16 [2] with the constellation in Figure 4.17.
4.2.6.1
An r space–time trellis code for r > 2
As an example, a 4-space–time code for four transmit antennas is considered. The limit on the
transmission rate is 2 b/s/Hz. Thus, the trellis complexity of the code is bounded below by 64. The input
to the encoder is a block of length two of bits a1, b1, corresponding to an integer i = 2a1 + b1 ∈Z4.
The 64 states of the trellis correspond to the set of all three tuples (s1, s2, s3) with si ∈Z4 for

SPACE–TIME CODING
93
10−2
10−1
100
×
×
4 states
8 states
16 states
32 states
64 states
7           7.5
8          8.5
9           9.5
12
×
×
×
×
×
×
×
×
Frame error probability
×
×
.5
.5
10
SNR (dB)
×
×
×
×
×
×
×
×
(a)
10−2
10−1
100
12
11
12
13
14
×
×
×
×
×
SNR (dB)
Frame error probability
10
×
×
×
×
×
(b)
Figure 4.13 (a) Codes for 4PSK with rate 2 b/s/Hz that achieve diversity 4 with two receive
and two transmit antennas; (b) codes for 8PSK with rate 3 b/s/Hz that achieve
diversity 4 with two receive and two transmit antennas.
1 ≤i ≤3. At state (s1, s2, s3) upon input data i, the encoder outputs (i, s1, s2, s3) elements of the
4PSK constellation (see Figure 4.5) and moves to state (i, s1, s2). Given two code words c and e, the
associated paths in the trellis diverge at time t1 from a state and remerge in another state at a later
time t2 ≤l. It is easy to see that the t1th, (t1 + l)th, (t2 −1)th, and t2th columns of the matrix B(c, e)
are independent. Thus, the above design gives a 4-space–time code.

94
SPACE–TIME CODING
8 states
16 states
32 states
64 states
×
10 −2
10−1
10 0
Frame error probability
×
×
×
×
×
×
SNR (dB)
15
16
17
18
19
×
×
×
×
×
×
×
Figure 4.14 Codes for 8PSK with rate 3 b/s/Hz that achieve diversity 2 with one receive
and two transmit antennas.
02, 21, 02, 03, 04, 05, 06, 07
10, 11, 12, 13, 14, 15, 16, 17
20, 21, 22, 23, 24, 25, 26, 27
30, 31, 32, 33, 34, 35, 36, 37
40, 41, 42, 43, 44, 45, 46, 47
50, 21, 52, 53, 54, 55, 56, 57
60, 61, 62, 63, 64, 65, 66, 67
70, 71, 72, 73, 74, 75, 76, 77
02, 21, 02, 03, 04, 05, 06, 07
00, 01, 02, 03, 04, 05, 06, 07
Figure 4.15 Space–time realization of a delay diversity 8PSK code constructed from a
repetition code.
4.2.7
Delay diversity
The encoder block diagram of a delay diversity transmitter is given in Figure 4.18, with
c1
t = ˜c1
t−1
c2
t = ˜c2
t
(4.45)
where c1
t and c2
t are the symbols of the equivalent space–time code at time t and c1
t c2
t is the output of
the encoder at time t.

SPACE–TIME CODING
95
00,01,02,03,04,05,06,07,08,09,0 10,0 11,0 12,0 13,0 14,0 15
11 0,111,11 2,11 3,11 4,11 5,11 6,11 7,11 8,119,11 10,11 11,11 12,11 13,11 14,11 15
20,21,22,23,24,25,26,27,28,29,2 10,2 11,2 12,2 13,2 14,2 15
90,91,92,93,94,95,96,97,98,99,9 10,9 11,9 12,9 13,9 14,9 15
40,41,42,43,44,45,46,47,48,49,4 10,4 11,4 12,4 13,4 14,4 15
15 0,151,15 2,15 3,15 4,15 5,15 6,15 7,15 8,159,15 10,15 11,15 12,15 13,15 14,15 15
60,61,62,63,64,65,66,67,68,69,6 10,6 11,6 12,6 13,6 14,6 15
13 0,131,13 2,13 3,13 4,13 5,13 6,13 7,13 8,139,13 10,13 11,13 12,13 13,13 14,13 15
80,81,82,83,84,85,86,87,88,89,8 10,8 11,8 12,8 13,8 14,8 15
30,31,32,33,34,35,36,37,38,39,3 10,3 11,3 12,3 13,3 14,3 15
10 0,101,10
12
2,10 3,10 4,10 5,10 6,10 7,10 8,109,10 10,10 11,10 12,10 13,10 14,10 15
10,11,12,13,14,15,16,17,18,19,1 10,1 11,1 12,1 13,1 14,1 15
12 0,121,
2,12 3,12 4,12 5,12 6,12 7,12 8,129,12 10,12 11,12 12,12 13,12 14,12 15
70,71,72,73,74,75,76,77,78,79,7 10,7 11,7 12,7 13,7 14,7 15
14
141,14 2,14 3,14 4,14 5,14 6,14 7,14 8,149,14 10,14 11,14 12,14 13,14 14,14 15
50,51,52,53,54,55,56,57,58,59,5 10,5 11,5 12,5 13,5 14,5 15
1,
,
,
,0
1,
2,
,1
1,
3,
,
,
2
1,
,9
,
1,
,
,
,4
4
5
0,
15
5
15 12,15 13,15 14,15 15
60,61,62,63,
,
,
6
6 11,6 12,6 13,6 14,6 15
3,13 4,13 5,13 6,13 7,13 8,139,13 10,13 11,13 12,13 13,13 14,13 15
84,
9,8
5
,
,
,3
1,
3 13,3 1
6,
10
,10 13,
10,11,12,13,14,15,16,17,18,19,1 10,1 11,1 12,1 13,1 14,1 15
6,
,
,
7
1,
0,
2,14
9,
14
,51,
,
,
58 9,5 10,5 11,5 12,5 13,5 14,5 15
Figure 4.16 2-space–time 16 QAM code, 16 states, 4 b/s/Hz.
0
1
2         3
7
6
5
4
8
9
10
11
15
14
13
12
0
1
Figure 4.17 The 16 QAM constellation.
Channel
encoder
S/P
Pulse
shaper
Modulator
Antenna 2
Delay
i
Pulse
shaper
Modulator
Antenna 1
2
−
tc
1
1
−
−
tc
Delay
tc
1
1
−
−
tc
Figure 4.18 The block diagram of a delay diversity transmitter.

96
SPACE–TIME CODING
Next, we consider the block code [2]
C = {00, 15, 22, 37, 44, 51, 66, 73}
of length two deﬁned over the alphabet 8PSK instead of the repetition code. This block code is
the best in the sense of product distance [10] among all the codes of cardinality eight and of
length two deﬁned over the alphabet 8PSK. This means that the minimum of the product distance
|c1 −e1||c2 −e2| between pairs of distinct code words c = c1c2 ∈C and e = e1e2 ∈C is maximal
among all such codes. The delay diversity code constructed from this block code is identical to the
space–time code given by the trellis diagram of Figure 4.9. The minimum determinant of this delay
diversity code is thus 2.
The 16-state code for the 16 QAM constellation given in Figure 4.16, is obtained from the block
code
{0 0, 1 11, 2 2, 3 9, 4 4, 5 15, 6 6, 7 13, 8 8, 9 3, 10 10, 11 1, 12 12, 13 7, 14 14, 15 5}
using the same delay diversity construction. Again, this block code is optimal in the sense of product
distance.
The delay diversity code construction can also be generalized to systems having more than two
transmit antennas. For instance, the 4PSK 4-space–time code given before is a delay diversity code.
The corresponding block code is the repetition code. By applying the delay diversity construction to
the 4PSK block code
{0 0 0 0, 1 2 3 1, 2 1 2 3, 3 3 1 2}
one can obtain a more powerful 4PSK 4-space–time code having the same trellis complexity.
4.3
SPACE–TIME BLOCK CODES FROM ORTHOGONAL DESIGNS
ML decoding of a multidimensional trellis requires a large complexity. In this section we present a
special class of space–time codes for which maximum likelihood decoding is achieved in a simple
way through decoupling of the signals transmitted from different antennas rather than joint detection.
This uses the orthogonal structure of the space–time block code and gives a maximum likelihood
decoding algorithm which is based only on linear processing at the receiver. The presentation is based
on [5, 39–46].
Space–time block codes are designed to achieve the maximum diversity order for a given number
of transmit and receive antennas subject to the constraint of having a simple decoding algorithm.
Unfortunately, space–time block codes constructed in this way only exist for few sporadic values
of n.
4.3.1
The channel model and the diversity criterion
At time t the signal r j
t , received at antenna j, is given by Equation (4.21) which for √Es = 1 becomes:
r j
t =
n

i=1
αi, jci
t + η j
t
(4.46)
Assuming perfect channel state information is available, the receiver computes the decision metric
for l symbols and Expression (4.39) gives:
l
t=1
m

j=1
r j
t −
n

i=1
αi, jci
t

2
(4.47)

SPACE–TIME BLOCK CODES FROM ORTHOGONAL DESIGNS
97
In order to achieve the maximum diversity mn, the matrix A(c, e) = B(c, e)∗B(c, e) with
B(c, e) =


e1
1 −c1
1
e1
2 −c1
2
· · ·
· · ·
e1
l −c1
l
e2
1 −c2
1
e2
2 −c2
2
· · ·
· · ·
e2
l −c2
l
e3
1 −c3
1
e3
2 −c3
2
...
...
e3
l −c3
l
...
...
...
...
...
en
1 −cn
1
en
2 −cn
2
· · ·
· · ·
en
l −cn
l


(4.48)
has to be full rank for any pair of distinct code words c and e. If B(c, e) has minimum rank r over the
set of pairs of distinct code words, then a diversity of rm is achieved.
4.3.2
Real orthogonal designs
For n = 2, 4 or 8, mathematics literature offers orthogonal sets of signals deﬁned as:
O2(x1, x2) =
&
x1
x2
−x2
x1
'
(4.49)
The 4 × 4 design
O4(x1, x2, x3, x4) =


x1
x2
x3
x4
−x2
x1
−x4
x3
−x3
x4
x1
−x2
−x4
−x3
x2
x1


(4.50)
and 8 × 8 design
O8(x1, x2, . . . x8) =


x1
x2
x3
x4
x5
x6
x7
x8
−x2
x1
x4
−x3
x6
−x5
−x8
x7
−x3
−x4
x1
x2
x7
x8
−x5
−x6
−x4
x3
−x2
x1
x8
−x7
x6
−x5
−x5
−x6
−x7
−x8
x1
x2
x3
x4
−x6
x5
−x8
x7
−x2
x1
−x4
x3
−x7
x8
x5
−x6
−x3
x4
x1
−x2
−x8
−x7
x6
x5
−x4
−x3
x2
x1


(4.51)
4.3.3
Space–time encoder
At time slot 1, nb bits arrive at the encoder and select constellation signals s1, . . . , sn. Setting xi = si
for i = 1, 2, . . . , n, we arrive at a matrix C = O(s1, . . . , sn) with entries ±s1, ±s2, . . . , ±sn. At each
time slot t = 1, 2, . . . , n, the entries Cti, i = 1, 2, . . . , n are transmitted simultaneously from transmit
antennas 1, 2, . . . , n. The rate of transmission is b bits/s/Hz.
4.3.4
The diversity order
The rank criterion requires that the matrix O(˜s1, . . . , ˜sn) −O(s1, . . . , sn) be non-singular for
any two distinct code sequences (˜s1, . . . , ˜sn) ̸= (s1, . . . , sn). Clearly, O(˜s1 −s1, . . . , ˜sn −sn) =
O(˜s1, . . . , ˜sn) −O(s1, . . . , sn) where O(˜s1 −s1, . . . , ˜sn −sn) is the matrix constructed from O by
replacing xi with ˜si −si for all i = 1, 2, . . . , n. The determinant of the orthogonal matrix O is easily
seen to be:
det(OOT)1/2 =
(
i
x2
i
)n/2
(4.52)

98
SPACE–TIME CODING
where OT is the transpose of O. Hence:
det[O(˜s1 −s1, . . . , ˜sn −sn)] =
(
i
|˜si −si|2
)n/2
(4.53)
which is non-zero. It follows that O(˜s1, . . . , ˜sn) −O(s1, . . . , sn) is non-singular and the maximum
diversity order nm is achieved.
4.3.5
The decoding algorithm
Rows of O are all permutations of the ﬁrst row of O with possibly different signs. Let e1, . . . , en
denote the permutations corresponding to these rows and let δk(i) denote the sign of xi in the kth
row of O. Then ek(p) = q means that x p is up to a sign change the (k, q)th element of O. Since the
columns of O are pairwise-orthogonal, it turns out that minimizing the metric of Expression (4.47)
amounts to minimizing:
n

i=1
Si
(4.54)
where
Si =





n

t=1
m

j=1
r j
t α∗
et (i), jδt(i)

−si

2
+

−1 +

k,l
|αk,t|2

|si|2


(4.55)
The value of Si only depends on the code symbol si, the received symbols {r j
t }, the path coefﬁcients
{αi, j}, and the structure of the orthogonal design O. It follows that minimizing the sum given in
Expression (4.54) amounts to minimizing Equation (4.55) for all 1 ≤i ≤n. Thus, the maximum
likelihood detection rule is to form the decision variables:
Ri =
n

t=1
m

j=1
r j
t α∗
et (i), jδt(i)
(4.56)
for all i = 1, 2, . . ., n and decide in favor of si among all the constellation symbols s if:
si = arg min
s∈A |Ri −s|2 +

−1 +

k,l
|αk,t|2

|si|2
(4.57)
This is a very simple decoding strategy that provides diversity.
4.3.6
Linear processing orthogonal designs
The above properties are preserved even if we allow linear processing at the transmitter. Therefore,
we relax the deﬁnition of orthogonal designs to allow linear processing at the transmitter. Signals
transmitted from different antennas will now be linear combinations of constellation symbols.
A linear processing orthogonal design in variables x1, x2, . . . , xn is an n × n matrix E such that:
r the entries of E are real linear combinations of variables x1, x2, . . . , xn;
r ETE = D, where D is a diagonal matrix with (i, i)th diagonal element of the form (li
1x2
1 + li
2x2
2 +
· · ·li
nx2
n), with the coefﬁcients (li
1,li
2, . . . ,li
n) strictly positive numbers.
It is easy to show that transmission using a linear processing orthogonal design provides full
diversity and a simpliﬁed decoding algorithm as above.

SPACE–TIME BLOCK CODES FROM ORTHOGONAL DESIGNS
99
4.3.7
Generalized real orthogonal designs
Since the simple maximum likelihood decoding algorithm described above is achieved because of
orthogonality of columns of the design matrix, we may generalize the deﬁnition of linear processing
orthogonal designs. This creates new and simple transmission schemes for any number of transmit
antennas.
A generalized orthogonal design G of size n is a p × n matrix with entries 0, ±x1, ±x2, . . . , ±xk,
such that GTG = D where D is a diagonal matrix with diagonal Dii, i = 1, 2, . . . , n of the form
(li
1x2
1 + li
2x2
2 + · · ·li
nx2
n) and coefﬁcients (li
1,li
2, . . . ,li
n) strictly positive numbers. The rate of G is
R = k/p.
A full-rate generalized orthogonal design has entries of the form ±x1, ±x2, . . . , ±x p.
The generalized orthogonal signal sets are:
G3 =


x1
x2
x3
−x2
x1
−x4
−x3
x4
x1
−x4
−x3
x2


(4.58)
G5 =


x1
x2
x3
x4
x5
−x2
x1
x4
−x3
x6
−x3
−x4
x1
x2
x7
−x4
x3
−x2
x1
x8
−x5
−x6
−x7
−x8
x1
−x6
x5
−x8
x7
−x2
−x7
x8
x5
−x6
−x3
−x8
−x7
x6
x5
−x4


(4.59)
G6 =


x1
x2
x3
x4
x5
x6
−x2
x1
x4
−x3
x6
−x5
−x3
−x4
x1
x2
x7
x8
−x4
x3
−x2
x1
x8
−x7
−x5
−x6
−x7
−x8
x1
x2
−x6
x5
−x8
x7
−x2
x1
−x7
x8
x5
−x6
−x3
x4
−x8
−x7
x6
x5
−x4
−x3


(4.60)
G7 =


x1
x2
x3
x4
x5
x6
x7
−x2
x1
x4
−x3
x6
−x5
−x8
−x3
−x4
x1
x2
x7
x8
−x5
−x4
x3
−x2
x1
x8
−x7
x6
−x5
−x6
−x7
−x8
x1
x2
x3
−x6
x5
−x8
x7
−x2
x1
−x4
−x7
x8
x5
−x6
−x3
x4
x1
−x8
−x7
x6
x5
−x4
−x3
x2


(4.61)
4.3.8
Encoding
At time slot 1, kb bits arrive at the encoder and select constellation symbols s1, s2, . . . , sn. The
encoder populates the matrix by setting xi = si and at time t = 1, 2, . . . , p the signals Gt1, . . . , Gtn
are transmitted simultaneously from antennas 1, 2, . . . , n. Thus, kb bits are sent during each p
transmissions. It can be proved, as in Equation (4.53), that the diversity order is nm. It should be
mentioned that the rate of a generalized orthogonal design is different from the throughput of the
associated code. To motivate the deﬁnition of the rate, we note that the theory of space–time coding
proves that for a diversity order of nm, it is possible to transmit b bits per time slot and this is the best
possible. Therefore, the rate R of this coding scheme is deﬁned to be kb/pb which is equal to k/p.

100
SPACE–TIME CODING
4.3.9
The Alamouti scheme
The space–time block code, already used in Section 4.1 was proposed by Alamouti [1]. The code
uses the complex orthogonal signal set:
&
x1
x2
−x∗
2
x∗
1
'
(4.62)
Suppose that there are 2b signals in the constellation. At the ﬁrst time slot, 2b bits arrive at the
encoder and select two complex symbols s1 and s2. These symbols are transmitted simultaneously
from antennas one and two, respectively. At the second time slot, signals −s∗
2 and s∗
1 are transmitted
simultaneously from antennas one and two, respectively.
The ML detector will minimize the decision statistic:
m

j=1
r j
1 −α1, js1 −α2, js2

2
+
r j
2 −α1, js∗
1 −α2, js∗
2

2
(4.63)
over all possible values of s1 and s2. The minimizing values are the receiver estimates of s1 and s2,
respectively. This is equivalent to minimizing the decision statistics:





m

j=1

r j
1 α∗
1, j +

r j
2
∗
α2, j

−s1

2
+

−1 +
m

j=1
2

i=1
|αi, j|2

|s1|2


(4.64)
for detecting s1 and the decision statistics:





m

j=1

r j
1 α∗
2, j +

r j
2
∗
α1, j

−s2

2
+

−1 +
m

j=1
2

i=1
|αi, j|2

|s2|2


(4.65)
for decoding s2. The scheme provides full diversity of 2m using m receive antennas.
4.3.10
Complex orthogonal designs
Given a complex orthogonal signal set Oc of size n, we replace each complex variable xi = x1
i +
x2
i i, 1 ≤i ≤n by the 2 × 2 real matrix:
(
x1
i
x2
i
−x2
i
x1
i
)
(4.66)
In this way, x∗
i is represented by:
(
x1
i
−x2
i
x2
i
x1
i
)
(4.67)
ixi is represented by:
(
−x2
i
x1
i
−x1
i
−x2
i
)
(4.68)
and so forth. It is easy to see that the 2n × 2n matrix formed in this way is a real orthogonal design
of size 2n.
A complex orthogonal signal set of size n exists if and only if n = 2.
4.3.11
Generalized complex orthogonal designs
Let Gc be a p × n matrix whose entries are 0, ±x1, ±x∗
1, ±x2, ±x∗
2, . . . , ±xk, ±x∗
k or their prod-
uct with i. If G∗
cGc = Dc where Dc is a diagonal matrix with (i, i)th diagonal element of the

SPACE–TIME BLOCK CODES FROM ORTHOGONAL DESIGNS
101
form:

li
1|x1|2 + li
2|x2|2 + · · ·li
k|xk|2
and the coefﬁcients (li
1,li
2, . . . ,li
n) all strictly positive numbers, then Gc is referred to as a generalized
orthogonal design of size n and rate R = k/p. For instance, rate 1/2 codes for transmission using
three and four transmit antennas are given by:
G3
c =


x1
x2
x3
−x2
x1
−x4
−x3
x4
x1
−x4
−x3
x2
x∗
1
x∗
2
x∗
3
−x∗
2
x∗
1
−x∗
4
−x∗
3
x∗
4
x∗
1
−x∗
4
−x∗
3
x∗
2


(4.69)
and
G4
c =


x1
x2
x3
x4
−x2
x1
−x4
x3
−x3
x4
x1
−x2
−x4
−x3
x2
x1
x∗
1
x∗
2
x∗
3
x∗
4
−x∗
2
x∗
1
−x∗
4
x∗
3
−x∗
3
x∗
4
x∗
1
−x∗
2
−x∗
4
−x∗
3
x∗
2
x∗
1


(4.70)
These transmission schemes and their analogs for higher n give full diversity but lose half of the
theoretical bandwidth efﬁciency.
4.3.12
Special codes
It is natural to ask for higher rates than 1/2 when designing generalized complex linear processing
orthogonal designs for transmission with n multiple antennas. For n = 2, Alamouti’s scheme gives a
rate one design. For n = 3 and 4, rate 3/4 generalized complex linear processing orthogonal designs
are given by:
H3 =


x1
x2
x3
√
2
−x∗
2
x∗
1
x3
√
2
x∗
3
√
2
x∗
3
√
2
(−x1−x∗
1 +x2−x∗
2 )
2
x∗
3
√
2
−
x∗
3
√
2
(x1−x∗
1 +x2+x∗
2 )
2


H4 =


x1
x2
x3
√
2
x3
√
2
−x∗
2
x∗
1
x3
√
2
−x3
√
2
x∗
3
√
2
x∗
3
√
2
(−x1−x∗
1 +x2−x∗
2 )
2
(x1−x∗
1 −x2−x∗
2 )
2
x∗
3
√
2
−
x∗
3
√
2
(x1−x∗
1 +x2+x∗
2 )
2
−
(x1+x∗
1 +x2−x∗
2 )
2


(4.71)

102
SPACE–TIME CODING
+ + + + + + +
+
+
+
+
+
+
+
+
+
uncoded
2 antennas
3 antennas
4 antennas
10−1
SNR (dB)
15
20
25
30
35
10−6
10−5
10−4
10−3
10−2
+ + + + + + +
+
+
+
+
+
+
+
+
++
Symbol error probability
Figure 4.19 Symbol error probability versus SNR for space–time block codes at 3 bits/s/Hz;
one receive antenna.
4.3.13
Performance results
A collection of results is shown in Figures 4.19–4.26. The transmission using two transmit antennas
employs the 8PSK constellation and the code G2. For three and four transmit antennas, the 16 QAM
constellation and the codes H3 and H4, respectively, are used. Since H3 and H4 are rate 3/4 codes,
the total transmission rate in each case is 3 bits/s/Hz. It is seen that at the bit error rate of 10−5 the
rate 3/4 16 QAM code H4 gives about 7 dB gain over the use of an 8PSK G2 code.
Transmission using two transmit antennas employs the 4PSK constellation and the code G2. For
three and four transmit antennas, the 16-QAM constellation and the codes G3 and G4, respectively,
are used. Since G3 and G4 are rate 1/2 codes, the total transmission rate in each case is 2 bits/s/Hz.
It is seen that at the bit error rate of 10−5 the rate 1/2 16-QAM code G4 gives about 5 dB gain over
the use of a 4PSK G2 code.
The transmission using two transmit antennas employs the binary PSK (BPSK) constellation and
the code G2. For three and four transmit antennas, the 4PSK constellation and the codes G3 and G4,
respectively, are used. Since G3 and G4 are rate 1/2 codes, the total transmission rate in each case is
1 bit/s/Hz. It is seen that at the bit error rate of 10−5 the rate 1/2 4PSK code G4 gives about 7.5 dB
gain over the use of a BPSK G2 code.
If number of receive antennas is increased, this gain reduces to 3.5 dB. The reason is that much
of the diversity gain is already achieved using two transmit and two receive antennas.
4.4
CHANNEL ESTIMATION IMPERFECTIONS
So far we have been assuming that a perfect channel estimation is available for the operation of the
ML decoder collecting statistics deﬁned by Expression (4.39) or Expression (4.47). Let us look at
this assumption more carefully. First of all, the errors in the channel estimation will depend on the
estimator structure.

CHANNEL ESTIMATION IMPERFECTIONS
103
15
20
25
30
+ + +
+
+
+
+
+
+
uncoded
2 antennas
3 antennas
4 antennas
10-6
10-5
10-4
10-3
10-2
10-1
SNR(dB)
+
+
+
+
+
+
+
3 bits/s/Hz
15
20
25
30
35
+ + +
+
+
+
+
+
++
+
+
+
+
+
+
+
Bit error probability
Figure 4.20 Bit error probability versus SNR for space–time block codes at 3 bits/s/Hz;
one receive antenna.
10
15
20
25
30
35
+
uncoded
2 antennas
3 antennas
4 antennas
SNR (dB)
10−6
10−5
10−4
10−3
10−2
10−1
Bit error probability
2 bits/s/Hz
+ + + + + + + + + + + +
+
+
+
+
+
+
+
2 a
+
+ + + + + + + + + + + +
+
+
+
+
+
+
Figure 4.21 Bit error probability versus SNR for space–time block codes at 2 bits/s/Hz;
one receive antenna.

104
SPACE–TIME CODING
15
20
25
30
35
+
uncoded
2 antennas
3 antennas
4 antennas
SNR (dB)
Bit error probability
2 bits/sec/Hz
+
10−6
10−5
10−4
10−3
10−2
10−1
100
+ + + + + + +
+
+
+
+
+
+
15
20
25
30
35
+
d
2 a
s
+
s
SNR (dB)
s/
+ + + + + + + +
+
+
+
+
+
+
Figure 4.22 Symbol error probability versus SNR for space–time block codes at 2 bits/s/Hz;
one receive antenna.
5
10
15
20
25                         30
+
uncoded
2 antennas
3 antennas
4 antennas
SNR (dB)
Bit error probability
1 bits/s/Hz
10−6
10−5
10−4
10−3
10−2
10−1
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
0
1
0
+
e
e
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
Figure 4.23 Bit error probability versus SNR for space–time block codes at 1 bit/s/Hz; one
receive antenna.

CHANNEL ESTIMATION IMPERFECTIONS
105
10
15
20
25
30
+
uncoded
2 antennas
3 antennas
4 antennas
SNR (dB)
1 bits/s/Hz
Bit error probability
10−6
10−5
10−4
10−3
10−2
10−1
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
Figure 4.24 Symbol error probability versus SNR for space–time block codes at 1 bit/s/Hz;
one receive antenna.
4
6
8
10
12
14               16
Bit error probability
10−5
10−4
10−3
10−2
10−1
+
uncoded
2 antennas
3 antennas
4 antennas
+
+
+
+
+
+
+
+
+
+
+
+
SNR (dB)
1 bits/s/Hz, two receive antennas
+
nt
+
+
+
+
+
+
+
+
+
+
+
+
+
Figure 4.25 BER versus SNR for space–time block codes at. 1 bit/s/Hz; two receive
antennas.

106
SPACE–TIME CODING
SNR (dB)
1bits/s/Hz, two receive antennas
Symbol error probability
10−5
10−4
10−3
10−2
10−1
4
6
8
10
12
14               16
+
uncoded
2 antennas
3 antennas
4 antennas
+
+
+
+
+
+
+
+
+
+
+
+
10 −6
6
+
+
+
+
+
+
+
+
+
+
+
+
+
Figure 4.26 Symbol error probability versus SNR for space–time block codes at 1 bit/s/Hz;
two receive antennas.
4.4.1
Channel estimator
At the beginning of each frame of symbols to be transmitted from transmit antenna i, a sequence Wi
of length k pilot symbols:
Wi = (Wi,1, Wi,2, . . . , Wi,k)
is appended. The sequences W1, W2, . . . , Wn are designed to be orthogonal to each other:
Wp ¯Wq =
k

j=1
Wp, j ¯Wq, j = 0
whenever p ̸= q. In the previous expression ¯W stands for the conjugate of W and ¯W is the conjugate
transpose of W. Let r j = (r j
1 ,r j
2 , . . . ,r j
k ) be the observed sequence of received signals at antenna j
during the training period. Then:
r j
t =
n

i=1
αi, jWi,t + ηt, j,
1 ≤j ≤m,
1 ≤t ≤k
where the channel coefﬁcients αi, j are independent samples of a complex Gaussian random variable
with mean zero and variance 0.5 per dimension, and ηt, j are independent samples of a zero mean
complex Gaussian random variable with variance N0/2 per dimension. Let η j = (η1, j, η2, j, . . . , ηk, j).
Our goal is to estimate αi, j, i = 1, 2, . . . , n, j = 1, 2, . . . , m using the statistic r j.
The unbiased estimator βi, j having the least variance is given by the ratio of inner products
(r j· ¯Wi)/(Wi· ¯Wi). Indeed, since Wp ¯Wq = 0 it is easy to see that:
r j · ¯Wi = αi, j(Wi · ¯Wi) + η j · ¯Wi
thus
αi, j = r j · ¯Wi
Wi · ¯Wi −ηj · ¯Wi
Wi · ¯Wi

QUASI-ORTHOGONAL SPACE–TIME BLOCK CODES
107
4  states
4  states Mismatch
16 states
16 states Mismatch
Frame error probability
100
10−1
10−2
4PSK, 2 bits/s/Hz, 2 Recv., 2 Trans. Antennas
7
7.5
8
8.5
9
9.5
10
.5
.5
.5
Figure 4.27 Performance of four and 16 state 4PSK codes in the presence of channel
estimation error, 2 bits/s/Hz, two receive and two transmit antennas.
In other words,
βi, j = αi, j + ηj · ¯Wi
Wi · ¯Wi
The random variable βi, j has zero mean. The variance of the estimation error is N0/2kEs per
dimension which is the minimum given by the Cramer–Rao bound. Simulation results for imperfect
channel estimation (mismatch) with n = 2, k = 8, and the frame length 130 symbols are shown in
Figure 4.27.
More details on system imperfections can be found in [7, 47, 48].
4.5
QUASI-ORTHOGONAL SPACE–TIME BLOCK CODES
It was shown in Section 4.3 that a complex orthogonal design that provides full diversity and full
transmission rate for a space–time block code is not possible for more than two antennas. Previous
attempts have been concentrated in generalizing orthogonal designs which provide space–time block
codes with full diversity and a high transmission rate. In this section we discuss rate one codes which
are quasi-orthogonal and provide partial diversity. The decoder for these codes works with pairs of
transmitted symbols instead of single symbols.
An example of a full rate full diversity complex space–time block code is the Alamouti scheme
already discussed in Section 4.3. In this section we will use the notation:
A12 =
& x1
x2
−x∗
2
x∗
1
'
(4.72)
Here we use the subscript 12 to represent the indeterminates x1 and x2 in the transmission matrix. Now,
let us consider the following space–time block code with block length T symbol intervals where K bits
are transmitted over N transmit antennas and received with M receive antennas, for N = T = K = 4:
A =
(
A12
A34
−A∗
34
A∗
12
)
=


x1
x2
−x∗
2
x∗
1
−x∗
3
−x∗
4
x4
−x3
x3
x4
−x∗
4
x∗
3
x∗
1
x∗
2
−x2
x1


(4.73)

108
SPACE–TIME CODING
It is easy to see that the minimum rank of matrix A(s1 −s1, s2 −s2, s3 −s3, s4 −s4), the matrix
constructed from A by replacing xi with si −si , is 2. Therefore, a diversity of 2M is achieved while
the rate of the code is one. Note that the maximum diversity of 4M for a rate one code is impossible
in this case.
4.5.1
Decoding
Assuming perfect channel state information is available, the ML receiver computes the decision
metric:
M

m=1
T

t=1
rt,m −
N

n=1
αn,mAtn

2
(4.74)
over all possible xk = sk ∈A and decides in favor of the constellation symbols s1, . . . , sK that
minimize this sum.
4.5.2
Decision metric
Now, if we deﬁne Vi, i = 1, 2, 3, 4, as the ith column of A, it is easy to see that
⟨V1, V2⟩= ⟨V1, V3⟩= ⟨V2, V4⟩= ⟨V3, V4⟩= 0
(4.75)
where ⟨Vi, V j⟩= 	4
l=1 (Vi)l(V j)∗
l is the inner product of vectors Vi and V j. Therefore, the subspace
created by V1 and V4 is orthogonal to the subspace created by V2 and V3. Using this orthogonality,
the maximum likelihood decision metric, Expression (4.74), can be calculated as the sum of two
terms f14(x1, x4) + f23(x2, x3), where f14 is independent of x2 and x3 and f23 is independent of
x1 and x4. Thus, the minimization of Expression (4.74) is equivalent to minimizing these two terms
independently. In other words, ﬁrst the decoder ﬁnds the pair (s1, s4) that minimizes f14(x1, x4) among
all possible (x1, x4) pairs. Then, or in parallel, the decoder selects the pair (s2, s3) which minimizes
f23(x2, x3). This reduces the complexity of decoding without sacriﬁcing the performance.
Simple manipulation of Expression (4.74) provides the following formulas for f14(.) and f23(.):
f14(x1, x4) =
M

m=1



4

n=1
|αn,m|2

(|x1|2 + |x4|2)
+ 2Re{(−α1,mr ∗
1,m −α∗
2,mr2,m −α∗
3,mr3,m −α4,mr ∗
4,m)x1
+ (−α4,mr ∗
1,m + α∗
3,mr2,m + α∗
2,mr3,m −α1,mr ∗
4,m)x4
(4.76)
+ (α1,mα∗
4,m −α∗
2,mα3,m −α2,mα∗
3,m + α∗
1,mα4,m)x1x∗
4}


f23(x2, x3) =
M

m=1



4

n=1
|αn,m|2

(|x2|2 + |x3|2)
+ 2Re{(−α2,mr ∗
1,m −α∗
1,mr2,m −α∗
4,mr3,m −α3,mr ∗
4,m)x2
+ (−α3,mr ∗
1,m + α∗
4,mr2,m + α∗
1,mr3,m −α2,mr ∗
4,m)x3 + (α2,mα∗
3,m
(4.77)
−α∗
1,mα4,m −α1,mα∗
4,m + α∗
2,mα3,m)x2x∗
3}



SPACE–TIME CONVOLUTIONAL CODES
109
There are other structures which provide behaviors similar to those of Equation (4.73). A few
examples are given below:
(
A12
A34
−A34
A12
)
(
A12
A34
A34
−A12
)
(
A12
A34
A∗
34
−A∗
12
)
(4.78)
A similar idea can be used to combine two rate 3/4 transmission matrices (4 × 4) to build a rate
3/4 transmission matrix (8 × 8) and so on. An example of an 8 × 8 matrix which provides a rate 3/4
code is given below:


x1
x2
x3
0
x4
x5
x6
0
−x∗
2
x∗
1
0
−x3
x∗
5
−x∗
4
0
x6
x∗
3
0
−x∗
1
−x2
−x∗
6
0
x∗
4
x5
0
−x∗
3
x∗
2
−x1
0
x∗
6
−x∗
5
x4
−x4
−x5
−x6
0
x1
x2
x3
0
−x∗
5
x∗
4
0
x6
−x∗
2
x∗
1
0
x3
x∗
6
0
−x∗
4
x5
x∗
3
0
−x∗
1
x2
0
x∗
6
−x∗
5
−x4
0
x∗
3
−x∗
2
−x1


(4.79)
Here, n = 8 antennas, k = 6 symbols, p = 8 transmissions. In this code, if we deﬁne Vi, i =
1, 2, . . . , 8, as the ith column, we have:
⟨V1, Vi⟩= 0, i ̸= 5
⟨V2, Vi⟩= 0, i ̸= 6
⟨V3, Vi⟩= 0, i ̸= 7
⟨V4, Vi⟩= 0, i ̸= 8
⟨V5, Vi⟩= 0, i ̸= 1
⟨V6, Vi⟩= 0, i ̸= 2
⟨V7, Vi⟩= 0, i ̸= 3
⟨V8, Vi⟩= 0, i ̸= 4
(4.80)
The maximum likelihood decision metric, Expression (4.74), can be calculated as the sum of three
terms f14(x1, x4) + f25(x2, x5) + f36(x3, x6) and similarly the decoding can be done using pairs of
constellation symbols.
Figure 4.28 illustrates the performance of transmission of 2 bits/s/Hz using four transmit antennas
and the rate one quasi-orthogonal code, the rate 1/2 full diversity orthogonal code and the uncoded
4PSK. The appropriate modulation schemes to provide the desired transmission rate for the space–
time block codes, are 4PSK for the rate one code and 16 QAM for the rate 1/2 code.
Figure 4.29 presents the performance for four transmit antennas for space–time block codes at 3
bits/s/Hz. The rate one code and the uncoded system use 8PSK and the rate 3/4 code uses 16 QAM.
More details on the topic can be found in [42].
4.6
SPACE–TIME CONVOLUTIONAL CODES
In Section 4.2 the coding gain was deﬁned as:
η = min
c,e
r
i=1 λi
1/r

110
SPACE–TIME CODING
Frame error probability
10 −1
SNR (dB)
+
+
+
+
+
+
+
+
+
+
+ +
+ +
15
20
25
30
35
10 −2
10 −3
10 −4
10 −5
10 −6
uncoded
orthogonal
quasi-orthogonal
+
+
+
+
+
+
+
+
+
+
+
+ +
+ +
+
Figure 4.28 Bit error probability versus SNR for space–time block codes at 2 bits/s/Hz; 1
receive antenna.
Frame error probability
10 −1
SNR (dB)
+
+
+
+
+
+
+
+
+
+
+ + +
+
15
20
25
30
35
10 −2
10 −3
10 −4
10 −5
10 −6
uncoded
orthogonal
quasi-orthogonal
+
+ +
+
+
+
+
+
+
+
+
+
+
+ + +
+
+
+ +
Figure 4.29 Bit error probability versus SNR for space–time block codes at 3 bits/s/Hz;
1 receive antenna.

ALGEBRAIC SPACE–TIME CODES
111
over all code word pairs. Due to the similarity of Inequality (4.33) to an error bound for trellis coded
modulation, rm is called the diversity gain (the slope of the pairwise error probability on a log–log
plot) and η is called the coding gain (η−rm is an offset on a log–log plot).
Consider only codes that achieve maximum diversity gain. Of these, we search for codes that give
the largest possible coding gain.
Similarly to Equations (2.8)–(2.13) in Chapter 2, consider a set of convolutional codes whose
output at time k is:
[x1(k), x2(k), . . . , xn(k)] = br(kR)G
= br(kR)[G1G2 · · · Gn]
(4.81)
where Gi, i = 1, . . . , n is the ith column of the matrix G which is given by:
G =


g11
g12
· · ·
g1n
g21
g22
· · ·
g2n
g31
g32
· · ·
g3n
g41
g42
· · ·
g4n
· · ·
· · ·
· · ·
· · ·
gQR,1
gQR,2
· · ·
gQR,n


(4.82)
and br(kR) = [b1, . . . , bQR] is a length QR binary row vector, b j ∈{0, 1} for i = 1, . . . , n are
taken to be in an alphabet of size s so that gi j ∈{0, 1, . . . s −1}. The arithmetic in Equation
(4.81) is mod-s so xi( j) ∈{0, 1, . . . s −1} also. Thus, the output code word is (c1(k), . . . , cn(k)) =
(z[x1(k))], . . . , z[xn(k))]) where z[x] = exp( j(2πx/s + φ)) and 0 ≤φ ≤2π allows arbitrary rota-
tion.
At each time slot, R bits are input into the convolutional encoder and the state is determined by (Q −
1)R bits. For space–time convolutional coding using Equation (4.81), the outputs x1(k), . . . , xn(k) are
each mapped into a constellation of size s and transmitted simultaneously from n antennas. The input
to the encoder at time slot k is b1, . . . , bR. The state is given by bR+1, . . . , bQR. For the next time slot,
new input bits are received and the old input bits are shifted to the right into the state which explains
the subscript on br(kR).
The results of the search for the good codes are presented in Tables 4.4–4.9 with the following
notation:
ηt (4.2)
– coding gain for the trellis space–time codes deﬁned in Section 4.2.
ηc (4.6)
– coding gain for the convolutional space–time codes deﬁned in Section 4.6.
ep min
– minimum effective product distance.
L
– total number of time slots considered in the bound calculation.
ηAP(L)
– considers all trellis paths describing error events of length L or longer.
ηCP(L)
– considers sets of code word pairs (continuous error paths) and searches for smallest
upper bound.
˜Q
– the minimum length error event of ˜Q slots.
Performance results are shown in Figures 4.30–4.34.
More details on the topic can be found in [35, 49–55].
4.7
ALGEBRAIC SPACE–TIME CODES
Let C be a binary convolutional code of rate 1/Lt with the transfer function encoder Y(D) =
X(D)G(D), where G(D) = [G1(D)G2(D) . . . G Lt(D)]. In the natural space–time formatting of C
for BPSK transmission, the output sequence corresponding to Yi(D) = X(D)Gi(D) is assigned to
the ith transmit antenna. The number of transmit antennas is Lt. The resulting space–time code C
satisﬁes the binary rank criterion under relatively mild conditions on the connection polynomials
Gi(D).

112
SPACE–TIME CODING
Table 4.4
Optimum q-state 2 b/s/Hz 4PSK space–time codes [35] c⃝2002, IEEE
q
ηt(4.2)
ηc(4.6)
ηAP( ˜Q)
ηCP( ˜Q)
GT
4
2
√
8
3.54
3.80
& 2
0
1
2
2
2
2
1
'
8
√
12
4
3.42
4.00
&0
2
1
0
2
2
1
0
2
2
'
16
√
12
√
32
5.76
6.24
&0
2
1
1
2
0
2
2
1
2
0
2
'
32
√
12
6
5.63
6.33
&2
0
1
2
1
2
2
2
2
0
1
2
0
2
'
Table 4.5
Optimum q-state 2 b/s/Hz 4PSK space–time codes [35] c⃝2002, IEEE
q
ηt
ηc
ep min
ηAP(L)
ηCP(L)
GT
4
2
√
8
8
3.54
3.80
&2
0
1
2
2
2
2
1
'
8
√
12
4
16
3.42
4.00
&0
2
1
0
2
2
1
0
2
2
'
16
√
12
√
32
32
5.76
6.24
&0
2
1
1
2
0
2
2
1
2
0
2
'
32
√
12
6
36
5.63
6.33
&2
0
1
2
1
2
2
2
2
0
1
2
0
2
'
Table 4.6
Optimum q-state 1 b/s/Hz BSK space–time codes [35] c⃝2002, IEEE
q
ηc
ep min
ηAP(L)
ηCP(L)
GT
2
4
4
4.00
4.00
& 0
1
1
1
'
4
√
48
12
7.33
6.93
&0
1
1
1
0
1
'†
4
√
32
8
7.33
7.73
& 0
1
1
1
1
1
'
8
√
80
20
10.06
10.47
&1
0
1
1
1
1
0
1
'
16
√
112
28
11.38
14.27
&1
1
0
1
1
0
1
1
1
1
'
† denotes that the code is catastrophic

ALGEBRAIC SPACE–TIME CODES
113
Table 4.7
Optimum q-state 1 b/s/Hz BSK 3-space–time codes [35] c⃝2002, IEEE
q
ηc
ep min
ηAP(L)
ηCP(L)
GT
4
4
64
27
5.08
5.08


0
1
1
1
0
1
1
1
1


8
2561/3
256
27
7.65
7.05


1
0
0
1
1
0
1
0
1
1
1
1


†
8
1921/3
64
9
7.65
8.32


1
0
1
1
1
1
0
1
1
0
1
1


16
8
512
27
10.00
10.18


1
0
0
1
1
1
1
0
1
0
1
1
1
0
1


† denotes that the code is catastrophic
Table 4.8
Optimum q-state 1b/s/Hz BSK 4-space–time codes [35] c⃝2002, IEEE
q
ηc
ep min
ηAP(L)
ηCP(L)
GT
8
4
1
5.97
5.97


0
1
0
1
0
1
1
1
1
0
1
0
1
1
1
0


16
12801/4
5
8.11
8.37


1
0
0
0
1
1
0
1
1
1
1
1
0
1
1
1
1
1
1
0


†
16
10241/4
4
7.99
9.32


0
1
1
0
1
1
1
0
0
1
1
1
1
1
0
1
1
1
1
1


32
43521/4
17
9.80
10.38


1
0
0
0
0
1
1
0
1
1
1
1
1
1
1
0
1
0
1
1
1
1
0
0


† denotes that the code is catastrophic

114
SPACE–TIME CODING
Table 4.9
Optimum q-state 2 b/s/Hz 4 PSK space–time code using
three transmit antennas [35] c⃝2002, IEEE
q
ηc
ep min
ηAP(L)
ηCP(L)
GT
16
321/3
256
27
3.90
4.72


0
2
1
2
2
0
1
2
2
0
0
2
2
2
0
2
1
2


100
10−1
10−2
6
6.5
7
7.5
8
8.5
9
9.5
10
+
+
+
+
*
*
*
*
SNR per receive antenna (dB)
Frame error probability
*
+ q = 4, opt
q = 8, opt
q = 16, opt
q = 32, opt
Figure 4.30 Performance comparison of some best 2 b/s/Hz, QPSK, q-state STCs with two
transmit and two receive antennas (SNR per receive antenna = nEs/N0).
100
10−1
6.5
7
7.5
8
8.5
9
9.5
10
SNR per receive antenna (dB), q = 4
*
+
q = 4 [2]
q = 4 [31]
q = 4 [34]
q = 4 [35]
q = 4 opt
+
+
+
+
*
*
*
*
from [34]
from [31]
Frame error probability
Figure 4.31 Performance comparisons of some 2 b/s/Hz, QPSK, four-state STCs with two
transmit and two receive antennas.

ALGEBRAIC SPACE–TIME CODES
115
100
10−2
SNR per receive antenna (dB)
Frame error probability
10−1
*
q = 16 [2]
q = 16 [31]
q = 16 opt
q = 32 [2]
q = 32, opt
*
*
*
*
7
8
9
10
Figure 4.32 Performance comparisons of some 2 b/s/Hz, QPSK, 16- and 32-state STCs
with two transmit and two receive antennas.
7
7.5
8
8.5
9
9.5
10
SNR per receive antenna (dB), q = 8
100
10−2
10−1
*
[34], ZS
[2]
[31]
[34], non-ZS
optimum
+
+*
+
+
+
*
*
from [31]
from [2]
Frame error probability
Figure 4.33 Performance comparisons of some 2 b/s/Hz, QPSK, eight-state STCs with two
transmit and two receive antennas.

116
SPACE–TIME CODING
0
1
2
3
4
5
100
10−2
10 −1
10−3
Frame error probability
Frame error probability
5
6
7
8
9
10
100
10−2
10−1
10−3
SNR per receive antenna (dB),Tx=2, Rx=2
+
+
+
+
+
+
+
+
+
+
q = 8 opt η
q = 8 in [32]
q = 16 opt η
q = 16 in [32]
+
+
+
+
+
+
+
+
+
+
+
+
+
q = 4 opt η
q = 4 in [32]
q = 8 opt η
q = 8 in [32]
q = 16 opt η
q = 16 in [32]
+
+
q = 16 in [32]
q = 16 opt η
+
SNR per receive antenna (dB),Tx=3, Rx=3
Figure 4.34 Performance of some 1 b/s/Hz, BPSK, q-state STCs with two transmit and
two receive or three transmit and three receive antennas (performance of the
best noncatastrophic codes similar).
4.7.1
Full spatial diversity
Code C , associated with the 1/Lt convolutional code C, satisﬁes the binary rank criterion, and thus
achieves full spatial diversity for BPSK transmission if and only if the transfer function matrix G(D)
of C has full rank Lt as a matrix of coefﬁcients over the binary ﬁeld F. This result follows directly
from the stacking construction and can be easily generalized to recursive convolutional codes.
It is straightforward to see that the zeros symmetry codes satisfy the stacking construction con-
ditions. However, the set of binary rate 1/Lt convolutional codes with the optimal free distance dfree
offers a richer class of space–time codes as their associated natural space–time codes usually achieve
full spatial diversity. Furthermore, these codes outperform the zeros symmetry codes uniformly. A
collection of these codes is given in Table 4.10.
4.7.2
QPSK modulation
Experimentally, codes obtained by replacing each zero in the binary generator matrix by a two yield
the best simulated frame error rate performance in most cases. These codes are reported in Table 4.11
for different numbers of transmit antennas and constraint lengths v and are used in generating the
simulation results in the next section.
A space–time code has zeros symmetry if every baseband code word difference f (c) −f (e)
is upper and lower triangular and has appropriate non-zero entries to ensure full rank. The zeros
symmetry property is sufﬁcient for full rank but not necessary. Some simulation results for the system
performance are shown in Figures 4.35–4.40.
4.8
DIFFERENTIAL SPACE–TIME MODULATION
When channel estimation is not available, a differential modulation and detection might be a solution.
We start with a simple transmission scheme [65] for exploiting diversity given by two transmit

DIFFERENTIAL SPACE–TIME MODULATION
117
Table 4.10
Natural full diversity space–time convolu-
tional codes with optimal free distance for
BPSK modulation [56] c⃝2002, IEEE
Lt
v
Connection polynomials
2
2
5, 7
3
64, 74
4
46, 72
5
65, 57
6
554, 744
3
3
54, 64, 74
4
52, 66, 76
5
47, 53, 75
6
554, 624, 764
4
4
52, 56, 66, 76
5
53, 67, 71, 75
5
5
75, 71, 73, 65, 57
Table 4.11
Linear Z4 space–time codes for QPSK modulation [56] c⃝2002, IEEE
L
v
Connection polynomials
2
1
1 + 2D, 2 + D.
2
1 + 2D + D2, 1 + D + D2.
3
l + D + 2D2 + D3, l + D + D2 + D3.
4
1 + 2D + 2D2 + D3 + D4, 1 + D + D2 + 2D3 + D4.
5
l + D + 2D2 + D3 + 2D4 + D5, 1 + 2D + D2 + D3 + D4 + D5.
3
2
1 + 2D + 2D2, 2 + D + 2D2, 2 + 2D + D2.
3
1 + 2D + D2 + D3, 1 + D + 2D2 + D3, 1 + D + D2 + D3.
4
l + 2D + D2 + 2D3 + D4, 1 + D + 2D2 + D3 + D4, 1 + D + D2 + D3 + D4.
5
1 + 2D + 2D2 + D3 + D4 + D5, 1 + 2D + D2 + 2D3 ++ D4 + D5,
1 + D + D2 + D3 + 2D4 + D5.
4
3
1 + 2D + 2D2 + 2D3, 2 + D + 2D2 + 23, 2 + 2D + D2 + 2D3, 2 + 2D + 2D2 + D3
4
1 + 2D + D2 + 2D3 + D4, 1 + 2D + D2 + D3 + D4, 1 + D + 2D2 + D3 + D4,
l + D + D2 + D3 + D4.
5
l + 2D + D2 + 2D3 + D4 + D5, l + D + 2D2 + D3 + D4 + D5,
1 + D + D2 + 2D3 + 2D4 + D5, 1 + D + D2 + D3 + 2D4 + D5.
5
4
1 + 2D + 2D2 + 2D3 + 2D4, 2 + D + 2D2 + 2D3 + 2D4, 2 + 2D + D2 + 2D3 + 2D4,
2 + 2D + 2D2 + D3 + 2D4, 2 + 2D + 2D2 + 2D3 + D4,
5
1 + D + D2 + D3 + 2D4 + D5, 1 + D + D2 + D3 + 2D4 + D5,
1 + D + D2 + 2D3 + D4 + D5, 1 + D + 2D2 + D3 + 2D4 + D5,
1 + 2D + D2 + D3 + D4 + D5.

118
SPACE–TIME CODING
FER
100
10−1
10−2
6
7
8
9
10
11
+
+
+
+
+
+
+
+
+
*
*
*
*
*
*
*
*
+
*
+
*
Delay diversity Lt=3
Zeros symmetry Lt=3. K=4
Algebraic code Lt=3. K=4
Delay diversity Lt=3
Zeros symmetry Lt=4. K=5
Algebraic code Lt=4. K=5
Eb/N0
Figure 4.35 Performance of BPSK space–time codes with Lr = 1. The number of transmit
antennas is represented by Lt, receive antennas by Lr, and constraint lengths
by K. The number of bits per frame is 100.
FER
+
*
+
*
+
*
Delay diversity Lr =1
Zeros symmetry Lr =1
Algebraic code Lt=1
Delay diversity Lr =2
Zeros symmetry Lr =2
Algebraic code Lr =2
Eb/N0
100
10−1
10−2
10−3
2
3
4
5
6
7
8
+
+
+
+
+
+
+
+
+
*
*
*
*
*
*
*
Figure 4.36 FER for BPSK space–time codes with Lt = 5 and K = 6.

+
+
*
*
TSC code Lr=2
BBH code Lr=2
Alg code Lr=2
GFK code Lr=2
TSC code Lr=4
BBH code Lr=4
Alg code Lr=4
GFK code Lr=4
+
*
+
*
*
+
+
*
*
*
100
10−1
10−20
1
2
3
4
5
6            7
FER
Eb/N0
Figure 4.37 Performance of four-state QPSK space–time codes with Lt = 2. Four-state
codes due to Tarokh, Seshadri, and Calderbank (TSC) [2], Baro, Bauch, and
Hansmann (BBH) [31], Grimm, Fitz, and Krogmeier (GFK) [33], and the new
linear Z4 code in Table 4.11 with two and four receive antennas.
+
+
+
+
+
+
+
*
*
*
*
*
*
*
+
*
+
*
BBH code Lr =2
New code Lr=2
GFK code Lr=2
BBH code Lr =2
Alg code Lr=2
GFK code Lr=2
0
1
2
3
4
5
6              7
100
10−1
10−2
Eb/N0
FER
Figure 4.38 Performance of eight-state QPSK space–time codes with Lt = 2.

Eb/N0
100
10−1
10−2
FER
9
9.5
10
10.5
11
11.5        12
*
*
*
+
+
+
+
*
TSC code (Delay diversity)
Algebraic code
Figure 4.39 FER for QPSK space–time codes with Lt = 4 and Lr = 1. The new 64-state
space–time code for four transmit antennas and the TSC 64-state code (i.e.
delay diversity).
Eb/N0
10-2
10−3
10−4
FER
*
+
+
*
Orthogonal code
Alg code
14
14.5
15
15.5           16
*
*
+
+
Figure 4.40 Performance of an algebraic short block and an orthogonal code with Lt = 3
and Lr = 1. The new algebraic code is used with QPSK modulation and the
orthogonal code is used with 16 QAM. The increased size of the constellation
in the case of the orthogonal code is necessary to support the same throughput
[6]. More details on the topic can be found in [56–64].

DIFFERENTIAL SPACE–TIME MODULATION
121
antennas when neither the transmitter nor the receiver has access to channel state information. At the
receiver, decoding is achieved with low decoding complexity. The transmission provides full spatial
diversity and requires no channel state side information at the receiver. The scheme can be considered
as the extension of conventional differential detection schemes to two transmit antennas.
In traditional differential phase shift keying (DPSK) the data is encoded in the difference of the
phase of two consecutive symbols. For b bits per symbol, the symbol would usually have the form:
	(l) = eiθ(l) = e2πil/L,
l = 0, 1, . . . L −1
(4.83)
where i =
√
−1 and L = 2b. If the data sequence is z1, z2, z3, . . . the transmitted symbol sequences
would be s0, s1, s2, . . . where, at time t,
st = 	(zt)st−1
(4.84)
Bits are mapped into the symbols by using Gray mapping, e.g. for b = 2:
M(z) ⇒	(z) = 	(l)
	(00) = 	(0) = e2πi ×0/4 = 1
	(01) = 	(1) = e2πi ×1/4 = ei π/2
(4.85)
	(10) = 	(3) = e2πi ×3/4 = e−i π/2
	(11) = 	(2) = e2πi ×2/4 = −1
This ensures that the most probable symbol errors cause the minimum number of bit errors.
Signal rt from the received signal sequence r0,r1,r2, . . . can be represented as:
rt = htst + nt
(4.86)
where ht is the channel gain. The receiver would extract the information by processing the received
signal samples as follows:
ˆθt = argrtr ∗
t−1
(4.87)
which, for ht ∼= ht−1, |ht| = 1 and no noise, gives:
ˆθt = arg htsth∗
t−1s∗
t−1 = arg |ht|2 	(zt) |st−1|2 = arg 	(zt)
(4.88)
By using analogy with the previous discussion we will now extend this principle to two-dimensional
constellations. Later in the chapter we will generalize these schemes to multidimensional constella-
tions.
Let us restrict the constellation A to 2b-PSK for some b = 1, 2, 3, . . . , but in reality only BPSK,
QPSK, and 8PSK are of interest. Thus,
A =
*
e2πki/2b
√
2
|k = 0, 1, . . . , 2b −1
+
(4.89)
In order to implementl Equation (4.84) in a two-dimensional constellation, let us ﬁrst consider the
following relation between the vectors.
Given a pair of 2b-PSK constellation symbols, x1 and x2, we ﬁrst observe that the complex vectors
(x1x2) and (−x∗
2 x∗
1) are orthogonal to each other and have unit lengths deﬁned by 	
i xix∗
i = 1. Any
two-dimensional vector X = (x3x4) can be uniquely represented in the orthonormal basis given by
these vectors. In other words, there exists a unique complex vector PX = (AX BX ) such that AX and
BX satisfy the vector equation:
(x3x4) = AX (x1x2) + BX (−x∗
2 x∗
1)
(4.90)

122
SPACE–TIME CODING
or
x3 = AX x1 −BX x∗
2
x4 = AX x2 + BX x∗
1
x3x∗
1 = AX x1x∗
1 −BX x∗
2 x∗
1
x4x∗
2 = AX x2x∗
2 + BX x∗
1 x∗
2
giving AX and BX as:
AX = x3x∗
1 + x4x∗
2
(4.91)
BX = −x3x2 + x4x1
These relations will be used later to implement Equation (4.84). For an equivalent implementation
of Equation (4.85) we will need a few additional deﬁnitions.
We deﬁne the set VX to consist of all the vectors PX , X /∈A × A. The set VX has the following
properties:
r Property A: It has 22b elements corresponding to the pairs (x3x4) of constellation symbols.
r Property B: All elements of VX have unit length.
r Property C: For any two distinct elements X = (x1x2) and Y = (y1y2) of A × A
||PX −PY|| = ||(x1x2) −(y1y2)||.
r Property D: The minimum distance between any two distinct elements of VX is equal to the
minimum distance of the 2b-PSK constellation A.
The above properties hold because the mapping X →PX is just a change of basis from the
standard basis given by vectors {(1 0), (0 1)} to the orthonormal basis given by {(x1 x2), (−x∗
2 x∗
1)},
which preserves the distances between the points of the two-dimensional complex space.
The ﬁrst ingredient of construction is the choice of an arbitrary set V having Properties A and B.
It is also handy if V has Properties C and D as well. As a natural choice for such a set V, we may ﬁx
an arbitrary pair X ∈A × A and let V = VX . Because the 2b-PSK constellation A always contains
the signal point 1/
√
2, we choose to ﬁx X = ((1/
√
2)(1/
√
2)).
We also need an arbitrary bijective mapping M of blocks of 2b bits onto V. Among all the
possibilities for M, we choose the mapping analogous to Equation (4.85). Given a block B of 2b
bits, the ﬁrst b bits are mapped into a constellation symbol a3 and the second b bits are mapped into
a constellation symbol a4 using Gray mapping.
Let a1 = a2 = 1/
√
2, then M(B) = (A(B) B(B)) is deﬁned by Equation (4.91):
A(B) = a3a∗
1 + a4a∗
2
B(B) = −a3a2 + a4a1
(4.92)
Clearly, M maps any 2b bits onto V. Conversely, given (A(B) B(B)), the pair (a3 a4) is recovered
by Equation (4.90):
(a3 a4) = A(B)(a1 a2) + B(B)(−a∗
2 a∗
1)
(4.93)
The block B is then constructed by inverse Gray mapping of a3 and a4.
4.8.1
The encoding algorithm
The transmitter begins the transmission by sending arbitrary symbols s1 and s2 from transmit antennas
one and two respectively at time one, and symbols −s∗
2 and s∗
1 at time two unknown to the receiver.
These two transmissions do not convey any information. The transmitter then encodes the rest of the
data in an inductive manner. Suppose that s2t−1 and s2t are sent, respectively, from transmit antennas
one and two at time 2t −1, and that −s∗
2t, s∗
2t−1 are sent, respectively, from antennas one and two

DIFFERENTIAL SPACE–TIME MODULATION
123
Delay
Symbol
calculation
Transmit
antennas
M
Figure 4.41 Transmitter block diagram.
at time 2t. At time 2t + 1, a block of 2b bits B2t+1 arrives at the encoder. The transmitter uses the
mapping M given by Equation (4.92) and computes M(B2t+1) = (A(B2t+1) B(B2t+1)). Then, in
accordance with Equation (4.92) it computes:
(s2t+1 s2t+2) = A(B2t+1)(s2t−1 s2t) + B(B2t+1)(−s∗
2t s∗
2t−2)
(4.94)
The transmitter then sends s2t+1 and s2t+2, respectively, from transmit antennas one and two at
time 2t + 1, and −s∗
2t+2, s∗
2t+1 from antennas one and two at time 2t + 2. This process is inductively
repeated until the end of the frame (or end of the transmission). The block diagram of the encoder is
given in Figure 4.41.
4.8.1.1
Example
We assume that the constellation is BPSK (b = 1) consisting of the points −1/
√
2 and 1/
√
2.
Then the set V = {(1 0), (0 1), (−1 0), (0 −1)}. Recall that the Gray mapping maps a bit i = 0, 1 to
(−1)i/
√
2. We set a1 = a2 = 1/
√
2. Then the mapping M maps two bits onto V and is given by:
M(00) = (1 0)
M(10) = (0 1)
M(01) = (0 −1)
(4.95)
M(11) = (−1 0)
Now suppose that at time 2t −1, s2t−1 = 1/
√
2 and s2t = −1/
√
2 are sent, respectively, from
antennas one and two, and at time 2t, −s∗
2t = 1/
√
2 and s∗
2t−1 = 1/
√
2 are sent. Suppose that the
input to the encoder at time 2t + 1 is the block of bits 10. Since M(10) = (0 1), we have A(10) = 0
and B(10) = 1. Then the values s2t+1 and s2t+2 corresponding to input bits 10 are computed as follows:
(s2t+1 s2t+2) = 0 ·
 1
√
2
−1
√
2

+ 1 ·
 1
√
2
1
√
2

=
 1
√
2
1
√
2

(4.96)
Thus, at time 2t + 1, s2t+1 = 1/
√
2 and s2t+2 = 1/
√
2 are sent, respectively, from antennas one
and two, and at time 2t + 2, −s∗
2t+2 = −1/
√
2 and s∗
2t+1 = 1/
√
2 are sent, respectively, from antennas
one and two. Transmitted symbols at time 2t + 1 and 2t + 2 correspond to the input bits 00, 10, 01
and 11 for this scenario. The results are summarized in Tables 4.12 and 4.13.
4.8.2
Differential decoding
For notational simplicity, we ﬁrst present the results for one receive antenna. Write rt for r 1
t , ηt for
η1
t and α1, α2, respectively, for α1,1, α2,1, knowing that this can cause no confusion since there is only
one receive antenna.

124
SPACE–TIME CODING
Table 4.12
Transmitted symbols at time 2t + 1 [65]
c⃝2002, IEEE
Input bits at time 2t + 1
Antenna 1
Antenna 2
00
1
√
2
−1
√
2
10
1
√
2
1
√
2
01
−1
√
2
−1
√
2
11
−1
√
2
1
√
2
Table 4.13
Transmitted symbols at time 2t + 2 [65]
c⃝2002, IEEE
Input bits at time 2t + 1
Antenna 1
Antenna 2
00
1
√
2
1
√
2
10
−1
√
2
1
√
2
01
1
√
2
−1
√
2
11
−1
√
2
−1
√
2
r2t−1,r2t,r2t+1, and r2t+2 are received signal samples. Let

(α1, α2) =
& α1
α∗
2
α2
−α∗
1
'
(4.97)
and
N2t−1 = (η2t−1 η∗
2t)
(4.98)
Then the received signal can be represented as:
(r2t−1 r ∗
2t) = (s2t−1 s2t)
(α1, α2) + N2t−1
(4.99)
and
(r2t+1 r ∗
2t+2) = (s2t+1 s2t+2)
(α1, α2) + N2t+1
(4.100)
The receiver will create
(r2t+1 r ∗
2t+2) · (r2t−1 r ∗
2t) = (s2t+1 s2t+2)
(α1, α2)
∗(α1, α2)(s∗
2t−1 s∗
2t)
+ (s2t+1 s2t+2)
(α1, α2)N ∗
2t−1
+ N2t+1
∗(α1, α2)(s2t−1 s2t)∗+ N2t+1N ∗
2t−1
(4.101)
which gives:
r2t+1r ∗
2t−1 + r ∗
2t+2r2t = (|α1|2 + |α2|2)(s2t+1s∗
2t−1 + s2t+1s∗
2t)
+ (s2t+1 s2t+2)
(α1, α2)N ∗
2t−1
+ N2t+1
∗(α1, α2)(s2t−1 s2t)∗+ N2t+1N ∗
2t−1
For a more compact representation we use the following notation:
R1 = r2t+1r ∗
2t−1 + r ∗
2t+2r2t
N1 = (s2t+1 s2t+2)
(α1, α2)N ∗
2t−1 + N2t+1
∗(α1, α2)(s2t−1 s2t)∗+ N2t+1N ∗
2t−1

MTADD FROM GENERALIZED ORTHOGONAL DESIGNS
125
which gives
R1 = (|α1|2 + |α2|2)A(B2t−1) + N1
(4.102)
For the second vector term in the right side of Equation (4.94) we have:
(r2t −r ∗
2t−1) = (−s∗
2t s∗
2t−1)
(α1, α2) + N2t
where
N2t = (η2t −η∗
2t−1)
The receiver will now create
(r2t+1 r ∗
2t+2) · (r2t −r ∗
2t−1) = (s2t+1 s2t+2)
(α1, α2)
∗(α1, α2)(−s2t s2t−1)
+ (s2t+1 s2t+2)
(α1, α2)N ∗
2t
+ N2t+1
∗(α1, α2)(−s∗
2t s∗
2t−1)∗+ N2t+1N ∗
2t
giving:
r2t+1r ∗
2t −r ∗
2t+2r2t−1 = (|α1|2 + |α2|2)(−s2t+1s∗
2t + s2t+2s∗
2t−1)
+ (s2t+1 s2t+2)
(α1, α2)N ∗
2t
+ N2t+1
∗(α1, α2)(−s∗
2t s∗
2t−1)∗+ N2t+1N ∗
2t
With the notation
R2 = r2t+1r ∗
2t −r ∗
2t+2r2t−1
N2 = +(s2t+1 s2t+2)
(α1, α2)N ∗
2t + N2t+1
∗(α1, α2)(−s∗
2t s∗
2t−1)∗+ N2t+1N ∗
2t
we have
R2 = (|α1|2 + |α2|2)B(B2t−1) + N2
(4.103)
The ﬁnal result can be represented as:
(R1R2) = (|α1|2 + |α2|2)(A(B2t−1) B(B2t−1)) + (N1N2)
(4.104)
Because the elements of V have equal length, to compute (A(B2t−1)B(B2t−1)), the receiver now
computes the closest vector of V to (R1R2). Once this vector is computed, the inverse mapping of
M is applied and the transmitted bits are recovered (see Table 4.12 and Table 4.13). The receiver
block diagram and BER curves are given in Figures 4.42 and 4.43 respectively. As in the traditional,
one dimensional DPSK system, there is loss in the performance (about 3 dB at BER = 0.001).
More results on the topic can be found in [65–76].
4.9
MULTIPLE TRANSMIT ANTENNA DIFFERENTIAL DETECTION
FROM GENERALIZED ORTHOGONAL DESIGNS
In this section we explicitly construct multiple transmit antenna differential encoding/decoding
schemes based on generalized orthogonal designs. These constructions generalize the two trans-
mit antenna differential detection scheme discussed in the previous section. The presentation is based
on [77, 78].
Calculate
(
1
2)
Closest vector
of
to (
1
2)
−1
Figure 4.42 Receiver block diagram.

126
SPACE–TIME CODING
100
10−1
10−2
10−3
10−5
10−4
Differential detection method
Coherent two-level transmit diverstity
8
10
12
14
16             18
Bit error probability
SNR (dB)
Figure 4.43 Performance of the differential detection and coherent detection: two-level
transmit diversity scheme for BPSK constellation.
4.9.1
Differential encoding
We consider the speciﬁc example code, 84, and only one receive antenna, M = 1. The generalization
to other codes is straightforward. The code set is deﬁned as:
84 =


x1
x2
x3
x4
−x2
x1
−x4
x3
−x3
x4
x1
−x2
−x4
−x3
x2
x1
x∗
1
x∗
2
x∗
3
x∗
4
−x∗
2
x∗
1
−x∗
4
x∗
3
−x∗
3
x∗
4
x∗
1
−x∗
2
−x∗
4
−x∗
3
x∗
2
x∗
1


(4.105)
4.9.2
Received signal
At each time, there is only one received signal, rt,1, which can be noted by rt and this is related to the
constellation symbols s1, s2, s3, s4 by:
r1 = α1s1 + α2s2 + α3s3 + α4s4 + η1
r2 = −α1s2 + α2s1 −α3s4 + α4s3 + η2
r3 = −α1s3 + α2s4 + α3s1 −α4s2 + η3
r4 = −α1s4 −α2s3 + α3s2 + α4s1 + η4
r1 = α1s1 + α2s2 + α3s3 + α4s4 + η1
r2 = −α1s2 + α2s1 −α3s4 + α4s3 + η2
r3 = −α1s3 + α2s4 + α3s1 −α4s2 + η3
r4 = −α1s4 −α2s3 + α3s2 + α4s1 + η4
(4.106)
By using Equation (4.165), one can show that the following relations are valid:
(r1,r2,r3,r4,r ∗
5,r ∗
6,r ∗
7,r ∗
8) = (s1, s2, s3, s4) + (η1, η2, η3, η4, η∗
5, η∗
6, η∗
7, η∗
8)
(4.107)

MTADD FROM GENERALIZED ORTHOGONAL DESIGNS
127
where
 =


α1
α2
α3
α4
α∗
1
α∗
2
α∗
3
α∗
4
α2
−α1
−α4
α3
α∗
2
−α∗
1
−α∗
4
α∗
3
α3
α4
−α1
−α2
α∗
3
α∗
4
−α∗
1
−α∗
2
α4
−α3
α2
−α1
α∗
4
−α∗
3
α∗
2
−α∗
1


(4.108)
If, instead of S = (s1, s2, s3, s4), other orthogonal vectors are used, we have:
(−r2,r1,r4, −r3, −r ∗
6,r ∗
5,r ∗
8, −r ∗
7) = (s2, −s1, s4, −s3)
+ (−η2, η1, η4, −η3, −η∗
6, η∗
5, η∗
8, −η∗
7)
(−r3, −r4,r1,r2, −r ∗
7, −r ∗
8,r ∗
5,r ∗
6) = (s3, −s4, −s1, s2)
+ (−η3, −η4, η1, η2, −η∗
7, −η∗
8, η∗
5, η∗
6)
(−r4,r3, −r2,r1, −r ∗
8,r ∗
7, −r ∗
6,r ∗
5) = (s4, s3, −s2, −s1)
+ (−η4, η3, −η2, η1, −η∗
8, η∗
7, −η∗
6, η∗
5)
(4.109)
4.9.3
Orthogonality
Note that, in general, for S = (s1, s2, s3, s4)T, vectors
V1(S) = (s1, s2, s3, s4, s∗
1, s∗
2, s∗
3, s∗
4)T
V2(S) = (s2, −s1, s4, −s3, s∗
2, −s∗
1, s∗
4, −s∗
3)T
V3(S) = (s3, −s4, −s1, s2, s∗
3, −s∗
4, −s∗
1, s∗
2)T
V4(S) = (s4, s3, −s2, −s1, s∗
4, s∗
3, −s∗
2, −s∗
1)T
(4.110)
are
orthogonal
to
each
other.
Therefore,
for
speciﬁc
constellation
symbols
S,
vectors
V1(S), V2(S), V3(S), V4(S) can create a basis for the four-dimensional subspace of any arbitrary
four-dimensional constellation symbols and their conjugates in an eight-dimensional space. If the
constellation symbols are real numbers, vectors
V′
1(S) = (s1, s2, s3, s4)T
V′
2(S) = (s2, −s1, s4, −s3)T
V′
3(S) = (s3, −s4, −s1, s2)T
V′
4(S) = (s4, s3, −s2, −s1)T
(4.111)
which only contain the ﬁrst four elements of vectors V1(S), V2(S), V3(S), V4(S), create a basis for
the space of any arbitrary four-dimensional real constellation symbols.
4.9.4
Encoding
Step 1. Let us assume that we use a signal constellation with 2b elements. For each block of Kb bits,
the encoding is done by ﬁrst calculating the K-dimensional vector of symbols S = (s1, s2, . . . , sK)T.
Step 2. Indeterminates x1, x2, . . . , xK in  are replaced by s1, s2, . . . , sK to establish the matrix X
which is used for transmission in a manner similar to a regular space–time block code. The main
issue here is how to calculate S = (s1, s2, . . . , sK)T such that non-coherent detection is possible.
Step 3. Let us assume that Sv is the vector which is used for the vth block of Kb bits. Also, X(Sv)
deﬁnes what to transmit from each antenna during the transmission of the vth block. In other words,
Xn(Sv), n = 1, 2, . . . , N is the nth column of X(Sv) which contains T symbols which are transmitted
from the nth antenna sequentially.
We ﬁx a set V which consists of 2Kb unit length vectors P1, P2, . . . , P2Kb where each vector Pl is a
K × 1 vector of real numbers Pl = (Pl1, Pl2, . . . , PlK)T. We deﬁne an arbitrary one-to-one mapping
β which maps Kb bits onto V. We start with an arbitrary vector S1. Then, let us assdume that Sv is
used for the vth block. For the (v + 1)th block, we use the Kb input bits to pick the corresponding

128
SPACE–TIME CODING
vector Pl in V using the one-to-one mapping β. Then, we calculate:
Sv+1 =
K

k=1
PlkV′
k (Sv)
(4.112)
where V′
k (Sv) is a K-dimensional vector which includes the ﬁrst K elements of Vk (Sv). We use
X(Sv+1) for transmission at the following T time slots.
4.9.4.1
Example
We pick four BPSK symbols, i.e. symbol sk = 1 if the corresponding bit is zero and sk = −1 otherwise.
Then, Pl is deﬁned as the projection of the vector (s1, s2, s3, s4) onto V′
1 (S) , V′
2 (S) , V′
3 (S) , V′
4 (S),
where S = (1, 1, 1, 1)T. In fact, the elements of Pl can be calculated using the following equations:
Pl1 = (s1 + s2 + s3 + s4)/4
Pl2 = (s1 −s2 + s3 −s4)/4
Pl3 = (s1 −s2 −s3 + s4)/4
Pl4 = (s1 + s2 −s3 −s4)/4
(4.113)
This completes the one-to-one mapping β which is needed for encoding and decoding.
4.9.5
Differential decoding
Let us recall that the received signal rt is related to the transmitted signals by:
rt =
N

n=1
αnXt,n + ηt
(4.114)
Assuming T = 2K, which results in a rate 1/2 code, and deﬁning
R =

r1,r2, . . . ,rK,r ∗
K+1,r ∗
K+2, . . . ,r ∗
2K

,
we have
R = ST (α1, α2, . . . , αN) + N
(4.115)
where N = (η1, η2, . . . , ηK, η∗
K+1, η∗
K+2, . . . , η∗
2K) and
(α1, α2, . . . , αN) = (
(α1, α2, . . . , αN)
(α∗
1, α∗
2, . . . , α∗
N))
(4.116)
where 
(α1, α2, . . . , αN) is the K × K matrix deﬁned by

i, j = δ(i, j)αε(i, j),
i = 1, 2, . . . , K,
j = 1, 2, . . . , K
(4.117)
where ε (i, j) = l ⇔B j,l = si or B j,l = −si, and
δ (i, j) =
*
1,
if B j,l = si
−1,
if B j,l = −si
4.9.5.1
Example
For the rate 1/2 code deﬁned by 84 in Equation (4.105), 
 (α1, α2, α3, α4) is a 4 × 4 matrix deﬁned
by:

 =


α1
α2
α3
α4
α2
−α1
−α4
α3
α3
α4
−α1
−α2
α4
−α3
α2
−α1


(4.118)

MTADD FROM GENERALIZED ORTHOGONAL DESIGNS
129
Differential decoding is enabled by the fact that ∗= 2 	N
n=1 |αn|2 IK. To prove it, let us set
N = 0 in Equations (4.114) and (4.115). Then, we have R = ST which results in:
RR∗= ST ∗S∗T
(4.119)
On the other hand
RR∗=
T

t=1
|rt|2 =
T

t=1
 N

n=1
αnXt,n
  N

n=1
αnXt,n
∗
(4.120)
We rewrite the above formulas using matrix C as follows:
RR∗= (α1, α2, . . . , αN)XTX∗T(α1, α2, . . . , αN)∗
= (α1, α2, . . . , αN)(X∗X)T(α1, α2, . . . , αN)∗
= (α1, α2, . . . , αN)2
K

k=1
|sk|2 IK(α1, α2, . . . , αN)∗
(4.121)
= 2
K

k=1
|sk|2(α1, α2, . . . , αN)(α1, α2, . . . , αN)∗
Therefore, we have:
RR∗= ST∗S∗T = 2
K

k=1
|sk|2
N

n=1
|αn|2
(4.122)
Since Equation (4.122) is true for any S = (s1, s2, . . . , sK)T, we should have
∗= 2
N
n=1 |αn|2 IK
4.9.6
Received signal
Let us recall that Sv and Sv+1 are used for the vth and (v + l)th blocks of Kb bits, respectively. Using
84, for each block of data we receive eight signals. To simplify the notation, we denote the received
signals corresponding to the vth block by r v
1 ,r v
2 , . . . ,r v
8 and the received signals corresponding to the
(v + l)th block by r v+1
1
,r v+1
2
, . . . ,r v+1
8
. Let us construct the following vectors (see Equation (4.109)).
R1
v =

r v
1 ,r v
2 ,r v
3 ,r v
4 ,r v∗
5 ,r v∗
6 ,r v∗
7 ,r v∗
8

R2
v =

−r v
2 ,r v
1 ,r v
4 , −r v
3 , −r v∗
6 ,r v∗
5 ,r v∗
8 , −r v∗
7

R3
v =

−r v
3 , −r v
4 ,r v
1 ,r v
2 , −r v∗
7 , −r v∗
8 ,r v∗
5 ,r v∗
6

(4.123)
R4
v =

−r v
4 ,r v
3 , −r v
2 ,r v
1 , −r v∗
8 ,r v∗
7 , −r v∗
6 ,r v∗
5

Rv+1 =

r v+1
1
,r v+1
2
,r v+1
3
,r v+1
4
,r (v+1)∗
5
,r (v+1)∗
6
,r (v+1)∗
7
,r (v+1)∗
8

By using Equations (4.107) and (4.109), we have:
Rv+1Rk∗
v = ST
v+1∗V′
k (Sv)∗T + Nk
= 2
4

n=1
|αn|2 ST
v+1V′
k (Sv)∗T + Nk
(4.124)
= 2
4

n=1
|αn|2 Plk + Nk

130
SPACE–TIME CODING
Therefore, we can write:
R =

Rv+1R1∗
v , Rv+1R2∗
v , Rv+1R3∗
v , Rv+1R4∗
v

(4.125)
=

2
4

n=1
|αn|2

Pl + N′
where N′ = (η1, η2, . . . , ηK).
4.9.7
Demodulation
Because the elements of R have equal lengths, to compute Pl, the receiver can compute the closest
vector of V to R. Once this vector is computed, the inverse mapping of β is applied and the transmitted
bits are recovered.
4.9.8
Multiple receive antennas
If there is more than one receive antenna, the same procedure can be used. In this case, ﬁrst assuming
that only the receive antenna m exists, we compute Pm using the same method for P given above. Then,
after calculating M vectors Pm, m = 1, 2, . . . , M, the closest vector of V to 	M
m=1 Pm is computed.
The inverse mapping of β is applied to the closest vector to compute the transmitted bits. It is easy to
show that 4M-level diversity is achieved by using this method.
4.9.9
The number of transmit antennas lower than the number of symbols
So far, we have considered an example where N = K, i.e. the real matrix which creates  is a square
matrix. When the number of transmit antennas is less than the number of symbols, N < K, the same
approach works. Let us use the following example:
83 =


x1
x2
x3
−x2
x1
−x4
−x3
x4
x1
−x4
−x3
x2
x∗
1
x∗
2
x∗
3
−x∗
2
x∗
1
−x∗
4
−x∗
3
x∗
4
x∗
1
−x∗
4
−x∗
3
x∗
2


(4.126)
When there is only one receive antenna, M = 1, the received signals are related to the constellation
symbols s1, s2, s3, s4 by:
r1 = α1s1 + α2s2 + α3s3 + η1
r2 = −α1s2 + α2s1 −α3s4 + η2
r3 = −α1s3 + α2s4 + α3s1 + η3
r4 = −α1s4 −α2s3 + α3s2 + η4
(4.127)
r5 = α1s∗
1 + α2s∗
2 + α3s∗
3 + η5
r6 = −α1s∗
2 + α2s∗
1 −α3s4 + η6
r7 = −α1s∗
3 + α2s4 + α3s∗
1 + η7
r8 = −α1s4 −α2s∗
3 + α3s∗
2 + η8.
Equation (4.107) now becomes:
(r1,r2,r3,r4,r ∗
5,r ∗
6,r ∗
7,r ∗
8) = (s1, s2, s3, s4)  + (η1, η2, η3, η4, η∗
5, η∗
6, η∗
7, η∗
8)
(4.128)

MTADD FROM GENERALIZED ORTHOGONAL DESIGNS
131
where
 =


α1
α2
α3
0
α∗
1
α∗
2
α∗
3
0
α2
−α1
0
α3
α∗
2
−α∗
1
0
α∗
3
α3
0
−α1
−α2
α∗
3
0
−α∗
1
−α∗
2
0
−α3
α2
−α1
0
−α∗
3
α∗
2
−α∗
1


(4.129)
The matrix  for 83 can be calculated from  for 84, and Equation (4.108) by setting α4 = 0.
Therefore, again for speciﬁc constellation symbols S, vectors V1(S), V2(S), V3(S), V4(S) can create
a basis for the four-dimensional subspace of any arbitrary four-dimensional constellation symbols
and their conjugates in an eight-dimensional space and the same encoding and decoding schemes are
applicable. The only difference in the ﬁnal result is that 	4
n=1 |αn|2 is replaced by 	3
n=1 |αn|2.
4.9.10
Final result
Instead of Equation (4.125) we now have:
R =

Rv+1R1∗
v , Rv+1R2∗
v , Rv+1R3∗
v , Rv+1R4∗
v

(4.130)
=

2
3

n=1
|αn|2

Pl + N′
4.9.11
Real constellation set
The above rate 1/2 space–time block codes can be applied to any complex constellation set. If the
constellation set is real, rate 1 space–time block codes are available and the same approach works.
For example, in the case of T = K = 4, the following space–time block code exists for N = 4:
 =


x1
x2
x3
x4
−x2
x1
−x4
x3
−x3
x4
x1
−x2
−x4
−x3
x2
x1


(4.131)
It is easy to show that:
(r1,r2,r3,r4,r ∗
1,r ∗
2,r ∗
3,r ∗
4) = (s1, s2, s3, s4) + (η1, η2, η3, η4, η∗
1, η∗
2, η∗
3, η∗
4)
(4.132)
where  is deﬁned by Equation (4.108). Similar differential encoding and decoding are possible if
we use the following vectors for Ri
v, i = 1, 2, 3, 4, and Rv+1:
R1
v =

r v
1 ,r v
2 ,r v
3 ,r v
4 ,r v∗
1 ,r v∗
2 ,r v∗
3 ,r v∗
4

R2
v =

−r v
2 ,r v
1 ,r v
4 , −r v
3 , −r v∗
2 ,r v∗
1 ,r v∗
4 , −r v∗
3

R3
v =

−r v
3 , −r v
4 ,r v
1 ,r v
2 , −r v∗
3 , −r v∗
4 ,r v∗
1 ,r v∗
2

(4.133)
R4
v =

−r v
4 ,r v
3 , −r v
2 ,r v
1 , −r v∗
4 ,r v∗
3 , −r v∗
2 ,r v∗
1

Rv+1 =

r v+1
1
,r v+1
2
,r v+1
3
,r v+1
4
,r (v+1)∗
1
,r (v+1)∗
2
,r (v+1)∗
3
,r (v+1)∗
4

This results in a full diversity, full rate scheme for differential detection. For example, as deﬁned
by Equation (4.133), performance results are shown in Figures 4.44 and 4.45 for four and three
transmit antennas respectively.
More details on the topic can be found in [77, 78].

BER
SNR (dB)
100
10−1
10−2
10−3
10−5
10−4
10−6
5
10
15                          20
×
×
×
×
×
×
×
×
×
×
×
×
×
×
×
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
non-coherent
coherent
∗∗∗∗
×
1 bit/s/Hz; four transmit antennas
Figure 4.44 Performance results for coherent and non-coherent detection schemes; four
transmit antennas, one receive antenna, BPSK.
BER
SNR (dB)
10−1
10−2
10−3
10−5
10−4
10−6
6           8           10          12        14          18           18        20
×
×
×
×
×
×
×
×
×
×
×
×
×
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
∗∗∗∗
1 bit/s/Hz; three transmit antennas
∗∗∗∗
×
*
coherent
non-coherent
∗∗∗∗
×
Figure 4.45 Performance results for coherent and non-coherent detection schemes; three
transmit antennas, one receive antenna, BPSK.

LAYERED SPACE–TIME CODING
133
4.10
LAYERED SPACE–TIME CODING
In this section we discuss a possibility of partitioning antennas at the transmitter into small groups, and
using individual space–time codes, called component codes, to transmit information from each group
of antennas. At the receiver, an individual space–time code is decoded by a linear processing technique
that suppresses signals transmitted by other groups of antennas by treating them as interference. This
receiver structure provides diversity and coding gain over uncoded systems. This combination of
array processing at the receiver and coding techniques for multiple transmit antennas can provide
reliable and very high data rate communication over narrowband wireless channels. A reﬁnement
of this basic structure gives rise to a multilayered space–time architecture that both generalizes and
improves upon the layered space–time architecture proposed by Foschini, which is known in the
literature as Bell Lab Layered space time (BLAST) coding [10, 77–88].
For 1 ≤j ≤m the signal r j
t received by antenna j at time t is given by:
r j
t =
n

i=1
αi, jci
t + η j
t
(4.134)
where ci
t is the encoded signal transmitted from transmit antenna i.
For any vector x, let xT denote the transpose of x. We can now write Equation (4.134) in the vector
form given by:
rt = ct + ηt
(4.135)
where
ct =

c1
t , c2
t , . . . , cn
t
T
rt =

r 1
t ,r 2
t , . . . ,r m
t
T
ηt =

η1
t , η2
t , . . . , ηm
t
T
(4.136)
and
 =


α1,1
α2,1
· · ·
· · ·
αn,1
α1,2
α2,2
· · ·
· · ·
αn,2
α1,3
α2,3
· · ·
· · ·
αn,3
...
...
...
...
...
α1,m
α2,m
· · ·
· · ·
αn,m


(4.137)
A space–time product encoder accepts a block of B input bits in each time slot t and these bits are
divided into q strings of lengths B1, B2, . . . , Bq with B1 + B2 + · · · + Bq = B. At the base station,
n antennas are partitioned into q groups G1, G2, . . . , Gq, respectively, comprising n1, n2, . . . , nq
antennas with n1 + n2 + . . . + nq = n. Each block B j, 1 ≤j ≤q is then encoded by a space–time
encoder X j. The output of X j goes through a serial to parallel converter and provides n j sequences
of constellation symbols for 1 ≤j ≤q which are simultaneously transmitted from the antennas
of the group G j. This gives a total of n sequences of constellation symbols that are transmitted
simultaneously from antennas 1, 2, . . . , n.
A space–time product encoder can be considered as a set of q space–time encoders, called the
component codes, operating in parallel on the same wireless communication channel, with each
encoder using n j transmit and m receive antennas for 1 ≤j ≤q. It will be denoted an X1 × X2 ×
· · · Xq encoder.

134
SPACE–TIME CODING
4.10.1
Receiver complexity
One approach to recovering the transmitted data at the receiver is to jointly decode the transmitted
code word, but the difﬁculty here is decoding complexity. Indeed, if we require a diversity of rm,
where r ≤min j (n j), then (see Section 4.2) the complexity of the trellis of X j is at least 2B j (r−1) states
and the complexity of the product code is at least 2B(r−1) states. This means that if B is very large,
the scheme may be too complex to implement.
4.10.2
Group interference suppression
The idea is to decode each code X j separately while suppressing signals from other component codes.
This approach has a much lower complexity but achieves a lower diversity order than the full diversity
order nm, which is the product of the numbers of transmit and receive antennas.
4.10.3
Suppression method
Without any loss of generality, we take j = 1 and look to decode X1. There are n −n1 interfering
signals. We assume that there are m ≥n −n1 + 1 receive antennas and that the receiver knows the
matrix  (channel state information). The matrix

(X1) =


αn1+1, 1
αn1+2, 1
· · ·
· · ·
αn, 1
αn1+1, 2
αn1+2, 2
· · ·
· · ·
αn, 2
αn1+1, 3
αn1+2, 3
· · ·
· · ·
αn, 3
...
...
...
...
...
αn1+1, m
αn1+2, m
· · ·
· · ·
αn, m


(4.138)
has rank less than or equal to the number of its columns. Thus, rank [
 (X1)] ≤n −n1.
4.10.4
The null space
The null space N of this matrix is the set of all row vectors x such that x
(X1) = (0, 0, . . . , 0).
Furthermore,
dim(N) + rank [
(X1)] = m
Since rank[
 (X1)] ≤n −n1, it follows that dim (N) ≥m −n + n1. Hence we can compute a
(not necessarily unique) set of orthonormal vectors:
{v1, v2, . . . , vm−n+n1}
in N. We let (X1) denote the (m −n + n1) × m matrix whose jth row is v j. Clearly, (X1)(X1)∗=
In1−n+m, where (X1)∗is the Hermitian of (X1) and In1−n+m is the (m −n + n1) × (m −n + n1)
identity matrix. We multiply both sides of Equation (4.135) by (X1) to arrive at:
(X1)rt = (X1)ct + (X1)ηt
(4.139)
where
(X1) =


α1,1
α2,1
· · ·
· · ·
αn1,1
α1,2
α2,2
· · ·
· · ·
αn1,2
α1,3
α2,3
· · ·
· · ·
αn1,3
...
...
...
...
...
α1,m
α2,m
· · ·
· · ·
αn1,m


(4.140)

LAYERED SPACE–TIME CODING
135
Since (X1)
(X1) = 0 is the all zero matrix, Equation (4.139) can be written as
(X1)rt = (X1)(X1)c1
t + (X1)ηt
(4.141)
where c1
t = (c1
t , c2
t , . . . , cn1
t )T. Setting
˜rt = (C1)rt
˜ = (C1)
˜ηt = (C1)ηt
(4.142)
we arrive at the equation
˜rt = ˜c1
t + ˜ηt
(4.143)
This is an equation where all the signal streams out of antennas n1 + 1, n1 + 2, . . . , n are sup-
pressed.
4.10.5
Receiver
Let us look at the structure of the decoder for the code X1, given that group interference suppression
is performed to suppress all the signal streams out of antennas n1 + 1, n1 + 2, . . . , n. To this end,
suppose that 
(X1) is given. The receiver computes a set of orthonormal vectors
{v1, v 2, . . . , vm−n+n1}
and the matrix (X1) as described in the previous section. Let ˜i j and ˜lk denote the (i, j)th and
(l, k)th elements of ˜. By deﬁnition ˜i j = viω j and ˜lk = vlωk where ω j and ωk are, respectively,
the jth and kth columns of (X1). The random variables ˜i j and ˜lk have zero means given 
(X1).
Moreover,
E
" ˜i j ˜∗
lk
#
= E
"
v iω jω∗
kv ∗
l
#
= v i E
"
ω jω∗
k
#
v ∗
l = δ jkv iv ∗
l = δ jkδil
(4.144)
where δ is the Kronecker delta function given by δrs = 0 ifr ̸= s and δrs = 1 ifr = s. We conclude that
the elements of the (m −n + n1) × n1 matrix ˜ are independent complex Gaussian random variables
of variance 0.5 per real dimension. Similarly, the components of the noise vector ˜ηt, t = 1, 2, . . .l
are independent Gaussian random variables of variance N0/2 per real dimension.
4.10.6
Decision metric
Assuming that all the code words of X1 are equiprobable, and given that group interference suppression
is performed, the ML receiver for X1 decides in favor of the code word
c1
1c2
1 · · · cn1
1 c1
2c2
2 · · · cn1
2 · · · c1
l c2
l · · · cn1
l
if it minimizes the decision metric
l
t=1
˜rt −˜c1
t
2
(4.145)
4.10.7
Multilayered space–time coded modulation
The previous discussion reduces code design for a multiple antenna communication system with
n transmit and m receive antennas to that of designing codes for communication systems with ni
transmit and ni + m −n, i = 1, 2, . . . , q, receive antennas where 	q
i=1 ni = n and ni ≥n −m + 1.
Using this insight, we may design a multilayered space–time coded modulation scheme. The idea
behind such a system is multistage detection and cancellation.

136
SPACE–TIME CODING
4.10.8
Diversity gain
Suppose that X1 is decoded correctly using combined array processing and space–time coding.
The space–time code X1 affords a diversity gain of n1 × (n1 + m −n). After decoding X1 we may
subtract the contribution of these code words to signals received at different antennas. This gives a
communication system with n −n1 transmit and m receive antennas.
In the next step the receiver uses combined array processing and space–time coding to decode
X2. The space–time code X2 affords a diversity gain of n2 × (n2 + n1 + m −n). Proceeding in
this manner, we observe that by subtracting the contribution of previously decoded code streams
X j, j ≤k −1 to the received signals at different antennas, the space–time code Xk affords a diversity
gain of nk × (n1 + · · · + nk + m −n).
We can choose space–time codes Xi, 1 ≤i ≤q to provide these diversity gains and such that the
sequence
n1 (n1 + m −n) , n2 (n2 + n1 + m −n) , . . . , nk (n1 + · · · + nk + m −n) , . . . , nqm
is an increasing sequence. Assuming there was no decoding error in steps 1, 2, . . . , k −1, then at
decoding step k, the probability of error for the component code Xk is equal to the probability of error
for Xk when employed in a communication system using nk transmit and (n1 + · · · + nk + m −n)
receive antennas.
4.10.9
Adaptive reconﬁgurable transmit power allocation
Since the diversity in each decoding stage k is more than that of the previous decoding stage k −1,
the transmit power out of each antenna at level k can be substantially less than that of the previous
layer. Thus the transmitter should divide the available transmit power among different antennas in
an unequal manner. Power allocation for this scenario is straightforward. In fact, powers at different
levels could be allocated based on the diversity gains. In this way, the allocated powers may decrease
geometrically in terms of the diversity gains. Other approaches are also possible.
4.10.9.1
Example 1
Transmitter. Here, four transmit and four receive antennas are used. The transmission rate is 4 bits/
s/Hz. Let X denote the 32-state 4PSK (see Figure 4.46) space–time trellis code given in Figure 4.47.
The product code X1 × X2 where X1 = X2 = X will be used for transmission of 4 bits/s/Hz. At
each time slot, upon the arrival of the four bits of the input data, the ﬁrst two bits are used as the
input to the encoder of X1 and the encoded symbols are transmitted by antennas one and two. The
second two bits are used as the input to the encoder of X2 and the encoded signals are transmitted
by antennas three and four. We assume that the average powers radiated from antennas one and two
are equal but each is twice as much as the average power radiated from antennas three and four.
Receiver. Interference suppression is used to suppress X2 and decode X1. Upon decoding X1
the contributions of the code words transmitted from antennas one and two are subtracted from the
received signals. Finally, X2 is decoded.
4.10.9.2
Simulation results
Figure 4.48 demonstrates the performance of this multilayered space–time coded architecture. Each
frame consists of 130 transmissions from each transmit antenna. It is assumed that the channel matrix
is perfectly known at the receiver. The horizontal axis shows the receive signal to noise ratio per
transmission time. Each transmission time corresponds to the transmission of four bits. Thus, the
horizontal axis denotes the receive signal to noise ratio per four bits. For comparison, the graph of the
outage capacity versus the signal to noise ratio for four transmit and four receive antennas is presented
in Figure 4.49. The outage capacity is deﬁned as the achievable capacity Cout for which the outage

LAYERED SPACE–TIME CODING
137
1
0
2
3
Figure 4.46 The 4PSK constellation.
00,01,02,03
11,12,13,10
22,23,20,21
33,30,31,32
20,21,22,23
33,30,31,32
02,03,00,01
13,10,11,12
33,30,31,32
00,01,02,03
11,12,13,10
22,23,20,21
13,10,11,12
20,21,22,23
31,32,33,30
02,03,00,01
22,23,20,21
33,30,31,32
00,01,02,03
13,10,11,12
02,03,00,01
13,10,11,12
20,21,22,23
31,32,33,30
11,12,13,10
22,23,20,21
33,30,31,32
00,01,02,03
31,32,33,30
02,03,00,01
13,10,11,12
20,21,22,23
Figure 4.47 4PSK space–time code, 32 states 2 bits/s/Hz.

138
SPACE–TIME CODING
10−1
10−2
Frame error probability
9
9.5
10
10.5
11
11.5          12
4 PSK, 4 bits/s/Hz, 4 Recv., 4 Trans. Antennas
SNR (dB)
Figure 4.48 The performance of the scheme in Example 1.
Capacity bits/s/Hz
20
18
16
14
12
10
8
6
4
2
10% Outage capacity, 4 TX, 4 RX Antennas
0
2
4
6
8
10
12
14
16
18          20
SNR (dB)
Figure 4.49 Outage capacity for four transmit and four receive antennas.

LAYERED SPACE–TIME CODING
139
probability Pout = P(C < Cout) < ε. More details on MIMO channel capacity will be presented in
Section 4.12. One can see that for a frame error probability of 10−1, the system is about 6 dB away
from the capacity.
4.10.9.3
Example 2
Here, eight transmit and eight receive antennas are used. The transmission rate is 8 bits/s/Hz. Let
X denote the code given in Figure 4.47. We use the product code X1 × X2 × X3 × X4 where X1 =
X2 = X3 = X4 = X for transmission of 8 bits/s/Hz. At each time instance, upon the arrival of the
eight bits of the input data, the ﬁrst, second, third, and fourth blocks of length two of the input
bits are respectively used as the input to encoders of X1, X2, X3 and X4. The output of encoders of
Xi, 1 ≤i ≤4 are, respectively, transmitted by antennas 2i −1 and 2i. We assume that the average
power radiated from antennas one and two is Es, the average power radiated from antennas three and
four is Es/2, the average power radiated from antennas ﬁve and six is Es/4, and the average power
radiated from antennas seven and eight is Es/8. Thus, the total signal to noise ratio at each receive
antenna is 15 Es/4N0.
Decoder. Group interference suppression is used to decode X1. Upon decoding X1, the contri-
butions of the code words transmitted from antennas one and two are subtracted from the received
signals. Using this, X2 is decoded next and so forth. In Figure 4.50, we provide simulation results to
demonstrate the performance of this multilayered space–time coded architecture. Each frame consists
of 130 transmissions from each transmit antenna. It is assumed that the channel matrix is perfectly
known at the receiver. The horizontal axis shows the receive signal to noise ratio per transmission
10−1
9.5
10
10.5
11
11.5
12
12.5
SNR (dB)
Frame error probability
4PSK, 4 bits/s/Hz, 8 Recv., 8 Trans. Antennas
Figure 4.50 The performance of the scheme in Example 2.

140
SPACE–TIME CODING
0
2
4
6
8
10
12
14
16
18
20
SNR (dB)
Capacitybits/s/Hz
10% Outage capacity, 8 TX, 8 RXAntennas
45
40
35
30
25
20
15
10
5
Figure 4.51 Outage capacity for eight transmit and eight receive antennas.
TCM encoder
Interleaver
ST block code
Information
source
Alamouti code
Deinterleaver
TC
Decision
output
STBC
combiner/
Soft decision
generator
−
*
0
*
1
1
0
c
c
c
c
TCM decoder
−
*
0
*
1
1
0
c
c
c
c
Figure 4.52 Block diagram of a space–time coded system concatenating STBC and TCM,
N = 2, M = 1.
time. Each transmission time corresponds to the transmission of eight bits. Thus, the horizontal axis
denotes the receive signal to noise ratio per eight bits.
For comparison, we provide in Figure 4.51 the graph of the outage capacity versus the signal to
noise ratio for eight transmit and eight receive antennas, as computed by Foschini and Gans [89]. We
observe that for a frame error probability of 10−1, we are about 9 dB away from the capacity.
More details on this topic can be found in [10, 77–88].
4.11
CONCATENATED SPACE–TIME BLOCK CODING
4.11.1
System model
The system model is given in Figure 4.52.

CONCATENATED SPACE–TIME BLOCK CODING
141
We begin by performance analysis and design criteria in quasi-static fading, where the fading
coefﬁcients are constant during a frame of length 2L and vary from one frame to another.
4.11.2
Product sum distance
Let η be the set of all i for which ci ̸= ei or ci+1 ̸= ei+1. Denote the number of elements in η by lη.
Then, at high signal to noise ratios (SNRs) [90],
P (C →E) ≤
1
( Es
4N0
lη
dP (lη)
)2
(4.146)
where
dP(lη) =

i∈η
,|ci −ei|2 + |ci+1 −ei+1|2-
is the product of Euclidean distances associated with two consecutive symbols along the error event
path (C →E). Parameter dP(lη) is referred to as the product–sum distance over span 2. In addition,
lη is referred to as the effective length of this error event over span 2.
Let Pe denote the error event probability, then by using the union bound, an upper bound can be
obtained as:
Pe ≤
∞

L=1

C

E̸=C
P (C)P (C →E)
(4.147)
where P (C) is the a priori probability of transmitting the symbol sequence C with length 2L. By
summing over all possible lη and all possible dP(lη), the error event probability can be further written
as:
Pe ≤

lη

dP(lη)
(lη, dP(lη))
( Es
4N0
lη
dP(lη)
)−2
(4.148)
where (lη, dP(lη)) is the average number of error events having the span 2 effective length lη and the
product–sum distance dP(lη).
4.11.3
Error rate bound
The smallest lη and the smallest dP(lη) dominate the error event probability at high SNRs. De-
noting R = min (lη) and dmin(R) = min(dP (R)), then the error event probability is asymptotically
approximated as:
Pe ∼= (R, dmin(R))
1
 Es
4N0
2R
[dmin(R)]2
(4.149)
From Equation (4.149), we observe that the error event probability asymptotically varies with
2R-power of SNR, so a diversity order of 2R is achieved. We further refer to R as the built-in time
diversity or effective length of the concatenated space–time code.
The design criteria, in this case, involve the maximization of both the built-in-time diversity and the
minimum product–sum distance of the trellis code at high SNRs for Rayleigh fading. This conclusion
is, therefore, different from that of conventional TCM where the minimum product distance needs to
be maximized. Thus, new optimal codes can be found, based upon these new criteria.

142
SPACE–TIME CODING
4.11.4
The case of low SNR
For low SNR we have [90]:
P (C →E) ≤
(
1 + Es
4N0
2L−1

i=0
|ci −ei|2 + o
 Es
4N0
)−2
(4.150)
where o(Es/4N0) denotes the summation of all the terms which include higher order quantities of
(Es/4N0). Equation (4.150) indicates that the squared Euclidean distance becomes the main factor.
Thus, the dominant factor affecting the performance of trellis coded modulation for use with space–
time block coding at low SNRs is the free Euclidean distance rather than the product–sum distance
and built-in time diversity.
4.11.5
Code design
Here we explain the code design rules, by using the example with the four-state rate 2/3 8PSK trellis
code for use with transmit diversity as it was presented in [90]. It is noted that the built-in time diversity
(R) of a four-state code is equal to one and, therefore, optimized in this simplest case. In order to
increase the product–sum distance of the code, parallel transitions in the trellis diagram are avoided.
Thus, we can only consider the error events of actual length two to maximize the minimum product–
sum distance of the underlying code. The signal transitions between states of consecutive stages can
be represented by a 4 × 4 matrix G, where the ijth element represents the signal transmitted from
state i to state j between consecutive stages in the trellis diagram. Using set partitioning, the 8PSK
signal set shown in Figure 4.53 is partitioned into two subsets A0 = (0, 2, 4, 6) and A1 = (1, 3, 5, 7).
The design rules are given as follows.
Rule 1. Elements of each row of the matrix G are associated with signals from subsets A0 or A1.
Speciﬁcally, signals with distance δ1 and δ3 are associated with branches diverging from one state to
two adjacent states, with a state difference of two and one, respectively, where the state difference is
deﬁned as the number of bits in which two states differ (see Figure 4.54).
Rule 2. The distance between branches remerging at one state from two adjacent states with a
state difference of two is δ2. The pair of signals remerging from two states with a state difference of
one is associated with distance δ0 or δ3.
According to Equation (4.149), the minimum product–sum distance should be maximized. Rule
1 associates distance δ1 to signals diverging from one state to two adjacent states with a state
difference of two (two states with state difference of two are always adjacent) and guarantees that
the distance between any two signals diverging from one state is at least δ1. Thus, if we assign δ2 to
signals remerging at one state from two states with a state difference of two (Rule 2), the minimum
s
s
s
s
E
E
E
E
4
414
.3
2
586
.0
2
3
2
2
2
1
2
0
=
≅
=
≅
δ
δ
δ
δ
1
2
0
3
4
7
6
5
δ2
δ3
δ1
δ0
s
E
E
E
E
E
4
414
.3
2
586
.0
2
3
2
2
2
1
2
0
=
≅
=
≅
δ
δ
δ
δ
1
2
0
3
4
7
6
5
δ2
δ3
δ1
δ0
E
Figure 4.53 8 PSK signal set [90] c⃝2002, IEEE.

CONCATENATED SPACE–TIME BLOCK CODING
143
0 4 2 6
7 3 1 5
4 0 6 2
3 7 5 1
0 4 2 6
1 5 3 7
4 0 6 2
5 1 7 3
or
Stage
k
S0
S1
S2
S3
k + 1
k + 2
S0
S1
S2
S3
00
10
01
11
State
0 4 2 6
7 3 1 5
4 0 6 2
3 7 5 1
0 4 2 6
1 5 3 7
4 0 6 2
5 1 7 3
or
Stag
S0
S1
S2
S3
S0
S1
S2
S3
00
10
01
11
State
Figure 4.54 Trellis diagram of the four-state 2/3 8PSK trellis code [90] c⃝2002, IEEE
0 4 2 6
1 5 3 7
4 0 6 2
5 1 7 3
2 6 0 4
3 7 1 5
6 2 4 0
7 3 5 1
4 0 6 2
5 1 7 3
0 4 2 6
1 5 3 7
6 2 4 0
7 3 5 1
2 6 0 4
3 7 1 5
0
0
0
0
6
1
7
2
0 4 2 6
1 5 3 7
4 0 6 2
5 1 7 3
2 6 0 4
3 7 1 5
6 2 4 0
7 3 5 1
4 0 6 2
5 1 7 3
0 4 2 6
1 5 3 7
6 2 4 0
7 3 5 1
2 6 0 4
3 7 1 5
0
0
6
2
Figure 4.55 Trellis diagram of the 16-state 2/3 8PSK trellis code [90] c⃝2002, IEEE.
product–sum distance will be:
dmin (R) = min

δ2
1 + δ2
2, δ2
0 + δ2
3

= δ2
0 + δ2
3 = 4.586Es
which is greater than that of the optimal single antenna four-state 2/3 8PSK code.
Using the above code design rules, the best four-state 2/3 8PSK trellis code for use with trans-
mit diversity when perfect interleavers are assumed is shown in Figure 4.54. An equivalent code
constructed using the design tools is also shown in the ﬁgure.
The eight-state trellis code can also be constructed. Due to the constraint of the trellis structure, the
eight-state code becomes the Ungerboeck code [91]. Its minimum product–sum distance is 6ES. An
eight-state code with a larger product–sum distance exists, but it is catastrophic. Obviously, the total
diversity (2R) of both the four and eight-state codes is equal to two, but it will increase to four when
the number of states is increased to 16, since R is increased from one to two. After experimentation
with various trellis structures and signal assignments, the 16-state code is also found based on the
design criteria, and is shown in Figure 4.55. The minimum product–sum distance of this code is
equal to:
dmin (R) =

δ2
0δ1
0
 
δ2
0δ1
0

= (2 + 0.586) Es × (2 + 0.586) Es = 6.69E2
s

144
SPACE–TIME CODING
12
13
14
15
16
17
18
SNR (dB)
100
10−1
10 −2
Simulation results
Concatenated scheme
STTC
with STTCs [204],
STBC only
8-state code
16-state code
Frame error rate
12
13
14
15
16
17
18
STTC
with STTC from Section 4.2
Figure 4.56 Quasi-static fading, M = 1.
5
6
7
8
9
10
11
SNR (dB)
100
10−1
10−3
Frame error rate
10−2
STBC only
8-state STTC
8-U TCM + STBC
8-state STTC
8-U TCM + STBC
100
Figure 4.57 Quasi-static fading, M = 2. The dashed dotted line denotes the STBC only,
and the solid lines denote the concatenated scheme.
The constructed 16-state code has an Ungerboeck representation, which means that it can be generated
by a feedback-free convolutional encoder followed by the natural mapping. Performance results for
concatenated code obtained using Rules 1 and 2 (R1 and 2 code) and traditional trellis codes are
compared in Figures 4.56–4.63 with transmission matrix  of the STBC by Alamouti.
More details on the topic can be found in [90–98].

ESTIMATION OF MIMO CHANNEL
145
SNR(dB)
10−1
10−3
Frame error rate
10−2
STBC only
8-state STTC
8-U TCM + STBC
16-state STTC
16-U TCM + STBC
3
4
5
6
7
8
9
100
3
4
Figure 4.58 Quasi-static fading, M = 3. The dashed dotted line denotes the STBC only,
and the solid lines denote the concatenated scheme.
SNR (dB)
STBC only
8-state STTC
8-U TCM + STBC
16-state STTC
16-U TCM + STBC
3
4
5
6
7
10−1
10−3
Frame error rate
10−2
100
SNR (dB)
STBC only
8-state STTC
8-
+ S
16-state STTC
16-U TCM + STBC
16-U TCM + STBC
3
4
5
6
7
0
Figure 4.59 Quasi-static fading, M = 4. The dashed dotted line denotes the STBC only,
and the solid lines denote the concatenated scheme.
4.12
ESTIMATION OF MIMO CHANNEL
Channel estimation using training sequences is required for coherent detection in BLAST. In this
section we present the maximum likelihood channel estimator and the optimal training sequences for
block ﬂat fading channels and analyze the estimation error. The optimal training length and training
interval that maximize the throughput for a given target bit error rate are presented as functions of
the Doppler frequency and the number of antennas.

146
SPACE–TIME CODING
100
SNR (dB)
10−1
10−4
Frame error rate
10−2
10−3
Ungerboeck trellis codes
4-state
8-state
16-state
12
14
16
18
20
22
4-
8-
Figure 4.60 Perfect interleaving, M = 1. Performances without interleaving (dashed lines)
are also shown for comparison.
SNR (dB)
10−1
Frame error rate
10−2
10−3
4-state
8-state
16-state
4
6
8
10
12
100
4-state
8-state
16-state
4-state
8-state
16-state
2
Figure 4.61 Perfect interleaving, M = 2. Performances without interleaving (dashed lines)
are also shown for comparison.
4.12.1
System model
The system consists of M transmitting antennas and N receiving antennas. The vector of signals at
the output of N receive antennas can be represented as:
yi =
. ρ
M Hisi + wi
(4.151)

ESTIMATION OF MIMO CHANNEL
147
SNR (dB)
10 −1
Frame error rate
10−2
10−3
4-state
8-state
16-state
4
5
6
7
8
100
4-state
8-state
16-state
4-state
8-state
16-state
Figure 4.62 Perfect interleaving, M = 3. Performances without interleaving (dashed lines)
are also shown for comparison.
eight-state 8PSK STTC
R1 and R2 eight-state 8PSK scheme
100
10−2
10−1
10 −3
10
12
14
16
18
SNR (dB)
+
+
+
+
+
+
+
*
*
*
*
*
*
*
*
*
with interleaving
without interleaving
Frame error rate
+
+
+
+
+
+
+
*
*
*
*
*
*
*
*
*
with interleaving
without interleaving
Figure 4.63 R1 and 2 eight-state 8PSK scheme versus eight-state 8PSK STTC at a spectral
efﬁciency of 1.5 bit/s/Hz, M = 1.

148
SPACE–TIME CODING
where Hi is the N × M channel matrix, si is the M × 1 transmitted signal vector and wi is the N × 1
vector of complex additive white Gaussian noise with zero mean and unit variance at time instant i.
The average power of the components in Hi and si are normalized to unity, so the average signal to
noise ratio (SNR) at each receiving antenna is ρ, independent of the number of transmitting antennas.
An alternative presentation without normalization gives:
y = Hs + w
(4151.a)
In this case, the signal power is constrained by E(ss∗) ≤P so that P/M is the maximum average power
transmitted by each antenna, where ( )* stands for the Hermitian matrix/vector transpose conjugate.
Starting from the deﬁnition of the mutual information exchanged in the MIMO channel, the capacity
(maximum mutual information) C(H) can be represented as [see Appendix 4.3, Equation A4.3.21]
C(H) = log det

IN + P
M HH∗

(4.151.b)
4.12.2
Training
During the training phase, training sequences of Lt symbols long are transmitted from all the trans-
mitting antennas. An estimate of the channel, ˆH, is obtained at the end. During the payload phase,
data sequences of Ld symbols long are transmitted and jointly detected. We deﬁne Lt as the training
length and L = Ld + Lt as the training interval. The duty cycle factor η = 1 −Lt/L, is the fraction
of time spent in data transmission.
4.12.3
Performance measure
Since the channel is continuously fading, the actual channel will deviate progressively from the
channel estimate obtained at time i = Lt. The BER performance will be dominated by the worst
channel estimation error. Therefore, we consider ˆH −HL, as a measure of the channel estimation
error, where HL is the channel at the end of the training period.
4.12.4
Deﬁnitions
Deﬁne the difference between the channel at time i and at time L as:
	Hi = Hi −HL
(4.152)
then, we can rewrite Equation (4.151) as follows:
yi =
. ρ
M HLsi +
. ρ
M 	Hisi + wi
(4.153)
Let S be the matrix of training symbols, S =
"
s1 s2 · · · sLt
#
, where si for 1 ≤i ≤Lt is the M × 1
training symbol vector at time i. Let the matrix of received signals be Y =
"
y1 y2 · · · yLt
#
, and the
matrix of noise be W =
"
w1 w2 · · · wLt
#
. Then:
Y =
. ρ
M HLS + W × S∗+
. ρ
M [	H1s1 	H2s2 · · · 	HLtsLt]
(4.154)
4.12.5
Channel estimation error
For block fading channels where the channel realization remains constant within a block of certain
length and then changes to an independent realization for the next block, the ML channel estimator

ESTIMATION OF MIMO CHANNEL
149
is:
ˆH =
/
M
ρ Y · S∗· (SS∗)−1
(4.155)
and the optimal training sequences which minimize the mean square estimation error are orthogonal
across all transmitting antennas, i.e.
SS∗= LtIM
(4.156)
where IM is the M × M identity matrix. A necessary condition for the matrix inversion (SS∗)−1 to
exist is Lt ≥M.
Equations (4.155) and (4.156) are suboptimal but practically appealing for continuous fading
channels too. By applying these to Equation (4.154), we obtain:
ˆH = HL + 	Hnoise + 	HDoppler
(4.157)
where
	Hnoise = 1
Lt
/
M
ρ WS∗
(4.158)
is the estimation error due to noise and
	HDoppler = 1
Lt
Lt

i=1
	Hi · (sis∗
i )
(4.159)
is the estimation error due to the temporal variation of the channel.
4.12.6
Error statistic
It is easy to show that 	Hnoise has i.i.d. complex Gaussian entries of zero mean and variance of
M/ (ρLt). We assume the components of Hi are uncorrelated with each other (rich scattering) and
Rayleigh fading with respect to i. Let 	hT
n represent the nth row of 	HDoppler.
E
0
	hT
n1
∗	hT
n2
1
=
δn1n2 · 1
L2
t
Lt

i1=1
Lt

i2=1
si1s∗
i1 · [ξ (i1 −i2) −ξ (i1 −L) −ξ (i2 −L) + 1] si2s∗
i2
(4.160)
where δ jk is the discrete Dirac delta function. ξ (x) = J0 (2π fd maxT · x), where J0 (·) is the zeroth
order Bessel function of the ﬁrst kind, fd max is the maximum Doppler frequency and T is the symbol
period.
For channel estimation tracking, it is reasonable to assume that the phase change during one
training period is small, i.e. 2π fd maxT L≪1. Then Equation (4.160) can be simpliﬁed as:
E

(	hT
n1)∗	hT
n2

= δn1n2 · 2
π fd maxT
Lt
2
·
 Lt

i=1
(L −i) sis∗
i
2
(4.161)
using Jo (x) ≈1 −x2/4 for small x.
4.12.7
Results
The result indicates that the estimation error due to temporal variation increases quadratically with
the Doppler frequency. The error also depends on the training length Lt, the training interval L and
the training sequences si.

150
SPACE–TIME CODING
In the simple case where there is only one transmitting antenna and one receiving antenna, i.e.
M = N = 1, the variance of the estimation error in Equation (4.161) can be computed directly:
σ 2
Doppler = 2
&
π fd maxT

L −Lt + 1
2
'2
(4.162)
We can see that if L is ﬁxed and Lt increases, the error decreases. If Lt is ﬁxed and L increases,
the error increases. If both Lt and L increase at a ﬁxed ratio Lt/L, the error increases. For M, N > 1,
the expression for the mean square estimation error is generally very complicated and it depends
on the exact training sequences. A possible choice of orthogonal training sequences is the FFT
matrix, i.e.
Sm,i = e−j2π(m−1)(i−1)/Lt
(4.163)
where Sm,i is the (m, i)th component of the training matrix S, 1 ≤m ≤M, 1 ≤i ≤Lt. It can be
shown that with such training sequences, the leading component of the variance is the same as
Equation (4.162). Therefore, the earlier observations also apply to multiple antenna systems.
4.12.7.1
Example M, N = 4
In this example, M = 4 transmitting antennas and N = 4 receiving antennas are used. The training
sequences are the fast Fourier transform (FFT) sequences in Equation (4.163). The average receiving
SNR is ρ = 15 dB. The carrier frequency is fc = 2 GHz and the maximum Doppler frequency is
fd max = 10 Hz, which corresponds to a pedestrian speed. The symbol period is T = 41µs, corre-
sponding to the IS-136 standard (see Chapter 1). The channel coefﬁcients are generated using the
Jakes model and continuously fading. Figure 4.64 shows the mean square error (MSE) of the channel
estimation as a function of the training length Lt. Both Lt and the training interval L increase at a
ﬁxed ratio, Lt/L = 20 %. The MSE due to noise decreases with Lt but the MSE due to temporal
variation increases with Lt and L. As a result, the overall MSE ﬁrst decreases and then increases.
Note here that as long as the ﬂat fading model holds, the above results will apply to systems with
different symbol period, T, if we scale the maximum Doppler frequency fd max appropriately. This
is valid because the estimation error due to temporal variation depends only on the product fd maxT .
Additional results are given in Figures 4.65 and 4.66.
More details on the topic can be found in [101–112].
0.04
0.03
0.02
0.01
0
MSE
4
6
8
10
12
14
16
1
0
Training length Lt (symbols)
Total
Due to noise
Due to Doppler
Simulated
Lt / L = 20 %
0.04
0.03
0.02
0.01
0
8
2
o
=
Figure 4.64 Channel estimation MSE versus the training length Lt. Four transmitting anten-
nas and four receiving antennas. Lt/L = 20 %, (ρ = 15 dB, fd max = 10 Hz).

SPACE–TIME CODES FOR FREQUENCY SELECTIVE CHANNELS
151
Doppler frequency (Hz)
0
50
100
150
200
100
90
80
70
60
50
40
30
20
10
0
P 
P 
= 15 dB
= 10 dB
Optimal training interval (symbols)
0
50
100
150
200
100
90
80
70
60
50
40
30
20
10
0
Figure 4.65 Optimal training interval versus Doppler frequency (M, N = 4, BER = 3%).
f d max= 10 HZ
f d max= 100 HZ
Ideal
2
4
6
8
10
12
14
16
Number of antennas
Maximum throughput (bps/Hz)
35
30
25
20
15
10
5
0
f d max= 10 HZ
f d max= 100 HZ
Ideal
2
4
6
8
10
12
14
16
35
30
25
20
15
10
5
0
Figure 4.66 Maximum throughput versus the number of antennas resulting from the optimal
training interval. ‘Ideal’ indicates the throughput with ideal channel estimation.
(ρ = 15 dB, BER = 3 %).
4.13
SPACE–TIME CODES FOR FREQUENCY SELECTIVE CHANNELS
The presentation in this section is based on [113]. If a frequency selective channel is modeled as a
symbol spaced, tap delay line of length L, the sampled version of one frame (K + L −1 time slots)
of the received signal, at antenna r, after matched ﬁltering can be represented as
yr
k =
L−1

l=0
MT

t=1
hr
t (l)ct
k−l + nr
k
k = 1, . . . , K + L −1
(4.164)

152
SPACE–TIME CODING
In Equation (4.164) yr
k is the received signal at antenna r and time slot k, nr
k is a complex white
Gaussian random noise sample at antenna r and time slot k with variance N0 and hr
t (l) is a circularly
symmetric complex Gaussian random variable with zero mean describing the lth tap gain. The
variance of hr
t (l) is denoted as σ 2(l) and hr
t (l) is normalized so that we have:
L−1

l=0
σ 2(l) = 1
(4.165)
No channel knowledge at the transmitter and a coherent receiver with perfect channel state
information are assumed. The vector v = (σ 2(0), σ 2(l), . . . , σ 2(L −1)) will be referred to as the
power delay proﬁle vector and is common for all subchannels. If the antennas are spaced sufﬁciently
far apart, then hr
t (l) and hr′
t′ (l′) are independent if t ̸= t′ or r ̸= r ′, which is referred to as spatial
independence. The case when hr
t (l) and hr′
t′ (l′) are independent for l ̸= l′, is referred to as the
uncorrelated tap case. Channels are said to have uniform power delay proﬁles if all components
in the power delay proﬁle vector are equal. Otherwise we have a non-uniform power delay proﬁle
[111–114]. Equation (4.164) can be represented in vector form as:
yr =
L−1

l=0
hr(l)C(l) + nr
(4.166)
where
yr =

yr
1, . . . , yr
K+L−1

nr =

nr
1, . . . , nr
K+L−1

(4.167)
hr(l) =

hr
1(l), . . . , yr
MT (l)

C(l) =

0MT ×l
C
0MT ×(L−1−l)

with
C =


c1
1
c1
2
· · ·
c1
K
c2
1
c2
2
· · ·
c2
K
...
...
...
...
cMT
1
cMT
2
· · ·
cMT
K


(4.168)
which is the traditional code word matrix from the ﬂat fading channel analysis. In fact, the l = 0 term
in Equation (4.166) is exactly the ﬂat fading signal term when MT transmit antennas are employed.
Due to the similarity of the other terms, the lth term in Equation (4.166) for l > 0 can be thought of
as coming from an lth set of MT virtual transmit antennas.
The tth row of the matrix C(l) represents the modulated output symbols transmitted from the tth
transmit antenna over K + L −1 time periods. Combining these rows together for l = 0, . . . , L −1
in the order of increasing l gives:
Ct =


ct
1
ct
2
· · ·
ct
K
0
0
· · ·
0
0
ct
1
ct
2
· · ·
ct
K
0
· · ·
0
...
...
...
...
...
...
...
...
0
0
· · ·
0
ct
1
ct
2
· · ·
ct
K


(4.169)
Then, Equation (4.166) is also equal to:
yr =
MT

l=1
hr
t Ct + nr
(4.170)

SPACE–TIME CODES FOR FREQUENCY SELECTIVE CHANNELS
153
where hr
t = (hr
t (0), hr
t (1), . . . , hr
t (L −1)) is a subchannel impulse response vector between transmit
antenna t and receive antenna r.
We stack up all the signals received by the MR receive antennas to get:
Y = HCs + N
(4.171)
where
Y =


y1
y2
...
yMR

N =


n1
n2
...
nMR

Cs =


C1
C2
...
CMR


H =


h1
1
h1
2
· · ·
h1
MT
h2
1
h2
2
· · ·
h2
MT
...
...
...
...
hMR
1
hMR
2
· · ·
hMR
MT


Assume that the transmitted code word is Cs and the erroneously decoded code word is Es. Deﬁne
the codeword difference matrix as Bs = Cs −Es. Deﬁne the non-negative deﬁnite Hermitian matrix
As = BsBH
s , where H represents the conjugate transpose. Further, consider the MT LMR × MT LMR
matrix Ds = IMR ⊗As, where IMR, is an MR × MR identity matrix and ⊗is the Kronecker product.
Now vectorize the channel matrix HT, where T represents the transpose operation, to deﬁne the
channel vector h = vec(HT)T. Let K = E(hHh) denote the correlation matrix of h. We only consider
the case where K is full rank. Since K is a positive deﬁnite matrix, Cholesky factorization yields
K = FHF, where F is a lower triangular matrix. Using arguments from Section 4.2, the pairwise error
probability is upper bounded by:
P(Cs →Es) ≤
1
det(I + γ FDsFH)
(4.172)
where γ = Es/4N0, Es is the average energy per symbol at each transmit antenna. At high SNR,
Inequality (4.172) reduces to:
P(Cs →Es) ≤γ −qMR
qMR

i=1
λi

(4.173)
where q is the rank of the matrix As and λi, is the ith non-zero eigenvalue of FDsFH. An equation
similar to Inequality (4.172) can be developed by using Equation (4.166) instead of Equation (4.170).
The maximum rank of matrix As is MT L. Thus, the maximum diversity gain of an STC employed
in an frequency selective channel is MT MRL, L times greater than that of the same STC for ﬂat
fading channels, which is only MT MR.
4.13.1
Diversity gain properties
Similarly to arguments used in Section 4.2, let C and E be two code word matrices from Equation
(4.168). Let C(l ) and E(l) denote the corresponding matrices from Equation (4.167). Let B(l) =
C(l) −E(l), then deﬁne Bds as:
Bds =


B(0)
B(1)
...
B(L −1)


(4.174)

154
SPACE–TIME CODING
which can be easily derived from Bs and vice versa. Let B = C −E be the ﬂat fading code word
difference matrix and assume the rank of the matrix B is rb. The matrix B is similar to an upper
triangular matrix T whose ﬁrstrb diagonal elements are non-zero and other MT −rb diagonal elements
are zero. Likewise, the matrix B(l) is similar to T(l) = 0MT ×l T 0MT ×(L−1−l). Thus, the difference
matrix Bds is similar to the following matrix:
Tds =


T(0)
T(1)
...
T(L −1)


(4.175)
It is apparent that the collection of vectors consisting of all rb rows of the matrix T(0) and the
rbth row of each of the matrices T(l), t = 1, . . . , L −1 will be linearly independent, so Tds has rank
rb + L −1 or larger. Therefore, the minimum rank of difference matrix Bds is rb + L −1.
4.13.2
Coding gain properties
Inequality (4.172) shows that the coding gain depends not only on the matrix As, but on the channel
correlation matrix K as well. With the assumption that the STC provides maximum diversity gain, K
is full rank, and SNR is large, Inequality (4.172) is well approximated by:
P(Cs →Es) ≤
γ −MT MR L
det(K) det(Ds)
(4.176)
Denote K as a partitioned matrix with E(hr1
t1
Hhr2
t2 ) as its (MT × (r1 −1) + t1, MT × (r2 −1) +
t2)th block entry (t1, t2 = 1, . . . , MT for each r1,r2 = 1, . . . , MR), where E(hr1
t1
Hhr2
t2 ) is an L × L
correlation matrix.
Channel 1. In this case the taps are uncorrelated with spatial independence. Based on spatial
independence, E(hr1
t1
Hhr2
t2 ) reduces to the 0 matrix when r1 ̸= r2 or t1 ̸= t2. Furthermore, from the
uncorrelated tap assumption, E(hr
t
Hhr
t ) simpliﬁes to a diagonal matrix with σ 2(0), . . . , σ 2(L −1)
along the diagonal. Then, in this case, the correlation matrix K becomes a diagonal matrix, whose
determinant is:
det(K) =
L−1

l=0
σ 2(l)
MT MR
(4.177)
For a speciﬁc code and Channel 1 we want to know conditions for the best coding gain. Due to
the arithmetic mean and geometric mean inequality and 	L−1
l=0 σ 2(l) = 1, 2L−1
l=0 σ 2(l) will achieve the
maximum L−L if and only if each σ 2(l) is equal to each other, which implies the channel has uniform
power delay proﬁle.
Channel 2. In this case the taps are correlated with spatial independence. Again E(hr1
t1
Hhr2
t2 ) reduces
to a 0 matrix when r1 ̸= r2 or t1 ̸= t2. However, Kr
t = E(hr
t
Hhr
t ) cannot be simpliﬁed to a diagonal
matrix as in the case of Channel 1, but Kr
t still has exactly the same entries along the diagonal as
those in Channel 1. More precisely, K can be described as the matrix formed by arranging a set of
non-diagonal matrices along the partition diagonal of a larger partitioned matrix with the appropriate
zero padding. According to the property of the determinant of a partitioned matrix, we have:
det (K) =
MR

r=1
MT

t=1
det

Kr
t

(4.178)
According to Hadamard’s inequality that the determinant of a non-negative deﬁnite square matrix
is not greater than the product of all its diagonal elements, we have:
det

Kr
t

≤
L−1

l=0
σ 2(l)
(4.179)

SPACE–TIME CODES FOR FREQUENCY SELECTIVE CHANNELS
155
Combining Equation (4.178) and Inequality (4.179), results in:
det (K) ≤
L−1

l=0
σ 2(l)
MT MR
(4.180)
Comparing Equation (4.177) and Inequality (4.180), we can see that with the spatial independence
assumption, the coding gain of a speciﬁc STC for the uncorrelated tap assumption is always larger
than or equal to that under a correlated tap assumption. In other words, the tap correlation will
generally degrade the coding gain.
Channel 3. In this case the STC is applied to a spatially correlated frequency selective fading
channel with correlated taps. Now, in general, none of the submatrices E(hr1
t1
Hhr2
t2 ) can be reduced to
a 0 matrix. In this case we will start from the following result in matrix calculus. Given three matrices
M1(m × m), M2(m × n), M3(n × n), if
M =
(
M1
M2
MH
2
M3
)
is positive deﬁnite, then det(M) ≤det(M1)det(M3). This is known as Fischer’s inequality. The corre-
lation matrix K is a positive deﬁnite Hermitian matrix. So, by successively using Fischer’s inequality,
we ﬁnd:
det (K) ≤
MR

r=1
MT

t=1
det

Kr
t

(4.181)
4.13.3
Space–time trellis code design
A systematic design procedure for space–time trellis codes (STTCs), presented in Section 4.2 for
ﬂat fading channels, will now be modiﬁed to handle frequency selective channels. The relationship
between the symbols transmitted by real antennas and those transmitted by the virtual antennas
is used. Deﬁne an R-bit binary input vector ak = (ak,1, ak,2, . . . , ak,R) and concatenate this with a
(Q −1)R-bit current state vector to get ¯ak = (ak, ak−1, . . . , ak−Q+1). From Section 4.2 an STTC can
be represented by:
¯xk =

x1
k , x2
k , . . . , x MT
k

= ¯akG
(4.182)
where
G =


g11
g12
· · ·
g1,MT
g21
g22
· · ·
g2,MT
· · ·
· · ·
· · ·
· · ·
gQR,1
gQR,2
· · ·
gQR,MT


At each time slot, each component of the length MT output vector from Equation (4.182) is mapped
into a constellation symbol and these symbols are transmitted simultaneously from MT antennas. In
this case the gi j, i = 1, . . . , QR, j = 1, . . . , MT can be taken from an alphabet whose size is equal
to the constellation size s. The trellis encoder starts and ends in state zero at the beginning and end of
each frame.
Consider the case with MT = 2, R = 1, Q = 5, s = 2 (BPSK) and L = 3. This results in a 16-
state 1 b/s/Hz BPSK STTC for a frequency selective channel with three taps. Let L denote the shortest
length error event, as in Section 4.2, for all such codes. First, all codes with maximum diversity gain

156
SPACE–TIME CODING
Table 4.14
16-state BPSK STTCs with maximum η and
different ¯ηCP(L) [113] c⃝2003, IEEE.
No.
GT
η
¯ηCP(L)
G11
&1
1
1
0
1
1
1
0
1
1
'
5.532
9.357
G12
&1
1
0
1
1
1
0
1
1
1
'
5.532
9.357
G13
&1
1
1
1
0
1
1
1
0
1
'
5.532
8.512
G14
&1
1
1
0
1
1
0
0
1
0
'
5.532
7.008
G15
&1
1
1
0
1
0
0
1
0
1
'
5.532
6.465
G16
&0
0
0
1
1
1
0
0
0
1
'
5.532
5.532
100
10−1
10−2
10−3
10−4
FER
1
2
3
4
5
6
7
SNR per receive antenna (dB), Tx=2, Rx=2
Best code G11
Delay div. code G11
Figure 4.67 Performance comparison of best 16-state BPSK STTC and delay diversity code
with two transmit and two receive antennas for a channel with uncorrelated
power delay proﬁle vector (1/3, 1/3, 1/3).
and maximum coding gain of η = 5.532 are found [113]. There are many such codes. Among them,
those with larger ¯ηC P(L) are chosen [113]. In this case, there are only two codes yielding maxi-
mum ¯ηC P(L) = 9.357. They are G11 = (11101, 11011)T and G12 = (11011, 10111)T respectively,1
as listed in Table 4.14. Monte Carlo simulation is used to evaluate the code performance. Figure 4.67
1 (11101, 11011)T denotes
&
1
1
1
0
1
1
1
0
1
1
'T
for simplicity.

OPTIMIZATION OF A MIMO SYSTEM
157
Table 4.15
q-state BPSK STTCs for channels with two taps [113]
c⃝2003, IEEE
q
No.
GT
η
¯ηCP(L)
4
G21
&1
1
1
1
0
1
'
4.000
5.968
8
G22
&1
1
1
1
1
0
0
1
'
5.981
7.825
16
G23
&1
1
0
1
1
1
0
1
0
1
'
7.445
9.973
32
G24
&1
1
1
0
0
1
0
0
1
1
0
1
'
9.514
10.942
S1in
V1 1
V2 1
V3 1
α1
S2in
V1 2
V2 2
V3 2
U*11
U*12
U*11
U*12
S1out
S2out
Figure 4.68 Transmission from three (M) transmit antennas to two (N) receive antennas
[157].
shows the frame error rate (FER) versus signal to noise ratio (SNR = MT Es/N0) per receive antenna.
The frame size is 130 symbol intervals. A simulated channel with spatial independence and uncor-
related taps is assumed. Maximum likelihood decoding is performed at the receiver. An additional
selection of good codes is listed in Table 4.15 [113].
The latest results in the ﬁeld are presented in [115–156].
4.14
OPTIMIZATION OF A MIMO SYSTEM
4.14.1
The channel model
As before, the model consists of M transmit and N receive antenna elements. We assume that M > N.
The antenna weights on the receive side are described as a column vector U with elements U1,U2, . . . ,
and the vector is normalized so the norm is unity (U′U = 1). Similarly, V denotes the transmit weight
vector. For notation, * signiﬁes complex conjugation, and ′ transpose and conjugate. (M, N) refers
to M antennas at the transmitter end and N antennas at the receiver end.
An example of a (3,2) system is shown in Figure 4.68. Similarly to Equation (4.151a) the transfer
matrix from the transmit antennas to the receive antennas is described by transmission matrix H with

158
SPACE–TIME CODING
elements Hik. They are random complex Gaussian quantities. A normalization:
E⟨|Hik|2⟩= 1
(4.183)
is used. It is assumed that the angular spreads seen from both sides are so large that the antenna
signals are spatially uncorrelated.
4.14.2
Gain optimization by singular value decomposition (SVD)
The matrix H will, in general, be rectangular with N rows and M columns. An SVD expansion of H
can be represented as (see Appendix 5.1)
H = Uλ · D · V′
λ
(4.184)
where D is a diagonal matrix of real, non-negative singular values, the square roots of the eigenvalues
of G, where G = H′ · H is an M × M Hermitian matrix. The columns of the unitary matrices Uλ and
Vλ are the corresponding singular vectors. Thus, Equation (4.184) is just a compact way of writing
the set of independent channels [157]:
HV1 =

λ1U1
HV2 =

λ2U2
(4.185)
...
HVN =

λNUN
The SVD is particularly useful for interpretation in the antenna context. For one particular eigen-
value, one can see that Vi is the transmit weight factor for excitation of the singular value √λi.
A receive weight factor of U′i, a conjugate match, gives the receive voltage Sr, and the square of
that the received power, Pr:
Sr = U′iUi
√λi = √λi
Pr = |Sr|2 = λi
(4.186)
This clearly shows that the matrix H of transmission coefﬁcients may be diagonalized, leading to
a number of independent orthogonal modes of excitation, where the power gain of the ith mode or
channel is λi. The weights applied to the arrays are given directly from the columns of the Uλ and
Vλ matrices. Thus, the eigenvalues and their distributions are important properties of the arrays and
the medium, and the maximum gain is of course given by the maximum eigenvalue. The number of
non-zero eigenvalues may be shown to be the minimum value of M and N. The situation is illustrated
in Figure 4.68, where the total power is distributed among the N parallel channels by weight factors
α. These coefﬁcients are discussed later in more detail. An important parameter is the trace of G, i.e.
the sum of the eigenvalues
Trace =

i
λi
(4.187)
which may be shown to have a mean value of MN. We illustrate the above relations by an example
[157].
4.14.2.1
Example: (2, 2) system
For the (M, N) = (2, 2) example, matrix G is given by:
G =
(
|H11|2 + |H12|2
H11H ∗
21 + H12H ∗
22
H ∗
11H21 + H ∗
12H22
|H22|2 + |H21|2
)
=
(
a
c
c∗
b
)
(4.188)

OPTIMIZATION OF A MIMO SYSTEM
159
and the two eigenvalues are (see Appendix 5.1)
λmax = 1
2(a + b +

(a −b)2 + 4|c|2)
(4.189)
and
λmin = 1
2(a + b −

(a −b)2 + 4|c|2)
(4.190)
Note that
Trace =

i
λi = a + b
(4.191)
= |H11|2 + |H12|2 + |H21|2 + |H22|2
so the sum of the eigenvalues displays the full fourth-order diversity.
The distribution of ordered eigenvalues may be found in [9], from which the distributions for λmin
and λmax may be derived:
p(λmin) = 2e−2λ
(4.192)
p(λmax) = e−λ(λ2 −2λ + 2) −2e−2λ
(4.193)
In this particular case, it may be shown that the mean values are:
E⟨λmax⟩= 3.5
E⟨λmin⟩= 0.5
(4.194)
The minimum eigenvalue is Rayleigh distributed with mean power 0.5.
The cumulative probability distribution for λmax is:
Pr(λmax < x) = 1 −e−x(x2 + 2) + e−2x
≈x4/12
x≪1
(4.195)
One can show that for the case of standard diversity (M, N) = (1, 4):
Pr(P < x) = 1 −e−x(1 + x + x2/2 + x3/6)
≈x4/24
x ≪, 1
(4.196)
so the (2, 2) case displays full fourth-order diversity but with twice the cumulative probability for the
same power level.
The cumulative probability distributions are shown in Figure 4.69, where the maximum eigenvalue
(the array gain) follows the fourth-order maximum ratio diversity distribution quite closely.
One should be aware that in order to make full beneﬁt of the maximum eigenvalue, the full
knowledge of the channel at the transmitter is required, otherwise the eigenvectors cannot be found.
4.14.3
The general (M, N) case
For the (4, 4) case in Figure 4.70, the two arrays have 16 different uncorrelated transmission coefﬁ-
cients, so the diversity order is 16. In the asymptotic limit when N is large, it may be shown [158,
159] that the largest eigenvalue is bounded above by:
λmax < (√c + 1)2N;
c = M/N ≥1
(4.197)
whereas the smallest eigenvalue is bounded below by:
λmin > (√c −1)2N
c ≥1
(4.198)
In the previous examples, c = 1, and the upper asymptotic bound for this case is 4N. These bounds
should not be understood as absolute bounds, but rather as limits approached as N tends to inﬁnity
for a ﬁxed c.

160
SPACE–TIME CODING
0
−0.2
−0.4
−0.6
−0.8
−1
−1.2
−1.4
−1.6
−1.8
−2
log Pr(P<x)
λmin
λmin +λmax
λmin
−10              −5                0                5                10
(1.1)
Power dB
Figure 4.69 Cumulative probability distribution of eigenvalues for a (T, R) = (2, 2) array
with four uncorrelated paths. The maximum eigenvalue follows closely the
fourth-order diversity with a shift of 0.75 dB.
0
−0
−0
−0
−0
.2
.4
.6
.8
−1
−1.2
−1.4
−1.6
−1.8
−2
λ4
−10          −5
0
5
10           15
λ3
λ2
λ1
λi
Power dB
log Pr (P<x)
Σ
Figure 4.70 Cumulative probability distribution of eigenvalues (power) for two arrays of
four elements each, including the sum of eigenvalues corresponding to a (1,
16) case.
The mean array gains (mean of the maximum eigenvalues) are shown in Figure 4.71, together
with the upper bound and the gain for the correlated, free space case, N2. For N = 10, the true mean
gain is just 1 dB below the upper bound. For a partly correlated case, we can expect the gain to lie
between the ρ = 0 and the ρ = 1 cases, where ρ is the spatial correlation coefﬁcient between the
elements.

OPTIMIZATION OF A MIMO SYSTEM
161
2
0
20
18
16
14
12
10
8
6
4
1
2
3
4
5
6
7
8
9             10
N
=1
=0
upper bound
N
ρ
ρ
Figure 4.71 The gain relative to one element of (N, N) arrays in a correlated situation
(ρ = 1), and in an uncorrelated case (ρ = 0). The upper bound equals 4N, and
is the asymptotic upper bound for the maximum eigenvalue for N tending to
inﬁnity.
In some situations, it might be advantageous to have more antennas on one side than on the other,
especially for asymmetric situations with heavy downloading of data from a base station. Again, the
asymptotic upper bound for the largest eigenvalue is useful, Inequality (4.197). Introducing M = cN
directly we ﬁnd:
Gupper bound = (
√
M +
√
N)2
(4.199)
which, asymptotically, will approach M for large values of M and ﬁxed N. This clearly illustrates
that the composite gain of the link cannot be factored into one belonging to the transmitter and one
belonging to the receiver.
4.14.4
Gain optimization by iteration for a reciprocal channel
Since the channel is reciprocal, exactly the same weights may be used for transmission as for reception.
Consider now the situation with transmission from M transmit antennas to N receive antennas (or vice
versa). The iteration starts with an arbitrary V1, in the numerical calculations, chosen as a unit vector
with equal elements. At the receive side, the weights are adjusted for maximum gain, and the same
weights are then used for transmit since the channel is reciprocal. This may then be repeated a number
of times. In principle, the process might converge to an eigenvalue different from the maximum one,
but experience shows excellent performance [157].
An example of the convergence in the mean is shown for a (3, 3) case in Figure 4.72. After a
few iterations, the gain has converged to the steady state. This might actually be a computationally
efﬁcient way of ﬁnding the maximum gain solution in practice without going through the trouble of
ﬁnding the eigenvectors. For details regarding eigenvalue decomposition see Appendix 5.1.

162
SPACE–TIME CODING
9
8.5
8
7.5
7
6.5
6
5.5
5
Gain dB
1
1.5
2
2.5
3
3.5
4
Iteration
(N,N)=(3,3)
Figure 4.72 Convergence of gain by iterative transmissions between receiver and transmit-
ter for a (3, 3) case. The gain values are mean values.
4.14.5
Spectral efﬁciency of parallel channels
From Figure 4.70 with four independent channels one can see that there are other options for using
the eigenvalues than using the largest for maximum gain. Another option is to keep them as parallel
channels with independent information, as discussed in the previous sections of this chapter. The
knowledge about the distribution of the eigenvalues and the upper and lower bounds may now be
used for evaluating bounds on the theoretical capacity of the link. Shannon’s capacity measure gives
an upper bound on the realizable information rates through parallel channels, and how the power
should be distributed over the channels to achieve maximum capacity through ‘water ﬁlling’ [160].
From Equation (4.151b), the basic expression for the spectral efﬁciency measured in bits/s/Hz for
one Gaussian channel is given by:
C = log2(1 + P)
bits / s / Hz
(4.200)
where P is the signal to noise ratio, SNR, for one channel.
Assuming all noise powers to be the same, the ‘water ﬁlling’ concept is the solution to the
maximum capacity, where each channel is ﬁlled up to a common level D:
1
λ1
+ P1 = 1
λ2
+ P2 = 1
λ3
+ P3 = · · · = D
(4.201)
Thus, the channel with the highest gain receives the largest share of the power. The constraint on
the powers is that:

i
Pi = P
(4.202)
The weight factors αi in Figure 4.68 equal Pi/P. In the case where level D drops below a certain
1/λi, that power is set to zero. In the limit where the SNR is small (P < 1/λ2 −1/λ1), only one
eigenvalue, the largest, is left, and we are back to the maximum gain solution of the previous section.
For the case of (M, N) = (2, 2) (Figure 4.69) for P < 2 −2/7 = 2.34 dB, only the largest eigenvalue
is active, using the mean values from Equation (4.192). The capacity equals
C =

N′
log2(1 + λi Pi) =

N′
log2(λi D)
(4.203)

MIMO SYSTEMS WITH CONSTELLATION ROTATION
163
where the summation is over all channels with non-zero powers. The water ﬁlling is of course
dependent on the knowledge of the channels on the transmit side. In the case where the channel is
unknown at the transmitter, the only reasonable division of power is a uniform distribution over the
antennas, i.e.
Pi = P
M
(4.204)
M being the number of transmit antennas [100]. It may also be argued that the transmit antenna ‘sees’
M eigenvalues, not taking into account that there are only N non-zero eigenvalues. Thus, power is
lost by allocating power to the zero-valued eigenvalues.
It also follows that when M = N, the difference between the capacity for known and unknown
channels is small for large P.
4.14.6
Capacity of the (M, N) array
It follows from Inequalities (4.197) and (4.198) that the instantaneous eigenvalues are limited by:
(
√
M −
√
N)2 < λi < (
√
M +
√
N)2
(4.205)
So, for M much larger than N, all the eigenvalues tend to cluster around M. Furthermore, each of
them will be non-fading due to the high MNth order diversity. Thus, the uncorrelated asymmetric
channel with many antennas has a very large theoretical capacity of N equal, constant channels with
high gains of M. The above illustrates in a mathematical sense the observation of Winters [161] that
M should be of the order 2N. In the limit of large M and N, with M much larger than N, the capacity
is easily found to be:
C = N log2

1 + P
N M

(4.206)
with the result that the theoretical capacity grows linearly with the number of elements N [160, 161]
for M/N ﬁxed. The result may conveniently be interpreted as N parallel channels, each with 1/N of
the power and each having a gain of M. Note that this capacity is higher than the one used in [160,
161], where the power is divided between the M antennas instead of the N channels, given as:
Cunknown = N log2(1 + P)
(4.207)
The numerical results shown in Figure 4.73 support this approximate analysis for the mean values.
It should be remembered that the potential gains are higher when a certain outage probability is studied
due to the high order diversity effects. This is illustrated in Figure 4.74, which shows the cumulative
probability distribution (on a log scale) of the capacity for the case of four receiving elements, and
four and twelve transmitting elements. The signal to noise ratio is 20 dB for the (1, 1) case, and it
is worth emphasizing that the total power radiated remains constant. The improvement going from
four to twelve transmitting antennas is mainly due to the improved gain of the smallest eigenvalues
as indicated by Inequality (4.205). Using Equation (4.206) in the (12, 4) case gives 32.9 b/s/Hz.
4.15
MIMO SYSTEMS WITH CONSTELLATION ROTATION
4.15.1
System model
In this section we consider a system in which the base station transmitter has L antennas that transmit
simultaneously. Each component of an L-dimensional signal point is transmitted on one antenna, and
the receiver makes a decision based on the entire L-dimensional received vector. The performance of
the system is optimized by rotating the baseline constellations in L dimensions.

164
SPACE–TIME CODING
5
20
25
15
10
SNR=10 dB
b/s/Hz
known, ρ=0
ρ=1
unknown, ρ=0
3
4
5
6
7              8
N
Figure 4.73 Mean capacity for two arrays of each N elements. The capacity grows linearly
with the number of elements and is approximately the same for the known and
the unknown channel. The total transmitted power is constant.
0
−0.5
−1
−1.5
−2
−2.5
log Pr(Capacity<x)
(M,N
)
0
5
10
15
20
25
30
35
x b/s/Hz
)=(1,1
(M,N)=(12,4)
(M,N
)
)=(4,4
Figure 4.74 The cumulative probability distribution of capacity on a log scale for the (M,
N) = (1, 1), (4, 4), and (12, 4) cases. The basic signal to noise ratio is 20 dB.
The total radiated power is the same in all cases.

MIMO SYSTEMS WITH CONSTELLATION ROTATION
165
The received signal with one antenna receiver at the mobile is:
r (t) =
L

i=1
αimisi (t) cos (wct + θi) + n (t),
0 ≤t ≤T
(4.208)
The signal from the transmitter’s ith antenna is a pulse-amplitude-modulated (PAM) signal with
amplitude mi, the pulse shape si (t), the fading amplitude αi and n (t) is a white Gaussian noise
process with power spectral density N0/2. It is assumed that the fading amplitude for a given link is
constant over the signalling interval [0, T ] and that the receiver uses coherent detection.
The signals si (t) , s j (t) , i ̸= j are assumed to be orthogonal, and all of the energy of si (t) , 1 ≤
i ≤L, is contained in [0, T ]. The optimum receiver consists of a bank of L correlators. The output
of the ith correlator is:
yi = 2
3 T
0
r (t)si (t) cos (wct + θi) dt = αimi Es + ηi,
1 ≤i ≤L
(4.209)
The received vector y = (y1, y2, . . . , yL) is fed into a decision device that estimates the transmitted
vector m = (m1, m2, . . . mL). To simplify notations in this section we do not use bold fonts for some
vectors and matrices. It is assumed that the receiver can estimate the fading amplitudes αi, 1 ≤i ≤L.
The receiver ﬁnds the L-dimensional constellation point in C, with coordinates suitably ampliﬁed,
which has the closest Euclidean distance to the received vector y. That is, the receiver picks the symbol
ˆm = ( ˆm1, ˆm2, . . . , ˆmL) ∈C that minimizes 	L
i=1 (yi/Es −αi ˆmi)2. A symbol detection error occurs
when ˆm ̸= m. The fading amplitudes αi are modelled as independent and identically distributed
Rayleigh random variables with the common probability density function.
4.15.2
Performance in a Rayleigh fading channel
Assuming that all points in an L-dimensional constellation C with |C| points, are transmitted with
equal probability, an upper bound on the average probability of symbol detection error can be obtained
from the union bound:
P (error) ≤
1
|C|

m

ˆm
ˆm̸=m
P (m →ˆm)
(4.210)
where P (m →ˆm) is the probability that the received symbol is closer to the L-dimensional symbol
ˆm = ( ˆm1, ˆm2, . . . , ˆmL) than to m = (m1, m2, . . . , mL), given that m was transmitted.
If the receiver estimates the fading amplitudes in Equation (4.209) perfectly, and if a minimum
distance decoding rule is used by the receiver, then the pairwise error probability, conditioned on the
fading amplitude vector (α1, α2, . . . , αL), can be upper bounded using the Chernoff bound as follows:
P (m →ˆm |α1, . . . , αL ) ≤
L

i=1
exp

−α2
i (mi −ˆmi)2 Es/ (8N0)

(4.211)
Assuming that the fading amplitudes are independent, averaging over the probability density function
for α1 gives
P (m →ˆm) ≤
L

i=1
1
1 + (mi −ˆmi)2 Es/ (8N0) ≤
L

i=1
mi ̸= ˆmi
8N0
Es (mi −ˆmi)2
(4.212)
At sufﬁciently high SNR, Equation (4.2.10) is dominated by the largest P (m →ˆm) term, and
assuming mi ̸= ˆmi, 1 ≤i ≤L, then P (error) ∝1/ (Es/N0)L. From Equation (4.212), the following

166
SPACE–TIME CODING
quantity, which we call the constellation gain in Rayleigh fading channel, gives an indication of the
performance of a signal constellation at high SNR:
cgRayleigh(C) = min
m, ˆm∈C
m̸= ˆm
L

i=1
mi ̸= ˆmi
(mi −ˆmi)2
(4.213)
In [162] this parameter is called the constellation ﬁgure of merit. In order not to degrade the per-
formance of the constellation in the AWGN channel, we apply a transformation to the constellation
that preserves the Euclidean distances between points, but improves the constellation’s gain in fad-
ing. If we represent the original constellation as a |C| × L matrix C, where each row of the matrix
corresponds to a point in the L-dimensional constellation, one possible distance-preserving transfor-
mation is to multiply this matrix by an orthogonal L × L matrix A. The optimal matrix A maximizes
cgRayleigh(CA). It is shown in Appendix 4.1 how an L × L orthogonal matrix A can be written as the
product of ( L
2 ) rotation matrices and a reﬂection matrix. Such multiplication of the constellation matrix
C by an arbitrary orthogonal matrix A has the following geometrical interpretation. The constellation
is rotated with respect to the (i, j) plane by an amount θi j, 1 ≤i ≤L −1, i + 1 ≤j ≤Land there
are ( L
2 ) such rotations.
Then the constellation is reﬂected in the ith axis, where the matrix ˆI has an (i, i) entry equal to −1
and the number of such reﬂections is equal to the number of −1 elements on the main diagonal of ˆI.
Writing A = QˆI where Q is the product of ( L
2 ) rotation matrices in Equation (A4.1.1), we see that
cgRayleigh(CA) = cgRayleigh(CQˆI) = cgRayleigh(CQ)
(4.214)
where the second identity in Equation (4.214) follows because the matrix CQˆI is just the matrix CQ
with several of its columns negated, and negating the columns of a constellation matrix does not affect
the cgRayleigh of the constellation. Rather than look for an optimal constellation CA it is sufﬁcient to
look for an optimal constellation CQ.
The method of obtaining an optimal constellation Copt = CQ, one with maximum cgRayleigh(CQ),
given a starting constellation C, is to vary ( L
2 ) rotation angles according to a numerical optimization
or search algorithm. The constellation C is rotated with respect to the (i, j) plane, 1 ≤i ≤L −1, i +
1 ≤j ≤L.
For example, when L = 2 the baseline constellation matrix is
C =


1
1
1
−1
−1
1
−1
−1

.
(4.215)
In this case, maximization of cgRayleigh is done by varying only one rotation angle. The optimal angle
of rotation for this constellation can be found using an exhaustive search to be θopt = 31.7◦, assuming
a discretization interval of 0.1◦The optimally rotated constellation is:
Copt =


−0.325
−1.376
1.376
0.325
−1.376
0.325
−0.325
1.376


(4.216)
These two constellations are shown in Figure 4.75. Each row in the constellation matrix corre-
sponds to a point (m1, m2). With L = 3, the baseline constellation C consists of the vertices of a
three-dimensional cube, and optimization is done over three rotation angles. Using a discretization in-
terval of 1◦our search procedure produced the rotation vector θopt = [θ12, θ13, θ23] = [24◦, 36◦, 66◦].

DIAGONAL ALGEBRAIC SPACE–TIME BLOCK CODES
167
(−1,1)
(1,1)
(1, −1)
(−1, −1)
2m
1m
(a)
(−1.376, .325)
(.325, 1.376)
(1.376, −325) 
(−.325, −1.376)
(b)
Figure 4.75 Examples of constellations for L = 2.
Both the baseline constellation and the rotated constellation are given as:
C =


1
1
1
1
1
−1
1
−1
1
1
−1
−1
−1
1
1
−1
1
−1
−1
−1
1
−1
−1
−1


Copt =


0.177
0.474
−1.656
−0.997
−1.003
−0.998
−0.480
1.654
−0.181
−1.655
0.176
0.476
1.655
−0.176
−0.476
0.480
−1.654
0.181
0.997
1.003
0.998
−0.177
−0.474
1.656


(4.217)
For L ≥4 an exhaustive search over the ( L
2 ) rotation angles in order to maximize cgRayleigh for the
L cube proved to be too time consuming. For these constellations, many rotation vectors could be
picked at random, and a gradient-based approach can be used to vary the rotation angles so as to
converge to a local maximum. For L = 4, there are six degrees of freedom, and the rotation vector
found was θopt = [θ12, θ13, θ14, θ23, θ24, θ34] = [206◦, 15◦, 306◦, 42◦, 213◦, 31◦].
For
L = 5
there
are
ten
degrees
of
freedom,
and
the
rotation
vector
was
found
as θopt = [θ12, θ13, θ14, θ15, θ23, θ24, θ25, θ34, θ35, θ45] = [294◦, 349◦, 18◦, 340◦, 103◦, 184◦, 114◦, 275◦,
212◦, 25◦].
Some results are shown in Figures 4.76 and 4.77.
4.16
DIAGONAL ALGEBRAIC SPACE–TIME BLOCK CODES
In the previous section we established the basic concept of space time system improvements based on
constellation rotation. In this section, we present a new family of linear ST block codes by the use of
rotated constellations and the Hadamard transform that will be referred to as diagonal algebraic ST
(DAST) block codes. These codes have a normalized rate of 1 symbol/s and achieve the full diversity
over n transmit and m receive antennas. They maintain their diversity and coding gains over all real
or complex constellations carved from the ring of complex integers Z[i], with i =
√
−1, such as
pulse–amplitude modulation (PAM) or quadrature–amplitude modulation (QAM). Due to the lattice
structure of these codes, the ML decoding can be implemented by the sphere decoder at moderate
complexity independent of the transmission rate (see Appendix 4.2) or [171, 172]. The DAST block
codes outperform the ST codes from orthogonal design (see Section 4.3) for n > 2.
4.16.1
System model
Based on Equations (4.213) and (4.214), the minimum product distance of the constellation Q will
be deﬁned as
dd,min ≡
min
y=x1−x2
x1̸=x2∈Q
d
j=1
y j

(4.218)

168
SPACE–TIME CODING
10−1
10−2
10−3
0
5
Eb/No [dB]
P(error)
10
15
20
10−4
Figure 4.76 Probability of bit error for several transmission schemes. L = 3: (——) base-
line, (-x-) optimal constellation, (– –) identical transmissions.
10−1
10−2
10−3
0
5
Eb/No [dB]
P(error)
10
15
20
10−4
Figure 4.77 Probability of bit error for several transmission schemes. L = 5: (——) base-
line, (- x -) optimal constellation, (– –) identical transmissions.
Some of the results for quasi-optimal rotations with the good values of the minimum product
distance are reported in [171, 172]. In [171], the construction of rotations Md in dimension d was
done in an iterative manner in a ‘Hadamard’ way as follows:
Md =
&M1
d/2
−M2
d/2
M2
d/2
M1
d/2
'
(4.219)
where M1
d/2 is the optimal real rotation in dimension d/2 and M2
d/2 is an orthogonal transformation in
dimension d/2 depending only on one parameter [171]. Then, one varies this parameter in order to
choose the rotation that maximizes the minimum product distance. This method works very well for

DIAGONAL ALGEBRAIC SPACE–TIME BLOCK CODES
169
the dimensions d = 2, 3, 4 and 6. It becomes less successful for d ≥8, since too many parameters
are excluded in the rotations in high dimensions. Table 4.16 presents the ﬁrst row of the optimal real
rotations found in [171] along with dd,min for d = 2, 4 that is used to construct the DAST block codes
in this section. The rest of the rotation matrix can easily be obtained from Equation (4.219). For the
dimensions d = 2q, q ≥3, the rotations given in [172] are used, which are constructed on the real
part of the cyclotomic number ﬁeld of degree 4d: Q (cos(2π/8d)), which give relatively good values
of the minimum product distance [172]:
dd,min =
√
2/(2d)d/2
(4.220)
Equation (4.221) shows the MATLAB program which generates the rotation matrix Md of any
dimension d = 2qconstructed on the number ﬁelds Q (cos(2π/8d)). This method to generate full
modulation diversity rotations is attractive, especially for large d. Note that the best rotations in [171]
give better dd,min for d = 2, 4 while starting from d = 8, the rotations given in (4.221) are better.
M = sqrt(2/d) ∗cos(pi/4 ∗d) ∗(4 ∗[1 : d]′ −1) ∗(2 ∗[1 : d] −1))
(4.221)
4.16.2
The DAST coding algorithm
If Mn is a rotation of dimensions n × n (with, n = 1, 2 or n is a multiple of 4), which generates a
full modulation diversity lattice, then DAST block code in dimensions n × n is constructed as:
n
	= Hndiag (x1, . . . , xn)
(4.222)
where x = (x1, . . . , xn)T = Mna, and a = (a1, . . . , an)T is the information symbol vector. In the
sequel, we denote the entries of the Hadamard matrix Hn by wi j (Walsh) in order to differentiate
them from the entries of the channel transfer matrix hi j. The Hadamard transform is a real unitary
transformation that exists for 1, 2, and all the dimensions multiple of 4. In dimension n, the Hadamard
transform Hn satisﬁes HnHT
n = nIn, with In the identity matrix in dimension n.
As an example for n = 2 the corresponding DAST block code is:
2
	=
&1
1
1
−1
' & x1
0
0
x2
'
=
&x1
x2
x1
−x2
'
(4.223)
where x = (x1, x2)T = M2a, and M2 is the two-dimensional rotation matrix given in Table 4.16. For
n = 4, the corresponding DAST block code is given by
2
	=


1
1
1
1
1
−1
1
−1
1
1
−1
−1
1
−1
−1
1




x1
0
0
0
0
x2
0
0
0
0
x3
0
0
0
0
x4

=


x1
x2
x3
x4
x1
−x2
x3
−x4
x1
x2
−x3
−x4
x1
−x2
−x3
x4


(4.224)
where x = (x1, x2, x3, x4)T = M4a, and M4 is the four-dimensional rotation matrix given in Table
4.16.
The DAST block code n has a transmit diversity equal to n under quasi-static fading assumption.
When n is a power of 2 and for the rotations given in Section 4.16.1, the coding gain of the DAST
Table 4.16
First row of the optimal real rotation matrices in dimensions 2 and 4
Dimension
Column
dd,min
2
1–2
0.526
0.851
1/
√
5
4
1–4
0.201
0.325
−0.486
−0.786
1/40

170
SPACE–TIME CODING
block code, equals:
δ =
*
22/n
√
5 ,
for n = 2, 4
1
2(n−1)/n ,
for n ≥8.
(4.225)
To prove it, let y = x −e = Mn (a −b) such that a ̸= b. We can write the DAST block code at y as
Equation (4.222), n = Hndiag (y1, . . . , yn). Since Mn generates a full modulation diversity lattice,
one has y j ̸= 0∀j = 1 · · · n taken over all the vectors a ̸= b in the considered constellation. It follows
that the matrix diag (y1, . . . , yn) is full rank, and also n is full rank over all the differences of
codewords. For the coding gain one computes (see Equations 4.25–4.30):
det

n H
n

= det

Hndiag (y1, . . . , yn) diag

y∗
1, . . . , y∗
n

HT
n

= det

nIndiag
|y1|2 , . . . , |yn|2
= nn
n
j=1
y j
2
(4.226)
The coding gain is deﬁned as the minimum of det

n H
n
1/n, computed over all the differences
between distinct codeword pair. By taking the minimum over y of the determinant above and then
taking the nth root, one obtains the coding gain of the DAST block code:
δn = n

dn,min
2/n
(4.227)
From Table 4.16 one has d2,min = 1/
√
5, which gives d2 = 2/
√
5, and d4,min = 1/40, which gives
δ4 =
√
2/
√
5. For n ≥8, and for the rotations given in Section 4.16.1, replacing Equation (4.220) in
Equation (4.227) gives δn = 1/2(n−1)/n. Note that the coding gain given in Equation (4.225) is greater
than 0.5 and it approaches this value when n increases. For example, δ8 = 0.5453 and δ32 = 0.5109.
In Equation (4.227) there is a multiplicative factor in the coding gain expression because in the model
we normalize the radiated power at a given SNR by the number of transmit antennas n by multiplying
the noise variance by n. If the normalization is done at the transmitter side then the coding gain will
be δn =

dn,min
2/n.
4.16.3
The DAST decoding algorithm
During n periods of time, the received signal is given by an m × n matrix:
r = H (Hndiag (x1, . . . , xn)) + v
(4.228)
where the m × n complex matrix v has independent Gaussian distributed random variables of variance
per real dimension as entries. Equivalently, one has:
r = (HHn) diag (x1, . . . , xn) + v
vec

rT 
=


diag (H1Hn)
...
diag (HmHn)

x + vec

vT 
(4.229)
where Hj denotes the jth row of H(the MIMO channel matrix) representing the jth receive antenna,
and vec (r) arranges the matrix r in a one column vector by putting its columns one after the other.
If at each receive antenna 1 ≤j ≤m we write diag

HjHn

= diag

α j1, . . . , α jn

, then the received

DIAGONAL ALGEBRAIC SPACE–TIME BLOCK CODES
171
signal is given by:
r1
	= vec

rT 
=


α11
0
· · ·
0
0
α12
...
...
...
...
...
0
0
· · ·
0
α1n
...
αm1
0
· · ·
0
0
αm2
...
...
...
...
...
0
0
· · ·
0
αmn


Mna + vec

vT  	= AMna + v1.
(4.230)
Since the Hadamard transform is an orthogonal transformation, the variables αi j, i = 1 · · · m, j =
1 · · · n are independent and identically distributed (i.i.d.) complex Gaussian variables with variance
n/2 per real dimension.
From Equation (4.230) it is easier to understand how the DAST block codes exploit the transmit
diversity. Using a DAST block code over n transmit antennas and m receive antennas is equivalent
to sending the word (x1, . . . , xn) over one transmit antenna and m receive antennas during n periods
of time, where the channel changes randomly every time instant (since the fading between each
transmit–receive antenna pair is independent). The latter scheme has a diversity of mn since the
lattice from which we transmit the words has a full modulation diversity [171].
A perfect CSI is assumed to be available at the receiver. First we perform maximum ratio combining
of Equation (4.230). This yields:
r2 = AHr1 = diag


m

j=1
|α j1|2, . . . ,
m

j=1
|α jn|2

Mna + v2
(4.231)
where v2 is a colored Gaussian noise with covariance matrix E[v2 vH
2 ] = 2σ 2 AH A. In order to whiten
the noise, we multiply the received signal in Equation (4.231) by (AH A)−1/2, giving:
r3 = (AH A)−1/2r2 = diag


4
5
5
6
m

j=1
|α j1|2, . . . ,
4
5
5
6
m

j=1
|α jn|2

Mna + v3
(4.232)
with v3 an n × 1 additive white Gaussian noise. Then we apply the sphere decoder [168, 169] on
the real and imaginary parts of Equation (4.232). The sphere decoder takes advantage of the lattice
structure of the received signals and searches the closest lattice points to the received signal, which
are enclosed in a sphere of radius C0 centered at the received signal. Each time a lattice point of a
norm less than C0 is found, we reduce the sphere radius accordingly and restart the search until an
empty sphere is reached. The choice of C0 depends on the considered lattice, which is generated by
diag
.
	m
j=1
α j1

2
, . . . ,
.
	m
j=1
α jn

2
Mn in Equation (4.232), as well as on the additive noise
level. Some results are shown in Figures 4.78–4.81. In Figure 4.78, we compare the Alamouti code
G2with the code 2 for one and two receive antennas with the 4-QAM modulation. At the same
spectral efﬁciency of 2 b/s/Hz, the Alamouti scheme shows almost 1 dB of gain over the code 2.
For n = 2 transmit antennas it seems difﬁcult to outperform the Alamouti scheme since it is the
unique complex orthogonal design transmitting at a normalized rate of 1 symbol/s. However, when n
increases (Figures 4.79–4.81), the DAST block codes give better performances.

10−1
10−2
10−3
2 bits/sec/HZ
5
SNR [dB]
Symbol error probability
10
15
25
20
30
Figure 4.78 Average BER as a function of SNR, two transmit, one and two receive antennas.
10−2
10−3
10−4
n=4, m=1
60
SNR [dB]
Average bit error probability
10
20
40
30
50
Figure 4.79 Average BER as a function of SNR, four transmit and one receive antennas.
10−2
10−3
10−4
n=4, m=2
SNR [dB]
Average bit error probability
10
20
40
30
50
Figure 4.80 Average BER as a function of SNR, four transmit and two receive antennas.

Appendix 4.1 QR Factorization
173
10−2
10−3
10−4
10−5
n=4, m=4
SNR [dB]
Average bit error probability
5
10
40
30
45
0
20
25
15
35
Figure 4.81 Average BER as a function of SNR, four transmit and four receive antennas.
APPENDIX 4.1 QR FACTORIZATION
Orthogonal matrix triangularization (QR decomposition) reduces a real (m, n) matrix A with m ≥n
and full rank to a much simpler form. A suitably chosen orthogonal matrix Q with triangularize the
given matrix.
A = Q
& R
0
'
with the (n, n) upper triangular matrix R. One only has then to solve the triangular system Rx = Pb,
where P consists of the ﬁrst n rows of Q. The least squares problem Ax ≈b is easy to solve
with A = QR and QT Q = I. The solution x = (AT A)−1AT b becomes x = (RT QT QR)−1RT QT b =
(RT R)−1RT QYb = R−1QT b.
This is a matrix-vector multiplication QT b, followed by the solution of the triangular system
Rx = QT b by back-substitution.
Many different methods exist for the QR decomposition, e.g. the Householder transformation,
the Givens rotation, or the Fram–Schmidt decomposition.
Householder transformation
The most frequently applied algorithm for QR decomposition uses the Householder transformation
u = Hv, where the Householder matrix H is a symmetric and orthogonal matrix of the form. H =
I −2xxT , with the identity matrix I and any normalized vector x with ||x||2
2 = xT x = 1. Householder
transformations zero the m −1 elements of a column vector v below the ﬁrst element.


v1
v2
...
vn

→


c
0
...
0


with
c = ±
 m

i=1
v2
i
1/2

174
SPACE–TIME CODING
One can verify that:
x = f


v1 −c
v2
...
vm


with
f =
1
√2c(c −v1)
fulﬁls xT x = 1 and that with H = I −2xx2 one obtains the vector [c, 0 · · · 0]T . To perform the
decomposition of the (m, n) matrix A = QR (with m ≥n) we construct in this way an(m, m) matrix
H(1) to zero the m −1 elements of the ﬁrst column. An (m −1, m −1) matrix G(2) will zero the
m −2 elements of the second column. With G(2) we produce the (m, m) matrix:
H(2) =


1
0
· · ·
0
0
...
G(2)
0

, etc
After n (n −1 for m = n) such orthogonal transforms H(i) we obtain:
R = H(n) . . . H(2)H(l)A.
R is upper triangular all the orthogonal matrix Q becomes:
Q = H(1)H(2) . . . H(n).
In practise the H(i) are never explicitly computed.
Givens transformations
Given an n × mmatrix A with n ≥m there is an n × m matrix Q with orthonormal columns and an
upper triangular m × m matrix R such that A = QR. If m = n Q is orthogonal (e.g., see [164, p.
112]).
The method based on Givens transformations is of particular interest to us (e.g., see [165, p. 214]).
If A is an n × n matrix, then A = QR ⇒QT A = R.
The QR factorization method based on Givens transformations gives us a method for writing QT
as the product of ( n
2) = n(n −1)/2 Givens matrices:
G(i, k, θ) =


1
. . .
c
· · ·
s
...
...
−s
. . .
c
. . .
1


is an n × n matrix called the Givens (or Jacobi) matrix, with c = cos θ, s = sin θ It consists of 1’s
on the main diagonal, except for the two elements c in rows (and columns) i and k. All off-diagonal
elements are zero, except the two elements s and −s in rows (and columns) i and k. Postmultiplication
of a vector by G rotates the vector counterclockwise by θdegrees with respect to the (i, k) plane.
Proposition 1: If an n × n matrix A is orthogonal, then a QR factorization algorithm yields Q = AˆI
where ˆI denotes a matrix in which each main diagonal element is either 1 or and all off-diagonal
elements are zero.

Appendix 4.1 QR Factorization
175
Proof: QT is orthogonal because Q is orthogonal. If A is orthogonal, then QT A = R is also
orthogonal since the product of two orthogonal matrices is an orthogonal matrix. Since R is an upper
triangular orthogonal matrix, each main diagonal element must be either 1 or −1 and all off-diagonal
elements must be zero. We have A = QˆI ⇒Q = AˆI
−1 = AˆI.
Proposition 2: Any orthogonal n × n matrix A can be written as the product of n(n −1)/2 n × n-
Givens matrices and an n × n ˆI-matrix.
Proof: The proof follows directly from the proof of the previous proposition. Given an arbitrary
orthogonal n × n matrix A we have a method for constructing Q, the product of n(n −1)/2 Givens
matrices, such that A = QˆI. Note that the identity matrix is a Givens matrix as well as an ˆI matrix.
For example, 2 × 2 all orthogonal matrices have the form:
A =
& cos θ
sin θ
−sin θ
cos θ
'
or
A =
&cos θ
sin θ
sin θ
−cos θ
'
This is a well-known fact (for example, see [166, p. 282]). The ﬁrst form corresponds to G(1, 2, θ)I2×2
and the second form corresponds to G(1, 2, θ)(−I2×2). Proposition 2, together with the QR factor-
ization method using Givens transformations, implies that all 3 × 3 orthogonal matrices have the
form:
A = G(1, 2, θ12)G(1, 3, θ13)G(2, 3, θ23)ˆI3×3 =
=


cos θ12
sin θ12 0
−sin θ12 cos θ12 0
0
0
1

·


cos θ13
0
sin θ13
0
1
0
−sin θ13
0
cos θ13


·


1
0
0
0
cos θ23
sin θ23
0
−sin θ23
cos θ23

·


±1
0
0
0
±1
0
0
0±
1


In general, any L × L orthogonal matrix A can be factored into L(L −1)/2 = ( L
2 ) rotation matrices
and an ˆI matrix as follows:
A =



1≤i≤L−1
1+1≤j≤L
G(i, j, θi, j

· ˆIL×L
(A4.1.1)
for suitable θi j.
APPENDIX 4.2 LATTICE CODE DECODER FOR SPACE–TIME CODES
Consider the system of M transmit and N receive antennas, the single data stream in the input is
demultiplexed into Msubstreams, and each substream is modulated independently then transmitted
by its dedicated antenna. It is assumed that the same constellation is used for all the substreams.
The transmission is done by burst of length l over a quasi-static Rayleigh fading channel changing
randomly every l symbol durations. The power launched by each transmitter is proportional to 1/Mso
that the total radiated power is constant and independent of M. The proximity of antennas presupposes
the synchronization of the system.
Notation Z is the ring of integers. R is the ﬁeld of real numbers. Z(i) is the set of numbers a + ib
with a, b ∈Z, and i =
√
−1.

176
SPACE–TIME CODING
The received signal at each instant time is given by
r = HaT + v
(A4.2.1)
where a = (a1, a2, . . . , aM) is the transmitted vector which belongs to the constellation QAM carved
from Z(i), and v is a N × 1 complex vector AWGN component-wise independent with a variance σ 2
per dimension. Moreover, H is an N × M transfer matrix of the channel with entries hkj, where hkj
is the fading between transmitter j and receiver k. In the sequel we set M = N. One can write the
system (A4.2. 1) as
r′ 	=
"
ℜ(rT )ℑ(rT )
#
= u
ℜ(HT )
ℑ(HT )
−ℑ(HT ) ℜ(HT )

+ v′ = uMH + v′
(A4.2.2)
where u = [ℜ(a) ℑ(a)] ∈Z2M, and v′ =
"
ℜ(vT ) ℑ(vT )
#
∈R2M.
ℜ(a), ℑ(a) denote the real and imaginary part of a, respectively. Note that the rank of MH is 2M
almost always, and its Gram matrix GM = MHM†
H is positive deﬁnite. Hence, we can represent the
multi-antenna environment by a lattice sphere packing [173, 174], and one can apply the universal
lattice decoder in a multi-antenna system. The principle of the algorithm is to search the closest lattice
point to the received signal within a sphere of radius
√
C cantered at the received signal (see [174]
and references therein). The choice of C is very crucial to the speed of the algorithm. In practice,
C can be adjusted according to the noise (and eventually the fading) variance. When a failure is
detected, one can either declare an erasure on the detected symbol, or increase C. The complexity of
the algorithm is independent of the lattice constellation size, which is very useful for high data rate
transmission. In [175], Fincke and Phost showed that if d−1 is a lower bound for the eigenvalues of
the Gram matrix GM, then the number of arithmetical operations is
O

n2 ×

1 + η −1
4dC
4dC
(A4.2.3)
which, for a judicious choice of the radius C = d−1, is approximated by O(n6) arithmetical operations,
where n is the lattice dimension.
APPENDIX 4.3 MIMO CHANNEL CAPACITY
The transmitted signals in each symbol period are represented by an nT × 1 column matrix x, where
the ith component xi, refers to the transmitted signal from antenna i. We consider a Gaussian chan-
nel, for which, according to information theory, the optimum distribution of transmitted signals is
also Gaussian. Thus, the elements of x are considered to be zero mean independent identically
distributed (i.i.d.) Gaussian variables. The covariance matrix of the transmitted signal is given by
Rxx = E{xxH}where E {·} stands for expectation and AH denotes the Hermitian of matrix A (trans-
pose and component-wise complex conjugate). The total transmitted power is constrained to P,
regardless of the number of transmit antennas nT . It can be represented as P = tr (Rxx), where tr (A)
denotes the trace of matrix A (sum of the diagonal elements of A). If the channel is unknown at
the transmitter, we assume that the signals transmitted from individual antenna elements have equal
powers of P/nT . The covariance matrix of the transmitted signal is given by
Rxx = P
nT
InT
(A4.3.1)
where InT is the nT × nT identity matrix. The transmitted signal bandwidth is narrow enough, so
its frequency response can be considered as ﬂat. In other words, we assume that the channel is
memoryless. The channel is described by an nR × nT complex matrix, denoted by H. The i jth
component of the matrix H, denoted by hi j, represents the channel fading coefﬁcient from the jth
transmit to the ith receive antenna. For normalization purposes we assume that the received power

Appendix 4.3 MIMO channel capacity
177
for each of nR receive branches is equal to the total transmitted power. Physically, it means that
we ignore signal attenuations and ampliﬁcations in the propagation process, including shadowing,
antenna gains, etc. Thus we obtain the normalization constraint for the elements of H, on a channel
with ﬁxed coefﬁcients, as:
nT

j=1
hi j
2 = nT ,
i = 1, 2, . . . , nR
(A4.3.2)
The noise at the receiver is described by an nR × 1 column matrix, denoted by n. Its components are
statistically independent complex zero-mean Gaussian variables, with independent and equal variance
real and imaginary parts. The covariance matrix of the receiver noise is given by Rnn = E{nnH}. If
there is no correlation between components of n, the covariance matrix is obtained as Rnn = σ 2InR.
Each of nR receive branches has identical noise power of σ 2.
The receiver is based on a maximum likelihood principle operating jointly over nR receive
antennas. The received signals are represented by an nR × 1 column matrix, denoted by r, where
each complex component refers to a receive antenna. We denote the average power at the output
of each receive antenna by Pr. The average signal-to-noise ratio (SNR) at each receive antenna is
deﬁned as:
γ = Pr
σ 2
(A4.3.3)
As it was assumed that the total received power per antenna is equal to the total transmitted power,
the SNR is equal to the ratio of the total transmitted power and the noise power per receive antenna
and it is independent of nT and can be written as:
γ = P
σ 2
(A4.3.4)
By using the linear model the received vector can be represented as r = Hx + n. The received signal
covariance matrix, E{rrH}, is given by Rrr = HRxxHHwhile the total received signal power can be
expressed as tr (Rrr).
MIMO system capacity: The system capacity is deﬁned as the maximum possible trans-
mission rate such that the probability of error is arbitrarily small. Initially, we assume that
the channel matrix is not known at the transmitter, while it is perfectly known at the
receiver.
By the singular value decomposition (SVD) theorem [Appendix 5.1] any nR × nT matrix H can
be written as H = UDVH, where D is an nR × nT non-negative and diagonal matrix, U and V are
nR × nR and nT × nT unitary matrices, respectively. That is, UUH = InR and VVH = InT , where InR
and InT are nR × nR and nT × nT identity matrices, respectively. The diagonal entries of D are the
non-negative square roots of the eigenvalues of matrix HHH. The eigenvalues of HHH, denoted by
λ, are deﬁned here as:
HHHy = λy,
y ̸= 0
(A4.3.5)
where y is an nR × 1 vector associated with λ, called an eigenvector.
The nonnegative square roots of the eigenvalues are also referred to as the singular values of H.
Furthermore, the columns of U are the eigenvectors of HHH and the columns of V are the eigenvectors
of HHH. We can write for the received vector r:
r = UDVHx + n
(A4.3.6)
In the sequel we will need the following transformations:
r′ = UHr
x′ = VHx
(A4.3.7)
n′ = UHn

178
SPACE–TIME CODING
as U and V are invertible. Clearly, multiplication of vectors r, x and n by the corresponding matrices
as deﬁned in (A4.3.6) has only a scaling effect. Vector n′ is a zero mean Gaussian random variable
with i.i.d real and imaginary parts. Thus, the original channel is equivalent to the channel represented
as:
r′ = Dx′ + n′
(A4.3.8)
The number of nonzero eigenvalues of matrix HHH is equal to the rank of matrix H, denoted by r.
For the nR × nT matrix H, the rank is at most m = min (nR, nT ), which means that at most m of
its singular values are nonzero. Let us denote the singular values of H by √λi, i = 1, 2, . . . ,r. By
substituting the entries √λi in (A4.3.7), we get for the received signal components:
r ′
i =

λix′
i + n′
i,
i = 1, 2, . . . ,r
r ′
i = n′
i,
i = r + 1,r + 2, . . . , nR
(A4.3.9)
As (A4.3.8) indicates, received components, r ′
i, i = r + 1,r + 2, . . . , nR, do not depend on the
transmitted signal, i.e. the channel gain is zero. On the other hand, received components r ′
i, for
i = 1, 2, . . . ,r depend only on the transmitted component x′
i. Thus the equivalent MIMO channel
from (A4.3.7) can be considered as consisting of r uncoupled parallel subchannels. Each sub-channel
is assigned to a singular value of matrix H, which corresponds to the amplitude channel gain. The
channel power gain is thus equal to the eigenvalue of matrix HHH. For example, if nT > nR, as the
rank of H cannot be higher than nR.
Equation (A4.3.8) shows that there will be at most nR nonzero gain subchannels in the equivalent
MIMO channel, as indicated in Section 4.14. On the other hand if nR > nT , there will be at most
nT nonzero gain subchannels in the equivalent MIMO channel. The eigenvalue spectrum is a MIMO
channel representation, which is suitable for evaluation of the best transmission paths.
The covariance matrices and their traces for signals r′, x′ and n′ can be derived from (A4.3.6) as:
Rr′r′ = UHRrrU
tr (Rr′r′) = tr (Rrr)
Rx′x′ = VHRxxV
tr (Rx′x′) = tr (Rxx)
Rn′n′ = UHRnnU
tr (Rn′n′) = tr (Rnn)
The above relationships show that the covariance matrices of r′, x′ and n′, have the same sum of
the diagonal elements, and thus the same powers, as for the original signals, r, x and n, respectively.
Note that in the equivalent MIMO channel model described by (A4.3.8), the subchannels are
uncoupled and thus their capacities add up. Assuming that the transmit power from each antenna in
the equivalent MIMO channel model is P/nT , we can estimate the overall channel capacity, denoted
by C, by using the Shannon capacity formula as in (4.203):
C = W
r
i=1
log2

1 + Pri
σ 2

(A4.3.10)
where W is the bandwidth of each sub-channel and Pri is the received signal power in the ith
subchannel given by
Pri = λi P
nT
(A4.3.11)
In (A4.3.11)√λi is the singular value of channel matrix H. Thus the channel capacity can be
written as
C = W
r
i=1
log2

1 + λi P
nT σ 2

= W log2
r
i=1

1 + λi P
nT σ 2

(A4.3.12)
Now we will show how the channel capacity is related to the channel matrix H. Assuming
that m = min (nR, nT ), Equation (A4.3.5), deﬁning the eigenvalue-eigenvector relationship, can be
rewritten as:
(λIm −Q) y = 0,
y ̸= 0
(A4.3.13)

Appendix 4.3 MIMO channel capacity
179
where Q is the Wishart matrix deﬁned as
Q =
7 HHH,
nR < nT
HHH,
nR < nT
(A4.3.14)
That is, λ is an eigenvalue of Q, if and only if λIm −Q is a singular matrix. Thus the determinant
of λIm −Q must be zero
det (λIm −Q) = 0
(A4.3.15)
The singular values λ of the channel matrix can be calculated by ﬁnding the roots of Equation
(A4.3.15). We consider the characteristic polynomial p (λ) from the left-hand side in Equation
(A4.3.15):
p (λ) = det (λIm −Q)
(A4.3.16)
It has degree equal to m, as each row of λIm −Q contributes one and only one power of λ in the
Laplace expansion of det (λIm −Q) by minors. As a polynomial of degree m with complex coefﬁcients
has exactly m zeros, by counting multiplicities, we can write for the characteristic polynomial:
p (λ) =
m
i=1 (λ −λi)
(A4.3.17)
where λi are the roots of the characteristic polynomial p (λ), equal to the channel matrix singular
values and we can write Equation (A4.3.15) as
m
i=1 (λ −λi) = 0
(A4.3.18)
Further we can equate the left-hand sides of (A4.3.15) and (A4.3.18):
m
i=1 (λ −λi) = det (λIm −Q)
(A4.3.19)
Substituting −nT σ 2
P
for λ in (1.28) we get:
m
i=1

1 + λi P
nT σ 2

= det

Im +
P
nT σ 2 Q

(A4.3.20)
and Equation (A4.3.12) can be written as:
C = W log2 det

Im +
P
nT σ 2 Q

(A4.3.21)
As the nonzero eigenvalues of HHH and HHH are the same, the capacities of the channels with
matrices H and HH are the same. Note that if the channel coefﬁcients are random variables, formulas
(A4.3.12) and (A4.3.21), represent instantaneous capacities or mutual information. The mean channel
capacity can be obtained by averaging over all realizations of the channel coefﬁcients as it was used
in Chapter 14 (see Equation (14.54)).
Water-ﬁlling principle: Let us consider a MIMO channel where the channel parameters are known
at the transmitter. The allocation of power to various transmitter antennas can be obtained by a
‘water-ﬁlling’ principle used in Equation (4.201). The ‘water-ﬁlling principle’ can be derived by
maximizing the MIMO channel capacity under the power constraint:
nT

i=1
Pi = P
i = 1, 2, . . . , nT
(A4.3.22)
where Pi is the power allocated to antenna i and P is the total power, which is kept constant. The
normalized capacity of the MIMO channel is determined as:
C/W =
nT

i=1
log2
&
1 + Piλi
σ 2
'
(A4.3.23)

180
SPACE–TIME CODING
Following the method of Lagrange multipliers, we introduce the function:
Z =
nT

i=1
log2
&
1 + Piλi
σ 2
'
+ L

P −
nT

i=1
Pi

(A4.3.24)
where L is the Lagrange multiplier, λi is the ith channel matrix singular value and σ 2 is the noise
variance. The unknown transmit powers Pi are determined by setting the partial derivatives of Z to
zero:
δZ
δPi
= 0
δZ
δPi
=
1
ln 2
λi/σ 2
1 + Piλi/σ 2 −L = 0
(A4.3.25)
which gives for Pi
Pi = µ −σ 2
λi
(A4.3.26)
where µ is a constant, given by 1/L ln 2. It can be determined from the power constraint of Equation
(A4.3.22).
MIMO channel capacity for adaptive transmit power allocation: When the channel parameters are
known at the transmitter, the capacity given by Equation (A4.3.21) can be increased by assigning the
transmitted power to various antennas according to the ‘water-ﬁlling’ rule. It allocates more power
when the channel is in good condition and less when the channel state gets worse. The power allocated
to channel i is given by:
Pi =

µ −σ 2
λi
+
,
i = 1, 2, . . . ,r
(A4.3.27)
where a+ denotes max (a, 0) and µ is determined so that 	r
i=1 Pi = P.
We consider the singular value decomposition of channel matrix H, then, the received power at
subchannel i in the equivalent MIMO channel model is given by:
Pri =

λiµ −σ 2+
(A4.3.28)
The MIMO channel capacity is then:
C = W
r
i=1
log2

1 + Pri
σ 2

(A4.3.29)
Substituting the received signal power from Equation (A4.3.28) into Equation (A4.3.29) we get:
C = W
r
i=1
log2
&
1 + 1
σ 2

λiµ −σ 2+'
(A4.3.30)
The covariance matrix of the transmitted signal is given by:
Rxx = V diag

P1, P2, . . . , PnT

V H
(A4.3.31)
REFERENCES
1. Alamouti, S. (1998) A simple transmit diversity technique for wireless communications, IEEE
Journal on Selected Areas in Communications, 18(7), 1451–1458.
2. Tarokh, V., Seshadri, N. and Calderbank, A. R. (1998) Space–time codes for high data rate
wireless communications: Performance criterion and code construction, IEEE Transactions On
Information Theory, 44, 744–765.

REFERENCES
181
3. Furuskar, A., Mazur, S., Muller, F. and Olofsson, H. (1999) EDGE: Enhanced data rates for
GSM and TDMA/136 evolution, IEEE Personal Communications Magazine, 6, 56–66.
4. Naguib, A., Seshadri, N. and Calderbank, A. R. (2000) Increasing data rate over wireless
channels, IEEE Signal Processing Magazine, 17, 76–92.
5. Tarokh, V., Jafarkhani, H. and Calderbank, A. R. (1999) Space–time block codes from orthogonal
designs, IEEE Transactions On Information Theory, 45, 1456–1467.
6. Stoica, P. and Lindskog, E. (2001) Space–time block coding for channels with intersymbol inter-
ference, presented at the thirty-ﬁfth Asilomar Conference on Signals, Systems and Computing,
October 2001.
7. Tarokh, V., Naguib, A., Seshadri, N. and Calderbank, A. R. (1999) Space–time codes for high
data rate wireless communication: Performance criteria in the presence of channel estimation
errors, mobility and multiple paths, IEEE Transactions On Communications, 48, 199–207.
8. Naguib, A., Tarokh, V., Seshadri, N. and Calderbank, A. R. (1998) A space–time coding modem
for high-data-rate wireless communications, IEEE Journal on Selected Areas in Communica-
tions, 16, 1459–1477.
9. Seshadri, N. and Winters, J. (1993) Two signaling schemes for improving the error performance
of frequency-division-duplex (FDD) transmission systems using transmitter antenna diversity,
in Proceedings of Vehicular Technology Conference, pp. 508–511.
10. Foschini, G. J. (1996) Layered Space–time architecture for wireless communication in a fading
environment when using multi-element antennas, Bell Labs Technical Journal, 1, 41–59.
11. Tarokh, V., Jafarkhani, H. and Calderbank, A. R. (1999) Space–time block coding for wireless
communications: Performance results, IEEE Journal on Selected Areas in Communications, 17,
451–460.
12. Franz, V. and Anderson, J. (1998) Concatenated decoding with a reduced-search BCJR algo-
rithm, IEEE Journal on Selected Areas in Communication, 16, 186–195.
13. Bahl, L., Cocke J., Jelinek F. and Raviv, J. (1974) Optimal decoding of linear codes for mini-
mizing symbol error rate, IEEE Transaction on Information Theory, IT-20, 284–287.
14. Fragouli, C., Al-Dhahir, N., Diggavi, S. and Turin, W. (2002) Preﬁltered space–time M-BCJR
equalizer for frequency-selective channels, IEEE Transactions On Communications, 50, 742–
753.
15. Van Etten, W. (1976) Maximum likelihood receiver for multiple channel transmission systems,
IEEE Transactions On Communications, COM-24, 276–283.
16. Naguib, A. and Seshadri, N. (2000) MLSE and equalization of space–time coded signals, in
Proceedings of Vehicular Technology Conference, May 2000, 1688–1693.
17. Al-Dhahir, N. (2001) FIR channel-shortening equalizers for MIMO ISI channels, IEEE Trans-
actions On Communications, 50, 213–218.
18. Bauch, G. and Al-Dhahir, N. (2000) Iterative equalization and decoding with channel shortening
ﬁlters for space–time coded modulation, in Proceedings of Vehicular Techology Conference,
2000, pp. 1575–1582.
19. Al-Dhahir, N., Naguib, A. and Calderbank, A. R. (2001) Finite-length MIMO decision-feedback
equalization for space–time block-coded signals over multipath fading channels, IEEE Trans-
actions on Vehicular Technology, 50, 1176–1181.
20. Eyuboglu, M. and Qureshi, S. (1999) Reduced-state sequence estimation for coded modulation
of inter-symbol interference channels, IEEE Journal on Selected Areas in Communications, 17,
989–999.

182
SPACE–TIME CODING
21. Weinstein, S. and Ebert, P. (1971) Data transmission by frequency-division multiplexing using
the discrete Fourier transform, IEEE Transactions On Communications, COM-19, 628–634.
22. Zhou, S. and Giannakis, G. (2001) Space–time coded transmissions with maximum diversity
gains over frequency-selective multipath fading channels, in Proceedings of Globecom, Novem-
ber 2001, pp. 440–444.
23. Sari, H., Karam G. and Jeanclaude, I. (1995) Transmission techniques for digital terrestrial TV
broadcasting, IEEE Communications Magazine, 33, 100–109.
24. Clark, M. V. (1998) Adaptive frequency-domain equalization and diversity combining for broad-
band wireless communications, IEEE Journal on Selected Areas in Communications, 16, 1385–
1395.
25. Al-Dhahir, N. (2001) Single-carrier frequency-domain equalization for space–time block-coded
transmissions over frequency-selective fading channels, IEEE Communications Letters, 5, 304–
306.
26. Kaleh, G. (1995) Channel equalization for block transmission systems, IEEE Journal on Selected
Areas in Communications, 13, 110–121.
27. SC FDE PHY Layer System Proposal for Sub 11 GHz BWA [Online]. Available:
http://www.ieee802.org/16/tg3/contrib/802 163p–0131r2.pdf
28. Diggavi, S., Al-Dhahir, N., Stamoulis A. and Calderbank, A. R. (2002) Differential space–time
transmission for frequency-selective channels, IEEE Communication Letters, 6(6), 253–255.
29. Fragouli, C., Al-Dhahir, N. and Turin, W. (2002) Reduced-complexity training schemes for
multiple-antenna broadband transmissions, in Proceedings of WCNC, 1, 78–83.
30. Fragouli, C., Al-Dhahir, N. and Turin, W. (2002) Finite-alphabet constant-amplitude training
sequences for multiple-antenna broadband transmissions, International Control Conference, 1,
6–10.
31. Baro, S., Bauchs, G. and Hansmann, A. (2000) Improved codes for space–time trellis coded
modulation, IEEE Communications Letters, 4, 20–22.
32. Hammons, R. and Gammal, H. E. (2000) On the theory of space–time codes for PSK modulation,
IEEE Transactions On Information Theory, 46, 524–542.
33. Grimm, J., Fitz, M. P. and Krogmeier, J. V. (1998) Further results in space–time coding for
Rayleigh fading in Proceedings of 1998 Allerton Conference, 1998, pp. 391–400.
34. Grimm, J. (1998) Transmitter diversity code design for achieving full diversity on Rayleigh
channels, Ph.D. dissertation, Purdue University, West Lafayette, IN.
35. Blum, R. S. (2002) Some analytical tools for designing space–time convolutional codes, IEEE
Transactions On Communications, 50, 1593–1599.
36. Guey, J.-C., Fitz, M. P., Bell, M. R. and Kuo, W.-Y. (1999) Signal design for transmitter
diversity wireless communication systems over Rayleigh fading channels, IEEE Transactions
On Communications, 47, 527–537.
37. Seshadri, N. and Winters, J. H. (1994) Two signaling schemes for improving the error per-
formance of frequency division duplex (FDD) transmission system using antenna diversity,
International Journal of Wireless Infomation Networks, 1, 49–60.
38. Raleigh, G. and Ciofﬁ, J. M. (1998) Spatio-temporal coding for wireless communication, IEEE
Transactions On Communications, 46, 357–366.
39. Jafarkhani, H. and Seshadri, N. (2003) Super-orthogonal space–time trellis codes, IEEE Trans-
actions On Information Theory, 49(4), 937–950.

REFERENCES
183
40. Genyuan Wang and Xiang-Gen Xia (2002) An orthogonal Space–time coding for CPM systems,
Proceedings of 2002 IEEE International Symposium on Information Theory, pp. 107–112.
41. Agrawal, A., Ginis, G. and Ciofﬁ, J. M. (2002) Channel diagonalization through orthogonal
space–time coding, IEEE International Conference on Communications (ICC 2002), 28 April–2
May 2002, 3, 1621–1624.
42. Sharma, N. and Papadias, C. B. (2002) Improved quasi-orthogonal codes, IEEE Wireless Com-
munications and Networking Conference (WCNC2002) 17–21 March 2002, 1, 169–171.
43. Rouquette, S., Merigeault, S. and Gosse, K. (2002) Orthogonal full diversity space–time block
coding based on transmit channel state information for 4 Tx antennas, IEEE International
Conference on Communications (ICC 2002), 28 April–2 May 2002, 1, 558–562.
44. Jongren, G., Skoglund, M. and Ottersten, B. (2002) Combining beamforming and orthogonal
space–time block coding, IEEE Transactions On Information Theory, 48(3), 611–627.
45. Larsson, E. G., Ganesan, G., Stoica, P. and Wing-Hin Wong (2002) On the performance of
orthogonal space–time block coding with quantized feedback, IEEE Communications Letters,
6(11), 487–489.
46. Hsiao-feng, Lu, Kumar, P. V. and Habong, Chung (2002) On orthogonal designs and space–time
codes, Proceedings of 2002 IEEE International Symposium on Information Theory, 30 June–5
July 2002, pp. 418–423.
47. Gozali, R. and Woerner, B. D. (2002) The impact of channel estimation errors on space–
time trellis codes paired with iterative equalization/decoding, IEEE 55th Vehicular Technology
Conference (VTC Spring 2002), 6–9 May 2002, 2, 826–831.
48. Garg, P., Mallik, R. K. and Gupta, H. M. (2002) Performance analysis of space–time cod-
ing with imperfect channel estimation, IEEE International Conference on Personal Wireless
Communications, December 15–17 2002, pp. 71–76.
49. Yan, Q. and Blum, R. S. (2002) Improved space–time convolutional codes for quasi-static slow
fading channels, IEEE Transactions on Wireless Communications, 1(4), 563–571.
50. Yan, Q. and Blum, R. S. (2000) Optimum space–time convolutional codes, 2000 IEEE Wireless
Communications and Networking Conference (WCNC), 23–28 September 2000, 3, 1351–1355.
51. Sellathurai, M. and Haykin, S. (2001) Random space–time codes with iterative decoders for
BLAST architectures, Proceedings of 2001 IEEE International Symposium on Information
Theory, 24–29 June 2001, pp. 105–110.
52. Zhou, G., Wang, Y., Zhang, Z. and Chugg, K. M. (2001) On space–time convolutional codes
for PSK modulation, IEEE International Conference on Communications, 2001 (ICC 2001),
11–14 June 2001, 4, 1122–1126.
53. Youjian Liu, Fitz, M. P. and Takeshita, O. Y. (2000) QPSK space–time turbo codes, 2000 IEEE
International Conference on Communications (ICC 2000), 18–22 June 2000, 1, 292–296.
54. Jayaweera, S. K. and Poor, H. V. (2002) Turbo (iterative) decoding of a unitary space–time code
with a convolutional code, IEEE 55th Vehicular Technology Conference (VTC Spring 2002)
6–9 May 2002, 2, 1020–1024.
55. McCloud, M. L., Brehler, M. and Varanasi, M. K. (2002) Signal design and convolutional
coding for noncoherent space–time communication on the block-Rayleigh-fading channel, IEEE
Transactions On Information Theory, 48(5), 1186–1194.
56. El Gamal, H. and Hammons, A. R. Jr (2002) On the Design and Performance of Algebraic
space–time codes for BPSK and QPSK Modulation, IEEE Transactions On Communications,
50(6).

184
SPACE–TIME CODING
57. Damen, M. O. and Beaulieu, N. C. (2003) On two high-rate algebraic space–time codes, IEEE
Transactions On Information Theory, 49(4), 1059–1063.
58. El Gamal, H. and Hammons, A. R., Jr (2000) 3 Algebraic designs for coherent and differentially
coherent space–time codes, 2000 IEEE Wireless Communications and Networking Conference
(WCNC), 23–28 September 2000, 1, 30–35.
59. El Gamal, H., Hammons, A. R., Jr and Stefanov, A. (2001) Algebraic space–time overlays for
convolutionally coded systems, 12th IEEE InternationalSymposium on Personal, Indoor and
Mobile Radio Communications, 30 September–3 October 2001, 1, C-149–C-154.
60. Damen, M. O., Abed-Meraim, K. and Belﬁore, J.-C. (2002) Diagonal algebraic space–time
block codes, IEEE Transactions On Information Theory, 48(3), 628–636.
61. Damen, M. O., Tewﬁk, A. and Belﬂore, J. C. (2002) A construction of a space–time code based
on number theory, IEEE Transactions On Information Theory, 48(3), 753–760.
62. Gamal, H. E. and Hammons, A. R., Jr (2003) On the design of algebraic space–time codes for
MIMO block-fading channels, IEEE Transactions On Information Theory, 49(1), 151–163.
63. Hammons, A. R., Jr and El Gamal, H. (2000) Further results on the algebraic design of space–
time codes, Proceedings of IEEE International Symposium on Information Theory, 25–30 June
2000, p. 339.
64. El Gamal, H. and Damen, M. O. (2002) An algebraic number theoretic framework for space–
time coding, Proceedings of the 2002 IEEE International Symposium on Information Theory,
pp. 132–137.
65. Tarokh, V. and Jafarkani, H (2000) A differential detection scheme for transmit diversity, IEEE
Journal on Selected Areas in Communications, 18(7).
66. Yi Yao and Howlader, M. (2002) Multiple symbol double differential space–time coded OFDM,
IEEE 55th Vehicular Technology Conference (VTC Spring 2002) 6–9 May 2002, 2, 1050–1054.
67. Diggavi, S. N., Al-Dhahir, N., Stamoulis, A. and Calderbank, A. R. (2002) Differential space–
time coding for frequency-selective channels, IEEE Communications Letters, 6(6), 253–255.
68. Jianhua Liu, Jian Li, Hongbin Li and Larsson, E. G. (2001) Differential space-code modu-
lation for interference suppression, IEEE Transactions on Signal Processing (see also IEEE
Transactions on Acoustics, Speech, and Signal Processing), 49(8), 1786–1795.
69. Zhiqiang Liu, Giannakis, G. B. and Hughes, B. L. (2001) Double differential space–time block
coding for time-selective fading channels, IEEE Transactions On Communications, 49(9), 1529–
1539.
70. Ingram, M. A., Kuo-Hui Li, van Nguyen, A. and Pratt, T. (2000) Beamforming, Doppler
compensation, and differential space–time coding, Proceedings of the 2000 IEEE Sensor Array
and Multichannel Signal Processing Workshop, 16–17 March 2000, pp. 158–162.
71. Hughes, B. L. (2000) Differential space–time modulation, IEEE Transactions On Information
Theory, 46(7), 2567–2578.
72. Lampe, L. H.-J., Schober, R. and Fischer, R. F. H. (2003) Coded differential space–time modu-
lation for ﬂat fading channels, IEEE Transactions on Wireless Communications, 2(3), 582–590.
73. Steiner, A., Peleg, M. and Shamai, S. (2002) Iterative decoding of space–time differentially
coded unitary matrix modulation, IEEE Transactions on Signal Processing (see also IEEE
Transactions on Acoustics, Speech, and Signal Processing), 50(10), 2385–2395.
74. Zhiqiang Liu and Giannakis, G. B. (2003) Block differentially encoded OFDM with maximum
multipath diversity, IEEE Transactions on Wireless Communications, 2(3), 420–423.

REFERENCES
185
75. Steiner, A., Peleg, M. and Shamai, S. (2003) SVD iterative detection of turbo-coded multiantenna
unitary differential modulation, IEEE Transactions On Communications, 51(3), 441–452.
76. Meixia Tao and Cheng, R. S. (2003) Trellis-coded differential unitary space–time modulation
over ﬂat fading channels, IEEE Transactions On Communications, 51(4), 587–596.
77. Jafarkhani, H. and Tarokh, V. (2001) Multiple transmit antenna differential detection from
generalized orthogonal designs, IEEE Transactions On Information Theory, 47(6), 2626–2631.
78. Kun Wang and Hongya Ge (2001) New differential transmission scheme with transmit diversity
for DS-CDMA systems, IEEE 54th Vehicular Technology Conference (VTC 2001 Fall), 1,
232–236.
79. Sellathurai, M. and Haykin, S. (2001) Further results on diagonal-layered space–time archi-
tecture, IEEE 53rd Vehicular Technology Conference (VTC 2001 Spring), 6–9 May 2001, 3,
1958–1962.
80. Zhiqiang Liu and Giannakis, G. B. (2001) Layered space–time coding for high data rate trans-
missions, IEEE Military Communications Conference (MILCOM 2001), 28–31 October 2001,
2, 1295–1299.
81. Matache, A., Wesel, R. D. and Jun Shi (2002) Trellis coding for diagonally layered space–time
systems, IEEE International Conference on Communications (ICC 2002), 28 April–2 May
2002, 3.
82. Gamal, H. E. and Hammons, A. R., Jr (2001) A new approach to layered space–time coding
and signal processing, IEEE Transactions On Information Theory, 47(6), 2321–2334.
83. El Gamal, H. (2002) On the design of layered space–time systems for autocoding, IEEE
Transactions On Communications, 50(9), 1451–1461.
84. Sellathurai, M. and Haykin, S. (2002) Turbo-BLAST for wireless communications: theory and
experiments, IEEE Transactions on Signal Processing (see also IEEE Transactions on Acoustics,
Speech, and Signal, Processing) 50(10), 2538–2546.
85. Wubben, D., Bohnke, R., Rinas, J., Kuhn, V. and Kammeyer, K. D. (2001) Efﬁcient algorithm
for decoding layered space–time codes, Electronics Letters, 37(22), 1348–1350.
86. Yan Xin and Giannakis, G. B. (2002) High-rate space–time layered OFDM, IEEE Communica-
tions Letters, 6(5), 187–189.
87. Sellathurai, M. and Haykin, S. (2003) T-BLAST for wireless communications: ﬁrst experimental
results, IEEE Transactions on Vehicular Technology, 52(3), 530–535.
88. Tarokh, V., Naguib, A., Seshadri, N. and Calderbank, A. R. (1999) Combined array processing
and space–time coding, IEEE Transactions On Information Theory, 45(4), 1121–1128.
89. Foschini, G. J., Chizhik, D., Gans, M. J., Papadias, C. and Valenzuela, R. A. (2003) Analysis
and performance of some basic space–time architectures, IEEE Journal on Selected Areas in
Communications, 21(3), 303–320.
90. Yi Gong and Ben Letaief, K. (2002) Concatenated space–time block coding with trellis coded
modulation in fading channels, IEEE Transactions on Wireless Communications, 1(4), 580–590.
91. Ungerboeck, G. (1982) Channel Coding with Multilevel Phase Signal, IEEE Transactions On
Information Theory, 28, 55–67.
92. Liew, T. H. and Hanzo, L. (2002) Space–time codes and concatenated channel codes for wireless
communications, Proceedings of the IEEE, 90(2), 187–219.
93. Dongzhe Cui and Haimovich, A. M. (2001) Performance of parallel concatenated space–time
codes, IEEE Communications Letters, 5(6), 236–238.

186
SPACE–TIME CODING
94. Goulet, L. and Leib, H. (2003) Serially concatenated space–time codes with iterative decoding
and performance limits of block-fading channels, IEEE Journal on Selected Areas in Commu-
nications, 21(5), 765–773.
95. Schlegel, C. and Grant, A. (2001) Concatenated space–time coding, 12th IEEE International
Symposium on Personal, Indoor and Mobile Radio Communications, 30 September–3 October
2001, 1, C-139–C-143.
96. Ying Li, Jun-hong Hui and Xin-mei Wang (2002) Non-full rank space–time trellis codes for
serially concatenated system, IEEE Communications Letters, 6(9), 397–399.
97. Xiaotong Lin and Blum, R. S. (2000) Improved space–time codes using serial concatenation,
IEEE Communications Letters, 4(7), 221–223.
98. Steiner, A., Peleg, M. and Shamai, S. (2003) SVD iterative detection of turbo-coded multiantenna
unitary differential modulation, IEEE Transactions On Communications, 51(3), 441–452.
99. Foschini, G. J. and Gans, M. J. (1998) On limits of wireless communications in a fading
environment when using multiple antennas, Wireless Personal Communications, 6, 311–335.
100. Telatar, I. E. (1999) Capacity of multi-antenna Gaussian channels, European Transactions on
Telecommunications, 10(6), 585–595.
101. Stege, M., Zillmann, P. and Fettweis, G. (2002) MIMO channel estimation with dimension
reduction, The 5th International Symposium on Wireless Personal Multimedia Communications,
27–30 October 2002, 2, 417–421.
102. Qinfang Sun, Cox, D. C., Huang, H. C. and Lozano, A. (2002) Estimation of continuous ﬂat
fading MIMO channels, IEEE Transactions on Wireless Communications, 1(4), 549–553.
103. Tugnait, J. K. (1997) Blind spatio-temporal equalization and impulse response estimation for
MIMO channels using a Godard cost function, IEEE Transactions on Signal Processing (see
also IEEE Transactions on Acoustics, Speech, and Signal Processing), 45(1), 268–271.
104. Bai, W., He, C., Jiang, L. G. and Li, X. X. (2003) Robust channel estimation in MIMO-OFDM
systems, Electronics Letters, 39(2), 242–244.
105. Tugnait, J. K. (2001) Blind estimation and equalization of MIMO channels via multidelay
whitening, IEEE Journal on Selected Areas in Communications, 19(8), 1507–1519.
106. Zhi Ding and Li Qiu (2003) Blind MIMO channel identiﬁcation from second order statistics
using rank deﬁcient channel convolution matrix, IEEE Transactions on Signal Processing (see
also IEEE Transactions on Acoustics, Speech and Signal Processing), 51(2), 535–544.
107. Haidong Zhu, Farhang-Boroujeny, B. and Schlegel, C. (2003) Pilot embedding for joint channel
estimation and data detection in MIMO communication systems, IEEE Communications Letters,
7(1), 30–32.
108. Komninakis, C., Fragouli, C., Sayed, A. H. and Wesel, R. D. (2002) Multi-input multi-output
fading channel tracking and equalization using Kalman estimation, IEEE Transactions on Signal
Processing (see also IEEE Transactions on Acoustics, Speech, and Signal Processing), 50(5),
1065–1076.
109. Xavier, J. M. F., Barroso, V. A. N. and Moura, J. M. F. (1998) Closed-form blind channel
identiﬁcation and source separation in SDMA systems through correlative coding, IEEE Journal
on Selected Areas in Communications, 16(8), 1506–1517.
110. Tugnait, J. K. and Bin Huang (2000) Multistep linear predictors-based blind identiﬁcation and
equalization of multiple-input multiple-output channels, IEEE Transactions on Signal Process-
ing (see also IEEE Transactions on Acoustics, Speech, and Signal Processing), 48(1), 26–
38.

REFERENCES
187
111. Yang, H., Yuan, F. and Vucetic, B. (2002) Performance of space–time trellis codes in frequency
selective WCDMA systems, Proceedings of IEEE 56th Vehicular Technology Conference (VTC
2002-Fall), 24–28 September 2002, 1, 233–237.
112. Sun, Q., Cox, D. C., Huang, H. C. and Lozano, A. (2002) Estimation of Continuous Flat Fading
MIMO Channels, IEEE Transactions on Wireless Communications, 1(4).
113. Mu Qin and Blum, R. S. (2003) Properties of space–time codes for frequency selective channels
and trellis code designs, IEEE International Conference on Communications (ICC’ 03), 4,
2286–2290.
114. Shengli Zhou and Giannakis, G. B. (2003) Single-carrier space–time block-coded transmissions
over frequency-selective fading channels, IEEE Transactions on Information Theory, 49(1),
164–179.
115. Bahceci,I.andDuman,T.M.(2002)Combinedturbocodingandunitaryspace–timemodulation,
IEEE Transactions On Communications, 50(8), 1244–1249.
116. Rouquette-Leveil, S. and Gosse, K. (2002) Space–time coding options for OFDM-based
WLANs, IEEE 55th Vehicular Technology Conference (VTC Spring 2002), 6–9 May 2002,
2, 904–908.
117. Yue, J. and Gibson, J. D. (2002) Performance of OFDM systems with space–time coding, 2002
IEEE Wireless Communications and Networking Conference (WCNC2002), 17–21 March 2002,
1, 280–284.
118. Ben Lu and Xiaodong Wang (2000) Iterative receivers for multiuser space–time coding systems,
IEEE Journal on Selected Areas in Communications, 18(11), 2322–2335.
119. Larsson, E. G., Stoica, P. and Li, J. (2002) On maximum-likelihood detection and decoding for
space–time coding systems, IEEE Transactions on Signal Processing (see also IEEE Transac-
tions on IEEE Transactions on Acoustics, Speech, and Signal Processing), 50(4), 937–944.
120. Youjian Liu, Fitz, M. P. and Takeshita, O. Y. (2002) A rank criterion for QAM space–time codes,
IEEE Transactions On Information Theory, 48(12), 3062–3079.
121. Gore, D. A. and Paulraj, A. J. (2002) MIMO antenna subset selection with space–time coding,
IEEE Transactions on Signal Processing (see also IEEE Transactions on Acoustics, Speech,
and Signal Processing), 50(10), 2580–2588.
122. Shengli Zhou, Muquet, B. and Giannakis, G. B. (2002) Subspace-based (semi-) blind channel
estimation for block precoded space–time OFDM, IEEE Transactions on Signal Processing
(see also IEEE Transactions on Acoustics, Speech, and Signal Processing), 50(5), 1215–1228.
123. Goulet, L. and Leib, H. (2003) Serially concatenated space–time codes with iterative decoding
and performance limits of block-fading channels, IEEE Journal on Selected Areas in Commu-
nications, 21(5), 765–773.
124. Wing Hin Wong and Larsson, E. G. (2003) Orthogonal space–time block coding with antenna
selection and power allocation, Electronics Letters, 39(4), 379–381.
125. Caire, G. and Colavolpe, G. (2003) On low-complexity space–time coding for quasi-static
channels, IEEE Transactions On Information Theory, 49(6), 1400–1416.
126. Byoungjo Choi and Hanzo, L. (2003) Optimum mode-switching-assisted constant-power single-
and multicarrier adaptive modulation, IEEE Transactions on Vehicular Technology, 52(3), 536–
560.
127. Ghrayeb, A. and Duman, T. M. (2003) Performance analysis of MIMO systems with antenna
selection over quasi-static fading channels, IEEE Transactions on Vehicular Technology, 52(2),
281–288.

188
SPACE–TIME CODING
128. El Gamal, H. and Damen, M. O. (2003) Universal space–time coding, IEEE Transactions On
Information Theory, 49(5), 1097–1119.
129. Xiaoxia Zhang and Fitz, M. P. (2003) Space–time code design with continuous phase modula-
tion, IEEE Journal on Selected Areas in Communications, 21(5), 783–792.
130. Lampe, L. H.-J., Schober, R. and Fischer, R. F. H. (2003) Coded differential space–time mod-
ulation for ﬂat fading channels, IEEE Transactions on Wireless Communications, 2(3), 582–
590.
131. Jafarkhani, H. and Seshadri, N. (2003) Super-orthogonal space–time trellis codes, IEEE Trans-
actions On Information Theory, 49(4), 937–950.
132. Il-Min Kim and Tarokh, V. (2003) Variable-rate space–time block codes in M-ary PSK systems,
IEEE Journal on Selected Areas in Communications, 21(3), 362–373.
133. Gesbert, D., Shaﬁ, M., Da-shan Shiu, Smith, P. J. and Naguib, A. (2003) From theory to practice:
an overview of MIMO space–time coded wireless systems, IEEE Journal on Selected Areas in
Communications, 21(3), 281–302.
134. Banister, B. C. and Zeidler, J. R. (2003) Feedback assisted transmission subspace tracking for
MIMO systems, IEEE Journal on Selected Areas in Communications, 21(3), 452–463.
135. Petre, F., Leus, G., Deneire, L., Engels, M., Moonen, M. and De Man, H. (2003) Space–time
block coding for single-carrier block transmission DS-CDMA downlink, IEEE Journal on
Selected Areas in Communications, 21(3), 350–361.
136. Yan Xin, Zhengdao Wang and Giannakis, G. B. (2003) Space–time diversity systems based on
linear constellation precoding, IEEE Transactions on Wireless Communications, 2(2), 294–309.
137. Wallace, J. W., Jensen, M. A., Swindlehurst, A. L. and Jeffs, B. D. (2003) Experimental char-
acterization of the MIMO wireless channel: data acquisition and analysis, IEEE Transactions
on Wireless Communications, 2(2), 335–343.
138. Gamal, H. E. and Hammons, A. R., Jr (2003) On the design of algebraic space–time codes for
MIMO block-fading channels, IEEE Transactions On Information Theory, 49(1), 151–163.
139. Steiner, A., Peleg, M. and Shamai, S. (2003) SVD iterative detection of turbo-coded multiantenna
unitary differential modulation, IEEE Transactions On Communications, 51(3), 441–452.
140. Larsson, E. G. (2003) Unitary nonuniform space–time constellations for the broadcast channel,
IEEE Communications Letters, 7(1), 21–23.
141. Meixia Tao and Cheng, R. S. (2003) Trellis-coded differential unitary space–time modulation
over ﬂat fading channels, IEEE Transactions On Communications, 51(4), 587–596.
142. Young-Hak Kim and Kaveh, M. (2003) Coordinate-interleaved space–time coding with rotated
constellation, The 57th IEEE Vehicular Technology Conference (VTC 2003-Spring), April 22–
25 2003, 1, 732–735.
143. Le Nir, V., Mard, M. and Le Gouable, R. (2003) Space–time block coding applied to turbo coded
multicarrier CDMA, The 57th IEEE Vehicular Technology Conference (VTC 2003-Spring),
April 22–25 2003, 1, 577–581.
144. Yang, J., Sun, Y., Senior, J. M. and Pem, N. (2003) Channel estimation for wireless commu-
nications using space–time block coding techniques, Proceedings of the 2003 International
Symposium on Circuits and Systems (ISCAS ’03), May 25–28 2003, 2, 220–223.
145. Blum, R. S. MIMO capacity with interference, IEEE Journal on Selected Areas in Communi-
cations, 21(5), 793–801.

REFERENCES
189
146. Mietzner, J., Hoeher, P. A. and Sandell, M. (2003) Compatible improvement of the GSM/EDGE
system by means of space–time coding techniques, IEEE Transactions on Wireless Communi-
cations, 24(5), 690–702.
147. Sellathurai, M. and Haykin, S. (2003) T-BLAST for wireless communications: ﬁrst experimental
results, IEEE Transactions on Vehicular Technology, 52(3), 530–535.
148. Shengli Zhou and Giannakis, G. B. (2003) Optimal transmitter eigen-beamforming and space–
time block coding based on channel correlations, IEEE Transactions On Information Theory,
49(7), 1673–1690.
149. Debbah, M., Hachem, W., Loubaton, P. and de Courville, M. (2003). MMSE analysis of certain
large isometric random precoded systems, IEEE Transactions On Information Theory, 49(5),
1293–1311.
150. Uysal, M. and Georghiades, C. N. (2003) An efﬁcient implementation of a maximum-likelihood
detector for space–time block coded systems, IEEE Transactions on Communications, 51(4),
521–524.
151. Baccarelli, E. and Biagi, M. (2003) Error resistant space–time coding for emerging 4G-WLANs,
2003 IEEE Wireless Communications and Networking (WCNC 2003), 16–20 March 2003, 1,
72–77.
152. Hochwald, B. M. and ten Brink, S. (2003) Achieving near-capacity on a multiple-antenna
channel, IEEE Transactions On Communications, 51(3), 389–399.
153. Banister, B. C. and Zeidler, J. R. (2003) A simple gradient sign algorithm for transmit antenna
weight adaptation with feedback, IEEE Transactions on Signal Processing (see also IEEE
Transactions on Acoustics, Speech, and Signal Processing), 51(5), 1156–1171.
154. Larsson, E. G., Stoica, P. and Jian Li (2003) Orthogonal space–time block codes: maximum
likelihood detection for unknown channels and unstructured interferences, IEEE Transactions
on Signal Processing (see also IEEE Transactions on Acoustics, Speech, and Signal Processing),
51(2), 362–372.
155. Hyundong Shin and Jae Hong Lee (2003) Effect of keyholes on the symbol error rate of
space–time block codes, IEEE Communications Letters, 7(1), 27–29.
156. Shengli Zhou and Giannakis, G. B. (2003) Single-carrier space–time block-coded transmissions
over frequency-selective fading channels, IEEE Transactions on Information Theory, 49(1),
164–179.
157. Andersen, J. B. (2000) Array gain and capacity for known random channels with multiple
element arrays at both ends, IEEE Journal on Selected Areas in Communications, 18(11),
2172–2178.
158. Geman, S. (1980) A limit theorem for the norm of random matrices, Annals of Probability, 8,
252–261.
159. Silverstein, J. W. (1985) The smallest eigenvalue of a large dimensional Wishart matrix, Annals
of Probability, 13, 1364–1368.
160. Raleigh, G. G. and Ciofﬁ, J. M. (1998) Spatio-temporal coding for wireless communication,
IEEE Transactions On Communications, 46, 357–366.
161. Winters, J. H. (1987) On the capacity of radio communication systems with diversity in a
rayleigh fading environment, IEEE Journal on Selected Areas in Communications, 5, 871–878.
162. DaSilva, V. M. and Sousa, E. S. (1997) Fading-resistant modulation using several transmitter
antennas, IEEE Transactions on Communications, 45, 1236–146.

190
SPACE–TIME CODING
163. Divsalar, D. and Simon, M. K. (1988) The design of trellis coded MPSK for fading channels:
performance criteria, IEEE Transaction Communications, 36, 1004–1012.
164. Horn, R. A. and Johnson, C. R. (1985) Matrix Analysis. Cambridge University Press, Cambridge.
165. Golub, G. H. and Van Loan, C. F. (1989) Matrix Computations, 2nd ed. The Johns Hopkins
University Press, Baltimore, MD.
166. Nicholson, W. K. (1986) Elementary Linear Algebra with Applications. PWS-Kent, Boston,
MA.
167. Conway, J. H. and Sloane, N. J. A. (1993) Sphere Packings, Lattices and Groups. Springer-
Verlag, New York.
168. Viterbo, E. and Boutros, J. (1999) A universal lattice code decoder for fading channel, IEEE
Transactions on Information Theory, 45, 1639–1642.
169. Damen, M. O., Chkeif, A. and Belﬁore, J.-C. (2000) Lattice codes decoder for space–time
codes, IEEE Communications Letters, 4, 161–163.
170. Damen, M. O., Meraim, K. A. and Belﬁore, J.-C. (2002) Diagonal algebraic space–time block
codes, IEEE Transactions on Information Theory, 48, 628–637
171. Boutros, J. and Viterbo, E. (1998) Signal space diversity: a power and bandwidth efﬁcient
diversity technique for the Rayleigh fading channel, IEEE Transactions on Information Theory,
44, 1453–1467.
172. Belﬁore, J.-C., Giraud, X. and Rodriguez, J. (2000) Linear labeling for joint source channel
coding, in Proceedings International Symposium on Information Theory (ISIT’2000), Sorrento,
Italy, June 2000.
173. Conway, J. and Sloane, N. (1998) Sphere Packings, Lattices and Groups, 3rd ed. Springer-Verlag,
New York.
174. Viterbo, E. and Boutros, J. (1999) A universal lattice code decoder for fading channel, IEEE
Transations on Information Theory, 45, 1639–1642.
175. Fincke, U. and Phost, M. (1985) Improved methods for calculating vectors of short length in a
lattice, including a complexity analysis, Math. Comput., 44, 463–471.

5
Multiuser Communication
The basic principles of CDMA were discussed in Chapter 1. In this chapter, after brief discussion of
code generation, we focus on multiuser detection. More details can be found in the recent book on
WCDMA [1].
5.1
PSEUDORANDOM SEQUENCES
5.1.1
Binary shift register sequences
Let us deﬁne a polynomial
h(x) = h0xn + h1xn−1 + · · · + hn−1x + hn
(5.1)
in the discrete ﬁeld with two elements hi ∈(0, 1) and h0 = hn = 1. An example polynomial could
be x4 + x + 1 or x5 + x2 + 1. The coefﬁcients hi of the polynomial can be represented by binary
vectors 10011 and 100101, or in octal notation 23 and 45 (every group of three bits is represented by
a number between 0 and 7). A binary sequence u is said to be a sequence generated by h(x) if, for all
integers j,
h0u j ⊕h1u j−1 ⊕h2u j−2 ⊕· · · ⊕hnu j−n = 0
(5.2)
where ⊕= addition modulo 2.
If we formally change the variables
j →j + n,
and
h0 = 1
(5.3)
then Equation (5.2) becomes:
u j+n = hnu j ⊕hn−1u j+1 ⊕· · · h1u j+n−1
(5.4)
In this notation, u j is the jth bit (called chip) of the sequence u. Equation (5.4) suggests that the
sequence u can be generated by an n-stage binary linear feedback shift register which has a feedback
tap connected to the ith cell if hi = 1, 0 < i ≤n. As an example, for n = 5, Equation (5.4) becomes:
u j+5 = h5u j ⊕h4u j+1 ⊕h3u j+2 ⊕h2u j+3 ⊕h1u j+4
(5.5)
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

192
MULTIUSER COMMUNICATION
uj
uj+2
uj+3
uj+4
uj+5
uj+1
Figure 5.1 Sequence generator for the polynomial (45).
uj
uj+1
uj+2
uj+3
uj+4
uj+5
Figure 5.2 Sequence generator for polynomial (75).
For x5 + x2 + 1, octal representation (45), the coefﬁcients hi are:
h0
h1
h2
h3
h4
h5
1
0
0
1
0
1
(octal representation 45)
and the block diagram of the circuit is shown in Figure 5.1.
Similarly, for the polynomial x5 + x4 + x3 + x2 + 1, the coefﬁcients hi are given as:
h0
h1
h2
h3
h4
h5
1
1
1
1
0
1
(octal representation 75)
and by using Equation (5.4) one can get the generator shown in Figure 5.2.
Some of the properties of these sequences and deﬁnitions are listed below. Details can be found
in standard literature listed at the end of the book, especially [2–22].
If u and v are generated by h(x), then so is u ⊕v, where u ⊕v denotes the sequence whose ith
element is ui ⊕vi. The all zero state of the shift register is not allowed because, for this initial state,
Equation (5.5) would continue to generate zero chips. For this reason, the period of u is at most
2n −1, where n is the number of cells in the shift register, or equivalently, the degree of h(x). If u
denotes an arbitrary {0, 1} valued sequence, then x(u) denotes the corresponding {+1, −1} valued
sequence, where the ith element of x(u) is just x(ui):
x(ui) = (−1)ui
(5.6)
If T i is a delay operator (delay for i chip periods) then we have:
T i(x(u)) = x(T iu)
and

x(u) = x(u0) + x(u1) + · · · + x(uN−1)
= N + −N −= (N −N −) −N −
(5.7)
= N −2N −= N −2wt(u)
where wt(u) denotes the Hamming weight of unipolar sequence u, that is, the number of ones in
u, N is the sequence period and N + and N −are the number of positive and negative chips in bipolar

PSEUDORANDOM SEQUENCES
193
sequence x(u). The crosscorrelation function between two bipolar sequences can be represented as:
θu,v(l) ≡θx(u),x(v)(l) =
N−1

i=0
x(ui)x(vi+l)
=
N−1

i=0
(−1)ui (−1)vi+l =
N−1

i=0
(−1)ui ⊕vi+l =
N−1

i=0
x(ui ⊕vi+l)
(5.8)
By using Equation (5.7) we have:
θu,v(l) = N −2wt(u ⊕T lv)
(5.9)
The periodic autocorrelation function θu(·) is just θu,u(·)
θu(l) = N −2wt(u ⊕T lu)
= N + −N −= (N −N −) −N −= N −2N −
(5.10)
5.1.2
Properties of binary maximal length sequences
As was mentioned earlier the all zero state of the shift register is not allowed because, based on
Equation (5.4), the generator could not get out of this state. Bear in mind that the number of possible
states of the shift register is 2n. So, the period of a sequence u generated by the polynomial h(x) cannot
exceed 2n −1, where n is the degree of h(x). If u has this maximal period, N = 2n −1, it is called a
maximal length sequence or m-sequence. To get such a sequence, h(x) should be a primitive binary
polynomial of degree n. There are exactly N non-zero sequences generated by h(x), and they are just
the N different phases of u, T u, T 2u, . . . , T N−1u. Given distinct integers i and j, 0 ≤i, j < N, there
is a unique integer, k, distinct from both i and j, such that 0 ≤k < N and
T iu ⊕T ju = T ku
(5.11)
From the above discussion on the number of ones and zeros, wt(u) = 2n−1 = 1/2(N + 1), so that
from Equation (5.9) we have:
θu(l) =
 N,
if
l ≡0
mod N
−1,
if
l ̸= 0
mod N
(5.12)
From here on, ˜u will be called a characteristic m-sequence, or the characteristic phase of the
m-sequence u if ˜ui = ˜u2i for all i ∈Z.
Let q denote a positive integer, and consider the sequence v formed by taking every qth bit of u
(i.e. vi = uqi for all i ∈Z). The sequence v is said to be a decimation by q of u, and will be denoted
by u[q].
Assume that u[q] is not identically zero. Then, u[q] has period N/gcd(N, q), and is generated by
the polynomial whose roots are the qth powers of the roots of h(x), where gcd(N, q) is the greatest
common divisor of the integers N and q. The tables of primitive polynomials are available in any
book on coding theory. The reciprocal m-sequence v is generated by the reciprocal polynomial of
h(x), that is,
ˆh(x) = xnh(x−1) = hnxn + hn−1xn−1 + · · · + h0.
(5.13)
5.1.3
Crosscorrelation spectra
Frequently, we do not need to know more than the set of crosscorrelation values together with the
number of integers l(0 ≤l < N) for which θu,v(l) = c for each c in this set. Let u and v denote
m-sequences of period 2n −1. If v = u[q], where either q = 2k + 1 or q = 22k −2k + 1, and if

194
MULTIUSER COMMUNICATION
e = gcd(n, k) is such that n/e is odd, then the spectrum of θu,v is three-valued [23–26] as:
−1 + 2(n+e)/2
occurs 2n−e−1 + 2(n−e−2)/2
times
−1
occurs 2n −2n−e −1
times
−1 −2(n+e)/2
occurs 2n−e−1 −2(n−e−2)/2
times
(5.14)
The same spectrum is obtained if instead of v = u[q], we let u = v[q]. Notice that if e is large,
θu,v(l) takes on large values but only very few times, while if e is small, θu,v(l) takes on smaller values
more frequently. In most instances, small values of e are desirable. If we wish to have e = 1, then
clearly n must be odd in order that n/e be odd. When n is odd, we can take k = 1 or k = 2 (and
possibly other values of k as well), and obtain θ(u, u[3]), θ(u, u[5]) and θ(u, u[13]) all having the
three-valued spectrum given by Expressions (5.14) (with e = 1). Suppose next that n ≡2 mod 4.
Then, n/e is odd if e is even and a divisor of n. Letting k = 2, we obtain that θ(u, u[5]) and θ(u, u[13])
both have the three-valued spectrum given by Expressions (5.14) (with e = 2).
Let us deﬁne t(n) as:
t(n) = 1 + 2[(n + 2)/2]
(5.15)
where [α] denotes the integer part of the real number α. Then if n ̸= 0 mod 4, there exist pairs of
m-sequences with three-valued crosscorrelation functions, where the three values are −1, −t(n) and
t(n) −2. A crosscorrelation function taking on these values is called a preferred three-valued cross-
correlation function and the corresponding pair of m-sequences (polynomials) is called a preferred
pair of m-sequences (polynomials).
Let u and v denote m-sequences of period 2n −1, where n is a multiple of 4. If v = u[−1 +
2(n+2)/2] = u[t(n) −2], then θu,v has a four-valued spectrum represented as:
−1 + 2(n+2)/2
occurs (2n−1 −2(n−2)/2)/3
times
−1 + 2n/2
occurs 2n/2
times
−1
occurs 2n−1 −2(n−2)/2 −1
times
−1 −2n/2
occurs (2n −2n/2)/3
times
(5.16)
5.1.4
Maximal connected sets of m-sequences
The preferred pair of m-sequences is a pair of m-sequences of period N = 2n −1, which has the
preferred three-valued crosscorrelation function. The values taken on by the preferred three-valued
crosscorrelation functions are −1, −t(n) and t(n) −2, where t(n) is given by Equation (5.15). The
pair of primitive polynomials that generate a preferred pair of m-sequences is called a preferred pair of
polynomials. A connected set of m-sequences is a collection of m-sequences which has the property
that each pair in the collection is a preferred pair. A largest possible connected set is called a maximal
connected set, and the size of such a set is denoted by Mn. Some examples are given in Table 5.1.
5.1.5
Gold sequences
A set of Gold sequences of period N = 2n −1, consists of N + 2 sequences for which θc = θa = t(n).
A set of Gold sequences can be constructed from appropriately selected m-sequences as described
below. Suppose f (x) = h(x)ˆh(x), where h(x) and ˆh(x) have no factors in common. The set of all
sequences generated by f (x) is of the form a ⊕b, where a is some sequence generated by h(x), b is
some sequence generated by ˆh(x) and we do not make the usual restriction that a and b are non-zero
sequences. We represent such a set by:
G(u, v)  {u, v, u ⊕v, u ⊕T v, u ⊕T 2v, . . . , u ⊕T N−1v}
(5.17)
G(u, v) contains N + 2 = 2n + 1 sequences of period N. Let {u, v} denote a preferred pair of
m-sequences of period N = 2n −1 generated by the primitive binary polynomials h(x) and ˆh(x)

PSEUDORANDOM SEQUENCES
195
Table 5.1
Set sizes and crosscorrelation bounds for the sets of
all m-sequences and for maximal connected sets [2]
C⃝1980, IEEE
Number of
θc for set of
n
N = 2n −1
m-sequences
all m-sequences
Mn
t(n)
3
7
2
5
2
5
4
15
2
9
0
9
5
31
6
11
3
9
6
63
6
23
2
17
7
127
18
41
6
17
8
255
16
95
0
33
9
511
48
113
2
33
10
1023
60
383
3
65
11
2047
176
287
4
65
12
4095
144
1407
0
129
13
8191
630
≥703
4
129
14
16 383
756
≥5631
3
257
15
32 767
1800
≥2047
2
257
16
65 535
2048
≥4095
0
513
respectively. Then set G(u, v) is called a set of Gold sequences. For y, z ∈G(u, v), θy,z(l) ∈
{−1, −t(n), t(n) −2} for all integers l, and θy(l) ∈{−1, −t(n), t(n) −2} for all l ̸= 0 mod N. Every
sequence in G(u, v) can be generated by the polynomial f (x) = h(x)ˆh(x). Note that the non-maximal
length sequences belonging to G(u, v) also can be generated by adding together (term by term, mod-
ulo 2) the outputs of the shift registers corresponding to h(x) and ˆh(x). The maximal length sequences
belonging to G(u, v) are, of course, the outputs of the individual shift registers. Let us compare the
parameter θmax = max {θa, θc} for a set of Gold sequences to a bound due to Sidelnikov, which states
that for any set of N or more binary sequences of period N,
θmax > (2N −2)1/2
(5.18)
For Gold sequences, they form an optimal set with respect to the bounds when n is odd. When n
is even, Gold sequences are not optimal.
5.1.6
Gold-like and dual-BCH sequences
Let n be even and let q be an integer such that gcd(q, 2n −1) = 3. Let u denote an m-sequence of
period N = 2n −1 generated by h(x), and let v(k), k = 0, 1, 2, denote the result of decimating T ku
by q. The v(k) are sequences of period N ′ = N/3 which are generated by the polynomial ˆh(x) whose
roots are qth powers of the roots of h(x). Gold-like sequences are deﬁned as:
Hq(u) = {u, u ⊕v(0), u ⊕T v(0), . . . , u ⊕T N′−1v(0),
u ⊕v(1), u ⊕T v(1), . . . , u ⊕T N′−1v(1),
u ⊕v(2), u ⊕T v(2), . . . , u ⊕T N′−1v(2)}
(5.19)
Note that Hq(u) contains N + 1 = 2n sequences of period N.
For n ≡0 mod 4, gcd(t(n), 2n −1) = 3 vectors v(k) are taken to be of length N rather than N/3.
Consequently, it can be shown that for the set Ht(n)(u), θmax = t(n). We call Ht(n)(u) a set of Gold-like
sequences. The correlation functions for the sequences belonging to Ht(n)(u) take on values in the set

196
MULTIUSER COMMUNICATION
{−1, −t(n), t(n) −2, −s(n), s(n) −2} where s(n) is deﬁned (for even n only) by:
s(n) = 1 + 2n/2 = 1
2(t(n) + 1)
(5.20)
5.1.7
Kasami sequences
Let n be even and let u denote an m-sequence of period N = 2n −1 generated by h(x). Consider the
sequence w = u[s(n)] = u[2n/2 + 1]. w is a sequence of period 2n/2 + 1 which is generated by the
polynomial h′(x), whose roots are the s(n)th powers of the roots of h(x). Furthermore, since h′(x)
can be shown to be a polynomial of degree n/2, w is an m-sequence of period 2n/2 −1. Consider the
sequences generated by h(x)h′(x) of degree 3n/2. Any such sequence must be of one of the forms
T iu, T jw, T iu ⊕T jw, 0 ≤i < 2n −1, 0 ≤j < 2n/2 −1. Thus, any sequence y of period 2n −1
generated by h(x)h′(x) is some phase of some sequence in the set Ks(u) deﬁned by:
Ks(u) 
={u, u ⊕w, u ⊕T w, . . . , u ⊕T 2n/2−2w}
(5.21)
This set of sequences is called a small set of Kasami sequences with:
θ = {−1, −s(n), s(n) −2}
θmax = s(n) = 1 + 2n/2
(5.22)
θmax for the set Ks(u) is approximately one half of the value of θmax achieved by the sets of sequences
discussed previously. Ks(u) contains only 2n/2 = (N + 1)1/2 sequences, while the sets discussed
previously contain N + 1 or N + 2 sequences.
Let n be even and let h(x) denote a primitive binary polynomial of degree n that generates the
m-sequence u. Let w = u[s(n)] denote an m-sequence of period 2n/2 −1 generated by the primitive
polynomial h′(x) of degree n/2, and let ˆh(x) denote the polynomial of degree n that generates u[t(n)].
Then, the set of sequences of period N generated by h(x)ˆh(x)h′(x), called the large set of Kasami
sequences and denoted by KL(u), is deﬁned as follows:
1. If n ≡2 mod 4, then:
KL(u) = G(u, v)



2n/2−2

i=0
{T iw ⊕G(u, v)}


(5.23)
where v = u[t(n)], and G(u, v) is deﬁned in Equation (5.17).
2. If n ≡0 mod 4, then:
KL(u) = Ht(n)(u)



2n/2−2

i=0
{T iw ⊕Ht(n)(u)}


×

{v( j) ⊕T kw: 0 ≤j ≤2, 0 ≤k < (2n/2 −1)/3}
(5.24)
where v( j) is the result of decimating T ju by t(n) and Ht(n)(u) is deﬁned earlier by Equation (5.19).
In either case, the correlation functions for KL(u) take on values in the set {−1, −t(n), t(n) −
2, −s(n), s(n) −2} and θmax = t(n). If n ≡2 mod 4, KL(u) contains 2n/2(2n + 1) sequences, while if
n ≡0 mod 4, KL(u) contains 2n/2(2n + 1) −1 sequences. The large set of Kasami sequences contains
both the small set of Kasami sequences and a set of Gold (or Gold-like) sequences as subsets. More
interestingly, the correlation bound θmax = t(n) is the same as that for the latter subsets. The previous
discussion is summarized in Table 5.2 for some examples of codes.

PSEUDORANDOM SEQUENCES
197
Table 5.2
Polynomials generating various classes of sequences of periods 31, 63, 65, 127,
and 255 [2] C⃝1980, IEEE
N
Polynomial Construction
No.
Values taken on by the correlation functions
31
3551
G
33
7
−1
−9
2373
G
33
11
7
3
−1
−5
−9
63
14551
G
65
15
−1
−17
14343
G
65
15
11
7
3
−1
−5
−9
−13
12471
H3
64
15
7
−1
−9
−17
1527
Ks
8
7
−1
−9
133605
KL
520
15
7
−1
−9
−17
65
10761
63
15
11
7
3
−1
−5
−9
−13
127
41567
G
129
15
−1
−17
255
231441
G
257
31
15
−1
−17
264455
G
257
31, . . . ,
15
11
7
3
−1
−5
−9
−13
−17, . . . ,
−29
326161
H33
256
31
15
−1
−17
−33
267543
H3
256
31
15
−1
−17
−33
11367
Ks
16
15
−1
−17
6031603
KL
4111
31
15
−1
−17
−33
5.1.8
JPL sequences
These sequences are constructed by combining sequence S1(t, Tc) of length L1 and S2(t, Tc) of length
L2 with L1, L2 prime, as S = S(t, Tc) = S1(t, Tc) ⊕S2(t, Tc) of length L = L1 × L2. If the composite
sequence is delayed for L1 chips
S(t −L1Tc, Tc) = S1(t −L1Tc, Tc) ⊕S2(t −L1Tc, Tc)
= S1(t, Tc) ⊕S2(t −L1Tc, Tc)
(5.25)
and, summed up with its original version,
S(t, Tc) ⊕S(t −L1Tc, Tc) = S1(t, Tc) ⊕S2(t, Tc) ⊕S1(t −L1Tc, Tc) ⊕S2(t −L1Tc, Tc)
= S1(t, Tc) ⊕S1(t, Tc) ⊕S2(t −L1Tc, Tc) ⊕S2(t, Tc)
= S2(t −L3Tc, Tc)
(5.26)
The result is only a component sequence S2. In a similar way, by delaying the composite se-
quence for L2 chips, a component sequence S1 will be obtained. This can be used to synchro-
nize sequence S of length L1 × L2 by synchronizing separately component sequences S1 and S2
of length L1 and L2, which can be done much faster. The acquisition time is proportional to
Tacq(S) ∼max[Tacq(S1), Tacq(S2)] ∼max[L1, L2].
5.1.9
Kronecker sequences
In this case the component sequences S1(t, Tc1) of length L1 and chip interval Tc1, and S2(t, Tc2) with
L2, Tc2 = L1Tc1 are combined as:
S(t, Tc1, Tc2) = S1(t, Tc1) ⊕S2(t, Tc2)
(5.27)
The composite sequence, S, synchronization is now performed in cascade, ﬁrst S1 with a much faster
chip rate and then S2. Correlation of S by S1 gives:
F2(S1 · S) = ρ1S2
(5.28)
and after that, this result is correlated with sequence S2. The acquisition time is proportional to
Tacq(S) ∼Tacq(S1) + Tacq(S2) ∼L1 + L2.

198
MULTIUSER COMMUNICATION
5.1.10
Walsh functions
A Walsh function of order n can be deﬁned recursively as follows:
W(n) =

W(n/2),
W(n/2)
W(n/2),
W′(n/2)
	
(5.29)
W′ denotes the logical complement of W, and W(1) = [0]. Thus,
W(2) =

0,
0
0,
1

and
W(4) =


0,
0,
0,
0
0,
1,
0,
1
0,
0,
1,
1
0,
1,
1,
0


(5.30)
W(8) is as follows:
W(8) =


0,
0,
0,
0,
0,
0,
0,
0
0,
1,
0,
1,
0,
1,
0,
1
0,
0,
1,
1,
0,
0,
1,
1
0,
1,
1,
0,
0,
1,
1,
0
0,
0,
0,
0,
1,
1,
1,
1
0,
1,
0,
1,
1,
0,
1,
0
0,
0,
1,
1,
1,
1,
0,
0
0,
1,
1,
0,
1,
0,
0,
1


(5.31)
One can see that any two rows from the matrix
wk(n) = {wk, j(n)}; j = 1, . . . n
wm(n) = {wm, j(n)}
represent the sequences whose bipolar versions have crosscorrelation equal to zero (orthogonal codes).
This is valid as long as the codes are aligned as in the matrix.
A modiﬁcation of the previous construction rule is shown in Figure 5.3, producing orthogonal
variable speeding factor (OVSF) sequences. At each node of the graph, a code wk(n/2) of length n/2
is producing two new codes of length n by a rule
wk(n/2) →w2k−1(n) = {wk(n/2), wk(n/2)}
→w2k(n) = {wk(n/2), −wk(n/2)}
( ) (           )
1
,1
,1
,1
4
1
=
w
( ) (                 ) 
(                 ) 
(                 ) 
1
,1
,1
,1
4
2
−
−
=
w
( )
1
,1
,1
,1
4
3
−
−
=
w
( )
1
,1
,1
,1
4
4
−
−
=
w
( ) (
)1
,1
2
2
−
=
w
( ) ( )1,1
2
1
=
w
( )
1
1
1
=
w
Figure 5.3 Flow graph generating OVSF codes of length 4.

PSEUDORANDOM SEQUENCES
199
5.1.11
Optimum PN sequences
If we represent the information bit stream as
{bn} = · · · , b−1, b0, b1, b2, · · · ; bk = ±1
(5.32)
and the sequence as a vector of chips
y = (y0, y1, . . . , yN−1)
yk = ±1
(5.33)
then the product of these two streams would create
ˆyi = · · · ; b−1y;
b0y;
b1y; · · · .
(5.34)
In other words, ˆy is the DSSS baseband signal which has as its ith element ˆyi = bnyk for all i
such that i = nN + k for k in the range 0 ≤k ≤N −1. A synchronous correlation receiver forms
the inner product
⟨ˆyn, y⟩= bn⟨ˆy, y⟩= bnθy(0)
(5.35)
If the other signal is ˆx which is formed from the data sequence {b′
n} and the signature sequence x
(generated by a binary vector x = (x0, x1, . . . , xN−1) in exactly the same manner as ˆy was formed
from {bn} and y, then we have for the overall received signal:
ˆy + T −l ˆx
where
ˆx = · · · ; b′
−x; b′
0 x; b′
1x; · · ·
(5.36)
The output of a correlation receiver which is in synchronism with y is given by:
zn = ⟨ˆyn, y⟩+

b′
n−1
l−1

i=0
xN−l+i yi + b′
n
N−1

i=l
xi−l yi
	
(5.37)
Having in mind the following relations:
l−1

i=0
xN−l+i yi =
N−1+m

i=0
xi−m yi
(5.38)
N−1

i=l
xi−l yi =
N−1−l

j=0
x j y j+l
and the deﬁnition of aperiodic crosscorrelation function Cx,y
Cx,y(l) =



N−1−l

j=0
x j y∗
j+l,
0 ≤l ≤N −1
N−1+l

j=0
x j−l y∗
j ,
1 −N ≤l < 0
0,
|l| ≥N
(5.39)
Equation (5.37) becomes
zn = bnθy(0) + [b′
n−1Cx,y(l −N) + b′
nCx,y(l)]
(5.40)
The optimum sequences should minimize the interfering term for all values of l. Further details may
be found in [14, 15, 27–40].
5.1.12
Golay code
As an appendix to this section, we will present Golay code [27] which is used in the WUMTS syncho
channel due to its good aperiodic correlation properties. Additional information on the construction
and implementation of these sequences can be found in [27–40].

200
MULTIUSER COMMUNICATION
In general for the two complementary sequences a and b of length N, with aperiodic autocorre-
lations A(k) and B(k) (delay k) we have:
A(k) + B(k) = 0, k ̸= 0
and
A(0) + B(0) = 2N.
The primary synchronization code (PSC), Cpsc is constructed as a so-called generalized hierarchical
Golay sequence. Deﬁne:
a = ⟨x1, x2, x3, . . . , x16⟩= ⟨1, 1, 1, 1, 1, 1, −1, −1, 1, −1, 1, −1, 1, −1, −1, 1⟩
The PSC is generated by repeating the sequence modulated by a Golay complementary sequence,
and creating a complex-valued sequence with identical real and imaginary components. The PSC
Cpsc is deﬁned as:
Cpsc = (1 + j) × ⟨a, a, a, −a, −a, a, −a, −a, a, a, a, −a, a, −a, a, a⟩;
where the leftmost chip in the sequence corresponds to the chip transmitted ﬁrst in time. The 16
secondary synchronization codes (SSCs), {Cssc,1, . . . , Cssc,16}, are complex-valued with identical real
and imaginary components, and are constructed from position wise multiplication of a Hadamard
sequence and a sequence z, deﬁned as:
z = ⟨b, b, b, −b, b, b, −b, −b, b, −b, b, −b, −b, −b, −b, −b⟩, where
b = ⟨x1, x2, x3, x4, x5, x6, x7, x8, −x9, −x10, −x11, −x12, −x13, −x14, −x15, −x16⟩
and x1, x2, . . . , x15, x16, are same as in the deﬁnition of the sequence a above.
The Hadamard sequences (see also Equations (5.29–5.31)) are obtained as the rows in a matrix
H8 constructed recursively by:
H0 = [1]
Hk =

Hk−1
Hk−1
Hk−1
−Hk−1

,
k ≥1
The rows are numbered from the top starting with row 0 (the all ones sequence). Denote
the nth Hadamard sequence as a row of H8 numbered from the top, n = 0, 1, 2, . . . , 255, sub-
sequently. Furthermore, let hn(i) and z(i) denote the ith symbol of the sequence hn and z, re-
spectively where i = 0, 1, 2, . . . , 255 and i = 0 corresponds to the leftmost symbol. The kth SSC,
Cssc,k, k = 1, 2, 3, . . . , 16 is then deﬁned as:
−Cssc,k = (1 + j) ×⟨hm(0) × z(0), hm(1) × z(1), hm(2)
× z(2), . . . , hm(255) × z(255)⟩;
where m = 16 × (k −1) and the leftmost chip in the sequence corresponds to the chip transmitted
ﬁrst in time.
5.1.12.1
Alternative generation
The generalized hierarchical Golay sequences for the PSC described above may also be viewed as
being generated (in real-valued representation) by the following methods:
Method 1: The sequence y is constructed from two constituent sequences x1 and x2 of length n1 and
n2 respectively, using the following formula:
y(i) = x2(i mod n2) x1(i div n2), i = 0 · · · (n1n2) −1
The constituent sequences x1 and x2 are chosen to be the length 16 (i.e. n1 = n2 = 16) sequences:
r x1 is deﬁned to be the length 16 (N (1) = 4) Golay complementary sequence [27] obtained by the
delay matrix D(1) = [8, 4, 1, 2] and weight matrix
W(1) = [1,
−1,
1,
1].

MULTIUSER CDMA RECEIVERS
201
r x2 is a generalized hierarchical sequence using the following formula, selecting s = 2 and using
the two Golay complementary sequences x3 and x4 as constituent sequences. The lengths of the
sequences x3 and x4 are called n3 and n4 respectively.
r x2(i) = x4(i mod s + s(i div sn3)) x3((i div s) mod n3), i = 0 · · · (n3 n4) −1.
r x3 and x4 are deﬁned to be identical and the length 4(N (3) = N (4) = 2) Golay complementary
sequence obtained by the delay matrix D(3) = D(4) = [1, 2] and weight matrix W(3) = W(4) =
[1, 1].
The Golay complementary sequences x1, x3 and x4 are deﬁned using the following recursive
relation:
a0(k) = δ(k)
and
b0(k) = δ(k);
an(k) = an−1(k) + W( j)
n · bn−1

k −D( j)
n

;
bn(k) = an−1(k) −W( j)
n · bn−1

k −D( j)
n

;
k = 0, 1, 2, . . . , 2∗∗N ( j) −1; n = 1, 2, . . . , N ( j).
The desired Golay complementary sequence x j is deﬁned by an assuming n = N ( j). The Kronecker
delta function is described by δ; k, j and n are integers.
Method 2: The sequence y can be viewed as a pruned Golay complementary sequence, generated
using the following parameters which apply to the generator equations for a and b above:
r Let j = 0, N (0) = 8.
r [D0
1, D0
2, D0
3, D0
4, D0
5, D0
6, D0
7, D0
8] = [128, 64, 16, 32, 8, 1, 4, 2].
r [W 0
1 , W 0
2 , W 0
3 , W 0
4 , W 0
5 , W 0
6 , W 0
7 , W 0
8 ] = [1, −1, 1, 1, 1, 1, 1, 1].
r For n = 4, 6, set b4(k) = a4(k), b6(k) = a6(k).
5.2
MULTIUSER CDMA RECEIVERS
In this section we present a number of methods for CDMA multiple access interference cancellation.
Multiple access interference is produced by the presence of the other users in the network which are
located on the same bandwidth as our own signal. The common characteristic of all these schemes
is some form of joint signal and parameter estimation for all signals present on the same bandwidth.
It makes sense to implement this in a base station of a cellular system because all these signals are
available there anyway. At the same time this concept will considerably increase the complexity of
the receiver. Although very complex, these schemes are being standardized already because they offer
signiﬁcantly better performance.
If user k transmits bit stream bk, with bit interval T, using spreading sequence sk, then the low
pass equivalent of the overall signal received in the base station can be represented as [41, 42]
rt = St(b) + σn(t)
(5.41)
St(b) =
M

i=−M
K

k=1
bk(i)sk(t −iT −τk)
(5.42)
where K is the number of users, b = (b1, b2, · · · bK)T is the vector of bits of all users and the signal
is observed in time interval [−MT, MT]. The noise component is represented by the second term of
Equation (5.41) and τk is the delay of the signal from user k.

202
MULTIUSER COMMUNICATION
5.2.1
Synchronous CDMA channels
If the signals from different users are received synchronously, Equation (5.41) becomes:
r(t) =
K

k=1
bk( j)sk(t −jT ) + σn(t),
t ∈[ jT, jT + T ]
(5.43)
If we use notation yk for the output of the matched ﬁlter of user k then we have
yk =
 T
0
r(t)sk(t)dt,
k = 1, . . . , K
(5.44)
and we can write
y1 =

j
bk R1 j + n,
y2 =

j
bk R2 j + n2
...
yk =

j
bk Rkj + nk
(5.45)
The vector form of these outputs can be presented as:
y = Rb + n
(5.46)
where R is the non-negative deﬁnite matrix of crosscorrelations between the assigned waveforms:
Ri j =
 T
0
si(t)s j(t) dt
(5.47)
Conventional single user detection can be represented as:
ˆbc
k = sgn yk
(5.48)
The optimum multiuser detector becomes:
ˆb ∈arg
min
b∈{−1,1}K
 T
0

r(t) −
K

k=1
bksk(t)
	2
dt
(5.49)
= arg
max
b∈{−1,1}K 2yTb −bTRb
5.2.2
The decorrelating detector
In the absence of noise, the matched ﬁlter output vector is y = Rb. This suggests that the detector
should perform the following operation ˆb = sgn R−1y. Note that the noise components in R−1y are
correlated, and therefore sgn R−1y does not result in optimum decisions. It is interesting to point out
that this detector does not require knowledge of the energies of any of the active users.
5.2.3
The optimum linear multiuser detector
The linear detector which minimizes the probability of bit error will be referred to as the optimum
linear multiuser detector. Its operation can be represented as:
ˆb = sgn (Ty) = sgn (TRb + Tn)
(5.50)

MULTIUSER CDMA RECEIVERS
203
We will consider the set I(R) of generalized inverses of the crosscorrelation matrix R and analyze
the properties of the detector:
ˆb = sgn RIy
(5.51)
in Section 5.3. The special case I(R) = R−1 is referred to as a decorrelating detector.
5.2.4
Multistage detection in asynchronous CDMA [43]
If the indexing of users is arranged in increasing order of their delays, then the output of the correlator
of user k can be represented as:
z(i)
k (0) =
 ∞
−∞
r(t)sk(t + iT −τk) dt
= η(i)
k +
K

l=k+1
Rkl(1)b(i−1)
l
+
K

l=1
Rkl(0)b(i)
l
+
k−1

l=1
Rkl(−1)b(i+1)
l
(5.52)
where η(i)
k is the component of the statistic due to the additive channel noise. In vector notation, letting
z(i)(0) = [z(i)
1 (0), z(i)
2 (0), . . . , z(k)
K (0)] T, we have:
z(i)(0) = η(i) + R(1)b(i−1) + R(0)b(i) + R(−1)b(i+1)
(5.53)
The multistage detector recreates the interfering term for each user based on bit estimations in
the previous stage (iteration), subtracts the estimated MAI and then makes the new estimate of data
which can be represented as:
ˆb(i)
k (m + 1) = sgn

z(i)
k (m)

(5.54)
where
z(i)
k (m) = z(i)
k (0) −
K

l=k+1
hkl(1)ˆb(i−1)
l
(m) −

l̸=k
hkl(0)ˆb(i)
l (m) −
k−1

l=1
hkl(−1)ˆb(i+1)
l
(m)
(5.55)
Examples of probability of error curves are shown in Figure 5.4. All parameters are shown in
the ﬁgure itself. One can see that even a two-stage detector may signiﬁcantly improve the system
Conventional
Decorrelator
Optimum linear
Two-stage (conv)
Two-stage (dec)
Optimum
4
2
6
0
8
10
−2
−4
−6
−8
−10
10−4
10−3
10−2
10−1
100
ρ = 1/3
SNR1 = 8 dB
SNR2 – SNR1  (dB)
Probability of error (User 1)
s1 (t)
s2 (t)
0
T
Figure 5.4 Error probability comparison of the linear, two-stage and optimum detectors for
a two-user channel with r12 = 1/3 and signal to noise ratio of user 1 ﬁxed at
8 dB [44] C⃝1991, IEEE.

204
MULTIUSER COMMUNICATION
Conventional
Decorrelator
Optimum linear
Two-stage (conv)
Two-stage (dec)
Three-stage (dec)
Optimum
4
2
6
0
8
10
−2
−4
−6
−8
−10
10−4
10−3
10−2
10−1
100
ρ = 0.7
SNR1 = 8 dB
SNR2 − SNR1  (dB)
Probability of error (User 1)
Figure 5.5 Error probability comparison for a two-user channel with r12 = 0.7 and signal
to noise ratio of user 1 ﬁxed at 8 dB [44] C⃝1991, IEEE.
ρ = 0.7
SNR1 = 8 dB
4
2
6
0
8
10
−2
−4
−6
−8
−10
SNR2−SNR1 (dB)
10−4
10−3
10−2
10−1
100
10−9
10−8
10−7
10−6
10−5
Probability of error (User1)
Conventional
Decorrelator
Optimum linear
Two-stage (conv)
Two-stage (dec)
Optimum
Figure 5.6 Error probability comparison of the linear, two-stage and optimum detectors for
a two-user channel with r12 = 0.7 and signal to noise ratio of user 1 ﬁxed at
12 dB c⃝1991, IEEE.
performance. In order to further emphasize the role of MUD in the presence of the near–far effect,
Figure 5.4 presents the BER for the case when the crosscorrelation is very high r12 = 1/3 (three
chips long sequences). One can see that when the second user becomes stronger and stronger, the
improvement compared with a conventional detector is more signiﬁcant.
This conclusion becomes more and more relevant if either r12 is increased, as in Figure 5.5, or
signal to noise ratio is increased, as in Figure 5.6. Figure 5.7 demonstrates the same results for ﬁve
users in the network.

MULTIUSER CDMA RECEIVERS
205
SNRi −SNR1 (dB)
4
2
6
0
8
10
−2
−4
−6
−8
−10
10−4
10−3
10−2
10−1
100
Probability of error (User 1)
SNR1 = 8 dB
Active users: 1, 2, 3, 4, 5
Conventional
Decorrelator
Two-stage (dec)
Three-stage (dec)
Four-stage (dec)
Figure 5.7 Probability of error, ﬁve users in the network [44] C⃝1991, IEEE.
5.2.5
Non-coherent detector
A conventional detector for differential phase keying signals is deﬁned by the following equation:
ˆbm = sgn

Re

zm(−1)zm(0)

,
zm(i) = 1
2
 (i+1)T
iT
r(t) fm(t −iT )dt
(5.56)
where fm(t) is the signal matched ﬁlter function. In the trivial case it is the signal spreading code
only.
In general, a non-coherent linear multiuser detector for the mth user, denoted by a non-zero
transformation h(m) ∈C K, is deﬁned by the decision:
ˆbm = sgn

Re



K

k=1
¯h(m)
k zk(−1)
K

l=1
¯h(m)
l
zl(0)





(5.57)
where K is the length of the code. A non-coherent decorrelating detector for user m is deﬁned by the
decision with the linear transformation h = d, where d denotes the complex conjugate of the mth
column of a generalized inverse RI of R. If the mth user is linearly independent, it can be shown
that R ¯d = um, the mth unit vector. If all the signature signals are linearly independent, the R−1 exists
and the decorrelating transformation d is uniquely characterized as the complex conjugate of the mth
column of the inverse of R. The receiver block diagram is shown in Figure 5.8.
5.2.6
Non-coherent detection in asynchronous multiuser channels [45]
The z-transform of Equation (5.53) gives:
Z(z) = S(z) · ˆD(z) + N(z)
(5.58)
where
S(z) = R(−1)z + R(0) + R(1)z−1,
(5.59)
and Z(z), ˆD(z) and N(z) are the vector-valued z-transforms of the matched-ﬁlter output sequence, the
sequence { ˆd(l) = A(l)d(l)} and the noise sequence {n(l)} at the output of the matched ﬁlters. If we

206
MULTIUSER COMMUNICATION
Matched filter 1
)
(
1
t
T
f
−
Matched filter 2
)
(
2
t
T
f
−
Matched filter K
)
(
t
T
f K
−
delay T
Re(.)
(.)
delay T
Re(.)
(.)
delay T
Re(.)
(.)
t=iT
t=iT
t=iT
r (t)
1ˆb
2ˆb
K
bˆ
>
<
)
1
(
),
(
h
i
z
>
<
)
2
(
),
(
h
i
z
>
<
)
(
),
(
K
h
i
z
•
•
•
•
•
•
•
•
•
•
•
•
Figure 5.8 Linear multiuser DPSK detector.
Differential
encoder
A(i)
S(z)
Differential
encoder
Decision
algorithm
DPSK decorrelating detector
)
(
~ i
d
)]
(ˆ
[
i
b
)]
(
[
i
b
)
(i
d
)]
(
[
i
n
Equivalent communication system.
adj S(z)
)
(
det
1
z
S
)
(
det
1
z
S
1
−
z
1
−
z
)
(⋅
)
(⋅
)
Re( ⋅
)
Re( ⋅
z(i)
)
(
~ i
d
)]
(ˆ
[
i
b
)
1
(
~
−
i
d
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
Figure 5.9 Non-coherent decorrelating detector.
deﬁne
G(z) = [S(z)]−1 = adj S(z)
det S(z)
(5.60)
then we have
ˆd(z) = G(z)Z(z)
(5.61)
and
ˆb(i) = sgn Re[ ˜d(i −1) ⊗˜d
∗(i)]
(5.62)
The system block diagram is shown in Figure 5.9.

MULTIUSER CDMA RECEIVERS
207
b1(i)
b2(i)
bK(i)
u1(t-iT-τ1)
u2(t-iT-τ2)
uK(t-iT-τK)
c1(i)
c2(i)
cK(i)
r (t)
n (t)
•
•
•
Figure 5.10 Asynchronous CDMA ﬂat Rayleigh fading channel model.
5.2.7
Multiuser detection in frequency non-selective Rayleigh
fading channels
Topics covered in the previous chapter are now repeated for the fading channel. Previously described
algorithms are extended to the fading channel by using as much analogy as possible in the process of
deriving the system transfer functions. In frequency selective channels, decorrelators are combined
with the RAKE-type receiver in order to further improve the system performance. A number of
simulation results are presented in order to illustrate the effectiveness of these schemes. The concept
of this chapter is based on proper understanding of the channel model, covered in Chapter 14. The
overall system model, including the channel model for frequency non-selective fading, is shown in
Figure 5.10.
Parameters ck(i) are, for ﬁxed i, independent, zero mean, complex-valued Gaussian random
variables, with variances |ck|2 with independent quadrature components. The time-varying nature of
the channel is described via the spaced time correlation function of the kth channel Φk(t):
E{c∗
k(i)ck( j)} = Φk(( j −i)T )
(5.63)
The received signal at the central receiver can be expressed as:
r(t) = S(t, b) + n(t)
S(t, b) =
M

i=−M
K

k=1
bk(i)ck(i)uk(t −iT −τk)
(5.64)
uk(t) =

Eksk(t)e jφk
where uk(t) is referred to as the user k signature sequence, and includes the signal amplitude (square
root of signal energy), the code itself and the signal phase. By using proper notation, r(t) can be
represented as:
r(t) = bTCut + n(t)
(5.65)
where
bT [b1(−M)b2(−M) · · · bK(−M) · · · b1(M)b2(M) · · · bK(M)]
ut = [uT(t + MT ) · · · uT(t −MT )]T
u(t) = [u1(t −τ1) · · · uK(t −τK)]T
(5.66)
C = diag(C(−M) · · · C(M))
C(i) = diag(c1(i) · · · cK(i))

208
MULTIUSER COMMUNICATION
5.2.7.1
Multiuser maximum likelihood sequence detection
By using analogy from the previous section, the likelihood function in this case can be represented
as:
L(b) = 2 Re{bHy} −bHCHRuCb
(5.67)
Upper index ( )H denotes the conjugate transpose and
y =
 +∞
−∞
r(t)CHu∗
t dt
(5.68)
represents the vector of matched ﬁlter outputs. The correlation matrix Ru can be represented as
Ru =
 +∞
−∞u∗
t uT
t dt =


Ru(0)
Ru(−1)
0
· · ·
Ru(1)
Ru(0)
Ru(−1)
· · ·
...
...
· · ·
Ru(1)
Ru(0)
Ru(−1)
· · ·
0
Ru(1)
Ru(0)


(5.69)
with block elements of dimension K × K
Ru(i −j) =
 +∞
−∞
u∗(t −iT )uT(t −jT ) dt
(5.70)
and scalar elements
[Ru(i −j)]mn =
 +∞
−∞
u∗
m(t −iT −τm)un(t −jT −τn) dt
(5.71)
5.2.7.2
Decorrelating detector
If we slightly modify the vector notation, Equation (5.65) becomes:
r(t) =
M

i=−M
sT(t −iT )EC(i)b(i) + n(t)
(5.72)
with normalized signature waveform vector:
s(t) = [s1(t −τ1)s2(t −τ2) · · · sK(t −τK)]T
(5.73)
K × K multichannel matrix
C(i) = diag (c1(i)c2(i) · · · cK(i))
(5.74)
E = diag

E1

E2 · · ·

EK

and matrix of carrier phases
 = diag (e jφ 1e jφ 2 · · · e jφ K )
(5.75)
The K × K crosscorrelation matrix of normalized signature waveforms becomes
R(ℓ) =
 +∞
−∞
s∗(t)sT(t + ℓT ) dt,
(5.76)
The asynchronous nature of the channel is evident from the matrix elements
Rmn(ℓ) =
 (ℓ+1)T +τm
ℓT +τm
s∗
m(t −τm)sn(t + ℓT −τn) dt
(5.77)
Since there is no inter-symbol interference, R (ℓ) = 0, ∀|ℓ| > 1 and R(−1) = RH (1). Due to the
ordering of the user RH(1) is an upper triangular matrix with zero elements on the diagonal. The

MULTIUSER CDMA RECEIVERS
209
decorrelating detector front end consists of K ﬁlters matched to the normalized signature waveforms
of the users. The output of this ﬁlter bank, sampled at the ℓ-th bit epoch is:
y(ℓ) =
 +∞
−∞
r(t)s(t −ℓT ) dt
(5.78)
The vector of sufﬁcient statistics can also be represented as:
y(ℓ) = R(−1)E C(ℓ+ 1)b(ℓ+ 1) + R(0)E C(ℓ)b(ℓ)
+ R(1)EC(ℓ−1)b(ℓ−1) + ny(ℓ)
(5.79)
The covariance matrix of the matched ﬁlter output noise vector sequence, {ny(ℓ)} is given by:
E

n∗
y(i)nT
y( j)

= σ 2R∗(i −j)
(5.80)
As in Equation (5.60) the decorrelator is a K-input K-output linear time-invariant ﬁlter with transfer
function matrix:
G(z) = [R(−1)z + R(0) + R(1)z−1]−1  S−1(z)
(5.81)
The z-transform of the decorrelator output vector is:
P(z) = E(Cb)(z) + Np(z)
(5.82)
where Np(z) is the z-transform of the output noise vector sequence having power spectral density
σ 2S−1(z) = σ 2
∞

m=−∞
D(m)z−m
(5.83)
The receiver block diagram for coherent reception is shown in Figure 5.11. Performance results
for the detector are shown in Figure 5.12. Signiﬁcant improvement in the BER is evident.
Matched
filter
User 1
Matched
User 2
Matched
User K
r (t)
Re(.)
Re(.)
Re(.)
jT+τK
jT+τ2
jT+τ1
Adj S(z)
det S(z)
1
det S(z)
det S(z)
1
1
Decision
for user 1
1ˆφj
e−
2ˆφj
e−
K
j
e
φˆ
−
Decorrelating filter
filter
filter
det S(z)
•
•
•
•
•
•
•
•
•
•
•
•
Figure 5.11 Coherent decorrelating multiuser detector.

210
MULTIUSER COMMUNICATION
10−4
10−3
10−2
10−1
100
10
20
30
40
50
60
Conventional detector
Decorrelator detector
MLS detector upper bound
Isolated transmission
Gold sequence J = 127
SNR (dB)
BER for User 1
Figure 5.12 Bit error rate of user 1 for the two-user case with Rayleigh faded paths (same
average path strength) and Gold sequences of period J = 127 [46].
5.2.8
Multiuser detection in frequency selective Rayleigh fading channels
By using analogy with Equation (5.64) the received signal in this case can be represented as:
r(t) = S(t, b) + n(t)
S(t, b) =
M

i=−M
K

k=1
bk(i)hk(t −iT −τk)
hk(t) = ck(t)∗uk(t)
(5.84)
In Equation (5.84), hk(t) is the equivalent received symbol waveform of ﬁnite duration [0, Tk]
(convolution of equivalent low pass signature waveform uk(t) and the channel impulse response ck(t)).
We deﬁne the memory of this channel as v, the smallest integer such that hk(t) = 0 for t > (v + 1)T ,
and all k = 1 · · · K. The impulse response of the kth user channel is given by:
ck(t) =
L−1

ℓ=0
ck,l(t)δ(t −τk,ℓ)
(5.85)
When the signaling interval T is much smaller than the coherence time of the channel, the channel
is characterized as slow fading, implying that the channel characteristics can be measured accurately.
Since the channel is assumed to be Rayleigh fading, the coefﬁcients ck,ℓ(t) are modeled as independent
zero mean complex-valued Gaussian random processes. We will use the following notation:
hk(t) =
L−1

ℓ=0
ck,l(t)uk(t −τk,l) = cT
k (t)uk(t)
(5.86)
For the single user vector of channel coefﬁcients we use:
ck(t) = [ck,0(t), ck,1(t) · · · ck,L−1(t)]T
(5.87)
and for the signal vector of the delayed signature waveform:
uk(t) = [uk(t −τk,0)uk(t −τk,1) · · · uk(t −τk,L−1)]T
(5.88)

MULTIUSER CDMA RECEIVERS
211
The equivalent low pass signature waveform is represented as
uk(t) =

Eksk(t)e jφ k
(5.89)
where Ek is the energy, sk(t) is the real-valued, unit-energy signature waveform with period T and
φk is the carrier phase. In this case the received signal given by Equation (5.84) becomes:
r(t) = S(t, b) + n(t) = bTht + n(t)
(5.90)
The equivalent data sequence is as in Equation (5.66):
b = [b1(−M) · · · bK(−M) · · · b1(M) · · · bK(M)]T
(5.91)
The equivalent waveform vector of NK elements is:
ht = [hT(t + MT ) · · · hT(t −MT )]T
(5.92)
with
h(t) = [h1(t −τ1) · · · hK(t −τK)]T = CT(t)u(t)
(5.93)
where
C(t) =


c1(t)
0
0
· · ·
c2(t)
0
· · ·
...
· · ·
0
0
cK(t)


(5.94)
is a KL × K multichannel matrix. KL is the total number of fading paths for all K users and:
u(t) = [u1(t −τ1) · · · uK(t −τK)] T
(5.95)
is the equivalent signature vector of KL elements.
5.2.8.1
Multiuser maximum likelihood sequence detection
The log likelihood function in this case becomes:
L(b) = 2 Re{bHy} −bHHb
(5.96)
where superscript H denotes the conjugate transpose,
y =
 +∞
−∞
r(t)h∗
t dt
(5.97)
is the output of the bank of matched ﬁlters sampled at the bit epoch of the users. Matrix H is an
N × N block Toeplitz crosscorrelation waveform matrix with K × K block elements,
H(i −j) =
 +∞
−∞
h∗(t −iT )hT(t −jT ) dt
(5.98)
5.2.8.2
Viterbi algorithm
Since every waveform hk(t) is time limited to [0, Tk], Tk < (v + 1)T , it follows that H(l) = 0, ∀|l| >
v + 1 and H( j) = HH( j) for j = 1 · · · v + 1. Due to the ordering of the users HH(v + 1) is an
upper triangular matrix with zero elements on the diagonal. Provided that knowledge of a channel is
available, the MLS detector may be implemented as a dynamic programming algorithm of the Viterbi
type. The vector Viterbi algorithm is the modiﬁcation of the one introduced for M-input M-output
linear channels where the dimensionality of the state space is 2(v+1)K. As in the case of the AWGN
channel, a more efﬁcient decomposition of the likelihood function results in an algorithm with a state
space of dimension 2(v+1)K−1.

212
MULTIUSER COMMUNICATION
Frequency selective fading is described by the wide-sense stationary uncorrelated scattering
model. The bandwidth of each signature waveform is much larger than the coherence bandwidth
of the channel, Bw ≫(f )c. The time varying frequency selective channel for each user can be
represented as a tapped delay line with tap spacing 1/Bw, so that Equation (5.86) becomes:
hk(t) =
L−1

i=0
ck,i(t)uk

t −i
Bw
 
= sT
k (t)Ekkck(t)
(5.99)
The signature waveform vector may be described as:
sk(t) =

sk(t), sk

t −i
Bw
 
· · · sk

t −L −i
Bw
 T
(5.100)
and
Ek = √EkIL
k = e jφkIL
(5.101)
For a data symbol duration much longer than the multipath delay spread, T ≫Tm, any inter-
symbol interference due to channel dispersion can be neglected. Based on the above discussion, the
channel model is presented in Figure 5.13. If we use notation
b(i) = [b1(i)b2(i) · · · bK(i)]T,
i = −M · · · M
s(t) =

sT
1(t −τ1)sT
2(t −τ2) · · · sT
K(t −τK)
T
E = diag(E1, E2, · · · EK)
 = diag(1, 2, · · · K)
hT(t) = [h1(t −τ1) · · · hK(t −τK)] = sT(t)EC(t)
(5.102)
w
B
1
w
B
1
w
B
1
w
B
1
w
B
1
w
B
1
c1,0(t)
c1,1(t)
c1,L-1(t)
cK,0(t)
cK,1(t)
cK,L-1(t)
r (t)
n (t)
b1(i)
bK(i)
s1(t-iT-τ1)
sK(t-iT-τK)
h1(t-iT-τ1)
hK(t-iT-τK)
•
•
•
Figure 5.13 A synchronous CDMA frequency selective Rayleigh fading channel model.

MULTIUSER CDMA RECEIVERS
213
Equation (5.84) becomes:
r(t) =
M

i=−M
hT(t −iT )b(i) + n(t) =
M

i=−M
sT(t)EC(t)b(i) + n(t)
(5.103)
We deﬁne a KL × KL crosscorrelation matrix of normalized signature waveforms,
R(l) =
+∞

−∞
s (t)sT(t + lT ) dt
(5.104)
The asynchronous mode is evident from the structure of the L × L crosscorrelation matrix between
the users m and n,
Rmn(l) =
(l+1)T +τm

lT +τm
sm(t −τm) sT
n (t + lT −τn) dt
(5.105)
Since there is no inter-symbol interference, R(l) = 0, ∀|l| > 1 and R(−1) = RH(1). Due to the
ordering of the users RH(1) is an upper triangular matrix with zero elements on the diagonal.
The front end of the multiuser detector consists of KL ﬁlters matched to the normalized properly
delayed signature waveforms of the users, as shown in Figure 5.14. The output of this ﬁlter bank
sampled at the bit epochs is given by the vector
y(l) =
+∞

−∞
r(t)s(t −lT ) dt
(5.106)
The vector of sufﬁcient statistics can also be expressed as:
y(l) = R(−1)EC(l + 1)b(l + 1) + R(0)EC(l)b(l)
+R(1)EC(l −1)b(l −1) + n(l)
(5.107)
The covariance matrix of the matched ﬁlter output noise vector is given by:
E{n∗(i)nT( j)} = σ 2R(i −j)
w
B
1
w
B
1
De-
correlating
filter
Multipath
diversity
combiner
user 1
Multipath
diversity
combiner
user K
L signal replicas
w
B
1
w
B
1
r
(t)
s1 (t)
sK (t)
Multipath processing
∫
∫
∫
∫
∫
∫
•
•
•
Figure 5.14 Multipath decorrelation.

214
MULTIUSER COMMUNICATION
Taking the z-transform gives
Y(z) = S(z)(ECb)(z) + N(z)
(5.108)
where (ECb)(z) is the transform of sequence
{ [

E1e jφ1c1,0(i)b1(i) · · ·

E1e jφ1c1,L−1(i)b1(i) · · ·

EKe jφK cK,L−1(i)bK(i)]T}
(5.109)
S(z) is the equivalent transfer function of the CDMA multipath channel which depends only on the
signature waveforms of the users. The multipath decorrelating (MD) ﬁlter is a KL-input KL-output
linear time-invariant ﬁlter with transfer function matrix:
G(z)  [S(z)]−1 = adjS(z)
det S(z) = [R(−1)z + R(0) + R(1)z−1]−1
(5.110)
The necessary and sufﬁcient condition for the existence of a stable, but non-causal realization of
the decorrelating ﬁlter is
det[R(−1)e jw + R(0) + R(1)e−jw]−1 ̸= 0 ∀w ∈[0, 2π]
(5.111)
The z-transform of the decorrelating detector outputs is
P(z) = (ECb)(z) + Np(z)
(5.112)
Np(z) is the z-transform of a stationary, ﬁltered Gaussian noise vector sequence. The
z-transform of the noise covariance matrix sequence is equal to
σ 2[S(z)]−1 = σ 2
∞

m=−∞
D(m)z−m
(5.113)
The output of the decorrelating detector containing L signal replicas of user k may be expressed as:
pk(l) = ck

Eke jφkbk(l) + nk(l)
(5.114)
The noise covariance matrix is given by:
σ 2[D(0)]kk = σ 2 1
2π
2π

0
[S(e−jw)]−1
kk dw
(5.115)
5.2.8.3
Coherent reception with maximal ratio combining
Since the front end of the coherent multiuser detector contains the decorrelating ﬁlter, the noise
components in the L branches of the kth user are correlated. The usual approach prior to combining
is to introduce the whitening operation, where whitening ﬁlter (TH)−1 is obtained by Cholesky
decomposition [D(0)]kk = TTT∗. So, the output of the user of interest is given by
pkw = f

Eke jφkbk + nkw
= p′
kwbk + nkw
(5.116)
where
f = (TH)−1ck
(5.117)
and nkw is a zero mean Gaussian white noise vector with covariance matrix σ 2IL. The optimal
combiner in this situation is the maximal ratio combiner (MRC). The receiver block diagram is
shown in Figure 5.15. The output of the maximal ratio combiner can be represented as:
ˆbk = sgn
!
pkw · ˆp′
kw∗
"
(5.118)

MULTIUSER CDMA RECEIVERS
215
L x L
Whitening
filter
Maximal
ratio
combiner
Decision
variable
kw
p
kp
Figure 5.15 Maximal ratio combining after multipath decorrelation for coherent reception.
L = 2
L = 1
L = 4
RAKE
MD-MRC
10
15
20
5
10−4
10−3
10−2
10−1
100
10−5
10−6
BER for user1
10−7
Number of users
Figure 5.16 Error probability for a coherent RAKE and MD-MRC multiuser receiver for
different multipath diversity order in a mobile radio channel using Gold sig-
nature sequences of length J = 127, average i = 20 dB [46].
For illustration purposes, a CDMA cellular mobile radio system with 1.25 MHz bandwidth and
9600 bps data rate is used. The multipath intensity proﬁle of the mobile radio channel is given by:
r(τ) = P
Tm
e−τ
Tm
(5.119)
where P is the total average received power and Tm is the multipath delay spread. Typical values of
the multipath delay spread are Tm = 0.5 µs for the suburban environment and Tm = 3 µs for an urban
environment. Therefore, we expect the multipath diversity reception with two branches in suburban
areas and four to ﬁve branches in an urban setting. For the given parameters, inter-symbol interference
is negligible, and the mobile radio channel can be described as a discrete multipath Rayleigh fading
channel with mean square value of the path coefﬁcients given by:
c2
k,l = 1
Bw
r
 l
Bw
 
l = 0 · · · L −1
(5.120)
The BER versus the number of users is shown in Figures 5.16 and 5.17. One can see that for a large
product KL, multiuser detector performance starts to degrade due to noise enhancement caused by
matrix inversion.

216
MULTIUSER COMMUNICATION
10−4
10−3
10−2
10−1
100
10−5
10−6
BER for user1
10−7
10
15
5 Number of users
L = 2
L = 1
L = 4
MD-EGC
MD-MRC
Figure 5.17 Multiuser receiver error probability for different multipath diversity orders in
a mobile radio channel using Gold signature sequences of length J = 127,
average SNR = 20 dB [46].
More details on multiuser detection can be found in [47–57]. The latest results in this ﬁeld
including the systems using multiple antennas, can be found in [58–80], and [81–124].
5.3
MINIMUM MEAN SQUARE ERROR (MMSE) LINEAR
MULTIUSER DETECTION
If the amplitude of user k’s signal in Equation (5.43) is Ak, then the vector of matched ﬁlter outputs
y in Equation (5.46) can be represented as:
y = RAb + n
(5.121)
where A is a diagonal matrix with elements Ak
A = diag∥Ak∥
(5.122)
If the multiuser detector transfer function is denoted as M then the minimum mean square error
(MMSE) detector is deﬁned as
min
M∈RK x K E[∥b −My∥2]
(5.123)
One can show that the MMSE linear detector outputs the following decisions [84, 85, 88]:
ˆbk = sgn
 1
Ak
([R + σ 2 A−2]−1y)k
 
= sgn(([R + σ 2 A−2]−1y)k)
(5.124)
Therefore, the MMSE linear detector replaces the transformation R−1 of the decorrelating detector
by
[R + σ 2A−2]−1
(5.125)

MINIMUM MEAN SQUARE ERROR (MMSE) LINEAR MULTIUSER DETECTION
217
−10                   −5
0
5
10
Near−far ratio A2 / A1 (dB)
10−3
10−2
10−1
Bit error rate
a
b
c
d
e
Figure 5.18 Bit error rate with two users and crosscorrelation ρ = 0.8: (a) single user
matched ﬁlter; (b) decorrelator; (c) MMSE; (d) minimum (upper bound);
(e) minimum (lower bound).
where
σ 2A−2 = diag
# σ 2
A2
1
, · · · , σ 2
A2
K
$
(5.126)
As an illustration, for the two users case we have:
[R + σ 2A−2]−1 =


1 + σ 2
A2
1
 
1 + σ 2
A2
2
 
−ρ2
−1 
1 + σ 2
A2
2
−ρ
−ρ
1 + σ 2
A2
1


(5.127)
In the asynchronous case, similarly to the solution in Section 5.3 the MMSE linear detector is a
K-input, K-output, linear, time-invariant ﬁlter with transfer function
[RT[1]z + R[0] + σ 2A−2 + R[1]z−1]−1
(5.128)
In Figure 5.18, the BER is presented versus the near–far ratio for different detectors. One can see
that MMSE shows better performance than the decorrelator. In the ﬁgure, the signal to noise ratio of
the desired user is equal to 10 dB.
5.3.1
System model in multipath fading channels
In this section the channel impulse response and the received signal will be presented as
ck(t) =
Lk

l=1
c(n)
k,l δ(t −τk,l)
(5.129)

218
MULTIUSER COMMUNICATION
r(t) =
Nb−1

n=0
K

k=1
L

l=1
Akb(n)
k c(n)
k,l sk(t −nT −τk,l) + n(t)
(5.130)
The received signal is time discretized, by antialias ﬁltering and sampling r(t) at the rate 1/T s =
S/Tc = SG/T , where S is the number of samples per chip and G = T/TC is the processing gain.
The received discrete time signal over a data block of Nb symbols is:
r = SCAb + n ∈C SGNb
(5.131)
where
r =

rT(0), . . . , rT(Nb−1)
T
∈C SGNb
(5.132)
is the input sample vector with
rT(n) = [r(Ts(nSG + 1)), . . . ,r(Ts(n + 1)SG] ∈C SG
(5.133)
S = [S(0), S(1), . . . , S(Nb−1)] ∈RSGNb×K LNb
=


S(0)(0)
0
· · ·
0
...
S(1)(0)
...
...
S(0)(D)
...
...
0
0
S(1)(D)
...
S(Nb−1)(0)
...
...
...
...
0
· · ·
0
S(Nb−1)(D)


(5.134)
is the sampled spreading sequence matrix and D = ⌈(T + Tm)/T ⌉. In a single path channel, D = 1
due to the asynchronicity of users. In multipath channels, D ≥2 due to the multipath spread. The code
matrix is deﬁned with several components (S(n)(0), . . . , S(n)(D)) for each symbol interval to simplify
the presentation of the crosscorrelation matrix components. Tm is the maximum delay spread,
S(n) =

s(n)
1,1, . . . , s(n)
1,L, . . . , s(n)
K,L

∈RSGNb×K L
(5.135)
where
s(n)
k,l =



0T
SGNb×1
n = 0, τk,l = 0

[sk(Ts(SG −τk,l + 1)), . . . , sk(TsSG)]T, 0T
(SGNb−τk,l)×1
T
n = 0, τk,l > 0

0T
((n−1)SG+τk,l)×1, sT
k , 0T
(SG(Nb−n)−τk,l)×1
T
0 < n < Nb −1

0T
(SG(Nb−1)+τk,l)×1, [sk(T s), . . . , sk(Ts(SG −τk,l))]
T
n = Nb −1
(5.136)
where τk,l is the time discretized delay in sample intervals and
sk =

sk(Ts), . . . , sk(TsSG)
T
∈RSG
(5.137)
is the sampled signature sequence of the kth user. By analogy with Equation (5.94):
C = diag

C(0), . . . , C(Nb−1)
∈CKLNb×KNb
(5.138)
is the channel coefﬁcient matrix with
C(n) = diag

c(n)
1 , . . . , c(n)
K

∈CKL×K
(5.139)

MINIMUM MEAN SQUARE ERROR (MMSE) LINEAR MULTIUSER DETECTION
219
and
c(n)
k
=

c(n)
k,1, . . . , c(n)
k,L
T
∈C L
(5.140)
Equation (5.122) now becomes:
A = diag

A(0), . . . , A(Nb−1)
∈RKNb×KNb
(5.141)
the matrix of total received average amplitudes with
A(n) = diag[A1, . . . , AK] ∈RK×K
(5.142)
The bit vector from Equation (5.91) becomes
b =

bT(0), . . . , bT(Nb−1)
T
∈ℵKN b
(5.143)
with the modulation symbol alphabet ℵ(with BPSK ℵ= {−1, 1}) and
b(n) =

b(n)
1 , . . . , b(n)
K

∈ℵK
(5.144)
and n ∈CSGNb is the channel noise vector. It is assumed that the data bits are independent identically
distributed random variables independent from the channel coefﬁcients and the noise process.
The crosscorrelation matrix from Equation (5.104) for the spreading sequences can be formed as:
R = STS ∈RKLNb×KLNb
(5.145)
=


R(0,0)
· · ·
R(0,D)
0KL · · ·
0KL
...
...
...
...
...
R(D,0)
...
...
...
0KL
0KL
...
...
...
R(Nb−D,Nb−1)
...
...
...
...
...
0KL
· · ·
0KL
· · ·
R(Nb−1,Nb−1)


where
R(n,n−j) =
D−j

i=0
ST(n)(i)S(n−j)(i + j),
j ∈{0, . . . , D}
(5.146)
and R(n−j,n) = RT(n,n−j). The elements of the correlation matrix can be written as
R(n,n′) =


R(n,n′)
1,1
· · ·
R(n,n′)
1,K
...
...
...
R(n,n′)
K,1
R(n,n′)
K,K

∈RKL×KL
(5.147)
and
R(n,n′)
k,k′
=


R(n,n′)
k1,k′1
· · ·
R(n,n′)
k1,k′L
...
...
...
R(n,n′)
kL,k′1
· · ·
R(n,n′)
kL,k′L

∈RL×L
(5.148)
with
R(n,n′)
kl,k′l′ =
SG−1+τk,l

j=τk,l
sk(Ts( j −τk,l))sk′(Ts( j −τk′l′ + (n′ −n)SG)) = s
T(n)
k,l s(n′)
k′,l′
(5.149)

220
MULTIUSER COMMUNICATION
which represents the correlation between users k and k′, the lth and l′th paths, and between their nth
and n′th symbol intervals.
5.3.2
MMSE detector structures
One of the conclusions in Section 5.2 was that noise enhancement in linear MUD causes system
performance degradation for large products KL. In this section we consider a possibility for reducing
the size of the matrix to be inverted by using multipath combining prior to MUD. The structure is
called a postcombining detector and the basic block diagram of the receiver is shown in Figure 5.19.
The starting point in the derivation of the receiver structure is the cost function E{|b −ˆb|2} where
ˆb = LH
[post]r
(5.150)
The detector linear transform matrix is given as
L[post] = SCA(ACHRCA + σ 2I)−1 ∈CSGNb×KNb
(5.151)
This result is obtained by minimizing the cost function and derivation details may be found in
any standard textbook on signal processing. Here R = STS is the signature sequence crosscorrelation
matrix deﬁned by Equation (5.145). The output of the postcombining LMMSE receiver is
y[post] = (ACHRCA + σ 2I)−1(SCA)Hr ∈CK
(5.152)
where (SCA)Hr is the multipath (MR) combined matched ﬁlter bank output. For non-fading AWGN:
L[post] = S(R + σ 2(AHA)−1)−1
(5.153)
The postcombining LMMSE receiver in fading channels depends on the channel complex coefﬁ-
cients of all users and paths. If the channel is changing rapidly, the optimal LMMSE receiver changes
continuously. The adaptive versions of LMMSE receivers have increasing convergence problems as
the fading rate increases. The dependence on the fading channel state can be removed by applying
a precombining interference suppression type of receiver. The receiver block diagram in this case is
shown in Figure 5.20.
Matched
filter
1, 1
Matched
1, L
Matched
K, L
1/Ts
K x K
Multiuser
detection
Matched
K, 1
Multipath
combining
Multipath
combining
r(n)
filter
filter
filter
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
Figure 5.19 Postcombining interference suppression receiver.

MINIMUM MEAN SQUARE ERROR (MMSE) LINEAR MULTIUSER DETECTION
221
1/Ts
Multipath
combining
Multipath
combining
KL x KL
Multiuser
detection
r(n)
MF1,L
MFK,1
MFK,L
MF1,1
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
Figure 5.20 Precombining interference suppression receiver.
The transfer function of the detector is obtained by minimizing each element of the cost function
E{|h −ˆh|2}
(5.154)
where
h = CAb
(5.155)
and
ˆh = LT
[pre]r
(5.156)
is estimated.
The solution of this minimization is [125]:
L[pre] = S

R + σ 2R−1
h
−1
∈RSGNb×KLNb
(5.157)
Rh = diag

A2
1Rc1, . . . , A2
KRck

∈RKLNb×KLNb
(5.158)
Rck = diag[E[|ck,1|2], . . . , E[|ck,L|2]] ∈RL×L
(5.159)
y[pre] =

R + σ 2R−1
h
−1
STr ∈CKL
(5.160)
The two detectors are compared in Figure 5.21. The postcombining scheme performs better. The
illustration of LMMSE–RAKE receiver performance in the near–far environment is shown in Figure
5.22 [126]. Considerable improvement compared to conventional RAKE is evident.
5.3.3
Spatial processing
When combined with multiple receive antennas the receiver structures may have one of the forms
shown in Figure 5.23 [125–129].
The channel impulse response for the kth user’s ith sensor can now be written as:
ck,i(t) =
Lk

l=1
c(n)
k,l e j2π
λ−1⟨e(φk,l),εi ⟩δ(t −(τk,l,i))
(5.161)

222
MULTIUSER COMMUNICATION
BEP
0
5
10
15
20
25
30
Number of users
10−5
10−4
10−3
10−2
10−1
100
10−9
10−8
10−7
10−6
Precomb. LMMSE
Postcomb. LMMSE
0 dB
5 dB
10 dB
15 dB
Figure 5.21 Bit error probabilities as a function of the number of users for the postcombin-
ing and precombining LMMSE detectors in an asynchronous two-path ﬁxed
channel with different SNRs and bit rate 16 kbit/s, Gold code of length 31,
td/T = 4.63 × 10−3, maximum delay spread 10 chips [126].
RAKE
LMMSE−RAKE
two-path fading channel
SNR = 20 dB
two users, the other one 20 dB stronger
10−4
10−3
10−2
10−1
100
BEP
10−5
4
8
16
32
2
Spreading factor (G)
Figure 5.22 Bit error probabilities as a function of the near–far ratio for the conventional
RAKE receiver and the precombining LMMSE (LMMSE–RAKE) receiver
with different spreading factors (G) in a two-path Rayleigh fading channel
with maximum delay spreads of 2 µs for G = 4, and 7 µs for other spreading
factors. The average signal to noise ratio is 20 dB, the data modulation is
BPSK, the number of users is 2, the other user has 20 dB higher power. Data
rates vary from 128 kbit/s to 2.048 Mbit/s; no channel coding is assumed [126].

MINIMUM MEAN SQUARE ERROR (MMSE) LINEAR MULTIUSER DETECTION
223
(a)
(b)
Multipath
combining
Multiuser
detection
1/Ts
1/Ts
1/Ts
1/Ts
r1
(n)
MF1,1
MF1,L
MFK,1
MFK,L
Multipath
combining
Spatial
combining
rI
(n)
Multipath
combining
Multiuser
detection
MFK,L
Multipath
combining
Multipath
combining
Multiuser
detection
Multipath
combining
Spatial
combining
Spatial
combining
MF1,1
MF1,L
MFK,1
MF1,1
MF1,L
MFK,1
MFK,L
r1
(n)
rI
(n)
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
Figure 5.23 (a) The spatial–temporal multiuser (STM) receiver; (b) the TMS receive post
combining interference suppression receiver with spatial signal processing
(c) the SMT receiver; (d) the MST receiver. A precombining interference
suppression receiver with spatial signal processing.

224
MULTIUSER COMMUNICATION
(c)
(d)
Multiuser
detection
1/Ts
1/Ts
1/Ts
1/Ts
r1
(n)
r1
(n)
r1
(n)
r1
(n)
Spatial
combining
Multipath
combining
Multipath
combining
MF1,1
MF1,L
MFK,1
MFK,L
Multipath
combining
Multipath
combining
Multiuser
detection
Multiuser
detection
Spatial
combining
Spatial
combining
MF1,1
MF1,L
MFK,1
MFK,L
MF1,1
MF1,L
MFK,1
MFK,L
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•
•••
•
•
•
•
•
•
•
•
•
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
•••
Figure 5.23 (Cont.).
where Lk is the number of propagation paths (assumed to be the same for all users for simplicity;
Lk = L, ∀k), c(n)
k,l is the complex attenuation factor of the kth user’s lth path, τk,l,i is the propagation
delay for the ith sensor, εi is the position vector of the ith sensor with respect to some arbitrarily
chosen reference point, λ is the wavelength of the carrier, e(φk,l) is a unit vector pointing to direction
φk,l (direction of arrival), and ⟨., .⟩indicates the inner product.
Assuming that the number of propagation paths is the same for all users, the channel impulse
response can be written as:
ck,i(t) =
L

l=1
c(n)
k,l e j2π
λ−1⟨e(φk,l),εi ⟩δ(t −τk,l)
(5.162)
The channel matrix for the ith sensor consists of two components
Ci = C ◦i ∈CKLNb×KNb
(5.163)

SINGLE USER LMMSE RECEIVERS FOR FSFC
225
where C is the channel matrix deﬁned in Equation (5.139).◦is the Schur product deﬁned as Z =
X ◦Y ∈C x×y, i.e. all components of the matrix X ∈C x×y are multiplied elementwise by the matrix
Y ∈C x×y, i = diag(˜φi) ⊗INb and ˜ϕi = diag(ϕ1, . . . , ϕK),ϕk = [φk,1, . . . , φk,L]T, is the matrix of
the direction vectors
ϕi =

e j2π
λ−1⟨e(φ1,1),εi ⟩, . . . , e j2π
λ−1⟨e(φK,L),εi ⟩T
∈CKL
(5.164)
By using the previous notation one can show that the equivalent detector transform matrices are
given as [125–128].
L[STM] =
I
i=1 S(C ◦i) ·
I
i=1 AH(H
i ◦CH)R(C ◦i)A + σ 2I
−1
L[SMT] =
I
i=1 Si
I
i=1 H
i Ri + σ 2R−1
h
−1
L[MST]i = S
!
R + σ 2R−1
h
"−1
L[TMS] = SCA (ACHRCA + σ 2I)−1
(5.165)
5.4
SINGLE USER LMMSE RECEIVERS FOR FREQUENCY
SELECTIVE FADING CHANNELS
5.4.1
Adaptive precombining LMMSE receivers
In this case the MSE criterion E{|h −ˆh|2} requires that the reference signal h = CAb is available in
adaptive implementations. For adaptive single user receivers, the optimization criterion is presented
for each path separately, i.e.
Jk,l = E{|(h)k,l −(ˆh)k,l|2}
(5.166)
The receiver block diagram is given in Figure 5.24 [89–94].
By using notation
¯r(n) =

rT(n−D), . . . , rT(n), . . . , rT(n+D)T
∈CMSG
w(n)
k,l =

w(n)
k,l (0), . . . , w(n)
k,l (MSG −1)
T
∈CMSG
y(n)
k,l = wH(n)
k,l ¯r(n)
(5.167)
the bit estimation is deﬁned as
ˆb(n)
k
= sgn
% L

l=1
ˆc(n)
k,l y(n)
k,l
&
(5.168)
The ﬁlter coefﬁcients w are derived using the MSE criterion (E[|e(n)
k,l |2]). This leads to the optimal
ﬁlter coefﬁcients w[MSE]k,l = R−1
¯r R¯rdk,l where R¯rdk,l is the crosscorrelation vector between the input
vector ¯r and the desired response dk,l, and R¯r is the input signal crosscorrelation matrix. Adaptive
ﬁltering can be implemented by using a number of algorithms.
5.4.1.1
The steepest descent algorithm
In this case we have
w(n+1)
k,l
= w(n)
k,l −µ∇k,l
(5.169)

226
MULTIUSER COMMUNICATION
*
*
Channel
estimator
Adaptive
FIR wkl
(n)
LMS
Channel
estimator
Adaptive
FIR wkl
(n)
LMS
Σ
)
(n
r
)
(
,ˆ n
l
kc
)
(
,ˆ n
L
kc
)
(
,
n
l
ky
)
(
,
n
L
ky
)
(
,
n
l
ke
)
(
,
n
L
ke
)
(
,
n
l
kd
)
(
,
n
L
kd
)
(ˆ n
kb
+
-
+
-
•
•
•
•
•
•
Figure 5.24 Block diagram of the adaptive LMMSE–RAKE receiver.
where ∇is the gradient of

Jk,l = E
'''ck,l Akbk −wH
k,lr
'''
2
(5.170)
This can be represented as
∇k,l =
∂Jk,l
∂Re{wk,l} + j
∂Jk,l
∂Im{wk,l} = 2 ∂Jk,l
∂w∗
k,l
(5.171)
If the processing window M = 1 we have ¯r(n) = r(n) ˆ= r and
∇k,l = −2E[r(ck,l Akbk)∗] + 2E[rrH]wk,l
= −2Rrdk,l + 2Rrwk,l
(5.172)
where dk,l = ck,l Akbk. If we assume that Ak = 1, ∀k
w(n+1)
k,l
= w(n)
k,l −2µ

Rrdk,l −Rrw(n)
k,l

(5.173)
As a stochastic approximation, Equation (5.172) can be represented as
∇k,l ≈−2r(ck,lbk)∗+ 2rrHw(n)
k,l = −2r(ck,lbk)∗+ 2ry∗
k,l

SINGLE USER LMMSE RECEIVERS FOR FSFC
227
combiner
to
)
N
n
(
k
bˆ
−
*
Pilot
MF
MF
l
k,
s
LMS
Σ
+1
2
1
N
N·T
)
(n
r
)
(
,
N
n
l
ke
−
)
(
,ˆ
N
n
l
kc
−
)
(
,
N
n
l
kd
−
+
-
)
(
,
N
n
l
ky
−
1/T
1/T
Adaptive
FIR xk,l
(n)
Figure 5.25 Block diagram of one receiver branch in the adaptive LMMSE–RAKE receiver.
From this equation, and assuming that M > 1, the LMS algorithm for updating the ﬁlter coefﬁ-
cients results in
w(n+1)
k,l
= w(n)
k,l + 2µ¯r(n)
c(n)
k,l b(n)
k
−y(n)
k,l
∗
∈CMSG
(5.174)
We decompose Equation (5.174) into adaptive and ﬁxed components as:
w(n)
k,l = ¯sk,l + x(n)
k,l ∈CMSG
(5.175)
where x(n)
k,l is the adaptive ﬁlter component and
¯sk,l =

0T
(DSG+τk,l)×1, sT
k ,
0T
(DSG−τk,l)×1
T
(5.176)
is the ﬁxed spreading sequence of the kth user with the delay τk,l. In this case every branch from
Figure 5.24 can be represented as shown in Figure 5.25.
In this case, Equation (5.47) gives:
x(n+1)
k,l
= x(n)
k,l −2µ(n)
k,l

c(n)
k,l b(n)
k
−y(n)
k,l
∗
¯r(n) = x(n)
k,l −2µ(n)
k,le∗(n)
k,l ¯r(n)
µ(n)
k,l = µ/(¯rH(n)¯r(n));
0 < µ < 1
e(n)
k,l = d(n)
k,l −y(n)
k,l
(5.177)
The reference signal is
d(n)
k,l = ˆc(n)
k,l b(n)
k
or
d(n)
k,l = ˆc(n)
k,l ˆb(n)
k
(5.178)
and the channel estimator is using a pilot channel
ˆc(n)
k,l =
1
2N + 1
N

i=−N
¯sT
p,l ¯r(n−i)
(5.179)
To illustrate the system operation the following example is used [126]: carrier frequency 2.0 GHz,
symbol rate 16 kbit/s, 31 chip Gold code and rectangular chip waveform. A synchronous downlink
with equal energy two-path (L = 2) Rayleigh fading channel with vehicle speeds of 40 km/h (which
results in the maximum normalized Doppler shift of 4.36 × 10−3) and maximum delay spread of ten
chip intervals. The number of users examined was 1–30 including the unmodulated pilot channel. The
average energy was the same for the pilot channel and user data channels. A simple moving average

228
MULTIUSER COMMUNICATION
BER
10−4
10−3
10−2
10−1
100
10−5
0
2
4
6
8
10
12
14
16
18
20
Average SNR (dB)
Single-user bound
Two-path fading channel
LMMSE−RAKE, K = 10
RAKE, K = 10
LMMSE−RAKE, K = 20
RAKE, K = 20
LMMSE−RAKE, K = 30
RAKE, K = 30
Figure 5.26 Simulated bit error rates as a function of the average SNR for the conventional
RAKE and the adaptive LMMSE–RAKE in a two-path fading channel for
vehicle speeds of 40 km/h with different numbers of users [126].
smoother of length eleven symbols was used in a conventional channel estimator. Perfect channel
estimation and ideal truncated precombining LMMSE receivers were used in the analysis to obtain
the bit error probability lower bounds. The receiver processing window is three symbols (M = 3)
unless otherwise stated. The adaptive algorithm used in the simulations was normalized LMS with
µ(n)
k,l =
1
100 · (2D + 1)SG

¯rH(n)
k,l ¯r(n)
k,l
−1
.
(5.180)
The simulation results were produced by averaging over the BERs of randomly selected users with
different delay spreads.
The simulation results are shown in Figure 5.26. In general, one can notice that the improvement
gains are lower than in the case of multiuser detectors. In the presence of a strong near–far effect, the
improvements should be more evident.
5.4.1.2
Blind adaptive LMMSE–RAKE
In this case, in Equation (5.170) we use estimates of bits ˆbk,l instead of bk,l [95–98]:
x(n+1)
k,l
= x(n)
k,l + 2µ(n)
k,l

c(n)
k,l ˆb(n)
k,l −y(n)
k,l
∗
¯r(n)
(5.181)
The MSE criterion now gives
w[MSE]k,l = R−1
¯r R¯rdk,l = R−1
¯r ¯sk,l E⌊|ck,l|2⌋
(5.182)
Similarly, the minimum output energy criteria deﬁned as
MOE(E⌊|yk,l|2⌋)
(5.183)
gives
w[MOE]k,l = R−1
¯r ¯sk,l
( !¯sT
k,lR−1
¯r ¯sk,l
"
(5.184)

SINGLE USER LMMSE RECEIVERS FOR FSFC
229
An implementation example can be seen in [130]. The stochastic approximation of the gradient of
Equation (5.172) for the MOE criterion gives
∇k,l = ¯r(n)¯rH(n)wk,l
(5.185)
If we want to keep the useful signal autocorrelation unchanged, Equation (5.184) should be
constrained to satisfy ¯sT
k,lx(n)
k,l = 0. The orthogonality condition is maintained at each step of the
algorithm by projecting the gradient onto the linear subspace orthogonal to ¯sT
k,l. In practice, this is
accomplished by subtracting an estimate of the desired signal component from the received signal
vector. An implementation can be seen in [131]. So, we have:
x(n+1)
k,l
= x(n)
k,l −2µ(n)
k,l ¯rH(n)
¯sk,l + x(n)
k,l
 !¯r(n) −Fk,l
!
FT
k,l ¯r(n)""
(5.186)
where
Fk,l =


0T
τk,l×1, sT
k ,
0T
(2DSG−τk,l)×1
0T
(SG−τk,l)×1,
sT
k , 0T
((2D−1)SG−τk,l)×1
0T
(2DSG+τk,l)×1,
[sk(Ts), · · · , sk(Ts(SG −τk,l))]


T
∈RMSG×M
(5.187)
is a block diagonal matrix of sampled spreading sequence vectors. Effectively, M separate ﬁlters are
adapted.
5.4.1.3
Grifﬁths’s algorithm
In this case instead of assuming that vector R¯rdk,l is known, the instantaneous estimate for the
covariance is used, i.e.
R¯r ≈¯r(n)¯rH(n)
(5.188)
In this case the crosscorrelation is R¯rdk,l = E[|ck,l|2]¯sk,l, and Grifﬁths’s algorithm results in:
x(n+1)
k,l
= x(n)
k,l + 2µ(n)
k,l

E[|ck,l|2]Fk,llM −¯r*(n)
k,l

¯sk,l + x(n)
k,l
H
¯r(n)
(5.189)
In practice, the energy of multipath components (E[|ck,l|2]) is not known and must be estimated.
5.4.1.4
Constant modulus algorithm
In this case the optimization criterion is E[(|yk,l|2 −ω)2] where ω is the so-called constant modulus
(CM), set according to the received signal power, i.e ω = E[|ck,l|2] or ω(n) = |ck,l (n)|2. By using the
CM algorithm, it is possible to avoid the use of the data decisions in the reference signal in the
adaptive LMMSE–RAKE receiver by taking the absolute value of the estimated channel coefﬁcients
(|ˆc(n)
k,l |) in adapting the receiver. In the precombining LMMSE receiver framework, the cost function
for the BPSK data modulation is
E[∥ˆh|2 −|h|2|2]
(5.190)
The stochastic approximation of the gradient for the CM criterion is
∇(n+1)
k,l
=
'''y(n)
k,l
'''
2
−
'''ˆc(n)
k,l
'''
2
¯r(n)¯rH(n)wk,l
(5.191)
Hence, the constant modulus algorithm can be expressed as:
x(n+1)
k,l
= x(n)
k,l −2µ(n)
k,l y∗(n)
k,l
'''y(n)
k,l
'''
2
−
'''ˆc(n)
k,l
'''
2
¯r(n)
(5.192)

230
MULTIUSER COMMUNICATION
5.4.1.5
Constrained LMMSE–RAKE, Grifﬁths’s and constant
modulus algorithms
The adaptive LMMSE–RAKE, the Grifﬁths’s, and the constant modulus algorithm contain no con-
straints. By applying the orthogonality constraint ¯sT
k,lx(n)
k,l = 0 to each of these algorithms, an additional
term ¯sT
k,lx(n)
k,l ¯sk,l is subtracted from the new x(n+1)
k,l
update at every iteration. The constrained LMMSE–
RAKE receiver becomes [28, 34]:
x(n+1)
k,l
= x(n)
k,l + 2µ(n)
k,l

ˆc(n)
k,l ˆb(n)
k
−y(n)
k,l
∗
¯r(n) −¯sT
k,lx(n)
k,l ¯sk,l
(5.193)
The Grifﬁths’s and the constant modulus algorithms can also be deﬁned in a similar way.
5.4.2
Blind least squares receivers
All blind adaptive algorithms described in the previous section are based on the gradient of the
cost function. In practical adaptive algorithms, the gradient is estimated, i.e. the expectation in the
optimization criterion is not taken but is replaced in most cases by some stochastic approximation.
In fact, the stochastic approximation used in LMS algorithms is accurate only for small step sizes µ.
This results in rather slow convergence, which may be intolerable in practical applications.
Another drawback with the blind adaptive receivers presented above is the delay estimation.
Those receiver structures as such support only conventional delay estimation based on matched
ﬁltering (MF). The MF-based delay estimation is sufﬁcient for the downlink receivers in systems
with an unmodulated pilot channel, since the zero mean MAI can be averaged out if the rate of fading
is low enough. If CDMA systems do not have the pilot channel, it would be beneﬁcial to use some
near–far resistant delay estimators.
5.4.3
Least squares (LS) receiver
One possible solution to both the convergence and the synchronization problems is based on blind
linear least squares (LS) receivers. The cost function in this case is:
J[LS]k,l =
n

j=n−N+1

c( j)
k,l b( j)
k
−w
H(n)
k,l ¯r( j)2
(5.194)
where N is the observation window in symbol intervals. Filter weights are given as
w(n)
k,l = ˆR−1(n)
¯r
¯sk,l
(5.195)
ˆR−1(n)
¯r
denotes the estimated covariance matrix over a ﬁnite data block called the sample covariance
matrix. This matrix can be expressed as
ˆR(n)
¯r
=
n

j=n−N+1
¯r( j)¯r
H( j)
(5.196)
Analogous to the MOE criterion, the LS criterion can be modiﬁed as:
J[LS′]k,l =
n

j=n−N+1

w
H(n)
k,l ¯r( j)2
,
subject to wT
k,l¯sk,l = 1
(5.197)
which results in
w(n)
k,l =
ˆR−1(n)
¯r
¯sk,l
¯sT
k,l ˆR−1(n)
¯r
¯sk,l
(5.198)
The adaptation of the blind LS receiver means updating the inverse of the sample covariance. The
blind adaptive LS receiver is signiﬁcantly more complex than the stochastic gradient based blind
adaptive receivers. Recursive methods, such as the recursive least squares (RLS) algorithm, for

SINGLE USER LMMSE RECEIVERS FOR FSFC
231
updating the inverse and iteratively ﬁnding the ﬁlter weights are known. Also, the methods based on
eigendecomposition of the covariance matrix have been proposed to avoid explicit matrix inversion.
5.4.4
Method based on the matrix inversion lemma
The general relation
(A + BCD)−1 = A−1 −A−1B(DA−1B + C−1)−1DA−1
(5.199)
becomes
ˆR−1(n)
¯r
=

ˆR−1(n−1)
¯r
+ ¯r(n)¯r
H(n)−1
= R−1(n−1)
¯r
−R−1(n−1)
¯r
¯r(n)¯r
H(n)R−1(n−1)
¯r
1 + ¯r
H(n)R−1(n−1)
¯r
¯r(n)
(5.200)
In time-variant channels, the old values of the inverses must be weighted by the so-called forgetting
factor (0 < γ < 1), which results in:
ˆR−1(n)
¯r
= 1
γ
%
ˆR−1(n−1)
¯r
−
ˆR−1(n−1)
¯r
¯r(n)¯r
H(n) ˆR−1(n−1)
¯r
γ + ¯r
H(n) ˆR−1(n−1)
¯r
¯r(n)
&
(5.201)
It is sufﬁcient to initialize the algorithm as ˆR−1(0)
¯r
= I. For illustration purposes a numerical example
is shown in Figure 5.27 [126] and Table 5.3. System parameters are shown in the ﬁgure. In general,
one can see that the blind algorithms are inferior when compared with LMMSE–RAKE using pilot
symbols.
More information on the topic can be found in [99–106] and especially in the late publications
that include MIMO channels [107–113].
D
A
B
C
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
Excess MSE
1000
2000
3000
4000
5000
6000
Number of iterations (symbol intervals)
µ = 1/100 K = 10
A - Constant modulus algorithm
B - Griffiths’s algorithm
C - Blind adaptive MOE
D - Adaptive LMMSE−RAKE
Figure 5.27 Excess mean squared error as a function of the number of iterations for different
blind adaptive receivers in a two-path fading channel with vehicle speeds of
40 km/h, the number of active users K = 10, SNR = 20 dB, µ = 100−1 [126].

232
MULTIUSER COMMUNICATION
Table 5.3
The BERs of different blind adaptive receivers at an SNR of 20 dB in a two-path
Rayleigh fading channel at vehicle speeds of 40 km/h. The acronyms used are:
adaptive LMMSE–RAKE (LR), adaptive MOE (MOE), Grifﬁths’s algorithm
(GRA), constant modulus algorithm with average channel tap powers (CMA2),
constrained adaptive LMMSE–RAKE (C-LR), constrained constant modulus
algorithm (C-CMA), constrained Grifﬁths’s algorithm (C-GRA), constrained
constant modulus algorithm with average channel tap powers (C-CMA2) and
conventional RAKE (RAKE) [126]
K = 30
K = 15
Adaptive
receiver
µ = 100−1
µ = 10−1
µ = 100−1
µ = 10−1
µ = 2−1
LR
4.5 ×10−2
3.9 ×10−1
6.3 ×10−4
7.2 ×10−4
3.0 ×10−2
MOE
2.8 ×10−2
4.2 ×10−2
6.0 ×10−4
2.1 ×10−3
9.1 ×10−2
GRA
2.8 ×10−2
4.7 ×10−2
6.4 ×10−4
3.3 ×10−3
1.2 ×10−1
CMA
3.9 ×10−2
4.0 ×10−1
1.2 ×10−3
2.1 ×10−2
5.0 ×10−1
CMA2
3.3 ×10−2
4.0 ×10−1
1.8 ×10−3
2.1 ×10−2
5.0 ×10−1
C-LR
3.2 ×10−2
4.2 ×10−2
6.3 ×10−4
6.4 ×10−4
1.9 ×10−3
C-CMA
3.3 ×10−2
5.0 ×10−1
6.1 ×10−4
3.8 ×10−1
5.0 ×10−1
C-GRA
2.8 ×10−2
4.2 ×10−2
6.1 ×10−4
2.3 ×10−3
9.7 ×10−2
C-CMA2
2.9 ×10−2
5.0 ×10−1
7.7 ×10−4
2.7 ×10−1
5.0 ×10−1
RAKE
3.1 ×10−2
3.1 ×10−2
7.1 ×10−3
7.1 ×10−3
7.1 ×10−3
5.5
SIGNAL SUBSPACE-BASED CHANNEL ESTIMATION
FOR CDMA SYSTEMS
The practical CDMA systems use the pilot signals for channel estimation enabling even the use of
a smoother for these purposes. While the solution is simple, it is very inefﬁcient in the presence
of Doppler or the near–far effect. The advanced channel estimation algorithms in CDMA systems
are based either on Kalman-type [114, 120–122] estimators for channels with high dynamics, or a
signal subspace-based approach in the presence of high levels of multiple access interference [116,
132–141]. The best performance is obtained if a joint detection of data and channel is used [117,
119]. Additional results including blind estimation are given in [123, 124, 142]. In this section we
present a multiuser channel estimation problem through a signal subspace-based approach [116]. For
these purposes the received signal for K users will be presented as:
r(t) =
K

k=1
rk(t) + ηt −∞< t < ∞
(5.202)
If the channel impulse response for user k is hk(t, τ) we have
rk(t) = hk(t, τ)∗sk(t)
=
 ∞
−∞
hk(t, α)sk(α) dα
(5.203)
If phase shift keying (PSK) is used to modulate the data, then the baseband complex envelope
representation of the kth user’s transmitted signal is given by
sk(t) =

2Pke jφk 
i
e j(2π
M)m(i)
k ak(t −iT )
(5.204)

SIGNAL SUBSPACE-BASED CHANNEL ESTIMATION FOR CDMA SYSTEMS
233
where Pk is the transmitted power, φk is the carrier phase relative to the local oscillator at the receiver,
M is the size of the symbol alphabet, m(i)
k ∈{0, 1, . . . , M −1} is the transmitted symbol, ak(t) is the
spreading waveform, and T is the symbol duration. The spreading waveform is given by
ak(t) =
N−1

n=0
)
Tc(t −nTc)a(n)
k
(5.205)
where T c(t) is a rectangular pulse, Tc is the chip duration (Tc = T/N), and {a(n)
k } for n =
0, 1, . . . , N −1 is a signature sequence (possibly complex-valued since the signature alphabet need
not be binary). The chip matched ﬁlter can be implemented as an integrate-and-dump circuit, and the
discrete time signal is given by
r[n] = 1
Tc
 (n+1)Tc
nT c
r(t) dt
(5.206)
Thus, the received signal can be converted into a sequence of WSS random vectors by buffering r[n]
into blocks of length N
yi = [r[i N] r[1 + i N] · · ·r[N −1 + i N]]T ∈CN
(5.207)
where the nth element of the ith observation vector is given by yi,n = r[n + i N]. Although each
observation vector corresponds to one symbol interval, this buffering was done without regard to the
actual symbol intervals of the users. Since the system is asynchronous, each observation vector will
contain at least the end of the previous symbol (left) and the beginning of the current symbol (right)
for each user. The factors due to the power, phase and transmitted symbols of the kth user may be
collected into a single complex constant c(i)
k , e.g. some constant times √2Pke j[φk+(2π
/M)m(i)
k ], and
Equation (5.207) becomes:
yi =
K

k=1

c(i−1)
k
ur
k + c(i)
k ul
k

+ ηi = Aci + ηi
(5.208)
where ηi = [ηi,0, . . . , ηi,N−1]T ∈CN is a Gaussian random vector. Its elements are zero mean with
variance σ 2 = N0/2Tc and are mutually independent.Vectors ur
k and ul
k are the right side of the kth
user’s code vector followed by zeros, and zeros followed by the left side of the kth user’s code
vector, respectively. In addition, we have deﬁned ci = [c(i−1)
1
c(i)
1 · · · c(i−1)
K
c(i)
K ]T ∈C2K and the signal
matrix. A = ⌊ur
1uℓ
1 · · · ur
Kuℓ
K⌋∈C N×2K. We will start with the assumption that each user’s signal goes
through a single propagation path with an associated attenuation factor and propagation delay. We
assume that these parameters vary slowly with time, so that for sufﬁciently short intervals the channel
is approximately a linear time-invariant (LTI) system. The baseband channel impulse response can
then be represented by a Dirac delta function as hk(t, τ) = hk(t) = αkδ(t −τk), ∀τ, where αk is a
complex-valued attenuation weight and τk is the propagation delay. Since there is just a single path,
we assume that αk is incorporated into c(i)
k and concentrate solely on the delay.
Let us deﬁne v ∈{0, . . . , N −1} and γ ∈[0, 1) such that (τk/Tc) mod N = v + γ . If γ = 0, i.e.
the received signal is precisely aligned with the chip matched ﬁlter and only one chip will contribute
to each sample, the signal vectors become:
ur
k = ar
k(v) ≡

a(N−v)
k
· · · a(N−1)
k
0 · · · 0
T
ul
k = al
k(v) ≡

0 · · · 0
a(0)
k · · · a(N−v−1)
k
T
(5.209)
Since the chip matched ﬁlter is just an integrator, the samples for a non-zero γ can be represented as:
ur
k = (1 −γ )ar
k(v) + γ ar
k(v + 1)
ul
k = (1 −γ )al
k(v) + γ al
k(v + 1)
(5.210)

234
MULTIUSER COMMUNICATION
For the more general case of a multipath transmission channel with L distinct propagation paths, the
impulse response becomes a series of delta functions
hk(t, τ) = hk(t) =
L

p=1
αk,pδ(t −τk,p)
(5.211)
The signal vectors can be represented as
ur
k =
L

p=1
αk,p

(1 −γk,p)ar
k(vk,p) + γk,par
k(vk,p + 1)

ul
k =
L

p=1
αk,p

(1 −γk,p)al
k(vk,p) + γk,pal
k(vk,p + 1)

(5.212)
If we introduce the following notation
Ur
k =
*
ar
k(0) · · · ar
k(N −1)
+
∈CN×N
Ul
k =
,
al
k(0) · · · al
k(N −1)
-
∈CN×N
(5.213)
where the as
k are as deﬁned in Equation (5.209), then the signal vectors may be expressed as a linear
combination of the columns of these matrices
ur
k = Ur
khk
ul
k = Ul
khk
(5.214)
where hk is the composite impulse response of the channel and the receiver front end, evaluated
modulo the symbol period. Thus, the nth element of the impulse response is given by
hk,n =
∞

j=0
1
Tc

jT +(n+1)Tc
jT +nTc
hk(t)∗)
Tc(t) dt
(5.215)
For delay spread Tm < T/2, at most two terms in the summation will be non-zero.
5.5.1
Estimating the signal subspace
The correlation matrix of the observation vectors is given by:
R = E⌊yiy†
i ⌋= ACA† + σ 2I
(5.216)
where C = E⌊cic†
i ⌋∈C2K×2K is diagonal. The correlation matrix can also be expressed in terms of
its eigenvector decomposition:
R = VDV†
(5.217)
where the columns of V ∈CN×N are the eigenvectors of R, and D is a diagonal matrix of the
corresponding eigenvalues (λn). Details of eigenvector decomposition are given in Appendix 5.1.
Furthermore,
λn =
 dn + σ 2,
if n ≤2K
σ 2,
otherwise
(5.218)
where dn is the variance of the signal vectors along the nth eigenvector and we assume that 2K < N.
Since the 2K largest eigenvalues of R correspond to the signal subspace, V can be partitioned
as V = [VSVN], where the columns of VS = [vS,1 · · · vS,2K] ∈CN×2K form a basis for the signal
subspace SY, and VN = [vN,1 · · · vN,N−2K] ∈CN×N−2K spans the noise subspace NY. Readers less
familiar with eigenvalue decomposition are referred to Appendix 5.1. Since we would like to track

SIGNAL SUBSPACE-BASED CHANNEL ESTIMATION FOR CDMA SYSTEMS
235
slowly varying parameters, we form a moving average or a Bartlett estimate of the correlation matrix
based on the J most recent observations:
ˆRi = 1
J
i
j=i−J+1
y jy†
j
(5.219)
It is well known [143] that the maximum likelihood estimate of the eigenvalues and associated
eigenvectors of R is just the eigenvector decomposition of ˆRi. Thus, we perform an eigenvalue
decomposition of ˆRi and select the eigenvectors corresponding to the 2K largest eigenvalues as a
basis for ˆSY.
5.5.2
Channel estimation
Consider the projection of a given user’s signal vectors into the estimated noise subspace
er
k =

ur†
k ˆVN
T
el
k =

ul†
k ˆVN
T



∈CN−2K
(5.220)
If ur
k and ul
k both lie in the signal subspace, then their sum uk = ur
k + ul
k must also be contained in
VS. The projection of uk into the estimated noise subspace
˜ek = (u†
k ˆVN)T
(5.221)
is a Gaussian random vector [115] and thus has probability density function
p˜e(˜ek) =
1
det[π K] exp{−˜e†
kK−1˜ek}
(5.222)
The covariance matrix K is a scalar multiple of the identity given by
K = 1
J u†
kQukI
(5.223)
and
Q = σ 2
 2K

k=1
λk
(σ 2 −λk)2 vS,kv†
S,k
	
(5.224)
Therefore, within an additive constant, the log likelihood function of ˜ek is:
(˜ek) = −(N −2K) ln(u†
kQuk) −J
˜e†
k ˜ek
u†
kQuk
= −(N −2K) ln(u†
kQuk) −J u†
kVNV†
Nuk
u†
kQuk
(5.225)
The exact VN and Q are unknown, but we may replace them with their estimates. The best estimates
will minimize ˜ek, which will result in the maximum of the likelihood function.
Unfortunately, maximizing this likelihood function is prohibitively complex for a general multipath
channel, so we will consider only a single propagation path. In this case, the vector uk is a function
of only one unknown parameter: the delay τk. To form the timing estimate, we must solve
ˆτk = arg max  (uk)
τk∈[0,T )
(5.226)
Ideally, we would like to differentiate the log likelihood function with respect to τ. However, the
desired user’s delay lies within an uncertainty region, τk ∈[0, T ], and uk(τ) is only piecewise
continuous on this interval. To deal with these problems, we divide the uncertainty region into N cells

236
MULTIUSER COMMUNICATION
of width Tc and consider a single cell, cv ≡[vTc, (v + 1)Tc). We again deﬁne v ∈{0, . . . , N −1} and
γ ∈[0, 1) such that (τ/Tc) mod N = v + γ , and for τ ∈cv the desired user’s signal vector becomes
uk{τ} = (1 −γ )uk(v) + γ uk(v + 1)
(5.227)
and
d
dτ uk(τ) = uk(v + 1) −uk(v)
= a constant
(5.228)
Thus, within a given cell, we can differentiate the log likelihood function and solve for the
maximum in closed form. We then choose whichever of the N solutions yields the largest value for
Equation (5.226). Details can be found in [116].
Under certain conditions, it may be possible to simplify this algorithm. Note that maximizing the
log likelihood function (5.226) is equivalent to maximizing
(˜ek) = −N −2K
J
ln(u†
kQuk) −u†
kVNV†
Nuk
u†
kQuk
(5.229)
As J →∞, the leading term goes to zero; thus, for large observation windows, we can use the
following approximation:
(˜ek) ≈−u†
kVNV†
Nuk
u†
kQuk
(5.230)
This yields a much simpler expression for the stationary points [116]. The MUSIC (Multiple Signal
Classiﬁcation) algorithm is equivalent to Equation (5.29) when one only maximizes the numerator
and ignores the denominator, i.e. one assumes u†
kQuk is equal to one in Equation (5.28) or Equation
(5.29). This yields an even simpler approximation for the log likelihood function
(˜ek) ≈−u†
kVNV†
Nuk
(5.231)
which further simpliﬁes the solution for the stationary points [116].
For illustration purposes, the simulation results for ﬁve users with length 31 Gold codes are
presented in Figures 5.28–5.30.
A single desired user was acquired and tracked in the presence of strong multiple access inter-
ference (MAI). The power ratio between each of the four interfering users and the desired user is
designated the MAI level.
We ﬁrst compare the true log likelihood estimate, Equation (5.225), with the large observation
window approximation, Equation (5.29), and the MUSIC algorithm, Equation (5.30). This is done
for a window size of 200 symbols and with a varying SNR. Figure 5.28(a) shows the probability of
acquisition for each method, where acquisition is deﬁned as |τk −ˆτk| < 1/2Tc. Using the approximate
log likelihood function results in almost no drop in performance. Furthermore, when the SNR is poor,
both probabilistic approaches considerably outperform the MUSIC algorithm. In Figure 5.28(b), we
compare the RMSE of the delay estimate once acquisition has occurred, i.e. after processing enough
symbols to reach within half of one chip. The approximate log-likelihood function experiences a
slight increase in error at low SNR, but again both probabilistic methods do better than MUSIC.
The same parameters as a function of the window size are shown in Figure 5.29. One can say that
for J > 100 the performance curve settles down to steady state values. The RMSE versus MAI and
SNR are shown in Figure 5.30. One can see that for an extremely wide ranging near–far effect the
performance is good.
5.6
ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
Space–time trellis codes have a potential drawback in that the maximum likelihood decoder complex-
ity grows exponentially with the number of bits per symbol, thus limiting achievable data rates. In
Chapter 4.10 we discussed a layered space–time (LST) architecture that can attain a tight lower bound

ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
237
0
2
4
6
8
10
12
14
16
18
20
0
2
4
6
8
10
12
14
16
18
20
0.9
0.8
0.7
0.6
0.5
0.4
0.3
1
c
k
k
T
2
1
ˆ <
−τ
τ
Probability
of
acquisition
Simulations
31 Gold
ML
Approx.ML
MUSIC
Approx.ML
MUSIC
SNR (dB)
SNR (dB)
0
0.05
0.1
0.15
0.2
0.3
0.35
0.4
0.25
RMSE (Chips)
ML
(a)
(b)
Figure 5.28 (a) Probability of acquisition for the maximum likelihood estimator, the ap-
proximate ML and the MUSIC algorithm [K = 5, N = 31, J = 200, MAI =
20 dB]; (b) Root mean squared error (RMSE) of the delay estimate in chips for
the maximum likelihood (ML) estimator, the approximate ML and the MUSIC
algorithm [K = 5, N = 31, J = 200, MAI = 20 dB].
on the MIMO channel capacity with signiﬁcant reduction in complexity. In this section we further
generalize the LST concept and discuss a variety of receiver schemes based on iterative decoding and
interference cancellation algorithms as described in Sections 5.2–5.4.
5.6.1
LST architectures
There is a number of various LST architectures, depending on the way the modulated symbols
are assigned to transmit antennas. In uncoded LST structure, known as vertical layered space–time
(VLST) or vertical Bell Laboratories layered space–time (VBLAST), the input information sequence,
denoted by c, is ﬁrst demultiplexed into nT sub-streams and each of them is subsequently modulated
by an M-level modulation scheme and transmitted from a transmit antenna. The signal processing
chain related to an individual sub-stream is referred to as a layer. The modulated symbols are arranged
into a transmission matrix, denoted by X, which consists of nT rows and L columns, where L is the
transmission block length. The tth column of the transmission matrix, denoted by xt, consists of the

238
MULTIUSER COMMUNICATION
0
50
100
150
200                 250
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
J
Pr (acq.)
(a)
(b)
0
100
200
300
400
500
50
150
250
350
450
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
RMSE (Chips)
J
Tracking errors of the order of 0.1 chips can be
achieved with windows of less than 200 bits,
indicating that the algorithm can be used for tracking
of slowly time-varying parameters
Figure 5.29 (a) Probability of acquisition and (b) root mean squared error (RMSE) of
timing estimate in chips of the subspace-based maximum likelihood estimator
for varying window size [N = 31, SNR = 8 dB, K = 5, MAI = 20 dB] [116]
C⃝1996, IEEE.
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
RMSE (Chips)
0
10
20
30
40
50
5
15
25
35
45
MAI (dB)
Figure 5.30 RMSE of the subspace-based maximum likelihood estimator for varying MAI
level [K = 5, N = 31, J = 200, SNR = 8 dB].

ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
239
Information
source
Encoder
S/P
Mod
Mod
Int
Int
1
tx
T
n
tx
(a)
Information
source
Encoder
S/P
Mod
Mod
Int
Int
1
tx
T
n
tx
(b)
Encoder
Information
source
Encoder
S/P
Mod
Mod
Int
Int
1
tx
T
n
tx
(c)
Encoder
SI
Figure 5.31 LST transmitter architectures with error control coding: (a) an HLST architec-
ture with a single code: (b) an HLST architecture with separate codes in each
layer: (c) DLST and TLST architectures.
modulated symbols x1
t , x2
t , . . . , xnT
t , where t = 1, 2, , L At a given time t, the transmitter sends the tth
column from the transmission matrix, one symbol from each antenna. That is, a transmission matrix
entry xi
t is transmitted from antenna i at time t. Vertical structuring refers to transmitting a sequence
of matrix columns in the space–time domain This simple transmission process can be combined with
conventional block or convolutional one-dimension codes, to improve the performance of the system.
The term ‘one-dimensional’ refers to the space domain, while these codes can be multidimensional
in the time domain. The block diagrams of various LST architectures with error control coding are
shown in Figure 5.31.
In the horizontal layered space–time (HLST) architecture, shown in Figure 5.31(a), the information
sequence is ﬁrst encoded by a channel code and subsequently demultiplexed into nT sub-streams.
Each sub-stream is modulated, interleaved and assigned to a transmit antenna.
If the modulator output symbols are denoted by xi
t , where i represents the layer index and t is the
time interval, the transmission matrix, formed from the modulator outputs, denoted by X, is given by
X =
,
xi
t
-
(5.232)

240
MULTIUSER COMMUNICATION
In a system with three transmit antennas, the transmission matrix X is given by
X =


x1
1
x1
2
x1
3
x1
4
· · ·
x2
1
x2
2
x2
3
x2
4
· · ·
x3
1
x3
2
x3
3
x3
4
· · ·


(5.233)
The sequence
x1
1, x1
2, x1
3, x1
4, . . . is
transmitted from antenna
1, the sequence
x2
1, x2
2,
x2
3, x2
4, . . . from antenna 2 and the sequence x3
1, x3
2, x3
3, x3
4, . . . transmitted from antenna 3.
An HLST architecture can also be implemented by splitting the information sequence into nT
sub-streams, as shown in Figure 5.31(b). After that, each sub-stream is encoded independently by
a channel encoder, interleaved, modulated and then transmitted by a particular transmit antenna.
We assume that channel encoders for various layers are identical although different coding in each
sub-stream can be used.
A better performance is achieved by a diagonal layered space–time (DLST) architecture as
discussed in Section 4.16, in which a modulated codeword for each encoder is distributed among
the nT antennas along the diagonal of the transmission array. For example, the DLST transmission
matrix, for a system with three antennas, is formed from matrix X in (5.233), by delaying the ith
row entries by (i −1) time units, so that the ﬁrst nonzero entries lie on a diagonal in X. The entries
below the diagonal are padded by zeros. Then the ﬁrst diagonal is transmitted from the ﬁrst antenna,
the second diagonal from the second antenna, the third diagonal from the third antenna, and then
the fourth diagonal from the ﬁrst antenna, etc. Hence the codeword symbols of each encoder are
transmitted over different antennas.
This can be represented by introducing a spatial interleaving SI after the modulators, as shown in
Figure 5.31(c). The spatial interleaving operation on for the DLST scheme can be represented as:


x1
1
x1
2
x1
3
x1
4
x1
5
x1
6
· · ·
0
x2
1
x2
2
x2
3
x2
4
x2
5
· · ·
0
0
x3
1
x3
2
x3
3
x3
4
· · ·

→


x1
1
x2
1
x3
1
x1
4
x2
4
x3
4
· · ·
0
x1
2
x2
2
x3
2
x1
5
x2
5
· · ·
0
0
x1
3
x2
3
x3
3
x1
6
· · ·


(5.234)
The rows of the matrix on the right-hand side of Equation (5.234) are obtained by concatenating the
corresponding diagonals of the matrix on the left-hand side. The ﬁrst row of this matrix is transmitted
from the ﬁrst antenna, the second row from the second antenna and the third row from the third
antenna. The diagonal layering introduces space diversity and thus achieves a better performance
than the horizontal one. It is important to note that there is a spectral efﬁciency loss in DLSV, since a
portion of the transmission matrix on the left-hand side of Equation (5.234) is padded with zeros
A threaded layered space–time (TLST) structure [144] is obtained from the HLSI by introducing
a spatial interleaver SI prior to the time interleavers, as shown in Figure 5.31(c). In a system with
nT = 3, the operation of SI can be expressed as


x1
1
x1
2
x1
3
x1
4
· · ·
x2
1
x2
2
x2
3
x2
4
· · ·
x3
1
x3
2
x3
3
x3
4
· · ·

→


x1
1
x3
2
x1
3
x1
4
...
x2
1
x1
2
x3
3
x2
4
...
x3
1
x3
2
x1
3
x3
4
...


(5.235)
in which an element of the modulation matrix, shown on the left-hand side of Equation (5.235)
denoted by xi
t , represents the modulated symbol of layer i at time t. The matrix X ′on the right-hand
side of Equation (5.235), is the TLST transmission matrix. The modulated symbols x1
1, x3
2, x2
3, x1
4, . . .
generated by modulators in layers 1, 3, 2 and 1, respectively, are transmitted from antenna 1.
The spatial interleaver of the TLST can be represented by a cyclic-shift interleaver as follows. If
we denote the left-hand side matrix in Equation (5.235) by X, the ﬁrst column of the transmission
matrix X′ is identical to the ﬁrst column of the modulated matrix X. The second column of X′ is
obtained by a cyclic shift of the second column of X by one position from the top to the bottom. The

ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
241
third column of X ′ is obtained by a cyclic shift of the third column of X by two positions, while the
fourth column of X′ is identical to the fourth column of X, etc. In general, if we denote the entries of
X′ by xi′
t , the mapping of xi
t to xi′
t can be expressed as xi′
t = xi
t , i′ = [(i + t −2) mod nT ] + 1.
The spectral efﬁciency HLST and TLST schemes is RmnT , where R is the code rate and m is the
number of bits in a modulated symbol, while the spectral efﬁciency of the DLST is slightly reduced
due to zero padding in the transmission matrix.
5.6.2
LST receivers
In this section we discuss receiver structures for layered space–time architectures. For simplicity,
horizontal layering with binary channel codes and BPSK modulation are assumed. Extension to
nonbinary codes and to multilevel modulation schemes is straightforward.
The transmit diversity introduces spatial interference. The signals transmitted from various an-
tennas propagate over independently scattered paths and interfere with each other upon reception at
receiver. This interference can be represented by the following matrix operation:
rt = Hxt + nt
(5.236)
where rt is an nR component column matrix of the received signals across the nR receive antennas,
xt is the tth column in the transmission matrix X and nt is an nR-component column matrix of the
AWGN noise signals from the receive antennas. The noise variance per receive antenna is σ 2. In a
structure with spatial interleaving, vector xt is the tth column of the matrix at the output of the spatial
interleaver, denoted by X′. In order to simplify the notation, we omit the subscripts in vectors rt, xt
and nt and refer to them as r, x, and n, respectively.
In accordance with the discussion presented so far in this chapter, an LST structure can be viewed
as a synchronous CDMA in which the number of transmit antennas is equal to the number of users.
Similarly, the interference between antennas is equivalent to multiple access interference (MAI) in
CDMA systems, while the complex fading coefﬁcients correspond to the spreading sequences. This
analogy can be further extended to receiver strategies, so that multiuser receiver structures derived for
CDMA in Sections 5.2–5.4 can be directly applied to LST systems. Under this scenario, the optimum
receiver for an uncoded LST system is a maximum likelihood (ML) multiuser detector operating on
a trellis. It computes ML statistics (see Equation (5.49)) as in the Viterbi algorithm. The complexity
of this detection algorithm is exponential in the number of the transmit antennas.
For coded LST schemes, the optimum receiver performs joint detection and decoding on an overall
trellis obtained by combining the trellises of the layered space–time code and the channel code. The
complexity of the receiver is an exponential function of the product of the number of the transmit
antennas and the code memory order. In this section we will examine a number of less complex
receiver structures that have good performance/complexity trade-offs.
The original VLST receiver , described in Section 4.10, is based on a combination of interference
suppression and cancellation. Conceptually, each transmitted sub-stream is considered to be the
desired symbol and the remainder are treated as interferers. In [145] these interferers are suppressed
by a zero forcing (ZF) approach which corresponds to decorrelating detector discussed in Section
5.2.2. This detection algorithm produces ZF-based decision statistics for a desired sub-stream from
the received signal vector r, which contains a residual interference from other transmitted sub-
streams. Subsequently, a decision on the desired sub-stream is made from the decision statistics and
its interference contribution is regenerated and subtracted out from the received vector r. Thus r
contains a lower level of interference and this will increase the probability of correct detection of
other sub-streams.
This operation is illustrated in Figure 5.32 where, the ﬁrst detected sub-stream is nT . The detected
symbol is subtracted from all other layers. These operations are repeated for the lower layers, until
layer 1 is detected. Assuming that all symbols at previous layers have been detected correctly, the
decision statistics for layer 1 will be free from interference. The soft decision statistics (see Section
2.3) from the detector at each layer are passed to a decision making device in a VBLAST system. In

242
MULTIUSER COMMUNICATION
 
1
x 2
x 3
x
i 1
x −
i 1
x +
nT
x
Interference
Suppressed
Current detected signal
Cancelled
−
ix
+
Figure 5.32 VLST detection based on combined interference suppression and successive
interference cancellation (IS/SIC).
coded LST schemes, the decision statistics are passed to the channel decoder, which makes the hard
decision on the transmitted symbol in this sub-stream. The hard symbol estimate is used to reconstruct
the interference from this sub-stream, which then fed back to cancel its contribution while decoding
the next sub-stream.
The ZF strategy is only possible if the number of receive antennas at least as large as the number
of transmit antennas. Another drawback of this approach is that achievable diversity depends on a
particular layer. If the ZF strategy is used in removing interference and if nR receive antennas are
available, it is possible to remove ni = nR −do interferences with diversity order of do [146]. The
diversity order can be expressed as do = nR −ni.
If the interference suppression starts at layer nT , then at this layer (nT −1) interferers need to be
suppressed. Assuming that nR = nT , the diversity order in this layer 1. In the ﬁrst layer, there are
no interfernce to be suppressed, so the diversity order is nR = nT As different layers have different
diversity orders, diagonal layering is required to achieve equal performance of various encoded
streams.
Apart from the original BLAST receivers we will consider minimum mean square error (MMSE)
detectors, discussed in Section 5.3 and iterative receivers. The iterative receiver [147, 148] based on
the turbo processing principle introduced in Section 2.3.1, is the architecture with the best complex-
ity/performance trade-off. Its complexity grows linearly with the number of transmit antennas and
transmission rate.
5.6.3
QR Decomposition/SIC detecor
As discussed in Appendix 4.1, any nR × nT matrix H, where nR ≥nT , can be decomposed as
H = URR, where UR is an nR × nT unitary matrix and R is an nT × nT upper triangular matrix, with
entries (Ri, j)t = 0, for i > j, i, j = 1, 2, . . . , nT , represented as:
R =


!
R1,1
"
t
!
R1,2
"
t
· · ·
!
R1,nT
"
t
0
!
R2,2
"
t
· · ·
!
R2,nT
"
t
0
0
· · ·
!
R3,nT
"
t
...
...
...
...
0
0
· · ·
!
RnT ,nT
"
t


(5.237)

ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
243
If we introduce an nT -component column matrix y obtained by multiplying from the left the
receive vector r, given by Equation (5.237), by UT
R then we have y = UT
Rr or y = UT
RHx + UT
Rn.
Substituting the QR decomposition of H, we get y = Rx + n′, where n′ = UT
Rn is an nT -component
column matrix of i.i.d AWGN noise signals. As R is upper-triangular, the ith component in y depends
only on the ith and higher layer transmitted symbols at time t, as follows:
yi
t =
!
Ri,i
"
t xi
t + n
′i
t +
nT

j=i+t
!
Ri, j
"
t x j
t
(5.238)
Consider xt
t as the current desired detected signal. Equation (5.238) shows that y j
t contains a lower
level of interference than in the received signal rt, as the interference from xl
t, for l < i, are suppressed.
The third term in Equation (5.238) represents contributions from other interferers xi+1
t
, xi+2
t
, . . . , xnT
t ,
which can be cancelled by using the available decisions ˆxi+1
t
, ˆxi+2
t
, . . . , ˆxnT
t , that have been detected.
The decision statistics on xi
t , denoted by yi
t , can be rewritten as:
yi
t =
nT

j=i
!
Ri, j
"
t x j
t + n′i
t
i = 1, 2, . . . , nT
(5.239)
The estimate on the transmitted symbol xi
t is given by
x′i
t = q


yi
t −
nT
j=i+1
!
Ri, j
"
t ˆx j
t
!
Ri,i
"
t

i = 1, 2, . . . , nT
(5.240)
where q(x) denotes the hard decision on x. A QR factorization algorithms are discussed in Appendix
4.1.
For a system with three transmit antennas, the decision statistics for various layers can be
expressed as
y1
t = (R1,1)tx1
t + (R1,2)tx2
t + (R1,3)tx3
t + n′1
y2
t = (R2,2)tx2
t + (R2,3)tx3
t + n′2
y3
t = (R3,3)tx3
t + n′3
The estimate on the transmitted symbol x3
t , denoted by ˆx3
t , can be obtained from y3
t as
ˆx3
t = q

y3t
(R3,3)t

The contribution of ˆx3
t is cancelled from y2
t and the estimate on x2
t is obtained as
ˆx2
i = q

y2t −(R2,3)t ˆx3t
(R2.2)t

Finally, after cancelling out ˆx3
t and ˆx2
t , we obtain for
ˆx1
t ˆx1
t = q

y1t −(R1,3)t ˆx3t −(R1,2)t ˆx2t
(R1,1)t

The described algorithm applies to VBLAST. In coded LST schemes, the soft decision statistics on
xi
t , given by the arguments in the q(·) expressions are passed to the channel decoder, which estimates
ˆxi
t.
In the above example the decision statistic ynT
t
is computed ﬁrst, then ynT −1
t
, and so on. The
performance can be improved if the layer with the maximum SNR is detected ﬁrst, followed by the
one with the next largest SNR and so on [149].

244
MULTIUSER COMMUNICATION
5.6.4
MMSE/SIC detector
In the MMSE detection algorithm introduced in Section 5.3, the expected value of the mean square
error between the transmitted vector x and a linear combination of the received vector WHr is
minimized. With this notation Equation (5.123) becomes:
min E
!
x −WHr
"2
(5.241)
where W is an nR × nT matrix of linear combination coefﬁcients given by:
WH =
,
HHH + σ 2InT
-−1 HH
(5.242)
σ 2 is the noise variance and InT is an nT × nT identity matrix. The decision statistics for the symbol
sent from antenna i at time t is obtained as:
yi
t = WH
i r
(5.243)
where WH
i is the ith row of WH consisting of nR components. The estimate of the symbol sent by
antenna i, denoted by ˆxi
t, is obtained by making a hard decision on yi
t :
ˆxt
i = q
!
yt
i
"
(5.244)
In an algorithm with interference suppression only, the detector calculates the hard decisions
estimates by using Equations (5.243) and (5.244) for all transmit antennas. In a combined interference
suppression and interference cancellation, the receiver starts from antenna nT and computes its signal
estimate by using Equations (5.243) and (5.244). The received signal r in this level is denoted by rnT .
For calculation of the next antenna signal (nT −1), the interference contribution of the hard estimate
ˆxnT
t
is subtracted from the received signal rnT and this modiﬁed received signal, denoted by rnT −1, is
used in computing the decision statistics for antenna (nT −1) in Equation (5.243) and its hard estimate
from Equation (5.244). In the next level, corresponding to antenna (nT −2), the interference from
nT −1 is subtracted from the received signal rnT −1 and this signal is used to calculate the decision
statistics in Equation (5.243) for antenna (nT −2). This process continues for all other levels up to
the ﬁrst antenna. After detection of level i, the hard estimate ˆxi
t is subtracted from the received signal
to remove its interference contribution, giving the received signal for level i −1:
ri−1 = ri −ˆxi
t hi
(5.245)
where hi is theith column in the channel matrix H, corresponding to the path attenuations from antenna
i. The operation ˆxi
t hi in Equation (5.245) replicates the interference contribution caused by ˆxi
t in the
received vector. ri−1 is the received vector free from interference coming from ˆxnT
t , ˆxnT −1
t
, . . . , ˆxi
t .
For estimation of the next antenna signal xi−1
t
, this signal ri−1 is used in Equation (5.243) instead
of r. Finally, a deﬂated version of the channel matrix is calculated, denoted by Hi−1
d
, by deleting a
column from Hi
d. The deﬂated matrix Hi−1
d
at the (nT −i + 1)th cancellation step is given by:
Hi−1
d
=


h1,1
h1,2
· · ·
h1,i−1
h2,1
h2,2
· · ·
h2,i−1
...
...
...
...
hnR,1
hnR,2
· · ·
hnR,i−1


(5.246)
This deﬁnition is needed as the interference associated with the current symbol has been removed.
This deﬂated matrix Hi−1
d
is used in Equation (5.242) for computing the MMSE coefﬁcients and
the signal estimate from antenna i −1. Once the symbols from each antenna have been estimated,

ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
245
the receiver repeats the process on the vector rt+1 received at time (t + 1). The algorithm can be
summarized by the following pseudo code
MMSE/SIC Algorithm
Set i = nT
and rnT = r
while i ≥1
{
WH = [HHH + σ 2InT ]−1HH
yi
t = WH
i ri
ˆxt
i = q(yt
i )
ri−1 = ri −ˆxi
t hi
Compute Hi−1
d
by deleting column i from Hi
d.
H = Hi−1
d
i = i −1
}
The receiver can be implemented without the interference cancellation step of Equation (5.245),
which will reduce system performance but some computational cost can be saved. Using cancel-
lation requires that MMSE coefﬁcients be recalculated at each iteration, as H is deﬂated. With no
cancellation, the MMSE coefﬁcients are only computed once, as n remains unchanged. The most
computationally intensive operation detection algorithm is the computation of the MMSE coefﬁ-
cients. A direct calculation of the MMSE coefﬁcients based on Equation (5.242), has a complexity
polynomial in the number of transmit antennas. However, on slow fading channels, it is possible
to implement adaptive MMSE receivers with the complexity being linear in the number of transmit
antennas.
The described algorithm is for uncoded LST systems. The same detector can be applied to
coded systems. The receiver consists of the MMSE interference suppressor/ canceller (MMSE/SIC)
followed by the decoder. The decision statistics yi
t , from Equation (5.243), is passed to the decoder
which makes the decision on the symbol estimate ˆxi
t.
The performance of a QR decomposition receiver (QR), the linear MMSE (LMMSE) detector and
the performance of the last detected layer in MMSE/SIC are shown for a VBLAST structure with
nT = 4, nR = 4 and BPSK modulation on a slow Rayleigh fading channel in Figure 5.33. The ﬁgure
also shows the interference free (single layer) BER which is given by [150]
Pb =

1
2 (1 −µ)
nR k=nR−1

k=0

1
2 (1 + µ)
k
(5.247)
where µ =
4
γb
nR
1+ γb
nR
and γb = Eb
No .
One of the disadvantages of the MMSE scheme with successive interference cancellation is that
the ﬁrst desired detected signal to be processed sees all the interference from the remaining (nT −1)
signals, whereas each antenna signal to be processed later sees less and less interference as the
cancellation progresses. This problem can be alleviated either by ordering the layers to be processed
in decreasing signal power or by assigning power to the transmitted signals according to the processing
order. Another disadvantage of the successive scheme is that a delay of nT computation stages is
required to carry out the cancellation process.
The complexity of the LST receiver can be further reduced by replacing the MMSE interference
suppressor by a matched ﬁlter, resulting in interference cancellation only.

246
MULTIUSER COMMUNICATION
0
5
10
15
20
25
30
10−3
10−2
10−1
100
Eb/No (dB)
BER
QR  BPSK
LMMSE  BPSK
MMSE-IC  BPSK
Interference free bound
Figure 5.33 V-BLAST example, nT = 4, nR = 4, with QR decomposition, MMSE inter-
ference suppression and MMSE/SIC.
5.6.5
Iterative LST Receivers
The objective in the detection of space–time signals is to design a low-complexity detector, which
can efﬁciently remove multilayer interference and approach the interference free bound. The iterative
processing principle, as applied in turbo coding and discussed in Section 2.3.1, has been successfully
extended to joint detection and decoding [151–158]. This receiver can be applied only in coded
LST systems. Block diagrams of the iterative receivers for LST(a)–(c) architectures are shown
in Figure 5.34. In all three receivers, the detector provides joint soft-decision estimates of the nT
transmitted symbol sequences. In LST(a) the detected sequence is decoded by a single decoder with
soft inputs/soft outputs, while in LST (b) each of the detected sequences is decoded by a separate
channel decoder with soft inputs/soft outputs. At each iteration, the decoder soft outputs are used to
update the a priori probabilities of the transmitted signals. These updated probabilities are then used
to calculate the symbol estimate in the detector. Note that each of the coded streams is independently
interleaved to enable receiver convergence. In LST (c), apart from time interleaving/deinterleaving,
there is space interleaving/ deinterleaving across transmit antennas.
5.6.5.1
Iterative receiver (IR)/PIC
A block diagram of the standard iterative receiver (IR) with a parallel interference canceller (PIC-
STD) is shown in Figure 5.35 as IR/PIC structure. For simplicity we assume that an HLST architecture
with separate error control coding in each layer is used. In addition, the same convolutional codes
with BPSK modulation are selected in each layer. In the ﬁrst iteration, the PIC detectors are equivalent
to a bank of matched ﬁlters. The detectors provide decision statistics of the nT transmitted symbol
sequences. The decision statistics in the ﬁrst iteration, for antenna i and time t, denoted by yi,1
t , is
determined as yi.1
t
= hH
i r, where hH
i is the ith row of matrix HH. These decision statistics are passed
to the respective decoders, which generate soft estimates on the transmitted symbols. In the second
and later iterations, the decoder soft output is used to update the PIC detector decision statistics.
The decision statistics in the kth iteration at time t, for transmit antenna i denoted by yi.k
t , is given
by yi,k
t
= hH
i (r −H ˆX
k−1
i
) where ˆXk−1
i
is an nT × 1 column matrix with the symbol estimates from

1r
R
nr
Detector
Deint
Deint
P/S
Decoder
S/P
Int
Int
(LST-a)
1r
R
nr
Detector
Deint
Deint
Int
Int
(LST-b)
Decoder
Decoder
1r
R
nr
Detector
Deint
Deint
Int
Int
(LST-c)
Decoder
Decoder
l
SI−
SI
Figure 5.34 Block diagrams of iterative LSTC receivers; (LST-a) HLST with a single
decoder; (LST-b) HLST with separate decoders; (LST-c) DLST and TLST
receivers.
1y
1c
Deint
Dec
2
y
2c
Deint
Dec
n
T
y
n
T
c
Deint
Dec
Mod
Int
Mod
Int
2àx
Mod
Int
1àx
R
nr
2r
1r
PIC
n
T
àx
Figure 5.35 Iterative receiver with PIC-STD (IR/PIC-STD).

248
MULTIUSER COMMUNICATION
the (k −1) th iteration a s elements, except for the ith element which is set to zero. It can be written
as:
ˆxk−1
t
=
!ˆx1,k−1
t
, . . . , ˆxi−1,k−1
t
, 0, ˆxi+1,k−1
t
, . . . , ˆxnT ,k−1
t
"T
The detection outputs for layer i for a whole block of transmitted symbols form a vector, yi,k, which
is interleaved and then passed to the ith decoder.
The decoder in the kth iteration calculates the log-likelihood ratios (LLR) for antenna i at time t,
denoted by λi.k
t
and given by:
λi,k
t
= log P
!
xi,k
t
= 1|yi,k"
P
!
xi,k
t
= −1|yi,k"
where P(xi,k
t
= j|yi,k), j = 1, −1, are the symbol a posteriori probabilities (APP). The LLR can
be calculated by the iterative MAP algorithm (Appendix 2.1). The symbol a posteriori probabilities
P(xi,k
t
= j|yi,k), j = 1, −1, can be expressed as:
P
!
xi,k
t
= 1|yi,k"
=
eλi,k
t
1 + eλi,k
t ;
P
!
xi,k
t
= j|yi,k"
=
1
1 + e
λi,k
t
(5.248)
The estimates of the transmitted symbols are calculated by ﬁnding their mean:
ˆxi,k
t
= 1 · P
!
xi,k
t
= 1|yi,k"
+ (−1) · P
!
xi.k
t
= −1|yi,k"
By combining the above eqations we express the symbol estimates as functions of the LLR:
ˆxi,k
t
= eλi,k
t
−1
eλi,k
t
+ 1
(5.249)
When the LLR is calculated on the basis of the a posteriori probabilities, it is obtained as
λi,k
t
= log
m,m′=Ms−1

m,m′=0,xit =1
α j −1 (m′) pt
!
xi
t = 1
"
exp

−
jn

l=( j−1)n

yi,k
l
−xi
l
2
2(σi,k)
2

β j (m)
m,m′=Ms−1

m,m′=0,xit =−1
α j −1 (m′) pt
!
xi
t = −1
"
exp

−
jn

l=( j−1)n

yi,k
l
−xi
l
2
2(σi,k)
2

β j (m)
(5.250)
where λ
i\k
t
denotes the LLR ratio for the pth symbol within the jth codeword transmitted at time
t = ( j −1)n + p, and n is the code symbol length, m′ and m are the pair of states connected in the
trellis, xi
t is the tth BPSK modulated symbol in a code symbol connecting the states m′ and m, yi,k
t
is the detector output in iteration k for antenna i at time t, (σ i,k)2 is the noise variance for layer i, and
iteration k, Ms is the number of states in the trellis, and α(m′) and β(m) are the feed-forward and the
feedback recursive variables, deﬁned as for the LLR (Appendix 2.1).
In computing the LLR value in Equation (5.250) the decoder uses two inputs. The ﬁrst input is the
decision statistics, yi,k
t , which depends on the transmitted signal xi
t . The second input is the a priori
probability on the transmitted signal xi
t , computed as:
Pt
!
xi
t = l
"
=
1
√
2πσ
e−

yi,k
t
−lµit
2
2σ 2
l = 1, −1
(5.251)
where µi
t is the mean of the received amplitude after matched ﬁltering, given by µi
t = hH
i hi.
As pt(xi
t = l) in Equation (5.252) depends also on xi
t , the inputs to the decoder in iteration k,
where k > 1, are correlated. This causes the decision statistics mean value, conditional on xi
t , to
be biased [141, 159]. The bias always has a sign opposite to xi
t . Thus, the bias reduces the useful
signal term and degrades the system performance. This bias is particularly signiﬁcant for a large
number of interferers. The bias effect can be eliminated by estimating the mean of the transmitted
symbols based on the a posteriori extrinsic information ratio (EIR) instead of the LLR [147]. The

ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
249
extrinsic information represents the information on the coded bit of interest calculated from the a
priori information on the other coded bits and the code constraints. The EIR does not include the
metric for the symbol xi
t that is being estimated. That is:
λi,k
t,e = log
m,m′=Ms−1

m,m′=0,xit =1
α j −1 (m′) pt
!
xi
t = 1
"
exp

−
jn

l=( j−1)n,l̸=t

yi,k
l
−xi
l
2
2(σi,k)
2

β j (m)
m,m′=Ms−1

m,m′=0,xit =−1
α j −1 (m′) pt
!
xi
t = −1
"
exp

−
jn

l=( j−1)n,l̸=t

yi,k
l
−xi
l
2
2(σi,k)
2

β j (m)
(5.252)
where λi,k
t,e denotes the EIR for the pth symbol within the jth codeword transmitted at time t =
( j −1)n + p, yi,k
t
is the detector output iteration k for antenna i, α(m′) and β(m′) are deﬁned as
for the LLR (Appendix 2.1). However, excluding the contribution of the bit of interest reduces the
extrinsic information SNR, which leads to a degraded system performance.
A decision statistics combining (DSC) method is effective in minimizing these effects. In the
iterative parallel interference canceller with decision statistics combining (PIC-DSC) [147], shown
in Figure 5.36, a DSC module is added to the PIC-DSC structure. The decision statistics of the
PIC-DSC is generated as a weighted sum of the current PIC output and the DSC output from the
previous operation. In each stage, except in the ﬁrst one, the PIC output is passed to the DSC module.
The DSC nodule performs recursive linear combining of the detector output in iteration k for layer
i, denoted by yi,k, with the DSC output from the previous iteration for the same layer, denoted by
yi,k−1
c
The output of the decision statistics combiner, in iteration k and for layer i, denoted by yi,k
c , is
given by yi,k
c
= pi,k
1 yi,k + pi,k
2 yi,k−1
c
where pi,k
1
and pi.k
2 are the DSC weighting coefﬁcients in stage
k, respectively. They are estimated by maximizing the signal-to-noise plus interference ratio (SINR)
at the output of DSC in iteration k under the assumption that yi,k and yi,k−1
c
are Gaussian random
variables with the conditional means µi,k and µi,k−1
c
, given that xi is the transmitted symbol for
antenna i, and variances (σ i.k)2 and (σ i,k−1
c
)2, respectively.
1y
1c
DI
Mod
2àx
1àx
R
nr
2r
1r
PIC
n
T
àx
Delay
Decoder
1
cy
2
y
2c
DI
Delay
Decoder
2
cy
n
T
c
DI
Delay
Decoder
I
Mod
I
Mod
I
n
T
y
n
c T
y
DSC
DSC
DSC
Figure 5.36 Iterative receiver with PIC-DSC (IR/PIC-DSC).

250
MULTIUSER COMMUNICATION
Coefﬁcients pi,k
1 ’ and pi,k
2
can be normalized in the following way: E{yi,k
c } = pi,k
1 µi,k +
pi,k
1 µi,k−1
c
= 1. The SINR at the output of the DSC for layer i and in iteration k is then given by:
SINRi,k =
1
!
pi,k
1
"2 !
σ i,k"2 + 2pi,k
1

1−pi,k
1 µi,k
µi,k−1
c
 
ρi
k,k−1 +

1−pi,k
1 µi,k
µi,k−1
c
 2 !
σ i,k−1
c
"2
(5.253)
where ρi
k,k−1 is the correlation coefﬁcient for layer i, between the detector output in the kth and
(k −1)th iterations deﬁned as:
ρi
k,k−1 = E
5!
yi,k −µi,kxi" !
yi,k−i
c
−µi,k−1
c
xi" ''xi 6
σ i,kσ i,k−1
c
(5.254)
The optimal combining coefﬁcient is given by
pi,k
1 opt =
µi,k

µi,k−1
c
2
!
σ i,k−1
c
"2 −
1
µi,k−1
c
ρi
k,k−1σ i,k−1
c
!
σ i,k"2 −2 µi,k
µi,k−1
c
ρi
k,k−1σ i,kσ i,k−1
c
+

µi,k
µi,k−1
c
2 !
σ i,k−1
c
"2
(5.255)
In the derivation of the optimal coefﬁcients we assume that µk,i, µk,i−1
c
, (σ k,i)2 and (σ k,i−1
c
)2 are
the true conditional means and the true variances of the detector outputs.
The parameters required for the calculation of the optimal combining coefﬁcients in Equation
(5.255) are difﬁcult to estimate, apart from the signal variances. However, in a system with a large
number of interferers, which happens when the number of transmit antennas is large relative to
the number of receive antennas, and for the APP based symbol estimates, the DSC inputs in the
ﬁrst few iterations are low correlated. Thus, it is possible to combine them, in a way similar to
receiving diversity maximum ratio combining. Under these conditions, the weighting coefﬁcient in
this receiver can be obtained from Equation (5.255) by assuming that the correlation coefﬁcient is
zero and neglecting the reduction of the received signal conditional mean caused by interference. The
DSC coefﬁcients are then given by:
pi,k
1 =
!
σ i,k−1
c
"2
!
σ i,k−1
c
"2 + (σ i,k)2
(5.256)
The DSC output, in the second and higher iterations, with coefﬁcients from Equation (5.256) can
be expressed as:
yi.k
C =
(σ i,k−1
c
)21
(σ i,k−1
c
)2 + (σ i,k)2 yi,k +
(σ i,k1)2
(σ i,k)2 + (σ i,k−1
c
)2 yi,k−1
c
i > 1
(5.257)
The complexity of both PIC-STD and PIC-DSC is linear in the number of transmit antennas.
We demonstrate the performance of an HLST scheme with separate R = 1/2, 4-state convolutional
component encoders, the frame size of L = 206 symbols and BPSK modulation. In simulations
decoding is performed by a MAP algorithm. The HLSTC with nT transmit and nR receive antennas
is denoted as an (nT , nR) HI-STC. The channel is modelled as a frequency ﬂat slow Rayleigh fading
channel and the results are shown in the form of the frame error rate (FER) versus Eb/N0 The SNR
is related to Eb/N0 as SN R = ηEb/N0, where η = RmnT is the spectral efﬁciency and m is the
number of bits per modulation symbol. Figure 5.37 compares the performance of the PIC-STD with
EIR and LLR based symbol estimates and the PIC-DSC for a (6.2) HLSTC. The spectral efﬁciency
of the HI-STC is η = 3 bits/s/Hz. The results show that for the PIC-STD with LLR based symbol
estimates the error ﬂoor is higher than for the other two schemes. With l = 8 iterations, the error ﬂoor
for the PIC-STD(LLR) appears at FER of 0.1, while for the PIC-STD (EIR) the error ﬂoor is about
0.04. However, the PIC-DSC receiver has an error ﬂoor below 0.007.

ITERATIVE RECEIVERS FOR LAYERED SPACE–TIME CODING
251
7
8
9
10
11
12
13
14
15
10
-1
10
0
E/Nob
FER
 
 
PIC-DSC (ev), l=1
MMSE-STD, l=1
MMSE-STD, l=4
MMSE-STD, l=8
PIC-DSC (ev), l=4
PIC-DSC (ev), l=8
Figure 5.37 PER performance of nT = 6, nR = 2, R = 1/2, BPSK, a PIC-STD and PIC-
DSC detection on a slow Rayleigh fading channel.
1y
1c
Decoder
2
y
R
nr
2r
1r
F
+
+
Deint
Int
2c
Decoder
Deint
Int
+
Decoder
Deint
Int
B
n
T
y
2ˆx
1ˆx
n
T
ˆx
n
T
c
Figure 5.38 Block diagram of an iterative F/B MMSE receiver.
5.6.5.2
Iterative F/B MMSE receiver
We consider an iterative receiver with a multiuser detector consisting of a feed-forward (F) module
which performs interference suppression followed by a feedback (B) module which performs parallel
interference cancellation, as proposed in [144]. We refer to this receiver structure, presented in Figure
5.38, as an iterative F/B MMSE receiver. The decision statistics vector obtained at the output of

252
MULTIUSER COMMUNICATION
the feedback module the kth iteration at time t, for layer i, denoted by yi,k
t , is given by yi,k
t
=
(wi,k
f )Hr + wi,k
b , where wi,k
f is an nR × 1 optimized feed-forward coefﬁcients column matrix and wi,k
b
is a single coefﬁcient which represents cancellation term.
The coefﬁcients wi,k
f
and wi,k
b
are calculated by minimizing the mean square error between the
transmitted symbol and its estimate, given by:
e = E
#'''
!
wi,k
f
"H r + wi,k
b −xi
t
'''
2$
(5.258)
Let us denote by xi a column matrix with (nT −1) components, consisting of the transmitted
symbols from all antennas except antenna i (xi)T = (x1
t , x2
t , . . . , xi−1
t
, xi+1
t
, . . . , xnT
t ).
Similarly, we deﬁne a vector ˆxi,k of the symbol estimates from other antennas in the kthiteration
(ˆxi,k)T = (ˆx1,k
t , ˆx2,k
t , . . . , ˆxi−1,k
t
, ˆxi+1,k
t
, . . . , ˆxnT ,k
t
) The decoder calculates the LLRs for the transmitted
symbols at a particular time instant for each transmit antenna. These LLR values are used to calculate
the transmitted symbol estimates ˆxl,k
t , l = 1, 2, . . . , i −1, i + 1, . . . , nT in (ˆxk)T as before.
Let us denote by hi the ith of the channel matrix H, representing a column matrix with nR
complex channel gains for the ith transmit antenna, and by Hi an nR × (nT −1) matrix composed
of the complex channel gains for the other (nT −1) transmit antennas. To simplify the notation, we
deﬁne the following matrices:
A = hihH
i
B = Hi ,
InT −1 −diag((ˆxi,k, )H ˆxi,k) + ˆxi,k(ˆxi,k)H-
(Hi)H
(5.259)
where InT −1 is an (nT −1) × (nT −1) identity matrix, and
D = Hi ˆxi,k
Rn, = σ 2InR
(5.260)
where σ 2 is the noise variance. The optimum feed-forward and feedback coefﬁcients are given by
!
wi,k
f
"H = hH
i (A + B + Rn −DDH)
wi,k
b
= −
!
wi,k
f
"H D
(5.261)
The MMSE coefﬁcients were derived assuming perfect interleaving and feedback symbol estimates
based on the extrinsic information ratio (EIR) [158]. In the ﬁrst iteration, since the a priori probabilities
of the transmitted symbols are the same, the symbol estimates ˆxi,1 are zeros. Thus in the ﬁrst iteration
the feed-forward coefﬁcients W i,1
f
are obtained in a similar way as in Equation (5.242) and the
feedback coefﬁcient wi,1
b = 0. In the second and higher iterations, the symbol estimates, computed by
the decoder as in Equation (5.249), are used to recalculate the new set of feed-forward and feedback
coefﬁcients as described above. In the case of hard decision decoding (ˆxi,k
t )2 = 1 for all i and k > 1.
The iterative MMSE receiver, which employs hard decision decoders, is equivalent to the receiver
that performs linear MMSE suppression in the ﬁrst iteration and parallel interference cancellation in
the following iterations. This ﬁlter would be optimal in the MMSE sense if perfect symbol estimates
were fed back.
The a priori probability on the transmitted signal xi
t , used in the decoder, is computed as:
pt
!
xi
t = 1
"
=
1
√
2πσ
e−(yit −l)2
2σ 2
l = 1, −1
(5.262)
It has been observed that the iterative MMSE receiver performs better if LLRs are used for symbol
estimation instead of EIRs, though the MMSE ﬁlter coefﬁcients were derived assuming EIR symbol
estimation and uncorrelated decoder outputs. If LLRs are used there is a bias between symbol
estimates. However, the bias effect is less relevant in the iterative MMSE receiver than in the iterative
PIC receiver, since the MMSE detector performs interference suppression as well as cancellation.
Thus the use of DSC in iterative MMSE receivers is less effective than for iterative PIC receivers.
Figure 5.39 compares the iterative MMSE and iterative PIC-DSC performance for an (8,2) HLSTC.
The results show that the iterative PIC-DSC outperforms the iterative MMSE in terms of the achieved

APPENDIX 5.1 LINEAR AND MATRIX ALGEBRA
253
7
8
9
10
11
12
13
14
15
10
−2
10
−1
10
0
FER
 
 
PIC-STD (LLR), l=1
PIC-STD (EIR), l=4
PIC-STD (LLR), l=4
PIC-STD (LLR), l=8
PIC-STD (EIR), l=8
PIC-DSC, l=4
PIC-DSC, l=8
Eb/No
Figure 5.39 FER of a HLSTC with nT = 8, nR = 2, R = 1/2, iterative MMSE and itera-
tive PIC-DSC receivers, BPSK modulation on a slow Rayleigh fading channel.
FER after two iterations. The error ﬂoor in the FBR performance of the MMSE-STD appears at
Eb/N0 = 13 dB and for FER = 0.1, while for the PIC-DSC receiver the error ﬂoor appears at
Eb/N0 = 15 dB and for FER = 0.03.
5.7
APPENDIX 5.1 LINEAR AND MATRIX ALGEBRA
5.7.1
Deﬁnitions
Consider an m × n matrix R with elementsri j, i = 1, 2, . . . , m; j = 1, 2, . . . , n. A shorthand notation
for describing R is
[R]ij = rij
The transpose of R, which is denoted by RT, is deﬁned as the n × m matrix with elements rji or
[RT]ij = rji
A square matrix is one for which m = n. A square matrix is symmetric if RT = R. The rank of
a matrix is the number of linearly independent rows or columns, whichever is less. The inverse of a
square n × n matrix is the square n × n matrix R−1 for which
R−1R = RR−1 = I
where I is the n × n identity matrix. The inverse will exist if and only if the rank of R is n. If the
inverse does not exist, then R is singular. The determinant of a square n × n matrix is denoted by
det(R). It is computed as
det(R) =
n

j=1
ri jCij

254
MULTIUSER COMMUNICATION
where
Cij = (−1)i+ j Mij
Mij is the determinant of the submatrix of R obtained by deleting the ith row and jth colunm and is
termed the minor of rij . Cij is the cofactor of rij . Note that any choice of i for i = 1, 2, . . . , n will
yield the same value for det(R).
A quadratic form Q is deﬁned as
Q =
n

i=1
n

j=1
rij xix j
In deﬁning the quadratic form it is assumed that rji = rij. This entails no loss in generality since any
quadratic function may be expressed in this manner. Q may also be expressed as
Q = xTRx
where x = [x1x2 · · · xn]T and R is a square n × n matrix with rji = rij or R is a symmetric matrix.
A square n × n matrix R is positive semideﬁnite if R is symmetric and
xTRx ≥0
for all x ̸= 0. If the quadratic form is strictly positive, then R is positive deﬁnite. When referring to a
matrix as positive deﬁnite or positive semideﬁnite, it is always assumed that the matrix is symmetric.
The trace of a square n × n matrix is the sum of its diagonal elements or
tr(R) =
n

i=1
rii
A partitioned m × n matrix R is one that is expressed in terms of its submatrices. An example is
the 2 × 2 partitioning
R =

 R11
R12
R21
R22

Each ‘element’ Rij is a submatrix of R. The dimensions of the partitions are given as

k × l
k × (n −l)
(m −k) × l
(m −k) × (n −l)

5.7.2
Special Matrices
A diagonal matrix is a square n × n matrix with rij = 0 for i ̸= j, in other words, all elements off
the principal diagonal are zero. A diagonal matrix appears as:
R =


r11
0
· · ·
0
0
r22
· · ·
0
...
...
...
...
0
0
· · ·
rnn


A diagonal matrix will sometimes be denoted by diag(r11,r22, . . . ,rnn). Theinverse of a diagonal
matrix is found by simply inverting each element on the principal diagonal. A generalization of the
diagonal matrix is the square n × n block diagonal matrix
R =


R11
0
.................
0
0
R22
................
0
...
...
0
0
..................
Rkk



APPENDIX 5.1 LINEAR AND MATRIX ALGEBRA
255
in which all submatrices Rii are square and the other submatrices are identically zero. The dimensions
of the submatrices need not be identical. For instance, if k = 2, R11 might have dimension 2 × 2
while R22 might be a scalar. If all Rii are nonsingular, then the inverse is easily found as:
R−1 =


R−1
11
0
.................
0
0
R−1
22
................
0
...
...
0
0
..................
R−1
kk


Also, the determinant is:
det(R) =
n)
i=1
det(Rii)
A square n × n matrix is orthogonal if
R−1 = RT
For a matrix to be orthogonal the columns (and rows) must be orthonormal or, if
R = [r1r2 . . . rn]
where ri denotes the ith column, the conditions
rT
i r j =
# 0
for i ̸= j
1
for i = j
must be satisﬁed.
An idempotent matrix is a square n × n matrix which satisﬁes
R2 = R
This condition implies that Rl = R for l ≥1. An example is the projection matrix
R = H(HTH)−1HT
where H is an m × n full rank matrix with m > n.
A square n × n Toeplitz matrix is deﬁned as
[R]ij = ri−j
or
R =


r0
r−1
r−2
· · ·
r−(n−1)
r1
r0
r−1
· · ·
r−(n−2)
...
...
...
...
...
rn−1
rn−2
rn−3
· · ·
r0


Each element along a northwest–southeast diagonal is the same. If, in addition, r−k = rk, then R is
symmetric Toeplitz.
5.7.3
Matrix manipulation and formulas
Some useful formulas for the algebraic manipulation of matrices are summarized in this section. For
n × n matrices R and P the following relationships are useful.
(RP)T = PTRT
(RT)−1 = (R−1)T
(RP)−1 = P−1R−1
det (RT) = det(R)

256
MULTIUSER COMMUNICATION
det (cR) = cn det(R)
(c a scalar)
det (RP) = det (R) det (P)
det (R−1) =
1
det (R)
tr (RP) = tr(PR)
tr (RTP) =
n

i=1
n

j=1
[R]ij [P]ij
For vectors x and y we have
yTx = tr(xyT)
It is frequently necessary to determine the inverse of a matrix analytically. To do so one can make use
of the following formula. The inverse of a square n × n matrix is
R−1 =
CT
det(R)
where C is the square n × n matrix of cofactors R. The cofactor matrix is deﬁned by
[C]ij = (−1)i+ j Mij
where Mij is the minor of rij obtained by deleting the ith row and jth column of R.
Another formula which is quite useful is the matrix inversion lemma
(R + PCD)−1 = R−1 −R−1P(DR−1P + C−1)−1DR−1
where it is assumed that R is n × n, P is n × m, C is m × m, and D is m × n and that the indicated
inverses exist. A special case known as Woodbury’s identity results when P is an n × 1 column vector
u, C a scalar of unity, and D a 1 × n row vector uT. Then
(R + uuT)−1 = R−1 −R−1uuTR−1
1 + uTR−1u
Partitioned matrices may be manipulated according to the usual rules of matrix algebra by considering
each submatrix as an element. For multiplication of partitioned matrices, the submatrices which are
multiplied together must be conformable. As an illustration, for 2 × 2 partitioned matrices
RP =

 R11
R12
R21
R22
 
 P11
P12
P21
P22

=

 R11P11 + R12P21
R11P12 + R12P22
R21P11 + R22P21
R21P12 + R22P22

The transposition of a partitioned matrix is formed by transposing the submatrices of the matrix
and applying T to each submatrix. For a 2 × 2 partitioned matrix

R11
R12
R21
R22
	T
=

PT
11
PT
21
PT
12
PT
22
	
The extension of these properties to arbitrary partitioning is straightforward. Determination of the
inverses and determinants of partitioned matrices is facilitated by employing the following formulas.
Let R be a square n × n matrix partitioned as
R =

 R11
R12
R21
R22

=

k × k
k × (n −k)
(n −k) × k
(n −k) × (n −k)

Then,
R−1 =


!
R11 −R12R−1
22 R21
"−1
−
!
R11 −R12R−1
22 R21
"−1 R12R−1
22
−
!
R22 −R21R−1
11 R12
"−1 R21R−1
11
!
R22 −R21R−1
11 R12
"−1



APPENDIX 5.1 LINEAR AND MATRIX ALGEBRA
257
and
det(R) = det
!
R22) det(R11 −R12R−1
22 R21
"
= det(R11) det
!
R22 −R21R−1
11 R12
"
where the inverses of R11 and R22 are assumed to exist.
5.7.4
Theorems
Some important theorems are summarized in this section.
1. A square n × n matrix R is invertible (non-singular) if and only if its columns (or rows) are
linearly independent or, equivalently, if its determinant is non-zero. In such a case, R is full
rank. Otherwise, it is singular.
2. A square n × n matrix R is positive deﬁnite if and only if
– it can be written as
R = CCT
where C is also n × n and is full rank and hence invertible, or
– the principal minors are all positive. (The ith principal minor is the determinant of the
submatrix formed by deleting all rows and columns with an index greater than i). If R can
be written as in the previous equation, but C is not full rank or the principal minors are only
non-negative, then R is positive semideﬁnite.
3. If R is positive deﬁnite, then the inverse exists and may be found from the previous equation
as
R−1 = (C−1)T (C−1)
4. Let R be positive deﬁnite. If P is an m × n matrix of full rank with m ≤n, then PRPT is also
positive deﬁnite.
5. If R is positive deﬁnite (positive semideﬁnite), then
– the diagonal elements are positive (non-negative)
– the determinant of R, which is a principal minor, is positive (non-negative).
5.7.5
Eigendecompostion of matrices
An eigenvector of a square n × n matrix R is an n × 1 vector v satisfying
Rv −λv
(A5.1)
for some scalar λ, which may be complex. λ is the eigenvalue of R corresponding to the eigenvector
v. It is assumed that the eigenvector is normalized to have unit length or vTv = 1. If R is symmetric,
then one can always ﬁnd n linearly independent eigenvectors, although they will not in general be
unique. An example is the identity matrix for which any vector is an eigenvector with eigenvalue
1. If R is symmetric, then the eigenvectors corresponding to distinct eigenvalues are orthonormal
or vT
i v j = δi j and the eigenvalues are real. If, furthermore, the matrix is positive deﬁnite (positive
semideﬁnite), then the eigenvalues are positive (non-negative). For a positive semideﬁnite matrix the
rank is equal to the number of non-zero eigenvalues.
The deﬁning previous relation can also be written as
R[v1
v2
· · ·
vn] = [λ1v1
λ2v2 · · · λnvn]
or
RV = V

258
MULTIUSER COMMUNICATION
where
V = [v1
v2 · · · vn]
 = diag(λ1, λ2, · · · , λn)
If R is symmetric so that the eigenvectors corresponding to distinct eigenvalues are orthonormal and
the remaining eigenvectors are chosen to yield an orthonormal eigenvector set, V is an orthonormal
matrix. As such, its inverse is VT, so that the previous equation becomes
R = VVT
=
n

i=1
λivivT
i
Also, the inverse is easily determined as
R−1 = VT−1−1V−1 = V−1VT =
n

i=1
1
λi
vivT
i
A ﬁnal useful relationship follows as
det (R) = det (V) det() det(V−1) = det() =
n)
i=1
λi
5.7.6
Calculation of eigenvalues and eigenvectors
We can write Equation (A5.1) as
Rv −λv = 0 ⇒(R −λI)v = 0
These are n linear algebraic equations in the n unknowns v1, v2, v3, ..vn (the components of v). For
these equations to have a solution v ̸= 0, the determinant of the coefﬁcient matrix R −λI must be
zero. As an example, if n = 2, we have

r11 −λ
r12
r21
r22 −λ
 
v1
v2

=

0
0

which can be written as
(r11 −λ)v1 + r12v2 = 0
r21v1 + (r22 −λ)v2 = 0
(A5.2)
Now, R −λI is singular if and only if its determinant det(R −λI) is zero. This can be written as
det(R −λI) =
''''
r11 −λr12
r21r22 −λ
'''' = (r11 −λ)(r22 −λ) −r12r21
= λ2 −(r11 + r22)λ + r11r22 −r12r21 = 0
This quadratic equation in λ is called the characteristic equation of R. Its solutions are the eigen-
values λ1 and λ2 of R. First determine these. Then use Equation (A5.2) with λ = λ1 to determine
the eigenvector v1 of R corresponding to λ1. Finally, use Equation (A5.2) with λ = λ2 to ﬁnd an
eigenvector v2 of R corresponding to λ2. Note that if v is an eigenvector of R so is kv for any k ̸= 0.
As an example, suppose that
R =

−4.0
4.0
−1.6
1.2

then we have
det(R −λI) =
''''
−4 −λ
4
−1.6
1.2 −λ
'''' = λ2 + 2.8 λ + 1.6 = 0

REFERENCES
259
It has the solutions λ1 = −2 and λ2 = −0.8. These are the eigenvalues of R. Eigenvectors are obtained
from Equation (A5.2). For λ = λ1 = −2 we have, from Equation (A5.2):
(−4.0 + 2.0)v1 + 4.0v2 = 0
−1.6v1 + (1.2 + 2.0)v2 = 0
A solution of the equation is v1 = 2, v2 = 1. Hence, an eigenvector of R corresponding to λ = λ1 =
−2 is
v1 =

 2
1

Similarly, for λ = λ2 = −0.8
v2 =

 1
0.8

So, for this example:
V = [v1
v2] =

2
1
1
0.8

.
REFERENCES
1. Glisic, S. (2003) Adaptive WCDMA–Theory and Practice, John Wiley & Sons, Chichester.
2. Sarwate, S. V. and Pursley, M. B. (1980) Crosscorrelation Properties of Pseudorandom and
Related Sequences, Proceedings of the IEEE, 68, 593–613.
3. Mezger, K. and Bouwens, R. J. (1972) An Ordered Table of Primitive Polynomials over GF(2)
of Degrees 2 Through 19 for Use with Linear Maximal Sequence Generators, TM107, Cooley
Electronics Laboratory, University of Michigan, Ann Arbor (AD 746876).
4. Golomb, S. W. (1982) Shift Register Sequences, Aegean Park Press, Laguna Hills, CA.
5. Lindholm, J. H. (1968) An Analysis of the Pseudo-randomness Properties of Subsequences of
long m-sequences, IEEE Transactions On Information Theory, 14(4), 569–576.
6. Massey, J. L. (1969) Shift-Register Synthesis and BCH Decoding, IEEE Transactions On
Information Theory, 15(1), 122–127.
7. Groth, E. J. (1971) Generation of Binary Sequences with Controllable Complexity, IEEE Trans-
actions On Information Theory, 17(3), 288–296.
8. Antweiler, M. and B¨omer, L. (1992) Complex sequence over GF(pm) with a two-level au-
tocorrelation function and large linear span, IEEE Transactions On Information Theory, 38,
120–130.
9. Games, R. (1986) The geometry of m-sequences: three-valued crosscorrelations and quadrics
in ﬁnite projective geometry, SIAM Journal of Algebraic Discrete Methods, 7, 43–52.
10. Schoulz, R. and Welch, L. (1984) GMW sequences, IEEE Transactions On Information Theory,
IT-30, 548–553.
11. Simon, M., Omura, J., Scholtz, R. and Levitt, B. (1985) Spread-Spectrum Communications.
Computer Science Press, New York.
12. Welch, L. R. (1974) Lower bounds on the maximum correlation of signals, IEEE Transactions
On Information Theory, IT-20, 397–399.

260
MULTIUSER COMMUNICATION
13. Pursley, M. B. (1977) Performance evaluation for phase-coded spread-spectrum multiple-access
communication–Part I: System analysis, IEEE Transactions on Communications, COM-25,
795–799.
14. Pursley, M. B. and Roefs, H. F. A. (1979) Numerical evaluation of correlation parameters
for optimal phases of binary shift-register sequences, IEEE Transactions On Communications,
COM-27, 1597–1604.
15. Pursley, M. B. and Sarwate, D. V. (1976) Bounds on aperiodic crosscorrelation for binary
sequences, Electronics Letters, 12, 304–305.
16. Pursley, M. B. and Sarwate, D. V. (1977) Evaluation of correlations parameters for periodic
sequences, IEEE Transactions On Information Theory, IT-23, 508–513.
17. Pursley, M. B. and Sarwate, D. V. (1977) Performance evaluation for phase-coded spread-
spectrum multiple access communication–Part II: Code sequence analysis, IEEE Transactions
On Communications, COM-25, 800–803.
18. Roefs, H. F. A. and Pursley, M. B. (1977) Correlation parameters of random binary sequences,
Electronics Letters, 13, 488–489.
19. Sarwate, D. V. (1979) Bounds on crosscorrelation and autocorrelation of sequences, IEEE
Transactions On Information Theory, IT-25, 720–724.
20. Sarwate, D. V. and Pursley, M. B. (1977) New correlation identities for periodic sequences,
Electronics Letters, 13(2), 48–49.
21. Scholtz, R. A. and Welch, L. R. (1978) Group characters: Sequences with good correlation
properties, IEEE Transactions On Information Theory, IT-24, 537–545.
22. Glisic, S. and Vucetic, B. (1997) CDMA for Wireless Communication Kluwer AP, Boston.
23. Gold, R. (1966) Characteristic linear sequences and their coset functions, SIAM Journal of
Applied Mathematics, 14, 980–985.
24. Gold, R. (1966) Study of correlation properties of binary sequences, AF Avionics Lab., Wright-
Patterson AFB, OH, Technical Report AFAL-TR-66-234, (AD 488858).
25. Gold, R. (1967) Optimal binary sequences for spread spectrum multiplexing, IEEE Transactions
On Information Theory, IT-13, 619–621.
26. Gold, R. (1968) Maximal recursive sequences with 3-valued recursive crosscorrelation func-
tions, IEEE Transactions On Information Theory, IT-14, 154–156.
27. Golay, M. (1961) Complementary Series, IRE Transactions on Information Theory, IT 7, 82–87.
28. Deng, X. and Fan, P. (1999) New binary sequences with good aperiodic autocorrelations obtained
by evolutionary algorithm, IEEE Communications Letters, 3(10), 288–290.
29. Deng, H. (1996) Synthesis of binary sequences with good autocorrelation and crosscorrelation
properties by simulated annealing, IEEE Transaction on Aerospace Electronics Systems, 32(1),
98–107.
30. Hu, F., Fan, P. Z., Darnell, M. and Jin, F. (1997) Binary sequences with good aperiodic autocor-
relation functions obtained by neural network search, Electronics Letters, 33(8), 688–690.
31. Mertens, S. (1996) Exhaustive search for low-autocorrelation binary sequences, Journal of
Physics A: Mathematical and General, 29(18), 473–481.
32. Kocabas, S. E. and Atalar, A. (2003) Binary sequences with low aperiodic autocorrelation for
synchronization purposes, IEEE Communications Letters, 7(1), 36–38.
33. Zhang Guohua and Zhou Quan (2002) Pseudonoise codes constructed by Legendre sequence,
Electronics Letters, 38(8), 376–377.

REFERENCES
261
34. Walther, U. and Ferrweis, G. P. (2001) PN-generators embedded in high performance signal
processors, The 2001 IEEE International Symposium on Circuits and Systems (ISCAS 2001),
6–9 May 2001, 4, 45–48.
35. Leon, D., Balkir, S., Hoffman, M. W. and Perez, L. C. (2001) Robust chaotic PN sequence gen-
eration techniques, The 2001 IEEE International Symposium on Circuits and Systems (ISCAS
2001), 6–9 May 2001, 4, 53–56.
36. Fujisaki, H. (2001) Optimum binary spreading sequences of Markov chains, Electronics Letters,
37(20), 1234–1235.
37. Hongtao Zhang, Jichang Guo, Huiyun Wang, Runtao Ding and Wai-Kai Chen (2000) Oversam-
pled chaotic map binary sequences: deﬁnition, performance and realization, The 2000 IEEE
Asia-Paciﬁc Conference on Circuits and Systems (IEEE APCCAS 2000), 4–6 December 2000,
pp. 618–621.
38. Giardina, C. and Rudrapatna, A. N. (2000) Quasi-Walsh PN sequences and their applications
in robust CDMA communication systems, 2000 IEEE International Conference on Personal
Wireless Communications, 17–20 December 2000, pp. 24–27.
39. Abraham, V. D. and Rao, C. D. V. P. (2000) Optimization of spreading code and estimation
of channel capacity in multi-code CDMA downlink, 2000 IEEE International Conference on
Personal Wireless Communications, 17–20 December 2000, pp. 469–473.
40. Leon, D., Balkir, S., Hoffman, M. and Perez, L.C. (2000) Fully programmable, scalable chaos-
based PN sequence generation, Electronics Letters, 36(16), 1371–1372.
41. Yerdu, S. (1986) Optimum multiuser asymptotic efﬁciency, IEEE Transactions On Communi-
cations, COM-34, 890–897.
42. Verdu, S. (1986) Minimum probability of error for asynchronous Gaussian multiple-access
channels, IEEE Transactions On Information Theory, IT-32, 85–96.
43. Varanasi, M. and Aazhang, B. (1990) Multistage detection in asynchronous code division
multiple access communications, IEEE Transactions On Communications, 38, 509–519.
44. Varanasi, M. and Aazhang, B. (1991) Near optimum detection in synchronous code division
multiple access systems, IEEE Transactions On Communications, 39, 725–736.
45. Varanasi, M. (1993) Noncoherent detection in a synchronous multiuser channels, IEEE Trans-
actions On Information Theory, 37(1), 157–176.
46. Zvonar, Z. (1993) Multiuser detection for Rayleigh fading channel, Ph.D. thesis, Department of
Electrical and Computer Engineering, Northeastern University, Boston, Massachusetts, USA.
47. Xie, Z. et al. (1990) Multiuser signal detection using sequential decoding, IEEE Transactions
on Communications, 38, 578–583.
48. Aazhang, B. et al. (1992) Neural networks for multiuser detection in code division multiple
access communications, IEEE Transactions On Communications, COM-40, 1212–1222.
49. Lupas, R. and Verdu, S. (1989) Linear multiuser detectors for synchronous code division multiple
access channels, IEEE Transactions On Information Theory, 35, 123–136.
50. Lupas, R. and Verdu, S. (1990) Near–Far resistance of multiuser detectors in synchronous
channels, IEEE Transactions On Communications, 38(4), 496–508.
51. Varanasi, M. and Aazhang, B. (1991) Optimally near–far resistant multiuser detection in dif-
ferentially coherent synchronous channels, IEEE Transactions On Information Theory, 39,
1006–1018.
52. Xie, Z. et al. (1990) A family of suboptimum detectors for coherent multiuser communications,
IEEE ISAC, 8(4), 683–690.

262
MULTIUSER COMMUNICATION
53. Xie, Z. et al. (1993) Joint signal detection and parameter estimation in multiuser communica-
tions, IEEE Transactions On Communications, 41(7), 1208–1216.
54. Zvonar, Z. et al. (1992) Optimum detection in synchronous multiple-access multipath Rayleigh
fading channels, Proceedings of the 26th Annual Conference on Information Sciences and
Systems, Princeton University, March 1992.
55. Wijayasuriya, S. S. H., Norton, G. H. and McGeehan, J. P. (1992) Sliding Window Decorrelating
Algorithm for DS-CDMA Receivers, Electronics Letters, 28, 1596–1598.
56. Wijayasuriya, S. S. H., McGeehan, J. P. and Norton, G. H. (1993) RAKE Decorrelating Receiver
for DS-CDMA Mobile Radio Networks, Electronics Letters, 29, 395–396.
57. Tan, P. H. and Rasmussen, L. (2000) Linear interference cancellation in CDMA based on iterative
techniques for linear equation systems, IEEE Transactions On Communications, 48(12).
58. Kapur, A. and Varanasi, M. K. (2003) Multiuser detection for overloaded CDMA systems, IEEE
Transactions On Information Theory, 49(7), 1728–1742.
59. Buzzi, S., Lops, M. and Poor, H. V. (2003) Blind adaptive joint multiuser detection and equal-
ization in dispersive differentially encoded CDMA channels, IEEE Transactions on Signal
Processing, 51(7), 1880–1893.
60. Lim, H. S., Rao, M. V. C., Tan, A. W. C. and Chuah, H. T. (2003) Multiuser detection for
DS-CDMA systems using evolutionary programming, IEEE Communications Letters, 7(3),
101–103.
61. Liping Sun and Guangrui Hu (2003) A new sign algorithm for interference suppression in
DS-CDMA systems, IEEE Communications Letters, 7(5), 233–235.
62. Abe, T. and Matsumoto, T. (2003) Space–time turbo equalization in frequency-selective MIMO
channels, IEEE Transactions on Vehicular Technology, 52(3), 469–475.
63. Yen, K. and Hanzo, L. (2003) Antenna-diversity-assisted genetic-algorithm-based multiuser
detection schemes for synchronous CDMA systems, IEEE Transactions On Communications,
51(3), 366–370.
64. Jong-Hun Rhee, Moo-Yeon Woo and Dong-Ku Kim (2003) Multichannel joint detection of
multicarrier 16-QAM DS/CDMA system for high-speed data transmission, IEEE Transactions
on Vehicular Technology, 52(1), 37–47.
65. Yin, G. G., Krishnamurthy, V. and Ion, C. (2003) Iterate-averaging sign algorithms for adaptive
ﬁltering with applications to blind multiuser detection, IEEE Transactions On Information
Theory, 49(3), 657–671.
66. de Lamare, R. C. and Sampaio-Neto, R. (2003) Adaptive MBER decision feedback multiuser
receivers in frequency selective fading channels, IEEE Communications Letters, 7(2), 73–75.
67. Al-Bayati, A. K. S., Prakriya, S. and Prasad, S. (2003) Block modulus precoding for blind
multiuser detection of DS-CDMA signals, IEEE Transactions On Communications, 51(1), 52–
56.
68. Weihua Ye and Varshney, P. K. (2003) An equicorrelation-based multiuser communication
scheme for DS-CDMA systems, IEEE Transactions On Communications, 51(1), 43–47.
69. Kuei-Chiang Lai and Shynk, J. J. (2003) Performance evaluation of a generalized linear SIC for
DS/CDMA signals, IEEE Transactions on Signal Processing, 51(6), 1604–1614.
70. Kaﬂe, P. L. and Sesay, A. B. (2003) Iterative semi-blind multiuser detection for coded mc-cdma
uplink system, IEEE Transactions On Communications, 51(7), 1034–1039.

REFERENCES
263
71. Zhiyu Xu and Cheng, R. S. (2003) A robust rank estimation algorithm of group-blind MMSE
multiuser detectors for CDMA systems, IEEE Transactions on Communications, 51(4), 547–
552.
72. Wei Zha and Blostein, S. D. (2003) Soft-decision multistage multiuser interference cancellation,
IEEE Transactions on Vehicular Technology, 52(2), 380–389.
73. Ee-Lin Kuan and Hanzo, L. (2003) Burst-by-burst adaptive multiuser detection cdma: a
framework for existing and future wireless standards, Proceedings of the IEEE, 91(2), 278–
302.
74. Brunel, L. and Boutros, J. J. (2003) Lattice decoding for joint detection in direct-sequence
CDMA systems, IEEE Transactions On Information Theory, 49(4), 1030–1037.
75. Horlin, F. and Vandendorpe, L. (2003) CA-CDMA: channel-adapted CDMA for MAI/ISI-free
burst transmission, IEEE Transactions On Communications, 51(2), 275–283.
76. Buzzi, S. and Lops, M. (2003) Performance analysis for the improved linear multiuser detectors
in BPSK-modulated DS-CDMA systems, IEEE Transactions On Communications, 51(1), 37–
42.
77. Huaiyu Dai and Poor, H. V. (2002) Iterative space–time processing for multiuser detection in
multipath CDMA channels, IEEE Transactions on Signal Processing, 50(9), 2116–2127.
78. Hongbin Li and Jian Li (2002) Differential and coherent decorrelating multiuser receivers for
space-time-coded CDMA systems, Signal Processing, 50(10), 2529–2537.
79. Reynolds, D., Xiaodong Wang and Poor, H. V. (2002) Blind adaptive space–time multiuser
detection with multiple transmitter and receiver antennas, IEEE Transactions on Signal Pro-
cessing, 50(6), 1261–1276.
80. Naﬁe, M. and Tewﬁk, A. H. (2002) A ﬂexible receiver for CDMA multiuser communications,
IEEE Transactions on Signal Processing, 50(7), 1747–1758.
81. Brown,T. and Kaveh, M. (1995) A decorrelating detector for use with antenna arrays, Interna-
tional Journal of Wireless Information Networks, 2(4), 239–246.
82. Jung, P. and Blanz, J. (1995) Joint detection with coherent receiver antenna diversity in CDMA
mobile radio systems, IEEE Transactions on Vehicular Technology, 44(1), 76–88.
83. Jung, P., Blanz, J., Nasshan, M. and Baier, P. W. (1994) Simulation of the uplink of JD–CDMA
mobile radio systems with coherent receiver antenna diversity, Wireless Personal Communica-
tions, 1(2), 61–89.
84. Madhow, U. and Honing, M. L. (1994) MMSE interference suppression for direct sequence
spread-spectrum CDMA, IEEE Transactions On Communications, 42(12), 3178–3188.
85. Klein, A., Kaleh, G. K. and Baier, P. W. (1996) Zero forcing and minimum mean-square-
error equalization for multiuser detection in code-division multiple access channels, IEEE
Transactions on Vehicular Technology, 45(2), 276–287.
86. Berstein, X. and Haimovich, A. M. (1996) Space–time optimum combining for CDMA com-
munications, Wireless Personal Communications, 3(1–2), 73–89.
87. Gray, S. D., Preisig, J. C. and Brady, D. (1997) Multiuser detection in a horizontal underwater
acoustic channel using array observations, IEEE Transactions on Signal Processing, 45(1),
148–160.
88. Poor, H. V. and Verd´u, S. (1997) Probability of error in MMSE multiuser detection, IEEE
Transactions On Information Theory, 43(3), 858–871.

264
MULTIUSER COMMUNICATION
89. Rapajic, P. B. and Vucetic, B. S. (1995) Linear adaptive transmitter–receiver structures for
asynchronous SCMA systems, European Transactions on Telecommunications, 6(1), 21–27.
90. Miller, S. L. (1995) An adaptive direct sequence code-division multiple-access receiver for
multiuser interference rejection, IEEE Transactions On Communications, 43, 1746–1755.
91. Rapajic, P. B. and Vucetic, B. S. (1994) Adaptive receiver structures for asynchronous CDMA
systems, IEEE Journal on Selected Areas in Communications, 12(4), 685–697.
92. Lee, K. B. (1996) Orthogonalization based adaptive interference suppression for direct sequence
code-division multiple-access systems, IEEE Transactions On Communications, 44(9), 1082–
1085.
93. Miller, S. L. (1996) Training analysis of adaptive interference suppression for direct sequence
code-division multiple-access systems, IEEE Transactions on Communications, 44(4), 488–
495.
94. Honig, M. (1998) Adaptive linear interference suppression for packet DS-CDMA, European
Transactions on Telecommunications, 9(2), 173–181.
95. Hong, M., Madhow, U. and Verd´u, S. (1995) Blind adaptive multiuser detection, IEEE Trans-
actions On Information Theory, 41(3), 944–960.
96. Park, S. C. and Dohery, J. F. (1997) Generalized projection algorithm for blind interference
suppression in DS/CDMA communications, IEEE Transactions on Circuits and Systems–Part
II Analog and Digital Signal Processing, 44(6), 453–460.
97. Schodorf, J. B. and Williams, D. B. (1997) A constrained optimisation approach to multiuser
detection, IEEE Transactions on Signal Processing, 45(1), 258–262.
98. Wang, X. and Poor, H. V. (1998) Blind equalization and multiuser detection in dispersive CDMA
channels, IEEE Transactions On Communications, 46(1), 91–103.
99. Iltis, R. A. (1998) Performance of constrained and unconstrained adaptive multiuser detectors
for quasi-synchronous CDMA, IEEE Transactions On Communications, 46(1), 135–143.
100. Madhow, U. (1997) Blind adaptive interference suppression for the near–far resistant acquisition
and demodulation of direct-sequence CDMA, IEEE Transactions on Signal Processing, 45(1),
124–136.
101. Mowbray, R. S., Pringle, R. D. and Grant, P. M. (1992) Increased CDMA system capacity
through adaptive cochannel interference regeneration and cancellation, IEE Proceedings I, 139,
515–524.
102. Kohno, R., Imai, H., Hatori, M. and Pasupathy, S. (1990) Combination of an adaptive array
antenna and a canceller of interference for direct sequence spread-spectrum multiple-access
system, IEEE Journal on Selected Areas in Communications, 8(4), 675–682.
103. Nelson, L. B. and Poor, H. V. (1996) Iterative multiuser receivers for CDMA channels: An
EM-based approach, IEEE Transactions On Communications, 44(12), 1700–1710.
104. Soong, A. C. K. and Krzymien, W. A. (1996) A novel CDMA multiuser interference cancella-
tion receiver with reference symbol aided estimation of channel parameters, IEEE Journal on
Selected Areas in Communications, 14(8), 1536–1547.
105. Wang, X. and Poor, H. V. (1998) Blind multiuser detection: A subspace approach, IEEE Trans-
actions On Information Theory, 44(2), 677–690.
106. Juntti, M. and Glisic, S. (1997) Advanced CDMA for wireless communications, In Glisic, S.
G. and Lepp¨anen P. A. (eds) Wireless Communications: TDMA Versus DCMA, Kluwer, pp.
447–490.

REFERENCES
265
107. Zihua Guo and Ben Letaief, K. (2003) A low complexity reduced–rank MMSE receiver for
DS/CDMA communications, IEEE Transactions on Wireless Communications, 2(1), 59–68.
108. Zhiyu Xu and Cheng, R. S. (2003) A robust rank estimation algorithm of group-blind MMSE
multiuser detectors for CDMA systems, IEEE Transactions On Communications, 51(4), 547–
552.
109. Mantravadi, A. and Veeravalli, V. V. (2002) MMSE detection in asynchronous CDMA systems:
an equivalence result, IEEE Transactions On Information Theory, 48(12), 3128–3137.
110. Woodward, G., Ratasuk, R., Honig, M. L. and Rapajic, P. B. (2002) Minimum mean-squared
error multiuser decision-feedback detectors for DS–CDMA, IEEE Transactions on Communi-
cations, 50(12), 2104–2112.
111. Ju Ho Lee and Hyung-Myung Kim (2002) Partial zero-forcing adaptive MMSE receiver for DS-
CDMA uplink in multicell environments, IEEE Transactions on Vehicular Technology, 51(5),
1066–1071.
112. Schober, R., Gerstacker, W. H. and Lampe, A. (2002) Noncoherent MMSE interference sup-
pression for DS-CDMA, IEEE Transactions On Communications, 50(4), 577–587.
113. Buzzi, S., Lops, M. and Tulino, A. M. (2002) A generalized minimum-mean-output-energy
strategy for CDMA systems with improper MAI, IEEE Transactions on Information Theory,
48(3), 761–767.
114. Iltis, R. (1994) An EKF-based joint estimator for interference, multipath, and code delay in a
DS spread-spectrum receiver, IEEE Transactions On Communications 42, 1288–1299.
115. Kay, S. (1993) Fundamentals of Statistical Signal Processing–Estimation Theory, Prentice Hall.
116. Bensley, J. S. and Aazhang, B. (1996) Subspace-Based Channel Estimation for Code Division
Multiple Access Communications and Systems, IEEE Transactions on Communications, 44(8),
1009–1020.
117. Xie, Z., Rushforth, C., Short, R. and Moon, T. (1993) Joint signal detection and parameter
estimation in multiuser communications, IEEE Transactions On Communications, 41, 1208–
1216.
118. Aazhang, B., Paris, B. and Orsak, G. (1992) Neural networks for multiuser detection in code-
division multiple-access communications, IEEE Transactions On Communications, 40, 1212–
1222.
119. Iltis, R. A. and Mailaender, L. (1994)– An adaptive multiuser detector with joint amplitude and
delay estimation, IEEE Journal on Selected Areas in Communications, 12 (5), 774–785.
120. Iltis, R. (1990) Joint estimation of PN code delay and multipath using the extended Kalman
ﬁlter, IEEE Transactions On Communications, 38, 1677–1685.
121. Iltis, R. and Fuxjaeger, A. (1991) A digital DS spread-spectrum receiver with joint channel and
Doppler shift estimation, IEEE Transactions On Communications, 39, 1255–1267.
122. Clark, A. P. and Harun, R. (1986) Assesment of Kalman-Filter Channel Estimators for an HF
Radio Link, IEE Proceedings, 133 (pt.F), 513–521.
123. Hatzinakos, D. and Nikias, C. L. (1989) Estimation of multipath channel response in frequency
selective channels, IEEE Journal on Selected Areas in Communications, SAC-7, 12–19.
124. Shalvi, O. and Weinstein, E. (1990) New criteria for blind deconvolation of nonminimum phase
systems (channels), IEEE Transactions On Information Theory, IT-36, 312–321.
125. Huang, H. C. (1996) Combined multipath processing, array processing, and multiuser detection
for DS-CDMA channels, Ph.D. Thesis, Princeton University, Princeton, NJ, USA.

266
MULTIUSER COMMUNICATION
126. Latva-aho, M. (1998)Advanced receivers for wideband CDMA systems, Ph.D. Thesis, University
of Oulu, Finland.
127. Miller, S. Y. (1989) Detection and estimation in multiple-access channels, Ph.D. Thesis, Prince-
ton University, Princeton, NJ, USA.
128. Miller, S. Y. and Schwartz, S. C. (1995) Integrated spatial-temporal detectors for asynchronous
Gaussian multiple-access channels, IEEE Transactions On Communications, 43, 396–411.
129. Zvonar, Z. (1996) Combined multiuser detection and diversity reception for wireless CDMA
systems, IEEE Transactions on Vehicular Technology, 45(1), 205–211.
130. Fanucci, L. et al. (2001) VLSI Implementation of CDMA Blind Adaptive Interference-
Mitigating Detector, IEEE JSAC, 19(2), 179–190.
131. De Gaudenzi, R. et al. (1998) Design of a Low Complexity Adaptive Interference Mitigating De-
tector for DS/SS Receiver in CDMA Radio Networks, IEEE Transactions On Communications,
46(1), 125–134.
132. Amleh, K. and Hongbin Li (2003) An algebraic approach to blind carrier offset and code timing
estimation for DS-CDMA systems, IEEE Signal Processing Letters, 10(2), 32–34.
133. Manikas, A. and Sethi, M. (2003) A space–time channel estimator and single-user receiver for
code-reuse in DS-CDMA systems, IEEE Transactions on Signal Processing, 51(1), 39–51.
134. Bin Xu, Chenyang Yang and Shiyi Mao (2002) An improved blind adaptive multiuser detector
in multipath CDMA channels based on subspace estimation, IEEE 55th Vehicular Technology
Conference (VTC Spring 2002), 6–9 May 2002, 1, 285–288.
135. Fock, G., Schulz-Rittich, P., Schenke, A. and Meyr, H. (2002) Low complexity high resolution
Subspace-based delay estimation for DS-CDMA, IEEE International Conference on Commu-
nications (ICC 2002), 28 April–2 May 2002, 1, 31–35.
136. Xiaojun Wu, Qinye Yin and Jianguo Zhang (2002) Subspace-based estimation method of
uplink FIR channel in MC-CDMA system without cyclic preﬁx over frequency-selective fading
channel, IEEE International Symposium on Circuits and Systems (ISCAS 2002), 26–29 May
2002, 1, I-213–I-216.
137. Yugang Ma, Li, K. H., Kot, A. C. and Ye, G. (2002) A blind code timing estimator and
its implementation for DS-CDMA signals in unknown colored noise, IEEE Transactions on
Vehicular Technology, 51(6), 1600–1607.
138. Zhengyuan Xu (2002) Asymptotic performance of subspace methods for synchronous multirate
CDMA systems, IEEE Transactions on Signal Processing, 50(8), 2015–2026.
139. Lei Huang, Fu-Chun Zheng and Faulkner, M. (2002) Blind adaptive channel estimation for
dual-rate DS/CDMA signals, IEEE Communications Letters, 6(4), 129–131.
140. Affes, S. N., Hansen, H. and Mermelstein, P. (2002) Interference subspace rejection: a framework
for multiuser detection in wideband CDMA, IEEE Journal on Selected Areas in Communica-
tions, 20(2), 287–302.
141. Zhengyuan Xu (2002) Perturbation analysis for subspace decomposition with applications in
Subspace-based algorithms, IEEE Transactions on Signal Processing, 50(11), 2820–2830.
142. Tugnait, J. (1994) Blind Estimation of Digital Communication Channel Impulse Response,
IEEE Transactions On Communications, 42(2/3/4), 1606–1616.
143. Muirhead, R. (1982) Aspects of Multivariate Statistical Theory, Jon Wiley & Sons, New York.
144. Gamal, H. El. and Hammons, A. R. (2001) The layered space–time architecture: a new perspec-
tive, IEEE Transactions on Information Theory, 47, 2321–2334.

REFERENCES
267
145. Golden, G. D., Foschini, G. J., Valenzuela, R. A. and Wolniansky, P. W. (1999) Detection algo-
rithm and initial laboratory results using the V-BLAST space–time communication architecture,
Electronics Letters, 35, 14–15.
146. Winters, J. H., Salz, J. and Gitlin, R. D. (1994) The impact of antenna diversity on the capacity
of wireless communication systems. IEEE Transactions on Communications 42, 1740–1751.
147. Marinkovic, S., Vucetic, B. and Ushirokawa, A. (2001) Space–time iterative and multistage
receiver structures for CDMA mobile communication systems, IEEE Journal on Selected Areas
in Communications, 19, 1594–1604.
148. Ariyavisitakul, S. L. (2000) Turbo space–time processing to improve wireless channel capacity,
IEEE Transactions on Communications, 48, 1347–1358.
149. Foschini, G., Golden, G., Valenzuela, R. and Wolniansky, P. (2000) Simpliﬁed processing for
high spectral efﬁciency wireless communication employing multi-element arrays, IEEE Journal
on Selected Areas in Communications, 17, 1841–1852.
150. Proakis, J. G. (1995) Digital Communications, Series in Electrical and Computer Engineering,
McGraw-Hill, New York.
151. Alexander, P., Grant, A. J. and Reed, M. (1998) Iterative multiuser detection in codedivision
multiple-access with error control coding, European Transactions on Telecommunications,
special issue on CDMA Techniques in Wireless Communications Systems, 9, 419–425.
152. Moher, M. (1998) An iterative multiuser decode: for near-capacity communications, IEEE
Transactions on Communications, 46, 870–880.
153. Reed, M. (1999) Iterative Receiver Techniques for Coded Multiple Access Communication
Systems, PhD Thesis, The University of South Australia.
154. Alexander, P., Reed, M., Asenstorfer, J. and Schlegel, C. (1998) Iterative multiuser detection
for CDMA with FEC: near-single user performance, IEEE Transactions on Communication,
46, 1693–1699.
155. Alexander, P., Reed, M., Asenstorfer, J. and Schlegel, C. (1999) Iterative multiuser interference
reduction: turbo CDMA, IEEF Transactions on Communication, 47, 1008–1014.
156. Wang, X. and Poor, H. V. (1999) Iterative (turbo) soft interference cancellation and decoding
for coded CDMA, IEEE Transactions on Communications, 47, 1046–1061.
157. El Gamal, H. and Geraniotis, E. (2000) Iterative multiuser detection for coded CDMA signals in
AWGN and fading channels, IEEE Journal on Selected Areas in Communications, 18, 30–41.
158. El Gamal, H. and Hammons, R. (2001) A new approach to layered space–time and signal
processing, IEEE Transactions on Information Theory, 47, 2321–2334.
159. Buehrel, R.M., Nicoloso, S.P. and Gollamudi, S. (1999) Linear versus nonlinear interference
cancellation, Journal of Communications and Networks, 1, 118–132.


6
Channel Estimation and
Equalization
The basic concept of time division multiple access (TDMA) has been discussed in Chapter 1. Within
this chapter we cover the basic enabling technologies for TDMA. Coding and modulation are covered
in Chapters 2, 3 and 4 so that in this chapter we focus on the remaining topics, mainly TDMA-speciﬁc
channel estimation and equalization. MIMO channel equalization will be discussed in chapter 9 within
the general problem of linear precoding.
6.1
EQUALIZATION IN THE DIGITAL DATA TRANSMISSION SYSTEM
6.1.1
Zero-forcing equalizers
The basic problem of channel equalization is illustrated in Figure 6.1. Figure 6.1(a) presents
the transmitted pulse p(t), 6.1(b) shows the pulse after propagation through the channel pc(t),
while Figure 6.1(c) shows the difference between the received pc(t) and the equalized pulse
peq(t) ∼= p(t).
Figure 6.2 illustrates the mutual impact (inter-symbol interference) of the non-equalized and
equalized signals. Finally, Figure 6.3 illustrates a general structure and function of the equalizer.
To summarize, the transmitted signal for full response signaling is created in such a way that
the pulse goes through zero at the time instances ±kT, k ̸= 0 from the pulse maximum (Nyquist
signaling) p(±kT ) = 0, k ̸= 0. That way the adjacent symbols sampled at those instances will not be
affected. The degradation caused by the channel will result in the pulse pc(±kT ) ̸= 0, k ̸= 0 which
produces inter-symbol interference. The equalizer is supposed to compensate for this degradation by
regenerating a pulse peq(±kT ) ∼= p(±kT ) = 0, k ̸= 0.
This is represented by
peq(t) =
N

n=−N
Cn pc(t −nT )
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

270
CHANNEL ESTIMATION AND EQUALIZATION
peq(t)
∆t
T+∆t
2T ∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(t)
∆t
+
)
(t
p
(a)
pc (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
pc (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(b)
peq (t)
pc (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
p
(t)
pc (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(c)
Figure 6.1 (a) Transmitted; (b) received; and (c) equalized pulses.

EQUALIZATION IN THE DIGITAL DATA TRANSMISSION SYSTEM
271
peq (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
p
(t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
p
(t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(a)
eq (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
p
(t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(b)
p (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
p (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
pc (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(c)
Figure 6.2 (a), (b) Transmitted signals and (c), (d) received signals.

272
CHANNEL ESTIMATION AND EQUALIZATION
pc (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
p (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
p (t)
∆t
T+∆t
2T+∆t
3T+∆t
4T+∆t
-T+∆t
-2T+∆t
-3T+∆t
(d)
Figure 6.2 (Cont.)
Delays
T
T
T
T
Σ
pc (t)
C-N
C-N+1
C0
CN
peq (t)
tm
T
T
T
T
Σ
p (t)
C-N
C-N+1
C0
CN
p (t)
tm
T
T
T
T
…
…
Σ
p (t)
C-N
C-N+1
C0
CN
p (t)
tm
Figure 6.3 Transversal ﬁlter equalizer.
for t = mT + t
peq(mT + t) =
N

n=−N
Cn pc((m −n)T + t)
(6.1)
=
1
m = 0
0
m ̸= 0
m = 0, ±1, ±2, . . . , ±N
where t = t is the sampling time for which peq(t) is maximal. Equation (6.1) is implemented by the
structure shown in Figure 6.3 with the basic building block shown in Figure 6.4. From time to time,
throughout the rest of the book, we will explicitly emphasize the importance of this basic building

EQUALIZATION IN THE DIGITAL DATA TRANSMISSION SYSTEM
273
tap
coef
tap
∑
Figure 6.4 Transversal ﬁlter equalizer basic building block.
block in order to be able to motivate some basic approaches in building up a common reconﬁgurable
platform for different technologies.
Equation (6.1) for m = 0, ±1, ±2, . . . , ±N can be written in matrix form as Peq = PcC, where
Peq and C are vectors or column matrices given by
Peq =


0
0
.
.
.
0
1
0
0
.
.
.
0





N zeros



N zeros
C =


C−N
C−N+1
.
.
.
C0
C1
.
.
.
CN


(6.2)
and Pc is the (2N + 1) × (2N + 1) matrix of channel responses of the form
Pc =


pc(0)
pc(−1)
. . .
pc(−2N)
pc(1)
pc(0)
. . .
pc(−2N + 1)
pc(2)
pc(1)
. . .
pc(−2N + 2)
.
.
.
.
.
.
.
.
.
.
.
.
pc(2N)
pc(2N −1)
. . .
pc(0)


(6.3)
The solution for the equalizer coefﬁcients is
C = P−1
c Peq
(6.4)
given P−1
c
̸= 0. This way we force the Peq(±kT ) = 0, hence the name zero-forcing equalizer. One
should be aware that in a channel with noise Pc ⇒Pc + Pn, where Pn is the noise matrix given by
(6.3) where channel samples are replaced with corresponding noise samples pc( ) ⇒pn( ). Equation
(6.4) now results in
Peq = PcC + PnC = PcC + Neq
(6.5)
C = P−1
c Peq −P−1
c Neq
(6.6)
The second term represents the noise enhancement factor and is a limiting factor in achieving good
performance.

274
CHANNEL ESTIMATION AND EQUALIZATION
6.1.1.1
Example
Suppose that the sample values for the channel response are
pc(−5) = 0.01
pc(−4) = −0.02
pc(−3) = 0.05
pc(−2) = −0.1
pc(−1) = 0.2
pc(0) = 1
pc(1) = −0.1
pc(2) = 0.1
pc(3) = −0.05
pc(4) = 0.02
pc(5) = 0.005
The channel response matrix is
Pc =


1.0
0.2
−0.1
0.05
−0.02
−0.1
1.0
0.2
−0.1
0.05
0.1
−0.1
1.0
0.2
−0.1
−0.05
0.1
−0.1
1.0
0.2
0.02
−0.05
0.1
−0.1
1.0


and its inverse
P−1
c
=


0.996
−0.170
0.117
−0.083
0.056
0.118
0.945
−0.158
0.112
−0.083
−0.091
0.133
0.937
−0.158
0.117
0.028
−0.095
0.133
0.945
−0.170
−0.002
0.028
−0.091
0.118
0.966


The coefﬁcient vector is the center column of P−1
c . Therefore,
C−2 = 0.117
C−1 = −0.158
C0 = 0.937
C1 = 0.133
C2 = −0.091
The sample values of the equalized pulse response are given as
peq(m) =
2

n=−2
Cn pc(m −n)
where t = 0. For this example we have,
peq(0) = (0.117)(0.1) + (−0.158)(−0.1) + (0.937)(1)
+ (0.133)(0.2) + (−0.091)(−0.1)
= 1.0
which checks with the desired value of unity. Similarly, it can be veriﬁed that peq(−2) = peq(−1) =
peq(1) = peq(2) = 0.
Values of peq(n) for n < −2 or n < 2 are not zero. For example,
peq(3) = (0.117)(0.005) + (−0.158)(0.02) + (0.937)(−0.05)
+ (0.133)(0.1) + (−0.091)(−0.1)
= −0.027
peq(−3) = (0.117)(0.2) + (−0.158)(−0.1) + (0.937)(0.05)
+ (0.133)(−0.02) + (−0.091)(0.01)
= 0.082

LMS EQUALIZER
275
LPF
Tapped
LPF
Tapped Delay Line
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
• • •
• • •
I & D
Detector
I & D
Detector
y (t)
2cos (ω0t+α)
2sin (ω0t+α)
z1 (t)
z2 (t)
Wr1
Wr2
Wi1
Wi1
Wr1
Wr2
Wi2
Wi2
WrN
WrN
WiN
WiN
τ1
τ1
τ2
τ2
τNs
τNs
D1d (t)
D2d (t)
LPF
Tapped delay line
LPF
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
ΣΣΣΣ
• • •
• • •
I and D
detector
I and D
detector
y (t)
2cos (ω0t+α)
2sin (ω0t+α)
z1 (t)
z2 (t)
Wr1
Wr2
Wi1
Wi1
Wr1
Wr2
Wi2
Wi2
WrN
WrN
WiN
WiN
τ1
τ1
τ2
τ2
τNs
τNs
D1d (t)
D2d (t)
Tapped delay line
Figure 6.5 Transversal ﬁlter equalizer for QPSK.
6.2
LMS EQUALIZER
Let us now, in the next iteration, revisit the same problem of the channel equalization by introducing
more details. We will be dealing with a QPSK signal and equalizer, as shown in Figure 6.5.
6.2.1
Signal model
The transmitted QPSK signal has the form
str(t) = d1(t) cos ω0t −d2(t) sin ω0t
(6.7)
The received signal can be represented as
y(t) = srec(t) + n(t)
= str(t) + βstr(t −τm) + nc(t) cos(ω0t + α) −ns(t) sin(ω0t + α)
(6.7a)
We deﬁne the desired non-distorted complex signal at the receiver as
D(t) = (1 + β) [d1(t) + jd2(t)]
(6.8)
The cost function for the MMSE equalizer is deﬁned as
C = E⌊|de(t) −D(t)|2⌋
(6.9)
If we deﬁne the complex vectors of equalizer coefﬁcients W and LPF output signal samples Z (see
Figure 6.5)
W =


W1
W2
...
WN


Z =


z(t)
z(t −)
...
z(t −(N −1))


(6.10)
then the cost function becomes
C = E⌊|W′Z −D(t)|2⌋
(6.11)

276
CHANNEL ESTIMATION AND EQUALIZATION
β
1
0.25
0.125
0.0625
0.013125
10−8
10−7
10−6
10−5
10−4
10−3
10−2
PE
N = 4
τm / Tc = 0.25
∆τ = 0
SNR = 9 dB; α = 5°
Unequalized
SNR = 9 dB; α = 2.5°
Unequalized
SNR = 9 dB; α = 0°
Unequalized
SNR = 9 dB; Equalized
SNR = 12 dB; α = 5°
Unequalized
SNR = 12 dB; α = 2.5°
Unequalized
SNR = 12 dB;
Equalized
SNR = 9 dB;
α = 0°
Unequalized
β
1
0.5
10
10
10
10
10
10
10
PE
N = 4
τm / T = 0.25
∆τ = 0
SNR = 9 dB; α = 5°
Unequalized
SNR = 9 dB; α = 2.5°
Unequalized
SNR = 9 dB; α = 0°
Unequalized
SNR = 9 dB; Equalized
SNR = 12 dB; α = 5°
Unequalized
SNR = 12 dB; α = 2.5°
Unequalized
SNR = 12 dB;
Equalized
SNR = 9 dB;
α = 0°
Unequalized
Figure 6.6 Error probability versus amplitude of a specular component for detection of
equalized QPSK.
By setting the gradient to zero we get
Wopt = [E(ZZ′)]−1E(ZD∗(t))
A sample of performance results is shown in Figure 6.6.
6.2.2
Adaptive weight adjustment
Setting the tap coefﬁcients of the zero-forcing and LMS equalizers involves the solutions of a set of
simultaneous equations. In the case of the zero-forcing equalizer, adjustment of the tap coefﬁcients
involves measuring the channel ﬁlter output at T second spaced sampling times in response to a test
pulse, and solving for the tap gains. In the case of the LMS equalizer, these equations involve data,
noise and multipath dependent parameters, which may be difﬁcult to determine or may not be known
at all. Known data assumes a kind of preamble (midamble) embedded into the data.
6.2.3
Automatic systems
So-called preset algorithms, use a training sequence. In adaptive algorithms, adjustment of the
coefﬁcients is performed continuously during data transmission.
A zero-forcing equalizer can be solved iteratively for the coefﬁcient vector C. Let C at the kth
iteration be C(k), then the error in the solution is
E(k) = PcC(k) −Peq
(6.12)
where E(k) is a vector with 2N + 1 components, each of which represent the error in a component of
C(k). Each component of C(k) can be adjusted in accordance with the error in it.

LMS EQUALIZER
277
6.2.4
Iterative algorithm
If A is a small positive constant, the adjustment algorithm for the jth component of C(k) is
C(k+1)
j
= C(k)
j
−Asgn

E(k)
j

(6.13)
The iteration process is continued until C(k+1)
j
and C(k)
j
differ by some suitable small increment. The
algorithm converges under fairly broad restrictions.
6.2.5
The LMS algorithm
The gradient of the mean square error with respect to the jth tap gain is twice the correlation between
the equalizer output and the error between actual and desired outputs.Two problems arise in applying
it to adaptive weight adjustment. First, it requires the expectation or average to be taken. Since this is
not available, the unbiased but noisy estimate z∗(t −j) e(t) can be used. Secondly, the undistorted
output D(t) is not available unless a known data sequence is transmitted.
An alternative to sending a known data sequence is to assume that the detected data is correct
(which is true even in a fairly bad channel giving an error probability of only 10−2) and using the
detected data to reconstruct an estimate of the undistorted output D(t). Equalizers using this method
of data estimation are called decision-directed.
A suitable decision-directed algorithm for weight adjustment of the LMS equalizer is
W (n + 1) = W (n) −AZ∗
T [de (tn −) −Dd (tn)]
(6.14)
More details on LMS-based equalizers can be found in [1–7].
6.2.6
Decision feedback equalizer (DFE)
Non-linear equalizer structures may provide better performance under many circumstances. A simple
non-linear equalizer is the decision feedback equalizer (DFE) which uses feedback of decisions on
symbols already received to cancel the interference from symbols which have already been detected.
The basic idea is that, assuming past decisions are correct, the ISI contributed by these symbols
can be canceled exactly by subtracting appropriately weighted past symbol values from the equalizer
output. This is the purpose of the delay line with weights b1, b2, . . . , bM shown in Figure 6.7. The
forward transversal ﬁlter, with weights c0, c1, . . . , cN−1, then compensates for ISI over a smaller
ΣΣΣΣ
T
T
T
• • •
ΣΣΣΣ
T
T
T
•
• •
Decision
Device
ΣΣΣΣ
Input
Decisions
out
Training
signal
c0
c1
cN - 1
bM
b1
et
d k - M
d k - 1
d k
Zk
+
+
-
-
-
ΣΣΣΣ
T
T
T
• • •
ΣΣΣΣ
T
T
T
•
• •
Decision
device
ΣΣΣΣ
Input
Decisions
Training
c0
c1
cN - 1
bM
b1
et
d k - M
d k - 1
d k
Zk
+
+
-
-
-
Figure 6.7 Decision feedback equalizer.

278
CHANNEL ESTIMATION AND EQUALIZATION
portion of the ISI-contaminated received signal. Both the feedback and feedforward coefﬁcients can
be adjusted simultaneously to minimize the mean square error.
Decision feedback equalizers are discussed in [8–41].
6.2.7
Blind equalizers
What we need for designing a blind equalizer is to recover the transmitted message (at) from the
received one (xt) only, without any preamble for identiﬁcation of the unknown channel.
The equivalent system models are given in Figure 6.8 and Figure 6.9. The cost function deﬁned
by Equation (6.11) is now modiﬁed in such a way that it does not require knowledge of data. Options
are presented by Equations (6.15) and (6.16). The remaining details are the same as in the previous
discussion.
J(W) = E
1
2c2
t (W) −α |ct(W)|

(6.15)
α = Ea2
t
E|at|
For complex signals, parameters at, xt, ct, S and W in Figure 6.9 are complex. Re at and Im at are
independent and the cost function is deﬁned as
J(W) = E(ψ(Re ct(W)) + ψ(Im ct(W)))
ψ(x) = 1
2 x2 −α|x|
(Sato function)
(6.16)
α =

x2v(dx)
 
|x| v(dx)
−1
Blind equalizers are discussed in [42–64].
Channel
Equalizer
Decision
Circuit
g0(τ)
Re
Channel
Phase
Splitter
Equalizer
Decision
Circuit
Decision
Circuit
Equalizer
Decision
Circuit
Carrier
Tracking
Baseband Equivalent
Complex Channel
at
xt
One carrier
Two carriers
Baseband equivalent
ct
taˆ
at
taˆ
at
ct
taˆ
τ
ω0
exp j
)
exp(
0τ
ω
j
−
Channel
Equalizer
Decision
circuit
g0(τ)
Re
Channel
Phase
splitter
Equalizer
Decision
circuit
Decision
circuit
Equalizer
Decision
circuit
Carrier
tracking
Baseband equivalent
complex channel
at
xt
One carrier
Two carriers
Baseband
ct
taˆ
at
taˆ
at
ct
taˆ
τ
ω0
exp j
)
exp(
0τ
ω
j
−
Figure 6.8 System models.
ct(θ )
S (?)
θθθθ
Adjustable
at
xt
ct(θ )
S (?)
θθθθ
Adjustable
at
xt
W
Adjustable
Figure 6.9 Equivalent model of the system from Figure 6.8.

DETECTION FOR A STATISTICALLY KNOWN, TIME VARYING CHANNEL
279
DE
hT(τ)
c(τ; t)
DD
Sequence
Estimator
hR(τ)
{dn}
{an}
{âk}
{rk}
kTS+t0
n(t)
}
ˆ
{
k
d
differential
DE
hT(τ)
c(τ; t)
DD
Sequence
estimator
hR(τ)
{dn}
{an}
{âk}
{rk}
kTS+t0
n(t)
}
ˆ
{
k
d
differential
Figure 6.10 Block diagram of the communication system under consideration, in complex
envelope form.
6.3
DETECTION FOR A STATISTICALLY KNOWN, TIME VARYING
CHANNEL
The system model is given in Figure 6.10. Parameters hT(τ), c(t, τ) and hR(τ) represent transmitter
ﬁlter, channel and receive ﬁlter impulse responses respectively. The overall system pulse response is
a convolution f (τ; t) of the three and is given by Equation (6.17).
f (τ; t) = hT(τ) ∗c(τ; t) ∗hR(τ)
(6.17)
r(kTs) = rk =

n
an f (kTs −nT ; kTs) + wk
Equation (6.17) also represents the samples of the overall received signal at sampling points kTs.
The sampling interval is Ts and the symbol interval is T .
6.3.1
Signal model
The convolution can also be presented as:
rk =
L

n=0
al−n fi(k) + wk
(6.18)
For the T -spaced sampling (TS) case, we have l = k, and i = n; for the fractional spaced sampling
(FS) case, l = [k/2], and i = 2n + m, with m = (k + 1) mod 2, i.e. m = 1 for k even, and m = 0 for
k odd. Tapped delay line system models for TS and FS are given in Figures 6.11 and 6.12.
6.3.2
Channel model
For the channel model we assume:
r The worst case channel in terms of TM and fD.
r For the worst case value of TM we use 20 µs.
r With the IS-54 symbol duration of T = 1/24 000 ≈41.7 µs, this corresponds to roughly TM =
T/2, i.e. the echo delay is half a symbol duration.
r For the impulse response shape, we use a ‘double-spike’ spaced by TM : c(τ; t) = c0(t)δ(τ) +
c1(t)δ(τ −TM) where E[|c0(t)|2] = E[|c1(t)|2] = 0.5 so that the average energy of the channel is
normalized to one.
r The response f (τ; t) is then
f (τ; t) = c0(t)h(τ) + c1(t)h(τ −TM)

280
CHANNEL ESTIMATION AND EQUALIZATION
+
T
T
T
• • •
+
f0 (k)
ak
rk
f1 (k)
f2 (k)
fL (k)
ak-1
ak-2
ak-L
wk
+
T
T
T
• • •
+
f0 (k)
ak
rk
f1 (k)
f2 (k)
fL (k)
ak-1
ak-2
ak-L
wk
Figure 6.11 Tapped delay line model of the equivalent discrete time channel for the TS
case. The blocks containing ‘T ’ denote delays Ts.
+
T/2
T/2
T/2
+
f0 (k)
rk
f1 (k)
f2 (k)
f5 (k)
wk
T/2
T/2
f3 (k)
f4 (k)
Time k, odd:
al
0
al-1
0
al-2
0
Time k+1, even:
0
al
0
al-1
0
al-2
+
T/2
T/2
T/2
+
f0 (k)
rk
f1 (k)
f2 (k)
f5 (k)
wk
T/2
T/2
f3 (k)
f4 (k)
Time k, odd:
al
0
al-1
0
al-2
0
Time k+1, even:
0
al
0
al-1
0
al-2
Figure 6.12 Tapped delay line model of the equivalent discrete time channel for the FS case
and a channel impulse response length of 3T . The blocks containing ‘T/2’
denote delays of T/2 s, l = [k/2], and [x] denotes the smallest integer ≥x.
r h(τ) is the full raised cosine response, equal to the convolution of hT(τ) and hR(τ).
r We set t equal to nTs and t equal to kTs (assuming the sampling phase t0 = 0).
r For the TS case, we have, with Ts = T ,
f TS
0 (k) = c0(k)h(0) + c1(k)h(T/2)
f TS
n (k) = c1(k)h((2n −1)T/2),
n = 1, 2, . . .
r The symmetry of h(τ) was used.
r For the TS case, we truncate the number of taps to L + 1 = 3. The normalized average tap energies
are then E[| f0|2] = 0.7717, E[| f1|2] = 0.2136, and E[| f2|2] = 0.0147.

DETECTION FOR A STATISTICALLY KNOWN, TIME VARYING CHANNEL
281
In the FS case, with t = nT/2 and k = kT/2
f FS
0 (k) = c0(k)h(0) + c1(k)h(T/2)
f FS
1 (k) = c1(k)h(T/2) + c1(k)h(0)
f FS
2n (k) = c1(k)h((2n −1)T/2)
n = ±1, ±2, . . .
f FS
2n+1(k) = c0(k)h((2n + 1)T/2)
n = ±1, ±2, . . .
r We retain the most signiﬁcant taps, yielding 2(L + 1) = 6.
r The average (normalized) tap energies here are E[| f−2|2] = E[| f3|2] = 0.00735, E[| f−1|2] =
E[| f2|2] = 0.1068, and E[| f0|2] = E[| f1|2] = 0.38585.
r In both the TS and FS cases, we choose the minimum number of taps such that the truncated
response contained at least 98 % of the energy of the untruncated response.
r The autocorrelation of the continuous time processes c0(t) and c1(t) is rc(τ) = J0(2πτ fD), where
J0(x) is the zeroth order Bessel function of the ﬁrst kind.
r For this model, for a vehicle speed of 30 m/s (67.1 mph) and a carrier frequency of 900 MHz, the
maximum Doppler shift fD ≈90 Hz.
r For simulation purposes, the autocorrelation is approximated by something more easily synthe-
sized, namely, the inverse Fourier transform of a Chebyshev Type I magnitude squared frequency
response.
r For time separations τ ≤50T , the Chebyshev ﬁlter yields a very good approximation to the desired
autocorrelation.
6.3.3
Statistical description of the received sequence
The following assumptions are made
r the received sequence rN = (r1,r2, . . . ,rN)T
r the transmitted sequence aN = (a1, a2, . . . , aN)T
r the pdf is complex Gaussian
p(rN|aN) =
1
π det |C(aN)| · exp

−rH
NC−1 (aN) rN

(6.19)
r C(aN) denotes the covariance matrix of rN given aN.
r The superscript H denotes Hermitian (conjugate transpose).
r The
elements
of
C(aN),
abbreviated
Ca,
are
obtained
by
taking
the
expectation
E[rN · rH
N|aN]:
ci j =
L

n=0
L

m=0
ai−na∗
j−m E[ fn(i) f ∗
m( j)] + σ 2
wδi j
(6.20)
The assumption that the channel is statistically known means that E⌊fn(i) f ∗
m( j)⌋are known.
6.3.4
The ML sequence (block) estimator for a statistically known channel
The maximum likelihood sequence estimator (MLSE) ˆa is deﬁned as
ˆa = arg min
a
	(a, r)
(6.21)

282
CHANNEL ESTIMATION AND EQUALIZATION
TS-SKC
TS-KC
FS-KC
FS-SKC
0.0
10.0
20.0
30.0
40.0
50.0
60.0
Eb /N0 (dB)
1.0E-10
1.0E-08
1.0E-06
1.0E-04
1.0E-02
1.0E+00
2P
TS-SKC
TS-KC
FS-KC
FS-SKC
0.0
10.0
20.0
30.0
40.0
50.0
60.0
Eb /N0 (dB)
1.0E-10
1.0E-08
1.0E-06
1.0E-04
1.0E-02
1.0E+00
2P
Figure 6.13 Plots of union upper bounds on the average sequence error probability versus
Eb/N0 for the TS and FS SKC detectors, and for the TS and FS known channel
detector, for block length N = 4, using binary PSK modulation. Channel
parameters are fD = 90 Hz, TM = T/2, and t0 = 0.
0.0
10.0
20.0
30.0
Eb /N0 (dB)
1.0E-03
1.0E-02
1.0E-01
1.0E+00
2P
TS upper bound
TS
simulation
FS
upper bound
FS
simulation
0.0
10.0
20.0
Eb /N0 (dB)
1.0E-03
1.0E-02
1.0E-01
1.0E+00
2P
TS upper bound
TS
simulation
FS
upper bound
FS
simulation
Figure 6.14 Plots of the union upper bounds and simulated average sequence error prob-
ability versus Eb/N0 for the TS and FS SKC detectors, for block length
N = 4, and binary PSK modulation. The channel parameters are fD = 90 Hz,
TM = T/2, and t0 = 0.
where 	( ) is the logarithm of Equation (6.19). The sequence metrics are
	(a, r) = ln |Ca| + rHC−1
a r
(6.22)
Matrix inversion C−1 can be calculated by Cholesky decomposition (factorization). For a given
vector of samples r and the known channel, the algorithm will search for a that minimizes Equa-
tion (6.21). Some results are given in Figures 6.13–6.17.

DETECTION FOR A STATISTICALLY KNOWN, TIME VARYING CHANNEL
283
0.0
10.0
20.
30.0
Eb /N0 (dB)
1.0E-05
1.0E-04
1.0E-03
1.0E-02
1.0E-01
1.0E+00
sP
N = 3
N = 4
N = 5
N = 3
N = 4
N = 5
0.0
10.0
20.0
Eb /N0 (dB)
1.0E-05
1.0E-04
1.0E-03
1.0E-02
1.0E-01
1.0E+00
sP
N = 3
N = 4
N = 5
N = 3
N = 4
N = 5
Figure 6.15 Plots of simulated average symbol error probability ¯Ps versus Eb/N0 for the
FS SKC (solid lines) and FS KC (dashed lines) detectors, for block length N =
3, 4, 5 and binary PSK modulation. The channel parameters are fD = 90 Hz,
TM = T/2, and t0 = 0.
0.0
10.0
20.0
30.0
Eb /N0 (dB)
1.0E-04
1.0E-03
1.0E-02
1.0E-01
1.0E+00
bP
N = 2
N = 3
N = 4
N = 2
N = 3
N = 5
N = 4
N = 5
Figure 6.16 Plots of simulated average BEP ¯Pb (after differential decoding) versus Eb/N0
for the TS (solid lines) and FS (dashed lines) SKC detectors, for block length
N = 2 −5, and binary PSK modulation. The channel parameters are fD =
90 Hz, TM = T/2, and t0 = 0.

284
CHANNEL ESTIMATION AND EQUALIZATION
0.0
10.0
20.0
30.0
Eb /N0 (dB)
1.0E-04
1.0E-03
1.0E-02
1.0E-01
1.0E+00
sP
TM = 0
TM = T/4
TM = T/2
TM = 0
TM = T/4
TM = T/2
Figure 6.17 Plots of simulated average symbol error probability ¯Ps versus Eb/N0 for the
TS and FS SKC detectors, for block length N = 4 and binary PSK modulation,
showing the effect of mismatch between the estimated delay spread, ˆTM, and
the actual delay spread TM. For all cases, ˆTM = T/2, but the actual TM is zero,
T/4 and T/2. The other channel parameters are fD = 90 Hz and t0 = 0. Solid
curves are TS results, dashed curves are FS results.
Multipath
Rayleigh
Fading
Channel
Receiving
Filter
Adaptive
MLSE
Equalizer
(
)
−
j
j
jT
t
h
x
η(t)
t = kT
rk
D
kx −
ˆ
Multipath
Rayleigh
fading
channel
Receiving
filter
Adaptive
MLSE
equalizer
(
)
−
j
j
jT
t
h
∑x
η(t)
t = kT
rk
D
kx −
ˆ
Figure 6.18 System model.
6.4
LMS-ADAPTIVE MLSE EQUALIZATION ON MULTIPATH
FADING CHANNELS
Within this section we are going to drop the assumption that the channel is statistically known and
deal with the problem where both data and channel have to be estimated simultaneously.
6.4.1
System and channel models
The system model is given in Figure 6.18.
The received signal can be represented as
rk =
L

i=0
xk−ig∗
k,i + ηk
(6.23)
rk = gH
k xk + ηk
where
gk = [gk,0, gk,1, . . . , gk,L]T,
xk = [xk, xk−1, . . . , xk−L]T
1
2 E{gk,i g∗
k−l, j} = Rg(l, i, j)

LMS-ADAPTIVE MLSE EQUALIZATION ON MULTIPATH FADING CHANNELS
285
Viterbi
Detector
Channel
Predictor
LMS
Estimator
Training
Sequence
Generator
D
rk
rk-D
D
k
g −
~
D
kx −
ˆ
D
kx −
ˆ
k
gˆ
Estimation
Training
Viterbi
detector
Channel
predictor
LMS
estimator
Training
sequence
generator
D
rk
rk-D
D
k
g −
~
D
kx −
ˆ
D
kx −
ˆ
k
gˆ
Estimation
Training
Figure 6.19 Adaptive MLSE equalizer.
Parameter gk,i represents the samples of the equivalent channel impulse response. The operation of
the system is presented in Figure 6.19. For data estimation by the Viterbi algorithm, the system uses
the channel estimates. The Viterbi algorithm delay is DT. This class of algorithms is known as delayed
decision-directed equalization.
The metric used in the Viterbi detector is |rk −L
i=0 xk−i ˆg∗
k,i|2
6.4.2
Adaptive channel estimator and LMS estimator model
Assuming that the feedback decisions are correct, i.e. ˆxk−D = xk−D at the input of the LMS estimator,
and the order of the LMS estimator is L + 1 the following step is implemented: the LMS estimator
updates ˜gk−D each time by:
˜gk−D = ˜gk−D−1 + µxk−Dα∗
k−D
where
αk−D = rk−D −˜gH
k−D−1xk−D
(6.24)
6.4.3
The channel prediction algorithm
The linear prediction generates
ˆgk =
q

j=0
α j ˜gk−D−j
(6.25)
where α0, . . . , αq are constants and q is a positive integer. Due to delay DT of the Viterbi algorithm,
the straight line extrapolator is used
ˆgk = ˜gk−D + p
q (˜gk−D −˜gk−D−q)
(6.26)
where p is the prediction step. Although there exist many other channel predictions from simula-
tion results and comparisons, the straight line extrapolator gives fair performance and very simple
implementation. If the autocorrelation function Rg(l, i, j) is known by the receiver, the prediction
coefﬁcients α j can be obtained from the Wiener solution. Some performance results are given in
Figures 6.20–6.24.
MLSE equalizers are discussed in [65–75].

286
CHANNEL ESTIMATION AND EQUALIZATION
0.0
10.0
20.0
30.0
40.0
50.0
60.0
Eb /N0 (dB)
100
10−1
10−2
10−3
10−4
10−5
10−6
Block error rate
fD = 84
fD = 84
fD = 50
fD = 50
fD = 24.3
fD = 24.3
fD = 6.7
fD = 6.7
Simulation
Bound
Figure 6.20 Analytical and simulation results for adaptive MLSE employing straight line
extrapolation prediction on a two-tap Rayleigh fading channel with fD = 6.7,
24.3, 50 and 84 Hz.
0.0
10.0
20.0
30.0
40.0
50.0
60.0
Eb /N0 (dB)
100
10−1
10−2
10−3
10−4
10−5
10−6
Block error rate
fD = 84
fD = 84
fD = 50
fD = 50
fD = 24.3
fD = 24.3
fD = 6.7
fD = 6.7
Simulation
Bound
Figure 6.21 Analytical and simulation results for adaptive MLSE employing linear channel
prediction on a two-tap Rayleigh fading channel with fD = 6.7, 24.3, 50 and
84 Hz.

LMS-ADAPTIVE MLSE EQUALIZATION ON MULTIPATH FADING CHANNELS
287
0.0
10.0
20.0
30.0
40.0
50.0
60.0
Eb /N0 (dB)
100
10−1
10−2
10−3
10−4
10−5
10−6
Block error rate
fD = 84
fD = 50
fD = 50
fD = 24.3
fD = 24.3
fD = 6.7
fD = 6.7
Simulation
Bound
Figure 6.22 Analytical and simulation results for adaptive MLSE without channel predic-
tion on a two-tap Rayleigh fading channel with fD = 6.7, 24.3, 50 and 84 Hz.
(Note that the analytical bound of the case of fD = 84 Hz is greater than 1 and
hence not shown.)
0.0
0.1
0.2
0.3
0.4
0.5
100
10−1
10−2
10−3
10−4
10−5
Block error rate
fD = 84
fD = 50
fD = 24.3
fD = 6.7
Bound
Simulation
step size parameter µ
Figure 6.23 Analytical and simulation results obtained by varying the step size parameter
µ at Eb/N0 = 35 dB.

288
CHANNEL ESTIMATION AND EQUALIZATION
0.0
0.1
0.2
0.3
0.4
0.5
100
10−1
10−2
10−3
10−4
10−5
Block error rate
fD = 84
fD = 50
fD = 24.3
fD = 6.7
step size parameter µ
Eb/N0 = 35 dB
Eb/N0 = 40 dB
Figure 6.24 Analytical results obtained by varying the step size parameter µ at Eb/N0 =
35 dB and 40 dB.
6.5
ADAPTIVE CHANNEL IDENTIFICATION AND DATA DEMODULATION
The estimation technique presented in Section 6.4 is rather inefﬁcient when detection delay D or
Doppler fD increase. In such examples, a joint estimation of both data and channel would give better
results. Unfortunately, pure joint estimation would be too complex. In this section we present an
algorithm where the joint ML function is maximized by alternating the maximization process with
respect to data (given the channel) and channel (given data from the previous iteration).
6.5.1
System model
The received signal is given as
rk =
L

l=0
hl(k)ak−l + nk,
k = 1, 2, . . . , N
(6.27)
h(k) = [h0(k), h1(k), . . . , hL(k)]T
The memory L of the channel is determined by the time spread Tmax of the actual channel and the
symbol period Ts:
L =
 Tmax
Ts

+ 1
6.5.2
Joint channel and data estimation
The approach used in this section is based on [76]. The process is described by the following steps.
6.5.2.1
Block sequence estimation (BSE)
r The received sequence is fed into the metric computation unit in blocks of Nb symbols at a time.
r The data demodulation is also performed in blocks, rather than symbol by symbol as in the
conventional VA.

ADAPTIVE CHANNEL IDENTIFICATION AND DATA DEMODULATION
289
r At time k the receiver processes a block of Nb data symbols (rk, . . . ,rk+Nb−1).
r After computing the path metrics at time k + Nb −1, the survivor paths of each state are traced
backwards in the trellis in order to detect a merge.
r If a merge occurs within the block, at the time k + Nb −1 −δ (δ < Nb), decisions are made on
the data sequence {ak, . . . , ak+Nb−1−δ}.
r The initial point of the next block is set at time k + Nb −1 −δ and the next Nb data symbols are
processed.
r This means that the portion of the received symbols (rk+Nb−δ, . . . ,rk+Nb−1) is processed twice.
r The state metrics at time k + Nb −1 −δ are reset to a large number except for the metric of
the state at which the merge occurred. This metric is set to zero. This way the chances of errors
associated with illegal state transitions at the beginning of the new block are reduced. It is equivalent
to restarting the VA from a known initial state.
r If a merge is not detected within the block (δ < Nb), the state with the minimum metric at the end
of the block (at the time k + Nb −1) is chosen and its survivor path is traced backwards in the
trellis.
r A merge is assumed at time k + Nb −δ (δ = ⌈Nb/2⌉) on the best survivor path.
r The state metrics at time k + Nb −1 −δ are reset to a large number, except for the metric of the
best survivor. This metric is set to zero.
6.5.2.2
Block adaptive channel estimation
In the derivation of the adaptive schemes for the CIR estimation we will temporarily assume that the
channel is unknown but static. The discrete time index k will be dropped from Equation (6.27) to
simplify the notation. We will revisit the time varying CIR scenario in subsequent sections. In vector
notation, Equation (6.27) can be written as:
r = Ah + n
(6.28)
where
r = [r1, . . . ,rN]T, h = [h0, . . . , hL]T, n = [n1, . . . , nN]T,
and
A =


a1
a0
· · ·
a1−L
a2
a1
· · ·
a2−L
...
...
...
...
aN
aN−1
· · ·
aN−L


(6.29)
Let us use a = [a1−L, . . . , aN]T to denote the transmitted data vector.
6.5.2.3
Maximum likelihood (ML)
ML estimates of the channel hML and data aML are those that maximize the conditional probability
density function (pdf) p(r|a, h) or, equivalently, minimize |r−Ah|2. With respect to A and h
(aML, hML) =
arg min
a∈AN+L−1,h∈RL |r −Ah|2
(6.30)
The joint minimization over a and h cannot be computed in closed form. When either a or h is ﬁxed,
this minimization is a well known problem. When the channel h is ﬁxed, the ML estimate of a is

290
CHANNEL ESTIMATION AND EQUALIZATION
computed via the VA. When the data a is given, the minimization of C(A, h) = |r −Ah|2 over h is
a standard least squares problem which results in
hML = (AHA)−1AHr
(6.31)
Thus, the joint minimization of C(A, h) over A and h can be viewed as an alternative minimization
type of problem.
6.5.2.4
Iterative procedure
The above algorithms can be summarized as:
1. Start with an initial estimate ˆh(0) of the channel.
2. Minimize C( ˆA, ˆh) with respect to ˆA via the VA to obtain ˆA(l).
3. Minimize C( ˆA, ˆh) w.r.t. ˆh(l) to obtain
ˆh(l + 1) = [ ˆAH(l) ˆA(l)]−1 ˆAH(l)r
(6.32)
4. Repeat Steps 2 and 3 until the algorithm converges.
Simulation studies have shown that this scheme can converge very fast to a global minimum (in
approximately 5–6 iterations).
The above algorithm pays a heavy price as a tradeoff for its optimum performance. The receiver
has to process a long received sequence (in the order of a few thousands of symbols) several times
before it can provide the user with any reliable decisions about the transmitted data. This implies
a signiﬁcant decision delay. The algorithm is impractical for real-time implementation, especially
when the channel is time varying. This is a strong motivation for constructing algorithms to perform
the joint channel and data estimation recursively in time, which provides the user with reliable data
estimates quickly enough to be able to adopt to channel variations too.
6.5.2.5
Iterative CIR estimator
In this case we have
ˆh(l + 1) = ˆh(l) + µ ∂[ln p(r| ˆA, h)]
∂h

h=ˆh(l)
(6.33)
= ˆh(l) + µ ˆAH[r −ˆAˆh(l)]
If we can achieve perfect convergence, then
ˆh(l + 1) = ˆh(l) ⇔ˆAH[r −ˆAˆh(l)] = 0 ⇔h(l)
(6.34)
= ( ˆAH ˆA)−1 ˆAHr
which is exactly the ML estimate of the channel. In Equation (6.32), ˆA and r extend over the whole
data record. If, instead, we consider only a portion of data, i.e. a block of Nb symbols, then each time
we update the CIR estimate we can perform the joint ML estimation of data and channel recursively
in time. Notice that Equation (6.33) has the form of a block least mean square (BLMS) equation.
This is a consequence of the quadratic exponent of the Gaussian probability distribution of the noise
vector. Given the CIR estimate ˆh(l) at the lth recursion, the corresponding block of data estimates
can be provided by the BSE, as was developed earlier. Starting from an initial guess, ˆh(0), for the
CIR we construct a joint data and channel estimation scheme which operates on successive blocks of
data in a time recursive manner.

ADAPTIVE CHANNEL IDENTIFICATION AND DATA DEMODULATION
291
6.5.2.6
BSE/BLMS algorithm
In this case:
1. Start with an initial estimate ˆh(0) of the CIR. Initialize the block counter (l →1) and the
symbol counter (k →1).
2. Receive the lth block of data r(l) = [rk, . . . ,rk+Nb−1]T, where Nb is the block length.
3. Apply the BSE on r(l), using ˆh(l −1) for metric computations, to obtain the lth block of data
estimates:
ˆa(l) = [ˆak, . . . , ˆak+Nb−1−δ(l)]T
where δ(l) is the merging delay of the BSE for the lth block.
4. Using the data estimates ˆa(l) and the ﬁrst Nb −δ(l) entries of the lth block of received symbols
rδ(l) = [rk, . . . ,rk+Nb−1−δ(l)]T, update the CIR estimate as follows:
ˆh(l) = ˆh(l −1) + µ ˆAH(l)[rδ(l) −ˆA(l)ˆh(l −1)]
(6.35)
The matrix ˆA(l) is given by:
ˆA(l) =


ˆak
ˆak−1
· · ·
ˆak−L
ˆak+1
ˆak
· · ·
ˆak+1−L
...
...
...
...
ˆak+Nb−1−δ(l)
ˆak+Nb−2−δ(l)
· · ·
ˆak+Nb−1−δ(l)−L


(6.36)
and µ is a step size parameter.
5. Reset the block and symbol counters to l →l + 1 and k →k + Nb −δ(l) and go to Step 2
until all data have been processed. An issue is the choice of the step size parameter µ. A
large value of µ would provide faster adaptation but could lead to divergence of the channel
estimate. On the other hand, if µ is too small, we will lose a lot of data while trying to acquire
the channel.
6.5.2.7
Recursive least squares (RLS) channel estimation
In this case the CIR estimation is based on the minimization of the weighted sum of the squared
errors
J(k) =
k

l=0
λk−le2(l) =
k

l=0
λk−l|rl −ˆhT(k) · ˆa(l)|2
(6.37)
where ˆh(k) = ⌊ˆh0(k), . . . , ˆhL(k)⌋T is the CIR estimate at time k, ˆa(l) = [ˆal, . . . , ˆal−L]T is the vector
of the estimated data at times l, . . . ,l −L and rl is the received signal at time l. The parameter
λ, (0 < λ ≤1) gives more weight to recent errors. Thus, we allow for time varying channels. The
RLS algorithm for the CIR estimation is described as [77–79]:
g(k) =
P(k)ˆa∗(k)
λ + ˆaT(k)P(k)ˆa∗(k)
P(k + 1) = 1
λ[P(k) −g(k)ˆaT(k)P(k)]
e(k) = rk −ˆhT(k)ˆa(k)
(6.38)
ˆh(k + 1) = ˆh(k) + e(k)g(k)
k = 1, 2, . . .
To initialize the algorithm we set P(0) = ε−1I, where ε is a small positive constant.

292
CHANNEL ESTIMATION AND EQUALIZATION
{rk}
{rk}
l →l + 1
k →k + Nb -δ (l)
)
ˆ
,
ˆ
(
)
(
)
(
1
l
N
k
k
b
a
a
l
δ
−
−
+
=
a
BSE
)
,
,
(
)
(
)
(
1
l
N
k
k
b
r
r
l
δ
δ
−
−
+
=
r
)
,
,...
,...
,...
(
)
(
1
−
+
=
b
N
k
k
r
r
l
r
Channel
estimator
ˆ
Figure 6.25 Schematic diagram for adaptive BSE [76]
C⃝1998, IEEE.
6.5.2.8
BSE/RLS algorithm
Incorporating the CIR update into the recursive joint channel and data estimation algorithm gives:
1. Start with an initial estimate ˆh(0) of the CIR. Initialize the block counter (l →1) and the
symbol counter (k →1).
2. Receive the lth block of data r(l) = [rk, . . . ,rk+Nb−1]T, where Nb is the block length.
3. Apply the BSE on r(l), using ˆh(l −1) for metric computations, to obtain the lth block of data
estimates:
ˆa(l) = [ˆak, . . . , ˆak+Nb−1−δ(l)]T,
where δ(l) is the merging delay of the BSE for the lth block.
4. Using the data estimates ˆa(l) and the ﬁrst Nb −δ(l) entries of the lth block of received symbols
rδ(l) = [rk, . . . ,rk+Nb−1−δ(l)]T, obtain the new CIR estimate ˆh(l) by executing the RLS recursion
Nb −δ(l) times.
5. Reset the block and symbol counters to l →l + 1 and k →k + Nb −δ(l) and go to Step 2
until all data have been processed.
A schematic diagram of adaptive BSE (BSE/BLMS or BSE/RLS) is shown in Figure 6.25.
The adaptive BSE derives its strength from the fact that, due to the variable decision delay, the data
estimates used for CIR tracking are more likely to be taken from the ML path. The block processing
of the data contributes to the averaging of the effects of symbol errors. Thus, the CIR estimator is
fed with better data estimates, which improves its tracking capability compared to the conventional
adaptive MLSE.
The possible data errors towards the end of each block, caused by computing the metrics for the
whole block using the same CIR estimate, are alleviated by the fact that the last symbols of each
block are processed again with the updated CIR estimate. If the fading rate gets higher, the block
length Nb must be chosen carefully so that the CIR estimate is not outdated. A choice of Nb ≈5L is
a good rule of thumb.
6.5.3
Data estimation and tracking for a fading channel
In a static channel environment, the BSE/BLMS and BSE/RLS as described so far, operate starting
from an initial guess ˆh(0) of the CIR. For a fading channel, the task of CIR acquisition is much
heavier, especially when the fading rate becomes high. In such environments, the CIR acquisition

ADAPTIVE CHANNEL IDENTIFICATION AND DATA DEMODULATION
293
is accomplished via a training sequence, which is periodically sent to the receiver as a portion of a
ﬁxed size data packet. This format is used in mobile communications. An example of such a data
structure is the time division multiple access (TDMA) slot of the IS-54 North American Digital
Cellular standard described brieﬂy in Chapter 1.
6.5.3.1
Training
The BSE/BLMS, BSE/RLS can be applied in this signaling format with an appropriate adjustment in
the CIR acquisition step. This is accomplished by feeding the above described adaptive algorithms
(BLMS or LMS, RLS) with the training symbols at the header of the TDMA slot, producing the CIR
estimate ˆh(0). As soon as the acquisition stage is over, the BSE/BLMS or BSE/RLS is activated for
joint data estimation and channel tracking, as described in the previous subsections, for the duration
of the entire TDMA slot. The performance of this scheme, obtained by simulation, is now presented.
6.5.3.2
Performance and computational complexity
In the evaluation of the system performance the same assumptions are used as in [76]:
r Static and fading channel environments.
r To cover both the static and time varying CIR, the SNR is deﬁned as
SNR = 10 log

σ 2
a
σ 2
L

i=0
E(|hi|2)

where σ 2
a and σ 2 are the variances of the input data and additive noise, respectively.
r The above deﬁnition implies independence of the CIR variations from the transmitted data se-
quence, which is quite a reasonable assumption.
6.5.4
The static channel environment
r CIR is assumed constant for the duration of the entire received data record.
r In the simulation there is no training sequence, i.e. the BSE operates in a blind fashion.
r The modulation format is binary phase shift keying (BPSK).
r No coding is assumed.
r The input alphabet is {−1, 1}, i.e. the transmitted data sequence {ak} consists of real numbers.
r Two particular channel examples are used whose impulse responses are given by the vectors
h1 = [0.407, 0.815, 0.407] and h2 = [0.1897, 0.5097, 0.6847, 0.46, 0.1545], respectively.
r Both channels exhibit deep nulls in their magnitude response within the frequency band of interest.
r Channel 2 has non-linear phase characteristics.
r As a result, linear equalization methods exhibit very poor performance on these channels.
r The MLSE for the corresponding known channel is used in Figure 6.26 for comparison
6.5.4.1
Simulations/BSE/BLMS
r The error rates are steady state after the channel acquisition has been completed.
r The acquisition (convergence) time is described independently.

294
CHANNEL ESTIMATION AND EQUALIZATION
r In both cases the block length is chosen to be Nb = 8L and the step size parameter µ = 0.01.
r The initial guesses for Channels 1 and 2 are ˆh(0) = [0, 1, 0] and ˆh(0) = [0, 0, 1, 0, 0], respectively.
r The probability of error is estimated over a data record of 100 000 symbols.
r The performance is very close to that of the known CIR environment.
r For comparison purposes, a linear blind equalizer (Sato’s algorithm) described by Equation (6.16)
is used. As expected, it fails to converge at all for this type of channel.
6.5.4.2
The BSE/RLS
r Is simulated for Channels 1 and 2, starting with the same initial guesses for the channels as in
BSE/BMLS.
r For the initialization of the BSE/RLS, the parameters λ = 1 and ε = 0.001 are used in P(0).
r The performance of the BSE/RLS in Figure 6.26 is also very close to that of the known channel.
r An improvement is observed for Channel 2 compared to the BSE/BLMS, especially at high SNR.
This is no surprise, since acquisition capability (convergence speed) is better than the LMS at high
SNR.
r The tradeoff for the improved performance of the BSE/RLS, however, is its increased computational
complexity.
4
6
8
10
12
14
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR (dB)
Pr (symbol error)
 Sato, channel 1         
 BSE/BLMS Channel 1      
 BSE/known CIR Channel 2 
 BSE/BLMS Channel 2      
 BSE/known CIR, Channel 1
 BSE/RLS Channel 1       
 BSE/RLS Channel2        
Figure 6.26 Probability of symbol error versus SNR using the BPSK waveform for the
BSE/BLMS and the BSE/RLS algorithms over Channels 1 and 2.

ADAPTIVE CHANNEL IDENTIFICATION AND DATA DEMODULATION
295
4
6
8
10
12
14
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR (dB)
Pr(symbol error)
 BSE/BLMS, Nb = 3L
 BSE/BLMS, Nb = 4L
BSE/known CIR     
BSE/BLMS, Nb = 5L 
Figure 6.27 Probability of symbol error versus SNR using the BPSK waveform for the
BSE/BLMS algorithm with various values of Nb over Channel 1.
6.5.4.3
The effect of the block length Nb
BSE/BLMS is simulated on Channel 1 for Nb = 8L, 5L, 4L and 3L symbols and the results are
shown in Figure 6.27.
r The performance degradation for smaller Nb must be attributed to the BSE algorithm.
r As the block length becomes smaller, the number of blocks in which no merge occurs increases.
r Bad data decisions are forced, reﬂecting upon the channel estimate too.
6.5.4.4
The convergence properties
r 300 independent Monte Carlo runs of BSE/BLMS are performed and the average squared error
|ˆh −h|2 as the number of processed data varies between 100 and 1000 symbols is computed.
r Simulations are performed for block sizes Nb = 5L, 10L and 15L points, and for SNR = 6 and
12 dB.
r The results are shown in Figure 6.28.
r For Channel 1, independent of the block size, we approach the steady state mean squared error
within the ﬁrst few hundred symbol periods.
r For SNR = 6 dB the steady state is reached after processing about 700 symbols, while for SNR =
12 dB we need approximately 400 symbols. This allows us to specify the acquisition time for the
BSE/BLMS at about 400 symbol periods.

296
CHANNEL ESTIMATION AND EQUALIZATION
Nb
SNR = 6 dB)
SNR = 6 dB)
Nb
Nb
Nb
L
L
L,
L,
5
5
Figure 6.28 Channel estimate error variance for Channel 1 versus number of symbols
processed using the BSE/BLMS algorithm at SNR equal to 6 and 12 dB.
6.5.5
The time varying channel environment
In this segment a TDMA with the following parameters is simulated.
r The carrier frequency is assumed to be 900 MHz and the bit rate 48.6 kb/s.
r For QPSK modulation, that translates to a baud rate of 24.3 ksymbols/s, or a symbol period
Ts = 41 µs.
r The mobile radio channel is assumed to be wideband with L + 1 taps.
r Each element of the CIR {hi(k)}L
i=0 is modeled as an independent low pass zero mean complex
Gaussian random process with Rayleigh distributed amplitude and uniformly distributed phase in
the interval [−π, π].
r Each of the his is generated by passing a zero mean white complex Gaussian noise sequence
through a digital second order Butterworth ﬁlter whose cutoff frequency fd is determined by
fd = Ts

fc
v
vc

where fd is the normalized Doppler shift, fc is the carrier frequency, and v and vc are the vehicle
speed and speed of light, respectively. This simulation procedure is widely used in the literature.
r For these system speciﬁcations the performance of all algorithms is investigated for vehicle speeds
ranging from v = 60 mph (100 km/h) up to 150 mph (248 km/h).
r The corresponding normalized Doppler shift ranges from fd = 0.0034 to 0.0085.
r A three-tap CIR (L = 2) is used. For the speciﬁcations of the IS-54 standard (Ts = 41 µs), this
channel model covers a maximum time spread of Tmax = 123 µs.

ADAPTIVE CHANNEL IDENTIFICATION AND DATA DEMODULATION
297
10
12
14
16
18
20
22
24
26
28
30
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR (dB)
Pr (symbol error)
MLSE known CIR
BSE/LMS       
no tracking   
Figure 6.29 Symbol error rate performance of the various adaptive MLSE algorithms at a
vehicle speed of 60 mph.
r The CIR elements h0(k), h1(k), h2(k) are constructed so as to have equal power σ 2
h = 1/3 and to
be independent of each other.
r This corresponds to a fading scenario where no line of sight is present (Rayleigh fading).
Figure 6.29 compares the performance of all algorithms tested: the BSE; the conventional adaptive
MLSE; a variable D (delay in the CIR estimation loop) version of the conventional adaptive MLSE;
and the Per Survivor Processing (PSP) known CIR environment. PSP estimates the channel only
for the surviving trajectories in VA, and for those trajectories data is known. This corresponds to an
ideal receiver capable of estimating the CIR perfectly, with zero delay, which is unrealistic when the
channel is varying rapidly.
The adaptive D version of the conventional MLSE is derived by detecting a merge within Nb
epochs from the current symbol and setting D equal to the merging delay. If no merge is detected, D
is set to Nb −1. The symbol error rate is computed as the fraction of data symbols that are in error
over a time interval of 5000 consecutive TDMA slots, each packet of which has the structure shown
in Chapter 1. For convenience, only the initial training symbols and the information symbols inside
the TDMA slot were considered.
For LMS channel acquisition and tracking, the optimum value of the step size parameter was found
to be µ = 0.06 for fd = 0.0034 and µ = 0.12 for fd = 0.0085, at SNR = 20 dB. The optimum value
of the weight parameter was found to be λ = 0.73 for fd = 0.0085 at SNR = 20 dB. For all of the
simulated algorithms presented, the initial CIR guess at the beginning of the ﬁrst TDMA slot was set
at ˆh(0) = [0, . . . , 0]. The last CIR estimate computed at the end of each subsequent slot is utilized to
initialize the LMS or RLS at the beginning of the next slot.
6.5.5.1
Performance
In Figure 6.29, the performance of all the adaptive MLSE algorithms is presented for fd = 0.0034
(82.6 Hz), which corresponds to a vehicle speed of 60 mph. The following parameters were used.

298
CHANNEL ESTIMATION AND EQUALIZATION
r An LMS update was used for the CIR acquisition and tracking. The step size parameter was set at
µ = 0.06 for all algorithms.
r For the conventional adaptive MLSE, the optimum performance was achieved for a delay in the
CIR estimation loop equal to D = 4.
r The decision delay was set at δ = 5L for both the PSP, the conventional MLSE and the adaptive
D MLSE.
r For the BSE/LMS a block length Nb = 11 was found to yield the best performance.
r Both the PSP and the BSE/LMS exhibit a clear advantage over the conventional adaptive MLSE
at SNR above 20 dB.
r The adaptive D MLSE also exhibits a performance advantage over the conventional MLSE and
gets closer to the BSE at high SNR.
r For comparison purposes a receiver which performs no tracking of the CIR after the initial
acquisition mode was also simulated. It reaches a ﬂoor of about 2 × 10−1 at SNR = 20 dB. This
clearly enforces the necessity of the use of CIR tracking algorithms even at this fading rate.
Figure 6.30 presents the performance of all algorithms for fd = 0.0085 (206.5 Hz), and a speed
of 150 mph. Both the LMS and RLS were used for CIR acquisition and tracking. For the LMS, the
step size parameter was set at µ = 0.12 and for the RLS, the weight parameter was set at λ = 0.73,
for all algorithms. The optimum parameters were again found to be D = 4 and Nb = 11. The PSP
and the BSE exhibit a clear advantage over the conventional and adaptive D MLSE at high SNR.
A much poorer performance was exhibited by all algorithms compared to the smaller vehicle speed
in Figure 6.29. The performance degradation must be attributed to the higher fading rate making it
very difﬁcult to track the channel variations. The RLS exhibited slightly better performance at high
SNR, which was anticipated. Absence of CIR tracking yields a ﬂoor of 0.5 probability of symbol
error at SNR = 10 dB.
Figure 6.31 presents the error rates for the information symbols inside the TDMA slot for fd =
0.0085 at SNR = 20 dB with LMS update. In the ﬁgure, only every other information symbol is
10
12
14
16
18
20
22
24
26
28
30
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR (dB)
Pr(symbol error)
MLSE, known CIR
 no tracking   
 BSE/RLS       
Figure 6.30 Symbol error rate performance of the various adaptive MLSE algorithms at a
vehicle speed of 150 mph. The results from the use of either the LMS or the
RLS channel estimates are shown.

ADAPTIVE CHANNEL IDENTIFICATION AND DATA DEMODULATION
299
0
10
20
30
40
50
60
70
80
90
100
110
120
130
10
−3
10
−2
10
−1
10
0
Symbol position in TDMA slot
Pr(symbol error)
mu=0.06
no tracking 
BSE/LMS     
fd=0.03 
v=60miles/h 
(a)
0
20
40
60
80
100
120
10
−3
10
−2
10
−1
10
0
Symbol position in TDMA slot
Pr (symbol error)
 BSE/LMS    
no tracking 
mu = 0.12 
(b)
Figure 6.31 Data symbol error rate versus symbol position in the TDMA slot at SNR =
20 dB using the LMS channel acquisition and tracking algorithms (a) v =
60 mph; (b) v = 150 mph.

300
CHANNEL ESTIMATION AND EQUALIZATION
plotted. The error rates tend to increase toward the end of the slot, even with CIR tracking algorithms.
If no CIR tracking is employed, the error rates become unacceptable after the ﬁrst 10–20 symbols
within the TDMA slot. For BSE/LMS at 60 mph and error rate 10−3 there is a 10 dB worse performance
from the lower bound of a known channel. PSP has manifested a similar performance. At 150 mph
the error rate of all algorithms levels off at residual error rates larger than 10−2, even at 30 dB. All
algorithms fail at a velocity of 150 mph.
6.5.5.2
Computational complexity and reconﬁguration efﬁciency
Computational complexity is measured by the required number of multiplications, Nmul, and additions,
Nadd, per data sample. The complexity is computed for a CIR of length L + 1 and an alphabet size M.
The exact number of required operations per data symbol for the BSE cannot be expressed in closed
form because of the variable merging delay inside each block. If ¯δ denotes the average merging delay
over all blocks processed, then the required operations for metric computations per data symbol must
be multiplied by a factor
fex =
1
[1 −¯δ/Nb]
to account for processing the last part of each block twice. Parameter ¯δ is obtained from simulations.
The three-tap fading channel (L = 2) of the previous section is used and 5000 frames of PSK data
(M = 4) are processed, amounting to 82 953 processed blocks, each of length Nb = 11 symbols. The
fading rate is set at fd = 0.0034 and the SNR is 30 dB. ¯δ = 2.9453 symbols is found, which gives
fex = 1.365662.
Table 6.1 presents the number of complex operations required per data symbol for metric calcula-
tions in the adaptive MLSE algorithm. Table 6.2 presents the required number of complex operations
per symbol for this speciﬁc example, with both LMS and RLS updates for all channel estimators.
For the Sato algorithm, discussed in Section 6.2, a tapped delay line equalizer with Lsa = 16 taps is
assumed. From Tables 6.1 and 6.2, the conventional adaptive MLSE requires the smallest number
of operations of all MLSE-based techniques, but signiﬁcantly more operations than linear equalizers
such as Sato’s algorithm. The BSE requires an increased number of operations for the metric update
compared to the conventional adaptive MLSE due to reprocessing the last part of each data block.
A hardware implementation of the BSE would be more difﬁcult due to the necessary checks for the
detection of a merge inside each block. For the CIR estimation part, the PSP requires considerably
more operations than all other techniques due to the multiple CIR estimates that it preserves (one
for each state). This overhead becomes even larger if the RLS estimation algorithm is used for CIR
tracking.
Table 6.1
Complex operations per data symbol for adaptive MLSE algorithms (metric
calculations)
Conventional
adaptive
MLSE
BSE
PSP
Sato
Metric
Nmul
M L+1(L + 1)
M L+1(L + 1) fex
M L+1(L + 1)
0
Update
Nadd
M L+1(L + 1)
M L+1(L + 1) fex
M L+1(L + 1)
0
CIR update
Nmul
2(L + 1)
2(L + 1)
M L+1(L + 1)
2(Lsa + 1)
(LMS)
Nadd
2(L + 1)
2(L + 1)
M L+1(L + 1)
2(Lsa + 1)
CIR update
Nmul
4(L2 + L)
4(L2 + L)
M L4(L2 + L)
(RLS)
Nadd
3(L2 + L)
3(L2 + L)
M L3(L2 + L)

TURBO EQUALIZATION
301
Table 6.2
Complex operations per data symbol for M = 4
and L = 2 (channel estimations)
Conventional
adaptive MLSE
BSE
PSP
Sato
Metric
Nmul
192
262
192
0
Update
Nadd
192
262
192
0
CIR update
Nmul
6
6
96
34
(LMS)
Nadd
6
6
96
34
CIR update
Nmul
24
24
384
(RLS)
Nadd
24
24
384
For the calculation of reconﬁguration efﬁciency, relations deﬁned in Chapters 2 and 3 are still
valid. For practical applications the relative complexity Dr can be calculated by using data directly
from Tables 6.1 and 6.2.
More details on the topic can be found in [80–93].
6.6
TURBO EQUALIZATION
In this section we discuss how the problem from Section 6.5 can be solved by using the turbo principle
discussed in Chapter 2.
6.6.1
Signal format
The transmitted signal s(t) is provided by the output of a ﬁlter whose impulse response is he(t). The
signal emitted can be expressed in the form:
s(t) = A

k
ckhe(t −kT ) exp j(2π f0t + ϕ0)
(6.39)
In a multipath channel, the received signal y(t), can be written as follows:
y(t) =
M−1

m=0
Am(t)

k
ckhe(t −τm −kT ) exp j(2π f0t + ϕ0) + w(t)
(6.40)
where Am(t) are complex-valued independent multiplicative noise processes. The receiver matched
ﬁlter output
Rn ˆ= R(nT ) =
M−1

m=0
Am(n)

k
cn−khs(kT −τm) + wn
(6.41)
where Am(n) equals Am(nT ) by deﬁnition, wn denotes the response of the receiving matched ﬁlter
to the noise w(t), sampled at time nT . hs(t) is deﬁned by hs(t) = he(t) × h∗
e(−t) and satisﬁes the
Nyquist criterion.
k(n) =
M−1

m=0
Am(n)hs(kT −τm)
(6.42)

302
CHANNEL ESTIMATION AND EQUALIZATION
T
T
T
T
2
L
nc +
1
+
nc
nc
1
−
nc
1
L
nc −
( )
n
L2
−
Γ
( )
n
1
−
Γ
( )
n
0
Γ
( )
n
1Γ
( )
n
L1
Γ
n
b
n
R
Figure 6.32 Equivalent discrete time model of a channel with inter-symbol interference.
Let us suppose that the ISI is limited to (L1 + L2) symbols. Equation (6.41) may be written in the
form:
Rn =
L1

k=−L2
k(n)cn−k + wn
(6.43)
6.6.2
Equivalent discrete time channel model
Quantities k(n) are expressed as a linear combination of the multiplicative noises Am(n). Therefore,
they are Gaussian in the case of a Rayleigh-type channel and constant in the case of a Gauss-type
channel. Consequently, the set of modules made up of the modulator, the transmission channel and
the demodulator can be represented by an equivalent discrete time channel as shown in Figure 6.32.
6.6.3
Equivalent system state representations
By new indexing in Equation (6.43) we have:
Rn =
L1+L2

k=0
k−L2(n)cn+L2−k + bn
(6.44)
If we denote Sn = (cn+L2, . . . , cn−L1+1) the state of the equivalent discrete time channel at time nT
sample Rn depends on the channel state Sn−1 and on the symbol cn+L2. Therefore, the equivalent
discrete time channel can be modeled as a Markov chain and its behavior can be represented by the
trellis diagram shown in Figure 6.33.
6.6.4
Turbo equalization
In order to use a soft-input channel decoder, the symbol detector has to provide information about the
reliability of the symbols estimated. This information may be obtained by using a soft-output Viterbi
algorithm (SOVA) (the name often used for the algorithm described in Appendix 2.1), that associates
an estimation of the logarithm of its likelihood ratio (LLR), 	1(cn), to each symbol cn detected:
	1(cn) = log Pr{cn = +1|R}
Pr{cn = −1|R}
(6.45)

TURBO EQUALIZATION
303
11
10
01
00
11
10
01
00
(
)T
n
1
−
nT
1
−
n
S
n
S
1
1
−
−
n
n
c
c
1
1
−
−
n
n
c
c
1
1 =
+
nc
0
1 =
+
nc
Time
Figure 6.33 Trellis diagram for L1 = L2 = 1.
Soft-output
Symbol
Detector
Deinteleaver
Soft-output
Channel
Decoder
+
-
Interleaver
( )
nc
1
∧
(
)
kc
1
∧
(
)
kc
2
∧
kz
nz
Decoded Data
n
R
Figure 6.34 Extrinsic information deriving scheme.
where R denotes the vector of samples that constitutes the observation. After deinterleaving, the
SOVA decoder provides a new LLR value of ck, 	2(ck), that may be derived by analogy with the
calculations used in Chapter 2 and expressed in the form:
	2(ck) = 	1(ck) + zk
(6.46)
where zk is the extrinsic information associated with symbol ck and provided by the channel decoder
(Figure 6.34).
The extrinsic information zk is another estimation of the LLR of symbol ck conditioned on the
decoding step:
zk = log Pr{ck = +1| decoding}
Pr{ck = −1| decoding}
(6.47)
Hence, zk may be used through a feedback loop by the symbol detector after interleaving. This is the
basis of the turbo equalization principle.
6.6.5
Viterbi algorithm
To evaluate the LLR of symbol cn−L1, the Viterbi algorithm used in the detector has to calculate a
metric
λi
n =
Rn −ri
n

2
−2σ 2
w log Pr{cn−L1 = i}
i = ±1
(6.48)
where:
ri
n =
L1+L2−1

k=0
ˆk−L2(n) · cn+L2−k + ˆL1(n) · i
i = ±1
(6.49)

304
CHANNEL ESTIMATION AND EQUALIZATION
ˆk−L2(n), 0 ≤k ≤L1 + L2 represents an estimation of quantity k−L2(n) and σ 2
w denotes the vari-
ance of noise wn, that is σ 2
w = E[|wn|2].
The a priori probabilities Pr{cn−L1 = i} used in Equation (6.48) may be estimated from the
extrinsic information zn−L1, if we assume that
zn−L1 = log Pr{cn−L1 = +1}
Pr{cn−L1 = −1}
(6.50)
From Equation (6.50)
Pr{cn−L1 = +1} ≈
exp zn−L1
1 + exp zn−L1
(6.51)
Pr{cn−L1 = −1} ≈
1
1 + exp zn−L1
Using Equations (6.51) and (6.48), metrics λi
n are equal to:
λ+1
n
=
Rn −r +1
n

2
−γ zn−L1
(6.52)
λ−1
n
=
Rn −r −1
n

2
Note that the common term log(1 + exp zn−L1) has been suppressed in Equation (6.52). Coefﬁcient
γ is a weight introduced to take into account variance σ 2
w and the fact that the extrinsic information
is only an estimation of the a priori probability. Its value depends on the signal to noise ratio, that is
to say the reliability of the extrinsic information.
6.6.6
Iterative implementation of turbo equalization
The different processing stages in the turbo equalizer present a non-zero internal delay, so turbo
equalizing can only be implemented in an iterative way. At each iteration q, a new value of extrinsic
information is calculated and used by the symbol detector at the next iteration. Therefore, the turbo
equalizer can be implemented in a modular pipelined structure, where each module is associated with
one iteration. Then, performance in bit error rate (BER) terms is a function of the number of chained
modules.
When extrinsic information is used by the symbol detector, it can be proved that, at iteration q,
the LLR of symbol cn, 	q
1(cn), may be expressed as:
	q
1(cn) = ˆ	q
1(cn) + γ qzq−1
n
(6.53)
where ˆ	q
1 is a term depending on the samples of observation R and on zq−1
n
, k ̸= n, and zq−1
n
denotes
the extrinsic information of symbol cn determined at iteration q −1. If we apply the same approach
as in turbo decoding described in Chapter 2, the quantity γ qzq−1
n
provided by the channel decoder
at the previous iteration has to be subtracted from 	q
1(cn) (see Equation (6.52)), as illustrated in
Figure 6.35. Hence, after deinterleaving, the channel decoder input is in fact equal to:
˜	q
1(cn) = 	q
1(cn)

zq−1
k
=0
(6.54)
At the channel decoder output, the extrinsic information zq
k may also be written as follows, using
Equation (6.46):
zq
k = 	q
2(cn)
 ˜	q
1(cn)=0
(6.55)
6.6.7
Performance
Performance of this device has been evaluated for a rate R = 1/2 recursive systematic encoder with
constraint length K = 5 and generators Gl = 23, G2 = 35. Bits were interleaved in a non-uniform

JCE AND DATA DETECTION OVER FADING CHANNELS
305
Soft-output
Symbol
Detector
Deinteleaver
Soft-output
Channel
Decoder
+
-
Interleaver
( )
nc
1
∧
(
)
kc
1
~∧
(
)
kc
2
∧
kz
nz
Decoded Data
n
R
-
+
nz
γ
Entrinsic information
Figure 6.35 Principle of turbo equalization (under the zero internal delay assumption).
matrix whose dimensions are 64 by 64. The modulation used was a BPSK modulation, with a Nyquist
ﬁlter whose transfer function Hs( f ) was a raised cosine with a rolloff α = 1, on both Gaussian and
Rayleigh channels.
For both channels, M = 5 independent paths were considered, each with a mean power Pm =
E[|Am(n)|2], so that the total mean power was normalized: M−1
m=0 Pm = 1. The delays τm were chosen
as multiples of T (τm = mT, k(n) = Ak(n) since hs[(k −m)T ] = δk−m,0). The coefﬁcients for the
Gaussian channel were chosen equal to:
0(n) =
√
0.45,
1(n) =
√
0.25,
2(n) =
√
0.15,
3(n) =
√
0.10,
4(n) =
√
0.05
For the Rayleigh channel, the ﬁve paths had equal mean power (Pi = 1/M, ∀i ∈[1, M]}. A
parameter BT , which is the product of the Doppler bandwidth and the symbol duration, ﬁxes the
variation velocity of the channel: the smaller BT is, the more slowly the channel parameters vary
during a time interval symbol.
The discrete time equivalent channel was modeled by a 16-state trellis, and the symbol detector
was working on the SOVA algorithm. The channel coefﬁcients k(n) were supposed perfectly known.
After deinterleaving, the soft estimations provided by the SOVA detector were used by the decoder,
which also worked on a 16-state trellis and the SOVA algorithm. The extrinsic information extracted
from the decoder was used by the symbol detector according to the principle depicted in Figure 6.35.
The BER was computed as a function of signal to noise ratio Eb/N0, where Eb is the mean energy
received per information bit dk and N0 is the noise power bilateral spectral density. The signal to
noise ratio Eb/N0 may be expressed as:
Eb
N0
=
M−1

m=0
Pm
σ 2
b
(6.56)
The results are shown in Figures 6.36–6.38 for different numbers of iterations n. One can see that
even for three iterations the performance curves approach the BER curve with no ISI.
More details on turbo equalization can be found in [94–103].
6.7
KALMAN FILTER BASED JOINT CHANNEL ESTIMATION AND DATA
DETECTION OVER FADING CHANNELS
In this section we consider the problem of joint channel and data estimation in a fading channel based
on using a Kalman-type estimator. The general system block diagram is shown in Figure 6.39. More
details can be found in [104–107]. The presentation in this section is based on [104]. The channel
model generator is shown in Figure 6.40.

306
CHANNEL ESTIMATION AND EQUALIZATION
3
4
5
6
7
8
9
10
−7
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 (dB)
BER
BPSK with symbol detection and 
without encoding               
BPSK with encoding and without
ISI on a Gaussian channel     
Binary output detection and 
decoding                    
# Turbo equalization 
# 1 
# 2 
# 3 
# 6 
Figure 6.36 Performance of turbo equalization over a Gaussian channel (convolutional
encoding with K = 5).
3
4
5
6
7
8
9
10
−7
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Eb/N0 (dB)
BER
BPSK with symbol detection and 
without encoding
BPSK with encoding and without
ISI on a Gaussian channel  
Binary output detection and 
decoding
# Turbo equalization 
# 1 
# 2 
# 3 
Figure 6.37 Performance of turbo equalization over a Rayleigh channel with BT = 0.1
(convolutional encoding with K = 5).

JCE AND DATA DETECTION OVER FADING CHANNELS
307
3
4
5
6
7
8
9
10
−7
10
−6
10
−5
10
−4
10
−3
10
σω2
10
−1
10
0
Eb/N0 (dB)
BER
BPSK with symbol detection and 
without encoding
BPSK with encoding and without
ISI on a Gaussian channel  
Binary output detection and 
decoding
# Turbo equalization 
Figure 6.38 Performance of turbo equalization over a Rayleigh channel with BT = 0.001
(convolutional encoding with K = 5).
−
)
(
iT
t
aiδ
Fading channel
+
ILPF
Digital
processor
t=kT
z(t)
zk
)
(t
η
}
ˆ
{
ia
∑
Figure 6.39 The signal model for the baseband communication system.
+
×
×
+
Complex Gaussian
noise
Fading
filter P(z)
Transmitter
Complex Gaussian
noise
Fading
filter P(z)
Delay
x(k)
y(k)
z(k)
nk
α0(k)
α1(k)
Figure 6.40 The fading channel model.

308
CHANNEL ESTIMATION AND EQUALIZATION
6.7.1
Channel model
If the ﬁlter P(z) in Figure 6.40 is modeled as
P(z) =
D
1 −Az−1 −Bz−2 −Cz−3
(6.57)
then at sampling time k, the CIR, hk, a complex Gaussian vector, is
hk = (hk,0, hk,1, . . . , hk,β)T
(6.58)
truncated to a ﬁnite length of (β + 1). By considering the third-order approximation of Equa-
tion (6.57), an autoregressive (AR) representation for the CIR can be introduced as
hk = AIhk−1 + BIhk−2 + CIhk−3 + DIwk
(6.59)
where I is the identity matrix, wk is a zero mean white complex circularly symmetric Gaussian process
with the covariance matrix deﬁned as E(wkwT
l ) = Qδkl. and wT
l is the conjugate transpose of wl. CIR
at time k depends on its three consecutive previous values.
The state of such a system is a vector composed of three consecutive channel impulse responses
as
xk =

hT
k , hT
k−1, hT
k−2
T
(6.60)
Using Equations (6.60) and (6.59) gives
xk+1 =


AI
BI
CI
I
0
0
0
I
0

xk +


DI
0
0

wk
(6.61)
xk+1 = Fxk + Gwk
(6.62)
where F and G are 3(β + 1) × 3(β + 1) and 3(β + 1) × (β + 1) matrices given in Equation (6.61).
F is called the state transition matrix and G is the process noise coupling matrix.
6.7.2
The received signal
If we introduce a 1 × (β + 1) vector Hk
Hk = (ak, ak−1, ak−2, . . . , ak−β, 0, . . . , 0)
(6.63)
where ak is the transmitted data sequence, then the received signal zk becomes
zk = Hkxk + nk
(6.64)
The Kalman ﬁlter is optimum for minimizing the mean square estimation error [108], in the above
linear time varying system. The algorithm is complex and, in practice, suboptimal methods are more
advantageous due to their implementation simplicity.
6.7.3
Channel estimation alternatives
In this segment the same assumptions are used as in [104]:
r To avoid the decision delay, the PSP method [109] is used. In this method, there is a channel
estimate for every possible sequence.
r The estimated channel impulse response will be used to compute the branch metrics in the trellis
diagram of the Viterbi algorithm.
r The number of required estimators is limited to the number of survivor branches (or the number
of states) in the Viterbi algorithm trellis diagram.

JCE AND DATA DETECTION OVER FADING CHANNELS
309
r In PSP each surviving path keeps and updates its own channel estimate. This method eliminates the
problem of decision delay, and in order to employ the best available information for data detection
the data sequence of the shortest path is used for channel estimation along the same path.
r The data communication system is based on the IS-136 standard presented in Chapter 1.
r The modulation is QPSK with four possible symbols (±1 ± j) and a symbol rate of 25 ksymbols/s.
r The differentially encoded data sequence is arranged into 162 symbol frames.
r The ﬁrst 14 symbols of each frame make up a training preamble sequence to help the adaptation
of the channel estimator.
r For the shaping ﬁlter at the transmitter, a ﬁnite impulse response (FIR) ﬁlter approximates a raised
cosine frequency response with an excess bandwidth of 25 % (slightly different from the 35 %
selected in IS-136).
r A two-ray fading channel model as described in Figure 6.40, where one ray has a ﬁxed delay equal
to one symbol period.
r The multiplicative coefﬁcients of α0 and α1 are produced at the output of two fading ﬁlters, where
the inputs are two independent zero mean complex Gaussian processes with equal variances.
r The length of the discrete impulse response of the shaping ﬁlter is set equal to the symbol interval
so that the ISI at the receiver is only due to the multipath nature of the channel.
r The total length of the CIR is two symbol intervals, i.e. β + 1 = 2 if there is one sample per
symbol interval.
r Therefore, there is ISI between two neighboring symbols and there are four possible states in the
trellis diagram.
r The LMS algorithm, RLS algorithm or the Kalman ﬁlter can be used to estimate the channel
impulse response.
6.7.4
Implementing the estimator
6.7.4.1
The Kalman ﬁlter algorithm [108]
The measurement update equations are:
ˆxk|k = ˆxk + Kk(zk −Hk ˆxk)
Kk = PkHT
k R−1
k
(6.65)
Rk = HkPkHT
k + N0
Pk|k = Pk −KkHkPk
The time update equations are:
ˆxk+1 = Fˆxk|k
(6.66)
Pk+1 = FPk|kFT + GQGT
6.7.4.2
The RLS algorithm [110]
ˆxk+1 = ˆxk + Kk(zk −Hk ˆxk)
Kk = PkHT
k R−1
k
(6.67)
Rk = HkPkHT
k + λ
Pk+1 = λ−1(Pk −KkHkPk)

310
CHANNEL ESTIMATION AND EQUALIZATION
In the above equations the measurement updated estimate ˆxk|k is the linear least squares estimate
of xk given observations {z0, z1, . . . , zk}. ˆxk+1 is the time updated estimate of xk given observations
{z0, z1, . . . , zk}. The corresponding error covariance matrices of these estimations are
Pk|k = E⌊(xk −ˆxk|k)(xk −ˆxk|k)T⌋
(6.68)
Pk = E⌊(xk −ˆxk)(xk −ˆxk)T⌋
In the RLS algorithm, λ is a parameter called the forgetting factor.
6.7.5
The Kalman ﬁlter
The estimator is based on two parts: measurement update equations and time update equations. The
RLS algorithm is essentially identical to the measurement update equations of the Kalman ﬁlter. The
Kalman ﬁlter can be used for channel estimation when some a priori information about the channel
is available at the receiver (i.e. the F and G matrices). The RLS algorithm, which is a suboptimal
method, does not require this a priori information and its computational complexity is less than the
Kalman ﬁlter.
6.7.6
Implementation issues
At the same precision, mathematically equivalent implementations can have different numerical
stabilities, and some methods of implementation are more robust against roundoff errors.
In the Kalman ﬁlter and the RLS algorithm the estimation depends on the correct computation
of the error covariance matrix. In an ill-conditioned problem, the solution will not be equal to the
covariance matrix of the actual estimation uncertainty. Factors contributing to this problem are: large
matrix dimensions, a growing number of arithmetic operations and poor machine precision. Solutions
to these problems are factorization methods and square root ﬁltering [110, 111].
6.7.6.1
Square root ﬁltering
Some implementations are more robust against roundoff errors and ill-conditioned problems.The
so-called square root ﬁlter implementations have generally better error propagation bounds than the
conventional Kalman ﬁlter equations [112]. In the square root forms of the Kalman ﬁlter, matrices
are factorized and triangular square roots are propagated in the recursive algorithm to preserve the
symmetry of the covariance (information) matrices in the presence of roundoff errors.
Different techniques are used for changing the dependent variable of the recursive estimation
algorithm to factors of the covariance matrix. A Cholesky factor of a symmetric non-negative deﬁnite
matrix M is a matrix C such that CCT = M. Cholesky decomposition algorithms solve for a diagonal
factor and either a lower triangular factor L or an upper triangular factor U such that M = UDUUT =
LDLLT, where DL and DU are diagonal factors with non-negative diagonal elements.
The square root methods propagate the L-D or U-D factors of the covariance matrix rather than
the covariance matrix. The propagation of square root matrices implicitly preserves the Hermitian
symmetry and non-negative deﬁniteness of the computed covariance matrix.
The condition number κ(P) = [eigenvaluemax(P)/eigenvaluemin(P)] of the covariance matrix P
can be written as
κ(P) = κ(LDLT) = κ(BBT) = [κ(B)]2
where B = LD1/2. The condition number of B used in the square root method is much smaller than
the condition number of P and this leads to improved numerical robustness of the algorithm.
In the square root method, the dynamic range of the numbers entering into computations will
be reduced. Loosely speaking, we can say that the computations which involve numbers ranging
between 2−N to 2+N will be reduced to ranges between 2−N/2 to 2+N/2, which would halve the

EQUALIZATION USING HIGHER ORDER SIGNAL STATISTICS
311
0
4
8
12
16
20
24
28
32
10
−4
10
−3
10
−2
10
−1
10
0
Mantissa length (bits)
E(mse)
Kalman 2 
RLS      
LMS      
Kalman 3 
Kalman 1 
Speed = 100 Km/h                 
1 Estimation per symbol interval 
Figure 6.41 The effects of changing the word length on estimation error E (mse) (Eb/N0 =
15 dB). Kalman 1 represents the WGS method, Kalman 2 is for the correlation
method and Kalman 3 is the direct method, the PSP method is employed for
detection.
length of required mantissa used in signal processing. All of these will directly affect the accuracy of
computer computations.
Performance results are shown in Figures 6.41 and 6.42. Different Kalman algorithms will demon-
strate superior performance only if the precision in the calculation of Equation (6.65) is high enough.
From Figures 6.41 and 6.42, this means if the quantization is precise enough, requiring a mantissa
length of 20 bits or higher.
6.8
EQUALIZATION USING HIGHER ORDER SIGNAL STATISTICS
In order to speed up the algorithms, equalization based on higher order signal statistics may be used
[113–119]. In this section we discuss a group of such algorithms derived from the cost function
deﬁned as average entropy of the set of the signal samples [113]. Maximization of the average
entropy is obtained by minimizing the mutual information of the set of signal samples which result
in minimum ISI. The block diagram of the equalizer based on joint entropy minimization (JEM)
principles is shown in Figure 6.43.
6.8.1
Problem statement
For input data symbols s(n), discrete time channel output x(n) and the channel response c(n), the
received baseband symbol can be represented as
x(n) =
N

k=0
c(k)s(n −k)
(6.69)

312
CHANNEL ESTIMATION AND EQUALIZATION
0
5
10
15
20
25
30
35
10
−4
10
−3
10
−2
10
−1
10
0
Mantissa length (bits)
BER
Kalman 3 
LMS      
Kalman 2 
Kalman 1 
RLS      
Speed = 100 Km/h
1 Estimation per symbol interval
Figure 6.42 The effects of changing the word length on BER (Eb/N0 = 15 dB). Kalman
1 represents the WGS method, Kalman 2 is for the correlation method and
Kalman 3 is the direct method, the PSP method is employed for detection.
C(z)
g(.)
Channel
x(n)
+
B(z)
Feedback filter
Blind updating rule
(JEM algorithm)
Z-1
+
y(n)
r(n)
s(n)
)
(
^ n
r
soft decision device
Equalizer
Figure 6.43 Block diagram of channel and JEM-DFE structure.

EQUALIZATION USING HIGHER ORDER SIGNAL STATISTICS
313
We will assume that input symbols are independently identically distributed (i.i.d.) and zero mean,
which is true in a digital communication system, and that c(0) = 1.
Signal y(n) at the output of the equalizer (see Figure 6.43) can be presented as
y(n) = x(n) +
N

k=1
b(k)r(n −k)
= s(n) +
N

k=1
c(k)s(n −k) +
N

k=1
b(k)r(n −k)
(6.70)
= s(n) +
N

k=1
c(k)s(n −k) +
N

k=1
b(k)g(y(n −k))
Non-linearity g(·) is a strictly monotone (increasing or decreasing) differentiable function. A more
general DFE structure usually consists of a feedforward ﬁnite impulse response (FIR) ﬁlter followed
by the feedback FIR ﬁlter given in Figure 6.43. As discussed earlier in the chapter, the main purpose
of the feedforward ﬁlter is to eliminate the precursor ISI and the feedback ﬁlter cancels the postcursor
ISI. For simplicity, only the feedback part is considered. This is not a hurdle since it is possible to
separate the adaptation of the feedback part from the feedforward part.
6.8.2
Signal model
By introducing auxiliary inputs and outputs we have
y(n) = B · x(n)
(6.71)
where
x(n) = [x(n)
r(n −1)
. . .
r(n −N]T
(6.72)
y(n) = [y(n)
r(n −1)
. . .
r(n −N)]T
and
B =


1
b(1)
· · ·
b(N)
0
1
...
0
...
...
...
...
0
...
· · ·
1


(6.73)
In the presence of ISI (i.e. dependence), the entropy of the received symbols is smaller than when they
are independent. Thus, maximizing the joint entropy of the equalizer outputs will result in removing
the ISI.
6.8.3
Derivation of algorithms for DFE
So, the algorithm is based on maximizing the joint entropy of the equalizer output r(n). The joint
entropy of r(n) = g(y(n)) denoted by H[r1(n), . . . ,rN+1(n)] is deﬁned as [78, 120 (Chapter 6)]:
H[r1(n), . . . ,rN+1(n)]  −E{ln fr(r(n))}
= E{ln |J|} −E{ln fy(y(n))}
= E{ln |J|} −E{ln{|B|−1 fx(x(n))}}
(6.74)
= E{ln |J|} −E{ln fx(x(n))}

314
CHANNEL ESTIMATION AND EQUALIZATION
where |J| is the absolute value of the Jacobian of the transformation
J = det


∂r1(n)
∂y1(n)
· · ·
∂r1(n)
∂yN+1(n)
...
· · ·
...
∂rN+1(n)
∂y1(n)
· · ·
∂rN+1(n)
∂yN+1(n)


J = det


∂r(n)
∂y(n)
· · ·
∂r(n)
∂r(n −N)
...
· · ·
...
∂r(n −N)
∂y(n)
· · ·
∂r(n −N)
∂r(n −N)


(6.75)
=


∂r(n)
∂y(n)
· · ·
0
...
· · ·
...
∂r(n −N)
∂y(n)
· · ·
1


= ∂r(n)
∂y(n)
(6.76)
The quantity ri(n)[xi(n)] is the ith component of the vector r(n)[x(n)] and fr(r(n))[ fx(x(n))] is the
joint density function of the input vector r(n) [x(n)].
Assume that the previous decisions are correct, i.e.
Assumption: r(n −k) = s(n −k), k = 1, . . . , N
(6.77)
Under Assumption (6.77), r(n −i) are independent of r(n −j), i > j and thus Equation (6.75)
follows from Equation (6.75). The joint entropy can also be expressed as [120, Chapter 15]:
H[r1(n), . . . ,rN+1(n)] =
N+1

i=1
H[ri(n)] −I[r1(n), . . . ,rN+1(n)]
(6.78)
Maximizing the joint entropy of r(n) is the same as maximizing the ﬁrst term in Equation (6.78)
while minimizing the mutual information I[r1(n), . . . ,rN+1(n)]. Since the previous decisions that
the outputs of the non-linear function g(·) are the same as the transmitted symbols s(n −k), k =
1, . . . , N, E{ ln fx(x(n))} in Equation (6.74) can be considered to be a constant with respect to
the feedback ﬁlter coefﬁcients b(k), k = 1, . . . , N. Then, maximizing E{ ln |J|} is equivalent to
maximizing H[r1(n), . . . ,rN+1(n)]. In doing so, the statistical dependence between the current output
of the non-linear function r(n) and the previous outputs (r(n −k), k = 1, . . . , N) can be reduced,
which leads to ISI suppression.
6.8.4
The equalizer coefﬁcients
The joint entropy H[r1(n), . . . ,rN+1(n)] is a non-linear function of the unknown equalizer coefﬁcients
and does not lead easily to a closed form solution. A gradient descent algorithm is used for maximizing
Equation (6.74). The equalizer coefﬁcients are then updated iteratively
bn+1(k) = bn(k) + µE
∂ln |J|
∂bn(k)

(6.79)
where µ is the positive step size. This equation can be further simpliﬁed based on the choice of
non-linearity used in the decision device.

EQUALIZATION USING HIGHER ORDER SIGNAL STATISTICS
315
6.8.5
Stochastic gradient DFE adaptive algorithms
Despite its superiority over the linear equalizer and its popularity, a major drawback of the DFE is that
it suffers from error propagation. Any previous decision errors at the output of the decision device
will produce the symbol estimate y(n), whose ISI is not completely eliminated by the feedback ﬁlter.
This error in turn will affect future decisions. An intuitive choice is one where we replace the hard
limiter with a softer function. It is hoped that the errors in r(n) can be reduced by using soft decisions.
The update equation given in (6.79) depends on the mapping used in the soft decision device.
Various non-linear functions may be used for the soft decision device (function g(·) shown in
Figure 6.43). We use two different functions for g(·) to derive new blind algorithms for DFE.
6.8.5.1
Equivalence of JEM and ISIC
First choice for the non-linear function is
g(n) = α · tanh[β · n]
(6.80)
resulting in the following
∂ln |J|
∂b(k) =
∂ln

∂r(n)
∂y(n)
∂b(k)
= −2β tanh[β · y(n)]r(n −k)
(6.81)
= −2β
α r(n)r(n −k)
The gradient is a function of the non-linearity used in the decision device that provides a tool via
which the algorithm characteristics can be varied. A new adaptive blind algorithm for DFE based on
JEM can be obtained as follows:
JEM-1:
bn+1(k) = bn(k) −µr(n)r(n −k)
(6.82)
Taylor series (TS) expansion of r(n) leads to
r(n) = α · tanh[β · y(n)]
(6.83)
= αβy(n) −αβ3
3 y3(n) + 2αβ5
15 y5(n) + O(y6(n))
For simplicity only the ﬁrst few terms of the expansion are considered. Further variations of JEM-1
can be obtained by substituting Equation (6.83) into Equation (6.82). By using only the ﬁrst term in
Equation (6.83) with α = 3 and β = 1/3, a simpler update equation for the feedback ﬁlter coefﬁcients
is
JEM-2:
bn+1(k) = bn(k) −µy(n)r(n −k)
(6.84)
JEM-2 is exactly the same as the ISIC algorithm [121] which uses soft decision feedback. Here, the
same update equation is arrived at via the motivation to maximize the entropy of the observations at
the output of a soft decision device.
6.8.5.2
Equivalence of JEM and decorrelation criterion
Another possible variation of Equation (6.82) is to use the TS approximation for both r(n) and
r(n −k).
r(n)r(n −k) = α2β2y(n)y(n −k) −α2β4
3
{y3(n)y(n −k)
(6.85)
+ y3(n −k)y(n)} + · · ·

316
CHANNEL ESTIMATION AND EQUALIZATION
By using only the ﬁrst term in Equation (6.85) with α = 3 and β = 1/3, we have
JEM-3:
bn+1(k) = bn(k) −µy(n)y(n −k)
(6.86)
JEM-3 is exactly the same as that for the adaptive blind algorithm based on the decorrelation criterion
(DECA) [122].
6.8.5.3
JEM and CMA-DFE
Another function that has transfer characteristics similar to the hyperbolic tangent is the function with
a cubic non-linearity
g(y(n)) = α · y(n) + β · y3(n)
(6.87)
With the above mapping we have
∂ln |J|
∂b(k) =
6βy(n)
α + 3βy2(n)r(n −k)
(6.88)
∂ln |J|
∂b(k) =

6β
α y(n)

1 −3β
α y2(n) + 9β2
α y4

+ O(y7(n))

r(n −k)
(6.89)
Dropping terms of order greater than three gives:
JEM-4:
bn+1(k) = bn(k) + µy(n)

1 −3β
α y2(n)

· r(n −k)
(6.90)
With α = 3 and β = 1, Equation (6.90) coincides with the CMA-DFE algorithm, provided the soft
decisions given by Equation (6.87) are used in the CM algorithm for a DFE. The original CMA-DFE
uses hard decisions [123, 124].
6.8.6
Convergence analysis
6.8.6.1
Alternative JEM-DFE scheme and Bussgang-type algorithm
Since soft decisions can possibly smooth the error surface and allow the algorithm to escape from
local minima, the authors in [8] suggest the use of soft decisions at the start of equalization. These can
then be replaced with a hard decision device after a few iterations. It is difﬁcult to decide when one
can switch from soft to hard decisions. A simple technique based on a modiﬁed JEM-DFE scheme is
suggested to overcome this difﬁculty (Figure 6.44).
C(z)
Channel
s(n)
x(n) +
+
B(z)
Feedback filter
Z-1
hard decision device
soft decision device
g(.)
Blind updating rule
(JEM algorithm)
r(n)
y(n)
)
(ˆn
r
Figure 6.44 Block diagram of channel and alternative JEM-DFE structure.

EQUALIZATION USING HIGHER ORDER SIGNAL STATISTICS
317
For the update equations (for example, (6.82) and (6.84)), the soft decision device outputs, r(n)
and r(n −k), are used. On the other hand, the hard decisions ˆr(n −k) in Figure 6.43 are used as
inputs to the feedback ﬁlter instead of r(n −k); see Figure 6.43. In this way, soft and hard decision
modes can be combined. A structure similar to JEM-DFE (see Figure 6.44) was used in [124] and
will be used in what follows.
6.8.6.2
JEM-DFE structure in Figure 6.44 and classical
Bussgang-type DFE
DFE can be considered as a linear equalizer [124]. The usual DFE structure consists of the feedforward
ﬁlter followed by the feedback ﬁlter. The symbol estimate y(n) can be expressed as:
y(n) =
0

k=−N f
f (k)x(n −k) +
Nb

k=1
b(k)ˆr(n −k)
(6.91)
=
Nb

k=−N f
w(k)ˆx(n −k)
The input to the equalizer is
˜x(n −k) =

x(n −k),
when −Nf ≤k ≤0
ˆr(n −k),
when 1 ≤k ≤Nb
(6.92)
The coefﬁcients of the equalizer are
w(n −k) =

f (n −k),
when −Nf ≤k ≤0
b(n −k),
when 1 ≤k ≤Nb
(6.93)
and Nf and Nb are the feedforward and feedback ﬁlter lengths, respectively.
6.8.6.3
Bussgang-type algorithm [125 (Chapter 2)]
The algorithm is deﬁned by
wn+1(k) = wn(k) + µ{ˆg(y(n)) −y(n)}˜x(n −k)
(6.94)
where ˆg(y(n)) is some non-linear function of y(n). Provided that Nf and Nb in Equation (6.94) are
large enough, the symbol estimate {y(n)} is Bussgang (see [126, Chapter 18], [127]). A stochastic
process {y(n)} is said to be a Bussgang process if it satisﬁes the condition E{y(n)y(n + k)} =
E{y(n)g(y(n + k))} where the function g(·) is a zero memory non-linearity.
Since the feedforward and feedback parts can be updated separately, consider only the feedback
part of Equation (6.94). Then, the Bussgang-type DFE algorithm for the feedback part is
bn+1(k) = bn(k) + µ{˜g(y(n)) −y(n)}r(n −k)
(6.95)

318
CHANNEL ESTIMATION AND EQUALIZATION
Comparing Equation (6.95) to Equations (6.82) and (6.90), −r(n) in Equation (6.82), −y(n) in
Equation (6.84) and y(n){1 −(3β/α)y2(n)} in Equation (6.90) may be viewed to be equivalent to the
error term {ˆg(y(n)) −y(n)} in Equation (6.95). Thus, JEM-1, JEM-2 and JEM-4 can be considered
to be special cases of the Bussgang-type DFE. By comparing Equation (6.95) to Equation (6.86),
however, we note that JEM-3 cannot be categorized as a Bussgang-type algorithm.
6.8.6.4
Convergence of JEM algorithms
JEM-1 and JEM-2 are guaranteed to converge for super-Gaussian inputs but not for sub-Gaussian. The
input {s(n)} is sub-Gaussian (super-Gaussian) if the kurtosis γs = E{s(n)4} −3[E{s(n)2}]2 is less
than zero (greater than zero). For example, for a BPSK signal, γs = −2 and hence it is sub-Gaussian.
Extensive simulations show, however, that these algorithms converge to the right solution in
almost all the cases. Convergence of JEM-3 is not considered here since it cannot be categorized as a
Bussgang-type algorithm. JEM-4 is guaranteed to converge. When α = ∞and β = 1/α = 0, JEM-2
coincides with JEM-3.
6.8.7
Kurtosis-based algorithm
The JEM approach cannot guarantee that the maximization of the joint entropy leads to minimization
of the mutual information. To compute the mutual information, the probability density function of
r(n), the output of the decision device, is required. The approximation of the mutual information
(or contrast function) was derived by Comon (see [128]). Maximization of the contrast function, or
minimization of the mutual information of the equalizer outputs, is equivalent to minimization of the
sum of the autocumulants squared. This result was obtained by using the Edgeworth expansion to
separate the constant mixtures of the independent input signals [128].
6.8.7.1
Modiﬁed signal model
Under Assumption (6.77), Equation (6.72) can be rewritten as:
x(n) = [x(n)
s(n −1)
· · ·
s(n −N)]T
(6.96)
y(n) = [y(n)
s(n −1)
· · ·
s(n −N)]T
The new equivalent channel model is
x(n) = C · s(n)
(6.97)
where
s(n) = [s(n)
s(n −1)
· · ·
s(n −N)]T
(6.98)
and
C =


1
c(1)
· · ·
c(N)
0
1
...
0
...
...
...
...
0
...
· · ·
1


(6.99)
The matrix C is full rank so there exists a unique solution to Equation (6.97). Here, the mixture
matrix C and the source vector s(n) are partially unknown. Equalization is attained by estimating
the matrix B in Equation (6.71). It can be easily shown that B is the inverse matrix of C when
c(n −k) = −b(n −k), k = 1, . . . , N. To ﬁnd the solution B, several contrast functions can be used
(see [128] and [129]).

EQUALIZATION USING HIGHER ORDER SIGNAL STATISTICS
319
6.8.7.2
Contrast function proposed in [129]
In this case we have
J =
N+1

k=1
C4yk(0, 0, 0), = C4y(0, 0, 0) + Constant
(6.100)
where C4yk(0, 0, 0) is the kurtosis (all zero lag of the fourth-order cumulant) of y(n). A criterion
similar to one deﬁned in Equation (6.100) for a single output FIR channel was originally proposed
for multiinput multioutput (MIMO) channel equalization with MIMO-DFEs in [130]. The cost
function for the present simpliﬁed case with only a single channel is
JAC = C4y(0, 0, 0)
(6.101)
The update equation for the feedback ﬁlter coefﬁcients based on the criterion in Equation (6.101) is:
bn+1(k) = bn(k) + µsgn {γs}
· [ ˆE{y(n)3r(n −k)} −3 ˆE{y(n)2}
(6.102)
· ˆE{y(n)r(n −k)}]
where ˆE{·} is the estimate of E{ · }. Note that the contrast-based cost function of Equation (6.100)
is similar to the autocumulant (AC) criterion of Equation (6.101). Since the preprocessing stage
(prewhitening of the observations) is missing in the AC approach, however, the proposed criterion can
only be thought of as approximately minimizing the mutual information. Simulation examples indicate
that the equalizer based on the AC criterion converges much faster than most existing algorithms.
6.8.7.3
Performance examples [113]
Example 1
An FIR non-minimum phase channel with impulse response given by
c(n) = δ[n] + 2δ[n −1]
is used. The channel input s(n) is a sequence of 2000 independent BPSK symbols, uniformly
distributed over {1, −1}. The received symbols x(n) consist of the distorted symbols s(n) and additive
noise at 20 dB. This data is used to update the one-tap feedback ﬁlter (b(1)), which is initialized with
a zero. The results are shown in Figures 6.45 and 6.46.
Example 2
The performance of the adaptive blind algorithms was investigated with a multipath fading channel
with impulse response
c(t) =
Ld

i=1
εi p(t −τi)
where p(t) is the pulse shape (raised cosine pulse). The delay {τi} is statistically independent and
uniformly distributed in [0, 3T ] where T is the symbol interval. The attenuations {εi} are independent
zero mean Gaussian variables and the number of paths is six.
The equivalent discrete time baseband channel has a length of four symbol intervals (c(k), k =
0, . . . , 3). The channel coefﬁcients c(k) were normalized by c(0). An array of three hundred sets of
channels drawn from channel parameter distributions was generated. 10 000 independent uniformly
distributed input symbol sequences {s(n)} over {1, −1} were used for each channel. For the sake of
fair comparison, the step size was chosen to be the same for all the algorithms.

0
500
1000
1500
2000
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Iteration n
MSE
JEM-2
JEM-4
CMA-DFE
ISIC
0
500
1000
1500
2000
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Iteration n
MSE
JEM-2
JEM-4
CMA-DFE
ISIC
Figure 6.45 MSE comparison of ISIC, JEM-2, CMA-DFE and JEM-4: (g(·) = 3 ·
tanh[1/3y(n)]) for JEM-2, g(y(n)) = 3 · y(n) + y3(n) for JEM-4, µISIC =
µJEM−2 = µCMA−DFE = 0.01, µJEM−4 = 0.001 averaged over 100 Monte
Carlo runs. SNR = 20 dB [113]
C⃝1998, IEEE.
0
500
1000
1500
2000
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Iteration n
MSE
JEM-1
DECA
AC
0
500
1000
1500
2000
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Iteration n
MSE
JEM-1
DECA
AC
Figure 6.46 MSE comparison of AC, decorrelation algorithm (DECA) and JEM-1: g(·) =
3 · tanh[1/3y(n)], µAC = µDECA = µJEM−1 = 0.01, averaged over 100 Monte
Carlo runs. SNR = 20 dB [113] c⃝1998, IEEE.

REFERENCES
321
Table 6.3
SIR Comparison of (blind) DFE algorithms: g(·) = 3 tanh
[1/3y(n)] for JEM-1 and JEM-2, g(·) = 3y(n) + y3(n) for
JEM-4, and µ = 1e−4 for all algorithms, averaged over 185
simulated FIR channels: noise-free case [113] c⃝1998,
IEEE
SIR (dB)
Number of successes among a set
of 300 channels
Unequalized
0.80
300
ISIC
4.87
300
JEM-2
5.70
300
CMA-DFE
10.88
295
JEM-4
58.92
185
DECA
6.16
300
AC
22.14
292
JEM-1
5.07
300
6.8.8
Performance results
Table 6.3 shows the results. Non-JEM-type algorithms yield about 5 dB–22 dB improvement in
SIR. JEM-type algorithms exhibit an 11 dB–59 dB improvement. The JEM-4 algorithm is sensitive
to step size. The third column of Table 6.3 shows the number of successful convergences. The
JEM-4 algorithm became unstable with 115 simulated channels among 300. When the robustness
and performance are considered simultaneously, JEM-1, JEM-2 or DECA are winners among the
algorithms.
REFERENCES
1. Wen-Rong Wu and Yih-Ming Tsuie (2002) An LMS-based decision feedback equalizer for
IS-136 receivers, IEEE Transactions on Vehicular Technology, 51(1), 130–143.
2. Zerguine, A., Shaﬁ, A. and Bettayeb, M. (2001) Multilayer perceptron-based DFE with lattice
structure, IEEE Transactions on Neural Networks, 12(3), 532–545.
3. Ki Yong Lee (1996) Complex fuzzy adaptive ﬁlter with LMS algorithm, IEEE Transactions on
Signal Processing, 44(2), 424–427.
4. Reuter, M. and Zeidler, J. R. (1999) Nonlinear effects in LMS adaptive equalizers, IEEE
Transactions on Signal Processing, 47(6), 1570–1579.
5. Xiaohua Li and Fan, H. (2000) Linear prediction methods for blind fractionally spaced equal-
ization, IEEE Transactions on Signal Processing, 48(6), 1667–1675.
6. Gi Hun Lee, Jinho Choi, Rae-Hong Park, Iickho Song, Jae Hyuk Park and Byung-Uk Lee (1994)
Modiﬁcation of the reference signal for fast convergence in LMS-based adaptive equalizers,
IEEE Transactions on Consumer Electronics, 40(3), 645–654.
7. Mao-Ching Chiu and Chi-chao Chao (1996) Analysis of LMS-adaptive MLSE equalization on
multipath fading channels, IEEE Transactions On Communications, 44(12), 1684–1692.
8. Raghunath, K. J. and Parhi, K. K. (1993). Parallel adaptive decision feedback equalizers, IEEE
Transactions on Signal Processing, 41(5), 1956–1961.

322
CHANNEL ESTIMATION AND EQUALIZATION
9. Shanbhag, N. R. and Parhi, K. K. (1995) Pipelined adaptive DFE architectures using relaxed
look-ahead, IEEE Transactions on Signal Processing, 43(6), 1368–1385.
10. Al-Dhahir, N. and Ciofﬁ, J. M. (1996) Efﬁcient computation of the delay-optimized ﬁnite length
MMSE-DFE, IEEE Transactions on Signal Processing, 44(5), 1288–1292.
11. Al-Dhahir, N. and Ciofﬁ, J. M. (1997) Mismatched ﬁnite-complexity MMSE decision feedback
equalizers, IEEE Transactions on Signal Processing, 45(4), 935–944.
12. Chen, S., Mulgrew, B. and Hanzo, L. (2000) Asymptotic Bayesian decision feedback equalizer
using a set of hyperplanes, IEEE Transactions on Signal Processing, 48(12), 3493–3500.
13. Afkhamie, K. H., Zhi-Quan Luo and Kon Max Wong (2001) Interior point least squares estima-
tion: transient convergence analysis and application to MMSE decision-feedback equalization,
IEEE Transactions on Signal Processing, 49(7), 1543–1555.
14. Liavas, A. P. (2002) On the robustness of the ﬁnite-length MMSE-DFE with respect to channel
and second-order statistics estimation errors, IEEE Transactions on Signal Processing, 50(11),
2866–2874.
15. Berberidis, K. and Karaivazoglou, P. (2002) An efﬁcient block adaptive decision feedback
equalizer implemented in the frequency domain, IEEE Transactions on Signal Processing,
50(9), 2273–2285.
16. Sheng Chen (2002) Importance of sampling simulation for evaluating lower-bound symbol
error rate of the Bayesian DFE with multilevel signaling schemes, IEEE Transactions on Signal
Processing, 50(5), 1229–1236.
17. Hunsoo Choo, Muhammad, K. and Roy, K. (2003) Two’s complement computation sharing mul-
tiplier and its applications to high performance DFE, IEEE Transactions on Signal Processing,
51(2), 458–469.
18. Monsen, P. (1977) Theoretical and Measured Performance of a DFE Modem on a Fading
Multipath Channel, IEEE Transactions On Communications, 25(10), 1144–1153.
19. Cantoni, A. and Butler, P. (1976) Stability of Decision Feedback Inverses, IEEE Transactions
On Communications, 24(9), 970–977.
20. Ehrman, L. and Monsen, P. (1977) Troposcatter Test Results for a High-Speed Decision-
Feedback Equalizer Modem, IEEE Transactions On Communications, 25(12), 1499–1504.
21. Taylor, D. and Shaﬁ, M. (1984) Decision Feedback Equalization for Multipath Induced In-
terference in Digital Microwave LOS Links, IEEE Transactions on Communications, 32(3),
267–279.
22. Falconer, D., Sheikh, A., Eleftheriou, E. and Tobis, M. (1985) Comparison of DFE and MLSE
Receiver Performance on HF Channels, IEEE Transactions On Communications, 33(5), 484–
486.
23. Fuyun Ling and Proakis, J. (1985) Adaptive Lattice Decision-Feedback Equalizers–Their Per-
formance and Application to Time-Variant Multipath Channels, IEEE Transactions On Com-
munications, 33(4), 348–356.
24. Leclert, A. and Vandamme, P. (1985) Decision Feedback Equalization of Dispersive Radio
Channels, IEEE Transactions On Communications, 33(7), 676–684.
25. Shaﬁ, M. and Moore, D. (1986) Further Results on Adaptive Equalizer Improvements for 16
QAM and 64 QAM Digital Radio, IEEE Transactions On Communications, 34(1), 59–66.
26. Kennedy, R. and Anderson, B. (1987) Recovery Times of Decision Feedback Equalizers on
Noiseless Channels, IEEE Transactions On Communications, 35(10), 1012–1021.

REFERENCES
323
27. Kennedy, R., Anderson, B. and Bitmead, R. (1987) Tight Bounds on the Error Probabilities of
Decision Feedback Equalizers, IEEE Transactions On Communications, 35(10), 1022–1028.
28. Kennedy, R. and Anderson, B. (1987) Error Recovery of Decision Feedback Equalizers on
Exponential Impulse Response Channels, IEEE Transactions On Communications, 35(8), 846–
848.
29. Kennedy, R. A., Anderson, B. D. O. and Bitmead, R. R. (1989) Channels leading to rapid error
recovery for decision feedback Equalizers, IEEE Transactions On Communications, 37(11),
1126–1135.
30. Zhou, K., Proakis, J. G. and Ling, F. (1990) Decision-feedback equalization of time-dispersive
channels with coded modulation, IEEE Transactions On Communications, 38(1), 18–24.
31. Altekar, S. A. and Beaulieu, N. C. (1991) On the tightness of two error bounds for decision
feedback Equalizers, IEEE Transactions On Information Theory, 37(3), 638–639.
32. Lin, D. W. (1991) Minimum mean-squared error decision-feedback equalization for digital
subscriber line transmission with possibly correlated line codes, IEEE Transactions On Com-
munications, 39(8), 1197–1206.
33. Williamson, D., Kennedy, R. A. and Pulford, G. W. (1992) Block decision feedback equalization,
IEEE Transactions On Communications, 40(2), 255–264.
34. Pahlavan, K., Howard, S. J. and Sexton, T. A. (1993) Decision feedback equalization of the
indoor radio channel, IEEE Transactions On Communications, 41(1), 164–170.
35. Jaekyun Moon and Sian She (1994) Constrained-complexity equalizer design for ﬁxed delay
tree search with decision feedback, IEEE Transactions on Magnetics, 30(5), 2762–2768.
36. Stojanovic, M., Proakis, J. G. and Catipovic, J. A. (1995) Analysis of the impact of channel
estimation errors on the performance of a decision-feedback equalizer in fading multipath
channels, IEEE Transactions On Communications, 43(2, 3, 4), 877–886.
37. McEwen, P. A. and Kenney, J. G. (1995) Allpass forward equalizer for decision feedback
equalization, IEEE Transactions on Magnetics, 31(6), 3045–3047.
38. Russell, M. and Jan W. M. Bergmans (1995) A technique to reduce error propagation in M-ary
decision feedback equalization, IEEE Transactions On Communications, 43(12), 2878.
39. Ciofﬁ, J. M., Dudevoir, G. P., Vedat Eyuboglu, M. and Forney, G. D., Jr (1995) MMSE decision-
feedback equalizers and coding. I. Equalization results, IEEE Transactions On Communications,
43(10), 2582–2594.
40. Sheng Chen, McLaughlin, S., Mulgrew, B. and Grant, P. M. (1995) Adaptive Bayesian decision
feedback equalizer for dispersive mobile radio Channels, IEEE Transactions On Communica-
tions, 43(5), 1937–1946.
41. Mathew, G., Farhang-Boroujeny, B. and Wood, R. W. (1997) Design of multilevel decision
feedback Equalizers, IEEE Transactions on Magnetics, 33(6), 4528–4542.
42. Porat, B. and Friedlander, B. (1991) Blind equalization of digital communication channels using
high-order moments, IEEE Transactions on Signal Processing, 39(2), 522–526.
43. Vembu, S., Verdu, S., Kennedy, R. A. and Sethares, W. (1994) Convex cost functions in blind
equalization, IEEE Transactions on Signal Processing, 42(8), 1952–1960.
44. Ye Li and Zhi Ding (1995) Convergence analysis of ﬁnite length blind adaptive equalizers, IEEE
Transactions on Signal Processing, 43(9), 2120–2129.
45. Ye Li and Liu, K. J. R. (1996) Static and dynamic convergence behavior of adaptive blind
Equalizers, IEEE Transactions on Signal Processing, 44(11), 2736–2745.

324
CHANNEL ESTIMATION AND EQUALIZATION
46. Zhi Ding (1997) On convergence analysis of fractionally spaced adaptive blind equalizers, IEEE
Transactions on Signal Processing, 45(3), 650–657.
47. Shtrom, V. and Fan, H. (1998) New class of zero-forcing cost functions in blind equalization,
IEEE Transactions on Signal Processing, 46(10), 2674–2683.
48. Giannakis, G. B. and Tepedelenlioglu, C. (1999) Direct blind equalizers of multiple FIR
channels: a deterministic approach, IEEE Transactions on Signal Processing, 47(1), 62–
74.
49. Tugnait, J. K. and Bin Huang (1999) Second-order statistics-based blind equalization of IIR
single-input multiple-output channels with common zeros, IEEE Transactions on Signal Pro-
cessing, 47(1), 147–157.
50. Mannerkoski, J. and Koivunen, V. (2000) Autocorrelation properties of channel encoded
sequences–applicability to blind equalization, IEEE Transactions on Signal Processing, 48(12),
3501–3507.
51. Junyu Mai and Sayed, A. H. (2000) A feedback approach to the steady-state performance of
fractionally spaced blind adaptive equalizers, IEEE Transactions on Signal Processing, 48(1),
80–91.
52. Borah, D. K., Kennedy, R. A., Zhi Ding and Fijalkow, I. (2001) Sampling and preﬁltering effects
on blind equalizer design, IEEE Transactions on Signal Processing, 49(1), 209–218.
53. Lopez-Valcarce, R. and Dasgupta, S. (2001) Blind channel equalization with colored sources
based on second-order statistics: a linear prediction approach, IEEE Transactions on Signal
Processing, 49(9), 2050–2059.
54. Upez-Valcarce, R. and Dasgupta, S. (2001) Blind equalization of nonlinear channels from
second-order statistics, IEEE Transactions on Signal Processing, 49(12), 3084–3097.
55. Luo, Z.-Q. T., Mei Meng, Wong, K. M. and Jian-Kang Zhang (2002) A fractionally spaced
blind equalizer based on linear programming, IEEE Transactions on Signal Processing, 50(7),
1650–1660.
56. Prakriya, S. (2002) Eigenanalysis-based blind methods for identiﬁcation, equalization, and
inversion of linear time-invariant channels, IEEE Transactions on Signal Processing, 50(7),
1525–1532.
57. Benveniste, A. and Goursat, M. (1984) Blind Equalizers, IEEE Transactions On Communica-
tions, 32(8), 871–883.
58. Mathis, H. and Douglas, S. C. (2003) Bussgang blind deconvolution for impulsive signals IEEE
Transactions on Signal Processing, 51(7), 1905–1915.
59. Karaoguz, J. and Ardalan, S. H. (1991) Use of blind equalization for teletext broadcast systems,
IEEE Transactions on Broadcasting, 37(2), 44–54.
60. Ding, Z., Kennedy, R. A., Anderson, B. D. O. and Johnson, C. R., Jr (1993) Local conver-
gence of the Sato blind equalizer and generalizations under constraints, IEEE Transactions On
Information Theory, 39(1), 129–144.
61. Verdu, S., Anderson, B. D. O. and Kennedy, R. A. (1993) Blind equalization without gain
identiﬁcation, IEEE Transactions On Information Theory, 39(1), 292–297.
62. Tugnait, J. K. (1994) Blind estimation of digital communication channel impulse response,
IEEE Transactions On Communications, 42(2,3,4), 1606–1616.
63. Tugnait, J. K. (1996) Blind equalization and estimation of FIR communications channels using
fractional sampling, IEEE Transactions On Communications, 44(3), 324–336.

REFERENCES
325
64. Dogancay, K. and Kennedy, R. A. (1999) Least squares approach to blind channel equalization,
IEEE Transactions On Communications, 47(11), 1678–1687.
65. Won Lee and Hill, F. (1977) A Maximum-Likelihood Sequence Estimator with Decision-
Feedback Equalization, IEEE Transactions On Communications, 25(9), 971–979.
66. Falconer, D., Sheikh, A., Eleftheriou, E. and Tobis, M. (1985) Comparison of DFE and MLSE
Receiver Performance on HF Channels, IEEE Transactions On Communications, 33(5), 484–
486.
67. Sheen, W.-H. and Stuber, G. L. (1991) MLSE equalization and decoding for multipath-fading
channels, IEEE Transactions On Communications, 39(10), 1455–1464.
68. Mao-Ching Chiu and Chi-chao Chao (1996) Analysis of LMS-adaptive MLSE equalization on
multipath fading channels, IEEE Transactions On Communications, 44(12), 1684–1692.
69. Yonghai Gu and Tho Le-Ngoc (1996) Adaptive combined DFE/MLSE techniques for ISI
channels, IEEE Transactions On Communications, 44(7), 847–857.
70. Hamied, K. A. and Stuber, G. L. (1996) An adaptive truncated MLSE receiver for Japanese
personal digital cellular, IEEE Transactions on Vehicular Technology, 45(1), 41–50.
71. Jiunn-Tsair Chen, Paulraj, A. and Reddy, U. (1999) Multichannel maximum-likelihood sequence
estimation (MLSE) equalizer for GSM using a parametric channel model, IEEE Transactions
On Communications, 47(1), 53–63.
72. Jiunn-Tsair Chen and Yeong-Cheng Wang (2001) Adaptive MLSE equalizers with parametric
tracking for multipath fast-fading channels, IEEE Transactions On Communications, 49(4),
655–663.
73. Gerstacker, W. (2002) Equalization concepts for EDGE, IEEE Transactions on Communications
1(1).
74. Dual-Hallen, A. (1989) Delayed Decision-Feedback Sequence Estimation, IEEE Transactions
On Communications 37(5).
75. Eyuboglu, M. V. (1988) Reduced-State Sequence Estimation with Set Partitioning and Decision
Feedback, IEEE Transactions On Communications, 36(1).
76. Vaidis, T. and Weber, C. L. (1998) Block adaptive techniques for channel identiﬁcation and
data demodulation over band-limited channels, IEEE Transactions On Communications, 46(2),
232–243.
77. Sayed, A. H. and Kailath, T. (1994) A state-space approach to adaptive RLS ﬁltering, IEEE
Signal Processing Magazine, July.
78. Kennedy, R. A. (1989) Design and optimization of nonlinear mapping in decision feedback
equalization, in Proceedings of the 35th Conference on Decision and Control, Kobe, Japan,
December 1996, pp. 1888–1889.
79. Qureshi, S. U. H. (1985) Adaptive equalization, Proceedings of IEEE, 53, 1349–1387.
80. Qureshi, S. (1985) Adaptive equalization, Proceedings of IEEE, 73, 1349–1387.
81. Proakis, J. G. (1991) Adaptive equalization for TDMA digital mobile radio, IEEE Transactions
on Vehicular Technology, 40, 333–341.
82. Magee, F. R. Jr and Proakis, J. G. (1973) Adaptive maximum likelihood estimation for digi-
tal signaling in the presence of intersymbol interference, IEEE Transactions On Information
Theory, IT–l9, 120–124.
83. Ungerboeck, G. (1974) Adaptive maximum likelihood receivers for carrier modulated data
transmission systems, IEEE Transactions On Communications, COM–22, 624–636.

326
CHANNEL ESTIMATION AND EQUALIZATION
84. Qureshi, S. and Newhall, E. E. (1973) An adaptive receiver for data transmission over time
dispersive channels, IEEE Transactions On Information Theory, IT–l9, 448–457.
85. Qureshi, U. H. (1973) An Adaptive Decision–Feedback Receiver Using Maximum Likelihood
Sequence Estimation. ICC, Seattle, WA.
86. Raheli, R., Polydoros, A. and Tzou, C. K. (1995) Per survivor processing: A general approach
to MLSE in uncertain environments, IEEE Transactions On Communications, 43.
87. Seshadri, N. (1994) Joint data and channel estimation using blind trellis search techniques, IEEE
Transactions On Communications, 42, 1000–1011.
88. Forney, G. D. Jr (1972) Maximum likelihood sequence estimation of digital sequences in the
presence of intersymbol interference, IEEE Transactions On Information Theory, IT–18, 363–
378.
89. D’Avella, R., Moreno, L. and Sant’Agostino, M. (1989) An adaptive MLSE receiver for TDMA
digital mobile radio, IEEE Journal on Selected Areas in Communications, 7, 122–129.
90. Chevillat, P. R. and Eleftheriou, E. (1989) Decoding of trellis–encoded signals in the pres-
ence of intersymbol interference and noise, IEEE Transactions On Communications, 37, 669–
676.
91. Heller, J. A. and Jacobs, I. M. (1971) Viterbi decoding for satellite and space communication,
IEEE Transactions On Communications, COM–l9, 835–848.
92. Gosh, M. and Weber, C. L. (1992) Maximum likelihood blind equalization, Optical Engineering
31(6), 1224–1229.
93. Sato, Y. (1975) A method of self–recovering equalization for multilevel amplitude modulation
systems, IEEE Transactions On Communications, COM–23, 679–682.
94. Bee Leong Yeap, Choong Hin Wong and Hanzo, L. (2003) Reduced complexity in-
phase/quadrature-phase M-QAM turbo equalization using iterative channel estimation, IEEE
Transactions on Wireless Communications, 2(1), 2–10.
95. Nelson, J., Singer, A. and Koetter, R. (2003) Linear turbo equalization for parallel ISI Channels,
IEEE Transactions On Communications, 51(6), 860–864.
96. Xiaodong Wang and Rong Chen (2001) Blind turbo equalization in Gaussian and impulsive
noise, IEEE Transactions on Vehicular Technology, 50(4), 1092–1105.
97. Yee, M. S., Liew, T. H. and Hanzo, L. (2001) Burst-by-burst adaptive turbo-coded radial
basis function-assisted decision feedback equalization, IEEE Transactions On Communications,
49(11), 1935–1945.
98. Bee Leong Yeap, Tong Hooi Liew, Hamorsky, J. and Hanzo, L. (2002) Comparative study of
turbo equalization schemes using convolutional turbo, and block-turbo codes, IEEE Transactions
on Wireless Communications, 1(2), 266–273.
99. Mong-Suan Yee, Yeap, B. L. and Hanzo, L. (2003) Radial basis function-assisted turbo equal-
ization, IEEE Transactions On Communications, 51(4), 664–675.
100. Okada, T. and Iwanami, Y. (2002) Turbo equalizer detection for GFSK digital FM signals, IEEE
International Conference on Communications (ICC 2002), 28 April–2 May 2002, 5, 2952–2956.
101. Dejonghe, A. and Vandendorpe, L. (2002) Turbo-equalization for multilevel modulation: an
efﬁcient low-complexity scheme, IEEE International Conference on Communications (ICC
2002), 28 April–2 May 2002, 3, 1863–1867.
102. Tuchler, M., Otnes, R. and Schmidbauer, A. (2002) Performance of soft iterative channel
estimation in turbo equalization, IEEE International Conference on Communications (ICC
2002), 28 April–2 May 2002, 3, 1858–1862.

REFERENCES
327
103. Laot, C., Glavieux, A. and Labat, J. (2001) Turbo equalization: adaptive equalization and channel
decoding jointly optimized, IEEE Journal on Selected Areas in Communications, 19(9), 1744–
1752.
104. Omidi, M. J., Gulak, P. G. and Pasupathy, S. (1998) Parallel structures for joint channel estima-
tion and data detection over fading channels, IEEE Journal on Selected Areas in Communica-
tions, 16(9), 1616–1629.
105. Rong Chen, Xiaodong Wang and Liu, J. S. (2000) Adaptive joint detection and decoding in
ﬂat-fading channels via mixture Kalman ﬁltering, IEEE Transactions On Information Theory,
46(6), 2079–2094.
106. Giridhar, K., Shynk, J. J., Iltis, R. A. and Mathur, A. (1996) Adaptive MAPSD algorithms for
symbol and timing recovery of mobile radio TDMA signals, IEEE Transactions on Communi-
cations, 44(8), 976–987.
107. Rollins, M. E. and Simmons, S. J. (1997) Simpliﬁed per-survivor Kalman processing in fast
frequency-selective fading channels, IEEE Transactions On Communications, 45, 514–553.
108. Anderson, B. D. O. and Moore, J. B. (1979) Optimal Filtering. Prentice Hall, Englewood Cliffs,
NJ.
109. Raheli, R., Polydoros, A. and Tzou, C. (1995) Per-survivor processing: A general approach to
MLSE in uncertain environments, IEEE Transactions On Communications, 43, 354–364.
110. Rao, P. and Bayoumi, M. A. (1991) An algorithm speciﬁc VLSI parallel architecture for Kalman
ﬁlter, in VLSI Signal Processing IV. IEEE, Piscataway, NJ pp. 264–273.
111. Bayoumi, M., Rao, P. and Alhalabi, B. (1992) VLSI parallel architecture for Kalman ﬁlter – an
algorithm speciﬁc approach, Journal of VLSI Signal Processing, 4(2, 3), 147–163.
112. Grewal, M. S. and Andrews, A. P. (1993) Kalman Filtering, Theory and Practice. Prentice Hall,
Englewood Cliffs, NJ.
113. Young-Hoon Kim and Shamsunder, S. (1998) Adaptive algorithms for channel equalization with
soft decision feedback, IEEE Journal on Selected Areas in Communications, 16(9), 1660–1669.
114. Jie Zhu, Xi-Ren Cao and Ruey-Wen Liu (1999) A blind fractionally spaced equalizer using
higher order statistics, IEEE Transactions on Circuits and Systems II: Analog and Digital
Signal Processing, 46(6), 755–764.
115. Chong-Yung Chi and Chii-Horng Chen (2001) Cumulant-based inverse ﬁlter criteria for MIMO
blind deconvolution: properties, algorithms, and application to DS/CDMA systems in multipath,
IEEE Transactions on Signal Processing, 49(7), 1282–1299.
116. Behbahani, A. R. S. and Asjadi, H. (1996) Blind equalization based on third-order cumulant
for 4-level and 8-level PAM, Record of the 5th IEEE International Conference on Universal
Personal Communications, 29 September–2 October 1996 1, 136–140.
117. Hatzinakos, D. and Nikias, C. L. (1991) Blind equalization using a tricepstrum-based algorithm,
IEEE Transactions On Communications, 39(5), 669–682.
118. Tugnait, J. K. (1995) Blind equalization and estimation of digital communication FIR channels
using cumulant matching, IEEE Transactions On Communications, 43(2, 3, 4), 1240–1245.
119. Chih-Chun Feng and Chong-Yung Chi (1999) Performance of cumulant based inverse ﬁlters
for blind deconvolution, IEEE Transactions on Signal Processing, 47(7), 1922–1935.
120. Papoulis, A. (1991) Probability, Random Variables, and Stochastic Processes, 3rd edition,
McGraw Hill, New York.
121. Marcos, S., Cherif, S. and Jaidane, M. (1995) Blind cancellation of intersymbol interference in
decision feedback equalizers, in Proceedings of ICASSP, pp. 1073–1076.

328
CHANNEL ESTIMATION AND EQUALIZATION
122. Kamel, R. E. and Bar-Ness, Y. (1993) Blind decision feedback equalization using the decorre-
lation criterion, in Proceedings of GLOBECOM, pp. 87–91.
123. Kennedy, R. A. (1993) Blind adaptation of decision feedback equalizers: Gross convergence
properties, International Journal of Adaptive Control Signal Processes, 7, 497–523.
124. Papadias, C. B. and Paulraj, A. (1995) Decision–feedback equalization and identiﬁcation of
linear channels using blind algorithms of the Bussgang type, in Proceedings of Asilomar Coni
Signals, Systems, Computers, Paciﬁc Grove, CA, 1995, pp. 335–340.
125. Haykin, S. (Ed.) Blind Deconvolution Prentice Hall, Englewood Cliffs, NJ.
126. Haykin, S. (1996) Adaptive Filter Theory, 3rd edition, Prentice Hall, Englewood Cliffs, NJ.
127. Benveniste, A., Goursat, M. and Ruget, G. (1980) Robust identiﬁcation of a nonminimum phase
system: Blind adjustment of a linear equalizer in data Communications, IEEE Transactions on
Automatic Control, AC–25, 385–399.
128. Comon, P. (1994) Independent component analysis, a new concept?, Signal Processing, 36,
287–314.
129. Moreau, E. and Macchi, O. (1993) New self-adaptive algorithms for source separation based on
contrast functions, in Proceedings of the IEEE Signal Processing Workshop on Higher-Order
Statistics, June 1993, pp. 215–219.
130. Kim, Y.-H. and Shamsunder, S. (1998) Multichannel algorithms for simultaneous equalization
and interference suppression, in Wireless Personal Communications, Kluwer, Norwell, MA pp.
219–237.

7
Orthogonal
Frequency Division
Multiplexing – OFDM
and Multicarrier CDMA
The basic principles of the orthogonal frequency division multiplexing (OFDM) concept are presented
in Chapter 1. Within this chapter we introduce further details with the main focus on synchronization,
channel estimation, space–time frequency coding, pick to average power ratio (PAPR) and some
comparisons of efﬁciency in dealing with multipath propagation impacts by using equalization and
TDMA or OFDM signal formats.
7.1
TIMING AND FREQUENCY OFFSET IN OFDM
As already indicated in Chapter 1, the transmitted OFDM signal can be represented as
x(t) =
N+k2+1

k=−k1
N−1

n=0
Dke j2π
nk
N w

t −k
fs

(7.1)
for −k1/fs < t < (N + k2)/f , where k1 and k2 are pre- and postﬁx lengths and w(t) is the time
domain window function. The received signal r(t) is ﬁltered and sampled at the rate, or multiples of,
1/T .
The sampled signal at the output of the receiver FFT with ideal channel can be represented as a
convolution:
yn =

∞

k=−∞
Xc

f + Nk
T

⊗T W( f T )
 f = n
T
(7.2)
where Xc ( f ) is the Fourier transform of the periodically repeated analog equivalent of the signal
generated by the transmitter’s IFFT.
Xc( f ) is a line spectrum at k/T and W( f ) is the Fourier transform of window function w(t).
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

330
OFDM AND MULTICARRIER CDMA
Assuming that the sampling time has a relative phase offset of τ and that the offset does not
change during one OFDM symbol, the sampled received signal for a non-dispersive channel can be
simpliﬁed to:
yk =
N−1

n=0
Dne jϕe j2π
n
N fct
t= k + τ
fs
(7.3)
where ϕ represents envelope delay distortion. After the Fourier transform at the receiver we have
˜Dm = 1
N
N−1

k=0
N−1

n=0
Dne j2π
n
N ke j(ϕ+2π
n
N τ)e−j2π
m
N k
=
N−1

n=0
Dne j(ϕ+2π
n
N τ)
N−1

k=0
e−j2π
k
N (n−m) =
 0, n ̸= m
Dme j(ϕ+2π
nτ/N), n = m
(7.4)
The timing phase (error), or envelope delay distortion, does not violate the orthogonality of
the subcarriers and the effect of the timing offset is a phase rotation which linearly changes with
subcarriers’ orders. On the other hand, envelope delay results in the same amount of rotation for all
subcarriers.
It is straightforward to show that in a more general case, with pulse shaping ﬁlter with rolloff
factor α and dispersive channel with impulse response h(t), the detected data is attenuated and phase
rotated such that ˜Dm = γm (τ) Dm, where:
γm(τ) =



H
 m
NT

e j2π
m
NT τ, 0 ≤m
N ≤1 −α
2
H
 m
NT

e j2π
m
NT τ + H
m −N
NT

e j2π
m−N
NT τ, 1 −α
2
≤m
N ≤1 + α
2
H
m −N
NT

e j2π
m−N
NT τ, 1 + α
2
≤m
N ≤1
(7.5)
where H(m/NT ) is the Fourier transform of h(t) at frequency m/NT. The estimation of τ and ϕ will
be discussed later in this section.
We will now see that frequency offset amounts to inter-channel interference which is similar to
inter-symbol interference of a single carrier signal due to a timing jitter. In a non-dispersive channel
with rectangular pulse shaping, the interference caused by frequency offset could be too constraining.
The sampled signal is:
yk =
N−1

n=0
Dke j2π
t( n
N fs+δf)
t= k+τ
fs
=
N−1

n=0
Dke
j2π

n
N + δf
fs

k
(7.6)
After DFT we have
˜D = Dm
 e j2π
f −1
e j2π
f
N −1

+
N−1

n=0
Dn
N−1

k=0
e j2π
k
N (n−m+f ) + Nm
(7.7)
where f = nδ/fs. So, due to the frequency offset we have attenuation of the desired signal (the ﬁrst
term of Equation (7.7)), and an interference between different symbols of several subcarriers (the
second term of Equation (7.7)).
In order to avoid frequency offset, the window function
wn = w(t)|t=nT
(7.8)
must be such that zero crossings of its Fourier transform are at multiples of symbol frequency
Wm = W(ω)|ω=2π
m fs = δm
(7.9)

TIMING AND FREQUENCY OFFSET IN OFDM
331
0.05
0.10
0.15
0.20
0.25
0.30
0.35
0.40
0
20
40
60
SIR (dB)
Frequency offset (% of subcarrier BW)
Raised cosine window
Rectangular window
Figure 7.1 ACI caused by frequency offset.
A generalized sinc function of the form
sin ωn
ωn
× g(n)
(7.10)
for any differentiable function, g(t) satisﬁes the condition.
Another desired property of a sinc function is its low rate of change in the vicinity of in-frequency
sampling points. A typical example is the raised cosine function in time:
wrc =



T,
0 ≤|t| ≤1 −β
2T
sin π
t
T
π
t
T
× cos βπ
t
T
1 −4β2 t2
T 2
,
1 −β
2T
≤|t| ≤1 + β
2T
0,
elsewhere
(7.11)
where β is the rolloff factor for time domain pulse shaping. A higher rolloff factor requires a longer
cyclic extension and a guard interval, which consumes higher bandwidth. The results for adjacent
channel interference (ACI) caused by frequency offset in systems with different windowing functions
are shown in Figure 7.1.
7.1.1
Robust frequency and timing synchronization for OFDM
7.1.1.1
Symbol timing estimation algorithm
The symbol timing recovery relies on searching for a training symbol with two identical halves in
the time. Consider the ﬁrst training symbol where the ﬁrst half is identical to the second half (in time
order), except for a phase shift caused by the carrier frequency offset. If the conjugate of a sample
from the ﬁrst half is multiplied by the corresponding sample from the second half (T/2 seconds later),
the effect of the channel should cancel, and the result will have a phase of approximately φ = πT f .
At the start of the frame, the products of each of these pairs of samples will have approximately
the same phase, so the magnitude of the sum will be a large value. Let us use L complex samples
in one half of the ﬁrst training symbol (excluding the cyclic preﬁx), and let the sum of the pairs of
products be
P(d) =
L−1

m=0
(r ∗
d+mrd+m+L)
(7.12)

332
OFDM AND MULTICARRIER CDMA
This can be implemented with the iterative formula
P(d + 1) = P(d) + (r ∗
d+Lrd+2L) −(r ∗
drd+L)
(7.13)
where d is a time index corresponding to the ﬁrst sample in a window of 2L samples. This window
slides along in time as the receiver searches for the ﬁrst training symbol. The received energy for the
second half symbol is deﬁned by
R(d) =
L−1

m=0
|rd+m+L|2
(7.14)
This can also be calculated iteratively. R(d) may be used as part of an automatic gain control (AGC)
loop. A timing metric can be deﬁned as
M(d) = |P(d)|2
(R(d))2 .
(7.15)
Equation (7.15) is shown in Figure 7.2 and Figure 7.3.
−1.0
−0.5
0.0
0.5
1.0
0.0
0.2
0.4
0.6
0.8
1.0
Timing metric
Timing offset (symbols)
Figure 7.2 The timing metric for the AWGN channel (SNR = 10).
−10
10
20
30
40
0.0
0.2
0.4
0.6
0.8
1.0
Timing metric
SNR (dB)
Best timing
Outside first symbol
0
Figure 7.3 Expected value of timing metric with L = 512. Dashed lines indicate three
standard deviations.

TIMING AND FREQUENCY OFFSET IN OFDM
333
For the results in these ﬁgures, OFDM symbols are generated with 1000 frequencies, −500 to
499, and slightly oversampled at a rate of 1024 samples for the useful part of each symbol. In an
actual hardware implementation, the ratio of the sampling rate to the number of frequencies would
be higher to ease ﬁltering requirements. The guard interval is set to about 10 % of the useful part,
which is 102 samples.
7.1.1.2
Carrier frequency offset estimation algorithm
The main difference between the two halves of the ﬁrst training symbol will be a phase difference of
φ = π T f
(7.16)
which can be estimated by
ˆφ = angle(P(d))
(7.17)
The second training symbol contains a PN sequence on the odd frequencies to measure these sub-
channels, and another PN sequence on the even frequencies to help determine frequency offset. If | ˆφ|
can be guaranteed to be less than π, then the frequency offset estimate is
 ˆf = ˆφ/(π T )
(7.18)
and the even PN frequencies on the second training symbol would not be needed. Otherwise, the
actual frequency offset would be
φ
π T + 2z
T
(7.19)
where z is an integer. By partially correcting the frequency offset, adjacent carrier interference (ACI)
can be avoided, and then the remaining offset of 2z/T can be found. After the two training symbols
are frequency corrected by ˆφ/(π T ) (by multiplying the samples by exp(−j2t ˆφ/T ), let their FFTs
be x1,k and x2,k, and let the differentially-modulated PN sequence on the even frequencies of the
second training symbol be vk. The PN sequence vk will appear at the output except it will be shifted
by 2z positions because of the uncompensated frequency shift of 2z/T . Note that because there is
a guard interval and there is still a frequency offset, even if there were no differential modulation
between training symbols 1 and 2 (vk = 1) there would still be a phase shift between x1,k and x2,k of
2π (T + Tg)2z/T . Since at this point the integer z is unknown, this additional phase shift is unknown.
Since the phase shift is the same for each pair of frequencies, a metric similar to the previous one can
be used.
Let X be the set of indices for the even frequency components,
X = { −W, −W + 2, . . . , −4, −2, 2, 4, . . . , W −2, W}. The number of even positions shifted
can be calculated by ﬁnding ˆg to maximize
B(g) =

k∈X x∗
1,k+2gv∗
k x2,k+2g

2
2

k∈X|x2,k|2
2
(7.20)
with integer g spanning the range of possible frequency offsets and W being the number of even
frequencies with the PN sequence.
Then the frequency offset estimate would be:
 ˆf = [ˆφ/(π T )] + (2ˆg/T )
(7.21)
7.1.1.3
Variance of carrier frequency offset estimator
From Equations (7.18) and (7.20) we have:
var[ ˆφ/π] =
1
π 2 · L · SNR
(7.22)

334
OFDM AND MULTICARRIER CDMA
One should keep in mind the Cramer–Rao bound is
var[ ˆφ/π] ≥
1
π 2 · L · SNR
(7.23)
At the correct frequency offset, all the signal products
s∗
1,h+gcorrectv∗
hs2,h+gcorrect
have the same phase and
µB = E[B(gcorrect)] =
σ 4
s

σ 2
s + σ 2
n
2
(7.24)
var[B(gcorrect)] =
σ 4
s

(2 + 2µB)σ 2
s σ 2
n + (1 + 4µB)σ 4
n

W

σ 2
s + σ 2
n
4
At an incorrect frequency offset the signal products no longer add phase, and B(g incorrect) has a
chi-squared distribution with two degrees of freedom with
E[B(gcorrect)] =
1
2W

1 +
σ 2
s
σ 2
s + σ 2
n

< 1
W
(7.25)
var[B(gcorrect)] =
1
4W 2

1 + 3σ 4
s + 2σ 2
s σ 2
n

σ 2
s + σ 2
n
2

<
1
W 2
7.2
FADING CHANNEL ESTIMATION FOR OFDM SYSTEMS
7.2.1
Statistics of mobile radio channels
The channel impulse response will be represented as
h(t, τ) =

k
γk(t)δ(τ −τk)
(7.26)
Assume that γk(t) has the same normalized time correlation function rt(t) for all k, and power
spectrum pt(Ω).
rγ k(t)
= E{γk(t + t)γ ∗
k (t)} = σ 2
k rt(t)
(7.27)
where σ 2
k is the average power of the kth path.
The frequency response of the time-varying radio channel at time t is
H(t, f )
=
∞

−∞
h(t, τ)e−j2π
f τdτ =

k
γk(t)e−j2π
f τk
(7.28)
The time–frequency correlation is deﬁned as
rH(t, f )
= E{H(t + t, f + f )H ∗(t, f )}
=

k
rγ k(t)e−j2π
f τk
= rt(t)

k
σ 2
k e−j2π
f τk

= σ 2
Hrt(t)r f (f )
(7.29)

FADING CHANNEL ESTIMATION FOR OFDM SYSTEMS
335
where σ 2
H
= 
k
σ 2
k is the total average power of the channel impulse response. The frequency corre-
lation is deﬁned as
r f (f ) =

k
σ 2
k
σ 2
H
e−j2π
f τk
(7.30)
where rt(0) = r f (0) = 1. Without loss of generality, we also assume that σ 2
H = 1, so that it can be
omitted. For block length T f and tone spacing (subchannel spacing) f, the correlation function for
different blocks and tones is
rH [n, k] = rt [n]r f [k]
(7.31)
where
rt [n]
=rt(nT f )
r f [k]
=r f (kf )
From Jakes’s model of the channel we have:
rt [n] = J0(nωd)
=rJ [n]
pJ(ω) =



2
ωd
1

1 −(ω/ωd)2 ,
i f |ω| < ωd
0,
otherwise
(7.32)
As an example, for carrier frequency fc = 2 GHz, fd = 184 Hz when the user is moving at 60 mph.
7.2.2
Diversity receiver
In the case of space (antenna) diversity, the signal from the mth antenna at the kth tone and the nth
block can be represented as
xm[n, k] = Hm[n, k]a[n, k] + ωm[n, k]
(7.33)
where ωm[n, k] is additive Gaussian noise from the mth antenna at the kth tone and the nth block,
with zero mean and variance ρ. Let us assume that ωm [n, k] is independent for different ns, ks, or ms.
Hm[n, k], the frequency response at the kth tone and the nth block corresponding to the mth antenna,
is assumed independent for different ms, but with the same statistics. a[n, k] is the signal modulating
the kth tone during the nth block and is assumed to have unit variance and be independent for different
ks and ns.
With knowledge of the channel parameters, a[n, k] can be estimated as y[n, k] by an MMSE
combiner
y[n, k] =
p
m=1
H ∗
m[n, k]xm[n, k]
p
m=1
|Hm[n, k]|2
(7.34)
The transceiver (transmitter/receiver) block diagram is given in Figure 7.4.
7.2.3
MMSE channel estimation
If the reference a[n, k] is ideal (pilot symbols), a temporal estimation of H[n, k] is
˜H[n, k] = x[n, k]a∗[n, k] ˜= H[n, k] + ω[n, k]a∗[n, k]
(7.35)

336
OFDM AND MULTICARRIER CDMA
(a)
(b)
4PSK
modulation
R – S
coder
IFFT
x[n,k]
a[n,k]
b[n,k]
a[n,k]
channel
estimator
x1[n,k]
xp[n,k]
y[n,k]
a[n,k]
b[n,k]
H1[n,k],…, Hp[n,k]
FFT
FFT
reference
generator
R – S
decoder
Figure 7.4 OFDM system with channel estimator. (a) Transmitter; (b) diversity receiver.
where ∗denotes the complex conjugate. ˜H[n, k]s for different ns and ks are correlated; therefore, an
MMSE channel estimator can be constructed as follows:
ˆH[n, k] =

l
0

m=−∞
c[m,l, k] ˜H[n −m, k −l]
(7.36)
where c[m, l, k]s are selected to minimize
MSE({c[m,l, k]}) = E| ˜H[n, k, ] −H[n, k]|2
(7.37)
If K is the number of tones in each OFDM block, then we will be using the following notation
c[m, k]
=


c[m, k −1, k]
...
c[m, 0, k]
...
c[m, −K + k, k]


c(ω; k)
=
0
n=−∞
c[n, k]e−jnω
C(ω)
= (c(ω; 1), c(ω; 2), · · · , c(ω; K))
(7.38)
Starting from the fact that the projection of the estimation error on H[n, k] is zero,
E{( ˆH[n, k] −H[n, k]) ˜H ∗[n −m, k −l]} = 0 (for orthogonality principles see Chapter 5), the esti-
mation coefﬁcients are given by [1]:
C(ω) = UH(ω)U
(7.39)
where (ω) is a diagonal matrix with the lth element
l(ω) = 1 −
1
Ml(−ω)γl[0]
(7.40)
and Ml(ω) is a stable one-sided FT
Ml(ω) =
∞

n=0
γl[n]e−jnω
(7.41)
Ml(ω)Ml(−ω) = dl
ρ pt(ω) + 1
(7.42)

FADING CHANNEL ESTIMATION FOR OFDM SYSTEMS
337
H[n,1]
H[n,2]
H[n,K]
H[n,2]
H[n,K]
H[n,1]
F1(w)
FKo(w)
UH
U
Figure 7.5 Channel estimator for OFDM systems.
The DC component γ l[0] in Ml(ω) can be found by
γ 2
l [0] = exp



1
2π
π

−π
ln
dl
ρ pt(ω) + 1

dω



(7.43)
The dls and uls are the corresponding eigenvalues and eigenvectors of the frequency domain correla-
tion matrix R f ,
R f
=


r f [0]
r f [1]
· · ·
r f [K −1]
r f [−1]
r f [0]
· · ·
r f [K −2]
...
...
...
...
r f [−K + 1]
r f [−K + 2]
· · ·
r f [0]


(7.44)
U = (u1, . . . , uk) is a unitary matrix.
R f = ¯UHD ¯U
or
¯UR f ¯UH = D
(7.45)
and D = diag{d1, . . . , dK} and 
k dk = K. The processing is illustrated in Figure 7.5.
The unitary linear inverse transform UH and transform U in the ﬁgure perform the eigendecom-
position of the frequency domain correlation. The estimator turns off the zero or small dls to reduce
the estimation noise. For those large dls, linear ﬁlters are used to take advantage of the time domain
correlation.
One can show [1] that for Jakes’s model:
MMSEJ(ωd) = ρ
K
K

l−1

1 −
αl
2
−(ωd)π
exp

−ωdb(αl)
π
&
(7.46)
αl
= 2dl
ωdρ
b(αl)
=



π
2 αl +
'
1 −α2
l ln 1 +

1 −α2
l
αl
,
if αl < 1
π
2 αl −
'
α2
l −1
π
2 −arcsin 1
αl

,
if αl ≥1
7.2.4
FIR channel estimator
For a reader less familiar with eigenvalue decomposition, discussed in Chapter 5, we provide a
simpliﬁed interpretation of the processing by using an approximation. Instead of proper eigenvectors

338
OFDM AND MULTICARRIER CDMA
we use DFT matrix W deﬁned as
W
=
1
√
K


1
1
· · ·
1
1
e j(2π/K)
· · ·
e j(2π(K−1)/K)
...
...
...
...
1
e j(2π(K−1)/K)
· · ·
e j(2π(K−1)(K−1)/K)


(7.47)
and with notation
¯Rt =


¯rt[0]
¯rt[1]
· · ·
¯rt[L −1]
¯rt[−1]
¯rt[0]
· · ·
¯rt[L −2]
...
...
...
...
¯rt[−L + 1]
¯rt[−L + 2]
· · ·
¯rt[0]


(7.48)
¯rt = (¯rt[0], ¯rt[1], · · · , ¯rt[L −1])T
¯rt[n] = sin(nωd)
nωd
we have, for the coefﬁcient matrix of the designed FIR channel estimator,
¯C(ω) = WH ¯(ω)W
(7.49)
with
¯(ω) = diag{c(ω), . . . , c(ω),
(
)*
+
K0 elements
0, . . . 0}
If the maximum delay spread is td, then for all l ≤K0 (K0 = ⌈Ktd/Ts⌉), dl ≈0, where Ts is the
symbol interval. In Equation (7.49), c(ω) is the FT of cn given by
(c0, c1, c2, . . . , cL−1)T =

¯Rt + Koρ
K I
−1
¯rt
and L is the length of the FIR estimator. The estimation error
MSE = Koc0ρ
K
(7.50)
For the robust FIR channel estimator, the U in Figure 7.5 is the DFT matrix W and the Φk(ω)s
for k =1, . . . , K are c(ω).
7.2.5
System performance
The set of assumptions used to generate the performance curves is the same as in [1]: a two-way
Rayleigh fading with delay from 0 to 40 µs and Doppler frequency from 10 to 200 Hz; the channels
corresponding to different receivers have the same statistics; two antennas are used for receiver
diversity. For the OFDM signal, it is assumed that the entire channel bandwidth, 800 kHz, is divided
into 128 subchannels. The four subchannels on each end are used as guard tones and the rest (120
tones) are used to transmit data. To make the tones orthogonal to each other, the symbol duration is
160 µs. An additional 40µs guard interval is used to provide protection from ISI, the length Tf = 200
ms and a subchannel symbol rate rb = 5 kBd.
To compare the performance of the OFDM system with and without the channel estimation, PSK
modulation with coherent demodulation and differential PSK (DPSK) modulation with differential
demodulation are used, respectively. The (40, 20) RS code, with each code symbol consisting of
three quadrature PSK/differential quadrature PSK (QPSK/DQPSK) symbols grouped in frequency, is
used in the system. Each OFDM block forms an RS code word. The RS decoder erases ten symbols,
based on signal strength, and corrects ﬁve additional random errors. Hence, the simulated system can
transmit data at 1.2 Mb/s before decoding or 600 kb/s after decoding, over an 800 kHz channel.

64 DAPSK AND 64 QAM MODULATED OFDM SIGNALS
339
7.2.6
Reference generation
Four different ways to generate the reference signal are used:
1. Undecoded/decoded dual mode reference: If the RS decoder can successfully correct all errors
in an OFDM block, the reference for the block can be generated by the decoded data; hence
˜a[n, k] = a[n, k]. Otherwise, ˜a[n, k] = ˆa[n, k].
2. Undecoded reference: ˜a[n, k] = ˆa[n, k], no matter whether the RS decoder can successfully
correct all errors in a block or not.
3. Decoded/CMA dual mode reference: The constant modulus algorithm (CMA) is used to gen-
erate a reference for the OFDM channel estimator. If the RS decoder can successfully correct
all errors in a block, the reference for the block can be generated from the decoded data; hence
˜a[n, k] = a[n, k]. Otherwise, the reference can use the projection of y[n, k] on the unit circle,
i.e. ˜a[n, k] = y[n, k]/mod(y[n, k]).
4. Error removal reference: If the RS decoder can successfully correct all errors in a block, the
reference for the block can be generated by the decoded data. Otherwise, the ˜H[n −1, k]s are
used instead of the ˜H[n, k]s for k = 1, . . . , K respectively.
The results are shown in Figure 7.6.
In general a careful study of the results based on the previous discussion suggests the following
conclusions:
r If a channel estimator is designed to match the channel with 40 Hz maximum Doppler frequency
and 20 µs maximum delay spread, then for all channels with fd ≤40 Hz and td ≤20 µs, the system
performance is not worse than the channel with fd = 40 Hz and td = 20 µs. For channels with fd >
40 Hz or td > 20 µs, such as fd = 80 Hz and td = 20 µs or fd = 40 Hz and td = 40 µs, the system
performance degrades dramatically.
r If the estimator is designed to match a Doppler frequency or delay spread larger than the actual ones,
the system performance degrades only slightly compared with estimation that exactly matches the
channel Doppler frequency and delay spread.
More details on channel estimation can be found in [2–11].
7.3
64 DAPSK AND 64 QAM MODULATED OFDM SIGNALS
In this section we discuss in more detail speciﬁc, high constellation, modulation schemes for OFDM
signals. The transmission system and two options for the signal constellation are shown in Figures 7.7.
and 7.8.
In this section we consider an OFDM system with N = 1024 subcarriers and parameters the same
as in [12]. Each OFDM symbol transfers 6144 bits in total. The convolutional code has the memory
length m = 6. The bit interleaver is a block interleaver with 83 rows and 74 columns, which means
that only two bits of an OFDM symbol are not involved in the interleaving process. The performance
of convolutional codes with code rates 1/2, 2/3 and 3/4 has been analyzed.
A (204, 188) RS code with p = 8 b/symbol has been chosen for the DTVB application. The
objective of the concatenated code is to fulﬁl the requirement of a residual bit error rate (BER) of
10E−11 at the output of the RS decoder. For this, the BER at the output of the Viterbi decoder is
required to be lower than 2 × 10E−4 [13]. The above parameters are used in the system for digital
terrestrial video broadcasting [14–17]. Such a system can transmit 34 Mbits/s over an 8 MHz radio
channel.
The phase modulation is independent of the amplitude and identical to the well known 16 DPSK.
The input bits bi,0, bi,1, bi,2, bi,3 are used for this differential phase modulation in the 64 DAPSK
scheme. The amplitude states |xi| are chosen from the constellation diagram depending on the previous

340
OFDM AND MULTICARRIER CDMA
0
5
10
15
20
10
−3
10
−2
10
−1
10
0
Error removal reference
DQPSK
Dual mode ref. (decoded/CMA)
Undecoded reference
Ideal reference
Ideal channel parameters
Dual mode ref. (decoded/undecoded)
WER
SNR (dB)
0
5
10
15
20
−40
−30
−20
−10
0
Ideal estimator
Ideal reference
Dual mode ref. (decoded/undecoded)
Undecoded reference
Dual mode ref. (decoded/CMA)
Error removal reference
MMSE (dB)
SNR (dB)
(a)
(b)
Figure 7.6 (a) WER and (b) MMSE of a robust estimator with different references versus
SNR for the system with 1 % training blocks when the 50-tap channel estimator
matches the channel with fd = 200 Hz and td = 5 µs.
amplitude state |˜xi| and the two information bits bi,5 and bi,4 according to Table 7.1. This means, e.g.
for a subcarrier i if the amplitude in the previous OFDM symbol was |˜xi| and the input information
bits bi,5 and bi,4 were both zero, then the amplitude in the current OFDM symbol would be |xi| = |˜xi|
again. Table 7.1 shows the amplitude state |xi| for the subcarrier in the current OFDM symbol.
In each OFDM receiver after block synchronization, analog-to-digital (A/D) conversion, and
removing of the guard interval, a fast Fourier transform (FFT) will produce the complex output states
yi for each subcarrier i. If the coherent 64 QAM is used, after the FFT a channel equalization must
be performed.
This means that the channel transfer factor αi is assumed to be known exactly for each subcarrier i.
With this information, the transmitted state xi of each subcarrier in the 64 QAM constellation diagram

coding scheme
Reed–Solomon
encoder
Symbol
interleaver
Convolutional
encoder
Bit
interleaver
Transmission
Bit
deinterleaver
Viterbi
decoder
Symbol
deinterleaver
Reed–Solomon
decoder
Data
Modulator
IFFT
D/A
IFFT
A/D
IFFT
Demodulator
Equalizer
bi,j
xi
yi
bits/metric
Figure 7.7 Transmission system.
Im(x)
Re(x)
a = 1.4
1
a
a2
a3
Im(x)
Re(x)
Figure 7.8 Constellation diagrams of 64 DAPSK and 64 QAM.

342
OFDM AND MULTICARRIER CDMA
Table 7.1
Differential amplitude modulation for 64
DAPSK. Choice of the current amplitude
state |xi| depending on the previous state
|˜xi| and the amplitude bits
Amplitude bits bi,4bi,5
|˜xi|
00
01
11
10
1
1
a
a2
a3
a
a
a2
a3
1
a2
a2
a3
1
a
a3
a3
1
a
a2
Table 7.2
Evaluation of the amplitude information bits bi,5 and bi,4 in the 64
DAPSK demodulation
|ri| = |yi/˜yi
a−3
a−2
a−1
1
a1
a2
a3
bi,4bi,5
01
11
10
00
01
11
10
thresholds
a−2.5
a−1.5
a−0.5
a−0.5
a1.5
a−2.5
a−2.5
a−1.5
a−0.5
a0.5
a1.5
a2.5
a3.5
is evaluated by simple quotient
xi ≈yi/αi
in order to get the coded bit sequence for hard decision decoding or the metric increments for soft
decision decoding.
For the non-coherent 64 DAPSK demodulation, ﬁrst the quotient
ri = yi/˜yi ≈xi/˜xi
of the currently received state yi and the preceding state ˜yi of the same subcarrier i in the receiver (FFT
output) are calculated. The resulting complex quotient ri is evaluated in order to get the phase and
amplitude bits bi,0, bi,1, . . . , bi,5. This quotient ri is nearly independent of channel transfer factor αi
if the radio channel does not change the transmission behavior too quickly. Therefore, pilot symbols,
channel estimation and equalization are not needed in the 64 DAPSK receiver, which reduces the
computation complexity.
The four bits bi,0, bi,1, bi,2, bi,3 are determined depending on the phase difference between yi and
˜yi only. This phase demodulation process is the same as the demodulation of 16 DPSK.
For the amplitude demodulation, Table 7.2 shows how the amplitude bits bi,4 and bi,5 are obtained.
For the evaluation of |ri|, simple amplitude thresholds are used.
Performance results are given in Figure 7.9 and Tables 7.3–7.5. On average, 4 dB SNR degradation
must be accepted in order to have much simpler-to-implement DAPSK. More details on coherent
APSK and DAPSK can be found in [12–22].

16
18
20
22
24
SNR (dB)
10−6
10−5
10−4
10−3
10−2
10−1
100
BER
Ideal 64 QAM (hard decision)
64 DAPSK (hard decision)
64 QAM (soft decision)
64 DAPSK (soft decision)
(a)
18
20
22
24
10−6
10−5
10−4
10−3
10−2
10−1
10
BER
SNR (dB)
64 QAM(Rice-fading)
64 DAPSK(Rice-fading)
64 QAM(Rayleigh-fading)
64 DAPSK(Rayleigh-fading)
18
20
22
24
BER
(b)
Figure 7.9 (a) Performance of ideal 64 QAM and 64 DAPSK (ring ratio a = 1.4) with
a convolutional code m = 6, R = 3/4 for hard and soft decision decoding
in an AWGN channel; (b) performance of ideal 64 QAM (convolutional code
R = 3/4) and 64 DAPSK (R = 2/3) over the Rayleigh and Rice-fading channel
(ﬁxed user data rate).
Table 7.3
SNR [dB] required for BER = 2 × 10−4
Ideal 64 QAM
64 DAPSK
Code
AWGN
Rice
Rayleigh AWGN
Rice
Rayleigh
rate R Metric
channel channel
channel
channel channel
channel
1/2
hard decision
17.3
19.6
24.1
21.4
23.7
28.6
2/3
hard decision
19.5
22.4
28.6
24.0
26.5
33.2
3/4
hard decision
20.9
23.9
32.8
25.7
28.2
37.4
1/2
soft decision
13.6
15.6
18.6
17.7
19.5
22.3
2/3
soft decision
16.8
19.1
22.4
20.6
22.8
26.5
3/4
soft decision
18.5
20.8
24.9
22.5
24.8
29.3

344
OFDM AND MULTICARRIER CDMA
Table 7.4
Difference of required SNR [dB] for 64 QAM (ideal channel esti-
mation) and 64 DAPSK modulation at BER = 2 × 10−4, ﬁxed code
rates
Hard decision
Soft decision
Code
AWGN
Rice
Rayleigh
AWGN
Hire
Rayleigh
rate R
channel
channel
channel
channel
channel
channel
1/2
4.1
4.1
4.5
4.1
3.9
3.7
2/3
4.5
4.1
4.6
3.8
3.7
4.1
3/4
4.8
4.3
4.6
4.0
4.0
4.4
Table 7.5
Difference of required SNR [dB] for 64 QAM (ideal channel estima-
tion) with R = 3/4 and 64 DAPSK modulation with R = 2/3 at BER
= 2 × 10−4, ﬁxed user data rate
Hard decision
Soft decision
Code
AWGN
Rice
Rayleigh
AWGN
Rice
Rayleigh
rate R
channel
channel
channel
channel
channel
channel
QAM: 3/4
3.1
2.6
0.4
2.1
2.0
1.6
DAPSK: 2/3
Source
TC/RS
encoder
Channel
interleaver
STT/STB
encoder
STT/STB
decoder
Channel
deinterleaver
TC/RS
decoder
Sink
IFFT
IFFT
FFT
FFT
Channel
OFDM
Figure 7.10 Turbo convolutional (TC) or Reed–Solomon (RS) code used with space–time
trellis (STT) or space–time block (STB) encoder.
7.4
SPACE–TIME CODING WITH OFDM SIGNALS
In this section we discuss space–time coding with an OFDM signal. The system block diagram is
shown in Figure 7.10.
In the system, Alamouti’s G2 space–time block code is used
G2 =
 x1
x2
−¯x2
¯x1

For comparison the system parameters used in this section are the same as in [23] and are speciﬁed
in Tables 7.6–7.8.

SPACE–TIME CODING WITH OFDM SIGNALS
345
Table 7.6
Modulation parameters
No. of
Modulation
Bits per symbol
Decoding
No. of
No. of
termination
scheme
BPS
algorithm
states
transmitters
symbols
4PSK
2
VA
4
2
1
8
2
2
16
2
2
32
2
3
8PSK
3
VA
8
2
1
16
2
2
32
2
2
Table 7.7
The parameters associated with the turbo convolutional (n, k, K)
TC(2, 1, 3) code
Code
Modulation
Random turbo
Random separation
Code
rate R
mode
BPS
interleaver depth
interleaver depth
128 carriers
TC(2,1, 3)
0.50
16 QAM
2
256
512
64 QAM
3
384
768
512 carriers
QPSK
1
512
1024
16 QAM
2
1024
2048
Table 7.8
The coding parameters of the Reed–Solomon codes
Code
Galois ﬁeld
Rate
Correctable symbol errors
RS(105, 51)
210
0.49
27
RS(153, 102)
210
0.67
25
7.4.1
Signal and channel parameters
A two-ray channel impulse response having equal amplitudes and differential delay of 5µs is used. The
average signal power received from each transmitter antenna is the same. All multipath components
undergo independent Rayleigh fading; Jakes’s model. The receiver has a perfect knowledge of the
CIR. A 128 subcarrier (160 µs) OFDM signal with a cyclic extension of 32 samples (40 µs) is used.
The results are presented in Figure 7.11.
For increased delay spread and Doppler, the variation of the frequency domain fading envelope
will eventually destroy the orthogonality of the space–time block code G2 (see Figure 7.13). For
this reason the two transmission instants of the space–time block code G2 will have to be allocated
to the same OFDM symbol. In the previous example they were allocated to the adjacent subcar-
riers. The transmission system for the time-varying channel is now modeled in Figure 7.12. The

346
OFDM AND MULTICARRIER CDMA
8
10
12
14
16
18
20
22              24
26
Eb / N0 (dB)
10−3
10−2
10−1
100
FER
1 Tx 1 Rx, 4PSK
4-state, 4PSK
8-state, 4PSK
16-state, 4PSK
32-state, 4PSK
G2 , 4PSK
G2 , TC, 16
6
1
0 (d
1 Tx 1 Rx, 4PSK
4-state, 4PSK
8-state, 4PSK
16-state, 4PSK
32-state, 4PSK
2 , 4PSK
2 , TC, 16 QAM
8
10
12
14
16
18
20
22
2
Eb / N0 (dB)
10−3
10−2
10−1
100
FER
1 Tx 1 Rx, 8PSK
8-state, 8PSK
16-state, 8PSK
32-state, 8PSK
G2 , 8PSK
G2 , TC, 64QAM
2
24
26
0
1 Tx 1 Rx, 8PSK
8-state, 8PSK
16-state, 8PSK
32-state, 8PSK
G2 , 8PSK
G2 , TC, 64QAM
4
6
8
10
12
14
16
18
20
Eb / N0 (dB)
10−3
10−2
10−1
100
FER
1 Tx 1 Rx, 8PSK
8-state, 8PSK
16-state, 8PSK
32-state, 8PSK
G2 , 8PSK
G2 , TC, 64QAM
0
1
1 Tx 1 Rx, 8PSK
8-state, 8PSK
16-state, 8PSK
32-state, 8PSK
G2 , 8PSK
G2 , TC, 64QAM
1 Tx 1 Rx, 8PSK
8-state, 8PSK
16-state, 8PSK
32-state, 8PSK
G2 , 8PSK
G2 , TC, 64 QAM
(c)
(b)
(a)
Figure 7.11 FER performance comparison between various (a) 4PSK and (b, c) 8PSK
space–time trellis codes and the space–time block code G2 concatenated with
the TC(2, 1, 3) code using (a, b) one or (c) two receivers and the 128 subcarrier
OFDM modem over a channel having a CIR characterized by two equal-power
rays separated by a delay spread of 5µs. The maximum Doppler frequency
was 200 Hz. The effective throughput was (a) 2 BPS or (b, c) 3 BPS and the
coding parameters are shown in Tables 7.6–7.7.

SPACE–TIME CODING WITH OFDM SIGNALS
347
x1
−x2
x2
x1
Tx1
h1,2
h2,2
h1,1
h2,1
n1
n2
y1
y2
h1,1 h1,2
h2,1 h2,2
x1
x2
Channel
estimator
Maximum likelihood
detector
Combiner
Tx2
Figure 7.12 Baseband representation of the simple twin-transmitter space–time block code
G2 using one receiver over varying fading conditions.
received signals are given by:
˜x1 = ¯h1,1y1 + h2,2 ¯y2
= ¯h1,1h1,1x1 + ¯h1,1h2,1x2 + ¯h1,1n1 −h2,2 ¯h1,2x2 + h2,2 ¯h2,2x1 + h2,2 ¯n2
= (|h1,1|2 + {h2,2|2)x1 + (¯h1,1h2,1 −h2,2 ¯h1,2) x2 + ¯h1,1n1 + h2,2 ¯n2
˜x2 = ¯h2,1y1 + h1,2 ¯y2
= ¯h2,1h1,1x1 + ¯h2,1h2,1x2 + ¯h2,1n1 −h1,2 ¯h1,21x2 −h1,2 ¯h2,2x1 −h1,2 ¯n2
= (|h2,1|2 + {h1,2|2)x2 + (¯h2,1h1,1 −h1,2 ¯h2,2) x1 + ¯h2,1n1 −h1,2 ¯n2
(7.51)
The signal to interference ratio (SIR) for signal x1 is:
SIR =
|h1,1|2 + |h2,2|2
¯h1,1h2,1 −h2,2 ¯h1,2
(7.52)
and for signal x2 is:
SIR =
|h2,1|2 + |h1,2|2
¯h2,1h1,1 −h1,2 ¯h2,2
(7.53)
The two transmission instants are no longer assumed to be associated with the same complex transfer
function values. Performance curves are given in Figures 7.13 and 7.14.
The fading amplitude variation versus time is slower than that versus the subcarrier index within
the OFDM symbols. This implies that the SIR attained would be higher, if we were to allocate the two
transmission instants of the space–time block code G2 to the same subcarrier of consecutive OFDM
symbols. This increase in SIR is achieved by doubling the delay of the system, since in this scenario
two consecutive OFDM symbols have to be decoded.

348
OFDM AND MULTICARRIER CDMA
6
8
10
12
14
16
18
20
22
Eb / N0 (dB)
10−3
10−2
10−1
100
FER
5 µs
10 µs
15 µs
16.25 µs
17.50 µs
18.75 µs
20 µs
40 µs
5 µs
10 µs
15 µs
16.25 µs
17.50 µs
18.75 µs
20 µs
40 µs
5 µs
10 µs
15 µs
16.25 µs
17.50 µs
18.75 µs
20 µs
40 µs
Figure 7.13 FER performance of the space–time block code G2 concatenated with the
TC(2, 1, 3) code using one receiver, the 128 subcarrier OFDM modem and
16 QAM. The CIR exhibits two equal-power rays separated by various delay
spreads and a maximum Doppler frequency of 200 Hz. The coding parameters
are shown in Tables 7.6–7.9.
4
5
6
7
8
9
10
11
13
14
Eb / N0 (dB)
10−3
10−2
10−1
100
FER
32-state, 4PSK STT code
G2 , TC, 16 QAM,adjacent subcarriers
G2 , TC, 16 QAM, adjacent symbols
12
co
, TC,
, TC,
Figure 7.14 FER performance comparison between adjacent subcarriers and adjacent
OFDM symbols allocation for the space–time block code G2 concatenated
with the TC(2, 1, 3) code using one receiver, the 128 subcarrier OFDM modem
and 16 QAM over a channel having a CIR characterized by two equal-power
rays separated by a delay spread of 40 µs. The maximum Doppler frequency
was 100 Hz. The coding parameters are shown in Tables 7.6–7.9.

SPACE–TIME CODING WITH OFDM SIGNALS
349
max = 48.
t
t
9 ns
rms = 15.3 ns
0 10
1.0
0.9
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0.1
0.0
time delay (ns)
magnitude
20 30 40 506070 80 90100
Figure 7.15 Short WATM channel impulse response.
7.4.2
The wireless asynchronous transfer mode system
The CIR used in this case has three paths and is referred to as the shortened WATM CIR, as shown
in Figure 7.15. A 512 subcarrier (2.2756 µs) OFDM time domain signal with a cyclic extension of
64 samples (0.2844 µs) is used. The sampling rate is 225 Msamples/s and the carrier frequency is 60
GHz. The results are shown in Figure 7.16.
7.4.3
Space–time coded adaptive modulation for OFDM
All subcarriers in an adaptive OFDM (AOFDM) symbol are split into blocks of adjacent subcarriers,
referred to as subbands. The same modulation scheme is employed for all subcarriers of the same
subband. This substantially simpliﬁes the task of signaling the modulation modes, since there are
typically four modes and, for example, 32 subbands, requiring a total of 64 AOFDM mode signaling
bits. The system is referred to as subband adaptive OFDM.
The system is presented in Figure 7.17. The choice of the modulation scheme to be used by the
transmitter for its next OFDM symbol is determined by the channel quality estimate of the receiver,
based on the current OFDM symbol. The following assumptions are used: the average signal power
received from each transmitter antenna is the same; all multipath components undergo independent
Rayleigh fading; the receiver has a perfect knowledge of the CIR and perfect signaling of the AOFDM
modulation modes is available.
Optimized switching levels for adaptive modulation over a Rayleigh fading channel, shown in
the instantaneous channel SNR (dB) are given in Table 7.9. The performance results are given in
Figure 7.18.
7.4.4
Turbo and space–time coded adaptive OFDM
In this case the system parameters are as deﬁned in Table 7.10. Performance results are shown in
Figure 7.19.
For details on space–time coding with OFDMA signals and same set of parameters see [23–31].

350
OFDM AND MULTICARRIER CDMA
5
10
15
25
Eb / N0 (dB)
10−3
10−2
10−1
100
FER
20
G2
G2,TC, QPSK
16-state, 4PSK, RS (102,51)
Throughput of 1 BPS
2
2
16-state, 4PSK, RS (102,51)
2
2
16-state, 4PSK, RS (102,51)
, BPSK
2
16-state, 4PSK, RS (102,51)
Throughput of 1 BPS
5
10
15
Eb / N0 (dB)
10−3
−2
10−1
100
FER
20
G2 , QPSK
G2 , TC, 16QAM
32-state, 4PSK
16-state, 8PSK, RS (153, 102)
Throughput of 2 BPS
5
10
1
25
0
10
20
G2, QPSK
G2, TC, 16QAM
32-state, 4PSK
16-state, 8PSK, RS (153, 102)
Throughput of 2 BPS
(b)
(a)
Figure 7.16 FER performance comparison between the TC(2, 1, 3) coded space–time block
code G2 and the RS(102, 51) GF(210) coded 16-state 4PSK space–time trellis
code using one 512 subcarrier OFDM receiver over the shortened WATM
channel at an effective throughput of (a) 1 BPS and (b) 2BPS. The coding
parameters are shown in Tables 7.6–7.9.

LAYERED SPACE–TIME CODING FOR MIMO OFDM
351
Table 7.9
Switching SNR
System
NoTx
BPSK
QPSK
16 QAM
64 QAM
Speech
−∞
3.31
6.48
11.61
17.64
Data
−∞
7.98
10.42
16.76
26.33
IFFT
Source
Sink
TC
Encoder
Channel
Interleaver
Modulation
level switch
STB
Encoder
Channel
FFT
STB
Decoder
Demodulator
Channel
Deinterleaver
TC
Decoder
Modulation
mode
FFT
IFFT
IFFT
Source
Sink
TC
encoder
Channel
interleaver
Modulation
level switch
STB
encoder
Channel
FFT
STB
decoder
Demodulator
Channel
deinterleaver
TC
decoder
Modulation
mode
FFT
IFFT
Figure 7.17 System overview of the turbo coded and space–time coded adaptive OFDM.
0
10
20
40
SNR (dB)
10−8
10−6
10−3
10−1
BER
30
5
15
25
35
10−7
10−5
10−4
10−2
0
1
2
3
4
5
6
BPS
1 Tx, 1 Rx
G2 , 1 Rx
G2 , 2 Rx
G2 , 6 Rx
BER
BPS
0
1
2
3
4
5
6
BPS
1 Tx, 1 Rx
G2 , 1 Rx
G2 , 2 Rx
G2 , 6 Rx
BER
BPS
1 Tx, 1 Rx
G2 , 1 Rx
G2 , 2 Rx
G2 , 6 Rx
BER
BPS
Figure 7.18 BER and BPS performance of 16 subband AOFDM employing the space–time
block code G2 using multiple receivers for a target BER of 10−4 over the
shortened WATM channel shown in Figure 7.15.
7.5
LAYERED SPACE–TIME CODING FOR MIMO OFDM
In this section we extend the discussion on space–time coded OFDM to the case with nt = nr = 4
assuming the Jakes fading model and a layered architecture. The channel modeling is discussed in
Chapter 14, but in this section we assume the channel estimation procedures as in [29] and [32] and
the TU channel model considered in [32]. The OFDM signals assume a channel bandwidth of 1.25
MHz, which is divided into 256 subchannels. Two subchannels at each end of the band are used

352
OFDM AND MULTICARRIER CDMA
Table 7.10
Coding rates and switching levels (dB) for TC(2, 1, 3) and space–
time coded adaptive OFDM over the shortened WATM channel of
Figure 7.15 for a target BER of 10−4
NoTx
BPSK
QPSK
16 QAM
64 QAM
Half rate TC(2, 1, 3)
Rate
–
0.50
0.50
0.50
0.50
Thresholds (dB)
−∞
−4.0
−1.3
5.4
9.8
Variable rate TC(2, 1, 3)
Rate
–
0.50
0.67
0.75
0.90
Thresholds (dB)
−∞
−4.0
2.0
9.70
21.50
0
10
20
40
SNR (dB)
10−6
10−3
10−1
BER
30
5
15
25
35
10−7
10−5
10−4
10−2
0
1
2
3
4
5
6
BPS
1 Tx, 1 Rx
G2 , 1 Rx, uncoded
G2 , 1 Rx, R = ΩTC
G2 , 1 Rx, vary rate TC
BER
BPS
SNR (dB)
0
1
2
3
4
5
6
BPS
1 Tx, 1 Rx
G2 , 1 Rx, uncoded
G2 , 1 Rx, R = ΩTC
G2 , 1 Rx, vary rate TC
BER
BPS
1 Tx, 1 Rx
G2 , 1 Rx, uncoded
G2 , 1 Rx, R =1/2 TC
G2 , 1 Rx, vary rate TC
BER
BPS
Figure 7.19 BER and BPS performance of 16 subband AOFDM employing the space–time
block code G2 concatenated with both half rate and variable rate TC(2, 1, 3)
at a target BER of 10−4 over the shortened WATM channel.
as guard tones, with the other 252 tones used to transmit data. The symbol duration is taken to be
204.8 µs so that the tones are orthogonal. A 20.2 µs guard interval is used to provide protection from
inter-symbol interference, making the block duration Tf = 225 µs. The subchannel symbol rate is
rb = 4.44 kbaud. Systems with the same signal parameters are discussed, for example, in [32, 33].
7.5.1
System model (two times two transmit antennas)
First we consider the ng = 2 (groups of antennas) MIMO-OFDM implementation illustrated in
Figure 7.20. In this case, two antenna space–time codes are employed that use 16 states and QPSK
modulation. Data is grouped into blocks of 500 information bits, called words. Each word is coded
into 252 symbols to form an OFDM block. Since this system uses ng = 2, it can transmit two of
these data blocks (1000 bits total) in parallel. Each time slot consists of ten OFDM blocks with the
ﬁrst block used for training and the following nine blocks used for data transmission. This leads to a
system capable of transmitting 4 Mbit/s using 1.25 MHz of bandwidth, so the transmission efﬁciency
is 3.2 bit/s/Hz.

LAYERED SPACE–TIME CODING FOR MIMO OFDM
353
FFT
FFT
FFT
IFFT
IFFT
IFFT
IFFT
t1[n,k]
t2[n,k]
t3 [n,k]
r1[n,k]
r2[n,k]
t4 [n,k]
rnp[n,k
]
space–
time
processor
space–
time
decoder
space–
time
decoder
channel
parameter
estimation
space–
time
encoder
space–
time
encoder
b1[n,k]
b2[n,k]
Figure 7.20 MIMO–OFDM using ng = 2 individual space–time encoders, each using
nt/ng −2 transmit antennas.
7.5.2
Interference cancellation
In general, all the interference cancellation schemes discussed in Chapter 5, modiﬁed for OFDM
signals, can be used. One option has already been discussed in Chapter 4. An initial study of the system
outlined in this section was provided in [34]. In [34] several interference cancellation approaches were
described and performance was evaluated. Here, we focus on the successive interference cancellation
approach based on signal quality (see Chapter 4). Basically, the strongest signal is detected ﬁrst,
subtracted from the input signal and then the procedure is repeated. We also assume that interleaving
is employed. For the two-antenna, 16-state code given in Chapter 4 [3 (Figure 5)], the word error
rate (WER) is given in Figure 7.21 for the case where the channel has a TU delay proﬁle and for
Doppler frequencies of 5, 40, 100, and 200 Hz. The other two curves in Figure 7.21 illustrate the
performance improvement that can be obtained using the improved convolutional space–time codes
given in Section 4.6. One of these codes was designed to be optimal for the quasi-static fading model
from Section 4.2 (CC1). The other code was designed to be optimal for the rapid fading model in
Section 4.2 (CC2). The improved codes from Section 4.6 are optimal codes based on the criterion
given in Section 4.2. All these details are available in Chapter 4. In summary:
 D + 2D2
1 + 2D2
2D
2

Figure 4.7 (TC)
 D + D2
2 + D
2 + D
2 + 2D + 2D2

quasi-static code Section 4.6 (CC1)
 2D2
2 + D + 2D2
2 + D
2D + 2D2

rapid fading code Section 4.6 (CC2)
7.5.3
Four transmit antennas
Next we investigate the approach that uses four-antenna space–time codes. We consider 16-state and
256-state codes, designed using an ad hoc approach. The codes are presented in Table 7.11 and the
performance results are given in Figure 7.22.

354
OFDM AND MULTICARRIER CDMA
TC
TC
TC
TC
CC1&CC2
CC1&CC2
CC1&CC2
CC1&CC2
(a)
(b)
(c)
(d)
100
10−1
10−2
10−3
WER
WER
WER
100
10−1
10−2
10−3
WER
quasi-static
quasi-static
rapid
quasi-static
rapid
quasi-static
quasi-static
rapid
quasi-static
quasi-static
rapid
quasi-static
4
6
8
10
12
SNR (dB)
SNR (dB)
SNR (dB)
5
10
15
10
0
10
0
10
−1
10
−1
10
−2
4
6
8
10
12
14
16
18
SNR (dB)
4
6
8
10
12
14
16
18
Figure 7.21 Performance curves. (a) 5 Hz Doppler; (b) 40 Hz Doppler; (c) 100 Hz Doppler;
(d) 200 Hz Doppler.
Table 7.11
Generator matrices for the four transmit antenna codes used in ﬁgure 7.22.
These codes are in GF(4) with elements denoted by {0, 1, a, 1 + a}


(1 + a) + D
a + (1 + a)D
a + D
1 + (1 + a)D
a + (1 + a)D
a + D
1 + (1 + a)D
1 + (1 + a)D
a + D
1 + (1 + a)D
1 + (1 + a)D
(1 + a) + aD
1 + (1 + a)D
1 + (1 + a)D
(1 + a) + aD
1 + aD


for the 16-state code


(1 + a) + (1 + a)D + aD2
(1 + a)D + aD2
1 + D2
1 + D2
(1 + a)D + aD2
1 + D2
1 + (1 + a)D + (1 + a)D2
(1 + a) + aD + (1 + a)D2
1 + D2
1 + (1 + a)D + (1 + a)D2
(1 + a) + aD + (1 + a)D2
(1 + a) + aD
1 + (1 + a)D + (1 + a)D2
(1 + a) + aD + (1 + a)D2
(1 + a) + aD
D + D2


for the 256-state code

0
5
10
15
10
−3
10
−2
10
−1
10
0
SNR (dB)
WER
quasi-static 2 ant  
16 states 4 ant.   
256 state 4 ant.   
0
5
10
15
10
−3
10
−2
10
−1
10
0
SNR (dB)
WER
quasi-static 2 ant. 
16 state 4 ant.     
256 state 4 ant.    
(a) 
(b)
 
0
5
10
15
20
10
−3
10
−2
10
−1
10
0
SNR (dB)
WER
q-static 2 ant 
16 state 4 ant 
256 state 4 ant
0
5
10
15
20
10
−2
10
−1
10
0
SNR (dB)
WER
q-static 2 ant 
16 state 4 ant 
256 state 4 ant
(c) 100 Hz Doppler 
(d) 200 Hz Doppler 
Figure 7.22 WER versus SNR of MIMO–OFDM systems with nt = nr = 4, TU channel
with different Doppler frequencies. Here we compare the best code from the
last ﬁgure with codes designed for four transmit antenna cases. See Table 7.11
and Figure 7.21 for details on the codes. (a) 5 Hz Doppler; (b) 40 Hz Doppler;
(c) 100 Hz Doppler; (d) 200 Hz Doppler; (e) comparisons of WER for best
MIMO–OFDM systems with perfect estimates and no Doppler.

356
OFDM AND MULTICARRIER CDMA
6
0
4
2
1
3
5
7
0
00 01 02 03 04 05 06 07
1
50 51 52 53 54 55 56 57
2
20 21 22 23 24 25 26 27
3
70 71 72 73 74 75 76 77
4
40 41 42 43 44 45 46 47
5
10 11 12 13 14 15 16 17
6
60 61 62 63 64 65 66 67
7
30 31 32 33 34 35 36 37
Figure 7.23 Eight-state 8PSK STTC with two transmit antennas and a spectral efﬁciency
of 3 bits/s/Hz.
Information
source
Constellation
mapper
x(k)
To Tx1
To Tx2
x(k-1)
One
symbol
delay
Pk
Figure 7.24 Equivalent encoder model for an eight-state 8PSK STTC with two transmit
antennas.
7.6
SPACE–TIME CODED TDMA/OFDM RECONFIGURATION EFFICIENCY
In this section we compare two options for combating the fading in digital wireless communications,
mainly the TDMA-based concept with equalization versus the OFDM concept. The structure of the
code and the equivalent model of the encoder are shown in Figures 7.23 and 7.24 respectively. This
structure is considered for the EDGE system. The presentation in this section is based mainly on
[35–37].
7.6.1
Frequency selective channel model
The structure of this space–time trellis code (STTC) can be exploited to reduce the complexity of
joint equalization and decoding in a frequency selective channel. This is achieved by embedding the
space–time encoder in Figure 7.24 in the two channels h1 and h2, resulting in an equivalent single-
input single-output (SISO) data-dependent channel impulse response (CIR) with memory (v −1),

SPACE–TIME CODED TDMA/OFDM RECONFIGURATION EFFICIENCY
357
Prefilter
EQUALIZER
and
DECODER
noise
h1
h2
x1
x2
Figure 7.25 Receiver structure for STTC joint equalization/decoding with two transmit and
one receive antennas.
whose delay D-transform is given by
hSTTC
eqv (k, D) = h1(0) +
v

m=1
(h1(m) + pkh2(m −1))Dm + pkh2(v))Dv+1
= h1(D) + pk Dh2(D)
(7.54)
where D is the delay operator and pk = ±1 is data dependent. Therefore, trellis-based joint space–
time equalization and decoding with 8v+1 states can be performed on this equivalent channel. The
traditional trellis equalization would require 82v states, and STTC decoding requires eight states. The
receiver block diagram is shown in Figure 7.25.
7.6.2
Front end preﬁlter
The objective of the preﬁlter is to shorten and shape the effective CIR seen by the equalizer to reduce
its complexity (since the number of equalizer trellis states is exponential in the CIR memory).
7.6.3
Time-invariant channel
First, we describe the preﬁlter design problem for a time-invariant channel with memory v and then
extend it to the data-dependent time-varying channel case. Assume that the FIR preﬁlter has N f
taps and denote its impulse response by the vector w. Then, the impulse response of the effective
channel at the output of the preﬁlter is given by heff = Hw, where H is the (N f + v) × N f Toeplitz
convolution matrix. Let the vector hwin contain the (Nb + 1) taps (where Nb < v) of heff to retain
after shortening (whose energy is to be maximized), and let hwall contain the remaining taps (whose
energy is to be minimized). Then
hwin = Jwinheff = JwinH
( )* +
Hwin
w = Hwinw
(7.55)
where the (Nb + 1) × (N f + v)-dimensional matrix Jwin is constructed using columns of the identity
matrix corresponding to tap positions of hwin within heff. And
hwall = Jwallheff = JwallH
( )* +
Hwall
w = Hwallw
(7.56)
where the (N f + v −Nb −1) × (N f + v)-dimensional matrix Jwall is constructed from the columns
of the identity matrix corresponding to tap positions of hwall within heff.
The preﬁlter design criterion maximizes the shortening signal to noise ratio (SSNR), the desired
signal energy of the shortened channel contained in hwin divided by the residual ISI energy in hwall
plus the noise energy at the preﬁlter output.

358
OFDM AND MULTICARRIER CDMA
7.6.4
Optimization problem
The problem reduces to the generalized eigenvector problem (for speciﬁc details see [36] and the
references therein):
max
w w∗Bw
subject to w∗Aw = 1
(7.57)
where (·)* denotes the complex conjugate transpose operation, B = H∗
winHwin, A = H∗
wallHwall +
Rzz, and Hzz is the noise autocorrelation matrix at the preﬁlter input. The solution has the form
wopt = (L∗
A)−1umax
(7.58)
here, A = LALA* is the Cholesky factorization of the matrix A, and umax is the unitnorm eigenvector
of matrix (LA)−1B(LA)−1 that corresponds to its largest eigenvalue λmax. The resulting optimal SSNR
is given by
SSNRopt =
w∗
optBwopt
w∗
optAwopt
= λmax
(7.59)
Equation (7.59) provides the optimal preﬁlter for a time-invariant channel.
7.6.5
Average channel
For the eight-state 8PSK STTC with two transmit antennas, we can design the preﬁlter for the average
of the equivalent channel given in Equation (7.54). It can be shown [36] that the matrices A and B in
this case are modiﬁed to
B =

H1
win
∗
H1
win + (H2
win)∗H2
win
A =

H1
wall
∗
H1
wall +

H2
wall
∗
H2
wall + Rzz
(7.60)
where Hi
win and Hi
wall (i = 1, 2) are matrices corresponding to the constant channels h1 and h2 between
the two transmit and the single receive antennas. The main attractive feature of the preﬁlter is that it
is a single time-invariant (over a transmission block) FIR ﬁlter that shortens both channels h1 and h2
simultaneously without excessive noise enhancement.
7.6.6
Preﬁltered M-BCJR equalizer
The algorithm as proposed in [38], is a reduced complexity version of the Bahl–Cocke–Jelinek–Raviv
(BCJR) forward–backward algorithm presented in Appendix 2.1, also elaborated in [39], where at
each trellis step, only the M active states associated with the highest metrics are retained. An improved
version of the M-BCJR algorithm was proposed in [40] based on a log domain implementation of the
BCJR algorithm and operates as follows [37].
The forward and backward recursions independently select trees of active nodes without restricting
one to be a subtree of the other. To form soft decisions at any time instant, we use all edges with at
least one active node.
Let L be the number of trellis steps; Y1Y2 . . . YL the received outputs; st the trellis state at time t; S
the number of trellis states and ut the input at time t. The quantity calculated by the algorithm is not
Pr (ut = u|Y1 . . . YL) as in BCJR, but an approximation, as detailed in what follows.
Using the channel observations and the channel description, calculate for each trellis step t the
quantities
γt(i, j) = Pr(st = j; Yt | st−1 = i)
(7.61)

SPACE–TIME CODED TDMA/OFDM RECONFIGURATION EFFICIENCY
359
The forward recursion (see Appendix 2.1)
1. For t = 0 (initialization) α0(0) = 1, α0(i) = 0 for i = 1 . . . S.
2. For t = 1, . . . , L −1
– αt(i) = 
j αt−1( j)γt(i, j)
– Let At denote the M largest αs at time t. Any sorting algorithm can be used to construct At.
Set αt(i) = 0 if αt(i) /∈At.
The backward recursion
1. For t = L (initialization) βL(0) = 1, βL(i) = 0 for i = 1 . . . S.
2. For t = L −1, . . . , 1
– βt(i) = 
j βt+1( j)γt+1(i, j)
– Let Bt denote the M largest βs at time t. Any sorting algorithm can be used to construct Bt.
Set βt(i) = 0 if βt(i) /∈Bt.
The probabilities of error Eα and Eβ (in the sense that the correct state is not included in the M
selected states) can be calculated as follows:
Eα = Q
,
|h(0)|2d2
min
2σ 2
z

;
Eβ = Q
,
|h(v)|2d2
min
2σ 2
z

(7.62)
where Q(·) is the standard Q function, dmin the minimum Euclidean distance between any two
constellation points and σ 2
z the noise variance.
7.6.7
Decision
To make a decision at step 0 < t < L on the input ut = u, do the following:
1. Set P(ut = u) = 0.
2. For all edges (i, j) that have input u
– if βt( j) ̸= 0 and αt−1(i) ̸= 0, then P(ut = u)+ = αt−1(i)γ (i, j)βt( j);
– if βt( j) ̸= 0 and αt−1(i) = 0, then P(ut = u)+ = Eαγ (i, j)βt( j);
– if βt( j) = 0 and αt−1(i) ̸= 0, then P(ut = u)+ = αt−1(i)γ (i, j)Eβ.
The performance of the M-BCJR equalizer/decoder is further improved, especially for small M,
by using the preﬁlter of the previous subsection to concentrate the channel energy in a smaller number
of taps. In fact, two different preﬁlters should be used for the forward and backward recursions since
the forward recursion favors a close to minimum phase channel, whereas the backward recursion
favors a close to maximum phase channel [40]. The value of M and the number of preﬁlter taps can
be jointly optimized to achieve the best performance complexity tradeoffs.
7.6.8
Preﬁltered MLSE/DDFSE equalizer complexity
To evaluate reconﬁguration efﬁciency we need to estimate the complexity of the algorithm. For a size
2b signal constellation, ni transmit antennas and MIMO channel memory of v, the MIMO MLSE
equalizer has 2bni v states in general. The number of equalizer states can be reduced by using the
STTC trellis structure as shown in [41] or by a MIMO channel-shortening preﬁlter [42]. However,
this complexity is still too high for large signal constellations, even for two transmit antennas and
short-to-moderate MIMO channel memory. For example, for an 8PSK constellation and the EDGE
TU channel (where V = 3), the number of full MLSE equalizer states is equal to 86 = 262 144 states.

360
OFDM AND MULTICARRIER CDMA
7.6.9
Delayed decision feedback sequence estimation (DDFSE)
In order to reduce complexity, DDFSE, as discussed in Chapter 6, was introduced in [43]. This is
a hybrid scheme between MLSE and decision feedback equalization (DFE) for channels with long
memory. Basically, the CIR is divided into a leading part and a tail. Then, an MLSE equalizer is
constructed based on the leading part, and the interfering effect of the CIR tail is canceled by feedback
using previous (hard) decisions (assumed correct).
At time k, the branch metric ξ(k) of the DDFSE equalizer/decoder is given by
ξ(k) =
y(k) −
n

i=0
hSTTC
eqv (i)x(k −i) −
v+1

i=n+1
hSTTC
eqv (i)ˆx(k −i)

2
(7.63)
where
y(k)
is the kth received symbol;
n
is the design parameter (0 ≤n ≤v) that determines the number of DDFSE trellis states;
hSTTC
eqv
is the impulse response vector of the equivalent channel;
x(k)
are all possible input symbols according to different transitions along the path history;
ˆx(k)
are the previous hard symbol decisions along the path history.
7.6.10
Equalization schemes for STBC
The focus is on the case of two transmit antennas where full-rate Alamouti-type space–time block
codes can be constructed for any signal constellation.
7.6.10.1
Time-reversal space–time block coding (TR-STBC)
TR-STBC was introduced in [44] as an extension of the Alamouti STBC scheme to frequency selective
channels by imposing the Alamouti orthogonal structure at a block, not symbol, level, as in the ﬂat
fading channel case. More speciﬁcally, the transmitted blocks from antennas one and two at time
(k + 1) (which were denoted by x(k+1)
1
and x(k+1)
2
, respectively) are generated by the encoding rule
(for k = 0, 2, 4, . . .)
x(k+1)
1
= −J¯x(k)
2 ;
x(k+1)
2
= J¯x(k)
1
(7.64)
where J is the time reversal matrix that consists of ones on the main antidiagonal and zeros everywhere
else. To eliminate inter-block interference (IBI) between adjacent blocks due to channel memory,
length-v all-zero guard sequences are inserted between information blocks.
The TR-STBC receiver in Figure 7.26 employs linear combining techniques (a spatio-temporal
matched ﬁlter) to eliminate the mutual interference effects between the two transmit antennas while
RF
Front end
A/D
SISO
equalizer
SISO
equalizer
Linear
combiner
(.)
(.)
x1
(k)
x2
(k)
y(k)
y(k+1)
Figure 7.26 TR-STBC receiver block diagram. The operations (¯·) and (˜·) denote complex
conjugation and time reversal, respectively [37].

SPACE–TIME CODED TDMA/OFDM RECONFIGURATION EFFICIENCY
361
RF
Front end
A/D
MMSE
FDE
Linear
combiner
X2
(k)
y(k+1)
FFT
Slicer
X1
(k)
y(k)
Figure 7.27 OFDM-STBC receiver block diagram [37].
still achieving the maximum diversity gain of ∥h1∥2 + ∥h2∥2 (where ∥· ∥denotes the norm of a
vector).
TR-STBC uses a combination of complex conjugation, time reversal, and matched ﬁltering opera-
tions, as described in detail in [29], to convert the two-input single-output channel to two single-input
single-output (SISO) channels, each with an equivalent impulse response given by
hTR−STBC
eqv
(D) = h1(D)¯h1( ¯D−1) + h2(D)¯h2( ¯D−1)
(7.65)
to which standard SISO equalization schemes can be applied. In Equation (7.65), hi(D) is the D-
transform of hi(k), and ¯hi( ¯D−1) is the D-transform of hi(−k) for i = 1, 2. A whitened matched ﬁlter
(WMF) front end can be used to convert hTR−STBC
eqv
(D) to its minimum phase equivalent followed
by trellis or feedback equalization, as will be further discussed later in the section . TR-STBC
assumes that the two channels h1(D) and h2(D) are ﬁxed over two consecutive transmission blocks
and perfectly known at the receiver. In the next two subsections, we describe two alternative STBC
joint equalization/decoding schemes that use frequency domain processing.
7.6.10.2
OFDM-STBC
In this case at the receiver end in Figure 7.27, received blocks are processed in pairs where their
FFTs are computed and linearly combined. Finally, gain and phase adjustment is performed using
minimum mean square error frequency domain equalization (MMSE-FDE) with a single complex tap
for each subchannel, followed by a decision device. While the use of the Alamouti STBC modiﬁes the
channel frequency gain at subchannel i from |H(i)|2 to |H1(i)|2 + |H2(i)|2, which provides increased
immunity against fading, decision errors occurring at any subchannel result in an irreducible error
ﬂoor.
OFDM has two main drawbacks, namely, a high peak to average ratio (PAR), which results in
larger backoff with non-linear ampliﬁers, and high sensitivity to frequency errors and phase noise [45].
An alternative equalization scheme that overcomes these two drawbacks of OFDM while retaining
its reduced implementation complexity advantage (due to the use of FFT) is the single-carrier (SC)
FDE [46], which has been extended to receive diversity systems in [47] and to Alamouti-type STBC
transmit diversity systems in [48], and is described next.
These schemes can be extended to more than two transmit antennas using the theory of orthogonal
designs presented in Chapter 4.
7.6.11
Single-carrier frequency domain equalized space–time
block coding SC FDE STBC
The SC FDE, shown in Figure 7.28, is distinct from OFDM in that the IFFT block is moved to the
receiver end and placed before the decision device. As noted in [46], this causes the effects of deep

362
OFDM AND MULTICARRIER CDMA
A/D
Discard
CP
MMSE
FDE
Linear
combiner
y(k+1)
FFT
IFFT
x2
(k) x1
(k)
y(k)
Slicer
Y(k+1)
Y(k)
Figure 7.28 FDE-STBC receiver block diagram.
nulls in the channel frequency response to be spread out, by the IFFT operation, over all symbols,
thus reducing their effect and improving performance.
7.6.11.1
Encoder
Denote the nth symbol of the kth transmitted block (of length N) from antenna i by x(k)
i (n). Then, the
FDE-STBC encoding rule is given by [48]:
x(k+1)
1
(n) = −¯x(k)
2 ((−n)N)
x(k+1)
2
(n) = −¯x(k)
1 ((−n)N)
(7.66)
for n = 0, 1, . . . , N −1 and k = 0, 2, 4, . . .
where (·)N denotes the modulo-N operation that distinguishes this encoding scheme from TR-STBC,
Equation (7.64). In addition, a cyclic preﬁx (CP) is added to each transmitted block to eliminate
IBI and make the two channel matrices circulant. Taking the discrete Fourier 66 transform (DFT) of
Equation (7.66), we see
X(k+1)
1
(m) = −¯X(k)
2 ;
X(k+1)
2
(m) = −¯X(k)
1
for m = 0, 1, . . . , N −1 and k = 0, 2, 4, . . .
(7.67)
which reveals that this is also a block-level implementation of the symbol-level Alamouti encoding
rule.
7.6.11.2
Receiver
After analog-to-digital (A/D) conversion, the CP part of each received block is discarded. Mathemat-
ically, we can express the input–output relationship over the jth received block as
y( j) = H( j)
1 x( j)
1 + H( j)
2 x( j)
2 + z( j)
(7.68)
where H( j)
1
and H( j)
2
are N × N circulant matrices whose ﬁrst columns are equal to h( j)
1
and h( j)
2 ,
respectively, appended by (N −v −1) zeros and z( j) is the noise vector. Since H( j)
1
and H( j)
2
are
circulant matrices, they admit the eigendecompositions
H( j)
1
= Q∗( j)
1 Q;
H( j)
2
= Q∗( j)
2 Q
(7.69)
where Q is the orthonormal FFT matrix and ( j)
1 (respectively ( j)
2 ) is a diagonal matrix whose (n, n)
entry is equal to the nth FFT coefﬁcient of h( j)
1
(resp. h( j)
2 ). Therefore, applying the FFT to y( j), we

SPACE–TIME CODED TDMA/OFDM RECONFIGURATION EFFICIENCY
363
get (for j = k, k + 1)
Y( j) = Qy( j) = ( j)
1 X( j)
1 + ( j)
2 X( j)
2 + Z( j)
(7.70)
7.6.11.3
Processing
The length-N blocks at the FFT output are then processed in pairs, resulting in the two blocks (we
drop the time index from the channel matrices since they are assumed ﬁxed over the two blocks under
consideration):

Y(k)
¯Y(k+1)

(
)*
+
Y
=

1
2
¯2
−¯1

(
)*
+


X(k)
1
X(k)
2

( )* +
X
+

Z(k)
¯Z(k+1)

(
)*
+
Z
(7.71)
where X(k)
1 and X(k)
2 are the FFTs of the information blocks x(k)
1 and x(k)
2 , respectively, and Z is the noise
vector. To eliminate inter-antenna interference, the linear combiner ∗is applied to Y. Due to the
orthogonal Alamouti-like structure of , a second-order diversity gain is achieved. By Alamouti-like
we mean any 2 × 2 complex orthogonal matrix of the form

c1
c2
±¯c2
∓¯c1

Then, the two decoupled blocks at the output of the linear combiner are equalized separately, using the
MMSE-FDE [46], which consists of N complex taps per block that mitigate inter-symbol interference.
Finally, the MMSE-FDE output is transformed back to the time domain using the inverse FFT where
decisions are made. Note that the SC MMSE-FDE is equivalent to block MMSE linear equalization
[49]; hence, its performance can be improved at the expense of increased complexity by adding a
feedback section as discussed in [50].
7.6.11.4
Channel estimator
Formulate the channel estimation problem for the two-transmit one-receive scenario as in Chapter 4.
The analysis can be easily generalized to multiple transmit/receive antennas. Transmit two training
sequences s1 and s2 from the ﬁrst and second antennas simultaneously in synchronized data blocks,
where each block consists of N information symbols and Nt training symbols. For two transmit
antennas, the receiver uses the 2Nt known training symbols to estimate the 2(v + 1) unknown
channel coefﬁcients. The observed training sequence output, which does not have interference from
information or preamble symbols, can be expressed as
y =
-S1
S2
.  h1
h2

+ z = Sh + z
(7.72)
where the column vectors y and z are of size (Nt −v), S1, and S2, are Toeplitz matrices of size
(Nt −v) × (v + 1) that contain training symbols. The MMSE channel estimate assuming that S has
full column rank, is given by [51]:
ˆh =
 ˆh1
ˆh2

= (S∗S)−1S∗y
(7.73)
where (·)−1 denotes the inverse. The estimation error (mean square error) is given as
MSE = E
/
(h −ˆh)∗
h −ˆh
0
= σ 2
z tr((S∗S)−1)
(7.74)

364
OFDM AND MULTICARRIER CDMA
where we assume that white noise with variance σ 2
z and tr (·) denotes the trace of a matrix. The
channel estimation MMSE is equal to
MMSE = σ 2
z (v + 1)
(Nt −v)
(7.75)
which is achieved if and only if
S∗S =

S∗
1S1
S∗
2S1
S∗
1S2
S∗
2S2

= (Nt −v)Iv+1
(7.76)
where Iv+1 is the identity matrix of size v + 1. Two optimal training sequences that satisfy Equation
(7.76) have an impulse-like autocorrelation sequence and zero cross-correlation. In this case, comput-
ing the channel estimates using Equation (7.73) reduces to a simple crosscorrelation (matrix–vector
product).
7.6.11.5
Training sequences
For implementation purposes (to avoid non-linear ampliﬁer distortion), it is desirable to use training
sequences with constant amplitude. Optimal constant amplitude training sequences can be constructed
from a Pth root-of-unity alphabet Ap = {ei2π
k/P|k = 0, 1, . . . , P −1} (where i =
√
−1) without
constraining the alphabet size P. Such sequences are the perfect roots-of-unity sequences (PRUS),
which are also known as polyphase sequences. Chu [52] showed that for any training sequence length
Nt, there exists a PRUS with alphabet size P = 2Nt. In [53] and [54] the interested reader can ﬁnd
details on how to design PSK-type training sequences for dual-antenna transmissions with negligible
performance loss from PRUS.
7.6.11.6
Performance results
For the performance results generation signal and channel parameters as in [37] are used. An 8PSK
modulation with two transmit and one receive antennas on the TU EDGE channel is used. The overall
CIR length is effectively four symbol periods, i.e. v = 3.
In EDGE, fading can be safely assumed to be quasi-static, i.e. the CIR can be assumed constant
for the duration of a transmission block. This is due to the fact that the coherence time of the
channel at around 1 GHz carrier frequency is much larger than the block duration of 577 µs, even for
highway speeds. This eliminates the need for channel tracking at the receiver. In addition, assuming
ideal frequency hopping, the fading process is independent from block to block. The noise samples
are generated as independent samples of a zero mean complex Gaussian random variable with a
variance of 1/SNR per complex dimension. The reason for doubling the noise variance (compared
with the single transmit antenna case) is that with two-antenna transmissions, we assume that the
total transmitted power is the same as in the single antenna case and is divided equally between the
two antennas. The average energy of the symbols transmitted from each antenna is normalized to one
so that the signal to noise ratio is SNR. The results are shown in Figure 7.29.
For reconﬁguration efﬁciency, relations from Chapter 4 are applicable where values for D and g12
can be derived from results presented in Tables 7.12 and 7.13. For two conﬁgurations, g12 is obtained
as a difference of the corresponding entries in column 2 and Dr as a ratio of the corresponding
complexity numbers from column 3.
In summary, for STTCs, the preﬁltered M-BCJR equalizer/decoder outperforms the preﬁltered
DDFSE equalizer/decoder and has lower implementation complexity. For space–time block codes,
TR-STBC achieves the best performance among the three investigated schemes. OFDM-STBC has
the highest PAR and is the most sensitive to frequency errors but is also the most ﬂexible among
the three schemes in its support of multirate and multiQOS requirements. The three STBC schemes
suffer the same amount of overhead (in the form of an all zero guard sequence for TR-STBC and a
cyclic preﬁx guard sequence for FDE-STBC and OFDM-STBC).

SPACE–TIME CODED TDMA/OFDM RECONFIGURATION EFFICIENCY
365
9
14
24
10
−4
10
−3
10
−2
10
−1
10
0
SNR (dB)
Bit error rate
8 states  
16 states 
512 states
BCJR MAP  
(a)
Figure 7.29 (a) BER performance of two-transmit one-receive eight-state 8PSK STTC with
preﬁltered M-BCJR equalizer as a function of M (the number of active states).
BER of a 4096-state full BCJR-MAP equalizer is shown as a benchmark; (b)
BER performance of two-transmit one-receive eight-state 8PSK STTC with
preﬁltered 64-state DDFSE, preﬁltered 16-state M-BCJR, and full BCJR-
MAP equalizers; (c) BER performance of two-transmit one-receive eight-state
8PSK STTC with preﬁltered 16-state M-BCJR with perfect and estimated
CSI. Full BCJR-MAP equalizer performance shown as BER lower bound; (d)
BER performance of two-transmit one-receive OFDM-STBC, FDE-STBC,
and TR-STBC. For OFDM and FDE-STBC, a size 64 FFT is assumed. For
TR-STBC, an ideal whitened matched ﬁlter front end and a three-tap feed-
back ﬁlter are assumed; (e) effect of channel estimation on performance of
SC FDE-STBC; (f) BER performance of two-transmit one-receive TR-STBC
with 512-state full BCJR-MAP, eight-state M-BCJR, and SISO MMSE-DFE
with Nb = 3 feedback taps. An ideal whitened matched ﬁlter front end is
assumed.

366
OFDM AND MULTICARRIER CDMA
10
15
20
25
10
−4
10
−3
10
−2
10
−1
10
0
EDGE TU Channel, 2TX 1RX, 8 State 8 PSK STTC
SNR (dB)
Bit error rate
Prefiltered DDFSE (64 states, 32 taps) 
Prefiltered M BCJR (16 states, 8 taps) 
Full BCJR MAP (4096 states)            
(b)
10
15
20
25
10
−4
10
−3
10
−2
10
−1
10
0
EDGE TU Channel, 2TX 1RX, 8 State 8PSK STTC
SNR (dB)
Bit error rate
Prefiltered M BCJR (16 states) w/estimated CSI 
Prefiltered M BCJR (16 states) w/perfect CSI   
Full BCJR MAP (4096 states) w/perfect CSI      
(c)
Figure 7.29 (Cont.)

SPACE–TIME CODED TDMA/OFDM RECONFIGURATION EFFICIENCY
367
10
15
20
25
30
10
−4
10
−3
10
−2
10
−1
10
0
EDGE TU Channel, 8PSK Modulation
SNR (dB)
Bit error rate
(d)
5
10
15
20
25
10
−4
10
−3
10
−2
10
−1
10
0
EDGE TU Channel, 8PSK Modulation, N=64
Eb /N0 (dB)
BER
Estimated channel         
Perfect channel knowledge 
Training sequence are PRUS of length 26 
(e)
Figure 7.29 (Cont.)

368
OFDM AND MULTICARRIER CDMA
10
15
20
25
10
−4
10
−3
10
−2
10
−1
10
0
EDGE TU Channel, 2TX 1RX TR STBC
SNR (dB)
Bit error rate
MAP (512 states) 
 M BCJR (8 state)
SISO DFE (Nb=3)  
Ideal whitened matched filter assumed 
(f)
Figure 7.29 (Cont.)
Table 7.12
Performance and complexity comparison summary between the equaliza-
tion schemes for the eight-state 8PSK STTC over the TU EDGE channel
Equalization scheme
SNR (dB) at BER = 10−3
Receiver complexity (per block)
Full BCJR-MAP
21.3
4096 states (each direction)
Preﬁltered M-BCJR
23.1
16 states (each direction) 8-tap
preﬁlter (each direction)
Preﬁltered DDFSE
23.6
64 states and 32-tap preﬁlter
Table 7.13
Performance and complexity comparison summary between the Alamouti-
type STBC equalization schemes over the TU EDGE channel, assuming
8PSK modulation and block size of 64
Equalization scheme
SNR (dB) at BER = 10−3
Receiver complexity (per block)
Full BCJR-MAP
21.3
512 states (each direction) and
20-tap WMF
TR-STBC
22.2
20-tap WMF and 3 feedback taps
FDE-STBC
24.2
Size 64 FFT/IFFT and 64-tap FDE
OFDM-STBC
26.5
Size 64 FFT and 64-tap FDE

MULTICARRIER CDMA SYSTEM
369
7.7
MULTICARRIER CDMA SYSTEM
In Chapter 1 we discussed a variety of different structures for MC CDMA at the introductory level. In
a number of the following sections we will provide more in-depth discussion on the performance of
these systems. In the system shown in Figure 7.30 [55, 56] the MC-CDMA BPSK signal transmitted
by the kth user is:
sk(t) = Re
1 +∞

n=−∞
uk[n]h(t −nTc −τk)
L−1

l=0
e j(ωlt+ψk,l)
2
(7.77)
where
uk[n] = AC pk[n] + BCdk[n]dk[n]
(7.78)
A and B are the signal amplitudes of the pilot and the data channel respectively, dk[n] is binary data,
h(i) is the impulse response of the chip wave-shaping ﬁlter, ωl and ψk,l are the carrier frequency and
carrier phase of the lth subcarrier, respectively, and L is the number of subcarriers.
The signal is transmitted through a fading channel. The bandwidth of the subcarriers in this
section are selected such that each subcarrier experiences independent, slowly varying, ﬂat Rayleigh
fading. Assuming perfect average power control, the received signal is given by
r(t) = Re
1K−1

k=0
+∞

n=−∞
uk[n]h(t −nTc −τk)
L−1

l=0
αk,le j(ωlt+θk,l)
2
+ nw(t)
(7.79)
where K is the total number of users, τk is the relative time delay of user k, αk,l and θk,1 are the
fading amplitude and phase, respectively, of the lth path for the kth user, and nw(t) is zero mean
white Gaussian noise with two-sided spectral density η0/2.
The channel estimator based on a pilot signal is shown in Figure 7.31. Assuming
X( f ) ≡|H( f )|2 =



1
W ,
−W
2 < f < W
2
0,
otherwise
(7.80)
W = 1
Tc
F−1|H( f )|2 ≡x(t)
and
 +∞
−∞
|H( f )|2d f ≡1
the lth complex channel estimate is given by
Wl = α0,le jθ0,l ANI + Ip,l + Np,l
(7.81)
Pilot channel
all 1s
Data channel
dk[n]
Cpk[n]
Cdk[n]
A
B
I.M
h(t)
H(f)
)
(
0
0
ψ
ω
+
t
je
)
(
1
1
−
−+
L
L t
je
ψ
ω
Σ
Re
Impulse
modulator
Pilot channel
Data channel
dk
]
Cpk
]
Cdk
]
A
B
I.M
h(t)
H(f)
)
(
0
0
ψ
ω
+
t
je
)
(
1
1
−
−+
L
L t
je
ψ
ω
Σ
Re
Impulse
Figure 7.30 The complex transmitter block diagram [55].

370
OFDM AND MULTICARRIER CDMA
r(t)
H* ( f – f0 )
+ H* ( f + f0 )
H* ( f – fL - 1 )
+ H* ( f + fL - 1 )
LPF
LPF
−
=
1
0
1
N
n
−
=
1
0
1
N
n
t = nTc
t = nTc
Cp0[n]
Cp0[n]
n = N1 −1
n = N1 −1
W0
WL −1
t
j
e
0
ω
−
t
j
L
e
1
−
−ω
r(t)
H* ( f – f0 )
+ H* ( f + f0 )
H* ( f – fL - 1 )
+ H* ( f + fL - 1 )
LPF
LPF
Σ
−
=
1
0
1
N
n
Σ
−
=
1
0
1
N
n
t = nT
t = nT
Cp0[n]
Cp0[n]
n = N1
1
n = N1
1
W0
WL
1
t
j
e
0
ω
−
t
j
L
e
1
−
−ω
Figure 7.31 The complex channel estimator block diagram [55].
r(t)
H* ( f – f0 )
+ H* ( f + f0 )
H* ( f – fL - 1 )
+ H* ( f + fL - 1 )
LPF
LPF
−
=
1
0
N
n
−
=
1
0
N
n
t = nTc
t = nTc
Cd0[n]
Cd0[n]
t
j
e
0
ω
−
t
j
L
e
1
−
−ω
Y0
YL -1
*
0
W
*
1
−
L
W
Σ
Y
r(t)
H* ( f – f0 )
+ H* ( f + f0 )
H* ( f – fL - 1 )
+ H* ( f + fL - 1 )
LPF
LPF
Σ
−
=
1
0
N
n
Σ
−
=
1
0
N
n
t = nT
t = nT
Cd0[n]
Cd0[n]
t
j
e
0
ω
−
t
j
L
e
1
−
−ω
Y0
YL -1
*
0
W
*
1
−
L
W
Σ
Y
Figure 7.32 The complex data demodulation block diagram.
We have used the fact that the spreading sequences C pk[n] and Cdk[n] are orthogonal in an estimation
interval.
7.7.1
Data demodulation
Each subcarrier of the received signal is chip-matched ﬁltered, demodulated, despread by the cor-
responding data spreading sequence, and then integrated over the bit interval of N chips (see Fig-
ure 7.32). The lth demodulator output before combining is
Yl = α0,le jθ0,l Bd[0]N + Ip,l + Nd,l
(7.82)
where the interference term is
Id,l =
N−1

n=0
Cd0[n]Rn
(7.83)
and the noise term is
Nd,l =
N−1

n=0
[nw(t) ∗h∗(t)]t=nTc · Cd0[n]
(7.84)
The combined signal is given by
Y =
L−1

l=0
W ∗
l Yl
(7.85)

MULTICARRIER DS-CDMA BROADCAST SYSTEMS
371
and the ﬁnal decision statistic is
Z = Re{Y} =
L−1

l=0
- 1
2 W ∗
l Yl + 1
2 WlY ∗
l
.
(7.86)
Bit error rate analysis for such a system can be found in [55].
7.7.2
Performance examples
In this example the signal parameters are the same as in [55]. The bandwidth of each subcarrier is
ﬁxed to be the coherence bandwidth of the channel. The total bandwidth is proportional to the number
of subcarriers. To make the comparison between different bandwidths, the total transmit power is kept
constant, that is, decreasing the transmit power per subcarrier as the number of subcarriers increases.
Traditionally, assuming perfect channel estimation, the probability of error improves monotonically
with the number of subcarriers [56]. However, when there is estimation error, the situation is different.
The probability of error is plotted against the number of subcarriers L in Figure 7.33(a) with
ten total users, the estimation interval Ni equaling 64 chips, and Eb/η0 of 4, 7, 10 and 13 dB. A
processing gain of 64 is used, and there is equal power in the pilot and the data channel. As the
number of subcarriers increases, the bit error rate ﬁrst improves and then degrades. The increasing
L helps performance by introducing diversity gain. At the same time, as L goes up, the transmit
energy-per-band goes down; this causes more estimation error, and in turn, results in performance
degradation. Thus, an optimal value of L exists. When we increase the Eb/η0, the optimal L becomes
larger, because the higher signal to noise ratio reduces the degradation due to the estimation error.
Some additional results are shown in Figures 7.33 (b) and (c).
7.8
MULTICARRIER DS-CDMA BROADCAST SYSTEMS
As pointed out in Chapter 1, multicarrier direct sequence code division multiple access (DS-CDMA)
systems can be classiﬁed into two categories: those with overlapping bandwidths [57, 58] and those
with disjoint bandwidths [56]. In this section, the non-overlapping bandwidth system is considered,
employed in the forward link (base-to-mobile link) of a cellular system, wherein all user signals are
synchronous. Using this type of multicarrier DS-CDMA to generate a wideband CDMA waveform,
in particular by choosing the bandwidth of a subcarrier equal to that of a narrowband CDMA wave-
form, we can achieve some degree of compatibility between wideband (e.g. UMTS/WCDMA) and
narrowband (e.g. UMTS/cdma2000) CDMA systems. The spectra of single-carrier and multicarrier
CDMA are shown in Figures 7.34(a) and (b), respectively.
A base station transmitter using a multicarrier DS-CDMA system is shown in Figure 7.35. The
transmitted signal is given by
s(t) = Re
 M

m=1
Sm(t)
√
2e j(ωmt+θm)

(7.87)
Sm(t) is given by
Sm(t) =
K

k=1

Ec
+∞

n=−∞
d(k)
v c(k)
n e jφk,mh(t −nTc)
(7.88)
where d(k)
v
and c(k)
n are the data and the spreading sequences of the kth user, respectively, v = ⌊n/N⌋
where ⌊x⌋is the largest integer less than or equal to x and N is the number of chips of the spreading
sequence per data bit), h(t) is the impulse response of the chip wave-shaping ﬁlter, φk,m is a carrier
phase randomly chosen by a base station for the mth subchannel of the kth user, and 1/Tc is the
chip rate. Both θm and φk,m are uniformly distributed over [0, 2 π). The energy per data bit is
deﬁned as Eb ≡EcNM. Note that the need for φk,m to be random for different users and different

1
10
10−5
10−4
10−3
10−2
10−1
Number of subcarriers (L) /BW expansion
Pe
10 total users, Ni = 4×64, Eb /N0 = 4, 7, 10, 13 dB
13 dB
10 dB
7 dB
4 dB
Theoretical
Simulation
1
10
=
,
13 dB
10 dB
7 dB
4 dB
n
(a)
1
10
10−3
10−2
10−1
Number of subcarriers (L)/BW expansion
Pe
Eb / N0 = 10 dB, 5 users, N = 64, Ni = N, 2N, 3N, 4N
Ni = 4N
Ni = 3N
Ni = 2N
Ni = N
Theoretical
Simulation
1
10
, 2
, 4
= 4
= 3
= 2
(b)
Figure 7.33 (a) Probability of error versus number of subcarriers for varying Eb/η0; (b)
probability of error versus number of subcarriers for different estimation inter-
vals; (c) probability of error versus number of subcarriers for different numbers
of users.

1
10
10−3
10−2
10−1
Number of subcarriers (L)/BW expansion
Pe
K = 5
K = 10
K = 15
K = 20
Theoretical
Simulation
K = 30
K = 60
10
Eb/N0 = 13 dB, N = 64, Ni =N, Users = 5, 10, 15, 20, 30, 60
5
10
15
20
30
60
(c)
Figure 7.33 (Cont.).
PG = N1
PG: Processing gain
(a)
PG = N
PG = N
PG = N
PG = N
PG = NH
PG = NH
PG = NH
PG = NH
N = N1/M, where M (= 4) is the number of subchannels
(b)
Data stream #1
Data stream #2
There are R (=2) data streams and NH = N1/H, where H (M/R)
is the number of subchannels per data stream
(c)
PG
1
PG: Processing
(a)
PG
PG
PG
PG
1
) i
r o
(b)
Data stream #1
Data stream #2
=2
, where
(c)
Figure 7.34 Spectra of (a) single-carrier CDMA; (b) multicarrier CDMA; and (c) hybrid
multicarrier CDMA/FDM.
)
(
]
/
[
k
k
n
d
m
k
j
k
n e
c
,
)
(
φ
I. M.
h(t)
H(f)
Σ
Σ
Re(*).
Σ
Σ
)
(
2
m
mt
je
θ
ω
+
s(t)
I.M.: Impulse modulator
Other user baseband signals
Other carriers modulated by
the sum of baseband signals
. . . . . . .
. . . . . . .
. . . . . . .
. . . . . . .
)
(
]
/
[
k
k
n
d
m
k
j
k
n e
c
,
)
(
φ
I. M.
h(t)
H(f)
Σ
Σ
Re(*).
Σ
Σ
)
(
2
m
mt
je
θ
ω
+
s(t)
I.M.
Other user baseband signals
Other carriers modulated by
the sum of baseband signals
. . . . . . .
. . . . . . .
. . . . . . .
. . . . . . .
Figure 7.35 Block diagram of a multicarrier CDMA base station transmitter.

374
OFDM AND MULTICARRIER CDMA
subchannels is to obtain a proper processing gain in the multicarrier system. The reason for this is
as follows. A multicarrier system is known to provide an effective processing gain of MN [59] for
an asynchronous communication link, where the carrier phase difference between different users’
signals can be assumed to be random, and the phases of any given user are uncorrelated in different
subchannels. Therefore, coherent combining of the despread signals from M correlators increases the
processing gain by M times that obtained by despreading the signals in each subchannel. However,
for the forward link, without the φk,m, the interference components of the M correlator outputs are
also combined coherently, and consequently, there is no increased processing gain achieved by the
coherent combining of the M correlator outputs, only a diversity gain. With the random φk,m, it is
possible for the receivers to demodulate the data coherently by using a common pilot signal from a
base station if each receiver is provided the values of the φk,m by the base station when it establishes
a communication link.
It is assumed that c(k)
n = anb(k)
n , where an is a random sequence commonly used by all users and
b(k)
n is a member of either an orthogonal or a quasi-orthogonal code set assigned to the kth user. We
also have
E
3
c(k)
n c(k′)
n+i
4
= 0
for i ̸= 0
(7.89)
for all k and k′. It is also assumed that the b(k)
n satisfy the following relationship for all k:
1
K −1
k

k′=1
k′̸=k
N−1

n=0
b(k)
n b(k′)
n
2
= (1 −q)N
(7.90)
where q is a measure of the orthogonality of the set of quasi-orthogonal codes. The quasi-orthogonal
codes with these characteristics are standardized [60].
Further, we assume that the channel is a slowly varying frequency selective Rayleigh fading
channel and is modeled as a ﬁnite length tapped delay line. The complex low-pass equivalent response
for the mth subchannel is given by
cm(t) =
L−1

i=0
αm,ie jβm,i δ(t −iTc)
(7.91)
where L is the number of resolvable paths, αm,i are independent but not necessarily identically
distributed Rayleigh random variables, and the βm,i are independently, identically distributed (i.i.d.),
uniform random variables over [0, 2π). A unit energy constraint is assumed, i.e. L−1
i=0 E{α2
m,i} = 1.
Then, for a constant multipath intensity proﬁle (MIP), the second moment of each path of a subchannel
is given by E{α2
m,i} = 1/L. For an exponential MIP, the second moments are assumed to be related
to the second moment of the initial path strength by E{α2
m,i} = E{α2
m,0} exp(−ri), where r is the MIP
decay factor. For comparison of the performance of single-carrier and multicarrier systems, we use
the facts that r = Mr1 and L = L1/M, where r1 and L1 are the MIP decay factor and the number of
resolvable paths, respectively, for the single-carrier system [61].
Since all signals that arrive from the base station at a given mobile unit propagate over the same
path, they all fade in unison. The received signal at the desired mobile unit is then given by
r(t) = Re[Rc(t)] + n(t)
(7.92)
where Rc(t) is the complex representation of the received signal given by:
Rc(t) =
M

m=1
L−1

i=0
αm,i Sm(t −iTc)
√
2e j(ωmt+θ′
m,i )
(7.93)
n(t) is additive white Gaussian noise (AWGN) with a two-sided power spectral density of η0/2, and
θ ′
m,i = θm + βm,i. The corresponding expression for the single-carrier system is obtained by setting
M = 1 and L equal to L1.
The receiver of the desired user (k = 1) is shown in Figure 7.36, where a RAKE receiver in each
subchannel, and perfect phase recovery of each carrier from the pilot signal detector is assumed [59].

FRAME BY FRAME ADAPTIVE RATE CODED MULTICARRIER DS-CDMA SYSTEM
375
H* ( f – f1 )
+ H* ( f + f1 )
H* ( f – fM )
+ H* ( f + fM )
r(t)
y1(t)
yM(t)
RAKE receiver for
1st sub-channel
RAKE receiver for
Mth sub-channel
Σ
Σ
Z
.….
.….
.….
y1(t)
ym(t)
t
j
m
e
ω
−
2
LPF
'
1
, −
−
L
m
j
e
θ
Tc
'
2
, −
−
L
m
j
e
θ
Tc
…
Tc
'
0
,
m
j
e
θ
−
n´Tc
n´Tc
n´Tc
m
j
m
n
e
c
,1
)
,1
(
φ
−
′
m
j
m
n
e
c
,1
)
,1
(
φ
−
′
Ym, L-2[n´]
Ym, L-1[n´]
m
j
m
n
e
c
,1
)
,1
(
φ
−
′
Ym, 0 [n´]
Re(•).
Re(•).
…
…
…
Re(•).
−
=
′
1
0
N
n
−
=
′
1
0
N
n
−
=
′
1
0
N
n
8m, L-1
8m, L-2
8m, 0
Σ
Σ
Zm
Zm, 0
Zm, L-2
Zm, L-1
L taps
H* ( f – f1 )
+ H* ( f + f1 )
H* ( f – fM )
+ H* ( f + fM )
r(t)
y1(t)
yM(t)
RAKE receiver for
1 subchannel
RAKE receiver for
M subchannel
Σ
Σ
Z
.….
.….
.….
y1(t)
ym(t)
t
j
m
e
ω
−
2
LPF
'
1
, −
−
L
m
j
e
θ
Tc
'
2
, −
−
L
m
j
e
θ
Tc
…
Tc
'
0
,
m
j
e
θ
−
n´T
n´T
n´T
m
j
m
n
e
c
,1
)
,1
(
φ
−
′
m
j
m
n
e
c
,1
)
,1
(
φ
−
′
Ym, L-2[n´]
Ym, L-1[n´]
m
j
m
n
e
c
,1
)
,1
(
φ
−
′
Ym, 0 [n´]
Re(•).
Re(•).
…
…
…
Re(•).
−
=
′
1
0
N
n
Σ
−
=
′
1
0
N
n
Σ
−
=
′
1
0
N
n
8m, L-1
8m, L-2
8m, 0
Σ
Σ
Zm
Zm, 0
Zm, L-2
Zm, L-1
L taps
(a)
(b)
Σ
Figure 7.36 Block diagrams of (a) a multicarrier CDMA receiver and (b) a RAKE receiver
of the mth subchannel for the ﬁrst user.
The chip wave-shaping ﬁlter given in [59] is assumed, where X( f ) ≡|H( f )|2 is a raised cosine ﬁlter.
The DS waveforms do not overlap and therefore, adjacent channel interference may be ignored.
Each data stream modulates H(= M/R) disjoint carriers, and the number of chips of the spread-
ing sequence per data bit is N1/H. To make a fair comparison of the performance, given a ﬁxed
information rate and total bandwidth, the relationship HRL = ML = L1 must be satisﬁed. Bit error
rate analysis for such a system can be found in [62] and some results are shown in Figure 7.37.
7.9
FRAME BY FRAME ADAPTIVE RATE CODED MULTICARRIER
DS-CDMA SYSTEM
In this section we discuss an adaptive rate convolutionally coded multicarrier direct sequence code
division multiple access (DS-CDMA) system. In order to accommodate a number of coding rates
easily and make the encoder and decoder structure simple, the rate compatible punctured convolutional
(RCPC) code discussed in Chapter 2 is used. We choose the coding rate that has the highest data
throughput in the signal to interference and noise ratio (SINR) sense. To achieve maximum data
throughput, a rate adaptive system is used, based on the channel state information (the signal to
interference to noise ratio, SINR, estimate). The SINR estimate is obtained by the soft decision Viterbi
decoding metric. It will be demonstrated that the rate adaptive convolutionally coded multicarrier
DS-CDMA system can enhance spectral efﬁciency and provide frequency diversity.

376
OFDM AND MULTICARRIER CDMA
4
6
8
10
12
14
16
18
20
Eb / h0 (dB)
10−5
10−4
10−3
10−2
10−1
100
Probability of  bit error
N1 = 256, K = 60, q = 1, L1 = ML = 8
M = 1
M = 4
r1 =0
r1 = 1
r1 = 2
4
6
8
10
12
14
16
1
0
/
1 =
0,
1,
1
(a)
4
6
8
10
12
14
16
18
20
Eb / h0 (dB)
10−5
10−4
10−3
10−2
10−1
100
Probability of bit error
N1 = 256, K = 120, r1 = 0
M = 1, L = 8, q = 1
M = 4, L = 2, q = 0.5, MRC
M = 4, L = 2, q = 0.5, OC
H = 2, R = 2, L = 2, q = 1
H = 1, R = 4, L = 2, q = 1
2
1
rr
1 =
=
1
2,
0.
(b)
Figure 7.37 (a) Performance of a single-carrier and a multicarrier CDMA system in mul-
tipath fading channel when both systems employ an orthogonal code set; (b)
performance comparison of a single-carrier CDMA, a multicarrier CDMA
and a hybrid multicarrier CDMA/FDM system for K = 120 in a multipath
fading channel with a constant MIP; (c) probability of bit error versus K for
Eb/η0 = 15 (decibels).

FRAME BY FRAME ADAPTIVE RATE CODED MULTICARRIER DS-CDMA SYSTEM
377
0
50
100
150
200
K
10−6
10−5
10−4
10−3
10−2
10−1
Probability of bit error
N1 = 256
Eb / h0 = 15 dB,
r1 = 0
M = 1, L = 8, q = 1
M = 4, L = 2, q = 1
M = 4, L = 2, q = 0.5, MRC
M = 4, L = 2, q = 0.25, MRC
H = 2, R = 2, L = 2, q = 1
H = 1, R = 4, L = 2, q = 1
0
50
100
15
00
r
1 = 256
/
0 = 15 dB,
1 = 0
1,
8,
1
4,
2,
1
4,
2,
0.5, MRC
4,
2,
0.25, MRC
2,
2,
2,
1
1,
4,
2,
1
(c)
Figure 7.37 (Cont.).
f1
f2
f3
fM
…
…
∆f = 1/Tc
f
f1
f2
f3
fM
…
…
∆f = 1/T
f
Figure 7.38 A typical CC-OM power spectral density.
7.9.1
Transmitter
The power spectral density of a convolutionally coded orthogonal multicarrier (CC-OM) signal and
the transmitter for the rate adaptive CC-OM DS-CDMA system considered in this section are shown
in Figure 7.38 and Figure 7.39 respectively. For user k, the (information) bits {bi
k}, each with duration
Tb, are encoded by the RCPC encoder of rate r. The relationship between Tb and the duration Ts of a
coded binary symbol can be written as
Ts = r MTb
(7.94)
where M is the number of subchannels. The M coded binary symbols are allocated to M subchannels
to get frequency diversity. They are interleaved to get time diversity as well as frequency diversity, and
are spread by each user’s pseudonoise (PN) signature waveform ck(t) with chip duration Tc = Ts/N,
where N is the processing gain of the DS narrowband waveforms modulated by subcarriers. For CC-
OM systems, we have M = (2BT/BS) −1, where BT and BS are the total and subchannel bandwidths,
respectively. Since we ﬁx the subchannel bandwidth BS (or equivalently, the symbol duration Ts) in
this section, Tb varies according to Equation (7.94) when the code rate r changes.

378
OFDM AND MULTICARRIER CDMA
RCPC
Encoder
(Rate r)
Rate Decision
using estimated
SINR
Interleaver
Interleaver
Pilot Symbols and
Rate Information
Pilot Symbols and
Rate Information
MUX
MUX
Σ
Σ
Sk(t)
Feedback from
the receiver
Transmitter
RCPC encoder
Information
i
kb
j
kx 1,
j
M
kx ,
ck(t)
ck(t)
)
cos(
2
1,
1
k
t
P
ϕ
ω +
)
cos(
2
,M
k
Mt
P
ϕ
ω
+
…
…
…
RCPC
encoder
(Rate r)
Rate decision
using estimated
SINR
Interleaver
Interleaver
Pilot symbols and
rate information
Pilot symbols and
rate information
MUX
MUX
Σ
Σ
Sk(t)
r
Transmitter
RCPC encoder
Information
i
kb
j
kx 1,
j
M
kx ,
ck(t)
ck(t)
)
cos(
2
1,
1
k
t
P
ϕ
ω +
)
cos(
2
,M
k
Mt
P
ϕ
ω
+
…
…
…
Figure 7.39 The transmitter model for user k in the adaptive rate CC-OM DS-CDMA
system.
The transmitted signal sk(t) of user k can be written as
sk(t) =
√
2P
∞

j=−∞
M

m=1
x j
k,mck(t −jTs) cos(ωmt + ϕk,m)
(7.95)
The channel is assumed to be frequency selective Rayleigh fading and not to vary during one
symbol duration. However, the subchannels are assumed to be non-selective by choosing the number
of subcarriers appropriately as [56]:
MTc ≥T
(7.96)
where T is the maximum delay spread of the channel. Then the complex low-pass impulse response
of the subchannels of user k can be modeled as
hk,m(t) = αk,me jβk,mδ(t)
(7.97)
where αk,m is the fading amplitude and βk,m is the random phase of the mth subchannel, m =
1, 2, . . . , M. The phases {βk,m} are i.i.d. uniform random variables on [0, 2π). In general, the fading
amplitudes {αk,m} are correlated, but we can assume that they are i.i.d. Rayleigh random variables
once the coded symbols are properly interleaved in the time domain.
Frame by frame transmission is assumed. Such a frame by frame transmission is typical of many
cellular systems. The frame discussed in this section is shown in Figure 7.40. Each frame of duration
Tf consists of a header of duration Tp and data symbols of duration Td. We have Td = NsTs and
Tp = NpTs, where Ns is the number of data symbols and Np is normally 6–10. The header contains
pilot symbols and information on the rate and channel state. The function of the MUX in Figure 7.39
is to combine the header and data symbols to make frames as shown in Figure 7.40.
7.9.2
Receiver
The receiver for the adaptive rate CC-OM DS-CDMA system in this section is shown in Figure 7.41.
Let us assume that there are K users in a cell and power control is employed. Then the received signal

FRAME BY FRAME ADAPTIVE RATE CODED MULTICARRIER DS-CDMA SYSTEM
379
Pilot
symbol and
rate
information
Data symbols
Channel 1
Channel 2
Channel M
Tp
Td
Tf
• • •
• • •
• • •
t
Data symbols
T
T
T
• • •
• • •
• • •
Figure 7.40 The frame structure.
Soft
Decision
RCPC
Decoder
(Rate r)
Deinterleaver
Correlator
for user k
Pilot Symbols and
Rate Information
DEMUX
r(t)
Receiver
RCPC decoder
Channel
estimation
(Feedback to
the transmitter)
i
kb~
j
kY 1,
j
M
kY ,
)
cos(
1,
1
k
t
φ
ω +
)
cos(
,M
k
Mt
φ
ω
+
…
…
…
Deinterleaver
DEMUX
Correlator
for user k
Pilot Symbols and
Rate Information
j
ky
1,
j
M
ky ,
Soft
decision
RCPC
decoder
(Rate r)
Deinterleaver
Correlator
for user k
Pilot symbols and
rate information
DEMUX
r(t)
Receiver
RCPC decoder
(Feedback to
i
kb~
j
kY 1,
j
M
kY ,
)
cos(
1,
1
k
t
φ
ω +
)
cos(
,M
k
Mt
φ
ω
+
…
…
…
Deinterleaver
DEMUX
Correlator
for user k
Pilot symbol and
rate information
j
ky
1,
j
M
ky ,
Figure 7.41 The receiver model for user k in the adaptive rate CC-OM DS-CDMA system.
at the base station can be written as
r(t) =
√
2P
∞

j=−∞
K

k=1
M

m=1
αk,mx j
k,mck(t −τk −jTs) cos(ωmt + φk,m) + n(t)
(7.98)
7.9.3
Rate-compatible punctured convolutional (RCPC) codes
RCPC codes are discussed in Chapter 2. For this section, some additional details are speciﬁed. Let the
code rate and constraint length of the parent code be R = 1/n and Lc, respectively. The parent code is
completely speciﬁed by the n generator polynomials G j(D) = g j
0 + g j
1 D + · · · + g j
Lc−1DLc−1, j =
1, 2, . . . , n, where g j
i ∈{0, 1}. The puncturing is done according to the rate compatibility criterion,
which requires that lower rate codes use the same coded bits as the higher rate codes plus one or more
additional bit(s). The bits to be punctured are described by an n × p puncturing matrix P consisting
of zeros and ones, where p is called the puncturing period. At time instant t, the output from each
generator G j(D) is transmitted if P( j, t mod p) = 1 and punctured otherwise. Here, P(a, b) denotes
the element on row a and column b in the matrix P. The number p of columns determines the number
of code rates and the rate resolution that can be obtained. Generally, from a parent code of rate 1/n,

380
OFDM AND MULTICARRIER CDMA
Puncturing tables
8/32
1111
1111
8/24
1111
1111
8/20
1111
1111
8/16
1111
1111
8/9
0111
1111
5678
1234
8/32
1111
1111
8/24
1111
1111
8/20
1111
1111
8/16
1111
1111
8/9
1000
1000
8/32
1111
1111
8/24
1111
1111
8/20
1100
1100
8/16
0000
0000
8/9
0000
0000
8/32
1111
1111
8/24
0000
0000
8/20
0000
0000
8/16
0000
0000
8/9
0000
0000
D
D
D
D
Puncturing
period = 8
Variable-rate
encoded
output
Puncturing tables
8/32
1111
1111
8/24
1111
1111
8/20
1111
1111
8/16
1111
1111
8/9
0111
1111
5678
1234
8/32
1111
1111
8/24
1111
1111
8/20
1111
1111
8/16
1111
1111
8/9
1000
1000
8/32
1111
1111
8/24
1111
1111
8/20
1100
1100
8/16
0000
0000
8/9
0000
0000
8/32
1111
1111
8/24
0000
0000
8/20
0000
0000
8/16
0000
0000
8/9
0000
0000
D
D
D
D
Figure 7.42 A ﬁve-rate RCPC encoder from a rate 1/4 parent code [63] (D: delay of
duration Tb).
we can obtain a family of (n −l)p different codes with rates
r = p
np ,
p
np −1, . . . ,
p
p + 1
(7.99)
The code rate of RCPC codes can be changed during even one information bit transmission and,
thus, unequal error protection can be obtained [8]. In this section, however, the code rate of RCPC
codes is changed frame by frame, not bit by bit, because we assumed frame by frame transmission.
An example of the RCPC encoder is shown in Figure 7.42.
7.9.4
Rate adaptation
A threshold-based adaptation scheme is used which adaptively changes the coding rate depending
upon the SINR estimated. Let θ0 = −∞, θ1, θ2, . . . , θQ = ∞be the SINR threshold values, which
are chosen such that between θ j−1 and θ j the channel coding rate r j has the highest throughput. Here,
Q is the number of possible code rates. Then, as discussed in Chapter 3, the transmitter mode (rate)
adaptation scheme can be deﬁned as follows:
Choose r j if θ j−1 ≤SINR < θ j,
j = 1, . . . , Q
(7.100)
In this method, bit by bit adaptation is not assumed due to the feedback delay. Instead, we choose the
adaptation interval Ta in such a way that Ta is long enough to allow the transmission of at least one
frame and short enough to react quickly to the possible change of the SINR. The transmitter can then
adapt its data rate every [Ta/Tf]Tf. This allows efﬁcient error recovery through ARQ mechanisms
even with dynamic rate adaptation. The rate at which the transmitter reacts to the changes in the SINR
depends on the SINR estimate and feedback delay in the system [64].
7.9.4.1
Example
RCPC codes with rate 1/4 convolutional codes of constraint length Lc = 5 and 9 are used as the
parent codes [64, 65], as the error control capability varies when the constraint length changes, we
use two values of Lc. The number, M, of subcarriers is four and nine. The processing gain N is 192

FRAME BY FRAME ADAPTIVE RATE CODED MULTICARRIER DS-CDMA SYSTEM
381
and 96, for M = 4 and M = 9, respectively, when the total bandwidth
BT = N(M + 1)/Ts
(7.101)
is ﬁxed. We assume each frame contains 144 symbols with Tf = 10 ms and Tp = 0 (that is, we assume
perfect feedback to simplify the simulations).
The adaptive rate CC-OM DS-CDMA system was implemented based on the above discussion
in [66]. When Lc = 5, ﬁxing the coding rate to 1/2 allows us to get the highest throughput and the
result is Figure 7.43(a). When Lc = 9, using the thresholds θ1 = 2.5 dB and θ2 = 5.5 dB, we get
−5
0
5
10
15
0
10
20
30
40
50
60
70
SINR
Throughput curve: Lc= 5
Throughput (kbps)
adaptive system, M = 9
conventional system, M = 9
adaptive system, M = 4
conventional system, M = 4
0
5
10
15
0
10
20
30
40
50
60
70
SINR
(a)
−5
0
5
10
15
0
10
20
30
40
50
60
70
SINR
Throughput curve: Lc = 9
Throughput (kbps)
adaptive system, M = 9
conventional system, M = 9
adaptive system, M = 4
conventional system, M = 4
0
5
10
15
(b)
Figure 7.43 (a) The adaptive throughput curves and the conventional throughput curves
when Lc = 5; (b) the adaptive throughput curves and the conventional through-
put curves when Lc = 9.

382
OFDM AND MULTICARRIER CDMA
Figure 7.43(b). In these ﬁgures, the throughput of the conventional system (ﬁxed rate with 1/M) is
also shown. It is clear that we can get much higher throughput with the adaptive system.
7.10
INTERMODULATION INTERFERENCE SUPPRESSION IN
MULTICARRIER CDMA SYSTEMS
In this section, a coded multicarrier direct sequence code division multiple access (DS-CDMA) system
is presented that, by the use of a minimum mean squared error receiver, achieves frequency diversity
(instead of path diversity as in a conventional single carrier (SC) RAKE DS-CDMA). It also has the
ability to suppress the intermodulation distortion and partially compensate for the signal distortion
introduced by a non-linear ampliﬁer at the transmitter. A frequency selective Rayleigh fading channel
is decomposed into M frequency non-selective channels, based on the channel coherence bandwidth.
A rate 1/M convolutional code, after being interleaved, is used to modulate M different DS-CDMA
waveforms. The system is shown to effectively combat intermodulation distortion in the presence of
multiple access interference.
7.10.1
Transmitter
In this section, the transmitter shown in Figure 7.44 is considered. The input signal to the power
ampliﬁer for the kth user sk(t) is given by
sk(t) = Ak
∞

i=−∞
M

m=1
d(i)
k,m pk,m(t −iY −τk) cos(ωmt + θk,m)
(7.102)
and pk(t) is a spreading (or signature) waveform given by
pk,m(t) =
N−1

n=0
c(n)
k,mh(t −nMTc)
(7.103)
bk
cos(ω1t + θk,1)
ck,1
(n)
dk,1
dk,M
Rate 1/M
convolutional
encoder
Interleaver
S/P (M)
Impulse
modulator
H(f)
cos(ωMt + θk,M)
ck,M
(n)
Impulse
modulator
H(f)
Σ
Power
amplifier
sk(t)
xsk(t)
x(t)
Power amplifier
g(|x|) exp(jf(|x| )
Zonal
filter
Figure 7.44 Transmitter block diagram for user k.

IIS IN MULTICARRIER CDMA SYSTEMS
383
0
0.5
1
1.5
2
2.5
Input amplitude to PA
10−2
10−1
100
101
PA output amplitude for SC input
PA model: Bessel function expansion
2
li
pl
e f
Figure 7.45 Power ampliﬁer transfer function for single carrier.
In Equation (7.103), c(n)
k,m ∈{±1} is the nth chip of the spreading sequence, N is the processing gain,
which is taken to be equal to the period of the spreading sequence, h(t) is the impulse response of
the chip wave-shaping ﬁlter, 1/MTc is the chip rate of the band-limited MC DS-CDMA system, and
1/Tc is the chip rate of a band-limited single carrier (SC) DS-CDMA system that occupies the same
spread bandwidth as does the MC system. That is, T = NMTc.
7.10.2
Non-linear power ampliﬁer model
For an input signal formed by the sum of M subcarrier signals, i.e.
x(t) = Re
1 M

m=1
am(t) exp[ jω0t + jψm(t)]
2
(7.104)
= Re {A(t) exp[ jω0t + j(t)]}
the output signal of a non-linear power ampliﬁer can be represented by
ˆx(t) = Re {g[A(t)] exp[ jω0t + j(t) + j f [A(t)]]}
(7.105)
where g(A) and f(A) represent the AM/AM (see Figure 7.45) and AM/PM conversion characteristics
of the non-linear power ampliﬁer.
7.10.3
MMSE receiver
As shown in Figure 7.46, M MMSE ﬁlters are combined with a soft-decision Viterbi decoder so
that the soft outputs from the M MMSE ﬁlters are parallel-to-serial converted, deinterleaved, and
decoded. The received DS-CDMA signal after the LPF for each subcarrier is despread (either partially
or fully) over consecutive F chips, which is characterized by a parameter Nt = ⌈N/F⌉. The decision
symbols needed by the M MMSE ﬁlters can be obtained via an interleaver with a serial-to-parallel
converter and an encoder which is identical to that used in the transmitter. The tap weight vector of

384
OFDM AND MULTICARRIER CDMA
Σ
x(t)
Bank of M
MMSE
receivers
P/S (M)
Deinterleaver
Soft decision
Viterbi
decoder
Rate 1/M
convolutional
encoder and
interleaver
+
-
Training
bk
Switch
Bank of MMSE receivers
2cos(ω1t + θk,1)
H*(f – f1)
+ H*(f + f1)
r(t)
LPF
Partial
despread
z1
dk,1
W1z1
2cos(ωMt + θk,M)
H*(f – fM)
+ H*(f + fM)
LPF
Partial
despread
zM
dk,M
W1zM
Error signal
S/P (M)
Figure 7.46 Receiver block diagram for user k.
the mth MMSE ﬁlter ωm is chosen so as to minimize the conditional mean square error, conditioned
on all parameters of the desired user (user 1) and certain parameters of the MAI and IM, i.e. with
q = {α1,
⌣
θ 1, ρ±
k,I(m,h)}, we have
MSE = E{(ω′
mzm −d1,m)2 | q}
(7.106)
For the notation see Figure 7.46. Note that we omit the superscript i, which denotes the estimated
bit, for notational simplicity. From Chapter 5, the optimum tap weight vector for Equation (7.106) is
given by:
(ωm)opt = R−1
m am
(7.107)
where
Rm = E{zmz′
m | q}
(7.108)
and
am = E{d1,mzm | q}
(7.109)
7.10.3.1
Example
For the numerical example, we use the same parameters as in [67], the PA model given in the previous
section and M = 4, N = 32, R = 1/4 and constraint length K = 3 coded MC-CDMA system and
an SC coded RAKE system with the same coding scheme and the same bandwidth as the coded MC-
CDMA system. Note that there are not any IM terms in the SC system, but the non-linear distortion
introduced by the PA is taken into account. The same PA output power is assumed for both the SC
input signal and the MC input signal. The system performance is obtained by simulation. In Figures
4.47–48, the maximal number of resolvable paths for the SC is denoted Lp, and Lt is the actual
number of RAKE taps.

IIS IN MULTICARRIER CDMA SYSTEMS
385
0.1
0.2
0.3
0.4
0.5
0.6
0.7
Input amplitude to PA (per subcarrier)
10−8
10−7
10−6
Probability of  bit errorr
MC RAKE M = 4, Lt = 1, N = 32
MC MMSE M = 4, Lt = 1, Nt = 32
PA model: Bessel function, system Eb / N0 = 13 dB, user = 1
M =4, CC: R = 1/M, K = 3
0.1
0.2
0.3
0.4
0.5
0.6
0.7
R
t
2
t
t
PA model: Bessel function, system
= 1
4, CC
= 1
Figure 7.47 Probability of bit error in the presence of IMD (different PN (DPN) code for
each subcarrier).
10.0
20.0
30.0
40.0
50.0
Number of users
10−8
10−6
10−4
10−2
100
Probability of bit error
MC RAKE with IM (SPN), Lt = 1, N = 32
MC RAKE with IM (DPN), Lt = 1, N = 32
MC MMAE with IM (SPN), Nt = 32
MC MMSE with IM (SPN), Nt = 32
SC RAKE without IM, Lt = 4, N = 32
SC MMSE without IM, Lt = 4, Nt = 32
each subcarrier: input amplitude = 0.65, system Eb / N0 = 13 dB
SC: Lp = 4, exponential MIP under a unity energy constraint
MC: M = 4, CC: R = 1/ M, k = 3
PA model: Bessel function
er
MC RAKE with IM (SPN),
t = 1
2
MC RAKE with IM (DPN),
t = 1
MC MMAE with IM (SPN),
t = 32
MC MMSE with IM (SPN),
t = 32
SC RAKE without IM
t = 4
2
SC MMSE without IM
t
t = 32
.6
p
PA model: Bessel function
Figure 7.48 Comparison between the systems with the same (SPN) and the different (DPN)
PN codes for each subcarrier.

386
OFDM AND MULTICARRIER CDMA
7.11
SUCCESSIVE INTERFERENCE CANCELLATION IN MULTICARRIER
DS-CDMA SYSTEMS
This section presents a successive interference cancellation (SIC) scheme for a multicarrier (MC)
asynchronous DS-CDMA system, wherein the output of a convolutional encoder modulates band-
limited spreading waveforms at different subcarrier frequencies. In every subband, the SIC receiver
successively detects the interferers signals and subtracts them from that of the user of interest. The
SIC receiver employs maximal ratio combining (SIC-MRC) for detection of the desired user, and
feeds a soft decision Viterbi decoder.
7.11.1
System and channel model
A K-user asynchronous communication system is presented. We assume knowledge of the time
delays and the spreading sequences of all the users, but no knowledge of the channel gains of the
interferers. The user data symbols are input to a rate 1/M convolutional encoder. The output code
symbols are interleaved and serial-to-parallel (S/P) converted such that M parallel code symbols
may be transmitted simultaneously. Then, each of the M code symbols is replicated by a rate 1/R
repetition code, and transmitted over MR subcarriers.
For example, if M = 4 and R = 2, then the M = 4 code symbols are mapped to a total of
eight subcarriers in the following way: the ﬁrst code symbol is transmitted on the ﬁrst and the ﬁfth
subcarriers, the second code symbol is transmitted on the second and the sixth subcarriers, the third
code symbol is transmitted on the third and the seventh subcarriers, and the fourth code symbol is
transmitted on the fourth and the eighth subcarriers. Therefore, the minimum subcarrier distance for
the same code symbol is maximized. The mapped code symbols are then multiplied by the spreading
sequence assigned to the given user. The transmitted signal for the kth user is:
Sk(t) =

2Eck



+∞

j=−∞
ak(t −jT −τk) ×
M R

m=1
b j
k,[m]M cos(ωmt + θk,m)



(7.110)
where
ak(t) =
N−1

n=0
c(n)
k h(t −nTc)
We assume that the channel in each subband is a slow-varying frequency non-selective Rayleigh
channel with transfer function
ζk,m = αk,m exp( jβk,m)
The received signal is given by
r(t) =
K

k=1

2Eck
+∞

j=−∞
ak(t −jT −τk) ×
MR

m=1
b j
k,[m]M αk,m cos(ωmt + θ′
k,m) + nw(t)
(7.111)
The receiver structure for the desired user, user 1, is shown in Figures 7.49–50. Interferers 2,3, . . . ,
K are renumbered as 1m, 2m, . . . , (K −1)m, which deﬁnes the cancellation order such that in the
m-th subband, interferer 1m is the strongest, 2m is the second strongest, and so on. The cancellation
order in each subband is different, i.e. for every subband there is a distinct successive interference
cancellation order.

MMSE DETECTION OF MULTICARRIER CDMA
387
Bank of
MR SIC
demodu-
lators
Symbol
demapper
Bank of M
maximal-
ratio
combining
P/S (M)
Deinter-
leaver
Soft decision
Viterbi
decoder
MR symbols
M symbols
r(t)
MR symbols
Figure 7.49 Receiver block diagram for the desired user 1.
H*(f – fm)
+ H*(f + fm)
r(t)
1st despread at mth subcarrier
r’m(t)
Kth despread at mth subcarrier
kth despread at mth subcarrier
Inter-
ference
Regene-
ration
k – 1
Cance-
llation
T
√2cos(ωmt + θk ,m)
m
LPF
K – 1
Cance-
llation
Lk
(t)
,m
m
(i + 1)T + nTc + τkm
1
N
m
Σ
n = 0
N - 1
ZK
(i) = Z1,m
,m
m
Z1
(i)
,m
m
Zk
(i+1)
,m
m
Zk
(i)
,m
m
Zk
(i)
,m
m
(i)
ZK
(i)
,m
m
Ck
(n)
Z1
(i+1)
,m
m
Figure 7.50 SIC demodulator at mth subcarrier for the desired user 1.
7.11.1.1
Example
In the following numerical example the signal parameters are the same as in [68]. Gold sequences
are used with N = 31 when convolutional coding is employed, and the constraint length of the
convolutional code is three. Ideal power control is assumed, i.e. Eck
= Ec for every user k. Also,
X( f ) is a raised cosine function with a rolloff factor α = 0.5, and all of the comparisons are based
on the same transmitted data rate. The analytical results presented in [68] are averaged over 1000
realizations, and the cancellation order in the simulation of SIC on the mth subband is based upon the
decreasing order of |Zkm,m(i)|, i.e. | ˆZ1m,m(i)| ≥· · · ≥| ˆZ(K−1)m,m(i)|. To simulate the time-correlated
Rayleigh fading channel, the Jakes model (see Chapter 14) is used with a bit rate of 20 000 bits/s
and a maximum Doppler frequency of 100 Hz, while a block interleaver/deinterleaver is employed
to separate adjacent data bits into a block size of 30 × 30, which results in a delay of 45 ms. Some
results are given in Figure 7.51.
7.12
MMSE DETECTION OF MULTICARRIER CDMA
The results from the previous section have already demonstrated that an MMSE detector performs
better than a receiver with SIC. For this reason, in this section the minimum mean squared error
(MMSE) detection of multicarrier code division multiple access (CDMA) signals is presented in
more detail. The performance of two different design strategies for MMSE detection is compared.
In one case, the MMSE ﬁlters are designed separately for each carrier, while in the other case the
optimization of the ﬁlters is done jointly. Naturally, the joint optimization produces a better receiver,
but the difference in performance is shown to be substantial. The multicarrier CDMA performance
is then compared to that of a single-carrier CDMA system on a frequency selective fading channel.
A mechanism to track the channel fading parameters for all the users’ signals is presented which
enables joint optimization of the receiver ﬁlters in a time-varying channel. Simulation results show

388
OFDM AND MULTICARRIER CDMA
10
15
20
25
30
K (Total number of users)
10−4
10−3
10−2
10−1
100
Probability of bit error
MF, Simulation
MF, Analysis
MMSE, Simulation
MMSE, Analysis
SIC, Simulation
SIC, Analysis
N = 31, Eb / h0 = 15 dB
M = 2, R = 1
10
15
20
25
30
MF, Simulation
MF, Analysis
MMSE, Simulation
MMSE, Analysis
SIC, Simulation
SIC, Analysis
MF, Simulation
MF, Analysis
MMSE, Simulation
MMSE, Analysis
SIC, Simulation
SIC, Analysis
/
0
2,
1
Figure 7.51 Comparisons of the analytical bounds with simulation results for the MF and
SIC receivers in convolutionally coded MC CDMA, where perfect CSI is
assumed.
that the performance of this receiver is close to the ideal theoretical results for moderate vehicle
speeds. Performance begins to degrade when the normalized Doppler rate is higher than about 1 %.
The received signal on the system’s reverse link on the mth carrier is given by
rm(t) = Re
1 +∞

i=−∞
K

k=1
5
2Pk
M γk,m(i)dk(i) × ck,m(t −iTb −τk) exp( jωmt)
2
+ nm(t)
(7.112)
The received signal is processed with a chip-matched ﬁlter, which consists of an integrator with
duration MTc. The samples are stored for one bit interval, giving a column vector of length N/M:
rm(i) =
K

k=1
,
Pk
P1
γk,m(i)[dk(i)fk,m + dk(i −1)gk,m] + nm(i)
(7.113)
where fk,m and gk,m depend on the left- and right-cyclic shifts of ck,m, the spreading code of the kth
user on the mth carrier.
A block diagram of a general linear receiver is shown in Figure 7.52. Each of the M received vectors
is processed with a receiver ﬁlter wm(i) to form a statistic Zm(i) = wH
m(i)rm(i), for m = 1, 2, . . . , M.
Note the time dependence of the ﬁlters in the time-varying fading channel. The individual statistics
are summed to form an overall decision statistic Z(i) = M
m=1 Zm(i). Equivalently, we can deﬁne an
overall receiver ﬁlter as
w(i) =
-
wT
1(i), wT
2(i), · · · , wT
M(i)
.T
(7.114)
and an overall received vector as
r(i) =
-
rT
1(i), rT
2(i), . . . , rT
M(i)
.T
(7.115)
which gives Z(i) = wH(i)r(i).

MMSE DETECTION OF MULTICARRIER CDMA
389
M
e-jω t
∫T ( )dt
c
Store N/M
samples
wM(i)rM(i)
H
rM(i)
ZM(i)
2
e-jω t
∫T ( )dt
c
Store N/M
samples
w 2(i)r2(i)
H
r2(i)
Z2(i)
1
e-jω t
∫T ( )dt
c
Store N/M
samples
w 1(i)r1(i)
H
r1(i)
Z1(i)
Z (i)
r(t)
Σ
Figure 7.52 General receiver for multicarrier CDMA.
We next consider two different design strategies for performing MMSE detection. The best per-
formance is obtained when the ﬁlters w1(i), w2(i), · · · , wM(i) are designed jointly so as to minimize
the composite mean squared error
J = E[|d1(i) −wH(i) r (i)|2]
(7.116)
This gives the well-known Wiener solution w(i) = R−1(i) p (i), with
R(i) = E⌊r(i)rH(i)⌋
and
p(i) = E⌊d∗
1(i) r (i)⌋
(7.117)
representing the correlation matrix and steering vector, respectively. These can be further decomposed
as
R(i) =


R1,1(i)
R1,2(i)
· · ·
R1,M(i)
R2,1(i)
R2,2(i)
· · ·
R2,M(i)
...
...
...
...
RM,1(i)
RM,2(i)
· · ·
RM,M(i)


(7.118)
where the individual submatrices are deﬁned as
Rm,n(i) = E
6
rm(i)rH
n (i)
7
(7.119)
and
p(i) =
-
pT
1(i), pT
2(i), . . . , pT
M(i)
.T
(7.120)
with
pm(i) = E⌊d∗
1(i)rm(i)⌋
(7.121)
An alternative suboptimal approach is to design the M ﬁlters separately by choosing each of the ﬁlters
w1(i), w2(i), . . . , wM(i) to minimize the individual mean squared error quantities J = E[|d1(i) −
wH
m(i)rm(i)|2], which leads to wm(i) = R−1
m,m(i)pm(i). Together with the previous notation, an overall

390
OFDM AND MULTICARRIER CDMA
0
10
20
Users
10−6
10−5
10−4
10−3
10−2
10−1
Probability of bit errorr
M = 4
M = 2
M = 1
10
M = 4
M = 2
M = 1
Figure 7.53 Probability of error versus number of users for the multicarrier CDMA system,
with Eb/N0 = 17 dB, composite processing gain of 32 chips/bit and M carri-
ers. The solid lines are the Wiener solutions when all users’ fading processes
are tracked, the dashed lines are the Wiener solutions when only the desired
user’s fading processes are tracked.
ﬁlter using this design strategy can then be written as w(i) = R−1
B (i)p(i) where
RB(i) =


R1,1(i)
0
· · ·
0
0
R2,2(i)
· · ·
0
...
...
...
...
0
0
· · ·
RM,M(i)


(7.122)
An example of performance results is given in Figure 7.53. One can see that the joint detector
demonstrates better performance.
Before proceeding to present a tracking algorithm, it is worthwhile to compare the performance of
a multicarrier CDMA system to that of a single-carrier system which realizes diversity inherently by
operating on a frequency selective fading channel. In order to get a fair comparison to the multicarrier
case, the system will be assumed to employ spreading waveforms of length N chips/bit, where N
in the multicarrier case is the composite processing gain. The received signal will consist of M
resolvable components, delayed with respect to one another by a sufﬁcient number of chips. Results
for this case are shown for comparison to the multicarrier case in Figure 7.54.
7.12.1
Tracking the fading processes
The presentation in this section is based on [69–71]. The received vector on the mth carrier, from
Equation (7.113), may be written as
rm(i) = (FmD(i) + GmD(i −1))Pm(i) + nm(i)
(7.123)

MMSE DETECTION OF MULTICARRIER CDMA
391
0
10
20
Users
10−6
10−5
10−4
10−3
10−2
10−1
Probability of bit error
M = 4
M = 2
M = 1
M = 4
M = 2
M = 1
Figure 7.54 Probability of error versus number of users for the multicarrier CDMA system
(solid curves) and the single-carrier system on a frequency selective fading
channel (dashed curves). For each Eb/N0 = 17 dB, the composite processing
gain is 32 chips/bit, and M is the number of carriers used (for multicarrier) or
the number of resolvable paths present (for frequency selective). The Wiener
solution is formed, with all users’ fading processes tracked perfectly.
where the matrices in this expression are deﬁned as
Fm =
/
f1,m, f2,m, . . . , fK,m
0
Gm = [g1,m, g2,m, . . . , gK,m]
D(i) =


d1(i)
d2(i)
...
dK(i)


P(i) =


1
√P2/P1
...
√PK/P1


(7.124)
and the column vector of fading coefﬁcients on the mth carrier, which is to be tracked, is
m (i) = [γ1,m (i), γ2,m (i), . . . , γK,m(i)]T
(7.125)
Also, in Equation (7.123), recall that nm(i) is a column vector of independent, complex Gaussian
noise samples, with the real and imaginary parts independent from each other and each with variance

392
OFDM AND MULTICARRIER CDMA
σ 2 = N/(2Eb/N0). Then, Equation (7.123) can be rewritten as
rm(i) = m(i)m(i) + nm(i)
(7.126)
with
m(i) = (FmD(i) + GmD(i −1))P
(7.127)
For estimation purposes, we next assume that the fading processes are essentially constant over a
window of L bit intervals, which gives
r(L)
m (i) = (L)
m (i)m(i) + nL
m(i)
(7.128)
where matrices from L bit intervals have been concatenated to form
r(L)
m (i) =
-
rT
m(i −(L −1)), . . . , rT
m(i)
.
(L)
m (i) =
-
T
m(i −(L −1)), . . . , T
m(i)
.
(7.129)
n(L)
m (i) =
-
nT
m(i −(L −1)), . . . , nT
m(i)
.
We now assume that the receiver has knowledge of the data bits of all of the users. This would be
reasonable either when the receiver is in training mode, or when decision feedback is used. In this
case, the maximum likelihood estimate of the vector m(i) minimizes the quadratic cost function
C(m(i)) =
88r(L)
m (i) −(L)
m m(i)
882
giving the least squares solution
m,ML(i) =
-
(L)
m (i)
.T -
(L)
m (i)
.−1
×
-
(L)
m (i)
.T -
r(L)
m (i)
.
= Q−1
m (i)Sm(i)
(7.130)
where
Qm(i) =
-
(L)
m (i)
.T -
(L)
m (i)
.
=
L−1

j=0
T
m(i −j)m(i −j)
Sm(i) =
-
(L)
m (i)
.T -
r(L)
m (i)
.
=
L−1

j=0
T
m(i −j)rm(i −j)
(7.131)
This form of the matrices suggests recursive estimates using exponentially weighted windows
Qm(i) = λQm(i −1) + T
m(i)m(i)
(7.132)
Sm(i) = λSm(i −1) + T
m(i)rm(i)
where 0 < λ < 1 is the forgetting factor. Once the fading has been estimated according to this
procedure, an estimate of the true Wiener solution of the tap weights may be formed.
To obtain some insight into the operation of this channel estimator, consider a single bit estimator,
that is, let λ = 0. We have
m,ML(i) =
-
(L)
m (i)(L)
m (i)
.−1 -
(L)
m (i)r(L)
m (i)
.
= m(i) +
-
(L)
m (i)(L)
m (i)
.−1 -
(L)
m (i)n(L)
m (i)
.
(7.133)
Thus, the estimate of m(i) is equal to the true value plus a term due only to the thermal noise, and
independent of the multiaccess interference.

APPROXIMATION OF OPTIMUM MULTIUSER RECEIVER
393
rm(i)
Matched
filter bank
Decorrelator
[(FmP)T(FmP)]-1
Remove data
D-1(i)
(FmP)T rm(i)
[(FmP)T(FmP)]-1(FmP)T rm(i)
Figure 7.55 Block diagram of the estimator for fading processes using a single bit obser-
vation window.
Furthermore, if the system were synchronous, then the matrix Gm would be a zero matrix, and the
estimate of m(i) could be written as
m,ML(i) = D−1(i)[(FmP)T(FmP)]−1[(FmP)Tr(L)
m (i)]
(7.134)
The estimator could then be visualized as in Figure 7.55. The received signal is processed ﬁrst with
a matched ﬁlter bank. The MAI is then removed with a decorrelator. Finally, the data are removed,
leaving an unbiased estimate of m(i).
One should keep in mind that the matrix (FmP)T(FmP) will be invertible only if the columns
of Fm are linearly independent. This condition will be violated as the number of users surpasses
N/M and the decorrelator will not exist. However, as the observation window was increased, which
would obviously be done in order to get good estimates of the fading processes, the existence of the
decorrelator would be almost certain. A similar interpretation of the estimator would still apply, that
is, matched ﬁlter/decorrelator/data removal.
The performance of this algorithm will be illustrated ﬁrst for a multicarrier CDMA system with
the same parameters as in [69]. A user with a data rate of 10 kHz, a carrier frequency of 900 MHz, a
processing gain of 32 chips/bit, and an Eb/N0 of 17 dB was simulated. With 15 users present, results
for the average probability of bit error are shown in Figure 7.56(a) as a function of the vehicle speed,
which was varied from 20 mph up to 200 mph. Single-carrier, two-carrier and four-carrier systems
were considered. Results for the ideal Wiener solution are shown for comparison. It is seen that the
performance is very close to ideal for vehicle speeds below about 80 mph, or a normalized Doppler
frequency under 1 %.
In Figure 7.56(b), the identical system was simulated, this time with a ﬁxed vehicle speed of 80
mph, and with the number of users varying between 1 and 30. Again, the results are seen to be close
to ideal at this speed.
As mentioned previously, it is straightforward to extend this tracking algorithm to the frequency
selective case. Without going into such details, in Figure 7.56(c), an identical system to that used to
generate the results shown in Figure 7.56(a) for the multicarrier case was applied to a single-carrier
system operating on a frequency selective channel with M resolvable paths. The average probability
of bit error is shown as a function of the vehicle speed for 15 users. Again, the tracking algorithm
gives results which are very close to ideal for vehicle speeds below about 80 mph, or a normalized
Doppler frequency under 1%, In Figure 7.56(d), the vehicle speed was ﬁxed at 80 mph, and the
number of users was varied between 1 and 30, the results are again close to ideal at this speed.
Additional discussions on MMSE detectors for MC CDMA systems can be found in [69–81].
7.13
APPROXIMATION OF OPTIMUM MULTIUSER RECEIVER FOR
SPACE–TIME CODED MULTICARRIER CDMA SYSTEMS
In this section we extend the discussion on multiuser detection for MC CDMA to the case when
space–time coding is included. The presentation is based on [82–84]. The structure of the MC
CDMA modulator of the kth user is illustrated in Figure 7.57. BPSK symbols of the kth user are ﬁrst
serial-to-parallel converted, by grouping every P symbols into a vector
sk = [sk[1], . . . , sk[P]]T
(7.135)

394
OFDM AND MULTICARRIER CDMA
40
80
160
Vehicle speed (mph)
10−4
10−3
10−2
10−1
Probability of bit error
M = 4
M = 2
M = 1
120
40
80
160
M = 4
M = 2
M = 1
120
(a)
Figure 7.56 (a) Probability of error versus vehicle speed for multicarrier CDMA sys-
tem with Eb/N0 = 17 dB, composite processing gain of 32 chips/bit, 15
asynchronous users, bit rate of 10 000 bits/s, and carrier frequency of 900
MHz. M is the number of carriers used. Curves show the performance of
the tracking algorithm, and solid straight lines show the Wiener solutions
for 15 users. (b) Probability of error versus number of users for multicar-
rier CDMA system with Eb/N0 = 17 dB, composite processing gain of 32
chips/bit, vehicle speed of 80 mph, bit rate of 10 000 bits/s, and carrier
frequency of 900 MHz. M is the number of carriers used. Dashed lines
show the performance of the tracking algorithm, and solid lines show the
Wiener solutions. (c) Probability of error versus vehicle speed for single-
carrier CDMA system with M resolvable paths. The system has 15 users,
Eb/N0 = 17 dB, composite processing gain of 32 chips/bit, bit rate of 10
000 bits/s, and carrier frequency of 900 MHz. Curves show the perfor-
mance of the tracking algorithm, and solid straight lines show the Wiener
solutions for 15 users. (d) Probability of error versus number of users for
single-carrier system with M resolvable paths. System has Eb/N0 = 17 dB,
composite processing gain of 32 chips/bit, vehicle speed of 80 mph, bit rate
of 10 000 bits/s, and carrier frequency of 900 MHz. Dashed lines show
the performance of the tracking algorithm, and solid lines show the Wiener
solutions.

APPROXIMATION OF OPTIMUM MULTIUSER RECEIVER
395
5
10
25
Users
10−4
10−3
10−2
10−1
Probability of bit error
M = 4
M = 2
M = 1
15
20
25
M = 4
M = 2
M = 1
15
20
(b)
40
80
160
Vehicle speed (mph)
10−4
10−3
10−2
10−1
Probability of bit error
M = 4
M = 2
M = 1
120
Vehicle speed (mph)
M = 4
M = 2
M = 1
(c)
Figure 7.56 (cont.)

396
OFDM AND MULTICARRIER CDMA
5
10
25
Users
10 −4
10−3
10 −2
10−1
Probability of bit error
M = 4
M = 2
M = 1
15
20
25
M = 4
M = 2
M = 1
15
20
(d)
Figure 7.56 (cont.)
Spread ck [1]
Spread ck[2]
Spread ck[P]
sk[1]
sk[2]
sk[P]
T
IFFT
P/S
S/P
Figure 7.57 MC CDMA modulator structure of the kth user, with interleaver T.
In the next step, symbol sk[p] in sk is spread by a spreading sequence ck[p], p = 1, . . . , P. The
sequences corresponding to all P binary phase shift keying (BPSK) symbols are represented by an
N-vector as
ck = [ck[1], . . . , ck[P]]T
(7.136)
and the spread signals are represented by a componentwise product of the above vectors
skck = [sk[1]ck[1]T, . . . , sk[P]ck[P]T]T
(7.137)
In order to avoid the strong correlation among the G subcarriers occupied by a particular symbol,
all N spread chips in Equation (7.137) are interleaved before they are transmitted from the N
subcarriers. The interleaving function is denoted by T in Figure 7.57; for simplicity, the interleaver
is assumed to be the same for all K users.
The Alamouti space–time block codes (STBC), discussed in Chapter 4, are employed to further
increase the system capacity. In Chapter 4, the STBC was used to transmit scalar symbols. In this
section, we extend it to the vector form and apply it in MC CDMA systems. In vector form, the
simplest (2 × 2) STBC discussed in Chapter 4, as illustrated in Figure 7.58, takes two time slots to

APPROXIMATION OF OPTIMUM MULTIUSER RECEIVER
397
Tx Ant
#1
#2
t = 1
#1
#2
t = 2
time
freq
freq
T(s2
k,c2
k)
T(s1
k,c1
k)
T(s1
k,c2
k)
T(s2
k-,c1
k)
Figure 7.58 Transmitted signal structure of a particular STBC slot of the kth user in an
STBC MC CDMA system.
Info
s1
k
s2
k
[ s1
k, - s2
k ]
[ s2
k, s1
k ]
STBC
encoder
MC CDMA mod
MC CDMA mod
S/P
Figure 7.59 Transmitter structure of the kth user in an STBC MC CDMA system.
transmit two symbol vectors sk
1, sk
2 [cf. Equation (7.135)]. At the ﬁrst time slot, signals T(sk
1ck
1) are
transmitted from the ﬁrst antenna on N subcarriers and T(sk
2ck
2) is transmitted from the second antenna.
At the second time slot, T(−sk
2ck
1) is transmitted from the ﬁrst antenna and T(sk
1ck
2) is transmitted
from the second antenna. From Figure 7.58, we can see that different spreading sequences ck
1 and
ck
2 are assigned to different transmitter antennas; this structure is shown to be an efﬁcient way to
resolve the so-called ‘antenna-ambiguity’ in blind algorithms, as will be discussed. The structure of
the transmitter for the kth user is given in Figure 7.59.
7.13.1
Frequency selective fading channels
The system with one receiver antenna is considered and the extension to multiple receiver antennas is
straightforward. The time domain channel impulse response of the kth user between the jth transmitter
antenna and the receiver antenna will be modeled as
hk
j(τ) =
L−1

l=0
αk
j(l)δ

τ −
l
 f

(7.138)
where δ(·) is the Kronecker delta function; L
=⌈τm f + 1⌉, with τm being the maximum multipath
spread of all K users (note that we have assumed the synchronous transmission of all k users) and
 f being the whole bandwidth of multicarrier systems; αk
j(l) is the complex amplitude of the lth tap
associated with the jth transmitter antenna of the kth user, whose relative delay is l/ f .
For MC CDMA systems with proper cyclic extensions and sample timing, with tolerable leakage,
the channel frequency response of the kth user at its jth transmitter antenna and at the nth subcarrier

398
OFDM AND MULTICARRIER CDMA
can be expressed as
H k
j [n]
= H k
j (n f )
=
L−1

l=0
αk
j(l) exp

−j2π nl
N

(7.139)
= wH
f (n)hk
j
where
hk
j
=

αk
j(0), αk
j(1), . . . , αk
j(L −1)
T
(7.140)
contains the time response of all L taps; and
wf(n)
=

1, exp

−j2π n
N

, . . . , exp

−j2π n(L −1)
N
H
(7.141)
contains the corresponding discrete Fourier transform (DFT) coefﬁcients.
7.13.2
Receiver signal model of STBC MC CDMA systems
The transmitted signals of all K users propagate through their respective frequency selective fading
channels and ﬁnally reach the receiver antenna. We assume that the fading processes associated with
different transmitter–receiver antenna pairs are uncorrelated. At the receiver, after matched ﬁltering,
the discrete Fourier transform (DFT) is applied to the received chip rate sampled discrete time signals.
Consider all the DFT-ed signals in one signal frame, which spans M STBC slots, or equivalently,
2M time slots [recall that each STBC slot consists of two neighboring time slots (see Figure 7.58).]
Using Equation (7.139) and assuming that the fading processes are time invariant within one signal
frame, the received signal model can be represented as
yi =
K

k=1
 Sk
i,1Ck
1
Sk
i,2Ck
2
−Sk
i,2Ck
1
Sk
i,1Ck
2

(
)*
+
Xk
i
 TWf
0
0
TWf

(
)*
+
W
×
 hk
1
hk
2

( )* +
hk
+ vi
=
K

k=1
Xk
i Whk + vi,
i = 0, . . . , M −1
(7.142)
with
Ck
j
= diag
3
ck
j
4
N×N
ck
j
=

ck
j[1], . . . , ck
j[P]TT
,
j = 1, 2
Sk
i, j
= diag
3
sk
i, j ⊗IG
4
= diag
3
sk
i, j[1]IG, . . . , sk
i, j[P]IG
4
N×N,
j = 1, 2
Wf
= [wf(0), wf(1), . . . , wf(N −1)]H
N×L
where ⊗is the Kronecker matrix product; sk
i, j, j = 1, 2 are the symbol vectors input to the STBC
encoder at the ith STBC slot; ck
j is the spreading sequence assigned to the jth transmitter antenna
of the kth user; T is an (N × N) permutation matrix, which acts as an interleaver mapping the N
chips to their assigned subcarriers; yi is the received signal during the ith STBC slot; vi is circularly
symmetric complex Gaussian ambient noise, with covariance matrix σ 2I2N.
Note that Equation (7.142) can be used to describe both the slow-fading (when M is large) and
the fast-fading (when M is small, e.g. M = 1) cases. In this section, the fading channels are assumed

APPROXIMATION OF OPTIMUM MULTIUSER RECEIVER
399
to be static during two neighboring time slots (i.e. one STBC slot), this is the only limitation of the
signal model in Equation (7.142). Due to the orthogonality property of the STBC, i.e. XkH
i Xk
i = 2I2N,
the orthogonality property of the OFDM multicarrier modulation, i.e. WH
f Wf = N · IL, the fact that
the permutation matrix satisﬁes TTT = IN and the deﬁnitions given in Equation (7.142), we have
WHXkH
i Xk
i W =
 WH
f TT
0
0
WH
f TT
  2IN
0
0
2IN

×
 TWf
0
0
TWf

= 2N · I2L
(7.143)
As we know from orthogonal design, discussed in Chapter 4, the structure of Equation (7.143)
can be exploited to reduce the computational complexity of the optimal receiver for the STBC MC
CDMA system. Note that the interleaver function T is the same for all K users; hence, the signal
model Equation (7.142) can be written in an alternative form, which decouples the signal components
corresponding to different symbols
yi[p] =
K

k=1
Xk
i [p]W[p]hk + vi[p],
i = 0, . . . , M −1
p = 1, . . . , P
(7.144)
where Xk
i [p] is a (2G × 2G) submatrix decimated from Xk
i , which contains all the rows and columns
related to the symbol sk
i,1[p] and sk
i,2[p]; yi[p], W[p] and vi[p] are then the corresponding decima-
tions from yi, W, and vi. Equation (7.144) will be used later in deriving the conditional posterior
distributions of the unknown symbols [see Equation (7.158)].
7.13.3
Blind approach
Since the channel state information is unknown to the receiver, there are two types of ambiguity
inherent in the design of blind receivers for the STBC MC CDMA system: phase ambiguity and
antenna ambiguity.
To resolve the phase ambiguity, differential encoding is employed before the STBC encoding.
For each signal frame, a block of BPSK bits bk = {bk[1], bk[2], . . . , bk [2MP−1]} is input to the
differential encoder, and the output dk = {dk[1], . . . , dk[2MP]} is given by
1
dk[1] = 1
dk[n] = dk[n −1]bk[n −1],
n = 2, . . . , 2MP
(7.145)
These differentially encoded bits {dk[n]}n are the same set of bits {sk
i, j[p]}i, j,p [deﬁned by Equation
(7.142)] input to the STBC encoder, where they are related as sk
i, j[p] = dk[n]|n=(2i+ j)P+p. Henceforth,
the index n of dk[n] is understood as an implicit function of the index (i,j,p) of sk
i, j[p].
One possible approach to resolving the antenna ambiguity is to employ the differential space–time
modulation as discusssed in Chapter 4; however, in that case, the signal constellation will be changed.
Fortunately, in the STBC MC CDMA system, the antenna ambiguity can be resolved by using
different spreading sequences on different transmitter antennas. Note that the usage of orthogonal
sequences will result in a maximum 50 % system loading (deﬁned as K/G) in the (2 × 2) STBC
MC CDMA system. The problem with this is that the channel frequency selectivity destroys the
orthogonality of the sequences. For this reason, in this section, random sequences are assumed and
a sufﬁcient number of these sequences, such that they impose no constraint on the system loading.
When the system employs the outer channel code, it is possible to use the same spreading sequence at
different antennas of the same user. In this case, the antenna ambiguity can be resolved by exploiting
the coding structure. For example, for the system considered here, due to the antenna ambiguity, we
have two possible code bit sequences at the output of the multiuser detector. We can send both of
them to the channel decoder and count the number of bit corrections. The correct code bit sequence
will have only a few bit errors, whereas the incorrect one will have many errors.

400
OFDM AND MULTICARRIER CDMA
7.13.4
Bayesian optimal blind receiver
From here on the following matrix notation will be used
Y
={yi}M−1
i=0 ; H
={hk}K
k=1; D
={dk}K
k=1; B
={bk}K
k=1
The optimal blind receiver estimates the a posteriori probabilities (APP) of the multiuser data bits
P[bk[n] = +1|Y],
n = 1, 2, . . . , MP −1,
k = 1, . . . , K
(7.146)
based on the received signals Y, the signal structure Equation (7.142), the spreading sequences of all
users, and the prior information of B, without knowing the channel response H and the noise variance
σ 2.
So, the unknown parameters have to be averaged out from the a posteriori function. The Bayesian
solution to Equation (7.146) is given by
P[bk[n] = +1|Y]
=

B:bk[n]=+1

p[Y|H, σ 2, B]p[H]p[σ 2]p[B] dH dσ 2
(7.147)
where P[Y|H, σ 2, B] is a Gaussian density function [see Equation (7.142)]; p[H], p[σ 2] and p[B]
are prior distributions of the independent and unknown quantities H, σ 2 and B respectively. Clearly
the computation in Equation (7.147) involves a very high-dimensional integral which is certainly
infeasible for any practical implementations. Thus, the Gibbs sampler, a Monte Carlo method, is used
to calculate the a posteriori probabilities of the unknown symbols.
7.13.5
Blind Bayesian Monte Carlo multiuser receiver approximation
In this section, we consider the problem of computing the a posteriori bit probabilities in Equation
(7.146). The problem is solved under a Bayesian framework, by treating the unknown quantities as
realizations of random variables with some prior distributions. The Gibbs sampler [85–89] is then
employed to compute the Bayesian estimates.
7.13.6
Gibbs sampler
The Gibbs sampler [85–89] is a Markov chain Monte Carlo (MCMC) procedure for numerical
Bayesian computation. Let θ = [θ1, . . . , θd]T be a vector of unknown parameters. Let Y be the
observed data. To generate random samples from the joint posterior distribution p[θ|Y], given the
samples at the ( j −l)th iteration, θ( j−1) = [θ( j−1)
1
, . . . , θ( j−1)
d
]T at the jth iteration, the Gibbs algorithm
iterates as follows to obtain samples θ( j) = [θ( j)
1 , . . . , θ( j)
d ]T.
For i = 1, . . . , d, draw θ( j)
i
from the conditional distribution
p

θi|θ( j)
1 , . . . , θ( j)
i−1, θ( j)
i+1, . . . , θ( j)
d , Y

It is known that under regularity conditions [86–89]:
1. The distribution of θ( j)
i
converges geometrically to p[θ|Y], as j →∞;
2. (1/J) J
j=1 f (θ( j))
a.s.
−→
9
f (θ)p[θ|Y] dθ, asJ →∞, for any integrable function f .
Hence, the marginal a posteriori distribution of any parameter θi can be computed easily from the
samples drawn by the Gibbs sampler.

APPROXIMATION OF OPTIMUM MULTIUSER RECEIVER
401
7.13.7
Prior distributions
For simplicity, we choose the sampling space, the set of unknown parameters sampled by the Gibbs
sampler, to be {D, H, σ 2}, which are assumed to be independent of each other. Next, we specify their
prior distributions p[H], p[σ 2] and p[D].
1. For the unknown channel hk, a complex Gaussian prior distribution is assumed
p[hk] ∼Nc(hk,0, k0)
(7.148)
Note that large value of k0 corresponds to less informative prior distributions.
2. For the noise variance σ 2, an inverse chi squared prior distribution is assumed
p[σ 2] ∼χ −2(2ν0, λ0)
(7.149)
a small value of 2ν0 corresponds to the less informative prior distributions.
3. The data bit sequence dk is a Markov chain, encoded from bk. Its prior distribution can be
expressed as
p[dk] = p(dk[1])p(dk[2]dk[1]) · · · p(dk[2PM]dk[2PM −1])
= p(dk[1])p(bk[1] = dk[2]dk[1])
· · · p(bk[2PM −1] = dk[2PM]dk[PM −1])
(7.150)
= 1
2
PM
:
n=2
exp(ρk[n −1]dk[n −1]dk[n])
1 + exp(ρk[n −1]dk[n −1]dk[n])
where ρk[n] denotes the a priori log likelihood ratio (LLR)of bk[n],
ρk[n]
= log P(bk[n] = +1)
P(bk[n] = −1)
(7.151)
Note that in Equation (7.150), we set p(dk[1]) = 1/2 to account for the phase ambiguity in
dk[1].
7.13.8
Conditional posterior distributions
The following conditional posterior distributions are required by the Bayesian multiuser detector.
The derivations can be found in Appendix 7.1 [83].
1. The conditional distribution of the kth user’s channel response hk given σ 2, D, Hk, and Y is
p[hk|D, σ 2, Hk, Y] ∼Nc(hk∗, k∗)
(7.152)
where Hk = H\hk with
−1
k∗
= −1
k0 + 1
σ 2
M−1

i=0
WHXkH
i Xk
i W
= −1
k0 + 2MN
σ 2 I2L
(7.153)
and
hk∗
= k∗

−1
k0 hk0 + 1
σ 2
M−1

i=0
WkHXk
i

yi −

l̸=k
Xl
iWlhl




(7.154)
Equation (7.153) follows from the orthogonality property in Equation (7.143).

402
OFDM AND MULTICARRIER CDMA
2. The conditional distribution of the noise variance σ 2 given H, D, and Y is given by
p[σ 2 | H, D, Y] ∼χ −2

2[ν0 + MN], ν0λ0 + s2
ν0 + 2MN

(7.155)
with
s2 =
M−1

i=0
88888yi −
K

k=1
Xk
i Wkhk
88888
2
(7.156)
3. The conditional distribution of the data bit dk[n], given H, σ 2, Dk
n and Y can be obtained from
P

dk[n] = +1 | H, σ 2, Dk
n, Y

P

dk[n] = −1 | H, σ 2, Dk
n, Y

= exp

dk[n + 1]ρk[n] + dk[n −1]ρk[n −1] −s2
σ 2

(7.157)
where Dk
n
= D\dk[n] and
s2 =
88888yi[p] −

l
Xl
iW[p]hl
88888
2
sk
i, j [p]=+1
−
88888yi[p] −

l
Xl
iW[p]hl
88888
2
sk
i, j [p]=−1
(7.158)
On the right-hand side of Equation (7.157), the ﬁrst two items correspond to the prior infor-
mation of the differentially encoded bits D, through which the prior information of data bits B
is incorporated.
7.13.9
Gibbs multiuser detection
Given the initial values of the unknown quantities {H(0), σ 2(0), D(0)} drawn from their prior distributions
(Equations 7.148–7.150), at the jth iteration, the Gibbs multiuser detector operates as follows.
1. For k = 1, . . . , K, draw hk( j) from p[hk | Hk( j−1), σ 2( j−1), D( j−1), Y], given by Equation (7.152),
with Hk( j−1) ={h1( j), . . . , h(k−1)( j), h(k+1)( j−1), . . . , hK( j−1)}];
2. Draw σ 2( j) from p[σ 2 | H( j), D( j−1), Y] given by Equation (7.155);
3. For
n = 1, . . . ,
2PM,
and
for
k = 1, . . . , K,
draw
dk( j)[n]
from
P[dk[n] |
H( j), σ 2( j), Dk( j−1)
n
, Y]
given
by
Equation
(7.157),
where
Dk( j−1)
n
= {d1( j)[1], . . . ,
d1( j)[2PM], . . . , dk( j)[n −1], dk( j−1)[n + 1], . . . , d K( j−1)[2PM]}.
To ensure convergence, the Gibbs iteration is usually carried out for (J0 + J) iterations. The initial
J0 iterations represent the burn-in period and only the samples from the last J iterations are used to
calculate the Bayesian interference. In particular, the posterior distribution of the multiuser data bits
bk[n] can be obtained by
P[bk[n] = +1|Y] ∼= 1
J
J0+J

j=J0+1
δ( j)
kn ,
k = 1, . . . , K;
n = 1, . . . , 2PM −1
(7.159)
where δ( j)
kn is an indicator such that
δ( j)
kn =
1
1,
if dk( j)[n]dk( j)[n −1] = +1
0,
if dk( j)[n]dk( j)[n −1] = −1
(7.160)

APPROXIMATION OF OPTIMUM MULTIUSER RECEIVER
403
7.13.10
Sampling space of data
As we are interested in computing the posterior probabilities of the multiuser data bits, direct sampling
can be done on the data bits B. Note that the conditional posterior distribution of bk[n], given H, σ 2,
Bk
n and Y, involves a large number of received signals, i.e. {yi, . . . , yM−1}. This long memory in the
receiver signal processing will increase the computational complexity and decrease the convergence
speed of the Gibbs procedure. To avoid these disadvantages, the Gibbs procedure described in this
section samples the differentially encoded bits D, and outputs a sampling sequence {dk( j)[n]}. It is
shown in Equation (7.159) that the marginal posterior probability of bk[n] can be computed easily
from the output samples {dk( j)[n]}.
7.13.11
The orthogonality property
The dominant computations involved in the Gibbs sampler are Equations (7.153–7.154) By exploiting
the orthogonality property, Equation (7.143), in STBC MC CDMA systems, the matrix −1
k∗in
Equation (7.153) is simply a constant matrix. In addition to this, with no matrix inversion involved in
computing hk∗, the numerical stability is also improved.
7.13.12
Blind turbo multiuser receiver
In this section, we consider employing iterative multiuser detection and decoding to improve the
performance of the Bayesian multiuser receiver in a coded STBC MC CDMA system. Because it
utilizes the a priori bit probabilities, and it produces the a posteriori bit probabilities, the Bayesian
multiuser detector is well suited for iterative processing, which allows the multiuser detector to
reﬁne its processing based on the information from the decoding stage and vice versa. The kth user’s
transmitter structure is shown in Figure 7.60, with block of information bits {ak[l]} encoded using
some channel code (e.g. block code, convolutional code or turbo code). A code bit interleaver is used
to reduce the inﬂuence of error bursts at the input of the channel decoder. The interleaved code bits
are then mapped to BPSK symbols {bk[n]}. These BPSK symbols are differentially encoded to yield
the symbol stream {dk[n]}, which is then serial-to-parallel converted and reorganized in to a vector
form as {sk
i, j} to feed into the STBC encoder followed by the MC CDMA modulator, and ﬁnally
transmitted from two antennas.
An iterative (turbo) receiver structure is shown in Figure 7.61. It consists of two stages: the
Bayesian multiuser detector developed in the previous sections, followed by a soft-input soft-output
channel decoder. The two stages are separated by a deinterleaver and an interleaver. Assume that
{bk[n]} is mapped into {bk[π(n)]} after deinterleaving.
In the ﬁrst stage, the blind Bayesian multiuser detector incorporates the a priori information
{λp
2 (bk[n])}, which is computed by the channel decoder in the previous iteration. At the ﬁrst iteration,
it is assumed that all code bits are equally likely. At the output of the blind Bayesian multiuser
detector, the a posteriori LLR is given by
Λ1(bk[n])
= log P[bk[n] = +1|Y]
P[bk[n] = −1|Y]
(7.161)
 dn
k/si
k
si,
k
1
si,
k
2
STBC
encoder
MC-CDMA mod
MC-CDMA mod
S/P
bn
k
al
k
Channel
encoder
BPSK
mod
Diff
encoder
Π
Figure 7.60 Transmitter structure of the kth user in an STBC MC CDMA system employing
outer channel code, where  represents an interleaver.

404
OFDM AND MULTICARRIER CDMA
{ yi }
Π
Π
Π
-1
Blind
Bayesian
multiuser
detector
Π-1
+
+
+
+
Channel
decoder
Channel
decoder
Π
Π
-1
Λ1[b1[n]]
Λ
Λ
1[b2[n]]
1[bK[n]]
Λ
Λ
Λ
2[b1[π(n)]]
2[b2[π(n)]]
2[bK[π(n)]]
λ2[b1[π(n)]]
λ2[b2[π(n)]]
λ2[bK[π(n)]]
Channel
decoder
+
+
-
-
-
Figure 7.61 Turbo Bayesian multiuser receiver structure, where  denotes an interleaver
and −1 denotes the corresponding deinterleaver.
According to the ‘turbo principle’ described in Chapter 2, the a priori information {λp
1 (bk[n])} should
be subtracted from the a posteriori LLR Λ1(bk[n]) to obtain the extrinsic information to deliver to
the channel decoders. However, the posterior distribution delivered by the blind Bayesian multiuser
detector is a quantized value instead of the true value, due to the ﬁnite number of samples. Therefore,
to ensure numerical stability, the posterior LLR Λ1(bk[n]) is regarded as the approximated extrinsic
information, deinterleaved and fed back to the channel decoder of the kth user.
The soft-input soft-output channel decoder, using the MAP decoding algorithm (Appendix 7.1),
computes the a posteriori LLR of each code bit of the kth user
Λ2(bk[π(n)])
= log
P

bk[n] = +1 |
3
Λp
1 (bk[π(i)])
4PM−1
i−1

P

bk[n] = −1 |
3
Λp
1 (bk[π(i)])
4PM−1
i−1

= λ2(bk[π(n)]) + Λp
1 (bk[π(n)])
(7.162)
It is seen from Equation (7.162) that the output of the MAP decoder is the sum of the prior information
Λp
1 (bk[π(n)]), and the extrinsic information λp
2 (bk[π (n)]) delivered by the channel decoder. After
interleaving, the extrinsic information delivered by the channel decoder {λp
2 (bk[n])}PM−1
n=1
is then fed
back to the blind Bayesian multiuser detector as the reﬁned prior information ρk[n] [see Equation
(7.151)] for the next iteration.
7.13.13
Decoder-assisted convergence assessment
Although it is desirable to have the Gibbs sampler reach convergence within the burn-in period
(J0 iterations), this may not always be the case. Hence, we need some mechanism to detect the
convergence. In the coded system considered here, the blind multiuser detector is followed by a
bank of channel decoders, we can assess convergence by monitoring the number of bit corrections
made by the channel decoders [90]. The number of corrections is determined by comparing the signs
of the code bit LLR at the input and output of the MAP channel decoder. If this number exceeds
some predetermined threshold, then we decide convergence is not achieved, in which case, the Gibbs
multiuser detector will be applied again to the same data block.
7.13.14
Performance example
In this section, we present some computer simulation results to illustrate the performance of the
Bayesian multiuser receivers in the STBC MC CDMA system, where there are two transmitter

PARALLEL INTERFERENCE CANCELLATION IN OFDM SYSTEMS
405
6
8
10
12
14
10
−5
10
−4
10
−3
10
−2
10
−1
WER
SU-WER
BER
SU-BER
BER, WER
Users
Uncoded STBC MC CDMA system, SNR = 10 dB
Figure 7.62 BER and OFDM WER of an STBC MC CDMA system in two-tap frequency
selective fading channels, where N = 16, G = 16, L = 2, SNR = 10 dB.
antennas, one receiver antenna, N subcarriers and K users. The signal parameters are the same
as in [83]. All spreading sequences used in simulations are randomly and independently generated
for each transmitter antenna of each user. The frequency selective fading channels are assumed to
be uncorrelated and have the same statistics for different transmitter–receiver antenna pairs. For
simplicity, all L taps of a particular fading channel are assumed to be of equal power and normalized
such that 2
j=1 ||h j||2 = 1, and have delays τi = (l/ f ),l = 0, 1, . . . , L −1; and all K users in the
system are assumed to have equal transmission power. Such a system setup is also the worst case
scenario from the interference mitigation point of view (Chapter 5). For STBC MC CDMA systems
employing outer channel codes, a four-state, rate-1/2 convolutional code with generator (5,7) in
octal notation is chosen for all users. For each block of received signals, J0 + J = 100 samples are
drawn by the Gibbs sampler, with the ﬁrst J0 = 50 samples discarded. As discussed in the previous
section, at the end of the 100 Gibbs iterations, the convergence of the Gibbs sampler is tested. In very
few cases, when the Gibbs sampler is not convergent, it is restarted for another round of 100 Gibbs
iterations.
The performance is demonstrated in two forms: one (Figure 7.62) is in terms of the bit error rate
(BER) and OFDM word error rate (WER) versus the number of users at a particular signal to noise
ratio (SNR), where SNR = (1/σ 2) [cf. Equation (7.142)]; the other (Figure 7.63) is in terms of the
BER/WBR versus SNR for the system with a particular number of users. Figure 7.62. demonstrates the
expected effects of a multiuser detector where BER does not change signiﬁcantly with the increase in
the number of users. These curves are rather close to the single user (SU) case which is also expected.
7.14
PARALLEL INTERFERENCE CANCELLATION IN OFDM SYSTEMS IN
TIME-VARYING MULTIPATH FADING CHANNELS
In order to increase the system capacity the 4G systems will try to bring as much as possible of WLAN
technology into cellular wireless networks with high mobility. Time varying multipath channel will
generate inter-channel interference (ICI) and how to deal with this problem in a systematic way will
be the topic of the next few sections.

406
OFDM AND MULTICARRIER CDMA
−2
−1
0
1
2
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
BER, Iter#1
BER, Iter#3
BER, Iter#5
BER, SU-LB
FER, Iter#1
FER, Iter#3
FER, Iter#5
FER, SU-LB
BER, WER
SNR
Coded STBC MC CDMA system, User 12/16
Figure 7.63 BER and OFDM WER of an STBC MC CDMA system employing outer
convolutional channel code in ﬁve-tap frequency selective fading channels,
where N = 256, G = 16, L = 5, K = 12.
In this section we further specify the notation introduced in Section 7.1. The sequence Sn(m) (the
frequency-domain symbol) is fed to an IDFT, producing the OFDM signal sn(k) (the time-domain
symbol) with:
sn(k) = IDFT{Sn(m)} = 1
N
N−1

m=0
Sn(m)e
j2πkm
N
,
k = 0, . . . , N −1
(7.163)
The IDFT output sequence with the addition of the guard interval is:
sg
n (k) = sn(k + N −G)N,
0 ≤k ≤N + G −1
(7.164)
where G is the length of the guard interval and (k)N denotes the residue of k modulo N. As this
waveform is transmitted over the multipath channel, the received sampling data yg
n (k)at the kth
interval of the nth OFDM symbol can be expressed as:
yg
n (k) = sg
n (k) ∗hg
n(k, k) + vg
n(k) = =
k

l=0
sg
n (k −l)hg
n(k,l)
+
L

l=k+1
sg
n−1(k −l + N + G)hg
n(k,l) + vg
n(k)
(7.165)
where * denotes the convolution operation, L = [Tm/Ts] represents the maximum delay spread, vg
n(l)
the ambient channel noise, and hg
n(k,l) the equivalent discrete channel at position l and instant k.
After removal of the guard interval, we get:
yn(k) = yg
n (k + G) =
L

l=0
sn(k −l)Nhn(k,l) + vn(k);
0 ≤k ≤N −1
(7.166)

PARALLEL INTERFERENCE CANCELLATION IN OFDM SYSTEMS
407
where hn(k,l) = hg
n(k + G,l) and vn(k) = vg
n(k + G). The DFT, at the receiver gives:
Yn(m) = DFT {yn(k)} =
N−1

k=0
yn(k)e−j2πkm
N
= 1
N
L

l=0
N−1

d=0
Sn(d)Hl
n(m −d)Ne−j2πkm
N
+ Vn(m) = αn(m, m)Sn(m) +
N−1

d=0,d̸=m
αn(m, d)Sn(d) + Vn(m),
za m = 0, . . . , N −1
(7.167)
where Hl
n(m −d)N is the frequency response of a time-varying muhipath channel with:
Hl
n(m −d)N =
N−1

k=0
hn(k,l)e−j2π(m−d)k
N
αn(m, d) = 1
N
L

l=0
Hl
n(m −d)Ne−j2πld
N
Vn(m) = DFT{vn(l)}.
(7.168)
Numerical analysis of these coefﬁcients shows that the frequency responses of a time-varying channel,
E
H 0
n (0)
. . . E
H 0
n (N −1)
, and the complex weighting coefﬁcients, E
αn(0, 0)
. . . E
αn(0, N −1)
,
for different Doppler spread cases, are in the lower frequency bands, and the weighting coefﬁcients
decay smoothly. That is, the ICI comes from only a few neighboring subcarriers. In the conventional
receivers the ICI is modeled as a white Gaussian process and (7.167) can be written as:
Yn(m) = αn(m, m)Sn(m) + Jn(m)
Jn(m) =
N−1

d=0,d̸=m
αn(m, d)Sn(d) + Vn(m)
(7.169)
A conventional equalization method uses a one-tap equalizer to equalize the distorted samples and,
the symbol samples are equalized by wn(m) as:
zn(m) = wn(m)Yn(m),
m = 1, . . . , N −1
(7.170)
and, the decision dec(*) output is ˆSn(m) = dec(zn(m)).
The zero-forcing (ZF) and the MMSE solutions can be obtained as:
wn(m) =
1
αn(m, n)
(7.171a)
and
wn(m) =
α∗
n(m, m)
|αn(m, m)|2 +
σ 2
J
ES
(7.171b)
respectively, where σ 2
J is the variance of noise Jn(m) and ES is the variance of the transmitted data
symbols. Note that the MMSE solution reduces to the ZF solution for σ 2
J = 0. In the case of a rapidly
time-varying channel, the adaptation of the equalizer’s tap coefﬁcients has to be carried out via a
channel estimator. Pilot-based correction is an efﬁcient method for this, and several types of pilot
arrangement for time-frequency domains have been studied. If the equalizer considers the ICI as
an additive Gaussian random process, the performance of equalizer degrades signiﬁcantly for larger
channel variation. As will be demonstrated latter, a parallel interference cancellation (PIC) equalizer
consisting of a set of preﬁlters in the ﬁrst stage and a set of ICI cancellation ﬁlters in the second stage,
will perform better. In order to subtract the ICI term from the symbol Yn(m), we need to know all
the symbols Sn(j) ( j ̸= m) of the ICI term. However, we cannot get prior knowledge of the symbols
of the ICI term. In order to obtain the accurate symbols of the ICI term, the received signal vector
Yn(m) is fed to the preﬁlter to obtain an initial decision in the ﬁrst stage. Then, the initial decision is
fed to the ICI cancellation ﬁlter to cancel the ICI term in the second stage, as shown in Figure 7.64.

408
OFDM AND MULTICARRIER CDMA
First stage
Second stage
From other subcarries
p
w
( )
nz
p
Σ
1
p
w +
Σ
NT
( )
ˆ
n
S
p
′
(
)
ˆ
1
n
S
p
′
+
( )
1
p
w
p
+′
pth subcarrier
P+1th subcarrier
( )
n
S
p
(   )
n
S    p
(
)
1
n
S
p +
(        )
1
n
S
p +
From other subcarries
(
)
1
nz
p +
NT
nY
(
)
1
p
w
p
′
+
Figure 7.64 Parallel interference canceller (PIC) equalizer.
For the pth subcarrier, in the ﬁrst stage of PIC equalization the sampled signal vector,
(Yn(0), . . . , Yn(N −1), is fed to the preﬁlter wp(m). The preﬁlter output zn(p) at the nth symbol
interval is:
zn(p) =
N−1

m=0
Yn(m)wp(m) =
N−1

m=0
αn(m, p)Sn(p)wp(m)
+
N−1

m=0
N−1

d=0,d̸=p
αn(m, d)Sn(d)wp(m) +
N−1

m=0
Vn(m)wp(m),
0 ≤p ≤N −1
(7.172)
The ﬁrst term is the desired signal, the second the ICI, and the third the noise. If the preﬁlters
compensate for the multiplicative distortion completely, the output signal zn(p) of the pth subcarrier
contains only the desired signal, ICI, and noise. Then, an initial decision is made as ˆS′
n(p), given by:
ˆS′
n(p) = dec(zn(p)),
p = 0, . . . , N −1
(7.173)
where dec() denotes the decision function.
In the second stage, the ICI cancellation ﬁlters utilize the initial decisions ˆS′
n(p); p = 1, . . . , K, to
cancel the ICI. For the pth desired subcarrier, the initial decisions ˆS′
n(d), for d = 1, . . . , p −1, p +
1, . . . , N, are passed through the ICI cancellation ﬁlters w′
p(d), where the subscript p denotes the pth
desired subcarrier and d = 1, . . . , N, d ̸= p denotes the input of the pth ICI cancellation ﬁlter from
the dth subcarrier’s initial decision. The ﬁnal decision is made in the second stage of PICs as:
˜Sn(p) = zn(p) +
N−1

d=0,d̸=p
ˆS′
n(d)w′
p(d) =
N−1

m=0
αn(m, p)Sn(p)wp(m)
+
N−1

d=0,d̸=p
N−1

m=0
αn(m, d)Sn(d)wp(m) + ˆS′
n(d)w′
p(d)

+
N−1

m=0
Vn(m)wp(m)
and
ˆSn(p) = dec
;<˜Sn(p)
=>
(7.174)

PARALLEL INTERFERENCE CANCELLATION IN OFDM SYSTEMS
409
The PIC equalizer is more complex to implement than is a one-tap equalizer. Since most of the energy
of the time-varying channel is concentrated in the neighborhood of the dc component in the frequency
domain, and the ICI term mainly comes from only a few neighboring subcarriers, the ICI terms that
do not signiﬁcantly affect Yn(m) in (7.167) can be ignored as:
αn(m, d) ≈0,
for
|m −d| > q
(7.175)
Therefore, we can simplify the PIC equalizer by using 2q + 1-taps’ preﬁlter and 2q-taps’ ICI cancel-
lation ﬁlter in each subcarrier. The outputs in the ﬁrst stage and the second stage become:
zn(p) =
p+q

m=p−q
Yn(m)wp(m) =
p+q

m=p−q
αn(m, p)Sn(p)wp(m)
+
p+q

m=p−q
N−1

d=0,d̸=p
αn(m, d)Sn(d)wp(m) +
p+q

m=p−q
Vn(m)wp(m)
(7.176)
˜Sn(p) = zn(p) +
p+q

d=p−q,d̸=p
ˆS′
n(d)w′
p(d) =
=
p+q

m=p−q
αn(m, p)Sn(p)wp(m) +
p+q

d=p−q,d̸=p

p+q

m=p−q
αn(m, d)Sn(d)wp(m)
+ ˆS′
n(d)w′
p(m)

+
p+q

m=p−q
N−1

d=0,d̸=p−q...p+q
αn(m, d)Sn(d)wp(m)
+
p+q

m=p−q
Vn(m)wp(m) ≈
p+q

m=p−q
αn(m, d)Sn(d)wp(m)
+
p+q

d=p−q,d̸=p

p+q

m=p−q
αn(m, d)Sn(d)wp(m) + ˆS′
n(d)w′
p(m)

+
p+q

m=p−q
Vn(m)wp(m)
(7.177)
In order to improve convergence, a cost function developed from the error signal is used. If error
signals are deﬁned as
e′
p,n = Sn(p) −zn(p) = Sn(p) −yT
p,nWp
ep,n = Sn(p) −˜Sn(p) = Sn(p) −

yT
p,nWp + ˆS′T
p,nW′
p

where
yp,n = [Yn(p −q), . . . , Yn(p + q)]T
ˆS′
p,n = [ˆS′
n(p −q), . . . , ˆS′
n(p −1), ˆS′
n(p + 1), . . . , ˆS′
n(p + q)]T
Wp = [w(p −q), . . . , w(p + q)]T
W′
p = [w′(p −q), . . . , w′(p −1), w′(p + 1), . . . , w′(p + q)]T .
(7.178)
then, under the assumption of perfect decision, the MSE cost function has the following form
Up,n = γ E
3e′
p,n
24
+ (1 −γ )E
3e′
p,n
24
= γ [ESI −RsyWp −WH
p RH
sy + WH
p RyyWp]
+ (1 + γ )[ESI −RsyWp −WH
p RH
sy + WH
p RyyWp + WH
p RysW′
p
+ W′ H
p RysWp + EsW′ H
p W′
p],
(7.179)

410
OFDM AND MULTICARRIER CDMA
with 0 ≤γ ≤1 for p = 0, . . . , N −1, where E{} denotes the expectation operation, ES is the
variance of transmitted data symbols, Ryy = E[y∗
p,nyT
p,n] = ES
N−1
d=0 R(d) + σ 2
V I and:
R(d) =


|αn(p −q, d)|2
.
α∗
n(p, d)αn(p −q, d)
.
α∗
n(p + q, d)αn(p −q, d)
. . . .
.
. . . .
.
. . . .
α∗
n(p −q, d)αn(p + q, d)
.
α∗
n(p, d)αn(p + q, d)
.
|αn(p + q, d)|2


Rys = E
-
y∗
p,nST
p,n
.
= ES


α∗
n(p −q, p −q)
.
α∗
n(p, p −q)
.
α∗
n(p + q, p −q)
. . .
.
.
.
. . .
α∗
n(p −q, p −1)
.
α∗
n(p, p −1)
.
α∗
n(p + q, p −1)
α∗
n(p −q, p + 1)
.
α∗
n(p, p + 1)
.
α∗
n(p, p + 1)
. . .
.
.
.
. . .
α∗
n(p −q, p + q)
.
α∗
n(p, p + q)
.
α∗
n(p + q, p + q)


Rsy = E
-
SH
n (p)yT
p,n
.
= ES
- αn(p −q, p) . . . αn(p, p) . . . αn(p + q, p) .
(7.180)
MMSE solution is derived from ∂Up,n/∂Wp = 0 and ∂Up,n/∂W′p = 0 resulting in
∂Up,n
∂Wp
= γ
;
−2RH
sy + 2RyyWp
>
+ (1 + γ )
;
−2RH
sy + 2RyyWp + 2RysW′
p
>
= 0
∂Up,n
∂W′p
= (1 −γ )
;
2RH
ysWp + 2ESW′
p
>
= 0
(7.181)
So, the MMSE optimum tap coefﬁcients estimates are
Wpopt =

Ryy + (γ −1)
RysRH
ys
ES

RH
sy
;
W ′
popt = −RH
Y S
ES
Wpopt .
(7.182)
In order to compute WPopt and W’Popt accurately, we need to know the impulse response of the
channel.
Performance curves are shown for the following simulation scenario. The data modulation scheme
is 16-QAM and the total number of subcarriers is N = 64. A frequency-selective Rayleigh channel is
generated by using Jake’s model for two-path with a multipath spread of 2 µs. The carrier frequency
is 5 GHz, the symbol rate of 16-QAM is 0.47 Msymbols/s (bit rate is 1.88 Mb/s). The OFDM block
is composed of 68 samples, among them one for cyclic preﬁx and three for pilot signals (Np = 1).
The relative velocity between the transmitter and receiver is up to 216 km/h, resulting in fdmax NTs
equal to 0.032 for 54 km/h, 0.064 for 108 km/h, and 0.128 for 216 km/h.
Figure 7.65(a) shows the ratio of MSE1 over MSE2 versus γ , where MSE1, is at the output of the
preﬁlters, and MSE2 is at the output of the ICI cancellation ﬁlters. MSE1 represents the performance
0
1
2
3
4
5
0.1
0.2
0.3
0.4
0.5    
0
1
2
3
4
5
6
0.1
0.2
0.3
0.4
0.5
(a)
(b)
Figure 7.65 Simulation results of SER and MSE1/MSE2 versus γ for fdmax NTS = 0.032
and q = 1.

ZERO FORCING OFDM EQUALIZER IN TIME-VARYING MULTIPATH FADING
411
ˆnS′
ˆnS
ˆnS′
ˆnS
(a)
(b)
Figure 7.66 Simulation results of SER and MSE1/MSE2 versus γ for fdmax NTS = 0.128
and q = 2 performance.
of the initial decision of the equalizer and MSE2 represents the performance of the overall equalizer.
Figure 7.65(b) presents the symbol error rate for the two cases. Figure 7.66 shows the same parameters
for higher Doppler.
7.15
ZERO FORCING OFDM EQUALIZER IN TIME-VARYING MULTIPATH
FADING CHANNELS
Samples of an OFDM signal, implemented by an inverse fast Fourier transform (IFFT), can be
expressed as follows:
xn =
N−1

m=0
Xme j2πnm/N
0 ≤n ≤N
(7.183)
where xn represents the nth sample of the output of the IFFT. For the multipath fading channel
consisting of L discrete paths, the received signal can be written as:
yn =
L−1

l=0
hn,lxn−l + wn = hn,0xn + hn,1xn−1 + . . . + hn,L−1xn−L+1 + wn
which after FFT becomes:
Ym =
N−1

k=0
L−1

l=0
Xk H (m−k)
l
e−j2πlk/N + Wm =
=
L−1

l=0
H 0
l e−j2πlm/N

Xm +
N−1

k̸=m
L−1

l=0
Xk H (m−k)
l
e−j2πlk/N + Wm =
= αm Xm + βm + Wm, 0 ≤m ≤N −1
(7.184)
where Wm denotes the FFT of wn, and H (m−k)
l
represents the FFT of a time-variant multipath channel
hn,l given as :
H (m−k)
l
= 1
N
N−1

n=0
hn,le−j2πn(m−k)/N
(7.185)
Here, αm and βm represent the multiplicative distortion at the desired subchannel and the ICI,
respectively. If the channel is assumed to be time invariant during a block period, H (m−k)
l
in Equation
(7.185) vanishes, implying that there exists no ICI for time-invariant channels. In this case, Ym in
Equation (7.184) contains only the multiplicative distortion, which can be easily compensated for by
a one-tap frequency-domain equalizer.

412
OFDM AND MULTICARRIER CDMA
In the general case where the multipath channel cannot be regarded as time invariant during a
block period, Equation (7.184) can be expressed in vector form as:
Y = HX + W
(7.186)
where Y = [Y0, . . . , YN−1]T , X = [X0, . . . , X N−1]T , W = [W0, . . . , WN−1]T , and:
H =


a0,0
a0,1
. . .
a0,N−1
a1,0
a1,1
. . .
a1,N−1
.
.
. . .
.
aN−1,0
aN−1,1
. . .
aN−1,N−1


(7.187)
Here, am,k in Equation (16.187) is deﬁned as
am,k = H (m−k)
0
+ H (m−k)
1
e−jπk/N + · · · + H (m−k)
L−1 e−jπk(L−1)/Nm
0 ≤(m, k) ≤N −1
(7.188)
In order to solve for X in (7.186), we need to estimate the channel matrix H and calculate its matrix
inverse. Since H can have a large size, it is difﬁcult to process in real time. For that reason, similar
approximations like those indicated in the previous section in (7.175) will be used. Here we provide
additional arguments.
If the multipath fading channel is slowly time varying (e.g., fD = Tb • fD <0.1), the time
variations of the CIR, hn, j, for all L paths, can be approximated by straight lines with low slopes
during a block period Tb. For the channel with fD > 0.1, the assumption that the CIR varies in a linear
fashion during a block period no longer holds and gives rise to an error ﬂoor. When the multipath
fading channel is slowly time varying, the matrix equation in (7.186) can be greatly simpliﬁed. Since
most energy of the straight line with a low slope is concentrated in the neighborhood of the dc
component in the frequency domain, the ICI terms which do not signiﬁcantly affect Ym in (7.187)
can be ignored, i.e.:
am,k = 0
for
|m −k| > q/2
(7.189)
where q denotes the number of dominant ICI terms. Figure 7.67(a) shows the time variation of the
CIR in a block and Figure 7.67(b) the corresponding magnitude response (absolute value of the
Fourier transform) for three different Doppler frequencies. From this ﬁgure, one can see that the time
variation of the CIR can be approximated as a straight line, and most of the energy is concentrated in
1,2
1,4
1,6
1,8
2
2,2
2,4
2,6
2,8
0
16
32
48
64
80
96
112
128
Time
Magnitude
20 Hz
100 Hz
200 Hz
  
 
(a)                                                     (b)  
Figure 7.67 The characteristic of a CIR in a slowly time-varying environment. (a) Time
variation of the CIR for different Doppler frequencies within a block period,
and (b) corresponding magnitude responses for different Doppler frequencies.

ZERO FORCING OFDM EQUALIZER IN TIME-VARYING MULTIPATH FADING
413












x
x
x
x
x










x
x
x










x
x
x
x
x










x
x
x
x
x










x
x
x
x
x










0
1
2
N-q-
1
N-q












x
x
x
x
x
x
x










x
x
x
x
x
x
x










x
x
x
x
x
x
x










0
1
N-q












x
x
x
x
x










x
x
x










x
x
x
x
x










x
x
x
x
x










x
x
x
x
x










0
1
2
N-q-
1
N-q












x
x
x
x
x
x
x










x
x
x
x
x
x
x










x
x
x
x
x
x
x










0
1
N-q
Figure 7.68 Transformation of matrix H′ to H.
the neighborhood of the dc component. By using the approximation in Equation (7.189), we have:
H′ =


.
a0,0
a0,1
. . .
a0, q
2
0
.
.
.
0
.
a1,0
a1,1
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
a q
2 ,0
.
.
.
.
.
.
.
.
.
0
.
.
.
.
.
.
.
.
0
.
.
.
.
.
.
.
.
.
aN−1−q
2 ,N−1
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
aN−2,N−2
aN−2,N−1
.
0
.
.
.
0
aN−1,N−1−q
2
.
aN−1,N−2
aN−1,N−1
.


(7.190)
The matrix in Equation (7.190) has nonzero element around diagonal h′
i j ̸= 0, i −q/2 < j < i +
q/2. Since the matrix becomes a sparse matrix for q ≪N, it is not efﬁcient to calculate the matrix
inverse to estimate the transmitted sequence. By transforming the matrix H′ of order N × N to a block-
diagonal matrix H of order (N −q)(q + l) × (N −q)(q + l) as shown in Figure 7.68, we obtain:
H =


A0
.
.
0
.
A1
.
.
.
.
. . .
.
0
.
.
AN−1−q


(7.191)
where An is
An =


an,n
an,n+1
. . .
an,n+ q
2
0
. . .
0
an+1,n
an+1,n+1
. . .
.
. . .
an+ q
2 ,n
.
.
0
.
.
. . .
0
.
. . .
an+ q
2 ,n+ q
2
. . .
.
. . .
. . .
.
an+q−1,n+q−1
an+q−1,n+q
0
. . .
0
an+q,n+ q
2
. . .
an+q,n+q−1
an+q,n+q


(7.192)
and input–output relationship of the multipath channel becomes:
Y = HX + W
(7.193)
where
X
=
[X0 X1
. . .
X N−1−q]T ,
Xn = [Xn Xn+1
. . .
Xn+q]T
Y
=
[Y0 Y1
. . .
YN−1−q]T ,
Yn = [Yn Yn+1
. . .
Yn+q]T
W
=
[W0 W1
. . .
WN−1−q]T
and
Wn = [Wn Wn+1
. . .
Wn+q]T

414
OFDM AND MULTICARRIER CDMA
Multiplying (7.193) by the inverse of H, using is estimated value of H, gives:
˜X = ˜H−1Y →˜Xn = ˜A−1
n Yn,
0 ≤n ≤N −1 −q
(7.194)
where
˜H−1 =


˜A−1
0
0
˜A−1
1
. . .
0
˜A−1
N−1−q


Finally, the transmitted symbols ˜X q
2 +1, . . . , ˜X N−2−q
2 are estimated by selecting the elements in
the middle of ˜Xn,1 ≤n ≤N −2 −q(N ≫q). The remaining symbols ˜X0, . . . , ˜X q
2 ( ˜X N−1+ q
2 , . . . ,
˜X N−1) are estimated by taking the ﬁrst (last) q/2 elements of ˜X0( ˜X N−1−q).
The size of the matrix inverse is reduced to (q + 1) × (q + 1), implying that the transmitted
sequence can be obtained with a moderate amount of computational complexity for a small value of
q. Thus, the linear approximation assumption discussed in this paper has transformed a large-size (N)
matrix inverse problem into (N −q) small-size (q) matrix inverse problems. The solution (g = 2)
for the transmitted sequence in a multipath fading channel is listed in Table 7.12. The required
multiplications and additions for q = 2 are 6N + 2 and 3N respectively.
In order to construct the matrix equation in Equation (7.193), it is necessary to estimate the channel
matrix H. To demonstrate the effectiveness of the above equalizer for time-variant multipath channels,
the simulations were performed for the scenario similar to the one used to generate Figures 7.65 and
Table 7.12
Frequency-domain equalization (q = 3) for an OFDM system in
a multipath fading channel
˜X
˜X0 = (b0,0Y0 + b0,1Y1 + b0,2Y2)/0
.
.
˜Xn+1 = (bn+1,nYn + bn+1,n+1Yn+1 + bn+1,n+2Yn+2)/n
.
.
˜X N−1 = (bN−1,N−3YN−3 + bN−1,N−2YN−2 + bN−1,N−1YN−1)/N−2
n = ˜an,n ˜an+1,n+1 ˜an+2,n+2 −˜an,n ˜an+2,n+1 ˜an+1,n+2 −˜an+2,n+2 ˜an+1,n ˜an,n+1
b
˜a
b0,0
˜a1,1 ˜a2,2 −˜a1,2 ˜a2,1
b0,1
−˜a0,1 ˜a2,2
b0,2
˜a0,1 ˜a1,2
.
.
.
.
bn+1,n
−˜an+1,n ˜an−2,n+2
bn,n
−˜an,n ˜an+2,n+2
bn+1,n+2
−˜an,n ˜an−1,n+2
.
.
.
.
bN−1,N−3
˜aN−2,N−3 ˜aN−1,N−2
bN−1,N−2
−˜aN−2,N−3 ˜aN−1,N−2
bN−1,N−1
˜aN−2,N−3 ˜aN−2,N−2 −˜aN−3,N−2 ˜aN−2,N−2

CHANNEL ESTIMATION FOR OFDM SYSTEMS
415
 
                 (a)                                 (b)                                (c) 
 
Figure 7.69 BER for the two types of equalizers in time-variant channels with three dif-
ferent Doppler frequencies: (a) fD = 20 Hz, (b) fD = 100 Hz. (c) fD = 200
Hz.
7.66. A two-path fading channel with a multipath spread of 2 µs, bandwidth 500 kHz, carrier at 1
GHz, 64 subbands, the size of FFT became 64, OFDM block 68 samples, one for a cyclic preﬁx and
three for pilot signals (Np = 1), modulation 16-QAM, the data rate 1.88 Mb/s (64 subcarriers × 4
bits per symbol/136 µs), Doppler up to 200 Hz →fD = 0.272 % for 20 Hz, 1.36 % for 100 Hz, and
2.72 % for 200 Hz. Perfect carrier and symbol synchronizations were assumed.
The results for conventional frequency-domain equalizer, with one tap in an OFDM system which
compensates for the frequency-selectivity of a multipath fading channel, assuming that the channel
is stationary over the period of an FFT block, are denoted in Figure 7.69 by C.
The results for zero forcing equalizer, described in this section are denoted in Figure 7.69 by P.
7.16
CHANNEL ESTIMATION FOR OFDM SYSTEMS USING MULTIPLE
RECEIVE ANTENNAS
Figure 7.70 represents a block diagram of a space division multiple access (SDMA) uplink scenario,
as observed on an OFDM subcarrier basis. Each of the L users is equipped with a single transmit
antenna and the BS’s receiver has P-element antenna. For simplicity, we have omitted the subcarrier
index k (K subcarriers, k = 0, . . . , K −1). A decision-directed channel estimator (DDCE) aided
OFDM receiver is shown in Figure 7.71 and parallel interference canceller (PIC)-assisted channel
transfer function estimator in Figure 7.72.
The complex output signal x p[n, k] of the pth receiver-antenna element in the kth subcarrier of
the nth OFDM symbol is given by:
x p[n, k] =
L

i=1
H (i)
p [n, k]s(i)[n, k] + n p[n, k]
(7.195)
In vector notation, we have:
xp[n] =
L

i=1
S(i)[n]H(i)
p [n] + np[n]
(7.196)

416
OFDM AND MULTICARRIER CDMA
Receiver
+
+
+
User 1
User 2
User L
Channel
1n
2n
P
n
1x
2x
P
x
( )
1
s
( )
2
s
( )
L
s
( )
1
1
H
( )1
2
H
( )
1
P
H
( )
2
1
H
( )
2
2
H
( )
2
P
H
( )
1
L
H
( )
2
L
H
( )
L
P
H
 
Figure 7.70 SDMA uplink scenario.
FFT
Equalizer
Classifier
Channel
1
z−
[ ]
x n
[ ]
apr
H
n
[
]1
apr
H
n +
[ ]
[ ]
[ ]
ˆ
apr
x n
s n
H
n
=
[ ]
ˆs n
[ ]
ˆs n
[ ]
[ ]
(
)
2
/
ˆ
ˆ
ˆ
arg min
s
c
s
s n
s n
s
σ ∈
=
−
M
Tr. Func. 
Estim./Pred.
Figure 7.71 DDCE-aided OFDM receiver.
From Equation (7.196) an a posteriori (apt) estimate of the channel is:
˜H(i)
apt[n] =
⌣S
( j)−1
[n]

x[n] −
L

i=1
i̸= j
⌣S
(i)
[n]
⌢H
(i)
apr[n]


(7.197)
and its prediction (a priori channel transfer-factor estimation) as:
⌢H
(i)
apr[n] = f
; ˜H(i)
apt[n −1], . . . ˜H(i)
apt[n −N [t]
tap]
>
.
(7.198)

CHANNEL ESTIMATION FOR OFDM SYSTEMS
417
j-th userís 
estimator unit
Channel 
Tr. Pred
[ ]
x n
L
i
j
≠1
f =
( )[ ]
1
s
n
( ) [ ]
L
s
n
( ) [ ]
1
ˆ
apr
H
n
( ) [ ]
ˆ
L
apr
H
n
(
) [ ]
1
ˆ
L
s
n
( ) [ ]
1
ˆ j
s
n
−
( ) [
]
ˆ
1
j
apr
H
n +
( )[ ]
ˆ
j
apt
H
n
 
Figure 7.72 PlC-assisted channel transfer-function estimation.
with optimum predictor coefﬁcients obtained as:
˜c( j)
pre
opt =
-
R[t]( j) +
K0
Trace

γ [ f ]( j)I( j)
K0
 α j
σ 2
j
×

σ 2
j MSE
i
apr + σ 2
n

I
−1
· r[t]( j)
(7.199)
R[ f ](i)
apt
= E
3
˜H(i)
apt ˜H(i)
apt
4
,
MSE
( j)
apr[n] = 1
K Trace

R

⌢H
( j)
apr
[n]


⌢H
j
apr[n] = H j[n] −
⌢H
j
apr[n].
(7.200)
where R

⌢H
( j)
apr
[n] ∈CK×K denotes the autocorrelation matrix of the vector 
⌢H
( j)
apr[n] of a priori chan-
nel transfer-factor estimation errors. Matrix R[ f ](i) = E
<
H(i)H(i)=
and R[ f ](i) = U[ f ](i)[ f ](i)U[ f ](i)H.
γ [f ](j) is the decomposition of the jth user’s channel’s space-frequency correlation matrix R[f ](j) with
respect to the unitary transform matrix ˜U[ f ]( j), which is formulated as γ [ f ]( j) = ˜U[ f ]( j)R[ f ]( j) ˜U[ f ]( j),
and I( j)
K0 is a sparse identity matrix having unity entries only at those K0 number of positions, which
are associated with a signiﬁcant value of γ [f ](j). Hence, we note that the evaluation of Trace(γ [f ](j)
I( j)
K0) requires the knowledge of R[f ](j) which is not directly available in practice.
For the simulation results shown in Figure 7.73, four simultaneous equal-power OFDM users
with one transmit antenna and the same modulation scheme and a BS with four receiving antennas
were assumed. The channels between the different transmit antennas and each receiver antenna were
assumed to have the same Doppler power spectrum. For the channel’s space–time correlation function
the Jakes model is used, having an OFDM-symbol-normalized Doppler frequency of FD = 0.007,
which corresponds to a vehicular speed of 50 km/h, or equivalently, 31.25 miles/h in the context
of the indoor wireless asynchronous transfer mode (WATM) system’s parameters (see Section 7.4).
Furthermore, we considered ‘frame-invariant’ fading, where the fading envelope of each CIR-related
tap has been kept constant during each OFDM symbol’s transmission period.
The sparse identity matrix I( j)
K0 could be designed for retaining the ﬁrst K0 CIR-related coefﬁcients
of γ [f ](j)–rather than the K0 largest one–or alternatively, for retaining the ﬁrst K I
0 and the last K I I
0
CIR-related coefﬁcients of γ [f ](j), where K0 = K I
0 + K I I
0 .
The simulation results with the same parameters versus Doppler frequency are shown in Figure
7.74

418
OFDM AND MULTICARRIER CDMA
-40
-35
-30
-25
-20
-15
-10
0
5
10
15
20
25
30
35
40
a priori estimation MSE [dB] 
 
Figure 7.73 A priori channel-estimation MSE versus SNR performance PlC-assisted
DDCE, using the optimum recursive predictor coefﬁcients evaluated with
the aid of the iterative approach. Fr.-Inv. Fad. SWATM from Section 7.4. L
Rec.-Antennas, L Users, MPSK.
Figure 7.74 A priori channel-estimation MSE versus OFDM-symbol-normalized Doppler-
frequency performance exhibited by the PIC-assisted DDCB, using optimum
recursive predictor coefﬁcients. The predictor coefﬁcients were optimized for
˜FD = 0.05, using the iterative approach.
7.17
TURBO PROCESSING FOR AN OFDM-BASED MIMO SYSTEM
In this section we will discuss performance of a receiver using constrained list sphere decoder (CLSD)-
based soft-detector and the space-time bit-interleaved coded modulation (STBICM) approach.
Let H = [hn,m] ∈CN×Mdenote the MIMO channel matrix for the kth subcarrier, where hn,m
denotes the channel gain from the mth Tx antenna to the nth Rx antenna for subcarrier k. For

TURBO PROCESSING FOR AN OFDM-BASED MIMO SYSTEM
419
simplicity index k is dropped. A received data vector y for this subcarrier, can be written as:
y = Hx + w
(7.201)
where x = [x1x2]T is the 2 × 1 symbol vector transmitted on this subcarrier and w ∼N(0, σ 2IN) is
the additive white circularly symmetric complex Gaussian noise with variance σ 2.
We consider the general case of MIMO soft-detection where H is:
N × M. Let β = BM and b = [b1 b2. . . bβ]T , with bi ∈{−1, +1}, i = l, 2, . . ., β, be the bit vector
that maps to x. Then x can be expressed as x(b) to stress its dependence on b.
The bit metric for the ith bit, i = 1, 2, . . . , β, is deﬁned as:
lD(i) = ln P(bi = +1 |y, H)
P(bi = −1 |y, H)
(7.202)
which, by using the Bayes’ theorem, can be written as
lD(i) = ln P(bi = +1)
P(bi = −1) + ln P(bi = +1, H)
P(bi = −1, H)
=lA(i) + lE(i).
(7.203)
Here, lA (i) and lE (i) are referred to as the a priori and extrinsic information, respectively. The a priori
information can be obtained from the BCJR algorithm presented in Appendix 2.1, a soft-in/soft-out
decoder, and the extrinsic information can be calculated by the STBICM-based soft-detector:
lE(i) ≈1
2 max
b∈Bi,+1

−1
σ 2 ∥y −Hx(b)∥2 + bTIA −lA(i)
&
−
−1
2 max
b∈Bi,−1

−1
σ 2 ∥y −Hx(b)∥2 + bTIA + lA(i)
&
(7.204)
where Bi ,+1 and Bi ,−1 are the set of 2β −1 bit vectors with bi being +1 and −1, respectively, and IA =
[lA(1) lA(2) . . . lA(β)]T .
In the iterative decoding process, as shown in Figure 7.75, the a priori information lA(i) for the
MIMO detector i.e., the inner decoder, is obtained from the soft output of the BCJR decoder, i.e., the
outer decoder. Speciﬁcally, it is from the incremental soft information (denoted as LE in the ﬁgure)
due to the BCJR decoder. Similarly, the input for the BCJR decoder (denoted as LA in the ﬁgure) is
the deinterleaved extrinsic information lE, which is the incremental soft information from the MIMO
detector. The iterative decoding starts from the MIMO detection with the a priori information being 0.
The optimal but extremely inefﬁcient STBICM-based soft detector of Equation (7.204) can be
simpliﬁed by using list sphere decoder (LSD). The LSD-based soft-detector keeps the STBICM
framework while improving its efﬁciency by searching in much smaller subsets ˜Bi,+1 ⊂Bi,+1 and
˜Bi,−1 ⊂Bi,−1 with
 ˜Bi,+1
 ≪2β−1and
 ˜Bi,11
 ≪2β−1.
+
+
Semiblind 
ch estimator
FFT
Bank of 
MIMO 
Detectors
Inner part
Outer part
Data 
Sink
Deinterleaver
BCJR 
Decoder
Hard 
Decision
Interleaver
Al
E
L
A
L
D
L
Dl
El
y
Figure 7.75 Turbo processing for the OFDM-based MIMO system.

420
OFDM AND MULTICARRIER CDMA
The LSD-based soft detector is implemented in the following two steps.
(i) Obtain a set ˜B of vectors b, referred to as the candidate pool, which satisﬁes
 ∥y −Hx(b)∥2 ≤dl
∥y −Hx(b)∥2 > dl
∀b ∈˜B
∀b /∈˜B
(7.205)
by using the LSD algorithm with a ﬁxed sphere radius dl determined by the antenna numbers and
noise variance.
(ii) Calculate ˜Bi,+1 = Bi,+1 ∩˜B and ˜Bi,−1 = Bi,−1 ∩˜B for each i = 1, 2, . . ., β and obtain the bit
metric using Equation (7.204) with Bi,+1 and Bi,−1 being replaced by ˜Bi,+1 and ˜Bi,−1, respectively.
The LSD-based soft detector is orders of magnitude more efﬁcient than the STBICM-based soft
detector. However, this efﬁciency is obtained at the cost of some performance degradation due to
the limited candidate pool used by LSD. Due to the limited candidate pool, the a priori information
from the outer decoder can be quite poor. When the poor a priori information is used blindly without
being censored, the performance of the iterative processing can degrade with the increase in iteration
number.
The detection/decoding can be improved by constraining the a priori information from the outer
decoder. We follow the simple rules below to constrain the a priori information:
(R1) The larger the sphere radius, the larger the maximum allowable a priori information, denoted
lmax.
(R2) The larger the value of β, the smaller the maximum allowable a priori information lmax.
(R3) The higher the SNR, the larger the maximum allowable a priori information lmax.
R1 is chosen because for a given SNR and a given number of candidates in a sphere, the larger
the radius, the better the channel. We give more freedom or larger maximum allowable a priori
information lmax to a better channel. R2 is chosen because the more complicated the constellation
and the larger the number of transmitted symbols, the larger the bT lA. We put more constraint on the
maximum allowable value of lA to prevent the value of bT lA from growing too large. Finally, R3 is
chosen because the higher the SNR or the smaller the noise variance σ 2, the more trust we can put
on the larger a priori information from the outer decoder.
Based on the aforementioned rules, the value of the a priori information for our MIMO system is
constrained as:
lmax =
d
min{1, kCσ 2}
(7.206)
where d is the radius of the sphere and kC is a constant related to β. For example, for 64-QAM,
we choose kC = 4 × 42 for above MIMO system, where 42 is the average power of the 64-QAM
constellation. We choose d so that the sphere contains ﬁve candidates.
Once we have determined the maximum allowable a priori information lmax, we can constrain the
a priori information from the outer decoder
l(C)
A
=

lA,
max{lA} ≤lmax
lmax
max{lA}lA, max{lA} > lmax
(7.207)
This constraining scheme in Equation (7.207) is by no means the best; however, it is very simple and
can lead to excellent results in WLAN applications. We also clip the soft outputs of the CLSD-based
soft detector (by ±50) in addition to constraining the a priori information.
Some performance illustrations are given in Figure 7.76
7.18
PAPR REDUCTION OF OFDM SIGNALS
It has been already pointed out in Section 7.10 that nonlinear effects can cause clipping of OFDM
signal due to a large peak-to-power ratio (PAPR). In fading channels, this problem becomes even

PAPR REDUCTION OF OFDM SIGNALS
421
 
Figure 7.76 PER versus SNR for the MIMO and SISO systems at the 108- and 54-Mbps
data rates, respectively.
more serious. A possible technique for PAPR reduction in orthogonal frequency division multiplexing
(OFDM) systems is utilization of signal scrambling. Golay sequences (with dual capabilities of error
correction and peak reduction) [91] and partial transmit sequences (PTS) [92, 93] have been suggested
for these purposes. Computation of optimal PTS weight factors via exhaustive search requires expo-
nential complexity in the number of subblocks; consequently, many suboptimal strategies have been
developed.
Suboptimal PTS strategies include the following. The iterative ﬂipping algorithm (FA) [94] has
complexity linearly proportional to the number of subblocks, and each phase factor is individually
optimized regardless of the optimal value of other phases. A neighborhood search is proposed in [95]
using gradient descent search. In [96] dual layered phase sequencing is used to reduce complexity, at
the price of PAPR performance degradation. In [93] a suboptimal strategy is developed by modifying
the problem into an equivalent problem of minimizing the sum of phase-rotated vectors. An initial
set of phase vectors is computed by reducing the peak amplitude of each sample and the best phase
vector of the set is chosen as the ﬁnal solution. Finally, [97] gives an orthogonal projection-based
approach for computing PTS phase factors.
In this section we present an efﬁcient algorithm for computing the optimal PTS weights that has
lower complexity than does exhaustive search.
For the system model, let X = [X1,. . ., XN]T be a block of N symbols being transmitted, where
each symbol is modulated to one of the carrier frequencies {fn, n = 1, . . ., N} where fn = nf, f =
1 / NT and T is the signal period. The complex envelope of the transmitted signal is:
x(t) =
1
√
N
N

n=1
Xne j2π fnt
0 ≤t < NT
(7.208)
where j = √
−1. The PAPR of the OFDM signal x(t) is deﬁned as:
PAPR = max |x(t)|2
E
-|x(t)|2. .
(7.209)
E[|x(t)|2] = 1 for unitary signal constellations. The signal in Equation (7.208) can be oversampled
by generating LN samples, where L > 1 is the oversampling factor. These samples can be computed
by using appropriate zero-padding and using an inverse fast Fourier transform (IFFT).

422
OFDM AND MULTICARRIER CDMA
In the PTS approach, X is divided into M disjoint sub-blocks Xm (1 ≤m < M) of length U where
N = MU for some integers M and U. For m = 1, . . ., M, let [R1,m, . . ., RLN,m]T be the zero-padded IFFT
of Xm (all zeros except for the block m). PTS combines phase-rotated versions of these sub-block
IFFTs in order to minimize the PAPR. The signal samples at the PTS output can be written as:
x′ =


R1,1
R1,2
. . .
R1,M
R2,1
R2,2
.
. . .
.
RLN,1
.
.
RLN,M


(
)*
+
R
·


b1
b2
. . .
bM


( )* +
b
(7.210)
where x’ = [x1‘, . . ., xLN‘] is the block of optimized signal samples. The optimization problem is to
ﬁnd optimum phases bi according to:
{b∗
1, . . . ., b∗
M} = arg min
( )* +
{b1,....,bM }

max
()*+
1≤k<LN

M

m=1
bm Rk,m



(7.211)
where bi ∈P =
3
e
j2πk
q , k = 0, . . . ., q −1
4
. The last phase factor can be ﬁxed (bM = 1) without loss
of generality. Therefore, q M−1distinct possible vectors b should be tested to solve Equation (7.211).
Accordingly, in an exhaustive search approach, the computational complexity increases exponentially
with the number of sub-blocks.
The optimization algorithm that solves Equation (7.211) with lower complexity, is motivated by
the shortest vector problem (SVP) in a lattice [100]. An M-dimensional lattice is the set of vectors
(lattice points) {Ab |bi ∈Z}, where b = (b1, . . . , bM) and the columns of matrix A ∈RN×M are called
the basis for the lattice. The SVP requires ﬁnding the shortest non-zero vector in the lattice, where
the length can be measured in any lp (p ≥1) norm. The lp norm of a vector x = (x1, x2, . . . , xN)
is deﬁned as ∥x∥p =
; |xi|p>1/p and ∥x∥∞= maxi |xi|. Fincke and Phost [98] have developed an
efﬁcient algorithm for SVP in l2(i.e., Euclidean distance) by enumerating all the lattice points inside
a sphere centered at the origin. This is one example of sphere decoding that has wide application in
communication problems (see [99] for a detailed survey). The signal vectors (7.210) can be interpreted
as lattice points generated by R. However, (7.211) is equivalent to the SVP in l∞norm. As such,
the original Fincke–Phost sphere decoder (FPSD) cannot be directly applied to problem at hand.
Nevertheless, the basic premise of FPSD – to generate only lattice points x for which ∥x∥2 ≤µ – can
be adapted; consequently, only lattice points for which ∥x∥∞≤µ are generated, and this is equivalent
to |xk| ≤µ ∀k. We refer to this as a sphere decoder based algorithm (SDBA) (see Appendix 4.2 or
[100]).
Let x′ = [x′
1, · · · , x′
LN] be deﬁned as in Equation (7.210) and let Rk represent the kth row of the
matrix R. Then each element of x′ can be expressed as x′
k = Rk · b. To ﬁnd the PAPR of the OFDM
signal, the amplitude of x′
k is computed according to
|x′k|2 = x′ H
k · x′k = bH · RH
k · Rk · b
= bH ·
-
RH
k · Rk + α2I
.
(
)*
+
Ak
·b −α2bH · b = bH · Ak · b −α2M
(7.212)
where α is an arbitrary non-zero real number and (·)H denotes conjugate transpose. The resulting
M × M matrix Ak is positive-deﬁnite due to the addition of α2I, and therefore can be Cholesky
factorized as Ak = QH
k · Qk where Ak is an upper-triangular matrix. Substituting Ak into Equation
(7.212) gives:
x′
k
2 = bH · QH
k · Qk · b −α2M = ∥Qk · b∥2 −α2M
(7.213)
where the signal sample is now a function of the phase vector b.

PAPR REDUCTION OF OFDM SIGNALS
423
If we wish to limit the PAPR Equation (7.209) to µ2E
-|x (t)|2.
for some positive number
µ the candidate phase vectors can be generated from Equation (7.213) subject to the following
constraint:
8888888888


Qk
1,1
· · ·
Qk
1,M
0
Qk
2,2
...
...
...
...
0
0
Qk
M,M


·


b1
b2
...
bM


8888888888
2
< µ2 + α2M
(7.214)
for 1 ≤k ≤LN. Sphere decoding only searches among those candidates that lie inside the sphere of
radius µ2 + α2M and, therefore, reduces the complexity of the search. If we rewrite Equation (7.214)
as
M

υ=1

M

u=0
Qk
υ,ubu

2
< µ2 + α2M, 1 ≤k ≤LN
(7.215)
then in order to satisfy Equation (7.215), the following set of inequalities must be satisﬁed for
1 ≤k ≤LN:
Qk
M,MbM
2 < µ2 + α2M,
M

υ=M−1

M

u=υ
Qk
υ,ubu

2
< µ2 + α2M
M

υ=M−2

M

u=υ
Qk
υ,ubu

2
< µ2 + α2M
...
M

υ=1

M

u=υ
Qk
υ,ubu

2
< µ2 + α2M
(7.216)
Note that the ﬁrst equation contains bM only, the second bM−1 and bM only, and so on. We ﬁx bM = 1
without loss of generality. However, the ﬁrst term in Equation (7.216) constrains the parameter
µ (which speciﬁes the achievable PAPR reduction). We use the second line of Equation (7.216)
and bM to generate candidates for bM−1. These candidates and (7.218) again are used to generate
candidates for bM−2. This process is repeated until the candidates for the whole phase vector b
are generated. The resulting number of candidates is substantially smaller than q M−1. Therefore, the
search space is reduced, compared with exhaustively searching all q M−1 phase vectors, which reduces
complexity.
For simulation an OFDM signals with 512 8-PSK subcarriers, L = 4 and α = √1/MI is used.
Figure 7.77 compares the complementary cumulative density functions (CCDF’s) of the PAPR where
the number of sub-blocks in PTS is M = 8 and 4. Also, the PTS phase factors are chosen from
P = {+1, −1}. Note that both the SDBA algorithm presented in this section and exhaustive search
perform identically, verifying that the SDBA algorithm is optimal, resulting in approximately 1-dB
additional reduction compared with the FA.
Instead of scrambling, care can be taken over low peak-to-average power ratios in the stage of
channel coding [101–120].

424
OFDM AND MULTICARRIER CDMA
   
(a)
(b)
Figure 7.77 CCDF of the PAPR for exhaustive search (same as SDBA) and ﬂipping algo-
rithm, (a) M = 8, (b) M = 4.
APPENDIX 7.1
Derivation of Equation (7.152)
As explained earlier, dk[n] is also denoted as sk
i, j[p], and among all the received signals, only yi[p]
is related to sk
i, j[p]. Hence, s2 can be further simpliﬁed to
s2 =
88888yi[p] +

l
Xl
i[p]W[p]hl
88888
2
sk
i, j [p]=+1
−
88888yi[p] +

l
Xl
i[p]W[p]hl
88888
2
sk
i, j [p]=−1
p[hk|Hk, σ 2, D, Y] ∝p[Y|H, σ 2, D]p[hk]
∝exp


−1
σ 2
M−1

i=0
88888yi +
K

l=1
Xl
iWhl
88888
2

exp
<
−(hk −hk0)H−1
k0 (hk −hk0)
=
∝exp



−hkH

−1
k0 + 1
σ 2
M−1

i=0
WHXkH
i Xk
i W

hk
(
)*
+
Σ
−1
k∗
+2R



hkH

−1
k0 hk0 + 1
σ 2
M−1

i=0
WHXkH
i

yi −

l̸=k
Xk
i Whl




(
)*
+
Σ
−1
k∗hk∗






∝exp
<
−(hk −hk∗)H−1
k∗(hk −hk∗)
=
∼Nc(Hk∗, k∗)
(A.7.1)

APPENDIX 7.1
425
Derivation of Equation (7.155)
p[σ 2|H, D, Y] ∝p[Y|H, σ 2|D]p[σ 2]
∝
 1
σ 2
2MN
exp


−1
σ 2
M−1

i=0
88888yi +
K

k=1
Xk
i Whk
88888
2
(
)*
+
s2


×
 1
σ 2
ν0+1
exp

−ν0λ0
σ 2

=
 1
σ 2
ν0+2MN+1
exp

−ν0λ0 + s2
σ 2

∼χ −2

2[ν0 + 2MN], ν0λ0 + s2
ν0 + 2MN

(A.7.2)
Derivation of Equation (7.157)
p

dk[n] = +1 | H, σ 2, Dk
n, Y

=
p

dk[n] = +1|H, σ 2, Dk
n|Y

p

H, σ 2, Dk
n | Y

= p

Y | dk[n] = +1, Dk
n, H, σ 2 P

dk[n] = +1 | Dk
n

P[H]P[σ 2]
p

H, σ 2, Dk
n | Y

⇒
p

dk[n] = +1 | H, σ 2, Dk
n, Y

p

dk[n] = −1 | H, σ 2, Dk
n, Y
 =
P

dk[n] = +1, Dk
n

p

Y | dk[n] = +1, Dk
n, H, σ 2
P

dk[n] = −1, Dk
n

p

Y | dk[n] = −1, Dk
n, H, σ 2

= P[dk[n + 1] | dk[n] = +1]
P[dk[n + 1] | dk[n] = −1] × P[dk[n] = +1 | dk[n −1]]
P[dk[n] = −1 | dk[n −1]]
× exp



−1
σ 2
M−1

t=0


88888yt +

l
Xl
tWhl
88888
2
dk[n]=+1
−
88888yt +

l
Xl
t(dl)Whl
88888
2
dk[n]=−1


(
)*
+
s2



= exp

ρk[n]dk[n + 1] + ρk[n −1]dk[n −1] −s2
σ 2

.
(A.7.3)
REFERENCES
1. Li, Y. G., Cimini, L. J. Jr, and Sollenberger, N. R. (1998) Robust channel estimation for OFDM
systems with rapid dispersive fading channels, IEEE Transactions On Communications, 46,
902–915.
2. Jia-Chin Lin (2003) Maximum-likelihood frame timing instant and frequency offset estimation
for OFDM communication over a fast Rayleigh-fading channel, IEEE Transactions on Vehicular
Technology, 52(4), 1049–1062.

426
OFDM AND MULTICARRIER CDMA
3. Chengyang Li and Roy, S. (2003) Subspace-based blind channel estimation for OFDM by
exploiting virtual carriers, IEEE Transactions on Wireless Communications, 2(1), 141–150.
4. Seog Geun Kang, Yong Min Ha and Eon Kyeong Joo (2003) A comparative investigation on
channel estimation algorithms for OFDM in mobile Communications, IEEE Transactions on
Broadcasting, 49(2), 142–149.
5. Zheng Yuanjin (2003) A novel channel estimation and tracking method for wireless OFDM
systems based on pilots and Kalman ﬁltering, IEEE Transactions on Consumer Electronics,
49(2), 275–283.
6. Xiaobo Zhou and Xiaodong Wang (2003) Channel estimation for OFDM systems using adaptive
radial basis function networks, IEEE Transactions on Vehicular –chnology, 52(1), 48–59.
7. Deneire, L., Vandenameele, P., van der Perre, L., Gyselinckx, B. and Engels, M. (2003) A low-
complexity ML channel estimator for OFDM, IEEE Transactions On Communications, 51(2),
135–140.
8. Muquet, B., de Courville, M. and Duhamel, P. (2002) Subspace-based blind and semi-blind
channel estimation for OFDM systems, IEEE Transactions on Signal Processing, 50(7), 1699–
1712.
9. Luise, M., Marselli, M. and Reggiannini, R. (2002) Low-complexity blind carrier frequency
recovery for OFDM signals over frequency-selective radio channels, IEEE Transactions On
Communications, 50(7), 1182–1188.
10. Coleri, S., Ergen, M., Puri, A. and Bahai, A. (2002) Channel estimation techniques based on
pilot arrangement in OFDM systems, IEEE Transactions on Broadcasting, 48(3), 223–229.
11. Landstrom, D., Wilson, S. K., van de Beek, J.-J., Odling, P. and Borjesson, P. O. (2002) Symbol
time offset estimation in coherent OFDM systems, IEEE Transactions On Communications,
50(4), 545–549.
12. May, T., Rohling, H. and Engels, V. (1998) Performance analysis of Viterbi decoding for 64-
DAPSK and 64-QAM modulated OFDM signals, IEEE Transactions On Communications,
46(2), 182–190.
13. Sh¨afer, R. (1995) Terrestrial transmission of DTVB signals–The European speciﬁcation. in
Proceedings of the International Broadcasting Convention, Amsterdam, The Netherlands, 1995,
pp. 79–84.
14. Bagels, V. and Rohling, H. (1995) Multilevel differential modulation techniques (64-DAPSK)
for multicarrier transmission systems, European Transactions on Telecommunications, 6, 633–
640.
15. Rohling, H. and Engels, V. (1995) Differential amplitude phase shift keying (DAPSK)–A new
modulation method for DTVB, in Proceedings of the International Broadcasting Convention,
Amsterdam, The Netherlands, 1995, pp. 102–108.
16. Monnier, R., Rault, J. B. and de Couasnon, T. (1992) Digital television broadcasting with high
spectral efﬁciency, in Proceedings of the International Broadcasting Convention, Amsterdam,
The Netherlands, 1992, pp. 380–384.
17. Marti, B., Bernard, P., Lodge, N. and Sh¨afer, R. (1993) European activies on digital television
broadcasting–From company to cooperative projects, EBU Technical Review, pp. 22–29.
18. Chow, Y. C., Nix, A. R. and McGeehan, J. P. (1992) Analysis of 16-APSK modulation in AWGN
and Rayleigh fading channel, Electronics Letters, 28, 1608–1610.
19. Giallorenci, T. R. and Wilson, S. G. (1995) Noncoherent demodulation techniques for trellis-
coded M-DPSK signals, IEEE Transactions On Communications, 43, 2370–2380.

REFERENCES
427
20. Simon, M. K. and Divsalar, D. (1988) The performance of trellis coded multilevel DPSK on a
fading mobile satellite channel, IEEE Transactions on Vehicular Technology, 37, 78–91.
21. Divsalar, D. and Simon, M. K. (1990) Multiple-symbol differential detection of MPSK, IEEE
Transactions On Communications, 38, 300–308.
22. Divsalar, D., Simon, M. K. and Shahshahani, M. (1990) The performance of trellis-coded
MDPSK with multiple symbol detection, IEEE Transactions On Communications, 38, 1391–
1403.
23. Hanzo, L. et al. (2002) Adaptive Wireless Transceivers. John Wiley & Sons, Ltd, Chichester.
24. Zhiqiang Liu and Giannakis, G. B. (2003) Block differentially encoded OFDM with maximum
multipath diversity, IEEE Transactions on Wireless Communications, 2(3), 420–423.
25. Zhiqiang Liu, Yan Xin and Giannakis, G. B. (2002) Space–time-frequency coded OFDM over
frequency-selective fading channels, IEEE Transactions on Signal Processing, 50(10), 2465–
2476.
26. Stamoulis, A., Zhiqiang, L. and Giannakis, G. B. (2002) Space–time block-coded OFDMA
with linear precoding for multirate services, IEEE Transactions on Signal Processing, 50(1),
119–129.
27. Kuo-Hui Li and Ingram, M. A. (2002) Space–time block-coded OFDM systems with RF
beamformers for high-speed indoor wireless communications, IEEE Transactions On Commu-
nications, 50(12), 1899–1901.
28. Lu, B., Xiaodong Wang and Ye Li (2002) Iterative receivers for space–time block-coded OFDM
systems in dispersive fading channels, IEEE Transactions on Wireless Communications, 1(2),
213–225.
29. Ye Li (2002) Simpliﬁed channel estimation for OFDM systems with multiple transmit antennas,
IEEE Transactions on Wireless Communications, 1(1), 67–75.
30. Lu, B., Xiaodong Wang and Narayanan, K. R. (2002) LDPC-based space–time coded OFDM
systems over correlated fading channels: Performance analysis and receiver design, IEEE Trans-
actions On Communications, 50(1), 74–88.
31. Blum, R. S., Ye Geoffrey Li, Winters, J. H. and Qing Yan (2001) Improved space–time coding
for MIMO-OFDM wireless communications, IEEE Transactions on Communications, 49(11),
1873–1878.
32. Li, Y. G., Seshadri, N. and Ariyavisitakul, S. (1999) Channel estimation for OFDM systems
with transmitter diversity in mobile wireless channels, IEEE Journal on Selected Areas in
Communications, 17, 461–471.
33. Blum, R. S., Ye Geoffrey Li, Winters, J. H. and Qing Yan (2001) Improved space–time coding
for MIMO-OFDM wireless Communications, IEEE Transactions On Communications, 49(11),
1873–1878.
34. Li, Y. G., Winters, J. H. and Sollenberger, N. R. (2001) Signal detection for MIMO-
OFDM wireless Communications, IEEE International Conference on Communications, June
2001.
35. Al-Dhahir, N., Uysal, M. and Georghiades, C. N. (2001) Three space–time block-coding
schemes for frequency-selective fading channels with application to EDGE, IEEE 54th Ve-
hicular Technology Conference, 7–11 October 2001, 3, 1834–1838.
36. Younis, W. and Al-Dhahir, N. (2002) Joint preﬁltering and MLSE equalization of space–
time-coded transmissions over frequency-selective channels, IEEE Transactions on Vehicular
Technology, 51(1), 144–154.

428
OFDM AND MULTICARRIER CDMA
37. Al-Dhahir, N. (2002) Overview and comparison of equalization schemes for space–time-coded
signals with application to EDGE, IEEE Transactions on Signal Processing, 50(10), 2477–2488.
38. Franz, V. and Anderson, J. (1998) Concatenated decoding with a reduced-search BCJR algo-
rithm, IEEE Journal on Selected Areas in Communications, 16, 186–195.
39. Bahl, L., Cocke, J., Jelinek, F. and Raviv, J. (1974) Optimal decoding of linear codes for
minimizing symbol error rate, IEEE Transactions On Information Theory, IT-20, 284–287.
40. Fragouli, C., Al-Dhahir, N., Diggavi, S. and Turin, W. (2002) Preﬁltered space–time M-BCJR
equalizer for frequency-selective channels, IEEE Transactions on Communications, 50, 742–
753.
41. Naguib, A. and Seshadri, N. (2000) MLSE and equalization of space–time coded signals, in
Proceedings of Vehicular Technology Conference, May 2000, pp. 1688–1693.
42. Al-Dhahir, N. (2001) FIR channel-shortening equalizers for MIMO ISI channels, IEEE Trans-
actions On Communications, 50, 213–218.
43. Duel-Halien, A. and Heegard, C. (1989) Delayed decision-feedback sequence estimation, IEEE
Transactions On Communications, 36, 428–436.
44. Lindskog, E. and Paulraj, A. (2000) A transmit diversity scheme for delay spread channels, in
Proceedings of the International Conference on Communications, June 2000, pp. 307–311.
45. Pollet, T., Van Bladel, M. and Moeneclaey, M. (1995) BER sensitivity of OFDM systems to
carrier frequency offset and wiener phase noise, IEEE Transactions On Communications, 44,
191–193.
46. Sari, H., Karam, G. and Jeanclaude, I. (1995) Transmission techniques for digital terrestrial TV
broadcasting, IEEE Communications Magazine, 33, 100–109.
47. Clark, M. V. (1998) Adaptive frequency-domain equalization and diversity combining for broad-
band wireless Communications, IEEE Journal on Selected Areas in Communications, 16, 1385–
1395.
48. Al-Dhahir, N. (2001) Single-carrier frequency-domain equalization for space–time block-coded
transmissions over frequency-selective fading channels, IEEE Communications Letters, 5, 304–
306.
49. Kaleh, G. (1995) Channel equalization for block transmission systems, IEEE Journal on Selected
Areas in Communications, 13, 110–121.
50. SC
FDE
PHY
Layer
Sys.
Proposal
for
Sub
11
GHz
BWA
(Online).
Available:
http://www.ieee802.org/16/tg3/contrib/802 163p-0131r2.pdf.
51. Crazier, S., Falconer, D. and Mahmoud, S. (1991) Least sum of squared errors (LSSE) channel
estimation, Proceedings of the Institute of Electronic Engineers F, pp. 371–378.
52. Chu, D. (1972) Polyphase codes with good periodic correlation properties, IEEE Transactions
On Information Theory, IT-18, 531–532.
53. Fragouli, C., Al-Dhahir, N. and Turin, W. (2002) Reduced-complexity training schemes for
multiple-antenna broadband transmissions, in Proceedings of WCNC, 1, 78–83.
54. Fragouli, C., Al-Dhahir, N. and Turin, W. (2002) Finite-alphabet constant-amplitude training
sequences for multiple-antenna broadband transmissions, in Proceedings of the International
Control Conference, 1, 6–10.
55. Chong, L. L. and Milstein, L. B. (2000) Error rate of a multicarrier CDMA system with imperfect
channel estimates, IEEE International Conference on Communications (ICC 2000), 18–22 June
2000, 2, 934–938.

REFERENCES
429
56. Kondo, S. and Milstein, L. B. (1996) On the performance of multicarrier DS CDMA systems,
IEEE Transactions On Communications, 44, 238–246.
57. Fazel, K. and Fettweis, G. P. (Eds.) (1997) Multi-Carrier Spread Spectrum. Kluwer, Boston,
MA.
58. Sourour, E. and Nakagawa, M. (1996) Performance of orthogonal multicarrier CDMA in a
multipath fading channel, IEEE Transactions On Communications, 44, 356–367.
59. Kondo, S. and Milstein, L. B. (1993) On the use of multicarrier direct sequence spread spectrum
systems, in Proceedings of IEEE MILCOM, Boston, MA, October 1993, pp. 52–56.
60. TIA/TR45.5. (1998, July). The cdma2000 ITU-R RTT candidate submission (0.18) (Online).
Available: http://www.itu.Int/imt/2-radio-dev/proposals/index.html.
61. Eng, T. and Milstein, L. B. (1994) Comparison of hybrid FDMA/CDMA systems in fre-
quency selective Rayleigh fading, IEEE Journal on Selected Areas in Communications, 12, 938–
951.
62. Dongwook Lee and Milstein, L. B. (1999) Comparison of multicarrier DS-CDMA broadcast
systems in a multipath fading channel, IEEE Transactions On Communications, 47(12), 1897–
1904.
63. Hagenauer, J. (1988) Rate-compatible punctured convolutional codes (RCPC Codes) and their
applications, IEEE Transactions On Communications, 36, 389–400.
64. Balachandran, K., Kadaba, S. R. and Nanda, S. (1999) Channel quality estimation and rate
adaptation for cellular mobile radio, IEEE Journal on Selected Areas in Communications, 17,
1244–1256.
65. Frenger, P., Orten, P., Ottosson, T. and Svensson, A. (1999) Rate-compatible convolutional
codes for multirate DS-CDMA systems, IEEE Transactions On Communications, 47, 828–
836.
66. Jumi Lee, Iickho Song, So Ryoung Park, and Seokho Yoon (2001) Analysis of an adaptive
rate convolutionally coded multicarrier DS/CDMA system, IEEE Transactions on Vehicular
Technology, 50(4), 1014–1023.
67. Weiping Xu and Milstein, L. B. (2001) On the use of Interference suppression to reduce Inter-
modulation distortion in multicarrier CDMA systems, IEEE Transactions On Communications,
49(1), 130–141.
68. Lin Fang and Milstein, L. B. (2001) Performance of successive Interference cancellation in con-
volutionally coded multicarrier DS/CDMA systems, IEEE Transactions On Communications,
49(12), 2062–2067.
69. Miller, S. L. and Rainbolt, B. J. (2000) MMSE detection of multicarrier CDMA, IEEE Journal
on Selected Areas in Communications, 18(11), 2356–2362.
70. Kalofonos, D. N., Stojanovic, M. and Proakis, J. G. (1998) On the performance of adap-
tive MMSE detectors for a MC-CDMA system in fast fading Rayleigh channels, The Ninth
IEEE International Symposium on Personal, Indoor and Mobile Radio Communications, 8–11
September 1998, 3, 1309–1313.
71. Kalofonos, D. N., Stojanovic, M. and Proakis, J. G. (2003) Performance of adaptive MC-CDMA
detectors in rapidly fading Rayleigh channels, IEEE Transactions on Wireless Communications,
2(2), 229–239.
72. Jinghong Ma and Tugnait, J. K. (2002) Blind detection of multirate asynchronous CDMA
signals in multipath channels, IEEE Transactions on Signal Processing, 50(9), 2258–
2272.

430
OFDM AND MULTICARRIER CDMA
73. Kunjie Wang, Pingping Zong and Bar-Ness, Y. (2001) A reduced complexity partial sampling
MMSE receiver for asynchronous MC-CDMA systems, IEEE Global Telecommunications
Conference, November 2001, 2, 728–732.
74. Pingping Zong, Kunjie Wang and Bar-Ness, Y. (2001) Partial sampling MMSE Interference
suppression in asynchronous multicarrier CDMA system, IEEE Journal on Selected Areas in
Communications, 19(8), 1605–1613.
75. Weiping Xu and Milstein, L. B. (1998) MMSE Interference suppression for multicarrier DS-
CDMA in frequency selective channels, IEEE Global Telecommunications Conference, 1998,
8–12 November 1998, 1, 259–264.
76. Petre, F., Vandenameele, P., Bourdoux, A., Gyselinckx, B., Engels, M., Moonen, M. and DeMan,
H. (2000) Combined MMSE/pcPIC multiuser detection for MC-CDMA, IEEE 51st Vehicular
Technology Conference Proceedings, Tokyo, 15–18 May 2000, 2, 770–774.
77. Petre, F., Engels, M., Moonen, M., Gyselinckx, B. and De Man, H. (2001) Adaptive
MMSE/pcPIC-MMSE multiuser detector for MC-CDMA satellite system, IEEE International
Conference on Communications, 11–14 June 2001, 9, 2640–2644.
78. Hyung-Yun Kong and Chang-Hee Lee (1999) Design of MC-CDMA system based on non-linear
MMSE, Proceedings of the IEEE Region 10 Conference, 15–17 September 1999, 1, 53–56.
79. Pingping Zong, Kunjie Wang and Bar-Ness, Y. (2001) A novel partial sampling MMSE receiver
for uplink multicarrier CDMA, IEEE VTS 53rd Vehicular Technology Conference, 6–9 May
2001, 1, 741–745.
80. Helard, J.-F., Baudais, J.-Y. and Citerne, J. (2000) Linear MMSE detection technique for MC-
CDMA, Electronics Letters, 36(7), 665–666.
81. Namgoong, J., Wong, T. F. and Lehnert, J. S. (1999) Subspace MMSE receiver for multicarrier
CDMA, IEEE Wireless Communications and Networking Conference (WCNC 1999), 21–24,
September 1999, 1, 90–94.
82. Zigang Yang, Lu, B. and Xiaodong Wang (2001) Blind Bayesian multiuser receiver for space–
time coded MC-CDMA system over frequency-selective fading channel, IEEE Global Telecom-
munications Conference, 25–29 November 2001, 2, 781–785.
83. Zigang Yang, Ben Lu and Xiaodong Wang (2001) Bayesian Monte Carlo multiuser receiver for
space–time coded multicarrier CDMA systems, IEEE Journal on Selected Areas in Communi-
cations, 19(8), 1625–1637.
84. Lie-Liang Yang and Hanzo, L. (2002) Broadband MC DS-CDMA using space–time and
frequency-domain spreading, IEEE 56th Vehicular Technology Conference, 24–28 September
2002, 3, 1632–1636.
85. Gelfand, A. and Smith, A. (1990) Sampling-based approaches to calculating marginal densities,
Journal of the American Statistical Association, 85, 398–409.
86. Geman, S. and Geman, D. (1984) Stochastic relaxation, Gibbs distribution, and the Bayesian
restoration of images, IEEE Transactions on Pattern Analysis and Machine Intelligence, PAMI-
6, 721–741.
87. Chan, K. (1993) Asymptotic behavior of the Gibbs sampler, Journal of the American Statistical
Association, 88, 320–326.
88. Liu, J., Wong, W. and Hong, A. (1995) Covariance structure and convergence rate of the Gibbs
sampler with various scans, Journal of the Royal Statistical Society Series B, 57, 157–169.
89. Robert, C. and Casella, G. (1999) Monte Carlo Statistical Methods. Springer-Verlag, New York.

REFERENCES
431
90. Wang, X. and Chen, R. (2000) Adaptive Bayesian multiuser detection for synchronous CDMA
with Gaussian and impulsive noise, IEEE Transactions on Signal Processing, 48, 2013–2028.
91. Davis, J. A. and Jedwab, J. (1999) Peak-to-mean power control in OFDM, Golay complementary
sequences, and Reed-Muller codes, IEEE Transactions on Information Theory, 45, 2397–2417.
92. Muller, S. H. and Huber, J. B. (1997) OFDM with reduced peak-to-average power ratio by
optimum combination of partial transmit sequences, Electronics Letters, 33, 368–369.
93. Tellambura, C. (2001) Improved phase factor computation for the PAR reduction of an OFDM
signal using PTS, IEEE Communications Letters, 5, 135–137.
94. Cimini, L. J. and Sollenberger, N. R. (2000) Peak-to-average power ratio reduction of an OFDM
signal using partial transmit sequences, IEEE Communications Letters, 4, 86–88.
95. Han, S. H. and Lee, J. H. (2004) PAPR reduction of OFDM signals using a reduced complexity
PTS technique, IEEE Signal Processing Letters, 11, 887–890.
96. Ho, W. S., Madhukumar, A. S. and Chin, F. (2003) Peak-to-average power reduction using
partial transmit sequences: a suboptimal approach based on dual layered phase sequencing,
IEEE Transactions in Vehicular Technology, 1268–1272.
97. Chen, H. and Pottie, G. J. (2002) An orthogonal projection-based approach for PAR reduction
in OFDM, IEEE Communications Letters, 6, 169–171.
98. Fincke, U. and Phost, M. (1985) Improved methods for calculating vectors of short length in a
lattice, inlcuding a complexity analysis, Mathematical Computation, 44, 463–471.
99. Mow, W. H. (2003) Universal lattice decoding: principle and recent advances, Wireless Com-
munication and Mobile Computing, 3, 553–569.
100. Alavi, A., Tellambura, C. and Fair, I. (2005) PAPR reduction of OFDM signals using partial
transmit sequence: an optimal approach using sphere decoding, IEEE Communications Letters,
9, 982–984
101. Davis, J. A. and Jedwab, J. (1997) Peak-to-mean power control and error correction for OFDM
transmission using Golay sequences and Reed–Muller codes, Electronics Letters, 33, 267–268.
102. Davis, J. A. and Jedwab, J. (1999) Peak-to-mean power control in OFDM, Golay complementary
sequences and Reed–Muller codes, IEEE Transaction Information Theory, 45, 2397–2417.
103. Friese, M. (1996) Multicarrier modulation with low peak-to-mean average power ratio, Elec-
tronics Letters, 32, 713–714.
104. Ho, T. F. and Wei, V. K. (1995) Synthesis of low-crest waveforms for multicarrier CDMA
systems, in Proceedings of IEEE GLOBECOMM, pp. 131–135.
105. Jedwab, J. (1997) Comment: M-sequences for OFDM peak-to-average power ratio reduction
and error correction, Electronics Letters, 33, 1293–1294.
106. Jones, A. E., Wilkinson, T. A. and Barton, S. K. (1994) Block coding scheme for reduction of
peak to mean envelope power ratio of multicarrier transmission schemes, Electronics Letters,
30, 2098–2099.
107. Jones, A. E. and Wilkinson, T. A. (1996) Combined coding error control and increased robustness
to system nonlinearities in OFDM, in Proceedings IEEE 46th Vehicular Technology Conference,
Atlanta, GA, pp. 904–908.
108. Kumar, P. V., Helleseth, T. and Calderbank, A. R. (1995) An upper bound for Weil exponential
sums over Galois rings and applications, IEEE Transactions on Information Theory, 41, 456–
468.

432
OFDM AND MULTICARRIER CDMA
109. Li, X. and Ritcey, J. A. (1997) M-sequences for OFDM peak-to-average power ratio reduction
and error correction, Electronics Letters, 33, 554–555.
110. M¨uller, S. H., B¨auml, R. W., Fischer, R. F. H. and Huber, J. B. (1997) OFDM with reduced
peak-to-average power ratio by multiple signal representation, Annals T´el´ecommunication, 52,
58–67.
111. van Nee, R. D. J. (1996) OFDM codes for peak-to-average power reduction and error correction,
in Proceedings IEEE GLOBECOM, London, pp. 740–744.
112. Ochiai, H. and Imai, H. (1997) Block coding scheme based on complementary sequences for
multicarrier signals, IEICE Transactions Fundamentals, 2136–2143.
113. Paterson, K. G. (2000) Generalized Reed–Muller codes and power control in OFDM modulation,
IEEE Transactions on Information Theory, 46, 104–120.
114. Shepherd, S., Orriss, J. and Barton, S. (1998) Asymptotic limits in peak envelope power re-
duction by redundant coding in orthogonal frequency-division multiplex modulation, IEEE
Transactions on Communication, 46, 5–10.
115. Tarokh, V. and Jafarkhani, H. (2000) On reducing the peak to average power ratio in multicarrier
communications, IEEE Transactions on Communication, 48, 37–44.
116. Wilkinson, T. A. and Jones, A. E. (1995) Minimization of the peak to mean envelope power ratio
of multicarrier transmission schemes by block coding, in Proceedings of IEEE 45th Vehicular
Technology Conference, July, pp. 825–829.
117. Wulich D. (1996) Reduction of peak-to-mean ratio of multicarrier modulation using cyclic
coding, Electronics Letters, 32, 432–433.
118. Paterson, K. G. and Tarokh, V. (2000) On the existence and construction of good codes with
low peak-to-average power ratios, IEEE Transactions on Information Theory, 46, 1974–1987.
119. MacWilliams, F. J. and Sloane, N. J. A. (1986) The Theory of Error-Correcting Codes, 2nd ed.,
North Holland, Amsterdam.
120. Moreno, O. and Moreno, C. J. (1994) The MacWilliams–Sloane conjecture on the tightness of
the Carlitz–Uchiyama bound and the weights of duals of BCH codes, IEEE Transactions on
Information Theory, 40, 1894–1907.

8
Ultra Wide Band Radio
In this chapter we discuss technology which is based on the spread spectrum concept, such as CDMA,
as described in Chapter 5. The difference is that the pulse (called chip in Chapter 5) period used in this
ﬁeld is below 1 ns, resulting in a bandwidth of over 1 GHz, hence the name Ultra Wide Band (UWB)
Radio. The second important characteristic is that the signal can be transmitted with no carrier. This
is why very often the system is also referred to as Impulse Radio (IR). The above characteristics of
the signal will require the modiﬁcation of the signal format and detection concepts. In addition to
these issues the chapter will also cover the basic characteristics of the UWB channel.
8.1
UWB MULTIPLE ACCESS IN A GAUSSIAN CHANNEL
A typical time-hopping format used in this case can be represented as [1–31]:
s(k)
tr

t(k)
=
∞

j=−∞
ωtr

t(k) −jTf −c(k)
j Tc −δd(k)
[ j/Ns]

(8.1)
where t(k) is the kth transmitter’s clock time and Tf is the pulse repetition time. The transmitted pulse
waveform ωtr is referred to as a monocycle. To eliminate collisions due to multiple access, each user
(indexed by k) is assigned a distinctive time shift pattern {c(k)
j } called a time-hopping sequence. This
provides an additional time shift of c(k)
j Tc seconds to the jth monocycle in the pulse train, where Tc is
the duration of addressable time delay bins. For a ﬁxed Tf, the symbol rate Rs determines the number
Ns of monocycles that are modulated by a given binary symbol as Rs = (1/NsTf)s−1. The modulation
index δ is chosen to optimize performance. For performance prediction purposes, most of the time
the data sequence {d(k)
j }∞
j=−∞is modeled as a wide-sense stationary random process composed of
equally likely symbols. For data, a pulse position modulation is used.
8.1.1
The multiple access channel
When K users are active in the multiple access system, the composite received signal at the output
of the receiver’s antenna is modeled as
r (t) =
K

k=1
Aks(k)
rec (t −τk) + n (t)
(8.2)
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

434
ULTRA WIDE BAND RADIO
Figure 8.1 A typical ideal received monocycle ωrec(t) at the output of the antenna subsystem
as a function of time in nanoseconds.
The antenna/propagation system modiﬁes the shape of the transmitted monocycle ωtr(t) to ωrec(t) at
its output. An idealized received monocycle shape ωrec(t) for a free-space channel model with no
fading is shown in Figure 8.1.
8.1.2
Receiver
The optimum receiver for a single bit of a binary modulated impulse radio signal in additive white
Gaussian noise (AWGN) is a correlation receiver deﬁned as
decide d(1)
0
= 0
if
Ns−1

j=0
pulse correlator output = α j (u)



 τ1+( j+1)Tf
τ1+ jTf
r (u, t) υ

t −τ1 −jTf −c(1)
j Tc

dt



test statistic = α(u)
> 0
(8.3)
where υ(t)
= ωrec(t) −ωrec(t −δ).
The optimal detection in a multiuser environment, with knowledge of all time-hopping sequences,
leads to complex parallel receiver designs [2]. However, if the number of users is large and no such
multiuser detector is feasible, then it is reasonable to approximate the combined effect of the other
users dehopped interfering signals as a Gaussian random process [2]. Hence, the single-link reception
algorithm (8.3) as shown in Figure 8.2 can be used for practical implementations. The test statistic in
Algorithm (8.3) consists of summing the Ns correlations α j of the correlators template signal υ(t) at
various time shifts with the received signal r(t).
For the monocycle waveform of Figure 8.1, the optimum choice of δ is 0.156 ns. By choosing
δ = 0.156 ns and Tf = 100 ns, we achieve the results shown in Figure 8.3. For the evaluation of the
system efﬁciency, formulas from Chapter 4 are applicable with
Dr = K,
	k02
k01

= K and −g12 = Additional Required Power (ARP)
Both K = total number of users and ARP are available in Figure 8.3.

UWB MULTIPLE ACCESS IN A GAUSSIAN CHANNEL
435
Pulse
correlator
Pulse train
integrator
Compare
to zero
Template
generator
Sequence
delay
Frame
clock
Sequence
generator
Link
selector
input
r(t)
signal with
{αj}
test statistics
α
demodulated
data
τ1 mod Tf
(sync control)
−
−
j
f
D
jT
t
)
(
1
τ
δ
(sync control)
−
−
−
j
c
l
j
f
D
T
c
jT
t
)
(
)
(
1
τ
δ
)
(l
jc
−
−
−
j
c
l
j
f
T
c
jT
t
v
∑
∑
∑
)
(
)
(
1τ
τ1 mod Tf
Figure 8.2 Receiver block diagram for the reception of the ﬁrst user’s signal. Clock pulses
are denoted by Dirac delta functions δD(·) [31] c⃝2001, IEEE.
0
10
20
30
40
0
10 000
20 000
30 000
Total number of  users
Additional required power (dB)
Figure 8.3 Total number of users versus additional required power (decibels) for the im-
pulse radio example. Ideal power control is assumed at the receiver. Three
different BER performance levels with the data rate set at 19.2 kb/s are consid-
ered.

436
ULTRA WIDE BAND RADIO
8.2
THE UWB CHANNEL
8.2.1
Energy capture
In Section 8.1 a Gaussian channel was assumed. For a UWB signal, a high resolution of multipath
channel is expected. In this section we discuss some characteristics of a UWB signal in such a channel.
8.2.2
The received signal model
In general, the received signal can be presented as
r (u, t) = s (us, t) + n (un, t)
(8.4)
where u characterizes the set of parameters deﬁning the environment (position of the receiver in the
room). The RAKE correlator structure is modeled as
L P

i=1
ciω (t −τi)
(8.5)
For experimental purposes, the pulse in Figure 8.1 that can be represented as ωrec(t + 1.0) =
⌊1 −4π(t/τm)2⌋exp⌊−2π(t/τm)2⌋with τm = 0.78125 is used. The ML estimates of the amplitude
vector ˆc(˜u) and delay vector ˆτ(˜u) based on a speciﬁc observation r(˜u, t) are the values c and τ which
minimize the following mean squared error:
E
˜u, L p

=
 T
0

r (˜u, t) −
L p

i=1
ciω (t −τi)

2
dt
(8.6)
The minimum value of the above mean squared error is denoted by Emin(u, L p). The energy capture,
a function of L p for each observation r(˜u, t), is deﬁned mathematically as
EC
˜u, L p

= 1 −
Emin
˜u, L p

Etot (˜u)



=
normalized
MSE
(8.7)
8.2.3
The UWB signal propagation experiment 1
A UWB signal propagation experiment performed in a typical modern ofﬁce building [4] is described.
The bandwidth of the signal used in this experiment is in excess of 1 GHz, resulting in a differential
path delay resolution of less than a nanosecond.
The transmitter is kept stationary in the central location of the building. Multipath proﬁles are
measured using a digital sampling oscilloscope on one ﬂoor at various locations in 14 different rooms
and hallways. In each ofﬁce, multipath measurements are made at 49 different locations. They are
arranged spatially in a level 7 × 7 square grid with six inch (15 cm) spacing, covering 3′ × 3′ (90 ×
90 cm).
Measurements from three different ofﬁces are used in the following discussions as typical examples
of propagation environments. In these ofﬁces, the receiving antennas are located 6, 10 and 17 m away
from the transmitter, representing typical UWB signal transmissions characterized as a ‘high signal
to noise ratio (SNR)’ environment, ‘low SNR’ environment, and ‘extremely low SNR’ environment,
respectively. The transmitter and receiving antenna are located in different rooms in these examples.
Detailed results of this UWB signal propagation experiment can be found in [4, 13]. The results are
shown in Figure 8.4 in the form of upper and lower bound curves.

THE UWB CHANNEL
437
Figure 8.4 The required diversity level, L p, in a UWB RAKE receiver as a function of
percentage energy capture for each of the 49 received waveforms in an ofﬁce
representing a ‘high SNR’ environment (courtesy Moe Win, Massachusetts
Institute of Technology) [4] c⃝1997, IEEE.
Figure 8.5 Transmitted pulse shape captured at 1 m separation from the transmit antenna.
8.2.4
UWB propagation experiment 2
The propagation experiment described in this section uses two vertically polarized diamond-dipole
antennas [6], each 1.65 m above the ﬂoor and 1.05 m below the ceiling in an ofﬁce/laboratory
environment [7]. The equivalent received pulse at 1 m in free space can be estimated as the ‘direct
path’ signal in an experiment in which there is no multipath signal, as shown in Figure 8.5.
A collection of results of recovered signal locations (delay and azimuth) is shown in Figure 8.6.

438
ULTRA WIDE BAND RADIO
Figure 8.6 Recovered signal location and amplitude information [5] c⃝2002, IEEE.
8.2.5
Clustering models for the indoor multipath propagation channel
A number of models for the indoor multipath propagation channel [8–12] have reported a clustering
of multipath components, in both time and angle. In the model presented in [11], the received signal
amplitude βkl is a Rayleigh distributed random variable with a mean square value that obeys a double
exponential decay law, according to
β2
kl = β2 (0, 0)e−Tl/Γe−τkl/γ
(8.8)
where β2(0, 0) describes the average power of the ﬁrst arrival of the ﬁrst cluster, Tl represents the
arrival time of the lth cluster, and τkl is the arrival time of the kth arrival within the lth cluster,
relative to Tl. The parameters Γ and γ determine the inter-cluster signal level rate of decay and the
intra-cluster rate of decay, respectively. The parameter Γ is generally determined by the architecture
of the building, while γ is determined by objects close to the receiving antenna, such as furniture.
The results presented in [11] make the assumption that the channel impulse response as a function of
time and azimuth angle is a separable function, or
h (t, θ) = h (t) h (θ)
(8.9)
from which independent descriptions of the multipath time-of-arrival and angle-of-arrival are devel-
oped. This is justiﬁed by observing that the angular deviation of the signal arrivals within a cluster
from the cluster mean does not increase as a function of time.

THE UWB CHANNEL
439
The cluster decay rateΓ and the ray decay rate γ can be interpreted for the environment in which the
measurements were made. For the results, presented later in this section, at least one wall separates the
transmitter and the receiver. Each cluster can be viewed as a path that exists between the transmitter
and the receiver, along which signals propagate. This cluster path is generally a function of the
architecture of the building itself. The component arrivals within a cluster vary because of secondary
effects, e.g. reﬂections from the furniture or other objects. The primary source of degradation in the
propagation through the features of the building is captured in the decay exponent Γ. Relative effects
between paths in the same cluster do not always involve the penetration of additional obstructions
or additional reﬂections, and therefore tend to contribute less to the decay of the component signals.
Results for p(θ) generated from the data in Figure 8.6 are shown in Figure 8.7.
−180
−135
−90
−45
0
45
90
135
180
0.000
0.005
0.010
0.015
0.020
p(θ)
θ (degrees)
Laplacian distribution:
( )
σ
θ
σ
θ
/
2
2
1
−
=
e
p
(a)
−180
−135
−90
−45
0
45
90
135
180
0
20
40
60
80
100
CDF (%)
Cluster angle of arrival relative to reference cluster
(b)
Figure 8.7 (a) Ray arrival angles at 1◦of resolution and a best ﬁt Laplacian density with
σ = 38◦; (b) distribution of the cluster azimuth angle of arrival, relative to
the reference cluster [5] c⃝2002, IEEE.

440
ULTRA WIDE BAND RADIO
Table 8.1
Channel parameters
Spencer et al.
Spencer et al.
Saleh–Valenzuela
Parameter
UWB [5]
[11]
[11]
[10]
Γ
27.9 ns
33.6 ns
78.0 ns
60 ns
γ
84.1 ns
28.6 ns
82.2 ns
20 ns
1/Λ
45.5 ns
16.8 ns
17.3 ns
300 ns
1/λ
2.3 ns
5.1 ns
6.6 ns
5 ns
σ
37◦
25.5◦
21.5◦
. . .
Interarrival times are hypothesized [11] to follow exponential rate laws, given by
p (Tl |Tl−1 ) = Λe−Λ(Tl−Tl−1)
p(Tkl|Tk−1,l) = λe−λ(Tl−Tl−1)
where Λ is the cluster arrival rate and λ is the ray arrival rate. Channel parameters are summarized
in Table 8.1.
8.2.6
Path loss modeling
In this segment we are interested in a transceiver operating at approximately 2 GHz center frequency
with a bandwidth in excess of 1.5 GHz, which translates to sub-nanosecond time resolution in the
CIRs.
8.2.6.1
Measurement procedure
The measurement campaign is described in [14] and is conducted in a single-ﬂoor, hard-partition
ofﬁce building (fully furnished). The walls are constructed of drywall with vertical metal studs; there
is a suspended ceiling ten feet (three metres) in height with carpeted concrete ﬂoor. Measurements are
conducted with a stationary receiver and mobile transmitter, both transmit and receive antennas are
ﬁve feet (1.5 metres) above the ﬂoor. For each measurement, a 300 ns time domain scan is recorded
and the LOS distance from transmitter to receiver is recorded. A total of 906 proﬁles are included in
the dataset with seven different receiver locations recorded over the course of several days. Except
for a reference measurement made for each receiver location, all successive measurements are NLOS
links, chosen randomly throughout the ofﬁce layout, that penetrate anywhere from one to ﬁve walls.
The remainder of the datapoints are taken in a similar fashion.
8.2.6.2
Path loss modeling
The average path loss for an arbitrary T-R separation is expressed using the power law as a function
of distance. The indoor environment measurements show that at any given d, shadowing leads to
signals with a path loss that is lognormally distributed about the mean [15, 16]. That is:
PL (d) = PL0 (d0) + 10N log
	 d
d0

+ Xσ
(8.10)
where N is the path loss exponent, Xσ is a zero mean lognormally distributed random variable with
standard deviation σ(dB) and PL0 is the free space path loss at reference distance, d0. Some results
are shown in Figure 8.8.
Assuming a simple RAKE with four correlators where each component is weighted equally, we
can calculate the path loss versus distance using the peak CIR power plus RAKE gain, PLPEAK+RAKE,

THE UWB CHANNEL
441
for each CIR, as shown in Figure 8.8(c). The exponent N obtained from performing a least squares
ﬁt is 2.5, with a standard deviation of 4.04 dB. The results for delays are shown in Figure 8.9.
8.2.6.3
In-home channel
For the in-home channel, Equation (8.10) can also be used to model path loss. Some results are shown
in Table 8.2 [17–20].
Table 8.3 presents the results for delay spread in the in-home channel [17].
10
0
10
1
10
2
−54
−51
−48
−45
−42
−39
−36
−33
−30
−27
−24
−21
−18
−15
−12
−9
−6
−3
0
3
Free space
N = 2.9
data
−PLPEAK (dB)
Distance (feet)
σN = 4.75 dB
(a)
10
0
10
1
10
2
−54
−51
−48
−45
−42
−39
−36
−33
−30
−27
−24
−21
−18
−15
−12
−9
−6
−3
0
3
Free space
N = 2.1
data
−PLTOTAL (dB)
Distance (feet)
σN
(b)
= 3.55 dB
Figure 8.8 (a) Peak PL vs. distance; (b) total PL vs. distance; (c) peak PL + RAKE gain
vs. distance [14] c⃝2002, IEEE.

442
ULTRA WIDE BAND RADIO
−54
−51
−48
−45
−42
−39
−36
−33
−30
−27
−24
−21
−18
−15
−12
−9
−6
−3
0
3
−P
10
0
10
1
10
2
Free space
N = 2.5
data
LPEAK+RAKE (dB)
Distance (feet)
σN
(c)
= 4.04 dB
Figure 8.8 (Cont.).
8.3
UWB SYSTEM WITH M-ARY MODULATION
8.3.1
Performance in a Gaussian channel
We will ﬁrst assume that the transmitted pulse and the received signal are pTX(t)
=  t
−∞p(ξ)dξ and
p(t) + n(t) respectively (we ignore effects of propagation). The effect of the antenna system in the
transmitted pulse is modeled as a differentiation operation. The noise n(t) is AWGN with two-sided
power density N0/2. The UWB pulse p(t) has duration Tp and energy Ep =
 ∞
−∞[p(t)]2dt. The
normalized signal correlation function of p(t) is
γp (τ)
= 1
Ep
 ∞
−∞
p (t) p (t −τ) dt > −1
∀τ
(8.11)
Parameter γmin
= γp(τmin) is deﬁned as the minimum value of γp(τ), τ ∈(0, Tp⌋. The transmitted
signal is a PPM signal, and each is composed of Ns time-shifted pulses
Ψ ( j)
TX(t) =
Ns−1

k=0
pTX

t −kTf −αk
jτmin

(8.12)
j = 1, 2, . . . , M. In the absence of noise, the received signals are composed of Ns time-shifted UWB
pulses
Ψ j (t) =
Ns−1

k=0
p

t −kTf −αk
jτmin

(8.13)
Each Ψ j(t) represents the jth signal in an ensemble of M signals, each signal identiﬁed by the
sequence of time shifts ak
jτmin ∈{0, τmin} (this choice of time shifts allows us to produce M-ary PPM
signals, which are equally correlated). The ak
j is a 0, 1 pattern representing the jth cyclic shift of an

UWB SYSTEM WITH M-ARY MODULATION
443
10
0
10
1
10
2
0
5
10
15
20
25
30
35
40
45
50
τRMS (ns)
Distance (feet)
σRMS = 5.72 ns
(a)
0
10
20
30
40
50
60
0
5
10
15
20
25
30
35
40
45
50
τRMS (ns)
PLPEAK(dB)
σRMS = 4.26 ns
(b)
Figure 8.9 (a) RMS delay spread vs. distance; (b) RMS delay spread vs. path loss [14]
c⃝2002, IEEE.
m-sequence of length Ns. Since there are at most Ns cyclic shifts in an m-sequence, we require that
2 ≤M < Ns.
The pulse duration satisﬁes Tp + τmin < Tf, where Tf is the time shift value corresponding to
the frame period. Each signal Ψ j(t) has duration Ts
= NsTf and energy EΨ = NsEp. The signals in
Equation (8.133) have normalized correlation values
βij
=
 ∞
−∞
Ψi (t)Ψ j (t) dt
EΨ
= β = 1 + γmin
2
(8.14)
for all i ̸= j, i.e. they are equally correlated.

444
ULTRA WIDE BAND RADIO
Table 8.2
Statistical values of the path loss parameters
LOS
NLOS
Standard
Standard
Mean
deviation
Mean
deviation
PL0(dB)
47
51
N
1.7
0.3
3.5
0.97
σ(dB)
1.6
0.5
2.7
0.98
Table 8.3
Percentage of power contained in proﬁle, number of paths,
mean excess delay and RMS delay spread for 5, 10, 15, 20 and
30 dB threshold level.
50% NLOS
90% NLOS
%
τm
τRMS
%
τm
τRMS
Threshold
Power
L
(ns)
(ns)
Power
L
(ns)
(ns)
5 dB
46.8
7
1.95
1.52
46.9
8
2.2
1.65
10 dB
89.2
27
7.1
5.77
86.5
31
8.1
6.7
15 dB
97.3
39
8.6
7.48
96
48
10.3
9.3
20 dB
99.4
48
9.87
8.14
99.5
69
12.2
11
30 dB
99.97
60
10.83
8.43
99.96
82
12.4
11.5
The optimum receiver is a bank of ﬁlters matched to the M signals Ψ j(t), j = 1, 2, . . . , M. The
receiver is assumed to be perfectly synchronized with the transmitter.
The union bound on the bit error probability using these equally correlated signals can be written
[22]:
UBPb = 1
M
M

i=1
i̸= j
M

j=1
Q

EΨ
N0
(1 −β)

= M
2
 ∞
√
log2(M)SNRb
exp(−ξ 2/2)
√
2π
dξ
(8.15)
where
SNRb =
1
log2(M)
EΨ
N0
(1 −β)
(8.16)
is the received bit SNR and Q(ξ) is the Gaussian tail function.
As an example for p (t), we consider a UWB pulse that can be modeled by properly scaling the
second derivative of a Gaussian function exp(−2π[t/tn]2). In this case, we have
pTX (t) = t exp

−2π
 t
tn
2
(8.17)
p (t) =

1 −4π
 t
tn
2
exp

−2π
 t
tn
2
(8.18)
where the value τn = 0.7531 ns was used to ﬁt the model p(t) to a measured waveform pm(t) from a
particular experimental radio link [23]. This resulted in Tp ≈2.0 ns.

UWB SYSTEM WITH M-ARY MODULATION
445
The normalized signal correlation function corresponding to p(t) is calculated using Equation
(8.11) to give:
γp (t) =

1 −4π
 t
tn
2
+ 4π2
3
 t
tn
4
exp

−π
 t
tn
2
(8.19)
For this γp(t), we have τmin = 0.4073 ns and γmin = −0.6183, so β = 0.1909 in Equation (8.14). Both
p(t −Tp/2) and γp(τ) are depicted in Figure 8.10. Figure 8.11 shows the spectrum of the impulse
p(t). The 3 dB bandwidth of the pulse is close to 1 GHz. The center frequency is around 1.1 GHz.
0
1
2
3
4
−0.5
0.0
0.5
1.0
Amplitude
Time ( ns)
−2
−1
0
1
2
−0.8
−0.6
−0.4
−0.2
0.0
0.2
0.4
0.6
0.8
1.0
normalized energy
Time ( ns)
(a)
(b)
Figure 8.10 (a) The pulse p

t −Tp/2

as a function of time 0 ≤t ≤4 ns; (b) the signal
autocorrelation γp (τ) as a function of time shift −2 ≤τ ≤2 ns [21] c⃝2001,
IEEE.
0.0
0.5
1.0
1.5
2.0
2.5
3.0
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
Normalized magnitude
Frequency (GHz)
Figure 8.11 The magnitude of the spectrum of the pulse p(t).

446
ULTRA WIDE BAND RADIO
4
6
8
10
12
14
16
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
M = 2
M = 4
M = 8
M = 16
M = 32
M = 64
M = 128
Average bit Pe
bit SNR
Figure 8.12 The UBPb in Equation (8.15). Curves for M are 2, 4, 8, 16, 32, 64, and 128
signals.
The speciﬁc values of Ns and Tf do not affect SNRb, as long as M < Ns and Tp + τmin < Tf.
Hence, we set arbitrarily Tf = 500 ns and Ns > 1000 [21]. The BER in AWGN can now be calculated
using UBPb from Equation (8.15). Results for different values of M are shown in Figure 8.12. Values
as large as M = 128 are easily obtained with the PPM signal design in Equation (8.13), allowing us
to exploit the beneﬁts of M-ary modulation without an excessive increase in the complexity of the
receiver [24].
8.3.2
Performance in a dense multipath channel
In this section we discuss performance of M-ary UWB signals in a dense multipath channel with
AWGN. The channel can be, for example, an indoor radio channel as discussed in Section 8.2. In
the analysis, we will assume that the transmitter is placed at a certain ﬁxed location, and the receiver
is placed at a variable location denoted u0. The transmitted pulse is the same pulse pTX(t) as in
the AWGN case, and the received UWB signal is √Ea ˜p(u0, t) + n(t). The pulse √Ea ˜p(u0, t) is a
multipath spread version of p(t) received at position u0 with average duration Ta ≫Tp. The pulse
has ‘random’ energy ˜E(u0)
= Ea ˜α2(u0), where Ea is the average energy and
˜α (u0)
=
 ∞
−∞
[ ˜p (u0, t)]2 dt
(8.20)
is the normalized energy. The pulse has normalized signal correlation
˜γ (u0, τ)
=
 ∞
−∞
˜p(u0, t) ˜p(u0, t −τ)dt
 ∞
−∞
[ ˜p(u0, t)]2dt
(8.21)
The transmitted signals are the same Ψ( j)
TX(t) as given in Equation (8.12). In the absence of noise, the
received signals are composed of Ns time-shifted UWB pulses
˜Ψ j(u0, t) =
Ns−1

k=0

Ea ˜p

u0, t −kTf −αk
jτmin

(8.22)

UWB SYSTEM WITH M-ARY MODULATION
447
for j = 1, 2, . . . , M. The UWB PPM signal ˜Ψ j(u0, t) is a multipath spread version of Ψ j(t) received
at position u0. Assume that ˜Ψ j(u0, t) has ﬁxed duration Ts ≈NsTf, provided that Ta + τmin < Tf. The
signals in Equation (8.22) have ‘random’ energy
˜EΨ (u0) =
 ∞
−∞
 ˜Ψ j (u0, ξ)
2 dξ = ¯EΨ ¯αu0
(8.23)
for j = 1, 2, . . . , M, where ¯EΨ = NsEa is the average energy. The signals in Equation (8.22) have
normalized correlation values
˜βi j (u0)
=
 ∞
−∞
˜Ψi (u0, ξ) ˜Ψ j (u0, ξ) dξ
˜EΨ(u0)
= ˜β(u0) = 1 + ˜γ (u0, τmin)
2
(8.24)
for all i ̸= j, i.e. they are equally correlated. The multipath effects change with the particular position
u0, and therefore the M-ary set of received signals { ˜Ψ j(u0, t)} j=M
j=1 also changes with the particular
position u0.
8.3.3
Receiver and BER performance
Conditioned on a particular physical location u0, the optimum receiver (matched ﬁlter) is a kind
of perfect Rake receiver that is able to construct a reference signal ˜Ψ j(u0, Ts −t) that is perfectly
matched to the signal received ˜Ψ j(u0, t) over the multipath conditions at that location u0. We will
assume that the receiver is perfectly synchronized with the transmitter. Performance analysis for
the perfect Rake receiver can be calculated using standard techniques, conditioned on a particular
physical location u0, the union bound on the bit error probability using these equally correlated signals
can be written
UBPb(u0) = M
2
 ∞
√
log2(M)SNRb(u0)
exp(−ξ 2/2)
√
2π
dξ
(8.25)
where
SNRb(u0) =
1
log2(M)
˜EΨ(u0)
N0
(1 −˜β(u0))
=
1
log2(M)
¯EΨ ˜α2(u0)
N0
(1 −˜β(u0))
(8.26)
is the received bit SNR [25].
8.3.4
Time variations
The ˜β(u0) value accounts for changes in the correlation properties of the received signals. These
changes in ˜β(u0) translate into changes in the Euclidean distance between signals. Therefore, the
(1 −˜β(u0)) value accounts for energy variations at the output of the perfect matched ﬁlter due to
distortions in the shape of the signal correlation function caused by multipath. The ˜α2(u0) value
accounts for variations in the received signal energy due to fading caused by multipath. The average
performance can be obtained by taking the expected value Eu(·) over all values of u0
UBPb
	 ¯EΨ
N0

= Eu {UBPb (u)}
(8.27)
where
	 ¯EΨ
N0

= Eu {SNRb (u)}
(8.28)
is the average received bit SNR. This BER analysis provides a theoretical matched ﬁlter bound for
the best performance attainable when the multipath channel is perfectly estimated.

448
ULTRA WIDE BAND RADIO
Instead of using a channel model, the calculations based on the received waveforms can be used.
This is possible since the expected value in Equation (8.27) is taken with respect to the quantities
˜α2(u0) and ˜β(u0). Histograms of these quantities can be calculated for a particular indoor channel
environment and a ﬁrst approximation can be obtained using the sample mean value
UBPb
	 ¯EΨ
N0

≈1
u∗
u∗

u0=1
UBPb (u0)
(8.27a)
This calculation represents a rough approximation to the performance of UWB signals in the presence
of dense multipath in a particular indoor radio environment. The histograms for ˜α2(u0) and ˜β(u0) can
be derived from their deﬁnitions in Equations (8.20) and (8.24) using the ensemble of pulse responses
{ ˜p (u0, t)} , u0 = 1, 2, . . . , u∗
taken in a measurement experiment in the multipath channel of interest.
8.3.5
Performance example
The channel responses ˜p(u0, t) were measured in eight different rooms and hallways in a typical
ofﬁce building described in Section 8.2 (see also [21]). In every room and hallway, 49 different
locations are arranged spatially in a 7 × 7 square grid with six inch spacing. At every location
u0, the Ta = 300 ns-long pulses ˜p(u0, t) are recorded, keeping the transmitter, the receiver and the
environment stationary.
The UWB transmitter is placed at a ﬁxed location inside the building. It consists of a step
recovery diode-based pulser connected to a UWB omnidirectional antenna. The pulser produces a
train of UWB ‘Gaussian monocycles’ pTX(t). The train of pTX(t) is transmitted as an excitation
signal to the propagation channel. The train has a repetition rate of 500 ns with a tightly controlled
average monocycle-to-monocycle interval. The clock driving the pulser has resolution in the order of
picoseconds.
The ˜p(u0, t) represents the convolution of pTX(t) with the channel impulse response at location
u0. The 500 ns repetition rate is long enough to make sure that pulse responses ˜p(u0, t) corresponding
to adjacent impulses pTX(t) do not overlap. The receiver consists of a UWB antenna and a low-noise
ampliﬁer. The output of this ampliﬁer is captured using a high-speed digital sampling scope. The
scope takes samples in windows of 50 ns at a sampling rate of 20.5 GHz. Noise in the measured
˜p(u0, t) is reduced by averaging 32 consecutive received pulses measured at exactly the same location
u0. These samples are sent to a data storage and processing unit.
A total of u∗= 392 channel pulse responses ˜p(u0, t) were measured. An equal number of nor-
malized energy values ˜α2(u0) and normalized correlation functions ˜γ (u0, τ) were calculated using
Equations (8.20) and (8.21), respectively. Figure 8.13 shows histograms of ˜α2(u0), ˜β(u0) and the
product ˜α2(u0) × (1 −˜β2(u0)). The measured ˜p(u0, t) have Ta ≈300 ns. The rest of the parame-
ter values are the same as those used in the AWGN case, i.e. τmin = 0.4073 ns, Tf = 500 ns and
Ns > 1000. With these values, the conditions M < Ns and Ta + τmin < Tf will be satisﬁed.
For the results from Figure 8.13, the average BER curves, Equation (8.27), are shown in Fig-
ure 8.14.
8.4
M-ARY PPM UWB MULTIPLE ACCESS
The signal format introduced in Section 8.3 is now used for the multiple access system [26]. The TH
PPM signal conveying information exclusively in the time shifts is now represented as
x(ν) (t) =
∞

k=0
ω
	
t −kTf −c(ν)
k Tc −δk
d(ν)
[k/Ns]

(8.29)

M-ARY PPM UWB MULTIPLE ACCESS
449
0
50
100
150
200
250
−1.0
−0.5
0.0
0.5
1.0
Amplitude
Time (ns)
(a)
0
5
10
15
20
25
−1.0
−0.5
0.0
0.5
1.0
Amplitude
Time (ns)
(b)
Figure 8.13 (a) Normalized correlation function ˜γ (u0, t) of the pulse ˜p(u0, t) in Figure
8.5; (b) a closer view of the correlation in (a). The spreading caused by
multipath is notorious. The long tails in the correlation function are the effect
of the pulse spreading [21]. The histogram of the normalized values of (c) the
received energy ˜α2(u0); (d) the correlation value ˜β(u0); and (e) the product
˜α2(u0) × (1 −˜β2(u0)). The ordinate represents appearance frequency, and the
abscissa represents the value of the parameter. The size of the sample is
u0 = 392 [21] c⃝2001, IEEE.

450
ULTRA WIDE BAND RADIO
0.4
0.6
0.8
1.0
1.2
1.4
1.6
1.8
2.0
0
10
20
0.15
0.20
0.25
0.30
0.35
0.40
0.45
0.50
0.55
0
10
20
0.2
0.4
0.6
0.8
1.0
1.2
1.4
1.6
0
10
20
30
(c)
(d)
(e)
Figure 8.13 (Cont.).
4
6
8
10
12
14
16
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
M = 2
M = 4
M = 8
M = 16
M = 32
M = 64
M = 132
Average bit Pe
Bit SNR
Figure 8.14 UBPb( ¯EΨ/N0) in Equation (8.27a); M = 2, 4, 8, 16, 32, 64 and 132 signals.
The superscript (ν), 1 ≤ν ≤Nu, indicates user-dependent quantities, where Nu is the number of
simultaneous active users. The index k is the number of time hops that the signal x(ν)(t) has expe-
rienced, and also the number of pulses that have been transmitted. Tf is the frame (pulse repetition)
time and equals the average time between pulse transmissions. The notation [q] stands for the integer
part of q. The {c(ν)
k } is the pseudorandom time-hopping sequence assigned to user ν. It is periodic
with period Np (i.e. c(ν)
k+lNp = c(ν)
k , for all k,l integers) and each sequence element is an integer in
the range 0 ≤c(ν)
k
≤Nh. For a given time shift parameter Tc, the time-hopping code provides an
additional time shift to the pulse in every frame, each time shift being a discrete time value c(ν)
k Tc,
with 0 ≤c(ν)
k Tc ≤NhTc. The time shift corresponding to the data modulation is
δk
d(ν)
[k/Ns] ∈{τ1 = 0 < τ2 < · · · < τη}
(8.30)

M-ARY PPM UWB MULTIPLE ACCESS
451
with η ≥2 an integer. The data sequence {d(ν)
m } of user ν is an M-ary symbol stream, 1 ≤d(ν)
m ≤M,
that conveys information in some form. The system under study uses fast time-hopping, which means
that there are Ns > 1 pulses transmitted per symbol. The data symbol changes only every Ns hops.
Assuming that a new data symbol begins with pulse index k = 0, the data symbol index is [k/Ns].
We will use the following notation
H (ν)
m (t) ˆ=
(m+1)Ns−1

k=mNs
Tcc(ν)
k p (t −kTf)
p (t) =
1,
if 0 ≤t ≤Tf
0,
otherwise
(8.31)
and
Si (t) ˆ=
Ns−1

k=0
ω

t −kTf −δk
i

(8.32)
for i = 1, 2, . . . , M, then Equation (8.29) can be written
x(ν) (t) =
∞

m=0
Sd(ν)
m

t −mNsTf −H (ν)
m (t)

ˆ=
∞

m=0
X (ν)
m,d(ν)
m (t)
(8.29a)
The signal Si (t) in Equation (8.32) is the received signal corresponding to the transmitted signal
 t
−∞Si(ξ)dξ = Ns−1
k=0 ωTX(t −kTf −δk
i ). With this notation, the signal correlation function is deﬁned
as
Ri j ˆ=
 ∞
−∞
X (ν)
m,i (ξ) X (ν)
m,i (ξ) dξ
(8.33)
=
 ∞
−∞
Si (ξ) Sjdξ = Eω
Ns−1

k=0
γω

δk
i −δk
j

since the pulses are non-overlapping. The energy in the ith signal X (ν)
m,i is ES = Rii = NsEω, and the
normalized correlation value is
αi, j ˆ= Ri j
ES
= 1
Ns
Ns−1

k=0
γω

δk
i −δk
j

≥γmin
(8.34)
8.4.1
M-ary PPM signal sets
The PPM signal Si(t) in Equation (8.32) represents the ith signal in an ensemble of M information
signals, each signal completely identiﬁed by the pulse shape ω(t) and the sequence of time shifts
{δk
i }, k = 0, 1, 2, . . . , Ns −1. The most interesting M-ary PPM sets from the practical point of view
are orthogonal (OR), equally correlated (EC), and N-orthogonal (NO) signal sets.
In general, these signal designs have the property that the structure of the M-ary autocorrelation
matrix is preserved for different ω(t). This is important because ω(t) is, in general, a non-standard
pulse, and these signal designs reduce the dependence of the MA performance on the shape of
ω(t). The time shift patterns deﬁning each M-ary PPM signal set and their respective correlation
properties are studied in detail in [27–29] and are summarized in Table 8.4. In the EC case, the ak
i
is a 0, 1 pattern representing the ith cyclic shift, i = 1, 2, . . . , M, of an m-sequence [31] of length
Ns = 2m −1, m ≥1, and Ns ≥M.
The M-ary correlation receiver, shown in Figure 8.15, consists of M ﬁlters matched to the signals
{X (1)
m, j(t −τ (1))}, j = 1, 2, . . . M, t ∈Tm, followed by samplers and a decision circuit that selects the
maximum among the decision variables

t∈Tm
r (t) X (1)
m, j

t −τ (1)
dt,
j = 1, 2, . . . M
(8.35)

452
ULTRA WIDE BAND RADIO
Table 8.4
Time-shift patterns and normalized correlation values of the M-ary PPM signals
under study. Orthogonal (OR), equally correlated (EC), N-orthogonal design 1
(NO1) and N-orthogonal design 2 (NO2) [26] c⃝2001, IEEE
Time shift pattern {δk
i }
Type of
i = 1, 2, . . . , M
signal
k = 0, 1, 2, . . . , Ns −1
Normalized correlation coeﬁcients
δk
i = [(k + i −1) mod M] TOR
OR
TOR = 2Tω
α(OR)
i j
=
1,
i = j
0,
i ̸= j
δk
i = ak
i τ2
EC
τ2 ∈(0, Tω]
ak
i ∈{0, 1}
α(EC)
i j
=
1,
i = j
λ,
i ̸= j
|λ| < 1
δk
i = τ1 +

k + 2 ˜I

mod L

TNO1
L ˆ=
 M
2

NO1
I = i −
 i−1
2

2
˜I ˆ=
 i−1
2

TNO1 ˆ= τ2 + TOR
0 = τ1 < τ2 < Tω
α(NO1)
i j
=



1,
i = j
0,
 i−1
2

̸=

j−1
2
 
βi j,
 i−1
2

=

j−1
2
 
βi j = γω (τJ −τI)
J = j −

j−1
2
 
2
δk
i = ak
i τ2 +

k + 2 ˜I

mod L

TNO2
NO2
TNO2 ˆ= τ2 + TOR
0 = τ1 < τ2 < Tω
α(NO2)
i j
=



1,
i = j
0,
 i−1
2

̸=

j−1
2
 
λ,
 i−1
2

=

j−1
2
 
Store
and sum
M-ary signal
generator
Code
delay
Frame
clock
Code
generator
Link
selector
r(t)
k mod Np
(sync control)
)
(
)
(
f
l
D
kT
t
−
−τ
δ
(sync control)
)
(
)
(
)
(
c
l
k
f
l
D
T
c
kT
t
−
−
−τ
δ
)
(l
kc
τ(l) mod Tf
(l)
M
i
T
c
kT
t
w
s
N
k
k
i
c
l
k
f
l
,...,
2,1
,)
(
1
0
)
(
)
(
=
−
−
−
−
∑
−
=
δ
τ
yi
)
(
)
(
)
(
k
i
c
l
k
l
f
T
c
kT
δ
τ
+
+
+
)
(
)
(
)
(
w
k
i
c
l
k
l
f
T
T
c
kT
+
+
+
+
δ
τ
k = 0, 1, 2,…, Ns - 1
Figure 8.15 M-ary correlator receiver for the TH PPM signals.

CODED UWB SCHEMES
453
8.4.2
Performance results
In this subsection, we illustrate the theoretical MA performance of this system for a speciﬁc ω(t)
under perfect power control (i.e. A(ν) = A(1) for ν = 2, 3, . . . , Nu). The system parameters are the
same as in [26]. The ω(t) considered here is the second derivative of a Gaussian function
ω (t) =

1 −4π
 t
tn
2
exp

−2π
 t
tn
2
(8.36)
where the value tn is used to ﬁt the model ω(t) to a measured waveform from a particular experimental
radio link. The normalized signal correlation function corresponding to ω(t) in Equation (8.36) is
γω (τ) =

1 −4π
 τ
tn
2
+ 4π2
3
 τ
tn
4
exp

−π
 τ
tn
2
(8.37)
In this case, Tω and τmin depend on tn, and γmin = −0.6183 for any tn. Using tn = 0.4472 ns, we get
Tω ≈1.2 ns and τmin = 0.2149 ns. Figure 8.16 depicts ω (t −Tω/2), γω (τ) and the spectrum of ω (t).
The 3 dB bandwidth of ω (t) is in excess of 1 GHz.
Given ω(t), the signal design is complete when we specify Ns, Tf and δk
j in Table 8.4. For OR
signals TOR = 2Tω, for EC signals τ1 = 0 and τ2 = τmin, for NO1 signals τ1 = 0, τ2 = τmin and
TNO1 ˆ= τmin + 2Tω, and for NO2 signals τ1 = 0, τ2 = τmin and TNO2 ˆ= τmin + 2Tω.
To choose a value for Tf, we need 0 < NhTc < (Tf/2) −2(Tω + τη). Also notice that τη = 16TOR
for M = 16 (the maximum value of M, in this example). By choosing Tf = 100 ns, we have that
0 < NhTc < 16 ns.
To choose a value for Ns, notice that the M-ary PPM signal designs considered in [27] require
that Ns = 1/(RsTf) = log2(M)/(RbTf) = log2(M)N (2)
s . Hence, for a ﬁxed Tf, the value of Ns is
determined by Rb. However, in particular, the EC PPM signal design additionally requires Ns ≥M.
Combining these two requirements on Ns we have that, in the EC PPM case, both Rb and Ns satisfy
the relation (log2(Ns)/Ns) ≥RbTf. In this example, we use Rb = 100 kb/s, N (2)
s
= 100, 2 ≤M ≤16,
and Ns = log2(M)100; hence, (log2(Ns)/Ns) ≥RbTf holds, and both relations Ns ≥M and
Ns = log2(M)/RbTf are satisﬁed.
For a single-link communications bit, Eb/N0 = 14.30 dB, SNRbOR(1) = 14.30 dB [27], and
SNRbTSK(1) = 16.40 dB. The BER results are given in Figure 8.17. If we deﬁne SNR(1) as the
required signal to noise ratio for a certain BER with only one user in the network and SNR(Nu) as
the required initial signal to noise ratio with one user which, after adding Nu −1 additional users,
will still give SNR(1), then we deﬁne the degradation factor DF as DF = SNR(Nu)/SNR(1). In the
next example we demonstrate some results for Nu(DF) when using the pulse ω(t) in Equation (8.36)
with tn = 0.4472 ns, Tω = 1.2 ns, τmin = 0.2419 ns, τ1 = 0, τ2 = τmin, and Tf = 100 ns. Figure 8.18
shows Nu(DF) for different values of DF using Rb = 100 kb/s, N (2)
s
= 100, 2 ≤M ≤256, and
Ns = log2(M)100. Notice that (log2(Ns)/Ns) ≥RbTf still holds for M = 256.
From Nu(DF) we can also ﬁnd Rb(DF) for a particular value of Nu. Figure 8.19 shows Rb(DF) for
different values of DF using Nu = 1000 active users.
The values of the upper bound on maximum capacity Csup are given in Table 8.5. The upper bound
on maximum data rate is shown in Figure 8.20.
8.5
CODED UWB SCHEMES
We can consider the simple time-hopping spread spectrum from Section 8.4 as a coded system in
which a simple repetition block code with rate 1/Ns is used. As outlined in Chapter 2 the efﬁciency
of the repetition code is very low. Thus, by applying a near optimal code instead of the above simple
repetition code, we should expect the system performance to improve signiﬁcantly. In [32, 33], a class
of low-rate superorthogonal convolutional codes that have near optimal performance is introduced. In
a superorthogonal code with constraint length K, the rate is equal to 1/2K−2. Since in the TH CDMA
(UWB) system, Ns pulses are sent for each data bit, we must set 2K−2 = Ns or K = 2 + log2 Ns. The

454
ULTRA WIDE BAND RADIO
0.0
0.2
0.4
0.6
0.8
1.0
1.2
−1.0
−0.5
0.0
0.5
1.0
Amplitude
t (ns)
0.0
0.2
0.4
0.6
0.8
1.0
1.2
−1.0
−0.5
0.0
0.5
1.0
Normalized energy
τ (ns)
0
1
2
3
4
5
0.0
0.2
0.4
0.6
0.8
1.0
Normalized magnitude
Frequency (GHz)
(a)
(b)
(c)
Figure 8.16 (a) Pulse ω(t −Tω/2) as a function of time t; (b) signal autocorrelation function
γω(τ) as a function of time shift τ; (c) magnitude of the spectrum of the pulse
ω(t) [26] c⃝2001, IEEE.
location of each pulse in each frame is determined by the user-dedicated pseudorandom sequence,
along with the code symbol corresponding to that frame.
Decoding is performed using the Viterbi algorithm. The state diagram of this decoder consists
of 2K−1 states. Two branches, corresponding to bit zero and bit one, exit from each state in the
trellis diagram. To update the state metrics, it is ﬁrst necessary to calculate the branch metrics,

0
1000
2000
3000
−16
−14
−12
−10
−8
−6
−4
−16
−14
−12
−10
−8
−6
−4
−16
−14
−12
−10
−8
−6
−4
−16
−14
−12
−10
−8
−6
−4
M = 2
M = 4
M = 8
M = 16
log10 of bit error probability
Number of users Nu (simultaneous active links)
(a)
0
1000
2000
3000
M = 2
M = 4
M = 8
M = 16
log10 of bit error probability
Number of users Nu (simultaneous active links)
(b)
0
1000
2000
3000
M = 2
M = 4
M = 8
M = 16
log10 of bit error probability
Number of users Nu (simultaneous active links)
(c)
0
1000
2000
3000
M = 2
M = 4
M = 8
M = 16
log10 of bit error probability
Number of users Nu (simultaneous active links)
(d)
Figure 8.17 Base 10 logarithm of the probability of bit error as a function of Nu for different
values of M, using Rb = 100 kb/s. (a) OR PPM signals, SNRbOR(1) = 14.30
dB; (b) EC PPM signals, SNRbEC(1) = 13.39 dB; (c) NO PPM signals, design
1, SNRbOR(1) = 14.30 dB and SNRbTSK(1) = 16.40 dB; (d) NO PPM signals,
design 2, SNRbOR(1) = 14 : 30 dB.
10
−1
10
0
10
1
10
2
10
3
10
1
10
2
10
3
Pe = 10
−6,M = 256
Pe = 10
−6,M = 128
Pe = 10
−6,M = 64
Pe = 10
−6,M = 32
Pe = 10
−6,M = 16
Pe = 10
−6,M = 8
Pe = 10
−6,M = 4
Pe = 10
−6,M = 2
Number of users Nu
Degradation factor DF (dB)
Figure 8.18 Number of simultaneous active links (users) Nu(DF) for EC PPM signals for
2 ≤M ≤256 with Pe(1) = UBP(EC)
b
(1) ≈10−6 and Rb = 100 kb/s.

456
ULTRA WIDE BAND RADIO
10
−1
10
0
10
1
10
2
10
3
10
3
10
4
10
5
Pe = 10
−6,M = 256
Pe = 10
−6,M = 128
Pe = 10
−6,M = 64
Pe = 10
−6,M = 32
Pe = 10
−6,M = 16
Pe = 10
−6,M = 8
Pe = 10
−6,M = 4
Pe = 10
−6,M = 2
Bit transmission rate per user Rb (bps)
Degradation factor DF (dB)
Figure 8.19 Data transmission rate per user Rb(DF) for EC PPM signals for 2 ≤M ≤256
with Pe(1) = UBP(EC)
b
(1) ≈10−6 and Nu = 1000 active users.
Table 8.5
Values of Csup in (Gb/s) calculated using three different pulse widths.
Also included are the values of Nsup for Rb = 100 kb/s [26]
Set I of
Set II of
Set III of
parameters
parameters
parameters
tn = 0.2877 ns
tn = 0.4472 ns
tn = 0.7531 ns
Tω = 0.75 ns
Tω = 1.2 ns
Tω = 2.0 ns
τmin = 0.1556 ns
τmin = 0.2419 ns
τmin = 0.4073 ns
C(I)
sup = 3.6394 (Gbps)
C(II)
sup = 2.3412 (Gbps)
C(III)
sup = 1.3903 (Gbps)
N (I)
sup = 36394 (users)
N (II)
sup = 23412 (users)
N (III)
sup = 13903 (users)
using the received signal r(t). For this purpose, in each frame j, the quantity:
α j ˆ=
 τ1+( j+1)Tf
τ1+ jTf
r (t) υ

t −τ1 −jTf −c(1)
j Tc

dt
(the pulse correlator output) is obtained. Because of the special form of the Hadamard–Walsh sequence
that is used in the structure of superorthogonal codes, the branch metrics can be simply evaluated
based on the outputs of pulse correlators α js [33]. This is also elaborated in Chapter 4 for space–
time codes from orthogonal designs. The processing complexity of this decoder grows only linearly
with K (or logarithmically with Ns); the required memory, however, grows exponentially with K
(or equally linearly with Ns) [33]. Since in time-hopping, spread spectrum applications, the value
of K is relatively low (the typical value is in the range 3–12), the system can be considered to be
practical.

CODED UWB SCHEMES
457
10
2
10
3
10
4
10
5
10
6
10
7
10
8
10
9
set I
set II
set III
Rsup(Nu) (bps)
Number of users Nu
Multiple access transmission capacity per user
Figure 8.20 Upper bound on the bit transmission rate per user Rsup(Nu) in b/s, calculated
using the sets I, II and III of parameters in Table 8.5.
8.5.1
Performance
The path generating function of the code for a superorthogonal code is computed as [33, 34]:
TSO(γ, β) =
βW K+2(1 −W)
1 −W[1 + β(1 + W K−3 −2W K−2)]
(8.38)
in which W = γ 2K−3 and K is the constraint length of the code. Expanding the above expression, we
get a polynomial in γ and β. The coefﬁcient and the powers of γ and β in each term of the polynomial
indicate the number of paths and output–input path weights respectively. The free distance of this
code is obtained from the ﬁrst term of the expansion as df = 2K−3(K + 2) = Ns(log2 Ns + 4)/2.
8.5.2
The uncoded system as a coded system with repetition
In this case, the distance will be Ns. Comparing the free distances of these two schemes, it is clear
that the coded scheme outperforms the uncoded scheme signiﬁcantly.
An upper bound on the probability of error per bit for a memoryless channel is obtained using the
union bound as follows:
Pb < dTSO (W, β)
dβ

β=1
=
W K+2
(1 −2W)2
	
1 −W
1 −W K−2

2
(8.39)
where W = Z 2K−3. The parameter Z is calculated from the Bhattacharyya bound as
Z =
 ∞
−∞

p0 (y) p1 (y) dy
(8.40)
where p0(y) and p1(y) are pdfs of the pulse correlator output conditioned on the input symbol being
zero and one, respectively.

458
ULTRA WIDE BAND RADIO
10
0
10
1
10
2
10
−10
10
−8
10
−6
10
−4
10
−2
10
−10
10
−8
10
−6
10
−4
10
−2
10
−10
10
−8
10
−6
10
−4
10
−2
10
−10
10
−8
10
−6
10
−4
10
−2
Uncoded exact
Coded exact
Uncoded Gaussian
Coded Gaussian
Probability of bit error Pb
Number of users Nu
10
0
10
1
10
2
10
3
Uncoded exact
Coded exact
Uncoded Gaussian
Coded Gaussian
Probability of bit error Pb
Number of users Nu
(a)
(b)
10
1
10
2
10
3
10
4
Uncoded exact
Coded exact
Uncoded Gaussian
Coded Gaussian
Probability of bit error Pb
Number of users Nu
10
2
10
3
10
4
Uncoded exact
Coded exact
Uncoded Gaussian
Coded Gaussian
Probability of bit error Pb
Number of users Nu
(c)
(d)
Figure 8.21 Probability of bit error as a function of number of users for synchronous
uncoded and coded (upper bound) schemes in exact and Gaussian cases (a) at
Rs = 5 Mb/s (Ns = 2); (b) at Rs = 1.25 Mb/s (Ns = 8); (c) at Rs = 325 kb/s
(Ns = 32); (d) at Rs = 78.1 Mb/s (Ns = 128).
A lower bound on the probability of error per bit is obtained by considering only the ﬁrst term of
the path generating function, Equation (8.38), The result is
Pb ≥Pd f
(8.41)
where Pd f is the probability of pairwise error in favor of an incorrect path that differs in d f symbols
from the correct path over the unmerged span in the trellis diagram.
For ωrec(t + Tω/2) = ⌊1 −4π(t/τm)2⌋exp(−2π(t/τm)2), τm = 0.2877 and δ and Tf set to 0.156
and 100 ns respectively, the performance curves are given in Figures 8.21 and 8.22 for different Rs.
8.6
MULTIUSER DETECTION IN UWB RADIO
In this section we consider a system based on using orthogonal codes in a synchronous or quasi-
synchronous context, coupled with TDD for transmissions through frequency selective channels. This
is achieved by assigning to each user different orthogonal time-hopping sequences and designating
two time slots for transmission: one for the uplink and one for the downlink. Binary PPM modulation
from Section 8.5 is used with eight users (N ′
c = 8) and two symbols per burst (K = 2). As per [35],
frame duration Tf = 100 ns and there is a maximum delay spread equal to 100 ns.
Each symbol is repeated Nf frames. A time guard of duration Tc is used, hence, Ng = 1. The
chip duration Tc = Tf/(N ′
c + Ng) = 11.11 ns. The sampling rate is equal to tc which leads to a

MULTIUSER DETECTION IN UWB RADIO
459
channel of length L1 = 9. The channel model from Section 8.2 is used. This model is based on
clusters of rays. The received signal is composed of attenuated and delayed versions of the trans-
mitted signal arriving in clusters. The times of arrival are modeled as a Poisson process and the
amplitudes as Gaussian. For the simulations, the receivers will be assumed to be synchronized
on the strongest path. In the PPM-IRMA system, the received signal is the second derivative of
the Gaussian function

τ 3/3(2/π)1/4 exp(−t2/τ 2) (normalized to have rω(0) = 1); hence, we have
rω(t) = exp(−t2/(2τ 2))⌊1 −2(t/τ)2 + (t/τ)4/3⌋where rω(t) is the correlation function of ω(t) and
the parameter τ = 0.1225 ns is adjusted to yield a pulse width equal to 0.7 ns.
10
1
10
2
10
−10
10
−8
10
−6
10
−4
10
−2
Uncoded exact
Coded exact
Uncoded Gaussian
Coded Gaussian
Probability of bit error Pb
Number of users Nu
(a)
(b)
10
1
10
2
10
−10
10
−8
10
−6
10
−4
10
−2
Uncoded exact
Coded exact
Uncoded Gaussian
Coded Gaussian
Probability of bit error Pb
Number of users Nu
Figure 8.22 Probability of bit error as a function of number of users for asynchronous
uncoded and coded (upper bound) schemes in exact and Gaussian cases (a) at
Rs = 5 Mb/s (Ns = 2); (b) at Rs = 2.5 Mb/s (Ns = 4); (c) at Rs = 1.25 Mb/s
(Ns = 8).

460
ULTRA WIDE BAND RADIO
10
2
10
3
10
−10
10
−8
10
−6
10
−4
10
−2
Uncoded exact
Coded exact
Uncoded Gaussian
Coded Gaussian
Probability of bit error Pb
Number of users Nu
(c)
Figure 8.22 (Cont.).
For multiuser detection schemes (MF, zero forcing (ZF)-decorrelator and MMSE), based on the
same logic as in Chapter 5, the results are shown in Figures 8.23 and 8.24. Details of the derivation
of the detector transfer function are given in [36].
8.7
UWB WITH SPACE–TIME PROCESSING
8.7.1
Signal model
In this segment, the Generalized Gaussian Pulse (GGP) Ω(t)/E0 shown in Figure 8.25 will be used.
The self-steering array beamforming system for UWB impulse waveforms is shown in Figure 8.26.
The response of the ith sensor to the received wavefront can be expressed in terms of the voltage
signal as
υi (t, φ) = Ω(t −τi (φ))
= [E0/ (1 −α)] (exp{−4π[(t −τi(φ))/T ]2}
(8.42)
−α exp
!
−4π [α (t −τi (φ)) /T ]2"
The relative time delay τi(φ)/T is a function of the angle of incidence φ and the distance d between
adjacent sensors:
τi (φ) /T = (id/cT ) sin φ = (i/2m) ρ sin φ
(8.43)
ρ = 2md/cT = L/cT = Lf/c
(8.44)
In order to achieve electronic beamsteering for enhancing the quality of signal reception from a
desired look direction, e.g. φ = φ0 the variable delay circuit VDCi applies to the incoming signal
Υi(t) a time delay ˜τi = (id/c) sin φ0. In analogy to Equation (8.44), the relative time delay ˜τi/T

UWB WITH SPACE–TIME PROCESSING
461
6
8
10
12
14
16
10
−4
10
−3
10
−2
10
−1
10
0
MF
ZF
ZF Bound
MMSE
BER
Eb / N0
(a)
(b)
6
8
10
12
14
16
10
−4
10
−3
10
−2
10
−1
10
0
Nf = 5
Nf = 15
Nf = 25
BER
Eb / N0
MF
ZF
MMSE
Figure 8.23 Comparing the different receivers (MF, ZF, MMSE) for the binary PPM-IRMA
scheme with K = 2, Tg = 1 and eight users. (a) For Nf = 1; (b) for Nf = 5,
Nf = 15 and Nf = 25.
can also be expressed in terms of ρ:
˜τi/T = (id/cT ) sin φ0 = (i/2m) ρ sin φ0
(8.45)
Finally, the delayed signals Υ(t + ˜τi −τi(φ)), i = 0, ±1, ±2, . . . , ±m from the VDCis are
summed by SUM1, SUM2 and SUM3 to produce the beamformer’s response function
˜Υ (t, φ) =
m

i=−m
Υ (τ + ˜τι −τi (φ))
(8.46)
Some results are shown in Figures 8.27 to 8.31.

462
ULTRA WIDE BAND RADIO
6
8
10
12
14
16
18
20
22
24
10
−3
10
−2
10
−1
10
0
ZF
MF
MMSE
BER
Eb / N0
Figure 8.24 Comparing the different receivers (MF, ZF, MMSE) for the binary PPM-
IRMA scheme for 100 Monte Carlo channel trials with the same parameters
as in Figure 8.23(a).
−0.75
−0.50
−0.25
0.00
0.25
0.50
0.75
−0.50
−0.25
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
Normalized time (t/∆t)
(a)
Ω(t) =
E0
1−α

exp
!
−4π[(t −t0) /T ]2"
−α exp
!
−4π[α (t −t0) /T ]2"
Autocorrelation functionΥ(t)/Υ(0)
Figure 8.25 (a) Normalized time variation of the generalized Gaussian pulse Ω(t)/E0;
(b) autocorrelation function Υ(t)/Υ(0); (c) energy density spectrum Ψ( f ) =
|Λ( f )|2 for values of the scaling parameter α = 0 (dotted line), α = 0.75
(dashed line), α = 1.5 (dashed-dotted line) and α = 3 (solid line).

UWB WITH SPACE–TIME PROCESSING
463
−1.00
−0.75
−0.50
−0.25
0.00
0.25
0.50
0.75
1.00
−0.50
−0.25
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
Normalized time (t/∆t)
(b)
Υ (t) =
 ∞
−∞Ω(λ) Ω(λ + t) dλ
EnergydensityspectrumΨ ( f ) / (E0/2f )2
0.0
0.5
1.0
1.5
2.0
2.5
3.0
3.5
4.0
4.5
5.0
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
Normalized frequency (f/∆f)
(c)
Λ ( f ) =
 ∞
−∞
 (t) exp {−j2πf t} dt
Figure 8.25 (Cont.).

464
ULTRA WIDE BAND RADIO
SC+m
VDC+m
SC+1
VDC+1
SC0
VDC0
SC−1
VDC−1
SC−m
VDC−m
SUM3
SUM4
DAC
SUM3
SUM4
+
+
+
−
+m
+1
0
−1
−m
array axis
subarray 1
subarray 2
Figure 8.26 A self-steering array beamforming system for UWB impulse waveforms. The
beamformer includes M = 2m + 1 sensors, sliding correlator (SCi), variable
delay circuit (VDCi), delay adjustment computer (DAC) and summer circuits
(SUM) [37] c⃝2002, IEEE.
8.7.2
The monopulse tracking system
The monopulse signal delivered to DAC by SUM4 is:
Υ (t, φ) =
+m

i=0
Υ (t + ˜τi −τi (φ)) −
+0

i=−m
Υ (t + ˜τi −τi (φ))
(8.47)
Angle-of-arrival estimation based on slope processing is illustrated in Figure 8.32. Basically, for
different signs of φ, the control signal Υ(t, φ) has different slopes [see Figure 8.32(a)]. For larger
φ, the control signal Υ(t, φ) is smaller. Based on this, the control mechanism is deﬁned so that the
delays of the VDCis are adjusted by DAC according to the relationship
˜τi > ˜τi+1,
for
−π/2 ≤φ < φ0
(8.48)
˜τi < ˜τi+1,
for
φ0 < φ ≤π/2
More details can be found in [38].

UWB WITH SPACE–TIME PROCESSING
465
Q(t,φ)
t/∆t
φ [deg]
-0.5
-0.25
0
0.25
0.5
-4
-2
0
2
4
0
0.25
0.5
0.75
1
0.5
-0.25
0
0.25
-0.5
-0.25
0
0.25
0.5 0
1
2
3
4
0
0.25
0.5
0.75
1
0.5
-0.25
0
0.25
Q(t,φ)
t/∆t
φ [deg]
(a)
(b)
 (t, φ) =
 ˜Υ (t, φ)
˜Υ (0, φ0)
2
=
 ˜Υ (t, φ)
ME
2
Figure 8.27 Space–time resolution function Θ(t, φ) for the value of spacial frequency
bandwidth ρ = 10. (a) Scaling parameter α = 3 and the angular range −50 ≤
φ ≤+ 50; (b) 00 ≤φ ≤+ 30.

466
ULTRA WIDE BAND RADIO
−50
−40
−30
−20
−10
0
−50
−40
−30
−20
−10
0
10
20
30
40
50
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
Angle φ (deg)
(a)
10
20
30
40
50
0.0
0.2
0.4
0.6
0.8
1.0
Normalized amplitude
Angle φ (deg)
(b)
˜A (φ) =
˜Υ (0, φ)
˜Υ (0, φ0)
=
˜Υ (φ)
ME
Figure 8.28 Peak amplitude pattern ˜A(φ) for: (a) φ0 = 00, α = 3, d = cT/2, and M = 5
(dotted line), 9 (dashed line), 13 (dashed-dotted line) and 17 (solid line);
and (b) M = 9 and d = cT/2 (dotted line), cT (dashed line), 3cT/2
(dashed-dotted line) and 2cT (solid line).

BEAMFORMING FOR UWB RADIO
467
−6
−4
−2
0
2
4
6
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
(a)
−6
−4
−2
0
2
4
6
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
angle φ (deg)
angle φ (deg)
(b)
P (φ) = [ ˜A (φ)]2 = Θ (0, φ)
Figure 8.29 Peak power pattern P(φ) for: (a) φ0 = 00 and ρ = 10, α = 0.5 (dotted line),
0.75 (dashed line), 1.5 (dashed-dotted line) and 3 (solid line); and (b) α = 3
and ρ = 4 (dotted line), 6 (dashed line), 8 (dashed-dotted line) and 10 (solid
line).
8.8
BEAMFORMING FOR UWB RADIO
8.8.1
Circular array
The received signal is modeled as a Gaussian pulse [38–40]
Ω(t) = (E/T ) exp⌊−π(t/T )2⌋
(8.49)
For the geometry shown in Figure 8.33 we have:
Rn = (r 2 + a2 −2ar cos Ψn)1/2

468
ULTRA WIDE BAND RADIO
−6
−4
−2
0
2
4
6
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
angle φ (deg)
(a)
−6
−4
−2
0
2
4
6
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
angle φ (deg)
(b)
˜U(φ) =
 ∞
−∞
 ˜Υ (τφ)
 2
dt
˜W (φ) =
˜U (φ)
˜U (φ0)
Figure 8.30 Energy pattern ˜W(φ) for: (a) φ0 = 00 and ρ = 10, α = 0.5 (dotted line), 0.75
(dashed line), 1.5 (dashed-dotted line) and 3 (solid line); and (b) α = 3 and
ρ = 4 (dotted line), 6 (dashed line), 8 (dashed-dotted line) and 10 (solid line).

BEAMFORMING FOR UWB RADIO
469
−60
−45
−30
−15
0
15
30
45
60
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
angle φ (deg)
(a)
−60
−45
−30
−15
0
15
30
45
60
0.00
0.25
0.50
0.75
1.00
Normalized amplitude
angle φ (deg)
(b)
˜W (φ) =
 ∞
−∞Θ (t, φ) dt =
 ∞
−∞
Φ ( f, φ) d f
Figure 8.31 Peak power pattern P(φ) and energy pattern ˜W(φ) for the case of an ideal
Gaussian pulse with α = 0. The plots are calculated for ρ = 4 (dotted line), 6
(dashed line), 8 (dashed-dotted line) and 10 (solid line).
which, for r ≫a, can be approximated as
Rn = r −a cos Ψn = r −a sin θ cos (φ −φn)
with φn = 2π
 n
N

, n = 1, 2, . . . , N
We assume that the signal source is located in the far ﬁeld at the point P(r, θ, φ); r ≫a. So at
the nth array element we have:
Vn(t) = Ω(t + τn) = (E/T ) exp⌊−π[(t + τn)/T ]2⌋
(8.50)

470
ULTRA WIDE BAND RADIO
−1.0
−0.5
0.0
0.5
1.0
−0.10
−0.05
0.00
0.05
0.10
Normalized amplitude
angle f (deg)
(a)
−1.0
−0.5
0.0
0.5
1.0
−0.10
−0.05
0.00
0.05
0.10
Normalized amplitude
angle f (deg)
(b)
Figure 8.32 Normalized monopulse signal Υ(t, φ)/(mT E2
0) plotted as a function of
relative time t/T for (a) α = 3, ρ = 10, and the values of the angle of
incidence φ = +20 (solid line), and φ = −20 (dotted line) and repeated for
(b) φ = 20 (solid line), φ = 30 (dashed line), φ = 40 (dotted line).
with τn = (a/c) sin θ cos(φ −φn). To steer the peak of the main beam of the array in the (θ0, φ0)
direction, a delay
αn = −τn (θ0, φ0) = −(a/c) sin θ0 cos (φ0 −φn)
(8.51)
must be applied to the voltage signal Vn(t). So, the overall received signal is
VT (t, θ, φ) =
N

n=1
Ω(t + τn + αn)
(8.52)
We will use notation
ρc = (a/cT ) = 2f a/c,
f = 1/2T
(8.53)
ηs = sin θ sin φ −sin θ0 sin φ0
ηc = sin θ cos φ −sin θ0 cos φ0

BEAMFORMING FOR UWB RADIO
471
x
y
z
N
1
2
3
n
n+1
N-1
φ
φn
ψn
θ
r
Rn
P(r,θ,φ)
a
Figure 8.33 Geometry of an N-element circular array with radius a.
η0 = [(ηc)2 + (ηs)2]1/2
cos ξ = ηc
η0
ξ = arctan ηs
ηc
Equations (8.52) and (8.54) together result in:
(αn + τn)/T = ρcη0 cos (ξ −φn)
(8.54)
and we have
VT (t, θ, φ) = (E/T )
N

n=1
exp{−π [(t/T ) + ρcη0 cos (ξ −φn)]2}
(8.55)
For a main beam in the vertical direction along the z-axis θ0 = 0 which yields αn = αnv = 0, η0 =
η0v = sin θ, ξ = ξv = φ and we have:
Vv(t, θ, φ) = (E/T )
N

n=1
exp
!
−π [(t/T ) + ρc sin θ cos (φ −φn)]2"
(8.56)
A main beam can be formed in the principal horizontal plane (z = 0) by setting θ0 = π/2 which
gives
αn = αnh = −(a/c) cos (φ0 −φn)
η0 = η0h = 2 sin
	φ0 −φn
2

(8.57)
ξ = ξh = π + φ0 + φn
2

472
ULTRA WIDE BAND RADIO
−2
−1
0
1
2
0.0
0.2
0.4
0.6
0.8
1.0
1.2
1.0
0.8
0.6
Vv(t,θ,φ)/N(E/∆Τ)
t/∆T
ρcsinθ = 0.0
0.2
0.4
Figure 8.34 The time variation of the normalized voltage signal VV (t, θ, φ) for ρc sin θ =
0, 0.2, 0.4, 0.6, 0.8, 1, and 1.2.
and we have
Vh(t, φ) = (E/T ) ×
N

n=1
exp

−π

(t/T ) + 2ρc sin
	φ −φ0
2

× cos
	π + φ0 + φ −2φn
2

2#
(8.58)
A graph of Vv(t, θ, φ)/N(E/T ) is shown in Figure 8.34
By using Figure 8.34, we deﬁne the peak amplitude pattern
A(θ, φ) = VT (0, θ, φ)/N(E/T ) = 1
N
N

n=1
exp{−π [ρcη0 cos (ξ −φn)]2}
(8.59)
Similarly, we have, for the vertical and the horizontal peak amplitude patterns, the following expres-
sions
Av(θ, φ) = Vv(0, θ, φ)/N(E/T) = 1
N
N

n=1
exp{−π [ρc sin θ cos (φ −φn)]2}
Ah(φ) = 1
N
N

n=1
exp
$
−π

2ρc sin
	φ −φ0
2

cos
	π + φ0 + φ −2φn
2

2#
(8.60)
In a similar way, one can show that for sinusoidal waves with the time variation exp ( jωt), the
Array factor, AF, of an N-element circular array is given by [41, 42]:
AF (θ, φ) =
N

n=1
In exp [ jρsη0 cos (ξ −φn)]
(8.61)
where
ρs = 2πa/λ,
λ = wavelength,
(8.62)

BEAMFORMING FOR UWB RADIO
473
In is the amplitude excitation of the array element n. For constant In = I we have:
AF (θ, φ) = NI
N

n=1
JmN (ρsη0) exp

jmN
π
2 −ξ
 
(8.63)
where Jx( ) is the Bessel function of the ﬁrst kind. The vertical and the horizontal amplitude patterns
are now given as:
AFv (θ, φ) = NI
N

n=1
JmN (ρs sin θ) exp

jmN
π
2 −φ
 
(8.64)
AFh (φ) = NI
N

n=1
JmN
	
2ρs sin φ
2

exp

−jmNφ
2

For periodic sinusoidal signals, the square of the amplitude pattern, AF(θ, φ), represents the
average power pattern Pav(θ, φ). We also deﬁne the vertical and horizontal power patterns as
Pav,v (θ, φ) = [AFv (θ, φ)]2
(8.65)
Pav,h (θ, φ) = [AFh (θ, φ)]2
The peak power pattern is deﬁned as
P(θ, φ) = [A(θ, φ)]2 = 1
N 2
 N

n=1
exp{−π [ρcη0 cos (ξ −φn)]2}
2
(8.66)
We also deﬁne the vertical and horizontal peak power patterns as
Pv(θ, φ) = [Av(θ, φ)]2
(8.67)
Ph(φ) = [Ah(φ)]2
The average power or energy pattern is deﬁned as
W(θ, φ) =
∞
−∞
[VT (t, θ, φ)]2 dt
∞
−∞
[VT (t, θ0, φ0)]2 dt
=
∞
−∞
 N
n=1
exp{−π [(t/T ) + ρcη0 cos (ξ −φn)]2}
2
dt
N 2
∞
−∞
exp{−2π [(t/T )]2}dt
(8.68)
As before, for the vertical and horizontal components, we have
Wv(θ, φ) =
∞
−∞
 N
n=1
exp
!
−π [(t/T ) + ρc sin θ cos (φ −φn)]2"2
dt
N 2
∞
−∞
exp
!
−2π [(t/T )]2"
dt
(8.69)
Wh(θ, φ)
=
∞
−∞

N
n=1
exp
$
−π

(t/T ) + 2ρc sin
	φ −φ0
2

cos
	φ + φ0 + π −2φn
2

2#2
dt
N 2
∞
−∞
exp{−2π[(t/T )]2}dt
(8.70)
Some numerical results are shown in Figures 8.35–8.44

474
ULTRA WIDE BAND RADIO
0.8
0.85
0.9
0.95
1
0.8
0.85
0.9
0.95
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
AFv(θ,φ)
(a)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
AFv(θ,φ)
(b)
Figure 8.35 Normalized amplitude pattern AFv(θ, φ) given in Equation (8.65) for an in-
ﬁnitely extended periodic sinusoidal wave received by the circular array in
Figure 8.33 with N = 16 elements and (a) ρs = 1; (b) ρs = 3; (c) ρs = 6; (d)
ρs = 12.

BEAMFORMING FOR UWB RADIO
475
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
AFv(θ,φ)
(c)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
AFv(θ,φ)
(d)
Figure 8.35 (Cont.).

476
ULTRA WIDE BAND RADIO
0.6
0.7
0.8
0.9
1
0.6
0.7
0.8
0.9
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pav,v(θ,φ)
(a)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pav,v(θ,φ)
(b)
Figure 8.36 Normalized average power pattern Pav,v(θ, φ) given in Equation (8.66) for an
inﬁnitely extended periodic sinusoidal wave received by the circular array in
Figure 8.33 with N = 16 elements and (a) ρs = 1; (b) ρs = 3; (c) ρs = 6; (d)
ρs = 12.

BEAMFORMING FOR UWB RADIO
477
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pav,v(θ,φ)
(c)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pav,v(θ,φ)
(d)
Figure 8.36 (Cont.).

478
ULTRA WIDE BAND RADIO
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
AFv(θ,φ)
(a)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
AFv(θ,φ)
(b)
Figure 8.37 Normalized amplitude pattern AFv(θ, φ) given in Equation (8.65) for an in-
ﬁnitely extended periodic sinusoidal wave received by the circular array in
Figure 8.33 with ρs = 12 and (a) N = 10 elements; (b) N = 32 elements.

BEAMFORMING FOR UWB RADIO
479
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pav,v(θ,φ)
(a)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pav,v(θ,φ)
(b)
Figure 8.38 Normalized average power pattern Pav,v(θ, φ) given in Equation (8.66) for an
inﬁnitely, extended periodic sinusoidal wave received by the circular array in
Figure 8.33 with ρs = 12 and (a) N = 10 elements; (b) N = 32 elements.

480
ULTRA WIDE BAND RADIO
0.4
0.6
0.8
1
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Av (θ,φ)
(a)
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Av(θ,φ)
(b)
Figure 8.39 Peak amplitude pattern Av(θ, φ) given in Equation (8.61) for non-sinusoidal
Gaussian pulses received by the circular array in Figure 8.33 with N = 16
elements and (a) ρs = 1; (b) ρs = 3; (c) ρs = 6; (d) ρs = 12.

BEAMFORMING FOR UWB RADIO
481
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Av(θ,φ)
(c)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Av(θ,φ)
(d)
Figure 8.39 (Cont.).
A slope pattern S(θ, φ), a vertical slope pattern Sv(θ, φ) and a horizontal slope pattern Sh(φ) can
be derived by using a linear regression algorithm to calculate the slope of the ramp that best ﬁts the
rising section of the Gaussian pulse VT (t, θ, φ), Vv(t, θ, φ) and Vh(t, φ). A plot of the ramp slope
versus angle results in a slope pattern.
More details on practical aspects of UWB antenna and receiver design can be found in [43–88].

482
ULTRA WIDE BAND RADIO
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(a)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(b)
Figure 8.40 Peak power pattern Pv(θ, φ) given in Equation (8.68) for non-sinusoidal
Gaussian pulses received by the circular array in Figure 8.33 with N = 16
elements and (a) ρs = 1; (b) ρs = 3; (c) ρs = 6; (d) ρs = 12.

BEAMFORMING FOR UWB RADIO
483
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(c)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(d)
Figure 8.40 (Cont.).

484
ULTRA WIDE BAND RADIO
0.6
0.8
1
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Wv(θ,φ)
(a)
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Wv(θ,φ)
(b)
Figure 8.41 Energy pattern Wv(θ, φ) given in Equation (8.70) for non-sinusoidal Gaussian
pulses received by the circular array in Figure 8.33 with N = 16 elements and
(a) ρs = 1; (b) ρs = 3; (c) ρs = 6; (d) ρs = 12.

BEAMFORMING FOR UWB RADIO
485
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ
°
φ
°
φ
°
θ
°
φ
°
θ
°
φ
°
φ
°
θ φ
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ
°
φ
°
φ
°
θ
°
φ
°
θ
°
φ
°
φ
°
θ φ
(c)
(d)
v
v
Figure 8.41 (Cont.).

486
ULTRA WIDE BAND RADIO
0.4
0.6
0.8
1
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Av(θ,φ)
(a)
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Av(θ,φ)
(b)
Figure 8.42 Peak amplitude pattern Av(θ, φ) for non-sinusoidal Gaussian pulses received
by the circular array with a large number (N →∞) of elements and (a) ρs = 1;
(b) ρs = 3; (c) ρs = 6; (d) ρs = 10.

BEAMFORMING FOR UWB RADIO
487
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ
°
φ
°
φ
°
θ
°
φ
°
θ
°
φ
°
φ
°
θ φ
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ
°
φ
°
φ
°
θ
°
φ
°
θ
°
φ
°
φ
°
θ φ
v
(c)
(d)
v
Figure 8.42 (Cont.).

488
ULTRA WIDE BAND RADIO
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(a)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(b)
Figure 8.43 Peak power pattern Pv(θ, φ) for non-sinusoidal Gaussian pulses received by
the circular array with a large number (N →∞) of elements and (a) ρs = 1;
(b) ρs = 3; (c) ρs = 6; (d) ρs = 10.

BEAMFORMING FOR UWB RADIO
489
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(c)
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Pv(θ,φ)
(d)
Figure 8.43 (Cont.).

490
ULTRA WIDE BAND RADIO
0.6
0.8
1
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Wv(θ,φ)
(a)
0.2
0.4
0.6
0.8
1
0.2
0.4
0.6
0.8
1
θ = 90°
φ = 135°
φ = 90°
θ = 90°
φ = 45°
θ = 90°
φ = 315°
φ = 0°
Wv(θ,φ)
(b)
Figure 8.44 Energy pattern Wv(θ, φ) for non-sinusoidal Gaussian pulses received by the
circular array with a large number (N →∞) of elements and (a) ρs = 1; (b)
ρs = 3; (c) ρs = 6; (d) ρs = 10.

BEAMFORMING FOR UWB RADIO
491
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ
°
φ
°
φ
°
θ
°
φ
°
θ
°
φ
°
φ
°
θ φ
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ
°
φ
°
φ
°
θ
°
φ
°
θ
°
φ
°
φ
°
θ φ
v
(c)
(d)
v
Figure 8.44 (Cont.).

492
ULTRA WIDE BAND RADIO
REFERENCES
1. Win, M. Z. and Scholtz, R. A. (1998) Impulse radio: How it works, IEEE Communications
Letters, 2, 36–38.
2. Scholtz, R. A. (1993) Multiple access with time-hopping impulse modulation, in Proceedings
of MILCOM, October 1993, pp. 447–450.
3. Win, M. Z. and Scholtz, R. A. (1998) On the energy capture of ultrawide bandwidth signals in
dense multipath environments, IEEE Communications Letters, 2(9), 245–247.
4. Win, M. Z., Scholtz, R. A. and Barnes, M. A. (1997) Ultra-wide bandwidth signal propagation
for indoor wireless communications, in Proceedings of the IEEE International Conference on
Communications, Montreal, Canada, June 1997, pp. 56–60.
5. Cramer, R. J.-M., Scholtz, R. A. and Win, M. Z. (2002) Evaluation of an ultra-wide-band
propagation channel, IEEE Transactions on Antennas and Propagation, 50(5), 561–570.
6. Schantz, H. G. and Fullerton, L. (2001) The diamond dipole: A Gaussian impulse antenna,
Proceedings of the IEEE AP-S International Symposium, July 8–13, 2001.
7. Scholtz, R. A. and Win, M. Z. (1997) Impulse radio, in Wireless Communications: TDMA versus
CDMA, S. G. Glisic and P. A. Lepp¨anen (Eds.) Kluwer, Norwell, MA.
8. Hashemi, H. (1993) The indoor radio propagation channel, Proceedings of the IEEE, 81, 943–
968.
9. Liberti, J. C. and Rappaport, T. S. (1999) Smart Antennas for Wireless Communications: IS-95
and Third Generation CDMA Applications. Prentice Hall, Englewood Cliffs, NJ.
10. Saleh, A. A. M. and Valenzuela, R. A. (1987) A statistical model for indoor multipath propaga-
tion, IEEE Journal on Selected Areas in Communications, 5, 128–137.
11. Spencer, Q., Rice, M., Jeffs, B. and Jensen, M. (1997) A statistical model for the angle-of-arrival
in indoor multipath propagation, in Proceedings of the IEEE Vehicular Technology Conference,
1415–1419.
12. Spencer, Q., Jeffs, B., Jensen, M. and Swindlehurst, A. (2000) Modeling the statistical time and
angle of arrival characteristics of an indoor multipath channel, IEEE Journal on Selected Areas
in Communications, 18, 347–360.
13. Vaughan, R. G. and Scott, N. L. (1999) Super-resolution of pulsed multipath channels for delay
spread characterization, IEEE Transactions On Communications, 47, 343–347.
14. Yano, S. M. (2002) Investigating the ultra-wideband indoor wireless channel, IEEE 55th Vehic-
ular Technology Conference (VTC Spring 2002) 6–9 May 2002, 3, 1200–1204.
15. Rappaport, T. S. (1966) Wireless Communications: Principles and Practices, Prentice Hall.
16. Cassioli, D. et al. (2001) A statistical model for the UWB indoor channel, IEEE VTC2001, 2,
1159–1163.
17. Ghassemzadeh, S. S., Jana, R., Rice, C. W., Turin, W. and Tarokh, V. (2002) A statistical path
loss model for in-home UWB channels, IEEE Conference on Ultra Wideband Systems and
Technologies, 21–23 May 2002, pp. 59–64.
18. Turin, W., Jana, R., Ghassemzadeh, S. S., Rice, C. W. and Tarokh, T. (2002) Autoregressive
modelling of an indoor UWB channel, IEEE Conference on Ultra Wideband Systems and
Technologies, 21–23 May 2002, pp. 71–74.
19. Ghassemzadeh, S. S. and Tarokh, V. (2003) UWB path loss characterization in residential
environments, IEEE Radio Frequency Integrated Circuits (RFIC) Symposium, June 8–10 2003,
pp. 501–504.

REFERENCES
493
20. Ghassemzadeh, S. S. and Tarokh, V. (2003) UWB path loss characterization in residential
environments, IEEE MTT-S International Microwave Symposium Digest, 8–13 June 2003, 1,
365–368.
21. Ramirez-Mireles, F. (2001) On the performance of ultra-wide-band signals in Gaussian noise
and dense multipath, IEEE Transactions on Vehicular Technology, 50(1), 244–249.
22. Gagliardi, R. M. (1988) Introduction to Telecommunications Engineering. John Wiley & Sons,
Inc., New York, pp. 357–437.
23. Win, M. Z., Ram´ırez-Mireles, F., Scholtz, R. A. and Barnes, M. A. (1997) Ultra-wide bandwidth
(UWB) signal propagation for outdoor wireless communications, in Proceedings of the IEEE
VTC Conference, May 1997, pp. 251–255.
24. Ram´ırez-Mireles, F. and Scholtz, R. A. (1998) Time-shift-keyed equicorrelated signal sets for
impulse radio M-ary modulation, in Proceedings of the IEEE Wireless Conference, pp. 404–408.
25. Ram´ırez-Mireles, F. and Scholtz, R. A. (1997) Performance of equicorrelated ultra-wideband
pulse-position-modulated signals in the indoor wireless impulse radio channel, in Proceedings
of the IEEE PACRIM Conference, pp. 640–644.
26. Ram´ırez-Mireles, F. (2001) Performance of ultrawideband SSMA using time hopping and M-ary
PPM, IEEE Journal on Selected Areas in Communications, 19(6), 1186–1196.
27. Ram´ırez-Mireles, F. (1998) Multiple-access with ultra-wideband impulse radio modulation us-
ing spread spectrum time-hopping and block waveform pulse-position-modulated signals, Ph.D.
dissertation, Communication Sciences Institute, Electrical Engineering Department, University
of Southern California.
28. Georghiades, C. N. (1988) On PPM sequences with good autocorrelation properties, IEEE
Transactions On Information Theory, 34, 571–576.
29. Gagliardi, R., Robbins, J. and Taylor, H. (1987) Acquisition sequences in PPM communications,
IEEE Transactions On Information Theory, 33, 738–744.
30. Golomb, S. W. (1991) Construction of signals with favorable correlation properties, in Surveys
in Combinatorics, Cambridge University Press, Cambridge.
31. Forouzan, A. R., Nasiri-Kenari, M. and Salehi, J. A. (2002) Performance analysis of time-
hopping spread-spectrum multiple-access systems: uncoded and coded schemes, IEEE Trans-
actions on Wireless Communications, 1, 671–681.
32. Viterbi, A. J. (1990) Very low-rate convolutional codes for maximum theoretical performance of
spread-spectrum multiple-access channels, IEEE Journal on Selected Areas in Communications,
8, 641–649.
33. Viterbi, A. (1995) CDMA: Principles of Spread-Spectrum Communication. Addison Wesley,
Reading, MA.
34. Shaft, P. D. (1977) Low-rate convolutional code application in spread-spectrum communica-
tions, IEEE Transactions On Communications, COM-25, 815–821.
35. Win, M. Z., Qiu, X., Scholtz, R. A. and Li, V. O. K. (1999) ATM-based TH-SSMA network for
multimedia PCS, IEEE Journal on Selected Areas in Communications, 17, 824–836.
36. Le Martret, C. J. and Giannakis, G. B. (2002) All-digital impulse radio with multiuser detection
for wireless cellular systems, IEEE Transactions On Communications, 50, 1440–1450.
37. Hussain, M. G. M. (2002) Principles of space–time array processing for ultrawide-band impulse
radar and radio communications, IEEE Transactions on Vehicular Technology, 51, 393–403.
38. Hussain, M. G. M. (1988) Performance analysis and advancement of self-steering arrays for
nonsinusoidal waves–I, II, IEEE Transactions on Electromagnetic Compatibility, 30, 161–174.

494
ULTRA WIDE BAND RADIO
39. Hussain, M. G. M. (1988) A self-steering array for nonsinusoidal waves based on array impulse
response measurement, IEEE Transactions on Electromagnetic Compatibility, 30, 154–160.
40. Hussain, M. G. M., Al-Halabi, M. M. M. and Omar, A. A. (1989) Antenna patterns of non-
sinusoidal waves with the time variation of a Gaussian pulse–Part III, IEEE Transactions on
Electromagnetic Compatibility, 31, 34–47.
41. Balanis, C. A. (1982) Antenna Theory Analysis and Design, Harper and Row, New York, pp.
274–279.
42. Ma, M. T. (1974) Theory and Application of Antenna Arrays, John Wiley & Sons New York,
pp. 191–202.
43. Hussain, M. G. M. (1988) Antenna patterns for nonsinusoidal waves with the time variation
of a Gaussian pulse–Part I and II, IEEE Transactions on Electromagnetic Compatibility, 30,
504–522.
44. Rajeswaran, A., Somayazulu, V. S. and Foerster, J. R. (2003) RAKE performance for a pulse
based UWB system in a realistic UWB indoor channel, IEEE International Conference on
Communications, 4, 2879–2883.
45. Canadeo, C. M., Temple, M. A., Baldwin, R. O. and Raines, R. A. (2003) UWB multiple access
performance in synchronous and asynchronous networks, Electronics Letters, 39(11), 880–882.
46. Miller, L. E. (2003) Autocorrelation functions for Hermite-polynomial ultra-wideband pulses,
Electronics Letters, 39(11), 870–871.
47. Porcino, D. and Hirt, W. (2003) Ultra-wideband radio technology: potential and challenges
ahead, IEEE Communications Magazine, 41(7), 66–74.
48. Aiello, G. R. and Rogerson, G. D. (2003) Ultra-wideband wireless systems, IEEE Microwave
Magazine, 4(2), 36–47.
49. Hyun-Jin Park, Mi-Jeong Kim, Yoon-Jae So, Young-Hwan You and Hyoung-Kyu Song (2003)
UWB communication system for home entertainment network, IEEE Transactions on Consumer
Electronics, 49(2), 302–311.
50. Durisi, G. and Benedetto, S. (2003) Performance evaluation of TH-PPM UWB systems in the
presence of multiuser interference, IEEE Communications Letters, 7(5), 224–226.
51. Parr, B., ByungLok Cho, Wallace, K. and Zhi Ding (2003) A novel ultra-wideband pulse design
algorithm, IEEE Communications Letters, 7(5), 219–221.
52. Won Namgoong (2003) A channelized digital ultrawideband receiver, IEEE Transactions on
Wireless Communications, 2(3), 502–510.
53. Nakagawa, M., Honggang Zhang and Sato, H. (2003) Ubiquitous homelinks based on IEEE
1394 and ultra wideband solutions, IEEE Communications Magazine, 41(4), 74–82.
54. Saberinia, E. and Tewﬁk, A. H. (2003) Single and multi-carrier UWB communications, Seventh
International Symposium on Signal Processing and Its Applications, July 1–4, 2003, 2, 343–346.
55. Saberinia, E. and Tewﬁk, A. H. (2003) Receiver structures for multi-carrier UWB systems,
Seventh International Symposium on Signal Processing and Its Applications, July 1–4, 2003, 1,
313–316.
56. Pidre Mosquera, J. M. and Isasa, M. V. (2003) Planar resistively loaded UWB dipoles analysis
and comparison, IEEE Society International Conference on Antennas and Propagation, June
22–27 2003, 3, 636–639.
57. Taniguchi, T. and Kobayashi, T. (2003) An omnidirectional and low-vswr antenna for the
FCC-approved UWB frequency band, IEEE Society International Conference on Antennas and
Propagation, June 22–27 2003, 3, 460–463.

REFERENCES
495
58. Schantz, H. G. (2003) UWB magnetic antennas, IEEE Society International Conference on
Antennas and Propagation, June 22–27 2003, 3, 604–607.
59. Ogawa, T., Tomiki, A. and Kobayashi, T. (2003) Development of two kinds of UWB sources for
propagation, EMC and other experimental studies: impulse radio and direct-sequence spread
spectrum, IEEE Society International Conference on Antennas and Propagation, June 22–27
2003, 3, 273–276.
60. Xianming Qing, Wah Chia, M. Y. and Xuanhui Wu (2003) Wide-slot antenna for uwb applica-
tions, IEEE Society International Conference on Antennas and Propagation, June 22–27 2003,
1, 834–837.
61. Kerkhoff, A. and Hao Ling (2003) Design of a planar monopole antenna for use with ultra-
wideband (uwb) having a band-notched characteristic, IEEE Society International Conference
on Antennas and Propagation, June 22–27 2003, 1, 830–833.
62. Zwierzchowski, S. and Jazayeri, P. (2003) A systems and network analysis approach to antenna
design for uwb communications, IEEE Society International Conference on Antennas and
Propagation, June 22–27 2003, 1, 826–829
63. Zhi Ning Chen, Xuan Hui Wu, Ning Yang and Chia, M. Y. W (2003) Design considerations for
antennas in uwb wireless communication systems, IEEE Society International Conference on
Antennas and Propagation, June 22–27 2003, 1, 822–825.
64. Kwan-ho Lee, Chi-Chih Chen, Teixeira, F. L. and Lee, R. (2003) Numerical study of a uwb dual-
polarized feed design for enhanced tapered chambers, IEEE Society International Conference
on Antennas and Propagation, June 22–27 2003, 1, 265–268.
65. Ghassemzadeh, S. S. and Tarokh, V. (2003) UWB path loss characterization in residential
environments, IEEE Radio Frequency Integrated Circuits (RFIC) Symposium, June 8–10 2003,
pp. 501–504.
66. Aiello, G. R. (2003) Challenges for ultra-wideband (UWB) CMOS integration, IEEE Radio
Frequency Integrated Circuits (RFIC) Symposium, June 8–10 2003, pp. 497–500.
67. Woo Cheol Chung and Dong Sam Ha (2003) On the performance of bi-phase modulated uwb
signals in a multipath channel, IEEE Vehicular Technology Conference, April 22–25 2003, 3,
1654–1658.
68. Piazzo, L. and Romme, J. (2003) Spectrum control by means of the th code in uwb systems,
IEEE Vehicular Technology Conference, April 22–25 2003, 3, 1649–1653.
69. Guangrong Yue, Lijia Ge and Shaoqian Li (2003) Performance of uwb time-hopping spread-
spectrum impulse radio in multipath environments, IEEE Vehicular Technology Conference,
April 22–25 2003, 3, 1644–1648.
70. Terri, M., Hong, A., Guibe, G. and Legrand, F. (2003) Major characteristics of UWB indoor
transmission for simulation, IEEE Vehicular Technology Conference, April 22–25, 2003 1,
19–23.
71. Yongfu Huang, Xiangning Fan, Jiang Wang and Guangguo Bi (2003) Analysis of the energy
dynamic of UWB signal in multi-path environments, IEEE Vehicular Technology Conference,
April 22–25 2003, 1, 15–18.
72. Ray-Rong Lao, Jeon-Hwan Tarng and Chiuder Hsiao (2003) Transmission coefﬁcients mea-
surement of building materials for UWB systems in 3–10 GHz, IEEE Vehicular Technology
Conference, April 22–25 2003, 1, 11–14.
73. Alvarez, A., Valera, G., Lobeira, M., Torres, R. and Garcia, J. L. (2003) New channel impulse
response model for UWB indoor system simulations, IEEE Vehicular Technology Conference,
April 22–25 2003, 1, 1–5.

496
ULTRA WIDE BAND RADIO
74. Nakache, Y.-P. and Molisch, A. F. (2003) Spectral shape of UWB signals inﬂuence of modulation
format, multiple access scheme and pulse shape, IEEE Vehicular Technology Conference, April
22–25 2003, 4, 2510–2514.
75. Saberinia, E. and Tewﬁk, A. H. (2003) Generating UWB-OFDM signal using sigma-delta
modulator, IEEE Vehicular Technology Conference, April 22–25 2003, 2, 1425–1429.
76. Durisi, G. and Benedetto, S. (2003) Performance evaluation and comparison of different mod-
ulation schemes for UWB multi access systems, IEEE International Conference on Communi-
cations, 11–15 May 2003, 3, 2187–2191.
77. Nassar, C. R., Fang Zhu and Zhiqiang Wu (2003) Direct sequence spreading UWB systems:
frequency domain processing for enhanced performance and throughput, IEEE International
Conference on Communications, 11–15 May 2003, 3, 2180–2186.
78. Baccarelli, E. and Biagi, M. (2003) An adaptive codec for multi-user interference mitigation for
UWB-based WLANs, IEEE International Conference on Communications, 11–15 May 2003,
3, 2020–2024.
79. Cassioli, D., Win, M. Z., Vatalaro, F. and Molisch, A. F. (2003) Effects of spreading bandwidth on
the performance of UWB RAKE receivers, IEEE International Conference on Communications,
11–15 May 2003, 5, 3545–3549.
80. Kusuma, J., Maravic, I. and Vetterli, M. (2003) Sampling with ﬁnite rate of innovation: Channel
and timing estimation for UWB and GPS, IEEE International Conference on Communications,
11–15 May 2003, 5, 3540–3544.
81. Yamamoto, N. and Ohtsuki, T. (2003) Adaptive internally turbo-coded ultra wideband-impulse
radio (AITC-UWB-IR) system, IEEE International Conference on Communications, 11–15
May 2003, 5, 3535–3539.
82. Weisenhorn, M. and Hirt, W. (2003) Performance of binary antipodal signaling over the indoor
UWB MIMO channel, IEEE International Conference on Communications, 11–15 May 2003,
4, 2872–2878.
83. Saberinia, E. and Tewﬁk, A. H. (2003) N-tone sigma-delta uwb-ofdm transmitter and receiver,
IEEE International Conference on Acoustics, Speech, and Signal Processing, (ICASSP’03),
April 6–10 2003, 4, IV-129–IV-132.
84. Huaning Niu, Ritcey, J. A. and Hai Liu (2003) Performance of uwb RAKE receivers with
imperfect tap weights, IEEE International Conference on Acoustics, Speech, and Signal Pro-
cessing(ICASSP’03), April 6–10, 2003, 4, IV-125–IV-128.
85. Mo, S. S., Gelman, A. D. and Gopal, J. (2003) Frame synchronization in UWB using multiple
SYNC words to eliminate line frequencies, IEEE Wireless Communications and Networking
Conference, 16–20 March 2003, 2, 773–778.
86. Canadeo, C. M., Temple, M. A., Baldwin, R. O. and Raines, R. A. (2003) Code selection for
enhancing UWB multiple access communication performance using TH-PPM and DS-BPSK
modulations, IEEE Wireless Communications and Networking Conference, 16–20 March 2003,
2, 678–682.
87. Boubaker, N. and Letaief, K. B. (2003) A low complexity MMSE-RAKE receiver in a realistic
UWB channel and in the presence of NBI, IEEE Wireless Communications and Networking
Conference, 16–20 March 2003, 1, 233–237.
88. Siwiak, K., Bertoni, H. and Yano, S. M. (2003) Relation between multipath and wave propagation
attenuation, Electronics Letters, 39(1), 142–143.

9
Linear Precoding for
MIMO Channels
9.1
SPACE–TIME PRECODERS AND EQUALIZERS FOR MIMO CHANNELS
In this section the problem of equalization, which was initiated in Chapter 6 for single-input–single-
output (SISO) systems, is extended to multiple-input–multiple-output (MIMO) channels.
9.1.1
ISI modelling in MIMO channels
Let us assume a MIMO channel with p transmitters and q receivers. Let s j (k) denote the sequence
from transmitter j ( j = 1, . . . , p), and let hi j (k) be the channel response from input j to output
i (i = 1, . . . , q). Consequently, the output sequence at the receiver i is:
xi (k) =
p

j=1
d

l=0
hi j (l) s j (k −l)
(9.1)
where d denotes the maximal ISI degree. The above convolution can be equivalently expressed in a
z-transform notation:
H (D) s (D) = x (D)
(9.2)
where s (D) =

s1 (D) s2 (D) . . . sp (D)
T , x (D) = [x1 (D) . . . xq (D)]T , and H (D) =

hi j (D)

are
the z-transform vectors (matrix) of the corresponding sequences or impulse responses where we use
a delay operator D = z−1. A p-input–q-output MIMO system can then be represented by the q × p
matrix H (D), called the transfer function of the MIMO system.
A transfer function H (D) is perfectly recoverable (PR) if and only if there exists a polynomial
matrix G (D) such that:
G (D) H (D) = Diag

Dk j 
(9.3)
where k j denotes the necessary delays incurred on the recovered jth source signal. The equality in
Equation (9.3) is referred to as a (generalized) Bezout identity and G (D) is referred to as a Bezout
inverse of H (D), which can perfectly recover the original signals in the absence of noise. Given a
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

498
LINEAR PRECODING FOR MIMO CHANNELS
MIMO system in Equation (9.1), the jth source signal is said to be perfectly recoverable (PR) with
a ρ j-tap equalizer (i.e., degree = ρ j −1) if there exists a (row) polynomial vector g (D) with degree
lower than ρ j such that:
g (D) x (D) = s j (D) Dk j
(9.4)
A polynomial matrix C (D) is said to be a (right) common factor of the columns in H (D) if
H (D) = H′ (D) C (D) and H′ (D) is itself a polynomial matrix. Moreover, a polynomial matrix is
unimodular if and only if its determinant is a constant. A polynomial matrix is said to be (right)
coprime if and only if there exists no nonunimodular right common factor. The right coprimeness of
H (D) requires it to have more rows than columns, i.e., q > p, except when it is a unimodular matrix.
In the sequel we will use some results from matrix theory [1]:
(R1) A MIMO system with transfer function H (D) is perfectly recoverable (PR) if and only if
H (D) is (right) coprime, except for a common factor with determinant Dk. (This property
will be called delay-permissive coprimeness.)
(R2) A MIMO system with transfer function H (D) is perfectly recoverable if and only if H (λ)
has full column rank for any (complex value), λ ̸= 0.
For any p-input–q-output MIMO transfer function H (D), there exists a unimodular polynomial
matrix U (D) [2] such that H (D) U (D) = ˆH (D) where ˆH (D) is a minimal basis (MB). The q × p
polynomial matrix ˆH (D) is called a minimal basis if and only if ˆH (D) is column reduced, i.e. its
(column-wise) highest-degree coefﬁcient matrix has full column rank. In the sequel, we will denote
the kth column degree of the MB ˆH (D) by µk.
The McMillan degree (which is denoted as η) of a q × p (p < q) polynomial matrix H (D) is
deﬁned as the highest degree of the determinants of all the p × p minors in H (D). It can be shown
[2] that η = p
k=1 µk.
Given a q × p (p < q) polynomial matrix H (D) with full column rank (on the polynomial ring),
a (q −p) × q polynomial matrix N (D) is called a null-space minimal basis (NMB) of H (D) if and
only if:
(1) N (D) is in the null space of H (D), i.e., N (D) H (D) = 0;
(2) N (D) is left-coprime;
(3) N (D) is row reduced, i.e., its (row-wise) highest-degree coefﬁcient matrix has full row rank.
We denote the row degrees of N (D) by {vi}q−p
i=1 . The degree of the minimal basis of the null space
of H (D) is deﬁned as:
v = max
i
{vi}
Any polynomial vector in the null subspace of H (D) can be expressed as a (polynomial-wise)
combination of the row vectors in N (D). For more properties of minimal basis, see [2, Chapter 6]
and [3]
The MIMO equivalent matrix ρ [H] is a block Toeplitz matrix (with ρ block-rows, i.e. ρ × q
rows):
ρ [H] =


Hd
Hd−1
· · ·
H0
0
· · ·
0
0
Hd
Hd−1
· · ·
H0
· · ·
0
...
...
...
...
...
...
...
0
· · ·
0
Hd
Hd−1
· · ·
H0


(9.5)
where Hi is the ith degree coefﬁcient matrix of H (D), i.e. H (D) = H0 + DH1 + · · · + DdHd.
The equivalent matrix can provide an effective tool for testing the coprimeness and, hence, the
recoverability (PR) of the MIMO system.

SPACE–TIME PRECODERS AND EQUALIZERS FOR MIMO CHANNELS
499
Reference [4] deﬁnes equivalent matrix test for MIMO recoverability as follows:
(a) A MIMO system H (D) is coprime if and only if there exists an integer ρ such that
rank {ρ [H]} = η + p × ρ
(9.6)
where η is the McMillan degree of H (D). (The smallest integer ρ to meet the above equality is
equal to the NMB degree of H (D), i.e., v).
(b) A MIMO system H (D) is PR if and only if there exists an integer ρ such that
rank {ρ [H]} = η′ + p × ρ
(9.7)
where η′ is the reduced McMillan degree of H (D), which can be obtained by simply subtracting
the degree contributed by those pure delay factors from the full McMillan degree. More precisely,
η′ = η −degree associated with pure delay factors.
Again, the smallest integer to meet the above equality is equal to the NMB degree v [4].
9.1.2
MIMO system precoding and equalization
The above system theory serves as a theoretical foundation for ﬂexible transceiver design of MIMO
systems. The analysis can be logically divided into the following categories:
(a) p < q, and the channel is known to receiver;
(b) p > q, and the channel is fed back to the transmitter;
(c) p ≥q, and the channel is known to the receiver;
(d) When p < q, the channel is known to the transmitter and the receiver.
Case (d) is usually handled without using transmitter channel knowledge, and hence, it can be treated
as (a). As outlined in the ﬂowchart in Figure 9.1, case (c) will be treated in Section 9.1.3, while cases
(a) and (b) are treated in Sections 9.1.2.1 and 9.1.2.2 respectively.
q × p Physical MIMO Channel (p-input–q-output)  
Bezout 
Equalizer 
Bezout 
Precoder 
w/o STBC 
(Section 9.1.2.1) 
• when p < q    
& channel is PR 
and known to 
receiver 
• when p > q
& channel is PR
and known to
transmitter  
Compare 
p & q 
qN × pW STBC 
Virtual MIMO 
Bezout Equalizer           
for qN × pW MIMO 
with STBC 
(Section 9.1.3) 
• when p < q but Physical    
Channel NOT Recoverable 
• when p ≥  q 
w/o STBC 
(Section 9.1.2.2) 
Figure 9.1 Design strategy is outlined in the ﬂow chart. The pure Bezout solutions are
outlined in the upper dashed box. The joint Bezout-STBC solutions will be
treated in the next section as shown in the lower dashed box.

500
LINEAR PRECODING FOR MIMO CHANNELS
According to (R1) and (R2) of the previous section, when p < q and the channel is known
to receiver, there exists a PR Bezout equalizer if and only if the q × p transfer function H (D) is
delay-permissive right coprime. More exactly, G (D) is a PR Bezout equalizer if and only if G (D)
satisﬁes
G (D) H (D) = Diag

Dk j 
Similarly, when p > q and the channel is known to the transmitter, there exists a PR Bezout
precoder if and only if the q × p transfer function H (D) is delay-permissive left coprime. More
exactly, F (D) is a PR Bezout precoder if and only if F (D) satisﬁes
H (D) F (D) = Diag

Dk j 
With such a Bezout precoder, the symbols received by the receiver will not only be ISI-free but also
ICI-free (containing only the desired stream’s information).
9.1.2.1
MIMO Bezout equalizer
To analyze the system performance under noisy conditions, we need to investigate the SNR in Bezout
inverse system.
The post-processing SNR is deﬁned as the SNR at the output of the equalizer. Assuming BPSK
constellation and that the bit is decided by zero thresholding, the BER can be determined as BER =
Q
√
SNR

.
The Bezout equalization (when p < q and channel is known to receiver) is illustrated in
Figure 9.2. For a Bezout equalizer system G (D) H (D) = Diag

Dk j 
, let us denote one row of
G (D) as g (D) = g0 + Dg1 + · · · + Dρ−1gρ−1, and let ⃗g denote the expanded row vector:
⃗g ≡

gρ−1
. . .
g1
g0

(9.8)
Obviously, the equalizer system can be designed separately for each individual stream. For the design
of an individual equalizer g(D), note that the i.i.d. additive-white-Gaussian noise (AWGN) will be
ﬁltered by g (D) before its effect appears at the output of the equalizer. This leads to the post-
processing noise power: σ 2
n
⃗g
2 = N0/2
⃗g
2, where N0 is the noise spectral density. Therefore, the
SNR pertaining to a Bezout equalizer can be derived as:
equalizer SNR =
2Eb
N0||⃗g||2
(9.9)
Bezout Equalizer 
+ 
+ 
( )
1s
n
( )
ps
n
( )
1
x
n
( )
q
x
n
( )
2
x
n
( )
H D
( )
G D
(
)
p
p
s
n-k
(
)
1
1
s
n-k
transmitter 
channel 
receiver 
Figure 9.2 Bezout equalizer G (D) H (D) = Diag

Dk j
with p < q.

SPACE–TIME PRECODERS AND EQUALIZERS FOR MIMO CHANNELS
501
where Eb is the transmit energy per bit. This immediately suggests a design criterion of minimizing
the 2-norm of the equalizer.
From Figure 9.2, we note that the problem of designing an optimal Bezout equalizer for all the
source inputs can be decoupled into the task of separately designing many individual equalizers, one
for each input. The strategy of designing an optimal (individual) Bezout equalizer (for the jth input)
is to ﬁnd g (D) with minimal two-norm
⃗g
 such that:
g (D) H (D) =

0
. . .
Dk j
. . .
0

,
j = 1, . . . , p
Equivalently, in a resultant matrix notation:
⃗gρ [H] = ei
(9.10)
where ei is a row vector with all elements being zero except an entry 1 at j + p

d + ρ −1 −k j

,
k j = 0, . . . , d + ρ −1. The derivation of Bezout inverse depends not only on the equalizer order but
also on the system delay k j. The solution of an individual Bezout inverse is given in Equation (9.10).
Take singular value decomposition (SVD) on ρ[H] : ρ[H] = UV, where  is a square diagonal
matrix of positive singular values. Then, a Bezout inverse for Equation (9.10) exists if (and only if)
there is a solution b for bV = ei, and thereafter, the Bezout solution ⃗g = b−1UH= eiVH−1UH
yields a minimum-norm solution with the optimal 2-norm
⃗g
2 = eiVH−2VeH
i
(9.11)
Note that the system delay k j provides an extra (and important) degree of freedom for the Bezout
inverse. Selection of k j is just the same as selecting i since i = j + p

d + ρ −1 −k j

. The best
integer i minimizing the 2-norm in Equation (9.11) is:
i∗= arg min
i

VH−2
ii |i = j (mod p),
ei ∈Row Span {V}

(9.12)
9.1.2.2
Bezout MIMO precoder
When p > q and the channel is known to transmitter a Bezout precoder system exists as illustrated
in Figure 9.3. Mathematically
H (D) F (D) = Diag

Dk j 
(9.13)
Let us denote one column of F (D) as f (D) = f0 + Df1 + · · · + Dρ−1fρ−1, and its expanded col-
umn vector ⃗f ≡[fT
ρ−1
. . .
fT
1
fT
0 ]T . Let σ 2
s be the input variance for one stream. Each precoding
Bezout Precoder
( )
1s
n
( )
qs
n
( )
ps
n
′
( )
2s
n
′
( )
1s
n
′
( )
F D
( )
H D
(
)
1
1
s
n-k
transmitter
channel
receiver
( )
1
x
n =
(
)
p
p
s
n-k
( )
q
x
n =
Figure 9.3 Bezout precoder: H (D) F (D) = Diag

Dk j
with p < q.

502
LINEAR PRECODING FOR MIMO CHANNELS
column vector f (D) ampliﬁes the transmitter’s power to σ 2
s ∥⃗f∥2. In order to have an ISI-free commu-
nication, we must have H(D)f(D) = [0
. . .
Dk j
. . .
0]T , which produces a signal power of
σ 2
s at each receiver. Moreover, we must set σ 2
s = Eb/∥⃗f∥2 in order to normalize the transmit energy
per bit to Eb. In this case, the SNR for the Bezout precoder becomes
precoder SNR =
2Eb
N0∥⃗f∥2
(9.14)
Note that the noise power at each receiver is N0/2.
Equation (9.14) establishes a useful duality between the optimal designs of Bezout equalizer
and precoder systems. The optimal precoder design for a MIMO system H (D) is equivalent to
the optimal equalizer design for a MIMO with transfer function H (D)H. Similarly to the previous
equalizer design, design of an optimal Bezout precoder can be decoupled into the task of separately
designing many individual precoders: one for each output.
An optimal (individual) Bezout precoder can be obtained by ﬁnding f (D), with minimal two-norm
such that H (D) f (D) =

0
. . .
Dk j
. . .
0
H. Equivalently, in a resultant matrix notation
ρ 
HHH ⃗f = ei
(9.15)
where ei is now a column vector with all zeros, except an entry 1 at i = j + q(d+ ρ −1 −k j),
k j = 0, . . . , d + ρ −1. Take SVD on ρ 
HHH as
ρ 
HHH = UV
(9.16)
For a given index i, a Bezout precoder ⃗f for Equation (9.15) exists iff a solution b for Ub = ei exists.
Similarly, the optimal Bezout precoder is ⃗f = VH−1b = VH−1UHei with 2-norm:
⃗f

2
=

U−2UH
ii
(9.17)
The optimal integer i∗corresponding to the optimal delay k j is:
i∗= arg min
i

U−2UH
ii |ˆı = j (mod q) ei ∈Column Span {U}
(9.18)
9.1.3
Precoder and equalizer design for STBC systems
In many down-link communication scenarios, we have fewer receivers than transmitters (i.e., p ≥q).
In this case it may be effective to adopt a design combining the Bezout and STBC techniques.
STBC, introduced in Chapter 4, can be regarded as a combination of channel coding techniques
and equalization techniques. The performance can be enhanced by incorporating some structured
redundancy at the transmitter side, e.g. with zero-padding or cyclic-preﬁxing. The basic STBC
system used in this section is illustrated in Figure 9.4. Given a q × p transfer function of a (p-input–
q-output) physical channel model, the STBC system can generate an expanded virtual q′ × p′ transfer
function with p′ = pW and q′ = qN. Namely, it results in a qN × pW virtual transfer function.
Here, N denotes the block size, and W is the number of symbols sent per transmitter per block. For
convenience, this will be referred to as a N,W-STBC MIMO system.
If the original channel is PR, there is no need to incorporate redundancy; then, we can set W = N.
Such a (N,N)-STBC system is obtained by adding interleaving and deinterleaving operators to the
transmission channel inputs and outputs, respectively.
The virtual transfer function corresponding to a physical SISO channel has been well studied
[5, 8, 9]. Given a transfer function H (D) of a p-input–q-output MIMO physical channel H (D) =
d
n=0 Hn Dn and H j/N (D) is its jth forward polyphase component out of N:
H j/N (D) =
[d/N]

n=0
HNn+ j Dn
(9.19)

SPACE–TIME PRECODERS AND EQUALIZERS FOR MIMO CHANNELS
503
W
↓
N
↑
+
W
↓
N
↑
W
↓
N
↑
D
D
D
D
D
D
#1
#2
#p
W-taps
pW
virtual 
inputs
( )
1s
n
( )
2s
n
( )
ps
n
( )
H D
p in  
q out
N
↓
N
↓
N
↓
D
D
D
#1
#2
#q
N-taps
( )
1
x
n
( )
2
x
n
( )
q
x
n
p
q
qN
virtual 
outputs
Figure 9.4 Basic (N,W)-STBC system. It creates a Nq × pW virtual transfer function from
a p-input–q-output physical MIMO channel.
where 0 ≤j ≤N −1. Following [5], we can obtain a qN × pN virtual transfer function denoted
as H (D):
H (D) =


H0/N (D)
DHN−1/N (D)
· · ·
DH1/N (D)
H1/N (D)
H0/N (D)
· · ·
DH2/N (D)
·
·
·
·
·
·
·
·
HN−2/N (D)
HN−3/N (D)
· · ·
DHN−1/N (D)
HN−1/N (D)
HN−2/N (D)
· · ·
H0/N (D)


(9.20)
If H(D) is a q × p (assuming p ≤q) transfer function of a physical MIMO channel and H (D) the
virtual transfer function of the (N,N)-STBC system, which is given in Equation (9.20), then there is a
one-to-one correspondence between the common zeros of H (D) (denoted by {λi}) and that of H (D)
(denoted by {ηi}). More exactly [4]:
ηi = λN
i .
(9.21)
and the (N,N)-STBC preserves the PR property of the original transfer function [6].
Problems arise for (N,N)-STBC systems when the original H (D) is not PR or when it is PR but
not robustly recoverable. An effective solution is via a redundant precoding matrix F:
˜H (D) = H (D) F
(9.22)
The simplest (N, W)-STBC precoding is represented by a precoding matrix:
F =

IpW×pW
0pW×p(N−W)
T
(9.23)

504
LINEAR PRECODING FOR MIMO CHANNELS
This will lead to a qN × pW virtual transfer function, which is denoted as ˜H (D)
˜H (D) =


H0/N (D)
DHN−1/N (D)
· · ·
DHN−W+1/N (D)
H1/N (D)
H0/N (D)
· · ·
DHN−W+2/N (D)
·
·
·
·
·
·
·
DHN−1/N (D)
·
·
·
H0/N (D)
·
·
·
·
HN−2/N (D)
HN−3/N (D)
· · ·
HN−W−1/N (D)
HN−1/N (D)
HN−2/N (D)
· · ·
HN−W−1/N (D)


(9.24)
Since W is the number of symbols sent per transmitter per block, the number of symbols being
transmitted during one block period is pW; thus, the data transmission rate is pW/N. By using fewer
columns than rows in the precoding matrix F, some redundancy can be incorporated for the purpose
of enhancing the robust recoverability of the new transfer function ˜H (D).
If H (D) is PR, then ˜H (D) in Equation (9.24) is PR if and only if the precoding matrix F has
full column rank. In particular, for the (N,N)-STBC system, the qN × pW virtual transfer function
˜H (D) is PR, provided that H (D) is PR [4].
9.2
LINEAR PRECODING BASED ON CONVEX OPTIMIZATION THEORY
In this section, we discuss the design of a centralized precoder given ﬁxed linear MIMO transmitter,
channel, and receiver as shown in Figure 9.5. We deﬁne a precoder as a linear transformation on the
transmitted symbols. If the precoded symbols are sent as is to the channel, then the precoder is the
transmitter itself. However, in general, the precoded symbols may be transformed again before
the channel. We refer to this transformation as the transmitter, and we assume that it is a ﬁxed design
parameter. The output of the transmitter is then sent over a ﬁxed MIMO channel (or channels) and is
received using a ﬁxed linear receiver (or receivers).
A precoder that applied a linear transformation on the transmitted symbols prior to the spreading
was derived in [11]. This precoder inverted the channel at the transmitter side and is usually referred
to as the transmit zero-forcing (ZF) precoder. The main drawback of the transmit ZF precoder is noise
enhancement. Better solutions are transmit MF precoders and transmit rakes, which perform better
in low SNR and transmit minimum mean-squared error (MMSE) precoders that compensate for the
performance in the different SNR regions [12–16].
Variants of the previous precoders are discussed in [17–22]. Linear precoders based on an
approximate maximum-likelihood approach and maximum asymptotic multiuser efﬁciency with
different power constraints are derived in [23]. A linear precoding technique based on a decompo-
sition approach is proposed in [24], and a linear precoder design for nonlinear maximum-likelihood
Fixed!
+
M
W
+
2
W
+
1
W
Ch,1
H
Ch,2
H
Ch,M
H
Tx
H
T
b
Rx,1
H
Rx,2
H
Rx,M
H
1y
2
y
M
y
Figure 9.5 Block diagram of a precoder for a ﬁxed MIMO receiver.

LINEAR PRECODING BASED ON CONVEX OPTIMIZATION THEORY
505
(ML) receivers is discussed in [25]. Among the nonlinear precoders are the Tomlinson–Harashima
precoder (THP) [26] and the ‘Dirty Paper’ precoder [27]. The nonlinear precoder that optimizes the
transmitted symbols vector itself is derived in [28].
The problem of precoder design is highly related to other problems in the literature. In this
section, we consider the design of linear precoders for ﬁxed linear receivers. A related problem is the
problem of jointly optimizing the precoder/transmitter and the receiver, which has been treated, e.g.,
in [29–37]. Another related problem is the joint design of rank-one transmit beamforming design and
optimal power control [38–40].
In this section we discuss precoder design based on the framework of convex optimization theory
[41], which allows for efﬁcient numerical solutions using standard optimization packages [42]. It
was shown in [10] that the power optimization problem can be formulated as a second-order cone
program (SOCP) [43] or a semideﬁnite program (SDP) [44], known as a linear matrix inequalities
(LMI) program. The SINR optimization can also be formulated as a standard conic program known
as the generalized eigenvalue problem (GEVP) [45].
9.2.1
Generalized MIMO systems
We assume that at each time instant, a block of symbols is modulated and transmitted over the
channels. The possibly distorted output is then processed at the receivers in a linear fashion, as
depicted in Figure 9.5. Denoting by yi the length L output of the mth receiver, for m = 1, . . . , M,
we have


y1
...
yM


  
y
=


HRx,1HCh,1
...
HRx,MHCh,M





HRxCh
HTxTb +


HRx,1w1
...
HRx,MwM





w
(9.25)
where the matrices HRx,m and HCh,m denote the receiver and channel associated with the mth user,
the matrix HTx is the centralized transmitter, b is the length K = M · L vector of independent, and
unit variance transmitted symbols, and wi are the noise vectors. The noise vectors may be correlated,
and the channels are completely arbitrary. The only restriction is that the transmitter is centralized
and has access to all of the K transmit components.
We assume a single stream per MIMO dimension, i.e., the length of b is equal to the length of y.
However, these streams can be dedicated to a single user or to multiple users. A single user, point-
to-point communication system using L multiple receive and L transmit antennas is a special case of
Equation (9.25) with M = 1. The downlink channel of a CDMA system with L users is a special case
of Equation (9.25) with L = 1, where HT x is a signature matrix whose columns are the signatures of
each of the users, HCh,i = I and HRx,i are row vectors representing the linear receive ﬁlters of each
of the users. A multiuser system with transmit beamforming in which L transmit antennas signal to
L users each using a single receive antenna is a special case of Equation (9.25) with L = 1. Here,
HT x is a beamforming matrix whose columns are the antenna weights of each of the L users, HCh,i
are row vectors that represent the paths from the transmit antennas to the ith receive antenna, and
HRx,i are arbitrary scalars.
In the sequel, we will assume that the transmitter HT x, the channels HCh,i and the receivers HRx,i
are ﬁxed and cannot be altered due to budget restrictions, standardization, or physical problems.
Given this ﬁxed structure, we will try to improve the performance by introducing a linear precoder.
The precoder, denoted by T, linearly transforms the original symbol vector prior to the transmission.
As suggested by Equation (9.25), for ease of representation, we will use the following notation:
y = HTb + w
(9.26)
with H = HRxChHT x and the rest of the variables are deﬁned in Equation (9.25).

506
LINEAR PRECODING FOR MIMO CHANNELS
The system performance (or quality of service) QoS) is related to the output SINRs, and in
particular to the worst SINR. The output SINR of the ith subchannel is deﬁned as
SINRi =
[HT]i,i
2

j̸=i
[HT]i, j
2 + σ 2
i
(9.27)
for i = 1, . . . , K, where σ 2
i = E
|wi|2
> 0. Other criteria deal with the use of system resources,
e.g., peak-to-average ratio, or maximal transmitted power. The most common resource measure is
average transmitted power, which is deﬁned as:
P = E
∥HT xTb∥2
= Tr

THHH
T xHT xT

(9.28)
The SINR metric and average power metric conﬂict, and one cannot maximize the SINRs while also
minimizing the power, and vice versa. Depending on the application, the designer must decide which
criterion is stricter. We therefore consider one of the following two complementary strategies. The ﬁrst
optimization strategy seeks to minimize the average transmitted power subject to QoS constraints.
Given the required QoS, the system tries to satisfy it with minimum transmitted power [34, 39] (see
also Chapter 16) as follows:
P (γo) =



minT
Tr

THHH
T xHT xT

s.t.
|[HT]i,i|
2

j̸=i |[HT]i, j|
2 + σ 2
i
≥γo
(9.29)
where γo > 0 is the given worst SINR constraint.
The second strategy is maximizing the minimal SINR subject to a power constraint [33, 46] (see
also Chapter 16). In this case, the problem can be formulated as:
S (Po) =



maxT
mini
|[HT]i,i|
2

j̸=i |[HT]i, j|
2 + σ 2
i
s.t.
Tr

THHH
T xHT xT

≤Po
(9.30)
where Po > 0 is the given power constraint.
9.2.2
Convex optimization
In the sequel the following notation is used. Boldface capital letters denote matrices, boldface
lower-case letters denote column vectors, and standard lower-case letters denote scalars. The
superscripts(·)T , (·)∗, (·)H, (·)−1, and (·)† denote the transpose, the complex conjugate, the Hermi-
tian, the matrix inverse operators, and the Moore–Penrose pseudoinverse, respectively. [X]i, j denotes
the (ith, jth) element of the matrix X. By diag {xi}, we denote a diagonal matrix with xi being the
(ith, ith) element; by vec(X), we denote stacking the elements of X in one long column vector; by
ei, we denote a zeros vector with a one at the ith element; by 1, we denote an all ones vector; and
by I, we denote the identity matrix of appropriate size. Tr{·}, ℜ{·}, | · |, || · ||, and ||| · |||∞denote
the trace operator, the real part, the absolute value, the standard Euclidean norm, and the induced
row sum matrix norm, respectively. Finally, X ≻0 denotes that the matrix X is a Hermitian positive
semideﬁnite matrix, and N{·} denotes the Null space operator.
The most widely used ﬁeld in optimization is convex optimization. A convex program is a program
with a convex objective function and convex constraints. It is well known that in such programs a local
minimum is also a global minimum. The most common convex program is the linear program (LP)
[41], i.e. an optimization with a linear objection function and linear (afﬁne) constraints. Recently,
conic programs, i.e. LPs with generalized inequalities are also used. The two standard conic programs

LINEAR PRECODING BASED ON CONVEX OPTIMIZATION THEORY
507
are SOCP and SDP optimization. The standard form of an SOCP is [43]:
SOCP :



minx
ℜ

f Hx

s.t.
 cH
i x + di
AH
i x + bi

≻K 0,
i = 1, . . . , N
(9.31)
where the optimization variable is the vector x of length n and f, Ai, bi, ci, and di for i = 1, . . . , N
are the data parameters of appropriate sizes. The notation ≻K denotes the following generalized
inequality:
 z
z

≻K 0 ⇔∥z∥≤z
(9.31a)
The standard form of an SDP is [44]:
SDP :
 
minx
ℜ

f Hx

s.t.
A (x) ≻0
(9.32)
where A (x) = A0 + n
i=1 xiAi is a Hermitian matrix that depends afﬁnely on x. The data parameters
are the Hermitian matrices Ai for i = 0, . . . , n. The notation ≻denotes the positive semideﬁnite
generalized inequality. A simple case of an SDP is an SOCP. For example, each of SOC constraints
in Equation (9.31) can be written as an LMI [21], as follows:

cH
i x + di
xHAi + bH
i
AH
i x + bi

cH
i x + di

I

≻0
(9.31c)
A common optimization package designed to solve SOCP and SDP is SEDUMI [42].
Among nonconvex problems is the GEVP [45], which can still be efﬁciently solved. Its standard
form is:
GEVP :



minβ,x
β
s.t.
βB (x) −A (x) ≻0
B (x) ≻0
C (x) ≻0
(9.33)
where β is a real-valued optimization variable and A (x) = A0 + n
i=1xiAi, B (x) = B0 + n
i=1xiBi,
and C (x) = C0 + n
i=1xiCi are Hermitian matrices that depend afﬁnely on x. The data parameters
are the Hermitian matrices Ai, Bi and Ci for i = 0, . . . , n. The name of the GEVP arises from its
resemblance to the well-known problem of minimizing the maximal generalized eigenvalue of the
pencil [A, B], i.e. minimizing the largest β such that Av = βBv. It is easy to show that this problem
can be expressed as
! minβ
β
s.t.
βB −A ≻0
(9.34)
which is a simple SDP. The GEVP generalizes this program to the case where A and B also depend
on the optimization variables.
9.2.3
Precoding for power optimization
The ﬁrst important property of any optimization problem is its feasibility (admissibility), i.e. whether
a solution exists. In other words, we need to verify whether for a given γo there exists a T such that
the constraint in Equation (9.29) is satisﬁed:
min
i
[HT]i,i
2

j̸=i
[HT]i, j
2 + σ 2
i
≥γo
(9.29a)

508
LINEAR PRECODING FOR MIMO CHANNELS
Since the noise variances are positive, the SINRs are strictly lower than the signal-to-interference
ratios (SIRs), i.e.
[HT]i,i
2

j̸=i
[HT]i, j
2 + σ 2
i
<
[HT]i,i
2

j̸=i
[HT]i, j
2
(9.35)
for i = 1, . . . , K. By scaling T to aT for large enough a > 0, the difference between the SIRs and
the SINRs can be made insigniﬁcant.
Therefore, for the sake of examining the feasibility, the interesting metrics are the SIRs.
It was shown in [10] that there exists a T such that:
min
i
[HT]i,i
2

j̸=i
[HT]i, j
2 ≥γo
(9.36)
only if
γo ≤
1
K
rank(H) −1
(9.37)
If the effective channel H is full rank, then the condition results in γo ≤∞, i.e. any SIR is feasible.
This is easily veriﬁed as the condition in Equation (9.29) can be satisﬁed by choosing T = aH−1for
large enough a > 0. This choice of precoder inverts the channel and eliminates all interference. When
the effective channel is rank deﬁcient, the interference cannot be eliminated, and there is an upper
bound on the maximal SIRs.
Experimenting with arbitrary channels shows that in almost all practical channels the bound can
be achieved even for a ﬁxed suboptimal receiver. For example, consider a rank K −1 channel H with
the normalized null vector u ∈N

HH
. Except for the case in which ui = 0 for some i = 1, . . . , K,
the bound can always be attained by choosing
T = H†diag

1/u∗
i

Q
(9.38)
where Q is a matrix with unit diagonal elements and [Q]i, j = −1/ ({K −1}) for the nondiagonal
i ̸= j elements. This can be shown by considering the following chain:
HT = HH†diag

1/u∗
i

Q = diag

1/u∗
i

Q
(9.39)
where we have used HH† = I −uuH and the fact that 1 ∈N {Q}. Substituting the above HT into the
SIRs yields the maximal SIRs in rank K −1 channels, as follows:
[HT]i,i
2

j̸=i
[HT]i, j
2 =
1
K
K−1 −1,
i = 1, . . . , K
(9.40)
9.2.3.1
Conic optimization solution
We now show that the P problem of Equation (9.29) can be represented as a standard conic opti-
mization program. Thus, using off-the shelf optimization packages, we can numerically verify its
feasibility and ﬁnd its optimal solution. In order to use the standard forms of the conic programs, we
must cast our problem constraints using the standard notations described in Section 9.2.2.
Using a real-valued slack variable Po, the program can be rewritten as:
P (γo) :



minT,Po
Po
s.t.
|[HT]i,i|
2

j̸=i |[HT]i, j|
2 + σ 2
i
≥γo,
i = 1, . . . , K
Tr

THHH
T xHT xT

≤Po
(9.41)
The argument T of the P program is deﬁned up to a diagonal phase scaling on the right, i.e. if T is
optimal, then Tdiag

e jφi 
, where φi for i = 1, . . . , K are arbitrary phases, is also optimal. This is
easy to verify, as the phases do not change the objective nor the constraints. Therefore, we can restrict

LINEAR PRECODING BASED ON CONVEX OPTIMIZATION THEORY
509
ourselves to precoders in which [HT]i,i ≥0 for i = 1, . . . , K, i.e. each has a nonnegative real part
and a zero imaginary part. Taking this into account, we now recast the SINR constraints in standard
form. Rearranging the constraints and using matrix notations, the constraints yield
"
1 + 1
γo
# [HT]i,i
2 ≥

THHHei
σi

2
,
i = 1, . . . , K
(9.42)
Since [HT]i,i ≥0 for i = 1, . . . , K, we can take the square root of
[HT]i,i
2, resulting in
$
1 + 1
γo
[HT]i,i ≥

THHHei
σi

2
,
i = 1, . . . , K
(9.43)
which can be written as the SOCs


%
1 + 1
γo [HT]i,i
THHHei
σi

≻K 0,
i = 1, . . . , K
(9.44)
Similarly, the power constraint in Equation (9.41) can be reformulated using the vec(·) operator as
∥vec (HT xT)∥≤√Po, which is equivalent to the SOC:
 √Po
vec (HT xT)

≻K 0
(9.45)
Using p = √Po, the program in Equation (9.27) can now be cast in the standard SOCP form [43] as
follows:
P (γo) :



minT,p
p
s.t.


%
1 + 1
γo [HT]i,i
THHHei
σi

≻K 0,
i = 1, . . . , K

p
vec (HT xT)

≻K 0
(9.46)
and it can be efﬁciently solved using any standard SOCP package [42]. Such a solver can also
numerically determine the feasibility of the optimization problem. A similar approach was taken in
[40] in the context of transmit beamforming.
As explained in Section 9.2.2, each SOC constraint can be replaced with an SDP constraint using
Equation (9.32). Thus, the problem can also be expressed as a standard SDP, as follows:
P (γo) :



minT,p
p
s.t.
Ai (T) ≻0,
i = 1, . . . , K
C (T) ≻0
(9.47)
where
Ai (T) =


%
1 + 1
γo [HT]i,i

eH
i HT
σi

 THHHei
σi

%
1 + 1
γo [HT]i,i I


(9.48)
for i = 1, . . . , K, and
C (T) =

p
vecH (HT xT)
vec (HT xT)
pI

(9.49)
Solving SOCPs via SDP is not very efﬁcient. Interior point methods that solve SOCP directly have a
much better worst case complexity than do their SDP counterparts [43].

510
LINEAR PRECODING FOR MIMO CHANNELS
Deﬁne now the dual variables λi > 0 for i = 1 . . . K and denote  = diag {λi} and G(λi) = HHH +
HH
T xHT x. If there exist λi > 0 such that
γo =
1
1


1
2 HG†(λi )HH 
1
2


i,i
−1,
i = 1, . . . , K
(9.50)
holds, then the program is strictly feasible [10]. Also, if the condition in Equation (9.50) holds, then
the optimal T is of the form
T = G† (λi) HH
1
2 diag {δi}
(9.51)
where δi are the positive weights that allocate the power between the users, as follows:
δi =
&
'
'
(
j
"
γo
1 + γo
I −F
#−1
i, j
λ jσ 2
j
(9.52)
[F]i, j =


1
2 HG† (λi) HH
1
2
2
i, j
(9.53)
for i, j = 1, . . . , K. This structure of T is unique within the range of HH
T x. At this optimal solution,
all the constraints are active, i.e. there are equal SINRs for all the subchannels. The optimal objective
value is
Po =

i
λiσ 2
i
(9.54)
Equations (9.50)–(9.54) provide a simple strategy for designing the precoder.
Given a feasible γo, all one has to do is ﬁnd λi > 0 which satisfy Equation (9.50). Once these
are found, T can be derived through Equations (9.51)–(9.54). In some special cases, these variables
can be derived in closed form. Otherwise, [10] provides two alternative methods for ﬁnding these
variables. The structure of (9.50) motivates a ﬁxed-point iteration for ﬁnding λi. By rearranging
Equation (9.50), we arrive at the following simple iteration:
λ(n+1)
i
=
γo
1 + γo
1
)
HG† 
λ(n)
i

HH
*
i,i
,
i = 1, . . . , K
(9.55)
Clearly, the optimal λi satisfy this ﬁxed point. If P (γo) is feasible, then the above iteration will
converge from any λ(0)
i
to a set λ(n)
i
> 0 that satisﬁes Equation (9.50) [10].
9.2.4
Precoder for SINR optimization
The power optimization problem of Equation (9.29) and the SINR optimization problem of Equation
(9.30) are inverse problems [10]:
γo = S (P (γo))
Po = P (S (Po))
(9.56)
In addition, the optimal objective value of each program is continuous and strictly monotonic increas-
ing in its input argument
γo > ˜γo ⇒P (γo) > P ( ˜γo)
Po > ˜Po ⇒S (Po) > S
 ˜Po

(9.57)
Using Equations (9.56)–(9.57), we can solve S (Po) for a given Po by iteratively solving P (γo) for
different γos. Due to the inversion property, if P (γ ), then its solution will be optimal also for S (Po).
The strict monotonicity and continuity guarantees that a simple one-dimensional bisection search
will efﬁciently ﬁnd the required γo. This procedure is summarized in the following algorithm (see
also [47, 10]).

LINEAR PRECODING BASED ON CONVEX OPTIMIZATION THEORY
511
S (Po)
1. γmax ←MaxSINR
2. γmin ←MinSINR
3. repeat
4. γo ←(γmin + γmax) /2
5. ˆPo ←P (γo)
6. if ˆPo ≤Po
7. then γmin ←γo
8. else γmax ←γo
9. until ˆPo = Po
10. return γo
where MinSINR and MaxSINR deﬁne a range of relevant SINRs for a speciﬁc application, and
where we have used the convention that ∞= P (γo) if it is infeasible. Theoretically, this means that
the SINR optimization problem can be solved through the previous results concerning the power
optimization.
The SINR optimization can be also cast as a standard GEVP program. Using a real-valued slack
variable γo, the problem can be rewritten as:
S (Po) :



maxT,γo
γo
s.t.
|[HT]i,i|
2

j̸=i |[HT]i, j|
2 + σ 2
i
≥γo,
i = 1, . . . , K
Tr

THHH
T xHT xT

≤Po
(9.58)
Although Equation (9.58) seems similar to Equation (9.41), it turns out to be more complicated.
This is because the SINR matrix inequalities in Equation (9.48) are linear in β = √1 + 1/γo or in
T, but not in both simultaneously. Thus, when β is an optimization variable and not a parameter,
these constraints are no longer LMIs. In fact, the sets which they deﬁne are not convex. Even so, we
can still express them using generalized matrix inequalities as in Equations (9.47) and (9.48). If we
rewrite the Ai (T)’s in Equation (9.48) and separate out the terms which are linear, we have:
Ai (T) = βA1
i (T) −A2
i (T)
(9.59)
where A1
i (T) and A2
i (T) are matrices that depend afﬁnely on T, as follows:
A1
i (T) =
 [HT]i,i
0
0
[HT]i,i I

A2
i (T) =


0
−

eH
i HT σi

−

THHHei
σi

0


(9.60)
Using Equation (9.59), we can express S in the standard GEVP form
S (Po) :



minT,β
β
s.t.
βA1
i (T) ≻A2
i (T) ,
i = 1, . . . , K
A1
i (T) ≻0,
i = 1, . . . , K
C (T) ≻0
(9.61)
which can be solved using appropriate software [45].

512
LINEAR PRECODING FOR MIMO CHANNELS
The SINR optimization problem can also be solved using the conditions in (9.50) by ﬁxed-point
iteration for ﬁnding λi. As explained in Equations (9.56)–(9.57), S and P are inverse problems. Thus,
the optimal solution of the SINR optimization is also optimal for an inverse power optimization
problem, and therefore must satisfy its optimality conditions as well. Thus, to optimize the SINRs,
we need to ﬁnd λi > 0 that satisfy Equations (9.50) and (9.54). Unfortunately, in this case, γo is an
optimization variable and not a parameter and has to be found as well. This can be overcome by
adjusting the ﬁxed-point iteration in Equation (9.55), as follows:
˜λi =
1
)
HG† 
λ(n)
i

HH
*
i,i
,
i = 1, . . . , K
(9.62)
and then normalizing the result so that it will satisfy Equation (9.54):
λ(n+1)
i
=
Po ˜λi

j σ 2
j ˜λ j
,
i = 1, . . . , K
(9.63)
If this iteration converges to a ﬁxed point λ(n)
i
> 0, then it will satisfy Equations (9.50) and
(9.54). Numerous numerical simulations with arbitrary initial points and parameters show a rapid
convergence rate.
9.2.5
Performance example
Consider a multiuser precoded downlink system. At each symbol’s period, the base station transmits
using an N × K nonorthogonal signatures matrix HT x = S. The maximal average transmitted power
is Po = K, and the cross correlations between the signatures are denoted by ρi, j = [SHS]i, j with
ρi,i = 1 for all i. For simplicity, we assume ideal channels, i.e. HCh,i = I, and equal noise variances,
i.e., σ 2
i = σ 2. Denoting by y the output vector of the multiple user receiver, we have
y = HRxSTb + HRxw
(9.64)
where from Chapter 5, HRx is one of the standard ﬁlters, as follows:
r MF receiver: HRx = SH;
r ZF receiver: HRx =

SHS
−1 SH;
r MMSE receiver: HRx = SH 
SSH + σ 2I
−1.
An interesting result of the precoder is its performance in an equal power and equal cross correlations
multiuser system, i.e., ρi, j = ρ for all j ̸= i and σ 2
i = σ 2.
When the matrices H and HT x have equal diagonal elements and equal off-diagonal elements, and
the variances σ 2
i = σ 2 are equal, due to the symmetry, it is clear that choosing λi = Po/

Kσ 2
will
satisfy the conditions in Equation (9.59). Therefore, the solution for the SINR optimization problem
is:
γo =
1
1

H

HHH + Kσ 2
Po HH
T xHT x
−1
HH

i,i
−1
(9.65)
T = c

HHH + Kσ 2
Po
HH
T xHT x
†
HH
(9.66)
where c is a constant that scales the matrix to satisfy the power constraint.
In Figure 9.6, we plot the output SINRs given by Equation (9.65) for the three linear receivers.
For comparison, we also plot the output SINRs that result from similar systems without a precoder
[48]. As expected, using the precoder always improves the output SINR.

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
513
–15
–10
–5
0
5
10
15
20
5
10
15
20
25
30
SNR [dB]
output SINR [dB]
MMSE + SINR precoder
ZF + SINR precoder
MMSE
MF
ZF
MF + SINR precoder
Figure 9.6 SINR of a symmetric system with equal cross correlations. Due to the symmetry,
all users have equal output SINRs c⃝1989, IEEE.
9.3
CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
In this section we discuss the joint design of transmit and receive beamforming for multicarrier
multiple-input–multiple-output (MIMO) channels under a variety of design criteria. As already
indicated in Section 9.2, this linear processing is commonly termed linear precoding at the transmitter
and equalization at the receiver. Instead of considering each design criterion in a separate way,
we generalize the existing results by developing a uniﬁed framework based on considering two
families of objective functions that embrace most reasonable criteria to design a communication
system: Schur-concave and Schur-convex functions. Once the optimal structure of the transmit–
receive processing is known, as in Section 9.2, the design problem simpliﬁes and can be formulated
within the framework of convex optimization theory, in which a number of interesting design criteria
can be easily accommodated and efﬁciently solved, even though closed-form expressions may not
exist.
A general convex optimization problem (convex program), introduced in Section 9.2, will be
further speciﬁed in this section as follows [65]: min
x
f0 (x)
s.t.
fi (x) ≤0,
1 ≤i ≤m
hi (x) = 0,
1 ≤i ≤p
where x ∈Rn
is the optimization variable,
f0 (x) , . . . , fm (x) are convex functions, and
h1 (x) , . . . , h p (x) are linear functions (afﬁne functions). The function f0 is the objective func-
tion or cost function. The inequalities fi (x) ≤0 are called inequality constraints, and the equations
hi (x) = 0 are called equality constraints. When the functions fi and hi are linear (afﬁne), the problem
is called a linear program (LP) and is much simpler to solve.
In general, as already indicated in Section 9.2, some manipulations are required to convert the
problem into a convex one (unfortunately, this is not always possible). The interest of expressing a
problem in convex form is that although an analytical solution may not exist and the problem may
be difﬁcult to solve (it may have hundreds of variables and a nonlinear nondifferentiable objective
function), it can still be solved (numerically) very efﬁciently [64]. Another interesting feature of
expressing a problem in convex form is that additional constraints can be straightforwardly added, as
long as they are convex.
In some cases, convex optimization problems can be analytically solved using the Karush–
Kuhn–Tucker (KKT) optimality conditions, and closed-form expressions can be obtained. In general,

514
LINEAR PRECODING FOR MIMO CHANNELS
however, one must resort to iterative methods [64, 67]. Interior-point methods can be used to iteratively
solve convex problems [72]. In addition, the difference between the objective value at each iteration
and the optimum value can be upper bounded using duality theory [64, 67]. This allows the utilization
of nonheuristic stopping criteria such as stopping when some prespeciﬁed resolution has been reached.
Another interesting family of iterative methods is cutting-plane methods [64].
In the sequel we will also use some results from majorization theory. For these purposes we need
the following deﬁnitions (D) [63]:
(D1) For any x ∈Rn, let x[1] ≥· · · ≥x[n] denote the components of x in decreasing order (also
termed order statistics of x).
(D2) Let, x, y ∈Rn. Vector x is majorized by vector y (or y majorizes x) if
k

i=1
x[i] ≤
k

i=1
y[i],
i ≤k ≤n −1,
n

i=1
x[i] =
n

i=1
y[i]
and represent it by x ≺y.
(D3) A real-valued function φ deﬁned on a set A ⊆Rn is said to be Schur-convex on A if
x ≺y on A ⇒φ (x) ≤φ (y) Similarly, φ is said to be Schur-concave on A if x ≺y on
A ⇒φ (x) ≥φ (y). As a consequence, if φ is Schur-convex on A, then −φ is Schur-concave
on A and vice versa. It is important to remark that the sets of Schur-concave and Schur-
convex functions do not form a partition of the set of all functions. In fact, neither are the two
sets disjoint (the intersection is not empty), nor do they cover the entire set of all functions.
By using these deﬁnitions we additionally introduce the following results [63]:
(R1) Let R be an n × n Hermitian matrix with diagonal elements denoted by the vector d
and eigenvalues denoted by the vector λ. Then d ≺λ
(R2) Let x ∈Rn and 1 ∈Rn denote the constant vector with 1i

= n
j=1 x j/n. Then 1 ≺x
(R3) For any x ∈Rn, there exists a real symmetric (and therefore Hermitian) matrix with
equal diagonal elements and eigenvalues given by x.
9.3.1
Multicarrier MIMO signal model
We analyse a communication system with nT transmit and nR receive antennas. To cope with the
frequency-selectivity of the channel, we use a multicarrier signal so that we have
yk = Hksk + nk,
1 ≤k ≤N
(9.67)
where k denotes the carrier index, N is the number of carriers, sk ∈RnT ×1 is the transmitted vector,
Hk ∈RnR×nT is the channel matrix, yk ∈RnR×1 is the received signal vector, and nk ∈RnR×1 is
nk ∼CN(0, Rnk) a zero-mean circularly symmetric complex Gaussian noise vector with arbitrary
covariance matrix Rnk. The channel is assumed ﬁxed during the transmission of a block and known
at both sides of the communication link as well as the noise covariance matrix.
At each carrier k, the matrix channel has Kk ≤min (nT , nR)′ channel eigenmodes or spatial
subchannels (i.e., nonvanishing singular values of the channel matrix) [50] (see also Section 4.14).
We can use them as a means of spatial multiplexing [51] to transmit simultaneouslyLk symbols by
having Lk established substreams. Notice that established substreams and spatial subchannels (or
channel eigenmodes) are different concepts that may or may not coincide, depending on whether
the channel is diagonalized or not. This will be further elaborated in the next section. In a practical
system, we will typically have to have Lk ≤Kk an acceptable performance. In the sequel boldface
captital letters denote matrices, boldface lower-case letters denote column vectors, and italics denote
scalars. [X]i, j (also [X]i j) and [X]:, j denote the (ith, jth) element and jth column of matrix X,
respectively. By A ≥B, we mean that A −B is positive semideﬁnite. The trace, determinant, and
Frobenius norm of a matrix are denoted by Tr(·), | · |, and || · ||F, respectively. By diag ({Xk}), we
denote a block-diagonal matrix with diagonal blocks given by the set {Xk}. The gradient of a function
with respect to x is written as ∇x f (x). We deﬁne (x)+ 
= max (0, x). The transmitted vector at the

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
515
k
X
L
k
B
Tn
L
×
R
T
n
n
×
k
H
ks
k
n
k
y
H
k
A
R
n
L
kx
R
L n
×
Tn
,1
k
B
,1
kx
,
k L
x
,
k L
B
1
Tn ×
1
Tn ×
ks
Tn
k
H
R
T
n
n
×
k
n
k
y
,1
H
ka
,
H
k L
a
1
R
n
×
1
R
n
×
,1
kx
,
k L
x
(a) 
(b) 
R
n
Figure 9.7 Matrix processing and multiple beamforming interpretations of the communica-
tion system. (We assume for the clarity of the ﬁgure that Lk = L∀k.) (a) Matrix
processing interpretation at carrier k. (b) Multiple beamforming interpretation
at carrier k.
kth carrier after linear precoding can be now represented as (see Figure 9.7(a).
sk = Bkxk =
Lk

i=1
bk,ixk,i
(9.68)
where xk ∈RLk×1 represents the Lk transmitted symbols. We assume zero-mean unit-energy uncor-
related (white) symbols, i.e., E

xkxH
k

= ILk). Bk ∈RnT ×Lk is the precoding matrix, bk,i

= [Bk]:,i,
and xk,i

= [xk]i. Each column of Bk can be considered as a different beamvector corresponding to
each transmitted symbol, resulting into multiple beamforming architecture shown in Figure 9.7(b).
Note that if only one symbol is transmitted per carrier (Lk = 1∀k), then Equation (9.68) reduces to a
classical beamforming structure with a single beamvector: sk = bkxk The transmitter is constrained
in its average total transmit power:
N

k=1
E
∥Bkxk∥2
=
N

k=1
∥Bk∥2
F ≤PT
(9.69)
where PT is the power in units of energy per block-transmission (or, equivalently, per OFDM symbol).
The received vector at the kth carrier after the equalizer is
ˆxk = AH
k yk
(9.70)
where AH
k ∈RLk×nR is the equalizer matrix, and ˆxk ∈RLk×1 is the estimation of xk. Again, each
column of Ak can be interpreted as a beamvector adapted to each spatial channel substream at carrier
k, i.e., ˆxk,i = aH
k,iyk [see Figure 9.7(b)].
In the sequel, only independent processing at each carrier has been considered, called the carrier-
noncooperative approach [49] [see Figure 9.8(a)]. This scheme, however, can be further general-
ized by allowing cooperation among carriers, called carrier-cooperative approach [49] [see Figure
9.8(b)]. The signal model is obtained by stacking the vectors corresponding to all carriers (e.g.,
xT =

xT
1 , . . . , xT
N

), by considering global transmit and receive matrices B ∈R(nT N)×LT (the transmit

516
LINEAR PRECODING FOR MIMO CHANNELS
 
kx
L
k
B
Tn
L
×
R
T
n
n
×
k
H
ks
k
n
k
y
H
k
A
R
n
L
kx
R
L
n
×
Tn
R
T
n
n
×
1
H
1
n
R
n
R
T
n
n
×
N
H
N
n
R
n
(
) (
)
Tn
N
L N
⋅
×
⋅
(
) (
)
R
L N
n
N
⋅
×
⋅
1x
N
x
1x
N
x
B
H
A
(a) 
(b) 
1x
N
x
1x
N
x
R
n
L
L
L
L
Tn
Tn
Figure 9.8 Carrier-cooperative versus carrier-noncooperative approaches. (We assume for
clarity of the ﬁgure that Lk = L∀k.) (a) Carrier-noncooperative approach.
(b) Carrier-cooperative approach.
power constraint reduces to ∥B∥2
F ≤PT ) and AH ∈RLT ×(nR N), where LT = N
k=1 Lk is the total num-
ber of transmitted symbols, and by deﬁning the global channel as H = diag ({Hk}) ∈R(nR N)×(nT N).
This model can cope with intermodulation terms, unlike the noncooperative model, that implicitly
assumes orthogonal carriers.
9.3.2
Channel diagonalization
For some speciﬁc design criteria, the system optimization problem is greatly simpliﬁed because the
channel turns out to be diagonalized by the precoder-equalizer processing, which allows a scalar-
ization of the problem (all matrix equations are substituted with scalar ones). Examples are the
minimization of the (weighted) sum of the MSEs of all channel spatial substreams [52–54], the mini-
mization of the determinant of the MSE matrix [55], and the maximization of the mutual information
[50, 56, 57].
In [49], these results are generalized by developing a uniﬁed framework. Instead of analyzing
each design criterion in a separate way, the design is based on the minimization of some arbitrary
objective function of the MSEs of all channel substreams f0

MSEk,i

, where MSEk,i is the MSE
of the ith spatial substream at the kth carrier (objective functions of the SINRs and of the BERs are
also readily incorporated.

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
517
9.3.2.1
Optimum equalizer
To design the system, we ﬁrst easily derive the optimum equalizer Ak’s, assuming the precoders
Bk’s ﬁxed, and then deal with, the derivation of the optimal precoders Bk’s. This two-step derivation
has been independently used in [49] and [58]. The MSE matrix at the kth carrier is deﬁned as the
covariance matrix of the error vector (given by ek

= ˆxk −xk):
Ek (Bk, Ak)

= E

(ˆxk −xk) (ˆxk −xk)H
= AH
k RykAk + I −AH
k HkBk −BH
k HH
k Ak
(9.71)
where Ryk

= E

ykyH
k

= HkBkBH
k HH
k + Rnk. The MSE of the (kth, ith) substream is the ith diagonal
element of Ek, i.e.,
MSEk,i

Bk, ak,i

= [Ek]ii = aH
k,iRykak,i + 1 −aH
k,iHkbk,i −bH
k,iHH
k ak,i
(9.72)
where ak,i (or bk,i) is the ith column of Ak (or Bk). Expression (9.72) is nonconvex in (Bk, ak,i)
whereas, for a given Bk, MSEk,i is convex in ak,i and independent of the other columns of Ak and of
the other carriers. This means that each ak,i can be independently optimized. To obtain the optimal
equalizerAopt
k
in a more direct way, it sufﬁces to ﬁnd Ak such that the diagonal elements of Ek are
minimized. This can be done regardless of the speciﬁc choice of the objective function f0 since we
know it is increasing in each argument. Alternatively, we can obtain Aopt
k
so that Ek(Bk, Aopt
k ) ≤
Ek(Bk, Ak), which in particular implies that the diagonal elements are minimized (in fact, both
criteria are equivalent as shown in [59]). In other words, we want to solve min
A∗
k
cHEk(Bk, Ak)c, ∀c.
Setting the gradient of cHEkc = Tr(EkccH) to zero ∇A∗
k Tr(EkccH) = RykAkccH −HkBkccH = 0, ∀c
and particularizing for all the vectors of the canonical base, it follows that:
Aopt
k
=

HkBkBH
k HH
k + Rnk
−1 HkBk
(9.73)
Expression (9.73) is the linear minimum MSE (LMMSE) receiver or Wiener ﬁlter [see Section 5].
Using the optimal equalizer Aopt
k , we obtain the following concentrated error matrix:
Ek (Bk)

= Ek

Bk, Aopt
k

= I −BH
k HH
k

HkBkBH
k HH
k + Rnk
−1 HkBk
=

I + BH
k RHkBk
−1
(9.74)
where
we
have
used
the
matrix
inversion
lemma,
(A + BCD)−1 = A−1 −A−1B(DA−1
B+ C−1)−1DA−1 and we have deﬁned RHk

= HH
k R−1
nk Hk (note that the eigenvectors and eigen-
values of RHk are the right singular vectors and the squared singular values, respectively, of the
whitened channel R−1/2
nk
Hk). However, many objective functions are naturally expressed as functions
of the SINR of each substream. The SINR at the kth carrier and the ith spatial substream is:
SINRk,i

=
aH
k,iHkbk,i
2
aH
k,iRk,iak,i
≤bH
k,iHH
k R−1
k,i Hkbk,i
(9.75)
where Rk,i

= HkBkBH
k HH
k + Rnk −Hkbk,ibH
k,iHH
k is the interference-plus-noise covariance matrix
seen by the (kth, ith) substream, the inequality comes from Cauchy–Schwarz’s inequality [60]
[with vectors (R−1/2
k,i
Hkbk,i) and (R1/2
k,i ak,i)], and the upper bound is achieved by ak,i ∝R−1
k,i Hkbk,i ∝
R−1
yk Hkbk,i, i.e. the Wiener ﬁlter again. Noting that the MSE can be expressed as:
MSEk,i =
)
I + BH
k HH
k R−1
nk HkBk
−1*
ii =
1
1 + bH
k,iHH
k R−1
k,i Hkbk,i
(9.76)
the SINR can be easily related to the MSE as:
SINRk,i =
1
MSEk,i
−1
(9.77)
So, maximizing the SINR is equivalent to minimizing the MSE. The performance of a digital com-
munications system is given by the bit error rate (BER). Under the Gaussian assumption, the symbol

518
LINEAR PRECODING FOR MIMO CHANNELS
BER(MSE)
0
0,005
0,01
0,015
0,02
0
0,05
0,1
0,15
0,2
MSE
BER
16-QAM
8-PSK
QPSK
Figure 9.9 Convexity of the BER as a function of the MSE for the range of BER ≤2 × 10−2
c⃝2000, IEEE.
error probabilityPe will be analytically expressed as in the previous section as a function of the
SINRPe (SINR) = αQ
√βSINR

where α and β are constants that depend on the signal constella-
tion, and Q is the Q-function deﬁned as Q (x) = (1/
√
2π)
+ ∞
x e−λ2/2dλ. It is sometimes convenient
to use the Chernoff upper bound of the tail of the Gaussian distribution function Q (x) ≤(1/2) e−x2/2
[61] to approximate the symbol error probability as Pe ≈(1/2) αe−β/2SINR (which becomes a good
approximation for high values of the SINR). The BER can be approximately obtained from the symbol
error probability (assuming that a Gray encoding is used to map the bits into the constellation points)
as BER ≈Pe/k where k = log2 M is the number of bits per symbol, and M is the constellation size.
It can be seen from Figure 9.9 that BER is a convex function.
9.3.2.2
Optimum precoder
To obtain the set of precoder matrices {Bk}, we now consider the minimization of an arbitrary objective
function of the diagonal elements of Equation (9.74). We start with optimization problem deﬁned by:
min
B
f0 (d (E (B)))
s.t.
Tr

BBH
≤PT
(9.78)
where matrix B ∈RnT ×L is the optimization variable, d (E (B)) is the vector of diagonal elements of
the MSE matrix E(B) = (I + BHRHB) [the diagonal elements of E(B) are assumed in decreasing
order w.l.o.g.], RH ∈RnT ×nT is a positive semideﬁnite Hermitian matrix, and f0 : RL →R is an
arbitrary objective function (increasing in each variable). It then follows that there is an optimal
solution B of at most rank
⌣L

= min (L, rank (RH)) rank with the following structure [49]:
r If f0 is Schur-concave, then
B = UH,1

B,1
(9.79)
where UH,1 ∈RnT ×
⌣L has as columns the eigenvectors of RH corresponding to the
⌣L largest
eigenvalues in increasing order, and 
B,1 = [0 diag({σB,i})] ∈R
⌣L×L has zero elements, except
along the rightmost main diagonal (which can be assumed real).

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
519
r If f0 is Schur-convex, then
B = UH,1

B,1
VH
B
(9.80)
where UH,1 and 
B,1 are deﬁned as before, and VB ∈RL×L is a unitary matrix such that
(I + BHRHB)−1 has identical diagonal elements. This rotation can be computed using the al-
gorithm given in [62] or with any rotation matrix Q that satisﬁes |Qik| = |Qil| , ∀i, k, l, such as
the discrete Fourier transform (DFT) matrix or the Hadamard matrix (when the dimensions are
appropriate such as a power of two [61]).
For the simple case in which only one symbol per carrier is transmitted at each transmission,
i.e. a single spatial eigenmode L = 1 is utilized, Equations (9.78)–(9.80) simplify, and the diagonal
structure simply means that the spatial subchannel (eigenmode) with highest gain is used.
For Schur-concave objective functions, the global communication process including pre- and
post-processing AHHB is fully diagonalized [see Figure 9.10(b)] as well as the MSE matrix E.
Among the L established substreams, only
⌣L are associated with nonzero channel eigenvalues,
whereas the remainder L0 = L −
⌣L are associated with zero eigenvalues. Having in mind that A =
(HBBHHH + Rn)−1HB = R−1
n HB(I + BHHHR−1
n HB)−1 the global communication process is ˆx =
(I + H
B,1 DH,1

B,1)−1 H
B,1 D1/2
H,1(D1/2
H,1

B,1 x + w) or,
ˆxi =



0,
1 ≤i ≤L0
σ 2
B,(i−L0)λH,(i−L0)
1 + σ 2
B,(i−L0)λH,(i−L0)
xi
+
σB,(i−L0)λ1/2
H,(i−L0)
1 + σ 2
B,(i−L0)λH,(i−L0)
wi,
L0 < i ≤L
(9.81)
where DH,1 = diag({λH,i}
⌣L
k=1), the λH,is are the
⌣L largest eigenvalues of RH in increasing order, the
σ 2
B,is represent the allocated power, and w is a normalized equivalent white noise.
The MSE matrix is E = (I + H
B,1 DH,1

B,1)−1, and the corresponding MSEs are given by:
MSEi =



1,
1 ≤i ≤L0
1
1 + σ 2
B,(i−L0)λH,(i−L0)
,
L0 < i ≤L
(9.82)
Similarly, using Equation (9.77) we have
SINRi =
!0,
1 ≤i ≤L0
σ 2
B,(i−L0)λH,(i−L0),
L0 < i ≤L
(9.83)
For Schur-convex objective functions, the global communication process including pre- and post-
processing AHHB is diagonalized only up to a very speciﬁc rotation of the data symbols [see Figure
9.10(c)], and the MSE matrix E is nondiagonal with equal diagonal elements (equal MSEs). In
particular, assuming a pre-rotation of the data symbols at the transmitter ˆx = VH
B x and a post-rotation
of the estimates at the receiver ˜ˆx = VH
B ˆx, the same diagonalizing results of Schur-concave functions
apply [see Figure 9.10(c)]. Since the diagonal elements of the MSE matrix E =

I + BHRHB
−1 are
equal whenever the appropriate rotation is included, the MSEs are identical and given by:
MSEi = 1
L Tr (E) = 1
L

L0 +
⌣L

j=1
1
1 + σ 2
B, jλH, j

,
1 ≤i ≤L
(9.84)

520
LINEAR PRECODING FOR MIMO CHANNELS
 
x
L
B
Tn
L
×
R
T
n
n
×
H
n
y
H
A
R
n
L
xˆ
R
L
n
×
Tn
(a)
1
w
1/ 2
H,1
λ
1x
B,1
σ
A,1
σ ∗
1xˆ
ˆ
ˆ
ˆ
L
w
1/ 2
H,L
λ
L
x
B,L
σ
A,L
σ ∗
L
x
(b)
1
w
1/ 2
H,1
λ
1x
B,1
σ
A,1
σ ∗
1x
L
w
1/ 2
H,L
λ
L
x
B,L
σ
A,L
σ ∗
L
x
(c)
H
B
V
B
V
1x
Lx
1xˆ
ˆLx
Figure 9.10 Scheme of a MIMO communication system with linear Tx-Rx processing. (a)
Original matrix system. (b) Fully diagonalized system. (c) Diagonalized (up
to a rotation) system c⃝2000, IEEE.
Similarly by using Equation (9.77) we have:
SINRi =
L
L0 +
⌣L
j=1
1
1+σ 2
B, j λH, j
−1,
1 ≤i ≤L
(9.85)
The result deﬁned by Equations (9.78)–(9.80) is easily extended to the multicarrier case as follows.
For any carrier k, consider the matrices corresponding to the rest of the carriers {Bl}l̸=k ﬁxed, and
Equations (9.78)–(9.80) can be directly invoked to show the optimal structure for Bk.
9.3.3
Convex optimization-based beamforming
In the sequel we use notation zk,i

= σ 2
Bk,i and λk,i

= λHk,i. Note also that for Schur-concave functions
with Lk > rank(RHk), the Lk −
⌣Lk substreams associated with zero eigenvalues are simply ignored
in the optimization process.

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
521
9.3.3.1
Minimization of the ARITH-MSE
For the minimization of the (weighted) arithmetic mean of the MSEs (ARITH-MSE) the objective
function is
f0

MSEk,i

=

k,i

wk,iMSEk,i

(9.86)
The function f0 ({xi}) = 
i (wi xi) (assuming xi ≥xi+1) is minimized when the weights are in
increasing order wi ≤wi+1, and it is then a Schur-concave function [49]. So, the objective function
Equation (9.86) is Schur-concave on each carrier k, and by Equations (9.78)–(9.80), the diagonal
structure is optimal, and the MSEs are given by Equation (9.82). The problem in convex form (the
objective is convex and the constraints linear) is:
min
{zk,i}

k,i
wk,i
1
1 + λk,i, zk,i
s.t.

k,i
zk,i ≤PT
(9.87)
zk,i ≥0,
1 ≤k ≤N, 1 ≤i ≤
⌣Lk
This particular problem can be solved very efﬁciently because the solution has a water-ﬁlling inter-
pretation (from the KKT optimality conditions):
zk,i =

µ−1/2w1/2
k,i λ−1/2
k,i
−λ−1
k,i
+
(9.88)
where µ−1/2 is the water-level chosen to satisfy the power constraint with equality.
9.3.3.2
Minimization of the GEOM-MSE
The objective function corresponding to the minimization of the weighted geometric mean of the
MSEs (GEOM-MSE) is
f0

MSEk,i

=
2
k,i

MSEk,i
wk,i
(9.89)
The function f0 ({xi}) = 3
i xwi
i
(assuming xi ≥xi+1 > 0) is minimized when the weights are in
increasing order wi ≤wi+1, and it is then a Schur-concave function [49]. So, the objective function,
Equation (9.90), is Schur-concave on each carrier k and by Equations (9.78)–(9.80), the diagonal
structure is optimal, and the MSEs are given by Equation (9.82). The problem in convex form (since
the objective is log-convex, it is also convex [64]) is:
min
{zk,i}
2
k,i
"
1
1 + λk,izk,i
#wk,i
s.t.

k,i
zk,i ≤PT
(9.90)
zk,i ≥0,
1 ≤k ≤N, 1 ≤i ≤
⌣Lk
This problem also has a water-ﬁlling solution (from the KKT optimality conditions):
zk,i =

µ−1wk,i −λ−1
k,i
+
(9.91)
where µ−1 is the water-level chosen to satisfy the power constraint with equality. Note that for
wk,i = 1, Equation (9.91) becomes the classical capacity-achieving water-ﬁlling solution [50, 56]
[see also Equation (4.201)].

522
LINEAR PRECODING FOR MIMO CHANNELS
9.3.3.3
Minimization of
E

The minimization of the determinant of the MSE matrix was considered in [55]. This particular
criterion is easily accommodated in the above framework as a Schur-concave function of the diagonal
elements of the MSE matrix E. For the carrier-noncooperative case, simply consider the global MSE
matrix deﬁned as E = diag (E1, . . . , EN). Using the fact that X ≥Y ⇒|X| ≥|Y|, it follows that |E|
is minimized for the choice of the equalizer matrix given by Equation (9.73). From Equation (9.74),
it is clear that |E| does not change if the precoder matrices Bks are post-multiplied by a unitary matrix
(a rotation).
Therefore, we can always choose a rotation matrix so that E is diagonal without loss of optimality
(see also [15]), and then
|E| =
2
j
λ j (E) =
2
j
[E] j j
(9.92)
Therefore, the minimization of |E| is equivalent to the minimization of the (unweighted) product of
the MSEs as in Section 9.3.3.2.
9.3.3.4
Maximization of mutual information
The maximization of mutual information can be used to obtain a capacity achieving solution [56]
(see also Appendix in Chapter 4)
max
Q
I = log
I + R−1
n HQHH
(9.93)
where Q is the precoder covariance matrix. Using the fact that |I + XY| = |I + YX| and that Q =
BBH [from Equation (9.68)], the mutual information can be expressed as [59]:
I = −log |E|
(9.94)
and therefore, the maximization of I is equivalent to the minimization of |E| treated in Section 9.3.3.3.
Hence, the minimization of the unweighted product of the MSEs, the minimization of the determinant
of the MSE matrix, and the maximization of the mutual information are all equivalent criteria with the
solution given by a channel-diagonalizing structure and the classical capacity-achieving water-ﬁlling
for the power allocation:
zk,i =

µ−1 −λ−1
k,i
+
(9.95)
9.3.3.5
Minimization of the MAX-MSE
In general, average BER is dominated by the substream with highest MSE. It makes sense then to
minimize the maximum of the MSEs (MAX-MSE). Then the objective function is
f0

MSEk,i

= max
k,i

MSEk,i

(9.96)
The function f0 ({xi}) = maxi {xi} is a Schur-convex function [49]. So, the objective function
in Equation (9.96) is Schur-convex on each carrier k. Therefore, Equations (9.78)–(9.80), the op-
timal solution has a nondiagonal MSE matrix Ek with equal diagonal elements given by Equation
(9.84), which have to be minimized (scalarized problem). After minimizing the MSEs, we must
still obtain the optimal rotation matrices so that the diagonal elements of the MSE matrices Eks are
identical. The scalarized problem in convex form (the objective is linear and the constraints are all

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
523
convex) is:
min
t,{zk,i}
t
s.t.
t ≥1
Lk



Lk −
⌣Lk

+
⌣L k

i=1
1
1 + λk,izk,i


(9.97)
1 ≤k ≤N

k,i
zk,i ≤PT
zk,i ≥0,
1 ≤k ≤N, 1 ≤i ≤
⌣Lk
This problem has a multilevel water-ﬁlling solution (from the KKT optimality conditions):
zk,i =

¯µ1/2
k λ−1/2
k,i
−λ−1
k,i
+
(9.98)
where { ¯µ1/2
k } are multiple water levels chosen to satisfy the constraints on t and the power constraint
all with equality. For the case of single beamforming (i.e., Lk = 1), the solution simpliﬁes to:
zk = λ−1
k
PT

l
λ−1
l
(9.99)
For the single-carrier case (or multicarrier cooperative approach), problem (9.97) simpliﬁes to
the minimization of the unweighted ARITH-MSE considered in Section 9.3.3.1 with solution zi =
(µ−1/2λ−1/2
i
−λ−1
i )+.
9.3.3.6
Maximization of the ARITH-SINR
Since, in Equations (9.78)–(9.80), we assumed MSEk,i ≥MSEk,i+1, the SINRs are in increasing order
SINRk,i ≤SINRk,i+1.The objective function to be minimized for the maximization of the (weighted)
arithmetic mean of the SINRs (ARITH-SINR) is
˜f0

SINRk,i

= −

k,i

wk,iSINRk,i

(9.100)
which can be expressed as a function of the MSEs using Equation (9.77) as:
f0

MSEk,i

= ˜f0

MSE−1
k,i −1

= −

k,i
wk,i

MSE−1
k,i −1

(9.101)
The function f0 ({xi}) = −
i wi

x−1
i
−1

(assuming xi ≥xi+1 > 0) is minimized when the
weights are in increasing order wi ≤wi+1, and it is then a Schur-concave function [49]. So, the objec-
tive function of Equation (9.101) is Schur-concave on each carrier k. Therefore, by Equation (9.78)–
(9.80), the diagonal structure is optimal and the SINRs are given by Equation (9.83). The problem
expressed in convex form (it is actually an LP since the objective and the constraints are all linear) is:
max
{zk,i}

k,i
wk,iλk,izk,i
s.t.

k,i
zk,i ≤PT
(9.102)
zk,i ≥0,
1 ≤k ≤N, 1 ≤i ≤
⌣Lk
The optimal solution is to allocate all the available power to the substream with maximum weighted
gain

wk,iλk,i

(otherwise, the objective value could be increased by transferring power from other
substreams to this substream). Although this solution indeed maximizes the weighted sum of the
SINRs, it has poor spectral efﬁciency.

524
LINEAR PRECODING FOR MIMO CHANNELS
9.3.3.7
Maximization of the GEOM-SINR
The objective function to be minimized for the maximization of the (weighted) geometric mean of
the SINRs (GEOM-SINR) is:
˜f0

SINRk,i

= −
2
k,i

SINRk,i
wk,i
(9.103)
which can be expressed as a function of the MSEs using Equation (9.77) as
˜f0

MSEk,i

= ˜f0

MSE−1
k,i −1

= −
2
k,i

MSE−1
k,i −1
wk,i
(9.104)
The maximization of the product of the SINRs is equivalent to the maximization of the sum of
the SINRs expressed in decibels. The function f0 ({xi}) = −3
i

x−1
i
−1
wi (assuming 0.5 ≥xi ≥
xi+1 > 0) is minimized when the weights are in increasing order wi ≤wi+1, and it is then a Schur-
concave function [49]. So, the objective function (9.104) is Schur-concave on each carrier k, provided
that MSEk,i ≤0.5∀k, i (this is a mild assumption since a MSE greater than 0.5 is unreasonable for
a practical communication system). Therefore, by Equations (9.78)–(9.80), the diagonal structure is
optimal, and the SINRs are given by Equation (9.83). The problem expressed in convex form (the
weighted geometric mean is a concave function [64, 65]) is:
max
{zk,i}
2
k,i

λk,izk,i
 ˜wk,i
s.t.

k,i
zk,i ≤PT
(9.105)
zk,i ≥0,
1 ≤k ≤N, 1 ≤i ≤
⌣Lk
where ˜wk,i = wk,i/(
l, j wl, j), and it is assumed that λk,i > 0∀k, i (otherwise, the problem has the
trivial solution zk,i = 0∀k, i). The solution is easily obtained from the KKT optimality conditions as
zk,i = ˜wk,i PT
(9.106)
For a uniform weighting wk,i = 1, the problem reduces to the maximization of the geometric mean
subject to the arithmetic mean:
max
{zk,i}
2
k,i
z1/
⌣L T
k,i
s.t.
1/
⌣LT

k,i
zk,i ≤PT /
⌣LT
(9.107)
zk,i ≥0
where
⌣LT

= N
k=1
⌣Lk. From the arithmetic–geometric mean inequality
3
k xk
1/N ≤1
N

k xk (with
equality if and only if xk = xl∀k,l) [60], it follows that the optimal solution is a uniform power
allocation:
zk,i = PT /
⌣LT
(9.108)
The uniform power distribution is commonly used due to its simplicity.
9.3.3.8
Maximization of the HARM-SINR
For maximization of the harmonic mean of the SINRs (HARM-SINR) in the case of single beam-
forming, the objective function to be minimized is:
˜f0

SINRk,i

=

k,i
1
SINRk,i
(9.109)

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
525
which can be expressed as a function of the MSEs using Equation (9.77) as:
f0

MSEk,i
 
k,i
MSEk,i
1 −MSEk,i
(9.110)
The function f0 ({xi}) = 
i (xi/ (1 −xi)) (for 0 ≤xi < 1) is a Schur-convex function [49].
So, the objective function (9.110) is Schur-convex on each carrier k. Therefore, by Equations
(9.78)–(9.80), the optimal solution has a nondiagonal MSE matrix Ek with equal diagonal elements
given by Equation (9.84), which have to be minimized. The scalarized problem in convex form is:
min
{tk},{zk,i}

k
tk
1 −tk
s.t.
1 > tk ≥1
Lk



Lk −
⌣Lk

+
⌣L k

i=1
1
1 + λk,izk,i



k,i
zk,i ≤PT
zk,i ≥0,
1 ≤k ≤N, 1 ≤i ≤
⌣Lk
(9.111)
The problem has a multilevel water-ﬁlling solution
zk,i =

¯µ1/2
k λ−1/2
k,i
−λ−1
k,i
+
(9.112)
where { ¯µ1/2
k } are multiple water levels chosen to satisfy the lower constraints on the tks and the power
constraint, all with equality, and also the constraint ¯µ1/2
k
= v
L−1/2
k
1−tk , where v is a positive parameter.
For the case of single beamforming (i.e., Lk = 1), the solution reduces to zk = λ−1/2
k
(PT / 
l λ−1/2
l
).
For the single-carrier case (or multicarrier cooperative approach), the problem simpliﬁes to that
considered in Section 9.3.3.1.
9.3.3.9
Maximization of the MIN-SINR
The objective function to be minimized for the maximization of the minimum of the SINRs (MIN-
SINR) is
˜f0

SINRk,i

= −min
k,i

SINRk,i

(9.113)
This design criterion is equivalent to the minimization of the maximum MSE treated with detail in
Section 9.3.3.5. In [54], the same criterion was used, imposing a channel diagonal structure.
9.3.3.10
Maximization of the PROD-(1 + SINR)
Let us start with the following maximization:
max
2
k,i

1 + SINRk,i

(9.114)
Using Equation (9.77), this maximization can be equivalently expressed as the minimization of
3
k,i MSEk,i as in Equation (9.87) with wk,i = 1, as the minimization of the determinant of the
MSE matrix (Section 9.3.3.3), and as the maximization of the mutual information (Section 9.3.3.4)
with the solution given by the capacity-achieving expression Equation (9.95). This result is natural
since maximizing the logarithm of (9.114) is tantamount to maximizing the mutual information
I = 
k,i log

1 + SINRk,i

.

526
LINEAR PRECODING FOR MIMO CHANNELS
9.3.3.11
Minimization of the ARITH-BER
The minimization of the average BER or of the arithmetic mean of the BERs (ARITH-BER) can
be considered as the best criterion (assuming that after the linear processing at the receiver, each
substream is detected independently). The objective function is:
˜f0

BERk,i

=

k,i
BERk,i
(9.115)
which can be expressed as a function of the MSEs using Equation (9.77) as:
f0

MSEk,i

=

k,i
BER

MSE−1
k,i −1

(9.116)
The function f0 ({xi}) = 
i BER

x−1
i
−1

(assuming θ ≥xi > 0, for sufﬁciently small θ such that
BER

x−1
i
−1

≤2 × 10−2, ∀i) is a Schur-convex function [49].
The objective function (9.116) is Schur-convex on each carrier k (assuming the same constel-
lation/coding on all substreams of the kth carrier), provided that BERk,i ≤2 × 10−2 (interestingly,
for BPSK and QPSK constellations, this is true for any value of the BER). Therefore, by Equa-
tions (9.78)–(9.80), the optimal solution has a nondiagonal MSE matrix Ek with equal diagonal
elements given by Equation (9.84), which have to be minimized. The scalarized problem in convex
form is
min
{tk},{zk,i}

k
αkQ
"%
βk

t−1
k
−1
#
s.t.
θ ≥tk ≥1
Lk



Lk −
⌣Lk

+
⌣L k

i=1
1
1 + λk,izk,i


1 ≤k ≤N

k,i
zk,i ≤PT
zk,i ≥0,
1 ≤k ≤N, 1 ≤i ≤
⌣Lk
(9.117)
The upper bound θ on the MSEs is explicitly included to guarantee the convexity of the BER function
and, therefore, of the whole problem. For a general case with Lk > 1 and N > 1, problem (51) does
not have a simple closed-form solution, and one has to resort to general-purpose iterative methods such
as interior-point methods (see Section 9.3). For the single-carrier case (or multicarrier cooperative
approach), the problem simpliﬁes to the ARITH-MSE criterion considered in Section 9.3.3.1, plus
the rotation matrix to make the diagonal elements of the MSE matrix equal.
9.3.4
Constraints in multicarrier systems
We can, for example, add constraints on the dynamic range of the power ampliﬁer at each transmit
antenna element, as was done in [68]. Consider a Schur-concave objective function and assume
for simplicity Lk = L∀k. From the optimal structure in Equation (9.79) Bk = UHk,1

Bk,1, the total
average transmitted power (in units of energy per symbol period) by the ith antenna is
Pi = 1
N
N

k=1
L

i=1
[Bk]2
i,l
 = 1
N
N

k=1
L

i=1
σ 2
Bk,l


UHk,1

i,l

2
(9.118)
which is linear in the variables {σ 2
Bk,i} (for the carrier-cooperative scheme, Pi = (1/N) N
k=1
N L
l=1 |[B]i+(k+1)nT ,l|2. Therefore, the following constraints are linear as αL
i ≤Pi ≤αU
i 1 ≤i ≤nT
where αL
i and αU
i are the lower and upper bounds for the ith antenna. Similarly, it is straightforward

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
527
to set limits on the relative dynamic range of a single element in comparison with the total power
for the whole array [68] as ρL
i Parray ≤Pi ≤ρU
i Parray1 ≤i ≤nT , where ρL
i and ρU
i
are the relative
bounds, and Parray = nT
i=1 Pi is the total power that is also linear in {σ 2
Bk,i}.
We also show how the PAPR (see Chapter 7) can be taken into account into the design of the beam
vectors using a convex optimization framework. The PAR is deﬁned as:
PAR

= max
0≤t≤Ts
A2 (t)
σ 2
(9.119)
where Ts is the symbol period, A (t) is the zero-mean transmitted signal, and σ 2 = E

A2 (t)

. Since
the number of carriers is usually large (N ≥64), A (t) can be accurately modelled as a Gaussian
random process (central-limit theorem) with zero mean and variance σ 2. Using this assumption,
the probability that the PAR exceeds certain threshold or, equivalently, the probability that the
instantaneous amplitude exceeds a clipping value Aclip is
Pr
|A (t)| > Aclip

= 2Q
" Aclip
σ
#
(9.120)
The clipping probability of an OFDM symbol is then
Pclip (σ) = 1 −
"
1 −2Q
" Aclip
σ
##2N
(9.121)
In other words, in order to have a clipping probability lower than P with respect to the maximum
instantaneous amplitude Aclip, the average signal power must satisfy
σ ≤σclip (P) =
Aclip
Q−1

1−(1−P)1/2N
2

(9.122)
When using multiple antennas for transmission, the previous equation has to be satisﬁed for all
transmit antennas. Those constraints can be easily incorporated in any of the convex designs derived
in Section 9.3.3 with a Schur-concave objective function. Using Equation (9.118), the constraint is
1
N
N

k=1
L

l=1
σ 2
Bk,l


UHk,1

i,l

2
≤σ 2
clip
1 ≤i ≤nT
(9.123)
which is linear in the optimization variables

σ 2
Bk,i

. Such a constraint has two effects in the solution:
(i) The power distribution over the carriers changes with respect to the distribution without the
constraint, and (ii) the total transmitted power drops as necessary.
9.3.5
Performance examples
For the numerical results, we use the multicarrier modulation OFDM (64 carriers). We consider
the multicarrier MIMO model used throughout the section. Perfect CSI is assumed at both sides
of the communication link. The frequency selectivity of the channel is modeled using the power
delay proﬁle as speciﬁed in [70] [see Figure 9.11(a)], which corresponds to a typical large open
space indoor environment for non-line-of-sight (NLOS) conditions with 150 ns average r.m.s. delay
spread and 1050 ns maximum delay (the sampling period is 50 ns) [69]. The spatial correlation of
the MIMO channel is modeled according to [71] (which corresponds to a reception hall) speciﬁed
by the correlation matrices of the envelope of the channel fading at the transmit and receive side
given in Figure 9.11(b), where the base station is the receiver (uplink) (see [71] for details of the
model). It provides a large open indoor environment with two ﬂoors, which could easily illustrate
a conference hall or a shopping galleria scenario. The matrix channel generated was normalized
so that 
n E[|Hi j (n)|2] = 1. The SNR is deﬁned as the transmitted power normalized with the
noise variance. The following design criteria have been compared: ARITH-MSE, GEOM-MSE,

528
LINEAR PRECODING FOR MIMO CHANNELS
MAX-MSE (equivalently, MIN-SINR or MAX-BER), GEOM-SINR, HARM-SINR, and ARITH-
BER (benchmark). The utilization of the Chernoff upper bound instead of the exact BER function
gives indistinguishable results and is therefore not presented in the simulation results. Unless oth-
erwise speciﬁed, carrier-noncooperative approaches are considered. The performance in terms of
outage BER (averaged over the channel substreams), i.e. the BER that can be guaranteed with some
probability or, equivalently, the BER that is not achieved with some small outage probability. In
particular, we consider the BER with an outage probability of 5 %. The results are presented in
Figures 9.12–9.16.
–25
–20
–15
–10
–5
0
0
200
400
600
800
1000
Delay (ns)
Average relative power (dB)
BS
1.0000
0.4154
0.2057
0.1997
0.4154
1.0000
0.3336
0.3453
0.2057
0.3336
1.0000
0.5226
0.1997
0.3453
0.5226
1.0000
=
R
MS
1.0000
0.3644
0.0685
0.3566
0.3644
1.0000
0.3245
0.1848
0.0685
0.3245
1.0000
0.3093
0.3566
0.1848
0.3093
1.0000
=
R
(a)
(b)
Figure 9.11 (a) Power delay proﬁle type C for HIPERLAN/2. (b) Envelope correlation
matrices at the base station (BS) and at the mobile station (MS) c⃝2000,
IEEE.

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
529
0
5
10
15
10
–4
10
–3
10
–2
10
–1
10
0
SNR (dB)
BER
Outage BER (QPSK) in a MIMO(2,2) channel
GEOM-MSE
GEOM-SINR
ARITH-MSE
HARM-SINR
MAX-MSE
ARITH-BER
Figure 9.12 BER (at an outage probability of 5 %) versus SNR when using QPSK in a
2 × 2 MIMO channel with L = 1 for the speciﬁed design criteria (without
carrier cooperation).
4
6
8
10
12
14
16
18
10
–4
10
–3
10
–2
10
–1
10
0
SNR (dB)
BER
Outage BER (16-QAM) in a MIMO(4,2) channel
GEOM-MSE
GEOM-SINR
ARITH-MSE
HARM-SINR
MAX-MSE
ARITH-BER
Figure 9.13 BER (at an outage probability of 5 %) versus SNR when using 16-QAM in a
4 × 2 MIMO channel (two transmit and four receive antennas) with L = 1 for
the speciﬁed design criteria (without carrier cooperation).

530
LINEAR PRECODING FOR MIMO CHANNELS
2
2.5
3
3.5
4
4.5
5
10
–4
10
–3
10
–2
10
–1
10
(a)
0
mu
Prob. clipping
Prob. clipping (SNR=8.00 dB) in a MIMO(2,2) channel
 
ARITH-MSE
ARITH-MSE (PAR const.)
2
2.5
3
3.5
4
4.5
5
10
–3
10
–2
10
–1
mu
BER
Outage BER (QPSK) in a MIMO(2,2) channel
ARITH-MSE (PAR const.)
ARITH-MSE
Figure 9.14 (a) Probability of clipping and BER (at an outage probability of 5 %) when
using QPSK in a 2 × 2 MIMO channel with L = 1 for the ARITH-MSE
criterion with and without PAR constraints (without carrier cooperation) as a
function of µ (for SNR = 8 dB and Pclip ≤10−2). Aclip = µ√PT /nT .

CONVEX OPTIMIZATION-THEORY-BASED BEAMFORMING
531
–5
0
5
10
15
10
–3
10
–2
10
–1
10
0
SNR (dB)
Prob. clipping
Prob. clipping (mu=4.0) in a MIMO(2,2) channel
ARITH-MSE
ARITH-MSE (PAR const.)
0
5
10
15
10
–4
10
–3
10
–2
10
–1
10
0
SNR (dB)
BER
Outage BER (QPSK) in a MIMO(2,2) channel
ARITH-MSE (PAR const.)
ARITH-MSE
(b)
Figure 9.14 (b) Probability of clipping and BER (at an outage probability of 5 %) when
using QPSK in a 2 × 2 MIMO channel with L = 1 for the ARITH-MSE
criterion with and without PAR constraints (without carrier cooperation) as a
function of the SNR (for µ = 4 and Pclip ≤10−2). Aclip = µ√PT /nT .

532
LINEAR PRECODING FOR MIMO CHANNELS
2
4
6
8
10
12
14
16
18
10
–4
10
–3
10
–2
10
–1
10
0
SNR (dB)
BER
Outage BER (QPSK) in a MIMO(4,4) channel
GEOM-MSE
GEOM-SINR
ARITH-MSE
HARM-SINR
MAX-MSE
ARITH-BER
Figure 9.15 BER (at an outage probability of 5 %) versus SNR when using QPSK in a
4 × 4 MIMO channel with L = 2 for the speciﬁed design criteria (without
carrier cooperation).
5
6
7
8
9
10
11
12
13
10
–4
10
–3
10
–2
10
–1
SNR (dB)
BER
Outage BER (QPSK) in a MIMO(2,2) channel
ARITH-MSE-noncoop
HARM-SINR-noncoop
ARITH-MSE-coop
MAX-MSE-noncoop
ARITH-BER-noncoop
HARM-SINR-coop
MAX-MSE-coop
ARITH-BER-coop
Figure 9.16 BER (at an outage probability of 5 %) versus SNR when using QPSK in a
2 × 2 MIMO channel with L = 1 for the speciﬁed design criteria with (coop)
and without (noncoop) carrier cooperation.

REFERENCES
533
REFERENCES
1. Ding, Z. and Li, Y. (2001) Blind Equalization and Identiﬁcation, Signal Processing and Commu-
nications Series. New York: Marcel Dekker.
2. Kailath, T. (1980) Linear Systems. Englewood Cliffs, NJ: Prentice-Hall.
3. Forney, G. D. (1970) Convolution codes I: Algebraic structure, IEEE Transactions on Information
Theory, IT-16, 720–738.
4. Kung, S.-Y., Wu, Y. and Zhang, X. (2002) Bezout space-time precoders and equalizers for MIMO
channels, IEEE Transactions on Signal Processing, 50, 2499–2514.
5. Xia, X.-G. (1997) New precoding for intersymbol interference cancellation using nonmaximally
decimated multirate ﬁlterbanks with ideal FIR equalizers, IEEE Transactions on Signal Process-
ing, 45, 2431–2440.
6. Xia, X.-G., Su, W. and Liu, H. (2001) New precoders for blind equalization: polynomial ambiguity
resistant precoders (PARP), IEEE Transactions on Cirtuits Systems I, 48, 193–209.
7. Yang, J., and Roy, S. (1994) On joint transmitter and receiver optimization for multiple-input–
multiple-output (MIMO) transmission systems, IEEE Transactions on Communication, 42, 3221–
3231.
8. Scaglione, A., Giannakis, G. B. and Barbarossa, S. (1999) Redundant ﬁlterbank precoders and
equalizers, Part I: Identiﬁcation and optimal designs, IEEE Transactions on Signal Processing,
47, 1988–2006.
9. Vaidyanathan, P. P. and Mitra, S. K. (1988) Polyphase networks, block digital ﬁltering, LPTV
systems, and alias-free QMF banks: a uniﬁed approach based on pseudocirculants, IEEE Trans-
actions on Signal Processing, 36, 381–391.
10. Wiesel, A., Eldar, Y. C. and Shamai (Shitz), S. (2006) Linear precoding via conic optimization
for ﬁxed MIMO receivers, IEEE Transactions on Signal Processing, 54, 161–176.
11. Vojcic, B. R. and Jang, W. M. (1998) Transmitter precoding in synchronous multiuser commu-
nication, IEEE Transactions on Communication, 46, 1346–1355.
12. Joham, M., Kusume, K., Gzara, M. H. and Utschick, W. (2002) Transmit wiener ﬁlter for the
downlink of TDD DS-CDMA systems, in Proceedings IEEE 7th International Symposium on
Spread Spectrum Techniques Applications (ISSSTA), 1, Sep. 2002, pp 9–13.
13. Choi, R. L. U. and Murch, R. D. (2003) New transmit schemes and simpliﬁed receivers for
MIMO wireless communications systems, IEEE Transactions on Wireless Communication, 2,
1217–1230.
14. Choi, L. U. and Murch, R. D. (2004) Transmit-preprocessing techniques with simpliﬁed receivers
for the downlink of MISO TDD-CDMA systems, IEEE Transactions on Vehicular Technology,
53, 285–295.
15. Esmailzadeh, R., Sourour, E. and Nakagawa, M. (1999) Pre-rake diversity combining in time
division duplex CDMA mobile communications, IEEE Transactions on Vehicular Technology,
48, 795–801.
16. Fischer, R. F. H. (2002) Precoding and Signal Shaping for Digital Transmission. Wiley, New
York.
17. Brandt-Pearce, M. and Dharap, A. (2000) Transmitter based multiuser interference rejection for
the down-link of a wireless CDMA system in a multipath environment, IEEE Journal of Selected
Areas of Communication, 18, 407–417.

534
LINEAR PRECODING FOR MIMO CHANNELS
18. Meurer, M., Baier, P. W., Weber, T., Lu, Y. and Papathanassiou, A. (2000) Joint transmission:
Advantageous downlink concept for CDMA mobile radio systems using time division duplexing,
Electronics Letters, 36, 900–901.
19. Georgoulis, S. and Cruickshank, D. (2001) Pre-equalization, transmitter precoding, and joint
transmission techniques for time division duplex CDMA, in Proceedings IEE 3G Mob. Commu-
nications Technology, London, Mar. pp. 257–261.
20. Barreto, A. N. and Fettweis, G. (2003) Joint signal precoding in the downlink of spread spectrum
systems, IEEE Transactions on Wireless Communications, 2, 511–518.
21. Georgoulis, S. L. and Cruickshank, D. G. M. (2004) Transmitter-based inverse ﬁlters for reducing
MAI and ISI in CDMA-TDD downlink, IEEE Transactions on Wireless Communications, 3, 353–
358.
22. Choi, J. and Perreau, S. (2004) MMSE multiuser downlink multiple antenna transmission for
CDMA channels, IEEE Transactions on Signal Processing, 52, 1564–1573.
23. Wang, S. and Caffery, J. (2003) Linear multiuser precoding for synchronous CDMA, in Proceed-
ings IEEE Wireless Communications Networking Conference (WCNC2003), 1, Mar. 2003, pp.
403–407.
24. Choi, L. U. and Murch, R. D. (2004) A transmit preprocessing technique for multiuser MIMO
systems using a decomposition approach, IEEE Transactions on Wireless Communications, 3,
20–24.
25. Collin, L., Berder, O., Rostaing, P. and Burel, G. (2004) Optimal minimum distance based
precoder for MIMO spatial multiplexing systems, IEEE Transactions on Signal Processing, 52,
617–627.
26. Fischer, R., Windpassinger, C., Lampe, A. and Huber, J. (2002) Space time transmission using
Tomlinson-Harashima precoding, in Proceedings 4th ITG Conference on Source Channel Coding,
Berlin, January 2002, pp. 139–147.
27. Schubert, M., and Boche, H. (2002) Joint ‘dirty paper’ pre-coding and downlink beamforming,
in Proceedings IEEE International Symposium on Spread Spectrum Techniques Applications
(ISSSTA 2002), 2, Sep. 2002, pp. 536–540.
28. Hons, E. S., Khandani, A. K. and Tong, W. (2002) An optimized transmitter precoding scheme
for synchronous DS-CDMA, in Proceedings IEEE International Communications Conference,
3, Apr. 2002, pp. 1818–1822.
29. Ding, Y., Davidson, T. N., Luo, Z.-Q. and Wong, K. M. (2003) Minimum BER block precoders
for zero-forcing equalization, IEEE Transactions on Signal Processing, 51, pp. 2410–2423.
30. Ban, K., Katayama, M., Yamazato, T. and Ogawa, A. (1999) Transmitter precoding with multiple
transmit/receive antennas for high data rate communication in bandwidth-limited channels, in
Proceedings of Vehicular Technology Conference (VTC 1999–Fall), 3, 1946–1950.
31. Yang, J. and Roy, S. (1994) Joint transmitter receiver optimization for multi-input–multi-output
systems with decision feedback, IEEE Transactions on Information Theory, 40, 1334–1347
32. Scaglione, A., Stoica, P., Barbarossa, S., Giannakis, G. B. and Sampath, H. S. (2002) Optimal
designs for space time linear precoders and decoders, IEEE Transactions on Signal Processing,
50, 1051–1064.
33. Palomar, D. P., Ciofﬁ, J. M. and Lagunas, M. A. (2003) Joint Tx-Rx beamforming design for
multicarrier MIMO channels: a uniﬁed framework for convex optimization, IEEE Transactions
on Signal Processing, 51, 2381–2401.

REFERENCES
535
34. Palomar, D. P., Lagunas, M. A. and Ciofﬁ, J. M. (2004) Optimum linear joint transmit–receive
processing for MIMO channels with QoS constraints, IEEE Transactions on Signal Processing,
52, 1179–1197.
35. Luo, Z. Q., Davidson, T. N., Giannakis, G. B. and Wong, K. M. (2004) Transceiver optimization
for block-based multiple access through ISI channels, IEEE Transactions on Signal Processing,
52, 1037–1052.
36. Serbetli, S. and Yener, A. (2004) Transceiver optimization for multiuser MIMO systems, IEEE
Transactions on Signal Processing, 52, 214–226.
37. Sampath, H., Stoica, P. and Paulraj, A. (2001) Generalized linear precoder and decoder design for
MIMO channels using the weighted MMSE criterion, IEEE Transactions on Communications,
49, 2198–2206.
38. Chang, J. H., Tassiulas, L. and Farrokhi, F. R. (2002) Joint transmitter receiver diversity for
efﬁcient space division multiple access, IEEE Transactions on Wireless Communications, 1,
16–27.
39. Visotsky, E. and Madhow, U. (1999) Optimum beamforming using transmit antenna arrays, in
Proceedings IEEE Vehicular Technology Conference, 1, May 1999, pp. 851–856.
40. Bengtsson, M. and Ottersten, B. (1999) Optimal downlink beamforming using semideﬁnite
optimization, in Proceedings 37th Annual Allerton, Sep. 1999, pp. 987–996.
41. Boyd, S. and Vandenberghe, L. (2003) Introduction to Convex Optimization with Engineering
Applications. Cambridge University Press, Stanford, CA.
42. Sturm, J. F. (1999) Using SEDUMI 1.02, a Matlab toolbox for optimizations over symmetric
cones, Optimization Methodology. Software, 11–12, 625–653.
43. Lobo, M. S., Vandenberghe, L., Boyd, S. and Lebret, H. (1998) Applications of second order
cone programming, Linear Algebra Application, 284, 193–228.
44. Vandenberghe, L. and Boyd, S. (1996) Semideﬁnite programming, SIAM Review, 38, 49–95.
45. Boyd, S. and Ghaoui, L. E. (1993) Method of centers for minimizing generalized eigenvalues,
Linear Algebra and Its Applications, 188–189, 63–111.
46. Schubert, M. and Boche, H. (2004) Solution of the multiuser downlink beamforming problem
with individual SINR constraints, IEEE Transactions on Vehicular Technology, 53, 18–28.
47. Tung, T.-L. and Yao, K. (2002) Optimal downlink power-control design methodology for a
mobile radio DS-CMDA system, in Proceedings IEEE Workshop Signal Processing Systems
(SIPS-2002), pp. 165–170.
48. Verdu, S. (1998) Multiuser Detection. Cambridge University Press, Cambridge.
49. Palomar, D. P., Ciofﬁ, J. M. and Lagunas, M. A. (2003) Joint Tx-Rx beamforming design for
multicarrier MIMO channels: a uniﬁed framework for convex optimization, IEEE Transactions
on Signal Processing, 51, 2381–2400.
50. Raleigh, G. G. and Ciofﬁ, J. M. (1998) Spatio-temporal coding for wireless communication,
IEEE Transactions on Communications, 46, 357–366.
51. B¨olcskei, H. and Paulraj, A. J. (2002) Multiple-input multiple-output (MIMO) wireless systems,
in The Communications Handbook, 2nd ed, J. Gibson (Ed.) CRC, Boca Raton, FL, pp. 90.1–90.14.
52. Yang, J. and Roy, S. (1994) On joint transmitter and receiver optimization for multiple-input-
multiple-output (MIMO) transmission systems, IEEE Transactions on Communications, 42,
3221–3231.

536
LINEAR PRECODING FOR MIMO CHANNELS
53. Scaglione, A., Giannakis, G. B. and Barbarossa, S. (1999) Redundant ﬁlterbank precoders and
equalizers, Part I: Uniﬁcation and optimal designs, IEEE Transactions on Signal Processing, 47,
1988–2006.
54. Sampath, H., Stoica, P. and Paulraj, A. (2001) Generalized linear precoder and decoder design for
MIMO channels using the weighted MMSE criterion, IEEE Transactions on Communications,
49, 2198–2206.
55. Yang, J. and Roy, S. (1994) Joint transmitter–receiver optimization for multi-input–multi-output
systems with decision feedback, IEEE Transactions on Information Theory, 40, 1334–1347.
56. Cover, T. M. and Thomas, J. A. (1991) Elements of Information Theory. Wiley, New York.
57. Scaglione, A., Barbarossa, S. and Giannakis, G. B. (1999) Filterbank transceivers optimizing in-
formation rate in block transmissions over dispersive channels, IEEE Transactions on Information
Theory, 45, 1019–1032.
58. Scaglione, A., Stoica, P., Barbarossa, S., Giannakis, G. B. and Sampath, H. (2002) Optimal
designs for space–time linear precoders and decoders, IEEE Transactions on Signal Processing,
50, 1051–1064.
59. Ciofﬁ, J. M. and Forney, G. D. (1997) Generalized decision-feedback equalization for packet
transmission with ISI and Gaussian noise, Ch. 4 in Communications, Computation, Control and
Signal Processing, A. Paulraj, V. Roychowdhury, and C. D. Schaper (Eds.) Kluwer, Boston, MA.
60. Horn, R. A. and Johnson, C. R. (1985) Matrix Analysis. Cambridge University Press, New York.
61. Verd´u, S. (1998) Multiuser Detection. Cambridge University Press, New York.
62. Viswanath, P. and Anantharam, V. (1999) Optimal sequences and sum capacity of synchronous
CDMA systems, IEEE Transactions on Information Theory, 45, 1984–1991.
63. Marshall, A. W. and Olkin, I. (1979) Inequalities: Theory of Majorization and Its Applications.
Academic Press, New York.
64. Boyd, S. and Vandenberghe, L. (2000) Introduction to convex optimization with engi-
neering applications. Stanford University, Stanford, CA, Course Notes. [Online]. Available:
http://www.stanford.edu/class/ee364.
65. Rockafellar, R. T. (1970) Convex Analysis, 2nd ed. Princeton University Press, Princeton, NJ.
66. Wong, K. K., Cheng, R. S. K., Letaief, K. B. and Murch, R. D. (2001) Adaptive antennas at the
mobile and base stations in an OFDM/TDMA system, IEEE Transactions on Communications,
49, 195–206.
67. Luenberger, D. G. (1969) Optimization by Vector Space Methods. Wiley, New York.
68. Bengtsson, M. and Ottersten, B. (2001) Optimal and suboptimal transmit beamforming, in
Handbook of Antennas in Wireless Communications, L. C. Godara (Ed.) CRC, Boca Raton,
FL.
69. ETSI (2001) Broadband radio access networks (BRAN); HIPERLAN type 2; physical (PHY)
layer, ETSI TS 101 475 V1.2.2, pp. 1–41.
70. ETSI (1998) Channel models for HIPERLAN/2 in different indoor scenarios, ETSI EP BRAN
3ERI085B, pp. 1–8.
71. Schumacher, L., Kermoal, J. P., Frederiksen, F., Pedersen, K. I., Algans, A. and Mogensen, P. E.
(2001) MIMO channel characterization. [Online]. Available: http://www.ist-metra.org, Deliver-
able D2 V1.1 of IST-1999–11 729 METRA project, pp. 1–57.
72. Nesterov, Y. and Nemirovsky, A. (1994) Interior-point polynomial methods for convex program-
ming, SIAM Studies Applied Mathematics, 13.

10
Cognitive Radio
10.1
ENERGY-EFFICIENT COGNITIVE RADIO
Within this section we discuss some practical solutions and results for the adaptation of receiver
parameters in order to improve performance and reduce energy consumption. Depending on the
channel state, different receiver parameters can be changed for these purposes. Table 10.1 presents
a summary of these options. Figure 10.1 presents a generic block diagram of such a receiver. The
discussion in this section is based on [1] c⃝1999, IEEE. This, so called context aware radio, capable
of observing the channel and network parameters and making autonomously decisions on the best
transceiver conﬁguration, will be reffered to as software or cognitive radio.
In the simulation environment, the sender and receiver entities are instrumental in tracking energy
consumption. The sender entity keeps track of energy consumption due to the RF transmission and link
layer computation, such as forward error correction (FEC) encoding. The receiver entity tracks energy
consumption due to the RF receiver and computation tasks such as FEC decoding and equalization.
In all of the simulation, the RF section is assumed to dissipate 0.1 W during sleep, 0.6 W during
receive and 1.8 W during transmit mode. The data on dissipation are taken from a commercial (General
Electric Company’s Plessy) radio for wireless local area networks (WLANs). The details of the energy
estimates for the computation tasks such as the FEC and equalization are described later in the section.
10.1.1
Frame length adaptation
When the BER due to random noise and interference changes, so does the frame error rate, which in
turn determines the application level throughput, or goodput (excluding the header). Regardless of the
transmission rate Rt, with large frame length the goodput of the link can drop to zero if every packet
gets corrupted. The radio will still be transmitting (retransmissions) and therefore wasting battery
energy. Reducing frame length can improve the goodput and therefore energy efﬁciency by reducing
the probability of frame errors and the need for excessive numbers of retransmissions. However, the
relative overhead of the frame header also increases, thereby offsetting the improvement in goodput.
Therefore, an optimum frame length exists that maximizes goodput for a given BER as shown in the
measurements in Figure 10.2. These measurements have been obtained with a peer-to-peer wireless
link using the 900 MHz WaveLAN (WLAN) radios under varying channel interference introduced
using an AWGN noise generator. A link layer header of eight bytes has been used.
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

538
COGNITIVE RADIO
Table 10.1
Adaptation of radio parameters to channel degradations
Channel degradations
Adaptive radio parameters
Adaptation mechanism
Low level
FEC/ARQ
Adaptive error
Control
Low level
Frame length
Adaptive frame length
Interference
High level
Processing gain
Adaptive spread spectrum
Bursty
Frame length
Adaptive frame length
Flat fading
Frame length
Adaptive frame length
Frequency selective
Channel impulse response
Adaptive equalizer
fading
Input File
Segment
FEC
Buffer
Buffer
Control
Output File
Reassemble
Buffer
FEC-1
Buffer
Control
Control
Error
Injector
Data Path
ACK Path
Control
Source
Sender
Receiver
Sink
Input file
Segment
FEC
Buffer
Buffer
Control
Output file
Reassemble
Buffer
FEC-1
Buffer
Control
Control
Error
injector
Data path
ACK path
Control
Source
Sender
Receiver
Sink
Figure 10.1 Simulation environment for adaptive radio.
Conventionally, the relationship in Figure 10.2 is used to adapt the frame length to maximize the
goodput for a given BER. However, if the frame length adaptation is applied for reducing energy
consumption under a given constraint on goodput, the radio selects the frame length that maximizes the
BER required to meet the goodput constraint, thereby minimizing the required transmit energy per bit
Eb/N0. The reduction in required Eb/N0 is exploited to reduce the transmitter power to obtain energy
saving. Note that in most radios the transmitter energy consumption dominates. This adaptation
approach is illustrated in Figure 10.3, which is derived from the measurements in Figure 10.2
and shows the relative energy versus frame length for different goodput constraints.
For a given goodput constraint, the radio selects the frame length that minimizes energy according
to the corresponding curve in Figure 10.3. The radio monitors the BER and adjusts the transmit power
to hold the BER constant at the maximum allowable value. For example, for the best case in Figure
10.3, if the desired goodput is 150 kbit/s, which is 7.5 % of the transmission rate Rt in this experiment,
then a 30 % reduction in battery energy consumption is achieved by reducing the frame size from the
1500 bytes Ethernet standard to 100 bytes.

ENERGY-EFFICIENT COGNITIVE RADIO
539
10-8
4×10-4
6×10-4
3×10-3
10-3
0
200
400
600
800
1000
1200
1400
1600
200
400
600
800
1000
1200
0
Frame length (bytes)
Goodput (kbps)
10-8
4×10-4
6×10-4
3×10-3
10-3
0
200
400
600
800
1000
1200
1400
1600
200
400
600
800
1000
1200
0
Figure 10.2 Goodput results.
0
200
400
600
800
1000
1200
1400
1600
1.2
1.4
1.6
1.8
2.0
2.2
1
Frame length (bytes)
Energy (normalized)
480 Kbps
360 Kbps
150 Kbps
0
200
400
600
800
1000
1200
1400
1600
1.2
1.4
1.6
1.8
2.0
2.2
1
Energy (normalized)
480 Kbps
360 Kbps
150 Kbps
Figure 10.3 Energy versus frame length [1] c⃝1999, IEEE.
The above discussion holds for the general case but the amount of energy saving will depend on
the Eb/N0 required for a particular modulation. The results in Figures 10.2 and 10.3 are valid for
quadrature phase shift keying (QPSK modulation).
10.1.2
Frame length adaptation in ﬂat fading channels
The simulations are now in a ﬂat fading channel, where errors occur in bursts as a function of the
relative motion between the transmitter and receiver. The burstiness of the channel is modeled with a

540
COGNITIVE RADIO
Good (0)
Bad (1)
t0,0
t1,1
(
(
0
1,
0
/
µ
⋅
=
tR
N
t
(
)
1
0
,1
/
µ
⋅
=
tR
N
t
Figure 10.4 Gilbert–Elliot model for ﬂat fading channels.
two-state Discrete Time Markov Channel (DTMC) shown in Figure 10.4, with the following channel
parameters [1]:
r ρ = R/Rrms is the ratio of the Rayleigh fading envelop R to the local root mean square (RMS)
level.
r The average number of level crossings in a positive direction per second is given by N =
(2π)1/2 fmρ e−ρ2 N = (2π)1/2 fmρ e−ρ2
r The average time T , for which the received signal is below a speciﬁed level R, is given by
T = (eρ2 −1)/( fmρ(2π)1/2)
r Assuming steady-state conditions, the probability that we will ﬁnd a given channel in the Good or
Bad condition is
µ =

µ0
µ1

=

P(Good)
P(Bad)

=


(1/N −T )
1/N
T
1/N

=

e−ρ2
1 −e−ρ2

r BER = P(Good) · BERG + P(Bad) · BEGB.
r The Good state BER is a function of the signal to noise ratio (SNR) at the receiver (degraded by
such things as path loss, local interferers, thermal noise, etc.).
r The Bad state BER is ﬁxed at 0.5. The Good state BER is allowed to vary over a wide range, 10−2
to 10−8.
r ρ is set to −20 dB throughout the simulation. This is a conservative assumption that the radio has
a 20 dB fading margin.
r The second variable of interest is the speed of the mobile, which indicates the burstiness of the
channel.
r Selective acknowledgment (SACK) has been chosen as the error control scheme with a link layer
header of eight bytes.
r The carrier frequency is set at 900 MHz.
r The transmission rate Rt is set at 625 kbits/s.
Simulation results are shown in Figure 10.5 for frame lengths ranging from 50–1500 bytes. The
results are based on the greedy data as the data source, with Ln = (Lfm)/Rt – the ratio of the frame
length to the time interval between fades.
The achievable throughputs are shown in Figure 10.6. From these ﬁgures we can see that after
the region of ﬂat performance, the throughput decreases exponentially as Ln increases, and energy

ENERGY-EFFICIENT COGNITIVE RADIO
541
103
50100
150
200
500  1500
10−3
10−2
10−1
100
101
102
100
101
  Normalized frame length (Ln= Lfm /Rt )
Energy per useful bit (µJ/ bit)
Figure 10.5 Energy per useful bit versus normalized frame length. Frame length size in
bytes is annotated alongside the corresponding curves. The carrier frequency
is 900 Hz and the transmission rate is 625 kbit/s. ρ = −20 dB, BERG = 10−5,
and BERB = 0.5.
10−3
10−2
10−1
100
101
102
100
101
Normalized frame length (Ln = Lfm /Rt )
50
1500
Throughput (%)
Figure 10.6 Throughput versus normalized frame length.

542
COGNITIVE RADIO
increases as Ln increases.The energy with L = 50 bytes becomes noticeably higher than the energy
for L > 50 bytes, due to the increased header overhead in each frame. For L > 50 bytes, the energy
and the throughput are relatively insensitive to the value of L and stay ﬂat within a constant range for
Ln < 0.1. Speciﬁcally, with Ln < 0.1, the energy stays between 2–2.5 µJ/bit and the throughput stays
high, between 80–90 % of Rt. The radio maintains an energy-efﬁcient link with a high application
throughput by adapting the frame length within the following constraint in a ﬂat fading channel
50 < L < 0.1 Rt
fm
= 0.1λRt
v
(10.1)
where λ is the carrier wavelength.
10.1.3
The adaptation algorithm
The adaptation algorithm uses the frequency tracking loop in the radio receiver to estimate the speed
v. Given the speed, the carrier frequency and the transmission rate, the upper bound on L is then
computed using Equation (10.1). If, in addition to a throughput constraint, the delay is constrained,
then the upper bound on L may be lower and can be obtained from the delay simulations as shown in
Figure 10.7. The value of the lower bound in Equation (10.1) is determined by simulation and depends
on the frame header size and the given throughput requirement (assumed to be eight bytes and 85 %
of Rt, respectively, in the above case). Within the bounds on L for minimizing energy under ﬂat
fading conditions, the actual value of L is chosen based on the optimum for adapting to the channel
interference, as illustrated in Figure 10.3 (energy vs. L). If the optimum L for adapting to channel
interference is greater than the upper bound in Equation (10.1), then L is set to this upper bound.
The issue of frame length and data rate adaptation in a cellular network will be discussed in more
detail in Chapter 15.
10.1.4
Energy-efﬁcient adaptive error control
The above results in frame length adaptation are for uncoded transmissions based on SACK. Addi-
tional beneﬁt is expected if FEC is introduced. The combination of FEC with automatic repeat request
(ARQ), is known as hybrid ARQ.
10−3
10−2
10−1
100
101
102
103
100
101
Normalized frame length (Ln = Lfm /Rt )
50
100
300
1500
• • •
• • •
Average delay per useful packet (ms)
Figure 10.7 Average delay per useful packet versus normalized frame length.

ENERGY-EFFICIENT COGNITIVE RADIO
543
0.7
0.75
0.8
0.85
0.9
0.95
1
0
1
0.5
2
1.5
3
2.5
3.5
n = 255
n = 511
n = 1023
n = 2047
Energy per bit (µJ/bit)
Code rate
Figure 10.8 Energy cost of Reed–Solomon coding for differing block size (n) and code
rates based on the StrongARM embedded processor [1] c⃝1999, IEEE.
10−6
10−5
10−4
10−3
10−2
35
50
5
20
No data loss
1%
packet loss
3%
packet loss
25%
packet loss
SACK+RS
SACK
Good state BER when not in a fade
Energy per useful bit (µJ/bit)
Figure 10.9 Speech transmission with ATM at 50 km/h. The carrier frequency is at 900
MHz, Rt = 625 kbit/s, ρ = −20 dB and BERBa = 0.5. The numbers next to
the curves represent the packet loss [1] c⃝1999, IEEE.
Traditionally, the focus has been on satisfying a given throughput and/or delay requirement. As
has already been pointed out, in portable multimedia devices, an additional requirement is to meet the
throughput and delay requirements with minimum battery energy for a given media type. Simulations
have been performed with RS block codes of rate 0.7 and the SACK retransmission protocol with a
link layer header of eight bytes. Figure 10.8 shows the energy cost for implementing the RS coding
on a StrongARM embedded microprocessor (http://www.develop.intel.com), which implements the
link layer control in adaptive radio.
Results for the Gilbert–Elliot channel model from Figure 10.4 are presented in Figures 10.9–10.11
with the parameters shown in the ﬁgures. Using this data, the adaptive algorithm chooses an error

544
COGNITIVE RADIO
4.5
5.5
6.5
7.5
8.5
9.5
Energy per useful bit(µJ/bit)
5
7
9
11
Average delay per useful packet (ms)
10−8
10−8
10−4
10−4
10−3
10−3
SACK+RS
SACK
Figure 10.10 Data transmission with ATM at 50 km/h. The carrier frequency is at 900
MHz, Rt = 625 kbit/s, ρ = −20 dB and BERB = 0.5[1] c⃝1999, IEEE.
7.5
8.5
9.5
10.5
11.5
Energy per useful bit (µJ/bit)
100
200
300
400
Average delay per useful packet (ms)
10−8
10−8
10−4
10−4
10−3
10−3
SACK+FEC
SACK
Figure 10.11 Data transmission with IP at 50 km/h. The carrier frequency is at 900 MHz,
Rt = 625 kbit/s, ρ = −20 dB and BERB = 0.5.
control scheme that minimizes batteryenergy for transmission over the wireless link, while trading
off QoS parameters of the link, such as throughput and delay over various channel conditions, trafﬁc
types and packet sizes. The simulations are performed for two packet lengths:
r 53 bytes ATM cell size packets;
r 1500 bytes Ethernet frame size IP packets.

ENERGY-EFFICIENT COGNITIVE RADIO
545
10.1.4.1
Error control for speech transmission
Figure 10.9 shows the effects of altering the Good state BER for real time data. Data is generated by
the source at 32 kbits/s and forwarded to the sender with a delay of less than 50 ms. A delay greater
than 50 ms is perceptually unacceptable for an interactive speech session and results in the packets
being dropped. Figure 10.9 shows only small ATM packets, since larger packets do not meet the delay
constraint. For a low Good state BER, no data is lost and both SACK and SACK with Reed–Solomon
perform comparably. For energy-efﬁcient speech transmission, the radio selects SACK error control
for low BER (below 10−3). For higher BER, the radio adapts the error control to include FEC.
10.1.4.2
Error control for data transmission
The plots in Figures 10.10 and 10.11 show the trend in energy consumption and delay as the channel
quality increases from a Good state BER of 10−3, as in packet cellular, to 10−8, as in WLAN
applications. In Figure 10.10, for small packets (ATM), hybrid FEC/ARQ consumes less battery
energy for the poor channel case (e.g. 10−3 BER). As the channel improves, the energy for SACK
without FEC becomes lower, but the delay can be higher (e.g. BER 10−4). This is because the radio
consumes the same amount of battery energy for the FEC, whereas the energy for SACK (without
FEC) decreases because fewer retransmissions are required. In data transmission, a higher delay can
be traded off for longer battery life. Therefore, for low BER (less than 10−3) the radio selects SACK
and for high BER ≥10−3 the hybrid FEC/SACK is selected.
10.1.4.3
IP packets
Figure 10.11 shows that FEC/ARQ reduces the average delay, but it also consumes more energy
compared to SACK. If the delay constraint is high enough, the radio minimizes battery energy by
selecting SACK. The reason that the hybrid FEC/ARQ does not help to reduce the battery energy is
because the ﬂat fading effects in the channel become more pronounced with larger packets. In the short
packet case, the channel noise effects are more dominant than fading and FEC provides improvements.
If the delay constraint is too tight, the radio selects the hybrid error control. In summary: for small
data packets, the radio switches between SACK and FEC/ARQ based on the BER; for large packets,
the radio adapts the error control based on the delay constraint.
10.1.5
Processing gain adaptation
In the presence of interference, adaptation of FEC and frame length can improve the system perfor-
mance when the BER does not degrade appreciably beyond 10−3. At this BER, the corresponding
Eb/N0 is 5–10 dB. In certain channel conditions, especially in shared bands, the interference level
can be signiﬁcantly higher, resulting in a signal to interference ratio (SIR) less than zero, implying
a higher interference level than in the transmitted signal. Spread spectrum techniques, as discussed
in Chapter 5, provide processing gain at the receiver, which can be used to provide protection in
channels that exhibit negative SIRs. Transceiver IC, based on the architecture from Figure 10.12, is
used to produce the experimental results presented in this section. An adaptation interface for this
radio has been built to enable the link layer to control the processing gain (PG) [1].
The radio has a ﬁxed chip rate of 2 Mchips/s and the processing gain can be adapted to 12, 15
and 21 dB for date rates of 128, 64 and 16 kbit/s, respectively. The power dissipation of this radio in
transmit, receive and sleep modes is 2.5, 0.6 and 0.2 W, respectively. This experiment was performed
indoors, and the radio had no RAKE equalization. The performance improvements are only due to
the processing gain.
The experimental results are shown in Figure 10.13, in which the measured application level
throughput (goodput) and energy consumption are plotted against the SIR experienced in a channel

546
COGNITIVE RADIO
PN
acquisition
loop
PN
generator
Clock
recovery
loop
Carrier
recovery
loop
TX
Decision
LPF
BPF
LPF
ADC
Frequency
synthesizer
VGA
PA
AGC
LNA
Power control
TX data
Carrier detect
Processing
gain
Code
select
Digital adaptive
direct sequence
spread spectrum
transceiver ASIC
Spread
data
Frequency
control
Sample rate > 2 × Processing gain × Bit rate
Resolution ≈Dynamic range of spurious interference level
Figure 10.12 Adaptive processing gain direct sequence spread spectrum radio [1] c⃝1999,
IEEE.
−15
−110
−5
0
5
100
Signal to interference ratio (dB)
User throughput (kbps)
0
20
40
60
80
PG = 21 dB
PG = 15 dB
PG = 12 dB
Figure 10.13 Energy consumption versus number of states in the MLSE estimated with a
3.3 V standard cell library in the 0.35 µm CMOS process. The operating data
rate is 1 Mbit/s.
with a narrowband interference. Curves for a processing gain of 12 dB are indicative of the perfor-
mance one expects with a commercial radio based on IEEE Standard 802.11, such as WLAN. At
this low processing gain, the throughput with commercial radios decreases as the SIR falls below −4
dB and the energy consumed per user bit sharply rises. By adapting the processing gain, the radio
minimizes the energy by switching to a higher processing gain.

ENERGY-EFFICIENT COGNITIVE RADIO
547
Table 10.2
SIR thresholds used for processing
gain adaptation
Threshold (dB)
Processing gain (dB)
SIR > −4
12
−4 > SIR > −6
15
−6 > SIR > −12
21
103
100
101
102
−5
0
−15
−10
Energy per useful bit (µJ/bit)
5
PG = 21 dB
PG = 15 dB
PG = 12 dB
Signal to interference ratio (dB)
Figure 10.14 Energy per useful bit.
10.1.5.1
Receiver algorithm
The radio measures the SIR from the receive signal and sets the processing gain based on the
thresholds in Table 10.2. When the SIR drops to −5 dB the radio adapts by changing the processing
gain from 12 to 15 dB, thereby decreasing the energy consumed by 86 % as shown in Figure 10.14.
In Figure 10.14, the achieved user throughput is 100 kbit/s for the lowest processing gain, and 9.6
kbit/s for the highest processing gain.
The tradeoff between data rate and processing gain is characteristic of spread spectrum, where the
product of processing gain and data rate remains a constant and equals the occupied RF bandwidth.
To achieve a throughput of 1 Mbit/s required for most multimedia applications, and still provide
a sufﬁciently high processing gain to adapt to a very low SIR value (e.g. −12 dB), a signiﬁcant
amount of bandwidth (i.e. hundreds of megahertz) is required. Since such a wide bandwidth is not
always available, a possible solution is to use non-contiguous bands and frequency hop (FH) across
these bands. Current research is aimed at developing such a solution using a multiband radio that
can achieve a tunable range from 25–2500 MHz. At a high data rate of 1 Mbit/s, the FH radio can
experience ISI due to the frequency selectivity of the channel as the symbol duration becomes less
than the delay spread of the channel. To combat that ISI, equalization in the physical layer can be
employed in conjunction with the adaptive link layer control to improve the link performance.
10.1.6
Trellis-based processing/adaptive maximum likelihood
sequence equalizer
At high data rates, the degradation due to ISI in a frequency selective channel cannot be mitigated
adequately by adapting the link layer alone. Equalization at the physical layer is required for the

548
COGNITIVE RADIO
RF
Packet
detector
Viterbi
detector
Channel estimator
timing recovery
Adaptive
coefficient
tracking
Reconstruction
filter
Frequency
estimator
AGC
z-D1
z-D2
VCO
Loop
filter
–
Analog
Digital
PLL
ACTL
CIR
εk
vk
vk + D2
φk
kvˆ
( )
k
f
delays D1 and D2 introduced by the packet detector and
trace-back operation in the Viterbi detector
Figure 10.15 Maximum likelihood sequence equalizer modem architecture.
t0,0
0
1
t1,1
Hidden Markov process
Observable outputs
Gmax
{ 0, 1, …, Gmax-1, Gmax+1 }
t0,1
t1,0
Figure 10.16 Two-state HMM channel model.
radio to adapt to frequency selective fading. A tradeoff is possible between the energy consumed by
equalization and the energy saved due to the corresponding increase in goodput.
In this section, a maximum likelihood sequence equalizer (MLSE) has been selected for the
adaptive radio because it has two well known advantages over other equalizer algorithms. It also can
be easily related to the other trellis-based algorithms presented so far in the book.
The energy consumption of the MLSE architecture shown in Figure 10.15 has been determined
for a low-power 3.3 V 0.35 µm CMOS technology.
10.1.7
Hidden Markov channel model
DTMC models, such as the Gilbert–Elliot model, are a special case of the more general hidden
Markov model (HMM) which is used in this section for performance evaluation. An HMM is a
doubly stochastic process with an underlying stochastic process that is not observable but hidden. By
simply observing the output sequence, the state that generated the output cannot be determined at any
given time. The HMM has been used to obtain extremely accurate models for the mobile channel.
The link performances over frequency selective channels are simulated using an HMM that is more
accurate than the two-state Gilbert model.
A two-state HMM, shown in Figure 10.16 is used and is trained to match the error gap distribution
in the error sequence, obtained through extensive simulation at the physical layer based on Jakes’s

ENERGY-EFFICIENT COGNITIVE RADIO
549
0
5
10
15
20
25
30
35
0.01
0.02
0
Number of states (M)
Energy per bit (µJ/bit)
0.03
0.04
0.05
0.06
Figure 10.17 Energy consumption versus number of states in the MLSE estimated with a
3.3 V standard library on 0.35 µm in the CMOS process. The operating data
rate is 1 Mbit/s.
model. In the error sequence, the position of an error event is marked with a ‘1’, while the position of
an error-free event is marked with a ‘0’. An error gap is deﬁned as the distance (number of positions)
between two consecutive 1s in the error sequence. The output of the HMM consists of error gap
values which can then be inverted to obtain the actual error sequence.
Figure 10.17 shows the energy cost for the MLSE with different numbers of states M in the Viterbi
decoder. The results can be easily extrapolated to any type of trellis-based algorithm.
r The carrier frequency is set at 2.4 GHz.
r The transmission rate is 1 Mbit/s.
r The typical urban (TU) channel model is used for the mobile frequency selective channel to
generate the error sequence for the hidden Markov model.
r The greedy data source is used with an eight-byte link layer header.
10.1.8
Link layer performance with inadequate equalization
Adequate equalization occurs when the number of states M satisﬁes
log2(M) + 1 = P + Lmod −1
(10.2)
where P is the number of channel coefﬁcients and Lmod is the memory of the modulation. In the
simulation, Gaussian minimum shift keying (GMSK) is used as the modulation with a BT = 0.3 that
results in Lmod = 2. As M increases, so does the energy consumption of the MLSE implementation.
M is selected to be smaller than required by Equation (10.2).
For the TU channel, P = 5, but M is set inadequately to 2, i.e. a two-state MLSE. The objective
of this simulation is to determine the tradeoff in the overall link energy, throughput and delay with a
lower complexity equalizer that requires less energy consumption. Figure 10.18 shows the simulation
results for frame length values of L = 50, 500 and 1500 bytes and speed values of v = 5 and 100
km/h. As expected, the performance degrades for the cases with larger frame lengths and higher
speeds.

550
COGNITIVE RADIO
10−3
10−2
10−1
100
101
102
100
101
Normalized frame length (Ln = Lfm /Rt )
(a)
Energy per useful bit (µJ/bit)
50
50
500
500
1500
1500
10−3
10−2
10−1
100
101
101
102
10−1
100
Normalized frame length (Ln = Lfm /Rt )
(b)
Throughput (%)
50
500
1500
50
500
1500
10−3
10−2
10−1
100
101
102
103
100
101
Normalized frame length ( Ln = Lfm /Rt )
(c)
Average delay per useful packet (ms)
50
500
1500
50
500
1500
Figure 10.18 Energy, throughput and delay versus frame length for two-state MLSE for the
mobile frequency selective TU channel.
denotes v = 5 km/h, and • denotes
v = 100 km/h. The annotation to the data points indicates the frame length in
bytes. SNR is 17 dB. The carrier frequency is 2.4 GHz. (a) Energy per useful
bit versus normalized frame length; (b) throughput versus normalized frame
length; (c) average delay per useful packet versus normalized frame length.

ENERGY-EFFICIENT COGNITIVE RADIO
551
If the equalizer removes most of the ISI, then the channel appears to the receiver like an AWGN
channel with some remaining level of burstiness due to mobility, similar to the behavior of a ﬂat fading
channel. To determine the effectiveness of the two-state equalizer, the results here are compared with
the results for adapting frame length in a ﬂat fading channel. As shown in Figure 10.18, the energy
is minimal with a frame length of 50 bytes. The value of the energy consumption, throughput and
delay are signiﬁcantly worse than that obtained in a ﬂat fading channel using the bounds on L as in
Equation (10.1).
For the two-state equalizer with L = 50 bytes and v = 5 km/h, a user throughput of 35 % is
achieved with delay of 70 ms, as compared to a user throughput of 73 % and a delay of 2.5 ms
achieved with an adaptive frame length for the ﬂat fading channel (Figures 10.6 and 10.7). The
energy required is 5 µJ/bit, 100 % higher than that in Figure 10.5. We can conclude that using an
equalizer that is smaller than required to satisfy Equation (10.2) does not provide an efﬁcient tradeoff
between equalizer energy consumption and transmit energy.
10.1.9
Link layer performance with adequate equalization
In this case, M is chosen to satisfy Equation (10.2), i.e. sufﬁcient equalization is provided for the TU
channel. To meet Equation (10.2), an MLSE with 32 states (M = 32) is used. The results are shown
in Figure 10.19.
Although the equalizer is more complex and consumes more energy, the overall system energy
reduces since retransmissions are reduced. Compared to the case with M = 2 in Figure 10.18,
r the energy consumption is reduced by 100 %;
r the energy can be minimized for the high speed case to 2.5 µJ/bit with L = 50 bytes, and to 2.1
µJ/bit for the low speed case with L = 500 bytes.
The energy, as well as the throughput and delay, now match those obtained by applying the
adaptive frame length in a ﬂat fading channel (Figures 10.6 and 10.7). We can now conclude that in
a mobile frequency selective channel, an energy-efﬁcient link requires an equalizer with an adequate
number of states, as determined by Equation (10.2).
For given system parameters, simulations can be performed to obtain results such as those in
Figure 10.19 to determine optimum frame sizes that minimize energy.
10.1.9.1
Implementation
The radio monitors the CIR to determine the type of fading. A single peak in the CIR indicates ﬂat
fading. On the other hand, the occurrence of several peaks indicates frequency selective fading. The
number of coefﬁcients P in the CIR is used to determine the number of states required in the MLSE,
using Equation (10.2) with Lmod = 2. The speed is estimated from the frequency tracking loop and
is used to determine the optimum frame length L from simulation results as indicated above. The
optimum frame length at different speeds can be intuitively explained by the limited ability of the
equalizer to track the rapidly varying received amplitude in each of the CIR coefﬁcients and the
Doppler shift that causes an offset in the carrier frequency.
With a large frame size at high speed, the equalizer fails to maintain adequate tracking performance
for the increased time duration of the given frame. At lower speed, the channel variation diminishes
and therefore the equalizer can maintain tracking of the channel for longer frame sizes.
10.1.9.2
Channel and frequency tracking performance
The ability of the MLSE to equalize ISI degrades if it does not track the fast amplitude variation and
a large Doppler shift in the channel. A conventional tracking subsystem has been implemented in the
MLSE as shown in Figure 10.15, and consists of a phase-locked loop (PLL) and an adaptive channel

552
COGNITIVE RADIO
10−3
10−2
10−1
100
101
2.0
Normalized frame length (Ln = Lfm /Rt )
(a)
Energy per useful bit (µJ/bit)
50
50
500
500
1500
1500
2.5
3.0
3.5
4.0
4.5
10−3
10−2
10−1
100
101
Normalized frame length ( Ln = Lfm /Rt )
(b)
Throughput (%)
50
500
1500
50
500
1500
95
55
65
75
85
45
Figure 10.19 Energy, throughput and delay versus frame length for the 32-state MLSE for
the mobile frequency selective TU channel. • denotes v = 5 km/h and
denotes v = 100 km/h. The annotation to the data points indicates the frame
length in bytes. SNR is 17 dB. The carrier frequency is 2.4 GHz. (a) Energy per
useful bit versus frame length; (b) throughput versus frame length; (c) average
delay per useful packet versus frame length.
tracking loop (ACTL). The PLL tracks the Doppler frequency and carrier offset in the down-converted
RF signal. The ACTL uses the least mean squared (LMS) algorithm to track the time variations in
the channel impulse response.
The tracking performance with the PLL and ACTL can be degraded due to the delays D1 and
D2 introduced by the packet detector and traceback operation in the Viterbi detector as discussed in
Chapter 6.

ENERGY-EFFICIENT COGNITIVE RADIO
553
10−3
10−2
10−1
100
101
102
103
100
101
Normalized frame length (Ln = Lfm /Rt )
(c)
Average delay per useful packet (ms)
50
500
1500
50
500
1500
Figure 10.19 (Cont.).
11
14
20
17
−5.0
− 4.5
−4.0
−3.5
−3.0
−2.5
−2.0
−1.5
SNR (dB)
log (BER)
V = 100 km/h
∆f = 1200 Hz
τd = 5
s
µ
psp
psp
no
no psp
psp
Figure 10.20 Performance of the 32-state MLSE at 100 km/h and with a 2.46 GHz RF
carrier. The packet length is 200 bytes. The transmission rate is 1 Mbit/s with
a delay spread (τd) of 5 µs, mobility of 100 km/h and a residual frequency
offset of 1200 Hz.
10.1.9.3
Per-survivor processing (PSP)
To maintain performance of the tracking loops, PSP can be implemented in the MLSE. Figure 10.20
shows the performance of the MLSE with, and without, PSP operating at
r 1 Mbit/s over a TU channel;
r a delay spread of 5 µs at 100 km/h;
r a carrier frequency offset of 1200 Hz.
Without the PSP, the BER increases by nearly two orders of magnitude at an SNR of 20 dB.

554
COGNITIVE RADIO
Compression and
Pa oad Control
Quality of Service
Man
r
Quality of Service
Me
urement
VC/Routing
Table
Connection
Manager
Error Control
and
Frame Length
Link
Controller
Modem
Controller
Channel
Model
Estimator
Processing Main
and
Equalizer
Coefficients
Channel
Estimator
Set QoS level
Set QoS level
Update QoS level
Update QoS level
Adaptive Link Control
Adaptive Physical Layer
Processing Gain
Spread
Code
CSI: SIR, CIR, fm
Reactive
application
Network
Adaptive
radio
Scalable Codec
Compression
radio
Compression and
payload control
Quality of Service
manager
Quality of Service
measurement
VC/Routing
table
Connection
manager
Error control
and
Frame length
Link
controller
Modem
controller
Channel
model
estimator
Processing gain
and
equalizer
coefficients
Channel
estimator
Adaptive link control
Adaptive physical layer
Processing gain
Spread
code
CSI: SIR, CIR, fm
Reactive
Network
Scalable codec
Compression
Figure 10.21 System architecture for maintaining QoS in mobile wireless multimedia net-
working.
10.1.9.4
System integration
The adaptive radio can be integrated in the system architecture of Figure 10.21. The architecture ties
the adaptive link layer and physical layer in the radio with the rest of the network protocol stack.
It is based on a multilevel QoS framework where the lower layers can adapt to channel variations
without continually requiring renegotiation with the application layer. At the top of the protocol stack
are reactive applications that specify their requirements to the QoS manager as a set of multiple
values corresponding to a set of allowable operating points with different degrees of acceptability.
The application adapts its behavior by reacting to events from a QoS manager indicating a change
in the level of QoS being provided by the lower layers. Each QoS level is deﬁned by the average
sustained throughput, delay and packet loss rate.
10.1.9.5
Adaptive steps
When the channel estimator indicates a degradation in QoS parameters, the link controller ﬁrst
attempts to maintain the QoS level by adapting the error control and frame length control. If the
interference levels are too high to be handled by the link layer, the processing gain is adapted by the
modem controller. If none of the adaptations are sufﬁcient to maintain the current QoS, the level of
service quality for one or more applications is reduced, and an event indicating this is passed up the
protocol stack. The application layer may respond by adjusting parameters such as the speech codec
compression ratio to be compatible with the drop in QoS. The reverse sequence of events takes place
when channel conditions improve. Similarly, the network layer itself may respond to events from the
link layer indicating changes in current QoS level by, for example, performing a connection route
optimization. These issues will be discussed later in Chapter 15.
The radio adaptation is based on the channel state information measured in the physical layer that
includes:
r SIR;
r the channel impulse response;
r the Doppler frequency.

ENERGY-EFFICIENT COGNITIVE RADIO
555
The SIR determines the interference level in the channel, while the CIR determines the type of fading
in the channel. The CIR is measured by a 48-tap complex matched ﬁlter (MF) in the adaptive equalizer
(Figure 10.15) that is matched to a training sequence inserted in the preamble of the packet.
The speed of the user is inferred from the Doppler frequency which is determined by the frequency
tracking loop in Figure 10.15. The deviation from the average value of the phase error (φk) is
proportional to the Doppler frequency. These three parameters allow the link controller to distinguish
between a degradation due to fading or interference and, if due to fading, the speed of the mobile.
This information enables the radio to appropriately adapt the frame length, error control, processing
gain and equalization for the given channel condition.
10.1.9.6
Self-describing packets
The changes in the frame size, error control and processing gain used in the payload of each frame must
be communicated by the sender node to enable the receiver to decode the packets. Communicating
these parameters can result in a high signaling overhead and defeat many of the gains achieved by
adaptive control. An alternative is to make each packet self-describing, such that no synchronization
between the send and receive nodes is needed.
The physical layer header is encoded consistently from packet to packet and includes the infor-
mation which tells the receiver how to decode the remainder of the packet. The physical layer header
can, in this way, be decoded rapidly and consistently in the radio hardware while using a strong code,
since it constitutes a relatively small amount of extremely important information. Even one bit error
means the entire packet must be discarded; therefore, it should be heavily protected. Figure 10.22
shows the structure of the physical layer header used by the radio. After a preamble needed to lock
onto the signal, the header bit map has single-bit ﬂags that indicate which of the remaining header
ﬁelds are actually present. In other words, all other ﬁelds are optional so that the overhead is kept to
a minimum.
The remaining ﬁelds are used for:
1. The physical layer destination and origin addresses;
2. A time stamp ﬁeld is inserted at the transmitter and used for synchronizing the MAC protocol;
3. The physical layer requires a number of parameters to successfully decode the incoming packet.
These are speciﬁed in the modem ﬁeld. For example, this ﬁeld contains the processing gain to
use for the body of the packet;
4. A service ﬁeld which speciﬁes the error control information for the receiving link layer to
decode the rest of the packet;
5. A bit to indicate whether this is a beacon transmission or not (as from a base station);
6. A byte count and CRC for the header.
Spreading
coefficients
Preamble
Header
bitmap
Addresses Time stamp
Modem
parameters
Service
field
Beacon
Byte
count
CRC
Initialization for
PN generators
Process
gain select
Frequency
hop
dwell time
Current
hop
index
Frequency
hop
pattern
Beacon
interval
Use GPS
for coarse
synchronization
Figure 10.22 Packet format for maintaining QoS in mobile wireless multimedia
networking.

556
COGNITIVE RADIO
10.2
A COGNITIVE RADIO ARCHITECTURE FOR LINEAR
MULTIUSER DETECTION
10.2.1
A uniﬁed architecture for linear multiuser detection
and dynamic reconﬁgurability
From Chapter 5, in a CDMA multiuser system, the output of the matched ﬁlter for the kth user can
be expressed as
yk = Akbk +
	
j̸=k
A jb jρ jk + nk
k = 1, . . . , K
(10.3)
The MF outputs for the users in the system in vector form become
y = RAb + n
(10.4)
10.2.1.1
Linear multiuser schemes
In general, a linear multiuser detector performs a linear transformation of the received vector y and
makes the decision for user k as
ˆbk = sgn(Ly)k
(10.5)
where L is the appropriate transformation. From Chapter 5 we already know that for the MF, L takes
the form
LMF = I
(10.6)
where I is the identity matrix. For a decorrelator (DC),
LDC = R−1
(10.7)
For an approximate decorrelator (AD)
LAD = I −δJ
(10.8)
where J is derived on the basis of the assumption that R is strongly diagonal as
(I −δJ)−1 = I −δJ + o(δ)
For the MMSE detector we have
LMMSE = (R + σ 2W−1)−1
(10.9)
where W = ATA.
10.2.1.2
‘Modiﬁed’ ﬁlter hk(t)
The DC can also be considered as a matched ﬁlter with impulse response
hk(t) =
K
	
j=1
R+
kjs j(t)
(10.10)
where R+kj denotes (R−1)kj The AD can be realized as
hk(t) = sk(t) −
	
j̸=k
ρ jks j(t)
(10.11)

A COGNITIVE RADIO ARCHITECTURE FOR LINEAR MULTIUSER DETECTION
557
The MMSE detector as
hk(t) =
K
	
j=1
(R + σ 2W−1)+
kjs j(t)
(10.12)
where (R + σ 2W−1)+kj again denotes [(R + σ 2W−1)−1]kj. For the MF,
hk(t) = sk(t)
(10.13)
Any of the linear multiuser detectors described above can be realized by appropriately choosing
the ﬁlter taps of the ‘modiﬁed’ MF, hk(t). This forms the basis of the software radio architecture for
linear multiuser detection.
10.2.1.3
Variable QoS
When the measure of quality is the BER achieved by the user, the relative performance of these
receivers (see Chapter 5) may be classiﬁed as
BERMF ≥BERAD ≥BERDC ≥BERMMSE
(10.14)
Thus, reconﬁguring the detectors among the MF and the above structures allows the option of a
variable QoS from moderate (for the MF) to very high (for the MMSE detector). As an example, a user
may switch to an MF conﬁguration when using voice trafﬁc, while the MMSE mode may be preferred
for data trafﬁc.We can also account for different data rates by deriving appropriate single-user linear
ﬁlters for the multirate schemes.
10.2.1.4
Cognitive radio architecture for linear multiuser detection
Figure 10.23 shows a possible generic software radio architecture for linear multiuser detection.The
architecture includes:
r channel processing (such as translation from IF to baseband);
r environment processing (e.g. estimation of signal and interference parameters and correlations);
r matched ﬁltering and information bit-stream processing (e.g. FEC or convolutional decoding, soft
decisions, etc.).
Control and
Offline estimation
Online
estimation
Reconfigurable
matched filter
Channelizer
Wideband
A/D
Info. bit-stream
processing
FPGA
DSP
Figure 10.23 Functional architecture of a cognitive radio for linear multiuser detection.

558
COGNITIVE RADIO
These functionalities are partitioned into two core technologies based on processing speed require-
ments. These two technologies are based on FPGA and DSP devices. The key idea behind the software
architecture is to reconﬁgure the MF dynamically according to the desired QoS (corresponding to
one of the appropriate linear detectors).
10.2.1.5
Logical partitioning of the architecture
Essentially, each user’s radio could possibly have only one variable ﬁlter-tap receiver implemented
using Xilinx FPGAs. All classes of the above receivers require two common generic operations:
r estimation of path delay of the users;
r the generation of PN sequences {sk(t)} of the users in the system.
The MF is probably the simplest in that, for any user k, it just uses the information from these two
generic operations in determining the timing offset of the PN sequence sk(t) for the speciﬁc user.
For the AD, the complexity is slightly higher than that of the MF in that the ‘modiﬁed’ matched
ﬁlter taps are adjusted according to the formulation given by Equation (10.10).
As seen in Figure 10.24, the additional functionality required here is the crosscorrelation values
{ρkj} and also the signature of sequences of all the users {sk(t)}.
The functional operations required for the DC are additionally
r the computation of the inverse matrix of crosscorrelations R−1;
r the column vector corresponding to the kth user, i.e. R+kj.
The MMSE receiver incurs additional complexity over the DC in that it also requires estimates of
the received signal powers of the users in the system (matrix W).
The issue of estimating the path delays or the received signal powers of the users in the system
should be included.
The software radio architecture does have the functionality required to do both the estimation
operations, similar to that used in conventional radio designs.The software radio architecture should
be versatile in that it can easily allow a variety of signal processing algorithms to be implemented for
accomplishing the required estimation.
Generation of
PN sequence
Generation of
PN sequence
Generation of
PN sequence
Estimation of
path delay
Estimation of
path delay
Estimation of
path delay
Estimation of
power
Estimation of
power
Estimation of
power
User 1
User 2
User K
• • •
User 1
User 2
User K
• • •
User 1
User 2
User K
• • •
Computation of
crosscorrelations
{ ρρρρ i j }
for i, j = 1, … K
Computation of
R -1 and R +
i j
Computation of
(R + W-1) -1
and
(R + W-1) +
i j
MF
ADC
Figure 10.24 Logical partitioning of functionality in a cognitive radio receiver for linear
multiuser detection [2] c⃝1999, IEEE.

A COGNITIVE RADIO ARCHITECTURE FOR LINEAR MULTIUSER DETECTION
559
10.2.1.6
Testbed example
In the testbed (Figure 10.25) described in [2], the core of the hardware is based around an Aptix
MP3 board with up to 12 FPGA components (up to 432 000 programmable gates) for sample
level processing tasks with rates of up to 30.0 MHz. Information rate tasks (Viterbi decoding,
deinterleaving, etc.) are performed by the VMEbus-based Pentak 4270 Quad ’C40 DSP Processor
board. As a baseband front end, the testbed has two sets of dual (I and Q) A/D converters for
input (Analog Devices AD 9762XR 12-bit, 41 MHz converters, and Pentak 6472 10-bit, 70 MHz
converters) and one set of D/A converters (Analog Devices AD 9042ST 12-bit, 100 MHz).
Analog Devices converters are connected to the FPGA board through the custom adapters. Pentak
converters are connected to the DSP via a multiband digital receiver (Pentak 4272) acting as a
channelizer in Figure 10.23. The channelizer performs:
r frequency down-conversion;
r low pass ﬁltering;
r decimation of the sampled baseband signal.
It is used for selection of the service bandwidth (i.e. the tuning band) from among those available
in the sampled signal. The multiband digital receiver used as a channelizer has two narrowband
receivers with a dynamic range of 1 kHz – 1 MHz, and one wideband receiver with dynamic range 2
MHz – 35 MHz.
It is capable of supporting a wide range of output sample rates.
A Sun workstation accesses the VMEbus through a Bit3 Sun-Sbus to VMEbus adapter and is used
as a primary data stream source as well as development host. Development tools are centered around
Signal Processing Worksystem (SPW).
SPW is a computer-aided design (CAD) tool that allows for the simulation and design of the
complex communication systems based on block diagrams. It has a rich library of common com-
munication blocks as well as facilities for creation of custom-coded blocks. Once entered, the block
diagram of the target system can be simulated by using SPW’s signal ﬂow simulator.
If these ﬂoating-point simulations are producing satisfactory results, the block diagram can be
partitioned into DSP and hardware parts. The part of the design that is targeted for DSP implementation
is prepared by SPW’s code generation system (CGS) (or MultiProx in case of partitioning into multiple
DSPs) and is directly downloadable into the Quad TMS320C40 ﬂoating-point DSP board.
SPW’s hardware design system (HDS) is used to model the behavior of a ﬁxed-point part of the
design. Again, SPW’s signal ﬂow simulator is used to verify the ﬁxed-point model functionality. After
the design is veriﬁed, the corresponding hardware description language (HDL) code is automatically
Analog Devices
DUAL A/D
(AD9042ST)
Analog Devices
DUAL D/A
(AD9762XR)
Pentak 6472
DUAL A/D
Aptix/Xilinx
FPGA
(XC4036)
Pentak 4241
Parallel I/O
Pentak 4270
Quad DSP
(TMS320C40)
Pentak 4272
Multiband
digital
receiver
RF conversion
Figure 10.25 Testbed block diagram.

560
COGNITIVE RADIO
generated. This code is then synthesized (and/or simulated by the event-driven HDL simulator like
Synopsys VSS) by an appropriate set of tools (e.g. Synopsys design compiler). The resulting design
is further processed by the Xilinx XACT tool in order to generate the FPGA chip layout and routing,
thereby producing the conﬁguration bit stream. This conﬁguration bit stream deﬁnes the combinatorial
circuitry, ﬂip-ﬂops, interconnect structure and the I/O buffers inside a particular FPGA device.
Aptix tools are used to interconnect the FPGAs, connect FPGAs and DSPs through a parallel I/O
board, and for routing of debugging signals to the control probes of the logic analyzer.
10.2.1.7
Partitioning of the architecture
The software radio architecture for linear multiuser detection is partitioned into two core technologies,
namely FPGA and DSP devices. This partitioning is usually driven by the required functionality of
the radio device and also the processing speed requirements.
The algorithmic complexity of the linear multiuser receivers increases with an increase in per-
formance. Speciﬁcally, the complexity of the signal processing algorithms corresponding to the MF,
AD, DC and MMSE receivers can be classiﬁed as
CMF < CAD < CDC < CMMSE
(10.15)
For a system with K users, processing gain N, and oversampling factor Os, the ﬂoating-point com-
plexity in terms of the number of multiply-accumulate (MAC) operations is
CMF = K(NOs + 1)
CAD = K(NOs + 1) + (K −1)NOs + (K −1) log2K
CDC = K(NOs + 1) + 2K(K −1)NOs + (2/3)K 3
CMMSE = K(NOs + 1) + 2K(K −1)NOs + 2K 2
+ (4/3)K 3 + C(amp)
(10.16)
C(amp) denotes the complexity due to amplitude estimation that is incurred in the MMSE receiver
(which is not explicitly considered here).
Figure 10.26 presents the number of MAC operations. We can evaluate the number of users that
can be supported as a function of achievable information data rates (for different receiver structures)
where the active constraint is a limitation in the complexity or the processing speed of the DSP device.
In Figure 10.27, a simple illustration is shown for a 50 MHz ﬂoating-point TMS320C40 DSP. In all
106
102
104
Number of  MAC operations
105
103
0
10
20
30
40
Number of users
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
Figure 10.26 Processing speed constraints: MAC operations versus number of users.

A COGNITIVE RADIO ARCHITECTURE FOR LINEAR MULTIUSER DETECTION
561
105
103
104
102
0
10
20
30
40
Number of users
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
101
Information data rate (bits/s)
Figure 10.27 Achievable rates versus number of users (One 50 MIPS DSP).
Online
estimation
PN
generators
Reconfigurable
block 1
Reconfigurable
block 2
Online
estimation
Control and
reconfiguration
management
Control and
reconfiguration
management
Correlator
M
I/Q Baseb and signals
Online estimates
PN Seq.
Qr
Qr
FPGAs
DSPs
Figure 10.28 Block diagram of cognitive radio implementation.
DSP implementations, serious constraints on the achievable data rates are imposed when the number
of users increases, especially when we operate with more complex receivers.
10.2.1.8
The cognitive radio architecture
Reconﬁgurable linear multiuser detection is implemented by partitioning the resources between
FPGAs and DSPs as shown in Figure 10.28. The FPGA segment of the architecture includes:
r the PN sequence generators;
r two reconﬁgurable blocks that determine the ﬁlter taps of the appropriate linear receivers;
r an online estimate module;
r the correlator.

562
COGNITIVE RADIO
The motivation for the particular selection of the constituents that comprise the FPGA segment is
that the functionality provided by each constituent here can be easily handled by the processing speeds
of the FPGA hardware. The two reconﬁgurable blocks contain the core of the sample level processing
for each of the multiuser detectors and are actually implemented in separate FPGA components to
facilitate on-the-ﬂy reconﬁgurability.
FPGA
This segment enables us to reconﬁgure one of the blocks while the other is running and therefore, by
oversizing the hardware, avoid loss of data during switchover to a different receiver structure. The
rest of the sample level processing logic (PN sequence generators, control multiplexer and correlator)
is implemented in a separate FPGA component since it does not require reprogrammability.
The online estimation block is used to perform timing estimates of the incoming signals, which
are then used, along with the reference PN sequences, to compute the appropriate ﬁlter taps. There is
also a provision for reﬁning the online estimates by using more sophisticated ofﬂine algorithms. An
FPGA component is used as an interface between the DSP segment and APTIX board.
DSP
The more algorithmically complex operations are partitioned into the DSP. This segment is imple-
mented using a quad TMS320C40 DSP board. The operations include:
r ofﬂine estimation procedures;
r information bit-stream processing;
r control and reconﬁguration management.
The ofﬂine estimation block includes:
r estimation of the received signals powers for the MMSE detector;
r computation of the inverse of the matrix of crosscorrelations (in the case of both the DC and the
MMSE detectors);
r it can also reﬁne estimates of the online estimation block in the FPGA segment.
The information bit-stream processing functions vary from error control techniques, such as FEC
or convolutional decoding, to soft decision decoding.
The control and reconﬁguration management block in the DSP segment of the architecture basi-
cally determines the variable QoS that can be achieved by dynamic reconﬁguration of the receiver
structures in the FPGA segment.
The reconﬁguration of the blocks in the FPGA segment is directly controlled by the control and
reconﬁguration management block. The subsequent switching amongst receivers is achieved by a
control multiplexer M (shown in Figure 10.28) that is also controlled by the control and reconﬁguration
management block. The DSP segment of the device acts to achieve the variable QoS requirements
of the speciﬁc type of service. Implicit in the control and reconﬁguration management block is also
the capability to interact with higher layer protocols/stacks to facilitate the QoS demand of a speciﬁc
data stream.
At the link layer, the actions of the DSP segment of the device also encompass environment
processing such as sensing interference levels.The DSP devices have access to the conﬁguration bit
streams for each of the receiver structures and can download the particular conﬁguration bit stream
as and when required.
Table 10.3 shows the relative hardware complexity of the different linear multiuser detection
schemes in terms of the required number of conﬁgurable logic blocks (CLBs). A CLB, in the case
of Xilinx 4000 series FPGA, comprises a pair of ﬂip-ﬂops and two independent (Boolean) logical
four-input function generators.
The complexity for each detector increases with both increasing number of users K and increasing
precision in quantization (Qr denotes the number of bits used in quantization). The MF complexity

A COGNITIVE RADIO ARCHITECTURE FOR LINEAR MULTIUSER DETECTION
563
Table 10.3
Complexity comparison of different detectors
(in number of CLBs)
Quantization
MF
AD
DC and MMSE
Qr = 4 bits
25
32 + 13K
37 + 3K(K −1)
Qr = 5 bits
27
40 + 14K
47 + (13/4)K(K −1)
Qr = 6 bits
29
57 + 15K
64 + (7/2)K(K −1)
remains invariant to the number of users in the system and depends only on the precision of quanti-
zation.
Even though the DC (and the MMSE) achieves better QoS, it comes at the expense of an exponential
increase in complexity (with an increasing number of users) over the AD detector. This directly maps to
an increase in processing power requirements of the FPGA segment of the software radio architecture.
This again motivates switching to lower order receivers when the QoS requirements are moderate.
The complex operations required to be performed in the DSP segment of the architecture involve
matrix inversion and ofﬂine estimation of amplitudes, etc.
10.2.2
Experimental results
First we consider ﬂoating-point implementations of the linear multiuser receivers. In all experiments,
as described in [2], the transmitter powers of the users are controlled perfectly so that they are all
received at the same power level. The ﬂoating-point results presented here agree very well with the
analytical results on the performance of these receivers from Chapter 5. To show the ﬂexibility of the
software radio, consider two sets of experiments.
10.2.2.1
Example 1
Fix the number of users in the system at K = 15.
In Figure 10.29, at low SNRs, the range of QoS achievable is quite limited. At higher SNRs, the
DC and MMSE provide a BER gain of up to three orders of magnitude compared to either the MF or
the AD. The AD is again slightly better than the MF for the set of operating points considered here.
For the case when N = 128, it is seen that the dynamic range of QoS achievable is greater among
the detectors at high SNRs. The AD provides up to an order of magnitude better performance than
the MF.
10.2.2.2
Example 2: QoS achieved for different numbers of users
When the number of users in the system increases, the users can still operate at the same SNR, but
can switch to a higher complexity detector to maintain the same QoS.
As an example, it is seen in Figure 10.30 that when N = 64, if users in a system desire a BER of
≈10−3, they can operate on
r an MF receiver (up to ﬁve users);
r an AD receiver (up to ten users);
r the DC receiver (up to 30 users)
without changing their received power level.
If some of the users require more stringent BERs, such as ≈10−5, they could operate entirely on
a DC realization of the ‘modiﬁed’ MF.

564
COGNITIVE RADIO
0
2
4
6
8
10
100
10−1
10− 2
10−3
10−4
10−5
10−6
SN
(a)
R (dB)
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
Pb
0
2
4
6
8
10
100
10−1
10−2
10−3
10−4
10−5
10−6
SN
(b)
R (dB)
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
Pb
Figure 10.29 (a) Performance curves with 15 users and N = 64; (b) performance curves
with 15 users and N = 128.
When the processing gain is N = 128, it is seen that there is a greater range in achievable capacity
by switching to the DC and MMSE receivers.
10.2.3
The effects of quantization
Consider ﬁxed-point operations using two-, three-, and four-bit quantization. The experimental results
for the MF are shown in Figure 10.31, and for the approximate DC in Figure 10.32. All the detectors

A COGNITIVE RADIO ARCHITECTURE FOR LINEAR MULTIUSER DETECTION
565
5
10
15
25
30
40
100
10−1
10−2
10−3
10−4
10−5
10−6
Number of users
(a)
(b)
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
20
35
Pb
5
10
15
25
30
40
100
10−1
10−2
10−3
10−4
10−5
10−6
Number of users 
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
20
35
Pb
Figure 10.30 Performance curves with SNR = 10 dB, N = 64; (b) performance curves
with SNR = 10 dB, N = 128.
experience a degradation in performance, with the MF being the least sensitive and the DC being the
most sensitive to quantization effects. The encouraging note is that the use of even a six-bit precision
quantizer seems to pull performance close to that of the ﬂoating-point reference results.
10.2.4
The effect on the ‘near–far’ resistance
Figure 10.33 shows the average BER achieved by the MF, AD and DC receivers for the case of
four-bit quantization as a function of interference powers. The desired user’s power is ﬁxed, while the

566
COGNITIVE RADIO
5
10
15
25
30
40
100
10−1
10−2
Number of users
Average probability of error
2-bit
3-bit
4-bit
FP
2-bit
3-bit
4-bit
FP
20
35
MF
Figure 10.31 Performance curves for MF with SNR = 5 dB, N = 64, Os = 4.
5
10
15
25
30
40
100
10−1
10−2
Number of users
Average probability of error
20
35
2-bit
3-bit
4-bit
5-bit
FP
Approx. DC
Figure 10.32 Performance curves for AD with SNR = 5 dB, N = 64, Os = 4.
interfering powers are increased. The MF and AD are not near–far resistant, and show degradations
in performance as the interfering powers increase. The AD shows a more graceful degradation in
performance relative to the matched ﬁlter. The DC, which is theoretically near–far resistant, however,
fails to maintain this property in the presence of quantization effects. However, the BER performance
is still superior to the other two detectors. More details on practical solutions can be found in [1–64].

RECONFIGURABLE ASIC ARCHITECTURE
567
0
2
4
6
8
10
100
10−1
10−2
Pk / P1
Pb
Matched Filter
Approx. Decorrelator
Decorrelator
MMSE Detect.
Figure 10.33 Performance curves in the presence of the near–far effect with SNR = 5 dB,
N = 64, Os = 4, K = 10, Qr = 5.
10.3
RECONFIGURABLE ASIC ARCHITECTURE
So far in this chapter we have discussed adaptive and reconﬁgurable schemes used for improving
the system performance or reducing energy consumption. In this section, we extend this topic to
include reconﬁguration from one multiple access technology to another, mainly TDMA, OFDM and
CDMA options. There are a number of different solutions to this problem [1–61] c⃝1999, IEEE. In
this section we discuss the case where the reconﬁguration is performed on the level of Application
Speciﬁc Integrated Circuit (ASIC) implementation. In particular, we will have a closer look into an
architecture that can be used to realize any one of several functional blocks needed for the physical
layer implementation of data communication systems operating at symbol rates in excess of 125
Msymbols/s.
Multiple instances of a chip based on this architecture, each operating in a different mode, can be
used to realize the entire physical layer of high-speed data communication systems based on different
multiple access schemes. The presentation in this section is based on [950].
The architecture features the following modes (functions):
r real and complex FIR/IIR ﬁltering;
r least mean square (LMS)-based adaptive ﬁltering;
r discrete Fourier transforms (DFT); and
r direct digital frequency synthesis (DDFS) at up to 125 Msamples/s.
All of the modes are mapped onto regular data paths with minimal conﬁguration logic and routing.
Multiple chips operating in the same mode can be cascaded to allow for larger blocks.
Baseband signal processing requirements are measured in the units gigaoperations per second
(GOPS), and are beyond the capabilities of present day DSP solutions (e.g. the TI TMS320 family
[66] or the Motorola 56000 family). Designers of such systems must incur the high cost and extended
development time associated with custom ASIC solutions, even at the prototype phase of their work.

568
COGNITIVE RADIO
Table 10.4
ASIC, DSP, hybrid and ﬂexible ASIC advantages and disadvantages
Advantages
Disadvantages
ASIC
Low power
High performance
Inﬂexible
Expensive
Small area
Long TTM
High skill level
DSP
Flexible
Late changes possible
Large area
Low performance
Quick TTM
Medium skill level
High power
Hybrid
Medium
Some ﬂexibility
Inﬂexible
Large area
ASIC + DSP
TTM
Long TTM
High power
Expensive
Low performance
Flexible ASIC
Low power
Medium area
High skill
New paradigm
Flexible
High performance
level
TTM – time to market
Traditionally, the designers have had to settle for the usual ASIC versus DSP tradeoff. An ASIC
provides low power and high performance, as shown in Table 10.4, but it is inﬂexible to change
and takes considerable engineering time to build. The DSP approach provides design ﬂexibility and
short time to market, but it is power hungry and incapable of satisfying the increasing computational
demands of high-speed communication systems. The norm has been to take the hybrid approach,
which is to utilize ASIC blocks to handle computations that are beyond the capabilities of a DSP, and
DSP code for ﬂexibility and time to market. This approach was demonstrated in the previous sections
of this chapter. However, such a hybrid quite often leads to a system that processes the disadvantages
of both the ASIC and the DSP.
One approach that overcomes this dilemma is to develop highly ﬂexible VLSI data paths that
are speciﬁcally designed and optimized for a single class of functions or tasks [65]. Such a class of
circuits could be thought of as ASIC/FPGA hybrids, and they will be referred to as ASIC/FPGA.
They would combine highly optimized processing units with programmable interconnects which can
be changed in real time. However, unlike traditional FPGAs, the minimal functional block is not
general purpose and the routing options are not global, rather, they are local and optimized for the set
of applications envisioned for the architecture. Such a circuit is also fundamentally different from the
minimally programmable arrays of custom computing elements used to solve very speciﬁc problems
[67, 68]. The result is a highly optimized yet programmable VLSI circuit that can easily compete
with ASICs in terms of performance, but at the same time provides a high degree of ﬂexibility.
Another attempt to combine high speed with ﬂexibility, generally known as reconﬁgurable com-
puting (RC), has recently seen active development [67, 68]. Most reported RC implementations
attempt to integrate an FPGA-type programmable block with a general purpose microprocessor [69]
on the same die [70] or at the board level [954]. The programmable block is then conﬁgured to
improve computational efﬁciency of the microprocessor. Thus, RC implementations can be thought
of as a DSP/FPGA hybrid, while the example architecture is an ASIC/FPGA hybrid.
The ﬁrst approach has the advantage of being maximally ﬂexible, but it cannot achieve the very
high speeds required for the target application of the example architecture, since it offers no speed
advantages over a regular FPGA.
Other efforts are directed at making FPGAs faster at the expense of decreased ﬂexibility, and could
some day make the ASIC/FPGA tradeoff unnecessary [71]. A design has been reported that uses a
high-speed reconﬁgurable ASIC data path that is quite similar to the one discussed in this section but
is limited to different versions of the same algorithm [71].
Finally, a major research effort has resulted in a chip that attempts a three-way hybrid (DSP/FPGA/
ASIC), but stops short of implementing sufﬁcient computational power for the applications envisioned
for the example architecture [72].

RECONFIGURABLE ASIC ARCHITECTURE
569
Table 10.5
Modes of operation
Mode
Parameters
ID
Real FIR
Max. number of taps = 64
RFIR
Dual real FIR
Max. number of taps = 32
R2FIR
Complex FIR
Max. number of taps = 16
CFIR
Real IIR
Max. number of taps = 64
RIIR
Adaptive FIR
Max. number of taps = 8
AFIR
Digital frequency synthesis
fmax. = 60 MHz; fmin = 4 kHz;
DDFS
Df = 2 Hz; SFDR = 72 dB
Discrete Fourier transformation
Max. block size = 32
GFFT
Min. block size = 4
S/P
IFFT
P/S
Fbaud=
125Msps
DDFS
FFT
8 GOPS
DDFS
1 GOPS
Out
S/P
IFFT
P/S
F baud=
125Msps
DDFS
DDFS
Out
Figure 10.34 Block diagram of an OFDM transmitter.
DDFS
Fs=
125Msps
Shaping
Filter
Shaping
Filter
Adaptive
Equalizer
Out
Out
Out
Out
DDFS
1 GOPS
R2FIR
8 GOPS
AFIR
8 GOPS
DDFS
Fs=
125Msps
Shaping
filter
Shaping
filter
Adaptive
equalizer
Out
Out
Out
Out
DDFS
1 GOPS
R2FIR
8 GOPS
AFIR
8 GOPS
Figure 10.35 Block diagram of a QAM receiver.
At this time, no reported design has the combination of high speed, low power and ﬂexibility of the
example architecture. This example is a highly versatile VLSI architecture targeted at the high-speed
data communications market. The architecture is highly regular and operates at data rates of up to
125 Msamples/s. Most importantly, it can be reconﬁgured in different modes in order to realize many
of the functional blocks required in the transmitters and receivers of high-speed data communication
systems. All modes utilize the same I/O pins and have been mapped onto a common, highly regular,
data path with minimal control and conﬁguration circuitry. A summary of the modes supported by
the example architecture is provided in Table 10.5.
10.3.1
Motivation and present art
Figures 10.34 and 10.35 illustrate how multiple instances of a chip, based on the example architecture,
can be used to realize different blocks within an OFDM transmitter and a QAM receiver. Each of the
shaded blocks in these ﬁgures represents a single instance of the chip under a different conﬁguration.

570
COGNITIVE RADIO
A chip based on the example architecture is assigned the acronym RADComm, for Reconﬁgurable
ASIC for Data Communications.
The computational requirements are annotated in gigaoperations per second (GOPS, where an
operation is deﬁned as a single real multiplication) for a system operating at the maximum data rate.
10.3.2
Alternative implementations
The need for a high-performance ﬂexible architecture becomes obvious when the limitations of the
classical FPGA and DSP solutions are considered. The RC designs discussed above cannot implement
all the desired features at the required data rates, and thus will not be used in this comparison. Let us
compare the example architecture to the standard FPGA and DSP solutions using three basic metrics,
namely, required sources, power consumption and ease of implementation.
The example architecture is synthezised onto a 0.25 mm/2.5 V CMOS technology, and is compared
to the present state-of-the-art FPGA and DSP solutions available from leading manufacturers [65].
The FPGA ﬁeld is represented by the largest and most advanced chip from the Xilinx Virtex series,
XVC1000. The XVC1000 [73] features over one million gates partitioned into 8464 logic blocks
and is manufactured in 0.22 mm/2.5 V technology [74]. DSPs are represented by the top-of-the-line
processor from TI, TMS320C6201B. This processor operates at up to 233 MHz and is based on a
0.18 mm/1.8 V technology [75].
The example architecture is very ﬂexible and easily scalable. For the purposes of illustration, we
will assume an implementation with 64 computational elements (deﬁned subsequently) operating on
16-bit data and capable of realizing the features in Table 10.5 at a rate of 125 Ms/s. Based on results
obtained from the synthesis of the VHDL code, this implementation requires 70 kgates, occupies an
area of just 4 mm2, and consumes approximately 1.6 W power. We will make comparisons on two
representative modes of operation: a 16-tap complex FIR (CFIR) and a 16-point DFT (GFFT) [76].
The example architecture is ideally suited for implementing a complex FIR ﬁlter and is less suitable
for computing the DFT. It will be shown that the example architecture is superior to the FPGA and
the DSP solutions for both of these modes.
10.3.3
Example architecture versus an FPGA
The CFIR mode utilizes 100 % of the computational resources in the example architecture. Over 90 %
of the computational core is taken up by fast 16 × 16 bit multipliers, making the size and performance
of a multiplier a critical parameter. The fastest 16 × 16 multiplier that can be implemented in an
XCV1000 operates at 59 MHz and requires 96 logic blocks [77]. Thus, the desired data rates simply
cannot be achieved using an FPGA (pipelining will not be considered since it would also increase
RADComm’s performance).
Let us decrease the requirements in order to compare power consumption and implementation
complexity.
A fully utilized XCV1000 can just implement 64 multipliers, leaving no room for additional logic.
Thus, two FPGAs would be needed to realize a 16-tap complex ﬁlter operating at 59 MHz. This
greatly complicates the design for two reasons:
1. A single chip solution becomes a board level problem.
2. Complicated partitioning of logic elements is needed, with special attention paid to delays
introduced by inter-chip connections.
A ﬁrst estimate based on the number of logic blocks required to implement the needed functionality,
gives a power dissipation of 6.4 W when operating at 59 Ms/s (13.5 W at 125 Ms/s). The development
time required for an FPGA design of this scope is considerably longer than the time required
to conﬁgure and use a chip based on the example architecture. Moreover, a chip based on this
architecture can be switched to a different mode in just a few clock cycles, whereas an FPGA of this
size takes a long time to reconﬁgure (over 750 kcycles, or 15 ms).

RECONFIGURABLE ASIC ARCHITECTURE
571
RADComm FPGA
DSP
0
20
40
60
80
100
120
RADComm FPGA
DSP
RADComm FPGA
DSP
0
5
10
15
20
25
30
Performance (Msps)
Power consumption (W)
0
5
10
15
Chips required
RADComm FPGA
DSP
0
20
40
60
80
100
120
RADComm FPGA
DSP
RADComm FPGA
DSP
0
5
10
15
20
25
30
Performance (Msps)
0
5
10
15
Figure 10.36 RADComm versus FPGA and DSP for complex ﬁltering [65] c⃝2000, IEEE.
Table 10.6
RADComm, FPGA and DSP for complex ﬁltering
[65] c⃝2000, IEEE
Simple to use
Single chip
Fast reconﬁguration
RADComm
•
•
•
FPGA
DSP
•
•
10.3.4
DSP against the example architecture
This comparison is not as straightforward as the comparison to an FPGA. The TMS320C6201B
operates at a high frequency of 233 MHz but can only perform two multiplications per cycle and
incurs delay in memory access. TI benchmarks indicate that the DSP requires 2N cycles per symbol for
an N-tap complex FIR ﬁlter [76]. Thus, the TMS320C6201B could only process 7.3 Ms/s for a 16-tap
complex ﬁlter. Again, the desired data rates are considerably above those achievable. Indeed, it would
take 17 of these processors to provide the needed computational resources. One TMS320C6201B
consumes over 1.9 W when operating at 233 MHz [20]. Thus, a total of 32 W would be used for
ﬁltering at the desired data rate. Clearly, a board full of these very expensive and power-hungry chips
is not an acceptable solution. The advantages of the example architecture operating in the CFI mode
over the existing solutions are summarized in Figure 10.36 and Table 10.6.
10.3.5
Computation of a complex 16-point DFT – the Goertzel FFT mode
The DFT can be computed using a very efﬁcient radix-4 FFT algorithm. This algorithm does not map
well onto the example computational core and is not used in this architecture. No such constraints exist
for an FPGA or a DSP, and these solutions have a potential advantage over the example architecture.
The DFT operating at the desired data rate uses 1386 logic blocks (16 %) in an XCV1000, and
consumes 3.3 W power. The TMS320C6201B DSP requires ten cycles per symbol to compute 16-
point FFTs, and could only process the input at up to 23 Ms/s, requiring ﬁve processors to achieve the
desired data rate and consuming 9.5 W power. Despite using a less efﬁcient algorithm, the example
architecture operating in the GFFT mode has signiﬁcant advantages over the existing solutions, as
summarized in Figure 10.37 and Table 10.7.
The main challenge in designing such a highly versatile architecture, capable of supporting high
symbol rates (over 125 Msymbols/s), is to identify suitable realizations of each function (mode of
operation) such that all functions could be mapped onto a computational fabric with a minimal
amount of routing and control logic. Indeed, chips exits that implement one or two of the features in

572
COGNITIVE RADIO
RADComm FPGA
DSP
0
20
40
60
80
100
120
RADComm FPGA
DSP
RADComm FPGA
DSP
0
2
4
6
8
10
Performance (Msps)
Power consumption (W)
0
1
2
Chips required
3
4
5
RADComm FPGA
DSP
0
20
40
60
80
100
120
RADComm FPGA
DSP
RADComm FPGA
DSP
0
2
4
6
8
10
Performance (Msps)
0
1
2
Chips required
3
4
5
Figure 10.37 RADComm versus FPGA and DSP for DFT computation c⃝2000, IEEE.
Table 10.7
RADComm, FPGA and DSP for DFT computation [65] c⃝2000, IEEE
Simple to use
Single chip
Fast reconﬁguration
RADComm
•
•
•
FPGA
•
DSP
•
•
Mi1
Mi2
Ci1
Ci2
Ai1
Ai2
Mult
Mux
Coef
Mux
Adder
Mux
Multiplier
Coef
Register
Adder
Register
Adder
Ao
Co
Aro
W
Clk
RClkMode
Mi1
Mi2
Ci1
Ci2
Ai1
Ai2
Mult
Mux
Coef
Mux
Adder
Mux
Multiplier
Coef
Register
Adder
Register
Adder
Ao
Co
Aro
W
Clk
RClkMode
Figure 10.38 Computational unit (TAP) [68] c⃝2000, IEEE.
Table 10.5 (e.g. [78]), but no existing architecture can implement all of them at high sampling rates.
Identiﬁcation of such an architecture together with the selection of the algorithms to implement each
function will be presented hereafter.
At ﬁrst sight, the architectures’ modes of operation do not reveal a great deal of similarity between
them. For example, the conventional architecture for DFT [79] is quite different from adaptive ﬁlters
using the LMS algorithm [80], which in turn have little in common with architectures used for the
implementation of direct digital frequency synthesizers [81–83]. The main reason for these differences
is the optimization of each architecture for the implementation of a single function. The ﬁrst task is
iteratively to consider various implementations for each mode to identify those that have the greatest
computational overlap with all other modes. Once the implementations have been selected, we can
deﬁne a single computational element that forms the least common denominator for all functions
listed in Table 10.5. This rather simple computational unit, hereafter referred to as a tap, is shown
in Figure 10.38. Having identiﬁed the tap, a computational core is created by grouping a number of

RECONFIGURABLE ASIC ARCHITECTURE
573
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
yR
xR
yI
yR
yI
xI
xI
xR
xR
xI
xI
xR
xR
xI
xI
xI
xI
xR
xR
RR
II
RI
IR
xI
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
tap
yR
xR
yI
yR
yI
xI
xI
xR
xR
xI
xI
xR
xR
xI
xI
xI
xI
xR
xR
RR
II
RI
IR
xI
Figure 10.39 Computational core.
0
x(n)
C3
C 2
C 1
C 0
y(n)
0
Figure 10.40 Transposed form FIR (N = 4).
CN-1
CN-2
C0
y(n)
Data
x(n)
Coef
CN-1
CN-2
C0
Figure 10.41 Mapping of the transposed form FIR.
taps in an array, as shown in Figure 10.39. The core consists of four parallel rows (labeled RR, II, IR,
RI) with N(N = 16 for this implementation) taps each, and ﬁxed inter-tap routing. Reconﬁguration
of the chip is accomplished by proper utilization of the three multiplexers within each tap (Figure
10.38).
Each tap is pipelined at its output, and the critical path in any one of the operating modes is
never greater than the delay through a multiplier plus two adders, a register and a multiplexer. When
synthesized in 0.25 mm CMOS technology with a 16-bit databus, the critical path delay is under 7 ns,
well below what is needed for operation at 125 MHz. Almost all of the ﬁxed routing is local – taps
connect only to their four immediate neighbors. This allows for a very compact layout, low routing
area overhead and reduced capacitive loading. This, in turn, translates into higher clock frequencies.
10.3.6
Fixed coefﬁcient ﬁlters
The transfer function of an FIR ﬁlter
y(n) =
N−1
	
k=0
x(n −k)Ck
can be implemented in either direct or transposed forms [964]. The transposed form implementation,
shown in Figure 10.40, allows the critical path to be reduced to a single ‘multiply/add,’ and is a
natural choice for the high-speed operations envisioned for this architecture. The transposed form
FIR ﬁlter structure can be mapped onto the example core directly, as shown in Figure 10.41. For all
ﬁxed coefﬁcient ﬁlters (Table 10.5), the coefﬁcients are shifted in serially from an external source

574
COGNITIVE RADIO
FIR
Data
x(n)
y (n)
FIR
Figure 10.42 Realization of a real IIR ﬁlter.
during the chip startup sequence. If a ﬁlter requires more taps than are available in a single chip, an
unlimited number of chips can be cascaded.
10.3.7
Real FIR/correlator
The architecture can be conﬁgured as a single 64-tap structure (RFIR) by routing the output of each
row to the input of the row below (e.g. output of row RR to input of row II, Figure 10.39). If a lower
ﬁlter order is acceptable, a single chip based on the example architecture can be conﬁgured to process
two data streams (in-phase and quadrature) simultaneously (R2FIR), with 32 taps each. In this mode,
one ﬁlter is realized using rows RR and II, while the second is realized using rows RI and IR. A single
16-tap complex FIR ﬁlter can be implemented by using the chip in the CFIR mode.
Since ﬁltering is a linear operation, the ﬁlter operating on complex values can be decomposed into
four parallel real-valued ﬁlters, with the ﬁnal output obtained by combining the four outputs
xc = (xRcR −xIcI) + i(xRcI + xIcR)
where x is the input and c is the coefﬁcient vector, see Figure 10.39). A pair of adders is used to
combine the outputs of rows (RR, II) and (RI, IR).
10.3.8
Real IIR/correlator
The example architecture can also be conﬁgured to operate as a single 64-tap, real-valued inﬁnite
impulse response ﬁlter (RIIR). This conﬁguration is almost identical to that of the RFIR mode
described above. To realize an IIR ﬁlter, we simply feedback the output of the FIR ﬁlter to an
additional adder at the input, as shown in Figure 10.42.
10.3.9
Cascading ﬁxed coefﬁcient ﬁlters
An unlimited number of chips based on the example architecture can be cascaded to achieve ﬁlters
with a larger number of taps. The cascading is accomplished by routing the outputs of each chip to
the X0 inputs of the next chip, as shown in Figure 10.43 for the RFIR and R2FIR modes (cascading
routing for the CFIR and IIR modes is very similar). All of the chips load the coefﬁcients from the
same bus, requiring only one external source (ROM) for the entire ﬁlter. Each chip uses its sequential
position in the cascade to determine the starting and ending times for shifting in the coefﬁcients. The
unused inputs on all chips are set to ‘0.’
10.3.10
Adaptive ﬁltering
The adaptive ﬁltering mode can operate on both real and complex data. For complex operations,
the ﬁlter coefﬁcient adaptation is based on the popular LMS algorithm [5], summarized in Figure
10.44. The adaptive ﬁlter consists of two distinct parts – the ﬁltering circuit, Equation (10.17), and
the coefﬁcient update circuit, Equation (10.18). In the example architecture, this functionality is
implemented by allocating half of the taps to the update circuit, and the rest to the ﬁlter circuit. From

RECONFIGURABLE ASIC ARCHITECTURE
575
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
CHIP
y(n)
x(n)
0
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
CHIP
y2(n)
x1(n)
0
0
y1(n)
x2(n)
(b)
(a)
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
CHIP
0
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
CHIP
RR Row
II Row
RI Row
IR Row
0
0
2(n)
Figure 10.43 Cascading for (a) RFIR; and (b) R2FIR. Unused I/Os are not shown.
Transversal filter
Adaptive coefficient
update mechanism
x(n)
d(n)
e(n)
y(n)
+
-
Transversal filter
Adaptive coefficient
update mechanism
+
-
Figure 10.44 The LMS adaptive algorithm.
Equation (10.18) we observe that µe(n) is a term common to all of the new coefﬁcients.
y(n) =
N
	
j=1
C jx(n −j)
(10.17)
C j(n + 1) = C j(n) + µx*(n −j)e(n)
(10.18)
For this reason, in Figure 10.45, µe(n) is fed to all the update taps. The x*(n −j) values are
obtained by shifting the values on x(n) into the coefﬁcient registers. At time n, the jth tap will have
x(n −j) stored in the coefﬁcient register. The complex conjugate is obtained by multiplying µe(n)
by −1 in the RI row. The new coefﬁcient value, C j(n), is obtained by feeding the output of the II row
to the adder input of the RR row (dashed line). The ﬁltering part of the circuit is identical to the CFIR
mode discussed above.

576
COGNITIVE RADIO
x(
x(
xI(n)
xR(n)
xR(n)
xI(n)
)1
(
1
+
+
n
C
R
j
)1
( +
n
C
Rj
Filter
Update
Tap #
1
2
N−1
N
)
(n
eI
µ
)
(n
C
Rj
)
(n
eR
µ
coef
reg.
yR(n)
)1
(
1
+
+
n
C
R
j
)1
( +
n
C
Rj
1
2
N
N
C
Rj
R
coef
reg.
n−1)
n−1)
Figure 10.45 Mapping of the adaptive ﬁlter (real part only).
Corr.
+
Reg
N-2 Precomputed
Fine frequency
resolution stage
Feedback stage
Cos
Sin
M-bit
Addacc
W[1…N-2]
W[N-1…N-2+M]
0
K
Corr.
+
Reg
N-2 Preco
stages
Cos
Sin
M-bit
Addacc
W[1…N-2]
0
K
Figure 10.46 DDFS using modiﬁed CORDIC.
10.3.11
Direct digital frequency synthesis
There exist a number of different methods for digital generation of a sinusoid of variable frequency.
Most DDFS designs used today store precomputed samples of a sinusoid in a ROM lookup table and
output these samples at different rates [10]. This method requires a large ROM to achieve acceptable
spectral purity and does not map well on any ﬂexible computational core. An alternative method for
generation of a sinusoid is based on trigonometric deﬁnitions and properties of the sine and cosine
functions. This method, known as coordinate rotation (CORDIC) [81–83] (see Figure 10.46), requires
very few constant coefﬁcients and is more suitable for implementation on a ﬂexible ASIC architecture
such as the one used in this example.

RECONFIGURABLE ASIC ARCHITECTURE
577
10.3.12
CORDIC algorithm [83]
Signal e jωt at sampling instants t = nTs can be represented as e jω(n−1)Tse jωTs. So, to synthesize a signal
of frequency ω with sampling rate 1/Ts, each previous sample should be multiplied by e jωTs(rotated
for phase, the ωTs). In this case, the sine and cosine of an angle are calculated using a cascade of N
‘subrotation’ stages. The kth stage rotates the input complex number, considered as a two-element
vector (xk, yk), by ±δ/2k(δ = π/2) radians depending on the kth bit of the phase control word (W)
[see Equation (10.19)]. By changing W, we can rotate an initial vector by an angle in the range
[0 · · · π −δ/2N+1] in increments of δ/2N radians.
(xk, yk) =



xk−1 −Tk yk−1, yk−1 + Tkxk−1
when W[k] = 1
xk−1 −Tk yk−1, yk−1 −Tkxk−1
when W[k] = 0
(10.19)
where Tk = tan( δ
2k ).
The standard CORDIC algorithm suffers from two major problems, namely, low frequency resolu-
tion and high power consumption. The particular realization of the DDFS in the example architecture
introduces two modiﬁcations to the conventional CORDIC algorithm that circumvent both of these
problems. Modiﬁcations involve the ﬁne frequency resolution and the feedback stages shown in Fig-
ure 10.46, which depicts the top-level block diagram of the modiﬁed CORDIC. A detailed discussion
of these enhancements to the standard CORDIC algorithm and their effect on the DDFS performance
are given in [966]. The algorithm is easily decomposed into a sum of products formulation, and is
ideally suited for implementation on the example core.
The detailed mapping of the precomputed stages and the feedback section on the proposed
computational core is shown in Figure 10.47. Only a small accumulator is needed in addition to the
example computational core to implement the CORDIC algorithm.
A DDFS implemented using the example core can generate 125 Ms/s quadrature sinusoids in the
frequency range of 4 kHz to 40 MHz in 2-Hz steps while maintaining SFDR above 72 dB [81].
T2
T2
TN
TN
TN
C
S
C
S
TN
sin(θ)
sin(θ)
cos(θ)
cos(θ)
W
0
κ
x
cos(ft)
sin(ft)
Addacc
T2
T2
TN
TN
TN
C
S
C
S
TN
sin(θ)
sin(θ)
cos(θ)
cos(θ)
W
0
κ
x
cos(ft)
sin(ft)
Addacc
Figure 10.47 Mapping of the DDFS architecture.

578
COGNITIVE RADIO
10.3.13
Discrete Fourier transform
The discrete Fourier transform (DFT) can be represented as
X[k] =
N−1
	
n=0
x(n)W kn
N
(10.20)
where WN = e−j(2π/N).
Two approaches can be used: direct evaluation, and the Cooley–Tukey FFT algorithm [84]. Most
dedicated DFT processors use the FFT algorithm because of its computational efﬁciency for large
block sizes. Two major problems prevent the use of the FFT algorithm in the example architecture;
FFT requires complex global routing, and the routing must change signiﬁcantly to process different
DFT sizes.
10.3.14
Goertzel algorithm
The example architecture implements a form of direct DFT evaluation known as the Goertzel algo-
rithm [84]. The Goertzel algorithm calculates each DFT point using a simple recursive circuit, shown
in Figure 10.48. The major advantages of this algorithm are ‘in-place’ computation, no external
memory requirements, a highly regular structure, and easy cascadability that allows multiple chips to
process a single large DFT block. If multiplication by W −k
N is viewed as a rotation by 2πk/N radians,
the Goertzel algorithm is very similar to the CORDIC algorithm discussed in the previous section.
The similarity can be extended to the set of CORDIC precompute stages by ‘unrolling’ the recursive
loop. N recursive cycles in Figure 10.48 can also be computed using N multiplication stages, with the
output of the kth stage being the input of the (k + 1)th stage, as shown in Figure 10.49. The main
difference between the two algorithms is that the same coefﬁcient is used for all the stages of the
DFT computation.
N
n
k
k
n
y
k
X
n
y
=
=
→
)
(
]
[
)
(
1
−
Z
k
N
W −
)
(n
x
N
n=
1
−
Z
N
−
1
−
Z
N
Figure 10.48 Goertzel algorithm for computing X[k].
1
−
Z
k
N
W −
x(1)
1
−
Z
k
N
W −
x(2)
1
−
Z
k
N
W −
1
−
Z
k
N
W −
x(n-1)
0
N stages
x(0)
X[k]
1
−
Z
k
N
W −
x(1)
1
−
Z
k
N
W −
x(2)
1
−
Z
k
N
W −
1
−
Z
k
N
W −
x(n-1)
0
N stages
X[k]
Figure 10.49 Unrolling the Goetzel recursive stage.

RECONFIGURABLE ASIC ARCHITECTURE
579
Table 10.8
Scheduling for the Goertzel algorithm
Tap number / (W, A)
0
1
2
3
Time
n
Out
X
0
W 0, x(1)
W 3, v(2)
W 2, v(3)
W 1, 0
1
W 1, x(1)
W 0, x(2)
W 3, v(3)
W 2, 0
V [1]
2
W 2, x(1)
W 1, x(2)
W 0, x(3)
W 3, 0
V [2]
3
W 3, x(1)
W 2, x(2)
W 1, x(3)
W 0, 0
V [3]
0
W 0, y(1)
W 3, x(2)
W 2, x(3)
W 1, 0
X[0]
1
W 1, y(1)
W 0, y(2)
W 3, x(3)
W 2, 0
X[1]
2
W 1, y(2)
W 0, y(3)
W 3, 0
X[2]
3
W 1, y(3)
W 0, 0
X[3]
0
W 1, 0
Y[0]
0
0.1
0.2
0.3
0.4
0.5
Normalized frequency (Fout /Fs )
−60
0
20
40
60
Power spectrum magnitude (dB)
SFDR = 80 dB
0
0.1
0.2
0.3
0.4
0.5
−40
−20
0
20
40
60
SFDR = 80 dB
Figure 10.50 Output in DDFS mode [65] c⃝2000, IEEE.
The DFT algorithm operates on blocks of data at a time and therefore requires proper scheduling
of resources to process the serial input data. Since the algorithm is ﬁrst-order recursive, only the
value yk(n −1) is needed to compute yk(n). Thus, only the nth stage is used at time n to compute
yk(n). This property is exploited by scheduling the data and coefﬁcients on each stage so that
yk(n), k = 0 . . . N −1 can be computed simultaneously. The following schedule allows full utilization
of the core: the coefﬁcient in the kth stage at time n is given by W n−k
N
. An example of this schedule
for a four-point FFT using four columns of taps is given in Table 10.8, where W refers to the
coefﬁcient and A refers to the input to the adder (see Figure 10.49). The input data stream is given by

580
COGNITIVE RADIO
[v(0), . . . v(3), x(0), . . . , x(3), y(0), . . . , y(3)]. The highlighted part of the table shows the processing
of x(n).
This scheduling can be easily implemented on the example core. Coefﬁcient values are simply
read from the ROM in sequential order and shifted in. The adder inputs (A) are stored in the adder
registers of rows RR and RI. The correct load/hold pattern for these registers is achieved using a
simple N-bit shift register. A single ‘1’ circulates in the shift register. Whenever the kth bit is ‘1,’ the
adder registers in rows RR and RI of the kth stage load the current value of the input, x(n) ; if the bit
is ‘0,’ the value is unchanged. This shift register, and the two registers to hold values x(0) and x(1)
(see Figure 10.49), make up all the overhead of this algorithm. The algorithm implicitly allows for
taking DFTs of blocks smaller than the number of stages. Assuming that the coefﬁcient values are
stored sequentially in a ROM, to compute DFTs of size L, (L < N), the ROM address is incremented
in steps of m = N/L (m is an integer).
Using this method, the desired value, X[k], is generated by the ﬁrst L stages. Processing of these
values by the remaining N −L stages does not change them. This can be veriﬁed by observing that
each stage multiplies the input by W −k
N , and N −L stages result in a multiplication by W −k(N−L)
N
.
Using the deﬁnition of WL, we obtain
W −k(N−L)
L
= ei2πk((N−L)/L) = e−i2πkei2πk(N/L)
= e−i2πkei2πkm = ei2π(m−k) = 1m−k = 1
Figure 10.50 shows the PSD of a sinusoid generated by a chip conﬁgured in the DDFS mode [65].
REFERENCES
1. Chien, C., Srivastava, M. B., Jain, R., Lettieri, P., Aggarwal, V. and Sternowski, R. (1999) Adaptive
radio for multimedia wireless links, IEEE Journal on Selected Areas in Communications, 17(5),
793–813.
2. Seskar, I. P. and Mandayam, N. B. (1999) A software radio architecture for linear multiuser
detection, IEEE Journal on Selected Areas in Communications, 17(5), 814–823.
3. Hanzo, L. and Streit, J. (1999) Adaptive low-rate wireless videophone schemes, IEEE Transac-
tions on Circuits and Systems for Video Technology, 5(4), 305–318.
4. Brown, C. and Feher, J. (1996) A reconﬁgurable modem for increased network capacity and
video, voice, and data transmission over GSM PCS, IEEE Transactions on Circuits and Systems
for Video Technology, 6(2), 215–224.
5. Streit, J. and Hanzo, L. (1997) Dual-mode vector-quantized low-rate cordless videophone systems
for indoors and outdoors applications, IEEE Transactions on Vehicular Technology, 46(2), 340–
357.
6. Brown, E. R. (1998) RF-MEMS switches for reconﬁgurable integrated circuits, IEEE Transac-
tions on Microwave Theory and Techniques, 46(11), 1868–1880.
7. Von Herzen, B. (1998) Signal processing at 250 MHz using high-performance FPGAs, IEEE
Transactions on Very Large Scale Integration (VLSI) Systems, 6(2), 238–246.
8. Chi-Kuang Chen, Po-Chih Tseng, Yung-Chil Chang and Liang-Gee Chen (2001) A digital
signal processor with programmable correlator array architecture for third generation wireless
communication system, IEEE Transactions on Circuits and Systems II: Analog and Digital Signal
Processing, 48(12), 1110–1120.
9. Minnis, B. J. and Moore, P. A. (2003) A highly digitized multimode receiver architecture for 3G
mobiles, IEEE Transactions on Vehicular Technology, 52(3), 637–653.

REFERENCES
581
10. Papapolymerou, J., Lange, K. L., Goldsmith, C. L., Malczewski, A. and Kleber, J. (2003) Recon-
ﬁgurable double-stub tuners using MEMS switches for intelligent RF front-ends, IEEE Transac-
tions on Microwave Theory and Techniques, 51(1), 271–278.
11. Palicot, J. and Roland, C. (2000) A two step architecture for an adaptive receiver, First Interna-
tional Conference on 3G Mobile Communication Technologies (IEE Conf. Publ. No. 471), 27–29
March 2000, pp. 301–305.
12. Miyamoto, R. Y., Yongxi Qian and Itoh, T. (2001) A reconﬁgurable active retrodirective/direct
conversion receiver array for wireless sensor systems, IEEE MTT-S International Microwave
Symposium Digest, 20–25 May 2001, 2, 1119–1122.
13. Jae Ho Jung and Deuk Su Lyu (2002) An architecture of a reconﬁgurable transceiver based on
digital IF for WCDMA and IS-95 base stations, The 5th International Symposium on Wireless
Personal Multimedia Communications, 27–30 October 2002, 2, 831–834.
14. Bian, Y. Q., Nix, A. R. and McGeehan, J. P. (2002) Base station 2-dimensional reconﬁgurable
receiver architecture for DS-CDMA, International Zurich Seminar on Broadband Communica-
tions, Access, Transmission, Networking, 19–21 February 2002, pp. 36-1–36-6.
15. Veljanovski, R., Singh, J. and Faulkner, M. (2003) Design and implementation of reconﬁgurable
ﬁlter, Electronics Letters, 39(10), 813–814.
16. Palicot, J. and Roland, C. (2003) A new concept for wireless reconﬁgurable receivers, IEEE
Communications Magazine, 41(7), 124–132.
17. Baines, R. and Pulley, D. (2003) A total cost approach to evaluating different reconﬁgurable
architectures for baseband processing in wireless receivers, IEEE Communications Magazine,
41(1), 105–113.
18. Tao Long and Shanbhag, N. R. (1999) Low-power CDMA multiuser receiver architectures, IEEE
Workshop on Signal Processing Systems (SiPS 99), 20–22 October 1999, pp. 493–502.
19. Swanchara, S. and Athanas, P. (1999) A methodical approach for stream-oriented conﬁgurable
signal processing, Proceedings of the 32nd Annual Hawaii International Conference on System
Sciences (HICSS-32), 5–8 January 1999, Track 3, 6 pp.
20. Tschanz, J. and Shanbhag, N. R. (1999) A low-power, reconﬁgurable adaptive equalizer archi-
tecture, Conference Record of the Thirty-Third Asilomar Conference on Signals, Systems and
Computers, 24–27 October 1999, 2, 1391–1395.
21. Becker, J., Pionteck, T. and Glesner, M. (2000) An application-tailored dynamically reconﬁg-
urable hardware architecture for digital baseband processing, Proceedings of the 13th Symposium
on Integrated Circuits and Systems Design, 18–24 September 2000, pp. 341–346.
22. Rice, M., Dick, C. and Harris, F. (2001) Maximum likelihood carrier phase synchronization
in FPGA-based software deﬁned radios, Proceedings of the IEEE International Conference on
Acoustics, Speech and Signal Processing (ICASSP, 01) 7–11 May 2001, 2, 889–892.
23. Chadha, K. and Cavallaro, J. R. (2001) A reconﬁgurable Viterbi decoder architecture, Confer-
ence Record of the Thirty-Fifth Asilomar Conference on Signals, Systems and Computers, 4–7
November 2001, 1, 66–71.
24. Srikanteswara, S., Neel, J., Reed, J. H. and Athanas, P. (2001) Soft radio implementations for
3G and future high data rate systems, IEEE Global Telecommunications Conference, 25–29
November 2001, 6, 3370–3374.
25. Sumanen, L. and Halonen, K. (2002) Dual-mode pipeline A/D converter for direct conversion
receivers, Electronics Letters, 38(19), 1101–1103.

582
COGNITIVE RADIO
26. Hentschel, T., Henker, M. and Fettweis, G. (1999) The digital front-end of software radio termi-
nals, IEEE Personal Communications, 6(4), 40–46.
27. Colsell, S. and Edwards, R. (2001) A comparative study of reconﬁgurable digital and analogue
technologies for future mobile communication systems, Second International Conference on
3G Mobile Communication Technologies (IEE Conf. Publ. No. 477), 26–28 March 2001, pp.
302–305.
28. Bucknell, P. and Pitchers, S. (2000) Overcoming the challenges of lower layer protocol reconﬁg-
uration for software radio based mobile terminals, First International Conference on 3G Mobile
Communication Technologies (IEE Conf. Publ. No. 471), 27–29 March 2000, pp. 331–335.
29. Moessner, K. and Tafazolli, R. (2000) Terminal reconﬁgurability–the software download aspect,
First International Conference on 3G Mobile Communication Technologies (IEE Conf. Publ. No.
471) 27–29 March 2000, pp. 326–330.
30. Chao, C. Y. and Ilyas, M. (1989) Fast reconﬁgurable communication networks, Eighth Annual
International Phoenix Conference on Computers and Communications, 22–24 March 1989, pp.
248–252.
31. Ward, C. R. (1990) A multi-mode programmable communication radio receiver element, Pro-
ceedings of the Tactical Communications Conference, 24–26 April 1990, 1, 179–204.
32. Luecke, J. and Jordan, M. (1990) Programmable digital receiver architecture for high data
rate and multichannel communications applications, IEEE Military Communications Conference
(MILCOM ’90) 30 September–3 October 1990, 3, 1256–1260.
33. Ning Zhang and Brodersen, R. W. (2000) Architectural evaluation of ﬂexible digital signal
processing for wireless receivers, Thirty-Fourth Asilomar Conference on Signals, Systems and
Computers, 29 October–1 November 2000, 1, 78–83.
34. Veljanovski, R., Singh, J. and Faulkner, M. (2002) DSP and ASIC implementation of a channel
ﬁlter for a 3G UTRA-TDD system, The 13th IEEE International Symposium on Personal, Indoor
and Mobile Radio Communications, 15–18 September 2002, 3, 1447–1451.
35. Oswald, M. T., Hagness, S. C., Van Veen, B. D. and Popovic, Z. (2002) Reconﬁgurable single-
feed antennas for diversity wireless communications, IEEE Antennas and Propagation Society
International Symposium, 16–21 June 2002, 1, 469–472.
36. Veljanovski, R., Stojcevski, A., Singh, J., Zayegh, A. and Faulkner, M. (2002) Reconﬁgurable
architecture for UTRA-TDD system, Electronics Letters, 38(25), 1732–1733.
37. Gupta, C. N., Evans, J. B. and Minden, G. J. (1993) Reconﬁgurable ATM transmitter/receiver
implementation, Electronics Letters, 29(24), 2139–2140.
38. Latva-aho, M., Juntti, M. and Oppermann, I. (1998) Reconﬁgurable adaptive RAKE receiver for
wideband CDMA systems, 48th IEEE Vehicular Technology Conference (VTC 98), 18–21 May
1998, 3, 1740–1744.
39. Haruyama, S. and Morelos-Zaragoza, R. (2001) A software deﬁned radio platform with direct
conversion: SOPRANO, IEEE VTS 54th Vehicular Technology Conference, 7–11 October 2001,
3, 1558–1560.
40. Miranda, H. C., Pinto, P. C. and Silva, S. B. (2003) A self-reconﬁgurable receiver architecture
for software radio systems, Radio and Wireless Conference (RAWCON ’03) 10–13 August 2003,
pp. 241–244.
41. Luecke, J. and Jordan, M. (1990) Programmable digital communications receiver architecture for
high data rate avionics and ground applications, IEEE/AIAA/NASA 9th Digital Avionics Systems
Conference, 15–18 October 1990, pp. 552–556.

REFERENCES
583
42. Suzuki, F., Koizumi, H., Nishino, K. and Yasuura, H. (1997) A method for reconﬁgurable
multimedia equipment development using inverse problem, IEEE Paciﬁc Rim Conference on
Communications, Computers and Signal Processing, 20–22 August 1997, 1, 74–80.
43. Goel, M., Appadwedula, S., Shambhag, N. R., Ramchandran, K. and Jones, D. L. (1999) A
low-power multimedia communication system for indoor wireless applications, IEEE Workshop
on Signal Processing Systems, 20–22 October 1999, pp. 473–482.
44. Fu-Yen Kuo and Chung-Wei Ku (2000) Software radio based reconﬁgurable correlator/FIR ﬁlter
for CDMA/TDMA receiver, The 2000 IEEE International Symposium on Circuits and Systems
(ISCAS 2000) Geneva, 28–31 May 2000, 1, 112–115.
45. Jondral, F., Wiesler, A. and Machauer, R. (2000) A software deﬁned radio structure for 2nd
and 3rd generation mobile communications standards, IEEE Sixth International Symposium on
Spread Spectrum Techniques and Applications, 6–8 September 2000, 2, 637–640.
46. Tarver, B., Christensen, E. and Miller, A. (2001) Software deﬁned radios (SDR) platform and
application programming interfaces (API), IEEE Military Communications Conference, 28–31
October 2001, 1, 153–157.
47. Yanjun Hu and Jinkang Zhu (2001) Active dynamic multiuser detection for WCDMA commu-
nication systems, IEEE VTS 54th Vehicular Technology Conference, 1, pp. 497–501.
48. Darbel, N., Rasse, Y., Bastidas-Garcia, O., Faux, G., Jubelin, B. and Carrie, M. (2002) Recon-
ﬁgurable low power cell search engine for UMTS-FDD mobile terminals, IEEE Workshop on
Signal Processing Systems, 16–18 October 2002, pp. 171–176.
49. Veljanovski, R., Singh, J. and Faulkner, M. (2002) A proposed reconﬁgurable digital ﬁlter for a
mobile station receiver, IEEE Global Telecommunications Conference, 17–21 November 2002,
pp. 524–528.
50. Stojcevski, A., Singh, J. and Zayegh, A. (2002) A reconﬁgurable analog-to-digital converter
for UTRA-TDD mobile terminal receiver, The 2002 45th Midwest Symposium on Circuits and
Systems, 4–7 August 2002, pp. 613–616.
51. Velianovski, R., Singh, J. and Faulkner, M. (2002) A low-power reconﬁgurable digital pulse-
shaping ﬁlter for an utra-tdd mobile terminal receiver, The 2002 45th Midwest Symposium on
Circuits and Systems, 4–7 August 2002, pp. 1–4.
52. Miyamoto, R. Y., Leong, K. M. K. H., Seong-Sik Jeon, Yuanxun Wang and Itoh, T. (2002)
An adaptive multi-functional array for wireless sensor systems, IEEE MTT-S International Mi-
crowave Symposium Digest, 2–7 June 2002, pp. 1369–1372.
53. Minnis, B. and Moore, P. (2002) A reconﬁgurable receiver architecture for 3G mobiles, IEEE
Radio Frequency Integrated Circuits (RFIC) Symposium, 2–4 June 2002, pp. 187–190.
54. Xinyu Xu, Ke Wu and Bosisio, R. G. (2003) Software deﬁned radio receiver based on six-port
technology, IEEE MTT-S International Microwave Symposium, 8–13 June 2003, 2, 1059–1062.
55. Veljanovski, R., Stojccvski, A., Singh, J., Faulkner, M. and Zayegh, A. (2003) A highly efﬁcient
reconﬁgurable architecture for an utra-tdd mobile station receiver, International Symposium on
Circuits and Systems (ISCAS ’03), 25–28 May 2003, pp. 45–48.
56. Arnold, J., Caldow, A. and Harman, K. (2003) A reconﬁgurable 100 Mchip/s spread spectrum
receiver, IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP
’03), 6–10 April 2003, 2, pp. 445–448.
57. Bianco, A., Dassatti, A., Martina, M., Molino, A. and Vacca, F. (2003) A reconﬁgurable, power-
scalable RAKE receiver IP for W-CDMA, Asia and South Paciﬁc Design Automation Conference,
21–24 January 2003, pp. 499–502.

584
COGNITIVE RADIO
58. Palico, J. and Roland, C. (2003) FFT: a basic function for a reconﬁgurable receiver, 10th Inter-
national Conference on TeleCommunications, February 23–March 1 2003, pp. 898–902.
59. Stojcevski, A., Singh, J. and Zayegh, A. (2003) Reconﬁgurable ADC for 3 -G UTRA-TDD mobile
receiver, Southwest Symposium on Mixed-Signal Design, 23–25 February 2003, pp. 27–31.
60. Mc Cormick, A. C., Grant, P. M., Thompson, J. S., Arslan, T. and Erdogan, A. T. (2002) Low
power receiver architectures for multi-carrier CDMA, IEE Proceedings Circuits, Devices and
Systems, 149(4), 227–233.
61. Hanzo, L. and Streit, J. (1995) Adaptive low-rate wireless videophone schemes, IEEE Transac-
tions on Circuits and Systems for Video Technology, 5(4), 305–318.
62. Dick, C. and Harris, F. J. (1999) Conﬁgurable logic for digital communications: some signal
processing perspectives, IEEE Communications Magazine, 37(8), 107–111.
63. Blaickner, A. and Grunbacher, H. (2000) On reconﬁgurable methods and gate array based so-
lutions of fast forward error correction systems for software radio and set-top-box applications,
IEEE Transactions on Consumer Electronics, 46(4), 994–998.
64. Chi-Kuang Chen, Po-Chih Tseng, Yung-Chil Chang and Liang-Gee Chen (2001) A digital
signal processor with programmable correlator array architecture for third generation wireless
communication systems, IEEE Transactions on Circuits and Systems II: Analog and Digital
Signal Processing, 48(12), 1110–1120.
65. Grayver, E. and Daneshrad, B. (2000) A reconﬁgurable 8 GOP ASIC architecture for high-speed
data communications, IEEE Journal on Selected Areas in Communications, 18(11), 2161–2171.
66. TMS320C6000 power consumption summary (Online) Available: http://wwws.ti.com/sc/psheets/
spra486b/spra486b.pdf.
67. (Online). Available: http://brass.cs.berkeley.edu/reproc.html.
68. (Online). Available: http://www.acm.org/crossroads/xrds5-3//rcconcept.html.
69. Athanas, P. M. and Silverman, H. F. (1993) Processor reconﬁguration through instruction-set
metamorphosis, Computer, 26, 11–18.
70. Hauck, S., Fry, T. W., Hosler, M. M. and Kao, J. P. (1997) The Chimaera reconﬁgurable functional
unit, in Proceedings of the IEEE Symposium on FPGAs for Custom Computing Machines, pp.
87–96.
71. DeHon, A. (1999) Balancing interconnect and computation in a reconﬁgurable computing array
(or, why you don’t really want 100% LUT utilization), in Proceedings of FPGA’99, pp. 69–78.
72. Zhang, H., Prabhu, V., George, V., Wan, M., Benes, M. and Abnous, A. (2000) A 1 V heteroge-
neous reconﬁgurable processor IC for baseband wireless applications, in Proceedings of ISSCC
2000.
73. Virtex power estimator 1.5 (Online). Available: http://www.xilinx.com/cgi-bin/powerweb.pl.
74. Virtex 2.5 V programmable gate arrays, XILINX databook, 1999. rev. 1.9.
75. TMS320C6201, TMS320C6201B digital signal processors (Online). Available: http://www
.ti.com/sc/docs/products/dsp/tms320c6201.html.
76. TMS320C62X assembly benchmarks (Online). Available: http://www.ti.com/sc/docs/products/
dsp/c6000/62bench.htm.
77. (Online). Available: http://www.xilinx.com/ipcenter/catalog/logicore/docs/mult vgen v1 0.pdf.
78. 106 Ms/s digital ﬁlter. Graychip (Online). Available: http://www.graychip.com/GC2011/GC2011
.html.

REFERENCES
585
79. Master, P. (1999) Adaptive computing processors for next generation wireless, Wireless Design
and Development.
80. Haykin, S. (1995) Adaptive Filter Theory. Prentice Hall, Englewood Cliffs, NJ.
81. Grayver, E. and Daneshrad, B. (1998) Direct digital frequency synthesis using a modiﬁed
CORDIC, in Proceedings of IEEE ISCAS.
82. Tan, L. K. et al. (1995) An 800-MHz quadrature digital synthesizer, IEEE Journal on Solid-State
Circuits, 30, 1463–1473.
83. Volder, J. E. (1959) The CORDIC trigonometric computing technique, IRE Transactions on
Electronics and Computers, EC-8, 330–334.
84. Oppenheim, A. V. and Schafer, R. W. (1989) Discrete-Time Signal Processing. Prentice Hall,
Englewood Cliffs, NJ.


11
Cooperative Diversity in
Cognitive Wireless Networks
11.1
SYSTEM MODELING
It was shown in Chapter 4 that multiple transmit antennas provide spatial diversity. Unfortunately,
this is not easy to implement in the uplink of a cellular system, due to the size of the mobile unit.
In order to overcome this limitation, yet still emulate transmit antenna diversity, an alternative form
of spatial diversity is being considered, where diversity gains are achieved via the cooperation of
in-cell users. That is, in each cell, each user may have a ‘partner.’ Each of the two partners would be
responsible for transmitting not only their own information, but also the information of their partner,
which they receive and detect. Spatial diversity would be achieved through the use of the partner’s
antenna. This is complicated by the fact that the interuser channel is noisy and by the fact that both
partners have information of their own to send; this is not a simple relay problem.
The basic premise in this concept is that both users have information of their own to send, denoted
by Ui for i = 1, 2, and would like to cooperate in order to send this information to the receiver
at the highest rate possible. To distinguish this main/ﬁnal receiver from the receiving units of the
mobiles, we will refer to it as the BS, even though the user cooperation idea is equally applicable to
ad hoc networks too. The channel model we use is depicted in Figure 11.1. Each mobile receives an
attenuated and noisy version of the partner’s transmitted signal and uses that, in conjunction with its
own data, to construct its transmit signal. The BS receives a noisy version of the sum of the attenuated
signals of both users. The mathematical formulation of the model is [2]:
Y0(t) = h10X1(t) + h20X2(t) + n0(t)
Y1(t) = h21X2(t) + n1(t)
Y2(t) = h12X1(t) + n2(t)
(11.1)
where Y0(t), Y1(t), and Y2(t) are the baseband models of the received signals at the BS, user 1 and user
2, respectively, during one symbol period. Also, Xi(i) is the signal transmitted by user i, for i =1, 2,
and ni(t) are the additive channel noise terms at the BS, user 1, and user 2, for i = 0, 1, 2, respectively.
The fading coefﬁcients, {hi j}, remain constant over at least one symbol period, and observed over time
form independent stationary ergodic stochastic processes, resulting in frequency-nonselective fading.
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

588
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
0
Y
0
n
20
h
10
h
12
h
2
n
21
h
1n
1
X
2
X
2
E
1
E
1Y
2
Y
1
U
2
U
Figure 11.1 Channel model.
A critical assumption here is that there is no contribution from X2(t) in Y2(t), even though they
are actually both present at the terminal belonging to user 2. Since X2(t) does not go through
any fading before it reaches the antenna of user 2, unlike Y2(t), it may appear that it will have a
detrimental effect on the reception of Y2(t). Provided that user 2 knows the relevant antenna gains,
it is assumed that canceling the effects of X2(t) on Y2(t) is possible, and thus the model gives an
accurate representation. A similar argument can be made in the case of user 1, regarding the effects
of X1(t) on the reception of Y1(t). In practice, to isolate the transmitted signal from the received one,
it may be necessary to use two separate channels, two colocated antennas, or some other means. For
example, the CDMA implementations of this concept make use of spreading codes to create two
separate channels, thus eliminating the need for echo cancellation. Also, time division among the
mobiles has been investigated in [3, 4], where it was shown that cooperation continues to provide full
diversity.
In the sequel we also use additional assumptions: (i) the transmitted signals Xi(t) have an average
power constraint of Pi for i = 1, 2; (ii) the noise terms ni(t) are white zero-mean complex Gaussian
random processes with spectral height Ni/2 for i = 0, 1, 2; and (iii) the fading coefﬁcients hi j are
zero-mean complex Gaussian random variables with variance ξ 2
i j (Rayleigh fading). It is also assumed
that the BS can track the variations in h10 and h20, user 1 can track h21, and user 2 can track h12,
implying that all the decoding is done with the knowledge of the fading parameters. Due to the
reciprocity of the channel, it is also assumed that h21 and h12 are equal. Finally, for simplicity of
analysis and exposition, though with no loss in generality, a synchronous system is assumed.
11.1.1
System capacity
The mathematical model we use is a discrete time version of the model described in (i) and is given
by:
Y0 = h10X1 + h20X2 + n0
Y1 = h21X2 + n1
Y2 = h12X1 + n2
(11.2)

SYSTEM MODELING
589
with n0 ∼N(0, σ 2
0 ), n1 ∼N(0, σ 2
1 ) and n2 ∼N(0, σ 2
2 ). In general, we assume that σ 2
1 = σ 2
2 . The
system is causal and transmission is done through blocks of length N, therefore the signal of user 1 at
time j, j = 1, . . . , N, can be expressed as X1(U1, Y1( j −l), Y1( j −2), 1/4, Y1(1)), where U1 is the
message that user 1 wants to transmit to the BS at that particular block. Similarly, for user 2, we have
X2(U2, Y2( j −l), Y2( j −2), 1/4, Y2(1)).
The transmission is done for B blocks of length N, where both B and N are large. The mobiles will
cooperate based on the signals they receive in the previous block.
We assume mobile 1 divides its information U1 into two parts: U10, to be sent directly to the BS,
and U12, to be sent to the BS via mobile 2. Mobile 1 then structures its transmit signal so that it is able
to send the above information as well as some additional cooperative information to the BS. This is
done according to X1 = X10 + X12 + e1 and divides its total power accordinglyP1 = P10 + P12 + Pe1
where e1 refers to the part of the signal exchanged to transmit the cooperative information. Thus, X10
is allocated power P10 for sending U10 at rate R10 directly to the BS, X12 is allocated power P12 for
sending U12 to user 2 at rate R12, and e1 is allocated power Pe1 for sending cooperative information to
the BS. It should be noted that the transmission rate of U12, i.e. P12, and the power allocated to U12,
i.e. P12, should be such that U12 can be perfectly decoded by mobile 2. This perfect reconstruction at
the partner forms the basis for cooperation. Mobile 2 structures its transmit signal X2 and divides its
total power P2 in a similar fashion.
Recall that we transmit for B blocks of length N. Cooperation in block i is achieved by constructing
signals e1 and e2 based on (U12(i −1), U21(i −1)), both of which are now known at mobile 1 and
mobile 2. The receiver waits until all the B blocks have been received and starts decoding from
the last block. An achievable rate region with user cooperation is obtained by ﬁrst considering the
above cooperative strategy with constant attenuation factors, and then incorporating the randomness.
It is assumed that each block of length N is long enough to observe the ergodicity of the fading
distributions.
An achievable rate region for the system given in (2) is the closure of the convex hull of all rate
pairs (R1, R2) such that R1 = R10 + R12 and R2 = R20 + R21 with
R12 < E

C

h2
12P12
h2
12P10 + σ 2
1

R21 < E

C

h2
21P21
h2
21P20 + σ 2
2

R10 < E

C
h2
10P10
σ 2
0

R20 < E

C
h2
20P20
σ 2
0

R10 + R20 < E

C
h2
10P10 + h2
20P20
σ 2
0

R10 + R20 + R12 + R21 < E

C
h2
10P1 + h2
20P2 + 2h10h20
√Pe1Pe2
σ 2
0

(11.3)
for some power assignment satisfying P1 = P 10 + P12 + Pe1, P2 = P20 + P21 + Pe 2. The function
C(y) = (1/2) log(l + y) is the capacity of an additive white Gaussian noise (AWGN) channel with
signal-to-noise ratio (SNR) y and E denoted expectation with respect to the fading parameters hi j.
The proof of Equation (11.3) is based on [2,8].
Equation (11.3) is shown in Figures 11.2 and 11.3, for different scenarios of channel quality. For
the no-cooperation case, the users ignore the signals Y2 and Y1, which are equivalent to the multiple-
access channel capacity region. The noiseless interuser channel (σ 2
1 = σ 2
2 = 0) is referred to as ideal
cooperation, and is used mostly as an upper bound for the performance of any cooperation scheme.

590
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
2
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
2
R2
R1
Ideal
Cooperation (E[h   ]-0.95)
Cooperation (E[h   ]-0.71)
Cooperation (E[h   ]-0.63)
Cooperation (E[h   ]-0.55)
No cooperation
2
2
2
0
1
2
1
2
10
20
1.0,
1.0,
1.0, P
2.0, P
2.0, E[h ]
0.63, E[h ]
0.63
σ
σ
σ
−
−
−
=
=
−
−
Figure 11.2 Capacity region when the two users face statistically equivalent channels to-
ward the BS.
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
2
0
0,2
0,4
0,6
0,8
1
1,2
1,4
1,6
1,8
2
R2
R1
Ideal
Cooperation
No Cooperation
2
2
2
0
1
2
1
2
10
20
12
1.0,
1.0,
1.0, P
2.0, P
2.0, E[h ]
0.95, E[h ]
0.30, E[h ]
0.71
σ
σ
σ
−
−
−
=
=
−
−
−
Figure 11.3 Capacity region when the two users face statistically dissimilar channels toward
the BS.

SYSTEM MODELING
591
From Figure 11.2, we can se that when the channels from the users to the BS have similar quality
(h10 and h20 have the same mean) and the channel between the users is better (h12 has larger mean), the
cooperation scheme greatly improves the achievable rate region. As the interuser channel degrades
and the severity of the interuser fading increases, performance approaches that of no cooperation.
When the user–BS links of the two users experience fading with different means, cooperation
again improves the achievable rate region, as shown in Figure 11.3. In this case, the user with more
fading beneﬁts most from the cooperation. The equal rate point (R1 = R2) or the maximum rate sum
point (R1 + R2) is increased considerably with cooperation.
In Figures 11.2 and 11.3, the point where any achievable rate curve intersects the Y axis corresponds
to user 2 becoming a relay for user 1, and the point where the curve intersects the X axis corresponds
to user 1 becoming a relay for user 2.
Relay channels and their extensions form the basis for the study of cooperative diversity. Because
relaying and cooperative diversity essentially create a virtual antenna array, work on multiple-antenna
systems, or multiple-input, multiple-output (MIMO) systems, discussed in Chapter 4, is of course
relevant.
The classical relay channel models, a class of three-terminal communication channels, are origi-
nally examined by van der Meulen [10]. Cover and El Gamal [1] treat certain discrete memoryless
and additive white Gaussian noise relay channels, and they determine channel capacity for the class
of physically degraded relay channels. In general, degraded means that the destination receives a
corrupted version of what the relay receives, all conditioned on the relay transmit signal. More gen-
erally, they develop lower bounds on capacity, i.e. achievable rates, via three structurally different
random coding schemes: facilitation, in which the relay does not actively help the source, but rather,
facilitates the source transmission by inducing as little interference as possible; cooperation, in which
the relay fully decodes the source message and retransmits, jointly with the source, a bin index (in the
sense of Slepian–Wolf coding [11, 12]) of the previous source message (see also Section 2.5); and
observation, in which the relay encodes a quantized version of its received signal, using ideas from
source coding with side information [11–14] (see also Chapter 2.5). In general, cooperation yields
highest achievable rates when the source–relay channel quality is very high, and observation yields
highest achievable rates when the relay–destination channel quality is very high. Various extensions
to the case of multiple relays have appeared in the work of Schein and Gallager [15, 16], Gupta and
Kumar [17, 18], and Gastpar et al. [19, 20]. For channels with multiple information sources, Kramer
and Wijngaarden [21] consider a multiple-access channel in which the sources communicate to a
single destination and share a single relay.
Work by King [22], Carleial [23], and Willems and coworkers [24–26] examines multiple-access
channels with generalized feedback. Here, the generalized feedback allows the sources essentially to
act as relays for one another. This model relates most closely to the wireless channels we have in
mind in this chapter. The constructions in [23, 24] can be viewed as two-terminal generalizations of
the cooperation scheme in [1]; the construction [22] may be viewed as a two-terminal generalization
of the observation scheme in [1]. Sendonaris et al. introduce multipath fading into the model of [23,
24], calling their approaches for this system model user cooperation diversity [2, 27, 28]. For ergodic
fading, they illustrate that the adapted coding scheme in [24] enlarges the achievable rate region.
11.1.2
Probability of outage
If the attenuation factors vary slowly and can be approximated as constants over the B blocks of
length N, then over these B blocks we can achieve rates dictated by the current values of h10, h20, h12,
and h21. We assume N (the block length) and B (the number of blocks) are large enough to achieve
capacity in the case of constant attenuation factors. However, in order to talk about the achievable
rate region in (iii), we need to have even longer block lengths and observe different realizations
of our fading amplitudes. When the delay requirements prevent us from having these longer block
lengths, the rates achieved will be random quantities based on the current realizations of the fading
amplitudes. Some wireless services have minimum requirements on the supported data rates, below
which the service is unsustainable. Therefore, we observe an outage if the random rates that we can

592
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
Figure 11.4 Probability of outage.
achieve fall below a certain level, which we will call the service sustainability rate, and consider the
probability of outage as a performance criterion [9].
In particular, we consider the equal rate point (R1= R2= R) and calculate the probability of
outage versus the service sustainability rate r for the cooperation and the no-cooperation schemes. The
probability of outage, Pout = Pr(R < r), provides us with the probability that the current realization of
our slowly fading parameters h10, h20, h12, and h21 will not be able to support an equal transmission
rate of r for the particular scheme under consideration. The results are given in Figure 11.4. We
observe that for all service sustainability rates, the probability of outage for the cooperation scheme
is smaller than the probability of outage under no cooperation. This is true despite the fact that the
increase in achievable rate due to cooperation is moderate for the scenario depicted in Figure 11.4,
as can be seen from Figure 11.2 (E[h12] = 0.63). This demonstrates that even in cases when it does
not signiﬁcantly increase achievable rates, user cooperation is still able to increase robustness against
channel variations. We, of course, expect the robustness to improve even more as the interuser channel
quality (E[h12]) improves.
11.1.3
Cellular coverage
Our expectation of increased cell coverage is based on a reduction in the required average received
power. Assume the mobile is at a distance d km from the BS. Let Ptx denote the average power
transmitted by the mobile and Prx denote the average power received at the BS (in decibels). Then,
in a typical wireless channel, we have (in decibels) Prx = Ptx – PL(d) where PL(d) is the mean
path loss at distance d km. A common model for PL(d) is the Hata model (see Chapter 14) with
PL(d)= B1+B2 log d, where B1 and B2 are functions of transmitter and receiver antenna height,
carrier frequency, and type of environment. Therefore log d = (PTX −PRX −B1)/B2. For a ﬁxed
Prx, the maximum d is achieved when Ptx is at its maximum, denoted by Pmax
TX . This is the maximum
power that the mobile can transmit. Solog dmax(PRX) = (Pmax
TX −PRX −B1)/B2. The coverage of the
cell is thus given by dmax. The only quantity of the right-hand side that is variable is Prx.
Assume that two different transmission schemes require different received average powers in order
to operate successfully. That is, let scheme 1 require P(1)
RX and scheme 2 require P(2)
RX. Deﬁne α to be
their ratio, that is in decibels 10 log α = P(1)
RX −P(2)
RX. From the above, we have log d(1)
max −log d(2)
max =
(P(2)
RX −P(1)
RX)/B2 = −(10 log α)/B2 resulting in d(1)
max/d(2)
max = α−10/B2. A typical set of values for B1

COOPERATIVE DIVERSITY PROTOCOLS
593
and B2 is B1 = 17.3 and B2 = 33.8 (obtained for a medium-sized city environment, with carrier
frequency of 900 MHz, transmit antenna height of 50 m, receive antenna height of 1 m, and a net
antenna gain of 6 dB). Thus, the ratio of the coverage of scheme 1 versus scheme 2, as a function of
the ratio of the required received average powers, is d(1)
max/d(2)
max = α−1/3.38.
11.2
COOPERATIVE DIVERSITY PROTOCOLS
11.2.1
System and channel models
In this section we divide the available bandwidth into orthogonal channels and allocate these channels
to the transmitting terminals, allowing the protocols to be readily integrated into existing networks.
By removing the interference between the terminals at the destination radio substantially simpliﬁes
the receiver algorithms and the outage analysis for purposes of exposition.
Current limitations in radio implementation preclude the terminals from full-duplex operation, i.e.
transmitting and receiving at the same time in the same frequency band because of severe attenuation
over the wireless channel, and insufﬁcient electrical isolation between the transmit and receive
circuitry. Thus, to ensure half-duplex operation, we further divide each channel into orthogonal
subchannels. Figure 11.5 illustrates our channel allocation for an example time-division approach
with two terminals.
The critical assumptions in this section are different levels of synchronization between the termi-
nals in order for cooperative diversity to be effective. As suggested by Figure 11.5 and the modeling
discussion to follow, we consider the scenario in which the terminals are block, carrier, and symbol
synchronous. Given some form of network block synchronization, carrier and symbol synchroniza-
tion for the network can build upon the same between the individual transmitters and receivers. For
details on network synchronization see www.wiley.com/go/glisic1.
In characterizing the channel models, we modify notation (11.2) and focus on the message of
the ‘source’ terminal Ts, which potentially employs terminal Tr as a ‘relay,’ in transmitting to the
‘destination’ terminal Td. We utilize a baseband-equivalent, discrete-time channel model for the
continuous-time channel, and we consider N consecutive uses of the channel, where N is large.
For direct transmission, we model the channel as:
yd[n] = hs,dxs[n] + nd[n];
n = 1 . . . . , N/2,
(11.4)
 
1
X
2
X
T
T
T
T
+
(a)
N
1
X
T
T
(b)
/ 2
N
1
X
2
X
T
R
T
T
+
(c)
2
X
T
T
2 Relay
T
2
X
1
X
T
R
T
T
+
1 Relay
T
/ 2
N
/ 4
N
/ 4
N
/ 4
N
/ 4
N
Figure 11.5 Example time-division channel allocations for (a) direct transmission with
interference, (b) orthogonal direct transmission, and (c) orthogonal cooperative
diversity. Throughout this section we focus on orthogonal transmissions of the
form (b) and (c).

594
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
where xs[n] is the source transmitted signal, and yd[n] is the destination received signal. The other
terminal transmits for n = N/2 + 1, . . . , N as depicted in Figure 11.5(b). Thus, in the baseline
system, each terminal utilizes only half of the available degrees of freedom of the channel.
For cooperative diversity, we model the channel during the ﬁrst half of the block as:
yr[n] = hs,r xs[n] + nr[n]
yd[n] = hs,dxs[n] + nd[n];
n = 1, . . . , N/4
(11.5)
where xs[n] is the source transmitted signal and yr [n] and yd [n] are the relay and destination received
signals, respectively. For the second half of the block, we have:
yd[n] = hr,dxr[n] + nd[n];
n = N/4 + 1, . . . , N/2
(11.6)
where xr[n] is the relay transmitted signal and yd[n] is the destination received signal. The repre-
sentation in the second half of the block is similar, with the roles of the source and relay reversed,
as depicted in Figure 11.5(c). Note that half the degrees of freedom are allocated to each source
terminal for transmission to its destination, and a quarter of the degrees of freedom are available for
communication to its relay.
Channel coefﬁcients hi, j capture the effects of path-loss, shadowing, and frequency nonselective
fading, and n j[n] captures the effects of receiver noise and other forms of interference in the system,
where i ∈{s, r} and j ∈{r, d}. Statistically, we model hi, j as zero-mean, independent, circularly
symmetric complex Gaussian random variables with variances σ 2
i, j. Furthermore, we model n j[n] as
zero-mean mutually independent, circularly symmetric, complex Gaussian random sequences with
variance N0.
Two important parameters of the above system are the SNR without fading and the spectral
efﬁciency. If the transmitting terminals have an average power constraint in the continuous-time
channel model of Pc joules per second, this translates into a discrete-time power constraint of
P = 2Pc/W since each terminal transmits in half of the available degrees of freedom, under both
direct transmission and cooperative diversity. Thus, the channel model is parameterized by the SNR
variables SNR|hi, j|2, where SNR := 2Pc/(N0W) = P/N0 = y is the common SNR without fading.
In addition to SNR, transmission schemes are further parameterized by the rate r bits per second,
or spectral efﬁciency R := 2r/W b/s/Hz attempted by the transmitting terminals. Nominally, one
could parameterize the system by the pair (y, R); however, our results lend more insight, and are
substantially more compact, when we use either of the pairs (Y, R) or (y, ℜ), where
Y :=
y
2R −1,
ℜ=
R
log

1 + yσ 2
s,d

(11.7)
11.2.2
Coperative diversity protocols
11.2.2.1
Amplify-and-forward
For amplify-and-forward transmission, the appropriate channel model is (11.5–11.6). The source
terminal transmits its information as xs[n], say, for n = 1, . . . , N/4. During this interval, the relay
processes yr[n], and relays the information by transmitting xr [n] = βyr[n −N/4] for n = N/4 +
1, 1/4, N/2. To remain within its power constraint (with high probability), an amplifying relay
must use gain β ≤

P/

|hs,r|2P + N0
	
where we allow the ampliﬁer gain to depend upon the
fading coefﬁcient hs,r between the source and relay, which the relay estimates to high accuracy.
This scheme can be viewed as repetition coding from two separate transmitters, except that the relay
transmitter ampliﬁes its own receiver noise. The destination can decode its received signal yd[n] for
n = 1, . . . , N/2 by ﬁrst appropriately combining the signals from the two subblocks using one of
a variety of combining techniques; in the sequel, we focus on a suitably designed matched ﬁlter, or
maximum-ratio combiner.

COOPERATIVE DIVERSITY PROTOCOLS
595
11.2.2.2
Decode-and-forward
For decode-and-forward transmission, the appropriate channel model is again Equations (11.5) and
(11.6). The source terminal transmits its information as xs[n], for n = 0, . . . , N/4. During this
interval, the relay processes yr[n] by decoding an estimate xs[n] of the source transmitted signal.
Under a repetition-coded scheme, the relay transmits the signal:
xr[n] = ˆxs[n −N/4]
for
n = N/4 + 1 . . . , N/2.
Decoding at the relay can take on a variety of forms. For example, the relay might fully decode, i.e.
estimate without error, the entire source codeword, or it might employ symbol-by-symbol decoding
and allow the destination to perform full decoding. These options allow for trading off performance
and complexity at the relay terminal. Note that we focus on full decoding in the sequel. Again,
the destination can employ a variety of combining techniques; we focus in the sequel on a suitably
modiﬁed matched ﬁlter.
11.2.2.3
Selection relaying in cognitive radio
Fixed decode-and-forward is limited by direct transmission between the source and relay. However,
since the fading coefﬁcients are known to the appropriate receivers, hs,r can be measured to high
accuracy by the cooperating terminals; thus, they can adapt their transmission format according to
the realized value of hs,r.
If the measured |hs,r|2 falls below a certain threshold, the source simply continues its transmission
to the destination, in the form of repetition or more powerful codes. If the measured |hs,r|2 lies above
the threshold, the relay forwards what it received from the source, using either amplify-and-forward
or decode-and-forward, in an attempt to achieve diversity gain.
11.2.2.4
Incremental relaying in cognitive radio
Fixed and selection relaying can make inefﬁcient use of the degrees of freedom of the channel,
especially for high rates, because the relays repeat all the time. As an alternative, incremental
relaying protocols can be used that exploit limited feedback from the destination terminal, e.g. a
single bit indicating the success or failure of the direct transmission. We nominally allocate the
channels according to Figure 11.5(b). First, the source transmits its information to the destination
at spectral efﬁciency R. The destination indicates success or failure by broadcasting a single bit of
feedback to the source and relay, which we assume is detected reliably by at least the relay. If the
source-destination SNR is sufﬁciently high, the feedback indicates success of the direct transmission,
and the relay does nothing. If the source-destination SNR is not sufﬁciently high for successful direct
transmission, the feedback requests that the relay amplify-and-forward what it received from the
source. In the latter case, the destination tries to combine the two transmissions.
11.2.3
Outage probabilities
As a function of the fading coefﬁcients viewed as random variables, the mutual information for a
protocol is a random variable denoted by I; in turn, for a target rate R, I < R denotes the outage event,
and Pr[I < R] denotes the outage probability.
11.2.3.1
Direct transmission
For direct transmission, the source terminal transmits over the channel (11.4). The maximum av-
erage mutual information between input and output in this case, achieved by independent and
identically distributed (i.i.d.) zero-mean, circularly symmetric complex Gaussian inputs, is given
by ID = log(1 + y|hs,d|2) as a function of the fading coefﬁcient hs,d. The outage event for spectral

596
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
efﬁciency R is given by Id < R and is equivalent to the event |hs,d|2 < 1/Y. For Rayleigh fading,
i.e., |hs,d|2 exponentially distributed with parameter σ −2
s,d , the outage probability satisﬁes
pout
D (y, R) := Pr[ID < R] =
Pr

|hs,d|2 < 1
Y

= 1 −exp

−
1
Yσ 2
s,d

∼
1
σ 2
s,d
· 1
Y
(11.8)
11.2.3.2
Amplify-and-forward
The amplify-and-forward protocol produces an equivalent one-input, two-output complex Gaussian
noise channel with different noise levels in the outputs. The maximum average mutual information
between the input and the two outputs, achieved by i.i.d. complex Gaussian inputs, is given by (see
Appendix 11.2):
IAF = 1
2log(1 + y
hs,d
2 + f (y
hs,r
2 , y
hr,d
2))
(11.9)
as a function of the fading coefﬁcients, where f (u, v) := uv/(u + v + 1).
The outage event for spectral efﬁciency R is given by IAF < R and is equivalent to the event:
hs,d
2 + 1
y f (y
hs,r
2 , y
hr,d
2) < 22R −1
y
(11.10)
For Rayleigh fading, i.e., |hi, j|2 independent and exponentially distributed with parameters σ −2
i, j ,
analytic calculation of the outage probability becomes involved, but we can approximate its high-
SNR behavior as:
pout
AF(y, R) := Pr[IAF < R] ∼

1
2σ 2
s,d
σ 2
s,r + σ 2
r,d
σ 2
s,rσ 2
r,d
 22R −1
y
2
(11.11)
where we have utilized the result of Equality 1 in Appendix 11.1, with:
u =
hs,d
2 , v =
hs,r
2 , w =
hr,d
2 , λu = σ −2
s,d , λv = σ −2
s,r , λw = σ −2
r,d
g(ε) = (22R −1)ε, t = y, h(t) = 1/t.
11.2.3.3
Decode-and-forward
In this case we examine a particular decoding structure at the relay. Speciﬁcally, we require the relay to
decode fully the source message; examination of symbol-by-symbol decoding at the relay becomes
involved because it depends upon the particular coding and modulation choices. The maximum
average mutual information for repetition-coded decode-and-forward can be readily shown to be:
IDF = 1
2min

log(1 + y
hs,r
2), log(1 + y
hs,d
2 + y
hr,d
2)

(11.12)
as a function of the fading random variables. The ﬁrst term represents the maximum rate at which the
relay can reliably decode the source message, while the second term represents the maximum rate
at which the destination can reliably decode the source message given repeated transmissions from
the source and destination. Requiring both the relay and destination to decode the entire codeword
without error results in the minimum of the two mutual pieces of information in (11.12).
The outage event for spectral efﬁciency R is given by I d f < R and is equivalent to the event
min
hs,r
2 ,
hs,d
2 +
hr,d
2
< 22R −1
y
.
(11.13)

COOPERATIVE DIVERSITY PROTOCOLS
597
For Rayleigh fading, the outage probability for repetition-coded decode-and-forward can be computed
according to
pout
DF(y, R) : = Pr[IDF < R] = Pr
hs,r
2 < g(y)

+
+ Pr
hs,r
2 ≥g(y)

Pr
hs,d
2 +
hr,d
2 < g(y)

(11.14)
where g(y) = [22R −1]/y. We examine the large y behavior of Equation (1.14) by computing the
limit
1
g(y) pout
DF(y, R) =
1
g(y)Pr
hs,r
2 < g(y)




→1/σ 2s,r
= Pr
hs,r
2 ≥g(y)




→1
1
g(y) Pr
hs,d
2 +
hr,d
2 < g(y)




→0
→1/σ 2
s,r
(11.15)
as y →∞, using the results of Results 1 and 2 in Appendix 11.1. So,
pout
DF(y, R) ∼
1
2σ 2
s,r
22R −1
y
(11.16)
The 1/y behavior in (11.16) indicates that ﬁxed decode-and-forward does not offer diversity gains for
large SNR, because requiring the relay to decode fully the source information limits the performance
of decode-and-forward to that of direct transmission between the source and relay.
11.2.3.4
Selection relaying
As an example analysis, we determine the performance of selection decode-and-forward. In the case
of repetition coding at the relay, we have
ISDF =
 1
2 log(1 + 2y
hs,d
2),
hs,r
2 < g(y)
1
2 log(1 + y[
hs,d
2 +
hr,d
2]),
hs,r
2 ≥g(y)
(11.17)
where g(y) = [22R −1]/y. This threshold is motivated by our discussion of direct transmission. The
ﬁrst case in Equation (11.17) corresponds to the relay’s not being able to decode and the source’s
repeating its transmission; here, the maximum average mutual information is that of repetition
coding from the source to the destination, hence the factor 2y. The second case in Equation (11.17)
corresponds to the relay’s ability to decode and repeat the source transmission; here, the maximum
average mutual information is that of repetition coding from the source and relay to the destination.
The outage event for spectral efﬁciency R is given by ISDF < R and is equivalent to the event:
hs,r
2 < g(y)

∩

2
hs,d
2 < g(y)

∪
hs,r
2 ≥g(y)

∩
hs,d
2 +
hr,d
2 < g(y)

(11.18)
The ﬁrst (second) event in (11.18) corresponds to the ﬁrst (second) case in Equation (11.17). Because
the events in Equation (11.18) are mutually exclusive, the outage probability becomes a sum:
pout
SDF(y, R) : = Pr[ISDF < R]
= Pr
hs,r
2 < g(y)

Pr

2
hs,d
2 < g(y)

(11.19)
+ Pr
hs,r
2 ≥g(y)

Pr
hs,d
2 +
hr,d
2 < g(y)


598
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
and we may readily compute a closed-form expression for (11.xx). For comparison with our other
protocols, we examine the large SNR behavior of Equation (11.19) by computing the limit:
1
g2(y) pout
SDF(y, R) =
1
g(y)Pr
hs,r
2 < g(y)




→1/σ 2s,r
1
g(y)Pr
hs,d
2 < g(y)




→1/(2σ 2
s,d)
+ Pr
hs,r
2 ≥g(y)




→1
1
g2(y) Pr
hs,d
2 +
hr,d
2 < g(y)




→1/(2σ 2
s,dσ 2
r,d
(11.20)
→

1
2σ 2
s,d
σ 2
s,r + σ 2
r,d
σ 2
s,rσ 2
r,d

as y →∞, using the results of Results 1 and 2 of Appendix 11.1. Thus, we conclude that the large
SNR performance of selection decode-and-forward is identical to that of ﬁxed amplify-and-forward.
11.2.4
Performance bounds for cooperative diversity
If we suppose that the source and relay know each other’s messages a priori, then instead of direct
transmission, each would beneﬁt from using a space-time code for two transmit antennas. In this sense,
the outage probability of conventional transmit diversity (see Chapter 4) represents an optimistic lower
bound on the outage probability of cooperative diversity.
11.2.4.1
Transmit diversity bound
To utilize a space-time code for each terminal, we allocate the channel as in Figure 11.5 (b). Both
terminals transmit in all the degrees of freedom of the channel, so their transmitted power is P/2, half
that of direct transmission. The spectral efﬁciency for each terminal remains R.
For transmit diversity, we model the channel as:
yd[n] = [ hs,d hr,d]

 xs[n]
xr[n]

+ nd[n];
n = 0, . . . , N/2
(11.21)
An optimal signaling strategy, in terms of minimizing outage probability in the large SNR regime, is to
encode information using [xsxr]T i.i.d. complex Gaussian, each with power P/2 (see Appendix 11.3).
Using this result, the maximum average mutual information as a function of the fading coefﬁcients is
given by:
IT = log

1 + y
2
hs,d
2 +
hr,d
2
(11.22)
The outage event IT < R is deﬁned by
hs,d
2 +
hr,d
2 < (2R −1)/(y/2).
By using the result of Fact 2 in Appendix 11.1, for |hi, j|2 exponentially distributed with parameters
σ −2
i, j , the outage probability becomes:
pout
T (y, R) := Pr[IT < R] ∼
2
σ 2
s,dσ 2
r,d
·
2R −1
y
2
(11.23)
11.2.4.2
Orthogonal transmit diversity bound
The transmit diversity bound (11.23) does not take into account the half-duplex constraint. To capture
this effect, we constrain the transmit diversity scheme to be orthogonal. When the source and relay can
cooperate perfectly, an equivalent model to Equation (11.21), incorporating the relay orthogonality

COOPERATIVE DIVERSITY PROTOCOLS
599
constraint, consists of parallel channels:
yd[n] = hs,dxs[n] + nd[n],
n = 0, . . . , N/4
yd[n] = hr,dxr[n] + nd[n],
n = N/4 + 1, . . . , N/2
(11.24)
This pair of parallel channels is utilized half as many times as the corresponding direct transmission
channel, so the source must transmit at twice the spectral efﬁciency in order to achieve the same
spectral efﬁciency as direct transmission.
For each fading realization, the maximum average mutual information can be obtained using
independent complex Gaussian inputs. Allocating a fraction α of the power to xs, and the remaining
fraction ¯α := (1 −α) of the power to xr, the average mutual information is given by:
IP = 1
2log

1 + 2αy
hs,d
2 
1 + 2¯αy
hr,d
2
(11.25)
The
outage
event
IP < R
is
equivalent
to
the
outage
region
α|as,d|2 + ¯α|ar,d|2 +
2α ¯αy|hs,d|2|hr,d|2 < (22R −1)/2y, and for high-SNR in Rayleigh fading, using the result of
Equality 2 in Appendix 11.1, with u = α
hs,d
2, v = ¯α
hr,d
2, λu = 1/(ασ −2
s,d ), λv = 1/(¯ασ −2
r,d ),
ε = (22R −1)/(2y), t = 22R −1, we have:
pout
P (y, R) : = Pr[IP < R] ∼
1
4α ¯ασ 2
s,dσ 2
r,d
· 22R[2R ln(2) −1] + 1
y2
(11.26)
which is minimized for α = 1/2, yielding:
pout
P (y, R) ∼
1
σ 2
s,dσ 2
r,d
· 22R[2Rln(2) −1] + 1
y2
(11.27)
11.2.4.3
Incremental relaying
The protocols operate at spectral efﬁciency R when the source-destination transmission is successful,
and spectral efﬁciency R/2 when the relay repeats the source transmission. Thus, we examine outage
probability as a function of SNR and the expected spectral efﬁciency ¯R.
For incremental amplify-and-forward, the outage probability as a function of SNR and R is given
by:
pout
I AF(y, R) = Pr [ID < R] Pr [IAF < R/2 |ID < R ] = Pr [IAF < R/2]
= Pr

hs,d
2 + 1
y f

y
hs,r
2 , y
hr,d
2
< g(y)

(11.28)
where ID, IAF and f(•,•) are given in Section 11.2.3 and g(y) = [2R −1]/y = 1/Y. The second
equality follows from the fact that the intersection of the direct and amplify-and-forward outage
events is exactly the amplify-and-forward outage event at half the rate. Furthermore, the expected
spectral efﬁciency can be computed as:
¯R = RPr

|hs,d|2 ≥1
Y

+ R
2 Pr

|hs,d|2 < 1
Y

= R exp

−1
Y

+ R
2

1 −exp

−1
Y

= R
2

1 + exp

−1
Y

:= hY(R)
(11.29)
where the second equality follows from substituting standard exponential results for |hs,d|2.
A ﬁxed value of ¯R can arise from several possible R, depending upon the value of SNR. We deﬁne
a function ˜h−1
Y ( ¯R) := min h−1
Y ( ¯R) to capture a useful mapping from ¯R to R.
For fair comparison with protocols without feedback, we characterize a modiﬁed outage expression
in the large-SNR regime. Speciﬁcally, we compare outage of ﬁxed and selection relaying protocols

600
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
to the modiﬁed outage pout
I AF(y, ˜h−1
Y ( ¯R). For large SNR, we have:
pout
I AF(y,˜h−1
Y ( ¯R) ∼

1
2σ 2
s,d
σ 2
s,r + σ 2
r,d
σ 2
s,rσ 2
r,d

·

2 ¯R −1
y
2
(11.30)
where we have combined the results of Equality 1 and 3 in Appendix 11.1.
11.3
DISTRIBUTED SPACE–TIME CODING
11.3.1
System description
The next unavoidable question within this chapter is that of how well the concept of space–time
coding can be implemented in a distributed way where the pull of transmitting antennas is formed by
simultaneously using anntenas from different users that are not collocated at the same point in the
network.
We illustrate transmission protocol for such a system by again using the TDD scheme, although
the same concept could be implemented with frequency-division duplexing (FDD) mode as well.
In a TDD system, each frame is subdivided into consecutive time slots as shown in Figure 11.6
which is obtained by further elaboration of Figure 11.5. In the ﬁrst slot, S (source) transmits and
R (relay) receives. In the second slot, S and R transmit simultaneously. D (destination) can be in a
listening mode in both time slots or only in the second slot. Here we assume that in the second time
slot, S and R transmit using a block Alamouti scheme (see, for example, Chapter 4), as if they were
the two antennas of a single node. The extension to other space–time coding techniques is almost
straightforward. Of course there are differences between conventional space time coding (STC) and
the distributed (DSTC) concept. First of all, regenerative relays might make decision errors, so that
the symbols transmitted from R could be affected by errors. Then, the links between S and D and
between R and D do not have the same statistical properties. Also, even if S and R are synchronous,
their packets might arrive at D at different times, as S and R are not colocated.
As before, we denote with hkn
sd(i), hkn
sr (i), and hkn
rd(i), the channel impulse responses between S
and D, S and R, and R and D, respectively, during the time slot indexed with κn; i is the block index.
Each block of symbols s(i) has size M and it is linearly encoded, so as to generate the N-size vector
xs(n) := Fs(n), where F is the N × M precoding matrix. All channels are ﬁnite-impulse response
(FIR) of (maximum) order Lh and time invariant over at least a pair of consecutive blocks. So, a CP
(cyclic preﬁx) of length L ≥Lh is inserted at the beginning of each block, to facilitate elimination of
interblock interference (IBI), synchronization, and channel equalization at the receiver.
As shown in Figure 11.6, during the ﬁrst time slot, S sends, consecutively, the two N-size infor-
mation symbol blocks s(i) and s(i + 1). The blocks are linearly encoded using the precoding matrix
Time slot 1
Time slot 2
i
1
i +
2
i +
3
i +
(a)
( )
s i
(
)1
s i+
1
( )i
α Fs
1
(
1)
i
α
∗
+
Gs
(b)
S
2 ˆ(
1)
i
α
+
Fs
2
ˆ ( )i
α
∗
−
Gs
(c)
R
(
)
S
R,D
→
(
)
S,R
D
→
Figure 11.6 Structure of transmit slots: (a) time slots and block indices; (b) information
blocks sent by S; and (c) information blocks sent by R.

DISTRIBUTED SPACE–TIME CODING
601
F, so that the corresponding transmitted blocks are xs(n) := Fss(n), with n = i, i + 1. Within this
time slot, the destination may be in a listening mode or not. After removing the guard interval at the
receiver, the N-size vectors yd(n) and yr(n) received from D and R are, respectively
yd(n) = Hkn
sdFn
s s(n) + nd(n),
n = i, i + 1
yr(n) = Hkn
sr Fn
s s(n) + nr(n),
n = i, i + 1
(11.31)
where nr(n) and nd(n) are the additive-noise vectors in R and D, respectively. The channel matrices
Hkn
sd and Hkn
sr , thanks to the insertion of the CP, are N × N circulant Toeplitz matrices, with entries
Hkn
sd(i, j) = hkn
sd((i −j)modN) and Hkn
sr (i, j) = hkn
sr ((i −j)modN), respectively. Because of their
circulant and Toeplitz structure, Hkn
sd and Hkn
sr are diagonalized as follows: Hkn
sd = Wkn
sdW H and
Hkn
sr = Wkn
sr W H, where W is the N × N IFFT matrix with {W}kl = e j2πkl/N/
√
N, whereas kn
sr
and kn
sd are the N × N diagonal matrices, whose entries are 	kn
sr (k, k) = Lh−1
l=0
hkn
sr (l)e−j2πlk/N and
	kn
sd(k, k) = Lh−1
l=0
hkn
sd(l) e−j2πlk/N, respectively.
The relay node decodes the received vectors and provides the estimated vectors ˆs(i) and ˆs(i + 1).
During the successive time slot, S and R transmit simultaneously, using the Alamouti block code.
Speciﬁcally, with reference to Figure 11.6, in the ﬁrst half of the second time slot, S transmits xs(i +
2) = α1Fs(i) and R transmits xr(i + 2) = α2Fˆs(i + 1). In the second half, S transmits xs(i + 3) =
α1Gs*(i + 1) while R transmits xr(i + 3) = −α2Gˆs∗(i). To guarantee maximum spatial diversity,
the two matrices G and F are related to each other by G = J F*, as in [31], where J is a time-
reversal (plus a one-chip cyclic shift) matrix. If N is even, J has all null entries except the elements
of position (1,1) and (k, N −k + 2), with k = 2, . . . , N, which are equal to 1. If N is odd, J is the
antidiagonal matrix. The two real coefﬁcients α1 and α2 are related to each other by α2
1 + α2
2 = 1.
They are introduced in order to have a degree of freedom in the power distribution between S and R,
under a given total transmit power in order to minimize the ﬁnal average BER.
After discarding the CP, the blocks received by D in the two consecutive time slots i + 2 and i + 3
are
yd(i + 2) = α1Hki +2
sd
Fs(i) + α2Hki +2
rd
Fˆs(i) + nd(i + 2)
yd(i + 3) = α1Hki +2
sd
Gs∗(i) −α2Hki +2
rd
Gˆs∗(i) + nd(i + 3)
(11.32)
where Hkn
sd and Hkn
rd represent the channels between S and D, and between R and D, respectively.
Exploiting again the diagonalizations Hkn
sd = Wkn
sdW H and Hkn
rd = Wkn
rdW H, if we premultiply in
Equation (11.32) yd(i + 2) by W H and y∗
d(i + 3) by W T , we get:
WHyd(i + 2) = α1ki +2
sd
˜Fs(i) + α2ki +2
rd
˜Fˆs(i) + WHnd(i + 2)
WTy∗
d(i + 3) = α1ki +2
sd
˜G∗s(i) −α2ki +2∗
rd
˜G∗ˆs(i) + WTn∗
d(i + 3)
(11.33)
where ˜F := W HF and ˜G := W T G. For the sake of simplicity, we assume that orthogonal frequency-
division multiplexing (OFDM) is performed at both S and R nodes, so that N = M, F = W, and
thus, ˜F = In and G = W. We also introduce the orthogonal matrix:
kn :=
α1kn
sd
α2kn
rd
−α2kn
sd
α1kn∗
sd

(11.34)
such that H
knkn := I2 ⊗¯
2
kn, where ¯
2
kn := α2
1
kn
sd

2
+ α2
2
kn
rd

2
, whereas ⊗denotes the Kro-
necker product. We introduce also the unitary matrix QKn := kn(I2 ⊗¯
−1
kn ), satisfying the relation-
ships QKnH QKn = I2n and QKnHkn = I2 ⊗¯kn. Exploiting the above equalities and multiplying

602
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
the vector u := [(W Hyd(i + 2))T , (W T y*
d (i+3))T ]T by the matrix Qki+2H, we get:

 r(i)
r(i + 1)

:= Qki+2Hu =


 ˜
ki+2
sd

2
−˜
k∗
i+2
sd
˜
ki+2
rd
˜
ki+2
sd
˜
k∗
i+2
rd
 ˜
ki+2
sd

2

s +


 ˜
ki+2
rd

2
˜
k∗
i+2
sd
˜
ki+2
rd
−˜
ki+2
sd
˜
k∗
i+2
rd
 ˜
ki+2
rd

2

ˆs + n
(11.35)
where
s : = [s(i)T, s(i + 1)T]T,
ˆs : = [ˆs(i)T, ˆs(i + 1)T]T,
(11.36)
˜
ki+2
sd
: = α1
ki+2
sd
¯
−1/2
kn
,
˜
ki+2
rd
: = α2
ki+2
rd
¯
−1/2
kn
,
¯n : = [¯nT(i), ¯nT(i + 1)]T = Qki+2H[nT(i + 2), nH(i + 3)]T.
If the two transmit antennas use the same power, i.e. α1 = α2, and there are no decision errors at
the relay node, i.e. ˆs(n) = s(n), n = i, i + 1, the previous equations reduce to the classical block
Alamouti equations discussed in Chapter 4.
Since Qki+2H is unitary, if n is white, ¯n is also white, with covariance matrix Cn = σ 2
n I2N.
Furthermore, since all matrices  appearing in Equation (11.35) are diagonal, the system Equation
(11.35) of 2N equations can be decoupled into N independent systems of two equations in two
unknowns, each equation representing a single subcarrier. Introducing the vectors rk := [rk(i),rk(i +
1)]T, sk := [sk(i), sk(i + 1)]T, ˆsk:= [ˆsk(i), ˆsk(i+1)]T, and ¯nk := [¯nk(i), ¯nk(i+1)]T, representing the
kth subcarrier, with k = 0, . . . , N −1 [for simplicity of notation, we drop the block index and set
˜	sd = ˜	
ki+2
sd (k, k) and ˜	rd = ˜	
ki+2
rd (k, k)], Equation (11.35) is equivalent to
rk =
  ˜	sd
2 −˜	∗
sd ˜	rd
˜	sd ˜	∗
rd
 ˜	sd
2
 
sk +

 ˜	rd
2
˜	∗
sd ˜	rd
−˜	sd ˜	∗
rd
 ˜	rd
2
 
ˆsk + ¯nk.
(11.37)
where rk represents a sufﬁcient statistic for the decision on the transmitted symbol vector sk.
Due to synchronization error, in general, the blocks transmitted from S and R arrive at D at different
times. However, if the difference in arrival times τd is incorporated in the CP used from both S and
R, D is still able to get N samples from each received block, without IBI.
If due to synchronization error, the block coming from S arrives with a delay of Ld samples, with
respect to arrival instant from R, the only difference, with respect to the case of perfect synchronization,
is that the transfer function ˜	sd(k) in Equation (11.37) will be substituted by ˜	sd(k)e−j2π Ldk/N. Such
a substitution does not affect the useful term, but only affects the interfering term. The price paid for
this robustness is the increase of the CP length L, which, in its turn, reﬂects into a rate loss. However,
this loss can be made small by choosing a block length N much greater than L, or by selecting only
relays that are relatively close to the source, so as to make the relative delay small.
The ML detector would assume the knowledge, at the destination node, of the set of error
probabilities pe1(k) and pe2(k) at the relay, with k = 0, . . . , N −1. If this knowledge is not available,
a suboptimum scalar detector can be implemented, instead of the ML detector. In the case of BPSK
modulation the decision on the transmitted symbol sk(n) can be simply obtained as:
ˆs(n) = sign{Re[r(n)]},
n = i, i + 1
(11.38)
For high signal-to-noise ratio (SNR) at the relay (i.e., when R makes no decision errors), the
symbol-by-symbol decision in D becomes optimal and, thus, the decoding rule (11.38) provides
the same performance as the optimal receiver. When the decision errors at the relay side cannot be
neglected, the suboptimal receiver introduces a ﬂoor in the BER curve, because the symbol-by-symbol
decision treats the wrong received symbols as interference. A cognitive radio should make the choice
between the decoding rules as a tradeoff between performance and computational complexity (power
consumption), taking into account the need for the ML detector to make available, at the destination
node, the error probabilities of the relay node.

DISTRIBUTED SPACE–TIME CODING
603
Whereas in conventional STC, the transmit antennas typically use the same power over all the
transmit antennas, with DSTC, it is useful to distribute the available power between source and relay
as a function of their relative position with respect to the ﬁnal destination, since they are not colocated.
11.3.2
BER analysis in DSTC
For error-free Source to Relay link, using the same derivations introduced in Section 11.3.1, a symbol-
by-symbol detector is the optimal detector, and the signal-to-noise ratio on the kth symbol in the nth
block is:
SNRk(n) = yk(n) = A2
σ 2
n
	ki
sd(k, k)

2
+ α
	
ki+2
sd (k, k)

2
+ (1 −α)
	
ki+2
rd (k, k)

2
(11.39)
with k = 0, 1, . . . , N −1; n = i, i + 1, and α = α2
1. We assume that the variance of the channel-
impulse-response coefﬁcients is proportional to 1/d2r, with r ≥1, where d is the distance of the link
and calculate the BER for fast and slow fading channel.
In fast-fading ki
sd(k, k), 
ki+2
sd (k, k), and 
ki+2
rd (k, k) are independent. The error probability for
BPSK, conditioned to a given channel realization, is given by:
Pe/h(k) = 1
2erfc(
!
0.5yk)
(11.40)
where yk is given by Equation (11.39). For each subcarrier k, yk is given by the sum of three
statistically independent random variables, each one distributed according to a χ2 pdf with two
degrees of freedom. Thus, the BER Pb averaged over the channel realizations is [32]:
Pb = 1
2
Q
"
k=1
πk

1 −
#
γk
1 + γk

(11.41)
where Q = 3, and
πk : =
Q
$
i̸=k=1
γi
γi −γk
;
γ1 := A2
σ 2
n
˜σ 2
h
dr
sd
;
γ2 := A2
σ 2
n
α ˜σ 2
h
dr
sd
γ3 := A2
σ 2
n
(1 −α) ˜σ 2
h
dr
sd
;
˜σ 2
h = σ 2
h (Lh + 1).
The optimal value of α can be found by minimizing Equation (11.41).
In slow-fading 	ki
sd(k, k) = 	
ki+2
sd (k, k) and 	ki
rd(k, k) = 	
ki+2
rd (k, k), the yk on the kth bit of the
received block is:
yk(n) = A2
σ 2
n

(1 + α)
	ki
sd(k, k)

2
+ (1 −α)
	
ki+2
rd (k, k)

2
(11.42)
and the BER averaged over the channel realizations is given by (11.41), with Q = 2 and
γ1 := A2
σ 2
n
(1 + α) ˜σ 2
h
dr
sd
,
γ2 := A2
σ 2
n
(1 −α) ˜σ 2
h
dr
rd
.
For source to relay link with errors the decision on the transmitted symbol sk(i) is performed by
taking a hard decision on
rk(i) =
 ˜	
ki+2
sd

2
sk(i) +
 ˜	
ki+2
rd

2
ˆsk(i) + ˜	
k∗
i+2
sd
˜	
ki+2
rd ˆsk(i + 1) −˜	
k∗
i+2
sd
˜	
ki+2
rd sk(i + 1) + ˜nk(i)
(11.43)
where ˜	
ki+2
sd
:= ˜	
ki+2
sd (k, k); ˜	
ki+2
rd
:= ˜	
ki+2
rd (k, k). In the sequel we use the following notation for
the possible events: H1={ˆsk(i) = sk(i); ˆsk(i + 1) = sk(i + 1)}; H2 = {ˆsk(i) = −sk(i); ˆsk(i + 1) =
sk(i+1)}; H3 = {ˆsk(i)= sk(i); ˆsk(i+1) = −sk(i + 1)}; H4 = {ˆsk(i)= −sk(i); ˆsk(i+1) = −sk(i + 1)};
and ϵ1,1 = {sk(i)= A; sk(i+1) = A}; ϵ1,−1 = {sk(i) = A; sk(i + 1) = −A}; ϵ−1,1 = {sk(i) = −A;
sk(i + 1) = A}; ϵ−1,−1 = {sk(i) = −A; sk(i + 1) = −A}. With pe1(k) and pe2(k) the conditional (to
a given channel realization) error probabilities, at the relay node, on sk(l) and sk(2), respectively, we

604
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
have P(H1) = (1 −pe1(k))(1 −pe2(k)), P(H2) = pe1(k)(1 −pe2(k)), P(H3) = (1 −pe1(k))pe2(k),
and P(H2) = pe1(k)pe2(k). Denoting, for simplicity, ui = Rrk(i), and assuming that the informa-
tion symbols are i.i.d. binary phase-shift keying (BPSK) symbols that may assume the values A
or −A with equal probability, the error probability Pe/h(k) on sk(i), conditioned to a given channel
realizations, is:
Pe/h(k) : = 1
4
4
"
j=1
P(Hj)
×[P{ui > 0/ε−1,1, Hj} + P{ui > 0/ε−1,−1, Hj}
(11.44)
+P{ui < 0/ε1,1, Hj} + P{ui < 0/ε1,−1, Hj}].
Setting ˜nk:= Re{˜nk (i)}, we have:
P{ui > 0/ε−1,1, Hj} = P

−
 ˜	
ki+2
sd

2
−
 ˜	
ki+2
rd

2
A + ˜nr > 0

:= 1
2erfc
 Aβk
σn

where βk is given by:
βk =
#
α2
1
	kn
sd(k, k)

2
+ α2
2
	kn
rd(k, k)

2
Using this approach, we ﬁnd:
P{ui > 0/ε−1,1, H1} = 1
2erfc
 Aβk
σn

P{ui > 0/ε−1,−1, H1} = 1
2erfc
 Aβk
σn

P{ui > 0/ε−1,1, H2} = 1
2erfc
 Aδk
σn

P{ui > 0/ε−1,−1, H2}
= 1
2erfc
 Aδk
σn

P{ui > 0/ε−1,1, H3} = 1
2erfc
 A(βk + γk)
σn

P{ui > 0/ε−1,−1, H3} = 1
2erfc
 A(βk −γk)
σn

P{ui > 0/ε−1,1, H4} = 1
2erfc
 A(δk + γk)
σn

P{ui > 0/ε−1,−1, H4} = 1
2erfc
 A(δk −γk)
σn

where δk and γk are deﬁned as:
γk =
2α1α2Re

	kn∗
sd (k, k)	kn∗
rd (k, k)

#
α2
1
	kn
sd(k, k)

2
+ α2
2
	kn
rd(k, k)

2
δk =
α2
1
	kn
sd(k, k)

2
−α2
2
	kn
rd(k, k)

2
#
α2
1
	kn
sd(k, k)

2
+ α2
2
	kn
rd(k, k)

2

GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
605
Figure 11.7 Average BER versus α: (a) without errors at the relay; (b) with errors at the
relay.
Repeating this same approach, we are able to ﬁnd
Pe/h(k) =

1
2erfc

Aβk
!
σ 2
n
 
(1 −pe1(k))(1 −pe2(k)) +

1
2erfc

Aδk
!
σ 2
n
 
×pe1(k)(1 −pe2(k)) +

1
4erfc

A(βk + γk)
!
σ 2
n

+ 1
4erfc

A(βk −γk)
!
σ 2
n
 
(11.45)
×pe2(k)(1 −pe1(k)) +

1
4erfc

A(δk + γk)
!
σ 2
n

+ 1
4erfc

A(δk −γk)
!
σ 2
n
 
pe1(k)pe2(k)
where, for n = i + 2, i + 3
pe1(k) = pe2(k) = 1
2erfc

A
!
σ 2
w(k)

with σ 2
w(k) := σ 2
n /
	kn
sr (k, k)
2 , ki+2 = ki+3.
The average BER can then be obtained by averaging Equation (11.45) over the channel realizations.
As an example, Figure 11.7, shows average BER versus α (setting α = α1 = 1 −α2), for different
values of the distance drd (and thus, of yR) between R and D (all distances are normalized with respect
to the distance dsd between S and D). Figure 11.7(a), shows the ideal case where there are no errors
at the relay node, and Figure 11.7(b), shows average BER as a function of α, but for different values
of the yR at the relay node. We can observe that, as yR decreases, the system tends to allocate less
power to the relay node (the optimal value of α is greater than 0.5), as the relay node becomes less and
less reliable.
11.4
GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
ON COOPERATIVE DIVERSITY
11.4.1
System and channel model
In this section we focus on a wireless network with a set M = 1, 2, . . . , m of transmitting terminals.
Each transmitting source terminal s ∈M has information to transmit to a single destination terminal,
denoted d(s) /∈M, potentially using terminals M −{s} as relays. Thus, there are m cooperating
terminals communicating to d(s). If algorithms require the relays to decode fully the source message,

606
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
phase 1
phase 2
phase 1
phase 2
Figure 11.8 The two phases of cooperative diversity transmission.
1 Transmits
2 Transmits
3 Transmits
2 Repeats 1
1 Repeats 2
1 Repeats 3
3 Repeats 1
3 Repeats 2
2 Repeats 3
m Repeats 1
m Repeats 2
m Repeats 3
m Transmits 1 Repeats m 2 Repeats m
m-1 Repeats m
PHASE 
Time
Frequency
1 Transmits
2 Transmits
3 Transmits
2 Repeats 1
1 Repeats 2
1 Repeats 3
3 Repeats 1
...
...
3 Repeats 2
2 Repeats 3
m Repeats 1
m Repeats 2
m Repeats 3
m Transmits 1 Repeats m 2 Repeats m
m-1 Repeats m
PHASE I
PHASE II
Frequency
Figure 11.9 Repetition-based medium-access control
the decoding set D(s) is the set of relays that can decode the message of source s. In the case of
amplify-and-forward cooperative diversity, D(s) = M −{s}.
Both classes of algorithms consist of two transmission phases, as illustrated in Figure 11.8. In the
ﬁrst phase, the source broadcasts to its destination and all potential relays. During the second phase
of the algorithms, the other terminals relay to the destination, either on orthogonal subchannels in the
case of repetition-based cooperative diversity, or simultaneously on the same subchannel in the case
of space–time-coded cooperative diversity.
An example of channel and subchannel allocations for repetition-based cooperative diversity, in
which relays either amplify what they receive or fully decode and repeat the source signal, is shown
in Figure 11.9.
Channel and subchannel allocations for space-time-coded cooperative diversity, in which relays
utilize a suitable space–time code in the second phase and can therefore transmit simultaneously
on the same subchannel, is illustrated in Figure 11.10. Again, transmission between source s and
destination d(s) utilizes 1/m of the total degrees of freedom in the channel. In contrast to noncooper-
ative transmission and repetition-based cooperative diversity transmission, each terminal, employing
space–time-coded cooperative diversity transmits in 1
2 the total degrees of freedom in the channel. It
is important to keep track of these ratios when normalizing power and bandwidth in the sequel.
During the ﬁrst phase, each potential relay r ∈M −{s} receives
yr[n] = as,rxs[n] + zr[n]
(11.46)

GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
607
1 Transmits
2 Transmits
3 Transmits
Relay
Relay
Relay
m Transmits
Relay
Frequency
( )
1
D
( )
2
D
( )
3
D
( )
m
D
1 Transmits
2 Transmits
3 Transmits
Relay
Relay
Relay
m Transmits
Relay
PHASE I
PHASE II
Time
Frequency
( )
1
D
( )
2
D
( )
3
D
( )
m
D
...
...
Figure 11.10 Space–time-coded channel allocations across frequency and time for m trans-
mitting terminals. For source s, D(s) denotes the set of decoding relays par-
ticipating in a space–time code during the second phase.
in the corresponding subchannel, where xs[n] is the source transmitted signal and yr[n] is the received
signal at relay r. For decode-and-forward transmission, if the SNR is sufﬁciently large for r to decode
the source transmission, then r serves as a decoding relay for the source s, so that r ∈D(s). For
amplify-and-forward transmission, D(s) is the entire set of relays for source s, i.e., D(s) = M −{s}.
The destination receives signals during both phases. During the ﬁrst phase, the received signal at
d(s) is
yd(s)[n] = as,d(s) xs[n] + zd(s)[n]
(11.47)
in the corresponding subchannel. During the second phase, the equivalent channel models are different
for repetition-based and space–time-coded cooperative diversity. For repetition-based cooperative
diversity, the destination receives separate retransmissions from each of the relays r ∈M −{s} and
the received signal at d(s) is
yd(s)[n] = ar,d(s) xr[n] + zd(s)[n]
(11.48)
in the corresponding subchannel, where xr[n] is the transmitted signal of relay r. For space–time-coded
cooperative diversity, all of the relay transmissions occur in the same subchannel and superimpose at
the destination, so that:
yd(s)[n] =
"
r∈D(s)
ar,d(s)xr[n] + zd(s)
(11.49)
in the corresponding subchannel.
Parameter ai ,j captures the effects of path loss, shadowing, and frequency nonselective fading, and
z j[n] represents the effects of receiver noise and other forms of interference in the system. Statistically,
we model ai ,j as zero-mean, independent, circularly symmetric complex Gaussian random variables
with variances 1/λi ,j , so that the magnitudes |ai ,j | are Rayleigh distributed (|ai ,j |2 are exponentially
distributed with parameter λi ,j ), and the phases of ai ,j are uniformly distributed on [0, 2π). z j [n]
is modeled as zero-mean mutually independent, circularly symmetric, complex Gaussian random
sequences with variance N0.
For a continuous-time channel with total bandwidth W hertz available for transmission, the
discrete-time model contains W two-dimensional symbols per second (2D/s). If the transmitting
terminals have an average power constraint in the continuous-time channel model of Pc joules
per second (J/s), this translates into a discrete-time power constraint of P = mPc/W J/2D, since
each terminal transmits in a fraction 1/m of the available degrees of freedom for noncooperative
transmission and repetition-based cooperative diversity. The channel model is parameterized by the
SNR random variables SNR|ai ,j |2, where SNR = mPc/N0W = P/N0 is the SNR without fading.
For space–time-coded cooperative diversity, the terminals transmit in half the available degrees of
freedom, so the discrete-time power constraint becomes 2P/m.

608
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
In addition to SNR, transmission schemes are further parameterized by the spectral efﬁciency R
bits per second per hertz (b/s/Hz) attempted by the transmitting terminals. Throughout this section,
R is the transmission rate normalized by the number of degrees of freedom utilized by each terminal
under noncooperative transmission, not by the total number of degrees of freedom in the channel. In
addition a normalized rate Rnorm deﬁned as
Rnorm =
R
log(1 + SNRσ 2
s,d(s))
(11.50)
will be used. For an AWGN channel with bandwidth (W/m) and SNR given by SN Rσ 2
s,d(s), Rnorm <
1 is the spectral efﬁciency normalized by the maximum achievable spectral efﬁciency, i.e. channel
capacity. Results under (SNR, R) exhibit a tradeoff between the normalized SNR gain and spectral
efﬁciency of a protocol, while results under (SNR, Rnorm) exhibit a tradeoff between the diversity order
and normalized spectral efﬁciency of a protocol. The latter tradeoff, called the diversity-multiplexing
tradeoff, was developed originally in the context of multiple-antenna systems.
11.4.2
Cooperative diversity based on repetition
Since the channel average mutual information Irep is a function of, the coding scheme, the rule for
including potential relays into the decoding set D(s), and the fading coefﬁcients of the channel, it too
is a random variable. The event Irep < R when this mutual information random variable falls below
some ﬁxed spectral efﬁciency R is referred to as an outage event, and the probability of an outage
event, Pr[Irep < R], is referred to as the outage probability of the channel.Since D(s) is a random set,
we have
Pr[Irep < R] =
"
D(s)
Pr[D(s)] Pr[Irep < R |D(s)]
(11.51)
For repetition coding, the random codebook at the source is generated independent and identically
distributed (i.i.d.) circularly symmetric, complex Gaussian; each of the relays employs the exact same
codebook as the source. Conditioned on D(s) being the decoding set, the mutual information between
s and d(s) is:
Irep = 1
m log

1 + SNR|as,d(s)|2 + SN R
"
r∈D(s)
as,d(s)
2

(11.52)
Pr[Irep < R|D(s)] involves |D(s)|+1 independent fading coefﬁcients, so we expect it to decay asymp-
totically in proportion to l/SNR|D(s)|+1. In the sequel, we develop the following high-SNR approxi-
mation:
Pr[Irep < R |D(s)] ∼

2mR −1
SNR
|D(s)|+1
× λs,d(s)
$
r∈D(s)
λr,d(s) ×
1
(|D(s)| + 1)!
(11.53)
(11.52) is expressed in such a way that the ﬁrst term captures the dependence upon SNR and the
second term captures the dependence upon {λi ,j }.
To prove (11.52) we start with the following claim;
Claim 1: If uk, k = 1, 2, . . . , m, are positive, independent random variables with lim inf
ε→0
puk(εu) ≥
λk andpuk(εu) ≤λk then
lim
ε→0
1
εm Pr
 m
"
k=1
uk < ε
 
= 1
m!
m
$
k=1
λk
(11.54)
As an example the exponential distribution satisﬁes both above requirements. More generally,
however, this result suggests that many of our results hold for a much larger class of PDFs, and, in
particular, depend mainly upon properties of the PDFs near the origin.

GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
609
Proof: If sn = m
k=1 uk, n ≤m then
Pr
 m
"
k=1
uk < ε
 
= Pr[sm < ε] =
% ε
0
psm(s)ds = ε
% 1
0
psm(εw)dw
(11.55)
where the last equality results from the change of variables w = s/ϵ. Thus, it is sufﬁcient for us to
compute the limit
lim
ε→0
1
ε(m−1)
% 1
0
psm(εw)dw
(11.56)
By exploiting Fatou’s lemma we get for lower-bound of liminf:
lim inf
ε→0
1
ε(m−1)
% 1
0
psm(εw)dw ≥
% 1
0

lim inf
ε→0
1
ε(m−1) psm(εw)

dw
(11.57)
sm = sm−1+ um, and by independence the PDF of sm is the convolution of the PDFs of sm−1 and um.
Speciﬁcally, since um is positive, we have:
psm(s) =
% s
0
psm−1(s −r)pum(r)dr = s
% 1
0
psm−1(s(1 −y))pum(sy)dy
(11.58)
where the last equality results from the change of variables y = r/s.
Letting
Am(w) = lim inf
ε→0
1
ε(m−1) psm(εw)
(11.59)
and substituting into Equation (11.58), again exploiting Fatou’s lemma, we obtain the recursion
Am(w) = lim inf
ε→0
1
ε(m−1) psm(εw) ≥w
% 1
0

lim inf
ε→0
1
ε(m−2) psm−1(εw(1 −y))

·

lim inf
ε→0
pum(εwy)

dy ≥λmw
% 1
0
A(m−1)(w(1 −y))dy
(11.60)
where the last inequality follows from the initial assumption lim inf
ε→0
puk(εu) ≥λk and substitution of
A(m−1)(w(1 – y)). Beginning with A1(w) ≥λ1, the recursion (11.60) yields:
Am(w) ≥
1
(m −1)!w(m−1)
m
$
k=1
λk
(11.61)
As a result, Equation (11.57) with (11.59) and (11.61) yields
lim inf
ε→0
1
εm Pr[sm < ε] ≥1
m!
m
$
k=1
λk.
(11.62)
To upper-bound the limsup, we obtain a recursive upper bound for the PDF of sm. Letting
Bm(w, ε) = psm(εw), we have
Bm(w, ε) = εw
% 1
0
psm−1(εw(1 −y))pum(εwy)dy ≤ελmw
% 1
0
Bm−1(w(1 −y), ε)dy
(11.63)
where the equality comes from the convolution (11.58), and the inequality follows from the initial
condition puk(εu) ≤λk and substitution of Bm−1(w(l –y)). Beginning with B1(w, ϵ) ≤λ1, Equation
(11.63) yields an upper bound very similar to the lower bound in (11.61), namely
Bm(w, ε) ≤ε(m−1)w(m−1)
1
(m −1)!
m
$
k=1
λk
(11.64)

610
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
Then
lim sup
ε→0
1
ε(m−1)
% 1
0
psm(εw)dw ≤lim sup
ε→0
1
ε(m−1)
% 1
0
Bm(w, ε)dw ≤
1
(m −1)!
m
$
k=1
λk
(11.65)
Together with the fact that, in general, lim inf ≤lim sup, (11.62), and (11.65) yield the desired
result (11.54).
Now we use the result of Claim 1 to obtain a large SNR approximation for Pr[Irep < R|D(s)], the
conditional outage probability for repetition decode-and-forward cooperative diversity for source s
given a set of decoding relays D(s). As in Equation (11.52), Irep is of the form:
Irep = 1
m log

1 + SNR
m
"
k=1
uk

(11.66)
where uk are independent exponential random variables with parameters λk, k = 1, 2, . . . , m. After
some algebraic manipulations, the outage probability reduces to exactly the same form as in Claim 1:
Pr[Irep < R |D(s)] = Pr
 m
"
k=1
uk < ε
 
(11.67)
with ϵ = (2m R – 1)/SNR →0 as SNR →∞. Thus, Claim 1 and continuity yield, for large SNR, the
approximation:
Pr[Irep < R |D(s)] ∼

2mR −1
SNR
m 1
m!
m
$
k=1
λk
(11.68)
If, with the channel allocation illustrated in Figure 11.9, the relays employ independently generated
codebooks, corresponding to utilizing parallel channels, the mutual information would become a sum
of logarithmic terms:
Irep = 1
m
"
r∈{s}∪D(s)
log

1 + SNR
ar,d(s)
2
(11.69)
instead of the log-sum in Equation (11.52), which is larger than (11.52). This means that parallel
channel coding is more bandwidth efﬁcient than repetition coding, as we might expect.
In order to calculate the outage probability deﬁned by Equation (11.51) we now consider the term
Pr[D(s)], the probability of a particular decoding set. As one rule for selecting from the potential
relays, we can require that a potential relay fully decodes the source message in order to participate in
the second phase. Since the realized mutual information between s and r for i.i.d. complex Gaussian
codebooks is given by log

1 + SN R
as,r
2
/m, under this rule we have:
Pr[r ∈D(s)] = Pr[
as,r
2 > (2mR −1)/SNR] = exp
&
−λs,r(2mR −1)/SNR]
'
Moreover, since each potential relay makes its decision independently under the above restrictions,
and the fading coefﬁcients are independent in our model, we have
Pr[D(s)] =
$
r∈D(s)
exp
&
−λs,r(2mR −1)/SNR]
'
×
$
r∈D(s)

1 −exp
&
−λs,r(2mR −1)/SNR]
'	
∼

2mR −1
SNR
m−|D(s)|−1
×
$
r /∈D(s)
λs,r
(11.70)
Note that any selection means by which Pr[r ∈D(s)] ∼1 and (1 −Pr[r ∈D(s)]) µ 1/SNR, for SNR
large, independently for each r, will result in similar asymptotic behavior for Pr [D(s)]. Substituting

GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
611
Figure 11.11 Outage probabilities for repetition-based cooperative diversity (numeric in-
tegration of the outage probability (solid lines) and calculation of the outage
probability approximation (11.71) (dashed lines) versus SNR for different
network sizes m = 1, 3, 5, 7, 9)
(11.53) and (11.70) into (11.51) results in
Pr[Irep < R] ∼

2mR −1
SNR
m
×
$
D(s)
λs,d(s) ×
$
r∈D(s)
λr,d(s)
$
r /∈D(s)
λs,r ×
1
(|D(s)| + 1)!
(11.71)
Figure 11.11 compares the results of numeric integration of the actual outage probability to
computing the approximation (11.71), for an increasing number of terminals with λi ,j = 1. As result
(11.71) and Figure 11.11 indicate, repetition decode-and-forward cooperative diversity achieves full
spatial diversity of order m, the number of cooperating terminals, for sufﬁciently large SNR. However,
the SNR loss due to bandwidth inefﬁciency is exponential in m.
In order further to simplify the summation in (11.71), we note that for a given decoding set D(s),
either r ∈D(s), in which case λr,d (s) appears in the corresponding term in (11.71), or r /∈D(s), in
which case λs,r appears in the corresponding term in (11.71). We, therefore, deﬁne
λr = min{λr,d(s), λs,r},
¯λr = max{λr,d(s), λs,r}
(11.72)
and ¯λs = λs = λs,d(s). Then the product dependent upon {λi ,j } is bounded by
λm ≤λs,d(s)
$
r∈D(s)
λr,d(s)
$
r /∈D(s)
λs,r ≤¯λm
(11.73)
where λ is the geometric mean of the λi and ¯λ is the geometric mean of the ¯λi, for i ∈M. One can see
that the upper and lower bounds in (11.73) are independent of D(s). We also note that the bounds in
(11.73) coincide, i.e., ¯λ = λ, if, though not only if, ¯λi = λi for all i ∈M. Viewing λi ,j as a measure of
distance between terminals i and j, the class of planar network geometries that satisfy this condition
are those in which all the relays lie with arbitrary spacing along the perpendicular bisector between
the source and destination.
Substituting (11.73) into (11.71), gives the following simpliﬁed asymptotic bounds for outage
probability:
Pr[Irep < R] ≥

2mR −1
SNR/λ
m "
D(s)
1
(|D(s)| + 1)!
(11.74)
Pr[Irep < R] ≤

2mR −1
SNR/¯λ
m "
D(s)
1
(|D(s)| + 1)!
(11.75)

612
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
11.4.3
Cooperative diversity using space–time coding
In this case (11.51) becomes
Pr[Istc < R] =
"
D(s)
Pr[D(s)] Pr[Istc < R |D(s)|]
(11.76)
Conditional on D(s) being the decoding set, the mutual information between s and d(s) for random
codebook-generated i.i.d. circularly symmetric, complex Gaussian at the source and all potential
relays can be shown to be
Istc = 1
2 log

1 + 2
m SNR
as,d(s)
2

+ 1
2 log

1 + 2
m SNR
"
r∈D(s)
ar,d(s)
2

(11.77)
Equation (11.77) represents the sum of the mutual information for two ‘parallel’ channels, one
from the source to the destination, and one from the set of decoding relays to the destination.
Again, Pr[Istc < R|D(s)] involves |D(s)| + 1 independent fading coefﬁcients, so we expect it to decay
asymptotically in proportion to l/SNR|D(s)|+1. In the sequel we develop the following high-SNR
approximation
Pr[Istc < R |D(s)] ∼

 22R −1
2SNR/m
|D(s)|+1
× λs,d(s)
$
r∈D(s)
λr,d(s) × A|D(s)|(22R −1)
(11.78)
where
An(t) =
1
(n −1)!
% 1
0
w(n−1)(1 −w)
(1 + tw)
dw,
n > 0
(11.79)
and A0(t) = 1. Equation (11.78) is expressed in such a way that the ﬁrst term captures the dependence
upon SNR and the second term captures the dependence upon {λi ,j }.
To prove Equation (11.78) we ﬁrst notice that in (11.77), Istc is of the form
Istc = 1
2 log

1 + 2
m SNRum

+ 1
2 log

1 + 2
m SNR
m−1
"
k=1
uk

(11.80)
where again uk are independent exponential random variables with parameters λk, k = 1, 2, . . . , m.
If we use notation:
sm−1 =
m−1
"
k=1
uk, t = (22R −1), andε = (22R −1)/(2SNR/m)
then
Pr[Istc < R |D(s)] = Pr

um + sm−1 + 2
m SNRumsm−1 < ε

=
% ε
0
Pr

um <
ε −s
1 + (2SNR/m)s

psm−1(s)ds = ε
% 1
0
Pr

um < ε(1 −w)
1 + tw

psm−1(εw)dw
= ε
% 1
0

1 −exp

−λm
ε(1 −w)
1 + tw

psm−1(εw)dw
(11.81)
Equation (11.81) follows from the change of variables w=s/ϵ, and the last equality follows from
substituting the CDF for um. We now compute
lim
ε→0
1
εm Pr[Istc < R |D(s)] =
1
(m −2)!
m
$
k=1
λm
% 1
0

 1 −w
1 + tw

w(m−2)dw
(11.82)

GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
613
which, provides the large-SNR approximation
Pr[Istc < R |D(s)] ∼

 22R −1
2SNR/m
m
1
(m −2)!
m
$
k=1
λm ×
% 1
0

1 −w
1 + (22R −1)w

w(m−2)dw
(11.83)
To lower-bound the lim inf, we use Fatou’s lemma in Equation (11.81) to obtain:
lim inf
ε→0
1
εm Pr[Istc < R |D(s)] ≥
% 1
0

lim inf
ε→0
1
ε

1 −exp

−λm
ε(1 −w)
1 + tw

·

lim inf
ε→0
1
ε(m−2) psm−1(εw)

dw =
% 1
0
λm

 1 −w
1 + tw

Am−1(w)dw
≥
1
(m −2)!
m
$
k=1
λk
% 1
0

 1 −w
1 + tw

w(m−2)dw
(11.84)
where the ﬁrst equality follows from properties of exponentials and substitution of Am−1 (w) from
Equation (11.58), and the second equality follows from the result (11.61) in the proof of Claim 1. To
upper-bound the lim sup, we derive
lim sup
ε→0
1
εm Pr[Istc < R |D(s)] ≤lim sup
ε→0
% 1
0
1
ε

1 −exp

−λm
ε(1 −w)
1 + tw

·

1
ε(m−2) Bm−1(w, ε)

dw < lim sup
ε→0
% 1
0

λm

 1 −w
1 + tw

·

1
ε(m−2) Bm−1(w, ε)

dw
≤lim sup
ε→0
% 1
0

λm

 1 −w
1 + tw

·

1
(m −2)!w(m−2)
m−1
$
k=1
λk
(
dw
=
1
(m −2)!
m−1
$
k=1
λk
% 1
0

 1 −w
1 + tw

w(m−2)dw
(11.85)
where the ﬁrst inequality follows from substitution of Bm−1(w, ϵ) from (11.63), the second inequality
follows from he fact that 1 – exp(–x) ≤x for all x ≥0, and the third inequality follows from the result
(11.64) in Claim 1. Taken together with the fact that lim inf < lim sup, Equation (11.84) and (11.85)
yield the desired result, Equation (11.82).
The remaining term in Equation (11.76) to be considered is Pr[D(s)], the probability of a particular
decoding set. As before, we require a potential relay to decode the source message fully in order to
participate in the second phase, a necessary condition for the mutual information expression (11.77)
to be correct. Since the realized mutual information between s and r for i.i.d. complex Gaussian
codebooks is given by
1
2 log

1 + 2
m SNR
as,r
2

(11.86)
under this condition we have
Pr[r ∈D(s)] = Pr

as,r
2 > 22R −1
2SNR/m

= exp

−λs,r
22R −1
2SNR/m

(11.87)
Now, since each potential relay makes its decision independently, and the fading coefﬁcients are
independent, we have
Pr[D(s)] =
$
r∈D(s)
exp

−λs,r
22R −1
2SN R/m

×
$
r /∈D(s)

1 −exp

−λs,r
22R −1
2SNR/m

∼

 22R −1
2SN R/m
m−|D(s)|−1
×
$
r /∈D(s)
λs,r.
(11.88)

614
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
Figure 11.12 Outage probability of space–time-coded cooperative diversity.
Combining (11.78) and (11.88) into (11.76), we obtain
Pr[Istc < R] ∼

 22R −1
2SN R/m
m
×
"
D(s)
λs,d(s) ×
$
r∈D(s)
λr,d(s)
$
r /∈D(s)
λs,r × A|D(s)|(22R −1)
(11.89)
Figure 11.12 presents the results of numeric integration of the actual outage probability and the
approximation (11.89), for an increasing number of terminals with λi ,j = 1. As the result (11.89) and
Figure 11.12 indicate, space–time-coded cooperative diversity achieves full spatial diversity of order
m, the number of cooperating terminals, for sufﬁciently large SNR. In contrast to repetition-based
algorithms, the SNR loss for space–time-coded cooperative diversity is only linear in m.
As in Equations (11.74) and (11.75), we want further to simplify the summation in (11.89). The
product dependent upon {λi ,j } can again be bounded as in Equation (11.73). To avoid dealing with
(11.79), we exploit the bounds
1
(n + 1)!(1 + t) ≤An(t) ≤1
n!
(11.90)
Combining Equations (11.73) and (11.90) into (11.89), we get the following simpliﬁed asymptotic
bounds for outage probability:
Pr[Istc < R] ≥

22R −1
2SNR/(mλ)
m "
D(s)
1
(|D(s)| + 1)!
(11.91)
Pr[Istc < R] ≤

22R −1
2SNR/(m ¯λ)
m "
D(s)
1
|D(s)|!
(11.92)
APPENDIX 11.1 ASYMPTOTIC CDF APPROXIMATIONS
All results from Section 11.2 are of the form
lim
t→t0
Pu(t)(g1(t))
g2(t)
= c
(A11.1.1)

GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
615
where t is a parameter of interest; Pu(t) (g1(t)) is the CDF of a certain random variable u(t) that can,
in general, depend upon t; g1(t) and g2(t) are two (continuous) functions; and t0 and c are constants.
(A11.1.1) implies the approximation Pu(t)(g1(t)) ∼cg2(t) for t close to t0.
Result 1: Let u be an exponential random variable with parameter λu. Then, for a function g(t)
continuous about t = t0 and satisfying g(t) →0 as t →t0
lim
t→t0
1
g(t) Pu(g(t)) = λu
(A11.1.2)
Result 2: Let w = u + v, where u and v are independent exponential random variables with
parameters λu and λv, respectively. Then the CDF
Pw(w) =



1 −


λv
λv −λu

e−λuw +

λu
λu −λv

e−λvw

, λu ̸= λv
1 −(1 + λw)e−λw, λu = λv = λ
(A11.1.3)
satisﬁes
lim
ε→0
1
ε2 Pw(ε) = λuλv
2
.
(A11.1.4)
and
lim
t→t0
1
g2(t) Pw(g(t)) = λuλv
2
(A11.1.5)
if a function g(t) is continuous about t = t0 and satisﬁes g(t) →0 as t→t0,
Equality 1: Let u, v, and w be independent exponential random variables with parameters λu, λv,
and λw, respectively. Let ϵ be positive, and let g(ϵ)>0 be continuous with g(ϵ) →0 and ϵ /g(ϵ) →c
< ∞as ϵ →0. Then for f (x, y) = (xy)/(x + y + l)
lim
t→t0
1
g2(t) Pr[u + εf (v/ε, w/ε) < g(ε)] = λu(λv + λw)
2
(A11.1.6)
and
lim
t→t0
1
g2(h(t)) Pr[u + h(t) f (v/h(t), w/h(t)) < g(h(t))] = λu(λv + λw)
2
(A11.1.7)
if h(t) is continuous about t = t0 and satisﬁes h(t) →0 as t →t0.
The following lemma will be useful in the proof of Equality 1.
Lemma 1: For the following set of parameters: positive δ; rδ:= δ f (v/δ, w/δ), where v and w are
independent exponential random variables with parameters λv and λw, respectively; continuous h(δ)
> 0 with h(δ) →0 and δ/h(δ) →d < ∞as δ →0; probability Pr[rδ <δ] satisﬁes
lim
δ→0
1
h(δ) Pr[rδ < h(δ)] = λv + λw.
(A11.1.8)
Proof of Lemma 1: First we look at the lower bound
Pr[rδ < h(δ)] = Pr[1/v + 1/w + δ/(vw) > 1/h(δ)]
> Pr[1/v + 1/w > 1/h(δ)] ≥Pr[max(1/v,1/w) > 1/h(δ)]
(A11.1.9)
= 1 −Pr[v ≥h(δ)] Pr[w ≥h(δ)] = 1 −exp[−(λv + λw)h(δ)]
so, by using Result 1 we have
lim
δ→0
1
h(δ) Pr[rδ < h(δ)] ≥λv + λw
(A11.1.10)

616
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
To prove the other direction, let l > 1 be a ﬁxed constant:
Pr[rδ < h(δ)] = Pr[1/v + 1/w + δ/(vw) > 1/h(δ)]
=
% ∞
0
Pr

1/v > 1/h(δ) −1/w
1 + δ/w

pw(w)dw
(A11.1.11)
≤Pr[w < lh(δ)] +
% ∞
lh(δ)
Pr

1/v > 1/h(δ) −1/w
1 + δ/w

pw(w)dw
But
Pr[w < lh(δ)]/h(δ) ≤λwl
(A11.1.12)
which takes care of the ﬁrst term of Equation (A11.1.11). To bound the second term of (A11.1.11),
let k > l be another ﬁxed constant, and note that
% ∞
lh(δ)
Pr [1/v > (1/h(δ) −1/w) / (1 + δ/w)]pw(w)dw =
(A11.1.13)
=
% ∞
kh(δ)
Pr

1
v > 1/h(δ) −1/w
1 + δ/w

pw(w)dw +
% kh(δ)
lh(δ)
Pr

1
v > 1/h(δ) −1/w
1 + δ/w

pw(w)dw
≤Pr

1
v >
1 −1/k
h(δ) + δ/k

+ λw
% kh(δ)
lh(δ)
Pr

1
v > 1/h(δ) −1/w
1 + δ/w

pw(w)dw
where the ﬁrst term in the bound of Equation (A11.1.13) follows from the fact that
Pr [1/v > (1/h(δ) −1/w) / (1 + δ/w)] is nonincreasing in w, and the second term in the bound of
(A11.13) follows from the fact that pw(w) = λw exp(−λww) ≤λw. Now, the ﬁrst term of (A11.1.13)
satisﬁes
Pr

1/v >
1 −1/k
h(δ) + δ/k

/h(δ) ≤1 + δ/(kh(δ))
1 −1/k
(A11.1.14)
and, by a change of variable w’ = w/h(δ), the second term of (A11.1.13) satisﬁes
1
h(δ)
% kh(δ)
lh(δ)
Pr

1/v > 1/h(δ) −1/w
1 + δ/w

dw =
= h(δ)
% k
l
1
h(δ)

1 −exp

−λv(h(δ) + δ/w′)
(1 −1/w′)

dw′
≤h(δ)
% k
l
λv
1 + δ/(w′h(δ))
(1 −1/w′)

dw′



B(δ,h(δ),k,l)
(A11.1.15)
where B(δ, h(δ), k, l) remains ﬁnite for any k > l > 1 as δ →0.
Combining Equation (A11.1.12), (A11.1.14), and (A11.1.15), gives
1
h(δ) Pr [rδ < h(δ)] ≤λwl + λv
1 + δ/(kh(δ))
1 −1/k

+ h(δ)B(δ, h(δ), k,l)
(A11.1.16)
and
lim sup
δ→0
1
h(δ) Pr [rδ < h(δ)] ≤λwl + λv
1 + d/k
1 −1/k

since limδ→0 B(δ, h(δ), k,l) < ∞and, by assumption, h(δ) →0 and δ/h(δ) →d as δ →0. The
constants k > l > 1 are arbitrary. In particular, k can be chosen arbitrarily large, and l arbitrarily close
to 1. Hence,
lim sup
δ→0
1
h(δ) Pr [rδ < h(δ)] ≤λw + λv
(A11.1.17)
Combining Equation (A11.1.10) with (A11.1.17), the lemma is proved.

GENERALIZATION OF DISTRIBUTED SPACE–TIME-CODING BASED
617
Proof of Equality 1:
Pr[u + εf (v/ε, w/ε) < g(ε)] = Pr[u + rε < g(ε)] =
% g(ε)
0
Pr [rε < g(ε) −u]pu(u) du
= g(ε)
% g(ε)
0
Pr
&
rε < g(ε)(1 −u′)
'
λu e−λu g(ε)u′ du′
= g2(ε)
% 1
0
(1 −u′)Pr
&
rε < g(ε)(1 −u′)
'
g(ε)(1 −u′)
× λu e−λu g(ε)u′ du′
(A11.1.18)
where in the second equality we have used the change of variables u′= u/g(ϵ). But by Lemma 1 with
δ = ϵ and h(δ) = g(δ)(l – u′), the quantity in brackets approaches λv+ λw as ε →0, so we expect
lim
ε→0
1
g2(ε) Pr[u + rε < g(ε)] = λu(λv + λw)
% 1
0
(1 −u)du = λu(λv + λw)
2
(A11.1.19)
To verify Equation (A11.1.19), fully we must utilize the lower and upper bounds developed in
Lemma 1. Using the lower bound (A11.1.10), (A11.1.18) satisﬁes
lim inf
ε→0
1
g2(ε) Pr[u + rε < g(ε)] ≥lim
ε→0
% 1
0
1 −exp[−(λv + λw)g(ε)(1 −u′)]
g(ε)
×λu e−λu g(ε)u′du′ = λu(λv + λw)
% 1
0
(1 −u′)du′ = λu(λv + λw)
2
(A11.1.20)
where the ﬁrst equality results from the Dominated Convergence theorem [29] after noting that the
integrand is both bounded by and converges to the function λu(λv + λw)(l −u′). Using the upper
bound (A11.1.17), Equation (A11.1.18) satisﬁes
lim sup
ε→0
1
g2(ε) Pr[u + rε < g(ε)]
≤lim sup
ε→0
(λv/(1 −1/k) + λwl)
% 1
0
(1 −u′)λu e−λu g(ε)u′ du′
+ lim sup
ε→0
ε/g(ε)
% 1
0
λvλu e−λu g(ε)u′/(k −1) du′
+ lim sup
ε→0
g(ε)D(ε, g(ε), k,l)
(A11.1.21)
where the last equality results from the fact ϵ /g(ϵ)→c and the fact that D(ε, g(ε), k,l) :=
- 1
0 (1 −u′)2B(ε, g(ε)(1 −u′), k,l)λue−λu g(ε)u′du′remains ﬁnite for all k > l > 1 even as ϵ →0.
Again, the constants k > l > 1 are arbitrary. In particular, k can be chosen arbitrarily large, and l
arbitrarily close to 1. Hence,
lim sup
ε→0
1
g2(ε) Pr[u + rε < g(ε)] ≤λu(λv + λw)
2
(A11.1.22)
Combining Equation (A11.1.21) and (A11.1.22) completes the proof.
Equality 2: Let u and v be independent exponential random variables with parameters λu and λv,
respectively. Let ϵ be positive and let g(ϵ) > 0 be continuous with g(ϵ) →0 as ϵ →0. Then for
h(ε) := ε2[(g(ε)/ε + 1) ln(g(ε)/ε + 1) −g(ε)/ε]
(A11.1.23)
we have
lim
ε→0
1
h(ε) Pr[u + v + uv/ε < g(ε)] = λuλv
(A11.1.24)
and
lim
t→t0
1
h(ε(t)) Pr[u + v + uv/ε(t) < g(ε(t))] = λuλv
(A11.1.25)
if ϵ(t) is continuous about t = t0 with ϵ(t) →0 as t →t0.

618
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
Proof: First, we write CDF in the form
Pr[u + v + uv/ε < g(ε)]
=
% ∞
0
Pr[u + v + uv/ε < g(ε) |v = v]pv(v) dv
=
% g(ε)
0
Pr

u < g(ε) −v
1 + v/ε
 v = v

λv e−λvv dv
(A11.1.26)
=
% g(ε)
0

1 −exp

−λu

 g(ε) −v
1 + v/ε

λv e−λvv dv
= g(ε)
% 1
0

1 −exp

−λu

 g(ε)(1 −w)
1 + g(ε)w/ε

λv e−λvg(ε)w dw
where the last equality follows from the change of variables w = v/g(ϵ). To upper-bound Equation
(A11.1.26), we use the identities 1 – e−x ≤x for all x ≥0 and e−y ≤1 for all y ≥0, so that (A11.1.26)
becomes
Pr[u + v + uv/ε < g(ε)] ≤g2(ε)λuλv
% 1
0
1 −w
1 + g(ε)w/ε dw
= λuλvg2(ε)(g(ε)/ε + 1) ln(g(ε)/ε + 1) −g(ε)/ε
(g(ε)/ε)2
= λuλvh(ε)
and
lim sup
ε→0
1
h(ε) Pr[u + v + uv/ε < g(ε)] ≤λuλv.
(A11.1.27)
To lower-bound Equation (A11.1.26), we use the concavity of 1 −e−x, i.e. for any t > 0,
1 −e−x ≥((1 −e−t)/t)x, for all x ≤t and the identity e−y ≥1 −y for all y ≥0, so that Equation
(A11.26) becomes
Pr[u + v + uv/ε < g(ε)]
≥g(ε)
% 1
0

1 −e−λu g(ε)
λug(ε)
 λug(ε)(1 −w)
1 + wg(ε)/ε

λv(1 −λvg(ε)w) dw
= λuλvg2(ε)
1 −e−λu g(ε)
λug(ε)

×
% 1
0

1 −w
1 + wg(ε)/ε

(1 −λvg(ε)w) dw
≥λuλvg2(ε)
1 −e−λu g(ε)
λug(ε)

(1 −λvg(ε)) ×
% 1
0
1 −w
1 + wg(ε)/ε dw
= λuλvg2(ε)
1 −e−λu g(ε)
λug(ε)

(1 −λvg(ε)) × (g(ε)/ε + 1) ln(g(ε)/ε + 1) −g(ε)/ε
(g(ε)/ε)2
= λuλv
1 −e−λu g(ε)
λug(ε)

(1 −λvg(ε))h(ε)
and
lim inf
ε→0
1
h(ε) Pr[u + v + uv/ε < g(ε)]
≥λuλv lim
ε→0
1 −e−λu g(ε)
λug(ε)

(1 −λvg(ε)) = λuλv
(A11.1.28)
Since the bounds in Equations (A11.1.27) and (A11.1.28) are equal, Equality 2 is
proved.

APPENDIX 11.2 AMPLIFY-AND-FORWARD MUTUAL INFORMATION
619
Equality 3: For ft(s)→g{s) pointwise as t →t0, and ft(s) monotone increasing in s for each t let
ht(s) be such that ht(s) ≤s, ht(s) →s pointwise as t →t0, and ht(s)/s is monotone decreasing in s for
each t. For ˜h−1
t (r) := min h−1
t (r) we have
lim
t→t0 ft(˜h−1
t (r)) = g(r).
(A11.1.29)
Proof: Since ht(s) ≤s for all t, we have r ≤˜h−1
t (r), and consequently ft(r) ≤ft(˜h−1
t (r)) because
ft(*) is monotone increasing. Thus,
lim inf
t→t0
ft(˜h−1
t (r)) ≥g(r).
(A11.1.30)
For upper bound ﬁx δ > 0. Lemma 2 shows that for each r there exists t* such that ˜h−1
t (r) ≤
r/(1 −δ) for all t such that |t −t0| < |t* −t0|. So
ft(˜h−1
t (r)) ≤ft(r/(1 −δ))
and
lim sup
t→t0
ft(˜h−1
t (r)) ≤g(r/(1 −δ)).
Since δ can be made arbitrarily small we have
lim sup
t→t0
ft(˜h−1
t (r)) ≤g(r).
(A11.1.31)
Combining (A11.1.30) with (A11.1.31), we obtain the desired result.
The following Lemma is used in the proof of the upper bound of Equality 3.
Lemma 2: For ht(s) such that ht(s) ≤s, ht(s) →s pointwise as t →t0, and ht(s)/s is monotone
decreasing in s for each t, deﬁne ˜h−1
t (r) := min h−1
t (r). For each r0 > 0 and any δ > 0, there exists
t* such that ˜h−1
t (r) ≤r0/(1 −δ) for all t such that |t −t0| < |t ∗−t0|.
Proof: Fix r0 > 0 and δ > 0, and select s0 such that s0 > r0/(l −δ).
Because ht(s)/s →1 point-wise as t→t0, for each s > 0 and any δ > 0, there exists a t* such that
ht(s) ≥s(1 −δ), all t : |t–t0| < |t ∗−t0|.
Also, since ht(s)/s is monotone decreasing in s, if t* is sufﬁcient for convergence at s0, then it is
sufﬁcient for convergence at all s ≤s0. Thus, for any, s0 > 0 and δ > 0 there exists a t* such that
ht(s) ≥s(1 −δ), all s ≤s0, t: |t −t0| < |t* −t0|.
In the rest of the proof, we only consider s ≤s0 and t such that |t −t0| < |t ∗−t0|. Consider the
interval I = [r0, r0/(l −δ)], and note that s ∈I implies s < s0. Since ht(s)< s, wehave ht(r0) < r0.
Also, since ht(s) > s(l −δ) by the above construction, we have ht(r0/(l −δ)) > r0. By continuity,
ht(s) assumes all intermediate values between ht(r0) and ht(r0/(l −δ)) on the interval (r0, r0/(l −δ))
[30, Theorem 4.23]; in particular, there exists an s1 ∈(r0, r0/(l −δ)) such that ht(x1)= r 0. The result
follows from ˜h−1
t (r) ≤x ≤r0/(1 −δ), where the ﬁrst inequality follows from the deﬁnition of ˜h−1
t (·)
and the second inequality follows from the fact that x1 ∈I.
APPENDIX 11.2 AMPLIFY-AND-FORWARD MUTUAL
INFORMATION
We write the equivalent channel (11.5–6), with relay processing, in vector form as
yd [n] = hxs [n] + Bn [n]

620
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
where
yd [n] =

yd[n]
yd[n + N/4]

;
h =

hs,d
hr,dβhs,r




H
B =

 0
1
0
hr,dβ
0
1




B
;
n [n] =


nr[n]
nd[n]
nd[n + N/4]





n[n]
The source signal has power constraint E [xs] ≤Ps, and relay ampliﬁer has constraint
β ≤
.
Pr
hs,r
2 Ps + Nr
(A11.2.1)
and the noise has covariance E [nnT] = diag(Nr, Nd, Nd). Since the channel is memoryless, the
average mutual information satisﬁes
IAF ≤I(xs; yd) ≤log det

I + (PshhT )(BE[nnT ]BT )−1	
with equality for xs, zero-mean, circularly symmetric complex Gaussian. Noting that
hhT =

hs,d
2
hs,d(hr,dβhs,r)∗
h∗
s,dhr,dβhs,r
hr,dβhs,r
2
 
BE[nnT ]BT =

Nd
0
0
hr,dβ
2 Nr + Nd

we have
det

I2 + (PshhT )(BE[nnT ]BT )−1	
= 1 + Ps
hs,d
2
Nd
+
Ps
hr,dβhs,r
2
hr,dβ
2 Nr + Nd

(A11.2.2)
Because (A11.2.2) is increasing in β, the ampliﬁer power constraint (A11.2.1) should apply,
yielding,
IAF = log(1 +
hs,d
2 ys,d + f
hs,r
2 ys,r,
hr,d
2 yr,d

where ya,b = SN Ra,band is f (·, ·) given in Section 11.2.3
APPENDIX 11.3 INPUT DISTRIBUTIONS FOR TRANSMIT DIVERSITY BOUND
An equivalent channel model for the two-antenna case can be summarized as
y[n] =
& h1 h2
'
  
h

 x1[n]
x2[n]




x[n]
+n[n]
(A11.3.1)
where h represents the fading coefﬁcients and x[n] the transmit signals from the two transmit antennas,
and n[n] is a zero-mean, white complex Gaussian process with variance N0 that captures the effects
of noise and interference. If Q = E[xxT] is the covariance matrix for the transmit signals, then the
power constraint on the inputs may be written in the form tr( Q) ≤P.

REFERENCES
621
We want to ﬁnd a distribution on the input vector x, subject to the power constraint, that minimizes
outage probability, i.e.,
min
pX :tr(Q)≤P Pr[I(x; y |h = a ) < R].
(A11.3.2)
The optimization (A11.3.2) can be restricted to optimization over zero-mean, circularly symmetric
complex Gaussian inputs, because Gaussian codebooks maximize the mutual information for each
value of the fading coefﬁcients a, i.e.
min
Q:tr(Q)≤P Pr

log

1 + hQhT
N0

< R

(A11.3.3)
We now argue that Q diagonal is sufﬁcient, even if the components of a are independent but not
identically distributed. We write h = ˜h, where ˜h is a zero-mean, i.i.d. complex Gaussian vector
with unit variances and  = diag(σ1, σ2). Thus, the outage probability in (A11.3.3) may be written
as:
Pr

log

1 +
˜hQT ˜hT
N0

< R

.
Now consider an eigendecomposition of the matrix QT = UDUT , where U is unitary and D
is diagonal. Using the fact that the distribution of ˜h is rotationally invariant, i.e., ˜hU has the same
distribution as ˜h for any unitary U, we observe that the outage probability for covariance matrix
QT is the same as the outage probability for the diagonal matrix D.
For D = diag(d1, d2), the outage probability can be written in the form
Pr

d1 |h1|2 + d2 |h2|2 < 2R −1
SNR

,
which, using Result 2, decays in proportion to 1/(SNR2 det D) for large SNR if d1, d2 ̸= 0. Thus,
minimizing the outage probability for large SNR is equivalent to maximizing
det D = det QT = σ 2
1 σ 2
2 (Q1,1Q2,2 −
Q1,2
2)
(A11.3.4)
such that Q1,1 + Q2,2 ≤P. Clearly, (A11.3.4) is maximized for Q1,1 = Q2,2 = P/2 and Q1,2 =
Q2,1 = 0. Thus, zero-mean, i.i.d. complex Gaussian inputs minimize the outage probability in the
high-SNR regime.
REFERENCES
1. Cover, T. and Gamal, A. E. (1979) Capacity theorems for the relay channel, IEEE Transactions
on Information Theory, IT–25, 572–584.
2. Sendonaris, A., Erkip, E. and Aazhang, B. (2003) User cooperation diversity–Part II: Implemen-
tation aspects and performance analysis, IEEE Transactions on Communications, 51, 1939–1948.
3. Laneman, J. N., Wornell, G. W., and Tse, D. N. C. (2001) An efﬁcient protocol for realizing
cooperative diversity in wireless networks, in Proceedings IEEE ISIT, June 2001, p. 294.
4. Willems, F. M. J. (1983) The discrete memoryless multiple access channel with partially coop-
erating encoders, IEEE Transactions on Information Theory, 29, 441–445.
5. Cover, T. and Leung, C. (1981) An achievable rate region for the multiple-access channel with
feedback, IEEE Transactions on Information Theory, 27, 292–298.
6. Willems, F. and Meulen, E. V. D. (1985) The discrete memoryless multiple-access channel with
cribbing encoders, IEEE Transactions on Information Theory, 31, 313–327.

622
COOPERATIVE DIVERSITY IN COGNITIVE WIRELESS NETWORKS
7. Zeng, C., Kuhlmann, F. and Buzo, A. (1989) Achievability proof of some multiuser channel coding
theorems using backward decoding, IEEE Transactions on Information Theory, 35, 1160–1165.
8. Willems, F. M. J., van der Meulen, E. C., and Schalkwijk, J. P. M. (1983) Achievable rate region
for the multiple access channel with generalized feedback, in Proceedings Annual Allerton
Conference on Communication, Control, Computing, pp. 284–292.
9. Ozarow, L., Shamai, S., and Wyner, A. (1994) Information theoretic considerations for cellular
mobile radio, IEEE Transaction on Vehicular Technology 43, 359–377.
10. van der Meulen, E. C. (1971) Three-terminal communication channels, Advances in Applied
Probability, 3, 120–154.
11. Cover, T. M. and Thomas, J. A. (1991) Elements of Information Theory. Wiley, New York.
12. Slepian, D. S. and Wolf, J. K. (1973) Noiseless coding of correlated information sources, IEEE
Transactions on Information Theory, 19, 471–480.
13. Wyner, A. D. (1975) On source coding with side information at the decoder, IEEE Transactions
on Information Theory, 21, 294–300.
14. Wyner, A. D. and Ziv, J. (1976) The rate-distortion function for source coding with side infor-
mation at the decoder, IEEE Transactions on Information Theory, 22, 1–10.
15. Schein, B. and Gallager, R. G. (2000) The Gaussian parallel relay network, in Proceedings IEEE
International Symposium Information Theory (ISIT), Sorrento, Italy, p. 22.
16. Schein, B. (2001) Distributed Coordination In Network Information Theory, PhD dissertation,
MIT, Cambridge, MA.
17. Gupta, P. and Kumar, P. R. (2001) Toward an information theory of large networks: an achievable
rate region, in Proceedings IEEE International Symposium Information Theory (ISIT), Washing-
ton, DC, p. 150.
18. Gupta, P. and Kumar, P. R. (2003) Toward an information theory of large networks: an achievable
rate region, IEEE Transactions on Information Theory, 49, 1877–1894.
19. Gupta, P. and Kumar, P. R. (2002) On the asymptotic capacity of Gaussian relay networks, in Pro-
ceedings IEEE International Symposium on Information Theory (ISIT), Lausanne, Switzerland,
p. 195.
20. Gastpar, M., Kramer, G. and Gupta, P. (2002) The multiple-relay channel: Coding and antenna-
clustering capacity, in Proceedings IEEE International Symposium Information Theory (ISIT),
Lausanne, Switzerland, p. 136.
21. Kramer, G. and van Wijngaarden, A. J. (2000) On the white Gaussian multiple-access relay
channel, in Proceedings IEEE International Symposium Information Theory (ISIT), Sorrento,
Italy, p. 40.
22. King, R. C. (1978) Multiple Access Channels with Generalized Feedback, PhD. dissertation,
Stanford Univesity, Palo Alto, CA.
23. Carleial, A. B. (1982) Multiple-access channels with different generalized feedback signals, IEEE
Transactions on Information Theory, 28, 841–850.
24. Willems, F. M. J., van der Meulen, E. C. and Schalkwijk, J. P. M. (1983) An achievable rate region
for the multiple access channel with generalized feedback, in Proceedings Allerton Conference
Communications, Control, and Computing, Monticello, IL, pp. 284–292.
25. Willems, F. M. J. (1983) The discrete memoryless multiple access channel with partially coop-
erating encoders, IEEE Transactions on Information Theory, 29, 441–445.

REFERENCES
623
26. Willems, F. M. J. and van der Meulen, E. C. (1985) The discrete memoryless multiple-access
channel with cribbing encoders, IEEE Transactions on Information Theory, 31, 313–327.
27. Sendonaris, A., Erkip, E. and Aazhang, B. (1998) Increasing uplink capacity via user cooper-
ation diversity, in Proceedings IEEE International Symposium on Information Theory (ISIT),
Cambridge, MA, p. 156.
28. Sendonaris, A., Erkip, E., and Aazhang, B. (2003) User cooperation diversity, Part I: System
description, IEEE Transactions on Communications, 51, 1927–1938.
29. Adams, M. and Guillemin, V. (1996) Measure Theory and Probability. Birkh¨auser, Boston, MA.
30. Rudin, W. (1964) Principles of Mathematical Analysis, 2nd ed. McGraw-Hill, New York.
31. Barbarossa, S. and Cerquetti, F. (2001) Simple space–time coded SS-CDMA systems capable of
perfect MUI/ISI elimination, IEEE Communications Letters, 5, 471–473.
32. Proakis, J. (1989) Digital Communications, 3rd ed. McGraw-Hill, New York, p. 783.


12
Cognitive UWB
Communications
12.1
INTRODUCTION
In this chapter we discuss cognitive ultra wide band (CUWB) systems, capable of monitoring and
adapting to the amount and type of interference in the network, like advanced personal area networks
(PAN). In this concept, cognition is used to identify presence and location on the spectral scale of
the interfering signal, generated by other networks coexisting in the same band, and create a corre-
sponding notch to suppress the interference. This enables frequency reuse for different networks and
signiﬁcant increase in overall spectrum efﬁciency. The scheme can be used to improve signiﬁcantly
performance of UWB systems, e.g. high speed Bluetooth, in the presence of interference from mobile
communication systems such as GSM and WCDMA. It is also effective in the presence of WLAN
systems, which are nowadays based on OFDMA technology (e.g., IEEE802.11, 16e, 20) or military
communications where the interference is generated by intentional jamming. We also discuss the
effectiveness of the scheme to suppress MC CDMA, which is a candidate technology for 4G mobile
communications.
Recently WiMedia Alliance has announced that UWB technology has been accepted as the basic
standard for high speed Bluetooth, see http://www.wimedia.org/en/events/index.asp?id=events. The
basic principles of UWB technology have been already discussed in Chapter 8. In addition, the online
source 0 gives historical perspective to ultra wide band (UWB) technologies. It lists the early UWB
references and patents from the 60s and 70s. In 0, a comprehensive overview of ultra wide band
wireless systems is given. It discusses the Federal Communications Commission (FCC) allocation
of the 7.5 GHz (3.1−10.6 GHz) unlicensed band for UWB devices. Potential UWB modulation
schemes, multiple access issues, single versus multiband implementation, and link budgets are also
discussed. Paper 0 is a very frequently referred to as giving a brief introduction to the basics of
impulse radio systems. It describes the characteristics of impulse radio and gives analytical estimates
of the multi-access capability under idealistic channel conditions.
Channel capacity and channel models are studied in [1–8]. Performance of PPM and on–off keying
(OOK) binary block-coded modulation formats using maximal ratio combining rake receiver are stud-
ied analytically in 0. The tradeoff between receiver complexity and performance is examined. Several
suboptimal receivers in indoor multipath AWGN channels have been employed. Results indicate
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

626
COGNITIVE UWB COMMUNICATIONS
that the robust performance may require an increase in rake complexity. This implies allocation of
more rake ﬁngers and tracking of the strongest multipaths to help in the selection combining. Rake
performance for a pulse-based high data rate UWB system in an Intel Labs indoor channel model is
addressed in 0. It is noted that at low input SNR values (0–10 dB) and a small number of rake ﬁngers,
it is more beneﬁcial to add rake taps for energy capture rather than for intersymbol interference (ISI)
mitigation. In the presence of channel estimation errors, equal gain combining can be more robust than
maximal ratio combining, and therefore yield better performance. In order to quantify the tradeoff
between rake receiver energy capture and diversity order 0 presents partly quasi-analytical and partly
experimental analysis suited to dense multipath propagation environments. Numerical results show
that a diversity level of less than 50 is adequate in typical indoor ofﬁce conditions.
In 0, a method to evaluate the bit error rate (BER) performance of time hopping (TH) PPM in the
presence of multiuser interference and AWGN channel is proposed. Gaussian quadrature rules are
used in this approach. Paper 0 concentrates on the signal design for binary UWB communications
in dense multipath channels. The aim is to ﬁnd signals with good distance properties leading to nice
BER performance that both depend on the time shift parameter τ. Performance of UWB correlation
receivers for equal mean power Gaussian monocyles is studied in 0. Channel conditions vary among
ideal single-user AWGN, non-ideal synchronous, multipath fading and multiple access interference.
It is shown that the pulse shape has a notable impact on the correlation receiver performance. The
effects can be seen in the autocorrelation function, especially in the mainlobe. The autocorrelation
is highly related to the SNR gain of the output and to interference resistance properties. Special
characteristics of the Gaussian monocycles include: (i) higher order derivatives have higher SNR
gain in single user and asynchronous multiple access channels but are less robust to interference
than are lower order derivatives, (ii) narrower pulses have higher SNR gain in asynchronous multiple
access channel at the cost of inferior interference resistance ability. Exact bit error rate performance
of TH-PPM UWB systems in the presence of multiple access interference (MAI) is analyzed and
simulated in 0. Furthermore, it is shown that with a moderate number of MAI sources, the standard
Gaussian approximation becomes inaccurate at high SNRs.
Main principles for multi-access in UWB systems are discussed in 0. Reference 0 is one of the ﬁrst
public and widely cited papers outlining the potential of time-hopping impulse radio multiple access
communications. It describes the basic building blocks of the impulse transmitter and receiver and their
mathematical formulations. It also shows an example for the bit error versus user capacity estimate
at variable data rates. Finally, some drawbacks of high time-resolution impulse radio systems are
mentioned: (i) the need for up to thousands of rake ﬁngers in the multipath receiver, and (ii) complex
initial clock acquisition. In 0, a quite comprehensive overall description of the time-hopping UWB
system physical layer issues is given. Achievable transmission rates and multiple access capacities
are estimated for analog and digital modulation formats. Numerical results indicate that the digital
implementation has the potential for nearly one order of magnitude higher user densities than the
analog one.
Reference 0 is focused on multiuser detection (MUD) possibilities for direct sequence UWB
systems. It is demonstrated that the adaptive minimum mean squared error (MMSE) MUD receiver
outperforms the rake receiver both in energy capture and in the interference rejection sense. Stud-
ied interference sources are narrowband IEEE 802.11a interference and wideband multiuser UWB
interference. Ideally, a MMSE receiver can achieve AWGN bit error rate within a 1–2 dB margin
even in dense multipath channels. In heavily loaded conditions the penalty of 6 dB is experienced,
but at the same time the rake receivers suffer from unbearable error ﬂoors. Iterative partial parallel
multiuser interference cancellation (PIC) is applied to the UWB multiuser system in 0. Matched
ﬁlter, maximum-likelihood, and linear minimum mean squared error receivers are also used in the
performance comparison. In this chapter, multiuser detection is combined with error control coding.
The UWB system includes only one pulse per symbol and an AWGN channel is assumed. Numerical
results show that it is possible to attain the coded single user BER bound for 8–15 users in a heavily
loaded system without any processing gain. As the number of users increases and the bandwidth-
to-pulse repetition frequency decreases, MAI is expected to affect system capacity and performance
adversely. As a consequence, a framework for the design of multiuser detectors for UWB multiple
access communications systems is presented in 0. Optimum multiuser detector is also proposed.

SIGNAL AND INTERFERENCE MODELS
627
Coexistence of UWB system with some other radio systems is studied in 0. This means the evalu-
ation of interference caused by the UWB system to other radio systems and vice versa. The coexisting
radio concepts are GSM900, UMTS/WCDMA, and GPS. Several short Gaussian-based UWB pulses
are employed. According to the numerical results, convenient selection of pulse waveform and width
leads to interference resistance up to a certain limit. The pulse shape is in interaction with the data
rate. High-pass ﬁltered waveforms are preferred in the case of short UWB pulses, whereas generic
Gaussian ones are favorable if long pulses are utilized. Interference caused by narrowband systems
is the most detrimental to UWB if it is located at the UWB system’s nominal center frequency. In the
GPS band, the DS based UWB system interfered less than the time hopping system.
Channel estimation for time hopping UWB communications is discussed in 0. The above survey
of issues in UWB communications indicates a need for special care in interference avoidance or
interference suppression due to extremely wide signal bandwidth and the possibility of interfering
with other systems operating in the same bandwidth. One way to deal with the problem is to design
the pulse shape in such a way that the signal has no signiﬁcant spectral component in the occupied
frequency bands. Pulse shapes respecting the FCC spectral mask are proposed in [28–30]. The
drawback of such solutions is the need for over sampling and lack of ﬂexibility in the case of the
interfering signal not being stationary, as in military applications. Another approach is to use adaptive
interference suppression as in the schemes summarized above. The solution discussed in this chapter
belongs to the latter category. We will demonstrate the advantages of the approach with a number of
numerical results. The solution is adaptive and can be implemented with no over-sampling, unlike
other schemes.
Within the concept of cognitive radio [32–38] the scheme presents a cognitive ultra wide band
(CUWB) systems, capable of monitoring and adapting to the amount and type of interference in the
network, as with advanced personal area networks (PAN). In this concept, cognition is used to identify
presence and location on the spectral scale of the interfering signal and to create a corresponding
notch to suppress the interference.
12.2
SIGNAL AND INTERFERENCE MODELS
In general the signal transmitted by the desired user is modeled as:
s(t) =

i
b(t −iNT f −(1 −ai)) cos ωct
(12.1)
where
b(t) =
N−1

n=0
g(t −nT f −h(n)Tc)
(12.2)
The signal can be also transmitted in the baseband with no carrier. In Equation (12.2), g(t) represents
its basic pulse shape (monocycle pulse) and T f represents the frame duration during which there is
only one pulse Tc seconds wide. The sequence h(n) is the user’s time-hopping code and its elements
are integers taking values in the range 0 ≤h(n) ≤N −1. The parameter Tc is the duration of an
addressable time bin within a frame. In other words, the right hand side of Equation (12.2) consists of
a block of N time-hopped monocycles. ai represents information bits (0,1). Equation (12.1) says that,
if ai were all zero, the signal would be a repetition of b(t)-shaped blocks with period NT f .  may be
viewed as the time shift impressed by a unit data symbol on the monocycles of a block. It is clear that
the choice of  affects the detection process and can be exploited to optimize system performance.
In summary, the transmitted signal consists of a sequence of b(t)-shaped position-modulated blocks.
The code sequence restarts at every data symbol. This ‘short-code’ assumption is made here for
the sake of simplicity and is in keeping with some trends in the design of third-generation CDMA
cellular systems. Longer codes are conceivable and perhaps more attractive but lead to more complex
channel estimation schemes.

628
COGNITIVE UWB COMMUNICATIONS
The OFDM interference, generated for example by WLAN user is modeled as:
j(t) =
N−1

i=0
d
i+

t
Tj
 Ji cos

2π

fc + fc + i
Tj

t + ϕi

(12.3)
where N is the number of channels; di is FDM interference information bits; fc + fc are the ﬁrst
channel carrier frequency; Ji is OFDM interference amplitudes; ϕi is the channel phase at the receiver
input, and T j the bit interval.
The MC CDMA interference can be modeled as
j(t) =
K

k=1
N−1

i=0
dk (t) ck (i) Jk,i cos

2π

fc + fc + i
Tj

t + ϕk,i

(12.4)
where N is the number of channels; dk(t) is kth user interference bit; ck(i) is the PN sequence of kth
user and ith channel; K is the number of users; fc + fc– is the ﬁrst channel carrier frequency; Jk,i
is the interference amplitude; ϕk,i is the channel phase at the receiver input, and T j is the bit interval.
12.3
RECEIVER STRUCTURE AND PERFORMANCE
The receiver block diagram is shown in Figure 12.1. There are two interference rejection circuits, A
and B. The ﬁrst one (A) processes a signal if logic one is sent, and the other (B) processes a signal
for logic zero. When several time-hopping signals are simultaneously received over a channel with
Lc paths, the composite waveform at the output of the receiver antenna may be written as:
r(t) =
Lc

l=1
(γ Ils(t −τl) cos ωct + γ Qls(t −τl) sin ωct) + n(t) + j(t)
(12.5)
where n(t) is noise, and j(t) is total interference, γl = γ Il + jγ Ql is the complex attenuation and τ1
is the delay in lth path. If we consider signal sampled at chip interval Tc we have:
r(k) = r I(k) + jr Q(k)
(12.6)
B filter 
Finger Lc
Rake combiner 
and detector 
r(k) 
Data
A filter
Finger 1
B filter
Finger 1
A filter  
Finger Lc
+
+
-
-
Figure 12.1 Receiver block diagram.

RECEIVER STRUCTURE AND PERFORMANCE
629
where
r I(t) = r(t) cos ωct
(12.6a)
r Q(t) = r(t) sin ωct
(12.6b)
k = t
Tc
(12.7)
Detection variable in the lth rake receiver ﬁnger is:
DIl(i) = DAIl(i) −DBIl(i)
(12.8)
DQl(i) = DAQl(i) −DBQl(i)
(12.9)
DAIl(i) =
(i+1)N
T f
Tc −τl
Tc

k=i N
T f
Tc −τl
Tc
r I(k)b

k −iN T f
Tc
−τl
Tc

(12.10)
DAQl(i) =
(i+1)N
T f
Tc −τl
Tc

k=i N
T f
Tc −τl
Tc
r Q(k)b

k −iN T f
Tc
−τl
Tc

(12.11)
DBIl(i) =
(i+1)N
T f
Tc −τl
Tc

k=i N
T f
Tc −τl
Tc
rI(k)b

k −iN T f
Tc
−τl
Tc
−
Tc

(12.12)
DBQl(i) =
(i+1)N
T f
Tc −τl
Tc

k=i N
T f
Tc −τl
Tc
r Q(k)b

k −iN T f
Tc
−τl
Tc
−
Tc

(12.13)
where i represents the bit index. Now, the signal at the output of RAKE combiner is:
d(i) =
Lc

l=1
(DI l(i)T I l(i) + DQl(i)T Ql(i))
(12.14)
The weight of I branch in lth ﬁnger is:
T I l(i) = DAI l(i) + DBI l(i),
(12.15)
and the weight of Q branch in lth ﬁnger is:
T Ql(i) = DAQl(i) + DBQl(i)
(12.16)
12.3.1
Interference rejection circuit model
Interference rejection at UWB radio system may be performed by transversal ﬁlter employing an
LMS algorithm. Basically, in the ﬁrst step, the interfering signal is estimated in the presence of a
UWB signal, which at that stage is considered as an additional noise. The estimated interference ˆj
is subtracted from the overall input signal r, creating the input signal r ′ = r −ˆj = s + n + j −ˆj =
s + n + j to a standard UWB receiver. In order to predict the interference signal, sampling is
performed at frame rate, and the adaptation of ﬁlter weights using the LMS algorithm is performed
at bit rate. It is already known that the changes of the symbol in the interfering signal will disrupt
the estimation process. Curve 3 in Figure 12.2, shows the detection variable at the output of the
transversal ﬁlter when there is PSK interference (with an interference-to-signal ratio of 40 dB) at
the input of the receiver together with the useful UWB signal and Gaussian noise. The presence of
impulse interference may be seen in the ﬁgure. In this chapter we propose a new structure for the
interference rejection, which successfully rejects this impulse interference.

630
COGNITIVE UWB COMMUNICATIONS
200
204
208
212
216
220
224
228
-6
-4
-2
0
2
4
6
3
1
d(i)
i
2
Figure 12.2 Detection variable. 1, no interference; 2, interference with J/S = 40 dB, with
interference rejection circuit; 3, interference with J/S = 40 dB, with transversal
ﬁlter using classical LMS algorithm; PSK interference, M = 4,  = 5 ns, vbJ
= 100 MSymbol/s, vbT H = 5 Mbit/s, Tframe = 10 ns, fc = 800 MHz.
Curve 2, in Figure 12.2, shows the signal at the output of the proposed interference rejection
structure in the case when there is PSK interference with an interference-to-signal ratio of 40 dB at
the input of the receiver. It can be noted that the interference is rejected and the detection variable is
very similar to the one when there is no interference (curve 1).
More details on the operating principle of the interference rejection circuit are shown in Figure
12.3. We consider the case of a bit interval having 20 frames with 5 samples per frame (M =
2). Central samples within each frame carry the same information about the useful signal and the
interference symbols and, since each sample belongs to a different frame, all those samples originate
from different instances of time. Similarly, samples from different frames equally distant from the
central sample carry the correlated interference signal. Therefore, an equivalent signal may be formed
in the following way: the Mth equivalent signal sample is the sum of M samples from each frame.
Adaptation of ﬁlter weights using a LMS algorithm and interference prediction is performed using
the equivalent signal samples.
As was already mentioned, the changes of the symbol in the interfering signal will disrupt the
estimation process so that forward and backward predictions are used simultaneously. When the
symbol change occurs, the ﬁlter with less disruption (smaller error at its output) is used to deliver
the estimates. This process is described in the sequel in more detail. For additional insight into the
problem the reader is also referred to [31]. Possible moments for the transition to happen are shown in
Figure 12.3 and are denoted by 1◦, 2◦, 3◦, and 4◦. Therefore, at frame rate BPF(F) (backward prediction

 
 
 
 
 
x-2(k) x-1(k) 
x1(k) 
x2(k) 
x0(k) 
x-2(k) x-1(k) 
x1(k) 
x2(k) 
x0(k) 
x-2(k) x-1(k) 
x1(k) 
x2(k) 
x0(k) 
x-2(k) x-1(k) 
x1(k) 
x2(k) 
x0(k) 
x–`2(k) x–1(k) 
x1(k) 
x2(k) 
x0(k) 
x–2
x–1
x1 
x2 
x0 
F1 
x0(k) 
x-2 
x-1 
x1 
x2 
x0 
F2 
x0(k+1) 
x-2 
x-1 
x1 
x2 
x0 
F3 
x0(k+2) 
x-2 
x–1 
x1 
x2 
x0 
F20 
x0(k+19) 
SX-2 
SX-1 
SX0(F) 
SX0(B) 
SX1 
SX2 
(k) 
1°  
2°  
3°  
4°  
5°  
Σ 
Σ 
Σ 
Σ 
Σ 
Σ 
S 
S 
S 
S 
S 
S 
W-1 (i) 
W-2 (i) 
Y1 
EX1 
- 
W2 (i) 
W1 (i) 
- 
Y2 
EX2 
FPF 
BPF 
Figure 12.3 Illustration of the algorithm operation.

632
COGNITIVE UWB COMMUNICATIONS
ﬁlter) and FPF(F) (forward prediction ﬁlter), ﬁlters are operating with weights being forwarded from
the LMS algorithm adapted by the equivalent signal. BPF(F) and FPF(F) ﬁlters have the same weights
during the useful signal bit interval, i.e. within all the frames belonging to the same bit interval. So,
the interference is predicted using the same weights computed using the equivalent signal. If, in cases
1◦, and 2◦, we discard samples belonging to the BPF(F) ﬁlter, we will also discard the interference
transition inﬂuence on the prediction. For cases 3◦and 4◦, samples that belong to the FPF(F) should be
discarded. This sample discarding is performed in the selector S at the outputs of BPF(F) and FPF(F)
ﬁlters, based on the error signal.
Therefore, if there is no interference signal transition during the sampling within one frame, the
equivalent signal will be formed using all the samples from that frame. Also, the same equivalent
central sample (SX0(B) = SX0(F)) is passed to both BPF(B) and FPF(B) LMS algorithms. On the other
hand, if there is interference signal transition during the sampling within one frame, the equivalent
signal will be formed using samples from FPF(F) (cases 1◦and 2◦) or BPF(F) (cases 3◦and 4◦), and
there will be two different equivalent central samples.
For the described interference rejection circuit we have:
(i) The ﬁrst part of the interference rejection circuit processes data at frame level, and at each frame
the following input signal processing is performed:
At ﬁlter A, the signal is sampled very close in time to the useful signal. For −M ≤m ≤M
we have:
Al
m(n) = AI l
m(n) + j AQl
m(n)
(12.17)
AI l
m(n) =
(n+1)
T f
Tc −τl
Tc

k=n
T f
Tc −τl
Tc
r I(k)g

k −n T f
Tc
−τl
Tc
−h(n) −m

(12.18)
AQl
m(n) =
(n+1)
T f
Tc −τl
Tc

k=n
T f
Tc −τl
Tc
r Q(k)g

k −n T f
Tc
−τl
Tc
−h(n) −m

(12.19)
For ﬁlter B we have:
Bl
m(n) = BI l
m(n) + j BQl
m(n)
(12.20)
BI l
m(n) =
(n+1)
T f
Tc −τl
Tc

k=n
T f
Tc −τl
Tc
r I(k)g

k −n T f
Tc
−τl
Tc
−h(n) −m −
Tc

(12.21)
BQl
m(n) =
(n+1)
T f
Tc −τl
Tc

k=n
T f
Tc −τl
Tc
r Q(k)g

k −n T f
Tc
−τl
Tc
−h(n) −m −
Tc

(12.22)
After that, variables C1 and C2, which the operation of one side of ﬁlter X (A and B) is based
on, are determined:
CX1l(n) =



0,

−1

m=−M
Xl
m(n)Wm(i))
2
≥A1
 M
m=1
Xl
m(n)Wm(i))
2
1,

−1

m=−M
Xl
m(n)Wm(i))
2
< A1
 M
m=1
Xl
m(n)Wm(i))
2
(12.23)
CX2l(n) =



0,
 M
m=1
Xl
m(n)Wm(i))
2
≥A2

−1

m=−M
Xl
m(n)Wm(i))
2
1,
 M
m=1
Xl
m(n)Wm(i))
2
< A2

−1

m=−M
Xl
m(n)Wm(i))
2
(12.24)

RECEIVER STRUCTURE AND PERFORMANCE
633
where Ai (i = 1, 2) are constants (for Ai →∞, the selector selects all the samples and the
structure operates as a traditional LMS algorithm). These gains are introduced because of the
decrease of noise inﬂuence on the irregular selections.
(ii) The second part of the interference rejection circuit operates at bit interval level Tb = NT f , and
for each ith bit we have the following signals:
SXl
m(i) =
(i+1)N

n=i N
Xl
m(n)CX1l(n)
−M ≤m ≤−1
(12.25)
SXl
m(i) =
(i+1)N

n=i N
Xl
m(n)CX2l(n)
1 ≤m ≤M
(12.26)
SX1l(i) =
(i+1)N

n=i N
Xl
0(n)CX1l(n)
(12.27)
SX2l(i) =
(i+1)N

n=i N
Xl
0(n)CX2l(n)
(12.28)
The error signal used for w coefﬁcients adaptation is:
EX1l(i) = SX1l(i) −
−1

m=−M
SXl
m(i)Wm(i)
(12.29)
EX2l(i) = SX2l(i) −
M

m=1
SXl
m(i)Wm(i)
(12.30)
The ﬁlter output signal, being led to the RAKE combiner, is:
DXl(i) = EX1l(i) + EX2l(i)
(12.31)
The adaptation algorithm is deﬁned as:
Wm(i + 1) = Wm(i) +
µEX1l(i)(SXlm(i))
∗
−1

j=−M

SXl
j (i)
2
−M ≤m ≤−1
(12.32)
Wm(i + 1) = Wm(i) +
µEX2l(i)
SXl
m(i)
∗
M

j=1

SXl
j (i)
2
1 ≤m ≤M
(12.33)
Finally, the interference rejection circuit is made symmetrical in the following way:
Wm(i + 1) = (Wm(i + 1) + W−m(i + 1)∗)
2
1 ≤m ≤M
(12.34)
Wm(i + 1) = W−m(i + 1)∗
−1 ≤m ≤−M
(12.35)
WLAN systems that are based on OFDMA technology are widely used, and therefore they could
interfere with UWB systems. OFDM interference, unlike other interference types, requires ﬁlters
of a shorter length in order to be successfully rejected. Thus, OFDM interference is considered
separately, and for its rejection a new structure is designed. Basic principles of this new OFDM
structure operation are described below.

634
COGNITIVE UWB COMMUNICATIONS
For the OFDM interference rejection circuit we have:
(i) The ﬁrst part of the interference rejection circuit processes data at frame level, and parameters
Al
m(n) and Bl
m(n) are calculated from Equations (12.17–22), where −M ≤m ≤M. After that,
variables C1 and C2, which the operation of one side of ﬁlter X (A and B) is based on, are
determined:
CX1l
m(n) = CX2l
m(n) =
=



0,

Xl
m(n)Wm(i))
2 ≥A1

Xl
m(n)Wm(i))
2
∨

Xl
m(n)Wm(i))
2
≥A2

Xl
m(n)Wm(i))
2
1
(12.36)
where Ai (i = 1, 2) are constants (for Ai →∞, the selector selects all the samples and the structure
operates as traditional LMS algorithm). These gains are introduced because of the decrease of
noise inﬂuence on the irregular selections.
(ii) The second part of the interference rejection circuit operates at bit interval level Tb = NT f , and
for each ith bit we have the following signals:
SXl
m(i) =
(i+1)N

n=i N
Xl
m(n)CX1l
m(n)
−M ≤m ≤−1
(12.37)
SXl
m(i) =
(i+1)N

n=i N
Xl
m(n)CX2l
m(n)
1 ≤m ≤M
(12.38)
SX1l
m(i) =
(i+1)N

n=i N
Xl
0(n)CX1l
m(n)
(12.39)
SX2l
m(i) =
(i+1)N

n=i N
Xl
0(n)CX2l
m(n)
(12.40)
The error signal used for w coefﬁcients adaptation is:
EX1l
m(i) = SX1l
m(i) −SXl
m(i)Wm(i)
(12.41)
EX2l
m(i) = SX2l
m(i) −SXl
m(i)Wm(i)
(12.42)
The ﬁlter output signal, being led to RAKE combiner, is:
DXl
m(i) = EX1l
m(i) + EX2l
m(i)
(12.43)
The adaptation algorithm is deﬁned as:
W ′
m(i + 1) = W ′
m(i) + µEA1l
m(i)

SAl
m(i)
∗

SAl
m(i)
2
+ µEB1l
m(i)

SBl
m(i)
∗

SBl
m(i)
2
−M ≤m ≤−1
(12.44)
W ′
m(i + 1) = W ′
m(i) + µEA2l
m(i)

SAl
m(i)
∗

SAl
m(i)
2
+ µEB2l
m(i)

SBl
m(i)
∗

SBl
m(i)
2
1 ≤m ≤M
(12.45)

PERFORMANCE EXAMPLES
635
Finally, the interference rejection circuit is made symmetrical in the following way:
Wm(i + 1) = (W ′m(i+1)+W ′
−m(i+1)∗)
2
1 ≤m ≤M
(12.46)
Wm(i + 1) = W−m(i + 1)∗
−M ≤m ≤−1
(12.47)
The signal at the output of RAKE combiner is:
d(i) =
Lc

l=1
M

m=1

Re

DAl
m(i)

−Re

DBl
m(i)

· Re

T l
m(i)

+

Im

DAl
m(i)

−Im

DBl
m(i)

· Im

T l
m(i)

(12.48)
where
T l
m(i) =
DAl
m(i) + DBl
m(i)
DAl
m(i) + DBl
m(i)

(12.49)
DXl
m(i) for ﬁlter A (X = A) is denoted by DAl
m(i), and DXl
m(i) for ﬁlter B (X = B) is denoted
by DBl
m(i).
The error probability per bit is:
Pe = 1
Ni
Ni

i=1
Pe (i)
(12.50)
where
Pe(i) =



1
2erfc

SN R(i)
2

ai
Na

j=1
d j (i) ≥0
1 −1
2erfc

SN R(i)
2

ai
Na

j=1
d j (i) < 0
(12.51)
and Ni is the bit ensemble size (measured in number of information bits) used for averaging the
result, and Na is the number of ensemble members. Estimated signal to noise ratio per bit is:
SNR (i) =

1
Na
Na

j=1
d j (i)
2
1
Na
Na

j=1

d j (i)
2 −

1
Na
Na

j=1
d j (i)
2
(12.52)
where d j(i) is the jth ensemble member.
12.4
PERFORMANCE EXAMPLES
Figure 12.4 presents the results for BER as a function of signal to noise ratio SNR, in the presence of
different PSK/QAM-type interfering signals. Additional parameters for the signals are: ﬁlter length
M = 4,  = 5 ns, vbJ = 100 MSymbol/s, vbT H = 5 Mbit/s, fc = 800 MHz and Tframe = 10 ns.
One can see: (a) fair agreement of simulation and numerical results, (b) the performance results are
close to a no interference case although the interference of a level of 40 dB above the UWB signal
is present, and (c) there is also a slight degradation of the performance when the interfering signal
constellation size is increased.

636
COGNITIVE UWB COMMUNICATIONS
6
8
10
1E-3
0.01
d1
f, f1
d
e
g
c
b, b1
a
Pe
SNR [dB]
Figure 12.4 Error probability as a function of signal to noise ratio. Error probability based
on Monte-Carlo simulation: a, no interference, without interference rejection
ﬁlter; b, no interference, with interference rejection ﬁlter; c, PSK interference,
J/S = 40 dB, with interference rejection ﬁlter; d, QPSK interference, J/S
= 40 dB, with interference rejection ﬁlter; e, 16QAM interference, J/S =
40 dB, with interference rejection ﬁlter; f, 64QAM interference, J/S = 40 dB,
with interference rejection ﬁlter; g, 256QAM interference, J/S = 40 dB, with
interference rejection ﬁlter; Error probability based on estimated detection
variable signal to noise ratio: b1, the same parameters as b; d1, the same
parameters as d; f1, the same parameters as f. fc = 800 MHz, M = 4,  =
5 ns, vbJ = 100 MSymbol/s, vbT H = 5 Mbit/s, Tframe = 10 ns.
Figure 12.5 presents the results for BER as a function of interference to signal ratio J/S, in the
presence of different PSK/QAM type interfering signals. Additional parameters for the signals are:
ﬁlter length M = 4, SNR = 7 dB,  = 5 ns, vbJ = 100 MSymbol/s, vbT H = 5 Mbit/s, fc = 800 MHz
and Tframe = 10 ns. One can see that when J/S becomes larger than zero (5 dB) the BER increases
rapidly if there now interference suppression (curves A). The performance is very much similar if
a standard LMS algorithm is used (curves C). On the other hand the new structure is performing
signiﬁcantly better (curves B). There is again a slight degradation of the performance when the
interfering signal constellation size is increased.

PERFORMANCE EXAMPLES
637
–20
0
20
40
60
80
0.01
0.1
C (a, b, c, d, e)
A (a, b, c, d, e)
B
e
d
c
b
a
Pe
J/S [dB]
Figure 12.5 Error probability as a function of interference to signal ratio. A, without
interference rejection; B, with interference rejection circuit; C, with classical
LMS interference rejection ﬁlter; a, PSK interference; b, QPSK interference;
c, 16QAM interference; d, 64QAM interference; e, 256QAM interference;
fc = 800 MHz, M = 4, SNR = 7 dB,  = 5 ns, vbJ = 100 MSymbol/s; vbT H
= 5 Mbit/s, Tframe = 10 ns.
Figure 12.6 presents the results for BER as a function of interference symbol duration Tj/Tc in
the presence of different PSK/QAM type interfering signals. Additional parameters for the signals
are J/S = 30 dB, SNR = 7 dB, M = 4,  = 5 ns, vbT H = 5 Mbit/s, fc = 800 MHz and Tframe = 10
ns. One can see that BER decreases when Tj/Tc increases. There is again a slight degradation of the
performance when the interfering signal constellation size is increased.
Figure 12.7 presents the results for BER as a function of interference symbol duration Tj/Tc in the
presence of MC CDMA type interfering signals for a different number of subcarriers N and number
of users K.
Additional parameters for the signals are J/S = 30 dB, SNR = 7 dB, M = 4,  = 5 ns, vbT H =
5 Mbit/s, Tframe = 10 ns, and fc = 800 MHz. One can see again that BER decreases when Tj/Tc
increases. The performance is improved if the number of subcarriers is decreased and if the number

638
COGNITIVE UWB COMMUNICATIONS
5
10
15
20
25
30
35
40
0.01
0.1
d
e
c
b
a
Pe
Tj / Tc
Figure 12.6 Error probability as a function of interference bit duration. a, PSK interference;
b, QPSK interference; c, 16QAM interference; d, 64QAM interference; e,
256QAM interference; fc = 800 MHz, J/S = 30 dB, SNR = 7, dB, M = 4,
 = 5 ns, vbT H = 5 Mbit/s, Tframe = 10 ns.
of users is increased for the same overall power of the interfering signal. This can be explained by the
fact that a sum of MC CDMA signals will create an equivalent multicarrier signal with lower number
of dominant subcarriers that are suppressed more effectively by the ﬁlter because the LMS algorithm
better adjusts the ﬁlter weights. This is demonstrated in Figures 12.9 and 12.10 for an OFDM
signal.
Figure 12.8. shows the error probability as a function of the interference rejection structure length.
Curves labeled with A show the results of non-OFDM interference rejection using the new structure.
It can be seen that there is a optimal structure length, and that it does not depend on interference
constellation size. OFDM interference rejection results as are labeled with B. The new structure results
are represented with thin lines, while thick lines show the results for the new OFDM structure. In the
case of high power interference (curves b) the new structure has optimal length 2M = 2 regardless
of interference constellation size. The new OFDM structure, in the case of such strong interference,
has a much better performance for high structure length (optimal length is 2M = 8). In the case of
low power interference (curves a) both the new and the new OFDM signal suppression structure have
similar performances for the same structure length (2M = 8).

PERFORMANCE EXAMPLES
639
1000
2000
3000
4000
5000
6000
7000
8000
0.01
0.1
e
d
b
a
c
Pe
Tj / Tc
Figure 12.7 Error probability as a function of MC CDMA interference bit duration. a, N =
64, K = 10; b, N = 32, K = 5; c, N = 32, K = 10; d, N = 32, K = 20; e, N =
16, K = 10, MC CDMA interference: J/S = 30 dB, SNR = 7 dB, M = 4,  =
5 ns, vbT H = 5 Mbit/s, Tframe = 10 ns, fc = 800 MHz.
Figure 12.9 presents the results for BER as a function of interference symbol duration Tj/Tc and
the number of subcarriers N in the presence of OFDM type interfering signals. Additional parameters
for the signals are J/S = 30 dB, SNR = 7 dB, M = 4,  = 5 ns, vbTH = 5 Mbit/s, Tframe = 10 ns,
fc = 800 MHz and 16QAM per subcarrier. One can see that BER decreases when Tj/Tc increases
up to Tj/Tc ≈300 for N ≤8. Beyond that point there is no reduction in BER if Tj/Tc is further
increased. There is a signiﬁcant degradation of the performance when the number of subcarriers in
the OFDM signal is N ≥16.
Figure 12.10 presents the results for BER as a function of interference symbol duration Tj/Tc in
the presence of OFDM type interfering signals. Additional parameters for the signals are J/S = 60
dB, SNR = 13 dB, M = 4,  = 5 ns, vbT H = 5 Mbit/s, Tframe = 10 ns, fc = 800 MHz and N = 64.
One can see again that BER decreases when Tj/Tc increases. It can be seen that the interfering
signal constellation size has a very slight inﬂuence on the system’s performance, regardless of the
interference rejection circuit. Both new structures perform much better than does the classical LMS
algorithm, but for higher Tj/Tc (> 6000) the new OFDM structure brings additional performance
improvement for OFDM interference rejection compared with the new structure.

1
2
3
4
5
6
7
8
9
10
10
–2
10
–1
b
B
a
 PSK
 QPSK
 16QAM
 64QAM
 256QAM
Pe
M
A, a, b
Figure 12.8 Error probability as a function of ﬁlter length. a, J/S = 30 dB; b, J/S = 60 dB;
A, Non OFDM interference; B, OFDM interference; thin lines, new structure;
thick lines, new OFDM structure; SNR = 13 dB,  = 5 ns, vbT H = 5 Mbit/s,
Tframe = 10 ns, fc = 800 MHz.
200
400
600
800
1000
0,01
0,1
64
32
16
8
4
Pe
N
Tj / Tc
2
Figure 12.9 Error probability as a function of OFDM interference bit duration and the
number of subcarriers. OFDM/16QAM interference: fc = 800 MHz, J/S =
30 dB, SNR = 7 dB, M = 4,  = 5 ns, vbT H = 5 Mbit/s, Tframe = 10 ns.

REFERENCES
641
4000
8000
12000
16000
10
–3
10
–2
10
–1
PSK
 QPSK
16QAM
64QAM
256QAM
C
B
Pe
Tj / Tc
A
Figure 12.10 Error probability as a function of OFDM interference bit duration. A, new
OFDM structure; B, new structure; C, classical LMS interference rejection
ﬁlter; N = 64, fc = 800 MHz, J/S = 60 dB, SNR = 13 dB, M = 4,  = 5
ns, vbT H = 5 Mbit/s, Tframe = 10 ns.
REFERENCES
1. Multispectral Solutions, Inc. – History of UWB Technology. www.multispectral .com/ his-
tory.html.
2. Aiello, G. R. and Rogerson, G. D. (2003) Ultra-wideband wireless systems, IEEE Microwave
Magazine, 4(2), 36−47.
3. Win, M. Z. and Scholtz, R. A. (1998) Impulse radio: how it works. IEEE Communications Letters,
2, 36−38.
4. Zhang, J., Kennedy, R. A. and Abhayapala, T. D. (2003) New results on the capacity of M-ary PPM
ultra-wideband systems, in Proceedings IEEE International Conference on Communications
(ICC), Anchorage, Alaska, 4, 2867−2871.
5. Cassioli, D., Win, M. Z. and Molisch, A. F. (2002) The ultra-wideband indoor channel: from statis-
tical model to simulations, IEEE Journal on Selected Areas in Communications, 20, 1247−1257.

642
COGNITIVE UWB COMMUNICATIONS
6. Cramer, R. J.-M., Scholtz, R. A. and Win, M. Z. (2002) Evaluation of an ultra-wide-band
propagation channel, IEEE Transactions on Antennas and Propagation, 50, 561−570.
7. Saleh, A. A. M. and Valenzuela, R. A. (1987) A statistical model for indoor multipath propagation,
IEEE Journal on Selected Areas in Communications, 5, 128−137.
8. Win, M. Z. and Scholtz, R. A. (2002) Characterization of ultra-wide bandwidth wireless indoor
channels: a communication-theoretic view, IEEE Journal on Selected Areas in Communications,
20, 1613−1627.
9. Choi, J. D. and Stark, W. E. (2002) Performance of ultra-wideband communications with subop-
timal receivers in multipath channels, IEEE Journal on Selected Areas in Communications, 20,
1754−1766.
10. Rajeswaran, A., Somayazulu, V. S. and Foerster, J. R. (2003) Rake performance for a pulse based
UWB system in a realistic UWB indoor channel, in Proceedings IEEE International Conference
on Communications (ICC), Anchorage, Alaska, USA, 4, 2879−2883.
11. Win, M. Z. and Scholtz, R. A. (1998) On the energy capture of ultrawide bandwidth signals in
dense multipath environments, IEEE Communications Letters, 2, 245−247.
12. Durisi, G. and Benedetto, S. (2003) Performance evaluation of TH-PPM UWB systems in the
presence of multiuser interference. IEEE Communications Letters, 7, 224–226.
13. Ram´ırez-Mireles, F. (2002) Signal design for ultra-wide-band communications in dense multi-
path, IEEE Transactions on Vehicular Technology, 51, 1517−1521.
14. Zhang J, Abhayapala, T. D. and Kennedy, R. A. (2003) Performance of ultra-wideband corre-
lator receiver using Gaussian monocycles, in Proceedings IEEE International Conference on
Communications (ICC), Anchorage, Alaska, USA, 3, 2192−2196.
15. Hu, B. and Beaulieu, N. C. (2003) Exact bit error rate analysis of TH-PPM UWB systems in the
presence of multiple-access interference, IEEE Communications Letters, 7, 572−574.
16. Cuomo, F., Martello, C., Baiocchi, A. and Capriotti, F. (2002) Radio resource sharing for ad hoc
networking with UWB, IEEE Journal on Selected Areas in Communications, 20, 1722−1732.
17. Forouzan, A. R., Nasiri-Kenari, M. and Salehi, J. A. (2002) Performance analysis of time-hopping
spread-spectrum multiple-access systems: uncoded and coded schemes, IEEE Transactions on
Wireless Communications, 1, 671−681.
18. Ram´ırez-Mireles, F. (2001) Performance of ultrawideband SSMA using time hopping and M-ary
PPM, IEEE Journal on Selected Areas in Communications, 19, 1186–1196.
19. Scholtz, R. A. (1993) Multiple access with time-hopping impulse modulation, in Proceedings
IEEE Military Communications Conference (MILCOM), Boston, MA, USA, 2, 447−450.
20. Win, M. Z. and Scholtz, R. A. (2000) Ultra-wide bandwidth time-hopping spread-spectrum
impulse radio for wireless multiple-access communications, IEEE Transactions on Communica-
tions, 48, 679−691.
21. Li, Q. and Rusch, L. A. (2002) Multiuser detection for DS-CDMA UWB in the home environment,
IEEE Journal on Selected Areas in Communications, 20, 1701−1711.
22. Trichard, L. G. F. and Kohno, R. (2003) Iterative multiuser partial parallel interference cancel-
lation for UWB-MA systems, in Proceedings 2003 International Workshop on Ultra Wideband
Systems (IWUWBS), Oulu, Finland.
23. Yoon, Y. C. and Kohno, R. (2002) Optimum multi-user detection in ultra-wideband (UWB)
multiple-access communication systems, in Proceedings IEEE International Conference on Com-
munications (ICC), New York, NY, USA, 2, 812−816.

REFERENCES
643
24. H¨am¨al¨ainen, M., Hovinen, V., Tesi, R., Iinatti, J. H. J. and Latva-aho, M. (2002) On the UWB
system coexistence with GSM900, UMTS/WCDMA, and GPS, IEEE Journal on Selected Areas
in Communications, 20, 1712−1721.
25. Lottici, V., D’Andrea, A. and Mengali, U. (2002) Channel estimation for ultra-wideband com-
munications, IEEE Journal on Selected Areas in Communications, 20, 1638–1645.
26. Lovelace, W. M. and Townsend, J. K. (2002) The effects of timing jitter and tracking on the per-
formance of impulse radio, IEEE Journal on Selected Areas in Communications, 20, 1646−1651.
27. G¨uvenc¸, I. and Arslan, H. (2003) Performance evaluation of UWB systems in the presence of
timing jitter, in Proceedings IEEE Conference on Ultra Wideband Systems and Technologies
(UWBST), Reston, VA, USA.
28. Luo, X., Yang, L. and Giannakis, G. (2003) Designing optimal pulse-shapers for ultra-wideband
radios, Journal of Communications and Networks, 5, 344–354.
29. Parr, B., Chao, B. and Ding, Z. (2003) A new UWB pulse generator gor FCC spectral mask, in
Proceedings Vehicular Technology Conference, 3, April 2003, pp. 1664–1666.
30. Parr, B., Byunglok Cho, Wallaco, K., Zhi Ding, et al. (2003) A novel ultra wide-band pulse design
algorithm, IEEE Communications Letters, 7, 219–221.
31. Glisic, S., Nikolic, Z. and Dimitrijevic, B. (1999) Adaptive self-reconﬁgurable interference
suppression schemes for CDMA wireless networks, IEEE Transactions on Communications, 47,
598−607.
32. Mitola, J., III and Maguire, G. Q., Jr. (1999) Cognitive radio: making software radios more
personal, IEEE Personal Communications, 6, 13–18.
33. Devroye, N., Mitran, P. and Tarokh, V. (2006) Achievable rates in cognitive radio channels, IEEE
Transactions on Information Theory, 52, 1813–1827.
34. Haykin, S. (2005) Cognitive radio: brain-empowered wireless communications, IEEE Journal
on Selected Areas in Communications, 23, 201–220.
35. Zhang, H.-Z., Zhou, X.-F., Yazdandoost, K. Y. and Chlamtac, I. (2006) Multiple signal waveforms
adaptation in cognitive ultra-wideband radio evolution, IEEE Journal on Selected Areas in
Communications, 24, 878–884.
36. Jing, X.-P., Mau, S. C., Raychaudhuri, D., and Matyas, R. (2005) Reactive cognitive radio
algorithms for co-existence between IEEE 802.11b and 802.16a networks, in IEEE Global
Telecommunications Conference, GLOBECOM’05, 5, 28 November–2 December 2005 p. 5.
37. Costlow, T. (2003) Cognitive radios will adapt to users, IEEE Intelligent Systems, 18, p. 7.
38. Walko, J. (2005) Cognitive radio, IEE Review, 51, 34–37.


13
Positioning in Wireless
Networks
13.1
MOBILE STATION LOCATION IN CELLULAR NETWORKS
13.1.1
Introduction
In this section we present a general mathematical framework that covers all the positioning tech-
niques for processing absolute and/or relative distance measurements between the mobile station and
multiple base transceiver stations. Based on this scheme, a general measure of positioning accuracy
is introduced and then analyzed in the special cases deﬁned by the three most feasible techniques. A
geometrical interpretation of the formulas that deﬁne the location accuracy and a comparison between
the techniques from the geometric conditioning point of view are also given.
The Federal Communications Commission (FCC) mandated US cellular operators, in 1996, to
locate mobile phones calling the emergency number 911 by October 2001 [1, 2]. The European Union
has been taking steps towards similar regulation [3]. Emergency services, beside commercial applica-
tions such as vehicle ﬂeet management, intelligent transport systems, and location-based billing [4, 5],
are also examples of applications of mobile station (MS) positioning. The ﬁrst studies on positioning of
mobile phones were published in the 1970s [6]. Since that time, several techniques for locating the MS
by measuring attenuation, direction of arrival, and delay of the radio signals exchanged between the
MS and multiple base transceiver stations (BTSs) have been proposed (see [7] for an overview). Simu-
lation results of phase-ranging and pulse-ranging techniques are presented in [8] and [9]. Methods for
locating mobiles by processing attenuation measurements are presented in [10]–[14]. In [15], meth-
ods involving time-of-arrival (TOA) and angle-of-arrival (AOA) measurements in a code-division,
multiple-access, network are analyzed. Positioning through AOA measurements is discussed in [16].
Performance of tracking algorithms that process absolute and/or relative propagation delay measure-
ments are presented using simulations in [17]–[19] and veriﬁed experimentally in [20] and [21–23].
Standardization activities for MS positioning are presented in [24–26]. Along the years, the
standardization group T1P1.5 has considered four alternatives:
(i) the network-assisted GPS method [27], which calculates the MS location by using GPS tech-
nology;
(ii) time advance [28];
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

646
POSITIONING IN WIRELESS NETWORKS
(iii) enhanced observed time difference (E-OTD) [29];
(iv) uplink TOA [30].
The network-assisted GPS method is beyond the scope of this section and the remaining methods
will be the focus of this discussion. The more general goal of this section is to analyze the accuracy
of the multilateration techniques when used in cellular networks. Such analysis is carried out in a
general manner so that it applies to the third and incoming fourth generation of universal mobile
telecommunications systems [31].
The time advance, enhanced OTD, and uplink TOA methods estimate the MS coordinates by
processing with multilateration techniques absolute distances (ADs) and/or relative distances (RDs)
between the MS and multiple BTSs. A general analysis of the multilateration techniques that process
only ADs (circular multilateration) or only RDs (hyperbolic multilateration) can be found in [32–35].
The technique that combines ADs and RDs (referred to as mixed multilateration) is of major interest
for cellular applications.
In this section we present the basics of the time advance, enhanced OTD, and uplink TOA methods
as a background for later analysis. The mathematical formulation of the generic multilateration
problem and its linear weighted least squares (WLS) solution are also presented. The WLS location
estimate is then used to derive an explicit expression for the positioning accuracy measure. The
accuracy of circular, hyperbolic, and mixed multilateration is geometrically interpreted.
13.1.2
MS location estimation using AD and RD measurements
The time advance method uses the existing timing advance (TA) parameter, which is introduced to
avoid overlapping of bursts transmitted by the MS during a call in TDMA systems [28, 38, 39]. For
positioning purposes, the TA is considered to be an estimate of the absolute distance between MS and
serving BTS, and is used to implement the circular multilateration technique. In a two-dimensional
scenario, as assumed throughout this section, ADs from N ≥3 different stations are needed to ﬁnd
the MS coordinates at the intersection of N circumferences centered at the BTSs with radii equal to
the AD measurements.
In a TDMA-based network, the TA is estimated by the serving BTS only when the MS is in
connected mode (i.e., the MS is communicating with the serving BTS using a dedicated channel)
[39]. As a consequence, ADs from multiple BTSs can only be measured by sequentially forcing the
communication to be handed over from one BTS to another until all the N BTSs have been accessed.
In practice, when a positioning handover occurs, the TA is estimated by the new serving BTS, but the
handover request is not responded to and the connection returns to the previous serving BTS [28].
The E-OTD method is based on three parameters: observed time difference (OTD), real time
difference (RTD), and geometric time difference GTD = RTD −OTD. If a burst is transmitted by
BTS1 and BTS2 at the instants tTx1 and tTx2 respectively, and received by the MS at instants tRx1
and tRx2 respectively, then the RTD is tTx2 −tTx1 and the OTD is tRx2 −tRx1. The GTD is a scaled
measure of the relative distance between the MS and the pair {BTS1, BTS2}; in fact, GTD = RTD −
OTD = (tRx1 −tTx1) −(tRx2 −tTx2) = (d1 −d 2)/c = RD/c, with c being the speed of light and
d1 = c(tRx1 −tTx1) i d2 = c(tRx2 −tTx2) being the lengths of the propagation path between the MS
and BTS1, BTS2, respectively [29]. The possible positions of an MS observing a constant GTD value
are located on a hyperbola having foci at BTS1 and BTS2. In a two-dimensional scenario, the MS
position is calculated via hyperbolic multilateration at the intersection of at least two hyperbolas;
thus N ≥3 BTSs are needed to implement this technique. Because of the implementation [39], the
enhanced OTD method takes one of the N available BTSs as reference BTS and uses it to calculate
all the N −1 RDs. As a consequence, linear dependence between multiple equations is avoided.
13.1.3
The circular, hyperbolic, and mixed multilateration
Let {BTS1, . . . , BTSN} be the N base stations available for locating the MS. BTS1 is the reference
station eventually used to evaluate RDs. Let S = {1, . . . , N} be an ordered set of indexes identifying

MOBILE STATION LOCATION IN CELLULAR NETWORKS
647
h
S
m
S
c
S
Figure 13.1 Graphical representation of the subsets Sc, Sm, and Sh.
the BTSs. Within S, the following ordered subsets are deﬁned as in Figure 13.1, where:
Sc = {indexes identifying the BTSs involved in AD measurements};
Sh = {indexes identifying the BTSs involved in RD measurements};
Sm = Sc ∩Sh = {indexes identifying the BTSs involved both in AD and RD measurements};
¯Sc = Sc −Sm ={indexes identifying the BTSs involved only in AD measurements};
¯Sh = Sh −Sm = {indexes identifying the BTSs involved only in RD measurements.}.
The number of elements in each subset is Nc = size{Sc}, Nh = size{Sh}, Nm = size{Sm}, ¯Nc =
size{¯Sc} and ¯Nh = size{¯Sh}. Moreover S = Sc ∪Sh = ¯Sc ∪¯Sh ∪Sm and N = Nc + Nh −Nm = ¯Nc +
¯Nh + ¯Nm.
The general multilateration problem is described by a set of equations in which each AD
deﬁnes a circumference and each RD deﬁnes a hyperbola. The known BTS coordinates are
(x1, y1), . . . , (xn, yn), and the unknown MS coordinates are (x, y). The AD measured between the
MS and the BTSi(i ∈¯Sc) is di; the RD measured between the MS and the pair of stations {BTS1,
BTSl}(l ∈¯Sh −{1}) is rll; the AD and RD involving the BTS identiﬁed by Sm are dp (p ∈Sm) and
r1q(q ∈Sm −{1}), respectively.




(x −xi)2 + (y −yi)2 = di,
i ∈¯Sc

(x −x1)2 + (y −y1)2 −

(x −xl)2 + (y −yl)2 = r 1l,
l ∈¯Sh −{1}

(x −x p)2 + (y −yp)2 = dp,
p ∈Sm

(x −x1)2 + (y −y1)2 −

(x −xq)2 + (y −yq)2 = r 1q,
q ∈Sm −{1}
(13.1)
The circular, hyperbolic, and mixed multilateration can be derived from Equation (13.1) by
properly deﬁning Sc, Sh, and Sm. In circular multilateration all the available BTSs are used only to
measure ADs, and no RD measurements are available; thus Sh and Sm are empty and ¯Sc coincides with
Sc: Sm = Sh = ¯Sh = 0; ¯Sc = Sc = S = {1, . . . , N }. In hyperbolic multilateration all the available
BTSs are used to measure only RDs. No ADs are used. BTS1 is only used to measure RDs; thus
Sm is empty and BTS1 belongs to subset ¯Sh, which in turn coincides with Sh: Sm = Sc = ¯Sc = 0;
¯Sh = Sh = S = {1, . . . N}. Finally, in mixed multilateration all the available BTSs are used to measure

648
POSITIONING IN WIRELESS NETWORKS
RDs. BTS1 is also used to measure ADs; thus BTS1 belongs to Sh and is the only element in Sm,
which coincides with Sc (BTS1 /∈¯Sh). Since no BTSs are used only to measure ADs, ¯Sc is empty: Sh
= {1, . . . , N}; Sm = Sc = {l}; ¯Sh = {2, . . . , N ; ¯Sc = 0.
13.1.4
WLS Solution of the Location Problem
In real applications, Equation (13.1) should be further modiﬁed to include the presence of noise. In
this section, x and y are estimated by using a linear WLS algorithm [41, 48], following the same
approach of [35] and [37]. To apply the WLS estimation, Equation (13.1) is linearized by assuming
that an a priori estimate of the MS position, P(0) = (x(0), y(0)), is available. P(0) could be determined,
for instance, from a previous iteration of the WLS algorithm or by classical calculus to ﬁnd the
intersection of a number of circumferences deﬁned by Equation (13.1). If P(0) is sufﬁciently close to
P = (x, y), the equations resulting from the ith AD measurement and the lth RD measurement can be
accurately represented by their linear approximation in a neighborhood of P(0):
di ˜−d(0)
i
−ui,xx −ui,yy
r1l ˜−d(0)
1l −w1l,xx −w1l,yy
(13.2)
where
x = x −x(0);
y = y −y(0);
ui,x =

xi −x(0)
/

d(0)
i

;
ui,y =

yi −y(0)
/

d(0)
i

;
d(0)
i
=

(xi −x(0))2 + (yi −y(0))2;
r (0)
1l = d(0)
1 −d(0)
l ;
w1l,x = u1,x −ul,x;
w1l,y = ui,y −ul,y.
A graphical representation is given in Figure 13.2 where
⌢ui = ui,x
⌢x + ui,y
⌢y is a unit vector
originated at the MS and directed toward BTSi (
⌢x and
⌢y are the unit vectors in the x and y directions)
and w1l,x and w1l,y are the x–y components of the difference vector w1l =
⌢u1 −
⌢ul.
Stacking the linearized Equations (13.2) as in Equation (13.1) results in a linear system Ax =
b deﬁned by the 2 × 1 unknown vector x, the ( ¯Nc + ¯Nh + 2Nm −1) × 2 design matrix A, and the
BTSl
(0)
P
1
BTS
(1)
P
1
W l
( )l
P
1
1
ˆu sin
j
θ
1 j
θ
(0)
P
1ˆu
ˆum
1
W m
(
)
m
P
BTSm
Circumference of
unitary radius
 
ˆul
ˆx
ˆy
ˆz
Figure 13.2 Deﬁnition of the basic vectors: w1l,
⌢u1,
⌢ul. The area of the parallelogram of
vertices P(0), P(l), ¯P(0), P(1) is Alj. The area of the parallelogram of vertices
P(0), P(l), P(1), P(m) is Blm.

MOBILE STATION LOCATION IN CELLULAR NETWORKS
649
( ¯Nc + ¯Nh + 2Nm −1) × 1 observation vector b deﬁned as follows:
A =


U¯c
W¯h
Um
Wm

; x =

x
y

; b =


D¯c
R¯h
Dm
Rm


(13.3)
U¯c = |ui,x ui,y|i∈¯Sc is a ¯Nc × 2 matrix with the x–y components of
⌢ui(i ∈¯Sc) on its columns. Analo-
gously, W¯h = [w1l,xw1l,y]l∈¯Sh−{1}, Um = [u p,xu p,y]p∈Sm and Wm = [w1q,xw1q,y]q∈Sm−{1}. The vectors
D¯c = [d(0)
i
−di]i∈¯Sc, R¯h = [r (0)
1l −r1l]l∈¯Sh−{1}, Dm = [d(0)
p −dp]p∈Sm and Rm = [r (0)
1q −r1q]q∈Sm−{1} are
obtained by stacking the measurements in a single column. The WLS solution of the linear problem
Ax = b that minimizes the scalar cost function J(x) = (Ax −b)T Q−1
b (Ax −b) is
⌢x = G−1g, where
G = AT Q−1
b A, g = AT Q−1
b b, and Qb is the covariance matrix of b [41, 48].
13.1.5
Accuracy measure
The covariance matrix of
⌢x is Q⌢x = Cov{
⌢x} = G−1. The diagonal entries of Q⌢x are the variances of
the location error along the directions x and y. The square root of their sum, corresponding to the
square root of the trace of Q⌢x , is the accuracy measure considered hereafter: M =

Tr{Q⌢x }. In order
to derive an explicit expression of M, Q⌢x = G−1 = (AT Q−1
b A)−1 must be evaluated; A is deﬁned in
Equation (13.3), and Qb is derived below.
Let ci and fl be the measurement errors affecting the ith AD measurement di and the lth RD
measurement r1l, respectively. In TDMA-based systems, such errors can be assumed uncorrelated.
ADs and RDs are averages of ‘raw’ propagation delays estimated during periods longer than the
typical coherence time of the mobile radio channel. Under this hypothesis, Qb has the following
block-diagonal structure (matrices 0 are properly sized matrices with all zero entries):
Qb =


Se,¯c
0
0
0
0
S f,¯h
0
0
0
0
Se,m
0
0
0
0
S f,m


(13.4)
where
Se,¯c = diag{σ 2
e,i}i∈¯Sc;
S f,¯h = diag{σ 2
f,l}l∈¯Sh−{1};
Se,m = diag{σ 2
e,p}p∈¯Sm;
S f,m = diag{σ 2
f,q}q∈¯Sm−{1};
σ 2
e,i
= Var{ci} are variances of the AD and RD measurement errors.
A and Qb deﬁned in Equation (13.3) and (13.4) can be used to derive G = AT Q−1
b A
G =

G11
G12
G12
G22

(13.5)
with
G11 =

i∈
⇀S c
σ −2
e,i u2
i,x +

p∈Sm
σ −2
e,pu2
p,x +

l∈
⇀S h−{1}
σ −2
f,l w2
1l,x +

q∈
⇀S m−{1}
σ −2
f,qw2
1q,x
G12 =

i∈
⇀S c
σ −2
e,i ui,xui,y +

p∈Sm
σ −2
e,pu p,xu p,y +

l∈
⇀S h−{1}
σ −2
f,l w1l,xw1l,y +

q∈
⇀S m−{1}
σ −2
f,qw1q,xw1q,y
G22 =

i∈
⇀S c
σ −2
e,i u2
i,y +

p∈Sm
σ −2
e,pu2
p,y +

l∈
⇀S h−{1}
σ −2
f,l w2
1l,y +

q∈
⇀S m−{1}
σ −2
f,qw2
1q,y
(13.6)

650
POSITIONING IN WIRELESS NETWORKS
Inversion of G leads to the following general expression of the accuracy measure:
M =

Tr{Q⌢x } =

G11 + G22
Det{G}
(13.7)
where
G11 + G22 =

i∈
⇀S c
σ −2
e,i +

p∈Sm
σ −2
e,p +

l∈
⇀S h−{1}
σ −2
f,l
w1l
2 +

q∈
⇀S m−{1}
σ −2
f,q
w1q
2
(13.8)
and
Det{G} =



i∈
⇀S c
σ −2
e,i u2
i,x +

p∈Sm
σ −2
e,pu2
p,x +

l∈
⇀S h−{1}
σ −2
f,l w2
1l,x +

q∈
⇀S m−{1}
σ −2
f,qw2
1q,x


·



i∈
⇀S c
σ −2
e,i u2
i,y +

p∈Sm
σ −2
e,pu2
p,y +

l∈
⇀S h−{1}
σ −2
f,l w2
1l,y +

q∈
⇀S m−{1}
σ −2
f,qw2
1q,y


−



i∈
⇀S c
σ −2
e,i ui,xui,y +

p∈Sm
σ −2
e,pu p,xu p,y +

l∈
⇀S h−{1}
σ −2
f,l w1l,xw1l,y
+

q∈
⇀S m−{1}
σ −2
f,qw1q,xw1q,y

·



j∈
⇀S c
σ −2
e, j u j,xu j,y +

r∈Sm
σ −2
e,r ur,xur,y
+

m∈
⇀S h−{1}
σ −2
f,mw1m,xw1m,y +

s∈
⇀S m−{1}
σ −2
f,s w1s,xw1s,y


(13.9)
The structure of M shows that the location accuracy is affected by the measurement accuracy
(σ e,i,σ f ,l) and the reciprocal position of the MS and the BTSs (represented by the x–y components
of vectors
⌢ui and wi j). These two contributions can be separated only if all the (uncorrelated)
measurement errors have the same standard deviation.
13.1.6
Circular multilateration
In this case we have Sh = Sm = ¯Sh = 0 and ¯Sc = Sc. Using this in Equation (13.7) gives:
M2
c =

i∈Sc σ −2
e,i
Det{Gc}
(13.10)
Det{Gc} can be obtained from Equation (13.9) by retaining only the sums over indexes i and j:
Det{Gc} =

i, j∈Sc
σ −2
e,i σ −2
e, j

u2
i,xu2
j,y −ui,xui,yu j,xu j,y

(13.11)
The cross product between two vectors a = ax
⌢x + ay
⌢y and b = bx
⌢x + by
⌢y can be written as a × b =
(axby −aybx)
⌢z (
⌢z =
⌢x ×
⌢y is the unit vector in the z direction). With this observation in mind, the
quantity between parentheses in Equation (13.11) becomes Det{Gc} = ui,xu j,y
⌢z · (ui × u j), where ·
represents the scalar product. Det{Gc} can be further modiﬁed by excluding from the double sum the
terms occurring when j = i since ui × u j = 0. Sc (as well as Sh and Sm) is an ordered set of indexes;
thus the formula 
i

j
j̸=i aib j = 
i

j
j>i (aib j + a jbi), valid for i and j spanning the same set of

MOBILE STATION LOCATION IN CELLULAR NETWORKS
651
ordered values, can be used and Det{Gc} becomes:
Det{Gc} =

i∈Sc

j∈Sc
j>i
σ −2
e,i σ −2
e, j
ui × u j
2
(13.12)
An interpretation of Det{Gc} in Equation (13.12) comes from the geometric deﬁnition of cross
product (see Figure 13.2). In a polar reference system (ρ, θ) centered at the MS position, each
unit vector
⌢ui can be expressed as
⌢ui = cos θi
⌢x + sin θi
⌢y, with θi being the angle of
⌢ui measured
counterclockwise from
⌢x. By deﬁnition, |
⌢ui ×
⌢u j|2 = (|
⌢ui||
⌢u j||sin θi, j|)2, where θij = θi −θj ; thus
|
⌢ui ×
⌢u j|2 is the area of the parallelogram determined by
⌢ui and
⌢u j, Ai j = |
⌢ui||
⌢u j||sin θi, j|, raised to
the second power. Introducing, Ai j in Equation (13.12), we have
M2
c =

i∈Sc σ −2
e,i

i∈Sc

j∈Sc
j>i
σ −2
e,i σ −2
e, j
ui × u j
2 =

i∈Sc σ −2
e,i

i∈Sc

j∈Sc
j>i
σ −2
e,i σ −2
e, j A2
i j
(13.13)
Equation (13.13) shows the dependence of the positioning accuracy on the AD measurements’
accuracy (σ e, j) and on the geometric conditioning (Ai j). Only if σe,i = σe, j
= σe the two contributions
can be separated and Mc = σ e GDOPc can be written as a product of σ e and the geometric dilution
of precision GDOPc:
GDOPc =





Nc
 
i∈Sc

j∈Sc
j>i
A2
i j
(13.14)
For a given Nc, the location accuracy improves if GDOPc is small, or equivalently if the areas Ai js
in the denominator of Equation (13.14) are large. Geometrically, this means that the unit vectors
⌢ui,
⌢u j, and then the BTSs, must be widely (angularly) separated with respect to the MS. Notice that since
|
⌢ui| = 1, Ai j = |sin(θi −θ j)|, thus GDOPc depends only on the angular distribution of the BTSs
around the MS and not on the distance between MS and BTSs, which might affect σ e, for instance.
13.1.7
Hyperbolic multilateration
In this case we have Sm = Sc = ¯Sc = 0 and ¯Sh = Sh so that Equation (13.7) gives
M2
h =

l∈Sh−{1} σ −2
f,l |w1l|2
Det{Gh}
.
(13.15)
Det{Gh} can be obtained from Equation (13.9) by retaining only the sums over indexes l and m.
Introducing the area of the parallelogram determined by w1i and w1m, Blm (see Figure 13.2), we have
M2
h =

l∈Sh−{1} σ −2
f,l |w1l|2

l∈Sh−{1}

m∈Sh−{1}
m>l
σ −2
f,l σ −2
f,m |w1l × w1m|2
=

l∈Sh−{1} σ −2
f,l |w1l|2

l∈Sh−{1}

m∈Sh−{1}
m>l
σ −2
f,l σ −2
f,m B2
lm
(13.16)
If (σ f,l = σ f,m
= σ f ), we have Mh = σ f GDOPh where
GDOPh =





l∈Sh−{1} σ −2
f,l |w1l|2

l∈Sh−{1}

m∈Sh−{1}
m>l
B2
lm
(13.17)
is the GDOP for the hyperbolic multilateration.

652
POSITIONING IN WIRELESS NETWORKS
13.1.8
Mixed multilateration
In this case Equation (13.7) gives
M2
m =
σ −2
e,1 + 
l∈Sh−{1} σ −2
f,l |w1l|2
Det{Gm}
(13.18)
because Sm = Sc = {1}, ¯Sh = Sh −{1} and ¯Sc = Sc −Sm = 0. Det{Gh} can be derived from Equa-
tion (13.9) by retaining the sums over indexes l, m and by substituting p = r = 1. Introducing the
deﬁnitions of A1m and Blm as before, the expression for M2
m, becomes
M2
m =
σ −2
e,1 + 
l∈Sh−{1} σ −2
f,l |w1l|2

l∈Sh−{1}

m∈Sh−{1}
m>l
σ −2
f,l σ −2
f,m |w1l × w1m|2 + 
m∈Sh−{1} σ −2
e,1 σ −2
f,m

⌢u1 ×
⌢um

2
=
σ −2
e,1 + 
l∈Sh−{1} σ −2
f,l |w1l|2

l∈Sh−{1}

m∈Sh−{1}
m>l
σ −2
f,l σ −2
f,m B2
lm + 
m∈Sh−{1} σ −2
e,1 σ −2
f,m A2
1m
(13.19)
A GDOP for the mixed multilateration can be deﬁned only if AD and RD measurement errors have
the same standard deviation (σe,1 = σ f,l
= σm).
GDOPm =




1 + 
l∈Sh−{1} |w1l|2

l∈Sh−{1}

m∈Sh−{1}
m>l
B2
lm + 
m∈Sh−{1} A2
1m
(13.20)
In the denominator of Equation (13.20), the areas Blms represent the RDs’ contributions, while the
area A1m represents the contribution of the AD from BTS1.
13.1.9
Performance results for three stations
When the minimum number of BTSs is available (N = 3), the location techniques are named
‘trilaterations’. GDOPc, GDOPh and GDOPm can be expressed as follows:
GDOP2
c =
3
|
⌢u1 ×
⌢u2|2 + |
⌢u1 ×
⌢u3|2 + |
⌢u2 ×
⌢u3|2 =
3
A2
12 + A2
13 + A2
23
(13.14a)
GDOP2
h = |w12|2 + |w13|2
|w12 × w13|2
= |w12|2 + |w13|2
B2
23
(13.17a)
GDOP2
m =
1 + |w12|2 + |w13|2
|w12 × w13|2 + |
⌢u1 ×
⌢u2|2 + |
⌢u1 ×
⌢u3|2 = 1 + |w12|2 + |w13|2
B2
23 + A2
12 + A2
13
(13.20a)
and analyzed in the polar reference system (ρ, θ) introduced earlier. Assuming θ1 = 0, the GDOPs
become functions of θ2, θ3 ∈[0, 2π] and can be plotted graphically. These plots can be used to deter-
mine under what conditions GDOP→∞(e.g., even with noiseless measurements, a unique solution
of the problem does not exist) or GDOP = GDOPmin (e.g., the problem is optimally conditioned).
The results generalized to any θ1 value are summarized in Figures 13.3 and 13.4 and Table 13.1
and can be interpreted as follows:
In the case of circular trilateration: (i) GDOPc →∞when θ2 ∈θ1 + {0, π}, and θ3 ∈{θ2 −
π, θ2, θ2 + π}. These conditions are met when the three BTSs lie along a straight line passing through
the MS (in fact,
⌢u1,
⌢u2, and
⌢u3 are parallel and all the cross products in the denominator of GDOPc
are null). It can be easily shown, moreover, that the alignment between all the BTSs and the MS is
the condition giving GDOPc →∞in the general case with N ≥3.
(ii)
GDOPc = GDOPc,min ˜−1.15
when
θ2 ∈θ1 + {π/3, 2π/3, 4π/3, 5π/3}
and
θ3 ∈{π −
θ2, 2π −θ2, 3π −θ2}, meaning that the BTSs are angularly separated from the MS viewpoint by

MOBILE STATION LOCATION IN CELLULAR NETWORKS
653
α
α
(a)
(b)
(c)
Figure 13.3 Inﬁnite GDOP conﬁgurations when AT = 3, x, o, and  identify the BTSs
and the center of the circumference the MS. (a) and (b) Circular, mixed, and
hyperbolic trilateration (GDOP→∞if MS and BTSs are aligned; α can be
either zero or π). (c) Hyperbolic trilateration (GDOP →∞if at least two
BTSs are aligned with the MS; α can assume any value).
(a)
α
α
α
α
(b)
α
α
(c)
α
α
(d)
Figure 13.4 Minimum GDOP conﬁgurations when N = 3. x, o, and  identify the BTSs
and the center of the circumference the MS. (a) and (b) Circular trilateration
(GDOPc = GDOPc,min if a is either π/ 3 or 2π / 3 rad). (c) Hyperbolic trilatera-
tion (GDOPh = GDOPh,min if α = 0.61π). (d) Mixed trilateration (GDOPm =
GDOPm,min if α = 0.58π).
Table 13.1
Comparison of the GDOP for the trilateration techniques
Conditions of
GDOPmin
Conditions of
GDOP→∞
value
GDOP = GDOPmin
θ2 ∈θ1 + {0, π}
θ2 ∈θ1 +
{π/3, 2π/3, 4π/3, 5π/3}
Circular
trilateration
and
1.15
and
θ3 ∈{θ2 −π, θ2, θ2 + π}
θ3 ∈{π −θ2, 2π −
θ2, 3π −θ2}
θ1 = θ2 or θ1 = θ3 or
θ2 ∈θ1 + {0.61π, 1.39π}
Hyperbolic
trilateration
θ2 = θ3 or
0.92
and
θ1 = θ2 = θ3
θ3 = 2π −θ2
θ2 ∈θ1 + {0, π}
θ2 ∈θ1 + {0.58π, 1.42π}
Mixed
trilateration
and
0.88
and
θ3 ∈{θ2 −π, θ2, θ2 + π}
θ3 = 2π −θ2

654
POSITIONING IN WIRELESS NETWORKS
either ±2π/3 (for example, θ1 = 0, θ2 = 2π/3, θ3 = −2π/3) or ±π/3 (for example, θ1 = 0,
θ2 = π/3, θ3 = −π/3). In the ﬁrst case, the BTSs are maximally separated; in the second case,
they deﬁne the same parallelograms as if they were separated by ±2π/3.
In the case of hyperbolic trilateration: (i) GDOPh →∞when at least two out of the three angles
θ1, θ2, θ3 are equal. In these conditions, at least one vector among w12 and w13 is null and B23 = 0.
Geometrically, the MS is the origin of half a straight line passing through at least two of the three
BTSs (see Figure 13.3). In the general scheme with N ≥3, GDOPh→∞when the MS is at the origin
of half a straight line passing through at least N BTSs. (ii) Numerical minimization of GDOPh results
in two minima (GDOPh,min ≃0.92) veriﬁed when θ2 ∈θ1 + {0.61π, 1.39π} and θ3 = 2π −θ2).
Finally in the case of mixed trilateration: (i) GDOPm →∞in the same conditions as GDOPc.
(ii) Numerical minimization of GDOPm results in two minima (GDOPm,min ≃0.88) veriﬁed when
θ2 ∈θ1 + {0.58π, 1.42π} and θ3 = 2π −θ2.
13.1.10
Performance results for N stations
The combined effect of number and geographical distribution of the BTSs on the GDOP is analyzed in
the regular network of hexagonal omnidirectional cells. Two relevant cases are considered. In the ﬁrst
one, the MS is located in a central cell; thus no particular restriction on the geometric conditioning is
expected to be introduced by the BTS distribution. In the second case, the MS is located in a border
cell of the network where the distribution of the available BTSs introduces serious limitations on the
geometric conditioning of the problem. For both cases, the N = 3, . . . , 10 BTSs nearest the MS are
considered, and the closest one is used as a reference station for RDs calculation.
Table 13.2 reports maximum, minimum, and mean values of GDOPc, GDOPh, and GDOPm when
the MS is located in the central cell. Analogous values for the MS located in the border cell are listed
in Table 13.3 [43].
Results in Table 13.1 prove that for N = 3 and a given value of θ1, GDOPh →∞in an un-
countable number of cases while GDOPc and GDOPm go to inﬁnity in only four cases. Table 13.3
shows that when the MS is in the border cell, GDOPh has maximum and mean values always greater
than 1 and well above the corresponding values of GDOPc and GDOPm, which in turn are compa-
rable (GDOPh,mean > GDOPm,mean > GDOPc,mean; GDOPh,max ≫GDOPm,max ≫GDOPc,max). From
the robustness point of view (of particular interest when N = 3 or when the geometry of the problem
is poor), the hyperbolic multilateration is thus the least reliable technique because a low number of
BTSs and a poor geometric conditioning offer the highest GDOP values. Moreover, when N = 3, it
is enough that two BTSs out of three are aligned with the MS to make GDOPh inﬁnite. The circular
technique, on the other hand, is the most robust technique as its GDOP has the lowest values when
the geometry of the problem is poor. When N = 3, GDOPc →∞only when the three BTSs are
Table 13.2
GDOPc, GDOPh, AND GDOPm when the MS is located in the central cell
[43] c⃝IEEE 2001
GDOPc
GDOPh
GDOPm
N
min.
max.
mean
min.
max.
mean
min.
max.
mean
3
1.15
1.53
1.24
0.94
1.50
1.14
0.92
1.45
1.12
4
1.00
1.03
1.01
0.81
0.92
0.83
0.79
0.90
0.81
5
0.89
0.91
0.91
0.71
0.76
0.73
0.70
0.74
0.71
6
0.82
0.83
0.82
0.67
0.72
0.69
0.66
0.70
0.68
7
0.76
0.77
0.76
0.65
0.70
0.67
0.64
0.69
0.66
8
0.71
0.73
0.72
0.59
0.65
0.63
0.58
0.64
0.63
9
0.67
0.68
0.68
0.58
0.59
0.59
0.58
0.59
0.58
10
0.63
0.66
0.66
0.53
0.57
0.55
0.52
0.57
0.55

RELATIVE POSITIONING IN WIRELESS SENSOR NETWORKS
655
Table 13.3
GDOPc, GDOPh, and GDOPm when the MS is located in the border cell [43]
c⃝IEEE 2001
GDOPc
GDOPh
GDOPm
N
min.
max.
mean
min.
max.
mean
min.
max.
mean
3
1.15
1.51
1.23
0.95
8.81
2.44
0.93
1.58
1.34
4
1.00
1.35
1.07
0.81
5.23
2.11
0.79
0.57
1.21
5
0.89
1.22
0.95
0.71
4.63
1.99
0.70
1.44
1.13
6
0.82
1.13
0.86
0.66
4.54
1.76
0.65
1.42
1.05
7
0.76
0.98
0.80
0.60
4.16
1.54
0.59
1.30
0.99
8
0.71
0.95
0.75
0.56
3.36
1.44
0.56
1.28
0.94
9
0.67
0.86
0.70
0.55
3.11
1.38
0.55
1.23
0.91
10
0.64
0.83
0.67
0.52
3.03
1.33
0.52
1.2
0.89
aligned. In this sense, circular and mixed techniques are equivalent (GDOPm →∞under the same
conditions as GDOPc).
For N = 3 and a ﬁxed value of θ1, GDOPc has eight minima, while GDOPh and GDOPm have
only two minima; however, GDOPm,min < GDOPh,min < 1 < GDOPc,min, meaning that when N =
3, the accuracy for the circular trilateration is always worse than the AD measurements’ accuracy
(Mc = σc · GDOPc > σc). Analogous conclusions can be drawn from Table 13.2: given N, minimum,
mean, and maximum values of GDOP calculated when the MS in the central cell satisfy the inequality
GDOPm < GDOPh < GDOPc. This simply means that when the geometric conditioning is not
problematic, the mixed and hyperbolic techniques are the most accurate while the circular technique
has the highest GDOP values.
Based on the GDOP analysis above, the mixed multilateration turns out to be the location esti-
mation technique that, among those considered in this section, offers the best compromise between
robustness and accuracy.
13.2
RELATIVE POSITIONING IN WIRELESS SENSOR NETWORKS
In this section we discuss self-conﬁguration in wireless sensor networks as a general class of estimation
problem via the Cram´er–Rao bound (CRB). Speciﬁcally, we consider sensor location estimation when
sensors measure received signal strength (RSS) or time-of-arrival (TOA) between themselves and
neighboring sensors. A small fraction of sensors in the network have a known location, whereas the
remaining locations must be estimated. CRBs and maximum-likelihood estimators (MLEs) under
Gaussian and log-normal models for the TOA and RSS measurements, are derived respectively.
We assume a network in which a small proportion of devices, called reference devices, have a
priori information about their coordinates. All devices, regardless of their absolute coordinate knowl-
edge, estimate the range between themselves and their neighboring devices. Such location estimation
is called ‘relative location’ because the range estimates collected are predominantly between pairs of
devices of which neither has absolute coordinate knowledge. These devices without a priori infor-
mation we call blindfolded devices. In cellular location estimation systems, described in the previous
section, location estimates are made using only ranges between a blindfolded device and reference
devices. Relative location estimation requires simultaneous estimation of multiple device coordinates.
Greater location estimation accuracy can be achieved as devices are added into the network, even
when new devices have no a priori coordinate information and range to just a few neighbors.
Emerging applications for wireless sensor networks will depend on automatic and accurate location
of thousands of sensors. In environmental sensing applications ‘sensing data without knowing the

656
POSITIONING IN WIRELESS NETWORKS
sensor location is meaningless’. In addition, relative location estimation may enable applications such
as inventory management, intrusion dtection, trafﬁc monitoring, and locating emergency workers in
buildings.
To design a relative location system that meets the needs of these applications, several capabilities
are necessary. The system requires a network of devices capable of peer-to-peer range measurement,
an ad-hoc networking protocol, and a distributed or centralized location estimation algorithm. For
range measurement, using received signal strength (RSS) is attractive from the point of view of
device complexity and cost but is traditionally seen as a coarse measure of range. Instead, time-of-
arrival (TOA) range measurement can be used. In this section, we will show that both RSS and TOA
measurements can lead to accurate location estimates in dense sensor networks.
13.2.1
Performance bounds
In network self-calibration problems, parameters of all devices in a network must be determined.
Information comes both from measurements made between pairs of devices and a subset of devices
that know a priori their parameters. A network self-calibration estimator estimates the unknown
device parameters. For example, distributed clock synchronization in a network could be achieved by
devices observing pair-wise timing offsets when just a small number of devices are synchronous. For
details of mutual node synchronization in wireless networks see Chapter 13 in the previous edition
of this book [45].
Speciﬁcally, consider a vector of device parameters γ = [γ1, . . . , γn+m]. Each device has one
parameter. Devices 1 . . . n are blindfolded devices, and devices n + 1 . . . n + m are reference de-
vices. The unknown parameter vector is θ = [θ1, . . . , θn], where θi = γi, for i = 1 . . . n. Note that
{γi, i = n + 1 . . . n + m} are known. Devices i and j make pair-wise observations Xi, j with density
fX/γ (Xi, j/γi, γ j). We include also the case when devices make incomplete observations since two
devices may be out of range or have limited link capacity. Let H(i) = {j: device j makes pair-wise
observations with device i}. By convention, a device cannot make a pair-wise observation with itself,
so that i/∈H(i). By symmetry, if j ∈H(i), then i∈H (j).
We assume by reciprocity that Xi ,j = Xj ,i; thus, it is sufﬁcient to consider only the lower triangle
of the observation matrix X = ((Xi ,j ))i ,j when formulating the joint likelihood function. In practice,
if it is possible to make independent observations on the links from i to j and from j to i, then we
assume that a scalar sufﬁcient statistic can be found. Finally, we assume that {Xi ,j } are statistically
independent for j < i. This assumption can be somewhat oversimpliﬁed for the RSS case but necessary
for analysis. The log of the joint conditional pdf is
l(X/γ ) =
m+n

i=1

j∈H(i)
j<i
li, j
li, j = log fX/γ (Xi, j/γi, γ j).
(13.21)
The MLE will produce the vector ˆθ = max
θ
l(X/γ ). The CRB on the covariance matrix of any unbiased
estimator ˆθ, including MLE estimator, is cov(ˆθ) ≥F−1
θ , where the Fisher information matrix (FDM)
Fθ is deﬁned as
Fθ = −E∇θ(∇θl(X/γ ))T =


f1,1
. . .
f1,n
...
...
...
fn,1
· · ·
fn,n


(13.22)
The diagonal elements fk,k of F given in Equation (13.22) are:
fk,k = E
 ∂
∂θk
l(X/θ)
2
= E


j∈H(k)
∂
∂θk
lk, j


2
fk,k =

j∈H(k)

p∈H(k)
E
 ∂
∂θk
lk, j
  ∂
∂θk
lk,p


RELATIVE POSITIONING IN WIRELESS SENSOR NETWORKS
657
Since Xk, j and Xk,p are independent random variables, and E

(∂/∂θk)lk, j
 
= 0, the expectation
of the product is only nonzero for p = j. Thus, fk,k simpliﬁes to the k = l result in Equation (13.23).
The off-diagonal elements similarly simplify:
fk,k =

j∈H(k)

p∈H(l)
E
 ∂
∂θk
lk, j
  ∂
∂θk
ll,p

Here, due to independence and zero mean of the two terms, the expectation of the product will be
zero unless both p = k and j = l. Thus, the k ̸= l result in Equation (13.23):
fk,l =



−

j∈H(k)
E
! ∂2
∂θ 2
k
lk, j
"
,
k = l
−IH(k)(l)E
!
∂2
∂θk∂θl
lk,l
"
,
k ̸= l
(13.23)
where IH (k)(l) is an indicator function: 1 if l ∈H(k) or 0 otherwise.
Intuitively, as more devices are used for location estimation, the accuracy increases for all the
devices in the network. For an n-device network, there are O(n) parameters but O(n2) variables {Xi ,j }
used for their estimation. The remaining question is, what are sufﬁcient conditions to ensure the CRB
decreases as devices are added to the network? For a network of n blindfolded devices and m reference
devices, consider adding one additional blindfolded device. For the n and (n + 1) blindfolded device
cases, let F and G be the FIMs deﬁned in Equation (13.22), respectively. If [G−1]ul is the upper left
n×n block of G−1 and if for the (n + 1) blindfolded device case
Condition (i): (∂/∂θn+1)lk,n+1 = ±(∂/∂θk)lk,n+1, ∀k = 1 . . . n and
Condition (ii): device n + 1 makes pair-wise observations between itself and at least one blind-
folded device and at least two devices in total; then it can be shown that two properties hold:
Property (i): F−1 −[G−1]ul ≥0 in the positive semi-deﬁnite sense, and
Property (ii): trF−1 > tr[G−1]ul.
The Gaussian and log-normal distributions used in the next section meet condition (i). Property (i)
implies that the additional unknown parameter introduced by the (n + l)st blindfolded device does not
impair the estimation of the original n unknown parameters. Furthermore, property (ii) implies that
the sum of the CRB variance bounds for the n unknown parameters strictly decreases. Thus, when a
blindfolded device enters a network and makes pair-wise observations with at least one blindfolded
device and at least two devices in total, the bound on the average variance of the original n coordinate
estimates is reduced.
To prove the above properties, compare F, which is the FIM for the n blindfolded device problem,
to G, which is the FIM for the n+1 blindfolded device case. Partition G into blocks:
G =
!Gul
gur
gll
glr
"
where Gul is an n × n matrix, glr is the scalar Fisher information for θn+1, and gur = gT
ll are n × 1
vectors with kth element:
gur(k) = IH(n+1)(k)E
 ∂
∂θk
ln+1
k,n+1
 
∂
∂θn+1
ln+1
k,n+1

glr =

j∈H(n+1)
E
 ∂
∂θk
ln+1
n+1, j
2
Here, we denote the log-likelihood of the observation between devices i and j in Equation (13.21)
as ln
i, jand ln+1
i, j for the n and (n + 1) blindfolded device cases, respectively. If ln(X|γ n) and ln+1(X|γ n+1)
are the joint log-likelihood function in Equation (13.21) for the n and n + 1 blindfolded device cases,

658
POSITIONING IN WIRELESS NETWORKS
respectively, then we have:
ln+1(X/γ n+1) =
m+n+1

i=1

j∈H(i)
j<i
ln+1
i, j
= ln(X/γ n) +

j∈H(n+1)
ln+1
n+1, j
Since ln+1
n+1, j is a function only of parameters γn+1 = θn+1 and γ j, then
∂2
∂θk∂θl

j∈H(n+1)
ln+1
n+1, j =



IH(n+1)(k) ∂2
∂θ2
k ln+1
n+1,k,
l = k
0,
l ̸= k.
Thus, Gul = F + diag(h), where h = {h1, . . . , hn}, and hk = IH (n+1)(k)E((∂/∂θk)ln+1
n+1,k)2. Compare
the CRB for the covariance matrix of the ﬁrst n devices in the n and n + 1 device cases, given by F−1
and [G−1]ul, respectively. Here, [G−1]ul is the upper left n × n submatrix of G−1:
#
G−1$
ul =
%
Gul −gurg−1
lr gll
&−1 = {F + J}−1
where J = diag(h)−gurgT
ur/glr.Both F and J are Hermitian. We know that F is positive semideﬁnite.
Let λk(F), k = 1• • • n be the eigenvalues of F and λk(F + J), k = 1• • • n be the eigenvalues of the
sum, both listed in increasing order. Then, if we can show that J is positive semideﬁnite, then it is
known [46] that
0 ≤λk(F) ≤λk(F + J),
∀k = 1, . . . , n
(13.24)
Since the eigenvalues of a matrix inverse are the inverses of the eigenvalues of the matrix
λk
{F + J}−1 
≤λk(F−1),
∀k = 1, . . . , n.
(13.25)
which proves Property (i). If we can show that tr(J) > 0, then tr(F + J) > tr(F), and therefore,
n
k=1 λk(F + J) > n
k=1 λk(F). This, with (13.24), implies that λ j(F + J) > λ j(F) for at least one
j ∈1 . . . n. So, in addition to (13.25) λ j
{F + J}−1 
< λ j(F−1), for some j ∈1, . . . n, that implies
tr({F + J}−1) < tr(F−1) which proves Property (ii).
To show positive semideﬁniteness and positive trace of J we notice that the diagonal elements of
J, [J]k,k are
[J]k,k = hk −g2
ur(k)/glr.
(13.26)
If k /∈H(n + 1), then hk = 0 and gur(k) = 0; thus, [J]k,k = 0. Otherwise, if k ∈H(n + 1)
[J]k,k = E
'
∂ln+1
n+1,k
∂θk
(2
−
!
E

∂ln+1
n+1,k
∂θk
 
∂ln+1
n+1,k
∂θn+1
"2

j∈H(n+1)
E

∂ln+1
n+1, j
∂θn+1
2
Because of reciprocity, the numerator is equal to the square of the j = k term in the sum in the
denominator. Thus:
[J]k,k ≥E
'
∂ln+1
n+1,k
∂θk
(2
−E
'
∂ln+1
n+1,k
∂θk
( '
∂ln+1
n+1,k
∂θn+1
(
= 0
The equality will hold if k is the only member of the set H(n + 1). When Condition (ii) holds,
[J]k,k will be strictly greater than zero. Thus, trJ > 0. Next, we show that J is diagonally dominant
[46], i.e.
[J]k,k ≥
n

j=1
j̸=k
[J]k, j
 =
n

j=1
j̸=k
|gll(k)gll( j)|
glr

RELATIVE POSITIONING IN WIRELESS SENSOR NETWORKS
659
where [J]k,k is given in Equation (13.26). Since H(n + 1) ̸= 0, thus, glr > 0, and an equivalent
condition is
glrhk ≥|gur(k)|
n

j=1
|gur( j)|
(13.27)
If k /∈H(n + 1), then hk = 0 and gur(k) = 0 and equality holds. If k ∈H(n + 1), then
9lrhk = E
'
∂ln+1
k,n+1
∂θk
(2

j∈H(n+1)
E
'
∂ln+1
n+1, j
∂θn+1
(2
Due to Condition (i)
E
'
∂ln+1
k,n+1
∂θk
(2
=
E
'
∂ln+1
k,n+1
∂θn+1
(
E
'
∂ln+1
k,n+1
∂θk
(
Thus
glrhk = |gur(k)|



j≥1
j∈H(n+1)
|gur( j)| +

j<0
j∈H(n+1)
E
'
∂ln+1
j,n+1
∂θn+1
∂ln+1
j,n+1
∂θ j
(


Since gur(j) = 0 if j ∈H(n + 1), we can include in the ﬁrst sum all j ∈1 . . . n. Since the second
sum is ≥0, (13.27) is true.
Diagonal dominance implies that J is positive semideﬁnite, which proves (13.25). Note that if
H(n+1) includes ≥1 reference device, the second sum is >0, and the inequality in (13.27) is strictly
>0, which implies positive deﬁniteness of J and assures that the CRB will strictly decrease.
13.2.2
Relative location estimation
Here we use the general framework from the previous section for device location estimation us-
ing pair-wise RSS or TOA measurements in a wireless network. For a network of m reference
and n blindfolded devices, the device parameters are γ = [z1, . . . , zm +n], where, for a two-
dimensional (2D) system, zi = [xi, yi]T . An extension of these results to 3D is also possible.
The relative location problem corresponds to the estimation of blindfolded device coordinates
θ = [θ x, θ y] (where θx = [x1, . . . , xn], θy = [y1, . . . , yn]) given the known reference coordinates
[xn+1, . . . , xn+m, yn+1, . . . , yn+m]. In the TOA case, Xi ,j = Ti ,j is the measured TOA between devices
i and j in (seconds), and in the RSS case, Xi ,j = Pi ,j is the measured received power at device i trans-
mitted by device j (in milliwatts). As discussed in the previous section, only a subset H(k) of devices
make pair-wise measurements with device k, ((Ti ,j ))i ,j and ((Pi ,j ))i ,j are taken to be upper triangular
matrices, and these measurements are assumed statistically independent. In addition, assume that Ti. j
is Gaussian distributed with mean di ,j /c and variance σ 2
T , which is denoted:
Ti, j ∼N(di, j/c, σ 2
T ),
di, j = d(zi, z j) =
))zi −z j
))1/2
(13.28)
where c is the speed of propagation, and σ 2
T is not a function of di ,j . We assume that Pi ,j is log-normal;
thus, the random variable Pi ,j (dBm) = 10log10 Pi ,j is Gaussian:
Pi, j(dBm) ∼N( ¯Pi, j(dBm), σ 2
dB)
¯Pi, j(dBm) = P0(dBm) −10n p log10(di, j/d0)
(13.29)
where ¯Pi, j (dBm) is the mean power in decibel milliwatts, σ 2
dB is the variance of the shadowing, and
P0 (dBm) is the received power in decibel milliwatts at a reference distance d0. Typically, d0 = 1 m,
and P0 is calculated from the free space path loss formula. The path loss exponent np is a function of
the environment. For particular environments, np may be known from prior measurements. Although
we derive the CRB assuming np is known, it could have been handled as an unknown ‘nuisance’
parameter.

660
POSITIONING IN WIRELESS NETWORKS
Given (13.28), the density of Pi, j is
fP/γ (Pi, j/γ ) = 10/ log 10

2πσ 2
dB
1
Pi, j
exp

−b
8
'
log
d2
i, j
˜d2
i, j
(
b =

10n p
σdB log 10
2
;
˜di, j = d0
 P0
Pi, j
1/n p
(13.30)
Here, ˜di, j is the MLE of range di ,j given received power Pi ,j .
For simplicity let us ﬁrst consider one-dimensional TOA example that could, be applied to location
estimation on an assembly line. Consider n blindfolded devices and m reference devices with combined
parameter vector γ = [x1, . . . , xn+m]. The unknown coordinate vector is θ = [x1, . . . , xn]. Assume
all devices make pair-wise measurements with every other device, i.e. H(k) = {1, . . . , k −1, k +
1, . . . , m + n}. The distribution of the observations is given by (13.28) with di, j =
x j −xi
 and
li, j = (∂2/∂x2
j )li, j = −(∂2/∂x j∂xi)li, j = −1/σ 2
T c2, ∀i ̸= j, which are constant with respect to the
random variables Ti ,j . Thus, the FIM, which is calculated using Equation (13.23), is FT = [(n + m)In −
11T ]/(σT c
  2, where In is the n×n identity matrix, and 1 is an n by 1 vector of ones. For m ≥1,
F−1
T
= σ 2
T c2 #
mIn + 11T $
/ (m(n + m)).
The CRB on the variance of an unbiased estimator for xi is:
σ 2
xi ≥σ 2
T c2 (m + 1) / (m(n + m)) .
(13.31)
Equation (13.31) implies that the variance σ 2
xi is reduced more quickly by adding reference (m)
than blindfolded (n) devices. However, if m, is large, the difference between increasing m and n is
negligible.
In the case of two-dimensional location estimation we denote by FR and Ft the FIMs for the RSS
and TOA measurements, respectively. Each device has two parameters, and we can see that the FIM
will have a similar form to Equation (13.22) if partitioned into blocks
FR =
!FRxx
FRxy
FT
Rxy
FRyy
"
,
FT =
!FT xx
FT xy
FT
T xy
FT yy
"
(13.32)
where FRxx and FT xx are given by Equation (13.22) using only the x paramether vector θ = θ x, and
FRyy and FT yy are given by Equation (13.22) using only θ = θ y. The off-diagonal blocks FR xy and
FT xy are similarly derived.
To derive the elements of the submatrices of Equation (13.32) for FR, we use Equation (13.30)
and (13.21) to get
li, j = log
'
10 log 10

2πσ 2
dB
1
Pi, j
(
−b
8
'
log
d2
i, j
ˆd2
i, j
(2
.
(13.33)
Since di, j =

(xi −x j)2 + (yi −y j)2 we have
∂
∂x j
li, j = −b
2
'
log
d2
i, j
ˆd2
i, j
(
x j −xi
d2
i, j
(13.34)
Since (∂/∂x j)li, j = −(∂/∂x j)li, j, the log-normal distribution of RSS measurements meets Con-
dition (i). The second partials differ based on whether or not i = j and if the partial is taken w.r.t. yi
or xi. For example:
∂2li, j
∂x j∂y j
= −b (xi −x j)(yi −y j)
d4
i, j

−log
'
d2
i, j
ˆd2
i, j
(
+ 1

∂2li, j
∂x j∂yi
= −b (xi −x j)(yi −y j)
d4
i, j

−log
'
d2
i, j
ˆd2
i, j
(
−1

(13.35)

RELATIVE POSITIONING IN WIRELESS SENSOR NETWORKS
661
Since E[log(d2
i, j/ˆd2
i, j)] = 0, the FIM simpliﬁes to take the form:
[FRxx]k,l =



b 
i∈H(k)
(xk−xi )2
∥zk−zi ∥4 ,
k = l
−bIH(k)(l) (xk−xl)2
∥zk−zl∥4 ,
k ̸= l
#
FRxy
$
k,l =



b 
i∈H(k)
(xk−xi )(yk−yi )
∥zk−zi ∥4
,
k = l
−bIH(k)(l) (xk−xl)(yk−yl)
∥zk−zl∥4
,
k ̸= l
#
FRyy
$
k,l =



b 
i∈H(k)
(yk−yi )2
∥zk−zi ∥4 ,
k = l
−bIH(k)(l) (yk−yl)2
∥zk−zl∥4 ,
k ̸= l
(13.36)
For the TOA case, the derivation is very similar, and the details are omitted for brevity:
[FT xx]k,l =



1
c2σ 2
T

i∈H(k)
(xk−xi )2
∥zk−zi ∥2 ,
k = l
−
1
c2σ 2
T IH(k)(l) (xk−xl)2
∥zk−zl∥2 ,
k ̸= l
#
FT xy
$
k,l =



1
c2σ 2
T

i∈H(k)
(xk−xi )(yk−yi )
∥zk−zi ∥2
,
k = l
−
1
c2σ 2
T IH(k)(l) (xk−xl)(yk−yl)
∥zk−zl∥2
,
k ̸= l
#
FT yy
$
k,l =



1
c2σ 2
T

i∈H(k)
(yk−yi )2
∥zk−zi ∥2 ,
k = l
−
1
c2σ 2
T IH(k)(l) (yk−yl)2
∥zk−zl∥2 ,
k ̸= l
(13.37)
Note that FR ∝n2
p/σ 2
dB while FT ∝1/(c2σ 2
T). These SNR quantities directly affect the CRB. For
TOA measurements, the dependence on the device coordinates is in unitless distance ratios, indicating
that the size of the system can be scaled without changing the CRB as long as the geometry is kept
the same. However, in the case of RSS measurements, the variance bound scales with the size of the
system even if the geometry is kept the same due to the d4 terms in the denominator of each term
of FR. These scaling characteristics indicate that TOA measurements would be preferred for sparse
networks, but for sufﬁciently high density, RSS can perform as well as TOA.
If ˆxi and ˆyi are unbiased estimates of xi and yi, for the case of TOA measurements, the trace of
the covariance of these estimate satisﬁes:
σ 2
i
= tr{covθ(ˆxi, ˆyi)} = Varθ(ˆxi) + Varθ(ˆyi) ≥
≥
#
FT xx −FT xyF−1
T yyF−1
T xy
$−1
i,i +
#
FT yy −FT xyF−1
T xxF−1
T xy
$−1
i,i
(13.38)
For RSS measurements, Fy in Equation (13.38) should be replaced with FR. For the case of one
blindfolded device, a simple expression can be derived for both RSS and TOA measurements.
Consider the network having blindfolded device 1 and reference devices 2 . . . m + 1. This example,
with a single pair of unknowns x1 and y1, is equivalent to many existing location systems, and a bound
for the variance of the location estimator has already been derived in for TOA measurements in
Section 13.1. In the case of RSS measurements:
σ 2
1
= E
#
(ˆx1 −x1)2 + (ˆy1 −y1)2$
≥
FRxx + FRyy
FRxx FRyy −F2
Rxy
from which we obtain
σ 2
1
= 1
b
m+1

i=2
d−2
1,i
m
i=2
m+1

j=i+1

d1⊥i, j ,di, j
d2
1,i d2
1, j
2

662
POSITIONING IN WIRELESS NETWORKS
where the distance d1⊥i, j is the shortest distance from the point (x1, y1) to the line segment connecting
device i and device j. For the case of TOA measurements, we obtain:
σ 2
1
= c2σ 2
T m


m

i=2
m+1

j=i+1
'
d1⊥i, j, di, j
d1,id1, j
(2

−1
(13.39)
In Section 13.1, the ratio d1⊥i, j, di, j/(d1,id1, j) has been called the geometric conditioning Ai, j of
device 1 w.r.t. references i and j. Ai, j is the area of the parallelogram speciﬁed by the vectors from
device 1 to i and from device 1 to j, normalized by the lengths of the two vectors. The geometric
dilution of precision (GDOP), which is deﬁned as σ1/(cσ T ), is
GODP =





m
m
i=2
m+1

j=i+1
A2
i, j
which matches the result in (13.14). The CRBs are shown in Figure 13.5 when there are four reference
devices located in the corners of a 1 by 1 m square. The minimum of Figure 13.5(a) is 0.27. Since
the CRB scales with size in the RSS case, the standard deviation of unbiased location estimates in
a traditional RSS system operating in a channel with σd B / np = 1.7 is limited to about 27 % of the
distance between reference devices. This performance has prevented use of RSS in many existing
location systems and is the motive for having many blindfolded devices in the network. Note that in
the TOA case, σ1 is proportional to cσ T and thus, cσ T = 1 was chosen in Figure 13.5(b).
For general n and m, we calculate the MLE of θ. In the case of TOA measurements, the MLE is:
ˆθ T = arg min
{zi }
m+n

i=1

j∈H(i)
j<i
(cTi, j −d(zi, z j))2
(13.40)
where zi = [xi, yi]T . The MLE for the RSS case is:
ˆθ ˜R = arg min
{zi }
m+n

i=1

j∈H(i)
j<i
'
ln
˜d2
i, j
d2(zi, z j)
(2
.
(13.41)
Unlike the MLE based on TOA measurements, the RSS MLE is readily shown to be biased.
Speciﬁcally, for a single reference and single blindfolded device, the range estimate between the two
devices is ˜d1,2. Using Equation (13.30), the mean of ˜d1,2 is given by:
E[˜d1,2] = Cd1,2, where, C = exp

1
2
ln(10)
10
σdB
n p
2
(13.42)
Figure 13.5 σ1 (in meters) for the example system versus the coordinates of the single
blindfolded node for (a) RSS with σd B/n = 1.7 or (b) TOA with cσT = 1 m
c⃝IEEE 2003.

RELATIVE POSITIONING IN WIRELESS SENSOR NETWORKS
663
For typical channels, C ≈1.2, adding 20 % bias to the range. Motivated by Equation (13.42), a
bias-reduced MLE can be deﬁned as:
ˆθ R = arg min
{zi }
m+n

i=1

j∈H(i)
j<i
'
ln
˜d2
i, j/C2
d2(zi, z j)
(2
(13.43)
However, there remains residual bias. Estimation results using methodology presented in this
section and measurements from [44] are shown in Figures 13.6 and 13.7.
−2
0
2
4
6
8
10
12
−4
−2
0
2
4
6
8
10 (m)
(m)
36T
37T
20T 17T
2T
1T
19T18T
7T
5T
34T
39T
38T
16T 21T
4T
6T
8T
9T
11T
12T
22T
28T
26T
27T
23T
30T
31T
29T
43T 42T
32T
41T
13T
14T
24T
25T
15T
33T
40T
37E
36E
34E
32E
38E
39E
19E
2E
4E
17E
33E
40E
41E
43E
42E
21E
20E
1E
5E
7E
6E
16E
18E
22E
23E
5E
24E
25E
29E
31E
13E
30E
28E
9E
8E
26E
14E
27E
(a)
12E
11E
44
35
3
10
0
2
4
6
8
10
12
−4
−2
0
2
4
6
8
10 (m)
(m)
36T
37T
20T 17T
2T
1T
19T 18T
7T
5T
34T
39T
38T
16T
21T
4T
6T
8T
9T
11T
12T
22T
28T
26T
27T
23T
30T
31T
29T
43T
42T
32T
41T
13T
14T
24T
25T
15T
33T
40T
37E
36E
34E
32E
38E
39E
19E
2E
4E
17E
33E40E
41E
43E
42E
21E
20E
1E
5E
7E
6E
16E
18E
22E
23E
15E
24E
25E
29E
31E
13E
30E
28E
9E
8E
26E
14E
27E
(b)
12E
11E
44
35
3
10
Figure 13.6 True (•#T) and estimated (▼#E) location using (a) RSS, and (b) TOA data
for measured network with four reference devices (X#). Higher errors are
indicated by darker text [44] c⃝IEEE 2003.

664
POSITIONING IN WIRELESS NETWORKS
0
3
6
9
(a)
(m)
9
6
3
0
(m)
13
4
1
16
5E
2E
3E
6E
7E
9E
10E
15E
14E
8E
12E
11E
2T
3T
6T
5T
7T
8T
9T
10T
14T
15T
11T
12T
0
3
6
9
(b)
(m)
9
6
3
0
(m)
13
4
1
16
5E
3E
6E
7E
9E
10E
15E
14E
8E
12E
11E
2T
3T
6T
5T
7T
8T
9T
10T
14T
15T
11T
12T
2E
Figure 13.7 True (• #T) and estimated (▼#E) location for the (a) parking lot, and (b)
residential home tests using four reference devices (X#). Higher errors are
indicated by darker text [44] c⃝IEEE 2003.
13.3
AVERAGE PERFORMANCE OF CIRCULAR
AND HYPERBOLIC GEOLOCATION
In this section we provide more details on performance analysis of geolocation methods in terms
of their theoretical positioning errors. Comparison is established in two different ways: strict and
average. As in Section 13.1, in the strict type, methods are examined for a particular geometric
conﬁguration of base stations (BSs) with respect to mobile position, which determines a given noise
proﬁle affecting the estimates. In the average type, methods are evaluated in terms of the expected
covariance matrix of the position error over an ensemble of random geometries, so that comparison
is geometry independent.
In this section, the accuracy of four geolocation methods is deﬁned in terms of their position
error covariance matrices: (i) Cst–circular with known clock (ii) Cs¯t–circular with unknown clock
(iii) Chc–hyperbolic correlated, and (iv) Ch¯c–hyperbolic uncorrelated. In scenario (i), the available
measurements consist of the absolute TOAs of the signals transmitted between the mobile and
the beacons. A circular technique is used to compute the position estimate. In scenario (ii), the
available measurements consist of the pseudo-TOAs of the signals transmitted between the mobile
and the beacons. A circular technique is used to compute the position estimate along with the clock
offset. In scenario (iii), the available measurements consist of the TDOAs obtained from differences
between pairs of pseudo-TOAs. A hyperbolic technique is used to compute the position estimate. In
scenario (iv), the available measurements consist of uncorrelated TDOAs obtained at different times.
A hyperbolic technique is used to compute the position estimate.
13.3.1
Signal models and performance limits
For circular methods, the TOA/pseudo-TOA measurements obtained from N beacons can be expressed
as a function of the mobile position x = [x1, x2]T as:
ˆtn = ˜tn(x, t0) + un = tn(x) + to + un
(13.44)
where tn(x) = 1
c ∥x −xn∥, xn =
#
x1,n, x2,n
$T is the nth beacon position, for 1 ≤n ≤N, to is the
clock offset, which has the same value for all n, un are the measurement errors, and c is the speed of
light. Note that to = 0 in the case of absolute TOAs, while it becomes an unknown parameter in the
case of pseudo-TOAs.

AVERAGE PERFORMANCE OF CIRCULAR AND HYPERBOLIC GEOLOCATION
665
If the measurements be stacked into vector ˆt, we have:
ˆt = ˜t(x, t0) + u = ˜t(x) + t01 + u
(13.45)
where 1 is the all-ones column vector. The N×N covariance matrix of the noise vector u is R =
E[uuT ]. It is assumed throughout the section that matrix R is known. In practice, R is to be estimated,
with a consequent degradation in the performance.
For hyperbolic methods the (N −1) TDOA measurements are given by:
ˆd = H˜t(x, t0) + v = Ht(x) + v
(13.46)
with H representing any full-rank (N −1) × N matrix such that H1 = 0, where 0 is the all-zeros
column vector. Note that this condition implies that the measurement vector ˆd is not affected by the
presence of the nonzero clock offset to in Equation (13.46). The common example of H is H = [1, −I],
where all TDOAs are obtained with respect to a common pseudo-TOA. This ﬁrst (or reference)
pseudo-TOA corresponds to the all-ones column of H, and will henceforth be called the pivot BS.
The analysis in this section is general for any H, unless otherwise stated. The (N −1) × (N −1)
covariance matrix of the noise vector v is Rh = E[vvT ]. Only in the ‘hyperbolic-correlated’ scenario,
are the TDOAs are computed as ˆd = H˜t, and then it holds from Equation (13.45) that v = Hu, and
Rh = Rhc = HRHT . However, in the ‘hyperbolic-uncorrelated’ scenario, the structures of Rh = Rh¯c
and R are not necessarily related in a simple way. Indeed, in the ‘hyperbolic-uncorrelated’ scenario,
matrix H in Equation (13.46) only shows how the pairs of BS are selected to obtain the N −1 TDOA
measurements, but measurements remain independent. In that scenario, the relationship between Rh¯c
and R for any H can be expressed asRh = Rh¯c = (HRHT )◦I where ‘◦’ stands for the component-wise
Schur–Hadamard product between two matrices. Rhc and Rh¯care the speciﬁc versions of Rh for the
correlated and uncorrelated version, respectively, of the hyperbolic approach.
The performance limits are computed as the performance of the linearized weighted least squares
(WLS) estimator, which coincides with the Cramer–Rao bound in the case of Gaussian noise.
As in Equation (13.2) for circular approaches, the linearization of Equation (13.45) at the true
position yields
ˆt = Fx + t01 + u
(13.47)
where the N × 2 matrix of partial derivatives F can be calculated as:
[F]n,i = ∂tn(x)
∂xi
= 1
c
xi −xi,n
∥x −xn∥= 1
c
xi −xi,n

x1 −x1,n
 2 +

x2 −x2,n
 2
(13.48)
with i = 1, 2, and where [M]l,l′ denotes the lth row l’th column element of a matrix M. The WLS
estimator [48] of x and to is the minimizer of

ˆt −Fx −t01
 T R−1 
ˆt −Fx −t01
 
(13.49)
which, using standard differential matrix calculus, can be expressed as:
! x
t0
"
=

FT
1 R−1F1
 −1 FT
1 R−1ˆt
(13.50)
where F1 = [F, 1], and the covariance matrix of x is given by Cs¯t = TT 
FT
1 R−1F1
 −1 T with T T =
[I, 0]. Following the same procedure, the covariance matrix of x in the case of known clock to is
Cst =

FT
1 R−1F1
 −1
For hyperbolic approaches, we have the linearization of Equation (13.46) that can be written as:
ˆd = HFx + v
(13.51)
and the WLS estimator of x becomes the minimizer of

ˆd −HFx
T
R−1
h

ˆd −HFx

(13.52)

666
POSITIONING IN WIRELESS NETWORKS
given by
x =

FT HT R−1
h HF
 −1 FT HT R−1
h ˆd
(13.53)
with covariance matrix Ch =

FT HT R−1
h HF
 −1 where the subindex in Ch and Rh stands for a generic
hyperbolic approach. For the uncorrelated hyperbolic approach, this covariance matrix bocomes:
Ch¯c =

FT HT R−1
h¯c HF
 −1 =

FT HT #
HRHT  
◦I
$−1 HF
−1
(13.54)
and, in the speciﬁc case that the TDOAs are computed as differences between pseudo-TOAs (corre-
lated hyperbolic approach), we have Rh = Rhc = HRHT, and the corresponding covariance matrix
is given by
Chc =

FT HT R−1
h¯c HF
 −1
Chc =

FT HT 
HRHT  −1 HF
−1
.
(13.55)
13.3.2
Performance of location techniques
From the previous section we have for C−1
s¯t and C−1
hc :
C−1
s¯t =

TT 
FT
1 R−1F1
 −1 T
−1
C−1
hc = FT 
HT 
HRHT  −1 H

FT
(13.56)
By forming the product FT
1 R−1F1 in C−1
s¯t , as:
FT
1 R−1F1 =

FT
1T

R−1 # F 1 $
=

FT R−1F FT R−11
1T R−1F 1T R−11

(13.57)
and using block matrix inversion in Equation (13.57), we have:
FT
1 R−1F1 =
! B11 b12
bH
21 β
"
B11 =
!
FT R−1F −FT R−111T R−1F
1T R−11
"−1
We also have from (13.56) that:
C−1
s¯t =
!# I 0 $ 
FT
1 R−1F1
 −1 ! I
0T
""
= B−1
11
B−1
11 = FT R−1F −FT R−111T R−1F
1T R−11
= FT

R−1 −R−111T R−1
1T R−11

F
(13.58)
By using the fact that
R−1 −R−111T R−1
1T R−11
= HT (HRHT )−1H
(13.59)
is true for any matrix H that fulﬁlls H1 = 0, we have
result 1
Cs¯t = Chc
(13.60)

AVERAGE PERFORMANCE OF CIRCULAR AND HYPERBOLIC GEOLOCATION
667
Proof of Equation (13.59): If  is a matrix and G is any Gram matrix, the matrix G⊥
 is a
projection matrix
G⊥
 = G −G[T G]−1T G
that fulﬁlls G⊥
 = G −G[T G]−1T G = 0.
Hence, for G = R and  = HT , we have R⊥
HT = R −RHT (HRHT )−1HR
and R⊥
HT HT = 0. Consequently, R⊥
HT has rank one (because H is almost full rank) and R⊥
HT
= λaaT , with Ha = 0. Therefore, a = 1 fulﬁlls the required orthogonality with the columns of H
and R −RHT (HRHT )−1HR = λ11T .
Multiplying by R−1 on both sides R−1 −HT (HRHT )−1H = λR−111T R−1.
Now, as H1 = 0, multiplication by 1T and 1 on both sides yields 1T R−1 1 = λ1T R−111T R−11.
Thus, λ = (1T R−11)−1, and R−1 −HT (HRHT )−1H = R−111T R−1
1T R−11
which is Equation (13.59).
Next we compare Cs¯t = TT 
FT
1 R−1F1
 −1 T and Cst =

FT
1 R−1F1
 −1 to prove that Cs¯t > Cst for
any geometry or noise proﬁle. We know from Equation (13.58) that
C−1
s¯t = FT

R−1 −R−111T R−1
1T R−11

F.
(13.61)
Hence
C−1
s¯t = C−1
st −qqT
(13.62)
where
q = FT R−11
√
1T R−11
.
(13.63)
Using the matrix inversion lemma in Equation (13.62), we see that Cs¯tis more positive deﬁnite
than Cst (i.e., Cs¯t −Cst is a positive deﬁnite matrix), giving
result 2
Cs¯t = Cst +
qqT
1 + qT Cstq ≥Cst
(13.64)
and we conclude from Equation (13.64) that absolute TOA measurements generate a Cst smaller than
Cs¯t for any geometry or noise correlation. However, Cst and Cs¯t are not simply related by a scaling
factor.
Strict comparison between Chc and Ch¯c is not possible, as some scenarios will deliver better
performance for Chc and others will not. The judgment as to which method is better, and to what
extent, will require the average performance analysis that is presented in the next section.
13.3.3
Average performance of location techniques
This section presents an efﬁcient procedure for comparing algorithms in terms of their average
covariance matrix, as well as an analytical lower bound in the positive deﬁnite sense. The placement
of BSs is deﬁned according to a uniform random distribution on a circular area centered at the true
mobile position, and depending on a density parameter ρ (BS/km2).
From Section 13.3.1 and Equations (13.54), and (13.55), the covariance matrices of the four
geolocation algorithms can be expressed as:
C =

FT AF
 −1
(13.65)

668
POSITIONING IN WIRELESS NETWORKS
where A is referred to as the information matrix. As deﬁned in Section 13.3.1, we have for each
geolocation algorithm:
Ast = R−1
As¯t = HT (HRHT )−1H
Ahc = As¯t
Ah¯c = HT [(HRHT ) ◦I]−1H.
(13.66)
In Equation (13.65), geometrical information is included in matrix F and in the noise power
distribution deﬁned by the measurement covariance matrix R. From Equation (13.48), the rows of
F constitute the directive cosines of the vectors aligned with the paths from the mobile to the base
stations (or generic references) with respect to the coordinate axes. Then:
F = F(α) = 1
c


cos(α1)
sin(α1)
cos(α2)
sin(α2)
cos(αN)
sin(αN)


(13.67)
with α = [α1, α2, . . . , αN]T, and αn the angle with respect to the horizontal coordinate axis of the
vector from the mobile to the nth BS. The diagonal of R contains the noise power of all individual
pseudo-TOA measurements, which depends mainly on the distance between the mobile and each
BS. So, the speciﬁc position of the BSs affects the covariance matrix C in two different ways: in
their angular distribution implicit in F, and in their distance distribution implicit in R. Hence, the
geometry-independent average of the position error covariance matrix can be expressed as:
C = EG
*
FT AF
 −1+
= EN Eα
*
FT AF
 −1+
(13.68)
with EG the expectation operator with respect to all possible geometry scenarios, which can be
split into the expected value with respect to the angles α, (Eα), and the expected value with respect
to the power distribution (EN) (related to the distance distribution). Its analytical computation is
too involved due to the particular way in which geometry affects the covariance structure. So, the
expression derived in the sequel exploits a rotational property of the 2D location case in such a way
that the structure of Equation (13.68) can be studied without computing its expected value analytically.
For convenience, let us deﬁne the expectation with respect to the angles in (13.68) as CN:
C = ENCN
(13.69)
where
CN = Eα
,
FT AF
 −1-
.
(13.70)
The angles α are independent, uniformly distributed random variables in [0, 2π] due to the
uniform random placement of BSs in the coverage area. Thus, the inﬁnite set of all possible angular
conﬁgurations of the BSs can be divided into an inﬁnite number of subsets within which angular
conﬁgurations differ in a rotation. That is:
[α1, α2, . . . , αN] = α1 · 1T + [0, α2 −α1, . . . , αN −α1]
(13.71)
with the rotated angles αi −α1, 2 ≤i ≤N a set of mutually independent random variables uniformly
distributed in [0, 2π] and also independent of the equally uniformly distributed leading angle α1. Then,
the expectation (Eα) in Equation (13.70) can be expressed as the composition of two expectations:
the expectation over the rotation α1 applied to the expectation over the subset of rotated angles SS =
{αi - α1, 2 ≤i ≤N}. From this division into subsets of the geometry, Equation (13.70) becomes:
CN = ESS Eβ
*
FT
SS,βAFSS,β
 −1+
(13.72)
where FSS,β denotes F for a particular rotation angle β = α1 and subset conﬁguration. From Equation
(13.71), we can express the generic subset FT
SS,βmatrix as FT
SS,β = GβFT
SS, where FT
SS = FT
SS.0 denotes

AVERAGE PERFORMANCE OF CIRCULAR AND HYPERBOLIC GEOLOCATION
669
the canonic F matrix of the subset in the speciﬁc case β = 0, and Gβ is a unitary-rotation matrix
deﬁned as:
Gβ =
!cos(β)
sin(β)
−sin(β)
cos(β)
"
.
(13.73)
Now, Equation (13.72) can be expressed as:
CN = ESS Eβ
*
GβFT
SSAFSSGT
β
 −1+
= ESS Eβ
*
Gβ

FT
SSAFSS
 −1 GT
β
+
(13.74)
since Gβ is unitary. The expectation over β gives
CN = 1
2 ESStr
.
FT
SSAFSS
 −1/
· I
(13.75)
Proof of (13.75) : Here we prove that for symmetric matrix A holds
B = Eβ[GβAGT
β ] = 1
2tr{A} · I
where Eβ denotes the expectation operation over β. A is a 2×2 matrix:
A =

a11
a12
a21
a22

and Gβ is the previously deﬁned unitary rotation matrix:
Gβ =

cos(β)
sin(β)
−sin(β)
cos(β)

Then, the expectation over the uniformly distributed random variable β can be expressed as
Eβ[GβAGT
β ] =

b11
b12
b21
b22

Now, taking the expectation over the uniform distribution of β,
b11 = a11 + a22
2
, b12 = a12 −a21
2
, b21 = a21 −a12
2
, b22 = a11 + a22
2
For A a symmetric matrix, we ﬁnally obtain:
Eβ[GβAGT
β ] =
 a11+a22
2
0
0
a11+a22
2

= 1
2tr{A} · I
Applying Equation (13.75) in (13.69) to the four algorithms associated with the information
matrices A deﬁned in Equation (13.66), we obtain:
Cst = 1
2 EN,SStr
.
FT
SSR−1FSS
 −1/
· I
Cs¯t = 1
2 EN,SStr
.
FT
SSHT (HRHT )−1FSS
 −1/
· I
Chc = Cs¯t
Chc = 1
2 EN,SStr
0
FT
SSHT #
(HRHT ) ◦I
$−1 HFSS
−11
· I
(13.76)
As an illustration, numerical results for (13.76) are presented in Figures 13.8 and 13.9 with the
same parameters as in [47]. A completely random uniform distribution of the BSs in the visibility
circle of the mobile is assumed. It is also assumed that the mobile can observe BSs within a radius of
R m where BSs are uniformly distributed with a certain density of ρ BS/km2.

670
POSITIONING IN WIRELESS NETWORKS
1
2
3
4
5
6
7
10
2
10
3
r.m.s position error
Visibility range (R in kms)
Position error (m)
Hyperbolic uncorrelated (Worst case)
Hyperbolic uncorrelated (Best Case)
Hyperbolic
Circular
Figure 13.8 Mean performance with a constant BS density of ρ = 0.25 BS/km2.
0
0.25
0.5
0.75
1
1.25
1.5
10
2
10
3
r.m.s position error
BS density (BS/km2)
Position error (m)
Hyperbolic uncorrelated (Worst case)
Hyperbolic uncorrelated (Best Case)
Hyperbolic
Circular
Figure 13.9 Mean performance with a constant visibility range of 3 km.
If d is the distance from the mobile to a randomly selected beacon, then the probability density
function (pdf) of d is given by pd(d) = 2d/R2 for 0 ≤d ≤R [49]. On the other hand, the delay spread,
which constitutes the principal phenomenon that disturbs the TOA measurements, is given by [49]
as σ = T1 dϵ y where T1 is the mean value of σ at d = 1 km, ϵ is an exponent between 0.5 and 1.0,
and y is a log-normal random variable generated by y = 10Y/10, where Y is Gaussian with standard
deviation σY in the interval between 2 and 6 dB. The performance results shown hereafter assume
that the TOA covariance matrix R is diagonal, i.e. R = diag
#
σ 2
1 , σ 2
2 , . . . , σ 2
N
$ 
with σn samples of
the random variable σ for the nth beacon. In all the simulations presented here, T1, ϵ, and σY have

REFERENCES
671
been chosen for the suburban environment following [49]. That is, T1 = 0.4 µ, ϵ = 0.5, and σY = 4
dB. The results are shown in Figures 13.8 and 13.9.
REFERENCES
1. Revision of the commissions rules to ensure compatibility with enhanced 911 emergency calling
systems RM-8143, CC Docket 94–102, FCC, Washington, DC, July 26, 1996. FCC.
2. Woerner, D., Rappaport, T. S., Reed, J. H. and Krizman, K. J. (1998) An overview of the challenges
and progress in meeting the E-911 requirement for location system, IEEE Communications
Magazine, 36, 30–37.
3. Koolen, L. and Rantalainen, T. (1999) Mobile standardization and regulatory issues–A European
perspective, presented at the IBC Conference on Mobile Location Services, London, Nov. 1999.
4. Collier, W. and Weiland, R. (1994) Smart cars, smart highways, IEEE Spectrum, 31, 27–33.
5. Jurgen, R. (1991) Smart cars and highways go global, IEEE Spectrum, 28, 26–36.
6. Ott, G. D. (1977) Vehicle location in cellular mobile radio system, IEEE Transactions on Vehicular
Technology, 26, 43–46.
7. Rappaport, T. S., Reed, J. H. and Woerner, D. (1996) Position location using wireless communi-
cations on highways of the future, IEEE Communications Magazine, 34, 33–41.
8. Turin, G. L., Jewell, W. S. and Johnston, T. L. (1972) Simulation of urban vehicle-monitoring
systems, IEEE Transactions on Vehicular Technology, 21, 9–16.
9. Staras, H. and Honickman, S. N. (1972) The accuracy of vehicle location by trilateration in a
dense urban environment, IEEE Transactions on Vehicular Technology, 21, 38–43.
10. Hata, M. and Nagatsu, T. (1980) Mobile location using signal strength measurements in a cellular
system, IEEE Transactions on Vehicular Technology, 29, 245–252.
11. Song, H. L. (1994) Automatic vehicle location incellular communications systems, IEEE Trans-
actions on Vehicular Technology, 43, 902–908.
12. Kennemann, O. (1994) Continuous location of moving GSM mobile stations by pattern recog-
nition techniques, in Proceedings 5th IEEE International Symposium on Personal, Indoor and
Mobile Radio Communications (PIMRC’94) and ICCC Regional Meeting on Wireless Computer
Networks (WCN), 2, 630–634.
13. Hellembrandt, M., Mathar, R. and Scheibenbogen, M. (1997) Estimating position and velocity
of mobiles in a cellular radio network, IEEE Transactions on Vehicular Technology, 46, 65–71.
14. Hellembrandt, M. and Mathar, R. (1999) Location tracking of mobiles in cellular radio networks,
IEEE Transactions on Vehicular Technology, 48, 1558–1562.
15. Caffery Jr., J. and St¨uber, G. L. (1998) Subscriber location in CDMA cellular networks, IEEE
Transactions on Vehicular Technology, 47, 406–416.
16. Cesbron, F. and Arnott, R. (1998) Locating GSM mobiles using antenna arrays, Electronics
Letters, 34, 1539–1540.
17. Pent, M., Spirito, M. A. and Turco, E. (1997) Method for positioning GSM mobile stations using
absolute time delay measurements, Electronics Letters, 33, 2019–2020.
18. Spirito, M. A. and Mattioli, A. G. (1998) On the hyperbolic positioning of GSM mobile stations, in
Proceedings 1998 URSI International Symposium Signals, Systems, and Electronics (ISSSE’98),
Pisa, Italy, 1998, pp. 173–177.

672
POSITIONING IN WIRELESS NETWORKS
19. Spirito, M. A. (1999) Further results on GSM mobile station location, Electronics Letters, 35,
867–869.
20. Spirito, M. A. and Guidarelli Mattioli, A. (1999) Preliminary experimental results of a GSM
mobile phones positioning system based on timing advance, in Proceedings 1999 IEEE Vehicu-
lar Technology Conference (VTC’99—Fall), Amsterdam, the Netherlands, September 1999, pp.
2072–2076.
21. Ruutu, V., Alanen, M., Gunnarsson, G., Rantalainen, T. and Teit-tinen, V.-M. (1998) Mobile
phone location in dedicated and idle modes, in Proceedings 9th IEEE International Symposium
on Personal, Indoor and Mobile Radio Communications (PIMRC’98), 1, 1998, pp. 456–460.
22. Spirito, M. A. and Wylie-Green, M. P. (1999) Time of arrival (TOA) estimation in the GSM
and EDGE mobile communication systems, in Proceedings 1999 Finnish Signal Processing
Symposium (FINSIG’99), Oulu, Finland, May 1999, pp. 64–68.
23. Spirito, M. A. and Wylie-Green, M. P., (1999) Mobile stations location in future TDMA mobile
communication systems, in Proceedings 1999 IEEE Vehicular Technology Conference (VTC’99—
Fall), Amsterdam, the Netherlands, September 1999, pp. 790–794.
24. Report of Location Services, Nokia Telecommunications, Doc. TDoc SMG1 418/95. ETSI STC-
SMG1.
25. Service requirements for a mobile location service, Doc. SMG1 Tdoc.158/97, Mar. 1997. ETSI-
SMG1.
26. All T1P1.5 standardization documents can be found in the T1P1.5 documents—PCS directory
[Online]. Available: http://www.t1.org
27. Evaluation Worksheet for Assisted GPS, Doc. T1P1.5/98–132r3, June 1998. T1P1.
28. Evaluation Sheet for the Time Advance Positioning Method, Doc. T1P1.5/98–033, Jan. 1998.
T1P1.
29. Evaluation Sheet for the Enhanced Observed Time Difference (E-OTD) Method, Doc. T1P1.5/98–
021r7, June 1998. T1P1.
30. Evaluation Sheet for the Uplink TOA Positioning Method, Doc. T1P1.5/98–034r6, Aug. 1998.
T1P1.
31. Functional Stage 2 Speciﬁcation of Location Services in UTRAN, Doc. 3G TR 25.305. 3GPP.
32. Friedlander, B. (1987) A passive localization algorithm and its accuracy analysis, IEEE Journal
of Oceanic Engineering, 12, 234–244.
33. Fenwick, A. J. (1999) Algorithms for position ﬁxing using pulse arrival times, in Proceedings of
Institute of Electrical Engineers Radar, Sonar and Navigation, 146, 208–212.
34. Foy, W. (1976) Position-location solutions by Taylor-series estimation, IEEE Transactions on
Aerospace Electronics Systems, 12, 187–193.
35. Torrieri, D. (1984) Statistical theory of passive location systems, IEEE Transactions on Aerospace
Electronics Systems, 20, 183–197.
36. Massatt, P. and Rudnick, K. (1991) Geometric formulas for dilution of precision calculations,
Journal of the Institute of Navigation, 37, 379–391.
37. Lee, H. (1975) A novel procedure for assessing the accuracy of hyperbolic multilateration systems,
IEEE Transactions on Aerospace Electronics Systems, 11, 2–15.
38. European Digital Telecommunications System (Phase 2); Mobile Radio Interface Layer 3 Spec-
iﬁcation (GSM 04.08), Aug. 1997. ETSI TC-SMG.

REFERENCES
673
39. European Digital Telecommunications System (Phase 2); Radio Subsystem Synchronization
(GSM 05.10), May 1996. ETSI TC-SMG.
40. Collins, J., Hoffmann-Wellenhof, B. and Lichtenegger, H. (1992) Global Positioning System–
Theory and Practice. Springer Verlag, New York.
41. Scharf, L. L. (1990) Statistical Signal Processing–Detection, Estimation, and Time Series Anal-
ysis. Wiley, New York.
42. Steele, R. (1992) Mobile Radio Communications, Pentech, London.
43. Spirito, M. A. (2001) On the accuracy of cellular mobile station location estimation. IEEE
Transactions on Vehicular Technology, 50, 674–685.
44. Patwari, N., Hero, A. O., Perkins, M., Correal, N. S. and O’Deam, R. J. (2003) Relative location
estimation in wireless sensor networks, IEEE Transactions on Signal Processing, 51, 2137–2148.
45. Glisic, S. (2004) Advanced Wireless Communications. Wiley, Chichester.
46. Horn, R. A. and Johnson, C. R. (1990) Matrix Analysis. Cambridge University Press, New York.
47. Urruela, A., Sala, J. and Riba, J. (2006) Average performance analysis of circular and hyperbolic
geolocation, IEEE Transactions on Vehicular Technology, 55, 52–65.
48. Scharf, L. L. (1991) Statistical Signal Processing, Detection, Estimation, and Time Series Anal-
ysis. Addison-Wesley, Reading, MA, Chapter 9.
49. Greenstein, L. J., Erceg, V., Yeh, Y. S. and Clark, M. V. (1997) A new path-gain/delay-spread
propagation model for digital cellular channels, IEEE Transactions on Vehicular Technology, 46,
477–485.


14
Channel Modeling and
Measurements for 4G
14.1
MACROCELLULAR ENVIRONMENTS (1.8 GHZ)
In this section we present analysis of the joint statistical properties of azimuth spread, delay spread
and shadowing fading in macrocellular environments. The analysis is based on data reported from a
measurement campaign in typical urban (TU), bad urban (BU), and suburban (SU) [1] areas. In the
experiment, a BS equipped with an eight-element uniform linear antenna array and an MS with an
omnidirectional dipole antenna are used. The MS is equipped with a differential global positioning
system (GPS) and an accurate position encoder so its location is accurately known by combining the
information from these two devices. MS displacements of less than one centimeter can, therefore,
be detected. The system is designed for transmission from the MS to the BS. Simultaneous channel
sounding is performed on all eight branches, which makes it possible to estimate the azimuth of the
impinging waves at the BS. The sounding signal is a maximum length linear shift register sequence
of length 127 chips, clocked at a chip rate of 4.096 Mbps. This chip rate has been initially used in
WCDMA proposals in Europe. The testbed operates at a carrier frequency of 1.8 GHz. Additional
information regarding the stand-alone testbed can be found in [1, 2 and 5]. A summary of macrocellular
measurement environments is given in Table 14.1.
The channel’s azimuth delay spread function at the BS is modeled as
h(φ, τ) =
L

l=1
αlδ(φ −φl, τ −τl)
(14.1)
where the parameters αl, τl, and φl are the complex amplitude, delay, and incidence azimuth of the
lth impinging wave at the BS. In general, h(φ, τ) is considered to be a time-variant function, since
the constellation of the impinging waves is likely to change as the MS moves along a certain route.
The local average power azimuth delay spectrum is given as
P(φ, τ) = E
 L

l=1
|αl|2δ(φ −φl, τ −τl)

(14.2)
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

676
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.1
Summary of macrocellular measurement environments
BS antenna
Class
height
Description of environment
TU Typical urban
10 m and 32 m
The city of Aarhus, Denmark. Uniform density of
buildings ranging from 4–6 ﬂoors. Irregular
street layout. Measurements carried out along six
different routes with an average length of 2 km.
No line-of-sight between MS and BS. MS–BS
distance varies from 0.2 km to 1.1 km.
TU Typical urban
21 m
Stockholm city, Sweden (Area #1). Heavily
built-up area with a uniform density of buildings,
ranging from 4–6 ﬂoors. Ground is slightly
rolling. No line-of-sight between MS and BS.
MS–BS distance varies from 0.2 km to 1.1 km.
BU Bad urban
21 m
Stockholm city, Sweden (Area #2). Mixture of
open ﬂat areas (river) and densely built-up zones.
Ground is slightly rolling. No line-of-sight
between MS and BS. MS–BS distance varies
from 0.9 km to 1.6 km.
SU Suburban
12 m
The city of Gistrup, Denmark. Medium-sized
village with family houses of one–two ﬂoors and
small gardens with trees and bushes. Typical
Danish residential area. The terrain around the
village is rolling with some minor hills. No
line-of-sight between MS and BS. MS–BS
distance varies from 0.3 km to 2.0 km.
From Equation (14.2), the local power azimuth spectrum (PAS) and the local power delay spectrum
(PDS) are given as
PA(φ) =

P(φ, τ) dτ
(14.3)
PD(τ) =

P(φ, τ) dφ
(14.4)
The radio channel’s local azimuth spread (AS) σA and the local delay spread (DS) σD are deﬁned
as the root second central moments of the corresponding variables. The values of the local AS and
DS are likely to vary as the MS moves within a certain environment. Hence, we can characterize σA
and σD as being random variables, with the joint pdf f (σA, σD). Their individual pdfs are
fA(σA) =

f (σA, σD) dσD
(14.5)
fD(σD) =

f (σA, σD) dσA
(14.6)
The function f (σA, σD) can be interpreted as the global joint pdf of the local AS and DS. If the
expectation in Equation (14.2) is computed over the radio channel’s fast fading component, we can,
furthermore, apply the approximation
 
P(φ, τ) dφ dτ = hchannel ∼= hloss(d)hs
(14.7)

MACROCELLULAR ENVIRONMENTS (1.8 GHZ)
677
Azimuth spread (degrees)
0
5
10
15
20
25
30
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
Cumulative distribution
PDF of the AS
0.2
0.5
0.8
Empirical results TU-32
Empirical results BM
Log-normal distribution
0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
Log-normal distribution
Figure 14.1 Examples of the empirical cumulative distribution function (cdf) of AS ob-
tained in different environments. The cdf of a log-normal distribution is ﬁtted
to the empirical results for comparison [1] c⃝2002, IEEE.
where hchannel is the radio channel’s integral path loss, hloss(d) is the deterministic long-term distance-
dependent path loss, while hs is the channel’s shadow fading component, which is typically modeled
with a log-normal distributed random variable [4, 5]. The global pdf of hs is denoted fs(hs). The
global degree of shadow fading is described by the root second central moment of the random shadow
fading component expressed in decibels, i.e.
σs = Std {10 log10(hs)}
(14.8)
where Std{ } denotes standard deviation. Empirical results for cumulative distribution functions (cdfs)
for σA and σD are given in Figure 14.1 and Figure 14.2 respectively. The log-normal ﬁt for σA results
is given as
σA = 10εA X+µA
(14.9)
where X is a zero mean Gaussian distributed random variable with unit variance, µA = E{log10(σA)}
is the global logarithmic mean of the local AS, and εA = Std {log10(σA)} is the logarithmic standard
deviation of the AS.
Similarly,
σD = 10εDY+µD
(14.10)
where Y is a zero mean Gaussian distributed random variable with unit variance, µD = E{log10(σD)}
is the global logarithmic mean of the local DS, and εD = Std{log10(σD)} is the logarithmic standard
deviation of the DS. A summary of the results for these parameters is given in Table 14.2.
14.1.1
PDF of shadow fading
The shadow fading component is extracted from the measurement data under the assumption that the
deterministic distance path loss can be expressed in decibels as
10 log10(hloss(d)) = A + B log10(d)
(14.11)

678
CHANNEL MODELING AND MEASUREMENTS FOR 4G
0
0.5
1.0
2.0
2.5
3.0
4.0
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
Cumulative distribution
PDF of the DS
0.2
0.5
0.8
Empirical results TU-32
Log-normal distribution
Empirical results BM
Log-normal distribution
1.5
3.5
Delay spread (µs)
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
Figure 14.2 Examples of empirical cdfs of the DS obtained in different environments. The
cdf of a log-normal distribution is ﬁtted to the empirical results for comparison
[1] c⃝2002, IEEE.
Table 14.2
Summary of the ﬁrst and second central moments of the AS, DS and shadow
fading in the different environments [1] c⃝2002, IEEE
Class
σs
E {σA}
µA
εA
E {σD}
µD
εD
TU-32
7.3 dB
80
0.74
0.47
0.8 µs
−6.20
0.31
TU-21
8.5 dB
80
0.77
0.37
0.9 µs
−6.13
0.28
TU-20
7.9 dB
130
0.95
0.44
1.2 µs
−6.08
0.35
BU
10.0 dB
70
0.54
0.60
l.7 µs
−5.99
0.46
SU
6.1 dB
80
0.84
0.31
0.5 µs
−6.40
0.22
where d is the distance between the BS and MS expressed in kilometers. As an example, the
Okumura–Hata model [6] is based on a similar structure. From Equations (14.11) and (14.7) we have
10 log10 (hchannel (d)) = A + B log10 (d) + 10 log10 (hs)
(14.12)
Assuming that E{10 log10(hs)} = 0.0 dB, the parameters A and B can be obtained as the least squares
estimates from a large number of measurements. Subsequently, the shadow fading component can be
isolated from each measurement segment by rearranging Equation (14.12).
From the measurements it is found that a log-normal distribution function provides a good match
to the empirical pdf of the shadow fading component. This observation is in coherence with numerous
other studies, see [4, 7 and 8] among others. The shadow fading standard deviation is found to be
in the range σs = [6–10] dB depending on the environment class, with the largest standard deviation
observed in the BU, and the smallest in SU environments. These ﬁndings are in accordance with
previous ﬁndings in the open literature as well. Hence, the random variable describing the shadow

MACROCELLULAR ENVIRONMENTS (1.8 GHZ)
679
Distance (m)
0
25
50
75
100
125
150
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
Autocorrelation of AS
0.2
0.5
0.8
Empirical results TU-32
Exponential decay
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
Figure 14.3 Empirical spatial autocorrelation function of AS in TU-32. An exponential
decaying function is matched to the empirical results with dA = 70 m.
Distance (m)
0
25
40
60
80
100
120
140
160
180
200
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
Autocorrelation of AS
0.2
0.5
0.8
Empirical results SU
dA, 1= 25 m
dA, 2= 200 m
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
Figure 14.4 Empirical spatial autocorrelation function of AS in SU.
fading component can be expressed as
hs = 10σs Z/10
(14.13)
where Z is a zero mean Gaussian random variable with unit variance. The experimental results and
analytical approximation for the spatial autocorrelation function are given in Figures 14.3 and 14.4.
Now,
ρA(d) = exp(−d/dA)
(14.14)
A double exponential decaying function is matched to the empirical results
ρA(d) = k exp

−d
dA,1

+ (1 −k) exp

−d
dA,2

;
k ∈[0, 1]
(14.15)

680
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Distance (m)
0
25
50
75
100
125
150
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
Autocorrelation of DS 
0.2
0.5
0.8
Empirical results BU
Exponential decay
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
Figure 14.5 Empirical spatial autocorrelation function of DS in the BU environment. An
exponential decaying function is matched to the empirical results.
Table 14.3
Spatial decorrelation distance for AS, DS and shadow fading in
different environments expressed in meters. The two numbers
presented for SU, correspond to the short and long decorrelation
coefﬁcients [1]
Class
dA
dD
ds
TU-32
50
40
45
TU-21
50
50
25
TU-20
75
50
55
BU
65
95
120
SU
25/200 (k = 0.2)
15/150 (k = 0.3)
30/200 (k = 0.4)
The same results for DS are given in Figure 14.5 and Equations (14.16) and (14.17)
BU environment: ρD(d) = exp(−d/dD)
(14.16)
SU environment: ρD(d) = k exp(−d/dD,1) + (1 −k) exp(−d/dD,2)
(14.17)
Finally, the results for the decorrelation distance are summarized in Table 14.3.
The mutual interdependence between the different components of the fading is characterized
by their crosscorrelation functions. In general, the crosscorrelation coefﬁcient between a and b is
computed according to
ρ⟨a, b⟩=
N

i=1
(a(i) −¯a)(b(i) −¯b)



	
N

i=1
(a(i) −¯a)2
N

i′=1
(b(i
′) −¯b)2
(14.18)
where ¯a and ¯b are the sample means of the sets {a(i)} and {b(i)} with set size N. The results for AS,
DS and shadow fading, based on measurements, are summarized in Table 14.4.
Additional details on the topic can be found in [1–29].

URBAN SPATIAL RADIO CHANNELS IN MACRO/MICROCELL (2.154 GHZ)
681
Table 14.4
Empirical crosscorrelation coefﬁcients for the different environment classes
for the AS, DS and shadow fading, expressed in both linear and logarithmic
forms [1] c⃝2002, IEEE
Class
ρ ⟨σA, σD⟩ρ ⟨σA, σD⟩log ρ ⟨σA, hs⟩ρ ⟨σA, hs⟩log ρ ⟨σD, hs⟩ρ ⟨σD, hs⟩log
TU-32
0.39
0.44
−0.51
−0.7
−0.38
−0.4
TU-21
0.34
0.36
−0.47
−0.54
−0.34
−0.5
TU-20
0.6
0.6
−0.65
−0.72
−0.44
−0.48
BU
0.69
0.67
−0.44
−0.53
−0.55
−0.69
SU
0.46
0.46
−0.47
−0.5
−0.38
−0.46
 
Figure 14.6 The measurement area with all three RX sites; TX positions of the sample
plots are marked [30] c⃝2002, IEEE.
14.2
URBAN SPATIAL RADIO CHANNELS IN MACRO/MICROCELL
(2.154 GHZ)
The discussion in this section is based on experimental results collected with a wideband channel
sounder using a planar antenna array [30]. The signal center frequency was 2154 MHz and the mea-
surement bandwidth 100 MHz. A periodic PN sequence, 255 chips long, was used. The chip rate was
30 MHz and the sampling rate 120 MHz, giving an oversampling factor 4. The correlation technique is
used for the determination of the impulse response. Hence, the delay range is 255/30 MHz = 8.5 µs,
with a resolution of 1/30 MHz = 33 ns. The transmit antenna at the MS was a vertically polarized
omnidirectional disconne antenna. The vertical 3 dB beamwidth was 87◦and the transmit power
40 dBm. Approximately 80 different transmitter positions were investigated.
The receiving BS was located at one of three different sites: below, at, and above the rooftop level
(RX 1–RX 3, see, Figure 14.6). A 16-element physical array with dual polarized λ/2-spaced patch
antennas was combined with a synthetic aperture technique to build a virtual two-dimensional (2D)

682
CHANNEL MODELING AND MEASUREMENTS FOR 4G
antenna structure. The patches were linearly polarized at 0◦(horizontal direction) and 90◦(vertical
direction). With these 16 × 62 elements, the direction of arrival (DOA) of incoming waves, both
in azimuth (horizontal angle), and elevation (vertical angle), could be resolved by using the super-
resolution Unitary ESPRIT algorithm [31–33]. Note that the number of antenna elements limits the
number of identiﬁable waves, but not the angular resolution of the method. Together with a delay
resolution of 33 ns, the radio channel can be characterized in all three dimensions separately for the
two polarizations. Array signal processing – including estimation of the DOAs and a comparison of
ESPRIT with other algorithms–was discussed in Chapter 13.
One prerequisite for the applicability of the synthetic aperture technique is that the radio channel
is static during the whole data collection period. To avoid problems, the whole procedure was done
at night with minimum trafﬁc conditions.
14.2.1
Description of environment
A typical urban environment is shown in Figure 14.6 [30] with three receiver locations (RX 1–
3) marked by triangles pointing broadside in the direction of the array. Figure 14.6 also provides
information about all the corresponding TX positions. The location RX 1 (height hRX = 10 m) is a
typical microcell site below the rooftop height of the surrounding buildings, and measurements are
performed with 20 different TX positions. RX 2 (height hRX = 27 m) is at the rooftop level, and 32
TX positions are investigated. RX 3 (height hRX = 21 m) is a typical macrocell BS position above
rooftop height, and 27 TX positions are measured.
14.2.2
Results
The measurement results show that it is possible to identify many single (particular, different) multi-
path components, impinging at the receiver from different directions. But these components are not
randomly distributed in the spatial and temporal domain, they naturally group into clusters. These
clusters can be associated with objects in the environment due to the high angular and temporal resolu-
tion of evaluation. Sometimes even individual waves within a cluster can be associated with scattering
objects. The identiﬁcation of such clusters is facilitated by inspection of the maps of the environment.
A cluster is deﬁned as a group of waves whose delay, azimuth and elevation at the receiver are
very similar, while being notably different from other waves in at least one dimension. Additionally,
all waves inside a cluster must stem from the same propagation mechanism. The deﬁnition of
clusters always involves a certain amount of arbitrariness. Even for mathematically ‘exact’ deﬁnitions,
arbitrary parameters (e.g. thresholds or numbers of components) must be deﬁned. Clustering by human
inspection, supported by maps of the environment, seems to give the best results.
The received power is calculated within each cluster (cluster power) by means of Unitary ESPRIT
and a following beamforming algorithm. The results are plotted in the azimuth–elevation, azimuth–
delay, and elevation–delay planes
According to the obvious propagation mechanism, each cluster is assigned to one of three different
classes.
Class 1. Street-guided propagation: Waves arrive at the receiver from the street level after traveling
through street canyons.
Class 2. Direct propagation–over the rooftop: The waves arrive at the BS from the rooftop level by
diffraction at the edges of roofs, either directly or after reﬂection from buildings surrounding
the MS. The azimuth mostly points to the direction of the transmitter, with some spread in
azimuth and delay.
Class 3. Reﬂection from high-rise objects–over the rooftop: The elevation angles are near the
horizon, pointing at or above the rooftop. The waves undergo a reﬂection at an object rising
above the average building height before reaching the BS. The azimuth shows the direction of
the reﬂecting building, the delay is typically larger than for Class 1 or Class 2.

URBAN SPATIAL RADIO CHANNELS IN MACRO/MICROCELL (2.154 GHZ)
683
Relative power in %
0
20
40
60
80
100
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
CDF of relative power
0.2
0.5
0.8
No. of clusters to get x% of total power VP-VP
1 culster, N = 71
2 culster, N = 71
3 culster, N = 56
4 culster, N = 30
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
Figure 14.7 CDF of the relative power for one to four clusters, all TX positions, transmitter
and receiver vertically polarized (VP-VP), N is the number of samples [30]
c⃝2002, IEEE.
The sum of the powers of all clusters belonging to the same class is called class power. In some
cases, the propagation history is a mixture of different classes, e.g. street guidance followed by
diffraction at rooftops. Such clusters are allocated to the class of the ﬁnal path to the BS.
Some statistical evaluations are now presented to illustrate and quantify the clusterization. First
we look at the number of clusters that is required to get a speciﬁc percentage of the total power;
secondly, the powers of the clusters versus the delay; thirdly, the crosspolarization discrimination
(XPD) versus the delay; fourthly, the relative class powers; and ﬁnally, the distribution of the number
of clusters. Such questions are important for designing algorithms for adaptive antennas, e.g. should
one capture, in uplink, the power of one or more clusters; or, in downlink, how does one distribute
the available transmit power, and to which directions?
The ﬁrst example illustrates the percentage contribution to the total power of the strongest cluster.
If we refer to the 10 % level in Figures 14.7–14.8, we can see that in 90 % of all cases, the power in
(in Figure 14.7) and 40 % (in Figure 14.8) the strongest cluster is at least 55 % of the total power. The
same results for clusters separated by class are given in Figures 14.9 and 14.10.
These results are summarized in Table 14.5.
For the evaluation of delays we deﬁne the vector P containing the powers of the clusters and vector
τ of corresponding mean delays. A particular cluster i has mean delay τi, and power Pi. The relation
between the delays τ and the powers P is modeled as exponential
Pn ∝P(τn) = ae−τn/b
(14.19)
Experimental data are ﬁt into the model in Equation (14.19) by using the least squares (LS) estimation.
The logarithmic estimation error v is deﬁned as
v = 10 log P −10 log s(θ)
(14.20)
and its standard deviation σv as
σv =

var {v}
(14.21)
Some results are shown in Figures 14.11 and 14.12. The summary of the results for parameters a and
b is shown in Tables 14.6 and 14.7.

684
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Relative power in %
0
20
40
60
80
100
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
CDF of relative power
0.2
0.5
0.8
No.of clusters to get x% of total power VP-HP
1 cluster, N = 71
2 clusters, N = 71
3 clusters, N = 56
4 clusters, N = 30
0
2
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
= 71
71
56
30
Figure 14.8 CDF of the relative power for one to four clusters, all TX positions, transmitter
vertically and receiver horizontally polarized (VP-HP). N is the number of
samples.
Relative power in %
0
20
40
60
80
100
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
CDF of relative power
0.2
0.5
0.8
CDF of relative cluster power, strongest 1 cluster(s) VP-VP
Class 1, N = 62
Class 2, N = 39
Class 3, N = 61
Class 1
2
3
0
20
40
60
80
100
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
Class 1
2
3
Figure 14.9 CDF of the relative power for the strongest cluster separated by class, for all
TX positions. N is the number of samples.
In Equation (14.21) σv was deﬁned as the standard deviation of the logarithmic estimation error
in dB. This estimation error was found to be log-normally distributed and up to a delay of about 1 µs,
σv is independent of the delay τ. The value of σv is 9.0 dB and 10.0 dB (co- and crosspolarization),
respectively, averaged over the ﬁrst microsecond.
The XPD is deﬁned as the ratio of the received power of the copolarized component to the power
of the crosspolarized component, evaluated for each cluster. Some results are shown in Figure 14.13.

Relative power in %
0
20
40
60
80
100
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
CDF of relative power
0.2
0.5
0.8
CDF of relative cluster power, strongest 2 cluster(s)  VP-VP
Class 1, 
2,
 = 7
Class 3, N = 28
Class 
1
2
3
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
 N = 30
Class 2, N
3,
 = =
Class 
1
2
3
Figure 14.10 CDF of the relative power for the two strongest clusters separated by class,
all TX positions. N is the number of samples.
Table 14.5
Average relative power in dB (relation of cluster power
to total received power Ptot) of the strongest cluster
of RX 1, RX 2, and RX 3, and the ratio in %
VP-VP
VP-HP
RX
dB (% of Ptot)
dB (% of Ptot)
1
−0.9 (81%)
−1.2 (76%)
2
−0.4 (91%)
−0.6 (87%)
3
−1.3 (74%)
−1.8 (66%)
Figure 14.11 Relation of the cluster power to the total power versus delay, all TX positions
and copolarization. N is the number of clusters [30] c⃝2002, IEEE.

686
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Figure 14.12 Relation of the cluster power to the total power versus delay, all TX positions
and cross polarization. N is the number of clusters [30] c⃝2002, IEEE.
Table 14.6
The model parameters a and b for both
received polarizations (VP and HP)
averaged over all available clusters.
The transmitter was VP
VP-VP
VP-HP
a
−3.9 dB
−3.6 dB
b
8.9 dB/µs
11.8 dB/µs
Pi = ae−τi/b
Table 14.7
Average delay of the strongest cluster of
RX 1, RX 2 and RX 3
Average delay VP-VP
Average delay VP-HP
RX
µs
µs
1
0.068
0.071
2
0.38
0.28
3
0.11
0.048

URBAN SPATIAL RADIO CHANNELS IN MACRO/MICROCELL (2.154 GHZ)
687
XPD in dB
0
−20
−10
0
10
20
30
40
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
CDF of XPD
0.2
0.5
0.8
CDF of XPD separately for the 3 classes
Class 1, N = 99
Class 2, N = 37
Class 3, N = 79
Class 1 
Class 2 
Class 3 
0.0
0.1
0.3
0.4
0.6
0.7
0.9
1.0
0.2
0.5
0.8
(b)
Figure 14.13 (a) XPD versus delay, all TX positions; (b) CDF of the XPD separately for
the three classes. N is the number of clusters [30] c⃝2002, IEEE.

688
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.8
Averaged class powers of RX 1, RX 2 and RX 3
Horizontal power as
Vertical power as
RX
Class
% of total power
% of total power
1
96.5
95.7
1
2
2.4
3.8
3
1.1
0.4
1
93.5
97.2
2
2
4.0
2.7
3
2.5
0.1
1
46.7
78.0
3
2
37.2
12.8
3
16.0
9.2
The average powers for different classes of cluster are shown in Table 14.8.
Additional data on the topic can be found in [30–41].
14.3
MIMO CHANNELS IN MICROCELL AND PICOCELL ENVIRONMENTS
(1.71/2.05 GHZ)
The model presented in this section is based upon data collected in both picocell and microcell
environments [42]. The stochastic model has also been used to investigate the capacity of MIMO
radio channels, considering two different power allocation strategies, water ﬁlling and uniform, and
two different antenna topologies, 4 × 4 and 2 × 4. It will be demonstrated that the space diversity used
at both ends of the MIMO radio link is an efﬁcient technique in picocell environments, achieving
capacities within 14 b/s/Hz and 16 b/s/Hz in 80 % of the cases for a 4 × 4 antenna conﬁguration
implementing water ﬁlling at an SNR of 20 dB.
The basic parameters of the measurements setup are shown in Figure 14.14. The following notation
is used subsequently: dMS–BS stands for distance between MS and BS, hBS for the height of BS above
the ground ﬂoor, and AS for azimuth spread [42].
The vector of received signals at BS can be represented as y(t) = [y1(t), y2(t), . . . yM(t)]T, where
ym(t) is the signal at the mth antenna port and [·]T denotes transposition. Similarly, the signals at the
MS are s(t) = [s1(t), s2(t), . . . sN(t)]T. The NB MIMO radio channel H ∈XM×N which describes the
connection between the MS and the BS can be expressed as
H =


α11
α12
· · ·
α1N
α21
α22
· · ·
α2N
...
...
...
...
αM1
αM2
· · ·
αM N


(14.22)
where αmn is the complex transmission coefﬁcient from the antenna at the MS to the antenna at the
BS. For simplicity, it is assumed that αmn is complex Gaussian distributed with identical average
power. However, this latest assumption can be easily relaxed. Thus, the relation between the vectors
y(t) and s(t) can be expressed as
y(t) = H(t) s(t)
(14.23)

MIMO CHANNELS IN MICROCELL AND PICOCELL ENVIRONMENTS
689
MIMO measurements
1st measurement set-up
2nd measurement set-up
Rotative Motion
Linear Motion
Tx
(MS)
Tx
(MS)
Fc=1.71 GHz
Fc=2.05 GHz
0.5
0.5
11.8
20
Rx
(BS)
Rx
(BS)
0.5
Synthesized
approach
Switch
approach
1.5
15 positions
(microcell)
93 positions
(microcell and picocell)
MIMO measurements
1st measurement setup
2nd measurement setup
Rotative motion
Linear motion
Tx
(MS)
Tx
(MS)
Fc=1.71 GHz
Fc=2.05 GHz
0.5
0.5
11.8
20
Rx
(BS)
Rx
(BS)
0.5
Synthesized
approach
Switch
approach
1.5
15 positions
(microcell)
93 positions
(microcell and picocell)
l
l
l
l
l
l
Figure 14.14 Functional sketch of the MIMO model [42] c⃝2002, IEEE.
Subsequently, we will use the following correlations:
ρBS
m1m2 =

αm1n, αm2n

(14.24a)
ρMS
n1n2 =

αmn1, αmn2

(14.24b)
RBS =


ρBS
11
ρBS
12
· · ·
ρBS
1M
ρBS
21
ρBS
22
· · ·
ρBS
2M
...
...
...
...
ρBS
M1
ρBS
M2
· · ·
ρBS
M M


M×M
(14.24c)
RMS =


ρMS
11
ρMS
12
· · ·
ρMS
1N
ρMS
21
ρMS
22
· · ·
ρMS
2N
...
...
...
...
ρMS
N1
ρMS
N2
· · ·
ρMS
N N


N×N
(14.24d)
The correlation coefﬁcient between two arbitrary transmission coefﬁcients connecting two different
sets of antennas is expressed as
ρn1m1
n2m2 =

αm1n1, αm2n2

(14.25)

690
CHANNEL MODELING AND MEASUREMENTS FOR 4G
which is equivalent to
ρn1m1
n2m2 = ρMS
n1n2ρBS
m1m2
(14.26)
provided that Equations (14.24a) and (14.24b) are independent of n and m, respectively. In other
words, this means that the spatial correlation matrix of the MIMO radio channel is the Kronecker
product of the spatial correlation matrix at the MS and the BS and is given by
RMIMO = RMS ⊗RBS
(14.27)
where ⊗represents the Kronecker product. This has also been conﬁrmed in [43].
14.3.1
Simulation of channel coefﬁcients
Correlated channel coefﬁcients, αmn, are generated from zero mean complex independent identically
distributed (i.i.d.) random variables amn shaped by the desired Doppler spectrum such that
A = Ca
(14.28)
where AMN×1 = [α11, α21, . . . , αM1, α12, . . . , αMN]T and aMN×1 = [a1, a2, . . . , aMN]T. The symmet-
rical mapping matrix C results from the standard Cholesky factorization of the matrix RMIMO = CCT,
provided that RMIMO is non-singular [44].
Subsequently, the generation of the simulated MIMO channel matrix ˜H can be deduced from the
vector A. Note that the correlation matrices and the Doppler spectrum cannot be chosen independently,
as they are connected through the PAS at the MS [45].
14.3.2
Measurement setups
The Tx is at the MS and the stationary Rx is located at the BS. The two setups from Figure 14.14
provide measurement results with different correlation properties of the MIMO channel for small
antenna spacings of the order of 0.5λ or 1.5λ . The BS consists of four parallel Rx channels. The
sounding signal is an MSK-modulated linear shift register sequence of length 127 chips, clocked at a
chip rate of 4.096 Mcps. At the Rx, the channel sounding is performed within a window of 14.6 µs,
with a sampling resolution of 122 ns (1/2 chip period) to obtain an estimate of the complex impulse
response (IR). The NB information is subsequently extracted by averaging the complex delayed signal
components. A more thorough description of the stand-alone testbed (i.e. Rx and Tx) is documented
in [23, 46]. The description of the measurement environments is summarized in Table 14.9.
A total of 107 paths are investigated within these seven environments. The ﬁrst measurement
setup is used to investigate 15 paths in a microcell environment, i.e. environment A in Table 14.9.
The MS is positioned in different locations inside a building, while the BS is mounted on a crane and
elevated above roof top level (i.e. 9 m) to provide direct LOS to the building. The antenna is located
300 m away from the building. The second setup is used to investigate 92 paths for both microcell
and picocell environments, i.e. environments B and C to G, respectively, as shown in Table 14.9. The
distance between the BS and the MS is 31 to 36 m for microcell B, with the BS located outside.
14.3.3
Validation of the stochastic MIMO channel model assumptions
The validity of the underlying assumptions has been veriﬁed for a 4 × 4 MIMO conﬁguration.
These assumptions are that: (1) the spatial correlation at the BS, Equation (14.24a), and the MS,
Equation (14.24b), is independent of n and m, respectively; and (2) the spatial correlation matrix of
the MIMO radio channel is the Kronecker product of the spatial correlation matrices at the BS and
the MS, Equation (14.27).
To verfy assumption (1), the standard deviation (std) of each measured spatial correlation coef-
ﬁcient |ρBS
m1m2| and |ρMS
n1n2| is computed over the N and M reference antennas, respectively, for each
environment. The std at the BS is expressed as
std ρBS
m1m2 = std
ρnm1
nm2

,
∀n ∈[1 . . . 4]
(14.29)

MIMO CHANNELS IN MICROCELL AND PICOCELL ENVIRONMENTS
691
Table 14.9
Summary and description of the different environments [42] c⃝2002, IEEE
Cell
MS
Measurement
type
Environment
locations
setup
Description
Microcell
A
15
1st
The indoor environment consists
of small ofﬁces with windows
metalically shielded – 300 m
between MS and BS
Microcell
B
13
2nd
The indoor environment consists
of small ofﬁces – 31 to 36 m
between MS and BS
Picocell
C
21
2nd
The indoor environment is the
same as in A
Picocell
D
12
2nd
Reception hall – large open area
Picocell
E
18
2nd
Modern open ofﬁce with
windows metalically shielded
Picocell
F
16
2nd
The indoor environment is the
same as in B
Picocell
G
12
2nd
Airport – very large indoor open
area
0
0.1
0.2
0.3
0.4
0
0.1
0.2
0.3
0.4
Std_r MS
Std_r MS
0
10
20
30
40
50
60
70
80
90
100
0
10
20
30
40
50
60
70
80
90
100
measured
simulated
measured
simulated
% Env.where std_         < abscissa
ρ ms
n1n2
% Env. where std_ r     < abscissa
Bs
m1m2
m1m2
n1n2
Figure 14.15 Example of the cdf of (a) std ρBS
m1m2 and (b) std ρMS
n1n2. The cdf is performed
over all the measured environments and for all seven correlation coefﬁcients.
and at the MS
std ρMS
n1n2 = std
ρn2m
n1m

,
∀m ∈[1 . . . 4]
(14.30)
Figure 14.15 presents the empirical cumulative distribution function (cdf) of std ρBS
m1m2 (a) and
std ρMS
n1n2 (b) computed over the 92 paths considered with the second measurement setup for the six
different correlation coefﬁcients, i.e. the upper triangular coefﬁcient of the correlation matrix, when a

692
CHANNEL MODELING AND MEASUREMENTS FOR 4G
4 × 4 MIMO conﬁguration is used. To validate the statistical signiﬁcance of the empirical results, the
empirical cdf is compared with a cdf obtained from simulations performed under similar conditions.
The matching of the two cdfs demonstrates that assumption (1) is fulﬁlled, as explained hereafter. For
each of the 92 × 6 different measured correlation coefﬁcients, two correlated, Rayleigh-distributed
signals of length 1000λ are generated. These 1000λ-long vectors are truncated into 11.8λ-long runs
over which the correlation coefﬁcient is computed once again. Hence, a wider new set of correlation
values is collected, exhibiting a standard deviation std11.8λ . This operation is repeated 92 × 6 times.
A simulated cdf of std11.8λ is then obtained under similar conditions as for the measured cdf.
14.3.4
Input parameters to the validation of the MIMO model
The input parameters used in the validation stage are illustrated by the shaded areas of Figure 14.16.
They are the average spatial complex correlation matrices RBS and RMS, and the associated average
Doppler spectrum.
The measured spatial complex correlation matrices are the results of an average over the reference
antennas n and m with respect to which the matrices are computed.
The averaged measured Doppler spectrum is obtained by averaging over all the MN channel
coefﬁcients. It is deﬁned at the MS, since the BS is ﬁxed. This limitation is due to the measurement
setup implementation, but is not inherent to the model. If both MS and BS were moving, the Doppler
spectrum of the channels would have been deﬁned as the convolution of separate Doppler spectra,
deﬁned either at the MS or at the BS, considering, respectively, the BS or the MS as ﬁxed. The
corresponding complex coefﬁcients of the vector a in Equation (14.28) have their amplitudes shaped
by the average measured Doppler spectrum and assigned a random phase uniformly distributed over
[0, 2π] such that MN independent and identically distributed variables are generated. Two examples
of typical paths are presented by Equations (14.31) and (14.32) [42] .
Input parameters to model validation 
Input parameters
Environment (urban/rural, macro/micro/picocell), d…, h…, d, l, radiation pattern, …
Power Azimuth
Spectrum (PAS)
d..-.. 
AS 
h.. 
AS 
AS
P
ℑ
AS, φ
Spatial correlation
Function
AS 
r 
r
0
d/λ
(AS, φ)
Radiation pattern 
[RMS]NxN
[RBS]MxM
Spatial complex
Correlation matrices 
Doppler spectrum 
f
P
MIMO radio channel model 
s(t)
y(t)
Input parameters to model validation 
Environment (urban/rural, macro/micro/picocell), d…, h…, d, l, radiation pattern, …
Power azimuth
spectrum (PAS)
d..-.. 
AS 
h.. 
AS 
AS
P
ℑ
AS, φ
Spatial correlation
function
AS 
r 
r
0
d/l
(AS, f)
Radiation pattern 
[RMS]NxN
[RBS]MxM
Spatial complex
correlation matrices 
Doppler spectrum 
f
P
MIMO radio channel model 
s(t)
y(t)
F
Figure 14.16 Illustration of the two measurement setups [42] c⃝2002, IEEE.

MIMO CHANNELS IN MICROCELL AND PICOCELL ENVIRONMENTS
693
Example 1: Picocell decorrelated
RBS =


1
−0.45 + 0.53i
0.37 −0.22i
0.19 + 0.21i
−0.45 −0.53i
1
−0.35 −0.02i
0.02 + 0.27i
0.37 + 0.22i
−0.35 + 0.02i
1
−0.10 + 0.54i
0.19 −0.21i
0.02 + 0.27i
−0.10 −0.54i
1


RMS =


1
−0.13 −0.62i
−0.49 + 0.23i
0.15 + 0.28i
−0.13 + 0.62i
1
−0.13 −0.52i
−0.38 + 0.12i
−0.49 −0.23i
−0.13 + 0.52i
1
0.02 −0.61i
0.15 −0.28i
−0.38 −0.12i
0.02 + 0.61i
1


(14.31)
Example 2: Microcell correlated
RBS =


1
−0.61 + 0.77i
0.14 −0.94i
0.24 + 0.89i
−0.61 −0.77i
1
−0.85 + 0.50i
0.57 −0.78i
0.14 + 0.94i
−0.85 −0.50i
1
−0.91 + 0.40i
0.24 −0.89i
0.57 + 0.78i
−0.91 −0.40i
1


RMS =


1
−0.12 −0.18i
−0.08 + 0.05i
−0.02 −0.13i
−0.12 + 0.18i
1
−0.17 −0.16i
0.11 + 0.04i
0.08 −0.05i
−0.17 + 0.16i
1
−0.17 −0.16i
−0.02 + 0.13i
0.11 −0.04i
−0.17 + 0.16i
1


(14.32)
In both Examples 1 and 2, |RMS| is decorrelated. This is expected, since the MS is surrounded
by scatterers. On the other hand, RBS presents two different behaviors. In Example 1, the spatial
correlation coefﬁcients remain low, as expected in the case of an indoor termination. On the other
hand, the spatial correlation coefﬁcients at the BS are highly correlated in Example 2, with a mean
absolute value of the coefﬁcient of 0.96. The high correlation is explained by the fact that regarding
this speciﬁc example, the BS is identiﬁed to be located above any surrounding scatterer. Therefore,
it experiences a low azimuth spread (AS), which causes its antenna array elements to be highly
correlated. An illustration of the averaged measured Doppler spectrum of Example 1 is presented
in Figure 14.17. The spectrum is normalized in frequency to its maximum Doppler shift fm and in
power to its maximum value.
14.3.5
The eigenanalysis method
The eigenvalue decomposition (EVD) of the instantaneous correlation matrix R = HHH (not to be
confused with RMIMO), where [·]H represents Hermitian transposition, can serve as a benchmark
of the validation process. The channel matrix H may offer K parallel subchannels with different
mean gains, with K = Rank(R) ≤min(M, N), where the functions Rank(·) and min(·) return the
rank of the matrix and the minimum value of the arguments, respectively, [27]. The kth eigenvalue
can be interpreted as the power gain of the kth subchannel [27]. In the following, λk represents
the eigenvalues. In order to assess the qualitative accuracy of the model, the comparison between

694
CHANNEL MODELING AND MEASUREMENTS FOR 4G
−2
−1.5
−1
−0.5
0
0.5
3
1.5
2
−20
−18
−16
−14
−12
−10
−8
−6
−4
−2
0
Normalized frequency f / fm
Doppler power spectrum (dB)
 
Figure 14.17 Averaged measured Doppler power spectrum for Example 1 (picocell decor-
related) [42] c⃝2002, IEEE.
measured and simulated eigenvalues is made for an antenna conﬁguration where the largest number
of eigenvalues is achievable within the limitation of the measurement setup antenna topology. This
is the case for a 4 × 4 scenario, since at most four eigenvalues can be expected. In the following, the
eigenvalues are normalized to the mean power of the single Tx and a single Rx channel coefﬁcient
(1/M N) M
m=1
N
n=1 |αmn|2.
14.3.5.1
Validation procedure
For each of the 107 paths, the input parameters are fed into the proposed stochastic MIMO model
and a Monte Carlo simulation consisting of 100 iterations is performed to generate the elements
of the simulated matrix ˜H. ˜H is a three-dimensional (3D) matrix (M × N × L), where L is the
number of samples equivalent to the time domain deﬁnition in Equation (14.23). For each iteration,
the seed of the random generator which deﬁnes the phase of the complex coefﬁcient of the vector a is
different.
At iteration q, ˜H4×4×L counts as many samples L as in the measured H4×4×L collected during one
antenna array run, that is to say 20λ or 11.8λ, depending on the measurement setup used. The EVD of
˜H4×4×L ˜HH
4×4×L is then performed for each sample l in order to identify the corresponding simulated
eigenvalues denoted by the vector,
λsim kq L×1 = [λsim kq 1, . . . , λsim kq l]T, k = 1, . . . , K.
From these eigenvalues, k vectors ⌊λsim k⌋1×QL containing the 100 iterations of the simulated eigen-
values λsim kq are deduced, so that λsim k = {λsim kq}, where {·} represents a set of variables. For the
measured data, the eigenvalues were deduced so that λmeas k L×1 = [λmeas k 1, . . . , λmeas k l]T. Some
results are presented in Figure 14.18.

0
0.5
1
1.5
2
3
3.5
4
0
10
20
30
40
50
60
70
80
90
100
| ∆error_k | in dB at 50% outage
l3
l2
l1
l4
2.5
% Env. where | ∆e rror_k | < abscissa
−20
−15
−10
−5
0
5
10
15
−2
−1.8
−1.6
−1.4
−1.2
−1
−0.8
−0.6
−0.4
−0.2
0
Eigenvalue (dB)
Log P (eigenvalue < abscissa)
l 3
l 2
l 1
measured
simulated
(c)
(b)
−20
−15
−10
−5
0
5
10
15
−2
−1.8
−1.6
−1.4
−1.2
−1
−0.8
−0.6
−0.4
−0.2
0
Eigenvalue (dB)
Log P (eigenvalue < abscissa)
l4
l 3
l2
l 1
measured
simulated
(a)
Figure 14.18 (a) Local validation. Cdf of λmeas k and λsim k from Example 1 (picocell
decorrelated); (b) local validation. Cdf of λmeas k and λsim k for each of the
107 paths from Example 2 (microcell correlated); (c) global validation. Cdf
of |error k| over the 107 paths.

696
CHANNEL MODELING AND MEASUREMENTS FOR 4G
14.3.5.2
Deﬁnition of the power allocation schemes
In the situation where the channel is known at both Tx and Rx, and is used to compute the optimum
weight, the power gain in the kth subchannel is given by the kth eigenvalue, i.e. the signal to noise
ratio (SNR) for the kth subchannel equals
γk = λk
Pk
σ 2
N
(14.33)
where Pk is the power assigned to the kth subchannel, λk is the kth eigenvalue and σ 2
N is the noise
power. For simplicity, it is assumed that σ 2
N = 1. According to Shannon, the maximum capacity
normalized with respect to the bandwidth (given in terms of b/s/Hz spectral efﬁciency) of parallel
subchannels equals [47]
C =
K

k=1
log2(1 + γk)
(14.34)
=
K

k=1
log2

1 + λk
Pk
σ 2
N

(14.35)
where the mean SNR is deﬁned as
SNR = E[PRx]
σ 2
N
= E[PTx]
σ 2
N
(14.36)
Given the set of eigenvalues {λk}, the power Pk allocated to each subchannel k is determined to
maximize the capacity by using Gallagher’s water ﬁlling theorem [27] such that each subchannel is
ﬁlled up to a common level D, i.e.
1
λ1
+ P1 = · · · = 1
λK
+ Pk = · · · D
(14.37)
with a constraint on the total Tx power such that
K

k=1
Pk = PTx
(14.38)
where PTx is the total transmitted power. This means that the subchannel with the highest gain is
allocated the largest amount of power. In the case where 1/λk > D, then Pk = 0.
When the uniform power allocation scheme is employed, the power Pk is adjusted according to
P1 = · · · = PK
(14.39)
Thus, in the situation where the channel is unknown, the uniform distribution of the power is applicable
over the antennas [27] so that the power should be equally distributed between the N elements of the
array at the Tx, i.e.
Pn = PTx
N ,
∀n = 1 . . . N
(14.40)
Some results are given in Figure 14.19. In Figure 14.19(a), Ck is the capacity of the kth subchannel
of Figure 14.18(a).
14.4
OUTDOOR MOBILE CHANNEL (5.3 GHZ)
In this section we discuss the mobile channel at 5.3 GHz. The discussion is based on measurement
results collected at six different sites [48]. Site A is an example of a dense urban environment, the

OUTDOOR MOBILE CHANNEL (5.3 GHZ)
697
0
5
10
15
20
25
30
−2
−1.8
−1.6
−1.4
−1.2
−1.0
−0.8
−0.6
−0.4
−0.2
0
Capacity (b/s/Hz)
log P (capacity < abscissa)
C1
C2
C3
C4
SNR = 20 dB
Wa terfill
uni form
4
ΣCi
Waterfill
uniform
(a)
0
5
10
15
20
25
30
0
5
10
15
20
25
30
SNR (dB)
Capacity (b/s/Hz)
example 1 4x4
example 2 4x4
example 1 2x4
example 2 2x4
(b)
Figure 14.19 (a) Cdf of the capacity per subchannel Ck and its total results  Ci for
Example 1 (picocell decorrelated). A 4 × 4 antenna topology is presented
here [42]; (b) capacity (10 % level) versus SNR for Example 1 (picocell
decorrelated) and Example 2 (microcell correlated). The water ﬁlling power
allocation scheme; (c) cdf over all the 79 picocell paths of the total capacity
deduced from (b) at SNR = 20 dB for 4 × 4 and 2 × 4 antenna conﬁgurations
[42]; (d) cdf over all the 28 microcell paths of the total capacity deduced from
(b) at SNR = 20 dB for 4 × 4 and 2 × 4 antenna conﬁgurations [42] c⃝2002,
IEEE.

698
CHANNEL MODELING AND MEASUREMENTS FOR 4G
0
6
8
10
16
18
0
10
20
30
40
50
60
70
80
90
100
Capacity (b/s/Hz)
% Env. where capacity < abscissa
4
2
12
14
20
wa terfill 4x 4
uniform  4x
4
wa terfill 2x4
uniform  2x
4
picocell
waterfill 4x4
uniform  4x4
waterfill 2x4
uniform  2x4
(c)
0            2
6
8
10
16
18
0
10
20
30
40
50
60
70
80
90
100
Capacity (b/s/Hz)
% Env. where capacity < abscissa
4
12
14
20
wa terfill 4x 4
uniform  4x
4
wa terfill   2x4
uniform  2x
4
microcell
0
wa terfill 4x 4
uniform  4x
4
wa terfill   2x4
uniform  2x
4
waterfill 4x4
uniform  4x4
waterfill 2x4
  
uniform  2x4
(d)
Figure 14.19 (Cont.).

OUTDOOR MOBILE CHANNEL (5.3 GHZ)
699
transmitting antenna is about 45 m above ground level, representing a case with the BS antenna
over the rooftops. Site B is a dense urban residential environment. Here, the transmitting antenna is
placed on a mast with a height of 4 m, which is a typical case with the BS antenna lower than the
rooftops. The measurement routes for this site are shown in Figure 14.20(a). The receiving antenna
mobile station is at a height of 2.5 m on top of a car for both of the sites mentioned above. Site C
270
0
90
180
Tx
50 m
P1
P2
Van
Figure 14.20 (a) Measurement routes for Site B with Tx height of 4m; (b) Rotation mea-
surements in an urban environment, Site C [48] c⃝2002, IEEE.

700
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.10
System conﬁguration for mobile measurements in urban (U),
suburban (S) and rural (R) areas
Receiver
Direct sampling/5.3 GHz
Transmitter power
30 dBm
Chip frequency
30 MHz
Delay range
4.233 µs
Doppler range
124 Hz (U), 62 Hz (S, R)
Measurement rate
248 sets/s (U), 124 sets/s (S, R)
Sampling frequency
120 Ms/s
IRs/wavelength
5 (U), 4.2 (S, R)
Receiver velocity
2.80 m/s (U), 1.67 m/s (S, R)
Antennas and polarization
Omnidirectional antenna with 1 dBi gain;
vertical polarization
Table 14.11
Path loss models for urban environments
Tx height: 4 m
Tx height: 12 m
Tx height: 45 m
Urban
models
n
b (dB)
std (dB)
n
b (dB)
std (dB)
n
b (dB)
std (dB)
LOS
1.4
58.6
3.7
2.5
35.8
2.9
3.5
16.7
4.6
NLOS
2.8
50.6
4.4
4.5
20.0
1.7
5.8
−16.9
2.8
is located in a typical city center. The goal was to place the transmitter at some elevation relative
to the ground, but still keep it below the rooftops. The transmitting antenna is placed at a height of
12 m, and the receiving antenna is on top of a trolly with a height of 2 m above ground level. In Site
C, the rotation measurements are taken using a directive horn antenna. The 3 dB beamwidth of the
horn antenna is 30◦in the H-plane and 37◦in the E-plane, and the peak sidelobe level was 26 dB.
The speciﬁc environment for rotation measurements is shown in Figure 14.20(b). Site D represents
a semiurban/semirural residential area. The three-story buildings are the tallest ones around, and
the transmitting antenna is placed over the rooftops at a height of 12 m from ground level. Site E
was selected to represent the rural case. The transmitting antenna is placed on top of a 5 m mast
at the hilltop so that the antenna is about 55 m above the surroundings. Site F represents a typical
semiurban/urban case. The transmitter is placed on top of a 5 m mast. The receiving antenna is always
on top of a car at a height of 2.5 m. The routes are measured using the wideband channel sounder.
System parameters are summarized in Table 14.10.
14.4.1
Path loss models
Similarly to Equation (14.11), we have
PL (dB) = b + 10n log10 d
(14.11a)
where d0 = 1 m, n is the attenuation exponent, b is the intercept point in the semilog coordinate, and
dm is the distance from the receiver to the transmitter. The measurement distances are about 30–300 m
in this case. Some results are given in Tables 14.11 and 14.12 and Figure 14.21.
The measurement results for delays are summarized in Table 14.13.

Table 14.12
Path loss models for suburban and rural environments
Suburban
Rural
LOS: (Tx height: 5 m), NLOS:
Tx height: 55 m
(Tx height 12 m)
Models
n
b (dB)
std (dB)
n
b (dB)
std (dB)
LOS
3.3
21.8
3.7
2.5
38.0
4.9
NLOS
5.9
−27. 8
1.9
3.4
25.6
2.8
−75
−70
−80
−85
−90
−95
−100
Path loss (dB)
40
60
80
100
120
140
160
180
200
Distance from transmitter to receiver (m)
experimental data
linear regression
free space
−60
−70
−80
−90
−100
−110
−120
20
40
60
80
100
120
140
160
180
Distance from trransmitter to receiver (m)
Path loss (dB)
26 db difference
Diamond: experimental data
Solid line: linear regression
n=4.5
(b)
Figure 14.21 (a) Path loss for urban LOS with Tx height of 4 m; (b) mobile terminal
turning around a corner with Tx height of 12 m in an urban environment [48]
c⃝2002, IEEE.

702
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.13
Measured values for mean excess delay and rms delay spread
( ) Tx height in meters
Urban
Suburban
Rural
LOS
38
(4)
Mean excess
42
(12)
36
(5)
29
(55)
delay (ns)
102
(45)
NLOS
70
(4)
68
(12)
44
(4)
Mean
LOS
43
(12)
25
(5)
22
(55)
88
(45)
NLOS
44
(4)
66
(12)
25
(4)
Median
LOS
31
(12)
13
(5)
15
(55)
Rms delay
86
(45)
spread (ns)
NLOS
37
(4)
63
(12)
93
(4)
CDF
LOS
64
(12)
57
(5)
44
(55)
<90%
120
(45)
NLOS
63
(4)
105
(12)
14.4.2
Window length for averaging fast fading components at 5 GHz
Multipath propagation causes fast fading in mobile communications. Thus, an important consideration
in experimental data processing is how to average out the fast fading components and still preserve the
slow fading characteristics. In [49], it was suggested that a suitable window length for data taken from
macrocells is 4λ. However, examination of data taken from microcells showed that the local mean
could suffer quite large variations over short distances, and in [50], 5λ (about 1.7 m) was considered
a more appropriate window length for microcells from the experimental data at 900 MHz. In this
experiment, the least squares method with wide and narrowband received power is used to give the
linear regression curves. Let us take the regression curves as the reference values, and then change
the window length to 5, 10, 20, and 40λ for averaging the fading signals. Figure 14.22(a) shows the
wideband received power for urban LOS with a transmitter height of 12 m. If we now take the linear
regression values as the average received power, the standard deviations (std) are 2.47, 2.25, 1.93, and
1.62 dB, corresponding to the window lengths of 5, 10, 20 and 40λ, respectively. It is seen that the fast
fading components are averaged out if the window length is in the range from 20λ to 40λ, namely,
1–2 m. The same conclusion can also be obtained for averaging narrowband fast fading components,
and the corresponding result can be found in Figure 14.22(b). So, based on [1203] and the experience
of processing much measured data at 5 GHz, it seems that the practical window length for averaging
out fast fading components is 1–2 m in micro- and picocells at 900 MHz–5 GHz frequency bands.
14.4.3
Spatial and frequency correlations
Spatial and frequency correlation study is useful for the design of antenna diversity to reduce the
multipath fading. Because the correlation behavior is a small-scale effect, a wide-sense stationary
uncorrelated scattering (WSSUS) situation should be assumed. To meet this condition, about 40λ is
used as the window length to give the average correlation function. The formulas for calculating spatial
and frequency correlation functions can be found in [51, 52]. In this section, envelope correlation is
considered for narrowband signals. However, recent research [53] has shown that spatial correlation
characteristics do not largely depend on frequency bandwidth up to approximately 20 % of the

OUTDOOR MOBILE CHANNEL (5.3 GHZ)
703
−
−
−
−
−
−
−
−
(a)
−
−
−
−
−
−
−
−
(b)
−65
−70
−75
−80
−85
−90
−95
−10030
40
50
60
70
80
Relative received power (dB)
experimental data
linear regrression
5 wavelengths
10 wavelengths
20 wavelengths
40 wavelengths
experimental data
linear regrression
5 wavelengths
10 wavelengths
20 wavelengths
40 wavelengths
−65
−70
−75
−85
−90
−95
−100
Relative received power (dB)
30
40
50
60
70
80
Distance from transmitter to receiver (m)
Distance from transmitter to receiver (m)
−80
Figure 14.22 Window length for averaging out fast fading components at 5.3 GHz. (a)
Wideband, (b) narrowband [48] c⃝2002, IEEE.
carrier frequency (B/fc = 0.2, where B is the bandwidth of a transmitted signal and fc is the carrier
frequency). Therefore, the narrowband model is sufﬁcient for computing the spatial correlation
characteristics within B ≤0.2 fc.
Figure 14.23 shows the spatial and frequency envelope correlation functions for LOS outdoor
environments at different transmitter heights. It is seen that the correlation distances are strongly de-
pendent on the transmitter heights. The correlation distances with the envelope correlation coefﬁcient

704
CHANNEL MODELING AND MEASUREMENTS FOR 4G
0
5
10
15
20
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
Distance in wavelengths
Distance in wavelengths
(a)
Envelope correlation
Urban LOS Tx : 4 m
Urban LOS Tx : 12 m
Urban LOS Tx : 45 m
7
8
9
0
5
10
15
20
0.50
0.55
0.60
0.65
0.75
0.80
0.85
0.90
1.00
0.70
0.95
Envelope correlation
rural LOS Tx : 55 m
Suburban LOS Tx : 5 m
(b)
Figure 14.23 (a) Spatial correlations in LOS outdoor environments for urban cases with
three transmitter heights. (b) Spatial correlations in LOS outdoor environ-
ments for rural and suburban cases with two transmitter heights. (c) Fre-
quency correlations in LOS outdoor environments for urban cases with three
transmitter heights. (d) Frequency correlations in LOS outdoor environments
for rural and suburban cases with two transmitter heights.

OUTDOOR MOBILE CHANNEL (5.3 GHZ)
705
0
2
4
6
8
10
12
0
2
4
6
8
10
12
0.1
0.2
0.3
0.5
0.6
0.7
0.8
0.9
1.0 
Distance in MHz
(c)
Envelope correlation
Urban LOS Tx : 4 m
Urban LOS Tx : 12 m
Urban LOS Tx: 45 m
0.4
0.60
0.65
0.70
0.75
0.80
0.85
0.90
0.95
1.00
Distance in MHz
Envelope correlation
Rural LOS Tx : 55 ml
Suburban LOS Tx : 5
(d)
Figure 14.23 (Cont.).
of 0.7 are between 1 and 11λ (about 0.06–0.62 m). The respective correlation bandwidths are between
1.2 and 11.5 MHz. In LOS cases, due to the direct wave superimposed by only weak scattered waves,
the coherence is high and the correlation length is large.
14.4.4
Path number distribution
The multipath number distribution was regarded as Poisson’s and modiﬁed Poisson’s in [54], and
modiﬁed Poisson’s distribution has been shown to have good agreement with the experimental results
in some cases. However, the modiﬁed Poisson’s distribution does not have an explicit expression,
just a process. Therefore, it is not convenient for practical use. In [48], another simple and useful

706
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.14
Path number distributions for outdoor environments
Urban
Suburban
Rural
Tx 4 m
Tx 12 m
Tx 45 m
Tx 12 m
Tx 55 m
LOS
NLOS
LOS
LOS
LOS
NLOS
LOS
Poisson
2.8
4.2
3.3
6.0
1.2
4.5
l.8
η
Gao
4.7
4.5
3.5
2.7
9.0
3.3
4.0
NT
16
21
14
22
13
20
9
⟨N⟩
Poisson
2.8
4.2
3.3
6.0
1.2
4.5
l.8
Gao
2.8
3.8
3.2
6.0
1.3
4.7
l.8
Experiment
3.4
4.2
3.5
6.2
2.4
5.0
1.7
path number distribution was suggested, by considering the path number variation of radio waves in
land mobile communications a Markov process at ﬁnite state space, and it was shown to have good
agreement with the experimental results. The path number distributions given by Poisson and Gao
can be expressed as
P(N) =
ηNT −N
(NT −N)!e−η
(14.41)
P(N) = CN
NT
ηNT −N
(1 + η)NT
(14.42)
where N is variable and C means combination. NT is the maximum number of paths that the
mobile can receive. The parameters η and NT can be ﬁtted by the experimental data. For Poisson’s
probability density function (PDF), the mean path number is ⟨N⟩= η. For Gao’s PDF, the mean
value is ⟨N⟩= NT /(1 + η).
The empirical path number distributions for the outdoor measurements are ﬁtted by using Equa-
tions (14.41) and (14.42), respectively. The path numbers are obtained from measured data by counting
the peaks of the power delay proﬁles. The best ﬁt is obtained by minimizing the following standard
deviation
std =



	 1
NT
NT

i=1

pi −pi
e
2
(14.43)
where pi
e is the experimental probability corresponding to path number i, and pi is the ﬁtted probability
using Equations (14.41) and (14.42). The ﬁtted parameters are available in Table 14.14. If the
dynamic range is cut at different levels, for example, −25, −20 and −15 dB, the ﬁtting parameters in
Equations (14.41) and (14.42) will be changed, but the path number distributions still follow Poisson’s
and Gao’s distributions.
14.4.5
Rotation measurements in an urban environment
The rotation measurements at points P1 and P2 were performed at Site C and are shown in Fig-
ure 14.20(b). The transmitter height was 12 m and the receiver was on a rotating stand at a height
of 1.6 m, close to the receiver is a large open square. In the experiments, large excess delays up to
1.2 µs and rms delay spread of about 0.42 µs are found (Figure 14.24).
The power angular proﬁles (PAPs) Pr(φ) of the measurements were calculated by using the
maximal ratio combining algorithm in the delay domain [52]
Pr(φ) = αcal
 τmax
τmin
|h(τ, φ)|2 dτ
(14.44)

OUTDOOR MOBILE CHANNEL (5.3 GHZ)
707
0
30
60
90
120
150
210
240
270
300
330
500 ns
400 ns
200 ns
Eleva
tion angl
e: 0 ∞
Eleva
tion angl e: 30 ∞
120
180
330
Elevation angle: 0º
Elevation angle: 30º
Figure 14.24 RMS delay spread with different rotation angles in the azimuth plane.
0
30
60
90
120
150
180
210
240
270
300
330
Elevation angle:
 0∞
Elevation angle:
 30∞
−95 dB
−105 dB
0
30
60
90
120
150
240
270
300
330
Elevation angle: 0º
Elevation angle: 30º
Figure 14.25 Angular proﬁles of relative received power [48] c⃝2002, IEEE.
where αcal is a factor which is obtained from the calibration measurement with a cable and an
attenuator, τmin and τmax are the delays of the ﬁrst and last detectable IR components, and φ is the
angle of arrival of the waves in the azimuth plane. In the rotation measurements, the dynamic range
is cut at −26 dB relative to the strongest path. Some results for angular proﬁles of relative received
power are shown in Figure 14.25.
The number of paths as a function of azimuth angle is shown in Figure 14.26.

708
CHANNEL MODELING AND MEASUREMENTS FOR 4G
 
0
30
60
90
120
150
180
210
240
270
300
330
Elevatio n angle: 0∞
Elevatio n angle: 30∞
20
15
10
5
120
150
Elevation angle: 0º
Elevation angle: 30º
15
10
5
Figure 14.26 Numbers of paths with different rotation angles in the azimuth plane [48]
c⃝2002, IEEE.
Average building height: 8 m
90 deg
0 deg
North
50 m
Figure 14.27 The microcellular environment [55] c⃝2002, IEEE.
14.5
MICROCELL CHANNEL (8.45 GHZ)
In this section spatio-temporal channel characterization in a suburban non line-of-sight microcellular
environment is discussed. Figure 14.27 shows a map of the environment under consideration [55].
This is a residential area with predominantly wooden houses of 8 m average height and is considered
to be a typical suburban microcellular environment of size 600 × 600 m2. The trafﬁc was very light
and the environment was considered to be static throughout the experiments. A non line-of-sight
(NLOS) transmitter and receiver shown in Figure 14.27 are considered. The distance between the
transmitter and the receiver is 219 m. As a transmitter antenna, simulating the mobile station (MS), a
vertically polarized omnidirectional half wave sleeve dipole is set at a height of 2.7 m. At the receiving

MICROCELL CHANNEL (8.45 GHZ)
709
Table 14.15
Electrical parameters used in the
ray-tracing simulation
εr
σ[s/m]
Concrete [1158]
5.5
0.023
Foliage [1169]
1.2
0.0003
Ground [1171]
15.0
1.3
Metal
—
∞
Experiment
Simulation
0
40
80
120
160
200
240
280
320
360
−85
−80
−75
−70
−65
−60
−55
−50
−45
−40
Azimuth (deg)
Path gain (dB)
Figure 14.28 Azimuth proﬁle. Solid line: experiment; dotted line: simulation [55] c⃝2002,
IEEE.
point, corresponding to the base station (BS), the azimuth delay proﬁle is measured. This is done
by rotating a vertically polarized parabolic antenna which has azimuth and elevation beamwidths of
about 4◦, at an azimuth step of 4◦and is set at a height of 4.4 m. At each azimuth step, the delay
proﬁle is measured by using a delay proﬁle measurement system described in [55, 56]. At a center
frequency of 8.45 GHz and with a chip rate of 50 Mcps, a seven stage M sequence with a dynamic
range of 42 dB is transmitted. A correlation receiver is used to produce the delay proﬁle.
The electric parameters used in the ray-tracing simulation are presented in Table 14.15. The
wooden houses are modeled by concrete, as the surfaces of the houses are covered by concrete-like
paint. To compare with the experimental results, the directivity of the antenna and the autocorrelation
of the pseudorandom noise (PN) sequence were convolved with the result of the ray-tracing simulation.
Therefore, the path gain includes the antenna gain.
14.5.1
Azimuth proﬁle
Azimuth proﬁles are obtained by summing up the power of azimuth delay proﬁles with respect to the
delay time. Figure 14.28 shows the azimuth proﬁles obtained from the experiment as the solid line,
and from the simulation as the dotted line. From Figure 14.28, the forward arrival waves within the
range from −40◦to 44◦are in agreement for both data sets with respect to the level and the shape of
the proﬁle. The experimental proﬁle has the ﬂoor level of about 30 dB below the peak, but this level
is low enough so that its effect on the transmission property is negligibly small.

710
CHANNEL MODELING AND MEASUREMENTS FOR 4G
14.5.2
Delay proﬁle for the forward arrival waves
For the forward arrival waves (−40◦to −44◦), the delay proﬁles are obtained by summing up the
azimuth delay proﬁles with respect to the azimuth. The experimental result is shown in Figure 14.29(a),
and the simulation result is shown in Figure 14.29(b). The experimental result exhibits an exponential
decay. The results of least squares ﬁtting are shown as the dashed line in Figure 14.29(a). The function
is expressed as
P(τ) = −0.038τ −28.6
(14.45)
where P is the path gain in dB, and τ is the delay time in ns.
The ray-tracing simulation can predict accurately the ﬁrst two peaks in the delay proﬁle. However,
the exponential decay of the proﬁle cannot be accurately predicted. The problem here seems to
be due to incomplete modeling of the effect of random scattering in the ray-tracing simulation. If,
700
800
900
1000
1100
1200
1300
1400
1500
−90
−85
−80
−75
−70
−65
−60
−55
−50
−45
Delay time (ns)
Path gain (dB)
(a)
700
800
900
1000
1100
1200
1300
1400
1500
−90
−85
−80
−75
−70
−65
−60
−55
−50
Delay time (ns)
Path gain (dB)
(b)
Figure 14.29 Delay proﬁle of forward arrival waves: (a) experiment; (b) simulation.

MICROCELL CHANNEL (8.45 GHZ)
711
−15
−10
−5
0
5
10
15
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
Fluctuation of delay profile (dB)
cdf
Standard deviation:
s  = 5.3 dB
−20
(a)
0
5
10
15
20
25
30
−1.0
−0.5
0.0
0.5
1.0
0.0
33.3
66.7
100.0
Delay time difference (ns)
Path length difference (m)
Correlation coefficient
(b)
Figure 14.30 (a) CDF of the ﬂuctuation component of the experimental delay proﬁle from
its exponential ﬁt for forward arrival waves: experiment; (b) autocorrela-
tion of the ﬂuctuation component of the experimental delay proﬁle from its
exponential ﬁt for forward arrival waves: experiment.
however, the gradient of this exponential function can be determined by some independent means,
the ray-tracing results can be extrapolated to predict accurately the delay proﬁle.
The cumulative distribution function (CDF) of the ﬂuctuation component of the experimental
data from its exponential ﬁt is shown in Figure 14.30(a). This ﬂuctuation component can be very
accurately approximated by a log-normal distribution with a standard deviation of 5.3 dB. In the
ray-tracing simulation, waves with a long delay time cannot be predicted. Instead, their statistical
properties are used for the extrapolation.
The autocorrelation of this ﬂuctuation component is presented in Figure 14.30(b). The correlation
decreases monotonously, with a correlation distance and a time at a correlation coefﬁcient of 0.5 of

712
CHANNEL MODELING AND MEASUREMENTS FOR 4G
700
800
900
1000
1100
1200
1300
1400
1500
0
2
4
6
8
10
12
Delay time (ns)
Short-term angular spread (deg)
Experiment
Simulation
Figure 14.31 Short-term AS for forward arrival waves.
about 3 m and 10 ns, respectively. Considering the resolution of the delay proﬁle, which is equal to
the chip duration 20 ns, the ﬂuctuation is modeled as uncorrelated, just as in the wide-sense stationary
uncorrelated scattering (WSSUS) model.
14.5.3
Short-term azimuth spread (AS) for forward arrival waves
Figure 14.28 showed the azimuth proﬁle averaged over the delay time. Here, we focus on the short-
term azimuth proﬁles, which are obtained every 10 ns. The short-term AS for the forward arrival
waves, σϕ, is deﬁned as
σϕ(τ) =

⟨ϕ2(τ)⟩−⟨ϕ(τ)⟩2
(14.46)
where ⟨·⟩is the average of the ϕ weighted by the power for a ﬁxed delay time, τ. At each delay time,
the threshold level is set to be 30 dB below the peak in the proﬁle in order to calculate the short-term
AS in Equation (14.46).
Figure 14.31 shows the resultant short-term angular spread. The experimental result and the result
of the simulation agree well within the range 740–860 ns in which the ray-tracing simulation is known
to predict the delay proﬁle accurately (as shown in Figure 14.29(b)). The experimental results are
observed to exhibit the same properties for a larger delay time. Therefore, this behavior can be used
for an extrapolation of the angular proﬁle beyond the range in which the simulation can predict the
delay proﬁle.
Figure 14.31 indicates that the variation of the short-term AS can be modeled as a stationary
process. To characterize this stationary process, the CDF of the short-term AS is shown in Figure 14.32.
The solid line indicates the experimental result and the dotted line indicates the simulation result. It
is noted that the simulation result is obtained within a range of delay times from 700 ns to 880 ns.
Although the distribution functions of the experiment and the simulation look slightly different, their
average and their standard deviation are both in agreement. A Gaussian distribution has been used
as an approximation in the ﬁgure, although the most appropriate distribution function to use is still
under consideration.
Figure 14.33 shows the autocorrelation function of the short-term AS. The solid line indicates
the experimental result and the dotted line indicates the simulation result. In a similar way to
Figure 14.30(b), the correlation decreases monotonously. The correlation distance at a correlation
coefﬁcient of 0.5 is about 2 m for the experimental data and about 5 m for the simulation. The
correlation distance is smaller using the experimental data, since random scattering is not taken
into account in the simulation. As in Figure 14.30(b), considering a chip duration of 20 ns, which

MICROCELL CHANNEL (8.45 GHZ)
713
0
2
4
6
8
10
1.0
0.8
0.6
0.4
0.2
0.0
Short-term angular spread (deg)
cdf
Average of short-term angular spread:
Simulation: 5.8 deg
Experiment: 4.5 deg
S
t-term angular spread: 
Simulation: 2.3 deg
Experiment: 2.0 deg
Simulation
Experiment approximated
by Gaussian distribution
Experiment
Figure 14.32 CDF of the short-term AS for forward arrival waves. Solid line: experiment;
dotted line: simulation [55] c⃝2002, IEEE.
0
5
10
15
20
25
30
−1.0
1.0
0.5
0.0
−0.5
0.0
33.3
66.7
100.0
Delay time difference (ns)
Path length difference (m)
Correlation coefficient
Figure 14.33 Autocorrelation of the short-term AS for forward arrival waves. Solid line:
experiment; dotted line: simulation.
corresponds to a distance of 6 m, the short-term angular spread is also modeled as uncorrelated. It is
noted that the correlation distances for Figures 14.30(b) and 14.33 are comparable and that, therefore,
these two ﬂuctuations seem to be related to each other.
Since the ﬂuctuation component from the exponential function of the delay proﬁle and the short-
term azimuth proﬁle for the forward arrival waves have similar correlation lengths, this may suggest
some relationship between them.
A Nakagami–Rice fading model for the short-term azimuth proﬁle, as shown in Figure 14.34 is
used. This is composed of a stable strong signal component plus a weak scattered signal component.
The scattered signal component is assumed to be stationary. Under these assumptions, the power
increases and the AS decreases when the stable signal component is large, i.e. there is a negative
correlation between these parameters.

714
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Stable signal
component
Scattered signal
component
φ
Figure 14.34 Nakagami–Rice fading model for the short-term azimuth proﬁle.
700
800
900
1000
1100
1200
1300
1400
1500
−1.0
−0.5
0.0
0.5
1.0
Correlation coefficient
Delay time (ns)
Figure 14.35 Crosscorrelation between ﬂuctuation component of the experimental delay
proﬁle from its exponential ﬁt and the short-term azimuth proﬁle for forward
arrival waves: experiment [55] c⃝2002, IEEE.
To evaluate this model, the crosscorrelation is calculated between the ﬂuctuation component of the
experimental delay proﬁle from its exponential ﬁt and the short-term azimuth proﬁle for the forward
arrival waves, which is deﬁned as
ρPϕ =
⟨(P(τ) −⟨P(τ)⟩)(ϕ(τ) −⟨ϕ(τ)⟩)⟩

⟨(P(τ) −⟨P(τ)⟩)2⟩⟨(ϕ(τ) −⟨ϕ(τ)⟩)2⟩
(14.47)
where ⟨·⟩is the sample average within the given time window, P(τ) is the ﬂuctuation component
from the exponential function at a delay time, τ, in dB, and ϕ(τ) is the short-term angular spread
at a delay time, τ, in degrees. Figure 14.35 shows the crosscorrelation with a time window of 200
ns for the experimental data. It is clear from Figure 14.35 that the ﬂuctuation component of the
delay proﬁle and the short-term AS are negatively correlated. This result suggests that the proposed
Nakagami–Rice fading model can be used successfully to model the short-term azimuth proﬁle.
14.6
WIRELESS MIMO LAN ENVIRONMENTS (5.2 GHZ)
The presentation in this section is based on the results of a measurement campaign [57] in two
courtyards in the 5.2 GHz band assigned for wireless LANs (e.g. HYPERLAN (see www.etsi.org),
or IEEE 802.11a). These standards specify wireless communication between computers, which is a

WIRELESS MIMO LAN ENVIRONMENTS (5.2 GHZ)
715
compelling application for MIMO systems. For measurement, a channel sounder with a bandwidth
of 120 MHz connected via a fast RF switch to a uniform linear receiver antenna array is used. This
array consists of NR = 8 antenna elements (± 600 element beam width), plus two dummy elements at
each end of the array. All these components together constitute a single-directional channel sounder.
A virtual array at the transmitter consists of a monopole antenna mounted on an X–Y-positioning
device with stepping motors.
The experiment starts by positioning the transmit antenna at a certain position. At the receiver,
the RF switch is connected to the ﬁrst antenna element of the array, so that the transfer function
(measured at 192 frequency samples) from the ﬁrst transmit to the ﬁrst receive element of the array
is measured. Then, the switch is connected to the next receive antenna element, and the next transfer
function is measured. The measurement of all the transfer functions is repeated 256 times, in order
to assess the time variance of the channel (see below). Then, the transmit antenna is moved to the
next position, and the procedure is repeated. NT = 16 transmit antenna positions are situated on a
cross (i.e. 8 positions on each axis of the cross) and bursts of complex channel transfer functions
are recorded. Any virtual array requires that the channel remains static during the measurement
period. One complete measurement run (2 × 8 antenna positions at TX times eight spatial samples at
RX times 192 frequency samples and 256 temporal samples gives 16 × 8 × 192 × 256 = 6 291 456
complex samples) takes about ﬁve minutes.
14.6.1
Data evaluation
Starting from the four-dimensional transfer function (time, frequency, position of RX antenna, position
of TX antenna), the Doppler-variant transfer function is computed ﬁrst, by Fourier transforming the
256 temporal samples (with Hanning windowing). Next, all components that do not exhibit zero
Doppler shift (Doppler ﬁltering) are elliminated. Those components correspond, for example, to
MPCs scattered by leaves moving in the wind. The eliminated components carry on the order of
1 % of the total energy. The three-dimensional (static) transfer function obtained in that way is then
evaluated by Unitary ESPRIT [33] to estimate the delays τi. Unitary ESPRIT is an improved version
of the classical ESPRIT algorithm discussed in Chapter 13. They both estimate the signal subspace
for extraction of the parameters of (spatial or frequency) harmonics in additive noise. One important
step in ESPRIT is the estimation of the model order. Different methods have been proposed in the
literature for that task. The relative power decrease between neighboring eigenvalues with additional
correction by visual inspection of the scree graph showing the eigenvalues is an option used for
generating the results presented subsequently.
After estimation of the parameters τi, we can determine the corresponding ‘steering’ matrix Aτ.
Subsequent beamforming with its Moore–Penrose pseudoinverse [33, 58–61] A+
τ gives the vector of
delay weights for all xR, xT
hτ(xT, xR) = A+
τ T f (xT, xR)
(14.48)
where T f is the vector of transfer coefﬁcients at the 192 frequency subbands sounded. This gives
us now the transfer coefﬁcients from all positions xT to all positions xR separately for each delay τi.
Thus, one dimension, namely the frequency, has been replaced by the parameterized version of its
dual, the delays.
For the estimation of the directions of arrival (DOA) in each of the two-dimensional transfer
functions, ESPRIT estimation and beamforming by the pseudoinverse are used
hϕR(τi, xT) = A+
ϕRhxR(τi, xT)
(14.49)
Finally, for the direction of departure (DOD) we have
hϕT(τi, ϕR,i, j) = A+
ϕThxT(τi, ϕR,i, j)
(14.50)
Figure 14.36 illustrates these steps.
The procedure gives us the number and parameters of the MPCs, i.e. the number and values of
delays, which DOA can be observed at these delays, and which DOD corresponds to each DOA
at a speciﬁc delay. Furthermore, we also obtain the powers of the MPCs. One important point in

716
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Doppler Filtering
Delay Estimation
Delay Beamforming
DOA Estimation
DOA Beamforming
for zero Doppler shift
loop over all delays
loop over all DOAs
DOD Estimation
DOD Beamforming
Doppler filtering
Delay estimation
Delay beamforming
DOA estimation
DOA beamforming
for zero Doppler shift
loop over all delays
loop over all DOAs
DOD estimation
DOD beamforming
Figure 14.36 Sequential estimation of the parametric channel response in the different
domains: alternating estimation and beamforming [57] c⃝2002, IEEE.
the application of the sequential estimation procedure is the sequence in which the evaluation is
performed. Roughly speaking, the number of MPCs that can be estimated is the number of samples
we have at our disposal.
14.6.2
Capacity computation
In a fading channel, the capacity is a random variable, depending on the local (or instantaneous)
channel realization. In order to determine the cumulative distribution function (cdf) of the capacity,
and thus the outage capacity, we would have to perform a large number of measurements, either
with slightly displaced arrays, or with a temporally varying scatterer arrangement. Since each single
measurement requires a huge effort, such a procedure is highly undesirable.
To improve this situation, an evaluation technique that requires only a single measurement of the
channel is used. This technique relies on the fact that we can generate different realizations of the
transfer function by changing the phases of the multipath components. It is a well established fact in
mobile radio that the phases are uniformly distributed random variables, whose different realizations
occur as either transmitter, receiver or scatterers move [27]. We can thus generate different realizations
of the transfer function from the mth transmit to the kth receive antenna as
hk,m( f ) =

i
ai exp

−j 2π
λ d

k sin

φR,i

+ m sin

φT,i

× exp (−j2π f τi) exp ( jαi)
(14.51)
where αi is a uniformly distributed random phase, which can take on different values for the different
MPCs numbered i. Note, however, that αi stays unchanged as we consider different antenna elements
k and m. To simplify discussion, we, for now, consider only the ﬂat fading case, i.e. τi = 0. We can
thus generate different realizations of the channel matrix H
H =


h11
h12
· · ·
h1NT
h21
h22
· · ·
h2NT
· · ·
· · ·
· · ·
· · ·
hNR1
hNR2
· · ·
hNR NT


(14.52)
by the following two steps.

WIRELESS MIMO LAN ENVIRONMENTS (5.2 GHZ)
717
1. From a single measurement, i.e. a single snapshot of the channel matrix, determine the DOAs
and DODs of the MPCs as described earlier in the section.
2. Compute synthetically the impulse responses at the positions of the antenna elements, and at
different frequencies. Create different realizations of one ensemble by adding random phase
factors (uniformly distributed between 0 and 2π) to each MPC. For each channel realization,
we can compute the capacity (from Section 4.12)
C = log2 det

I + ρ
NT
HHH

(14.53)
where ρ denotes the SNR. I is the identity matrix and superscript H means Hermitian transpo-
sition. For the frequency selective case, we have to evaluate the capacity by integrating over
all frequencies
C =

log2 det

I + ρ
NT
HH ( f ) H ( f )

d f
(14.54)
Here, H ( f ) is the frequency-dependent transfer matrix. The integration range is the bandwidth
of interest.
14.6.3
Measurement environments
As an example, the following scenarios are evaluated with the procedure described above [57]:
r Scenario I: A courtyard with dimensions 26 m × 27 m, open on one side. The RX array broadside
points into the center of the yard, the transmitter is located on the positioning device 8m away in
LOS. The power delay proﬁle (PDP) in this scenario is given in Figure 14.37 (a).
r Scenario II: Closed backyard of size 34 m × 40 m with inclined rectangular extension. The RX
array is situated in one rectangular corner with the array broadside of the linear array pointing
under 45◦inclination directly to the middle of the yard. The LOS connection between TX and RX
measures 28 m. Many metallic objects are distributed irregularly along the building walls (power
transformers, air conditioning fans, etc.). This environment looks very much like the backyard of
a factory (Figure 14.38).
Averaged PDP
Estimated delay MPCs
Averaged PDP
Estimated delay MPCs
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
Delay (µs)
Delay (µs)
Power density (dB)
−120
−110
−100
−90
−80
−70
−60
−50
−130
−120
−110
−100
−90
−80
−70
Power density (dB)
ti
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
(
(a)
(b)
Figure 14.37 Power delay proﬁles (lines) in (a) the LOS Scenario I and (b) in the obstructed
LOS Scenario IV. Superimposed circles are the identiﬁed MPCs that are
further used to compute the simulated capacities.

718
CHANNEL MODELING AND MEASUREMENTS FOR 4G
TX
RX
0
10
20
30
40
50
60
X coordinate (m)
Y coordinate (m)
−50
−45
−40
−35
−30
−25
−20
−15
−10
−5
0
TX
0
2
0
Figure 14.38 Geometry of the environment of Scenarios II to IV (backyard) in plan view.
Superimposed are the extracted DOAs and DODs for Scenario III [57]
c⃝2002, IEEE.
r Scenario III: Same closed backyard as in II but with artiﬁcially obstructed LOS path. It is expected
that the metallic objects generate serious multipath and higher order scattering that can only be
observed within the dynamic range of the device if the LOS path is obstructed.
r Scenario IV: Same as Scenario III but with different TX position and LOS obstructed. The TX is
situated nearer to the walls. Figure 14.37 (b) gives the measured power delay proﬁle. The PDPs in
Scenarios II and III look similar, besides the LOS component that occurs dominantly for Scenario
II. More details about the scenarios can be found in [62].
Some of the measurement results for these scenarios are presented in Figure 14.39.
14.7
INDOOR WLAN CHANNEL (17 GHZ)
In this section we discuss the indoor radio propagation channel at 17 GHz. The presentation is based
on results reported in [63]. Wideband parameters, such as coherence bandwidth or rms delay spread,
and coverage are analyzed for the design of an OFDM-based broadband WLAN. The method used
to obtain the channel parameters is based on using a simulator described in [63]. This simulator
is a site-speciﬁc propagation model based on three-dimensional (3D) ray-tracing techniques, which
has been speciﬁcally developed for simulating radio coverage and channel performance in enclosed
spaces such as buildings, and for urban microcell and picocell calculations. The simulator requires the
input of the geometric structure and the electromagnetic properties of the propagation environment,
and is based on a full 3D implementation of geometric optics and the uniform theory of diffraction
(GO/UTD). Examples of the measurement environments are given in Figure 14.40.
The results for coherence bandwidth Bc = 1/ατrms are given in Table 14.16 and Figure 14.41.

INDOOR WLAN CHANNEL (17 GHZ)
719
−80
−60
−40
−20
0
20
40
60
80
−80
−60
−40
−20
0
20
40
60
80
DOA relative to array broadside (deg)
DOA relative to array broadside (deg)
−20
−15
−10
−5
0
5
−10
−8
−6
−4
−2
0
2
Power density (dB/deg)
Power density (dB/deg)
Azimuth power spectrum
Local maxima
Azimuth power spectrum
Local maxima
0
Power density (dB/deg)
(a)
II
I
III
IV
ideal
Scenario I
Scenario II
Scenario III
Scenario IV
Ideal
0
10
20
25
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Capacity (bits/s/Hz)
cdf (capacity)
0
10
20
25
0
0.1
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Figure 14.39 (a) Azimuth power spectra at the transmitter (upper plot) and receiver (lower
plot) for Scenario III (obstructed LOS). Spectra computed with MVM (min-
imum variance method, Capon’s beamformer). Angles refer to array broad-
side, so that (due to the array position) +8 and −53 degrees correspond [57];
(b) cdfs of the MIMO channel capacity encountered in Scenarios I–IV, and
the cdf for an ideal channel. The SNR is 20 dB, and 4 × 4 antenna elements
were used; (c) outage capacity at the 10 % level in Scenarios I (LOS) and
IV (LOS) over the number of antenna element pairs; (d) capacity of a 4 × 4
antenna arrangement in Scenario I at different bandwidths and SNR = 20 dB
(capacity is normalized to unit bandwidth); (e) capacity distribution for the
narrowband case (dashed) and 100 MHz bandwidth (solid) and 10 dB SNR
in Scenario I for array sizes NT = NR = 1, 2, 4, 8. c⃝2002, IEEE.

Measured (IV)
Synthetic (IV)
Measured (I)
Synthetic (I)
Scenario I (LOS)
Scenario IV (NLOS)
1
2
3
4
5
6
7
8
0
5
10
15
20
25
30
Number of antenna element pairs
10 % outage capacity (bits/s/Hz)
ed 
(IV)
ed (I)
io 
1
2
3
4
0
5
10
15
20
25
30
(c)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
cdf (capacity)
1
12
13
14
15
16
17
Capacity (bits/s/Hz)
Narrowband
10 MHz
100 MHz
0
1
12
13
14
15
16
17
z
(d)
0
0.1
0.
0.3
0.4
0.5
0.6
0.7
0.8
0.9
cdf (capacity)
1
0
2
4
6
8
10
Capacity (bits/s/Hz)
Narrowband
100 MHz
1
3
5
7
9
N = 1
 2
N = 4
N = 8
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
2
4
6
1
3
5
7
9
= 
N = 2
= 
 = 8
(e)
Figure 14.39 (Cont.).

Figure 14.40 (a) Hall (49 m × 26 m) [63]; (b) Floors −2 and −3 below top T (34 m
× 20 m) [63]; (c) ofﬁce building (72 m × 38 m), 3D representation [63]
c⃝2002, IEEE.

722
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.16
Bc at 17 GHz
Coherence bandwidth (MHz)
Standard
Place
Mean
deviation
Hall
24.85
12.35
Floors
14.44
9.85
Building
22.86
10.24
Total
20.72
11.56
0
5
10
15
20
25
30
35
40
45
Bc  (MHz)
Bc at 17 GHz CDF
0
0.1
0.2
0.3
0.4
0.6
0.7
0.8
0.9
1
cdf
0
5
10
15
20
25
30
35
40
45
0
0.1
0.2
0.3
0.5
1
Figure 14.41 Bc CDF at 17 GHz [1216] c⃝2002, IEEE.
A further requirement related to the correct and efﬁcient channel estimation process by the receiver
is the selection of a number of subcarriers in OFDM satisfying the condition of being separated
between approximately Bc/5 and Bc/10. Results for delay spread are shown in Figure 14.42 and
Tables 14.17–14.20.
Results for the path loss exponent are given in Figure 14.43 and Tables 14.21 and 14.22.
For channel modeling purposes, the mean power of the received signal will be represented as
PRX|dB = PTX|dB + GTX|dB + GRX|dB −Lfs|dB
+ 10 · log
 ∞
0
PDP (t) . dt

(14.55)
where PTX is the mean power at the transmitting antenna input, GTX is the transmitting antenna gain,
while GRX is the receiving antenna gain. Lfs is free space propagation loss, given by
Lfs|dB = 32.45 dB + 20 · log10(dKm + fMHz)

0
1
2
3
4
5
6
Alpha
Alpha at 17 GHz CDF
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
cdf
2
3
4
5
6
a  
1
(a)
40
60
80
100
120
140
160
180
200
Tmax (ns)
Tmax at 17 GHz (up to 30 dB below)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
cdf
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(b)
20
40
60
80
100
120
140
160
Tmax (ns)
Tmax at 17 GHz (up to 20 dB below)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
cdf
to
(c)
Figure 14.42 (a) RMS delay spread CDF (Bc = 1/ατrms); (b) maximum delay CDF, 30 dB
criterion; (c) maximum delay CDF, 20 dB criterion; (d) alpha CDF.

0
10
20
30
40
50
60
RDS (ns)
RDS at 17 GHz CDF
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
cdf
S 
S 
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(d)
Figure 14.42 (Cont.).
Table 14.17
RMS delay spread CDF for Figure 14.42(a) [63]
c⃝2002, IEEE
CDF value
RDS value (ns)
0.2
12.1
0.4
14.3
0.6
17.5
0.8
34.3
1
58.3
Table 14.18
Maximum delay CDF, 30 dB criterion
(Figure 14.42(b)) [63]
CDF value
Tmax value (ns)
0.2
62
0.4
76
0.6
101
0.8
122
1
197
Table 14.19
Maximum delay CDF, 20 dB criterion (Figure 14.42(c))
[63] c⃝2002, IEEE
CDF value
Tmax value (ns)
0.2
51
0.4
56
0.6
69
0.8
94
1
156

INDOOR WLAN CHANNEL (17 GHZ)
725
Table 14.20
Alpha CDF, Bc = 1/ατrms (Figure 14.42(d))
CDF value
Alpha value
0.2
2.17
0.4
2.67
0.6
3.75
0.8
4.44
1
5.78
1
1.5
2
2.5
3
3.5
4
4.5
5
n
n CDF
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
cdf
LOS
OLOS
NLOS
F
Figure 14.43 CDF of path loss exponent ‘n’.
Table 14.21
Mean values of ‘n’
Type of path
LOS
OLOS
NLOS
‘n’ mean value
1.68
2.14
2.61
Table 14.22
Fading statistic over distance,
LOS case
Radius (m)
K factor
4
17
5
10
6
9
7
8
8
6
9
5
10
1

726
CHANNEL MODELING AND MEASUREMENTS FOR 4G
and PDP(t) is the modeled power delay proﬁle. Once the PDF is modeled, to obtain the discrete
channel impulse response, hi, we only have to add a random phase to the square root of each delay
bin amplitude, as follows:
hi = √pie jφi
φi
r.υ.
unif [0, 2π]
(14.56)
where hi is the ith bin of the modeled channel impulse response and pi, the module of the ith bin of
the modeled power delay proﬁle.
It can be assumed that phases of different components of the same channel impulse response
are uncorrelated at the frequency of interest (17 GHz), because their relative range is higher than a
wavelength, even for high resolution models [64].
As the total bandwidth assigned to the communication is 50 MHz, a selection of 10 ns for the bin
size must be made. Using 99 % of the total power criterion for the maximum duration of the PDF, the
former bin size selection leads to a total of nine taps for the LOS case and seventeen for the NLOS
case.
The statistical variability of the bin amplitudes has been modeled following different probability
density functions. Taking into account the fact that the area of service of future applications (SOHO–
small ofﬁce home ofﬁce) has small ranges, the variability has been analyzed considering a medium
scale, that is, the environment is divided in the LOS area and the NLOS one. In the LOS case, a
Frechet PDF [1218] is chosen for the ﬁrst bin and exponential PDFs for the rest.
A continuous random variable X has a Frechet distribution if its PDF has the form
f (x; σ; λ) = λ
σ
σ
x
λ+1
exp

−
σ
x
λ
;
(14.57)
x ≥0;
σ, λ > 0.
A Frechet variable X has the CDF
F (x; σ; λ) = exp

−
σ
x
λ
(14.58)
This model has a scale structure, with σ a scale parameter and λ a shape parameter. A continuous
random variable X has an exponential distribution if its PDF has the form
f (x; µ) = 1
σ exp

−
 x −µ
σ

(14.59)
x ≥0;
µ, σ > 0
This PDF has a location–scale structure, with a location parameter, µ, and a scale, σ. The CDF of
the exponential variable X is
F (x; µ) = 1 −exp

−
 x −µ
σ

(14.60)
These PDFs were considered the most suitable after a ﬁtting process.
The NLOS case needs a combination of exponential and Weibull PDFs for the ﬁrst bin and
exponential PDFs for the others. A continuous random variable X has a Weibull distribution if its
PDF has the form
f (x; σ; λ) = λ
σ
 x
σ
λ−1
exp

−
 x
σ
λ
(14.61)
x ≥0;
σ, λ > 0
While the CDF is
F (x; σ; λ) = 1 −exp

−
 x
σ
λ
(14.62)
This model has a scale structure, that is, σ is a scale parameter, while λ is a shape parameter.
Tables 14.23 and 14.24 show the probability density functions employed for LOS and NLOS channel
models [63]. For both tables, the units of parameter σ are Hz (s−1), while λ has no units. These

INDOOR WLAN CHANNEL (60 GHZ)
727
Table 14.23
Wind-ﬂex channel model PDFs, LOS case [63]
WIND-FLEX LOS Channel model pdfs
Bin 1 Frechet
Bin 4 Exponential
Bin 7 Exponential
(σ = 2.66 × 10−8, λ = 7)
(σ = 1.45 × 10−7)
(σ = 0.41 × 10−7)
Bin 2 Exponential
Bin 5 Exponential
Bin 8 Exponential
(σ = 5.44 × 10−7)
(σ = 1.03 × 10−7)
(σ = 0.27 × 10−7)
Bin 3 Exponential
Bin 6 Exponential
Bin 9 Exponential
(σ = 2.51 × 10−7)
(σ = 0.79 × 10−7)
(σ = 0.71 × 10−7)
Table 14.24
Wind-ﬂex channel model PDFs, NLOS case [63]
WIND-FLEX NLOS Channel model pdfs
0.5∗[Exponential
Bin 1
(σ = 4.378 × 10−6)
Bin 7
Exponential
Bin 13
Exponential
+ Weibull(σ = 4.207)
(σ = 1.88 × 10−5)
(σ = 9.21 × 10−4)
×10−7, λ = 5
Bin 2
Exponential
Bin 8
Exponential
Bin 14
Exponential
(σ = 3.04 × 10−6)
(σ = 2.51 × 10−5)
(σ = 1.27 × 10−5)
Bin 3
Exponential
Bin 9
Exponential
Bin 15
Exponential
(σ = 2.47 × 10−6)
(σ = 5.69 × 10−5)
(σ = 2.76 × 10−4)
Bin 4
Exponential
Bin 10
Exponential
Bin 16
Exponential
(σ = 2.14 × 10−6)
(σ = 1.53 × 10−5)
(σ = 6.71 × 10−4)
Bin 5
Exponential
Bin 11
Exponential
Bin 17
Exponential
(σ = 1.1 × 10−6)
(σ = 3.29 × 10−5)
(σ = 6.42 × 10−4)
Bin 6
Exponential
Bin 12
Exponential
(σ = 3.71 × 10−5)
(σ = 2.67 × 10−5)
units have no physical correlation but make the last term of Equation (14.55) non-dimensional, as
it represents a factor scale between the free space behavior and the real one.The mean value of the
probability density functions is so high due to the ulterior integral over the time (in seconds) required,
and the PDF duration (tens of nanoseconds). As expected, the mean value of the ﬁrst bin is the highest,
since it includes the direct ray (LOS case).
Additional details on the topic can be found in [64–76].
14.8
INDOOR WLAN CHANNEL (60 GHZ)
Based on the results reported in [77], in this section we present spatial and temporal characteristics
of 60 GHz indoor channels. In the experiment, a mechanically steered directional antenna is used
to resolve multipath components. An automated system is used to position the receiver antenna
precisely along a linear track and then rotate the antenna in the azimuthal direction as illustrated
in Figure 14.44. Precision of the track and spin positions is less than 1 mm and 1◦, respectively.
When a highly directional antenna is used, the system provides high spatial resolution to resolve
multipath components with different angles of arrival (AOAs). The sliding correlator technique was
used to further resolve multipath components with the same AOA by their times of arrival (TOAs).

728
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Track measurements
Tx
Tx
Spin measurements
l/4
20l
Rx
Track step: l/4
Number of steps: 80
20
Rx
Number of steps: 4
Track step: 5l
Spin step: 5°
Number of steps: 72
 
/4
20
Rx
ep: 
mb
20l
st
5
°
Figure 14.44 Track and spin measurement procedure [77] c⃝2002, IEEE.
The spread spectrum signal has an RF bandwidth of 200 MHz, which provides a time resolution of
approximately 10 ns.
For this measurement campaign, an open-ended waveguide with 6.7 dB gain is used as the
transmitter antenna, and a horn antenna with 29 dB gain is used as the receiver antenna. These
antennas are chosen to emulate typical antenna systems that have been proposed for millimeter-wave
indoor applications. In these applications, a sector antenna is used at the transmitter and a highly
directional antenna is used at the receiver. Both antennas are vertically polarized and mounted on
adjustable tripods about 1.6 m above the ground. The theoretical half power beamwidths (HPBW)
are 90◦in azimuth and 125◦in elevation for the open-ended waveguide, and 7◦in azimuth and 5.6◦
in elevation for the horn antenna. Some measurement results for speciﬁc environments and locations
are shown in Figure 14.45(a)–(c).
14.8.1
Deﬁnition of the statistical parameters
14.8.1.1
Path loss and received signal power
The free space path loss at a reference distance of d0 is given by
PLfs(d0) = 20 log
4πd0
λ

(14.63)
where λ is the wavelength. Path loss over distance d can be described by the path loss exponent model
as follows:
PL(d)[dB] = PLfs(d0)(dB) + 10n log10
 d
d0

(14.64)
where PL(d) is the average path loss value at a TR separation of d, and n is the path loss exponent
that characterizes how fast the path loss increases with the increase of TR separation. The path loss
values represent the signal power loss from the transmitter antenna to the receiver antenna. These
path loss values do not depend on the antenna gains or the transmitted power levels. For any given
transmitted power, the received signal power can be calculated as
Pr(dBm) = Pt(dBm) + Gt(dB) + Gr(dB) −PL(d)(dB)
(14.65)

INDOOR WLAN CHANNEL (60 GHZ)
729
Figure 14.45 (a) AOA measurements for propagation within a room (location 4), relative
power levels are shown on the polar plots, and peak multipath power (P) is
given in the text boxes. Rays are shown only for locations 4.2 and 4.4 in the
ﬁgure, although a similar procedure can be performed for all the locations;
(b) AOA measurements for propagation along a hallway (location 2), relative
power levels are given in the polar plots, and peak multipath power (P)
is given in the text at the bottom of the ﬁgure; (c) AOA measurements for
propagation into rooms (locations 5 and 6), relative power levels are given
in the polar plots, and peak multipath power (P) is given in the text boxes
[77] c⃝2002, IEEE.

730
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Figure 14.45 (Cont.).
where Gt and Gr are transmitter and receiver gains, respectively. In this measurement campaign,
the transmitted power level was 25 dBm, the transmitter antenna gain was 6.7 dB, and the receiver
antenna gain was 29 dB.
14.8.1.2
TOA parameters
TOA parameters characterize the time dispersion of a multipath channel. The calculated TOA param-
eters include mean excess delay ( ¯τ), rms delay spread (στ), and also timing jitter (δ(x)) and standard
deviation (∆(x)), in a small local area. Parameters ¯τ and στ are given as [78]:
¯τ =
N

i=1
Piτi
N

i=1
Pi
(14.66)
στ =

τ 2 −( ¯τ)2
(14.67)
τ 2 =
N

i=1
Piτ 2
i
N

i=1
Pi
(14.68)

INDOOR WLAN CHANNEL (60 GHZ)
731
where Pi and τi are the power and delay of the ith multipath component of a PDF, respectively, and N
is the total number of multipath components. Timing jitter is calculated as the difference between the
maximum and minimum measured values in a local area. Timing jitter δ(x) and standard deviation
∆(x) are deﬁned as
δ(x) =
M
max
i=1 {xi} −
M
min
i=1 {xi}
(14.69)
(x) =

x2 −( ¯x)2
(14.70)
¯x = 1
M
M

i=1
xi
(14.71)
x2 = 1
M
M

i=1
x2
i
(14.72)
where xi is the measured value for parameter x(¯τ or στ) in the ith measurement position of the spatial
sampling, and M is the total number of spatial samples in the local area. For example, for the track
measurements, M was chosen to be 80.
Mean excess delay and rms delay spread are the statistical measures of the time dispersion of the
channel. Timing jitter and standard deviation of ¯τ and στ show the variation of these parameters over
the small local area.
These TOA parameters directly affect the performance of high-speed wireless systems. For in-
stance, the mean excess delay can be used to estimate the search range of RAKE receivers and the rms
delay spread can be used to determine the maximum transmission data rate in the channel without
equalization. The timing jitter and standard deviation parameters can be used to determine the update
rate for a RAKE receiver or an equalizer.
14.8.1.3
AOA parameters
AOA parameters characterize the directional distribution of multipath power. The recorded AOA
parameters include angular spread Λ, angular constriction γ , maximum fading angle θmax, and
maximum AOA direction. Angular parameters Λ, γ and θmax are deﬁned based on the Fourier
transform of the angular distribution of multipath power, p(θ) [79]:
Λ =
 
1 −||F1||2
||F2||2
(14.73)
γ =
||F0F2 −F2
1 ||
||F0||2 −||F1||2
(14.74)
θmax = 1
2phase
!
F0F2 −F2
1
"
(14.75)
where
Fn =
 2π
0
p(θ) exp( jnθ) dθ
(14.76)
Fn is the nth Fourier transform of p(θ). As shown in [79], angular spread, angular constriction and
maximum fading angle are three key parameters to characterize the small-scale fading behavior of the
channel. These new parameters can be used for diversity techniques, fading rate estimation, and other
space–time techniques. The maximum AOA provides the direction of the multipath component with
the maximum power. It can be used in system installation to minimize the path loss. The results of
measurements for the parameters deﬁned by Equations (14.63–14.76) are given in Tables 14.25–14.27
and Figure 14.46.
More details on the topic can be found in [79–90].

732
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.25
Spin measurements: transmitter–receiver separations (TR) in m, time disper-
sion parameters (¯τ and στ) in ns, angular dispersion parameters (Λ and γ ) are
dimensionless, maximum fading angle (θmax) and AOA of maximum multi-
path (max AOA) in degrees, ratio of maximum multipath power to average
power (Peak/avg) in dB and maximum multipath power (Pmax) in dBm [77]
Site
max
Peak
information
#
TR
¯τ
στ
Λ
γ
θmax
AOA
avg
Pmax
Comments
LOS, hallway
1.1
5
80.0
14.7
0.46
0.83
−80.7
−4.0
12.3
−14.9
Durham Hall
1.2
10
52.0
18.8
0.44
0.74
−86.6
4.0
12.0
−18.2
1.3
20
85.9
40.1
0.56
0.28
−61.9
8.0
14.5
−28.8
1.4
30
116.6
38.7
0.42
0.22
−66.4
5.0
14.7
−28.3
open area
1.5
40
84.9
60.0
0.69
0.25
4.3
5.0
13.9
−38.2
1.6
50
52.1
26.1
0.66
0.26
8.2
10.0
13.3
−38.2
1.7
60
53.2
30.3
0.78
0.36
4.0
2.0
13.2
−40.8
LOS, hallway
2.1
5
51.0
20.7
0.48
0.88
−73.5
5.0
12.5
−13
Whittemore
2.2
10
62.1
29.4
0.66
0.79
−72.3
21.0
11.4
−21.7
intersection
2.3
20
90.7
14.6
0.36
0.43
−73.8
4.0
12.9
−29.8
2.4
30
41.2
12.3
0.41
0.15
−64.8
10.0
13.8
−31.7
2.5
40
83.7
53.8
0.72
0.19
5.0
1.0
13.2
−36.0
LOS, room
3.1
4.2
42.6
16.2
0.86
0.64
−79.2
0.0
12.5
−11.8
corner
Durham Hall
3.2
3.3
47.7
17.5
0.81
0.70
−79.1
5.0
13.1
−12.1
center
LOS, room
4.1
7.1
46.6
13.0
0.84
0.55
−88.0
−60.0
12.3
−26.8
corner
Whittemore
4.2
3.8
64.3
13.3
0.62
0.74
−89.6
−1.0
13.1
−25.6
center
4.3
5.2
66.3
17.7
0.73
0.84
−35.2
49.0
14.0
−30.4
corner, ⊥to Tx
4.4
4.2
77.8
13.3
0.78
0.72
−38.2
−49.0
14.2
−28.6
corner, ⊥to Tx
Hallway to
5.1
2.4
49.1
21.4
0.81
0.13
−76.3
0.0
12.0
−6.0
LOS
room
5.2
2.4
41.6
18.1
0.74
0.44
−89.6
5.0
10.3
−14.1
through wall
5.3
2.4
95.8
14.6
0.63
0.40
−88.1
0.0
12.1
−5.6
LOS
5.4
2.4
80.3
16.0
0.68
0.27
72.3
5.0
11.9
−8.9
through glass
Room to room
6.1
3
42.7
16.6
0.80
0.40
−25.3
52.0
11.5
−36.4
through wall
LOS, outdoor
7.1
1.9
41.3
17.4
0.12
0.97
−81.2
2.0
13.9
−15.0
Tx pattern
parking lot
7.2
1.9
56.6
16.1
0.49
0.94
−66.7
20.0
8.5
−29.9
Rx pattern
LOS, outdoor
8.1
2
24.4
7.7
0.26
0.76
−66.3
3.0
13.9
−10.1
near Durham Hall
14.9
UWB CHANNEL MODEL
UWB channel parameters were discussed to some extent in Chapter 8. In this section we will present
some additional results with the focus on channel modeling, mainly based on [91].
The measurements environment is presented in Figure 14.47 and the signal format used in these
experiments in Figure 14.48.
The repetition rate of the pulses is 2 × 106 pulses per second, implying that multipath spreads up
to 500 ns could have been observed unambiguously. Multipath proﬁles with a duration of 300 ns were
measured. Sample results are shown in Figure 14.49. Multipath proﬁles were measured at various
locations in 14 rooms and hallways on one ﬂoor of the building presented in Figure 14.47. Each of
the rooms is labeled alphanumerically. Walls around ofﬁces are framed with metal studs and covered
with plasterboard. The wall around the laboratory is made from acoustically silenced heavy cement
block. There are steel core support pillars throughout the building, notably along the outside wall
and two within the laboratory itself. The shield room’s walls and door are metallic. The transmitter is
kept stationary in the central location of the building near a computer server in a laboratory denoted
by F. The transmit antenna is located 165 cm from the ﬂoor and 105 cm from the ceiling.

Table 14.26
Track measurement results: TR separations (TR) in m, time dispersion param-
eters (¯τ and στ) in ns, variations of time dispersion parameters (δ¯τ, ∆¯τ, δστ
and ∆στ) in ns and average received power (Prx) in dBm [77] c⃝2002, IEEE
Site
information
LOC #
TR
¯τ
στ
δ ¯τ
∆¯τ
δστ
∆στ
Prx
Comments
LOS, hallway
1.1
5
1.20
6.95
6.33
1.91
1.20
0.29
−13.7
Durham Hall
1.2
10
6.16
5.88
5.06
1.20
6.16
1.73
−20.3
1.3
20
32.61
47.25
32.89
8.43
32.61
9.02
−36.6
1.4
30
15.50
31.15
10.16
3.43
15.50
5.69
−31.2
open area
1.5
40
27.60
37.04
25.89
8.81
27.60
9.76
−40.5
1.6
50
46.42
28.17
36.70
8.10
46.42
10.73
−42.8
1.7
60
6.38
22.57
5.99
1.82
6.38
1.57
−41.5
LOS, hallway
2.1
5
2.22
6.24
7.52
2.38
2.22
0.73
−16.7
Whittemore
2.2
10
2.78
6.48
8.24
2.61
2.78
0.82
−24.4
intersection
2.3
20
2.3
4.56
7.81
2.55
2.30
0.55
−32.86
2.4
30
22.02
33.87
13.17
4.60
22.02
6.30
−34.7
LOS, room
2.5
40
77.3
45.07
105.04
34.41
77.30
25.86
−36.3
Durham Hall
3.1
4.2
0.74
4.85
6.20
1.88
0.74
0.20
−12.1
corner
3.2
3.3
0.92
4.95
5.97
1.87
0.92
0.23
−12.9
center
LOS, room
4.1
7.1
2.74
4.72
11.16
3.08
2.47
0.36
−29.7
corner
Whittemore
4.2
3.8
2.4
4.98
11.11
3.17
2.40
0.47
−24.2
center
4.3
5.2
12.88
31.10
26.36
6.86
12.88
2.95
−56.2
corner, ⊥to Tx
4.4
4.2
21.3
33.94
31.5
7.4
21.3
5.43
−57.9
corner, ⊥to Tx
Hallway to
5.1
2.4
0.83
5.50
2.41
0.69
0.83
0.32
−5.5
LOS
room
5.2
2.4
2.46
7.41
2.61
0.84
2.46
0.94
−14.3
through wall
5.3
2.4
0.71
5.36
1.30
0.41
0.71
0.25
−6.7
LOS
5.4
2.4
1.16
5.19
1.85
0.61
1.16
0.36
−9.1
through glass
Room to room
6.1
3
10.67
14.72
23.07
6.62
10.67
1.30
−12.8
LOS
6.2
3
14.82
21.78
34.30
8.57
14.82
3.37
−48.3
through wall
LOS, outdoor
8.1
2
7.63
24.59
10.24
2.66
7.63
1.75
−2.4
near Durham Hall
Table 14.27
Measured penetration losses and results from literature
Material
Penetration loss (dB)
Reference
Composite wall with studs not in the path
8.8
[1230]
Composite wall with studs in the path
35.5
[1230]
Glass door
2.5
[1230]
Concrete wall one week after concreting
73.6
[1233]
Concrete wall two weeks after concreting
68.4
[1233]
Concrete wall ﬁve weeks after concreting
46.5
[1233]
Concrete wall 14 months after concreting
28.1
[1233]
Plasterboard wall
5.4 to 8.1
[1234]
Partition of glass wool with plywood surfaces
9.2 to 10.1
[1234]
Partition of cloth-covered plywood
3.9 to 8.7
[1234]
Granite with width of 3 cm
>30
[1235]
Glass
1.7 to 4.5
[1235]
Metalized glass
>30
[1235]
Wooden panels
6.2 to 8.6
[1235]
Brick with width of 11 cm
17
[1235]
Limestone with width of 3 cm
>30
[1235]
Concrete
>30
[1235]

n = 2
n =1.88
σ = 8.6 dB
Loc1
Loc2
Loc3
Loc4
Loc5
Loc6, LOS
Loc6, NLOS
Loc8
100
101
102
Separation distance (m) 
40
50
60
70
80
90
100
110
Path loss (dB)
Scatter plot of the path loss for all locations
0
101
102
r 
Figure 14.46 Scatter plot of the measured path loss values.
Figure 14.47 The ﬂoor plan of a typical modern ofﬁce building where the propagation
measurement experiment was performed. The concentric circles are centered
on the transmit antenna and are spaced at 1 m intervals [91] c⃝2002, IEEE.

UWB CHANNEL MODEL
735
Figure 14.48 The transmitted pulse measured by the receiving antenna located 1 m away
from the transmitting antenna with the same height.
Figure 14.49 Average multipath measurements of 32 sequentially measured multipath pro-
ﬁles where the receiver is located at exactly the same locations in ofﬁces U
(upper trace), W (middle trace) and M (lower trace). The measurement grids
are 10, 8.5, and 13.5 m away from the transmitter, respectively [91] c⃝2002,
IEEE.
In each receiver location, impulse response measurements were made at 49 measurement points,
arranged in a ﬁxed-height, 7 × 7 square grid with 15 cm spacing, covering 90 cm × 90 cm. A total
of 741 different impulse responses were recorded. One side of the grid is always parallel to the north
wall of the room. The receiving antenna is located 120 cm from the ﬂoor and 150 cm from the ceiling.
Proﬁles measured in ofﬁces U, W and M are shown in Figure 14.49. The approximate distances
between the transmitter and the locations of these measurements are 10, 8.5 and 13.5 m, respectively.

736
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.28
Symbols and parameters [91] c⃝2002, IEEE
Delay axis
τ
Excess delay
τRef
Absolute propagation delay
τk = (k −1)τ
kth Delay Bin
τ = 2 ns
Bin width
Nbins
Number of bins
Energy gains
¯Gtot
Total average energy gain
¯Gk
Average energy gain of the kth delay bin
Gk
Energy gain of the kth delay bin
¯g(τ)
Average received energy at excess delay τ
Exponential time decay
ε
Decay constant
r = G2/G1
Power ratio
Figure 14.49 also shows that the response to the ﬁrst probing pulse has decayed almost completely in
roughly 200 ns, and has disappeared before the response to the next pulse arrives at the antenna. The
multipath proﬁles recorded in the ofﬁces W and M have a substantially lower noise ﬂoor than those
recorded in ofﬁce U. This can be explained, with the help of Figure 14.47, by observing that ofﬁce U
is situated at the edge of the building with a large glass window, and is subject to more external inter-
ference (e.g. from radio stations, television stations, cellular and paging towers), while ofﬁces W and
M are situated roughly in the middle of the building. In general, an increased noise ﬂoor was observed
for all the measurements made in ofﬁces located at the edges of the building with large glass windows.
The large-scale fading characterizes the changes in the received signal when the receiver position
varies over a signiﬁcant fraction of the transmitter–receiver (T–R) distance and/or the environment
around the receiver changes. This situation typically occurs when the receiver is moved from one
room to another room in a building. The small-scale effects, on the other hand, are manifested in the
changes of the PDP caused by small changes of the receiver position, while the environment around
the receiver does not change signiﬁcantly. This occurs, for instance, when the receiver is moved over
the measurement grid within a room in a building.
In the following, we refer to the PDP measured at one of the 14(rooms) × 49 locations as local
PDP, while we denote the PDP averaged over the 49 locations within one room as the small-scale
averaged PDP (SSA-PDP). This spatial averaging (mostly) removes the effect of small-scale fading.
The small-scale statistics are derived by considering the deviations of the 49 local PDPs from the
respective SSA-PDP. The large-scale fading may be investigated by considering the variation of the
SSA-PDPs over the different rooms. We also make a distinction between the ‘local’ parameters,
which refer to the small-scale effects, and the ‘global’ parameters, extracted from the SSA-PDPs. For
clarity, all the symbols and parameters are listed in Table 14.28.
14.9.1
The large-scale statistics
All SSA-PDPs exhibit an exponential decay as a function of the excess delay. Since we perform a
delay axis translation, the direct path always falls in the ﬁrst bin in all the PDPs. It also turns out
that the direct path is always the strongest path in the 14 SSA-PDPs, even if the LOS is obstructed.
The energy of the subsequent MPCs decays exponentially with delay starting from the second bin.
This is illustrated by the ﬁt (linearly on a decibel scale) in Figure 14.50 using the SSA-PDP of
a typical high signal to noise ratio (SNR) room. Let Gk ˆ=ASpa{Gk} be the locally averaged energy
gain, where the ASpa{·} denotes the spatial average over the 49 locations of the measurement grid.
The average energy of the second MPC may be expressed as a fraction r of the average energy of the

UWB CHANNEL MODEL
737
Figure 14.50 The average power delay proﬁle versus the excess delay in a semi-logarithmic
scale for a typical high SNR room. The wavy line is the measured proﬁle, the
straight line is the exponential decay obtained by a best ﬁt procedure.
Figure 14.51 Histograms of (a) the experimental decay constants ε and (b) the theoretically
ﬁtted distribution. The decay constants are expressed in logarithmic units by
referring to nanoseconds.
direct path, i.e. r = ¯G2/ ¯G1. We refer to r as the power ratio. As we will show later, the SSA-PDP is
completely characterized by ¯G1, the power ratio r, and the decay constant ε (or equivalently, by the
total average received energy ¯Gtot, r, and ε). The number of resolved MPCs is given by the number
of the MPCs that exceed a threshold and thus, given the threshold, it depends on the shape of the
SSA-PDP, characterized by the parameters ¯G1, r, and ε. Best ﬁt procedures are used to extract the εs
and the rs from the SSA-PDP of each room.
The power ratio r and the decay constant ε vary from location to location, and should be treated
as stochastic variables. As only 14 values for ε and r were available, it was not possible to extract the
shape of their distribution from the measurement data. Instead, a model was assumed a priori and
the parameters of this distribution were ﬁtted. Previous narrowband studies showed that the decay
constants are well modeled as log-normal variables [6]. It was found that the log-normal distribution,
denoted by ε ∼LN (µεdB; σεdB), with µεdB = 16.1 and σεdB = 1.27 gives the best agreement with the
empirical distribution. The histograms of the experimental decay constants and the theoretically ﬁtted
distribution are shown in Figure 14.51. Applying the same procedure to characterize the power ratiosr,

738
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Figure 14.52 Scatter plot of the decay constants ε versus the T–R distance. The solid line
is the regression ﬁt whose slope is −0.22 ns/m.
Figure 14.53 Scatter plot of the large-scale attenuation versus the logarithm of the dis-
tance. The solid line represents the best ﬁt with the path loss model of
Equation (14.77).
it was found that they are also log-normally distributed, i.e. r ∼LN (µrdB; σrdB), with µrdB = −4 and
σrdB = 3, respectively.
The possible correlation of the decay constant with the T–R separation was also investigated, by
applying a linear regression to the εs versus the distance. As Figure 14.52 shows, the regression ﬁt of
the decay constants ε decreases with the increasing distance so slightly that we can conclude that it
is de facto independent.
By integrating the SSA-PDP of each room over all delay bins, the total average energy ¯Gtot within
each room is obtained. Then its dependence on the T–R separation is analyzed. As suggested by the
scatter plot of Figure 14.53, a breakpoint model, commonly referred to as a dual slope model, can be
adopted for path loss PL as a function of the distance. The regression lines are shown in Figure 14.53

UWB CHANNEL MODEL
739
and the parameters extracted by performing a best ﬁt of the empirical attenuation are
PL =

20.4 log10(d/d0),
d ≤11 m
−56 + 74 log10(d/d0),
d > 11 m
(14.77)
where PL is expressed in decibels, d0 = 1 m is the reference distance, and d is the T–R separation dis-
tance in meters. Because of the shadowing phenomenon, the ¯Gtot varies statistically around the value
given by Equation (14.77). A common model for shadowing is the log-normal distribution [92, 93].
By assuming such a model, it was found that ¯Gtot is log-normally distributed about Equation (14.77)
with a standard deviation of the associated normal random variable equal to 4.3.
14.9.2
The small-scale statistics
The differences between the PDPs at the different points of the measurement grid are caused by
small-scale fading. In ‘narrowband’ models, it is usually assumed that the magnitude of the ﬁrst
(quasi-LOS) multipath component follows Rician or Nakagami statistics and the later components
are assumed to have Rayleigh statistics [94]. However, in UWB propagation, each resolved MPC is
due to a small number of scatterers, and the amplitude distribution in each delay bin differs markedly
from the Rayleigh distribution. In fact, the presented analysis showed that the best ﬁt distribution of
the small-scale magnitude statistics is the Nakagami distribution [95], corresponding to a Gamma
distribution of the energy gains. This distribution has been used to model the magnitude statistics in
mobile radio when the conditions of the central limit theorem are not fulﬁlled [96].
The small-scale statistics are characterized by ﬁtting the received normalized energies {G(i)
k }
in each bin at the 49 locations of the measurement grid to a distribution. The variations over the
measurement grid are treated as stochastic. The result shows that the statistics of the energy gain
vary with delays. Let us denote by (Ω; m) the Gamma distribution with parameters Ωand m. The
(Ω; m) gives a good ﬁt of the empirical distribution of the energy gains. The accuracy of the ﬁt
has been quantiﬁed in terms of the relative mean squared error, which varies between 0.0105 (for the
highest SNR) to 0.1137 (for the lowest SNR). A comparison between experimental and theoretical
histograms for one exemplary bin in a typical high SNR is shown in Figure 14.54.
0
0.01
0.02
0
0.01
0.02
Energy
Energy
m – Nakagami = 3.1
0
10
20
30
0
10
20
30
Occurrences (%)
Experimental histogram
Theoretical histogram
.0
.0
m
)
Figure 14.54 Histogram of the received energy in the 34th bin of a typical high SNR room,
compared with the theoretical Gamma distribution, whose mean Ω34 and m34
were extracted from the experimental PDF. The energies on the horizontal
axes are expressed in arbitrary units [91] c⃝2002, IEEE.

740
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Figure 14.55 Scatter plot of the m-Nakagami of the best ﬁt distribution versus excess delay
for all the bins except the LOS components. Different markers correspond to
measurements in different rooms [91] c⃝2002, IEEE.
The parameters of the Gamma distribution vary from bin to bin: (Ω; m) denotes the Gamma
distribution that ﬁts the energy gains of the local PDPs in the kth bin within each room. The Ωk
are given as Ωk = ¯Gk, i.e. the magnitude of the SSA-PDP in the kth bin. The mk are related to the
variance of the energy gain of the kth bin. Figure 14.55 shows the scatter plot of the mk, as a function
of excess delay for all the bins (except the LOS components). It can be seen from Figure 14.55
that the mk values range between 1 and 6 (rarely 0.5), decreasing with the increasing excess delay.
This implies that MPCs arriving with large excess delays are more diffused than the ﬁrst arriving
components, which agrees with intuition.
The mk parameters of the Gamma distributions themselves are random variables distributed
according to a truncated Gaussian distribution, denoted by m ∼TN (µm; σ 2
m), i.e. their distribution
looks like a Gaussian for m ≥0.5 and zero elsewhere
fm(x) =

Kme−((x−µm)2/2σ 2m,
if x ≥0.5
0,
otherwise
(14.78)
where the normalization constant Km is chosen so that the integral over the fm(x) is unity. Figure 14.56
shows the mean and variance of such Gaussian distributions that ﬁt the mk as a function of the excess
delay, along with the respective regression lines. The regression lines are given by
µm(τk) = 3.5 −τk
73
(14.79)
σ 2
m(τk) = 1.84 −τk
160
(14.80)
where τk is in nanoseconds.

UWB CHANNEL MODEL
741
Figure 14.56 Scatter plot of the mean values (dots) and the variance (circles) of the Gaussian
distributions that ﬁt the experimental distribution of m values at each excess
delay. The solid lines represent the linear regression for these parameters,
respectively [91] c⃝2002, IEEE.
14.9.3
Correlation of MPCs among different delay bins
We next evaluate the correlation between the energy gain of the MPCs arriving in the same room at
different excess delays as
ρk,k+m =
ASpa{(Gk −Gk)(Gk+m −Gk+m)}

ASpa{(Gk −Gk)2}ASpa{(Gk+m −Gk+m)2}
(14.81)
The analysis shows that the correlation coefﬁcients remain below 0.2 for almost all rooms and delay
bins and are, thus, negligible for all practical purposes.
14.9.4
The statistical model
The received signal is a sum of the replicas (echoes) of the transmitted signal, being related to the
reﬂecting, scattering and/or deﬂecting objects via which the signal propagates. Each of the echoes is
related to a single such object. In a narrowband system, the echoes at the receiver are only attenuated,
phase-shifted and delayed, but undistorted, so that the received signal may be modeled as a linear
combination of Npath delayed basic waveforms w(t)
r(t) =
Npath

i=1
ciw(t −τi) + n(t)
(14.82)
where n(t) is the observation noise. In UWB systems, the frequency selectivity of the reﬂection,
scattering and/or diffraction coefﬁcients of the objects via which the signal propagates, can lead to a
distortion of the transmitted pulses. Furthermore, the distortion and, thus, the shape of the arriving

742
CHANNEL MODELING AND MEASUREMENTS FOR 4G
echoes, varies from echo to echo. The received signal is given as
r(t) =
Npath

i=1
ci ˜wi(t −τi) + n(t)
(14.83)
If the pulse distortion was greater than the width of the delay bins (2 ns), one would observe a
signiﬁcant correlation between adjacent bins. The fact that the correlation coefﬁcient remains very
low for all analyzed sets of the data implies that the distortion of a pulse due to a single echo is not
signiﬁcant, so that in the following, Equation (14.82) can be used. The SSA-PDP of the channel may
be expressed as
¯g(τ) =
Nbins

k=1
¯Gkδ(τ −tk)
(14.84)
where the function ¯g(τ) can be interpreted as the average energy received at a certain receiver position
and a delay τ, normalized to the total energy received at one meter distance, and Nbins is the total
number of bins in the observation window. Assuming an exponential decay starting from the second
bin, we have
¯g(τ) = ¯G1δ(τ −τ1) +
Nbins

k=2
¯G2 exp [−(τk −τ2)/ε]δ(τ −tk)
(14.85)
where ε is the decay constant of the SSA-PDP. The total average energy received over the observation
interval T is:
¯Gtot =
 T
0
¯g(τ) dτ = ¯G1 +
Nbins

k=2
¯G2 exp [−(τk −τ2)/ε]
(14.86)
Summing the geometric series, gives
¯Gtot = ¯G1[1 + r F(ε)]
(14.87)
where r = ¯G2/ ¯G1 is the power ratio, and
F(ε) = 1 −exp [−(Nbins −1)τ/ε]
1 −exp (−τ/ε)
≈
1
1 −exp (−τ/ε)
(14.88)
The total normalized average energy is log-normally distributed, due to the shadowing, around the
mean value given from the path loss model in Equation (14.77):
¯Gtot ∼LN (−PL; 4.3)
(14.89)
From Equation (14.87), we have, for the average energy gains,
¯Gk =



¯Gtot
1 + r F(ε),
for k = 1
¯Gtot
1 + r F(ε)re−(τk−τ2)/ε,
for k = 2, . . . , Nbins
(14.90)
and Equation (14.84) becomes
¯g(τ) =
¯Gtot
1 + r F(ε)

δ(τ −τ1) +
Nbins

k=2

re−(τk−τ2)/ε)
δ(τ −tk)

(14.91)
14.9.5
Simulation steps
In the model, the local PDF is fully characterized by the pairs {Gk, τk}, where τk = (k −1)τ, with
τ = 2 ns. The Gk are generated by a superposition of large- and small-scale statistics.

UWB CHANNEL MODEL
743
Figure 14.57 The ﬂowchart of the simulation procedure.
The process starts by generating the total mean energy Gtot at a certain distance according to
Expression (14.89). Next, the decay constant ε and the power ratio r are generated as log-normal
distributed random numbers
ε ∼LN (16.1; 1.27)
(14.92)
r ∼LN (−4; 3)
(14.93)

744
CHANNEL MODELING AND MEASUREMENTS FOR 4G
Table 14.29
Statistical models and parameters
Global parameters ⇒¯Gtot and ¯Gk
Path loss
PL =
20.4 log10(d/d0),
d ≤11 m
−56 + 74 log10(d/d0),
d > 11 m
Shadowing
¯Gtot ∼LN (−PL; 4.3)
Decay constant
ε ∼LN (16.1; 1.27)
Power ratio
r ∼LN (−4; 3)
Local parameters ⇒Gk
Energy gains
Gk ∼( ¯Gk; mk)
m values
mk ∼TN

µm(τk); σ 2
m(τk)

µm(τk) = 3.5 −τk
73
σ 2
m(τk) = 1.84 −τk
160
Figure 14.58 The measured 49 local PDPs for an exemplary room [91] c⃝2002, IEEE.
The width of the observation window is set to be T = 5ε. Thus, the SSA-PDP is completely speciﬁed
according to Equation (14.91). Finally, the local PDPs are generated by computing the normalized
energy gains G(i)
k of every bin k and every location i as Gamma distributed independent variables.
The Gamma distributions have averages given by Equation (14.90), and the mks are generated as
independent truncated Gaussian random variables
mk ∼TN

µm(τk); σ 2
m(τk)

(14.94)
with µm(τk) and σ 2
m(τk) given by Equations (14.79) and (14.80). These steps are summarized in
Figure 14.57 and Table 14.29.
Some results are shown in Figures 14.58–60.

REFERENCES
745
Figure 14.59 Simulated 49 local PDPs for an exemplary room [91] c⃝2002, IEEE.
Figure 14.60 Comparison between the measured and simulated CDF of the signal quality
received in an exemplary room. The circles represent the experimental data,
and the dots represent the simulation results.
REFERENCES
1. Algans, A., Pedersen, K. I. and Mogensen, P. E. (2002) Experimental analysis of the joint
statistical properties of azimuth spread, delay spread, and shadow fading, IEEE Journal on
Selected Areas in Communications, 20.
2. Pedersen, K. I., Mogensen, P. E. and Fleury, B. H. (2000) A stochastic model of the temporal
and azimuthal dispersion seen at the base station in outdoor propagation environments, IEEE
Transactions on Vehicular Technology, 49, 437–447.

746
CHANNEL MODELING AND MEASUREMENTS FOR 4G
3. Frederiksen, F., Mogensen, P., Pedersen, K. I. and Leth-Espensen, P. (1998) A software testbed for
performance evaluation of adaptive antennas in FH GSM and wideband-CDMA, in Proceedings
of the 3rd ACTS Mobile Communication Summit, Rhodes, Greece, June 1998, 2, 430–435.
4. Cox, D. C., Murray, R. and Norris, A. (1994) 800 MHz attenuation measured in and around
sub-urban houses, AT&T Bell Labs Technical Journal, 673.
5. Bernhardt, R. C. (1987) Macroscopic diversity in frequency reuse systems, IEEE Journal on
Selected Areas in Communications, 5, 862–878.
6. Hata, M. (1980) Empirical formula for propagation loss in land mobile radio service, IEEE
Transactions on Vehicular Technology, VT-29, 317–325 (1997).
7. Bertoni, H. L. (2000) Radio Propagation for Modern Wireless Systems. Prentice Hall, Englewood
Cliffs, NJ.
8. Martin, U. (1997) A directional radio channel model for densely built-up urban areas, in Proceed-
ings of the European Personal Mobile Communications Conference (EPMCC), Bonn, Germany,
October 1997, pp. 237–244.
9. Correia, L. (2001) Wireless Flexible Personalised Communications–Cost 259 Final Report. John
Wiley & Sons, Inc., New York 2001.
10. Winters, J. (1984) Optimum combining in digital mobile radio with cochannel interference, IEEE
Transactions on Vehicular Technology, VT-33.
11. Pedersen, K. I., Mogensen, P. E. and Fleury, B. H. (1998) Spatial channel characteristics in
outdoor environments and their impact on BS antenna system performance, in Proceedings of
the IEEE Vehicular Technology Conference (VTC’98), Ottawa, Canada, May 1998, pp. 719–
724.
12. Pedersen, K. I. and Mogensen, K. I. (1999) Evaluation of vector-RAKE receivers using dif-
ferent antenna array conﬁgurations and combining schemes, International Journal of Wireless
Information Networks, 6, 181–194.
13. Veen, V. and Buckley, K. M. (1988) Beamforming: A versatile approach to spatial ﬁltering, IEEE
Acoustics, Speech and Signal Processing (ASSP) Magazine, pp. 4–24.
14. Liberti, J. and Rappaport, T. (1996) A geometrically based model for line-of-sight multipath
radio channels, in Proceedings of the IEEE Vehicular Technology Conference (VTC 96), May
1996, pp. 844–848.
15. Lu, M., Lo, T. and Litva, J. (1997) A physical spatio-temporal model of multipath propagation
channels, in Proceedings of the IEEE Vehicular Technology Conference (VTC 97), May 1997,
pp. 810–814.
16. Nørklit, O. and Andersen, J. B. (1998) Diffuse channel model and experimential results for
antenna arrays in mobile environments, IEEE Transactions on Antenna Propagation, 96, 834–
840.
17. Cheon, C., Bertoni H. L. and Liang, G. (2000) Monte Carlo simulation of delay and angle spread
in different building environments, presented at the IEEE Vehicular Technology Conference (VTC
’00), Boston, MA.
18. Gudmundson, M. (1992) Correlation model for shadow fading in mobile radio systems, IEEE
Electronics Letters, 27, 2126–2145.
19. Mawira, A. (1992) Models for the spatial correlation functions of the log-normal component of
the variability of VHF/UHF ﬁeld strength in urban environments, in Proceedings of Personal,
Indoor and Mobile Radio Communications (PIMRC’92), pp. 436–440.

REFERENCES
747
20. Gehring, A., Steinbauer, M., Gaspard, I. and Grigat, M. (2001) Empirical channel stationarity
in urban environments, presented at the European Personal Mobile Communications Conference
(EPMCC), Vienna, February 2001.
21. Sørensen, T. B. (1998) Correlation model for shadow fading in a small urban macro cell,
presented at the Personal, Indoor and Mobile Radio Communications Conference (PIMRC ’98),
Boston.
22. Algorithms and Antenna Array Recommendations, Public deliverable from European ACTS,
TSUNAMI II Project, Deliverable code: AC020/AUC/A1.2/DR/P/005/bl, May 1997.
23. Information Technologies and Sciences–Digital Land Mobile Radio Communications, Commis-
sion of the European Communities, COST 207, 1998.
24. Bello, P. A. (1963) Characterization of randomly time-variant linear channels, IEEE Transactions
On Communications Systems, CS-11, 360–393.
25. Fessler, J. A. and Hero, A. (1994) Space-alternating generalised expectation-maximization algo-
rithm, IEEE Transactions on Signal Processing, 42, 2664–2677.
26. Fleury, B. H., Tschudin, M., Heddergott, R., Dahlhaus, D. and Pedersen, K. I. (1999) Channel
parameter estimation in mobile radio environments using the SAGE algorithm, IEEE Journal on
Selected Areas in Communications, 17, 434–450.
27. Pedersen, K. I., Fleury, B. H. and Mogensen, P. E. (1997) High resolution of electromagnetic
waves in time-varying radio channels, in Proceedings of the International Symposium on Personal,
Indoor and Mobile Radio Communications (PIMRC ’97), Helsinki, Finland, September 1997,
pp. 650–654.
28. Pedersen, K. I., Mogensen, P. E., Fleury, B. H., Frederiksen, F. and Olesen, K. (1997) Analysis
of time, azimuth and Doppler dispersion in outdoor radio channels, in Proceedings of the ACTS
Mobile Communication Summit ’97, Aalborg, Denmark, October 1997, pp. 308–313.
29. Greenstein, L. J., Erceg, V., Yeh, Y. S. and Clark, M. V. (1997) A new path-gain/delay-spread
propagation model for digital cellular channels, IEEE Transactions on Vehicular Technology, 46,
477–485.
30. Toeltsch, M., Laurila, J., Kalliola, K., Molisch, A. F., Vainikainen, P. and Bonek, E. (2002)
Statistical characterization of urban spatial radio channels, IEEE Journal On Selected Areas In
Communications, 20(3), 539–549.
31. Roy, R., Paulraj, A. and Kailath, T. (1986) ESPRIT–A subspace rotation approach to estimation
of parameters of cisoids in noise, IEEE Transactions on Acoustics, Speech Signal Processing,
32, 1340–1342.
32. Zoltowski, M., Haardt, M. and Mathews, C. (1994) Closed-form 2-D angle estimation with
rectangular arrays in element space or beamspace via unitary ESPRIT, IEEE Transactions on
Signal Processing, 44, 316–328.
33. Haardt, M. and Nossek, J. (1995) Unitary ESPRIT: How to obtain an increased estimation
accuracy with a reduced computational burden, IEEE Transactions on Signal Processing, 43,
1232–1242.
34. Swales, S. C., Beach, M., Edwards, D. and McGeehan, J. P. (1990) The performance enhance-
ment of multibeam adaptive base-station antennas for cellular land mobile ratio systems, IEEE
Transactions on Vehicular Technology, 39, 56–67.
35. Ertel, R. B., Cardieri, P., Sowerby, K. W., Rappaport, T. S. and Reed, J. H. (1998) Overview of spa-
tial channel models for antenna array communications systems, IEEE Personal Communications,
5(1), 10–22.

748
CHANNEL MODELING AND MEASUREMENTS FOR 4G
36. Martin, U., Fuhl, J., Gaspard, I., Haardt, M., Kuchar, A., Math, C., Molisch, A. F. and Thom¨a,
R. (1999) Model scenarios for direction-selective adaptive antennas in cellular mobile commu-
nication systems–Scanning the literature, Wireless Personal Communications Magzine, (Special
Issue on Space Division Multiple Access), 11(1), 109–129.
37. Pedersen, K., Mogensen, P. and Fleury, B. (2000) A stochastic model of the temporal and
azimuthal dispersion seen at the base station in outdoor propagation environments, IEEE Trans-
actions on Vehicular Technology, 49(2), 437–447.
38. Fuhl, J., Rossi, J.-P. and Bonek, E. (1997) High resolution 3-D direction-of-arrival determination
for urban mobile radio, IEEE Transactions on Antenna Propagation, 4, 672–682.
39. Kuchar, A., Rossi, J.-P. and Bonek, E. (2000) Directional macro-cell channel characterization
from urban measurements, IEEE Transactions on Antenna Propagation, 48, 137–146.
40. Kalliola, K., Laitinen, H., Vaskelainen, L. and Vainikainen, P. (2000) Real-time 3D spatial-
temporal dual-polarized measurement of wideband radio channel at mobile station, IEEE Trans-
actions on Instrumentation and Measurment, 49, 439–448.
41. Kivinen, J., Korhonen, T., Aikio, P., Gruber, R., Vainikainen, P. and H¨aggman, S.-G. (1999)
Wideband radio channel measurement system at 2 GHz, IEEE Transactions on Instrumentation
and Measurment, 48, 39–44.
42. Kermoal, J. P., Schumacher, L., Pedersen, K. I., Mogensen, P. E. and Frederiksen, F. (2002) A
Stochastic MIMO radio channel model with experimental validation, IEEE Journal on Selected
Areas in Communications, 20, 1211–1226.
43. Yu, K., Bengtsson, M., Ottersten, B., McNamara, D., Karlsson, P. and Beach, M. (2001) Second
order statistics of NLOS indoor MIMO channels based on 5.2 GHz measurements, in Proceedings
of GLOBECOM’01, San Antonio, Texas, USA, November 2001, pp. 156–160.
44. Golub, G. H. and Van Loan, C. F. (1996) Matrix Computations, 3rd edition, The Johns Hopkins
University Press, Baltimore, MD.
45. Petrus, P., Reed, J. H. and Rappaport, T. S. (1997) Effects of directional antennas at the base
station on the Doppler spectrum, IEEE Communications Letters, 1, 40–42.
46. Frederiksen, F., Mogensen, P., Pedersen, K. I. and Leth-Espensen, P. (1998) A Software testbed for
performance evaluation of adaptive antennas in FH GSM and wideband-CDMA, in Proceedings
of the 3rd ACTS Mobile Communication Summit, Rhodes, Greece, June 1998, 2, 430–435.
47. Andersen, J. B. (2000) Array gain and capacity for known random channels with multiple element
arrays at both ends, IEEE Journal on Selected Areas in Communications, 18, 2172–2178.
48. Zhao, X., Kivinen, J., Vainikainen, P. and Skog, K. (2002) Propagation characteristics for wide-
band outdoor mobile communications at 5.3 GHz, IEEE Journal on Selected Areas in Commu-
nications, 20, 507–514.
49. Lee, W. C. Y. (1985) Estimate of local average power of a mobile radio signal, IEEE Transactions
on Vehicular Technology, 34, 22–27.
50. Green, E. (1990) Radio link design for micro-cellular systems, British Telecom Technology
Journal, 8, 85–96.
51. Dersch, U. and Zollinger, E. (1994) Physical characteristics of urban micro-cellular propagation,
IEEE Transactions on Antenna Propagation, 42, 1528–1539.
52. Kivinen, J., Zhao, X. and Vainikainen, P. (2001) Empirical characterization of wideband indoor
radio channel at 5.3 GHz, IEEE Transactions on Antenna Propagation, 49, 1192–1203.
53. Karasawa, Y. and Ivai, H. (2000) Formulation of spatial correlation statistic in Nakagami–Rice
fading environments, IEEE Transactions on Antenna Propagation, 48, 12–18.

REFERENCES
749
54. Suzuki, H. (1977) A statistical model for urban radio propagation, IEEE Transactions On Com-
munications, 25, 673–680.
55. Takada, J., Jiye Fu, Houtao Zhu and Kobayashi, T. (2002) Spatio-temporal channel characteriza-
tion in a suburban non line-of-sight microcellular environment, IEEE Journal On Selected Areas
In Communications, 20(3), 532–538.
56. Masui, H., Takahashi, K., Takahashi, S., Kage, K. and Kobayashi, T. (1999) Delay proﬁle
measurement system for microwave broadband transmission and analysis of delay characteristics
in an urban environment, IEICE Transactions on Electronics, E82-C, 1287–1292.
57. Molisch, A. F., Steinbauer, M., Toeltsch, M., Bonek, E. and Thom¨a, R. S. (2002) Capacity
of MIMO systems based on measured wireless channels, IEEE Journal on Selected Areas in
Communications, 20, 561–569.
58. Parks-Gornet, J. and Imam, I. N. (1989) Using rank factorization in calculating the Moore–
Penrose generalized inverse, IEEE Southeastcon ’89, Energy and Information Technologies in
the Southeast, 9–12 April 1989, 2, 427–431.
59. Tokarzewski, J. (1998) System zeros analysis via the Moore–Penrose pseudoinverse and SVD of
the ﬁrst nonzero Markov parameter, IEEE Transactions on Automatic Control, 43(9), 1285–1291.
60. Withers, L. P., Jr. (1993) A parallel algorithm for generalized inverses of matrices, with applica-
tions to optimum beamforming, IEEE International Conference on Acoustics, Speech and Signal
Processing (ICASSP-93), 27–30 April 1993, 1, 369–372.
61. Shu Wang and Xilang Zhou (1999) Extending ESPRIT algorithm by using virtual array and
Moore–Penrose general inverse techniques, IEEE Southeastcon ’99, 25–28 March 1999, pp.
315–318.
62. Steinbauer, M., Molisch, A. F. and Bonek, E. (2001) The double-directional radio channel, IEEE
Antennas and Propagation Magazine, pp. 51–63.
63. Rubio, M. L., Garcia-Armada, A., Torres, R. P. and Garcia, J. L. (2002) Channel modeling and
characterization at 17 GHz for indoor broadband WLAN, IEEE Journal on Selected Areas in
Communications, 20.
64. Hashemi, H. (1993) The indoor radio propagation channel, Proceedings of the IEEE, 81(7),
943–968.
65. Bury, K. (1999) Statistical Distributions in Engineering, Cambridge University Press, Cambridge
UK.
66. Torres, R. P., Valle, L., Domingo, M., Loredo, S. and Diez, M. C. (1999) CIN-DOOR: An
engineering tool for planning and design of wireless systems in enclosed spaces, IEEE Antennas
and Propagation Magazine, 41, 11–22.
67. Loredo, S., Torres, R. P., Domingo, M., Valle, L. and P´erez, J. R. (2000) Measurements and pre-
dictions of the local mean power and small-scale fading statistics in indoor wireless environments,
Microvave Optical Technology Letters, 24, 329–331.
68. Torres, R. R., Loredo, S., Valle, L. and Domingo, M. (2001) An accurate and efﬁcient method
based on ray-tracing for the prediction of local ﬂat-fading statistic in picocell radio channels,
IEEE Journal on Selected Areas in Communications, 18, 170–178.
69. Loredo, S., Valle, L. and Torres, R. P. (2001) Accuracy analysis of GO/UTD radio channel
modeling in indoor scenarios at 1.8 and 2.5 GHz, IEEE Antennas and Propagation Magazine,
43.
70. Bohdanowicz, A. (2000) Wide band indoor and outdoor radio channel measurements at 17 GHz,
Ubicom Technical Report/2000/2.

750
CHANNEL MODELING AND MEASUREMENTS FOR 4G
71. Bohdanowicz, A., Janssen, G. J. M. and Pietrzyk, S. (1999) WideBand indoor and outdoor
multipath channel measurements at l7 GHz, in Proceedings of the IEEE Vehicular Technology
Conference, 4, 1998–2003.
72. Talbi, L. and Delisle, G. Y. (1996) Experimental characterization of EHF multipath indoor radio
channels, IEEE Journal on Selected Areas in Communications, 14, 431–439.
73. Rappaport, T. S. and McGillem, C. D. (1988) UHF fading in factories, IEEE Journal on Selected
Areas in Communications, 7, 40–48.
74. Rappaport, T. S. (1989) Indoor radio communications for factories of the future, IEEE Commu-
nications Magazine, pp. 15–24.
75. Abou-Raddy, A. F. and Elnoubi, S. M. (1997) Propagation measurements and channel modeling
for indoor mobile radio at 10 GHz, in Proceedings of the IEEE Vehicular Technology Conference,
3, 1395–1399.
76. Saleh, A. A. M. and Valenzuela, R. A. (1987) A statistical model for indoor multipath propagation,
IEEE Journal on Selected Areas in Communications, SAC-5.
77. Hao Xu, Kukshya, V. and Rappaport, T. S. (2002) Spatial and temporal characteristics of 60 GHz
indoor channels, IEEE Journal On Selected Areas In Communications, 20(3), 620–630.
78. Rappaport, T. S. (1996) Wireless Communications: Principles and Practice. Prentice Hall, En-
glewood Cliffs, NJ.
79. Durgin, G. and Rappaport, T. S. (2000) Theory of multipath shape factors for small-scale fading
wireless channels, IEEE Transactions on Antenna Propagation, 48, 682–693.
80. Manabe, T., Miura, Y. and Ihara, T. (1996) Effects of antenna directivity and polarization on
indoor multipath propagation characteristics at 60 GHz, IEEE Journal on Selected Areas in
Communications, 14, 441–448.
81. Sato, K., Manabe, T., Ihara, T., Saito, H., Ito, S., Tanaka, T., Sugai, K., Ohmi, N., Murakami, Y.,
Shibayama, M., Konishi, Y. and Kimura, T. (1999) Measurements of reﬂection and transmission
characteristics of interior structures of ofﬁce building in the 60 GHz band, IEEE Transactions on
Antenna Propagation, 45, 1783–1792.
82. Langen, B., Lober, G. and Herzig, W. (1994) Reﬂection and transmission behavior of building
materials at 60 GHz, in Proceedings of IEEE PIMRC ’94, The Hague, The Netherlands, September
1994, pp. 505–509.
83. Rossi, J. P., Barbot, J. P. and Levy, A. J. (1997) Theory and measurement of the angle of arrival
and time delay of UHF radiowave using a ring array, IEEE Transactions on Antenna Propagation,
45, 876–884.
84. de Jong, Y. L. C. and Herben, M. H. A. J. (1999) High-resolution angle-of-arrival measurement
of the mobile radio channel, IEEE Transactions on Antenna Propagation, 47, 1677–1687.
85. Droste, H. and Kadel, G. (1995) Measurement and analysis of wideband indoor propagation
characteristics at 17 GHz and 60 GHz, in Proceedings of IEE Antennas Propagation Conference
(Publication 407), April 1995, pp. 288–291.
86. Holloway, C. L., Perini, P. L., Delyzer, R. R. and Allen, K. C. (1997) Analysis of composite
walls and their effects on short-path propagation modeling, IEEE Transactions on Vehicular
Technology, 46,730–738.
87. Honcharenko, W. and Bertoni, H. (1994) Transmission and reﬂection characteristics at con-
crete block walls in the UHF bands proposed for future PCS, IEEE Transactions on Antenna
Propagation, 42, 232–239.

REFERENCES
751
88. Smulders, P. and Correia, L. (1997) Characterization of propagation in 60 GHz radio channels,
Electronics Communications and Engineering Journal, 9(2) 73–80.
89. Xu, H., Rappaport, T. S., Boyle, R. J. and Schaffner, J. (2000) Measurements and modeling
for 38-GHz point-to-multipoint radiowave propagation, IEEE Journal on Selected Areas in
Communications, 18, 310–321.
90. Xu, H., Kukshya, V. and Rappaport, T. (2000) Spatial and temporal characterization of 60 GHz
channels, in Proceedings of the IEEE VTC’2000, Boston, MA, September 24–28, 2000.
91. Cassioli, D., Win, M. Z., Molisch, A. F. (2002) The ultra-wide bandwidth indoor channel: from
statistical model to simulations, IEEE Journal On Selected Areas In Communications, 20(6),
1247–1257.
92. Greenstein, L. J., Erceg, V., Yeh, Y. S. and Clark, M. V. (1997) A new path-gain/delay-spread
propagation model for digital cellular channels, IEEE Transactions on Vehicular Technology, 46,
477–485.
93. Erceg, V., Greenstein, L. J., Tjandra, S. Y., Parkoff, S. R., Gupta, A., Kulic, B., Julius, A. A.
and Bianchi, R. (1999) An empirically based path loss model for wireless channels in suburban
environments, IEEE Journal on Selected Areas in Communications, 17, 1205–1211.
94. Failli, E. (Ed.), (1989), Digital Land Mobile Radio. Final Report of COST 207. Commission of
the European Union, Luxemburg.
95. Nakagami, M. (1960) The m-distribution – A general formula of intensity distribution of rapid
fading, in Statistical Method in Radio Wave Propagation, W. C. Hoffman (Ed.), Pergamon,
Oxford, UK, pp. 3–36.
96. Braun, W. R. and Dersch, U. (1991) A physical mobile radio channel model, IEEE Transactions
on Vehicular Technology, 40, 472–482.


15
Adaptive 4G Networks
15.1
ADAPTIVE MAC LAYER
In this section we discuss a centralized quasi-asynchronous DS-CDMA packet radio network (PRN)
with adaptive bit rate and optimal packet size in low mobility environments. The channel load sensing
protocol (CLSP) is used to control the packet access on the uplink so that contention is avoided and
throughput is maximized. Due to the high uncertainty of radio channels and imperfect power control
(PC), the performance of CLSP/DS-CDMA may suffer from notable degradations. The PC problem
is essential to the capacity and coverage of interference-limited DS-CDMA systems, in particular on
the uplink. It often requires a fast closed loop PC along with an open loop PC for initial power setting.
In a PRN, the closed loop PC appears to be impractical due to the connectionless nature of datagram
transmissions. So, the near–far effect represents a major factor affecting the design and performance
of PC. This section introduces a system with bit rate adaptation, based on a location dependent rate
and power (LDRP) resource allocation. The protocol compensates for PC inaccuracy and improves
spectral efﬁciency of the system. The optimal packet size and data rates are derived to enhance robust-
ness of radio transmissions over correlated fading to reduce the inter-cell interference and improve
energy efﬁciency over the protocol overhead. The modeling includes the impacts of radio propagation
attenuation, correlated fading, spatial user distribution, user mobility, and trafﬁc load. Based on such
modeling, optimal adaptive mechanisms are developed and performance characteristics are derived.
An ALOHA/DS-CDMA PRN [1–6] is a simple and practical system for providing a wide range
of communication services for wireless data users in low mobility environments. It is used for both
military and commercial applications, such as tactical networks, satellite communications, ad hoc net-
works, wireless LANs, packet-access domains of cellular networks, etc. The pure ALOHA systems,
however, provide a poor throughput delay performance. Throughout the years, a signiﬁcant amount
of research effort has been invested in studying the media access control (MAC) for improving those
characteristics, resulting in numerous MAC schemes. The centralized quasi-asynchronous (unslotted
or spread-slotted) CLSP/DS-CDMA, described in [1–4], is a simple and effective system that outper-
forms the conventional ALOHA/DS-CDMA. It also overcomes the hidden-terminal problem of the
distributed carrier sense multiple access, CSMA/DS-CDMA. In a CLSP/DS-CDMA system, a hub is
responsible for sensing the channel load, which represents the received multiple access interference
(MAI). If overload is about to occur, it starts using interference cancellation techniques, described
in Chapter 5, to remove the interference or to force users to refrain from transmission with feed-
back control. Thus, in ideal conditions, the contention of the multiaccess DS-CDMA channel can be
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

754
ADAPTIVE 4G NETWORKS
avoided, resulting in optimal resource utilization and throughput. The performance of non-adaptive
CLSP systems, under the perfect PC assumption, has been investigated extensively [1–4]. It was
found that, due to the high uncertainty of radio channels and imperfect PC, the system suffers from
notable performance degradations.
The PC problem is essential to the capacity, coverage and performance of interference-limited
DS-CDMA systems, in particular on the uplink [5–9]. It is desired to have all signals received at
the hub with exact targets of signal to interference ratio (SIR) for the required radio performance.
To solve the PC problem properly, it often requires a fast closed loop PC along with an open loop
PC for initial power setting. Such solutions are used, for example, in mobile cellular systems [5–
9]. In a PRN, the closed loop PC over a short transmission time interval (TTI) of a radio packet
appears to be impractical. The accuracy of open loop PC, on the other hand, is inversely proportional
to the dynamic range of the signal variation. This variation is often large and uncertain in radio
networks [5–6]. Therefore, in order to guarantee the performance requirements, the design of the
non-adaptive PRN tends to be based on worst-case scenarios of power consumption and resource
utilization. Recent research results have demonstrated that adaptive mechanisms can be used at all
layers of protocol stacks to accommodate the dynamics of the wireless channel [9, 10], leading to
crosslayer optimization. This section discusses the possibility of bit rate adaptation and packet-size
optimization to solve the PC problem and to enhance the performance of the CLSP/DS-CDMA PRN
in low mobility environments.
The concept of trading off transport formats, including bit rate, packet length in bits and TTI
in milliseconds, with radio performance is discussed in [5–9], [10–18]. There are numerous papers
investigating adaptive rate and packet size in different contexts, such as adaptive modulation and
coding, adaptive spreading factor, adaptive multicodes, etc. [9–12]. In this section we focus explicitly
on PC problems and inter-cell interference reduction in energy-efﬁcient design of MAC protocols.
The system keeps the transmit power of mobile terminals at a constant level (within a small range
of a preset target) throughout the cell. In the meantime, it adapts the user bit rate to the distance
between the terminal and the hub using a speciﬁed LDRP RAP. The abbreviation stands for location
dependent rate and power resource allocation protocol. The closer the user is to the hub, the higher
the bit rate required to transmit with, and vice versa. As we will see later, this bit rate adaptation
substantially reduces the PC headroom and stabilizes the transmit power of mobile terminals. It
reduces the peak transmit power (and power consumption) of the mobile unit. It increases throughput
of datagram packet transmissions, due to reduced inter-cell interference, and enhances system capacity
and coverage.
To discuss the packet length adaptation, we should be aware that the open loop PC, in general,
is not efﬁcient against the impact of fading, because using an additional power rise to eliminate
the fading impact means a signiﬁcant increase in the interference. The diversity techniques, using a
RAKE receiver operating in frequency selective fading channels, for example, can reduce the impact
of deep fades [19–20]. In low mobility environments of the PRN, the Doppler bandwidth is small.
Therefore, the fading process is highly correlated causing burst error states of the channel. The burst
error states expand over tens or hundreds of milliseconds. So, in this case, the forward error correcting
(FEC) channel coding is not efﬁcient [7, 14–16]. It is also well known that the smaller the packet
size (length in bits or TTI in milliseconds), the higher the average probability of successful packet
transmission over fading channels. At the same time, the shorter the packet, the heavier the protocol
overhead is. Thus, there is an optimal packet size for radio transmission over fading channels so that
the actual goodput, deﬁned as the effective data rate successfully transmitted, excluding the protocol
overhead, is maximized. The goodput is used to measure the energy efﬁciency of mobile terminals as
well as the spectral efﬁciency of the PRN. This section presents such an optimal packet size for the
PRN to improve robustness of packet transmissions over correlated fading channels, while keeping
the variations of transmit power of mobile terminals low. The correlation between the fade/interfade
duration statistics and the packet size is also discussed.
So, location dependent bit rate adaptation and the packet size optimization together, not only
help to resolve PC problems, but also improve efﬁciency of resource utilization for the PRN. They
stabilize the transmit power of mobile terminals throughout the cell allowing the terminals to operate
with much lower maximum power requirements, reduce inter-cell interference, and therefore give the

ADAPTIVE MAC LAYER
755
possibility for introducing new systems with minimal environmental and health risks. Furthermore,
under certain conditions, such adaptive schemes improve the performance of the PRN without the need
for excessive and power consuming signal processing. This section also provides a comprehensive
analytical tool for investigating the simultaneous impacts of radio propagation attenuation, correlated
fading, spatial user distribution, user mobility, and MAI statistics on the PRN performance.
15.1.1
Signal variations and the power control problem
In a centralized PRN, the received signal power varies depending on the distance, the shadowing and
the multipath fading between the mobile terminal and the hub. From Chapter 14, it can be expressed
as
Prx = Ptxd−α10(ζ/10)φ
(15.1)
where Ptx and Prx are the transmitted and the received power of the signal at the hub respectively, d
is the distance between the terminal and the hub; α is the path loss exponent (in the range of 2 to 5);
ζ is the attenuation in dB due to shadowing (assumed to be a Gaussian random variable with zero
mean and standard deviation 8dB); and φ represents the impact of correlated fading in low mobility
environments.
The received energy per bit per interference density, for the given bit rate R is
(Eb/I0)R = (Prx/I)(W/R)
(15.2)
where I is the received wideband interference power including the background noise, and W is the
signal chip rate. The ratio (Prx/I) is the SIR, and (W/R) is the processing gain. From Equations
(15.1) and (15.2) we have
(Eb/I0)R = (Ptx/I)W(d−α/R)10(ζ/10)φ
(15.3)
Due the randomness of signal variations, (Eb/I0)R is a random variable as well. The PC is used for
keeping (Eb/I0)R above a speciﬁed target, γ R, for the required BER/PER performance, yet as close
to γ R as possible to minimize MAI for capacity enhancement. The probability that the link quality
requirement is maintained is P{(Eb/I0)R ≥γ R}.
15.1.2
Spectral efﬁciency and effective load factor of the multirate
DS-CDMA PRN
In the case of N simultaneous packet transmissions with different bit rates, (Eb/I0) of user j with bit
rate R j is given by
y j = (Eb/I0) j =
Prx, j
Itotal −Prx, j
W
R j
(15.4)
where Prx, j is the received signal power from user j, Itotal is the total received wideband power at
the hub. Parameter Itotal may include own-cell interference, Iown, other-cell interference, Iother, and
background noise, N0. Solving Equation (15.52) for Prx, j gives
Prx, j = u j Itotal,
u j =

1 +
W
(Eb/I0) j R j
−1
(15.5)
The variable u j in Equation (15.5) represents the load factor of user J’s transmission. Thus, the
normalized load of the multiaccess channel is

j
u j =

j
Prx, j/Itotal = Iown/Itotal
(15.6)

756
ADAPTIVE 4G NETWORKS
In the equilibrium condition with the maximum tolerable cell interference, Imax, we have
lim
Itotal→Imax|N E


j|N
u j

=
lim
Itotal→Imax|N E [Iown/Itotal]
(15.7)
Providing that Itotal = Iown + Iother + N0, E[N0/Itotal|Itotal →Imax] = η, E[Iother/Iown] = ι, and the
link quality requirement is maintained, by using Equation (15.4–15.7) the upper limit on Equation
(15.6), which is an effective load representing the spectral efﬁciency, can be approximated with the
ratio (1 −η)/(1 + ι). From Equation (15.4–15.7) the average cell capacity for a class of users with the
same bit rate R and target Eb/I0 ratio γ R, deﬁned as the maximum number of tolerable simultaneous
transmissions, CR, can be approximated by
CR =

1 −η
(1 + ι)ϖR
	
(15.8)
where ⌊x⌋denotes the largest integer that does not exceed the real number x, ωR is the effective load
factor of a packet transmission within the user class, which can be calculated with the formula of u j
in Equation (15.5) given that R j = R and (Eb/I0) j = γR. The contention or the system outage state
occurs in the DS-CDMA channel if

j|N
u j > (1 −η)/(1 + ι)
(15.9)
The objective of MAC schemes in PRN is to prevent the contention and to optimize the system
performance in terms of energy and spectral efﬁciency.
15.1.3
CLSP/DS-CDMA packet access and trafﬁc model
In the quasi-asynchronous CLSP/DS-CDMA, the users communicate via the hub using different code
sequences for packet transmissions with the same link quality requirement. The user data is coded and
segmented into transport blocks. Then, a header that contains system-speciﬁc addresses, transmission
control information and error control ﬁelds is added to each transport block to form a radio packet.
The packet header is assumed to have a ﬁxed length of H bits. The transmission of radio packets over
the air toward the hub is controlled by the CLSP, which attempts to prevent the condition in Inequality
(15.9). For instance, in the non-adaptive system, it keeps the number of simultaneous transmissions
under the average system capacity given by Equation (15.8). The hub is responsible for sensing
the channel load or the number of simultaneous transmissions. It broadcasts control information
periodically in a downlink control channel. The control signal is either a soft ‘inhibit’ signal when the
channel load is reaching a certain threshold, or a ‘transmission free’ signal otherwise. The terminal
that has a packet to send will listen to the control channel and decide whether to transmit or to refrain
from transmission in a non-persistent fashion. The above discussion assumes identical cell structures,
zero propagation delays, perfect sensing of the number of ongoing transmissions, and perfect radio
reception on the downlink.
The trafﬁc model is based on the following assumptions. The system population is inﬁnite.
The scheduling of packet transmissions at the mobile terminal, including the retransmission of
unsuccessful packets, is randomized sufﬁciently so that the offered trafﬁc of each user is the same
and the overall number of packet arrivals at the hub is generated according to the Poisson process
with rate λ.
15.1.4
Bit rate adaptation
As discussed above, in PRNs the PC often relies on an initial power setting at the beginning of each
packet transmission. The transmit power is then kept unchanged during the short packet interval. The
power setting in the open loop PC is based on an estimate of the path loss at the mobile terminal by
using a downlink beacon signal. The dynamic range of signal variations largely affects the accuracy

ADAPTIVE MAC LAYER
757
of the PC, and therefore the performance of interference-limited DS-CDMA systems. The bit rate
adaptation compensates the dominant component of the path loss, the near–far effect. It adapts the
bit rate R to the distance d, by keeping factor (d−α/R) in Equation (15.3) approximately constant
throughout the cell, resulting in approximately constant Ptx.
In particular, we assume that the system supports (M + 1) different bit rates, denoted by Rm with
m ∈M, M = {0, 1, . . . , M}. Let R0 be the basic bit rate, R0 = 32 kbps, speciﬁed for the cell coverage
taking into account the power restriction of the mobile terminal on the uplink, and Rm = 2m R0. Let
d0 be the normalized radius of the cell coverage, d0 ≡1. The distance d between the terminal and the
hub therefore takes a value in the (0, 1] interval. In the near–far resistant bit rate adaptation, the mobile
location resolution is speciﬁed with a division of the cell area into (M + 1) rings centered to the hub.
The normalized radius of the ring boundary, denoted by dm, is given by dm = 2−m/α for all m ∈M.
Thus, d−α
m /Rm ≡1/R0 is constant regardless of the distance. The bit rate adaptation mechanism can
be formally expressed as
If
dm+1 < d ≤dm
then
R = Rm
for all
m ∈M,
and
dM+1 = 0.
(15.10)
The packet transmission of mobile terminals from an outer ring with a smaller index m will use a
lower bit rate Rm. The location awareness of mobile terminals is feasible, especially in low mobility
environments. The ﬁneness of the rate-location-power resolution increases with larger M and smaller
α. This is illustrated in Figure 15.1.
The near–far resistant bit rate adaptation, stabilizes the transmit power of mobile terminals, thus
improving the PC accuracy, reducing the inter-cell interference, and enhancing the spectral efﬁciency
and system performance. As an illustration, let us consider the following simpliﬁed scenario. The
system consists of identical hexagonal cells using omnidirectional antennas. The cell of interest is in
the middle. The transmit power of mobile terminals, Ptx, is kept constant. It is assumed that the active
users located outside the typical 5d0 radius circle area around the hub do not cause any interference
to the cell. Let the spatial user distribution (SUD) density function be f (d, θ). The mean of Iother/Iown
dm
d0
d
log(d)
log(∆Ptx)
R0
R1
R2
R3
adaptive
non-adaptive
Figure 15.1 Rate-location-power resolution for near–far resistant bit rate adaptation ( Ptx
is the normalized average of transmit power due to the near–far effect).

758
ADAPTIVE 4G NETWORKS
has an upper bound that can be represented as
E [Iother/Iown] ≤

 2π
0

 5d0
d0
Ptxd−α f (d, θ) dd dθ

 2π
0

 d0
0+
Ptxd−α f (d, θ) dd dθ
In the case where the SUD is a two-dimensional uniform distribution and α = 3, the right-hand side
of the above expression gives the numerical result of about 5 %. This is remarkably small compared
to the 40 %–65 % of the same factor in the non-adaptive system with perfect PC as shown in [5].
In general, the near–far resistant bit rate adaptation allows the transmit power of mobile terminals
to be kept within a small range of a preset target throughout the cell. The impact of fading and the
fade-margin setting, as well as the correlation between fade/interfade duration and packet size are
investigated in the next section.
15.1.5
The correlated fading model and optimal packet size
The application of a PRN is primarily targeted for low mobility environments. The fading process
is therefore highly correlated. Let us consider two important fade statistics: the level crossing rate
(LCR) and the average fade duration (AFD), which characterize the rate of occurrence and the average
length of burst errors in fading channels, respectively [9, 18, 19–24] . These are functions of the ratio
ρ = Rs/Rrms, where Rs is the speciﬁed signal level and Rrms is the local root mean square amplitude of
the fading envelope, and the maximal Doppler frequency fd = fc/c, where fc is the carrier frequency,
v is the velocity of the mobile user, and c is the speed of light [8]. The fade margin F, in decibels,
is deﬁned as F = −20 log(ρ) that represents the power rise in the transmit power target in order to
compensate the impact of fading. Thus, studying LCR and AFD allows us to relate the rate of change
of the received signal to the target signal level and the user velocity. This is necessary for the design
of optimal packet radio transmission over burst error correlated fading channels.
The statistics of LCR and AFD in correlated fading channels with diversity have been studied,
for example, in [19, 20]. Table 15.1, based on [19], illustrates the behavior of LCR and AFD for
different fade margins and diversity techniques with an assumption of perfect two-branch combining
in multipath Rayleigh fading channels.
It includes results for non-diversity, selection combining (SC), equal-gain combining (EGC), and
maximal ratio combining (MRC) cases. There is a signiﬁcant gain in the fade margin, and thus in the
power efﬁciency as well, with the diversity cases for the same range of fade statistics or similar fading
conditions. It is therefore natural to use diversity techniques to combat deep fades in interference-
limited DS-CDMA systems. In the following, we will assume that the MRC is used in the system.
It is desirous to have as small a fade margin as possible for the required PER performance. The
probability of correct packet transmission over fading channels, in general, depends on the number of
fades occuring during TTI, duration of burst errors, and capability of FEC coding. Let us deﬁne the
Table 15.1
Fade statistics of fading channels with diversity (based on the analytical results
reported in [19]) c⃝1988, IEEE
F
Non-diversity
SC
EGC
MRC
(dB)
LCR/fd
AFD∗fd
LCR/fd
AFD∗fd
LCR/fd
AFD∗fd
LCR/fd
AFD∗fd
20
0.2482
0.0401
15
0.4319
0.0721
10
0.7172
0.1327
0.1365
0.0663
0.0938
0.0657
0.0717
0.0652
5
0.5571
0.1319
0.4076
0.1277
0.3249
0.1250
0
1.1658
0.3427
1.0279
0.3066
0.9221
0.2866

ADAPTIVE MAC LAYER
759
following notation: tf is the fade duration, i.e. the period of time the received signal r spends below
the threshold level Rs, having PDF g(tf) and mean tf avrg; tif is the interfade duration, i.e. the period
of time between two successive fades, having PDF h(tif) and mean tif avrg; tﬁa is the fade inter-arrival
time interval, i.e. the time interval between the time instants of two successive fades: tﬁa = t f + tif,
having PDF s(tﬁa) and mean tﬁa avrg.
The mean value of the above variables relates to LCR and AFD as follows: tﬁa avrg = 1/LCR;
tf avrg = (1/LCR)P{r ≤Rs} = AFD; and tif avrg = (1/LCR)P{r > Rs} = 1/LCR−AFD [8, 18].
Thus, these are functions of ρ and fd as well. For fc = 2 GHz and v less than 10 miles per hour, fd is
obtained in the range of 0–30 Hz. From the values of AFD∗fd in Table 15.1, tf avrg can be expected
to be of the order of tens of milliseconds. Therefore, a faded error block probably contains hundreds
of bits, depending on bit rate and packet duration. In order to correct them with FEC coding, it may
need an impracticably low coding rate or large interleaving depth. The FEC coding is therefore not
yet efﬁcient in burst error correlated fading channels [7]. Let us denote T as the packet duration, or
TTI, in milliseconds. The probability of successful packet transmission over fading Psf, as a function
of T , ρ, and fd, can be expressed by [13]:
Psf(T, ρ, fd) =
∞

0
∞

T
(tif −T )(tif + tf)−1h(tif) g(t f ) dtif dtf
(15.11)
The closed-form expressions for the PDF of the fade/interfade duration are not available for a general
case, but are, rather, assessed on an individual basis. However, in the related literature so far, the
Markov channel model is applied extensively [5–16, 18, 21, 24–27]. In particular, in the case of
correlated fading channels with tf avrg/tif avrg≪1, it is reasonably accurate to assume that tif and tf are
identically distributed and independent random variables having exponential PDF [21, 22, 25–27].
The condition tf avrg/tif avrg ≪1 is required for reliable data communications over burst error fading
channels. In the system model based on the numerical results for the MRC case in Table 15.1, the
ratio tf avrg/tif avrg ranges from 0.5 % to 36 % for the fade margin of 10 dB and 0 dB, respectively.
It is 4 % if the fade margin is 5 dB, which is reasonable for the above condition as well as for the
transmit power rise needed. It is below a 6 dB transmit power rise corresponding to ρ = 0.5, or 3 dB
for the average SIR thereof. In the following, we set the fade margin to 5 dB.
It is obvious that the smaller the T , the higher the Psf, and at the same time, the heavier the
protocol overhead. For given constraints of the required PER, the user velocity v, the bit rate R, the
fade margin F, and the length of the packet header H, one can ﬁnd an optimal packet duration T so
that the normalized goodput Gsf
Gsf(T, ρ, fd) = Psf(T, ρ, fd)(TR −H)/TR
(15.12)
is maximized. The goodput is deﬁned above as the effective data rate successfully transmitted
excluding the protocol overhead. The product TR in Equation (15.12) gives the value of the packet
length L in bits, L = TR. One can further exploit the potential of adaptive packet size based on
Equations (15.11) and (15.12). For example, T and/or L can be adapted to ρ and/or fd along with
adaptive R. These details are not included due to limited space. In the mobility equilibrium, we have
Psf(T ) =

fd
Psf (T, ρ, fd)p( fd) d fd
(15.13)
where p( fd) is the PDF of fd resulting from the distribution of the user velocity in the system
equilibrium. Let us assume that fd takes a discrete value in {1, 2, . . . , fd max}. Then the right-hand
side of Equation (15.13) becomes
Psf(T ) =

fd
Psf(T, fd)P( fd)
(15.14)
Figure 15.2 shows the equilibrium Psf and Gsf characteristics versus T with R = R0 = 32 kbps,
H = 160 bits, ρ = 10−5/20, and fd max = 30 Hz for three different mobility scenarios. The most
dynamic one is characterized with a uniform p( fd) over the limit range of fd, for which the user

760
ADAPTIVE 4G NETWORKS
10
20
30
40
50
60
70
80
0.45
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
Packet duration T(ms)
Performance measures
Psf (3)
Psf (2)
Psf (1)
Gsf (3)
Gsf (2)
Gsf (1)
(1) uniform p(fd)
(2) gamma p(fd)
(3) exponential p(fd)
Figure 15.2 Optimal packet size for packet transmissions over correlated fading channels.
velocity v is distributed evenly within 0–4.5 m/s. The least dynamic one is characterized with an
exponential p( fd) with a mean of fd about 7 Hz, for which the user velocity is distributed exponentially
around a mean of 1m/s. For the one in between, we use a generic gamma PDF for p( fd) because of
its ﬂexibility and richness in modeling [28]:
p( fd) =
1
baΓ(a) f a−1
d
e−fd/b
where a is the shape parameter, b is the scale parameter, and Γ(x) is the gamma function. Thus,
we can adjust the values of parameters a and b to obtain suitable PDFs for a number of mobility
scenarios and expansions of the Doppler frequency range. This PDF family also takes the exponential
PDF form as its special member when the shape parameter a is set to 1. For the moderate mobility
scenario of Figure 15.2, we choose a gamma PDF with a = 2 and b = 6 for instance. The optimal
packet size is obtained at T0 around 30 ms, which is also the maximum TTI if PER is not to exceed
15 %. Based on that, we set the optimal packet size for the most dynamic scenario as T0 = 20 ms and
L0 = T0R0 = 640 bits; for the least dynamic one, T0 = 40 ms and L0 = T0R0 = 1280 bits; and for
the moderate one, T0 = 32 ms and L0 = T0R0 = 1024 bits.
15.1.6
Performance
Let T0 be the normalized unit of time, T0 ≡1. Let us deﬁne the following notation. Λ is the offered
system trafﬁc, i.e. the average number of packet arrivals per normalized unit of time. Given that
the packets arrive at the hub according to the Poisson process with rate λ and T0 ≡1, we have
 = λT0 = λ. The offered system trafﬁc in terms of data rate is kept the same for both the non-
adaptive and the adaptive systems, and takes the value ΛL0. S is the system throughput (the average
number of successful packet transmissions per normalized unit of time for a given offered trafﬁc Λ).
D is the average packet delay (the average time interval from the instant a given packet is generated to
the instant the packet is transmitted successfully). G is the system goodput (the effective average data
rate successfully transmitted excluding protocol overhead). For instance, in the system with a ﬁxed
packet length of L bits, including a packet header of H bits, the system goodput is G = S(L −H).

ADAPTIVE MAC LAYER
761
15.1.6.1
Performance characteristics of the non-adaptive system
In this case we have R = R0, T = T0 and L = L0. The system capacity, C = C0, is obtained from
Equation (15.8). The formal notation of the queuing system model for this system is: exponentially
distributed inter-arrival time; deterministic service time as the packet duration T ; ﬁnite number of
servers equal to the system capacity C; no waiting room and inﬁnite population. Let us deﬁne n as the
system state (the number of ongoing packet transmissions in the system) and pn as the steady-state
probability of the system given by:
pn = βn
n!
 C

i=0
βi
i!
−1
,
0 ≤n ≤C
(15.15)
where β = λT [29]. The equilibrium probability of successful packet transmission, Psucc, depends on
the following three factors. The ﬁrst one is the equilibrium probability that the packet is not blocked
by the CLSP, which is given by
Pnb = 1 −pC
(15.16)
The second one is the equilibrium probability that the packet is not corrupted by the system outage,
which can be expressed as Pnso = E[the number of transmissions not hit by the system outage]
/E[the number of transmissions in the system]. This probability can be expressed as
Pnso =
C

n=0
npn Pok(n)/
C

n=0
npn
(15.17)
where Pok(n) is the probability that n simultaneous transmissions are not corrupted by the system
outage, i.e. the condition in Inequality (15.9) does not occur. The impact of imperfect PC, in the
long run, is often characterized with a log-normal error of the average Eb/I0 ratio with a standard
deviation of σ in decibels [5, 6]. Therefore, Pok(n) can be expressed as
Pok(n) = 1 −Q
C −E [Z |n ]
√Var [Z |n ]

(15.18)
where Q(x) is the standard Gaussian integral, Z is the normalized MAI caused by n users, E[Z|n] =
n exp((εσ)2/2); Var[Z|n] = n exp(2(εσ)2); ε = ln(10)/10 [5]. The third factor is the equilibrium
probability that the packet is not faded, which is given by Equation (15.14) with T = T0. Therefore,
we have
Psucc = PnbPnsoPsf
(15.19)
The average system throughput for the offered system trafﬁc Λ is given by:
S = ΛPsucc
(15.20)
The ratio S/Λ ≡Psucc is called the normalized throughput.
The normalized average packet delay is decomposed into two components. The ﬁrst one is the
normalized average waiting time for accessing the channel, Dw. This can be calculated by the
normalized average delay time, which follows Little’s result at the arrival-side [29], minus the
normalized serving time T
Dw = (λT/E[n] −1)T/T0
(15.21)
where E[n] is the average number of packets being served in the system. The second one is the
normalized average resident time from the instant the packet enters the system to the instant the
packet leaves the system successfully, Dr. This is obtained by using Little’s result at the departure-
side:
Dr = E[n]/S
(15.22)

762
ADAPTIVE 4G NETWORKS
where S is the average system throughput. The normalized average packet delay is therefore obtained
as
D = Dw + Dr
(15.23)
The system goodput is given by
G = S(L −H)
(15.24)
The normalized goodput is given by the ratio G/(ΛL0) ≡Psucc(L −H)/L.
15.1.6.2
Performance characteristics of the adaptive system
This system uses bit rate adaptation while having the same cell coverage and offered system trafﬁc
in terms of data rate as those of the non-adaptive system. Either the packet length L, or the packet
duration T , can be kept the same as in the non-adaptive system, i.e. L0 or T0, which is optimized.
In the ﬁrst option, with L = RT = L0, the packet transmission with higher bit rate will have shorter
TTI. That compensates the increase of MAI on a time scale within the T0 interval, resulting in the
same normalized power consumption per packet for all packet transmissions. In the latter option,
with T = L/R = T0, the packet transmission with higher bit rate will have longer packet length and
smaller offered trafﬁc intensity. That compensates the increase of MAI on a time scale over the T0
interval, resulting in less protocol overhead but longer packet delay compared to the ﬁrst option. Let
us denote Tm as the packet duration corresponding to bit rate Rm. Thus, we have Tm = 2−mT0 for the
ﬁrst option, and Tm = T0 for the latter one.
The queuing system model for the adaptive system is the stochastic model of multirate loss
networks [30]. The offered system trafﬁc is composed of portions corresponding to different bit
rates, which are generated by active users from different ring areas of the cell due to the adaptation
mechanism given by Expression (15.10). Let us deﬁne λm as the rate of packet arrivals from ring m
using bit rate Rm. The value of λm depends on SUD, and since the offered system trafﬁc in terms of
data rate is ΛL0 = λR0T0, the same as that of the non-adaptive system, λm is given by
λm = λ R0T0
RmTm
dm

dm+1
2π

0
f (d, θ) dd dθ
(15.25)
where f (d, θ) is the PDF of SUD.
Let us deﬁne n as the variable vector of the system states, n = [nm, m ∈M], where nm is the
number of ongoing packet transmissions using bit rate Rm; and ω as the constraint vector of the
effective load factors, ω = [ωm, m ∈M], where ωm is deﬁned as ωR in Equation (15.8) with R = Rm.
The CLSP controls the packet access on the uplink so that n is kept in the set of allowed system
states deﬁned as  = {n, nω ≤(1 −η)/(1 + ι)} based on Inequality (15.9). Let us deﬁne p(n) as the
steady-state probability of the system, n ∈, with the product form solution [30]:
p(n) = 1
G0

m
βnm
m
nm! ,
G0 =

n∈

m
βnm
m
nm!
(15.26)
where βm = λmTm. For a large set of , the computational complexity with the above formulas is
prohibitively high.
Let us deﬁne s as the effective load state of n packet transmissions, n ∈, given by the product
s = nω. It forms a set  of possible effective load states corresponding to the set  of system states.
The steady-state probability of the system, in terms of effective load states, can be calculated based
on the so-called stochastic knapsack-packing approximation [30] as follows.
p(s) =
q(s)

s∈ q(s)
(15.27)

ADAPTIVE MAC LAYER
763
with q(s) given in recursive form as:
q(s) = 1
s

m
ϖmβmq(s −ωm), s ∈+, q(0) = 1, q(−) = 0
Based on the results of the non-adaptive system above, the equilibrium probability of successful
packet transmission with bit rate Rm, denoted by Psucc m, depends on the following three factors. The
ﬁrst one is the equilibrium probability that the packet is not blocked by the CLSP. This is given by
Pnb m = 1 −

s∈:s>1−η−ϖm
p(s)
(15.28)
The second is the equilibrium probability that the packet is not corrupted by the system outage. This
can be expressed as Pnso = E[the number of transmissions not hit by the system outage]/E [the
number of transmissions in the system]
Pnso =

n∈
np(n)Pok(n)/

n∈
np(n)
(15.29)
where Pok(n) is the probability that n simultaneous transmissions are not corrupted by the system
outage, i.e. the condition in Inequality (15.9) does not occur. Let us denote the standard deviation
of the log-normal error of the average Eb/I0 ratio corresponding to bit rate Rm, with σm in decibels.
It can be expected that σm of the adaptive system is smaller than σ of the non-adaptive counterpart
because the PC in the adaptive system is more stable and accurate as discussed above. To simplify the
computation, we assume that σm = ϕ for all m. Based on Equation (15.18), Pok(n) can be expressed by
Pok(n) = 1 −Q


1 −η
1 + ι −E [Z |n]
√Var [Z |n]


(15.30)
where Z is the normalized MAI caused by n users,
E [Z|n] =

m
nmϖm exp((εσm)2/2)
= exp((εϕ)2/2)

m
nmϖm = s exp((εϕ)2/2)
Var [Z|n] =

m
nmϖm exp(2(εσm)2) = s exp(2(εϕ)2)
Thus, Pok(n) can now be replaced with Pok(s) and Equation (15.29) is equivalent to
Pnso =

s∈
sp(s)Pok(s)
 
s∈
sp(s)
The third factor is the equilibrium probability that the packet is not faded. This is given by Equation
(15.14) with T = Tm, i.e. Psf(Tm). Therefore, we have
Psucc m = Pnb m PnsoPsf (Tm)
(15.31)
The average system throughput is given by:
S =

m
λmT0Psucc m
(15.32)
The normalized system throughput is given by the ratio S/ 
m
λmT0. The normalized average packet
delay is given by Equation (15.23) with the components
Dw =

m
λmTmϖm
 
s∈
sp(s) −1
 
m
λmTm
 
m
λmT0

(15.33)
Dr =

s∈
sp(s)
 
m
λmT0Psucc mϖm
(15.34)

764
ADAPTIVE 4G NETWORKS
The system goodput is given by
G =

m
λmT0Psucc m(RmTm −H)
(15.35)
and the normalized goodput is G/(ΛL0).
15.1.6.3
Performance examples
Table 15.2 summarizes the system parameters. The adaptive system supports four different bit rates:
32 kbps, 64 kbps, 128 kbps and 256 kbps. The target Eb/I0 is set to 5 dB, which includes an increase
of 2.5 dB due to the fade margin of 5 dB.
The value of the above analytical method is in the modeling of the system dynamics due to effects
of numerous simultaneous factors. These factors include imperfect PC, propagation attenuations,
SUD, user mobility, and offered trafﬁc intensity over burst error correlated fading channels. The
optimal packet size, obtained from the optimization presented in the above section is used for both
the non-adaptive and the adaptive systems. That is, T0 = 20 ms and L0 = 640 bits for the dynamic
mobility scenario characterized by a uniform p( fd); or T0 = 40 ms and L0 = 1280 bits for the less
dynamic one with an exponential p( fd). To investigate the effects of SUD, two simple functions
for f (d, θ are used, the one-dimensional uniform PDF and the two-dimensional uniform PDF. The
ﬁrst one is often used to model indoor ofﬁce environments, where the users are located along the
corridors. The latter one is for more open areas. The offered system trafﬁc Λ varies and takes values
in {4, 8, 16, . . . , 60} packet arrivals per normalized unit of time T0. The simulation results are based
Table 15.2
Summary of the system parameters
Name
Deﬁnition
Values
fc
The carrier frequency
2 GHz
W
The DS-CDMA chip rate
4.096 Mcps
η
The ratio of the background noise
−10 dB
power normalized to the maximum
tolerable received interference
α
The path loss law exponent
3 (4)
F
The fade margin
5 dB
R0
The primary bit rate
32 kbps
T0
The optimal packet duration
20 ms (40 ms)
L0
The optimal packet length
640 bits
(1280 bits)
M + 1
The number of supported bit rates
4
γm
The target Eb/I0 ratio of packet
5 dB
transmission with bit rate Rm
σ
The standard deviation of
3 dB
log-normal error of the average
Eb/I0 for the non-adaptive system
ϕ
The standard deviation of
2 dB
log-normal error of the average Eb/I0
for the adaptive system
fd max
The upper bound of maximal
30 Hz
Doppler frequency
H
The length of the packet
160 bits
header plus trailer

ADAPTIVE MAC LAYER
765
0
10
20
30
40
50
60
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
Normalized offered system traffic
Normalized system goodput
adaptive R, fixed L
simulation
adaptive R, fixed T
simulation
fixed R
simulation
2-dim uniform SUD
Uniform p(fd), T0 = 20 ms, L0 = 640 bits
(a)
0
5
10
15
20
25
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
Average system throughput
Normalized average packet delay
adaptive R, fixed L
simulation
adaptive R, fixed T
simulation
fixed R
simulation
2-dim uniform SUD
Uniform p(fd), T0 = 20 ms, L0 = 640 bits
(b)
Figure 15.3 Single-cell system performance in dynamic mobility scenario. (a) Normalized
system goodput; (b) throughput – delay tradeoffs [31] c⃝2002, IEEE.
on Omnet + + [28], a multipurpose discrete-event simulator. The channel sampling period is set to
0.1 ms. The simulation is run over 100 000 packet arrivals for each rate of the offered system trafﬁc.
Figures 15.3–15.7 present the performance of both the non-adaptive and the adaptive systems
in different system scenarios under the effects of different system parameters. Each ﬁgure consists
of two subﬁgures: (a) the normalized system goodput and (b) the throughput-delay tradeoffs. The
adaptive system outperforms the non-adaptive counterpart in all cases.

766
ADAPTIVE 4G NETWORKS
0
10
20
30
40
50
60
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Normalized offered system traffic
Normalized system goodput
adaptive R, fixed L
simulation
adaptive R, fixed T
simulation
fixed R
simulation
2-dim uniform SUD
Exponential p(fd), T0 = 40 ms, L0 = 1280 bits
(a)
0
5
10
15
20
25
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
Average system throughput
Normalized average packet delay
adaptive R, fixed L
simulation
adaptive R, fixed T
simulation
fixed R
simulation
2-dim uniform SUD
Exponential p(fd), T0 = 40 ms, L0 = 1280 bits
(b)
Figure 15.4 Single-cell system performance in less dynamic mobility scenario. (a) Nor-
malized system goodput; (b) throughput – delay tradeoffs [31] c⃝2002, IEEE.

ADAPTIVE MAC LAYER
767
0
10
20
30
40
50
60
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Normalized offered system traffic
Normalized system goodput
adaptive R, 2-dim unif. SUD
simulation
adaptive R, 1-dim unif. SUD
simulation
fixed R
simulation
Exponential p(fd), L = L0 = 1280 bits
(a)
0
5
10
15
20
25
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
Average system throughput
Normalized average packet delay
adaptive R, 2-dim unif. SUD
simulation
adaptive R, 1-dim unif. SUD
simulation
fixed R
simulation
Exponential p(fd), L = L0 = 1280 bits
(b)
Figure 15.5 Impact of SUD on single-cell system performance. (a) Normalized system
goodput; (b) throughput – delay tradeoffs [31] c⃝2002, IEEE.

768
ADAPTIVE 4G NETWORKS
0
10
20
30
40
50
60
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Normalized offered system traffic
Normalized system goodput
adaptive R, PL-law expt. 2 
simulation
adaptive R, PL-law expt. 4
simulation
fixed R
simulation
2-dim uniform SUD
Exponential p(fd), L = L0 = 1280 bits
(a)
2
4
6
8
10
12
14
16
18
20
22
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
Average system throughput
Normalized average packet delay
adaptive R, PL-law expt. 2
simulation
adaptive R, PL-law expt. 4
simulation
fixed R
simulation
2-dim uniform SUD
Exponential p(fd), L = L0 = 1280 bits
(b)
Figure 15.6 Impact of path loss law exponent on single-cell system performance. (a) Nor-
malized system goodput; (b) throughput – delay tradeoffs.
Figures 15.3–15.4 show the impact of user mobility on the performance and how to choose a
practical option of the optimal packet size for the adaptive system. For these ﬁgures, we use a single-
cell scenario with the two-dimensional uniform f (d, θ) and the path loss law exponent α = 3. The
optimal packet size, as mentioned above, includes the optimal packet length in bits and the optimal
packet duration in milliseconds. The less dynamic mobility scenario in Figure 15.4 has larger optimal
packet size and better goodput performance than the more dynamic one in Figure 15.3, due to fading.
This is also shown in Figure 15.2. There are two options for the optimal packet size, with the optimal
packet length in bits, or the optimal TTI in milliseconds for the adaptive system. In the ﬁrst option,

ADAPTIVE MAC LAYER
769
0
10
20
30
40
50
60
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Normalized offered system traffic
Normalized system goodput
adaptive R
simulation
fixed R
simulation
2-dim uniform SUD
Exponential p(fd), L = L0 = 1280 bits
(a)
2
4
6
8
10
12
14
16
18
20
22
0
1
2
3
4
5
6
Average system throughput
Normalized average packet delay
adaptive R
simulation
fixed R
simulation
2-dim uniform SUD
Exponential p(fd), L = L0 = 1280 bits
(b)
Figure 15.7 Multicell system performance. (a) Normalized system goodput; (b) through-
put – delay tradeoffs.
keeping the packet length L constant at the optimized L0 results in a constant (L −H)/L ratio. Thus,
there is no further gain in the goodput, but instead, a signiﬁcant gain in the packet delay, due to the
shorter TTI of packet transmissions with higher bit rates. However, if the optimal packet length is not
large enough, the packet transmission with a certain high bit rate may require an impractically short
TTI. In the latter one, keeping the packet duration T constant at the optimized T0 results in a better

770
ADAPTIVE 4G NETWORKS
(RT −H)/RT ratio for larger R. Thus, there is a gain in the goodput, but not in the packet delay. If
the optimal packet duration is large enough, the gain in the goodput is not signiﬁcant and the packet
length in bits may become impractically large for a certain high bit rate. Based on this consideration
and the results shown in Figures 15.3–15.4, T = T0 = 20 ms for the dynamic mobility scenario, and
L = L0 = 1280 bits for the less dynamic one, are used.
Figures 15.5–15.6 present the impacts of SUD and path loss exponent on the performance char-
acteristics. For these ﬁgures, the less dynamic mobility scenario is used with L = L0 = 1280 bits
and a single cell. The adaptive system is sensitive to the SUD and the path loss exponent, which
affect the patterns of the user location resolution and the offered system trafﬁc as formulated in
Expression (15.10) and Equation (15.25). The more users put to inner rings with one-dimensional
uniform f (d, θ) in Figure 15.5, and/or α = 4 in Figure 15.6, the more the bit rate is boosted and the
greater the reduction in TTI of packet transmissions, resulting in better goodput and throughput delay
performance for the adaptive system. The differences are not of signiﬁcance though. One should also
keep in mind that the larger path loss law exponent and the non-uniform SUD cause larger headroom
of the transmit power, especially in the non-adaptive system.
The increase in goodput, i.e. energy efﬁciency, offered by the proposed bit rate adaptation and
packet length optimization, can well be over 100 %, as shown in Figure 15.7 for a multicell system
scenario with identical cells and two-dimensional uniform SUD. The inter-cell interference in the
adaptive system (with the factor ι = E[Iother/Iown] set to the maximum of 5 %) is much smaller than
in the non-adaptive counterpart (with ι set to the minimum of 40 %) as presented above. This, added
to the advantages of the adaptive system as presented above with a single-cell scenario, signiﬁcantly
enhances system performance and cell deployment.
15.2
MINIMUM ENERGY PEER-TO-PEER MOBILE WIRELESS NETWORKS
This section describes a distributed network protocol optimized for achieving the minimum consump-
tion energy for randomly deployed ad hoc networks. A position-based algorithm, based on [32], is
presented, which is supposed to set up and maintain a minimum energy network between users that
are randomly deployed over an area and are allowed to move with random velocities. These mobile
users are referred to as ‘nodes’ over the two-dimensional plane. The network protocol reconﬁgures the
links dynamically as nodes move around, and its operation does not depend on the number of nodes
in the system. Each mobile node is assumed to have a portable set with transmission, reception and
processing capabilities. In addition, each has a low-power global positioning system (GPS) receiver
on board, which provides position information within at least 5 m of accuracy. The principles of
GPS system operation are discussed in Chapter 14. The recent low-power implementation of a GPS
receiver [33] makes its presence a viable option in minimum energy network design.
15.2.1
Network layer requirements
In peer-to-peer communications, each node is both an information source and an information sink.
This means that each node wishes to both send messages to, and receive messages from, any other
node. An important requirement of such communications is strong connectivity of the network. A
network graph is said to be ‘strongly connected’ if there exists a path from any node to any other
node in the graph [34]. A peer-to-peer communications protocol must guarantee strong connectivity.
For mobile networks, since the position of each node changes over time, the protocol must be
able to update its links dynamically in order to maintain strong connectivity. A network protocol
that achieves this is said to be ‘self-reconﬁguring.’ A major focus of this section is the design of a
self-reconﬁguring network protocol that consumes the least amount of energy possible.
In order to simplify the discussion, we take one of the nodes to be the information sink for all
nodes in the network. We call this node the ‘master site.’ The master site can be thought of as the
headquarters located at the edge of the digital battleﬁeld, the supervisory station in a multisensor

MINIMUM ENERGY PEER-TO-PEER MOBILE WIRELESS NETWORKS
771
network, or the base station in a cellular phone system. All of these scenarios are special cases of
peer-to-peer communications networks.
Each node knows its own instantaneous position via GPS, but not the position of any other node
in the network, and its aim is to send its messages to the master site whenever necessary.
A protocol that solves the minimum energy problem with a single master site simultaneously
solves the general peer-to-peer communications problem, because each node can independently be
taken as a master site, and the optimal topologies can be superimposed. We take advantage of this
simpliﬁcation and concentrate on the problem with a single master site without loss of generality.
15.2.2
The power consumption model
In the network conﬁguration algorithm, this section concentrates only on path loss that is distance-
dependent. The algorithm does not depend on the particular value of the path loss exponent n(n > 2
for outdoor propagation models; see Chapter 14) and thus offers the ﬂexibility to be applied in
various propagation envirnments. So, since the transmit power falls as 1/dn, n ≥2, as given by the
path loss model, relaying information between nodes may result in lower power transmission than
communicating over large distances.
For illustration, consider three nodes A, B and C on a line, as in Figure 15.8. Assume that all
three nodes use identical transmitters and receivers. Node A wants to send a message to C. Let t
denote the predetection threshold (in mW) at each receiver. In other words, the minimum power that
a transmitter must radiate in order to allow detection at distance d meters away is tdn, where n is
the exponent in the path loss model. Assuming that node A knows the positions of B and C, it has
two options: it can transmit the signal directly to C, which requires a power consumption of tdn
AC at
node A, or it can relay the message through node B and have it retransmit it with the minimum power
needed for B to reach C. In this second case, the total transmit power consumption is tdn
AB + tdn
BC. In
the case of three collinear nodes, it is easily seen that relaying the message through the middle node
always comes at a lower total transmit power consumption than transmitting directly.
When the three nodes are allowed to lie on a two-dimensional plane, which is denoted by ℜ2, the
option that costs less total power becomes a function of where the receive node is positioned. In the
next section, we ﬁnd the positions for the receive node, where relaying will always consume less total
power than transmitting directly.
There is another source of power consumption that must be considered in addition to path loss.
In the previous example, when node A relays through B, node B has to devote part of its receiver
to receive and store node A’s message. This additional power will be referred to as the receiver
power at the relay node, and will be denoted by c. Each relay induces an additional receiver power
to be consumed at the relay node. For the previous example, the total power consumption, including
transmit and receiver power consumption in the transmission, is thus tdn
AB + tdn
BC + c when node B
is used as a relay.
The main goal of the section is to arrive at an algorithm that requires only local computation
for updates, and requires as little global information as possible. A protocol requiring only local
information is extremely advantageous for networks with mobile nodes, since delays associated with
disseminating global information would be intolerable. From the perspective of power consumption,
a distributed protocol running almost exclusively on local information requires transmission only over
small distances. This in turn conserves the total power required for transmitting that information.
A third advantage of the use of only local information is that it reduces the interference levels
A
B
C
dAB
dBC
A
B
C
dAB
dBC
Figure 15.8 Three collinear nodes A, B and C.

772
ADAPTIVE 4G NETWORKS
dramatically, since a user’s communication with only nodes in its immediate surroundings causes
little interference to nodes further away.
15.2.3
Minimum power networks
In order to investigate the implications of local information on power-efﬁcient transmission, we
consider three nodes in ℜ2, denoted by i, r and j. Node i is a node that wishes to transmit information
to node j. Node i is referred to as the ‘transmit node’ and node j the ‘receive node.’ Node i considers
the third node, r, to be used as a relay for transmission from i to j. Node r is called the ‘relay node.’
The aim is to transmit information from i to j with minimum total power incurred by i, j and r.
By varying the position of j, we investigate under which conditions it consumes less power to relay
through r. Below, the position of j is denoted by (x, y).
The following deﬁnitions will be used:
Relay region: The relay region Ri→r of the transmit–relay node pair (i, r) is deﬁned to be
Ri→r ≡

(x, y)|Pi→r→(x,y) < Pi→(x,y)

(15.36)
where Pi→r→(x,y) denotes the power required to transmit information from node i to (x, y)
through the relay node R, whereas Pi→(x,y) denotes the power required to transmit information
from i to (x, y) directly.
Deployment region: Any bounded set in ℜ2 that has the position of the nodes in ℵas a subset is said
to be a deployment region for the node set ℵ. The deployment region is introduced because,
in practice, there is a ﬁnite area beyond which no nodes should be looking for neighbors with
which to communicate. The boundaries of deployment regions can also be taken as known and
impenetrable obstacles to communication. Then, the nodes near the edge can use this fact not
to search unnecessarily beyond the deployment region.
Enclosure and Neighbor: The enclosure of a transmit node i is deﬁned as the non-empty solution
εi to the set of equations deﬁned as
εi =

k∈N(i)
Rc
i→k ∩Dℵ
(15.37)
and
N(i) = {n ∈ℵ|(xn, yn) ∈εi, n ̸= i }
(15.38)
In Equations (15.37–15.38) Rc represents the complemnt of set R, and Dℵdenotes the deploy-
ment region for the node set ℵ. Each element of N(i) is said to be a ‘neighbor’ of i and N(i)
is called the ‘neighbor set’ of i. A node i is said to be enclosed if it has communication links
to each of its neighbors and no other node.
Enclosure graph: The enclosure graph of a set of nodes ℵis the graph whose vertex set is ℵand
whose edge set is

i∈ℵ

k∈N(i)
li→k
(15.39)
where li→k is the directed communications link from i to k.
Minimum power topology: A graph on the stationary node set ℵis said to be a minimum power
topology on ℵif:
1. Every node has a directed path to the master site;
2. The graph consumes the least total power over all possible graphs on ℵfor which 1)
holds.

MINIMUM ENERGY PEER-TO-PEER MOBILE WIRELESS NETWORKS
773
15.2.4
Distributed network routing protocol
The main idea in this protocol is that a node does not need to consider all the nodes in the network
to ﬁnd the global minimum power path to the master site. By using a very localized search, it
can eliminate any nodes in its relay region from consideration and pick only those few links in its
immediate neighborhood to be the only potential candidates. The protocol effectively operates in
two phases: ﬁrst, a local search executed by each node to ﬁnd the enclosure graph, and second, a
minimum cost search from the master site to every node. The cost metric is the total power required
for a node to reach the master site along a directed path.
15.2.4.1
Search for enclosure (Phase 1)
In order for a protocol to ﬁnd the enclosure graph, each node must ﬁnd its enclosure and its neighbor
set. Since computing enclosure requires knowledge of the positions of nearby nodes, each node
broadcasts its position to its search region. The search region is deﬁned as the region where a node’s
transmitted signal (and hence its position) can be correctly detected by any node in the region. When
searching for neighbors, a node must keep track of whether a node found is in the relay region of
previous nodes found in the search. The relay graph deﬁned below is, in effect, a data structure which
stores this information.
Relay graph of a node
Let A denote the set of all nodes that transmit node i has found thus far in its search. Let j and k be
two nodes in A. Whenever k ∈R( j), we form a directional edge from j to k and denote it by e j→k.
The relay graph of a transmit node i is deﬁned to be the directed graph whose vertex set is a and
whose edge set is

j∈A

k∈R( j)
e j→k
(15.40)
The relay graph of i is denoted by G(i). e j→k represents a relation between j and k based on their
positions. It indicates that k lies in the relay region Ri→j. It does not represent a communication link
between j and k.
To ﬁnd N(i), namely the neighbor set of i, each node in the algorithm starts a search by sending
out a beacon search signal that includes the position information of that node. Since every node
executes the same algorithm, we will focus on a particular node, referred to as the transmit node. The
transmit node also listens for signals from nearby nodes. When it receives and decodes these signals,
it ﬁnds out the position of the nearby nodes and calculates the relay region for them. As we described
in the discussion preceding the deﬁnitions of enclosure and the relay graph, the transmit node must
keep only those nodes that do not lie in the relay regions of previously found nodes. Therefore, each
time new nodes are found, the transmit node must update its relay graph.
The nodes that have been found thus far in the neighbor search fall into two categories: if a node
found (call it node k) falls in the relay region of some other found node (call it j), then we mark
k as ‘dead’, otherwise the node is marked ‘alive’. The set of alive nodes when the search is over
constitutes the set of neighbors for transmit node i. When the search terminates, the transmit node is
enclosed, and the nodes that enclose the transmit node are not in the relay region of any node found,
as required by the deﬁnition of a neighbor.
15.2.4.2
Cost distribution (Phase 2)
After the enclosure graph has been found in Phase 1, the distributed Bellman–Ford minimum cost
algorithm [13] on the enclosure graph is applied, using power consumption as the cost metric. In
Phase 2, each node broadcasts its cost to its neighbors. The cost of a node i is deﬁned as the minimum
power necessary for i to establish a path to the master site. Each node calculates the minimum cost it

774
ADAPTIVE 4G NETWORKS
can attain given the cost of its neighbors. Let n ∈N(i). When i receives the information Cost(n), it
computes
Ci,n = Cost(n) + Ptransmit(i, n) + Preceiver(n)
(15.41)
where Ptransmit(i, n) is the power required to transmit from i to n, and Preceiver(n) is the additional
receiver power that i’s connetion to n would induce at n. Preceiver(n) is either known to i, if for
instance every user carries an identical receiver, or can be transmitted to i as a separate piece of
information along with Cost(n). Then, node i computes
Cost(i) = min
n∈N(i) Ci,n
(15.42)
and picks the link corresponding to the minimum cost neighbor. This computation is repeated, and
the minimum cost neighbor is updated each time. The data transmission from i to the master site can
start on the minimum cost neighbor link, which is the global minimum power link.
15.2.4.3
Computation of the relay region
In the following example, we illustrate the relay region of a single node, assuming the two-ray
propagation model for terrestrial communications, which implies a 1/d4 transmit power rolloff . The
close-in reference distance is taken as 1 m. The carrier frequency is 1 GHz, and the transmission
bandwidth 10 kHz. We assume omnidirectional antennas with 0 dB gain, −160 dBm/Hz thermal
noise, 10 dB noise ﬁgure in the receiver, and a predetection signal to noise ratio (SNR) of 10 dB.
Using the Friis free space formula gives −67.5 dBm as the minimum transmit power required for
detection at 1 m. We take this to be roughly −70 dBm for our simulations. This can be treated as an
effective predetection threshold to be used with the 1/d4 rolloff formula to compute the minimum
required transmit power for any distance.
We assume the following model for receiver power at any relay node: a ﬁxed receiver power of
80 mW is consumed at each node, with a 20 mW increase for each additional node from which
transmission is received. This model can be easily modiﬁed according to the actual receiver design
[35, 36], see also Chapters 10 and 11.
With the previous assumptions, the relay region is obtained by solving the following two equations
simultaneously:
d4
i j ≥d4
ir + d4
r j + c/t
(15.43)
and
d2
i j = dir + d2
r j −2dirdr j cos θ
(15.44)
where θ is the angle between position vectors rr→i and rr→j. In Inequality (15.43), c denotes the
additional receiver power cost of 20 mW for relays, and t the predetection threshold of 10−7 mW.
Figure 15.9 displays the relay region in the case where the relay node is at (0,0), and the transmit
node is at (80,0). The relay region has been shaded. The units are meters.
15.2.4.4
Stationary network simulation
We now present the simulation results for a stationary network with nodes deployed over a square
region of 1 km on each side. The (x, y) coordinates of the nodes are generated as independent,
identically distributed (i.i.d.) uniform random variables over this region. Since the nodes are stationary,
once each node is enclosed and obtains a valid cost, the network remains in the minimum power
topology.
The transmit and receiver powers for providing point-to-point connections are as described above.
In this simulation, we investigate how the total power consumption of the minimum power topology
varies with the number of nodes. Figure 15.10 illustrates this relationship. As the number of nodes

MINIMUM ENERGY PEER-TO-PEER MOBILE WIRELESS NETWORKS
775
−150
−100
−500
50
100
150
−150
−100
−50
0
50
100
150
50
0
100
150
Figure 15.9 Relay region for 80 m inter-nodal distance [32] c⃝1999, IEEE.
20
40
60
80
100
120
140
160
180
200
0
1
2
3
4
5
6
7
8
Number of nodes
Average power expenditure per node / transceiver power
20
40
60
80
100
120
140
160
180
200
0
1
2
3
4
5
6
7
8
Figure 15.10 Average power expenditure per node [32] c⃝1999, IEEE.
grows larger, the average power decreases toward its asymptote of 300 mW receiver power/node. The
plot has been normalized to the receiver power.
15.2.5
Distributed mobile networks
The protocol presented so far has been for stationary networks. However, due to the localized nature
of its search algorithm, it proves to be an effective energy-conserving protocol for the mobile case as
well.

776
ADAPTIVE 4G NETWORKS
Synchronization in a mobile network can be achieved by use of the absolute time information
provided by GPS up to 100 ns resolution [37]. The network synchronization is discussed in Section
14.3. In a synchronous network, each node wakes up regularly to ‘listen’ for change and goes back to
the sleep mode to conserve power. The time between successive wakeups is referred to as the cycle
period of the network. If the cycle period is too long, the power costs to the master site can change
signiﬁcantly from one wakeup to the next. In this case, the network cannot track the correct costs.
If the cycle period is too short, then the network consumes unnecessary energy to compute costs
that change only slowly. The choice of the cycle period for energy-efﬁcient operation of a wireless
network must address this tradeoff. In our simulation, we assume that the cycle period has been
chosen to meet these two constraints.
After wakeup, each node executes Phase 1 of the protocol, as described in the previous section.
When a node completes Phase 2, it either starts data transmission on the optimal link, or it goes to
the sleep mode to conserve power.
The protocol is self-reconﬁguring since strong connectivity is ensured within each cycle period,
and the minimum power links are dynamically updated. It can be seen that this protocol is also fault
tolerant. A network protocol is ‘fault tolerant’ if it is self-reconﬁguring when nodes leave or new
nodes join the network. Under such a scenario, each node employing the protocol would compute its
new enclosure and ﬁnd the minimum power topology.
15.2.5.1
Mobile network simulation
In this case, the initial positions of 100 nodes are generated as i.i.d. uniform random variables over a
square ﬁeld, 1 km on each side. The velocity in each coordinate direction is uniformly distributed on
the interval (−vmax, vmax). The velocity is the vector sum of the velocities in each coordinate direction.
Parameter vmax is varied to observe how the energy consumption changes.
The choice of the SetSearchRegion function in the search algorithm, which is optimized to perform
the minimum energy neighbor search, is a separate topic. In this simulation, omnidirectional antennas
and an heuristic strategy for the choice of the search radius are assumed. The results indicate that
even with an heuristic strategy, the energy consumption is very low.
Let T be the cycle period of the network. Assume that node i is enclosed in the nth iteration, and
let en be the distance of i to its furthest neighbor in the nth iteration. In the next iteration, if i sets its
search radius to
rn+1 = en + 2
√
2vmaxT
(15.45)
then its neighbors in the nth iteration must fall within this radius. Because the cycle period is small
enough to allow positions to vary only slightly from one iteration to the next, in most cases the node
will have its previous neighbors in its new enclosure as well. Nodes employing this strategy are
enclosed within one iteration of the search algorithm presented earlier in this section.
From a system perspective, the measure of mobility is not the velocities, but rather the displace-
ments of nodes in a cycle period of the network. The maximum displacement of a node in a cycle
period is
√
2vmaxT from the previous analysis.
Figure 15.11 displays the search period power level per node averaged over 10 000 iterations
and averaged over all the nodes. The horizontal axis on this graph is the maximum displacement in
meters. Since the average distance between nodes is about 100 m in this particular simulation, it was
estimated that the network cannot track correct costs for maximum displacements greater than 8 m,
so that power consumption over only this range was graphed.
Figure 15.12 displays the search period power consumption per meter of maximum displace-
ment. The graph indicates that the power consumption per node scales better than linearly with
maximum displacement for the range of displacements for which the network can track the correct
costs.

MINIMUM ENERGY PEER-TO-PEER MOBILE WIRELESS NETWORKS
777
0             1
2              3
4
6
8
0
120
125
130
135
140
145
Maximum displacement per iteration (meters)
Power consumption per node during search (mW)
5
7
9
0
120
125
130
135
140
145
Figure 15.11 Power consumption per node during search period.
0
2
4
6
8
0
20
40
100
140
160
Maximum displacement per iteration (meters)
Power consumption per node per meter during search (mW/meter)
60
80
120
180
1
3
5
7
9
0
20
40
100
140
160
60
80
120
180
Figure 15.12 Power consumption per node per meter of maximum displacement during a
search.

778
ADAPTIVE 4G NETWORKS
15.3
LEAST RESISTANCE ROUTING IN WIRELESS NETWORKS
In the previous section we have already seen that packet radio networks can provide wireless commu-
nication and data distribution among mobile terminals, but adaptive protocols are required in order
for them to do so. Two important characteristics of a communication link in a mobile packet radio
network are its unreliability and its variability. The links in such a network are unreliable because
of fading, interference, noise, and perhaps failure of the transmitting or receiving radios. They are
variable because of the mobility of the radios, the dynamic nature of the propagation medium and
the interference. The interference can be generated externally (e.g. another system operating in the
same frequency band or intentional jamming), or it can be generated within the network (e.g. multiple
access interference).
If a network is to provide reliable service over communication links with these characteristics,
the link and network protocols must adapt to changes in the network. In order to adapt effectively,
these protocols must be provided with information about the current status of certain elements of the
network, such as the communication channels and radio buffers. The mobile networks considered
in this section are multiple hop networks with distributed control, including distributed forwarding
and routing protocols. The presentation is based on [38]. Since there is no central controller or other
entity that can provide status information for all of the network elements, the required information
must be derived by the radios themselves. As in the previous section, the exchange of information is
among neighboring radios (i.e. local exchange rather than global).
15.3.1
Least resistance routing (LRR)
An important feature of lrr is its use of link quality information as a basis for route selection. The
link resistance, which is determined for each link in the network, provides a measure of the noise
and interference in the communication channel and the congestion in the receiving radio. The link
resistance is a quantitative measure of the receiving radio’s ability to demodulate, decode, store and
forward a packet that is transmitted to it on that link.
The metric in LRR speciﬁes how a radio is to calculate the resistance for each of its incoming
links. The probability that a transmission from radio A to radio B is successful depends on both the
condition of the communication channel from A to B and the ability of B to store and forward the
packet. In this section we restrict attention to metrics of the form
LR(A, B) = αI(A, B) + βW(B)
(15.46)
where LR(A, B) is the resistance of the link from radio A to radio B. The term I(A, B) represents the
resistance of the communication channel from A to B and the term W(B) represents the resistance
of radio B. The coefﬁcients α and β are selected to give the desired relative weightings to these two
components of the link resistance,
The resistance of the communication channel accounts for fading, propagation loss and other
features that are unique to transmissions from A to B. The resistance of radio B characterizes the
conditions at radio B that equally affect each of the transmissions to radio B. Included in these
conditions are the number of packets in the radio’s buffer, the amount of trafﬁc near the radio,
interference that equally affects each transmission to radio B, and the expected delay in forwarding
packets. If all packets transmitted to radio B are received at approximately the same power level, any
radio frequency (RF) interference has approximately the same effect on each transmission to radio
B, in which case the interference could be accounted for in the term W(B) only. In practice, however,
the packets may be transmitted at different power levels, and the propagation losses for the different
communication channels to radio B usually differ greatly. Because a given source of RF interference
may have substantially different effects on transmissions to radio B from different radios, it is better
to include the effects of interference in the resistance of the communication channel rather than in
the resistance of the receiving radio.

LEAST RESISTANCE ROUTING IN WIRELESS NETWORKS
779
15.3.2
Multimedia least resistance routing (MLRR)
In MLRR, each link in the network is assigned a link resistance for each of the types of trafﬁc that
it may need to handle. The link resistance can be thought of as a vector with a component for each
different type of trafﬁc. A different metric can be employed for each component in order to provide
a mechanism for accounting for different service requirements for different message types.
In order to simplify the presentation this section will focus on two types of multimedia packet,
type-D packets and type-V packets. The intent is that type-D packets have the characteristics asso-
ciated with data trafﬁc (e.g. computer ﬁle transfers), while type-V packets have the characteristics
associated with voice or video trafﬁc. Type-D packets must be delivered to their destinations with
no errors or erasures; however, a moderate delay is permitted. On the other hand, type-V packets are
required to be delivered with much less delay than type-D packets, but the type-V packets may have
a small number of frame erasures and still be considered acceptable to the destination. In describing
the components of the link resistance, the subscripts d and v are used to distinguish between the link
resistance for the two types of packet. The two components of the link resistance for MLRR are
LRd(A, B) = αdId(A, B) + βdWd(B)
(15.47)
and
LRv(A, B) = αvIv(A, B) + βvWv(B)
(15.48)
In the example used to illustrate MLRR in this section, the importance of the channel resistance
relative to the receiver resistance is determined for each type of trafﬁc from the following
speciﬁcations. A type-D packet is accepted by its destination if all the received words in the packet
are decoded correctly. A type-V packet is accepted by its destination if λ or fewer of the received
words in the packet do not decode correctly.
The selection of the coefﬁcients to provide the proper weighting of the channel resistance and the
radio resistance will be aided by the simulation results, in which the general trends will be observed.
Because type-D packets are more sensitive to errors than to delay, αd is set to a relatively large value
compared to βd. Type-V packets are more sensitive to delay than to errors, however, so βv is set to a
relatively large value compared to αv.
If a received word in a type-V does not decode correctly, that word is erased. If the receiving radio
is not the ﬁnal destination for the packet, the packet is forwarded with the erasure inserted in place of
the missing word. Because of the requirements on type-V packets, any radio along the route discards
any type-V packet that has accumulated more than λ word erasures. The choice for the value of λ,
the maximum number of word erasures that are permitted, depends primarily on the speech or video
compression method.
The packet rejection probability is deﬁned as the probability that a packet with no previous word
erasures is discarded as a result of a single transmission. For frequency-hopping (FH) systems this
probability depends on the code, the modulation and demodulation, the number of other simultaneous
FH transmissions, the number of words per packet and the signal to noise ratio on the channel.
The curves in Figure 15.13 illustrate the sensitivity of the packet reception probability to the
value of λ. In this graph, the packet rejection probability is shown as a function of Eb/N0 for six
different values of λ, where Eb is the energy per information bit and N0 is the one-sided spectral
density for the thermal noise. For convenience, we refer to Eb/N0 as the signal to noise ratio in the
text of this section. For the results given in Figure 15.13, binary orthogonal modulation and optimum
non-coherent demodulation are employed, there are three interfering FH transmissions, a (32, 22)
extended Reed–Solomon code is used, and there are 15 code words per packet.
In general, as discussed in Chapters 2 and 3, one may want to use different modulation techniques
or different combinations of modulation and error control coding for different types of multimedia
trafﬁc. If the modulation or coding is different for different types of packet, the metrics for the
channel resistance may differ also. For the numerical examples presented in this section, the coding
and modulation are the same for both types of packet, and Iv and Id, the metrics used for the channel
resistance, are identical. The metric for each type of message is the errors and erasures (EE) metric,

780
ADAPTIVE 4G NETWORKS
l = 0
l = 1
l = 2
l = 3
l = 8
11
12
13
14
15
Eb/N0 , dB
10
−6
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
Packet rejection probability
l = 4
Figure 15.13 Packet rejection probability for six different values of λ.
and the coefﬁcients αd and αv are adjusted to account for the differences in the requirements for the
two types of packet.
The resistance components for the receiver (i.e. Wd and Wv) are used to represent the delay that
a packet is expected to experience before it is forwarded by a radio that has decoded the packet
successfully. The number of packets waiting in the receiving radio’s buffer is a simple metric for
estimating the expected forwarding delay. The number of type-D packets at a radio is denoted by Nd
and the number of type-V packets is Nv. The receiver resistance components are then deﬁned as
Wd(B) = Nd + ωdNv
and
Wv(B) = Nv + ωvNd.
15.3.3
Network performance examples: LRR versus MLRR
For the numerical examples included in this section, the (32, 22) extended Reed–Solomon code is
employed with errors-and-erasures decoding. There are 15 code words per packet, and the code words
are fully interleaved. Ten test symbols are included in each dwell interval. A type-V packet is accepted
if no more than three words have been erased (i.e. λ = 3).
For both the MLRR and LRR routing protocols, the forwarding protocol gives type-V packets a
higher priority than type-D packets. A radio that is preparing to transmit a packet ﬁrst checks for a
type-V packet in its buffer, and transmits such a packet if possible. If there are no type-V packets in
the buffer, or if none of the type-V packets can be forwarded because of the retransmission policy,
then the radio checks for a type-D packet to transmit.
The service requirements of a packet also affect the number of times a radio may retransmit that
packet. For the results presented here, type-V packets are permitted up to two forwarding attempts at
a given radio, while type-D packets are permitted six attempts at most. To prevent outdated packets
from congesting the network, packets expire and are discarded after a certain number of packet
intervals since they were generated. For the performance curves that follow, this number is 500 for
type-D packets and 50 for type-V packets.

LEAST RESISTANCE ROUTING IN WIRELESS NETWORKS
781
Various combinations of parameters for the MLRR resistance metrics have been examined, and
it was found that the following two metrics perform well over a wide range of network conditions.
For the results presented in this section, the two metrics employed for MLRR are LRd = 2t + e
and LRv = t + 0.5e + Nv + 0.7Nd. The metric employed for LRR is the EE metric, LR = 2t + e.
A word that has no more than e erasures and t errors is decoded correctly if 2t + e does not
exceed n −k.
15.3.3.1
Example 1: Nine-node network
An example of a network with nine radios is illustrated in Figure 15.14 [38]. The signal to noise ratios
for the channels represented by solid lines is 15 dB, which results in a very low error probability on
the channel. The signal to noise ratios for the channels shown with dashed lines are indicated by the
labels on the channels. Both type-D and type-V packets are generated at radio 1 and routed to radio 9.
In a given packet interval, the probability that a marked type-D packet is generated is denoted by qd,
and the probability that a marked type-V packet is generated is denoted by qd. A radio can generate
no more than one packet of each type within a packet interval. Additionally, the interfering type-D
packets are generated at radios 5 and 6 and sent to radios 9 and 1, respectively, and their generation
probability is ﬁxed at 0.05. The inclusion of these interfering packet results in increased congestion
in the upper three routes of the network shown in Figure 15.14.
This simple network topology is selected to illustrate the advantages of using multimedia routing.
The two types of packet generated at radio 1 must be routed to radio 9, but there is not a single route
that is preferred for both types of packet. The upper route has large delays because of the congestion
caused by the extra packets generated at radios 5 and 6. On the other hand, the lower route has poorer
quality channels that give a bit error rate in the range of 1–5 %. Although type-V packets can be
accepted with some word erasures, type-D packets cannot. For a given channel, this difference in
service requirements leads to a larger expected number of retransmissions for type-D packets than
for type-V packets.
Two scenarios are presented that illustrate the value of selecting a route for each packet type rather
than using a single ‘best’ route for all packet types. For the ﬁrst scenario, the generation probability
for type-D packets is ﬁxed at qd = 0.04, and the network performance is evaluated as the generation
probability for type-V packets is increased. This scenario is of particular interest, because it has been
reported that some existing radio networks suffer from severely degraded service in the delivery of
data trafﬁc when voice trafﬁc increases signiﬁcantly in the network. The results of the simulation for
this scenario are shown in Figure 15.15. The results for MLRR are shown as dashed curves, and the
results for LRR are shown as solid curves.
1
2
3
4
5
6
7
8
9
12.5 dB
11.5 dB
12.5 dB
1
2
3
4
5
6
7
8
9
Figure 15.14 Nine-node network.

782
ADAPTIVE 4G NETWORKS
In the second scenario the situation is reversed: the generation probability for type-V packets
is held constant at qv = 0.04, and the generation probability for type-D packets is increased. The
results in Figure 15.16 for this scenario are similar to those discussed above for the ﬁrst scenario. In
particular, the MLRR protocol maintains a high level of throughput and a large end-to-end success
probability for type-V packets, even as the generation probability for type-D packets is increased.
LRR
MLRR
Type-V packets
Type-D packets
0
0.01
0.02
0.03
0.04
0.05
0.06
0
0.01
0.02
0.03
0.04
0.05
Throughput
(a)
Generation probability for type-V packets, qν
0
0.01
0.02
0.03
0.04
0.05
0.06
Generation probability for type-V packets, qν
0.4
0.5
0.6
0.7
0.8
0.9
1
End-to-end word success probability
LRR
MLRR
Type-D packets
Type-V packets
(b)
Figure 15.15 (a) Throughput for qd = 0.04; (b) word success probability for qd = 0.04;
(c) Delay of type-V packets, qd = 0.04.

LEAST RESISTANCE ROUTING IN WIRELESS NETWORKS
783
0
0.01
0.02
0.03
0.04
0.05
0.06
Generation probability qv , for type-V packets
(c)
9
10
11
12
13
14
17
End-to-end delay
LRR
MLRR
15
16
Figure 15.15 (Cont.).
However, for the LRR protocol, the throughput and success probability drop as the type-D trafﬁc
increases in the network. The MLRR protocol gives better performance than the LRR protocol for
all situations depicted in Figure 15.16.
15.3.3.2
Example 2: Twelve-node network
In this case, the MLRR and LRR protocols are used in the 12-node network illustrated in Figure 15.17
[38], in which the number of possible routes and the amount of trafﬁc are larger than in the nine-node
network of Example 1. The 12 radios are connected by communication channels for which the signal
to noise ratios are as labeled in Figure 15.17. Packets of both types have the origin–destination pairs
(5, 6), (6, 5), (7, 8) and (8, 7). Marked type-D packets have generation probability qd = 0.04, and
the generation probability for marked type-V packets is denoted by qv. Radios 1–4 each generate
additional interfering type-D packets with origin-destination pairs (1, 4), (4, 1), (2, 3) and (3, 2). The
generation probability for these interfering packets is ﬁxed at 0.05.
The throughput for each packet type is shown in Figure 15.18(a), and the end-to-end word success
probability is shown in Figure 15.18(b). As qv increases, the throughput for type-D packets declines
rapidly for the LRR protocol, but a higher throughput is maintained by MLRR. Furthermore, the
word success probability for type-D packets is uniformly larger for MLRR than for LRR. For type-V
packets, the MLRR protocol gives higher throughput, as shown in Figure 15.18(a), and larger word
success probabilities, as shown in Figure 15.18(b).
15.3.4
Sensitivity to the number of allowable word erasures
Because the performance of MLRR depends on λ, the number of word erasures that are permitted
in a type-V packet, it is important to examine the sensitivity of the throughput and word success
probability to the value of this parameter. The LRR protocol does not attempt to distinguish between
type-D and type-V packets, so the performance of LRR does not depend signiﬁcantly on the value of

784
ADAPTIVE 4G NETWORKS
λ. To illustrate the dependence of MLRR on the choice of λ, results are presented for the nine-node
network of Example 1.
The generation probability for type-D packets is ﬁxed at qd = 0.04, and the network performance is
evaluated as a function of the generation probability for type-V packets. The results for the nine-node
network of Example 1 are shown in Figure 15.19. We see that the performance of MLRR for type-D
LRR
MLRR
Type-V packets
Type-D packets
0
0.02
0.04
0.06
0.08
0.10
0.12
0
0.01
0.02
0.03
0.04
0.05
Generation probability for type-D packets, qd
(a)
Throughput
0
0.01
0.02
0.03
0.04
0.05
0
0.02
0.04
0.06
0.08
0.10
0.12
Generation probability for type-D packets, qd
(b)
0.2
0.3
0.4
0.5
0.6
0.7
1
End-to-end word success probability
LRR
MLRR
0.8
0.9
Type-V
packets
Type-D
packets
Figure 15.16 (a) Throughput for qv = 0.04; (b) word success probability for qv = 0.04;
(c) delay of type-V packets, qv = 0.04.

LEAST RESISTANCE ROUTING IN WIRELESS NETWORKS
785
LRR
MLRR
0
0.02
0.04
0.06
0.08
0.10
0.12
12
13
14
15
16
17
Generation probability qd, type-D packets
(c)
End-to-end delay
18
Figure 15.16 (Cont.).
1
2
3
4
6
7
8
9
12.5 dB
11.5 dB
15 dB
10
12
11
5
1
2
3
4
6
7
8
9
12.5 dB
11.5 dB
15 dB
10
12
11
5
Figure 15.17 Network of Example 2.
packets is approximately independent of the value of λ, but the performance of MLRR for type-V
packets improves as the number of allowable word erasures is increased. If λ = 0, the performance
for type-V packets is still signiﬁcantly better for MLRR than for LRR, but the performance advantage
obtained from MLRR is even greater if λ = 1 (i.e. a type-V packet is accepted if no more than one
of its words is erased). A small performance increase is obtained as the number of allowable word
erasures is increased from λ = 1 to λ = 2, but additional increases in λ produce no signiﬁcant beneﬁt
for this network. If the number of relays required for the type-V packets is much larger than in the
networks we consider in this section, there may be a signiﬁcant difference in performance if a larger
number of word erasures can be permitted.
More information on the topic can be found in [39–42].

786
ADAPTIVE 4G NETWORKS
LRR
MLRR
0
0.01
0.02
0.03
0.04
0.05
0
0.02
0.04
0.06
0.08
0.10
Generation probability for type-V packets, qv
(a)
Throughput
0.12
Type-D packets
Type-V packets
0.14
0
0
0.02
0.04
0.06
0.08
0.10
0.12
0.14
LRR
MLRR
0
0.01
0.02
0.03
0.04
0.05
0.3
0.4
0.5
0.6
0.7
0.8
Generation probability for type-V packets, qv
(b)
End-to-end success probability
0.9
Type-D packets
Type-V packets
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Figure 15.18 (a) Throughput for qd = 0.04; (b) word success probability for qd = 0.04.
15.4
POWER OPTIMAL ROUTING IN WIRELESS NETWORKS FOR
GUARANTEED TCP LAYER QoS
15.4.1
Constant end-to-end error rate
In this section we consider the case when a packet is transmitted from a source to its destination along
multiple hops, where there is some probability of error per hop that depends on the distance between
the hops and the transmit power. In Section 15.2, the assumption was that if the received power
(signal to noise ratio)Precv ≥γ , where γ is some constant, then the packet is successfully received;
otherwise the packet is lost. The symbol error rate (SER) is a monotonically decreasing function of

POWER OPTIMAL ROUTING IN WIRELESS NETWORKS
787
Precv, therefore, for each hop, Precv can be made large enough that the SER for the hop satisﬁes
SER ≤SER(γ )
(15.49)
Since any transmission will use the minimum amount of power required to meet the necessary error
rate, this means that SER = SER(γ ). Assuming that errors per hop are independent, this implies that
Type-D packets
0
0.02
0.04
0.06
0.08
0.10
0.12
0
Generation probability for type-V packets, qv
(a)
Throughput
Type-V packets
l = 0
l = 1
l = 2, 3
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
Type-D
packets
Type-V
packets
l = 0
l =1
l = 2, 3
0
0.02
0.04
0.06
0.08
0.10
0.12
Generation probability for type-V packets, qv
(b)
1
0.9
0.8
0.7
0.6
0.5
Word success probability
Figure 15.19 (a) Throughput for MLRR with qd = 0.04; (b) end-to-end word success prob-
ability for MLRR with qd = 0.04; (c) end-to-end delay for type-V packets
with qd = 0.04.

788
ADAPTIVE 4G NETWORKS
0
0.02
0.04
0.06
0.08
0.10
0.12
Generation probability for type-V packets, qv
(c)
8
10
12
14
16
18
20
22
End-to-end delay
l = 0
l  = 2, 3
Figure 15.19 (Cont.).
the error seen by the transport control protocol layer (end-to-end error rate) SERe2e is given by
SERe2e = 1 −(1 −SER(γ ))N
(15.50)
where N is the number of hops along the path. SERe2e is monotonically increasing with N.
Instead of using a routing scheme and power cost metric that allows the end-to-end error rate
to increase with hop count, we examine the effect of constraining the end-to-end error rate to be a
constant. This criterion will be referred to as TCP layer power optimal routing.
15.4.2
Optimization problem
The presentation in this section is based on [43]. Let X = (X0, X1, . . . , X N) be an N-hop path
from node X0 to X N that passes through nodes X1, X2,. . . ,X N−1 in that order. Let Pi be the power
allocated for the hop (Xi−1, Xi), and let SERi be the corresponding symbol error rate for the hop
(i = 1, 2, . . . , N). Assuming independent errors per hop, the TCP layer QoS (the end-to-end SER)
is given by
SERe2e = 1 −
N

i=1
(1 −SERi)
(15.51)
We deﬁne the power cost function as follows:
PC∗(ε; X) =
min
P1,...,PN
N

i=1
Pi
given
SERe2e ≤ε
(15.52)
We will assume that we are interested in the case when the quantity ε is much smaller than one, i.e.
when there is a very low probability of error.
A quick analysis shows that the optimization problem in Equation (15.52) leads to equations that
do not have simple closed form solutions in terms of the power per hop and the power cost, even for
the simplest models for the SER. We formulate our approximate power cost metric by the following

POWER OPTIMAL ROUTING IN WIRELESS NETWORKS
789
equations:
PC(ε; X) =
min
P1,...,PN
N

i=1
Pi
given
N

i=1
SERi ≤ε
(15.53)
We can justify this approximation by the following result: assuming ε ≥0 and ε + 4ε2 < 1/
√
2, and
given the power cost metrics PC∗and PC deﬁned by Equations (15.52) and (15.53) respectively, we
have:
PC(ε + 4ε2; X) ≤PC∗(ε; X) ≤PC(ε; X)
(15.54)
The proof of Inequality (15.54) only relies on the power cost metric being a minimization problem
where the error rate constraint is met with equality at the solution. In particular, it does not depend on
the expression for SERi, or the fact that the metric being minimized is the sum of the power per hop.
For the rest of this section, we use PC as the power cost metric because it will lead to analytical
expressions for the power cost of a path. While this is an approximation, Inequality (15.54) provides
a way of bounding the error E(ε; X) = PC(ε; X) −PC∗(ε; X) since
E(ε; X) ≤PC(ε; X) −PC(ε + 4ε2; X)
(15.55)
When we compute the power cost with speciﬁc models for SER, we will use this expression to show
that the approximation error is O(ε), and thus small compared to the power cost of the path.
Error correction mechanisms (both ARQ and FEC) can be easily included in this framework with
minor changes, as discussed in [44].
15.4.3
Error rate models
15.4.3.1
Time-invariant attenuation
The ﬁrst model is a deterministic power model where we assume that the receive power of a
link is attenuated by a time-invariant quantity. This attenuation coefﬁcient can be given a physical
interpretation by setting it to dα /a, where d is the distance between the transmitter and receiver, and
α > 2 and a are constants. We assume that the expression for the SER of a link is given by:
SERi = be−Pi /ai
(15.56)
where Pi is the transmit power and ai is the time-invariant attenuation coefﬁcient of the link. Equation
(15.56) is sufﬁciently parameterized to be able to provide a bound for the probability of error for
most digital modulations that are detected optimally in the presence of additive Gaussian noise [45].
Under the assumptions of Inequality (15.54) and the link SER assumption given by Equation
(15.56), the optimal power cost PC(ε; X) for path X = (X0, X1, . . . , X N) is obtained when
1.
SER j = ε
a j
N
i=1 ai
2.
Pj = a j

log(b/ε) + log
 N

i=1
ai/a j

(15.57)
3.
E(ε; X) ≤log(1 + 4ε)
N

j=1
a j
where a j, SER j, and Pj are the attenuation coefﬁcient, link error rate, and link power allocation,
respectively, for link (X j−1, X j).

790
ADAPTIVE 4G NETWORKS
15.4.3.2
Large- and small-scale fading
In a wireless mobile scenario the received power is affected by many more factors than the mere
distance, and it is common to represent the received power as a doubly stochastic random variable,
with long-term and short-term variations (see Chapter 14). The transmit power is attenuated by two
factors: GL(t) caused by large-scale fading, and GS(t) caused by small-scale fading. To account for
the effects of large- and small-scale fading, the time-varying SER of a link is given by the random
process
SERi = be−aΩτi
(15.58)
where a and b are constants, and Ωτi is the received power, whose statistics are functions of position
and time. As is standard, we assume a log-normal distribution for the large-scale fading coefﬁcient.
For the small-scale fading, several distributions have been introduced [26] and using Equation (15.58),
the corresponding average SER for a given large-scale fading parameter is the characteristic function
of the small-scale fading density. For example, for the Nakagami m-distribution, the expected SERi
for a link is given by [26]:
SERi = b(1 + Pi/ai)−m
(15.59)
where ai is the contribution from the slow-varying large-scale fading coefﬁcient and Pi is the average
transmit power.
The Nakagami m-distribution captures the intermediate ground between strong line-of-sight and
non-line-of-sight systems. Note, in fact, that Rayleigh fading is a special case of Nakagami fading
when m = 1, while the deterministic case is obtained as m →∞.
One can generalize the previous power cost expressions and power optimal routing to these
scenarios.
Under the assumptions of Inequality (15.54) and the link SER assumption given by Equa-
tion (15.59), the optimal power cost PC(ε; X) for path X = (X0, X1, . . . , X N) is obtained when
1.
SER j = ε
am/(m+1)
j
N
i=1 am/(m+1)
i
2.
Pj = a j

(b/ε)1/m
 N

i=1
(ai/a j)m/(m+1)
1/m
−1


(15.60)
3.
E(ε; X) ≤4ε
m (b/ε)1/m


N

j=1
am/(m+1)
i


(m+1)/m
where a j, SER j, and Pj are the large-scale attenuation coefﬁcient, link error rate, and link power
allocation, respectively, for link (X j−1, X j).
15.4.4
Properties of power optimal paths
In this section we discuss some of the consequences of adopting a TSP layer QoS (end-to-end SER)
constraint for power optimization. In particular, we compare these results to the concepts similar to
those discussed in Section 15.2, which assume that the amount of power required for a link (Xi−1, Xi)
is given by
Pi = log(b/ε)dα
i
a
(15.61)
where a and α > 2 are constants, and di = |Xi−1 −Xi| is the distance between points Xi−1 and Xi.
This model assumes that the link SER is constant (= ε), and the attenuation coefﬁcient ai is given by
dα
i /a.

REFERENCES
791
Under this model, the power cost of using a link does not depend on the path under consideration,
unlike the link power allocation in Equations (15.57) and (15.60). The power cost using this model,
which we denote KC(ε; X), is given by
KC(ε; X) = log(b/ε)
N

i=1
dα
i
a = log(b/ε)
N

i=1
αi
(15.62)
where di = |Xi−1 −Xi| is the distance between points Xi−1 and Xi. Note that since ε only appears
in the factor in front of this particular power cost metric, the best path to route a packet according to
KC will not depend on ε. [46].
We compare the properties of power optimal paths obtained by the metric introduced in Equa-
tion (15.57) with those obtained using the metric from Equation (15.62).
15.4.4.1
Comparing power cost metrics
If we use Equation (15.61) to determine the power for a hop, then the SER per hop can be as high
as ε, thereby increasing the total end-to-end SER. The metric KC will therefore underestimate the
amount of power required to transmit a packet along a path with an error that does not exceed ε.
Examining the expressions in Equation (15.57), we conclude that
PC(ε; X) =
N

j=1
a j

log(b/ε) + log
 N

i=1
ai/a j

(15.63)
≥KC(ε; X)
(15.64)
with equality holding if and only if we are considering a one-hop path. If we treat p j = a j/ N
i=1 ai
as a probability distribution, observe that
PC(ε; X) =


N

j=1
a j



log(b/ε) +
N

i=1
pi log 1/pi

(15.65)
≤KC(ε; X)

1 +
log N
log(b/ε)

with equality holding when p1 = p2 = · · · = pN. When examining long paths with equidistant hops,
using a simple additive cost function will underestimate the power cost by a factor that grows
logarithmically with the number of hops compared to a metric that keeps the end-to-end error
bounded.
More details on adaptive routing in wireless networks can be found in [47–74].
REFERENCES
1. Yin, M. and Li, V. O. K., (1990) Unslotted CDMA with Fixed Packet Lengths, IEEE Journal on
Selected Areas in Communications, 8(4), 529–541.
2. Toshimitsu, K., Yamazato, T., Katayama, M. and Ogawa, A. (1994) A Novel Spread Slotted
ALOHA System with CLSP, IEEE Journal on Selected Areas in Communications, 12(4), 665–
672.
3. Sato, T., Okada, H., Yamazato, T., Katayama, M. and Ogawa, A. (1996) Throughput Analysis
of DS/SSMA Unslotted ALOHA System with Fixed Packet Length, IEEE Journal on Selected
Areas in Communications, 14(4), 750–756.

792
ADAPTIVE 4G NETWORKS
4. Phan, V. V. and Glisic, S. (2001) Estimation of Implementation Losses in MAC Protocols in
Wireless CDMA Networks, International Journal on Wireless Information Networks, 8(3), 115–
132.
5. Viterbi, A. J. (1995) Principle of Spread Spectrum Communication, Addison Wesley Inc.
6. Prasad, R. (1996) CDMA for Wireless Personal Communications, Artech House Inc.
7. Steel, R. (1992) Mobile Radio Communications, John Wiley & Sons, Inc. and IEEE Press.
8. Rappaport, T. S. (1996) Wireless Communications Principles & Practice, Prentice–Hall Inc.
9. Glisic, S. (2002) Adaptive WCDMA Theory & Practice, John Wiley & Sons Inc., New York.
10. Chien, C., Srivastava, M. B., Jain, R., Lettieri, P., Aggrawal, V. and Sternowski, R. (1999) Adaptive
Radio for Multimedia Wireless Links, IEEE Journal on Selected Areas in Communications, 17(5),
793–813.
11. Hara, S., Ogino, A., Araki, M., Okada M. and Morinaga, N. (1996) Throughput Performance of
SAW-ARQ Protocol with Adaptive Packet Length in Mobile Packet Data Transmission, IEEE
Transactions on Vehicular Technology, 45(3), 561–569.
12. Lettieri, P. and Srivastava, M. B. (1998) Adaptive frame length control for improving wireless
link range and energy efﬁciency, IEEE InfoCom98, 2, 564–571.
13. Siew, C. K. and Goodman, D. J. (1989) Packet Data Transmission Over Mobile Radio Channels,
IEEE Transactions on Vehicular Technology, 38(2), 95–101.
14. Zorzi, M., Rao, R. R. and Milstein, L. B. (1996) A Markov Model for Block Errors on Fading
Channels, IEEE PIMRC96, 1074–1078.
15. Zorzi, M., Rao, R. R. and Milstein, L. B. (1998) Error Statistics in Data Transmission over Fading
Channel, IEEE Transactions On Communications, 46(11), 1468–1477.
16. Zorzi, M. (1998) Performance of FEC and ARQ Error Control in Bursty Channel under Delay
Constraints, IEEE VTC98, 1390–1394.
17. Pahlavan, K. and Levesque, A. H. (1994) Wireless Data Communications, Proceedings of the
IEEE, Invited Paper, 82(9), 1398–1430.
18. Jakes, W. C. (1995) Microwave Mobile Communications, IEEE Press.
19. Adachi, F., Feeney, M. T. and Parsons, J. D. (1988) Effects of Correlated Fading on Level Crossing
Rates and Average Fade Durations with Predetection Diversity Reception, IEE Proceedings,
135(1), 11–17.
20. Dong, X. and Beaulieu, N. C. (2002) Average Level Crossing Rate and Fade Duration of Maximal
Ratio Diversity in Unbalanced and Correlated Channels, IEEE WCNC02, 2, 762–767.
21. Rice, S. O. (1958) Distribution of the Duration of Fades in Radio Transmissions: Gaussian Noise
Model, Bell Systems Technical Journal, 37, 581–635.
22. Bodtmann, W. F. and Arnold, H. W. (1982) Fade-Duration Statistics of Rayleigh Distributed
Waves, IEEE Transactions On Communications, 30(3), 549–553.
23. Durgin, G. D. and Rappaport, T. S. (1999) Level-Crossing Rates and Average Fade Duration for
Wireless Channels with Spatially Complicated Multipath, IEEE GlobeCom99, pp. 427–431.
24. Turin, W. and Nobelen, R. V. (1998) Hidden Markov Modelling of Flat Fading Channels, IEEE
Journal on Selected Areas in Communications, 16(9), 1809–1817.
25. Zorzi, M., Rao, R. R. and Milstein, L. B. (1995) On the Accuracy of a First-Order Markov Model
for Data Transmission on Fading Channels, IEEE ICUPC95, pp. 211–215.

REFERENCES
793
26. Wang, H. S. and Chang, P. C. (1996) On Verifying the First-Order Markovian Assumption for a
Rayleigh Fading Channel Model, IEEE Transactions on Vehicular Technology, 45(2), 353–357.
27. Tan, C. C. and Beaulieu, N. C. (2000) On First-Order Markov Modelling for the Rayleigh Fading
Channel, IEEE Transactions On Communications, 48(2), 2032–2040.
28. Omnet+ + Discrete Event Simulation Tool, http://www.hit.bme.hu/phd/vargaa/omnetpp.htm.
29. Gross, D. and Harris, C. M. (1998) Fundamentals of Queuing Theory, John Wiley & Sons Inc.,
New York.
30. Ross, K. W. and Tsang, D. H. K. (1989) The Stochastic Knapsack Problem, IEEE Transactions
On Communications, 37(7), 740–747.
31. Gentile, C., Haerri, J. and VanDyck, R. E. (2002) Kinetic minimum-power routing and clustering
in mobile adhoc networks, IEEE 56th Vehicular Technology Conference, 24–28 September 2002,
3, 1328–1332.
32. Rodoplu, V. and Meng, T. H. (1999) Minimum energy mobile wireless networks, IEEE Journal
on Selected Areas in Communications, 17(8), 1333–1344.
33. Shahani, A. R., Schaeffer, D. K. and Lee, T. H. (1997) A 12 mW wide dynamic range CMOS
front-end for a portable GPS receiver, in Proceedings of the IEEE International Solid-State
Circuits Conference February 1997, 40, 368–369.
34. Lynch, N. A. (1996) Distributed Algorithms. Morgan Kaufmann, San Mateo, CA, pp. 51–80.
35. Gray, P. and Meyer, R. (1995) Future directions in silicon ICs for RF personal communications,
in Proceedings of CICC’95, pp. 83–90.
36. Rudell, J. C. et al. (1997) A 1.9-GHz wide-band IF double conversion CMOS receiver for cordless
telephone applications, IEEE Journal on Solid-State Circuits, 32, 2071–2088.
37. Parkingson, B. W. and Spilker, J. J. (1996) Global Positioning System: Theory and Applications
Vol. I. American Institute of Aeronautics and Astronautics, Inc. Washington, DC.
38. Pursley, M. B., Russell, H. B. and Staples, P. E. (1999) Routing for multimedia trafﬁc in wireless
frequency-hop communication networks, IEEE Journal on Selected Areas in Communications,
17(5), 784–792.
39. Pursley, M. B. and Russell, H. B. (1993) Routing in frequency-hop packet radio networks with
partial-band jamming, IEEE Transactions On Communications 41(7), 1117–1124.
40. Pursley, M. B. and Russell, H. B. (1994) Network protocols for frequency-hop packet radios
with decoder side information, IEEE Journal on Selected Areas in Communications, 12(4), 612–
621.
41. Pursley, M. B. and Russell, H. B., (1995) Recognizing and responding to reduced-quality links
in FH packet radio networks, in Proceedings of the 1995 IEEE Military Communications Con-
ference, pp. 75–79.
42. Steenstrup, M. (1995) Routing in Communications Networks. Prentice Hall, Englewood Cliffs,
NJ.
43. Manohar, R. and Scaglione, A. (2003) Power optimal routing in wireless networks, IEEE Inter-
national Conference on Communications (ICC ’03), 4, 2979–2984.
44. Manohar, R. and Scaglione, A. (2003) Power Optimal Routing in Wireless Networks, Cor-
nell Computer Systems Technical Report CSL-TR-2003-1028, January 2003. Available at
http://www.csl.cornell.edu/publications.html.
45. Rappaport, T. (1999) Wireless Communications, Prentice Hall.

794
ADAPTIVE 4G NETWORKS
46. Narayanaswamy, S., Kawadia, V., Sreenivas, R. S. and Kumar, P. R. (2002) Power Control in Ad
Hoc Networks: Theory, Architecture, Algorithm and Implementation of the COMPOW protocol,
Proceedings of European Wireless 2002, Next Generation Wireless Networks: Technologies,
Protocols, Services and Applications, Florence, Italy, 25–28 February, 2002, pp. 156–162.
47. Chang, J.-H. and Tassiulas, L. (2000) Energy conserving routing in wireless ad hoc networks, in
Proceedings of IEEE INFOCOM 2000, 1, 22–31.
48. Hou, T. and Li, V. (1986) Transmission Range Control in Multihop Packet Radio Networks, IEEE
Transactions On Communications, 34(1), 38–44.
49. Sousa, E. S. and Silvester, J. A. (1990) Optimum transmission ranges in a direct-sequence spread-
spectrum multihop packet radio network, IEEE Journal on Selected Areas in Communications,
8(5), 762–771.
50. Jonnavithula, S. and Billinton, R. (1996) Minimum cost analysis of feeder routing in distribution
system planning, IEEE Transactions on Power Delivery, 11(4), 1935–1940.
51. Zadeh, A. N., Jabbari, B., Pickholtz, R. and Vojcic, B. (2002) Self-organizing packet radio ad
hoc networks with overlay (SOPRANO), IEEE Communications Magazine, 40(6), 149–157.
52. Stojmenovic, I. and Datta, S. (2002) Power and cost aware localized routing with guaranteed
delivery in wireless networks, Seventh International Symposium on Computers and Communi-
cations (ISCC 2002), 1–4 July 2002, pp. 31–36.
53. Stojmenovic, I. and Lin, X. (2001) Power-aware localized routing in wireless networks, IEEE
Transactions on Parallel and Distributed Systems, 12(11), 1122–1133.
54. Maleki, M., Dantu, K. and Pedram, M. (2002) Power-aware source routing protocol for mobile
ad hoc networks, Proceedings of the 2002 International Symposium on Low Power Electronics
and Design, (ISLPED ’02), 12–14 August 2002, pp. 72–75.
55. Jung-Hee Ryu and Dong-Ho Cho (2001) A new routing scheme concerning energy conservation
in wireless home ad hoc networks, IEEE Transactions on Consumer Electronics, 47(1), 1–5.
56. Neely, M. J., Modiano, E. and Rohrs, C. E. (2003) Power allocation and routing in multibeam
satellites with time-varying channels, IEEE /ACM Transactions on Networking, 11(1), 138–152.
57. Mitlin, V. (2003) Optimal mac packet size in networks without cut-through routing, IEEE Trans-
actions on Wireless Communications, 2(5), 901–910.
58. Pollini, G. P. and Meier-Hellstern, K. S. (1995) Efﬁcient routing of information between in-
terconnected cellular mobile switching centers, IEEE /ACM Transactions on Networking, 3(6),
765–774.
59. Ramjee, R., La Porta, T. F., Kurose, J. and Towsley, D. (1998) Performance evaluation of
connection rerouting schemes for ATM-based wireless networks, IEEE /ACM Transactions on
Networking, 6(3), 249–261.
60. Bigioi, P., Cucos, A., Corcoran, P., Chahil, C. and Lusted, K. (1999) Transparent, dynamically
conﬁgurable RF network suitable for home automation applications, IEEE Transactions on
Consumer Electronics, 45(3), 474–480.
61. Binh Vien Dao, Duato, J. and Yalamanchili, S. (1999) Dynamically conﬁgurable message ﬂow
control for fault-tolerant routing, IEEE Transactions on Parallel and Distributed Systems, 10(1),
7–22.
62. Stojmenovic, I. and Xu Lin (2001) Loop-free hybrid single-path/ﬂooding routing algorithms
with guaranteed delivery for wireless networks, IEEE Transactions on Parallel and Distributed
Systems, 12(10), 1023–1032.

REFERENCES
795
63. Wong, V. W. S., Lewis, M. E. and Leung, V. C. M. (2001) Stochastic control of path optimization
for inter-switch handoffs in wireless ATM networks, IEEE /ACM Transactions on Networking,
9(3), 336–350.
64. Jung-Hee Ryu and Dong-Ho Cho (2001) A new routing scheme concerning energy conservation
in wireless home ad hoc networks, IEEE Transactions on Consumer Electronics, 47(1), 1–5.
65. Mohorcic, M., Werner, M., Svigelj, A. and Kandus, G. (2002) Adaptive routing for packet-
oriented intersatellite link networks: performance in various trafﬁc scenarios, IEEE Transactions
on Wireless Communications, 1(4), 808–818.
66. Garcia Nocetti, F. and Stojmenovic, I. and Jingyuan Zhang (2002) Addressing and routing in
hexagonal networks with applications for tracking mobile users and connection rerouting in
cellular networks, IEEE Transactions on Parallel and Distributed Systems, 13(9), 963–971.
67. Sunghyun Choi and Shin, K. G. (2002) Adaptive bandwidth reservation and admission control in
QoS-sensitive cellular networks, IEEE Transactions on Parallel and Distributed Systems, 13(9),
882–897.
68. Jie Wu (2002) Extended dominating-set-based routing in ad hoc wireless networks with unidi-
rectional links, IEEE Transactions on Parallel and Distributed Systems, 13(9), 866–881.
69. Schurgers, C., Kulkarni, G. and Srivastava, M. B. (2002) Distributed on-demand address as-
signment in wireless sensor networks, IEEE Transactions on Parallel and Distributed Systems,
13(10), 1056–1065.
70. Agglou, G. and Tafazolli, R. (2002) Determining the optimal conﬁguration for the relative
distance microdiscovery ad hoc routing protocol, IEEE Transactions on Vehicular Technology,
51(2), 354–370.
71. Beraldi, R. and Baldoni, R. (2003) A caching scheme for routing in mobile ad hoc networks and
its application to ZRP, IEEE Transactions on Computers, 52(8), 1051–1062.
72. Duggirala, R., Gupta, R., Qing-An Zeng and Agrawal, D. P. (2003) Performance enhancements of
ad hoc networks with localized route repair, IEEE Transactions on Computers, 52(7), 854–861.
73. Toumpis, S. and Goldsmith, A. J. (2003) Capacity regions for wireless ad hoc networks, IEEE
Transactions on Wireless Communications, 2, 736–748.
74. Jen-Yi Pan, Wei-Tsong Lee and Nen-Fu Huang (2003) Providing multicast short message services
over self-routing mobile cellular backbone network, IEEE Transactions on Vehicular Technology,
52(1), 240–253.


16
Cognitive Networks
and Game Theory
As indicated in Chapter 10, cognitive radio is able to observe the environment and, based on this, make
a number of decisions on its own. A potential problem with using cognitive radios in a network is
their selﬁsh behavior. Therefore, efﬁcient algorithms/protocols are needed to motivate such terminals
to cooperate in the interest of overall social gain. In this chapter we analyse the behavior of such
terminals in wireless networks by using a game theory framework. In the sequel algorithms/protocols
based on cognition, used by these radios, will be referred to as cognitive algorithms/protocols and a
network of cognitive radios coordinating such algorithms/protocols will be referred to as cognitive
network.
16.1
COGNITIVE POWER CONTROL
16.1.1
Noncooperative power control game
As the ﬁrst step, in this section we present a power control solution for wireless data within a game
theoretic framework. In this context, the equivalent quality of service (EQoS) that a wireless terminal
receives is referred to as the utility, and distributed power control is a noncooperative power control
game where users maximize their utility. In addition to the conventional QoS parameters, like BER,
the EQoS incorporates requirements that a given BER = Pe is obtained with minimum power, which
preserves the energy and minimizes the interference inﬂicted on other users. The outcome of the game
results in a Nash equilibrium that is inefﬁcient. By introducing pricing of transmit powers, Pareto
improvement of the noncooperative power control game is obtained.
Assume a single-cell system where each user transmits L information bits in frames (packets) of
M > L bits at a rate R b/s using p W of power. We assume ﬁxed rate R for all terminals. The utility
function suggested in [1–3] can be presented as:
u = L R f (γ )
Mp
bits
joule
f (γ ) = (1 −2Pe)M
(16.1)
Advanced Wireless Communications Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

798
COGNITIVE NETWORKS AND GAME THEORY
where Pe is the BER. Parameter f (γ ) is derived from the probability of correct frame reception with
no coding, Pc = (1 −Pe)M, by modiﬁcation Pe →2Pe so that f (γ ) has maximum value 1 for Pe = 0
and minimum value 0 for Pe = 0.5. Assuming perfect error detection and no error correction, Pe is
given as Q(√2γ )for BPSK, 0.5 exp(−γ )for DPSK, Q(√γ ) for CFSK and 0.5 exp(−γ/2) for NCFSK
in the case of an additive white Gaussian noise (AWGN) channel. In all cases, the BER decreases
monotonically with SIR γ . Therefore, Pe can be expressed as a function of γ and substituted in
Equation (16. 1) to obtain the utility function for a speciﬁc system.
With this in mind, let G = [N , {Pj}, {u j(·)}] denote the noncooperative power control game
(NPG) where N = {1, 2, . . . , N} is the index set for the mobile users currently in the cell, Pj is the
strategy set, and u j (·) is the payoff function of user j. Each user selects a power level p j ∈Pj. Let the
power vector p = (p1, . . . , pN) ∈P denote the outcome of the game in terms of the selected power
by all the users, where P is the set of all power vectors. The resulting utility level for the jth user is
u j (p). In the sequel we will also use notation u j

p j, p−j

where p−j denotes the vector consisting of
elements of p other than the jth element. The latter notation emphasizes that the jth user has control
over its own power, p j, only. The strategy space of all the users excluding the jth user is denoted by
P−j. Now, what the utility user obtains by expending p j can be expressed more formally as:
u j

p j, p−j

= L R
Mp j
f

γ j
 bits
joule
(16.2)
where γ j is the SIR of user j . In CDMA uplink this is deﬁned as:
γ j = W
R
h j p j

j̸=i h j p j + σ 2
(16.3)
where W is the available spread-spectrum bandwidth, σ 2 is the AWGN power at the receiver, and
{h j} is the set of path gains from the mobile to the base station. We assume that the strategy space
Pj of each user is a compact, convex set with minimum and maximum power constraints denoted
by j = 0 and ¯p j, respectively, which results in the strategy space Pj =

0, ¯p j

. The utility function
takes the generic form given in Figure 16.1 for ﬁxed interference.
transmit power
utility
Figure 16.1 Utility versus the user transmit power for ﬁxed interference.

COGNITIVE POWER CONTROL
799
Now, each user maximizes its own utility in a distributed fashion, and the NPG can be expressed
as
(NPG) max
p j ∈Pj u j

p j, p−j

, for all j ∈N,
(16.4)
where u j is given in Equation (16.2) and Pj =

0, ¯p j

is the strategy space of the user. The transmit
power that optimizes individual utility depends on the transmit powers of all the other terminals in the
system. It is necessary to characterize a set of powers where the users are satisﬁed with the utility they
receive given the power selections of other users. Such an operating point is called an equilibrium.
16.1.2
Nash equilibrium
The solution that is most widely used for game theoretic problems is the Nash equilibrium.
A power vector p = (p1, . . . , pN) is a Nash equilibrium of the NPG G = [N, Pj, u j(·)] if, for
every j ∈N, u j(p j, p−j) ≥u j(p′
j, p−j) for all p′
j ∈Pj.
In other words, at a Nash equilibrium, given the power levels of other players, no user can improve
its utility level by making individual changes in its power. The power level chosen by a rational self-
optimizing user constitutes a best response to the powers actually chosen by other players. Formally,
a terminal’s best response r j : P−j →Pj is the correspondence that assigns to each p−j ∈P−j the
set:
r j(p−j) =

p j ∈Pj : u j(p j, p−j) ≥u j(p′
j, p−j) for all p′
j ∈Pj

(16.5)
The Nash equilibrium can be restated as: p = (p1, . . . , pN) is a Nash equilibrium of the NPG
G = [N, {Pj}, {u j(·)}] if and only if p j ∈r j

p−j

for all j ∈N. The Nash equilibrium concept
offers a predictable, stable outcome for a game where multiple agents with conﬂicting interests
compete through self-optimization, and reach a point where no player wishes to deviate. However,
such a point does not necessarily exist. A Nash equilibrium exists in the NPG, G = [N, {Pj}, {u j(·)}].
The rigorous proof can be found in [1–6]. Here we outline only the main logic of the proof.
Nash equilibrium exists in the game G = [N, {Pj}, {u j(·)}] if, for all j = 1, . . . , N, then
(i) Pj is a nonempty, convex, and compact subset of some Euclidean space ℜN.
(ii) u j(p) is continuous in p and quasi-concave in p j.
The proof is completed by showing that the conditions (i) and (ii) are met in NPG.
Each user has a strategy space that is deﬁned by the power values between a minimum and a
maximum power. Thus, the ﬁrst condition is satisﬁed. It remains to be shown that the utility function
u j (p) is quasi-concave in p j for all j in NPG. This has been already indicated by the example in
Figure 16.1. Exact proof can be found in [1–3]
For a differentiable function, the ﬁrst-order necessary optimality condition is given as

∂u j

p j, p−i

/∂p j

= 0. From Equation (16.2), the partial derivative of u j (·) with respect to p j is
∂u j

p j, p−i

∂p j
= L R
Mp2
j

f ′ 
γ j

γ j −f

γ j

(16.6)
where
f ′(γ j) = d f (γ j)/dγ j. For noncoherent FSK, Equation (16.6) gives (M/2)γ je−γ j /2 −
(1 −e−γ j /2) = 0 or
M
2 γ j + 1 = eγ j /2.
(16.7)
resulting in an optimal value γ j = ˜γ that can be derived numerically as a solution of Equation (16.7).
It has the same value for all users, assuming each user operates with the same efﬁciency function. The
second order partial derivative of the utility with respect to the power reveals that this point is a local

800
COGNITIVE NETWORKS AND GAME THEORY
maximum and, therefore, a global maximum. Hence, the utility function of user j is quasi-concave in
p j for all j. This completes the proof of the theorem. It should be emphasized that, although we used
noncoherent FSK as an example in the proof, the results apply to a fairly broad class of modulation
schemes.
16.1.3
Pareto optimality
The Nash equilibrium offers a solution to the power control problem where no terminal can increase
its utility any further through individual effort. Thus, it is an outcome obtained as a result of distributed
decision taking, which could be expected to be less efﬁcient than a possible power allocation obtained
through cooperation between terminals and/or as a result of centralized optimization. It is well known
that in general the Nash equilibria are inefﬁcient [7], [8]. A power allocation is said to be more
efﬁcient (or Pareto dominant) if it is possible to increase the utility of some of the terminals without
hurting any other terminal. A formal deﬁnition is as follows:
A power vector ˆp Pareto dominates another vector p if, for all j ∈N, u j (ˆp) ≥u j (p) and for
some j ∈N, u j (ˆp) > u j (p). In addition, a power vector p∗is Pareto optimal (efﬁcient) if there
exists no other power vector p such that u j(p) ≥u j(p∗) for all j ∈N and u j (p) > u j (p∗) for
some j ∈N.
To show that the NPG equilibrium is inefﬁcient recall that, at the equilibrium of the NPG, there
are two types of terminal: those that achieve ˜γ and those that transmit at maximum power ¯p while
attaining less than ˜γ . Let H denote the index set of terminals that are able to reach ˜γ and ¯H denote
index set for the rest of the terminals.
If at NPG, all j ∈H reduce their powers by a factor of µ (0 < µ ≤1), while j ∈¯H all keep their
powers at ¯p, the utility of user j ∈H with these reduced powers is:
u j (µ) =
L R
Mµp j
f

γ µ
j

(16.8)
where
γ µ
j = W
R
µh j p j

k∈H, k̸= j µhk pk + 
k∈¯H hk ¯p + σ 2 , for all j ∈H
(16.9)
and, the utility of user j ∈¯H with these reduced powers is:
u j (µ) = L R
M ¯p f

γ µ
j

(16.10)
where
γ µ
j = W
R
h j ¯p

k∈¯H, k̸= j hk ¯p + 
k∈H µhk pk + σ 2 , for all j ∈¯H
(16.11)
For the change of µ from 1 to 0, the terminals in the set H, dissipate a power lower than equilibrium
powers. If this decrease in µ results in nondecreasing utilities for all terminals, we have a proof that
there exists an NPG-dominant power vector. For the terminals in the set H, the ﬁrst-order derivative
of utility in Equation (16.8) with respect to µ at the point µ = 1, is:
∂u j (µ)
∂µ
µ=1 = L R
Mp j
×
	
f ′ 
γ j

γ j

k∈¯H hk ¯p + σ 2

k∈H, k̸= j hk pk + 
k∈¯H hk ¯p + σ 2 −f

γ j


(16.12)
For terminal j ∈H, f ′ (γ ) γ = f (γ ) is satisﬁed, giving
∂u j (µ)
∂µ
µ=1 = L R
Mp j
f

γ j

×
	

k∈¯H hk ¯p + σ 2

k∈H, k̸= j hk pk + 
k∈¯H hk ¯p + σ 2 −1

(16.13)

COGNITIVE POWER CONTROL
801
Notice that the above expression has a negative value, i.e. (∂u j(µ)/∂µ)|µ=1 < 0. Therefore, as µ
tends from unity, utilities of the terminals in set H have a tendency to increase. To show that the
terminals in set ¯H also received increased utilities as a result of scaling of powers by µ by the users
in the set, we go back to Equations (16.10) and (16.11).
From these equations we can see that, when terminals in H reduce their powers by µ, the
denominator term in Equation (16.11) decreases. Since the numerator of this term remains the same
(the terminals in H do not change their equilibrium power of p), the SIR increases for a terminal in
H. With an increased SIR, the utility of terminal j ∈H, given in Equation (16.10), increases since
the efﬁciency function is a monotonic increasing function of the SIR and the denominator remains
the same. Thus, we conclude that there exists a µ < 1 where utilities of all terminals increase. Since
at µ < 1, the utilities of all the users increase, by deﬁnition the Nash equilibrium of the NPG is not a
Pareto optimum.
16.1.4
Supermodular games and social optimality
Roughly speaking, social welfare in a cognitive network is deﬁned as the sum of the utilities of
individual users. In the NPG, each terminal aims to maximize its own utility by adjusting its own
power, but it ignores the effects it imposes on other terminals by the interference it generates. The
Pareto optimality deﬁnes the best performance that a terminal can achieve without hurting other users
in the network. The remaining problem is how to motivate the terminals not to behave selﬁshly and
try to beneﬁt further from changing parameters, even if it could hurt other participants in the network.
In this chapter we will discuss this problem on different layers in the network including the network
management plane, especially the problem of radio resource management. In this section we will
address the problem within the NPG game.
The self-optimizing behavior of an individual terminal is said to create an externality when it
degrades the quality for every other terminal in the system. Among the many ways to deal with
externalities, pricing (or taxation) has been used as an effective tool both in economy and in com-
munication networks. In general, pricing is motivated by two different objectives: (i) it generates
revenue for the network, and (ii) it motivates terminals to use system resources more efﬁciently. In
this section, pricing does not refer to monetary incentives, but rather refers to a control signal in
order to motivate users to adopt a social behavior. An efﬁcient pricing mechanism makes decentral-
ized decisions compatible with overall system efﬁciency by motivating efﬁcient sharing of resources
rather than the aggressive competition of the purely noncooperative game. A pricing policy is called
incentive compatible if pricing enforces a Nash equilibrium that improves social welfare.
Various pricing policies are used, such as ﬂatrate, access-based, usage-based, priority-based, etc.
In communications networks, the service provider determines both the pricing policy and the speciﬁc
prices for the use of resources based on the system, the kind of resources it offers, and the type of
demand for these services. An efﬁcient price will accurately reﬂect the costs of usage of a resource
and must take into account the nature of the demand for the offered service. Usage-based pricing
is an approach commonly encountered in the literature. In usage-based pricing, the price a terminal
pays for using the resources is proportional to the amount of resources consumed by the user. In
order to improve the equilibrium utilities of NPG in the Pareto sense, in this section we resort to
usage-based pricing schemes. Through pricing, the system performance is increased by implicitly
inducing cooperation and yet the noncooperative nature of the resulting power control solution is
maintained.
An efﬁcient pricing scheme should be tailored for this problem. Within the context of a resource
allocation problem for a wireless system, the resource being shared is the radio environment and the
resource usage is determined by terminal’s transmit power. It was shown in the previous section that
the decentralized power control game has an equilibrium that is inefﬁcient. We will see that efﬁciency
in power control can be improved by a usage-based pricing strategy where each user pays a penalty
proportional to its transmit power. With the above guidelines for a pricing strategy in mind, we now
discuss a noncooperative game with pricing.

802
COGNITIVE NETWORKS AND GAME THEORY
If Gc = [N, {Pj}, {uc
j(·)}] denotes an N-player noncooperative power control game with pricing
(NPGP), its utilities are deﬁned as:
uc
j (p) = u j (p) −c j

p j, p−j

(16.14)
where c j : P →ℜ1
+ is the pricing function for terminal j ∈N. The multi-objective optimization
problem that NPGP solves is deﬁned as:
(NPGP) max
p j ∈Pj uc
j

p j, p−j

= u j (p) −c j

p j, p−j

, for all j ∈N
(16.15)
For this application we use linear pricing schemes of the form
c j

p j, p−j

= cα j p j
(16.16)
where c, {α j} are positive scalars. The NPGP with linear pricing is:
(NPGP) max
p j ∈Pj u j (p) −cα j p j, for all j ∈N
(16.17)
Nash equilibrium in the NPGP is analysed by tools based on the theory of supermodular games. In a
supermodular power control game, each player’s desire to increase its power results in an increase in
other players’ powers, i.e. the best response of a terminal is a monotone increase in the interferers’
strategy. A formal deﬁnition of a supermodular game can be found in [9, 10]. For the special case of
single dimensional user strategy sets, which are of interest in this section, the deﬁnition simpliﬁes to
the following.
Deﬁnition 1: Consider a generic game G = [N, {Pj}, {u j(·)}] with strategy spaces Pj ⊂R for
all j. G is supermodular if, for each j, u j(p j, p−j) has nondecreasing differences (NDD) in
(p j, p−j).
If the utility of a user has NDD in (p j, p−j), then user j’s marginal utility is nondecreasing in the
transmit powers of interferers, i.e. in response to an increase in the power level of another user,
a terminal increases its transmit power level in order to increase its utility. The NDD property is
formally deﬁned as follows:
Deﬁnition 2: u j(p j, p−j) has NDD in (p j, p−j) if for all p−j ≥p′
−j the quantity u j(p j, p−j) −
u j(p j, p′
−j) is nondecreasing in p j. Equivalently, for continuous and twice differentiable utilities,
u j(p j, p−j) has NDD in (p j, p−j) if and only if (∂2u j(p)/∂p j∂p j) ≥0 for all j ̸= i.
The signiﬁcance of this property is the fact that such utilities lead to a system that can reach a
Nash equilibrium:
Theorem 1: The set of Nash equilibria E of a supermodular game is nonempty [11].
In addition, E has a largest element pL and a smallest element pS. The equilibria p ∈E are located
such that pS ≤p ≤pL; however, it does not mean that all points in that interval are equilibrium
points.
If the utilities of the game under consideration are such that there is a parameter that none of the
users have control over (e.g., price c), we call that parameter an exogenous one. Consider in general
a game with an exogenous parameter, ε, Gε = [N, {Pj}, {uε
j(·)}], with utilities u j(p j, p−j, ε). The
supermodularity deﬁnition for a generic game G given earlier (corresponding to ε = 0) can be readily
extended to the game Gε with an exogenous parameter ε by imposing an additional NDD condition
regarding the parameter.

COGNITIVE POWER CONTROL
803
Deﬁnition 3: A game Gε with an exogenous parameter ε is said to be supermodular, or it is a
parameterized game with complementarities if u j(p j, p−j, ε) has NDD in (p j, p−j) and in (p j, ε)
for all j.
Theorem 2: In a parameterized supermodular game, both pS (ε) and pL (ε) are nondecreasing inε
[11].
For the pricing factor c, NPGP Gc = [N, {Pj}, {uc
j(·)}] is not a supermodular game by deﬁnition.
However, by a proper modiﬁcation of the strategy spaces of users, we can make the resulting game
supermodular. The modiﬁed strategy space for user j denoted by ˆPj is a compact set deﬁned by
ˆPj = [p j, p j], where the smallest power in the strategy set p j is derived from γ j ≥2 ln M, and
γ = 2 ln M corresponds to the point of maximum rate of change of the efﬁciency with increasing
SIR, i.e. (∂2 f (γ )/∂γ 2) = 0. This SIR requirement is based on the condition in Deﬁnition 2 that
(∂2u j(p)/∂pi∂p j) ≥0 for all j ̸= i. This means that, in the modiﬁed strategy space of NPGP described
above, the power levels that yield γ j ≤2 ln M are no longer available to the terminal. The largest
power p j is the maximum power constraint of the system. In the sequel we assume that the modiﬁed
strategy space ˆP is nonempty, i.e. there exists a p j such that 0 < p j ≤p j for all j. The existence of
Nash equilibria in the pricing game is established by the Theorem 3:
Theorem 3: Modiﬁed NPGP ˆGc = [N, { ˆPj}, {uc
j(·)}] with exogenous parameter is a supermodular
game.
To prove it, we test whether the conditions in Deﬁnition 3 are satisﬁed. ˆGc has NDD in (p j, p−j)
since the condition given in Deﬁnition 2 yields the same expression for ˆGc as ˆG. We need only
check whether the utility u j(p j, p−j, c) has NDD in (p j, c). First, perform a change of variables
from c to ε where ε = −c. When we take the partial derivative with respect to both p j and ε, we get
(∂u j/∂pi∂ε) = α j ≥0 for all j. Thus, ˆGc is supermodular.
In the sequel, we illustrate an asynchronous algorithm that generates a sequence of powers that
converges to the smallest Nash equilibrium, pS(c). Suppose that terminal j updates its power at
time instances given by the set Tj = {t j1, t j2, t j3,...} where t jk < t j(k+1) and t j0 = 0 for all j. Deﬁne
T = {τ1, τ2, . . .} as the set of update instances T1 ∪T2 ∪· · · ∪TN sorted in increasing order. Assume
that no two time instances in set T are exactly the same. Let p and p be the smallest and the largest
vectors in modiﬁed strategy space ˆP, respectively.
Algorithm T (Terminal): Consider the noncooperative power control game with pricing (NPGP)
as given in Equation (16.17). Generate a sequence of powers as follows:
(i) Set the initial power vector at time t = 0 : p (0) = p. Also let k = 1.
(ii) For all k such that τk ∈T
(a) For all terminals j ∈N such that τk ∈Tj
(b) Given p (τk−1), compute r j (τk) = arg maxp j ∈ˆPj uc
j

p j, p−j (τk−1)

.
(c) Assign the transmit power as p j (τk) = min

r j (τk)

.
We refer to r j (τk) as the set of best transmit powers for terminal j at time instance k in response to
the interference vector p−j (τk−1). The terminal j optimizes the net utility over the modiﬁed strategy
space of the NPGP, ˆPj, which is bounded by γi ≤2 ln M. Implementation of this lower bound in
the algorithm assumes that the instantaneous SIR at the base station is known by the terminal. The
terminal then uses this information to derive the lower bound on its transmit power. In the game with
pricing, more than one transmit power might constitute a best response to a given interference vector.

804
COGNITIVE NETWORKS AND GAME THEORY
Table 16.1
Single-cell CDMA system parameters
M, total number of bits per frame
80
L, number of information bits per frame
64
W, spread spectrum bandwidth
106 Hz
R, bit rate
104 bits/second
σ 2, AWGN power at receiver
5 × 10−15 watts
Modulation technique
non-coherent FSK
p, maximum power constraint
2 watts
Figure 16.2 Sum of equilibrium utilities in a game with nine terminals versus the pricing
factor c.
In this case, the algorithm determines the transmit power of a terminal by selecting the smallest power
among all possibilities as dictated by the algorithm.
Theorem 4a: Algorithm T converges to a Nash equilibrium of NPGP. Furthermore, it is the smallest
equilibrium, pS (c), in the set of Nash equilibria.
The proof can be found in [12].
For the set of parameters listed in Table 16.1 and nine terminals that are located at d =
[310, 460, 570, 660, 740, 810, 880, 940, 1000] m from the base station, numerical results are shown
in Figure 16.2 and 16.3. Path gains are obtained using the simple path loss model h j = K/d4
j , where
K = 0.097 is a constant. The same set of parameters is used in [12].
The following algorithm is used to ﬁnd optimum c,
Algorithm N (Network):
(i) Set c = 0 and announce c to all terminals.
(ii) Get u j for all j ∈N at equilibrium, increment c := c + c and announce to all terminals.
(iii) If uc
j ≤uc+c
j
for all j ∈N then go to step 2, else stop and declare cBEST = c.

POWER CONTROL GAME WITH QOS GUARANTEE
805
Figure 16.3 Utilities and powers at equilibrium of NPG and NPGP with cBEST = c.
In the previous example we chose the value of c = cBEST that brings maximal Pareto improvement
to the solution from NPG. The connection between a social optimum and a general pricing function
is deﬁned by the following theorems. For the formal proof see [12].
Theorem 4b: A power vector p∗(β) that solves the social problem

Sβ

is Pareto optimal where

Sβ

is deﬁned as:

Sβ

max
p
β · u = max
p
n

i=1
βiui
(16.18)
with β a vector of positive scalars.
Theorem 5: Let p∗(β) solve the social problem

Sβ

. p∗is also a Nash equilibrium for the NPGP
given in Equation (16.15) with pricing function
ci (p) = −(1/βi)
n
j=1, j̸=i β ju j (p) .
(16.19)
16.2
POWER CONTROL GAME WITH QOS GUARANTEE
The objective of the power control in practical wireless systems is to ensure that no mobile’s SIR γi
falls below its target value (threshold) γ tar
i , chosen to ensure adequate QoS, i.e. to maintain:
γi = γ tar
i ,
∀i
(16.20)
where the subscript i indexes the set of mobiles. For the purpose of this section we modify Equation
(16.3) as
γi =
hi pi

j̸=i h j p jci j + ηi
(16.21)
where ci j is the square of the code correlation coefﬁcient. The attenuation is calculated from the
distance ri between the mobile and base station to be hi = A/r α
i in the absence of shadow and fast

806
COGNITIVE NETWORKS AND GAME THEORY
fading. A is a constant gain and α is usually between 3 and 6 (see Chapter 14). This can be further
represented as:
γi =
gii pi
Ii (p−i) =
gii pi

j̸=i gii p j + ηi
(16.22)
Ii (p−i) : =

j̸=i
gii p j + ηi
gij : =

hi,
where j = i
h j

sT
j si
2 ,
otherwise
where si is the code signature of user i and ci j = (sT
j si)2. The power control game is based on
minimization of a cost function that incorporates two conﬂicting requirements. On one hand, the
higher the SIR, the better the service. On the other hand, higher SIR is achieved at the cost of
increased energy consumption and higher interference to signals of other mobiles. So, we deﬁne a
cost function for each user depending on power and SIR. Since some nonzero SIR level is necessary
for accurate communication, we consider the cost of the difference between the actual SIR and the
target SIR that is chosen, based on the estimated FER. To ensure positivity and convexity of the cost
function, we square the SIR error term. So the cost function is deﬁned as:
Ji (pi, γi) = bi pi + ci

γ tar
i
−γi
2
(16.23)
Choosing bi/ci > 1 places more emphasis on power usage whereas bi/ci < 1 places more emphasis
on SIR error. Applying the necessary conditions for a Nash equilibrium, we have
∂Ji
∂pi
= 0 = bi −2ci

γ tar
i
−γi
 ∂γi
∂pi
= bi −2ci

γ tar
i
−γi

gii

j̸=i gi j p j + ηi
.
(16.24)
Recalling that Ii(p−i) := 
j̸=i gi j p j + ηi and rearranging terms, yields:
γi = γ tar
i
−bi Ii (p−i)
2cigii
(16.25)
So, as bi →0 (power expenditure ceases to be important) γi →γ tar
i
and as ci →0 (only power usage
matters and SIR value of negligible importance), γi no longer converges to γ tar
i .
By using γi from Equation (16.22) we can express the required power in terms of given and
measured quantities as:
pi = γ tar
i
gii
Ii (p−i) −bi I 2
i (p−i)
2cig2
ii
(16.26)
By using the interference from Equation (16.22) in (16.25) and evaluating at the Nash equilibrium,
we have:
γ ∗
i =

γ tar
i
−
bi
2ci gii
 gii p∗
i
γ ∗
i

,
if this quantity is nonnegative
0,
otherwise
(16.27)
This yields an expression for the Nash equilibrium power p∗
i in terms of the cost weighting coefﬁcients,
the target SIR, and the Nash equilibrium SIR γ ∗
i , namely:
p∗
i = 2ci
bi
γ ∗
i

γ tar
i
−γ ∗
i

(16.28)
As expected, the Nash (noncooperative) equilibrium has SIR γ ∗
i less than γ tar
i . When mobiles cooper-
ate, and the power balancing algorithm (bi = 0) is used, the target SIR, if feasible, will be reached by
all mobiles. As a quadratic equation in Ii (p−i), for given values of gii, γ tar
i
and pi, Equation (16.26)

POWER CONTROL GAME WITH QOS GUARANTEE
807
has a real solution Ii (p−i), if and only if:
pi ≤ci

γ tar
i
2
2bi
.
(16.29)
So, if we wish to use the entire range of powers 0 ≤pi ≤pmax
i
, we must choose bi and ci to satisfy
bi
ci
≤

γ tar
i
2
2pmax
i
(16.30)
An iterative numerical algorithm for solving Equation (16.26) is given as:
p(k+1)
i
=



γ tar
i
gii I (k)
i
−bi
2ci

I (k)
i
gii
2
,
if positive
0,
otherwise
(16.31)
where I (k)
i
is the measured interference experienced by the ith mobile at the kth step of the algorithm.
In order to analyze its convergence, we rewrite the power update algorithm by using I (k)
i
from:
γ (k)
i
= gii p(k)
i /I (k)
i
resulting in
fi

p(k)
i

:= p(k+1)
i
=



γ tar
i

p(k)
i
γ (k)
i

−bi
2ci

p(k)
i
γ (k)
i
2
,
if deﬁned, positive
0,
otherwise
(16.32)
Yates [13] showed that, if a ﬁxed point of the algorithm p(k+1) = f (p(k)) exists and if the function
f satisﬁes three properties (positivity f (p) > 0, monotonicity p > p′ ⇒f (p) > f (p′), and scal-
ability f (αp) < αf (p) ∀α > 1), then the algorithm converges to the ﬁxed point, which is unique.
Reference [14] shows that positivity and monotonicity of f impose constraints on acceptable values
of Ii, but scalability restricts the allowable receiver noise power level and generates a limit weaker
than that required for monotonicity. By dropping the index (k) for simplicity from Equation (16.31),
we see that, in terms of the observed interference, positivity requires
Ii < 2cigiiγ tar
i
bi
, ∀i ∈{1, 2, . . . , N}
(16.33)
By using notation qi := 
j̸=i
gi j p j; q′
i := 
j̸=i
gi j p′
j and Equation (16.22), we have:
fi(p) −fi(p′) = γ tar
gii
(qi −q′
i) −
bi
2cig2
ii

q2
i −

q′
i
2 + 2ηi

qi −q′
i

=
γ tar
i
gii
−biηi
cig2
ii
 
qi −q′
i

−
bi
2cig2
ii

qi + q′
i
 
qi −q′
i

(16.34)
Accordingly, we need:
ciγ tar
i gii
bi
≥ηi + 1
2

j̸=i
gi j

p j + p′
j

(16.35)
or, noting that p j ≥p′
j, ∀j ⇒Ii (p) ≥Ii (p′), we see that a sufﬁcient condition for monotonicity is:
Ii (p) ≤ciγ tar
i gii
bi
,
∀i ∈{1, 2, . . . , N}
(16.36)
To discuss scalability, we start again from Equation (16.31), obtaining:
αfi (p) −fi (αp) = γ tar
i
gii
(α −1) ηi −
bi
2cig2
ii

α −α2
q2
i + (α −1) η2
i

= (α −1) bi
cigii
ciγ tar
i ηi
bi
−η2
i
2gii
+
α
2gii
q2
i

(16.37)

808
COGNITIVE NETWORKS AND GAME THEORY
From Equation (16.22) we have:


j̸=i
gi j p j


2
= (Ii −η)2 = I 2
i −2ηi


j̸=i
gi j p j

−η2
i
(16.38)
and using this in Equation (16.37) we have:
αfi (p) −fi (αp) = (α −1) bi
cigii
×
ciγ tar
i ηi
bi
−η2
i
2gii
+
α
2gii

I 2
i −2ηiqi −η2
i

(16.39)
Since the ﬁrst factor on the right-hand side is always positive for α > 1, we need only consider the
second factor for all α > 1. The condition for scalability now reduces to:
2cigiiγ tar
i ηi
bi
+ I 2
i > 2ηi


j̸=i
gi j p j

+ 2η2
i = 2ηi Ii
(16.40)
which is equivalent to (Ii −ηi)2 +
2ci gii γ tar
i
ηi
bi
−η2
i > 0 or, since η > 1,
ηi < 2cigiiγ tar
i
bi
, ∀i ∈{1, 2, . . . , N}
(16.41)
is a sufﬁcient condition for scalability. Since the scalability condition does not restrict the allowable
interference but rather the allowable noise power, and since ηi < Ii by deﬁnition, this sufﬁcient
condition is weaker than the earlier condition & Equation (16.33) for positivity. Also, since ηi is
necessarily at most Ii, we see that the condition in Equation (16.41) is weaker than the condition
in Equation (16.36), previously derived for monotonicity. Thus, the algorithm deﬁned by Equations
(16.31) or (16.32), converges to the unique ﬁxed point deﬁned by Equation (16.26), if it exists, under
the conditions deﬁned by Equations (16.36) and (16.29).
The condition in Equation (16.29) can be written in an equivalent form (since SIR must be non-
negative) as γ tar
i
≥√2bi pi/ci. Assuming bi = ci = 1, we have the very simple limiting conditions,
Ii < giiγ tar
i , pi < 0.5γ tar
i
and γ tar
i
≥√2pi, that must be satisﬁed to assure convergence to the unique
Nash equilibrium.
The existence of a Nash equilibrium is established by using the implicit function theorem (see,
for example [15, p. 128]). Using Equation (16.22) in (16.26), the considered system of algebraic
equations is given by:
0 = −pi + γ tar
i
gii


j̸=i
gi j p j + ηi

−
bi
2cig2
ii


j̸=i
gi j p j + ηi


2
(16.42)
= Fi

pi, p−i, gii, gi j, g2
i j, bi, ci, ηi

; i, j = 1, 2, . . . , N, i ̸= j
According to the implicit function theorem, the Jacobian matrix (the matrix of partial derivatives
∂Fi/∂p j) must be nonsingular at the point of existence. In the case of power balancing, the corre-
sponding algebraic equations are represented by the ﬁrst two terms on the right-hand side of the above
formula, so that the corresponding Jacobian matrix has −1 on the main diagonal and γ tar
i gi j/γii out-
side the main diagonal. When this Jacobian matrix is nonsingular, then the power balancing solution
exists. (It is customary in power control literature to say that the solution is feasible, that is, existence
and feasibility have the same meaning.)
By referring to the above algorithm as a Nash algorithm, Figure 16.4 compares its performance
with a power balancing (PB) algorithm. The traces represent the average SIR and power values over
the set of mobiles considered. It is apparent that, with a slight sacriﬁce of achieved SIR, a signiﬁcant
decrease in power is achieved. However, with a large number of users, the achievable power balancing
SIR and the Nash equilibrium SIR are decreased signiﬁcantly. Accordingly, dropping some mobiles

POWER CONTROL GAME AND MULTIUSER DETECTION
809
3
3,5
4
4,5
5
20
25
30
35
Number of mobiles
SIR
0
100
200
300
400
20
25
30
35
Number of Mobiles
Power (mW)
Figure 16.4 Average performance comparison of Nash and power balancing algorithms
versus number of users with a target SIR of 5, b = 0.05 (mW)−1, and c = 1.
whose SIR fell below the minimum acceptable SIR value would be necessary to achieve QoS targets
in practice.
16.3
POWER CONTROL GAME AND MULTIUSER DETECTION
In this section we discuss how the concept of a power control game as described in Section 16.1
works in advanced wireless CDMA networks as using multiuser detectors. A CDMA signal is based
on using BPSK modulation so that Equation (16.1) gives fs (γk) = (1 −Q(√2γk))M, where Q (·)
is the complementary cumulative distribution function of a standard normal random variable. As in
Chapter 5, the signal received by the uplink receiver (after chip-matched ﬁltering) sampled at the chip
rate over one symbol duration can be expressed as:
r =
K

k=1
√pkhkbksk + w
(16.43)
where pk, hk, bk, and sk are the transmit power, channel coefﬁcient, transmitted bit, and spreading
signature sequence of the kth user, respectively, and w is the noise vector, which is assumed to be
Gaussian with mean 0 and covariance σ 2 I. We will represent the linear uplink receiver of the kth
user by a coefﬁcient vector, ck. The output of this receiver can be written as:
yk = cT
k r = √pkhkbkcT
k sk +

j̸=k
√p jh jb jcT
k s j + cT
k w.
(16.44)
and the SINR of the kth user at the output of its receiver is:
γk =
pkh2
k

cT
k sk
2
σ 2cT
k ck + 
j̸=k p jh2
j

cT
k s j
2 .
(16.45)
Here, we discuss a noncooperative game in which each user seeks to maximize its own utility by
choosing its transmit power and the receive ﬁlter coefﬁcients. By picking a particular receiver, the
power-control game reduces to maximizing Equation (16.1), which we reproduce here for convenience
as:
max
pk
= f (γk)
pk
for k = 1, . . . , K.
(16.46)
The relationship between the achieved SINR and transmit power depends on the particular choice of
the receiver. A necessary condition for Nash equilibrium ∂uk/∂pk = 0, deﬁned by Equation (16.6) is
also reproduced here, i.e.:
pk
∂γk
∂pk
f ′ (γk) −f (γk) = 0
(16.47)

810
COGNITIVE NETWORKS AND GAME THEORY
We now examine this condition for the three detectors. For the conventional MF, we have ck = sk and
hence
γ MF
k
=
pkh2
k
σ 2 + 
j̸=k p jh2
j

sT
k , s j
2 .
(16.48)
For the decorelator (DE), we have C = [c1 · · · cK] = S

ST S
−1 (for K ≤N), where S = [s1 · · · sK].
Hence:
γ DE
k
=
pkh2
k
σ 2cT
k ck
(16.49)
The ﬁlter coefﬁcients for the MMSE receiver are given by:
ck =
√pkhk
1 + pkh2
k

sT
k A−1
k sk
A−1
k sk
(up to a scaling factor), where Ak = 
j̸=k p jh2
js jsT
j + σ 2I, which gives:
γ MMSE
k
= pkh2
k

sT
k A−1
k sk

.
(16.50)
As in Section 16.1, for all three receivers, we have
∂γk
∂pk
= γk
pk
.
(16.51)
and maximizing the utility function for each user is equivalent to ﬁnding γ ∗, that is the solution to
f (γ ) = γ f ′ (γ )
(16.52)
In the asymptotic case where K, N →∞and K/N →α < ∞, SINR expressions are independent
of the spreading sequences of the users and are approximately given by [17]:
γ MF
k
=
pkh2
k
σ 2 + 1
N

j̸=k p jh2
j
(16.53)
γ DE
k
= pkh2
k (1 −α)
σ 2
for α < 1
(16.54)
γ MMSE
k
=
pkh2
k
σ 2 + 1
N

j̸=k I

p jh2
j, pkh2
k, γ MMSE
k

(16.55)
where I (a, b, c) =
ab
b+ac. It is clear that both γ MF
k
and γ DE
k
satisfy ∂γk/∂pk = γk/pk. It can also
be veriﬁed that any γk which satisﬁes ∂γk/∂pk = γk/pk is a solution to Equation (16.55). As a
result, ﬁnding the solution to power control in large systems is equivalent to ﬁnding the solution
of f (γ ) = γ f ′ (γ ), independent of the type of the receiver used. The minimum power solution for
achieving γ ∗by all users is given by:
pMF
k
= 1
h2
k
γ ∗σ 2
1 −αγ ∗for α < 1
γ ∗
pDE
k
= 1
h2
k
γ ∗σ 2
1 −α for α < 1
pMMSE
k
= 1
h2
k
γ ∗σ 2
1 −α
γ ∗
1+γ ∗
for α < 1 + 1
γ ∗
(16.56)
Combining (16.56) with uk =
L
M R
f(γ ∗)
pk
, we obtain:
uk = L R f (γ ∗) h2
k
Mγ ∗σ 2

(16.57)

POWER CONTROL GAME IN MIMO SYSTEMS
811
where 
 is given as

MF = 1 −αγ ∗for α < 1
γ ∗

DE = 1 −α for α < 1

MMSE = 1 −α
γ ∗
1 + γ ∗for α < 1 + 1
γ ∗
(16.58)
It can be seen that uMMSE
k
≥uDE
k
and uMMSE
k
≥uMF
k , which conﬁrms our expectation that the MMSE
receiver achieves the maximum utility among all linear receivers. The utility achieved by the DE is
higher than that of the MF except when γ ∗< 1 (=0 dB).
For the social optimum deﬁned by Equation (16.8) , we consider the case of equal output SINRs
among all users (i.e., SINR balancing). This ensures fairness among users in terms of throughput and
delay. We also assume that β1 = · · · = βk = 1, which means that we are interested in maximizing
the sum of users’ utilities. Therefore, the maximization in Equation (16.8) can be written as:
max
p1,...,pk f (γ )
K

k=1
1
pk
(16.59)
Equal output SINRs among users is achieved with minimum power consumption when the received
powers are the same for all users, i.e. p1h2
1 = p2h2
2 = · · · = pK h2
K = q, where:
qMF (γ ) =
γ σ 2
1 −αγ for α < 1
γ
qDE (γ ) = γ σ 2
1 −α for α < 1
qMMSE (γ ) =
γ σ 2
1 −α
γ
1+γ
for α < 1 + 1
γ
(16.60)
So, the maximization in (16.59) can equivalently be expressed as:
max
γ
f (γ )
q (γ )
K

k=1
h2
k
(16.61)
The solution to (16.61) must satisfy
∂
∂γ

f (γ )
q(γ )

= 0. Using this fact in Equation (16.60) gives us the
equations that must be satisﬁed by the solution to the maximization problem in (16.61) for the three
linear receivers
MF: f (γ ) = γ (1 −αγ ) f ′ (γ )
DE: f (γ ) = γ f ′ (γ )
MMSE: f (γ ) = γ

1 −
αγ
(1 + γ )2 −αγ 2

f ′ (γ )
(16.62)
16.4
POWER CONTROL GAME IN MIMO SYSTEMS
For the system where each mobile user terminal has one transmit antenna, and there are m receive
antennas at the uplink receiver (BS), the received signal (after chip-matched ﬁltering and chip-rate
sampling) can be represented as an N × m matrix R, where the lthcolumn represents the N chips
received at the lth antenna, i.e.
R =
K

k=1
√pkbkskhT
k + W
(16.63)

812
COGNITIVE NETWORKS AND GAME THEORY
where pk, bk, and sk are the transmit power, transmitted bit, and spreading sequence of the kth user,
respectively. hk = [hk1 · · · hkm]T represents the gain vector in which hk1, . . . , hkm are the channel
gains from the transmitter of the kth user to the m receive antennas, and are assumed to be i.i.d.
In Equation (16.63), W is the noise matrix. The noise is assumed Gaussian and both spatially and
temporally white. Let Ck be the N × m coefﬁcient matrix for the spatial–temporal ﬁlter of the kth
user at the base station that performs linear spatial and temporal processing on the received signal.
The output of this receiver can be written as:
yk = tr

CT
j R

(16.64)
where tr (A) is the trace of A. Now, the resulting noncooperative game, in which users in the network
are allowed to choose their uplink linear spatial–temporal receivers, as well as their transmit powers,
can be expressed as the following maximization problem:
max
pk,Ck uk (pk, Ck) for k = 1, . . . , K
(16.65)
This maximization can equivalently be expressed as:
max
pk,¯ck uk (pk, ¯ck)
for k = 1, . . . , K
(16.66)
where ¯ck is a vector with mN elements. It is obtained by stacking the columns of Ck on top of each
other. To see this, notice that yk in Equation (16.64) can be alternatively written as yk = ¯cT
k ¯r where
¯r is a vector obtained by placing columns of R on top of each other, i.e.
¯r =
K

k=1
√pkbk¯sk + ¯w
(16.67)
where ¯sk = [hk1sT
k . . . hkmsT
k ]T is the effective signature and ¯w is the noise vector consisting of
columns of W stacked on top of each other.
By using the analogy with the previous derivation in this section we have as a main results:
r The MMSE receiver, whose coefﬁcients are given by
¯ck =
√pk
1 + pk
¯sT
k ¯A−1
k ¯sk
 ¯A−1
k ¯sk
(16.68)
achieves the maximum utility among all linear receivers.
where, ¯Ak =

j̸=k p j¯s j¯sT
j + σ 2I.
r Given the MMSE receiver coefﬁcients, maximizing the utility function for each user is again
equivalent to ﬁnding the solution γ ∗to f (γ ) = γ f ′ (γ ).
r Nash equilibrium is reached when all user terminals use the MMSE detector for their uplink
receivers, and transmit at a power level that results in a SINR equal to γ ∗(SINR-balancing). This
equilibrium is unique.
To compare the three different types of receivers we assume that:
(i) The MF has perfect knowledge of the channel gains of the desired user, but know only the
statistics of the fading levels of the interferers. It basically performs dispreading at each receive
antenna, and then applies maximal ratio combining (MRC).
(ii) The decorrelating detector is assumed to have perfect knowledge of the channel gains for the
desired user, but no knowledge about the interferers (except for their spreading sequences). It
applies a DE at each receive antenna, and then performs MRC.
(iii) The MMSE detector is assumed to have perfect knowledge of the channel gains of all users. The
ﬁlter coefﬁcients for the MMSE receiver are given by Equation (16.68).

GAME THEORY BASED MAC FOR AD HOC NETWORKS
813
We can show that for all three receivers, we have again:
∂γk
∂pk
= γk
pk
.
(16.69)
Therefore, maximizing the utility function for each user is again equivalent to ﬁnding γ ∗that is the
solution to f (γ ) = γ f ′ (γ ).
Using a large-system analysis similar to the one presented in the previous section , the achieved
utility for user can be expressed as:
uk = L R f (γ ∗) ¯h2
k
Mγ ∗σ 2
¯
(16.70)
where ¯
 for different receivers is given as
¯
MF = 1 −¯αγ ∗for ¯α < 1
γ ∗
¯
DE = 1 −α for α < 1
¯
MMSE = 1 −¯α
γ ∗
1 + γ ∗
for
¯α < 1 + 1
γ ∗
(16.71)
with ¯α = α/m and ¯h2
k = m
l=1 h2
kl. One can see that for the case of the MF and the MMSE detector,
using more antennas at the receiver provides both power pooling (through ¯hk) and interference reduc-
tion (through ¯α). This means that the system behaves like a single-antenna system with processing
gain mN and received power equal to the sum of the received powers at the individual antennas.
The DE, on the other hand, beneﬁts only from power pooling, and there is no pooling of the degrees
of freedom (DOFs). This is because the decorrelating detector has no knowledge about the channel
gains for the interferers. Therefore, each interferer effectively occupies m DOFs .
We now pose admission control as a maximization problem in which the load in the network (i.e.,
α) is chosen such that the total utility in the network (per DOF) is maximized:
α∗= arg max
α
1
N
K

k=1
uk
(16.72)
Given (16.57), as K, N →∞we can use the law of large numbers to write:
α∗= arg max
α
α L R f (γ ∗)
Mγ ∗σ 2 
E

h2
(16.73)
which is equivalent to:
α∗= arg max
α
α
.
(16.74)
To ﬁnd α∗, we set ∂(∂α)/α
 = 0 and solve for given (16.58), we have
α∗
MF =
1
2γ ∗;
α∗
DE = 1
2;
α∗
MMSE = 1
2 +
1
2γ ∗.
(16.75)
16.5
GAME THEORY BASED MAC FOR AD HOC NETWORKS
Designing a MAC protocol can be modelled as a bandwidth allocation problem at the link layer. When
considering link layer ﬂows, contention relations between links in a wireless ad-hoc network can be
represented by a link conﬂict graph. In such a graph, vertices represent link ﬂows and edges between
vertices denote contention between links, which is the situation where there is interference between
either the sender or the receiver of one link and either the sender or the receiver of the other link. A
fully connected subgraph in a conﬂict graph is referred to as a clique, and a maximal clique is a clique
not contained in any larger clique. Therefore, a maximal clique represents a ’channel resource’, which
has a given ﬁxed capacity. The basic requirement for feasibility of a schedule or bandwidth assignment
is that the total ﬂowrate in each clique does not exceed the clique’s capacity, subject to the conﬂict

814
COGNITIVE NETWORKS AND GAME THEORY
constraints. In addition, the bandwidth allocation should satisfy some performance requirement such
as fairness. Assuming all nodes of the ad-hoc network use omnidirectional antennas with the same
power level to transmit packets in the same shared wireless channel, a link conﬂict graph can be
used to describe the contention relations between link ﬂows, and each maximal clique is treated as a
’channel resource’ with a given ﬁxed capacity. The capacity of a clique depends on the topology of
the network, and the fairness principle under consideration.
Given conﬂict graph G, let the ﬂow rate of a speciﬁc link i be xi. Deﬁne f (xi) to be a strictly
concave utility function for link i when its ﬂow rate is xi, let Q (i) be the set of cliques that include
link i, and S ( j) be the set of links that form clique j. The fair bandwidth allocation problem can be
formulated as a constrained maximization problem p as follows:
p :
max
xi

i
wi fi (xi),
xi ≥0, i = 1, . . . , N
subject to:

i∈S( j)
xi ≤c j,
j = 1, . . . , M
(16.76)
where c j denotes the capacity of clique j, N is the number of links, and M is the number of maximal
cliques in the link conﬂict graph. Although the objective function is separable inxi, solving this
problem requires coordination of, possibly, all links in the network, which is not practical in ad-hoc
networks.
By considering the dual of problem p, a distributed algorithm based on the cooperative game
framework (CGF) can be derived . As discussed in Section 16.2, the CGF algorithm is a price based
algorithm. That is, in clique j, when the total ﬂow rate is 
i∈S( j) xi, the price rate is λ j. From the
viewpoint of link i, for a ﬁxed value of λ j, the optimal ﬂow rate can be computed by solving the
following problem:
max
xi
	
wi fi (xi) −xi

j∈Q(i)
λ j

.
(16.77)
Since fi (xi) is strictly concave, the unique maximizer for problem exists and is given by:
x∗
i = f ′−1
i

j∈Q(i) λ j
wi

(16.78)
The CGF algorithm can be summarized as:
CGF based MAC algorithm
The algorithm is executed by each link i (the sender node in a link) round by round:
(i) initially, choose a feasible ﬂow rate xi (0);
(ii) collect local conﬂict information and construct local set of cliques Q (i);
(iii) set initial price λ j (0) (global parameter) for each clique j in Q (i);
(iv) in round k, calculate a new link ﬂowrate xi (k) according to (3);
(v) disseminate (cooperation) the new ﬂow rate information to all links in one hop;
(vi) in round k + 1, calculate a new price λ j (k + 1) for clique j as
λ j (k + 1) = max

0, λ j (k) + γ


i∈S( j)
x∗
i −c j




(16.79)
where γ is a step size, c j is the capacity of clique j, 
i∈S( j) x∗
i is the total ﬂow rate in clique
j in the previous round k;
(vii) if the local conﬂict graph has changed (e.g., due to mobility), go back to (ii), otherwise go
back to step (iv).

TIT-FOR-TAT (TFT) GAME THEORY BASED PACKET
815
Intuitively, Equation (16.79) implies the basic requirement of supply and demand: if the total offered
ﬂowrate is less (or more) than the capacity of the clique, the price decreases (or increases respectively).
Deﬁne ¯Q = maxi∈|Q (i)| as the largest number of cliques that contain the same link. Denote
¯S = max j∈|S ( j)| as the maximal size of a clique. Let ¯α be the upper bound of function −f ′′ (x),
then the range of the step size can be deﬁned as in [18]:
0 < γ <
2
¯α ¯Q ¯S
(16.80)
The CGF algorithm depends on the availability of local link contention relations and their ﬂowrate
information. Therefore, collecting such information in a dynamic environment is the key issue to the
design and implementation of the algorithm.
16.6
TIT-FOR-TAT (TFT) GAME THEORY BASED PACKET FORWARDING
STRATEGIES IN AD HOC NETWORKS
16.6.1
Strategy models
In self-organizing ad-hoc networks, all the networking functions rely on the cooperation between
the participants. As a basic example, nodes have to forward packets for each other in order to
enable multihop communication. So, the operation of ad-hoc networks relies on the contribution of
nodes. In general, there are two approaches to motivate nodes to cooperate: (i) by denying service to
misbehaving nodes by means of a reputation mechanism, or (ii) by remunerating (awarding) honest
nodes, using for example a micropayment scheme.
Most of the studies that consider cooperation of entities use the iterated prisoner’s dilemma (IPD)
game as their underlying model [20–22]. The simplicity of the IPD makes it an attractive model. The
continuous valued prisoner’s dilemma (CPD) game was studied by Wahl and Nowak [23]. In such a
game, the nodes can choose a degree of cooperation between full cooperation and full defection. In
[20], Axelrod identiﬁes tit-for-tat (TFT) as a robust strategy that performs surprisingly well (in terms
of maximizing the player’s payoff) in the prisoner’s dilemma games. TFT begins with cooperation in
the ﬁrst round and then repeats the previous move of the other player. We will see that cooperation
based on TFT exists also in the ad-hoc networking context. The above games will be elaborated in
detail later in this chapter for different applications. The classical prisoner’s dilemma game is not
appropriate for modelling packet forwarding because it involves only two players having symmetric
roles. Hence, in this section, we deﬁne a multiplayer, asymmetric game that is inspired by the classical
prisoner’s dilemma game, which better suits our purposes [19].
Let us consider an ad-hoc network with set of all nodes Nof sizen. Two nodes are said to be
neighbors if they reside within the power range of each other. The neighbor relationship between
the nodes is presented with an undirected connectivity graph. Each vertex of the connectivity graph
corresponds to a node in the network, and two vertices are connected with an edge if the corresponding
nodes are neighbors.
Communication between two nonneighboring nodes is based on multihop relaying. This means
that packets from the source to the destination are forwarded by intermediate nodes. For a given
source and destination, the intermediate nodes are those that form the shortest path between the
source and the destination in the connectivity graph. Such a chain of nodes (including the source and
the destination) is referred to as a route, and the operation of the network will be referred to as a
forwarding game.
In each time slot t, each node i chooses a cooperation level pi (t) ∈[0, 1], where 0 and 1 represent
full defection and full cooperation, respectively. Defection means that the node does not forward
trafﬁc for the beneﬁt of other nodes, whereas cooperation means that it does. Thus, pi (t) represents
the fraction of the trafﬁc routed through i in t that i actually forwards. In this model i has a same
cooperation level pi (t)for every route in which it is involved as a forwarder. Having a different
cooperation level for different routes would require identifying the source–destination pairs that
would increase the computation at the nodes signiﬁcantly.

816
COGNITIVE NETWORKS AND GAME THEORY
Let us assume that in time slot t a route r exists with source node s and l intermediate
nodes f1, f2, . . . , fl. If Ts (r) is the constant amount of trafﬁc that s wants to send on r in each
time slot, then the throughput τ (r, t) for s on r in t is deﬁned as the fraction of the trafﬁc sent by s
on r in t that is delivered to the destination. Since we focus on cooperation in packet forwarding, we
assume that the main reason for packet losses in the network is the noncooperative behavior of the
nodes and that the number of packets dropped because of the limited capacity of the nodes and the
links is negligible. Hence, τ (r, t) can be computed as:
τ (r, t) = Ts (r) ·
l
k=1
p fk (t)
(16.81)
and the normalized throughput ˆτ (r, t) as:
ˆτ (r, t) = τ (r, t)
Ts (r) =
l
k=1
p fk (t).
(16.82)
We will use Equation (16.82) later as an input of the strategy function of s. The payoff ξs (r, t) of
s on r in t depends on the experienced throughput τ (r, t). In general, ξs (r, t) = us (τ (r, t)), where
the utility us is concave, derivable at Ts (r), and us (0) = 0. We place no other restrictions on us. In
general the utility function of different nodes may be different.
The payoff η f j (r, t) of the jth intermediate node f j on r in t is nonpositive and represents the
cost for node f j to forward packets on route r during time slot t. It is deﬁned as follows:
η f j (r, t) = −Ts (r) · c · ˆτ j (r, t)
(16.83)
where c is the cost of forwarding one unit of trafﬁc, and ˆτ j (r, t) is the normalized throughput on r in
t leaving node j. For simplicity, we assume that c is the same for every node in the network. ˆτ j (r, t)
is computed as the product of the cooperation levels of the intermediate nodes from f1 up to and
including f j:
ˆτ j (r, t) =
j
k=1
p fk (t)
(16.84)
The total payoff πi (t) of node i in time slot t is then computed as:
πi (t) =

q∈Si (t)
ξi (q, t) +

r∈Fi (t)
ηi (r, t)
(16.85)
where Si (t) is the set of routes in t where i is the source, and Fi (t) is the set of routes in t where i is
an intermediate node.
In every time slot, each node i updates its cooperation level using a strategy function σi by
choosing its cooperation level pi (t) in time slot t based on the normalized throughput it experienced
in time slot t −1 on the routes where it was a source:
pi (t) = σi

[ˆτ (r, t −1)]r∈Si (t−1)

(16.86)
where [ˆτ (r, t −1)]r∈Si (t−1) represents the normalized throughput vector for node i in time slot t −1,
each element of which is the normalized throughput experienced by i on a route where it was source
in t −1. The strategy of a node i is then deﬁned by its strategy function σi and its initial cooperation
level pi (0). There is a number of possible strategies. Some options are illustrated below [19]:
(a) Always defect (AllD): a node playing this strategy defects in the ﬁrst time slot, and then uses
the strategy function σi (in) = 0.
(b) Always cooperate (AllC): a node playing this strategy starts with cooperation, and then uses
the strategy function σi (in) = 1.

TIT-FOR-TAT (TFT) GAME THEORY BASED PACKET
817
(c) Tit-for-tat (TFT): a node playing this strategy starts with cooperation, and then mimics the
behavior of its opponent in the previous time slot. The strategy function that corresponds to
the TFT strategy is σi (in) = in.
(d) Suspicious tit-for-tat (S-TFT): a node playing this strategy defects in the ﬁrst time slot, and
then applies the strategy function σi (in) = in.
(e) Anti tit-for-tat (anti-TFT): a node playing this strategy does exactly the opposite of what its
opponent does. In other words, after cooperating in the ﬁrst time slot, it applies the strategy
function σi (in) = 1 −in.
If the output of the strategy function is independent of its input, then the strategy is called a nonreactive
strategy (e.g., AllD or AllC) otherwise the strategy is reactive (e.g., TFT or anti-TFT). The model
requires that each source be able to observe the throughput in a given time slot on each of its routes.
We assume that this is made possible with high enough precision by using some higher level control
protocol above the network layer.
16.6.2
Network nodes dependency graph and system metamodel
The payoff received by the source on r depends on the cooperation levels of the intermediate nodes
on r. We represent this dependency relationship between the nodes with a directed graph, which
will be referred to as the dependency graph. Each vertex of the dependency graph corresponds to a
network node. There is a directed edge from vertex i to vertex j, denoted by the ordered pair (i, j),
if there exists a route where i is an intermediate node and j is the source. Intuitively, an edge (i, j)
means that the behavior (cooperation level) of i has an effect on j. The concept of dependency graph
is illustrated in Figure 16.5 .
Reference [19] uses an automation  to represent the forwarding game by the metamodel. The
mapping is built on the dependency graph. A mapper (machine) Mi is assigned to every vertex i of
the dependency graph, and the edges of the dependency graph are interpreted as links that connect
the mappers assigned to the vertices. Each mapper Mi, thus, has some input and some (possibly
0) output links. The internal structure of the mapper is illustrated in Figure 16.6. Each mapper Mi
consists of a ’multiplication gate’  followed by a gate that implements the strategy function σi of
node i. The multiplication gate  takes the values on the input links and passes their product to the
strategy function gate. Finally, the output of the strategy function gate is passed to each output link
of Mi. The assignment  works in discrete steps. As an example, Figure 16.7 shows the assignment
that corresponds to the dependency graph of Figure 16.5.
Initially, in step 0, each mapper Mi outputs some initial value xi (0). Then, in step t > 0, each
mapper computes its output xi (t) by taking the values that appear on its input links in step t −1.
In order to study the interaction of node i with the rest of the network, we extract the gate that
implements the strategy function σi from the assignment . What remains in  without σi we denote
by −i as illustrated in Figure 16.8.
A
B
C
E
D
(a)
(b)
A
B
C
D
E
Figure 16.5 Representation of a network: (a) a graph showing ﬁve routes, and (b) the
corresponding dependency graph.

818
COGNITIVE NETWORKS AND GAME THEORY
Π
i
σ
i
M
Figure 16.6 Internal structure of mapper Mi.
B
M
C
M
A
M
E
M
D
M
B
σ
C
σ
D
σ
E
σ
A
σ
Figure 16.7 The assignment for the dependency graph of Figure 16.5.
i
σ
iy
ix
i
−
Θ
Figure 16.8 Model of interaction between node i and the rest of the network represented
by the automaton −i.

TIT-FOR-TAT (TFT) GAME THEORY BASED PACKET
819
The input of −i is the sequence ¯xi = xi (0) , xi (1) , . . . of the cooperation levels of i, and its
output is the sequence ¯yi = yi (0) , yi (1) , . . . of the normalized throughput values for i.
By using the system of equations that describe the operation of , one can easily express any element
yi (t) of sequence ¯yi as some function of the preceding elements xi (t −1) , xi (t −2) , . . . , xi (0) of
sequence ¯xi, and the initial values x j (0) ( j ̸= i) of the mappers within −i. For the automaton in
Figure 16.7, and extracting, for instance, σA, we can determine the ﬁrst few i/o formulae of −A as
follows:
yA (0) = xC (0) · xE (0)
yA (1) = σC (xE (0)) · σE (xA (0))
yA (2) = σC (σE (xA (0))) · σE (xA (1))
yA (3) = σC (σE (xA (1))) · σE (xA (2))
· · · · · ·
A dependency loop L of node i is a sequence (i, v1) , (v1, v2) , . . . , (vl−1, vl) , (vl, i) of edges in the
dependency graph. The length of a dependency loop L, denoted by |L|, is deﬁned as the number of
edges in L. If node i has no dependency loops, then the cooperation level chosen by i in a given time
slot has no effect on the normalized throughput experienced by i in future time slots. In the example,
nodes B and D have no dependency loops. If L is a dependency loop of i and all other nodes j ̸= i
in L play reactive strategies, then L is said to be a reactive dependency loop of i. If, on the other
hand, there exists at least one node j ̸= i in L that plays a nonreactive strategy, then L is called a
nonreactive dependency loop of i.
16.6.3
The payoff of iterative game
The goal of the nodes is to maximize the payoff that they accumulate over time. However, the end of
the game is unpredictable, so the standard technique used in the theory of iterative games [20] can be
applied. The ﬁnite forwarding game with an unpredictable end is modelled as an inﬁnite game where
future payoffs are discounted. The cumulative payoff ¯πi of a node i is computed as the weighted sum
of the payoffs πi (t) that i obtains in each time slot t:
¯πi =
∞

t=0

πi (t) · ωt
,
(16.87)
where 0 < ω < 1 and, hence, the weights exponentially decrease with t. The discounting factor ω
represents the degree to which the payoff of each time slot is discounted relative to the previous time
slot.
For any route r ∈Fi, let the set of intermediate nodes on r upstream from node i (including node
i) be  (r, i). In addition let  (r) be the set of all forwarder nodes on route r, scr (r) be the source of
route r and the set of nodes that are forwarders on at least one route be  (i.e.,  = {i ∈N : Fi ̸= φ}).
If a node i is in  and it has no dependency loops, then its best strategy is AllD (i.e., to choose
cooperation level 0 in every time slot).
This results from the fact that i wants to maximize its cumulative payoff ¯πi deﬁned in Equation
(16.87) where
πi (t) = ξi (ri, t) +

r∈Fi
ηi (r, t) = ui (Ti · yi (t)) −

r∈Fi
Tscr(r) · c ·

k∈(r,i)
xk (t)
(16.88)
Given that i has no dependency loops, yi (t) is independent of all the previous cooperation levels
xi (t′) (t′ < t) of node i. Thus, ¯πi is maximized if xi (t′) = 0 for all t′ ≥0.
If a node i is in  and it has only nonreactive dependency loops, its normalized throughput ¯yi is
again independent of its own behavior ¯xi and its best strategy is full defection (AllD). If every node
j( j ̸= i) plays AllD, then the best response of i to this is AllD. Hence, every node playing AllD is a

820
COGNITIVE NETWORKS AND GAME THEORY
4
V
0
5
i
V
V
=
=
1
V
2
V
3
V
4
δ =
(
)
(
)
2
2
1
2
y
t
x
t
+
=
+
( )
(
)
1
1
1
y
t
x t
=
+
(
)
(
)
4
4
3
4
y
t
x
t
+
=
+
(
)
(
)
3
3
2
3
y
t
x
t
+
=
+
(
)
(
)
2
3
2
2
x
t
y
t
+
≥
+
(
)
(
)
3
4
3
3
x
t
y
t
+
≥
+
(
)
(
)
1
2
1
1
x
t
y
t
+
≥
+
( )
( )
1
1
x t
y
t
≥
(
)
(
)
4
4
4
i
x
t
y t
+
≥
+
Figure 16.9 Example to illustrate the propagation of behavior.
Nash equilibrium. Except for the above special conditions, we cannot determine the best strategy of
a node i in general because it depends on the particular dependency graph and the strategies played
by the other nodes. Still, we can show that, under certain conditions, cooperative equilibria do exist
in the network.
Let us consider a route r ∈Fi and assume that node i is in , and that there exists a dependency
loop L of i that contains the edge (i, src(r)) . If all nodes in L (other than i) play the TFT strategy,
then the following holds:
yi (t + δ) ≤

k∈(r,i)
xk (t),
(16.89)
where δ = |L| −1. To prove it let L be the following sequence of edges in the dependency graph:
(v0, v1) , (v1, v2) , . . . , (vδ, vδ+1), where vδ+1 = v0 = i and v1 = scr (r). An example is given in Figure
16.9
We know that each node is the source of a single route; let us denote by rv j (0 < j ≤δ + 1) the
route on which v j is the source. It follows that rv1 = r. In addition, we know that the existence of
edge

v j, v j+1

(0 ≤j ≤δ) in the dependency graph means that v j is a forwarder on rv j+1. Because
xk(t) ≤1, for every nodev j (0 ≤j ≤δ), then
xv j (t) ≥

k∈

rv j+1 ,v j
 xk (t) ≥

k∈

rv j+1
 xk (t) = yv j+1 (t)
(16.90)
In addition, since every node except for v0 = vδ+1 = i plays TFT, we have xv j (t + 1) = yv j (t) for
every 0 < j ≤δ: Using this and (16.90) in an alternating order, we get the following:
xv0 (t) ≥

k∈(rv1 ,v0)
xk (t) ≥yv1 (t) = xv1 (t + 1) ≥yv2 (t + 1)
= xv2 (t + 2) ≥· · · ≥yvδ+1 (t + δ)
(16.91)
By substituting i for v0 and vδ+1, and r for rv1, we get
xi (t) ≥

k∈(r,i)
xk (t) ≥· · · ≥yi (t + δ)
(16.92)
Intuitively, this means that if node i does not cooperate, then this defection ‘propagates back’ to it on
the dependency loop. The delay of this effect is given by the length of the dependency loop.

TIT-FOR-TAT (TFT) GAME THEORY BASED PACKET
821
Assuming that node i is in , the best strategy for i, is full cooperation in each time slot, if the
following set of conditions holds:
(i) For every r ∈Fi, there exists a dependency loop Li,src(r) that contains the edge (i, scr (r)).
(ii) For every r ∈Fi,
u′
i (Ti) · Ti · ωδi,scr(r)
|Fi|
> Tscr(r) · c,
(16.93)
where u′
i (Ti) is the value of the derivative of ui (τ) at
τ = Ti, and δi,scr(r) =
Li,scr(r)
 −1.
(iii) Every node in  (other than i) plays the TFT strategy.
To prove this, we ﬁrst ﬁnd the maximum possible value of the total payoff for node i in general.
Then we show that the maximum is in the case in which node i fully cooperates. In the sequel we
will use the linear function f (τ) = u′
i (Ti) · τ + ui (Ti) −u′
i (Ti) · Tiwhich is the tangent of function
ui at τ = Ti. Since ui is nondecreasing and concave, f (τ) ≥ui (τ) for all τand f (Ti) = ui (Ti)). By
deﬁnition, the total payoff ¯πi of node i is:
¯πi =
∞

t=0

ξi (ri, t) +

r∈Fi
ηi (r, t)

ωt =
∞

t=0

ui (Ti · yi (t)) −

r∈Fi
Tscr(r) · c ·

k∈(r,i)
xk (t)

ωt
(16.94)
Because of Condition 1 and Condition 3, we can use (16.98) to obtain the following inequality for
every r ∈Fi:

k∈(r,i)
xk (t) ≥yi

t + δi,scr(r)

(16.95)
which leads to
¯πi ≤
∞

t=0

ui (Ti · yi (t)) −

r∈Fi
Tscr(r) · c · yi

t + δi,scr(r)


ωt
(16.96)
Since ui (Ti · yi (t)), is independent of r, we use:
ui (Ti · yi (t)) =

r∈Fi
ui (Ti · yi (t))
|Fi|
(16.97)
When we use this in into (16.96), we get:
¯πi ≤
∞

t=0


r∈Fi
ui (Ti · yi (t))
|Fi|
−

r∈Fi
Tscr(r) · c · yi

t + δi,scr(r)


ωt
=

r∈Fi
! ∞

t=0
ui (Ti · yi (t))
|Fi|
· ωt −
∞

t=0
Tscr(r) · c · yi

t + δi,scr(r)

· ω
"
(16.98)
We now split up the ﬁrst summation into two terms, one from t = 0 to δi,scr(r) −1, and the other from
t = δi,scr(r) to ∞. Then, we shift the index in the second sum in such a way that the summation goes
again from t = 0 to ∞which results in:
∞

t=0
ui (Ti · yi (t))
|Fi|
· ωt =
δi,scr(r)−1

t=0
ui (Ti · yi (t))
|Fi|
· ωt +
∞

t=δi,scr(r)
ui (Ti · yi (t))
|Fi|
· ωt
=
δi,scr(r)−1

t=0
ui (Ti · yi (t))
|Fi|
· ωt +
∞

t=0
ui

Ti · yi

t + δi,scr(r)

|Fi|
· ωt+δi,scr(r)
(16.99)

822
COGNITIVE NETWORKS AND GAME THEORY
By using Equation (16.99) back in Equation (16.98), we get:
¯πi ≤

r∈Fi


δi,scr(r)−1

t=0
ui (Ti · yi (t))
|Fi|
· ωt +
∞

t=0
!
ui

Ti · yi

t + δi,scr(r)

|Fi|
· ωt+δi,scr(r)
−Tscr(r) · c · yi

t + δi,scr(r)


· ωt


(16.100)
Since ui is nondecreasing and yi(t) ≤1, the ﬁrst term of (16.100) satisﬁes
δi,scr(r)−1

t=0
ui (Ti · yi (t))
|Fi|
· ωt ≤
δi,scr(r)−1
t=0
ui (Ti)
|Fi| · ωt
= ui (Ti)
|Fi|
· 1 −ωδi,scr(r)
1 −ω
(16.101)
By using the fact that f (τ) ≥ui (τ) for all τ, the second term of (16.100) satisﬁes:
∞

t=0

ui

Ti · yi

t + δi,scr(r)

|Fi|
· ωδi,scr(r) −Tscr(r) · c · yi

t + δi,scr(r)


· ωt
≤
∞

t=0

f

Ti · yi

t + δi,scr(r)

|Fi|
· ωδi,scr(r) −Tscr(r) · c · yi

t + δi,scr(r)


· ωt
(16.102)
=
∞

t=0
!
u′
i (Ti) · Ti · yi

t + δi,scr(r)

+ ui (Ti) −u′
i (Ti) · Ti
|Fi|
· ωδ
i,scr(r)
−Tscr(r) · c · yi

t + δi,scr(r)


· ωt
=
∞

t=0
ui (Ti) −u′
i (Ti) · Ti
|Fi|
· ωδi,scr(r) +
u′
i (Ti) · Ti · ωδi,scr(r)
|Fi|
−Tscr(r) · c

· yi

t + δi,scr(r)
 
· ωt
= ui (Ti) −u′
i (Ti) · Ti
|Fi|
· ωδi,scr(r)
1 −ω +
∞

t=0
u′
i (Ti) · Ti · ωδi,scr(r)
|Fi|
−Tscr(r) · c

· yi

t + δi,scr(r)

· ωt ≤ui (Ti) −u′
i (Ti) · Ti
|Fi|
· ωδi,scr(r)
1 −ω
+
∞

t=0
u′
i (Ti) · Ti · ωδi,scr(r)
|Fi|
−Tscr(r) · c

· ωt
(16.103)
= ui (Ti) −u′
i (Ti) · Ti
|Fi|
· ωδi,scr(r)
1 −ω +
u′
i (Ti) · Ti · ωδi,scr(r)
|Fi|
−Tscr(r) · c

·
1
1 −ω
= ui (Ti)
|Fi|
· ωδi,scr(r)
1 −ω −Tscr(r) · c
1 −ω ,
(16.104)
where, in coming from (16.102) to (16.103), we used condition (ii) and the fact that yi

t + σi,scr(r)

≤
1. By using (16.101) and (16.104) in (16.100), we get
¯πi ≤

r∈Fi
ui (Ti)
|Fi|
· 1 −ωδi,scr(r)
1 −ω
+ ui (Ti)
|Fi|
· ωδi,scr(r)
1 −ω −Tscr(r) · c
1 −ω

=
1
1 −ω ·

r∈Fi
ui (Ti)
|Fi|
−Tscr(r) · c

=
1
1 −ω ·
	
ui (Ti) −c ·

r∈Fi
Tscr(r)

(16.105)

TFT GAME THEORY BASED MODELING OF NODE COOPERATION
823
Now, if i fully cooperates in every time slot, every node will always fully cooperate, since all the
other nodes play TFT, and hence, every node will experience a normalized throughput equal to 1 in
each time slot. This can easily be derived from the i / o formulae describing the behavior of the nodes,
which take a simple form due to the simplicity of the strategy function of the TFT. As a consequence,
we have yi (t) = 1 for every t, and xk (t) = 1 for every kand for every t. In this case, Equation (16.104)
becomes:
¯πi =
∞

t=0

ui (Ti · yi (t)) −

r∈Fi
Tscr(r) · c ·

k∈(r,i)
xk (t)

ωt
=
1
1 −ω ·

ui (Ti) −c ·

r∈Fi
Tscr(r)


(16.106)
This means that by fully cooperating, the payoff of node i reaches the upper bound expressed in
Equation (16.105), which means that there is no better strategy for node i than full cooperation.
16.7
TFT GAME THEORY BASED MODELING OF NODE COOPERATION
WITH ENERGY CONSTRAINT
16.7.1
Acceptance rate
In this section we consider a network with a ﬁnite population of N nodes distributed among K classes
(e.g., laptop, PDA, cell phone. . . ). Let ni be the number of nodes in class i (i = 1, . . . , K) associated
with an energy constraint Ei, and an expectation of lifetimeLi. So, nodes in class i have an average
power constraint of ρi = Ei/Liwhere ρ1 > ρ2 > . . . ρK. In each slot, any one of the N nodes can be
chosen as a source with equal probability. M is the maximum number of relays that the source can
use to reach its destination. The probability that the source requires l ≤M relays is given by q (l)with
q (0) = 0, for simplicity. The l relays are chosen with equal probability from the remaining N −1
nodes. A session is said to belong to type j, if at least one of the nodes involved belongs to class j and
the class of any other node is less than or equal to j. We assume that energy spent in transmit mode is the
dominant source of energy consumption. For simplicity, we assume that the energy required to relay
a session is constant and equal to 1. For any node h, we denote byB j
h (k) the number of relay requests
made by node h for a session of type j till time k, and by A j
h (k) the number of relay requests generated
by node h for a session of type j which has been accepted till time k. Similarly, we denote by D j
h (k)
the number of relay requests made to node h for a session of type j till time k, and by C j
h (k) the number
of relay requests made to node h for a session of type j which has been accepted by node h till time k.
For 1 ≤j ≤K and 1 ≤h ≤N, we deﬁne: φ j
h (k) = A j
h (k) /B j
h (k), and ψ j
h (k) = C j
h (k) /D j
h (k).
So, φ j
h is the throughput experienced by h with respect to type j sessions. More speciﬁcally, we deﬁne
normalized acceptance rate R or throughput T as R = T = limk→∞φ j
h(k). Note that T is deﬁned for
each node and session type; however, we have suppressed the indices for the sake of simplicity.
16.7.2
Pareto optimum
We assume that a node in class i in a session of type j accepts a relay request with probability τi j .
Consider a node p participating in a type j session (1 ≤j ≤K). The average energy per slot spent
by the node as a source, e(s)
pj , or as a relay e(r)
pj can be written as:
e(s)
pj = R
N = 1
N
M

l=1

h1,...,h j
q (l)

l; h1, . . . h j

τ h1
1 j . . .τ
h j
j j e(r)
pj
= 1
N
M

l=1
lq (l)

h1,...h j


l −1; h1, . . . h j

τ h1
1 j . . . τ
h j
j j τclass(p) j
(16.107)

824
COGNITIVE NETWORKS AND GAME THEORY
where:
r 1/N the probability that node p is the source;
r 
 (l; h1, . . . , hK) is a multivariate probability function conditioned on the fact that the session
belongs to type j with l relays and hi refers to the number of relays of class i participating in the
session;
r τ h1
1 j . . . τ
h j
j j represent the probability that all the relay nodes accept the request;
r l/N is the probability that node p is chosen as one of the l relays.
The feasible region for τi js is deﬁned by the set of inequalities:
K

j=1

e(s)
pj + e(r)
pj

≤ρclass(p)
1 ≤p ≤N
τclass(p) j ∈[0, 1]
1 ≤j ≤K; 1 ≤p ≤N
(16.108)
where class (p) is the class to which node p belongs. For a feasible set of τi js, the corresponding
feasible set of Rs can be directly computed from Equation (16.107). The Pareto optimal values of the
τi js can be derived by imposing the equality relation in Equation (16.108).
Example 1: For a simple example of the system with two nodes, belonging to the same class and
with a power constraint ρ and q (1) = 1, M = 1 Equation (16.108) gives for each node p = 1, 2
τ1
2 + τ2
2 ≤ρ →τ1 ≤τ2 −2ρ
(16.109)
which deﬁnes the feasible region for τi js . Given that τi →Ri (16.109) gives also the feasibility
region for Rs as R1 ≤R2 −2ρ. The Pareto optimal values of the Rs are on the line (R1, R2) →
R1 = R2 −2ρ or more precisely on the line segment joining (0, 2ρ) with (2ρ, 0).
While operating at any of these points, both nodes are consuming energy at the maximum allowable
rate. Therefore a node cannot increase its R without decreasing the other node’s R. So, in this example,
it is straightforward to see that the only Pareto optimal operating point acceptable to both rational
users is (ρ, ρ).
In a system with N nodes, all belonging to the same class, by rationality, each node must possess
the same value of R. So, it is a simple matter to derive the maximal value of τ which satisﬁes the
energy constraint as in Equation (16.108). In a system with n1 = 1 nodes in class 1 and n2 nodes in
class 2, by rationality, the lone node in class 1 will not expend more energy than the remaining nodes
in class 2. This is because the node in class 1 will not receive higher throughput if it is more generous
to users in class 2 than users in class 2 are to it. Indeed, self interest dictates that the lone node behaves
as though it belongs to class 2. If there are two nodes in class 1 and they are involved in type 2 sessions,
they have no incentive to behave any differently than as if they were class 2 nodes. Meanwhile, when
they are involved in type 1 sessions, they can utilize their excess energy to their mutual beneﬁt. So,
for a set of self-interested nodes, the rational values of τi j have the following property:
τi j = τ j j →τ j
1 ≤i ≤j ≤K
(16.110)
Given Equation (16.110), the rational Pareto optimal values of the τ js and hence the Rs can be
determined by recursively solving the energy constraints in Equation (16.108) and by using Equation
(16.107).
Example 2: Consider a network with N nodes and K classes with ni nodes in class i, and
q (1) = 1, M = 1. In this case, the session type is the maximum of the source class and the relay
class. Consider a node in class i. The average energy per slot spent by the node as a source is:
e(s)
i
=
1
N (N −1)
! i−1

k=1
nkτi + (ni −1) τi +
K

l=i+1
nlτl
"
(16.111)

TFT GAME THEORY BASED MODELING OF NODE COOPERATION
825
When the relay belongs to a class lower than i, the session is of type i, and if the relay belongs to a
class higher than i, the session type is the same as the class of the relay. The same expression holds
for the average energy per slot, e(r)
i , spent by the node as a relay. The rational Pareto optimal τi can
be derived from the set of equations;
e(s)
i
+ e(r)
i
= ρi
1 ≤i ≤K
τi ∈[0, 1]
1 ≤i ≤K
(16.112)
In particular, for K = 1, the rational and Pareto optimal τ is equal to Nρ/2, and the rational Pareto
optimal R is equal to τ.
Example 3: Consider now a network with two classes and M = 2. The energy spent by a node in
class 2 as a source, e(s)
2 , and as a relay, e(r)
2 , are given by:
e(s)
2 = 1
N
M

l=1
q (l) τ l
2
and
e(r)
2 = 1
N
M

l=1
lq (l) τ l
2
(16.113)
The optimal τ2 can be found by solving the equation e(s)
2 + e(r)
2 = ρ2.
The energy spent by a node in class 1 as a source, e(s)
1 , and as a relay, e(r)
1 , is given by:
e(s)
1
= 1
N

q (1)
#
n2
N −1τ2 +

1 −
n2
N −1

τ1
$
+ q (2)
#(n1 −1) (n1 −2)
(N −1) (N −2) τ 2
1
+

1 −(n1 −1) (n1 −2)
(N −1) (N −2)

τ 2
2
$
e(r)
1
= 1
N

q (1)
#
n2
N −1τ2 +

1 −
n2
N −1

τ1
$
+ 2q (2)
#(n1 −1) (n1 −2)
(N −1) (N −2) τ 2
1
+

1 −(n1 −1) (n1 −2)
(N −1) (N −2)

τ 2
2
$
.
(16.114)
Once we ﬁnd τ2 from Equation (16.113), we can obtain τ1 by solving e(s)
1 + e(r)
1 = ρ1. The method
presented in these examples can be easily extended to multiple classes and relays.
16.7.3
Prisoner’s dilemma and TFT game
A rational selﬁsh node could exploit the naivete of other nodes by always denying their relay requests,
thereby increasing its lifetime, while keeping its R constant. In other words, any stationary strategy is
dominated by ‘always deny’ behavior. Hence, stationary strategies are not sustainable, and behavioral
strategies, already discussed in this chapter, are required in order to stimulate cooperation.
The problem falls in to the framework of non-cooperative game theory and at this point we use the
occasion to introduce the canonical example from this ﬁeld, the so called prisoner’s dilemma. In this
example, two people are accused of a crime. The prosecution promises that if exactly one confesses,
the confessor goes free, while the other goes to prison for 10 years. If both confess, then they both go
to prison for 5 years. If neither confesses, they both go to prison for just a year. Table 16.2 presents
the punishment matrix showing the years of prison that the players get depending on the decision
they make.
Clearly, the mutually beneﬁcial strategy would be for both not to confess. Because the prisoners
do not know the confession of the other party, from the perspective of the ﬁrst prisoner, P1, his
punishment is minimized if he confesses, irrespective of what the other prisoner, P2, does. Since the
other prisoner argues similarly, the unique Nash equilibrium is the confess strategy for both prisoners.
Nevertheless, if this game were played repeatedly (iterated prisoners dilemma), it has been shown that

826
COGNITIVE NETWORKS AND GAME THEORY
Table 16.2
Punishment matrix (P1,P2) for the prisoner’s dilemma.
P1\P2
Confess
Not Confess
Confess
(5,5)
(0,10)
Not Confess
(10,0)
(1,1)
cooperative behavior can emerge as a Nash equilibrium. By employing behavioral strategies, a user
can base his decision on the outcomes of previous games. This allows the emergence of cooperative
equilibrium. As discussed in Section 16.6, in generous tit-for-tat (GTFT) strategy, each player mimics
the action of the other player in the previous game. Each player, however, is slightly generous (see
Equation (16.92) and on occasion cooperates by not confessing even if the other player had confessed
in the previous game. In this section we use the GTFT algorithm where each node maintains a record
of its past experience by using the two variables ψ( j)
h
and φ( j)
h , h = 1, . . . N, j = 1, . . . K, deﬁned
in Section 16.7.1. Each node therefore maintains only information per session type and does not
maintain individual records of its experience with every node in the network. The decisions are
always taken by the relay nodes based only on their ψ( j)
h
and φ( j)
h values. For a network with N nodes,
K classes, q (1) = 1 and M = 1assume that a generic node h receives a relay request for a type j
session.
The GTFT acceptance algorithm, is deﬁned as:
• if ψ( j)
h (k) > τ j or φ( j)
h (k) < ψ( j)
h (k) −ε Reject
(16.115)
r else Accept
where ε is a small positive number.
In (16.115) the ﬁrst term refers to the case when node h has relayed more trafﬁc for type j sessions
than it should have, and the second term to the case when the amount of trafﬁc relayed by node h in
sessions of type j is greater than the amount of trafﬁc relayed for node h by others in type j sessions.
Since ε is positive, nodes are a little generous by agreeing to relay trafﬁc for others even if they
have not received a reciprocal amount of help. As we can see the GTFT algorithm is not a stationary
strategy. As opposed to the discussion in Section 16.6, each node takes its action based solely on
locally gathered information. Only 4K variables need to be stored at each node, independently of N,
and this makes GTFT scalable. While for the single relay case, GTFT attempts to equalize the amount
of cooperation a node provides with the amount of cooperation it receives, when multiple relays are
used the amount of help rendered is always more than the amount of help received. This is because
a node is a relay more often than it is a source. In this case, assuming that a relay request for a type
j session arrives at node h belonging to class i the modiﬁed acceptance algorithm, called m-GTFT
becomes:
r
if ψ( j)
h (k) > τ j or φ( j)
h (k) < Li jψ( j)
h (k) −ε Reject,
(16.116)
r else Accept
where Li j is the ratio of the rational Pareto optimal R for type j session to τ j , deﬁned as
Li j =
Prob (h is server in a type j session)
Prob (h accepts to relay a type j session)
(16.117)
Reference [24] proves that the GTFT algorithm constitutes a Nash Equilibrium and show that similar
arguments can be extended to prove the convergence of the m-GTFT algorithm too.
Evolution in time, of normalized acceptance rate R associated with ﬁve different session types,
for a single relay network is presented in Figure 16.10(a). The network has ﬁve classes, and ﬁve
nodes in each class (N = 25). The energy constraints are given by ρ1 = 0.03, ρ2 = 0.025, ρ3 = 0.02,

TFT GAME THEORY BASED MODELING OF NODE COOPERATION
827
0
0,2
0,4
0,6
0,8
1
0
25000
50000
Time
Normalized acceptance rate
Type 1
Type 2
Type 3
Type 4
Type 5
0
0,2
0,4
0,6
0,8
1
0
25000
50000
Time
Normalized acceptance rate
0
0,2
0,4
0,6
0,8
1
0
25000
50000
Time
Normalized acceptance rate
Type 1
Type 2
Type 3
Type 4
Type 5
(a)
(b)
(c)
Figure 16.10 Normalized acceptance rate R versus time for a network with N = 25, K = 5,
q (1) = 1, M = 1, (a) all nodes employ GTFT. NAR values converge to the
optimal operating point. (b) all nodes employ GTFT, and ε < 0 (−0.01).
If nodes are not slightly generous (ε > 0),GTFT fails to reach the optimal
operating point. (c) one node in class 2 and one node in class 4 are parasites
while all other nodes employ GTFT. Performance of nodes in type 2 and type
4 sessions degrade showing that GTFT prevents parasitic behavior in rational
users.

828
COGNITIVE NETWORKS AND GAME THEORY
ρ4 = 0.015 and ρ5 = 0.01 and q (1) = 1 and M = 1, as in [24]. All Rs converge to the to the rational
optimal values. These values can be obtained numerically by solving the system of equations (16.111)
in Example 2. Figure 16.10(b), demonstrates that it is critically important that the parameter ε be
positive. In other words, nodes should always be slightly generous for the NARs in order to achieve
the rational optimal values. Figure 16.10(c) demonstrates the robustness of the GTFT algorithm in
the presence of parasites. We assume that a node in class 2 and a node in class 4 are parasitic, i.e.
these nodes never relay trafﬁc. We see that the performance of type 2 and type 4 sessions degrade
severely, while performance for other types of session remains unaffected.
16.8
PACKET FORWARDING MODEL BASED ON DYNAMIC
BAYESIAN GAMES
In this section we present a packet forwarding mechanism that takes into account past actions and the
time-varying nature of the available resources in the network. Let N be an arbitrary ad hoc network
and N ⊆N a ﬁnite set of nodes (agents) belonging to N. An arbitrary node of the set N = {1, . . . , n}
is indexed by i. We assume that nodes have topology information only about the nodes within the
range of their transmitter (local topology), but not about the nodes outside this region. The nodes that
are within the range of the transmitter constitute the neighborhood (
i) of a node i. We also assume
that the neighborhood topologies are symmetric, i.e., j ∈
i ⇔i ∈
 j.
The nodes are energy constrained and energya ware as they know their current energy level. We
approximate the energy level with a ﬁnite set of possible values. We call these energy levels the energy
classes of a node and use the variable θi (t) to denote the energy class of node i at an arbitrary time
t. The energy class of a node will be also called the type of a player (node), which is borrowed from
the terminology of microeconomics and algorithmic mechanism design. We focus on an individual
node i and deﬁne for each i a time period tk, k = 0, 1, · · ·, so that a new period starts when the node
generates some packets and decides whether to send them to the network or to discard them. Let the
number of packets generated by node i at time period tk be gi (tk), and the number of the generated
packets that are actually sent to the network si (tk). At each time period si (tk) ≤gi (tk). Let the action
history of a sending node i at time period tk be a vector that contains the number of packets sent at
time periods t0, · · · , tk−1, denoted as hi (tk) = (si (t0) , · · · , si (tk−1)). We assume that each message
sent by an arbitrary node i is broadcast to all nodes j in the neighborhood 
i. Every node j decides
individually whether to forward the packets or not. With respect to the sending node, the decision and
the corresponding forwarding action by a node j take place at time period tk and we denote by f i
j (tk)
the number of packets that node j forwards for node i at time period tk. The sender’s decision as to
how many packets to send is based on its guess about the energy classes of the neighboring nodes. If
it believes that all neighboring nodes have used all of their energy or that they are noncooperative, it
is not rational to send anything, as sending consumes energy. The energy classes of the neighboring
nodes are not known a priori, but instead we assume that node i has a probability distribution deﬁned
over the possible values of the energy class of a node j. The time varying probabilities of the energy
classes at time period tk depend on the joint history proﬁle of the actions made by node i and node j.
The history proﬁle is hp(i,j)→¯hi
j (tk) = (hi (tk) , hi
j (tk)) where hi
j (tk) is the number of packets that
node j has forwarded for node i at time periods t0, · · · , tk−1: hi
j (tk) = ( f i
j (t0) , · · · , f i
j (tk−1)) The
guesses gs(i) a sending node i has about the energy class of a forwarding node j can be represented as
a probability distribution that is conditioned on the energy class of i and hp(i,j). The formal deﬁnition
of the conditional probability distribution is gs(i)→µ j
i (tk) = p(θi
j (tk) |θi (tk) , ¯hi
j (tk)) where θi (tk) is
the energy class of a sending node i at time period tkθ j
i (tk) is the energy class of a node j that is
forwarding packets for i at time step tk, and p (·) is an arbitrary probability distribution. By deﬁning
a conditional probability density in this way we construct a guessing mechanism for the node i. The
guesses reﬂect the level of knowledge a node has at the beginning of a time period tk. These guesses
play an important role in the deﬁnition of optimality of the model in the Bayesian sense.
Similarly, as to the decisions made by the sender depend on the sender’s guesses about the energy
classes of the neighboring nodes, the decisions of the forwarding nodes depend on the guesses that

PACKET FORWARDING MODEL BASED ON DYNAMIC BAYESIAN GAMES
829
the nodes have made about the energy class of the sender. There is no motivation to forward the
packet of the low energy node because it might not be able to return the favour in the future. So, the
model is constructed in such a way that the probabilities depend on the number of packets sent by
node i. The deﬁnition of the probability distribution of a forwarding node j is given as
gs(j) →φi
j (tk) = p

θi (tk)
θi
j (tk) , ¯hi
j (tk) , si (tk)

Together the guesses of the sender and the forwarder constitute the guessing system of the nodes. We
use ¯µi
j to denote the joint guessing system of nodes i and j: gs(i, j) →¯µi
j (tk) = (u j
i (tk) , φi
j (tk)).
Each outcome of the game yields some utility for both of the players. The value of the utility depends
on the decisions they make and on their energy classes. The exact form of the utility function depends
on the application. However, it is required that the utility functions are continuous and concave in
the parameters. A good utility function should consider simultaneously both the possible savings in
energy consumption and the possible gain in future throughput.
Since each node must act both as a forwarder and as a sender in the network, its operation can be
formulated in game-theoretic settings by deﬁning each sender–forwarder pair as a dynamic Bayesian
game [9]. Thus each node i participates in 2|
i| games, where |
i| is the cardinality (number of
elements) in set 
i. We deﬁne the game-theoretic system of a node i to be the collection of games
in which the node participates simultaneously. The sending games of the system are |
i| games in
which the node i acts as a sender.
A sending game is a 5-tuple (I, A, ¯ui
j, , ¯ui
j), where I is the set of two players (i,j), A deﬁnes the
action space of the game, ¯ui
j deﬁnes a utility function for both players,  deﬁnes the type space of the
players and ¯ui
j is the guessing system of the game [25]. The set I consists of two nodes i and j, where
j ∈
i and the set A consists of action pairs (si (tk) , f i
j (tk)) with 0 ≤f i
j (tk) ≤si (tk) ≤gi (tk). The
utility function ¯ui
j is a vector containing the utility functions for both players: ¯ui
j = (ui, ui
j) where ui
is the utility function of the sender and ui
j is the utility function of the forwarder j for the messages
arriving from sender node i. The type space  is the set of possible energy class values for a node
and the guess system ¯µi
j was deﬁned earlier. Similarly, we can also deﬁne a forwarding game as a
game in which node i acts as a forwarder for some neighboring node j.
In these games, agents must act optimally at each individual time period and their actions also
need to be optimal, given the history of game play. A new period of a game begins when the sender
decides how many packets to send to the network. The period ends when the forwarding side decides
whether to forward the packets or not. If the packets are forwarded, the transmission can be detected
by the sender. On the other hand, if the packets are not forwarded, this can also be observed using
timers and packet numbering.
The action proﬁles of the players are behavior strategies, deﬁned as probabilities of the form
px(ax|¯hi
j (tk) , θx), where px (·) is a suitable probability distribution, i is a sending node, j is a
forwarding node, and x is either the node i or the node j. The variable ax denotes the action of x
and the variable ¯hi
j (tk) is the history proﬁle hp(i,j). If x is a sender, the action ax corresponds to the
number of packets sent at period tk given the history of game play and if x is a forwarder, ax refers
to the number of packets forwarded for the sender at period tk given the history of game play and the
action of the sender. The utility of x is a function of the history, the actions and the energy classes of
the nodes. The utility function of a node x, given sender i and receiver j, is deﬁned as
ux = u

hi
j (tk+1) , ai, a j, θi, θ j

For the each new period the sender’s guess about the energy class of the forwarder must be updated.
The update is made using the Bayes rule, and the resulting posterior probabilities of period tk are
used as prior probabilities at the beginning of stage tk+1.
ui
j (tk+1) = p

θi
j (tk) |hi
j (tk) , f i
j (tk)

=
p

hi
j (tk) , f i
j (tk) |θi
j (tk)

p

θi
j (tk)

p

hi
j (tk) , f i
j (tk)

(16.118)
The optimality analysis of the model, is simpliﬁed if subgame perfection and, especially, its extension
to perfect Bayesian equilibrium in the model is applied. A game is said to be subgame perfect, if the

830
COGNITIVE NETWORKS AND GAME THEORY
restriction of strategies to a single stage (time period) constitutes a Nashequilibrium. In PBE, each
stage game played at a single period must constitute a Bayes–Nash equilibrium. In other words, when
the actions are restricted to a single time period they must be optimal given the guesses the players
have at the beginning of that time period.
In a unicast communication model the optimal behavior policy of the sender at time period tk is
ˆs j
i = arg maxsi

f i
j

θi
j σ i
j( f i
j |si)µ j
i ui, where µ j
i are gs(i) probabilities and the term σ i
j is a behavior
strategy bs(j) of player j in the game where node i acts as the sender. The behavior strategy indicates
the probability that node j performs the action f i
j given the action of the sender i. Finally, the term
ui is the utility function.
In the broadcast model it is rational to send packets if some node in 
i is willing to forward them.
So, the optimal sender strategy in the broadcast model is deﬁned as the maximum of the optimal
strategies of individual ‘unicast’ games ˆsi = max
j
ˆs j
i . Optimal behavior policy of the forwarder at time
period tk is.
ˆf i
j = arg max
f i
j

θi
σ j
i (si|θi) φi
jui
j
Here σ j
i (si|θi) is the bs(i) of the sender, which gives the probability that node i sends si packets (at
time period tk) given its energy class θi. Together with the guess system ¯µi
j, the pair (ˆsi, ˆf j) constitutes
the Bayes–Nash equilibrium of a stage-game.
In a practical system a node joins an ad-hoc network by discovering its neighbors and by assigning
prior probabilities over the energy class values of those neighbors. To discover its neighbors, a node
i could send a join message to the network. The nodes that respond form the neighborhood 
i.
Additionally, the node i should construct a prior probability distribution over the energy class values
of the neighbors.
A possible approach [25] could be to assign uniform priors over the possible values. Another
possibility is that responses to the join message include information about the energy class of the
sender. If the message is trusted, a suitable family of distributions is used so that the prior probabilities
can be assigned easily and efﬁciently. In [25] the use, of a beta-distribution is considered. If r is the
percentage representing the energy level of a node. A new beta-distribution can be initialized by
assigning initial parameter values so that α = 100r and β = 100 (1 −r). If the message is not
trusted a weighing probability distribution could be used to ‘ﬁlter’ the value. A weighing probability
distribution is deﬁned as a joint distribution p(θi
j, θi), where the value of θibelongs to the joining node
and is known. The initial probability of a particular energy class can be assigned by marginalizing
the joint distribution with respect to the values of θi as p(θi
j) =
%
p(θi
j, θi)dθi =
%
p(θi
j|θi)p(θi)dθi.
16.9
GAME THEORETIC MODELS FOR ROUTING IN WIRELESS
SENSOR NETWORKS
16.9.1
Cognitive wireless sensor network model
In this case, in addition to energy constraints and path length, the utility function should include the
reliability of a part and, due to data aggregation, the information value of the message [26–30] . The
game-theoretic model for reliable energy-constrained routing consists of N sensors (players) denoted
by the set S = {s1, . . . , si, s j, . . . , sn}. In the sequel we describe the attributes of the network using
a static model. A dynamic extension of the model, as described in the previous section, would view
them in terms of snapshots representing successive operational periods.
The cost includes communication costs ci j, proportional to the distance between sensors and
participation costs C Pithat model the cost to a sensor of deciding to participate in a given route.
Each node’s strategy is a binary vector li = (li1,li2, . . . ,lii−1,lii+1, . . . ,lin), where li j = 1

li j = 0

represents sensor si’s choice of sending/not sending a data packet to sensor s j. The path reliability
is modelled by using sensor failure probabilities. We assume that node si can fail with a probability
(1 −pi) ∈[0, 1). In wireless sensor networks a query is sent from the sink node sq = sn to the nodes

GAME THEORETIC MODELS FOR ROUTING IN WIRELESS SENSOR NETWORKS
831
q
S
5
S
3
S
1S
2
S
4
S
Figure 16.11 Sensor beneﬁts with data aggregation.
in S. The query may match the attributes of data stored at si each to varying degrees. This data has to
be reported back to sq and possibly aggregated along the way. Information is routed to sq through an
optimally chosen set (via the routing game) S′ ⊆S of intermediate nodes. The model should include,
in the selection process of data transfer paths; the importance ( information value) of the data being
reported. The data items representing successful query matches must be routed over more reliable
paths even at higher costs, as the penalty for nondelivery is higher. The model includes this feature
by attaching a value vi ∈R to the data from each sensor si, 1 ≤i < n.
Since we are modelling cognitive sensors, we should account for nodes with valuable information
but selﬁsh behavior, which are saving energy by deliberately not participating in the routing. One
way to motivate such nodes is via a punishment mechanism that values future information coming
from a node proportional to the number of previous routes it has participated in.
The beneﬁt Xi to any sensor siis deﬁned as Xi = gi (v1, . . . , vn−1) Ri, where Ri denotes the path
reliability from si onwards to sq and gi (·) is the value expectation function. As an example, for the
data-aggregation tree shown in Figure 16.11, let gi = gi(v1, . . . , vn−1) denote the value of the data at
node i and F (i) the set of its parents.
Based on the form of gi () the two simple beneﬁt models could be deﬁned as
g(a)
i
= vi +

j∈F(i)
v j
g(b)
i
= vi +

j∈F(i)
p jv j
(16.119)
The ﬁrst model captures the ‘memoryless’ property of information transfer on a path, i.e. once
information has reached a particular sensor its beneﬁts in forwarding that information are not con-
strained by the choices of its ancestors and depend only on the survival probabilities of sensors from
si onwards. In the second case, we model si as obtaining information from its parents only if they
survive with the given probabilities.
If l = (li,l−i) is any valid strategy proﬁle resulting in a routing tree T rooted at sq, the payoff at
node si under T can be written as:
i (l) =
#Xi −

ci j + C Pi

,
if si ∈T
0,
otherwise
(16.120)
A strategy li is said to be a best response of player i to l−i if 0 ≤i

l′
i,l−i

≤i (li,l−i) for all
l′
i ∈Li. If BRi (l−i) denotes the set of player i’s best response to l−i, a strategy proﬁle l = (l1, . . . ,ln)

832
COGNITIVE NETWORKS AND GAME THEORY
is said to be an optimal RQR (reliable query routing) tree T if li ∈BRi (l−i) for each si, i.e. sensors
are playing a Nash equilibrium.
16.9.2
Optimal rout computation
It can be shown that for both beneﬁt models, given pi ∈(0, 1] and ci j + C Pi = c for all i j, the most
reliable tree RT is always optimal. For uniform pi, the optimal RQR tree is also the one with least
overall cost. Let si and si+1 be subsequent nodes on the most reliable tree and Ri the reliability of
the most reliable path from si to sq with R′
i being the reliability along any alternative path from
si. For any neighbor s j not on the optimal path let ci = (ci,i+1 + C Pi) −(ci j + C Pi), and Ri is
deﬁned similarly. Given G and P(si) = pi ∈(0, 1], tree RT will be optimal under payoff model (a)
if ci/Ri < g(a)
i for all si on RT. Also, given G and P(si) = pi ∈(0, 1], tree RT will be optimal
under payoff model (b) if(ci+1/ci) < (Ri+1/Ri) for all si and si+1 on RT.
Energy efﬁciency and sensor lifetime are also affected by the length of routing paths since
longer paths result in energy consumption at more sensors. The strategy space of each sensor in the
geographically routed RQR game includes only those neighbors closer to the destination than itself.
Routing paths under this regime are thus implicitly length constrained. For each sensor, the set of
downstream neighbor nodes to a given destination can be found using protocols such as GFG [31]
and greedy perimeter stateless routing (GPSR) [32].
16.10
PROFIT DRIVEN ROUTING IN COGNITIVE NETWORKS
16.10.1
Algorithmic mechanism design
In order to introduce category differential cost or proﬁt in to our analysis, in this section we will
use additional results and even terminology from economics and mechanism design theory. Conven-
tionally in these ﬁelds, typical scenarios in which the agents act according to their own self-interests
are modelled with n agents where each agent i, for i ∈{1, . . . , n}, has some private information ti,
called its type. Applied to the routing problem, type ti is the cost to a node’s of forwarding a packet
in unicast scenario. All agents’ types t =

t1, t2, · · · , tn
deﬁne a type vector, which is called the
proﬁle. Given a reported proﬁle, there is an output speciﬁcation O that maps each type vector t to an
allowed output. For each possible output o, agent i′s preferences are given by a valuation function wi
that assigns a real numberwi 
ti, o

, which does not depend on other agents’ types.
Given a reported proﬁle a =

a1, · · · , an
, a mechanism deﬁnes an output O (a) and a payment
vector p (a) =

p1 (a) , · · · , pn (a)

,where pi = pi (a) is the money given to each participating agent
i. Agent i′s utility is ui (a) = wi 
ti, (a)

+ pi (a). A rational agent i always tries to maximize its
utility ui (a) by choosing its action ai. A mechanism satisﬁes the incentive compatibility (IC) if each
agent maximizes its utility by reporting its type ti regardless of what other agents do. A mechanism
satisﬁes the individual rationality (IR) (also called voluntary participation) if each agent’s utility
of participating in the action is nonnegative. A mechanism is strategyproof (or called truthful) if it
satisﬁes both IC and IR properties.
The family of Vickrey–Clarke–Groves (VCG) mechanisms suggested by Vickrey [34], Clarke
[35], and Groves [36] are effectively used in mechanism design maximization problems where the
objective function g(o, t) is the sum of all agents’ valuations, i.e. g(o, t) = 
i wi(ti, o), and the set of
possible outputs is assumed to be ﬁnite. This is equivalent to social optimum in game theory discussed
so far in this section. This maximization mechanism design problem is often called utilitarian. A
mechanism M = (O(t), p(t)) belongs to the family of VCG mechanisms if (a) the output o = O (t)
computed based on the type vector t maximizes the objective function g(o, t) = 
i wi(ti, o), and
(b) the payment to an agent i is of the format pi(t) = 
j̸=i w j(t j, O(t)) + hi(t−i). Here, hi( ) is
an arbitrary function of t−i. A VCG mechanism is truthful [36] under mild assumptions, VCG
mechanisms are the only truthful implementations for utilitarian problems[19]. Analogous to game

PROFIT DRIVEN ROUTING IN COGNITIVE NETWORKS
833
theory and notation used so far, a−i denotes the vector of strategies of all agents except i, i.e.
a−i = (a1, a2, · · · , ai−1, ai+1, · · · , an) and a|ib = (a1, a2, · · · , ai−1, b, ai+1, · · · , an), i.e. each agent
j ̸= i uses strategy a j, except that the agent i uses strategy b. V = {v0, v1, · · · , vn−1} is a set of n
wireless nodes where v0 is used to represent the access point (AP) of the wireless network. G = (V, E)
is the communication graph deﬁned by V , where E is the set of links (vi, v j) such that the node vi
can communicate directly with the node v j. It will be assumed that G is node biconnected which
means that the remaining graph, after removing any node vi and its incident links from G, is still
connected. In addition to providing fault tolerance, in this context the biconnectivity of the graph G
will prevent the monopoly of nodes. We assume again that each wireless node vi has a ﬁxed cost
ci of relaying/sending a data packet to any (or all) of its outgoing neighbors. This cost ci is private
information, only known to node vi. All n nodes together deﬁne a cost vector c = (c0, c1, · · · , cn−1),
which is the proﬁle of the network G. In the model used in this section, when a node vi wants to
make a guaranteed proﬁt zi, its declared ‘cost’ should be ci + zi.
When a node vi sends data to the access point v0, the least cost path (with minimum total relaying
cost) from node vi to node v0, denoted by p (vi, v0, c), is used to route the packets. For a path
 (i, 0) = vrs, vrs−1, · · · vr1, vr0 connecting node vi and node v0, i.e. vrs = vi and vr0 = v0, where
node vr j can send signals directly to node vr j−1, the cost of the path  (i, 0) is deﬁned as s−1
j=1 cr j ,
which excludes the costs of the source node and the target node.
To stimulate cooperation among all wireless nodes, node vi pays some nodes of the network to
forward the data to the access point. Thus, each node v j on the network declares a cost d j, which is
its claimed cost to relay the packets. Note that here, d j could be different from its true cost c j. Then,
node vi computes the least cost path p (vi, v0, d) to connect to the access point v0 according to the
declared cost vector d = (d0, d1, · · · dn−1). For each node v j, a payment p j
i (d) is computed according
to the declared cost vector d. The utility of node v j is u j(d) = p j
i (d) −x j(i) · c j, where x j(i) ∈{0, 1}
indicates whether v j relays the packet for vi. We always assume that the wireless nodes are rational:
each always tries to maximize its utility u j(d). At the beginning we assume that the wireless nodes
do not collude to improve their utilities. We will relax this assumption later.
16.10.2
Proﬁt driven pricing mechanism
In this protocol, the payment to a node vk on the LCP (least cost path) is dk plus the difference
between the cost of the least cost path without using vk and the cost of the least cost path. This simply
means that there is no cheaper alte1rnative. For a formal deﬁnition let us assume that the node vi has
to send packets to v0 through the relay of some other nodes. It pays these relay nodes to compensate
their costs for carrying the transit trafﬁc incurred by vi. The output (d) of the mechanism is the path
connecting vi and v0 with the minimum cost, which is known as P(vi, v0, d). The payment to a node
vk is 0 if vk /∈P(vi, v0, d). Otherwise, its payment is:
pk
i (d) =
&&P−vk(vi, v0, d)
&& −
&&&&P(vi, v0, d)
&&&& + dk
(16.121)
Here, P−vk(vi, v0, d) denotes the least cost path between node vi and v0 without using node vk, and
∥∥denotes the total cost of a path .
This payment falls into the VCG mechanism, so it is strategyproof. In other words, if dk = ck,
node vk maximizes its utility pk
i (d) −xk (i) · ck. Every node participating in the relay will have a
nonnegative proﬁt; every node that does not relay the trafﬁc will have proﬁt 0. In this concept we need
the network to be biconnected, in order for the path P−vk (vi, v0, d) to exist. Otherwise, node vk can
charge a monopoly price since it is a critical node for connecting vi and v0 with no alternative. The
access point can collect all nodes’ costs, and the network structure G and can compute the payment
to all relay nodes in a centralized manner. Using Dijkstra’s algorithm to calculate the payment for
all nodes on P (vi, v0, d) would be rather inefﬁcient. For a network with n nodes and m edges, in the
worst case, there will be O (n) nodes on P (vi, v0, d), so such an algorithm would result in a time
complexity O(n2 log n + nm). A fast payment calculation algorithm for edge weighted graph (by

834
COGNITIVE NETWORKS AND GAME THEORY
srV
jrV
1rV
k
V
sr
V
a
V
b
V
P
 
Figure 16.12 Computing vk-avoiding shortest path.
assuming the edges are rational agents) is given in [38]. A method for ﬁnding the most vital node of
a shortest path in an edge weighted graph in time O(m + n log n) is presented in [39].
Based on ideas from [38], an O(m + n log n) time complexity algorithm for fast payment calcula-
tion in a node weighted graph is presented in [33]. To calculate (16.121) the algorithm with computing
∥P−vk(vi, v0, d)∥for a node vk ∈P(vi, v0, d). The basic idea of the algorithm is for a pair of nodes
va,vb such that vavb ∈G, the path P−vk(vi, va, d) and P−vk (vb, v0, d) are calculated separately. Then,
by concatenating P−vk(vi, va, d), link va, vb, and P−vk(vi, va, d), we obtain the path with the minimum
cost from vi to v0 without node vk and having va, vb on it. Choosing the minimal cost path for all
edges va, vb ∈G, we ﬁnd ∥P−vk(vi, v0, d)∥, as illustrated in Figure 16.12.
In wireless ad-hoc networks, due to lack of a centralized authority, it is more desirable to compute
the payment in a distributed manner. Assume that there is a ﬁxed destination node v0.The distributed
algorithm presented in [33,40] computes the payment of each node vi to all its relay nodes. The
distributed algorithm has two stages. First, all nodes together ﬁnd the shortest path tree (SPT) rooted
at node v0. It is assumed that the SPT tree does not have a loop. This step can be easily implemented
using Dijkstra’s algorithm. Once a shortest path tree T rooted at node v0 is formed, and every node
knows its parent and children in tree T, in the second step every node vi computes its payment pk
i as
follows:
(i) set pk
i ←∞, if vk ∈P (vi, v0, d); otherwise, pk
i ←0;
(ii) broadcasts its entries pk
i to its neighbors;
(iii) while vi receives an updated price from a neighbor v j
do
(iv) if v j is the parent of vi then
(v) pk
i ←min

pk
i , pk
j

if vk ∈P (vi, v0, d)
(vi) (vi) else if vi is the parent of v j then

PROFIT DRIVEN ROUTING IN COGNITIVE NETWORKS
835
(vii) pk
i ←min

pk
i , pk
j + di + d j

if vk ∈P (vi, v0, d)
(viii) else
(ix) for every vk ∈P (vi, v0, d), viupdates pk
i as follows:
(x) if vk ∈P

v j, v0, d

then
(xi) pk
i ←min

pk
i , pk
j + d j +
&&P

v j, v0, d
&& −∥P (vi, v0, d)∥
;
(xii) else
(xiii) pk
i ←min

pk
i , dk + d j +
&&p

v j, v0, d
&& −∥P (vi, v0, d)∥
(xiv) Broadcasts its entries pk
i to its neighbors.
Whenever some entry pk
i stored at node vi changes, the entry pk
i is sent to all neighbors of vi by node
vi. When the network is static, the price entries decrease monotonically and converge to stable values
after a ﬁnite number of rounds (at most, n rounds).
16.10.3
Truthful behavior in cognitive networks
The node vi has the incentive not to correctly calculate his payment pk
i in the second stage, and even
to lie about his shortest path in the ﬁrst stage. To illustrate these incentives we use the graph in Figure
16.13 where the shortest path between v0 and v1 should be v1v4v3v2v0.
For dk = 1 it is easy to calculate that v′
1s payments to nodes v2, v3, and v4 are all exactly 2. Then,
the overall payment by node v1 is 6. If node v1 lies that it is not a neighbor of v4, then its shortest
path becomes v1v5v0. Now, it only needs to pay v5 5 to send a packet. Thus, node v1 beneﬁts by lying
about its neighborhood connection information, which consequently changes the SPT. This problem
rises from the fact that the least cost path is not necessarily the path that you pay the least.
By noticing that the distributed method of computing the payment relies on the selﬁsh node vi to
calculate the payment pk
i to node vk, which cannot prevent node vi from manipulating the calculation
in its favour, [40] suggests using the following approach: all agents are required to sign all messages
that they send and to verify all messages that they receive from their neighbors. Reference [40] claims
that the protocol can be modiﬁed so that all forms of cheating by agents are detectable. They did
not consider the possible scenario when an agent could lie about the topology (the scenario we just
discussed in previous paragraph).
0v
5v
6v
1v
2v
3v
4v
1
1
1
5
4
Figure 16.13 Illustration of the node’s incentive to lie about its shortest path.

836
COGNITIVE NETWORKS AND GAME THEORY
In [33] a different distributed method was presented that prevents nodes from lying about the
topology, and miscalculating the payment, and it does not need to store all messages. The nodes use
the following algorithm to compute the shortest distance to source:
(i) Every node vi has two variables: D (vi) stores the shortest distance to v0 and F H (vi) stores
its parent on SPT. Initially, if v0 is v′
is neighbor then set D (vi) to 0 and F H (vi) to v0; else
set D (vi) to ∞and F H (vi) to NULL.
Node vi broadcasts its information to its neighbors.
(ii) while vi received information from its neighbor v j do
(iii) if D (vi) > D

v j

+ c j then
(iv) D (vi) ←D

v j

+ c j, and F H

v j

←v j;
(v) if vi ̸= F H

v j

and D (vi) + ci < D

v j

; or vi = F H

v j

and D (vi) + ci ̸= D

v j

then
(vi) node vi contacts v j directly using reliable and secure connection, asking v j to update his
D

v j

to D (vi) + ci and F H

v j

to vi. After the necessary updating, v j must broadcast
his information.
(vii) Node v j broadcasts its information to its neighbors.
and then use the following algorithm to compute the payment to the relay nodes:
(i) (i) Set pk
i ←∞, if vk ∈p (vi, v0, d); otherwise, pk
i ←0.
(ii) (ii) Broadcasts its entries pk
i to its neighbors.
(iii) (iii) while vi received information pk
j from its neighbor v j do
(iv) (iv) vi updates pk
i using algorithm 2 (Steps 4–15).
(v) (v) when pk
i changes, vi broadcasts the value of pk
i , and the ID of the node p j that triggered
this change.
(vi) (vi) if vi triggered the change for this pk
j from v j, vi recalculates pk
j for v jusing algorithm
2 (Steps 4–15) to verify it. If his answer and the payment sent from v j do not match, node vi
then notiﬁes v j and other nodes.
(vii) Node v j will then be punished accordingly, e.g. v j is dropped from the network by all nodes.
It is easy to verify that they are truthful and no node will lie about its neighbor information and
will follow the payment calculation procedure. For the example illustrated in Figure 16.13, node vi
has to use the shortest path v1v4v3v2v0 to compute the payment according to the latest protocol since
node v4 knows the existence of this shortest path and it will detect the lie by node v1 if node v1 choose
to use path v1v5v0 instead. The problem remaining is how to make it more efﬁcient.
16.10.4
Collusion of nodes in cognitive networks
In general, the nodes may collude with each other in the hope of gaining as a group. For example,
if two nodes vk1 and vk2 know that the removal of them will disconnect some nodes from the access
point, then these two nodes can collude to declare arbitrarily large costs and charge a monopoly price

PROFIT DRIVEN ROUTING IN COGNITIVE NETWORKS
837
together. Notice that, by declaring much higher costs together, one node’s utility may decrease, but
the sum of their utilities is guaranteed to increase, which they can agree to share.
A mechanism is said to be k-agents strategy proof if, when any subset of agents of size k colludes,
the overall utility of this subset is made worse off by misreporting their types. A mechanism is true
group strategyproof if it is k-agents strategy proof for any k.
There is no a true group strategyproof mechanism for the unicast routing problem studied above.
For example if all nodes but node vi collude and declare arbitrarily high costs, then node vi has to pay
a payment arbitrarily higher than the actual payment it needs to pay if these nodes do not collude.
In the following we focus on a simpler problem and study how to design a truthful mechanism such
that it can prevent nodes from colluding with its one-hop neighbors. Notice that the VCG payment
scheme (16.121) does not prevent a node from colluding with its neighbors at all. It is not difﬁcult
to construct an example such that, for a node vk ∈P (vi, v0, d), the path P−vk (vi, v0, d) uses a node
vt that is a neighbor of vk and vt ∈p (vi, v0, d). Then, vt can lie its cost up to increase the utility of
node vk.
If vi pays other nodes to relay the data to another node v j when N(vk) is the set of neighbors
of node vk, including node vk then to have a payment scheme that prevents collusion between any
two neighboring nodes, it is necessary that the graph resulted by removing N (vk) still has a path
connecting vi and v j. By assuming that graph G\N (vk) is connected for any node vk, [31] designs
the following payment scheme ˜p that avoids the collusion between any two neighboring nodes. The
payment ˜pk
i (d) to a node vk is:
˜pk
i (d) =
&&P−N(vk) (vi, v0, d)
&& −
&&&&P (vi, v0, d)
&&&& + xk (i) · dk
(16.122)
where P−N(vk) (vi, v0, d) is the least cost path connecting vi and v j in graph G\N (vk) without using
any node in N (vk), and xk denotes whether a node vk is on the least cost path or not. Notice that the
payment to a node vk /∈P (vi, v0, d) could be positive when node vk has a neighbor on P (vi, v0, d).
This is a main difference to the payment scheme in Equation (16.121) based on VCG. The payment
scheme ˜p is a strategy proof mechanism that prevents any two neighboring nodes from colluding,
because each individual node will be truthful since the mechanism belongs to the family of VCG
family [40–42]. For any two neighboring nodes vk and vl, their utilities can be written as:

uk (c) = n−1
t=0 vt (o (c) , ct) + h−k 
c−N(vk)
ul (c) = n−1
t=0 vt (o (c) , ct) + h−l 
c−N(vt )
(16.123)
Summing them up, we get
ul (c) + uk (c) = 2
n−1

t=0
vt 
o (c) , ct
+ h−k 
c−N(vk)
+ h−l 
c−N(vl)
(16.124)
Notice that h−k(c−N(vk)) + h−l(c−N(vl)) does not depend on dl and dk since vk and vl are neighbors of
each other. In addition,  vi(o(c), ci) is maximized when they reveal their true costs. Thus, vk and vl
will maximize their total utilities by revealing their true costs.
This concept can be extended to a more general case to prevent some groups of nodes from
colluding. Let {Q(v1), Q(v2), · · · , Q(vn)} be a set of subsets of nodes, i.e. Q(vk) ⊂V . We are
interested in designing a truthful mechanism such that any node vk cannot collude with other nodes
in Q(vk) to increase their total utilities. If vk ∈Q(vk), for1 ≤k ≤n the mechanism is truthful if the
output is the least cost path connecting the source vi and destination v0, and the payment ˜pk
i (d) to a
node vk is
˜pk
i (d) =
&&P−Q(vk) (vi, v0, d)
&& −∥P (vi, v0, d)∥+ xk (i) · dk
(16.125)
Obviously, we need graph G\Q (vk) to be connected for any node vk.
Another possible collusion happens after the payment is calculated and during the process of
actually routing the packets. Let total payment pi = n−1
k=0 pk
i , of node vi to all relay nodes on
the least cost path is P(vi, v0, c) and pi > p j + max(p j
i , c j) for some neighbor v j of vi. Notice

838
COGNITIVE NETWORKS AND GAME THEORY
7
V
8
V
6
V
5
V
3
V
0
V
2
V
4
V
9
V
1
V
2
2
2
2
6
6
7
5
5
Figure 16.14 Wireless network with the node cost where the directed links form the shortest
path tree from v0 to every vi.
that max(p j
i , c j) = x j(i)p j
i + (1 −x j(i))c j since if v j is on LCP P(vi, v0, c), then p j
i ≥c j and
p j
i = 0 < c j otherwise. Here, x j(i) indicates whether node v j is on P(vi, v0, c). In this situation, vi
and v j can collude in their favor as follows: (i) v j sends the data packets forvi and v j pays all relay
nodes on path P(vi, v0, c). (ii) vi pays v jthe cost p j + max(p j
i , c j), which covers the payment by
v j. c) vi and v j split the difference pi −(p j + max(p j
i , c j)), which is the saving of node vi from
colluding with node v j. Notice that it is possible that p j + max(p j
i , c j) for some neighbor v j of vi.
Figure 16.14 illustrates an example of such collusion.
Using the payment function, it is easy to compute that p8 = 20, p4 = 6, and p4
8 = 0. Notice
c4 = 5. Thus, v8 can ask v4 to forward the data packets using its LCP to v0. Node v8 pays node v4 a
price 6 + 5 = 11 to cover its payment p4 and its cost c4, and half of the savings, which is 4.5. Thus,
the total payment of node v8 is only 15.5 now, which is less than p8 and node v4 also increases its
utility from 0 to 4.5.
16.11
GAME THEORETICAL MODEL OF FLEXIBLE SPECTRA SHARING
IN COGNITIVE NETWORKS WITH SOCIAL AWARENESS
We assume a radio network with two type of users. The type a users use much a wider frequency
band Ba, say WLAN based on OFDM, and type b users use a much narrower band Bb, say voice
users or low rate data systems. Both types of terminal are frequency agile so that the radio resource
management can continuously repack the users any time when a user leaves the channel. So for an
available frequency band B = Bu(t) ∪Bc(t), in any time instant all active users are arranged so to
occupy all frequencies f in the range fmin < f ∈Bu(t) < f0(t) in the used bandwidth Bu(t) and the
rest of the bandwidth B is free for contention of new arrivals and will be referred to as Bc(t) . The used
bandwidth and contention bandwidth do not overlap and the they change in time. To avoid collisions
listen before talk principle is used by scanning the band and if nonzero Bc(t) is detected the spectra
is accessed with probability p.
In an advanced society, decision-making and strategy-setting people do not ( or will not in the
future) behave like the self-interested ‘rational’ actor depicted in neoclassical economics and classical
game theory [43]. In an HE (homo equalis) society, individuals have an inequality aversion. An HE
society [43] can be modelled with a utility function of player i, ui in an n-player game as:
ui = xi −
αi
n −1

x j >xi
(x j −xi) −
βi
n −1

x j <xi
(xi −x j)
(16.126)
where x =

xi, . . . , x j

are the payoffs for each player and 0 ≤βi < αi ≤1. βi < αi reﬂects the fact
that HE exhibits a weak urge to inequality when doing better than the others, and a strong urge to
reduce inequality when doing worse than the others. In [43], it is shown that in this model, equilibria
in public goods (social awareness) games, with fairness, can be reproduced.

A GAME THEORETICAL MODELLING OF SLOTTED ALOHA PROTOCOL
839
0
0,05
0,1
0,15
0,2
0,25
0,3
0,35
0,4
0,45
0,5
0
2
4
6
La/Lb
airtime (share)
RS A (theoretical)
RS B (theoretical)
RS A (HE)
RS B (HE)
Figure 16.15 Airtime achieved with different weight ratios La/Lb and no queueing.
The inequality aversion property of the HE agents is utilized in [44] to achieve fairness in the
spectrum access problem. In this scheme, each radio system learns the access probability pi by itself.
Here, we deﬁne Onlinetimei = toni as the averaged cumulative ‘on’ spectrum time per radio system
of type i. Then, we deﬁne xi = toni/Li, where Li = θiλi , θi is the priority parameter and λi is
the trafﬁc load for a type i radio system. The cumulative toni is normalized by the radio system’s
trafﬁc load and priority, which makes this spectrum access scheme able to adapt to different trafﬁc
loads and priorities and, hence, achieve more efﬁciency and maintain weighted fairness deﬁned as
toni/Li = tonj/L j = K, ∀i, j. With initial pi = 1, each time the probability pi is updated, as follows:
pi = max

0, min

1, Pi +
αi
n −1

x j ≥xi
 x j −xi
x j

−
βi
n −1

x j <xi
 xi −x j
xi




for all j ̸= i
(16.127)
where n is the number of different radio system types. This forces each radio system to make an
effort to use the idle spectrum efﬁciently while taking fairness into consideration. Here the only local
information needed is the radio system’s own history of the onlinetime and the onlinetime of the other
radio systems whose spectrum is within the same spectrum block. Figure 16.15 illustrates the system
performance.
16.12
A GAME THEORETICAL MODELLING OF SLOTTED
ALOHA PROTOCOL
The ‘listen before talk’ principle used in the previous section for spectrum access would correspond
to the CSMA/CD protocol for channel access in packet networks. In this section we discuss ﬁnite-
size slotted ALOHA sensor networks with CDMA channel and selﬁsh sensors [45–51]. Each sensor
wishes to maximize its individual expected reward. The system exploits decentralized channel state
information (CSI) to obtain transmission policies that are optimal for each sensor. The problem is
formulated as a ﬁnite player, ﬁnite action, noncooperative stochastic game, where each sensor is a

840
COGNITIVE NETWORKS AND GAME THEORY
selﬁsh but rational player. We consider a network of K (K < ∞) sensors where the uplink signal to
noise ratios (SNRs) γi represent the channel states of a sensori. The channel state of the networks
is ¯γ →(γ1, γ2, .., γK). We assume that at the beginning of each time slot sensor i knows its γi. Let
Fi (.) be the probability distribution function of γi. During a time slot, if sensor i does not transmit,
a waiting cost is c(i)
w ; if it transmits and its packet is not received successfully, a transmission cost is
c(i)
t . Finally, if sensor i transmits and its packet goes through, a reward of 1 −c(i)
t
is obtained with the
necessary condition 0 ≤c(i)
w < c(i)
t
< 1 for all sensors i. We consider CDMA systems with matched
ﬁlter receivers where a packet from sensor i is considered successfully received if:
Pj
σ 2 + PI−j
= γ j
J−j
> β
J−j = 1 + 1
N
K

i̸= j
γi
PI−j = 1
N
K

i̸= j
Pi
(16.128)
where Pj is the received power of sensor i, Pj = γ jσ 2; σ 2 is the noise power, N is the spreading
gain and β is required SNIR (signal to noise plus interference ratio) that guarantee a certain QoS
requirement. The noncooperative stochastic game is deﬁned as follows:
r The set of players I is the set of sensors indexed by i = 1, 2, . . . , K.
r For any player i; i = 1, 2, . . . , K, the set of actions includes either wait (W) or transmit (T),
denoted as Ai = {W, T }. A player can choose to transmit with some probability, i.e. randomized
strategies are allowed.
r A strategy is a mapping from channel states to transmit probabilities and the strategy of sensor i
will be a function pi (.) : R+ →[0, 1].
If we drop indices for simplicity, the expected reward of sensor 1 when it plays with transmit
policy p (.), is:
L (p (.)) =
' ∞
0
(p ( ¯γ )  ( ¯γ ) −(1 −p ( ¯γ )) cw) f ( ¯γ ) d ¯γ
=
' ∞
0
p ( ¯γ ) ( ( ¯γ ) + cw) f ( ¯γ ) d ¯γ −cw
(16.129)
where  ( ¯γ ) is the expected reward when the channel state of the sensor is ¯γ . For a CDMA ALOHA
system with matched ﬁlter receivers and SINR threshold reception model,  ( ¯γ ) is:
(γ ) =
∞
'
0
. . .
∞
'
0
#
I
 γ
J−1
> β

−ct
$
dF2 (γ2) . . . dFK (γK)
(16.130)
where I (.) is the indicator function. Maximizing the expected reward of the player 1 can be formulated
as:
max
p(.)
L (p (.))
(16.131)
It can be shown for the game deﬁned above that there exists a Nash-equilibrium at which each
sensor adopts a threshold transmission strategy:p (γ ) = I (γ > θ) for some θ ∈[0, ∞).
To prove it let us rewrite Equation (16.130) for sensor 1 in the network as:
 (γ ) = EF2(γ2),...,FK (γK )[I (SINR > β) |p2 (.) , . . . , pK (.)] −ct
= Pr ((SINR > β) |p2 (.) , . . . , pK (.)) −ct
= Pr

γ > β(σ 2 + PI−1) |p2(.), . . . , pK(.)

−ct
(16.132)

A GAME THEORETICAL MODELLING OF SLOTTED ALOHA PROTOCOL
841
It is obvious that  (γ ) is a nondecreasing function of γ . In addition,  (0) = −ct < −cw,  (∞) =
1 −ct > 0. As a result, there must exist a threshold θ so that  (γ ) + cw ≤0 for all γ ≤θ and
 (γ ) + cw > 0 for all γ > θ. The value of θ may vary among sensors. Since the objective is to
maximize L (p (.)) =
% ∞
0
p (γ ) ( (γ ) + cw) f (γ ) dγ −cw it is optimal to select:
p ( ¯γ ) =

1
if  (γ ) + cw > 0
0
otherwise
(16.133)
In other words p (γ ) = I (γ > θ) is always an optimal policy. It follows that there exists a Nash
equilibrium at which all players adopt (possibly different) threshold policies. The above applies to
any reception models that satisfy: (i) the expected probability that if a packet is received correctly,
 (γ ) + ct is a non decreasing function of γ ; (ii)  (0) + cw < 0, and (iii)  (∞) + cw > 0.
We now restrict the discussion to the class of threshold policies: p (γ ) = I (γ > θ), and since
the waiting cost cw is only a constant, we reformulate the optimization problem given by Equations
(16.127) and (16.131) as:
max
θ
L (θ) =
' ∞
0
I (γ > 0) ( (γ ) + cw) f (γ ) dγ
(16.134)
The gradient of the objective function is then:
∇θ L (θ) = ∇0
' ∞
0
I (γ > 0) ( (γ ) + cw) f (γ ) dγ = −( (θ) + cw) f (θ)
(16.135)
To utilize the gradient ascent method we need to obtain a unbiased estimate of:
 (γ ) = EF2(γ2),...,FK (γK )[I (SINR > β) |p2 (.) , . . . , pK (.)] −ct
(16.135a)
In practice, this can be done by using a temporary power control strategy in the learning phase to
make sure that the received SNR is equal to θ and counting the number of ACKs and NACKs that
are sent from the base station. If these counts are #(ACK) and #(NACK)
 (γ ) = EF2(γ2),...,FK (γK )[I (SINR > β)
 p2(.), . . . , pK(.)

= #ACK/(#ACK + #N ACK)
(16.136)
The Nash equilibrium is deﬁned as
θ∗=

θ : ∇θ L (θ) = 0, ∇2
θ L (θ) < 0

(16.137)
So, the algorithm for optimal strategy selection can be summarized as follows:
r initialization:
l = 1
θ (l) = θ
r sampling, evaluation of gradient and update loop:
while


θ (l)
+ cw
 > 0 do
estimate:
(
(l) 
θ (l)
using Equations (16.135) and (16.136);
Update Equation: θ(l+1) = θ(l) −εl

(
(l) 
θ (l)
+ cw

(16.138)
l = l + 1
end while
r
Conditions:
l=∞

l=1
εl = ∞;
l=∞

l=1
ε2
l < ∞
(16.139)

842
COGNITIVE NETWORKS AND GAME THEORY
System Throughput Comparison
0
1
2
3
4
5
6
0
5
10
15
20
25
30
Number of Sensors in the Network
Throughput
Decentralized Transmission Control with CSI
Optimal Transmission Control without CSI
No  Transmission Control
Figure 16.16 Throughput for three different transmission control schemes [45] c⃝IEEE
2005.
The sequence θ generated by the algorithm converges to the threshold level corresponding to a local
optimizer θ∗, deﬁned in Equation (16.137), of ( 16.134) of the sensor’s individual expected reward.
For a ﬁxed initial θ, the sequence ∇θ L(l) (θ) : l =1,2 . . . are i.i.d. Equation (16.138) is the well
known Robbins Munro algorithm. The convergence of this algorithm is proved in [48] under the con-
dition in (16.139) and uniform integrability of ∇θ L(l) (θ), which requires that the channel distribution
has ﬁnite variance. The above algorithm can be implemented in real time and can adapt to the changes
in the statistics of the network. For adaptability of the algorithm, step size depends on the speed of
the channel and remaining error in the parameter estimation. The faster channel will require large
step size that will result in the larger remaining steady state estimation error and vice versa. Figure
16.20 presents numerical results for slotted ALOHA CDMA networks with matched ﬁlter receivers
and random signature sequences in Rayleigh fading channels with ﬁxed transmission cost ct = 0.2
and cw = 0.02.
Figure 16.16 compares the system throughput obtained by using the above algorithm with two
other cases: (1) without transmission control (which means a sensor always transmits with certainty),
and (ii) using the algorithm in [51] for optimal transmission control without CSI. In the latter algorithm
p = A/S where A refers to number of arrivals and S to the number of backlogged packets. It can
be seen from ﬁgure that the system throughput obtained by the decentralized algorithm with CSI,
discussed in this chapter, is superior to the other two cases.
16.13
GAME-THEORY-BASED MODELING OF ADMISSION IN
COMPETITIVE WIRELESS NETWORKS
16.13.1
System model
In this section we will discuss the scenario where there are M service providers and N users.
At a given time t, let the number of users subscribing to provider i be denoted as n (t)i, where
1 ≤i ≤M. The users are not allowed to subscribe to multiple service providers at the same time
(with the same mobile device). In other words, M
i=1 n (t)i = N. Any user might become unsatisﬁed

GAME-THEORY-BASED MODELING OF ADMISSION IN COMPETITIVE WIRELESS
843
with the service it receives and decide to switch operators (a process called ’churning’). So, the
vector [n (t)1 , n (t)2 , . . . , n (t)M] changes continuously as the competition dynamics evolve due to
the user’s churning behavior. Since each user may choose any of the M service providers at any
time, the possible number of states in the system is given by M N. Modelling this dynamic as a single
game would make it complex. However, the assumption that each user is associated with only one
service provider at a time enables us to model this one-to-one relationship between a particular user
and his current service provider as a two-player game G j (for 1 ≤j ≤N) at any instant. Modeling
the admission control in this scenario will be based on a noncooperative and nonzero-sum game. The
game is noncooperative in nature because the service provider, on one hand, wants to maximize its
revenue, which is modeled as its payoff from this game. Its attempt to maximize user satisfaction,
system utilization, etc. is merely a way to achieve the ultimate goal of revenue maximization. Users,
on the other hand, want to maximize their satisfaction at a minimum expense, including the option to
churn to a better provider in a competitive market. Thus, the user’s overall satisfaction is modelled as
his payoff from the admission control game. Since these two goals are different and often conﬂicting
with each other, the service provider and customers do not have the apparent motivation to cooperate.
The game is also a nonzero-sum. In a zero-sum game, an increase in one player’s payoff implies
a decrease in the other player’s payoff. However, this may not be true for the relationship between
the payoffs of a wireless service provider and a customer. For instance, in an underutilized system,
admitting a new request that does not affect the QoS of other ongoing sessions would increase the
service provider’s revenue as well as the customer’s satisfaction. Thus, both the payoffs for the service
provider and the user are increased, implying that the game is nonzero-sum.
We start with the sequential admission control mechanism in which the requests are processed
one by one, i.e. one instance of the game is played every time a new session request is made. In the
next step, we will extend the game to admit a batch of n sessions at a time, leading to a (n + 1)-
player game. We assume that the service provider has two strategies: SS1 (admit the request) and
SS2 (reject the request). The customer seeking admission can have two strategies as well: CS1 (leave
the current provider) and CS2 (stay with that provider). The payoffs of the two players are expressed
by A = [ai j]2×2 and B = [bi j]2×2, where ai j and bi j denote the provider’s and customer’s payoff
respectively, if the provider chooses strategy SSi and the user chooses strategy CSj, for i ∈{1, 2}
and j ∈{1, 2}. In the sequel we will use the following notation
N, total number of users in the system;
K, number of user (customer) classes;
Ni, number of class i users currently in the system, 1 ≤i ≤K;
U, service provider’s current revenue (utility) coming from all the on-going sessions;
Ci, service provider’s average revenue earned from each session of class i user which depends on
the class number (i.e. priority) of the session, the average length of the session, and the pricing
scheme;
Li, service provider’s average revenue loss for losing a class i customer, where 1 ≤i ≤K. This is
estimated by the cost incurred by the provider to attract a new user into the system, assuming
the provider maintains a constant customer base;
Pbi, packet blocking probability for class i user, if the new session request is accepted;
Ri (Pbi), class i customer’s churn rate as a function of Pbi.
If a class k user is requesting a session admission, the provider’s payoff matrix A = [ai j]2×2 is
deﬁned as follows:
A =
!
C + Ck −F
U + Ck −F
U −Lk
U
"
(16.140)

844
COGNITIVE NETWORKS AND GAME THEORY
where
F =
K
i=k Ni Ri (Pbi)Li
and will be elaborated bellow in more detail. The term a21 = U −Lk denotes the provider’s payoff
if it chooses the strategy SS2 (reject) while the user chooses strategy CS1(leave). The payoff of the
service provider in this case is the current revenue coming from all on going sessions, minus the
revenue loss due to the churning of a class k user. The term a22 is simply the revenue from the
current on going sessions. The term a12 corresponds to the strategy pair (SS1– admit; CS2– remains).
In general this should yield the highest payoff for the provider. However, in a fully loaded system,
admitting a new customer would either result in an infeasible power assignment (for voice), or delay
of the ongoing sessions (for data). Either of these cases may incur revenue loss due to churning of
the customers whose on going sessions are being affected. How exactly the on going sessions are
affected depends on the rate control mechanism deployed in the system, which will be described later
in this section. The term a11 is deﬁned in a similar way, with one additional term of −Lk, which
corresponds to the revenue loss due to user churning.
Admitting a new request into a fully loaded system providing voice services is undesirable because
it causes dropping of ongoing calls. However, in CDMA wireless data networks, where infeasible
power assignment can be avoided by reducing the transmission rates of on-going sessions, the pros
and cons of admitting the new request should be further evaluated in order to maximize the revenue
for the service provider. These aspects are captured in the payoff values a11 and a12. The term
Ni Ri (Pbi) Li accounts for the total predicted revenue loss for all class i users currently having
ongoing sessions. The micro level rate control scheme ensures that when a class k user is admitted
and the wireless resource is inadequate, only users of the same class or lower classes will be affected.
Thus, F = K
i=k Ni Ri (Pbi)Li measures the total revenue loss from these classes of user. The churn
rate, Ri (Pbi), is obtained by applying a sigmoid utility function that will be presented later in this
section.
The user’s payoff matrix B = [bi j]2×2 is deﬁned as
bi j =

w1Ui j −w2Lc
for j = 1
Ui j
for j = 2
(16.141)
where Ui j is the user’s payoff (utility) from the game without considering churning and Lc is his
penalty if he chooses to churn. The term Lc models the situation where the customer still under
contract with the service provider, is charged a penalty for early termination.
When subscribing to a new service provider, a user may be charged a certain activation fee.
Moreover, Lc may differ from user to user due to a contractual agreement with the provider. Both
Ui j and Lc are expressed in monetary values. The weights w1 and w2 on the user’s payoff function
reﬂect his preference to save money and get satisfaction, respectively.
The class k user’s payoff (Ui j) without churning is given by:
Ui j =
#Ok (Pbk) q + Wa
for i = 1
0 + Wb
for i = 2
(16.142)
where Ok(Pbk) is the user’s utility (in the range of [0, 1]) as a function of the received rate, which
will be quantiﬁed later in this section, q is a constant factor mapping this utility value to a money
amount, and Wa (or Wb) is the user’s payoff when the request is admitted (or rejected).
Similarly to the power control game discussed in Section 16.1, a sigmoid-like function has been
used [52] to approximate the user’s satisfaction with respect to service qualities or resource allocation.
Here the sigmoid function is modiﬁed to incorporate the user’s utility with respect to Pbi. The utility
of class i user Oi (Pbi) is given by:
Oi (Pbi) =
1
1 + e−αi (βi −Pbi ) ,
(16.143)
where αi (range 20–50) and βi( range 0.1–0.2) are parameters that can be tuned to customize the
utility for a given class of user. Given the fact that the more the user is satisﬁed, the less likely he is

GAME-THEORY-BASED MODELING OF ADMISSION IN COMPETITIVE WIRELESS
845
going to churn, the churn rate is modelled as:
Ri (Pbi) = 1 −Oi (Pbi) = 1 −
1
1 + e−αi (βi −Pbi ) =
1
1 + eαi (βi −Pbi )
(16.144)
16.13.2
Equilibrium solutions
When the packet blocking probability Pbi = 0, ∀i ∈{{1, . . . , K}}, the strategy pair {SS1, CS2} =
{accept, stay} is a Nash equilibrium of the game, i.e. the service provider chooses to admit the
session request while the user chooses to remain with the provider. That comes from the fact that
when Pbi = 0, ∀i ∈{1, . . . , K}, the churn rate Ri (Pbi) ≈0 and a12 = U + Ck, a11 = U + Ck −
Lk, a21 = U −Lk, and a22 = U. In the provider’s payoff matrix A = [ai j]2×2, a12 > a11, a12 > a22,
and a12 > a21. Because we have Rk (Pbk) ≈0, the user’s payoff matrix B = [bi j]2×2 becomes:
B =

b11 = w1Wa −w2Lc
b12 = w1Wa
b21 = w1Wb −w2Lc
b22 = w1Wb
"
.
(16.145)
Since b12 > b11 because Wa > Wb, as argued while formulating the game, b12 > b22 and b12 > b21.
Given that a12 and b12 are the maximum elements in matrices A and B, respectively, we conclude that
strategy pair {SS1, CS2}={accept, stay} constitutes the Nash equilibrium to this game, by deﬁnition.
At the same time, the remaining three strategy pairs {SS1, CS1}, {SS2, CS1}, and {SS2, CS2} do not
yield an equilibrium.
In the case where Pbi ̸= 0,∃i ∈{1, . . . , K} there exists a pure strategy Nash equilibrium, but the
equilibrium point depends on values of certain terms in the payoffs. A pure strategy deﬁnes a speciﬁc
move or action that a player will follow in every possible attainable situation in a game. Such moves
may not be random or drawn from a distribution, as in the case of mixed strategies. If every player
plays a pure strategy, the payoffs to all the players are deterministic.
In this context we need the concept of dominant (or dominating) strategy in game theory. In a
bimatrix game deﬁned by two m × n matrices A and B, which are the payoffs of players P1 and P2,
respectively, for player P1, we say that ‘row i’ dominates ‘row k’ if ai j ≥akj, for j = 1, . . . , n. Here,
‘row i’ is called a dominant (or dominating) strategy for player P1 and ‘row j’ is called a dominated
strategy for player P1. The user P1 is equal or better off when he selects the dominating ‘row i’
compared with selecting the dominated ‘row k’. So, ‘row k’ can actually be removed from the game
because P1, as a rational player, would not consider this strategy at all.
When Pbi ̸= 0, ∃i ∈{1, 2, . . . , K} the equilibrium strategy pair

SSi, CSj

is deﬁned as follows:
i =

1
if Ck ≥K
i=k Ni Ri (Pbi) Li
2
otherwise
(16.146)
J =

1
if {i = 1 and b11 ≥b12} or {i = 2 and b21 ≥b22}
2
if {i = 1 and b11 < b12} or {i = 2 and b21 < b22}
If Ck ≥K
i=k Ni Ri (Pbi) Lia11 > a21 and a12 > a22. By deﬁnition, SS1 is the dominating strategy
and SS2 is the dominated strategy for the service provider. Since SS2(reject) can be eliminated, A
and B degenerate into two 1 × 2 matrices. Obviously, if b11 > b12, the user will choose strategy
CS1(leave) and, if b11 < b12, he will choose CS2(stay). When b11 = b12, the strategies CS1 and CS2
have no difference to the user. Without loss of generality, we assume the user chooses CS1. Hence, the
equilibrium strategy pair is {SS1, CS1}={accept,leave} if b11 ≥b12 or {SS1, CS2}= {accept, stay}
if b11 < b12.
If Ck < K
i=k Ni Ri (Pbi) Lia11 < a21 and a12 < a22. By deﬁnition, SS2 (reject) is the dominating
strategy and SS1 (stay) is the dominated strategy for the service provider. Following the same
logic as above, the equilibrium strategy pair is given by {SS2, CS1} = {reject,leave} if b21 ≥b22 or
{SS2, CS2} = {reject, stay} if b21 < b22.

846
COGNITIVE NETWORKS AND GAME THEORY
The rationale behind these decisions is that, if the revenue Ck generated from accepting the new
session request belonging to a class k user is greater than the possible revenue loss K
i=k Ni Ri(Pbi)Li
from user churning, then admitting the session is a better strategy.
Simulation results in [52] show that the strategy presented in this section can provide up to a 50 %
increase in a service provider’s revenues compared with the conventional approach, where the user’s
request is accepted as long as the total number of users does not exceed the total number of users the
system can support. For more information on this topic see [53–60].
16.14
MODELLING ACCESS POINT PRICING AS A DYNAMIC GAME
16.14.1
The system model
The interaction between an access point and user can be modelled using a simple two-player game
model. The game progresses in discrete time slots or ’periods.’ In general, the access point offers
connectivity at the beginning of time slot t at price pt. The game ends the ﬁrst time the user rejects
the access point’s proposal. The user’s utility function F(T, τ) is a function of the number T of time
slots the user chooses to connect and a parameter τ which we call the user’s intended session length.
T is a decision variable; it is a function of the actions the user takes in each time slot, speciﬁcally
the number of slots the client chooses to connect. In contrast τ is a type variable that speciﬁes the
maximum time the user would be interested in connecting. The user does not choose τ in the game,
but instead it is determined for the user by outside circumstances. The user knows the value of τ at
the beginning of the game while the access point only knows its probability distribution.
The user’s net payoff is F(T, τ) −T
t=1 pt, while the access point’s net payoff is T
t=1 pt. The
underlying assumption is that the access point’s marginal cost to provide the service to the client is
negligible. In the model, we use dynamic Bayesian game already discussed in Section 16.8.
In general, the strategy speciﬁcation of a dynamic Bayesian game is a mapping from a player’s
type, and a player’s information set to an action, or in a mixed strategy, to a distribution among
possible actions. Assuming players have ‘perfect recall,’ the information set is the history of actions
the player has observed. In our model, if the game reaches slot t, then the history is completely
speciﬁed by the previous prices charged. Thus, a pure strategy for an access point is simply a price
sequence. An access point’s mixed strategy, or behaviour strategy, is a probability distribution on
prices to charge in each slot t dependent upon the prices actually charged in earlier slots 1, . . . , t −1.
For the user, a strategy is speciﬁed as a mapping from its type and information set to an acceptance
decision, or to a probability of accepting.
For a user browsing the web the user’s utility is proportional to the length of time T that he gets
to browse the web, but his utility saturates after the maximum intended session length τ is reached.
Thus, his utility function F (T, τ) is written as:
F(T, τ) = U · min(T, τ)
(16.147)
The user’s type is speciﬁed by his utility per slot U and intended session length τ. The user knows the
values for U and τ while the access point just knows their distributions. For this case the following
strategy proﬁle is a perfect Bayesian equilibrium PBE.
Strategy 1: The user connects or remains connected in slot t iff t ≤τ and U > pt (‘my-
opic strategy’) while the access point charges a nondecreasing sequence of prices {pt}:
pt ∈arg max
p
pP(U > p).
An access point should pick its prices by considering just the prior distribution of U. In fact, it is a
PBE for the access point to pick a single maximizing value of pP(U > p), say p∗, and charge the
ﬁxed price pt = p∗in all time slots. Whenever a myopic client accepts price pt, the access point can
reﬁne his conditional distribution of U by lower bounding it by pt. One might have expected that an

MODELLING ACCESS POINT PRICING AS A DYNAMIC GAME
847
access point might want to try charging a higher price than pt after learning that the user’s utility is
at least pt. This intuition is not correct.
To prove it we ﬁrst, ﬁnd the access point’s optimal counter strategy to a user playing the ‘myopic
strategy’ [60, 61]. A pure strategy for the access point is a sequence of nonnegative prices {pt}∞
t=1 ∈
R{1,2,...}
+
used in each time slot t ∈{1, 2, . . .}which maximizes his expected revenue
J a
1 ({pt}) =
∞

t=1
pt P

U >
max
u∈{1,...,t} pu

P (τ ≥t) .
(16.148)
where superscript ‘a’ indicates the access point while the subscript ‘1’ indicates that it is the objective
from slot 1 onward. We can ﬁnd a maximizing sequence for Equation (16.148) even if we restrict
ourselves to nondecreasing sequences, because for any sequence { ˜pt} for which there exists a u such
that ˜pu < ˜pu−1, we can deﬁne a new nondecreasing sequence {pt} with pt = max ( ˜pt, . . . , ˜p1), giving
J a
1 ({pt}) ≥J a
1 ({ ˜pt}). In other words, an access point that has seen a myopic user accept a price pt
knows that he can charge at least pt in slot t + 1 without any risk of exceeding the user’s willingness
to pay. If S+ is the set of nondecreasing price sequences; that is {pt} ∈S+ if {pt}∞
t=1 ∈R∞
+ and
pt+1 ≥pt∀t ∈{1, 2, . . .}, the access point should choose a positive sequence of prices to maximize
his expected revenue, as:
max
{pt }∈S+ J a
1 ({pt}) = max
{pt }∈S+
! ∞

t=1
pt P (U > pt) P (τ > t)
"
(16.149)
Because U and τ are ﬁnite mean, one can substitute their bounds into Equation (16.149) to show
that the access point’s expected payoff against a myopic client is bounded [62]. Each term in the
summation of Equation (16.149) is a function of a different price pt, so the entire sum can be
maximized by independently maximizing each term in the summation. y (p) = pP (U > p) is a
continuous, nonnegative function, with y (0) = 0, and limp→∞y (p) = 0, and thus must achieve a
maximum on [0, ∞). Thus, if the access point chooses each pt such that pt ∈arg maxp pP (U > p),
with {pt} ∈S+, then the access point maximizes his expected payoff Equation (16.149).
It is straightforward to see that the myopic strategy is a best user’s response to an access point that
never lowers prices. Because the players’ strategies are best responses to each other, they constitute
a (Bayesian) Nash equilibrium strategy proﬁle.
The strategy proﬁles remain best responses to each other in any continuation game, beginning at
an arbitrary slot s, i.e. the strategy proﬁle is a PBE. A user facing nondecreasing prices in this game
will face nondecreasing prices in any continuation game starting at slot s. Thus, a user that expects
nondecreasing prices should stick to the myopic strategy in the continuation game beginning at slot
s. An access point that expects his client to be myopic should choose his prices in the continuation
game to maximize
J a
s
{pt}∞
t=s

=
∞

t=s

pt P

U >
max
σ∈{s,...,t} pσ
 U > ps−1

P (τ ≥t|τ ≥s)

(16.150)
For any price sequence { ˜pt}∞
t=s
which has prices that are less than
ps−1, we see that
J a
s
{max ( ˜pt, ps−1)}∞
t=s

≥J a
s
{ ˜pt}∞
t=s

. Thus, the access point can maximize its reward by selecting
its continuation game prices to be no smaller than ps−1. Thus, assuming pσ ≥ps−1 for all σ ≥s, we
may write:
J a
s
{pt}∞
t=s

=
1
p (U > ps−1) ×
∞

t=s

pt P

U >
max
σ∈{s,...,t} pσ

1
P (τ ≥s) P (τ ≥t)

(16.151)
Note that Equation (16.151) has a structure that parallels that of Equation (16.148), with the exception
of the scaling factors 1/P (U > ps−1) and 1/P (τ ≥s), which have no dependence on the prices
chosen from slot s forward. Thus, the same argument that was used to show that Equation (16.148)
is maximized with a nondecreasing sequence with elements in arg maxp p p(U > p), can be used

848
COGNITIVE NETWORKS AND GAME THEORY
to show that Equation (16.151) is also maximized with a nondecreasing sequence with elements in
arg maxp pP (U > p). This shows that the access point strategy described in Strategy 1 remains a
best response to a myopic client in any continuation game.
16.14.2
Modelling service reselling
When the user is not within the range of the access point it begins a session by sending a request
for service to the reseller (relay). In order to serve the user’s request, the intermediate node sends
its own request for service to the ’root’ access point. As a response, the root access point passes the
reseller a ﬁrst slot price c1, which the reseller can either accept (and game continues) or reject (and
game stops). Before deciding to accept or reject the c1 price, the reseller sends its ﬁrst slot price p1
to the user. If the user accepts p1, the reseller in turn accepts the c1 price from the root access point.
If the user rejects p1, and assuming that the reseller had no other use for connectivity with the access
point than to serve the user, the reseller rejects the c1 price and the game ends. If the user and reseller
accept their offers in slot t, the game continues into slot t + 1 with the root access point choosing a
price ct+1 to offer the reseller, and the reseller choosing a price pt+1 to offer the user. The payoffs are
F (T, τ) −T
t=1 pt for the user, T
t=1 (pt −ct) for the re-seller, and T
t=1 ct for the access point.
In general, a pure strategy for the reseller is a mapping from prices he has been charged c1, . . . , ct,
as well as the prices the reseller charged in the past, p1, . . . , pt−1, to a price to charge in the current
slot, pt. If we denote the reseller’s history as hr
t ≡({cu}t
u=1, {pu}t
u=1) then a pure strategy for the
reseller is a speciﬁcation of the functions pt(hr
t ) for t = 1, 2, . . . The following strategy proﬁle for
the tree parties is a PBE.
Strategy 2:
(i) the user connects iff t ≤τand U > pt;
(ii) the reseller uses p∗(c) that satisﬁes the properties p∗(c) ∈arg max
p (p −c)P(U > p) with
p∗(c′) ≥p∗(c)
∀c′ > c and charges the price pt(hr
t ) := p∗(ct) in slot t;
(iii) the
access
point
charges
a
non
decreasing
price
sequence
{ct}
with
ct ∈
arg max
c
[c · P (U > p∗(c))]
The proof that Strategy 2 is PBE is based on similar arguments to those used in Section 16.14.1. The
details can be also found in [60, 61].
16.14.3
File transfer model
This model refers to a situation in which a user is downloading a ﬁle, and the user must remain
connected for the entire duration of the ﬁle (the intended session length) , to earn any utility for the
ﬁle. So, the user’s utility function has the form
F (T, τ) =
# 0
if T < τ
Uτ
if T = t
(16.152)
If we have a system with:
(i) the user has a ﬁle transfer utility function as in Equation (16.152), with U distributed on [l, h]
with 0 ≤l < h, and the session length τ, distributed on {1, . . . , n};
(ii) both U and τ have sample values known to the client, and unknown to the access point;

MODELLING ACCESS POINT PRICING AS A DYNAMIC GAME
849
(iii) U and τ are ﬁnite mean, and that U is continuously distributed.
(iv) then the Strategy 3, deﬁned bellow has perfect Bayesian equilibria:
Strategy 3: The user accepts slot t < τ iff pt = 0. When t = τ, the client connects if he had been
connected in all of the previous slots and Uτ > pt (he never connects if Uτ < pt but may connect
if Uτ = pt).
The access point charges
pt =
# 0
if t < t∗
u∗t∗
otherwise
where (u∗, t∗) ∈arg max(u,t) utP (U > u, τ = t)
The proof uses backward induction, and iterated deletion of dominated strategies as in Section 16.13.2.
The details can be found in [60, 61].
16.14.4
Bayesian model for unknown trafﬁc
In this section, we study the case in which the access point does not know if his user is a ﬁle transferer
or a web browser. Instead, the access point begins the game knowing the prior probability x that the
user is a ﬁle transferer. The user knows his true type as well as the value of x. We call this combined
model simply the Bayesian model [62].
When x is 0, the Bayesian model is equivalent to a ‘pure’ web browsing model, so constant price
is a PBE by Strategy 1. When x is 1, the Bayesian model is equivalent to a ’pure’ ﬁle transfer model,
where we know that constant price is not a PBE. Under the
Assumptions 1
(i) the user is a ﬁle transferer (FT) with probability x and a web browser (WB) with probability
1 −x;
(ii) the access point knows the value of x, while the user knows her true type;
(iii) users of both types have an intended session length of τ = 2, and this is known to both parties;
(iv) the utility per slot U is uniformly distributed on [0, 1];
(v) the user knows the sample value of U while the access point (AP) knows only the distribution;
(vi) the utility functions for WB and FT type clients are given by Equations (16.147) and (16.152)
respectively;
the following is true for the group of strategies:
Strategies 4: The (anticipative) strategy proﬁle (pair of player strategies), s∗= (s∗
AP, s∗
C) is a PBE
∀x ∈[0, 0.516], where the access point strategy, s∗
AP, and the type dependent client (user) strategy,
s∗
C, are deﬁned as follows:
Strategy 4a. s∗
AP: Charge the price sequence {p∗
1, p∗
2} in the two slots of the game, where the prices
p∗
1 and p∗
2 are dependent on x as
p∗
1 (x) =
4 −5x
2 (1 −x) (4 −x),
p∗
2 (x) =
4 −3x
2 (1 −x) (4 −x)
4a(i)s∗
C (W B): (WB clients) connect in slot 1 iff p1 < U; connect in slot 2 iff connected in slot 1
and p2 < U, which is a myopic strategy;
4a(ii)s∗
C (FT ): (FT clients) connect in slot 1 iff p1 + ˜p2 < Uwhere ˜p2, the price the client
expects intuitively in slot 2, is equal to p∗
2; connect in slot 2 iff connected in slot 1 and p2 < 2U.

850
COGNITIVE NETWORKS AND GAME THEORY
The (pessimistic) strategy proﬁle, s p = (s p
AP, s p
C) is a PBE ∀x ∈[((3 −
√
5)/2) ≈0.382, 1],
where the player strategies are:
Strategy 4b. s p
AP: charge the price sequence {0, (1/ (2 −x))};
Strategy 4b(i) s p
C (W B): the myopic strategy s P
C (W B) = s∗
C (W B);
Strategy 4b(ii) s p
C (FT ): the pessimistic strategy-connect in slot 1 iff p1 = 0 and connect in slot
2 iff connected in slot 1 and 2U > p2(the superscript p in s p means pessimistic strategy proﬁle).
Strategy 4c. For x > 0 there are no PBE in which the AP charges a constant price (p1 = p2) .
To prove the above statements we ﬁrst consider whether or not the client’s strategy s∗
C is a best
response to the access point strategy s∗
AP. The access point prices are nondecreasing in s∗
AP, and
we have seen that a web browser’s best response to nondecreasing prices is a myopic strategy, so
s∗
C (W B) is a best response. Similarly, when the AP plays s∗
AP, playing s∗
C (FT ) gives the highest
possible payoff to a FT user for all possible values of U. Furthermore, a FT user does not beneﬁt by
unilaterally deviating in the continuation game beginning in slot 2.
Next we consider whether s∗
AP is a best response to s∗
C. We begin by expressing the AP revenue
R (p1, p2), if users play s∗
C, as:
R (p1, p2) = p1

(1 −x) G (p1) + xG
 p1 + p∗
2 (x)
2

+ p2
×

(1 −x) G (max [p2, p1]) + xG

max
 p1 + p∗
2 (x)
2
, p2
2

(16.153)
where G (p) = P (U > p) = max ((1 −p) , 0). For each x, R (p1, p2) is piecewise quadratic in
(p1, p2) with regions divided by the lines p1 = p2, p1 + p∗
2 (x). For instance in the region p2 ≥p1
and p2 ≤p1 + p∗
2 (x);
R (p1, p2) = (x −1) p2
1 + xp2
2

1 −xp∗
2 (x)
2

(p1 + p2) −x
2 p1 p2
(16.154)
The maximum of R (p1, p2) in this region occurs at

p∗
1 (x) , p∗
2 (x)

, indicated in Strategies 4a, and
this point is also the global maximum across all the regions, whenever x ∈[0, 0.516] and where 0.516
is a decimal approximation to the root of a 6th order polynomial. Because the AP’s best response
prices match the prices the users anticipated, we have found a PBE. However for values of x larger
than this root, the global maximum occurs in the region where p2 ≥p1 + p∗
2 (x). Consequently the
AP wants to charge more in slot 2 than the user anticipated, and hence the strategy proﬁle is not a
PBE for x > 0.516.
Next we show that s p (Strategy 4b) is a PBE. Under the prices of s p
AP, users following s p
C connect
whenever connecting will result in a positive payoff, and do not connect otherwise. Thus, s p
C is a best
response to s p
AP, and furthermore the user’s best response in the continuation game beginning in slot
2 is to not deviate from s p
C.
With users playing s p
C, an AP can charge 0 in the ﬁrst slot, and keep the FT clients connected,
or choose a nonzero price and earn revenue from only the WB clients. If the AP chooses the latter
option, then he should maximize expected revenue from WB clients, which he can do by charging
1/2 in both slots, earning him an expected revenue of (1 −x)
)
2. If the AP chooses 0 for its slot 1
price, then both FT and WB clients would be potential customers in the second slot, and the AP’s
optimal second slot price is found by maximizing:
p2 (1 −x) P (U > p2) + p2x P

U > p2
2

(16.155)
which has maximum at p2 = 1/ (2 −x), earning an expected revenue of 1/ (4 −2x). The latter option
of charging {0, (1/ (2 −x))},which is the same as the s p
AP strategy deﬁned in Strategy 4b, earns more
expected revenue than does the option of charging 1/2 in each slot for x ∈[((3 −
√
5)/2), 1]. Thus,
s p
AP is a best response to s p
C for x ∈[((3 −
√
5)/2), 1].

REFERENCES
851
REFERENCES
1. Ji, H. and Huang, C. (1998) Non-cooperative uplink power control in cellular radio systems,
Wireless Networks, 4, 233–240.
2. Goodman, D. J. and Mandayam, N. B. (2000) Power control for wireless data, IEEE Personal
Communication Magazine, 7, 48–54.
3. Saraydar, C. U., Mandayam, N. B. and Goodman, D. J. (2001) Pricing and power control in a
multicell wireless data network, IEEE Journal of Selected Areas of Communication, 19, 1883–
1892.
4. Debreu, G. (1952) A social equilibrium existence theorem, in Proceedings of the Naional
Academy of Sciences, 38, 886–893.
5. Fan, K. (1952) Fixed point and minima theorems in locally convex topological linear spaces, in
Proceedings of the National Academy of Sciences, 38, 21–126.
6. Glicksberg, I. L. (1952) A further generalization of the Kakutani ﬁxed point theorem with
application to Nash equilibrium points, in Proceedings of the American Mathematical Society,
3, 170–174.
7. Dubey, P. (1986) Inefﬁciency of Nash equilibria, Mathematical Operational Research, 11, 1–8.
8. Mas-Colell, A., Whinston, M. D. and Green, J. R. (1995) Microeconomic Theory. Oxford Uni-
verity Press, Oxford, UK.
9. Fudenberg, D. and Tirole, J. (1991) Game Theory. MIT Press, Cambridge, MA.
10. Topkis, D. M. (1979) Equilibrium points in nonzero sum n-person submodular games, SIAM
Journal of Control and Optimization, 17, 773–787.
11. Topkis, D. M. (1998) Supermodularity and Complementarity. Princeton University Press, Prince-
ton, NJ.
12. Saraydar, C. U., Mandayam, N. B. and Goodman, D. J. (2002) Efﬁcient power control via pricing
in wireless data networks, IEEE Transactions on Communications, 50, 291–303.
13. Yates, R. D. (1995) A framework for uplink power control in cellular radio systems, IEEE Journal
of Selected Areas in Communication, 13, 1341–1347.
14. Koskie, S. and Gajic, Z. (2005) A Nash game algorithm for SIR-based power control in 3G
wireless CDMA networks, IEEE/ACM Transactions on Networking, 13, 1017–1026.
15. Ortega, J. and Rheinboldt, W. (1970) Iterative Solution of Nonlinear Equations in Several Vari-
ables. Academic Press, New York.
16. Meshkati, F., Poor, H. V., Schwartz, S. C. and Mandayam, N. B. (2005) An energy-efﬁcient
approach to power control and receiver design in wireless data networks, IEEE Transactions on
Communications, 53, 1885–1894.
17. Tse, D. N. C. and Hanly, S. V. (1999) Linear multiuser receivers: effective interference, effective
bandwidth, and user capacity, IEEE Transactions on Information Theory, 45, 641–657.
18. Low, S. H. and Lapsley, D. E. (1999) Optimization ﬂow control, I: Basic algorithm and conver-
gence, IEEE/ACM Transactions on Networking, 7, 861–874.
19. Felegyhazi, M., Hubaux, J. P. and Buttyan, L. (2006) Nash equilibria of packet forwarding
strategies in wireless ad hoc networks, IEEE Transactions on Mobile Computing, 5, 463–
476.
20. Axelrod, R. (1984) The Evolution of Cooperation. Basic Books, New York.

852
COGNITIVE NETWORKS AND GAME THEORY
21. Rapaport, A. and Chammah, A. M. (1965) The Prisoner’s Dilemma. University of Michigan
Press, Ann Arbor. Mich.
22. Trivers, R. (1971) The Evolution of Reciprocal Altruism, Quarterly Review of Biology, 46, 35–57.
23. Wahl, L. M. and Nowak, M. A. (1999) The continuous prisoner’s dilemma: I. Linear reactive
strategies, Journal of Theoretical Biology, 200, 307–321.
24. Srinivasan, V., Nuggehalli, P., Chiasserini, C. and Rao, R. (2003) Cooperation in wireless ad hoc
networks, INFOCOM 2003. Twenty-Second Annual Joint Conference of the IEEE Computer and
Communications Societies. IEEE, 2, 30 March–3 April, pp. 808–817.
25. Nurmi, P. (2004) Modelling routing in wireless ad hoc networks with dynamic Bayesian games,
IEEE Communications Society Conference on Sensor and Ad Hoc Communications and Net-
works, SECON, 4–7 Oct., pp. 63–70.
26. Kannan, R. and Iyengar, S. (2004) Game-theoretic models for reliable path-length and energy-
constrained routing with data aggregation in wireless sensor networks, IEEE Journal on Selected
Areas In Communications, 22, 1141–1150.
27. Pottie, G. (1998) Hierarchical information processing in distributed sensor networks, in Proc-
cedings International Symposium on Information Theory, Aug., pp. 163–168.
28. Rodoplu, V. and Meng, T. H. (1999) Minimum energy mobile wireless networks, IEEE Journal
of Selected Areas in Communications, 17, 1333–1344.
29. Shah, R. C. and Rabaey, J. M. (2002) Energy aware routing for low energy ad hoc sensor networks,
in Proccedings IEEE Wireless Communications Networking Conference (WCNC), Orlando, FL,
March, pp. 350–355.
30. Sohrabi, K., Gao, J., Ailawadhi, V. and Pottie, G. (2000) Protocols for selforganization of a
wireless sensor network, IEEE Personal Communication, pp. 16–27, October.
31. Bose, P., Morin, P., Stojmenovic, I. and Urrutia, J. (2001) Routing with guaranteed delivery in ad
hoc wireless networks, ACM/Kluwer Wireless Networks, 7, 609–616.
32. Karp, B. and Kung, H. T. (2000) GPSR: Greedy perimeter stateless routing for wireless networks,
in Proccedings ACM/IEEE MobiCom, Boston, MA, Aug. pp. 243–254.
33. Wang, W. and Li, X.-Y. (2006) Low-cost routing in selﬁsh and rational wireless ad hoc networks,
IEEE Transactions on Mobile Computing, 5, 596–607.
34. Vickrey, W. (1961) Counterspeculation, auctions and competitive sealed tenders, Journal of
Finance, 8–37.
35. Clarke, E. H. (1971) Multipart pricing of public goods, Public Choice, pp. 17–33.
36. Groves, T. (1973) Incentives in Teams, Econometrica, 617–631.
37. Green, J. and Laffont, J. J. (1977) Characterization of satisfactory mechanisms for the revelation
of preferences for public goods, Econometrica, 427–438.
38. Hershberger, J. and Suri, S. (2001) Vickrey prices and shortest paths: what is an edge worth?
IEEE Symposium on Foundations of Computer Science, n 8–11 Oct. 2001; pp. 252–259.
39. Nardelli, E., Proietti, G. and Widmayer, P. (2003) Finding the most vital node of a shortest path,
Theoretical Computer Science, 296, 167–177.
40. Feigenbaum, J., Papadimitriou, C., Sami, R. and Shenker, S. (2002) “A BGP-based mechanism
for lowest-cost routing, Proccedings ACM Symposium on Principles of Distributed Computing,
173–182.

REFERENCES
853
41. Moulin, H. and Shenker, S. (2002) Strategyproof sharing of submodular costs: budget balance
versus efﬁciency, Economic Theory.
42. Anderegg, L. and Eidenbenz, S. (2003) Ad hoc-VCG: a truthful and cost-efﬁcient routing protocol
for mobile ad hoc networks with selﬁsh agents, Proccedings ACM MobiCom Conference, 245–
259.
43. Gintis, H. (2000) Game Theory Evolving: A Problem-Centered Introduction to Modeling Strategic
Behavior. Princeton University Press, Princeton, NJ.
44. Xing, Y., Chandramouli, R., Mangold, S. and Sai Shankar N. (2006) Dynamic spectrum access
in open spectrum wireless networks, IEEE Journal on Selected Areas in Communications, 24,
626–637.
45. Krishnamurthy, V. and Ngo, M. H. (2006) A game theoretical approach for transmission strategies
in slotted ALOHA networks with multi-packet reception, is Proceedings IEEE International
Conference on Acoustics, Speech, and Signal Processing, (ICASSP ’05). 3, 18–23 March 2005,
pp. iii/653–iii/656.
46. MacKenzie, A. B. and Wicker, S. B. (2001) Selﬁsh users in aloha: a game theoretic approach, in
Proceedings of IEEE Vehicular Technology Conference, 2001, 3, pp. 1354–1357.
47. MacKenzie, A. B. and Wicker, S. B. (2003) Stability of multipacket slotted aloha with selﬁsh
users and perfect information. Joint Conference of the IEEE Computer and Communications
Societies, 2003, 3, pp. 1583–1590.
48. Kushner, H. J. and Yin, G. (1997) Stochastic Approximation Algorithms and Applications.
Springer-Verlag, New York.
49. MacKenzie, A. B. and Wicker, S. B. (2001) Game theory and the design of self-conﬁguring,
adaptive wireless networks. IEEE Communications Magazine, 39(11), 126–131.
50. Adireddy, S. and Tong, L. (2005) Exploiting decentralized channel state information for random
access, IEEE Transactions on Information Theory, 51, 537–561.
51. Ghez, S., Verdu, S. and Schwartz, S. C. (1989) Optimal decentralized control in the random
access multipacket channel, IEEE Transactions on Automatic Control, 34, 1153–1163.
52. Lin, H., Chatterjee, M., Das, S. and Basu K. (2005) ARC: an integrated admission and rate
control framework for competitive wireless CDMA data networks using noncooperative games,
IEEE Transactions on Mobile Computing, 4, 243–258.
53. Das, S. K.. Lin, H. and Chatterjee, M. (2004) An econometric model for resource management
in competitive wireless data networks, IEEE Network, 18, 20–26.
54. Dziong, Z. and Mason, L. (1996) Fair-efﬁcient call admission control policies for broadband
networks–a game theoretic approach, IEEE/ACM Transaction on Networking, 4, 123–136.
55. Key, P. B. and McAuley, D. R. (1999) Differential QoS and pricing in networks: where ﬂow
control meets game theory, IEE Proceedings Software, 146, 39–43.
56. La, R. J. and Anantharam, V. (1999) Network pricing using game theoretic approach, Proceedings
38th IEEE Conference on Decision and Control, 4, 4008–4013.
57. La, R. J. and Anantharam, V. (2002) Utility-based rate control in the internet for elastic trafﬁc
networking, IEEE/ACM Transaction on Networking, 10, 272–286.
58. Lin, H. (2004) Game theory based resource management framework for revenue maximization
and differentiated services in competitive wireless data networks, PhD dissertation, Department
of Computer Science and Engineering, 1University of Texas at Arlington, December 2004.

854
COGNITIVE NETWORKS AND GAME THEORY
59. Maheswaran, R. T. and Basar, T. (2001) Decentralized network resource allocation as a repeated
noncooperative market game, IEEE Conference on Decision and Control, 5, 4565–4570.
60. Yaiche, H., Mazumdar, R. R. and Rosenberg, C. (2000) A game theoretic framework for band-
width allocation and pricing in broadband networks, IEEE/ACM Transaction on Networking, 8,
667–678.
61. Musacchio, J. and Walrand, J. (2006) WiFi access point pricing as a dynamic game, IEEE/ACM
Transactions on Networking, 14, 289–301.
62. Fudenberg, D. and Tirole, J. (1991) Game Theory. MIT Press, Cambridge, MA.

Index
A
Adaptation/reconﬁguration efﬁciency, 25
Adaptive
4G Networks, 753
coding, 3
reconﬁgurable block coding, 21
reconﬁgurable convolutional codes, 26
Punctured convolutional codes/code, 31
Viterbi algorithm, 32
Systematic recursive convolutional codes,
33
Concatenated codes with interleavers, 36
The iterative decoding algorithm, 37
practice and prospects, 43
Distributed source coding, 44
Continuous valued source, 46
Scalar quantization and trellis-based coset
construction, 48
Trellis-based quantization and
memoryless, 50
ﬁltering, 225, 574
modulation, 77
precombining LMMSE receivers, 225
reconﬁgurable transmit power allocation, 136
weight adjustment, 276
ADC, 5, 546, 558, 584
Advanced time division multiple access
(ATDMA), 5
Aggregation, 1, 3, 44, 830, 831, 852
Alamouti scheme, 100, 107, 171, 600
ALOHA, 4, 753, 791, 839, 840, 841, 842, 853
Autocorrelation function, 462, 494
AWGN channel, 26, 73, 166, 211, 332, 343,
551, 625, 626
Azimuth proﬁle, 709
B
Bartlett estimate, 235
Base station, 581
Bayesian receiver, 400
BCJR algorithm, 53, 56, 358, 419
Beamforming, 3, 183, 189, 460, 464, 505, 509,
513, 515, 520, 523, 525, 534, 535,
536, 682, 715, 716, 749
UWB radio, 3
Bessel function, 86, 149, 281, 383, 385, 473
Bezout identity, 497
Bhattacharyya bound, 457
Binary shift register sequences, 191
Bit rate adaptation, 756
Blind
Bayesian multiuser receiver, 400
equalizers, 278
least squares receivers, 230
turbo multiuser receiver, 403
BPSK, 5, 84, 102, 111, 116, 117, 118, 121, 123,
126, 128, 132, 155, 156, 157, 183,
219, 222, 229, 241, 245, 246, 248,
250, 251, 253, 263, 293, 294, 295,
305, 306, 307, 318, 319, 350, 351,
352, 369, 393, 396, 399, 403, 496,
500, 526, 602, 603, 604, 798, 809
Advanced Wireless Communications. Second Edition
Savo G. Glisic
C⃝2007 John Wiley & Sons, Ltd. ISBN: 978-0-470-05977-7

856
INDEX
built-in time diversity, 141, 142
Bussgang, 316, 317, 318, 324, 328
C
Capacity, 77, 163, 186, 590, 621, 697, 698, 716,
719, 720, 749, 795
Cascading ﬁxed coefﬁcient ﬁlters, 574
CDMA multipath channel, 214
Channel estimation, 1, 3, 4, 17, 18, 139, 145,
147, 148, 149, 157, 159, 161, 163,
165, 170, 176, 177, 178, 179, 180,
181, 184, 186, 187, 188, 231, 237,
262, 269, 319, 327, 351, 352, 353,
355, 359, 418, 419, 420, 421, 427,
428, 496, 497, 498, 499, 500, 501,
502, 503, 504, 505, 506, 508, 510,
512, 513, 514, 516, 518, 520, 522,
524, 526, 527, 528, 529, 530, 531,
532, 533, 534, 535, 536, 591, 688,
689, 690, 691, 692, 693, 694, 714,
715, 717, 719, 748, 749, 811
Channel estimator, 80, 82, 106, 226, 292, 337,
363, 548
Channel model, 279, 308, 536, 588, 727, 749
Macrocellular environments (1.8 GHz),
675
PDF of shadow fading, 677
Urban spatial radio channels in
macro/microcell (2.154 GHz), 681
Description of environment, 682
Results, 682
MIMO channels in microcell and picocell
environments (1.71/2.05 GHz), 688
Simulation of channel coefﬁcients, 690
Measurement setups, 690
Validation of the stochastic MIMO
channel
model assumptions, 690
Input parameters to the validation of the
MIMO model, 692
The eigenanalysis method 693
Outdoor mobile channel (5.3 GHz), 696
Path loss models, 700
Window length for averaging fast fading
components at 5 GHz, 702
Spatial and frequency correlations, 702
Path number distribution, 705
Rotation measurements in an urban
environment, 706
Microcell channel (8.45 GHz), 708
Azimuth proﬁle, 709
Delay proﬁle for the forward arrival waves,
710
Short-term azimuth spread (AS) for
forward arrival waves, 712
Wireless MIMO LAN environments
(5.2 GHz), 714
Data evaluation, 715
Capacity computation, 716
Measurement environments, 717
Indoor WLAN channel (17 GHz), 718
Indoor WLAN channel (60 GHz), 727
Deﬁnition of the statistical parameters, 728
UWB channel model, 732
The large-scale statistics, 736
The small-scale statistics, 739
Correlation of MPCs among different
delay bins, 741
The statistical model, 741
Chebyshev ﬁlter, 281
Chernoff bound, 165
Cholesky decomposition, 214, 282, 310
Circular array, 467
CLSP/DS-CDMA packet access and trafﬁc
model, 756
Clustering models for the indoor channel, 438
Code design, 142
Coding, 5, 21, 56, 57, 58, 59, 76, 77, 154, 185,
269, 352, 534,
reconﬁgurable block coding, 21
reconﬁgurable convolutional codes, 26
Punctured convolutional codes/code, 31
Viterbi algorithm, 32
Systematic recursive convolutional codes,
33
Concatenated codes with interleavers, 36
The iterative decoding algorithm, 37
practice and prospects, 43
Distributed source coding, 44
Continuous valued source, 46
Scalar quantization and trellis-based coset
construction, 48
Trellis-based quantization and memoryless,
50
Coding gain, 154
Coding gain properties, 154
Cognitive networks, 1, 4, 835, 836
Cognitive power control, 4
cognitive radio, 1, 2, 4, 537, 557, 558, 561, 595,
602, 627, 643, 797
Cognitive Radio, 537
Energy-efﬁcient cognitive radio, 537
Frame length adaptation, 537
ﬂat fading channels, 539
The adaptation algorithm, 542
Adaptive error control, 542
Processing gain adaptation, 545
Maximum likelihood sequence equalizer,
547
Hidden Markov channel model, 548
Link layer performance

INDEX
857
inadequate equalization, 549
adequate equalization, 551
Linear multiuser detection, 556
A uniﬁed architecture and dynamic
reconﬁgurability, 556
The effects of quantization, 564
The effect on the ‘near–far’ resistance, 565
Reconﬁgurable ASIC architecture, 567
present art, 569
Alternative implementations, 570
Example architecture versus an FPGA, 570
DSP against the example architecture, 571
complex 16-point DFT – the Goertzel FFT
mode, 571
Fixed coefﬁcient ﬁlters, 573
Real FIR/correlator, 574
Real IIR/correlator, 574
Cascading ﬁxed coefﬁcient ﬁlters, 574
Adaptive ﬁltering, 574
Direct digital frequency synthesis, 576
CORDIC algorithm, 577
3 Discrete Fourier transform, 578
Goertzel algorithm, 578
Cognitive Wireless Networks, 587
Collusion of nodes, 836
Complex orthogonal designs, 100
Conditional posterior distributions, 401
Constant modulus algorithm, 229, 230, 232, 339
Constellation, 341, 356
Constellation rotation, 167
Contrast function, 319
Convex optimization, 505, 506, 513, 527, 534,
535
Convex optimization theory, 504
Generalized MIMO systems, 505
Convex optimization, 506
Power optimization, 507
SINR optimization, 510
Performance example, 512
Beamforming, 513, 520
Multicarrier MIMO signal model, 514
Channel diagonalization, 516
Constraints in multicarrier systems, 526
Convolution, 533
Convolutional encoder, 26, 28
Cooperative diversity, 608, 612, 587
System modeling, 587
System capacity, 588
Probability of outage, 591
Cellular coverage, 592
Protocols, 593
System and channel models, 593
Coperative diversity protocols, 594
Outage probabilities, 595
Performance bounds, 598
Distributed space–time coding, 600
System description, 600
BER analysis in DSTC, 603
Generalization, 605
System and channel model, 605
Cooperative diversity based on repetition,
608
space–time coding, 612
Crosscorrelation spectra, 193
D
Decision
feedback equalizer (DFE), 277
metric, 108, 135
statistics combining (DSC), 249
Decoder-assisted convergence assessment, 404
Decorrelating detector, 208
Deﬁnitions MIMO, 1, 3, 4, 17, 18, 139, 145,
147, 148, 149, 157, 159, 161, 163,
165, 170, 176, 177, 178, 179, 180,
181, 184, 186, 187, 188, 231, 237,
262, 269, 319, 327, 351, 352, 353,
355, 359, 418, 419, 420, 421, 427,
428, 496, 497, 498, 499, 500, 501,
502, 503, 504, 505, 506, 508, 510,
512, 513, 514, 516, 518, 520, 522,
524, 526, 527, 528, 529, 530, 531,
532, 533, 534, 535, 536, 591, 688,
689, 690, 691, 692, 693, 694, 714,
715, 717, 719, 748, 749, 811
Deinteleaver, 303, 305
Delay diversity, 94, 118, 120
Delayed decision feedback sequence estimation
(DDFSE), 360
Description of environment, 676, 682
DFE adaptive algorithms, 315
Differential decoding, 123, 128, 129
Differential encoding, 126
Direct digital frequency synthesis, 576, 585
Discrete Fourier transform, 569, 578
Distributed mobile networks, 775
Distributed network routing protocol, 773
Distributed Source Coding, 45, 47, 49, 51
Diversity gain, 136, 153
Diversity gain properties, 153
Diversity receiver, 335
Doppler frequency, 145, 149, 150, 151, 338,
339, 346, 348, 387, 393, 417, 552,
554, 555, 758, 760, 764
DPSK, 121, 125, 206, 338, 339, 342, 426, 427,
798
E
EDGE, 2, 5, 181, 189, 325, 356, 359, 364, 366,
367, 368, 427, 428, 672
Edgeworth expansion, 318

858
INDEX
Effective length, 141
Eigenvalues and eigenvectors, 258
Energy-efﬁcient adaptive error control, 542
Entropy, 45, 311, 313, 314, 315, 318
Equalization, 57, 269, 318, 322, 323, 325, 360,
368, 533, 547
Zero-forcing equalizers, 269
LMS equalizer, 275
Signal model, 275
Adaptive weight adjustment, 276
Automatic systems, 276
Iterative algorithm, 277
The LMS algorithm, 277
Decision feedback equalizer (DFE), 277
Blind equalizers, 278
Statistically known, time varying channel,
279
Signal model, 279
Channel model, 279
Description of the received sequence, 281
The ML sequence (block) estimator for a
statistically known channel, 281
LMS-adaptive MLSE equalization on
multipath fading channels, 284
System and channel models, 284
Adaptive channel estimator and LMS
estimator model, 285
The channel prediction algorithm, 285
Adaptive channel identiﬁcation, 288
System model, 288
Joint channel and data estimation, 288
fading channel, 292
The static channel environment, 293
The time varying channel environment, 296
Turbo equalization, 301
Signal format, 301
Equivalent discrete time channel model,
302
Equivalent system state representations,
302
Turbo equalization, 302
Viterbi algorithm, 303
Iterative implementation, 304
Kalman Filter, 305
Channel model, 308
The received signal, 308
Channel estimation alternatives, 308
Implementing the estimator, 309
The Kalman ﬁlter, 310
Implementation issues, 310
Equalization using higher order signal
statistics, 311
Problem statement, 311
Signal model, 313
Derivation of algorithms for DFE, 313
The equalizer coefﬁcients, 314
Stochastic gradient DFE adaptive
algorithms, 315
Convergence analysis, 316
Kurtosis-based algorithm, 318
Equivalent
discrete time channel model, 302
system state representations, 302
Error rate bound, 141
Error rate models, 789
Error statistic MIMO, 1, 3, 4, 17, 18, 139, 145,
147, 148, 149, 157, 159, 161, 163,
165, 170, 176, 177, 178, 179, 180,
181, 184, 186, 187, 188, 231, 237,
262, 269, 319, 327, 351, 352, 353,
355, 359, 418, 419, 420, 421, 427,
428, 496, 497, 498, 499, 500, 501,
502, 503, 504, 505, 506, 508, 510,
512, 513, 514, 516, 518, 520, 522,
524, 526, 527, 528, 529, 530, 531,
532, 533, 534, 535, 536, 591, 688,
689, 690, 691, 692, 693, 694, 714,
715, 717, 719, 748, 749, 811
ESPRIT DOA, 3
Estimation of MIMO channel, 3
Euclidean distance, 44, 64, 65, 66, 71, 141, 142,
166, 359, 422, 447
Extrinsic information, 303
Extrinsic information ratio (EIR), 248, 252
F
F/B MMSE receiver, 251
Feedback, 72, 76, 188, 312, 316, 322, 323, 325,
326, 378, 379, 576, 622
FFT block, 7, 415
FIR channel estimator, 338
Fixed coefﬁcient ﬁlters, 573
Fixed-point iteration, 510, 512
Flexible spectra sharing, 4
FPGA, 557, 558, 559, 560, 561, 562, 563, 568,
570, 571, 572, 581
Frame length adaptation, 537, 539
Frequency selective channel model, 356
Frequency selective fading channels, 397
Frobenius, 514
Full spatial diversity, 116
G
Game Theory, 797, 851, 853, 854
Cognitive Networks and Game Theory, 797
Cognitive power control, 797
Noncooperative power control game, 797
Nash equilibrium, 799
Pareto optimality, 800
Supermodular games and social optimality,
801

INDEX
859
Power control game with QOS guarantee, 805
multiuser detection, 809
MIMO systems, 811
MAC for AD HOC networks, 813
Tit-for-Tat (TFT) packet forwarding, 815
Strategy models, 815
Network nodes dependency graph and
system metamodel, 817
The payoff of iterative game, 819
TFT node cooperation with energy constraint,
823
Acceptance rate, 823
Pareto optimum, 823
Prisoner’s dilemma and TFT game, 825
Packet forwarding/dynamic Bayesian games,
828
Routing in wireless sensor networks, 830
Cognitive wireless sensor network model,
830
Optimal rout computation, 832
Proﬁt driven routing in cognitive networks,
832
Algorithmic mechanism design, 832
Proﬁt driven pricing mechanism 833
Truthful behavior in cognitive networks,
835
Collusion of nodes in cognitive networks,
836
Flexible spectra sharing, 838
Slotted ALOHA protocol, 839
Admission in competitive wireless networks,
842
System model, 842
Equilibrium solutions, 845
Access point pricing as a dynamic game,
846
The system model, 846
Modelling service reselling, 848
File transfer model, 848
Bayesian model for unknown trafﬁc,
849
Gamma distribution, 739, 740, 744
Gcd, 193, 194, 195
Generalized complex orthogonal designs, 100
real orthogonal designs, 99
Gibbs multiuser detection, 402
sampler, 400, 401, 403, 404, 405, 430
Givens rotation, 173
Goertzel algorithm, 578, 579
Golay code, 199
Gold sequences, 194, 195, 210, 387
Gray mapping, 66, 121, 122
Grimm, Fitz, and Krogmeier (GFK), 119
Group interference suppression, 134, 139
GSM, 4, 5, 181, 189, 325, 580, 625, 671, 672,
673, 746, 748
H
Hadamard sequence, 200
Hamming weight, 192
Hermitian, 134, 148, 153, 155, 158, 176, 281,
310, 506, 507, 514, 518, 658, 693, 717
Hidden Markov channel model, 548
HIPERLAN, 9, 16, 528, 536
Horizontal layered space–time (HLST)
architecture, 239
Householder transformation, 173
I
IBI, 360, 362, 600, 602
IC, 246, 545, 584, 832
IFFT, 8, 329, 336, 341, 344, 351, 353, 361, 362,
368, 396, 411, 421, 422, 569
IIR, 324, 567, 569, 574
In-home channel, 441
Input parameters, 692
Interarrival times, 440
Interference cancellation, 353, 429
Interleaver, 37, 140, 303, 305, 378, 382, 419
inverse fast Fourier transform, 411, 421
Iterative algorithm, 277
Iterative implementation of turbo equalization,
304
J
Jacobian, 808
Jakes model, 150, 387, 417
JPL sequences, 197
K
Kalman ﬁlter, 3, 308, 309, 310, 327, 426
Channel model, 308
The received signal, 308
Channel estimation alternatives, 308
Implementing the estimator, 309
The Kalman ﬁlter, 310
Implementation issues, 310
Kasami sequences, 196
Kronecker product, 153, 690
sequences, 197
Kurtosis-based algorithm, 318
L
Lagrange multipliers, 180
layered space–time (LST) architecture, 236
Least resistance routing, 778
Least squares (LS) receiver, 230
Linear processing orthogonal designs, 98
Link layer
adequate equalization, 551
inadequate equalization, 549

860
INDEX
LMS algorithm, 227, 230, 277, 309, 321, 572,
574, 629, 630, 632, 633, 634, 636,
638, 639
equalizer, 276, 277
estimator model, 285
LST architectures, 237, 239
LSTC receivers, 247
M
Mapping, 573, 576, 577
Maximum likelihood (ML), 32, 237, 241
Measurement setups, 690
MIMO, 1, 3, 4, 17, 18, 139, 145, 147, 148, 149,
157, 159, 161, 163, 165, 170, 176,
177, 178, 179, 180, 181, 184, 186,
187, 188, 231, 237, 262, 269, 319,
327, 351, 352, 353, 355, 359, 418,
419, 420, 421, 427, 428, 496, 497,
498, 499, 500, 501, 502, 503, 504,
505, 506, 508, 510, 512, 513, 514,
516, 518, 520, 522, 524, 526, 527,
528, 529, 530, 531, 532, 533, 534,
535, 536, 591, 688, 689, 690, 691,
692, 693, 694, 714, 715, 717, 719,
748, 749, 811
capacity, 188
channels, 4, 186, 231, 497, 533, 534, 535,
536, 748
OFDM, 351, 353
Minimum power networks, 772
Mismatch, 107
ML sequence (block) estimator, 281
MLSE
equalization, 3, 321, 325, 427
channel estimation, 335
detection, 3, 244, 265, 387, 389, 429, 430
detector structures, 220
receiver, 245, 252, 265, 383, 384, 430, 512,
558, 560, 564, 626, 810, 812
SIC detector, 244
Modulation, 63
Coded modulation, 63
Euclidean distance, 64
Examples of TCM schemes, 65
Set partitioning, 68
Representation of TCM, 70
TCM with multidimensional constellation,
70
Adaptive coded modulation for fading
channels, 72
Maintaining a ﬁxed distance, 73
Information rate, 74
Monte Carlo simulation, 51, 156, 694, 746
Moore-Penrose pseudoinverse, 506, 715, 749
Multicarrier CDMA system, 369
Data demodulation, 370
Performance examples, 371
broadcast systems, 371
Frame by frame adaptive rate, 375
Transmitter, 377
Receiver, 378
Rate-compatible punctured convolutional
(RCPC) codes, 379
Rate adaptation, 380
Intermodulation interference suppression,
382
Transmitter, 382
Non-linear power ampliﬁer model, 383
MMSE receiver, 383
Successive interference cancellation,
386
System and channel model, 386
MMSE detection, 387
Tracking the fading processes, 390
Approximation of optimum multiuser
receiver, 393
Frequency selective fading channels, 397
Receiver signal model of STBC, 398
Blind approach, 399
Bayesian optimal blind receiver, 400
Blind Bayesian Monte Carlo multiuser
receiver approximation, 400
Gibbs sampler, 400
Prior distributions, 401
Conditional posterior distributions, 401
Gibbs multiuser detection, 402
Sampling space of data, 403
The orthogonality property, 403
Blind turbo multiuser receiver, 403
Decoder-assisted convergence assessment,
404
Multidimensional constellation, 75
Multimedia least resistance routing (MLRR),
779
Multipath decorrelation, 213
Multiple
access, 5, 201, 457, 492, 642
receive antennas, 130
transmit antenna differential detection from
generalized orthogonal designs,
185
Multiuser Communication, 191
Pseudorandom sequences, 191
Binary shift register sequences, 191
Binary maximal length sequences, 193
Crosscorrelation spectra, 193
Maximal connected sets of m-sequences,
194
Gold sequences, 194
Gold-like and dual-BCH sequences, 195
Kasami sequences, 196

INDEX
861
JPL sequences, 197
Kronecker sequences, 197
Walsh functions, 198
Optimum PN sequences, 199
Golay code, 199
Multiuser CDMA receivers, 201
Synchronous CDMA channels, 202
The decorrelating detector, 202
The optimum linear multiuser detector, 202
Multistage detection, 203
Non-coherent detector, 205
Non-coherent detection in asynchronous
channels [45], 205
Frequency non-selective Rayleigh
channels, 207
frequency selective Rayleigh channels,
210
Minimum mean square error (MMSE) linear
multiuser detection, 216
System model in multipath fading
channels, 217
MMSE detector structures, 220
Spatial processing, 221
Single user LMMSE receivers for frequency
selective fading channels, 225
Adaptive precombining LMMSE receivers,
225
Blind least squares receivers, 230
Least squares (LS) receiver, 230
Matrix inversion lemma, 231
Signal subspace-based channel estimation for
CDMA systems, 232
Estimating the signal subspace, 234
Channel estimation, 235
Iterative receivers for layered space–time
coding, 236
LST architectures, 237
LST receivers, 241
QR decomposition/SIC detecor, 242
MMSE/SIC detector, 244
Iterative LST receivers, 246
MUSIC, 3, 236, 237
N
Nakagami-Rice, 713, 714, 748
Nash equilibrium, 797, 799, 800, 801, 802, 803,
804, 805, 806, 808, 809, 812, 820,
825, 826, 830, 832, 841, 845, 847,
851
Networks, 2, 16, 17, 18, 19, 182, 262, 263, 266,
267, 321, 643, 645, 671, 746, 792,
793, 794, 797, 851, 852
Non-coherent detector, 205
Non-linear power ampliﬁer model, 383
Null space, 506
O
OFDM, 2, 3, 5, 6, 7, 8, 9, 10, 18, 184, 185, 186,
187, 329, 330, 331, 332, 333, 334,
335, 336, 337, 338, 339, 340, 342,
344, 345, 346, 347, 348, 349, 350,
351, 352, 353, 354, 355, 356, 357,
358, 359, 360, 361, 362, 363, 364,
365, 366, 367, 368, 370, 374, 376,
378, 380, 382, 384, 386, 388, 390,
392, 394, 396, 398, 399, 400, 402,
404, 405, 406, 407, 408, 409, 410,
411, 412, 413, 414, 415, 416, 417,
418, 419, 420, 421, 422, 423, 424,
425, 426, 427, 428, 430, 431, 432,
496, 515, 527, 536, 567, 569, 601,
628, 633, 634, 638, 639, 640, 641,
718, 722, 838
Timing and frequency offset in OFDM, 329
Robust frequency and timing synchronization
for OFDM, 331
Fading channel estimation for OFDM
systems, 334
Statistics of mobile radio channels, 334
Diversity receiver, 335
MMSE channel estimation, 335
FIR channel estimator, 337
System performance, 338
Reference generation, 339
64 DAPSK and 64 QAM/OFDM signals, 339
Space–time coding with OFDM signals, 344
Signal and channel parameters, 345
The wireless ATM system, 349
Space–time coded adaptive modulation for
OFDM, 349
Turbo and space–time coded adaptive
OFDM, 349
Layered space–time coding for MIMO
OFDM, 351
System model (two times two transmit
antennas), 352
Interference cancellation, 353
Four transmit antennas, 353
Space–time coded TDMA/OFDM
reconﬁguration efﬁciency, 356
Frequency selective channel model, 356
Front end preﬁlter, 357
Time-invariant channel, 357
Optimization problem, 358
Average channel, 358
Preﬁltered M-BCJR equalizer, 358
Decision, 359
Preﬁltered MLSE/DDFSE equalizer
complexity, 359
Delayed decision feedback sequence
estimation (DDFSE), 360

862
INDEX
OFDM (Cont.)
Equalization schemes for STBC, 360
Single-carrier frequency domain equalized
ST block coding SC FDE STBC, 361
Optimum PN sequences, 199
Orthogonality, 127
Outage capacity, 138, 140
P
Pareto optimality, 800, 801
Partitioned, 256
Path loss modeling, 440
PDF of shadow fading, 677
Performance measure MIMO, 1, 3, 4, 17, 18,
139, 145, 147, 148, 149, 157, 159,
161, 163, 165, 170, 176, 177, 178,
179, 180, 181, 184, 186, 187, 188,
231, 237, 262, 269, 319, 327, 351,
352, 353, 355, 359, 418, 419, 420,
421, 427, 428, 496, 497, 498, 499,
500, 501, 502, 503, 504, 505, 506,
508, 510, 512, 513, 514, 516, 518,
520, 522, 524, 526, 527, 528, 529,
530, 531, 532, 533, 534, 535, 536,
591, 688, 689, 690, 691, 692, 693,
694, 714, 715, 717, 719, 748, 749, 811
Picocell, 691, 693
PIC-STD, 247, 250, 251, 253
Pilot symbols, 378, 379
Polynomial, 56, 197
Positioning 645
cellular networks 645
AD and RD measurements 646
The circular, hyperbolic, and mixed
multilateration 646
WLS solution of the location problem 648
Accuracy measure 649
Circular multilateration 650
Hyperbolic multilateration 651
Mixed multilateration 652
Performance results for three stations 652
Performance results for N stations 654
Relative positioning in wireless sensor
networks 655
Performance bounds 656
Relative location estimation 659
Average performance of geolocation 664
Signal models and performance limits 664
Performance of location techniques 666
Average performance 667
Postcombining interference suppression
receiver, 220
Power
allocation, 136, 794
delay proﬁle, 528, 717
optimal routing, 793
PPM UWB multiple access, 3
Preamble, 555
Precoding
Space–time precoders for MIMO channels,
497
ISI modelling in MIMO channels, 497
MIMO system, 499
STBC systems, 502
Convex optimization theory, 504
Generalized MIMO systems, 505
Convex optimization, 506
Power optimization, 507
SINR optimization, 510
Performance example, 512
Beamforming, 513, 520
Multicarrier MIMO signal model, 514
Channel diagonalization, 516
Constraints in multicarrier systems,
526
Precombining interference suppression receiver,
221
Preﬁltered MLSE/DDFSE equalizer complexity,
359
Prior distributions, 401
Processing gain adaptation, 545
Product sum distance, 141
Proﬁt driven pricing, 833
punctured convolutional codes, 3, 31, 43, 44, 58,
60, 429
Q
QAM, 3, 6, 67, 68, 69, 70, 73, 76, 77, 78, 95,
96, 102, 109, 120, 167, 171, 176, 187,
262, 322, 326, 339, 340, 341, 343,
344, 345, 346, 348, 350, 351, 352,
410, 415, 420, 426, 518, 529, 569,
635, 636, 637
QAM constellation, 68, 70, 73, 95, 96, 102, 340,
420
QPSK, 5, 6, 114, 115, 116, 117, 119, 120, 121,
183, 275, 276, 296, 309, 338, 345,
350, 351, 352, 518, 526, 529, 530,
531, 532, 539, 636, 637, 638, 640,
641
Quasi-static fading, 144, 145
R
Raised cosine window, 331
RAKE receiver, 6, 221, 222, 226, 227, 229, 374,
375, 437, 496, 582, 583, 731, 746,
754
Rate adaptation, 380
Rate-compatible punctured convolutional
(RCPC) codes, 379
rate-distortion, 44, 60, 622

INDEX
863
Rayleigh fading, 73, 76, 77, 78, 84, 86, 91, 141,
149, 165, 166, 175, 182, 190, 207,
210, 212, 215, 222, 227, 232, 245,
250, 251, 253, 261, 286, 287, 297,
338, 345, 349, 369, 374, 378, 382,
387, 426, 429, 540, 588, 596, 758,
790, 842
Real
constellation set, 131
FIR/correlator, 574
IIR/correlator, 574
Receiver signal model of STBC MC CDMA
systems, 398
Recursive least squares (RLS), 291
Rician distributions, 85, 86
RLS algorithm, 291, 292, 294, 309, 310
Robust frequency and timing synchronization,
331
RS decoder, 338, 339
S
Sampling space of data, 403
Sato function, 278
Schur product, 225
Schur-concave, 513, 514, 518, 519, 520, 521,
522, 523, 524, 527
Pseudorandom sequences, 191
Binary shift register sequences, 191
Binary maximal length sequences, 193
Crosscorrelation spectra, 193
Maximal connected sets of m-sequences,
194
Gold sequences, 194
Gold-like and dual-BCH sequences,
195
Kasami sequences, 196
JPL sequences, 197
Kronecker sequences, 197
Walsh functions, 198
Optimum PN sequences, 199
Golay code 199
SEDUMI, 507, 535
Self-describing packets, 555
sensor networks, 1, 3, 4, 44, 655, 656, 673, 795,
830, 839, 852
Set partition, 68, 69, 70, 76
Signal and channel parameters, 345
Signal model, 275, 279, 313, 460, 664
Simulation of channel coefﬁcients, 690
social optimality, 801
Space–time codes, 180, 181, 185, 57, 79
Diversity gain 79
Two-branch transmit diversity scheme with
one receiver 80
Two transmitters and M receivers 82
The system model 84
The case of independent fade coefﬁcients
85
Rayleigh fading 86
Design criteria for Rayleigh ST codes 86
Code construction 87
Reconﬁguration efﬁciency of space–time
coding 91
Delay diversity 94
Space–time block codes from orthogonal
designs 96
Channel model and the diversity criterion
96
Real orthogonal designs 97
Space–time encoder 97
The diversity order 97
The decoding algorithm 98
Linear processing orthogonal designs 98
Generalized real orthogonal designs 99
Encoding 99
The Alamouti scheme 100
Complex orthogonal designs 100
Generalized complex orthogonal designs
100
Special codes 101
Channel estimation imperfections 102
Channel estimator 106
Quasi-orthogonal space–time block codes
107
Decoding 108
Decision metric 108
Space–time convolutional codes 109
Algebraic space–time codes 111
Full spatial diversity 116
QPSK modulation 116
Differential space–time modulation 116
The encoding algorithm 122
Differential decoding 123
Multiple transmit antenna differential
detection from generalized orthogonal
designs 125
Differential encoding 126
Received signal 126
Orthogonality 127
Encoding 127
Differential decoding 128
Received signal 129
Demodulation 130
Multiple receive antennas 130
The number of transmit antennas lower
than the number of symbols 130
Real constellation set 131
Layered space–time coding 133
Receiver complexity 134
Group interference suppression 134
Suppression method 134
The null space 134
Receiver 135

864
INDEX
Space–time codes (Cont.)
Decision metric 135
Multilayered space–time coded modulation
135
Diversity gain 136
Adaptive transmit power allocation 136
Concatenated space–time block coding 140
System model 140
Product sum distance 141
Error rate bound 141
The case of low SNR 142
Code design 142
Estimation of MIMO channel 145
System model 146
Training 148
Performance measure 148
Deﬁnitions 148
Channel estimation error 148
Error statistic 149
ST codes for requency selective channels 151
Diversity gain properties 153
Coding gain properties 154
Space–time trellis code design 155
Optimization of a MIMO system 157
The channel model 157
Gain optimization by singular value
decomposition (SVD) 158
The general (M, N) case 159
Gain optimization by iteration for a
reciprocal channel 161
Spectral efﬁciency of parallel channels
162
Capacity of the (M, N) array 163
MIMO systems with constellation rotation
163
System model 163
Performance in a Rayleigh fading channel
165
Diagonal algebraic space–time block codes
167
System model 167
The DAST coding algorithm 169
The DAST decoding algorithm 170
QR Factorization 173
Lattice code decoder for space–time codes
175
MIMO channel capacity 176
Space–time trellis code design, 155
Spatial and frequency correlation, 702
Spatial processing, 221
Special codes, 101
Spectral efﬁciency of parallel channels, 162
Square root ﬁltering, 310
standard iterative receiver, 246
Statistical description of the received sequence,
281
Statistics of mobile radio channels, 334
STBC, 140, 144, 145, 360, 361, 362, 364, 365,
368, 396, 397, 398, 399, 403, 404,
405, 406, 499, 502, 503, 504
Street-guided propagation, 682
StrongARM embedded processor, 543
Supermodular games, 801
Survivor, 297
Synchronous CDMA channels, 202
System model, 140, 146, 163, 167, 217, 278,
288, 352, 842
System model MIMO, 1, 3, 4, 17, 18, 139, 145,
147, 148, 149, 157, 159, 161, 163,
165, 170, 176, 177, 178, 179, 180,
181, 184, 186, 187, 188, 231, 237,
262, 269, 319, 327, 351, 352, 353,
355, 359, 418, 419, 420, 421, 427,
428, 496, 497, 498, 499, 500, 501,
502, 503, 504, 505, 506, 508, 510,
512, 513, 514, 516, 518, 520, 522,
524, 526, 527, 528, 529, 530, 531,
532, 533, 534, 535, 536, 591, 688,
689, 690, 691, 692, 693, 694, 714,
715, 717, 719, 748, 749, 811
Systematic convolutional codes, 33
T
Tarokh, Seshadri, and Calderbank (TSC), 119
TCSQ, 48, 50, 54
The case of low SNR, 142
The received signal model, 436
threaded layered space–time (TLST) structure,
240
TIA (Telecommunications Industry
Association), 5
Timing, 332, 731
TLST architectures, 239
Tracking the fading processes, 390
Training MIMO, 1, 3, 4, 17, 18, 139, 145, 147,
148, 149, 157, 159, 161, 163, 165,
170, 176, 177, 178, 179, 180, 181,
184, 186, 187, 188, 231, 237, 262,
269, 319, 327, 351, 352, 353, 355,
359, 418, 419, 420, 421, 427, 428,
496, 497, 498, 499, 500, 501, 502,
503, 504, 505, 506, 508, 510, 512,
513, 514, 516, 518, 520, 522, 524,
526, 527, 528, 529, 530, 531, 532,
533, 534, 535, 536, 591, 688, 689,
690, 691, 692, 693, 694, 714, 715,
717, 719, 748, 749, 811
Transmit diversity, 598
Transversal ﬁlter equalizer, 272, 273, 275
Turbo, 5, 57, 58, 59, 76, 77, 183, 185, 267, 302,
306, 307, 326, 327, 344, 349, 404, 419

INDEX
865
equalization, 302, 306, 307, 327
Signal format 301
Equivalent discrete time channel model 302
Equivalent system state representations 302
Turbo equalization 302
Viterbi algorithm 303
Iterative implementation 304
U
Ultra Wide Band Radio, 3, 433
Universal Wireless Communications (UWC), 5
Utility, 798, 853
UWB, 1, 2, 3, 4, 5, 11, 13, 15, 16, 433, 435,
436, 437, 439, 440, 441, 442, 443,
444, 445, 446, 447, 448, 449, 451,
453, 457, 458, 459, 460, 461, 463,
464, 465, 467, 469, 471, 473, 475,
477, 479, 481, 483, 485, 487, 489,
491, 492, 493, 494, 495, 496, 625,
626, 627, 628, 629, 630, 632, 633,
634, 635, 636, 638, 641, 642, 643,
732, 735, 737, 739, 741, 743
channel, 3, 4, 433, 492, 496, 732
V
Variable QoS, 557
vertical Bell Laboratories layered space–time
(VBLAST), 237
vertical layered space–time (VLST),
237
Viterbi algorithm, 3, 32, 33, 34, 43, 44, 46, 50,
56, 57, 58, 90, 211, 241, 285, 303,
308, 454
W
Walsh functions, 198
water-ﬁlling, 179, 180, 521, 522, 523, 525
Wiener solution, 285, 389, 390, 391, 392, 393,
394
Wind-ﬂex channel model, 727
Z
Zero-forcing equalizers, 269
ZF strategy, 242

