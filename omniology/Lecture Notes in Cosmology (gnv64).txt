UNITEXT for Physics
Oliver Piattella
Lecture 
Notes in 
Cosmology

UNITEXT for Physics
Series editors
Paolo Biscari, Dipartimento di Fisica, Politecnico di Milano, Milan, Italy
Michele Cini, Dipartimento di Fisica, University of Rome Tor Vergata, Rome, Italy
Attilio Ferrari, Università di Torino, Turin, Italy
Stefano Forte, Università di Milano, Milan, Italy
Morten Hjorth-Jensen, Department of Physics, University of Oslo, Oslo, Norway
Nicola Manini, Department of Physics, Università degli Studi di Milano, Milan,
Italy
Guido Montagna, Università di Pavia, Pavia, Italy
Oreste Nicrosini, Dipartimento di Fisica Nucleare e Teorica, Università di Pavia,
Pavia, Italy
Luca Peliti, Dipartimento di Scienze Fisiche, Università di Napoli, Naples, Italy
Alberto Rotondi, Pavia, Italy

UNITEXT for Physics series, formerly UNITEXT Collana di Fisica e Astronomia,
publishes textbooks and monographs in Physics and Astronomy, mainly in English
language, characterized of a didactic style and comprehensiveness. The books
published in UNITEXT for Physics series are addressed to graduate and advanced
graduate students, but also to scientists and researchers as important resources for
their education, knowledge and teaching.
More information about this series at http://www.springer.com/series/13351

Oliver Piattella
Lecture Notes in Cosmology
123

Oliver Piattella
Núcleo Cosmo-UFES and Department
of Physics
Federal University of Espírito Santo
Vitória, Espírito Santo
Brazil
ISSN 2198-7882
ISSN 2198-7890
(electronic)
UNITEXT for Physics
ISBN 978-3-319-95569-8
ISBN 978-3-319-95570-4
(eBook)
https://doi.org/10.1007/978-3-319-95570-4
Library of Congress Control Number: 2018947829
© Springer International Publishing AG, part of Springer Nature 2018
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part
of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations,
recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and transmission
or information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar
methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt from
the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, express or implied, with respect to the material contained herein or
for any errors or omissions that may have been made. The publisher remains neutral with regard to
jurisdictional claims in published maps and institutional afﬁliations.
This Springer imprint is published by the registered company Springer Nature Switzerland AG
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

To Giuseppina, Lilli e Dorotea
Together we are gold

Preface
Considerate la vostra semenza: fatti non foste a viver come
bruti ma per seguir virtute e canoscenza
(Consider well the seed that gave you birth: you were not
made to live as brutes, but to follow virtue and knowledge)
Dante Alighieri, Divina Commedia, Canto XXVI
These lecture notes are based on the handwritten notes which I prepared for the
cosmology course taught to graduate students of PPGFis and PPGCosmo at the
Federal University of Esprito Santo (UFES), starting from 2014.
This course covers topics ranging from the evidence of the expanding universe to
Cosmic Microwave Background anisotropies. In particular, Chap. 1 commences
with a bird’s-eye view of cosmology, showing its tremendous evolution during the
last ﬁfty years and the open problems on which cosmologists are working today.
From Chap. 2 on starts the conventional content, hopefully exposed in a not too
conventional manner. The main topics are as follows: the expansion of the universe,
relativistic cosmology and Friedmann equations (Chap. 2); thermal history, Big
Bang Nucleosynthesis, recombination and cold relic abundance (Chap. 3); cosmo-
logical perturbation theory and perturbed Einstein equations (Chap. 4); perturbed
Boltzmann equations (Chap. 5); primordial modes of perturbations (Chap. 6); ran-
dom variables and stochastic character of cosmological perturbations (Chap. 7);
inﬂationary paradigm (Chap. 8); evolution of perturbations (Chap. 9); anisotropies in
the Cosmic Microwave Background sky (Chap. 10). A selection of extra topics is
offered in Chap. 11, whereas Chap. 12 collects some important and well-known
physical and mathematical results.
Scattered throughout the text are many exercises. I chose not to put them at the
end of a chapter or at the end of the book because I want the reader to stop and do
some work in the moment in which this is needed. Most of the exercises are not
extensions of the material covered, but consist in developing calculations necessary
to the topics addressed. The idea here is, since these are lecture notes, not only to
provide a book for consultation but to put the reader-student to work.
vii

When I prepared these lecture notes, I heavily relied on the following three
famous textbooks in cosmology:
• S. Dodelson, Modern Cosmology, (Dodelson 2003),
• V. Mukhanov, Principles of Physical Cosmology, (Mukhanov 2005),
• S. Weinberg, Cosmology, (Weinberg 2008),
but also on many other books and papers, which are cited throughout the text. I tried
not to simply develop the calculations there contained, but to provide an original
presentation. I hope to have succeeded, but of course the ﬁnal word is up to the
reader.
I want now to make three recommendations to the reader-student.
First, read the original papers in order to make contact with the original ideas in
their primeval forms and to appreciate the geniuses of their authors.
Second, the technological advance has provided us with sophisticated instru-
ments such as Inspire, http://inspirehep.net/, a powerful tool for researching papers.
One of the features I like most about it is the possibility to check which papers have
cited the one in which we are interested, thus allowing us to rapidly get up to date
on a given topic. I sometimes joke about this by rephrasing a sentence which we all
have many times read in papers and books when referring to a certain work: see …
and references therein. Thanks to the above-mentioned citation tool we can now
add also the sentence see … and references thereout. These notes will be up to date
when published, but cosmology is a very vivacious research ﬁeld so they will
probably become outdated in a few years. My recommendation is thus to take
advantage of the references thereout tools and keep yourself always updated.
Third and ﬁnal one, in preparing these notes I have intensively employed the
CLASS code. This is very user-friendly, so it was not as hard as it may sound. My
point in doing so is that analytic calculations are very stimulating and very useful in
order to understand the physics ruling the cosmological phenomena, so they have
an enormous didactical value. On the other hand, observation needs precise cal-
culations, and these can be done only numerically. So, my recommendation here is
the following: do not be afraid of numerical codes and learn how to use them
proﬁciently.
I thank all my students and colleagues who have helped me, through questions
and suggestions, in the challenging but rewarding task of writing these notes. Extra
thanks to Rodrigo Von Marttens, whose help with CLASS has been crucial in order
for me to rapidly grasp how to run the code. Special thanks are due to my editor
Aldo Rampioni and his assistant Kirsten Kley-Theunissen for their kind help and
encouragement throughout the realisation of the project.
Vitória, Brazil
Oliver Piattella
February 2018
viii
Preface

References
Dodelson, S.: Modern cosmology. Academic Press, Amsterdam, Netherlands (2003)
Mukhanov, V.: Physical foundations of cosmology. Cambridge University Press, Cambridge,
UK (2005)
Weinberg, S.: Cosmology. Oxford University Press, Oxford, UK (2008)
Preface
ix

Contents
1
Cosmology. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
The Expanding Universe and its Content . . . . . . . . . . . . . . . . .
1
1.1.1
Olbers’s Paradox . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.1.2
The Accelerated Expansion of the Universe
and Dark Energy . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.1.3
Dark Matter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.2
Cosmological Observations . . . . . . . . . . . . . . . . . . . . . . . . . . .
7
1.2.1
The Cosmic Microwave Background . . . . . . . . . . . . . .
7
1.2.2
Redshift Surveys . . . . . . . . . . . . . . . . . . . . . . . . . . . .
8
1.2.3
Gravitational Waves Observatories . . . . . . . . . . . . . . .
9
1.2.4
Neutrino Observation . . . . . . . . . . . . . . . . . . . . . . . . .
9
1.2.5
Dark Matter Searches . . . . . . . . . . . . . . . . . . . . . . . . .
10
1.3
Redshift . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
10
1.4
Open Problems in Cosmology . . . . . . . . . . . . . . . . . . . . . . . . .
10
1.4.1
Cosmological Constant and Dark Energy . . . . . . . . . . .
11
1.4.2
Dark Matter and Small-Scale Anomalies . . . . . . . . . . .
12
1.4.3
Other Problems . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
13
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
13
2
The Universe in Expansion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.1
Newtonian Cosmology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.2
Relativistic Cosmology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
18
2.2.1
Friedmann–Lemaître–Robertson–Walker Metric . . . . . .
19
2.2.2
The Conformal Time . . . . . . . . . . . . . . . . . . . . . . . . .
22
2.2.3
FLRW Metric Written with Proper Radius . . . . . . . . . .
22
2.2.4
Light-Cone Structure of the FLRW Space . . . . . . . . . .
23
2.2.5
Christoffel Symbols and Geodesics . . . . . . . . . . . . . . .
25
2.3
Friedmann Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
2.3.1
The Hubble Constant and the Deceleration
Parameter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
xi

2.3.2
Critical Density and Density Parameters . . . . . . . . . . .
32
2.3.3
The Energy Conservation Equation . . . . . . . . . . . . . . .
33
2.3.4
The KCDM Model . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
2.4
Solutions of the Friedmann Equations . . . . . . . . . . . . . . . . . . .
37
2.4.1
The Einstein Static Universe . . . . . . . . . . . . . . . . . . . .
37
2.4.2
The de Sitter Universe . . . . . . . . . . . . . . . . . . . . . . . .
38
2.4.3
Radiation-Dominated Universe . . . . . . . . . . . . . . . . . .
40
2.4.4
Cold Matter-Dominated Universe . . . . . . . . . . . . . . . .
41
2.4.5
Radiation Plus Dust Universe . . . . . . . . . . . . . . . . . . .
43
2.5
Distances in Cosmology . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
44
2.5.1
Comoving Distance and Proper Distance . . . . . . . . . . .
45
2.5.2
The Lookback Time . . . . . . . . . . . . . . . . . . . . . . . . . .
45
2.5.3
Distances and Horizons . . . . . . . . . . . . . . . . . . . . . . .
47
2.5.4
The Luminosity Distance . . . . . . . . . . . . . . . . . . . . . .
48
2.5.5
Angular Diameter Distance . . . . . . . . . . . . . . . . . . . . .
50
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
3
Thermal History . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
3.1
Thermal Equilibrium and Boltzmann Equation . . . . . . . . . . . . .
55
3.2
Short Summary of Thermal History . . . . . . . . . . . . . . . . . . . . .
57
3.3
The Distribution Function . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
3.3.1
Volume of the Fundamental Cell . . . . . . . . . . . . . . . . .
61
3.3.2
Integrals of the Distribution Function . . . . . . . . . . . . .
62
3.4
The Entropy Density . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
64
3.5
Photons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
67
3.6
Neutrinos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
3.6.1
Temperature of the Massless Neutrino Thermal
Bath . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
71
3.6.2
Massive Neutrinos . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
3.6.3
Matter-Radiation Equality . . . . . . . . . . . . . . . . . . . . . .
76
3.7
Boltzmann Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
78
3.7.1
Proof of Liouville Theorem. . . . . . . . . . . . . . . . . . . . .
79
3.7.2
Example: The One-Dimensional Harmonic
Oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
3.7.3
Boltzmann Equation in General Relativity
and Cosmology . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
3.8
Boltzmann Equation with a Collisional Term . . . . . . . . . . . . . .
84
3.8.1
Detailed Calculation of the Equilibrium Number
Density . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
87
3.8.2
Saha Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
89
3.9
Big-Bang Nucleosynthesis . . . . . . . . . . . . . . . . . . . . . . . . . . . .
90
3.9.1
The Baryon-to-Photon Ratio . . . . . . . . . . . . . . . . . . . .
91
3.9.2
The Deuterium Bottleneck . . . . . . . . . . . . . . . . . . . . .
92
xii
Contents

3.9.3
Neutron Abundance . . . . . . . . . . . . . . . . . . . . . . . . . .
94
3.10
Recombination and Decoupling . . . . . . . . . . . . . . . . . . . . . . . .
100
3.10.1
Decoupling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
104
3.11
Thermal Relics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
106
3.11.1
The Effective Numbers of Relativistic Degrees
of Freedom . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
110
3.11.2
Relic Abundance of DM and the WIMP Miracle . . . . .
113
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
114
4
Cosmological Perturbations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
4.1
From the Perturbations of the FLRW Metric to the Linearised
Einstein Tensor . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
4.1.1
The Perturbed Christoffel Symbols . . . . . . . . . . . . . . .
120
4.1.2
The Perturbed Ricci Tensor and Einstein Tensor . . . . .
123
4.2
Perturbation of the Energy-Momentum Tensor . . . . . . . . . . . . .
125
4.3
The Problem of the Gauge and Gauge Transformations. . . . . . .
131
4.3.1
Coordinates and Gauge Transformations . . . . . . . . . . .
132
4.3.2
The Scalar-Vector-Tensor Decomposition . . . . . . . . . .
134
4.3.3
Gauges . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
140
4.4
Normal Mode Decomposition . . . . . . . . . . . . . . . . . . . . . . . . .
142
4.5
Einstein Equations for Scalar Perturbations . . . . . . . . . . . . . . . .
145
4.5.1
The Relativistic Poisson Equation . . . . . . . . . . . . . . . .
146
4.5.2
The Equation for the Anisotropic Stress. . . . . . . . . . . .
147
4.5.3
The Equation for the Velocity . . . . . . . . . . . . . . . . . . .
148
4.5.4
The Equation for the Pressure Perturbation . . . . . . . . .
148
4.6
Einstein Equations for Tensor Perturbations . . . . . . . . . . . . . . .
149
4.7
Einstein Equations for Vector Perturbations . . . . . . . . . . . . . . .
152
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
154
5
Perturbed Boltzmann Equations . . . . . . . . . . . . . . . . . . . . . . . . . . .
157
5.1
General Form of the Perturbed Boltzmann Equation . . . . . . . . .
157
5.1.1
On the Photon and Neutrino Perturbed
Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
159
5.2
Force Term . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
160
5.2.1
Scalar Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . .
161
5.2.2
Tensor Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . .
162
5.2.3
Vector Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . .
163
5.3
The Perturbed Boltzmann Equation for CDM . . . . . . . . . . . . . .
164
5.4
The Perturbed Boltzmann Equation for Massless Neutrinos . . . .
167
5.4.1
Scalar Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . .
168
5.5
The Perturbed Boltzmann Equation for Photons . . . . . . . . . . . .
172
5.5.1
Computing the Collisional Term Neglecting
Polarisation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
173
5.5.2
Full Boltzmann Equation Including Polarisation . . . . . .
176
Contents
xiii

5.5.3
Scalar Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . .
179
5.5.4
Tensor Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . .
182
5.5.5
Vector Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . .
184
5.6
Boltzmann Equation for Baryons . . . . . . . . . . . . . . . . . . . . . . .
186
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
191
6
Initial Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
193
6.1
Initial Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
193
6.2
Evolution Equations in the kg  1 Limit . . . . . . . . . . . . . . . . .
195
6.2.1
Multipoles in the kg  1 Limit . . . . . . . . . . . . . . . . . .
197
6.2.2
CDM and Baryons Velocity Equations . . . . . . . . . . . .
199
6.2.3
The kg  1 Limit of the Einstein Equations . . . . . . . .
199
6.3
The Adiabatic Primordial Mode . . . . . . . . . . . . . . . . . . . . . . . .
201
6.3.1
Why “Adiabatic”? . . . . . . . . . . . . . . . . . . . . . . . . . . .
203
6.4
The Neutrino Density Isocurvature Primordial Mode . . . . . . . . .
205
6.5
The CDM and Baryons Isocurvature Primordial Modes. . . . . . .
206
6.6
The Neutrino Velocity Isocurvature Primordial Mode . . . . . . . .
207
6.7
Planck Constraints on Isocurvature Modes . . . . . . . . . . . . . . . .
209
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
210
7
Stochastic Properties of Cosmological Perturbations . . . . . . . . . . . .
211
7.1
Stochastic Cosmological Perturbations and Power Spectrum . . .
212
7.2
Random Fields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
213
7.3
Power Spectrum and Gaussian Random Fields . . . . . . . . . . . . .
217
7.3.1
Deﬁnition of a Gaussian Random Field . . . . . . . . . . . .
218
7.3.2
Estimator of the Power Spectrum and Cosmic
Variance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
219
7.4
Non-Gaussian Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . . .
221
7.5
Matter Power Spectrum, Transfer Function and Stochastic
Initial Conditions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
222
7.6
CMB Power Spectra . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
224
7.6.1
Cosmic Variance of Angular Power Spectra . . . . . . . . .
228
7.7
Power Spectrum for Tensor Perturbations . . . . . . . . . . . . . . . . .
230
7.8
Ergodic Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
231
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
234
8
Inﬂation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
235
8.1
The Flatness Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
235
8.2
The Horizon Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
238
8.3
Single Scalar Field Slow-Roll Inﬂation. . . . . . . . . . . . . . . . . . .
240
8.3.1
More Slow-Roll Parameters . . . . . . . . . . . . . . . . . . . .
243
8.3.2
Reheating . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
246
8.4
Production of Gravitational Waves During Inﬂation . . . . . . . . .
248
8.5
Production of Scalar Perturbations During Inﬂation . . . . . . . . . .
256
xiv
Contents

8.6
Spectral Indices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
262
8.7
Observational Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
264
8.8
Examples of Models of Inﬂation . . . . . . . . . . . . . . . . . . . . . . .
265
8.8.1
General Power Law Potential . . . . . . . . . . . . . . . . . . .
266
8.8.2
The Starobinsky Model. . . . . . . . . . . . . . . . . . . . . . . .
267
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
270
9
Evolution of Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
273
9.1
Evolution on Super-Horizon Scales . . . . . . . . . . . . . . . . . . . . .
275
9.1.1
Evolution Through Radiation-Matter Equality . . . . . . .
276
9.1.2
Evolution in the K-Dominated Epoch . . . . . . . . . . . . .
280
9.1.3
Evolution Through Matter-DE Equality . . . . . . . . . . . .
281
9.2
The Matter-Dominated Epoch . . . . . . . . . . . . . . . . . . . . . . . . .
284
9.2.1
Baryons Falling into the CDM Potential Wells. . . . . . .
287
9.3
The Radiation-Dominated Epoch . . . . . . . . . . . . . . . . . . . . . . .
290
9.4
Deep Inside The Horizon . . . . . . . . . . . . . . . . . . . . . . . . . . . .
294
9.5
Matching and CDM Transfer Function . . . . . . . . . . . . . . . . . . .
296
9.6
The Transfer Function for Tensor Perturbations . . . . . . . . . . . .
302
9.6.1
Radiation-Dominated Epoch . . . . . . . . . . . . . . . . . . . .
303
9.6.2
Matter-Dominated Epoch . . . . . . . . . . . . . . . . . . . . . .
304
9.6.3
Deep Inside The Horizon . . . . . . . . . . . . . . . . . . . . . .
305
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
308
10
Anisotropies in the Cosmic Microwave Background . . . . . . . . . . . .
309
10.1
Free-Streaming . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
310
10.2
Anisotropies on Large Scales. . . . . . . . . . . . . . . . . . . . . . . . . .
315
10.3
Tight-Coupling and Acoustic Oscillations . . . . . . . . . . . . . . . . .
317
10.3.1
The Acoustic Peaks for R ¼ 0 . . . . . . . . . . . . . . . . . . .
320
10.3.2
Baryon Loading . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
325
10.4
Diffusion Damping . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
329
10.5
Line-of-Sight Integration . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
334
10.6
Finite Thickness Effect and Reionization . . . . . . . . . . . . . . . . .
339
10.7
Cosmological Parameters Determination . . . . . . . . . . . . . . . . . .
342
10.8
Tensor Contribution to the CMB TT Correlation . . . . . . . . . . .
348
10.9
Polarisation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
354
10.9.1
Scalar Perturbations Contribution to Polarisation . . . . .
354
10.9.2
Tensor Perturbations Contribution to Polarisation . . . . .
357
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
363
11
Miscellanea . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
365
11.1
Bayesian Analysis Using Type Ia Supernovae Data . . . . . . . . .
365
11.2
Doing Statistics in the Sky . . . . . . . . . . . . . . . . . . . . . . . . . . .
369
11.2.1
Top Hat and Gaussian Filters . . . . . . . . . . . . . . . . . . .
371
11.2.2
Sampling and Shot Noise . . . . . . . . . . . . . . . . . . . . . .
373
Contents
xv

11.2.3
Correlation Function . . . . . . . . . . . . . . . . . . . . . . . . . .
375
11.2.4
Bias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
377
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
378
12
Appendices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
379
12.1
Thermal Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
379
12.1.1
Derivation of the Maxwell–Boltzmann Distribution . . .
379
12.1.2
Derivation of the Fermi–Dirac Distribution . . . . . . . . .
380
12.1.3
Derivation of the Bose–Einstein Distribution . . . . . . . .
382
12.2
Derivation of the Poisson Distribution . . . . . . . . . . . . . . . . . . .
382
12.3
Helmholtz Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
384
12.4
Conservation of R on Large Scales and for Adiabatic
Perturbations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
385
12.5
Spherical Harmonics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
387
12.5.1
Spin-Weighted Spherical Harmonics . . . . . . . . . . . . . .
394
12.6
Method of Green’s Functions . . . . . . . . . . . . . . . . . . . . . . . . .
396
12.7
Polarisation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
398
12.7.1
Electromagnetic Waves . . . . . . . . . . . . . . . . . . . . . . . .
398
12.7.2
Polarisation Ellipse and Stokes Parameters . . . . . . . . . .
400
12.8
Thomson Scattering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
406
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
412
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
413
xvi
Contents

Notation
Humans are good, she knew, at discerning subtle patterns
that are really there, but equally so at imagining them when
they are altogether absent
Carl Sagan, Contact
Latin indices (e.g. i, j, k) run over the three spatial coordinates, and assume values
1, 2, 3. In a Cartesian coordinate system, we shall use x1  x, x2  y and x3  z.
Greek indices (e.g. l, m, q) run over the four spacetime coordinates, and assume
values 0, 1, 2, 3, with x0 being the time coordinate.
Repeated high and low indices are summed unless otherwise stated, i.e. xlyl 
P4
l¼0 xlyl or xiyi  P3
i¼1 xiyi. Repeated spatial indices are also summed, whether
one is high and the other is low or not, i.e. xiyi  P3
i¼0 xiyi.
The signature employed for the metric is ð; þ ; þ ; þ Þ.
Spatial 3-vectors are indicated in boldface, e.g. v.
The unit vector corresponding to any 3-vector v is denoted with a hat, i.e.
^v  v=jvj, where jvj is the modulus of the 3-vector v deﬁned as jvj2 ¼ dijviv j with
dij being the usual Kronecker delta.
A dot over any quantity denotes the derivation with respect to the cosmic time,
denoted with t, of that quantity, whereas a prime denotes derivation with respect to
the conformal time, denoted with g.
The operator r2 is the usual Laplacian operator in the Euclidian space, i.e.
r2  dij@i@j, where @l is used as a shorthand for the partial derivative with respect
to the coordinate xl.
Except on vector and tensor, a 0 subscript means that a time-dependent quantity
is evaluated today, i.e. at t ¼ t0 or g ¼ g0 where t0 and g0 represent the age of the
universe in the cosmic time or in the conformal time.
The subscripts b, c,  and m put on matter quantities such as density and pressure
refer to baryons, cold dark matter, photons and neutrinos, respectively. Subscripts
m and r refer to matter and radiation, in general.
With k is denoted the comoving wavenumber.
xvii

From Chap. 4 on natural units h ¼ c ¼ 1 shall be employed.
When employing the spherical coordinate system, the azimuthal coordinate is
denoted with /. A scalar ﬁeld is denoted with ’.
xviii
Notation

Chapter 1
Cosmology
And that inverted Bowl we call the Sky,
Whereunder crawling coop’t we live and die,
Lift not thy hands to It for help—for It,
Rolls impotently on as Thou or I
Omar Khayyám, Rubáiyát
In this Chapter we present an overview of cosmology, addressing its most important
aspects and presenting some observational experiments and open problems.
1.1
The Expanding Universe and its Content
The starting point of our study of cosmology is the extraordinary evidence that
we live in an expanding universe. This was a landmark discovery made in the XX
century, usually attributed to Edwin Hubble (1929), but certainly resulting from the
joint efforts of astronomers such as Vesto Slipher (1917) and cosmologists such as
George Lemaître (1927). We do not enter here the debate about who is deserving
more credit for the discovery of the expansion of the universe. The interested reader
might want to read e.g. Way and Nussbaumer (2011); van den Bergh (2011).
Hubble discovered that the farther a galaxy is the faster it recedes from us. See
Fig.1.1. This is the famous Hubble’s law:
v = H0r ,
(1.1)
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_1
1

2
1
Cosmology
Fig. 1.1 Figure1 of Hubble’s original paper (Hubble 1929)
where v is the recessional velocity, r is the distance and H0 (usually pronounced
“H-naught”) is a constant named after Hubble. The value of H0 determined by Hubble
himself was:
H0 = 500 km s−1 Mpc−1 ,
(1.2)
with huge error, as can be understood from Fig.1.1 by observing how much the data
points are scattered. A more precise estimate was made by Sandage (1958) in 1958:
H0 = 75 km s−1 Mpc−1 .
(1.3)
A recent measurement done by the BOSS collaboration (Grieb et al. 2017) gives
H0 = 67.6+0.7
−0.6 km s−1 Mpc−1 .
(1.4)
Roughly speaking, this number means that for each Mpc away a source recedes
67.6km/s faster. At a certain radius, the receding velocity attains the velocity of
light and therefore we are unable to see farther objects. This radius is called Hubble
radius.
The Hubble constant can be measured also with fair precision by using the time-
delay among variable signals coming from lensed distant sources (Bonvin et al. 2017)
and via gravitational waves (Abbott et al. 2017b).

1.1 The Expanding Universe and its Content
3
1.1.1
Olbers’s Paradox
The expansion of the universe could have been predicted a century before Hubble
by solving Olbers’s paradox (Olbers 1826). See e.g. Dennis Sciama’s book (Sciama
2012) for a very nice account of the paradox, which is also called the dark night
sky paradox and goes as follows: if the universe is static, inﬁnitely large and old
and with an inﬁnite number of stars distributed uniformly, then the night sky should
be bright.
Let us try to understand why. First of all, the stars are distributed uniformly, which
means that their number density say n is a constant. Consider a spherical shell of
thickness d R and radius R centred on the Earth. The number of stars inside this
spherical shell is:
dN = 4πnR2d R .
(1.5)
The total luminosity of this spherical shell is dN multiplied by the luminosity say L
of a single star, and we assume L to be the same for all the stars. Only a fraction f of
the radiation produced by the star reaches Earth, but this fraction is the same for all
the stars (because we assume them to be identical). Therefore, the total luminosity
of a spherical shell is dN f L. By the inverse-square law, the total ﬂux received on
Earth is:
dFtot = dN f L
4πR2 = nf Ld R .
(1.6)
It does not depend on R and thus it diverges when integrated over R from zero to
inﬁnity. This means not only that the night sky should not be dark but also inﬁnitely
bright!
We can solve the problem of having an inﬁnitely bright night sky by considering
the fact that stars are not points and do eclipse each other, so that we do not really
see all of them. Suppose that each star shows us a surface d A. Therefore, if a star
lies at a distance R, we receive from it the ﬂux dF = d AL/(4πR2), where L is the
luminosity per unit area. But d A/R2 = d is the solid angle spanned by the star in
the sky. Therefore:
dF = L
4π d .
(1.7)
Once again, this does not depend on R! When we integrate it over the whole solid
angle, we obtain that Ftot = L, i.e. the whole sky is as luminous as a star! In other
words: it is true that the farther a star is the fainter it appears, but we can pack more
of them in the same patch of sky.
In order to solve Olbers’s paradox, we can drop one or more of the initial assump-
tions. For example:
• The universe is not eternal so the light of some stars has not yet arrived to us. This
is plausible, but even so we could expect a bright night sky and also to see some
new star to pop out from time to time, without being a transient phenomenon such
as a supernova explosion. There is no record of this.

4
1
Cosmology
• Maybe there is not an inﬁnite number of stars. But we have showed that taking into
account their dimension we do not need an inﬁnite number and yet the paradox
still exists.
• Are stars distributed not uniformly? Even so, we would expect still a bright night
sky, even if not uniformly bright.
At the end, we must do something in order for the light of some stars not to reach us.
A possibility is to drop the staticity assumption. The farther a spherical shell is, the
faster it recedes from us (this is Hubble’s law). In this way, beyond a certain distance
(the Hubble radius) light from stars cannot reach us and the paradox is solved.
1.1.2
The Accelerated Expansion of the Universe and Dark
Energy
The discovery of the type Ia supernova 1997ff (Williams et al. 1996) marked the
beginning of a new era in cosmology and physics. The analysis of the emission
of this type of supernovae led to the discovery that our universe is in a state of
accelerated expansion. See e.g. Perlmutter et al. (1999); Riess et al. (1998).
This is somewhat problematic because gravity as we know it should attract matter,
thereby causing the expansion to decelerate. So, what does cause the acceleration
in the expansion? A possibility is that there exists a new form of matter, or rather
energy, which acts as anti-gravity. This is widely known today as Dark Energy (DE)
and its nature is still a mystery to us. The most simple and successful candidate for
DE is the cosmological constant .
1.1.3
Dark Matter
DE is not the only dark part of our universe. Many observations of different nature
and from different sources at different distance scales point out the existence of
another dark component, called Dark Matter (DM). In particular, these observations
are:
• The dynamics of galaxies in clusters. The pioneering applications of the virial
theorem to the Coma cluster by Zwicky (1933) resulted in a virial mass 500 times
the observed one (which can be estimated by the light emission).
• Rotation curves of spiral galaxies. This is the famous problem of the ﬂattish
velocity curves of stars in the outer parts of spiral galaxies. See e.g. Sofue et al.
(1999); Sofue and Rubin (2001).
The surprising fact of these ﬂattish curves is that there is no visible matter to
justify them and one would then expect a Keplerian fall V ∼1/
√
R, where R is the
distance from the galactic centre. In order to derive the Keplerian fall, simply assume

1.1 The Expanding Universe and its Content
5
a circular orbit and use Newtonian gravity (which seems to be ﬁne for galaxies).
Then, the centrifugal force is canceled by the gravitational attraction of the galaxy
as follows:
V 2
R = GM(R)
R2
,
(1.8)
where we assume also a spherical distribution of matter in the galaxy and therefore
use Gauss’ theorem. Inside the bulge of the galaxy, the visible mass goes as M ∝R3,
and therefore V ∝R, which represents the initial part of the velocity curve. However,
outside the bulge of the galaxy, the mass becomes a constant, thus the Keplerian fall
V ∝1/
√
R follows.
• The brightness in X-rays of galaxy clusters. This depends on the gravitational
potential well of the cluster, which is deduced to be much deeper than the one that
would be generated by visible matter only. See e.g. Weinberg (2008).
• The formation of structures in the universe. In other words, the fact that the
density contrast of the usual matter, called baryonic in cosmology, δb is today highly
non-linear, i.e. δb ≫1. As we shall see in Chap.9, relativistic cosmology predicts
that δb grows by a factor of 103 between recombination and today and observations
of CMB show that the value of δb at recombination is δb ∼10−5. This means that
today δb ∼10−2 which is in stark contrast with the huge number of structures that we
observe in our universe. So, there must be something else which catalyses structure
formation.
•ThestructureoftheCosmicMicrowaveBackgroundpeaks.Thetemperature-
temperature correlation spectrum in the CMB sky is characterised by the so-called
acoustic peaks. The absence of DM would not allow to reproduce the structure
shown in Fig.1.2. We shall study this structure in detail in Chap.10.
• Weak Lensing. The bending of light is a method for measuring the mass of the
lens, and it is a classical test of General Relativity (GR) (Weinberg 1972). When the
background source is distorted by the foreground lens, one has the so-called weak
lensing.Analysingtheemissionofthedistortedsourceallowstomapthegravitational
potential of the lens and therefore its matter distribution. See e.g. Dodelson (2017)
for a recent textbook reference on gravitational lensing. Weak gravitational lensing
is a powerful tool for the study of the geometry of the universe and its observation
is one of the primary targets of forthcoming surveys such as the European Space
Agency (ESA) satellite Euclid and the Large Synoptic Survey Telescope (LSST).
A remarkable combination of X-ray and weak lensing observational techniques
made the Bullet Cluster famous (Clowe et al. 2006). Indeed X-ray maps show the
result of a merging between the hot gases of two galaxy clusters which gravitational
lensing maps reveal to be lagging behind their respective centres of mass. Therefore,
most parts of the clusters simply went through one another, leaving behind a smaller
fraction of hot gas. This is considered a direct empirical proof of the existence of DM
forming a massive halo and a gravitational potential well in which gas and galaxies
lie.

6
1
Cosmology
Fig. 1.2 CMB TT spectrum. Figure taken from Ade et al. (2016a). The red solid line is the best ﬁt
CDM model
Popular candidates to the role of DM are particles beyond the standard model (Silk
et al. 2010). Among these, the most famous are the Sterile Neutrino (Dodelson and
Widrow 1994), the Axion, which is related to the process of violation of CP symmetry
(Peccei and Quinn 1977), and Weakly Interacting Massive Particles (WIMP) which
count among them the lightest supersymmetric neutral stable particle, theNeutralino.
See Bertone and Hooper (2016) for a historical account of DM and (Profumo 2017)
for a textbook on particle DM.
The observational evidences of DM that we have seen earlier do not only point
to the existence of DM but also on the necessity of it being cold, i.e. with negligible
pressure or, equivalently, with a small velocity (much less than that of light) of its
particles (admitting that DM is made of particles, which is the common understanding
to which we adhere in these notes). Hence Cold Dark Matter (CDM) shall be our
DM paradigm.
As we shall see in Chap.3 if DM was in thermal equilibrium with the rest of the
known particles in the primordial plasma, i.e. it was thermally produced, then its
being cold amounts to say that its particles have a sufﬁciently large mass, e.g. about
100GeV for WIMP’s. Decreasing the mass, we have DM candidates characterised
by increasing velocity dispersions and thus with different impacts on the process
of structure formation. Typically one refers to Warm Dark Matter (WDM) as a
thermally produced DM with mass of the order of some keV and Hot Dark Matter
(HDM) as thermally produced particles with small masses, e.g. of the order of the
eV, or even massless. In fact neutrinos can be considered as a HDM candidate. Note

1.1 The Expanding Universe and its Content
7
that the axion has a mass of about 10−5 eV but nonetheless is CDM because it was
not thermally produced, i.e. it never was in thermal equilibrium with the primordial
plasma.
The combined observational successes of  and CDM form the so-called CDM
model, which is the standard model of cosmology.
1.2
Cosmological Observations
We dedicate this section to the most important cosmological observations which are
ongoing or ended recently, or are planned.
1.2.1
The Cosmic Microwave Background
The cosmic microwave background (CMB) radiation provides a window onto the
early universe, revealing its composition and structure. It is a relic, thermal radiation
from a hot dense phase in the early evolution of our universe which has now been
cooledbythecosmicexpansiontojustthreedegreesaboveabsolutezero.Itsexistence
had been predicted in the 1940s by Alpher and Gamow (1948) and its discovery by
Penzias and Wilson at Bell Labs in New Jersey, announced in 1965 (Penzias and
Wilson 1965) was convincing evidence for most astronomers that the cosmos we see
today emerged from a Hot Big Bang more than 10 billion years ago.
Since its discovery, many experiments have been performed to observe the CMB
radiation at different frequencies, directions and polarisations, mostly with ground-
and balloon-based detectors. These have established the remarkable uniformity of the
CMB radiation, at a temperature of 2.7 Kelvin in all directions, with a small ±3.3mK
dipole due to the Doppler shift from our local motion (at 1 million kilometres per
hour) with respect to this cosmic background.
However, the study of the CMB has been transformed over the last twenty years
by three pivotal satellite experiments. The ﬁrst of these was the Cosmic Background
Explorer (CoBE, https://lambda.gsfc.nasa.gov/product/cobe/), launched by NASA
in 1990. In 1992 CoBE reported the detection of statistically signiﬁcant temperature
anisotropies in the CMB, at the level of ±30µK on 10 degree scales (Smoot et al.
1992) and it conﬁrmed the black body spectrum with an astonishing precision, with
deviations less than 50 parts per million (Smoot et al. 1992). CoBE was succeeded
by the Wilkinson Microwave Anisotropy Probe (WMAP, https://map.gsfc.nasa.gov/)
satellite, launched by NASA in 2001, which produced full sky maps in ﬁve frequen-
cies (from 23 to 94GHz) mapping the temperature anisotropies to sub-degree scales
and determining the CMB polarisation on large angular scales for the ﬁrst time.
The Planck satellite (http://sci.esa.int/planck/), launched by ESA in 2009, sets the
current state of the art with nine separate frequency channels, measuring temperature
ﬂuctuations to a millionth of a degree at an angular resolution down to 5 arc-minutes.

8
1
Cosmology
Planck’s mission ended in 2013 and the full-mission data were released in 2015 in
Adam et al. (2016) and in many companion papers. A fourth generation of full-sky,
microwave-band satellite recently proposed to ESA within Cosmic Vision 2015-2025
istheCosmicOriginsExplorer (COrE,http://www.core-mission.org/)(Bouchetetal.
2011).
At the moment, a great effort is being devoted to the detection of the B-mode
of CMB polarization because it is the one related to the primordial gravitational
waves background, as we shall see in Chap.10. Located near the South Pole,
BICEP3 (https://www.cfa.harvard.edu/CMB/bicep3/) and the Keck Array are tele-
scopes devoted to this purpose.
Among the non-satellite CMB experiments we must mention the Balloon Obser-
vations Of Millimetric Extragalactic Radiation ANd Geophysics (BOOMERanG)
which was a balloon-based mission which ﬂew in 1998 and in 2003 and mea-
sured CMB anisotropies with great precision (higher than CoBE). From these
data the Boomerang collaboration ﬁrst determined that the universe is spatially ﬂat
(de Bernardis et al. 2000).
1.2.2
Redshift Surveys
Redshift surveys are observations of certain patches of sky at certain wavelengths
with the aim of determining mainly the angular positions (declination and right
ascension) redshifts and spectra of galaxies.
The Sloan Digital Sky Survey (SDSS, http://www.sdss.org/) is a massive spectro-
scopic redshift survey which is ongoing since the year 2000 and it is now in its stage
IV with 14 data releases available. It is ground-based and uses a telescope located in
New Mexico (USA). The SDSS-IV is formed by three sub-experiment:
• The Extended Baryon Oscillation Spectroscopic Survey (eBOSS), focusing on
redshifts 0.6 < z < 2.5 and on the Baryon Acoustic Oscillations (BAO) phe-
nomenon1;
• The Apache Point Observatory Galaxy Evolution Experiment (APOGEE-2) is
dedicated to the study of our Milky Way;
• The Mapping Nearby Galaxies at Apache Point Observatory (MaNGA) study
instead nearby galaxies by measuring their spectrum along their extension and not
only at the centre.
The V generation of the SDSS will start in 2020, consisting of three surveys: the
Milky Way Mapper, the Black Hole Mapper and the Local Volume Mapper. See
Kollmeier et al. (2017).
1We shall not address BAO extensively in these notes, but only mention them in Chap.10. Together
with weak lensing, BAO are another powerful observable upon which present and future missions
are planned.

1.2 Cosmological Observations
9
The Dark Energy Survey (DES, https://www.darkenergysurvey.org/) measures
redshifts photometrically using a telescope situated in Chile and looking for Type Ia
supernovae, BAO and weak lensing signals.
Planned surveys are the already mentioned satellite Euclid (http://sci.esa.int/
euclid/), whose launch is due possibly in 2021 and the telescope LSST, which is being
built in Chile and whose ﬁrst light is due in 2019. We also cite the NASA satellite
Wide Field Infrared Survey Telescope (WFIRST, https://www.nasa.gov/wﬁrst) and
the Javalambre Physics of the accelerating universe Astronomical Survey (J-PAS,
http://j-pas.org/). The main cosmological goals of these experiments relay on the
detection of weak lensing, BAO and type Ia supernovae signals with high precision.
1.2.3
Gravitational Waves Observatories
The recent direct detection of gravitational waves (GW) by the LIGO-Virgo collabo-
ration(https://www.ligo.org/)(Abbottetal.2016a,b)hasopenedanewobservational
window on the universe. In particular, GW are relevant in cosmology because they
could be a relic from inﬂation containing invaluable informations on the very early
universe. As already mentioned, they are being searched via the detection of the
B-mode polarisation of the CMB.2
There are now three functioning ground-based GW observatories: LIGO (Hanford
and Livingstone, USA) and Virgo (near Pisa, Italy). KAGRA, in Japan, is under
construction and another one in India, INDIGO, is planned. The space-based LISA
GW observer is still in a preliminary phase (LISA pathﬁnder).
1.2.4
Neutrino Observation
Neutrinos are relevant in cosmology, as we shall see throughout these notes, because
they should form a cosmological background as CMB photons do. The great problem
is that it is incredibly difﬁcult to detect them and even more if they have low energy,
as we expect to be the case for neutrinos in the cosmological background.
The most important neutrino observatory is IceCube (http://icecube.wisc.edu/),
operating since 2005 (its construction was completed in 2010) and located near the
South Pole. It detects neutrinos indirectly, via their emission of Cherenkov light.
2The events detected by the LIGO-Virgo collaboration originated from merging of black holes or
neutron stars. Thus are not part of the primordial GW background.

10
1
Cosmology
1.2.5
Dark Matter Searches
The search for DM particles counts on many observatories and the Large Hadron
Collider (LHC). See Gaskins (2016); Liu et al. (2017) for the status of indirect and
direct DM searches which, unfortunately, have not been successful until now.
1.3
Redshift
Redshift is a fundamental observable of cosmology. Its deﬁnition is the following:
z = λobs
λem
−1
(1.9)
It is always positive, i.e. observed radiation is redder than the emitted one, because the
universe is in expansion. For the closest sources, such as Andromeda, it is negative,
i.e. the observed radiation is bluer than the emitted one, because the Hubble ﬂow is
overcome by the peculiar motion due to local gravitational effects.
For the moment we can think of the redshift as a Doppler effect due to the relative
motion of the sources. In Chap.2 we will relate it to spacetime geometry with GR.
Redshift is measured in two ways: spectroscopically or photometrically. For the
former one needs to do spectroscopy, i.e. detecting known emission or absorption
lines from a source and comparing their wavelengths with the ones measured in a
laboratory on Earth. Hence one uses Eq.(1.9) and thus calculate z.
Photometric redshifts are calculated by assuming certain spectral features for the
sources and measuring their relative brightness in certain wavebands, using ﬁlters.
A simple example is the following. Sun’s spectrum is almost a blackbody one
with temperature of about 6000K and then, by using Wien’s displacement law, it has
a peak emission at a wavelength of 500nm. Therefore, if a star similar to the Sun had
a peak emission of say 600nm, then using Eq.(1.9) one would calculate z = 0.2.
The reason for using photometry instead of spectroscopy is that it is less time-
consuming and allows to obtain redshifts of very far sources, for which it is difﬁcult
to do spectroscopy. On the other hand, photometric redshifts are less precise.
1.4
Open Problems in Cosmology
The fundamental issue in cosmology is to understand what are DM and DE. The
effort of answering this question makes cosmology, particle physics and quantum
ﬁeld theory (QFT) to merge. The ways adopted in order to tackle these problems are
essentially the search for particles beyond the standard model and the investigation
of new theories of gravity, which in most of the cases are extensions of GR.

1.4 Open Problems in Cosmology
11
1.4.1
Cosmological Constant and Dark Energy
Pure geometrical  and vacuum energy have the same dynamical behaviour in GR.
Estimating the latter via QFT calculations and comparing the result with the observed
value leads to the famous ﬁne-tuning problem of the cosmological constant. See e.g.
Weinberg (1989). This roughly goes as follows: the observed value of ρ is about
10−47 GeV4 (Ade et al. 2016a). The natural scale for the vacuum energy density is the
Planck scale, i.e. 1076 GeV4. There are 123 orders of magnitude of difference! Even
postulating a false vacuum state after the electro-weak phase transition at 108 GeV4,
the difference is 55 orders of magnitude. See Martin (2012) for a comprehensive
account of  and the issues related to it.
Another problem with  is the so-called cosmic coincidence (Zlatev et al. 1999).
This problem stems from the fact that the density of matter decreases with the inverse
of the cube scale factor, whereas the energy density of the cosmological constant
is, as its name indicates, constant. However, these two densities are approximately
equal at the present time. This coincidence becomes all the more intriguing when
we consider that if the cosmological constant had dominated the energy content of
the universe earlier, galaxies would not have had time to form; on the other hand,
had the cosmological constant dominated later, then the universe would still be in a
decelerated phase of expansion or younger than some of its oldest structures, such
as clusters of stars (Velten et al. 2014).
The cosmic coincidence problem can also be seen as a ﬁne-tuning problem in the
initial conditions of our universe. Indeed, consider the ratio ρ/ρm, of the cosmologi-
cal constant to the matter content. This ratio goes as a3. Suppose that we could extrap-
olate our classical theory (GR) up to the Planck scale, for which a ≈10−32. Then, at
the Planck scale we have ρ/ρm ≈10−96. This means that, at trans-Planckian ener-
gies, possibly in the quantum universe, there must be a mechanism which establishes
the ratio ρ/ρm with a precision of 96 signiﬁcant digits! Not a digit can be missed,
otherwise we would have today 10 times more cosmological constant than matter,
or vice-versa, thereby being in strong disagreement with observation.
So, we ﬁnd ourselves in a situation of impasse. On one hand,  is the simplest and
most successful DE candidate. On the other hand it suffers from the above-mentioned
issues. What do we do? Much of today research in cosmology addresses this question.
Answers are looked for mostly via investigation of new theories of gravity, extensions
or modiﬁcations of GR, of which DE would be a manifestation. There are so many
papers addressing extended theories of gravity that it is quite difﬁcult to choose
representatives. Probably the best option is to start with a textbook, e.g. Amendola
and Tsujikawa (2010).
A different approach is to accept that  has the value it has by chance, and it
turns out to be just the right value for structures to form and for us to be here doing
cosmology. This also known as Anthropic Principle and exists in many forms, some
stronger than others. It is also possible that ours is one universe out of an inﬁnite
number of realisations, called Multiverse, with different values of the fundamental
constants. Life as we know it then develops only in those universes where the condi-

12
1
Cosmology
tions are favourable. Again, it is difﬁcult to cite papers on these topics (which are more
about metaphysics rather than physics, since there is no possibility of performing
experimental tests) but a nice reading is e.g. Weinberg (1992).
1.4.2
Dark Matter and Small-Scale Anomalies
On sub-galactic scales, of about 1kpc, the CDM paradigm displays some difﬁculties
(Warrenetal.2006).Thesearecalled CDMsmall-scalesanomalies.Seee.g.Bullock
and Boylan-Kolchin (2017) for a recent account. They are essentially three and stem
from the results of numerical simulations of the formation of structures:
1. The Core/Cusp problem (Moore 1994). The CDM distribution in the centre of
the halo has a cusp proﬁle, whereas observation suggests a core one;
2. TheMissingsatellitesproblem (Klypinetal.1999).Numericalsimulationspredict
a large number of satellite structures, which are not observed;
3. The Too big to fail problem (Boylan-Kolchin et al. 2011). The sub-structures
predicted by the simulations are too big not to be seen.
Possible solutions to these small-scale anomalies are the following:
Baryon feedback. The cross section for DM particles and the standard model par-
ticles interaction must be very small, i.e. ∼10−39 cm2, but in environments of high
concentration, such as in the centre of galaxies, such interactions may become impor-
tant and may provide an explanation for the anomalies. The problem is that the models
of baryon feedback are difﬁcult to be simulated and they seem not to be enough to
resolve the anomalies (Kirby et al. 2014).
Warm dark matter. As anticipated, WDM are particles with mass around the keV
which decouple from the primordial plasma when relativistic. They are subject to
free streaming that greatly cut the power of ﬂuctuations on small scales, thereby
possibly solving the anomalies of the CDM. The problem with WDM is that different
observations indicate mass limits which are inconsistent among them. In particular:
• To solve the Core/Cusp problem is necessary a mass of ∼0.1keV (Macciò et al.
2012).
• To solve the Too big to fail problem is necessary a mass of ∼2keV (Lovell et al.
2012).
• Constraints from the Lyman-α observation require mWDM > 3.3keV (Viel et al.
2013).
These observational tensions disfavour WDM. In addition, it was shown in Schneider
et al. (2014) that for mWDM > 3.3 keV WDM does not provide a real advantage over
CDM.
Interacting Dark Matter. CDM anomalies could perhaps be understood by admit-
ting the existence of self-interactions between dark matter particles (Spergel and

1.4 Open Problems in Cosmology
13
Steinhardt 2000). It has been shown that there are indications that interaction models
can alleviate the Core/Cusp and the Too big to fail problems (Vogelsberger et al.
2014). Recently, Macciò et al. (2015) pointed out that a certain type of interaction
and mixing between CDM and WDM particles is very satisfactory from the point of
view of the resolution of the anomalies.
1.4.3
Other Problems
Understanding the nature of DE and DM is the main open question of today cosmol-
ogy but here follows a small list of other open problems:
• The problem of the initial singularity, the so-called Big Bang. This issue is related
to a quantum formulation of gravity.
• There exists a couple of more technical, but nevertheless very important, issues
which are called tensions. These happen when observations of different phenom-
ena provide constraints on some parameters which are different up to 68% or 95%
conﬁdence level. There is now tension between the determination of H0 via low-
redshift probes and high-redshift ones (i.e. CMB). See e.g. Marra et al. (2013);
Verde et al. (2013). Moreover, there is also a tension on the determination of σ8
(Battye et al. 2015), recently corroborated by the analysis of the ﬁrst year of the
DES survey data collection (Abbott et al. 2017d).
• Testing the cosmological principle and the copernican principle. See e.g. Valken-
burg et al. (2014).
• The CMB anomalies (Schwarz et al. 2016). These are unexpected (in the sense of
statistically relevant) features of the CMB sky.
• The Lithium problem (Coc 2016). The predicted Lithium abundance is much larger
than the observed one.
References
Abbott, T.M.C., et al.: Dark energy survey year 1 results: cosmological constraints from galaxy
clustering and weak lensing (2017d)
Abbott, B.P., et al.: Observation of gravitational waves from a binary black hole merger. Phys. Rev.
Lett. 116(6), 061102 (2016b)
Abbott, B.P., et al.: GW151226: observation of gravitational waves from a 22-Solar-Mass binary
black hole coalescence. Phys. Rev. Lett. 116(24), 241103 (2016a)
Abbott, B.P., et al.: A gravitational-wave standard siren measurement of the Hubble constant. Nature
551(7678), 85–88 (2017b)
Adam, R., et al.: Planck 2015 results. I. overview of products and scientiﬁc results. Astron. Astro-
phys. 594, A1 (2016)
Ade, P.A.R., et al.: Planck 2015 results. XIII. Cosmol. Parametr. Astron. Astrophys. 594, A13
(2016a)
Alpher, R.A., Bethe, H., Gamow, G.: The origin of chemical elements. Phys. Rev. 73, 803–804
(1948)

14
1
Cosmology
Amendola, L., Tsujikawa, S.: Dark Energy: Theory and Observations. Cambridge University Press,
Cambridge (2010)
Battye, R.A., Charnock, T., Moss, A.: Tension between the power spectrum of density perturbations
measured on large and small scales. Phys. Rev. D 91(10), 103508 (2015)
Bertone, G., Hooper, D.: A History of Dark Matter (2016)
Bonvin, V., et al.: H0LiCOW V. New COSMOGRAIL time delays of HE 04351223: H0 to 3.8
per cent precision from strong lensing in a ﬂat CDM model. Mon. Not. R. Astron. Soc. 465(4),
4914–4930 (2017)
Bouchet, F.R., et al.: COrE (Cosmic Origins Explorer) A White Paper (2011)
Boylan-Kolchin, M., Bullock, J.S., Kaplinghat, M.: Too big to fail? the puzzling darkness of massive
Milky way subhaloes. Mon. Not. R. Astron. Soc. 415, L40 (2011)
Bullock, J.S., Boylan-Kolchin, M.: Small-scale challenges to the CDM paradigm. Ann. Rev.
Astron. Astrophys. 55, 343–387 (2017)
Clowe, D., Bradac, M., Gonzalez, A.H., Markevitch, M., Randall, S.W., Jones, C., Zaritsky, D.: A
direct empirical proof of the existence of dark matter. Astrophys. J. 648, L109–L113 (2006)
Coc, A.: Primordial nucleosynthesis. J. Phys. Conf. Ser. 665(1), 012001 (2016)
de Bernardis, P., et al.: A ﬂat universe from high resolution maps of the cosmic microwave back-
ground radiation. Nature 404, 955–959 (2000)
Dodelson, S.: Gravitational Lensing. Cambridge University Press, UK (2017)
Dodelson, S., Widrow, L.M.: Sterile-neutrinos as dark matter. Phys. Rev. Lett. 72, 17–20 (1994)
Gaskins, J.M.: A review of indirect searches for particle dark matter. Contemp. Phys. 57(4), 496–525
(2016)
Grieb, J.N., et al.: The clustering of galaxies in the completed SDSS-III Baryon oscillation spectro-
scopic survey: cosmological implications of the fourier space wedges of the ﬁnal sample. Mon.
Not. R. Astron. Soc. 467(2), 2085–2112 (2017)
Hubble, E.: A relation between distance and radial velocity among extra-galactic nebulae. Proc.
Nat. Acad. Sci. 15, 168–173 (1929)
Kirby, E.N., Bullock, J.S., Boylan-Kolchin, M., Kaplinghat, M., Cohen, J.G.: The dynamics of
isolated local group galaxies. Mon. Not. R. Astron. Soc. 439(1), 1015–1027 (2014)
Klypin, A.A., Kravtsov, A.V., Valenzuela, O., Prada, F.: Where are the missing Galactic satellites?
Astrophys. J. 522, 82–92 (1999)
Kollmeier, J.A., Zasowski, G., Rix, H.-W., Johns, M., Anderson, S.F., Drory, N., Johnson, J.A.,
Pogge, R.W., Bird, J.C., Blanc, G.A., Brownstein, J.R., Crane, J.D., De Lee, N.M., Klaene, M.A.,
Kreckel, K., MacDonald, N., Merloni, A., Ness, M.K., O’Brien, T., Sanchez-Gallego, J.R., Sayres,
C.C., Shen, Y., Thakar, A.R., Tkachenko, A., Aerts, C., Blanton, M.R., Eisenstein, D.J., Holtzman,
J.A., Maoz, D., Nandra, K., Rockosi, C., Weinberg, D.H., Bovy, J., Casey, A.R., Chaname, J.,
Clerc, N., Conroy, C., Eracleous, M., Gänsicke, B.T., Hekker, S., Horne, K., Kauffmann, J.,
McQuinn, K.B.W., Pellegrini, E.W., Schinnerer, E., Schlaﬂy, E.F., Schwope, A.D., Seibert, M.,
Teske, J.K., van Saders, J.L.: SDSS-V: Pioneering Panoptic Spectroscopy (2017). ArXiv e-prints
Lemaître, G.: A homogeneous universe of constant mass and growing radius accounting for the
radial velocity of extragalactic nebulae. Ann. Soc. Sci. Brux. Ser. I Sci. Math. Astron. Phys. A47,
49–59 (1927)
Liu, J., Chen, X., Ji, X.: Current status of direct dark matter detection experiments. Nature Phys.
13(3), 212–216 (2017)
Lovell,M.R.,Eke,V.,Frenk,C.S.,Gao,L.,Jenkins,A.,Theuns,T.,Wang,J.,White,D.M.,Boyarsky,
A., Ruchayskiy, O.: The haloes of bright satellite galaxies in a warm dark matter universe. Mon.
Not. R. Astron. Soc. 420, 2318–2324 (2012)
Macciò, A.V., Paduroiu, S., Anderhalden, D., Schneider, A., Moore, B.: Cores in warm dark matter
haloes: a Catch 22 problem. Mon. Not. R. Astron. Soc. 424, 1105–1112 (2012)
Macciò, A.V., Mainini, R., Penzo, C., Bonometto, S.A.: Strongly coupled dark energy cosmologies:
preserving LCDM success and easing low scale problems II - cosmological simulations. Mon.
Not. R. Astron. Soc. 453, 1371–1378 (2015)

References
15
Marra, V., Amendola, L., Sawicki, I., Valkenburg, W.: Cosmic variance and the measurement of the
local Hubble parameter. Phys. Rev. Lett. 110(24), 241305 (2013)
Martin, J.: Everything you always wanted to know about the cosmological constant problem (But
were afraid to ask). Comptes Rendus Physique 13, 566–665 (2012)
Moore, B.: Evidence against dissipationless dark matter from observations of galaxy haloes. Nature
370, 629 (1994)
Olbers, W.: Edinburgh New philso. J 1, 141 (1826)
Peccei, R.D., Quinn, H.R.: CP conservation in the presence of instantons. Phys. Rev. Lett. 38,
1440–1443 (1977)
Penzias, A.A., Wilson, R.W.: A measurement of excess antenna temperature at 4080- Mc/s. Astro-
phys. J. 142, 419–421 (1965)
Perlmutter, S., et al.: Measurements of omega and lambda from 42 high-redshift supernovae. Astro-
phys. J. 517, 565–586 (1999)
Profumo, S.: An Introduction to Particle Dark Matter. Advanced textbooks in physics, World Sci-
entiﬁc (2017)
Riess, A.G., et al.: Observational evidence from supernovae for an accelerating universe and a
cosmological constant. Astron. J. 116, 1009–1038 (1998)
Sandage, A.: Current problems in the extragalactic distance scale. ApJ 127, 513 (1958)
Schneider, A., Anderhalden, D., Macciò, A., Diemand, J.: Warm dark matter does not do better than
cold dark matter in solving small-scale inconsistencies. Mon. Not. R. Astron. Soc. 441, 6 (2014)
Schwarz, D.J., Copi, C.J., Huterer, D., Starkman, G.D.: CMB anomalies after planck. Class. Quan-
tum Gravity 33(18), 184001 (2016)
Sciama, D.W.: The Unity of the Universe. Courier Corporation (2012)
Silk, J., et al.: Particle Dark Matter: Observations. Models and searches. Cambridge University
Press, Cambridge (2010)
Slipher, V.M.: Nebulae. Proc. Am. Philso. Soc. 56, 403–409 (1917)
Smoot, G.F., et al.: Structure in the COBE differential microwave radiometer ﬁrst year maps.
Astrophys. J. 396, L1–L5 (1992)
Sofue, Y., Rubin, V.: Rotation curves of spiral galaxies. Ann. Rev. Astron. Astrophys. 39, 137–174
(2001)
Sofue, Y., Tutui, Y., Honma, M., Tomita, A., Takamiya, T., Koda, J., Takeda, Y.: Central rotation
curves of spiral galaxies. Astrophys. J. 523, 136 (1999)
Spergel, D.N., Steinhardt, P.J.: Observational evidence for selﬁnteracting cold dark matter. Phys.
Rev. Lett. 84, 3760–3763 (2000)
Valkenburg, W., Marra, V., Clarkson, C.: Testing the copernican principle by constraining spatial
homogeneity. Mon. Not. R. Astron. Soc. 438, L6–L10 (2014)
van den Bergh, S.: The curious case of Lemaître’s equation No. 24. JRASC 105, 151 (2011)
Velten, H.E.S., vom Marttens, R.F., Zimdahl, W.: Aspects of the cosmological coincidence problem.
Eur. Phys. J. C 74(11), 3160 (2014)
Verde, L., Protopapas, P., Jimenez, R.: Planck and the local universe: quantifying the tension. Phys.
Dark Univ. 2, 166–175 (2013)
Viel, M., Becker, G.D., Bolton, J.S., Haehnelt, M.G.: Warm dark matter as a solution to the small
scale crisis: new constraints from high redshift Lyman-forest data. Phys. Rev. D 88, 043502
(2013)
Vogelsberger, M., Zavala, J., Simpson, C., Jenkins, A.: Dwarf galaxies in CDM and SIDM with
baryons: observational probes of the nature of dark matter. Mon. Not. R. Astron. Soc. 444, 3684
(2014)
Warren, M.S., Abazajian, K., Holz, D.E., Teodoro, L.: Precision determination of the mass function
of dark matter halos. Astrophys. J. 646, 881–885 (2006)
Way, M.J., Nussbaumer, H.: Lemaître’s Hubble relationship. Phys. Today 64N8, 8 (2011)
Weinberg, S.: Dreams of a Final Theory: The Search for the Fundamental Laws of Nature (1992)
Weinberg, S.: Gravitation and Cosmology: Principles and Applications of the General Theory of
Relativity. Wiley, New York (1972)

16
1
Cosmology
Weinberg, S.: The cosmological constant problem. Rev. Mod. Phys. 61, 1–23 (1989)
Weinberg, S.: Cosmology. Oxford University Press, UK (2008)
Williams, R.E., Blacker, B., Dickinson, M., Dixon, W.V.D., Ferguson, H.C., Fruchter, A.S.,
Giavalisco, M., Gilliland, R.L., Heyer, I., Katsanis, R., Levay, Z., Lucas, R.A., McElroy, D.B.,
Petro, L., Postman, M., Adorf, H.-M., Hook, R.: The hubble deep ﬁeld: observations, data reduc-
tion, and galaxy photometry. AJ 112, 1335 (1996)
Zlatev, I., Wang, L.-M., Steinhardt, P.J.: Quintessence, cosmic coincidence, and the cosmological
constant. Phys. Rev. Lett. 82, 896–899 (1999)
Zwicky, F.: Die Rotverschiebung von extragalaktischen Nebeln. Helvetica Physica Acta 6, 110–127
(1933)

Chapter 2
The Universe in Expansion
Oras ubicumque locaris extremas, quaeram: quid telo denique
ﬁet?
(wherever you shall set the boundaries, I will ask: what will then
happen to the arrow?)
Lucretius, De Rerum Natura
We introduce in this chapter the geometric basis of cosmology and the expansion of
the universe. A part from the technical treatment, historical, theological and mytho-
logical introductions to cosmology can be found in Ryden (2003) and Bonometto
(2008).
2.1
Newtonian Cosmology
In order to do cosmology we need a theory of gravity, because gravity is a long-range
interaction and the universe is pretty big. Electromagnetism is also a long-range
interaction, but considering the lack of evidence that the universe is charged or made
up of charges here and there, it seems reasonable that gravity is what we need in
order to describe the universe on large scales.
Which theory of gravity do we use for describing the universe? It turns out that
Newtonianphysicsworkssurprisinglywell!Itisalsosurprisingthatattemptsofdoing
cosmology with Newtonian gravity are well posterior to relativistic cosmology itself.
In particular, the ﬁrst work on Newtonian cosmology can be dated back to Milne
and McCrea in the 1930s (McCrea and Milne 1934; Milne 1934). These were models
of pure dust, while pressure was introduced later by McCrea (1951) and Harrison
(1965). More recently the issue of pressure corrections in Newtonian cosmology has
been tackled again in Lima et al. (1997), Fabris and Velten (2012), Hwang and Noh
(2013) and Baqui et al. (2016).
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_2
17

18
2
The Universe in Expansion
Newtonian cosmology works as follows. Imagine a sphere of dust of radius r.
This radius is time-dependent because the conﬁguration is not stable since there is no
pressure, thus r = r(t). We assume homogeneity of the sphere during the evolution,
i.e. its density depends only on the time:
ρ(t) =
3M
4πr(t)3 ,
(2.1)
where M is the mass of the dust sphere and is constant. Now, imagine a small test
particle of mass m on the surface of the sphere. By Newton’s gravitation law and
Gauss’s theorem one has:
F = −GMm
r(t)2
⇒
¨r = −4πG
3
ρr ,
(2.2)
where we have used Eq.(2.1) and the dot denotes derivation with respect to the time t.
This is the same acceleration equation that we shall ﬁnd later using GR, cf. Eq.(2.51).
Exercise 2.1 Integrate Eq.(2.2) and show that:
˙r2
r2 = 8πG
3
ρ −K
r2 ,
(2.3)
where K is an integration constant.
We shall also see that Eq.(2.3) is the same as Friedmann equation in GR, cf.
(2.50). The integration constant K can be interpreted as the total energy of the
particle. Indeed, we can rewrite Eq.(2.3) as follows:
E ≡−mK
2
= m
2 ˙r2 −GMm
r
,
(2.4)
which is the expression of the total energy of a particle of mass m in the gravitational
ﬁeld of the mass M.
2.2
Relativistic Cosmology
In GR we have geometry and matter related by Einstein equations:
Gμν = 8πG
c4 Tμν ,
(2.5)
where Gμν is the Einstein tensor, computed from the metric, and Tμν is the energy-
momentum or stress-energy tensor, and describes the matter content.

2.2 Relativistic Cosmology
19
In cosmology, which is the metric which describes the universe and what is the
matter content? It turns out that both questions are very difﬁcult to answer and,
indeed, there are no still clear answers, as we stressed in Chap.1.
2.2.1
Friedmann–Lemaître–Robertson–Walker Metric
The metric used to describe the universe on large scales is the Friedmann–Lemaître–
Robertson–Walker (FLRW) metric. This is based on the assumption of very high
symmetry for the universe, called the cosmological principle, which is minimally
stated as follows: the universe is isotropic and homogeneous, i.e. there is no preferred
direction or preferred position.
A more formal deﬁnition can be found in Weinberg (1972, p.412) and is based
on the following two requirements:
1. The hypersurfaces with constant cosmic standard time are maximally symmetric
subspaces of the whole of the spacetime;
2. The global metric and all the cosmic tensors such as the stress-energy one Tμν
are form-invariant with respect to the isometries of those subspaces.
We shall come back in a moment to maximally symmetric spaces. Roughly speaking,
the second requirement above means that the matter quantities can depend only on
the time.
The cosmological principle seems to be compatible with observations at very
large scales. According to Wu et al. (1999): on a scale of about 100 h−1 Mpc the rms
density ﬂuctuations are at the level of ∼10% and on scales larger than 300 h−1 Mpc
the distribution of both mass and luminous sources safely satisﬁes the cosmological
principle of isotropy and homogeneity.
In a recent work Sarkar and Pandey (2016) ﬁnd that the quasar distribution is
homogeneous on scales larger than 250h−1 Mpc. Moreover, numerical relativity
seems to indicate that the average evolution of a generic metric on large scale is
compatible with that of FLRW metric (Giblin et al. 2016).
According to the cosmological principle, the constant-time spatial hypersurfaces
are maximally symmetric.1 A maximally symmetric space is completely charac-
terised by one number only, i.e. its scalar curvature, which is also a constant. See
Weinberg (1972, Chap.13).
Let R be this constant scalar curvature. The Riemann tensor of a maximally
symmetric D-dimensional space is written as:
Rμνρσ =
R
D(D −1)(gμρgνσ −gμσgνρ) .
(2.6)
Contracting with gμρ we get for the Ricci tensor:
1This means that they possess 6 Killing vectors, i.e. there are six transformations which leave the
spatial metric invariant (Weinberg 1972).

20
2
The Universe in Expansion
Rνσ = R
D gνσ ,
(2.7)
and then R is the scalar curvature, as we stated, since gνσgνσ = D. Since any given
number can be negative, positive or zero, we have three possible maximally sym-
metric spaces. Now, focusing on the 3-dimensional spatial case:
1. ds2
3 = |dx|2 ≡δi jdxidx j, i.e. the Euclidean space. The scalar curvature is zero,
i.e. the space is ﬂat. This metric is invariant under 3-translations and 3-rotations.
2. ds2
3 = |dx|2 + dz2, with the constraint z2 + |x|2 = a2. This is a 3-sphere of radius
a embedded in a 4-dimensional Euclidean space. It is invariant under the six
4-dimensional rotations.
3. ds2
3 = |dx|2 −dz2, with the constraint z2 −|x|2 = a2. This is a 3-hypersphere,
or a hyperboloid, in a 4-dimensional pseudo-Euclidean space. It is invariant under
the six 4-dimensional pseudo-rotations (i.e. Lorentz transformations).
Exercise 2.2 Why are there six independent 4-dimensional rotations in the
4-dimensional Euclidean space? How many are there in a D-dimensional Euclidean
space?
Let us write in a compact form the above metrics as follows:
ds2
3 = |dx|2 ± dz2 ,
z2 ± |x|2 = a2 .
(2.8)
Differentiating z2 ± |x|2 = a2, one gets:
zdz = ∓x · dx .
(2.9)
Now put this back into ds2
3:
ds2
3 = |dx|2 ± (x · dx)2
a2 ∓|x|2 .
(2.10)
In a more compact form:
ds2
3 = |dx|2 + K (x · dx)2
a2 −K|x|2 ,
(2.11)
with K = 0 for the Euclidean case, K = 1 for the spherical case and K = −1 for
the hyperbolic case. The components of the spatial metric in Eq.(2.11) can be imme-
diately read off and are:
g(3)
i j = δi j + K
xix j
a2 −K|x|2 .
(2.12)

2.2 Relativistic Cosmology
21
Exercise 2.3 Write down metric (2.11) in spherical coordinates. Use the fact that
|dx|2 = dr2 + r2d2, where
d2 ≡dθ2 + sin2 θdφ2 ,
(2.13)
and use:
x · dx = 1
2d|x|2 = 1
2d(r2) = rdr .
(2.14)
Show that the result is:
ds2
3 =
a2dr2
a2 −Kr2 + r2d2
(2.15)
Calculate the scalar curvature R(3) for metric (2.15). Show that R(3)
i j = 2Kg(3)
i j /a2
and thus R(3) = 6K/a2.
If we normalise r →r/a in metric (2.15), we can write:
ds2
3 = a2

dr2
1 −Kr2 + r2d2

,
(2.16)
and letting a to be a function of time, we ﬁnally get the FLRW metric:
ds2 = −c2dt2 + a2(t)

dr2
1 −Kr2 + r2d2

(2.17)
The time coordinate used here is called cosmic time, whereas the spatial coordi-
nates are called comoving coordinates. For each t the spatial slices are maximally
symmetric; a(t) is called scale factor, since it tells us how the distance between two
points scales with time.
The FLRW metric was ﬁrst worked out by Friedmann (1922, 1924) and then
derived on the basis of isotropy and homogeneity by Robertson (1935, 1936) and
Walker (1937). Lemaître’s work (Lemaitre 1931) had been also essential to develop
it.2
A further comment concerning FLRW metric (2.17) is in order here. The dimen-
sionofdistanceisbeingcarriedbythescalefactora itself,sincewerescaledtheradius
r →r/a. Indeed, as we computed earlier, the spatial curvature is R(3) = 6K/a(t)2,
also time-varying, and it is a real, dimensional number as it should be.
2See also Lemaître (1997) for a recent republication and translation of Lemaître’s 1933 paper.

22
2
The Universe in Expansion
2.2.2
The Conformal Time
A very useful form of rewriting FLRW metric (2.17) is via the conformal time η:
adη = dt
⇒
η −ηi =
 t
ti
dt′
a(t′) .
(2.18)
Asweshallseelater,butaswealreadycanguessfromtheaboveintegration,c(η −ηi)
represents the comoving distance travelled by a photon between the times ηi and η,
or ti and t. The conformal time allows to rewrite FLRW metric (2.17) as follows:
ds2 = a(η)2

−c2dη2 +
dr2
1 −Kr2 + r2d2

(2.19)
i.e. the scale factor has become a conformal factor (hence the name for η). Recalling
the earlier discussion about dimensionality, if a has dimensions then cη is dimen-
sionless. On the other hand, if a is dimensionless, then η is indeed a time.
Note also that metric (2.19) for K = 0 is Minkowski metric multiplied by a
conformal factor.
2.2.3
FLRW Metric Written with Proper Radius
A third useful way to write FLRW metric (2.17) is using the proper radius, which
is deﬁned as follows:
D(t) ≡a(t)r .
(2.20)
We shall discuss in more detail the proper radius, or proper distance, in Sect.2.5.
Exercise 2.4 Using D instead of r, show that the FLRW metric (2.17) becomes:
ds2 = −c2dt2

1 −H 2
D2/c2
1 −KD2/a2

−2HDdtdD
1 −KD2/a2
+
dD2
1 −KD2/a2 + D2d2 ,
(2.21)
where
H ≡˙a
a
(2.22)
is the Hubble parameter. The dot denotes derivation with respect to the cosmic
time.

2.2 Relativistic Cosmology
23
2.2.4
Light-Cone Structure of the FLRW Space
Let us consider the K = 0 case, for simplicity. Moreover, consider also d = 0.
In this case, the radial coordinate is also the distance. Then, putting ds2 = 0 in the
FLRW metric gives the following light-cone structures.
Cosmic Time-Comoving Distance
From the FLRW metric (2.17), the condition ds2 = 0 gives us:
cdt
dr = ±a(t) .
(2.23)
We put our observer at r = 0 and t = t0. The plus sign in the above equation then
describes an outgoing photon, i.e. the future light-cone, whereas the negative sign
describes an incoming photon, i.e. the past-light cone, which is much more interesting
to us. So, let us keep the negative sign and discuss the shape of the light-cone.
Assume that a(0) = 0. Therefore, the slope of the past light-cone starts as −a(t0),
which we can normalise as −1, i.e. locally the past light-cone is identical to the
one in Minkowski space. However, a goes to zero, so the light-cone becomes ﬂat,
encompassing more radii than it would for Minkowski space. See Fig.2.1. We can
show this analytically by taking the second derivative of Eq.(2.23) with the minus
sign:
c2d2t
dr2
= −˙a cdt
dr = a ˙a .
(2.24)
Being a > 0 and ˙a > 0 (we consider just the case of an expanding universe), the
function t(r) is convex (i.e. it is “bent upwards”).
Conformal Time-Comoving Distance
For the FLRW metric (2.19), the condition ds2 gives:
cdη
dr = ±1 .
(2.25)
The latter is exactly the same light-cone structure of Minkowski space. Indeed,
Friedmann metric written in conformal time and for K = 0 is Minkowski metric
multiplied by a conformal factor a(η). See Fig.2.2.
Cosmic Time-Proper Distance
In order to ﬁnd the light-cone structure for the FLRW metric (2.21) with K = 0, we
need to solve the following equation:
−c2dt2
dD2

1 −H 2D2
c2

−2HD
c
cdt
dD + 1 = 0 .
(2.26)

24
2
The Universe in Expansion
Fig. 2.1 Space-time diagram and light-cone structure for the FLRW metric (2.17). Credit: Prof.
Mark Whittle, University of Virginia
Fig. 2.2 Space-time diagram and light-cone structure for the FLRW metric (2.19). Credit: Prof.
Mark Whittle, University of Virginia

2.2 Relativistic Cosmology
25
Exercise 2.5 Solve Eq.(2.26) algebraically for cdt/dD and show that:
cdt
dD =
 HD
c
± 1
−1
.
(2.27)
For t = t0 we have H(t0) > 0 and D = 0. Therefore, from Eq.(2.27) we have that
(cdt/dD)(t0) = ±1 and thus we must choose the minus sign in order to describe the
past light-cone. Going back in time, HD grows, until
HD
c
= 1 ,
(2.28)
for which cdt/dD diverges. This means that no signal can come from beyond this
distance D = c/H, which is the Hubble radius that we met in Chap.1. See Fig.2.3.
The lower part of this ﬁgure is explained as follows. First of all HD becomes larger
than 1, and this explains the change of sign of the slope of the light cone. Then, H →
∞for a →0 (if we assume a model with Big Bang) and therefore cdt/dD →0.
This is why the light-cone ﬂattens close to t = 0 in Fig.2.3.
2.2.5
Christoffel Symbols and Geodesics
Exercise 2.6 Assume K = 0 in metric (2.17), rewrite it in Cartesian coordinates
and calculate the Christoffel symbols. Show that:
0
00 = 0 ,
0
0i = 0 ,
0
i j = a ˙a
c δi j ,
i
0 j = H
c δi
j .
(2.29)
We now use these in the geodesic equation:
d Pμ
dλ + μ
νρPν Pρ = 0 ,
(2.30)
where Pμ ≡dxμ/dλ is the four-momentum and λ is an afﬁne parameter. For a
particle of mass m, one has λ = τ/m, where τ is the proper time. The norm of the
four-momentum is:
P2 ≡gμν PμPν = −E2
c2 + p2 = −m2c2 ,
(2.31)

26
2
The Universe in Expansion
Fig. 2.3 Space-time diagram and light-cone structure for the FLRW metric (2.21). Credit: Prof.
Mark Whittle, University of Virginia
where we have deﬁned the energy and the physical momentum (or proper momen-
tum):
E2
c2 ≡−g00(P0)2 ,
p2 ≡gi j Pi P j ,
(2.32)
and the last equality of Eq.(2.31), which applies only to massive particles, comes
from:
ds2
dλ2 = m2ds2
dτ 2
= −m2c2 ,
(2.33)
since, by deﬁnition, ds2 = −c2dτ 2. We have recovered above the well-known disper-
sion relation of special relativity. The metric gμν used above is, in principle, general.
But, of course, we now specialise it to the FLRW one.
For a photon, m = 0 and E = pc. The time-component of the geodesic equation
is the following:
d P0
dλ + a ˙a
c δi j Pi P j = 0 .
(2.34)
Introducing the proper momentum as deﬁned in Eq.(2.32), one gets:

2.2 Relativistic Cosmology
27
c dp
dλ + Hp2 = 0 .
(2.35)
Exercise 2.7 Solve Eq.(2.35) and show that p = E/c ∝1/a, i.e. the energy of the
photon is proportional to the inverse scale factor.
Therefore, we can write:
Eobs
Eem
= aem
aobs
.
(2.36)
On the other hand the photon energy is E = h f , with f its frequency. Therefore:
aem
aobs
= Eobs
Eem
= fobs
fem
= λem
λobs
=
1
1 + z .
(2.37)
This is the relation between the redshift and the scale factor. We have connected
observation with theory. Usually, aobs = 1 and the above relation is simply written
as 1 + z = 1/a.
What does happen, on the other hand, to the energy of a massive particle? The
time-geodesic equation for massive particles is identical to the one for photons, but
the dispersion relation is different, i.e. E2 = m2c4 + p2c2. Therefore:
E =

m2c4 + p2
i a2
i c2
a2
,
(2.38)
where pi is some initial proper momentum, at the time ti and ai = a(ti). For m = 0
we recover the result already obtained for photons. For massive particles the above
relation can be approximated as follows:
E = mc2

1 +
p2
i a2
i
2a2m2c2 + · · ·

,
(mc ≫p) ,
(2.39)
i.e. performing the expansion for small momenta which is usually done in special
relativity. The second contribution between parenthesis is the classical kinetic energy
of the particle, whose average is proportional to kBT . Therefore:
T ∝a−1 , for relativistic particles,
(2.40)
T ∝a−2 , for non-relativistic particles.
(2.41)
We shall recover the above result also using the Boltzmann equation.
Exercise 2.8 Show that p ∝1/a by using not the time-component geodesic equa-
tion but the spatial one:

28
2
The Universe in Expansion
d Pi
dλ + 2i
0 j P0P j = 0 .
(2.42)
Why is there a factor two in this equation?
2.3
Friedmann Equations
Given FLRW metric, Friedmann equations can be straightforwardly computed from
the Einstein equations:
Gμν + gμν = Rμν −1
2gμν R + gμν = 8πG
c4 Tμν ,
(2.43)
where  is the cosmological constant.
Exercise 2.9 Calculate from FLRW metric (2.17) the components of the Ricci ten-
sor. Show that:
R00 = −3
c2
¨a
a ,
R0i = 0 ,
Ri j = 1
c2 gi j

2H 2 + ¨a
a + 2 Kc2
a2

,
(2.44)
and show that the scalar curvature is:
R = 6
c2
 ¨a
a + H 2 + Kc2
a2

.
(2.45)
Finally, compute the Einstein equations:
H 2 + Kc2
a2
= 8πG
3c2 T00 + c2
3
(2.46)
gi j

H 2 + 2 ¨a
a + Kc2
a2 −c2

= −8πG
c2 Ti j
(2.47)
These are called Friedmann equations or Friedmann equation and acceleration
equation or Friedmann equation and Raychaudhuri equation.
Which stress-energy tensor Tμν do we use in Eqs.(2.46) and (2.47)? Having ﬁxed
the metric to be the FLRW one, we have some strong constraints:

2.3 Friedmann Equations
29
• First of all: G0i = 0 implies that T0i = 0, i.e. there cannot be a ﬂux of energy in
any direction because it would violate isotropy;
• Second, since Gi j ∝gi j, then Ti j ∝gi j.
• Finally, since Gμν depends only on t, then it must be so also for Tμν.
Therefore, let us stipulate that
T00 = ρ(t)c2 = ε(t) ,
T0i = 0 ,
Ti j = gi j P(t) ,
(2.48)
where ρ(t) is the rest mass density, ε(t) is the energy density and P(t) is the pressure.
In tensorial notation we can write the following general form for the stress-energy
tensor:
Tμν =

ρ + P
c2

uμuν + Pgμν
(2.49)
where uμ is the four-velocity of the ﬂuid element. In this form of Eq.(2.49), the stress-
energy tensor does not contain either viscosity or energy transport terms. Matter
described by (2.49) is known as perfect ﬂuid. For more detail about the latter see
Schutz (1985) whereas for more detail about viscosity, heat ﬂuxes and the imperfect
ﬂuids see e.g. Weinberg (1972) and Maartens (1996).
Combine Eqs.(2.46), (2.47) and (2.48). The Friedmann equation becomes:
H 2 = 8πG
3
ρ + c2
3
−Kc2
a2
(2.50)
while the acceleration equation is the following:
¨a
a = −4πG
3

ρ + 3P
c2

+ c2
3
(2.51)
Exercise 2.10 Write Eqs.(2.50) and (2.51) using the conformal time introduced in
Eq.(2.18). Show that the Friedmann equation becomes:
H2 = 8πG
3
ρa2 + c2a2
3
−Kc2
(2.52)
and that the acceleration equation becomes:
a′′
a = 4πG
3

ρ −3P
c2

a2 + 2c2a2
3
−Kc2 ,
(2.53)
where the prime denotes derivation with respect to the conformal time η and

30
2
The Universe in Expansion
H ≡a′
a
(2.54)
is the conformal Hubble factor.
In the Friedmann and acceleration equations, ρ and P are the total density and
pressure. Hence, they can be written as sums of the contributions of the individual
components:
ρ ≡

x
ρx ,
P ≡

x
Px .
(2.55)
The contribution from the cosmological constant can be considered either geomet-
rically or as a matter component with the following density and pressure:
ρ ≡c2
8πG ,
P ≡−ρc2 .
(2.56)
The scale factor a is, by deﬁnition, positive, but its derivative can be negative. This
would represent a contracting universe. Note that the left hand side of the Friedmann
equation (2.50) is non-negative. Therefore, ˙a can vanish only if K > 0, i.e. for a
spatially closed universe. This implies that, if K ⩽0 and if there exists an instant
for which ˙a > 0, then the universe will expand forever.
2.3.1
The Hubble Constant and the Deceleration Parameter
When the Hubble parameter H is evaluated at the present time t0, it becomes a
number: the Hubble constant H0 which we already met in Chap.1 in the Hubble’s
law (1.1). Its value is
H0 = 67.74 ± 0.46 km s−1 Mpc−1 ,
(2.57)
at the 68% conﬁdence level, as reported by the Planck group (Ade et al. 2016).
Usually H0 is conveniently written as
H0 = 100 h km s−1 Mpc−1 .
(2.58)
The unit of measure of the Hubble constant is an inverse time:
H0 = 3.24 h × 10−18 s−1 ,
(2.59)
whose inverse gives the order of magnitude of the age of the universe:

2.3 Friedmann Equations
31
1
H0
= 3.09 h−1 × 1017 s = 9.78 h−1 Gyr ,
(2.60)
and multiplied by c gives the order of magnitude of the size of the visible universe,
i.e. the Hubble radius that we have already seen in Eq.(2.28) but evaluated at the
present time t = t0:
c
H0
= 9.27 h−1 × 1025 m = 3.00 h−1 Gpc .
(2.61)
But what does “present time” t0 mean? Time ﬂows, therefore t0 cannot be a constant!
That is true, but if we compare a time span of 100 years (the span of some human
lives) to the age of the universe (about 14 billion years), we see that the ratio is about
10−8. Since this is pretty small, we can consider t0 to be a constant, also referred to
as the age of the universe.3 We can calculate it as follows:
t0 =
 t0
0
dt =
 1
0
da
˙a =
 1
0
da
H(a)a =
 ∞
0
dz
H(z)(1 + z) .
(2.62)
Exercise 2.11 Prove the last equality of Eq.(2.62).
The integration limits of Eq.(2.62) deserve some explanation. We assumed that
a(t = 0) = 0, i.e. the Big Bang. This condition is not always true, since there are
models of the universe, e.g. the de Sitter universe, for which a vanishes only when
t →−∞. The other assumption is that a(t0) = 1. This is a pure normalisation, done
for convenience, which is allowed by the fact that the dynamics is invariant if we
multiply the scale factor by a constant.
Recall that, in cosmology, when a quantity has subscript 0, it usually means that
it is evaluated at t = t0.
The Deceleration Parameter
Let us focus now on Eq.(2.51). It contains ¨a, so it describes how the expansion of the
universe is accelerating. The key-point is that if the right hand side of Eq.(2.51) is
positive, i.e. ρ + 3P/c2 < 0, then ¨a > 0. There exists a parameter, named deceler-
ation parameter, with which to measure the entity of the acceleration. It is deﬁned
as follows:
q ≡−¨aa
˙a2
(2.63)
3Pretty much the same happens with the redshift. A certain source has redshift z which, actually, is
not a constant but varies slowly. This is called redshift drift and it was ﬁrst considered by Sandage
(1962) and McVittie (1962). Applications of the redshift drift phenomenon to gravitational lensing
are proposed in Piattella and Giani (2017).

32
2
The Universe in Expansion
In Riess et al. (1998) and Perlmutter et al. (1999) analysis based on type Ia supernovae
observation have shown that q0 < 0, i.e. the deceleration parameter is negative and
therefore the universe is in a state of accelerated expansion. We perform a similar
but simpliﬁed analysis in Sect.11.1 in order to illustrate how data in cosmology are
analysed.
2.3.2
Critical Density and Density Parameters
Let us now rewrite Eq.(2.50) incorporating  in the total density ρ:
H 2 = 8πGρ
3
−Kc2
a2
.
(2.64)
The value of the total ρ such that K = 0 is called critical energy density and has
the following form:
ρcr ≡3H 2
8πG
(2.65)
Its present value (Ade et al. 2016) is:
ρcr,0 = 1.878 h2 × 10−29 g cm−3
(2.66)
It turns out that ρ0 is very close to ρcr,0, so that our universe is spatially ﬂat. Such an
extreme ﬁne-tuning in K is a really surprising coincidence, known as the ﬂatness
problem. A possible solution is provided by the inﬂationary theory which we shall
see in detail in Chap.8.
Instead of densities, it is very common and useful to employ the density parameter
, which is deﬁned as
 ≡ρ
ρcr
= 8πGρ
3H 2
(2.67)
i.e. the energy density normalised to the critical one. We can then rewrite Friedmann
equation (2.50) as follows:
1 =  −Kc2
H 2a2 .
(2.68)
Deﬁning
K ≡−Kc2
H 2a2 ,
(2.69)
i.e. associating the energy density

2.3 Friedmann Equations
33
ρK ≡−3Kc2
8πGa2 ,
(2.70)
to the spatial curvature, we can recast Eq.(2.68) in the following simple form:
1 =  + K .
(2.71)
Therefore, the sum of all the density parameters, the curvature one included, is always
equal to unity. In particular, if it turns out that  ≃1, this implies that K ≃0, i.e.
the universe is spatially ﬂat. From the latest Planck data (Ade et al. 2016) we know
that:
K0 = 0.0008+0.0040
−0.0039
(2.72)
at the 95% conﬁdence level.
It is more widespread in the literature the normalisation of ρ to the present-time
critical density, i.e.
 ≡
ρ
ρcr,0
= 8πGρ
3H 2
0
(2.73)
because it leaves more evident the dependence on a of each material component.
With this deﬁnition of , Friedmann equation (2.50) is written as:
H 2
H 2
0
=

x
x0 fx(a) + K0
a2
,
(2.74)
where fx(a) is a function which gives the a-dependence of the material component
x and fx(a0 = 1) = 1. Consistently:

x
x0 + K0 = 1
(2.75)
also known as closure relation. We shall use the deﬁnition x ≡ρx/ρcr,0 throughout
these notes.
2.3.3
The Energy Conservation Equation
The energy conservation equation
∇νT μν = 0
(2.76)

34
2
The Universe in Expansion
is encapsulated in GR through the Bianchi identities. Therefore, it is not independent
from the Friedmann equations (2.50) and (2.51). For the FLRW metric and a perfect
ﬂuid, it has a particularly simple form:
˙ρ + 3H

ρ + P
c2

= 0
(2.77)
This is the μ = 0 component of ∇νT μν = 0 and it is also known from ﬂuid dynamics
as continuity equation.
Exercise 2.12 Derive the continuity equation (2.77) by combining Friedmann and
acceleration equations (2.50) and (2.51). Derive it in a second way by explicitly
calculating the four-divergence of the energy-momentum tensor.
The continuity equation can be analytically solved if we assume an equation of state
of the form P = wρc2, with w constant. The general solution is:
ρ = ρ0a−3(1+w)
(w = constant) ,
(2.78)
where ρ0 ≡ρ(a0 = 1).
Exercise 2.13 Prove the above result of Eq.(2.78).
There are three particular values of w which play a major role in cosmology:
Cold matter: w = 0, i.e. P = 0, for which ρ = ρ0a−3. As we have discussed in
Chap.1, the adjective cold refers to the fact that particles making up this kind of
matter have a kinetic energy much smaller than the mass energy, i.e. they are non-
relativistic. If they are thermally produced, i.e. if they were in thermal equilibrium
with the primordial plasma, they have a mass much larger than the temperature of
the thermal bath. We shall see this characteristic in more detail in Chap.3.
Cold matter is also called dust and it encompasses all the non-relativistic known
elementary particles, which are overall dubbed baryons in the jargon of cosmology.
If they exist, unknown non-relativistic particles are called cold dark matter (CDM).
Hot matter: w = 1/3, i.e. P = ρ/3, for which ρ = ρ0a−4. The adjective hot refers
to the fact that particles making up this kind of matter are relativistic.

2.3 Friedmann Equations
35
For this reason they are known, in the jargon of cosmology, as radiation and
they encompass not only the relativistic known elementary particles, but possibly the
unknown ones (i.e. hot dark matter). The primordial neutrino background belonged
to this class, but since neutrino seems to have a mass of approximately 0.1eV, it is
now cold. We shall see why in Chap.3.
Vacuum energy: w = −1, i.e. P = −ρc2 and ρ is a constant. It behaves as the
cosmological constant and provides the best (and the simplest) description that we
have for dark energy, though plagued by the serious issues that we have presented in
Chap.1.
2.3.4
The ΛCDM Model
ThemostsuccessfulcosmologicalmodeliscalledCDMandismadeupof,CDM,
baryons and radiation (photons and massless neutrinos). The Friedmann equation for
the CDM model is the following:
H 2
H 2
0
=  + c0
a3 + b0
a3 + r0
a4 + K0
a2
.
(2.79)
We already saw in Eq.(2.72) the value of the spatial curvature contribution. From
Ade et al. (2016) here are the other ones:
 = 0.6911 ± 0.0062 ,
m0 = 0.3089 ± 0.0062
(2.80)
at 68% conﬁdence level, where m0 = c0 + b0, i.e. it includes the contributions
from both CDM and baryons, since they have the same dynamics (i.e. they are both
cold). It is however possible to disentangle them and one observes:
b0h2 = 0.02230 ± 0.00014 ,
c0h2 = 0.1188 ± 0.0010
(2.81)
also at 68% conﬁdence level. The radiation content, i.e. photons plus neutrinos, can
be easily calculated from the temperature of the CMB, as we shall see in Chap.3. It
turns out that:
γ0h2 ≈2.47 × 10−5 ,
ν0h2 ≈1.68 × 10−5
(2.82)
Since h = 0.68, and recalling the closure relation of Eq.(2.75), we can conclude that
today 69% of our universe is made of cosmological constant, 26% of CDM and 5%
of baryons. Radiation and spatial curvature are negligible. That is, the situation is
pretty obscure, in all senses.

36
2
The Universe in Expansion
Fig. 2.4 Dimensionless age of the universe H0t0 as function of  (keeping ﬁxed the matter and
radiation content) and as function of m0 (keeping ﬁxed the radiation content and with no )
Let us now calculate the age of the universe for the CDM model. Using
Eq.(2.62), we get:
t0 = 1
H0
 1
0
da
a

a4 + m0a + r0 + K0a2 .
(2.83)
Using the numbers shown insofar, we get upon numerical integration:
t0 = 0.95
H0
= 13.73 Gyr
(2.84)
The value reported by Ade et al. (2016) is 13.799 ± 0.021 at 68% conﬁdence level.
Note how H0t0 ≈1. This fact has been dubbed synchronicity problem by Avelino
and Kirshner (2016). In Fig.2.4 we plot the dimensionless age of the universe H0t0
for models with or without  and in Fig.2.5 we plot the evolution of H0t as function
of a in order to show indeed how H0t0 ≈1 is quite a peculiar instant of the history
of the universe.
As one can see, in presence of  the dimensionless age of the universe reaches
values larger than unity. This, mathematically, is due to the a4 factor multiplying 
in Eq.(2.83). Note that we can obtain the observed value H0t0 ≈0.95 also in absence
of a cosmological constant and for a curvature-dominated universe, i.e. K0 ≈0.97.

2.4 Solutions of the Friedmann Equations
37
Fig. 2.5 Dimensionless age of the universe H0t as function of a for the CDM model (solid line)
and in a model made only of CDM (dashed line)
2.4
Solutions of the Friedmann Equations
The Friedmann equations can be solved exactly for many cases of interest.
2.4.1
The Einstein Static Universe
As the ﬁrst application of his theory to cosmology, Einstein was looking for a static
universe, since at his time there was not yet compelling evidence of the contrary.
Therefore, we must set ˙a = ¨a = 0. Since ρ is positive, we must have K = 1, therefore
the Einstein Static Universe (ESU) is a closed universe. Its radius is:
8πG
3
ρ = c2
a2
⇒
a =

3c2
8πGρ .
(2.85)
From the acceleration equation we get that
ρ + 3P/c2 = 0 ,
(2.86)
thereforewecannothavesimplyordinarymatterbecauseweneedanegativepressure.
Here enters the cosmological constant . We assume that ρ = ρm + ρ, so that

38
2
The Universe in Expansion
ρ + 3P/c2 = 0 ,
⇒
ρm + ρ −3ρ = 0 ,
(2.87)
and therefore ρm = 2ρ. The radius can thus be written as
a =
c
√4πGρm
=
1
√

.
(2.88)
Until here all seems to be ﬁne. But it is not. The problem is indeed the condition
ρm = 2ρ, which makes the ESU unstable. In fact, if this condition is broken, say
ρm/ρ = 2 + ϵ, then the universe expands or collapses, depending on the sign of ϵ.
Exercise 2.14 Prove that the ESU is unstable. Hint: use ρm/ρ = 2 + ϵ in the
Friedmann and acceleration equations.
2.4.2
The de Sitter Universe
For ρ = 0, the Friedmann equation (2.50) becomes:
H 2 = c2
3
−Kc2
a2
.
(2.89)
When spatial curvature is taken into account, it is more convenient to solve the
acceleration equation (2.51) rather than Friedmann equation. Indeed:
¨a = c2
3 a ,
(2.90)
is straightforwardly integrated:
a(t) = C1 exp
	

3 ct

+ C2 exp

−
	

3 ct

,
(2.91)
where C1 and C2 are two integration constants. One of these is constrained by Fried-
mann equation (2.89). Calculating ˙a2 and a2 from Eq.(2.91) we get:
˙a2 = c2
3

C2
1 exp

2
	

3 ct

+ C2
2 exp

−2
	

3 ct

−2C1C2

,
(2.92)
a2 = C2
1 exp

2
	

3 ct

+ C2
2 exp

−2
	

3 ct

+ 2C1C2 . (2.93)

2.4 Solutions of the Friedmann Equations
39
Combining them, one ﬁnds:
˙a2 = c2
3 (a2 −4C1C2) .
(2.94)
Using Eq.(2.89), we can put a constraint on the product of the two integration con-
stants:
4
3 C1C2 = K ,
(2.95)
so that we have freedom to ﬁx just one of them. Assuming that C1 ̸= 0, we can write
the general solution as:
a(t) = C1 exp
	

3 ct

+
3K
4C1
exp

−
	

3 ct

.
(2.96)
When K = ±1 we can set C1 such that we can write the solution as follows:
a(t) =
⎧
⎪⎨
⎪⎩
√3/ sinh
√/3ct

,
for K = −1 ,
a0 exp
√/3ct

,
for K = 0 ,
√3/ cosh
√/3ct

,
for K = 1 .
(2.97)
where a0 is some initial t = 0 scale factor. Note that there is no a0 for the solutions
with spatial curvature because we ﬁxed the integration constant in order to have the
hyperbolic sine and cosine.
Exercise 2.15 From the Einstein equations (2.43) show that R = 4 for the de
Sitter universe. Verify that the above solutions (2.96) and (2.97) satisfy this relation
by substituting them into the expression in Eq.(2.45) for the Ricci scalar.
The de Sitter universe (de Sitter 1917, 1918a,b,c) is eternal with no Big-Bang
(i.e. when a = 0) for K = 1. Here we have rather a bounce at the minimum value
a0 for the scale factor. For K = 0 there is a Big-Bang at t = −∞. For K = −1
we might have negative scale factors, which we however neglect and consider the
evolution as starting only at t = 0, for which there is another Big-Bang. Note that
the Big-Bang’s we are mentioning here are not singularities. There is no physical
singularity in the de Sitter space, since it is maximally symmetric.
The deceleration parameter is the following
q = −¨aa
˙a2 = −c2
3
a2
˙a2 = −

1 −3K
a2
−1
,
(2.98)
i.e. always negative.

40
2
The Universe in Expansion
2.4.3
Radiation-Dominated Universe
For ρ = ρ0a−4, K = 0 and  = 0, the solution of Eq.(2.50) is:
a =
	 t
t0
,
(2.99)
The deceleration parameter is q0 = 1 and the age of the universe is:
t0 =
1
2H0
.
(2.100)
Exercise 2.16 Prove the results of Eqs.(2.99) and (2.100).
It is quite complicated to analytically solve Friedmann equation (2.50) for a
radiation-dominated universe when K ̸= 0. On the other hand, solving the accel-
eration equation (2.53) is much easier. For ρc2 = 3P, Eq.(2.53) becomes:
a′′ + Kc2a = 0 ,
(2.101)
whose general solution is:
a(η) =
⎧
⎪⎨
⎪⎩
C1 exp(cη) + C2 exp(−cη) ,
for K = −1 ,
C3 + C4η ,
for K = 0 ,
C5 sin(cη) + C6 cos(cη) ,
for K = 1 .
(2.102)
First of all, we can choose a(0) = 0. Thus, the general solution (2.102) becomes:
a(η) =
⎧
⎪⎨
⎪⎩
2C1 sinh(cη) ,
for K = −1 ,
C4η ,
for K = 0 ,
C5 sin(cη) ,
for K = 1 .
(2.103)
Second, these solutions are subject to the constraint of Friedmann equation (2.52),
written of course in the radiation-dominated case:
a′2 = 8πG
3
ρa4 −Kc2a2 ,
(2.104)
where notice that ρa4 = ρ0, i.e. a constant. When a = 0, i.e. η = 0, then
a′2(η = 0) = 8πG
3
ρ0 ≡a2
mc2 ,
(2.105)

2.4 Solutions of the Friedmann Equations
41
and the solutions (2.103) become:
a(η) = am
⎧
⎪⎨
⎪⎩
sinh(cη) ,
for K = −1 ,
cη ,
for K = 0 ,
sin(cη) ,
for K = 1 .
(2.106)
If we want to recover the cosmic time from the above solutions, we need to solve the
following integration:
 η
0
a(η′)dη′ = t .
(2.107)
Using Eq.(2.106), one obtains:
ct = am
⎧
⎪⎨
⎪⎩
cosh(cη) −1 ,
for K = −1 ,
(cη)2/2 ,
for K = 0 ,
1 −cos(cη) ,
for K = 1 .
(2.108)
Inverting these relations allows you to ﬁnd η = η(t), which once substituted in
Eq.(2.106) allows to ﬁnd a = a(t).
Exercise 2.17 Using the solutions (2.108), ﬁnd the explicit form of a(t). Show that
ct = amη2/2 leads to Eq.(2.99).
2.4.4
Cold Matter-Dominated Universe
For ρ = ρ0a−3, K = 0 and  = 0, the solution of Friedmann equation (2.50) is
straightforwardly obtained:
a =
 t
t0
2/3
.
(2.109)
The deceleration parameter is q0 = 1/2 and the age of the universe is:
t0 =
2
3H0
= 6.52 h−1 Gyr .
(2.110)
This model of universe is also known as the Einstein-de Sitter universe. A part
the fact that it does not predict any accelerated expansion, there are also problems
with the age of the universe given in Eq.(2.110): it is smaller than the one of some
globular clusters (Velten et al. 2014).

42
2
The Universe in Expansion
Exercise 2.18 Prove the results of Eqs.(2.109) and (2.110).
Worse than the radiation-dominated case, it is impossible to analytically solve Fried-
mann equation (2.50) for a dust-dominated universe when K ̸= 0. But, as in the
radiation-dominated case, it is possible to ﬁnd an exact solution for a(η). Let’s write
Eq.(2.53) for the dust-dominated case:
a′′ = 4πG
3
ρa3 −Kc2a .
(2.111)
Note that ρa3 = ρ0 = constant. The general solution is therefore the general solution
of Eq.(2.101) plus a particular solution of Eq.(2.111), that is:
a(η) =
⎧
⎪⎨
⎪⎩
C1 sinh(cη) + C2 cosh(cη) −4πG
3c2 ρ0 ,
for K = −1 ,
C3 + C4η + 2πG
3 ρ0η2 ,
for K = 0 ,
C5 sin(cη) + C6 cos(cη) + 4πG
3c2 ρ0 ,
for K = 1 .
(2.112)
Exercise 2.19 Using the condition a(0) = 0 and employing Friedmann equation for
a dust-dominated universe, i.e.
a′2 + Kc2a2 = 8πG
3
ρa4 ,
(2.113)
as constraint, show that Eq.(2.112) can be cast as:
a(η) = 4πG
3c2 ρ0
⎧
⎪⎨
⎪⎩
cosh(cη) −1 ,
for K = −1 ,
(cη)2/2 ,
for K = 0 ,
1 −cos(cη) ,
for K = 1 .
(2.114)
Recovering the cosmic time from Eq.(2.114) one has:
ct = 4πG
3c2 ρ0
⎧
⎪⎨
⎪⎩
sinh(cη) −cη ,
for K = −1 ,
(cη)3/6 ,
for K = 0 ,
cη −sin(cη) ,
for K = 1 .
(2.115)
Unfortunately, the above relations for K = ±1 cannot be explicitly inverted in order
to give η(t) and then a(t).

2.4 Solutions of the Friedmann Equations
43
2.4.5
Radiation Plus Dust Universe
The mixture of radiation plus matter is a cosmological model closer to reality and
with which we can describe the evolution of our universe on a larger timespan than
the single component-dominated cases. Consider the total density:
ρ = ρm + ρr = ρeq
2
a3
eq
a3 + ρeq
2
a4
eq
a4 ,
(2.116)
where aeq is the equivalence scale factor, i.e. the scale factor evaluated at the time at
which dust and radiation densities were equal. At this time, we dub the total density
as ρeq. Now write down the acceleration equation (2.53) for the dust plus radiation
model:
a′′ = 4πG
3
ρma3 −Kc2a .
(2.117)
It is identical to the dust-dominated case, viz. Eq.(2.111)! Indeed, the fact that radi-
ation is also present will enter when we set the constraint from Friedmann equation,
which is the following:
a′2 + Kc2a2 = 4πGρeq
3

a3
eqa + a4
eq

.
(2.118)
Solving Eq.(2.117) with the condition a(0) = 0 leads to the following solutions:
a(η) =
2πGρeqa3
eq
3c2
⎧
⎪⎨
⎪⎩
C1 sinh(cη) + cosh(cη) −1 ,
for K = −1 ,
C2η + (cη)2/2 ,
for K = 0 ,
C3 sin(cη) + 1 −cos(cη) ,
for K = 1 .
(2.119)
Now use the constraint from Friedmann equation, i.e.
a′2(η = 0) = 4πGρeq
3
a4
eq ,
(2.120)
and ﬁnd that:
C1 = C3 = c

3
πGρeqa2eq
≡c ˜η ,
C2 = c2 ˜η ,
(2.121)
so that:
a(η) = 2aeq
c2 ˜η2
⎧
⎪⎨
⎪⎩
c ˜η sinh(cη) + cosh(cη) −1 ,
for K = −1 ,
c2 ˜ηη + (cη)2/2 ,
for K = 0 ,
c ˜η sin(cη) + 1 −cos(cη) ,
for K = 1 .
(2.122)

44
2
The Universe in Expansion
In particular, the solution for K = 0 is:
a(η) = aeq

2η
˜η + η2
˜η2

.
(2.123)
Exercise 2.20 Show that the conformal time at equivalence ηeq and ˜η are related by:
ηeq = (
√
2 −1) ˜η .
(2.124)
Exercise 2.21 SolveFriedmannequationfortheCDMmodel,neglectingradiation
and spatial curvature:
H 2
H 2
0
= m0
a3 +  .
(2.125)
Show that:
a(t) =
m0

sinh2
3
2

H0t
1/3
.
(2.126)
Exercise 2.22 Solve the Friedmann equation for the curvature-dominated universe:
H 2 = −Kc2
a2
.
(2.127)
This is the Milne model (Milne 1935). Clearly, only K = −1 is allowed.
Show then that a = ct. Substitute this solution into the expression for the Ricci
scalar (2.45). Show that R = 0.
Write down explicitly the FLRW metric with a = ct and show that it is Minkowski
metric written in a coordinate systems different from the usual.
The above last result is not completely surprising, since Milne model has no
matter (empty universe) and no cosmological constant. The spatial hypersurfaces
are already maximally symmetric because of the cosmological principle and the
absence of matter add even more symmetry to the spacetime.
2.5
Distances in Cosmology
We present and discuss in this section the various notions of distance that are
employed in cosmology. See e.g. Hogg (1999) for a reference on the subject.

2.5 Distances in Cosmology
45
2.5.1
Comoving Distance and Proper Distance
We have already encountered comoving coordinates in the FLRW metric (2.17) and
the proper radius D(t) ≡a(t)r in the FLRW metric (2.21). We must be clearer about
the difference between the radial coordinate and the distance. They are equal only
when d = 0. The comoving square inﬁnitesimal distance is indeed, from FLRW
metric (2.17) the following:
dχ2 =
dr2
1 −Kr2 + r2d2 ,
(2.128)
i.e. it has indeed a radial part, but also has a transversal part. So, if χ is the comoving
distance between two points, the proper distance at a certain time t is d(χ, t) = a(t)χ.
The comoving distance is a notion of distance which does not include the expan-
sion of the universe and thus does not depend on time.
The proper distance is the distance that would be measured instantaneously by
rulers. For example, imagine to extend a ruler between GN-z11 (the farthest known
galaxy, z = 11.09) and us. Our reading at the time t would be the proper distance at
that time.
Suppose that d = 0. Then the comoving distance to an object with radial coor-
dinate r is the following:
χ =
 r
0
dr′
√
1 −Kr
′2 =
⎧
⎪⎨
⎪⎩
arcsin r , for K = 1 ,
r , for K = 0 ,
arcsinh r , for K = −1 .
(2.129)
Deriving d with respect to the time one gets:
˙d = ˙aχ = ˙a
a d = Hd ,
(2.130)
which recovers the Hubble’s law for t = t0.
2.5.2
The Lookback Time
Imagine a photon emitted by a galaxy at a time tem and detected at the time t0 on
Earth. A very basic notion of distance is c(t0 −tem), i.e. it is the light-travel distance,
based on the fact that light always travels with speed c. The quantity t0 −tem is called
lookback time and suggestively reminds the fact that when we observe some source
in the sky we are actually looking into the past, because of the ﬁniteness of c.
From the FLRW metric, by putting ds2 = 0, we can relate the lookback time with
the comoving distance as follows:

46
2
The Universe in Expansion
cdt = a(t)dχ .
(2.131)
This seems quite similar to the proper distance, but careful: the proper distance is
deﬁned as aχ and evidently adχ ̸= d(aχ). The lookback time is the photon time of
ﬂight and thus it includes cumulatively the expansion of the universe. On the other
hand, the proper distance is the distance considered between two simultaneous events
and therefore the expansion of the universe is not taken into account cumulatively.
Since we observe redshifts, is there a way to calculate the lookback time from
z? In principle yes: one solves Friedmann equation, ﬁnds a(t), inverts this function
in order to ﬁnd t = t(a), uses 1 + z = 1/a and ﬁnally gets a relation t = t(z). For
example, for the ﬂat Einstein-de Sitter universe, using Eqs.(2.109) and (2.110) one
gets:
1 + z =

2
3H0t
2/3
⇒
t =
2
3H0(1 + z)3/2 .
(2.132)
This approach is model-dependent because in order to solve the Friedmann equation
we must know it and this is possible only if we know, or model, the energy content
of the universe. Hence the model-dependence.
A model-independent way of relating lookback time and redshift is cosmography,
a word which means “measuring the universe”. In practice, cosmography consists in
a Taylor expansion of the scale factor about its today value:
a(t) = a(t0) + da
dt

t0
(t −t0) + 1
2
d2a
dt2

t0
(t −t0)2 + · · ·
(2.133)
where we stop at the second order, for simplicity. This can be written as
a(t) = a(t0)

1 + H0(t −t0) −1
2q0H 2
0 (t −t0)2 + · · ·

,
(2.134)
i.e. the ﬁrst coefﬁcient of the expansion is the Hubble constant, whereas the second
one is proportional to the deceleration parameter. The third is usually called jerk and
the fourth snap. All these parameters are evaluated at t0 in the above expansion.
Exercise 2.23 For a(t0) = 1 and introducing the redshift show that:
z ∼H0(t0 −t) + 1
2(q0 + 2)H 2
0 (t0 −t)2 .
(2.135)
Here is a direct, model-independent relation between the redshift and the lookback
time (t0 −t).

2.5 Distances in Cosmology
47
2.5.3
Distances and Horizons
For a photon, not unexpectedly,
dχ = cdt
a(t) = cdη ,
(2.136)
i.e. the comoving distance is equal to the conformal time, which we introduced in
Eq.(2.18). We might say that the comoving distance is a lookback conformal time.
By integrating cdt/a(t) from tem to t0 we get the comoving distance from the
source to us, or the conformal time spent by the photon travelling from the source to
us:
χ =
 t0
tem
cdt′
a(t′) =
 1
a
cda′
H(a′)a
′2 .
(2.137)
For the dust-dominated case one has H = H0/a3/2 and the comoving distance as a
function of the scale factor and of the redshift is:
χ(a) = c
H0
 1
a
da′
√
a′ = 2c
H0

1 −√a

,
χ(z) = 2c
H0

1 −
1
√1 + z

.
(2.138)
When z →0, χ ∼cz/H0. Comparing with Eq.(2.135) one sees that, at the ﬁrst order
in the redshift, the lookback time distance is equivalent to the comoving one.
Exercise 2.24 Calculate the comoving distance as a function of the scale factor and
of the redshift for a radiation-dominated universe and for the de Sitter universe.
When the lower integration limit in Eq.(2.137) is a = 0, i.e. the Big Bang, one
deﬁnes the comoving horizon χp (also known as particle horizon or cosmological
horizon). This is the conformal time spent from the Big Bang until the cosmic time
t or scale factor a. It is also the maximum comoving distance travelled by a photon
(hence the name particle horizon) since the Big Bang and so it is the comoving size
of the visible universe.
In the dust-dominated case, using Eq.(2.138), with a = 0 or z = ∞one obtains:
χp = cη0 = 2c
H0
.
(2.139)
Note that this is not the age of the universe given in Eq.(2.110), but three times its
value.
When the upper integration limit of Eq.(2.137) is inﬁnite, one deﬁnes the event
horizon:
χe(t) ≡c
 ∞
t
dt′
a(t′) = c
 ∞
a
da′
H(a′)a
′2 ,
(2.140)

48
2
The Universe in Expansion
which of course makes sense only if the universe does not collapse. This represents
the maximum distance travelled by a photon from a time t. If it diverges, then no
event horizon exists and therefore eventually all the events in the universe will be
causally connected. This happens, for example, in the dust-dominated case:
χe = c
H0
 ∞
a
da′
√
a′ = ∞.
(2.141)
But, in the de Sitter universe we have
χe = c
H0
 ∞
a
da′
a
′2 =
c
H0a .
(2.142)
The proper event horizon for the de Sitter universe is a constant:
aχe = c
H0
.
(2.143)
2.5.4
The Luminosity Distance
The luminosity distance is a very important notion of distance for observation. It is
based on the knowledge of the intrinsic luminosity L of a source, which is therefore
called standard candle. Type Ia supernovae are standard candles, for example. Then,
measuring the ﬂux F of that source and dividing L by F, one obtains the square
luminosity distance:
d2
L ∝L
F .
(2.144)
Now, imagine a source at a certain redshift z with intrinsic luminosity L = dE/dt.
The observed ﬂux is given by the following formula:
F = dE0
dt0 A0
,
(2.145)
where A0 is the area of the surface on which the radiation is spread:
A0 = 4πa2
0χ2 ,
(2.146)
i.e. over a sphere with the proper distance as the radius. We must use the proper
distance, because this is the instantaneous distance between source and observer at
the time of detection. Note that χ is the comoving distance between the source and
us.
We do not observe the same photon energy as the one emitted, because photons
suffer from the cosmological redshift, thus:

2.5 Distances in Cosmology
49
dE
dE0
= a0
a .
(2.147)
Finally, the time interval used at the source is also different from the one used at the
observer location:
dt
dt0
= a
a0
.
(2.148)
We can easily show this by using FLRW metric with ds2 = 0, i.e. cdt = a(t)dχ.
Considerthesamedχatthesourceandattheobserver’slocation.Thus,cdt = a(t)dχ
and cdt0 = a(t0)dχ and the above result follows.
Putting all the contributions together, we get
F = dE0
dt0 A0
=
a2dE
a2
0dt4πa2
0χ2 =
dE
dt4πa2
0χ2(1 + z)2 .
(2.149)
Hence, the luminosity distance is deﬁned as:
dL ≡a0(1 + z)χ
(2.150)
From this formula and the observed redshifts of type Ia supernovae we can determine
if the universe is in an accelerated expansion, in a model-independent way. In order
to do this, we ﬁrst need to know how to expand χ in series of powers of the redshift.
Using the deﬁnition (2.137) and the expansion (2.135), we get:
χ =
 t0
t
cdt′
a(t′) = c(t0 −t)
a0
+ cH0
2a0
(t0 −t)2 + · · ·
(2.151)
wherewestopatthesecondorderonly.Thisistheexpansionofthecomovingdistance
with respect to the lookback time. We must invert the power series of Eq.(2.135) in
order to ﬁnd the expansion of the lookback time with respect to the redshift. This
can be done, for example, by assuming the following ansatz:
H0(t0 −t) = α + βz + γz2 + · · ·
(2.152)
and substitute it into Eq.(2.135), keeping at most terms O(z2).
Exercise 2.25 Show that:
α = 0 ,
β = 1 ,
γ = −1
2(q0 + 2) ,
(2.153)
and thus
H0(t0 −t) = z −1
2(q0 + 2)z2 + · · ·
(2.154)

50
2
The Universe in Expansion
Substituting the expansion of Eq.(2.154) back into Eq.(2.150), one gets
dL = c
H0

z + 1
2(1 −q0)z2 + · · ·

,
(2.155)
where note again that at the lowest order the luminosity distance is cz/H0, identical
to the comoving distance and to the lookback time distance.
Since dL and z are measured, one can ﬁt the data with this quadratic function and
determine q0, thereby establishing if the universe expansion is accelerated or not.
Note that H0 is an overall multiplicative factor, thus does not determine the shape of
the function dL(z).
Inthecaseofadust-dominateduniverse,usingEq.(2.138),theluminositydistance
has the following expression:
dL = 2c
H0

1 + z −
√
1 + z

.
(2.156)
For small z, this distance can be expanded in powers of the redshift as:
dL = c
H0

z + 1
4z2 + · · ·

,
(2.157)
which, when compared with Eq.(2.150), provides q0 = 1/2, as expected.
2.5.5
Angular Diameter Distance
The angular diameter distance is based on the knowledge of proper sizes. Objects
with a known proper size are called standard rulers. Suppose a standard ruler of
transversal proper size ds (small) to be at a redshift z and comoving distance χ.
Moreover, this object has an angular dimension dφ, also small. See Fig.2.6 for
reference.
At a ﬁxed time t, we can write the FLRW metric as:
ds2 = a(t)2dχ2 .
(2.158)
Fig. 2.6 Deﬁning the
angular diameter distance

2.5 Distances in Cosmology
51
Since the object is small and we are at the origin of the reference frame, the comoving
distance χ is also the radial distance. Therefore, the transversal distance is:
ds = a(t)χdφ .
(2.159)
Dividing the proper dimension of the object by its angular size provides us with the
angular diameter distance:
dA = a(t)χ .
(2.160)
For the case of a dust-dominated universe, one has:
dA = 2c
H0

1
1 + z −
1
(1 + z)3/2

.
(2.161)
In the limit of small z, we ﬁnd dA ∼cz/H0. All the distances that we deﬁned insofar
coincide at the ﬁrst order expansion in z.
Note the relation:
dL = (1 + z)2dA ,
(2.162)
known as Etherington’s distance duality (Etherington 1933).
In gravitational lensing applications it is often necessary to know the angular-
diameter distance between two sources at different redshifts (i.e. the angular-diameter
distance between the lens and the background source). In order to compute this, let
us refer to Fig.2.7.
The problem is to determine the angular-diameter distance between L and S,
say dA(LS). Is this the difference between the angular-diameter distances dA(S) −
dA(L)? We now show that this is not the case. Simple trigonometry is sufﬁcient to
establish that:
ds = a(tS)χSdφS = a(tS)χLSdφL ,
(2.163)
And for comoving distances we do have that χLS = χS −χL. Therefore, we have
dA(LS) = a(tS)χLS = a(tS)(χS −χL)
(2.164)
Fig. 2.7 The angular
diameter distance between
two different redshifts

52
2
The Universe in Expansion
which is the relation we were looking for, and it is different from the difference
between the angular diameter distances:
dA(S) −dA(L) = a(tS)χS −a(tL)χL .
(2.165)
References
Ade, P.A.R., et al.: Planck 2015 results. XIII. Cosmological parameters. Astron. Astrophys. 594,
A13 (2016)
Avelino, A., Kirshner, R.P.: The dimensionless age of the universe: a riddle for our time. Astrophys.
J. 828(1), 35 (2016)
Baqui, P.O., Fabris, J.C., Piattella, O.F.: Cosmology and stellar equilibrium using Newtonian hydro-
dynamics with general relativistic pressure. JCAP 1604(04), 034 (2016)
Bonometto, S.: Cosmologia & Cosmologie. Zanichelli (2008)
de Sitter, W.: On the relativity of inertia. Remarks concerning Einstein’s latest hypothesis. Konin-
klijke Nederlandsche Akademie van Wetenschappen Proceedings 19, 1217–1225 (1917)
de Sitter, W.: Einstein’s theory of gravitation and its astronomical consequences. Third paper. Mon.
Not. R. Astron. Soc. 78, 3–28 (1918a)
de Sitter, W.: Further remarks on the solutions of the ﬁeld-equations of the Einstein’s theory of
gravitation. Koninklijke Nederlandsche Akademie van Wetenschappen Proceedings 20, 1309–
1312 (1918b)
de Sitter, W.: On the curvature of space. Koninklijke Nederlandsche Akademie van Wetenschappen
Proceedings 20, 229–243 (1918c)
Etherington, I.M.H.: On the deﬁnition of distance in general relativity. Philos. Mag. 15 (1933)
Fabris, J.C., Velten, H.: Neo-Newtonian cosmology: an intermediate step towards general relativity.
RBEF 4302 (2012)
Friedmann, A.: Ueber die Kruemmung des Raumes. Z. Phys. 10, 377–386 (1922)
Friedmann, A.: Ueber die Moeglichkeit einer Welt mit konstanter negativer Kruemmung des
Raumes. Z. Phys. 21, 326–332 (1924)
Giblin, J.T., Mertens, J.B., Starkman, G.D.: Observable deviations from homogeneity in an inho-
mogeneous universe. Astrophys. J. 833(2), 247 (2016)
Harrison, E.R.: Cosmology without general relativity. Ann. Phys. 35, 437–446 (1965)
Hogg, D.W.: Distance measures in cosmology (1999)
Hwang, J.-C., Noh, H.: Newtonian hydrodynamics with general relativistic pressure. JCAP 1310,
054 (2013)
Lemaitre, G.: The expanding universe. Mon. Not. R. Astron. Soc. 91, 490–501 (1931)
Lemaître, G.: The expanding universe. Gen. Rel. Gravit. 29, 641–680 (1997)
Lima, J.A.S., Zanchin, V., Brandenberger, R.H.: On the Newtonian cosmology equations with
pressure. Mon. Not. R. Astron. Soc. 291, L1–L4 (1997)
Maartens, R.: Causal thermodynamics in relativity (1996)
McCrea, W.H., Milne, E.A.: Newtonian Universes and the curvature of space. Q. J. Math. 5 (1934)
McCrea, W.H.: Relativity theory and the creation of matter. Proc. R. Soc. Lond. Ser. A 206, 562–575
(1951)
McVittie, G.C.: Appendix to the change of redshift and apparent luminosity of galaxies due to the
deceleration of selected expanding universes. Astrophys. J. 136, 334 (1962)
Milne, E.A.: A Newtonian expanding Universe. Q. J. Math. 5 (1934)
Milne, E.A.: Relativity, gravitation and world-structure. The Clarendon Press, Oxford (1935)
Perlmutter, S., et al.: Measurements of omega and lambda from 42 high-redshift supernovae. Astro-
phys. J. 517, 565–586 (1999)
Piattella, O.F., Giani, L.: Redshift drift of gravitational lensing. Phys. Rev. D 95(10), 101301 (2017)

References
53
Riess, A.G., et al.: Observational evidence from supernovae for an accelerating universe and a
cosmological constant. Astron. J. 116, 1009–1038 (1998)
Robertson, H.P.: Kinematics and world-structure. Astrophys. J. 82, 284 (1935)
Robertson, H.P.: Kinematics and world-structure III. Astrophys. J. 83, 257 (1936)
Ryden, B.: Introduction to Cosmology, 244 p. Addison-Wesley, San Francisco (2003)
Sandage, A.: The change of redshift and apparent luminosity of galaxies due to the deceleration of
selected expanding universes. Astrophys. J. 136, 319 (1962)
Sarkar, S., Pandey, B.: An information theory based search for homogeneity on the largest accessible
scale. Mon. Not. R. Astron. Soc. 463(1), L12–L16 (2016)
Schutz, B.F.: A First Course In General Relativity. Cambridge University Press, Cambridge (1985)
Velten, H.E.S., vom Marttens, R.F., Zimdahl, W.: Aspects of the cosmological coincidence problem.
Eur. Phys. J. C 74(11), 3160 (2014)
Walker, A.G.: On milne’s theory of world-structure. Proc. Lond. Math. Soc. 2(1), 90–127 (1937)
Weinberg, S.: Gravitation and Cosmology: Principles and Applications of the General Theory of
Relativity. Wiley, New York (1972)
Wu, K.K.S., Lahav, O., Rees, M.J.: The large-scale smoothness of the universe. Nature 397, 225–230
(1999). (19 (1998))

Chapter 3
Thermal History
L’umanità non sopporta il pensiero che il mondo sia nato per
caso, per sbaglio. Solo perché quattro atomi scriteriati si sono
tamponati sull’autostrada bagnata
(Humanity cannot bear the thought that the world was born by
accident, by mistake. Just because four mindless atoms crashed
on the wet highway)
Umberto Eco, Il Pendolo di Foucault
In this Chapter we discuss the application of Boltzmann equation in cosmology. In
particular, we address Big Bang Nucleosynthesis (BBN), recombination of protons
and electrons in neutral hydrogen atoms and the relic abundance of CDM. Our main
references are Dodelson (2003), Kolb and Turner (1990) and Daniel Baumann’s
lecture notes (Chap.3).1 See also Bernstein (1988).
3.1
Thermal Equilibrium and Boltzmann Equation
We have encountered in the previous chapter the continuity equation (2.77):
˙ε + 3H(ε + P) = 0 ,
(3.1)
where recall that the dot represents derivation with respect to the cosmic time. Sur-
prisingly, it is possible to obtain the continuity equation by using the ﬁrst and second
law of thermodynamics, i.e.
TdS = PdV + dU ,
(3.2)
1http://www.damtp.cam.ac.uk/user/db275/Cosmology/Lectures.pdf.
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_3
55

56
3
Thermal History
where T is the temperature, S is the entropy, V is the volume and U is the internal
energy of the cosmic ﬂuid. Now, assuming adiabaticity, i.e. dS = 0, and writing
U = εV , one gets
PdV + d(εV ) = 0
⇒
V dε + (ε + P)dV = 0 .
(3.3)
Exercise 3.1 Since the volume is proportional to the cube of the scale factor, i.e.
V ∝a3, show that Eq.(3.3) leads to the the continuity equation (3.1).
In using Eq.(3.2), we have made a very strong assumption: the evolution of the
universe is an adiabatic reversible transformation, i.e. at each instant the universe is
in an equilibrium state.
In some instances we can trust this assumption and it gives the correct continuity
equation. In particular, we will see that Eq.(3.1) can be obtained from Boltzmann
equation assuming no interactions among particles or assuming a very high rate
of interactions so that thermal equilibrium is reached. The latter instance can be
mathematically represented as follows:
 ≫H
(3.4)
i.e. the interaction rate is much larger than the Hubble rate, where the interaction
rate is deﬁned as follows:
 ≡nσvrel
(3.5)
where n is the particle number density of projectiles, vrel is the relative velocity
between projectile and targets and σ is the cross section.
Equation (3.4) can also be rephrased as the fact that the mean-free-path is much
smaller than the Hubble radius. In this situation, particles interact so frequently that
they do not even care about the cosmological expansion and any ﬂuctuation in their
energy density is rapidly smoothed out, thus recovering thermal equilibrium.
It is important to make distinction between kinetic equilibrium and chemical
equilibrium. When  ≫H refers to a process of the type:
1 + 2 ↔3 + 4 ,
(3.6)
i.e. we have four different particle species which transform into each other in a
balanced way, then we have chemical equilibrium. This can be also reformulated
as:
μ1 + μ2 = μ3 + μ4
(3.7)
where the μ’s are the chemical potentials.

3.1 Thermal Equilibrium and Boltzmann Equation
57
On the other hand, when  ≫H refers to a reaction such as a scattering:
1 + 2 ↔1 + 2 ,
(3.8)
then we have kinetic equilibrium. Kinetic or chemical equilibrium (or both) imply
thermal equilibrium. In general, it is possible for a species to break chemical equi-
librium and still remain in kinetic, therefore thermal, equilibrium with the rest of the
cosmic plasma through scattering processes.2
Note that  is different for different fundamental interactions and for different
particle species masses. Therefore, the above condition (3.4) is valid for all the known
(and perhaps unknown) particles in the very early universe but is broken at different
times for different species. This is the essence of the thermal history of the universe.
So, at the very beginning (we are talking about tiny fractions of seconds after
the Big Bang) all the particles were in thermal equilibrium in a primordial soup,
the primordial plasma. When for a species, the condition  ∼H is reached, it
decouples from the primordial plasma. If it does this by breaking the chemical
equilibrium, then it is said to freeze out and attains some ﬁxed abundance.3
When we want to explicitly calculate the residual abundance of some species, we
have to track its evolution until  ∼H. In this instance, equilibrium thermodynamics
fails and we are compelled to use Boltzmann equation. For example, we shall use
Boltzmann equation when analysing the formation of light elements during BBN,
the recombination of protons and electrons in neutral hydrogen atoms and the relic
abundance of CDM.
The fundamental interactions which characterise the above-mentioned processes
compel some particles to react and transform into others and vice-versa, such as in
Eq.(3.6). When  ≫H these reactions take place with equal probability in both
directions, hence the ↔symbol, but when  ∼H eventually one direction is pre-
ferred over the other. This is the characteristic of irreversibility which demands the
use of Boltzmann equation.
3.2
Short Summary of Thermal History
We present in this section a brief scheme of the main events characterising the
thermal history of the universe. A minimal knowledge of the standard model of
particle physics is required.
Planck scale, inﬂation and Grand Uniﬁed Theory. Planck scale is usually consid-
ered as an upper threshold in the energy, being the Planck mass is MPlc2 = 1019 GeV,
or as a lower threshold in the time, 10−43 s, to which we can extend our classical the-
2This occurs in some DM particle models. For example a m = 100GeV WIMP chemically decou-
ples at 5GeV and kinetically decouples at 25MeV. See e.g. Profumo et al. (2006).
3It attains a ﬁxed abundance if it is a stable particle, of course. If not it disappears.

58
3
Thermal History
ory of gravity. Beyond that threshold, the common understanding is that we should
incorporate quantum effects.
Inﬂation is a very important piece of the current description of the primordial
universe. We shall dedicate to it Chap.8 so, for now, it is enough to say that it occurs
at an energy scale of the order 1016 GeV, which is the same of the Grand Uniﬁed
Theory (GUT), i.e. a model in which electromagnetic, weak and strong interactions
are uniﬁed.
Baryogenesis and Leptogenesis. Baryogenesis is the creation, via some still unclear
mechanism, of a positive baryon number. In other words, the creation of a primordial
quark-antiquark asymmetry by virtue of which protons and neutrons are much more
common than anti-protons and anti-neutrons. In order to maintain the neutrality of the
universe, we need thus also Leptogenesis, i.e. a mechanism which produces a non-
vanishing lepton number in the form of an excess of electrons over positrons. There
is no evidence for a similar asymmetry in neutrinos and anti-neutrinos,4 therefore in
the universe energy budget, after the annihilation epochs, we shall take into account
both of them while neglecting anti-protons, anti-neutrons and positrons.
We know that antimatter exists but we also know that matter is the most abundant
in the universe. If they were produced exactly in the same quantity, they should
have annihilated almost completely when in equilibrium in the primordial plasma,
leaving just photons. Instead, we have a small but nonvanishing baryon-to-photon
ratio ηb = 5.5 × 10−10.
Decoupling of the Top quark. The Top quark is the most massive of all observed
fundamental particles, mTopc2 = 173GeV, so it is probably the ﬁrst to decouple from
the primordial plasma. For this reason it is considered here in this list.
Electroweak phase transition. At a thermal energy of about 100GeV, which cor-
responds to 10−12 s after the Big Bang, the electromagnetic and weak forces start
to behave distinctly. This happens because the vector bosons W ± and Z0 gain their
masses, of roughly 80 and 90GeV respectively, through the Higgs mechanism and
the weak interaction “weakens”, since it is now ruled by the Fermi constant:
GF
(ℏc)3 = 1.17 × 10−5 GeV−2 .
(3.9)
QCD phase transition. Below 150MeV quarks pass from their asymptotic freedom
to bound states form by two (mesons) or three (baryons) of them. The above energy
corresponds roughly to 20 µs after the Big Bang.
DM freeze-out. We do not know if DM is made up of particles and, if so, which
ones. For the neutralino case, the freeze-out takes place at about 25MeV.
Neutrino decoupling. Neutrinos maintain thermal equilibrium with the primordial
plasma through interactions such as
4It is still unclear whether neutrino is a Majorana fermion, i.e. a fermion which is its own anti-
particle, or a Dirac fermion, i.e. a fermion which is distinct from its anti-particle.

3.2 Short Summary of Thermal History
59
p + e−↔n + ν ,
p + ¯ν ↔n + e+ ,
n ↔p + e−+ ¯ν ,
(3.10)
down to a thermal energy of 1MeV, which corresponds roughly to 1s after the Big
Bang. Below this energy threshold they decouple. We can calculate roughly the
1MeV scale of decoupling in the following way. Using Eq.(3.5) with vrel = c, since
neutrinos are relativistic, one gets:

H = nνσc
H
≈
G2
F
(ℏc)6 MPlc2(kBT)3 ≈
 kBT
1 MeV
3
,
(3.11)
where we have used some results that we shall prove later, such as that the particle
number density nν goes as T 3 and H ∝T 2/MPl. When kBT ∼1 MeV then decou-
pling occurs.
We have just used the effective ﬁeld theory of the weak interaction in assuming
σ ∝G2
FT 2. An effective ﬁeld theory is a low energy approximation of the full theory.
Indeed, the cross section σ ∝G2
FT 2 diverges at high energies and this is unphysical.
In the case of the weak interaction, we have chosen to work at an energy scale much
smaller than 80GeV, which is the mass of the boson vector W ± (which mediates the
weak interaction). In this approximation, it is as if the boson vectors W ± and Z0 had
inﬁnite masses and therefore the range of the weak interaction is zero. In other words,
we have considered the interactions of Eq.(3.10) as if they occurred in a point. The
result 1MeV ≪80GeV is consistent with the effective ﬁeld theory approximation
and thus is reliable.
Another approximation that we have used is the neutrino masslessness. Even
considering a small mass mνc2 ≲0.1eV, the above calculation is solid, since mνc2 ≪
kBT ∼1MeV. The condition mc2 ≪kBT for a generic particle of mass m in thermal
equilibrium guarantees that such particle is relativistic, as we shall demonstrate later.
Other kinds of interactions involving neutrinos are those of annihilation, such as:
e−+ e+ ↔νe + ¯νe .
(3.12)
and these also are no more efﬁcient on energies scales below 1MeV.
Electron-positron annihilation. The interaction
e−+ e+ ↔γ + γ ,
(3.13)
is balanced for energies higher than the mass of electrons and positrons mec2 =
511keV. When the temperature of the thermal bath drops below this value pair
production is no longer possible and annihilation takes over. Just for completeness,
the cross section for pair production is Berestetskii et al. (1982):
σγγ = 3
16σT(1 −v2)

(3 −v4) ln
1 + v
1 −v

−2v(2 −v2)

,
(3.14)

60
3
Thermal History
where the parameter v is deﬁned as follows:
v ≡

1 −(mec2)2/(ℏ2ω1ω2) ;
(3.15)
the Thomson cross section is
σT = 8π
3
 αℏc
mec2
2
≈66.52 fm2 ,
(3.16)
with α = 1/137 being the ﬁne structure constant. Finally, ω1 and ω2 are the fre-
quencies of the two photons. Being in a thermal bath, we have that ℏω1 ≈ℏω2 ≈kBT.
From Eq.(3.15) it is then clear that the condition
ℏ2ω1ω2 ≈(kBT)2 > (mec2)2 ,
(3.17)
must be satisﬁed in order to produce pairs. Therefore, when the temperature of the
thermal bath drops below the value of the electron mass, annihilation becomes the
only relevant process. Thanks to leptogenesis, positrons disappear and only electrons
are left.
Big Bang Nucleosynthesis (BBN). We shall discuss BBN in great detail in Sect.3.9.
It occurs at about 0.1MeV (some three minutes after the Big Bang) as deuterium and
Helium form.
Recombination and photon decoupling. Proton and electrons form neutral hydro-
gen at about 0.3eV. Having no more free electrons with which to scatter, photons
decouple and can be seen today as CMB. We shall study this process in detail in
Sect.3.10.
3.3
The Distribution Function
Before applying Boltzmann equation to cosmology, we have to introduce the main
character of our story: the distribution function f . This is a function f = f (x, p, t)
of the position, of the proper momentum and of the time, i.e. it is a function which
takes its values in the phase space. It can be thought of as a probability density, i.e.
f (t, x, p)d3xd3p
V
,
(3.18)
is the probability of ﬁnding a particle at the time t in a small volume d3xd3p of the
phase space centred in (x, p), and V is some suitable normalisation.
Because of Heisenberg uncertainty principle of quantum mechanics no particle
can be localised in the phase space in a point (x, p), but at most in a small volume
V = h3 aboutthatpoint,wherehisPlanckconstant.Therefore,theprobabilitydensity
is the following:

3.3 The Distribution Function
61
dP(t, x, p) = f (t, x, p)d3xd3p
h3
= f (t, x, p)d3xd3p
(2πℏ)3 .
(3.19)
Note the dimensions: h has dimensions of energy times time, or momentum times
space. Hence f is dimensionless.
3.3.1
Volume of the Fundamental Cell
Why the fundamental cell has volume precisely equal to h3? We will see that this
value is very important in order to calculate correctly the abundances of the universe
components. That is, if it were 2h3 instead of h3 we would estimate half of the present
abundance of photons.
Consider a quantum particle conﬁned in a cube of side L. The eigenfunctions
up(x) of the momentum operator ˆp are determined by the equation:
ˆpup(x) = pup(x)
⇒
−iℏ∇up(x) = pup(x) .
(3.20)
Assuming variable separation,
up(x) = ux(x)uy(y)uz(z) ,
(3.21)
Eq.(3.20) is easily solved:
up(x) =
1
L3/2 exp
ip · x
ℏ

,
(3.22)
where the factor 1/L3/2 comes from the normalisation of the eigenfunction, which
has integrated square modulus equal to 1 in the box.
Exercise 3.2 Prove the result (3.22).
Since we have used variable separation, from now on focus only on the x dimen-
sion, for simplicity. Since the particle is restricted to be in the box, we must impose
periodic boundary conditions in Eq.(3.22):
ux(0) = ux(L) .
(3.23)
These conditions imply that the momentum is quantised, i.e.
pxL
ℏ
= 2πnx ,
(3.24)

62
3
Thermal History
where nx ∈Z.
Exercise 3.3 Prove the result (3.24).
The phase space occupied by a single state is thus:
(pxL) = 2πℏ= h ,
(3.25)
and recovering the three dimensions we get the expected result
V = (pxL)(pyL)(pzL) = h3 .
(3.26)
3.3.2
Integrals of the Distribution Function
Integrating the distribution function with respect to the momentum, one gets the
particle number density:
n(t, x) ≡gs

d3p
(2πℏ)3 f (t, x, p)
(3.27)
where gs is the degeneracy of the species, e.g. the number of spin states. If we weigh
the energy E(p) =

p2c2 + m2c4 with the distribution function, we get the energy
density
ε(t, x) = gs

d3p
(2πℏ)3 f (t, x, p)

p2c2 + m2c4
(3.28)
where note that we are identifying p ≡|p|. The pressure is deﬁned as follows:
P(t, x) = gs

d3p
(2πℏ)3 f (t, x, p) p2c2
3E(p)
(3.29)
For photons one has E(p) = pc and therefore combining Eqs.(3.28) and (3.29) one
gets the familiar result P = ε/3.
In general, the energy-momentum tensor written in terms of the distribution func-
tion has the following form:
T μ
ν(t, x) = gs
 dP1dP2dP3
(2πℏ)3
1
√−g
cPμPν
P0
f (t, x, p)
(3.30)

3.3 The Distribution Function
63
where Pμ ≡dxμ/dλ is the comoving momentum and g is the determinant of gμν.
Note that the combination dP1dP2dP3/(√−gP0) which appears in the integrand is
actually covariant. We shall prove this later in Sect.3.8, but we give now a simple
proof within special relativity. Indeed, for g = −1, the volume element reduces to
d3P/E, which is invariant under Lorentz transformations. Let us show this, focussing
on a single spatial dimension, i.e. the one along which the boost takes place and along
which the particle travels. Lorentz transformations between two inertial reference
frames are:
E′ = γ(E −βpc) ,
p′c = γ(pc −βE) ,
(3.31)
with β ≡V/c, being V the boost velocity. Combining the differential form of the
second, with the ﬁrst, we get:
dp′c
E′
= dpc −βdE
E −βpc
.
(3.32)
Exercise 3.4 Differentiate the dispersion relation E2 = p2c2 + m2c4, use it into
(3.32) and show that
dp′
E′ = dp
E ,
(3.33)
i.e. this combination is invariant.
We can rewrite Eq.(3.30) in terms of the proper momentum instead of the comov-
ing one. Using the FLRW metric with K = 0, for simplicity, the dispersion relation
(2.31) and Eq.(2.32) we can write
g00(P0)2 = −E2/c2
⇒
√−g00P0 = E/c ,
(3.34)
so that Eq.(3.30) becomes:
T μ
ν(t, x) = gs
 dP1dP2dP3
(2πℏ)3
1
a3
c2PμPν
E
f (t, x, p)
(3.35)
Exercise 3.5 Using the deﬁnition (2.32) of the proper momentum, i.e.
p2 = gijPiPj = gijPiPj = 1
a2 δijPiPj ,
(3.36)
show that:
Pi = api = apˆpi
Pi = pi
a = pˆpi
a
(3.37)

64
3
Thermal History
where ˆpi is the direction of the proper or comoving momentum, satisfying:
δij ˆpi ˆpj = 1
(3.38)
Note the following:
api = Pi = gijPj = a2δij
pj
a = aδijpj .
(3.39)
This means that
pi = δijpj
(3.40)
i.e. it is as if the proper momentum were a 3-vector in the Euclidean space.
Therefore, Eq.(3.35) becomes:
T μ
ν(t, x) = gs

d3p
(2πℏ)3
c2PμPν
E
f (t, x, p)
(3.41)
For μ = ν = 0:
T 0
0(t, x) = gs

d3p
(2πℏ)3 cP0f (t, x, p) = gs

d3p
(2πℏ)3 E(p)f (t, x, p) .
(3.42)
For μ = 0 and ν = i:
T 0
i(t, x) = gs

d3p
(2πℏ)3 cPif (t, x, p) = gs

d3p
(2πℏ)3 apcˆpif (t, x, p) .
(3.43)
Finally, for μ = i and ν = j:
T i
j(t, x) = gs

d3p
(2πℏ)3
c2p2ˆpi ˆpj
E
f (t, x, p) .
(3.44)
Taking the spatial trace and dividing by 3 we get the pressure, consistently with
Eq.(3.29).
3.4
The Entropy Density
For many of the forthcoming purposes the hypothesis of thermal equilibrium is suit-
able and very useful. As we have stated at the beginning of this chapter, it is justiﬁed
in those instances in which the interaction rate among particles is much higher than

3.4 The Entropy Density
65
the expansion rate. In these cases, one can use equilibrium thermodynamics and a
very useful quantity is the entropy density:
s ≡S
V ,
(3.45)
because, as we will show in a moment, sa3 is conserved.
In thermal equilibrium, we can cast the thermodynamical relation (3.2) in the
following form:
TdS = V dε + (ε + P)dV = V dε
dT dT + (ε + P)dV ,
(3.46)
because the energy density (and also the pressure) only depends on the temperature
T. The integrability condition applied to Eq.(3.46) yields to:
∂2S
∂T∂V =
∂2S
∂V ∂T
⇒
T dP
dT = ε + P .
(3.47)
Bosons and fermions in thermal equilibrium are distributed according to the Bose–
Einstein and Fermi-Dirac distributions:
fBE =
1
exp

E−μ
kBT
	
−1
,
fFD =
1
exp

E−μ
kBT
	
+ 1
(3.48)
We derive these distributions in Chap.12.
We now prove Eq.(3.47) in another way, assuming a distribution function of the
type f = f (E/T). We ﬁrst must know how to calculate dP/dT.
Call E/T = x and f ′ ≡df /dx. Then:
df = f ′dx = f ′
T dE −f ′E
T 2 dT .
(3.49)
Comparing this with
df = ∂f
∂E dE + ∂f
∂T dT ,
(3.50)
we can establish that
∂f
∂T = −E
T
∂f
∂E .
(3.51)
Now we use this result into:
dP
dT = gs

d3p
(2πℏ)3
∂f
∂T
p2c2
3E ,
(3.52)

66
3
Thermal History
and obtain
dP
dT = −gs

d3p
(2πℏ)3
E
T
∂f
∂E
p2c2
3E .
(3.53)
Now we introduce spherical coordinates in the proper momentum space:
d3p = p2dpd2ˆp ,
(3.54)
and use the dispersion relation E2 = p2c2 + m2c4 in order to write
∂f
∂E = ∂f
∂p
dp
dE = ∂f
∂p
E
pc2 .
(3.55)
Equation (3.53) thus becomes:
dP
dT = −gs
 p2dpd2ˆp
(2πℏ)3
E
T
∂f
∂p
p
3 .
(3.56)
Integrating by parts:
dP
dT = −gs
4π
(2πℏ)3
Ep3
3T f




∞
0
+ gs

dpd2ˆp
(2πℏ)3
1
3T f

3p2E + p3 pc2
E

,
(3.57)
where we have used again dE/dp = pc2/E. The ﬁrst contribution vanishes for p →
∞, since f →0, i.e. there are no particles with inﬁnite momentum. Recovering the
momentum volume d3p, we get:
dP
dT = gs

d3p
(2πℏ)3
1
T f

E + p2c2
3E

⇒dP
dT = ε + P
T
(3.58)
as we wanted to show.
We now prove that the temperature derivative of the pressure is the entropy density.
Substituting Eq.(3.47) into Eq.(3.46), i.e.
TdS = d(εV ) + PdV = d[(ε + P)V ] −V dP ,
(3.59)
one gets
dS = 1
T d[(ε + P)V ] −V ε + P
T 2
dT = d
(ε + P)V
T

,
(3.60)
i.e. up to an additive constant:
s ≡S
V = ε + P
T
.
(3.61)

3.4 The Entropy Density
67
Taking into account the chemical potential μ, the thermodynamical relation (3.2)
becomes
TdS = d(εV ) + PdV −μd(nV ) ,
(3.62)
and the entropy density is redeﬁned as
s ≡S
V = ε + P −μn
T
(3.63)
Exercise 3.6 Using the continuity equation and/or Eq.(3.2) show that sa3 is a con-
stant:
d
dt (sa3) = 0
(3.64)
i.e. the entropy density is proportional to 1/a3.
3.5
Photons
In these notes we use “photons” as synonym of CMB, though this is not correct since
there exist photons whose origin is not cosmological, e.g. those produced in our Sun
as well as in other stars or emitted by hot interstellar gas. These say non-cosmological
photons contribute at least one order of magnitude less than CMB photons (Camarena
and Marra 2016) so our sloppiness is partially justiﬁed.
Assuming a vanishing chemical potential since μ/(kBT) < 9 × 10−5, as reported
by Fixsen et al. (1996), the Bose–Einstein distribution for photons becomes:
fγ =
1
exp

E
kBT
	
−1
=
1
exp

pc
kBT
	
−1
,
(3.65)
where we have used the dispersion relation E = pc. Taking into account the chemical
potential is important in order to study distortions in the CMB spectrum, which is a
very recent and promising research ﬁeld (Chluba and Sunyaev 2012; Chluba 2014).
Let us calculate the photon energy density:
εγ = 2

d3p
(2πℏ)3
pc
exp

pc
kBT
	
−1
,
(3.66)
where the factor 2 represents the two states of polarisation of the photon. The angular
part can be readily integrated out, giving a factor 4π. We are left then with:

68
3
Thermal History
εγ =
c
π2ℏ3
 ∞
0
dp
p3
exp

pc
kBT
	
−1
.
(3.67)
Let us do the substitution x ≡pc/(kBT). We obtain:
εγ =
c
π2ℏ3
kBT
c
4  ∞
0
dx
x3
ex −1 .
(3.68)
The integration is proportional to the Riemann ζ function, which has the following
integral representation:
ζ(s) =
1
(s)
 ∞
0
dx xs−1
ex −1 =
1
(1 −21−s)(s)
 ∞
0
dx xs−1
ex + 1 ,
(3.69)
where (s) is Euler gamma function.
In alternative, a possible way to perform the integration is the following. Let I−
be:
I−≡
 ∞
0
dx
x3
ex −1 =
 ∞
0
dx e−xx3
1 −e−x .
(3.70)
Now use the geometric series in order to write
1
1 −e−x =
∞

n=0
e−nx ,
(3.71)
and substitute this in the integral I−:
I−=
∞

n=0
 ∞
0
dx e−(n+1)xx3 .
(3.72)
Exercise 3.7 Integrate the above equation three times by part and show that:
I−= 6
∞

n=1
1
n3
 ∞
0
dx e−nx .
(3.73)
Integrate again and ﬁnd:
I−= 6
∞

n=1
1
n4 ≡6ζ(4) = π4
15 ,
(3.74)
in agreement with Eq.(3.69).

3.5 Photons
69
Therefore, the photon energy density is the following:
εγ =
π2
15ℏ3c3 (kBT)4 .
(3.75)
This is the Stefan–Boltzmann law, of the black-body radiation. From the continuity
equation we know that εγ = εγ0/a4 so that we can infer that
T = T0
a ,
T0 = 2.725 K
(3.76)
i.e. the temperature of the photons decreases with the inverse scale factor. This is a
result that we will prove also using the Boltzmann equation (indeed the continuity
equation that provides εγ = εγ0/a4 is a way of writing the Boltzmann equation).
In the above Eq.(3.76), the value of T0 is the measured one of the CMB. Knowing
this value, we can estimate the photon energy content today (and thus at any times):
γ0 = εγ0
εcr0
=
8π3G
45ℏ3c3H 2
0 c2 (kBT0)4 .
(3.77)
Exercise 3.8 Using H0 = 100 h km s−1 Mpc−1 and the known constants of nature
show that:
γ0h2 = 2.47 × 10−5 .
(3.78)
The photon number density is calculated as follows:
nγ =
1
π2ℏ3
 ∞
0
dp
p2
exp

pc
kBT
	
−1
.
(3.79)
Making the usual substitution x ≡pc/(kBT) and using Eq.(3.69) we get:
nγ = (kBT)3
π2ℏ3c3
 ∞
0
dx
x2
ex −1 ⇒nγ = 2ζ(3)
π2ℏ3c3 (kBT)3
(3.80)
Exercise 3.9 Calculate the photon number density today. Show that it is
nγ0 = 411 cm−3.

70
3
Thermal History
3.6
Neutrinos
The same comment made at the beginning of the previous section also applies here:
with “neutrinos” we mean the cosmological, or primordial, ones and not those pro-
duced e.g. in supernovae explosions.
The massless neutrino energy density also scales as εν = εν0/a4, as the pho-
tons energy density, but since neutrinos are fermions we need now to employ the
Fermi-Dirac distribution.
Exercise 3.10 Show that the energy-density of a massless fermion species is given
by the following integral:
ε =
c
2π2ℏ3
kBT
c
4
gs
 ∞
0
dx
x3
ex + 1 .
(3.81)
Since neutrinos are spin 1/2 fermions, then gν = 2, where gν is the neutrino gs.
On the other hand, neutrinos are particles which interact only via weak interaction
and this violates parity. In other words, only left-handed neutrinos can be detected.
Right-handed neutrinos, if they exist, would interact only via gravity and via the
seesaw mechanism with the left-handed neutrino (Gell-Mann et al. 1979). Right-
handed neutrinos are also called sterile neutrinos and are advocated as possible
candidates for DM (Dodelson and Widrow 1994).
Let I+ be the integral in Eq.(3.81):
I+ ≡
 ∞
0
dx
x3
ex + 1 .
(3.82)
Using Eq.(3.69), we have:
I+ = (1 −2−3)I−= 7
8I−,
(3.83)
i.e. the difference between bosons and fermions energy densities per spin state is
simply a factor 7/8. Taking into account that I−= π4/15, the neutrino energy density
(3.81) is:
εν = 7
8Nνgν
π2
30ℏ3c3 (kBTν)4
(3.84)
where Nν is the number of neutrino families. Of course, an equivalent expression
holds true for antineutrinos.

3.6 Neutrinos
71
3.6.1
Temperature of the Massless Neutrino Thermal Bath
As we have seen in Eq.(3.64), for a species in thermal equilibrium its entropy density
s is proportional to 1/a3. Moreover, if that species is relativistic then its temperature
T scales as 1/a. Therefore, for a relativistic species in thermal equilibrium s ∝T 3.
Since photons and neutrinos do not interact, it is reasonable to ask whether the
temperatures of the photon thermal bath and of the neutrino thermal bath are the
same. We cannot observe the neutrino thermal bath today, but we can indeed predict
different temperatures.
When the temperature of the photon thermal bath was sufﬁciently high, positron-
electron annihilation and positron-electron pair production were balanced reactions:
e+ + e−↔γ + γ .
(3.85)
In order to produce e+-e−pairs, the photons must have temperature of the order of
1MeV at least.
Exercise 3.11 Knowing that today, i.e. for z = 0, the photon thermal bath has tem-
perature T0 = 2.725 K, estimate the redshift at which kBT = 1MeV.
Therefore, when the temperature of the photon thermal bath drops below that
value, the above reactions are unbalanced and more photons are thus injected in the
thermal bath. For this reason we expect the photon temperature to drop more slowly
than 1/a and then to be different from the neutrino temperature. We now quantify
this difference using the conservation of sa3.
For a relativistic bosonic species (such as the photon), the entropy density is:
sboson = ε + P
T
= 4ε
3T = gs
2π2k4
B
45ℏ3c3 T 3
(3.86)
whereas for a relativistic fermion species (such as the neutrino), the entropy density
is:
sfermion = 7
8gs
2π2k4
B
45ℏ3c3 T 3
(3.87)
Therefore, at a certain scale factor a1 earlier than e−-e+ annihilation, the entropy
density is:
s(a1) = 2π2k4
B
45ℏ3c3 T 3
1

2 + 7
8 (2 + 2) + 7
8Nν (gν + gν)

,
(3.88)
where we have left explicit all the degrees of freedom, i.e. 2 for the photons, 2 for
the electrons, 2 for the positrons, gν for the neutrinos and gν for the antineutrinos.

72
3
Thermal History
Moreover, we have assumed the same temperature T1 for photons and neutrinos
because they came from the original thermal bath (the Big Bang).
At a certain scale factor a2 after the annihilation the entropy density is:
s(a2) = 2π2k4
B
45ℏ3c3

2T 3
γ + 7
4NνgνT 3
ν

,
(3.89)
where we have now made distinction between the two temperatures. Equating
s(a1)a3
1 = s(a2)a3
2 ,
(3.90)
we obtain
(a1T1)3

2 + 7
4 (Nνgν + 2)

= (a2Tν)3

2
Tγ
Tν
3
+ 7
4Nνgν

.
(3.91)
Since (a1T1)3 = (a2Tν)3, because the neutrino temperature did not change its ∝1/a
behaviour, we are left with:
Tν
Tγ
=
 4
11
1/3
≈0.714
(3.92)
Therefore, since the CMB temperature today is of Tγ0 = 2.725 K, we expect a ther-
mal neutrino background of temperature Tν0 ≈1.945 K. Remarkably, the result of
Eq.(3.92) does not depend on the neutrino gν.
Let us open a brief parenthesis in order to justify the procedure that we have used
in order to determine the result in Eq.(3.92).
We saw that for a single species in thermal equilibrium sa3 is conserved because
of the continuity equation. However, during electron-positron annihilation the con-
tinuity equation does not hold true neither for photons nor for electron and positron,
i.e.
˙εγ + 4Hεγ = +ann ,
(3.93)
˙εe + 3H(εe + Pe) = −ann ,
(3.94)
where ann is the e−-e+ annihilation rate. Therefore, we cannot use the constancy of
sa3 for each of these species separately. However, we can and did use it for the total,
since the sum of the two above equations gives:
˙εtot + 3H(εtot + Ptot) = 0 .
(3.95)
In other words, the continuity equation always applies if one suitably extends the set
of species, ultimately because of Bianchi identities.

3.6 Neutrinos
73
Using Eq.(3.92), the neutrino and antineutrino energy densities can be thus related
to the photon energy density as follows:
εν = ε¯ν = 7
8
Nνgν
2
 4
11
4/3
εγ
(3.96)
where we have left unspeciﬁed the value of the neutrino degeneracy gν and the
number of neutrino families Nν.
The total radiation energy content can thus be written as
εr ≡εγ + εν + ε¯ν = εγ

1 + 7
8Nνgν
 4
11
4/3
.
(3.97)
The Planck collaboration (Ade et al. 2016a) has put the constraint
Neff ≡Nνgν = 3.04 ± 0.33
(3.98)
at 95% CL. Therefore, three neutrino families (Nν = 3) and one spin state for each
neutrino (gν = 1) are values which work ﬁne.
Calculating the neutrino + antineutrino number density today is straightforward:
nν = Nνgν
π2ℏ3
 ∞
0
dp
p2
exp

pc
kBTν
	
+ 1
,
(3.99)
where now the subscript ν indicates both neutrinos and antineutrinos. Making the
usual substitution x ≡pc/(kBTν), we get:
nν = Nνgν(kBTν)3
π2ℏ3c3
 ∞
0
dx
x2
ex + 1 = Nνgν(kBTν)3
π2ℏ3c3
3ζ(3)(3)
2
= 3ζ(3)Nνgν(kBTν)3
2π2ℏ3c3
.
(3.100)
Exercise 3.12 Taking into account (3.92), show that
nν = 3
11Nνgνnγ
(3.101)

74
3
Thermal History
3.6.2
Massive Neutrinos
The 2015 Nobel Prize in Physics has been awarded to Takaaki Kajita and Arthur
B. McDonald for the discovery of neutrino oscillations, which shows that neutrinos
have mass (quoting from the Nobel Prize website). Indeed, neutrino ﬂavours oscillate
among the leptonic families (electron, muon and tau), e.g. an electronic neutrino can
turn into a muonic one and a tau one, depending on its energy and on how far it
travels.
The most stringent constraints on neutrino mass do not come from particle accel-
erators but cosmology:  mν < 0.194eV at 95% CL from the Planck collaboration
(Ade et al. 2016a). The neutrino mass is thus very small and this does not change
relevantly the early history of the universe whereas it has some impact at late-times
for structure formation (Lesgourgues and Pastor 2006).
Using Eq.(3.28) and the FD distribution, the massive neutrino energy density can
be calculated as follows:
εν =

d3p
(2πℏ)3

p2c2 + m2νc4
exp

p2c2 + m2νc4/(kBT)

+ 1
,
(3.102)
where we are assuming gs = 1.
Actually, Eq.(3.102) is valid for any fermion (or boson, if we have the −1 at the
denominator), provided we can neglect the chemical potential. For this reason, we
drop the subscript ν and consider a generic species of mass m, fermion or boson, in
order to make more general statements.
Rewrite Eq.(3.102) as follows:
ε =
mc2
2π2ℏ3
 ∞
0
dp p2

p2/(m2c2) + 1
exp

A

p2/(m2c2) + 1

± 1
,
A ≡mc2
kBT .
(3.103)
Exercise 3.13 Callingx ≡A

p2/(m2c2) + 1,showthattheaboveintegration (3.103)
becomes:
ε =
m4c5
2π2ℏ3A4
 ∞
A
dx x2√
x2 −A2
ex ± 1
= (kBT)4
2π2ℏ3c3
 ∞
A
dx x2√
x2 −A2
ex ± 1
.
(3.104)
Note the lower integration limit.

3.6 Neutrinos
75
Relativistic
and
Non-relativistic
Regimes
of
Particles
in Thermal Equilibrium
Unfortunately, the above integral in Eq.(3.104) cannot be solved analytically.
When A ≪1, i.e. the thermal energy is much larger than the mass energy, the integral
in Eq.(3.104) can be expanded as follows:
 ∞
A
dx x2√
x2 −A2
ex −1
= π4
15 −π2A2
12
+ O(A3) ,
(3.105)
 ∞
A
dx x2√
x2 −A2
ex + 1
= 7π4
120 −π2A2
24
+ O(A3) .
(3.106)
The zero-order terms recovers the result of Eq.(3.75), for photons, and of Eq.(3.84),
obtained for massless neutrinos. In general, we can state that particles with mass m
in thermal equilibrium at temperature T behave as relativistic particles when
mc2 ≪kBT.
The opposite limit mc2 ≫kBT is much trickier to investigate analytically, so we
shall do it numerically.
Exercise 3.14 Calling x ≡A

p2/(m2c2) + 1, show that the number density can be
written as:
n =
m3c3
2π2ℏ3A3
 ∞
A
dx x
√
x2 −A2
ex ± 1
.
(3.107)
The ratio ε/(nmc2) can be written as:
γ ≡
ε
(nmc2) = 1
A
 ∞
A dx x2√
x2−A2
ex±1
 ∞
A dx x
√
x2−A2
ex±1
,
(3.108)
where γ is indeed some sort of averaged Lorentz factor since it is the ratio of the
energy density to the mass energy density. The behaviour of γ as function of A is
shown in Fig.3.1.
From Fig.3.1 we can infer that ε/(nmc2) ≈1 when mc2 ≫kBT and therefore the
particle becomes non-relativistic since all its energy is mass energy. In general, we
can state that particles with mass m in thermal equilibrium at temperature T
behave as non-relativistic particles when mc2 ≫kBT. The transition relativistic
→non-relativistic takes place for kBT ≈10mc2.
Now, suppose that a single family of neutrinos and antineutrinos became non-
relativistic only recently, what would be their energy density and density parameter
today? Being non-relativistic, we can write their energy density as follows:
εmν = ρνc2 = nνmνc2 ,
(3.109)

76
3
Thermal History
Fig. 3.1 Plot of γ as function of A. The solid line is for fermions whereas the dashed one for bosons
and thus the density parameter today is:
mν0 = 8πGnν0mν
3H 2
0
.
(3.110)
Exercise 3.15 Using Eq.(3.101) and the result for nγ0, prove that Eq.(3.110) can
be written as:
mν0 =
1
94h2 gν
mνc2
eV
(3.111)
3.6.3
Matter-Radiation Equality
The epoch, or instant, at which the energy density of matter (i.e. baryons plus CDM)
equals the energy density of radiation (i.e. photons plus neutrinos) is particularly
important from the point of view of the evolution of perturbations, as we shall see in
Chap.9. From Eq.(3.97) we have that:

3.6 Neutrinos
77
r0 = γ0

1 + 7
8Neff
 4
11
4/3
(3.112)
In order to calculate the scale factor aeq of the equivalence we only need to solve the
following equation:
r0
a4eq
= m0
a3eq
,
(3.113)
which gives
aeq = r0
m0
= γ0
m0

1 + 7
8Neff
 4
11
4/3
.
(3.114)
Using Eq.(3.78) and Neff = 3 one obtains:
aeq = 4.15 × 10−5
m0h2
⇒
1 + zeq = 2.4 × 104 m0h2
(3.115)
What does happen to the equivalence redshift zeq if one of the neutrino species has
mass mν ̸= 0?
If that neutrino species becomes non-relativistic after the equivalence epoch,
then the above calculation still holds true. Therefore, let us assume that the neutrino
species becomes non-relativistic, thereby counting as matter, before the equivalence.
Since there is more matter and less radiation we expect the equivalence to take place
earlier, i.e.
aeq =
3.59 × 10−5
(m0 + mν0)h2
1 + zeq = 2.79 × 104 (m0 + mν0)h2 .
(3.116)
Since T = T0(1 + z), the photon temperature at equivalence is:
Tγ,eq = 2.79 × T0 · 104 (m0 + mν0)h2 = 7.60 × 104 (m0 + mν0)h2 K .
(3.117)
Using Eq.(3.92), the temperature of neutrinos at equivalence is:
Tν,eq = 5.43 × 104 (m0 + mν0)h2 K .
(3.118)
The neutrino mass energy mνc2 has to be larger than kBTν,eq in order for the above
calculation to be consistent. This yields:
mνc2 > 5.43 kB × 104 (m0 + mν0)h2 K = 4.68 (m0 + mν0)h2 eV .
(3.119)
Using m0h2 = 0.14 and Eq.(3.111) we get mνc2 > 0.69eV, which is incompatible
with the constraint  mν < 0.194 found by the Planck collaboration.

78
3
Thermal History
3.7
Boltzmann Equation
Here is the main character of this Chapter: Boltzmann equation. It is very simple to
write:
df
dt = C[f ] ,
(3.120)
but nonetheless very meaningful, as we shall appreciate. Here f is the one-particle
distribution function and C[f ] is the collisional term, i.e. a functional of f describing
the interactions among the particles constituting the system under investigation. The
one-particle distribution is a function of time t, of the particle position x and of the
particle momentum p. In turn, also x and p are functions of time, because of the
particle motion. Therefore, the total time derivative can be written as:
df
dt = ∂f
∂t + dx
dt · ∇xf + dp
dt · ∇pf = ∂f
∂t + v · ∇xf + F · ∇pf ≡ˆL(f ) ,
(3.121)
where v is the particle velocity and F is the force acting on the particle. The operator
ˆL acting on f is similar to the convective derivative used in ﬂuid dynamics and is
also called Liouville operator.
If interactions are absent, then
df
dt = 0 ,
(3.122)
is the collisionless Boltzmann equation, or Vlasov equation. It represents mathemat-
ically the fact that the number of particles in a phase space volume element does not
change with the time. Note that we are starting here with the non relativistic version
of the Boltzmann equation. We shall see it later in the general relativistic case and
cosmology.
The collisionless Boltzmann equation is a direct consequence of Liouville theo-
rem:
dρ(t, xi, pi)
dt
= 0 ,
i = 1, . . . , N
(3.123)
where ρ(xi, pi, t) is the N-particle distribution function, i.e.
ρ(t, xi, pi)dNxdNp ,
(3.124)
is the probability of ﬁnding our system of N particles in a small volume dNxdNp of
the phase space centred in (xi, pi).
If the particles are not interacting, then the probability of ﬁnding N particles in
some conﬁguration is the product of the single probabilities. That is, the positions in
the phase space of the individual particles are independent events. Therefore:

3.7 Boltzmann Equation
79
ρ ∝f N ,
dρ
dt = Nf N−1 df
dt ,
(3.125)
andusingLiouvilletheorem (3.123)oneobtainsthecollisionlessBoltzmannequation
(3.122).
3.7.1
Proof of Liouville Theorem
In order to complete this brief introduction to the Boltzmann equation, we prove
Liouville theorem. As ﬁrst step, expand the time derivative of ρ:
dρ(t, xi, pi)
dt
= ∂ρ
∂t +
N

i=1
dxi
dt ∇xiρ + dpi
dt ∇piρ

.
(3.126)
This can be written as
dρ(t, xi, pi)
dt
= ∂ρ
∂t +
N

i=1

∇xi(ρ˙xi) + ∇pi(ρ˙pi)

,
(3.127)
since the extra term
∇xi(˙xi) + ∇pi(˙pi) = ∇pi∇xi(H) −∇xi∇pi(H) = 0 ,
(3.128)
is vanishing because of Hamilton equations of motion. Moreover, Eq.(3.127) can be
cast as:
dρ(t, xi, pi)
dt
= ∂ρ
∂t + ∇y · (ρ˙y) ,
(3.129)
where we have indicated as y the generic variable of the phase space, i.e. y = {xi, pi}
for i = 1, . . . , N. Equation (3.129) is a continuity equation. Therefore, if the particle
number N is conserved, then Eq.(3.123) must hold.
3.7.2
Example: The One-Dimensional Harmonic Oscillator
Consider the one-dimensional harmonic oscillator:
H = p2
2m + kx2
2
.
(3.130)
The Boltzmann equation is the following:

80
3
Thermal History
∂f
∂t + ∂f
∂x
dx
dt + ∂f
∂p
dp
dt = 0 ,
(3.131)
where
dx
dt = ∂H
∂p = p
m ,
dp
dt = −∂H
∂x = −kx .
(3.132)
The general strategy for solving Boltzmann equation is to use the method of the
characteristics. A characteristic is a curve in the space formed by the phase space
plus the time axis and it is parametrised by its arc length s such that
df (s)
ds
= 0 ,
(3.133)
i.e. f is constant along the characteristic. So, given an initial value s0, one has f =
f (s0).
In our example of the harmonic oscillator, the characteristic is a curve in the 3-
dimensional space (t, x, p), described by t(s), x(s) and p(s). Using the chain rule, we
get:
df
ds = ∂f
∂t
dt
ds + ∂f
∂x
dx
ds + ∂f
∂p
dp
ds = 0 .
(3.134)
Comparing with (3.131), we get the following system:
⎧
⎪⎨
⎪⎩
dt
ds = 1
dx
ds = p
m
dp
ds = −kx
⇒
⎧
⎪⎨
⎪⎩
t = s −s0
p = m dx
ds
d2x
ds2 + k
mx = 0
.
(3.135)
We solve the last equation supposing that x(s0) = x0. Therefore:
x(s) = x0 cos

k
m(s −s0)

,
(3.136)
and
p(s) = mdx(s)
ds
= −x0
√
km sin

k
m(s −s0)

≡p0 sin

k
m(s −s0)

.
(3.137)
The distribution function is thus a function of:
f = f (s0) = f

t(s0), x(s0), p(s0)

,
(3.138)
that is
f = f (s0) = f [x(s0)] = f (x0) ,
(3.139)

3.7 Boltzmann Equation
81
i.e. it is simply a function of the initial position x0. The latter can be related to the
position and momentum at any time in the following way:
x2
x2
0
+ p2
p2
0
= 1 ,
(3.140)
which turns out to be:
x2
x2
0
+
p2
x2
0km = 1
⇒
x2
0 = 2E
k ,
(3.141)
where E is the energy of the harmonic oscillator. Therefore, f = f (E), i.e. the dis-
tribution function is a function of the energy. The precise functional form depends
on the initial condition that we give on f .
3.7.3
Boltzmann Equation in General Relativity
and Cosmology
In GR the distribution function must be expressed covariantly as f = f (xμ, Pμ), and
the total derivative of f cannot be taken with respect to the time because this would
violate the general covariance of the theory. The total derivative of f is taken with
respect to an afﬁne parameter λ, as follows:
df
dλ = ∂f
∂xμ
dxμ
dλ + ∂f
∂Pμ
dPμ
dλ .
(3.142)
The geometry enters through the derivative of the four-momentum, which can be
expressed via the geodesic equation:
dPμ
dλ + μ
νρPνPρ = 0 ,
(3.143)
so that
df
dλ = Pμ ∂f
∂xμ −μ
νρPνPρ ∂f
∂Pμ ≡ˆLrel(f ) ,
(3.144)
where we have deﬁned the relativistic Liouville operator ˆLrel. It might seem that in
the relativistic case we have gained one variable, i.e. P0, but this is not so because P0
is related to the spatial momentum Pi via the relation gμνPμPν = −m2c2. For this
reason, we can reformulate the Liouville operator as follows:
df
dλ = Pμ ∂f
∂xμ −i
νρPνPρ ∂f
∂Pi ,
(3.145)
i.e. by considering f = f (xμ, Pi).

82
3
Thermal History
Collisionless Boltzmann Equation in Relativistic Cosmology
When we couple Eq.(3.145) with FLRW metric, we must take into account that
f cannot depend on the position xi, because of homogeneity and isotropy. The colli-
sionless Boltzmann equation thus becomes:
P0 ∂f
∂t −i
νρPνPρ ∂f
∂Pi = 0 .
(3.146)
Exercise 3.16 Considering the spatially ﬂat case K = 0, show that the above equa-
tion can be cast as follows:
∂f
∂t −2HPi ∂f
∂Pi = 0 .
(3.147)
Again, because of isotropy, f cannot depend on the direction of Pi, but only on
its modulus P2 = δijPiPj.
Exercise 3.17 Show for a generic function f = f (x2) that:
xi ∂f
∂xi = x∂f
∂x ,
(3.148)
with x2 ≡δijxixj.
Therefore, we can write
∂f
∂t −2HP ∂f
∂P = 0 .
(3.149)
Exercise 3.18 Show that the solution of the above equation is a generic function:
f = f (a2P) = f (ap) ,
(3.150)
where in the second equality we have used the deﬁnition of the proper momentum.
Show that the Boltzmann equation written using the proper momentum has the
following form:
∂f
∂t −Hp∂f
∂p = 0
(3.151)
Moments of the Collisionless Boltzmann Equation

3.7 Boltzmann Equation
83
Taking moments of the Boltzmann equation means to integrate it in the momentum
space, weighed with powers of the proper momentum. This method is due to Grad
(Grad 1958). For example, the moment zero of Eq.(3.151) is the following:

d3p
(2πℏ)3
∂f
∂t −Hp∂f
∂p

= 0
(Moment zero) .
(3.152)
Exercise 3.19 Using the deﬁnition of the particle number density (3.27), show that
Eq.(3.152) becomes:
˙n + 3Hn = 0
⇒
1
a3
d(na3)
dt
= 0
(3.153)
The particle number na3 is conserved. This is an expected result since we have
considered a collisionless Boltzmann equation, i.e. absence of interactions and thus
no source of creation or destruction of particles.
Weighing Eq.(3.151) with the energy and integrating in the momentum space we
get:
˙ε −H

d3p
(2πℏ)3 pE(p)∂f
∂p = 0 .
(3.154)
Exercise 3.20 Integrate by parts the above equation and show that it becomes:
˙ε + 3H (ε + P) = 0 ,
(3.155)
i.e. the continuity equation.
Weighing Boltzmann equation (3.151) with ˆpi will always result in an identity,
because of isotropy. We can show this as follows:

d3p
(2πℏ)3 ˆpi
∂f
∂t −Hp∂f
∂p

=

d2ˆp ˆpi

dp p2
(2πℏ)3
∂f
∂t −Hp∂f
∂p

= 0 .
(3.156)
Since f = f (ap) then only the integration in p contains f and the angular integration
is just a multiplicative factor.

84
3
Thermal History
Exercise 3.21 Show that:

d2ˆp ˆpi = 0 ,
(3.157)
and thus Eq.(3.156) is an identity.
3.8
Boltzmann Equation with a Collisional Term
For the forthcoming applications we shall need to investigate interactions of the
following type:
1 + 2 ↔3 + 4 ,
(3.158)
among generic species that we dub 1, 2, 3 and 4. This reaction can describe scat-
tering or annihilation and will be suitable for discussing BBN, recombination and
calculating the expected relic abundance of CDM.
Let us take the particle 1 as reference and let us focus on its Boltzmann equation:
df1
dλ = C[f ] .
(3.159)
The collisional term is the same for all the particles, and has dimension of an
inverse time, i.e. it is a scattering rate. Using the Liouville operator of Eq.(3.146),
we can cast the above equation as
∂f1
∂t −Hp1
∂f1
∂p1
= 1
P0
1
C[f ] ,
(3.160)
where we have passed from the afﬁne parameter λ to the time t, and for this reason
P0
1 appears. Taking the moment zero of the above equation, and using the result of
Eq.(3.153), we get:
1
a3
d(n1a3)
dt
=

d3p1
(2πℏ)3P0
1
C[f ] .
(3.161)
Introducing the general expression of the right hand side (Kolb and Turner 1990),
the above equation becomes:

3.8 Boltzmann Equation with a Collisional Term
85
1
a3
d(n1a3)
dt
=

d3p1
(2πℏ)32E1

d3p2
(2πℏ)32E2

d3p3
(2πℏ)32E3

d3p4
(2πℏ)32E4
(2π)4δ(3)(p1 + p2 −p3 −p4)δ(E1 + E2 −E3 −E4)|M|2

f3f4(1 ± f1)(1 ± f2) −f1f2(1 ± f3)(1 ± f4)

,
(3.162)
where Ei =

p2
i + m2
i . We have to provide several comments.
• Since we took the zero moment of Eq.(3.159), the left hand side is the time
derivative of the number of particles of the species 1. See also Eq.(3.153).
• We have incorporated the particles degeneracies gs in the distribution functions.
• The integrals are over the particles momenta. On the other hand, the total four-
momentum must be conserved, hence the Dirac deltas in the second line. Note the E1
contribution in the ﬁrst integration. You may think that it comes from the P0
1 factor
in Eq.(3.161), but this would not explain the factor 2. Indeed, one must rather look
at the right hand side of Eq.(3.162) as a deﬁnition of the momentum integrated C[f ].
•Thefundamentalphysicsoftheinteractionisrepresentedbytheamplitude|M|2.
We have also assumed symmetric interaction, i.e. for ﬁxed particles four-momenta
the amplitude probability for 1 + 2 →3 + 4 is the same as for 1 + 2 ←3 + 4.
• In the last line, we have a balance: the more particle 3 and 4 we have, the more
they react and produce particles 1 and 2. And vice-versa. Since our reference particle
is the 1, we have the combination f3f4 −f1f2.
• Finally, the contributions of the type 1 + f and 1 −f are called Bose enhance-
ment and Pauli blocking, respectively. They represent the fact that it is easier to
produce a boson rather than a fermion because, due to Pauli exclusion principle,
there are more states available to the former than to the latter.
• The volume element d3p/2E is covariant. It comes from the fact that we have
enforced E2 = p2c2 + m2c4 for each particle. We now prove it. When we want to
enforce the dispersion relation E2 = p2c2 + m2c4 we use a Dirac delta in the four-
momentum space:

d3p
 ∞
0
dE δ(P2 + m2c2) =

d3p
 ∞
−∞
dE δ(E2 −p2c2 −m2c4) θ(E) ,
(3.163)
where the square modulus of the four-momentum is P2 = −E2/c2 + p2. The Heavi-
side function θ(E) serves to choose only the positive values of the energy. The above
equation is covariant. Using the known relation:
δ[F(x)] =

i
δ(x −xi)
|F′(xi)| ,
(3.164)
where the xi’s are the roots of the generic function F(x), one gets:

86
3
Thermal History
δ(E2 −p2c2 −m2c4) = δ(E −

p2c2 + m2c4)
2E+
+ δ(E +

p2c2 + m2c4)
2E−
,
(3.165)
where E± = ±

p2c2 + m2c4.
The second term of Eq.(3.165) integrated with θ(E) in Eq.(3.163) vanishes and
we are left with:

d3p
 ∞
−∞
dE δ(E2 −p2c2 −m2c4) θ(E) =

d3p
2E+
,
(3.166)
which is what we wanted to prove.
We now focus our attention to Eq.(3.162) and make some assumptions in order to
simplify it. In particular, we shall always assume thermal equilibrium and sufﬁciently
small temperatures such that:
E −μ ≫kBT
(3.167)
in order to use the FD and BE distributions simpliﬁed as follows:
f ≈e−E/(kBT)eμ/(kBT) ,
(3.168)
i.e. forgetting the ±1 (using thus the Maxwell-Boltzmann distribution).
Exercise 3.22 Show that using Eq.(3.168), the last line of Eq.(3.162) can be sim-
pliﬁed as:
f3f4(1 ± f1)(1 ± f2) −f1f2(1 ± f3)(1 ± f4) ≈
e−(E1+E2)/(kBT) 
e(μ3+μ4)/(kBT) −e(μ1+μ2)/(kBT)
.
(3.169)
In particular, we can neglect the Bose enhancement and Pauli blocking terms. One has
to use energy conservation E3 + E4 = E1 + E2 in order to obtain the above equation.
With the approximation given in Eq.(3.168), the particle number density can be
simpliﬁed as follows:
n = gs

d3p
(2πℏ)3 f ≈gseμ/(kBT)

d3p
(2πℏ)3 e−E/(kBT) ,
(3.170)
where we could extract the chemical potential from the integral since it does not
depend on the particle momentum but rather on the temperature of the thermal bath.
For μ = 0 we deﬁne the equilibrium number density as:

3.8 Boltzmann Equation with a Collisional Term
87
n(0) = gs

d3p
(2πℏ)3 e−E/(kBT)
(3.171)
3.8.1
Detailed Calculation of the Equilibrium Number
Density
Now we show how to calculate the equilibrium number density in the regimes mc2 ≫
kBT and mc2 ≪kBT, which we proved earlier to be regimes in which the particles
are non-relativistic and relativistic, respectively. At the same time, we justify the
approximation of Eq.(3.168). Let us start from:
n(0) = gs

d3p
(2πℏ)3
1
eE/(kBT) ± 1 =
gs
2π2ℏ3
 ∞
0
dp
p2
e
√
p2c2+m2c4/(kBT) ± 1
, (3.172)
and split the integration, let us dub it I, into two contributions, one from zero up to
mc and the other from mc to inﬁnity, i.e.
I =
 mc
0
dp
p2
e
√
p2c2+m2c4/(kBT) ± 1
+
 ∞
mc
dp
p2
e
√
p2c2+m2c4/(kBT) ± 1
.
(3.173)
The Non-relativistic Case mc2 ≫kBT
Now let us start considering the non-relativistic case mc2 ≫kBT. We shall use dif-
ferent approximations within the two integrals in which we split I:
I =
 mc
0
dp
p2
emc2√
p2/(m2c2)+1/(kBT) ± 1
+
 ∞
mc
dp
p2
epc√
1+m2c2/p2/(kBT) ± 1
. (3.174)
Now we use the mc2 ≫kBT condition. In the ﬁrst integral p < mc because of the
integration limits, so we can expand the square root with respect to p/(mc). The
second integral is negligible with respect to the ﬁrst one because, since pc > mc2 ≫
kBT, the integrand is always exponentially small. Thus we are left with:
I = e−mc2/(kBT)
 mc
0
dp p2e−p2/(2mkBT) ,
(3.175)
where we kept just the dominant term for the ﬁrst integral. This is the same integral
that we would have obtained had we started from Eq.(3.171).

88
3
Thermal History
After changing variable, we get:
I = e−mc2/(kBT)(2mkBT)3/2
 mc/√2mkBT
0
dx x2e−x2 ,
(3.176)
and the result is:
I = e−mc2/(kBT)(2mkBT)3/2
⎡
⎣−

mc2
8mkBT e−mc2/(2kBT) +
√π
4 Erf
⎛
⎝

mc2
2mkBT
⎞
⎠
⎤
⎦.
(3.177)
The dominant contribution of the above expression comes from the Erf function,
which can be approximated to 1 in the mc2 ≫kBT limit, and thus:
I = e−mc2/(kBT)(2mkBT)3/2
√π
4
.
(3.178)
Finally, we can express the equilibrium number density for any species in thermal
equilibrium and mc2 ≫kBT as:
n(0) = gs
mkBT
2πℏ2
3/2
e−mc2/(kBT) ,
for mc2 ≫kBT .
(3.179)
The Relativistic Case mc2 ≪kBT
Now we adopt the same technique in the other relevant limit, the one of relativistic
particles, for which mc2 ≪kBT. We split the integral I in the same way as before:
I =
 mc
0
dp
p2
emc2√
p2/(m2c2)+1/(kBT) ± 1
+
 ∞
mc
dp
p2
epc√
1+m2c2/p2/(kBT) ± 1
, (3.180)
but now the mc2 ≪kBT condition allows us to make the following approximations:
I =
 mc
0
dp
p2
1 + mc2
kBT

p2/(m2c2) + 1 ± 1
+
 ∞
mc
dp
p2
epc(1+m2c2/2p2)/(kBT) ± 1 .
(3.181)
Now it is the ﬁrst integral that is subdominant with respect to the second one, and I
can be written as:
I =
 ∞
mc
dp p2e−pc/(kBT) = (kBT)3
c3
 ∞
mc2/(kBT)
dx x2e−x .
(3.182)
The solution of the integration is:

3.8 Boltzmann Equation with a Collisional Term
89
I = (kBT)3
c3
e−mc2/(kBT)

2 + mc2
kBT

2 + mc2
kBT

.
(3.183)
In the mc2 ≪kBT regime, this becomes:
I = 2(kBT)3
c3
.
(3.184)
Finally, we can express the equilibrium number density for any species in thermal
equilibrium and mc2 ≪kBT as:
n(0) = gs
(kBT)3
π2ℏ3c3 ,
for mc2 ≪kBT .
(3.185)
3.8.2
Saha Equation
Expressing the contributions eμi/(kBT) as ratios ni/n(0)
i , we can recast the collisional
Boltzmann’s equation (3.162) as follows:
1
a3
d(n1a3)
dt
= n(0)
1 n(0)
2 ⟨σv⟩
#
n3n4
n(0)
3 n(0)
4
−
n1n2
n(0)
1 n(0)
2
$
(3.186)
where we have deﬁned the thermally averaged cross section as follows:
⟨σv⟩≡
1
n(0)
1 n(0)
2

d3p1
(2πℏ)32E1

d3p2
(2πℏ)32E2

d3p3
(2πℏ)32E3

d3p4
(2πℏ)32E4
(2π)4δ(3)(p1 + p2 −p3 −p4)|M|2e−(E1+E2)/(kBT) .
(3.187)
Observe the following very important point about Eq.(3.186). When there are no
interactions, i.e. when ⟨σv⟩= 0, we recover the collisionless Boltzmann equation
that we have discussed earlier. On the other hand, when the interaction rate is
extremely high, i.e. it is much larger than than the Hubble rate:
n(0)
1 n(0)
2 ⟨σv⟩≫1
a3
d(n1a3)
dt
∼n1H ,
(3.188)
then in order for Eq.(3.186) to hold true, we must have:

90
3
Thermal History
n3n4
n(0)
3 n(0)
4
=
n1n2
n(0)
1 n(0)
2
(3.189)
This equation can be written as Eq.(3.7) and thus represents chemical equilibrium,
as we saw at the beginning of this chapter. Equation (3.189) is also known as Saha
equation.
So we see that when  ≫H then Saha equation (3.189) must hold and Boltzmann
equation (3.186) becomes:
1
a3
d(n1a3)
dt
= 0 ,
(3.190)
whichis thesameBoltzmannequationthat wewouldhaveif interactions wereabsent!
This similarity between high interaction rate and no interaction at all is intriguing and
responsible of the very low degree of CMB polarisation, as we shall see in Chap.10.
3.9
Big-Bang Nucleosynthesis
The BBN is the formation of the primordial light elements, mainly helium. It took
place at a temperature (photon temperature) of about 0.1MeV, which corresponds to
a redshift z ≈109.
In order to investigate the BBN, we need to know the characters of the story. At
temperatures say larger than 1MeV the primordial plasma was formed by photons,
electrons, positrons, neutrinos, antineutrinos, protons and neutrons. We have already
seen how photons, electrons, positrons, neutrinos, antineutrinos interact among each
other, so now we focus on protons and neutrons. Their interactions relevant to BBN
are:
n ↔p + e−+ ¯νe
(beta decay) ,
(3.191)
p + e−↔νe + n
(electron capture) ,
(3.192)
p + ¯νe ↔e+ + n
(inverse beta decay) .
(3.193)
As we have seen, at a temperature of about 1MeV neutrinos decouple. Therefore,
the β-decay reaction in Eq.(3.191) (from left to right) takes over and the number
of neutrons starts to diminish. On the other hand, they can also be captured by
protons and form deuterium nuclei. The BBN is essentially a competition in capturing
neutrons before they decay.

3.9 Big-Bang Nucleosynthesis
91
3.9.1
The Baryon-to-Photon Ratio
A very important number for BBN and cosmology is the baryon-to-photon ratio
ηb, which we have already encountered at the beginning of this chapter. It is deﬁned
as follows:
ηb ≡nb
nγ
= 5.5 × 10−10
b0h2
0.020

(3.194)
i.e. as the ratio between the number of baryons and the number of photons. We have
deﬁned it via number densities, which individually are time-dependent quantities but
whose ratio is ﬁxed since both scales as 1/a3. The above numbers in Eq.(3.194) can
be found as follows:
ηb = nb
nγ
=
εb0
mbc2nγ0
,
(3.195)
where we have assumed the baryons to be nonrelativistic, which is indeed the case
at the temperatures we are dealing with (kBT ∼MeV) since the proton mass is of the
order of 1GeV.
Using Eqs.(3.75) and (3.80), we can write
nγ0
εγ0
= 30ζ(3)
π2kBT0
.
(3.196)
Therefore,
ηb =
π4kBT0εb0
30ζ(3)mbc2εγ0
=
π4kBT0b0
30ζ(3)mbc2γ0
,
(3.197)
where in the last equality we have multiplied and divided by the present critical
energy density in order for the density parameters to appear.
Exercise 3.23 Show that Eq.(3.197) leads to Eq.(3.194). Use the mass of the proton
as mb since the baryon energy density is indeed dominated by the mass energy density
of the protons.
The fact that there is a billion photon for each proton and electron is very important
for the following reason. Even if the temperature of the thermal bath is lower than the
binding energy of deuterium, i.e. 2.2MeV, there are still many photons with energy
higher than 2.2MeV which are able to break newly formed deuterium nuclei. This
is also known as deuterium bottleneck.
As Kolb and Turner comment in their book (Kolb and Turner 1990, page 92), it is
not deuterium’s fault if BBN takes place at temperature much smaller than 2.2MeV.
Rather, the very high entropy of the universe, i.e. the smallness of ηb, is the culprit.

92
3
Thermal History
3.9.2
The Deuterium Bottleneck
The deuterium bottleneck is the situation in which newly formed deuterium nuclei
are destroyed by photons. With no deuterium available, BBN cannot take place.
Let us start considering the reaction:
p + n ↔D + γ ,
(3.198)
at chemical equilibrium. Using Saha equation (3.189), we have
nDnγ
n(0)
D n(0)
γ
=
npnn
n(0)
p n(0)
n
.
(3.199)
Neglecting the photon chemical potential, i.e. nγ = n(0)
γ , and using Eq.(3.179) we
obtain:
nD
npnn
=
n(0)
D
n(0)
p n(0)
n
= gD
gpgn
 2πℏ2mD
mpmnkBT
3/2
e−(mD−mp−mn)c2/(kBT) .
(3.200)
The deuterium has spin 1, whereas protons and neutrons have spin 1/2. Therefore,
nD
npnn
= 3
4
 2πℏ2mD
mpmnkBT
3/2
eBD/(kBT) ,
(3.201)
where BD = 2.22MeV is the deuterium binding energy. We can write the masses
ratio as follows:
mD
mpmn
= mp + mn −BD/c2
mpmn
= 1
mn
+ 1
mp
−
BD
mpmnc2 .
(3.202)
Introducing the neutron-proton mass difference (Wilczek 2015):
Q ≡(mn −mp)c2 = 1.239 MeV ,
(3.203)
we can write
mD
mpmn
=
1
mp(1 + Q/mpc2) + 1
mp
−
BD
m2p(1 + Q/mpc2)c2 .
(3.204)
Since Q/mpc2 ∼BD/mpc2 ∼10−3, we approximate:
mD
mpmn
≈2
mp
.
(3.205)

3.9 Big-Bang Nucleosynthesis
93
Moreover, being nn = np = nb, we can write:
nD
nb
= 3
4nb
 4πℏ2
mpkBT
3/2
eBD/(kBT) ,
(3.206)
i.e. we obtain a deuterium-to-baryon ratio which deﬁnes how many baryons exist
that are deuterium nuclei. Dealing with the nb on the right hand side as follows:
nb = ηbnγ = ηbn(0)
γ
= 2ηb
(kBT)3
π2ℏ3c3 ,
(3.207)
where we have used Eq.(3.185) for the photon number density, we get
nD
nb
= 12
√π ηb
 kBT
mpc2
3/2
eBD/(kBT) .
(3.208)
Even when kBT ∼BD the relative abundance is very small, because of the pref-
actor ηb. This is the deuterium bottleneck.
Typically, the temperature TBBN at which the BBN starts is the one at which
the bottleneck is overcome. This is because, as numerical calculations show, once
deuterium is formed it rapidly combines into Helium.
So, we deﬁne TBBN as the one for which nD = nb:
log
 12
√π ηb

+ 3
2 log
kBTBBN
mpc2

= −
BD
kBTBBN
.
(3.209)
Numerically solving this equation, one ﬁnds
kBTBBN ≈0.07 MeV
(3.210)
Note that we can use Saha equation only until chemical equilibrium holds true.
When the reaction p + n ↔D + γ unbalances and deuterium is formed, we must
use the full Boltzmann equation (3.186). However, it can be shown numerically
that the two equations provide compatible results up to the moment in which the
equilibrium is broken. Therefore, Saha equation is an useful tool for estimating
when the equilibrium is broken but, of course, if one needs precise results one should
solve the full Boltzmann equation.

94
3
Thermal History
3.9.3
Neutron Abundance
After the deuterium bottleneck is overcome, BBN takes place in the following chain
reactions:
p + n →D + γ ,
(3.211)
D + D →3He + n ,
(3.212)
D + 3He →4He + p .
(3.213)
In the following, we shall assume that the three above reactions take place instanta-
neously and the neutrons are captured in Helium nuclei. This is not what occurred,
of course, but it turns out to be a good approximation which allows us to perform
easy calculations.
Note that Lithium 3Li is also produced, but in tiny fraction (one billionth of the
hydrogen abundance). However, measuring its abundance in the universe is a very
important independent measure of b0.
The main prediction of BBN is on the abundance of 4He because this is the
element which is mostly formed, due to both its high binding energy per nucleon,
which is about 7MeV, see Fig.3.2, but also to the fact that there is not much time for
forming heavier nuclei since the thermal bath is rapidly cooling and ηb is so small.
Our objective is thus to determine the neutron abundance at TBBN. This is done
considering two reactions. The electron capture:
Fig. 3.2 Binding energy per nucleon. Figure taken from https://en.wikipedia.org/wiki/Helium-4

3.9 Big-Bang Nucleosynthesis
95
p + e−↔n + ν ,
(3.214)
and the β-decay:
n ↔p + e−+ ¯ν .
(3.215)
The β-decay will provide just an exponential suppression on the abundance predicted
by the the electron capture. Therefore, we focus on the latter.
For temperature kBT ≫1MeV, protons and neutrons are in chemical equilibrium:
np
nn
=
n(0)
p
n(0)
n
=
mp
mn
3/2
e(mn−mp)c2/(kBT) ∼eQ/(kBT) ,
(3.216)
whereQ = 1.239MeV,seeEq.(3.203).WhenkBT ≫Q,themassdifferencebetween
protons and neutrons is irrelevant, and therefore they are in chemical equilibrium.
When kBT drops below Q nature starts to favor protons because they are energetically
more “economic” and neutrons start to disappear. However, as we mentioned earlier,
out of equilibrium we cannot use Saha equation but have to solve the full Boltzmann
equation:
1
a3
d(nna3)
dt
= n(0)
n n(0)
l ⟨σv⟩
#
npnl
n(0)
p n(0)
l
−
nnnl
n(0)
n n(0)
l
$
,
(3.217)
where we have denoted with the subscript l the leptons, either electron or neutrino,
involved in the electron capture process. We assume their chemical potentials to be
zero and simplify Eq.(3.217) as follows:
1
a3
d(nna3)
dt
= n(0)
l ⟨σv⟩
#
npn(0)
n
n(0)
p
−nn
$
.
(3.218)
Let us deﬁne the neutron abundance and the scattering rate as follows:
Xn ≡
nn
nn + np
,
n(0)
l ⟨σv⟩≡λnp .
(3.219)
Exercise 3.24 Show that Eq.(3.218) can be cast, using Eq.(3.219), as follows:
dXn
dt = λnp

(1 −Xn)e−Q/(kBT) −Xn

.
(3.220)
In order to solve (numerically) Eq.(3.220), we introduce the variable:
x ≡
Q
kBT .
(3.221)

96
3
Thermal History
Exercise 3.25 Show that the time derivative of x ≡Q/(kBT) can be cast as follows:
dx
dt = Hx = x

8πGε
3c2
.
(3.222)
Since we are deep in the radiation-dominated era, we can write the energy density
of Eq.(3.222) as follows:
ε = π2(kBT)4
30(ℏc)3 g∗
(3.223)
where the effective number of relativistic degrees of freedom is
g∗≡

i=bosons
gi + 7
8

i=fermions
gi ,
(3.224)
where recall the 7/8 factor coming from Eq.(3.83). The effective number of relativis-
tic degrees of freedom is actually a function of the temperature, since it decreases
when a certain species becomes non-relativistic. For temperature larger than 1MeV
g∗is roughly a constant and its value is:
g∗= 2 + 7
8(3 + 3 + 2 + 2) = 10.75 ,
(3.225)
where we have considered two degrees of freedom coming from the photons, 3 +
3 coming from neutrinos and anti-neutrinos and 2 + 2 coming from electrons and
positrons. We have considered just a single spin state for each neutrino and anti-
neutrino.
Exercise 3.26 Show that the Hubble parameter can thus be cast in the following
form:
H 2 = 8πG
3c2
π2(kBT)4
30(ℏc)3 g∗= 4π3Gg∗Q4
45c2(ℏc)3
1
x4 .
(3.226)
Calculate:
H(x = 1) = 1.13 s−1 .
(3.227)
Show that Eq.(3.220) can be cast as:
dXn
dx =
xλnp
H(x = 1)

e−x −Xn(1 + e−x)

.
(3.228)

3.9 Big-Bang Nucleosynthesis
97
Fig. 3.3 Evolution of Xn from Eq.(3.228)
We only need a last piece of information, i.e. the interaction rate λnp:
λnp = 255
τnx5 (12 + 6x + x2) ,
(3.229)
where
τn = 886.7 s ,
(3.230)
is the neutron lifetime. The above scattering rate can be found in Bernstein (1988).
We can now solve numerically Eq.(3.228) together with Eq.(3.229). The initial
condition on Xn is of course Xn(x →0) = 1/2, as we can see from the Saha equation
(3.216). We plot the evolution of Xn in Fig.3.3.
As we can appreciate from Fig.3.3, Xn →0.15 as x →∞. This number is not
a very good approximation of the residual abundance of neutrons at TBBN because
there are other relevant processes which contribute to deplete or enhance the number
of neutrons. Namely:
n →p + e−+ ¯ν ,
(3.231)
n + p →D + γ ,
(3.232)
i.e. the β-decay and the neutron-proton capture. These processes lower the number
of free neutrons. The Helium-3 formation:

98
3
Thermal History
D + D →3He + n ,
(3.233)
puts back into play another neutron and the Helium-4 formation:
3He + D →4He + p ,
(3.234)
reinserts into play another proton, which helps in capturing neutrons, thus lowering
their number.
The right way to calculate the abundances of the light elements produced during
BBN is to consider all the coupled Boltzmann equations for all the relevant reactions
taking place. This is, of course, done numerically and the standard code is Wagoner’s
one (Wagoner 1973) (there has been reﬁnements since then).
We now show that correcting Xn = 0.15 by taking into account only the β-decay
gives a result which is in surprising agreement with the more reliable one which
takes into account all the reactions.
What we have to do is to weigh Xn = 0.15 with exp(−tBBN/τn),5 where tBBN is
the time corresponding to kBTBBN = 0.07MeV, i.e. the time at which BBN starts.
Moreover, we suppose that at this time all the free neutrons are immediately captured
and produce Helium-4. Thereby, estimating Xn gives a direct estimation of X4He.
At kBTBBN = 0.07MeV, electrons and positrons have already annihilated. There-
fore, the effective relativistic degrees of freedom are:
g∗= 2 + 7
8
 4
11
4/3
6 ≈3.36 ,
(3.235)
where we have taken into account the temperature difference between photons and
neutrinos.
Since T ∝1/a and in the radiation-dominated epoch a ∝√t, we can relate time
and temperature as follows:
1
4t2 = H 2 = 4π3G(kBT)4
45c2(ℏc)3 g∗.
(3.236)
Exercise 3.27 Show from Eq.(3.236) that:
t = 271
0.07 MeV
kBT
2
s .
(3.237)
Therefore, the expected abundance of neutrons at kBTBBN = 0.07MeV is:
Xn(TBBN) = 0.15 · e−271/886.7 ≈0.11 .
(3.238)
5This exponential weight comes from Poisson distribution, which governs stochastic processes such
as the β-decay. We derive it in Chap.12.

3.9 Big-Bang Nucleosynthesis
99
Fig. 3.4 Time-evolution of the mass fraction of various elements.
Figure taken from http://
cococubed.asu.edu/images/net_bigbang/bigbang_time_2010.pdf
Assuming that all the neutrons end up in Helium-4 nuclei, we have the prediction:
YP ≡4X4He ≡4n4He
nb
= 2Xn(TBBN) = 0.22 .
(3.239)
The factor 4 comes from the fact that YP is a mass fraction and each Helium-4 nucleus
contains 4 baryons. We have also assumed mb = mp = mn.
The more accurate numerical result is Kolb and Turner (1990):
YP = 0.2262 + 0.0135 log

ηb
10−10
	
,
(3.240)
which is in very good agreement with our “back-of-the-envelope” calculation. In
Fig.3.4 the time-evolution plots of the mass fractions of various elements are dis-
played.

100
3
Thermal History
3.10
Recombination and Decoupling
Recombination is the process by which neutral hydrogen is formed via combination
of protons and electrons. Decoupling is generally refered to be the epoch when
photons stop to interact with free electrons and their mean free path becomes larger
than the Hubble radius and we are able to detect them as CMB coming from the last
scattering surface. For the two events, the relevant interactions are:
p + e−↔H + γ ,
(3.241)
e−+ γ ↔e−+ γ
(Compton/Thomson scattering) .
(3.242)
Recombination and decoupling temporally occur close to each other for the following
reason. At sufﬁciently low temperatures, which we will calculate, photons are no
more able to break hydrogen atoms and so these start to form in larger number
(recombination). Being captured in hydrogen atoms, the number of free electrons
dramatically drops and the Thomson scattering rate goes to zero (decoupling). The
seminal paper on recombination is Peebles (1968).
In order to determine the epoch of recombination, let us use again Saha equation:
nenp
nH
=
n(0)
e n(0)
p
n(0)
H
.
(3.243)
Let us assume neutrality of the universe, i.e. ne = np and deﬁne the free electron
fraction:
Xe ≡
ne
ne + nH
=
np
np + nH
,
(3.244)
Exercise 3.28 Considering that the degeneracy of the hydrogen atom, in the state
1s, is g1s = 4 (it has two hyperﬁne states, one of spin 0 and the other of spin 1), show
that Saha equation can be written, using Eq.(3.179), as:
X 2
e
1 −Xe
=
1
ne + nH
mempkBT
2mHπℏ2
3/2
e−(me+mp−mH )c2/(kBT) .
(3.245)
Consider the contribution at the denominator of the right hand side as:
ne + nH = nb = ηbnγ = ηb
2ζ(3)
π2ℏ3c3 (kBT)3 ≈10−9 (kBT)3
ℏ3c3
.
(3.246)
Look at the ﬁrst equality as follows: the total electron number is made up of those
which are free plus those which have already been captured. Moreover, the total
electron number density is the same as the baryon number density because electrons
are baryons (in the jargon of cosmology).

3.10 Recombination and Decoupling
101
We again neglect the mass difference elsewhere than at the exponential, and write:
X 2
e
1 −Xe
≈109
 mec2
2πkBT
3/2
exp

−13.6 eV
kBT

,
(3.247)
where we used
ε0 ≡(me + mp −mH)c2 = 13.6 eV ,
(3.248)
i.e. the ionisation energy of the hydrogen atom.
The high photon-to-baryon number delays recombination as well as it delayed
BBN. Indeed, when kBT = 13.6eV, we get from Eq.(3.247):
X 2
e
1 −Xe
≈1015 ,
(3.249)
FromwhichonegetsthatXe ≈1.Thismeansthatevenwhentheenergyofthethermal
bath drops below the ionisation energy of the hydrogen atom, still no hydrogen is
formed and the electrons remain free. This, again, happens because there are still
many photons with energy much higher than 13.6eV.
As we already mentioned, Saha equation works until chemical equilibrium is
maintained. In Table 3.1 we show numerical calculations of Xe from Eq.(3.247) in
order to have a hint about the time of recombination.
From Table 3.1 we see that the free electron fraction falls abruptly at about
kBT ≈0.30eV.
Exercise 3.29 Calculate at which redshift corresponds the energy kBT = 0.3eV of
the photon thermal bath.
In Fig.3.5 we numerically solve Saha equation (3.247) and use both kBT and the
redshift as variables.
Table 3.1 Free electron
fraction at different photon
temperatures
kBT [eV]
Xe
0.5
1
0.38
0.995
0.36
0.970
0.34
0.819
0.32
0.434
0.30
0.137
0.29
0.067
0.25
0.001

102
3
Thermal History
Fig. 3.5 Numerical solution of the Saha equation (3.247)
In order to accurately calculate Xe, we need to use the full Boltzmann equation
(3.186), which for recombination becomes:
1
a3
d(nea3)
dt
= n(0)
e n(0)
p ⟨σv⟩
#
nHnγ
n(0)
H n(0)
γ
−
nenp
n(0)
e n(0)
p
$
.
(3.250)
We assume nγ = n(0)
γ
and ne = np again. Therefore,
1
a3
d(nea3)
dt
= ⟨σv⟩

nH
mekBT
2πℏ2
3/2
e−ε0/(kBT) −n2
e

.
(3.251)
Introducing now the free electron fraction Xe deﬁned in Eq.(3.244), we get:
dXe
dt = ⟨σv⟩

(1 −Xe)
mekBT
2πℏ2
3/2
e−ε0/(kBT) −X 2
e nb

.
(3.252)
As we did for BBN in Eq.(3.207), we can replace nb with:
nb = 2ηb
(kBT)3
π2ℏ3c3 .
(3.253)

3.10 Recombination and Decoupling
103
Now we need the fundamental physics of the capture process. It is given by:
⟨σv⟩≡α(2) = 9.78 α2 ℏ2
m2ec
 ε0
kBT
1/2
log
 ε0
kBT

,
(3.254)
where α = 1/137 is the ﬁne structure constant. The superscript (2) serves to indicate
that the best way to form hydrogen is not via the capture of an electron in the 1s state,
because this generates a 13.6eV photon which ionises another newly formed H.
The efﬁcient way to form hydrogen is to form it in a excited state. When it relaxes
to the ground state, the photons emitted have not enough energy to ionise other
hydrogen atoms.
For example, an electron captured in the n = 2 state generates a 3.4eV photon.
Subsequently, when the electron falls in the ground state, the hydrogen releases
another 10.2eV photon. Neither of the two photons has sufﬁcient energy for ionising
another hydrogen atom in the ground state.
We now solve numerically Eq.(3.252) together with Eqs.(3.207) and (3.254). We
use the redshift as independent variable:
dXe
dt = dXe
dz
dz
dt = −dXe
dz H(1 + z) ,
(3.255)
and the following Hubble parameter:
H 2
H 2
0
= m0(1 + z)3 + r0(1 + z)4 +  ,
(3.256)
where for z ≈1100 is the matter contribution the dominant one.
Therefore, we rewrite Eq.(3.252) as follows:
dXe
dz = −
⟨σv⟩
H(1 + z)

(1 −Xe)
mekBT
2πℏ2
3/2
e−ε0/(kBT) −X 2
e nb

,
(3.257)
also taking into account that the photon temperature T scales as:
T = T0(1 + z) ,
(3.258)
with T0 = 2.725 K.
In Fig.3.6 we show the numerical solution of the Boltzmann equation (3.257),
compared with the solution of the Saha equation (3.247). Note how the two solutions
are compatible for high redshifts, but that of the Boltzmann equation predicts a
residual free electron fraction of about Xe ≈10−3.
At the same time of recombination the decoupling of photons from electron takes
place. As we anticipated, this happens because very few free electrons remain after

104
3
Thermal History
Fig. 3.6 Solid line: numerical solution of the Boltzmann equation (3.257). Dashed line: solution
of the Saha equation (3.247)
hydrogen formation and therefore photons are free to propagate undisturbed and seen
by us as the CMB.
3.10.1
Decoupling
As we have already mentioned at the beginning of this chapter, roughly speaking
in the expanding universe any kind of reaction stops occurring when its interaction
rate  becomes of the order of H. In the case of photons and electrons, the relevant
process is Thomson scattering, for which:
T = neσTc = XenbσTc ,
(3.259)
where ne is the free-electron number density, which we have written as Xenb because
we have neglected the Helium abundance. The baryon number density can be
expressed as
nb = ρb
mb
= 3H 2
0 b0
8πGmpa3 ,
(3.260)

3.10 Recombination and Decoupling
105
where we have identiﬁed mb = mp since it is the proton mass that dominates the
baryon energy density.
Exercise 3.30 Show that:
T
H = neσTc
H
= 0.0692 hXeb0H0
Ha3
.
(3.261)
As for H, we consider a matter plus radiation universe, for which:
H 2 = H 2
0
m0
a3

1 + aeq
a
	
.
(3.262)
Exercise 3.31 Using the above Hubble parameter show that:
T
H = 113Xe
b0h2
0.02
  0.15
m0h2
1/2 1 + z
1000
3/2 
1 + 1 + z
3600
0.15
m0h2
−1/2
.
(3.263)
The decoupling redshift zdec is deﬁned to be that for which T = H. Note that in
the above equation Xe is a function of the redshift, which we have plotted in Fig.3.6.
On the other hand, Xe drops abruptly during recombination, so that the factor 113 is
easily overcome. For this reason recombination and decoupling take place at roughly
the same time (Fig.3.7).
Now imagine that no recombination takes place, i.e. Xe = 1. The above equation
then gives the decoupling redshift:
1 + zdec = 43
 0.02
b0h2
2/3 m0h2
0.15
1/3
.
(3.264)
This is the freeze-out redshift of the electrons, i.e. eventually photons and electrons do
notinteractanymorebecausetheyaretoodilutedbythecosmologicalexpansion.This
would happen for a redshift 42. This number is important because of the following.
Well after decoupling, ultraviolet light emitted by stars and gas is able to ionise again
hydrogen atoms. This phase is called reionisation. If the latter ocurred for redshifts
smaller than 42, the newly freed electron would not interact with photons because
they are too much diluted by the cosmological expansion. Indeed, reionization takes
place for zreion ≈10, so that the CMB spectrum is poorly affected, as we shall see in
Chap.10.

106
3
Thermal History
Fig. 3.7 Solid line: numerical solution of the ratio T/H of Eq.(3.263). Dashed line: numerical
solution of Eq.(3.257) for Xe
3.11
Thermal Relics
In this section we investigate in some detail the freeze-out and relic abundance of
CDM. In general, with thermal relic one refers to the abundance of a certain species
left over from the annihilation suffered in thermal bath and, after its decoupling, from
the dilution caused by the expansion of the universe. To this purpose, consider the
following process:
X + ¯X ↔l + ¯l ,
(3.265)
where X represents the DM particle and l a lepton. Due to the expansion of the
universe, at a certain point the annihilation of DM is no more efﬁcient and thus
its abundance is ﬁxed. This is precisely what we want to calculate. We could then
put constraints on the cross-section of the above process and on the mass of the
DM particle by measuring the abundance of DM necessary today in order to be in
agreement with the cosmological observations.
We are assuming here that DM is made up of massive particles which were in
thermal equilibrium with the rest of the standard model particles in the primordial
universe, hence the name thermal relics. Moreover, since we are considering CDM,
or more in general particle which decouple from the primordial plasma when non-
relativistic, ours is a calculation of cold relics abundance.

3.11 Thermal Relics
107
The Boltzmann equation for the above process has the following form:
1
a3
d(nX a3)
dt
= ⟨σv⟩

n(0)2
X
−n2
X
	
,
(3.266)
where we have assumed n(0)
l
= nl, because we are in thermal bath with very high
temperature (e.g. larger than 100GeV for WIMPs).
Now we take advantage of the scaling T ∝1/a and deﬁne the following dimen-
sionless quantities:
Y ≡nX (ℏc)3
(kBT)3 ,
Yeq ≡n(0)
X (ℏc)3
(kBT)3
,
x ≡mc2
kBT ,
λ ≡(mc2)3⟨σv⟩
H(m)(ℏc)3 , (3.267)
where H(m) = H(x = 1) is the Hubble parameter corresponding to a thermal
energy kBT = mc2, with m being the mass of the DM particle. Note that, being deep
in the radiation-dominated era, the Hubble parameter scales as follows:
H = H(x = 1)
x2
.
(3.268)
The Boltzmann equation thus becomes:
(kBT)3
(ℏc)3
dY
dx
H(x = 1)
x
= ⟨σv⟩(kBT)6
(ℏc)6

Y 2
eq −Y 2	
,
(3.269)
and ﬁnally
dY
dx = −λ
x2

Y 2 −Y 2
eq
	
(3.270)
In this case Saha equation is simply Y = Yeq and from Eq.(3.107) we know that
Yeq →0 for x →∞, because of the dilution due to the cosmological expansion. On
the other hand, we also expect, as we saw for recombination, that Y attains an asymp-
totic value which we call Y∞and with which we shall calculate the present abundance
of DM. The departure between the Saha equation solution and the Boltzmann equa-
tion solution is the freeze-out and, as we know, it takes place approximately when
 ∼H.
Using Eq.(3.107) in order to express Yeq, we can numerically solve Eq.(3.270).
In order to do this, we set a small initial value x = xi such that Y(xi) = Yeq(xi) and
ﬁx λ to be a constant. In Figs.3.8 and 3.9 we choose xi = 0.01 and λ = 1, 10, 100
for a fermionic DM species.
From Fig.3.8 one can appreciate that Y attains a residual abundance and that, as
expected, the latter is smaller the larger λ is. This happens because for larger values
of λ the interaction is more efﬁcient.
In Fig.3.9 we show the behaviour of the relative difference Y/Yeq −1 in order to
understand when the freeze-out approximately takes place. Of course, the freeze-out

108
3
Thermal History
Fig. 3.8 Numerical solution of Eq.(3.270) for the case of fermionic DM
is not a speciﬁc instant, but depends on a criterion that we choose. For example, from
inspection of Fig.3.9, we see that Y/Yeq −1 at x ≈10 starts to increase with more
steepness and therefore we might establish that xf ≈10. Moreover, this value is very
weakly dependent on λ.
Now, what is the difference between fermionic and bosonic DM? In Fig.3.10 we
plot Y in the bosonic DM (solid lines) and fermionic DM (dashed lines) for λ =
10, 100. As one can see, there are two differences: (i) When x is small the baryonic
abundance is larger than the fermionic one (because of the ±1 at the denominator of
the distribution function) of a factor 4/3; (ii) for large x, the larger λ is, the smaller
becomes the difference between the fermionic and bosonic relic abundances.
We now relate the relic abundance to the DM annihilation cross-section. For x ≫1
we know that Yeq is vanishing, and the Boltzmann equation can be written as:
dY
dx ≈−λ
x2 Y 2 ,
(3.271)
whose solution is:
1
Y∞
−1
Yf
≈λ
xf
.
(3.272)
We have again considered here a constant λ, for simplicity. As we can see from
Fig.3.8, Yf −Y∞> 0 and the difference gets larger the larger λ is. Moreover, xf ≈
10, so that we can simplify

3.11 Thermal Relics
109
Fig. 3.9 Relative difference Y/Yeq −1
Fig. 3.10 Comparison of the numerical solutions of Eq.(3.270) for the cases of bosonic DM (solid
lines) and fermionic DM (dashed lines) and λ = 10 (top two lines) and λ = 100 (bottom two lines,
almost superposed)

110
3
Thermal History
Y∞≈10
λ .
(3.273)
When Y has attained Y∞, the abundance of particle is ﬁxed and their number density
starts to be diluted as nX ∝a−3. Therefore, we can can write down the present-time
density as follows:
ρX 0 = n1ma3
1
a3
0
= mY∞
(kBT1)3
(ℏc)3
a3
1
a3
0
= 10m
λ
(kBT0)3
(ℏc)3
a3
1T 3
1
a3
0T 3
0

.
(3.274)
We have introduced here the photon temperature (the only one we can measure).
The ratio between parenthesis is not just equal to 1. We have seen an example of this
discrepancy when we calculated the photon-neutrinos temperatures ratio. The reason
is that not all along the cosmological evolution T decays as the inverse scale factor.
When there are processes such as electron-positron annihilation, more photons are
injected in the thermal bath and the temperature scales in a milder way than 1/a.
It is now time to tackle more seriously the issue of the effective numbers of
relativistic degrees of freedom.
3.11.1
The Effective Numbers of Relativistic Degrees
of Freedom
Let T be the photon temperature, which we always use as reference since it is the
only one we can measure, from CMB.
In Eq.(3.223), we wrote the energy density of all the relativistic species in the
following way:
ε = π2(kBT)4
30(ℏc)3 g∗,
(3.275)
where, actually g∗= g∗(T) because when kBT drops below the mc2 of a species, this
becomes non-relativistic and is removed from the above equation. Thus g∗varies,
but very rapidly close to the thresholds of the mass energies. Far from those, g∗it is
practically constant.
In Fig.3.11 we plot g∗calculated from Eqs.(3.103) and (3.223) for the species of
Table 3.2. The residual non-vanishing value of g∗(T) for low temperatures is due to
the massless species, i.e. photons and neutrinos.
Note that this plot is just an illustrative example, because it employs Eq.(3.103)
during the entire evolution, i.e. it assumes thermal equilibrium all the time, and,
moreover, the QCD phase transition at 200MeV and the difference between photon
and neutrino temperature after electron-positron annihilation at 0.5MeV have been
put “by hand”. The correct calculation should employ the energy density obtained
from the solutions of the Boltzmann equations of the various species, which correctly
track the evolutions when  ∼H, i.e. out of equilibrium.

3.11 Thermal Relics
111
Fig. 3.11 Evolution of g∗calculated from Eqs.(3.103) and (3.223) for the species of Table 3.2. Note
the QCD phase transition at 200MeV and the difference between photon and neutrino temperature
after electron-positron annihilation at 0.5MeV
Table 3.2 The standard model particles, with their mass, spin and degeneracies gs
Particle
Mass
Spin
gs
Quarks
t, ¯t
173GeV
1
2
2 · 2 · 3 = 12
b, ¯b
4GeV
c, ¯c
1GeV
s, ¯s
100MeV
d, ¯d
5MeV
u, ¯u
2MeV
Gluons
gi
0GeV
1
8 · 2 = 16
Leptons
τ±
1777MeV
1
2
2 · 2 = 4
μ±
106MeV
e±
511keV
ντ, ¯ντ
<0.6eV
1
2
2 · 1 = 2
νμ, ¯νμ
<0.6eV
νe, ¯νe
<0.6eV
Gauge Bosons
W +
80GeV
1
3
W −
80GeV
Z0
91GeV
γ
0
2
Higgs Bosons
H 0
125GeV
0
1

112
3
Thermal History
The effective numbers of relativistic degrees of freedom gets two contributions.
One from the relativistic particles that are in thermal equilibrium with the photons:
gtherm
∗
≡

i=bosons
gi + 7
8

i=fermions
gi ,
(3.276)
and another from the relativistic particles that are no more in thermal equilibrium
with the photons:
gdec
∗
≡

i=bosons
gi
T 4
i
T 4 + 7
8

i=fermions
gi
T 4
i
T 4 .
(3.277)
The latter are basically neutrinos only.
Why do we insist on relativistic species? Because, as we showed, these are the
only one which contribute to the entropy density s:
s = 2π2k4
BT 3
45(ℏc)3 g∗S
(3.278)
where g∗S is the effective number of degrees of freedom for the entropy. Now, also
to g∗S contribute species which are in thermal equilibrium with the photons and for
which:
gtherm
∗S
= gtherm
∗
=

i=bosons
gi + 7
8

i=fermions
gi ,
(3.279)
and species that are no more in thermal equilibrium with the photons and for which:
gdec
∗S =

i=bosons
gi
T 3
i
T 3 + 7
8

i=fermions
gi
T 3
i
T 3 ̸= gdec
∗
.
(3.280)
Because of the last inequality, due to the different scaling of s and ε with the tem-
perature, we expect g∗̸= g∗S.
Now, sa3 is a very useful quantity since it is conserved, as we showed earlier. When
a species becomes non-relativistic, its contribution to s is exponentially suppressed
as exp(−mc2/kBT). Therefore, the non-relativistic species passes its entropy to rest
of the thermal bath such that sa3 does not change.
What is the value of g∗and of g∗S? We need to recover our knowledge of particle
physics in Table 3.2.
Summing up all the contributions we have from bosons and fermions:
gbosons = 28 ,
gfermions = 90 ,
(3.281)
so that
g∗= 28 + 7
8 · 90 = 106.75 .
(3.282)

3.11 Thermal Relics
113
When the temperature drops below one species mass, this becomes non-relativistic
and then its gs does not contribute anymore to the above sum. Note that before
neutrino decoupling g∗= g∗S.
3.11.2
Relic Abundance of DM and the WIMP Miracle
On the basis of the discussion of the previous subsection, we can therefore write
Eq.(3.274) as follows:
X 0 = ρX 0
ρcr,0
= 10m
λρcr,0
(kBT0)3
(ℏc)3
g∗S(T0)
g∗S(m) ,
(3.283)
where g∗S(m) is the number of effective degrees of freedom in entropy for a thermal
energy equal to the DM particle mass. This must be certainly larger than 1MeV,
roughly when neutrino decoupling takes place, therefore g∗= g∗S. Moreover,
g∗S(T0) = 2 + 7
8 · 6 ·
Tν
T0
3
= 2 + 7
8 · 6 · 4
11 = 3.91 ,
(3.284)
and so we can rewrite Eq.(3.283) as follows:
X 0 = 8πGH(m)xf(kBT0)3
3H 2
0 m2c6⟨σv⟩
g∗S(T0)
g∗(m) ,
(3.285)
where we have also made λ explicit. The Hubble parameter H(m) can be written as:
H 2(m) = 8πG
3c2 g∗(m)π2
30
(mc2)4
(ℏc)3 ,
(3.286)
so that we have ﬁnally:
X 0h2 ≈0.331
xf
√g∗(m)
10−37 cm2
⟨σv/c⟩
≈0.331
xf
√g∗(m)
2.57 × 10−10 GeV−2
⟨σv/c⟩
.
(3.287)
As we saw, reasonable values are xf ≈10 and g∗≈100. A cross-section of the order
of G2
F ∼10−10 GeV−2 gives the right order of magnitude of the present abundance
of CDM. This coincidence is known as WIMP miracle.6
Relic Abundance of Baryons
The very same result of Eq.(3.287) can be used for the annihilation of baryons:
6One can think of different cross sections and thus ﬁnd CDM candidates lighter than WIMPs. See
e.g. Profumo (2017). This possibility is also called WIMPless miracle.

114
3
Thermal History
b + ¯b ↔γ + γ .
(3.288)
Let us consider only nucleons, i.e. protons and neutrons, since their mass is the
dominant one for the baryonic energy density. The annihilation cross-section is of
the order of:
⟨σv/c⟩≈
(ℏc)2
(mπc2)2 ,
(3.289)
where mπc2 ≈140MeV is the mass of the meson π, which can be thought as the
mediator of the strong interaction among nucleons. Substituting into Eq.(3.287) we
get:
b0h2 ≈10−11 ,
(3.290)
i.e. a value many orders of magnitude below the observed one and that thus constitutes
a compelling argument for the necessity of baryogenesis.
Focusing on electrons and positrons, the annihilation cross section is of the order
⟨σv/c⟩≈α2(ℏc)2
(mec2)2 ≈204 GeV−2 ,
(3.291)
and from Eq.(3.287) we get:
e0h2 ≈10−12 .
(3.292)
References
Ade, P.A.R., et al.: Planck 2015 results. XIII. Cosmological parameters. Astron. Astrophys. 594,
A13 (2016a)
Berestetskii, V.B., Lifshitz, E.M., Pitaevskii, L.P.: Quantum Electrodynamics Volume 4 of Course
of Theoretical Physics. Pergamon Press, Oxford (1982)
Bernstein, J.: Kinetic Theory in the Expanding Universe. Cambridge University Press, Cambridge
(1988)
Camarena, D., Marra, V.: Cosmological constraints on the radiation released during structure for-
mation. Eur. Phys. J. C 76(11), 644 (2016)
Chluba, J.: Science with CMB spectral distortions. In Proceedings, 49th Rencontres de Moriond
on Cosmology: La Thuile, Italy, March 15–22, 2014 (pp. 327–334). (2014)
Chluba, J., Sunyaev, R.A.: The evolution of CMB spectral distortions in the early Universe. Mon.
Not. Roy. Astron. Soc. 419, 1294–1314 (2012)
Dodelson, S.: Modern Cosmology. Academic Press, Amsterdam (2003)
Dodelson, S., Widrow, L.M.: Sterile-neutrinos as dark matter. Phys. Rev. Lett. 72, 17–20 (1994)
Fixsen, D.J., Cheng, E.S., Gales, J.M., Mather, J.C., Shafer, R.A., Wright, E.L.: The cosmic
microwave background spectrum from the full COBE FIRAS data set. Astrophys. J. 473, 576
(1996)
Gell-Mann, M., Ramond, P., Slansky, R.: Complex Spinors and Uniﬁed Theories. Conf. Proc.
C790927, 315–321 (1979)
Grad, H.: Principles of the kinetic theory of gases. Thermodynamik der Gase/Thermodynamics of
Gases, pp. 205–294. Springer, Berlin (1958)

References
115
Kolb, E.W., Turner, M.S.: The early Universe. Front. Phys. 69, 1–547 (1990)
Lesgourgues, J., Pastor, S.: Massive neutrinos and cosmology. Phys. Rept. 429, 307–379 (2006)
Peebles, P.J.E.: Recombination of the primeval plasma. Astrophys. J. 153, 1 (1968)
Profumo, S.: An Introduction to Particle Dark Matter. Advanced textbooks in physics. World Sci-
entiﬁc, Singapore (2017)
Profumo, S., Sigurdson, K., Kamionkowski, M.: What mass are the smallest protohalos? Phys. Rev.
Lett. 97, 031301 (2006)
Wagoner, R.V.: Big bang nucleosynthesis revisited. Astrophys. J. 179, 343–360 (1973)
Wilczek, F.: Particle physics: a weighty mass difference. Nature 520, 303–304 (2015)

Chapter 4
Cosmological Perturbations
Bez truda ne vynex rybku iz pruda
(Without effort, you can’t pull a ﬁsh out of the pond)
Russian proverb
As we have seen in the previous Chapters, the assumption of homogeneous and
isotropic universe is very useful and productive, but it is reliable only on very large
scales (above 200Mpc). Its shortcomings become evident when we start to investi-
gate how structures, such as galaxies and their clusters, form, since these are huge
deviations from the cosmological principle.
In this Chapter we address small deviations from the cosmological principle, con-
sidering perturbations in the FLRW metric. This is the starting point of the incredibly
difﬁcult task of understanding how structures form in an expanding universe, which
ultimately needs powerful machines and numerical simulations.
The material for this Chapter is mainly drawn from the textbooks (Dodelson
2003; Mukhanov 2005; Weinberg 2008) and from the papers/reviews (Bardeen 1980;
Kodama and Sasaki 1984; Mukhanov et al. 1992; Ma and Bertschinger 1995).
We assume hereafter K = 0, both for simplicity and because we have seen that
there is strong observational evidence of a spatially ﬂat universe. From this Chapter
on, we also start to adopt natural ℏ= c = 1 units.
4.1
From the Perturbations of the FLRW Metric
to the Linearised Einstein Tensor
Let ¯gμν be the FLRW metric, and write it using the conformal time:
¯gμν = a2(η)(−dη2 + δi jdxidx j) .
(4.1)
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_4
117

118
4
Cosmological Perturbations
This metric describes the background spacetime, or manifold. However, the back-
ground spacetime is ﬁctitious, in the sense that we are now considering deviations
from homogeneity and isotropy and therefore the actual physical spacetime is a
different manifold described by the metric gμν. Deﬁning the difference:
δgμν(x) = gμν(x) −¯gμν(x) ,
(4.2)
at a certain spacetime coordinate x is an ill-posed statement because gμν and ¯gμν
are tensors deﬁned on different manifolds and x is a coordinate deﬁned through
different charts. Even if we embed the two manifolds in a single one, still the dif-
ference between two tensors evaluated at different points is an ill-deﬁned operation.
Therefore, in order to make Eq.(4.2) meaningful, we need an extra ingredient: a
map which identiﬁes points of the background manifold with those of the physical
manifold. This map is called gauge, is arbitrary and allows us to use a ﬁxed coordi-
nate system (a chart) in the background manifold also for the points in the physical
manifold. In other words, we shall still use conformal or cosmic time plus comoving
spatial coordinates even when describing perturbative quantities. This property leads
to the so-called problem of the gauge, which we will brieﬂy discuss later. For more
details on these topics, see Stewart (1990) and Malik and Matravers (2013).
Metric gμν has in general 10 independent components that, in a generic gauge,
we write down in the following form:
gμν = a2(η)
−[1 + 2ψ(η, x)]
wi(η, x)
wi(η, x)
δi j[1 + 2φ(η, x)] + χi j(η, x)

,
δi jχi j = 0 ,
(4.3)
where ψ, φ, wi, χi j (i, j = 1, 2, 3) are functions of the background spacetime
coordinates xμ, in our case conformal time and comoving spatial coordinates.1 From
now on we omit their explicit functional dependence wherever possible, in order to
keep a lighter notation.
As we mentioned above, the liberty of choosing a gauge allows us to ﬁx a coordi-
natesysteminthebackgroundmanifold.Thelattershallbeoneinwhichhomogeneity
and isotropy are manifest, of course. Therefore, we could use any time parametrisa-
tion, though we will employ conformal time the most because it has the important
physical meaning of the comoving particle horizon, and as for the spatial coordinates
we shall always choose the comoving ones for which at any given and ﬁxed time the
background spatial metric is Euclidean, i.e. δi jdxidx j. For this reason, the perturba-
tions in Eq.(4.3) can be regarded as usual 3-vectors, deﬁned from the rotation group
SO(3).
1The reason why ψ and φ are multiplied by 2 in the perturbed metric is just for pure future conve-
nience of calculation.

4.1 From the Perturbations of the FLRW Metric to the Linearised Einstein Tensor
119
Let us elaborate more on this point. Consider the coordinate transformation:
∂xμ
∂xν′ =
⎛
⎝
1 0
0 Ri j
⎞
⎠,
(4.4)
where Ri j is a rotation. By deﬁnition, a rotation is characterised by RT R = I, i.e.
the transposed matrix is also the inverse, hence δkl Rki Rl j = δi j. Applying this trans-
formation to metric (4.3) we get:
g′
00 = g00 ,
g′
0i = Rk
ig0k ,
g′
i j = Rk
i Rl
jgkl ,
(4.5)
and hence, recalling that Rki Rl jδkl = δi j, we ﬁnally ﬁnd:
ψ′ = ψ ,
w′
i = Rk
iwk ,
φ′ = φ ,
χ′
i j = Rk
i Rl
jχkl .
(4.6)
Therefore, ψ and φ are two 3-scalars, wi (i = 1, 2, 3) is a 3-vector, χi j is a 3-tensor
(i, j = 1, 2, 3) and the indices of wi and χi j are raised and lowered by δi j. Note that
the 6 components of χi j are not independent because δi jχi j = 0. In other words,
χi j is traceless and we have already put in evidence the spatial trace of the metric
through φ. One does this also because the spatial intrinsic curvature depends only
on φ, not on χi j.2
Now, if the gauge chosen in Eq.(4.3) is such that:
|¯gμν| ≫|δgμν| ,
(4.7)
then we are dealing with perturbations. They are considered small, or linear, or
at ﬁrst-order if we neglect powers with exponent larger than one in the quantities
themselves and in their derivatives. Not only, also combinations among different
perturbations are neglected. For example, ψ2, φwi, wiχi j, φ′φ and so on are all
second order perturbations, and therefore negligible. Let us see how this works when
computing the Christoffel symbols for metric (4.3). Substituting the decomposition
(4.2) into the deﬁnition of Christoffel symbol we have:
μ
νρ = 1
2gμσ 
gσν,ρ + gσρ,ν −gνρ,σ
	
= 1
2 ¯gμσ 
¯gσν,ρ + ¯gσρ,ν −¯gνρ,σ
	
1
2 ¯gμσ 
δgσν,ρ + δgσρ,ν −δgνρ,σ
	
+ 1
2δgμσ 
¯gσν,ρ + ¯gσρ,ν −¯gνρ,σ
	
,
(4.8)
where the comma denotes the usual partial derivative. Note that we have assumed the
same decomposition of Eq.(4.2) also for the covariant components of the metric and
neglected terms such as δgμσδgσν,ρ, i.e. perturbative quantities multiplied by their
2One can guess this by simply noting that the spatial curvature is a 3-scalar and one cannot form
any 3-scalar at ﬁrst-order from χi j since it is traceless.

120
4
Cosmological Perturbations
derivatives. It is important to realise that δgμσ is not simply δgμσ with indices raised
by ¯gμσ.
Exercise 4.1 Since
gμρgρν = δμ
ν ,
¯gμρ ¯gρν = δμ
ν ,
(4.9)
because both are metrics, using Eq.(4.2) show that
δgμν = −¯gμρδgρσ ¯gνσ
(4.10)
In particular, in our scenario of cosmological perturbations, we shall write the total
metric, using the conformal time, as follows:
gμν = a2(ημν + hμν) .
(4.11)
Hence, the perturbed contravariant metric is the following:
δg00 = −1
a2 h00
δg0i = 1
a2 δilh0l = 1
a2 h0i ,
δgi j = −1
a2 δilhlmδmj = −1
a2 hi j ,
(4.12)
where we have used our hypothesis that the indices of hi j are raised by δi j and the
property hi j = hi j.
Do not be confused by the fact that δgμν is the perturbed covariant metric but δgμν
is not the contravariant perturbed metric.
One does raise the indices of the contravariant perturbed metric with the back-
ground one, but a minus sign must be taken into account. This fact is not dissimilar
from considering the Taylor expansion
1
1 + x = 1 −x + O(x2) .
(4.13)
4.1.1
The Perturbed Christoffel Symbols
It is clear from Eq.(4.8) that we can decompose the afﬁne connection as follows:
μ
νρ = ¯μ
νρ + δμ
νρ ,
(4.14)
where the barred one is computed from the background metric only.

4.1 From the Perturbations of the FLRW Metric to the Linearised Einstein Tensor
121
Exercise 4.2 Show that
δμ
νρ = 1
2 ¯gμσ 
δgσν,ρ + δgσρ,ν −δgνρ,σ −2δgσα ¯α
νρ
	
(4.15)
The background Christoffel symbols were calculated already in Chap.2 but for
the FLRW metric written in the cosmic time.
Exercise 4.3 Show that the only non-vanishing background Christoffel symbols are:
¯0
00 = a′
a ,
¯0
i j = a′
a δi j ,
¯i
0 j = a′
a δi
j ,
(4.16)
where the prime denotes derivation with respect to the conformal time. One can make
the calculation directly from the FLRW metric written in the conformal time or use
the results already found in Eq.(2.29) for the FLRW metric written in the cosmic
time and use the transformation relation for the Christoffel symbol:
¯′μ
νρ = ¯α
βγ
∂xβ
∂x′ν
∂xγ
∂x′ρ
∂x′μ
∂xα + ∂x′μ
∂xσ
∂2xσ
∂x′ν∂x′ρ ,
(4.17)
where the primed coordinates are in the conformal time and hence:
∂x′0
∂x0 = 1
a ,
∂x′l
∂xm = δl
m ,
(4.18)
being the other cases vanishing. It is a good and reassuring exercise to do in both
ways and check that the result is the same.
A moment of reﬂection. First of all, we shall use mostly the conformal time
throughout these notes since, as we saw earlier, it represents the comoving particle
horizon and it will allow us to clearly distinguish the evolution of super-horizon
(hence causally disconnected) scales from sub-horizon ones.
On the other hand, the most economic way to compute the linearised Einstein
equations is using the cosmic time and stopping to the calculation of the Ricci tensor
by considering the Einstein equations in the form
Rμν = 8πG

Tμν −1
2gμνT

,
(4.19)
as done e.g. in Weinberg (2008). It is the most economic way because in the cosmic
time we have only 2 non-vanishing Christoffel symbols, whereas in the conformal

122
4
Cosmological Perturbations
time we have three, and because we are spared to compute the perturbed Ricci scalar.
Once done this calculation, it is straightforward to come back to the conformal time.
In the following we shall anyway go on using the conformal time, because it
is a good workout. Compare the results found here with those in Weinberg (2008)
Chap.5 using the tensorial properties:
Rμν = ˜Rρσ
∂˜xρ
∂xμ
∂˜xσ
∂xν ,
hμν = ˜hρσ
∂˜xρ
∂xμ
∂˜xσ
∂xν ,
(4.20)
where the quantities with tilde are in the cosmic time. Since the change from cosmic
to conformal time does not affect the spatial coordinates, we have that:
R00 = ˜R00a2 ,
R0i = ˜R0ia ,
Ri j = ˜Ri j ,
(4.21)
and similarly for hμν. With this map, we can check the results that we are going to
ﬁnd here with those in Weinberg (2008). Mind that in Weinberg (2008) the Ricci
tensor is deﬁned with the opposite sign with respect to ours here.
Exercise 4.4 We are now in the position of writing the perturbed Christoffel sym-
bols. We do so without leaving hμν explicit from Eq.(4.3). Find that:
δ0
00 = −1
2h′
00 ,
δ0
i0 = −1
2

h00,i −2Hh0i
	
,
(4.22)
δi
00 = h′
i0 + Hhi0 −1
2h00,i ,
(4.23)
δ0
i j = −1
2

h0i, j + h0 j,i −h′
i j −2Hhi j −2Hδi jh00
	
,
(4.24)
δi
j0 = 1
2h′
i j + 1
2

hi0, j −h0 j,i
	
,
(4.25)
δi
jk = 1
2

hi j,k + hik, j −h jk,i −2Hδ jkhi0
	
.
(4.26)
The prime denotes derivative with respect to the conformal time. The indices might
seem unbalanced, but we have used the fact that hi0 and hi j are 3-tensors with respect
to the metric δi j and hence, for example, hi 0 = hi0. Recall that
H ≡a′
a ,
(4.27)
i.e. H is the Hubble factor written in conformal time.

4.1 From the Perturbations of the FLRW Metric to the Linearised Einstein Tensor
123
4.1.2
The Perturbed Ricci Tensor and Einstein Tensor
With this result we are going to compute the components of the perturbed Ricci
tensor. Recall that this is deﬁned as:
Rμν = ρ
μν,ρ −ρ
μρ,ν + ρ
μνσ
ρσ −ρ
μσσ
νρ ,
(4.28)
and hence, when substituting Eq.(4.14), we get
Rμν = ¯ρ
μν,ρ −¯ρ
μρ,ν + ¯ρ
μν ¯σ
ρσ −¯ρ
μσ ¯σ
νρ
+δρ
μν,ρ −δρ
μρ,ν + ¯ρ
μνδσ
ρσ + δρ
μν ¯σ
ρσ −¯ρ
μσδσ
νρ −δρ
μσ ¯σ
νρ ,
(4.29)
by neglecting second order terms in the connection. It is clear that we can expand
also the Ricci tensor as:
Rμν = ¯Rμν + δRμν ,
(4.30)
and we compute now its perturbed components.
Exercise 4.5 After opening up all the sums, show that:
δR00 = δl
00,l −δl
0l,0 −Hδl
0l + 3Hδ0
00 ,
(4.31)
and substituting the previous results, one gets:
δR00 = −1
2∇2h00 −3
2Hh′
00 + h′
k0,k + Hhk0,k −1
2

h′′
kk + Hh′
kk
	
.
(4.32)
Here we have deﬁned δi j∂i∂j ≡∇2 as the Laplacian in comoving coordinates. Note
that hkk = δlmhlm, i.e. in the present instance repeated indices are summed even if
both covariant or contravariant.
Exercise 4.6 Of course, repeat the previous exercise also for the other components.
Find that:
δR0i = −Hh00,i −1
2

∇2h0i −hk0,ik
	
+

a′′
a + H2

h0i −1
2

h′
kk,i −h′
ki,k
	
,
(4.33)

124
4
Cosmological Perturbations
and
δRi j = 1
2h00,i j + H
2 h′
00δi j +

H2 + a′′
a

h00δi j
−1
2

∇2hi j −hki,kj −hkj,ki + hkk,i j
	
+ 1
2h′′
i j + Hh′
i j +

H2 + a′′
a

hi j
+H
2 h′
kkδi j −Hhk0,kδi j −1
2(h′
0i, j + h′
0 j,i) −H(h0i, j + h0 j,i) .(4.34)
In the same way we decomposed metric (4.2), we decompose the Einstein tensor.
We shall work with mixed indices:
Gμ
ν = gμρRρν −1
2δμ
ν R = ¯gμρ ¯Rρν −1
2δμ
ν ¯R + ¯gμρδRρν + δgμρ ¯Rρν −1
2δμ
νδR ,
(4.35)
where ¯Gμν = ¯Rμν −1
2δμν ¯R is the background Einstein tensor and depends purely
from the background metric ¯gμν whereas
δGμ
ν = ¯gμρδRρν + δgμρ ¯Rρν −1
2δμ
νδR ,
(4.36)
is the linearly perturbed Einstein tensor, which depends from both ¯gμν and hμν.
Exercise 4.7 Compute the perturbed Ricci scalar:
δR = gμν Rμν = ¯gμνδRμν + δgμν ¯Rμν .
(4.37)
Expand the above expression and use formula (4.10) in order to ﬁnd:
δR = −1
a2 δR00 + 1
a2 δi jδRi j −a2hρσ ¯gρμ ¯gσν ¯Rμν ,
(4.38)
and then, recalling that the background Ricci tensor is:
¯R00 = 3

H2 −a′′
a

,
¯Ri j = δi j

H2 + a′′
a

,
(4.39)
one can write:
δR = −1
a2 δR00 −3
a2 h00

H2 −a′′
a

+ 1
a2 δi jδRi j −1
a2 hkk

H2 + a′′
a

,
(4.40)

4.1 From the Perturbations of the FLRW Metric to the Linearised Einstein Tensor
125
Substituting the formulae for the perturbed Ricci tensor, one ﬁnds:
a2δR = ∇2h00 + 3Hh′
00 + 6a′′
a h00 −2h′
k0,k −6Hhk0,k
+h′′
kk + 3Hh′
kk −∇2hkk + hkl,kl .
(4.41)
Thesecondlinerepresentsa2δR(3),i.e.theintrinsicspatialperturbedcurvaturescalar.
Now, let us calculate the mixed components of the perturbed Einstein tensor.
Exercise 4.8 Show that:
2a2δG0
0 = −6H2h00 + 4Hhk0,k −2Hh′
kk + ∇2hkk −hkl,kl
(4.42)
and
2a2δG0
i = 2Hh00,i + ∇2h0i −hk0,ki + h′
kk,i −h′
ki,k
(4.43)
and
2a2δGi
j =

−4a′′
a h00 −2Hh′
00 −∇2h00 + 2H2h00 −2Hh′
kk + ∇2hkk
−hkl,kl + 2h′
k0,k + 4Hhk0,k −h′′
kk

δi
j + h00,i j −∇2hi j + hki,kj
+hkj,ki −hkk,i j + h′′
i j + 2Hh′
i j −(h′
0i, j + h′
0 j,i) −2H(h0i, j + h0 j,i). (4.44)
Now we turn to the right hand side of the Einstein equations, i.e. the energy-
momentum tensor.
4.2
Perturbation of the Energy-Momentum Tensor
In the following we shall use mostly the energy-momentum tensor deﬁned through
the distribution function and its perturbation. However, let us see how to perturb the
background, perfect ﬂuid energy-momentum tensor. This was introduced as:
¯Tμν = ( ¯ρ + ¯P)¯uμ ¯uν + ¯P ¯gμν ,
(4.45)
as the tensor describing a ﬂuid with no dissipation, i.e. constant entropy along the
ﬂow.

126
4
Cosmological Perturbations
Exercise 4.9 Compute ¯uν∇ν ¯uμ, demand its vanishing and check via the second law
of thermodynamics that this corresponds to a constant entropy.
Let us rewrite ¯Tμν as follows:
¯Tμν = ¯ρ¯uμ ¯uν + ¯P ¯θμν ,
¯θμν ≡¯gμν + ¯uμ ¯uν .
(4.46)
The tensor ¯θμν acts as a projector on the hypersurface orthogonal to the four-velocity.
Exercise 4.10 Show that ¯θμν ¯uμ = 0.
This is an example of 3+1 decomposition, which is particularly useful when we
study a ﬂuid ﬂow.
Exercise 4.11 Show that:
¯ρ = ¯Tμν ¯uμ ¯uν ,
3 ¯P = ¯Tμν ¯θμν ,
T ≡¯gμν ¯Tμν = −ρ + 3P ,
(4.47)
i.e. the ﬂuid density is the projection of the energy-momentum tensor along the
4-velocity of the ﬂuid element and the pressure is the projection of the energy-
momentum tensor on the 3-hypersurface orthogonal to the four-velocity.
The most general energy-momentum tensor, which also includes the possibility
of dissipation, can be then written by straightforwardly generalising Eq.(4.46), i.e.
Tμν = ρuμuν + qμuν + qνuμ + (P + π)θμν + πμν
(4.48)
where qμ is the heat transfer contribution, satisfying qμuμ = 0 and thus contributing
with 3 independent components; πμν is the anisotropic stress, it is traceless and
satisﬁes πμνuμ = 0, hence providing 5 independent components. The trace of πμν
is π, it is called bulk viscosity and has been put in evidence together with the
pressure. For more detail about dissipative processes in cosmology and the above
decomposition of the energy-momentum tensor, see the review (Maartens 1996).
The anisotropic stress πμν is not necessarily related to viscosity, but can exist for
relativistic species such as photons and neutrinos because of the quadrupole moments
of their distributions, as we shall see later. On the other hand, heat ﬂuxes and bulk
viscosity are related to dissipative processes, and we neglect them in these notes
starting from the next section.
Now we consider the energy-momentum tensor of Eq.(4.48) as made up of a
background contribution plus a linear perturbation, i.e. we expand

4.2 Perturbation of the Energy-Momentum Tensor
127
ρ = ¯ρ + δρ(η, x) ,
P = ¯P + δP(η, x) ,
uμ = ¯uμ + δuμ(η, x) ,
(4.49)
which are the physical density, pressure and four-velocity, which, remember, depend
on the background quantities because of our choice of a gauge. The barred quantities
depend only on η, since they are deﬁned on the FLRW background. Heat ﬂuxes,
bulk viscosity and anisotropic stresses are purely perturbed quantities.3 Therefore,
we have:
Tμν = ¯Tμν + δρ¯uμ ¯uν + ¯ρδuμ ¯uν + ¯ρ¯uμδuν + qμ ¯uν + qν ¯uμ + ¯θμν(δP + π) + ¯Pδθμν + πμν ,
(4.50)
where one can straightforwardly identify the perturbed energy-momentum tensor
and where
δθμν = δgμν + δuμ ¯uν + ¯uμδuν .
(4.51)
Now, recall that the background four-velocity satisﬁes the normalisation:
¯gμν ¯uμ ¯uν = −1 .
(4.52)
Let us choose a frame in which to make explicit the components of the energy-
momentum tensor. Of course, we use comoving coordinates, for which one has
¯ui = 0. From Eq.(4.52) we have then
a2(¯u0)2 = 1 ,
(4.53)
and we choose the positive solution ¯u0 = 1/a, which implies u0 = −a.4 When we
choose these coordinates, the relations qμuμ = πμνuμ = 0 imply that q0 = πμ0 = 0,
i.e. the heat ﬂux and the anisotropic stress have only spatial components.
Exercise 4.12 Calculate the components of the energy-momentum tensor (4.50).
Show that:
T00 = ¯ρ(1 + δ)a2 −2a( ¯ρ + ¯P)δu0 + ¯Pδg00 ,
(4.54)
T0i = −a( ¯ρ + ¯P)δui −aqi + ¯Pδg0i ,
(4.55)
Ti j = ( ¯P + δP + π)a2δi j + ¯Pδgi j + πi j ,
(4.56)
where we have introduced one of the main characters of these notes, the density
contrast:
δ ≡δρ
¯ρ
(4.57)
3Bulk viscosity is compatible with the cosmological principle and can be contemplated also at
background level. It plays a central role in the so-called bulk viscous cosmology, see Zimdahl
(1996).
4It amounts to choose that the conformal time and the ﬂuid element proper time ﬂow in the same
direction.

128
4
Cosmological Perturbations
The density contrast is very important because describes how structure formation
begins. Note how the presence of perturbations in the four-velocity gives rise to
mixed time-space components in the energy-momentum tensor, i.e. the breaking of
homogeneity and isotropy allows for extra ﬂuxes beyond the Hubble one.
Note that the total four-velocity also satisﬁes a normalisation relation, with respect
to the total metric, i.e.
gμνuμuν = −1 .
(4.58)
If we expand this relation up to the ﬁrst order we ﬁnd:
¯gμν ¯uμ ¯uν + δgμν ¯uμ ¯uν + 2¯gμνδuμ ¯uν = −1 .
(4.59)
Using Eq.(4.52) and ¯ui = 0, we ﬁnd that:
δg00 + 2¯g00aδu0 = 0 ,
(4.60)
and thus we can relate the metric perturbation h00 to δu0 as follows:
δu0 = h00
2a
(4.61)
Care is needed when we want to compute the covariant components of the perturbed
four-velocity δuμ. These are not simply δuμ = ¯gμνδuν. It is the same care we had to
apply when considering the relation between δgμν and hμν. So, let us deﬁne:
δui = avi
(4.62)
with vi components of a 3-vector, i.e. its index is raised by δi j so that vi = vi. Let us
compute now the components δui. We must start from the covariant expression for
the total four velocity, i.e.
¯uμ + δuμ = uμ = gμνuν = gμν(¯uν + δuν) ,
(4.63)
and expanding up to ﬁrst order, we get
¯uμ + δuμ = ¯gμν ¯uν + ¯gμνδuν + δgmuν ¯uν .
(4.64)
Equating order by order we obtain ¯uμ = ¯gμν ¯uν, as expected, and
δuμ = ¯gμνδuν + δgμν ¯uν
(4.65)

4.2 Perturbation of the Energy-Momentum Tensor
129
so that
δuμ = ¯gμνδuν −¯gμρδgρν ¯uν
(4.66)
So, there is an extra term δgμν ¯uν. This comes from the fact that ¯gμν raises or lowers
indices for the background quantities only whereas gμν raises or lowers indexes for
the full quantities only, and δuμ is neither. From Eqs.(4.65) and (4.66) we have that
δu0 = h00a
2
,
aδui = vi −1hi0
(4.67)
Exercise 4.13 Rewrite the components of the energy-momentum tensor as:
T00 = ¯ρ(1 + δ)a2 −¯ρa2h00 ,
(4.68)
T0i = −a2( ¯ρ + ¯P)vi −aqi + ¯Pa2h0i ,
(4.69)
Ti j = ( ¯P + δP + π)a2δi j + ¯Pa2hi j + πi j ,
(4.70)
In order to calculate the mixed components we use the standard relation:
T μ
ν = gμρTρν = ¯gμρ ¯Tρν + ¯gμρδTρν + δgμρ ¯Tρν .
(4.71)
Exercise 4.14 Compute the mixed components of the energy-momentum tensor.
Show that:
T 0
0 = −¯ρ(1 + δ) ,
(4.72)
T 0
i =

¯ρ + ¯P
	
vi + a−1qi ,
(4.73)
T i
0 = −

¯ρ + ¯P
	
(vi −h0i) −a−1qi ,
(4.74)
T i
j = δi
j( ¯P + δP + π) + πi
j ,
(4.75)
where we have stipulated that δilπlja−2 = πi j.
In the following we shall mainly use, especially for photons and neutrinos, the
energy-momentum tensor computed from kinetic theory, i.e. Equation(3.41):
T μ
ν =

d3p
(2π)3
pμ pν
p0
f ,
(4.76)
in which the distribution function is also perturbed:

130
4
Cosmological Perturbations
f = ¯f + F
(4.77)
thus allowing to deﬁne a perturbed energy-momentum tensor as follows:
δT μ
ν =

d3p
(2π)3
pμ pν
p0 F ,
(4.78)
The momentum used here is the proper one which, recall, has the metric embedded
in its deﬁnition so that:
pi = pi ,
p2 = δi j pi p j ,
E = p0 ,
p0 = −E .
(4.79)
These relations provide directly the mass-shell one E2 = p2 + m2 from gμν PμPν =
−m2. Note that we are assuming g0i = 0, also at perturbative level thanks to gauge
freedom, otherwise the relations above would be incorrect since the spatial metric
would not be gi j but gi j −g0ig0 j/g00. See Landau and Lifschits (1975) for a nice
explanation of this fact.
Then, from the above deﬁnition of perturbed energy-momentum, we have:
δT 0
0 = −

d3p
(2π)3 E(p)F = −δρ ,
(4.80)
which makes sense, and is consistent with Eq.(4.72), because we are weighting the
particle energy with the perturbed distribution function. The mixed components are:
δT 0
i =

d3p
(2π)3 piF = ( ¯ρ + ¯P)vi ,
δT i
0 = −

d3p
(2π)3 piF = −( ¯ρ + ¯P)vi ,
(4.81)
compatible with Eqs.(4.73) and (4.74) since we are assuming h0i = 0 (and neglecting
already the heat ﬂuxes). Note the multiplication by ¯ρ + ¯P. Physically the integral
gives the perturbed spatial momentum density, which can be decomposed in the
velocity ﬂow times the inertial mass density, which is ¯ρ + ¯P in GR.
Finally:
δT i
j =

d3p
(2π)3
pi p j
E
F = δi
jδP + πi
j ,
(4.82)
from which we can deﬁne the perturbed pressure as the trace part:
δP = 1
3δi jδTi j =

d3p
(2π)3
p2
3E F ,
(4.83)
and the anisotropic stress as the traceless part:

4.2 Perturbation of the Energy-Momentum Tensor
131
πi
j = δT i
j −1
3δi
jδlmδTlm =

d3p
(2π)3
1
E

pi p j −1
3δi
j p2

F .
(4.84)
The evolution equations for the perturbations are given by the linearised Einstein
equations:
δGμ
ν = 8πGδT μ
ν .
(4.85)
Unfortunately, Eq.(4.85) is not sufﬁcient to completely describe the behaviour of
both matter and metric quantities if the ﬂuid components are more than one. See e.g.
Gorini et al. (2008). We shall make use of the perturbed Boltzmann equations for
each component of our cosmological model and we shall derive them in Chap.5.
4.3
The Problem of the Gauge and Gauge Transformations
As we have mentioned in the previous section, a gauge is a map between the points
of the physical manifold and those of the background one which allows us to deﬁne
the difference between tensors deﬁned on the two manifolds. Suppose we change
gauge from a G to a ˆG. Metric (4.3) then becomes:
gμν = a2(η)

−[1 + 2 ˆψ(η, x)]
ˆwi(η, x)
ˆwi(η, x)
δi j[1 + 2 ˆφ(η, x)] + ˆχi j(η, x)

,
δi j ˆχi j = 0 .
(4.86)
We have new hatted functions representing perturbations depending again on the
background coordinates, which we have ﬁxed.
A similar map can be deﬁned also on the single background manifold, so in
absence of perturbations, and it can be deceiving, in the sense that quantities similar
to perturbations might appear even if we are in the background manifold. Let us
rephrase this. The problem when considering ﬂuctuations in GR is that we cannot
be sure, by only looking at a metric, that there are real ﬂuctuations about a known
background or it is the metric which is written in a not very appropriate coordinate
system. For example, consider the following time transformation for the FLRW
metric:
dη = g(t, x)dt .
(4.87)
Then, the FLRW metric becomes:
ds2 = −a(t, x)2g(t, x)2dt2 + a(t, x)2δi jdxidx j ,
(4.88)
and recalling back t →η we get:
ds2 = −a(η, x)2g(η, x)2dη2 + a(η, x)2δi jdxidx j .
(4.89)
Now the metric coefﬁcients depend on the position so we may think that homogeneity
and isotropy are lost, but it was just a coordinate transformation. This is not the

132
4
Cosmological Perturbations
problem of the gauge, but is the general covariance typical of GR. As we show
above, it is not even necessarily related to perturbations but it is just a coordinate
transformation masking the metric in the form that we are used to see it. Computing
relativistic invariants or Killing vectors allows to determine if the above is the FLRW
metric or not.
The problem of the gauge is the dependence of the perturbations on the gauge.
In the following we will see how a gauge transformation manifests itself through a
change of coordinates and deal with the problem of the gauge by introducing gauge-
invariant variables. Loosely speaking, we will see that the gauge is the functional
dependence of the perturbative quantities on the coordinates, whereas the background
quantities maintain their functional form.
For a more complete treatment of the gauge problem, see for example Stewart
(1990), Mukhanov et al. (1992) and Malik and Matravers (2013).
4.3.1
Coordinates and Gauge Transformations
Inordertounderstandhowagaugetransformationchangesthefunctionaldependence
of the perturbative quantities we express the change from a gauge G to a gauge ˆG as
the following inﬁnitesimal coordinate transformation:
xμ →ˆxμ = xμ + ξμ(x) ,
(4.90)
where xμ are the background coordinates and ξμ is a generic vector ﬁeld, the gauge
generator, which must be |ξμ| ≪1 in order to preserve the smallness of the pertur-
bation. From a geometric point of view, we ﬁx a point on the background manifold
and by changing gauge we change the corresponding point on the physical manifold.
This point has coordinates different from the ﬁrst one and given by Eq.(4.90). The
gauge generator can be seen then as a vector ﬁeld on the physical manifold and the
Lie derivative of the metric along ξ tells us how the perturbative quantities change
their functional form.
Under a coordinate transformation, the metric tensor gμν, as well as any other
tensor of the same rank, transforms in the following way:
gμν(x) = ∂ˆxρ
∂xμ
∂ˆxσ
∂xμ ˆgρσ(ˆx) ,
(4.91)
which, using Eq.(4.90), can be cast as follows:
gμν(x) =

δρ
μ + ∂μξρ	
(δσ
ν + ∂νξσ) ˆgρσ(ˆx) .
(4.92)
Writing down Eq.(4.92) up to ﬁrst order, one obtains:
gμν(x) = ˆgμν(x) + ∂α ˆgμν(x)ξα + ∂μξρ ˆgρν(x) + ∂νξρ ˆgρμ(x) ,
(4.93)
where we have also expanded ˆgρσ(ˆx) about x using Eq.(4.90).

4.3 The Problem of the Gauge and Gauge Transformations
133
Exercise 4.15 Show that Eq.(4.93) can be cast in the following form:
gμν(x) = ˆgμν(x) + ∂αgμν(x)ξα + ∂μξρgρν(x) + ∂νξρgρμ(x) ,
(4.94)
i.e. prove that we can remove the hat from the metric when it is multiplied by ξ.
Then, cast the above equation as follows:
gμν(x) = ˆgμν(x) + ∇νξμ + ∇μξν .
(4.95)
This equation shows how the functional form of the metric components, i.e. the
gauge, changes upon a coordinate transformation.
If Eq.(4.90) is an isometry, i.e. gμν(x) = ˆgμν(x), one gets the Killing equation:
∇νξμ + ∇μξν = 0 .
(4.96)
Now use the perturbed FLRW metric (4.3) in Eq.(4.93).
Exercise 4.16 Show that at the order zero:
ˆa(η) = a(η)
(4.97)
i.e. the scale factor maintains its functional form, conﬁrming the property of the
gauge, which maintains the functional form of the background quantities. Then,
show that at ﬁrst-order the following transformation relations hold:
ˆψ = ψ −Hξ0 −ξ0′
ˆwi = wi −ζ′
i + ∂iξ0
(4.98)
ˆφ = φ −Hξ0 −1
3∂lξl
ˆχi j = χi j −∂jζi −∂iζ j + 2
3δi j∂lξl
(4.99)
where ζi ≡δilξl. We have introduced ζi in order not to make confusion with the
spatial part of ξμ, which is ξi = a2δilξl = a2ζi.
In the very same fashion we adopted for the metric, we can also ﬁnd the transfor-
mation rules for the components of the energy-momentum tensor. That is, through
the same steps that we have just used for the metric, we can write:

134
4
Cosmological Perturbations
ˆTμν(x) = Tμν(x) −∂αTμν(x)ξα −∂μξρTρν(x) −∂νξρTρμ(x) .
(4.100)
Exercise 4.17 Use the above transformation with Tμν given by Eqs.(4.68)–(4.70).
Find that at zeroth order one has:
ˆ¯ρ(η) = ¯ρ(η)
ˆ¯P(η) = ¯P(η)
(4.101)
i.e. the background density and pressure maintain their functional forms. Then, show
that at ﬁrst order the following transformation relations hold:
ˆδρ = δρ −¯ρ′ξ0
ˆvi = vi + ∂iξ0
ˆqi = qi
(4.102)
ˆπ = π
ˆδP = δP −¯P′ξ0
ˆπi j = πi j
(4.103)
Hint. In order to ﬁnd these relations you have to use those for the metric quantities.
Moreover, one obtains ˆqi = qi noticing that ¯ρ + ¯P is arbitrary. One the other hand,
we do not have a mathematical way to separate the transformations for δP and π. We
do that by giving the physical argument by which π is related to dissipative processes
whereas δP is not.
In general, perturbations of quantities which are vanishing or constant in the back-
ground are automatically gauge-invariant and one can see this explicitly above for
the heat ﬂux, the bulk viscosity and the anisotropic stress. This property is formalised
in the Stewart-Walker lemma (Stewart and Walker 1974). It stimulates for example
the use of the perturbed Weyl tensor (which is vanishing in FLRW metric) and the
quasi-Maxwellian equations (Hawking 1966; Jordan et al. 2009).
4.3.2
The Scalar-Vector-Tensor Decomposition
The scalar-vector-tensor (SVT) decomposition was introduced by Lifshitz in 1946
(Lifshitz 1946), who was the ﬁrst to address cosmological perturbations. See also
Lifshitz and Khalatnikov (1963) and Ma and Bertschinger (1995), for a particularly
detailed account. It consists of the following procedure. We have already seen that
the perturbed metric can be written in terms of two scalars ψ and φ, a 3-vector wi
and a 3-tensor χi j. However, we can “squeeze out” two more scalars from wi and
χi j and one more vector from χi j.

4.3 The Problem of the Gauge and Gauge Transformations
135
Helmholtz theorem (see Sect.12.3 for a brief reminder) states that, under certain
conditions of regularity, any spatial vector wi can be uniquely decomposed in its
longitudinal part plus its orthogonal contribution:
wi = w∥
i + w⊥
i ,
(4.104)
which are respectively irrotational and solenoidal (divergenceless), namely:
ϵi jk∂jw∥
k = 0 ,
∂kw⊥
k = 0 ,
(4.105)
where ϵi jk is the Levi-Civita symbol.5 By Stokes theorem, the irrotational part can be
written as the gradient of a scalar say w so that, ﬁnally, we can write wi as follows:
wi = ∂iw + Si
(4.106)
where we have deﬁned Si ≡w⊥
i , because it is simpler to write. Therefore, w is the
scalar part of wi and Si is the vector part of wi. Usually, when in cosmology one
talks about a vector perturbation one is referring to Si, i.e. to a vector which cannot
be written as a gradient of a scalar.
Similarly to the vector case, any spatial rank-2 tensor say χi j can be decomposed
in its longitudinal part χ∥
i j plus its orthogonal part χ⊥
i j plus the transverse contribution
χT
i j:
χi j = χ∥
i j + χ⊥
i j + χT
i j ,
(4.107)
deﬁned as follows:
ϵi jk∂l∂jχ∥
lk = 0 ,
∂i∂jχ⊥
i j = 0 ,
∂jχT
i j = 0 .
(4.108)
Basically, one builds a vector by taking the divergence of χi j and then applies
Helmholtz theorem to it. This implies that the longitudinal and the orthogonal parts
can be further decomposed in the same spirit of Eq.(4.105) in the following way:
χ∥
i j =

∂i∂j −1
3δi j∇2

2μ ,
χ⊥
i j = ∂j Ai + ∂i A j ,
∂i Ai = 0 ,
(4.109)
where μ is a scalar, Ai is a divergenceless vector and recall that ∇2 ≡δlm∂l∂m. We
can thus write χi j in the following form:
χi j =

∂i∂j −1
3δi j∇2

2μ + ∂j Ai + ∂i A j + χT
i j
(4.110)
5Reminder: ϵ123 = 1 and it changes sign upon any odd permutation of its indices. It follows that
ϵi jk = 0 if two or more indices are equal.

136
4
Cosmological Perturbations
The transverse part χT
i j cannot be decomposed in any scalar or divergenceless vector.
Therefore, it constitutes a tensor perturbation.
The SVT decomposition is a fundamental tool for the investigation of ﬁrst order
perturbations because the three classes do not mix up and therefore they can be
independently analysed. The absence of mixing is due to the fact that any kind of
interaction term among the three categories would be of second order and therefore
negligible.
Let us see how each class of perturbations transforms. Apply Helmholtz theorem
also to the spatial part of ξμ as follows:
ξ0 ≡α ,
ζi = ∂iβ + ϵi ,
(∂lϵl = 0) ,
(4.111)
where α and β are scalars and ϵi is a divergenceless vector. Now let us write the
transformations found in Eqs.(4.98) and (4.99) using the SVT decomposition:
ˆψ = ψ −Hα −α′ ,
(4.112)
∂i ˆw + ˆSi = ∂iw + Si −∂iβ′ −ϵ′
i + ∂iα ,
(4.113)
ˆφ = φ −Hα −1
3∇2β ,
(4.114)

∂i∂j −1
3δi j∇2

2 ˆμ + ∂j ˆAi + ∂i ˆA j + ˆχT
i j =

∂i∂j −1
3δi j∇2

2μ
+∂j Ai + ∂i A j + χT
i j −2∂j∂iβ −∂jϵi −∂iϵ j + 2
3δi j∇2β .
(4.115)
We are now in the position of writing explicitly the transformation rules for each
class of perturbation.
Scalar Perturbations and Their Gauge-Invariant Combinations
By taking the divergence ∂i of Eq.(4.113) and twice the divergence ∂i∂j of
Eq.(4.115), we eliminate all the vector and tensor contributions and are left with
the transformation equations for the scalar perturbations only:
ˆψ = ψ −Hα −α′ ,
(4.116)
∇2 ˆw = ∇2 
w −β′ + α
	
,
(4.117)
ˆφ = φ −Hα −1
3∇2β ,
(4.118)
∇2∇2 ˆμ = ∇2∇2(μ −β) .
(4.119)
From the above transformations we obtain:

4.3 The Problem of the Gauge and Gauge Transformations
137
ˆψ = ψ −Hα −α′
(4.120)
ˆw = w −β′ + α
(4.121)
ˆφ = φ −Hα −1
3∇2β
(4.122)
ˆμ = μ −β
(4.123)
In principle, we should have extra functions in the second and fourth equations,
coming from the integration of ∇2 and ∇2∇2, but these are spurious gauge modes
which can be set to zero without losing of generality.
The following combinations of scalar perturbations are gauge-invariant:
 = ψ + 1
a

w −μ′	
a
′
 = φ + H

w −μ′	
−1
3∇2μ
(4.124)
They are the famous Bardeen’s potentials (Bardeen 1980).
Exercise 4.18 Prove that the Bardeen potentials are gauge-invariant. Why are there
only two of them?
The same technique that we have just used for the metric perturbations can be
applied to the matter quantities in Eqs.(4.102) and (4.103).
Exercise 4.19 Applying the SVT decomposition to vi:
vi = ∂iv + Ui ,
(∂lUl = 0) ,
(4.125)
show that, for scalar perturbations, one gets:
ˆδρ = δρ −¯ρ′α
⇒
ˆδ = δ + 3H(1 + ¯P/ ¯ρ)α
(4.126)
ˆv = v + α
(4.127)
ˆδP = δP −¯P′α
(4.128)
Note how a cosmological constant has gauge invariant perturbations.
As we did earlier for the geometric quantities, we can combine the above trans-
formations for matter in order to obtain gauge-invariant variables. The strategy is,
in general, to combine the transformations in order to eliminate α and β. The result
is then manifestly gauge-invariant. Using matter quantities only, we can eliminate α

138
4
Cosmological Perturbations
from Eqs.(4.126) and (4.128), thus obtaining the following gauge-invariant pertur-
bation:
 ≡δP −
¯P′
¯ρ′ δρ
(4.129)
This is the entropy perturbation. The ratio δP/δρ is called effective speed of
sound, whereas the ratio ¯P′/ ¯ρ′ is called adiabatic speed of sound. When the two
are equal, i.e.  = 0 one ﬁnds dS = 0, i.e. one has adiabaticity.
The other gauge-invariant combinations are:
δρ(gi)
m
≡¯ρ ≡δρ + ¯ρ′v
δP(gi)
m
≡δP + ¯P′v
(4.130)
i.e. the gauge-invariant density, also called comoving-gauge density perturbation,
and pressure perturbations. The subscript m refers to “matter”, since it is also pos-
sible to build gauge-invariant perturbations of the density and pressure using metric
quantities. We are borrowing this notation from Bardeen (1980).
We can now think of combining the geometric and matter transformations, a total
of 7 relations, trying to eliminate α and β in order to create new gauge-invariant
variables.
Indeed, we can form the so-called comoving curvature perturbation
R ≡φ + Hv −1
3∇2μ
(4.131)
also known as Lukash variable (Lukash 1980), and we can form the quantity:
ζ ≡φ +
δρ
3( ¯ρ + ¯P) −1
3∇2μ
(4.132)
which was introduced ﬁrst in Bardeen et al. (1983) but started to be exploited in
Wands et al. (2000). These R and ζ are especially important in the framework of
inﬂation because they are conserved on large scales and for adiabatic perturbations,
as noticed in Bardeen (1980) (at least for R), and as we shall prove in Sect.12.4.
Again, we can form gauge-invariant density, velocity and pressure perturbations:
δρ(gi)
g
≡δρ + ¯ρ′ 
w −μ′	
v(gi) ≡v −(w −μ′)
δP(gi)
g
≡δP + ¯P′ 
w −μ′	
(4.133)
In general, having 2 gauge variables α and β and 7 transformations, we can build 5
independent scalar gauge-invariant perturbations.

4.3 The Problem of the Gauge and Gauge Transformations
139
Vector Perturbations and Their Gauge-Invariant Combinations
We can now eliminate the scalar contribution from Eq.(4.113) and consider the
divergence ∂j of Eq.(4.115). In this way we shall ﬁnd the transformations for vector
perturbations:
ˆSi = Si −ϵ′
i
(4.134)
∇2 ˆAi = ∇2(Ai −ϵi) .
(4.135)
From the second equation, we can ﬁnd the following transformation:
ˆAi = Ai −ϵi
(4.136)
It is possible to deﬁne a new gauge-invariant vector potential, which has the following
form:
Wi ≡Si −A′
i
(4.137)
Exercise 4.20 Prove that Wi is gauge-invariant. Why is there only one gauge-
invariant vector perturbation?
Using the SVT decomposition of Eq.(4.125), show that from the matter sector
we just have:
ˆUl = Ul ,
(4.138)
i.e. the vector contribution of vi is already gauge-invariant.
Tensor Perturbations
Since an inﬁnitesimal gauge transformation, cf. Eq.(4.90), cannot be realised by any
rank-2 tensor, the following result is not unexpected:
ˆχT
i j = χT
i j
(4.139)
i.e. that the transverse part of χi j is already gauge-invariant.

140
4
Cosmological Perturbations
Summary
We have thus seen that a generic perturbation of the metric can be split in:
• 4 scalar functions;
• 2 divergenceless 3-vectors, for a total of 4 independent components (2 each);
• A transverse, traceless spatial tensor of rank 2, χT
i j. It has 2 independent compo-
nents.
The total number of independent components sums up to 10, as it should be.
Exercise 4.21 Why does χT
i j have two independent components only?
The above decomposition holds true not only for the metric but for any rank-2
symmetric tensor.
4.3.3
Gauges
Thanks to gauge freedom we can set any 4 components of the metric to zero. There
are two particularly useful choices: the synchronous gauge and the Newtonian gauge.
Synchronous gauge. This is realised by the choice:
ˆψ = 0 ,
ˆwi = 0 .
(4.140)
Note that ˆwi = 0 means that both the scalar and the vector part of wi are being set
to zero. Using the transformations found in the previous subsection, we ﬁnd:
⎧
⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎩
ψ −Hα −α′ = 0
w −β′ + α = 0
Si −ϵ′
i = 0
.
(4.141)
This must be interpreted as a system of equations for the unknowns α, β and ϵi, i.e.
from a generic gauge we want to know which transformations we have to perform
in order to go to the synchronous gauge. We have 4 equation for 4 unknowns, so we
expect to determine a single solution. However, the above equations are differential
and this implies the following:
⎧
⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎩
α = 1
a

dη aψ + f (x)
β =

dη (w + α) + g(x)
ϵi =

dη Si + hi(x)
.
(4.142)

4.3 The Problem of the Gauge and Gauge Transformations
141
Since we have only time derivatives, the integrations give rise to purely space-
dependent functions, which we have called f , g and h here, and which are spurious
gauge modes.
Newtonian gauge. This is realised by the choice:
ˆw = 0 ,
ˆμ = 0 ,
ˆχ⊥
i j = 0 .
(4.143)
Using the transformations found in the previous subsection, we ﬁnd:
⎧
⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎩
w −β′ + α = 0
μ −β = 0
Ai −ϵi = 0
.
(4.144)
It easy to see that the second and the third equation are algebraic and determine β
and ϵi. Substituting the solution for β into the ﬁrst equation, we then ﬁnd α. There
is no integration to perform, therefore no spurious gauge mode appears.
An important fact that makes the conformal Newtonian gauge somewhat special is
that ˆψ =  and ˆφ = , i.e. the metric perturbations become identical to the Bardeen
potentials. These lecture notes are based on the use of the Newtonian gauge.
Transformations Between the Two Gauges
It is useful to provide the transformation rules among the metric perturbations in the
two gauges, for those readers who might want to translate into the synchronous gauge
the results of these notes and comparing them with the huge literature in which this
gauge is employed. For the scalar case, using Eqs.(4.120)–(4.123) and assuming that
the hatted quantities are the synchronous ones whereas the non-hatted perturbations
are the conformal Newtonian ones, we get:
0 = ψN −Hα −α′ ,
(4.145)
0 = 0 −β′ + α ,
(4.146)
φS = φN −Hα −1
3∇2β ,
(4.147)
μS = −β .
(4.148)
The second and the fourth equation completely specify the transformation in terms
of μS, i.e. we have:
α = β′ = −μ′
S
(4.149)
and the metric potentials are related by:
ψN = −Hμ′
S −μ′′
S
φN = φS −Hμ′
S −1
3∇2μS
(4.150)

142
4
Cosmological Perturbations
In the literature, see e.g. Ma and Bertschinger (1995), the Fourier transforms of φS
and μS are usually named h and 6η, respectively.
For vector perturbations we have:
0 = Si
N −ϵi′ ,
(4.151)
Ai
S = 0 −ϵi ,
(4.152)
from which it is straightforward to obtain:
Si
N = −Ai′
S .
(4.153)
Of course, tensor perturbations are naturally gauge-invariant and thus have the same
functional form in the two gauges. This is also true for any tensor of rank equal or
higher than 2.
4.4
Normal Mode Decomposition
We are now in the position of writing down explicitly the Einstein equations, ﬁxing a
gauge of our choice, which will be the Newtonian one. We expect these equations to
be linear second order partial differential equations, given the perturbation scheme
employed. Because of this, it is very convenient to express the perturbations as super-
positions of normal modes, i.e. the eigenmodes Q(k, x) of the Laplacian operator,
deﬁned via the Helmholtz equation:
∇2Q(k, x) = −k2Q(k, x) .
(4.154)
For ﬂat spatial slicing, which is considered here, this normal mode decomposition
of course amounts to a Fourier transform, i.e.
Q(k, x) = eik·x ,
(4.155)
and a given quantity X(η, x) is expressed as:
˜X(η, k) =

d3x X(η, x)e−ik·x ,
X(η, x) =

d3k
(2π)3 ˜X(η, k)eik·x . (4.156)
Consider for example the metric perturbations ψ, φ, wi and χi j. For ψ and φ we
simply have that:
ψ(η, x) =

d3k
(2π)3 ˜ψ(η, k)eik·x ,
φ(η, x) =

d3k
(2π)3 ˜φ(η, k)eik·x ,
(4.157)
and similar expressions also apply for δρ and δP.

4.4 Normal Mode Decomposition
143
Using its SVT decomposition in Eq.(4.106), we have for wi the following Fourier
transformation:
wi(η, x) =

d3k
(2π)3 ˜wi(η, k)eik·x =

d3k
(2π)3 [ ˜
∂iw(η, k) + ˜Si(η, k)]eik·x .
(4.158)
The Fourier transform of a partial spatial derivative is
˜
∂iw(η, k) = iki ˜w(η, k) ,
(4.159)
and therefore we have:
wi(η, x) = i

d3k
(2π)3 ki ˜w(η, k)eik·x +

d3k
(2π)3 ˜Si(η, k)eik·x .
(4.160)
So we see that the Fourier transforms of ψ or φ and w are not treated on an equal
footing, because ˜w is multiplied by a ki. A similar argument goes also for vi.
Finally, doing the same for χi j in Eq.(4.110), one gets:
χi j(η, x) =

d3k
(2π)3

−kik j + 1
3δi jk2

2 ˜μ(η, k)eik·x
+i

d3k
(2π)3 [k j ˜Ai(η, k) + ki ˜A j(η, k)]eik·x +

d3k
(2π)3 ˜χT
i j(η, k)eik·x ,
(4.161)
with a similar expansion holding true for πi j. We see that ˜μ is multiplied by a
factor k2 and ˜Ai is multiplied by a factor k. Therefore, in order to properly compare
perturbations, par condicio is restored by “correcting” as follows:
˜w ≡−1
k
˜B ,
˜v ≡−1
k
˜V ,
˜μ ≡1
k2 ˜E ,
˜Ai ≡−1
2k
˜Fi .
(4.162)
In this way, all scalar quantities are treated on the same footing. Let us see what
happens to the comoving gauge density perturbation:
˜ = ˜δ + 3(1 + ¯P/ ¯ρ)H
k
˜V
(4.163)
Since H ∝1/η, on sub-horizon scales, i.e. for kη ≫1, the density contrast becomes
gauge-invariant. We present this fact in Fig.4.1, where we plot the evolution of the
modulus of the CDM density contrast δc as function of k and for z = 0, computed
with CLASS (Lesgourgues 2011) in the synchronous (solid line) and Newtonian
(dashed line) gauges.

144
4
Cosmological Perturbations
Fig. 4.1 Plot of the modulus of the CDM density contrast at z = 0 (today) as function of k, using
CLASS. The solid line is the result obtained using the synchronous gauge whereas the dashed one
is obtained using the Newtonian one. The initial conditions are adiabatic and normalised in order to
have R = 1. All the cosmological parameters have been set, as default, corresponding to the Planck
best ﬁt of the CDM model (Ade et al. 2016a)
The plots in Fig.4.1 are drawn for z = 0, hence the value of the Hubble parameter
is the Hubble constant, H0 = 3 × 10−4 h Mpc−1. Indeed, when k > H0 the two
evolutions coincide.
Now we have to understand how to extract the scalar and vector part from a full
3-vector quantity. Let us reformulate the FT of wi as follows:
˜wi(η, k) = −i ˆki ˜B(η, k) + ˜Si(η, k) .
(4.164)
WeseethatwecanisolatethescalarpartoftheFTtransformofa3-vectorperturbation
by contracting it with i ˆki. Indeed:
i ˆki ˜wi(η, k) = ˜B(η, k) ,
(4.165)
because ˆki ˜Si = 0, since ∂i Si = 0. The vector part is therefore obtained by subtracting
the scalar part:
˜Si =

δ j
i −ˆk j ˆki

˜w j .
(4.166)
We can easily check that this formula satisﬁes ˆki ˜Si = 0.
What about a tensorial quantity? For the traceless spatial metric perturbation in
Eq.(4.110), we can write:
˜χi j = −

ˆki ˆk j −1
3δi j

2 ˜E −i
2
ˆk j ˜Fi −i
2
ˆki ˜Fj + ˜χT
i j .
(4.167)
Here the scalar contribution can be isolated by contracting with −3ˆki ˆk j/2. In fact:

4.4 Normal Mode Decomposition
145
−3
2
ˆki ˆk j ˜χi j = 2 ˜E .
(4.168)
Exercise 4.22 Show that the vector contribution is obtained contracting once with
2i ˆki and using Eq.(4.168), i.e.
˜Fi = 2i

δ j
i −ˆk j ˆki

ˆkl ˜χ jl .
(4.169)
For the tensor part, show that:
˜χT
i j =

δl
i −ˆkl ˆki
 
δm
j −ˆkm ˆk j

˜χlm + 1
2(δi j −ˆki ˆk j)ˆkl ˆkm ˜χlm .
(4.170)
Verify that ˆki ˜χT
i j = ˆk j ˜χT
i j = 0 and δi j ˜χT
i j = 0. Recall that ˜χi j is already traceless.
4.5
Einstein Equations for Scalar Perturbations
In this section we focus on scalar perturbations and employ the Newtonian gauge.
Our perturbed metric is then:
g00 = −a(η)2[1 + 2(η, x)] ,
g0i = 0 ,
gi j = a(η)2δi j [1 + 2(η, x)] ,
(4.171)
where we are employing the Bardeen potentials, exploiting the fact that w = μ = 0.
In metric (4.171)  plays the role of the Newtonian potential and  is the spatial
curvature perturbation.
Exercise 4.23 Calculate from scratch the perturbed Einstein tensor δGμν from met-
ric (4.171), AND do it again using also Eqs.(4.42)–(4.44). Show that:
a2δG0
0 = −6H′ + 6H2 + 2∇2 , (4.172)
a2δG0
i = 2∂i(′ −H) , (4.173)
a2δGi
j =

−2′′ −4H′ + 2H′ + 4a′′
a  −2H2 + ∇2( + )

δi
j
−∂i∂j( + ) .
(4.174)
Note again that ∂i = ∂i since it is the partial derivative with respect to comoving coor-
dinates and ∇2 = δlm∂l∂m is the comoving Laplacian. Being comoving, it is always
accompanied by a factor 1/a2, since together they form the physical Laplacian.

146
4
Cosmological Perturbations
4.5.1
The Relativistic Poisson Equation
The 0–0 Einstein equation is the following:
−3H′ + 3H2 + ∇2 = 4πGa2δT 0
0 .
(4.175)
Using the perturbed energy momentum tensor component δT 00, as we can read from
Eq.(4.72), we have:
3H′ −3H2 −∇2 = 4πGa2δρtot
(4.176)
where the total perturbed density is
δρtot =

i
δρi =

i
ρiδi ,
(4.177)
i.e. it is the sum of the perturbed densities of all the material components that con-
stitute our cosmological model, in the same way that we did for the background.
We start here to eliminate the bar over the background quantities. We shall con-
sider the CDM as our standard cosmological model. Thus, we have to deal with 4
contributions:
1. Photons;
2. Neutrinos;
3. CDM;
4. Baryons.
Each of these has its own energy-momentum tensor and the total one, which enters
the right hand side of the Einstein equations, is their sum. The cosmological constant
only contributes at background level.
We have found above the relativistic Poisson equation. Indeed, if we consider
a = 1, and hence H = 0, we recover the usual Newtonian Poisson equation (or
almost, since we have two potentials in GR). Written in terms of the density contrast,
using Eq.(4.72), the relativistic Poisson equation is the following:
3H′ −3H2 −∇2 = 4πGa2 
ρcδc + ρbδb + ργδγ + ρνδν
	
(4.178)
As one can see, Eq.(4.178) is a second order partial differential equation (PDE)
which is linear, because we are doing ﬁrst-order perturbation theory and thus all the
perturbative variables appear with power 1. Because of this, as we anticipated, it is
very convenient to introduce the Fourier transform of the latter, thus transforming
Eq.(4.178) in a linear ordinary differential equation (ODE).
Hereafter, we shall constantly employ the Fourier transform, but drop the tilde
above the transformed quantities as it customary in cosmology because almost always
one deals directly with the Fourier modes rather than with the conﬁguration space.

4.5 Einstein Equations for Scalar Perturbations
147
Therefore, Eq.(4.178) Fourier-transformed and written in the conformal time is the
following:
3H′ −3H2 + k2 = 4πGa2 
ρcδc + ρbδb + ργδγ + ρνδν
	
(4.179)
4.5.2
The Equation for the Anisotropic Stress
The next Einstein equation that we present is the traceless part of δGi j, which we
know from Eq.(4.75) to be related to the anisotropic stress πi j.
Exercise 4.24 From Eq.(4.174), calculate the trace and the traceless part of δGi j.
Show that:
a2δGl
l = −6′′ −12H′ + 6H′ + 12a′′
a  −6H2 + 2∇2( + ) ,
(4.180)
and then
a2δGi
j −1
3δi
ja2δGl
l = −

∂i∂j −1
3δi
j∇2

( + ) .
(4.181)
The Fourier transform of the latter can be written in the following form:
a2δGi
j −1
3δi
ja2δGl
l = k2

ˆki ˆk j −1
3δi
j

( + ) ,
(4.182)
where we have used ki = k ˆki and ˆki is the unit vector denoting the direction of k.
The spatial traceless Einstein equation can thus be written as:
k2

ˆki ˆk j −1
3δi
j

( + ) = 8πGa2πi
j
(4.183)
since πi j is the spatial traceless part of the energy-momentum tensor, as we know
from Eq.(4.75). On the left hand side, we notice the same operator multiplying the
scalar contribution of χi j in Eq.(4.167). Hence, only the scalar contribution of πi j
would contribute on the right hand side. Indeed, contracting the above equation with
ˆki ˆk j, as in Eq.(4.168), we obtain:
k2( + ) = 12πGa2 ˆki ˆk jπi
j
(4.184)

148
4
Cosmological Perturbations
Our ˆki ˆk jπi j corresponds to the −(ρ + P)σ used in Ma and Bertschinger (1995). We
leave this equation as it is for the moment. We shall see that ˆki ˆk jπi j is sourced by
the quadrupole moments of the photon and neutrino distributions.
This equation tells us that  = −, i.e. there exists only one gravitational poten-
tial, unless a quadrupole moment of the energy content distribution is present. For
example, when CDM dominated the universe then  = − but this is not the case
in the early universe, because of neutrinos. Even when CDM or DE dominates but
the underlying theory of gravity is not GR one might have  ̸= −.6
4.5.3
The Equation for the Velocity
The 0 −i Einstein equation can be written using Eqs.(4.173) and (4.73) as follows:
∂i(′ −H) = 4πGa2 (ρ + P) vi .
(4.185)
Upon FT we get:
iki(′ −H) = 4πGa2 (ρ + P) vi ,
(4.186)
and now we must get the scalar part of this vectorial equation, contracting by i ˆki, as
we showed in Eq.(4.165). Hence, we get:
k(−′ + H) = 4πGa2 (ρ + P) V
(4.187)
Comparing with the notation employed in Ma and Bertschinger (1995), one has
θ = kV . Note that the (ρ + P) V in the above equation is the total one, hence making
explicit the various contributions one has:
k(−′ + H) = 4πGa2

ρcVc + ρbVb + 4
3ργVγ + 4
3ρνVν

(4.188)
where we have considered the usual equations of state for the various components,
i.e. Pc = Pb = 0 and Pγ = ργ/3 and Pν = ρν/3.
4.5.4
The Equation for the Pressure Perturbation
Using Eq.(4.180), we can immediately write down the last Einstein equation for
scalar perturbations:
6One can probe the value of  +  via weak lensing, which we do not address in these notes. See
e.g. Dodelson (2017) for a treatise on gravitational lensing.

4.5 Einstein Equations for Scalar Perturbations
149
′′ + 2H′ −H′ −(2H′ + H2) + k2
3 ( + ) = −4πGa2δP
(4.189)
Exercise 4.25 Use the previously derived transformations (4.150) from the Newto-
nian to the synchronous gauge and write there the Einstein equations.
4.6
Einstein Equations for Tensor Perturbations
Our perturbed FLRW metric, with tensor perturbations only, can be cast as follows:
g00 = −a2 ,
g0i = 0 ,
gi j = a2(δi j + hT
i j) ,
(4.190)
where hT
i j is divergenceless and traceless.
Exercise 4.26 Start from metric (4.190) and calculate the perturbed Einstein tensor
δGμν. Verify the calculations also using Eqs.(4.42)–(4.44). Show that the only non
vanishing components are:
2a2δGi
j = hT ′′
i j + 2HhT ′
i j −∇2hT
i j
(4.191)
Notice that the wave operator has appeared.
The calculation of the above exercise is pretty straightforward because the tensor
nature of the perturbation hT
i j already suggests that it cannot contribute to R00, R0i
and the Ricci scalar R (at ﬁrst-order).
The tensor part of the Einstein equations is thus:
hT ′′
i j + 2HhT ′
i j + k2hT
i j = 16πGa2πT
i j
(4.192)
where πT
i j is the tensorial part of the anisotropic stress, which can be computed from
the total as in Eq.(4.170):
πT
i j =

δl
i −ˆkl ˆki
 
δm
j −ˆkm ˆk j

πlm + 1
2
ˆkl ˆkmπlm

δi j −ˆki ˆk j

.
(4.193)
In Fourier space, the divergenceless condition can be written down as:
ˆkihT
i j = 0 .
(4.194)

150
4
Cosmological Perturbations
Therefore, hT
i j can be expanded with respect to a 2-dimensional basis {ˆe1, ˆe2} deﬁned
on the 2-dimensional subspace orthogonal to ˆk. The basis satisﬁes thus the condition:
γi jea,i ˆk j = 0 ,
γi jea,ieb, j = δab ,
(4.195)
where γi j is the metric on the 2-dimensional subspace and a, b ∈{1, 2}. We can write
then hT
i j as follows:
hT
i j(k) = (e1,ie1, j −e2,ie2, j)(ˆk)h+(k) + (e1,ie2, j + e2,ie1, j)(ˆk)h×(k) .
(4.196)
Note the dependence on ˆk of the combinations of the 2-dimensional basis vectors.
In fact these depend on the orientation of ˆk.
Substituting the above expansion into Eq.(4.192) and in absence of quadrupole
moments, h+,× satisfy then the equation:
h′′
+,× + 2Hh′
+,× + k2h+,× = 0
(4.197)
which we will employ in order to investigate the GW production during inﬂation in
Sect.8.4.
If we choose a Cartesian reference frame and ˆk = ˆz, i.e. a propagation direction
of a gravitational wave along ˆz, then a natural choice is ˆe1 = ˆx and ˆe2 = ˆy and the
perturbed metric can be written as:
hT
i j(kˆz) =
⎛
⎝
h+ h×
0
h× −h+ 0
0
0
0
⎞
⎠.
(4.198)
Though this a convenient way of expressing hT
i j(kˆz), one usually prefers to use the
combinations:
h+ ∓ih× ,
(4.199)
since these have helicity ±2, see e.g. Weinberg (1972). In order to see this, we apply
a rotation about ˆz and calculate how hT
i j(kˆz) transforms.
Exercise 4.27 Apply the rotation:
Ri
j(θ) =
⎛
⎝
cos θ −sin θ 0
sin θ
cos θ 0
0
0
1
⎞
⎠,
(4.200)
about the ˆz axis to hT
i j, i.e. compute the components:
¯hT
lm = Ri
l R j
mhT
i j ,
(4.201)

4.6 Einstein Equations for Tensor Perturbations
151
and show that:
¯h+ = cos2 θh+ + 2 sin θ cos θh× −sin2 θh+ = cos 2θh+ + sin 2θh× ,
(4.202)
¯h× = cos2 θh× −2 sin θ cos θh+ −sin2 θh× = cos 2θh× −sin 2θh+ . (4.203)
Hence, the aforementioned combinations h+ ± ih× transform as:
¯h+ ± i ¯h× = e∓2iθ(h+ ± ih×)
(4.204)
and have thus helicity ∓2. Sometimes the sign could be a bit confusing depending
in which sense the rotation is performed. By convention, θ > 0 denotes an anti-
clockwise rotation so a rotation of θ about the ˆz axis corresponds to a −θ rotation
about the −ˆz axis, which is the line of sight and therefore the relevant direction
for the observer. So, the observed helicities have opposite sign with respect to the
propagating ones.
So, we write the total tensor perturbation as a sum over the helicities:
hT
i j(η, kˆz) =

λ=±2
ei j(ˆz, λ)h(η, kˆz, λ) ,
(4.205)
where:
e11(ˆz, ±2) = −e22(ˆz, ±2) = ∓ie12(ˆz, ±2) = ∓ie21(ˆz, ±2) =
1
√
2
,
(4.206)
and of course e3i = ei3 = 0. Therefore, from Eq.(4.205) we get:
h+(η, kˆz) =
1
√
2
h(η, kˆz, +2) + 1
√
2
h(η, kˆz, −2) ,
(4.207)
h×(η, kˆz) =
i√
2
h(η, kˆz, +2) −
i√
2
h(η, kˆz, −2) ,
(4.208)
and inverting:
√
2h(η, kˆz, +2) = h+(η, kˆz) −ih×(η, kˆz) ,
(4.209)
√
2h(η, kˆz, −2) = h+(η, kˆz) + ih×(η, kˆz) .
(4.210)
For k in a generic direction, we have that:
hT
i j(η, k) =

λ=±2
ei j(ˆk, λ)h(η, k, λ) ,
(4.211)
where the polarisation tensor is deﬁned as:

152
4
Cosmological Perturbations
ei j(ˆk, ±2) =
√
2e±,ie±, j ,
(4.212)
where the polarisation vectors are:
e±,i(ˆk) ≡(e1 ± ie2)i
√
2
.
(4.213)
Of course ei j(ˆk, λ) has the same symmetry of hT
i j(η, k) and thus is traceless and
transverse, i.e.
ˆklelm(ˆk, λ) = 0 ,
(4.214)
Again, the two h(η, k, ±2) satisfy the same Eq.(4.197) as for h+,×.
When we will discuss about the effect of GW on photon propagation and CMB we
shall have then to deal with two directions: one is the GW direction ˆk and the other
is the photon direction of propagation, ˆp. In general a frame ˆk = ˆz is chosen in order
to simplify the calculations. But then, before taking the anti-Fourier transform and
obtaining the physical quantities in the real space one has to remember of performing
a rotation which brings ˆk back in a generic direction. We shall see this in detail in
Chap.10.
4.7
Einstein Equations for Vector Perturbations
Finally, we address vector perturbations. The vector-perturbed FLRW metric, in the
Newtonian gauge, has the following form:
g00 = −a2 ,
g0i = 0 ,
gi j = a2(δi j + hV
i j) ,
(4.215)
where
hV
i j = ∂i A j + ∂j Ai ,
(4.216)
and Ai is a divergenceless vector, i.e. ∂i Ai = 0.
Exercise 4.28 Repeat the very same calculations performed in the tensor case but
now for hV
i j. Notice a very important difference: hV
i j is traceless but NOT divergence-
less. Compare the results with those found using Eqs.(4.42)–(4.44). Show that the
non-vanishing components of the perturbed Einstein tensor are:
2a2δG0
i = −∂lhV ′
li = −∇2 A′
i ,
(4.217)
2a2δGi
j = hV ′′
i j + 2HhV ′
i j = (∂i A j + ∂j Ai)′′ + 2H(∂i A j + ∂j Ai)′ .
(4.218)

4.7 Einstein Equations for Vector Perturbations
153
With the Laplacian missing, the last equation has no more the wave behaviour that
the corresponding tensor equation has. With no vector sources, show then that in the
early, radiation-dominated universe, for which H = 1/η, one has:
hV
i j ∝1/η2 ,
(4.219)
and hence vector perturbations vanish, if not sourced.
Einstein equations are thus:
kF′
i = −32πGa2(ρ + P)Ui ,
(4.220)
(i ˆki Fj + i ˆk j Fi)′′ + 2H(i ˆki Fj + i ˆk j Fi)′ = −32πGa2πV
i j ,
(4.221)
where Ui is the vector part of vi, deﬁned in Eq.(4.125), Fi is deﬁned in Eq.(4.162)
and πV
i j is the vector part of the anisotropic stress, deﬁned as from Eq.(4.169):
πV
i j = 2i

δm
i −ˆkm ˆki

ˆklπlm ˆk j + 2i

δm
j −ˆkm ˆk j

ˆklπlm ˆki ,
(4.222)
Of course, we have that:
ˆki Fi = 0 ,
ˆkiUi = 0 ,
ˆki ˆk jπV
i j = 0 .
(4.223)
Contracting the second Einstein equation with i ˆk j leaves us with:
F′′
i + 2HF′
i = 32πGa2i ˆk jπV
i j
(4.224)
We choose, as in the tensor case, to align ˆk to ˆz. Therefore, the divergenceless of Ai
implies that
iki Ai = 0
⇒
A3 = 0 ,
(4.225)
and from Eq.(4.216) we have:
hV
i j = iki A j + ik j Ai = −i
2
ˆki Fj −i
2
ˆk j Fi .
(4.226)
So, hV
i j can be written as follows:
hV
i j =
⎛
⎝
0
0
−i F1/2
0
0
−i F2/2
−i F1/2 −i F2/2 0
⎞
⎠.
(4.227)

154
4
Cosmological Perturbations
Exercise 4.29 Applying the same rotation about ˆz as we did for tensor perturbations.
Show that:
¯F1 = F1 cos θ −F2 sin θ ,
(4.228)
¯F2 = F1 sin θ + F2 cos θ .
(4.229)
Hence we have:
¯F1 + i ¯F2 = (F1 + i F2)eiθ ,
(4.230)
¯F1 −i ¯F2 = (F1 −i F2)e−iθ ,
(4.231)
and therefore the quantities:
F± ≡F1 ± i F2 ,
(4.232)
are ﬁelds with helicity ±1.
References
Ade, P.A.R., et al.: Planck 2015 results. XIII. Cosmological parameters. Astron. Astrophys. 594,
A13 (2016a)
Bardeen, J.M.: Gauge invariant cosmological perturbations. Phys. Rev. D 22, 1882–1905 (1980)
Bardeen, J.M., Steinhardt, P.J., Turner, M.S.: Spontaneous creation of almost scale - free density
perturbations in an inﬂationary universe. Phys. Rev. D 28, 679 (1983)
Dodelson, S.: Gravitational Lensing, p. 2017. Cambridge University Press, Cambridge (2017)
Dodelson, S.: Modern Cosmology. Academic Press, Netherlands (2003)
Gorini, V., Kamenshchik, A.Y., Moschella, U., Piattella, O.F., Starobinsky, A.A.: Gauge-invariant
analysis of perturbations in Chaplygin gas uniﬁed models of dark matter and dark energy. JCAP
0802, 016 (2008)
Hawking, S.W.: Perturbations of an expanding universe. Astrophys. J. 145, 544–554 (1966)
Jordan, P., Ehlers, J., Kundt, W.: Republication of: exact solutions of the ﬁeld equations of the
general theory of relativity. Gen. Relativ. Gravit. 41(9), 2191–2280 (2009)
Kodama, H., Sasaki, M.: Cosmological perturbation theory. Prog. Theor. Phys. Suppl. 78, 1–166
(1984)
Landau, L.D., Lifschits, E.M.: The Classical Theory of Fields. Volume 2 of Course of Theoretical
Physics. Pergamon Press, Oxford (1975)
Lesgourgues, J.: The Cosmic Linear Anisotropy Solving System. CLASS) I, Overview (2011)
Lifshitz, E.: On the Gravitational stability of the expanding universe. J. Phys. (USSR) 10, 116 (1946)
Lifshitz, E.M., Khalatnikov, I.M.: Investigations in relativistic cosmology. Adv. Phys. 12, 185–249
(1963)
Lukash, V.N.: Production of phonons in an isotropic universe. Sov. Phys. JETP 52, 807–814 (1980).
[Zh. Eksp. Teor. Fiz.79,1601(1980)]
Ma, C.-P., Bertschinger, E.: Cosmological perturbation theory in the synchronous and conformal
Newtonian gauges. Astrophys. J. 455, 7–25 (1995)
Maartens, R.: Causal thermodynamics in relativity(1996)
Malik, K.A., Matravers, D.R.: Comments on gauge-invariance in cosmology. Gen. Relativ. Gravit.
45, 1989–2001 (2013)

References
155
Mukhanov,V.: Physical FoundationsofCosmology.Cambridge UniversityPress,Cambridge (2005)
Mukhanov, V.F., Feldman, H.A., Brandenberger, R.H.: Theory of cosmological perturbations. Part
1. Classical perturbations. Part 2. Quantum theory of perturbations. Part 3. Extensions. Phys. Rep.
215, 203–333 (1992)
Stewart, J.M.: Perturbations of Friedmann-Robertson-Walker cosmological models. Class. Quan-
tum Gravity 7, 1169–1180 (1990)
Stewart, J.M., Walker, M.: Perturbations of spacetimes in general relativity. Proc. R. Soc. Lond.
A341, 49–74 (1974)
Wands, D., Malik, K.A., Lyth, D.H., Liddle, A.R.: A new approach to the evolution of cosmological
perturbations on large scales. Phys. Rev. D 62, 043527 (2000)
Weinberg, S.: Cosmology. Oxford University Press, Oxford (2008)
Weinberg, S.: Gravitation and Cosmology: Principles and Applications of the General Theory of
Relativity. Wiley, New York (1972)
Zimdahl, W.: Bulk viscous cosmology. Phys. Rev. D 53, 5483–5493 (1996)

Chapter 5
Perturbed Boltzmann Equations
The Boltzmann equation plays a similar role for physicists and
astronomers: no one ever talks about it, but everyone is always
thinking about it
Scott Dodelson, Modern Cosmology
We derive in this chapter the perturbed Boltzmann equations for photons, massless
neutrinos, CDM and baryons. We shall use these in order to track the evolution of
small ﬂuctuations in these components, and couple them to Einstein equations. For
deriving the hierarchy of temperature and polarisation for photons we follow mainly
MaandBertschinger(1995),HuandWhite(1997)andTramandLesgourgues(2013).
We shall focus most of the time on the photon perturbed Boltzmann equation which
is much more laborious than the others. This is because photons are massless and
interact, therefore we cannot truncate the hierarchy and a collisional term must be
taken into account. The latter comes from Thomson scattering, whose cross-section
depends also on the polarisation, thus further complicating the treatment of photons
ﬂuctuations, which we nonetheless will bravely face.
5.1
General Form of the Perturbed Boltzmann Equation
Let us build in a general fashion the perturbed Boltzmann equation, in order to
understand ﬁrst and to tackle separately afterwards the terms which constitute it.
As we did in Eq.(4.77), the distribution function f can be split in a background
contribution plus a perturbation:
f (η, x, p) = ¯f (η, p) + F(η, x, p) ,
(5.1)
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_5
157

158
5
Perturbed Boltzmann Equations
where we have left explicit the functional dependence in order to stress that, after
breaking homogeneity and isotropy, the perturbed distribution function depends on
7 variables. Covariance demands the total distribution function f to be a function of
the 4-position and of the 4-momentum:
f = f (xμ, Pμ) ,
Pμ = dxμ
dλ ,
(5.2)
where λ is an afﬁne parameter. However, the total number of independent variables
is not 8 but 7, due to the mass-shell relation gμν PμPν = −m2.
We choose these seven variables to be xμ, the proper momentum modulus p and
the proper momentum direction ˆpi. Now, we are ready to write down the Liouville
operator with the above choice of coordinates in the phase space:
d f
dλ = P0 ∂f
∂η +
∂f
∂xi

1st order
Pi + ∂f
∂p
dp
dλ + ∂f
∂ˆpi
d ˆpi
dλ



2nd order
,
(5.3)
where we have already put in evidence the fact that ∂f/∂xi, ∂f/∂ˆpi and d ˆpi/dλ
are pure ﬁrst-order quantities, thereby making the last term of second order and thus
negligible. Let us see in some more detail why.
The term ∂f/∂xi is of ﬁrst order because it breaks homogeneity and the latter
can be broken only at ﬁrst order. The same reasoning goes for ∂f/∂ˆpi, which breaks
isotropy. Finally, d ˆpi/dλ is identically zero in the background cosmology, because
there is nothing that could deviate the path of a photon in a homogeneous and isotropic
space. Therefore, d ˆpi/dλ is a ﬁrst-order quantity.
Dividing by P0, we can write the ﬁrst-order perturbed Boltzmann equation as
follows:
d f
dη = ∂f
∂η + ∂f
∂xi
Pi
P0 + ∂f
∂p
dp
dη = 1
P0 C[ f ]
(5.4)
So, we have to deal with 3 terms:
1. The velocity term Pi/P0.
2. The force term dp/dη.
3. The collisional term C[ f ].
The velocity term is the easiest one to compute because it must be at zeroth order,
being ∂f/∂xi a ﬁrst-order quantity, as we have just discussed. Therefore, as we
already showed in Chap.3:
Pi
P0 = p
E ˆpi ,
(5.5)
which for photons and neutrinos simply becomes ˆpi.

5.1 General Form of the Perturbed Boltzmann Equation
159
The force term is made explicit through the geodesic equation and hence depends
on the metric perturbations. The only collisional term that we shall consider explicitly
is the one related to Thomson scattering and will be of interest just for photons and
free electrons.
5.1.1
On the Photon and Neutrino Perturbed Distributions
As we know, in the Hot Big Bang model the background distribution function for
photons and neutrinos are the BD and the FD ones:
¯fγ =
1
epγ/Tγ −1 ,
¯fν =
1
epν/Tν + 1 ,
(5.6)
with Tγ(η) ∝1/a(η) (far from electron-positron annihilation) and Tν(η) ∝1/a(η),
because of the thermal equilibrium and the cosmological principle. Their perturbed
distribution functions can be written in the same form, but with a perturbed temper-
ature:
Tγ(η, x, p) = Tγ(η) + δTγ(η, x, p) ,
Tν(η, x, p) = Tν(η) + δTν(η, x, p) . (5.7)
So, let us write the distribution functions as follows:
f −1 = exp

p
T + δT

∓1 .
(5.8)
Exercise 5.1 For δT ≪T , show that:
f = ¯f −p ∂¯f
∂p
δT
T
(5.9)
Hence:
F = −p ∂¯f
∂p
δT
T ,
(5.10)
the perturbed distribution function for neutrinos and photons can be physically inter-
preted as their relative temperature ﬂuctuations.

160
5
Perturbed Boltzmann Equations
5.2
Force Term
We now deal with the force term, which originates from the geodesic equation. We
shall calculate it ﬁrst for a perturbed metric a2hμν with h0i = 0 and then specify the
result obtained for the various perturbation types: scalar, tensor and vector.
Let us write the mass-shell relation gμν PμPν as follows:
−a2(1 −h00)(P0)2 + a2(δi j + hi j)Pi P j = −m2 ,
(5.11)
and hence deﬁne the energy and proper momentum modulus as:
E2 = a2(1 −h00)(P0)2 ,
p2 = a2(δi j + hi j)Pi P j .
(5.12)
Exercise 5.2 Determine dE/dη using the geodesic equation:
d P0
dλ = −0
αβ PαPβ .
(5.13)
First show that:
dE
dη = HE −E d(h00/2)
dη
−0
αβ
PαPβ
E
a2(1 −h00) .
(5.14)
Working out the Christoffel symbol term:
−20
αβ PαPβa2(1 −h00) = −2aa′(1 −h00)(P0)2 + a2h′
00(P0)2 + 2a2∂lh00P0Pl
−2aa′(δi j + hi j)Pi P j −a2h′
i j Pi P j .
(5.15)
Hence, using again the deﬁnitions of P0 and of the proper momentum, get:
−0
αβ
PαPβ
E
a2(1 −h00) = −HE + E h′
00
2 + p ˆpl∂lh00 −H p2
E −1
2E h′
i j pi p j .
(5.16)
Collecting all the above found contributions, we have
dE
dη = −H p2
E + p ˆpl∂l
h00
2 −1
2E h′
i j pi p j ,
(5.17)
and using the differentiated mass-shell relation EdE = pdp, we can write:

5.2 Force Term
161
dp
dη = −Hp + E ˆpl∂l
h00
2 −p
2 h′
i j ˆpi ˆp j
(5.18)
As we can see, if we choose the synchronous gauge then h00 = 0 and all the perturba-
tion types are elegantly taken into account in the last term. The Boltzmann equation
thus becomes:
f ′ + p ˆpi
E
∂f
∂xi + p

−H + E
p ˆpl∂l
h00
2 −1
2h′
i j ˆpi ˆp j
	 ∂f
∂p = a
E C[ f ] ,
(5.19)
where we have already used the fact that the collisional term is a ﬁrst-order quantity
and thus neglected its multiplication by h00. Separating the distribution function
in its background plus perturbed part f = ¯f + F, the perturbed part of the above
Boltzmann equation can be written as:
F′ + ikμp
E
F −Hp ∂F
∂p +

ikμE h00
2 −p
2 h′
i j ˆpi ˆp j
	 ∂¯f
∂p = a
E C[F]
(5.20)
where we have deﬁned
μ ≡ˆk · ˆp
(5.21)
This quantity plays a major role in the rest of these notes, so keep it in mind. Note that
the left hand side of the perturbed Boltzmann equation has an azimuthal dependence
possibly coming from h′
i j ˆpi ˆp j. We shall see that for scalar perturbations no azimuthal
dependence appears.
5.2.1
Scalar Perturbations
Using metric (4.171), we can identify h00 = −2 and hi j = 2δi j. the proper
momentum modulus is deﬁned as:
p2 = a2(1 + 2)δi j Pi P j ,
pi = a(1 + )Pi ,
(5.22)
and
P0 = E
a (1 −) .
(5.23)
The velocity term up to ﬁrst-order is thus the following:
dxi
dη = Pi
P0 = p(1 −) ˆpi
E(1 −) = p
E ˆpi(1 − + ) ,
(5.24)

162
5
Perturbed Boltzmann Equations
but of course we have to neglect  − in the Liouville operator since ∂f/∂xi is of
ﬁrst order.
From Eq.(5.18), we have:
dE
dη = −H p2
E −p2
E ′ −p ˆpi∂i ,
(5.25)
and then:
dp
dη = −Hp −p′ −E ˆpi∂i
(5.26)
The ﬁrst term on the right hand side of the above equation is of zeroth order and
is responsible for the cosmological redshift. The second takes into account the time
variation of the spatial curvature and the third is the gradient of the gravitational
potential along the direction of the photon.
Therefore, the perturbed Boltzmann equation with scalar perturbations has the
following general form:
F′ + p
E ˆpi∂iF −Hp ∂F
∂p −

p′ + E ˆpi∂i
 ∂¯f
∂p = a
E C[F]
(5.27)
The Fourier transform of the above Boltzmann equation can be cast as follows:
F′ + ikμ p
E F −Hp ∂F
∂p −

p′ + ikμE
 ∂¯f
∂p = a
E C[F]
(5.28)
5.2.2
Tensor Perturbations
From Eq.(4.190) we have that h00 = 0 and hi j = hT
i j, transverse and traceless. From
Eq.(5.18), we have:
dE
dη = −H p2
E −p2
2E hT ′
i j ˆpi ˆp j ,
dp
dη = −Hp −p
2 hT ′
i j ˆpi ˆp j ,
(5.29)
and the Fourier transform of the Boltzmann equation can be cast as follows:
F′ + ikμ p
E F −Hp ∂F
∂p −p
2 hT ′
i j ˆpi ˆp j ∂¯f
∂p = a
E C[F]
(5.30)
Ifwechoose ˆk = ˆz,fromEq.(4.198)wehavehT
11 = −hT
22 = h+ andhT
12 = hT
21 = h×,
hence the contributions ˆp1 and ˆp2 shall be selected, producing thus an azimuthal

5.2 Force Term
163
dependence. The particle direction unit vector can be written in spherical coordinates
as follows:
ˆp = ˆp = (

1 −μ2 cos φ,

1 −μ2 sin φ, μ)
(5.31)
again, because we have ﬁxed beforehand ˆk = ˆz.
Exercise 5.3 Show that:
hT ′
i j ˆpi ˆp j = h′
+(1 −μ2) cos 2φ + h′
×(1 −μ2) sin 2φ =
2

2π
15

Y 2
2 (μ, φ)(h′
+ −ih′
×) + Y −2
2 (μ, φ)(h′
+ + ih′
×)

=
4
 π
15

Y 2
2 (μ, φ)h′(λ = +2) + Y −2
2 (μ, φ)h′(λ = −2)

.
(5.32)
So the metric contribution in the case of tensor perturbations carries a Y ±2
2 (μ, φ)
proportionality, each coupled to the respective helicity of the GW.
5.2.3
Vector Perturbations
From Eq.(4.215) we have that h00 = 0 and hi j = hV
i j, traceless and with vanishing
double divergence. From Eq.(5.18), we have:
dE
dη = −H p2
E −p2
2E hV ′
i j ˆpi ˆp j ,
dp
dη = −Hp −p
2 hV ′
i j ˆpi ˆp j ,
(5.33)
and the Fourier transform of the Boltzmann equation can be cast in a form identical
to the tensor:
F′ + ikμ p
E F −Hp ∂F
∂p −p
2 hV ′
i j ˆpi ˆp j ∂¯f
∂p = a
E C[F]
(5.34)
In Eq.(4.227) we have deﬁned hV
13 = −i F1/2 and hV
23 = −i F2/2, hence again an
azimuthal dependence shall appear. In particular, using Eq.(5.31):
hV ′
i j ˆpi ˆp j = −i F′
1

1 −μ2μ cos φ −i F′
2

1 −μ2μ sin φ =
−

2π
15

Y 1
2 (μ, φ)(i F′
1 + F′
2) + Y −1
2 (μ, φ)(i F′
1 −F′
2)

=
−i

2π
15

Y 1
2 (μ, φ)F′
−+ Y −1
2 (μ, φ)F′
+

.
(5.35)

164
5
Perturbed Boltzmann Equations
So the metric contribution in the case of tensor perturbations carries a Y ±1
2 (μ, φ)
proportionality. Again, this result holds true only for ˆk = ˆz.
One might ask about a possible Y ±1
1 (μ, φ) contribution. This is absent because of
our choice h0i = 0.
5.3
The Perturbed Boltzmann Equation for CDM
We are going to consider only scalar perturbations sourcing the evolution of CDM
since, as we are going to see, we shall need only two equations: one for the density
contrast and the other for the ﬂuid velocity. The former only has a scalar contri-
bution whereas the latter does have a vector contribution, but negligible, as vector
perturbations usually are.
Hence, the perturbed Boltzmann equation for CDM is Eq.(5.27) with the col-
lisional term vanishing. We have seen that the latter may be important, at least for
WIMPs, at energies of the order of tens of MeV, before kinetic decoupling. However,
we are not interested in epochs so primordial.
We are going to take moments of Eq.(5.27) and show that we can neglect all of
them except the ﬁrst two, because CDM particles must be very massive, if thermally
produced. That is, we can treat CDM in the ﬂuid approximation.
Recalling the deﬁnitions Eqs.(4.80)–(4.84), multiply Eq.(5.27) with no C[F] by
E and integrate in the momentum space:
δρ′ + (ρ + P)∂ivi −H

d3p
(2π)3
∂F
∂p pE −′

d3p
(2π)3
∂¯f
∂p pE = 0 .
(5.36)
The integral multiplying ∂i is vanishing because ¯f has no angular dependence and
thus when integrated with ˆpi the result is zero.
Exercise 5.4 Show, integrating by parts, that:
−H

d3p
(2π)3
∂F
∂p pE = 3H

d3p
(2π)3 F

E + p2
3E
	
= 3H (δρ + δP) ,
(5.37)
and that
−′

d3p
(2π)3
∂¯f
∂p pE = 3′

d3p
(2π)3 ¯f

E + p2
3E
	
= 3′(ρ + P) .
(5.38)

5.3 The Perturbed Boltzmann Equation for CDM
165
Thus the integrated perturbed Boltzmann equation becomes:
δρ′ + (ρ + P)∂ivi + 3H(δρ + δP) + 3(ρ + P)′ = 0 .
(5.39)
Exercise 5.5 Show, using δρ = ρδ, that:
δ′ + (1 + w)kV + 3H
δP
δρ −w
	
δ + 3(1 + w)′ = 0
(5.40)
where we have introduced the background equation of state
w ≡P
ρ .
(5.41)
It is necessary to use the background conservation equation ρ′ = −3H(ρ + P) at
some point during the calculation.
Equation(5.40) is valid for any kind of ﬂuid with pressure, though for CDM we
shall consider w = 0 and δP = 0.
Equation(5.40) is not enough for describing the behaviour of CDM because we
do not know how V evolves. In order to ﬁnd an evolution equation for V we take the
ﬁrst moment of Eq.(5.28). That is, we multiply it by p ˆpi and then integrate. There
are four contributions which we address separately. We already consider contraction
with i ˆki in order to single out the scalar contribution.
1. The ﬁrst term is very straightforward:
i ˆki

d3p
(2π)3
∂F
∂η p ˆpi = ∂
∂η [(ρ + P)V ] = ρ(1 + w)V ′ −3Hρ(1 + w)2V + ρw′V .
(5.42)
For CDM, we shall take w = 0.
2. The second one is:
−ˆkikl

d3p
(2π)3 F p ˆpl
E p ˆpi = −k ˆki ˆklδT il = −kδP −k ˆki ˆklπil ,
(5.43)
where we have already met ˆki ˆklπil in Eq.(4.184). It corresponds to −(ρ + P)σ of
Ma and Bertschinger (1995). For CDM we shall neglect these contributions because
they are of order p2/E2 and hence negligible, being CDM cold.
3. The third integration is the following:
−i ˆkiH

d3p
(2π)3
∂F
∂p p2 ˆpi .
(5.44)

166
5
Perturbed Boltzmann Equations
Exercise 5.6 Integrate by parts and show that:
−i ˆkiH

d3p
(2π)3
∂F
∂p p2 ˆpi = 4ikiH

d3p
(2π)3 F p ˆpi = 4Hρ(1 + w)V .
(5.45)
The similar integration performed with ¯f p ˆpi in the ′ term is vanishing.
4. Finally, the fourth and last integration to be performed is the following:
k ˆki ˆkl

d3p
(2π)3
∂¯f
∂p Ep ˆpl ˆpi .
(5.46)
Since ¯f does not depend on ˆpi, the angular integration yields a δil/3. Hence, inte-
grating by parts, we arrive at the following result:
k ˆki ˆkl

d3p
(2π)3
∂¯f
∂p Ep ˆpl ˆpi = −k

d3p
(2π)3 ¯f

E + p2
3E
	
= −kρ(1 + w) .
(5.47)
We can ﬁnally put together the four contributions and the ﬁrst moment of the per-
turbed Boltzmann equation for CDM is the following:
V ′ + H(1 −3w)V +
w′
1 + w V −δP/δρ
1 + w kδ −k ˆki ˆklπil
ρ(1 + w) −k = 0
(5.48)
This equation corresponds to the Euler equation.
Exercise 5.7 Find the above two equations starting now from:
∇μδT μν = 0 ,
(5.49)
i.e. using the ﬂuid approximation directly, without passing through kinetic theory.
As we can appreciate, at each moment we take new variables appear, such as
V , δP and ˆki ˆklπil, and this demands to take further moments unless we decide to
truncate this procedure. This is possible if the particle velocity is very small, which
amounts to say a very large mass if the particle is in a thermal bath, as we showed in
Chap.3.1 This is the case for CDM, for which we shall use the truncated equations:
1In Piattella et al. (2013, 2016) the CDM velocity dispersion is taken into account and the second
moment of the Boltzmann equation is computed.

5.3 The Perturbed Boltzmann Equation for CDM
167
δ′
c + kVc + 3′ = 0
(5.50)
and
V ′
c + HVc −k = 0
(5.51)
We shall employ the same technique of taking momenta of the Boltzmann equation
also for baryons (free electrons). We shall ﬁnd the same results there as the ones
found here but with a source term in the equation for V , coming from the Thomson
collisional term which couples photons with free electrons.
Exercise 5.8 Find Eqs.(5.50) and (5.51) in the synchronous gauge. Show that one
can exploit the residual gauge freedom in order to choose V syn
c
= 0. Therefore, in
the synchronous gauge CDM is described by a single equation only.
5.4
The Perturbed Boltzmann Equation for Massless
Neutrinos
We do not discuss massive neutrinos here, though at least one of their families does
have a mass. On the other hand, for sufﬁciently early times, e.g. before recombina-
tion, they certainly behave as relativistic particles. For a treatment of the Boltzmann
equation for massive neutrinos see Ma and Bertschinger (1995).
Specializing Eq.(5.20) for massless neutrinos, i.e. setting p = E and neglecting
the collisional term, we have:
F′
ν + ikμFν −Hp ∂Fν
∂p + p

ikμh00
2 −1
2h′
i j ˆpi ˆp j
	 ∂¯fν
∂p = 0 .
(5.52)
In order to eliminate the partial derivative with respect to p, we multiply the above
equation by p and integrate it in the proper momentum modulus, using the deﬁnition:
 dp p2
2π2 pFν ≡4ρν(η)N(η, k, ˆp) .
(5.53)
The scalar part of N(η, k, ˆp) corresponds to the Fν/4 deﬁned in Ma and Bertschinger
(1995).
We could have started tackling Eq.(5.52) by taking its moments as we did in the
previous section for CDM. However, since massless neutrinos are relativistic, we are
not able to truncate the procedure at some point because p/E = 1, i.e. p/E never
is a small parameter. For this reason it is more convenient to build a hierarchy from

168
5
Perturbed Boltzmann Equations
N, as we shall see in this section. For massive neutrinos we also need a hierarchy
because their mass is very small, see Ma and Bertschinger (1995).
Performing the dp integration and using the deﬁnition of Eq.(5.53) in the Boltz-
mann equation (5.52), we get:
(4ρνN)′ + 4ikμρνN + 16HρνN −4ρν

ikμh00
2 −1
2h′
i j ˆpi ˆp j
	
= 0 .
(5.54)
Using the background evolution of the density:
ρ′
ν + 4Hρν = 0 ,
(5.55)
we can ﬁnally cast the neutrino Boltzmann equation as follows:
N ′ + ikμN −

ikμh00
2 −1
2h′
i j ˆpi ˆp j
	
= 0
(5.56)
Anycalculationswewoulddohereforneutrinosshallberepeatedalmoststep-by-step
later for photons. Indeed, the two Boltzmann equations are identical being the only
(huge) difference that for neutrinos we do not have a collisional term or polarisation.
5.4.1
Scalar Perturbations
For scalar perturbations the neutrino Boltzmann equation becomes:
N (S)′ + ikμN (S) + ′ + ikμ = 0
(5.57)
Inspecting Eq.(5.57) we note that it contains a differential operator which depends
just on μ. Hence, if the initial condition on N (S) is axisymmetric, i.e. also depends
only on μ, at any time we have N (S)(η, k, μ). This shall be our hypothesis.
We then expand N (S)(η, k, μ) in Legendre polynomials, or partial waves, follow-
ing the convention of Ma and Bertschinger (1995):
N (S)(η, k, μ) =
∞

ℓ=0
(−i)ℓ(2ℓ+ 1)N (S)
ℓ
(η, k)Pℓ(μ) ,
(5.58)
N (S)
ℓ
(η, k) =
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)N (S)(η, k, μ) .
(5.59)
So, applying Eq.(5.59) to Boltzmann equation (5.57) we obtain the following:

5.4 The Perturbed Boltzmann Equation for Massless Neutrinos
169
N (S)′
ℓ
+
ik
(−i)ℓ
 1
−1
dμ
2 μPℓN (S) +
′
(−i)ℓ
 1
−1
dμ
2 Pℓ+ ik
(−i)ℓ
 1
−1
dμ
2 μPℓ= 0 .
(5.60)
Using the orthogonality relation of the Legendre polynomials:
 1
−1
dx
2 Pℓ(x)Pℓ′(x) =
δℓℓ′
2ℓ+ 1 ,
(5.61)
the integrals of the above equation are easily computed as follows:
 1
−1
dμ
2 Pℓ=
δℓ0
2ℓ+ 1 ,
 1
−1
dμ
2 μPℓ=
δℓ1
2ℓ+ 1 .
(5.62)
Therefore, we must distinguish 3 cases: when only one of the above integrals con-
tributes or none of them does (for ℓ≥2). Moreover, we employ the following recur-
rence relation:
(ℓ+ 1)Pℓ+1(μ) = (2ℓ+ 1)μPℓ(μ) −ℓPℓ−1(μ) ,
(5.63)
which allows us to write:
ik
(−i)l
 1
−1
dμ
2 μPlN (S) = k(l + 1)
2l + 1 N (S)
l+1 −
kl
2l + 1N (S)
l−1 .
(5.64)
Exercise 5.9 Show that the hierarchy of Boltzmann equations for neutrinos is the
following:
(2ℓ+ 1)N (S)′
ℓ
+ k

(ℓ+ 1)N (S)
ℓ+1 −ℓN (S)
ℓ−1

= 0
(ℓ≥2) ,
(5.65)
3N (S)′
1
+ 2kN (S)
2
−kN (S)
0
= k
(ℓ= 1) ,
(5.66)
N (S)′
0
+ kN (S)
1
= −′
(ℓ= 0) .
(5.67)
This inﬁnite set of equations is called hierarchy because the ℓequation is sourced
by the ℓ+ 1 and ℓ−1 multipoles. Of course, it is not possible to solve numerically
an inﬁnite number of equations so some truncation it is necessary at a certain ℓmax.
Using the deﬁnitions (5.53) and (5.59), the monopole N (S)
0
can be written as:
4N (S)
0
= 1
ρν
 dμ
2
 dp p2
2π2 pFν = 1
ρν

d3p
(2π)3 pFν = δρν
ρν
= δν .
(5.68)

170
5
Perturbed Boltzmann Equations
Hence 4N (S)
0
= δν, i.e. the monopole is proportional to the density contrast.2 In
Chap.6 we shall see that indeed the primordial mode excited is just the monopole,
making thus reliable our assumption of axial symmetry. For the dipole N (S)
1 :
4N (S)
1
= i
ρν
 dμ
2 μ
 dp p2
2π2 pFν = i ˆkl
ρν

d3p
(2π)3 p ˆplFν = (ρν + Pν)
ρν
Vν = 4
3 Vν .
(5.69)
Hence, 3N (S)
1
= Vν. Finally, for the quadrupole:
4N (S)
2
= −1
ρν
 dμ
2 P2(μ)
 dp p2
2π2 pFν = −3
2ρν

d3p
(2π)3 p(ˆkl ˆpl ˆkm ˆpm −1/3)Fν
= −3
2ρν
ˆkl ˆkm

δT lm
ν
−1
3δlmδT i
ν i
	
= −3
2ρν
ˆkl ˆkmπlm
ν
.
(5.70)
Therefore, ˆkl ˆkmπlm
ν = −4ρνN (S)
2 /3. Similar expressions hold true for photons.
The above equations can be compared with those in Ma and Bertschinger (1995)
by making the identiﬁcation 4N (S)
0
= δν, 3kN (S)
1
= θν and 2N (S)
2
= σν.
Exercise 5.10 Show that Eq.(5.57) can be formally integrated as follows:
N (S)(η0, k, μ) = N (S)(ηi, k, μ)eikμ(ηi−η0) −
 η0
ηi
dη(′ + ikμ)eikμ(η−η0) ,
(5.71)
where ηi is some initial conformal time.
This result is called line-of-sight integral (Seljak and Zaldarriaga 1996). It is
a simple formal integration but it is very effective for the numerical calculation of
the evolution of CMB anisotropies. We shall see this in Chap.10. Note that the
gravitational potentials  and  couple only with N (S)
0,1,2 via the Einstein equations.
Hence, a way of avoiding the truncation of the hierarchy of Boltzmann equation is to
solve Eq.(5.71) together with its integrals which give N (S)
0,1,2. See Weinberg (2006).
We now introduce the expansion of a plane wave into spherical harmonics:
eik·r = 4π
∞

ℓ=0
ℓ

m=−ℓ
iℓY m∗
ℓ(ˆk)Y m
ℓ(ˆr) jℓ(kr) ,
(5.72)
where jℓis a spherical Bessel function and Y m
ℓis a spherical harmonic. The latter is
very often used in cosmology and especially in CMB physics because it is the natural
basis over which to expand quantities deﬁned on the sphere (the celestial sphere, in
astronomy). Since they are extremely important for our work to come, Sect.12.5 is
dedicated to them as a reminder.
2It is redundant to write N (S)
0
since the monopole has only the scalar contribution.

5.4 The Perturbed Boltzmann Equation for Massless Neutrinos
171
Recalling that μ = ˆk · ˆp, we introduce in Eq.(5.71) the following plane wave
expansion:
e−ik ˆk· ˆp(η0−η) = 4π
∞

ℓ′=0
ℓ′

m′=−ℓ′
(−i)ℓ′Y m′∗
ℓ′
(ˆk)Y m′
ℓ′ ( ˆp) jℓ′(kr)
(5.73)
where we have deﬁned:
r(η) ≡η0 −η
(5.74)
Using the addition theorem for spherical harmonics, the above result can be written
as:
eikμ(η−η0) =

ℓ
(−i)ℓ(2ℓ+ 1)Pℓ(μ) jℓ(kr) ,
(5.75)
where r ≡η0 −η and jℓ(kr) is a spherical Bessel function. Now, note that:
−ikμeikμ(η−η0) =  d
dη0
eikμ(η−η0) .
(5.76)
Therefore, Eq.(5.71) can be written as follows:
N (S)(η0, k, μ) =

ℓ
(−i)ℓ(2ℓ+ 1)Pℓ(μ)

N (S)(ηi, k, μ) jℓ(kri) −
 η0
ηi
dη

′ − d
dη0
	
jℓ(kr)

.
(5.77)
We shall see in Chap.6 that at early times (ηi →0) the monopole contribution is
dominant, hence we may approximate N (S)(ηi, k, μ) ≈N (S)
0 (ηi, k) and thus write:
N (S)
ℓ
(η0, k) = N (S)
0 (ηi, k) jℓ(kη0) −
 η0
0
dη

′ jℓ(kr) −j′
ℓ(kr)

.
(5.78)
Of course we cannot really set ηi = 0 since this is the cosmological singularity.
Such equation should be understood as ηi →0. Knowing the gravitational potentials
allows us to determine N (S)
ℓ
without solving the hierarchy of Boltzmann equations.
The advantage is that  and  are determined from the Einstein equations, which
couple only with N (S)
0,1,2.
Exercise 5.11 Write the Boltzmann equation for neutrinos in the cases of tensor and
vector perturbations. It might be useful to ﬁrst study those for photons in the next
section.

172
5
Perturbed Boltzmann Equations
5.5
The Perturbed Boltzmann Equation for Photons
The Boltzmann equation for photons has a collisional term, coming from Thomson
scattering among photons and free electrons. Thomson scattering is an excellent
approximation as long as the energy of the photon is much smaller than the electron
mass, i.e. hν ≪511keV which corresponds to a redshift ≈1010 (the same order as
the BBN one). So, as long as we deal with much smaller redshifts, our approximation
is ﬁne. If not, then the Klein–Nishina cross-section should be taken into account.
The scales of cosmological interest today were well outside the particle horizon
for those large redshifts and we shall see that the evolution of perturbations on these
super-horizon regimes is somewhat peculiar. In order to be convinced of this, consider
a scale k today which, in order to be observationally interesting, must be much smaller
than the particle horizon, which is proportional to H0. Thus k ≫H0. At some time
in the past, this condition becomes k ≪H, since H diverges for η →0. To be more
quantitative, using Friedmann equation in the radiation-dominated epoch one has:
k
H ≈
ka
H0
√r0
≈
102
(1 + z)
k
H0
.
(5.79)
So, even a scale k = 100H0, which is today of order of 40Mpc (already in the non-
linear regime of evolution) for redshifts larger than 104 was outside the horizon.
An important feature of Thomson scattering is that the photon energy remains
unchanged. This means that C[Fγ] does not depend on the photon energy p. Hence,
as we did in the massless neutrino case, we can integrate the whole Boltzmann
equation with respect to p, and deﬁne:
 dp p2
2π2 pFγ ≡4ργ(η)(η, k, ˆp)
(5.80)
where  corresponds to Fγ/4 of Ma and Bertschinger (1995). The treatment of the
Boltzmann equation for photons is more complicated with respect to the neutrino
case because of the presence of a collisional term which depends on polarisation.
We have therefore to develop three Boltzmann equations: One for each of , Q and
U. The latter are the two Stokes parameters related to linear polarisation.  is also
a Stokes parameter, related to the intensity of light, i.e. its energy density, and for
this reason it is the only parameter which couples to the metric. Thomson scattering
does not produces circular polarisation and thus V = 0. If the reader is not familiar
with polarisation of light and Stokes parameters, Sect.12.7 offers a brief reminder.
InthenextsubsectionweexplicitlycomputethecollisionaltermfortheBoltzmann
equation for photons without considering polarisation.

5.5 The Perturbed Boltzmann Equation for Photons
173
5.5.1
Computing the Collisional Term Neglecting
Polarisation
Consider scattering among photons and free electrons:
e−(q) + γ(p) ↔e−(q′) + γ(p′) ,
(5.81)
where the the photon energy is unchanged, i.e. p = p′, but its direction has been
modiﬁed. The right hand side of Eq.(5.28) can be written as follows:
Ceγ ≡a
pC[Fγ(p)] = a
p

d3q
(2π)32Ee(q)

d3q′
(2π)32Ee(q′)

d3p′
(2π)32p′ |M|2
(2π)4δ(3)(p + q −p′ −q′)δ[p + Ee(q) −p′ −Ee(q′)]
 ¯fe(q′)Fγ(p′) + Fe(q′) ¯fγ(p′) −¯fe(q)Fγ(p) −Fe(q) ¯fγ(p)

,
(5.82)
Evidently, the zeroth order term
¯fe(q′) ¯fγ(p′) −¯fe(q) ¯fγ(p) ,
(5.83)
yields a vanishing integration because the energies do not change. Hence this colli-
sional term is a perturbative quantity.
At recombination  is of order 10−5, so the linear approximation is reasonable.
However, there is another term which we must take into account: the electron velocity
q/me, which causes a Doppler shift in the CMB photons. Therefore, we should keep
track also of that when working on Eq.(5.82). In particular, being the electron non-
relativistic and in the thermal bath with photons, then q/me ∼√T/me. For thermal
energies of ∼1eV then q/me ∼10−3, so it is a contribution that we deﬁnitely want
to take into account.
Let us start our task. Expand the electron energy as usual:
Ee(q) =

q2 + m2e = me + q2
2me
+ · · · ,
(5.84)
and write Eq.(5.82) in the following way:
Ceγ =
aπ
4m2e p

d3q
(2π)3
 dp′ p′d2 ˆp′
(2π)3
|M( ˆp, ˆp′)|2δ

p + q2
2me
−p′ −(p + q −p′)2
2me

 ¯fe(q)Fγ(p′) + Fe(q) ¯fγ(p′) −¯fe(q)Fγ(p) −Fe(q) ¯fγ(p)

.
(5.85)
Here, we have used the 3-momentum Dirac delta in order to eliminate the integration
with respect to q′ and at the denominator of the volume elements we have used just

174
5
Perturbed Boltzmann Equations
Ee = me, because we need to keep track only of terms of the ﬁrst order in q/me.
Indeed:
1
Ee
=
1
me +
q2
2me
≈1 −q2/(2m2
e)
me
,
(5.86)
and theq2/m2
e correction to the collisional term is totally negligible (it is something of
order 10−12). We have also put in evidence the ( ˆp, ˆp′) dependence of the probability
amplitude and used
fe(p + q −p′) ≈fe(q)
(5.87)
Physically, this happens because the electron mass-energy is so much larger than that
of the average photon (something like 6 orders of magnitude) that the latter is unable
to deviate the former from its path. It is like deviating a truck with a tennis ball.
More quantitatively, we can prove the goodness of the above approximation by
using the 4-momentum conservation:
pμ
γ + qμ
e = p
′μ
γ + q
′μ
e .
(5.88)
The zero component gives us the energy conservation. Since the photon energy E
does not change, so does not the electron energy Ee.
Exercise 5.12 In Eq.(5.88), put the photon 4-momenta on the same side and the
electron ones on the other side and square. Show that:
E2(1 −cos αγ) = q2(1 −cos αe) ,
(5.89)
where αγ is the angle between the photon directions and αe is the angle between the
electron directions.
Being in a thermal bath, the photon energy is of order E ∼T , whereas the electron
momentum is of order q ∼√meT . Therefore:
T
me
(1 −cos αγ) ∼1 −cos αe .
(5.90)
Since T ≪me (because the electron is non-relativistic) one can see that αe ∼
√T/me, i.e. the electron is only slightly deviated upon the scattering.
The electron ﬁnal energy can be expanded as follows:
(p + q −p′)2
2me
= q2
2me
+ q · (p −p′)
me
+ (p −p′)2
2me
,
(5.91)
and using this expansion in the energy Dirac delta in Eq.(5.85) we obtain:

5.5 The Perturbed Boltzmann Equation for Photons
175
δ

p −p′ + q · (p′ −p)
me

,
(5.92)
where we have neglected the (p −p′)2/me contribution, because |p −p′| is at most
2p and the typical energy of the photon is that of the thermal bath, i.e. T ≪me.
The Dirac delta can be formally Taylor-expanded as follows:
δ

p −p′ + q · (p′ −p)
me

= δ(p −p′) + ∂δ(p −p′)
∂p′
q
me
· (p −p′) .
(5.93)
and the collisional term (5.85) is cast as follows:
Ceγ =
aπ
4m2e p

d3q
(2π)3
 dp′ p′d2 ˆp′
(2π)3
|M( ˆp, ˆp′)|2 ×
×

δ(p −p′) + ∂δ(p −p′)
∂p′
q
me
· (p −p′)

×
×
 ¯fe(q)Fγ(p′) + Fe(q) ¯fγ(p′) −¯fe(q)Fγ(p) −Fe(q) ¯fγ(p)

.
(5.94)
Exercise 5.13 Show that, exploiting the two Dirac deltas, we obtain:
Ceγ =
ane
32π2m2e

d2 ˆp′|M( ˆp, ˆp′)|2 
Fγ(p′) −Fγ(p)

+
anevb
32π2m2e p ·

p′dp′d2 ˆp′|M( ˆp, ˆp′)|2 ∂δ(p −p′)
∂p′
(p −p′)
 ¯fγ(p′) −¯fγ(p)

,
(5.95)
where
ne ≡

d3q
(2π)3 ¯fe(q) ,
nemevb ≡

d3q
(2π)3 Fe(q)q .
(5.96)
Note that we have assumed that ve = vp = vb, i.e. the velocity of the electron
ﬂuid to be equal to that of the proton one and then we have called it baryon ﬂuid
velocity. This is justiﬁed by the fact that Coulomb scattering tightly couples electrons
and protons.
For Thomson scattering we have that (see Sect.12.8):

d2 ˆp′|M( ˆp, ˆp′)|2 = 32π2m2
eσT ,

d2 ˆp′|M( ˆp, ˆp′)|2 ˆp′ = 0 ,
(5.97)
where the latter equation simply establishes the fact that Thomson scattering has not a
a priori preferred direction. Therefore, integrating by parts the Dirac delta derivative,
we get:

176
5
Perturbed Boltzmann Equations
Ceγ = τ ′Fγ(p ˆp) +
ane
32π2m2e

d2 ˆp′|M( ˆp, ˆp′)|2Fγ(p ˆp′) + p ∂¯fγ
∂p τ ′vb · ˆp ,
(5.98)
where we have introduced the optical depth:
τ(η) ≡
 η0
η
dη′neσT a ,
τ ′ = −neσTa
(5.99)
As we did for neutrinos, since |M|2 does not depend on p, we can multiply the full
Boltzmann equation by p and integrate in the modulus of the proper momentum.
The Boltzmann equation for photons thus becomes:
4ργ

′ + ikμ −ikμh00
2 + 1
2h′
i j ˆpi ˆp j
	
=
 dp p2
2π2 p Ceγ ,
(5.100)
and substituting the collisional term of Eq.(5.98) we ﬁnd:
′ + ikμ −ikμh00
2
+ 1
2 h′
i j ˆpi ˆp j = τ′ +
ane
32π2m2e

d2 ˆp′|M( ˆp, ˆp′)|2( ˆp′) −τ′ ˆp · vb .
(5.101)
The term containing the Thomson scattering amplitude can be split as follows:
ane
32π2m2e

d2 ˆp′|M|2( ˆp′) = −τ′
 d2 ˆp′
4π ( ˆp′) +
ane
32π2m2e

d2 ˆp′|M′|2( ˆp′) .
(5.102)
The last contribution of the above equation has the following form:
ane
32π2m2e

d2 ˆp′|M′|2( ˆp′) = −τ ′
10
2

m=−2
Y m
2 ( ˆp)

d2 ˆp′Y m′∗
2
( ˆp′)( ˆp′) .
(5.103)
We now introduce the contribution from polarisation. We work out the collisional
term in Sect.12.8.
5.5.2
Full Boltzmann Equation Including Polarisation
The original derivation of the Thomson scattering matrix can be found in Chan-
drasekhar (1960). The theoretical framework for the CMB polarisation can be found
e.g. in Kosowsky (1996), but also in Weinberg (2008). Here we write already the
ﬁnal equation that we are going to analyse, following Hu and White (1997) and Tram
and Lesgourgues (2013), and derive the collisional term in Sect.12.8.
Following Tram and Lesgourgues (2013), the three combined Boltzmann equa-
tions for , Q and U can be written as:

5.5 The Perturbed Boltzmann Equation for Photons
177
 ∂
∂η + ikμ
	 ⎛
⎝

Q
iU
⎞
⎠−τ ′
⎛
⎝
 −
 d2 ˆp′
4π ( ˆp′) −ˆp · vb
Q
iU
⎞
⎠
+
⎛
⎝
−ikμ h00
2 + 1
2h′
i j ˆpi ˆp j
0
0
⎞
⎠=
−τ ′
10
2

m=−2
⎡
⎣
Y m
2 ( ˆp)
1
2Em( ˆp)
1
2Bm( ˆp)
⎤
⎦

d2 ˆp′
⎡
⎢⎣
Y m∗
2  −

3
2Em∗Q′ −

3
2Bm∗iU
−
√
6Y m∗
2  + 3Em∗Q + 3Bm∗iU
−
√
6Y m∗
2  + 3Em∗Q + 3Bm∗iU
⎤
⎥⎦( ˆp′) ,
(5.104)
where we have used the deﬁnition:
Em ≡2Y m
2 + −2Y m
2 ,
Bm ≡2Y m
2 −−2Y m
2 ,
(5.105)
where ±2Y m
2 are the spin-2 weighted spherical harmonics. Their explicit form is given
in Tables5.1 and 5.2.
Inspecting the above trio of Boltzmann equations in Eq.(5.104), one can see that
iU and Bm Q/Em satisfy the same Boltzmann equation. Hence, since they have the
same initial condition (which is zero, as we shall see in Chap.6), we just need a
single polarisation hierarchy. This is the principal result of Tram and Lesgourgues
(2013), which contributes to make the CLASS code faster. Choosing the Q one, we
have thus for the temperature ﬂuctuation:
Table 5.1 Explicit functional form of the spin-0 and spin-2 spherical harmonics. Note that the spin-
2 spherical harmonics can be obtained by the spin-2 by spatial inversion, i.e. −2Y m
2 ( ˆp) = 2Y m
2 (−ˆp).
In these notes, we omit the Condon–Shortley phase
m
Y m
2
2Y m
2
0
1
4

5
π (3 cos2 θ −1)
3
4

5
6π sin2 θ
±1
1
2

15
2π sin θ cos θe±iφ
1
4

5
π sin θ(1 ∓cos θ)e±iφ
±2
1
4

15
2π sin2 θe±2iφ
1
8

5
π (1 ∓cos θ)2e±2iφ
Table 5.2 Explicit functional form of Em and Bm
m
Em
Bm
0

15
8π sin2 θ
0
±1
−1
2

5
π sin θ cos θe±iφ
1
2

5
π sin θe±iφ
±2
1
4

5
π (1 + cos2 θ)e±2iφ
−1
2

5
π cos θe±2iφ

178
5
Perturbed Boltzmann Equations
 ∂
∂η + ikμ
	
 −τ ′

 −
 d2 ˆp′
4π ( ˆp′) −ˆp · vb

−ikμh00
2 + 1
2h′
i j ˆpi ˆp j =
−τ ′
10
2

m=−2
Y m
2 ( ˆp)

d2 ˆp′

Y m∗
2  −

3
2Em∗Q −

3
2
(Bm∗)2
Em∗
Q

( ˆp′) ,
(5.106)
and for polarisation:
 ∂
∂η + ikμ
	
Q −τ ′Q =
τ ′
10
2

m=−2

3
2Em( ˆp)

d2 ˆp′

Y m∗
2  −

3
2Em∗Q −

3
2
(Bm∗)2
Em∗
Q

( ˆp′) .
(5.107)
Note that on the left hand side of Eq.(5.106) the dependence on the photon direction
ˆp enters through μ = ˆk · ˆp and through h′
i j ˆpi ˆp j, which also depends on μ for scalar
perturbations, cf. Eq.(5.28), and on μ and and the azimuthal angle φ for tensor and
vector perturbations if ˆk = ˆz, cf. Eqs.(5.32) and (5.35). Instead, on the right hand
side of Eq.(5.106) the dependence on the photon direction is Y m
2 ( ˆp).
In order to match the angular dependences on the two sides, making the equation
easier to manipulate, and also in order to easily express the metric contribution for
tensor and vector perturbations, it is convenient to set ˆk = ˆz. In order to recall this,
we deﬁne:
P(kˆz) ≡Q(kˆz) .
(5.108)
As we shall see in Chap.10, before performing the anti-Fourier transform in order to
recover the physical quantities in the real space, we shall have to apply ﬁrst a spatial
rotation in order to recover a generic direction for ˆk. This rotation compensates if one
computes straightaway the angular power spectra, since they are rotational-invariant
quantities. In this case one can use at once the results of the equations of this section.
Choosing then a frame in which ˆk = ˆz, comparing Y m
2 (μ, φ) with Eqs.(5.32) and
(5.35) allows us to see that the m = 0 contribution of the sum on the right hand side
of Eq.(5.106) couples to scalar perturbations only, the m = ±2 contributions couple
to tensor perturbations and the m = ±1 to vector perturbations.
Note that for scalar perturbations one has that U = 0 in the reference frame ˆk = ˆz,
since B0 = 0.
Unless differently stated, in the following the functional dependences of  and
P are on η, k = kˆz and μ and φ. The metric quantities do not depend on μ and φ.

5.5 The Perturbed Boltzmann Equation for Photons
179
5.5.3
Scalar Perturbations
For scalar perturbations we have that:
−ikμh00
2 + 1
2h′
i j ˆpi ˆp j = ′ + ikμ ,
(5.109)
( ˆp · vb)(S) = −iμVb ,
(5.110)
since recall that the scalar part of vb is v(S)
b
= −i ˆkVb. Note that, as in the case of
neutrinos, since no azimuthal dependence appears in the differential equation, it is
natural to assume axial symmetry in (S), i.e. (S)(η, kˆz, μ).
AsweshallseeinChap.10,thescalarcontribution(S) istheonewhichdominates
the CMB temperature ﬂuctuations because it is sourced by scalar perturbations in the
metric, which are the strongest since they can grow (they are compressional modes).
The same goes for (S)
P (η, kˆz, ˆp), which is not sourced by metric ﬂuctuations and
therefore its angular dependence is less constrained. Nonetheless, we assume that
the scalar part also depends only on μ. Note the dependence on k = kˆz as a reminder
that ˆk = ˆz.
Exercise 5.14 Perform the integration in dφ′ for the m = 0 contribution of
Eqs.(5.106) and (5.107) and using the results of Tables5.1 and 5.2 show that:
 ∂
∂η + ikμ
	
(S) −τ ′

(S) −
 dμ′
2 (S)(μ′) + iμVb

+ ′ + ikμ =
−τ ′
2 P2(μ)
 dμ′
2

P2(S) −(1 −P2)(S)
P

(μ′) ,
(5.111)
and
 ∂
∂η + ikμ
	
(S)
P −τ ′(S)
P =
−τ ′
2 [1 −P2(μ)]
 dμ′
2

−P2(S) + (1 −P2)(S)
P

(μ′) .
(5.112)
Recall now the partial wave expansions already used for the neutrino distribution:
(S)
ℓ
=
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)(S)(μ) ,
(S)
Pℓ=
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)(S)
P (μ) ,
(5.113)

180
5
Perturbed Boltzmann Equations
Exercise 5.15 Show that the Boltzmann equations for the scalar contribution to the
photon temperature and polarisation are:
(S)′ + ikμ(S) + ′ + ikμ = −τ ′

(S)
0
−(S) −iμVb −1
2P2(μ)

(5.114)
(S)′
P
+ ikμ(S)
P = −τ ′

−(S)
P + 1
2[1 −P2(μ)]

(5.115)
where  is deﬁned as follows:
 ≡(S)
2
+ (S)
P2 + (S)
P0
(5.116)
The anisotropic nature of Thomson scattering and polarisation were neglected by
Peebles and Yu (1970) whereas the former only was included by Wilson and Silk
(1981). Polarisation was considered in Bond and Efstathiou (1984).
The above two equations are usually expanded in Legendre polynomials, as we
did for the neutrino equation. Using then Eq.(5.113) applied to Eq.(5.114), we obtain
the following equation:
(S)′
ℓ
+
ik
(−i)ℓ
 1
−1
dμ
2 μPℓ(S) = −′
(−i)ℓ
 1
−1
dμ
2 Pℓ+ ik
(−i)ℓ
 1
−1
dμ
2 μPℓ
−τ ′

(S)
0
(−i)ℓ
 1
−1
dμ
2 Pℓ−(S)
l
−iVb
(−i)ℓ
 1
−1
dμ
2 μPℓ−

2(−i)ℓ
 1
−1
dμ
2 P2Pℓ

.
(5.117)
Using the orthogonality relation of the Legendre polynomials, cf. Eq.(5.61), the
integrals of the above equation are easily computed as follows:
 1
−1
dμ
2 Pℓ=
δℓ0
2ℓ+ 1 ,
 1
−1
dμ
2 μPℓ=
δℓ1
2ℓ+ 1 ,
 1
−1
dμ
2 P2Pℓ=
δℓ2
2ℓ+ 1 .
(5.118)
Therefore, we must distinguish among 4 cases, i.e. when one of the above inte-
grals contributes or none of them does (for ℓ> 2). We shall make use again of the
recurrence relation of Eq.(5.63), which allows us to write:

5.5 The Perturbed Boltzmann Equation for Photons
181
(2ℓ+ 1)(S)′
ℓ
+ k

(ℓ+ 1)(S)
ℓ+1 −ℓ(S)
ℓ−1

= τ ′(2ℓ+ 1)(S)
ℓ
,
ℓ> 2
(5.119)
The equation for the quadrupole ℓ= 2:
10(S)′
2
+ 2k
"
3(S)
3
−2(S)
1
#
= 10τ ′(S)
2
−τ ′
(5.120)
The equation for the dipole ℓ= 1:
3(S)′
1
+ k
"
2(S)
2
−(S)
0
#
= k + τ ′ "
3(S)
1
−Vb
#
(5.121)
Finally, the equation for the monopole ℓ= 0:
(S)′
0
+ k(S)
1
= −′
(5.122)
For the polarisation equation the steps to be performed are the same. Therefore:
(S)′
Pℓ+ k(ℓ+ 1)
2ℓ+ 1 (S)
P(ℓ+1) −
kℓ
2ℓ+ 1(S)
P(ℓ−1) =
−τ ′

−(S)
Pℓ+

2(−i)ℓ
 1
−1
dμ
2 Pℓ−

2(−i)ℓ
 1
−1
dμ
2 PℓP2(μ)

.
(5.123)
So, the equation for ℓ> 2 is the following:
(2ℓ+ 1)(S)′
Pℓ+ k

(ℓ+ 1)(S)
P(ℓ+1) −ℓ(S)
P(ℓ−1)

= τ ′(2ℓ+ 1)(S)
Pℓ,
ℓ> 2
(5.124)
The equation for the quadrupole ℓ= 2:
10(S)′
P2 + 2k
"
3(S)
P3 −2(S)
P1
#
= 10τ ′(S)
P2 −τ ′
(5.125)
The equation for the dipole ℓ= 1:
3(S)′
P1 + k
"
2(S)
P2 −(S)
P0
#
= 3τ ′(S)
P1
(5.126)
Finally, the equation for the monopole ℓ= 0:
2(S)′
P0 + 2k(S)
P1 = 2τ ′(S)
P0 −τ ′
(5.127)

182
5
Perturbed Boltzmann Equations
In order to compare with Ma and Bertschinger (1995), one has to make the identiﬁ-
cation 4(S)
0
= δγ, 3k(S)
1
= θγ, 2(S)
2
= σγ and kVb = θb.
Note that the monopole and the dipole are thus related to the density contrast
and to the photon ﬂuid velocity, hence they are gauge-dependent. In particular, the
monopole can be reabsorbed into the determination of the background temperature
whereas the dipole by a suitable boost. On the other hand, the quadrupole is related to
the anisotropic stress, so it is gauge-invariant as well as the higher-order multipoles.
5.5.4
Tensor Perturbations
We derive in this section the hierarchy of equations describing the evolution of
ﬂuctuations in the photon distribution caused by tensor perturbations, i.e. by GW.
Consider the tensor contribution of Eq.(5.106). Using Eq.(5.32) we have:
 ∂
∂η + ikμ
	
(T ) −τ ′(T ) + h′
+
2 (1 −μ2) cos 2φ + h′
×
2 (1 −μ2) sin 2φ =
−τ ′
10
2

m=−2
Y m
2 ( ˆp)

d2 ˆp′

Y m∗
2 (T ) −

3
2Em∗(T )
P
−

3
2
(Bm∗)2
Em∗(T)
P

( ˆp′) ,
(5.128)
whereas for the polarisation part:
 ∂
∂η + ikμ
	
(T)
P
−τ ′(T)
P
=
τ ′
10
2

m=−2

3
2Em

d2 ˆp′

Y m∗
2 (T ) −

3
2Em∗(T )
P
−

3
2
(Bm∗)2
Em∗(T )
P

( ˆp′) .
(5.129)
Note that in Eq.(5.106) the monopole term

d ˆp /4π is a pure scalar and therefore
does not provide any tensor contribution. The scalar product vb · ˆp has a scalar
contribution, used in the previous subsection, which is iμVb, and it has also a vector
contribution which can be written as:
(vb · ˆp)(V ) = U 1
b sin θ cos φ + U 2
b sin θ sin φ ,
(5.130)
where we have used Eq.(5.31) and the fact that kiU i
b = 0 because of the vector nature
of U i
b and the choice of having k3 = k, i.e. ˆk = ˆz. So, vb · ˆp does have an azimuthal
dependence, but not in the form of ei2φ and thus cannot contribute to the tensor
Boltzmann equation (it contributes to the vector one).

5.5 The Perturbed Boltzmann Equation for Photons
183
Mimicking the azimuthal dependence produced by tensor perturbations in the
metric, we can split the tensor contribution to the temperature anisotropy as follows,
following Polnarev (1985) and Crittenden et al. (1993):
(T )(μ, φ) = (T)
+ (μ)(1 −μ2) cos 2φ + (T )
× (μ)(1 −μ2) sin 2φ
= 4
 π
15

λ=±2
(T)
λ (μ)Y λ
2 (μ, φ)
(5.131)
where we have reproduced the sum over the helicities of Eq.(5.32), and similarly for
the polarisation ﬁeld:
(T)
P (μ, φ) = (T )
P+(μ)(1 + μ2) cos 2φ + (T)
P×(μ)(1 + μ2) sin 2φ
= 4
 π
15

3
2

λ=±2
(T )
Pλ(μ)Eλ(μ, φ)
(5.132)
So we have to select m = ±2 in sum on the right hand side of Eq.(5.106), and we
get:
 ∂
∂η + ikμ −τ ′
	
(T)
λ
+ h′
λ
2 =
−τ ′
10

d2 ˆp′

Y λ∗
2 (T )
λ Y λ
2 −3
2Eλ∗(T )
PλEλ∗−3
2
(Bλ∗)2
Eλ∗(T)
PλEλ

( ˆp′) , (5.133)
whereas for the polarisation part:
 ∂
∂η + ikμ −τ ′
	
(T)
Pλ =
τ ′
10

d2 ˆp′

Y λ∗
2 (T )
λ Y λ
2 −3
2Eλ∗(T)
PλEλ −3
2
(Bλ∗)2
Eλ∗(T)
PλEλ

( ˆp′) ,
(5.134)
where λ = ±2 and the equations are identical for the two choices. Let us work out
the right hand sides.
Exercise 5.16 With the help of Tables5.1 and 5.2 show that the integral on the right
hand sides becomes:
−τ ′
10

dμdφ 15
32π

(1 −μ2)2(T)
λ
−(1 + 6μ2 + μ4)(T )
Pλ

.
(5.135)

184
5
Perturbed Boltzmann Equations
Let us introduce an expansion in Legendre polynomials for (T )
λ (μ) and (T )
P,λ(μ)
similar to that in Eq.(5.113):
(T)
λ,ℓ=
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)(T)
λ (μ) ,
(T)
Pλ,ℓ=
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)(T)
Pλ(μ) .
(5.136)
Exercise 5.17 Rewrite the contributions (1 −μ2)2 and (1 + 6μ2 + μ4) in terms of
Legendre polynomials, and show that:
−3τ ′
16
 dμ
2
 8
35P4(μ) −80
105P2(μ) + 8
15P0(μ)

(T)
λ
+3τ ′
16
 dμ
2
 8
35P4(μ) + 32
7 P2(μ) + 16
5 P0(μ)

(T)
Pλ .
(5.137)
Hence, using Eq.(5.136), we can write the tensor Boltzmann equation for photons
as follows (Crittenden et al. 1993):
 ∂
∂η + ikμ −τ ′
	
(T)
λ
+ 1
2h′
λ =
−τ ′
 3
70(T)
λ,4 + 1
7(T )
λ,2 + 1
10(T)
λ,0 −3
70(T )
Pλ,4 + 6
7(T)
Pλ,2 −3
5(T )
Pλ,0

,(5.138)
and for polarisation:
 ∂
∂η + ikμ −τ ′
	
(T)
Pλ =
τ ′
 3
70(T )
λ,4 + 1
7(T)
λ,2 + 1
10(T )
λ,0 −3
70(T)
Pλ,4 + 6
7(T)
Pλ,2 −3
5(T)
Pλ,0

. (5.139)
The same equations hold true also for (T)
+,× and (T)
P+,×. The combination of terms
between square brackets in the above equations is sometimes dubbed as  in the
literature. Since for us  is already used as one of the Bardeen potentials, in Chap.10
we shall use another notation.
5.5.5
Vector Perturbations
For completeness, we present here the Boltzmann equation for photons sourced by
vector perturbations in the metric, though we shall not use it. Using Eqs.(5.35) and
(5.130), we can write:

5.5 The Perturbed Boltzmann Equation for Photons
185
 ∂
∂η + ikμ −τ ′
	
(V ) −
τ ′
cos θ

2π
15 (Y 1
2 Ub,−+ Y −1
2 Ub,+)
−i
2

2π
15 (Y 1
2 F′
−+ Y −1
2
F′
+) =
−τ ′
10
2

m=−2
Y m
2 ( ˆp)

d2 ˆp′

Y m∗
2 (V ) −

3
2Em∗(V )
P
−

3
2
(Bm∗)2
Em∗(V )
P

( ˆp′) ,
(5.140)
where
Ub,± ≡Ub1 ± iUb2 ,
(5.141)
and for the polarisation:
 ∂
∂η + ikμ −τ ′
	
(V )
P
=
τ ′
10
2

m=−2

3
2Em

d2 ˆp′

Y m∗
2 (V ) −

3
2Em∗(V )
P
−

3
2
(Bm∗)2
Em∗(V )
P

( ˆp′) .
(5.142)
Introduce the vector contribution to temperature anisotropy as follows:
(V )(μ, φ) =
i
cos θ

2π
15

λ=±1
(V )
λ (μ)Y −λ
2 (μ, φ)
(5.143)
where the factor 1/ cos θ is due to the fact that in Eq.(5.130) only a sin θ appears and
thus it is not proportional to Y ±1
2 . Similarly, for the polarisation ﬁeld:
(V )
P (μ, φ) = −
π
5

λ=±1
(V )
Pλ (μ)E−λ(μ, φ)
(5.144)
The vector Boltzmann equation for the temperature can then be written as:
 ∂
∂η + ikμ −τ ′
	
(V )
λ
+ iτ ′Ub˘ −1
2 F
′
λμ =
iτ ′
10 μ

d2 ˆp′

Y −λ∗
2
(V )
λ
i
μ′ Y −λ
2
+ 3
2E−λ∗(V )
Pλ E−λ + 3
2
(B−λ∗)2
E−λ∗(V )
Pλ E−λ

,
(5.145)
and for polarisation:

186
5
Perturbed Boltzmann Equations
 ∂
∂η + ikμ −τ ′
	
(V )
Pλ =
−τ ′
10

d2 ˆp′

Y −λ∗
2
(V )
λ
i
μ′ Y −λ
2
+ 3
2E−λ∗(V )
Pλ E−λ + 3
2
(B−λ∗)2
E−λ∗(V )
Pλ E−λ

,
(5.146)
With the help of Table5.1 we have then to work out the integral:
−τ ′
10

dμdφ 15
8π

μ(1 −μ2)i(V )
λ
+ (1 −μ4)(V )
Pλ

,
(5.147)
which, written in Legendre polynomial, becomes:
−3τ ′
4
 dμ
2
2
5P1(μ) −2
5P3(μ)

i(V )
λ
−3τ ′
4
 dμ
2
4
5P0(μ) −4
7P2(μ) −8
35P4(μ)

(V )
Pλ .
(5.148)
Hence, using the usual Legendre expansion, we can write the vector Boltzmann
equation for photons as follows:
 ∂
∂η + ikμ −τ ′μ
	
(V )
λ
+ iτ ′Ub,˘ −1
2 F
′
λ =
iτ ′P1(μ)
 3
10(V )
λ,1 + 3
10(V )
λ,3 −6
35(V )
Pλ,4 + 3
7(V )
Pλ,2 + 3
5(V )
Pλ,0
	
. (5.149)
and for polarisation:
 ∂
∂η + ikμ −τ ′μ
	
(V )
Pλ =
−τ ′
 3
10(V )
λ,1 + 3
10(V )
λ,3 −6
35(V )
Pλ,4 + 3
7(V )
Pλ,2 + 3
5(V )
Pλ,0
	
.
(5.150)
We end here our treatment of vector modes, dealing just with the scalar and tensor
ones from now on.
5.6
Boltzmann Equation for Baryons
As baryons, we refer here generically to electrons and protons, neglecting helium
nuclei. The latter can be straightforwardly included, as we are going to comment
throughout the derivation. Electrons and protons interact via Coulomb scattering:

5.6 Boltzmann Equation for Baryons
187
e + p ↔e + p ,
(5.151)
and in turn recall that electrons are also coupled to photons via Thomson scattering.
Electrons also interact with Helium nuclei via Coulomb scattering. We assume the
interactions to be so efﬁcient that:
δe = δp = δb ,
ve = vp = vb .
(5.152)
In other words, we do not expect to have more electrons here and more protons there,
thereby generating cosmic dipoles. So, baryons together form the so-called baryonic
plasma. Baryons are heavy and non-relativistic in the epochs of interest and thus
there is no exchange of energy via Thomson scattering with photons. For this reason
we expect that their density contrast is governed by an equation similar to Eq.(5.50).
We can check this by considering the Boltzmann equation for electrons:
dFe(η, x, q)
dη
= ⟨cep⟩QQ′q′ + ⟨ceγ⟩pp′q′ ,
(5.153)
where ⟨cep⟩QQ′q′ is the collisional term relative to Coulomb scattering:
e(q) + p(Q) ↔e(q′) + p(Q′) ,
(5.154)
whereas ⟨ceγ⟩pp′q′ is the collisional term relative to Thomson scattering:
e(q) + γ(p) ↔e(q′) + γ(p′) .
(5.155)
For protons, the Boltzmann equation is similar:
dFp(η, x, Q)
dη
= ⟨cep⟩qq′Q′ ,
(5.156)
the only difference being that we neglect their interaction with photons, since the
Thomson cross-section goes as ∝1/m2 and therefore it is 106 less important for
protons rather than for electrons. A Boltzmann equation for Helium nuclei is similar
to the one for protons. The brackets mean integration in the phase space:
⟨(· · · )⟩qq′Q′ ≡

d3q
(2π)3

d3q′
(2π)3

d3Q′
(2π)3 (· · · ) ,
(5.157)
whereas the integrands are similar to those in Eq.(5.82).
ceγ ≡
a
E(q)
(2π)4δ4(q + p −q′ −p′)|M|2[ fe(q′) fγ(p′) −fe(q) fγ(p)]
8E(p′)E(q)(p)Ee(q′)
,
(5.158)

188
5
Perturbed Boltzmann Equations
with a similar expression, but with different |M|2, for cep. Note the a/Ee(q) factor
in the above deﬁnition of ceγ that we have left in evidence in order to recall that it
comes comes from changing the afﬁne parameter derivative for the conformal time
derivative in the Boltzmann equation, cf. Eq.(5.27).
An important approximation that we are making is the following: we are consid-
ering all the electron ionised (hence the name baryonic plasma). This is ﬁne before
recombination, of course, but it does not work after. After recombination, electrons
and protons (and also helium) can be considered altogether as collisionless baryons.
Therefore, their evolution is governed by equations identical to the ones we have
developed earlier for CDM.
We are going to exploit again the fact that electrons and protons are non-
relativistic, as we did for CDM, and take moments of the perturbed Boltzmann
equations.
The calculations of the integrals of Eqs.(5.153) and (5.156) multiplied by the
respective energies follow the same steps that we have used for Eqs.(5.40) and
(5.48):

d3q
(2π)3
dFe
dη = δ′
e + (1 + we)kVe + 3H
δPe
δρe
−we
	
δe + 3(1 + we)′ ,
(5.159)

d3q
(2π)3
dFp
dη = δ′
p + (1 + wp)kVp + 3H
δPp
δρp
−wp
	
δp + 3(1 + wp)′ .
(5.160)
These integrations are equal to the corresponding ones of the collisional terms, which
are very simple and are the following:

d3q
(2π)3 [⟨cep⟩QQ′q′ + ⟨ceγ⟩pp′q′] = 0 ,

d3Q
(2π)3 ⟨cep⟩Q′q′q = 0 ,
(5.161)
i.e. vanishing because the scattering processes do not change the number of baryons
but only reshufﬂe their momenta. Mathematically, this can be proved by noticing
that |M|2 is symmetric with respect to the change of initial and ﬁnal momenta.
Therefore, using the conditions stated earlier in Eq.(5.152), the zero-moment
equations that we ﬁnd for electrons and protons are identical if we set we = wp = 0
and no effective speeds of sound. Neglecting these, we obtain an equation similar to
Eq.(5.50), which we found for CDM:
δ′ + kVb + 3′ = 0
(5.162)
where, again, kVb = θb in the notation of Ma and Bertschinger (1995).
Taking care of the ﬁrst moments of the perturbed Boltzmann equations for elec-
trons and protons, as we did for Eq.(5.48), leaves us with:

5.6 Boltzmann Equation for Baryons
189
i ˆki

d3q
(2π)3 q ˆqi dFe
dη = ρe(V ′
e + HVe −k) ,
(5.163)
i ˆki

d3Q
(2π)3 Q ˆQi dFp
dη = ρp(V ′
p + HVp −k) ,
(5.164)
where we have already neglected pressure and effective speed of sound. The ﬁrst
moments of the Boltzmann equations are thus:

d3q
(2π)3
q ˆqi
Ee
d fe(η, x, q)
dη
=

d3q
(2π)3
q ˆqi
Ee
[⟨cep⟩QQ′q′ + ⟨ceγ⟩pp′q′] , (5.165)

d3Q
(2π)3
Q ˆQi
E p
d f p(η, x, Q)
dη
=

d3Q
(2π)3
Q ˆQi
E p
⟨cep⟩qq′Q′ . (5.166)
Consider the sum of the two above Liouville operator, and using Ve = Vp = Vb, we
can write:
(ρe + ρp)(V ′
b + HVb −k) =
i ˆki

d3q
(2π)3 qi[⟨cep⟩QQ′q′ + ⟨ceγ⟩pp′q′] + i ˆki

d3Q
(2π)3 Qi⟨cep⟩qq′Q′ .
(5.167)
We write the sum of the background energies as
ρe + ρp = neme + n pm p = nbme + nbm p ≈nbm p ≡ρb ,
(5.168)
since the proton mass is much larger than the electron one, and hence
V ′
b + HVb −k = i ˆki
ρb
[⟨cep(qi + Qi)⟩QQ′q′q + ⟨ceγqi⟩pp′qq′] .
(5.169)
Now we have to calculate the terms on the right hand side. The ﬁrst one is:
⟨cep(qi + Qi)⟩QQ′q′q = a

d3q
(2π)3

d3q′
(2π)3

d3Q
(2π)3

d3Q′
(2π)3 (qi + Qi)
(2π)4δ4(q + Q −q′ −Q′)|M|2[ fe(q′) f p(Q′) −fe(q) f p(Q)]
8m2em2p
,
(5.170)
which is vanishing because qi + Qi is the total initial 3-momentum, so it is equal to
the ﬁnal one q′i + Q′i because it is conserved. Another way to see this is noticing that
also (qi + Qi)|M|2 is symmetric with respect to the change of the initial momenta
with the ﬁnal ones and this implies that the integration is zero. Physically, being
conserved the total 3-momentum is unaffected by the scattering.

190
5
Perturbed Boltzmann Equations
The only survivor is the second term on the right hand side, which comes from
Thomson scattering. By 3-momentum conservation we can write:
⟨ceγ(qi + pi)⟩pp′qq′ = 0
⇒
⟨ceγqi⟩pp′qq′ = −⟨ceγ pi⟩pp′qq′ .
(5.171)
That is, we have changed the average with respect to the photon momentum. We
have then:
V ′
b + HVb −k = −i
ρb
⟨ceγμp⟩pp′qq′ = −i
ρb
 1
−1
dμ
2 μ
 dp p2
2π2 p Ceγ .
(5.172)
Partoftherighthandsidehasalreadybeencalculatedforphotons,whenweintegrated
over the modulus p and deﬁned (η, k, μ). This integration gives a 4ργ contribution
and leaves us with the same collisional term of Eq.(5.114) integrated over dμ/2 and
without the polarisation contribution:
V ′
b + HVb −k = 4iτ ′ργ
ρb
 1
−1
dμ
2 μ

(S)
0
−(S) −iμVb −1
2P2(μ)(S)
2

.
(5.173)
Performing the dμ integration and introducing the dipole (S)
1 , we obtain:
V ′
b + HVb −k = 4τ ′ργ
3ρb
"
Vb −3(S)
1
#
(5.174)
This equation can be also obtained exploiting momentum conservation for the two-
ﬂuid system baryonic plasma plus photons and using Eq.(5.48). In fact, momentum
is not conserved individually for baryons and photon, but of course it is for the
photon-baryon ﬂuid. Let us write then Eq.(5.48) for the latter:
ρb

V ′
b + HVb −k

+ 4
3ργV ′
γ −k
3ργδγ −k ˆkl ˆkmπlm
γ −4k
3 ργ = 0 ,
(5.175)
where we have neglected pressure and anisotropic stress for baryons, being them
non-relativistic. Now, Eqs.(5.68), (5.69) and (5.70) hold true also for photons. So
we have:
4(S)
0
= δγ ,
4(S)
1
= 4
3Vγ ,
4(S)
2
= −3
2ργ
ˆkl ˆkmπlm
γ .
(5.176)
Exercise 5.18 Using the above deﬁnitions and Eq.(5.121) obtain Eq.(5.174).

5.6 Boltzmann Equation for Baryons
191
We have thus obtained all the relevant equations which describe small ﬂuctuations
in the components of the universe. In Chap.6 we shall tackle the issue of which initial
conditions employ to our set of differential equations.
If we compare the above Eq.(5.174) with the corresponding one in Ma and
Bertschinger (1995) we shall notice in this reference an extra term k2c2
s δb, coming
from the fact that the authors did not neglect the effective speed of sound contribution
for baryons, cf. Eq.(5.48).
References
Bond, J.R., Efstathiou, G.: Cosmic background radiation anisotropies in universes dominated by
nonbaryonic dark matter. Astrophys. J. 285, L45–L48 (1984)
Chandrasekhar, S.: Radiative Transfer. Dover, New York (1960)
Crittenden, R., Bond, J.R., Davis, R.L., Efstathiou, G., Steinhardt, P.J.: The imprint of gravitational
waves on the cosmic microwave background. Phys. Rev. Lett. 71, 324–327 (1993)
Hu, W., White, M.J.: CMB anisotropies: total angular momentum method. Phys. Rev. D 56, 596–615
(1997)
Kosowsky, A.: Cosmic microwave background polarization. Ann. Phys. 246, 49–85 (1996)
Ma, C.-P., Bertschinger, E.: Cosmological perturbation theory in the synchronous and conformal
Newtonian gauges. Astrophys. J. 455, 7–25 (1995)
Peebles, P.J.E., Yu, J.T.: Primeval adiabatic perturbation in an expanding universe. Astrophys. J.
162, 815–836 (1970)
Piattella, O.F., Rodrigues, D.C., Fabris, J.C., de Freitas Pacheco, J.A.: Evolution of the phase-space
density and the Jeans scale for dark matter derivedfrom the Vlasov-Einstein equation. JCAP 1311,
002 (2013)
Piattella, O.F., Casarini, L., Fabris, J.C., de Freitas Pacheco, J.A.: Dark matter velocity dispersion
effects on CMB and matter power spectra. JCAP 1602(02), 024 (2016)
Polnarev, A.G.: Polarization and anisotropy induced in the microwave background by cosmological
gravitational waves. Sov. Astron. 29, 607–613 (1985)
Seljak, U., Zaldarriaga, M.: A Line of sight integration approach to cosmic microwave background
anisotropies. Astrophys. J. 469, 437–444 (1996)
Tram, T., Lesgourgues, J.: Optimal polarisation equations in FLRW universes. JCAP 1310, 002
(2013)
Weinberg, S.: A no-truncation approach to cosmic microwave background anisotropies. Phys. Rev.
D 74, 063517 (2006)
Weinberg, S.: Cosmology. Oxford University Press, Oxford (2008)
Wilson, M.L., Silk, J.: On the Anisotropy of the cosomological background matter and radiation
distribution. 1. The Radiation anisotropy in a spatially ﬂat universe. Astrophys. J. 243, 14–25
(1981)

Chapter 6
Initial Conditions
Finirai per trovarla la Via... se prima hai il coraggio di perderti
(You will eventually ﬁnd your Way... if you have ﬁrst the courage
of lose yourself)
Tiziano Terzani, Un altro giro di giostra
In Chaps.4 and 5 we have derived the evolution equations for small ﬂuctuations about
the homogeneous and isotropic FLRW background. These equations are differential
and so, in order to have a well-posed Cauchy problem, we need to know which initial
conditions to use. This is the topic of this chapter, where we shall be concerned with
scalar perturbations only. Many papers in the literature are concerned about initial
conditions in cosmology, but we shall mainly refer to Ma and Bertschinger (1995),
Bucher et al. (2000).
We shall discuss primordial modes for scalar perturbations only, leaving the tensor
one in Chap.8, when we shall discuss of inﬂation. For this reason in this Chapter we
drop the superscript (S).
6.1
Initial Conditions
We start by summarizing here the relevant evolution equations that we have found
in Chaps.4 and 5. For the photon temperature ﬂuctuations, Eqs.(5.119)–(5.122):
(2ℓ+ 1)′
ℓ+ k

(ℓ+ 1)ℓ+1 −ℓℓ−1

= τ ′(2ℓ+ 1)ℓ,
(ℓ> 2) ,
(6.1)
10′
2 + 2k

33 −2
3 Vγ

= 10τ ′2 −τ ′ ,
(6.2)
V ′
γ + k

22 −δγ
4

= k + τ ′ 
Vγ −Vb

,
(6.3)
δ′
γ + 4
3kVγ = −4′ ,
(6.4)
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_6
193

194
6
Initial Conditions
wherewehaveused40 = δγ and31 = Vγ.Forthepolarisationﬁeld,Eqs.(5.124)–
(5.127):
(2ℓ+ 1)′
Pℓ+ k

(ℓ+ 1)P(ℓ+1) −ℓP(ℓ−1)

= τ ′(2ℓ+ 1)Pℓ,
(ℓ> 2) ,
(6.5)
10′
P2 + 2k (3P3 −2P1) = 10τ ′P2 −τ ′ ,
(6.6)
3′
P1 + k (2P2 −P0) = 3τ ′P1 ,
(6.7)
2′
P0 + 2kP1 = 2τ ′P0 −τ ′ ,
(6.8)
with
 = 2 + P2 + P0 .
(6.9)
For neutrinos, Eqs.(5.65)–(5.67):
(2ℓ+ 1)N ′
ℓ+ k

(ℓ+ 1)Nℓ+1 −ℓNℓ−1

= 0 ,
(ℓ> 1) ,
(6.10)
V ′
ν + 2kN2 −k δν
4 = k ,
(6.11)
δ′
ν + 4
3kVν = −4′ ,
(6.12)
where we have used 4N0 = δν and 3N1 = Vν.
For CDM, Eqs.(5.50) and (5.51):
δ′
c + kVc + 3′ = 0 ,
V ′
c + HVc −k = 0 .
(6.13)
For baryons, Eqs.(5.162) and (5.174):
δ′
b + kVb + 3′ = 0 ,
V ′
b + HVb −k = 4τ ′ργ
3ρb

Vb −Vγ

,
(6.14)
Finally, we consider the Einstein equations (4.179) and (4.184):
3H

′ −H

+ k2 = 4πGa2 
ρδ + ρbδb + ργδγ + ρνδν

,
(6.15)
k2( + ) = −32πGa2 
ργ2 + ρνN2

,
(6.16)
where we have expressed the photons and neutrinos anisotropic stresses in terms of
their quadrupole moments.
Now we have to understand when to set our initial conditions. These should be
values for the above quantities ℓ, Nℓ, δc, δb, Vc, Vb,  and  at a certain initial

6.1 Initial Conditions
195
instant. This instant cannot be η = 0, i.e. the Big Bang, evidently, because it is a
singularity, and so it should be some small ηi > 0.
Now, any scale k, being η growing, shall pass from a η ≪1/k regime called
super-horizon evolution, to a η ∼1/k regime called horizon crossing, ﬁnally to a
η ≫1/k called sub-horizon evolution. The mentioned horizon is the particle one,
since recall from Eq.(2.137) that:
χp(η) =
 t
0
dt′
a(t′) =
 η
0
dη′ = η ,
(6.17)
i.e. the conformal time represents the comoving distance travelled by a photon since
the Big Bang.
Therefore, the initial values for the perturbative quantities are set when kη ≪
1 and are also called primordial modes for the scales of observational interest
today because are deep into the radiation-dominated epoch. For this reason, we shall
frequently use the result a ∝η.
6.2
Evolution Equations in the kη ≪1 Limit
All the equations that we shall use here are valid only at early times, in the radiation-
dominated epoch, and on very large scales, i.e. kη ≪1.
What one does is basically an expansion with respect to kη of the perturbative
variables. Let us see what happens for the case of the photon monopole Eq. (6.4),
just to ﬁx the ideas. Suppose that we have the following expansions:
δγ =
∞
	
n=0
δ(n)
γ (kη)n ,
Vγ =
∞
	
n=0
V (n)
γ (kη)n ,
 =
∞
	
n=0
(n)(kη)n .
(6.18)
Insert them into Eq. (6.4), and ﬁnd:
∞
	
n=0
δ(n)
γ n(kη)n 1
η + 4
3k
∞
	
n=0
V (n)
γ (kη)n = −4
∞
	
n=0
(n)n(kη)n 1
η .
(6.19)
This equation can be cast as follows:
∞
	
n=0
δ(n)
γ n(kη)n + 4
3
∞
	
n=0
V (n)
γ (kη)n+1 = −4
∞
	
n=0
(n)n(kη)n .
(6.20)
So, we see that V (0)
γ
couples with δ(1)
γ
and (1) in the expansion. In other words, Vγ
is of order (kη)δγ and (kη), hence is subdominant with respect to δγ and . This
means that, at the lowest order, Eq. (6.4) becomes:

196
6
Initial Conditions
δ′
γ = −4′
(6.21)
This procedure is equivalent to neglecting a contribution proportional to k with
respect to a time derivative.
Exercise 6.1 Apply the same reasoning which brought us to Eq. (6.21) to the neutri-
nos monopole and to CDM and baryons density contrasts, showing that at the lowest
order of approximation we have:
δ′
ν = −4′
(6.22)
δ′
c = −3′
(6.23)
δ′
b = −3′
(6.24)
Integrating the above equations for the monopoles, we get:
δγ = −4 + 4Cγ ,
(6.25)
δν = −4 + Cν ,
(6.26)
δc = −3 + Cc ,
(6.27)
δb = −3 + Cb ,
(6.28)
where we have introduced 4 integration constants. Cast the above equations as fol-
lows:
δγ = −4 + 4Cγ ,
(6.29)
δν = δγ + Sν ,
(6.30)
δc = 3
4δγ + Sc ,
(6.31)
δb = 3
4δγ + Sb ,
(6.32)
for a reason that will be clearer later. We have deﬁned:
Sν ≡Cν −4Cγ ,
Sc ≡Cc −3Cγ ,
Sb ≡Cb −3Cγ ,
(6.33)
and these are called density isocurvature modes or entropy modes. Be careful that
the C’s and thus the S’s are not actually constants, but functions of k. Hereafter we
will call inappropriately as “constants” those quantities which are time-independent.

6.2 Evolution Equations in the kη ≪1 Limit
197
6.2.1
Multipoles in the kη ≪1 Limit
From the hierarchy of the equations for photons we can see that each multipole ℓ
enters the differential equation for ℓ+1 multiplied by k. This means that ℓ+1 ∼
(kη)ℓ, i.e. each multipole is subdominant with respect the previous one. This is also
true for Pℓand for Nℓand it is an important fact that we shall employ afterwards.
Applying the limit kη ≪1 to the photon equations we get, at the dominant order:
(2ℓ+ 1)′
ℓ−kℓℓ−1 = τ ′(2ℓ+ 1)ℓ,
ℓ> 2 ,
(6.34)
10′
2 −4
3kVγ = τ ′ (92 −P0 −P2) ,
(6.35)
V ′
γ −k δγ
4 = k + τ ′ 
Vγ −Vb

.
(6.36)
Similarly, for the polarization ﬁeld:
(2ℓ+ 1)′
Pℓ−kℓP(ℓ−1) = τ ′(2ℓ+ 1)Pℓ,
ℓ> 2 ,
(6.37)
10′
P2 −4kP1 = τ ′ (9P2 −P0 −2) ,
(6.38)
3′
P1 −kP0 = 3τ ′P1 ,
(6.39)
2′
P0 = τ ′ (P0 −P2 −2) .
(6.40)
Here comes a very useful approximation, based on the fact that:
−τ ′ = neσTa ∝a−2 ∝η−2 .
(6.41)
That is, the optical depth time derivative, which is the photon-electron interaction
rate, diverges for η →0 as 1/η2. This is logical, since the universe becomes denser
the more we go backwards in time and so more interactions take place. This is also
called tight-coupling and we will use it as an approximation closer to recombination
in Chap.10.
But then, in order to prevent the perturbations from diverging, the quantities
multiplying τ ′ must vanish for η →0, i.e.:
ℓ= Pℓ= 0 ,
ℓ> 2 ,
(6.42)
92 −P0 −P2 = 0 ,
(6.43)
9P2 −P0 −2 = 0 ,
(6.44)
Vγ = Vb ,
P1 = 0 ,
(6.45)
P0 = P2 + 2 .
(6.46)

198
6
Initial Conditions
Exercise 6.2 Combine the above equations and show that:
2 = P2 = P0 = 0
(6.47)
Hence, the coupling between electrons and photons is so efﬁcient that it washes out
the quadrupole and higher moments of the temperature ﬂuctuations and all the polar-
isation moments. Moreover, it tightly couples photons and baryons in a single ﬂuid
with velocity Vγ = Vb.
The kη ≪1 neutrino equations are the same as the photon ones, but with no
interaction terms:
(2ℓ+ 1)N ′
ℓ−kℓNℓ−1 = 0 ,
ℓ≥2 ,
(6.48)
V ′
ν −k δν
4 = k .
(6.49)
Again, we can see that Vν ∼(kη)δν, N2 ∼(kη)2δν, and so on. Nothing can make the
multipoles of the neutrino temperature to vanish, as Thomson scattering for photons,
therefore we need initial conditions for all of them.
Exercise 6.3 Suppose that:
Nℓ= cℓ(kη)ℓ,
(6.50)
at the lowest order, where cℓis some constant (in this instance a true constant, a
number). From Eq. (6.48) show that:
cℓ=
1
2ℓ+ 1cℓ−1 ,
(6.51)
and thus:
Nℓ=
kη
2ℓ+ 1Nℓ−1 ,
ℓ≥2 .
(6.52)
Therefore, once we know the initial condition on N1, we can determine the initial
conditions for all the subsequent multipoles from the above equation. But, what about
the initial condition on Vν?
Exercise 6.4 Combining Eqs. (6.21), (6.22), (6.36) and (6.49) show that:
V ′′
γ = V ′′
ν .
(6.53)

6.2 Evolution Equations in the kη ≪1 Limit
199
This does not necessarily means that Vγ = Vν, but in general:
Vγ = Vν + qν ,
(6.54)
where qν is at most a linear function of η and is the neutrino velocity isocurvature
mode or relative neutrino heat ﬂux.
6.2.2
CDM and Baryons Velocity Equations
Consider now the velocity equations for CDM and baryons. At the lowest order in
kη they become:
ηV ′
c + Vc = (kη) ,
(6.55)
ηV ′
b + Vb = (kη) + 4ητ ′ργ
3ρb
(Vb −Vγ) .
(6.56)
First of all, ητ ′ργ/ρb ∝1/a2 ∝1/η2. Thus, in order for Vb not to diverge one has to
have Vγ = Vb, consistently with what we have found earlier for photons. With this
condition holding true, the equation for Vb is similar to the one for Vc:
ηV ′
c + Vc = (kη) ,
(6.57)
ηV ′
b + Vb = (kη) .
(6.58)
From these equations we can conclude that Vc and Vb are subdominant with respect
to .
6.2.3
The kη ≪1 Limit of the Einstein Equations
Noting that:
4πGa2 = 3H2
2ρtot
=
3
2ρtotη2 ,
(6.59)
where ρtot is the total energy density, the generalised Poisson equation can be written
as:
2η′ −2 + 2(kη)2 = ργ
ρtot
δγ + ρν
ρtot
δν + ρc
ρtot
δc + ρb
ρtot
δb .
(6.60)
Neglect now (kη)2 and deﬁne the density fraction Ri ≡ρi/ρtot for each component,
such that:
Rγ + Rν + Rc + Rb = 1 .
(6.61)

200
6
Initial Conditions
Using the solutions found for the monopoles, we arrive at:
2η′ −2 = −4

Rγ + Rν + 3
4 Rc + 3
4 Rb

+ 4RγCγ + RνCν + RcCc + RbCb .
(6.62)
Note that
4

Rγ + Rν + 3
4 Rc + 3
4 Rb

= 3 + Rγ + Rν ,
(6.63)
and since we are deep into the radiation dominated epoch, photons and neutrinos
dominate and thus:
Rγ + Rν ≈1 .
(6.64)
Exercise 6.5 Show that Rν is constant at early times and its value is:
Rν =
ρν
ρν + ργ
=
Neff(7/8)(4/11)4/3
1 + Neff(7/8)(4/11)4/3 = 0.4089 ,
(6.65)
the last number coming from choosing Neff = 3.046.
Equation (6.62) can be thus written as follows:
2η′ + (3 + Rγ + Rν) −2 = (3 + Rγ + Rν)Cγ + Rν Sν + RcSc + RbSb
(6.66)
where we have also introduced the density isocurvature modes.
Since2 = 0forkη ≪1,theEinsteinequationfortheanisotropicstressbecomes:
k2η2( + ) = −12RνN2
(6.67)
This equation tells us that, consistently, N2 ∼(kη)2δν, since  ∼δν. However,
because of that factor (kη)2, we have to keep track of the time-evolution of N2,
which is of the same order. From the neutrino equations that we have derived earlier
it is not difﬁcult to obtain that, upon differentiating Eq. (6.67):
2k2η( + ) + k2η2(′ + ′) = −12RνN ′
2 = −8
5 RνkVν .
(6.68)
Differentiate again, and obtain:
2k2( + ) + 4k2η(′ + ′) + k2η2(′′ + ′′) = −8
5 RνkV ′
ν =
−8
5 Rνk2

 + δν
4

.
(6.69)

6.2 Evolution Equations in the kη ≪1 Limit
201
Now the k2 can be simpliﬁed and differentiating again, one obtains:
6(′ + ′) + 6η(′′ + ′′) + η2(′′′ + ′′′) = −8
5 Rν

′ −′
(6.70)
where we used δ′
ν = −4′ and the fact that Rν is constant when radiation dominates.
We have obtained a closed equation for  and , despite of the fact that it is of
third order. Combining it with the generalised Poisson equation, one can obtain an
equation of fourth order for  or  only.
Now we solve the equations found in this section in 5 cases, i.e. when only one
of the 5 constants is different from zero.
6.3
The Adiabatic Primordial Mode
The adiabatic mode is deﬁned by Sν = Sc = Sb = qν = 0. Only Cγ ̸= 0. With this
condition, we have for the density contrasts:
1
3δc = 1
3δb = 1
4δγ = 1
4δν = − + Cγ
(6.71)
As for the gravitational potentials, Eq. (6.66) becomes:
η′ + 2 − = 2Cγ ,
(6.72)
and we have to combine this together with Eq. (6.70) in order to obtain a fourth order
equation for  or . The result is, for :
η3′′′′ + 12η2′′′ + 4

9 + 2
5 Rν

η′′ + 8

3 + 2
5 Rν

′ = 0 .
(6.73)
This equation can be solved exactly, recalling that Rν is constant. The fact that only
derivatives of  appear already tells us that  = constant is a solution and indeed it
is the growing mode that we are going to consider. The other 3 independent solutions
of the above equation are:
 ∝η−5
2 ± 1
2
√
1−32Rν
5
,
 ∝1
η .
(6.74)
Hence, these are decaying modes, the ﬁrst two even complex if Rν > 5/32, and we
neglect them.

202
6
Initial Conditions
Since Cγ and  are constant, then from Eq. (6.72) we deduce that  is also
constant. In order to determine their values in terms of Cγ we have to solve the
system of Eqs. (6.72) and (6.69):
2 − = 2Cγ ,
(6.75)
 +  = −4
5 Rν

 − + Cγ

.
(6.76)
which allows us to establish:
 = 2Cγ(5 + 2Rν)
15 + 4Rν
,
 = −
10Cγ
15 + 4Rν
,
 = −

1 + 2
5 Rν

(6.77)
We shall later show in Chap.8 how the inﬂationary mechanism is able to establish a
value for Cγ. Note how the presence of neutrinos via Rν prevents  = −.
The Cγ that we are using here corresponds to the −2C of Ma and Bertschinger
(1995)andinordertoobtaintheresultofBucheretal.(2000)onehastosetCγ = −1.1
From Eq.(6.71) we can write:
δγ =
20Cγ
15 + 4Rν
= −2 .
(6.78)
Using Eq. (6.67), the primordial mode of the neutrino quadrupole moment is:
N2 = −k2η2( + )
12Rν
= k2η2
30 
(6.79)
What about the velocities? We have just seen that  ∼(kη)0 so if also Vc ∼Vb ∼
(kη)0, then Eqs. (6.57) and (6.58) become, at the lowest order:
ηV ′
c + Vc = 0 ,
(6.80)
ηV ′
b + Vb = 0 .
(6.81)
The solutions are Vc ∝Vb ∝1/η. These solutions are not admissible because they
diverge for η →0. This means that Vc ∝Vb ∼(kη), at the lowest order. Substituting
this ansatz again in Eqs. (6.57) and (6.58) it is easy to ﬁnd:
Vc = Vb = kη
2
.
(6.82)
1There must be a typo in Eq.28 of Bucher et al. (2000), since the gravitational potentials appear
to be equal but they cannot be because of the presence of neutrinos and the quadrupole moment of
their distribution.

6.3 The Adiabatic Primordial Mode
203
Since qν = 0, then Vν = Vγ and recalling that Vγ = Vb, we have for the velocities
primordial modes:
Vν = Vγ = Vb = Vc = kη
2
(6.83)
All the above modes depend on the same unique constant Cγ, which is the primordial
perturbation, in the sense that its non-vanishing generates the ﬂuctuations for all the
matter components.
Exercise 6.6 Compare the solutions that we have found for the adiabatic mode with
those of Refs. Ma and Bertschinger (1995), Bucher et al. (2000).
6.3.1
Why “Adiabatic”?
Now we are going to understand the reason for the adjective “adiabatic”. From the
thermodynamical relation:
T dS = dU + pdV ,
(6.84)
we can write:
T dS
V
= dρtot −ρtot + Ptot
ntot
dntot .
(6.85)
Recast this as follows:
T dS
V
= ρcδc + ργδγ + ρbδb + ρνδν −ρtot + Ptot
ntot
(δnc + δnγ + δnb + δnν) .
(6.86)
Using:
δc = δnc
nc
,
δb = δnb
nb
,
δγ = 4
3
δnγ
nγ
,
δν = 4
3
δnν
nν
,
(6.87)
we ﬁnally have:
T dS
V
=

ρc −nc
ρtot + Ptot
ntot
 
δc −3
4δγ

+

ρb −nb
ρtot + Ptot
ntot
 
δb −3
4δγ


ρν −3
4nν
ρtot + Ptot
ntot
 
δν −δγ

.
(6.88)

204
6
Initial Conditions
Therefore, δc/3 = δγ/4 = δν/4 = δb/3, i.e. Sc = Sν = Sb = 0, implies dS = 0 and
hence adiabaticity. When one of Sν, S, Sb and qν is different from zero we have isocur-
vature modes, respectively divided into isocurvature neutrino density, isocurva-
ture CDM, isocurvature baryons and isocurvature neutrino velocity. However,
it might be more appropriate to call them entropy perturbations, on the basis of
Eq. (6.88).
The name “isocurvature” comes from the fact that when these modes are present it
is possible to have R = 0 or ζ = 0, from Eqs.(4.131) and (4.132). In the Newtonian
gauge, we have:
R =  + Hvtot ,
ζ =  + Rγδγ + Rνδν + Rcδc + Rbδb
3 + Rγ + Rν
.
(6.89)
Some care must be used when computing vtot in the above formula for R since
it is the total one but it is not the sum of the single components’ v’s. This happens
because the SVT decomposition is made not directly on vi but rather on the perturbed
energy-momentum tensor δT 0i and the latter is, from Eq.(4.73):
δT 0
i(tot) = (ρtot + Ptot)vi(tot) .
(6.90)
Hence, vtot is deﬁned through a weighted average with weight ρ + P, i.e.
vtot =

s(ρs + Ps)vs
ρtot + Ptot
,
(6.91)
which, in our 4-components model, gives:
vtot = 4Rγvγ + 4Rνvν + 3Rcvc + 3Rbvb
3 + Rγ + Rν
.
(6.92)
Now, using the relation v = −V/k and the condition found in Eq. (6.83), one can
ﬁnally write:
R =  −4RγVγ + 4RνVν + 3RcVc + 3RbVb
kη(3 + Rγ + Rν)
=  −
2 .
(6.93)
Oneﬁndsthesameresultforζ,whensubstitutingEq.(6.66)in (6.89)(andconsidering
the constant mode). Hence, we have that:
R = ζ =  −
2 = Cγ
(6.94)
Hence, the Cγ is related to the curvature perturbations and we have also proved that
these are equal and constant on large scales for adiabatic perturbations. We shall
prove this important result again in Sect.12.4.

6.4 The Neutrino Density Isocurvature Primordial Mode
205
6.4
The Neutrino Density Isocurvature Primordial Mode
Neglect CDM and baryons in Eq.(6.89).
Exercise 6.7 Since Rb,c →0 at early times, use Eq.(6.30) in order to ﬁnd:
ζ = Cγ + RνSν
4
.
(6.95)
If Sν = 0 we recover the adiabatic case. In order to make ζ = 0, we need 4Cγ =
−RνSν. Therefore, the density contrasts are related as follows:
1
3δ = 1
3δb = 1
4δγ = 1
4δν −Sν
4 = − −RνSν
4
(6.96)
In order to determine the gravitational potentials, from Eq. (6.66) we have:
η′ + 2 − = 0 ,
(6.97)
and combining it with Eq. (6.70) one ﬁnds the very same Eq. (6.73) for  that we
obtained in the adiabatic case. Hence, we choose the constant  solution, which
allows us to establish:
 = 2 ,
 =
R2
νSν
15 + 4Rν
(6.98)
In order to obtain the same results of Bucher et al. (2000) one has to set RνSν = −1.
Using Eq. (6.67), the initial condition on the neutrino quadrupole moment is:
N2 = −k2η2( + )
12Rν
= −k2η2
4Rν
(6.99)
Since qν = 0, then Vν = Vγ and the initial conditions on the velocities are again:
Vν = Vγ = Vb = V = kη
2
= kη
(6.100)

206
6
Initial Conditions
6.5
The CDM and Baryons Isocurvature Primordial Modes
The treatment for CDM or baryons isocurvature modes is the same, therefore we
present explicitly the CDM case only. Suppose that only Sc ̸= 0, then we have for ζ:
ζ = RcSc
4
.
(6.101)
Since we are deep into the radiation-dominated epoch:
Rc ≡ρc
ρtot
∼ρc0
ρtot,0
a = c0a .
(6.102)
Then Rc goes to zero and so thus ζ, denoting thus correctly an isocurvature mode.
The density contrasts are related as follows:
δγ
4 = δν
4 = δb
3 = δc −Sc
3
= −
(6.103)
and all of them vanishes for η →0, except δc = Sc, which sources all the perturba-
tions. Equation (6.66) tells us that:
2η′ −2 + 4 = RcSc ,
(6.104)
and using Eq. (6.102), we write:
η′ − + 2 = Scc0η ,
(6.105)
where we have incorporated the factor 1/2 and the proportionality constant of a ∝η
into S. This can be done, of course, without losing generality since S is itself a
constant. Now, since the right hand side of the above equation depends linearly on
η, and  →0 for η →0, the only possibility is that the gravitational potentials are
linearly dependent on the time. Using the ansatz:
 = ¯η ,
 = ¯η ,
(6.106)
Equations(6.105) and (6.69) become:
3 ¯ −¯ = Scc0
(6.107)
3( ¯ + ¯) = −4
5 Rν
 ¯ −¯

.
(6.108)
Solving this system of two equations, we ﬁnd the CDM isocurvature modes:

6.5 The CDM and Baryons Isocurvature Primordial Modes
207
 = (15 + 4Rν)Scc0
4(15 + 2Rν)
η ,
 = (4Rν −15)Scc0
4(15 + 2Rν)
η ,  = − 15 + 4Rν
15 −4Rν
(6.109)
Again as we expected, the absence of neutrinos causes  = − since there is no
other source of anisotropic stress. Using Eq. (6.67), the primordial mode of the
neutrino quadrupole moment is:
N2 = −k2η2( + )
12Rν
= −
k2η3
6(15 + 2Rν) Scc0
(6.110)
Again for the velocities:
Vν = Vγ = Vb = Vc = k
2
(6.111)
The isocurvature modes for baryons have exactly the same form, just change c0
with b0.
6.6
The Neutrino Velocity Isocurvature Primordial Mode
ThesemodesareproblematicintheconformalNewtoniangaugebecausetheydiverge
for η →0. On the other hand, they are well-deﬁned in the synchronous gauge Bucher
et al. (2000). Let us see what is the problem. When we set Cγ = Sν = Sc = Sb = 0,
we can straightforwardly ﬁnd:
ζ = 0 ,
δγ
4 = δν
4 = δc
3 = δb
3 = −
(6.112)
and Eq. (6.66) becomes:
η′ + 2 − = 0 .
(6.113)
Here a constant mode seems to be viable, just as in the case of the neutrino density
isocurvature mode. However, we need here also Eq. (6.69), which has the following
form, taking into account δν = −4:
2( + ) + 4η(′ + ′) + η2(′′ + ′′) = −8
5 Rν ( −) .
(6.114)
If we choose the constant mode, we get:

208
6
Initial Conditions
2 =  ,
(6.115)
 +  = −4
5 Rν ( −) .
(6.116)
From this system we clearly see that the only solution is the trivial one. Therefore,
from Eq. (6.113) one sees that we are left with the only following possibility:
 =
¯
η
 =
¯
η
(6.117)
which is problematic in the limit η →0.
Substituting this ansatz into the generalised Poisson equation we can easily deter-
mine that:
¯ = ¯ ,
(6.118)
i.e. the two gravitational potentials are equal. Substituting this result into Eq. (6.68),
one obtains:
k ¯ = −4
5 RνVν ,
(6.119)
From the dipole neutrino and the dipole photon equations we can readily establish
that:
V ′
γ = V ′
ν = 0 ,
(6.120)
i.e. Vγ and Vν are constant and their difference is indeed our neutrino velocity isocur-
vature mode qν. Thus:
k ¯ = 4
5 Rν

Vγ −qν

.
(6.121)
We can determine Vγ in terms of  considering the tight coupling with baryons,
which implies Vγ = Vb and the baryon velocity Eq.(6.58), which now is:
ηV ′
b + Vb = kη = k ¯ .
(6.122)
The right hand side is a constant and so Vb must be. In particular:
Vb = k ¯ = Vγ .
(6.123)
This relation, inserted into Eq. (6.121), gives:
k ¯ = 4
5 Rν

k ¯ −qν

.
(6.124)
Finally, we have for the potentials:

6.6 The Neutrino Velocity Isocurvature Primordial Mode
209
 =  = −4Rνqν
5 −4Rν
1
kη
(6.125)
and for the velocities:
V = Vb = Vγ = −
Rνqν
5 −4Rν
(6.126)
The neutrino velocity and quadrupole moment are:
Vν = qν −Vγ
N2 = −k2η2( + )
12Rν
=
2kηqν
3(5 −4Rν)
(6.127)
6.7
Planck Constraints on Isocurvature Modes
In Ade et al. (2016a,c) the isocurvature mode are constrained through the Planck
data. These tests are related also to inﬂation, since this is a mechanism of production
of primordial ﬂuctuations, as we shall see later in Chap.8. In particular, the most
successful and simple inﬂationary models are those based on a single scalar ﬁeld and
they predict adiabatic initial perturbations. If other ﬁelds are present, then isocurva-
ture modes can be produced. Depending on the mechanism of production, adiabatic
and isocurvature modes can be correlated. In Ade et al. (2016a) for example the
totally correlated case:
Sm = sgn(α)

|α|
1 −|α|ζ ,
(6.128)
is considered, where
Sm = Sc + Rb
Rc
Sb ,
(6.129)
is the total matter isocurvature mode. The fact that Sm is proportional to ζ means
that the totally-correlated case is being considered (because of this the modes are
described by the same parameters and hence put in the above form of proportionality).
The constraint found on α is:
α = 0.0003+0.0016
−0.0012 ,
(6.130)
at 95% CL, using also polarisation data. A much more detailed analysis, including
possible correlations, is performed in Ade et al. (2016c) with the result
|αnon−adi| < 1.9%, 4.0%, 2.9% ,
(6.131)

210
6
Initial Conditions
for CDM, neutrino density and neutrino velocity isocurvature modes respectively. In
the above equation, αnon−adi is the non-adiabatic contribution to the CMB temperature
power spectrum. How the different primordial modes affect the latter will be shown
in Chap.10.
References
Ade, P.A.R., et al.: Planck 2015 results XIII. Cosmological parameters. Astron. Astrophys. 594,
A13 (2016a)
Ade, P.A.R., et al.: Planck 2015 results XX. Constraints on inﬂation. Astron. Astrophys. 594, A20
(2016c)
Bucher, M., Moodley, K., Turok, N.: The general primordial cosmic perturbation. Phys. Rev. D 62,
083508 (2000)
Ma, C.-P., Bertschinger, E.: Cosmological perturbation theory in the synchronous and conformal
Newtonian gauges. Astrophys. J. 455, 7–25 (1995)

Chapter 7
Stochastic Properties of Cosmological
Perturbations
The more the universe seems comprehensible, the more it also
seems pointless
Steven Weinberg, The ﬁrst three minutes
The attentive reader must have noticed that, in fact, we have given no actual initial
conditions on cosmological perturbations in Chap.6. What we have done is to give
the form of the primordial modes and show how, in the 5 different cases that we
investigated, all scalar perturbations are sourced by a single scalar potential. For
example, in the adiabatic case we showed in Eq.(6.77) how (k) is related to Cγ(k),
which we proved to be equal to ζ(k) and R(k).
Note the following important point: all the evolution equations that we derived
for the perturbations, i.e. all the evolution equations for photons, neutrinos, CDM
and baryons, plus Einstein equations, depend only on the modulus k and not on k.
This means that only the initial conditions depend on the latter. We could solve the
evolution equation for some initial condition in which R(ηi, k) = 1, i.e. normalised
to unity, and then the result will depend only on k: R(η, k). This is usually called
transfer function. Multiplying it by the true initial condition R(ηi, k) we obtain the
correct result. Of course, this reasoning applies to any perturbation, not only R.
In this chapter we discuss a very important point of cosmology, both from the
viewpoint of theory and especially from the observational one: the stochastic nature
of cosmological perturbations, embedded in the stochastic character of the initial
conditions. This means that R(ηi, k) shall be regarded as a random variable.
This chapter mainly follows Weinberg (2008) and Lyth and Liddle (2009).
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_7
211

212
7
Stochastic Properties of Cosmological Perturbations
7.1
Stochastic Cosmological Perturbations and Power
Spectrum
First of all, what do cosmological perturbations have to do with statistics? After all,
we have derived differential equations describing the evolutions of the perturbative
variables and, provided that we are able to solve them, we should determine such
variables exactly with no room for randomness.
Consider the following point: the set of differential equations that we have found
are ODE which only describe the time evolution of the perturbative variables, with
their spatial (or scale) dependences to be provided as initial conditions. For exam-
ple, focus on the CDM density contrast δc(η, x), for which the evolution equations
Eqs.(5.50) and (5.51) are the simplest:
δ′
c + kVc + 3′ = 0 ,
Vc + HVc −k = 0 .
(7.1)
These equations depend only on k, therefore the k-dependence comes from the initial
condition, which indeed we know in the adiabatic case from Eq.(6.78) to be:
δc(k) =
15
15 + 4Rν
ζ(k) .
(7.2)
Do we have such initial conditions, i.e. do we know the scale dependence of the pri-
mordial curvature perturbation? Not exactly. According to our current understanding,
the universe had a quantum origin which we are not yet able to describe in detail
because of the lack of a quantum theory of gravity and also because we have no
experiments penetrating the trans-Planckian scales, allowing us at least to see what
is happening there.
The evolution equations which we had found start to be valid well after the Planck
scale, when gravity is safely classical. However, the initial conditions that we use
are coming from a quantum phase and as such they carry a probabilistic feature.
For example, we shall investigate the inﬂationary paradigm and we shall see that it
provides a prediction not on ζ(k) itself but rather on its probability distribution. In
particular, if it is a Gaussian one hence all the information is contained in its variance,
which is called power spectrum.
There is also another important point which stresses how useful is to treat cos-
mological perturbations as random variables. Observationally, it is impossible to
determine δ(η, x) for any given time because we receive signals from our past light-
cone only. It is impossible thus to recover the initial ζ(x) from what we observe. Even
if we would be able to concoct a theory predicting the initial ζ(x), we would not be
able to fully test it since we cannot determine δ(η, x) completely from observation.
Moreover, determining exactly δ(η, x) is an awful lot of information. For example,
it would mean that we are able to predict the position of a certain galaxy at a certain
time. Though this might be interesting to some extent, we are rather more concerned

7.1 Stochastic Cosmological Perturbations and Power Spectrum
213
with averaged quantities, such as the average distance among galaxies, because these
contain information on gravity and the expanding universe.
Hence, promoting (or rather demoting) δ(η, x) to a random variable, we are then
able to infer informations about its expectation value, variance or other high-order
correlators from the observation limited to our past light-cone. This allows us to make
contact with the descriptive statistics that we are able to make on the distribution
of structures in the sky.
7.2
Random Fields
A function G(x) is a random ﬁeld if its values are random variables for any x and
distribution functions
F1,2,...,n(g1, g2, . . . , gn) = F[G(x1) < g1, G(x2) < g2, . . . , G(xn) < gn] ,
(7.3)
exist for any n. We denote with capital G the random ﬁeld, so it has x dependence,
and with g a certain value that it can assume at a given x among all the possible
ones which form the ensemble. The subscripts in g1, g2, . . . , gn refer to the different
points x1, x2, . . . , xn in which the random ﬁeld is evaluated.
In particular, at a given point x1 some probability density functional exists:
p1(g1)dg1 ,
(7.4)
describing how probable is for G to assume a certain value g1 in x1. In terms of the
distribution function, p(g1) is deﬁned as:
p1(g1) = dF1(g1)
dg1
.
(7.5)
Since F is a cumulative probability then F1(−∞) = 0 and F1(∞) = 1. In cosmol-
ogy, G(x) is a perturbative quantity, such as the density contrast δ(x).
As usual, an expectation value of the random ﬁeld is deﬁned via an ensemble
average:
⟨G(x1)⟩≡


g1 p1(g1)dg1
(7.6)
where  denotes the ensemble.
In general, one has:
p1(g1) ̸= p2(g2) ,
(7.7)
i.e. the probability distribution of the values which G may assume in x1 is in general
different from the one of the values which G may assume in x2. When this does not
happen, i.e. the probability of the realisation is translationally invariant, the random

214
7
Stochastic Properties of Cosmological Perturbations
ﬁeld is said to be statistically homogeneous. For a statistically homogeneous random
ﬁeld then Eq.(7.6) is independent of x
⟨G⟩≡


g p(g)dg
(7.8)
Now we can think of more complicated and richer conﬁgurations of the random ﬁeld
G asking for example what is the probability of G(x1) and G(x2) being g1 and g2,
respectively. This is given by
p12(g1, g2)dg1dg2 ,
(7.9)
which can be written again as a derivative of the distribution function F12. In general:
p12(g1, g2) ̸= p1(g1)p2(g2) ,
(7.10)
unless the realisations are independent, in which case the random process is said to
be Poissonian. The 2-dimensional probability density allows us to deﬁne the 2-point
correlation function as follows:
ξ(x1, x2) ≡⟨G(x1)G(x2)⟩≡


g1g2 p12(g1, g2)dg1dg2
(7.11)
In a similar fashion, one can deﬁne N-point correlation functions as
ξ(N)(x1, x2, . . . , xN) ≡⟨G(x1)G(x2) . . . G(xN)⟩
≡


g1g2 . . . gN p12...N(g1, g2, . . . , gN)dg1dg2 . . . gN .
(7.12)
The order of the points matters, i.e. in general p12...N ̸= p21...N for example, and we
are using the same ensemble  for each point.
Exercise 7.1 If the random ﬁeld is statistically homogeneous, show that the 2-point
correlation function has the following property:
ξ(x1, x2) = ξ(x1 −x2) .
(7.13)
Given a rotation matrix R, deﬁne xR1 = Rx1. The random ﬁeld is statistically
isotropic if
p1(g1) = PR1(gR1)
∀R ,
(7.14)
i.e. the probability of the realisation is rotationally invariant.

7.2 Random Fields
215
Exercise 7.2 If the random ﬁeld is statistically homogeneous and statistically
isotropic, show that the 2-point correlation function has the following property:
ξ(x1, x2) = ξ(x1 −x2) = ξ(r12) ,
(7.15)
where r12 = |x1 −x2|. That is, the 2-point correlation function depends only on the
distance between the two points.
Following the standard deﬁnition that we learn in the ﬁrst course of statistics, the
ensemble variance of the random ﬁeld is deﬁned as:
σ2(x1, x2) ≡⟨G(x1)G(x2)⟩−⟨G(x1)⟩⟨G(x2)⟩
(7.16)
Therefore, if the random ﬁeld is statistically homogeneous and isotropic, we get:
σ2(r12) = ξ(r12) −⟨G⟩2 ,
(7.17)
where recall that ⟨G⟩2 does not depend on the position. Note that if random process
is Poissonian, i.e. p12(g1, g2) = p1(g1)p2(g2), then the variance is zero, since:
ξ(r12) = ⟨G⟩2 .
(7.18)
If G is a variable representing the distribution of galaxies, we do not expect it to
be a Poissonian random variable because gravity turns the odds for the galaxies to
be closer to each other rather than farther. Hence, we attribute deviations from the
Poissonian behaviour to gravity and for this reason it is very important to study the
2-point correlation function.
In observational cosmology we are able to compute just a spatial average of the
ﬁeld G(x), since we have just a single realisation, i.e. our universe. So, consider the
spatial average on a given volume V :
¯G ≡1
V

V
d3x G(x) .
(7.19)
What can we say about X ≡¯G −⟨G⟩? We use this as an estimator of the error which
we are making by exchanging the ensemble average with the spatial one.
Exercise 7.3 Show that:
⟨X⟩= 1
V

V
d3x ⟨G(x)⟩−⟨G⟩= 0 ,
(7.20)
and the variance is:

216
7
Stochastic Properties of Cosmological Perturbations
⟨X2⟩= 1
V 2

V
d3x1

V
d3x2⟨G(x1)G(x2)⟩−⟨G⟩2 .
(7.21)
Assuming statistical homogeneity we can then obtain
⟨X2⟩= 1
V 2

V
d3x1

V
d3x2 ξ(x1 −x2) −⟨G⟩2 .
(7.22)
We see that for a Poissonian process this variance is vanishing. In fact, if the galaxies
are randomly distributed, any volume is a good sample of the realisation.
The above integral can be written as
⟨X2⟩= 1
V

V
d3r ξ(r) −⟨G⟩2 .
(7.23)
In Sect.7.8 we show that this variance goes to zero if V →∞, a fact known as
ergodic theorem and based on a couple of reasonable assumptions. On the other
hand, in practice the volume is ﬁnite and thus ⟨X2⟩is in general different from zero.
In cosmology, it is called cosmic variance. Assuming statistical isotropy in the above
integral and using a spherical volume for convenience, we can write:
⟨X2⟩= 3
R3
 R
0
dr r2ξ(r) −⟨G⟩2 .
(7.24)
This is almost all we need to know about random ﬁelds in order to apply them to
cosmology, at least from the theoretical point of view. How to compute correlators
from the observational data is another issue which is not addressed in these notes.
Note that in the above description of a random ﬁeld G we have used the conﬁgura-
tion space whereas we have mostly used Fourier-transformed quantities representing
our cosmological perturbations. We assume that the FT of a random ﬁeld is also a
random ﬁeld, and all the above described properties apply.
Observationally, we are able to probe a realisation in a certain ﬁnite volume, say
a box of volume L3. Hence, the FT is deﬁned here as a Fourier series:
G(x) = 1
L3

n
Gneikn·x
(7.25)
where the coefﬁcients are given by:
Gn =

d3x G(x)e−ikn·x ,
(7.26)
and the wavenumbers are quantised, because of the periodic boundary conditions
that we must impose, which are equivalent to ask that G vanishes on the sides of the
box:

7.2 Random Fields
217
kn = 2π
L n ,
(7.27)
where n is a generic vector whose components are integers.
If the side of the box goes to inﬁnity, we recover the usual FT, i.e.
G(x) =

d3k
(2π)3 ˜G(k)eik·x ,
˜G(k) =

d3x G(x)e−ik·x .
(7.28)
Note that if G(x) is a real ﬁeld, then ˜G(−k) = ˜G∗(k), because of the following:
Exercise 7.4 Compare:
G(x) =

d3k
(2π)3 ˜G(k)eik·x ,
G∗(x) =

d3k
(2π)3 ˜G∗(k)e−ik·x .
(7.29)
The two expressions are equal if G(x) is real. Therefore, show that ˜G(−k) = ˜G∗(k).
The relation ˜G(−k) = ˜G∗(k), is called reality condition and we shall exploit it
in the following Chapters for the predictions on the observed spectra.
7.3
Power Spectrum and Gaussian Random Fields
Consider the 2-point correlation function for the Fourier transform of G(x):
⟨˜G(k) ˜G∗(k′)⟩=

d3x

d3x′⟨G(x)G(x′)⟩e−ik·xeik′·x′ .
(7.30)
Assume statistical homogeneity. Then:
⟨˜G(k) ˜G∗(k′)⟩=

d3x

d3x′ξG(x′ −x)e−ik·xeik′·x′ ,
(7.31)
and changing variable from x′ to z = x′ −x we get:
⟨˜G(k) ˜G∗(k′)⟩=

d3x e−i(k−k′)·x

d3z ξG(z)eik′·z .
(7.32)
Now, using the representation of the Dirac delta we get
⟨˜G(k) ˜G∗(k′)⟩= (2π)3δ(3)(k −k′)PG(k)
(7.33)

218
7
Stochastic Properties of Cosmological Perturbations
with the power spectrum deﬁned as:
PG(k) ≡

d3x ξG(x)e−ik·x
(7.34)
i.e. as the FT of the 2-point correlation function. If also statistical isotropy is assumed,
one has:
PG(k) = 2π
 ∞
0
dr r2 ξG(r)
 1
−1
du e−ikru ,
(7.35)
where u is the cosine of the angle between k and x, which we have used as variable
in the integration. Because of statistical isotropy then the power spectrum depends
only on the modulus of k. Performing the u integration, one gets:
PG(k) = 4π
 ∞
0
dr r2 ξG(r)sin(kr)
kr
.
(7.36)
7.3.1
Deﬁnition of a Gaussian Random Field
Now we deﬁne a Gaussian random ﬁeld, from the point of view of its Fourier
components ﬁrst. FT Gaussian random ﬁelds are deﬁned by uncorrelated modes,
i.e. precisely by Eq.(7.33). So, we have proved that Gaussianity implies statistical
homogeneity. Moreover, Gaussian random ﬁeld are characterised by the fact that the
expectation value and all the correlators of odd order are vanishing, i.e.
⟨˜G(k)⟩= ⟨˜G(k1) ˜G(k2) ˜G(k3)⟩= · · · = 0 .
(7.37)
All the correlators of even order can be written in terms of the second-order cor-
relators, i.e. the power spectrum, which thus contains all the information about the
random ﬁeld. For example, the 4-point correlator is:
⟨˜G(k1) ˜G(k2) ˜G(k3) ˜G(k4)⟩= ⟨˜G(k1) ˜G(k2)⟩⟨˜G(k3) ˜G(k4)⟩
+⟨˜G(k1) ˜G(k3)⟩⟨˜G(k2) ˜G(k4)⟩+ ⟨˜G(k1) ˜G(k4)⟩⟨˜G(k2) ˜G(k3)⟩.
(7.38)
Since all the Fourier modes are uncorrelated, their superposition is Gaussian-
distributed by virtue of the central limit theorem and hence the reason why they
are called Gaussian perturbations. So the g’s are distributed as a Gaussian:
p(g) =
1
√
2πσg
e−g2/2σ2
g ,
(7.39)

7.3 Power Spectrum and Gaussian Random Fields
219
where we are assuming a vanishing expectation value and the variance has been
deﬁned in Eq.(7.16). We have used g here instead of G(x) because of statistical
homogeneity.
7.3.2
Estimator of the Power Spectrum and Cosmic Variance
Theoretically, we shall provide predictions on PG(k) whereas observationally we
determine ξG(r), so it is more appropriate to invert the above FT. So, starting from
Eq.(7.11), we have:
ξG(r) = ⟨G(x)G(x + r)⟩=

d3k
(2π)3

d3k′
(2π)3 ⟨˜G(k) ˜G∗(k′)eik·x−ik′·(x+r)⟩.
(7.40)
We have included the Fourier modes in the average in order to investigate the differ-
ence between doing the spatial average or the ensemble one.
Doing the ensemble average. Using Eq.(7.33) in Eq.(7.40), the average must be
carried on the G’s:
ξG(r) =

d3k
(2π)3

d3k′PG(k)δ(3)(k −k′)eik·x−ik′·(x+r) ,
(7.41)
and gives us:
ξG(r) =

d3k
(2π)3 PG(k)e−ik·r .
(7.42)
Note that, since ξ is dimensionless, then PG(k) has dimension of a volume. Working
out the angular integration, we get:
ξG(r) =
 dk k2
(2π)2 PG(k)
 1
−1
du e−ikru ,
(7.43)
where again u is the cosine of the angle between k and r. Integrating for the last
time, we get:
ξG(r) =
 ∞
0
dk k2PG(k)
2π2
sin(kr)
kr
(7.44)
It is customary then to deﬁne a dimensionless power spectrum as
2
G(k) ≡k3PG(k)
2π2
(7.45)
so that Eq.(7.44) becomes:

220
7
Stochastic Properties of Cosmological Perturbations
ξG(r) =
 ∞
0
dk
k 2
G(k)sin(kr)
kr
(7.46)
Doing the spatial average. Suppose that none of the quantities in the integrand of
Eq.(7.40) is a stochastic variable and that ⟨. . . ⟩is a spatial average, which is the one
relevant from the point of view of observation. We must rewrite ξG(r) as follows:
ˆξG(r) = 1
V

V
d3x

n,m
1
V 2 GnG∗
meikn·x−ikm·(x+r) ,
Gn = ˜G(kn) ,
kn = 2π
L n ,
(7.47)
where we have used the Fourier series expansion because we are in a ﬁnite volume,
that we have chosen to be a cube of side L and hence V = L3. This volume can be
thought as the survey volume. Note that the summation over n and m is intended as
a sum over the three components of n and m since we cannot use statistical isotropy
now. The spatial integration gives:
1
L3

V
d3x ei(kn−km)·x = δnm .
(7.48)
Exercise 7.5 Show in one dimension, for simplicity, that:
1
L
 L/2
−L/2
dx ei(kn−km)x = 2 sin[(kn −km)L/2]
(kn −km)L
.
(7.49)
Since k is quantised, the difference kn −km is always a multiple of 2π/L, thereby
making the sine to vanish. The only exception is when the difference is zero, i.e. for
n = m.
So, we have for the correlation function:
ˆξG(r) =

n
1
V 2 |Gn|2e−ikn·r ,
(7.50)
from which we infer the power spectrum as:
Pn ≡P(kn) = |Gn|2
V
.
(7.51)
Since the survey volume is ﬁnite we saw that the smallest wavenumber that we
can build is 2π/L and the smallest cell in the wavenumber space has thus volume
(2π/L)3.

7.3 Power Spectrum and Gaussian Random Fields
221
Exercise 7.6 Prove that the number of independent modes between k and k + dk
is1:
Nk = 4πk2
 L
2π
3
dk =
1
2π2 (kL)3 dk
k .
(7.52)
From this number of independent modes, we then know that the cosmic variance
of the power spectrum is:
σP(k)
P(k) ≃
1
√Nk
≃
1
r1/2
k
(kL)3/2 ,
(7.53)
where we have deﬁned rk ≡dk/k as the resolution of the survey. If we assume
inﬁnite resolution then we have to derive again the above result since the dimension
is reduced by one.
Exercise 7.7 Show that the number of independent modes on the sphere of radius
k in the wavenumber space are:
Nk = 4πk2
 L
2π
2
= (kL)2
π
.
(7.54)
In this case, one gets:
σP(k)
P(k) ≃
1
√Nk
≃1
kL ,
(7.55)
for the cosmic variance, which is the result obtained in Weinberg (2008).
These formulae for the cosmic variance tell us that the latter is negligible if the
scale probed is much smaller that the dimension L of the survey, i.e. kL ≫1.
7.4
Non-Gaussian Perturbations
For non-Gaussian perturbations the odd-order correlators are non-vanishing. For
example:
⟨˜G(k1) ˜G(k2) ˜G(k3)⟩= (2π)3δ(3)(k1 + k2 + k3)BG(k1, k2, k3) ,
(7.56)
where BG(k1, k2, k3) is called bispectrum and can be rewritten as:
1This calculation is essentially identical to the one which leads to the deﬁnition of the Fermi
momentum of a gas of fermions, which might be more familiar to the reader. See e.g. Huang (1987)

222
7
Stochastic Properties of Cosmological Perturbations
BG(k1, k2, k3) = BG(k1, k2, k3) [PG(k1, k2) + PG(k2, k3) + PG(k1, k3)] ,
(7.57)
i.e. in terms of a purely FT of a 3-point correlation function, called reduced bispec-
trum, multiplied by all the possible combinations of the FT transforms of the 2-point
correlation functions (i.e. the PS). This formula can be obtained using the following
expansion:
G(x) = GG(x) + fN L

G2
G(x) −⟨G2
G(x)⟩

+ . . . ,
(7.58)
where ⟨G2
G(x)⟩≡σ2
G. This expansion is called local type non-Gaussianity and is
based on the fact that the square of a Gaussian random ﬁeld GG(x) is not Gaussian.
The amount of non-Gaussianity is indicated by the free parameter fN L, which Planck
has constrained to be (Ade et al. 2016):
fN L = 2.5 ± 5.7
(68% CL, statistical)
(7.59)
The huge relative error shows how difﬁcult is to extract this kind of information
and at the same time how Gaussianity ( fN L = 0) is fully consistent with data. Note
that we are talking here of primordial non-Gaussianity. In the structure formation
process, non-Gaussianity naturally arises in the non-linear regime of evolution.
7.5
Matter Power Spectrum, Transfer Function
and Stochastic Initial Conditions
All the formula derived in the previous section can be in principle directly adapted
to the matter density contrast ﬁeld δ(η, k),2 but how do we deal with the time depen-
dence of the latter? In principle, one just needs to substitute G(x) for δ(η, x), where
we are leaving on purpose the time-dependence. We then have:
ξδ(η,r) =
 ∞
0
dk
k 2
δ(η,r)sin kr
kr
,
2
δ(η,r) = k3Pδ(η, k)
2π2
,
(7.60)
and, from Eq.(7.33) we have
⟨δ(η, k)δ∗(η, k′)⟩= (2π)3δ(3)(k −k′)Pδ(η, k) .
(7.61)
In the above equation we have assumed Gaussianity in the initial conditions. In the
linear case the modes evolve independently and hence Gaussianity is preserved, for
this reason the above equation is valid even if it is considered at any time η.
2We drop here the subscript of δ in order to keep a light notation. The treatment can be in principle
applied to any δ, but the most interested case is that for matter, i.e. CDM plus baryons.

7.5 Matter Power Spectrum, Transfer Function and Stochastic Initial Conditions
223
As we have anticipated, the stochastic character of δ(η, k) is due just to its initial
value δ(k). Hence, it is customary to write:
Pδ(η, k) = T 2(η, k)Pδ(k)
(7.62)
where T (η, k)isthe transferfunction and Pδ(k)isthe primordialpowerspectrum,
i.e.
⟨δ(k)δ∗(k′)⟩= (2π)3δ(3)(k −k′)Pδ(k) ,
(7.63)
where δ(k) is the initial condition of δ. The primordial power spectrum is a prediction
of inﬂation that we shall compute in Chap.8 whereas the transfer function is the
solution of the evolution equations that we have found in Chaps.4 and 5, with the
primordial modes found in Chap.6 as initial conditions. These are characterised
by constants multiplied by a function of k, which becomes our stochastic initial
condition.Wecallthisα(k)forscalarmodesandβ(k, λ)fortensormodes,borrowing
the notation used in Weinberg (2008). Also, in the rest of these notes we shall drop
the explicit use of the transfer function T (η, k), by adopting the renormalisation:
δ(η, k) →α(k)δ(η, k) ,
(η, k, ˆp) →α(k)(η, k, ˆp) ,
(7.64)
e.g. for the density contrast and for , when it shall be necessary.
Let us see a practical example of how to calculate T 2(η, k) and its normalised
initial conditions. Consider adiabaticity. Then, all perturbations are sourced by
α(k) = ζ(k) = R(k) = Cγ(k). If we normalise the initial condition Cγ(k) = 1, then
we have from Eq.(6.71) and the subsequent ones:
1
3δc = 1
3δb = 1
4δγ = 1
4δν = − + 1 ,
 = −
10
15 + 4Rν
,
 = −

1 + 2
5 Rν

.
(7.65)
With this collection of initial conditions we can compute the transfer functions for
each variable, square them and propagate the primordial power spectrum forward to
any time. Hence, for matter, we can write:
Pδ(η, k) = T 2(η, k)Pδ(k) = T 2(η, k)

15
15 + 4Rν
2
Pζ(k) .
(7.66)
Finally, a comment on the following. Note that in Eq.(7.63) we have the product of
two δ’s in ⟨δ(k)δ∗(k′)⟩. Is not this of second order and thus negligible? Locally it is,
but the ensemble average can be seen as a spatial average, cf. Eq.(7.47), and thus we
have a vanishing quantity integrated over an inﬁnite volume giving a ﬁnite result.

224
7
Stochastic Properties of Cosmological Perturbations
7.6
CMB Power Spectra
CMB photons do not come from a localised source but from the whole celestial
sphere and from a ﬁnite distance, the last scattering surface, which corresponds to
a redshift of z ∼1100. Hence, one usually approaches the CMB power spectrum
differently from the matter one (this coming from the observation of galaxies).
The relative ﬂuctuation in the temperature δT/T is the same  that we deﬁned
in Eq.(5.80) if we suppose that the perturbed distribution function Fγ does not
depend on the photon energy p. Since this assumption is justiﬁed by the fact that
Thomson scattering with electrons is the relevant physical process generating 
and in Thomson scattering the energy of the photon is unchanged, we shall use
δT/T = .
Note that  = (η, x, ˆp), but from the point of view of observation, we are
just interested in temperature ﬂuctuations here and today, i.e. for η = η0 and x = x0,
where the latter is the position of our laboratory (i.e. Earth). Moreover, photons travel
on the light-cone (they come from our past light-cone) and from the ﬁxed distance
to the last-scattering surface. Hence:
x∗= −(η0 −η∗) ˆp = −r∗ˆp ,
(7.67)
where η0 is the present conformal time, η∗the recombination one and r∗≡η0 −η∗
is the comoving distance to recombination. Only photons satisfying this relation can
be detected because their momentum is in the “correct” direction (i.e. towards us)
and they free stream only after recombination. Therefore, of the 6 variables upon
which (η, x, ˆp) in principle depends only 2 are observationally relevant, since we
observe
(η0, x0, ˆn) ,
(7.68)
where ˆn = −ˆp are indeed coordinates on the celestial sphere. The direction to the
photon towards us is ˆp, so our line of sight unit vector has the opposite sign.
Now we omit the (η0, x0) dependence of . It is customary to expand a function on
the sphere in spherical harmonics Y m
ℓ(θ, φ). Hence, for our temperature ﬂuctuation
we have3:
(ˆn) =
∞

ℓ=0
ℓ

m=−ℓ
aT,ℓmY m
ℓ(θ, φ)
(7.69)
where we have written ˆn = (sin θ cos φ, sin θ sin φ, cos θ) (i.e. employed spherical
coordinates) and Y m
ℓ(θ, φ) are the spherical harmonics. Recall that these are revised
in some detail in Sect.12.5.
In these notes we adopt a normalisation which guarantees orthormality, i.e.
3The expansion is usually considered for T , the temperature ﬂuctuation. In this case, the aT,ℓm’s
carry dimensions of temperature. The only difference between the coefﬁcients of the two expansions
is a factor T0, i.e. the temperature of the CMB.

7.6 CMB Power Spectra
225

d2 ˆn Y m
ℓ(ˆn)Y m′∗
ℓ′
(ˆn) = δℓℓ′δmm′ .
(7.70)
Note that the spherical harmonics Y m
ℓare in general complex4 and so the aℓm must
also be such, in order for (θ, φ) to be real.
Exercise 7.8 According to our conventions established in Sect.12.5 show that
Y m∗
ℓ(ˆn) = Y −m
ℓ
(ˆn) ,
(7.71)
and hence, in order for (ˆn) to be real, show that:
a∗
T,ℓm = aT,ℓ,−m ,
(7.72)
which is a reality condition for the coefﬁcients aT,ℓm.
Note that the expansion (7.69) can be done at each point of spacetime, but then the
angular dependence changes because the (θ, φ) measured from one point in space
correspond to different celestial coordinates as seen from another spot in space.
The expansion of Eq.(7.69) can be inverted as follows:
aT,ℓm =

d2 ˆn Y ∗m
ℓ(ˆn)(ˆn) ,
(7.73)
and the aℓm’s are promoted to stochastic variable, just as  is. Again, it is the initial
conditions for cosmological perturbations which are actual stochastic variables for
which inﬂation predicts a power spectrum, so we shall introduce a transfer function.
For Gaussian perturbations, the expectation value and variance of the aT,ℓm’s are:
⟨aT,ℓm⟩= 0
⟨aT,ℓma∗
T,ℓ′m′⟩= δℓℓ′δmm′CT T,ℓ
(7.74)
and the CT T,ℓ= ⟨|aT,ℓm|2⟩form the CMB power spectrum. Introducing the Fourier
transform, we have:
CT T,ℓ= ⟨

d3k
(2π)3

d3k′
(2π)3 ei(k−k′)·x0

d2 ˆn Y ∗m
ℓ
(ˆn)(k, ˆn)

d2 ˆn′ Y m
ℓ(ˆn′)∗(k′, ˆn′)⟩.
(7.75)
The ensemble average acts on the temperature ﬂuctuations, which we renormalise to
some primordial mode α(k):
⟨(k, ˆn)∗(k′, ˆn′)⟩= ⟨α(k)α∗(k′)⟩(k, ˆn)∗(k′, ˆn′) .
(7.76)
4The notation Yℓm usually denotes spherical harmonics in the real form, obtained by combining Y m
ℓ
in a suitable way in order to trade the imaginary exponential exp(imφ) for a sine or cosine function
of mφ.

226
7
Stochastic Properties of Cosmological Perturbations
We should have perhaps written T(k, ˆn), stressing the introduction of a transfer
function, but we have decided to keep a simple notation.
For scalar perturbations we saw that, assuming axially symmetric initial condi-
tions, the dependence is only on ˆk · ˆp = μ = −ˆk · ˆn and we have used the multipole
expansion in Eq.(5.113), which can be easily inverted as follows:
(S)(k, μ) =

ℓ
(−i)ℓ(2ℓ+ 1)Pℓ(μ)(S)
ℓ(k) .
(7.77)
The evolution of the multipoles (S)
ℓ(η, k) until η0 (today) is given by the hierarchy
of Eqs.(5.119)–(5.122) which in fact depend only on the modulus k.
Assuming adiabatic Gaussian perturbations, i.e. α(k) = R(k) and
⟨R(k)R∗(k′)⟩= (2π)3δ(3)(k −k′)PR(k) ,
(7.78)
we have from Eq.(7.75):
C S
T T,ℓ=

d3k
(2π)3 |(S)
ℓ(η0, k)|2PR(k)

d2 ˆn Y m∗
ℓ(ˆn)

d2 ˆn′ Y m
ℓ(ˆn′)

ℓ′
(−i)ℓ′(2ℓ′ + 1)Pℓ′(μ)

ℓ′′
iℓ′′(2ℓ′′ + 1)Pℓ′′(μ) . (7.79)
Note that a similar result can be obtained from Eq.(7.75) if we perform as spatial
average, i.e. an average over x0, as we saw in the case of the three-dimensional power
spectrum. In this case the square modulus |(k, ˆn)|2 appears, as our estimator of the
angular power spectrum.
Recall that the Legendre polynomial is proportional to Y 0
ℓand thus from the
orthogonality of the spherical harmonics and the addition theorem we get:

d2 ˆn Pℓ′(μ)Y m∗
ℓ(ˆn) =

d2 ˆn Pℓ′(−ˆk · ˆn)Y m∗
ℓ(ˆn) =
4π
2ℓ+ 1Y m∗
ℓ(ˆk)δℓℓ′ . (7.80)
Hence we have:
C S
T T,ℓ= 2
π

dk k2|(S)
ℓ(η0, k)|2PR(k) = 4π
 dk
k |(S)
ℓ(η0, k)|22
R(k)
(7.81)
where we have used:

d2 ˆk |Y m
ℓ(ˆk)|2 = 1 .
(7.82)
We shall discuss the tensor contribution to the CMB TT spectrum in Chap.10.
Not only temperature anisotropies are measurable in the CMB sky, but also
polarisation ones. Hence, we have more correlation functions and spectra than the
temperature-temperature (TT) one. As we discussed in Chap.5, Thomson scattering

7.6 CMB Power Spectra
227
provides only linear polarisation, which is described by the two Stokes parameters
Q and U. It is customary to use the combinations Q ± iU since these have helicity
2, i.e. under a rotation of an angle θ in the polarisation plane they transform as:
(Q ± iU) →e±2iθ(Q ± iU) .
(7.83)
Similarquantitiesweredeﬁnedforgravitationalwaves.Now, Q ± iU representﬁelds
of helicity 2 on the sphere and as such they can be expanded in spin 2-weighted
spherical harmonics:
(Q + iU)(ˆn) =
∞

ℓ=2
ℓ

m=−ℓ
aP,ℓm 2Y m
ℓ(ˆn) ,
(7.84)
(Q −iU)(ˆn) =
∞

ℓ=2
ℓ

m=−ℓ
a∗
P,ℓm 2Y m∗
ℓ(ˆn) .
(7.85)
The spin-weighted spherical harmonics do not satisfy simple reality conditions as
the spin-0 ones (the usual spherical harmonics) do, i.e. Y m∗
ℓ
= Y −m
ℓ
, and therefore it
is convenient to use the following combinations of aP,ℓm:
aE,ℓm = −(aP,ℓm + a∗
P,ℓ−m)/2 ,
aB,ℓm = i(aP,ℓm −a∗
P,ℓ−m)/2 .
(7.86)
These satisfy reality conditions and have the following properties under spatial inver-
sion: aE,ℓm gains a factor (−1)ℓ, as the aℓm of the temperature-temperature correla-
tion, whereas aB,ℓm gain an extra −1 factor.
If we assume thus stochastic initial conditions which are invariant under spa-
tial inversion, the only four spectra that we can build from CMB temperature and
polarisation measurement are thus:
⟨aT,ℓma∗
T,ℓ′m′⟩= δℓℓ′δmm′CT T,ℓ
⟨a∗
T,ℓmaE,ℓ′m′⟩= δℓℓ′δmm′CT E,ℓ
(7.87)
⟨aE,ℓma∗
E,ℓ′m′⟩= δℓℓ′δmm′CE E,ℓ
⟨aB,ℓma∗
B,ℓ′m′⟩= δℓℓ′δmm′CBB,ℓ
(7.88)
Note that there is no dependence on m in the power spectra. This is again due to
statistical isotropy. Violation of the latter is related to the so-called CMB anomalies.
These are unexpected features in the CMB sky, such as the axis of evil and the large
cold spot in the southern hemisphere (Schwarz et al. 2016). The explanation of these
anomalies is an open issue of modern cosmology.
Statistical isotropy is motivated by the Copernican principle and predicted by
many inﬂationary theories.5
5According to the Copernican principle we do not occupy a special position in the universe. There-
fore, its average properties that we are able to determine should be the same as those determined
by any other observer.

228
7
Stochastic Properties of Cosmological Perturbations
7.6.1
Cosmic Variance of Angular Power Spectra
In this section we compute the cosmic variance of the angular power spectra. The
result can be applied to any ﬁeld deﬁned on the sphere and for Gaussian perturbations,
which are characterised by a correlation function which depends only on the angular
separation and thus the power spectrum is Cℓ, depending only on ℓ.
In order to compute the cosmic variance, let us do ﬁrst an estimate. Our objective is
to determineCℓobservationally, in order to compare it with our theoretical prediction.
In order to do that, we probe ⟨aℓma∗
ℓm⟩for different values of m, which are 2ℓ+ 1.
Hence, we have 2ℓ+ 1 possible sampling of Cℓfor any given ℓand a sampling error
Cℓ∝
√
2ℓ+ 1 .
(7.89)
The relative error associated to the sampling, i.e. the cosmic variance, is thus:
σCℓ=
Cℓ
2ℓ+ 1 ∝
1
√2ℓ+ 1
.
(7.90)
Now, let us make a more precise calculation following (Weinberg 2008). Consider
the temperature-temperature correlation function, as an example:
⟨(ˆn)(ˆn′)⟩=

ℓmℓ′m′
⟨aℓmaℓ′m′⟩Y m
ℓ(ˆn)Y m′
ℓ′ (ˆn′) =

ℓm
CℓY m
ℓ(ˆn)Y −m
ℓ
(ˆn′) ,
(7.91)
where cos θ ≡ˆn · ˆn′ and we have performed the ensemble average assuming Gaus-
sian perturbations. The −m of the second spherical harmonics comes from the reality
condition by which a∗
ℓm = aℓ,−m.
Using the addition theorem of the spherical harmonics, we can do the sum over
m in the above formula and obtain:
C(θ) ≡⟨(ˆn)(ˆn′)⟩=

ℓ
Cℓ
2ℓ+ 1
4π
Pℓ(ˆn · ˆn′) =

ℓ
Cℓ
2ℓ+ 1
4π
Pℓ(cos θ) .
(7.92)
So we have explicitly proved that for Gaussian perturbations the correlation function
depends only on the angle between the two directions. Inverting this relation using
the orthonormality of the Legendre polynomials, we get:
Cℓ= 1
4π

d2 ˆn d2 ˆn′ Pℓ(ˆn · ˆn′)⟨(ˆn)(ˆn′)⟩,
(7.93)
which is Eq.(7.75), without introducing the FT, which we do not need here.
The integral is of course on the whole sky. These are the theoretical Cℓ’s, and the
average is the ensemble one. Observationally, the only average that we can do is the
angular one, i.e.

7.6 CMB Power Spectra
229
Cobs
ℓ
= 1
4π

d2 ˆn d2 ˆn′ Pℓ(ˆn · ˆn′)(ˆn)(ˆn′) .
(7.94)
Exercise 7.9 Show that, substituting the spherical harmonics expansions, we have:
Cobs
ℓ
= 1
4π

LML′M′

d2 ˆn d2 ˆn′ Pℓ(ˆn · ˆn′)aLMY M
L (ˆn)aL′M′Y M′
L′ (ˆn′)
=
1
2ℓ+ 1

m
aℓmaℓ,−m .
(7.95)
Here it appears more clearly that for each value of ℓwe have 2ℓ+ 1 possible
realisations and thus we expect that the counting error is
√
2ℓ+ 1. We can calculate
this exactly, and the cosmic variance is the following ensemble average:
σ2
Cℓ=
Cℓ−Cobs
ℓ
Cℓ
2	
= 1 −2⟨Cobs
ℓ⟩
Cℓ
+ 1
C2
ℓ
⟨Cobs
ℓ
2⟩.
(7.96)
Of course, the ensemble average of ⟨Cobs
ℓ⟩is Cℓ, just look at the integral which deﬁnes
it, and the ensemble average of Cℓis Cℓ, since it is already averaged. Therefore, let
us focus on
⟨Cobs
ℓ
2⟩=
1
(2ℓ+ 1)2

mm′
⟨aℓmaℓ,−maℓm′aℓ,−m′⟩.
(7.97)
Since the perturbations are Gaussian, this 4-point correlator can be split into the
following sum, by Eq.(7.38):
⟨aℓmaℓ,−maℓm′aℓ,−m′⟩= ⟨aℓmaℓ,−m⟩⟨aℓm′aℓ,−m′⟩+ ⟨aℓmaℓm′⟩⟨aℓ,−maℓ,−m′⟩
+⟨aℓmaℓ,−m′⟩⟨aℓm′aℓ,−m⟩.
(7.98)
Using Eq.(7.74), we ﬁnally get:
σ2
Cℓ=
2
2ℓ+ 1
(7.99)
as expected.

230
7
Stochastic Properties of Cosmological Perturbations
7.7
Power Spectrum for Tensor Perturbations
When we compute the power spectrum for GW, using the decomposition of helicities
of Eq.(4.211), we get:
⟨hT
i j(η, k)hT ∗
lm (η, k′)⟩=

λ,λ′=±2
ei j(ˆk, λ)e∗
lm(ˆk′, λ′)⟨h(η, k, λ)h∗(η, k′, λ′)⟩,
(7.100)
the stochastic behaviour being carried by the initial condition on h(η, k, λ), which
we then renormalise as:
h(η, k, λ) = β(k, λ)h(η, k)
(7.101)
Since the evolution equation for tensor perturbations depends only on k and does not
depend on the helicity λ, we incorporate the latter in the stochastic initial condition.
Asking translational invariance (Gaussian perturbations) and rotational invari-
ance, we have:
⟨β(k, λ)β∗(k′, λ′)⟩= (2π)3Ph(k)δλλ′δ(3)(k −k′) .
(7.102)
Therefore, in the ensemble average of ⟨hT
i j(η, k)hT∗
lm (η, k′)⟩it appears the sum over
the helicities:
i j,lm(ˆk) ≡

λ=±2
ei j(ˆk, λ)e∗
lm(ˆk, λ) .
(7.103)
We can make this sum explicit as follows. Consider the fact that i j,lm(ˆk) is a tensor
which depends on ˆk. In order to have the correct combination i j,lm of indices it
must be a combination of the only independent tensors that are around, i.e. δi j and
ˆkm. In order to have the correct combination i j,lm of indices, we can combine two
δi j, one δi j and two ˆkm or four ˆkm. So we can put forward the following ansatz:
i j,lm(ˆk) = A(δilδ jm + δimδ jl) + Bδi jδlm
+Cδi j ˆkl ˆkm + Dδlm ˆki ˆk j + E(δil ˆk j ˆkm + δ jm ˆki ˆkl + δim ˆk j ˆkl + δ jl ˆki ˆkm)
+F ˆki ˆk j ˆkl ˆkm ,
(7.104)
where we have grouped together all the terms which must be symmetrised in order
to respect the symmetry of i j,lm(ˆk), which is symmetric in i j and in lm separately.
The coefﬁcient introduced above are, in principle, complex.
Exercise 7.10 Contract the above ansatz for i j,lm(ˆk), with ˆki, with ˆkl and with
δi j. Since the result must be zero, show that have the following conditions on the
coefﬁcients:

7.7 Power Spectrum for Tensor Perturbations
231
A = −B = C = D = −E = F .
(7.105)
Thus, we can write:
i j,lm(ˆk) = A(δilδ jm + δimδ jl −δi jδlm
+δi j ˆkl ˆkm + δlm ˆki ˆk j −δil ˆk j ˆkm −δ jm ˆki ˆkl −δim ˆk j ˆkl −δ jl ˆki ˆkm
+ˆki ˆk j ˆkl ˆkm) .
(7.106)
Now, since ∗
i j,lm(ˆk) = lm,i j(ˆk), i.e. complex conjugation amounts to exchange the
couple i j with lm, it is not difﬁcult to conclude that A is a real number. In order to
determine which number, consider the normalisation used in Eq.(4.206). If we set
ˆk = ˆz in our improved ansatz above and choose i = j = l = m = 1, we get:
11,11(ˆk) =

λ=±2
e11(ˆk, λ)e∗
11(ˆk, λ) = 1 = A .
(7.107)
Therefore, we can conclude that:
i j,lm(ˆk) = δilδ jm + δimδ jl −δi jδlm
+δi j ˆkl ˆkm + δlm ˆki ˆk j −δil ˆk j ˆkm −δ jm ˆki ˆkl −δim ˆk j ˆkl −δ jl ˆki ˆkm
+ˆki ˆk j ˆkl ˆkm .
(7.108)
7.8
Ergodic Theorem
Following Weinberg (2008), here we brieﬂy presents the ergodic theorem, which
allows us to exchange ensemble and spatial average under certain conditions.
Consider a random variable G(x) in a D-dimensional Euclidean space and assume
statistical homogeneity, i.e.
⟨G(x1)G(x2) . . . G(xn)⟩= ⟨G(x1 + z)G(x2 + z) . . . G(xn + z)⟩,
(7.109)
i.e. when we calculate the correlator, the result does not change upon translation of
the ﬁelds.
Also, let us make the following reasonable assumption. When we calculate a
correlator where a certain amount of points are very far from another set, then the
correlator breaks. That is:

232
7
Stochastic Properties of Cosmological Perturbations
⟨G(x1 + u)G(x2 + u) . . . G(y1 −u)G(y2 −u) . . . ⟩
→|u|→∞⟨G(x1 + u)G(x2 + u) . . . ⟩⟨G(y1 −u)G(y2 −u) . . . ⟩
= ⟨G(x1)G(x2) . . . ⟩⟨G(y1)G(y2) . . . ⟩,
i.e., if we think of a simple 2-point correlation function, the points become uncorre-
lated on a large distance and so it is like having independent ensembles, which is the
key in order to exchange the spatial average with the ensemble one. In the last line
of the above equation we have used statistical homogeneity.
Now deﬁne what in some sense is closely related to the cosmic variance:
σ2
R(x1, x2, . . . ) ≡


d DzNR(z)G(x1 + z)G(x2 + z) . . .

−⟨G(x1)G(x2) . . . ⟩
2	
,
(7.110)
where the integral is a spatial average about a point z0, recall that the dimension of
the space is D, and the window function or ﬁlter is for example:
NR(z) ≡
1
(√πR)D e−|z−z0|2/R2 ,
(7.111)
which, as it can be checked, is normalised to unity, i.e.

d Dz NR(z) = 1, the inte-
gration being over all the space. This function is basically a ﬁlter and its form is
not important as long it is almost constant for |z −z0|2 < R2 and decays rapidly for
|z −z0|2 > R2. It introduces a scale R which is the limiting one until which we are
able to do a spatial average and so we want to check how this variance depends on
R. We can think of R as the size of a survey, for example.
The ergodic theorem states that
σ2
R(x1, x2, . . . ) ∼R−D
for R →∞.
(7.112)
In order to prove it, expand the square in the variance:
σ2
R =

d DzNR(z)

d DwNR(w)(G(x1 + z)G(x2 + z) · · · −⟨G(x1)G(x2) . . . ⟩)
× (G(x1 + w)G(x2 + w) · · · −⟨G(x1)G(x2) . . . ⟩)⟩.
(7.113)
We can incorporate the ensemble average into the integral because of

d Dz
NR(z) = 1. Now apply the average and use statistic homogeneity:
σ2
R =

d DzNR(z)

d DwNR(w)(⟨G(x1 + z)G(x2 + z) . . . G(x1 + w)G(x2 + w) . . . ⟩
−⟨G(x1)G(x2) . . . ⟩2) .
(7.114)

7.8 Ergodic Theorem
233
Now change integration variables:
u = (z −w)/2 ,
v = (z + w)/2 ,
(7.115)
and, remembering to take into account the Jacobian of the transformation, which is
2D, and the expression we have adopted for the window function:
σ2
R =
 2
πR2
D 
d Dv

d Du e−|u+v−z0|2/R2−|v−u−z0|2/R2
(⟨G(x1 + u + v)G(x2 + u + v) . . . G(x1 + v −u)G(x2 + v −u) . . . ⟩−
⟨G(x1)G(x2) . . . ⟩2) .
(7.116)
Now, the v in the ﬁelds is always summed to the coordinate so we can use again
statistic homogeneity and eliminate v from the average, getting:
σ2
R =
 2
πR2
D 
d Dv

d Du e−2|u|2/R2e−|v−z0|2/R2
(⟨G(x1 + u)G(x2 + u) . . . G(x1 −u)G(x2 −u) . . . ⟩−⟨G(x1)G(x2) . . . ⟩2) .
(7.117)
The integration in v can be immediately performed, being a Gaussian integral equal
to (π/2)D/2RD:
σ2
R =
 2
πR2
D/2 
d Du e−2|u|2/R2
(⟨G(x1 + u)G(x2 + u) . . . G(x1 −u)G(x2 −u) . . . ⟩−⟨G(x1)G(x2) . . . ⟩2) .
(7.118)
Note that z0 is no more present, as it should be because of statistical homogeneity.
The term between parenthesis goes to zero for large |u|, on the basis of the hypothesis
made at the beginning of our discussion, therefore the |u| integral is ﬁnite and above
all, its value does not depend on R because the difference among the ensemble
averages does not depend on our choice of R. Then, we can conclude that:
σR = O(R−D/2)
(7.119)

234
7
Stochastic Properties of Cosmological Perturbations
References
Ade, P.A.R., et al.: Planck 2015 results. XVII. Constraints on primordial non-Gaussianity. Astron.
Astrophys. 594, A17 (2016)
Huang, K.: Statistical Mechanics, 2nd edn. Wiley-VCH, New York (1987)
Lyth, D.H., Liddle, A.R.: The Primordial Density Perturbation: Cosmology, Inﬂation and the Origin
of Structure (2009)
Schwarz, D.J., Copi, C.J., Huterer, D., Starkman, G.D.: CMB anomalies after Planck. Class. Quant.
Grav. 33(18), 184001 (2016)
Weinberg, S.: Cosmology. Oxford University Press, Oxford (2008)

Chapter 8
Inﬂation
And if inﬂation is wrong, then God missed a good trick. But, of
course, we’ve come across a lot of other good tricks that nature
has decided not to use
Jim Peebles, interview at Princeton (1994)
We dedicate this chapter to inﬂation, a model of the primordial universe in which an
almost constant H provides a scale factor a growing exponentially with the cosmic
time. Inﬂation is able to solve some puzzles related to background cosmology and
also to provide a testable prediction of the power spectrum of primordial ﬂuctuations.
Among the ﬁrst pioneering works on inﬂation there are Starobinsky (1979), Guth
(1981), Linde (1982) and Albrecht and Steinhardt (1982).
An alternative to inﬂation which has risen some interest is the so-called bouncing
cosmology in which the universe is eternal and whose evolution is characterised by
a contracting phase followed by an expanding one, through a bouncing phase whose
physical details are governed by quantum cosmology. See Novello and Bergliaffa
(2008) and Brandenberger and Peter (2017) for recent reviews on the subject which,
though interesting, we shall not tackle here.
8.1
The Flatness Problem
Recall the deﬁnition of the curvature density parameter that we gave in Eq.(2.69):
K ≡−
K
H 2a2 ,
(8.1)
and of its observed value coming from the latest Planck data (Ade et al. 2016b):
K0 = 0.0008+0.0040
−0.0039 .
(8.2)
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_8
235

236
8
Inﬂation
at the 95% conﬁdence level. It is with a lot of conﬁdence, much larger that 95%, that
we can conclude that:
|K0| < 1 .
(8.3)
But then notice the following:
|K| =
−
K
H 2a2
 =
−
K
H 2a2
H 2
0 a2
0
H 2a2
 = |K0|
H 2
0
H 2a2 <
H 2
0
H 2a2 ,
(8.4)
where we have used a0 = 1. Now, how does the function on the right hand side scale?
When a →0, since radiation dominates, we have that:
H 2
0
H 2a2 ∼a2 →0 .
(8.5)
That is, the more in the past we go the closer to zero K gets. And closer means
really closer. Indeed:
Exercise 8.1 Show that at the radiation-matter equivalence, i.e. at z = 104, K <
10−4. Show that at BBN, i.e. at z = 1010, K < 10−16. Then show that the Planck
time corresponds roughly to z = 1032, and then there we have K < 10−60.
The Planck time is the farthest we can extrapolate our classical theory and 10−60
is something really close to zero. What is the problem here? The problem is that if
by some reason K ∼10−59 at the Planck era, then today K0 would be ten times
larger and in complete disagreement with observation. In order to match what we
observe today, K has to be determined at the Planck scale with a precision of 60
signiﬁcative digits! This is an example of ﬁne-tuning.
Fine tunings might not be actual problems for theories, in the same sense that
falsiﬁed predictions rule out wrong theories, but denote something ad hoc, unnatural
and therefore something that we would like to explain in another way if possible.
As for the ﬂatness problem the very simple idea put forward in Guth (1981) is
the following. Regard Eq.(8.1). If H is constant, then K ∝1/a2. Thus, if before
the radiation-dominated era the very early universe experienced a phase in which H
is constant, this could explain why K is so small to begin with, without recurring
to any ﬁne-tuning. This primordial phase with H constant, or almost constant, is
inﬂation.
Inﬂation must take place in a primordial phase of evolution, prior to radiation
domination, in order not to spoil the successful predictions of the Hot Big Bang
model.

8.1 The Flatness Problem
237
Exercise 8.2 Show that a constant H implies that:
H = constant ⇒a ∝eHt ,
(8.6)
i.e. an exponential growth with time of the scale factor.
Let us see quantitatively how inﬂation can solve the ﬂatness problem. Suppose
that
|K|
a2
i H 2
i
= O(1) ,
(8.7)
at the beginning of the inﬂationary phase, to which we refer with a subscript i. That
is, at the beginning of inﬂation the spatial curvature might be a relevant fraction of
the total energy density content of the universe.
Now, at the end of inﬂation, which we denote with a subscript I, the scale factor
a has grown of a factor eN. The number N is called e-folds number. Then we have:
|K|
a2
I H 2
I
=
|K|
a2
i H 2
i
e−2N ≈e−2N .
(8.8)
Therefore, today we have that:
|K0| = |K|
H 2
0
=
|K|
a2
I H 2
I
aI HI
H0
2
≈e−2N
aI HI
H0
2
.
(8.9)
In order to have |K0| < 1, we need
aI HI
H0
< eN
(8.10)
In order to estimate the ratio on the left hand side, let us suppose that inﬂation ends
into the radiation-dominated epoch, so that:
H 2
I ≈H 2
0 r0/a4
I ,
(8.11)
and thus:
aI ≈1/4
r0

H0
HI
.
(8.12)

238
8
Inﬂation
We have then:
eN > 1/4
r0

HI
H0
= 1/4
r0
ρI
ρ0
1/4
=
ρ1/4
I
0.037 h eV ,
(8.13)
where ρI is the energy scale at which inﬂation ends, but since H is constant during
the inﬂationary phase, then ρI is energy density scale of inﬂation tout court.
Certainly we do not want to spoil BBN, therefore ρI must be larger than 1MeV4.
With this constraint we get N > 17. Choosing the Planck scale, one gets N > 68
and choosing the GUT energy scale one gets N > 62.
8.2
The Horizon Problem
The horizon problem is an issue that appears when we calculate the angular size of
the particle horizon at recombination and notice that it is only a small portion of the
CMB sky. Then, how is it possible that the latter is so isotropic if no causal process
could have provided the conditions to be so?
Let us again consider this issue more quantitatively. The proper particle-horizon
distance is the following:
dH = a(t)
 t
0
dt′
a(t′) = a
 a
0
da′
H(a′)a
′2 .
(8.14)
In an universe dominated by matter and radiation the above expression becomes:
dH = a
 a
0
da′
H0
√m0a′ + r0
=
2a
H0m0

m0a + r0 −

r0
	
.
(8.15)
Now, recall that the angular diameter distance has the following form:
dA = a(t)
 t0
t
dt′
a(t′) = a
 1
a
da′
H(a′)a
′2 .
(8.16)
Again, in an universe dominated by matter and radiation the above expression
becomes:
dA = a
 1
a
da′
H0
√m0a′ + r0
=
2a
H0m0

m0 + r0 −

m0a + r0
	
.
(8.17)
The ratio dH/dA represents the angular radius of the particle horizon at a given scale
factor. From the above calculations we obtain:
dH
dA
=
√m0a + r0 −√r0
√m0 + r0 −√m0a + r0
.
(8.18)

8.2 The Horizon Problem
239
This ratio tends to zero for a →0 and at recombination it is equal to:
dH
dA
(arec = 10−3) = 0.018 ,
(8.19)
which corresponds to about 1◦in the CMB sky. Therefore, we have roughly
4π/(0.018)2 ≈104 causally disconnected regions in the sky.
Another way to see this problem is to compare dH with the radius of the universe,
say R, which is proportional to the scale factor a, and calculating thus the number
of causally disconnected regions, i.e.:
N 1/3
cdr ≡R
dH
=
m0H0Ri
2ai

√m0a + r0 −√r0
 ,
(8.20)
where Ri is some initial radius of the universe corresponding to an initial scale factor
ai.
Exercise 8.3 Typically one assumes that Ncdr ∼1090 at the Planck scale, i.e. of the
order or larger than the observed number of particles in the universe. See e.g. Linde
(2017) for a recent discussion on the issue of the initial conditions of the universe.
Given Ncdr ∼1090 at a = 10−32 determine then H0Ri/ai in Eq.(8.20) and deduce
the value of Ncdr at recombination. Show that, again, Ncdr ≈104.
So, the particle horizon at recombination is a very small fraction of the CMB sky.
If no causal process could have taken place beyond 1 degree then what did cause the
high isotropy of the CMB temperature?
This issue can be solved in pretty much the same way as we did for the ﬂatness
problem. Assume an initial inﬂationary phase such that:
a(t) = aieHI (t−ti) = aIe−HI (tI −t) .
(8.21)
Then, the proper particle-horizon distance that we have calculated in Eq.(8.15)
acquires the following contribution for very small times:
dH ≈a
 tI
ti
dt eHI (tI −t)
aI
,
(8.22)
which we actually put equal to the same dH because we know that it has to dominate
it in order to solve the horizon problem. Therefore:
dH ≈a
 tI
ti
dt eHI (tI −t)
aI
=
a
aI HI
(eN −1) .
(8.23)
Since dA ≈a/H0 for small scale factors, we can conclude that:

240
8
Inﬂation
dH
dA
≈
H0
aI HI
eN ,
(8.24)
and so, in order to have dH > dA, we obtain the condition:
aI HI
H0
< eN
(8.25)
which is the same as in Eq.(8.10). The same solution for two different problems
seems to be a good sign and a good point in favour of inﬂation.
Usually a third problem concerning standard cosmology goes along with the above
two and it is the one related to the abundance of unwanted relics, such as magnetic
monopoles, which are produced via some symmetry breaking mechanism in the
very early universe and are not observed today. We do not treat this issue here, see
Weinberg (2013) for more details, but it is clear that inﬂation provides a mechanism
for diluting these unwanted relics beyond the possibility of observation.
We now discuss how inﬂation can be realised.
8.3
Single Scalar Field Slow-Roll Inﬂation
We present here the possibility of implementing inﬂation via a single canonical scalar
ﬁeld ϕ, called inﬂaton, which is subject to some potential V (ϕ) with the property
that the scalar ﬁeld initially rolls slowly down it attaining its minimum after the end
of inﬂation. This kind of behaviour is called slow-roll inﬂation and it proves to be
very successful. We now see in some detail how the inﬂationary phase occurs.
The Lagrangian of a canonical scalar ﬁeld is:
L = 1
2gμν∂μϕ∂νϕ + V (ϕ) ,
(8.26)
where the plus sign might be deceiving (we are used in Lagrangian mechanics to a
difference between the kinetic term and the potential one) if we do not recall that the
signature in use is (−, +, +, +).
The energy-momentum tensor of a canonical scalar ﬁeld has the following form:
T α
β = gαν∂νϕ∂βϕ −δα
β
1
2gμν∂μϕ∂νϕ + V (ϕ)

,
(8.27)
where V (ϕ) is some potential. In the background FLRW metric ds2 = −dt2 +
a(t)2δi jdxidx j, the scalar ﬁeld has to depend only on t, and thus the energy density
and pressure are:

8.3 Single Scalar Field Slow-Roll Inﬂation
241
ρϕ = −T 0
0 = 1
2 ˙ϕ2 + V (ϕ) ,
Pϕ = 1
3δi
jT j
i = 1
2 ˙ϕ2 −V (ϕ) .
(8.28)
Exercise 8.4 Derive the Klein–Gordon equation for ϕ using the continuity equation.
Show that:
¨ϕ + 3H ˙ϕ + V,ϕ = 0 ,
(8.29)
where V,ϕ ≡dV/dϕ. Show that in the conformal time
ϕ′′ + 2Hϕ′ + a2V,ϕ = 0 .
(8.30)
Now, Friedmann and the acceleration equations for this scalar ﬁeld as the unique
content of the universe are written as:
H 2 = 8πG
3
1
2 ˙ϕ2 + V (ϕ)

,
¨a
a = −8πG
3

˙ϕ2 −V (ϕ)

.
(8.31)
Exercise 8.5 Show that the acceleration equation can be written in the following
form:
˙H = −4πG ˙ϕ2 .
(8.32)
In order to have an accelerated phase of expansion we need that H varies slowly,
i.e. ˙H ∼0, but how much slowly? Since the only time scale present in the problem
is 1/H itself, we need that
| ˙H|
H 2 ≪1 ,
(8.33)
because this is the only dimensionless combination possible with ˙H. It means that,
during an expansion time 1/H, the relative variation of H is much less than unity.
Using Friedmann equation and the expression for ˙H we can write the above condition
as:
˙ϕ2 ≪V (ϕ)
(8.34)
which is our ﬁrst slow-roll condition. When the kinetic term of the scalar ﬁeld is
negligible with respect to the potential one, one has from Eq.(8.28):
Pϕ ≈−ρϕ ≈−V (ϕ) ≈constant .
(8.35)
That is, the scalar ﬁeld potential, when it dominates over the kinetic term, behaves
as a cosmological constant.

242
8
Inﬂation
Note that condition (8.34) does not really demand the potential V (ϕ) to be ﬂat,
as for example the Coleman–Weinberg (Erick, not Steven) potential (Coleman and
Weinberg 1973) used in the “new” inﬂationary scenario (Albrecht and Steinhardt
1982). What counts is the kinetic term to be very small compared with the potential
one and this can be achieved even for V (ϕ) ∝ϕ2 or ϕ4 potentials. We shall see this
in more detail later.
The condition given in Eq.(8.33) is usually reformulated in term of a parameter
ϵ, called slow-roll parameter and deﬁned as the ratio in Eq.(8.33), i.e.
ϵ ≡−
˙H
H 2 = d
dt
 1
H

(8.36)
and it is the derivative of the Hubble radius. For an exactly exponential expansion H
is constant (de Sitter space), and thus ϵ = 0. The slow-roll condition is thus realised
by demanding that |ϵ| ≪1. During the radiation-dominated epoch, a ∝√t and thus
1/H = 2t and ϵ = 2.
Exercise 8.6 The minimal requirement for inﬂation is that it must produce an accel-
eration, i.e. ¨a > 0. For the limiting case in which we have ¨a = 0, show that ϵ = 1.
In Fig.8.1 the dashed lines represents generic physical scales λphys ∝a/k growing
proportionally to the scale factor and exiting the Hubble radius during inﬂation, since
1/H stays almost constant (it is really constant in the ﬁgure), and re-entering after
inﬂation ends, during the radiation-dominated epoch. Of course, the last scale to
exit is also the ﬁrst one to re-enter, whereas the observable scale which ﬁrst exits the
horizon, is the one which re-enters the horizon today. According to the normalisation
used in Fig.8.1, this scale is a and exited the horizon when:
aexit = H0
HI
.
(8.37)
Using Eq.(8.13), we can thus write down the maximum number of e-folds to which
we could have access observationally as:
Nmax = ln
 aI
aexit

= ln
aI HI
H0

= ln

ρ1/4
I
0.037 h eV

.
(8.38)
For the energy scale of GUT, i.e. 1016 GeV, one gets Nmax ≈61. Note that this is not
the duration of inﬂation. It can last much longer, e.g. N ≈145 as computed in Bolliet
et al. (2017), but we can observationally probe only the last 61 e-folds (depending
on the energy scale of inﬂation).
We shall see later that when a perturbative scale crosses the Hubble horizon during
inﬂation, it gets a speciﬁc value which remains constant during it super-horizon

8.3 Single Scalar Field Slow-Roll Inﬂation
243
Fig. 8.1 The solid line represents the evolution of the Hubble radius 1/H, normalised to the present
one 1/H0 for the CDM model. The dashed lines represents different scales, which grow as a,
exiting the Hubble radius and then re-entering again during the radiation-dominated epoch. The
dotted line represents the Planck scale. We have chosen inﬂation to end at a = 10−29, corresponding
to the GUT scale 1016 GeV
evolution and then serves as initial condition when re-entering the horizon during
the radiation-dominated epoch.
In Fig.8.1 there is also a horizontal dotted line. This represents the Planck scale.
Note that scales which re-enter the horizon after the end of inﬂation, and are thus
observable by us for example in the CMB, were smaller than the Planck scale. Since
we do not know how gravitation behaves on such smaller scales, the above is known
as Trans-Planckian problem. See e.g. Brandenberger and Martin (2013) for a recent
review on the subject.
8.3.1
More Slow-Roll Parameters
It is not only important that the inﬂaton slow-rolls, but also that it does so for a
sufﬁciently long time in order to provide at least N = 60 e-folds. In order to make
this claim more quantitative, let us investigate how ϵ varies by computing its time-
derivative. Using the deﬁnition (8.36) we get:
˙ϵ = 2 ˙H 2
H 3 −
¨H
H 2 ,
(8.39)

244
8
Inﬂation
and from Eq.(8.32) we get:
˙ϵ = 2Hϵ2 + 8πG ˙ϕ
H 2
¨ϕ = 2Hϵ2 −2
˙H ¨ϕ
H 2 ˙ϕ = 2Hϵ2 + 2ϵ ¨ϕ
˙ϕ .
(8.40)
Let us write this expression as:
˙ϵ = 2Hϵ(ϵ −η) ,
(8.41)
where
η ≡−1
H
¨ϕ
˙ϕ
(8.42)
is our second slow-roll parameter, not to be confused with the conformal time. The
smallness of η then guarantees that ϵ varies slowly. Indeed, η ≪1 gives us, from the
KG equation (8.29) the condition
3H ˙ϕ ≈−V,ϕ
(8.43)
Considering ϵ, η ≪1 as ﬁrst-order quantities, the time-derivative ˙ϵ is thus a second-
order quantity, cf. Eq.(8.41).
Nothing prevents us from considering now the time-derivative of η and then to
deﬁne a third slow-roll parameter α, of which we could consider again the time-
derivative, deﬁning a fourth slow-roll parameter β and so on, constructing a hierarchy
of slow-roll parameters. This was done in Liddle et al. (1994), but we limit ourselves
here to ϵ and η, upon which the predictions on the scalar and tensor spectral indices
depend, as we shall see. It must be stressed, on the other hand, that future observation
might be able to constrain with great precision the runnings of the spectral indices,
which depend on the higher-order slow-roll parameters, see Muñoz et al. (2017).
Since it is the scalar ﬁeld that triggers the inﬂationary phase, it is useful to express
ϵ and η in terms of quantities related to the scalar ﬁeld itself, i.e. the potential V (ϕ)
and its derivatives. This can be done as follows. Combining the deﬁnition of ϵ in
Eq.(8.36) with Friedmann equation and Eq.(8.32), one gets:
ϵ =
3 ˙ϕ2
2V + ˙ϕ2 = 3 ˙ϕ2
2V + O
 ˙ϕ2
2V
2
,
(8.44)
where we are implementing the slow-roll condition (8.34). Using now Eq.(8.43), we
ﬁnd:
ϵ ≈
1
16πG
V,ϕ
V
2
≡ϵV
(8.45)

8.3 Single Scalar Field Slow-Roll Inﬂation
245
at the lowest order in ˙ϕ2/2V . In this equation we have deﬁned ϵV as a quantity
describing the steepness of the inﬂaton potential.
Since η depends on the second time derivative of the scalar ﬁeld, we expect it
to depend on the second derivative of the potential, i.e. V,ϕϕ, in the slow-roll limit.
Using Eq.(8.43) and the above deﬁnition (8.42), we can write:
η ≈V,ϕϕ + 3 ˙H
3H 2
.
(8.46)
Now, recalling the deﬁnition of ϵ and that, at the lowest order in the slow-roll approx-
imation, 3H 2 ≈8πGV , we can conclude that:
η + ϵ ≈
1
8πG
V,ϕϕ
V
≡ηV
(8.47)
It exists thus a hierarchy of slow-roll parameters based on the derivative of the Hubble
factor and another one based on those of the potential. They of course can be put in
relation, as we did above for the ﬁrst two slow-roll parameters.
So, in order to have ϵV , ηV ≪1 and thus trigger inﬂation not necessarily V has
to be constant but rather its ﬁrst and second derivatives must be much smaller than
the value of V itself.
We can relate the number of e-folds to the slow-roll parameter ϵ as follows.
Recalling that the number of e-folds is N = ln a, we can immediately write that:
˙N = H
⇒
N12 =
 t2
t1
Hdt ,
(8.48)
where t1 < t2 are two generic instants during the inﬂationary phase. Changing vari-
able in favor of the inﬂaton ﬁeld, we can write:
N12 =
 ϕ2
ϕ1
H
˙ϕ dϕ ,
(8.49)
where ϕ1 ≡ϕ(t1) and ϕ2 ≡ϕ(t2). Using the slow-roll conditions presented earlier
one has:
N12 = 8πG
 ϕ1
ϕ2
V
Vϕ
dϕ .
(8.50)
Since V/Vϕ is almost constant and very large during inﬂation (its square is propor-
tional to 1/ϵ), we can pull it out of the integral and approximate the above equation
as:
N12 ≈8πGV
Vϕ
(ϕ1 −ϕ2) = V
Vϕ
ϕ1 −ϕ2
M2
Pl
,
(8.51)

246
8
Inﬂation
where we have introduced the Planck mass MPl instead of 1/
√
8πG. In order to
produce a large N it might be possible that |ϕ1 −ϕ2| > MPl, but this not necessarily
leads to a trans-Planckian problem because the energy scale of inﬂation is V (ϕ), not
the ﬁeld itself, and so it is the potential which has to be smaller than the Planck scale
in order for a classical treatment to be valid. This can be achieved, for example, if
there is a sufﬁciently small coupling constant.
Using Eq.(8.45), we can write in general that:
N =
1
√
2ϵ
ϕ
MPl
.
(8.52)
Suppose that ϕ1 and ϕ2 are the value of the inﬂaton ﬁeld for which the wavenumbers
corresponding to the CMB multipole ℓ= 1 and ℓ= 100 exit the horizon. Since, as
we are going to see in Chap.10, ℓ∝k, then:
N = ln 100 = 4.6 .
(8.53)
The above formula then gives a bound between the variation of the inﬂaton ﬁeld and
ϵ, based on the observable scales of the CMB. Such bound is known as Lyth bound
(Lyth 1997). See also Di Marco (2017) for a recent perspective on the Lyth bound.
8.3.2
Reheating
When ϵV and ηV cease to be very small and attain values of order unity, inﬂation
ends. Close to the minimum say ϕ0 the inﬂaton potential can be expanded in the
following way:
V (ϕ) = V0 + 1
2 V,ϕϕ

ϕ=ϕ0 (ϕ −ϕ0)2 + · · · ≈1
2m2
ϕ(ϕ −ϕ0)2 ,
(8.54)
where V0 ≡V (ϕ0) is the minimum of the potential which we assume to be very small,
in fact negligible, in order not to generate an important vacuum energy contribution
(which dominates only at late times). We have also introduced the inﬂaton mass as
it is customary, i.e. as the second derivative of the potential evaluated at ϕ0.
The above approximated potential is the one of a harmonic oscillator with proper
frequency mϕ and so we expect the inﬂaton to perform oscillations about the min-
imum, damped by the Hubble ﬂow H but not only. Since inﬂation needs to end
and there the radiation-dominated epoch must start, we need to couple the inﬂaton
to other matter ﬁelds in order for the inﬂaton to lose energy in favour of the latter.
Phenomenologically, one can write:
˙ρϕ + 3Hρϕ(1 + wϕ) = −ρϕ ,
(8.55)
˙ρM + 3HρM(1 + wM) = ρϕ ,
(8.56)

8.3 Single Scalar Field Slow-Roll Inﬂation
247
where  is some scattering rate governing the decay of the inﬂaton and with M
we refer to matter in general which has to be relativistic in order to give rise to a
radiation-dominated epoch and thus wM ≈1/3.
Therefore, the inﬂaton oscillations are also damped by the presence of . This ﬁnal
phase of inﬂation, transiting to the radiation-dominated epoch is called reheating.
Exercise 8.7 Assuming wϕ constant, show that:
ρϕ(t) = ρϕ(tI)
a(tI)
a(t)
3(1+wϕ)
exp

−
 t
tI
dt′(t′)

,
(8.57)
where tI is the time at which inﬂation ends.
With this formal solution, we can ﬁnd another formal one for the matter part.
Exercise 8.8 Assuming wM = 1/3, show that:
ρM(t) = ρϕ(tI)a(tI)3(1+wϕ)
a(t)4
 t
tI
dt′(t′)a(t′)1−3wϕ exp

−
 t′
tI
dt′′(t′′)

.
(8.58)
From the above equation one sees that the energy density of the matter ﬁelds is
zero at the end of inﬂation, then it rises more or less abruptly (depending on ) and
then ﬁnally decreases again as 1/a4 after the inﬂation has given up all its energy.
Now, assume  to be constant and wϕ = 0, for simplicity. We get for the matter
density:
ρM(t) = ρϕ(tI)a(tI)3
a(t)4
 t
tI
dt′a(t′) exp

−(t′ −tI)

.
(8.59)
Integrating once by parts and considering the limit (t −tI) ≫1, i.e. a very large
decay rate, we get:
ρM(t) = ρϕ(tI)a(tI)4
a(t)4
,
(8.60)
i.e. the decay takes place so rapidly that all the energy of the inﬂaton is passed to the
matter.
If, on the other hand, (t −tI) ≪1, i.e. a very small decay rate, we can approx-
imate the matter density as:
ρM(t) ≈ρϕ(tI)a(tI)3
a(t)4
 t
tI
dt′a(t′) ,
(8.61)

248
8
Inﬂation
and since  is so small, the inﬂaton is still dominating the dynamics giving thus for
the scale factor
a(t) = a(tI)(t/tI)2/3 ,
(8.62)
because we have chosen wϕ = 0. Integrating, we have thus:
ρM(t) ≈3
5
ρϕ(tI)tI
(t/tI)8/3

(t/tI)5/3 −1

,
(8.63)
and the maximum is attained at tmax/tI = (8/3)3/5 and its value is:
ρM,max(t) ≈0.139

H(tI)ρϕ(tI) .
(8.64)
Hence, in this case the energy density of matter is much smaller than that of the
inﬂaton. Most of the latter is still spent driving the expansion of the universe instead
of generating matter, because of the small .
We have seen how to produce an inﬂationary phase and how to quantify it, through
the slow-roll parameters. Now we are going to see what inﬂation has to say about
quantum ﬂuctuations. We hypothesise that before inﬂation the universe was quantum
and quantum ﬂuctuations were turned into classical ones by inﬂation itself, though
we do not address the details of the quantum-to-classical transition of the primordial
ﬂuctuations. About the latter topic, see e.g. Kiefer and Polarski (2009).
8.4
Production of Gravitational Waves During Inﬂation
We are going to quantize the equation that we found for the evolution of gravitational
waves, i.e. from Eq.(4.191):
hT ′′
i j + 2HhT ′
i j −∇2hT
i j = 0 ,
(8.65)
where recall that hT
i j is traceless and transverse, i.e.
hT
ii = 0 ,
∂jhT
i j = 0 ,
(8.66)
and no source term πT
i j appears in the GW equation since this is vanishing for a
scalar ﬁeld. This can be understood intuitively, since the inﬂaton ϕ is a scalar and
thus unable of producing a tensor perturbation. Mathematically, just look Eq.(8.117)
and realise that no anisotropic stresses appear in the δT i j of a scalar ﬁeld, since this
is diagonal.

8.4 Production of Gravitational Waves During Inﬂation
249
The above Eq.(8.65) has no source term, is gauge-invariant and paves the way
for a similar treatment that we shall do for scalar perturbations. For this reason we
tackle the tensor ones ﬁrst.
The Fourier transform of the above equation is Eq.(4.197), which we write here
in the following compact form:
h′′ + 2Hh′ + k2h = 0 ,
(8.67)
where h(η, k) represents either h+,× or h(λ = ±2). Since the above equation only
contains the modulus k, only the initial condition on h shall have a dependence on
k, cf. Eq.(7.101).
It shall be useful to cast Eq.(8.67) in the form of a harmonic oscillator one with
no damping term by deﬁning:
g ≡
ah
√
32πG
= MPl
2 ah
(8.68)
The normalisation comes in order to give g dimensions of a mass. Indeed, h is
dimensionless and
√
8πG = 1/MPl. This is necessary in order to give the correct
dimensionality, a cube length or inverse cube mass, to the power spectrum.
A very direct way to see that
√
32πG is the correct normalisation is e.g. to look
to Mukhanov’s calculations in Mukhanov et al. (1992). He ﬁnds the action which
gives Eq.(8.65) by perturbing up to the second order a f (R) action about a generic
FLRW background. In the Einstein-Hilbert case f (R) = R and for a spatially ﬂat
FLRW background one has:
δ2S =
1
64πG

a2 
hTi′
khTk′
i −∂lhTi
k∂lhTk
i
	
d4x .
(8.69)
In Mukhanov et al. (1992) the corresponding second order action for the scalar ﬁeld
is also found and the factor outside the integral is 1/2. Hence, in order to properly
compare tensor and scalar ﬂuctuations we must rescale the former as:
hTi
j →
hTi j
√
32πG
.
(8.70)
Exercise 8.9 Use Eq.(8.68) into Eq.(8.67) in order to ﬁnd:
g′′ +

k2 −a′′
a

g = 0
(8.71)

250
8
Inﬂation
The GW wave can be written as:
hT
i j(η, x) =

λ=±2

d3k
(2π)3

h(η, k)eik·xa(k, λ)ei j(ˆk, λ)
h∗(η, k)e−ik·xa∗(k, λ)e∗
i j(ˆk, λ)

,
(8.72)
where the sum is over the helicity of the GW and ei j(ˆk, λ) is the polarisation tensor
deﬁned in Sect.4.6. We have put the initial dependence on k of the GW in a(k, λ)
and its complex conjugate, which is introduced in order to guarantee that hT
i j(η, x)
is real.
Now, we assume the initial state of the GW ﬁeld to be a quantum one on very small
scales k ≫aH. Thus, we promote hT
i j and a to operators and impose the canonical
commutation relations:

a(k, λ), a(k′, λ′)

= 0 ,

a(k, λ), a†(k′, λ′)

= (2π)3δ(3)(k −k′)δλλ′ ,
(8.73)
which tell us that a†(k, λ) creates a graviton of momentum-energy k and helicity λ,
whereas a(k, λ) destroys it.
The quantum state of the universe during inﬂation is the vacuum |0⟩, which by
deﬁnition is annihilated by a(k, λ). The expectation value on the vacuum:
⟨0|hT
i j(η, x)hT
lm(η, x′)|0⟩,
(8.74)
is what shall deﬁne our primordial spectrum. Two comments are in order here. First of
all, we could choose another quantum state for the universe which is not necessarily
the vacuum one. Second, the above is a vacuum expectation value which we expect to
become an ensemble average over classical random ﬁelds well outside the horizon.
Exercise 8.10 Compute the vacuum expectation value in Eq.(8.74) using the plane-
wave expansion (8.72) and the commutation relations (8.73). Show that:
⟨0|hT
i j(η, x)hT
lm(η, x′)|0⟩=

d3k
(2π)3 |h(η, k)|2eik·(x−x′)i j,lm(ˆk) ,
(8.75)
where
i j,lm(ˆk) ≡

λ=±2
ei j(ˆk, λ)e∗
lm(ˆk, λ) ,
(8.76)
is the sum over the helicities, deﬁned in Eq.(7.10.3).
Comparing the result found in the exercise with Eq.(7.42) it is quite straightfor-
ward to see that the tensor quantum perturbations are Gaussian with power spectrum:

8.4 Production of Gravitational Waves During Inﬂation
251
Ph(η, k) ∝|h(η, k)|2 ,
(8.77)
henceweneedtosolveEq.(8.67),orratherEq.(8.71),inordertodetermine|h(η, k)|2.
Inspect Eq.(8.71). There are two regimes of interest. The ﬁrst is for very short
wavelength, i.e. k2 ≫a′′/a, for which the equation becomes:
g′′ + k2g = 0 ,
(k2 ≫a′′/a) ,
(8.78)
which is the usual harmonic oscillator equation. This means that the details of the
inﬂationary evolution, encoded in a(η), are not important on very small scales. This
was not unexpected since on very small scales the expansion of the universe is
irrelevant. Moreover, from the QFT point of view, we can then look at the quantisation
as that of a free ﬁeld in Minkowski space and thus determine:
g(η, k) =
1
√
2k
e−ikη ,
g∗(η, k) =
1
√
2k
eikη ,
(k2 ≫a′′/a) ,
(8.79)
wherethenormalisation1/
√
2k comesfromthequantisationprocedureinMinkowski
space. We can take this solution as the “initial condition” in solving Eq.(8.71) there-
fore addressing only those modes which satisfy the condition k2 ≫a′′/a during the
inﬂationary epoch.
The second regime of evolution is given by the condition k2 ≪|a′′/a|, i.e. for
very long wavelength, for which Eq.(8.71) becomes:
g′′ −a′′
a g = 0 ,
(k2 ≪|a′′/a|) .
(8.80)
This equation has the following formal solution:
g(η, k) = C1(k)a + C2(k)a
 η
d ¯η
a( ¯η)2 ,
(k2 ≪|a′′/a|) ,
(8.81)
which contains the solution
g
a =
h
√
32πG
= constant ,
(8.82)
representing thus the constant value that h reaches outside the horizon and that
will eventually become the initial condition at the re-entering, during the radiation-
dominated epoch.
Let us try to be more quantitative.
Exercise 8.11 Assume that during inﬂation H = a′/a2 is a constant say H, i.e.
consider a de Sitter space. Show that:

252
8
Inﬂation
a(η) = −
1
Hη .
(8.83)
Since the scale factor and H are positive, then η is negative during inﬂation.
With the solution of Eq.(8.83), which we could take valid also in the case of
slowly varying H, show that the condition used in Eq.(8.80) can be written as:
k2 ≪|a′′/a| = 2H 2
a2 .
(8.84)
This is a condition for the physical wavenumber k/a to be much smaller than the
Hubble factor, i.e. it is a condition for super-Hubble scales. In general |a′′/a| ∝1/η2,
for dimensional reasons, hence the condition in Eq.(8.80) can also be understood as:
kη ≪1 ,
(8.85)
which means super-horizon scales, since η is the comoving particle horizon.
In this approximation then Eq.(8.71) becomes:
g′′ +

k2 −2
η2

g = 0 .
(8.86)
Exercise 8.12 Show that the solution of Eq.(8.86) can be written as:
g(η, k) = C1(k)
η
[kη cos(kη) −sin(kη)] + C2
η [kη sin(kη) + cos(kη)] .
(8.87)
Now, let us select the exp(−ikη) mode. Show that in this case the solution becomes:
g(η, k) = C1(k)ke−ikη

1 −i
kη

.
(8.88)
Now suppose an initial condition in η = ηi, such that:
k2 ≫a′′
a = 2
η2
i
,
⇒
k|ηi| ≫1 ,
(8.89)
so that we can do the matching with Eq.(8.79) and obtain:
C1(k)ke−ikηi =
1
√
2k
e−ikηi ,
⇒
C1(k)k =
1
√
2k
,
(k|ηi| ≫1) .
(8.90)
and so we can write:

8.4 Production of Gravitational Waves During Inﬂation
253
g(η, k) = e−ikη
√
2k

1 −i
kη

,
(k|ηi| ≫1) .
(8.91)
Using now Eq.(8.68), we get for the power spectrum:
Ph(η, k) = 32πG
a(η)2 Pg(η, k) = 16πG
a(η)2k

1 +
1
k2η2

= 16πG
k
H 2
η2

1 +
1
k2η2

,
(8.92)
and the dimensionless one, according to the deﬁnition of Eq.(7.45), is:
2
h(η, k) = k3Ph(η, k)
2π2
= 8πG
π2 H 2


1 + (k2η2)

=
H 2

π2M2
Pl

1 + (k2η2)

, (8.93)
and recall that this result is valid only for those scales for which k|ηi| ≫1.
This spectrum depends on time, so which η should we choose? We have seen,
through the discussion culminating in Eq.(8.84), that when a scale k exits the horizon,
its corresponding h(η, k) becomes constant. Its value will be the initial condition dur-
ing the radiation-dominated epoch, when the scale re-enters the horizon. Therefore,
for kη →0 we have:
2
h(η, k) =
H 2

π2M2
Pl
,
(8.94)
which does not depend on the scale k anymore, i.e. it is a scale-invariant power
spectrum. The only caveat is that this spectrum is valid only for those scales for
which k|ηi| ≫1, i.e. scales which exit the horizon:
a2
exitH 2
η2
i ≫1 ,
⇒
η2
i ≫η2
exit ,
(8.95)
well after ηi. Recall that η is negative during inﬂation, so the above condition makes
sense.
Note that for a constant H the slow-roll parameter ϵ is vanishing. In order to
describe the inﬂationary phase more realistically, we should consider a small but
non-vanishing ϵ. In this case H varies and a k-dependence is gained by the power
spectrum.
Let us write the deﬁnition of ϵ in Eq.(8.36), but using the conformal time:
ϵ =
 a
H
	′ 1
a = 1 −H′
H2 .
(8.96)
Exercise 8.13 Solve the above differential equation for H assuming a constant ϵ.
Show that:
H = −
1
(1 −ϵ)η .
(8.97)

254
8
Inﬂation
From this solution, it is not difﬁcult to show that:
a′′
a = H′ + H2 =
1
(1 −ϵ)η2 +
1
(1 −ϵ)2η2 ≈2 + 3ϵ
η2
,
(8.98)
where in the last approximation we have considered ϵ ≪1, as it should be during
inﬂation, and kept ϵ to ﬁrst order.
Substituting into Eq.(8.71), we get then:
g′′ +

k2 −2 + 3ϵ
η2

g = 0 ,
(8.99)
which can be solved exactly, giving as general solution a combination of Hankel
functions:
g(η, k) = C1(k)√−ηH (1)
ν (−kη) + C2(k)√−ηH (2)
ν (−kη) ,
ν =
√
3
2
√
3 + 4ϵ ,
(8.100)
wheretheminussignmustbeintroducedinordertoaccountforthefactthatη < 0.We
have chosen to express the solution in terms of the Hankel functions since it is easier
to see which one of them matches the initial condition of Eq.(8.79). Indeed, consider
the asymptotic expansion, cf. Abramowitz and Stegun (1972), of H (1)
ν (−kη):
H (1)
ν (−kη) ∼

2
−πkη e−ikη−iνπ/2−iπ/4 ,
(k|η| ≫1) .
(8.101)
Hence, this is the right behavior at very small scales for g and the integration constant
must be:
C1(k) =
√π
2 eiνπ/2+iπ/4 ,
(8.102)
i.e. indeed a (complex) constant, since it bears no dependence from k. The solution
we look for is then:
g(η, k) =
√π
2 eiνπ/2+iπ/4√−ηH (1)
ν (−kη) ,
ν =
√
3
2
√
3 + 4ϵ ,
(8.103)
and the power spectrum is thus:
Ph(η, k) =
4
M2
Pla(η)2 |g(η, k)|2 =
π|η|
M2
Pla(η)2 |H (1)
ν (−kη)|2 .
(8.104)
For kη →0, i.e. on very large scales, one has that
H (1)
ν (−kη) ∼−i (ν)
π
k|η|
2
−ν
,
(k|η| →0) ,
(8.105)

8.4 Production of Gravitational Waves During Inﬂation
255
and hence the dimensionless power spectrum becomes:
2
h(η, k) = k3|η|(ν)2
2π3M2
Pla2
k|η|
2
−2ν
,
(k|η| →0) .
(8.106)
Considering ϵ at ﬁrst order in the exponent of k|η| and negligible elsewhere, we can
write:
2
h(η, k) = k3|η|(ν)2
2π3M2
Pla2
k|η|
2
−3−2ϵ
=
1
π2M2
Pla2|η|2 (k|η|)−2ϵ .
(8.107)
Now, the power spectrum is no more scale-invariant but gained a small k-dependence:
a power law with exponent −2ϵ. The latter is usually named as tensor spectral index
and denoted as nT . We shall see a little more detail about it later.
On large scales, h is time-independent and so its power spectrum is. Hence, we
can choose any convenient value of η when to evaluate 2
h. It is customary to use
the time ηk at which a given scale k crosses the horizon, i.e.
k = H(ηk) ,
(8.108)
because the details of the k-dependence of the power spectrum depend on the inﬂa-
tionary model but, as we saw in Eqs.(8.78) and (8.80), they manifest themselves
only at horizon-crossing.
Using Eq.(8.97), the horizon crossing condition gives the following relation
between |η| and k:
k = H(ηk) =
1
(1 −ϵ)|ηk| ,
(8.109)
which at ﬁst order in ϵ gives:
k|ηk| = 1 + ϵ .
(8.110)
UsingagainEq.(8.97),wecanwritethepowerspectrumevaluatedathorizoncrossing
as:
2
h(k) =
1
π2M2
Pl
H(ηk)2
a2(ηk) ,
(8.111)
which is usually put as:
2
h(k) =
H 2
π2M2
Pl

k=aH
,
(8.112)
i.e. it has the same form as the one in the de Sitter case, computed in Eq.(8.94), but
allows for a time-dependent Hubble factor.
It is very interesting to notice that if we could directly measure the gravitational
waves background, we would be able to determine the energy scale of inﬂation,
i.e. H.

256
8
Inﬂation
8.5
Production of Scalar Perturbations During Inﬂation
Consider our FLRW metric perturbed with scalar perturbations only and written in
the conformal Newtonian gauge, i.e.
ds2 = a(η)2 
−(1 + 2) dη2 + (1 + 2	) δi jdxidx j
.
(8.113)
Accordingly, consider also perturbations of our inﬂaton ﬁeld:
ϕ = ¯ϕ(η) + δϕ(η, x)
(8.114)
Exercise 8.14 Using Eqs.(8.27) and (8.114), write down the perturbed energy-
momentum tensor. Show that:
T 0
0 = −1
2a2 ¯ϕ
′2 −V (ϕ) −1
a2 ¯ϕ′δϕ′ + 1
a2  ¯ϕ
′2 −V,ϕδϕ , (8.115)
T 0
i = −1
a2 ¯ϕ′∂iδϕ , (8.116)
T i
j = δi
j
 1
2a2 ¯ϕ
′2 −V (ϕ)

+ δi
j
 1
a2 ¯ϕ′δϕ′ −1
a2  ¯ϕ
′2 −V,ϕδϕ

.(8.117)
The perturbed contribution in the above expressions is grouped to the right. Note
the following important fact: T i j is diagonal and thus no anisotropic stresses can
be sourced by a single scalar ﬁeld. We already know from Eq.(4.184) that this fact
implies  = −	.
Exercise 8.15 Obtain the perturbed Klein–Gordon equation. Start from:
∇μT μ
ν = 0 ,
(8.118)
and then put ν = 0. Show that:
δϕ′′ + 2Hδϕ′ +

k2 + V,ϕϕa2
δϕ = 2	V,ϕa2 −4	′ ¯ϕ′
(8.119)
where we have already used the conformal time and  = −	. Compare this equation
with the corresponding one found by Mukhanov and co-authors in Mukhanov et al.
(1992). It is also useful to consider that found in Weinberg (2008) and recover the
above one by transforming from the cosmic time to the conformal one.
Unfortunately, the contributions V,ϕϕa2, 2	V,ϕa2 and 4	′ ¯ϕ′ make life more dif-
ﬁcult. Indeed, if they were absent, we would get the following equation:

8.5 Production of Scalar Perturbations During Inﬂation
257
δϕ′′ + 2Hδϕ′ + k2δϕ = 0 ,
(8.120)
which is formally identical to Eq.(8.67), and therefore all the calculations performed
for the GW case would follow in the same fashion.
Even if we could neglect V,ϕϕ in Eq.(8.119) during the slow-roll phase, there
would be no a priori reason to neglect the whole right hand side of Eq.(8.119).
Moreover, we do not really want to follow the evolution of δϕ, for at least two
reasons. First, the inﬂaton supposedly decays into ordinary matter during reheating,
and we do not want to address this problem. Second, as we saw in Eq.(6.94), what we
really need is to know R or ζ on very large scales when radiation starts to dominate.
Let us work with R. It turns out that R is conserved (i.e. is a constant) on large
scales and for adiabatic perturbations. We have already seen this in Chap.6 and we
show this in detail again in Chap.12.
It turns out that, as it happened for h, when inﬂation brings a scale k outside the
horizon, its corresponding R(η, k) attains a constant value which shall serve as initial
condition during the radiation-dominated epoch. There shall be a crucial difference
with respect to the case of GW, which we shall meet shortly.
Exercise 8.16 Express v in Eq.(4.131) in terms of the inﬂaton ﬁeld velocity poten-
tial. From Eq.(4.73) we know that:
T 0(ϕ)
i =

¯ρϕ + ¯Pϕ

v(ϕ)
i
= ¯ϕ′2
a2 v(ϕ)
i
.
(8.121)
Using Eq.(8.116), show that:
v(ϕ)
i
= −∂iδϕ
¯ϕ′
.
(8.122)
Thus, writing
v(ϕ)
i
= ∂iv(ϕ) ,
(8.123)
we can identify the velocity potential of the inﬂation ﬁeld (we drop the superscript
ϕ now) as:
v = −δϕ
¯ϕ′ .
(8.124)
Hence, using the result of the exercise, we can write:
R = 	 −H
¯ϕ′ δϕ .
(8.125)
We need to ﬁnd an evolution equation for R. In principle, combining the above
expression with the Klein–Gordon equation (8.119) we can eliminate δϕ. Then, 	
can be dealt with via the use of the Einstein equations, which are:

258
8
Inﬂation
3H(	′ + H	) + k2	 = 4πG

¯ϕ′δϕ′ + 	 ¯ϕ
′2 + V,ϕa2δϕ
	
, (8.126)
	′ + H	 = −4πG ¯ϕ′δϕ , (8.127)
	′′ + 3H	′ + (2H′ + H2)	 = −4πG

¯ϕ′δϕ′ + 	 ¯ϕ
′2 −V,ϕa2δϕ
	
.(8.128)
obtained combining Eq.(4.179) with Eq.(8.115), Eq.(4.185) with Eqs.(8.123) and
(8.124), Eq.(4.189) with Eq.(8.117). All with 	 = −, of course.
Though in principle possible, it is a mountain of calculations which we can at
least limit by choosing a different gauge. In particular, following Weinberg (2008),
let us consider the following gauge:
ds2 = −a2(1 + E)dη2 + 2a2F,idηdxi + a2(1 + A)δi jdxidx j ,
δ ˆϕ = 0 ,
(8.129)
i.e. a gauge in which the perturbed scalar ﬁeld (which we denote with a hat, in the
new gauge) is zero. Thus in this gauge
R = A
2 ,
(8.130)
and so our objective is to ﬁnd a closed equation for A. The price to pay in order to put
the perturbed scalar ﬁeld equal to zero is to introduce one more scalar perturbation
in the metric. Now, let us calculate the energy-momentum tensor in the new gauge.
Exercise 8.17 Using Eqs.(8.27) and (8.129), write down the perturbed energy-
momentum tensor. Show that:
ˆT 0
0 = −1
2a2 (1 −E) ¯ϕ
′2 −V (ϕ) ,
(8.131)
ˆT 0
i = 0 ,
ˆT i
0 = 1
a2 F,i ¯ϕ
′2 ,
(8.132)
ˆT i
j = δi
j
 1
2a2 (1 −E) ¯ϕ
′2 −V (ϕ)

.
(8.133)
The above is a pretty simple energy-momentum tensor and indeed we now are
going to exploit its simplicity. First of all, since δ ˆT 0i = 0, we have from Eq.(4.43)
that:
−HE + A′ = 0 ,
(8.134)
i.e. a simple algebraic relation between two of the three scalar potentials.
The second relation that we are going to us is the continuity equation.

8.5 Production of Scalar Perturbations During Inﬂation
259
Exercise 8.18 Compute the continuity equation ∇νT ν0 = 0 using the energy-
momentum tensor given in Eqs.(8.131)–(8.133). Compute from the metric in
Eq.(8.129) the only necessary Christoffel symbol:
i
0 j = Hδi
j + A′
2 δi
j .
(8.135)
Then show that:
a2
2
 E
a2 (H2 −H′)
′
+ (H2 −H′)

∇2F + 3HE −3
2 A′

= 0 ,
(8.136)
where we have used the relation H2 −H′ = 4πG ¯ϕ
′2.
As last relation, we shall use δRi j computed from the metric in Eq.(8.129). So,
using Eq.(4.34), we have:
δRi j = −1
2 E,i j −H
2 E′δi j −(2H2 + H′)Eδi j −1
2(∇2 Aδi j + A,i j)
+1
2 A′′δi j + 5
2HA′δi j + (2H2 + H′)Aδi j
−H∇2Fδi j −F′
i j −2HF,i j . (8.137)
Through the Einstein equations, we know that:
δRi j = 8πG

δTi j −a2 Aδi j
¯T
2 −a2δi j
δT
2

,
(8.138)
where ¯T and δT are the background and perturbed trace, respectively, of the energy-
momentum tensor.
Exercise 8.19 Calculate the right hand side of the above equation. Show that:
δRi j = 8πGa2 Aδi jV = (2H2 + H′)Aδi j .
(8.139)
Extracting thus only the part of δRi j which is proportional to δi j, we ﬁnally get:
−H
2 E′ −(2H2 + H′)E −1
2∇2 A + 1
2 A′′ + 5
2HA′ −H∇2F = 0 . (8.140)

260
8
Inﬂation
Exercise 8.20 Combine Eqs.(8.134), (8.136) and (8.140), eliminating E and F and
thus ﬁnding the following equation for R:
R′′ + 2
HR′

H2 −H′ + H
2
(H2 −H′)′
H2 −H′

+ k2R = 0 .
(8.141)
Show that this equation can be written in a more compact form as:
R′′ + 2z′
z R′ + k2R = 0
(8.142)
with
z ≡a ¯ϕ′
H .
(8.143)
Equation(8.142) is called Mukhanov-Sasaki equation, cf. Mukhanov (1985)
and Sasaki (1986). Notice that this equation has the very same structure as Eq.(8.67)
if one makes the change a →z. Therefore, a similar analysis applies and a constant
solution for R is allowed when:
k2 ≪|z′′/z| ,
(8.144)
which is a similar, but not identical, condition as k2 ≪|a′′/a|. In fact, note that:
z2 = a2
 ¯ϕ′
H
2
= a2
3 ¯ϕ′2
8πG( ¯ϕ′2/2 + Va2) = a2
ϵ
4πG ,
(8.145)
where we have used Eq.(8.44), written in the conformal time. The above relation
between z and a is exact and it calls into play the slow roll parameter ϵ.
Now, the procedure that we need in order to obtain the power spectrum for R is
the same as the one used for h. We promote R to a quantum ﬁeld and compute its
vacuum expectation value, which will become the power spectrum itself. The vac-
uum expectation value is computed ﬁrst by solving the Mukhanov-Sasaki equation,
choosing the correct Minkowski behaviour at large k.
Finally, we can use the same result of Eq.(8.112), remembering to divide by
the 32πG factor that we have introduced in order to give dimensionality to h, and
multiplying by a2/z2 = 4πG/ϵ, in order to recover the 2z′/z factor in front of R′,
instead of 2H.
Thus, we can ﬁnally write down the scalar power spectrum as:
PR =
H 2
4M2
Plϵk3

k=aH
2
R =
H 2
8π2M2
Plϵ

k=aH
(8.146)

8.5 Production of Scalar Perturbations During Inﬂation
261
This is the most important result of this chapter, since it provides a prediction which
can be (and indeed is) tested observationally. Using Eq.(6.94), one can relate this
power spectrum to those of the other quantities which become relevant at horizon
re-entering during the radiation-dominated epoch. For example, using Eq.(6.77), we
can write that:
2
	 = 4(5 + 2Rν)2
(15 + 4Rν)2 2
R .
(8.147)
In general, 	 is not constant on large scales during inﬂation, but it is indeed constant
on large scales during radiation domination, as we saw in Chap.6. The above thus
constitutes the initial condition, on the power spectrum, at horizon re-entering.
Now, let us perform a calculation similar to that in the previous section, culminated
in Eq.(8.112).
Exercise 8.21 Employing Eq.(8.41) written in the conformal time, show that:
z′
z = H(1 + ϵ −η) .
(8.148)
Afterwards, assume ϵ and η to be constant. Then, use Eq.(8.97) and recast the
Mukhanov-Sasaki equation as follows:
R′′ −2(1 + 2ϵ −η)
τ
R′ + k2R = 0 ,
(8.149)
where we are now employing τ as conformal time, in order to avoid confusion with
the second slow-roll parameter η. Finally, show that the above equation can be written
as:
(z2R)′′ +

k2 −2 + 6ϵ −3η
τ 2

(z2R) = 0 .
(8.150)
This equation has the same form as Eq.(8.99), and hence a similar analysis applies.
In particular, its solution is of the form:
z2(τ)R(τ, k) = C1(k)
√
−τ H (1)
ν (−kτ) + C2(k)
√
−τ H (2)
ν (−kτ) ,
(8.151)
with order
ν =
√
3
2

3 + 8ϵ −4η .
(8.152)
Exercise 8.22 Following the same steps that we saw in the tensor case, show that:
2
R(τ, k) =
1
8π2M2
Plϵ
1
a2τ 2 (k|τ|)−4ϵ+2η .
(8.153)

262
8
Inﬂation
For the scalar case a different k-dependence of the spectrum appears, involving the
second slow-roll parameter. The combination −4ϵ + 2η is the ﬁrst order expression
of the scalar spectral index. Evaluating the above spectrum at horizon crossing, we
get the result already shown in Eq.(8.146).
8.6
Spectral Indices
It is customary to cast the dimensionless scalar and tensor power spectra as follows:
2
S ≡2
R ≡k3PR(k)
2π2
=
H 2
8π2M2
Plϵ

k=aH
≡AS
 k
k∗
nS(k)−1
,
(8.154)
2
T ≡22
h ≡k3Ph(k)
π2
=
2H 2
π2M2
Pl

k=aH
≡AT
 k
k∗
nT (k)
,
(8.155)
where the general k-dependence (given by the speciﬁc model of inﬂation) is embed-
ded in nS(k) and nT (k), which are known as scalar spectral index and tensor
spectral index.
We have introduced here the pivot scale k∗, which is usually taken to be
0.002 Mpc−1 or 0.05 Mpc−1 (Ade et al. 2016a) and the factor 2 in 2
T ≡22
h takes
into account the two polarisations of the GW. The spectral amplitudes AS and AT ,
of which only the ﬁrst is constrained by observation since we do not detect yet the
primordial GW background, are related to the energy scale of inﬂation.
Since the spectral indices are not necessarily constant, the spectra can be written
in the following more general form:
ln
2
S
AS
=

nS −1 + 1
2
dnS
d ln k ln k
k∗
+ 1
6
d2nS
d(ln k)2

ln k
k∗
2
+ · · ·

ln k
k∗
, (8.156)
ln 2
T
AT
=

nT + 1
2
dnT
d ln k ln k
k∗
+ · · ·

ln k
k∗
. (8.157)
The derivative of the spectral index with respect to ln k is called running of the
spectral index. We do not consider runnings in detail here, for simplicity, and Planck
has not constrained them very tightly, as we shall see. However, they (at least the
ﬁrst one) will probably become of great interest in future CMB experiments (Muñoz
et al. 2017).
From the above Eq.(8.156) at ﬁrst order, it is straightforward to write:
nS −1 = d ln 2
S
d ln k
,
nT = d ln 2
T
d ln k
.
(8.158)

8.6 Spectral Indices
263
For the tensor case:
nT = 2 k
H
d H
dk

aH=k
.
(8.159)
Recall that H does not depend on the scale in general, being it a background quantity,
but it is the evaluation at aH = k that makes H depending on k. This is because
different scales cross the horizon at different times during inﬂation. In particular,
recall from Eq.(8.83) that:
η =
 a
0
da
Ha2 ≈1
H
 a
0
da
a2 = −1
Ha ,
(8.160)
since H is almost constant during inﬂation. Now, when we evaluate aH = k, we
have that η = −1/k. Therefore, we obtain for the tensor spectral index:
nT = 2 k
H
d H
dη
dη
dk

aH=k
= 2 1
kH
d H
dη

aH=k
.
(8.161)
By deﬁnition of ϵ, cf. Eq.(8.36), we know that:
d H
dη = −aH 2ϵ ,
(8.162)
so that we can ﬁnally determine:
nT = −2ϵ
(8.163)
which is the result already derived in Eq.(8.107).
For the scalar spectral index is pretty much the same calculation:
nS −1 = d ln(H 2/ϵ)
d ln k

aH=k
= −2ϵ −d ln ϵ
d ln k

aH=k
.
(8.164)
We can deal with the last term as follows:
d ln ϵ
d ln k

aH=k
= k
ϵ ϵ′ dη
dk

aH=k
= 1
kϵϵ′

aH=k
.
(8.165)
Using Eq.(8.41) one has:
ϵ′ = 2aHϵ(ϵ −η) ,
(8.166)
and the scalar spectral index is thus written as:
nS −1 = −4ϵ + 2η = −6ϵV + 2ηV
(8.167)

264
8
Inﬂation
again in agreement with the result found in Eq.(8.153).
Finally, deﬁne the tensor-to-scalar ratio:
r∗≡2
T (k∗)
2
S(k∗) = AT
AS
= 16ϵ = −8nT
(8.168)
It is customary (Ade et al. 2016a) to use r in order to express the energy scale of
Inﬂation at the time when the pivot scale exits the Hubble radius. From Eq.(8.155)
we have:
H 2
∗= π2M2
Pl
2
2
T (k∗) .
(8.169)
Using the deﬁnition of r∗and Eq.(8.154), one gets:
H 2
∗= π2M2
Pl
2
r∗2
S(k∗) = π2M2
Pl
2
r∗AS ,
(8.170)
from which:
V∗= 3π2M4
Pl
2
r∗AS
(8.171)
8.7
Observational Results
In Ade et al. (2016a) one can ﬁnd recent constraints on the inﬂationary parameters.
They slightly change with respect to the different datasets considered. We report here
the spectral index and its running and running of the running at 68% CL:
nS = 0.9586 ± 0.0056 ,
(8.172)
dnS
d ln k = 0.009 ± 0.010 ,
(8.173)
d2nS
d(ln k)2 = 0.025 ± 0.013 ,
(8.174)
using the pivot scale k∗= 0.05 Mpc−1. For the scalar amplitude at 68% CL:
ln(1010 AS) = 3.094 ± 0.034 .
(8.175)
For the tensor-to-scalar ratio:
r0.002 < 0.10 ,
(8.176)
at 95% conﬁdence level. From these numbers, we can write the energy scale of
Inﬂation at the time when the pivot scale exits the Hubble radius as follows:

8.7 Observational Results
265
Fig. 8.2 This is Fig.12 of Ade et al. (2016a) and shows the marginalised joint 68% and 95% CL
regions for ns and r at k = 0.002 Mpc−1 from Planck compared to the theoretical predictions of
selected inﬂationary models. Note that the marginalised joint 68 and 95% CL regions have been
obtained by assuming dns/d ln k = 0
V∗=

1.88 × 1016 GeV
4
r
0.10 ,
(8.177)
and therefore obtain an upper bound, which corresponds to GUT energy scale.
In Fig.8.2 we borrow (with permission, of course) Fig.12 of Ade et al. (2016a)
showing the constraints on some inﬂationary models in the parameter space ns vs.
r. Note here that N∗is the number of e-folds to the end of inﬂation, which is lim-
ited in the range 50–60 because the observed scales, in particular the pivot one
k = 0.002 Mpc−1 must have had time to leave the horizon and then to re-enter.
8.8
Examples of Models of Inﬂation
We conclude this Chapter presenting some important models of inﬂations, some of
those in Fig.8.2, limiting ourselves to the class of single ﬁeld models. There is a huge
number of inﬂationary models, in Martin et al. (2014) 193 of them are analysed, and
it seems that data favour the simplest category of single ﬁeld slow-roll inﬂation that
we have presented in this chapter. See also Tsujikawa (2014) for a very nice review
on many inﬂationary models.

266
8
Inﬂation
8.8.1
General Power Law Potential
A very simple model of inﬂation consists in an inﬂaton ﬁeld described by the poten-
tial:
V (ϕ) = λn
ϕn
n ,
(8.178)
from which one can easily determine the slow-roll parameters from Eqs.(8.45) and
(8.47):
ϵV =
n2
16πGϕ2 = n2M2
Pl
16πϕ2 ,
ηV = n(n −1)
8πGϕ2 = n(n −1)M2
Pl
8πϕ2
.
(8.179)
In order for these parameters to be very small and thus trigger inﬂation, one has to
have ϕ ≫MPl and note that this condition does not depend on the coupling. We
can put the predictions on the spectral indices as functions of the number of e-folds
to the end of inﬂation by deﬁning the value of the ﬁeld at which inﬂation ends as
ϵV (ϕ f ) = 1.
For the general power law potential, this condition becomes:
n2
16πGϕ2
f
= 1
⇒
ϕ f =
n
√
16πG
.
(8.180)
The number of e-folds to the end of inﬂation can be obtained exactly from Eq.(8.50):
N = 8πG
n
 ϕi
ϕ f
ϕ dϕ = 4πG
n

ϕ2
i −
n2
16πG

,
(8.181)
from which the initial value of the ﬁeld is:
ϕ2
i =
n
4πG

N + n
4
	
.
(8.182)
From this, the slow-roll parameters can be written as:
ϵV =
n
4N + n ,
ηV = 2(n −1)
4N + n ,
(8.183)
and the scalar spectral index and the tensor-to-scalar ratio are the following:
nS −1 = −6ϵV + 2ηV = −2(n + 2)
4N + n ,
r = 16ϵV =
16n
4N + n =
8n
n + 2(1 −nS) .
(8.184)
If we substitute Eq.(8.182) into Eq.(8.178), we get:
V (ϕ) ≈λnnn/2−1N n/2Mn
Pl .
(8.185)

8.8 Examples of Models of Inﬂation
267
In order for the classical treatment to be valid, we need V (ϕ) ≪M4
Pl and hence:
λn ≪
M4−n
Pl
nn/2−1N n/2 .
(8.186)
For n = 4 and N = 60 we have λ4 ≪10−5.
8.8.2
The Starobinsky Model
The Starobinsky model is actually a f (R) model, hence a modiﬁcation of GR, whose
action is
S = M2
Pl
2

d4x√−g f (R) ,
(8.187)
where f (R) is a generic function of the Ricci scalar. When f (R) = R we recover
GR. The above action can be recast as follows:
S =

d4x√−g
 M2
Pl
2 ϕR −V (ϕ)

,
(8.188)
i.e. as a non-minimally coupled scalar-tensor theory, where the scalar ﬁeld ϕ and
its potential are deﬁned as:
ϕ ≡MPl
d f
d R ,
V (ϕ) ≡M2
Pl
2

R d f
d R −f

.
(8.189)
This kind of theory has a non-minimal coupling because of the term ϕR (the minimal
coupling to geometry occurs just with √−g). The action written as in Eq.(8.188)
is also said to be in the Jordan frame and corresponds to the Brans–Dicke theory
(Brans and Dicke 1961) with a special choice for its free parameter (i.e. ω = 0).
Exercise 8.23 Performing the conformal transformation
ˆgμν = d f
d R gμν =
ϕ
MPl
gμν ,
(8.190)
show that:
ˆS =

d4x√−g
 M2
Pl
2
ˆR −1
2 ˆgμν∂μχ∂νχ −U(χ)

,
(8.191)
where ˆR is the Ricci scalar computed from ˆgμν and:

268
8
Inﬂation
U ≡V M2
Pl
ϕ2
=
M2
Pl
2(d f/d R)2

R d f
d R −f

,
χ ≡

3
2 MPl ln ϕ
MPl
.
(8.192)
Note that, in order for the above deﬁnition of χ to make sense, d f/d R > 0.
The action ˆS is said to be in the Einstein frame. Thus, any f (R) theory can be
reformulated as a scalar-tensor theory, the scalar ﬁeld being ϕ ≡MPld f/d R. The
f (R) theories have been intensively studied in the past decades, see the comprehen-
sive reviews Sotiriou and Faraoni (2010) and De Felice and Tsujikawa (2010).
Since any f (R) can be conformally mapped in GR plus a canonical scalar ﬁeld,
it seems natural to investigate how this kind of modiﬁed gravity accounts for inﬂa-
tion. Indeed, probably the most successful application of a f (R) theory is in the
inﬂationary paradigm, as we are going to show in a moment.
Now it is χ in action (8.191) which plays the role of the inﬂaton. The Starobinsky
model (Starobinsky 1979) is given by a quadratic R2 correction to the usual Einstein-
Hilbert term in the action for gravity:
f (R) = R + R2
6M2 .
(8.193)
Then, one can easily calculate from Eq.(8.192):
U =
3M2
PlM2R2
4(R + 3M2)2 ,
χ =

3
2 MPl ln R + 3M2
3M2
.
(8.194)
Exercise 8.24 Invert the above relation for χ(R), obtaining thus a R(χ), and sub-
stitute it into the expression for U(χ), obtaining thus the expression for the inﬂaton
potential in the Starobinsky model:
U(χ) = 3
4 M2
PlM2 
1 −e−√2/3χ/MPl	2
(8.195)
In Fig.8.3 we plot the Starobinsky potential U(χ) as function of the scalar ﬁeld
χ. The most important feature is the plateau at large values of the ﬁeld which is the
ideal feature for a slow-roll evolution of the inﬂaton ﬁeld.
The slow-roll parameters are easily calculated from Eqs.(8.45), (8.47) and
(8.195):
ϵU = 4
3
e−2√2/3χ/MPl

1 −e−√2/3χ/MPl2 ,
ηU = 4
3
2e−2√2/3χ/MPl −e−√2/3χ/MPl

1 −e−√2/3χ/MPl2
.
(8.196)

8.8 Examples of Models of Inﬂation
269
Fig. 8.3 Plot of the Starobinsky potential, in Eq.(8.195)
The number of e-folds to the end of inﬂation is obtained by solving the following
integral:
N =

3
8
 χ
χ f
dχ
MPl

e
√2/3χ/MPl −1
	
≈3
4e
√2/3χ/MPl ,
(8.197)
so that we can write the slow-roll parameters as:
ϵU =
12
(4N −3)2 ≈
3
4N 2 ,
ηU = 4 9 −4N
(4N −3)2 ≈−1
N ,
(8.198)
where we have kept the dominant contributions for large N. The scalar spectral
index and the tensor-to-scalar ratio are thus written, using Eqs.(8.167) and (8.168),
as follows:
nS = 1 −2
N ,
r = 12
N 2 .
(8.199)
Substituting N = 50 and 60, the predictions obtained are in excellent agreement with
the Planck constraints shown in Fig.8.2, making thus the Starobinsky model quite
successful.

270
8
Inﬂation
References
Abramowitz, M., Stegun, I.A.: Handbook of Mathematical Functions with Formulas, Graphs, and
Mathematical Tables. Dover, Illinois (1972)
Ade, P.A.R., et al.: Planck 2015 results. XX. constraints on inﬂation. Astron. Astrophys. 594, A20
(2016a)
Ade, P.A.R., et al.: Planck 2015 results. XIII. cosmological parameters. Astron. Astrophys. 594,
A13 (2016b)
Albrecht, A., Steinhardt, P.J.: Cosmology for grand uniﬁed theories with radiatively induced sym-
metry breaking. Phys. Rev. Lett. 48, 1220–1223 (1982)
Bolliet, B., Barrau, A., Martineau, K., Moulin, F.: Some clariﬁcations on the duration of inﬂation
in loop quantum cosmology. Class. Quant. Grav. 34(14), 145003 (2017)
Brandenberger, R.H., Martin, J.: Trans-Planckian issues for inﬂationary cosmology. Class. Quant.
Grav. 30, 113001 (2013)
Brandenberger, R., Peter, P.: Bouncing cosmologies: progress and problems. Found. Phys. 47(6),
797–850 (2017)
Brans, C., Dicke, R.H.: Mach’s principle and a relativistic theory of gravitation. Phys. Rev. 124,
925–935 (1961)
Coleman, S.R., Weinberg, E.J.: Radiative corrections as the origin of spontaneous symmetry break-
ing. Phys. Rev. D 7, 1888–1910 (1973)
De Felice, A., Tsujikawa, S.: f(R) theories. Living Rev. Relativ. 13, 3 (2010)
Di Marco, A.: Lyth bound, eternal inﬂation and future cosmological missions. Phys. Rev. D 96(2),
023511 (2017)
Guth, A.H.: The inﬂationary universe: a possible solution to the horizon and ﬂatness problems.
Phys. Rev. D 23, 347–356 (1981)
Kiefer, C., Polarski, D.: Why do cosmological perturbations look classical to us? Adv. Sci. Lett. 2,
164–173 (2009)
Liddle, A.R., Parsons, P., Barrow, J.D.: Formalizing the slow roll approximation in inﬂation. Phys.
Rev. D 50, 7222–7232 (1994)
Linde, A.: On the problem of initial conditions for inﬂation. In: Black Holes, Gravitational Waves
and Spacetime Singularities Rome, Italy, 9–12 May 2017
Linde, A.D.: A new inﬂationary universe scenario: a possible solution of the horizon, ﬂatness,
homogeneity, isotropy and primordial monopole problems. Phys. Lett. 108B, 389–393 (1982)
Lyth, D.H.: What would we learn by detecting a gravitational wave signal in the cosmic microwave
background anisotropy? Phys. Rev. Lett. 78, 1861–1863 (1997)
Martin, J., Ringeval, C., Trotta, R., Vennin, V.: The best inﬂationary models after planck. JCAP
1403, 039 (2014)
Mukhanov, V.F.: Gravitational instability of the Universe ﬁlled with a scalar ﬁeld. JETP Lett. 41,
493–496 (1985). Pisma Zh. Eksp. Teor. Fiz.41,402(1985)
Mukhanov, V.F., Feldman, H.A., Brandenberger, R.H.: Theory of cosmological perturbations. Part
1. Classical perturbations. Part 2. Quantum theory of perturbations. Part 3. Extensions. Phys.
Rept. 215, 203–333 (1992)
Muñoz, J.B., Kovetz, E.D., Raccanelli, A., Kamionkowski, M., Silk, J.: Towards a measurement of
the spectral runnings. JCAP 1705, 032 (2017)
Novello, M., Bergliaffa, S.E.P.: Bouncing cosmologies. Phys. Rept. 463, 127–213 (2008)
Sasaki, M.: Large scale quantum ﬂuctuations in the inﬂationary Universe. Prog. Theor. Phys. 76,
1036 (1986)
Sotiriou, T.P., Faraoni, V.: f(R) theories of gravity. Rev. Mod. Phys. 82, 451–497 (2010)

References
271
Starobinsky, A.A.: Spectrum of relict gravitational radiation and the early state of the universe.
JETP Lett. 30, 682–685 (1979). Pisma Zh. Eksp. Teor. Fiz.30,719(1979)
Tsujikawa, S.: Distinguishing between inﬂationary models from cosmic microwave background.
PTEP 2014(6), 06B104 (2014)
Weinberg, S.: The Quantum Theory of ﬁelds: vol. 2. Modern Applications. Cambridge University
Press, Cambridge (2013)
Weinberg, S.: Cosmology. Oxford University Press, Oxford (2008)

Chapter 9
Evolution of Perturbations
On peut braver les lois humaines, mais non résister aux lois
naturelles
(One can challenge human laws, but not the natural ones)
Jules Verne, Vingt mille lieues sous le mers
In this Chapter we solve exactly some of the equations that we found in Chap.4,
using some approximations. In particular, we can distinguish 4 cases of evolution:
1. On super-horizon scales,
2. In the matter-dominated epoch,
3. In the radiation-dominated epoch,
4. Deep inside the horizon,
for which it is possible to perform analytic calculations and thus gain a clearer
physical insight.
Our scope is to understand the shape of the matter power spectrum, plotted in
Fig.9.1 from the analysis of the SDSS DR5 (Data Release 5) performed in Percival
et al. (2007). Since we already know the form of the primordial power spectrum,
cf. Eq.(8.154), the above task amounts to determine the matter, CDM plus baryons,
transfer function.
It must be noted that the data points in Fig.9.1 are derived from the observation of
the distribution of galaxies in the sky and hence provide information on the galaxy
density contrast δg, which is in general a biased tracer of the underlying distribution
ofmatterinthesensethatthegalaxycorrelationfunctionisnotequaltothetotalmatter
correlation function (Kaiser 1984). At low redshift this bias is usually considered as
a constant
δg = bδm ,
(9.1)
with δm being the matter density contrast (baryonic plus CDM), but for larger redshift
it might be a function of redshift and of the wavenumber, i.e. b = b(k, z).
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_9
273

274
9
Evolution of Perturbations
Fig. 9.1 Matter power spectrum, from Percival et al. (2007)
Beyond the cosmic variance affecting in a relevant way any large-scale observa-
tion, the determination of the power spectrum is also afﬂicted by another noise, which
is called shot noise and is due to the fact that δg is given by a discrete distribution
(that of galaxies) tracing a continuous one (that of the underlying matter).
Finally, spectra such as that in Fig.9.1 are 3-d, in the sense that they are computed
from the spatial distribution of galaxies. While determining the angular positions on
the celestial sphere is not complicated, the only direct measure of distance that we
have is the redshift. It is possible, of course, to transform the redshift into an actual
distance (a proper distance, for example) through the cosmological model that we

9 Evolution of Perturbations
275
want to test, but determining redshift is time-consuming, especially if it is done via
spectroscopy, and introduces extra errors due to peculiar motions and to photometry
(if z is determined photometrically). Hence, it is perhaps more convenient to work
with a 2-d power spectrum, the angular one w(θ), since angular positions on the
celestial sphere are easily, precisely and rapidly determined.
9.1
Evolution on Super-Horizon Scales
A given comoving wavenumber k is super-horizon at a certain conformal time η, if
kη ≪1
(9.2)
Since usually H ∝1/η, the above condition amounts to:
k ≪H
(9.3)
which can be rewritten for the physical scale as follows:
k
a ≪H
(9.4)
The super-horizon regime is the same one that we used in Chap.6 when we investi-
gated the primordial modes. The main difference with what we are going to see here
is that we do not limit ourselves to the radiation-dominated epoch, but investigate
what happens through radiation-matter equality and also through matter-DE equality.
Thus, the above conditions can be written as follows in the epochs of interest:
k ≪H = 1
η
⇒
kη ≪1 ,
(9.5)
during the radiation-dominated epoch (for which a ∝η),
k ≪H = 2
η
⇒
kη ≪2 ,
(9.6)
during the matter-dominated epoch (for which a ∝η2) and
k ≪H =
HΛ
1 + HΛ(η0 −η) ,
(9.7)
for the Λ-dominated era. This is similar to the inﬂationary phase, but with η > 0,
hence the above expression for the conformal Hubble factor.

276
9
Evolution of Perturbations
We use Eqs.(6.21)–(6.24):
δ′
γ = −4′ ,
δ′
ν = −4′ ,
δ′
c = −3′ ,
δ′
b = −3′ ,
(9.8)
the Poisson equation, written using Eq. (6.59) as follows:
3
H

′ −H

+ k2
H2  =
3
2ρtot

ρcδc + ρbδb + ργδγ + ρνδν

,
(9.9)
where we put in evidence the k2/H2 factor that we are going to neglect, and the
anisotropic stress equation (4.184):
k2( + ) = −32πGa2ρνN2 .
(9.10)
We could use again Eq.(6.59) in order to put in evidence the k2/H2 term on the
left, but it is not necessary because the neutrino quadrupole is of the same order and
thus we need to perform differentiations as we did in Chap.6 in order to get a closed
equation for the potentials.
Note that we have neglected the photon quadrupole contribution. It is an approxi-
mation motivated by the fact that before recombination the tight coupling with elec-
trons washes out 2, whereas after radiation-matter equality Rγ becomes rapidly
(∝1/a ∝1/η2) negligible.
When matter dominates, also Rν is negligible, so we expect the potentials to
become equal. Since our objective here is to perform an analytic calculation, we
assume already  = −. This is incorrect, strictly speaking, when considering the
radiation-matter domination transition but it is ﬁne when considering the matter-DE
one. Therefore, let us rewrite Eq.(9.9) as follows:
3H

′ + H

= 3H2
2ρtot

ρcδc + ρbδb + ργδγ + ρνδν

.
(9.11)
This equation holds true also in presence of DE, provided that the latter does not
cluster (e.g. it is Λ).
9.1.1
Evolution Through Radiation-Matter Equality
In presence of radiation and matter only, Friedmann equation can be written as
follows:
H2 = 8πGa2
3
(ρm + ρr) = 8πG
3
ρm

1 + 1
y

,
(9.12)

9.1 Evolution on Super-Horizon Scales
277
where we have grouped together the species which evolve in the same way and
indicated them with a subscript r, i.e. radiation (photons and neutrinos) and with a
subscript m, i.e. matter (CDM and baryons). We have also employed the deﬁnition:
y ≡ρm
ρr
= a
aeq
,
(9.13)
where aeq is the equivalence scale factor.
Exercise 9.1 Assume adiabaticity, i.e.
δc = δb = 3
4δγ = 3
4δν ≡δm .
(9.14)
Rewrite Eq.(9.11) using y as independent variable. Show that:
y d
dy +  = 4 + 3y
6(y + 1)δm .
(9.15)
Exercise 9.2 We are looking now for a closed equation for . Therefore, differen-
tiate Eq.(9.15) with respect to y and use δ′
m = −3′ in order to ﬁnd:
d2
dy2 + (7y + 8)(3y + 4) + 2y
2y(y + 1)(3y + 4)
d
dy +
1
y(y + 1)(3y + 4) = 0
(9.16)
Exercise 9.3 Quite unexpectedly, the above Eq.(9.16) can be solve exactly. Indeed,
use the following transformation (Kodama and Sasaki 1984):
u ≡
y3
√1 + y ,
(9.17)
and show that
d2u
dy2 +

−2
y +
3
2(y + 1) −
3
3y + 4
 du
dy = 0 .
(9.18)
Exercise 9.4 Integrate once Eq.(9.18) and show that:
ln du
dy = C1 + 2 ln y −3
2 ln(y + 1) + ln(3y + 4) ,
(9.19)
where C1 is an integration constant. By exponentiating and integrating again show
that:

278
9
Evolution of Perturbations
y3
√1 + y = A
 y
0
dy y2(3y + 4)
(1 + y)3/2 ,
(9.20)
where A is an integration constant related to C1 and assume that y3 →0 for y →0.
Exercise 9.5 Solve the above integration and show that:
(y) = P
10y3
	
16

1 + y + 9y3 + 2y2 −8y −16

,
(9.21)
where P is the primordial gravitational potential, which we introduced in Eq.(6.77)
in place of Cγ = R = ζ. Show that (y →0) = P.
From the above solution we see that for y →∞(which here means deep into the
matter-dominated epoch) the gravitational potential drops of 10%, i.e.
 →9
10P ,
for y →∞.
(9.22)
In Fig.9.2 we display the evolution of /P as function of y, as given by Eq.(9.22).
Fig. 9.2 Evolution of the gravitational potential  on super-horizon scales (k = 0) through
radiation-matter equality. From Eq.(9.22)

9.1 Evolution on Super-Horizon Scales
279
It can be shown that  is constant on super-horizon scales for any background
evolution with w ̸= −1 constant and for adiabatic perturbations (Mukhanov et al.
1992).
Exercise 9.6 Setting  = −, combine Eq.(4.179) with Eq.(4.189) and use
Eq.4.129. Show that:
′′ + 3H

1 + c2
ad

′ +

2H′ + H2 
1 + 3c2
ad

 + k2c2
ad = −4πGa2 .
(9.23)
where we have deﬁned c2
ad ≡P′/ρ′ as the adiabatic speed of sound. Show that this
equation can be cast as follows:
u′′ +

k2c2
a −θ′′
θ

u = −a2(ρ + P)−1/2
(9.24)
where
u ≡

4πG(ρ + P)1/2 ,
θ ≡1
a

ρ
ρ + P
1/2
.
(9.25)
It is clear that the above transformation cannot treat the cosmological constant,
for which P = −ρ. Nevertheless, it is interesting to see that Eq.(9.24) has a form
similar to Eq.(8.71) and hence, for k = 0 and  = 0 (adiabatic perturbations) its
general solution is:
u = C1θ + C2θ
 dη
θ2 .
(9.26)
Exercise 9.7 Consider a single ﬂuid model P = wρ, with w constant and different
from −1. Show, from solving the Friedmann equation, that:
a = (η/η0)2/(1+3w) ,
(9.27)
where w ̸= −1/3 (in this case the solution grows exponentially with the conformal
time). Show then that:
θ
 dη
θ2 ∝a
H ,
(9.28)
and thus show, using Eq.(9.25), that  is constant.
Hence the 9/10 drop of  between the radiation-dominated era and the matter-
dominated one can be extended to any kind of adiabatic ﬂuid with w ̸= −1 constant,
using the constancy of R on large scales. See e.g. Mukhanov (2005). Indeed, from
(12.33) we have

280
9
Evolution of Perturbations
R =  + H
′ −H
4πGa2(ρ + P) =  + 2
3
H−1′ + 
1 + w
.
(9.29)
Now, assume that w changes from a constant value wi to another constant value w f .
For each of the two cases  is a constant, i and  f , respectively. Then, taking
advantage of the constancy of R, we can say that:
i + 2
3
i
1 + wi
=  f + 2
3
 f
1 + w f
,
(9.30)
i.e
 f = i
5 + 3wi
5 + 3w f
1 + w f
1 + wi
,
(9.31)
with which we can easily check the result of Eq.(9.22).
9.1.2
Evolution in the Λ-Dominated Epoch
As already mentioned, we cannot use the above formulae for the case of greatest
interest, which is for w = −1, i.e. the cosmological constant. In this case, we have
to start directly from Eq.(9.23). Since P = −ρ and constant, then P′ = 0 and thus
cad = 0.
Exercise 9.8 Using Eq.(9.7) into Eq.(9.23) with cad = 0 and  = 0, show that:
′′ +
3HΛ
1 + HΛ(η0 −η)′ +
3H 2
Λ
[1 + HΛ(η0 −η)]2  = 0 .
(9.32)
Note that η does not go to inﬁnity, but to a maximum value η∞= η0 −1/HΛ for
which the scale factor diverges. Moreover, note that this equation, and its solution,
are valid also for small scales because for cad = 0 the k-dependence is suppressed.
Exercise 9.9 Find the relation between the cosmic time t and the conformal time
using Eq.(9.7) and show that η∞= η0 −1/HΛ corresponds to an inﬁnite t.
Exercise 9.10 Change variable to the scale factor in Eq.(9.32), and show that:
d2
da2 + 5
a
d
da + 3
a2  = 0 .
(9.33)
Solve this equation, using a power-law ansatz, and show that:

9.1 Evolution on Super-Horizon Scales
281
 = C1a−1 + C2a−3 .
(9.34)
Hence, when Λ dominates,  is not constant on super-horizon scales but vanishes
rapidly, as  ∝1/a or  ∝1 + HΛ(η0 −η).
9.1.3
Evolution Through Matter-DE Equality
In order to study the transition between the matter-dominated epoch and the DE-
dominated one, we consider Eq.(9.11) neglecting radiation:
3H

′ + H

= 3H2ρm
2ρtot
δm ,
(9.35)
where we have already considered adiabatic perturbations. Now, let us introduce the
following variable:
x ≡ρx
ρm
= ˜ρ(a/ax)−3(1+wx)
˜ρ(a/ax)−3
=
 a
ax
−3wx
,
(9.36)
where ρx is a DE component with equation of state wx, which we assume constant,
and ax is the scale factor at matter-DE equivalence, for which both the densities are
equal to ˜ρ. Note that wx < −1/3, in order to have a useful DE (it has to produce an
accelerated expansion) and recall that, in order for Eq.(9.35) to be valid, DE must
not cluster.
Exercise 9.11 Following the same steps which brought us to Eq.(9.16), ﬁnd a closed
equation for , using x as independent variable. Show that:
d2
dx2 + 6wx(x + 1) −2x −5
6wxx(x + 1)
d
dx −
1
3wxx(x + 1) = 0 .
(9.37)
This equation can be cast as a hypergeometric equation and thus solved exactly
(Piattella et al. 2014). Only one of the two independent solutions is well-behaved for
x →0, i.e. is a constant:
 ∝−2wx + 4wx(1 + x)
5
2F1

1, 1 −
1
3wx
, 1 −
5
6wx
, −x

→x→0 −6wx
5
.
(9.38)
The integration constant has to be picked in order to match with 9P/10.
In Fig.9.3 we display the evolution of , computed for wx = −1.5, −1, −0.5
from Eq.(9.38).

282
9
Evolution of Perturbations
Fig. 9.3 Evolution of the gravitational potential  on super-horizon scales (k = 0) through matter-
DE equality, from Eq.(9.38). The solid line represents the cosmological constant case wx = −1,
the dashed line wx = −1.5 and the dash-dotted one wx = −0.5
In Fig.9.4 we display the evolution of the potentials  (solid line) and −
(dashed-line) for the ΛCDM model with adiabatic initial condition using CLASS.
The wavenumber chosen here is k = 10−4 Mpc−1, which corresponds to a scale
larger than the horizon today and hence which spent the whole evolution outside the
horizon. Note how the two potentials display a difference at early times, due to the
presence of neutrinos, which are of course taken into account in CLASS.
The investigation of the evolution of scales larger than the horizon today is not
very useful because they are not observable. However, the scales that we do observe
today were outside the horizon in the past. We shall see in the next section that in the
matter-dominated regime the gravitational potential  is constant at all scales, even
through horizon-crossing, and thus it is interesting to know the behaviour of super-
horizon modes (the same behaviour is not shared by the density contrast). The same
does not happen when radiation dominates, but instead the gravitational potential
decays and oscillates rapidly for those scales which enter the horizon.
Since the behaviour in the radiation-dominated and in the matter-dominated epoch
is so dramatically different, it is useful to introduce the so-called equivalence wave
number, i.e. the wavenumber corresponding to a scale which enters the horizon at
the equivalence epoch, and thus deﬁned as:
keq ≡Heq .
(9.39)

9.1 Evolution on Super-Horizon Scales
283
Fig. 9.4 Evolution of the potentials  (solid line) and − (dashed-line) for the ΛCDM model
with adiabatic initial condition using CLASS. The wavenumber chosen here is k = 10−4 Mpc−1
Neglecting DE, Friedmann equation in presence of radiation and matter is written as
follows:
H2 = 8πG
3
(ρm + ρr)a2 = H 2
0 (m0a−1 + r0a−2) ,
(9.40)
and from this we can establish that, at equivalence, the conformal Hubble parameter
has the following expression:
H2
eq = 16πG
3
ρR0
a2eq
= 2H 2
0 r0(1 + zeq)2 = k2
eq ,
(9.41)
or, using the matter density parameter:
H2
eq = 16πG
3
ρM0
aeq
= 2H 2
0 m0(1 + zeq) = k2
eq ,
(9.42)
from which it is clear that:
1 + zeq = m0
r0
.
(9.43)
Using the observed values for the density parameters, we have that:

284
9
Evolution of Perturbations
keq =
√
2H0m0
√r0
≈0.014 h Mpc−1
(9.44)
The behaviour of super-horizon modes is especially important in CMB physics.
Indeed, in Chap.10 we shall see that for a given multipole ℓthe CMB temperature
correlation spectrum Cℓis determined mostly by those wavenumbers which satisfy:
ℓ≈k(η0 −η∗) = kr∗≈kη0 ,
(9.45)
where η0 is the present conformal time, η∗is the one corresponding to recombination
and r∗≡η0 −η∗is the comoving distance to recombination. The last approximation
is motivated by the fact that, using CLASS and the ΛCDM model, η∗≈3 × 102 Mpc
whereas η0 ≈104 Mpc.
The above expression can be manipulated as follows:
ℓ≈kη η0
η ≈kη 1
√a ,
(9.46)
where η is a generic past conformal time in the matter-dominated epoch and, for this
reason, we have used a ∝η2. So, e.g. at radiation-matter equality, i.e. a ≈10−4, the
super-horizon scales kη < 1 contribute to the monopoles ℓ⪅100 and at recombi-
nation a∗≈10−3, ℓ⪅30.
9.2
The Matter-Dominated Epoch
Let us now neglect completely radiation. Being no photon and neutrino quadrupoles,
then  = − and since matter dominates, δPtot = 0.
Equation(4.189) then provides us straightaway with a closed equation for :
′′ + 3H′ + 2H′ + H2 = −4πGa2δPtot = 0 ,
(9.47)
which can be solved exactly since, being a ∝η2, we have:
′′ + 6
η ′ = 0 .
(9.48)
The general solution is:
(k, η) = A(k) + B(k)(kη)−5 = A(k) + ˆB(k)a−5/2
(9.49)
where A(k), B(k) and ˆB(k) are functions of k, being the latter equal to B times the
proportionality factor between the conformal time and the scale factor, which are

9.2 The Matter-Dominated Epoch
285
related by a ∝η2. We have kept a kη dependence above because it is dimensionless,
as , A and B are.
Now, let us neglect the decaying mode (kη)−5 since it disappears very fast. The
important result here is that the gravitational potential is constant at all scales, through
horizon crossing, during matter domination. We shall see a very different behaviour
when radiation dominates.
Hence, provided that we are deep into the matter-dominated epoch, at large scales,
when kη < 1, we can match the results for  of this section and the previous one
and see that:
A(k < 1/η) = 9
10P(k) ,
(η > ηeq) .
(9.50)
So, the gravitational potential , for those scales which enter the horizon during the
matter dominated epoch, is a constant with value:
(k) = 9
10P(k) ,
(kηeq < 1)
(9.51)
The condition kηeq < 1, which corresponds to k < keq guarantees that the mode was
outside the horizon at equivalence and hence that it entered during matter domination.
Considering the generalised Poisson equation with  constant, we have:
3H2 + k2 = 3H2
2 δm ,
(9.52)
where δm is the density contrast of matter, which we deﬁne here as:
δm ≡(1 −b0)δc + b0δb ,
(9.53)
which comes from the fact that, being in the matter-dominated epoch, ρtot ∝a−3 and
c0 + b0 = 1 (of course we keep on considering a spatially ﬂat universe).
We must be careful that even in the matter-dominated epoch, but before recombi-
nation, for those modes inside the horizon we can have that δc ≫δb because baryons
are tightly coupled to photons and thus δb cannot grow, whereas CDM ﬂuctuations
can. For these modes, soon after recombination, δb becomes equal to δc or, in other
words, baryons fall into the potential wells of CDM. We shall see this in more detail
later. For large scales, those which enter the horizon after recombination, we have
δc = δb = δm (assuming, as usual, adiabaticity).
For the moment, let us focus on the evolution for δm. It follows immediately that:
δm(k, η) = 2A(k)

1 + k2
3H2

= 9P(k)
5

1 + k2η2
12

,
(k < keq) .
(9.54)
Therefore, δm is constant on super-horizon scales, but when a scale crosses the
horizon it starts to grow as δ ∝η2 ∝a, as the plot in Fig.9.5 shows. Note that the

286
9
Evolution of Perturbations
Fig. 9.5 Evolution of the matter density contrast δm normalised to the primordial potential, in the
matter-dominated era. From Eq.(9.54)
ﬁrst equality holds true at any scales, but the second one only for k < keq, because
only in this regime we are allowed to use Eq.(9.50).
The power spectrum at any time during the matter dominated epoch can thus be
put immediately in relation with the primordial one:
Pδ(k, η) = 81
25

1 + k2η2
12
2
P(k) ,
(k < keq) .
(9.55)
For nS = 1 the primordial power spectrum goes as P ∝1/k3, cf. Eq.(8.154), and
thus the above matter one grows linearly with k (when kη > 1). From the above
equation we can read off the matter transfer function, i.e.:
Tδ(k, η) = 9
5
k2η2
12
,
(1/η < k < keq) .
(9.56)
From this solution we can infer that the larger k is, i.e. the smaller the scale under
considerationis,themoreitgrows.Thisscenarioiscalled bottom-upbecausesmaller
scales becomes non-linear before the larger ones. In other words, ﬁrst small structures
form and then these can merge in order to form larger structures. The bottom-up
scenario is the contrary of the top-down scenario (Zeldovich 1984) by which ﬁrst
the largest structures form and then fragmentise in order to form the smaller ones.
In Eq.(9.56) we can appreciate that the k-dependence and the η one are separate.
The latter is proportional to η2 ∝a and is usually called growth factor. The separa-

9.2 The Matter-Dominated Epoch
287
tion of the k and η dependences takes place because matter has vanishing adiabatic
speed of sound and the k-dependence of the equation governing δm comes in multi-
plied by the gravitational potential, which is a constant (during matter domination).
We can see this in detail, by combining Eqs.(5.40) and (5.48).
Exercise 9.12 Combine Eqs.(5.40) and 5.48 after putting to zero w, δP and the
anisotropic stresses, which are indeed vanishing for CDM and also for baryons, after
recombination. Show that:
δ′′
m + Hδ′
m = −k2 −3′′ −3H′
(9.57)
In the above equation, the k-dependence enters only through k2 and then, in the
matter-dominated epoch we have that:
δ′′
m + Hδ′
m = k2 ,
(9.58)
with  constant (if we neglect already the decaying mode).
Exercise 9.13 Check that the solution of the above equation is the same as Eq.(9.54).
The transfer function that we have determined in this section is valid for small
values of k, i.e. k < keq ≈0.014h Mpc−1, which correspond to very large scales
which we do not actually observe or for which the errors and the cosmic variance
are too large. Indeed, in Fig.9.1 there are data points only for scales larger than
keq. It is necessary therefore to understand how matter ﬂuctuations behave during
radiation-domination.
9.2.1
Baryons Falling into the CDM Potential Wells
We offer here a simple calculation which should convey the idea of how important
CDM is for structure formation. This is often stated otherwise as the fact that after
recombination, baryons fall into the gravitational potential wells of CDM.
As we anticipated earlier, before recombination baryons were tight-coupled to
photons in the early-times plasma and, when they decouple and their over-densities
are free to grow, in general we have δb ≪δc for those modes which were well inside
the horizon during recombination.
Let us see this more quantitatively. In the same fashion by which we obtained
Eq.(9.58), we can write the following coupled equations for CDM and baryons:

288
9
Evolution of Perturbations
δ′′
c + Hδ′
c = k2 ,
(9.59)
δ′′
b + Hδ′
b = k2 ,
(9.60)
of which the baryonic one is valid only after recombination. These equations are
coupled since  is determined by both the components. Indeed, from the Poisson
equation we have that:
(3H2 + k2) = 3H2
2ρtot
(ρcδc + ρbδb) ≡3H2
2 δm ,
(9.61)
Now, the two Eqs.(9.59) and (9.60) have solutions (neglecting the decaying mode):
δc(k, η) = C1(k) + k2η2
6
A(k) ,
δb(k, η) = C2(k) + k2η2
6
A(k) ,
(9.62)
wherewehaveusedtheconstant potential solutionfor thepotential, inEq.(9.49) (also
here neglecting the decaying mode). Using this solution in Eq.(9.53) and comparing
with Eq.(9.54), we can conclude that:
C1(k) + b0[C2(k) −C1(k)] = 2A(k) .
(9.63)
For large scales kη ≪1 we already know that δc = δb = δm, because of adiabaticity,
and hence C1 = C2 = 2A.
For small scales, at recombination δc ≫δb because baryons were tightly coupled
to photons and thus δb could not grow. This, combined with the crucial fact that
b0 = 0.04 is small, makes δm (and the gravitational potential) dominated by δc.
Hence, again δc = δb soon after recombination, the detailed transient coming from
the decaying modes that we have neglected.
Inotherwords,baryonsfallinthepotentialwellsalreadycreatedbyCDM.Without
CDM, δb would grow proportionally to a, by a factor 103 by today, being of order
10−2. This is way too small in order for account of the structures that we observe.
In Fig.9.6 we plot the evolution of δc (solid line) and δb (dashed line) for k =
1Mpc−1 computed with CLASS. Note the oscillations in δb, which are related to
the baryon acoustic oscillations (BAO) of the matter power spectrum, cf. the small
box inside Fig.9.1, but are not the same thing. The oscillations in the plot of Fig.9.6
are function of the time (scale factor) evolution, whereas those in the matter power
spectrum of Fig.9.1 are function of the wavenumber k.
The oscillations of Fig.9.6 are caused by the tight coupling of baryons with
photons before recombination, when structure formation is impossible. On the other
hand, CDM can grow even when radiation dominates and thus, for the chosen scale
k = 1Mpc−1, the ratio δc/δb is of about 3 orders of magnitude.
In Fig.9.7 we plot again the evolution of δc (solid line) and δb (dashed line) for
k = 1Mpc−1 computed with CLASS, but this time with a negligible amount of CDM
(c0h2 = 10−6). Note how δb grows six orders of magnitude less today than in the
standard case.

9.2 The Matter-Dominated Epoch
289
Fig. 9.6 Evolution of δc (solid line) and δb (dashed line) for k = 1Mpc−1 computed with CLASS
Fig. 9.7 Evolution of δc (solid line) and δb (dashed line) for k = 1Mpc−1 computed with CLASS
with a negligible amount of CDM (c0h2 = 10−6)

290
9
Evolution of Perturbations
9.3
The Radiation-Dominated Epoch
Consider now the case of full radiation dominance and neglect δc and δb as source
of the gravitational potentials. Moreover, assume adiabaticity, so that δγ = δν = δr
and neglect the neutrino anisotropic stress, so that  = −.
Since we are deep into the radiation-dominated epoch, then w = c2
ad = 1/3 and
thus from Eq.(9.23) we can immediately write:
′′ + 4
η ′ + k2
3  = 0 ,
(9.64)
where we have used a ∝η. Deﬁning
u ≡η ,
(9.65)
the above equation becomes
u′′ + 2
η u′ +
k2
3 −2
η2

u = 0 .
(9.66)
This is a Bessel equation with solutions j1(kη/
√
3) and n1(kη/
√
3), i.e. the spherical
Bessel functions of order 1. Since n1 diverges for kη →0, we discard it as unphysical.
Recovering the gravitational potential  and using the fact that (Abramowitz and
Stegun 1972)
j1(x) = sin x
x2
−cos x
x
,
(9.67)
and
lim
x→0
sin x −x cos x
x3
= 1
3 ,
(9.68)
we can write
 = 3P
sin(kη/
√
3) −(kη/
√
3) cos(kη/
√
3)
(kη/
√
3)3
.
(9.69)
This solution shows that as soon as a mode k of the gravitational potential enters the
horizon, it rapidly decays as 1/η3 or 1/a3 while oscillating.
In Eq.(9.69) we plot the evolution of the gravitational potential, according to
Eq.(9.69). Note how  starts to decay right after kη > 1, i.e. after horizon crossing.
Thegoodnessofthesolution (9.69)plottedinFig.9.8canbeappreciatedinFig.9.9
where both  (solid line) and − (dashed line) are plotted. Outside the horizon the
two potentials are constant with a difference due to the neutrino fraction Rν. As soon
as they enter the horizon they rapidly decay to zero.
Now, recall Eq.(9.57) that we derived for the matter density contrast. It can be
used in the radiation-dominated epoch, but only for CDM:

9.3 The Radiation-Dominated Epoch
291
Fig. 9.8 Evolution of the gravitational potential  deep into the radiation-dominated era. From
Eq.(9.69)
Fig. 9.9 Evolution of the gravitational potentials  (solid line) and − (dashed line) deep into
the radiation-dominated era computed with CLASS for the ΛCDM model and k = 10Mpc−1.
Adiabatic perturbations have been used and the initial values have been normalised to that of 

292
9
Evolution of Perturbations
δ′′
c + 1
η δ′
c = k2 −3′′ −3
η ′ .
(9.70)
Using Eq.(9.64), we can write
δ′′
c + 1
η δ′
c = 2k2 + 9
η ′ ≡S(k, η) .
(9.71)
As stated at the beginning of the section, we are so deep into the radiation-dominated
epoch that the matter density contrast does not contribute to the gravitational potential
but only feels it.
Using Eq.(9.69) with x ≡kη as new independent variable, the function S(x) has
the following form:
S(x)
k2P
=
9

27x −2x3
cos
	
x/
√
3

+
√
3

5x2 −27

sin
	
x/
√
3

x5
,
(9.72)
and the equation for δc becomes:
d
dx

x dδ
dx

= 9P

27x −2x3
cos
	
x/
√
3

+
√
3

5x2 −27

sin
	
x/
√
3

x4
.
(9.73)
The homogeneous part of this equation has a simple solution:
δhom = C1 + C2 ln x ,
(9.74)
i.e. a constant C1 times a logarithmic contribution. A particular solution is obtained
by integrating twice the right-hand side, thus obtaining:
δpart =
9P

−x3Ci
	
x/
√
3

+
√
3

x2 −3

sin
	
x/
√
3

+ 3x cos
	
x/
√
3

x3
,
(9.75)
where Ci(z) is the cosine integral function, deﬁned as
Ci(z) ≡−
 ∞
z
dt cos t
t
.
(9.76)
The above is a particular solution, therefore the integration constants which stem
from the indeﬁnite integration can be incorporated in C1. The general solution for δc
is then:
δc = C1 + C2 ln x +
9P

−x3Ci
	
x/
√
3

+
√
3

x2 −3

sin
	
x/
√
3

+ 3x cos
	
x/
√
3

x3
.
(9.77)

9.3 The Radiation-Dominated Epoch
293
For x →0, we can expand the above solution as follows:
δ(x →0) = C1 + C2 ln(x) + P

−9 ln(x) −9γ + 6 + 9 ln(3)
2

+ O

x2
,
(9.78)
where γ is the Euler constant.
Since ln x is divergent for x →0 and we do not want δc to diverge, we have to
ask:
C2 = 9P .
(9.79)
Moreover, we know that δc(x →0) = 3P/2 when we choose adiabatic initial con-
ditions (and neglect neutrinos), cf. Eqs.(6.71) and (6.77), thus:
C1 = −9
2P [−2γ + 1 + ln(3)] .
(9.80)
We plot the evolution of δc through horizon-crossing in Fig.9.10.
For x ≫1, deep inside the horizon, we can neglect the contribution δpart to the
solution for δc since it decays rapidly. Thus, we can write the density contrast as
follows:
Fig. 9.10 Evolution of δc deep into the radiation-dominated era computed from Eqs.(9.77), (9.79)
and (9.80) (solid line) compared with the numerical calculation performed with CLASS for k =
10Mpc−1 (dashed line). Note the semi-logarithmic scale employed

294
9
Evolution of Perturbations
δc = −9
2P [−2γ + 1 + ln(3)] + 9P ln x = AP ln(Bkη) ,
(9.81)
where
A = 9 ,
B = exp

γ −1
2 −ln(3)
2

≈0.62 .
(9.82)
9.4
Deep Inside The Horizon
The last domain in which it is possible to analytically solve the equations for the
perturbations is when k ≫H, i.e. deep inside the horizon. We shall neglect baryons
in this calculation (this is imprecise and we shall see why numerically) and assume
 = − (which is a good approximation, on the basis of the results of the previous
section).
The relevant equations are thus the following ones:
δ′
c + kVc = −3′ ,
(9.83)
V ′
c + HVc = −k ,
(9.84)
k2 = 4πGa2ρcδc .
(9.85)
In the latter equation we have neglected all the potential terms except for the one
accompanied by k2 and we have also neglected radiation perturbations. It is not
evident why should we neglect ρrδr with respect ρcδc even when ρr ≫ρc deep into
the radiation-dominated epoch. Neglecting δb, at least, is justiﬁed by the fact that
before recombination it behaves as the ﬂuctuation in radiation and afterwards as that
in CDM, while being b always subdominant.
An explanation of why we can neglect ρrδr is offered by Weinberg who shows
that new modes appear (dubbed fast) which rapidly decay and oscillate (Weinberg
2002). He also takes into account baryons at ﬁrst order in b0.
Exercise 9.14 Use again the variable y ≡a/aeq and manipulate the three equations
above in order to obtain a single second-order equation for δc:
d2δc
dy2 +
2 + 3y
2y(y + 1)
dδc
dy −
3
2y(y + 1)δc = 0 .
(9.86)
This equation is known as Mészáros equation (Meszaros 1974). A solution can
be found at once, multiplying by 2y(y + 1):
2y(y + 1)d2δc
dy2 + 2dδc
dy + 3y dδc
dy −3δc = 0 .
(9.87)

9.4 Deep Inside The Horizon
295
A linear ansatz δc ∝y kills the second derivative and the last two terms on the left
hand side. Therefore, the simple solution we looked for is:
D1(y) ≡y + 2
3
(9.88)
This is also the growing mode. For y ≪1, i.e. before matter-radiation equality, δ
is practically constant, whereas for y ≫1 we have the known growth linear with
respect to the scale factor.
In order to ﬁnd the other independent solution say D2, we can use the Wronskian:
W(y) = D1
d D2
dy −d D1
dy D2 .
(9.89)
Exercise 9.15 Show that the Wronskian satisﬁes the simple ﬁrst-order differential
equation:
dW
dy = −2 + 3y
2y(y + 1)W ,
(9.90)
from which one gets
W =
1
y√1 + y .
(9.91)
Exercise 9.16 From the very deﬁnition of the Wronskian in Eq.(9.89), write a ﬁrst-
order equation also for D2, which is the following:
(y + 2/3)2 d
dy

D2
y + 2/3

=
1
y√1 + y .
(9.92)
Integrate it and show that the result is:
D2 = 9
2

1 + y −9
4 (y + 2/3) ln
√y + 1 + 1
√y + 1 −1

(9.93)
This mode grows logarithmically when y ≪1, recovering the logarithmic solu-
tion of the previous section. It decays as 1/y3/2 for y ≫1.
The complete solution for δc on small scales k ≫H and through radiation-matter
equality is then:
δc(k, a) = C1(k)D1(a) + C2(k)D2(a) .
(9.94)
The dependence of C1 and C2 from k can be established by matching this solution
with the one of the previous section in Eq.(9.81).

296
9
Evolution of Perturbations
9.5
Matching and CDM Transfer Function
As we discussed earlier and as it is clear from Fig.9.1 the today observed scales in
the matter power spectrum are those for which k > keq, i.e. those which entered the
horizon before matter equality.
In the last two section we have obtained exact solution for δc deep into the
radiation-dominated epoch for all scales and through radiation-matter equality at
very small scales. There is then the possibility of matching the two solutions on very
small scales and thus obtain in this regime the CDM transfer function until today.
Consider the following two solutions found in the previous sections, i.e.
δc(k, η) = AP(k) ln(Bkη) ,
(9.95)
δc(k, a) = C1(k)D1(a) + C2(k)D2(a) ,
(9.96)
which are valid on very small scales, i.e. kη ≫1. The purpose is to ﬁnd the functional
forms of C1(k) and C2(k).
Using Eqs.(9.40) and (9.41), one can approximate the Hubble parameter deep
into the radiation era as follows:
H ≈Heqaeq
√
2a
,
(9.97)
and solving using the conformal time, one has:
a = Heqaeq
√
2
η .
(9.98)
TheproportionalityconstantisthecorrectonewhichgivesH = 1/η whensubstituted
in the approximated formula for H.
We can thus write the logarithmic solution for δc, deep into the radiation-
dominated era, as follows:
δc(k, a) = AP(k) ln

Bk
√
2a
Heqaeq

.
(9.99)
Introducing y ≡a/aeq, the equivalence wavenumber keq = Heq and the rescaled
wavenumber:
κ ≡
√
2k
keq
= k√r0
H0m0
=
k
0.052 m0 h2 Mpc−1
(9.100)
one has:
δc(k, a) = AP(k) ln (Bκy) .
(9.101)

9.5 Matching and CDM Transfer Function
297
Recall that this solution is valid deep into the radiation-dominated epoch, thus y ≪1.
At the same time, it holds true only on very small scales, i.e. kη ≫1. Using the above
formulae, this means:
kη = k
√
2a
Heqaeq
= k
√
2a
keqaeq
= κy ≫1 .
(9.102)
Therefore, if we want to match radiation-domination solution with the solution of
the Mészáros equation, we need to choose a suitable ym at which performing the
junction of the two solutions such that 1/κ ≪ym ≪1.
Asking the equality of the two solutions and their derivatives at ym implies to
solve the following system:
AP ln(Bκym) = C1 (ym + 2/3) + C2D2(ym) ,
(9.103)
AP
ym
= C1 + C2
d D2
dy

y=ym
.
(9.104)
Exercise 9.17 Solve the above system and take the dominant contribution for ym →
0 (because the junction condition has to be imposed for ym ≪1). Show that:
C1 = 3
2 AP ln

4Bκe−3
,
C2 = 2
3 AP .
(9.105)
Therefore, the solution for δc valid at all time and at small scales is the following:
δc(k, y) = 3
2 AP ln
	
4
√
2Bκe−3
(y + 2/3) + 2
3 APD2(y) ,
(κ ≫1) .
(9.106)
We can project this solution at late times, when matter dominates and thus neglect
the decaying mode D2 and write:
δc(k, a) = 3
2 AP ln

4
√
2Be−3k
keq

a
aeq
,
(a ≫aeq, k ≫keq)
(9.107)
Note again the separated dependence from k and from the scale factor, being the
growth function D(a) = a. This allows us to write the transfer function for CDM as
follows, using Eq.(9.42) in order to eliminate aeq:
Tδ(k) =
Ak2
eq
2H 2
0 m0
ln

4
√
2Be−3k
keq

D(a) ,
(a ≫aeq, k ≫keq)
(9.108)

298
9
Evolution of Perturbations
Recall that the factor 3P/2 is the adiabatic initial condition on δc and thus enters the
primordial power spectrum. The above transfer function can be generalised including
DE, if the latter does not cluster. If it is the case, as for the cosmological constant,
its effect enters only the growth factor and in keq since, being another component
and having the ﬁxed total r0 + m0 +  = 1, the relative amount of radiation and
matter has to change (usually the amount of radiation is ﬁxed) and thus keq changes.
We can also determine the transfer function for the gravitational potential  at
late times. From Eq.(9.85) we have that:
k2 = 4πGa2ρmδm = 3H 2
0 m0
2a
δm ,
(9.109)
where we have included baryons, since we are considering late times and we have
seen that after recombination δb = δc. We are neglecting any DE contribution in the
expansion of the universe and considering a radiation plus matter model. Hence,
0 ≈1.
We thus have for the gravitational potential, combining Eqs.(9.107) and (9.109):
(k) =
9Ak2
eq
8k2 P(k) ln

4
√
2Be−3k
keq

,
k ≫keq
(9.110)
The transfer function for the gravitational potential is usually normalised to 9P/10
and therefore:
T(k) =
5Ak2
eq
4k2
ln

4
√
2Be−3k
keq

,
k ≫keq
(9.111)
Exercise 9.18 Using r0h2 = 4.15 × 10−5 in Eq.(9.44) and deﬁning
q ≡k × Mpc
m0h2 ,
(9.112)
show that we can cast the above transfer function in the following form:
T(k) = ln (2.40q)
(4.07q)2
(9.113)
See also Weinberg (2008), p.310.
We have written the transfer function as in Eq.(9.113) because it is simpler to
compare it with the numerical ﬁt of Bardeen, Bond, Kaiser and Szalay (BBKS) of
the exact transfer function (Bardeen et al. 1986), which is the following:

9.5 Matching and CDM Transfer Function
299
TBBKS(k) = ln (1 + 2.34q)
2.34q

1 + 3.89q + (16.2q)2 + (5.47q)3 + (6.71q)4−1/4 ,
(9.114)
and see that for large q it goes as ln(2.34q)/(3.96q)2, which is in good agreement
with our analytic estimate (9.113).
Given the transfer function T, δm can be written, from Eq.(9.109), as:
δm(k, a) =
2a
3H 2
0 m0
k2 =
3k2
5H 2
0 m0
P(k)T(k)a =
3k2
5H 2
0 m0
P(k)T(k)D(a) .
(9.115)
In the last equality we have recovered the growth factor D(a) in order to provide a
more general formula. From this solution we can obtain the power spectrum for δm
starting from the primordial one for , i.e.
Pδ(k, a) =
9k4
25H 4
0 2
m0
P(k)T 2
(k)D2(a) .
(9.116)
Using Eq.6.94, with  = − since we are neglecting neutrinos, P = 2R/3 and
thus the primordial power spectrum of  can be traded with the R one, and we get:
Pδ(k, a) =
4k4
25H 4
0 2
m0
PR(k)T 2
(k)D2(a) .
(9.117)
From Eq. (8.154), we can write the explicit dependence of the primordial power
spectrum of k as follows:
Pδ(k, a) =
8π2k
25H 4
0 2
m0
AS
 k
k∗
nS−1
T 2
(k)D2(a)
(9.118)
The power spectrum Pδ(k, a) can be determined through the observation of the
distribution of galaxies in the sky. Therefore, through the above formula we can probe
many quantities of great interest such as the primordial tilt of the power spectrum.
Now, let us make a plot of the power spectrum today (z = 0) using CLASS and
ﬁxing all the parameters to the ΛCDM best ﬁt values except for m0, which we let
free. We show in Fig.9.11 the shape of the matter power spectrum for m0 = 0.1
(blue) and m0 = 0.3 (yellow), m0 = 0.7 (green) and m0 = 0.99 (red).
The ﬁrst interesting feature of the power spectrum is that it has a maximum. This
maximum takes place roughly at keq for the following reason: entering the horizon
at equivalence is the best time to do that in order for a matter ﬂuctuation to grow
more. In fact, as we have seen, scales that entered the horizon earlier (i.e. k > keq) are
suppressed because radiation is dominating and that δ grows logarithmically during
this epoch, cf. Eq.(9.77). These are the scales of great observational interest, as can
be appreciated from Fig.9.1.

300
9
Evolution of Perturbations
Fig. 9.11 Matter power spectra for (left to right, in case no colours are available) m0 = 0.1 (blue),
m0 = 0.3 (yellow), m0 = 0.7 (green) and m0 = 0.99 (red)
On the other hand, the scales that entered after the equivalence grow proportionally
to a, cf. Eq.(9.54). Evidently, the scale which entered at equivalence has had more
time to grow than all the others, hence the the maximum or turnover in the power
spectrum.
The second interesting feature of the power spectrum is that its maximum is shifted
to the left when we reduce m0. This means that the equivalence wavenumber keq is
smaller when m0 is smaller and this can be immediately seen from Eq.(9.44) if we
ﬁx r0.
Remarkably, observation favours the line for m0 = 0.3 of Fig.9.11, as can also
be seen from Fig.9.1. Since the radiation content is very well established from CMB
observation (and our knowledge of neutrinos) as well as the spatial ﬂatness of the
universe (from the CMB, we shall see this in Chap.10), and its age (at least a lower
bound) and H0 are also well-determined, the only way to make the total is to add a
further component, which clearly is DE. The important point here is that the necessity
for DE can already be seen by analysing the large scale structure of the universe
(together with CMB) and this was realised well before type Ia supernovae started to
be used as standard candles (Maddox et al. 1990; Efstathiou et al. 1990).
For completeness, in Fig.9.12 we plot with CLASS the matter power spectrum at
z = 0 for the ΛCDM model, with different choices of the initial conditions.
The transfer function thus tells us how the shape of the primordial power spectrum
is changed through the cosmological evolution and through the analytic estimates
that we have done in this Chapter we understood that the k-dependence is set up
during radiation-domination.
However, we have made two important assumptions in our calculations: we have
neglected baryons and neutrino anisotropic stress (we have taken into account neu-
trinos from the point of view of the background expansion). If we aim to precise

9.5 Matching and CDM Transfer Function
301
Fig. 9.12 Matter power spectra for different initial conditions: Adiabatic (blue), Baryon Isocurva-
ture (yellow), CDM Isocurvature (green), Neutrino density Isocurvature (red), and Neutrino velocity
Isocurvature (purple)
Fig. 9.13 Left Panel. Evolution of BBKS transfer function of Eq.(9.114) (solid line) compared
with the numerical computation of CLASS, using m0 = 0.95 (which means negligible DE). Right
Panel. Ratio between the numerical result and the BBKS transfer function
predictions, and we have to in order to keep the pace with the increasing sophis-
tication of the observational techniques, we must take into account them. A more
precise ﬁtting formula (to numerical calculations performed with CMBFAST) taking
into account baryons and neutrino anisotropic stress is given by Eisenstein and Hu
(1998).
In Fig.9.13 we compare the BBKS transfer function with the numerical calcula-
tion of CLASS, adopting m0 = 0.95 while leaving all the remaining cosmological
parameters as in the ΛCDM model, except for Λ which is adjusted to the value
Λ = 1.632908 × 10−3 in order to match the correct budget of energy density. So,
in practice, we are neglecting DE.
As can be appreciated from the plots, the BBKS transfer function overestimates of
about 5% the correct transfer function for scales k ≳0.1h Mpc−1, see also Dodelson
(2003), p.208. The reason is that baryons behave like radiation before decoupling,

302
9
Evolution of Perturbations
Fig. 9.14 Left Panel. Ratio between the numerical result computed with CLASS assuming the
ΛCDM model, and the BBKS transfer function with m0h2 = 0.12038. Right Panel. Ratio between
the numerical result computed with CLASS assuming the ΛCDM model, and the BBKS transfer
function with m0 = 1
because of their tight coupling due to Thomson scattering. Therefore, they contribute
further to thwart scales entering the horizon before the equivalence.
In Fig.9.14 we display the ratio between the numerical transfer function computed
with CLASS for the ΛCDM model and the BBKS transfer function in two cases. In
the left panel, the same matter density parameter of the ΛCDM model is used for
both the transfer functions. In the right panel, we used the BBKS transfer function
with m0 = 1.
The latter choice was made in order to reproduce the plot of Dodelson (2003),
p.208 and thus to show the very large correction due to the cosmological constant
which, if not taken into account, leads to a 80% error at the scale k = 0.1h Mpc−1.
When Λ is taken into account properly, the BBKS transfer function still overesti-
mates the correct transfer function of at least a 10% on small scales, which implies an
imprecision of 1% in the power spectrum (since this depends on the squared transfer
function). Moreover, as it is obvious since it does not include baryons, the BBKS
cannot describe the BAO, which appear as oscillations in the transfer function at
about k = 0.1h Mpc−1 in Fig.9.14.
9.6
The Transfer Function for Tensor Perturbations
Treating the evolution of tensor perturbations, which we have done in the context
of inﬂation in Chap.8 is much easier than for scalar modes because of two reasons.
The ﬁrst is that CDM and baryons are very non-relativistic and so do not possess
anisotropicstress,whichwouldsourceGW.Thesecondreasonisthat,thoughphotons
and neutrinos do have anisotropic stresses this are always very small so that it is a
good approximation to neglect them.
Therefore, what we have to do is to recover the calculations of Sect.8.4 and solve
Eq. (8.67) with a H given in the radiation- and matter-dominated epoch. As we
already know, on very large scales, meaning k2 ≪a′′/a, h is a constant (we shall

9.6 The Transfer Function for Tensor Perturbations
303
call it hP) and this holds true for whatever background expansion we choose. We
used this fact in order to determine the primordial power spectrum and in the present
section we use it again to determine the initial value for solving Eq.(8.67).
Using Eqs.(9.40) and (9.41), we can write the conformal Hubble parameter as
follows:
H = Heq
√1 + y
√
2y
,
(9.119)
where we have introduced again y ≡ρm/ρr as new independent variable.
Exercise 9.19 Cast Eq.(8.67) using y as independent variable and the above form
of the conformal Hubble factor. Show that:
(1 + y)d2h
dy2 +
1
2 + 2(1 + y)
y
 dh
dy + κ2h = 0
(9.120)
using also Eq.(9.100).
The above equation cannot be solved analytically, but we can ﬁnd an exact solution
in the same four instances that we worked out for scalar perturbations. On super-
horizon scales we already know that h = hP irrespective of the background evolution
(this is relevant only for the decaying mode), so we skip this case.
9.6.1
Radiation-Dominated Epoch
In this case, we consider y ≪1 in Eq.(9.120):
d2h
dy2 + 2
y
dh
dy + κ2h = 0 ,
(9.121)
which can be rewritten as:
d2(κhy)
d(κy)2 + κhy = 0 ,
(9.122)
and hence is a harmonic oscillator equation for the quantity κhy with respect to the
variable κy, with unitary frequency. Hence, the solution for h is:
h(k, y) = C1(k)sin(κy)
κy
+ C2(k)cos(κy)
κy
,
(9.123)

304
9
Evolution of Perturbations
where as usual C1 and C2 are generic k-dependent functions. For y →0, or equiv-
alently on very large scales κy →0 only the sine tends to a ﬁnite result and hence
we must put C2 to zero:
h(k, y) = hP(k)sin(κy)
κy
= hP(k) j0(κy) .
(9.124)
Equivalently, putting H = 1/η into the original equation (8.67) one ﬁnds:
h′′ + 2
η h′ + k2h = 0 ,
(9.125)
and so:
h(k, η) = hP(k)sin(kη)
kη
= hP(k) j0(kη) ,
(9.126)
since, indeed, κy = kη when radiation dominates, cf. Eq.(9.102).
9.6.2
Matter-Dominated Epoch
In this case, we consider y ≫1 in Eq.(9.120):
y d2h
dy2 + 5
2
dh
dy + κ2h = 0 ,
(9.127)
or, using Eq.(8.67) with H = 2/η:
h′′ + 4
η h′ + k2h = 0 .
(9.128)
This equation can be cast in the form of a Bessel equation.
Exercise 9.20 Introduce the new function:
h ≡g(kη)α,
(9.129)
where α is a number to be determined. Then, show that:
η2g′′ + (2α + 4)ηg′ + g[k2η2 + α2 + 3α] = 0 .
(9.130)
Then, we recover the form of the Bessel function for α = −3/2, for which the
order is 3/2 and hence:

9.6 The Transfer Function for Tensor Perturbations
305
g ∝J3/2(kη) =

2kη
π j1(kη) ,
(9.131)
where we have introduced the spherical Bessel function and neglected the one of
second kind, since it diverges for kη →0. The GW amplitude thus evolves as:
h(k, η) = C1(k) j1(kη)
kη
= C1(k)
sin(kη)
(kη)3 −cos(kη)
(kη)2

.
(9.132)
In the limit kη →0:
sin(kη)
(kη)3 −cos(kη)
(kη)2
→1
3 ,
(9.133)
hence we can write:
h(k, η) = 3hP(k)
sin(kη)
(kη)3 −cos(kη)
(kη)2

,
(9.134)
but this is valid only for those modes which enters the horizon well deep into the
matter-dominated epoch. Using the deﬁnition of κ in Eq.(9.100) and the fact that,
deep in the matter-dominated epoch we have that:
H = 2
η = Heq
√2y ,
(9.135)
we can conclude that:
kη = 2κ√y ,
(9.136)
and thus the solution for h(k, y) is:
h(k, y) = 3hP(k)
4
sin(2κ√y)
2(κ√y)3 −cos(2κ√y)
(κ√y)2

,
(9.137)
which again is valid only for those modes κ√y ≪1 and hence, since y ≫1, then
κ ≪1, i.e. modes which entered the horizon well deep into the matter-dominated
epoch.
9.6.3
Deep Inside The Horizon
In the case k ≫H we work directly on Eq.(8.67) and, following Weinberg (2008),
we introduce a new variable
x ≡
 dη
a2 ,
(9.138)

306
9
Evolution of Perturbations
with the purpose of eliminating the ﬁrst-order derivative, and obtain thus the follow-
ing equation:
d2h
dx2 + k2a4h = 0 .
(9.139)
The latter is not analytically solvable for a generic a(x) but it is possible to ﬁnd an
approximated, WKB solution. Indeed, if a(x) is approximately constant, the above
equation becomes that of a harmonic oscillator and the solution is simply:
h(k, x) ∝e±ika2 .
(9.140)
Taking into account the x dependence of a, we can use the following ansatz:
h(k, x) = A(x) exp

±ik

a2dx

,
(9.141)
and substitute it back into Eq.(9.139), obtaining:
d2 A
dx2 + 2d A
dx (±ika2) + A

±2ika da
dx

+ k2a4 A = 0 .
(9.142)
Equating the imaginary part to zero, we have then:
d A
dx a2 + Aa da
dx = 0 ,
(9.143)
for which the solution is:
A(x) ∝1/a(x) .
(9.144)
Hence, the approximated WKB solution for the GW is:
h(k, η) ∝1
a exp

±ik

a2dx

= 1
a exp (±ikη) .
(9.145)
Note that this solution is valid for any background expansion, since we have made
no assumptions on the latter. Moreover, note the oscillatory behaviour exp (±ikη)
with amplitude damped with a factor 1/a. Recall from Weinberg (1972) that the
energy-momentum tensor of a GW is:
⟨tμν⟩= pμ pν
16πG

|h+|2 + |h×|2
,
(9.146)
where tμν is the gravitational pseudo-tensor, the average on it is on a sufﬁciently large
region of spacetime such that the oscillatory terms gives a constant result and pμ is
the physical momentum pμ = dxμ/dλ of the GW (of the graviton). We now that in

9.6 The Transfer Function for Tensor Perturbations
307
a FLRW metric for a massless particle p0 = p ∝1/a and hence ⟨t00⟩∝1/a4 as we
expected for the energy density of a relativistic species.
Now, we can match the above WKB solution (for y ≪1) with the one we found in
Eq.(9.126) (for large κy), where we use y instead of η because it is straightforward
then to project the matching at late times. It is the same procedure we employed in
order to ﬁnd the transfer function for CDM. So, we have:
C1(k)
yaeq
sin(κy) = hP(k)sin(κy)
κy
,
(9.147)
and thus
C1(k) = hP(k)aeq
κ = hP(k)aeqH0m0
k√r0
= hP(k) H0
√r0
k
.
(9.148)
So, the solution for small scales is:
h(k, η) = hP(k) H0
√r0
ka(η)
sin(kη)
(9.149)
Note that this solution is valid for any content of the universe, since there is no
more a y dependence appearing (any content after radiation-domination, since we
have matched there the solutions). Close to the present time η0 we can set as usual
a(η0) = 1 and then the gravitational wave solution for small scales is then:
h(k, t) = hP(k) H0
√r0
k
sin [kη0 + k(t −t0)]
(9.150)
for t close to t0 and where we have used dη = dt/a(t) close to present time. This GW
proﬁle is very different from those detected by LIGO for the merging of black holes,
the ﬁrst in Abbott et al. (2016), and from the spectacular event GW170817 of the
merging of two neutron stars detected both by LIGO and VIRGO (Abbott et al. 2017)
and whose electromagnetic counterpart was also seen as a short gamma-ray burst
(GRB) (Abbott et al. 2017). The main characteristics of these proﬁles is their growth
in frequency and amplitude for times close to the merging one. The cosmological GW
proﬁle is a simple sine function (for very small scales), with an amplitude containing
cosmological information of great relevance such as the primordial amplitude, which
we have seen to be related to the energy scale of inﬂation.

308
9
Evolution of Perturbations
References
Abbott, B., et al.: GW170817: observation of gravitational waves from a binary neutron star inspiral.
Phys. Rev. Lett. 119(16), 161101 (2017)
Abbott, B.P., et al.: Observation of gravitational waves from a binary black hole merger. Phys. Rev.
Lett. 116(6), 061102 (2016)
Abbott, B.P., et al.: Multi-messenger observations of a binary neutron star merger. Astrophys. J.
848(2), L12 (2017)
Abramowitz, M., Stegun, I.A.: Handbook of Mathematical Functions with Formulas, Graphs, and
Mathematical Tables. Dover, New York (1972)
Bardeen, J.M., Bond, J.R., Kaiser, N., Szalay, A.S.: The statistics of peaks of Gaussian random
ﬁelds. Astrophys. J. 304, 15–61 (1986)
Dodelson, S.: Modern Cosmology. Academic Press, Amsterdam (2003)
Efstathiou, G., Sutherland, W.J., Maddox, S.J.: The cosmological constant and cold dark matter.
Nature 348, 705–707 (1990)
Eisenstein, D.J., Hu, W.: Baryonic features in the matter transfer function. Astrophys. J. 496, 605
(1998)
Kaiser, N.: On the spatial correlations of Abell clusters. Astrophys. J. 284, L9–L12 (1984)
Kodama, H., Sasaki, M.: Cosmological perturbation theory. Prog. Theor. Phys. Suppl. 78, 1–166
(1984)
Maddox, S.J., Efstathiou, G., Sutherland, W.J., Loveday, J.: Galaxy correlations on large scales.
Mon. Not. R. Astron. Soc. 242, 43–49 (1990)
Meszaros, P.: The behaviour of point masses in an expanding cosmological substratum. Astron.
Astrophys. 37, 225–228 (1974)
Mukhanov,V.: Physical FoundationsofCosmology.Cambridge UniversityPress,Cambridge (2005)
Mukhanov, V.F., Feldman, H.A., Brandenberger, R.H.: Theory of cosmological perturbations. Part
1. Classical perturbations. Part 2. Quantum theory of perturbations. Part 3. Extensions. Phys.
Rept. 215, 203–333 (1992)
Percival, W.J., et al.: The shape of the SDSS DR5 galaxy power spectrum. Astrophys. J. 657,
645–663 (2007)
Piattella,O.F.,Martins,D.L.A.,Casarini,L.:Sub-horizonevolutionofcolddarkmatterperturbations
through dark matter-dark energy equivalence epoch. JCAP 1410(10), 031 (2014)
Weinberg, S.: Gravitation and Cosmology: Principles and Applications of the General Theory of
Relativity. Wiley, New York (1972)
Weinberg, S.: Cosmological ﬂuctuations of short wavelength. Astrophys. J. 581, 810–816 (2002)
Weinberg, S.: Cosmology. Oxford University Press, Oxford (2008)
Zeldovich, Y.B.: Structure of the Universe. Astrophys. Space Phys. Rev. 3, 1 (1984)

Chapter 10
Anisotropies in the Cosmic Microwave
Background
Long the realm of armchair philosophers, the study of the
origins and evolution of the universe became a physical science
with falsiﬁable theories
Wayne Hu, PhD Thesis
In this chapter we attack the hierarchy of Boltzmann equations that we have found
for photons and present an approximate, semi-analytic solution which will allow
us to understand the temperature correlation in the CMB sky and its relation with
the cosmological parameters. Our scope is to understand the features of the angular,
temperature-temperature power spectrum in Fig. 10.1.
Note that in this plot the deﬁnition
DT T
ℓ
≡ℓ(ℓ+ 1)CT T,ℓ
2π
,
(10.1)
is used. We shall see the reason for the ℓ(ℓ+ 1) normalisation, whereas the CT T,ℓ’s
are given in Eq. (7.81) as functions of the multipole moments of the temperature
distribution and the primordial power spectrum for scalar perturbations.
In Fig. 10.1 we can also see data points up to ℓ≈2500. What can we say from
this number about the angular sensitivity of Planck? It can be roughly computed as
follows. For a given ℓmax how many realisations of aℓm do we have?
Exercise 10.1 For each ℓwe have 2ℓ+ 1 possible values of m, thus show that:
Nℓmax =
ℓmax

ℓ=0
(2ℓ+ 1) = (ℓmax + 1)2 .
(10.2)
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_10
309

310
10
Anisotropies in the Cosmic Microwave Background
Fig. 10.1 CMB TT
spectrum. Figure taken from
Ade et al. (2016). The red
solid line is the best ﬁt
CDM model
The full sky has:
4π rad2 = 4
π (180 deg)2 ≈41000 deg2 .
(10.3)
If an experiment has sensitivity of 7 deg, then we can have at most
4
π (180/7)2 ≈842 ,
(10.4)
pieces of independent information and therefore we can determine as many aℓm.
This gives ℓmax ≈28 and it was the sensitivity of CoBE. For Planck, the angular
sensitivity was of 5 arcmin, which corresponds to
4
π (180 × 60/5)2 ≈106 ,
(10.5)
pieces of independent information and then to ℓmax = 2436.
In this chapter we omit the superscript S referring to the scalar perturbations
contribution to , since most of the time we shall discuss of it. We shall only use T
in order to distinguish the tensor contribution.
10.1
Free-Streaming
It is convenient to start neglecting the collisional term in the Boltzmann equation and
considering thus the phase of photon free-streaming. The following discussion is
similar to the one in Sect. 5.4. Consider Eq. (5.27) for photons and with no collisional
term. Using the deﬁnition of  in Eq. (5.80), we can write for scalar perturbations:

10.1 Free-Streaming
311
 ∂
∂η + dxi
dη
∂
∂xi

( + ) = ′ −′ .
(10.6)
As we know from Boltzmann equation, the differential operator on the left hand side
is a convective derivative, i.e. a derivative along the photon path:
d
dη ( + ) = ′ −′ ,
(10.7)
whose inversion is the basis of the line-of-sight integration approach to CMB
anisotropies (Seljak and Zaldarriaga 1996), which is an alternative to attacking the
hierarchy of coupled Boltzmann equations (which still must be attacked but can be
truncated at much lower ℓ’s) as it was done e.g. in Ma and Bertschinger (1995). We
shall see this technique in some detail in Sect. 10.5.
For time-independent potentials, as they are in the matter-dominated epoch, the
collisionless Boltzmann equation for photons tells us that  +  is constant along
the photons paths, i.e. along our past light-cone, since recombination.
Recall that the scalar-perturbed metric that we are using is given in Eq. (4.171):
ds2 = −a2(η)(1 + 2)dη2 + a2(η)(1 + 2)δi jdxidx j .
(10.8)
Inside a potential well,  is negative. In order to be convinced of this one has just to
think about the Newtonian limit and realise that 2 is the Newtonian gravitational
potential, hence negative. So, since  +  stays constant, we have that:
(η∗, x∗, ˆp) + (η∗, x∗) = (η0, x0, ˆp) + (η0, x0) .
(10.9)
where on the left hand side we have chosen the quantities at recombination whereas
on the right hand side we have chosen the present time. Note that x0, is where our
laboratory (the CMB experiment) is, i.e. Earth, and as such is ﬁxed. Therefore, since
we can only detect photons on our past light-cone, and those from CMB comes from
a ﬁxed comoving distance r∗= η0 −η∗, we have that:
x∗= x0 −r∗ˆp .
(10.10)
Note that ˆp is the photon direction and so it is opposite to the direction of the line of
sight ˆn = −ˆp. So, the only independent variables are 2, the components of ˆp. They
become just a single one, μ, because of the way in which we factorise the azimuthal
dependence (and assuming axial symmetry).
The potential (η0, x0) is usually neglected, or incorporated in the potential at
recombination, since it is not detectable. As it is well known, classically only potential
differences are physically meaningful. The above equation then tells us that:
(η∗, x0 −r∗ˆp, ˆp) + (η∗, x0 −r∗ˆp) = (η0, x0, ˆp) ,
(10.11)

312
10
Anisotropies in the Cosmic Microwave Background
i.e. the observed temperature ﬂuctuation (on the right hand side) accounts for the
energy loss due to climbing out the potential well or falling down a potential hill.
This is the so-called Sachs-Wolfe effect (Sachs and Wolfe 1967). Writing the above
equation in Fourier modes, we have:

d3k
(2π)3 (η0, k, ˆp)eik·x0 =

d3k
(2π)3

(η∗, k, ˆp) + (η∗, k)

eik·(x0−r∗ˆp) .
(10.12)
We can set now x0 = 0, without losing of generality, and manifest the dependences
as k and μ, the former since we normalise to the scalar primordial mode α(k), cf.
Eq. (7.64), and the latter since we are considering axisymmetric scalar perturbations.
Hence we have for the Fourier modes:
(η0, k, μ) = [(η∗, k, μ) + (η∗, k)] e−ikμr∗.
(10.13)
Using the partial wave expansion, we get:
ℓ(η0, k) =
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ) [(η∗, k, μ) + (η∗, k)] e−ikμr∗,
(10.14)
and using the relation:
 1
−1
dμ
2 Pℓ(μ)e−ikμr∗= (−i)ℓjℓ(kr∗) ,
(10.15)
which can be obtained by inverting the expansion of Eq. (5.75), we can write:
ℓ(η0, k) = (η∗, k) jℓ(kr∗) +
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)(η∗, k, μ)e−ikμr∗.
(10.16)
Using again the partial wave expansion, we can write the above formula as:
ℓ(η0, k) = (η∗, k) jℓ(kr∗)
+
1
(−i)ℓ

ℓ′
(−i)ℓ′(2ℓ′ + 1)ℓ′(η∗, k)
 1
−1
dμ
2 Pℓ(μ)Pℓ′(μ)e−ikμr∗. (10.17)
We shall see later that, because of tight-coupling, the monopole and the dipole con-
tribute the most at recombination. Hence, we can write, truncating the summation at
ℓ′ = 1:
ℓ(η0, k) = (0 + ) (η∗, k) jℓ(kr∗) + 31(η∗, k)
(−i)ℓ−1
 1
−1
dμ
2 Pℓ(μ)μe−ikμr∗.
(10.18)
The integral can be performed as follows:

10.1 Free-Streaming
313
 1
−1
dμ
2 Pℓ(μ)μe−ikμr∗= i
d
d(kr∗)
 1
−1
dμ
2 Pℓ(μ)e−ikμr∗=
1
iℓ−1
d
d(kr∗) jℓ(kr∗) .
(10.19)
The same technique can be used, in principle, to calculate the integral for any ℓ′: for
each power of μ one gains a derivative of the spherical Bessel function. Recalling
the formula (Abramowitz and Stegun 1972)1:
djℓ(x)
dx
= jℓ−1(x) −ℓ+ 1
x
jℓ(x) ,
(10.20)
we can write:
ℓ(η0, k) = (0 + ) (η∗, k) jℓ(kr∗)
+31(η∗, k)

jℓ−1(kr∗) −ℓ+ 1
kr∗
jℓ(kr∗)
	
.
(10.21)
So, the spherical Bessel functions that we have mentioned in Chap. 9 start to appear.
We have obtained the above free-streaming solution neglecting the potentials deriva-
tives in Eq. (10.7). Taking them into account is not difﬁcult, since an additional piece
containing the integration of the potential derivatives would appear in Eq. (10.13):
(η0, k, μ) = [(η∗, k, μ) + (η∗, k)] e−ikμr∗+
 η0
η∗
dη (′ −′)(η, k)e−ikμ(η0−η) .
(10.22)
The exponential factor in the integral comes from the Fourier transform of the poten-
tials and from considering:
x = x0 −(η0 −η) ˆp ,
(10.23)
at any given time η along the photon trajectory (this is the “line of sight”, in practice).
Performing again the expansion in partial waves, we get:
ℓ(η0, k) = (0 + ) (η∗, k) jℓ(kr∗)
+31(η∗, k)

jℓ−1(kr∗) −ℓ+ 1
kr∗
jℓ(kr∗)
	
+
 η0
η∗
dη [′(η, k) −′(η, k)] jℓ(kr) ,
(10.24)
where
r ≡η0 −η .
(10.25)
As we are going to see, the ﬁrst two terms of the above formula contains the primary
anisotropies of the CMB, which are the acoustic oscillations and the Doppler
effect. The (η∗, k) contribution in the ﬁrst term is, as we have already anticipated,
1The website http://functions.wolfram.com is also very useful.

314
10
Anisotropies in the Cosmic Microwave Background
Fig. 10.2 Evolution of the
spherical Bessel function
j2
10(x)
the Sachs-Wolfe effect. The last term is the Integrated Sachs-Wolfe (ISW) effect
(Sachs and Wolfe 1967) and contributes only when the gravitational potentials are
time-varying. This happens, as we have seen in Chap.9, when radiation and DE are
relevant. For this reason the ISW effect is usually separated in the early-times one,
due to a small presence of radiation still at decoupling, and in the late-times one, due
to DE.
Once we know all the contributions of the above formula, we can use Eq. (7.81)
and provide the prediction on the C S
T T,ℓspectrum.
The presence of the spherical Bessel function is interesting for two reasons, which
we display in Fig. 10.2 for the arbitrary choice ℓ= 10.
We have chosen to plot the squared spherical Bessel function because it is the
relevant window function when computing the Cℓ’s, as we shall see brieﬂy. First, the
maximum value is attained roughly when x ≈ℓand for x < ℓthe spherical Bessel
function is practically vanishing. Therefore, for a given multipole ℓthe scale which
contribute most for the observed anisotropy is:
k ≈
ℓ
η0 −η∗
.
(10.26)
We have anticipated this already in Chap. 9. The second reason of interest is that the
spherical Bessel function goes to zero for large x. This means that scales such that
kr∗≫1 do not contribute to the observed anisotropy. Physically, this is an effect due
to the free-streaming phase for which, on very small scales, hot and cold photons
mix up destroying thus the anisotropy.
We have thus seen that the predicted anisotropy today is given by formula
Eq. (10.24). We have now to justify the fact of considering only the monopole and
the dipole at recombination. We shall commence in the next section discussing very
large scales.
In principle, Eq. (10.24) has the very same form for neutrinos, but with an initial
conformal time ηi which is well anterior to η∗, since neutrinos do not interact and
therefore they only free-stream (at least for temperatures of the primordial plasma
below 1 MeV).

10.2 Anisotropies on Large Scales
315
10.2
Anisotropies on Large Scales
On large scales, i.e. kη ≪1, the relevant equations are those of Chap. 6, which we
report here:
δ′
γ = −4′ ,
δ′
ν = −4′ ,
δ′
c = −3′ ,
δ′
b = −3′ ,
(10.27)
i.e. only the monopoles are relevant. Since we want to describe CMB, let us focus
on the photon density contrast, which can be written as:
δγ(k, η) = 40(k, η) ,
(10.28)
introducing the monopole of the temperature ﬂuctuation. The equation ′
0 = −′
can be immediately integrated, obtaining:
0(k, η) = −(k, η) + Cγ(k) .
(10.29)
For the adiabatic primordial mode, the only which we are going to consider, we know
from Eq. (6.94) that Cγ(k) = P(k) −P(k)/2 and thus:
0(k, η) = −(k, η) + P(k) −1
2P(k) .
(10.30)
As we know from Chap. 9, we can consider the gravitational potentials to be equal in
modulus and on large scales (k, η) is independent of time and since recombination
η∗≫ηeq takes place well after radiation-matter equality, we know that (k, η∗) =
9P(k)/10, i.e. the value of the gravitational potential drops of 10% in passing
through radiation-matter domination. Therefore:
0(k, η∗) = 3
5P(k) = 2
3(k, η∗) = −2
3(k, η∗) .
(10.31)
As we saw earlier in Eq. (10.24), the observed anisotropy is not 0(k, η∗) but
0(k, η∗) + (k, η∗), because of the gravitational redshift. Again, this is the Sachs-
Wolfe effect, amounting to a shift in the photons frequency when they decouple from
the baryonic plasma depending whether they are in a well or hill of the gravitational
potential. So, we have from Eq. (10.31) that:
(0 + )(k, η∗) = 1
3(k, η∗) .
(10.32)
On the other hand, for δc we know that
δc(k, η) = −3(k, η) + 9P(k)
2
,
(10.33)

316
10
Anisotropies in the Cosmic Microwave Background
again assuming adiabatic primordial modes. Using again (k, η∗) = 9P(k)/10, we
get:
δc(k, η∗) = 2(k, η∗) = −2(k, η∗) .
(10.34)
The ﬂuctuations in CDM contribute more in generating the potential wells than
photons, a factor 2 against a factor −2/3. Combining the two equations:
(0 + )(k, η∗) = −δc(k, η∗)
6
(10.35)
This result tells us that on large scales colder spots represent larger overdensities, a
counter-intuitive result. One expects hotter photons the deeper the well is and in fact
this is the case with just 0(k, η∗), since we have:
0(k, η∗) = −2
3(k, η∗) = δc(k, η∗)
3
,
(10.36)
i.e. the larger the CDM overdensity, the larger the well and 0(k, η∗) are. However,
photons’ response to the gravitational potential is only a factor −2/3 whereas the
gravitational redshift adds a  contribution, changing thus the sign of the observed
anisotropy. In the limit of δc →−1, one gets (0 + )(k, η∗) →1/6, so cosmic
voids correspond to hot spots!
The results found here are valid only on large scales, i.e. for kη∗≪1, scales much
larger than the horizon at recombination, which has an angular size of approxima-
tively 1 degree. Moreover, they also depend on the choice of initial conditions. We
have opted for the adiabatic ones, as usual.
Exercise 10.2 Reproduce the above argument for the other primordial modes.
Let us use the theoretical prediction on the C S
T T,ℓgiven in Eq. (7.81) together with
the ﬁrst contribution only from Eq. (10.24). The latter approximation is justiﬁed
by the fact that we are considering large scales, hence the dipole contribution is
negligible and the ISW effect is vanishing because the potentials are constant. Since:
(0 + )(k, η∗) = 1
3(k, η∗) = −1
3(k, η∗) = −3
10P(k) = −1
5R(k) ,
(10.37)
the transfer function is just the constant −1/5 (recall that we are neglecting the
neutrino fraction Rν) and thus the angular power spectrum is:
C S
T T,ℓ(SW) = 4π
25
 ∞
0
dk
k 2
R(k) j2
ℓ(kη0) ,
(10.38)

10.2 Anisotropies on Large Scales
317
since η∗≪η0. Note that kη∗≪kη0 and we have seen in Fig. 10.2 that the spherical
Bessel function contributes the most about kη0 ≈ℓ. Thus, for small ℓ, i.e. large
angular scales, kη0 is small and kη∗is very small, where in fact | (0 + ) (k, η∗)|2
is constant. In other words, the above approximation is valid for small ℓ, typically
ℓ≲30.
In the above integral we can look at j2
ℓ(kη0) as a very peaked window function
and approximate it as:
C S
T T,ℓ(SW) ≈4π
25 2
R(ℓ/η0)
 ∞
0
dk
k j2
ℓ(kη0) .
(10.39)
Using the result:
 ∞
0
dx
x j2
ℓ(x) =
1
2ℓ(ℓ+ 1) ,
(10.40)
we have then:
ℓ(ℓ+ 1)C S
T T,ℓ(SW)
2π
≈1
252
R(ℓ/η0) .
(10.41)
Hence, for a scale-invariant spectrum nS = 1 the combination ℓ(ℓ+ 1)C S
T T,ℓ(SW) is
constant and it is called Sachs-Wolfe plateau. This also explains why CMB power
spectra are usually presented with the ℓ(ℓ+ 1) normalisation, as in Fig. 10.1.
If nS ̸= 1, then ℓ(ℓ+ 1)C S
T T,ℓ(SW) is proportional to ℓnS−1, i.e. the primordial
tilt in the power spectrum leaves its mark in a tilted plateau for small ℓ.
10.3
Tight-Coupling and Acoustic Oscillations
We have seen that in order to determine the prediction on the present time CT T,ℓ’s
we need to know what happens at recombination. We devote this section to such
purpose, showing that the monopole and the dipole contribute the most.
Let us recover here the hierarchy of Boltzmann equations for the ℓ’s (not taking
into account polarisation) that we have derived in Chap. 5:
(2ℓ+ 1)′
ℓ+ k[(ℓ+ 1)ℓ+1 −ℓℓ−1] = (2ℓ+ 1)τ ′ℓ,
(ℓ> 2) , (10.42)
10′
2 + 2k (33 −21) = 10τ ′2 −τ ′ , (10.43)
3′
1 + k(22 −0) = k + τ ′ (31 −Vb) , (10.44)
′
0 + k1 = −′ , (10.45)
where recall that δγ = 40 and 31 = Vγ. The best way to deal with these equations
is to solve them numerically by using Boltzmann codes such as CAMB or CLASS,
but in this way the physics behind the CT T,ℓ’s remains hidden or unclear. For this
reason we attack these equations in an approximate fashion, but analytically.

318
10
Anisotropies in the Cosmic Microwave Background
We take the limit −τ ′ ≫H, which is called tight-coupling (TC) approximation.
This limit physically means that the Thomson scattering rate between photons and
electrons is much larger than the Hubble rate until recombination and then drops
abruptly since the free electron fraction Xe goes to zero very rapidly, as we have
seen when studying thermal history in Chap. 3. We shall ﬁrst consider the case of
sudden recombination, where all the photons last scatter at the same time. It is a
fair approximation, though unrealistic.
Exercise 10.3 From the deﬁnition of the optical depth:
τ ≡
 η0
η
dη′ neσTa ,
(10.46)
show that τ ∝1/η3 when matter dominates and τ ∝1/η when radiation dominates.
We can be more quantitative and write:
−τ ′ = neσTa = nbσTa = ρb
mb
σTa ,
(10.47)
where we have used the deﬁnition of τ and assumed to be in an epoch before recom-
bination, so that we can approximate ne with nb, since all the electrons are free.
Exercise 10.4 Introducing the baryon density parameter and using mb = 1 GeV, the
mass of the proton, show that:
−τ ′ ≈1.46 × 10−19 	b0h2
a2
s−1 .
(10.48)
Now we need to compare this scattering rate with the Hubble rate, in order to check
the goodness of the TC approximation. Assuming matter-domination and using the
conformal time Friedmann equation (this because τ ′ is derived with respect to the
conformal time), we have:
H = H0

	m0a−1/2 ≈3.33 × 10−18h

	m0 a−1/2 s−1 .
(10.49)
Therefore, the ratio:
−τ ′
H = 0.044
	b0h2

	m0h2 a−3/2 ,
(10.50)
diverges for a →0 as expected (though the formula should be generalised to the
case of radiation-domination), so if it is sufﬁciently big at recombination then the

10.3 Tight-Coupling and Acoustic Oscillations
319
TC approximation would be reliable. Substituting the Planck values 	b0h2 = 0.022
and 	m0h2 = 0.12 one gets at recombination, i.e. for a = 10−3:
−τ ′
H ≈102 .
(10.51)
This means that the scattering rate is much larger than the Hubble rate even at
recombination as long as there are free electrons around and thus we are going to
use the tight-coupling approximation with reliability.
Let us see in detail how the TC limit works. Let us compare in the hierarchy
for ℓ≥2 the terms ′
ℓand kℓwith τ ′ℓ, which have all the same dimensions of
inverse time. There are two physical time scales in our problem, one is given by the
expansion rate and the other by the scattering rate, hence
′
ℓ∝Hℓ, τ ′ℓ,
(10.52)
from a dimensional analysis. However, the mode for which ′
ℓ∝τ ′ℓimplies that
ℓ∝exp τ and hence diverges at early times, which is unacceptable for a small
ﬂuctuation. We then dismiss this mode as unphysical and take into account just that
for which ′
ℓ∝Hℓ, which is small compared to τ ′ℓ.
Now, let us inspect the ratio
−τ ′
k
.
(10.53)
This is the number of collisions which take place on a scale 1/k. Hence, this number
is very large, provided that we consider sufﬁciently large scales, i.e. small k. If the
scale is too small, i.e. large k, then the TC approximation does not work well and
we must take into account the multipole moments for ℓ≥2. We will see this when
investigating the diffusion damping or Silk damping effect.
From the above analysis, for sufﬁciently large scales we can conclude then that
ℓ≈0 forℓ≥2.Sufﬁcientlylargemeansmuchlargerthanthemeanfreepath−1/τ ′
which is approximately of the order of 10 Mpc at recombination. This number can
be computed from Eq. (10.48) and is a comoving scale; the physical one is divided
by a factor a thousand and so it is 10 kpc.
Finally, note that ℓ∼τ ′/kℓ−1. Therefore, considering smaller and smaller
scales makes necessary to include higher and higher order multipoles.
Eliminating all the multipoles ℓ≥2, the relevant equations are just the following
two:
′
0 + k1 = −′ ,
(10.54)
3′
1 −k0 = k + τ ′ (31 −Vb) ,
(10.55)
i.e. the TC approximation allows us to treat photons as a ﬂuid until recombination.
Note the coupling to baryons via the baryon velocity Vb. Thus, we need also the
equations for baryons:

320
10
Anisotropies in the Cosmic Microwave Background
δ′
b + kVb = −3′ ,
(10.56)
V ′
b + HVb = k + τ ′
R (Vb −31) ,
(10.57)
where we have introduced R ≡3ρb/4ργ, i.e. the baryon density to photon density
ratio. This number can be cast as:
R = 3	b0
4	γ0
a ≈600a ,
(10.58)
using the usual values and it grows from zero at early times to R∗≈0.6 at recombi-
nation. So it is small, but not that negligible. Let us rewrite the velocity equation for
baryons in the following way:
Vb = 31 + R
τ ′

V ′
b + HVb −k

.
(10.59)
We can solve this equation via successive approximation, exploiting the fact that
R < 1 before recombination. That is, assume the expansion:
Vb = V (0)
b
+ RV (1)
b
+ R2V (2)
b
+ · · · .
(10.60)
The solution for R = 0 simply gives V (0)
b
= 31, which we have used in Chap. 6
in order to investigate the primordial modes. This solution is reliable well before
recombination, say at a = 10−7 for example, because R ≈6 × 10−5 there, but it is
not satisfactory at recombination and we shall take into account the ﬁrst order in R
in the above expansion.
10.3.1
The Acoustic Peaks for R = 0
Let us start with the simple case of R = 0, which amounts to neglect baryons.
Exercise 10.5 Combine the photon Eqs. (10.54)–(10.55) with the zeroth-order TC
condition Vb = 31 and ﬁnd the following second-order equation for 0:
′′
0 + k2
3 0 = −k2
3
−′′ .
(10.61)
We have here already the ﬁrst fundamental piece of physics of the CMB. This is
the equation of motion of a driven harmonic oscillator where instead of the position
we have the monopole of the temperature ﬂuctuation and the driving force is given
by the gravitational potential. This equation describe acoustic oscillations of the

10.3 Tight-Coupling and Acoustic Oscillations
321
baryon-photon ﬂuid until recombination. After recombination we expect to observe
these ﬂuctuations in the CT T,ℓ’s, using the free-streaming formula (10.24), and in
fact we do, cf. Fig. 10.1.
Note that these oscillations are in the baryon-photon ﬂuid and therefore affect also
baryons.Wethereforeexpecttoseeoscillationsinthebaryondistributionafterrecom-
bination, called baryon acoustic oscillations (BAO), and detected by Eisenstein and
collaborators in 2005 (Eisenstein et al. 2005). The BAO are the manifestation of a
special length, the sound horizon at recombination, in the correlation function of
galaxies which appears as a bump, i.e. an excess probability. In the Fourier space,
i.e. for the power spectrum, a given scale is represented with various oscillations.
We have already encountered BAO in Chap. 9. BAO and weak gravitational lensing
are among the main observables on which current and future experiments (such as
Euclid and LSST) are based.
Exercise 10.6 Combine Eqs. (10.56) and (10.57) and the TC condition Vb = 31
and ﬁnd the following equation for δb:
δ′
b = 3′
0 .
(10.62)
Hence, the same oscillatory solution of 0 holds true for δb.
Now, consider the fact that close to recombination CDM is already dominating
and thus the potentials are equal and constant at all scales. We get:
′′
0 + k2
3 0 = −k2
3
.
(10.63)
This equation can be put in the following form:
(0 + )′′ + k2
3 (0 + ) = 0 ,
(10.64)
where we have used the constancy of . Note how the observed temperature ﬂuctu-
ation, used in Eq. (10.24), has appeared. The solution is:
(0 + )(η, k) = A(k) sin
 kη
√
3

+ B(k) cos
 kη
√
3

,
(10.65)
with the driving potential, i.e. CDM, providing just an offset for the oscillations. At
recombination we have
(0 + )(η∗, k) = A(k) sin
kη∗
√
3

+ B(k) cos
kη∗
√
3

,
(10.66)

322
10
Anisotropies in the Cosmic Microwave Background
with peaks and valleys in the temperature ﬂuctuations given by this combination of
sine and cosine, therefore dependent on the functions A(k) and B(k). Inserting these
formula into Eq. (10.24) in order to compute the ℓ(η0, k) (the anisotropies today)
and then into Eq. (7.81) in order to compute the CT T,ℓ’s, we are able to explain the
acoustic oscillations feature of the CMB TT spectrum, of Fig. 10.1.
The functions A(k) and B(k) are determined by the initial condition, i.e. for
kη∗≪1:
(0 + )(kη∗≪1) ∼A(k)kη∗
√
3
+ B(k) .
(10.67)
Hence, if we choose adiabatic modes, we must put A(k) = 0. So, considering dif-
ferent initial conditions changes the position of the acoustic peaks and observation
allows to test the choice made. As we saw in Chap. 6, Planck limits the presence of
isocurvature modes to a few percent. With A(k) = 0, i.e. for adiabatic perturbations,
using the large-scale solution that we found in Eq. (10.37), we have:
(0 + )(η∗, k) = −1
5R(k)T (k) cos
kη∗
√
3

,
(10.68)
where T (k) is the transfer function of 0 + . We did not calculate it in Chap. 9,
but it can be shown that it is limited to a range 0.4-2, approximately. See Mukhanov
(2005).
The extrema of the effective temperature ﬂuctuations are thus given by:
kη∗
√
3
= nπ ,
(n = 1, 2, . . . ) ,
(10.69)
where the odd values provide peaks, corresponding to the highest temperature ﬂuc-
tuations and thus to scales at which photons are maximally compressed and hot,
whereas the even values provide throats, corresponding to the lowest temperature
ﬂuctuations and thus to scales at which photons are maximally rareﬁed and cold.
In the spectrum, cf. Fig. 10.1, only peaks appear because of the quadratic nature of
the CT T,ℓ’s as functions of the ℓ’s, but it should be clear that the ﬁrst and the third
peaks are compressional.
From Eqs. (10.54) and (10.68), we can determine easily the dipole contribution:
1(η∗, k) = −′
0(η∗, k)
k
= −1
5
√
3
R(k)T (k) sin
kη∗
√
3

,
(10.70)
where we are still continuing in keeping the potentials constant. Substituting this
equation and Eq. (10.68) into Eq. (10.24) and then into Eq. (7.81) in order to compute
the angular power spectrum, we get:

10.3 Tight-Coupling and Acoustic Oscillations
323
CT T,ℓ= 4π
25
 ∞
0
dk
k 2
R(k)

cos
kη∗
√
3

jℓ(kη0) +
√
3 sin
kη∗
√
3
 djℓ(kη0)
d(kη0)
	2
,
(10.71)
where the derivative of the spherical Bessel function is given in Eq. (10.20). We have
put T (k) = 1 here for simplicity.
We can manipulate analytically this integral following the technique used in
Mukhanov (2004, 2005). In these references, baryon loading and diffusion damping
are taken into account but here we just tackle a simpler case.
The idea is to avoid the oscillatory nature of the Bessel function and of the trigono-
metric ones (which are also problematic from a numerical perspective) by approxi-
mating jℓ(x) as follows, for large ℓ:
jℓ(x) ≈

0 ,
(x < ℓ) ,
1
√x(x2−ℓ2)1/4 cos
√
x2 −ℓ2 −ℓarccos(ℓ/x) −π/4

,
(x > ℓ) .
(10.72)
Thisapproximationisidenticaleitherfor jℓ(x)andfor jℓ−1(x),sinceweareassuming
ℓto be large. Hence, when we deal with the derivative of the spherical Bessel function
in Eq. (10.71), we can factorise a j2
ℓ(x) and we can approximate the squared cosine
coming from the above approximation with its average, i.e. a factor 1/2. We thus
have the following integration:
CT T,ℓ=
2π2
R
25
 ∞
ℓ/η0
dk
k2η0

(kη0)2 −ℓ2

cos
kη∗
√
3

+
√
3

1 −
ℓ
kη0

sin
kη∗
√
3
	2
,
(10.73)
where we have already assumed a scale-invariant spectrum, for simplicity. Using
now the variable
x ≡kη0
ℓ
,
(10.74)
we can write:
ℓ2CT T,ℓ= 2π2
R
25
 ∞
1
dx
x2√
x2 −1

cos (ℓϱx) +
√
3x −1
x
sin (ℓϱx)
	2
, (10.75)
where note the appearance of the factor ℓ2 on the left hand side and we have deﬁned
the quantity:
ϱ ≡
η∗
√
3η0
.
(10.76)
Now, developing the square and using the trigonometric formulae:
cos2 α = 1 + cos 2α
2
,
sin2 α = 1 −cos 2α
2
,
2 sin α cos α = sin 2α ,
(10.77)
we can write:

324
10
Anisotropies in the Cosmic Microwave Background
ℓ2CT T,ℓ= 2π2
R(k)
25
 ∞
1
dx
x2√
x2 −1

x2 + 3(x −1)2
2x2
+ x2 −3(x −1)2
2x2
cos (2ℓϱx) +
√
3(x −1)
x
sin (2ℓϱx)

.
(10.78)
Now, let us treat separately the three integrands. The ﬁrst, non-oscillatory one is
simplest one:
N ≡
 ∞
1
dx
x2√
x2 −1
x2 + 3(x −1)2
2x2
= 3

1 −π
4

,
(10.79)
but also the less interesting. The oscillatory ones can be dealt with following
Mukhanov (2005). Deﬁne:
O1 ≡
 ∞
1
dx
√x −1
x2 −3(x −1)2
2x4√x + 1
cos (2ℓϱx) ,
(10.80)
then solving the problem in Mukhanov (2005, p. 383), we can use the formula:
 ∞
1
dx
√x −1
f (x) cos(bx) ≈f (1)
π
b cos(b + π/4) ,
(10.81)
for large values of b and a slowly varying f (x). A similar result holds true also for
the sine function. Using this formula we have then:
O1 =
1
2
√
2
 π
2ℓϱ cos(2ℓϱ + π/4) ,
(10.82)
whereas for the integral containing the sine:
O2 ≡
 ∞
1
dx
√x −1
√
3(x −1)
x3√x + 1
sin (2ℓϱx) ≈0 ,
(10.83)
since f (1) = 0 here. The contribution O2 comes from the cross product between the
monopole and the dipole terms and it is usually neglected in the calculations. We
have explicitly shown why here. Gathering the N and O1 contributions, we plot the
sum N + O1 in Fig. 10.3.
In order to make this plot, we have used a ∝η2, since we are in the matter-
dominated epoch, and thus we have evaluated ϱ as follows:
ϱ =
η∗
√
3η0
=
1
√3(1 + z∗) =
1
√
3000
≈0.0183 .
(10.84)

10.3 Tight-Coupling and Acoustic Oscillations
325
Fig. 10.3 Sum of the N and
O1 contributions
The agreement between the plots of Figs. 10.1 and 10.3 is poor but at least we have
understood how the acoustic oscillations free-stream until today and are seen in the
CMB TT power spectrum. There are several feature missing in Fig. 10.3: there are
too many peaks, their relative height diminishes too slowly and the overall trend does
not decay as in Fig. 10.1. The reason is that we have neglected baryons and diffusion
damping, which we are going to tackle in the next sections.
10.3.2
Baryon Loading
The oscillations in Eq. (10.64) take place with frequency k/
√
3, i.e. as if the speed
of sound was 1/
√
3, i.e. the speed of sound of a pure photon ﬂuid. We have been too
radical in assuming Vb = 31 in the equation for baryons. In fact we saw that this
assumption is equivalent to say that R = 0, i.e. the baryon density is negligible with
respect to the photon one. That is why photons do not feel baryons at all and baryons
ﬂuctuations oscillate in the same way as photons do.
We now take into account R up to ﬁrst-order. If we consider V (0)
b
= 31 substi-
tuted in Eq. (10.59) we get up to order R:
Vb = 31 + R
τ ′

3′
1 + 3H1 −k

.
(10.85)
Exercise 10.7 Combine the above equation and Eqs. (10.54)–(10.55) in order to
ﬁnd the following second-order equation for 0:
′′
0 + H
R
1 + R ′
0 +
k2
3(1 + R)0 = −k2
3
−′′ −H
R
1 + R ′ .
(10.86)

326
10
Anisotropies in the Cosmic Microwave Background
Now the speed of sound, i.e. the quantity multiplying k2, has been reduced:
c2
s =
1
3(1 + R) .
(10.87)
The extrema of the temperature ﬂuctuation at recombination are now expected to be
slightly changed, since:
kη∗
√3(1 + R) = nπ ,
(n = 1, 2, . . . ) ,
(10.88)
is now the condition deﬁning them. Moreover, baryons are also responsible for the
damping term HR′
0/(1 + R), hence we also expect the extrema to have less and less
amplitude. These features translate, once free-streamed,2 in a relative suppression of
the second peak with respect to the ﬁrst one, as seen in Fig. 10.1.
This effect is due to the baryon loading and it is also called baryon drag. Physi-
cally, baryons are heavy and prevent the oscillations in 0 to be symmetric, favouring
compression over rarefaction. Since R ∝a, then we have that:
R′ = HR .
(10.89)
Let us write Eq. (10.86) in the following form:
 d2
dη2 +
R′
1 + R
d
dη + k2c2
s

(0 + ) = k2
3


1 + R −

.
(10.90)
The above equation cannot be solved analytically, but we can use a semi-analytic
approximation, provided by Hu and Sugiyama (1996). Let us employ the WKB
method and use the following ansatz:
(0 + )(η, k) = A(η)ei B(η,k) ,
(10.91)
where A(η) and B(η, k) are functions to be determined via Eq. (10.90).
Exercise 10.8 Substitute this ansatz into the homogenous part of Eq. (10.90) and
ﬁnd the following couple of equations, by separately equating the real and imaginary
parts to zero:
−A(B′)2 + A′′ +
R′
1 + R A′ + k2c2
s A = 0 ,
(10.92)
2B′A′ + AB′′ +
R′
1 + R AB′ = 0 .
(10.93)
2To “free-stream” means to calculate the CT T,ℓ’s weighting the solution at recombination with the
spherical Bessel function of Eq. (10.24).

10.3 Tight-Coupling and Acoustic Oscillations
327
In the ﬁrst equation, let us neglect the second and the third term with respect to the
ﬁrst one. That is, the oscillations provide almost at any time (except at the extrema)
a much larger derivative than that of the amplitude or R. Then, the ﬁrst equation is
readily solved as:
B(η, k) = k
 η
0
cs(η′)dη′ ≡krs(η)
(10.94)
where in the last step we have deﬁned the sound horizon, i.e. the conformal distance
travelled by a sound wave propagating in the baryon photon ﬂuid. When evaluated
at recombination, rs(η∗) = 150 Mpc and this scale is fundamental for BAO, making
them standard rulers.
Exercise 10.9 Determine now A(η). Show that the above equations, together with
the found solution for B(η, k), can be cast as:
A′
A = −1
4
R′
1 + R ,
(10.95)
which gives:
A(η) = (1 + R)−1/4 .
(10.96)
The general, approximate, solution of the homogeneous equation is then:
(0 + )(η, k) =
1
(1 + R)1/4 [C(k) sin(krs) + D(k) cos(krs)]
(10.97)
The condition |A′|, R′ ≪|B′|, which was employed in order to ﬁnd the above solu-
tion, can be checked as follows:
R′
4(1 + R)5/4 , R′ ≪
k
√3(1 + R) ,
(10.98)
which essentially amounts to say that:
k ≫R′ ,
(10.99)
i.e. the solution found is good on sufﬁciently small scales. Since R′ = HR ∼R/η,
we must have that kη ≫R. Since R is pretty small, being at most R∗≈0.6 at
recombination, this condition means any scale at early times, but sub-horizon scales
at recombination.

328
10
Anisotropies in the Cosmic Microwave Background
Equation (10.97) gives us the general solution of the homogeneous part of
Eq. (10.90). In order to ﬁnd the general solution of the full equation we need to
ﬁnd a particular solution of Eq. (10.90). This can be obtained via Green’s functions
method, which we recall in Chap. 12. Let us deﬁne, in order to keep a more compact
notation, the independent solutions of the homogeneous equation that we have just
found in Eq. (10.97) as follows:
S1(η, k) ≡
1
(1 + R)1/4 sin(krs) ,
S2(η, k) ≡
1
(1 + R)1/4 cos(krs) .
(10.100)
Taking into account the non-homogeneous term, the general solution of Eq. (10.90)
is:
(0 + )(η, k) = C(k)S1 + D(k)S2 + k2
3
 η
0
dη′
 (η′)
1 + R −(η′)
	
G(η, η′) ,
(10.101)
where G(η, η′) is the Green’s function.
Exercise 10.10 As done in Chap. 12, cf. Eq. (12.121), determine the Green’s func-
tion:
G(η, η′) = S1(η′)S2(η) −S1(η)S2(η′)
W(η′)
,
(10.102)
using the homogeneous solution. Show that:
G(η, η′) =
1
√1 + R)
sin[krs(η′) −krs(η)]
W(η′)
,
(10.103)
and
W(η′) = −
1
√
3(1 + R)
.
(10.104)
We are omitting the k-dependence for simplicity.
With the above results we can write:
(0 + )(η, k) = C(k)S1 + D(k)S2
+ k
√
3
 η
0
dη′

(η′)
1 + R(η′) −(η′)
	 
1 + R(η′) sin[krs(η) −krs(η′)] . (10.105)
For the primordial modes, in the limit kη →0, one gets at the dominant order:
(0 + )(0, k) = D(k) .
(10.106)

10.3 Tight-Coupling and Acoustic Oscillations
329
Hence, it is the adiabatic mode which multiplies the cosine. Since sine and cosine
have a π/2 phase difference, the effect of different initial conditions is to change the
scales for which the effective temperature ﬂuctuations is maximum or minimum and
hence the positions of the peaks in the CT T,ℓ’s.
In the adiabatic case, we have:
(0 + )(η, k) = (0 + )(0, k)cos[krs(η)]
(1 + R)1/4
+ k
√
3
 η
0
dη′
 (η′)
1 + R −(η′)
	 √
1 + R sin[krs(η) −krs(η′)]
(10.107)
This is the semi-analytic (semi because the integral has to be performed numerically)
formula of Hu and Sugiyama (1996).
The above solution (10.107) can also be used for baryons. Indeed, combining
Eq. (10.56) with Eq. (10.85) and then with Eq. (10.54) we get:
δ′
b = 3′
0 + 3R
τ ′

′′
0 + ′′ + H(′
0 + ′) + k2
3
	
.
(10.108)
Eliminating the second derivative by means of the differential equation (10.90), we
have:
δ′
b = 3′
0 +
R
τ ′(1 + R)

−k20 + 3H(′
0 + ′)

.
(10.109)
Just to make a rough estimative, let us neglect the second contribution (which is
divided by τ ′ anyway which is much larger than H and also than k, for suitable
scales) and use the homogeneous part of Eq. (10.107). It is straightforward then to
integrate δ′
b and obtain at recombination:
δb(η∗, k) ∝cos[krs(η∗)] = cos

2πrs(η∗)
λ
	
.
(10.110)
So the scale rs(η∗) ≈150 Mpc is relevant for baryons, too. Indeed, at about this scale
the matter power spectrum display the BAO feature, as we saw in Chap. 9.
10.4
Diffusion Damping
In order to understand what happens to the CT T,ℓ’s when ℓgrows larger and larger we
need to take into account smaller and smaller scales, because of the relation ℓ≈kη0.
As discussed earlier, for larger and larger k the ratio −τ ′/k becomes smaller and
smaller and so the TC approximation must be relaxed.

330
10
Anisotropies in the Cosmic Microwave Background
In this section then we investigate what happens to the temperature ﬂuctuations
when the quadrupole moment 2 is taken into account. Since this analysis accounts
forthebehaviorofverysmallscaleswhichenteredthehorizondeepintotheradiation-
dominated epoch, we can neglect the gravitational potentials since these, as we saw
in Chap. 9, rapidly decay.
Moreover, being deep into the radiation-dominated epoch, we can also neglect R
and thus take 31 = Vb. Neglecting also polarisation, we have the following set of
three equations for 0, 1 and 2:
′
0 + k1 = 0 ,
(10.111)
3′
1 + 2k2 −k0 = 0 ,
(10.112)
10′
2 −4k1 = 9τ ′2 .
(10.113)
In the last equation we can neglect ′
2 with respect τ ′2, as we already did earlier,
and then ﬁnd:
2 = −4k
9τ ′ 1 .
(10.114)
The minus sign might ring some alarm, but recall that τ ′ is always negative by
deﬁnition.
Exercise 10.11 Combine the above condition with the remaining equations in order
to ﬁnd a closed equation for 0:
′′
0 +

−8k2
27τ ′

′
0 + k2
3 0 = 0
(10.115)
This is the equation for an harmonic oscillator that we have already found earlier
in Eq. (10.64), only that now there appears a damping term which is relevant on small
scales, i.e. when k ∼−τ ′. Baryons also provide a damping term, cf. Eq. (10.86), but
they are irrelevant in the present case since we set R = 0.
This damping term here depends on 2 and is time-dependent. Let us consider it
constant and assume a solution of the type 0 ∝exp(iωη). Substituting this ansatz
in the equation, we ﬁnd:
−ω2 +

−8k2
27τ ′

iω + k2
3 = 0 .
(10.116)
The frequency must have an imaginary part, which accounts for the damping, thus
let us stipulate:
ω = ωR + iωI ,
(10.117)

10.4 Diffusion Damping
331
Exercise 10.12 Substitute this ansatz in the equation and ﬁnd:
ωR =
k
√
3
,
ωI = −4k2
27τ ′ .
(10.118)
Hence, we can write the general solution for 0 as:
0 ∝eikη/
√
3e−k2/k2
Silk ,
(10.119)
where we have introduced the comoving diffusion length, the Silk length, as
λ2
Silk =
1
k2
Silk
≡−4η
27τ ′ .
(10.120)
What does the diffusion length physically represent? It is the comoving distance
travelled by a photon in a time η, but taking into account the collisions which it is
suffering, i.e. its diffusion. Let us see this in some more detail.
Since −τ ′ is the scattering rate, i.e. how many collisions take place per unit
conformal time, then −1/τ ′ is the average conformal time between 2 consecutive
collisions, which for a photon is also the average comoving distance between two
collision, i.e. the mean free path.
Now, we have:
λ2
Silk ∝−η
τ ′ ∝λMFPη ,
(10.121)
where we have used the comoving mean free path, λMFP. Now, multiply and divide
by λMFP and take the square root:
λSilk ∝λMFP

η
λMFP
,
(10.122)
Under the square root we have the comoving distance η divided by the photon comov-
ing mean free path. This gives us the average number of collision N which the photons
experience up to the time η and hence:
λSilk ∝
√
NλMFP ,
(10.123)
which is the typical relation for diffusion. Below this scales λSilk all ﬂuctuations are
suppressed because photons cannot agglomerate since they escape away. This effect
is known as Silk damping (Silk 1967). Therefore, the behaviour of the Cl’s for large
l’s, as seen in Fig. 10.1, is also decaying, though not exactly as in the above solution
since this has to be free-streamed ﬁrst.

332
10
Anisotropies in the Cosmic Microwave Background
We can do a more detailed calculation of the damping scale as follows. Let us
neglect the gravitational potential and the ℓ≥3 multipoles as before, but let us deal
with more care of baryons and take into account polarisation. From Eq. (10.59) we
have:
Vb = 31 + R
τ ′

V ′
b + HVb

,
(10.124)
and the six equations for the monopole, dipole and quadrupole of the temperature
ﬂuctuations and polarisation:
′
0 + k1 = 0 ,
(10.125)
3′
1 + 2k2 −k0 = τ ′(31 −Vb) ,
(10.126)
10′
2 −4k1 = 9τ ′2 −τ ′P0 −τ ′P2 ,
(10.127)
2′
P0 + 2kP1 = τ ′P0 −τ ′P2 −τ ′2 ,
(10.128)
3′
P1 + 2kP2 −kP0 = 3τ ′P1 ,
(10.129)
10′
P2 −4kP1 = 9τ ′P2 −τ ′P0 −τ ′2 .
(10.130)
Now, assuming a solution of the type exp(i

ωdη) for all the above 7 variables and
also assuming that ω ≫H, we have:
Vb =
31
1 + Riωηc
,
(10.131)
where we have deﬁned ηc ≡−1/τ ′ as the the average conformal time between 2
consecutive collisions. We have thus a closed system for 0, 1, 2, P0, P1 and
P2:
iω0 + k1 = 0 ,
(10.132)
−k0 + 3iω1

1 +
R
1 + Riωηc

+ 2k2 = 0 ,
(10.133)
−4kηc1 + (10iωηc + 9)2 −P0 −P2 = 0 ,
(10.134)
−2 + (2iωηc + 1)P0 + 2kηcP1 −P2 = 0 ,
(10.135)
−kP0 + 3(iωηc + 1)P1 + 2kηcP2 = 0 ,
(10.136)
−2 −P0 −4kηcP1 + (10iωηc + 9)P2 = 0 .
(10.137)
We have already arranged the variables in order for the system matrix to appear
clearly. The determinant of this matrix, in order to have a non trivial solution, must
be zero. Considering the limit ωηc ≪1, and keeping the ﬁrst-order only in ωηc we
get:
k2
3 −ω2(1 + R) + 2i
30ωηc

37k2 −285(1 + R)ω2 + 15ω2R2
= 0 .
(10.138)

10.4 Diffusion Damping
333
In order to solve for ω, let us again employ the smallness of ωηc and stipulate that:
ω = ω0 + δω ,
(10.139)
where δω is a small correction. From the above equation is then straightforward to
obtain:
k2
3 −ω2
0(1 + R) = 0 ,
(10.140)
−2ω0δω(1 + R) + 2i
30ω0ηc

37k2 −285(1 + R)ω2
0 + 15ω2
0 R2
= 0 .
(10.141)
The ﬁrst equation gives the result that we have already encountered:
ω2
0 =
k2
3(1 + R) = k2c2
s
(10.142)
which, substituted in the second equation, gives us:
δω =
iηck2
6(1 + R)
16
15 +
R2
1 + R
	
(10.143)
This result was obtained for the ﬁrst time by Kaiser (1983). See also the derivation
of Weinberg (2008).
Therefore, the evolution of the multipoles is proportional to the following factor:
exp

i

ωdη

= eikrs(η)e−k2/k2
Silk ,
(10.144)
where
1
k2
Silk
≡−
 η
0
dη′
1
6τ ′(1 + R)
16
15 +
R2
1 + R

(10.145)
From the best ﬁt values of the parameter of the CDM model we have:
dSilk = 0.0066 Mpc
(10.146)

334
10
Anisotropies in the Cosmic Microwave Background
10.5
Line-of-Sight Integration
The approximate solutions found earlier are based on the TC limit, which allows us
to take into account just the monopole and the dipole until recombination and then
to better understand the physics behind the CMB anisotropies. On the other hand,
observation demands more precise calculations to be compared with and therefore,
at the end, numerical computation and codes such as CLASS are needed. Even so,
there is a more efﬁcient way of computing predictions on the CMB anisotropies than
dealing directly with the hierarchy of Boltzmann equation and that is to formally
integrate along the photon past light-cone according to a semi-analytic technique
called line-of-sight integration, due to Seljak and Zaldarriaga (1996), and which
was the basis for the CMBFAST code.3
Recall the photon Boltzmann equations (5.114) and (5.115):
′ + ikμ = −′ −ikμ −τ ′

0 − −iμVb −1
2P2(μ)
	
,
(10.147)
′
P + ikμP = −τ ′

−P + 1
2[1 −P2(μ)]
	
,
(10.148)
where  = 2 + P2 + P0. Let us rewrite them as follows:
′ + (ikμ −τ′) = −′ −ikμ −τ′

0 −iμVb −1
2P2(μ)
	
≡S(η, k, μ) ,
(10.149)
′
P + (ikμ −τ′)P = −τ′
2 [1 −P2(μ)] ≡SP(η, k, μ) ,
(10.150)
where we have introduced two source functions on the right hand sides. Note that
the dependence in on k and not on k = kˆz because we are considering the equations
for the transfer functions. Afterwards, before performing the anti-Fourier transform,
we must rotate back ˆk in a generic direction.
Let us write the left hand sides as follows:
′ + (ikμ −τ ′) = e−ikμη+τ d
dη

 eikμη−τ
,
(10.151)
with a similar expression for P. Substituting these into the Boltzmann equations
and integrating formally from a certain initial ηi →0 to today η0, we get:
3https://lambda.gsfc.nasa.gov/toolbox/tb_cmbfast_ov.cfm.

10.5 Line-of-Sight Integration
335
(η0)e−τ(η0) = (ηi)eikμ(ηi−η0)−τ(ηi) +
 η0
ηi
dη eikμ(η−η0)−τ(η)S(η, k, μ) ,
(10.152)
P(η0)e−τ(η0) = P(ηi)eikμ(ηi−η0)−τ(ηi) +
 η0
ηi
dη eikμ(η−η0)−τ(η)SP(η, k, μ) ,
(10.153)
Now recall the deﬁnition of the optical depth:
τ ≡
 η0
η
dη′ neσT a .
(10.154)
It is clear then that τ(η0) = 0 and, since ηi →0 is deep into the radiation-dominated
epoch, then τ ∝1/η is very large and we can neglect exp[−τ(ηi)]. Therefore, we
are left with
(η0, k, μ) =
 η0
0
dη eikμ(η−η0)−τ(η)S(η, k, μ) ,
(10.155)
P(η0, k, μ) =
 η0
0
dη eikμ(η−η0)−τ(η)SP(η, k, μ) .
(10.156)
where we have already implemented the limit ηi →0. Now we calculate the ℓ’s
inverting the Legendre expansion as done in Eq. (5.113) and obtain:
ℓ(η0, k) =
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)
 η0
0
dη eikμ(η−η0)−τ(η)S(k, η, μ) ,
(10.157)
Pℓ(η0, k) =
1
(−i)ℓ
 1
−1
dμ
2 Pℓ(μ)
 η0
0
dη eikμ(η−η0)−τ(η)SP(k, η, μ) ,
(10.158)
The source terms have μ-dependent contributions (up to μ2) that we can handle
integrating by parts. Take for example the −ikμ contribution of S(k, η, μ). Let I
be its integral, which can be rewritten as follows:
I ≡−
 η0
0
dη ikμeikμ(η−η0)−τ(η) = −
 η0
0
dη e−τ(η) d
dη

eikμ(η−η0)
,
(10.159)
and now it is easy to integrate by parts and obtain:
I = −e−τ(η)eikμ(η−η0)η0
0 +
 η0
0
dη eikμ(η−η0) d
dη

e−τ(η)
.
(10.160)

336
10
Anisotropies in the Cosmic Microwave Background
The ﬁrst contribution gives −(η0), i.e. the gravitational potential evaluated at
present time. This is just an undetectable offset that we incorporate into the deﬁ-
nition of ℓ(η0, k), as the observed anisotropy, like we did at the beginning of this
chapter when dealing with the free-streaming solution.
Exercise 10.13 Take care of the term containing μ2, in P2(μ). Show that:
 η0
0
dη τ ′μ2eikμ(η−η0)−τ(η) = −1
k2
 η0
0
dη eikμ(η−η0) d2
dη2

τ ′e−τ(η)
.
(10.161)
Combining all the terms treated with integration by parts, we get:
ℓ(k, η0) =
1
(−i)ℓ
 1
−1
dμ
2
Pℓ(μ)
 η0
0
dη eikμ(η−η0)

−

′ + τ′0 + τ′
4

e−τ +

e−τ −τ′Vbe−τ
k
′
−
3
4k2

τ′e−τ′′

,
(10.162)
Pℓ(k, η0) = −
3
4(−i)ℓ
 1
−1
dμ
2
Pℓ(μ)
 η0
0
dη eikμ(η−η0)

τ′e−τ + 1
k2

τ′e−τ′′
	
.
(10.163)
Using now the relation of Eq. (10.15), we can cast the above equations as:
ℓ(η0, k) =
 η0
0
dη S(η, k) jℓ[k(η0 −η)] ,
(10.164)
Pℓ(η0, k) =
 η0
0
dη SP(η, k) jℓ[k(η0 −η)] .
(10.165)
with
S(η, k) ≡(′ −′)e−τ + g

0 + 
4 + 

+ 1
k (gVb)′ + 3
4k2 (g)′′ ,
(10.166)
SP(η, k) ≡3
4g + 3
4k2 (g)′′ ,
(10.167)
where we have introduced the visibility function:
g(η) ≡−τ ′e−τ
(10.168)

10.5 Line-of-Sight Integration
337
Fig. 10.4 Visibility function
g as function of the redshift
from the numerical
calculation performed with
CLASS for the standard
model
Exercise 10.14 Show that the visibility function is normalised to unity, i.e.
 η0
0
dη g(η) = 1 .
(10.169)
The visibility function represents the Poissonian probability that a photon is last
scattered at a time η. It is very peaked at a time that we deﬁne as the one of recom-
bination, i.e. at η = η∗, because for η > η∗it is basically zero, since τ ′ = 0. Before
recombination, in the radiation-dominated epoch, we saw that −τ ′ ∝1/η2 and thus
τ ∝1/η and g ∝exp(−1/η)/η2, i.e. it goes to zero exponentially fast.
In Fig. 10.4 we plot the numerical calculation of the visibility function performed
with CLASS for the standard model. Note the peak at about z = 1000, which has
always been our reference for the recombination redshift. Note also another peak
at about z = 10, representing the epoch of reionisation. Until now we have used
the peakedness of the visibility function as if it were a Dirac delta δ(η −η∗), i.e.
we have made the sudden recombination approximation. From Fig. 10.4 we can
appreciate that it is a good approximation (mind the logarithmic scale there). As
usual, in cosmology but not only, the calculations get more and more complicated
and impossible to do analytically the more precision we demand.
Inserting the source terms (10.166) and (10.167) in the expressions for ℓ(η0, k)
and Pℓ(η0, k) in the expression of ℓand integrating by parts, we get:
ℓ(k, η0) =
 η0
0
dη g

0 +  + 
4

jℓ[k(η0 −η)]
−
 η0
0
dη gVb
k
d
dη jℓ[k(η0 −η)] +
 η0
0
dη 3g
4k2
d2
dη2 jℓ[k(η0 −η)]
+
 η0
0
dη e−τ(′ −′) jℓ[k(η0 −η)] ,
(10.170)

338
10
Anisotropies in the Cosmic Microwave Background
Pℓ(k, η0) =
 η0
0
dη 3g
4
jℓ[k(η0 −η)] +
 η0
0
dη 3g
4k2
d2
dη2 jℓ[k(η0 −η)] .
(10.171)
Assuming the visibility function to be a Dirac delta δ(η −η∗), i.e. the sudden recom-
bination mentioned earlier, and neglecting , we recover formula (10.24). Note that
neglecting  no polarisation is present. Indeed, from the above equation we see that a
non-zero quadrupole moment of the photon distribution at recombination is essential
in order to have polarisation.
The above equations still need the Boltzmann hierarchy in order to be integrated,
but just up to ℓ= 4 (because 2 and 4 moments are contained in the equation for
′
3) and hence are much more convenient from the computational point of view.
The partial wave expansion of  given in Eq. (7.77):
(k, μ) =

ℓ
(−i)ℓ(2ℓ+ 1)Pℓ(μ)ℓ(k) ,
(10.172)
and that we have used in the above calculations is valid as long as ˆk = ˆz. Now we
have to rotate it in a general direction before performing the Fourier anti-transform.
The task is simple because the temperature ﬂuctuation is a scalar. Therefore:
(k, ˆk · ˆp) =

ℓ
(−i)ℓ(2ℓ+ 1)Pℓ(ˆk · ˆp)ℓ(k) .
(10.173)
The same is not true for P, since the Stokes parameters are not scalars.
Using the deﬁnition of aT,ℓm given in Eq. (7.73) we can then write:
aS
T,ℓm =

d2 ˆn Y m∗
ℓ(ˆn)

l
(−i)ℓ(2ℓ+ 1)

d3k
(2π)3 Pℓ(ˆk · ˆp)α(k)ℓ(k) .
(10.174)
The integration is over d2 ˆn, hence we must change ˆp →ˆn = −ˆp in the Legendre
polynomial. This gives an extra (−1)ℓfactor, due to the parity of the Legendre
polynomials, and then using the addition theorem we obtain:
aS
T,ℓm =

d2 ˆn Y m∗
ℓ(ˆn)

l
iℓ(2ℓ+ 1)

d3k
(2π)3 α(k)
4π
2ℓ′ + 1
ℓ′

m′=−ℓ′
Y ∗m′
ℓ′
(ˆk)Y m′
ℓ′ (ˆn)ℓ(k) .
(10.175)
Now the integration over the whole solid angle can be performed and the orthonor-
mality of the spherical harmonics can be employed, obtaining thus:

10.5 Line-of-Sight Integration
339
aS
T,ℓm = 4πiℓ

d3k
(2π)3 Y m∗
ℓ(ˆk)α(k)ℓ(k)
(10.176)
This formula, together with Eq. (10.170) allows us to explicitly calculate the scalar
contribution to the aT,ℓm’s. Earlier, we have focused on the CT T,ℓ’s only, for which
the calculations are simpler because there is no need of performing a spatial rotation,
but we need to know the explicit form of the aT,ℓm’s in order to compute the TE
correlation spectrum of Eq. (7.87).
10.6
Finite Thickness Effect and Reionization
In this section we discuss two more effects that inﬂuence the CMB spectrum, namely
the ﬁnite thickness effect and the reionisation. The ﬁrst one is related to the fact that
the visibility function g in Fig. 10.4 is very peaked but it is not a Dirac delta. In
other words, CMB photons do not last scatter all at once at η∗but during a ﬁnite
amount of time say η∗. This is the ﬁnite thickness effect. Physically, on scales
smaller than the thickness η∗we expect ﬂuctuations to be washed out because they
are averaged over a ﬁnite amount of time. This is similar to what is called Landau
damping (although the latter arises from a spread in frequency and not in time). It
may seem that Landau damping is a small effect, but actually is of the same order of
Silk damping and therefore it must be taken into account.
Let us take advantage of this investigation and derive the form of the visibility
function here. The question is: what is the probability that a photon last scatter during
some sufﬁciently small interval between the instants η and η + η? The time interval
η is sufﬁciently small so that only one collision can take place into it. The attentive
reader has noticed that this is the same requirement we make when we derive the
Poisson distribution, cf. Chap.12, which in fact rules the statistics of e.g. scattering
process.
So, we divide the time interval η0 −η in many, i.e. N ≡(η0 −η)/η, intervals
and write the probability as:
P =
η
ηc(η)

1 −
η
ηc(η1)
	 
1 −
η
ηc(η2)
	
. . .

1 −
η
ηc(ηN)
	
,
(10.177)
where recall that ηc ≡−1/τ ′ is the average time between two consecutive collisions
and it is time-dependent. We have chosen the time interval η small enough in order
for η/ηc to be the probability of having one scattering during its duration and
hence 1 −η/ηc being that of having no scattering. Now, in the limit η →0 we
can write:
d P = dη
ηc
exp

−
 η0
η
dη
ηc

= −τ ′ exp [−τ(η)] dη = g(η)dη ,
(10.178)

340
10
Anisotropies in the Cosmic Microwave Background
i.e. the visibility function deﬁned in Eq. (10.168) appears. As we have anticipated,
the maximum of the visibility function occurs in a time that we dub η∗, i.e. the
recombination time if we make the assumption of sudden recombination. From the
condition for the extrema of a function:
g′(η) = −τ ′′e−τ + (τ ′)2e−τ = 0 ,
(10.179)
we get:
−τ ′′ = (τ ′)2 ,
(10.180)
as the condition which deﬁnes η∗. Therefore, employing the deﬁnition of the optical
depth, we get:
(neσTa)′
∗= −(neσTa)2
∗,
(10.181)
where the derivative is evaluated at η∗, as well as the function on the right hand side.
Now, let us write the free-electron number density as ne = Xenb, i.e. introducing
the free-electron fraction and the baryon number density and recall from Boltzmann
equation, cf. Chap.3, that:
X′
e = −1.44 × 104
z
HXe .
(10.182)
Evaluating the above equation at η∗and combining it with the extrema condition for
the visibility function, we get:
Xe(η∗) ≈1.44 × 104
z∗(nbσTa)∗
H(η∗) ≡
K
(nbσTa)∗
H(η∗) ,
(10.183)
and from this we get the recombination redshift z∗≈1050.
Let us approximate the visibility function by expanding it about its maximum:
g(η) = exp[ln(−τ ′) −τ] ≈exp

−1
2[τ −ln(−τ ′)]′′
∗(η −η∗)2
	
,
(10.184)
i.e. we have a Gaussian function. Now we determine the second derivative, and hence
the variance of the distribution by using Boltzmann equation and employing the fol-
lowing approximation: we consider only the ﬁrst derivative of Xe to be different from
zero. All the other quantities are approximately constant indeed since recombination
takes place quite rapidly. So, we can write:

τ ′ −τ ′′
τ ′
′
∗
=

−nbXeσTa −nbX′
eσTa
nbXeσTa
′
∗
.
(10.185)
Now, within our approximation X′
e/Xe is constant, and thus:

10.6 Finite Thickness Effect and Reionization
341

τ ′ −τ ′′
τ ′
′
∗
= −(nbX′
eσTa)∗= (nbXeσTa)2
∗= K 2H(η∗)2 .
(10.186)
Hence the visibility function can be approximated as a Gaussian function:
g(η) ≈KH∗
√
2π

−1
2(KH∗)2(η −η∗)2
	
,
(10.187)
with variance 1/(KH∗).
When we substitute this approximation of the visibility function in the line-of-
sight integrals of Eqs. (10.170) and (10.171) we can extract the spherical Bessel
functions as jl[k(η0 −η∗)], since η0 is much larger than any conformal time about
recombination, and the other integrals are oscillating functions of krs(η), as we saw
in Eq. (10.107). We can approximate this about η∗, as follows:
krs(η) = k
 η
0
dη′
1
√3(1 + R) ≈krs(η∗) +
k
√3(1 + R∗)(η −η∗) .
(10.188)
Hence, we have ﬁnally a conformal time Gaussian integral of the following type:
 ∞
−∞
dη exp

−1
2(KH∗)2(η −η∗)2 +
ik
√3(1 + R∗)(η −η∗)
	
.
(10.189)
Now, using the formula for the Gaussian integral:
 ∞
−∞
e−ax2+bxdx =
π
a eb2/4a ,
(10.190)
we can conclude that the ℓ’s get an additional damping factor of the following
form:
exp

−
k2
6(1 + R∗)(KH∗)2
	
,
(10.191)
so a new damping scale appears:
d2
Landau =
1
k2
Landau
≡
1
6(1 + R∗)(KH∗)2
(10.192)
which, following Weinberg (2008), we call Landau damping scale. For the CDM
model best ﬁt parameters we have:
dLandau ≈0.0048 Mpc
(10.193)

342
10
Anisotropies in the Cosmic Microwave Background
Now let us turn to reionisation. At a redshift of about 10 hydrogen gets ionised again
by the ultraviolet radiation of the ﬁrst structures. Hence, the free-electron fraction
grows again increasing the probability of a CMB photon to be scattered again, cf.
the extra bump in the visibility function in Fig. 10.4. Following the calculation done
above in order to obtain the visibility function, we know that the probability for a
photon not to be scattered from reionisation until today is:
exp[−τ(ηreion)] ,
(10.194)
and of course the one for being scattered is 1 minus the above quantity, which we
compute now:
τ(ηreion) =
 η0
ηreion
dη neσTa = σT
 zreion
0
dz
(1 + z)2Hne .
(10.195)
For the free-electron number density we can write:
ne = 0.88nbXe = 0.88 3H 2
0
8πmb
	b0(1 + z)3 ,
(10.196)
where the factor 0.88 is due to the fact that not all the baryons are electrons or
protons, but there are also neutrons in Helium nuclei. Assuming matter-domination
and instantaneous reionisation, i.e.
H2 = H 2
0 	m0(1 + z)3 ,
(10.197)
and Xe = 1 for z < zreion, we get:
τ(zreion) ≈0.04 	b0h2

	m0h2 z3/2
reion .
(10.198)
Hence, the probability for a CMB photon not to be scattered for reionisation taking
place at redshift zreion = 10 is about 0.99, i.e. very high. Those photons which are
scattered are mixed up, hence the correlation in their temperature is destroyed. So, the
effect of reionisation on the CT T,ℓ’s is simply to weigh them by a factor exp(−2τreion),
the factor 2 appearing because the spectrum is a quadratic function of the temperature
ﬂuctuations.
10.7
Cosmological Parameters Determination
In this section we discuss how the CMB TT spectrum, i.e. the CT T,ℓ’s, are sensitive to
the cosmological parameters. We have learned in this chapter about many quantities
which are of relevance in forming the shape of the spectrum but we have not actually

10.7 Cosmological Parameters Determination
343
derived an analytic, approximated formula in order to see this explicitly. These can be
found in Mukhanov (2005) and Weinberg (2008). Here instead we plot with CLASS
various spectra for varying parameters and discuss the physics behind the changes.
Note that, for the standard  model, 6 of the overall parameters are usually left
free and constrained by observation:
1. The amplitude of the primordial power spectrum: AS;
2. The primordial tilt: nS;
3. The baryonic abundance: 	b0h2;
4. The CDM abundance: 	c0h2;
5. The reionization epoch: zreion;
6. The sound horizon at recombination: rs(η∗), which is related to the Hubble
constant value H0.
The other parameters can be derived by these ones. In particular, the amount of
radiation is already well known by measuring the CMB temperature and so the
amount of  and curvature is determined via the positions of the peaks, which
depend on rs(η∗), which in turn depends on the baryon content.
In Figs. 10.5 and 10.6 we start to show the numerical calculation of CMB TT
power spectrum decomposed in the contributions discussed in this chapter. See also
Wands et al. (2016). We consider the CDM as ﬁducial model.
In Fig. 10.7 we show what happens to CMB TT the spectrum for 	b0h2 =
0.010, 0.014, 0.018, 0.022, 0.026, 0.030, 0.034. Taking the ﬁrst peak height as ref-
erence, the larger the value of 	b0h2 is, the higher the peak is. When we vary one
of the density parameters, since their sum must be equal to one that means that also
something else must vary. In this case we have chosen to vary 	.
Why so? We have seen that baryons loading makes compression favoured over
rarefaction and hence the ﬁrst and the third peaks are higher for higher values of
Fig. 10.5 Total CMB TT power spectrum (blue line) computed with CLASS and decomposed
in the physically different contributions: Sachs-Wolfe effect (yellow line), early-times ISW effect
(green line), late-times ISW effect (red line), Doppler effect (purple line), and polarisation (brown
line)

344
10
Anisotropies in the Cosmic Microwave Background
Fig. 10.6 Same as Fig. 10.5 but in logarithmic scale, in order to better distinguish the weakest
contributions
Fig. 10.7 CMB TT power spectrum computed with CLASS and varying 	b0h2. From the lowest
ﬁrst peak to the highest: 	b0h2 = 0.010, 0.014, 0.018, 0.022, 0.026, 0.030, 0.034
	b0h2, but the second one is lower. In other words, the peaks relative height is very
sensitive to the baryon content. The position of the ﬁrst peak does not change much
because it is most sensitive to the spatial curvature and this has been ﬁxed to zero.
Finally, the curves for larger 	b0h2, as we commented, have less 	 and therefore
less ISW effect. For these reason they are slightly lower for small ℓ.
In Fig. 10.8 we show what happens to CMB TT the spectrum for 	c0h2 =
0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15. Taking the ﬁrst peak height as reference, the
larger the value of 	c0h2 is, the lower the peak is. This behaviour is the opposite of
the one that we found by varying 	b0h2. Mostly CDM intervenes through the SW
effect since it dominates the gravitational potential  at recombination. The ﬁrst
peak is affected more because it corresponds to large scales, basically the horizon at
recombination, and there the transfer function is approximately unit, meaning that
− is as large as possible. The subsequent peaks correspond to scales which entered
the horizon much earlier and therefore the CDM inﬂuence there is weak.

10.7 Cosmological Parameters Determination
345
Fig. 10.8 CMB TT power spectrum computed with CLASS and varying 	c0h2. From the highest
ﬁrst peak to the lowest: 	c0h2 = 0.09, 0.10, 0.11, 0.12, 0.13, 0.14, 0.15
Fig. 10.9 CMB TT power spectrum computed with CLASS and varying τreion. From the highest
ﬁrst peak to the lowest: τreion = 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7
In this case also we have chosen to vary 	 in order to keep the total density
budget. Indeed, the more CDM, the less  and the less ISW effect, as expected.
In Fig. 10.9 we show what happens to CMB TT the spectrum for τreion =
0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7. As we have commented in the previous section, the
overall effect of reionisation is simple because it happens very lately: a damping of
the order exp(−2τreion) for multipoles larger than a certain ℓreion which we infer to
be about 10 from the plots in Fig. 10.9.
From Fig. 10.10 we can appreciate how the CMB TT power spectrum is affected
by the spatial geometry of the universe. From the leftmost spectrum to the rightmost
one 	K0 = −0.2, −0.1, 0, 0.1, 0.2. Hence, the position of the ﬁrst peak is of great
importance in order to determine whether our universe is closed or open. Note that
the ﬂat case is a limiting value which we cannot determine observationally, because

346
10
Anisotropies in the Cosmic Microwave Background
Fig. 10.10 CMB TT power spectrum computed with CLASS and varying 	K0. From the left to
the right: 	K0 = −0.2, −0.1, 0, 0.1, 0.2
of the experimental error; we can only conclude that observation is consistent with
	K0 = 0, i.e. this value is not ruled out.
As we saw in Eq. (10.107), the length scale associated to the acoustic peaks is the
sound horizon at recombination:
rs(η∗) =
 η∗
0
csdη ,
(10.199)
where the speed of sound of the baryon-photon plasma is given by Eq. (10.87):
c2
s =
1
3(1 + R) =
4	γ0
3(4	γ0 + 3	b0a) .
(10.200)
The physical sound horizon is given by:
rphys
s
(z∗) =
 t∗
0
cs(t)dt =
 ∞
z∗
dz
cs(z)
H(z)(1 + z) ,
(10.201)
i.e. integrating the lookback time. We need the physical quantity in order to relate it
with the angular-diameter distance to recombination:
dA(z∗) =
1
(1 + z∗)
 z∗
0
dz
H(z) ,
(10.202)
and thus estimate the multipole corresponding to the ﬁrst peak:
ℓ1st ≈
1
θ1st
= dA(z∗)
rphys
s
(z∗)
.
(10.203)

10.7 Cosmological Parameters Determination
347
Let us approximate the physical sound horizon by assuming cs constant and a matter-
dominated universe. We have thus:
rphys
s
(z∗) ≈
cs
H0
√	m0
 ∞
z∗
dz
(1 + z)5/2 =
2cs
3H0
√	m0
1
(1 + z∗)3/2 ,
(10.204)
and for the angular-diameter distance we also assume a matter plus  universe:
dA(z∗) =
1
H0(1 + z∗)
 z∗
0
dz

	m0(1 + z)3 + (1 −	m0)
.
(10.205)
Exercise 10.15 Show that dA(z∗) can be approximated as:
dA(z∗) ≈
2
7H0(1 + z∗)√	m0
(9 −2	3
m0) .
(10.206)
Hence, we have:
ℓ1st ≈0.74

1 + z∗(9 −2	3
m0) ≈220 ,
(10.207)
which clearly shows how the position of the ﬁrst peak changes as function of the
total matter content.
In Fig. 10.11 we show how the initial conditions dramatically affect the CMB
TT power spectrum and how the adiabatic ones are favoured by observation (when
comparing with the data points of Fig. 10.1).
Fig. 10.11 CMB TT power spectrum computed with CLASS and varying initial conditions: adia-
batic (blue line), baryon isocurvature (yellow line), CDM isocurvature (green line), neutrino density
isocurvature (red line), neutrino velocity isocurvature (purple line)

348
10
Anisotropies in the Cosmic Microwave Background
10.8
Tensor Contribution to the CMB TT Correlation
Tensor perturbations also contribute to generate temperature anisotropies, as we see
in Eq. (5.138), which we report here after renormalising to the primordial mode
β(k, λ), cf. Eq. (7.101):
 ∂
∂η + ikμ −τ ′

(T )(η, k, μ) + h
′T
2
=
−τ ′
 3
70(T )
4
+ 1
7(T )
2
+ 1
10(T)
0
−3
70(T )
P4 + 6
7(T)
P2 −3
5(T )
P0
	
≡−τ ′ST (η, k) ,
(10.208)
 ∂
∂η + ikμ −τ ′

(T )
P (η, k, μ) = τ ′ST (η, k) ,
(10.209)
The label λ representing the two possible states of helicity is absent because of the
renormalisation with β(k, λ). It represents the fact that the evolution of the two
helicities is the same.
The line-of-sight solutions of the above equations are the following:
(T )(η0, k, μ) =
 η0
0
dη eikμ(η−η0)−τ 
−h′T /2 −τ ′ST (η, k)

,
(10.210)
(T)
P (η0, k, μ) =
 η0
0
dη eikμ(η−η0)−ττ ′ST (η, k) .
(10.211)
We now focus on (T)(η0, k, μ). Deﬁning:
ST (η, k) ≡e−τ 
−h′T /2 −τ ′ST (η, k)

,
(10.212)
and using Eqs. (5.131) and (5.32), the tensor contribution to the temperature ﬂuctu-
ation is made up of the sum of the following two contributions:
fλ(kˆz, ˆp) ≡4
 π
15Y λ
2 ( ˆp)
 η0
0
dη ST (η, k)e−iμkr(η) ,
(10.213)
where r(η) ≡η0 −η and where we stress that the result holds true for ˆk = ˆz since
this was the condition under which we derived the Boltzmann equation for photons.
We cannot yet sum over λ because we have to include β(k, λ) ﬁrst. For this reason,
we shall work on fλ(kˆz, ˆp).
In order to investigate temperature ﬂuctuations in the sky, we need to anti-
transform (T )(k, ˆp) in order to employ the usual expansion:
(T )(ˆn) =

ℓm
aT
T,ℓmY m
ℓ(ˆn) ,
aT
T,ℓm =

d2 ˆn Y m∗
ℓ(ˆn)(T )(ˆn) .
(10.214)

10.8 Tensor Contribution to the CMB TT Correlation
349
So, let us proceed as follows. We trade ˆp for the line-of-sight ˆn = −ˆp and use the
expansion of a plane wave in spherical harmonics:
ei ˆk·ˆnkr =

LM
i LY M∗
L
(ˆk)Y M
L (ˆn) jL(kr) ,
(10.215)
in Eq. (10.213).
Exercise 10.16 First of all, since ˆk = ˆz then show that:
Y M∗
L
(ˆk) = Y M∗
L
(ˆz) = δM0

2L + 1
4π
,
(10.216)
i.e. for θ = 0 (representing the ˆz direction) the spherical harmonics are non-vanishing
only if M = 0.
Therefore, we can write:
fλ(kˆz, ˆn) =
2
√
15
Y λ
2 (ˆn)

L
i L√
2L + 1Y 0
L(ˆn)
 η0
0
dη ST (η, k) jL(kr) . (10.217)
The idea is now to perform a rotation in order to put ˆk in a generic direction. But then
also ˆn rotates and therefore we need to know how a spherical harmonics behaves
under rotations. In order to deal with just one spherical harmonic we take advantage
of the following decomposition:
Y ±2
2 (ˆn)Y 0
L(ˆn) =

5(2L + 1)
4π

L′
√
2L′ + 1
 L 2
L′
0 ±2 ∓2
  L 2 L′
0 0 0

Y ±2
L′ (ˆn) ,
(10.218)
where we have employed the Wigner 3 j-symbols, which are coefﬁcients appear-
ing in the quantum theory of angular momentum, when we combine two angular
momenta and we want to write the state of total angular momentum as a linear com-
bination on the basis of the tensor product of the two combined angular momenta.
They are an alternative to the (perhaps more commonly used) Clebsch-Gordan coef-
ﬁcient See e.g. Landau and Lifshits (1991) and Weinberg (2015).
This expansion allows us to deal with just one spherical harmonics. Now we take
advantage of the properties of the spherical harmonics under spatial rotation, i.e.

350
10
Anisotropies in the Cosmic Microwave Background
Y m
ℓ(R ˆn) =
ℓ

m′=−ℓ
D(ℓ)
m′m(R−1)Y m′
ℓ(ˆn)
(10.219)
where the D(ℓ)
m′m are the elements of the Wigner D-matrix. See Landau and Lifshits
(1991) for more detail. The above R is a generic rotation. Of course, we are interested
in a R(ˆk) rotation which brings ˆk in a generic direction. Hence, we can write:
fλ(k, ˆn) =

L
i L 2L + 1
√
3π

L′
√
2L′ + 1
 L 2 L′
0 λ −λ

 L 2 L′
0 0 0
 
m′
D(L′)
m′λ[R(ˆk)]Y m′
L′ (ˆn)
 η0
0
dη ST (η, k) jL(kr) .
(10.220)
Here we have dubbed R ˆn the original line of sight and ˆn the resulting one after the
rotation.
Now we can perform the Fourier anti-transform. Let us multiply fλ(k, ˆn) by
β(k, λ) and Y m∗
ℓ(ˆn) and integrate over d2 ˆn in order to obtain the aT
T,ℓm’s. We obtain:
aT
ℓm,±2 =

L
i L 2L + 1
√
3π
√
2ℓ+ 1
 L 2
ℓ
0 ±2 ∓2

 L 2 ℓ
0 0 0
 
d3k
(2π)3 D(ℓ)
m±2[R(ˆk)]β(k, ±2)
 η0
0
dη ST (η, k) jL(kr) . (10.221)
We have used here the orthonormality relation of the spherical harmonics and distin-
guished the contributions from different helicities. Of course aℓm = aℓm,+2 + aℓm,−2.
It is now time to compute the 3 j symbols and to perform the summation over
L. A general formula for those was obtained in Racah (1942), but we can read
their expression from Landau and Lifshits (1991). We then have the only following
non-vanishing occurrences:
 ℓ2 ℓ
0 0 0

= (−1)ℓ+1

ℓ(ℓ+ 1)
(2ℓ−1)(2ℓ+ 1)(2ℓ+ 3) ,
(10.222)
ℓ+ 2 2 ℓ
0
0 0

= (−1)ℓ

3(ℓ+ 1)(ℓ+ 2)
2(2ℓ+ 1)(2ℓ+ 3)(2ℓ+ 5) ,
(10.223)
ℓ−2 2 ℓ
0
0 0

= (−1)ℓ

3ℓ(ℓ−1)
2(2ℓ−3)(2ℓ−1)(2ℓ+ 1) .
(10.224)
In particular, there is no contribution coming from L = ℓ± 1. The other three rele-
vant (i.e. not considering those for L = ℓ± 1 which are non-vanishing in this case)
symbols are:

10.8 Tensor Contribution to the CMB TT Correlation
351
 ℓ2
ℓ
0 ±2 ∓2

= (−1)ℓ

3(ℓ−1)(ℓ+ 2)
2(2ℓ−1)(2ℓ+ 1)(2ℓ+ 3) ,
(10.225)
ℓ+ 2 2
ℓ
0
±2 ∓2

= (−1)ℓ1
2

(ℓ−1)ℓ
(2ℓ+ 1)(2ℓ+ 3)(2ℓ+ 5) ,
(10.226)
ℓ−2 2
ℓ
0
±2 ∓2

= (−1)ℓ1
2

(ℓ+ 1)(ℓ+ 2)
(2ℓ−3)(2ℓ−1)(2ℓ+ 1) ,
(10.227)
Exercise 10.17 Derive the above expressions for the relevant Wigner 3 j symbols
given in Landau and Lifshits (1991) and put them in Eq. (10.221). Show that:
aT
T,ℓm,±2 = −iℓ

(2ℓ+ 1)(ℓ+ 2)!
8π(ℓ−2)!

d3k
(2π)3 D(ℓ)
m±2[R(ˆk)]β(k, ±2)
 η0
0
dη ST (η, k)

jℓ−2(kr)
(2ℓ−1)(2ℓ+ 1) +
2 jℓ(kr)
(2ℓ−1)(2ℓ+ 3) +
jℓ+2(kr)
(2ℓ+ 1)(2ℓ+ 3)
	
.
(10.228)
Recall that r = r(η) ≡η0 −η.
Exercise 10.18 Show that, using the recurrence relation (Abramowitz and Stegun
1972):
jℓ(x)
x
= jℓ−1(x) + jℓ+1(x)
2ℓ+ 1
,
(10.229)
we can write:
aT
T,ℓm = −iℓ

(2ℓ+ 1)(ℓ+ 2)!
8π(ℓ−2)!

λ=±2

d3k
(2π)3 D(ℓ)
m,λ[R(ˆk)]β(k, λ)
 η0
0
dη ST (η, k) jℓ(kr)
(kr)2 . (10.230)
The Wigner D-matrix can be related to the spin-weighted spherical harmonics as
follows:
D(ℓ)
m,±2(ˆk) =

4π
2ℓ+ 1
±2Y −m
ℓ
(ˆk) =

4π
2ℓ+ 1
∓2Y m∗
ℓ(ˆk) ,
(10.231)

352
10
Anisotropies in the Cosmic Microwave Background
so we have:
aT
T,ℓm = −iℓ

(ℓ+ 2)!
2(ℓ−2)!

λ=±2

d3k
(2π)3 λY m∗
ℓ(ˆk)β(k, λ)
 η0
0
dη ST (η, k) jℓ(kr)
(kr)2
(10.232)
This is our main result of this section. It is not surprising that Y m∗
ℓ(ˆk) eventually
appeared, being GW a spin-2 ﬁeld.
In order to compute the tensor contribution to the CT T,ℓ’s, we perform the ensem-
ble average:
⟨aT
T,ℓmaT ∗
T,ℓ′m′⟩= CT
T T,ℓδℓℓ′δmm′ .
(10.233)
Exercise 10.19 Assuming Gaussian perturbations, using Eq. (7.102) and the orthog-
onality property of the Wigner D-matrices or the spin-weighted spherical harmonics:

d2 ˆk D(ℓ)
m,±2[R(ˆk)]D(ℓ′)∗
m′,±2[R(ˆk)] =
4π
2ℓ+ 1δℓℓ′δmm′ ,
(10.234)
show that:
CT
T T,ℓ=
(ℓ+ 2)!
4π(ℓ−2)!
 ∞
0
dk
k 2
h(k)

 η0
0
dη ST (η, k) jℓ(kr)
(kr)2

2
(10.235)
Note that a factor 2 arises because of the two polarisation states.
The above result was originally obtained in Abbott and Wise (1984) (though not
exactly in the same way and ﬁnal form).
The main difﬁculty we faced in computing the aT
T,ℓm was the spatial rotation which
brought ˆk in a generic direction. This can be avoided if we calculate straightaway
CT
T T,ℓbecause it is rotationally invariant. Note that no correlation exists between
scalar and tensor modes. In fact if we compute:
⟨aT
T,ℓmaS∗
T,ℓ′m′⟩,
(10.236)
we would get zero, mathematically because of the integral:

d2 ˆk 2Y m
ℓ(ˆk)Y m′
ℓ′ (ˆk) = 0 ,
(10.237)
between a spin-2 spherical harmonic and a spin-0 one. Physically, because we know
that at the linear order scalar and tensor perturbations do not couple.

10.8 Tensor Contribution to the CMB TT Correlation
353
We can again approximate this angular power spectrum for large values of ℓas
follows. First, ST (η, k) contains the derivative of h, which is maximum when a mode
enters the horizon, for kη ≈1, being almost zero elsewhere. Therefore, assuming
instantaneous recombination, we can write:
CT
T T,ℓ= (ℓ−1)ℓ(ℓ+ 1)(ℓ+ 2)
4π
 ∞
0
dk
k 2
h(k) j2
ℓ(kη0)
(kη0)4 .
(10.238)
Deﬁning the new variable x ≡kη0 and introducing the primordial tensor power
spectrum we get:
CT
T T,ℓ∝(ℓ−1)ℓ(ℓ+ 1)(ℓ+ 2)
4π
 ∞
0
dx xnT −5 j2
ℓ(x) .
(10.239)
The integral can be performed exactly:
 ∞
0
dx xnT −5 =
√π
2

[1 −(nT −4)/2]
[(nT −4)/2 + ℓ]
(4 −nT )
[1/2 −(nT −4)/2]
[ℓ+ 2 −(nT −4)/2] ,
(10.240)
but in the case of nT = 0, a scale-invariant primordial tensor spectrum, we get:
ℓ(ℓ+ 1)CT
T T,ℓ
2π
∝
ℓ(ℓ+ 1)
(ℓ−2)(ℓ+ 3) .
(10.241)
The behaviour of the tensor contribution to the TT power spectrum is thus very
different from the one coming from scalar perturbations. In Figs. 10.12 and 10.13 we
display the numerical calculations done with CLASS of the total (solid line), scalar
(dashed line) and tensor (dotted line) angular power spectra.
Fig. 10.12 Numerical calculations done with CLASS of the total (solid line), scalar (dashed line)
and tensor (dotted line) angular power spectra

354
10
Anisotropies in the Cosmic Microwave Background
Fig. 10.13 Same as Fig. 10.12 but using a logarithmic scale
The tensor contribution is practically irrelevant on very small angular scale (i.e.
large ℓ) and on large angular scales they can be as large as 10% of the total. Typically
then one can give upper limits on CT
T T,ℓ/C S
T T,ℓfor small multipoles (ℓ= 2 or ℓ= 10)
and this ratio is proportional to AT /AS and therefore on the parameter r, the tensor-
to-scalar ratio. From Eq. (8.176) we saw that r < 0.1. In order to determine this
constraint one has also to use polarisation data since with these we are able to
disentangle the AS exp(−2τreion) dependence coming from the scalar contribution
only to the temperature power spectrum.
10.9
Polarisation
In this section we address CMB polarisation. Recall that before recombination polar-
isation is also erased because of tight-coupling. Polarisation is generated thanks to
the fact that recombination does not take place instantaneously, so the ﬁnite-thickness
effect is indeed important. Moreover, since Thomson scattering is axially-symmetric,
circular polarisation is not produced.
In Sect. 12.7 we recall the main terminology regarding polarisation and in partic-
ular the Stokes parameters.
10.9.1
Scalar Perturbations Contribution to Polarisation
Now, let us focus on scalar perturbations only and write down from Eq. (5.115) the
line of sight solution for the combination Q + iU. Since we have chosen a reference
frame in which ˆk = ˆz, there is no U polarisation. This can be also seen from the fact
that B0 = 0. Hence, we shall again perform a rotation in order to compute the aP,ℓm.

10.9 Polarisation
355
We have called P the Stokes parameter Q in the ˆk = ˆz frame. So, let us work
on its line-of-sight solution.
Exercise 10.20 Show that:
P(kˆz, ˆn) = 3
2

8π
15
2Y 0
2 (ˆn)
 η0
0
dη e−iμkr SS
P(η, k) ,
(10.242)
where we have deﬁned a new source term:
SS
P(η, k) ≡g(η)(η, k) .
(10.243)
We could have written −2Y 0
2 (ˆn) instead of 2Y 0
2 (ˆn), since they are equal. However,
we are going to deal with Q + iU ﬁrst. The above equation can written as:
P(kˆz, ˆn) =

9
30
2Y 0
2 ( ˆp)

L
i L√
2L + 1Y 0
L(ˆn)
 η0
0
dη SS
P(η, k) jL(kr) ,
(10.244)
where again r ≡η0 −η and we have used the well-known-by-now expansion of a
plane wave into spherical harmonics plus the fact that ˆk = ˆz.
Now, as in Eq. (10.218) we can write the product of spherical harmonics as
follows:
2Y 0
2 (ˆn)Y 0
L(ˆn) =

5(2L + 1)
4π

L′
√
2L′ + 1
 L 2
L′
0 −2 +2
  L 2 L′
0 0 0

2Y 0
L′(ˆn) ,
(10.245)
and thus obtain:
(Q + iU)S(ˆn) =

3
8π

L
i L(2L + 1)

L′

2L′ + 1
 L
2 L′
0 −2 2

 L 2 L′
0 0 0
 
m′
2Y m′
L′ (ˆn)

d3k
(2π)3 D(L′)
m′0 (ˆk)α(k)
 η0
0
dη SS
P(η, k) jL(kr) ,
(10.246)
where we have already considered the rotation which brings ˆk in a generic direction.
Now, from the expansion:
(Q + iU)S(ˆn) =

ℓm
aS
P,ℓm 2Y m
ℓ(ˆn) ,
(10.247)

356
10
Anisotropies in the Cosmic Microwave Background
we are able to calculate the coefﬁcients aS
P,ℓm by taking advantage of the orthonor-
mality of the spin-2 spherical harmonics. We can therefore write:
aS
P,ℓm =

3
8π

L
i L(2L + 1)
√
2ℓ+ 1
 L 2 ℓ
0 −2 2

 L 2 ℓ
0 0 0
 
d3k
(2π)3 D(ℓ)
m0(ˆk)α(k)
 η0
0
dη SS
P(η, k) jL(kr) .
(10.248)
Remarkably, the sum over L can be performed in the very same way we did for the
aT
T,ℓm, since the 3 j symbols are the same. Therefore, we have:
aS
P,ℓm = −3iℓ
8

(2ℓ+ 1)(ℓ+ 2)!
π(ℓ−2)!

d3k
(2π)3 D(ℓ)
m0(ˆk)α(k)
 η0
0
dη SS
P(η, k) jℓ(kr)
(kr)2 ,
(10.249)
and using
D(ℓ)
m0(ˆk) =

4π
2ℓ+ 1Y −m
ℓ
(ˆk) =

4π
2ℓ+ 1Y m∗
ℓ(ˆk) ,
(10.250)
we can write:
aS
P,ℓm = −3iℓ
4

(ℓ+ 2)!
(ℓ−2)!

d3k
(2π)3 Y m∗
ℓ(ˆk)α(k)
 η0
0
dη SS
P(η, k) jℓ(kr)
(kr)2
(10.251)
The expansion for (Q −iU)S(ˆn) can be obtained by complex conjugation, i.e.
(Q −iU)(ˆn) =

ℓm
a∗
P,ℓm 2Y m∗
ℓ(ˆn) =

ℓm
a∗
P,ℓm −2Y −m
ℓ
(ˆn)
=

ℓm
a∗
P,ℓ,−m −2Y m
ℓ(ˆn) .
(10.252)
There is no reality condition here holding true for the aP,ℓm as the one holding true
for the aT,ℓm, because Q + iU is not real and is not a scalar. It is thus convenient to
deﬁne the following combinations:
aE,ℓm ≡−(aP,ℓm + a∗
P,ℓ,−m)/2 ,
aB,ℓm ≡i(aP,ℓm −a∗
P,ℓ,−m)/2 ,
(10.253)
because the ﬁrst has parity (−1)ℓwhereas the second (−1)ℓ+1. Thus Q ± iU can be
expanded as:

10.9 Polarisation
357
(Q ± iU)(ˆn) =

ℓm
(−aE,ℓm ∓iaB,ℓm) 2Y m
ℓ(ˆn) .
(10.254)
Now, if we compute aS∗
P,ℓm, we obtain:
aS∗
P,ℓm = −3(−i)ℓ
4

(ℓ+ 2)!
(ℓ−2)!

d3k
(2π)3 Y −m∗
ℓ
(ˆk)α(−k)
 η0
0
dη SS
P(η, k) jℓ(kr)
(kr)2 ,
(10.255)
since α(k)∗= α(−k) because of the reality condition of the power spectrum. Chang-
ing the integration variable to k and using the parity of the spherical harmonic:
Y −m∗
ℓ
(−ˆk) = (−1)ℓY −m∗
ℓ
(ˆk) ,
(10.256)
we can ﬁnally conclude that:
aS
P,ℓm = aS∗
P,ℓ,−m ,
(10.257)
and therefore scalar perturbations only affect the E-mode, i.e.
aS
E,ℓm = −aS
P,ℓm ,
aS
B,ℓm = 0 .
(10.258)
This means that, if the B-mode was detected, it would be a clear indication of the
existence of primordial gravitational waves.
From Eq. (10.251) we can then obtain the scalar contribution to the EE spectrum.
Assuming adiabatic Gaussian perturbations:
C S
E E,ℓ=
9
64π
(ℓ+ 2)!
(ℓ−2)!
 dk
k 2
R

 η0
0
dη SS
P(η, k) jℓ(kr)
(kr)2

2
(10.259)
Using instead Eq. (10.176) we can compute the cross-correlation TE multipole coef-
ﬁcients:
C S
T E,ℓ= −3
4

(ℓ+ 2)!
(ℓ−2)!
 dk
k 2
Rℓ(k)
 η0
0
dη SS
P(η, k) jℓ(kr)
(kr)2
(10.260)
10.9.2
Tensor Perturbations Contribution to Polarisation
Let us now calculate the contribution to CMB polarisation coming from tensor per-
turbations. From Eq. (10.211) we have

358
10
Anisotropies in the Cosmic Microwave Background
(T)
P (η0, kˆz, μ) =
 η0
0
dη eikμ(η−η0)ST
P(η, k) ,
(10.261)
with
ST
P(η, k) ≡g(η)ST (η, k) .
(10.262)
and then use Eq. (5.132) in order to write part of the tensor contribution to polariza-
tion:
Q(T )
λ (kˆz, ˆp) ≡

8π
5 Eλ( ˆp)
 η0
0
dη e−iμkr(η)ST
P(η, k) ,
(10.263)
where r(η) ≡η0 −η and where we stress that the result holds true for ˆk = ˆz since
this was the condition under which we derived the Boltzmann equation for photons.
In the scalar case no U contribution to polarisation is produced, so the above
expression already furnishes the quantity Q + iU. However, the same is not true for
tensor perturbation. We have thus to add the iU contribution. As we saw in Chap. 5
this is equal to Bm Q/Em and for this reason we have just one polarisation hierarchy.
Hence, summing up we get:
(Qλ + iUλ)(T)(kˆz, ˆn) =

32π
5
2Y λ
2 (ˆn)
 η0
0
dη ei ˆk·ˆnkr(η)ST
P(η, k) .
(10.264)
Using the usual plane-wave expansion and recalling that ˆk = ˆz we get:
(Qλ + iUλ)(T )(kˆz, ˆn) =

8
5
2Y λ
2 (ˆn)

L
i L√
2L + 1Y 0
L(ˆn)
 η0
0
dη ST
P(η, k) jL(kr) .
(10.265)
The product of the two spherical harmonics can be written via the Wigner 3 j-symbols
as follows:
2Y ±2
2 (ˆn)Y 0
L(ˆn) =

5(2L + 1)
4π

L′
√
2L′ + 1
 L 2
L′
0 ±2 ∓2
  L 2 L′
0 −2 2

2Y ±2
L′ (ˆn) ,
(10.266)
and we rotate in a generic ˆk direction the only spherical harmonic left, i.e.
2Y ±2
L′ (R ˆn) =
L′

m′=−L′
D(L′)
m′,±2[R−1(ˆk)]2Y m′
L′ (ˆn) .
(10.267)

10.9 Polarisation
359
Hence, we can write:
(Qλ + iUλ)(T)(k, ˆn) =

2
π

L
i L(2L + 1)

L′
√
2L′ + 1
 L 2 L′
0 λ −λ

 L 2 L′
0 −2 2
 
m′
D(L′)
m′λ[R(ˆk)]Y m′
L′ (ˆn)
 η0
0
dη ST
P(η, k) jL(kr) .
(10.268)
Now we can perform the Fourier anti-transform. Multiply by β(k, λ) and 2Y m∗
ℓ(ˆn)
and integrate over d2 ˆn in order to obtain the aT
P,ℓm’s. We obtain:
aT
P,ℓm,±2 =

2
π

L
i L(2L + 1)
√
2ℓ+ 1
 L 2
ℓ
0 ±2 ∓2

 L 2 ℓ
0 −2 2
 
d3k
(2π)3 D(ℓ)
m±2[R(ˆk)]β(k, λ)
 η0
0
dη ST
P(η, k) jL(kr) .
(10.269)
We have used here the orthonormality relation of the spin-2 spherical harmonics and
distinguished the contributions of different helicity. Of course aT
P,ℓm = aT
P,ℓm,+2 +
aT
P,ℓm,−2.
We have already computed some of the 3 j symbols earlier, for the tensor case but
now two more enter: those for L = ℓ± 1. We shall see that these contributions will
characterise the B-mode of polarisation. They are:
 ℓ+ 1 ℓ
2
0
−2 +2

= (−1)ℓ+1

(ℓ−1)
2(2ℓ+ 1)(2ℓ+ 3) ,
(10.270)
 ℓℓ−1 2
−2
0
+2

= (−1)ℓ

(ℓ+ 2)
2(2ℓ−1)(2ℓ+ 1) .
(10.271)
Extra care has to be used when manipulating these terms. The reason is that the 3 j
symbols gain an overall phase factor
(−1) j1+ j2+ j3 ,
(10.272)
where j1,2,3 are the momenta which are being combined, each time we swap two
columns or change simultaneously all the signs of the bottom row.4 Therefore, as long
as j1 + j2 + j3 is even, no matter how many times we perform the above operations.
This is the case for L = ℓ± 2 or L = ℓ. However, for L = ℓ± 1 we have that
4These signs can be changed only simultaneously since the sums m1 + m2 + m3 = 0 always. This
is a selection rule.

360
10
Anisotropies in the Cosmic Microwave Background
L + ℓ+ 2 = 2(ℓ+ 1) ± 1 ,
(10.273)
which is odd and thus we have to keep track of the correct sign.
Exercise 10.21 Using the formulas for the 3 j symbols, show that:
aT
P,ℓm,±2 = −iℓ√2ℓ+ 1
√
8π

d3k
(2π)3 D(ℓ)
m±2[R(ˆk)]β(k, λ)
 η0
0
dη ST
P(η, k)
 (ℓ+ 1)(ℓ+ 2)
(2ℓ−1)(2ℓ+ 1) jℓ−2(kr) −6(ℓ−1)(ℓ+ 2)
(2ℓ−1)(2ℓ+ 3) jℓ(kr) +
(ℓ−1)ℓ
(2ℓ+ 1)(2ℓ+ 3) jℓ+2(kr)
±2i ℓ−1
2ℓ+ 1 jℓ+1(kr) ∓2i ℓ+ 2
2ℓ+ 1 jℓ−1(kr)
	
.
(10.274)
Recall that r = r(η) ≡η0 −η.
Exercise 10.22 Show that, using the recurrence relation of Eq. (10.229) and the
following ones for the derivatives:
j′
ℓ(x) = jℓ−1(x) −ℓ+ 1
x
jℓ(x) ,
j′
ℓ(x) = ℓ
x jℓ(x) −jℓ+1(x) ,
(10.275)
we can write:
aT
P,ℓm = −iℓ√
2ℓ+ 1
√
8π

λ=±2

d3k
(2π)3 D(ℓ)
m,λ[R(ˆk)]β(k, λ)
 η0
0
dη ST
P(η, k)
 2
kr j′
ℓ−2 jℓ+ 2 + ℓ(ℓ+ 1)
(kr)2
jℓ−iλ

j′
ℓ+ 2
kr jℓ
	
.
(10.276)
Show that the term between square brackets is equal to the corresponding one in
Weinberg (2008, p. 389). In order to make the second derivative of the spherical
Bessel function to appear one must use Bessel differential equation:
j′′
ℓ+ 2
x jℓ+ 1 −ℓ(ℓ+ 1)
x2
jℓ= 0 .
(10.277)
Now we are ready to investigate the reality property of aT
P,ℓm and discern from it
the E-mode and B-mode contributions. Recall that Wigner D-matrix can be related
to the spin-weighted spherical harmonics as follows:

10.9 Polarisation
361
D(ℓ)
m,±2(ˆk) =

4π
2ℓ+ 1 ±2Y −m
ℓ
(ˆk) =

4π
2ℓ+ 1 ∓2Y m∗
ℓ(ˆk) .
(10.278)
So taking the complex conjugate we ﬁnd:
aT ∗
P,ℓm = −(−i)ℓ
√
2

λ=±2

d3k
(2π)3 ∓2Y m
ℓ(ˆk)β(−k, λ)
 η0
0
dη ST
P(η, k)
 2
kr j′
ℓ−2 jℓ+ 2 + ℓ(ℓ+ 1)
(kr)2
jℓ+ iλ

j′
ℓ+ 2
kr jℓ
	
.
(10.279)
Note that β(k, λ)∗= β(−k, λ) because of the reality condition and beware that the
sign of the imaginary unit inside the square brackets has changed. Now, changing
integration variable
k →−k ,
(10.280)
and taking advantage of the parity property and the complex conjugation property:
∓2Y m
ℓ(−ˆk) = (−1)ℓ
±2Y m
ℓ(ˆk) = (−1)ℓ
∓2Y −m∗
ℓ
(ˆk) ,
(10.281)
we get:
aT ∗
P,ℓm = −iℓ
√
2

λ=±2

d3k
(2π)3 ∓2Y −m∗
ℓ
(ˆk)β(k, λ)
 η0
0
dη ST
P(η, k)
 2
kr j′
ℓ−2 jℓ+ 2 + ℓ(ℓ+ 1)
(kr)2
jℓ+ iλ

j′
ℓ+ 2
kr jℓ
	
.
(10.282)
This time we have not the same situation as in Eq. (10.257) because of the iλ
contribution. Hence, we can compute the E-mode:
aT
E,ℓm = iℓ
√
2

λ=±2

d3k
(2π)3 ∓2Y m∗
ℓ(ˆk)β(k, λ)
 η0
0
dη ST
P(η, k)
 2
kr j′
ℓ−2 jℓ+ 2 + ℓ(ℓ+ 1)
(kr)2
jℓ
	
.
(10.283)
and the B-mode is also present:
aT
B,ℓm = −iℓ
√
2

λ=±2
λ

d3k
(2π)3 ∓2Y m∗
ℓ(ˆk)β(k, λ)
 η0
0
dη ST
P(η, k)

j′
ℓ+ 2
kr jℓ

(10.284)
Now we are in position of giving the formulas for the angular power spectra. Assum-
ing Gaussian perturbations we have:

362
10
Anisotropies in the Cosmic Microwave Background
CT
E E,ℓ=

dk
4πk 2
h(k)

 η0
0
dη ST
P(η, k)
 2
kr j′
ℓ−2 jℓ+ 2 + ℓ(ℓ+ 1)
(kr)2
jℓ
	
2
,
(10.285)
and
CT
BB,ℓ=

dk
4πk 2
h

 η0
0
dη ST
P(η, k)

2 j′
ℓ+ 4
kr jℓ

2
.
(10.286)
The cross-correlation CT
T E,ℓ, using Eq. (10.232) gives:
CT
T E,ℓ= −

(ℓ+ 2)!
(ℓ−2)!

dk
8πk 2
h(k)
 η0
0
dη ST (η, k)
jℓ
(kr)2
 η0
0
dη′ST
P(η′, k)
 2
kr j′
ℓ−2 jℓ+ 2 + ℓ(ℓ+ 1)
(kr)2
jℓ
	
.
(10.287)
If we try to compute the cross correlations CT
T B,ℓand CT
E B,ℓwe obtain a vanishing
result, as expected, because of the term λ in the sum of Eq. (10.284). In fact we get,
considering for example CT
E B,ℓ:
CT
E B,ℓ= −

λ=±2
λ
2

dk
4πk 2
h
 η0
0
dη ST
P(η, k)
 2
kr j′
ℓ−2 jℓ+ 2 + ℓ(ℓ+ 1)
(kr)2
jℓ
	
 η0
0
d ¯η ST
P( ¯η, k)

2 j′
ℓ+ 4
kr jℓ

.
(10.288)
Now, the sum over λ is equivalent to a difference and since nothing else depends on
λ the result is zero. The same happens with the correlation CT
T B,ℓ.
In Fig. 10.14 we display the 4 angular CMB power spectra which constitute a
wealth of cosmological information. The only possible cross-correlation is the one
between temperature and the E-mode of polarisation. The largest signal is the TT
one and then, in order of decreasing power, the TE, EE and BB one. The latter is 5
orders of magnitude smaller than the TT one and it has not yet been detected. The
bump it displays for small ℓ’s is due to reionisation.
From Fig. 10.14 we can appreciate how small the polarisation spectra are with
respect to the TT one. This is due to the fact that a quadrupole moment in the
distribution of photons is needed in order to have production of polarisation. Before
recombination, Thomson scattering rate is so high that photons are in nearly perfect

10.9 Polarisation
363
Fig. 10.14 The four angular power spectra characterising the CMB, computed with CLASS for
the standard model. Top left: TT. Top right: TE. Bottom left: EE. Bottom right: BB. As for the TT
spectrum, D ≡ℓ(ℓ+ 1)Cℓ/(2π)
thermal equilibrium and any moment from the quadrupole up is washed out. After
recombination, photons free stream and thus have no more chance of being polarised
by Thomson scattering.
References
Abbott, L.F., Wise, M.B.: Constraints on generalized inﬂationary cosmologies. Nucl. Phys. B 244,
541–548 (1984)
Abramowitz, M., Stegun, I.A.: Handbook of Mathematical Functions With Formulas, Graphs, and
Mathematical Tables. Dover (1972)
Ade, P.A.R., et al.: Planck 2015 results. XIII. Cosmological parameters. Astron. Astrophys. 594,
A13 (2016)
Eisenstein, D.J., et al.: Detection of the baryon acoustic peak in the large-scale correlation function
of SDSS luminous red galaxies. Astrophys. J. 633, 560–574 (2005)
Hu, W., Sugiyama, N.: Small scale cosmological perturbations: an analytic approach. Astrophys.
J. 471, 542–570 (1996)
Kaiser, N.: Small-angle anisotropy of the microwave background radiation in the adiabatic theory.
MNRAS 202, 1169–1180 (1983)
Landau, L.D., Lifshits, E.M.: Quantum Mechanics. Volume 3 of Course of Theoretical Physics.
Butterworth-Heinemann, Oxford (1991)
Ma, C.-P., Bertschinger, E.: Cosmological perturbation theory in the synchronous and conformal
Newtonian gauges. Astrophys. J. 455, 7–25 (1995)

364
10
Anisotropies in the Cosmic Microwave Background
Mukhanov, V.F.: CMB-slow, or how to estimate cosmological parameters by hand. Int. J. Theor.
Phys. 43, 623–668 (2004)
Mukhanov,V.: Physical FoundationsofCosmology.Cambridge UniversityPress,Cambridge (2005)
Racah, G.: Theory of complex spectra. II. Phys. Rev. 62(9–10), 438 (1942)
Sachs, R.K., Wolfe, A.M.: Perturbations of a cosmological model and angular variations of the
microwave background. Astrophys. J. 147, 73–90 (1967)
Seljak, U., Zaldarriaga, M.: A line of sight integration approach to cosmic microwave background
anisotropies. Astrophys. J. 469, 437–444 (1996)
Silk, J.: Fluctuations in the primordial ﬁreball. Nature 215(5106), 1155–1156 (1967)
Wands, D., Piattella, O.F., Casarini, L.: Physics of the cosmic microwave background radiation.
Astrophys. Space Sci. Proc. 45, 3–39 (2016)
Weinberg, S.: Cosmology. Oxford University Press, Oxford (2008)
Weinberg, S.: Lectures on Quantum Mechanics. Cambridge University Press, Cambridge (2015)

Chapter 11
Miscellanea
E desse modo ele ia levando a vida, metade na repartição, sem
ser compreendido, a outra metade em casa, também sem ser
compreendido
(And in this way he took life, half in the division, without being
understood, the other half at home, also without being
understood)
Lima Barreto, Triste ﬁm de Policarpo Quaresma
In this Chapter we collect some extra material which extends the topics treated so
far.
11.1
Bayesian Analysis Using Type Ia Supernovae Data
We discuss here how we can use type Ia supernovae in order to infer cosmological
information. We do not address important issues such as the calibration of the light
curves, how the distance moduli are calculated and the treatment of the systematic
errors. Moreover, some knowledge of statistics and Bayesian analysis is required.
The latter can be helped by e.g. Trotta (2017).
First of all, the measured quantities of interest are ﬂuxes, which for historical
reasons are given in a logarithmic scale called apparent magnitude m, deﬁned as
follows:
m ≡−5
2 log10
 F
F0

,
(11.1)
where F is the observed ﬂux and F0 is some reference ﬂux for which m = 0. One
should take into account that observations are made via ﬁlters which select a certain
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_11
365

366
11
Miscellanea
Table 11.1 Binned type Ia supernovae data. From Betoule et al. (2014)
zb
µb
zb
µb
zb
µb
0.010
32.9538
0.051
36.6511
0.257
40.5649
0.012
33.8790
0.060
37.1580
0.302
40.9052
0.014
33.8421
0.070
37.4301
0.355
41.4214
0.016
34.1185
0.082
37.9566
0.418
41.7909
0.019
34.5934
0.097
38.2532
0.491
42.2314
0.023
34.9390
0.114
38.6128
0.578
42.6170
0.026
35.2520
0.134
39.0678
0.679
43.0527
0.031
35.7485
0.158
39.3414
0.799
43.5041
0.037
36.0697
0.186
39.7921
0.940
43.9725
0.043
36.4345
0.218
40.1565
1.105
44.5140
1.300
44.8218
portion of the emitted spectrum. Therefore, the measured apparent magnitude m
depends on the ﬁlter which has been used. Moreover, one should also correct m by
the effect of interstellar absorption in such a way that its value really depends only
on how far the source is and not on the matter existing along the line of sight.
We do not take into account these important issues here and simply suppose to
be given with the bolometric magnitude, i.e. the magnitude corresponding to the
emission in the whole spectrum.
The absolute magnitude is the hypothetical apparent magnitude of an object
as if it were at a distance of 10pc. Since F ∝1/d2
L, using Eq. (11.1) the absolute
magnitude can be written as:
M ≡−5
2 log10

F
F0
 dL
10 pc
2
= m −5 log10
 dL
10 pc

.
(11.2)
The distance modulus is deﬁned as:
μ ≡m −M = 5 log10
 dL
10 pc

= 5 log10

dL
1 Mpc

+ 25 ,
(11.3)
where in the last equality we have introduced the Megaparsec (Mpc) as a more
appropriate distance scale for cosmology.
Almost a thousand type Ia supernovae are known today and many more are
expected to be detected by future experiments such as the LSST. For the sake of
simplicity, we use now the 31 binned data of Betoule et al. (2014), which we report
in Table11.1, and the relative binned 31×31 covariant matrix Cb, which we do not
report here.

11.1 Bayesian Analysis Using Type Ia Supernovae Data
367
Combining Eq. (11.3) with Eq. (2.155) allows us to ﬁnd the theoretical prediction
on μ(z), which we can adjust to the observed binned values of Table11.1 and thus
ﬁnd the best-ﬁt values for H0 and q0.
Note that there are binned redshifts larger than 1 in Table11.1 and for these
certainly the expansion of Eq.(2.155) is inaccurate. However, let us not worry about
this now, but focus only on how the analysis is performed.
The χ2 is calculated as follows:
χ2(h, q0) = rT · C−1
b
· r ,
(11.4)
where r is the vector of the differences between the observed μb and the predicted
one, i.e.
ri ≡μbi −5 log10
3000
h

zi + 1
2(1 −q0)z2
i

−25 ,
(11.5)
for i = 1, . . . , 31. The μbi and zi are those of Table11.1. Note that we have expressed
H0 as 100hkms−1 Mpc−1 and c = 3 × 105 kms−1.
Through the χ2 we deﬁne the likelihood:
L(h, q0) = Ne−χ2(h,q0)/2 ,
(11.6)
where N is a normalisation constant. The likelihood represents the probability of
having a dataset given a cosmological model. We are interested in the contrary, i.e.
in the probability of having a certain cosmological model given a dataset. This is
called posterior probability. If there is no a priori reason for which some values
of the parameters are preferred with respect to others, then the likelihood and the
posterior probability are equal.
Let us see what happens in our case. What we do is the following: we set up
a 100×100 grid in the parameter space (h, q0) with 0.65 < h < 0.75 and −0.7 <
q0 < 0.2. We choose these values because we already know the results, but in general
one has to explore the parameter space. Also the 100×100 grid is purely arbitrary as
one may choose a ﬁner one in order to improve precision.
For each point of the grid we compute the χ2 of Eq.(11.4) and thus construct the
likelihood as a function in the parameter space.1 Its maximum corresponds to the
minimum χ2 which in turn corresponds to the best ﬁt values for the parameters. In
our case, we ﬁnd:
χ2
min = 37.94 ,
h(bf) = 0.69 ,
q(bf)
0
= −0.18 ,
(11.7)
where the superscript bf means “best ﬁt”, of course. Note the negative best ﬁt value
of q0, which corresponds to an accelerated expansion.
1Mathematica codes which perform this task are available on my personal webpage http://ofp.
cosmo-ufes.org.

368
11
Miscellanea
Fig. 11.1 Contour plots at 68, 95 and 99% conﬁdence level (from the inner to the outer contour).
The big dot represent the best ﬁt values of Eq.(11.7)
We could in principle plot the likelihood as function of the parameters as a 3D
plot, but it is more convenient and visually clearer to plot contours, i.e. horizontal
slices of the likelihood, where horizontal means parallel to the (h, q0) plane. This is
what we have in Fig. 11.1.
In Fig.11.1 there are three contour plots, which correspond to 68, 95 and 99%
conﬁdence level. What are these? Starting from the maximum value of the likelihood
(represented by the big dot in Fig.11.1) we slice its graph with a horizontal plane
such that the volume enclosed is 68, 95 and 99%. If the contours are very close one
to each other then it means that the likelihood is very peaked and thus the measure
has been very precise.
Therefore, from Fig.11.1 we can say that q0 is negative with almost 99% of
conﬁdence and this is remarkable.
What happens if there are more than two parameters? In this case the likelihood
cannot be plotted, nor its 2-dimensional contours. Then, one performs marginalisa-
tion, i.e. one integrates the likelihood with respect to all the parameters but two. In
our case we did not need to do this because we had two parameters since the begin-

11.1 Bayesian Analysis Using Type Ia Supernovae Data
369
Fig. 11.2 Normalised probability distribution functions for h and q0
ning, but we can marginalise over one and get the probability distribution function
(PDF) for the other. This is done in Fig.11.2.
Now we can do something similar to the calculation of the contour plots based
on the conﬁdence levels. For each one of the PDF in Fig.11.2, starting from the
maximum and going down, we calculate the values of the parameters for which the
area encompassed is 68, 95 and 99%. these values represent the uncertainty over the
best ﬁt values of our parameters. In our case we have:
h = 0.69+0.015
−0.015 ,
q0 = −0.18+0.12
−0.13 ,
(11.8)
at 95% conﬁdence level.
Both the PDF’s for h and q0 are beautifully symmetric. This happens because of
the special way h and q0 enter in the χ2, i.e. the latter is quadratic in h and q0 and
therefore the PDF for each one of these parameters is a Gaussian function. This can
also be seen in the contour plots of Fig.11.1, which are ellipses. On the other hand,
if a parameter enters in a more complicated way into the χ2, then the contour plots
might be very asymmetric (typically they are “banana” shaped).
Exercise 11.1 Reproduce the analysis of this section developing a suitable numeri-
cal code.
11.2
Doing Statistics in the Sky
In Chap.7 we have tackled the stochastic character of cosmological perturbations
from a theoretical perspective. Here we offer a simplistic approach to how statistical
methods are applied observationally. More detailed and comprehensive treatments
can be found e.g. in Peebles (1980), Bonometto (2008).
As we learn in the very ﬁrst year of our Physics course, determining the value
of some physical quantity is no trivial task. The true value that we hope to ﬁnd

370
11
Miscellanea
is only an abstraction, being our measurements imperfect i.e. characterised by an
error that we try to harness with some mathematical tools. Statistics is one of them
and tells us for example that the more we repeat our measurements the closer to a
certain value the average goes. This certain value might be the true value, or not
if systematic errors are present. In other words, we might have a very precise but
inaccurate experiment. The approach of repeating experiments and measurements in
order to extract informations about an underlying pattern is called frequentist. The
question is: how do we apply that machinery to the universe, being this only one?
We want to learn something about gravity by observing how structures (galax-
ies) are distributed in the universe. We need statistics in order for our results to be
meaningful and thankfully there are many galaxies. Imagine a big volume V which
contains N galaxies. The galaxy number density is n = N/V . This, for example,
represents the volume of a certain survey. Getting information on the volume V in
itself is not meaningful, because we have just a single realisation of it. Therefore, let
us consider small spheres of radius R and volume
VR = 4π
3 R3 ,
(11.9)
with, of course, VR ≪V . Now, inside these spheres we would expect a number
¯NR ≡nVR of galaxies if these were randomly distributed, i.e. distributed according
to a Poisson distribution. But actually this is not the case, because of gravity. The
latter is attractive and therefore it is more probable to ﬁnd a galaxy closer to a big
cluster rather than to a smaller one. Therefore, studying the large scale structure of
the universe amounts to study the properties of gravity on large scales.
Now, let us count the galaxies in each one of the sphere that we have constructed.
We have different numbers depending on the sphere considered, say NR(x) because
the sphere has centre in x. The number density thus becomes
nR(x) = NR(x)
VR(x) .
(11.10)
It is not really a function of a continuous variable, because in practice x gets only a
countable amount of values, as many as the centres of the spheres chosen. Formally,
we have:
⟨nR(x)⟩= lim
ν→∞
1
ν
ν

i=1
nR(xi) = n .
(11.11)
For x being a continuous variable, we would have an integral:
⟨nR(x)⟩= 1
V
	
V
d3x nR(x) = n .
(11.12)
So, we have divided the initial big volume V into small spherical regions VR in order
to gain statistics, i.e. in order to deﬁne averages. In particular, the mass variance

11.2 Doing Statistics in the Sky
371
σ 2
R = ⟨(NR(x) −¯NR)2⟩
¯N 2
R
(11.13)
is a very important indicator, as we shall see in a moment.
Exercise 11.2 Assume that all galaxies have the same mass mg. Show that from
Eq.(11.13) we get
σ 2
R = ⟨(ρR(x) −ρ)2⟩
ρ2
=

δρR(x)
ρ
2
= ⟨δR(x)2⟩,
(11.14)
where ρR(x) ≡nR(x)mg is the mass-density inside a sphere of radius R, centered in
x and ρ = nmg, i.e. it is the background density, averaged over all V .
Theimportantpointshownbytheaboveexerciseisthatthemassvarianceisrelated
to the averaged smoothed squared density contrast. From the theory developed in
these lecture notes we know how to get δ(x). The point now is to learn how to smooth
it and for this purpose we need to use ﬁlters.
11.2.1
Top Hat and Gaussian Filters
The density contrast ﬁeld smoothed over a sphere of radius R can be formally written
as:
δR(x) =
	
VR(x)
d3u δ(u) .
(11.15)
Note that the x dependence of δR(x) comes from where we have centred the sphere.
We can transform the above integral into an equivalent one over the whole space,
which we need in order to use the Fourier transform:
δR(x) =
	
VR(x)
d3u δ(u) =
	
d3u WR(|x −u|)δ(u) ,
(11.16)
where
WR(y) =

1/VR
for y < R ,
0
for y > R ,
(11.17)
is the Top Hat ﬁlter, or window function (hence the symbol W for denoting it). It is
a simple trick to exclude all the information content beyond a certain scale R. There
is no reason for this to depend from the direction, therefore the argument of WR is the

372
11
Miscellanea
modulus |x −u|. A ﬁlter is a function that must not add or subtract any information,
therefore it must be normalised to unity:
	
d3y WR(y) = 1 .
(11.18)
In general, the functional form of a ﬁlter is:
WR(y) = 1
VR
w(y/R) ,
(11.19)
where w(y/R) is a generic function which goes to zero rapidly as y/R grows. In the
case of the Top Hat ﬁlter, for example, w is a Heaviside function. One can also have
a Gaussian ﬁlter:
WR(y) = (2π R2)−3/2e−y2/(2R2) .
(11.20)
Equation (11.16) is a convolution between the density contrast and the ﬁlter, hence
its Fourier transform is the product between the two Fourier transforms:
δR(k) = δ(k) ˜W(kR) ,
(11.21)
where we have already guessed the dependence kR for the Fourier transformed ﬁlter
since WR is a function of y/R.
Exercise 11.3 Calculate the Fourier transform of the Top Hat ﬁlter. Show that:
˜W(kR) =
3
(kR)3 [sin(kR) −(kR) cos(kR)] .
(11.22)
Of course, the Fourier transform of the Gaussian ﬁlter is still a Gaussian. The
Top Hat ﬁlter is very effective in the conﬁguration space since it cuts out all the
scales above a given one, i.e. WR = 0 if y/R > 1 or kR < 2π. However, its Fourier
transform scales as 1/(kR)3, so it is not cut out drastically. This gives rise to spurious
effects and therefore sometimes it might be safer to use the Gaussian ﬁlter, for which
one has the same cutoff also for the Fourier transform.
So, in Eq.(11.21) the left hand side is the smoothed density contrast, which on
should compare with observation. On the right hand side we have the full density
contrast and the window function. Actually, there is another observational limitation.
We have integrated over the whole space, together with a window function, in order
to smooth out but often a survey does not cover the full sky. Certainly not in depth
(we cannot observe up to inﬁnite redshift) and also not the full celestial sphere. There
is a mask say f (x) by which the effective density contrast that we are going to use
is
δeff(x) = f (x)δ(x) .
(11.23)

11.2 Doing Statistics in the Sky
373
Hence, its Fourier transform is the convolution of the two Fourier transforms:
δeff(k) = ( ˜f ∗δ)(k) =
	
d3k′ ˜f (k′)δ(k −k′) .
(11.24)
This convolution has important effects on the ﬁnal predictions of a model. In fact,
suppose that we have a theory providing a density contrast which oscillates and
then we expect of course an oscillating power spectrum. This would be ruled out if
compared directly with the data, but since the result of the convolution smooths out
oscillations, it might happen that the model still remains viable. See e.g. Moffat and
Toth (2011) for a discussion on this point.
11.2.2
Sampling and Shot Noise
We can formally deﬁne the following quantity:
n(x) ≡lim
R→0 nR(x) ,
(11.25)
as the number density ﬁeld. On the other hand, we do not observe such ﬁeld, but
only a ﬁnite amount of galaxies. Hence, observationally n(x) is realised by
n(x) =
N

i=1
δ(3)(x −xi) ,
(11.26)
i.e. abusing (since it is a distribution) of the Dirac delta of the positions of the galaxies
xi. Avoiding any abuse we could write:
n(x) =
N

i=1
1
a3π3/2 e−|x−xi|2/a2 ,
(11.27)
for a →0, i.e. using a representation of the Dirac delta.
Technically, when integrating Eq.(11.26) over a certain volume V we should
obtain the number of galaxies there contained. This is formally achieved by using
the Top Hat ﬁlter:
N =
	
V
dV n(x) =
N

i=1
	
dV w(x)δ(3)(x −xi) =
N

i=1
w(xi) ,
(11.28)
where w(x) = V W(x) and W(x) is equal to 1/V when x is inside the volume V
and zero otherwise (this ensures the normalisation to unity). In the last sum above
w(xi) = 1 only when xi is inside the volume V and hence the equation holds true.

374
11
Miscellanea
Now let us keep our sampling volume V , imagining that is the volume probed by
a certain survey. As we commented earlier, the effective density contrast ﬁeld is then
given by Eq.(11.23). The difference now is that we are constructing the observed
density contrast ﬁeld whereas in that equation it was our theoretical prediction. The
density ﬁeld is:
ρ(x) =
N

i=1
miδ(3)(x −xi) ,
(11.29)
where mi is the mass of the ith galaxy. The effective, or sampled, density contrast is
δs(x) =
ρ(x)
ρ
−1

w(x) =
N
i=1 miδ(3)(x −xi)
N
i=1 mi/V
−1

w(x) .
(11.30)
where ρ is the background density, which is equal to N
i=1 mi/V in the sampled
volume. Assuming the same mass for each galaxy, one obtains:
δs(x) =

V
N
N

i=1
δ(3)(x −xi) −1

w(x) .
(11.31)
Exercise 11.4 Show that the Fourier transform of the density contrast is then:
δs(k) = 1
N
N

i=1
w(xi)e−ik·xi −˜W(k) ,
(11.32)
where ˜W(k) is the Fourier transform of the Top Hat ﬁlter, computed in Eq. (11.22).
When we compute the power spectrum from the above realisation, and we suppose
a Gaussian distribution, we get for the mode k:
⟨δs(k)δ∗
s (k)⟩= 1
N 2
N

i, j=1
⟨w(xi)w(x j)⟩e−ik·(xi−x j) −
˜W(k)
N
N

i=1
⟨w(xi)⟩e−ik·xi
−
˜W(k)
N
N

i=1
⟨w(xi)⟩eik·xi + ˜W(k)2, (11.33)
where the average is an ensemble average. Since by deﬁnition:
⟨δs(k)⟩= 0 ,
(11.34)
we have that:

11.2 Doing Statistics in the Sky
375
1
N
N

i=1
⟨w(xi)⟩e−ik·xi = ˜W(k) .
(11.35)
Therefore:
⟨δs(k)δ∗
s (k)⟩= 1
N 2
N

i, j=1
⟨w(xi)w(x j)⟩e−ik·(xi−x j) −˜W(k)2 .
(11.36)
When i = j there is a contribution above of the form:
1
N 2
N

i=1
⟨w(xi)2⟩= 1
N .
(11.37)
This is an error (a variance) on the Fourier mode k which does not depend on the
wavenumber and is called shot noise. It comes from the fact that we are mapping a
continuous density ﬁeld with a discrete distribution, or sampling. It is the Poissonian
part of the distribution of galaxies, which must be subtracted in order to obtain the
true spectrum which is given by the correlations ⟨w(xi)w(x j)⟩.
Multiplying by V for dimensional reasons, we have thus the true power spectrum:
P(k) = V
N 2
N

i̸= j
⟨w(xi)w(x j)⟩e−ik·(xi−x j) −V ˜W(k)2 ,
(11.38)
and the noise spectrum:
Pn = V
N .
(11.39)
11.2.3
Correlation Function
How do we measure P(k) and put the data on a plot? All we observe are galaxies in
the sky. Consider again the very large volume V upon which we have worked until
now, containing N galaxies. So, the mean number density is n = N/V . Assuming
the same mass mg for every galaxy, ρ = Nmg/V is the mean density. Consider two
small volumes δV1 and δV2, centered in x1 and x2 respectively and much smaller
than V . If the distribution of galaxies was random, i.e. Poissonian, one would expect
δN1 = nδV1. Deviations from this randomness are due to gravity and are encoded
in the correlation function ξ(x1, x2):
⟨δN1(x1)δN2(x2)⟩= n2δV1δV2 [1 + ξ(x1, x2)] .
(11.40)

376
11
Miscellanea
We have already met the correlation function in Chap.7, in Eq.(7.11). There it was
deﬁned through the ensemble average, whereas here the average is made over all
the couples of volumes and clearly these must be chosen large enough in order to
contain many galaxies but sufﬁciently small in order to identify many of them in V .
Usually one assume that
ξ(x1, x2) = ξ(r) ,
(11.41)
where r = |x1 −x2|, i.e. the correlation function depends only on the distance of
the volumes, not on their positions or along which direction they are aligned. This is
again statistical homogeneity and isotropy. Dividing the above equation by δV1δV2,
one gets
⟨δn1(x)δn2(x + r)⟩= n2 [1 + ξ(r)] ,
(11.42)
where now the average can be interpreted as the integration over x.
Exercise 11.5 Show that the above equation can be written as:
⟨δ(x)δ(x + r)⟩= ξ(r) ,
(11.43)
and this gives a direct relation between the density contrast and the correlation func-
tion. Compare with Eq.(7.40).
The correlation function measures the galaxy clustering. From observation we
have the following empirical formula:
ξ(r) =
r0
r
γ
,
(11.44)
where r0 = 5.5 h−1 Mpc and γ ≈1.77 (Peebles 1980). The mass variance can be
related to the correlation function as follows:
σ 2
R = G(γ )ξ(R) ,
(11.45)
where G(γ ) ≈2. We can argue that the non-linear regime of cosmological becomes
dominant when σ 2
R = 1 and from the above formulae one can ﬁnd that this happens
at R = 8h−1 Mpc. Hence, this is why σ8 is so often used in cosmology.
The mass variance can be written as:
σ 2
R = ⟨δ2
R(x)⟩=
	
d3k
(2π)3
	
d3k′
(2π)3 ⟨δ(k) ˜W(kR)δ(k′) ˜W(k′R)⟩,
(11.46)
where we have used the Fourier transform of the smoothed density contrast, which
is the product of the density contrast times the window function (or ﬁlter). Using the
ensemble average we get:

11.2 Doing Statistics in the Sky
377
σ 2
R =
	
d3k
(2π)3 Pδ(k) ˜W(kR)2 =
	 ∞
0
dk
k 
2
δ(k) ˜W(kR)2
(11.47)
The above expression for the mass variance and that for the correlation function in
Eq. (7.46) are very similar being the difference in the function which weighs the
dimensionless power spectrum 
2. For the correlation function it is sin(kr)/(kr)
whereas for the mass-variance is the squared Fourier transform of the ﬁlter. If we
take the Top Hat ﬁlter then from Eq. (11.22) we see that ˜W(kR)2 decays as (kR)6.
11.2.4
Bias
The bias is the deviation of the clustering behaviour of ordinary matter from the one
of CDM. In general, we might suppose that structures of scale R are formed in those
sites where
δR(x) > νσR ,
(11.48)
where ν is some parameter. In this way we are stating that galaxies or clusters have
not exactly the same ﬂuctuation pattern as CDM. Deﬁne the biased density ﬁeld:
ρR,ν = θ[δR(x) −νσR] ,
(11.49)
where θ is the step function. For a Gaussian process, it can be shown that (Bonometto
2008)
⟨ρR,ν⟩≈
1
√
2π
1
ν e−ν2/2 ,
(11.50)
which gives
⟨nR,ν⟩≈
3
(2π)3/2R3ν e−ν2/2 .
(11.51)
The correlation function can be written then as
ξ (ν,R)(r) = eν2ξ R(r)/σ 2
R −1 ,
(11.52)
which, for a small exponential, can be cast as
ξ (ν,R)(r) = ν2
σ 2
R
ξ R(r) ≡b2ξ R(r) ,
(11.53)
and in general the relation between galactic and CDM density contrast is written as:
δg = bδ ,
(11.54)

378
11
Miscellanea
i.e. the same Eq.(9.1) that we presented in Chap.9. As we mentioned there, typically
b is treated as a parameter, though it may depend on the scale and on time.
References
Betoule, M., et al.: Improved cosmological constraints from a joint analysis of the SDSS-II and
SNLS supernova samples. Astron. Astrophys. 568, A22 (2014)
Bonometto, S.: Cosmologia and Cosmologie. Zanichelli (2008)
Moffat, J.W., Toth, V.T.: Comment on The Real Problem with MOND by Scott Dodelson (2011).
arXiv:1112.1320. ArXiv e-prints
Peebles, P.J.E.: The Large-scale Structure of the Universe. Princeton university press (1980)
Trotta, R.: Bayesian Methods in Cosmology (2017)

Chapter 12
Appendices
Like all people who try to exhaust a subject, he exhausted his
listeners
Oscar Wilde, The picture of Dorian Gray
Here are collected miscellaneous topics which are helpful in order to understand the
former chapters and to make these lecture notes as self-contained as possible.
12.1
Thermal Distributions
In this section we derive the functional form of the Maxwell–Boltzmann, Fermi–
Dirac and Bose–Einstein thermal distributions in the grand-canonical ensemble. See
e.g. Huang (1987) for a textbook reference.
12.1.1
Derivation of the Maxwell–Boltzmann Distribution
Suppose that we have a system of N classical particles distributed in K states of
different energies. Let us assume N > K. For each state i there are ni particles with
energy ei and the total energy of the system is ﬁxed and equal to E. Therefore, we
have two constraints:
N =
K

i=1
ni ,
E =
K

i=1
niei .
(12.1)
The number of microstates  which correspond to the macroscopical conﬁguration
of energy E is the following:
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4_12
379

380
12
Appendices
 ({ni}) =
N!
n1!n2! · · · nK! .
(12.2)
The numerator is N! because classical particles are distinguishable, so each of their
permutations counts as a microstate. However, permutations done within the same
state i do not count, hence we eliminate these possibilities dividing by n1!n2! · · · nK!.
Now take the logarithm of  and use Stirling’s approximation:
log  = log(N!) −
K

i=1
log(ni!) ≈N log N −N −
K

i=1
(ni log ni −ni) .
(12.3)
We have to ﬁnd the maximum for this expression, but taking into account the con-
straints (12.1). We then introduce Lagrange multipliers α and β and calculate the
differential:
d

N log N −N −
K

i=1
(ni log ni −ni) −α
K

i=1
ni −β
K

i=1
niei

= 0 .
(12.4)
The variables are the ni’s, thus:
K

i=1
(−log ni −α −βei) dni = 0 .
(12.5)
From this equation we obtain:
ni = exp(−α −βei) ≡exp

−ei −μ
kBT

,
(12.6)
where in the last equality we have associated the Lagrange multiplier α as the chem-
ical potential and 1/β as the thermal energy of the bath.
12.1.2
Derivation of the Fermi–Dirac Distribution
When calculating the Fermi–Dirac distribution two main differences with respect to
the Maxwell–Boltzmann case appear: the ﬁrst is that we have now quantum particles,
which are indistinguishable, and the second is that fermions obey Pauli’s exclusion
principle, so there could be at most one fermion per quantum state.
Let us assume again N quantum particles and K energy states. The only difference
now is that for each energy state i there are gi sub-states, i.e. the energy states are
degenerate. Let us focus on the energy state i. Here we must place ni fermions.
Because of Pauli’s exclusion principle, gi ≥ni, otherwise we would have more than
one fermion per state.

12.1 Thermal Distributions
381
Exercise 12.1 In how many ways can we ﬁt ni indistinguishable fermions in gi
energy “slots”? Prove that the answer is:
i =
gi!
ni!(gi −ni)! .
(12.7)
Since combinatorics might be sometimes irksome, and after all these are lecture notes
in cosmology, we offer a proof in the footnote. Try however not jumping to it right
away and to work out the solution yourself.1
The total number of micro-states is then:
 ({ni}) =
K

i=1
i =
K

i=1
gi!
ni!(gi −ni)! .
(12.8)
Now we proceed as before, taking the logarithm of :
log  =
K

i=1

log(gi!) −log(ni!) −log((gi −ni)!)
	
,
(12.9)
using Stirling’s approximation and calculating the constrained maximum:
K

i=1

−log ni + log(gi −ni) −α −βei
	
dni = 0 ,
(12.10)
one obtains:
log gi −ni
ni
= α + βei ,
(12.11)
and ﬁnally:
ni = gi
1
1 + exp(α + βei) ≡gi
1
1 + exp

ei−μ
kBT
 ,
(12.12)
with the same physical meanings for α and β as those stated for the Maxwell–
Boltzmann distribution.
1We can choose gi slots for the ﬁrst fermion, gi −1 for the second and so on until ﬁnally we can
choose gi −ni + 1 slots for the nith fermion. This gives gi!/(gi −ni)! and we only used Pauli’s
exclusion principle. Until here, then, the order of the chosen particles matter, e.g. having fermion 1
in the ﬁrst slot is different from having fermion 2 in the ﬁrst slot. But fermions are indistinguishable,
therefore we must divide by ni! and hence the result (12.7).

382
12
Appendices
12.1.3
Derivation of the Bose–Einstein Distribution
The setup for deriving the Bose–Einstein distribution is the same as the one used in
the previous subsection for the Fermi–Dirac distribution except for the fact that now
Pauli’s exclusion principle does not apply and so the constraint ni ≤gi does not hold
true anymore. This changes the way in which we calculate i.
Exercise 12.2 Show that:
i =
ni + gi −1
gi −1

= (ni + gi −1)!
ni!(gi −1)!
.
(12.13)
This is the same calculation of how many nith partial derivatives of a function of gi
variables there are. This is of course related to the fact that the wave-function of an
ensemble of bosons is symmetric, just as partial derivatives are. Again, a proof is
given in the footnote.2
Proceeding as we did in the previous two subsections, we ﬁnd:
K

i=1

log(ni + gi −1) −log ni −α −βei
	
dni = 0 ,
(12.14)
and ﬁnally:
ni = gi
1
exp(α + βei) −1 ≡gi
1
exp

ei−μ
kBT

−1
.
(12.15)
12.2
Derivation of the Poisson Distribution
Poisson distribution describes stochastic independent events happening randomly in
time but with a certain average rate say λ. It is important for the description particle
scattering or decaying processes and we have used it in Chap. 3 in order to take into
account the neutron decay during BBN and also in Chap. 10 when we have discussed
the visibility function.
Let P(n; λ, t) be the probability that n events occur in a time interval t, given the
rate λ. Consider a sufﬁciently small time interval δt, for which:
P(1; λ, δt) = λδt ,
P(0; λ, δt) = 1 −λδt .
(12.16)
2Imagine ni particles and gi slots where to ﬁt them. These slots are separated by gi −1 walls. So,
compute all the permutations among these objects, which are (ni + gi −1)!, but do not consider the
permutations among the walls (gi −1)! and the particles, ni!, because they are indistinguishable.
So, we ﬁnd Eq. (12.13).

12.2 Derivation of the Poisson Distribution
383
Indeed, we can regard the ﬁrst formula as the deﬁnition of λ. Therefore, calculating
P(0; λ, t + δt) one gets:
P(0; λ, t + δt) = P(0; λ, t)(1 −λδt) ,
(12.17)
where we have used the independence of the randomly occurring events.
Exercise 12.3 From Eq. (12.17) show that:
P(0; λ, t) = e−λt .
(12.18)
Now, exploiting the independence of the events, we can ﬁnd a recurrence relation
for P(n; λ, t). Consider the following:
P(n; λ, t + δt) = P(n; λ, t)(1 −λδt) + P(n −1; λ, t)λδt ,
(12.19)
i.e. n events in a time interval t + δt can either occur as n in the time interval t and
none in the subsequent δt or n −1 in the time interval t and just one in the subsequent
δt. This is because we have chosen δt sufﬁciently small in order to accommodate at
most one event.
From the above equation we have then:
d P(n; λ, t)
dt
+ λP(n; λ, t) = λP(n −1; λ, t) .
(12.20)
Exercise 12.4 From Eq. (12.20) show that:
P(1; λ, t) = λte−λt .
(12.21)
By induction show that:
P(n; λ, t) = (λt)n
n! e−λt .
(12.22)
This is Poisson distribution. Another way to ﬁnd it is from the binomial distribu-
tion:
P(N; n, p) =
N
n

pn(1 −p)N−n ,
(12.23)
where N is the number of trials, n are the successful ones and p is the probability of
success for a single trial.

384
12
Appendices
Exercise 12.5 Assume N →∞and p →0 such that Np stays constant. Perform-
ing these limits in Eq. (12.23) and using Stirling’s approximation show that:
P(n, Np) = (Np)n
n!
e−Np .
(12.24)
Deﬁning Np ≡λt, we recover again Poisson distribution (12.22).
12.3
Helmholtz Theorem
We follow here Appendix B of Grifﬁths (2017). Let F(r) be a vector ﬁeld. Let its
divergence and curl be the following:
∇· F(r) ≡D(r) ,
∇× F(r) ≡C(r) .
(12.25)
By construction, the divergence of the curl is vanishing:
∇· [∇× F(r)] = ∇· C(r) = 0 ,
(12.26)
hence C(r) is a solenoidal, i.e. divergenceless, vector ﬁeld.
Helmholtz theorem states that F(r) can be decomposed as:
F(r) = −∇U(r) + ∇× W(r) ,
(12.27)
where:
U(r) ≡1
4π

V
d3r′ D(r′)
|r −r′| ,
W(r) = 1
4π

V
d3r′ C(r′)
|r −r′| .
(12.28)
Since the integration is over the whole space, in order for it to be well-deﬁned D(r)
and C(r) must tend to zero more rapidly than 1/r2 for r →∞. This can be seen
from the fact that:
d3r′
|r −r′| ∼dr′ r′ ,
for r′ →∞,
(12.29)
and then if the two functions D and C scaled as 1/r
′2 we would have a logarithmic
divergence.
By taking the divergent of Eq. (12.27), remembering that the divergent of a curl
is vanishing, and using Eq. (12.25) we can easily check that:
D(r) = ∇· F(r) = −∇2U(r) ,
(12.30)

12.3 Helmholtz Theorem
385
which is a Poisson equation and its solution is the ﬁrst equation of Eq. (12.28).
On the other hand, by taking the curl of (12.27), remembering that the curl of the
gradient is vanishing, we can check that:
C(r) = ∇× [∇× W(r)] = ∇[∇· W(r)] −∇2W .
(12.31)
The Laplacian term only gives the second equation of Eq. (12.28), but what about
the ∇[∇· W(r)] term? Does it vanishes? Let us check that this is the case:
∇· W(r) = 1
4π

V
d3r′C(r′) · ∇

1
|r −r′|

= −1
4π

V
d3r′C(r′) · ∇′

1
|r −r′|

=
−1
4π

∂V
dS′ · C(r′)
1
|r −r′| + 1
4π

V
d3r′∇′ · C(r′)
1
|r −r′| .
(12.32)
In the last line, both contributions vanish. The ﬁrst is a surface integral at inﬁnity and
in the second the divergence of C(r) is zero by construction.
In principle, the decomposition of Eq. (12.27) might not be unique because we
could add to F(r) a vector ﬁeld say G(r) which has both vanishing divergence and
curl.Ontheotherhand,itcanbeprovedthatthereisnosuchG(r),withbothvanishing
divergence and curl and which goes to zero at inﬁnity. Therefore, if F(r) goes to zero
sufﬁciently fast at inﬁnity then the decomposition in Eq. (12.27) is indeed unique.
12.4
Conservation of R on Large Scales and for Adiabatic
Perturbations
In order to show the constancy of R on large scales and for adiabatic perturbations,
let us start from Eq. (4.185) and combine its scalar part with the deﬁnition of R given
in Eq. (4.131):
R =  + H
′ −H
4πGa2(ρ + P) .
(12.33)
Exercise 12.6 Differentiate Eq. (4.131) with respect to the conformal time and show
that:
4πGa2(ρ + P)R′ = 4πGa2(ρ + P)′ + H′ 
′ −H

+H

′′ −H′ −H′

+ H2 
′ −H

+ 3H2 P′
ρ′

′ −H

,
(12.34)

386
12
Appendices
where ρ′ = −3H(ρ + P) has been used.
Exercise 12.7 Use the generalised Poisson equation (4.179), written as
3H

′ −H

+ k2 = 4πGa2δρ ,
(12.35)
and the background relation:
4πGa2(ρ + P) = H2 −H′ ,
(12.36)
in order to cast Eq. (12.34) as follows:
4πGa2(ρ + P)R′ = H

′′ + 2H′ −H′ −2H′ −H2

+H P′
ρ′

4πGa2δρ −k2

.
(12.37)
The ﬁrst term on the right hand side can be simpliﬁed using the Einstein equation
(4.189), so that we have:
4πGa2(ρ + P)R′ = −4πGa2HδP −k2H
3 ( + ) + H P′
ρ′

4πGa2δρ −k2

.
(12.38)
Recalling the gauge-invariant entropy perturbation that we introduced in Eq. (4.129):
 ≡δP −P′
ρ′ δρ ,
(12.39)
we can ﬁnally write:
R′ = −H

ρ + P −H P′
ρ′
k2
H2 −H′ −H k2( + )
3(H2 −H′)
(12.40)
The ﬁrst term on the right-hand side vanishes if the perturbations are adiabatic,
whereas the second and third terms on the right-hand side vanish on large scales,
leaving thus R constant.
The gauge-invariant variables R and ζ can be related in the following way. First,
using their deﬁnitions (4.131) and (4.132) in the Newtonian gauge we can write:
ζ = R −Hv +
δρ
3(ρ + P) .
(12.41)
Second,writedowntherelativisticPoissonequation(4.179)andthevelocityequation
(4.185) in the following form:

12.4 Conservation of R on Large Scales and for Adiabatic Perturbations
387
3H′ −3H2 + k2 = 4πGa2δρ ,
(12.42)
′ −H = 4πGa2 (ρ + P) v ,
(12.43)
and combine them in order to give the constraint:
12πGHa2(ρ + P)v + k2 = 4πGδρ .
(12.44)
Using this constraint, the relation in Eq. (12.41) becomes:
ζ = R +
k2
12πGa2(ρ + P)
(12.45)
Since (ρ + P)a2 is of order H2, then ζ −R is of order k2/H2, which vanishes for
large scales. This means that if R is conserved then ζ also is.
The result found here conﬁrms our previous calculation ended with Eq. (6.94), in
Chap. 6, when we investigated the adiabatic primordial modes.
12.5
Spherical Harmonics
In this section we brieﬂy review spherical harmonics. These are the eigenfunctions of
the Laplacian operator on the sphere or, equivalently, the eigenfunctions of the square
of the angular momentum operator. They form a complete orthonormal system and
therefore any function on the sphere can be expanded in a linear combination of
spherical harmonics. That is why they are extensively used in cosmology to analyse
CMB anisotropies in temperature and polarisation: the latter are ﬁelds (of spin zero
and spin 2, respectively) on the celestial sphere. In this section we shall follow
principally (Butkov 1968). However, many references exist dealing with the theory
of the angular momentum and spherical harmonics, so the reader is encouraged to
ﬁnd the treatment which most suits them.
Exercise 12.8 Find the expression of the Laplacian operator on the sphere. The line
element on the unit sphere is:
ds2
S = gabdxadxb = dθ2 + sin2 θdφ2 ,
(12.46)
with a, b = θ, φ, and naturally we have chosen spherical coordinates. Use the for-
mula:
∇2 =
1
√g
∂
∂xa

gab√g ∂
∂xb

,
(12.47)
where √g is the determinant of the metric and ﬁnd:

388
12
Appendices
∇2 =
1
sin θ
∂
∂θ

sin θ ∂
∂θ

+
1
sin2 θ
∂2
∂φ2 .
(12.48)
Let us then set up the eigenvalue equation:
1
sin θ
∂
∂θ

sin θ∂Y(θ, φ)
∂θ

+
1
sin2 θ
∂2Y(θ, φ)
∂φ2
= λY(θ, φ) .
(12.49)
Assume that the θ and φ dependences can be factorised, i.e. let us write3:
Y(θ, φ) = (θ)(φ) ,
(12.50)
so that:
sin θ

d
dθ

sin θd
dθ

−λ sin2 θ = −1

d2
dφ2 .
(12.51)
Now, the left hand side depends only on θ whereas the right hand side only on φ.
Therefore, the only possible way for them to be equal is to be equal to the same
constant, which we call m2. In this way we have now two equations:
d2
dφ + m2 = 0 ,
sin θ d
dθ

sin θd
dθ

−λ sin2 θ = m2 .
(12.52)
The ﬁrst one is very simple to solve and gives us:
 = e±imφ ,
(12.53)
with some normalisation which we will determine afterwards for the full Y(θ, φ).
On the other hand,  must be periodic since φ or φ + 2π denote the same angular
position. Hence:
eimφ = eim(φ+2π) ,
(12.54)
which implies:
ei2mπ = 1 ,
(12.55)
and therefore m must be an integer, positive or negative, or zero. The equation for 
can be treated as follows.
Exercise 12.9 Consider the new variable:
x ≡cos θ .
(12.56)
3The function (θ) here is not the relative temperature ﬂuctuation and (φ) is not the Bardeen
potential.

12.5 Spherical Harmonics
389
Show that the derivative with respect to θ satisﬁes:
sin θ d
dθ = −(1 −x2) d
dx ,
(12.57)
and hence the equation for (x) can be written as follows:
d
dx

(1 −x2)d(x)
dx

−λ(x) −
m2
1 −x2 (x) = 0 .
(12.58)
Now, we need (x) to be regular at x = ±1, i.e. for θ = 0 or θ = π. A way to
investigate this is to change variable:
z = 1 ∓x ,
(12.59)
in order to trade the neighbourhood of x = ±1 for that of z = 0.
Exercise 12.10 Obtain the new equation for (z) and z = 1 −x:
z(2 −z)d2
dz2 + 2(1 −z)d
dz −λ −
m2
z(2 −z) = 0 .
(12.60)
Now, using Frobenius method we look for a solution of the form:
(z) = zs
∞

n=0
anzn .
(12.61)
where s ≥0 in order for (z) to be regular for z →0.
Exercise 12.11 Substitute the above ansatz in Eq. (12.60) and equate to zero power
by power. Show that we get from the lowest power (which is zs) that:
s = ±m
2 .
(12.62)
Let us stipulate that m ≥0. Then we must choose the positive sign, i.e. s = m/2,
since z−m/2 →∞for z →0.
Exercise 12.12 Carry on a similar analysis for x = −1, by transforming variable to
z = 1 + x. Show that again s = m/2.

390
12
Appendices
Combining the results from the above exercises we can conclude that (x) must
have the following form:
(x) = (1 −x2)m/2 f (x) ,
(12.63)
where f (x) is an analytic function, non-vanishing for x = ±1. We have also learnt
that (x) does vanish for x ± 1, except when m = 0. Now, let us ﬁnd an equation
for f .
Exercise 12.13 Substituting Eq. (12.63) into (12.58) show that:
(1 −x2)d2 f
dx2 −2x(m + 1)d f
dx −(λ + m + m2) f = 0 .
(12.64)
We now prove that λ = −ℓ(ℓ+ 1), with ℓinteger such that ℓ≥m. This result will
stem out of the requirement of regularity of f . Adopting again Frobenius method,
let us stipulate that:
f (x) = xs
∞

n=0
anxn .
(12.65)
Exercise 12.14 Substitute the above ansatz into Eq. (12.64) and ﬁnd the following
relation:
∞

n=0
an(n + s)(n + s −1)xn+s−2 =
∞

n=0
an [m(m + 1) + λ + 2(m + 1)(n + s) + (n + s)(n + s −1)] xn+s .
(12.66)
The two series can be combined starting from n = 2.
Exercise 12.15 Show that:
a0s(s −1)xs−2 + a1s(s + 1)xs−1 +
∞

n=2
an(n + s)(n + s −1)xn+s−2 =
∞

n=2
an−2 [m(m + 1) + λ + 2(m + 1)(n + s −2) + (n + s −2)(n + s −3)] xn+s−2 .
(12.67)

12.5 Spherical Harmonics
391
Now the two series can be merged in a single one and equating to zero each power
we have that either s = 0 or s = 1. These conditions lead to the following recursion
relations for the series coefﬁcients:
an+2 = n(n −1) + λ + m(m + 1) + 2n(m + 1)
(n + 2)(n + 1)
an ,
(s = 0) ,
(12.68)
an+2 = n(n + 1) + λ + m(m + 1) + 2(n + 1)(m + 1)
(n + 3)(n + 2)
an ,
(s = 1) .
(12.69)
The integral test of convergence fails because an+2/an →1 for n →∞, hence the
series solution would diverge unless:
n(n −1) + λ + m(m + 1) + 2n(m + 1) = 0 ,
(s = 0) ,
(12.70)
n(n + 1) + λ + m(m + 1) + 2(n + 1)(m + 1) = 0 ,
(s = 1) .
(12.71)
These are constraints on λ, which has then to assume the following form:
λ = −(m + n)(m + n + 1) ,
(s = 0) ,
(12.72)
λ = −(m + n + 1)(m + n + 2) ,
(s = 1) ,
(12.73)
or, in general:
λ ≡−ℓ(ℓ+ 1)
(12.74)
with ℓinteger and ℓ≥m, which is what we wanted to prove. This result can be
obtained also in quantum mechanics, by exploiting the commutation relations of the
components of the angular momentum operator, see e.g. Weinberg (2015). We have
adopted here an approach based on calculus.
The above condition on λ implies that the series solution for f terminates after the
(ℓ−m)th term and thus (x) is a polynomial. The polynomials thus obtained for
all the possible choices of (ℓ, m) are known as associated Legendre polynomials
and denoted as Pm
ℓ(x). Equation (12.58) can be thus written as:
d
dx

(1 −x2)d Pm
ℓ(x)
dx

+

ℓ(ℓ+ 1) −
m2
1 −x2

Pm
ℓ(x) = 0
(12.75)
and it is known as the general Legendre equation. Via some manipulation it is
possible to obtain it from the Legendre equation:
d
dx

(1 −x2)dPℓ(x)
dx

+ ℓ(ℓ+ 1)Pℓ(x) = 0
(12.76)

392
12
Appendices
and therefore write the associated Legendre polynomials as:
Pm
ℓ(x) = (1 −x2)m/2 dm
dxm [Pℓ(x)] .
(12.77)
Using Rodrigues’ formula:
Pℓ(x) =
1
2ℓℓ!
dℓ
dxℓ[(x2 −1)ℓ] ,
(12.78)
we have then
Pm
ℓ(x) = (1 −x2)m/2
2ℓℓ!
dℓ+m
dxℓ+m [(x2 −1)ℓ] ,
(12.79)
and this formula allows us to extend the deﬁnition of Pm
ℓ(x) also for negative values of
m, such that ℓ≥|m| or −ℓ≤m ≤ℓ, as we are used from the theory of the angular
momentum in quantum mechanics. In these notes we have adopted the following
convention:
P−m
ℓ
= (ℓ−m)!
(ℓ+ m)! Pm
ℓ.
(12.80)
Another, perhaps more standard convention includes a (−1)m factor, but we choose
to omit it in order to have the following property for the spherical harmonics under
complex conjugation:
Y m∗
ℓ(θ, φ) = Y −m
ℓ
(θ, φ)
(12.81)
We can now ﬁnally write down the explicit formula for the spherical harmonics:
Y m
ℓ(θ, φ) =

(2ℓ+ 1)(ℓ−m)!
4π(ℓ+ m)!
Pm
ℓ(cos θ)eimφ
(12.82)
where the normalisation has been chosen in order to have
 π
0
dθ sin θ
 2π
0
dφ Y m
ℓ(θ, φ)Y m′∗
ℓ′
(θ, φ) = δℓℓ′δmm′
(12.83)
which is probably the single most important relation about spherical harmonics
because it tells us that they form an orthonormal system. This is also complete,
i.e. the spherical harmonics satisfy the following completeness relation:
∞

ℓ=0
ℓ

m=−ℓ
Y m
ℓ(θ, φ)Y m∗
ℓ(θ′, φ′) =
1
sin θδ(θ −θ′)δ(φ −φ′) ,
(12.84)

12.5 Spherical Harmonics
393
Therefore, any square-integrable function f (θ, φ) can be expanded as:
f (θ, φ) =
∞

ℓ=0
ℓ

m=−ℓ
aℓmY m
ℓ(θ, φ) ,
(12.85)
in an unique way (meaning that the aℓm’s are unique for that function). The δmm′ in
the orthonormality can be easily understood from the dφ integration, since:
 2π
0
dφ ei(m−m′)φ =
ei(m−m′)φ
i(m −m′)

2π
0
= 0 ,
(12.86)
for m ̸= m′, leaving only the m = m′ possibility and the 2π value of the integral.
The δℓℓ′ part of the orthonormality relation depends of course on the properties of
the associated Legendre polynomials, but we do not give further detail here.
It is important to know the parity of the spherical harmonics, i.e. how Y m
ℓ(ˆn)
changes under ˆn →−ˆn. In terms of the angles:
ˆn →−ˆn
⇒
(θ, φ) →(π −θ, π + φ) .
(12.87)
Since cos(π −θ) = −cos θ, spatial inversion amount to x →−x for the associated
Legendre polynomial and therefore a (−1)ℓ+m factor coming from the derivative in
the formula of Eq. (12.79). The exponential exp(imφ) instead becomes:
eimφ →eim(π+φ) = eimπeimφ = (−1)meimφ .
(12.88)
Therefore, we ﬁnally have:
Y m
ℓ(π −θ, π + φ) = (−1)ℓY m
ℓ(θ, φ)
(12.89)
A formula that we have intensively employed in these notes is the expansion of a
plane wave into spherical harmonics:
eik·r = 4π
∞

ℓ=0
ℓ

m=−ℓ
iℓY m∗
ℓ(ˆk)Y m
ℓ(ˆr) jℓ(kr)
(12.90)
where the complex conjugation can be switched from one spherical harmonic to the
other, since k · r = r · k. Also, we have made great use of the addition theorem:
Pℓ(x · y) =
4π
2ℓ+ 1
ℓ

m=−ℓ
Y m∗
ℓ(y)Y m
ℓ(x)
(12.91)

394
12
Appendices
We can then combine the plane wave expansion with the addition theorem and get:
eik·r =
∞

ℓ=0
iℓ(2ℓ+ 1)Pℓ(ˆk · ˆr) jℓ(kr) .
(12.92)
We now turn to the spin-weighted spherical harmonics.
12.5.1
Spin-Weighted Spherical Harmonics
The usual spherical harmonics allow to expand a scalar quantity such as the temper-
ature on the sphere. Consider a rotation R such that
ˆn →ˆn′ = R ˆn .
(12.93)
Since the relative temperature ﬂuctuation is a scalar, we have that:
′(ˆn′) = (ˆn) .
(12.94)
Using the expansion in spherical harmonics we can write:

ℓm
a′
ℓmY m
ℓ(ˆn′) =

ℓm
aℓmY m
ℓ(ˆn) .
(12.95)
Now we take advantage of the properties of the spherical harmonics under spatial
rotation, i.e.
Y m
ℓ(R ˆn) =
ℓ

m′=−ℓ
D(ℓ)
m′m(R−1)Y m′
ℓ(ˆn)
(12.96)
where the D(ℓ)
m′m are the elements of the Wigner D-matrix. See Landau and Lifshits
(1991) for more detail. Hence, we can write:

ℓm
a′
ℓmY m
ℓ(ˆn′) =

ℓmm′
aℓm D(ℓ)
m′m(R)Y m′
ℓ(ˆn′) ,
(12.97)
and readjusting the indices we ﬁnally have:
a′
ℓm =

m′
D(ℓ)
m′m(R)aℓm′
(12.98)
since the spherical harmonics form an orthonormal basis. This is an important relation
because it tells us that the angular power spectrum is independent from the direction,
i.e. it is rotationally invariant:

12.5 Spherical Harmonics
395
C′
ℓ= ⟨a′
ℓma
′∗
ℓm⟩=

M M′
D(ℓ)
mM D(ℓ)∗
mM′⟨aℓMa∗′
ℓM⟩= Cℓ

M
D(ℓ)
mM D(ℓ)∗
mM = Cℓ,
(12.99)
the product of Wigner D-matrices being unity since it represents a product of one
rotation with its inverse. Hence we have found that the power spectrum is a rotational
invariant. This is a consequence of the fact that  is a scalar, but what about another
function which is not? In Sect. 12.7 we shall see that indeed the Stokes parameters
are not scalars, i.e. upon a rotation ˆn →ˆn′ = R ˆn we have in general that:
Q′(ˆn′) ̸= Q(ˆn) ,
U ′(ˆn′) ̸= U(ˆn) .
(12.100)
Therefore, if we expand them on a spherical harmonics basis we would get power
spectra depending on the orientation of our coordinate frame.
In order to avoid this, we must employ the spin-weighted spherical harmonics.
These were introduced in Newman and Penrose (1966) in the context of gravitational
waves, which also have polarisation. Using their notation, η is a spin-s quantity if it
transforms as:
η(ˆn) →η(ˆn)′ = esiψη(ˆn) ,
(12.101)
under a rotation of an angle ψ about the line of sight ˆn. Then, one deﬁnes the
differential operators ð and ¯ð as:
ðη = −(sin θ)s
 ∂
∂θ +
i
sin θ
∂
∂φ
 
(sin θ)−sη
	
,
(12.102)
¯ðη = −(sin θ)−s
 ∂
∂θ +
i
sin θ
∂
∂φ
 
(sin θ)sη
	
,
(12.103)
in spherical coordinates and proves that ðη is a spin-(s + 1) quantity whereas ¯ðη is
a spin-(s −1) quantity. These operators are essentially covariant derivative on the
sphere, as we shall see in Sect. 12.7. The spin-s spherical harmonics are thus deﬁned
as:
sY m
ℓ=

(ℓ−s)!
(ℓ+ s)!ðsY m
ℓ
(0 ≤s ≤ℓ) ,
(12.104)
sY m
ℓ= (−1)s

(ℓ+ s)!
(ℓ−s)!
¯ð−sY m
ℓ
(−ℓ≤s ≤0) .
(12.105)
The spin-weighted spherical harmonics have fundamental properties similar to those
characterising the usual ones. First of all:
0Y m
ℓ(θ, φ) = Y m
ℓ(θ, φ) ,
(12.106)

396
12
Appendices
i.e. the usual spherical harmonics can be regarded as spin-0. Then, the sY m
ℓform a
complete orthonormal system, i.e. they are orthonormal
 π
0
dθ sin θ
 2π
0
dφ sY m
ℓ(θ, φ)sY m′∗
ℓ′
(θ, φ) = δℓℓ′δmm′
(12.107)
and complete:
∞

ℓ=0
ℓ

m=−ℓ
sY m
ℓ(θ, φ)sY m∗
ℓ(θ′, φ′) =
1
sin θδ(θ −θ′)δ(φ −φ′)
(12.108)
and therefore any spin-s quantity η can be expanded as:
η(θ, φ) =
∞

ℓ=0
ℓ

m=−ℓ
ηℓm sY m
ℓ(θ, φ)
(12.109)
Under complex conjugation and spatial inversion the spin-weighted spherical har-
monics transform as:
sY m∗
ℓ
= (−1)s
−sY −m
ℓ
,
sY m
ℓ(−ˆn) = (−1)ℓ
−sY m
ℓ(ˆn) ,
(12.110)
and they can be related to the Wigner D-matrix as follows:
D(ℓ)
ms(φ, θ, ψ) =

4π
2ℓ+ 1
sY −m
ℓ
(θ, φ)eisψ ,
(12.111)
where (φ, θ, ψ) are the Euler angles.
12.6
Method of Green’s Functions
Suppose that we have a linear differential equation, which we write as follows:
Ly(x) = f (x) ,
(12.112)
where L is a second-order linear differential operator. Suppose also that we have
been able to solve the homogeneous equation Ly(x) = 0 and found the solution:
yhom(x) = C1y1(x) + C2y2(x) .
(12.113)

12.6 Method of Green’s Functions
397
How, knowing this, do we determine the solution to the complete, non-homogeneous
equation? Recall that Green’s function is deﬁned by:
LG(x, x′) = δ(x −x′) ,
(12.114)
and from G(x, x′) the general solution to the complete equation is readily found via
convolution with the non-homogeneous term:
y(x) =
 x
xi
dx′ G(x, x′) f (x′) ,
(12.115)
where xi is our initial value.
Exercise 12.16 Check that the above convolution Eq. (12.115) is solution
of Eq. (12.112).
So, we must determine G(x, x′). We can do this by noticing that it is solution of
the homogeneous equation when x ̸= x′ and thus we can write:
G(x, x′) =

A1y1(x) + A2y2(x)
for x < x′
B1y1(x) + B2y2(x)
for x > x′
,
(12.116)
where the A’s and B’s are integration constants to be determined. Since L is a second
order linear differential equation, we want that:
• Since LG(x, x′) = δ(x −x′), the derivative of G(x, x′) must be discontinuous in
x = x′, i.e. it must be a θ function.
• On the other hand, G(x, x′) is continuous in x = x′.
So, with these two conditions, we impose the following matching:

A1y1(x′) + A2y2(x′) = B1y1(x′) + B2y2(x′)
B1y′
1(x′) + B2y′
2(x′) −A1y′
1(x′) −A2y′
2(x′) = 1
.
(12.117)
Note that whatever the gap of the discontinuity might be, we can always normalise
it to unity by renormalising the integration constants. The above system can be cast
in the following form:

(B1 −A1)y1(x′) + (B2 −A2)y2(x′) = 0
(B1 −A1)y′
1(x′) + (B2 −A2)y′
2(x′) = 1
.
(12.118)
The unknowns of this system are the differences among the integration constants and
the determinant of the system is:

398
12
Appendices
W(x′) = (y1y′
2 −y′
1y2)(x′) ,
(12.119)
i.e. the Wronskian, which is certainly different from zero because y1 and y2 are
independent solutions. Therefore, we use Cramer’s rule and ﬁnd:
B1 −A1 = −y2(x′)
W(x′) ,
B2 −A2 = y1(x′)
W(x′) .
(12.120)
We have freedom of choosing two of the four constants. Therefore, choosing A1 =
A2 = 0:
G(x, x′) =

0
for x < x′
−y2(x′)y1(x)+y1(x′)y2(x)
W(x′)
for x > x′
,
(12.121)
and so this is our Green function which, in convolution with f (x′) gives us the
complete solution to our non-homogenous differential equation:
y(x) =
 x
xi
dx′ −y2(x′)y1(x) + y1(x′)y2(x)
W(x′)
f (x′)
(12.122)
12.7
Polarisation
In this section we recall the terminology regarding the polarisation of an electromag-
netic wave. The standard reference is Jackson (1998), but see also Grifﬁths (2017).
12.7.1
Electromagnetic Waves
Let us start from Maxwell equations in vacuum and in Minkowski space:
∇· E = 0 ,
∇× E = −∂B
∂t ,
∇· B = 0 ,
∇× B = 1
c2
∂E
∂t .
(12.123)
Exercise 12.17 Combine Maxwell equations in order to ﬁnd the wave equations:
□E = 1
c2
∂2E
∂t2 −∇2E = 0 ,
□B = 1
c2
∂2B
∂t2 −∇2B = 0 .
(12.124)

12.7 Polarisation
399
The general solutions of the wave equations are thus:
E(t, x) = E0 f ( ˆp · x −ct) ,
B(t, x) = B0g( ˆp′ · x −ct) ,
(12.125)
where ˆp and ˆp′ are in principle distinct directions of propagation, f and g two distinct
functions and E0 and B0 are the amplitudes of the wave describing the electric ﬁeld
and of the one describing the magnetic ﬁeld.
Now we can constrain all this freedom using indeed the very Maxwell equations.
We have:
∇· E = 0
⇒
E0 · ˆp f ′ = 0
⇒
E0 · ˆp = 0 ,
(12.126)
∇× E = −∂B
∂t
⇒
ˆp × E0 f ′ = −∂B
∂t
⇒
ˆp × E0 f ′ = B0g′c ,
(12.127)
where f ′ and g′ are the derivatives of f and g with respect to their arguments. From
the ﬁrst equation we learn that the electric ﬁeld oscillates perpendicularly to the
direction of its propagation.
Exercise 12.18 Show from the other couple of Maxwell equations that:
∇· B = 0
⇒
B0 · ˆp′ = 0 ,
(12.128)
∇× B = 1
c2
∂E
∂t
⇒
ˆp′ × B0g′ = −1
c E0 f ′ ,
(12.129)
from which we learn that also the magnetic ﬁeld oscillates perpendicularly to the
direction of its propagation. For now this is distinct from the one of the electric ﬁeld.
Now, since ˆp · ( ˆp × E0) = 0, we can conclude that ˆp × B0 = 0, and therefore
that the magnetic ﬁeld is perpendicular to both the directions of propagation. On the
other hand:
ˆp′ × ( ˆp × E0) f ′ = ˆp′ × B0g′c = −E0 f ′ .
(12.130)
Hence, being f ′ not identically vanishing otherwise we would not have a wave, we
can conclude that:
ˆp′ × ( ˆp × E0) = −E0 .
(12.131)
Exercise 12.19 Use the rule for the triple cross product and show that:
ˆp( ˆp · E0) −E0( ˆp · ˆp′) = −E0 .
(12.132)

400
12
Appendices
Therefore, being ˆp · E0 = 0 and E0 non-vanishing, we must conclude that:
ˆp · ˆp′ = 1
⇒
ˆp = ˆp′ ,
(12.133)
since both are unit vectors and therefore the scalar product equal to unity means that
the angle between them must be vanishing. Thus, we have proven that electric and
magnetic ﬁeld propagate in the same direction. Now we prove that f = g:
|E0|
|B0|c = g′
f ′ .
(12.134)
In principle we should ask f ′ ̸= 0 in order to make meaningful the above expression,
but since the left hand side is time-independent, so the right hand side must be.
Therefore:
g = |E0|
|B0|c f + K ,
(12.135)
where K is an integration constant. Hence, we can write:
E = E0 f ,
B = B0
 |E0|
|B0|c f + K

.
(12.136)
Without losing any generality we can take |E0| = |B0| and K = 0, and still we have
a solution to Maxwell equations. Hence:
B = 1
c ˆp × E
(12.137)
For this reason, the polarisation properties of an electromagnetic wave can be anal-
ysed with respect to the electric ﬁeld only.
12.7.2
Polarisation Ellipse and Stokes Parameters
Now we focus on a monochromatic electromagnetic plane wave, propagating in the
direction ˆp = ˆz. In complex notation the electric ﬁeld can be written as:
E(t, x) = E0ei(z−ct) =
⎛
⎝
Ex
Ey
0
⎞
⎠ei(z−ct) ,
(12.138)
where the two-dimensional vector is called the Jones vector. It is often useful to
work with complex ﬁelds in electrodynamics, but here it will not be necessary so let
us instead work with:

12.7 Polarisation
401
E(t, x) =
⎡
⎣
Ex(t, x)
Ey(t, x)
0
⎤
⎦=
⎡
⎣
Ax cos(z −ct + φx)
Ay cos(z −ct + φy)
0
⎤
⎦.
(12.139)
The wave equation that we have solved in the previous subsection is for a vector
quantity, the electric ﬁeld. Hence, there are actually three wave equations, one for
each component. However, we have seen that the electromagnetic wave is transversal,
therefore one of the component can always be put to zero, as we have done above by
choosing ˆp = ˆz. We have then two second-order differential equations and thus we
expect 4 integration constants, which we have introduced above as the amplitudes Ax
and Ay and the phases φx and φy. From these 4 quantities depends the polarisation
state of the wave.
We can always redeﬁne our clock such that:
E =
⎡
⎣
Ex(t, x)
Ey(t, x)
0
⎤
⎦=
⎡
⎣
Ax cos(z −ct)
Ay cos(z −ct + β)
0
⎤
⎦,
(12.140)
where β ≡φy −φx is the relative phase, which is indeed the relevant physical quan-
tity. So we have actually 3 independent parameters which describe polarisation.
When β = 0, the polarisation is purely linear, whereas when β = π/2 it is purely
circular. This can be seen in general by studying the time-evolution of the ﬁeld in
the Ey −Ex plane. In fact, we have:
E2
x
A2x
+
E2
y
A2y
−2Ex Ey
Ax Ay
cos β = sin2 β
(12.141)
This is the equation of an ellipse, the polarisation ellipse, rotated by an angle α in
the Ey −Ex plane.
Exercise 12.20 Deﬁning:
Ax = A cos θ ,
Ay = A sin θ ,
(12.142)
show that:
tan 2α = tan 2θ cos β ,
(12.143)
and that the semi-major and semi-minor axis of the polarisation ellipse are given by:
a2 = A2
2

1 +

1 −sin2 2θ sin2 β

,
(12.144)
b2 = A2
2

1 −

1 −sin2 2θ sin2 β

.
(12.145)

402
12
Appendices
When β = 0 we have b = 0, i.e. the ellipse degenerates in a straight line, titled
by an angle α with respect to the Ex axis. In this case the wave is purely linearly
polarised. On the other hand, when β = π/2 the ellipse degenerates in a circle, and
thus we have a purely circularly polarised wave.
The Stokes parameters are deﬁned as follows in terms of the polarisation ellipse
parameters:
I ≡a2 + b2 = A2 ,
(12.146)
Q ≡(a2 −b2) cos 2α = A2

1 −sin2 2θ sin2 β cos 2α = A2 cos 2θ ,
(12.147)
U ≡(a2 −b2) sin 2α = A2

1 −sin2 2θ sin2 β sin 2α = A2 sin 2θ cos β ,
(12.148)
V ≡2abh = (A2 sin 2θ sin β)h ,
(12.149)
where h = ±1 simply establishes the direction of rotation, clockwise (h = −1) or
anti-clockwise (h = 1). Note that the Stokes parameter I is the intensity of the wave.
Pure Q polarisation. If U = V = 0, then β = 0 and therefore we have pure linear
polarisation. Since sin 2α = 0 then either α = 0 or α = π/2. In the former case the
electric ﬁeld oscillates along the x-axis and Q = A2 = I > 0. If α = π/2 then the
electric ﬁeld oscillates along the y-axis and Q = −A2 = −I < 0.
Pure U polarisation. If Q = V = 0, then β = 0 and therefore we have again pure
linear polarisation. This time cos 2α = 0 then either α = π/4 or α = 3π/4. In the
former case the electric ﬁeld oscillates along the y = x line and Q = A2 = I > 0.
If α = 3π/4 then the electric ﬁeld oscillates along the y = −x line and Q = −A2 =
−I < 0.
Pure V polarisation. If Q = U = 0, then θ = π/4 and β = π/2 and therefore we
have pure circular polarisation. We have V = A2h = ±A2 = ±I, with the sign deter-
mined by the direction of rotation.
As we have seen, the polarisation is fully determined by 3 parameters. These
means that the 4 Stokes parameters are not independent.
Exercise 12.21 Show that the Stokes parameters satisfy the following constraint:
Q2 + U 2 + V 2 = I 2
(12.150)
Other deﬁnitions of the Stokes parameters are the following. Using the complex
electric ﬁeld:

12.7 Polarisation
403
E(t, x) =
⎛
⎝
Ex
Ey
0
⎞
⎠ei(z−ct) ,
(12.151)
they are deﬁned as:
I ≡|Ex|2 + |Ey|2 ,
Q ≡|Ex|2 −|Ey|2 ,
(12.152)
U ≡2Re(Ex E∗
y) ,
V ≡−2Im(Ex E∗
y) .
(12.153)
We have considered so far a monochromatic wave, possibly made up of many waves
but all coherent. On the other hand, if we consider the superposition of incoherent
waves then we can write a generic time-dependence for the electric ﬁeld:
E(t, x) =
⎡
⎣
Ex(t, x)
Ey(t, x)
0
⎤
⎦,
(12.154)
and therefore the Stokes parameters are deﬁned as expectation values:
I ≡⟨E2
x⟩+ ⟨E2
y⟩,
Q ≡⟨E2
x⟩−⟨E2
y⟩,
(12.155)
U ≡2⟨Ex Ey⟩cos β ,
V ≡2⟨Ex Ey⟩sin β ,
(12.156)
as for example time-averages:
⟨X⟩= 1
T
 T
0
dt X(t) .
(12.157)
In this case the electric ﬁeld is a random variable and we can just deﬁne polarisation
through averages. Moreover, in this case one has:
Q2 + U 2 + V 2 ≤I 2
(12.158)
since each Stokes parameter is deﬁned as the sum of the corresponding Stokes param-
eters of all the waves composing the total one. See e.g. Chandrasekhar (1960).
Exercise 12.22 Show that the three deﬁnitions of Stokes parameters given above
are in fact equivalent for a single monochromatic sinusoidal wave.
Now, suppose to make successive anti-clockwise rotations of π/4 in the polarisa-
tion plane. What happens is the following:
Q →U →−Q →−U →Q .
(12.159)

404
12
Appendices
That is, after a half rotation about the propagation direction we recover the initial
polarisation state, as if we applied an identity operator. This suggests us that we
are dealing with a spin-2 ﬁeld. Indeed, let us introduce the intensity matrix for an
electromagnetic wave propagating along −ˆz:
Ji j(−ˆz) = 1
2
⎛
⎝
I (ˆz) + Q(ˆz) U(ˆz) −iV (ˆz) 0
U(ˆz) + iV (ˆz) I (ˆz) −Q(ˆz) 0
0
0
0
⎞
⎠,
(12.160)
where the factor 1/2 serves in order to reproduce the correct result that the trace
Jii = I. This intensity matrix reminds us of hT
i j, the tensor perturbation of the metric,
deﬁned in Eq. (4.198).
Exercise 12.23 Show that applying the a rotation of an angle θ about the axis ˆz we
have that:
I →I ,
(12.161)
Q ± iU →e±2iθ(Q ± iU) ,
(12.162)
V →V .
(12.163)
The different sign with respect to the GW case is due to the fact that the rota-
tion is made about the propagation direction −ˆz. Hence, a rotation by θ about −ˆz
corresponds to a rotation by −θ about ˆz, which is the line-of-sight direction.
The matrix deﬁned on the two-dimensional subspace orthogonal to the propaga-
tion direction:
ρi j(−ˆz) = 1
2
 I (ˆz) + Q(ˆz) U(ˆz) −iV (ˆz)
U(ˆz) + iV (ˆz) I (ˆz) −Q(ˆz)

,
(12.164)
is called photon density matrix and can be suggestively put in the following form:
ρ = 1
2(I1 + Qσ3 + Uσ1 + V σ2) ,
(12.165)
where 1 is the 2 × 2 identity matrix and the σ1,2,3 are the Pauli matrices. It might
seem strange that the latter could be associated to a photon, since they are usually
employed for the description of spin-1/2 particles whereas the photon is a spin-1
boson.However,sincethephotonismasslessitischaracterisedbyonlytwospinstates
±1 (or helicities), just as any spin-1/2 particle, massive or massless, is characterised
by two spin states ±1/2.
The polarisation vectors introduced in Eq. (4.213) can be deﬁned equivalently
here. Along the ˆz axis they are simply:

12.7 Polarisation
405
e±(ˆz) = (1, ±i, 0)/
√
2 ,
(12.166)
and the Stokes parameters are deﬁned as:
Q(ˆz) ± iU(ˆz) = 2e±,i(ˆz)e±, j(ˆz)Ji j(−ˆz) .
(12.167)
For a generic direction of propagation, say −ˆn, we deﬁne:
Q(ˆn) ± iU(ˆn) = 2e±,i(ˆn)e±, j(ˆn)Ji j(−ˆn) ,
(12.168)
where in spherical coordinates:
ˆn = (sin θ cos φ, sin θ sin φ, cos θ) ,
(12.169)
and the basis vectors which form the polarisation vectors can be chosen as:
ˆθ = (cos θ cos φ, cos θ sin φ, −sin θ) ,
ˆφ = (−sin φ, cos φ, 0) .
(12.170)
Hence:
e±(ˆn) =
ˆθ ± i ˆφ
√
2
.
(12.171)
As we have already discussed, Q ± iU are spin-2 ﬁelds and thus are expanded as:
(Q + iU)(ˆn) =

ℓm
aP,ℓm 2Y m
ℓ(ˆn) .
(12.172)
Through the polarisation vectors we can characterise the operator ð as
ðs = (−1)s2s/2e+,i1(ˆn) · · · e+,is(ˆn) ˜∇i1 · · · ˜∇is
(12.173)
where
˜∇= ˆθ ∂
∂θ +
ˆφ
sin θ
∂
∂φ ,
(12.174)
is the covariant derivative on the sphere.
Exercise 12.24 Show that the deﬁnition of Eq. (12.102) and formula (12.173) are
identical for s = 1 and s = 2.

406
12
Appendices
Fig. 12.1 Scattering plane.
The unit vectors ˆy′ and ˆy are
equal and going out from the
page orthogonally
12.8
Thomson Scattering
In this section we work out the collisional term of Eq. (5.104). We follow the cal-
culations of Chandrasekhar (1960), but take advantage of the properties of spherical
harmonics, as done in Hu and White (1997). See also Kosowsky (1996).
Consider an incoming wave propagating in the direction ˆp′ and scattered in the
direction ˆp. The plane in which ˆp′ and ˆp lie is called scattering plane.
Choosing the simple geometry of Fig. 12.1, the incoming electric ﬁeld can be
decomposed as follows:
E′ = E′
x ˆx′ + E′
y ˆy′ ,
(12.175)
i.e. with no ˆz′ component, since this is the direction of propagation. When the electric
ﬁeld interacts with the electron, this starts to oscillate and to emit electromagnetic
waves in almost all directions. The “almost” is make quantitative by Larmor for-
mula, for which the irradiated power per solid angle is:
d P
d =
e2
4πc3
 ˆp × ( ˆp × a)
2 ,
(12.176)
where a is the electron acceleration. See e.g. Jackson (1998) and note that here we
are using Gaussian units for which [F] = [e2/r2], i.e. the force can be dimensionally
expressed as squared Coulomb divided by a squared length. For a particular outgoing
polarisation say ˆϵ, we make the scalar product with ˆϵ in the square modulus of the
above formula and obtain:
d P
d =
e2
4πc3
ˆϵ · a
2 .
(12.177)
The acceleration of the electron is produced by the incident electric ﬁeld E′:
a = e
m E′ ,
(12.178)
so that:
d P
d =
e4
4πm2c3
ˆϵ · E′2 .
(12.179)

12.8 Thomson Scattering
407
Writing now E′ = ˆϵ′|E′|, we get:
d P
d = c
4π |E′|2
 e2
mc2
2 ˆϵ · ˆϵ′2 .
(12.180)
Thecontributionc|E′|2/(4π)isthePoyntingvectorandhencetheﬂuxoftheincoming
wave, leaving:
dσ
d =
 e2
mc2
2 ˆϵ · ˆϵ′2 ≡3σT
8π
ˆϵ · ˆϵ′2
(12.181)
as the differential cross section, where of course σT is the Thomson cross section.
The above derivation is based on Larmor formula and thus it is purely classical and
valid only for a non-relativistic movement of the electron and for photon energies
much smaller than the electron mass. If these conditions are not met, one should
employ the Klein–Nishina formula, see e.g. Weinberg (2005).
Let us assume σT = 1, for simplicity. We shall recover the correct dimensions
only at the end of our derivation via the scattering rate −τ ′ = neσTa. The electric
ﬁeld scattered in the direction ˆp is of the form:
E = A

ˆp × ( ˆp × E′)
	
,
(12.182)
where A2 = 3/(8π). Let us use now the geometry in the scattering plane of Fig. 12.1
and calculate the double cross product.
Exercise 12.25 Show that:
E = −A

ˆx′E′
x cos2 β + ˆy′E′
y + ˆz′E′
x sin β cos β

.
(12.183)
Since ˆy = ˆy′, we can already conclude that:
Ey = −AE′
y ,
(12.184)
i.e. the electric ﬁeld contribution perpendicular to the scattering plane gains no angu-
lar dependence.
In order to calculate Ex, which is the contribution of electric ﬁeld parallel to the
scattering plane, we need to know ˆx. One has:
ˆx = ˆy × ˆp ,
(12.185)
and
ˆp = (sin β, 0, −cos β) .
(12.186)

408
12
Appendices
Hence:
ˆx = −ˆx′ cos β −ˆz′ sin β .
(12.187)
Therefore we have:
Ex = E · ˆx = AE′
x cos β .
(12.188)
We are now in the position of relating the Stokes parameter of the outgoing wave to
those of the incoming one:
I = ⟨E2
x⟩+ ⟨E2
y⟩= A2⟨E
′2
x ⟩cos2 β + A2⟨E2
y′⟩≡A2I ′
x cos2 β + A2I ′
y ,
(12.189)
Q = ⟨E2
x⟩−⟨E2
y⟩= A2I ′
x cos2 β −A2I ′
y ,
(12.190)
U = 2⟨Ex Ey⟩cos β = A2U ′ cos β ,
(12.191)
V = 2⟨Ex Ey⟩sin β = A2V ′ cos β .
(12.192)
Using now the deﬁnitions:
I ′ = ⟨E
′2
x ⟩+ ⟨E2
y′⟩,
(12.193)
Q′ = ⟨E
′2
x ⟩−⟨E2
y′⟩,
(12.194)
we have the complete transformation:
⎛
⎜⎜⎝
I
Q
U
V
⎞
⎟⎟⎠= 3
8π
⎛
⎜⎜⎝
1+cos2 β
2
−sin2 β
2
0
0
−sin2 β
2
1+cos2 β
2
0
0
0
0
cos β
0
0
0
0
cos β
⎞
⎟⎟⎠
⎛
⎜⎜⎝
I ′
Q′
U ′
V ′
⎞
⎟⎟⎠.
(12.195)
These Stokes parameters have dimension of intensity. We now introduce , the tem-
perature ﬂuctuation instead of I and suitably redeﬁne all the other Stokes parameters.
Moreover, we introduce the combination Q ± iU, since we know how it transforms
under a rotation in the polarisation plane, cf. Eq. (12.161). We shall need this rotation
in a moment. We have then:
⎛
⎝

Q + iU
Q −iU
⎞
⎠=
3
16π
⎛
⎜⎝
1 + cos2 β −sin2 β
2
−sin2 β
2
−sin2 β
(1+cos β)2
2
(1−cos β)2
2
−sin2 β
(1−cos β)2
2
(1+cos β)2
2
⎞
⎟⎠
⎛
⎝
′
Q′ + iU ′
Q′ −iU ′
⎞
⎠,
(12.196)
and V does not mix up with the other Stokes parameter, so we consider it separately:

12.8 Thomson Scattering
409
Fig. 12.2 Scattering
geometry
V = 3 cos β
16π V ′ .
(12.197)
Recall that the above transformations hold true in the scattering plane and the primed
quantities depend on the incoming direction ˆp′ whereas the unprimed quantities
from ˆp.
We now have to transform to a generic reference frame in which the incident wave
comes from a direction (θ′, φ′) and the outgoing wave goes along a direction (θ, φ).
This calculation is performed in Chandrasekhar (1960) but we follow Hu and White
(1997) because it is faster and takes advantage of the properties of the spherical
harmonics which we have seen earlier. In particular, we refer to Fig. 12.2.
We need to perform a rotation R(−α) in order to pass from the laboratory frame
to the scattering frame. Recall that the rotation is performed in the polarisation
plane, i.e. about −ˆp′. Hence it is a clockwise rotation and for this reason we have
−α. Then we apply the above matrix say S(β) in order to obtain the outgoing
Stokes parameters. Finally, we apply another rotation R(−γ) in order to obtain the
Stokes parameters in the laboratory frame. This rotation seems to be anti-clockwise
because it is in the direction opposite to R(−α). However, notice that ˆp is now
outgoing and thus the polarisation plane is reﬂected, giving then R(−γ) instead of
R(γ).
Exercise 12.26 Using the transformation of Eq. (12.161) and the fact that  is
invariant under rotation in the polarisation plane, show that:
selectfont

410
12
Appendices
R(−γ)S(β)R(−α) =
3
16π
⎛
⎜⎜⎝
1 + cos2 β
−sin2 β
2
e−2iα
−sin2 β
2
e2iα
−e−2iγ sin2 β e−2iγ (1+cos β)2
2
e2iα e−2iγ (1−cos β)2
2
e2iα
−e2iγ sin2 β e2iγ (1−cos β)2
2
e−2iα e2iγ (1+cos β)2
2
e2iα
⎞
⎟⎟⎠,
(12.198)
Since also V is invariant under rotation in the polarisation plane, Eq. (12.200) is
valid even in the laboratory frame.
Exercise 12.27 Using the deﬁnitions of spherical harmonics given in Table 5.1,
write the above matrix as:
R(γ)S(β)R(−α) = 1
8π

4π
5
⎛
⎝
Y 0
2 + 2
√
5Y 0
0 −√3/2Y −2
2
−√3/2Y 2
2
−
√
6e−2iγ2Y 0
2 3e−2iγ2Y −2
2
3e−2iγ2Y 2
2
−
√
6e2iγ−2Y 0
2 3e2iγ−2Y −2
2
3e2iγ−2Y 2
2
⎞
⎠.
(12.199)
The spherical harmonics inside this matrix are function of (β, α). For V show that:
V = 1
4

3
4π Y 0
1 (β, α)V ′ .
(12.200)
Now, using the addition theorem:
ℓ

m=−ℓ
s1Y m∗
ℓ(θ′, φ′)s2Y m
ℓ(θ, φ) = 2ℓ+ 1
4π
s2Y −s1
ℓ
e−is2γ ,
(12.201)
we can introduce the matrix:
P(m)( ˆp, ˆp′) =
⎛
⎝
Y m∗
2 Y m
2
−√3/22Y m∗
2 Y m
2 −√3/2−2Y m∗
2 Y m
2
−
√
6Y m∗
2
2Y m
2
32Y m∗
2
2Y m
2
3−2Y m∗
2
2Y m
2
−
√
6Y m∗
2
−2Y m
2
32Y m∗
2
−2Y m
2
3−2Y m∗
2
−2Y m
2
⎞
⎠, (12.202)
where the complex conjugates spherical harmonics depend on ˆp′ whereas the others
depend on ˆp. Hence, the scattered Stokes parameters can then be written as:
⎛
⎝

Q + iU
Q −iU
⎞
⎠= 1
4π
⎛
⎝
′
0
0
⎞
⎠+ 1
10
2

m=−2
P(m)( ˆp, ˆp′)
⎛
⎝
′
Q′ + iU ′
Q′ −iU ′
⎞
⎠,
(12.203)
whereas for V we can write:
V ( ˆp) = 1
4
1

m=−1
Y m
1 ( ˆp)Y m∗
1 ( ˆp′)V ( ˆp′) .
(12.204)

12.8 Thomson Scattering
411
Integrating over all the incoming directions and multiplying by the Thomson scat-
tering rate:
−τ ′ = neσTa ,
(12.205)
we obtain part of the collisional terms for the Boltzmann equation (5.104). This is
the scattering rate into photons with momentum in the direction ˆp, which we have
taken as the reference direction. There is also a contribution which takes into account
the scattering of photons into other directions different from ˆp. This generates the
term:
τ ′
⎛
⎝

Q + iU
Q −iU
⎞
⎠.
(12.206)
Finally, all the calculations performed here assume the electron ﬂuid at rest. Per-
forming a boost, we get the Doppler shift term −τ ′ ˆp · vb. Indeed, the photon energy
in the new frame is given by:
˜p = p(1 −vb · ˆp) ,
(12.207)
upon a boost with velocity vb. The Lorentz factor on the right hand side is unity since
|vb|2 is negligible, being a ﬁrst-order quantity. The perturbed distribution Fγ, being
a scalar, transforms as:
Fγ(p) = ˜Fγ[p(1 −vb · ˆp)] ,
(12.208)
and thus, developing the distribution function up to ﬁrst-order, we get:
Fγ(p) = ˜Fγ(p) −∂¯fγ
∂p pvb · ˆp ,
(12.209)
and using Eq. (5.80) we have that:
 = ˜ + vb · ˆp .
(12.210)
We have thus fully recovered the collisional term of Eq. (5.104).
Finally, consider initially unpolarised photons. Then, upon scattering:
⎛
⎝

Q + iU
Q −iU
⎞
⎠( ˆp) =
⎛
⎝
 d2 ˆp′
4π ( ˆp′)
0
0
⎞
⎠
+ 1
10
2

m=−2
⎛
⎝
Y m
2
−
√
62Y m
2
−
√
6−2Y m
2
⎞
⎠( ˆp)

d2 ˆp′Y m∗
2 ( ˆp′)( ˆp′) .
(12.211)
Expanding the relative temperature ﬂuctuation in spherical harmonics:

412
12
Appendices
( ˆp′) =

ℓm
aℓmY m
ℓ( ˆp′) ,
(12.212)
due to the orthogonality properties of the latter, polarisation will be produced only
if the incident ( ˆp′) has a quadrupole moment.
References
Butkov, E.: Mathematical Physics. Addison-Wesley Publishing Company, Incorporated (1968)
Chandrasekhar, S.: Radiative Transfer. Dover, New York (1960)
Grifﬁths, D.J.: Introduction to Electrodynamics. Cambridge University Press, Cambridge (2017)
Hu, W., White, M.J.: CMB anisotropies: total angular momentum method. Phys. Rev. D 56, 596–615
(1997)
Huang, K.: Statistical Mechanics, 2nd edn. Wiley-VCH, New York (1987)
Jackson, J.D.: Classical Electrodynamics, 3rd edn. Wiley-VCH, New York (1998)
Kosowsky, A.: Cosmic microwave background polarization. Ann. Phys. 246, 49–85 (1996)
Landau, L.D., Lifshits, E.M.: Quantum Mechanics. Course of Theoretical Physics, vol. 3.
Butterworth-Heinemann, Oxford (1991)
Newman, E.T., Penrose, R.: Note on the Bondi-Metzner-Sachs group. J. Math. Phys. 7, 863–870
(1966)
Weinberg, S.: The Quantum Theory of Fields. Vol. 1: Foundations. Cambridge University Press,
Cambridge (2005)
Weinberg, S.: Lectures on Quantum Mechanics. Cambridge University Press, Cambridge (2015)

Index
A
Absolute magnitude, 366
Acceleration equation, 28
Acoustic oscillations, 320
Adiabatic speed of sound, 138, 279
Age of the universe, 30, 31
Alternatives to , 11
Angular diameter distance, 51
Anisotropic stress, 126, 147
Anthropic principle, 11
Apparent magnitude, 365
Associated Legendre polynomials, 391
Axion, 6
B
Bardeen’s potentials, 137
Baryogenesis, 58
Baryon Acoustic Oscillations (BAO), 288,
321
Baryon feedback, 12
Baryon loading, 326
Baryons, 34
Boltzmann equation, 186
density parameter, 35
Baryon-to-photon ratio, 58, 91
Bias, 273, 377
Big-Bang, 13
Big Bang Nucleosynthesis (BBN)
temperature, 90
Bispectrum, 221
reduced, 222
Bolometric magnitude, 366
Boltzmann equation
collisional term, 84
collisionless, 82
coupled to FLRW metric, 82
force term, 160
scalar perturbations, 162
tensor perturbations, 162
vector perturbations, 163
moments, 83
non-relativistic case, 78
perturbation, 158
relativistic case, 81
Bose–Einstein distribution, 65, 382
Bouncing cosmology, 235
Bulk viscosity, 126
Bullet cluster, 5
C
Chemical equilibrium, 56, 90
Christoffel symbols
perturbation, 119
CMBFAST, 334
Cold Dark Matter (CDM), 34
density parameter, 35
perturbed Boltzmann equation, 164
small-scale anomalies, 12
Comoving coordinates, 21
Comoving curvature perturbation, 138
conservation, 387
Comoving distance, 45
Comoving momentum, 64
Comoving-gauge density perturbation, 138
Conﬁdence level, 368
Conformal Hubble factor, 30
Conformal time, 22
Conformal transformation, 267
Continuity equation, 34, 83
perturbation, 165
using thermodynamics laws, 56
Copernican principle, 13, 227
© Springer International Publishing AG, part of Springer Nature 2018
O. Piattella, Lecture Notes in Cosmology, UNITEXT for Physics,
https://doi.org/10.1007/978-3-319-95570-4
413

414
Index
Core/Cusp problem, 12
Correlation function, 214, 375
Cosmic coincidence, 11
Cosmic Microwave Background (CMB)
acoustic oscillations, 313
anomalies, 13, 227
C S
T T,ℓspectrum, 226
CT
BB,ℓspectrum, 362
C S
E E,ℓspectrum, 357
CT
E E,ℓspectrum, 361
C S
T E,ℓspectrum, 357
CT
T E,ℓspectrum, 362
CT
T T,ℓspectrum, 352
doppler effect, 313
integrated Sachs-Wolfe effect, 314
large scale anisotropies, 315
observation, 7
Planck TT spectrum, 309
polarisation spectra, 227
power spectrum, 225
primary anisotropies, 313
spectral distortions, 67
temperature, 69
temperature ﬂuctuations expansion, 224
Cosmic time, 21
Cosmic variance, 216
angular power spectrum, 228
CMB power spectrum, 229
power spectrum, 221
Cosmography, 46
Cosmological constant
density parameter, 35
problem, 11
Cosmological observations, 7
Cosmological principle, 19
Coulomb scattering, 187
Critical density, 32
Cross section
thermally averaged, 89
D
Dark Energy (DE), 4
Dark Energy Survey (DES), 9
Dark Matter (DM), 4
Cold Dark Matter (CDM), 6
Hot Dark Matter (HDM), 7
Warm Dark Matter (WDM), 6
Dark matter decoupling, 58
Dark matter searches, 10
Deceleration parameter, 31
Density contrast
deﬁnition, 127
Density parameter
closure relation, 33
Density parameter , 32
de Sitter universe, 38
deceleration parameter, 39
Deuterium bottleneck, 91
Diffusion damping, 319, 329
Distance modulus, 366
Distribution function, 60
energy density, 62
energy-momentum tensor, 62
particle number density, 62
perturbation, 130, 158
pressure, 62
Dust, 34
Dust-dominated universe
scale factor solution, 42
E
Effective number of relativistic degrees of
freedom, 96, 110
Effective speed of sound, 138
Einstein-de Sitter universe, 41
Einstein equations
scalar perturbations, 145
tensor perturbations, 149
vector perturbations, 152
Einstein frame, 268
Einstein static universe, 37
Einstein tensor
perturbation, 124
Electron-positron annihilation, 59
Electroweak phase transition, 58
Energy momentum tensor
imperfect ﬂuid, 126
kinetic theory, 130
perturbations, 127
Ensemble, 213
Ensemble average, 213
Ensemble variance, 215
Entropy density, 65
Entropy modes, 196
Entropy perturbation, 138
Equation of state, 34
Equivalence wavenumber, 282
Ergodic theorem, 216, 231
Etherington’s distance duality, 51
Euclid (experiment), 9
Euler equation
perturbation, 166
Event horizon, 47

Index
415
Evolution of perturbation
-dominated epoch, 281
matter-dominated epoch, 287
Mészáros equation, 295
radiation-dominated epoch, 293
super-horizon, 278
F
Fermi–Dirac distribution, 65, 380, 381
Fine structure constant, 60
Fine tuning, 236
Finite thickness effect, 339
Flatness problem, 32, 235
FLRW metric, 21
Christoffel symbols, 25, 121
light-cone structure, 23
perturbation, 118
perturbed Christoffel symbols, 122
perturbed Einstein tensor, 125
perturbed Ricci scalar, 125
perturbed Ricci tensor, 123
Ricci tensor, 28
Fourier transform, 142
Four-velocity
perturbations, 129
Free electron fraction, 100
Free-streaming
solution, 313
Freeze out, 57
f (R) gravity, 268
Friedmann equation, 28
G
Gauge, 118
problem, 131
Gauge transformation, 132
energy-momentum tensor, 133
metric, 133
Gaussian ﬁlter, 372
Grand Uniﬁed Theory (GUT), 58
Gravitational waves
equation, 150
helicity, 150
observatories, 9
sum over helicities, 231
Green’s function, 397
Growth factor, 287
H
Heat transfer, 126
Helium mass fraction, 99
Helmholtz theorem, 384
Horizon crossing, 195
Horizon problem, 238
Hot Big Bang
thermal history, 57
Hot dark matter, 35
Hubble constant, 2, 30
Hubble parameter, 22
Hubble radius, 2, 25
Hubble’s law, 1
derivation, 45
I
IceCube, 9
Inﬂation, 236
e-folds number, 237
energy scale, 238
horizon problem, 238
inﬂaton, 240
Lyth bound, 246
maximum number of e-folds, 242
Planck constraints, 265
power-law, 266
slow-roll, 240
Starobinsky model, 267
trans-Planckian problem, 243
Interacting dark matter, 13
Interaction rate, 56
Isocurvature modes, 196
Isometry, 133
J
Jerk parameter, 46
Jordan frame, 267
K
Killing equations, 133
Kinetic equilibrium, 56
Kodama–Sasaki equation, 278
L
CDM model, 7, 35
age of the universe, 36
scale factor solution, 44
Landau damping, 339
Landau damping scale, 341
Larmor formula, 406
Last scattering surface, 100
Legendre polynomials
expansion, 168
orthogonality relation, 169

416
Index
recurrence relation, 169
Legendre polynomials expansion, 179
Leptogenesis, 58
Likelihood, 367
Linearised Einstein equations, 131
Line-of-sight, 311
unit vector, 224
Line-of-sight integration, 334
Liouville operator, 78
Liouville theorem, 78
proof, 79
Lithium problem, 13
Lookback time, 45
Lukash variable, 138
Luminosity distance, 49
M
Marginalisation, 369
Mass variance, 371
Matter-radiation equality, 77
Maximally symmetric space, 19
Maxwell–Boltzmann distribution, 380
Maxwell equations, 398
Method of characteristics, 80
Milne universe, 44
Missing satellites problem, 12
Mukhanov-Sasaki equation, 260
Multiverse, 11
N
Neutralino, 6
Neutrino decoupling, 58
Neutrinos
density parameter, 35
effective number of families Neff, 73
energy density, 70
fraction, 200
isocurvature velocity mode, 199
mass constraints, 74
massive neutrinos density parameter, 76
perturbed Boltzmann equation, 167
relative neutrino heat ﬂux, 199
right-handed, 70
sterile, 70
temperature, 72
temperature equations hierarchy, 169
Neutron abundance, 95
Newtonian cosmology, 18
Newtonian gauge, 141
Non-Gaussianity, 221
local type, 222
Planck constraint on fN L, 222
Normal mode decomposition, 142
Number density
equilibrium, 86
O
Olbers’s paradox, 3
Open problems in cosmology, 13
Optical depth, 176
P
Partial wave expansion, 168, 179
Particle horizon, 47
Particle number conservation, 83
Particles
thermal production, 6
Particles in a thermal bath, 75
Perfect ﬂuid, 29
Periodic boundary conditions, 61
Phase-space
volume of the fundamental cell, 61
Photon density matrix, 404
Photons
decoupling from electrons, 100
density parameter, 35, 69
energy density, 67
free-streaming, 310
number density, 69
perturbed Boltzmann equation
collisional term, 173
scalar perturbations, 179
tensor perturbations, 182
vector perturbations, 184
relative temperature ﬂuctuations, 172
Poisson distribution, 384
Polarisation ellipse, 401
Polarisation vectors, 152, 404
Power spectrum, 212, 218
amplitude, 262
dimensionless, 219
scale invariant, 253
Present time t0, 31
Primordial modes, 195
adiabatic, 201
baryon density isocurvature, 206
Cold Dark Matter density isocurvature,
206
neutrino density isocurvature, 205
neutrino velocity isocurvature, 207
Planck constraints, 209
Primordial plasma, 57
Primordial tilt, 317

Index
417
Proper distance, 45
Proper momentum, 26, 64, 130
Proper radius, 22
Q
Quantum-to-classical transition, 248
R
Radiation, 35
Radiation-dominated universe
scale factor solution, 40
Radiation plus dust universe
scale factor solution, 43
Random ﬁeld, 213
Gaussian, 219
Reality condition, 217, 225
Recombination, 100
Redshift, 10, 27
photometric, 10
spectroscopic, 10
Redshift drift, 31
Reheating, 247
Reionisation, 105, 337
Relativistic Poisson equation, 146
Ricci scalar
perturbation, 124
Ricci tensor
deﬁnition, 123
perturbation, 123
Riemann ζ function, 68
Rodrigues’ formula, 392
S
Sachs-Wolfe effect, 312
Sachs-Wolfe plateau, 317
Saha equation, 90
Scalar ﬁeld
Klein–Gordon equation, 241
Scalar-Vector-Tensor decomposition, 134
Scale factor, 21, 27
See-saw mechanism, 70
Shot noise, 274, 375
σ8, 376
Silk damping, 319
Silk length, 331
Size of the visible universe, 31
Sloan Digital Sky Survey (SDSS), 8
Slow-roll
conditions, 241
parameters, 242
Snap parameter, 46
Spatial curvature density, 33
Spectral index
running, 262
scalar, 262
tensor, 255
Spherical harmonics, 224
addition theorem, 393
completeness relation, 392, 396
complex conjugation, 392
normalisation, 392
orthonormality, 392, 396
parity, 393
plane wave expansion, 170, 393
spin-weighted, 395
Spurious gauge modes, 137, 141
Standard candle, 48
Standard ruler, 50, 327
Statistical homogeneity, 214
Statistical isotropy, 214
Stefan–Boltzmann law, 69
Sterile neutrino, 6
Stewart-Walker lemma, 134
Stochastic initial conditions, 223
Stokes parameters, 402
Boltzmann equation, 177
Structure formation
bottom-up scenario, 286
top-down scenario, 286
Sudden recombination, 318, 337
Synchronicity problem, 36
Synchronous gauge, 140
T
Tensions in cosmology, 13
Tensor perturbation, 136
Tensor-to-scalar ratio, 264
Thermal distributions, 379
Thermal relic, 106
Thomson scattering
cross section, 60, 407
rate, 104
Tight-coupling, 197, 318
Too big to fail problem, 12
Top Hat ﬁlter, 371
Top quark, 58
Transfer function, 211, 223
BBKS, 299
gravitational waves, 307
matter, 298
V
Vector perturbation, 135

418
Index
Visibility function, 336
W
Warm dark matter, 12
Wigner D-matrix, 350, 394
Wigner 3 j-symbols, 349
WIMP, 6
miracle, 113
WIMPless miracle, 113
Wronskian, 397

