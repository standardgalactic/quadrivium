
Robust Control Engineering


Robust Control Engineering
Practical QFT Solutions
Mario García-Sanz

MATLAB® is a trademark of The MathWorks, Inc. and is used with permission. The MathWorks does not warrant the 
accuracy of the text or exercises in this book. This book’s use or discussion of MATLAB® software or related products 
does not constitute endorsement or sponsorship by The MathWorks of a particular pedagogical approach or particu­
lar use of the MATLAB® software.
CRC Press
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
© 2017 by Taylor & Francis Group, LLC
CRC Press is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed on acid-free paper
International Standard Book Number-13: 978-1-138-03207-1 (Hardback)
This book contains information obtained from authentic and highly regarded sources. Reasonable efforts have been 
made to publish reliable data and information, but the author and publisher cannot assume responsibility for the 
validity of all materials or the consequences of their use. The authors and publishers have attempted to trace the 
copyright holders of all material reproduced in this publication and apologize to copyright holders if permission to 
publish in this form has not been obtained. If any copyright material has not been acknowledged, please write and let 
us know so we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, transmitted, or 
utilized in any form by any electronic, mechanical, or other means, now known or hereafter invented, including pho­
tocopying, microfilming, and recording, or in any information storage or retrieval system, without written permission 
from the publishers.
For permission to photocopy or use material electronically from this work, please access www.copyright.com (http://
www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood Drive, Danvers, MA 
01923, 978-750-8400. CCC is a not-for-profit organization that provides licenses and registration for a variety of users. 
For organizations that have been granted a photocopy license by the CCC, a separate system of payment has been 
arranged.
Trademark Notice: Product or corporate names may be trademarks or registered trademarks, and are used only for 
identification and explanation without intent to infringe.
Visit the Taylor & Francis Web site at
http://www.taylorandfrancis.com
and the CRC Press Web site at
http://www.crcpress.com

“If you want to find the secrets of the universe, think in terms of energy, frequency and 
vibration”. Nikola Tesla (1856–1943).
“If you believe in the frequency domain, you believe in QFT”. Isaac Horowitz to Mario 
García-Sanz (Pamplona, Spain), 2000.
“QFT provides one of the most practical robust control design methods available... It is 
now becoming a much more accessible and valuable method, mainly because the avail­
ability of good design software... Prof. Garcia-Sanz has developed a very easy to use 
design package”. Michael Grimble, founder of the industrial control centre (Glasgow, 
UK), E-news August 2016.
“The most valuable companies in the future won’t ask what problems can be solved 
with computers alone. Instead, they’ll ask: how can computers help humans solve hard 
problems”. Peter Thiel, co-fouder of PayPal and Palantir, in his book Zero to One, 2014.
“Thanks for making this amazing toolbox!!”. “The QFT Control Tollbox proved to be 
an excellent tool for robust controller design!!”. “One of the best courses I’ve taken!!”. 
CWRU students who attended Prof. Garcia-Sanz QFT control courses.
“The investment in training will pay off in the long term. People can’t deliver on what 
they do not know how to do... you have to upgrade capabilities... A well-trained team 
is often a company’s most significant advantage—and an incompetent one its biggest 
liability”. David Hoffeld, CEO Hoffeld Group, in his book The Science of Selling, 2016.


To Marta, María, Pablo, and Sofía


ix
Contents
Preface..............................................................................................................................................xv
Acknowledgments....................................................................................................................... xix
Author............................................................................................................................................ xxi
	 1	 Introduction..............................................................................................................................1
1.1	
The Control Engineer’s Leadership.............................................................................1
1.2	
QFT Robust Control Engineering................................................................................4
1.3	
Book’s Outline................................................................................................................7
1.4	
Courses and Modules.................................................................................................. 11
	 2	 QFT Robust Control..............................................................................................................17
2.1	
Introduction..................................................................................................................17
2.2	
Plant Modeling: Step 1................................................................................................19
2.3	
The Nominal Plant: Step 2..........................................................................................28
2.4	
QFT Templates: Step 3.................................................................................................28
2.5	
Stability Specifications: Step 4....................................................................................30
2.6	
Performance Specifications: Step 5............................................................................31
2.7	
QFT Bounds: Steps 6 through 8.................................................................................34
2.8	
Controller Design, G(s)—Loop Shaping: Step 9.......................................................39
2.9	
Prefilter Design, F(s): Step 10.......................................................................................41
2.10	 Analysis and Validation: Steps 11 through 13.........................................................42
2.11	 Model Matching...........................................................................................................54
2.12	 Feedforward Control...................................................................................................59
2.13	 PID Control: Design and Tuning with QFT.............................................................63
2.14	 Practical Tips.................................................................................................................69
2.14.1	 Selection of Specifications..............................................................................69
2.14.1.1	 Stability Ws.......................................................................................69
2.14.1.2	 Sensitivity δ3(ω)................................................................................69
2.14.1.3	 Reference Tracking δ6-lo(ω), δ6-up(ω).................................................71
2.14.2	 Loop Shaping—Designing G(s).................................................................... 74
2.14.3	 Prefilter—Designing F(s)................................................................................77
2.15	 Summary.......................................................................................................................78
2.16	 Practice...........................................................................................................................78
	 3	 Unstable Systems and Control Solutions.........................................................................79
3.1	
Introduction..................................................................................................................79
3.2	
Understanding Gain and Phase Margins, and Ws Circles.....................................82
3.3	
The NSC.........................................................................................................................84
3.4	
Nyquist Stability Criterion in the Nichols Chart.....................................................86
3.5	
Examples.......................................................................................................................89
3.6	
Guidelines to Design Controllers..............................................................................91
3.6.1	
Parity Interlacing Property............................................................................91
3.6.2	
Fundamental Theorem of Feedback Control..............................................92

x
Contents
3.6.3	
Examples..........................................................................................................92
3.7	
Analysis of the First Case...........................................................................................95
3.8	
Summary.......................................................................................................................97
3.9	
Practice...........................................................................................................................98
	 4	 Time-Delay and Non-Minimum Phase Systems............................................................99
4.1	
Time-Delay Systems....................................................................................................99
4.2	
Robust Design of the Smith Predictor....................................................................... 103
4.2.1	
First Algorithm.............................................................................................. 107
4.2.2	
Second Algorithm......................................................................................... 107
4.3	
Non-Minimum Phase Systems.................................................................................... 114
4.3.1	
Analysis.......................................................................................................... 114
4.3.2	
Control Methodology................................................................................... 115
4.4	
Summary..................................................................................................................... 118
4.5	
Practice......................................................................................................................... 118
	 5	 Distributed Parameter Systems........................................................................................ 119
5.1	
Introduction................................................................................................................ 119
5.2	
Modeling Approaches for PDE................................................................................120
5.3	
Generalized DPS Control System Structure.......................................................... 121
5.4	
Extension of QFT to DPS........................................................................................... 124
5.5	
Summary.....................................................................................................................134
5.6	
Practice.........................................................................................................................134
	 6	 Gain Scheduling/Switching Control Solutions............................................................135
6.1	
Introduction................................................................................................................135
6.2	
System Stability Under Switching...........................................................................135
6.3	
Methodology............................................................................................................... 141
6.4	
Examples..................................................................................................................... 142
6.5	
Summary..................................................................................................................... 147
6.6	
Practice.........................................................................................................................150
	 7	 Nonlinear Dynamic Control............................................................................................. 151
7.1	
Introduction................................................................................................................ 151
7.2	
The Circle Stability Criterion................................................................................... 151
7.3	
Nonlinear Dynamic Control: One Nonlinearity...................................................153
7.4	
Anti-Windup Solution for PID Controllers............................................................156
7.5	
Nonlinear Dynamic Control: Several Nonlinearities........................................... 163
7.5.1	
Describing Functions...................................................................................164
7.5.2	
Isolines............................................................................................................ 169
7.6	
Summary..................................................................................................................... 182
7.7	
Practice.........................................................................................................................183
	 8	 Multi-Input Multi-Output Systems: Analysis and Control........................................185
8.1	
Introduction................................................................................................................185
8.2	
Formulation for n × n Systems................................................................................. 192
8.3	
MIMO Systems—Description and Characteristics............................................... 196
8.3.1	
Loop Coupling and Controller Structure.................................................. 196
8.3.2	
Interaction Analysis...................................................................................... 197

xi
Contents
8.3.3	
Multivariable Poles and Zeros....................................................................199
8.3.4	
Directionality................................................................................................201
8.3.5	
Gain and Phase.............................................................................................201
8.3.6	
Effect of Poles and Zeros..............................................................................202
8.3.7	
Disturbance and Noise Signals...................................................................202
8.3.8	
Uncertainty....................................................................................................202
8.3.9	
Stability...........................................................................................................203
8.4	
MIMO QFT Control—Overview.............................................................................204
8.5	
Non-Diagonal MIMO QFT—Method 1...................................................................207
8.5.1	
The Coupling Matrix....................................................................................208
8.5.2	
Tracking..........................................................................................................209
8.5.3	
Disturbance Rejection at Plant Input......................................................... 211
8.5.4	
Disturbance Rejection at Plant Output...................................................... 212
8.5.5	
The Coupling Elements................................................................................ 213
8.5.6	
The Optimal Non-Diagonal Compensator............................................... 214
8.5.6.1	
Tracking.......................................................................................... 215
8.5.6.2	
Disturbance Rejection at Plant Input.......................................... 215
8.5.6.3	
Disturbance Rejection at Plant Output...................................... 215
8.5.7	
The Coupling Effects.................................................................................... 215
8.5.7.1	
Tracking.......................................................................................... 216
8.5.7.2	
Disturbance Rejection at Plant Input.......................................... 216
8.5.7.3	
Disturbance Rejection at Plant Output...................................... 216
8.5.8	
Quality Function of the Designed Compensator..................................... 217
8.5.9	
Design Methodology.................................................................................... 218
8.5.10	 Some Practical Issues...................................................................................220
8.6	
Non-Diagonal MIMO QFT—Method 2...................................................................220
8.6.1	
Non-Diagonal MIMO QFT Reformulation................................................221
8.6.2	
Case 1: Reference Tracking and Disturbance Rejection at Plant 
Output............................................................................................................221
8.6.2.1	
Methodology..................................................................................222
8.6.3	
Case 2: Disturbance Rejection at Plant Input............................................226
8.6.4	
Stability Conditions and Final Implementation.......................................227
8.6.5	
Translating Matrix Performance Specifications.......................................228
8.6.5.1	
Case n × n.......................................................................................228
8.6.5.2	
Case 2 × 2........................................................................................234
8.7	
Comparison of Methods 1 and 2..............................................................................238
8.8	
Heat Exchanger, Example 8.1—MIMO QFT Method 1.........................................240
8.9	
Heat Exchanger, Example 8.1—MIMO QFT Method 2.........................................248
8.10	 Summary.....................................................................................................................259
8.11	 Practice.........................................................................................................................259
	 9	 Control Topologies.............................................................................................................. 261
9.1	
Introduction................................................................................................................ 261
9.2	
Cascade Control Systems.......................................................................................... 261
9.2.1	
Challenge 9.1.................................................................................................. 261
9.2.2	
Solution 9.1: Cascade Control......................................................................262
9.3	
Feedforward Control Systems..................................................................................263
9.3.1	
Challenge 9.2..................................................................................................263
9.3.2	
Solution 9.2a: For Disturbance Rejection...................................................264

xii
Contents
9.3.3	
Solution 9.2b: For Reference Tracking. Model Matching.........................266
9.3.4	
Solution 9.2c: For Disturbance Rejection and Reference Tracking........266
9.4	
Override Control Systems......................................................................................... 267
9.4.1	
Challenge 9.3.................................................................................................. 267
9.4.2	
Solution 9.3: Override Control..................................................................... 267
9.5	
Ratio Control Systems...............................................................................................269
9.5.1	
Challenge 9.4..................................................................................................269
9.5.2	
Solution 9.4: Ratio Control...........................................................................269
9.6	
Mid-Range Control Systems.....................................................................................270
9.6.1	
Challenge 9.5..................................................................................................270
9.6.2	
Solution 9.5: Mid-Range Control.................................................................271
9.7	
Load-Sharing Control Systems................................................................................272
9.7.1	
Challenge 9.6..................................................................................................272
9.7.2	
Solution 9.6: Load-Sharing Control............................................................272
9.8	
Split-Range Control Systems....................................................................................273
9.8.1	
Challenge 9.7..................................................................................................273
9.8.2	
Solution 9.7 Split-Range Control................................................................. 274
9.9	
Inferential Control Systems...................................................................................... 274
9.9.1	
Challenge 9.8.................................................................................................. 274
9.9.2	
Solution 9.8: Inferential Control..................................................................275
9.10	 Auctioneering Control Systems............................................................................... 276
9.10.1	 Challenge 9.9.................................................................................................. 276
9.10.2	 Solution 9.9: Auctioneering Control...........................................................277
9.11	 Summary.....................................................................................................................277
9.12	 Practice.........................................................................................................................278
	10	 Controller Implementation................................................................................................279
10.1	 Introduction................................................................................................................279
10.2	 Analog Implementation............................................................................................279
10.3	 Digital Implementation.............................................................................................284
10.3.1	 Sample and Hold...........................................................................................285
10.3.2	 Computer Control Algorithms...................................................................288
10.3.3	 Positional and Velocity Algorithms...........................................................292
10.3.3.1	 Positional Algorithm.....................................................................293
10.3.3.2	 Velocity Algorithm........................................................................293
10.3.4	 Switching and Bumpless Algorithms........................................................294
10.3.5	 Pulse Width Modulation..............................................................................294
10.4	 Fragility Analysis with QFT.....................................................................................296
10.5	 Summary.....................................................................................................................299
10.6	 Practice.........................................................................................................................300
Case Study 1: Satellite Control................................................................................................301
Case Study 2: Wind Turbine Control...................................................................................... 317
Case Study 3: Wastewater Treatment Plant Control............................................................343
Case Study 4: Radio-Telescope Control..................................................................................365
Case Study 5: Attitude and Position Control of Spacecraft 
Telescopes with Flexible Appendages..........................................................395

xiii
Contents
Appendix 1: Projects and Problems........................................................................................409
Appendix 2: QFT Control Toolbox—User’s Guide..............................................................451
Appendix 3: Algorithm—Nyquist Stability Criterion in Nichols Chart........................485
Appendix 4: Algorithms—Smith Predictor Robust Control.............................................493
Appendix 5: Algorithms—DPS Robust Control..................................................................499
Appendix 6: Algorithms—Gain Scheduling/Switching Control.....................................501
Appendix 7: Algorithms—Nonlinear Dynamic Control....................................................505
Appendix 8: Algorithms—MIMO Robust Control.............................................................509
Appendix 9: Conversion of Units............................................................................................ 519
References.................................................................................................................................... 521
Index..............................................................................................................................................541


xv
Preface
Control engineering is the discipline that applies mathematics, physics, and technol­
ogy to the design of smart machines that control automatically physical systems. These 
smart machines, also known as control systems, use feedback loops with sensors that 
­collect ­information of the plant being controlled, computers or circuits that based on this 
­information calculate the actions to be applied, and actuators that modify the system in 
real time according to these actions. The system to be controlled can be a mechanism, 
an ­electrical network, a thermal process, a hydraulic or aerodynamic system, a chemical 
­reactor, a spacecraft, or even a financial or biomedical system.
In the real world, the mathematical description of a system is not accurate and includes 
typically model uncertainty or even variation with time. Robust control engineering is the 
area of control engineering that takes into account this model uncertainty and designs 
reliable solutions to automatically control these physical systems.
Control engineering plays a primary role in the design of many engineering systems. 
I have worked in this field for over three decades. I started my journey in the 1980s, 
applying adaptive control solutions to industry with Professor Julian Florez at CEIT 
(Spain). During the 1990s, I had the privilege to work with Professor Peter Wellstead at 
UMIST (UK). Peter was one of the best control engineers and professors I ever met. He 
showed me the beauty of the frequency domain. Sadly, Peter passed away some months 
ago after an extraordinary and generous life dedicated to his students and to the most 
challenging control projects. Also in the 1990s, I had the honor to work with Professor 
Isaac Horowitz and Professor Constantine Houpis (AFIT, U.S. Air Force Institute of 
Technology). Isaac Horowitz was the pioneer of the robust control techniques, the father 
of the quantitative feedback theory (QFT), and one of the most influential control engineers 
in the history of control. Constantine (Dino) Houpis was the “teacher” and the driv­
ing force of QFT for many years. With these mentors and friends, I had the opportu­
nity to develop new QFT control theory for multi-input multi-output plants, distributed 
parameter systems, time-delay processes, nonlinear switching control systems, unstable 
systems, and feedforward control. In  ­addition, I have applied all these new ideas to 
many commercial control ­solutions for industry and space agencies, including satellites, 
wind turbines, water ­treatment plants, power systems, and radio telescopes with NASA-
JPL, ESA-ESTEC, US-AFIT, NRAO-GBT, GMRT, Gamesa, Acciona, MTorres, IngeTeam, 
CENER, Eaton Corporation, Enercon, Siemens, Iberdrola, REE, Sener, EEQ, and many 
others.
This book, Robust Control Engineering: Practical QFT Solutions, summarizes my experi­
ence in the field. It presents the fundamentals of the QFT robust control methodology and 
its application to a large collection of real-world cases, all in 10 chapters, 10 appendices and 
over 50 detailed examples, case studies, projects, and problems. In particular, the book 
includes:
	
1.	The fundamentals of the QFT robust control technique as well as advanced practical 
methodologies for a number of real-world control problems, including: (a) unsta­
ble systems, (b) time-delay and non-minimum phase systems, (c)  ­distributed 
­parameter systems, (d) plants with large model uncertainty, (e) high-performance 

xvi
Preface
­systems, (f) nonlinear systems, (g) multi-input multi-output plants, (h) systems 
with a different number of sensors and actuators, and (i) analog and digital 
­controller implementation solutions.
	
2.	A large collection of over 50 detailed real-world case studies, examples, and 
­problems, including satellites with flexible appendages, multi-megawatt variable-
speed wind turbines, wastewater treatment plants, large radio telescopes, active 
suspension systems, DVD controllers, central heating systems, hydraulic ­systems, 
DC  motors, pasteurization processes with heat exchangers, interconnected 
­electrical micro-grids, and distillation columns.
	
3.	The original MATLAB® code of the algorithms and calculations used in the 
­resolution of the examples presented in each chapter, including cases of stable and 
unstable systems, time-delay systems, distributed parameter systems, plants with 
large model uncertainty, switching control systems, nonlinear dynamic control­
lers, and multi-input multi-output plants.
	
4.	The use of the QFT control toolbox (QFTCT) for MATLAB. This is the toolbox we 
developed and continuously improve to easily apply the QFT control theory to 
real-world projects with industry. Over the years, the toolbox has been widely 
used by industry, space agencies, research centers, and universities to design 
control solutions and servo systems, including the European Space Agency ESA-
ESTEC, NASA-JPL, wind energy companies, large radio telescopes, power sys­
tems, and water treatment plant companies. The toolbox (1) deals with plants with 
model uncertainty, (2) is able to work with multi-objective performance specifi­
cations, (3) keeps the engineering understanding of the design in the frequency 
domain, and (4) gives solutions from simple PID regulators to more advanced con­
trol strategies when necessary. The user’s guide for the QFTCT is in Appendix 2. 
Project files for some of the problems presented in this book and a demo version 
of the toolbox can be found at http://cesc.case.edu. The student and standard ver­
sions of the QFTCT is at http://codypower.com. For additional information, see 
http://crcpress.com.
	
5.	The material presented in the book has been extensively classroom tested in 
undergraduate and graduate courses at several universities worldwide, as well 
as in special control courses for industry. Students have always evaluated these 
courses as excellent, receiving many teaching awards over the years.
Robust Control Engineering: Practical QFT Solutions is an ideal textbook for undergradu­
ate and graduate students and control engineers. It presents practical methodologies to 
design reliable control systems, bridging the gap between successfully tested theory and 
real-world control system implementation. The book is indispensable for engineers and 
researchers designing reliable control solutions for industrial, energy, environmental, 
­biomedical, chemical, electrical, mechanical, and aerospace applications. Unlike most 
books on the subject, this book presents a large collection of successful real-world cases 
and ­projects. The book can be used as a self-study reference by the engineer in practice and 
in undergraduate and graduate-level courses.
The book starts where a typical undergraduate control course ends. This means 
that  it  is assumed that the reader is familiar with differential equations, basic linear 
algebra, time-domain and frequency-domain control analysis and design, single-input 
single-­output systems, and elementary state-space theory. This corresponds to the mate­
rial in, for example, Houpis and Sheldon (2013), Linear Control System Analysis and Design 

xvii
Preface
with MATLAB, CRC Press; or Dorf and Bishop (2016), Modern Control Systems, Pearson, or 
any equivalent book.
Robust Control Engineering is both, a consolidated Science and a beautiful Art at the 
same time. Every control-engineering project combines science and art components. QFT 
bridges the gap between the control theory and the design of real-world solutions. I hope 
you enjoy this journey as much as I have enjoyed it.
Mario García-Sanz
Cleveland, Ohio
MATLAB® is a registered trademark of The MathWorks, Inc. For product information, 
please contact:
The MathWorks, Inc.
3 Apple Hill Drive
Natick, MA 01760-2098, USA
Tel: 508 647 7000
Fax: 508-647-7001
E-mail: info@mathworks.com
Web: www.mathworks.com


xix
Acknowledgments
I would like to express special thanks to my former graduate PhD and Master students in 
advancing the state of the art of the QFT control field over the last 25 years, especially to 
Dr. Xabier Ostolaza, Dr. Juan Carlos Guillén, Dr. Montserrat Gil, Dr. Arturo Esnoz, Dr. Igor 
Egaña, Dr. Marta Barreras, Dr. Juan Jose Martín, Dr. Irene Eguinoa, Dr. Alejandro Asenjo, 
Dr. Jorge Elso, Carlos Molins, Augusto Mauch, Pablo Vital, Javier Villanueva, Manu Motilva, 
Juan Antonio Osés, Javier Castillejo, Mikel Iribas, Ana Huarte, Maria Brugarolas, Xabier 
Montón, Asier Oiz, and Daniel Casajus at the Public University of Navarra (Spain), and to 
Dr. Ion Irizar, Dr. Maria Jose Mercado, Dr. Timothy Franke, Dr. Trupti Ranka, Dr. Fa Wang, 
Dr. Sameer Alsharif, Tipakorn Greigarn, Nicholas White, Nicholas Tierno, Katherine Faley, 
Gerasimos Houpis, Erica Pettit, William Lounsbury, Harry Labrie, Bowen Weng, Tony Joy, 
John O’Brian, Manuel Casado, Laura Wheeler, Julio Cesar Cavalcanti dos Santos, Inigo 
Jimenez, Inigo Ostiz, Asier Diez de Ulzurrun, Yingkang Du, Chao Lin, Shiyu Sun, and 
Dr. Amir Sajadi at Case Western Reserve University (USA).
In addition, I want to acknowledge many colleagues and friends at Case Western 
Reserve University (Ohio), the Public University of Navarra (Spain), Tecnun/CEIT (Centre 
of Studies and Technical Research of Gipuzkoa) and MTorres (Spain), UMIST (University 
of Manchester Institute of Science and Technology) and Oxford Universities (UK), NASA-
JPL (NASA’s Jet Propulsion Laboratory) (California), ESA-ESTEC (The European Space 
Agency- European Space Research and Technology Centre) (The Netherlands), the U.S. 
Air Force Institute of Technology (Ohio), and the Green Bank Observatory (West Virginia), 
and especially to Professor Constantine Houpis, Professor Isaac Horowitz, Professor Peter 
Wellstead, Professor John Edmunds, Professor Neil Munro, Professor Olaf Wolkenhauer, 
Professor Ron Daniel, Professor Joaquin Casellas, Professor Julian Florez, Professor Pedro 
Dieguez, Professor Juan Sandoval, Dr. Fred Hadaegh, Dr. Boris Lurie, Dr. Paul Brugarolas, 
Dr. Christian Philippe, Dr. Samir Bennani, Dr. Robert Ewing, Jose Angel Fernandez, Carlos 
Aguerri, Ignacio Eizaguirre, Manuel Torres, Tim Weadon, John Ford, Dr. Richard Prestage, 
Professor Per Olof Gutman, Professor Eduard Eitelberg, Professor Edward Boje, Professor 
Paluri Nataraj, Professor Suhada Jayasuriya, Professor Oded Yaniv, and Professor Michael 
Grimble for their help and cooperation over the years. Finally, I also would like to thank 
Harry Morton and Tim Weadon (National Radio Astronomy Observatory-Green Bank 
Telescope [NRAO-GBT]) for the excellent picture of the Green Bank Telescope they pro­
vided for the cover.


xxi
Author
Professor Mario García-Sanz is a pioneer in the QFT robust 
control arena. Over the last 25 years, he has developed new 
QFT control theory for multi-input multi-output plants, 
­distributed parameter systems, time-delay processes, non­
linear switching and ­feedforward control, including also 
methods to apply the Nyquist stability criterion in the 
Nichols chart, and to calculate QFT templates and bounds. 
In addition, he has designed many commercial control solu­
tions for industry and space agencies. Customers include 
NASA-JPL, ESA-ESTEC, US-AFIT, NRAO-GBT, GMRT, 
Gamesa, Acciona, MTorres, IngeTeam, CENER, Eaton 
Corporation, Enercon, Siemens, Iberdrola, REE, Sener, EEQ, 
and others. With over 20 industrial patents and 200 research 
papers, Dr. García-Sanz is one of the inventors of the TWT 
direct-drive variable-speed pitch-control multi-­megawatt 
wind turbine, the EAGLE airborne wind energy system, the 
TWT variable-speed hydro-wind turbine, the DeltaGrids optimal planning algorithms 
for electrical distribution networks, and of numerous advanced industrial controllers. In 
addition, he has been the principal investigator of over 50 funded research projects for 
industry, and worked as an international expert on wind turbine design and control in 
patent litigation at the British Court in London. As a full professor at the Public University 
of Navarra (Spain) and senior advisor for European wind energy companies, he played a 
central role in the design and field experimentation of multi-megawatt wind turbines for 
industry, including the advice of many PhD students and engineers in the field. Dr. García-
Sanz is currently a professor and founding director of the Control and Energy Systems 
Center, and the inaugural Milton and Tamar Maltz Endowed Chair in Energy Innovation 
at Case Western Reserve University (http://cesc.case.edu). He also has been NATO/RTO 
lecture series director for Advanced Controls, ­visiting professor at the Control Systems 
Centre, UMIST (UK); at Oxford University (UK); at the Jet Propulsion Laboratory NASA-
JPL (California); and at the European Space Agency ESA-ESTEC (The Netherlands), and 
has given invited seminars in over 20 countries. He founded CoDyPower LLC, a consult­
ing firm specialized in control systems, energy innovation, and optimum planning of 
electrical distribution networks (http://codypower.com). Professor García-Sanz’s three 
CRC Press books Quantitative Feedback Theory: Theory and Applications (2006), Wind Energy 
Systems: Control Engineering Design (2012), and Robust Control Engineering: Practical QFT 
Solutions (2017) are among the reference books in QFT robust control and wind turbine 
control. His QFT Control Toolbox for MATLAB is considered as the top tool for designing 
QFT robust control systems. Dr. García-Sanz is subject editor of the International Journal of 
Robust and Nonlinear Control and was awarded the IEE Heaviside Prize (UK) in 1995, the 
BBVA research award (Spain) in 2001, and the CWRU Diekhoff Teaching Award (USA) in 
2012 among other prizes.


1
1
Introduction
1.1  The Control Engineer’s Leadership
Control engineering plays a primary role in the design of technology. Control concepts are 
often the key factor to achieve transformational ideas in multidisciplinary systems, includ­
ing aerospace missions, energy plants, chemical processes, power systems, transportation, 
robotics, and environmental and industrial projects.
The increasing complexity of technology has dramatically changed the way we study 
engineering at university. In the last few decades, as systems became more and more 
­complex, engineering careers turned out to be much more specialized. The new engineers 
have a deeper knowledge of some aspects at the cost of a much narrower picture. As a 
consequence, we have experienced a more and more sequential way of working in the 
engineering departments in industry. Under a typical new project, product, or system, 
companies follow a consecutive approach to the problem, starting for instance with some 
mechanical engineering department discussions, continuing perhaps with aerodynam­
ics or fluids departments, then electrical or electronics departments and so on, to finish 
up with the control engineering department. A very independent and sequential way of 
working that merges all the components of the design at a very late stage.
This sequential approach significantly limits the possibilities of the final design. Also, it 
was not the approach in the late nineteenth century, before the specialization age. Far from 
a too narrow image, great engineers of that period like Nikola Tesla, Oliver Heaviside, 
Charles Brush, and Wilbur and Orville Wright had a more complete and multidisciplinary 
picture of the projects. This characteristic opened them to the possibility of more optimal 
designs. Giving necessary credit to specialization, we need today to recover the multidisci­
plinary and concurrent engineering approach for industry. A person that can play a central 
role in this mission is the control engineer, as he or she is trained to apply control concepts 
to understand the interactions among subsystems, and coordinate the different disciplines 
to achieve a better system dynamics, controllability, and optimal design. Figure 1.1 shows 
the details of this approach.
A new engineering system can typically involve many aspects that deeply affect each 
other with many internal feedback loops, including physics, mathematics, economics, 
­reliability, efficiency, certification, regulations, implementation, marketing, interaction 
with the environment, maintenance, etc. This is illustrated in the project’s road map shown 
in Figure 1.1. In general, any single aspect in this big picture can affect the rest of the areas, 
and eventually be the critical bottleneck of the entire project.
As an example, the selection of a specific airfoil for the blades of a wind turbine affects 
the rotor speed, control system, and mechanical loads, which could require modifying 
the electrical design of the generator and the structure of the tower and foundation, 

2
Robust Control Engineering
which in turn could change the economics, reliability, efficiency, and maintenance of the 
project. Analogously, a marketing issue or a regulation matter could require a noise-level 
reduction, which eventually could result in modifying the rotor speed or blade design of 
such a wind turbine, which again could require modifying the control system, electrical 
design of the generator, tower structure and foundation, which could change the eco­
nomics, reliability, efficiency, and maintenance of the project. Also, a transport limitation 
or an economic specification could require shorter blades of the wind turbine, which 
affect the rotor speed, which could require modifying the control system and electrical 
design of the generator, which in turn could change the mechanical loads, structure of 
the tower, foundation, economics, reliability, efficiency and maintenance of the entire 
project, etc.
This big picture definitely requires a concurrent engineering way of thinking, with the 
leadership of a multidisciplinary engineer like the control engineer, who naturally and 
simultaneously can consider all the aspects of the road map to achieve an optimal solution 
(see Figure 1.1).
In other words, control engineering is not only related to the design of the specific control 
strategies to automatically regulate systems, but also to the understanding of the interac­
tions among the subsystems, to the coordination of the different disciplines to improve the 
system dynamics, controllability, and optimal design, and eventually to provide leader­
ship to the project team.
ROAD MAP
-Grid integration
-Environmental
  effects
-Robust design
-Mean time between failure
-Robust control
-Worst case analysis
-Security
-Optimum design
-Optimum control
-Health monitoring
-Preventive methods
-Financial studies
-Economic evaluation
-Risks analysis
-Laws
-Country regulations
-Public relations
-Media
-Manufacturing 
-Installation 
Economics
Efficiency
Reliability
Engineering
Interaction
Marketing
Implementation
Certification
Maintenance
Regulations
-Standards
Mechanical
engineering
Electrical
engineering
Electronics
Aerodynamics
Physics,
modeling,
simulation
Patents
Computer science
and engineering
concurrent
Project’s leader
multidisciplinary
Materials, chemistry
Civil
engineering
…..
Control
engineering
A key job for
control engineers
To design
a new
system
FIGURE 1.1
Road map to design new engineering systems, with a concurrent engineering approach, and the primary role 
of the control engineer.

3
Introduction
Two examples of these ideas are discussed next. The first one is the world’s first 
­successful,  heavier-than-air, powered airplane (see Figure 1.2). It was invented by the 
Wright ­brothers, Wilbur (1867–1912) and Orville (1871–1948), in Dayton, Ohio. The Wrights 
had not only extraordinary mechanical engineering skills, but also a deep understand­
ing of practical control engineering concepts learnt while working in their bicycle shop 
in Dayton. For a long time before the brothers, all attempts to fly considered only stable 
airplanes and were unsuccessful. The Wright brothers, however, realized that the agil­
ity of the airplane to deal with the wind disturbances was a key aspect, and proposed a 
new ­revolutionary idea based on a control engineering understanding: an intrinsically 
­unstable airplane (to speed up the response to disturbances) with a longitudinal and lat­
eral control system (regulated by the pilot) able to stabilize the airplane.
As mentioned before, the brothers developed an integrated view of the design with a con­
trol engineering vision of the problem as a central role from the very beginning. They applied 
control concepts to understand the interactions of the subsystems, and coordinated the dif­
ferent disciplines to achieve better airplane dynamics, controllability, and optimal design.
The second example is the world’s first successful automatically operating wind turbine 
for electricity generation. It was designed and erected by Charles F. Brush in Cleveland, 
Ohio, in 1887. The wind turbine operated for 20 years, delivering 12 kW of power to Brush’s 
home on 37th Euclid Avenue in Cleveland. The wind turbine was a giant, the world’s 
­largest, with a rotor diameter of 17 m and 144 blades made of cedar wood. The electrical 
generator power output was measured at 12 kW at 500 rpm (full load) and was used to sup­
ply energy via underground conductors to 408 battery cells, 350 incandescent lights, 2 arc 
lights, and 3 electric motors in Brush’s mansion (see Figure 1.3).
Charles Brush described the wind turbine as quote “self-regulating, requiring no person 
to attend it.” The turbine had what it is probably the world’s first automatic DC voltage 
regulator: a group of automatic switching control devices arranged so that the dynamo 
was into effective action at 330 rpm, and the DC voltage at the batteries was kept between 
75 and 90 V. In addition, the wind turbine had a yaw control system composed of a large 
tail (18 × 6 m), an auxiliary vane perpendicular at one side, and a mechanism of weights 
and pulleys. Under normal wind conditions, the yaw control system was able to point the 
FIGURE 1.2
Wright brothers’ unstable airplane. December 17, 1903: the World’s first heavier-than-air, powered, and 
­controlled human flight (US Library of Congress).

4
Robust Control Engineering
turbine rotor perpendicular to the wind direction for maximum efficiency. Eventually, 
under high winds the yaw control system was also able to turn the rotor out of the wind 
direction, reducing the mechanical loads and reducing the rotor velocity.
As with the Wright brothers, Charles Brush had also an integrated view of the design 
of the wind turbine, with a control engineering vision of the problem as a central role. 
He applied control concepts to understand the interactions of the electrical, mechanical, 
and aerodynamic subsystems, and coordinated the different disciplines to achieve better 
wind turbine dynamics, controllability, and optimal design.
The next section introduces the quantitative feedback theory (QFT). It is a powerful 
­control system design tool that can be applied to understand the dynamics and interac­
tions among subsystems discussed in this section (concurrent engineering), including 
model uncertainty, performance specifications and control design to improve the system 
dynamics, controllability, and optimization.
1.2  QFT Robust Control Engineering
Automatic control systems are everywhere. Electrical power systems, airplanes, facto­
ries, wind turbines, homes, cars, trains, water treatment plants, spacecraft, and so on 
FIGURE 1.3
Charles Brush’s wind turbine, 1887. The world’s first automatically operating wind turbine for electricity gen­
eration (Kelvin Smith Library, CWRU).

5
Introduction
need control systems to work. Control engineering is the discipline that applies mathe­
matics, physics, and technology to the design of smart machines that automatically con­
trol ­physical systems. These smart machines, also known as control systems, use sensors 
to measure the variables of the physical system being controlled, computers to calculate 
the actions to be applied, and actuators to adjust the system in real time. The physical 
system to be controlled can be a mechanism, an electrical network, a thermal process, 
an aero/fluid-dynamical system, a chemical reactor, or even a financial or biomedical 
system.
In the real world, the mathematical description of the dynamics of a physical ­system 
is not accurate, as it often presents some model uncertainty or changes with time. 
This ­uncertainty is a consequence of unknown dynamics, unidentified high-frequency 
components, inaccuracies in the parameter estimation, errors in the sensors and actuators, 
system nonlinearities, plant aging, temperature changes, etc.
Model uncertainty makes the design of the controller much more difficult, as it has to 
meet the control specifications not only for a single plant with fixed parameters, but for 
each and every one of the plants within the uncertainty. The independent study of a con­
trol solution for each plant within the uncertainty, that is, the brute-force solution, is very 
time consuming or even impossible. Robust control engineering is the area of automatic con­
trol that takes into account these model uncertainties and designs reliable control solu­
tions for real-world systems.
QFT gives an answer to this paradigm. It gives a control solution at once, a solution that 
works for each plant within the uncertainty and for all control specifications. In other 
words, it is a robust control methodology: gives just one fixed controller (opposite to adaptive 
control) that is able to deal with all the plants within the model uncertainty.
QFT is also a multi-objective control engineering methodology that can deal simultane­
ously with not just one, but many performance specifications at the same time, includ­
ing stability, disturbance rejection, reference tracking, model matching, noise rejection, 
­actuator limitations, reduction of vibrations, etc.
QFT is a frequency domain methodology that deals with frequency tools that are famil­
iar for control engineers. Also, it is a very transparent technique that includes ­graphics and 
concepts that keep the engineering understanding at each and every step of the design. 
QFT quantifies the balance among the controller structure (complexity, order), cost of feed­
back (bandwidth, gains), performance specifications (control objectives), and plant uncer­
tainty (models) at each frequency of interest.
QFT has been successfully applied to a wide variety of control problems, including 
­stable and unstable plants, minimum and non-minimum phase systems, single-input 
single-­output (SISO) and multiple-input multiple-output (MIMO) processes, with linear 
and ­nonlinear characteristics, long time delay, distributed parameter systems (DPS), time-
varying plants, feedforward control topologies, and multi-loop systems. It has been also 
used in many real-world applications, like radio telescopes servo systems, wind turbine 
control, water treatment plants, spacecraft control, manufacturing, flight control, power 
systems, robotics, motion control, and chemical reactors. As an example, Figure 1.4 shows 
some industrial and commercial applications where the author has applied QFT robust 
control solutions.
Computer-aided design (CAD) tools facilitate the use of QFT. The QFT Control Toolbox (or 
QFTCT) for MATLAB® is used in the examples of this book (see Figure 1.5). The QFTCT is 
the professional, interactive, and user-friendly toolbox for MATLAB of CoDyPower LLC. 
It applies QFT to the design of automatic robust control systems. The software has been 
developed by Professor Mario García-Sanz. Over the years, the toolbox has been widely 

6
Robust Control Engineering
applied by industry, space agencies, research centers, and universities to design control 
solutions and servo systems, including the European Space Agency ESA-ESTEC, NASA-
JPL, wind energy companies, large radio telescopes, power systems, water treatment 
plants, etc.
The toolbox (1) deals with plants with model uncertainty, (2) is able to work with multi-
objective performance specifications, (3) keeps the engineering understanding of the 
design in the frequency domain, and (4) gives solutions from simple proportional integral 
derivative (PID) regulators to more advanced control strategies when necessary. The user’s 
guide for the QFTCT is in Appendix 2.
Project files for some of the problems presented in this book and a demo version of the 
toolbox can be found at http://cesc.case.edu. The student and standard versions of the 
QFTCT is at http://codypower.com. For additional information, see http://crcpress.com.
(a)
(c)
(d)
(e)
(b)
FIGURE 1.4
Some industrial and commercial projects where the author has applied QFT robust control solutions: (a) NRAO 
Green Bank Telescope, (b) NASA-ESA space-telescope formation flying missions, (c) MTOI multi-megawatt 
wind turbines, (d) Crispijana water treatment plant, and (e) MTorres manufacturing.

7
Introduction
1.3  Book’s Outline
This book includes 10 chapters, 10 appendices, and over 50 detailed examples, case studies, 
projects, and problems. It introduces the fundamentals of the quantitative robust control 
(QFT) as well as practical advanced control solutions for real-world projects, including 
unstable, time-delay, non-minimum phase, or distributed parameter systems, plants with 
large model uncertainty, with high-performance specifications, nonlinear components, 
multi-input multi-output (MIMO) characteristics, or asymmetric topologies. Robust Control 
Engineering: Practical QFT Solutions is an ideal textbook for undergraduate and graduate 
students and control ­engineers. It presents practical methodologies to design reliable con­
trol systems, bridging the gap between successfully tested theory and real-world control 
system implementation. The book is indispensable for engineers and researchers design­
ing reliable control solutions for industrial, energy, environmental, biomedical, chemical, 
electrical, mechanical, and aerospace applications. Unlike most books on the control area, 
this book presents a large collection of successful real-world cases and projects, including 
FIGURE 1.5
The QFTCT for MATLAB.175

8
Robust Control Engineering
commercial wind turbines, wastewater treatment plants, satellites with flexible append­
ages, spacecraft ­flying in formation, large radio telescopes, industrial manufacturing sys­
tems, etc.
Chapter 2 presents the fundamentals of the QFT. The basic steps of the QFT methodology 
are introduced in Sections 2.2 through 2.10 along with an illustrative direct current (DC) 
motor example. To reinforce the presentation, the chapter includes an additional example of 
an airplane flight control system that follows the methodology step by step. Finally, Sections 
2.11 through 2.14 complete the chapter with model-matching control systems, feedforward 
control strategies, PID design and tuning, and practical control design tips. The QFTCT 
for MATLAB is used in the examples. Appendix 2 presents a detailed user’s guide for the 
QFTCT.
Chapter 3 introduces the practical and comprehensive method proposed by the author 
to compute the Nyquist stability criterion directly in the Nichols chart (magnitude/
phase). The method can be applied to linear time invariant (LTI) closed-loop systems 
with ­minimum and non-minimum phase zeros, stable and unstable poles, poles at the 
origin with diverse multiplicity and systems defined by nonrational functions, such as 
plants with time delay. The chapter also shows how to apply the method with a large col­
lection of illustrative examples. In addition, it gives guidelines to design controllers that 
stabilize unstable plants when dealing with frequency domain control techniques, and 
in particular with the QFT robust control design methodology. The algorithm for this 
methodology is also included in the QFTCT, and the MATLAB code of the algorithm in 
Appendix 3.
The presence of time-delay or non-minimum phase zeros limits the performance achiev­
able by closed-loop control systems. For open-loop stable systems, the tracking problem of 
a time-delay system can be improved substantially by introducing time-delay compensa­
tion. One of the most popular and effective time-delay control strategies in use is the Smith 
predictor (SP). However, it is also well known that the SP may be very sensitive to model-
plant mismatch, resulting in a poor performance when model uncertainty is ­present. 
Chapter 4 introduces a method based on QFT to design SPs when the plant is not precisely 
known. An illustrative example shows how to effectively apply the method step by step to 
a plant with time-delay and model uncertainty. Appendix 4 includes the MATLAB code 
for the algorithms of the example. Finally, the same methodology is extended to deal with 
non-minimum phase systems.
A distributed parameter system (DPS) is a system in which the dependent variables 
are functions of both time and space. The model that describes a DPS usually involves 
partial differential equations (PDE). Examples for DPS include flexible robots, heat trans­
fer problems, large mechanical structures, spacecraft with flexible appendages, electri­
cal transmission lines, etc. Chapter 5 presents a practical methodology based on QFT 
to design control solutions for DPS. The method includes a spatial distribution of the 
location of the relevant points, allowing the designer to place the actuator, disturbances, 
sensor and control objectives in any spatial location of interest, including location uncer­
tainty. From this topology, new stability and performance specifications, transfer func­
tions, and quadratic inequalities are introduced. The simplicity and excellent practical 
results of the methodology are also illustrated with a well-known PDE example. Finally, 
Appendix 5 includes the MATLAB code for the design of the QFT robust control solution 
of the example.
Chapter 6 presents a practical QFT method to design robust controllers that work under 
a switching mechanism. The method is capable of optimizing performance and stability 
simultaneously, going beyond the classical linear limitations and giving a solution for the 

9
Introduction
well-known robustness-performance trade-off. Based on the frequency domain approach, 
the method combines a graphical stability criterion for switching linear systems and the 
robust QFT technique. The formulation is applied to four illustrative examples. Appendix 
6 includes the MATLAB code utilized in the examples.
Chapter 7 introduces a nonlinear dynamic control (NDC) methodology. It is a practi­
cal control design method based on QFT that can deal with one or several nonlineari­
ties in the system, either in the plant, and/or deliberately introduced in the controller 
to go beyond the linear limitations and achieve a high performance. The chapter starts 
with the analysis of the well-known circle stability criterion to study systems with one, 
bounded and static or even time-variant nonlinearity. Based on this criterion, Section 7.3 
introduces a practical engineering methodology to design controllers for systems with 
one nonlinearity in the plant (e.g., saturation or dead zone in the actuator), and the same 
nonlinearity deliberately introduced in the controller. The method, known as NDC—one 
nonlinearity, is applied to the design of an anti-windup strategy for a classical PID con­
troller in Section 7.4. Then, Section 7.5 expands the methodology to systems with more 
than one nonlinearity: NDC – several nonlinearities. In this case, the nonlinear blocks can 
be either in the plant (such as saturation, dead zone, relay, hysteresis, or friction), and/or 
in the controller (to go beyond the classical linear limitations). Example 7.2 applies this 
new methodology to an illustrative example of a DC motor with saturation and a PID 
with nonlinear dynamics, and Appendix 7 includes the MATLAB code utilized in the 
example.
Chapter 8 analyzes the main characteristics of multi-input multi-output (MIMO) 
plants and introduces two methodologies (methods 1 and 2) to design full-matrix QFT 
controllers for MIMO systems with model uncertainty. Sections 8.1 through 8.4 analyze 
the special properties that define MIMO systems and propose some tools to understand 
their dynamics and design appropriate control systems. Sections 8.5 and 8.8 present the 
non-diagonal MIMO QFT Method 1, including both theory and a detailed 2 × 2 heat 
exchanger example. Sections 8.6 and 8.9 present the non-diagonal MIMO QFT Method 
2, including both theory and the detailed 2 × 2 heat exchanger example. The MATLAB 
code that develops the ­examples and cases presented in this chapter are also included in 
Appendix 8.
Chapter 9 proposes control topology solutions for nine common problems that have 
a different number of sensors and actuators in the system. It includes design criteria, 
block diagram topologies, and algorithm tuning for cascade control, feedforward control, 
­override control, ratio control, mid-range control, load-sharing control, split-range control, 
inferential control, and auctioneering control.
Chapter 10 studies both the analog implementation of controllers with active resistor–
capacitor (RC) electrical circuits and the digital implementation with micro-controllers 
and algorithms. The chapter also ­studies the resiliency of the implemented controllers 
with a fragility analysis method based on QFT.
The book also contains five detailed and real-world QFT control design case studies, 
including a variety of problems from SISO plants to MIMO systems, advanced topologies, 
and even NDC solutions.
Case study CS1 designs a robust QFT attitude control system (ACS) for a satellite with 
flexible solar panels. The design considers the model uncertainty introduced by the fuel 
consumption and the imprecise knowledge of the damping coefficients. It accomplishes 
four ­simultaneous control objectives: (1) stability, (2) reference tracking and regulation of 
the satellite angle, (3) rejection of unpredictable disturbances, and (4) minimization of the 
solar panel vibrations.

10
Robust Control Engineering
Case study CS2 designs a robust QFT control system for a variable-speed pitch-controlled 
gearless wind turbine. The design considers the model nonlinearities and uncertainty 
introduced by the aerodynamics. It accomplishes five simultaneous control objectives: 
(1) stability, (2) tracking and regulation of the rotor speed by pitching the angle of the 
blades, (3) rejection of unpredictable wind disturbances, (4) minimization of the tower 
fore-aft oscillations, and (5) attenuation of the blades’ flap-wise vibrations.
Case study CS3 designs a robust 2 × 2 MIMO QFT control system for a wastewater 
­treatment plant with an activated sludge process that simultaneously reduces the con­
centration of ammonia and nitrates in the plant effluent. The design considers the model 
uncertainty and MIMO loop interaction. It accomplishes four simultaneous control 
­objectives: (1) stability, (2) reference tracking, (3) rejection of unpredictable disturbances, 
and (4) minimization of loop interaction.
Case study CS4 designs two robust QFT control solutions for the velocity and position 
loops of a radio telescope servo system. The first solution is based on the classical QFT 
methodology and the second one proposes an NDC strategy. Both designs accomplish 
five simultaneous control objectives: (1) stability, (2) tracking of the azimuth axis telescope 
position, (3) regulation of the azimuth axis telescope velocity, (4) rejection of unpredictable 
wind disturbances, and (5) reduction of dish and feed-arm vibrations.
Case study CS5 demonstrates the feasibility of the sequential non-diagonal MIMO 
robust QFT control strategies to regulate simultaneously the position and attitude of 
a 6 × 6 spacecraft telescope with large flexible appendages. The spacecraft is part of a 
multiple formation flying constellation of a European Space Agency cornerstone mis­
sion. The controller satisfactory meets all the astronomical, engineering, and control 
requirements.
The book also proposes 8 detailed QFT control design projects and 12 quick problems 
in Appendix 1, including SISO plants, unstable systems, advanced topology cases, MIMO 
processes, and time-delay systems. Project P1 offers a vehicle active suspension system, 
Project P2 a DVD-disk head control system, Project P3 an inverted pendulum, Project 
P4 two interconnected multi-generator micro-grids, with frequency and active power 
control requirements, Project P5 a 2 × 2 distillation column, Project P6 a central heating 
system with long time delays, Project P7 a feedforward and cascade control of a multi-
tank, and Project 8 an attitude control system for a satellite with fuel tanks partially 
filled. The collection of quick problems, Q1–Q12, offers the reader an ­opportunity for 
practical training.
Finally, a long reference section compiles the main references used in the book. 
This ­section is arranged according to subject, and chronologically within each subject.
The topics and references are: Books of QFT and frequency-domain methods1–7; 
Special issues about QFT8–12; International QFT symposia13–21; Tutorials about QFT22–26; 
History of QFT27–31; First QFT papers32–34; QFT templates35–53; QFT bounds54–75; QFT loop-­
shaping76–88; Existence conditions for QFT controllers89–91; MIMO QFT92–121; Time-delay 
systems122; Unstable systems123–125; Digital QFT126–129; Distributed parameter systems130–137; 
Feedforward138,121; Non-minimum phase systems139–144; Multi-loop systems145–148; Nonlinear 
systems149–159; Linear-time-variant LTV systems160–163; Stability analysis and controller 
design in the Nichols chart164–165; CAD tools for QFT controller design166–175; Real-world 
applications with QFT176–222; NATO/RTO Lecture Series about QFT223–227; Miscellaneous 
of QFT228; Books of control engineering229–263; General MIMO systems264–314; Papers of 
Fragility315–325; Papers of hybrid/switching control ­systems326–336; Miscellaneous con­
trol337–357; Miscellaneous358–367.

11
Introduction
1.4  Courses and Modules
The prerequisites needed to understand and follow the topics introduced in this book are 
just the fundamentals of automatic control. Examples of courses about fundamentals of con­
trol are in References 259, 262, and 263.
The material presented in the book can be used as a self-study reference and in under­
graduate and graduate-level courses. The topics of the book can be organized in 10 mod­
ules, M1–M10. Thinking on a classical course of three credit-hours in 15 weeks, these 
modules can be used to develop courses on robust control engineering and applied control, as 
shown in Figure 1.6.
Modules
M1. Fundamentals of QFT robust control. [4 weeks]
•	 Chapter 2. QFT robust control.
•	 Example 2.1. Sections 2.3 through 2.10. Armature-controlled DC motor.
•	 Example 2.2. Airplane flight control system.
•	 Case study CS1. Satellite with flexible appendages.
•	 Case study CS2. Wind turbine pitch control.
•	 Project P1. Appendix 1. Vehicle active suspension system.
•	 Project P2. Appendix 1. DVD-disk head control.
•	 Project P8. Appendix 1. Satellite with fuel tanks partially filled.
•	 Problem Q2. Appendix 1. Control of first-order system with uncertainty.
•	 Problem Q3. Appendix 1. Control of third-order state space system.
•	 Problem Q4. Appendix 1. Field-controlled DC motor.
•	 Problem Q5. Appendix 1. Formation flying spacecraft control. Deep space.
•	 Problem Q6. Appendix 1. Helicopter control.
•	 Problem Q7. Appendix 1. Two cart problem.
M1
M2
M4
Controller
implementation
1 W
M8
M6
M7
Control 
topologies
4 W
M3
M1
M5
M10
M8
M9
Course on “Robust control engineering”
Fundamentals
of QFT
4 W
Control of
unstable systems
2 W
Time delay
systems
2 W
Distributed
param. syst.
2 W
MIMO robust
control
4 W
Course on “Applied control engineering”
Mathematical
modeling
2 W
Fundamentals
of QFT
2 W
PID robust
control
2 W
Nonlinear
robust control
4 W
Controller
implementation
1 W
FIGURE 1.6
Example of two possible courses built with the modules of this book.

12
Robust Control Engineering
M2. Control solutions for unstable systems. [2 weeks]
•	 Chapter 3. Unstable systems and control solutions.
•	 Examples 3.1 through 3.9, Section 3.5. Analysis of stability.
•	 Examples 3.10 through 3.15, Section 3.6. Design of control solutions to stabilize plants.
•	 Example P0, Section 3.7. Design of multiple control solutions.
•	 Project P3. Appendix 1. Inverted pendulum.
M3. Control topologies with different number of sensors and actuators. [4 weeks]
•	 Chapter 9. Control topologies.
•	 Section 9.2. Cascade control.
•	 Section 9.3a. Feedforward control for disturbance rejection.
•	 Section 9.3b. Feedforward control for model matching (reference tracking).
•	 Section 9.4. Override control.
•	 Section 9.5. Ratio control.
•	 Section 9.6. Mid-range control.
•	 Section 9.7. Load-sharing control.
•	 Section 9.8. Split-range control.
•	 Section 9.9. Inferential control.
•	 Section 9.10. Auctioneering control.
•	 Example 2.2. Section 2.12. Feedforward/feedback for a flight control system.
•	 Case study CS4. Cascade control for a radio telescope servo system.
•	 Project P3. Appendix 1. Override control for inverted pendulum.
•	 Project P4. Appendix 1. Load-sharing control for interconnected micro-grids.
•	 Project P7. Appendix 1. Feedforward/cascade control of a multi-tank system.
M4. MIMO robust control. [4 weeks]
•	 Chapter 8. Multi-input multi-output control. Methods 1 and 2.
•	 Example 8.1. SISO control of a 2 × 2 heat exchanger system.
•	 Example 8.1, Section 8.8. MIMO QFT control (Method 1), 2 × 2 heat exchanger.
•	 Example 8.1, Section 8.9. MIMO QFT control (Method 2), 2 × 2 heat exchanger.
•	 Case study CS3. 2 × 2 Waste water treatment plant.
•	 Case study CS5. 6 × 6 spacecraft telescope control.
•	 Project P5. Appendix 1. 2 × 2 distillation column.
•	 Problem Q8. Appendix 1. Two flow problem.
•	 Problem Q9. Appendix 1. 2 × 2 MIMO system.
•	 Problem Q10. Appendix 1. 2 × 2 MIMO system.
•	 Problem Q11. Appendix 1. Spacecraft flying in formation. Low Earth orbit.
•	 Problem Q12. Appendix 1. 3 × 3 MIMO system.
M5. Nonlinear robust control. [4 weeks]
•	 Chapter 6. Gain scheduling/switching control solutions.

13
Introduction
•	 Examples 6.1 and 6.2, Section 6.4. Systems with gain, zero, and pole variations.
•	 Example 6.3, Section 6.4. Two-mass-spring benchmark system.
•	 Chapter 7. Nonlinear dynamic control: one or several nonlinearities.
•	 Example 7.1, Section 7.4. System with actuator saturation. PID with anti-windup.
•	 Example 7.2. DC motor with saturation. PID with nonlinear dynamics.
•	 Case study CS4. Radio telescope servo system.
M6. Time-delay systems and non-minimum phase systems. [2 weeks]
•	 Chapter 4. Time-delay and non-minimum phase systems.
•	 Example 4.1. Sections 4.2 and 4.4. First-order system with delay and SP.
•	 Examples 4.2 and 4.3. Section 4.5. Non-minimum and minimum phase systems.
•	 Project P6. Appendix 1. Central heating system with long-time delays.
M7. Distributed parameter systems. [2 weeks]
•	 Chapter 5. Distributed parameter systems. Analysis and robust control.
•	 Example 5.1, Section 5.5. Heat transmission system with distributed temperature.
M8. Analog and digital implementation of controllers. [2 weeks]
•	 Chapter 10. Controller implementation.
•	 Section 10.2. Analog implementation.
•	 Section 10.3. Digital implementation.
•	 Section 10.4. Fragility analysis with QFT.
•	 Example 10.1, Section 10.3.2. Digital Proportional Integral (PI) algorithm.
•	 Example 10.2, Section 10.3.5. Digital Pulse Width Modulation (PWM)-PI algorithm.
•	 Example 10.3, Section 10.4. Fragility analysis of a control system.
M9. Mathematical modeling of dynamic systems. [2 weeks]
•	 Example 2.1, Section 2.2. Armature-controlled DC motor.
•	 Example 5.1, Section 5.5. Heat conduction distributed temperature system.
•	 Section 10.2. Active RC circuits with operational amplifiers.
•	 Case study CS1. Satellite with flexible appendages.
•	 Case study CS2. Wind turbine.
•	 Case study CS4. Radio telescope.
•	 Project P1. Appendix 1. Vehicle active suspension system.
•	 Project P3. Appendix 1. Inverted pendulum.
•	 Project P8. Appendix 1. Satellite with fuel tanks partially filled.
M10. Design of PID controllers. [2 weeks]
•	 Section 2.13. PID control: design and tuning with QFT.
•	 Example 2.1. Sections 2.3 through 2.10. Armature-controlled DC motor.

14
Robust Control Engineering
•	 Example 7.1, Section 7.4. System with actuator saturation. PID with anti-windup.
•	 Example 7.2. DC motor with saturation. PID with nonlinear dynamics.
•	 Section 10.2. Analog implementation of PID.
•	 Section 10.3.3. Position and velocity digital PID algorithms.
•	 Example 10.1, Section 10.3.2. Digital PI algorithm.
•	 Example 10.2, Section 10.3.5. Digital PWM-PI algorithm.
•	 Example 4.1. Sections 4.2, and 4.4. First-order system with delay and SP.
•	 Example 5.1, Section 5.5. Heat conduction distributed temperature system.
•	 Example 8.1. SISO control of a 2 × 2 heat exchanger system.
•	 Example 8.1, Section 8.8. MIMO QFT control (Method 1), 2 × 2 heat exchanger.
•	 Example 8.1, Section 8.9. MIMO QFT control (Method 2), 2 × 2 heat exchanger.
•	 Case study CS2. Wind turbine pitch control.
•	 Case study CS4. Radio telescope servo system.
Case studies
•	 Satellite with flexible solar panels (Case study CS1).
•	 Wind turbine pitch control (Case study CS2).
•	 Waste water treatment plant (Case study CS3).
•	 Radio telescope servo system (Case study CS4).
•	 Spacecraft telescope MIMO control (Case study CS5).
Projects. Appendix 1
•	 Vehicle active suspension system (Project P1).
•	 DVD-disk head control (Project P2).
•	 Inverted pendulum (Project P3).
•	 Interconnected micro-grids, frequency, and active power control (Project P4).
•	 2 × 2 distillation column (Project P5).
•	 Central heating system with long-time delays (Project P6).
•	 Multi-tank hydraulic system (Project P7).
•	 Satellite with fuel tanks partially filled (Project P8).
Quick Problems. Appendix 1
•	 Definition of uncertainty (Problem Q1).
•	 Control of first-order system with uncertainty (Problem Q2).
•	 Control of third-order state space system with uncertainty (Problem Q3).
•	 Field-controlled DC motor (Problem Q4).
•	 Formation flying spacecraft control. Deep space (Problem Q5).
•	 Helicopter control (Problem Q6).
•	 Two cart problem (Problem Q7).
•	 Two flow problem (Problem Q8).
•	 2 × 2 MIMO system (Problem Q9).

15
Introduction
•	 2 × 2 MIMO system (Problem Q10).
•	 Spacecraft flying in formation in low Earth orbit (Problem Q11).
•	 3 × 3 MIMO system (Problem Q12).
MATLAB code included in the book
•	 Armature-controlled DC motor (Example 2.1).
•	 Feedforward/feedback airplane flight control (Example 2.2).
•	 Unstable systems, mp and nmp (Examples 3.1 through 3.15).
•	 First-order system with time delay (Example 4.1).
•	 Heat conduction distributed temperature system (Example 5.1).
•	 Switching system varying poles and zeros (Example 6.1).
•	 Switching system, common quadratic Lyapunov function (Example 6.2).
•	 System with actuator saturation. PID with anti-windup (Example 7.1).
•	 DC motor with saturation. PID with nonlinear dynamics (Example 7.2).
•	 Heat exchanger MIMO system (Example 8.1).
•	 Appendices A3 through A8.


17
2
QFT Robust Control
2.1  Introduction
Designing reliable and high-performance control systems is an essential priority of control 
engineering projects. In practical circumstances, the presence of model uncertainty chal­
lenges the design. One robust control approach for these cases is the quantitative feedback 
theory (QFT). Deeply rooted in the classical frequency domain, QFT provides control solu­
tions that guarantee the achievement of a multi-objective set of performance specifications 
for every plant within the model uncertainty. It balances the trade-off between the sim­
plicity of the controller structure and the minimization of its activity at each frequency of 
interest.
QFT is a robust control engineering design methodology that uses the feedback to simul­
taneously and quantitatively (1) reduce the effects of plant uncertainty and (2) satisfy per­
formance control specifications. The method searches for a controller that guarantees the 
satisfaction of the required performance specifications for every plant within the model 
uncertainty (robust control).
Hendrik Bode introduced many of the frequency-domain fundamentals in his seminal 
book Network Analysis and Feedback Amplifier Design, published in 1945.1 The book strongly 
influenced the understanding of automatic control theory for many years, especially where 
system sensitivity and feedback constraints are concerned.
Almost 20 years later, in 1963, a new influential book entitled Synthesis of Feedback 
Systems,2 written by Isaac Horowitz, proposed a formal combination of the frequency-
domain methodology with plant model uncertainty (robust control) under a quantitative 
analysis. The new book addressed an extensive set of sensitivity problems in feedback 
control. It was the first work in which a control problem was treated quantitatively in a 
systematic way. The book laid the foundation for a new control design methodology that 
had been introduced briefly, also by Horowitz, in a previous paper (1959),32 the one that 
became known as QFT in the early 70s.
QFT has been successfully applied to a wide variety of control problems, including 
stable and unstable plants, minimum and non-minimum phase systems, single-input 
­single-output (SISO) and multiple-input multiple-output processes (MIMO), with lin­
ear and nonlinear characteristics, long-time delay, distributed parameter systems, time-­
varying plants; and has been combined with feedforward control topologies, multi-loop 
systems, etc. Also it has been used in many real-world applications, such as flight con­
trol, wind energy, water treatment plants, spacecraft, power systems, mechanical systems, 
motion control, and chemical reactors—see References 176–222.
Computer-aided design (CAD) tools facilitate the use of QFT. The QFT Control Toolbox 
(or QFTCT) for MATLAB is used in the examples through this book. It is the interactive 

18
Robust Control Engineering
object-oriented CAD tool developed by the author to design QFT control solutions. It has 
been applied to many real-world projects, including the European Space Agency ESA-ESTEC, 
NASA-JPL, wind energy companies, large radio telescopes, power systems, water treatment 
plants, etc. Appendix 2 presents a detailed user’s guide for the QFTCT. A demo version of 
the toolbox can be found at http://cesc.case.edu. The student and standard versions of the 
QFTCT is at http://codypower.com. For additional information, see http://crcpress.com
QFT is also a multi-criteria and transparent control engineering methodology. It quan­
tifies the balance among the controller structure, cost of feedback, performance specifica­
tions, and model plant uncertainty at each frequency of interest. The basic steps of the 
QFT methodology are summarized in Figure 2.1 and presented in Sections 2.2 through 
2.10 along with an illustrative example of a DC motor (Example 2.1). Afterward, an addi­
tional case of an airplane flight control system (Example 2.2) shows more details of the 
methodology. Then, Sections 2.11 through 2.13 complete the chapter applying QFT to 
model-matching control systems, feedforward control strategies, and PID design and 
tuning. Finally, Section 2.14 discusses some practical QFT control design tips. For a bet­
ter understanding, we recommend the study of each section and the proposed examples 
W1.
Step 1. Define plant models and uncertainty
Step 2. Select nominal plant P0(s)
Step 3. Calculate QFT templates at given ωi
Step 4. Define stability speciﬁcations
Step 5. Define performance speciﬁcations
Step 6. Calculate stability QFT bounds
Step 7. Calculate performance QFT bounds
Step 8. Intersection of bounds and compatibility
Step 9. Synthetize feedback controller G(s)
Step 10. Synthetize prefilter F(s)
Step 11. Analysis in the frequency domain
Step 12. Analysis in the time domain (linear)
Step 13. Analysis in the time domain (nonlinear)
W2.
W3.
W4.
W7.
W6.
W5.
FIGURE 2.1
QFT-controller design methodology (Windows QFTCT: W1–W7).

19
QFT Robust Control
along with the QFTCT—see also Appendix 2. The steps of the QFT methodology are 
included as windows of the toolbox, as shown in Figure 2.1, W1–W7.
2.2  Plant Modeling: Step 1
See also Plant definition window of the QFTCT and W1 in Figure 2.1.
The design of a reliable control system needs a good model of the plant dynamics. The 
description of the physics of the plant is key to understand the possibilities and limitations 
of the control system, and to design an appropriate controller to meet the specifications. 
We can never emphasize too much the importance of modeling. The reliability and per­
formance of a control system depends primarily on the understanding of the plant model.
A model that captures the dynamics of the plant is usually composed by input/output 
transfer functions in the Laplace domain P(s)—see Equation 2.1, or by state-space matrices 
in the time domain (A, B, C, and D)—see Equation 2.2.
	
P s
y s
u s
b s
b
s
b s
b
s
a
s
a s
a
n
m
m
m
m
n
n
n
( )
( )
( )
,
=
=
+
+
+
+
+
+
+
+
−
−
−
−
1
1
1
0
1
1
1
0


≥m
	
(2.1)
	
x
Ax
Bu
y
Cx
Du
( )
( )
( )
( )
( )
( )
t
t
t
t
t
t
=
+
=
+
	
(2.2)
where u(s) and y(s) are the input and output of the plant respectively, x is the array with 
state variables, and P(s) = C(sI − A)−1B + D.
In general, all real-world systems present some degree of model uncertainty. This means 
that Equations 2.1 and 2.2 are not fixed or exact expressions, but equations with param­
eters that belong to an interval. The uncertainty affects either the parameters (paramet­
ric)—see Equations 2.1 and 2.3, or an additional block (nonparametric)—see Equation 2.4.
	
a
a
a
b
b
b
k
n r
m
k
k
k
r
r
r
∈
∈
=
=
[
,
],
[
,
],
,
, ,
,
,
min
max
min
max
1
1
…
…
	
(2.3)
	
P s
P s
s
s
( )
( )(
( )),
( )
=
+
≤
≤
0
1
0
1
∆
∆
at each frequency 	
(2.4)
This model uncertainty is a consequence of many factors, including unknown dynam­
ics, unknown high-frequency components, inaccuracies measuring the parameters, sensor 
and actuator errors, system nonlinearities, plant aging, temperature changes, etc.
Model uncertainty makes the controller design much more difficult. With uncertainty, 
the controller has to meet the specifications not only for a single plant with fixed param­
eters, but also for each and every one of the plants within the uncertainty. The design of 
a controller for each plant within the uncertainty, that is, the brute-force solution, is not 
reasonable. It is very time consuming, or almost impossible, to analyze every plant within 
the uncertainty.
In this context, QFT is a powerful technique for these cases with uncertainty. It gives a 
control solution at once, a solution that works for each plant within the uncertainty and 
for all specifications. In other words, it is a robust control methodology: gives just one fixed 
controller (opposite to adaptive control) that is able to deal with all the plants within the 
model uncertainty.

20
Robust Control Engineering
The plant model can be obtained using analytical and experimental techniques. See the 
References 236, 360, 361, and 362 for additional information. The next example illustrates 
how to model an electromechanical system, including two cases of the parametric uncer­
tainty, either with independent or interrelated parameters.
EXAMPLE 2.1:  ARMATURE-CONTROLLED DC MOTOR
Direct current (DC) electrical motors with constant field are a very popular compo­
nent of modern servomechanisms. They are also known as armature-controlled DC 
motors and can directly control the torque that causes the armature to rotate. The model 
derived in this example is also valid for other type of motors that, using some additional 
power electronics, can control the torque similarly.
A DC motor consists of a rotating part or armature that contains wire conductors 
wrapped around an iron core. These conductors have an inductance La and a resistance 
Ra—see Figure 2.2. A commutator composed of a split ring with metal contact segments 
in the mobile part and brushes in the fixed part connects the wires of the rotating arma­
ture to the fixed part of the motor. The armature is inside a constant magnetic field Bm 
produced by magnets or electromagnets in the stator. When an external voltage v(s) is 
applied to the conductors of the armature, a current ia(s) is produced. The constant mag­
netic field Bm reacts with the armature current ia(s) creating a torque Tm(s) that causes the 
armature to rotate.
The voltage v(s) can be used to control the torque Tm(s) and then the rotational velocity 
ωm(s) of the motor. In this case, the DC motor is said to be armature-controlled.
The model that describes the dynamics of the armature-controlled DC motor has 
the diagram shown in Figure 2.2 and the electromechanical expressions presented in 
Equations 2.5 through 2.8. The torque Tm(s) produced by the motor is proportional to the 
armature current ia(s), and the voltage ve(s) produced in the conductors of the armature 
and opposed to the current is proportional to the rotational velocity ωm(s), so that
	
T t
K i t
m
T
a
( )
( )
=
	
(2.5)
	
v t
K
t
e
e
m
( )
( )
=
ω
	
(2.6)
where KT is the torque constant of the motor and Ke the voltage constant. Notice that 
KT = Ke. Now, applying Kirchhoff’s voltage law to the armature circuit—see Figure 2.2, 
we have
	
v t
R i t
L d
dt i t
v t
a a
a
a
e
( )
( )
( )
( )
=
+
+
	
(2.7)
ve(s)
v(s)
+
+
Td(s)
ia(s)
b
J
–
–
La
Ra
Tm(s)
ωm(s)
Constant
field
FIGURE 2.2
Armature-controlled DC motor.

21
QFT Robust Control
And applying Newton’s second law to the mechanical part of the motor,
	
J d
dt
t
T t
b
t
T t
m
m
m
d
ω
ω
( )
( )
( )
( )
=
−
−
	
(2.8)
where J is the inertia of all the rotating parts of the motor, b the damping coefficient 
for the losses that are proportional to the motor velocity ωm(t), and Td(t) are the external 
torques or loads applied to the motor. Combining Equations 2.5 through 2.8, we have
	
v t
R i t
L d
dt i t
K
t
a a
a
a
e
m
( )
( )
( )
( )
=
+
+
ω
	
(2.9)
	
J d
dt
t
K i t
b
t
T t
m
T a
m
d
ω
ω
( )
( )
( )
( )
=
−
−
	
(2.10)
Now, rearranging both equations to have the first-order derivatives on the left-hand 
side, we get
	
d
dt i t
L
v t
R i t
K
t
a
a
a a
e
m
( )
[ ( )
( )
( )]
=
−
−
1
ω
	
(2.11)
	
d
dt
t
J K i t
b
t
T t
m
T a
m
d
ω
ω
( )
[
( )
( )
( )]
=
−
−
1
	
(2.12)
and choosing the state variables as x1 = ia and x2 = ωm, the state-space model for the DC 
motor is
	



x =





=
−
−
−









x
x
R
L
K
L
K
J
b
J
x
x
a
a
e
a
T
1
2
1
2


+
−











=
+
=




1
0
0
1
1
0
0
1
L
J
v
T
a
d
Ax
Bu
y







=
x
x
1
2
Cx
	
(2.13)
Applying P(s) = C(sI − A)−1B, the Laplace “s” transfer functions are
	
i s
s
p
s
p
s
p
s
p
s
v s
T
a
m
d
( )
( )
( )
( )
( )
( )
( )
(
ω





=






11
12
21
22
s)






	
(2.14)
with
	
p
s
Js
b
Js
b L s
R
K K
a
a
T
e
11( )
(
)
(
)(
)
=
+
+
+
+
	
(2.15)
	
p
s
K
Js
b L s
R
K K
e
a
a
T
e
12( )
(
)(
)
=
+
+
+
	
(2.16)

22
Robust Control Engineering
	
p
s
K
Js
b L s
R
K K
T
a
a
T
e
21( )
(
)(
)
=
+
+
+
	
(2.17)
	
p
s
L s
R
Js
b L s
R
K K
a
a
a
a
T
e
22( )
(
)
(
)(
)
=
−
+
+
+
+
	
(2.18)
Also, the motor angular position θm(s) is easily calculated by taking the integral of the 
rotational velocity—see Equation 2.19.
	
θm
d
s
s p
s v s
p
s T s
( )
[
( ) ( )
( )
( )]
=
+
1
21
22
	
(2.19)
Figure 2.3 and Equations 2.15 through 2.18 show the complete 2 × 2 model for the 
armature-controlled DC motor. A classical control system for this motor is shown in 
Figure 2.4. It is composed of two cascade control loops. The inner loop controls the 
velocity ωm(s), and the outer loop the angular position θm(s). The control signal is the volt­
age v(s) applied to the armature. The external disturbances or loads are characterized by 
the input Td(s). Also, the model gives a second additional output: the armature current 
ia(s). rθ(s) is the tracking reference for the angular position θm(s). nω(s) and nθ(s) are the 
sensor noise for the inner and outer loops, respectively, and Hω(s) and Hθ(s) the feedback 
dynamics, if any. The control system is composed of the feedback controllers Gω(s) and 
+
v(s)
p11(s)
1
s
p12(s)
p21(s)
p22(s)
+
+
+
Td(s)
ia(s)
ωm(s)
θm(s)
FIGURE 2.3
Armature-controlled DC motor model.
Position
control
Velocity
control
+
v(s)
p11(s)
p12(s)
p21(s)
p22(s)
+
+
+
+
+
+
+
+
+
–
–
Td(s)
ia(s)
ωm(s)
Hω(s)
nω(s)
Gω(s)
Gθ(s)
Hθ(s)
rθ(s)
nθ(s)
Fθ(s)
θm(s)
1
s
FIGURE 2.4
DC motor. Position and velocity control systems.

23
QFT Robust Control
Gθ(s) and the prefilter Fθ (s). If we only need to control the motor velocity, then the control 
system is simpler, as shown in Figure 2.5. In this case, rω(s) is the tracking reference for 
the velocity, the Gω(s) feedback controller, and Fω(s) the prefilter.
Parametric Uncertainty
A correct definition of the model uncertainty is always important. Every real system 
has some degree of uncertainty. The reliability of the final controller depends on the 
appropriate description of the uncertainty. If the uncertainty covers all the possibilities 
of the plant, a controller that meets all the QFT bounds (see next sections) will assure a 
good performance for every possible plant within the uncertainty. However, an over­
sized uncertainty would make it more difficult or even impossible to find an appropri­
ate controller for the problem. In fact, there is a trade-off between the size of the uncertainty 
and the achievable performance of the controller. This stresses the importance of the precise 
definition of the uncertainty, covering all the possibilities of the real plant—for robust­
ness, but not more—for performance.
To illustrate these ideas, we present below two cases of parametric uncertainty for 
the DC motor. The first one (Case a) proposes a situation where there are five physical 
parameters with independent uncertainty. The second one (Case b) proposes a problem 
where four of the previous physical parameters are interrelated with each other, as a 
function of the temperature Temp. As we will see in Section 2.4, although the minimum 
and maximum values of each parameter of Case a are the same as in Case b, the uncer­
tainty in the first case is much larger than in the second one.
Case A
The inertia J, the damping coefficient b, the inductance La, the resistance Ra, and the torque 
coefficient KT are independent. The transfer function of the plant to be controlled is
	
p
s
s
v s
K
J L s
J R
bL s
bR
K K
m
T
a
a
a
a
T
e
21
2
( )
( )
( )
(
)
(
)
=
=
+
+
+
+
ω
	
(2.20)
with five parameters with independent uncertainty—see also Table 2.1,
	
J
J
J
b
b
b
L
L
L
R
R
R
a
a
a
a
a
a
∈
∈
∈
∈
[
,
],
[
,
]
[
,
],
[
,
min
max
min
max
min
max
min
max
min
max
]
[
,
],
K
K
K
K
K
T
T
T
e
T
∈
=
	
(2.21)
Velocity
control
+
v(s)
p11(s)
p12(s)
p21(s)
p22(s)
+
+
+
+
+
+
–
Td(s)
ia(s)
ωm(s)
Gω(s)
Hω(s)
rω(s)
nθ(s)
Fω(s)
θm(s)
1
s
FIGURE 2.5
DC motor. Velocity control system.

24
Robust Control Engineering
In this case, and for the future calculation of the QFT templates—see Section 2.4, 
we define a discrete number of plants by gridding each parameter with uncertainty 
between the minimum and the maximum value—see Table 2.1. The column “grid” 
defines the total number of values for each parameter, including both extremes. In 
this way, the total number of plants is: 5 × 3 × 5 × 4 × 3 = 900 plants. The distribu­
tion between the minimum and the maximum, with a “grid” number of points, can be 
typically selected as either a linear or a logarithmic distribution. For instance, for the 
parameter Ra, grid = 4, the linear or logarithmic distributions are, respectively:
	
1.	 linspace(0.5,0.7,4) = [0.5000  0.5667  0.6333  0.7000].
	
2.	 logspace(log10(0.5),log10(0.7),4) = [0.5000  0.5593  0.6257  0.7000].
The calculation of the 900 plants needs five nested for-loops. It can be done using the 
QFTCT—see Figure 2.6 and Appendix 2, or just the following MATLAB code.
TABLE 2.1
Case a. Parametric Uncertainty for DC Motor Example 2.1
Minimum
Maximum
Nominal
Grid
J
N m/s2
4 × 10−5
8 × 10−5
6 × 10−5
5
b
N m/(rad/s)
6 × 10−5
9 × 10−5
6 × 10−5
3
La
H
1 × 10−3
3 × 10−3
1 × 10−3
5
Ra
Ω
0.5
0.7
0.7
4
KT
N m/A
0.04
0.06
0.04
3
Ke
V/(rad/s)
Ke = KT
FIGURE 2.6
Plant p21(s) with parametric uncertainty—Case a. QFTCT.

25
QFT Robust Control
Case B
In this second option, the damping coefficient b, the inductance La, the resistance Ra, and 
the torque coefficient KT are interrelated as functions of the temperature Temp, so that
	
b
T
L
T
R
T
K
T
K
K
emp
a
emp
a
emp
T
emp
e
T
=
+
=
+
=
+
=
+
=
α
α
α
α
α
α
α
α
2
1
4
3
6
5
8
7
	
(2.22)
and being α1 to α8 known and fixed coefficients:
	
α
α
α
α
α
1
4
2
7
3
4
5
5
1 6767
10
3 3333
10
0 0082
2 2222
10
=
×
= −
×
=
= −
×
−
−
−
.
;
.
;
.
;
.
= −
=
=
= −
×
−
0 0178
0 0022
0 1118
2 2222
10
6
7
8
4
.
;
.
;
.
;
.
α
α
α
	
Then the transfer function p21(s) becomes
	
p
s
s
v s
s
s
m
21
3
2
2
1
0
( )
( )
( )
=
=
+
+
ω
β
β
β
β
	
(2.23)
% -- Parameters: minimum "m", maximum "M", and grid
Jm = 4e-5; JM = 8e-5; i1m = 5;
bm = 6e-5; bM = 9e-5; i2m = 3;
Lam = 1e-3; LaM = 3e-3; i3m = 5;
Ram = 0.5; RaM = 0.7; i4m = 4;
KTm = 0.04; KTM = 0.06; i5m = 3;
% -- Gridding
Jv = logspace(log10(Jm),log10(JM),i1m);
bv = logspace(log10(bm),log10(bM),i2m);
Lav = logspace(log10(Lam),log10(LaM),i3m);
Rav = logspace(log10(Ram),log10(RaM),i4m);
KTv = logspace(log10(KTm),log10(KTM),i5m);
% -- Plants
c = 0;
for i1=1:i1m
  J = Jv(i1);
  for i2=1:i2m
    b = bv(i2);
    for i3=1:i3m
      La = Lav(i3);
      for i4=1:i4m
        Ra = Rav(i4);
        for i5=1:i5m
          KT = KTv(i5);
          c = c + 1;
          P(1,1,c) = tf(KT,[J*La (J*Ra+b*La) (b*Ra+KT*KT)]);
        end
      end
    end
  end
end

26
Robust Control Engineering
with
	
β
α
α
β
α
α
β
α
α
α
α
α
3
8
7
2
4
3
1
6
5
2
1
=
+
=
+
=
+
+
+
(
)
(
)
(
)
(
)(
T
J
T
J
T
T
emp
emp
emp
emp
44
3
0
2
1
6
5
8
7
2
T
T
T
T
emp
emp
emp
emp
+
=
+
+
+
+
α
β
α
α
α
α
α
α
)
(
)(
)
(
) 	
(2.24)
and with only two parameters with uncertainty, the inertia J and the temperature Temp—
see also Table 2.2,
	
J
J
J
T
T
T
emp
emp
emp
∈
∈
[
,
],
[
,
]
min
max
min
max 	
(2.25)
In this case, the calculation of the plants needs only two nested for-loops. It can be 
easily done by using the QFTCT—see Figure 2.7 and Appendix 2, or the following 
MATLAB code.
TABLE 2.2
Case b. Parametric Uncertainty for DC Motor. Example 2.1
Minimum
Maximum
Nominal
Grid
J
N m/s2
4 × 10−5
8 × 10−5
6 × 10−5
10
Temp
Kelvin
233
323
323
20
FIGURE 2.7
Plant p21(s) with parametric uncertainty—Case b. QFTCT.

27
QFT Robust Control
Frequencies
As a frequency-domain methodology, QFT works with an array of frequencies of inter­
est—second gridding. The array of frequencies can be selected by inspection of the 
Bode diagram of a number of plants within the uncertainty.
Figure 2.8 shows the Bode diagram of the plant p21(s) and the uncertainty according 
to Case a. In this case, we select an array of frequencies starting at 1 rad/s, ending at 
% -- Parameters: minimum "m", maximum "M", and grid
Jm = 4e-5; JM = 8e-5; i1m = 10;
Tempm = 233; TempM = 323; i2m = 20;
a1 = 1.6767e-4; a2 = -3.3333e-7; a3 = 0.0082; a4 = -2.2222e-5;
a5 = -0.0178; a6 = 0.0022; a7 = 0.1118; a8 = -2.2222e-4;
% -- Gridding
Jv = logspace(log10(Jm),log10(JM),i1m);
Tempv = logspace(log10(Tempm),log10(TempM),i2m);
% -- Plants
c = 0;
for i1=1:i1m
  J = Jv(i1);
  for i2=1:i2m
    Temp = Tempv(i2);
    b3 = (a8*Temp+a7);
    b2 = J*(a4*Temp+a3);
    b1 = J*(a6*Temp+a5)+(a2*Temp+a1)*(a4*Temp+a3);
    b0 = (a2*Temp+a1)*(a6*Temp+a5)+(a8*Temp+a7)^2;
    c = c + 1;
    P(1,1,c) = tf(b3,[b2 b1 b0]);
  end
end
Magnitude (dB)
–40
–20
0
20
100
101
102
103
104
Phase (deg)
–180
–135
–90
–45
0
Bode diagram
Frequency (rad/s)
p21-0(s)
p21-0(s)
FIGURE 2.8
Bode diagram. Example 2.1, DC motor. Plant p21(s) with uncertainty as Case a. See also the nominal plant p210(s).

28
Robust Control Engineering
10,000 rad/s, and adding some more frequencies to properly represent the slopes. The 
selected array, also included in Figure 2.6—QFTCT, is:
	
ω = 

1 5 1 5 1
2
3
5
7
1
2
5
1
rad/s
0 0 00 00 00 00 00 000 000 000 0 000
,
	
(2.26)
2.3  The Nominal Plant: Step 2
See also Plant definition window of the QFTCT and W1 in Figure 2.1.
The nominal plant P0(s) is a designated plant within the model uncertainty. Any plant 
can be selected as the nominal plant. The final controller designed by QFT will be the 
same, no matter what nominal plant is chosen. As we will see in the next sections, the 
nominal plant affects the QFT bounds—see Section 2.7, and the open loop transfer func­
tion L0(s) = P0(s)G(s) in the same way. As a result, as the controller G(s) gives the relative 
distance between the bounds and L0(s), the selection of the nominal plant has no effect on 
the controller G(s).
Going back to Example 2.1 (armature-controlled DC motor), the designated nominal plant 
is the one at Temp0 = 323 K and J0 = 6 × 10−5 N m/s2 (in Case b)—see Table 2.2, or the one with 
b0 = 6 × 10−5 N m/(rad/s), La0 = 1 × 10−3 H, Ra0 = 0.7 Ω, KT0 = 0.04 N m/A, Ke0 = 0.04 V/
(rad/s), and J0 = 6 × 10−5 N m/s2 (in Case a)—see Table 2.1. Notice that to facilitate further 
analysis, the selected nominal plant is the same in both cases. Then, the transfer function 
p12-0(s) is—see also Figure 2.8, dashed line,
	
ωm
T
a
a
T
e
s
v s
p
s
K
J s
b
L s
R
K
K
( )
( )
( )
(
)(
)
.
nominal
=
=
+
+
+
=
=
−
21 0
0
0
0
0
0
0
0
0 04
6
10
4 206
10
0 001642
8
2
5
×
+
×
+
−
−
s
s
.
.
	
(2.27)
2.4  QFT Templates: Step 3
See also Templates window of the QFTCT and W2 in Figure 2.1.
The QFT templates are the projection of the transfer function P(jω) onto the Nichols chart 
(NC), considering each parameter within the uncertainty, and at each frequency of interest 
ω—see Section 2.2.
Figure 2.9 shows the QFT templates for the Example 2.1, Case a. They are calculated by 
using the uncertainty defined in Equations 2.20 and 2.21 and Table 2.1, and the array of 
frequencies of interest defined in Equation 2.26. Notice that instead just one line—one 
point at each frequency, we have a set of points at each frequency (the template) due to 
the uncertainty. Also, notice that the templates are just vertical lines at low frequencies, 
become wider at middle frequencies, and finally collapse again into vertical lines at high 
frequencies. This is a common property that can be used to pick the interval of frequen­
cies of interest. The template for ω = 500 rad/s, which is in the middle of Figure 2.9, is also 
shown in Figure 2.10a with more detail.

29
QFT Robust Control
Additionally, Figure 2.10b shows the QFT template of Case b at the same frequency 
ω = 500 rad/s. As we said in Section 2.2, the uncertainty in Case a (independent parame­
ters) is much larger than in Case b (interdependent parameters). Comparing both templates, 
we see that the template in the first case (Figure 2.10a) is larger than the one in the second 
case (Figure 2.10b). In general, the second case allows the designer to achieve a higher 
Open-loop phase (deg)
–180
–160
–140
–120
–100
–80
–60
–40
–20
0
Open-loop magnitude (dB)
–50
–40
–30
–20
–10
0
10
20
30
1
5
10
50
100
200
300
500
700
1000
2000
5000
10,000
QFTCT
Templates of p21(s)
at w = [1 5 10 50 100 200 300 500
700 1000 2000 5000 10,000] rad/s
FIGURE 2.9
Nichols chart. Example 2.1, DC motor. Templates. Plant p21(s). Case a.
Open-loop phase (deg)
–190 –180 –170 –160 –150 –140 –130 –120 –110
Open-loop magnitude (dB)
–5
0
5
10
15
QFTCT
(a)
(b)
Template of p21(s) at w = 500 rad/s
p21-0(s)
Open-loop phase (deg)
–190 –180 –170 –160 –150 –140 –130 –120 –110
Open-loop magnitude (dB)
–5
0
5
10
15
QFTCT
Template of p21(s) at w = 500 rad/s
p21-0(s)
FIGURE 2.10
Nichols chart. Example 2.1, DC motor. Template of plant p21(s) and nominal plant p210(s), ω = 500 rad/s. (a) Case a 
and (b) Case b.

30
Robust Control Engineering
control performance. As we saw, there is a trade-off between the size of the uncertainty and the 
achievable performance of the controller. The nominal plant at ω = 500 rad/s, p21-0(ω = 500), is 
also represented in both cases.
2.5  Stability Specifications: Step 4
See also Specifications window of the QFTCT and W3 in Figure 2.1.
The stability margins, gain margin GM and phase margin PM, are commonly used to mea­
sure the degree of stability of a closed-loop system. Figure 2.11 shows an example of a 
stable closed-loop system, with the stability margins represented in the Bode diagram and 
in the Nichols chart.
Another way to measure the stability is with Mc circles, which represent the locus of con­
stant magnitude Ws of the closed-loop transfer function in the Nichols chart—see Figure 
2.12. That is to say: |P(s)G(s)/[1 + P(s)G(s)]| = Ws = constant. As the Mc circles enclose the 
(0 db, –180°) point, they are also related with the stability margins. Equation 2.28 defines 
the Mc circle for a constant magnitude Ws, Equation 2.29 describes the Mc circle (Ws) as a 
function of PM, and Equations 2.30 and 2.31 show PM and GM as a function of the Mc circle 
(Ws), respectively.
	
P j
G j
P j
G j
Ws
(
) (
)
(
) (
)
ω
ω
ω
ω
1+
≤
	
(2.28)
	
W
PM
s =
−
0 5
180
180
2
.
cos((
) (
) ,
π/
(
)/ ) in magnitude
	
(2.29)
	
PM
Ws
=
−











180
2 180
π
acos 0.5
in deg
,
	
(2.30)
Magnitude (dB)
–20
–10
0
10
100
101
Phase (deg)
–270
–225
–180
–135
–90
Bode diagram
Frequency (rad/s)
P(s)G(s)
GM = 4.68 dB
at 1.73 rad/s
PM = 31.8 deg
at 1.22 rad/s
–225
–180
–135
–90
–20
–15
–10
–5
0
5
10
15
20
Nichols chart
Open-loop phase (deg)
Open-loop gain (dB)
GM = 4.68 dB
at 1.73 rad/s
PM = 31.8 deg
at 1.22 rad/s
P(s)G(s)
P(s)G(s)
FIGURE 2.11
GM and PM stability specs in the Bode diagram and the Nichols chart for L1(s) = P1(s)G1(s) = 3.5/[s (s2
 + 2 s + 3)].

31
QFT Robust Control
	
GM
Ws
=
+






20
1
1
10
log
,in dB
	
(2.31)
Using the same phase margin of the example shown in Figure 2.11, PM = 31.8° for 
L1(s), the equivalent closed-loop constant magnitude is Ws = 1.825 (5.23 dB) according to 
Equation 2.29. Also, using Equation 2.31, the gain margin is GM = 3.79 dB. Figure 2.12 
shows the details.
As a result, we can say that it is possible to work either directly with the stability mar­
gins GM and PM or with the Mc circle Ws. The second option (Ws) is more reliable than the 
stability margins GM/PM option, as it prevents cases such as L2(s) = P2(s)G2(s), showed in 
Figure 2.12, which is correct from the GM and PM point of view, but still very close to be 
unstable—it is quite close to encircle the point (0 db, –180°). For this reason, QFT uses Mc 
circles to define the stability of the closed-loop system. Chapter 3 completes this discussion 
and develops a comprehensive study of stability in the frequency domain.
2.6  Performance Specifications: Step 5
See also Specifications window of the QFTCT and W3 in Figure 2.1.
The classical two-degree of freedom (2DOF) control system includes a loop compensa­
tor G(s) and a prefilter F(s) in series with the feedback loop—see Figure 2.13. Based on this 
structure, the following well-known equations for the plant output y(s), control signal u(s), 
and signal error e(s) are obtained:
	
y
PG
PGH Fr
PGH PGd
Pd
d
Md
PGH
PGH n
e
i
o
=
+
+ +
+
+
+
−+
1
1
1
1
(
)
	
(2.32)
–270
–225
–180
–135
–90
–10
–5
0
5
10
15
3 dB
Nichols chart
Open-loop phase (deg)
Open-loop gain (dB)
Grid lines closed-loop constant magnitude
GM = 3.79 dB
PM = 31.8 deg
Ws = 1.825 
(5.23 dB)
L1(s)
L2(s)
6 dB
FIGURE 2.12
Stability specification in the Nichols chart for Ws = 1.825 (5.23 dB).

32
Robust Control Engineering
	
u
G
PGH Fr
G
PGH d
HPd
Hd
HMd
GH
PGH n
e
i
o
=
+
+ +
−
−
−
−+
1
1
1
(
)
	
(2.33)
	
e
PGH Fr
H
PGH PGd
Pd
d
Md
H
PGH n
e
i
o
=
+
−+
−
−
−
−+
1
1
1
1
(
)
	
(2.34)
where P(s) denotes the plant with uncertainty, H(s) the dynamics of the sensor, filters, and 
feedback path, M(s) the dynamics of generic disturbances d(s) over the plant output, and 
r(s), n(s), de(s), di(s), do(s) represent the reference signal for tracking, the sensor noise, and the 
external disturbances at the error signal, plant input and plant output, respectively. The 
Laplace variable s is omitted in the equations for simplicity.
As developed originally by Horowitz,33 QFT uses the transfer functions between the 
inputs [r(s), n(s), de(s), di(s), do(s), d(s)] and the outputs [y(s), u(s), e(s)], see Equations 2.32 
through 2.34, to define the stability and performance specifications in terms of inequalities 
in the frequency domain. In particular, we express each specification as {|Tk(jωi)| ≤ δk(ωi), 
ωi∈Ωk, k = 1, 2, …; i = 1, 2,…}, where Tk(jωi) are the transfer functions defined in Equations 
2.32 through 2.34, and δk(ωi) the magnitude of each specification in the frequency domain. 
Making H(s) = 1 without loss of generality, the resulting inequalities are:
•	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
W
T j
y j
s
1
1
1
1
1
(
)
(
) (
)
(
) (
)
( )
where
(
)
(
ω
ω
ω
ω
ω
δ ω
ω
ω
=
+
≤
=
∈
=
,
Ω
ω
ω
ω
)
(
) (
)
F j
r j
	
(2.35)
•	 Type 2: Complementary sensitivity specification
	
T j
P j
G j
P j
G j
T j
y j
2
2
2
2
1
(
)
(
) (
)
(
) (
)
( )
where 
(
)
(
)
ω
ω
ω
ω
ω
δ ω ω
ω
ω
=
+
≤
∈
=
,
Ω
F j
r j
y j
n j
u j
d j
y j
d j
e j
d j
i
e
e
(
) (
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
=
=
=
=
	
(2.36)
+
+
n(s)
e(s)
u(s)
d(s)
G(s)
P(s)
H(s)
+
+
+
+
+
+
+
–
di(s)
do(s)
de(s)
r(s)
F(s)
y(s)
M(s)
FIGURE 2.13
Classical 2DOF control system.

33
QFT Robust Control
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
P j
G j
T j
y j
d j
e j
o
3
3
3
3
1
1
(
)
(
) (
)
( )
where
(
)
(
)
(
)
(
ω
ω
ω
δ ω ω
ω
ω
ω
=
+
≤
∈
=
=
,
Ω
ω
ω
ω
ω
ω
ω
ω
)
(
)
(
)
(
) (
)
(
)
(
)
d j
e j
F j
r j
e j
n j
o
=
=
	
(2.37)
•	 Type 4: Disturbances at plant input specification
	
T j
P j
P j
G j
T j
y j
d j
i
4
4
4
4
1
(
)
(
)
(
) (
)
( )
where
(
)
(
)
(
)
ω
ω
ω
ω
δ ω ω
ω
ω
ω
=
+
≤
∈
=
,
Ω
= e j
d j
i
(
)
(
)
ω
ω
	
(2.38)
•	 Type 5: Control effort reduction specification
	
T j
G j
P j
G j
T j
u j
d j
e
5
5
5
5
1
(
)
(
)
(
) (
)
( )
where
(
)
(
)
(
)
ω
ω
ω
ω
δ ω ω
ω
ω
ω
=
+
≤
∈
=
,
Ω
=
=
=
u j
d j
u j
n j
u j
F j
r j
o
(
)
(
)
(
)
(
)
(
)
(
) (
)
ω
ω
ω
ω
ω
ω
ω
	
(2.39)
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
ω
ω
δ
6_
6_
( )
(
)
(
)
(
)
(
)
(
) (
)
(
) (
)
lo
T j
y j
r j
F j
P j
G j
P j
G j
<
=
=
+
≤
6
1
up( )
ω
ω
,
∈Ω6
	
(2.40)
	
	 or 
	
P j
G j
P j
G j
P j
G j
P j
G j
d
e
e
d
(
) (
)
(
) (
)
(
) (
)
(
) (
)
( )
_
ω
ω
ω
ω
ω
ω
ω
ω
δ ω
δ
1
1
6
6
+
+
≤
=
up
lo
( )
( )
_
ω
δ
ω
ω
6
6
,
∈Ω
	
•	 Type k: General disturbance rejection specification
	
T j
M j
P j
G j
T j
y j
d j
k
k
k
k
(
)
(
)
(
) (
)
( )
where
(
)
(
)
(
)
ω
ω
ω
ω
δ ω ω
ω
ω
ω
=
+
≤
∈
=
=
1
,
Ω
e j
d j
u j
G j
d j
(
)
(
)
(
)
(
) (
)
ω
ω
ω
ω
ω
=
	
(2.41)

34
Robust Control Engineering
Figure 2.14 shows an example of the Bode diagram for the specification |Tk(jωi)| ≤ δk(ωi). 
Following this inequality, the magnitude of the transfer function |Tk(jω)|, including all the 
possibilities due to the uncertainty, has to be below the limit δk(ω) at every frequency of 
interest.
Some practical tips to define practical robust stability and performance specifications, 
the δk(ω) functions, are included in Section 2.14.
2.7  QFT Bounds: Steps 6 through 8
See also Bounds window of the QFTCT and W4 in Figure 2.1.
Every plant in the ωi template can be expressed in its polar form as P(jωi) = p ejθ = p∠θ. 
Likewise, the compensator polar form is G(jωi) = g ejϕ = g∠ϕ. By substituting these polar 
forms in Equations 2.35 through 2.41 and rearranging the expressions, the quadratic 
inequalities of Equations 2.42 through 2.48 are calculated.
•	 Type 1: Stability specification
	
p
g
p
g
2
1
2
2
1
1
2 cos(
)
1
0
−






+
+
+ ≥
δ
ϕ
θ
	
(2.42)
•	 Type 2: Complementary sensitivity specification
	
p
g
p
g
2
2
2
2
1
1
2
cos(
)
1
0
−






+
+
+ ≥
δ
ϕ
θ
	
(2.43)
10–2
10–1
100
101
102
Magnitude (dB)
–40
–35
–30
–25
–20
–15
–10
–5
0
5
10
Bode diagram
Frequency (rad/s)
|Tk(jω)|
δk(ω)
FIGURE 2.14
Specification |Tk(jω)| ≤ δk(ω) = |s/(s + 1)|.

35
QFT Robust Control
•	 Type 3: Sensitivity or disturbances at plant output specification
	
p g
p
g
2
2
3
2
2
1
1
0
+
+
+
−





≥
cos(
)
φ
θ
δ
	
(2.44)
•	 Type 4: Disturbances at plant input specification
	
p g
p
g
p
2
2
2
4
2
2
1
0
+
+
+
−





≥
cos(
)
φ
θ
δ
	
(2.45)
•	 Type 5: Control effort reduction specification
	
p
g
p
g
2
5
2
2
1
2
1
0
−






+
+
+ ≥
δ
φ
θ
cos(
)
	
(2.46)
•	 Type 6: Reference tracking specification
	
p p
g
p p
p
p
e
d
e
d
e
d
d
e
2
2
6
2
2
62
1
1
2
−






+
+
−
+

δ
φ
θ
δ
φ
θ
cos
cos
(
)
(
)





+
−





≥
g
p
p
e
d
2
2
62
0
δ
	
(2.47)
•	 Type k: General disturbance rejection specification
	
p g
p
g
m
k
2
2
2
2
2
1
0
+
+
+
−





≥
cos(
)
φ
θ
δ
	
(2.48)
Notice that for every frequency ωi there is a constant δk = δk(jωi), and for a fixed plant p∠θ 
in the ωi template and a fixed controller phase φ in [−360°,0°], the unknown parameter of the 
inequalities is the controller magnitude g. The format of all quadratic expressions is the same:
	
I
p
ag
bg
c
i
k
k
ω
θ δ φ
(
)
, ,
,
=
+
+ ≥
2
0 	
(2.49)
where a, b, c depend on p, θ, φ, and δk.
Now, with an appropriate algorithm—see Table 2.3 and Reference 60, the quadratic 
inequalities of Equations 2.42 through 2.48 are solved and translated into a set of curves 
on the Nichols chart for each frequency of interest and type of specification. These are the 
QFT bounds.
Notice that we have a bound Bk(ωi) at each frequency of interest ωi and for each specifica­
tion k. The bounds can be solid or dashed lines. A solid line means that the area that meets 
the specification inequality is above the line, and a dashed line means that the area that 
meets the specification inequality is below the line.
If we have more than one specification, we need to find the intersection of all the bounds 
at each frequency, or worst case scenario bound. Figures 2.17 and 2.18 discuss some 
examples.

36
Robust Control Engineering
The QFT bounds are defined from the control specifications—Equations 2.35 through 
2.41, and taking into account all the model uncertainty. As a result, once the bounds are 
plotted in the Nichols chart, we only need to deal with the nominal plant P0(s) to find a con­
troller G(s) that meets the bounds. This is one of the great syntheses of the QFT technique. 
Instead of dealing with an infinite number of plants, the controller design step only needs 
to deal with the nominal plant P0(s), as all the model uncertainty has been already included 
in the QFT bounds—see also the algorithm showed in Table 2.3.
Thus, to guarantee that all the plants within the uncertainty meet a given specification 
at a given frequency ωi, L0(ωi) must be in the correct area: above or below the bound for 
solid or dashed lines, respectively. As L0(s) = P0(s)G(s), as we design an appropriate control­
ler G(s) we move (loop shape) L0(s) to the correct area at each frequency of interest—see 
Section 2.8. In fact, as Horowitz pointed out, an optimum controller design in the sense of 
no-overdesign is the one that places L0(ωi) on top of the bound Bk(ωi) at each frequency of 
interest ωi.
EXAMPLE 2.1 (CONT.):  ARMATURE-CONTROLLED DC MOTOR. CASE A
To illustrate these concepts, let us again consider Example 2.1 (armature-controlled DC 
motor) with the uncertainty defined in Case a. Looking at Equations 2.35 through 2.41, 
we pick the following three specifications:
•	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
Ws
1
1
1
1 46
(
)
(
) (
)
(
) (
)
( )
1 5 10 50 100 200
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
300 500 700 1000 2000 5000 10,000 rad/s
]
	
(2.50)
TABLE 2.3
Algorithm to Compute the QFT Bounds60
  1.  Discretize the frequency domain ω into a finite set Ωk = {ωi, i,…,n}k.
  2.  Establish the uncertain plant models {P(jω)} and map its boundary for each frequency ωi ∈ Ωk on the Nichols 
chart: They are the n templates {P(jωi)}, i = 1,…,n. Each one contains m points or plants: P(jωi) = {Pr(jωi) = p 
∠ θ, r = 0,…, m − 1}.
  3.  Select one plant as the nominal plant P0(jωi) = p0 ∠θ0.
  4.  The compensator is G(jωi) = g ∠φ. Define a range, Φ, for the compensator’s phase φ, and discretize it, like 
φ ∈ Φ = [−360°: 5°: 0°].
  5.  First For-loop: (for the frequencies Ωk = {ωi, i = 1,…,n}k) Choose a single frequency ωi ∈ Ωk.
  6.	
Second For-loop: (for the phases φ ∈ Φ = [−360°: 5°: 0°])  Choose a single controller’s phase φ ∈ Φ.
  7.	
Third For-loop: (for the m plants Pr (jωi), r = 0,…,m − 1) Choose a single plant: Pr (jωi) = p ∠θ.
  8.	
Compute the maximum gmax = gmax(Pr) and the minimum gmin = gmin(Pr) of the two roots g1 and g2 
that solve the k quadratic inequality.
  9.	
Choose the most restrictive of the m gmax (Pr) and the m gmin (Pr). Thus, gmax (P) and gmin (P) are 
obtained. They are the maximum and minimum bound points for the controller magnitude g at a 
phase φ.
10.  The union of gmax (P) and gmin (P) along φ ∈ Φ gives gmax ∠ϕ and gmin ∠φ, for each frequency ω, respectively.
11.  The open-loop transmission is L0 (jωi) = l0 ∠ψ0. Now set l0 max ∠ψ0 = p0 gmax ∠φ and l0 min ∠ψ0 = p0 gmin ∠φ, 
being ψ0 = φ + θ0, φ = [−360°: 5°: 0]. These are the bounds: {Bk(jωi), ωi ∈ Ωk}.

37
QFT Robust Control
which is equivalent to PM = 40.05°, GM = 4.53 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification—see Figure 2.15a
	
T j
P j
G j
s a
s a
a
d
d
d
3
3
1
1
1
1000
(
)
(
) (
)
( )
/
/
1 5 10 50
ω
ω
ω
δ ω
ω
=
+
≤
=
+
=
∈
(
)
(
)
;
[
100 200 300 500 700 1000 rad/s
]
	
(2.51)
•	 Type 6: Reference tracking specification—see Figure 2.15b
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6_
6_
( )
(
)
(
)
(
) (
)
(
) (
)
( )
1 5 1
lo
up
T j
F j
P j
G j
P j
G j
<
=
+
≤
∈
6
1
[
0 50 100 200 300 500 700 1000 2000 5000 rad/s
]
	
(2.52)
	
δ6
2
1
1
1000
_ ( )
/
lo
L
L
s
s a
a
=
+
=
[(
)
] ;
	
(2.53)
	
δ
ω
ζ
ω
ζ
6
2
1
2
1
1000
0 8
_ ( )
/
/
/
up
U
n
n
U
s
s a
s
s
a
=
+
+
+


=
=
[(
)
]
(
)
(
)
;
;
. ;
ω
ζ
n
U
a
= 1 25
.
	
(2.54)
Now, from these specifications—Equations 2.50 through 2.54, the plant model and the 
uncertainty—Equations 2.20, 2.21, and Table 2.1, and applying the algorithm introduced 
in Table 2.3, or the QFTCT, we obtain the QFT bounds for stability, sensitivity, and refer­
ence tracking—see Figure 2.16a, b, and c, respectively. Afterward, the most restrictive 
bound at every phase and each frequency of interest is computed to obtain the intersec­
tion of bounds—see Figures 2.16d and 2.17. In other words, for each set of bounds of the 
same frequency (same color), we select at each phase value (horizontal axis) the maxi­
mum vertical point of the solid-lines and the minimum vertical point of the dashed-lines.
At this point, a practical compatibility problem can arise when calculating the intersec­
tion of bounds and different-nature control specifications are simultaneously required. 
101
102
103
104
105
Magnitude (dB)
–40
–35
–30
–25
–20
–15
–10
–5
0
5
Bode diagram
Frequency (rad/s)
δ3(s)
0
0.002
0.004
0.006
0.008
0.01
0.012
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
δ6-up(s)
δ6-lo(s)
(a)
(b)
FIGURE 2.15
Control specifications for p21(s). (a) Sensitivity or disturbance rejection at the output of the plant: δ3. (b) Reference 
tracking: δ6-up, δ6-lo.

38
Robust Control Engineering
Open-loop phase (deg)
Open-loop magnitude (dB)
–15
–10
–5
0
5
10
15
20
25
QFTCT
50
100
200
300
500
700
1
5
10
1000
2000
10,000
5000
–350
–300
–250
–200
–150
–100
–50
0
Open-loop phase (deg)
Open-loop magnitude (dB)
0
10
20
30
40
50
60
70
QFTCT
1
5
10
50
100
200
300
1000
500
700
–350
–300
–250
–200
–150
–100
–50
0
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
Open-loop magnitude (dB)
–20
0
20
40
60
80
100
120
QFTCT
1
5
100
200
300
500
700
1000
2000
5000
10
50
–350 –300 –250 –200 –150 –100
–50
0
–20
Open-loop phase (deg)
Open-loop magnitude (dB)
0
20
40
60
80
100
120
QFTCT
1
5
10
50
100
200
300
500
700
2000
5000
10,000
1000
(a)
(b)
(c)
(d)
FIGURE 2.16
QFT bounds. Example 2.1, Case a. (a) Stability bounds, (b) sensitivity bounds, (c) reference tracking bounds, and 
(d) intersection of bounds.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–10
–5
0
5
10
15
20
QFTCT
Sensitivity bound
ω = 700 rad/s
Stability bound
ω = 700 rad/s
Tracking bound
ω = 700 rad/s
Open-loop phase (deg)
Open-loop magnitude (dB)
–10
–5
0
5
10
15
20
QFTCT
Intersection bound,
or worst case scenario bound
ω = 700 rad/s
–350
–300
–250
–200
–150
–100
–50
0
(a)
(b)
FIGURE 2.17
Example of QFT bounds for ω = 700 rad/s. (a) Three bounds: stability, sensitivity, and reference tracking, 
(b) intersection of bounds, or most restrictive bound.

39
QFT Robust Control
A typical case is when control effort limitations are explicitly considered along with the 
classical stability, disturbance rejection, or reference tracking specifications.
Graphically speaking, the control effort limitations generate a “0 to –360°” dashed-
line type of bound—let’s call it Bd(jωi), which requires L(jωi) to be below Bd(jωi) at each 
frequency ωi. On the contrary, the classical stability, disturbance rejection, or reference 
tracking specifications typically generate a solid-line type of bound—let us call it Bs(jωi), 
which requires L(jωi) to be above Bs(jωi) at each frequency ωi.
When Bs(jωi) < Bd(jωi) at some phase angles, the specifications are compatible, because 
there are areas in the Nichols chart where we can simultaneously meet the two condi­
tions: L(jωi) < Bd(jωi) and L(jωi) > Bs(jωi) at the frequency ωi—see striped areas in Figure 
2.18a. However, if Bs(jωi) > Bd(jωi) for all phase angles, then the specifications are not 
compatible. In this case, it is not possible to simultaneously meet the two conditions: 
L(jωi) < Bd(jωi) and L(jωi) > Bs(jωi)—see Figure 2.18b.
As we see, this graphical representation of the QFT bounds in the Nichols chart is a 
useful tool to analyze the compatibility of the control specifications before any control­
ler design is attempted. In case of finding some incompatibilities, the designer can easily 
study each specification and the model uncertainty at every frequency, to understand 
the cause of such incompatibility and relax the specifications properly. For additional 
information about this compatibility problem, see also Reference 91.
2.8  Controller Design, G(s)—Loop Shaping: Step 9
See also Controller design window of the QFTCT and W5 in Figure 2.1.
The design of a controller for an infinite number of plants, or plants with model uncer­
tainty, and for a set of simultaneous control specifications is a very arduous task at first. 
It usually requires the design and redesign of the controller for each plant and specifica­
tion in a very laborious process. However, QFT gives an elegant and practical solution for 
this problem. It integrates the information associated to the model uncertainty and all the 
control specifications in a set of simple curves: the QFT bounds. This allows us to use just 
a single plant, the nominal plant P0(s), to design the controller G(s).
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–15
–10
–5
0
5
10
15
20
QFTCT
L(s) must be
outside this area
---
Stability bound
Compatible areas
L(s) must be
above this line
for all phases
---
Sensitivity bound
Bs type
L(s) must be below this line for all phases.
Control effort limitation bound. Bd type
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–15
–10
–5
0
5
10
15
20
25
QFTCT
L(s) must be
outside this area
---
Stability bound
L(s) must be
above this line
for all phases
Sensitivity bound
Bs type
L(s) must be
below this line
for all phases
---
Control effort
limitation bound
Bd type
---
(a)
(b)
FIGURE 2.18
Compatibility of specifications (bounds) for stability, sensitivity, and control effort limitation at a given fre­
quency. Cases: (a) compatible and (b) incompatible.

40
Robust Control Engineering
The design, or loop shaping, is carried out on the Nichols chart. It is done by adding poles 
and zeros until the nominal loop, defined as L0(jω) = P0(jω)G(jω), lies near its bounds—see 
Figure 2.19.
As mentioned, the bounds express the plant model with uncertainty and the control 
specifications at each frequency. An optimal controller in the sense of QFT is obtained 
if L0(jω) lies exactly on top of the bounds at each frequency. Practically speaking a good 
controller design will place L0(jω) above the solid-line bounds and below the dashed-line 
bounds. This will give us also the minimum possible controller magnitude at every fre­
quency (minimum cost of feedback) to meet the required specifications with all the plants 
within the uncertainty.
A general formulation for the controller structure G(s) is expressed by the following 
transfer function:
	
G s
k
s z
s
s
s
G
i
ni
i
ni
r
i
nrz
i
ncz
( )
(
)
(
)
(
)
(
=
+
(
)
+
+
(
)
=
=
∏
∏
/
/
/
1
2
1
1
1
2
2
ω
ζ
ω
s p
s
s
j
nj
j
nj
j
mrp
j
mcp
/
/
/
)
(
)
(
)
+
(
)
+
+
(
)
=
=
∏
∏
1
2
1
1
1
2
2
ω
ζ
ω
	
(2.55)
where kG is the controller gain, zi is a real zero, ωni the natural frequency and ζi the damping 
of a complex zero, and nrz and ncz the number of real and complex zeros, respectively. Also, 
pj is a real pole, ωnj the natural frequency and ζj the damping of a complex pole, and mrp and 
mcp the number of real and complex poles, respectively. The controller may have also some 
poles at the origin (integrators), with r = 0, 1, or 2, etc.
Some practical tips to design the controller G(s), adding poles and zeros to shape the 
function L0(s) = P0(s)G(s) and meet the QFT bounds, are included in Section 2.14.
Open-loop phase (deg)
–300
–250
–200
–150
–100
–50
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
80
100
QFTCT
5
10
100
50
300
500
1000
700
2000
5000
10,000
1
L0(s)
200
FIGURE 2.19
QFT bounds and G(s) design—loop shaping.

41
QFT Robust Control
EXAMPLE 2.1 (CONT.):  ARMATURE-CONTROLLED DC MOTOR. CASE A
To understand these notions, let us consider again the Example 2.1 (armature-controlled 
DC motor) with the uncertainty defined in Case a. Looking at the intersection of bounds 
presented in Figure 2.16d, we design a controller (a PID with a low-pass filter) that meets 
these QFT bounds, as shown in Equation 2.56 and Figure 2.19.
The small circles in the line L0(s) and the associated numbers indicate the frequencies 
(in rad/s) for the function L0(s) = P0(s)G(s). The objective is to move each small circle 
above the corresponding solid-line bounds or below the dashed-line bounds. The pro­
posed controller G(s) meets well all the bounds. The QFTCT, Controller design window, 
can be used to easily design this controller—see also Section 2.14.
	
G s
s
s
s s
( )
/
/
/
=
+
(
)
+
+
1100
55
1
1700
1
25 000
1
(
)
((
)
)
((
,
)
)
	
(2.56)
2.9  Prefilter Design, F(s): Step 10
See also Prefilter design window of the QFTCT and W6 in Figure 2.1.
If the feedback system includes a reference tracking problem, then the best choice is to 
use a prefilter F(s)—the second degree of freedom of the control system. While the feed­
back controller G(s) reduces the effect of the uncertainty and improves stability, distur­
bance rejection, and other specifications, the prefilter F(s) is designed to meet reference 
tracking requirements. Figure 2.20 shows a typical prefilter design in the Bode diagram. 
Frequency (rad/s)
100
101
102
103
Magnitude (dB)
–35
–30
–25
–20
–15
–10
–5
0
QFTCT
PGF / (1 + PG)
δ6-up
δ6-lo
FIGURE 2.20
Prefilter F(jω) for reference tracking specs: δ6-lo(ω) ≤ |T6| ≤ δ6-up(ω).

42
Robust Control Engineering
δ6-up(ω) and δ6-lo(ω) are the reference tracking specifications, defined as a band—see outer 
lines. The transfer function T6 shows an upper and a lower edge—see the inner lines, due 
to the plant uncertainty. After an appropriate prefilter is designed, the band of T6 will be 
between the δ6-up(ω) and δ6-lo(ω) limits: δ6-lo(ω) ≤ |T6| ≤ δ6-up(ω), with,
	
T j
y j
r j
P j
G j
P j
G j
F j
6
1
(
)
(
)
(
)
(
) (
)
(
) (
) (
)
ω
ω
ω
ω
ω
ω
ω
ω
=
=
+
	
(2.57)
Some practical tips to design the prefilter F(s), adding poles and zeros to modify the 
functions P(s)G(s)F(s)/[1 + P(s)G(s)] and meet the reference tracking limits are included in 
Section 2.14.
NOTE: The calculation of the QFT bounds for reference tracking requires model uncer­
tainty, as Equation 2.47 needs two plants. For this reason, in the QFTCT the reference 
tracking specification T6 and the prefilter window are activated only for plants with uncer­
tainty. Hint: If the problem deals with a fixed plant, we can always define one parameter 
with a very small uncertainty to activate the reference tracking specification and prefilter 
design.
EXAMPLE 2.1 (CONT.):  ARMATURE-CONTROLLED DC MOTOR. CASE A
To understand these concepts, we consider again the Example 2.1 (armature-controlled 
DC motor) with the uncertainty defined in Case a.
Taking into account the controller G(s)—see Equation 2.56, the reference tracking 
specifications—see Equations 2.52 through 2.54, and the plant model—see Equations 
2.20, 2.21, and Table 2.1, we design a prefilter F(s) to make sure that all the input/output 
functions P(s)G(s)F(s)/[1 + P(s)G(s)] are inside the band defined by the limits δ6-up(ω) and 
δ6-lo(ω). The prefilter is shown in Equation 2.58, and the input/output functions and lim­
its in Figure 2.20.
	
F s
s
( )
/
=
+
1
1100
1
(
)
	
(2.58)
2.10  Analysis and Validation: Steps 11 through 13
See also Analysis window of the QFTCT and W7 in Figure 2.1.
Once the design of the controller (and prefilter if needed) is finished, it will be con­
venient to analyze the performance of the complete control system under different sce­
narios. This includes (a) frequency-domain analysis of each specification and for all the 
significant plants within the model uncertainty; and (b) time-domain simulations for 
representative cases within the uncertainty. The time-domain simulation will be per­
formed first with the linear system, and then including all the existing nonlinear ele­
ments, if any.

43
QFT Robust Control
EXAMPLE 2.1 (CONT.):  ARMATURE-CONTROLLED DC MOTOR. CASE A
Again, to understand these notions we consider the Example 2.1 (armature-controlled DC 
motor) with the uncertainty defined in Case a. For the analysis and validation, we use 
the control block diagram shown in Figure 2.5—velocity control, with the controller 
Gω(s) = G(s) in Equation 2.56, the prefilter Fω(s) = F(s) in Equation 2.58, Hω(s) = 1, and the 
plant model with uncertainty—see Equations 2.20, 2.21, and Table 2.1.
The analysis of the closed-loop stability in the frequency domain is shown in Figure 
2.21. The dashed line is the stability specification Ws, defined in Equation 2.50, and the 
solid line represents the worst case of the function PG/(1 + PG) at each frequency due to 
the model uncertainty. The control system meets the stability specification, as the solid 
line is below the dashed line Ws in all cases.
The frequency-domain analysis of the sensitivity specification, or disturbance rejec­
tion at the output of the plant specification, is shown in Figure 2.22. The dashed line is 
the sensitivity specification δ3(ω), defined in Equation 2.51, and the solid line represents 
the worst case of the function 1/(1 + PG) at each frequency due to the model uncer­
tainty. The control system meets the sensitivity specification in all cases, as the solid line 
is below the dashed line δ3 from 0 to 1000 rad/s.
The time-domain analysis of the reference tracking specification is shown in Figure 
2.23. The figure shows the limits δ6-up(ω) and δ6-lo(ω)—see Equations 2.54 and 2.53, and 
the time responses y(t) of 900 cases of PGF/(1 + PG) to a unitary step reference r(t). The 
control system meets the specification (is between the upper and lower limits) in all 
cases.
100
101
102
103
104
Frequency (rad/s)
Magnitude (dB)
0
0.5
1
1.5
2
2.5
3
3.5
1
5
10
50
100
200
300
500
700
1000
2000
5000
10,000
QFTCT
Worst cases of
“PG/(1 + PG)”
Ws
FIGURE 2.21
Stability analysis, frequency domain: Ws specification (dashed line), and worst case of PG/(1 + PG) within the 
uncertain plants (solid line) at each frequency.

44
Robust Control Engineering
Magnitude (dB)
–90
–80
–70
–60
–50
–40
–30
–20
–10
0
10
1
5
10
50
100
200
300
500
700
1000
QFTCT
Worst cases of
“1/(1 + PG)”
100
101
102
103
104
Frequency (rad/s)
δ3
FIGURE 2.22
Sensitivity analysis, frequency domain: δ3(ω) specification (dashed line), and worst case of 1/(1 + PG) within the 
uncertain plants (solid line) at each frequency.
Time (s)
×10–3
0
1
2
3
4
5
6
7
8
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δ6-up
δ6-lo
FIGURE 2.23
Reference tracking analysis, time domain: δ6-lo and δ6-up specs, and time responses y(t) of 900 cases of PGF/
(1 + PG) to a unitary step reference r(t).

45
QFT Robust Control
Finally, the time-domain analysis of the sensitivity, or disturbance rejection at the 
output of the plant, is shown in Figure 2.24. The figure shows the time responses y(t) of 
900 cases of 1/(1 + PG) to a unitary step disturbance d(t). The control system achieves a 
good disturbance rejection in all cases.
EXAMPLE 2.2:  AIRPLANE FLIGHT CONTROL
This section presents an additional example to illustrate the QFT methodology. The 
example is taken from the References 359 and 78. It consists of an automatic flight con­
trol system for an aircraft. We apply again the steps of the QFT methodology (Figure 
2.1) to exemplify different aspects of the technique. The problem is a 2DOF controller 
as shown in Figure 2.13. The QFTCT can be used to follow the design introduced next.
Step 1.  Define plant models and uncertainty: QFTCT plant definition window
The plant for the aircraft takes the form
	
P s
k s z
s s p
s
s
n
n
( )
((
)
)
((
)
)[(
)
(
)
]
=
+
+
+
+
/
/
/
/
1
1
2
1
2
ω
ζ ω
	
(2.59)
where the uncertain parameters are given by
	
k
z
p
n
∈

∈

∈

∈

0 2 2 0
0 5 0 75
1 0 10 0
5 0 6 0
. , .
,
. , .
,
. ,
.
,
. , .
ω
,
. , .
ζ ∈[
]
0 8 0 9 	
The array of selected frequencies is:
	
ω = 

0 00 0 0 0
0
0 0
0 00
.
.
.
.
1
1
1
5 1 4 1 3 15 3
rad/s 	
Time (s)
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
–0.2
0
0.2
0.4
0.6
0.8
1
QFTCT
×10–3
FIGURE 2.24
Sensitivity or plant output disturbance rejection: time-domain responses y(t) of 900 cases of 1/(1 + PG) to a 
unitary step disturbance d(t).

46
Robust Control Engineering
Step 2.  Select nominal plant P0(s): QFTCT Plant definition window
The selected nominal plant is
	
P s
k
s z
s s p
s
s
n
n
0
0
0
0
0
2
0
0
1
1
2
1
( )
((
)
)
((
)
)[(
)
(
)
] ;
=
+
+
+
+
/
/
/
/
with 
ω
ζ
ω
k
z
p
n
0
0
0
0
0
0 2
0 5
1
5
0 8
=
=
=
=
=
. ,
. ,
,
,
.
ω
ζ
	
(2.60)
Step 3.  Calculate QFT templates at given ωi: QFTCT Templates window
The QFT templates for the plant defined in Equation 2.59 and the frequencies of ­interest, 
ω = [0.001 0.01 0.1 0.5 1 4 10 30 150 300] rad/s, are shown in Figure 2.25.
Step 4.  Define stability specifications: QFTCT Specifications window
The desired robust stability specification is—see also Figure 2.26,
	
P j
G j
P j
G j
W
GM
PM
s
(
) (
)
(
) (
)
.
.
ω
ω
ω
ω
ω
1
5 26
49 25
+
≤
=
=
=
°
=
1.2(
dB,
)
for 
0.001 0.01 0.1 0.5 1 4 10 30 150 300 rad/s


	
(2.61)
Step 5.  Define performance specifications: QFTCT Specifications window
The desired robust performance specifications are
•	 Sensitivity or output disturbance rejection specification—see Figure 2.27a:
	
1
1
2 8
0 5
2
0 5
2
3
2
3
+
≤
=
+
+
+
P j
G j
op
j
j
j
j
j
(
) (
)
.
( )
. (
)
(
)
(
)
. (
)
(
)
ω
ω
δ
ω
ω
ω
ω
ω
ω 2
2 8
1
+
=[
]
+
. (
)
jω
ω
for 
0.001  0.01  0.1  0.5 rad/s
	
(2.62)
Open-loop phase (deg)
–250
–200
–150
–100
–50
Open-loop magnitude (dB)
–140
–120
–100
–80
–60
–40
–20
0
20
40
60
0.001
0.01
0.1
0.5
1
4
10
30
150
300
QFTCT
FIGURE 2.25
QFT templates for ω = [0.001 0.01 0.1 0.5 1 4 10 30 150 300] rad/s. Nominal plant marked with “x.”

47
QFT Robust Control
•	 Reference tracking specification—see Figure 2.27b:
	
δ
ω
ω
ω
ω
ω
ω
δ
ω
lo
up
P j
G j
P j
G j
F j
( )
(
) (
)
(
) (
) (
)
( )
≤
+
≤
1
	
(2.63)
where
	
δ ω
ω
ω
ω
lo
j
j
j
( )
. (
)
(
)
(
)
.
=
+
+
+
1
0 5
2
1
3
2
2 8
is the lower bound
	
–360
–315
–270
–225
–180
–135
–90
–45
0
–10
–5
0
5
10
15
20
25
30
35
 –12 dB
 –6 dB
 –3 dB
 –1 dB
 0.25 dB
 0.5 dB
 1 dB
 3 dB
 6 dB
Nichols chart
Open-loop phase (deg)
Open-loop gain (dB)
Ws = 1.2
FIGURE 2.26
Stability specification in the Nichols chart: Ws = 1.2 (1.58 dB).
0
2
4
6
8
10
12
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Step response
Time (s)
Amplitude
δup
δlo
10–2
10–1
100
101
Magnitude (dB)
–35
–30
–25
–20
–15
–10
–5
0
5
Bode diagram
Frequency (rad/s)
δop
(a)
(b)
FIGURE 2.27
Control specifications for P(s). (a) Sensitivity or disturbance rejection at the output of the plant: δop. (b) Reference 
tracking: δup,δlo.

48
Robust Control Engineering
and
	
δ
ω
ω
ω
ω
up
j
j
j
( )
.
(
)
.
(
)
.
(
)
=
+
+
+
2 8571
1
0 6667
2 3333
1
2
the upper bound
	
	
for
rad s
ω=[
]
0.001  0.01  0.1  0.5  1  4  10
/ 	
Step 6.  Calculate stability QFT Bounds: QFTCT Bounds window
Using the plant model of Equation 2.59, the nominal plant of Equation 2.60 and the sta­
bility specification in Equation 2.61, we calculate the stability bounds—see Figure 2.28.
Step 7.  Calculate performance QFT Bounds: QFTCTBounds window
Using the plant model of Equation 2.59, the nominal plant of Equation 2.60, the sensitiv­
ity specification in Equation 2.62, and the reference tracking specification in Equation 
2.63, we calculate the sensitivity and reference tracking bounds—see Figures 2.29 and 
2.30, respectively.
Step 8.  Intersection of bounds & compatibility: QFTCT Bounds window
The intersection of bounds for the stability, sensitivity, and reference tracking is shown 
in Figure 2.31. As we have a bound solution for each frequency, the selected control 
specifications for the system are compatible.
Step 9.  Synthetize feedback controller G(s): QFTCT Controller design window
Looking at the intersection of bounds presented in Figure 2.31, we design a controller 
that meets these QFT bounds, as shown in Equation 2.64 and Figure 2.32. As in the pre­
vious example, the small circles and numbers in the figure indicate the frequencies for 
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–50
–40
–30
–20
–10
0
10
20
QFTCT
0.5
4
1
10
30
150
300
0.1
0.01
0.001
FIGURE 2.28
Stability bounds for ω = [0.001 0.01 0.1 0.5 1 4 10 30 150 300] rad/s.

49
QFT Robust Control
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–60
–40
–20
0
20
40
60
QFTCT
0.1
0.5
0.001
0.01
FIGURE 2.29
Sensitivity bounds for ω = [0.001 0.01 0.1 0.5] rad/s.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–60
–40
–20
0
20
40
60
80
100
120
QFTCT
0.001
0.1
0.5
1
10
4
0.01
FIGURE 2.30
Reference tracking bounds for ω = [0.001 0.01 0.1 0.5 1 4 10] rad/s.

50
Robust Control Engineering
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–60
–40
–20
0
20
40
60
80
100
120
QFTCT
0.001
0.01
0.1
0.5
4
1
10
30
150
300
FIGURE 2.31
Intersection of bounds for ω = [0.001 0.01 0.1 0.5 1 4 10 30 150 300] rad/s.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
80
100
QFTCT
L0(jw)
0.001
0.01
0.1
0.5
1
4
10
30
150
300
FIGURE 2.32
QFT bounds and G(s) design, loop shaping.

51
QFT Robust Control
the function L0(s) = P0(s)G(s). The objective is to move each small circle above the solid-
line bounds or below the dashed-line bounds. The proposed controller G(s) meets well 
all the bounds. The QFTCT, Controller design window, can be used to easily design this 
controller—see also Section 2.14
	
G s
s
s
s
( )
((
)
)((
)
)
((
)
)
=
+
+
+
5
4
1
13
1
350
1 2
/
/
/
	
(2.64)
Step 10.  Synthetize prefilter F(s): QFTCT Prefilter design window
Taking into account the controller G(s)—see Equation 2.64, the reference tracking speci­
fications—see Equation 2.63, and the plant model—see Equation 2.59, we design a pre­
filter F(s) to make sure that all the input/output functions P(s)G(s)F(s)/[1 + P(s)G(s)] are 
inside the band defined by the limits δup(ω) and δlo(ω). The prefilter is shown in Equation 
2.65, and the input/output functions and limits in Figure 2.33.
	
F s
s
( )
(
. )
=
+
1
3 5
1
/
	
(2.65)
Step 11.  Analysis in the frequency domain: QFTCT Analysis window
For the analysis and validation, we use the 2DOF control block diagram shown in Figure 
2.13, with the controller G(s) in Equation 2.64, the prefilter F(s) in Equation 2.65, H(s) = 1, 
and the plant model with uncertainty in Equation 2.59.
Frequency (rad/s)
Magnitude (dB)
–90
–80
–70
–60
–50
–40
–30
–20
–10
0
10
QFTCT
PGF/(1 + PG)
10–2
10–1
102
100
101
δup
δlo
FIGURE 2.33
Prefilter F(jω) design for δlo(ω) ≤ |PGF/(1 + PG)| ≤ δup(ω).

52
Robust Control Engineering
The stability analysis in the frequency domain is shown in Figure 2.34, the dashed 
line is the stability specification Ws—Equation 2.61, and the solid line represents the 
worst case of the function PG/(1 + PG) at each frequency and due to the model uncer­
tainty. The control system meets the stability specification, as the solid line is below the 
dashed line Ws in all cases.
The analysis of the sensitivity specification in the frequency domain, or disturbance 
rejection at the output of the plant specification, is shown in Figure 2.35. The dashed 
line is the sensitivity specification δop(ω)—Equation 2.62, and the solid line represents 
the worst case of the function 1/(1 + PG) at each frequency and due to the model uncer­
tainty. The control system meets the sensitivity specification, as the solid line is below 
the dashed-line δop in all cases from 0 to 0.5 rad/s.
Step 12.  Analysis in the time domain (linear): QFTCT Analysis window
The analysis of the reference tracking specification in the time domain is shown in 
Figure 2.36. The figure shows the limits δup(ω) and δlo(ω)—see Equation 2.63, and the 
time responses y(t) of 500 cases of PGF/(1 + PG) to a unitary step reference r(t). The con­
trol system meets the specification (is between the upper and lower limits) in all cases.
Finally, the analysis in the time domain of the sensitivity, or disturbance rejection at 
the output of the plant specification, is shown in Figure 2.37. The figure shows the time 
responses y(t) of 500 cases of 1/(1 + PG) to a unitary step disturbance do(t). The control 
system achieves a good disturbance rejection in all cases.
Magnitude (dB)
–8
–6
–4
–2
0
2
0.001
0.01
0.1
0.5 1
4
10
30
150 300
QFTCT
Ws
Worst cases of
“PG/(1 + PG)”
Frequency (rad/s)
10–3
10–2
10–1
102
100
101
FIGURE 2.34
Stability analysis, frequency domain: Ws specification (dashed line), and worst case of PG/(1 + PG) within the 
uncertain plants at each frequency (solid line).

53
QFT Robust Control
Magnitude (dB)
–60
–50
–40
–30
–20
–10
0
0.001
0.01
0.1
0.5
QFTCT
Worst cases of
“1/(1 + PG)”
δop
Frequency (rad/s)
10–3
10–2
10–1
100
101
FIGURE 2.35
Sensitivity analysis, frequency domain: δop specification (dashed line), and worst case of 1/(1 + PG) within the 
uncertain plants at each frequency (solid line).
Time (s)
0
2
4
6
8
10
12
0
0.2
0.4
0.6
0.8
1
1.2
1.4
QFTCT
δup
δlo
FIGURE 2.36
Reference tracking analysis, time domain: δlo and δup specifications, and time responses y(t) of 500 cases of PGF/
(1 + PG) to a unitary step reference r(t).

54
Robust Control Engineering
2.11  Model Matching
In some circumstances, the main objective of the control system is that the closed-loop 
transfer function, or complementary sensitivity function y(s)/r(s), approaches a desired 
model Q0(s) within certain tolerances given by a function δm(ω). For these cases a 3-block 
control structure is suggested, as shown in Figure 2.38. A complementary discussion of 
this structure is included in Section 9.3, Solution 9.2b.
As we see, the controller has now three blocks: the classical feedback controller G(s), the 
prefilter, which is now the desired model F(s) = Q0(s), and a new feedforward element Gr(s). 
Based on this diagram, the model-matching control specification is defined as
Time (s)
0
2
4
6
8
10
12
0
0.2
0.4
0.6
0.8
1
QFTCT
Cases of  y = 1/(1 + PG) dstep
FIGURE 2.37
Sensitivity or plant output disturbance rejection analysis, time domain: time responses y(t) of 500 cases of 
1/(1 + PG) to a unitary step disturbance do(t).
+
n(s)
e(s)
u(s)
d(s)
G(s)
P(s)
H(s)
+
+
+
+
+
+
–
Gr(s)
r(s)
Q0(s)
F(s)
y(s)
M(s)
FIGURE 2.38
Model-matching structure. Controller blocks: G(s), F(s), and Gr(s).

55
QFT Robust Control
	
Q s
y s
r s
Q s
P s G s
P s G s
r
m
m
0
0
1
(
,
)
( )
( )
( )
( )
( )
( ) ( )
( )
−
=
−
+
≤
∈
δ
ω
ω
Ω
	
(2.66)
One of the main differences of this model-matching specification with respect to the 
classical reference tracking specification—see Type 6, Equation 2.40—is the use of phase 
information. The model-matching incorporates both magnitude and phase requirements 
[Q0(s) – y(s)/r(s)], while the classical reference tracking only uses magnitude information in 
the design of the prefilter F(s).
The design usually starts by selecting the desired model Q0(s) for the closed-loop trans­
fer function y(s)/r(s). Then, the feedforward element Gr(s) is set as,
	
G s
P s
Q s
r
c
( )
( )
( )
= −
−1
0
	
(2.67)
being Pc(s) a central plant within the uncertainty. Subsequently, the feedback controller 
G(s) is designed so that every possible closed-loop transfer function y(s)/r(s) meets the 
specification given by Equation 2.66.
EXAMPLE 2.2 (CONT.):  AIRPLANE FLIGHT CONTROL: 
FEEDBACK AND MODEL MATCHING
Consider again the flight control problem introduced in Example 2.2 to illustrate this 
model-matching case. The dynamics of the plant and the model uncertainty are the 
ones defined in Equation 2.59. The QFT templates are also the ones presented in Figure 
2.25. We consider the same stability specification of the original example—Equation 
2.61 and Figure 2.26, as well as the same sensitivity specification—Equation 2.62 and 
Figure 2.27a, and the reference tracking specification—Equation 2.63 and Figure 2.27b. 
In addition, we use the model-matching specification defined in Equation 2.66, with a 
desired model or prefilter as,
	
F s
Q s
s
s
( )
(
((
. )
)((
.
)
)
=
=
+
+
0
3
1
3 5
1
0 005
1
)
/
/
	
(2.68)
which is similar to the prefilter designed in Equation 2.65, with the same pole at 3.5 and 
three additional poles at 0.005 to have a fourth-order denominator and then a proper 
function Q0(s)/Pc(s). Figure 2.39 shows the Bode diagram and the step response of both 
prefilters—Equations 2.65 and 2.68.
Additionally, the selected model-matching specification δm(s) for Equation 2.66 is,
	
δ
γ
γ
γ
ω
m s
s
s
( )
/
/
with 
and 
0.0010.010.10.5 1 410 30 15
=
+
=
=
(
)
(
)
,
,
[
1
1
0 300 rad/s
]
	
(2.69)
Now, by selecting Pc(s) as a central plant within the uncertainty
	
P s
k
s z
s s p
s
s
c
c
c
c
nc
c
nc
( )
((
)
)
((
)
) (
)
(
)
,
=
+
+
+
+


/
/
/
/
w
1
1
2
1
2
ω
ζ
ω
ith k
z
p
c
c
c
nc
c
=
=
=
=
=
1 1
0 625
5 5
5 5
0 85
. ,
.
,
. ,
. ,
.
ω
ζ
	
(2.70)

56
Robust Control Engineering
the feedforward element Gr(s) becomes
	
G s
Q s
P s
s s
s
s
r
c
( )
( )
( )
((
. )
)[(
. )
(
.
. )
]
.
=
=
+
+
×
+
0
2
5 5
1
5 5
2
0 85 5 5
1
1 1
/
/
/
((
.
)
)((
. )
)((
.
)
)
s
s
s
/
/
/
0 625
1
3 5
1
0 005
1 3
+
+
+
	
(2.71)
The QFT bounds for the model-matching specification Equation 2.66, with the 
model Q0(s), feedforward element Gr(s), and model-matching objective δm(s) defined in 
Equations 2.68, 2.71 and 2.69, respectively, are shown in Figure 2.40. The intersection of 
0
0.5
1
1.5
2
2.5
3
0
0.2
0.4
0.6
0.8
1
Step response
Time (s)
Amplitude
F(s), case model matching
F(s), case reference tracking
Magnitude (dB)
–200
–150
–100
–50
0
Phase (deg)
–360
–270
–180
–90
0
Bode diagram
Frequency (rad/s)
10–1
103
104
102
100
101
F(s), case reference tracking
F(s), case model matching
F(s), case model matching
F(s), case reference tracking
FIGURE 2.39
Prefilters F(s). Solid line, as designed for the reference tracking case, Equation 2.65; and dashed line, for model 
matching, Equation 2.68.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–60
–40
–20
0
20
40
60
QFTCT
0.001
0.01
4
1
0.5
0.1
10
150
30
300
FIGURE 2.40
QFT bounds for the model-matching specification.

57
QFT Robust Control
the QFT bounds of stability, sensitivity, reference tracking, and model matching, and 
the loop shaping of G(s) are shown in Figure 2.41.
The resulting feedback controller G(s) is the same as in the original flight control prob­
lem—see also Equation 2.64
	
G s
s
s
s
( )
((
)
)((
)
)
((
)
)
=
+
+
+
5
4
1
13
1
350
1 2
/
/
/
	
(2.72)
The time-response analysis of the control system under a unitary step reference input 
r(t) is shown in Figure 2.42. It considers the model-matching structure shown in Figure 
2.38, the control functions defined in Equations 2.68, 2.71, and 2.72 for F(s), Gr(s) and 
G(s), respectively, and several cases within the parametric model uncertainty defined 
in Equation 2.59.
For additional methodologies about this model-matching specification, see the 
References 138 and 121 regarding the SISO and MIMO cases, respectively.
NOTE: the QFT bounds for this model-matching case are generated with QFTCT. We 
create an array of functions A1 with an m.file, save it in the disk, load it from the Plant 
definition window as a transfer function array A1, and define a specification in the 
Specifications window using the case Tk. Define by user, with A = A1, B = 0, C = 1, D = P, 
and δm(s) as defined in Equation 2.69.
% m.file to create A1
% -------------------
F = tf(1,conv(conv(conv([1/3.5 1],[1/0.005 1]),[1/0.005 1]),[1/0.005 1]));
kc = 1.1; zc = 0.625; pc = 5.5; wnc = 5.5; gic = 0.85;
Pc = tf(kc*[1/zc 1],conv([1/pc 1 0],[1/wnc^2 2*gic/wnc 1]));
Gr = minreal(F/Pc);
Open-loop phase (deg)
–300
–350
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
80
100
QFTCT
L0(jw)
0.001
0.01
0.1
0.5
4
10
1
30
150
300
FIGURE 2.41
QFT bounds and G(jω) design, loop shaping.

58
Robust Control Engineering
i1m = 2; i2m = 2; i3m = 2; i4m = 2; i5m = 2;
kv = logspace(log10(0.2),log10(2),i1m);
zv = logspace(log10(0.5),log10(0.75),i2m);
pv = logspace(log10(1),log10(10),i3m);
wnv = logspace(log10(5),log10(6),i4m);
giv = logspace(log10(0.8),log10(0.9),i5m);
cc = 0;
for i1=1:i1m
  k= kv(i1);
  for i2=1:i2m
    z = zv(i2);
    for i3=1:i3m
      p = pv(i3);
      for i4=1:i4m
        wn = wnv(i4);
        for i5=1:i5m
          gi = giv(i5);
          P = tf(k*[1/z 1],conv([1/p 1 0],[1/wn^2 2*gi/wn 1]));
          cc = cc + 1;
          A1(1,1,cc) = minreal(F - P * Gr);
        end
      end
    end
  end
end
save A1 A1;
Time (s)
0
1
2
3
4
5
6
7
8
9
10
y(t)
0
0.2
0.4
0.6
0.8
1
1.2
Control system with G, F, Gr (solid)
Step response
Control system with G, F (dashed)
FIGURE 2.42
Comparison of model-matching control system (solid line) and the original reference tracking control system 
(dashed line). Time response y(t) to a unitary step reference r(t). Several plants within the uncertainty.

59
QFT Robust Control
2.12  Feedforward Control
Often, the main goal of the control system is to efficiently reject the disturbances that affect 
the plant. For these cases, we suggest the feedback–feedforward control structure pre­
sented in Figure 2.43. A complementary discussion of this structure is included in Section 
9.3, Solution 9.2a.
As we can see, the controller has now three blocks: the classical feedback controller G(s), 
the prefilter F(s) for cases with reference tracking specs, and a new feedforward element 
Gf(s). This new block uses an additional sensor for the disturbance d(s), and adds a supple­
mentary signal to u(s). Based on this diagram, the disturbance rejection specification with 
the feedforward element is defined as
	
y s
d s
M s
P s G s
P s G s
f
d
d
( )
( )
( )
( )
( )
( ) ( )
( )
=
+
+
≤
∈
1
δ ω
ω
,
Ω
	
(2.73)
The design usually starts by selecting a feedforward component Gf(s) as
	
G s
P s
M s V s
f
c
( )
( )
( ) ( )
= −
−1
	
(2.74)
being Pc(s) a central plant within the uncertainty and V(s) a low-pass filter with high-fre­
quency poles to complete a proper function for Gf(s). Subsequently, the feedback controller 
G(s) is designed so that every possible closed-loop transfer function y(s)/d(s) meets the 
specification given by Equation 2.73.
EXAMPLE 2.2 (CONT.):  AIRPLANE FLIGHT CONTROL: 
FEEDBACK AND FEEDFORWARD
Consider again the flight control problem introduced in Example 2.2, now adding also 
the feedforward component Gf(s) as illustrated in Figure 2.43. The dynamics of the plant 
and the model uncertainty are the ones defined in Equation 2.59. The QFT templates 
are also the ones presented in Figure 2.25. We consider the same stability specification 
of the original example—Equation 2.61 and Figure 2.26, as well as the same sensitivity 
specification—Equation 2.62 and Figure 2.27a.
For this example, we complete the plant with a transfer function M(s) from the distur­
bance d(s) to the plant output y(s) such that
	
M s
k
s s p
k
p
( )
((
)
) ;
. ,
=
+
=
=
0
0
0
0
1
0 2
1
/
with
	
(2.75)
+
n(s)
e(s)
u(s)
d(s)
G(s)
P(s)
H(s)
+
+
+
+
+
+
–
Gf(s)
r(s)
F(s)
y(s)
M(s)
FIGURE 2.43
Feedback–feedforward structure. Controller blocks: G(s), F(s), and Gf(s).

60
Robust Control Engineering
With this models, and selecting Pc(s) as a central plant within the uncertainty as in 
Equation 2.70, and a low-pass filter function as V(s) = 1/[(s/5.5) + 1], the feedforward 
component Gf(s) becomes
	
G
s
P s
M s V s
s s
s
f
c
( )
( )
( ) ( )
((
. )
)[(
. )
.
.
= −
=
= −
+
+
×
(
−1
2
5 5
1
5 5
2
0 85 5 5
/
/
/
) +
+
+
+
s
s
s s
s
1
1 1
0 625
1
0 2
1
1
5 5
1
]
. ((
.
)
)
.
(
) (
. )
/
( /
) 	
(2.76)
which is—see also Figure 2.44,
	
G
s
s
s
s
s
f ( )
.
(
. )
(
.
. )
((
.
)
)(
= −
+
×
+


+
0 1818
5 5
2
0 85 5 5
1
0 625
1
2
/
/
/
+1)
	
(2.77)
The desired disturbance rejection specification δd(s) for Equation 2.73 is chosen as
	
δ
ω
d s( )
with
0.001 0.01 0.1 0.5 1 4 10 rad/s
=
= 

0 014
.
,
	
(2.78)
which is more demanding than the original output disturbance rejection specification 
defined in Equation 2.62. The QFT bounds for the disturbance rejection specification 
are shown in Figure 2.45. It represents Equation 2.73, with the feedforward element 
Gf(s) defined in Equations 2.77, the disturbance transfer function M(s) of Equation 2.75, 
and the objective δd(s) defined in Equation 2.78. The intersection QFT bounds for stabil­
ity, sensitivity, and disturbance rejection, and the loop shaping of G(s) are shown in 
Figure 2.46.
After the loop shaping, the resulting feedback controller G(s) is—see Section 2.14,
	
G s
s
s
s
s
s
( )
((
)
)((
)
)((
)
)
((
)
)((
)
)
=
+
+
+
+
+
60
6
1
10
1
150
1
70
1
200
1
/
/
/
/
/
2
	
(2.79)
Magnitude (dB)
–50
–40
–30
–20
–10
Phase (deg)
45
90
135
180
Bode diagram
10–2
100
10–1
101
103
102
Frequency (rad/s)
FIGURE 2.44
Bode diagram of Gf(s), Equation 2.40.

61
QFT Robust Control
The time-response analysis of the control system under a unitary impulse distur­
bance input d(t) is shown in Figure 2.47. It considers the feedback–feedforward struc­
ture shown in Figure 2.43, the control functions defined in Equations 2.79 and 2.77 for 
G(s) and Gf(s), respectively, and several cases within the parametric model uncertainty 
defined in Equation 2.59.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–50
0
50
100
QFTCT
0.001
0.1
0.5
10
0.01
1
4
FIGURE 2.45
QFT bounds for the disturbance rejection specification including the feedforward controller—see Equations 
2.73, 2.75, 2.77, and 2.78.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–40
–20
0
20
40
60
80
QFTCT
0.001
L0(jw)
0.01
0.1
0.5
1
4
10
30
150
300
FIGURE 2.46
QFT bounds and G(s) design, loop shaping.

62
Robust Control Engineering
For additional QFT methodologies about this feedforward specification, see the 
References 138 and 121 regarding the SISO and MIMO cases, respectively.
NOTE: the QFT bounds for this feedback–feedforward case are generated with QFTCT. 
We create an array of functions A2 with an m.file, save it in the disk, load it from the 
Plant definition window as a transfer function array A2, and define a specification in the 
Specifications window using the case Tk. Define by user, with A = A2, B = 0, C = 1, D = P, 
and δd(s) as defined in Equation 2.78.
% m.file to create A2
% -------------------
M = tf(0.2,[1 1 0]);
Gf = tf(-0.1818*[1/5.5^2 2*0.85/5.5 1],conv([1/0.625 1],[1 1]));
i1m = 2; i2m = 2; i3m = 2; i4m = 2; i5m = 2;
kv = logspace(log10(0.2),log10(2),i1m);
zv = logspace(log10(0.5),log10(0.75),i2m);
pv = logspace(log10(1),log10(10),i3m);
wnv = logspace(log10(5),log10(6),i4m);
giv = logspace(log10(0.8),log10(0.9),i5m);
cc = 0;
for i1=1:i1m
  k= kv(i1);
  for i2=1:i2m
    z = zv(i2);
    for i3=1:i3m
      p = pv(i3);
      for i4=1:i4m
        wn = wnv(i4);
        for i5=1:i5m
          gi = giv(i5);
          P = tf(k*[1/z 1],conv([1/p 1 0],[1/wn^2 2*gi/wn 1]));
          cc = cc + 1;
0
1
2
3
4
5
6
7
8
9
10
0
2
4
6
8
10
Impulse response
Time (s)
Amplitude
Only G(s)
G(s) and Gf (s)
×10–4
0
1
2
3
4
5
6
7
0
2
4
6
8
10
12
14
Impulse response
Time (s)
Amplitude
G(s) and Gf (s)
Only G(s)
×10–3
(a)
(b)
FIGURE 2.47
Time response y(t) to a unitary impulse disturbance d(t). (a) central plant and (b) other plants within the uncer­
tainty. Comparison of cases: only feedback [G(s)] and feedback–feedforward [G(s) and Gf(s)] structures.

63
QFT Robust Control
The feedback–feedforward solution can also be combined with the model-matching 
structure introduced in the previous section, as shown in Figure 2.48. In this case, the 
design of F(s) and Gr(s) for the model-matching part and of Gf(s) for the feedforward part 
are developed independently and according to the expressions presented in Sections 
2.11 and 2.12, respectively. Then, after both parts contribute to the QFT bounds—see 
Equations 2.66 and 2.73, the feedback controller G(s) is designed (loop shaping) in the 
Nichols chart. A complementary discussion of this structure is included in Section 9.3, 
Solution 9.2c.
2.13  PID Control: Design and Tuning with QFT
Proportional integral derivative (PID) controllers are the most popular control strategy 
used in industry. Over 90% of control loops in real-world applications are composed of PID 
controllers. Nevertheless, it is quite common to find PIDs that are not the best choice for a 
given application, or are not tuned properly.
Frequently, control engineers decide to use a PID strategy to regulate the system without 
much further deliberation. However, we should ask first whether or not this is the appro­
priate control solution for the problem. Sometimes the plant needs a richer strategy, with 
some extra zeros and poles, to meet the specifications.
Yet, if the PID controller is a suitable solution, it is still important to find the appropriate 
methodology to tune the PID parameters.
QFT provides a powerful and easy-to-use methodology to analyze both problems: (a) to 
find a convenient control strategy for a given problem and (b) to tune the parameters for 
the controller.
          A2(1,1,cc) = minreal(M + P * Gf);
        end
      end
    end
  end
end
save A2 A2;
+
n(s)
e(s)
u(s)
d(s)
G(s)
P(s)
H(s)
+
+
+
+
+
+
+
–
Gf(s)
Gr(s)
r(s)
Q0(s)
F(s)
y(s)
M(s)
FIGURE 2.48
Feedback–feedforward model-matching structure. Controller blocks: G(s), F(s), Gr(s), and Gf(s).

64
Robust Control Engineering
The previous sections of this chapter studied how to design a QFT robust controller 
for a given application that presents model uncertainty and has a set of multiple control 
objectives or specifications. The QFT methodology is also particularly useful to design PID 
controllers. This section introduces a practical review of PIDs and shows how to apply the 
QFT methodology to design them.
A standard PID controller, with a low-pass filter for derivative part to attenuate the effect 
of noise, is shown in Equations 2.80 and 2.89. This standard PID form is the most common 
one, and is able to implement cases with either two real zeros as in Equation 2.91, or two 
complex zeros as in Equation 2.101. The standard PI and PD options are also shown in 
Equations 2.81 and 2.82, respectively
	
G
s
u s
e s
K
T s
T s
T
N s
PID
p
i
d
d
( )
( )
( )
(
)
=
=
+
+
+






1
1
1
/
	
(2.80)
	
G
s
u s
e s
K
T s
PI
p
i
( )
( )
( )
=
=
+






1
1
	
(2.81)
	
G
s
u s
e s
K
T s
T
N s
PD
p
d
d
( )
( )
( )
(
)
=
=
+
+






1
1
/
	
(2.82)
where Kp is the proportional gain, Ti the integral time, Td the derivative time, N the low-
pass filter constant, e(s) the control error, and u(s) the output of the controller.
The time-domain differential equation for a PID is composed by the three channels, 
proportional, integral, and derivative, as shown in Equation 2.83. When the reference r(t) 
changes very quickly, say as a step, then the error e(t) also changes very quickly, and as a 
consequence the derivative of the error becomes very large—see Equation 2.84.
	
u t
K
e t
T
e
d
T de t
dt
p
i
d
t
( ) =
( )+
( )
+
( )






∫
1
0
τ
τ
	
(2.83)
	
K T de t
dt
e t
r t
y t
p
d
( )
=
−
;
( )
( )
( )
	
(2.84)
The so-called PI-D and I-PD Kick-off solutions are an answer for this problem. They 
work well for references r(t) that follow steps or are constant values. In general, we can see 
the PID of Equation 2.80 as an expression with three different errors—see Equations 2.85 
through 2.88.
	
u s
K
e s
T s e s
T s
T
N s e s
p
p
i
d
d
d
( )
( )
( )
(
)
( )
=
+
+ +






1
1
/
	
(2.85)
with,
	
e
s
br s
y s
p( )=
−
( )
( ) 	
(2.86)

65
QFT Robust Control
	
e
s
cr s
y s
d( )=
−
( )
( ) 	
(2.87)
	
e s
r s
y s
( )=
−
( )
( )	
(2.88)
If we select b = 1 and c = 0, we will avoid the very large initial derivative value under 
a step reference, while having the same response as the classical PID for a constant refer­
ence. This solution is the so-called PI-D controller, and the implementation is shown in 
Figure 2.49.
If we go further and select b = 0 and c = 0, we will obtain an even smoother signal under 
a step reference. This is the so-called I-PD controller, and the implementation is shown in 
Figure 2.50.
Using the 2DOF QFT methodology, we can design and implement both cases, the 
PI-D and I-PD Kick-off solutions. Equation 2.89 shows the feedback controller GPID(s) and 
Equation 2.90 the prefilter F1(s) as a function of b and c. By selecting b = 1 and c = 0 in 
Equation 2.90, we have the PI-D controller. Similarly, choosing b = 0 and c = 0 we obtain 
the I-PD controller—see also Figure 2.51.
	
u s
e s
G
s
K
T
TT
N s
T
T
N
PID
p
i
i
d
i
d
( )
( )
(
(
))
(
(
)
( )
=
=





+
+
+
1
1
2
/
/
)
((
)
)
s
s T
N s
d
+
+
1
1
/
	
(2.89)
+
n(s)
e(s)
u(s)
d(s)
P(s)
H(s)
+
+
+
+
–
+
–
PI
D
r(s)
y(s)
M(s)
FIGURE 2.49
PI-D controller.
+
n(s)
e(s)
u(s)
d(s)
P(s)
H(s)
+
+
+
+
–
+
–
I
PD
r(s)
y(s)
M(s)
FIGURE 2.50
I-PD controller.

66
Robust Control Engineering
	
r s
r s
F s
TT c
b N s
bT
T
N s
TT
N
i
d
i
d
i
d
1
1
2
1
1
1
( )
( )
(
(
))
(
(
))
(
(
( )
=
=
+
+
+
+
+
/
/
/
))
(
(
))
s
T
T
N s
i
d
2
1
+
+
+
/
	
(2.90)
These PI-D and I-PD Kick-off solutions are popular options in industrial PID con­
trollers to weight the reference signal. However, quite often it is much better to 
design just a simpler prefilter F(s) according to the QFT-prefilter design methodology. 
Example 2.1 is an illustrative case of this fact, with the simple and effective prefilter 
of Equation 2.58.
In the presence of saturation in the actuator of the plant, the integral part of the control­
ler can produce a wind-up problem, with an unwanted overshoot. A practical solution of 
this problem is presented later, in Section 7.4, with an anti-wind-up strategy.
EXAMPLE 2.1 (CONT.):  ARMATURE-CONTROLLED DC MOTOR—CASE A
Consider again the Example 2.1 (armature-controlled DC motor) with the uncertainty 
defined in Case a. In Section 2.8, we designed a controller G(s)—see Equation 2.56—that 
met the proposed QFT bounds, as shown in Figure 2.19. This controller is in fact a PID 
controller with a low-pass filter for the derivative part. For convenience, we repeat the 
controller here again, first as a gain-zero-pole structure—see Equation 2.91, and then as 
the equivalent standard PID structure—see Equation 2.92.
	
G
s
k s z
s z
s s p
k
z
z
PID( )
/
/
/
with 
=
+
+
+
=
=
((
)
)((
)
)
((
)
)
,
,
1
2
2
1
1
1
1100
55
==
=
1700
25 000
,
,
p
	
(2.91)
	
G
s
K
T
TT
N s
T
T
N s
s T
PID
p
i
i
d
i
d
d
( )
(
(
))
(
(
))
((
=





+
+
+
+
1
1
1
2
/
/
/
with 
N s
K
T
T
N
p
i
d
)
)
.
,
.
,
.
,
.
+
=
=
=
×
=
−
1
20 60
0 0187
5 31 10
13 28
4
	
(2.92)
Figure 2.52 shows the magnitude of the controller in a Bode diagram. It starts with a 
slope of –20db/decade at low frequency due to the integrator (1/s), continues with two 
real zeros (z1 and z2), and finishes with a high-frequency pole (p).
+
n(s)
e(s)
u(s)
d(s)
GPID(s)
P(s)
H(s)
+
+
+
+
–
r(s)
F1(s)
r1(s)
y(s)
M(s)
FIGURE 2.51
General 2DOF PID controller.

67
QFT Robust Control
Format Conversion
Often, it is more convenient to design the PID controller (loop shaping) by selecting the 
appropriate gain, two zeros, and pole (in addition to the integrator), instead of working 
directly with the coefficients Kp, Ti, Td, and N. This allows the designer to find better 
solutions in many cases. For these situations a conversion between the gain-zero-pole 
expression and the standard PID expression is needed. The conversion from the gain-
zero-pole form in Equation 2.91 to the standard PID form in Equation 2.92 is easily 
done with the expressions in Equations 2.93 through 2.96. In this case the gain-zero-pole 
structure contains two real zeros, z1, z2.
	
T
z
z
p
i =
+
−
1
1
1
1
2
	
(2.93)
	
K
kT
k z
z
p
p
i
=
=
+
−






1
1
1
1
2
	
(2.94)
	
T
T z z
p
z
z
p z z
p
d
i
=
−
=
+
−
−
1
1
1
1
1
1
1
1
2
1
2
1
2
((
)
(
)
(
))
/
/
/
	
(2.95)
	
N
T p
p
z
z
p z z
d
=
=
+
−
−
((
)
(
)
(
))
1
1
1
1
1
2
1 2
/
/
/
	
(2.96)
If we are interested in the conversion in the opposite direction, from the standard 
PID structure in Equation 2.92 to the gain-zero-pole structure with two real zeros in 
Equation 2.91, we can use the expressions in Equations 2.97 through 2.100.
	
k
K
T
p
i
=
	
(2.97)
	
p
N
Td
=
	
(2.98)
Frequency (rad/s)
Magnitude (dB)
0
20
40
60
Bode diagram of G(s)
k = Kp/Ti = 1100
z1 = 55
p = N/Td = 25,000
z2 = 1700
1/s
100
101
103
104
102
FIGURE 2.52
PID controller. Equations 2.91 or 2.92. GPID(s).

68
Robust Control Engineering
	
z
T
T
N
T
T
N
T T
N
i
d
i
d
i
d
1
2
2
2
4
1
1
=
+
+
+
−
+




(
(
))
(
(
))
(
(
))
/
/
/
	
(2.99)
	
z
T T
N
T
T
N
T
T
N
T T
N
i
d
i
d
i
d
i
d
2
2
2
1
2
1
1
4
1
1
=
+
+
+
+
−
+
(
(
)) (
(
))
(
(
))
(
(
))
/
/
/
/




	
(2.100)
Sometimes, the numerator of the standard PID structure has two complex zeros 
instead of two real zeros. In this situation the equivalent gain-zero-pole structure has 
the form,
	
G
s
k s
s
s s p
PID
n
n
( )
/
/
/
=
+
+


+
(
)
(
)
((
)
)
ω
ζ ω
2
2
1
1
	
(2.101)
Now, the conversion from the gain-zero-pole structure with two complex zeros in 
Equation 2.101 to the standard PID structure in Equation 2.92 is done with the expres­
sions in Equations 2.102 through 2.105.
	
T
p
i
n
=
−
2
1
ζ
ω
	
(2.102)
	
K
kT
k
p
p
i
n
=
=
−






2
1
ζ
ω
	
(2.103)
	
T
T
p
p
p
p
d
i
n
n
n
=
−
=
−
−
1
1
2
1
2
2
ω
ζ ω
ω
	
(2.104)
	
N
T p
p
p
d
n
n
=
=
−
−
2
2
2
1
ζ ω
ω
	
(2.105)
Finally, to go from the standard PID structure in Equation 2.92 to the gain-zero-pole 
structure with two complex zeros in Equation 2.101, we can use the expressions in 
Equations 2.106 through 2.109.
	
k
K
T
p
i
=
	
(2.106)
	
p
N
Td
=
	
(2.107)
	
ωn
i
d
T T
N
=
+
1
1
1
2
(
(
))
/
	
(2.108)
	
ζ =
+
+
T
T
N
T T
N
i
d
i
d
(
)
(
(
))
/
/
2
1
1
2
	
(2.109)
Also, as mentioned for this Example 2.1, in Section 2.9 we designed a simple prefilter 
F(s)—see Equation 2.58—that met the reference tracking specifications of Equations 2.52 
through 2.54, as we saw in Figures 2.20 and 2.23.

69
QFT Robust Control
2.14  Practical Tips
Some common questions that arise while designing a control system are how to actu­
ally choose the stability and performance specifications effectively, and how to design the 
feedback controller G(s) and the prefilter F(s). This section proposes some tips to help the 
designer in these important areas.
2.14.1  Selection of Specifications
2.14.1.1  Stability Ws
The stability specification has to be met at each and every frequency of the array of fre­
quencies of interest. Then, unlike with other performance specifications, select the com­
plete array of frequencies of interest for the stability specification.
On the other hand, there is a practical relationship between the phase margin and the 
overshoot of the closed-loop system time response. The larger the phase margin, the 
smaller the overshoot.
Some practical and frequently selected stability specifications are:
Ws = 1.66 (in magnitude) which is related to PM = 35° and GM = 4.09 dB
Ws = 1.46 (in magnitude) which is related to PM = 40° and GM = 4.53 dB
Ws = 1.305 (in magnitude) which is related to PM = 45° and GM = 4.94 dB
2.14.1.2  Sensitivity δ3(ω)
The rejection of disturbances that enter directly at the output of the plant is often a 
required objective—see do in Figure 2.13. The plant output disturbance rejection specifica­
tion is defined as specification Type 3, or sensitivity, and described in Equation 2.37. For 
convenience, we repeat this expression below, as Equation 2.110.
As we see, the output of the plant y(jω) is affected by the disturbance do(jω) through 
the transfer function T3(jω), which is limited by the specification δ3(ω). Then, in the 
worst case scenario the change of the output of the plant due to the disturbance is: y(jω) = 
δ3(ω) do(jω).
	
T j
P j
G j
T j
y j
d j
e
o
3
3
3
3
1
1
(
)
(
) (
)
( )
where 
(
)
(
)
(
)
(
ω
ω
ω
δ ω
ω
ω
ω
ω
=
+
≤
∈
=
=
,
Ω
j
d j
e j
F j
r j
e j
n j
o
ω
ω
ω
ω
ω
ω
ω
)
(
)
(
)
(
) (
)
(
)
(
)
=
=
	
(2.110)
Unlike the stability, the sensitivity specification δ3(ω) is usually defined for only some 
low to middle frequencies. Normally, we do not ask the system to reject high-frequency 
disturbances. In this way, we reduce high-frequency activity of the actuators and then 
avoid potential mechanical fatigue problems.
A practical selection of δ3(ω) is shown in Equation 2.111. As we can see in Figure 2.53, 
this expression gives a good disturbance rejection at low frequencies. The specification 

70
Robust Control Engineering
has also a slope of +20 dB/decade that reaches the –3 dB level at the frequency ω  = ad (the 
pole), and has a 0 dB value for high frequency.
	
δ3
1
( )
/
/
s
s a
s a
d
d
=
+
(
)
(
)
	
(2.111)
By selecting just one parameter, the pole ad in Equation 2.111, we can achieve differ­
ent levels of disturbance rejection. The higher the parameter ad, the more significant the 
attenuation of the effect of the disturbance. As an example, we present δ3(s) with ad = 1, 
10, and 100. Figure 2.53 shows the Bode diagram of δ3(s) in these three cases, and Figure 
2.54 the time-domain response when a disturbance do(s) = 1/s is introduced in the system, 
y(s) = [1/(1 + P(s)G(s))] do(s) = δ3(s) do(s).
Table 2.4 shows different choices, from ad = 0.001 to 10,000, and the corresponding fre­
quency for “–20dB” attenuation and bandwidth—see Figure 2.53, and the rise time and 
settling time in Figure 2.54.
Additionally, Figure 2.55 shows the ω = [0.001, 0.05, 1] QFT bounds with ad = 1, 10, and 
100 (cases a, b, and c, respectively), and using a first-order plant P(s) = k/[(s/p) + 1] with 
parametric uncertainty k∈[1, 2], p∈[0.1, 0.2].
Disturbances can enter into the system not only at the plant output, but also at many 
other points. Figure 2.13 showed some cases of disturbances entering at the error signal de, 
plant input di, plant output do, and at any generic point d. Section 2.6 discussed a variety of 
disturbance rejection specifications for all these cases—see Types 2, 3, 4, and k. The func­
tion of Equation 2.111 can also be used to define them.
Magnitude (dB)
–80
–70
–60
–50
–40
–30
–20
–10
0
10
Bode diagram
Time constant = 1/10 s
Time constant = 1/1 s
Time constant = 1/100 s
Frequency (rad/s)
100
101
103
10–1
102
δ3-b
δ3-a
δ3-c
FIGURE 2.53
Sensitivity or plant output disturbance rejection specification. Examples of Equation 2.111, where δ3a,b,c(s) is with 
ad = 1, 10, 100, respectively.

71
QFT Robust Control
2.14.1.3  Reference Tracking δ6-lo(ω), δ6-up(ω)
Like the sensitivity, the reference tracking specifications are usually defined for only some 
low-to-middle frequencies. Normally, we do not ask the system to follow a high-frequency 
reference. In this way, we reduce high-frequency activity of the actuators and then avoid 
potential mechanical fatigue problems.
A practical selection of δ6-lo(ω) and δ6-up(ω) is shown in Equations 2.112 through 2.114. As 
with the sensitivity, we have to select just two parameters, aL and aU, in these expressions. 
Tables 2.5 and 2.6 show different choices for aL and aU, from 0.001 to 10,000, and the cor­
responding rise time and settling time of the lower and upper specifications, δ6-lo(ω) and 
δ6-up(ω), respectively. Figure 2.56 shows the time response of y(t) for both specifications, 
0
0.5
1
1.5
2
2.5
3
3.5
4
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Step response
Time (s)
Amplitude
Rise time = 0.22 s
Rise time = 0.022 s
1/(1 + PG) = δ3-b
1/(1 + PG) = δ3-c
1/(1+ PG) = δ3-a
Rise time = 2.2 s
Settling time = 0.0391 s
Settling time = 0.391 s
Settling time = 3.91 s
FIGURE 2.54
Step response. Examples of Equation 2.111, where δ3a,b,c(s) is with ad = 1, 10, 100, respectively. y(s) = [1/(1 + P(s)G(s))] 
do(s) = δ3a,b,c(s) do(s), with do(s) = 1/s.
TABLE 2.4
Sensitivity Specifications δ3(s). Equation 2.111. Figures 2.53 and 2.54
ad
Frequency 
(rad/s) 
at –20dB
Bandwidth 
(rad/s)
Time 
Constant 
(s)
Rise Time (s)
from y(t) at 10% to 
y(t) at 90% of 
Steady State
Settling Time (s) 
from t = 0 to y(t) 
at ±2% of Steady 
State
0.001
0.0001
0.001
1000
2200
3910
0.01
0.001
0.01
100
220
391
0.1
0.01
0.1
10
22
39.1
1
0.1
1
1
2.2
3.91
10
1
10
0.1
0.22
0.391
100
10
100
0.01
0.022
0.0391
1000
100
1000
0.001
0.0022
0.00391
10,000
1000
10,000
0.0001
0.00022
0.000391

72
Robust Control Engineering
Equations 2.113 and 2.114, case aL = aU = 1, εlo = 0.01, εup = 0.01, y(s) = [P(s)G(s)/(1+P(s)G(s))] 
r(s) = δ6(s) r(s), and r(s) = 1/s. Figure 2.57 shows the Bode diagram of δ6-lo(ω) and δ6-up(ω) in 
this case.
	
δ
ω
ω
ω
ω
ω
ω
ω
ω
ω
δ
6-
6-
( )
(
)
(
)
(
)
(
)
(
) (
)
(
) (
)
lo
T j
y j
r j
F j
P j
G j
P j
G j
<
=
=
+
≤
6
1
up( )
ω
ω
,
∈Ω6
	
(2.112)
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
Open-loop magnitude (dB)
0
–20
0
20
40
60
80
100
120
QFTCT
B(δ3–c, 0.001 rad/s)
B(δ3–c, 1 rad/s)
B(δ3–c, 0.05 rad/s)
B(δ3-b, 0.001 rad/s)
B(δ3-b, 1 rad/s)
B(δ3-b, 0.05 rad/s)
B(δ3-a, 0.001 rad/s)
B(δ3-a, 0.05 rad/s)
B(δ3-a, 1 rad/s)
FIGURE 2.55
QFT bounds. Examples of Equation (2.111), where δ3a,b,c(s) is with ad  = 1, 10, 100, respectively. P(s) = k/[(s/p) + 1], 
k∈[1, 2], p∈[0.1, 0.2], ω = [0.001, 0.05, 1].
TABLE 2.5
Tracking Specifications δ6-lo(s). Equation 2.113. Figure 2.56. εlo = 0.01
aL
Rise Time (s) from y(t) 
at 10% to y(t) at 90% of 
Steady State
Settling Time (s) from 
t = 0 to y(t) at ±2% of 
Steady State
0.001
3360
5830
0.01
336
583
0.1
33.6
58.3
1
3.36
5.83
10
0.336
0.583
100
0.0336
0.0583
1000
0.00336
0.00583
10,000
0.000336
0.000583

73
QFT Robust Control
	
δ
ε
ε
6
2
1
1
0
-lo
lo
L
lo
s
s a
( )
/
=
−
+
≤
(
)
[(
)
] ;
	
(2.113)
	
δ
ε
ω
ζ
ω
ε
ζ
6
2
1 1
2
1
0
0 8
-up
U
up
n
n
up
s
s a
s
s
( )
/
/
/
=
+
+
(
) +
+
≤
=
[(
)
](
)
[
(
)
]
;
;
. ;
.
ω
ζ
n
U
a
= 1 25
	
(2.114)
Although we are free to select the models for the reference tracking specifications δ6-lo(ω) 
and δ6-up(ω), we recommend to choose them so that their difference in dBs be always posi­
tive: 20 × log10(δ6-up) – 20 × log10(δ6-lo) ≥ 0. By doing so, the tracking bounds will be plotted 
in order in the Nichols chart, starting at the top of the diagram at low frequencies, and 
TABLE 2.6
Tracking Specifications δ6-up(s). Equation 2.114. Figure 2.56. εup = 0.01
aU
Rise Time (s) from 
y(t) at 10% to y(t) at 
90% of Steady State
Settling Time (s) from 
t = 0 to y(t) at ±2% of 
Steady State
0.001
533
3230
0.01
53.3
323
0.1
5.33
32.3
1
0.533
3.23
10
0.0533
0.323
100
0.00533
0.0323
1000
0.000533
0.00323
10,000
0.0000533
0.000323
0
1
2
3
4
5
6
7
8
9
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
Rise time = 3.36 s
Settling time = 5.83 s
Settling time = 3.23 s
Rise time = 0.533 s
δ6-up
δ6-lo
FIGURE 2.56
Step 
responses 
for 
Equations 
2.113 
and 
2.114, 
with 
aL = aU = 1, 
εlo = 0.01, 
εup = 0.01. 
y(s) = [P(s)G(s)/(1 + P(s)G(s))] r(s) = δ6(s) r(s), with r(s) = 1/s.

74
Robust Control Engineering
continuing with lower and lower locations as the frequency increases. This property can 
be easily achieved using the proposed Equations 2.113 and 2.114.
Finally, we compare next the QFT bounds generated by the sensitivity and the reference 
tracking specifications. We use the expressions defined in Equation 2.111 and Equations 
2.112 through 2.114, respectively, and pick ad = aL = aU = 1, and εlo = εup = 0.01. We use again 
the simple first-order plant P(s) = k/[(s/p) + 1], with the uncertainty k∈[1, 2] and p∈[0.1, 0.2]. 
The QFT bounds for the frequencies ω = 0.2 and 1 rad/s are shown in Figure 2.58. All of 
them are solid-line bounds, meaning L0(s) must be above them to meet the specs.
As we can see, at ω = 1 rad/s the sensitivity bounds are dominant over the tracking 
bounds. However, at ω = 0.2 rad/s the tracking and sensitivity bounds intersect each other 
at several phases (–286°, –208°, –125°, and –40°). This means that the most dominant bound 
can be either the tracking or the sensitivity specification, just depending on the phase.
2.14.2  Loop Shaping—Designing G(s)
Some tips to design an effective feedback controller G(s) are proposed next. The tips are orga­
nized in a chronological list that the designer can follow, to find a feedback controller G(s) 
that meets all the stability and performance specifications represented in the QFT bounds.
	
1.	Objective. In the Nichols chart and from low frequency to high frequency, design 
the controller G(s) so that at each frequency ωi the nominal L0(jωi) = P0(jωi)G(jωi) is 
above the corresponding ωi bound if this bound is a solid line, or below if this ωi 
bound is a dashed line.
	
2.	Sign. For the gain of G(s), select a positive sign if the plant P0(s) has a positive sign. 
Select a negative sign if the plant has a negative sign. In unstable cases, this could 
be different—see examples L11, L12, and L13 in Section 3.6.3.
	
3.	Integrators. If we need a zero steady-state error for step reference inputs, or if we 
look for high disturbance rejection or demanding reference tracking specifications, 
add one (most typical) or two integrators—see Figure 2.59, from Step 0 to Step 1.
Magnitude (dB)
–80
–60
–40
–20
0
20
10–2
10–1
100
101
102
Phase (deg)
–180
–135
–90
–45
0
Bode diagram
Frequency (rad/s)
δ6-up
δ6-up
δ6-lo
δ6-lo
FIGURE 2.57
Bode diagram. Equations (2.113), (2.114), aL = aU = 1, εlo = 0.01, εup = 0.01.

75
QFT Robust Control
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–15
–10
–5
0
5
10
15
20
25
QFTCT
B(tracking, 1 rad/s)
B(sensitivity, 1 rad/s)
B(tracking, 0.2 rad/s)
B(sensitivity, 0.2 rad/s)
FIGURE 2.58
QFT bounds. Sensitivity: Equation 2.111 with ad = 1. Tracking: Equations 2.113 and 2.114 with aL = aU = 1 = 1, 
εlo = εup = 0.01. P(s) = k/[(s/p) + 1], k∈[1, 2], p∈[0.1, 0.2], ω = [0.2, 1] rad/s.
Open-loop phase (deg)
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–80
–60
–40
–20
0
20
40
60
80
100
120
QFTCT
Step 2
Step 3
Step 1
Step 0
Step 4
Step 5
FIGURE 2.59
Loop shaping. Designing G(s) of Equation 2.56, Example 2.1, in five steps: [0] original plant, [1] add an integrator, 
[2] change the gain to 1100, [3] add a zero at 55, [4] add a zero at 1700, [5] add a high-frequency pole at 25,000.

76
Robust Control Engineering
	
4.	Gain. Tune the gain k of G(s) so that L0(s) meets the lower frequency bound (or in 
some cases a very demanding bound)—see Figure 2.59, from Step 1 through Step 2.
	
gain
k
=
	
(2.115)
	
5.	Start at ω = 0, and add zeros and poles to G(s), from low frequency to high 
frequency.
	
6.	Zeros. Add a real zero z if you need to move L0(s) to the right in the Nichols chart—
see Figure 2.59, from Step 2 through Step 3, and from Step 3 through Step 4.
	
real zero
s
z
=
+






1
	
(2.116)
	
7.	Poles. Add a real pole p if you need to move L0(s) to the left in the Nichols chart—
see Figure 2.59, from Step 4 through Step 5.
	
real pole
s p
=
+
1
1
((
)
)
/
	
(2.117)
	
8.	Notch filters. Add a notch filter if you need to filter out a specific frequency ωn. The 
depth in magnitude of the filter at ωn is “20 × log10(ζ1/ζ2)” in dB.
	
notch filter
s
s
s
s
n
n
n
n
=
+
+
+
2
1
2
2
2
2
2
2
ζ ω
ω
ζ ω
ω
+
	
(2.118)
	
9.	Low-pass filter characteristic. If necessary, add high-frequency poles, as Equation 
2.117 with large p, to make sure that the order of the denominator is higher than 
the order of the numerator. In this way, (1) we attenuate the always present high-
frequency noise, and (2) we make sure that the controller is proper.
	 10.	Cancelations. Sometimes it is useful to cancel some dynamics of the plant with the 
controller. In these cases the cancelation must be in the left-half plane (LHP).
	 11.	Never do. Do not cancel any right-half plane (RHP) plant pole with a controller 
zero, or any RHP plant zero with a controller pole. These cancellations will always 
make the system unstable.
	 12.	Slope. The higher the slope of the magnitude of L0(s) = P0(s)G(s) in the Bode dia­
gram, the larger the associated phase. According to the magnitude-phase Bode 
theorem,1 a slope of L0(s) = –20n dB/decade (magnitude plot of the Bode diagram) 
denotes a phase of L0(s) = –90n degrees (phase plot of the Bode diagram), with 
n =  ± 0,1,2…. In this way, the steeper the slope of L0(s) (larger n), the bigger move­
ment of L0(s) to the right in the Nichols chart, which can eventually compromise 
the stability (the phase margin is measured at the –180° phase level). Then, a good 
analogy to remember is that the amount of phase available is like the money you have 
in your pocket. The possibilities of designing a good controller are related to the 
amount of phase of L0(s) available. Make sure you use the phase wisely, selecting 
the magnitude slopes intelligently.

77
QFT Robust Control
	 13.	For unstable systems, read Chapter 3 and follow guidelines of Table 3.2.
	 14.	For time-delay systems, read Chapter 4.
	 15.	For distributed parameter systems, read Chapter 5.
	 16.	For very high-performance specifications, read Chapters 6 and 7.
	 17.	For multi-input multi-output systems, read Chapter 8.
	 18.	For asymmetric systems, read Chapter 9.
	 19.	For controller implementation, read Chapter 10.
2.14.3  Prefilter—Designing F(s)
Finally, some tips to design a prefilter F(s) are given below. The tips are organized in a 
chronological list that the designer can follow, to find a prefilter that meets the reference 
tracking specifications.
	
1.	Objective. In the Bode diagram, and from low frequency to high frequency, design 
the prefilter F(s) so that at each frequency ωi the closed-loop functions |T(jω)F(jω)| 
of all the plants within the uncertainty are between the upper δup(ω) and lower 
δlo(ω) reference tracking specs. Note: T = PG/(1+PG).
	
2.	Gain. The gain of the prefilter F(s) equals one.
	
3.	Start at ω = 0, and add zeros and poles from low frequency to high frequency.
	
4.	Poles. Add a real pole p—see Equation 2.117, if you need to move T(s)F(s) down in 
the Bode diagram, from ω = p on—see Figure 2.60, from (a) to (b).
	
5.	Zeros. Add a real zero z—see Equation 2.116, if you need to move T(s)F(s) up in the 
Bode diagram, from ω = z on.
Magnitude (dB)
–35
–30
–25
–20
–15
–10
–5
0
QFTCT
PGF/(1 + PG)
F = 1/[(s/1100) + 1]
Frequency (rad/s)
100
101
102
103
δ6–up
δ6–lo
Frequency (rad/s)
Magnitude (dB)
–35
–30
–25
–20
–15
–10
–5
0
5
QFTCT
PG/(1 + PG)
100
101
102
103
104
δ6–up
δ6–lo
(a)
(b)
FIGURE 2.60
Prefilter design F(s), Equation 2.58, Example 2.1, in one step: (a) without prefilter and (b) adding a low-frequency 
pole at 1100.

78
Robust Control Engineering
2.15  Summary
This chapter presents the fundamentals of QFT. The basic steps of the QFT methodology 
are introduced in Sections 2.2 through 2.10 along with an illustrative example of a DC 
motor (Example 2.1). Afterward, an additional case of an airplane flight control system 
(Example 2.2) shows more details of the methodology. Finally, Sections 2.11 through 2.14 
complete the chapter with model-matching control systems, feedforward control strate­
gies, PID design and tuning, and practical control design tips.
2.16  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Example 2.1. Sections 2.3 through 2.10. Armature-controlled DC motor.
•	 Example 2.1. Section 2.13. PID control. Armature-controlled DC motor.
•	 Example 2.2. Feedback solution. Airplane flight control.
•	 Example 2.2. Section 2.11. Model matching. Airplane flight control.
•	 Example 2.2. Section 2.12. Feedforward/feedback. Airplane flight control.
•	 Appendix 2. QFT Control Toolbox (QFTCT) User’s guide.
•	 Case study CS1. Satellite with flexible appendages. Attitude control.
•	 Case study CS2. Wind turbine pitch control.
•	 Project P1. Appendix 1. Vehicle with active suspension system.
•	 Project P2. Appendix 1. DVD-disk head control system.
•	 Project P8. Appendix 1. Satellite with tanks partially filled.
•	 Problem Q2. Appendix 1. Control of first-order system with uncertainty.
•	 Problem Q3. Appendix 1. Control of third-order state space system.
•	 Problem Q4. Appendix 1. Field-controlled DC motor.
•	 Problem Q5. Appendix 1. Formation flying spacecraft control. Deep space.
•	 Problem Q6. Appendix 1. Helicopter control.
•	 Problem Q7. Appendix 1. Two cart problem.

79
3
Unstable Systems and Control Solutions
3.1  Introduction
The understanding of feedback control principles and the ability to implement them in 
real-world applications are among the main achievements of engineers in the last century. 
Moreover, the success of engineers controlling unstable plants that can hardly be oper­
ated manually opened the door to new opportunities. This was particularly important in 
the development of aviation. In fact, the world’s first successful heavier-than-air powered 
airplane was intrinsically unstable. It was invented, built, tested, and controlled by the 
Wright brothers—see Figure 3.1.
The Wright brothers, Wilbur (1867−1912) and Orville (1871−1948), developed extraor­
dinary mechanical skills while working in their bicycle shop in Dayton, Ohio. Among 
others projects, they designed new bicycles following H.J Lawson’s original ideas for the 
so-called “safety bicycle.”357 Their work with these new bicycles influenced their conviction 
that an unstable flying machine, like an unstable bicycle, could be successfully controlled 
in practice.
The first flying machines designed by the brothers were simple gliders, without an 
engine, to understand what they defined as “the problem of equilibrium.” They also devoted 
months to studying the art of flight from birds. The brothers carefully watched the move­
ments of giant gannets, large vultures, buzzards, eagles, and small hawks in the wind. 
They were fascinated of how these birds smoothly modify the shape of the wings to use 
the wind to sail aloft, turn, rise, fall, and control the equilibrium under strong and light 
winds.
Based on these studies and experiments, the Wrights designed all kind of curved 
wings and tested them in a small-scale wind tunnel they built at home. They pursued 
a double objective: a flying machine able to react quickly enough to wind disturbances 
(high maneuverability), and a mechanism with sufficient control authority to regulate the 
machine under different wind conditions (controllability).
The brothers designed their first successful aircraft in 1903 (Figure 3.1).357 The flying 
machine was open-loop unstable to increase the maneuverability. It included a small 
biplane wing system forward the main wings, locating its center of pressure (c.p. or lift 
force point of application) ahead of its center of gravity (c.g. or gravity force point of 
application). Nowadays, we called this aerodynamic condition static instability. Canard 
airplanes and the X-29 forward swept wing airplane are other examples that follow this 
principle to increase their maneuverability and reduce the weight (tail not needed). Using 
this design, the Wright brothers made the world’s first heavier-than-air, powered, and con­
trolled human flight ever, on December 17, 1903 at Kitty Hawk, North Carolina (Figure 3.1).

80
Robust Control Engineering
It is important to mention that the Wright brothers’ fundamental breakthrough, 
also described in their first U.S. patent (US-821,393), was not the invention of a fly­
ing machine, but rather, the invention of a control system able to manipulate the fly­
ing machine’s surfaces and stabilize the unstable aircraft. The control system included 
three independent mechanisms: (1) an original wing-warping system for roll or lateral 
motion control, composed of pulleys and cables that twist the trailing edges of the 
wings in opposite directions; (2) a forward elevator for pitch or up-and-down control; and 
(3) a rear rudder for yaw or side-to-side control. These great achievements opened the 
door to human flight.
Other well-known examples of unstable systems include space rockets, inverted pen­
dulums, motorcycles and bicycles, fluid instabilities, chemical and thermal instabilities, 
and many more. In all these cases, a careful analysis is required. This fact was very-well 
understood by Gunter Stein, the first recipient of the Hendrik W. Bode Lecture Award of 
the IEEE Control System Society (CDC, Tampa, Florida, December 1989). In his lecture, 
Stein highlighted Bode’s critical observation that there are fundamental limitations on 
the performance of control systems, and that these limitations can be described by some 
simple integral expressions (see Bode’s original book, 1945,1 and Horowitz’s book, 1963,2). 
In 2003, the IEEE Control System Magazine published a paper remembering the main dis­
cussions of the Stein’s original Bode award lecture, including also the unstable charac­
teristics of the Chernobyl nuclear power plant accident (1986) and of the SAAB Gripen 
JAS-39 airplane accident (1989).355 This paper emphasizes three basic aspects of unstable 
systems:
•	 Unstable systems are fundamentally more difficult to control than stable ones
•	 Controllers for unstable systems are operationally critical
•	 Closed-loop systems with unstable components are only locally stable
The expressions introduced by Bode1 state that the natural logarithm of the magnitude 
of the sensitivity function S(jω) of a SISO feedback system, integrated over frequency, is 
constant. This constant is zero for stable systems, and positive for unstable and/or non-
minimum phase (nmp) systems.
In practical applications, the infinite upper limit of the integrals defined by Bode is 
reduced to the available bandwidth Ωa, as shown in Equations 3.1 and 3.2,355
FIGURE 3.1
Wright brothers’ unstable airplane. December 17, 1903: the World’s first heavier-than-air, powered, and con­
trolled human flight (U.S. Library of Congress).

81
Unstable Systems and Control Solutions
	
ln (
)
S j
d
a
ω
ω
0
0
Ω
∫
=
for stable systems
	
(3.1)
	
ln (
)
Re(
)
Re(
)
S j
d
p
z
nmp
a
p
z
i
i
N
j
j
N
ω
ω
π
π
0
1
1
Ω
∫
∑
∑
=
+
=
=
for unstable
systems
	
(3.2)
where S(jω) = 1/[1 + P(jω)G(jω)] is the sensitivity function and pi and zj are the location of 
the Np poles and Nz zeros of P(jω)G(jω) in the right half plane (RHP).
The available bandwidth Ωa depends on the control system technology, that is, the micro­
processor, sampling rate, sensor and actuator bandwidths, hardware, etc.
The interpretation of these integrals is quite straightforward. If the controller G(jω) 
reduces the sensitivity function (ln |S(jω)| negative) at low frequencies for a much better 
disturbance rejection—according to y(s) = S(s)M(s)d(s) and Figure 3.2, then the sensitivity 
must increase at high frequencies (ln |S(jω)| positive) to meet the Bode integral’s require­
ments: the so-called waterbed effect. This fact deteriorates the disturbance rejection of the 
control system at high frequencies. Figure 3.3a shows a typical sensitivity function S(jω), 
+
u(s)
P(s)
+
–
e(s)
G(s)
y(s)
+
+
n(s)
+
r(s)
d(s)
F(s)
M(s)
(1)
(2)
FIGURE 3.2
Closed-loop control system.
10–1
100
101
Magnitude (dB)
–40
–30
–20
–10
0
10
20
Bode diagram
Frequency (rad/s)
+
−
–360 –315 –270 –225 –180 –135 –90
–45
0
–80
–60
–40
–20
0
20
40
60
Nichols chart
Open-loop phase (deg)
Open-loop gain (dB)
GM
PM
L(jw)
wg
wp
FIGURE 3.3
(a) Bode diagram of a sensitivity function: S(jω) = 1/[1 + P(jω)G(jω)]. (b) Nichols chart of L(jω), GM and ωp, PM 
and ωg.

82
Robust Control Engineering
with values under 0 dB (magnitude <1) at low frequency, and above 0 dB (magnitude >1) 
at high frequency.
These intrinsic performance limitations are much more restrictive for unstable and/or 
non-minimum phase (nmp) systems than for stable systems, as the constant of the right 
term of the Bode’s integral expressions is positive for the unstable or nmp systems and zero 
for the stable ones.
Intuitively, to stabilize a system, we need approximately ωg > 2pi and ωg < zj/2, pi and zj 
being the location of the poles and zeros of L(jω) = P(jω)G(jω) in the RHP respectively, and 
ωg the gain crossover frequency, which is the frequency where the magnitude of L(jω) is 1 
(0 dB), and being ωg < Ωa.260,354
3.2  Understanding Gain and Phase Margins, and Ws Circles
The gain margin (GM), phase margin (PM), and the related Ws circle are classical fre­
quency-domain tools used to describe and quantify the stability of a closed-loop system—
see Figure 3.3b. They are typically defined as control specifications or objectives to design 
controllers to regulate dynamic systems. Their mathematical description and practical 
application are part of the classical books on fundamentals of automatic control: see for 
instance References 259, 262, and 263.
In this section, we first discuss an intuitive understanding of these frequency-domain 
stability margins. Consider the closed-loop control system presented in Figure 3.2 and 
assume without loss of generality that the input signals are zero: r = d = n = 0. Now, to 
understand the concept of stability of a feedback system, let us introduce a periodic signal 
x(t) = A sin(ωp t) at point (1), with a special frequency ωp, which is the one at which all the 
blocks from point (1) to point (2) combined add up a phase shift of −180° to the signal x(t).
In this situation, as this periodic signal x(t) with frequency ωp travels the closed loop, it 
changes its phase: first adding −180° from point (1) to point (2), and then another −180° 
from point (2) to point (1) due to the negative sign of the summer, adding up a total of 
−360° = 0°. Also, the blocks from point (1) to point (2) combined multiply the original 
magnitude A by a factor K, being B = K A, with K = K(ωp). This means that after clos­
ing the loop, that is, from point (1) to point (1) back, the original signal x(t) is modified to 
xafterLoop(t) = B sin(ωp t), which has the same original phase and an amplitude B.
In this way, as xafterLoop(t) has the same phase as the original signal x(t), the condition for 
stability is to have an amplitude B < A, which means a gain K(ωp) < 1, or < 0 dB. In this 
case, the signal x(t) reduces the magnitude at every loop trip, approaching zero as it travels 
infinite times through the loop. On the contrary, if K(ωp) > 1, or > 0 dB, the signal x(t) will 
grow unbounded, which means instability.
This is the physical interpretation for the GM condition for stability. It requires for the 
magnitude K given by all the blocks from point (1) to (1) at the frequency ωp to be K(ωp) < 
0 dB. Thus, the GM is defined as 1/K(ωp), which is the maximum factor given by all the 
blocks from point (1) to (2) combined while still keeping the system stable, and being ωp 
the phase crossover frequency, for whom the blocks from point (1) to (2) add up a phase of 
−180°, see Figure 3.3b.
A similar interpretation for the PM is possible. In this case, the frequency of study ωg 
is the one where the blocks from point (1) to point (2) combined add up a gain K = 1. At 
this frequency ωg, also called the gain crossover frequency, we study the phase φ added 

83
Unstable Systems and Control Solutions
by the loop, point (1) to point (1) back, which has to be −180° > φ11 = (φ12 − 180°) ≥ −360°, 
or 0° > φ12 ≥ −180° for stability. This means that after traveling the loop once, the signal 
x(t) = A sin(ωg t) introduced at point (1) will be xafterLoop(t) = A sin(ωg t + φ11), with −π rad > 
φ11 ≥ −2π rad. In other words, after traveling the loop once, the system is stable if the signal 
x(t) has the same original phase (φ11 = −2π rad = 0) or lags behind by an angle less than 2π 
rad or 360° (or less than π rad or 180° for φ12, from point 1 to point 2). In this way, the PM is 
defined as the maximum phase lag given by all the blocks from point (1) to (2) combined 
while still keeping the system stable, see Figure 3.3b.
Putting together the GM (dB) and PM (degrees) in the Nichols Chart (NC), we can define 
a Ws circle around the origin (0 dB, −180°) that (1) takes into account the most demanding 
value of the given GM and PM, and (2) defines a constant magnitude locus for the closed-
loop transfer function—see details in Chapter 2, Section 2.5.
Based on these concepts of PMs and GMs, Chapter 2 developed the U-contour or QFT 
stability bound in the NC, to describe the stability of a closed-loop system for plants with 
model uncertainty. As discussed, the condition for a stable closed-loop system is to have 
an open-loop transfer function L(s) = P(s)G(s) that goes outside and on the right of the QFT 
stability bound in the NC, that is, GM below the 0 dB axis and PM right to the −180° axis, 
as in Figure 3.3b.
We can find, however, some special cases where this condition is not enough to assure 
the stability. Let us consider for instance a simple, unstable, and first-order plant P(s) = 8/
(−0.333 s + 1). Figure 3.4a shows the NC of the open-loop transfer function L(s) = P(s)G01(s) 
without any controller (or G01(s) = 1). The QFT stability bound for Ws = 1.45 (or GM = 4.56 dB, 
PM = 40.34°) for all the frequencies is also shown in the figure. This case is unstable, as 
expected according to the stability margins (GM = ∞, PM = −97.18°) and QFT ­stability bound.
In order to stabilize the closed-loop system, we move the open-loop transfer function 
L(s) to the right and outside of the QFT stability bound by adding the controller G02(s) = 1/
[s (0.25 s + 1) (0.1 s + 1)]. Figure 3.4b shows the new L(s) = P(s)G02(s) and the original QFT 
stability bound. Contrary to the first interpretation with the stability margins (GM = ∞ 
and PM = 78.45° means stable system) and the QFT stability bound (L at the right and 
outside the stability bound means stable system), the closed-loop system with L(s) repre­
sented at Figure 3.4b is still unstable. To prove it, we plot the root locus and the position 
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100 –50
0
Open-loop gain (dB)
–40
–30
–20
–10
0
10
20
QFTCT
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
Open-loop gain (dB)
–100
–80
–60
–40
–20
0
20
40
60
80
QFTCT
(a)
(b)
FIGURE 3.4
NC: (a) L(s) = P(s)G01(s), (b) L(s) = P(s)G02(s). In both cases, the QFT stability bound is at Ws = 1.45.

84
Robust Control Engineering
of the roots of the closed-loop system (rectangle marks) in Figure 3.5a. As we can see, 
there is a root at s = +4 (at the RHP), which means that the closed-loop system is unstable. 
Also, the output signal y(t) of the close-loop system under a unitary step input r(s) = 1/s, 
y(s) = [L(s)/(1+ L(s))] r(s), is totally unbounded, as shown in Figure 3.5b.
In summary, this simple example shows a quite counterintuitive conclusion: the classical 
GMs and PMs and the subsequent stability analysis based on the Ws circles do not work 
properly in some special cases.
As a result, we need additional frequency-domain tools for a more reliable analysis of 
the stability of closed-loop systems. One unfailing frequency-domain tool for determin­
ing the stability of a dynamical system with feedback is the well-known Nyquist stability 
criterion (NSC).
Nevertheless, the NSC performs the stability analysis in the complex s-plane, and not in 
the NC. Also, sometimes it needs to calculate points at the infinite, which can be very com­
plicated. To overcome these difficulties and allow the designer to use the NSC along with the 
QFT technique, Section 3.4 of this chapter presents a practical and comprehensive method to 
compute the NSC directly in the NC, and Section 3.5 shows a collection of examples.
In addition, and based on this proposed method, Section 3.6 gives guidelines to design 
controllers to stabilize unstable plants when dealing with frequency-domain techniques 
and QFT. Finally, Section 3.7 expands the example presented in this introduction, includ­
ing both the stability analysis with the technique presented in Section 3.4 and the design 
of appropriate controllers in the NC.
3.3  The NSC125
The Nyquist stability criterion was introduced by the Swedish-American electrical engineer 
Harry Nyquist at Bell Telephone Laboratories in 1932. It is a graphical technique for deter­
mining absolute stability of a dynamical system with feedback. It is based on the Cauchy’s 
Real axis
–10 –8
–6
–4
–2
0
2
4
6
Imag axis
–3
–4
–2
–1
0
1
2
3
4
Time (s)
0
2
4
6
8
10
12
14
y
×1026
–25
–20
–15
–10
–5
0
5
(a)
(b)
FIGURE 3.5
L(s) = P(s)G02(s). (a) Root locus and (b) output y(t) of the close-loop system under a unitary step input 
r(t)—Figure 3.2.

85
Unstable Systems and Control Solutions
argument principle and is calculated in the complex s-plane. The Nyquist criterion appears 
in most modern textbooks on control theory (see for instance Reference 259). It is especially 
useful for determining the stability of linear time invariant (LTI) closed-loop systems when 
the open-loop L(s) is given. It works well in any LTI case, even in the so-called conditionally 
stable systems, where the classical GM and PM analysis does not work properly. Consider 
the closed-loop feedback system shown in Figure 3.2 and its closed-loop transfer functions 
(complementary sensitivity, sensitivity, and noise transfer functions) given by
	
y s
P s G s F s
P s G s r s
M s
P s G s d s
P s G s
( )
( ) ( ) ( )
( ) ( ) ( )
( )
( ) ( ) ( )
( ) (
=
+
+
+
−
1
1
)
( ) ( ) ( )
1+ P s G s n s
	
(3.3)
with the characteristic equation
	
1
1
0
+
= +
=
P s G s
L s
( ) ( )
( )
	
(3.4)
The NSC defines a path Γc that clockwise encircles the complete area of the RHP, sur­
rounding but not passing through any zero or pole of L(s). The stability of the closed-loop 
system is determined by investigating how the path Γc is mapped by the open-loop func­
tion L(s) in the complex plane (see Figure 3.6). The principle of the argument states that the 
number of encirclements N in the positive direction (clockwise) around the complex point 
(−1,0) by the map of Γc, and for the frequency range (−∞ ≤ ω ≤ +∞), equals N = zc − p, 
where p is the number of poles of L(s) in the RHP and zc the number of zeros (roots) of the 
characteristic equation—Equation 3.4—in the RHP.
The closed-loop system is stable if and only if there are not zero-pole cancelations in the 
RHP and there are no roots of the characteristic equation—Equation 3.4—in the RHP, that is to 
say: zc = N + p = 0. This general condition can be reformulated with the following two rules:
•	 A feedback control system is stable if and only if the Nyquist contour Γc, when 
mapped in the L(s)-plane, does not encircle the (−1,0) point (N = 0) and the number 
of poles of L(s) in the RHP is zero (p = 0).
–6
–4
–2
0
2
4
6
8
–10
–8
–6
–4
–2
0
2
4
6
8
10
Real axis
Imaginary axis
 –1
 –1
–1
(–1,0)
Nyquist
contour
Im
Radius
Re
L(s)
s-plane
r →∞
Γc
FIGURE 3.6
NSC in the complex s-plane. Frequency range: −∞ ≤ ω ≤ +∞. Example N = −3. (Adapted from Garcia-Sanz, M. 
2016. Int. J. Robust Nonlinear Control, 26(12), 2643–2651.)

86
Robust Control Engineering
•	 A feedback control system is stable if and only if, for the Nyquist contour Γc when 
mapped in the L(s)-plane, the number of anticlockwise encirclements of the (−1,0) 
critical point (N) equals the number of poles of L(s) with positive real parts (p).
In both cases, the system is stable if zc = N + p = 0. An easy way to determine the num­
ber of encirclements N is to draw a straight line out from the point −1 + j0 in any direction 
and count the net number of crossings of the map of Γc (−∞ ≤ ω ≤ +∞), with clockwise 
(decreasing phase) crossings being positive and counterclockwise crossings (increasing 
phase) negative, see Figure 3.6b.
Due to the convenience of utilizing Bode diagrams and NCs in the design of control sys­
tems in the frequency domain, several authors introduced some approximations to apply 
the NSC in nonpolar diagrams.164,339,348,356 However, as Belanger states in his book,356 “it is 
sometimes tricky to count encirclements, especially if only the positive-frequency half of the Nyquist 
plot is given, as is the case with most software packages.” He proposes a procedure with mul­
tiple rules to count the encirclements. The method is given more ample justification in a 
previous paper by Vidyasagar et al.,348 who also presents a technique to count the encircle­
ments. However, both studies are just a short note to illustrate some common cases, but 
are not a comprehensive technique or a straightforward method to apply. They leave many 
open questions to the designer, especially in cases with poles with higher multiplicity, or 
poles or zeros at the origin, or multiple non-minimum phase zeros.
3.4  Nyquist Stability Criterion in the Nichols Chart125
This section presents the practical method introduced by the author in 2016 to study the 
stability of feedback systems with the Nyquist stability criterion in the Nichols chart.125 
The method can be applied to LTI closed-loop systems with any multiplicity of minimum 
and non-minimum phase zeros, stable and unstable poles, and poles at the origin, and to 
systems defined by nonrational functions, such as plants with time delays. The algorithm 
is included in the QFTCT, (click Controller design window, File menu, Check stability option). 
The MATLAB code for the algorithm can be also found in Appendix 3 and free-down­
loaded from the website:
http://cesc.case.edu/Stability_Nyquist_GarciaSanz.htm
The original rules of the NSC can be reformulated for the Nichols diagram as follows.125 
A feedback control system is stable if and only if:
•	 Rule 1: There are not zero-pole cancelations in the RHP.
•	 Rule 2: The number of poles p of the open-loop transfer function L(s) in the RHP 
plus the number of encirclements N equals zero. That is to say, the number of zeros 
zc of the characteristic equation is zero: zc = N + p = 0.
To count the number of encirclements N directly in the NC the following technique is 
proposed. It divides the problem in four cases (Na through Nd) according to Equation 3.5 
and Figure 3.7.
	
N
N
N
N
N
a
b
c
d
=
+
+
+
 
	
(3.5)

87
Unstable Systems and Control Solutions
To compute each case in the Nichols diagram, count the net number of crossings of the 
ray R0 = {(φ,r): φ  = −180(2k + 1)°, r > 0 dB, k = 0, ±1, ±2,…}, with the left direction (decreas­
ing phase) being positive, and right direction (increasing phase) being negative. That is,
	
1.	Compute Na. Figure 3.7a. If L(jω) crosses the ray R0 = {(φ,r): φ  = −180°, r > 0 dB} at 
ω = ωx, 0 < ωx < +∞, being |L(jωx)| finite, then Na = ±2 (sign according to para­
graph above). For the multiple-sheeted Nichols plot, every crossing of the rays 
R0 = {(φ,r): φ = −180(2k + 1)°, r > 0 dB, k = 0, ±1, ±2,…} with |L(jω)| finite adds ±2 
to Na (sign according to paragraph above). If there are no crossings, Na = 0.
	
2.	Compute Nb. Figure 3.7b. If |L(jω0)| is finite, ω = ω0 = 0 rad/s, and lies on R0 = {(φ,r): 
φ = −180(2k + 1)°, r > 0 dB, k = 0, ±1, ±2,…}, then Nb = ±1 (sign according to para­
graph above). Otherwise Nb = 0.
	
3.	Compute Nc. Figure 3.7c. If |L(jω∞)| is finite, ω = ω∞ = +∞ rad/s, and lies on 
R0 = {(φ,r): φ = −180(2k + 1)°, r > 0 dB, k = 0, ±1, ±2,…}, then Nc = ±1 (sign accord­
ing to paragraph above). Otherwise Nc = 0.
	
4.	Compute Nd. Figure 3.7d. If |L(jω0)| is infinite, ω = ω0 = 0 rad/s, then
	
N
k
d = +
+
+
+
2(
1)
σ
αγ 	
(3.6)
	
	 On the contrary, if |L(jω0)| is finite, ω = ω0 = 0 rad/s, then Nd = 0. The parameters 
k, σ, α and γ are calculated as follows:
•	 Parameter k. It depends on the phase φ(L(ω1)), being ω1 the first frequency where 
φ(L(ω1)) ≠ φ(L(ω0)), and the variable δ, which is
	
δ
φ
ω
φ
ω
=
−
sign[
]
(
)
(
)
L
L
(
)
(
)
0
1
	
(3.7)
	
and which takes the value δ = +1 if the sign is positive, that is if L(jω) goes ini­
tially to the left in the NC, or δ = −1 if the sign is negative, that is if L(jω) goes 
initially to the right.
+2 
dB 
(a)
–2 
+1
–1
0 dB 
dB 
–180(2k + 1)°
k = 1
Crossing at ω = ωx, 0 < ωx < +∞
|L(jωx)| > 0 dB, ﬁnite at crossing
Add Na = ±2 at each –180(2k + 1)°
k = 0
k = –1 k = –1
k = –1
k = –2
k =
–1,0
–90
+90
0 dB 
–540 
0 dB 
dB 
–180(2k + 1)°
(b) 
Crossing at ω = ω0 = 0
|L(jω0)| > 0 dB, ﬁnite at crossing
Add Nb = ±1
|L(jω0)| inﬁnite at ω = ω0 = 0
–180(2k + 1)°
Crossing at ω = ω∞ = +∞
|L(jω∞)| > 0 dB, ﬁnite at crossing
Add Nc = ±1
(d) 
–180
0
+180
+540
if |L(jω0)| is ﬁnite, ω =
ω0 = 0 rad/s, then Nd = 0.
Add Na = +(2k + 1) + σ + α γ
φ
φ
φ
–1
+1
0 dB 
dB 
(c) 
φ
FIGURE 3.7
Rules to count the number of encirclements N in the NC: N = Na + Nb + Nc + Nd.

88
Robust Control Engineering
	
	
The parameter k can take the following values:
	
1.	 if
L
k
−
° <
< +
° →
= −
180
90
1
1
φ
ω
(
)
(
)

(3.8)
	
2.	 if
L
k
+
° <
< +
°
= −→
= −
90
180
1
1
1
φ
ω
δ
(
)
(
)
and

(3.9)
	
3.	 if
L
k
+
° <
< +
°
= + →
=
90
180
1
0
1
φ
ω
δ
(
)
(
)
and

(3.10)
	
4.	 if
L
k
L
φ
ω
φ
ω
(
)
(
)
(
)
(
(
)
)
1
1
180
180
360
≤−
° →
= −
+






ceil

(3.11)
	
5.	 if
L
k
L
φ
ω
φ
ω
(
)
(
)
(
)
(
(
)
)
1
1
180
180
360
≥+
° →
= −
−






ceil

(3.12)
	
ceil(x) being a function that rounds the elements of x to the nearest integers 
toward infinity. k can take the values […−2, −1, 0, +1, +2, …] depending on the 
phase at ω0 and ω1.
•	 Parameter σ. It describes the sign of the gain of the open-loop transfer function.
	
There are two cases:
	
1.	 if
LN
dcgain(
)
positive
≥
→
=
0
0
(
)
σ

(3.13)
	
2.	 if
LN
dcgain
negative
(
)
(
)
<
→
=
0
1
σ

(3.14)
	
	 LN(jω) being the open-loop L(jω) without poles at the origin. dcgain(LN) = 
LN(ω0), ω0 = 0 rad/s.
•	 Parameter α. It depends on the phase φ(L(ω0)), the variable δ and the number of 
poles nP0 at the origin. There are five cases:
	
1.	
if
L
L
nP
φ
ω
δ
α
φ
ω
( (
))
( ( (
))
)
0
0
0
1
90
0
360
≤°
= +
→
=−
+
×






 and 
ceil


(3.15)
	
2.	
if
L
L
nP
φ
ω
δ
α
φ
ω
( (
))
( ( (
))
(
))
0
0
0
1
90
0
2
360
≤°
=−
→
=−
+
×
−



 and 
ceil




(3.16)
	
3.	
if
L
L
nP
φ
ω
δ
α
φ
ω
( (
))
( ( (
))
(
))
0
0
0
1
90
0
2
360
> °
= +
→
=
+
×
−



 and 
floor




(3.17)
	
4.	
if
L
L
nP
φ
ω
δ
α
φ
ω
( (
))
(
)
0
0
0
1
90
0
360
> °
=−
→
=−
−
×
(
)




 and 
floor
(
)



(3.18)
	
5.	
if
L
L
L
order num
order den
or
 and 
(
. )
(
. )
( (
))
=
=
°
°
→
=
∞
φ
ω
α
180
0
0

(3.19)
	
floor(x) being a function that rounds the elements of x to the nearest integers 
toward minus infinity. α can take the values [0, +1, +2, …], depending on the 
phase at ω0, ω1, and ω∞ and the number of poles at the origin nP0.

89
Unstable Systems and Control Solutions
•	 Parameter γ. It is a function of the number of LHP and RHP zeros and poles of 
L(s).
	
γ =
+
−
−
+
−
−
2
1
|
|,
(
)
nZR
nPL
nZL
nPR
nZR
nPL
nZL
nPR
max(
) 	
(3.20)
	
where nZR is the number of zeros of L(s) in the RHP, nZL is the number of 
zeros of L(s) in the LHP, nPR is the number of poles of L(s) in the RHP, and nPL 
is the number of poles of L(s) in the LHP. The poles or zeros at the origin do 
not count in this parameter. γ can take the values [−2, 0, +2], depending on the 
type and number of poles and zeros.
The above rules can be easily written in a simple algorithm to compute the number of 
encirclements N for the NSC. The method has been included in the QFTCT for MATLAB—
see Appendix 2 and Reference 175, and the MATLAB code of the algorithm in Appendix 3. 
Also, the method can be applied to the Bode diagram rather than the NC. The details are 
left to the reader.
3.5  Examples125
The following examples illustrate how to apply the NSC in the NC using the technique 
proposed in Section 3.4. The examples include a variety of transfer functions that deal 
with positive and negative gains, a combination of minimum and non-minimum phase 
zeros, stable and unstable poles and integrators with diverse multiplicity and time-delay. 
As usual, the open-loop transfer function Lj(s) expresses the multiplication of the plant Pj(s) 
and the controller Gj(s), so that Lj(s) = Pj(s)Gj(s), j = 1, 2, …, 15.
	
P s
s
s
s
s
s
s
1
5
140
0 5
1
0 5714
1
0 6
1
3 5
1
5
1
( )
(
.
)(
.
)(
.
)(
.
)
(
)
;
=
−
+
−
+
−
+
−
+
−
+
G s
1
1
( ) =
	
(3.21)
	
P s
s
s
s
s
s
s
2
1000
0 5
1
0 5714
1
5
1 0 5
1 0 33
1 0
( )
(
.
)(
.
)
(
)( .
)( .
)( .
=
−
+
−
+
+
+
+
25
1
1
2
s
G s
+
=
) ;
( )
	
(3.22)
	
P s
s
s
s
s
G s
3
3
2
0 5
1 0 33
1
1
5
1
1
( )
(
.
)( .
)
(
)(
)
;
( )
= −−
+
+
+
−
+
=
	
(3.23)
	
P s
s
s
s
s
G s
4
4
0 25
1 10
1
0 5
1 0 5
1
1
( )
.
(
)(
)
(
.
)( .
) ;
( )
= −
−+
+
−
+
+
=
	
(3.24)
	
P s
s
s
G s
5
4
5
1
5
1
1
( )
(
) ;
( )
=
−
−
+
=
	
(3.25)
	
P s
s
s
s
s
G s
6
2
6
12
0 5
1 0 33
1
5
1
1
( )
(
.
)( .
)
(
)
;
( )
=
−
+
+
+
=
	
(3.26)

90
Robust Control Engineering
	
P s
s
s
s
s
s
G s
7
3
7
70
0 5
1
0 5714
1
0 6
1
5
1
1
( )
(
.
)(
.
)(
.
)
(
)
;
( )
=
−
+
−
+
−
+
−
+
=
	
(3.27)
	
P s
s
s
s
s
s
s
8
3
5
1
0 5
1
0 5714
1
0 6
1
3 5
( )
(
.
)(
.
)(
.
)(
.
=
−
+
−
+
−
+
−
+
−
+
0.0071(
)
1
1
8
) ;
( )
G s =
	
(3.28)
P s
s
s
s
s
s
s
9
3
6
3
10
0 5
1
0 5714
1
0 6
1
3 5
1
5
1
( )
(
.
)(
.
)(
.
)(
.
)
(
=
×
−
+
−
+
−
+
−
+
−
+ )
exp(
.
);
( )
−
=
0 8
1
9
s
G s
	
(3.29)
The first two examples (L1 and L2) are associated with case Na (Figure 3.7a). The third 
example (L3) is related to case Nb (Figure 3.7b) and the fourth example (L4) to case Nc 
(Figure 3.7c). Examples fifth to eight (L5−L8) deal with different options of case Nd (Figure 
3.7d) and the parameters k, σ, α, and γ. The ninth example (L9) is a non-minimum phase 
unstable system with time-delay, which involves Na and Nd. Table 3.1 and Figure 3.8 show 
the results of the nine examples.
–720–630–540–450–360–270–180 –90
0
90
180 270
–100
–50
0
50
100
150
Nichols chart. L1(––), L5(.–), L7(–), L8(–+), L9(:)
Open-loop phase (deg)
Open-loop gain (dB)
L5(s)
L8(s)
L9(s)
L7(s)
L1(s)
–270
–180
–90
0
90
180
270
–60
–40
–20
0
20
40
60
80
100
120
140
Nichols chart. L2(––), L3(:), L4(–), L6(.–)
Open-loop phase (deg)
Open-loop gain (dB)
L2(s)
L6(s)
L4(s)
L3(s)
FIGURE 3.8
NCs: Lj(s) = Pj(s)Gj(s), j = 1, 2,…9. (Adapted from Garcia-Sanz, M. 2016. Int. J. Robust Nonlinear Control, 26(12), 
2643–2651.)
TABLE 3.1
Results: Lj(s) = Pj(s)Gj(s), j = 1, 2,…9. Gj(s) = 1
Case
Na
Nb
Nc
Nd
k
σ
α
γ
N
P
zc
Stab
L1
+2
0
0
+2
−1
0
+1
+2
+4
+1
+5
U
L2
+4
0
0
0
−1
0
0
+2
+4
0
+4
U
L3
0
−1
0
0
−
−
−
−
−1
+1
0
S
L4
0
0
−1
0
−
−
−
−
−1
+1
0
S
L5
0
0
0
+1
0
+1
+1
−2
+1
+1
+2
U
L6
0
0
0
+2
0
0
0
+2
+2
0
+2
U
L7
0
0
0
+2
−1
0
+1
+2
+2
+1
+3
U
L8
0
0
0
+2
+1
0
+1
−2
+2
+4
+6
U
L9
+2
0
0
+4
0
0
+1
+2
+6
+1
+7
U
Source:	 Garcia-Sanz, M. 2016. Int. J. Robust Nonlinear Control, 26(12), 2643–2651.

91
Unstable Systems and Control Solutions
3.6  Guidelines to Design Controllers125
Based on the method proposed in Section 3.4, this new section introduces a collection of 
guidelines to design controllers to stabilize unstable plants. The guidelines are shown in 
Table 3.2. They are particularly useful for frequency-domain control design techniques, 
and specifically for the QFT robust control methodology.
As presented in Section 3.4, we need a number of counterclockwise encirclements, that 
is a negative N, to stabilize a system with a number of unstable poles in L(s), that is p > 0. 
In other words, we need N = −p.
If p is an even number, a simple way to stabilize the plant is to design a controller accord­
ing to the first case: Na (Figure 3.7a). A negative and even Na number can be produced by 
making L(jω) to cross the rays R0 = {(φ,r): φ  = −180(2k + 1)°, r > 0 dB, k = 0, ±1, ±2,…} at a 
finite magnitude, at a frequency ωx, 0 < ωx < +∞, and in the right direction. See case a1 in 
Table 3.2.
If p is an odd number, two simple ways to stabilize the plant are to design controllers 
according to the second or third cases: Nb (Figure 3.7b) or Nc (Figure 3.7c). A negative and 
odd Nb number can be produced by making L(jω) at the frequency ω = ω0 = 0 rad/s to start 
at the ray R0 = {(φ,r): φ  = −180(2k + 1)°, r > 0 dB, k = 0, ±1, ±2,…} in the right direction. 
See case b1 in Table 3.2. Also, a negative and odd Nc number can be produced by making 
L(jω) at the frequency ω = ω∞ = +∞ rad/s to end at the ray R0 = {(φ,r): φ  = −180(2k + 1)°, 
r > 0 dB, k = 0, ±1, ±2,…} in the right direction. See case b2 in Table 3.2. Other possibilities 
for p odd are also explained in Table 3.2 (see cases b3−b6) and illustrated in the following 
examples.
In addition, two useful properties to design controllers to stabilize unstable plants are 
presented next: the parity interlacing property (p.i.p.) and the fundamental theorem of feedback 
control.
3.6.1  Parity Interlacing Property
A controller G(s) that stabilizes an unstable plant P(s) can be itself stable (with no RHP 
poles) or unstable (with RHP poles).254 This characteristic is defined by the p.i.p., which says 
that “a necessary and sufficient condition for the existence of a stable stabilizing compensator G(s) 
TABLE 3.2
Guidelines to Design a Controller G(s) to Stabilize an Unstable Plant
N = Na + Nb + Nc + Nd  = - p  ⇒  zc = N + p = 0
Na
Nb
Nc
Nd
Case (a): p even
+2,+4,+6…
a1
−2,−4,−6…
–
–
–
Case (b): p odd
even part (0,+2,+4…)
b0
for the even part use Na as in case a1
odd part (+1)
b1
−
−1
−
−
b2
−
−
−1
−
b3
−2
−
−
+1 (σ = 1)
b4
−2
+1
−
−
b5
−2
−
+1
−
b6
add an unstable pole ⇒ p even ⇒ case a1
Source:	 Garcia-Sanz, M. 2016. Int. J. Robust Nonlinear Control, 26(12), 2643–2651.

92
Robust Control Engineering
is that between each zero of the plant P(s) on the non-negative real axis (including infinity as a zero) 
of the s-domain, there be an even number of poles,” see Figure 3.9.
The p.i.p. condition is a necessary and sufficient condition for the existence of a stable sta­
bilizing compensator G(s). That is a useful condition to find controllers to stabilize unsta­
ble plants P(s) with non-minimum phase zeros. Of course, if the plant is stable, a stable 
compensator G(s) can always be found.
3.6.2  Fundamental Theorem of Feedback Control
It is proven that “every plant P(s) of order n (order of the denominator) can be stabilized with a feed­
back compensator G(s) of order no greater than n − 1.” This is true if we consider the possibility 
of using not only stable compensators, but also unstable compensators if that is required.
3.6.3  Examples
The following examples illustrate how to apply the technique introduced in Section 3.6 to 
design controllers to stabilize unstable systems. The examples include minimum and non-
minimum phase zeros and poles at the origin. Cases L10a−L15a are unstable plants Pj(s) 
with Gja(s) = 1, j = 10, 11…15. Cases L10b−L15b and L15c are the compensated stable systems 
with the appropriate controller Gjb(s) or Gjc(s). Table 3.3 and Figure 3.10 show the details.
The example P10(s) is an unstable plant with two RHP poles (see L10a in Figure 3.10a, 
and row L10a in Table 3.3). As p = 2, the number of counterclockwise encirclements 
needed is N = −2. We use case a1 of Table 3.2, with Na = −2, to design a stable ­controller 
G10b(s) that stabilizes the closed-loop system (see L10b in Figure 3.10b, and row L10b in 
Table 3.3)—Equations 3.30 and 3.31.
	
P
s
s
s
10
5
0 5
1
0 25
1
( )
(
.
)(
.
)
= −
+
−
+
	
(3.30)
	
G
s
G
s
s
s
s
s
a
b
10
10
5
6
1
2
10
10
1 0 1
1
1
( )
;
( )
( .
)
(
)
=
=
×
+
(
)
+
+
−
0.0036
	
(3.31)
The example P11(s) is an unstable plant with one RHP pole (see L11a in Figure 3.10a, and 
row L11a in Table 3.3). As p = 1, the number of counterclockwise encirclements needed 
is N = −1. We use case b1 of Table 3.2, with Nb = −1, to design the controller G11b(s) that 
stabilizes the closed-loop system (see L11b in Figure 3.10b, and row L11b in Table 3.3) − 
Equations 3.32 and 3.33
Imag
Real 
Zero
Zero or
infinite
Even number
of poles 
Condition for
Stable
stabilizing G(s)
FIGURE 3.9
Parity interlacing property.

93
Unstable Systems and Control Solutions
	
P
s
s
s
11
0 25
0 5
1
1
( )
.
(
.
)(
)
= −
+
+
	
(3.32)
	
G
s
G
s
s
s
a
b
11
11
1
1
1
( )
;
( )
(
)
=
=
−
+
+
30(
)
0.1667
	
(3.33)
The example P12(s) is an unstable non-minimum phase plant with one RHP pole and 
one RHP zero (see L12a in Figure 3.10a, and row L12a in Table 3.3). In this case, we have 
to check the p.i.p. condition as well. As P12(s) satisfies the p.i.p. condition and p = 1, the 
TABLE 3.3
Results: Lj(s) = Pj(s)Gj(s), j = 10,…15. (a) without Controller; (b) or (c) with Controller
Case
Na
Nb
Nc
Nd
k
σ
α
γ
N
p
zc
Stab
L10a
0
0
0
0
−
−
−
−
0
+2
+2
U
L10b
−2
0
0
0
0
0
+1
−2
−2
+2
0
S
L11a
0
0
0
0
−
−
−
−
0
+1
+1
U
L11b
0
−1
0
0
−
−
−
−
−1
+1
0
S
L12a
0
0
0
0
−
−
−
−
0
+1
+1
U
L12b
0
0
−1
0
−
−
−
−
−1
+1
0
S
L13a
0
0
0
0
−
−
−
−
0
+2
+2
U
L13b
−4
0
0
+1
0
+1
+1
−2
−3
+3
0
S
L14a
0
0
0
0
−
−
−
−
0
+1
+1
U
L14b
−2
+1
0
0
−
−
−
−
−1
+1
0
S
L15a
0
0
0
0
−
−
−
−
0
+3
+3
U
L15b
−2
−1
0
0
−
−
−
−
−3
+3
0
S
L15c
−4
0
0
0
+1
0
+2
−2
−4
+4
0
S
Source:	 Garcia-Sanz, M. 2016. Int. J. Robust Nonlinear Control, 26(12), 2643–2651.
–360 –315 –270 –225 –180 –135 –90
–45
0
45
–60
–50
–40
–30
–20
–10
0
10
Open-loop phase (deg)
Open-loop gain (dB)
L10a(s)
L15a(s)
L13a(s)
L12a(s)
L11a(s)
L14a(s)
–810–720–630–540–450–360–270–180 –90
0
90
180 270
–40
–30
–20
–10
0
10
20
30
40
50
60
Open-loop phase (deg)
Open-loop gain (dB)
L10b(s)
L13b(s)
L14b(s)
L12b(s)
L15c(s)
L15b(s)
L11b(s)
Zoom
L13b
–182 –181.5 –181 –180.5 –180 –179.5 –179 –178.5 –178 –177.5 –177
–0.2
0
0.2
0.4
0.6
0.8
(a)
(b)
FIGURE 3.10
NCs: Lj(s) = Pj(s)Gj(s), j = 10,…15. (a) Without controller, that is, Gja(s) = 1—unstable systems and (b) with 
­controller, that is, Gjb(s) or Gjc(s)—stable systems. (Adapted from Garcia-Sanz, M. 2016. Int. J. Robust Nonlinear 
Control, 26(12), 2643–2651.)

94
Robust Control Engineering
number of counterclockwise encirclements needed is N = −1. We use case b2 of Table 3.2, 
with Nc = −1, to design a stable controller G12b(s) that stabilizes the closed-loop system (see 
L12b in Figure 3.10b, and row L12b in Table 3.3)—Equations 3.34 and 3.35
	
P
s
s
s
12
0 5
1
0 5
1
( )
. (
)
(
.
)
=
−+
−
+
	
(3.34)
	
G
s
G
s
s
s
a
b
12
12
1
0 8333
1
0 7143
1
( )
;
( )
.
( .
)
=
= −
+
+
1.3(
)
	
(3.35)
The example P13(s) is taken from Reference 254, Example 3.2. It is an unstable non-mini­
mum phase plant with two RHP poles, one RHP zero and negative gain (see L13a in Figure 
3.10a, and row L13a in Table 3.3). As p = 2, the number of counterclockwise encirclements 
needed is originally N = −2. However, P13(s) does not satisfy the p.i.p. condition. The plant 
has only one pole (s = +3) between the zero (s = +2) and the infinity, so the controller must 
be unstable. For this reason, we add a new unstable pole at s = +130, between s = +2 and 
infinity in the controller. Then, p = 3, and the number of counterclockwise encirclements 
needed is N = −3. We use cases a1 and b3 of Table 3.2, with Na = −4 and Nd = +1, to design 
the controller G13b(s) that stabilizes the closed-loop system (see L13b in Figure 3.10b, and 
row L13b in Table 3.3)—Equations 3.36 and 3.37
	
P
s
s
s
s
13
0 6667
0 5
1
1
0 33
1
( )
.
(
.
)
(
)(
.
)
= −
−
+
−+
−
+
	
(3.36)
	
G
s
G
s
s
s
s
s
a
b
13
13
2
1
1
0 0077
1
( )
;
( )
(
.
)
=
=
−
+
+
(
)
−
+
0.0615
17.75
26.8750
	
(3.37)
Note that although this last case is a very illustrative example to understand the guide­
lines proposed in Table 3.2, the solution is quite fragile (see Chapter 10) and not useful 
from the practical point of view. In other words, small changes in the coefficients of the 
controller, maybe just a consequence of the digital or analog implementation, can destabi­
lize the closed-loop system (which is the definition of fragility). For a deeper analysis of the 
fragility of control systems, see Section 10.4.
The example P14(s) is an unstable non-minimum phase plant with one RHP pole and 
one RHP zero (see L14a in Figure 3.10a, and row L14a in Table 3.3). As it satisfies the p.i.p. 
condition and p = 1, the number of counterclockwise encirclements needed is N = −1. 
We use case b4 of Table 3.2, with Na = −2 and Nb = +1 to design the stable controller 
G14b(s) that stabilizes the closed-loop system (see L14b in Figure 3.10b, and row L14b in 
Table 3.3)—Equations 3.38 and 3.39
	
P
s
s
s
s
14
0 5
1
1 0 5
1
( )
(
.
)
(
)( .
)
=
−
+
−+
+
	
(3.38)
	
G
s
G
s
s
s
s
s
a
b
14
14
2
1
0 5
1 5 13
1
1 25
37
1
( )
;
( )
.
( .
)
.
=
= −
+
+
+
+
(
)
11.02(
)
	
(3.39)

95
Unstable Systems and Control Solutions
The last example P15(s) is an unstable plant with three RHP poles (see L15a in Figure 3.10a, 
and row L15a in Table 3.3). We propose two different controllers. The first controller G15b(s) 
is a stable compensator that generates N = −3 counterclockwise encirclements for p = 3. 
We use cases a1 and b1 of Table 3.2, with Na = −2 and Nb = −1 to design this controller that 
stabilizes the closed-loop system (see L15b in Figure 3.10b, and row L15b in Table 3.3). The 
second controller G15c(s) is an unstable compensator that adds an additional unstable pole 
and generates N = −4 counterclockwise encirclements for p = 4. We use case b6 of Table 
3.2, with Na = −4 (crossing of −540 and −180) to design this controller to stabilize the 
closed-loop system (see L15c in Figure 3.10b, and row L15c in Table 3.3) − Equations 3.40 
and 3.41
	
P
s
s
s
s
15
6
0 5
1
0 25
1
0 1429
1
( )
(
.
)(
.
)(
.
)
= −
+
−
+
−
+
	
(3.40)
	
G
s
G
s
s
s
s
G
s
a
b
c
15
15
2
15
1
1 0 1818
1
0 0033
1
25
( )
;
( )
.
( .
)
( )
=
= −
+
+
+
=
1(
)(
)
(
)( .
)
(
.
)( .
)
s
s
s
s
s
+
+
−
+
+
1 0 1429
1
0 1667
1 0 002
1
3
2
	
(3.41)
3.7  Analysis of the First Case
This section develops the example presented in Section 3.2, including both the stability 
analysis with the technique introduced in Section 3.4 and the design of appropriate con­
trollers in the NC introduced in Section 3.6. The plant presented in Section 3.2 has an 
unstable pole at the RHP, s = +3, so that
	
P s
s
0
8
3
1
( )
((
)
)
=
−
+
/
	
(3.42)
Five controllers are propposed for this plant. The first controller G01(s) is presented in 
Equation 3.43. This is the trivial controller. The stability analysis and time response of the 
output y(t) of the closed-loop system under a unitary step input r(t) are shown in Figure 
3.11. As zc = 1, the system is unstable.
	
G
s
01
1
( ) = 	
(3.43)
The second controller G02(s) is the one presented in Section 3.2 and repeated in Equation 
3.44. The stability analysis and time response of the output y(t) of the closed-loop system 
under a unitary step input r(t) are shown in Figure 3.12. The system is also unstable: zc = 1.
	
G
s
s s
s
02
1
4
1
10
1
( )
((
)
)((
)
)
=
+
+
/
/
	
(3.44)
The third, fourth, and fifth controllers, G03(s), G04(s), and G05(s) are shown in Equations 
3.45 through 3.47, respectively. The three controllers are able to stabilize the plant P0(s). 

96
Robust Control Engineering
Figures 3.13 through 3.15 show the stability analysis and time response of the output y(t) 
of the closed-loop system under a unitary step input r(t). In the three cases, the closed-loop 
system is stable: zc = 0. The last case G05(s) is also able to achieve a zero steady-state error 
following a step input reference.
	
G
s
s
03
1
30
1
( )
((
)
)
=
−
+
/
	
(3.45)
	
G
s
s
s
s
04
1
1
1
100
1
( )
((
)
)((
)
)
=
+
(
)
−
+
+
/
/
	
(3.46)
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
Open-loop gain (dB)
–100
–80
–60
–40
–20
0
20
40
60
80
QFTCT
0
2
4
6
8
10
12
14
×1027
–2.5
–2
–1.5
–1
–0.5
0
0.5
Step response
Time (s)
Amplitude
(a)
(b)
FIGURE 3.12
(a) NC: L02(s) = P0(s)G02(s). (b) Closed-loop time response. Stability criterion: Unstable. Rule 1: no z/p cancelation. 
Rule 2: zc = 1, with N = 0, p = 1, and Na = 0, Nb = 0, Nc = 0, Nd = 0, with k = −1, σ = 0, α = 0, γ = 2.
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
Open-loop gain (dB)
–40
–30
–20
–10
0
10
20
QFTCT
0
0.5
1
1.5
2
2.5
–16
–14
–12
–10
–8
–6
–4
–2
0
2
Step response
Time (s)
Amplitude
×1028
(a)
(b)
FIGURE 3.11
(a) NC: L01(s) = P0(s)G01(s). (b) Closed-loop time response. Stability criterion: Unstable. Rule 1: no z/p cancelation. 
Rule 2: zc = 1, with N = 0, p = 1, and Na = 0, Nb = 0, Nc = 0, Nd = 0.

97
Unstable Systems and Control Solutions
	
G
s
s
s
05
1
1
100
1
( )
(
)
((s/
)
)
=
−
+
+
	
(3.47)
3.8  Summary
This chapter introduced the practical and comprehensive method proposed by the author 
to compute the Nyquist stability criterion directly in the Nichols (magnitude/phase) chart. 
Open-loop phase (deg)
–350
–300 –250 –200 –150 –100
–50
0
Open-loop gain (dB)
–60
–50
–40
–30
–20
–10
0
10
20
QFTCT
Time (s)
0
0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.4 0.45
y
0
0.2
0.4
0.6
0.8
1
1.2
1.4
(a)
(b)
FIGURE 3.13
(a) NC: L03(s) = P0(s)G03(s). (b) Closed-loop time response. Stability criterion: Stable. Rule 1: no z/p cancelation. 
Rule 2: zc = 0, with N = −1, p = 1, and Na = 0, Nb = −1, Nc = 0, Nd = 0.
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
Open-loop gain (dB)
–50
–40
–30
–20
–10
0
10
20
30
QFTCT
Time (s)
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
y
0
0.2
0.4
0.6
0.8
1
1.2
1.4
(a)
(b)
FIGURE 3.14
(a) NC: L04(s) = P0(s)G04(s). (b) Closed-loop time response. Stability criterion: Stable. Rule 1: no z/p cancelation. 
Rule 2: zc = 0, with N = −2, p = 2, and Na = −2, Nb = 0, Nc = 0, Nd = 0.

98
Robust Control Engineering
The method can be applied to LTI closed-loop systems with minimum and non-minimum 
phase zeros, stable and unstable poles, poles at the origin with diverse multiplicity and 
systems defined by nonrational functions, such as plants with time delay.
The chapter showed how to apply the method with some illustrative examples. Also, it 
gave guidelines to design controllers to stabilize unstable plants when dealing with fre­
quency-domain control techniques, and in particular with the QFT robust control design 
methodology.
The algorithm for this method is included in the QFTCT: check Controller design window, 
File menu, Check stability option. The MATLAB code for the algorithm can be found in 
Appendix 3 and also free-downloaded from the website:
http://cesc.case.edu/Stability_Nyquist_GarciaSanz.htm
3.9  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Examples 3.1−3.9. Section 3.5. Analysis of stability.
•	 Examples 3.10−3.15. Section 3.6. Design of control solutions to stabilize plants.
•	 Example P0. Section 3.7. Design of multiple control solutions.
•	 Appendix 3. MATLAB code for Nyquist stability criterion in the Nichols chart.
•	 Project P3. Appendix 1. Inverted pendulum.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
80
QFTCT
Time (s)
0
0.5
1
1.5
2
2.5
3
3.5
y
0
0.2
0.4
0.6
0.8
1
1.2
(a)
(b)
FIGURE 3.15
(a) NC: L05(s) = P0(s)G05(s). (b) Closed-loop time response. Stability criterion: Stable. Rule 1: no z/p cancelation. 
Rule 2: zc = 0, with N = −1, p = 1, and Na = −2, Nb = 0, Nc = 0, Nd = 1, with k = 0, σ = 1, α = 1, γ = −2.

99
4
Time-Delay and Non-Minimum Phase Systems
4.1  Time-Delay Systems
Chemical and biological plants, thermal, hydraulic and pneumatic systems, and spacecraft 
involve transport and communication time delays.122,6 Given a plant P(s), the time-delay or 
dead-time td is defined as the time that elapses from the instant when the plant input u(s) 
changes to the instant when the first effect of this input is seen in the plant output y(s). 
In Laplace terms, the time-delay is represented by the exponential function e
std
−. When 
the time-delay of a plant is comparatively larger than its time constants, an inherent band­
width limitation makes it more difficult to achieve a satisfactory control performance.
A simple index to quantify how challenging the design of the control system is going to 
be is the so-called normalized time delay, or τN, which is the ratio between the time delay td 
and the average residence time Tar ,
	
τ N
d
ar
t
T
=
	
(4.1)
The average residence time Tar can be easily calculated by adding up all the time constants 
of the poles and the time-delay and subtracting the time constants of the zeros. Consider 
for instance a transfer function of a given plant like,
	
y s
u s
P s
k
T s
T s
s
T s
T s
T s e
p
std
( )
( )
( )
(
)(
)
(
)(
)(
)
=
=
+
+
+
+
+
−
1
1
1
1
1
4
5
1
2
3
	
(4.2)
For this plant, the average residence time is
	
T
T
T
T
t
T
T
ar
d
=
+
+
+
−
−
1
2
3
4
5 	
(4.3)
According to these expressions, the normalized time delay τN is always a number between 
zero and one (0 ≤ τN ≤ 1). The larger τN, the more challenging the control is going to be. 
In  large τN cases, a special controller design methodology, often involving predictive 
­strategies, will be necessary to improve the system’s performance.
In some situations, however, the physical limitations imposed by the time-delay can 
make it impossible to achieve the desired performance specifications, even with the best 
predictive strategies. In these circumstances, the best solution is to redesign the plant itself, 
reducing the time delays as much as possible.

100
Robust Control Engineering
The intrinsic limitations imposed by the time delay are explained by Bode’s integral 
expressions presented in Chapter 3, Equations 3.1 and 3.2. Using a Padé n-order rational 
approximation for time delay,
	
e
k s
k s
k s
k s
k s
k s
k s
k s
st
n
n
n
n
d
−
≅
−
+
−
+
±
+
+
+
+
+
1
1
1
2
2
3
3
1
2
2
3
3


	
(4.4)
the Bode integral expression presented in Equation 3.2 becomes
	
ln (
)
Re(
)
S j
d
z
a
j
j
n
ω
ω
π
0
1
Ω
∫
∑
=
=
for time delay systems
	
(4.5)
where S(jω) = 1/[1 + P(jω)G(jω)] is the sensitivity function, Ωa is the available bandwidth, 
and zj is the location of the n zeros of the Padé n-order rational approximation of the time-
delay in the right half plane (RHP). As an example, for the first- and second-order Padé 
approximations, we have:
•	 For n = 1, k1 = td/2, other ki = 0, and Re(z1) = 2/td
•	 For n = 2, k1 = td/2, k
td
2
/12
=
2
, other ki = 0, and Re(z1) = 3/td, Re(z2) = 3/td
Intuitively, to make a system with time-delay stable we need approximately ωg < 1/td, 
which is consistent with the case ωg < zj/2 presented in Section 3.1 for nmp systems, and ωg 
being the gain crossover frequency, which is the frequency where |L(jω)| = |P(jω)G(jω)| = 
1 (0 dB).260,354
For open-loop stable systems, the reference tracking problem of a time-delay system 
can be improved substantially by introducing time-delay compensation. One of the 
most ­effective time-delay control strategies in use is the Smith predictor (SP), introduced 
by O.J.M. Smith in 1957.338 The SP employs, in an inner loop, a model of the plant ˆ( )
P s  
characterized by an estimated rational linear transfer function ˆ ( )
P s
r
 and an estimated 
time delay ˆtd to ­attenuate or cancel the effect of the time-delay in the real plant output 
y(s). Then, it utilizes the un-delayed estimated output “−y*(s)” as the feedback signal 
for control calculation. Figure 4.1 shows the control scheme of the SP. The real plant, 
–
+
+
d(s)
+
M(s)
P(s)
–y*(s)
–Pr(s)
e–std
G(s)
F(s)
ˆ
y(s)
ˆ
+
+
+
u(s)
Smith predictor
+
r(s)
FIGURE 4.1
SP control structure.

101
Time-Delay and Non-Minimum Phase Systems
estimated plant model, closed-loop transfer function T(s), and sensitivity transfer func­
tion S(s) are, respectively,
	
Real plant :
( )
( )
( )
( )
P s
P s e
n s
d s e
r
st
r
r
st
d
d
=
=
−
−
	
(4.6)
	
Plant model :
( )
( )
( )
( )
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
P s
P s e
n s
d s
e
r
st
r
r
st
d
d
=
=
−
−
	
(4.7)
	
y s
r s
P s G s
P s
P s e
P s e
G s
r
r
st
r
st
d
d
( )
( )
( ) ( )
( )
( )
( )
( )
=
+
+
−
(
)




−
−
1
F s
T s F s
( )
( ) ( )
=



	
(4.8)
	
y s
d s
e
P s G s
P s
P s e
P s e
st
r
r
r
st
r
d
d
( )
( )
( ) ( )
( )
( )
( )
=
+
−
(
)
+
+
−
−
−
1
1
1
ˆ
ˆ
ˆ
ˆ
−
(
)




=
std
G s
M s
S s M s
ˆ
( )
( )
( )
( )
	
(4.9)
where P s
P s e
r
std
( )
( )
=
− is the plant to be controlled, ˆ( )
ˆ ( )
ˆ
P s
P s e
r
std
=
− is the estimated plant 
model used by the SP, and G(s) is the controller. Using Equations 4.8 and 4.9, the plant out­
put is y(s) = T(s)F(s)r(s) + S(s)M(s)d(s)—see Figure 4.1.
If the model matches perfectly the real plant, that is, the rational linear transfer function 
model is ˆ ( )
( )
P s
P s
r
r
=
 and the time-delay model is ˆt
t
d
d
=
, then Equations 4.8 and 4.9 are 
simplified to
	
y s
r s
P s G s
P s G s e
F s
T s e
F s
r
r
st
r
st
d
d
( )
( )
( ) ( )
( ) ( )
( )
( )
( )
=
+
=
−
−
1
	
(4.10)
	
y s
d s
e
P s G s
P s G s
M s
T s e
st
r
r
r
s
d
( )
( )
(
)
( ) ( )
( ) ( )
( )
(
( )
=
+
−
+
=
−
−
−
1
1
1
1
ˆ
ˆtd M s
)
( )
	
(4.11)
being
	
T s
P s G s
P s G s e
T s e
r
r
st
r
st
d
d
( )
( ) ( )
( ) ( )
( )
=
+
=
−
−
1
	
(4.12)
	
S s
T s e
r
std
( )
( )
= −
−
1
	
(4.13)
These simplifications remove the time-delay from the denominator of the closed-loop 
transfer function and convert the corresponding reference tracking control problem into a 
delay free problem: Tr(s) = Pr(s)G(s)/[1 + Pr(s)G(s)].
The simplicity of this method allows the SP strategy to be implemented in low-cost 
­digital microcontrollers, making it one of the most popular methods for compensating 
systems with time-delay. Indeed, the SP is available as a standard algorithm in most 
­commercial PLCs and control devices.

102
Robust Control Engineering
However, we have to mention that although the SP method has the capability of 
­transforming a time-delay problem into a delay-free problem for the reference tracking 
case, it still suffers significant difficulties in the disturbance rejection case, even if the plant 
model matches the real plant perfectly. Equations 4.11 and 4.13 and Figure 4.5b show the 
transfer functions for the disturbance rejection problem. The following example illustrates 
the advantages and difficulties of the SP strategy.
EXAMPLE 4.1
To illustrate the characteristics of the SP, consider a classical first-order plant with time-
delay P(s), so that,
	
P s
P s e
s
e
M s
r
st
s
d
( )
( )
( .
)
;
( )
.
=
=
+
=
−
−
9
2 5
1
1
0 7
	
(4.14)
Due to the time-delay, the plant P(s) is closed-loop unstable (see Chapter 3). Figure 
4.2 shows the NC for P(s), which does not have RHP poles and has negative stability 
margins. As the frequency grows, the time delay decreases the phase at a “−(180/π) ω 
td” degrees rate, circling the point (0 dB,−180°) right-to-left through the positive dBs. As 
seen in Chapter 3, a simple method to stabilize the closed-loop system is to decrease the 
gain of the system with an appropriate controller G(s), to circle the point (0 dB,−180°) 
right-to-left through the negative dBs. As a consequence, the closed-loop system will 
be stable, but slow and with a low performance due to the limitations imposed by the 
time-delay.
In many cases, a higher performance is required. For them, the SP strategy can reduce 
the effect of the time-delay, and allow a much more aggressive and fast controller G(s). 
Following these ideas, we design a proportional–integral (P.I.) controller G(s) with 
Kp = 0.66 and Ti = 2 and a unitary prefilter F(s) (see the design in Example 4.1 (cont.)) 
such that
Nichols chart
15
10
5
0
Open-loop gain (dB)
Open-loop phase (deg)
System: P
Gain margin (dB): –3.15
At frequency (rad/s): 2.47
Closed loop stable? No
System: P
Phase margin (deg): –47.1
Delay margin (s): –0.23
At frequency (rad/s): 3.58
Closed loop stable? No
–5
–10
–360
–315
–270
–225
–180
–135
–90
–45
0
FIGURE 4.2
NC for plant P(s), Equation 4.14. It is closed-loop unstable.

103
Time-Delay and Non-Minimum Phase Systems
	
G s
K
Ts
s
s
F s
p
i
( )
.
;
( )
=
+





=
+
=
1
1
0 33 2
1
1
	
(4.15)
The design of this controller G(s) is made supposing a perfect cancellation of the 
effect of the time-delay, that is, the controller is designed for just the rational part of 
the plant, Pr(s) = nr(s)/dr(s). If the plant model implemented in the inner loop matches 
the real  plant,  the SP cancels the effect of the time-delay. In this case, the stability 
(Figure  4.3b) and the reference tracking problem (Figure 4.4b) are excellent. On  the 
­contrary, if we apply only this controller G(s) without the SP inner loop the system 
is ­unstable (Figure  4.3a), and the reference tracking problem does not work at all 
(Figure 4.4a).
Figure 4.5a shows the Bode diagram of the closed-loop transfer function T(s) for the 
plant P(s)—Equation 4.14, the controller G(s)—Equation 4.15, and the SP inner loop with 
a perfect model matching—Equation 4.12. The curve shows an excellent reference track­
ing performance.
At the same time, Figure 4.5b shows the Bode diagram of the sensitivity transfer 
­function S(s) for the plant P(s)—Equation 4.14, the controller G(s)—Equation 4.15, and 
the SP inner loop with a perfect model matching—Equation 4.13. The curve shows a 
poor disturbance rejection performance, with some frequencies where the sensitivity 
amplifies the ­disturbances, that is, the curve is above 0 dB: 20 log10(abs(S(jω))) > 0 dB at 
some frequencies.
To overcome these disturbance rejection difficulties, several modifications of the SP 
have been proposed. See for instance: Astrom et al. (1994), Matausek and Micic (1996), 
Normey-Rico and Camacho (1999), etc.351,352,353
In addition, it is also well known that the SP technique is very sensitive to model-
plant mismatch (plant uncertainty), either in the time delay or in the rational part of the 
model. Under those poor matching circumstances, stability margins may not guarantee 
stability even with small modeling errors. Figure 4.6 shows, for the example presented 
in this section, the effect of a 10% error in the gain (estimated gain = 9.9 instead of 9), of 
a 10% error in the time constant (estimated time constant = 2.25 instead of 2.5), and of a 
10% error in the time delay (estimated time delay = 0.77 instead of 0.7). The figure shows 
the closed-loop system output y(t) response to a unitary step input r(t) at t = 0 s—refer­
ence ­tracking problem. Complementary information about this sensitivity analysis can 
be found in Ioannides et al. (1979), Palmor (1980), Horowitz (1983), and Yamanaka and 
Shimemura (1987).342,343,345,347
With these difficulties in mind, the next sections present the method introduced by 
Garcia-Sanz and Guillen122,6 to tune the SP when the system presents model uncer­
tainty in both, the rational part and the time delay. The method is composed of two 
­algorithms. The first one is based on bandwidth frequency considerations and the sec­
ond one ­introduces a technique to improve the design by using the QFT technique.
4.2  Robust Design of the Smith Predictor
This section presents the methodology introduced by the author to select the plant model 
for the inner loop of the SP when there is a model-plant mismatch in both, time delay and 
rational part, so that,122,6
	
ˆ
ˆ ( )
( )
t
t
P s
P s
d
d
r
r
≠
≠
and
	
(4.16)

104
Robust Control Engineering
Nichols chart
Nichols chart
4
(a)
(b)
15
10
5
0
–5
–10
–15
–20
–225
–180
–135
–225
–180
–135
–90
–45
0
3
2
1
0
–1
–2
–3
–4
Open-loop gain (dB)
Open-loop gain (dB)
Open-loop phase (deg)
Open-loop phase (deg)
System: untitled1
Phase margin (deg): –8.33
Delay margin (s): –0.0607
At frequency (rad/s): 2.39
Closed loop stable? No
System: untitled1
Phase margin (deg): 87.7
Delay margin (s): 0.639
At frequency (rad/s): 2.39
Closed loop stable? Yes
System: untitled1
Gain margin (dB): –0.822
At frequency (rad/s): 2.18
Closed loop stable? No
FIGURE 4.3
NC. (a) L s
P s e
G s
r
std
( )
( )
( )
=
−
. (b) L s
P s G s
r
r
( )
( ) ( )
=
.

105
Time-Delay and Non-Minimum Phase Systems
The SP diagram shown in Figure 4.1 is rearranged to an equivalent structure, as shown 
in Figure 4.7, where the expressions of the blocks Peq(s) and Q(s) are presented in Equations 
4.17 through 4.19, and where Pr(s) and td might have uncertainty. The reference tracking 
problem described in Equation 4.8 is now rewritten as Equation 4.20.
	
H s
e
P s
P s
e
st
r
r
st
d
d
( )
(
)
( )
( )
=
−
+
−
−
1
ˆ
ˆ
	
(4.17)
	
Q s
e
H s
std
( )
( )
=
−
	
(4.18)
Step response
Step response
Time (s)
8
(a)
(b)
6
1
0.8
0.6
0.4
0.2
0
4
2
0
Amplitude
Amplitude
–2
–4
–6
–8
0
2
4
6
8
10
12
14
16
18
20
0
1
2
3
4
5
6
7
Time (s)
FIGURE 4.4
Closed-loop system output y(t) response to a unitary step input r(t) at t = 0 s. (a) G(s) without SP. (b) G(s) with SP 
and perfect model matching.
5
(a)
(b)
5
0
–5
–10
Bode diagram
Frequency (rad/s)
10–1
10–1
100
100
101
101
102
102
103
Frequency (rad/s)
Bode diagram
–15
–20
0
–5
–10
–15
Magnitude (dB)
Magnitude (dB)
–20
–25
–30
–35
FIGURE 4.5
Magnitude plot Bode diagram. SP with ˆ ( )
( )
P s
P s
r
r
=
 and ˆt
t
d
d
=
. (a) Closed-loop transfer function T s
T s e
r
std
( )
( )
=
−
—see Equation 4.12. (b) Sensitivity transfer function S s
T s e
r
std
( )
( )
=
−
−
1
—see Equation 4.13.

106
Robust Control Engineering
	
P s
P s H s
e
P s
P s e
eq
r
st
r
r
st
d
d
( )
( )
( )
(
)
( )
( )
=
=
−
+
−
−
1
ˆ
ˆ
	
(4.19)
	
y s
r s
P s H s G s
P s H s G s
e
H s F s
P
s G
r
r
st
eq
d
( )
( )
( )
( ) ( )
( )
( ) ( )
( ) ( )
( )
=
+
=
−
1
( )
( ) ( )
( ) ( )
s
P
s G s Q s F s
eq
1+
	
(4.20)
An analysis of the equivalent SP structure shows that, if there is no uncertainty in the 
model, that is to say a perfect matching or H(s) = 1, the time delay is eliminated from the 
un-delayed estimated output y*(s).
However, if there is some amount of model-plant mismatch, then the expression H(s) is 
different from one. As a consequence, the control system is affected by the uncertainty 
through H(s), which is in the blocks Peq(s) and Q(s). As a result, the selection of the plant 
model ˆ ( )
ˆ
P s e
r
std
−
 has a significant impact on the set of values that H(s) adopts over the space 
of uncertainty.
To address this problem, this section introduces a two-algorithm technique to tune the 
SP when the plant presents model uncertainty. The methodology gives guidelines to select 
the plant model for the inner loop of the SP. The first algorithm of the methodology works 
with the block Q(s), and the second algorithm uses the block H(s) and the QFT technique.122,6
Step response
1.5
2
2.5
3
3.5
Time (s)
4
4.5
5
5.5
10% error in time constant
Perfect model matching
Amplitude
10% error in gain
10% error in time delay
1.05
1
0.95
0.9
0.85
0.8
0.75
FIGURE 4.6
Closed-loop system output y(t) response to a unitary step input r(t) at t = 0 s. SP and G(s) with: perfect model 
matching, 10% error in gain, 10% error in time constant, and 10% error in time delay.
Pr(s)H(s)
Peq(s)
e–std
G(s)
F(s)
–
r(s)
y*(s)
y(s)
Q(s)
H(s)
+
u(s)
FIGURE 4.7
Equivalent diagram of SP for reference tracking.

107
Time-Delay and Non-Minimum Phase Systems
4.2.1  First Algorithm
The H(s) term, which appears in the Q(s) block as a post-filter of the control loop (Equation 
4.18 and Figure 4.7), might be responsible for some deterioration of the system perfor­
mance if the magnitude of the |Q(s)| block differs from “1” (0 dB) at frequencies within 
the system bandwidth ωBW (or frequencies of interest). In this case, y*(s) would be distorted 
when passing through the block Q(s).
Considering the complete space of parameter uncertainty and for a specified bandwidth 
specification, we propose the following criterion:
Criterion 1. An SP plant model has to be selected such that the resulting Q(jω) does not 
distort y*(s) for frequencies up to ωBW and for every possible plant Pi ∈P, where i = 1, 2, …, n. 
In other words, considering mb the magnitude distortion limit (typically mb = 3 dB) the SP 
model must satisfy
	
20
0
10
log
(
)
,
,
(
)
Q j
m
P j
e
d
BW
r
j td
ω
ω
ω
ω
ω
≤
≤
≤
∀
∈
−
P 	
(4.21)
The steps for the first algorithm (Criterion 1) are outlined in Table 4.1. It is a general 
­procedure that can be used for any plant model with a rational part and time-delay, and 
for any kind of model-plant mismatch. The procedure finds the subset of plant models 
that could be used by the SP without the Q(s) block causing much distortion of the output.
4.2.2  Second Algorithm
When there is a collection of possible SP models satisfying the first algorithm, then an addi­
tional degree of freedom is still available for the selection of the plant model for the SP. 
This additional degree of freedom utilizes the amount of change suffered by the equiva­
lent-plant Peq(s) QFT-templates as a second criterion to select the final SP plant model.
The ωi-frequency QFT-template of Peq(s) for two different SP models ˆ ( )
ˆ
P s e
r
std
−
 could sig­
nificantly differ in shape and area, producing different QFT bounds and hence requiring 
different controllers G(s). This fact introduces the question about which is the best plant 
model that has to be chosen from among those satisfying the first algorithm, to obtain the 
least demanding templates and ease the G(s) loop-shaping. According to QFT, as a general 
rule, the smaller the area of the templates, the easier the compensator design becomes, and 
the better performance can be achieved.
TABLE 4.1
Outline for the First Algorithm—Criterion 1
Step
1
Define a grid over the uncertainty of P s e
ri
stdi
( ) −
∈P. This allows the algorithm to work with a finite set of 
possible plants.
2
Choose the desired closed-loop bandwidth specification ωBW.
3
Select a plant ˆ ( )
ˆ
P s e
ri
stdi
−
∈P as the SP model.
4
For this SP model, compute the magnitude of Q(jω) for each plant ∈P.
5
If the magnitude of Q(jω) exhibits an amplification greater than mb at frequencies lower than the desired 
bandwidth ωBW, then that SP model can deteriorate the system performance. Hence it is rejected. 
Otherwise, the selected SP model passes this test.
6
Repeat from Step 3 to Step 5 for every possible SP model in P.

108
Robust Control Engineering
Let ℑT(jω) represent the real-plant templates and ℑTeq(jω) represent the equivalent-plant 
templates when the plant ˆ ( )
ˆ
P s e
r
std
−
 is selected as the SP model. Also, let A(⋅) represent the 
area of a template on the NC; and let Ω represent the discrete set of frequencies of interest, 
with nω frequencies. The cost function Icost, presented in Equation 4.22, is proposed as a 
measure of suitability of a specific SP model
	
I
n
W
A T
j
A T j
eq
cost =
∈∑
1
ω ω
ω
ω
ω
( )
(
(
))
( (
))
Ω
	
(4.22)
This cost function is a weighted sum of normalized areas, where W(ω) represents weights 
that can be used to emphasize some critical frequencies, like the gain or phase crossover 
frequencies, resonant modes, etc. Typically, 0 ≤ W(ω) ≤ 1. An SP plant model that leaves 
every real-plant template area invariant is assigned a cost Icost = 1 if unity weights are used. 
With these definitions, we propose the following criterion:
Criterion 2. From all the SP plant models that passed Criterion 1, select the SP plant 
model that presents the minimum cost function Icost—Equation 4.22.
The steps that implement the second algorithm (Criterion 2) are outlined in Table 4.2. 
Again, this is a general procedure that can be used for any plant model with a rational part 
and a time-delay, and for any kind of model-plant mismatch.
The model of the plant selected for the SP structure with the proposed methodology 
avoids distortion within the operating bandwidth (first algorithm) and presents the least 
restrictive templates to the compensator design stage (second algorithm). Finally, though the 
development is made for continuous systems, the results obtained remain valid for digital 
control systems incorporating digital SPs (see Chapter 10).
EXAMPLE 4.1  (CONT.)
To illustrate and clarify the above ideas, consider again Example 4.1
	
P s
P s e
K
s
e
r
st
st
d
d
( )
( )
=
=
+
−
−
τ
1
	
(4.23)
which captures the essential dynamics of numerous chemical, biological, and industrial 
processes. In this case, the parameters for this real plant adopt values that belong to the 
space of parametric uncertainty given by, K = 9.0 ± 10%, τ = 2.5 ± 10%, td = 0.7 ± 10%, or,
	
K
td
∈
∈
∈
[ . , . ],
[ .
, .
],
[ .
, .
]
8 1 9 9
2 25 2 75
0 63 0 77
τ
and
	
(4.24)
TABLE 4.2
Outline for the Second Algorithm. Criterion 2
Step
1
Select a plant ˆ ( )
ˆ
P s e
r
std
−
 as the SP model from those that have successfully passed the first algorithm.
2
Compute the equivalent-plant templates of Peq(s) [see Equation 4.19] over the frequency range of 
interest.
3
Calculate the area of the templates, and then the cost function Icost [see Equation 4.22].
4
Repeat from Steps 1 to 3 for every SP model that successfully passed the first algorithm.
5
Select the model that results in the minimum cost function Icost.

109
Time-Delay and Non-Minimum Phase Systems
Clearly, the mathematical SP model that better describes the plant is the first-order 
dynamic system with time-delay so that,
	
ˆ( )
ˆ ( )
ˆ
ˆ
ˆ
ˆ
P s
P s e
K
s
e
r
st
st
d
d
=
=
+
−
−
τ
1
	
(4.25)
Applying the First Algorithm
As is mentioned above, the first algorithm of the methodology is based on the analysis of 
the magnitude of the frequency response of Q(jω) over the frequency range of ­interest 
and for the complete set of parameter uncertainty. Appendix 4 includes the complete 
MATLAB code for this example.
By fixing the desired closed-loop bandwidth to ωBW (Step 2 of Table 4.1), the set of 
admissible SP models which fulfill the bandwidth specification are easily found by fol­
lowing Steps 3 through 6 of the first algorithm. The results of this example are plotted as 
a 3D object, where each of the three axes represent the uncertainty of every parameter τ, 
td, K (see Figures 4.8 and 4.9). The models the SP could adopt are those located inside the 
3D figure. To obtain Figure 4.8, a grid of 5 × 5 × 5 values (=125 plants) is used. Figure 4.8a 
shows the 3D object obtained for the bandwidth specification ωBW = 1.0 rad/s, Figure 4.8b 
for ωBW = 2.0 rad/s, and Figure 4.9 for ωBW = 2.25 rad/s. As might have been expected, the 
larger the bandwidth specification the smaller the set of potential candidates. Figure 4.9 
also illustrates that the usual selection of a “mean” SP model (with the mean parameter 
values, shown in the figure) is not the most appropriate choice according to Criterion 1. 
In the limit, if the bandwidth specification is larger enough, it is presumed that there is 
only one possible model.
The SP plant models that passed the first algorithm for ωBW = 2.25 rad/s are shown in 
Figure 4.9 and Table 4.3. We will use these candidates in the second algorithm to find and 
select the final SP plant model.
Applying the Second Algorithm
Given the bandwidth specification ωBW = 2.25 rad/s, the first algorithm found the set of SP 
plant model candidates shown in Figure 4.9 and Table 4.3. Using these SP plant mod­
els, the second algorithm calculates the QFT-templates for Peq(s) = Pr(s)H(s) using the com­
plete parametric uncertainty for the real plant P(s) defined by Equation 4.24. Figure 4.10 
ωBW = 1.0 rad/s
10
(a)
(b)
9.5
9
K
8.5
8
0.8
0.75
0.7
0.65
td
2.2
2.4
2.6
τ
2.8
0.6
ωBW = 2.0 rad/s
10
9.5
9
K
8.5
8
0.8
0.75
0.7
0.65
td
2.2
2.4
2.6
τ
2.8
0.6
FIGURE 4.8
Plants (set of parameters) that meet first algorithm. (a) with ωBW = 1.0 rad/s and (b) with ωBW = 2.0 rad/s.

110
Robust Control Engineering
compares these templates for Peq(s) with the original templates for P(s). See the MATLAB 
code in Appendix 4.
Then, we apply Equation 4.22 and calculate the cost function Icost of every SP plant 
model candidate that passed the first algorithm (Figure 4.9 and Table 4.3). Figure 4.11 
shows the results. The candidate #6 presents the minimum value, with Icost = 0.9446, for 
W(ω) = 1 ∀ω. Then, we select the plant model #6, with τ = 2.75, td = 0.77, and K = 8.55 for 
the SP inner model. That is,
	
ˆ( )
ˆ ( )
ˆ
ˆ
.
.
ˆ
ˆ
.
P s
P s e
K
s
e
s
e
r
st
st
s
d
d
=
=
+
=
+
−
−
−
τ
1
8 55
2 75
1
0 77
	
(4.26)
ωBW = 2.25 rad/s
10
9.5
9
8.5
8
0.8
0.75
0.7
0.65
td
K
2.2
2.4
2.6
Mean value
(2.5, 0.7, 9)
τ
2.8
0.6
FIGURE 4.9
Plants (set of parameters) that passed first algorithm with ωBW = 2.25 rad/s. Table 4.3. See that mean value (τ = 2.50, 
td = 0.7, K = 9) is outside.
TABLE 4.3
Plants (Set of Parameters) That Passed the First Algorithm 
with ωBW = 2.25 rad/s (Figure 4.9)
τ
td
K
1
2.375
0.735
8.10
2
2.625
0.770
8.10
3
2.750
0.770
8.10
4
2.500
0.735
8.55
5
2.625
0.735
8.55
6
2.750
0.770
8.55
7
2.750
0.735
9.00
8
2.625
0.700
9.45
9
2.750
0.700
9.90

111
Time-Delay and Non-Minimum Phase Systems
Finally, in order to design the controller G(s) for the equivalent plant Peq(s) with the 
SP strategy and the selected SP plant model (see Figure 4.7), we propose a set of three 
control specifications: robust stability, robust output disturbance rejection, and robust 
reference tracking—see Equations 4.27 through 4.29, respectively, and Figure 4.12. Note 
that these specifications are proposed for Peq(s) = Pr(s)H(s).
18
16
14
12
10
8
Magnitude (dB)
6
4
2
–180
–160
–140
–120
Phase (deg)
Peq(j2)
Peq(j1.5)
Peq(j1)
Peq(j0.5)
P(j0.5)
P(j1)
P(j1.5)
P(j2)
–100
–80
–60
–40
FIGURE 4.10
QFT templates for P(s) and Peq(s) = Pr(s)H(s). Uncertainty: Equation 4.24.
1.02
1.01
1
0.99
0.98
Icost
0.97
0.96
0.95
0.94
0.93
1
2
3
4
5
Model number
6
7
8
9
FIGURE 4.11
Icost for plant models that passed first algorithm (plants in Table 4.3).

112
Robust Control Engineering
•	 Stability specification:
	
P j
H j
G j
P j
H j
G j
W
GM
PM
r
r
s
(
)
(
) (
)
(
)
(
) (
)
ω
ω
ω
ω
ω
ω
1+
≤
=
=
=
1.6(
4.2dB,
36.4°
=
)
for
0.001
0.005
0.01
0.05
0.1
0.5
1
5
10
50] rad/s
ω
[
	
(4.27)
•	 Sensitivity or output disturbance rejection specification—see Figure 4.12a:
	
1
1
2
+
≤
=
=
+
P j
H j
G j
r
op
j
j
(
)
(
) (
)
[
( )
(
)
(
)
ω
ω
ω
δ
ω
ω
ω
ω
for
0.001
0.005
0.01
0.05
0.1
0.5
1
/
]rad s 	
(4.28)
•	 Reference tracking specification—see Figure 4.12b:
	
δ
ω
ω
ω
ω
ω
ω
ω
ω
δ
ω
lo
r
r
up
P j
H j
G j
P j
H j
G j
F j
( )
(
)
(
) (
)
(
)
(
) (
) (
)
( )
≤
+
≤
1
	
(4.29)
	
where,
	
δ
ω
ω
ω
lo
j
j
(
=
+
+
)
0.98
0.1(
)
(
)
1
is the lower bound
2
	
	
and,
	
δ
ω
ω
ω
ω
up
j
j
j
( )
(
)
1.02
0.2(
)
0.85(
)
1
is the upper bound
2
=
+
+
+
	
Bode diagram
Frequency (rad/s)
δop
δlo
δup
Time (s)
10–3
10–2
10–1
100
101
102
0
1
2
3
4
5
6
10
(a)
(b)
0
–10
1.4
1.2
1
0.8
0.6
0.4
0.2
0
–20
–30
Magnitude (dB)
Amplitude
–40
–50
–60
Step response
FIGURE 4.12
Control specifications for Peq(s) = Pr(s)H(s). (a) Disturbance rejection at the output of the plant: δop. (b) Reference 
tracking: δup, δlo.

113
Time-Delay and Non-Minimum Phase Systems
	
for
0.001
0.005
0.01
0.05
0.1
0.5
1 rad/s
ω = [
]
	
The QFT bounds are calculated taking into account the Peq(s) structure with the param­
eter uncertainty given by Equation 4.24, the SP plant model given by Equation 4.26, and 
the above stability, output disturbance rejection, and reference tracking specifications 
given by Equations 4.27 through 4.29, respectively—see Figure 4.13.
To meet the specifications and illustrate the methodology, we select a P.I. controller 
G(s) with Kp = 0.66 and Ti = 2 (also used in Example 4.1), and a unitary prefilter F(s), such 
that,
	
G s
K
Ts
s
s
F s
p
i
( )
.
;
( )
=
+





=
+
=
1
1
0 33 2
1
1
	
(4.30)
The QFT-bounds and the loop shaping of L(s) = Peq(s)G(s) are shown in Figure 4.13. 
The solution includes the SP structure with the plant model selected with the meth­
odology—Equation 4.26, and the QFT controller G(s) presented in Equation 4.30. As 
Figure 4.14 shows, the control system meets the performance specifications: see Figure 
4.14a for the frequency-domain analysis of the disturbance rejection specification—
Equation 4.28, and Figure 4.14b for the time-domain analysis of reference tracking spec­
ification with 125 plants—Equation 4.29.
Also, Figure 4.15 shows the improvement achieved with the proposed SP plant model 
selection methodology over the classical mean value plant model selection technique 
with the same real plant model used in Figure 4.6.
60
40
20
0
Open-loop gain (dB)
–20
–40
–350
–300
–250
–200
Open-loop phase (deg)
QFTCT
L(s) = Peq(s)G(s)
50 rad/s
10 rad/s
5 rad/s
1 rad/s
0.1 rad/s
0.05 rad/s
0.005 rad/s
0.001 rad/s
0.01 rad/s
0.5 rad/s
–150
–100
–50
0
FIGURE 4.13
Loop-shaping of controller G(s). L(s) = Peq(s)G(s) = Pr(s)H(s)G(s).

114
Robust Control Engineering
4.3  Non-Minimum Phase Systems
4.3.1  Analysis
The presence of a plant’s zeros in the RHP also limits the performance achievable by 
­closed-loop control systems. When we have RHP zeros, we say that the plant is non-­
minimum phase (nmp). On the ­contrary, if there are no RHP zeros, then we say that the plant 
is minimum phase (mp). As with the time-delay, the RHP zeros compromise the stability and 
reduce the control possibilities.
QFTCT
Worst case at each
frequency
10–3
10–2
10–1
Frequency (rad/s)
Time (s)
101
100
102
0
1
2
3
4
5
6
QFTCT
Up to 1 rad/s
1.2
1
0.8
0.6
0.4
0.2
0
0
(a)
(b)
–10
–20
–30
–40
Magnitude (dB)
–50
–60
δop
δlo
δup
FIGURE 4.14
Analysis of controller G(s) for Peq(s) = Pr(s)H(s). (a) Disturbance rejection at the output of the plant: δop. (b) Reference 
tracking: δup, δlo.
Step response
(b)
(a)
Time (s)
2
3
4
5
6
7
8
1.08
1.06
1.04
1.02
1
0.98
SP. model (mean parameters)
SP. model (algorithms Section 4.2)
Amplitude
Step response
Time (s)
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
SP. model
(mean parameters)
SP. model (algorithms
Section 4.2)
1.2
0.8
1
0.6
Amplitude
0.4
0.2
0
FIGURE 4.15
Plant output y(t): (a) full response and (b) details. Analysis of controller G(s) and SP with plant model ˆ( )
P s  
according to algorithms of Section 4.2: (τ = 2.75, td = 0.77, K = 8.55), and with plant model ˆ( )
P s  with mean param­
eters: (τ = 2.5, td = 0.7, K = 9.0).

115
Time-Delay and Non-Minimum Phase Systems
Physically speaking, the presence of an RHP zero in the plant can be understood as 
the result of two parallel subsystems that interact with opposite signs within the plant. 
Figure 4.16 and Equations 4.31 and 4.32 show an example. The zero is in the RHP when 
either [k1 > k2 with k2τ1 > k1τ2] or [k1 < k2 with k2τ1 < k1τ2]. For instance, Equation 4.33 (Example 
4.2) shows an nmp case with one RHP zero at z1 = +7/11, and Equation 4.34 (Example 4.3) 
shows the same case but as mp, with the zero z1 = –7/11 at the left half plane (LHP).
	
y s
u s
P s
k
k
s
k
k
s
s
( )
( )
( )
(
)
(
)
(
)(
)
=
=
−
+
−
+
+
1
2
2
1
1
2
1
2
1
1
τ
τ
τ
τ
	
(4.31)
	
z
k
k
k
k
1
1
2
1
2
2
1
= −
−
−
(
)
(
)
τ
τ
	
(4.32)
EXAMPLE 4.2:  nmp CASE
k1 = 10, k2 = 3, τ1 = 7, τ2 = 1.
	
y s
u s
P s
s
s
s
z
( )
( )
( )
(
)(
) ,
(
)
=
=
−
+
+
+
=
>
11
7
7
1
1
7
11
0
1
with
RHP
	
(4.33)
EXAMPLE 4.3:  mp CASE
k1 = 19/3, k2 = –2/3, τ1 = 7, τ2 = 1.
	
y s
u s
P s
s
s
s
z
( )
( )
( )
(
)(
) ,
(
)
=
=
+
+
+
= −
<
11
7
7
1
1
7
11
0
1
with
LHP
	
(4.34)
Also, for these two cases, Figure 4.17a shows the root locus for Example 4.2—see the RHP 
zero, and Figure 4.17b the root locus for Example 4.3—see the zero in the LHP.
The Bode diagram for both examples is shown in Figure 4.18a. As we can see, at 
high ­frequency the nmp system presents a phase of −180° less than the mp system (high 
­frequency phase = −270° instead of −90°). Accordingly, this is the reason for the name nmp 
or mp ­systems. The phase lag of the nmp system is the fact that compromises the stability 
and reduces the control possibilities.
Finally, the open-loop step response of both examples is shown in Figure 4.18b. The nmp 
system presents an initial inverse response, while the mp shows an initial direct response.
4.3.2  Control Methodology
In this section, we proposed a control methodology to regulate nmp systems. The tech­
nique is based on the SP strategy introduced in Section 4.2 for time-delay systems. In a 
u(s)
y(s)
+
–
k1
k2
τ1s + 1
τ2s + 1
FIGURE 4.16
Example of the internal configuration of an nmp system.

116
Robust Control Engineering
similar  way, we adopt a control diagram with a model of the plant in an inner loop 
(­internal-model based controller) where, instead of the blocks shown in Figure 4.1 for time-
delay systems, we adopt the structure presented in Figure 4.19, selecting,
	
ˆ
( )
( ),
( )
P
s
P s
APF s
e
mp
r
std
instead of
and
instead of
−
	
(4.35)
As we can see in Figure 4.19, the controller employs in an inner loop an estimated mp 
plant model and an estimated all-pass filter (APF). This allows the controller to attenuate 
or cancel the effect of the nmp zero in the real plant output y(s)—in reference tracking 
specifications. Then, it utilizes the mp estimated output “−ymp*(s)” as the feedback signal for 
control calculation. The real plant and estimated plant are, respectively,
	
Real plant:
P s
as
n s
d s
r
r
( )
(
)
( )
( )
= −
+1
	
(4.36)
Root locus
nmp zero
mp zero
–2
–1
1.5
0.2
0.15
0.1
0.05
0.0
–0.05
–0.1
–0.15
–0.2
–3.5
–3
–2.5
–1.5
–1
–0.5
0
0.5
–2
0
1
2
3
4
1
0.5
0
–0.5
Imaginary axis (s–1)
Real axis (s–1)
Real axis (s–1)
Imaginary axis (s–1)
–1
–1.5
Root locus
(b)
(a)
FIGURE 4.17
Root locus. (a) nmp case and (b) mp case. Examples 4.2 and 4.3.
Bode diagram
Frequency (rad/s)
Time (s)
0
10
20
30
40
50
Pnmp(s)
Pmp(s)
Pnmp(s)
Pnmp(s)
Pmp(s)
Pmp(s)
10–3
10–2
10–1
100
101
102
20
7
6
5
4
3
2
1
0
0
–20
Magnitude (dB)
Amplitude
Phase (deg)
–40
0
–90
–180
–270
Step response
(b)
(a)
FIGURE 4.18
(a) Bode diagram and (b) step responses of nmp and mp cases. Examples 4.2 and 4.3.

117
Time-Delay and Non-Minimum Phase Systems
	
Estimated plant:
( )
( )
( )
( )
ˆ
ˆ
ˆ
P s
P
s
P
s APF s
nmp
mp
=
=
	
(4.37)
with,
	
Minimum phase plant model:
( )
(
)
( )
( )
ˆ
ˆ
ˆ
ˆ
P
s
as
n s
d s
mp
r
r
=
+1
	
(4.38)
	
All-pass filter:
( )
(
)
(
)
APF s
as
as
= −
+
+
ˆ
ˆ
1
1
	
(4.39)
Now, based on these expressions, and similar to Equations 4.8 and 4.9, the closed-loop 
transfer function T(s) and the sensitivity transfer function S(s) are
	
y s
r s
P s G s
P
s
P s
P
s APF s
G s
F
mp
mp
( )
( )
( ) ( )
( )
( )
( )
( )
( )
=
+
+
−
(
)




1
ˆ
ˆ
( )
( ) ( )
s
T s F s
=
	
(4.40)
	
y s
d s
APF s P
s G s
P
s
P s
P
s APF
mp
mp
mp
( )
( )
(
( ))
( ) ( )
( )
( )
( )
(
=
+
−
+
+
−
1
1
1
ˆ
ˆ
ˆ
s
G s
M s
S s M s
)
( )
( )
( )
( )
(
)




=
	
(4.41)
For open-loop stable systems, the tracking problem of these nmp systems can be improved 
substantially by introducing this RHP zero compensation—see Equation 4.40.
Notice also that the APF defined in Equation 4.39 coincides with the time-delay Padé 
approximation of first order—see Equation 4.4. For this reason, for cases where there is a 
model-plant mismatch in both, the nmp zero and the rational part,
	
ˆ
ˆ
( )
( )
a
a
P
s
P
s
mp
mp
≠
≠
and
	
(4.42)
the selection of the plant model for the inner loop of the controller can be done according 
to the same methodology introduced in Section 4.2, first and second algorithms. The details 
are left to the reader.
+
+
+
d(s)
+
+
M(s)
P(s)
APF(s)
–ymp*(s)
G(s)
F(s)
y(s)
u(s)
–Pmp(s)
ˆ
+
+
r(s)
Controller
–
FIGURE 4.19
Extension of the SP concept to nmp systems.

118
Robust Control Engineering
4.4  Summary
The presence of time-delay limits the performance achievable by closed-loop control sys­
tems. For open-loop stable systems, the tracking problem of a time-delay system can be 
improved substantially by introducing time-delay compensation. One of the most popular 
and effective time-delay control strategies in use is the SP.
It is well known, however, that the SP may be very sensitive to model-plant mismatch, 
resulting in a poor performance when model uncertainty is present. This chapter intro­
duced a method to design SPs when the plant is not precisely known. The method includes 
two criteria. The first one, presented as first algorithm, is based on bandwidth frequency 
considerations. It finds the set of model candidates for the plant so that, if the SP adopts one 
of them, the desired bandwidth is not reduced by the effect of the parameter ­uncertainty. 
The second criterion, presented as second algorithm, introduces some guidelines to improve 
the design of the SP by using the QFT technique.
An illustrative example shows in detail how to effectively apply the methodology step 
by step to a plant with time-delay and model uncertainty. The MATLAB code for the 
­algorithms for this example is presented in Appendix 4.
Finally, the presence of plant’s zeros in the RHP (nmp systems) also limits the perfor­
mance achievable by closed-loop control systems. This chapter also analyzed the main 
properties of these systems. Also, it introduced a methodology similar to the one proposed 
for the SP, to design an internal-model based controller when the plant is not precisely known. 
For open-loop stable systems, the tracking problem of these nmp systems can be improved 
substantially by introducing this RHP zero compensation.
4.5  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Example 4.1. Sections 4.1 and 4.2. First-order plant with delay and SP.
•	 Examples 4.2 and 4.3. Section 4.3. nmp and mp systems.
•	 Appendix 4. MATLAB code for Example 4.1.
•	 Project P6. Appendix 1. Central heating system with long-time delays.

119
5
Distributed Parameter Systems
5.1  Introduction
The physical systems we have studied in the previous chapters are lumped systems. 
A lumped system is one in which its elements are considered as concentrated at singular 
points in space, and all the dependent variables of interest are a function of time alone, 
that is, f(t). A typical example is an electrical circuit with resistors R, capacitors C, and 
inductances L. The dependent variables are the current i(t) and the voltage v(t), which are 
a function of time alone. Generally, lumped systems are described with a set of ordinary 
differential equations (ODEs). In this electrical circuit example, we can describe the system 
with the well-known ODEs
	
i t
C dv t
dt
i t
Rv t
v t
L di t
dt
( )
( ) ;
( )
( );
( )
( )
=
=
=
	
(5.1)
On the contrary, a distributed parameter system (DPS) is one in which the dependent 
variables are functions of both time and spatial variables, that is, g(t, x, y, z,…). In this case, 
the elements are distributed in space (x, y, z). A classic DPS example is an electrical line, 
where the resistance, capacity, and inductance are not constant but a function of the line 
length x, that is, R(x), C(x), and L(x). Then, the dependent variables, current and voltage, are 
a function of time and distance: i(t,x) and v(t,x). In these DPS cases, we need a set of partial 
differential equations (PDEs) to describe the system.
Examples for DPSs include flexible robots, heat transfer problems, large mechanical 
structures, spacecraft with flexible appendages, electrical transmission lines, etc. Due to 
the high complexity and computational cost of solving PDEs, DPSs are often approxi­
mated by much simpler lumped systems and the corresponding ODEs. When this lumped 
approximation is not enough to catch the DPS characteristics, methods based on PDEs are 
required. In the last two decades, a significant number of papers about control of DPSs 
have been proposed. They include a variety of topics like stability, controllability, observ­
ability, sensor location, estimation, and optimal control of DPSs. However, at the same 
time, there are still very few practical approaches for DPS control design, and even fewer 
for DPS robust control.
This chapter introduces a practical quantitative robust control technique to design one-
point feedback controllers for DPSs with uncertainty. The method considers the spatial 
distribution of the relevant points where the inputs and outputs of the control system are 
applied (actuators, sensors, disturbances, and control objectives), and a new set of trans­
fer functions (TFs) that describe the relationships between those distributed inputs and 
outputs.

120
Robust Control Engineering
Based on the definition of such distributed TFs, the classical robust stability and robust 
performance specifications are extended to the DPS case, and a new set of quadratic 
inequalities are defined for the DPS QFT bounds. As a result, we propose an advanced 
control method able to deal with uncertainty in both the model and the spatial distribution 
of the inputs and the outputs. The chapter also includes a well-known DPS heat transfer 
example to illustrate the use and simplicity of the proposed methodology.
5.2  Modeling Approaches for PDE7
DPSs can be described with PDEs. According to the classical book written by Farlow,358 a 
general second-order linear PDE in two variables is of the form
	
AU
BU
CU
DU
EU
FU
G
xx
xy
yy
x
y
+
+
+
+
+
=
	
(5.2)
where U
U
x
xx = ∂
∂
2
2
/
, U
U
x y U
U
x
xy
x
= ∂
∂∂
∂
∂
2
/
, 
 =
/
,  U
U
y
y = ∂
∂
/
, etc.
This equation is written here with the two independent variables x and y. Note, however, 
that in many problems one of the two variables stands for time, and hence the case is writ­
ten in terms of x and t. Following Equation 5.2, there is a basic classification to linear PDE 
involving three types of equations. They are:
	
1.	Parabolic equations, that satisfy the property B2–4AC = 0 (as for heat flow and diffu­
sion processes)
	
2.	Hyperbolic equations, that satisfy the property B2–4AC > 0 (as for wave equations)
	
3.	Elliptic equations, that satisfy the property B2–4AC < 0 (as for some mechanical 
systems)
Some very well-known examples of these three types are: the heat exchange equation 
for parabolic type {∂ T/∂ t = K ∂  2T/∂ x2}; the one-dimensional (1D) wave equation for hyper­
bolic type {∂  2T/∂ t2 = K ∂  2T/∂ x2}; and the Euler–Lagrange equation for the elliptic type 
{∂  2T/∂ t2 + ∂  2T/∂ x2 = 0}.
Frequently, for parabolic systems an easy model approximation is to use equivalent elec­
trical circuits (see Figures 5.1 and 5.5 and Example 5.1). Generally speaking, the set of dif­
ferential equations describing the dynamic performance of these kinds of DPSs can be 
formulated in terms of through variables (I) and across variables (V)—see References 230 and 
Xi+1
X2
X2(s) = P21(s) X1(s)
X1
Xi
Z1
Z1
Z2
Z2
Z2
Z2
Z2
Z2
Z1
FIGURE 5.1
Π-equivalent electrical model.

121
Distributed Parameter Systems
236. The through variable (I) can represent an electrical current, a mechanical force or 
torque, a heat flow rate, etc. The across variable (V) can represent an electrical voltage dif­
ference, a mechanical linear or angular velocity difference, or a temperature difference, etc.
The equivalent electrical model Px2x1 (Figure 5.1) is defined with Π (Pi) elements in series 
between the points of interest X1 and X2. The more Π elements introduced, the larger 
the bandwidth where the model is accurate enough to be used. The minimum amount of 
­elements to be considered can be studied with the Anderson–Parks criteria.346
For the three types of PDEs, another general approach of Px2x1 can be obtained by getting 
the solution of the PDE. This is not a trivial task, and often it leads to either an irrational 
solution or a very complex TF. In these cases, it is convenient to transform the irrational 
solutions into a series of sums or products by using some mathematical approaches such 
as the Taylor series, Fourier series, or Weirstrass factorization (see, e.g., Equation 5.37). 
As before, the number of components of the sums or products can be studied with the 
Anderson–Parks criteria.346
5.3  Generalized DPS Control System Structure7,137
As is seen in the previous chapters, the classical 2DOF general feedback structure includes 
a loop compensator G(s) and a prefilter F(s) in series with the feedback loop (Figure 5.2). 
Based on this structure, the following well-known equations for the plant output y(s), con­
trol signal u(s), and signal error e(s) are obtained—see also Equations 2.32 through 2.34.
	
y
PG
PGH F r
PGH
PG d
P d
d
M d
PGH
PGH n
e
i
o
=
+
+ +
+
+
+
−+
1
1
1
1
(
)
	
(5.3)
	
u
G
PGH F r
G
PGH
d
H P d
H d
H M d
GH
PGH n
e
i
o
=
+
+
+
−
−
−
−
+
1
1
1
(
)
	
(5.4)
	
e
PGH F r
H
PGH
PGd
P d
d
M d
H
PGH n
e
i
o
=
+
−
+
−
−
−
−
+
1
1
1
1
(
)
	
(5.5)
where P(s) denotes the plant with uncertainty, H(s) the dynamics for the sensor and fil­
ters, M(s) the dynamics of the effect of the generic disturbances d(s) over the plant output, 
and r(s), n(s), de(s), di(s), do(s) represent the reference signal for tracking, sensor noise, and 
+
+
–
+
+
+
+
+
+
+
+
r(s)
F(s)
de(s)
e(s)
di(s)
u(s)
do(s)
y(s)
n(s)
d(s)
M(s)
P(s)
H(s)
G(s)
FIGURE 5.2
Classical 2DOF feedback structure.

122
Robust Control Engineering
external disturbances at the error signal, plant input and plant output, respectively. The 
Laplace variable s is omitted in the equations for simplicity. To deal with DPSs, this chap­
ter ­proposes a generalization of this classical 2DOF feedback structure. In particular, we 
propose to include the information of the spatial location (xa, xd, xs, and xo) of the points 
where the actuator, disturbances, sensor, and control objectives are applied, respectively, 
as shown in Figure 5.3.
Based on these points, a PDE TF can be defined between every two points of interest. 
These PDE TFs vary with the relative position, topology, and spatial distribution of the 
points of interest. Now, in a similar way to Equations 5.3 through 5.5, the dynamics of the 
DPS system is explained by
	
y
P
u
P
u
xs
xsxd
xd
xsxa
xa
=
+
	
(5.6)
	
y
P
u
P
u
xo
xoxd
xd
xoxa
xa
=
+
	
(5.7)
	
u
G F r
H y
n
d
d
xa
xs
e
i
=
−
+
+
+
[
(
)
]
	
(5.8)
	
u
M d
d
xd
o
=
+
	
(5.9)
	
e
F r
H y
n
xs
=
−
+
(
)	
(5.10)
where Px2x1 denote the Laplace TF between the input x1 (x1 = xa or xd) and the output x2 
(x2 = xs or xo). The signals uxd, uxa, e, yxo, and yxs represent the external disturbances, the 
actuator, the error, the control objective, and the sensor output, respectively.
Using Equations 5.6 through 5.10, and after some straightforward algebraic manipula­
tion, the expressions for the DPS 2DOF feedback structure of Figure 5.3 are
	
y
P
P
GH G F r
d
H n
d
P
P
GH u
xs
xsxa
xsxa
e
i
xsxd
xsxa
xd
=
+
+
−
+
+ +
1
1
[ (
)
]
	
(5.11)
Sensor
Disturbances
Actuator
+
+
–
+
+
+
xd
xo
xs
xa
+
+
+
+
Control
objective
uxd(s)
uxa(s)
do(s)
d(s)
n(s)
di(s)
de(s)
r(s)
yxo(s)
yxs(s)
M(s)
H(s)
F(s)
e(s)
G(s)
FIGURE 5.3
Generalized 2DOF DPS control system structure.137

123
Distributed Parameter Systems
	
y
P
P
GH G F r
d
H n
d
P
P
P
GH
P
xo
xoxa
xsxa
e
i
xoxd
xoxa
xsxd
xs
=
+
+
−
(
)+
+
−
+
1
1
[
]
xa
xd
GH
u






	
(5.12)
	
uxa
xsxa
e
i
xsxd
xsxa
xd
P
GH G F r
d
H n
d
GHP
P
GH u
=
+
+
−
(
)+
−
+
1
1
1
[
]
	
(5.13)
	
e
P
GH F r
H n
HP
P
GH Gd
d
HP
P
G
xsxa
xsxa
xsxa
e
i
xsxd
xsxa
=
+
−
−+
+
−+
1
1
1
1
(
)
(
)
H uxd
	
(5.14)
Note that these TFs depend on the compensator G, prefilter F, sensor dynamics H, and 
the spatial distribution and topology through the four TFs Pxs xa, Pxo xa, Pxs xd, and Pxo xd, and 
where uxd = M d + do.
The new four TFs {Pxs xa, Pxo xa, Pxs xd, Pxo xd} describe the relationship between inputs 
and outputs at the points of interest (xa, xd, xs, xo). These TFs are a representation of the 
PDEs that preserve the distributed spatial configuration of the problem. Furthermore, 
the ­implementation of the problem with these rational expressions allows the designer to 
use classical control theory tools related to Laplace TFs.
Remark 5.1
A useful characteristic of the proposed methodology is the fact that the points of interest 
(xa, xd, xs, and xo) may not be fixed at a particular location. They can slowly move along in 
space or else the current location be uncertain. In other words, the application of the actua­
tor, disturbance, sensor, and control objective may not be defined at a single point but at a 
distribution of points.
Remark 5.2
A potential problem to be addressed when applying this control design ­methodology is 
the definition of the TFs {Pxs xa, Pxo xa, Pxs xd, and Pxo xd}, which being rational must also comply 
with the distributed nature of the system. See Section 5.2 for details.
Remark 5.3
Note that the 2DOF DPS control structure proposed here (Figure 5.3) is a generalization 
of the classical lumped control diagram (Figure 5.2). Consider for instance the case where 
the sensor, the control objective, and the application of the disturbance d are at the same 
point, that is, xs = xo = xd in Figure 5.3. Then, the TFs turn out to be P = Pxs xa = Pxo xa and Pxo 
xd = Pxs xd = 1. Hence, substituting these equivalences in Equation 5.12, the control objective 
expression becomes
	
y
y
G
H n
M
xo
xs
xs xa
xs xa
e
i
xs xa
o
P
P
GH
Fr
d
d
P
GH
d
d
=
=
+
+
+
+
+
+
−
(
)
1
1
1
[
]
(
)
	
(5.15)
which matches the classical lumped system shown in Figure 5.2 and Equation 5.3, being 
the lumped TF for the system plant P = Pxs xa.

124
Robust Control Engineering
5.4  Extension of QFT to DPS7,137
In the early 1980s, Professor Horowitz proposed to Kannai an interesting mathemati­
cal task: the analysis of the causality and stability of linear systems described by par­
tial differential operators.137,344 Some years later, and based on these preliminary results, 
Horowitz and Azor130,131 developed the very first QFT approach to DPSs. The method was 
a two-variable generalization (complex variables s1 and s2) of the QFT design technique 
developed for lumped uncertain plants. It required a three-dimensional (3D) Bode dia­
gram and a double Laplace transform for the 1D or x-space problem; a four-dimensional 
(4D) Bode diagram and a triple Laplace transform for the two-dimensional (2D) or xy-
space problem; and a five-dimensional (5D) Bode diagram and a quadruple Laplace trans­
form for the 3D or xyz-space problem. The method also required the implementation of a 
nonrealistic continuous feedback loop at every single point of the spatial distribution.133
Some years later, and based on new results achieved by Horowitz, Kannai, and 
Kelemen,134,135 a one-point feedback approach to DPSs was presented. The methodology 
was more realistic, dealing with only a single output point at a time. However, no guide­
lines to solve the practical system difficulties were included.
Meanwhile, Chait et al.132 presented a new Nyquist stability criterion for DPS, as well as 
studied the “spillover” effects of the truncation of DPS models; and Hedge and Nataraj136 
developed a two-point feedback approach.
In October 2000, at the Public University of Navarre (Spain), and during one of his last 
public presentations, Professor Horowitz challenged Professor García-Sanz and his PhD 
students to explore new ideas related to DPS and QFT.137 This chapter is a consequence of 
these original conversations with Professor Horowitz, and explains the resulting meth­
odology to design a one-point feedback QFT controller for DPSs with uncertainty. The 
previous section just described the proposed 2DOF control structure for DPS; this section 
introduces the extension of QFT to DPS; and next section includes an illustrative example.
As for the lumped approach – see Section 2.7 and Equations 2.35 through 2.41 from 
Equations 2.32 to 2.34, the DPS-generalized TFs Tk(jωi) extracted from Equations 5.11 to 
5.14 and Figure 5.3 are shown in Table 5.1 as inequality performance specifications—see 
Equations 5.16 through 5.25. Subsequently, as we did with lumped systems—see Equations 
2.42 through 2.48, they are translated into quadratic inequalities in Table 5.2—see Equations 
5.26 through 5.35.
When extending the lumped QFT methodology to the DPS case, one of the main differ­
ences encountered is the fact that the set of plants Px2 x1 (jωi) = {Px2 x1 (jωi) ωi ∈ Ωk} not only 
includes parametric and nonparametric uncertainty related to physical characteristics of 
the model, but also uncertainty related to the location of the inputs and outputs xa, xd, xs, 
and xo.
Now, the QFT nominal plant corresponds to Pxs xa0 ∈ Pxs xa(jωi), and the templates and QFT 
bounds consider the uncertainty related to the complete DPS model, with the TFs: {Pxs xa, 
Pxo xa, Pxo xd, and Pxs xd}.
Remark 5.4
Based on Remark 5.1, as this proposed methodology can deal with uncertainty at the loca­
tion of the points xa, xd, xs, and xo, the QFT templates of Px1 x2 are expanded to include this 
spatial uncertainty.

125
Distributed Parameter Systems
TABLE 5.1
Feedback specifications for DPS when H = 1.
k
Inequalities
Equations
1
T j
y
j
F j
r j
y
j
n j
y
j
d j
P
xo
xo
xo
e
xoxa
1(
)
(
)
(
) (
)
(
)
(
)
(
)
(
)
(
ω
ω
ω
ω
ω
ω
ω
ω
=
=
=
=
j
G j
P
j
G j
xsxa
ω
ω
ω
ω
δ ω
ω
) (
)
(
) (
)
( )
1
1
1
+
≤
∈
,
Ω
(5.16)
2
T j
y
j
u
j
P
j
P
j
P
j
G j
P
xo
xd
xoxd
xoxa
xsxd
2
1
(
)
(
)
(
)
(
)
(
)
(
) (
)
ω
ω
ω
ω
ω
ω
ω
=
=
−
+
xsxa j
G j
(
) (
)
( )
ω
ω
δ ω
ω
≤
∈
2
2
,
Ω
(5.17)
3
T j
u
j
F j
r j
u
j
d j
u
j
n j
G j
xa
xa
e
xa
3
1
(
)
(
)
(
) (
)
(
)
(
)
(
)
(
)
(
)
ω
ω
ω
ω
ω
ω
ω
ω
ω
=
=
=
=
+
≤
∈
P
j
G j
xsxa(
) (
)
( )
ω
ω
δ ω
ω
3
3
,
Ω
(5.18)
4
T j
u
j
u
j
P
j
G j
P
j
G j
xa
xd
xsxd
xsxa
4
4
1
(
)
(
)
(
)
(
)
(
)
(
) (
)
( )
ω
ω
ω
ω
ω
ω
ω
δ ω
=
=
+
≤
, ω ∈Ω4
(5.19)
5
δ
ω
ω
ω
ω
ω
ω
ω
ω
5
5
1
lo
xo
xoxa
xsxa
T j
y
j
r j
F j
P
j
G j
P
j
( )
(
)
(
)
(
)
(
)
(
) (
)
(
)
≤
=
=
+
G j
P
j
G j
P
j
G j
P
up
xoxad
xoxae
xsxae
(
)
( )
(
) (
)
(
) (
)
(
ω
ω
ω
ω
ω
ω
ω
≤
∈
+
δ5
5
1
,
Ω
j
G j
P
j
G j
xsxad
up
lo
ω
ω
ω
ω
δ ω
ω
ω
ω
) (
)
(
) (
)
( )
( )
( )
1
5
5
5
5
+
≤
=
∈
δ
δ
,
Ω
(5.20)
6
T j
e j
F j
r j
e j
n j
u
j
d j
P
j
xa
i
xsxa
6
1
1
(
)
(
)
(
) (
)
(
)
(
)
(
)
(
)
(
ω
ω
ω
ω
ω
ω
ω
ω
=
=
=
=
+
ω
ω
δ ω
ω
) (
)
( )
G j
≤
∈
6
6
,
Ω
(5.21)
7
T j
e j
u
j
y
j
u
j
P
j
P
j
G j
xd
xs
xd
xsxd
xsxa
7
1
(
)
(
)
(
)
(
)
(
)
(
)
(
) (
ω
ω
ω
ω
ω
ω
ω
=
=
=
+
ω
δ ω
ω
)
( )
≤
∈
7
7
,
Ω
(5.22)
8
T j
e j
d j
y
j
F j
r j
y
j
n j
y
j
d
e
xs
xs
xs
8(
)
(
)
(
)
(
)
(
) (
)
(
)
(
)
(
)
ω
ω
ω
ω
ω
ω
ω
ω
ω
=
=
=
=
e
xsxa
xsxa
j
P
j
G j
P
j
G j
(
)
(
) (
)
(
) (
)
( )
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
∈
1
8
8
,
Ω
(5.23)
9
T j
e j
d j
y
j
d j
P
j
P
j
G j
i
xs
i
xsxa
xsxa
9
1
(
)
(
)
(
)
(
)
(
)
(
)
(
) (
)
ω
ω
ω
ω
ω
ω
ω
ω
=
=
=
+
≤≤
∈
δ ω
ω
9
9
( ),
Ω
(5.24)
10
T
j
y
j
d j
P
j
P
j
G j
xo
i
xoxa
xsxa
10
10
1
(
)
(
)
(
)
(
)
(
) (
)
( )
ω
ω
ω
ω
ω
ω
δ
ω
ω
=
=
+
≤
∈
,
Ω10
(5.25)

126
Robust Control Engineering
TABLE 5.2
Quadratic inequalities for DPS with H = 1.
k
Inequalities
Equations
1
p
p
g
p
g
xsxa
xoxa
xsxa
xsxa
2
2
1
2
2
2
1
0
−






+
+
+ ≥
δ
φ
θ
cos(
)
(5.26)
2
p
p
p
p
p
p
p
p
p
xsxa
xsxa
xoxd
xoxa
xsxd
xsxa
xoxd
xoxa
xsxd
2
2
2
2
−
(
) +(
) −
cos −
−
+
(
)






+
θ
θ
θ
θ
xsxa
xoxd
xoxa
xsxd
δ2
2

+
+
−
+
g
p
p
p
p
xsxa
xsxa
xoxd
xsxa
xoxd
xsxa
2
2
2
cos (
)
cos
φ
θ
φ
θ
(
)−
−
+
−
(
)









−
p
p
xoxa
xsxd
xsxd
xoxd
xoxa
cos
φ
θ
θ
θ
δ2
2




+
−





≥
g
pxoxd
1
0
2
2
2
δ
(5.27)
3
p
g
p
g
xsxa
xsxa
xsxa
2
3
2
2
1
2
1
0
−






+
+
+ ≥
δ
φ
cos(
)
θ
(5.28)
4
p
p
g
p
g
xsxa
xsxd
xsxa
xsxa
2
2
4
2
2
2
1
0
−






+
+
+ ≥
δ
φ
θ
cos(
)
(5.29)
5
p
p
p
p
g
p
p
xoxae
xsxad
xoxad
xsxae
xoxae
2
2
2
2
5
2
2
2
2
−






+
δ
xsxad
xsxad
xoxad
xsxae
xsxae
p
p
cos
cos
φ
θ
φ
θ
δ
+
(
)−
+
(
)





2
5
2

+
−





≥
g
p
p
xoxae
xoxad
2
2
5
2
0
δ
(5.30)
6
p
g
p
g
xsxa
xsxa
xsxa
2
2
6
2
2
1
1
0
+
+
+
−





≥
cos(
)
φ
θ
δ
(5.31)
7
p
g
p
g
p
xsxa
xsxa
xsxa
xsxd
2
2
2
7
2
2
1
0
+
+
(
)
+
−





≥
cos φ
θ
δ
(5.32)
8
p
g
p
g
xsxa
xsxa
xsxa
2
8
2
2
1
1
2
1
0
−






+
(
)
+ ≥
+
δ
φ
θ
cos
(5.33)
9
p
g
p
g
p
xsxa
xsxa
xsxa
xsxa
2
2
2
9
2
2
1
0
+
+
(
)
+
−





≥
cos φ
θ
δ
(5.34)
10
p
g
p
g
p
xsxa
xsxa
xsxa
xoxa
2
2
2
10
2
2
1
0
+
+
(
)
+
−



≥
cos φ
θ
δ
(5.35)

127
Distributed Parameter Systems
Remark 5.5
When controlling any DPS by a one-point feedback structure, some limitations due to the 
spatial distribution arise. In particular, and because of the position of Pxo xd in Equation 
5.12, the compensator G cannot control the effect of the disturbance uxd at the output yxo. 
Also, for the same reason, there is no solution to the DPS problem if Pxo xd has poles in 
the RHP.
EXAMPLE 5.1: HEAT CONDUCTION, DISTRIBUTED TEMPERATURE
This section applies the QFT DPS control design methodology introduced in this chap­
ter to a well-known heat transmission problem. Additional information can be found 
in Reference 134.
Description
Consider the heat transmission problem with a temperature-distributed prismatic plant 
shown in Figure 5.4, whose PDE model is
	
∂
∂
∂
∂
∈
≥
∈
=
−
=
=
T
t
T
x
x,t
x
t
T x
x
T
t
T
t
2
2
(
),
(0, ),
0
( ,0)
0,
[0,
(0, )
(
υ
π
π
π
]
, )
0;
(
)
(
)(
)
0
=
=
=
=
υ
δ
δ
x,t
t
x
xi 	
(5.36)
where yxs(x,t) = T(x,t) and uxa(x,t) = υ(x,t) are the temperature and heat input, respec­
tively. It is assumed that the sensor and the actuator points match up at xs = xa, and 
disturbances are applied at the control objective point xo and at the sensor point xs. In 
this example, we design a one-feedback loop to achieve robust stability and robust dis­
turbance rejection and reference tracking specifications at xo and xs.
Modeling
This heat transmission problem, described by the PDE in Equation 5.36 and Figure 5.4, 
can also be modeled as the irrational TF shown in Equation 5.37, which represents at 
+
π/4
π/4
(π/2) ± 10%
of uncertainty
Heater
–
r
xs = xa
uxa
yxs
xo = xd
yxo
uxd
dxs
G(s)
F(s)
FIGURE 5.4
Heat transmission problem. Temperature-distributed prismatic plant.

128
Robust Control Engineering
time t the behavior of the temperature T(x,t) at the point x of the distributed prismatic 
plant under a heat input υ(xi,t) at the point xi—see also Kelemen et al.134
	
P
s
e
e
e
e
s e
e
x xi
s
x
s
x
s x
s x
s
s
i
i
( )=
−
(
)
−
(
)
−
(
)
−
−
−
−
−
(
)
(
)
π
π
π
π
2
	
(5.37)
As detailed in Section 5.2, the irrational solution calculated for the problem can be 
either transformed into a sum of terms or into a product of terms. In this case, since 
Equation 5.36 is a parabolic equation, an equivalent electrical model of the plant is 
chosen (see Figure 5.5). Solving the resultant system for a number of Π-element cases, 
the respective groups of rational TFs Pxoxd, Pxoxa, Pxsxd, Pxsxa can be obtained. The param­
eters used in this example are the distances k1, k2, and k3 [m], the resistance per meter 
R = 1/kA, and the capacitance per meter c = ρ CP A, where ρ is the density (kg/m3), k is 
the thermal conductivity (W/(m °C)), CP is the specific heat capacity (J/(kg °C)), and A is 
the section area (m2). This electric circuit can be easily solved applying classical circuit 
techniques, resulting in the following expression [Y] = [Q]‒1 [U]:
	
y
y
k
k
k
k
k
k
k
k
xo
xs
R
cs
R
cs
R
R
R






=
+
+
+
−
−
+
1
2
1
1
2
1
1
1
1
2
1
1
2
2
2
2
2
1
2
3
3
1
1
1
1
2
cs
R
cs
T
R
T
k
k
k
k
uxd
c
uxa
c
+
+
+
+






−
3R
dxs
+






	
(5.38)
Calculating the inverse matrix, [P] = [Q]‒1, we have [Y] = [P] [U], or
	
y
y
P
P
P
P
u
T
k R
u
T
xo
xs
xo xd
xo xa
xs xd
xs xa
xd
c
xa
c





=






+
+
1
k R
dxs
3
+






	
(5.39)
+
–
r
2
π/4
π/4
(π/2) ±10%
of uncertainty
+
Tc = 0
xo = xd
xs = xa
Tc = 0
k1R
k2R
yxo
yxs
uxd
dxs
uxa
k1c
2
k1c
2
k2c
2
k2c
k3R
2
k3c
2
k3c
G(s)
F(s)
FIGURE 5.5
Π-equivalent electrical model.

129
Distributed Parameter Systems
where the transfer matrix [P] contains the elements
	
Pxo xd
Rk
Rck k k
k
s
k
k
=
+
+
+
2
2
1
2
2
3
3
2
2
3
σ[
(
)
(
)] 	
(5.40)
	
P
Rk k
xo xa =4
1 3σ 	
(5.41)
	
P
Rk k
xs xd =4
1 3σ 	
(5.42)
	
P
Rk
Rck k k
k
s
k
k
xs xa =
+
+
+
2
2
3
1
1 2
2
2
1
2
σ[
(
)
(
)] 	
(5.43)
with
	
σ =
+
+
1
1
2
2
3
a s
a s
a 	
(5.44)
	
a
R c k k k k k
k k
k k
k
1
2 2
1 2
3
1 2
1 3
2
3
2
2
=
+
+
+
(
) 	
(5.45)
	
a
Rc k k
k k
k k
k k k
k k
k k
k k
2
1
2
2
1
2
3
1 2
2
1 2
3
1 3
2
2
2
3
2
3
2
2
2
=
+
+
+
+
+
+
(
) 	
(5.46)
	
a
k
k
k
3
1
2
3
4
=
+
+
(
) 	
(5.47)
Now, introducing the fixed parameters k1 = π/4, k2 = π/4, and Tc = 0, and the uncer­
tain parameters k3 ∈ [0.45π, 5.5π], R ∈ [0.9, 1.1], and c ∈ [0.9, 1.1], we calculate the uncer­
tain plants and generate the QFT templates.
The MATLAB code (mfile) that calculates the plants, first in symbolic math (Q and P), 
and then as TFs with parametric uncertainty (Pxoxd, Pxsxd, Pxoxa, and Pxsxa), is 
presented in Appendix 5. After saving them in the disk, these TFs are introduced in the 
QFTCT, plant definition window, load transfer function array, as shown in Figure 5.6a.
In addition, in order to introduce the specification yxo/uxd, the TF B1=PxsxaPxoxd-
PxoxaPxsxd is also included. This specification is introduced later by using the “define 
by user” option in the specifications window of the QFTCT, with A = Pxoxd, B = B1, 
C = 1, D = P.
The system plant in the plant definition window is Pxsxa(s). The QFT templates for the 
system plant and frequencies of interest are shown in Figure 5.6b.
Control Specifications
The system performance specifications are selected according to the following 
requirements:
	
1.	 Stability at xs and x0
	
It is defined by the most restrictive condition of the two expressions
	
P
G
G
xs xa
xs xa
P
.
1
1 6 0 0005
1000
+
≤
≤
≤
, .
ω
rad/s
	
(5.48)
	
P
G
P
G
xo xa
xs xa
1+
≤
≤
≤
1.6
rad/s
,
.0 0005
1000
ω
	
(5.49)

130
Robust Control Engineering
	
2.	 Disturbance rejection at x0
	
yxo
xd
xoxd
xoxa
xsxd
xsxa
xoxd
u
P
P
P
G
P
G
P
=
−
+
≤
≤
≤
1
0 9
0 005
0 1
.
, .
.
ω
rad/s
	
(5.50)
	
3.	 Disturbance rejection at xs
	
yxs
xs
xs xa
o
d
P
G
s
s
=
≤
=
+
+
≤
≤
1
1
700
700
2
0 0005
10
δ
ω
( )
, .
ω
rad/s
	
(5.51)
	
4.	 Reference tracking specification at xs.
	
δ
δ
ω
ω
ω
lo
xsxa
xsxa
up
P
G
P
G F
( )
( ) .
≤
+
≤
≤
≤
1
0 0005
1 rad/s
	
(5.52)
	
	 where
	
δ
ω
ω
ω
lo
j
j
( )
(
)
(
)
=
+
+
0.98
isthe lower bound
20
250
1
2
	
Open-loop phase (deg)
–80
–70
–60
–50
–40
–30
–20
–10
0
Open-loop magnitude (dB)
–25
–20
–15
–10
–5
0
QFTCT
(a)
(b)
10 rad/s
5 rad/s
1 rad/s
0.5 rad/s
0.1 rad/s
0.05 rad/s
0.01 rad/s to 
0.0005 rad/s
FIGURE 5.6
QFTCT. (a) Plant definition window. TFs imported from disk. (b) Templates window: Pxs xa(s) system plant 
templates.

131
Distributed Parameter Systems
	
	 and
	
δ
ω
ω
ω
ω
up
j
j
j
( )
(
)
.
(
)
(
)
=
+
+
+
20
1 02
20
100
1
2
is the upper bound
	
Controller Design
The robust stability bounds for Equation 5.48 are obtained from the quadratic 
inequalities given by Equation 5.33. The robust stability bounds for Equation 5.49 
are calculated from the quadratic inequalities given by Equation 5.26. The robust 
disturbance rejection bounds for Equations 5.50 and 5.51 are found from the qua­
dratic inequalities given by Equations 5.27 and 5.31, respectively. The robust refer­
ence tracking bounds for Equation 5.52 are obtained using the quadratic inequalities 
given by Equation 2.47, with P(s) = Pxsxa(s) in Equation 2.40. The nominal open-loop is 
L1 = G1 Pxsxa0.
The G1(s) controller is designed using a standard loop shaping QFT technique—see 
Equation 5.53. Figure 5.7 shows the NC for the loop TF L1 with the proposed compensa­
tor G1(s).
	
G s
s
s s
1( )
0
0.004)
1)
100)
1)
=
+
+
.
((
((
0043
/
/
	
(5.53)
Open-loop phase (deg)
–200
–150
–100
–50
0
Open-loop gain (dB)
–80
–60
–40
–20
0
20
40
60
QFTCT
0.001 rad/s
5 rad/s
50 rad/s
10 rad/s
0.0005 rad/s
1 rad/s
0.01 rad/s
0.005 rad/s
0.05 rad/s
0.5 rad/s
0.1 rad/s
L1 = Pxsxa0G1
FIGURE 5.7
Loop shaping for the controller G1, with the open-loop TF: L1 = Pxsxa0 G1.

132
Robust Control Engineering
Finally, a prefilter F1(s) is designed to meet the reference tracking specifications. The 
expression is shown in Equation 5.54 and the Bode diagram in Figure 5.8.
	
F s
s
s
s
s
1( )
0.0021)
1)((
2.9)
1)
0.0045)
1)((
0.009)
1)
=
+
+
+
+
((
((
/
/
/
/
	
(5.54)
Simulations
Figures 5.9 through 5.11 show the results at the points xs and xo. They are obtained 
­applying  the controller G1(s) and the prefilter F1(s) to 125 plants within the space of 
Frequency (rad/s)
102
101
100
10–1
10–2
10–3
Magnitude (dB)
–120
–100
–80
–60
–40
–20
0
20
QFTCT
δup
δlo
PxsxaG1F1/(1 + PxsxaG1)
with uncertainty in the plant
FIGURE 5.8
Prefilter design for the plant Pxsxa with uncertainty, the compensator G1 and the prefilter F1. Reference tracking 
specs according to Equation 5.52.
Frequency (rad/s)
10–3
10–2
10–1
100
101
Magnitude (dB)
–10
–8
–6
–4
–2
0
QFTCT
Worst case at each freq.
Time (s)
0
500
1000
1500
2000
2500
3000
3500
4000
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δop
δup
δlo
Up to 5 rad/s
(a)
(b)
FIGURE 5.9
Results at point xs with G1 and F1. (a) Disturbance rejection yxs/dxs, Equation 5.51. (b) Reference tracking yxs/r, 
Equation 5.52, with unitary step input r.

133
Distributed Parameter Systems
parametric uncertainty (see Appendix 5). The system is closed-loop stable and meets well 
the specifications for the disturbance rejection and reference tracking problems in all cases.
Note
Each rational TF used in this problem (Pxoxd, Pxoxa, Pxsxd, and Pxsxa) is composed of a single 
Π-element (see Figure 5.5). In other problems, a more complex modeling, involving mul­
tiple Π-elements for each TF, can be necessary. The same controller design technique 
Time (s)
0
0.5
1
1.5
2
2.5
3
3.5
4
–0.9
–0.8
–0.7
–0.6
–0.5
–0.4
–0.3
–0.2
–0.1
0
QFTCT
Time (s)
0
200
400
600
800 1000 1200 1400 1600 1800 2000
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
QFTCT
(a)
(b)
FIGURE 5.10
Results at point xs with G1 and F1. Disturbance rejection yxs/dxs, Equation 5.51. Output yxs after (a) unitary 
impulse input dxs and (b) unitary step input dxs.
Time (s)
0
5
10
15
20
25
30
35
40
45
50
–0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
QFTCT
Time (s)
0
200
400
600
800
1000 1200 1400 1600 1800 2000
–2.5
–2
–1.5
–1
–0.5
0
0.5
QFTCT
(a)
(b)
FIGURE 5.11
Results at point xo with G1 and F1. Disturbance rejection yxo/uxd, Equation 5.50. Output yxo after (a) unitary 
impulse input uxd and (b) unitary step input uxd.

134
Robust Control Engineering
can be applied in these cases with TFs with more Π-elements. Figure 5.12 shows how 
the equivalent electrical models for 3, 4, and 8 Π-elements approximate the irratio­
nal expression of Equation 5.37. According to Anderson and Parks,346 the number of 
Π-elements is valid for the frequencies ω < 2/(Rc), where R and c are, respectively, the 
resistance and capacitance per length in each Π-element.
5.5  Summary
There is no need for very complex methodologies to design controllers for DPS. On the con­
trary, using the practical approach presented in this chapter, classical QFT methods based 
on new bound definitions can be applied to solve DPS control problems. A spatial distribu­
tion of the location of the relevant points was considered, allowing the designer to place 
the actuator, disturbances, sensor, and control objectives in any spatial location of interest, 
including location uncertainty. From this topology, new stability and performance specifi­
cations, TFs, and quadratic inequalities for DPS were introduced. The simplicity and excel­
lent practical results of the methodology are illustrated with a well-known PDE example.
5.6  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Example 5.1. Heat transmission system with distributed temperature.
•	 Appendix 5. MATLAB code for Example 5.1.
10–2
10–1
100
101
Magnitude (dB)
–100
–50
0
–25
–20
–15
–10
–5
0
Phase (deg)
Frequency (rad/s)
8 PI model
3 PI model
4 PI model
Irrational model
Irrational model
8 PI model
3 PI model
4 PI model
Pxsxa
FIGURE 5.12
Bode diagram for Pxsxa0 according to the irrational model Equation 5.37, and the rational electric circuit approach 
given by 3, 4, and 8 Π-elements. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: 
Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, 
Taylor & Francis Group, Boca Raton, FL; Garcia-Sanz, M., Huarte, A., and Asenjo, A. 2007. Int. J. Robust Nonlinear 
Control, 17(2–3), 135–153.)

135
6
Gain Scheduling/Switching Control Solutions
6.1  Introduction
This chapter introduces a hybrid methodology to design nonlinear robust control systems 
able to go beyond the classical linear limitations. Combining robust controller designs 
and stable switching, the new system optimizes the time response of the plant by fast 
adaptation of the controller parameters during the transient response according to certain 
rules based on the amplitude of the error. The methodology is based on both a graphical 
frequency-domain stability criterion for switching linear systems and the use of the robust 
QFT control system design technique.
Switching control has demonstrated to be an efficient tool in achieving tight performance 
specifications in control systems.329,334 The way to reach this enhancement is by design­
ing various parallel controllers with different characteristics, and continuously selecting 
among them the optimum one that controls the system best (Figure 6.1). Performance 
specifications that are not achievable by a simple linear controller, as the limitation theory 
predicts,330 can be attained through suitable switching rules.
One of the main issues in switching control techniques is that the system stability is not 
assured a priori, even if the switching is made between stable controllers. This is the rea­
son why most of the current literature about switching systems is still devoted to stability 
issues. See References 326–336 for general results about stability criteria and applications 
to some practical cases.
This chapter introduces a nonlinear switching robust controller design methodology, 
including a graphical frequency-domain criterion to ensure the system stability and sev­
eral illustrative examples.
6.2  System Stability Under Switching7,163
Figure 6.1 shows the general scheme to be used with the switching control system. A set 
of controllers is designed and a supervisor selects the most suitable one, depending on the 
state of the system and/or some external parameters.
One of the main difficulties found when switching techniques are applied is that, in 
general, the system stability is not assured, even if switching is made between stable 

136
Robust Control Engineering
controllers. Some extra conditions must be met to assure stability. In particular, it is proven 
that a system represented by
	
x
A
x
A
A
A
A
( )
( ) ( ),
( )
{
,
,
,
Hurwitz
1
t
t
t
t
m
i
=
∈
=
A
...
}
	
(6.1)
with arbitrary switching within the set of matrices A is exponentially stable if and only if 
there exists a common Lyapunov function (CLF) for all Ai in the set A.328
It also has been proven that the existence of a common quadratic Lyapunov function (CQLF) 
is a sufficient condition for exponential stability.331 In this context, the main issue in linear 
switching systems is finding conditions under which the existence of a CQLF is assured. In 
particular, the circle criterion (see Section 7.2) provides the necessary and ­sufficient conditions 
for the existence of a CQLF for two systems in companion form,326,327,335 that is, the systems
	
x
A x
( )
( )
t
t
=
	
(6.2)
	
x
A
g
x
( )
(
) ( )
t
t
T
=
−Δ
	
(6.3)
with
	
A =
−
−
−
−
−



−
−
0
1
0
0
0
0
0
1
0
0
0
0
0
0
0
0
0
0
0
1
0
1
2
2
1











e
e
e
e
e
n
n




=






,
,
g
0
0
0
0
1

Δ =






−
−
Δ
Δ
Δ
Δ
Δ
e
e
e
e
e
n
n
0
1
2
2
1

	
(6.4)
have a CQLF if and only if
	
1
0
1
+
−
>
=
,
−
Re{
(
)
}
,
ΔT s
s
j
I
A
g
ω
ω
for all frequency
	
(6.5)
This chapter considers stability for arbitrary switching between two closed-loop systems 
with transfer functions T1(s) = L1(s)/[1 + L1(s)] and T2(s) = L2(s)/[1 + L2(s)], both stable. For 
Controllers
Supervisor
R(s)
G1(s)
G2(s)
Gn(s)
H(s)
P(s)
Y(s)
E(s)
Plant
+–
FIGURE 6.1
Switching control scheme. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)

137
Gain Scheduling/Switching Control Solutions
these two transfer functions, L1(s) = P(s)G1(s) and L2(s) = P(s)G2(s) are proper. Additionally, 
L1(s) and L2(s) have the same number of poles, and the same number of zeros. The switch­
ing takes place by changing the gain and the position of the poles and zeros. The open-
loop transfer functions for both systems are:
	
L s
b
s
b
s
a
s
a
N s
D s
n
n
n
n
n
1
1
1
0
1
1
0
( )
( )
( )
=
+
+
+
+
+
=
−
−
−
−


	
(6.6)
and
	
L s
b
b
s
b
b
s
a
a
s
a
n
n
n
n
n
n
n
2
1
1
1
0
0
1
1
1
0
( )
(
)
(
)
(
)
(
=
+
+
+
+
+
+
+
+
−
−
−
−
−
−
Δ
Δ
Δ


+
=
+
+
Δ
Δ
Δ
a
N s
N s
D s
D s
0)
( )
( )
( )
( ) 	
(6.7)
For the sake of clarity, and without losing generality, in this analysis a general expres­
sion where the order of the numerator is one less than that of the denominator is used. If it 
is not the case, then some bi coefficients can be zero. The closed-loop transfer functions are
	
T s
L s
L s
N s
D s
N s
1
1
1
1
( )
( )
( )
( )
( )
( )
=
+
=
+
	
(6.8)
and
	
T s
L s
L s
N s
N s
D s
D s
N s
N s
2
2
2
1
( )
( )
( )
( )
( )
( )
( )
( )
( )
=
+
=
+
+
+
+
Δ
Δ
Δ
	
(6.9)
where the characteristic equations are
	
D s
N s
s
e
s
e s
e
n
n
n
( )
( )
+
=
+
+
+
+
−
−
1
1
1
0

	
(6.10)
and
	
D s
D s
N s
N s
s
e
e
s
e
e
n
n
n
n
( )
( )
( )
( )
(
)
(
)
+
+
+
=
+
+
+
+
+
−
−
−
Δ
Δ
Δ
Δ
1
1
1
0
0

	
(6.11)
with ei = ai + bi and Δei = Δai + Δbi.
Using these expressions for the coefficients ei and Δei, the matrices A, g, and Δ are defined. 
Now the circle criterion is applied to guarantee stability under arbitrary ­switching as
	
(
)
s
s
e
s
e s
e
n
n
n
I
A
−
=
+
+
+
+
−
−
−
1
1
1
1
0

	
and
	
Δ
Δ
Δ
Δ
T
n
n
e
s
e s
e
g =
+
+
+
−
−
1
1
1
0

	

138
Robust Control Engineering
Equation 6.5 becomes
	
1
1
1
1
0
1
1
1
0
+
+
+
+
+
+
+
+








−
−
−
−
Re Δ
Δ
Δ
e
s
e s
e
s
e
s
e s
e
n
n
n
n
n


>>
=
0,
s
jω
	
(6.12)
for all frequency ω. After some simple manipulation,
	
Re 1
1
1
1
0
1
1
1
0
+
+
+
+
+
+
+
+








−
−
−
−
Δ
Δ
Δ
e
s
e s
e
s
e
s
e s
e
n
n
n
n
n


=
+
+
+
+






Re
( )
( )
( )
( )
( )
( )
N s
N s
D s
D s
N s
D s
Δ
Δ
	
	
=
+
+
+
+
+
Re (
( )
( )
( )
( ))/(
( )
( ))
(
( )
( ))/
( )
(
N s
N s
D s
D s
N s
N s
N s
D s
N s
N s
Δ
Δ
Δ
)
( )
( )
Re
( )
( )
(
+














=
+
+
ΔN s
N s
L s
L s
D s
1
1
2
1
)
( )
( )
+














ΔD s
D s
	
(6.13)
the condition can be expressed in the following form:
	
Re
( )
( )
( )
( )
( )
1
1
0
2
1
+
+
+














>
L s
L s
D s
D s
D s
Δ
,
s
j
= ω
	
(6.14)
for all frequency ω.
As this formulation of the circle criterion is applied to open-loop transfer functions, due 
to symmetry, it is sufficient to check it at only positive frequencies. The Equation 6.14 con­
dition is then equivalent to
	
arg{
(
)}
arg{
(
)}
arg
(
)
(
)
(
)
1
1
2
1
+
−
+
+
+







L j
L j
D j
D j
D j
ω
ω
ω
ω
ω
Δ


< π
2 	
(6.15)
for all ω ≥ 0.
By denoting the following expressions:
	
ϕ
ω
ω
ω
12
2
1
1
1
( )
arg{
(
)}
arg{
(
)}
°=
+
−
+
L j
L j
	
(6.16)
	
α ω
ω
ω
ω
( )
arg
(
)
(
)
(
)
°=
+








D j
D j
D j
∆
	
(6.17)
and using the triangle inequality, a sufficient condition for Equation 6.15 is:
	
ϕ
ω
α ω
12
90
( )
( )
° <
°−
° 	
(6.18)
degrees for all ω ≥ 0.

139
Gain Scheduling/Switching Control Solutions
With this result, the criterion can be applied graphically to both the Complex plane and 
the Nichols diagram. In the first case, the criterion is expressed by requiring L1(jω) and L2(jω) 
to be inside of an arc of [90o – α(ω)o] degrees around the critical point (–1,0) at each frequency.
Similarly, in the Nichols diagram the condition based upon angles is easily checked by 
plotting [1 + L1(jω)] and [1 + L2(jω)], and the distance of ϕ12(ω) on the horizontal axis at each 
frequency. To assure stability, this distance should be less than [90o – α(ω)o] degrees.
It is noted that the function α(ω) can also be expressed according to Equation 6.19, so 
that it may be considered as a measurement of the change of the controller poles, as shown 
in Figure 6.2. Consequently, the larger the movement made by the poles, the larger the 
conservativeness introduced by the triangle inequality of Equation 6.18. Note that for each 
frequency ωi there is a different angle α(ωi)o,
	
α ω
ω
ω
ω
ω
( )
arg
(
)
(
)
(
)
arg
(
)
° =
+








=
+
+
=
D j
D j
D j
j
p
p
j
j
j
Δ
Δ
1
n
j
j
n
j
p
j
p
∏
∏
+










=
+
=
(
)
arg{
ω
ω
1
j
j
j
j
n
p
j
p
+
−
+
=∑
Δ
}
arg{
}
ω
1
	
(6.19)
At this point two questions arise. Firstly, the criterion presented above is applied to 
switching between two isolated controllers with the same structure and the same plant 
model. However, it is possible that the designer may desire to do switching among more 
than two systems, or even among an infinite number of systems, which can also be consid­
ered as a linear parameter varying (LPV) system, where the controller varies continuously. 
Secondly, real systems present uncertainty, so the criterion must be modified in some 
manner to take the uncertainty into account. The next discussion undertakes both issues.
–p2
–p1
Im
Re
–(p2 + ∆p2)
–(p3 + ∆p3)
–(p1 + ∆p1)
jωi
jωk
α2(ωi)
α1(ωi)
α3(ωi)
(0,0)
–p3
FIGURE 6.2
Complex plane. α(s) for a system with three switching poles. α(ωi)° = α1(ωi)° + α2(ωi)° + α3(ωi)°. (Adapted from 
Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part 
II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

140
Robust Control Engineering
If the switching is made among a set of several controllers, the criterion must be satisfied 
for each pair of controllers. Checking this condition may be an impossible task if there is 
more than one pole moving, because the angle α is different for each pair of controllers. For 
this reason, consider the case of a controller whose parameters change continuously with 
the error, and allow the gain and zeros to be the variables. Then, the angle α(ω)o is null for 
every frequency, and the only condition to be satisfied is that the angle between any two 
possible systems Li(jω) and the critical point (–1,0) is less than 90o. Moreover, under this 
premise the conservativeness introduced in Equation 6.18 vanishes. The condition can be 
checked graphically with a grid of the possible open-loop systems that the controller varia­
tion can generate, as shown in Figure 6.3a. The maximum angle ϕ12(ω)o must be contained 
in a 90o arc from (–1,0). In the Nichols plot, the way to apply the criterion is to draw the grid 
of possible 1 + Li(jω) systems, and check that the maximum horizontal distance is less than 
90o. Figure 6.3b illustrates the criterion on the Nichols plot.
Using similar arguments, it is also easy to deal with uncertainty. For an uncertain sys­
tem, the template TP(jω) is the area in the Nichols chart of the possible plants within the 
uncertainty at the frequency ωi. If the system is governed by a switching controller, each 
point of the template can change its position due to the switching. From this point of view, 
switching can be considered as a mechanism that modifies the position and the shape of 
the templates of [1 + Li(jω)]. To be sure that the switching is stable, the above criterion must 
be applied to the whole template.
It has been traditionally considered in robust control theory that uncertainty changes the 
plant slowly in comparison with the system dynamics. If the switching laws depend on 
the state of the system, then the switching is much faster than changes due to uncertainty. 
Consequently, for each point of the departure template there is only one corresponding point 
in the arrival template. Furthermore, it is assumed that uncertainty does not affect the angle α.
Then, the Nichols chart is a very clear diagram to test the stability of the uncertain switch­
ing system. Figure 6.4 shows the templates of [1 + Li(jω)] and the application of the method. 
If, during the displacement of each point of the first template to its corresponding point of 
the second one, the maximum horizontal distance between any two points of this path is less 
than 90o, the stability condition is satisfied at that particular frequency. Although it is a labo­
rious task, usually it is not necessary to check each point of the template at each frequency, 
because the whole set of templates are much closer together than the critical distance.7,163
(a)
Im
(–1,0)
Re
max{ϕ12(ω)}
max{ϕ12(ω)}
deg
Li(jω)
dB
90°
(b)
FIGURE 6.3
Criterion for continuous switching: (a) Complex plane, plotting Li(jω); (b) Nichols plot, plotting [1 + Li(jω)]. 
(Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: 
QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

141
Gain Scheduling/Switching Control Solutions
6.3  Methodology
Quantitative feedback theory has demonstrated to be an excellent tool to deal with sev­
eral, often conflicting, control specifications. As it is shown in the previous chapters, it is 
a transparent design technique that allows the designer to consider all the specifications 
simultaneously and in the same plot. The QFT philosophy permits the design of a control­
ler that satisfies all the performance specifications for every plant within the uncertainty, 
and using (quantifying) the minimum amount of feedback and the minimum controller 
gain at every frequency of interest.
Based on the analysis presented in the previous section, a switching control methodol­
ogy is proposed here to go beyond the classical performance limitations imposed by linear 
systems. The methodology combines the QFT robust control design method and the stable 
switching technique presented in the preceding section.
Specifically, we propose to use the error amplitude as the switching signal, so that, when 
the output is far from the reference (large error), the system needs to be more stable, and 
also faster, but precision is not so necessary. Conversely, when there is a small error, some 
amount of stability margin can be sacrificed in order to increase the low-frequency gain, 
and therefore to also increase the precision and the disturbance rejection. These ideas, 
combined with the QFT method, lead to the design procedure (Method 1), as presented by 
the following four steps:
Method 1
Li(s), i = 1,2,…,n, with gain and zeros variation, constant poles
For switching among many controllers (two or more) and for systems with uncertainty.
•	 Step 1. Preliminary controller: Obtain a preliminary linear controller for the system 
by applying the QFT robust control methodology, dealing with parametric and/
or nonparametric uncertainty (templates), time-domain and frequency-domain 
dB
max{ϕ12(ω)} < 90
Switching
Uncertainty
deg
FIGURE 6.4
Templates of [1 + Li(jω)] and stability criterion on the Nichols chart. (Adapted from Garcia-Sanz, M. and Houpis, 
C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and 
Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

142
Robust Control Engineering
specifications (QFT-bounds), and applying loop-shaping techniques, as shown in 
the previous chapters.
•	 Step 2. Two controllers: One for small errors, one for large errors: Use the preliminary 
QFT controller as the starting point to design two complementary controllers with 
the same structure, where the gain and the zeros can vary freely, but the poles 
remain unchanged. The characteristics of these two complementary controllers 
can be related with the error amplitude. As Boris Lurie256 explains, when the error 
is large, the bandwidth must increase to obtain a fast response, but the loop gain 
does not need to be high. Additionally, when the error is small, the bandwidth is 
reduced to avoid the effects of noise, while the low frequencies gain is increased 
to minimize the jitter and the reference tracking error. In terms of loop-shaping, 
these rules are (1) for small errors, increase the low-frequency gain and bring 
nearer the zeros and (2) for large errors, decrease the low-frequency gain and 
move the zeros further away. Apart from this, reasonable stability margins must 
be maintained, although they can be considerably reduced for the small error situ­
ation if necessary.
•	 Step 3. Stability analysis: The robustness of the extreme designs guarantees that 
both linear systems are stable for every plant within the uncertainty. However, 
it is necessary to apply the criterion presented in the previous section (see Equation 
6.18 with α = 0) to assure that the switching between both controllers is also stable. 
One advantage of this graphical criterion is that it gives information about the 
frequencies where conditions are not satisfied, so that the designer can go back to 
Step 2 and change the extreme controllers in this region if necessary.
•	 Step 4. Switching function: The switching function relates the error amplitude with 
the position of the controller parameters. Select the most appropriate switching 
function from the time-domain simulation with each controller (see Example 6.3 
in the next section for more information).
Method 2
Li(s), i = 1,2, with variation in gain, poles, and zeros
For switching among two controllers and for systems without uncertainty.
The stability is checked graphically, Equations 6.18 and 6.19, in both, the Complex plane 
or the Nichols diagram. In the first case, the criterion is expressed by requiring L1(jω) and 
L2(jω) to be inside of an arc of [90o – α(ω)o] degrees around the point (–1,0) at each frequency 
(Figure 6.3a); and in the second case, plotting [1 + L1(jω)] and [1 + L2(jω)], the distance ϕ12(ω) 
on the horizontal axis at each frequency should be less than [90o – α(ω)o] degrees (Figure 
6.3b).7,163
6.4  Examples
To validate the theory introduced in the previous sections, four illustrative switching 
examples are presented here: three based on Shorten et al.335 and one based on a bench­
mark problem presented at the American Control Conference in 1992 (the classical two-
mass-spring system).349,350

143
Gain Scheduling/Switching Control Solutions
EXAMPLE 6.1:  THERE DOES NOT EXIST A CQLF
Example 6.1, Case 1.
Li(s) with gain and poles variation, constant zeros. Method 2.
Consider two systems given by the matrices,
	
A
A
1
2
0
1
0
0
0
1
1
2
3
0
1
0
0
0
1
2
3
1
=
−
−
−






=
−
−
−






,
	
(6.20)
According to the methodology presented by Shorten et  al.335, the stability under 
switching between these two systems cannot be assured because A1A2 has two real 
negative eigenvalues: eig(A1A2) = [1.0, –1.0, –2.0].
The same result can be found applying the methodology introduced in Sections 6.2 
and 6.3. Let us assume that A1 and A2 represent two closed-loop systems, being the other 
state-space matrices: B1 = B2 = [–1 0 0]T, C1 = C2 = [0 1 1], and D1 = D2 = [0]. The open-loop 
transfer functions L1(s) and L2(s), which are defined by the closed-loop systems A1 and 
A2, have different gain and poles but the same zero, such that,
	
L s
s
s s
s
1
1
2 618
0 382
( )
(
)
(
.
)(
.
)
=
+
+
+
	
(6.21)
	
L s
s
s s
j
2
2
1
0 5
0 8666
( )
(
)
(
.
.
)
=
+
+
±
	
(6.22)
Figure 6.5 shows Equation 6.18 results at every frequency. The switching produces 
a gain increase and a change of two real poles by a pair of complex conjugate ones. 
Then, the stability is analyzed with Method 2, Section 6.3. The condition described in 
Equation 6.18 fails in the range of frequencies 1 rad/s ≤ ω ≤ 1.67 rad/s. The MATLAB 
code used in this case is in Appendix 6.
0
2
4
6
8
10
0
20
40
60
80
100
120
140
w (rad/s)
π12 + α and 90°
L2 * 0.59
Original L1 and L2
FIGURE 6.5
Example 6.1, Case 1. Equation 6.18, original L1 & L2, and with 0.59 L2. (Adapted from Garcia-Sanz, M. and Houpis, 
C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and 
Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

144
Robust Control Engineering
A simple solution to make the system stable under switching is to reduce the gain of 
the second controller by multiplying the second transfer function L2(s) by 0.59—see also 
Figure 6.5.
Example 6.1, Case 2
Li(s) with gain and zeros variation, constant poles. Method 1
As a second case, consider another two systems given by the matrices,
	
A
A
1
2
3
2
1
1
0
0
0
1
0
1
3
2
1
0
0
0
1
0
=
−
−
−






=
−
−
−






,
	
(6.23)
According to the methodology presented by Shorten et  al.335, the stability under 
switching between these two systems cannot be assured. Again, the matrices A1A2 has 
the same two real negative eigenvalues: eig(A1A2) = [1.0, –1.0, –2.0].
Once more, we can find the same result applying the methodology introduced in 
Sections 6.2 and 6.3. Let us assume again that A1 and A2 represent two closed-loop sys­
tems, being the other state-space matrices: B1 = B2 = [1 0 0]T, C1 = [3 2 0], C2 = [1 3 1], and 
D1 = D2 = [0]. Now, the two open-loop transfer functions for the switching Li(jω), i = 1,2, 
have different gain and different zeros but the same poles, such that,
	
L s
s s
s
s
j
1
3
0 6667
1
0 5
0 8660
( )
(
.
)
(
)(
.
.
)
=
+
+
−
±
	
(6.24)
	
L s
s
s
s
s
j
2
2 618
0 382
1
0 5
0 8660
( )
(
.
)(
.
)
(
)(
.
.
)
=
+
+
+
−
±
	
(6.25)
As the changes are only in the zeros and the gain, α(ω) is null for all frequen­
cies (Method 1, Section 6.3). In this case, as is shown in Figure 6.6, the condition of 
0
2
4
6
8
10
0
50
100
150
200
250
300
w (rad/s)
π12 and 90°, (α = 0)
FIGURE 6.6
Example 6.1, Case 2. Equation 6.18. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: 
Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor 
& Francis Group, Boca Raton, FL.)

145
Gain Scheduling/Switching Control Solutions
Equation 6.18 fails in the range of frequencies 0.9 rad/s ≤ ω ≤ 1.52 rad/s. The MATLAB 
code used in this case is also in Appendix 6.
EXAMPLE 6.2:  THERE EXIST A CQLF
Again, according to the methodology presented by Shorten et al.335, the stability under 
switching between the two systems given by the matrices
	
A
A
1
2
3
2
1
1
0
0
0
1
0
3
1
1
1
0
0
0
1
0
=
−
−
−






=
−
−
−






,
	
(6.26)
is assured because A1A2 has no real negative eigenvalues.
This result, based on the A1A2 eigenvalues335, can also be found by applying the meth­
odology introduced in Sections 6.2 and 6.3. Again it is assumed that these matrices rep­
resent two closed-loop systems, being the other state-space matrices: B1 = B2 = [1 0 0]T, 
C1 = C2 = [0 0 1], and D1 = D2 = [0]. Now, the two open-loop transfer functions for the 
switching are
	
L s
s s
s
1
1
2
1
( )
(
)(
)
=
+
+
	
(6.27)
	
L s
s s
s
2
1
2 618
0 382
( )
(
.
)(
.
)
=
+
+
	
(6.28)
As it is shown in Figure 6.7, the condition of Equation 6.18 is fulfilled for every fre­
quency of interest, so the system under switching is stable. The MATLAB code used in 
this case is also in Appendix 6.
0
2
4
6
8
10
0
10
20
30
40
50
60
70
80
90
100
w (rad/s)
π12 + α and 90°
FIGURE 6.7
Example 6.2, Equation 6.18. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)

146
Robust Control Engineering
EXAMPLE 6.3:  A NEW SOLUTION FOR THE ACC’92 BENCHMARK PROBLEM
This example presents and improves one of the numerous solutions published for the 
classical two-mass-spring system (Figure 6.8), also known as the ACC’92 benchmark 
problem.349,350
The benchmark consists of two carts with masses m1 and m2 connected by a spring 
with stiffness k. The control force u(t) acts on the first cart. The position of the sec­
ond cart x2(t) is the variable to be controlled, which results in a non-collocated control 
­problem. The system can be represented in state-space as,
	




x
x
x
x
k
m
k
m
k
m
k
m
1
2
3
4
1
1
2
0
0
1
0
0
0
0
1
0
0






= −
−
/
/
/
/
2
1
2
3
4
1
0
0
0
0
1
0












+


x
x
x
x
m
/




+
(
)+






=
+
u
w
m
w
y
x
v
1
2
2
2
0
0
0
1/
	
(6.29)
being x1(t) and x2(t) the positions of the carts 1 and 2, respectively, x3(t) and x4(t) the 
velocities of the carts 1 and 2, respectively, u(t) the control signal or force that acts on the 
first cart, y(t) the sensor output, w1(t) and w2(t) the disturbances acting on the carts 1 and 
2, respectively, v(t) the sensor noise, and x2(t) is the variable to be controlled.
Assuming a nominal plant m1 = m2 = 1 and k = 1, the transfer function between the 
plant input u(s) and the plant output x2(s) is,
	
x s
u s
P s
s
s
2
2
2
1
2
( )
( )
( )
(
)
=
=
+
	
(6.30)
The original linear controller proposed in Reference 349 is
	
G
s
s
s
s  
s
s
fix( )
. (
.
)(
.
.
)
(
.
)(
.
=
+
−
+
+
+
2246 3
0 237
0 681
1 132
33 19
11 7
2
9
4 95
7 563
2
)(
.
.
)
s
s  
+
+
	
(6.31)
Applying now the switching strategy introduced in this chapter (Section 6.3, 
Method  1), the original results presented that Reference 349 for the benchmark are 
improved. The switching solution proposed here is composed of two channels. The first 
one, Gsw1(s), is for the small error regime, with one pole placed closer to the origin. The 
second one, Gsw2(s), is for the large error regime, with one zero placed closer to the ori­
gin. The threshold value in the error is selected based on simulations with the original 
m1
u
w1
x1
m2
w2
x2
k
FIGURE 6.8
Two-mass–spring system (m1 = m2 = 1, k = 1) (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy 
Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press 
book, Taylor & Francis Group, Boca Raton, FL.).

147
Gain Scheduling/Switching Control Solutions
controller. Figure 6.9 shows the Bode diagrams of the controllers Gfix, Gsw1, and Gsw2, and 
the open-loop transfer functions Lfix = P Gfix, Lsw1 = P Gsw1, and Lsw2 = P Gsw2. Figure 6.10a 
shows the Nichols chart of Lfix, Lsw1, and Lsw2. Figure 6.10b shows the Nichols chart of 
(1 + Lsw1) and (1 + Lsw2) to check the stability according to Section 6.2, which is clearly 
stable under switching. The switching controller is,
	
G
s
G
s
s
s  
s
sw
sw
( )
( )
.
(
.
.
)
(
.
)
=
=
+
−
+
+
1
2
2246 3
0 681
1 132
33 19
(
0.237)
s
(
10.5)
(
0.
s
s
++
++
(
.
.
)
( )
.
( )
.
s
s  
e t
G
s
sw
2
2
4 95
7 563
0 5
2246 3
+
+
≤
=
 for
13)
(
11.79)
(
.
.
)
(
.
)
(
.
.
s
s  
s
s
s  
2
2
0 681
1 132
33 19
4 95
7 563
−
+
+
+
+
s ++
)
( )
.
 for
e t >





0 5
	
(6.32)
Finally, Figures 6.11 through 6.13 show the improvement with respect to the design 
introduced in Reference 349. The response of the system to a change in the reference sig­
nal [r(t) = unitary step input at t = 5 s] is shown in Figure 6.11. The response to a 0.5-mag­
nitude, 1-s-period pulse disturbances, w2 on mass m2 at t = 50 s and w1 on mass m1 at 
t = 100 s, are shown in Figures 6.12 and 6.13, respectively.
6.5  Summary
A practical methodology to design robust controllers that works under a switching mech­
anism is presented in this chapter. The method is capable of optimizing performance 
and stability simultaneously, going beyond the classical linear limitations and giving a 
solution for the well-known robustness-performance trade-off. Based on the frequency-
domain approach, the method combines a new graphical stability criterion for switching 
linear systems and the robust QFT technique. The new formulation is applied here to four 
illustrative examples.
Bode diagram
(a)
(b)
30
20
10
0
Gfix
Gsw1
Gsw2
10–2
100
Frequency (rad/s)
102
104
10–2
10–1
Lfix
Lsw1
Lsw2
Lsw2
60
40
20
0
270
180
90
0
–90
–180
Lsw1
Lfix
Frequency (rad/s)
100
Magnitude (dB)
Magnitude (dB)
Phase (deg)
–10
–20
Bode diagram
FIGURE 6.9
Bode diagrams. (a) Gfix, Gsw1, and Gsw2. (b) Lfix, Lsw1, and Lsw2.

148
Robust Control Engineering
Nichols chart
(a)
(b)
15
10
5
0
Open-loop gain (dB)
Open-loop gain (dB)
–5
–10
–270 –225 –180 –135 –90 –45
0
Open-loop phase (deg)
Open-loop phase (deg)
45
90
135
180
Lsw1
Lfix
Lsw2
1 + Lsw1
1 + Lsw2
225
270
–180
40
30
20
10
0
–10
–135
–90
–45
45
0
Nichols chart
FIGURE 6.10
Nichols chart. (a) Lfix, Lsw1, and Lsw2. (b) 1 + Lsw1 and 1 + Lsw2.

149
Gain Scheduling/Switching Control Solutions
Reference and plant output: r(t), y(t)
Control signal: u(t)
r(t), y(t)
u(t)
y(t), fixed controller
u(t), fixed controller
u(t), switching controller
y(t), switching controller
Time (s)
Time (s)
80
75
70
65
60
55
50
45
80
75
70
65
60
55
50
45
r(t)
1.5
1.2
0.8
0.6
0.4
0.2
0
–0.2
–0.4
1
1.4
1.3
1.2
1.1
1
0.9
0.8
0.7
0.6
FIGURE 6.12
Response to 0.5 pulse disturbance w2 on m2 at t = 50 s.
Reference and plant output: r(t), y(t)
Control signal: u(t)
r(t), y(t)
u(t)
y(t), fixed controller
u(t), fixed controller
u(t), switching controller
y(t), switching controller
Time (s)
Time (s)
135
130
125
120
115
110
105
100
135
130
125
120
115
110
105
100
r(t)
1.8
0.2
0.1
0
–0.1
–0.2
–0.3
–0.4
1.6
1.4
1.2
1
0.8
FIGURE 6.13
Response to 0.5 pulse disturbance w1 on m1 at t = 100 s.
Reference and plant output: r(t), y(t)
Control signal: u(t)
r(t), y(t)
u(t)
y(t), fixed controller
u(t), fixed controller
u(t), switching controller
y(t), switching controller
40
0
5
10
15
20
Time (s)
Time (s)
25
30
35
40
0
5
10
15
20
25
30
35
r(t)
1.8
2
1.5
0.5
–0.5
0
1
1.6
1.4
1.2
1
0.8
0.6
0.4
0.2
0
FIGURE 6.11
Response to a unit step reference tracking at t = 5 s.

150
Robust Control Engineering
6.6  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Examples 6.1 and 6.2. Section 6.4. Systems with gain, zeros, and poles variations.
•	 Example 6.3. Section 6.4. Two-mass-spring benchmark system.
•	 Appendix 6. MATLAB code for Examples 6.1 through 6.3.

151
7
Nonlinear Dynamic Control
7.1  Introduction
Chapter 6 developed a practical methodology to design control systems composed of a set 
of linear transfer functions or controllers that are switched in real-time following any given 
switching function. The method gives sufficient conditions for stability under switching 
and is capable of optimizing performance and stability simultaneously. It goes beyond the 
classical linear limitations while giving a solution for the well-known robustness/perfor­
mance trade-off. Based on the frequency domain, the method combines a graphical stabil­
ity criterion for linear systems that work under switching and the robust QFT.
Extending these results to more complex systems, this new chapter introduces an 
advanced control design methodology to deal with systems with one or even several non­
linearities, either in the plant, or in the controller, or in both.
Reviewing the fundamentals, Section 7.2 presents the circle stability criterion to study 
systems with one bounded and static or even time-variant nonlinearity.
Based on this stability criterion, Section 7.3 introduces a practical engineering methodol­
ogy to design controllers for systems with one nonlinearity in the plant (e.g., saturation or 
dead-zone in the actuator), and the same nonlinearity deliberately introduced in the con­
troller. The method, known here as nonlinear dynamic control—one nonlinearity, is applied to 
the design of an anti-windup strategy for a classical PID controller in Section 7.4.
Section 7.5, Nonlinear dynamic control—several nonlinearities, expands the methodology to 
systems with more than one nonlinearity. In this case, the nonlinear blocks can be either 
in the plant (such as saturation, dead-zone, relay, hysteresis, or friction), and/or in the con­
troller (to go beyond the classical linear limitations). Finally, Example 7.2 applies this new 
methodology to a field-controlled DC motor case.
7.2  The Circle Stability Criterion
The circle stability criterion is a generalization of the Nyquist criterion for linear systems 
with one bounded, static or even time-varying nonlinearity, N0(u,t). It gives sufficient condi­
tions for absolute stability. It assumes that the nonlinearity is bounded between an upper 
(k2) and a lower (k1) limit, as Figure 7.1 and Equation 7.0.230,354
	
for
for
u
N
t
u
k
N u t
k
=
⇒
=
≠
⇒
≤
≤
0
0
0
0
0
1
0
2
( , )
( , )
	
(7.0)

152
Robust Control Engineering
Considering a control system represented as a feedback connection of one equivalent 
linear transfer function LE(s) and one nonlinear element N0(u,t), as shown in Figure 7.2, 
and assuming that the nonlinearity N0 satisfies the conditions described in Equation 7.0, 
the system is absolutely stable (sufficient condition) if one of the following conditions is 
­satisfied—see also Figure 7.3:
Case 1. If 0 ≤ k1 ≤ k2, the Nyquist plot of LE(jω), −∞ ≤ ω ≤ ∞, does not enter the disk 
D(k1,k2) and encircles it n times in the counterclockwise direction, n being the 
number of poles of LE(jω) with positive real part.
Case 2. If 0 = k1 ≤ k2, LE(jω) has no poles in the RHP and the Nyquist plot of LE(jω), 
−∞ ≤ ω ≤ ∞, lies at the right of the vertical line defined by Re = −1/k2.
u
k2
k1
N0(u,t)
v
FIGURE 7.1
The nonlinearity, v = N0(u,t) u, and its bounds k2 and k1, with k2 ≥ k1 ≥ 0.
LE(s)
N0(u,t)
Nonlinearity
–
+
Linear TF
x2(s)
x1(s)
x0(s)
FIGURE 7.2
Representation as a feedback system with one linear function and one nonlinearity.
Re
D(k1,k2) 
–1/k2
LE(jω)
Im
–1/k1
FIGURE 7.3
Conditions for stability according to circle criterion.

153
Nonlinear Dynamic Control
Case 3. If k1 ≤ 0 ≤ k2, LE(jω) has no poles in the RHP and the Nyquist plot of LE(jω), 
−∞ ≤ ω ≤ ∞, lies in the interior of the disk D(k1,k2).
If, k2 = k1 = 1, the nonlinearity converts into a linear element (see Figure 7.1), the circle 
becomes the point “−1” (see Figure 7.3), and the circle criterion turns into the Nyquist sta­
bility criterion (see Chapter 3 for more details).
7.3  Nonlinear Dynamic Control: One Nonlinearity
Real systems contain nonlinearities of diverse characteristics. It is common to have posi­
tion and velocity saturation limitations in the plant actuators, or sometimes dead zones, 
backlash, friction, etc. In this section, we study a methodology to design control systems 
with one nonlinearity.
Consider the system shown in Figure 7.4, where there is a nonlinearity N0 at the input of 
the plant. To deal with this problem, we could measure the output of the nonlinearity and 
use this information in an inner-loop of the control system, as shown in Figure 7.4. Instead, 
we could also introduce the model of this nonlinearity ˆN0 in the inner-loop of the con­
trol system, as shown in Figure 7.5. This solution, known as Nonlinear Dynamic Controller 
(NDC), is equivalent to Figure 7.4.256
ˆN0 being the model of the nonlinearity N0, P(s) the plant, G1(s) the feedback controller, 
and A(s) the inner-loop controller, from Figure 7.5 we have
	
u s
e s
G s
A s
N
( )
( ) =
( )
+
( )( −
)
1
0
1
1

	
(7.1)
	
y s
P s N G s
A s
N
P s N G s
F s r s
n s
( )
( )
( )
( )(
)
( )
( )[ ( ) ( )
( )]
=
+
−
+
−
+
+
0
1
0
0
1
1
1

[
( )(
)]
( )
( )(
)
( )
( ) ( )
1
1
1
1
0
0
0
1
+
−
+
−
+
A s
N
M s
A s
N
P s N G s d s


	
(7.2)
G1(s)
P(s)
Plant
Nonlinearity
M(s)
N0
A(s)
G1(s)
F(s)
r(s)
e(s)
d(s)
u(s)
v(s)
y(s)
n(s)
+
+
+
+
+
+
+
+
–
–
FIGURE 7.4
Control system with an NDC.

154
Robust Control Engineering
Obviously, in the trivial case, if the model of the nonlinearity matches the real nonlin­
earity and is in the linear zone ˆN
N
0
0
1
=
= , then Equation 7.2 becomes the well-known 
expression and diagram given by Equation 7.3 and Figure 7.6
	
y s
P s G s
P s G s
F s r s
n s
M s
P s G s d
( )
( )
( )
( )
( )[ ( ) ( )
( )]
( )
( )
( ) (
=
+
−
+ +
1
1
1
1
1
s)
	
(7.3)
In general, the NDC methodology can deal with any bounded nonlinearity N0, like a dead 
zone, backlash, saturation, etc. The only restriction, imposed by the circle stability criteria, is 
that if we have more than one nonlinearity, all of them should be combined in one block N0.
In order to apply the circle stability criterion, we consider a perfect nonlinear model 
ˆN
N
0
0
=
, and rearrange Figure 7.5 as Figure 7.7.
Now, being L1(s) = P(s)G1(s), the equivalent linear transfer function LE(s) in Figure 7.7, cal­
culated as it is in Figure 7.2, results as
	
x s
x s
x s
x s
L s
L s
A s
A s
E
1
2
1
0
1
1
( )
( )
( )
( )
( )
( )
( )
( )
−
=
=
=
−
+
	
(7.4)
Note that in Figure 7.7, the transfer function from the input x2(s) to the output x1(s), which 
is the one within the dashed envelope, is “−LE(s).” This is consistent with the LE(s), N0 and 
negative feedback sign [x0(s) = −x2(s)] shown in Figure 7.2.
Design Methodology (NDC: One Nonlinearity)
The design of an NDC—one nonlinearity case, Figure 7.5—is composed of the following 
sequential steps:
•	 Step A. Control element G1(s) and prefilter F(s). Use the standard QFT methodology 
to design a feedback controller G1(s) and a prefilter F(s) to regulate the plant P(s) 
with model uncertainty and to achieve robust stability and robust performance 
specifications. At this step, we consider the plant without nonlinearities (or work­
ing with small signals), as the control system in Figure 7.6. The design must be 
Nyquist stable—see Chapter 3.
•	 Step B. Inner-loop and control element A(s). Include the inner-loop for the NDC as in 
Figure 7.5. Find the model for the nonlinearity, ˆN
N
0
0
=
, and LE(s) as Equation 7.4 
NDC
G1(s)
+
+
+
u(s)
P(s)
y(s)
+
+
n(s)
d(s)
M(s)
N0
Plant
Nonlinearity
A(s)
–
e(s)
+
r(s)
F(s)
–
+
+
ˆN0
ˆv(s)
v(s)
FIGURE 7.5
Equivalent control system with the NDC.

155
Nonlinear Dynamic Control
for Figure 7.7. Design the transfer function A(s) with the same number of integra­
tors than the controller G1(s), and with the appropriate zeros and poles so that 
L1(s) dominates at low frequency [|L1(jω)| ≫ |LE(jω)| at ωlow] and LE(s) dominates at 
high frequency [|LE(jω)| ≫ |L1(jω)| at ωhigh]—see Figure 7.15.
•	 Step C. System stability. Circle criterion. Rearrange the control system as it is in 
Figure 7.7 or Figure 7.2, combining all the nonlinearities (real and model) in one 
single block. Calculate the equivalent transfer function LE(s), as Equation 7.4 for 
Figure 7.7. The system has to be stable according to the circle criterion, as presented 
in Section 7.2. The method gives sufficient conditions for stability.
•	 Step D. Simulation and discussion. Simulate the complete NDC system, with all the 
nonlinearities, inner-loop and model uncertainties. Check all the stability and 
performance specifications.
Additional Notes
Remark 7.1
The NDC methodology requires L1(s) to be stable according to the Nyquist criterion and 
LE(s) to be stable according to the circle criterion.
Remark 7.2
As a result, the NDC improves classical linear performance. It is less restrictive than other 
classical methods, because it allows L1(s) to be just Nyquist stable, instead of circle stable 
G1(s)
+
+
u(s)
P(s)
y(s)
+
+
n(s)
d(s)
M(s)
Plant
e(s)
+
–
r(s)
F(s)
FIGURE 7.6
Equivalent control system with ˆN
N
0
0
1
=
= .
G1(s)
+
u(s) = x1(s)
P(s)
y(s)
0
N0
Plant
Non-
linearity
A(s)
–
e(s)
–
+
+
v(s) = x2(s)
“–LE(s)”
0
0
FIGURE 7.7
Equivalent control system to calculate LE(s).

156
Robust Control Engineering
(which is the condition for LE). This fact permits L1(s) to be type 2 or 3 (2 or 3 integrators) 
if necessary. The circle criterion is more restrictive because typically it only accepts the 
system to be type 0 or 1.
Remark 7.3
If the system (plant or controller) contains more than one nonlinearity, we must lump all 
the nonlinearities together by block diagram manipulation and obtain the overall nonlin­
earity N0(u,t).
Remark 7.4
The methodology can deal with time-variant nonlinearities N0(u,t) as long as they are 
bounded within the sector: k1 ≤ N0(u,t) ≤ k2.
7.4  Anti-Windup Solution for PID Controllers
The NDC shown in Figures 7.4 and 7.5 can also be used to provide an anti-windup solu­
tion to the classical PID controllers when the nonlinearity N0 is the actuator saturation. 
A classical anti-windup solution with an inner-loop around the integral part is shown in 
Figure 7.8.249
This is equivalent to the NDC presented in Figure 7.5, which is also Figure 7.9 with the 
following expressions for G1(s) and A(s):
	
G s
G
s
K
Ts
T s
T
N s
PID
p
i
d
d
1
1
1
1
( )
( )
(
)
=
=
+
+
+






/
	
(7.5)
	
A s
k
s
a
( ) =
	
(7.6)
NDC
+
+
u(s)
P(s)
y(s)
+
+
n(s)
d(s)
M(s)
Plant
e(s)
+
r(s)
F(s)
–
–
+ ˆv(s)
v(s)
Kp
ka
1
s
Td s
s + 1
1
Ti
+
+
+
+
+
Saturation
N0
ˆN0
Td
N
FIGURE 7.8
PID controller with an anti-windup solution.

157
Nonlinear Dynamic Control
EXAMPLE 7.1:  PID CONTROLLER WITH AN ANTI-WINDUP SOLUTION
To illustrate the discussion, consider a third-order plant with parametric uncertainty. 
The following subsections describe the steps to apply the design methodology. The con­
trol system is based on Figure 7.9. The plant to be controlled is described by the follow­
ing third-order expression:
	
P s
k
s
( )
((
)
)
=
+
1
1
3
1
1
/µ
	
(7.7)
with the parametric uncertainty, k1 ∈ [0.5, 1.5], µ1 ∈ [0.83, 1.25]. We use the first values 
of the parameter intervals (k1 = 0.5, µ1 = 0.83) for the nominal plant P0(s), and the cen­
tral values (k1 = 1, µ1 = 1) for the central plant Pc(s). The disturbance transfer function is 
M(s) = 1. The actuator saturation limits are: umax = +1.10, umin = −1.10, and the slope of the 
central part is one—see Figure 7.10.
Step A:  Control Element G1(s) and Prefilter F(s)
The control specifications required for this example include the robust stability, distur­
bance rejection at the output of the plant, and reference tracking objectives presented in 
Equations 7.8 through 7.10, respectively.
•	 Stability specification:
	
P j
G j
P j
G j
W
GM
PM
s
(
)
(
)
(
)
(
)
.
ω
ω
ω
ω
ω
1
1
1
30 02
+
≤
=
=
=
°
=
1.93 (
3.62 dB,
)
for
[[
]
0.001
0.005
0.01
0.05
0.1
0.5
1
2
3
5
10
50
100 rad/s 	
(7.8)
+
NDC
+
+
u(s)
P(s)
y(s)
+
+
n(s)
d(s)
M(s)
Plant
Saturation
–
–
e(s)
+
r(s)
F(s)
+ ˆv(s)
v(s)
ka
1
s
1
s
1
Ti
+
+
+
+
A(s)
G1(s) = PID
N0
ˆN0
Td s
Td s + 1
N
Kp
FIGURE 7.9
PID controller with anti-windup solution as NDC.
u
v
umax
umin
Slope = 1 
FIGURE 7.10
Actuator saturation. Slope = 1. umax = +1.10, umin = −1.10.

158
Robust Control Engineering
•	 Sensitivity or output disturbance rejection specification—see Figure 7.11a:
	
1
1
3
3
1
1
+
≤
=
+
=
P j
G j
j
j
op
(
)
(
)
( )
(
)
(
)
[
ω
ω
δ
ω
ω
ω
ω
for
0.001
0.005
0.01
0.05
0.1
0.5 rad/s
]
	
(7.9)
•	 Reference tracking specification—see Figure 7.11b:
	
δ
ω
ω
ω
ω
ω
ω
δ
ω
lo
up
P j
G j
P j
G j
F j
( )
(
)
(
)
(
)
(
) (
)
( )
≤
+
≤
1
1
1
	
(7.10)
	
where
	
δ
ω
ω
ω
lo
j
j
( )
. (
)
(
)
=
+
+
0.98
is the lower bound
1 4
5
1
2
	
	
and
	
δ
ω
ω
ω
ω
up
j
j
j
( )
(
)
.
. (
)
. (
)
=
+
+
+
 
is the upper bound
2
1 02
0 4
1 7
1
2
	
	
for 
0.001  0.005  0.01  0.05  0.1  0.5 rad/s
ω= [
]
	
The QFT bounds are calculated taking into account the P(s) transfer function with the 
parameter uncertainty given by Equation 7.7, and the stability, output disturbance rejec­
tion and reference tracking specifications given by Equations 7.8 through 7.10, respec­
tively—see Figure 7.11.
To meet the specifications, we design a PID controller G1(s) with a low-pass filter for 
the derivative part, as shown in Equation 7.11. The parameters of the PID (standard 
10–2
10–1
100
101
Magnitude (dB)
–30
–25
–20
–15
–10
–5
0
Bode diagram
(a)
(b)
Frequency (rad/s)
δop
δlo
δup
0
5
10
15
20
25
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
FIGURE 7.11
Control specifications for P(s). (a) Disturbance rejection at the output of the plant: δop. (b) Reference tracking: δup, δlo.

159
Nonlinear Dynamic Control
form) are: Kp = 2.5177, Ti = 3.5967, Td = 1.1088, and N = 336. The QFT bounds and the loop 
shaping of L0(s) = P0(s)G1(s) meeting all the specifications are shown in Figure 7.12.
	
G s
G
s
K
Ts
T s
T
N s
PID
p
i
d
d
1
1
1
1
2 5177 1
1
3
( )
( )
(
)
.
=
=
+
+
+






=
+
/
.
.
.
. (
. )
(
.
.
5967
1 1088
0 0033
1
0 7
0 5
2
0 9 0 5
2
s
s
s
s
+
+





=
+
×
/
/
)
((
)
)
s
s
s
+
+
1
1 300
1
/
	
(7.11)
The prefilter element F(s) is designed with the QFTCT as a unitary gain, for the plant 
P(s) and the controller G1(s). Figure 7.13 shows the upper and lower spec limits and the 
closed-loop transfer function with this design. The prefilter is
	
F s( ) = 1 	
(7.12)
Figure 7.14 shows how the control system meets all the performance specifications. 
Figure 7.14a is the frequency domain analysis of the disturbance rejection specifica­
tion—Equation 7.9, and Figure 7.14b the time domain analysis of the reference tracking 
specification with 125 plants—Equation 7.10. The design is Nyquist stable.
Step B:  Inner-Loop and Control Element A(s)
The function A(s) of the NDC is designed so that: (1) A(s) has the same number of integra­
tors as G1(s), and (2) L1(s) = P(s)G1(s) dominates at low frequencies and LE(s) = [L1(s) − A(s)]/
[1 + A(s)] dominates at high frequencies. Equation 7.13 shows the expression for A(s). 
Open-loop phase (deg)
–200
–180
–160
–140
–120
–100
–80
–60
Open-loop gain (dB)
–40
–30
–20
–10
0
10
20
30
40
50
QFTCT
0.001 rad/s
0.005 rad/s
0.01 rad/s
0.1 rad/s
0.5 rad/s
1 rad/s
2 rad/s
3 rad/s
5 rad/s
10 rad/s
0.05 rad/s
L0(s) = P0(s)G1(s)
FIGURE 7.12
Loop-shaping of controller G1(s). L0(s) = P0(s)G1(s).

160
Robust Control Engineering
Figure 7.15a shows G1(s) and A(s), and Figure 7.15b compares the magnitudes of L1(s) and 
LE(s) using the nominal plant P0(s).
	
A s
k
s
s
a
( )
.
=
= 0 9
	
(7.13)
Step C:  System Stability. Circle Criterion
In order to analyze the absolute stability of the system according to the circle crite­
rion (Section 7.2), we have first to arrange the control system of Figure 7.9 as a feedback 
connection of one linear transfer function LE(s) and one nonlinear element N0(u,t), as it 
was shown in Figure 7.2. As discussed in Equation 7.4, considering a perfect nonlinear 
model ˆN
N
0
0
=
 the equivalent linear transfer function LE(s) is
	
L s
L s
A s
A s
L s
P s G s
E( )
( )
( )
( )
,
( )
( )
( )
=
−
+
=
1
1
1
1
being
	
(7.14)
As we see, the function LE(s) depends on the plant P(s), which varies according to 
the parametric uncertainty—see Equation 7.7. After a careful inspection of the function 
LE(s) at all the cases defined by the parametric uncertainty, we appreciate that it does 
not have poles in the RHP.
On the other hand, the nonlinearity N0 of the system is the actuator saturation that 
satisfies the expressions:
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
Magnitude (dB)
–90
–80
–70
–60
–50
–40
–30
–20
–10
0
10
QFTCT
P G1 F/(1 + P G1)
δlo
δup
FIGURE 7.13
Design of prefilter F(s) for P(s) and G1(s).

161
Nonlinear Dynamic Control
	
for
for
u
N
u
k
N u
k
k
k
=
⇒
=
≠
⇒
≤
≤
=
=
0
0
0
0
0
1
0
1
0
2
1
2
( )
( )
,
,
	
(7.15)
Now, according to Case 2 (Section 7.2), the sufficient condition for stability of the closed-
loop system is that the Nyquist plot of LE(jω) does not enter or enclose the circle D 
defined by (−1/k1, −1/k2), which in this problem is a vertical line at Re = −1 (circle of infi­
nite radius, from −∞ to −1). Figure 7.16 shows LE(jω), 0 ≤ ω ≤ ∞, for 100 plants within the 
parametric uncertainty, and the circle (vertical line). As all the functions LE(jω) lie at the 
right of the vertical line Re = −1 (outside the circle), the closed-loop system is absolutely 
stable for all the cases within the parametric uncertainty.
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
Magnitude (dB)
–60
–50
–40
–30
–20
–10
0
10
QFTCT
(a)
(b)
Worst case at each frequency
δop
Time (s)
0
5
10
15
20
25
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
Up to 0.5 rad/s
δup
δlo
FIGURE 7.14
Analysis of controller G1(s) and prefilter F(s) for P(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup, δlo.
Magnitude (dB)
–50
0
50
10–2
10–1
100
101
102
103
Phase (deg)
–90
–45
0
45
90
Bode diagram
(a)
(b)
Frequency (rad/s)
A(s)
G1(s)
G1(s)
A(s)
10–3
10–2
10–1
100
101
102
Magnitude (dB)
–100
–80
–60
–40
–20
0
20
40
60
Bode diagram
Frequency (rad/s)
LE0(s)
L10(s)
FIGURE 7.15
Bode diagrams. (a) G1(s) and A(s). (b) L10(s) and LE0(s).

162
Robust Control Engineering
Step D:  Simulation and Discussion
Finally, Figures 7.17 and 7.18 show the results of the simulation of the closed-loop sys­
tem presented in Figure 7.9, with the central plant P(s) = Pc(s)—Equation 7.7, the QFT/
PID controller G1(s)—Equation 7.11, and the prefilter F(s)—Equation 7.12. The reference 
input starts at r(t) = 0 and at t = 1 s jumps to r(t) = 1 (as a unitary step). The disturbance 
–1
0
1
2
3
4
5
–3
–2
–1
0
Imaginary axis
1
2
3
Nyquist diagram
Real axis
–1/k2
= –1
LE(s)
FIGURE 7.16
Circle criterion for 100 plants within the parametric uncertainty in LE(s), N0 = saturation, and circle with k1 = 0, 
k2 = 1.
Time (s)
0
10
20
30
40
50
60
r(t), y(t)
0
0.2
0.4
0.6
0.8
1
1.2
Plant output: r(t) [––], y(t) [–]
(a)
(b)
r(t)
y(t)
Time (s)
0
10
20
30
40
50
60
u(t), v(t)
–1
–0.5
0
0.5
1
1.5
2
2.5
Control signals: u(t) [.–], v(t) [–]
v(t)
u(t)
umin
umax
FIGURE 7.17
Simulation of closed-loop system with central plant Pc(s), PID controller G1(s), F(s), and A(s) = 0. (a) Output y(t) 
response to a unitary step input r(t) at t = 1 s and a 0.25 step disturbance d(t) at t = 40 s. (b) Controller output u(t) 
and signal v(t) after the actuator saturation.

163
Nonlinear Dynamic Control
starts at d(t) = 0 and at t = 40 s jumps to d(t) = 0.25 (as a step). In both figures, Figures 
7.17 and 7.18, the first part shows the reference input r(t) and the plant output y(t), and 
the second part the controller output u(t) and the signal v(t) after the actuator satura­
tion. The first figure, Figure 7.17, shows the results without the NDC, that is to say, 
A(s) = 0. The second figure, Figure 7.18, shows the results with the NDC, that is to say, 
with A(s) as defined in Equation 7.13. As we see, the QFT/PID works well in both cases, 
and for the reference tracking and disturbance rejection specifications. Moreover, the 
controller with the additional NDC inner-loop improves the performance, eliminat­
ing the windup problem and achieving a much better reference tracking without any 
overshoot.
7.5  Nonlinear Dynamic Control: Several Nonlinearities
This section extends the methodology introduced in Sections 7.3 and 7.4 to systems with 
more than one nonlinearity. The nonlinearities can be either a part of the controller, or a 
part of the plant, or both. In the first case, the introduction of nonlinearities in the control­
ler is a way to achieve high performance, allowing the system to go beyond the classical 
linear limitations. In the second case, the nonlinearities are a part of the plant and can typi­
cally include saturation, dead zone, relay, hysteresis, friction, backlash, etc.
As discussed in Sections 7.2 and 7.3, when we can lump the nonlinearities of the system 
into just one single block, we can then apply the circle criterion to analyze the stability. In 
this case, the methodology presented in Sections 7.3 and 7.4 is completely valid. However, 
if the system presents more than one nonlinearity, and these nonlinearities cannot be com­
bined in a single block, then the circle criterion and the corresponding method presented 
in Sections 7.3 and 7.4 cannot be applied. This section presents a solution for these more 
general cases. It is based on the describing function (DF) technique. The method can deal 
with any kind of nonlinearity, like single valued, double valued, with memory, etc.
Time (s)
0
10
20
30
40
50
60
r(t), y(t)
0
0.2
0.4
0.6
0.8
1
1.2
Plant output: r(t) [––], y(t) [–]
r(t)
y(t)
Time (s)
0
10
20
30
40
50
60
u(t), v(t)
–1
–0.5
0
0.5
1
1.5
2
2.5
Control signals: u(t) [.–], v(t) [–]
v(t)
u(t)
umin
umax
FIGURE 7.18
Simulation of closed-loop system with central plant Pc(s), PID controller G1(s), F(s) and A(s) = 0.9/s. (a) Output y(t) 
response to a unitary step input r(t) at t = 1 s and a 0.25 step disturbance d(t) at t = 40 s. (b) Controller output u(t) 
and signal v(t) after the actuator saturation.

164
Robust Control Engineering
7.5.1  Describing Functions
It is well known that the model or transfer function of a linear system does not depend 
on the amplitude of the input signal applied to the system.230,256 On the contrary, when we 
deal with nonlinear systems, the corresponding model is typically a function of the ampli­
tude of the input signal. For these cases, in this section, we calculate the model of such 
nonlinearities with the Describing Function (DF) technique.
By definition, the DF of a nonlinearity N0 is an LTI transfer function approximation that 
depends on the amplitude of the applied input. In other words, given a sine wave input 
u(t) of amplitude E and frequency ω, u(t) = E sin(ωt), the output v(t) of N0 will be also a sine 
wave of the same frequency ω but with a scaled amplitude and shifted phase, v(t) = N0 
u(t) ≈ DF u(t) = Q sin(ωt + φ), being
	
N
DF E j
B
jA
E
0
1
1
≈
=
+
( ,
)
ω
	
(7.16)
where B1 and A1 depend on the type of nonlinearity, as we will see in the following 
­subsections, and where E is the amplitude of the input to the nonlinearity.
The DF method needs to satisfy the low-pass filter conjecture, which states that the system 
has a low-pass filter characteristic that attenuates the harmonics (frequency components 
higher than the fundamental frequency) of the input. This condition can be easily satisfied 
in real control systems. Errors due to the violation of this condition can be fixed by adding 
some extra phase in the controller.
In the following paragraphs, we present the DF models of some practical nonlinearities 
that will be either introduced in the controller to achieve high-performance or found in 
real-world plants. The expressions B1 and A1 are the real and imaginary parts of Equation 
7.16, respectively. The input of the nonlinearity is u(t) = E sin(ωt), E being the amplitude.
•	 Nonlinear element N01:  This is a useful nonlinearity with hysteresis for switching 
between two controllers. It can be implemented as channel 1 of the controller, and 
combined with the nonlinear element N02 for channel 2. The graphical description 
is presented in Figure 7.19, and the DF model in Equations 7.17 and 7.18.
	
If
then
E
DF E
l
<
=
δ ,
( )
1 	
(7.17)
–δl
δl
–δl
δl
δh
–δh
δh
–δh
Input
Output
FIGURE 7.19
Nonlinear element N01.

165
Nonlinear Dynamic Control
	
If
then
with
E
DF E
B
jA
E
h
>
=
+
δ ,
( )
,
1
1
	
(7.18)
	
B1
0
=
	
	
A
E
h
l
1
2
2
1
=
−


π
δ
δ
	
•	 Nonlinear element N02:  This is the complement of N01. It can be implemented as 
channel 2 of the controller, and combined with the nonlinear element N01 for chan­
nel 1. The graphical description is presented in Figure 7.20, and the DF model in 
Equations 7.19 and 7.20. Graphically, N01 + N02 = 1.
	
If
then
E
DF E
l
<
=
δ ,
( )
0 	
(7.19)
	
If
then
with
E
DF E
B
jA
E
h
>
=
+
δ ,
( )
,
1
1
	
(7.20)
	
B
E
1 =
	
	
A
E
h
l
1
2
2
1
= −
−


π
δ
δ
	
•	 Nonlinear element N03:  This is a useful nonlinearity without hysteresis for switch­
ing between two controllers. It can be implemented as channel 1 of the control­
ler, and combined with the nonlinear element N04 for channel 2. The graphical 
description is presented in Figure 7.21, and the DF model in Equations 7.21 
and 7.22: 
	
If
then
E
DF E
<
=
δ,
( )
1	
(7.21)
–δl
δl
–δl
δl
δh
–δh
δh
–δh
Input
Output
FIGURE 7.20
Nonlinear element N02.

166
Robust Control Engineering
	
If
then
with
E
DF E
B
jA
E
>
=
+
δ,
( )
,
1
1
	
(7.22)
	
B
E
E
1
2
1
=
−





−





δ
π
δ
	
	
A1
0
=
	
•	 Nonlinear element N04:  This is the complement of N03. It can be implemented as 
channel 2 of the controller, and combined with the nonlinear element N03 for chan­
nel 1. The graphical description is presented in Figure 7.22 and the DF model in 
Equations 7.23 and 7.24. Graphically, N03 + N04 = 1.
	
If
then
E
DF E
<
=
δ,
( )
0 	
(7.23)
	
If
then
with
E
DF E
B
jA
E
>
=
+
δ,
( )
,
1
1
	
(7.24)
δ
δ
–δ
–δ
Input
Output
FIGURE 7.21
Nonlinear element N03.
δ
δ
–δ
–δ
Input
Output
FIGURE 7.22
Nonlinear element N04.

167
Nonlinear Dynamic Control
	
B
E
1
2
1
=





−





δ
π
δ
	
	
A1
0
=
	
•	 Nonlinear element N05:  This is the saturation nonlinearity. The graphical descrip­
tion is presented in Figure 7.23, and the DF model in Equations 7.25 and 7.26.
	
If
then
E
DF E
k
<
=
δ,
( )
	
(7.25)
	
If
then
with
E
DF E
B
jA
E
>
=
+
δ,
( )
,
1
1
	
(7.26)
	
B
kE
E
E
E
1
1
2
2
1
=





+





−









−
π
δ
δ
δ
sin


	
	
A1
0
=
	
•	 Nonlinear element N06:  This is the dead-zone nonlinearity. The graphical descrip­
tion is in Figure 7.24, and the DF model in Equations 7.27 and 7.28. Note that 
N05 = k − N06.
	
If
then
E
DF E
<
=
δ,
( )
0 	
(7.27)
	
If
, then
with
E
DF E
B
jA
E
>
=
+
δ
( )
,
1
1
	
(7.28)
	
B
kE
kE
E
E
E
1
1
2
2
1
=
−





+





−








−
π
δ
δ
δ
sin




	
	
A1
0
=
	
δ
k δ
–k δ
–δ
Input
Output
FIGURE 7.23
Nonlinear element N05: saturation.

168
Robust Control Engineering
•	 Nonlinear element N07:  This is the relay nonlinearity. The graphical description is 
presented in Figure 7.25, and the DF model in Equations 7.29 and 7.30.
	
For all
with
E DF E
B
jA
E
,
( )
,
=
+
1
1
	
	
B
E
1
4
=
α
π
	
(7.29)
	
A1
0
=
	
(7.30)
•	 Nonlinear element N08:  This is the on–off nonlinearity with hysteresis. The graphi­
cal description is presented in Figure 7.26, and the DF model in Equations 7.31 
and 7.32.
	
If
then
E
DF E
<
=
δ,
( )
0 	
(7.31)
	
If
then
with
E
DF E
B
jA
E
>
=
+
δ,
( )
,
1
1
	
(7.32)
k
δ
–δ
Input
Output
FIGURE 7.24
Nonlinear element N06: dead zone.
–α
α
Input
Output
FIGURE 7.25
Nonlinear element N07: relay.

169
Nonlinear Dynamic Control
	
B
h
E
E
1
2
2
2
1
1
=
−
+





+
−











α
π
δ
δ
	
	
A
h
E
1
2
= −






α
π
	
7.5.2  Isolines
As mentioned before, the described function DF is a function of the amplitude of the input 
E and the frequency ω.256 As in linear systems, we can plot the open-loop transfer func­
tion L of the system in the NC, but now including also the DFs. These lines L are the so-
called isolines. They are calculated cascading from right to left (or output to input) the 
linear and nonlinear DF elements, like for instance: L = P1 DFN1 P2 [C1 DFN3 + (C2 + C3 DFN4)]. 
Figure 7.27 shows an example.
The system is considered stable if all the isolines satisfy the Nyquist stability criterion, as 
introduced in Chapter 3. However, note that as the DF technique is an approximation these 
results can be still confusing in some cases, mainly due to the phase uncertainty caused 
by the potential harmonics. Nevertheless, providing a safety margin of about 20°, the NDC 
should be adequate for many practical applications.
Design Methodology (NDC: Several Nonlinearities)
The design of an NDC—several nonlinearities case is composed of the following sequen­
tial steps:
•	 Step A. Controller structure. Select the controller topology, including k parallel 
channels to switch (k = 1 to number of channels n), inner-loops, linear transfer 
functions, preferred nonlinearities for the controller, and switching functions. We 
typically use the error as the signal to switch between the channels, being active/
aggressive controllers for small errors and moderate controllers for large errors.
•	 Step B.k. Control element for kth channel, Gk(s) and prefilter Fk(s). Use the standard 
QFT methodology to design feedback controllers Gk(s) and prefilters Fk(s) to reg­
ulate the plant P(s) with model uncertainty, and to achieve robust stability and 
performance specifications at each selected channel or switched zone “k.” At this 
step, we consider the plant and the controllers without nonlinearities (or working 
δ + h
–(δ + h)
δ
–α
–δ
α
Input
Output
FIGURE 7.26
Nonlinear element N08: on–off with hysteresis.

170
Robust Control Engineering
with small signals), as the control system in Figure 7.6. The design must be Nyquist 
stable for each case—see Chapter 3.
•	 Step C. Inner-loops and control elements A(s).
	
	 C.1. Select the inner-loop structure, either (a) with one inner-loop after the addi­
tion of all the channels k = 1 to n, or (b) with one inner-loop in each channel. Use 
the first option if all the controllers Gk(s) have the same number of integrators, and 
the second one if the controllers Gk(s) have a different number of integrators.
	
	 C.2. Include the inner-loop for the NDC as in Figure 7.5. Find the model for the 
nonlinearity, ˆN
N
0
0
=
. Design the function A(s) with the same number of inte­
grators than the controller Gk(s). Also, design A(s) so that Lk(s) dominates at low 
frequency [|Lk(jω)| >> |LEk(jω)| at ωlow] and LEk(s) dominates at high frequency 
[|LEk(jω)| >> |Lk (jω)| at ωhigh]—see example in Figure 7.15.
	
	 C.3. Rearrange the control system as it is in Figure 7.7 or 7.2, combining all the non­
linearities (real and model) in one single block. Calculate the equivalent transfer 
function LEk(s), as Equation 7.4 for Figure 7.7. The system has to be stable ­according 
to the circle criterion, as presented in Section 7.2.
•	 Step D. Isolines. Stability analysis for the complete system. Calculate the DF of every 
nonlinearity, either in the controller or in the plant. Write an algorithm to calcu­
late the isolines cascading the linear and nonlinear elements. Include the DF of 
each nonlinearity at their specific position in the loop, from the input (right of 
the expression) to the output (left of the expression); for instance: L = P1 DFN1 P2 
[G1 DFN2 + (G2 + G3 DFN3)]. See Example 7.2 and Appendix 7. Then, for the nom­
inal plant, and for every amplitude of the error E (input) and every frequency 
of interest ω, plot the isoline in the NC. Include also the QFT stability bounds 
–270
–225
–180
–135
–90
–45
–80
–60
–40
–20
0
20
40
60
80
Open-loop phase (deg)
Open-loop gain (dB)
FIGURE 7.27
Isolines L in the NC, for input error E from 10−7 to 102.

171
Nonlinear Dynamic Control
for the nominal plant. Check the stability with the isolines and according to the 
Nyquist criterion for NCs introduced in Chapter 3 and the QFT stability bounds. 
The method gives sufficient conditions for stability.
•	 Step E. Simulation and discussion. Simulate the complete NDC system, with all the 
nonlinearities, parallel channels, inner-loops, switching cases, and model uncer­
tainties. Check all the robust stability and performance specifications.
Additional Notes
Remark 7.5
If the nonlinearity N0 is independent of time, N0 = N0(u), and k1 ≤ N0(u) ≤ k2, then the DF 
also satisfies k1 ≤ DF(E) ≤ k2 and hence the graph of −1/DF(E) lies entirely within the circle 
D(−1/k1, −1/k2) of the circle criterion. In other words, the DF method and the circle criterion 
are consistent.
EXAMPLE 7.2:  NDC WITH SEVERAL NONLINEARITIES
To understand the NDC methodology for several nonlinearities, consider an illustrative 
example composed of a conventional field-controlled DC motor system and its third-
order plant model with parametric uncertainty given by
	
y s
u s
P s
K
s Js
D L s
R
k
ab
s
a s
b s
m
a
a
( )
( )
( )
(
)(
)
(
))
((
)
)((
)
=
=
+
+
=
+
/(
/
/
1
1
1
+1) 	
(7.33)
where y(s) is the angle of the shaft of the DC motor to be controlled, u(s) is the voltage 
applied to the input, J is the inertia of the rotating elements, D is the viscous friction, 
Km is the motor-torque constant, Ra is the resistance, and La is the inductance of the 
motor armature. As a first approximation, it is possible to combine these parameters 
into k = Km/(La J) as the gain, 1/a = J/D as the mechanical time constant, and 1/b = La/Ra 
as the electrical time constant of the system.
For a small motor, the parameters and the associate uncertainty for the system are: 
k ∈ [610, 1050], a ∈ [1, 15], b ∈ [150, 170]. We select the nominal plant P0(s) as the one with 
k = 610, a = 1, b = 150. In addition, we consider a saturation constraint in the actuator, 
being the upper and lower limits, respectively, umax = +1.10, umin = −1.10, and the slope of 
the central part unitary—see also Figure 7.10.
Step A:  Controller Structure
The structure proposed for the NDC is shown in Figure 7.28. It consists of two parallel 
channels, G1(s) N1 and G2(s) N2, and an anti-windup nonlinear inner-loop with a linear 
transfer function A(s) and a saturation model ˆN0. G1(s) N1 is the aggressive channel and 
G2(s) N2 the moderate channel.
N1 and N2 are the nonlinearities defined, respectively, in Figures 7.19 and 7.20, that 
is, N1 = N01 with Equations 7.17 and 7.18, and N2 = N02 with Equations 7.19 and 7.20—see 
also Figure 7.29. The parameters selected for these two nonlinearities are: δh = 0.15 and 
δl = 0.075. Note that N01 + N02 = 1.
As a summary, the system has four nonlinearities: the actuator saturation N0, the 
actuator saturation model ˆN0 and the two control channels N1 and N2.
Step B.1:  Control Elements for First Channel, G1(s) and Prefilter F1(s): Aggressive
The control specifications selected for the first channel include robust stability, aggres­
sive disturbance rejection at the output of the plant and reference tracking ­objectives, as 
presented in Equations 7.34 through 7.36, respectively.

172
Robust Control Engineering
•	 Stability specification:
	
P j
G j
P j
G j
W
GM
PM
s
(
)
(
)
(
)
(
)
.
(
.
,
.
)
ω
ω
ω
ω
1
1
1
1
1 46
4 53
40 05
+
≤
=
=
=
°
dB
	
(7.34)
	
for ω =




0.001
0.005
0.01
0.05
0.1
0.2
0.5
0.7
1
2
3
5
10
50
100
500
1000

rad s
/
	
•	 Sensitivity or output disturbance rejection specification—see Figure 7.30a:
	
1
1
0 07
0 07
1
1
1
+
≤
=
+
=
P j
G j
j
j
op
(
)
(
)
( )
.
(
)
.
(
)
ω
ω
δ
ω
ω
ω
ω
for
0.001
0.005
0.01
0.05
0.1
0.2
0.5
0.7
1
2
3
5
10
50
/





rad s
	
(7.35)
+
NDC
+
+
uNDC(s)
P(s)
y(s)
+
+
n(s)
d(s)
M(s)
Plant
Saturation
–
e(s)
+
r(s)
F(s)
–
ˆv(s)
v(s)
+
+
+
N0
ˆN0
N1
N2
A(s)
G1(s)
G2(s)
uN1(s)
uN2(s)
uA(s)
+
FIGURE 7.28
NDC block diagram: two channels and one common inner-loop.
Input
Output
(a)
(b)
N01
Input
Output
N02
–δl
δl
–δh
–δl
–δh
δl
–δl
δh
δl
δh
–δh
–δl
–δh
δh
δl
δh
FIGURE 7.29
Nonlinear elements for the NDC of Figure 7.28: (a) N1 = N01. (b) N2 = N02.

173
Nonlinear Dynamic Control
•	 Reference tracking specification—see Figure 7.30b:
	
δ
ω
ω
ω
ω
ω
ω
δ
ω
lo
up
P j
G j
P j
G j
F j
1
1
1
1
1
1
( )
(
)
(
)
(
)
(
)
(
)
( )
≤
+
≤
	
(7.36)
	
where
	
δ
ω
ω
ω
lo
j
j
1
2
0 98
0 0625
1 05
1
( )
.
.
(
)
.
(
)
=
+
+
 
is the lower bound
	
	
and
	
δ
ω
ω
ω
ω
up
j
j
j
1
2
2
1 02
0 4
1 7
1
(
is
)
(
)
.
. (
)
. (
)
=
+
+
+
the upper bound
	
	
for
0.001
0.005
0.01
0.05
0.1
0.2
0.5
0.7
1 rad/s
ω =[
]
	
The QFT bounds are calculated taking into account the P(s) transfer function with the 
parameter uncertainty given by Equation 7.33, and the robust stability, output distur­
bance rejection and reference tracking specifications given by Equations 7.34 through 
7.36, respectively—see Figure 7.30.
To meet the specifications, we design a PID with a low-pass filter for the G1(s) control­
ler, as shown in Equation 7.37. The QFT bounds and the loop shaping of L10(s) = P0(s)G1(s) 
meeting all the specifications are shown in Figure 7.31.
	
G s
s
s
s
s
1
89 1 1 2
1
1 5
1
1 500
1
( )
((
. )
)((
)
)
((
)
)
=
+
+
+
/
/
/
	
(7.37)
The prefilter element F1(s) is also designed with the QFTCT, for the plant P(s), and for 
the controller G1(s). Figure 7.32 shows the design. The expression for the prefilter is
10–1
100
101
102
103
Magnitude (dB)
–40
–35
–30
–25
–20
–15
–10
–5
0
5
Bode diagram
(a)
(b)
Frequency (rad/s)
0
5
10
15
20
25
30
35
40
45
50
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
δup1
δlo1
δop1
FIGURE 7.30
Control specifications for P(s). (a) Disturbance rejection at the output of the plant: δop1. (b) Reference tracking: 
δup1, δlo1. Aggressive channel.

174
Robust Control Engineering
	
F s
F s
s
s
s
s
( )
( )
((
)
)((
)
)
((
)
)((
)
)
=
=
+
+
+
+
1
1 21
1
1 48
1
1 4
1
1 8
1
/
/
/
/
	
(7.38)
Figure 7.33 shows how the control system (G1, F1) meets the performance specifica­
tions. Figure 7.33a is the frequency domain analysis of the disturbance rejection spec­
ification—Equation 7.35, and Figure 7.33b the time domain analysis of the reference 
tracking specification with 125 plants—Equation 7.36. The design is Nyquist stable.
Step B.2:  Control Elements for Second Channel, G2(s) and Prefilter F2(s): Moderate
The control specifications selected for the second channel include robust stability, mod­
erate disturbance rejection at the output of the plant and reference tracking objectives, 
as presented in Equations 7.39 through 7.41, respectively.
•	 Stability specification:
	
P j
G j
P j
G j
W
GM
PM
s
(
)
(
)
(
)
(
)
.
(
.
,
.
)
ω
ω
ω
ω
2
2
2
1
1 46
4 53
40 05
+
≤
=
=
=
°
 
dB
for ω =






0.001
0.005
0.01
0.05
0.1
0.2
0.5
0.7
1
2
3
5
10
50
100
500
1000
rad s
/
	
(7.39)
•	 Sensitivity or output disturbance rejection specification—see Figure 7.34a:
	
1
1
10
10
1
2
2
+
≤
=
+
=
P j
G j
j
j
op
(
)
(
)
( )
(
)
(
)
[
ω
ω
δ
ω
ω
ω
ω
for
0.001
0.005
0.01
0.05
0.1
0.2
0.5
0.7
1
/
] rad s 	
(7.40)
Open-loop phase (deg)
–240
–220
–200
–180
–160
–140
–120
Open-loop gain (dB)
–20
0
20
40
60
80
100
QFTCT
L10(s) = P0(s)G1(s)
FIGURE 7.31
Loop-shaping of controller G1(s). L10(s) = P0(s)G1(s).

175
Nonlinear Dynamic Control
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–100
–80
–60
–40
–20
0
20
QFTCT
P G1 F1/(1 + P G1)
δup1
δlo1
FIGURE 7.32
Design of prefilter F1(s) for P(s) and G1(s).
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
Magnitude (dB)
–80
–70
–60
–50
–40
–30
–20
–10
0
10
QFTCT
(a)
(b)
Worst case at
each frequency
Time (s)
0
1
2
3
4
5
6
7
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δup1
δop1
δlo1
Up to 50 rad/s
FIGURE 7.33
Analysis of controller G1(s) and prefilter F1(s) for P(s). (a) Disturbance rejection at plant output: δop1. (b) Reference 
tracking: δup1, δlo1.

176
Robust Control Engineering
•	 Reference tracking specification—see Figure 7.34b:
	
δ
ω
ω
ω
ω
ω
ω
δ
ω
lo
up
P j
G j
P j
G j
F j
2
2
2
2
2
1
( )
(
)
(
)
(
)
(
)
(
)
( )
≤
+
≤
	
(7.41)
	
where
	
δ
ω
ω
ω
lo
j
j
2
2
0 98
0 001
4
1
( )
.
.
(
)
(
)
=
+
+
 
is the lower bound
	
	
and
	
δ
ω
ω
ω
ω
up
j
j
j
2
2
2
1 02
0 4
1 7
1
( )
(
)
.
. (
)
. (
)
=
+
+
+
 
is the upper bound
	
	
for
0.001
0.005
0.01
0.05
0.1
0.2
0.5
0.7
1 rad/s
ω =[
]
	
The QFT bounds are calculated taking into account the P(s) transfer function with the 
parameter uncertainty given by Equation 7.33, and the robust stability, output distur­
bance rejection and reference tracking specifications given by Equations 7.39 through 
7.41, respectively—see Figure 7.34.
To meet the specifications, we also design PID with a low-pass filter for the G2(s) control­
ler, as shown in Equation 7.42. The QFT bounds and the loop shaping of L20(s) = P0(s)G2(s) 
meeting all the specifications are shown in Figure 7.35.
	
G s
s
s
s
s
2
0 0035 1 0 002
1
1 3
1
1 10
1
( )
.
((
.
)
)((
)
)
((
)
)
=
+
+
+
/
/
/
	
(7.42)
The prefilter element F2(s) is also designed with the QFTCT, for the plant P(s), and for 
the controller G2(s). Figure 7.36 shows the design. The expression for the prefilter is
10–3
10–2
10–1
100
101
Magnitude (dB)
–40
–35
–30
–25
–20
–15
–10
–5
0
5
Bode diagram
(a)
(b)
Frequency (rad/s)
δop2
0
2
4
6
8
10
12
14
16
18
20
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
δlo2
δup2
FIGURE 7.34
Control specifications for P(s). (a) Disturbance rejection at the output of the plant: δop2. (b) Reference tracking: 
δup2, δlo2. Moderate channel.

177
Nonlinear Dynamic Control
	
F s
F s
F s
( )
( )
( )
=
=
2
1
	
(7.43)
Figure 7.37 shows how the control system (G2, F2) meets the performance specifica­
tions. Figure 7.37a is the frequency domain analysis of the disturbance rejection spec­
ification—Equation 7.40, and Figure 7.37b the time domain analysis of the reference 
tracking specification with 125 plants—Equation 7.41. The design is Nyquist stable.
The purpose of implementing two channels, G1(s) and G2(s), in the controller is to 
improve the system performance beyond the linear limitations. The element G1(s) is 
designed as an active/aggressive controller to work with small errors (see N1 = N01) 
and the element G2(s) as a moderate controller to work with large errors (see N2 = N02). 
Figure 7.38 compares both dynamics over the frequencies of interest.
Step C:  Inner-Loop and Control Element A(s)
A(s) is designed so that: (1) There is a common inner-loop for all the channels—
see Figure  7.28; (2) A(s) has the same number of integrators than G1(s) and G2(s); (3) 
L10(s) = P0(s)G1(s) dominates at low frequencies and LE10(s) = [L10(s) − A(s)]/[1 + A(s)] domi­
nates at high frequencies; and (4) L20(s) = P0(s)G2(s) dominates at low frequencies and 
LE20(s) = [L20(s) − A(s)]/[1 + A(s)] dominates at high frequencies. A(s) is shown in Equation 
7.44. Figure 7.39a shows G1(s), G2(s), and A(s). Figure 7.39b compares L10(s), LE10(s), L20(s), 
and LE20(s) using the nominal plant P0(s).
	
A s
k
s
s
a
( )
.
=
= 4 5
	
(7.44)
Note that we have rearranged the control system of Figure 7.28 for each chan­
nel as a feedback connection of one linear transfer function LE(s) and one nonlinear 
Open-loop phase (deg)
–260
–240
–220
–200
–180
–160
–140
–120
–100
–80
Open-loop gain (dB)
–150
–100
–50
0
50
100
150
QFTCT
L20(s) = P0(s)G2(s)
FIGURE 7.35
Loop-shaping of controller G2(s). L20(s) = P0(s)G2(s).

178
Robust Control Engineering
Frequency (rad/s)
10–3
10–2
10–1
100
101
Magnitude (dB)
–35
–30
–25
–20
–15
–10
–5
0
5
QFTCT
P G2 F2/(1 + P G2)
δup2
δlo2
FIGURE 7.36
Design of prefilter F2(s) for P(s) and G2(s).
Frequency (rad/s)
10–2
10–1
100
Magnitude (dB)
–50
–40
–30
–20
–10
0
10
QFTCT
(a)
(b)
Worst case at each
frequency
Up to 1 rad/s
δop2
Time (s)
0
2
4
6
8
10
12
14
16
18
20
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δup2
δlo2
FIGURE 7.37
Analysis of controller G2(s) and prefilter F2(s) for P(s). (a) Disturbance rejection at plant output: δop2. (b) Reference 
tracking: δup2, δlo2.

179
Nonlinear Dynamic Control
element N0(u,t), as it was shown in Figure 7.2. The equivalent linear transfer functions 
LE1(s) and LE2(s) follow Equation 7.4, considering a perfect nonlinear model ˆN
N
0
0
=
: 
LE1(s) = [L1(s) − A(s)]/[1 + A(s)], LE2(s) = [L2(s) − A(s)]/[1 + A(s)], being L1(s) = P(s)G1(s) and 
L2(s) = P(s)G2(s).
Now, according to the circle criterion Case 2 (Section 7.2), the sufficient condition for stabil­
ity of the closed-loop system in each channel, calculated independently, is that LE(jω) has 
no RHP poles and the Nyquist plot of LE(jω) does not enter or enclose the circle D defined 
by (−1/k1, −1/k2), which in this problem is a vertical line at Re = −1 (circle of infinite radius, 
from −∞ to −1). Figure 7.40a shows LE1(jω), 0 ≤ ω ≤ ∞, for 64 plants within the parametric 
uncertainty and the circle (vertical line), and Figure 7.40b shows LE2(jω), 0 ≤ ω ≤ ∞, also for 
64 plants within the parametric uncertainty and the circle (vertical line).
As all the functions LE2(jω) lie at the right of the vertical line Re = −1 (outside the cir­
cle), the closed-loop system for the second channel is absolutely stable for all the cases 
within the parametric uncertainty.
In the first channel, however, some cases of LE1(s) cross the vertical line at Re = −1 
(circle), and then violate the circle stability criterion—see Figure 7.40a. These cases cor­
respond to the plants with 1 ≤ a < 4.5. Note that the circle criterion gives only sufficient 
conditions. This means that if it is satisfied, the system is stable. On the contrary, if it is 
not satisfied (as in LE1 for cases with 1 ≤ a < 4.5), we cannot conclude whether the system 
is stable or not.
The complete analysis of the stability, with all the nonlinearities involved, will be 
performed with the isoline method in the next step.
Step D:  Isolines—Stability Analysis for the Complete System
The DFs for every nonlinearity, both in the controller and in the plant, are given by the 
expressions:
•	 N0 = N05, actuator saturation—Equations 7.25 and 7.26
•	
ˆN
N
N
0
0
05
=
=
, controller actuator saturation model—Equations 7.25 and 7.26
Magnitude (dB)
–100
–50
0
50
100
150
10–3
10–2
10–1
100
101
102
103
Phase (deg)
–270
–225
–180
–135
–90
–45
Bode diagram
Frequency  (rad/s)
L10(s) = P0(s)G1(s)
L20(s) = P0(s)G2(s)
L20(s)
L10(s)
FIGURE 7.38
Channel comparison: L10(s) = P0(s)G1(s), L20(s) = P0(s)G2(s).

180
Robust Control Engineering
•	 N1 = N01, controller first channel nonlinearity—Equations 7.17 and 7.18
•	 N2 = N02, controller second channel nonlinearity—Equations 7.19 and 7.20
The isolines are calculated cascading the linear and nonlinear elements. They include 
the DF of each nonlinearity at their specific position in the loop, from the input (right of 
the expression) to the output (left of the expression). That is,
	
L
P s DF
A s DF
G s DF
G s DF
N
N
N
N
=
+






+
( )
( )
[
( )
( )
]
0
0
1
1
2
2
1
1

	
(7.45)
The algorithm that calculates the isolines for every amplitude E of the input 
and frequency ω is included in Appendix 7. Figure 7.41 represents in the NC the 
Magnitude (dB)
–50
0
50
100
150
10–4
10–2
100
102
104
Phase (deg)
–90
–45
0
45
Bode diagram
(a)
(b)
Frequency (rad/s)
A(s)
G2(s)
G2(s)
G1(s)
G1(s)
A(s)
Magnitude (dB)
–100
–50
0
50
100
150
10–2
100
102
104
Phase (deg)
–180
0
180
360
Bode diagram
Frequency (rad/s)
L20(s)
L10(s)
LE20(s)
LE10(s)
LE10 & LE20
LE10(s)
LE20(s)
L20(s)
L10(s)
LE10 & LE20
FIGURE 7.39
Bode diagrams. (a) G1(s), G2(s), A(s). (b) L10(s), LE10(s), L20(s), LE20(s).
–3
–2
–1
0
1
2
3
4
5
6
7
–6
–4
–2
0
2
4
6
Nyquist diagram
Real axis
Imaginary axis
–1/k2
= –1
Cases
do not
satisfy
CC
LE1(s)
–1.5
–1
–0.5
0
0.5
1
1.5
–1.5
–1
–0.5
0
0.5
1
1.5
Nyquist diagram
Real axis
Imaginary axis
–1/k2
= –1
LE2(s)
FIGURE 7.40
Circle criterion for 64 plants within the parametric uncertainty, LE1(s) and LE2(s), N0 = saturation, circle with 
k1 = 0, k2 = 1.

181
Nonlinear Dynamic Control
isolines L—Equation 7.45, for the input errors 10−5 ≤ E ≤ 102 and for the frequencies 
10−4 ≤ ω ≤ 105 rad/s. The figure is calculated for the nominal plant—Equation 7.33. It also 
shows the QFT stability bounds found for this nominal plant and Ws = 3.83 (or PM = 15°). 
As there is no RHP poles and the isolines do not enter into the QFT bounds, the NDC 
system is stable for all the cases within the model uncertainty. The method gives suf­
ficient conditions for stability—see also Chapter 3.
Step E:  Simulations and Discussion
Finally, Figures 7.42 and 7.43 show the results of the simulation of the closed-loop sys­
tem presented in Figure 7.28, with the nominal plant P(s) = P0(s)—Equation 7.33 and the 
actuator saturation, the QFT controllers G1(s) and G2(s)—Equations 7.37 and 7.42, the 
prefilter F(s)—Equations 7.38 and 7.43, the function A(s)—Equation 7.44, and the three 
controller nonlinearities ˆN0, N1, and N2.
The reference input starts at r(t) = 0 and at t = 1 s jumps to r(t) = 1 (as a unitary step). 
The disturbance starts at d(t) = 0 and at t = 40 s jumps to d(t) = 0.25 (as a step).
Figure 7.42 shows the reference input r(t), the plant output y1(t) of only the first chan­
nel and without the nonlinearity (or N1 = 1, N2 = 0), the plant output y2(t) of only the 
second channel and without the nonlinearity (or N1 = 0, N2 = 1), and the plant output of 
the ­complete NDC yNDC(t). In all cases, the actuator saturation, controller anti-windup 
inner-loop, and prefilter are present. As we can see in the figure, the NDC improves 
­significantly the performance in both, the reference tracking problem—Figure 7.42a, 
and the disturbance rejection problem—Figure 7.42b.
Note that the plant used in the simulation is the nominal plant P0(s), with k = 610, a = 1, 
b = 150. This case did not satisfy the circle criterion for LE1(s)—see Figure 7.40a, but met 
the isoline stability criterion—see Figure 7.41.
Open-loop phase (deg)
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–100
–50
0
50
100
NDC isolines
L10(s)
L20(s)
Isolines
1e–5 < E < 1e2
QFT stability
bounds for
Ws = 3.83
FIGURE 7.41
Isolines in the NC, for error E from 10−5 to 102, ω from 10−4 to 105 rad/s, and QFT stability bounds for Ws = 3.83 
(or PM = 15°).

182
Robust Control Engineering
Finally, Figure 7.43 shows the control signals for the case of the complete NDC 
­presented in Figure 7.42, including the first and second channels uN1(t) and uN2(t), the 
inner-loop anti-windup signal uA(t), the complete NDC control signal uNDC(t), which 
is the addition uNDC(t) = uN1(t) + uN2(t) + uA(t), and the signal after the saturation of the 
actuator v(t).
7.6  Summary
This chapter has introduced the nonlinear dynamic control (NDC) methodology. 
It is a ­practical control design method based on QFT that can deal with one or 
Time (s)
1
2
3
4
5
6
r(t), y(t)
0.85
0.9
0.95
1
1.05
1.1
(a)
(b)
Reference and plant output: r(t), y(t)
r(t)
y2(t)
y1(t)
yNDC(t)
Time (s)
39 39.5 40 40.5 41 41.5 42 42.5 43 43.5 44
r(t), y(t)
0.85
0.9
0.95
1
1.05
1.1
1.15
1.2
1.25
1.3
Reference and plant output: r(t), y(t)
y2(t)
yNDC(t)
y1(t)
r(t)
FIGURE 7.42
NDC results with nominal plant P0(s). (a) Reference tracking. (b) Disturbance rejection.
Time (s)
1.8
1.85
1.9
1.95
2
2.05
2.1
2.15
2.2
uNDC, uN1, uN2, uA
–12
–10
–8
–6
–4
–2
0
2
Control signals: uNDC(t), uN1(t), uN2(t), uA(t)
(a)
(b)
uNDC(t)
uN1(t)
uA(t)
uN2(t)
Time (s)
1.8
1.85
1.9
1.95
2
2.05
2.1
2.15
2.2
uNDC(t), v(t)
–4
–3
–2
–1
0
1
2
Control signals: uNDC(t), v(t)
v(t)
uNDC(t)
FIGURE 7.43
NDC results with nominal plant P0(s). (a) uNDC(t) = uN1(t) + uN2(t) + uA(t). (b) uNDC(t) and v(t).

183
Nonlinear Dynamic Control
several nonlinearities in system, either in the plant and/or deliberately introduced in 
the ­controller to go beyond the linear limitations and achieve a very high performance.
7.7  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Example 7.1. Section 7.4. System with actuator saturation. PID with anti-windup.
•	 Example 7.2. Section 7.5. Field-controlled DC motor with saturation. PIDs within 
an NDC structure.
•	 Appendix 7. MATLAB code for Examples 7.1 and 7.2.
•	 Case study CS4. Radio telescope servo system.


185
8
Multi-Input Multi-Output Systems: 
Analysis and Control
8.1  Introduction
Control of multi-input multi-output MIMO systems with model uncertainty is often a dif­
ficult problem. Contrary to the single-input single-output SISO systems we have studied 
so far, the structure of a MIMO plant is composed of some internal channels that connect 
the inputs and outputs of the plant in more than one way. This fact introduces challenging 
interactions among the inputs and outputs. To illustrate this problem, let us consider the 
conventional counter-flow heat exchanger shown in Figure 8.1—Example 8.1.
Heat exchangers are key components of many energy, chemical, and biological systems. 
Food pasteurization processes are a practical example of this case, where the main objec­
tive is to increase the temperature of the product (milk, juice, etc.) to a certain value to 
eliminate the potential bacteria, while maintaining the temperature of the secondary fluid 
at a given level for efficiency purposes.
With this objective, the main components of the pasteurization process shown in Figure 
8.1 are a counter-flow heat exchanger, a tank with a secondary fluid, an internal electrical 
heater, an open hydraulic circuit that brings the product into the heat exchanger, and a 
close hydraulic circuit controlled by a variable peristaltic pump that provides the hot fluid 
to the heat exchanger. The sensors of the system are T1 and T2, which are the temperatures 
(plant outputs) to be controlled. At the same time, the two actuators of the system (plant 
inputs) are the heat flux Q produced by the electrical resistor inside the tank, and the vol­
ume flow rate N generated by the peristaltic pump in the hot fluid line.
To simplify the case, the product line is held at a constant volume flow rate. As we can 
see in Figure 8.1a, a change in the pump flow rate N is able to change both temperatures, 
T1 and T2. Specifically, a decrease of N decreases T1 and T2, and an increase of N increases 
T1 and T2. This is described by the transfer functions p11(s) and p21(s), respectively, shown 
in Figure 8.1b.
Similarly, a variation of the heat flux Q is able to change both temperatures, T1 and T2. 
Specifically, a decrease of Q decreases T1 and T2, and an increase of Q increases T1 and T2. 
This is also described by the transfer functions p12(s) and p22(s), respectively, also shown in 
Figure 8.1b. In other words, we can write
	
T s
T s
p
s
p
s
p
s
p
s
N s
Q s
1
2
11
12
21
22
( )
( )
( )
( )
( )
( )
( )
(





=






)






	
(8.1)

186
Robust Control Engineering
In general, naming y1(s) = T1(s), y2(s) = T2(s), u1(s) = N(s), and u2(s) = Q(s), we have
	
y s
y s
p
s
p
s
p
s
p
s
u s
u
1
2
11
12
21
22
1
2
( )
( )
( )
( )
( )
( )
( )





=






( ) ,
( )
( ) ( )
s
s
s
s






=
or
y
P
u
	
(8.2)
For the syntax, note that the order of the subscripts in a transfer function pab(s) is read 
from right to left, “b” being the input channel and “a” the output channel. That is to say: 
ya(s) = pab(s) ub(s).
A quick analysis of this plant model brings new important questions beyond the SISO 
systems. For instance, in order to control the temperatures T1 and T2 we have to pick the 
most appropriate actuator for each one, to close the two control loops. In other words, 
to control T1, should we select the flow rate N or the heat flux Q? Similarly, to control T2, 
should we select the flow rate N or the heat flux Q? This is the so-called pairing problem. 
A solution for this pairing problem is presented in Example 8.1 and Section 8.3.2. For this 
heat exchanger, we selected N to control T1 and Q to control T2, as shown in Figures 8.2 
and 8.3.
Once this pairing problem is solved, another new important question is to quantify the 
coupling or interaction between the loops. In Figure 8.2 this interaction is related to the 
transfer function p12(s)—from Q(s) to T1(s), and to the transfer function p21(s)—from N(s) to 
T2(s). This new question is also addressed in Section 8.3.2.
Moving forward, once we selected the pairing and quantified the interaction among the 
loops, and based on this interaction, we have to decide the most appropriate controller 
structure. Considering a controller expression as the matrix shown in Equation 8.3,
	
N s
Q s
u s
u s
g
s
g
s
g
s
g
( )
( )
( )
( )
( )
( )
( )
(





=





=
1
2
11
12
21
22 s
e s
e s
s
s
s
)
( )
( ) ,
( )
( ) ( )












=
1
2
or
u
G
e
	
(8.3)
T1(s)
N(s)
T2(s)
Q(s)
p11(s)
p12(s)
p21(s)
p22(s)
N
Constant flow
T1
T2
Q
Hot
fluid
tank
Heat
exchanger
Product
Hot
water
FIGURE 8.1
Counter-flow heat exchanger: a 2 × 2 MIMO system—Example 8.1.

187
Multi-Input Multi-Output Systems: Analysis and Control
we can select between a diagonal controller—see Figure 8.2, or a non-diagonal or full-
matrix controller—see Figure 8.3, e1(s) and e2(s) being the errors: e1(s) = f11(s) r1(s) − T1(s), and 
r2(s) = f22(s) r2(s) − T2(s).
Sections 8.5 and 8.6 present two methodologies (called Method 1 and Method 2, respec­
tively) to design non-diagonal MIMO QFT controllers.
Other new important problems in MIMO systems are the poles and zeros of the MIMO 
plant, the stability of the MIMO plant, potential non-minimum phase transmission zeros, 
and the directionality of inputs and outputs of the MIMO plant. Section 8.3 also discusses 
these new problems.
EXAMPLE 8.1: A HEAT EXCHANGER
To illustrate the discussion, consider again the counter-flow heat exchanger and pas­
teurization process showed in Figure 8.1 and Equations 8.1 and 8.2. As presented, the 
plant inputs (actuators) are u1(s) = N(s) and u2(s) = Q(s), and the plant outputs (sensors) 
y1(s) = T1(s) and y2(s) = T2(s). The following subsections describe (a) the plant definition, 
(b) the input–output pairing, (c) the control specifications, (d) the design of the indepen­
dent controller g11, (e) the design of the independent controller g22, and (f) the MIMO 
plant simulation.
r2(s)
g11(s)
g22(s)
–
–
r1(s)
p11(s)
p12(s)
p21(s)
p22(s)
f11(s)
f22(s)
y1(s) =
T1(s)
y2(s) =
T2(s)
u1(s) = N(s)
u2(s) = Q(s)
FIGURE 8.2
Diagonal controller for the 2 × 2 heat exchanger MIMO system.
r2(s)
g11(s)
g12(s)
g21(s)
g22(s)
–
–
r1(s)
p11(s)
p12(s)
p21(s)
p22(s)
f11(s)
f22(s)
y1(s) =
T1(s)
y2(s) =
T2(s)
u1(s) =
N(s)
u2(s) =
Q(s)
FIGURE 8.3
Non-diagonal controller for the 2 × 2 heat exchanger MIMO system.

188
Robust Control Engineering
	
1.	 Plant Definition. The elements of the transfer matrix for the heat exchanger—
see Equations 8.1 and 8.2—are described by the following first-order models:
p
s
k
s
p
s
k
s
p
s
k
s
p
s
11
11
11
12
12
12
21
21
21
22
1
1
1
( )
;
( )
;
( )
;
( )
=
+
=
+
=
+
=
τ
τ
τ
k
s
22
22
1
τ
+
	
(8.4)
	
	 with the parametric uncertainty
	
k
k
k
11
11
12
12
21
6 3 7 7
3 6 4 4
8 9 9 1
4 9 5 1
∈
∈
∈
∈
[ . , . ],
[ . , . ],
[ . , . ],
[ . , . ]
τ
τ
∈
∈
∈
∈
[ . , . ],
[ . , . ],
[ . , . ],
[ . , . ]
2 9 3 1
7 9 8 1
4 5 5 5
1 8 2 2
21
22
22
τ
τ
k
	
	
	 and the nominal plant: k11 = 7, τ11 = 4, k12 = 9, τ12 = 5, k21 = 3, τ21 = 8, k22 = 5, 
τ22 = 2.
	
2.	 Input–Output Pairing. The relative gain analysis (RGA) of the nominal plant 
presented in Equations 8.2 and 8.4—see Section 8.3.2 for details—gives the 
­following Λ matrix:
	
Λ =
⊗
=





⊗












=
−
−
P
P
0
0
1
1
7
9
3
5
7
9
3
5
(
)T
T
4.3750
3.3750
3.3750
4.3750
−
−










u
u
1
2





y
y
1
2
	
(8.5)
	
	 P0 being the nominal plant at s = 0. Based on these results, we pick the elements 
λ11 = 4.3750 and λ22 = 4.3750, which means to pair the temperature T1(s) with 
the pump flow rate N(s), or [y1(s)  − u1(s)], and the temperature T2(s) with the 
heater Q(s), or [y2(s)  − u2(s)]. Figure 8.2 shows the loops based on this selection.
	
3.	 Control Specifications. The first control loop includes a compensator g11(s) to regu­
late the actuator u1(s) = N(s) and control the output y1(s) = T1(s) of the plant p11(s). 
The second control loop includes a compensator g22(s) to regulate the actuator 
u2(s) = Q(s) and control the output y2(s) = T2(s) of the plant p22(s)—see Figure 8.2. 
The control specifications for both loops are the same, including stability, out­
put disturbance rejection, and reference tracking objectives, as shown below.
	
a.	 Stability specification:
	
p
j
g
j
p
j
g
j
W
GM
PM
ii
ii
ii
ii
s
(
)
(
)
(
)
(
)
ω
ω
ω
ω
1+
≤
=
=
=
°
1.01(
5.98 dB, 
59.3 )
for
0.001  0.005  0.01  0.05  0.1  0.5  1  5  10
,
[
,
i =
=
1 2
ω
  50 100 500 1000 rad/s
]
	
(8.6)
	
b.	 Sensitivity or output disturbance rejection specification—See Figure 8.4a:
	
1
1
1
+
≤
=
=
+
=
p
j
g
j
ii
ii
op
j
j
i
(
)
(
)
[
( )
(
)
(
)
,
ω
ω
δ
ω
ω
ω
ω
1,2
for
0.001  0.005  0.01  0.05  0.1  0.5  1 5 10] rad/s 	
(8.7)

189
Multi-Input Multi-Output Systems: Analysis and Control
	
c.	 Reference tracking specification—See Figure 8.4b:
	
δ
ω
ω
ω
ω
ω
ω
δ
ω
lo
ii
ii
ii
ii
ii
up
p
j
g
j
p
j
g
j
f
j
i
( )
(
)
(
)
(
)
(
)
(
)
( ),
,
≤
+
≤
=
1
1 2
	
(8.8)
	
	 where,
	
δ ω
ω
ω
lo
j
j
( )
. (
)
(
)
=
+
+
0.98
0 4
2
1
2
 is the lower bound
	
	
	 and,
	
δ
ω
ω
ω
ω
up
j
j
j
( )
(
)
.
. (
)
. (
)
=
+
+
+
2
1 02
0 8
1 7
1
2
the upper bound
	
	
for
[0.001  0.005  0.01  0.05  0.1  0.5  1 5 10] rad/s
ω =
	
	
4.	 Controller g11(s)—Independent. The QFT bounds are calculated taking into 
account the p11(s) transfer function with the parametric uncertainty given by 
Equation 8.4, and the stability, output disturbance rejection and reference 
tracking specifications given by Equations 8.6 through 8.8, respectively—see 
Figure 8.4. To meet the specifications, we select a PI compensator with a filter 
for the g11(s) controller and a unitary prefilter f11(s), such that,
	
g
s
s
s
s
f
s
11
11
0 18
1 0 2
1
1 390
1
1
( )
.
((
. )
)
((
)
) ;
( )
=
+
+
=
/
/
	
(8.9)
10–2
10–1
100
101
102
Magnitude (dB)
–40
–35
–30
–25
–20
–15
–10
–5
0
Bode diagram
(a)
(b)
Frequency (rad/s)
δop
0
2
4
6
8
10
12
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Step response
Time (s)
Amplitude
δup
δlo
FIGURE 8.4
Control specifications for p11(s) and p22(s). (a) Disturbance rejection at the output of the plant: δop. (b) Reference 
tracking: δup,δlo.

190
Robust Control Engineering
	
	 The QFT bounds and the loop shaping of L11(s) = p11(s)g11(s) are shown in Figure 
8.5. The solution includes the QFT controller g11(s) presented in Equation 8.9. As 
Figure 8.6 shows, the control system meets all the performance specifications: 
see Figure 8.6a for the frequency-domain analysis of the disturbance rejection 
specification—Equation 8.7, and Figure 8.6b for the time-domain analysis of 
the reference tracking specification with 125 plants—Equation 8.8.
	
5.	 Controller g22(s)—Independent. For the second control loop, the QFT bounds are 
calculated taking into account the p22(s) transfer function with the parametric 
uncertainty given by Equation 8.4, and the stability, output disturbance rejec­
tion and reference tracking specifications given by Equations 8.6 through 8.8, 
respectively—see Figure 8.4. To meet the specifications, we also select a PI 
compensator with a filter for the g22(s) controller and a unitary prefilter f22(s), 
such that
	
g
s
s
s
s
f
s
22
22
0 25
1 35
1
1 190
1
1
( )
.
((
)
)
((
)
) ;
( )
=
+
+
=
/
/
	
(8.10)
	
	 The QFT bounds and the loop shaping of L22(s) = p22(s)g22(s) are shown in Figure 
8.7. The solution includes the QFT controller g22(s) presented in Equation 8.10. 
As Figure 8.8 shows, the control system meets all the performance specifica­
tions: see Figure 8.8a for the frequency-domain analysis of the disturbance 
rejection specification—Equation 8.7, and Figure 8.8b for the time-domain 
analysis of the reference tracking specification with 125 plants—Equation 8.8.
	
6.	 MIMO Plant Simulation and Discussion. Although both controllers g11(s) and 
g22(s) achieve an excellent performance controlling each plant p11(s) and p22(s) 
Open-loop phase (deg)
–200
–150
–100
–50
0
Open-loop gain (dB)
–80
–60
–40
–20
0
20
40
60
QFTCT
0.001 rad/s
0.005 rad/s
0.05 rad/s
0.1 rad/s
5 rad/s
10 rad/s
0.5 rad/s
1 rad/s
0.01 rad/s
L11(s) = p11(s)g11(s)
FIGURE 8.5
Loop-shaping of controller g11(s). L11(s) = p11(s) g11(s).

191
Multi-Input Multi-Output Systems: Analysis and Control
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
10
QFTCT
Up to 10 rad/s
δop
Worst case at each frequency
Time (s)
0
2
4
6
8
10
12
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
(b)
(a)
δup
δlo
FIGURE 8.6
Analysis of controller g11(s) and prefilter f11(s) for p11(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup,δlo.
Open-loop phase (deg)
–220
–200
–180
–160
–140
–120
–100
–80
–60
–40
Open-loop gain (dB)
–80
–60
–40
–20
0
20
40
60
QFTCT
0.001 rad/s
0.05 rad/s
1 rad/s
5 rad/s
10 rad/s
0.01 rad/s
0.5 rad/s
0.005 rad/s
0.1 rad/s
L22(s) = p22(s)g22(s)
FIGURE 8.7
Loop-shaping of controller g22(s). L22(s) = p22(s) g22(s).

192
Robust Control Engineering
independently—see Figures 8.6 and 8.8, when we implement them in the 
actual heat exchanger (the complete MIMO system) the results are quite dif­
ferent. Figure 8.9 shows the simulation this complete case, with the two loops 
of Figure 8.2, with the nominal plant defined in Equation 8.4, and with the 
independent controllers designed in Equations 8.9 and 8.10. The first reference 
starts at r1 = 0 and changes to r1 = 1 at t = 20 s. The second reference starts at 
r2 = 0 and changes to r2 = 1 at t = 170 s. Even though the reference tracking is 
still excellent, there is a disturbance at the second loop at t = 20 s due to the 
coupling with the first loop. Additionally, there is another important distur­
bance at the first loop at t = 170 s due to the coupling with the second loop. The 
following sections of this chapter address this problem and introduce several 
methodologies to design robust QFT controllers able to reduce the coupling 
among the loops of the MIMO system.
8.2  Formulation for n × n Systems
In general, a MIMO system is normally composed of a set of internal subsystems pij(s) that 
connect some of the inputs (uj, j = 1, 2,…,n) with more than one output (yi, i = 1, 2,…,n), or 
some of the outputs with more than one input of the plant—see Figure 8.10.
The mathematical description of a linear-time-invariant (LTI) MIMO system may be 
expressed as a set of ordinary differential equations, as a state space representation, or as 
a transfer matrix description (P matrix).
In the first case, the plant model consists of n coupled LTI differential equations, with n 
inputs (uj, j = 1, 2, …,n) and n outputs (yi, i = 1, 2, …,n), so that
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
10
QFTCT
(a)
(b)
δop
Worst case at each frequency
Time (s)
0
2
4
6
8
10
12
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δup
δlo
Up to 10 rad/s
FIGURE 8.8
Analysis of controller g22(s) and prefilter f22(s) for p22(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup,δlo.

193
Multi-Input Multi-Output Systems: Analysis and Control
	
11
1
1
11
1
1
21
1
α
α
β
β
α
( )
( )
( )
( )
( ) ( )
( )
( )
( )
s y s
s y s
s u s
s u s
s
n
n
n
n
+
+
=
+
+


y s
s y s
s u s
s u s
s y s
n
n
n
n
n
( )
( )
( )
( ) ( )
( )
( )
( )
( )
+
+
=
+
+
+


…
2
21
1
2
1
1
α
β
β
α



+
=
+
+
nn
n
n
nn
n
s y s
s u s
s u s  
α
β
β
( )
( )
( ) ( )
( )
( )
1
1
	
(8.11)
where αij(s) and βij(s) are polynomials in s, y1(s) to yn(s) are the outputs, and u1(s) to un(s) are 
the inputs. Grouping in two matrices, α(s) and β(s),
To: y(1)
0
0.5
1
1.5
0
50
100
150
200
250
300
To: y(2)
0
0.2
0.4
0.6
0.8
1
Simulation of closed loop MIMO system
Time (s)
Amplitude
y2
r1
y1
r2
FIGURE 8.9
Closed-loop MIMO system. Figure 8.2. Inputs: r1(s), r2(s). Outputs: y1(s), y2(s). P = [p11(s) p12(s); p21(s) p22(s)], 
Equation 8.4, nominal plant. G = [g11(s) 0; 0 g22(s)], F = [f11(s) 0; 0 f22(s)], Equations 8.9 and 8.10. Independent.
u1
u2
un
..
.
.
y1
y2
yn
..
n × n
MIMO
plant
FIGURE 8.10
An n × n MIMO system.

194
Robust Control Engineering
	
α( )
( )
( )
( )
( )
( )
( )
( )
(
s  =
s
s
s
s
s
s
s
 
n
n
n
n
α
α
α
α
α
α
α
α
11
12
1
21
22
2
1
2
…
…



s
s
 
s  =
s
s
nn
 
 
)
( )
( )
( )
(
…
α
β
β






β
11
12 )
( )
( )
( )
( )
( )
( )
( )
…
…



…
β
β
β
β
β
β
β
1
21
22
2
1
2
n
n
n
n
nn
s
s
s
s
s
s
s






 
	
(8.12)
the set of differential equations given by Equation 8.11 can be expressed as,
	
α
β
( )
( )
( )
( )
( )
( )
s
y s
y s
y
s
s
u s
u
n n
n
n
n n
×
×
×






=
1
2
1
1

2
1
( )
( )
.
s
u s
n
n







×
	
(8.13)
Now, pre-multiplying by α(s)−1, with α(s) nonsingular, Equation 8.13 can then be 
­written as
	
y
P
u
( )
( ) ( )
s   
s
s
=
	
(8.14)
P(s) being the n × n plant transfer function matrix (TFM, third representation option).
	
P( )
( )
( )
( )
( )
( )
( )
( )
( )
s  = 
s
s
p
s
p
s
p
s
p
s
p
s
p
s
n
n
α
β
−
=
1
11
12
1
21
22
2
…
…




…
p
s
p
s
p
s
n
n
nn
1
2
( )
( )
( )





	
(8.15)
In the second representation option, the state-space case, the system can be written as
	
x
A x
Bu
y
C x
Du
( )
( )
( )
( )
( )
( )
t
t
t
t
t
=
+
=
+
t
	
(8.16)
where t denotes time, A, B, C, and D are constant matrices of m × m, m × n, n × m, 
and n × n dimension, respectively, and where x is the m × 1 vector of state variables, y 
the n × 1 vector of outputs, and u the n × 1 vector of inputs. Once translated into the 
Laplace domain, the n × n plant TFM P(s) (third representation option) can be again 
evaluated as
	
y
P
u
( )
( ) ( )
s
s
s
=
	
(8.17)
with
	
P
C I
A
B
D
( )s
s
=
[
−
+
−]
1
	
(8.18)
being I the m × m identity matrix.

195
Multi-Input Multi-Output Systems: Analysis and Control
The plant matrix P(s) = [pij(s)] is a member of the set P = {P(s)} of possible plant matrices 
within the model uncertainty. In addition, the controller G(s) and the prefilter F(s) are now 
matrices as well, as expressed in Equation 8.19.
	
G( )
( )
( )
( )
( )
( )
( )
( )
(
s
g
s
g
s
g
s
g
s
g
s
g
s
g
s
g
s
n
n
n
n
=
11
12
1
21
22
2
1
2
…
…




)
( )
;
( )
( )
( )
( )
( )
…
…
g
s
s
f
s
f
s
f
s
f
s
nn
n






=
F
11
12
1
21
f
s
f
s
f
s
f
s
f
s
n
n
n
nn
22
2
1
2
( )
( )
( )
( )
( )
…




…





	
(8.19)
The closed-loop transfer function of the control system, from the vector of inputs r(s) to 
the vector of outputs y(s), is
	
y
I
P
G
P
G
F
r
( )
[
( ) ( )]
( ) ( ) ( ) ( )
s
s
s
s
s
=
+
−
s
s
1
	
(8.20)
where the closed-loop system control ratio matrix T(s) is
	
T
I
P
G
P
G
F
( )
[
( ) ( )]
( ) ( ) ( )
( )
( )
( )
s
s
s
s
s
s
t
s
t
s
t
s
t
n
n
nn
=
+
=
−1
11
1
1





(( )s





	
(8.21)
and where each element tij(s) = yi(s)/rj(s) relates the jth input to the ith output.
To appreciate the difficulty of the design problem, Equation 8.22 shows the complex 
expression of t11(s) for just a 3 × 3 plant P(s), a pure diagonal controller G(s), and a pure 
diagonal prefilter F(s). The Laplace variable s is omitted in the equation for simplicity.
	
t  =
p f
g
+ p g
+ p g
p p g g
p
f
11
11
11
11
22
22
33
33
23
32
22
33
21
11
1
1
{(
)(
)(
)
(
−
−
11
12
33
33
32
13
22
33
31
11
11
23
12
22 1
g
p g
+ p g
p p g g
+ p
f
g
p p
) [
( 
)
]
(
)[
−
22
33
22
22
13
33
11
11
22
22
33
33
1
1
1
1
g g
+ p g
p g
+ p g
+ p g
+ p
−(
)
]}/
{(
)[( 
)(
g
p p g g
p g
p g
+ p g
p p g g
+
)
]
[
(
)
]
−
−
−
23
32
22
33
21
11
12
22
33
33
32
13
22
33
31
1
p g
p p g g
p g
+ p g
11
12
23
22
33
13
33
22
22
1
[
(
)]}
−
	
(8.22)
For the 3 × 3 system, there are n2 = 9 transfer functions tij like the one shown in Equation 
8.22. Additionally, the expressions may have parametric uncertainty in the nine plant 
transfer functions pij(s). The robust control design objective is a system which behaves as 
desired for the entire range of uncertainty. This requires finding three fij(s) and three to 
nine gij(s) such that each tij(s) stays within its acceptable region defined by the specifications 
no matter how the pij(s) may vary. Clearly, this is a difficult problem. Even the stability 
problem alone, ensuring that the characteristic polynomial (the denominator of Equation 
8.22) has no factors in the right-half plane (RHP) for all possible pij(s), is difficult. However, 
as we will see in the next sections, the QFT design methodology systematizes and simpli­
fies the manner of achieving a satisfactory design.

196
Robust Control Engineering
8.3  MIMO Systems—Description and Characteristics
Two of the main characteristics that define a MIMO system are the input and output direc­
tionality—different vectors to actuate u and to measure y, and the coupling among control 
loops—each input ui can affect some outputs yi, and each output can be affected by several 
inputs. This problem, which is known as interaction or coupling, makes the control system 
design less intuitive since any change in one loop interferes with the rest of the plant loops.
The systems considered from now on are supposed to be linearizable, at least within 
a range of operating conditions, as with most of physical real problems. As mentioned 
before, we model the MIMO system as an n × n matrix of transfer functions P(s) = [pij(s)], 
also called the plant TFM, which relates the n input variables [manipulated variables, uj(s) 
with j = 1,…, n] with the n output variables [controlled variables, yi(s) with i = 1,…, n], so 
that [yi(s)] = P(s) [uj(s)].
In general, the MIMO TFM P(s) can be rectangular. However, most of the related lit­
erature deals with square systems, that is, with the same number of inputs and outputs. 
If it is not the case for the plant under study, there exist different procedures that can be 
followed, such as using weighting matrices which reduce the system to a square effective 
plant matrix,6 leaving some outputs (inputs) uncontrolled (not used), or looking for inde­
pendent extra inputs or outputs, depending on which one is in excess.252
Multivariable systems have aroused great interest within the control community 
and many design techniques have been developed. This is not only because of their 
mathematical and computational challenge (derived from the matrix representation), 
but also due to inherent features that do not appear in SISO systems. The particular 
nature of MIMO systems poses additional difficulties to control design such as the above 
mentioned input/output directionality and coupling, the potential transmission RHP 
zeros, system closed-loop stability, etc.; all with the intrinsic uncertainty of real-world 
applications.
8.3.1  Loop Coupling and Controller Structure
One of the most distinctive aspects of MIMO plants is the existence of coupling among 
the control loops. Thus, one input (manipulated variable) can affect various outputs (con­
trolled variables), and one output can be affected by several inputs. Consequently, when 
we apply a control signal to one of the plant inputs, more than one plant output is affected. 
This fact makes hard to predict the control action that is simultaneously needed in order 
to get the desired performance at all the outputs of the plant.
The first and easiest way that comes to mind when dealing with a MIMO system is to 
reduce it to a set of SISO problems, ignoring the system interactions. This is known as 
decentralized control.260 In this case, each input is responsible for only one output and the 
resulting controller G(s) is diagonal. Finding a suitable input–output pairing becomes there­
fore essential for decentralized control. However, this approach is only valid in systems 
where the coupling among loops is not significant, which unfortunately is not the case for 
many real applications. In other approaches the goal is to remove, or at least greatly reduce, 
the effects of the interaction before performing a decentralized control of the somehow 
decoupled plant, as if they are independent input–output pairs.
In any case, it is necessary to quantify the amount of coupling present in the system. 
Many of the MIMO design techniques, particularly the sequential ones, strongly depend on 

197
Multi-Input Multi-Output Systems: Analysis and Control
the correct selection and pairing of inputs and outputs at the beginning of the design pro­
cedure. Determining the controller structure is also crucial. This means deciding whether 
the multivariable system can be divided into several SISO or smaller MIMO subsystems, 
and establishing the off-diagonal compensators needed if a populated matrix controller 
is to be designed, avoiding non-required extra controllers. This issue becomes extremely 
complex in the presence of large coupling and has generated great interest within the con­
trol community, as shown by the numerous related works as References 246, 294, 297, 298, 
299, 305, 309, and 311. Nevertheless, too often only the extreme controller structures (the 
fully centralized [fully populated matrix] and the fully decentralized [set of SISO loops]) 
are discussed.302
8.3.2  Interaction Analysis
An extensive amount of work on the way of quantifying the system interaction can be found 
in the literature.245,260 One of the most popular techniques is the Relative Gain Analysis, or 
Relative Gain Array (RGA), defined by Bristol as a matrix of relative gains Λ based on the 
steady-state gains of the plant:265
	
Λ =






λ
λ
λ
λ
λ
λ
λ
λ
λ
11
12
1
21
22
2
1
2







n
n
n
n
nn 	
(8.23)
The elements λij that constitute this matrix are dimensionless and represent the relation 
between two gains of the system:
	
λij
OFF
ON
K
K
=
	
(8.24)
where KOFF is the open-loop gain between the input j and the output i when the rest of 
loops are open, while KON is the open-loop gain between the same input j and output i 
when the remaining loops are working in automatic mode, that is, they are closed.
A practical way of computing the RGA is through the following matrix expression:
	
Λ =
⊗
−
P
P
0
0
1
(
)T
	
(8.25)
where P0 is the n × n matrix that represents the steady-state (ω = 0) model. Its elements 
are determined by applying the final value theorem to the transfer functions P(s) under a 
unitary step input (1/s):
	
P
P
P
P
0
0
0
0
1
=
=
=





=
→
→
(
)
lim
( )
lim
( )
s
s
s
s
s
s
s
	
(8.26)
The operator [⊗] denotes element-by-element multiplication (Hadamard or Schur prod­
uct). The RGA provides a scaling independent measure of the coupling among loops, and 

198
Robust Control Engineering
also useful information on how to select the pairing of variables.239 Its elements λij give 
information about the interaction among the control loops, so that:
•	 λij = 1 ⇒ The closure of the rest of loops does not change the influence of the input 
j on the output i. Hence the ij loop is decoupled from the rest of the system and can 
be treated as a SISO subsystem.
•	 λij = 0 ⇒ There is no influence of the manipulated variable j over the control vari­
able i.
•	 0 < λij < 1 ⇒ When the rest of loops are closed, the gain between the input j and 
the output i increases, that is, KON > KOFF .
•	 λij < 0 ⇒ At the closure of the remaining loops (≠ij), the gain of the ij system 
changes its sign. This is a very sensitive situation, where the operation of the other 
loops changes the sign of the ij loop. In this case, if we do the pairing ij, we say that 
the system does not have integrity.
•	 λij > 1 ⇒ When the rest of loops are closed, the gain between the input j and the 
output i decreases, that is, KOFF > KON.
•	 λij > 10 ⇒ In this case, the ij loop is very sensitive to modeling errors and to small 
variations in the gain. Pairings of variables with large RGA values are undesirable.
According to the meaning of the RGA elements outlined above, it is desired to pair vari­
ables (uj with yi) so that λij is positive and close to one. This means that the gain from the input 
uj to output yi is not very much affected by the other loops.
On the other hand, a pairing corresponding to 0 < λij < 1 means that the other loops 
reinforce the gain of the ij loop. Also, a pairing corresponding to λij > 1 means that the 
other loops reduce the gain of the ij loop. Finally, negative values of λij are undesirable 
because this means that the steady-state gain in the ij loop changes the sign when the other 
loops are closed.
Notice also that the RGA matrix has two useful properties: (a) the λij elements are dimen­
sionless, which means that they are ready to compare channels of very different nature 
(pressure, temperature, concentrations, etc); and (b) the addition of all the elements of a 
column or all the elements of a row are always one: ∑j λij = ∑i λij = 1.
Given its importance, the RGA method has been the subject of multiple revisions and 
research. For instance, although originally defined for the steady-state gain, the RGA 
was extended to a frequency-dependent definition and used to assess the interaction at 
­frequencies other than zero.239,260,279,300 In most cases, it is the value of RGA at frequencies 
close to crossover which is the most important one, and both the gain and the phase are to 
be taken into account. For a detailed analysis of the plant, RGA is considered as a function 
of frequency:
	
RGA(
)
(
)
(
(
))
j
j
j
T
ω
ω
ω
=
⊗
−
P
P
1
	
(8.27)
where P(jω) is a frequency-dependent matrix.
Further information on how to perform the pairing is available in Reference 239, and 
different properties of the RGA can be consulted in References 260, 265, 294, 303, 304, 308, 
and 312.
Other measures of interaction that exist in the literature are: the Block Relative Gain;298,301,306 
the Relative Disturbance Gain;295,296,303,304 or the Generalized Relative Disturbance Gain.296

199
Multi-Input Multi-Output Systems: Analysis and Control
EXAMPLE 8.2
Given the 3 × 3 MIMO plant at s = 0,
	
y
y
y
1
2
3
2 662
8 351
8 351
0 3816
0 5586
0 5586
0
1






=
−
−
.
.
.
.
.
.
1 896
0 3511
1
2
3
.
.
−












u
u
u
	
(8.28)
The RGA matrix is
	
u
u
u
T
1
2
3
0
0
0 318
0 0195
0 00913
0 309
0
Λ =
=
−
P
P
⊗(
)
1
.
.
.
.
0.663
0.682
0.971
0 0287
1
2
3
.






y
y
y 	
(8.29)
and then, the selected pairing is (y1−u3), (y2−u1), (y3−u2).
8.3.3  Multivariable Poles and Zeros
Due to the abovementioned interaction among loops, the poles and zeros of a multivariable 
system may differ from what could be deduced from direct observation of the elements of 
the plant TFM.245 In fact, the pole positions can be inferred from the matrix elements pij(s), 
but not their multiplicity, which is of great importance when applying Nyquist-like stabil­
ity theorems in the presence of RHP poles. Regarding the multivariable zeros (also known 
as transmission zeros), neither the position nor the multiplicity can be derived from direct 
observation of pij(s). These multivariable zeros present a transmission-blocking property, 
since they provoke the loss of rank of the plant TFM (see example below).
Thus, it is necessary to determine the effective poles and zeros of a MIMO system, 
for example, by using the so-called Smith-McMillan form,264 as Rosenbrock first sugges
ted.229,231,270,274 Alternative definitions for transmission zeros can be found in the References 
232, 272, 273, 275, and 281. Further information on this issue is available in the References 
229, 237, 245, and 266. Regarding the RGA method introduced in the previous section, the 
following theorem can be useful to find RHP transmission zeros.
Theorem
Given TFM P(s) with stable elements pij(s) with no poles or zeros at the origin s = 0, and 
assuming that λij(∞) is finite and not zero, if λij(0) and λij(∞) have opposite signs, then one 
of the following sentences is true: (a) the element pij(s) has an RHP zero, or (b) the matrix 
P(s) has an RHP zero.
EXAMPLE 8.3
Given the MIMO plant,
	
P( )
(
)
(
)
(
)
(
)
(
)
(
)
s
s
s
s
s
s
s
s
=
−
+
+
−
+
−
+






4
1
1
2
6
1
2
1
	
(8.30)

200
Robust Control Engineering
taking the common denominator,
	
P( )
(
)(
)
(
)(
)
(
)
(
)
(
)(
)
s
s
s
s
s
s s
s
s
s
=
+
+
−
+
+
−
+
−
+






1
1
2
4
1
2
1
6
2
2
2 	
(8.31)
the poles of P(s) are at s = –1 and s = –2.
For the zeros, first we calculate the inverse P(s)−1, which is
	
P( )
(
.
.
)
.
.
.
.
s
s
s
s
s
s
s
s
s
−=
+
−
+
×
+
−−
−
−
−
1
3
2
3
2
3
2
1
0 5
2 5
4
0 25
0 25
1
0 25
0 5
0.
.
.
25
1 5
4 5
3
2
2
2
3
2
s
s
s
s
s
s
+
+
+
−−





	
(8.32)
Now, the poles of the inverse are the zeros of the original P(s). Then, the zeros of 
P(s) are s = –2.32, s = 0.91 + 0.95j, and s = 0.91 – 0.95j. Note that these zeros cannot be 
derived from direct observation of pij(s) in Equation 8.30.
EXAMPLE 8.4
Given the MIMO plant,
	
P( )
(
)
(
)
(
)
(
)
(
)
s
s
s
s
s
s
=
+
+
+
+
+






1
5
1
1
4
1
2
2 	
(8.33)
There is one pole at s = –0.2.
For the zeros, first we calculate the inverse P(s)–1, which is
	
P( )
(
)(
)
(
)(
)
(
)
(
)(
)
(
s
s
s
s
s
s
s
s
s
s
−=
−
+
×
+
+
−
−
−
−
−
+
1
2
1
2
1
10
2
1
5
21
4
5
1
1
5 +
+






1
1
)(
)
s
	
(8.34)
Again, the poles of the inverse are the zeros of the original P(s). Then, the zeros of P(s) 
are s = 2, s = –1. Note that once again these zeros cannot be derived from direct obser­
vation of pij(s) in Equation 8.33.
In this case, plant at s = 0 is
	
P
P
0
0
1
4
1
2
=
=
=






(
)
s
	
(8.35)
and then the RGA at s = 0,
	
Λ0
0
0
1
1
2
2
1
=
⊗
= −
−






−
P
P
(
)T
	
(8.36)

201
Multi-Input Multi-Output Systems: Analysis and Control
At the same time, the plant at s = ∞ is
	
P
P
∞=
= ∞=






(
)
.
.
.
.
s
0 2
0 2
0 2
0 4 	
(8.37)
and the RGA at s = ∞,
	
Λ∞
∞
∞
−
=
⊗(
) =
−
−






P
P
1
2
1
1
2
T
	
(8.38)
In other words, λ11(0) = –1, and λ11(∞) = 2. According to the theorem introduced in 
this section, as λ11(0) and λ11(∞) have different signs, and because the elements of the 
diagonal of P(s) do not have RHP zeros, then the matrix P(s) must have an RHP zero. 
This is consistent with the calculations above that found an RHP zero at s = 2.
8.3.4  Directionality
Directionality is one of the most essential differences between MIMO and SISO 
plants.243,260 A given direction is a combination of input signal values: for instance [u1, u2, 
u3] = [4 1 3] has the same direction as [u1, u2, u3] = [8 2 6], which is 2 × [4 1 3]. Inherently, 
MIMO systems present spatial (directional) and frequency dependency. Basically, they 
respond differently to input signals lying in distinct directions. As a result, the relation­
ship between the open-loop and closed-loop properties of the feedback system is less 
obvious. This directionality is completely in accordance with the TFM representation for 
MIMO systems.
8.3.5  Gain and Phase
The concept of gain of a system is somehow easy to translate to MIMO plants through the 
Singular Value Decomposition (SVD) of the TFM,244,260,280,282 which provides the plant gain at 
each particular frequency with respect to the main directions, which are determined by 
the corresponding singular vectors.
However, the extension of the notion of phase, as understood in scalar systems, is not so 
straightforward. Several attempts have been made to define a multivariable phase, such 
as can be seen in References 238, 243, 287, and 289. On the other hand, transmission zeros 
contribute with extra phase lag in some directions, but not in others.285 Generally speak­
ing, the change imposed by a MIMO system upon a vector signal can be observed in the 
magnitude, the direction, and the phase.243
EXAMPLE 8.1 (CONT.)
From the heat exchanger case, Example 8.1, the MIMO plant P(s)—see Equation 8.4—with 
the nominal parameters and at steady state s = 0 is
	
P
P
0
0
7
9
3
5
=
=
=






(
)
s
	
(8.39)

202
Robust Control Engineering
SVD for P0 is:
SVD(
)
.
.
.
.
P
U
0
0 891
0 454
0 454
0 891
⇒−
−
−










 




12 791
0
0
0 625
0 594
0 804
0 80
.
.
.
.
.






−
−
−
σ
4
0 594
0
.






=
V
P
U
V
H
H
H





being
(the expo
σ
nent 
is for the conjugate transpose).
H
	
(8.40)
This means that σmax = 12.791 is the largest gain of the MIMO system, and it is for an 
input in the direction: v = −
−






0 594
0 804
.
.
, and σmin = 0.625 is the smallest gain of the MIMO 
system, and it is for an input in the direction: v = −






0 804
0 594
.
.
.
Also, the condition of the matrix is γ
σ
σ
=
=
=
max
min
.
.
12.791 0
.
625
20 45
8.3.6  Effect of Poles and Zeros
The effect of multivariable poles and zeros strongly depends on directionality as well. 
That is, their nature is only perceptible for particular directions. So, the TFM transmit­
tance gets unbounded when the matrix is evaluated at a pole, but only in the directions 
determined by the residue matrix at the pole. Likewise, transmission zeros exert their 
blocking influence provided the TFM is evaluated at the zero, and the input signal lies in 
the corresponding null-space.243
8.3.7  Disturbance and Noise Signals
Because of directionality, disturbance and noise signals generally do not equally affect all 
the loops. In general, they have more influence on some loops than on others. Depending on 
the disturbance direction, that is, the direction of the system output vector resulting from a 
specific disturbance, some disturbances may be easily rejected, while others may not. The dis­
turbance direction can have an influence in two ways: (1) through the magnitude of the manip­
ulated variables needed to cancel the effect of the disturbance at steady-state, independently 
of the designed controllers, and (2) through its effect on closed-loop performance of the con­
trolled outputs. To address this issue, Skogestad and Morari defined the Disturbance Condition 
Number.303,304 It measures the magnitude of the manipulated variables needed to counteract a 
disturbance acting in a particular direction relative to the “best” possible direction.
8.3.8  Uncertainty
Uncertainty, present in all real-world systems, adds complexity to MIMO systems, espe­
cially in the crossover frequency region. Indeed, uncertainty is one of the reasons (together 
with the presence of disturbances, and the original instability of the plant if that is the 
case) why feedback is necessary in control systems.
There exist multiple sources of uncertainty (model/plant mismatch), for instance:
•	 The model is known only approximately or is inaccurately identified.
•	 The model varies because of a change in the operating conditions (experimental 
models are accurate for a limited range of operating conditions), wear of compo­
nents, nonlinearities, etc.

203
Multi-Input Multi-Output Systems: Analysis and Control
•	 Measurement devices are not perfect and their resolution range may be limited.
•	 The structure or order of the system is unknown at high frequencies.
•	 The plant model is sometimes simplified to carry out the controller design, and the 
neglected dynamics are considered as uncertainty.
•	 Other events such as sensor and actuator failures, changes in the control objec­
tives, the switch from automatic to manual (or the other way around) in any loop, 
inaccuracy in the implementation of the control laws, etc.
The uncertainty can be characterized as unstructured when the only available knowl­
edge is the loop location, the stability, and a frequency-dependent magnitude of the uncer­
tainty. The weights used for that magnitude (or bound) are generally stable and minimum 
phase to avoid additional problems, and multiplicative weights are usually preferred. 
This description is useful for representing unmodeled dynamics, particularly in the high-­
frequency range, and small nonlinearities. Different ways of expressing the unstructured 
uncertainty mathematically and their corresponding properties are available in the book 
by Skogestad and Postlethwaite.260
Nevertheless, unstructured uncertainty is often a poor assumption for MIMO plants. It 
can sometimes lead to highly conservative designs since the controller has to face events 
that, in fact, are not likely to exist. On the one hand, errors on particular model parameters, 
such as mode shapes, natural frequencies, damping values, etc., are highly structured. 
This is the so-called parametric uncertainty. Likewise, parameter errors arising in linearized 
models are correlated, that is, they are not independent. On the other hand, uncertainty 
that is unstructured at a component level becomes structured when analyzed at a system 
level.
Thus, in all those cases, it is more convenient to use structured uncertainty. Several 
approaches can be followed to represent this type of uncertainty. For example, a diagonal 
block can be utilized,290,291 or a straightforward and accurate representation of the uncertain 
elements can be performed by means of the plant templates (which are particularly use­
ful for parametric uncertainty). As we saw in Section 2.4, the templates describe the set of 
possible frequency responses of a plant at each frequency.6,7 Indeed, the QFT robust control 
theory can quantitatively handle both types of uncertainty, structured, and unstructured.
Alternative approaches for describing uncertainty are also available, but so far its practi­
cality is somehow limited for controller design. An example is the assumption of a proba­
bilistic distribution (e.g., normal, uniform) for parametric uncertainty.
As for the rest of system features, uncertainty in MIMO systems also displays direc­
tionality properties. One loop may contain substantially more uncertainty due to 
unmodeled dynamics or parameter variations than other loops. Added to this, and 
again because of directionality, uncertainty at the plant input or output has a different 
effect. Primarily, input uncertainty is usually a diagonal perturbation, since in principle 
there is no reason to assume that the perturbations in the manipulated variables are 
correlated. This uncertainty represents errors on the relative variation rather than on 
the absolute value.303,304
8.3.9  Stability
Stability of MIMO systems is also a crucial point in the design process. In the literature, 
and depending on the design methodology applied, different ways of assessing the feed­
back system stability exist.

204
Robust Control Engineering
One of the main approaches is the generalized Nyquist stability criterion, in its direct and 
inverse version.229,278 It places an encirclement condition on the Nyquist plot of the determi­
nant of the return difference matrix.190 However, it is necessary to get a diagonally dominant 
system for this criterion to be practical. This is achieved by means of pre-­compensation. The 
designer is helped in this task by the Gershgorin and Ostrowski bands—see References 
229, 231, and 245, or by Mees’ theorem—see Reference 288. This stability criterion is mainly 
used in nonsequential classical methodologies, for example, the Inverse Nyquist Array267 
and Direct Nyquist Array.229,231 By contrast, sequential classical techniques do not make a 
direct use of it. Proofs of the multivariable Nyquist stability criterion have been given from 
different viewpoints. See for instance References 235, 271, 277, and 284.
An alternative way of checking stability is by means of the Smith-McMillan poles.264 This 
approach is applied in classical sequential methodologies through stability conditions such 
as those defined by De Bedout and Franchek for non-diagonal sequential techniques.109
A completely different strategy is adopted by synthesis techniques, which make use 
of stability robustness results such as the small-gain theorem.233 This states that a feedback 
loop composed of stable operators will remain stable if the product of all the operator gains 
is smaller than unity. The theorem is applied to systems with unstructured uncertainty. 
When the phases of perturbations, rather than their gains, can be bounded, the small-phase 
theorem can be used.289 However, the main drawback of this approach is the highly conser­
vative results it may provide. In the presence of structured uncertainty, results based on 
the structured singular value SSV can be used instead.291
8.4  MIMO QFT Control—Overview
As is indicated in previous chapters, QFT is an engineering control design methodology 
which explicitly emphasizes the use of feedback to simultaneously reduce the effects of 
plant uncertainty and satisfy performance specifications. It is deeply rooted in classi­
cal frequency response analysis involving Bode diagrams, template manipulations, and 
Nichols charts. It relies on the observation that feedback is principally needed when the 
plant presents model uncertainty or when there are uncertain disturbances acting on the 
plant.
Model uncertainty, frequency-domain specifications, and desired time-domain 
responses translated into frequency-domain tolerances lead to the so-called Horowitz-Sidi 
bounds—see Section 2.7. These bounds serve as a guide for shaping the nominal loop 
transfer function L(s) = P(s)G(s), which involves the selection of gain, poles, and zeros to 
design the appropriate controller G(s)—see Section 2.8. On the whole, the QFT main objec­
tive is to synthesize (loop shape) a simple, low-order controller with minimum bandwidth, 
which satisfies the desired performance specifications for all the possible plants due to the 
model uncertainty. The use of CAD tools has made the MIMO QFT controller design much 
simpler—see for instance the QFTCT for MATLAB developed by the author and used in 
this book (Appendix B).
The first proposal for MIMO QFT design was made by Horowitz in his first book in 
1963,2 where he pointed out the possibility of using diagonal controllers for quantitative 
design. This was divided into different frequency ranges: for the low-frequency interval 
the controller gain generally needs to be high and is easily determined. As for the medium 
and high-frequency bands, he suggested the progressive tuning loop-by-loop sorted in 

205
Multi-Input Multi-Output Systems: Analysis and Control
increasing order. A more systematic and precise approach was later introduced by Shaked 
et al. in 1976.276 However, no proof of convergence to a solution was provided.
The first rigorous MIMO QFT methodology was developed by Horowitz in 1979.92 This 
nonsequential technique translates the original n × n MIMO problem with uncertainty 
into n multi-input single-output (MISO) systems with uncertainty, disturbances, and spec­
ifications derived from the initial problem. The coupling is then treated as a disturbance at 
the plant input, and the individual solutions guarantee the whole multivariable solution. 
This is assured by the application of the Schauder’s fixed point theorem. This theory maps 
the desired fixed point on the basis of unit impulse functions.
As before, the design applies a different approach to each major frequency range. Loops 
are designed as basically noninteracting (BNI) at low frequency, whereas in the middle 
and high-frequency range the design is based on the effect of the noise at the plant input, 
especially in problems with significant uncertainty.
On the whole, the first Horowitz’s method is a direct technique oriented toward MIMO 
plants with uncertainty. It also considers a trade-off among the control loops at each range 
of frequency. Nevertheless, the type of plant which can be dealt with is constrained in 
several ways, and the method places necessary conditions depending on the system size, 
which hampers its application to high-order systems. In addition, it presents potential 
overdesign and may generate highly conservative designs. Additional references on this 
methodology and its applications are available in References 93, 94, 95, and 177.
An improvement of the preceding technique was also provided by Horowitz with a 
sequential procedure.96 There exist some similarities between this technique and the SRD 
method by Mayne,269,283 such as the fact that the resulting controller is diagonal or that they 
proceed as if each input–output pair was a standard SISO system with loop interaction 
behaving as an external disturbance. Besides, both methods incorporate the effects of each 
loop once it is designed into the subsequent loop designs.
Nevertheless, the main difference is that Horowitz’s methodology relies on a factor­
ization of the return difference matrix which is based on the inverse of the plant TFM. 
By using the inverse plant, a much simpler relationship between the closed-loop and 
the open-loop TFMs is obtained. One of Horowitz’s major contributions with this tech­
nique is that he dealt with the problem of robust stability by considering parametric 
uncertainty.
The stability proof for Horowitz’s improved method was provided in the work by Yaniv 
and Horowitz,98 and De Bedout and Franchek.109 By and large, the method constituted a 
great step forward in MIMO QFT design techniques. First, as abovementioned, parametric 
uncertainty was considered. Second, the Schauder’s fixed point theorem was no longer 
needed. Third, the limitation related to the system size from the first method was avoided. 
Finally, it reduced the conservativeness of the former method by using the concept of 
equivalent plant (which takes into account the controllers that were previously designed). 
All in all, the second method is a much more powerful technique (although obviously 
more complicated than other classical approaches), and the physical sense is kept all along 
the procedure.
Different authors, such as Nwokah, Yaniv, and Horowitz again, made some improve­
ments of these first two MIMO QFT design methods in subsequent works.97–99 A detailed 
compilation of the above techniques is presented in the book by Garcia-Sanz and Houpis.7
An alternative approach to MIMO QFT methodologies was presented by Park, Chait, 
and Steinbuch in 1994, who developed a direct technique. In other words, the inversion of 
the plant matrix was not required anymore, which therefore simplified the design process 
to some extent.100

206
Robust Control Engineering
The methodologies outlined so far only deal with the problem of designing a diagonal 
controller. Nevertheless, there exist potential benefits in the use of full-matrix compensa­
tors. Horowitz already commented that the use of diagonal controllers was established 
just to simplify the theoretical development, but that in practice it could be convenient to 
consider the off-diagonal elements as well. These terms could then be used to reduce the 
level of coupling in open-loop, and therefore reduce the amount of feedback needed in the 
diagonal compensators to fulfill the required specifications.92
Furthermore, as Franchek, Herman, and Nwokah demonstrated,313 non-diagonal com­
pensators can be used for ensuring that no SISO loop introduces extra unstable poles into 
the subsequent loops in sequential procedures based on the inverse plant domain. As 
a result, the minimum crossover frequency needed to achieve closed-loop stability can 
be reduced in these succeeding loops. In other words, the actuation bandwidth require­
ments can be relaxed. Additionally, specific integrity objectives can be achieved, allowing 
the design of fault-tolerant MIMO systems. In the case of Horowitz’s diagonal sequential 
improved method, however, it is not possible to remove the unstable poles originally pres­
ent in those subsequent loops, and a more general design technique is necessary for that 
purpose.109 On the other hand, diagonal compensators are limited for the correction of the 
plant directionality. There even exist cases where a diagonal or triangular controller can­
not stabilize the system.109
On balance, the designer has greater flexibility to design the MIMO feedback control 
system when using fully populated controllers. But the introduction of such non-diagonal 
controllers poses two main issues: the way of determining the off-diagonal compensa­
tors and the need for suitable stability conditions. In systems controlled by a full-matrix 
compensator, the property of diagonal dominance is not necessary. The Gershgorin 
­circles become too conservative in that case and the stability test gets more complicated. 
As a result, different stability results are needed. Sufficient stability conditions for non-­
diagonal sequential procedures have been defined by De Bedout and Franchek.109
Regarding the determination of the off-diagonal compensators, different techniques 
have been proposed. The first attempt in non-diagonal MIMO QFT was proposed by 
Horowitz and coworkers,23,95 who suggested the pre-multiplication of the plant by a full 
matrix. Yaniv102 presented a procedure where a non-diagonal de-coupler is applied as a 
pre-compensator and a classical diagonal controller is designed afterward. Therein, the 
main objective becomes the improvement of the system bandwidth.
A different approach was adopted by Boje and Nwokah.106,191 They used the Perron–
Frobenius root as a measure of interaction and of the level of triangularization of the 
uncertain plant. The full-matrix pre-compensator is accordingly designed to reduce the 
coupling before designing a diagonal QFT controller.
On the other hand, Franchek and collaborators310,313 proposed a non-diagonal sequential 
procedure. They made use of the Gauss elimination technique293 to introduce the effects of the 
controllers previously designed by means of a recursive expression. Integrity considerations 
are also included. The controller is then divided into three parts with differentiated roles in 
the design process. The technique achieves the reduction of the required bandwidth with 
respect to previous classical sequential techniques. Additionally, De Bedout and Franchek 
established sufficient stability conditions for non-diagonal sequential procedures.109
At the same time, and following Horowitz’s original ideas,96 García-Sanz and collab­
orators extended the sequential methodology to the design of fully populated MIMO 
controllers.6,7,110,114,115,206,208,209,211 In this case, the role of the non-diagonal terms is simulta­
neously analyzed for the fundamental cases of reference tracking, disturbance rejection 
at plant input, and disturbance rejection at plant output. The compensators are aimed at 

207
Multi-Input Multi-Output Systems: Analysis and Control
the reduction of the coupling on the basis of defined coupling matrices, which are accord­
ingly minimized. Additionally, this method has been proved to be a reliable design tool in 
real applications from different fields, as heat exchangers,205 robotics,114 vehicles,207 indus­
trial furnaces,206 wastewater treatment plants,208,212 spacecraft flying in formation (NASA-
JPL),209 spacecraft with flexible appendages (ESA-ESTEC),211 and wind turbines.7,202 This 
method is presented in Sections 8.5 and 8.8.
Some years later, Garcia-Sanz and Eguinoa introduced a reformulation of the previous 
full-matrix QFT robust control methodology for MIMO plants with uncertainty.119 The new 
methodology includes a generalization of the previous non-diagonal MIMO QFT tech­
niques. It avoids former hypotheses of diagonal dominance and simplifies the calculations 
for the off-diagonal elements and the method itself. It also reformulates the classical matrix 
definition of MIMO specifications by designing a new set of loop-by-loop QFT bounds on 
the Nichols chart, with necessary and sufficient conditions, giving explicit expressions to 
share the load among the loops of the MIMO system to achieve the matrix specifications. 
And all for stability, reference tracking, disturbance rejection at plant input and output, 
and noise attenuation problems. This method is presented in Sections 8.6 and 8.9.
Regarding the field of nonsequential MIMO QFT techniques, it is to be remarked the 
approach by Jayasuriya, Kerr and coworkers.112,113,117,204,210 Stability conditions have also 
been established within this framework.112,116
Other approaches have also been introduced for particular types of MIMO systems. For 
example, there are results on non-minimum phase (nmp) MIMO plants.143 It is noted that 
not all the n × n transfer functions have to suffer the limitations imposed by nmp behav­
ior.141 The MIMO system has the capacity to relocate the RHP zeros in those loops that 
are less important, while the critical loops are kept as minimum-phase. Likewise, some 
research has been done for unstable and strongly nmp MIMO systems, for example, the 
X-29 aircraft.142,178,210 One interesting suggestion is the singular-G method,142,178 which makes 
use of a singular compensator—that is, with a determinant equal to zero, which implies 
that one output is dependent from the rest of outputs. In this way, the technique allows 
easing the nmp problem and the instability in the MIMO system, and simultaneously 
achieving good performance.
8.5  Non-Diagonal MIMO QFT—Method 17,110,114,115,206,208,209,211,212
A non-diagonal (fully populated) matrix compensator allows the designer more design 
flexibility to regulate MIMO systems than the classical diagonal controller structure. Two 
methodologies (Method 1 and Method 2) to design non-diagonal matrix compensators (fully 
populated G) for MIMO systems with model uncertainty are presented in this chapter.
Method 1, introduced in the section, studies three classical cases: reference tracking, exter­
nal disturbance rejection at plant input, and external disturbance rejection at plant output. 
The method analyses the role played by the non-diagonal compensator elements gij (i ≠ j) 
by means of three coupling matrices (C1, C2, and C3) and a quality function ηij. It quanti­
fies the amount of interaction among the control loops, and proposes a sequential design 
methodology for the fully populated matrix compensator that yields n equivalent tracking 
SISO systems and n equivalent disturbance rejection SISO systems.110,114,115,206,208,209,211,212 As 
a result, the off-diagonal elements gij (i ≠ j) of the compensator matrix reduce (or cancel if 
there is no uncertainty) the level of coupling between loops, and the diagonal elements gkk 

208
Robust Control Engineering
regulate the system with less bandwidth requirements than the diagonal elements of the 
diagonal G methods.
8.5.1  The Coupling Matrix
Coupling among the control loops is one of the main challenges in MIMO systems. This 
subsection defines an index (the coupling matrix) that allows the designer to quantify the 
loop interaction in the MIMO system. Following Horowitz’s ideas, consider an n × n linear 
multivariable system—see Figure 8.11, composed of a plant P, a fully populated matrix 
compensator G, and a prefilter F. These matrices are defined as follows:
	
P
G
=






=
p
p
p
p
p
p
p
p
p
g
n
n
n
n
nn
11
12
1
21
22
2
1
2
…
…




…
;
11
12
1
21
22
2
1
2
11
g
g
g
g
g
g
g
g
f
n
n
n
n
nn
…
…




…






=
;
F
f
f
f
f
f
f
f
f
n
n
n
n
nn
12
1
21
22
2
1
2
…
…




…






	
(8.41)
Notice that all the matrices, elements and signals are Laplace functions. For the sake of 
clarity, the dependence on (s) is omitted in this section. Figure 8.11 shows the plant input 
disturbance transfer function Pdi, and the plant output disturbance transfer function Pdo, 
where P ∈ P, and P is the set of possible plants due to uncertainty. The reference vector r′ 
and the external disturbance vectors at plant input di′ and plant output do′ are the inputs of 
the system. The output vector y represents the variables to be controlled. The plant inverse 
P–1, denoted by P* in this chapter, is presented in the following format:
	
P
P
B
−=
= 
=
+
=






+
1
11
1
0
0
0
0
0
0
0
*
*pij
*
nn
*
n
*
p
p
p
Λ

…
…
…
…
…
0
0
1
pn
*





	
(8.42)
F(s)
G(s)
P(s)
u
r′
r
y
–
Pdo(s)
do
do′
Pdi(s)
di
di′
+
+
+
+
+
FIGURE 8.11
Structure of a 2DOF MIMO System. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: 
Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor 
& Francis Group, Boca Raton, FL.)

209
Multi-Input Multi-Output Systems: Analysis and Control
and the compensator matrix is broken up into two parts as follows:
	
G
G
G
=
+
=






+





d
b
nn
n
n
g
g
g
g
11
1
1
0
0
0
0
0
0
0
0
0
…
…
…
…
…
	
(8.43)
Note that now we use the symbol Λ for the diagonal part, and B for the balance of P*; 
and that Gd is the diagonal part and Gb is the balance of G.
The following three subsections introduce an index to quantify the loop interaction in 
the three classical cases: reference tracking, external disturbances at the plant input, and 
the external disturbances at the plant output. In this chapter, the index is called the cou­
pling matrix C and, depending on the case, shows three different notations: C1, C2, and C3, 
respectively. The use of these coupling matrices enables the achievement of essentially n 
equivalent tracking SISO systems and n equivalent disturbance rejection SISO systems.
8.5.2  Tracking
The transfer function matrix (TFM) of the control system for the reference tracking prob­
lem without any external disturbance (di′ = 0, do′ = 0 in Figure 8.11) is written as shown 
in Equation 8.44,
	
y
I
PG
PGr
T
r
T
Fr
=
+
=
=
−
(
)
’
1
y r
y r
/
/
	
(8.44)
Using Equations 8.42 and 8.43, Equation 8.44 is rewritten as
	
T
r
I
G
G r
I
G
G r
B
G T
r
y r
y r
/
1
1
/
=
+
(
)
+
+
(
)
−
+
−
−
−
−
−
−
Λ
Λ
Λ
Λ
1
1
1
1
d
d
d
b
b
[
(
)
]	
(8.45)
which is the closed-loop TFM, and represents another way to describe the same idea intro­
duced by Horowitz as
	
y
t
r
t
t
r i j
n
ij
ij
y r
j
rii
cij
j
=
=
+
(
)
=
/
,
1,2,
,
,
…
	
where
	
t
w g
t
w c
w
p
g
c
t p
k
rii
ii
ii
cij
ii
ij
ii
ii
ii
ij
kj
ik
k
i
=
=
=
+
=−∑
=
≠
;
;
;
,
1
*
*
1,2,
,
… n
	
An analysis of Equation 8.45 reveals that it can be broken up into two parts as follows:
	
1.	A diagonal term Ty/r_d given by,
	
T
I
G
G
y r d
d
d
/ _ =
+
(
)
−
−
−
Λ
Λ
1
1
1
	
(8.46)
	
	 that represents a pure diagonal structure. Note that it does not depend on the 
non-diagonal part of the plant inverse B nor on the non-diagonal part of the 

210
Robust Control Engineering
compensator Gb. It is equivalent to n reference tracking SISO systems formed by 
plants equal to the elements of Λ–1 when the n corresponding parts of a diagonal 
Gd control them, as shown in Figure 8.12a. In this figure ti(s) represents the closed-
loop control ratio.
	
2.	A non-diagonal term Ty/r_b given by
	
T
I
G
G
B
G T
I
G
C
y/r
y r b
b
b
d
/ _
1
1
1
1
=
−
−
−
−
−
−
+
(
)
−
+

=
+
(
)
Λ
Λ
Λ
Λ
1
1
d
(
)
1 	
(8.47)
	
	 which represents a non-diagonal structure. It is equivalent to the same n previous 
systems with cross-coupling (internal) disturbances coming from the references of 
the other loops c1ij rj—see Figure 8.12b. In Equation 8.47, the matrix C1 is the only 
part that depends on the non-diagonal parts of both the plant inverse B and the 
compensator Gb. Hence, it represents the coupling matrix C of the equivalent system 
for reference tracking problems, or
	
C
G
B
G Ty/r
1 =
−
+
=



b
b
c
c
c
c
c
c
m
m
m
m
(
)
0
0
0
1
1
1
1
1
1
12
1
21
2
1
2










	
(8.48)
	
	   Each element c ij
1  of this matrix C1 obeys
	
c
g
p
g
t
ij
ij
ij
ik
ik
kj
ik
k
n
1
1
1
1
=
−
−
+
(
)
−
∑
=
(
)
(
)
δ
δ
*
	
(8.49)
1
gii
ri
yi
–
ui
gii
1
pii*
pii*
ui
0
yi
ti(s)
ti(s)
–
∑
n
k=1
c1ijrj
(a)
(b)
FIGURE 8.12
i-th equivalent decoupled SISO systems: (a) reference tracking, (b) disturbance at plant input. (Adapted 
from  Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT 
Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

211
Multi-Input Multi-Output Systems: Analysis and Control
where δik (and δij) is the Kronecker delta that is defined as
	
δ
δ
δ
ik
ik
ik
k
i
k
i
=
=
⇔
=
=
⇔
≠




1
0
	
(8.50)
8.5.3  Disturbance Rejection at Plant Input
The transfer matrix from the external disturbance di
′ at the plant input to the plant output 
y is written as shown in the following equation—see Figure 8.11,
	
y
I
PG
Pd
T
d
T
P d
=
+
=
=
−
(
)
/
/
1
i
y di
i
y di
di
i
′
	
(8.51)
Using Equations 8.42 and 8.43, Equation 8.51 is rewritten as
	
T
d
I
G
d
I
G
B
G T
d
y/ di
i
d
i
d
b
y di
i
=
+
(
)
−
+
(
)
+


−
−
−
−
−
−
Λ
Λ
Λ
Λ
1
1
1
1
1
1 (
)
/
	
(8.52)
Again, from Equation 8.52 it is possible to define two different terms as follows
	
1.	A diagonal term Ty/di_d given by,
	
T
I
G
y di d
d
/ _
1
=
+
(
)
−
−
−
Λ
Λ
1
1
	
(8.53)
	
	 that is equivalent to n regulator SISO systems, as shown in Figure 8.13a.
	
2.	A non-diagonal term Ty/di_b given by,
	
T
I
G
B
G T
I
G
C
y/di
y di b
d
b
d
/ _
1
1
=
+
(
)
+
(
)
=
+
(
)
−
−
−
−
−
−
Λ
Λ
Λ
Λ
1
1
1
1
2 	
(8.54)
1
0
–
ui
dii
(a)
(b)
1
ui
0
yi
yi
–
gii
gii
pii*
pii*
∑
n
j = 1
c2ijdij
FIGURE 8.13
i-th equivalent decoupled SISO systems: (a) external disturbances at plant input, (b) internal disturbances. 
(Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: 
QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.) 

212
Robust Control Engineering
	
	 which represents a non-diagonal structure, equivalent to the same n previous sys­
tems with external disturbances c2ij dij at the plant input, as shown in Figure 8.13b. 
In Equation 8.54, the matrix C2 comprises the coupling. It represents the coupling 
matrix of the equivalent system for external disturbance rejection at the plant input 
problems, and is given by
	
C
B
G Ty/di
2 =
+
(
)
b
	
(8.55)
	
	   Each element c ij
2  of this matrix obeys,
	
c
p
g
t
ij
ik
ik
k
n
kj
ik
2
*
(
)
=
(
)
∑
=
+
−δ
1
1
	
(8.56)
	
	 where δki is the Kronecker delta defined in Equation 8.50.
8.5.4  Disturbance Rejection at Plant Output
The transfer matrix from the external disturbance ′
do at the plant output to the output y is 
written as shown in Equation 8.57—see Figure 8.11,
	
y
I
PG
d
T
d
T
P d
=
+
=
=
′
(
)
/
/
−1
o
y do
o
y do
do
o 	
(8.57)
Using Equations 8.42 and 8.43, and repeating the procedure of the previous subsections, 
Equation 8.57 is rewritten as
	
T
d
I
G
d
I
G
B
B
G T
d
y/do
y/do
o
d
b
=(
)
+
+
(
)
(
)


+
−
+
−
−
−
−
−
Λ
Λ
Λ
1
1
1
1
d
o
o
1
	
(8.58)
From Equation 8.58, it is also possible to define two terms:
	
1.	A diagonal term Ty/do_d given by
	
T
I
G
y do d
d
/
_ =
+
(
)
−
−
Λ
1
1
	
(8.59)
	
	 that is equivalent to the n regulator SISO systems shown in Figure 8.14a.
	
2.	A non-diagonal term Ty/do_b given by
	
T
I
G
B
B
G T
I
G
C
y/do
y do b
d
/
_
1
1
1
1
=
+
(
)
−
+

=
+
(
)
−
−
−
−
−
−
Λ
Λ
Λ
Λ
1
1
d
b
(
)
3 	
(8.60)
	
	 which represents a non-diagonal structure, and is equivalent to the same n pre­
vious systems with external disturbances c3ij doj at the plant input, as shown in 
Figure 8.14b. In Equation 8.60, the matrix C3 comprises the coupling. It represents 
the coupling matrix of the equivalent system for external disturbance rejection for 
the plant output problems and is given by,
	
C
B
B
G Ty/do
3 =
−
+
(
)
b
	
(8.61)

213
Multi-Input Multi-Output Systems: Analysis and Control
	
	   Each element of the coupling matrix, c3ij obeys,
	
c
p
p
g
t
ij
ij
ij
ik
k
n
ik
kj
ik
3
*
*
(
)
(
)
(
)
=
−
−
+
−
=∑
1
1
1
δ
δ
	
(8.62)
	
	 where δik (and δij) is the Kronecker delta as defined in Equation 8.50.
8.5.5  The Coupling Elements
In order to design a MIMO compensator that reduces the level of coupling, we have to 
study the influence of every non-diagonal element gij on the coupling elements c1ij, c2ij, 
and c3ij, as defined by Equations 8.49, 8.56, and 8.62, respectively. To quantify the coupling 
effects, these elements are simplified by applying the following hypothesis.
Hypothesis H1
	
p
g
t
p
g
t
k
j
ij
ij
jj
ik
ik
kj
jj
*
*
for
,
and in the bandwidth of
+
(
)
+
(
)
≠
≫
,
t
	
(8.63)
Note that this is a common situation in many systems, as it is desirable for the diagonal 
elements tjj to be much larger than the non-diagonal elements tkj, once the pairing of the 
most convenient variables have been applied. Thus,
	
| |
|
|,
t
t
k
j
jj
kj
jj
≫
for
,
and in the bandwidth of
≠
t 	
(8.64)
Now, using Hypothesis H1, Equations 8.49, 8.56, and 8.62, which describe the coupling 
elements in the tracking problem, the disturbance rejection at the plant input and distur­
bance rejection at plant output, respectively, are rewritten as
	
c
g
t
p
g
i
j
ij
ij
jj
ij
ij
1
*
;
=
−
+
(
)
≠
	
(8.65)
1
pii*
gii
gii
0
yi
–
ui
ui
doi
(a)
(b)
1
0
yi
–
pii*
∑
n
j = 1
c3ijdoj
FIGURE 8.14
i-th equivalent decoupled SISO systems: (a) external disturbances at plant output, (b) internal disturbances. 
(Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: 
QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.) 

214
Robust Control Engineering
	
c
t
p
g
i
j
ij
jj
ij
ij
2
*
;
=
+
(
)
≠
	
(8.66)
	
c
p
t
p
g
i
j
ij
ij
jj
ij
ij
3
*
*
;
=
−
+
(
)
≠	
(8.67)
Also, taking the elements tjj from the equivalent system derived from Equations 8.46, 
8.53, and 8.59, we have
	
t
g
p
g
p
jj
jj
ij
jj
ij
=
(
)
+
(
)
−
−
*
*
1
1
1
	
(8.68)
	
t
p
g
p
jj
ij
jj
ij
=
(
)
+
(
)
−
−
*
*
1
1
1
	
(8.69)
	
t
g
p
jj
jj
ij
=
+
(
)
−
1
1
1
*
	
(8.70)
and then
	
c
g
g
p
g
p
g
i
j
ij
ij
jj
ij
ij
jj
jj
1
*
*
;
=
−
+
(
)
+
(
)
≠
	
(8.71)
	
c
p
g
p
g
i
j
ij
ij
ij
jj
jj
2
*
*
;
=
+
(
)
+
(
)
≠
	
(8.72)
	
c
p
p
p
g
p
g
i
j
ij
ij
jj
ij
ij
jj
jj
3
*
*
*
*
;
=
−
+
(
)
+
(
)
≠
	
(8.73)
8.5.6  The Optimal Non-Diagonal Compensator
As stated previously, the purpose of non-diagonal compensators is to reduce the coupling 
effect to achieve the desired loop performance specifications. The optimum non-diagonal 
compensators for the three cases (tracking and disturbance rejection at the plant input 
and output) are obtained making the coupling elements c ij
1 , c ij
2 , and c ij
3  of Equations 8.71 
through 8.73 equal to zero.
Note that in these three expressions the elements pij
*  and pjj
*  have uncertainty. In general 
every uncertain plant pij
*  can be a plant represented by the family:
	
p
p
p
i j
n
ij
ij
N
ij
ij
ij
*
*
*
(
),
|
|
,
{ }=
+
≤
≤
=
1
0
Δ
Δ
Δ
for
,
1,
,
…
	
(8.74)
where pij
N
* is the selected nominal plant for the non-diagonal controller expression, and 
Δpij
*  is the maximum of the non-parametric uncertainty radii |Δij|—see Figure 8.15b. 
Note also that Δpij
*  depends on the selection of pij
N
* .

215
Multi-Input Multi-Output Systems: Analysis and Control
The selected plants pij
N
*  and pjj
N
*  that are chosen for the optimum non-diagonal compen­
sator must comply with the following rules:
	
1.	If the uncertain parameters of the plants show a uniform probability distribu­
tion—see Figure 8.15a, which is typical in robust control, then the elements pij
* and 
pjj
*  for the optimum non-diagonal compensator are the plants pij
N
*  and pjj
N
* . These 
plants minimize the maximum of the nonparametric uncertainty radii Δpij
*  and 
Δpjj
*  that comprise the plant templates—see Figure 8.15b.
	
2.	If the uncertain parameters of the plants show a nonuniform probability distribu­
tion—see Figure 8.15c, then the elements pij
*  and pij
*  for the optimum non-diagonal 
compensator are the plants pij
N
*  and pjj
N
* , whose set of parameters maximize the 
area of the probability distribution in the regions [aij − ε, aij + ε] and [ajj − ε, ajj + ε] 
(∀ parameter aij, bij,…, ajj, bjj…), respectively.
These rules of selection are analyzed again in Section 8.5.7, where the coupling effects 
with the optimum non-diagonal compensator are computed. By setting Equations 8.71, 
8.72, and 8.73 equal to zero and using Equation 8.74, the optimum non-diagonal compensa­
tor for each case is obtained—see Equations 8.75, 8.76, and 8.77.
8.5.6.1  Tracking
	
g
F
g
p
p
i
j
ij
opt
pd
jj
ij
N
jj
N
=






≠
*
*
,
for
	
(8.75)
8.5.6.2  Disturbance Rejection at Plant Input
	
g
F
p
i
j
ij
opt
pd
ij
N
=
−
(
)
≠
*
for
,
	
(8.76)
8.5.6.3  Disturbance Rejection at Plant Output
	
g
F
g
p
p
i
j
ij
opt
pd
jj
ij
N
jj
N
=






≠
*
*
for
,
	
(8.77)
The function Fpd(A) means in every case a proper stable and minimum phase function 
made from the dominant poles and zeros of the expression A.
8.5.7  The Coupling Effects
The rules of Section 8.5.6 are utilized for choosing the plants pij
N
*  and pjj
N
* . These plants 
are inserted into Equations 8.75 through 8.77 in order to obtain the respective gij
opt, which 
are in turn utilized for determining the minimum achievable coupling effects given by 
Equations 8.78, 8.80, and 8.82. In a similar manner, the maximum coupling effects for the 
diagonal compensator matrix case, given by Equations 8.79, 8.81, and 8.83, are computed 
by substituting gij = 0 (i ≠ j) into the coupling expressions of Equations 8.71 through 8.73, 
respectively.

216
Robust Control Engineering
8.5.7.1  Tracking
	
c
g
ij gij
gij
ij
jj
ij
jj
opt
1
=
=|
(
)
|
ψ ∆−∆
	
(8.78)
	
c
g
ij gij
ij
ij
jj
1
= =
+
0
1
|
(
)
|
ψ
∆
	
(8.79)
8.5.7.2  Disturbance Rejection at Plant Input
	
c ij gij
gij
opt
ij
ij
2
=
= ψ ∆
	
(8.80)
	
|
|
|
(
)|
c ij
g
ij
ij
ij
2
= =
0
1
ψ
+∆
	
(8.81)
8.5.7.3  Disturbance Rejection at Plant Output
	
|
|
|
(
)
|
c
g
ij
gij
gij
opt
ij
ij
jj
jj
3
=
= ψ ∆−∆
	
(8.82)
	
|
|
(
)
c
g
ij
gij
ij
ij
jj
3
= =
+
0
1
ψ
∆
	
(8.83)
Uniform
PD
Parameter aij
Parameter aij
aij_min
aij_max
(a)
*
∆pij
*N
pij
Ima
Re
*N
pij
(b)
Δij
Δij
(c)
Non-
uniform PD
aij
N–ε
aij
N+ε
aij
N
Amax
*
∆pij
FIGURE 8.15
(a) and (c) Probability distribution of the parameter aij; (b) two possibilities of the maximum nonparametric 
uncertainty radii Δpij
* . (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)

217
Multi-Input Multi-Output Systems: Analysis and Control
where
	
ψ
∆
+
ij
ij
N
jj
jj
N
jj
p
p
g
=
+
*
*
1
(
)
	
(8.84)
and where the uncertainty is
	
0
0
≤
≤
≤
≤
=
|
|
,
|
|
,
*
*
Δ
Δ
Δ
Δ
ij
ij
jj
jj
p
p
i j
n
for
,
1,
,
…
	
The coupling effects, calculated for the pure diagonal compensator cases, result in three 
expressions (8.79), (8.81), and (8.83) that still present a nonzero value, even if (pij
N
* , pjj
N
* ) is 
selected so that the actual plant mismatching disappears (Δij = 0 and Δjj = 0). However, 
the  coupling effects obtained with the optimum non-diagonal compensators (see 
Equations  8.78, 8.80, and 8.82) tend to zero when the mismatching disappears (Δij = 0 
and Δjj = 0).
8.5.8  Quality Function of the Designed Compensator
Figure 8.16 shows the coupling bands for a common system. The | |
cij gij =0 case, com­
puted from Equations 8.79, 8.81, or 8.83, is the upper limit. The lower limit represents 
the ­minimum  coupling effect | |
cij g
g
ij
ij
opt
=
, obtained with the optimum element gij
opt from 
Equations 8.78, 8.80, or 8.82. This allow us to define a quality function ηij for a given non-
diagonal compensator gij (i ≠ j), so that
	
ηij
cij gij
cij gij
gij
(%)
log
max
0
max
=
=








=



100
10
/

















=




log
max
0
10
cij gij




=

















/max cij gij
gijopt












	
(8.85)
This quality function becomes a proximity measure of the coupling effect cij to the mini­
mum achievable coupling effect. Thus, the function is useful to quantify the amount of 
Maximum of cijgij = gij
opt 
Equations 8.78, 8.80,
8.82.
Maximum of cijgij = 0 
Equations 8.79, 8.81,
8.83.
Minimum of cijgij = 0 
Eqs. 8.79, 8.81,
8.83.
rad/s
20 log10|cij|
dB
FIGURE 8.16
Coupling effect bands with different non-diagonal compensators. (Adapted from Garcia-Sanz, M. and Houpis, 
C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and 
Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

218
Robust Control Engineering
loop interaction and to design the non-diagonal compensators. If ηij is closed to 100%, then 
the coupling effect is a minimum and the gij compensator tends to be the optimum one. 
A suitable non-diagonal compensator maximizes the quality function of Equation 8.85.
8.5.9  Design Methodology
With all the preliminary analysis, this section presents the steps we have to follow to 
design the MIMO QFT controller according to Method 1. The design method is a sequen­
tial procedure by closing the loops. It only needs to fulfill Hypothesis H1—see Equations 
8.63 and 8.64. For more details, Section 8.8 presents an example of the application of this 
methodology.
Step A: Controller Structure
First, find the most appropriate pairing for the inputs and outputs of the plant according 
to RGA technique—see Section 8.3.2 and Equations 8.23 through 8.27.
Second, find the appropriate structure for the controller matrix G(s). Typically, we need 
off-diagonal elements gij(s) for the controller G(s) in the positions ij where the loop coupling 
is significant. As a practical rule, the coupling between the loops i and j is considered impor­
tant when the absolute value of the corresponding RGA element is greater than 1.2 (or less 
than 0.8), or |λij| ≥ 1.2 (or |λij| ≤ 0.8). To keep the solution as simpler as possible, start with 
a triangular controller matrix G(s) if possible, and then add further elements if necessary.
Third, arrange the matrix P* so that q11 = (1/p11*) has the smallest bandwidth, q22 = (1/p22*) 
the next smallest bandwidth, and so on. The sequential compensator design technique, as 
described in Figure 8.17, is composed of the steps: A, B.i.1 to B.i.3, i = 1 to n (one for each 
column “i”), and C—see also Figure 8.19.
⇒
gnn
...
gnk
...
gn2
gn1
...
...
...
gkn
...
gkk
...
gk2
gk1
...
...
...
g2n
...
g2k
...
g22
g21
g1n
...
g1k
...
g12
g11
Step B.n
...
⇒
⇒
...
0
...
0
...
gn2
gn1
...
...
...
0
...
0
...
gk2
gk1
...
...
...
0
...
0
...
g22
g21
0
...
0
...
g12
g11
0
...
0
...
0
gn1
...
...
...
0
...
0
...
0
gk1
...
...
...
0
...
0
...
0
g21
0
...
0
...
0
g11
G =
Step B.1
Step B.2
FIGURE 8.17
Steps B.i, i = 1 to n columns, of the sequential design technique. (Adapted from Garcia-Sanz, M. and Houpis, 
C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and 
Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

219
Multi-Input Multi-Output Systems: Analysis and Control
Step B.i.1: Design of the Diagonal Controller Elements gii(s)
The design of the element gii is calculated using the standard QFT loop-shaping tech­
nique for the inverse of the equivalent plant qii = (1/pii
*e) and to achieve robust stability and 
robust performance specifications. The equivalent plant satisfies the recursive relation­
ship313 given by Equation 8.86.
 
p
p
p
g
ii
e
k
ii k
i i
k
i i
k
*
*
1
(
1)
*
1
1

= 

−


+ 

−
−
−
−
−
(
)
1
(
1)
*
1
(
)
1
(
1)(
1)
*
(
) 

+ 

(
)


−
−
−
−
−
−
−
p
g
p
i
i k
i
i k
i
i
k
1
1
(
1)(
1)
1
;
;
+ 

≥
−
−
−
=
=
g
i
k
i
i
k
k
[
]
P
P
*
*
1
	
(8.86)
This equation is an extension for the non-diagonal case of the recursive expression 
­proposed by Horowitz96 as the Improved Design Technique.
At this point, the design has also to meet two stability conditions:109 (a) Lii(s) = 
[pii
*e(s)]–1gii(s) has to satisfy the Nyquist encirclement condition and (b) no RHP pole-zero 
cancellations have to occur between gii(s) and qii(s) = [pii
*e(s)]–1—see Chapter 3.
If the system requires reference tracking specifications as a
j
t
j
b
j
ii
ii
y r
ii
(
)
(
)
(
)
/
ω
ω
ω
≤
≤
, since 
t
t
t
ii
y r
rii
cii
/ =
+
, the tracking bounds bii and aii are corrected to take into account the cross-
coupling specification τcii, so that (see also Equation 8.45)
	
b
b
T
a
a
T
ii
c
ii
c
ii
c
ii
c
ii
ii
=
−
=
+
,
	
(8.87)
	
t
w c
cii
ii
ii
cii
=
≤τ
	
(8.88)
	
a
b j
c
ii
c
rii
ii
j
t
j
(
)
(
)
(
)
ω
ω
ω
≤
≤
	
(8.89)
These are the same corrections proposed by Horowitz92,96 for their original MIMO QFT 
methods. However, for the non-diagonal compensator these corrections are less demand­
ing. The coupling expression tcii = wii cii is now minor as compared to the diagonal meth­
ods—for instance compare Equations 8.78 and 8.79. That is the off-diagonal elements gij 
(i ≠ j) of the matrix compensator attenuate or cancel the cross coupling effects. This results 
in the diagonal elements gii of the non-diagonal method requiring a smaller bandwidth 
than the diagonal elements of the diagonal compensator methods.
Step B.i.2: Design of the Diagonal Prefilter Elements fii(s)
The design of a prefilter F(s) is necessary in case of reference tracking specifications. As one 
of the objectives of the full-matrix controller G(s) is to reduce the loop interaction, the pre­
filter F(s) can be matrix diagonal. The fii(s) prefilter element is designed for the equivalent 
plant qii(s), and for the diagonal controller gii(s) designed in the previous Step B.i.1.
Step B.i.3: Design of the Non-Diagonal Controller Elements gji(s)
The (n–1) non-diagonal elements gji(j ≠ i, j = 1,2,…,n) of the j-th compensator column are 
designed to minimize the cross-coupling terms cji given by Equations 8.71 through 8.73. 
The optimum compensator elements described in Equations 8.75 through 8.77 are utilized 
in order to achieve this goal. After we finish the Steps B.i, i = 1 to n columns, we proceed 
with Step C.

220
Robust Control Engineering
Step C: Final Checks
Once the design of G(s) is finished, the system has to meet two additional stability condi­
tions:109 (c) no Smith-McMillan pole-zero cancellations have to occur between P(s) and G(s) 
and (d) no Smith-McMillan pole-zero cancellations have to occur in |P*(s) + G(s)|.
Also, although very remote, the possibility of introducing RHP transmission zeros due 
to the controller design theoretically exists. This undesirable situation cannot be detected 
until the whole multivariable system design is completed. To avoid this problem, the mul­
tivariable zeros of P(s)G(s) are determined using the Smith-McMillan form over the set of 
possible plants P due to the uncertainty. If there are no new RHP zeros apart from those 
that might already be present in P(s), the method concludes. Otherwise, we rectify this 
undesirable situation by modifying the non-diagonal elements placed in the last column 
of the matrix G(s), according to the Smith-McMillan expressions.115
8.5.10  Some Practical Issues
The sequential non-diagonal MIMO QFT techniques introduced in this chapter arrive at a 
robust stable closed-loop system if, for each P ∈ P,109
	
1.	Each Li(s) = (pii
*e)−1gii(s), i = 1, …,n, satisfies the Nyquist encirclement condition,
	
2.	No RHP pole-zero cancellations occur between gii(s) and (pii
*e)−1, i = 1,…,n,
	
3.	No Smith-McMillan pole-zero cancellations occur between P(s) and G(s), and
	
4.	No Smith-McMillan pole-zero cancellations occur in |P*(s) + G(s)|.
On the other hand, as mentioned, the resulting matrix PG should be checked to ensure 
that RHP transmission zeros or unstable modes have not been introduced by the new 
­compensator elements gkk or gik, which would obviously cause an unnecessary loss of 
­control performance. If these n.m.p. (non-minimum phase) zeros appear due to the 
designed compensator elements, supplementary constraints in the determinant of PG 
should be imposed to re-calculate the compensator.
Incidentally, arbitrarily picking the wrong order of the loops to be designed can result in 
the nonexistence of a solution. This may occur if the solution process is based on satisfy­
ing an upper limit of the phase margin frequency ωφ for each loop. To avoid that potential 
problem, as has been introduced in Step A of the methodology, loop i having the smallest 
phase margin frequency has to be chosen as the first loop to be designed. The loop that has 
the next smallest phase margin frequency is next, and so on.6,7
Finally, notice that the calculation of the equivalent plant qii = (1/pii
*e) needs the inverse of the 
plant matrix, and usually introduces some exact pole-zero cancellations. This operation can be 
precisely done with symbolic mathematic tools, but could be erroneous when using numerical 
calculations due to computer round errors. In MATLAB, the command qii = minreal(qii,tolMR) 
helps removing the extra zeros and poles erroneously introduced—see Appendix 8.
8.6  Non-Diagonal MIMO QFT—Method 27,119
Method 2 is a formal reformulation and generalization of Method 1. It avoids the former 
hypotheses of diagonal dominance and simplifies the calculations for the off-diagonal 

221
Multi-Input Multi-Output Systems: Analysis and Control
elements. The method also reformulates the classical matrix definition of MIMO specifi­
cations by designing a new set of loop-by-loop QFT bounds on the Nichols chart, with nec­
essary and sufficient conditions. It also gives explicit expressions to share the load among 
the loops of the MIMO system to achieve the matrix specifications. And all for stability, 
reference tracking, disturbance rejection at plant input and output, and noise attenuation 
problems.119
One of the most significant differences observed between H-infinity control techniques 
and MIMO QFT techniques is the way of defining the performance specifications. While 
classical techniques deal with a matrix definition of specifications (e.g., ||T(jω)||∞ < δ1 or 
||S(jω)||∞ < δ2), QFT describes the specifications in terms of a loop-by-loop definition (e.g., 
|tii(jω)| < δr(ω) or |sii(jω)| < δk(ω)). This fact is analyzed in Section 8.6.5, where the matrix 
MIMO specifications are formally translated into a set of loop-by-loop QFT bounds on the 
Nichols chart, with necessary and sufficient conditions.
Sections 8.6.1 through 8.6.5 introduce the reformulation of the full-matrix MIMO QFT 
technique. In particular, Sections 8.6.1 through 8.6.4 present the new methodology itself, 
and Section 8.6.5 presents the technique to translate the classical matrix specifications into 
the QFT methodology. Additionally, Section 8.9 presents a detailed example of the applica­
tion of the methodology.
8.6.1  Non-Diagonal MIMO QFT Reformulation
The first objective of the non-diagonal elements (gij, i ≠ j) of the full-matrix controller G(s) 
is to minimize the loop interactions (coupling). They act as feedforward functions, cancel­
ling some of the dynamics of the non-diagonal elements (pij, i ≠ j) of the plant matrix P(s). 
As a consequence, they are sensitive to model uncertainty. But their inclusion relieves the 
design of the diagonal compensators by reducing the amount of feedback (bandwidth) nec­
essary to fulfill the performance specifications. They can also be required to achieve inter­
nal stability in some systems where diagonal or triangular controllers are not enough.92 By 
contrast, the diagonal elements of the controller (gii) act as feedback functions, minimizing 
the effect of the uncertainty (sensitivity) and fulfilling the performance and stability speci­
fications. They also have to overcome the uncertainty of the non-diagonal plant elements 
(pij, i ≠ j), minimizing the residual coupling that the non-diagonal elements of the control­
ler (gij, i ≠ j) have not cancelled.
Taking these considerations as a starting point, the reformulation presented in this sec­
tion for the full-matrix controller design methodology adopts a four step procedure (A 
through D). The dominant characteristic of the system will determine the way of design­
ing the off-diagonal compensators: reference tracking or disturbance rejection at plant out­
put (Case 1, Section 8.6.2), or disturbance rejection at plant input (Case 2, Section 8.6.3). Of 
course, independently of which case is chosen, any type of specification (reference track­
ing, disturbance rejection at plant input and output, noise attenuation, etc.) can be intro­
duced if required when it comes to design the diagonal controller elements, as is usual 
within the QFT framework. The distinction is therefore just based on the role assigned to 
the off-diagonal compensators.
8.6.2  Case 1: Reference Tracking and Disturbance Rejection at Plant Output
Consider an n × n linear multivariable system—see Figure 8.11 with di’ = 0, composed of 
a plant P, a fully populated matrix controller G = Gα Gβ, a prefilter F, and a plant output 

222
Robust Control Engineering
disturbance transfer function Pdo, where P ∈ P, and P is the set of possible plants due to 
uncertainty, and,
	
P
F
=






=
p
p
p
p
p
p
p
p
p
f
n
n
n
n
nn
11
12
1
21
22
2
1
2
…
…
…
…
…
…
…
;
11
12
1
21
22
2
1
2
f
f
f
f
f
f
f
f
n
n
n
n
nn
…
…
…
…
…
…
…






  
	
(8.90)
	
G
G G
=






=
g
g
g
g
g
g
g
g
g
n
n
n
n
nn
11
12
1
21
22
2
1
2
…
…
…
…
…
…
…
α
β
α
α
α
α
α
α
α
α
α
α
;  
G =



g
g
g
g
g
g
g
g
g
n
n
n
n
nn
11
12
1
21
22
2
1
2
…
…
…
…
…
…
…




=






;
Gβ
β
β
β
g
g
gnn
11
22
0
0
0
0
0
0
…
…
…
…
…
…
…

	
(8.91)
Note that for the sake of clarity, the dependence on (s) is omitted in this section. The 
reference vector r’ and the external disturbance vector at plant output do’ are the inputs 
of the system. The output vector y is the variable to be controlled. The plant inverse P* is
	
P
P
−=
= 
=
1
11
12
1
21
22
2
1
2
*
p
p
p
p
p
p
p
p
p
p
ij
n
n
n
n
*
*
*
*
*
*
*
*
*







nn
*





	
(8.92)
8.6.2.1  Methodology
Step A: Controller Structure
In the same way as in Method 1 (Section 8.5.9, Step A), by using RGA265 over the frequen­
cies of interest—see Equation 8.93,260 and taking into account the requirement of mini­
mum complexity for the controller, the method identifies the input–output pairing and 
the most appropriate structure for the matrix compensator, that is, the required off-diag­
onal and diagonal elements, which correspond with the significant values of the RGA 
matrix.211
	
RGA j
j
j
T
(
)
(
)
(
(
))
ω
ω ⊗
ω
=
−
P
P
1
	
(8.93)
where ⊗ denotes element-by-element multiplication (see Section 8.3.2).

223
Multi-Input Multi-Output Systems: Analysis and Control
Step B: Design of Gα
The fully populated matrix controller G is composed of two matrices: G = GαGβ—see 
Equation 8.91. The main objective of the pre-compensator Gα is to diagonalize the plant P 
as much as possible. The initial expression used to determine Gα is
	
G
P
P
α
α
= 
=
=






−
g
p
ij
diag
jj
ji
ij
ˆ
ˆ
ˆ
ˆ
ˆ
1
∆
∆
	
(8.94)
where ˆP is a plant matrix selected within the uncertainty, ˆPdiag is its diagonal part, ˆΔ is the 
determinant of the ˆP matrix, and ˆ∆ji is the jith cofactor of the ˆP matrix. The plant matrix 
ˆP is selected so that the expression of the extended matrix in Equation 8.95 presents the 
closest form to a diagonal matrix, nulling the off-diagonal terms as much as possible.
	
P
PG
x
ij
x
p
=
= 

α
	
(8.95)
The starting point for the design of Gα is the well-known ideal decoupling method.268 
Further discussion on this subject is given in Remark 8.1. However, instead of performing 
it directly, and to avoid some of its drawbacks, the interest is focused on approximating the 
frequency response of the matrix in Equation 8.94 over the frequencies of interest and the 
uncertainty. Thus, the [gij
α] compensators are shaped following the mean value in magni­
tude and phase at every frequency of the region plotted by Equation 8.94 within the uncer­
tainty. Due to this uncertainty, no exact cancellation is achieved. The residual coupling is 
managed through the design of the diagonal feedback controller Gβ. Note that since the 
feedback compensators in Gβ are designed by robust MIMO QFT, and not as a decentral­
ized control system, the role of the controller Gα is not to achieve an exact decoupling, but 
to ease the design of Gβ. That is, to reduce the amount of feedback needed to achieve the 
robust performance specifications.
Besides, this approach allows modifying, when necessary, the final form of the control­
ler Gα in Equation 8.94 so that:
•	 No RHP or imaginary axis pole-zero cancellation occurs between P and Gα or its 
elements,
•	 No RHP transmission elements (Smith-McMillan) are introduced by the controller 
Gα,
•	 The relative difference of the number of poles and zeros in each element of 
the Gα matrix is the same as in Equation 8.94 in order to ease the design of the 
Gβ controller,
•	 The RGA of the system is improved, looking for positive and close-to-one diago­
nal elements λii of the RGA matrix. That is, the pre-compensator Gα decouples the 
system to some extent, which is its main goal.
Step C.i.1: Design of the Diagonal Controller Elements gii
β
After determining Gα, the method proceeds with the design of a diagonal matrix Gβ that 
fulfills the desired robust stability and robust performance specifications for the extended 
plant Px = PGα. Its inverse, the Px* matrix in Equation 8.96, is reorganized so that (p11
x*)−1 

224
Robust Control Engineering
has the smallest bandwidth, (p22
x*)−1 the next smallest bandwidth, and so on. This eases the 
existence of a solution and will avoid unnecessary overdesign related to the order in which 
loops are designed.6,7
	
P
P
x
x
ij
x
x
x
n
x
x
x
n
x
p
p
p
p
p
p
p
*
(
)
=
= 
=
−1
11
12
1
21
22
2
*
*
*
*
*
*
*







p
p
p
n
x
n
x
nn
x
1
2
*
*
*





	
(8.96)
The compensators gii
β (from i = 1 to n) are calculated by using the sequential (loop-by-
loop) standard QFT loop-shaping methodology for the inverse of the equivalent extended 
plant: qxii = [pii
x*e]i
−1. This satisfies the recursive relationship of Equation 8.97—see also 
Reference 313 with gij = 0, i ≠ j, and takes into account the compensator elements previ­
ously designed—this is the so-called sequential method.
	
p
p
p
p
ij
x e
k
ij
x
e
k
i k
x
e
k
k
j
x
*
*
*
*

= 

−


−
−
−
−
1
(
1)
1
(
1)
e
k
k
k
x
e
k
k
k
x e
p
g
i j
k




+
≥
−
−
−
−
−
−
1
(
1)(
1)
1
(
1)(
1)
;
,
;
*
β
P *


=
=
k
x
1
P *
	
(8.97)
The presence of model uncertainty reduces the diagonalization effect of the pre-­
compensator Gα over P. This diagonalization is a real cancellation only when the uncer­
tainty of the plant P is exactly at the working point ˆP, and PG
P P
P
P
α =
=
−
ˆ ˆ
ˆ
ˆ
1
diag
diag. If 
the plant P is working on a different point, the extended plant that the compensator Gβ 
sees includes off-diagonal elements as well. Consequently, the performance specifications 
(disturbance rejection) for the elements gii
β have to be more demanding in order to avoid 
the residual coupling. This is an easy solution when using this MIMO QFT methodology, 
which takes into account the coupling effect loop-by-loop.6,7
Step C.i.2: Design of the Diagonal Prefilter Elements fii
The design of a prefilter F is necessary in case of reference tracking specifications. As one 
of  the objectives of the full-matrix controller Gα is to reduce the loop interaction, the 
­prefilter F can be matrix diagonal. The fii prefilter element is designed for the equivalent 
extended plant, qxii = [pii
x*e]i
−1, and with the diagonal controller gii
β designed in the ­previous 
Step C.i.1.
After we finish the Steps C.i, i = 1 to n, we proceed with Step D.
Step D: Final Checks
Once the design of G = GαGβ has finished, the design has also to fulfill two more stability 
conditions:109 (c) no Smith-McMillan pole-zero cancellations have to occur between P and 
G and (d) no Smith-McMillan pole-zero cancellations have to occur in |P* + G|.
Also, although very remote, the possibility of introducing RHP transmission zeros due 
to the controller design theoretically exists. This undesirable situation cannot be detected 
until the whole multivariable system design is completed. To avoid this problem, the 
multivariable zeros of PG are determined using the Smith-McMillan form over the set 
of possible plants P due to the uncertainty. If there are no new RHP zeros apart from 
those that might already be present in P, the method concludes. Otherwise, we rectify this 

225
Multi-Input Multi-Output Systems: Analysis and Control
undesirable situation by modifying the non-diagonal elements placed in the last column 
of the matrix G, according to the Smith-McMillan expressions.115
Analysis of the 2 × 2 Case
By using Equations 8.90 through 8.92 and 8.94, the expression of the final controller G for 
a 2 × 2 MIMO plant is
	
G
G G
=
=





=
−
α
β
β
g
g
g
g
p
p
p
p
p
p
g
11
12
21
22
11
22
11
22
12
21
11
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
 
−
−
−
−
ˆ
ˆ
(ˆ
ˆ
/ ˆ )
ˆ
ˆ
(ˆ
ˆ
/ ˆ )
p
p
p
p
p
g
p
p
p
p
p
g
12
11
12
21
22
22
21
22
12
21
11
 
 
β
11
11
22
11
22
12
21
22
β
β
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
p
p
p
p
p
p
g
−






 
	
(8.98)
For tracking or disturbance rejection at plant output, the expression for 2 × 2 MIMO 
plants of the previous non-diagonal MIMO QFT methodology (see Method 1, Sections 8.5.1 
through 8.5.10) was:
	
G =





=
−
−



g
g
g
g
g
p
p
g
p
p
g
g
11
12
21
22
11
12
11
22
21
22
11
22
ˆ
ˆ
ˆ
ˆ
 
 




	
(8.99)
Method 2 is more general than Method 1, as it does not need the hypothesis described in 
Equations 8.63 and 8.64. The resulting off-diagonal compensators, given by Equation 8.98, 
are the same as those of Method 1, given by Equation 8.99, plus some new terms. Precisely, 
these new terms in Equation 8.98 disappear and the diagonal compensators reduce to the 
feedback ones if ˆ
ˆ
ˆ
ˆ
p
p
p
p
11
22
12
21
≫
(
) is applied, which is the diagonal dominance hypoth­
esis of the Method 1—see Equations 8.63 and 8.64. Thus, Method 2 generalizes and broadens 
the scope of the preceding Method 1. Further discussion on the comparison of both tech­
niques is developed in Section 8.7.
Remark 8.1
Ideal decoupling belongs to the more general group of inverse-based controllers, and has 
been extensively discussed, especially in the chemical engineering literature and in the 
context of distillation columns.239,268,286,292 The works mentioned, which are solely based 
upon observation of the dual composition control of distillation towers,314 encountered 
some drawbacks for this inverse-based approach, such as the sensitivity of decouplers to 
modeling errors or the possibly complicated expressions for the decouplers.
However, Method 2 uses ideal decoupling just as a starting expression for Equation 8.94, 
whose frequency response is approximated in the range of frequencies of interest and for the 
existing uncertainty. This avoids the use of excessively complicated expressions, potential 
problems of realization and implementation, and the cancellation of RHP elements—see 
Section 8.6.2, Step B. Moreover, the subsequent Gβ feedback controller is designed through 
MIMO QFT, by taking into account the residual coupling, and not through decentralized 
control, which has been the approach traditionally used in conjunction with decoupling.

226
Robust Control Engineering
On the other hand, there exists high sensitivity of inverse-based controllers to input uncer­
tainty when the plant has large RGA elements.260,303 If the input uncertainty is critical for 
the system under study, the designer should then consider the off-diagonal compensators 
as a means of fighting against this disturbance at the plant input, and consequently select 
Case 2 (Section 8.6.3) for their design. Likewise, for extreme cases, one-way or triangular 
decouplers could be applied instead, since they are much less sensitive to input uncertainty.
Remark 8.2
Notice that if the plant P(s) has no uncertainty and the resulting controller Gα(s) = P–1(s) 
Pdiag(s) is stable, minimum phase, and proper, then P(s)Gα(s) = Pdiag(s) exactly. As a result, 
the design of Gβ(s) is very simple. It does not need Equation 8.97, and is carried out as n 
SISO systems: that is, g11
β(s) for p11(s), g22
β(s) for p22(s), and so on.
8.6.3  Case 2: Disturbance Rejection at Plant Input
In case the designer wants to use the off-diagonal compensators to deal with disturbance 
rejection at plant input specifications—see Figure 8.11 with r’ = 0 and do’ = 0, the control­
ler design methodology is based on the one defined in References 6, 7, 110, 114, 115, 206, 209, 
and 211, with some additional modifications and remarks. Now the full-matrix controller 
is given by G = Gd + Gb, where
	
G
G
=






=
+
g
g
g
g
g
g
g
g
g
n
n
n
n
nn
d
11
12
1
21
22
2
1
2
…
…
…
…
…
…
…
G
G
G
b
d
nn
b
g
g
g
g
;  
=






=
11
22
12
0
0
0
0
0
0
0
…
…
…
…
…
…
…
…
;
g
g
g
g
g
n
n
n
n
1
21
2
1
2
0
0
…
…
…
…
…
…





	
(8.100)
and the transfer function between the disturbance di and the output y is
	
y
I
PG
Pd
P
G
d
=
+
=
+
−
−
[
]
[
]
1
1
i
i
*
	
(8.101)
In this particular case, the objectives of the controller are to reject external distur­
bances at plant input di and to reduce the loop interaction. In other words, the ­disturbance 
­rejection  specification can be defined as a diagonal matrix TD = [tdii] = y/di, which in 
Equation 8.101 is
	
T
P
G
D =
+
−
(
)
*
1
	
(8.102)
or,
	
G
T
P
=
−
−
−
D
1
1
	
(8.103)
The methodology for this Case 2 follows the same steps discussed for Case 1, Section 
8.6.2, with the changes in Steps B and C.i.1 presented below.

227
Multi-Input Multi-Output Systems: Analysis and Control
Step B: Design of Gb
Based on Equation 8.103, the off-diagonal elements gij (i ≠ j) of the controller (Gb part) are 
calculated first, so that
	
g i
j
p
ij
ij
(
)
≠
= −
* 	
(8.104)
where (∧) denotes the plant that minimizes the maximum of the nonparametric 
­uncertainty radii comprising the plant templates on the Nichols chart.6,7 That is to 
say, the compensator gij (i ≠ j) is shaped following the mean value at every frequency 
ω ∈ [ωmin, ωmax] of the region plotted by the uncertain plants [–pij*] in magnitude and 
phase.
Step C.i.1: Design of Gd
The diagonal elements gii(s) are calculated through standard QFT loop shaping and for the 
inverse of the equivalent plant qii = [pii
*e]k
−1. As always, they can consider robust stability 
and robust performance specifications.6,7,110,114,115,206,209,211 The equivalent plant satisfies the 
recursive relationship Equation 8.105.313
p
s
p
s
p
s
g
ij
e
k
ij
e
k
i k
e
k
i
*
*
1
(
1)
*
1
( )
( )
( )

= 

−


+
−
−
−
(
1)
(
1)
*
1
(
)
1
k
k
k
j
e
k
k
j
k
s
p
s
g
s
−
−
−
−
−
−


(
) 

+ 

(
( )
( )
( )
1
1
)


+ 

≥
−
−
−
−
−
−
p
s
g
s
i j
k
k
k
e
k
k
k
k
(
1)(
1)
*
1
(
1)(
1)
1
; ,
;
( )
( )
P*
*
e
k
s
s
( )
( )


=
=1
P
	
(8.105)
Based on Equation 8.103, a starting expression for the diagonal elements gii in the loop-
shaping stage could be: g
t
p
ii
dii
ii
=
−
∗
∗ˆ .
8.6.4  Stability Conditions and Final Implementation
Stability Conditions. The closed-loop stability of the MIMO system with the full-matrix 
­controller G = [gij] is guaranteed by the following sufficient conditions, previously 
­introduced in Section 8.5.10:109
c1. Each Li(s) = aii(s)bii(s), i = 1, …,n, satisfies the Nyquist encirclement condition, 
where aii(s) = gii
β(s), bii(s) = [pii
x*e(s)]i
−1 for Case 1 (Section 8.6.2), and aii(s) = gii(s), 
bii(s) = [pii
*e(s)]i
−1 for Case 2 (Section 8.6.3),
c2. No RHP pole-zero cancellations occur between aii(s) and bii(s), i = 1,…,n, aii(s) and 
bii(s) being those defined in the previous point,
c3. No Smith-McMillan pole-zero cancellations occur between P(s) and G(s), and
c4. No Smith-McMillan pole-zero cancellations occur in |P*(s) + G(s)|.
Conditions c1 and c2 are checked loop-by-loop when the compensators aii(s) are calcu­
lated in Step C, where aii(s) = gii
β(s) and aii(s) = gii(s), for Case 1 and Case 2, respectively. 
Conditions c3 and c4 are checked after Step C is finished.

228
Robust Control Engineering
Final Implementation
The final implementation of the full-matrix controller G (either GαGβ or Gd + Gb) will take 
the form
	
F
F
g
F
g
F
g
F
g
F
g
F
g
pd
pd
pd
pd
n
pd
pd
pd
n
( )
(
)
(
)
(
)
(
)
(
)
(
)
G =
11
12
1
21
22
2
…
…
…
…
…
…
…
F
g
F
g
F
g
pd
n
pd
n
pd
nn
(
)
(
)
(
)
1
2





	
(8.106)
where the function Fpd(A) means in every case a proper and causal function. If it is neces­
sary to make any modification to get a proper function, it will preserve the dominant poles 
and zeros (low and medium frequency) of the expression A.
Remark 8.3
Once the design is completed, the Smith-McMillan form of the matrix compensator G(s) 
must be analyzed to check whether it has introduced additional RHP transmission zeros. 
If so, a redesign of the non-diagonal elements of the last column of the compensator can 
typically fix the problem.115
8.6.5  Translating Matrix Performance Specifications119
One of the main differences between MIMO QFT techniques and the H-infinity MIMO 
control methods is the way to define the specifications. While the latter are able to define 
them in terms of matrices (SVD, ||T(jω)||∞ < δ1 or ||S(jω)||∞ < δ2, etc.), QFT usually does 
the work loop-by-loop.
Once the equilibrium among loops is attained, the interaction between the loops becomes 
a trade-off, and the burden on any loop cannot be reduced without increasing it on some 
other loops. In this section an approach to deal with the classical matrix specifications 
within QFT is introduced, solving the mentioned problem.
8.6.5.1  Case n × n
Consider an n × n linear MIMO system (Figure 8.11), composed of a set of uncertain plants, 
P(jωi) = {P(jωi), ωi∈∪Ωk}, a full-matrix controller G, and a prefilter F, both to be designed. r, 
n, di, do, and y are vectors representing respectively the reference input, sensor noise input, 
external disturbances at plant input and output, and plant output.
Tracking
Looking at Figure 8.11, the reference tracking problem gives the following matrix equations:
	
y
T r
=
	
(8.107)
	
y
P
G
G F r
=
+
−
[
]
*
1
	
(8.108)
	
[
]
P
G T
G F
* +
=
	
(8.109)
Disturbance Rejection at Plant Output
Analogously, the disturbance rejection at plant output problem gives the following matrix 
equations:

229
Multi-Input Multi-Output Systems: Analysis and Control
	
y
S d
=
o
o 	
(8.110)
	
y
P
G
P d
=
+
−
[
]
*
*
1
o 	
(8.111)
	
[
]
P
G S
P
*
*
+
=
o
	
(8.112)
Disturbance Rejection at Plant Input
In the same way, the disturbance rejection at plant input problem gives the following 
matrix equations:
	
y
S d
=
i
i 	
(8.113)
	
y
P
G
d
=
+
−
[
]
*
1
i 	
(8.114)
	
[
]
P
G S
I
* +
=
i
	
(8.115)
Noise Attenuation
Finally, the noise attenuation problem yields:
	
y
S n
=
n
	
(8.116)
	
y
P
G
G n
=
+
−
−
[
] (
)
*
1
	
(8.117)
	
[
]
P
G S
G
* +
= −
n
	
(8.118)
General Expression
The four previous problems (Equations 8.109, 8.112, 8.115, and 8.118) can be written in a 
compact form, so that,
	
[
]
P
G
* +
=
α
β	
(8.119)
where, depending on the case, the matrices α and β are defined so that,
•	 Tracking: α
β
=
=
T
G F
;
•	 Disturbance rejection at plant output: α
β
=
=
S
P
o;
*
•	 Disturbance rejection at plant input: α
β
=
=
S
I
i;
•	 Noise attenuation: α
β
=
=−
S
G
n;
Now, in order to make (P* + G) in Equation 8.119 a triangular matrix (which allows 
explicit expressions for each loop problem), and following the Gauss elimination method, 
the equation is pre-multiplied by

230
Robust Control Engineering
(
...
)
M
M
M
M
n
n
n
−
−
−
1
2
3
1  so that,
	
M
M
M
M P
G
M
M
M
M
n
n
n
n
n
n
−
−
−
−
−
+
=
1
2
3
1
1
2
3
1
−…
…
[
]
*
α
β 	
(8.120)
where
	
M
Column k
k
k
k
k
k
k
p
g
p
=
−
+
(
)
+
+
( )
,
*
,
1
0
0
0
0
1
0
0
0
0
1
0
0
0
1
1













k k
k
k k
n k
k
n k
k k
k
k k
g
p
g
p
g
,
*
,
,
*
,
,
*
,
(
)
+
−
+
(
)
+

+









0
0
0
1
row k
1




	
(8.121)
	
p
p
p
g
p
g
p
ij
k
ij
k
i k
k
i k
k
j
k
k
j
k
k
*
*
,
*
,
,
*
,
,
=
−
+
(
)
+
(
)
−
−
−
−
−
−
−
−
1
1
1
1
1
1
1
1
−
−
−
−
−
+
=
=
=

=
1
1
1
1
1
1
1
*
,
*
;
;
;
[ ]
k
k
k
ij
g
i
k
n j
k
n k
n
p
for
and



P
	
(8.122)
After some calculations, the first part of Equation 8.120 is
	
M
M
M
M P
G
n
n
n
k
k
k
k
n
k
k
k
k
p
g
p
g
−
−
−
=
=
+
=
+
(
)
+
(
)
∑
1
2
3
1
1
1
1
1
1
1
1
1
2
…
[
]
*
*
*
α
α
α
1
1
1
1
1
2
2
2
1
2
2
2
2
2
n
k
k
k n
k
n
k
k
k
k
n
k
k
k
k
p
g
p
g
p
g
∑
∑
∑
+
(
)
+
(
)
+
(
)
=
=

*
*
*
α
α
α
=
=
=
∑
∑
∑
+
(
)
+
(
)
+
(
2
2
2
2
2
1
n
k
k
k n
k
n
nk
n
nk
k
k
n
n
nk
n
nk
p
g
p
g
p
g





*
*
*
α
α
)
+
(
)






=
=
∑
∑
α
α
k
k
n
n
nk
n
nk
k n
k
n
n
p
g
2

*
	
(8.123)
In other words, in terms of the element ij of the matrix,
	
M
M
M
M P
G
n
n
n
ik
i
ik
kj
k
i
n
ij
p
g
i
−
−
−
=
+
=
+
(
)






∑
1
2
3
1
…
[
]
*
*
α
α
for
=
=
1
1


n j
n
;
	
(8.124)

231
Multi-Input Multi-Output Systems: Analysis and Control
with
	
p
p
p
g
p
g
p
ik
i
ik
i
i i
i
i i
i
k
i
i
k
i
i
*
*
,
*
,
,
*
,
,
=
−
+
(
)
+
(
)
−
−
−
−
−
−
−
−
1
1
1
1
1
1
1
1 −
−
−
−
−
+
=
=

=
1
1
1
1
1
1
1
1
*
,
*
;
;
[ ]
i
i
i
ik
g
i
n j
n
p
for
and


P
	
(8.125)
making
	
q
p
L
q g
ii
i
ii
i
i
i
ii
i
ii
=
=
1
* ;
and
	
(8.126)
Equation 8.124 becomes,
	
M
M
M
M P
G
n
n
n
i
i
ii
i
ij
ik
i
ik
kj
k
i
n
L
q
p
g
−
−
−
= +
+
=
+
+
+
(
)

∑
1
2
3
1
1
1
…
[
]
*
*
α
α
α





=
=
ij
i
n j
n
for
1
1


;
	
(8.127)
	
[
]
αij
o
=
T
S
(for tracking)
(for disturbance rejection at plant ouput))
(for disturbance rejection at plant input)
(for noise attenu
S
S
i
n
ation)





	
(8.128)
Analogously, after some calculations, the second part of Equation 8.120 is
	
M
M
M
M
n
n
n
ix
xj
x
i
ij
a
−
−
−
=
−
=





+






∑
1
2
3
1
1
1
…
β
β
β
ij 	
(8.129)
where,
	
a
i
j
a
i
j
a
p
g
p
g
ij
ij
ij
ab
b
ab
bb
b
bb
m
=
=
=
<
=
−
+
(
)
+
(
)
1
0
(
);
(
);
*
*
if
if
elements
from
to
1
1 elements
if
∏
∑
=
= −
−−
−






>
m
m i
j
i
j
m
i
j
1
(
)
	
(8.130)
and where all the possible combinations of couples ab from a = i to b = j exist, without 
repetition of couples ab and with a ≠ b, with:
	
i
j
m
i
j
m
i
j
m
m
i
j
−−
−





=
−−
−
−−
≤
−
≤
−−
1
1
1
1
0
1
1
(
)!
(
)!(
)!
(
)
(
);
(
)
1≤
≤
−
m
i
j 	

232
Robust Control Engineering
and where
	
[
]
βij =
G F
P
(for tracking)
(for disturbance rejection at plant oupu
*
t)
(for disturbance rejection at plant input)
(for noise attenu
I
G
−
ation)





	
(8.131)
Combining Equation 8.127 through 8.131 in Equation 8.120, the explicit expression of αij is
	
α
β
β
α
ij
ii
i
i
i
ix
xj
x
i
ij
ik
i
ik
k
q
L
a
p
g
=
+





+
−
+
(
)
=
−
∑
1
1
1
*
j
k
i
n
ij
= +∑






1
	
(8.132)
Now, (1) defining the desired matrix performance specification and its elements τ = [τij] 
for the matrices α = [αij], where α = T or α = So or α = Si or α = Sn (depending on the 
case); (2) comparing the particular element αij of Equation 8.132 with its specification, 
αij ≤ τij; and (3) substituting the remaining αkj (k = i + 1 to n), which are still unknown, with 
their correspondent specification τkj, the general expression for the performance specifica­
tions becomes
	
q
L
a
p
g
ii
i
i
i
ij
ix
xj
x
i
ij
ik
i
ik
kj
k
i
1
1
1
+
≤





+
−
+
(
)
=
−
=
∑
τ
β
β
τ
*
+
∑






1
n
ij max 	
(8.133)
where
	
a
i
x
a
i
x
a
p
g
p
g
ix
ix
ix
ab
b
ab
bb
b
bb
m
=
=
=
<
=
−
+
(
)
+
(
)
1
0
(
);
(
);
*
*
if
if
elements
from
to
1
1 elements
if
∏
∑
=
= −
−−
−






>
m
m i x
i x
m
i
x
1
(
)
	
and where all the possible combinations of couples ab from a = i to b = x exist, without 
repetition of couples ab and with a ≠ b, with:
	
i
x
m
i
x
m
i
x
m
m
i
x
−−
−





=
−−
−
−−
≤
−
≤
−−
1
1
1
1
0
1
1
(
)!
(
)!(
)!
(
)
(
);
(
)
1≤
≤
−
m
i
x 	
for the element ij, and where the elements of αij have been replaced with their specification 
τij, and where:
•	 Tracking: [
]
( );
[
]
τij
ij
spec
=
=
T
G F
β
•	 Disturbance rejection at plant output: [
]
(
);
[
]
*
τij
o
ij
spec
=
=
S
P
β

233
Multi-Input Multi-Output Systems: Analysis and Control
•	 Disturbance rejection at plant input: [
]
( );
[
]
τij
i
ij
spec
=
=
S
I
β
•	 Noise attenuation: [
]
(
);
[
]
τij
n
ij
spec
=
=−
S
G
β
The notation | |max
•
 in Equation 8.133 means the maximum absolute value within the 
plant uncertainty. This expression describes the sufficient condition (Csuf) to fulfill the 
specification. It is also possible to define a necessary condition (Cnec) to fulfill the specifica­
tion with the notation | |min
•
, which means the minimum absolute value within the plant 
uncertainty. In other words:
	
q
L
C
C
ii
i
i
i
suf
nec
1+
≤
≤
	
(8.134)
where the sufficient condition Csuf is
	
C
a
p
g
suf
ij
ix
xj
x
i
ij
ik
i
ik
kj
k
i
n
=





+
−
+
(
)

=
−
= +
∑
∑
τ
β
β
τ
1
1
1
*




ij max 	
(8.135)
and the necessary condition Cnec is
	
C
a
p
g
nec
ij
ix
xj
x
i
ij
ik
i
ik
kj
k
i
n
=





+
−
+
(
)

=
−
= +
∑
∑
τ
β
β
τ
1
1
1
*




ij min 	
(8.136)
These last equations generate two different bounds on the Nichols chart for the loop-by-
loop controller design method: the sufficient bound and the necessary bound for every type 
of matrix specifications and every frequency (see Figure 8.18). The controller design stage 
(loop shaping) will consider both, depending on the level of conservativeness/robustness 
needed for the design.
Remark 8.4
It is through the corresponding matrix [τij] for each case (tracking, disturbance rejection at 
plant output and plant input, and noise attenuation) that global matrix specifications can 
be taken into account. The designer has at his/her disposal a tool of great versatility. On 
the one hand, the control engineer can deliberately decide how much burden is allocated 
to each loop on the basis of the constraints that a particular application presents (restric­
tions on bandwidth, presence of flexible modes, noise, capacity of actuators, ­precision 
needed for a particular output, etc.), which are the real engineering requirements. In this 
decision on how to share the load among loops in a realistic way (i.e., not demanding 
simultaneously unachievable loop performance levels), the explicit expressions on interac­
tion among loop specifications developed for the case 2 × 2 in the next section are used as 
a guideline. The specification matrix elements τij are then accordingly shaped.
At the same time and prior to the design, the designer can make sure that these specifi­
cations fulfill a required H-infinity norm (or even the desired frequency response for the 
maximum singular value of the matrix). This is an additional step which is not typically con­
sidered in MIMO QFT techniques, where the H-infinity norm behavior has to be assessed 

234
Robust Control Engineering
after the design is performed. The approach introduced in this section allows the QFT 
designer to make sure that the defined specifications fulfill the matrix requirements as well.
Of course, it leads to choosing one among many possibilities, but this is a degree of free­
dom explicitly and deliberately used by the control engineer prior to the controller design 
and on the basis of the rest of the engineering requirements.
On the other hand, if the focus is on optimizing the H-infinity norm instead of prede­
termining the directionality of the specification matrix [τij], an H-infinity design could be 
previously performed. The resulting τij, optimum from the H-infinity point of view, could 
then be introduced as specifications for this procedure. In both situations, the methodol­
ogy assures the translation of constraints on all matrix elements to requirements on the 
design of each feedback loop. Besides, these translated specifications can be combined 
with classical QFT loop-by-loop specifications.
8.6.5.2  Case 2 × 2
In this section, Equation 8.133 is particularized for the case 2 × 2, and for the four classical 
problems: tracking, disturbance rejection at plant output and input, and noise attenuation.
Tracking
Consider the following specifications:
	
y
y
a
t
b
a
t
b
r
r
1
2
11
11
11
22
22
22
1
2
0
0





=
≤
≤
≤
≤












(for tracking)
	
(8.137)
Open-loop phase (deg)
–270
–225
–180
–135
–90
Open-loop gain (dB)
–30
–25
–20
–15
–10
–5
0
5
10
15
Suf
Nec
Nec
Suf
Nec
Suf
Nec
Suf
2 rad/s
4 rad/s
0.1 rad/s
0.4 rad/s
FIGURE 8.18
Example: Necessary and sufficient QFT bounds for matrix specifications on S(s). (Adapted from Garcia-Sanz, M. 
and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine 
Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

235
Multi-Input Multi-Output Systems: Analysis and Control
	
y
y
r
r
c
c
c
c
1
2
11
12
21
22
1
2





=












τ
τ
τ
τ
(for coupling attenuation)
	
(8.138)
Now, Equation 8.133 yields the following sufficient conditions:
•	 Loop 1
	
′ ≤
+
≤′
′ =
+
′ =
−
a
L
L
b
a
a
b
b
c
c
11
1
1
1
1
11
11
11
11
11
11
11
1
with
τ
τ
;
	
(8.139)
	
q
L
q
g
c
c
11
1
1
1
11
12
1
12
21
1
1
+
+
≤
(
)
(
)
τ
τ
/
max 	
(8.140)
	
q
L
g
q
g
b
c
11
1
1
1
12
12
12
1
12
22
1
1
+
≤
−(
)+
(
)
τ
/
max 	
(8.141)
•	 Loop 2
	
′ ≤
+
≤′
′ =
+
′ =
−
a
L
L
b
a
a
b
b
c
c
22
2
2
2
2
22
22
22
22
22
22
22
1
with
τ
τ
;
	
(8.142)
	
q
L
q
L
q
g
g
c
22
2
2
2
22
11
1
1
1
21
1
21
12
1
1
1
+
≤
+
(
) (
)+
(
)
τ
/
/
max 	
(8.143)
	
q
L
g
q
L
q
g
g
c
22
2
2
2
21
21
11
1
1
1
21
1
21
11
1
1
1
+
≤
−
+
(
) (
)+
(
)
τ
/
/
max 	
(8.144)
Note that there is a specific interaction between Equations 8.140 and 8.144, through the 
definition of the specification τc21, and between Equations 8.141 and 8.142, through the 
definition of the specification b22. If τc21 is higher, then Equation 8.140 is more demand­
ing and Equation 8.144 is less so. Analogously, if b22 is higher, then Equation 8.141 is 
more demanding and Equation 8.142 is less. As a consequence, the proper definition 
of the specifications τc21 and b22 establishes a load-sharing between the loops 1 and 2. 
Observe that this is not the typical trade-off between performance and coupling con­
cerning specifications from the same loop, but a trade-off of design burden among per­
formance specifications from different loops. This load-sharing problem shows that, 
when it comes to define the specifications, the designer cannot demand too much to 
a loop without affecting the achievable performance of the rest of the loops, and can 
therefore be used as a guideline.

236
Robust Control Engineering
Disturbance Rejection at Plant Output
Consider the following specifications:
	
y
y
d
d
so
so
so
so
o
o
1
2
11
12
21
22
1
2





=












τ
τ
τ
τ
	
(8.145)
	
Now, Equation 8.133 yields the following sufficient conditions,
•	 Loop 1
	
q
L
q
q
g
so
so
11
1
1
1
11
11
1
12
1
12
21
1
1
1
+
≤
(
)−(
)+
(
)
τ
τ
/
/
max 	
(8.146)
	
q
L
q
q
g
so
so
11
1
1
1
12
12
1
12
1
12
22
1
1
1
+
≤
−(
)+
(
)
τ
τ
/
max 	
(8.147)
•	 Loop 2
	
q
L
q
q
L
q
g
q
so
22
2
2
2
22
22
1
11
1
1
1
21
1
21
12
1
1
1
1
1
1
+
≤
−+
(
)+
(
)
τ
/
max 	
(8.148)
	
q
L
q
L
q
g
so
22
2
2
2
21
21
1
1
1
21
1
21
1
1
1
1
1
+
≤
−+
(
)+
(
)
τ
/
max 	
(8.149)
As for reference tracking, there exists a load-sharing between loops 1 and 2 through the 
specifications τso21 and τso22.
Disturbance Rejection at Plant Input
Consider the following specifications:
	
y
y
d
d
si
si
si
si
i
i
1
2
11
12
21
22
1
2





=












τ
τ
τ
τ
	
(8.150)
	
Now, Equation 8.133 yields the following sufficient conditions,
•	 Loop 1
	
q
L
q
g
si
si
11
1
1
1
11
12
1
12
21
1
1
1
+
≤
−(
)+
(
)
τ
τ
/
max 	
(8.151)

237
Multi-Input Multi-Output Systems: Analysis and Control
	
q
L
q
g
si
si
11
1
1
1
12
12
1
12
22
1
1
+
≤
(
)+
(
)
τ
τ
/
max 	
(8.152)
•	 Loop 2
	
q
L
si
22
2
2
2
22
1+
≤τ
	
(8.153)
	
q
L
q
L
q
g
si
22
2
2
2
21
11
1
1
1
21
1
21
1
1
1
+
≤
+
(
)+
(
)
τ
/
max 	
(8.154)
Again, a load-sharing appears between loops 1 and 2 through specification elements τsi21 
and τsi22.
Noise Attenuation
Consider the following specifications:
	
y
y
b
b
n
n
n
sn
sn
n
1
2
11
12
21
22
1
2





=












τ
τ
(for noise attenuation)
	
(8.155)
	
y
y
n
n
nc
nc
1
2
11
22
1
2
0
0





=












τ
τ
(for coupling attenuation)
	
(8.156)
	
Now, Equation 8.133 yields the following sufficient conditions,
•	 Loop 1
	
L
L
b
b
b
n
n
n
nc
1
1
1
1
11
11
11
11
1+
≤′
′
=
−
with
τ
	
(8.157)
	
q
L
q
g
nc
sn
11
1
1
1
11
12
1
12
21
1
1
+
≤
(
)+
(
)
τ
τ
/
max 	
(8.158)
	
q
L
g
q
g
b
sn
n
11
1
1
1
12
12
12
1
12
22
1
1
+
≤
−
−(
)+
(
)
τ
/
max 	
(8.159)

238
Robust Control Engineering
•	 Loop 2
	
L
L
b
b
b
n
n
n
nc
2
2
2
2
22
22
22
22
1+
≤′
′
=
−
with
τ
	
(8.160)
	
q
L
q
L
q
g
g
nc
22
2
2
2
22
11
1
1
1
21
1
21
12
1
1
1
+
≤
+
(
)+
(
)
τ
/
max 	
(8.161)
	
q
L
g
q
L
q
g
g
sn
22
2
2
2
21
21
11
1
1
1
21
1
21
11
1
1
1
+
≤
−
−+
(
)+
(
)
τ
/
max 	
(8.162)
As above, specific interaction appears between loop 1 and 2 specifications through the 
τsn21 and bn22 elements.
8.7  Comparison of Methods 1 and 27
This section makes a comparison between the two methodologies introduced in this 
chapter: Method 1 and Method 2. Both techniques are based on the same principle: the 
off-diagonal compensators play the role of feedforward functions that reduce the cou­
pling and facilitate the design of the diagonal compensators, which are feedback func­
tions in charge of fulfilling the robust stability and robust performance specifications. 
Additionally, for Method 2, and particularly for its Case 1 (Section 8.6.2), the diagonal 
elements are also directly involved in coping with coupling (the pre-compensator Gα is a 
full-matrix).
The existence of plant uncertainty causes the decoupling (feedforward) to be inexact. This 
residual coupling, however, is taken into account through a proper design of the diagonal 
compensators (feedback). Beyond these similarities, the way in which off-diagonal com­
pensators are designed, and the procedure itself, is different for the two methodologies.
Method 1 requires a diagonal dominance hypothesis on the plant, limiting the applica­
tion of the technique. This hypothesis is a fundamental requirement on the plant itself, and 
essential to obtain explicit expressions of the coupling matrices, which are defined therein 
to quantitatively compute the coupling. Besides, it allows two simplifications leading to the 
explicit optimal expressions for the off-diagonal compensators. By contrast, Method 2 no 
longer needs such a hypothesis or any simplification. As a result, this removal extends the 
application of the method to a larger scope of plants. Furthermore, as is shown in Section 
8.6.2, the expressions obtained for the off-diagonal compensators in Equation 8.98 are the 
same as those of the former method Equation 8.99 plus some new terms which disappear 
if the abovementioned diagonal dominance hypothesis is applied. So, Method 2 generalizes 
Method 1 and extends its field of application.

239
Multi-Input Multi-Output Systems: Analysis and Control
Additionally, the procedure has been simplified. In Method 1, the approach is per­
formed by columns, designing first the diagonal compensator and then the off-diago­
nal elements of each column, which is somehow a complicated procedure. In the case 
of needing a redesign in any diagonal compensator, it implies the redesign of all the 
elements, diagonal and off-diagonal, from the subsequent loops. However, Method 2 
performs separately the design of the off-diagonal and the diagonal part. Regardless 
of the case chosen (Case 1, Section 8.6.2, or Case 2, Section 8.6.3), when it comes to 
designing the feedback diagonal compensators, all the feedforward off-diagonal ele­
ments have already been determined. Finally, both methods allow the introduction 
not only of classical QFT specifications but also of classical matrix specifications, and 
provide the guideline to perform a load-sharing among loops, distributing the burden 
as needed.
Step C
Final checks
matrix stability, transmission zeros
Step B.1
Column 1
Step A
Controller structure
RGA, pairing, structure
Step B.2
Column 2
Step B.2.1
Design diagonal controller g22(s)
q22(s), g22(s), stability of q22(s) g22(s)
Step B.2.2
Design diagonal preﬁlter f22(s)
for q22(s) and g22(s)
Step B.2.3
Design non-diagonal controller g12(s)
to minimize c3_12(s)
Step B.1.1
Design diagonal controller g11(s)
q11(s), g11(s), stability of q11(s) g11(s)
Step B.1.2
Design diagonal preﬁlter f11(s)
for q11(s) and g11(s) 
Step B.1.3 
Design non-diagonal controller g21(s)
to minimize c3_21(s)
FIGURE 8.19
Flow chart of the MIMO QFT Method 1 for the heat exchanger.

240
Robust Control Engineering
8.8  Heat Exchanger, Example 8.1—MIMO QFT Method 1
To illustrate the MIMO QFT control design “Method 1” introduced in Section 8.5, consider 
again the counter-flow heat exchanger and pasteurization process presented in Example 
8.1. The plant definition is given in Equations 8.1 through 8.4. The control specifications are 
described in Equations 8.6 through 8.8, and the control system block diagram is in Figure 
8.3.
Figure 8.19 shows the flow chart to apply the MIMO QFT Method 1 to the design of the 
control system for this example. The next paragraphs follow this flow chart step by step.
Step A: Controller Structure
Using RGA over the frequencies of interest, and taking into account the requirement of 
minimum complexity for the controller, we identify the input–output pairing and the most 
appropriate structure for the matrix compensator. As calculated in Equation 8.5, the RGA 
matrix for the nominal transfer matrix P(s)—Equation 8.4 at s = 0—is
	
Λ =
⊗
=





⊗












=
−
−
P
P
0
0
1
1
7
9
3
5
7
9
3
5
(
)T
T
4.3750
3.3750
3.3750
4.3750
−
−










u
u
1
2





y
y
1
2
	
(8.163)
We pair the input and output variables according to the elements of the Λ matrix that 
are positive and closer to one. Based on these results, we select λ11 = 4.375 and λ22 = 4.375. 
This means to pair [y1(s) − u1(s)] and [y2(s) − u2(s)].
Additionally, we need off-diagonal elements gij(s) for the controller G(s) in the positions 
gij(s) where the loop coupling is significant. As a practical rule, the coupling between 
i and j is considered important when the absolute value of the corresponding RGA 
­element is greater than 1.2 (or less than 0.8), or |λij| ≥ 1.2 (or |λij| ≤ 0.8). In this case, as 
|λ12| = |λ21| = 3.3750, we need one or two of the off-diagonal elements g12(s) and g21(s). 
For the requirement of the simplest structure, we start with a triangular controller matrix 
with g21(s) = 0. Figure 8.20 shows the two control loops and the matrix controller based on 
the selected pairing and triangular structure.
g11(s)
g22(s)
–
–
u1(s)
y2(s)
y1(s)
u2(s)
p11(s)
p12(s)
p21(s)
p22(s)
g12(s)
r2(s)
r1(s)
f11(s)
f22(s)
FIGURE 8.20
Proposed control system for the 2 × 2 heat exchanger. Method 1.

241
Multi-Input Multi-Output Systems: Analysis and Control
Also, the inverse of the plant matrix is:
	
P
P
( )
( )
( )
( )
( )
( )
*
*
*
*
*
s
s
p
s
p
s
p
s
p
s
−=
=






1
11
12
21
22
	
(8.164)
The Bode diagram for the nominal plants of (1/p11*) and (1/p22*) is in Figure 8.21. The con­
troller design is arranged so that we start with the system of smallest bandwidth, which is 
(1/p11*), and then we continue with (1/p22*).
Step B.1.1: Design of the Diagonal Controller Element g11(s)
The element g11(s) is designed by means of the standard SISO QFT loop-shaping technique, 
for the inverse of the equivalent plant q11(s), and for the control specifications described in 
Equations 8.6 through 8.8. According to the iterative expression Equation 8.86, the equiva­
lent plant is
	
p
s
p
s
e
11
1
11
*
*
( )
( )
=
	
(8.165)
and the plant to be controlled
	
q
s
p
s
e
11
11
1
1
( )
( )
*
=
	
(8.166)
The MATLAB code that calculates the plant q11(s) for all the cases within the parametric 
uncertainty is included in Appendix 8. This plant and the control specifications defined 
10–3
10–2
10–1
100
101
Magnitude (dB)
–20
–15
–10
–5
0
5
10
15
Bode diagram
Frequency (rad/s)
1/p22*
1/p11*
FIGURE 8.21
Bode diagram for the nominal plants (1/p11*) and (1/p22*).

242
Robust Control Engineering
in Equations 8.6 through 8.8 are introduced in the QFTCT. The QFT bounds and the loop 
shaping for g11(s) are shown in Figure 8.22.
The expression found for the controller g11(s) is a PID compensator with a first-order low-
pass filter, so that
	
g
s
s
s
s
s
11
20
1 0 12
1
1 0 24
1
1 0 014
1
( )
(( / .
)
)(( / .
)
)
(( / .
)
)
=
+
+
+
	
(8.167)
The design fulfills the two stability conditions:
	
1.	L0_11(s) = q11(s) g11(s) satisfies the Nyquist encirclement condition and
	
2.	There are no RHP pole-zero cancellations between q11(s) and g11(s).
This is checked following the methodology presented in Chapter 3, Section 3.4, and with 
the QFTCT, Controller design window, File, Check stability option.
Step B.1.2: Design of the Diagonal Prefilter Element f11(s)
The f11(s) prefilter element is designed with the QFTCT, for the equivalent plant q11(s), and 
for the diagonal controller g11(s) designed in the previous Step B.1.1. Figure 8.23 shows the 
design. The expression found for the prefilter f11(s) is
	
f
s
s
11
1
1 1 5
1
( )
( / . )
=
+
(
) 	
(8.168)
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–40
–20
0
20
40
60
80
QFTCT
L0_11(s) = q11(s)g11(s)
0.001 rad/s
FIGURE 8.22
Loop shaping of controller g11(s). L0_11(s) = q11(s) g11(s).

243
Multi-Input Multi-Output Systems: Analysis and Control
Figure 8.24 shows the analysis of the disturbance rejection at the output of the plant and 
the reference tracking specifications for the equivalent plant q11(s) and with the controller 
g11(s) and the prefilter f11(s).
Step B.1.3: Design of the Non-Diagonal Controller Element g21(s)
Due to the structure for the controller matrix selected in Step A, the non-diagonal element 
g21(s) is initially set to zero, so that
	
g
s
21
0
( ) =
	
(8.169)
Step B.2.1: Design of the Diagonal Controller Element g22(s)
The element g22(s) is designed by means of the standard SISO QFT loop-shaping technique, 
for the inverse of the equivalent plant q22(s), and for the control specifications described in 
Equations 8.6 through 8.8. According to the iterative expression Equation 8.86, the equiva­
lent plant is
	
p
s
p
s
p
s
g
s
p
s
g
s
p
s
e
22
2
22
1
21
1
21
1
11
1
11
1
12
*
*
*
*
*
( )
( )
( )
( )
( )
( )
( )
=
−
+
+
1
	
(8.170)
and the plant to be controlled
	
q
s
p
s
e
22
22
2
1
( )
( )
*
=
	
(8.171)
Frequency (rad/s)
10–2
10–1
100
101
102
103
Magnitude (dB)
–60
–50
–40
–30
–20
–10
0
QFTCT
q11 g11 f11/(1 + q11 g11)
δlo
δup
FIGURE 8.23
Design of prefilter f11(s) for q11(s) and g11(s).

244
Robust Control Engineering
The MATLAB code that calculates the plant q22(s) for all the cases within the paramet­
ric uncertainty is also included in Appendix 8. This plant and the control specifications 
defined in Equations 8.6 through 8.8 are introduced in the QFTCT. The QFT bounds and 
the loop-shaping for g22(s) are shown in Figure 8.25. The expression found for the controller 
g22(s) is a PI compensator with a first-order low-pass filter, so that
	
g
s
s
s
s
22
30 1 0 6
1
1 300
1
( )
((
. )
)
((
)
)
=
+
+
/
/
	
(8.172)
The design fulfills the two stability conditions:
	
1.	L0_22(s) = q22(s) g22(s) satisfies the Nyquist encirclement condition and
	
2.	There are no RHP pole-zero cancellations between q22(s) and g22(s).
This is checked following the methodology presented in Chapter 3, Section 3.4, and with 
QFTCT, Controller design window, File, Check stability option.
Step B.2.2: Design of the Diagonal Prefilter Element f22(s)
The f22(s) prefilter element is designed with the QFTCT, for the equivalent plant q22(s), and 
for the diagonal controller g22(s) designed in the previous Step B.2.1. Figure 8.26 shows the 
design. The expression found for the prefilter f22(s) is
	
f
s
s
22
1
1 0 75
1
( )
(
.
)
=
+
(
)
/
	
(8.173)
Frequency (rad/s)
10–2
10–1
100
101
102
103
Magnitude (dB)
–60
–50
–40
–30
–20
–10
0
QFTCT
(a)
(b)
Worst case at each frequency
Time (s)
0
1
2
3
4
5
6
7
8
9
10
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δup
δop
δlo
Up to 10 rad/s
FIGURE 8.24
Analysis of controller g11(s) and prefilter f11(s) for q11(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup, δlo.

245
Multi-Input Multi-Output Systems: Analysis and Control
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
80
100
QFTCT
0.001 rad/s
L0_22(s) = q22(s)g22(s)
FIGURE 8.25
Loop shaping of controller g22(s). L0_22(s) = q22(s) g22(s).
Frequency (rad/s)
10–2
10–1
100
101
102
103
Magnitude (dB)
–60
–50
–40
–30
–20
–10
0
QFTCT
q22 g22 f22/(1 + q22 g22)
δup
δlo
FIGURE 8.26
Design of prefilter f22(s) for q22(s) and g22(s).

246
Robust Control Engineering
Figure 8.27 shows the analysis of the disturbance rejection at the output of the plant and 
the reference tracking specifications for the equivalent plant q22(s) and with the controller 
g22(s) and the prefilter f22(s).
Step B.2.3: Design of the Non-Diagonal Controller Element g12(s)
The g12(s) non-diagonal element is designed to minimize the cross-coupling term c3-12 
given by Equation 8.73 for disturbance rejection at plant output. The expression for the 
optimum compensator element Equation 8.77 is utilized in order to achieve this goal. 
The g12(s) element is designed so that its magnitude and phase over the frequencies of 
interest pass, respectively, through the middle of the magnitude and phase of the expres­
sion g22(s)  p12(s)*/p22(s)* for 256 plants selected within the parametric uncertainty—see 
Figure 8.28 and Equation 8.174.
	
g
s
g
s p
s
p
s
N
N
12
22
40 1 0
( )
( )
( )
( )
( / .
=





= −
middle of
12
*
22
*
833
1
1 300
1
)
( /
)
s
s
s
+
(
)
+
(
)
	
(8.174)
Step C: Final Checks
C.1. Finally, the design also fulfills the other additional two stability conditions:
No Smith-McMillan pole-zero cancellations occur between P(s) and G(s), and
No Smith-McMillan pole-zero cancellations occur in |P*(s) + G(s)|.
C.2. The final system P(s)G(s) does not have any additional RHP transmission zero.
C.3. Simulation of the closed-loop MIMO system. Figures 8.29 and 8.30 show the 
simulation of the two control loops. We use the nominal plant P = [p11(s) p12(s); p21(s) 
p22(s)] defined in Equation 8.4. The block diagram is the non-diagonal controller 
Frequency (rad/s)
10–3
10–2
10–1
100
101
Magnitude (dB)
–60
–50
–40
–30
–20
–10
0
QFTCT
(a)
(b)
δop
Worst case at each
frequency
Up to 10 rad/s
Time (s)
0
1
2
3
4
5
6
7
8
9
10
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δlo
δup
FIGURE 8.27
Analysis of controller g22(s) and prefilter f22(s) for q22(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup,δlo.

247
Multi-Input Multi-Output Systems: Analysis and Control
Magnitude (dB)
0
50
100
150
10–4
10–2
100
102
104
Phase (deg)
90
135
180
Bode diagram
Frequency (rad/s)
g12(s)
256 plants of
g22 (p12*)/(p22*)
g12(s)
256 plants of
g22 (p12*)/(p22*)
FIGURE 8.28
Design of non-diagonal element g12(s).
To: y(1)
0
0.5
1
1.5
0
50
100
150
200
250
300
To: y(2)
0
0.2
0.4
0.6
0.8
1
Simulation of closed-loop MIMO system
Time (s)
Amplitude
r1
r2
y1
y2
FIGURE 8.29
Closed-loop MIMO system. Figure 8.20. Inputs: r1(s), r2(s). Outputs: y1(s), y2(s). P = [p11(s) p12(s); p21(s) p22(s)], 
Equation 8.4, nominal plant. G = [g11(s) g12(s); g21(s) g22(s)], Equations 8.167, 8.169, 8.172, 8.174, and without prefilter: 
F = [1 0; 0 1]. MIMO QFT Method 1.

248
Robust Control Engineering
shown in Figure 8.20. The full-matrix controller is G = [g11(s) g12(s); g21(s) g22(s)], 
Equations 8.167, 8.169, 8.172, 8.174. Figure 8.29 shows the simulation with a uni­
tary diagonal prefilter, F = [1 0; 0 1], and Figure 8.30 with the diagonal ­prefilter 
F = [f11(s)0; 0 f22(s)], Equations 8.168, 8.173. The first reference starts at r1 = 0 and 
changes to r1 = 1 at t = 20 s. The second reference starts at r2 = 0 and changes 
to r2 = 1 at t = 170 s. Figure 8.29 shows the results obtained with the triangular 
controller and unitary diagonal prefilter, which improve significantly the ones 
presented in Figure 8.9 (independent SISO controllers). Finally, Figure 8.30 shows 
the results with the triangular controller and diagonal prefilter. They improve the 
results even more, reducing significantly the effect of the coupling between the 
control loops.
8.9  Heat Exchanger, Example 8.1—MIMO QFT Method 2
To illustrate the MIMO QFT control design Method 2 introduced in Section 8.6, consider 
again the counter-flow heat exchanger and pasteurization process presented in Example 
8.1 and Section 8.8. The plant definition is given in Equations 8.1 through 8.4. The control 
specifications are described in Equations 8.6 through 8.8, and the control system block 
diagram is in Figure 8.32.
Figure 8.31 shows the flow chart to apply the MIMO QFT Method 2 to the design of the 
control system for this example. The next paragraphs follow this flow chart step by step.
To: y(1)
0
0.5
1
1.5
0
50
100
150
200
250
300
To: y(2)
0
0.2
0.4
0.6
0.8
1
Simulation of closed-loop MIMO system
Time (s)
Amplitude
r1
r2
y2
y1
FIGURE 8.30
Closed-loop MIMO system. Figure 8.20. Inputs: r1(s), r2(s). Outputs: y1(s), y2(s). P = [p11(s) p12(s); p21(s) p22(s)], 
Equation 8.4, nominal plant. G = [g11(s) g12(s); g21(s) g22(s)], Equations 8.167, 8.169, 8.172, 8.174, and with prefilter: 
F = [f11(s) 0; 0 f22(s)], Equations 8.168, 8.173. MIMO QFT Method 1.

249
Multi-Input Multi-Output Systems: Analysis and Control
Step A: Controller Structure
Using RGA over the frequencies of interest, and taking into account the requirement of 
minimum complexity for the controller, we identify the input–output pairing and the 
appropriate structure for the control system. As calculated in Equation 8.5 or Equation 
8.163 for the nominal transfer matrix P(s)—Equation 8.4 at s = 0, the 2 × 2 RGA matrix has 
λ11 = 4.375 and λ22 = 4.375, which means to pair [y1(s)−u1(s)] and [y2(s)−u2(s)]. The controller 
structure with this Method 2 requires a 2 × 2 full matrix Gα, a 2 × 2 diagonal matrix Gβ, 
and a 2 × 2 diagonal prefilter matrix F. Figure 8.32 shows the two control loops and the 
controllers based on the selected pairing and control structure.
Step B: Design of 2 × 2 Full-Matrix Gα Controller
As discussed in Section 8.6.2, the fully populated matrix controller G is composed of two 
matrices: G = GαGβ , so that
	
G
G G
=
=






α
β
β
β
α
α
α
α
g
s
g
s
g
s
g
s
g
s
g
11
12
21
22
11
22
0
0
( )
( )
( )
( )
( )
( )s





	
(8.175)
Step D
Final checks
Matrix stability, Transmission zeros
Step A
Controller structure
RGA, pairing, structure
Step C.1
Column 1
Step C.1.2
Design diagonal preﬁlter f11(s) 
for qx11(s) and g11
β(s) 
Step B 
Design 2 × 2 full matrix Gα controller: 
g11
α(s), g12
α(s), g21
α(s), g22
α(s)
Step C.1.1
Design diagonal controller g11
β
qx11(s), g11
β(s), stability of qx11(s) g11
β(s) 
Step C.2.2
Design diagonal preﬁlter f22(s)
for qx22(s) and g22
β(s) 
Step C.2.1
Design diagonal controller g22
β
qx22(s), g22
β(s), stability of qx22(s) g22
β(s)
Step C.2
Column 2
FIGURE 8.31
Flow chart of the MIMO QFT Method 2 for the heat exchanger.

250
Robust Control Engineering
The main objective of the pre-compensator Gα is to diagonalize the plant P as much as 
possible. The expression used to determine Gα is—see also Equation 8.94,
	
G
P
P
α
α
α
α
α
( )
( )
( )
( )
( )
(
s
g
s
g
s
g
s
g
s
s
diag
=






=
( )
−
11
12
21
22
1

s
p
s
p
s
p
s
p
s
p
s
p
)
( )
( )
( )
( )
( )
*
*
*
*







=






11
12
21
22
11
0
0
22( )s






	
(8.176)
where the plant matrix ˆP, and the corresponding inverse ˆP−1 and diagonal ˆPdiag are selected 
so that the expression of the extended matrix in Equation 8.95 presents the closest form to 
a diagonal matrix, nulling the off-diagonal terms as much as possible.
The Bode diagrams for the expressions ˆ ( )ˆ ( )
*p
s p
s
11
11
, ˆ ( )ˆ ( )
*p
s p
s
12
22
, ˆ ( )ˆ ( )
*p
s p
s
21
11
, and 
ˆ ( )ˆ ( )
*p
s p
s
22
22
—​see Equation 8.176, including all the model uncertainty are shown in 
Figures 8.33 through 8.36, respectively. The controller elements g11
α(s), g12
α(s), g21
α(s), and 
g22
α(s) are ­calculated as the transfer function that matches the mean value in magnitude 
and phase of the ­respective Bode diagram over the frequencies of interest. See also Figures 
8.33 through 8.36 and Equations 8.177 through 8.180, respectively.
	
g
s
s
s
11
1 24
0 16
0 01
α ( )
( .
.
)
(
.
)
=
+
+
	
(8.177)
	
g
s
s
s
12
1 53
0 19
0 01
α ( )
.
.
.
= −
+
(
)
+
(
)
	
(8.178)
	
g
s
s
s
21
0 18
0 1
0 01
α ( )
.
.
.
= −
+
(
)
+
(
)
	
(8.179)
	
g
s
s
s
22
1 24
0 16
0 01
α ( )
.
.
.
=
+
(
)
+
(
)
	
(8.180)
Step C.1.1: Design of the Diagonal Controller g11
β(s)
The element g11
β(s) is designed by means of the standard SISO QFT loop-shaping tech­
nique, for the inverse of the extended equivalent plant qx11(s) = [p11
x*e]1
−1, and for the control 
g21
α(s)
y1(s)
u1(s)
y2(s)
u2(s)
p11(s)
p12(s)
p21(s)
p22(s)
g11
α(s)
g22
α(s)
–
–
g12
α(s)
r2(s)
r1(s)
f11(s)
f22(s)
g11
β(s)
g22
β(s)
FIGURE 8.32
Proposed control system for the 2 × 2 heat exchanger. Method 2.

251
Multi-Input Multi-Output Systems: Analysis and Control
Magnitude (dB)
0
10
20
30
40
10–3
10–2
10–1
100
101
Phase (deg)
–90
–45
0
PinvPdiag(1:end).tfm(1, 1) and g11-α
Frequency (rad/s)
g11α
g11α
FIGURE 8.33
Design of element g11
α as the mean value of ˆ ( )ˆ ( )
*p
s p
s
11
11
.
Magnitude (dB)
0
10
20
30
40
50
10–3
10–2
10–1
100
101
Phase (deg)
90
135
180
PinvPdiag(1:end).tfm(1, 2) and g12-α
Frequency (rad/s)
g12α
g12α
FIGURE 8.34
Design of element g12
α (s) as the mean value of ˆ ( )ˆ ( )
*p
s p
s
12
22
.

252
Robust Control Engineering
Magnitude (dB)
0
10
20
30
40
10–3
10–2
10–1
100
101
Phase (deg)
–90
–45
0
PinvPdiag(1:end).tfm(2,2) and g22-α
Frequency (rad/s)
g22α
g22α
FIGURE 8.36
Design of element g22α (s) as the mean value of ˆ ( )ˆ ( )
*p
s p
s
22
22
.
Magnitude (dB)
–20
0
20
40
10–3
10–2
10–1
100
101
Phase (deg)
90
135
180
PinvPdiag(1:end).tfm(2, 1) and g21-α
Frequency (rad/s)
g21α
g21α
FIGURE 8.35
Design of element g21
α (s) as the mean value of ˆ ( )ˆ ( )
*p
s p
s
21
11
.

253
Multi-Input Multi-Output Systems: Analysis and Control
specifications described in Equations 8.6 through 8.8. According to the iterative expression 
Equation 8.97, the extended equivalent plant is
	
p
s
p
s
x e
x
11
1
11
*
*
( )
( )
=
	
(8.181)
and the plant to be controlled
	
q
s
p
s
x
x e
11
11
1
1
( )
( )
*
=
	
(8.182)
The MATLAB code that calculates the plant qx11(s) for all the cases within the parametric 
uncertainty is included in Appendix 8. This plant and the control specifications defined 
in Equations 8.6 through 8.8 are introduced in the QFTCT. The QFT bounds and the loop 
shaping for g11
β(s) are shown in Figure 8.37. The expression found for the controller g11
β(s) is 
a PI compensator with a first-order low-pass filter, so that
	
g
s
s
s
s
11
0 9 1 0 24
1
1 40
1
β ( )
.
(
.
)
(
)
=
+
(
)
+
(
)
/
/
	
(8.183)
The design fulfills the two stability conditions:
	
1.	Lx0_11(s) = qx11(s) g11
β(s) satisfies the Nyquist encirclement condition and
	
2.	There are no RHP pole-zero cancellations between qx11(s) and g11
β(s).
Open-loop phase (deg)
–200
–180
–160
–140
–120
–100
–80
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
80
QFTCT
0.001 rad/s
Lx0_11(s) = qx11(s)g11b(s)
FIGURE 8.37
Loop-shaping of controller g11
β (s). Lx0_11(s) = qx11(s) g11
β (s).

254
Robust Control Engineering
This is checked following the methodology presented in Chapter 3, Section 3.4, and with 
QFTCT, Controller design window, File, Check stability option.
Step C.1.2: Design of the Diagonal Prefilter f11(s)
The f11(s) prefilter element is designed with the QFTCT, for the equivalent plant qx11(s), and 
for the diagonal controller g11
β(s) designed in the previous Step C.1.1. Figure 8.38 shows the 
design. The expression found for the prefilter f11(s) is
	
f
s
s
s
11
1 20
1
1 2
1
( )
(
)
(
)
=
+
(
)
+
(
)
/
/
	
(8.184)
Figure 8.39 shows the analysis of the disturbance rejection at the output of the plant 
and the reference tracking specifications for the equivalent plant qx11(s) and with the con­
troller g11
β(s) and the prefilter f11(s).
Step C.2.1: Design of the Diagonal Controller g22
β(s)
The element g22
β(s) is designed by means of the standard SISO QFT loop-shaping tech­
nique, for the inverse of the extended equivalent plant qx22(s) = [p22
x*e]2
−1, and for the control 
specifications described in Equations 8.6 through 8.8. According to the iterative expression 
Equation 8.97, the extended equivalent plant is
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–120
–100
–80
–60
–40
–20
0
20
QFTCT
qx11 g11b  f11/(1 + qx11 g11b)
δup
δlo
FIGURE 8.38
Design of prefilter f11(s) for qx11(s) and g11
β (s).

255
Multi-Input Multi-Output Systems: Analysis and Control
	
p
s
p
s
p
s
p
s
p
s
g
s
x e
x
x
x
x
22
2
22
1
21
1
12
1
11
1
11
*
*
*
*
*
( )
( )
( )
( )
( )
( )
=
−
+
β
	
(8.185)
and the plant to be controlled
	
q
s
p
s
x
x e
22
22
2
1
( )
( )
*
=
	
(8.186)
The MATLAB code that calculates the plant qx22(s) for all the cases within the parametric 
uncertainty is included in Appendix 8. This plant and the control specifications defined 
in Equations 8.6 through 8.8 are introduced in the QFTCT. The QFT bounds and the loop 
shaping for g22
β(s) are shown in Figure 8.40. The expression found for the controller g22
β(s) 
is a PI compensator with a first-order low-pass filter, so that
	
g
s
s
s
s
22
0 4 1 0 1
1
1 40
1
β ( )
.
(
. )
(
)
=
+
(
)
+
(
)
/
/
	
(8.187)
The design fulfills the two stability conditions:
	
1.	Lx0_22(s) = qx22(s) g22
β(s) satisfies the Nyquist encirclement condition and
	
2.	There are no RHP pole-zero cancellations between qx22(s) and g22
β(s).
This is checked following the methodology presented in Chapter 3, Section 3.4, and with 
QFTCT, Controller design window, File, Check stability option.
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
10
QFTCT
(a)
(b)
Worst case at each frequency
Time (s)
0
1
2
3
4
5
6
7
8
9
10
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δup
δop
δlo
Up to 10 rad/s
FIGURE 8.39
Analysis of controller g11
β(s) and prefilter f11(s) for qx11(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup, δlo.

256
Robust Control Engineering
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–120
–100
–80
–60
–40
–20
0
20
QFTCT
qx22 g22b  f22/(1 + qx22 g22b)
δup
δlo
FIGURE 8.41
Design of prefilter f22(s) for qx22(s) and g22
β (s).
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–80
–60
–40
–20
0
20
40
60
80
QFTCT
0.001 rad/s
Lx0_22(s) = qx22(s)g22b(s)
FIGURE 8.40
Loop shaping of controller g22
β(s). Lx0_22(s) = qx22(s) g22
β(s).

257
Multi-Input Multi-Output Systems: Analysis and Control
Step C.2.2: Design of the Diagonal Prefilter f22(s)
The f22(s) prefilter element is designed with the QFTCT, for the equivalent plant qx22(s), and 
for the diagonal controller g22
β(s) designed in the previous Step C.2.1. Figure 8.41 shows the 
design. The expression found for the prefilter f22(s) is
	
f
s
s
s
22
1 20
1
1 2
1
( )
(
)
(
)
=
+
(
)
+
(
)
/
/
	
(8.188)
Figure 8.42 shows the analysis of the disturbance rejection at the output of the plant and 
the reference tracking specifications for the equivalent plant qx22(s) and with the controller 
g22
β(s) and the prefilter f22(s).
Step D: Final Checks
D.1. Finally, the design also fulfills the other additional two stability conditions:
No Smith-McMillan pole-zero cancellations occur between P(s) and G(s), and
No Smith-McMillan pole-zero cancellations occur in |P*(s) + G(s)|.
D.2. The final system P(s)G(s) does not have any additional RHP transmission zero.
D.3. Simulation of the closed-loop MIMO system. Figures 8.43 and 8.44 show the simu­
lation of the two control loops. We use the nominal plant P = [p11(s) p12(s); p21(s) p22(s)] 
defined in Equation 8.4. The control block diagram is shown in Figure 8.32. The 
full-matrix controller is G = GαGβ , with Gα = [g11
α(s) g12
α(s); g21
α(s) g22
α(s)], Equations 
8.177 through 8.180, and Gβ = [g11
β(s) 0; 0 g22
β(s)], Equations 8.183 and 8.187. Figure 
8.43 shows the simulation with a unitary diagonal prefilter, F = [1 0; 0 1], and Figure 
8.44 with the diagonal prefilter F = [f11(s) 0; 0 f22(s)], Equations 8.184 and 8.188. The 
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
10
QFTCT
(a)
(b)
Worst case at each frequency
Time (s)
0
1
2
3
4
5
6
7
8
9
10
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δup
δop
δlo
Up to 10 rad/s
FIGURE 8.42
Analysis of controller g22
β (s) and prefilter f22(s) for qx22(s). (a) Disturbance rejection at plant output: δop. (b) 
Reference tracking: δup, δlo.

258
Robust Control Engineering
To: y(1)
0
0.5
1
1.5
0
50
100
150
200
250
300
To: y(2)
0
0.2
0.4
0.6
0.8
1
Simulation of closed-loop MIMO system
Time (s)
Amplitude
r1
y2
r2
y1
FIGURE 8.44
Closed-loop MIMO system. Figure 8.32. Inputs: r1(s), r2(s). Outputs: y1(s), y2(s). P = [p11(s) p12(s); p21(s) p22(s)], Equation 
8.4, nominal plant. G = GαGβ , Equations 8.177 through 8.180, 8.183, 8.187, and with prefilter: F = [f11(s) 0; 0 f22(s)], 
Equations 8.184, 8.188. MIMO QFT Method 2.
To: y(1)
0
0.5
1
1.5
0
50
100
150
200
250
300
To: y(2)
0
0.2
0.4
0.6
0.8
1
Simulation of closed-loop MIMO system
Time (s)
Amplitude
r1
r2
y2
y1
FIGURE 8.43
Closed-loop MIMO system. Figure 8.32. Inputs: r1(s), r2(s). Outputs: y1(s), y2(s). P = [p11(s) p12(s); p21(s) p22(s)], 
Equation 8.4, nominal plant. G = Gα Gβ , Equations 8.177 through 8.180, 8.183, 8.187, and without prefilter: F = [1 
0; 0 1]. MIMO QFT Method 2.

259
Multi-Input Multi-Output Systems: Analysis and Control
first reference starts at r1 = 0 and changes to r1 = 1 at t = 20 s. The second refer­
ence starts at r2 = 0 and changes to r2 = 1 at t = 170 s. Figure 8.43 shows the results 
obtained with the controller G = GαGβ and the unitary diagonal prefilter, which 
improve significantly the ones presented in Figure 8.9 (independent SISO control­
lers). Finally, Figure 8.44 shows the results with the controller G = GαGβ and the 
diagonal prefilter. They improve even more the results, reducing significantly the 
effect of the coupling between the control loops.
8.10  Summary
This chapter analyses the main characteristics of MIMO plants and introduces two meth­
odologies (Method 1 and Method 2) to design non-diagonal QFT controllers for MIMO sys­
tems with model uncertainty.
Sections 8.1 through 8.4 analyze the special properties that define MIMO systems 
and propose some tools to understand their dynamics and design appropriate control 
systems.
Sections 8.5 and 8.8 present the non-diagonal MIMO QFT Method 1, including both the­
ory and a detailed example. The method analyses the role played by the non-diagonal 
compensator elements gij (i ≠ j) by means of three coupling matrices (C1, C2, and C3) and 
a quality function ηij. It quantifies the amount of interaction among the control loops, and 
proposes a sequential design methodology for the fully populated matrix compensator 
that yields n equivalent tracking SISO systems and n equivalent disturbance rejection SISO 
systems. As a result, the off-diagonal elements gij (i ≠ j) of the compensator matrix reduce 
(or cancel if there is no uncertainty) the level of coupling among loops, and the diagonal 
elements gkk regulate the system with less bandwidth requirements than the diagonal ele­
ments of the original Horowitz’s methods.6,7,110,114,115,206,209,211
Sections 8.6 and 8.9 present the non-diagonal MIMO QFT Method 2, including both 
theory and a detailed example. It is a formal reformulation of Method 1. It avoids former 
hypotheses of diagonal dominance and simplifies the calculations for the off-diagonal ele­
ments and the method itself. It also reformulates the classical matrix definition of MIMO 
specifications by designing a new set of loop-by-loop QFT bounds on the Nichols chart 
with necessary and sufficient conditions. It gives explicit expressions to share the load 
among the loops of the MIMO system to achieve the matrix specifications. And all for 
stability, reference tracking, disturbance rejection at plant input and output, and noise 
attenuation problems.119
The MATLAB code that develops the examples and cases presented in this chapter is 
also included in Appendix 8.
8.11  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter:

260
Robust Control Engineering
•	 Example 8.1. Section 8.1. SISO control of a 2 × 2 heat exchanger system.
•	 Example 8.1. Section 8.8. MIMO QFT control, Method 1, 2 × 2 heat exchanger.
•	 Example 8.1. Section 8.9. MIMO QFT control, Method 2, 2 × 2 heat exchanger.
•	 Appendix 8. MATLAB code for Example 8.1, all cases.
•	 Case study CS3. A 2 × 2 wastewater treatment plant.
•	 Case study CS5. A 6 × 6 space telescope control.
•	 Project P5. Appendix 1. A 2 × 2 distillation column.
•	 Problem Q8. Appendix 1. Two flow problem.
•	 Problem Q9. Appendix 1. 2 × 2 MIMO system.
•	 Problem Q10. Appendix 1. 2 × 2 MIMO system.
•	 Problem Q11. Appendix 1. Spacecraft flying in formation. Low Earth Orbit.
•	 Problem Q12. Appendix 1. 3 × 3 MIMO system.

261
9
Control Topologies
9.1  Introduction
Sometimes, the performance specifications required for a system cannot be completely 
achieved by a simple 2DOF control structure, with a feedback controller G(s) and a prefilter 
F(s). The presence of significant disturbances, insufficient number of actuators (less actua­
tors than sensors), or the inability to have adequate sensors (less sensors than actuators) 
are examples of this problem. Fortunately, the design of an appropriate control topology 
with additional blocks and connections is the solution in many cases. This chapter ana­
lyzes some of these common problems and proposes some practical control topologies to 
achieve the required performance specifications.
The chapter contains nine sections, each one with a specific control topology solution. It 
includes: cascade control (Section 9.2), feedforward control (Section 9.3), override control 
(Section 9.4), ratio control (Section 9.5), mid-range control (Section 9.6), load-sharing control 
(Section 9.7), split-range control (Section 9.8), inferential control (Section 9.9), and auction­
eering control (Section 9.10).
Each section starts with a control challenge frequently confronted in industry. We 
encourage the reader to analyze it carefully and propose some solutions before continuing 
reading. Then, the second part of each section develops some control topology solutions 
for the challenge, including additional control blocks, connections, and sometimes supple­
mentary sensors or actuators.
In all cases, once the control topology is chosen and the additional blocks are defined, 
a QFT robust control methodology can be applied to design the feedback controller G(s), 
prefilter F(s), and other additional functions. As in previous cases, the design considers 
the model uncertainty of the plant, the model uncertainty of the additional blocks of the 
structure, and a variety of simultaneous control specifications.
9.2  Cascade Control Systems
9.2.1  Challenge 9.1
Given the control system shown in Figure 9.1 and its transfer function description in 
Equation 9.1, modify the diagram topology to significantly reduce the effect of the 

262
Robust Control Engineering
disturbance d(s) on the output y1(s). An additional sensor for y2(s) is available. The dynam­
ics of P2(s) is faster than the dynamics of P1(s).
	
y s
P s P s G s
P s P s G s r s
P s M s
P
1
1
2
1
1
2
1
1
1
1
1
1
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
(
=
+
+ +
s P s G s d s
)
( )
( ) ( )
2
1
	
(9.1)
9.2.2  Solution 9.1: Cascade Control
Use the additional sensor y2(s) to close an inner (secondary) control loop to regulate y2(s) 
and design the corresponding inner controller G2(s). Then, close an outer (primary) control 
loop to regulate y1(s) and design the outer controller G1(s). This is the cascade control topol­
ogy—see Figure 9.2.
The transfer function description of the cascade control diagram is shown in Equation 
9.2. Comparing this expression with the one of Equation 9.1, we can see that the effect of 
the disturbance d(s) on y1(s) is attenuated significantly, as d(s) passes through the expres­
sion M(s)/(1 + P2(s)G2(s)) in the cascade control system instead of through M(s) in the origi­
nal system.
	
y s
P s
P s G s
P s G s G s
P s
P s
1
1
2
2
2
2
1
1
2
1
1
( )
( )
( )
( )
( )
( )
( )
( )
( )
=
+






+
G s
P s G s G s
r s
P s
M s
P s G s
2
2
2
1
1
1
2
2
1
1
( )
( )
( )
( )
( )
( )
( )
( )
( )
+






+
+
1
1
1
2
2
2
2
1
+
+






P s
P s G s
P s G s G s
d s
( )
( )
( )
( )
( )
( )
( )
	
(9.2)
+
+
–
+
r1(s)
e1(s)
y1(s)
G1(s)
d(s)
P1(s)
P2(s)
M(s)
u1(s)
y2(s)
FIGURE 9.1
Challenge 9.1: reduce the effect of the disturbance d(s) on y1(s).
r1(s)
+
–
+
e1(s)
u2(s)
y1(s)
G1(s)
G2(s)
d(s)
+
P1(s)
P2(s)
M(s)
–
+
u1(s)
e2(s)
y2(s)
u1(s) = r2(s)
FIGURE 9.2
Cascade control system.

263
Control Topologies
A cascade control solution is appropriate when the following five criteria are satisfied:367
C1—A single feedback loop does not give a satisfactory disturbance rejection.
C2—A secondary sensor y2(s) is available for an inner loop.
C3—The sensor y2(s) measures the effect of the key disturbance d(s).
C4—The sensor y2(s) is influenced by the actuator (causal relationship u2 to y2).
C5—The dynamics of P2(s) is faster than the dynamics of P1(s).
The design of the controllers G1(s) and G2(s) of the cascade control system has the follow­
ing sequence:
Step 1: Design the inner (secondary) loop controller G2(s) for disturbance rejection and 
stability specifications.
Step 2: Design the outer (primary) loop controller G1(s) for disturbance rejection, refer­
ence tracking, and stability specifications.
Following these criteria, case study CS4 presents a QFT cascade control solution for a 
radio telescope servo system.
Finally, a system can include more than two cascade control loops. For instance, Figure 9.3 
shows a three-loop cascade control solution for electrical motors. It includes an inner loop 
for Current control, i(s); a middle loop for Velocity control, v(s); and an outer loop for Position 
control, θ(s).
9.3  Feedforward Control Systems
9.3.1  Challenge 9.2
Given the control system shown in Figure 9.4 and its transfer function description in 
Equation 9.3, modify the diagram topology to (1) significantly reduce the effect of the dis­
turbance d(s) on the plant output y(s), and (2) speed-up the variable y(s) tracking the refer­
ence r(s). An additional sensor for d(s) is available.
r1(s)
u1(s)
u2(s)
u3(s)
i(s)
+
v(s)
d3(s)
+
+
d2(s)
+
u2(s) = r3(s) = iref(s) 
θ(s)
+
d1(s)
+
u1(s) = r2(s) = vref(s) 
r1(s) = θref (s)
G1(s)
G2(s)
G3(s)
M3(s)
M2(s)
M1(s)
P1(s)
P3(s)
P2(s)
–
–
–
+
+
+
FIGURE 9.3
Three-loop cascade control system for an electrical motor.

264
Robust Control Engineering
	
y s
P s P s G s
P s P s G s r s
P s M s
P s P
( )
( )
( ) ( )
( )
( ) ( ) ( )
( )
( )
( )
=
+
+ +
1
2
1
2
1
1
2
1
1
( ) ( ) ( )
s G s d s
	
(9.3)
9.3.2  Solution 9.2a: For Disturbance Rejection
Use the additional sensor d(s) and a new block Gf(s) to calculate an additional control signal, 
named feedforward uff (s). This signal is added to the existing feedback control signal ufb(s). 
Figure 9.5 shows this feedforward–feedback control topology for disturbance rejection.
The transfer function description of this feedforward–feedback control diagram is 
shown in Equation 9.4. If we define Gf(s) as in Equation 9.5, with V(s) = 1, then the effect 
of the disturbance d(s) on y(s) is cancelled, according to Equation 9.4. Notice that ˆ ( )
P s
2
 and 
ˆ ( )
M s  are the estimated model for P2(s) and M(s), respectively, and V(s) is typically a low-
pass filter.
	
y s
P s P s G s
P s P s G s r s
P s M s
P s Gf
( )
( )
( ) ( )
( )
( ) ( ) ( )
( )[
( )
( )
=
+
+
+
1
2
1
2
1
2
1
( )]
( )
( ) ( )
( )
s
P s P s G s
d s
1
1
2
+
	
(9.4)
	
G s
P s
M s V s
f ( ) = −
−


2( )
( ) ( )
1
	
(9.5)
	
u s
u
s
u
s
fb
ff
( )
( )
( )
=
+
	
(9.6)
A feedforward–feedback control solution is appropriate when the following five criteria 
are satisfied:367
r(s)
–
+
+
+
e(s)
y(s)
G(s)
d(s)
P1(s)
P2(s)
M(s)
u(s)
FIGURE 9.4
Challenge 9.2: (1) reduce the effect of the disturbance d(s) on y(s) and (2) speed-up the variable y(s) tracking the 
reference r(s).
r(s)
–
+
+
+
+
+
e(s)
y(s)
G(s)
d(s)
P1(s)
P2(s)
ufb(s)
uff (s)
Gf (s)
M(s)
u(s)
FIGURE 9.5
Feedforward–feedback control system for disturbance rejection.

265
Control Topologies
C1—A single feedback loop does not give a satisfactory disturbance rejection.
C2—A secondary sensor d(s) is available.
C3—The sensor d(s) measures directly the disturbance.
C4—d(s) is not influenced by the actuator (no causal relationship from u to d).
C5—The dynamics of P2(s) is similar or faster than the dynamics of M(s).
The feedback controller G(s) and the feedforward controller Gf(s) are tuned indepen­
dently. For G(s) we can use the QFT robust control method and for Gf(s) an expression 
based on Equation 9.5.
Notice also that a system can deal with more than one feedforward block. For instance, 
Figure 9.6 shows a two-feedforward feedback control solution. In this case, we have two 
main disturbances and two additional sensors available, one for each disturbance. The 
design of the feedforward controllers is based on the expressions given by Equations 9.7 
and 9.8.
	
G
s
P s
M s V s
f 1
2
1
1
1
( )
( )
( )
( )
= −
−


	
(9.7)
	
G
s
P s
M s V s
f 2
2
1
2
2
( )
( )
( )
( )
= −
−


	
(9.8)
	
u s
u
s
u
s
u
s
fb
ff
ff
( )
( )
( )
( )
=
+
+
1
2
	
(9.9)
A discussion of the feedforward–feedback control for disturbance rejection in the con­
text of QFT was developed in Section 2.12, including the solution and MATLAB code for 
the flight control problem presented in Example 2.2.
In some cases the calculation of the Gf(s) controllers could involve unstable poles, 
non-proper expressions (more poles than zeros), positive exponential functions or even 
zero-pole cancellations. In these situations, the designers have to find a stable, proper 
approximation. This is the purpose of the transfer function V(s) included in the expres­
sions Equation 9.5, 9.7, and 9.8. The Example 2.2, Equation 2.76, shows also a solution for 
that problem.
r(s)
–
+
+
+
+
+
+
e(s)
y(s)
G(s)
d2(s)
d1(s)
P1(s)
P2(s)
ufb(s)
uff 1(s)
uff 2(s)
Gf 2(s)
Gf 1(s)
M2(s)
M1(s)
u(s)
FIGURE 9.6
Feedforward–feedback control system for rejection of two disturbances.

266
Robust Control Engineering
9.3.3  Solution 9.2b: For Reference Tracking. Model Matching
Use an additional block Gr(s) to calculate an additional control signal, named feedforward 
uff(s). This signal is added to the existing feedback control signal ufb(s). Figure 9.7 shows 
this feedforward–feedback control topology for reference tracking. It is also called model 
matching.
The transfer function description of this feedforward–feedback control diagram for ref­
erence tracking is shown in Equation 9.10. The expression Q0(s), or model to match, is the 
desired transfer function we want to have from r(s) to y(s). It substitutes the classical pre­
filter F(s). The expression Gr(s) is calculated as in Equation 9.11. In this way, the transfer 
function from r(s) to y(s) is reduced to just the model we want to match, Q0(s), according to 
Equation 9.10.
	
y s
P s
P s G s G s Q s
G s r s
Q s
P s G s
Q
r
r
( )
( )
( ) ( )[ ( )
( )
( )] ( )
( )
( )
( )
=
+
+
=
+
−
1
0
0
0
1
( )
( ) ( )
( )
s
P s G s
r s
+






	
(9.10)
	
G s
P s
Q s
r( )
( )
( )
=
−

1
0
	
(9.11)
A discussion of the feedforward–feedback control for model matching in the context of 
QFT was developed in Section 2.11, including the solution and MATLAB code for the flight 
control problem presented in Example 2.2.
9.3.4  Solution 9.2c: For Disturbance Rejection and Reference Tracking
We can combine the solutions 9.2a and 9.2b, as shown in Figure 9.8 and Equations 9.12 
through 9.15.
r(s)
e(s)
y(s)
G(s)
P(s)
ufb(s)
uff (s)
Gr(s)
rm(s)
Q0(s)
+
–
+
+
u(s)
FIGURE 9.7
Feedforward control system for reference tracking. Model matching.
+
+
–
+
+
+
+
r(s)
G(s)
d(s)
P1(s)
P2(s)
uff 1(s)
uff 2(s)
Gf (s)
M(s)
e(s)
y(s)
ufb(s)
Gr(s)
rm(s)
Q0(s)
u(s)
FIGURE 9.8
Feedforward–feedback control for disturbance rejection and reference tracking.

267
Control Topologies
	
y s
P s P s
P s P s G s G s Q s
G s r s
P s
r
( )
( )
( )
( )
( ) ( )[ ( )
( )
( )] ( )
( )
=
+
+
+
1
2
1
2
0
1
1
[
( )
( )
( )]
( )
( ) ( )
( )
( )
( )
( )
(
M s
P s G s
P s P s G s
d s
Q s
P s P s G
f
r
+
+
=
+
2
1
2
0
1
2
1
s
Q s
P s P s G s
r s
P s M s
P s G s
f
)
( )
( )
( ) ( )
( )
( )[
( )
( )
(
−
+






+
+
0
1
2
1
2
1
)]
( )
( ) ( )
( )
1
1
2
+ P s P s G s
d s
	
(9.12)
	
G s
P s P s
Q s
r( )
[
( )
( )]
( )
=
−


1
2
1
0
	
(9.13)
	
G s
P s
M s V s
f ( )
( )
( ) ( )
= −
−


2
1
	
(9.14)
	
u s
u
s
u
s
u
s
fb
ff
ff
( )
( )
( )
( )
=
+
+
1
2
	
(9.15)
For additional information about QFT methodologies for these two feedforward–feed­
back solutions concerning disturbance rejection and model matching, see the References 
138 and 121 regarding SISO and MIMO cases, respectively.
9.4  Override Control Systems
9.4.1  Challenge 9.3
Given the plant shown in Figure 9.9, with two sensors y1(s) and y2(s) and only one actuator 
u(s), find an appropriate control topology to regulate both output variables y1(s) and y2(s) 
within some limits and with only one actuator u(s).
9.4.2  Solution 9.3: Override Control
As a general rule, we can say that one actuator can control only one output variable at 
a time. However, it is possible to use the same actuator to control two or more variables 
depending on which variable is the most critical at a given time. This is the override control, 
also known as constraint control or selector control. It is composed of a feedback controller 
Gk(s) and a closed-loop for each output variable, from the sensor yk(s) to the controller out­
put uk(s). Additionally, a special block or blocks, named “Selectors,” receive the controller 
outputs uk(s) and apply the most critical one to the actuator u(s) at a given time.
Figure 9.10 shows an override control solution for Figure 9.9 hydraulic system. It requires 
to regulate the flow rate and simultaneously needs to make sure that the pressure of the 
y2(s)
Pressure sensor
y1(s)
Flow sensor
u(s)
FIGURE 9.9
Challenge 9.3: controlling two outputs with one valve. Two sensors, one actuator.

268
Robust Control Engineering
circuit is always below a given limit. The system has two sensors. The first one measures 
the flow rate y1(s) and the second one the pressure y2(s). Also, the system has one valve u(s). 
The override topology is composed of two controllers: G1(s) for the flow rate and G2(s) for the 
pressure. The control signals of both controllers go to the selector block, which in normal 
conditions (pressure < limit) applies u(s) = u1(s). However, when the pressure approaches the 
limit, then the selector applies u(s) = u2(s) as long as needed. For this, a simple dead-band 
strategy with two limits (y2maxOff < y2maxOn) instead of only one (y2max) can be used in the 
selector to prevent the override control system oscillating around the limit of y2max.
This one-limit case can be easily extended to confine the second variable between an upper 
limit and a lower limit. Figure 9.11 shows the block diagram for this new problem. Now, the 
control objective is to regulate the plant variable y(s) while keeping a second variable z(s) 
between two limits, zmin ≤ z ≤ zmax. The override solution is composed of two sensors, y(s) 
and z(s), one actuator u(s), three controllers, G1(s), Gmax(s), and Gmin(s), and two selector blocks. 
The reference signals of the three controllers are respectively yref(s), zmax(s), and zmin(s). The 
sensor for the first controller is y(s), and the sensor for both the second and third controllers 
y2(s)
Pressure sensor
y1(s)
Flow sensor
–
+
–
+
Flow rate
controller
Pressure
controller
Selector
r1(s)
r2(s)
u1(s)
e1(s)
u2(s)
u(s)
e2(s)
G1(s)
G2(s)
≤
FIGURE 9.10
Override control system. Controlling y1(s) and keeping y2(s) ≤ y2max.
–
+
–
+
–
+
Selector 2
u = min(uM,u2)
Selector 1
u2 = max(uL,u1)
Gmax(s)
Gmin(s)
zmin(s)
G1(s)
zmax(s)
yref (s)
Pb(s)
Pa(s)
MIN
MAX
u1(s)
e1(s)
u2(s)
uL(s)
y(s)
uM(s)
z(s)
z(s)
eM(s)
eL(s)
u(s)
FIGURE 9.11
Override control system. Controlling y(s) and keeping zmin ≤ z(s) ≤ zmax.

269
Control Topologies
is z(s). The output signals of the three controllers are respectively u1(s), uM(s), and uL(s). The 
first selector “MAX” chooses the largest signal between u1(s) and uL(s): u2 = max(uL, u1). Then, 
the second selector “MIN” chooses the smallest signal between uM(s) and the output of the 
other selector u2(s): u = min(uM, u2). Then it applies the final signal u(s) to the actuator.
As in the first case, only one control loop is in operation at a time. The three controllers 
can be tuned in the same way as single-loop controllers, for instance using the QFT robust 
control methodology. If the controllers have integrators, then it is necessary to track the 
integral states of the controllers that are not in operation to avoid any bump while switch­
ing. Section 10.3.4 describes a bumpless solution that works well in these cases.
9.5  Ratio Control Systems
9.5.1  Challenge 9.4
Given the plant shown in Figure 9.12, with two sensors y1(s) and y2(s) and only one actuator 
u(s), find an appropriate control topology to regulate the ratio between the two variables, 
a = y2/y1. Examples for this problem are combustion processes, where the fuel-to-air ratio 
has to be controlled to improve the combustion efficiency, or blending of chemicals, where 
the ratio between two flows has to be constant or a function of a third variable.
9.5.2  Solution 9.4: Ratio Control
An intuitive solution to control the ratio a = y2/y1 is the topology proposed in Figure 9.13a. 
It measures the signals y1(s) and y2(s), divides them, compares the division with the ratio 
a (reference), and applies the result (error) to the controller Gr(s) and valve u(s). However, 
although this solution seems to be a natural choice, the structure does not work well due 
to the division operation. A simple solution is proposed in Figure 9.13b. This ratio control 
structure avoids the division. It calculates the reference to follow by multiplying the y1(s) 
signal by the ratio a. Then, compares it with y2(s), and applies the resulting error to the 
controller G2(s) and valve u(s).
An extension of this correct solution is shown in Figure 9.14a. In this case the rate a is 
variable and depends on another control loop, which regulates a third variable y0(s) with a 
controller G0(s) that follows a reference r0(s).
y1
y2
y2(s)
y1(s)
u(s)
FIGURE 9.12
Challenge 9.4: controlling the ratio between two variables: a = y2/y1. Two sensors, one actuator.

270
Robust Control Engineering
In case we have two actuators u1(s) and u2(s), one for each pipe, the control structure 
shown in Figure 9.13b can be improved with an additional controller G1(s), as shown in 
Figure 9.14b. Now, this main controller G1(s) regulates the flow, and the second controller 
G2(s) follows the first one and controls the ratio.
In this new option, the secondary flow y2(s) is delayed, as compared to the desired flow 
a y1(s). To fix this problem, we have to speed up the secondary flow control system. This 
can be easily done by adding a supplementary feedforward block between the two loops, 
as discussed in Section 9.3. Figure 9.15a and b shows the solution for this problem, with 
0 ≤ γ ≤ 1.
9.6  Mid-Range Control Systems
9.6.1  Challenge 9.5
Given the plant shown in Figure 9.16, with one sensor y(s) = y1 + y2 and two actuators, 
one small and with a very high resolution u1(s), and another much larger and with less 
×
÷
Gr(s)
G2(s)
y2
y1
y2
y1
–
+
–
+
rr(s) = a
r2(s) = a y1(s)
(b)
(a)
a
y1(s)
y1(s)
y2(s)
y2/y1
er(s)
e2(s)
u(s)
y2(s)
u(s)
FIGURE 9.13
Ratio control system: (a) wrong topology and (b) correct solution.
×
×
G2(s)
G2(s)
G1(s)
G0(s)
y2
y1
y2
y1
–
–
–
+
–
+
+
+
r2(s) = a y1(s)
r2(s) = a y1(s)
r1(s)
a
a
y1(s)
y1(s)
y0(s)
e0(s)
r0(s)
y2(s)
e2(s)
e1(s)
e2(s)
u(s)
y2(s)
u1(s)
u2(s)
(b)
(a)
FIGURE 9.14
Ratio control system: (a) with an additional sensor and (b) with two sensors and two actuators.

271
Control Topologies
resolution u2(s), find an appropriate control topology to regulate the output variable y(s) 
with the high resolution of u1(s) in all range of operation and without saturating u1(s).
9.6.2  Solution 9.5: Mid-Range Control
We propose a structure composed of two control loops. The first one measures the sen­
sor signal y(s), compares it with the reference to follow r1(s), and with the controller G1(s) 
moves the small valve u1(s). The second loop measures the signal u1(s), compares it with a 
reference r2(s), and with the controller G2(s) moves the large valve u2(s). The reference r2(s) 
of this second loop is the middle operation point of the small valve. Figure 9.17a and b 
shows this mid-range control topology. In short, the small valve u1(s) and its controller 
G1(s) regulate the flow y(s). As the small valve u1(s) requires more flow and moves away 
from the middle point of its range of operation, the controller G2(s) and the large valve 
u2(s) change the flow through the second pipe to keep the small valve u1(s) in the middle 
of its range of operation.
The effect of the existing delay between the two control loops can be attenuated by intro­
ducing an additional feedforward block Gf(s) from u2(s) to u1(s), as shown in Figure 9.18a 
and b—see also Sections 9.3 and 9.5. This additional block speeds up the reaction of u1(s) to 
variations of u2(s). The design of the feedback and feedforward controllers can be carried 
out in the context of QFT as discussed in Sections 2.11 and 2.12 and Example 2.2.
×
G2(s)
G1(s)
G1(s)
P1(s)
G2(s)
P2(s)
y2
y1
–
–
–
+
–
+
+
+
r2(s) = a [γr1(t) + (1–γ) y1(t)]
a [γr1(s) + (1 – γ) y1(s)]
(1–γ)
γ
r1(s)
r1(s)
r2(s)
a
y1(s)
y1(s)
y2(s)
e2(s)
e1(s)
e1(s)
e2(s)
y2(s)
u1(s)
u1(s)
u2(s)
u2(s)
(b)
(a)
FIGURE 9.15
Ratio control system with two sensors, two actuators and feedforward.
y2(s)
y1(s)
y(s)= 
y1 + y2
u2(s)
u1(s)
FIGURE 9.16
Challenge 9.5: controlling all range with the high resolution of the small valve, and without saturating it. One 
sensor, two actuators.

272
Robust Control Engineering
9.7  Load-Sharing Control Systems
9.7.1  Challenge 9.6
Given the plant shown in Figure 9.19, with one sensor Ω(s) and two actuators u1(s) and u2(s), 
find an appropriate control topology to regulate the output variable Ω(s) coordinating both 
actuators u1(s) and u2(s), and avoiding them to fight each other. The example of Figure 9.19 
represents two motors, each one with a pinion, and a central wheel. T1(s) and T2(s) are the 
torques applied by each motor, and Ω(s) the angular velocity of the central wheel.
9.7.2  Solution 9.6: Load-Sharing Control
An intuitive solution to control the common variable Ω(s) with the two actuators available, 
u1(s) and u2(s), is to close a control loop around each of them, with two controllers G1(s) 
and G2(s) as shown in Figure 9.20a. However, although this solution seems to be a natural 
choice, if both controllers have an integral part, the actuators can eventually start fighting 
G2(s)
G2(s)
G1(s)
G1(s)
P1(s)
P2(s)
y2
y1
–
+
+
+
+
+
–
–
–
+
r1(s)
(a)
(b)
r1(s)
r2(s)
r2(s)
y1(s)
e2(s)
e2(s)
e1(s)
e1(s)
y2(s)
u1(s)
u1(s)
u2(s)
u2(s)
y1(s) + y2(s)
y(s) =
y(s)
FIGURE 9.17
Mid-range control system.
G2(s)
G1(s)
P1(s)
P2(s)
+
+
+
+
+
+
–
–
r1(s)
r2(s)
y1(s)
e2(s)
e1(s)
y2(s)
u1(s)
u2(s)
y1(s) + y2(s)
y(s) =
y(s)
Gf (s)
Gf (s)
G1(s)
G2(s)
y2
y1
–
+
+
+
–
+
r1(s)
r2(s)
e2(s)
e1(s)
u1(s)
u2(s)
(a)
(b)
FIGURE 9.18
Mid-range control system with two control loops and feedforward.

273
Control Topologies
each other, providing opposite torques T1(s) and T2(s) for a controlled angular speed Ω(s), 
as shown in Figure 9.20b.
Three solutions to this problem are proposed here. The first and second one use the 
block diagram shown in Figure 9.20a, either with only one controller Gi(s) with integral 
part (first solution), or with no integral parts at all in any controller Gi(s) (second solution). 
In this second case, simple controllers with high gain can do the job, like the first-order 
transfer functions proposed by the so-called droop control, commonly used in the electri­
cal grid for frequency control.
A third solution is shown in the block diagram of Figure 9.21a. In this case, there is only 
one controller G1(s). Now, it can include an integral part. Its output is divided, or shared, 
between the two channels according to the γ or (1 − γ) weighting factors, 0 ≤ γ  ≤ 1.
The three options can be easily expanded to more than two channels. A MIMO QFT 
robust control with a load-sharing solution for spacecraft formations can be found in 
Reference 209. Also, the book Load-Sharing Control, written by Prof. Eduard Eitelberg, is an 
excellent reference for this matter.147
9.8  Split-Range Control Systems
9.8.1  Challenge 9.7
Given the plant shown in Figure 9.22, with one sensor y(s) and two actuators u1(s) and u2(s), 
find an appropriate control topology to regulate the output variable y(s) moving the actua­
tors one at a time, depending on the selected regime.
Ω(s)
T1(s)
T2(s)
M1
M2
u1(s)
u2(s)
FIGURE 9.19
Challenge 9.6: controlling one variable with several motors. One sensor, several actuators.
Time
r = speed reference
Ω = speed
Torque zero
Fighting!
Ω(s)
T1(s)
T1
T2
T2(s)
M1
M2
u1(s)
u2(s)
G2(s)
G1(s)
–
+
0
r(s)
e(s)
(a)
(b)
FIGURE 9.20
Potentially wrong solution if channels fight against each other.

274
Robust Control Engineering
9.8.2  Solution 9.7 Split-Range Control
Control the common variable y(s) with the two actuators available, u1(s) and u2(s), by clos­
ing a control loop around each actuator, with two controllers G1(s) and G2(s), as shown in 
Figure 9.23a and b. Add a selector block, with a dead-band in the middle, as shown in 
Figure 9.23c. This selector chooses one controller at a time, depending on the state of the 
system. The dead-band prevents the system from oscillating while in the frontier of the 
system states. Also, if the controllers have integrators, then it is necessary to track the inte­
gral states of the controllers that are not in operation to avoid any bump while switching. 
Section 10.3.4 describes a bumpless solution that works well in these cases.
A typical example of this split-range control topology is an air-conditioning system, 
with a heating system u1(s), a cooling system u2(s), and a common temperature sensor y(s).
9.9  Inferential Control Systems
9.9.1  Challenge 9.8
Let us suppose a plant with the block diagram shown in Figure 9.24. It has one sen­
sor z(s) and one actuator u(s). The variable to be controlled is y(s), for which there 
is no sensor available. Find an appropriate control topology to regulate this output 
Ω = speed
T1
T2
Time
r = speed reference
(b)
(a)
Torque zero
0
Ω(s)
T1(s)
T2(s)
T20
T10
u1(s)
u2(s)
P2(s)
P0(s)
P1(s)
G1(s)
–
+
+
+
+
+
r(s)
e(s)
γ
(1–γ)
FIGURE 9.21
Load-sharing control system solution. (a) Block diagram and (b) control signals.
y(s)
u1(s)
u2(s)
FIGURE 9.22
Challenge: controlling one variable with two valves. One sensor, two actuators.

275
Control Topologies
variable y(s). The expressions for the variable to be controlled y(s) and the sensor z(s), 
from the ­actuator u(s) and a disturbance d(s), are described by Equations 9.16 and 9.17, 
respectively.
	
y s
P s u s
M s d s
( )
( ) ( )
( ) ( )
=
+
1
1
	
(9.16)
	
z s
P s u s
M s d s
( )
( ) ( )
( ) ( )
=
+
2
2
	
(9.17)
9.9.2  Solution 9.8: Inferential Control
From Equation 9.17, we can express d(s) in terms of z(s) and u(s)—see Equation 9.18. 
Introducing this result in Equation 9.16, we get the expression of Equation 9.19, where we 
have substituted the plants P1(s), P2(s), M1(s), and M2(s) by the corresponding estimated 
models ˆ ( ), ˆ ( ), ˆ ( ), ˆ ( )
P s P s M s M s
1
2
1
2
.
Selector
Selector
Open
Valve 1
0
Closed
0.5
1
Valve 2
Selector
u1(s)
u1(s)
u2(s)
u2(s)
P2(s)
P1(s)
G2(s)
G1(s)
G1(s)
G2(s)
–
–
+
+
r(s)
(a)
(b)
(c)
r(s)
y(s)
y(s)
e(s)
e(s)
FIGURE 9.23
Split-range control system.
M1(s)
P1(s)
P2(s)
M2(s)
+
u(s)
+
+
+
d(s)
y(s)
z(s)
Actuator
Sensor
Variable
to be
controlled
FIGURE 9.24
Challenge 9.8: no sensor available for the variable y(s) to be controlled.

276
Robust Control Engineering
The left term of Equation 9.19 is the estimated value for the signal y(s) we need to con­
trol, which has no sensor available. Figure 9.25 shows the implementation of the infer­
ential control topology to regulate y(s). It is based on Equation 9.19 for the estimated 
signal ˆ( )
y s .
	
d s
M s z s
P s
M s u s
( )
( ) ( )
( )
( ) ( )
=
−
1
2
2
2
	
(9.18)
	
ˆ( )
ˆ ( )
ˆ ( )
ˆ ( )
ˆ ( )
( )
ˆ ( )
ˆ ( )
y s
P s
M s
M s
P s u s
M s
M s
=
−






+
1
1
2
2
1
2
z s( )
	
(9.19)
9.10  Auctioneering Control Systems
9.10.1  Challenge 9.9
Given a long reactor with many sensors y1(s), y2(s),…,yn(s) spatially distributed as shown 
in Figure 9.26, and one actuator u(s), find an appropriate control topology to maintain all 
variables yk(s) below (or above) a given limit.
Estimator
ˆ
M1(s)
M2(s)
u(s)
d(s)
y(s)
z(s)
P2(s)
P1(s)
G(s)
–
+
+
+
+
+
+
+
r(s)
y(s)
ˆM1(s)
ˆP1(s)
ˆP2(s)
ˆM2(s)
ˆM1(s)
ˆM2(s)
e(s)
FIGURE 9.25
Inferential control system.

277
Control Topologies
9.10.2  Solution 9.9: Auctioneering Control
Figure 9.27 shows the topology for the auctioneering control problem. It is composed of 
one control loop, with the feedback controller G(s) and the prefilter F(s), a set of sensors y1(s), 
y2(s) … yn(s) spatially distributed along the reactor, an actuator u(s), and a selector that uses 
the sensor with the higher (lower) value at any time.
9.11  Summary
This chapter has proposed control topology solutions for nine common problems with a 
different number of sensors and actuators in the system, including cascade control, feed­
forward control, override control, ratio control, mid-range control, load-sharing control, 
split-range control, inferential control, and auctioneering control.
y2
y3
y4
y5
y6
y1
Temperature
y(t)
Length tubular reactor
FIGURE 9.26
Challenge 9.9: maintain all variables yk(s) under a given limit. Many sensors, one actuator.
Selector
Coolant
Products
Reactants
y2(s)
y3(s)
y4(s)
y5(s)
r1(s)
r(s)
e(s)
u(s)
F(s)
G(s)
+
–
y6(s)
y1(s)
FIGURE 9.27
Auctioneering control system.

278
Robust Control Engineering
9.12  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Example 2.2. Section 2.11. Model matching. Airplane flight control.
•	 Example 2.2. Section 2.12. Feedforward/feedback. Airplane flight control.
•	 Case study CS4. Cascade control for a radio telescope servo system.
•	 Project P3. Override control for inverted pendulum.
•	 Project P4. Load-sharing control for interconnected micro-grids.
•	 Project P7. Feedforward and cascade control of a multi-tank hydraulic system.

279
10
Controller Implementation
10.1  Introduction
This chapter deals with the analog and digital implementation of controllers. Section 10.2 
studies the analog implementation with active RC (resistor-capacitor) electrical circuits. 
Section 10.3 presents a variety of practical issues concerning the digital implementation 
with microcontrollers. Finally, Section 10.4 studies the resiliency of the implemented con­
trollers with a fragility analysis method based on QFT.
10.2  Analog Implementation
Sensors and actuators used in control systems work habitually with electrical signals as 
outputs and inputs, respectively. Also, control commands are often generated as electrical 
signals. In all these cases, the controllers can be easily implemented with active RC circuits, 
which are simple combinations of operational amplifiers, resistors, and capacitors.
Although a digital implementation of controllers is a common and attractive solution 
nowadays (see Section 10.3), an analog implementation can still be the best option in some 
cases. In particular, an analog implementation has to be considered when extreme reliabil­
ity is needed (for instance in spacecraft missions), when the bandwidth of the dynamics of 
the plant is very large and the available sampling time for the potential digital solution is 
not fast enough (for instance in power electronics), or when the cost of the implementation 
is an important factor for the project (for instance in low-cost systems).
The main element of an active RC circuit is the operational amplifier (op-amp). The mag­
nitude frequency response of the op-amp is typically constant (about 100–120 dB) for a 
very large bandwidth (up to 100 kHz or 1 GHz). The electrical behavior of the op-amp 
within this flat-response range has two main characteristics:
	
1.	The input impedance at the positive and negative ports is infinite, which means 
that the input currents are null: i+ = i− = 0.
	
2.	The voltage of the positive and negative ports is the same: v+ = v−.
Figure 10.1 shows a simple active RC circuit with one op-amp and two resistors, R1 and 
R2. As mentioned, i+ = i− = 0. Also, the circuit imposes v+ = 0, which also means v− = 0. 

280
Robust Control Engineering
As a result, i1 = (v1 − 0)/R1, i2 = i1, and v0 = 0 − R2 i2. Substituting i2 = i1 = v1/R1, the v0/v1 
transfer function is −R2/R1, which is Equation 10.1.
	
v s
v s
g s
R
R
0
1
1
2
1
( )
( )
( )
=
= −
	
(10.1)
A collection of active RC circuits commonly employed in the analog implementation of 
controllers are shown in Figures 10.1 through 10.15. The transfer functions for these cir­
cuits are also shown in Equations 10.1 through 10.14.
R1
R2
v0
v1
i–
i+
v+
v–
i2
i1
+
–
FIGURE 10.1
Gain (negative), Equation 10.1.
v0
v1
R
C
–
+
+
FIGURE 10.4
Integrator and negative gain, Equation 10.4.
v0
v1
–
+
+
R
C
FIGURE 10.3
Differentiator and negative gain, Equation 10.3.
R1
R2
R1
R2
v0
v2
v1
+
–
FIGURE 10.2
Summer, Equation 10.2.

281
Controller Implementation
v0
v1
R3
R2
C1
R1
–
+
+
FIGURE 10.5
Lead controller and negative gain, Equation 10.5.
v0
v1
R2
C1
R3
R1
–
+
+
FIGURE 10.6
Lag controller and negative gain, Equation 10.6.
v0
v1
C1
C2
R1
–
+
+
+
FIGURE 10.7
PD with negative gain, Equation 10.7.
v0
v1
C1
R2
R1
–
+
+
FIGURE 10.8
PI with negative gain, Equation 10.8.
v0
v1
C1
C2
C3
R1
R2
R2
R2
R3
–
+
+
+
+
+
+
–
–
FIGURE 10.9
PID with positive gain, Equation 10.9.

282
Robust Control Engineering
v0
v1
R2
C2
C1
R1
R3
R3
+
+
+
–
FIGURE 10.10
Complex zeros and negative gain, Equation 10.10.
v0
v1
R2
C2
C1
R1
R3
R3
+
+
+
–
FIGURE 10.11
Complex poles and negative gain, Equation 10.11.
v0
v1
C
R1
R2
+
+
–
FIGURE 10.12
Real pole and negative gain, Equation 10.12.
v0
v1
R1
R2
R3
C1
C2
+
+
+
–
FIGURE 10.13
Complex poles and negative gain, Equation 10.13.

283
Controller Implementation
These figures and expressions include the circuits needed for the implementation of 
the controller elements selected in the QFT design process, including gain, integrators, 
differentiators, real poles and zeros, complex poles and zeros, lead and lag controllers, 
notch filters, PI, PD, and PID controllers, and nonlinearities. As a result, the QFT feedback 
controllers and prefilters, feedforward blocks (see Chapter 9), sum of signals, and even 
nonlinear control components (see Chapters 6 and 7) can be implemented with a combina­
tion of these circuits: that is, G(s) = gi(s) gj(s) gk(s) …, etc.
	
v s
R
R
v s
v s
0
2
1
2
1
( )
[
( )
( )]
=
−
	
(10.2)
	
v s
v s
g s
RCs
0
1
3
( )
( )
( )
[
]
=
= −
	
(10.3)
	
v s
v s
g s
RCs
0
1
4
1
( )
( )
( )
=
= −
	
(10.4)
	
v s
v s
g s
R
R
R
R C s
R R C
R
R
0
1
5
3
1
2
2
1
1
2
1
1
1
( )
( )
( )
((
) (
=
=
−
+






+
+
/
2
1
))s+
	
(10.5)
	
v s
v s
g s
R
R
R
R R C
R
R
s
0
1
6
1
2
3
1
2
1
1
2
( )
( )
( )
(
) ((
) (
))
=
= −
+






+
+
/
1
1
2
1
R C s+
	
(10.6)
	
v s
v s
g s
k
k s
C
C
R C s
p
d
0
1
7
2
1
1
2
( )
( )
( )
(
)
=
=
+
= −
+





	
(10.7)
v0
v1
R1
R2
R4
R5
C3
R3
C1
C2
+
+
+
+
–
+
–
FIGURE 10.14
Notch filter, Equation 10.14.
v0
v1
R1
R2
+
–
FIGURE 10.15
Nonlinearity (saturation).

284
Robust Control Engineering
	
v s
v s
g s
k
k
s
R
R
R C s
p
i
0
1
8
1
2
2
1
1
( )
( )
( )
=
=
+





= −
+





	
(10.8)
	
v s
v s
g s
k
k
s
k s
C
C
R C s
R C s
p
i
d
0
1
9
2
1
3
3
1
2
1
( )
( )
( )
=
=
+
+





=
+
+





	
(10.9)
	
v s
v s
g
s
R
R R
R R C C s
R
R C
0
1
10
1
2
3
2
3
2
1
2
2
3
2
2
2
( )
( )
( )
(
)
(
=
= −






+
+
+
+
+
R C s
R
R
R C s
3
1
3
2
3
1
2
2
)
(
)
	
(10.10)
	
v s
v s
g
s
R R
R
R C s
R R C C s
R
0
1
11
2
3
1
3
1
2
3
2
1
2
2
2
( )
( )
( )
(
)
=
= −






+
+
3
2
2
3
1
3
2
2
2
(
)
(
)
R C
R C s
R
R
+
+
+
	
(10.11)
	
v s
v s
g
s
R
R
R Cs
0
1
12
2
1
2
1
1
( )
( )
( )
=
= −






+
	
(10.12)
	
v s
v s
g
s
R
R
R R C C
s
s R
R
0
1
13
2
1
2
3
1
2
1
2
1
1
2
( )
( )
( )
(
)
(
=
= −






+
+
−
−
−
−
−
−
+
+
1
3
1
1
1
2
3
1
2
1
R
C
R R C C
)
(
)
	
(10.13)
	
v s
v s
g
s
s
R C s
R
R
R
s
0
1
14
2
1
1
2
5
4
5
4 1
1
( )
( )
( )
(
(
)))
=
=
+
−
+
+
/(
	
(10.14)
The values for the resistors are typically chosen from 5 kΩ to 2 MΩ, and the values for 
the capacitors from 1 pF to 100 mF. The impedance between v− and v0 (like R2 in Figure 
10.1) should not be too small to avoid a large consumption of power in this impedance. On 
the other hand, the impedance between v1 and v− (like R1 in Figure 10.1) should not be too 
large, since it reduces the input signal and increases the thermal noise effect.256
Finally, the ground configuration of the circuits needs special attention. In particular, 
we have to avoid ground paths where the current can flow and produce voltage drops. For 
instance, when analog and digital systems are present, we must connect the analog and 
digital grounds at one point only (this is quite often at the A/D converter). See Reference 
256 for more details.
10.3  Digital Implementation
A digital control system (Figure 10.16) utilizes a digital computer or microprocessor (μP) 
to compute the control law or algorithm; an analog-to-digital converter (A/D C) to sample 
the analog sensor signals and convert them into digits or numbers for the algorithm; and 
a digital-to-analog converter (D/A C) to convert the result of the control algorithm (num­
bers) into an analog control signal for the actuators. The A/D and D/A conversions are 
made once every sampling time (see Section 10.3.1).

285
Controller Implementation
10.3.1  Sample and Hold
Sampling a continuous-time signal is to replace the signal by its values at a discrete set of 
points. Sampling instants are equally spaced in time at tn = nh, where h is the sampling 
period or sampling time (s), and fs = 1/h (Hz) or ωs = 2π/h (rad/s) the sampling frequency. 
Figure 10.17 shows the sampling of a continuous signal. The frequency fN = 1/(2 h) (Hz) or 
ωN = π/h (rad/s) is known as the Nyquist frequency.
The sampling process can create new frequency components in the post-processed sig­
nal. This effect is known as aliasing. In particular, sampling of a signal of frequency ωsignal 
creates additional signal components ωadded with frequencies: ωadded = n ωs ± ωsignal, where 
ωs = 2π/h (rad/s) is the sampling frequency and n is an arbitrary integer. For example, in 
Figure 10.18, the additional component added by the aliasing has a frequency of fadded = n 
fs ± fsignal = 0.52632 − 0.5 = 0.02632 Hz, which is Tadded = 38 s (period).
To avoid the aliasing problem, we need fsignal < fN < fs, where fN = fs/2 (Hz) is the 
Nyquist frequency. Figure 10.19 shows an example with no aliasing, where the signals are: 
fsignal = 0.50 < fN = 1.25 < fs = 2.50 Hz.
The Shannon sampling theorem says that: “A continuous-time signal with a Fourier 
transform that is zero outside the interval (−ω0, ω0) is given uniquely by its values in equi­
distant points if the sampling frequency ωs is higher than 2ω0. That is to say: ωs > 2ω0.” 
Best practices however recommend a much higher sampling frequency, with ωs larger than 
20 times the plant crossover frequency.
D/A C
A/D C
µP
–
Digital control system
Actuators
Plant
Sensors
P(s)
FIGURE 10.16
Digital control system. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)

286
Robust Control Engineering
The analog-to-digital converter (A/D C) samples the analog sensor signals and converts 
them into digits or numbers for the algorithm (Figure 10.16). The sampling operation has 
a transfer function of
	
Sampler(s)= 1
h 	
(10.15)
On the other hand, the digital-to-analog converter (D/A C) converts the result of the 
control algorithm (numbers) into an analog control signal for the actuators (Figure 10.16). 
0
1
2
3
4
5
6
7
0
0.2
0.4
0.6
0.8
1
Time (s)
Sampling time h = 0.2 s
h
n
n – 1
FIGURE 10.17
Sampling a continuous signal.
10
20
30
40
50
60
–0.3
–0.2
–0.1
0
0.1
0.2
0.3
Time (s)
Signal frequency = 0.5 Hz, Sampling frequency = 0.52632 Hz
FIGURE 10.18
Aliasing problem when sampling a continuous signal. Original signal (solid line); sampled signal (dashed line 
with “o”).

287
Controller Implementation
The D/A C output signal is piecewise constant, continuous from the left. Standard digital-
to-analog converters (D/A C) are designed as a zero-order hold (ZOH). They hold constant 
the old value until new conversion is ordered (see Figure 10.20).
The ZOH has a function GZOH(t) = uunitStep(t) − uunitStep(t − h), which is
	
G
s
e
s
sh
ZOH( ) =
−
−
1
	
(10.16)
20
25
30
35
40
–0.3
–0.2
–0.1
0
0.1
0.2
0.3
Time (s)
Signal frequency = 0.5 Hz, Sampling frequency = 2.5 Hz
FIGURE 10.19
No aliasing when sampling a continuous signal. Original signal (solid line); sampled signal (dashed line 
with “o”).
19
20
21
22
23
24
–0.3
–0.2
–0.1
0
0.1
0.2
0.3
Time (s)
FIGURE 10.20
ZOH process.

288
Robust Control Engineering
Using the first Pade approximation for the time delay, which is valid when the value of 
h is small enough
	
e hs
sh
sh
−
≈
−
+
1
2
1
2
/
/
	
(10.17)
the transfer function of the ZOH becomes
	
G
s
e
s
h
hs
sh
ZOH( ) =
−
≈
+
−
1
2
2 	
(10.18)
Now, combining Equations 10.15 and 10.18, sampler and hold (S&H), the transfer func­
tion results
	
G
s
h
h
hs
s
h
S
H
& ( )
( /( / ))
≈
+
=
+
1
2
2
1
2
1 	
(10.19)
This S&H transfer function has to be included in the block diagram and considered in the 
controller design process. This means that the plant to be controlled becomes Pnew(s) = P(s) 
GS&H(s), as it is shown in Figure 10.21.
If h is very small (very high sampling frequency in comparison to the bandwidth of 
the dynamics of the plant), the additional pole at s = −2/h included by GS&H(s) is at a very 
high frequency, and then it affects very little the design of the controller (loop shaping). 
However, if h is not small enough, the effect of this pole can be quite significant in the sys­
tem stability and design of the controller.
10.3.2  Computer Control Algorithms
Once the controllers [G(s), F(s), etc.] have been designed in the manner described in the pre­
vious chapters, their s-domain expressions are transformed into digital control algorithms 
following three steps:
Step 1: The s-domain transfer functions [G(s), F(s), etc.] are transformed into z-domain 
expressions [G(z), F(z), etc.] by use of an s-to-z transformation.
Step 2: The z-domain expressions [G(z), F(z), etc.] are rearranged in terms of z−m fac­
tors, m = 0, 1, 2,… . This is easily done by multiplying the z-domain transfer func­
tions by z−α, being α the exponent of the highest order of the polynomials. In this 
way, the expression for u(z) is obtained.
u(s)
P(s)
1
1
(2/h)
s
y(s)
FIGURE 10.21
Sampling and ZOH model and plant.

289
Controller Implementation
Step 3: The u(z) expression is translated into algorithms in terms of u(n), u(n − 1), 
u(n − 2),…, e(n), e(n − 1), e(n − 2),…, being u(n − α) = u(z) z−α, e(n − α) = e(z) z−α, and 
(n) the current sampling period, (n − 1) the previous sampling period, (n − 2) two 
sampling periods ago, and so on.
Step 1 translates the controller s-domain functions into z-domain functions. The exact 
s-to-z transformation is shown in Equation 10.20. As this expression is irrational, we use 
rational approximations for the s-to-z transformation. As an illustration, Equation 10.21 
shows the Forward difference or Euler approximation, Equation 10.22 the Backward differ­
ence approximation, and Equation 10.23 the Tustin or Bilinear approximation. Example 10.1 
applies these three steps to a simple PI controller.
	
Exact expression : z
esh
=
	
(10.20)
	
Forward approximation : s
z
h
=
−1
	
(10.21)
	
Backward approximation : s
z
zh
=
−1
	
(10.22)
	
Tustin approximation : s
h
z
z
=
−
+
2
1
1 	
(10.23)
EXAMPLE 10.1
•	 Step 0: The controller as an s-domain transfer function.
	
Equation 10.24 is a PI controller, designed according to previous chapters.
	
u s
e s
G
s
K
Ts
K
T
Ts
s
PI
i
i
i
( )
( )
( )
=
=
+





=





+
(
)
1
1
1
	
(10.24)
•	 Step 1: The controller as a z-domain transfer function.
	
Applying Equation 10.21, Forward approximation, through Equation 10.24, we 
obtain Equation 10.25.
	
u z
e z
G
z
K
T
T
z
h
z
h
PI
i
i
( )
( )
[ ((
)/ )
]
((
)/ )
( )
=
=





−
+
−
1
1
1
	
(10.25)
	
which also is
	
(
) ( )
(
)
z
u z
K z
h
T e z
i
−
=
−
+





( )
1
1
	
(10.26)
•	 Step 2a: The z-domain expression in terms of z−m factors.
	
Multiplying Equation 10.26 by z−1, we obtain Equation 10.27.
	
(
) ( )
(
)
1
1
1
1
1
−
=
−
+





( )
−
−
−
z
u z
K
z
h
T z
e z
i
	
(10.27)

290
Robust Control Engineering
•	 Step 2b: The u(z) expression in terms of z−m factors.
	
Solving Equation 10.27 for u(z), we obtain Equation 10.28.
	
u z
u z z
Ke z
Kh
T
K e z z
i
( )
( )
=
+
( )+
−





( )
−
−
1
1
	
(10.28)
•	 Step 3: The algorithm expression in terms of (n), (n − 1), (n − 2), …
	
Applying u(n − α) = u(z) z−α and e(n − α) = e(z) z−α to Equation 10.28, we obtain 
Equation 10.29.
	
u n
u n
Ke n
K h
T
e n
i
( )
(
)
(
)
=
−
+
( )+
−






−
1
1
1
	
(10.29)
Finally, Figure 10.22 shows the code implementation of Equation 10.29 in the digital 
control algorithm. In each iteration (every sampling time h), the algorithm measures y(n) 
from the A/D converter and r(n) from the desired reference signal, calculates e(n), pro­
cesses u(n) according to Equation 10.29, sends u(n) to the D/A converter (which is con­
nected to the actuator), and renames u(n) and e(n) as u(n − 1) and e(n − 1), respectively, 
for the next iteration.
Note 1: the s-to-z transformation calculated in Step 1 can also be done in MATLAB 
using the command “c2d,” which converts continuous-time transfer functions 
into discrete-time transfer functions. As an illustration, we reconsider Example 
10.1 again, now with K = 12, Ti = 6, and a sampling period h = 3 s. Then,
	
u s
e s
G
s
K
T
T s
s
s
PI
i
i
( )
( )
( )
=
=





+
(
) =





+
(
)
1
12
6
6
1
s
	
(10.30)
	
GPIz
c d tf
Tustin
Matlab command
=
′
′ −
2
2
6 1
1 0
3
( ( *[
],[
]), ,
)
	
(10.31)
	
u z
e z
G
z
z
z
PI
( )
( )
( )
=
=
−
−
15
9
1 	
(10.32)
h
u(n) = u(n − 1) + ke (n) + K
e(n) = r(n) – y(n)
–1
Ti
u(n − 1) = u(n) % for the next iteration
e(n − 1) = e(n) % for the next iteration
e(n − 1)
y(n) 
u(n) 
r(n) 
FIGURE 10.22
Algorithm implementation.

291
Controller Implementation
	
z
u z
z
e z
−
(
)
=
−
(
)
1
15
9
( )
( ) 	
(10.33)
	
(
) ( )
(
) ( )
1
15
9
1
1
−
=
−
−
−
z
u z
z
e z 	
(10.34)
	
u n
u n
e n
e n
( )
(
)
( )
(
)
=
−
+
−
−
1
15
9
1 	
(10.35)
Note 2: Frequency warping. The frequency scale can be distorted due to the discretiza­
tion approximation. This can significantly affect notch filters and low-pass filters, 
resulting in incorrect applied notch frequencies and bandwidth. To understand 
the problem, we apply the exact s-to-z transformation, shown in Equation 10.20 to 
the Tustin transformation shown in Equation 10.23, so that
	
s
h
z
z
h
e
e
h
e
e
e
e
j
h
sh
sh
sh
sh
sh
sh
=
−
+
=
−
+
=
−
+
=
−
−
2
1
1
2
1
1
2
2
2
2
2
2
/
/
/
/
tan ωh
2





	
(10.36)
which in the plant P(s) is
	
P s
P h
e
e
P j h
h
sh
sh
( )
tan
=
−
+





=












2
1
1
2
2
ω






= P j
p
(
)
ω
	
(10.37)
with
	
ω
ω
p
h
h
=






2
2
tan
	
(10.38)
The difference between the original frequency (ω) and the digital implemented fre­
quency (ωp) is shown in Figure 10.23. As we can see, the higher the frequency, the 
larger the difference.
A solution to eliminate the warping distortion at a given frequency ω = ω1 is to mod­
ify the Tustin approximation with a pre-warping factor, as shown in Equation 
10.39
	
s
h
h
h
z
z
h
z
z
=






−
+
=
−
+
ω
ω
ω
ω
1
1
1
1
2
2
2
1
1
2
1
1
tan(
/ )
tan(
/ )
	
(10.39)
Note 3: Ringing. If the discretization method gives a denominator of G(z) with stable 
negative poles (poles inside the unitary circle with negative real part, Figure 10.24a), 
then these negative poles of the controller will change the sign of the output u(t) 
at each sampling time (see Figure 10.24b). This effect is called ringing, and should 
be avoided by selecting another more appropriate discretization method to obtain 
stable positive poles (poles inside the unitary circle with positive real part).
Note 4: Quantization. A digital computer has a finite precision in the calculations 
(number of bits). This limitation affects the terms of the digital controller. As 
the coefficients of the digital controller are proportional to the sampling time 
h, when the sampling time h is very small, the controller terms can be rounded 

292
Robust Control Engineering
off if the computer has not enough precision. This will produce a steady state 
error, or integral offset. As an example, consider the digital PI controller shown 
in Equation 10.29. If the coefficients are K = 0.1, Ti = 1200, and h = 0.02 s, the coef­
ficient Kh/Ti = 1.7 × 10−6 = 2−19.2. To represent this number in the computer, we 
need 20 bits. If, however, h = 1 s, then we only need 14 bits.
In summary, the sampling frequency fs = 1/h has to be fast enough (h small enough) to 
pick the dynamics of the system, avoid aliasing problems and warping distortion, and put 
the effect of the sample and hold additional function GS&H(s) at a frequency much higher 
than the crossover frequency. On the other hand, the sampling frequency fs is upper-lim­
ited by the finite precision (number of bits) of the calculations. A good sampling frequency 
selection is ωs = 2π/h = 2πfs > 20ω1, ω1 being the frequency of the fastest pole or zero of the 
plant, or the crossover frequency (whoever is higher).
10.3.3  Positional and Velocity Algorithms
Positional algorithms calculate the complete expression for the controller output u(n) at 
every sample. On the contrary, velocity algorithms (or incremental) only calculate the incre­
ment Δu(n) or difference from the previous controller output u(n − 1) at every sample.
t
Re 
Im 
0 
u(t) 
FIGURE 10.24
Ringing problem.
0
50
100
150
200
0
50
100
150
200
250
300
350
w (rad/s)
wp = (2/h)*tan(w*h/2) (rad/s)
h = 0.010 s
wp
w
FIGURE 10.23
Frequency warping.

293
Controller Implementation
As an example, consider the standard PID controller shown in Equations 2.85 through 
2.88, and repeated here as Equation 10.40, with a low-pass first-order filter (at s = −N/Td) 
and a kick-off solution (r = 0) for the derivative part, and with a weight coefficient b for the 
proportional part.
	
u s
K
br s
y s
Ts r s
y s
T s
T
N s y s
i
d
d
( )
[
( )
( )]
[ ( )
( )]
(
/
)
( )
=
−
+
−
−+



1
1


	
(10.40)
10.3.3.1  Positional Algorithm
Applying the Tustin transformation (Equation 10.23) to Equation 10.40, we find the 
Equations 10.41 through 10.44 for the positional algorithm, with the coefficients shown in 
Equations 10.45 through 10.48. In this case, the controller output applied at every sample is 
the complete u(n) signal, calculated with Equation 10.44.
	
P n
K br n
y n
( )
[
( )
( )]
=
−
	
(10.41)
	
I n
I n
b e n
b e n
i
i
( )
(
)
( )
(
)
=
−
+
+
−
1
1
1
2
	
(10.42)
	
D n
a D n
b y n
y n
d
d
( )
(
)
[ ( )
(
)]
=
−
−
−
−
1
1 	
(10.43)
	
u n
P n
I n
D n
( )
( )
( )
( )
=
+
+
	
(10.44)
with
	
b
Kh
T
i
i
1
2
=
	
(10.45)
	
b
Kh
T
i
i
2
2
=
	
(10.46)
	
a
T
Nh
T
Nh
d
d
d
=
−
+
2
2
	
(10.47)
	
b
KT N
T
Nh
d
d
d
=
+
2
2
	
(10.48)
10.3.3.2  Velocity Algorithm
On the contrary, if we calculate the increment of every term as shown in Equations 10.49 
through 10.51, that is ΔP(n), ΔI(n), and ΔD(n) as the difference between the current term (at 
instant n) minus the previous term (at instant n − 1), we can combine all of them to calcu­
late the total increment Δu(n)—see Equation 10.52, and then add it to the previous control­
ler output u(n − 1) to have u(n)—see Equation 10.53. This is the velocity algorithm which, as 

294
Robust Control Engineering
mentioned, only calculates the increment Δu(n) or difference from the previous controller 
output u(n − 1) at every sample.
	
ΔP n
P n
P n
K br n
y n
br n
y n
( )
( )
(
)
[
( )
( )
(
)
(
)]
=
−
−
=
−
−
−
+
−
1
1
1
	
(10.49)
	
ΔI n
I n
I n
b e n
b e n
i
i
( )
( )
(
)
( )
(
)
=
−
−
=
+
−
1
1
1
2
	
(10.50)
	
ΔD n
D n
D n
a D n
b y n
y n
y n
d
d
( )
( )
(
)
(
)
[ ( )
(
)
(
)]
=
−
−
=
−
−
−
−
+
−
1
1
2
1
2
	
(10.51)
	
Δ
Δ
Δ
Δ
u n
P n
I n
D n
( )
( )
( )
( )
=
+
+
	
(10.52)
	
u n
u n
u n
( )
(
)
( )
=
−
+
1
Δ
	
(10.53)
10.3.4  Switching and Bumpless Algorithms
Practically speaking, many control solutions switch controllers among several modes: (a) 
manual/automatic, (b) override solutions—see Section 9.4, (c) split-range solutions—see 
Section 9.8, (d) gain scheduling—see Chapter 6, or (e) nonlinear dynamic control—see 
Chapter 7. To avoid bump problems under these switching events, we have to make sure 
that the state of the system is correct when switching. A practical solution is to implement 
the controller in the velocity (incremental) form described in the previous section. In the 
switching operation, the previous element u(n − 1) is calculated by the previous mode, and 
the increment Δu(n) is calculated by the new mode. Figure 10.25 and Equations 10.54 and 
10.55 show the switching at the time n.
	
Δ
Δ
Δ
Δ
u n
P n
I n
D n
( )
( )
( )
( )
=
+
+
…in a PID controller 	
(10.54)
	
u n
u n
u n
( )
(
)
( )
=
−
+
1
Δ
	
(10.55)
10.3.5  Pulse Width Modulation
Occasionally, we have limited actuators that do not accept a continuous signal, but only 
two values: On (1) or Off (0)—see Figure 10.26. In this situation, we can translate the con­
tinuous output of the controller u(t) into an On/Off signal (only 1 or 0) with a variable pulse 
Mode-1
Mode-2
∆u(n)
u(n – 1)
n
n – 1
FIGURE 10.25
Switching between velocity algorithms.

295
Controller Implementation
time (Ton or Toff times). This method is known as a pulse width modulation (PWM) technique. 
For a given On signal value (umax), Off signal value (umin), and cycle time (Tcycle), the time of 
the cycle that the applied On/Off signal u1(t) is at the maximum value (On), also known as 
Tpulse, is calculated as shown in Equation 10.56 and Figure 10.26. Example 10.2 shows how 
to apply this expression.
	
T
t
u t
u
u
u
T
pulse
cycle
( )
( )
min
max
min
=
−
−
	
(10.56)
EXAMPLE 10.2
Consider the plant P(s) shown in Equation 10.57, the calculated PI analog controller G(s) 
in Equation 10.58, and the corresponding digital controller G(z) in Equation 10.59, calcu­
lated with the Tustin approximation and a sampling time h = 0.01 s.
	
P s
s
( )
( .
)
=
+
9
2 5
1 	
(10.57)
	
G s
s
s
( )=
+
2
1
	
(10.58)
	
G z
z
z
( )
.
.
=
−
−
2 005
1 995
1
	
(10.59)
Consider also that the PWM has a Tcycle = 0.05 s, umax = 1, and umin = 0. Figures 10.27 
and 10.28 show the analog controller and PWM solution respectively, with a simulation 
of the closed-loop control system following a unitary step reference change at t = 1 s. As 
we can see, both cases produce similar control results.
1
1.05
1.1
1.15
1.2
1.25
1.3
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Time (s)
u1
FIGURE 10.26
PWM control signal u1(t).

296
Robust Control Engineering
10.4  Fragility Analysis with QFT
Once we have designed the controllers and have implemented them with either an analog 
active RC circuit or a digital control algorithm, we have to study the resiliency/fragil­
ity of the implemented solution. A fragility problem arises when the implementation of 
the controller compromises the system stability. In the digital case, as the number of bits 
of the microprocessor is limited, the digital implementation requires to round the coeffi­
cients of the controller to a given number of decimals. Additionally, some round off errors 
in numerical computations and inaccuracies in the analog-to-digital or digital-to-analog 
conversions can appear. In the analog case, imprecisions in the selection of resistors and 
capacitors, or potential changes of their values with temperature, can produce the same 
problem. When these small changes in the controller coefficients compromise the system 
stability, we say that the controller is fragile. If these imprecisions do not affect the stability, 
the controller is resilient.85
The fragility problem is primarily found in high-order controllers, usually designed by 
some optimal control synthesis methods, standard model-based techniques, and certain 
0.5
1
1.5
2
2.5
3
3.5
4
–0.5
0
0.5
1
1.5
2
2.5
Time (s)
u1
0.5
1
1.5
2
2.5
3
3.5
4
–0.2
0
0.2
0.4
0.6
0.8
1
1.2
Time (s)
r1, y1
(a)
(b)
FIGURE 10.28
PWM controller, Equation 10.59. (a) r(t) and y(t); (b) u(t).
0.5
1
1.5
2
2.5
3
3.5
4
–0.2
0
0.2
0.4
0.6
0.8
1
1.2
Time (s)
r, y
0.5
1
1.5
2
2.5
3
3.5
4
–0.5
0
0.5
1
1.5
2
2.5
Time (s)
u
(a)
(b)
FIGURE 10.27
Analog controller, Equation 10.58. (a) r(t) and y(t); (b) u(t).

297
Controller Implementation
parameterizations. In 1997, Keel and Bhattacharyya wrote a paper entitled “Robust, Fragile 
or Optimal?”315 which shocked the international community and started off a large set 
of comments and replies.316–325 They demonstrated the inherent fragility of some well-
known H∞, H2, L2, and µ controllers when small changes are introduced in the controller 
coefficients.
This section introduces a practical method based on QFT to analyze the controller fra­
gility/resilience to changes in its coefficients.85 The method simultaneously takes into 
account the plant model with parametric and nonparametric uncertainty, the robust sta­
bility and performance specifications, and the uncertainty in the controller coefficients. It 
studies the controller fragility at every frequency and for both stability and performance 
specifications.
The method starts with the plant model P(s) with uncertainty, the stability and per­
formance specifications, and the designed controller G0(s), which we call the nominal 
controller. It is verified that, with a perfect controller implementation, the closed-loop 
system meets the stability and performance specifications for all the plants within the 
uncertainty.
Now, consider that the uncertainty also affects the controller, which is represented as 
G(s). To analyze the fragility introduced by the controller, we define an extended plant as
	
P s
P s G s
e( )
( ) ( )
=
	
(10.60)
Then, a set of new templates are defined (the extended templates). They combine the plant 
model uncertainty with the controller uncertainty at every frequency of interest. With 
these extended templates, and taking into account the specifications, a set of new bounds 
are defined (the extended bounds). Now, and based on these extended bounds, the controller 
fragility is analyzed. The methodology is composed of the following steps:
Step 1. Define the plant model with uncertainty P(s).
Step 2. Select the nominal plant P0(s) within the set of plants defined by the uncertainty.
Step 3. Define the desired stability and performance specifications for the control 
system.
Step 4. Design a robust controller G0(s).
Step 5. Select the interval of variation of the controller coefficients G(s).
Step 6. Define the extended plant as, Pe(s) = P(s) G(s).
Step 7. Choose P s
P s
e
o( )
( )
=
0
 G0(s) as the nominal extended plant.
Step 8. Generate the extended templates from the extended plant Pe(s) and for the 
frequencies of interest.
Step 9. Calculate the extended bounds from the extended templates and the previous 
stability and performance specifications.
Step 10. Apply a unitary controller to shape P s
e
o( ) over the extended bounds, that is 
L s
P s
e
o
0
1
( )
( )
=
× .
Step 11. If L0(s) penetrates the forbidden region delimited by the extended robust 
stability bounds, then the controller is stability-fragile at these frequencies. If L0(s) 
penetrates the forbidden region delimited by the extended robust performance 
bounds, then the controller is performance-fragile at these frequencies. Otherwise 
it is resilient.

298
Robust Control Engineering
EXAMPLE 10.3:  A FRAGILE CONTROLLER
Consider the simple plant and the parametric uncertainty defined by Equation 10.61. 
The nominal plant is chosen with k = 1 and a = 1—see Equation 10.62.
	
P s
k a
s s
a
k
a
( )
(
) ,
[ ,
],
[ ,
]
=
+
∈
∈
 
 
with
1 10
1 10
	
(10.61)
	
P s
s s
0
1
1
( )
(
)
=
+
 
	
(10.62)
The robust stability specification is selected as Ws = 1.2, which is equivalent to a gain 
and phase margin of GM = 1.8333 dB and PM = 50°. The controller designed for the 
above plant and stability specification (nominal controller) is:
	
G s
k
z s
z s
p s
p s
p
G
0
1
2
1
2
3
1
1
1
1
1
1
1
1
1
( )
(( /
)
)(( /
)
)
(( /
)
)(( /
)
)(( /
=
+
+
+
+
)
)
s+1 	
(10.63)
with
	
k
z
p
z
p
p
G =
=
=
=
=
=
1 1
2 7
20
23
220
18
2
2
1
1
3
.
.
	
Figure 10.29 shows the stability bounds and the loop shaping of the nominal open-
loop transfer function L0(s) = P0(s) G0(s).
–60
–50
–40
–30
–20
–10
0
10
20
30
Open-loop gain (dB)
L0(0.5j) 
B(1j) 
B(2j) 
B(4j) 
B(10j) 
B(20j) 
B(50j) 
B(0.5j) 
B(0.1j) 
L0(0.1j) 
L0(1j) 
L0(2j) 
L0(4j) 
L0(10j) 
L0(20j) 
L0(50j) 
–210 –200 –190 –180 –170 –160 –150 –140 –130 –120 –110 –100
–90
Open-loop phase (deg)
FIGURE 10.29
Nichols chart with the stability bounds of the system P(s) and the nominal open-loop function L0(s) with the 
designed controller G0(s). (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)

299
Controller Implementation
The fragility analysis is now undertaken assuming that the uncertainty in the controller 
parameters is
	
k
z
p
z
p
G ∈
∈
∈
∈
∈
[ . ,
]
[ . ,
]
[
,
]
[
,
]
[
,
1 1
2
2 7
3
20
21
23
24
220
2
2
1
1
  
  
  
  
  221
18
19
3
]
[
,
]
p ∈
  
	
These intervals are related to the applied implementation technique. Here for the sake of 
clarity, they are taken arbitrarily in order to see the effect of the fragility associated with 
the controller uncertainty. The model of the extended system results in the expression 
Pe(s) = P(s) G(s), so that
	
P s
ka
s s
a
k
z s
z s
p s
p s
e
G
( )
(
)
(( /
)
)(( /
)
)
(( /
)
)(( /
)
=
+
+
+
+
+
1
1
1
1
1
1
1
1
2
1
2
1
1
1
3
)(( /
)
)
p s+
	
(10.64)
The parametric uncertainty of the extended plant is
	
k
z
p
k
a
z
G
∈
∈
∈
∈
∈
∈
[ ,
],
[
,
],
[
,
],
[ . ,
]
[ ,
],
[ . ,
1
10
23
24
20
21
1 1
2
1
10
2 7
1
2
2
3
18
19
220
221
3
1
],
[
,
],
[
,
]
p
p
∈
∈
	
Next, the templates of this extended plant are established, that is, the extended templates. 
From these, the new bounds (extended bounds) are drawn up for the same robust stability 
specification Ws = 1.2.
The nominal plant of the extended system is P s
P s G s
e
o( )
( )
( )
=
0
0
. Note that the chosen 
extended nominal plant coincides with the previous nominal plant multiplied by the origi­
nal controller.
Subsequently, a unitary controller to shape P s
e
o( ) over the extended bounds is chosen as 
shown in Equation 10.65. In this way, the open-loop transfer function remains the same 
as before and thus it enables the designer to make the comparison and determine the 
controller resilience. The performance of this new expanded nominal plant is checked 
out with regard to the extended bounds (stability bounds of the extended system), as is 
shown in Figure 10.30.
	
L s
P
s
P s G s
L s
e
e
o
( )
( )
( )
( )
( )
=
× =
=
1
0
0
0
	
(10.65)
When comparing both Figures 10.29 and 10.30, one notices that the extended system vio­
lates the stability requirements at the frequencies 10 rad/s and 20 rad/s, that is, L0(j10) and 
L0(j20) are above Be(j10) and Be(j20), respectively. In other words, the open-loop transfer 
function L0(s) penetrates the forbidden region delimited by the extended robust stability 
bounds, although the original open-loop transfer function (see Figure 10.29) met these 
specifications. In conclusion, G0(s) is a fragile controller for this system.
10.5  Summary
This chapter studied the analog implementation of controllers with active RC electri­
cal circuits and a variety of practical issues concerning the digital implementation with 

300
Robust Control Engineering
microcontrollers. The chapter also studied the resiliency of the implemented controllers 
with a fragility analysis method based on QFT.
10.6  Practice
The list shown below summarizes the collection of problems and cases included in this 
book that apply the control methodologies introduced in this chapter.
•	 Example 10.1. Section 10.3.2. Digital PI algorithm
•	 Example 10.2. Section 10.3.5. Digital PWM-PI algorithm
•	 Example 10.3. Section 10.4. Fragility analysis of a control system
–210 –200 –190 –180 –170 –160 –150 –140 –130 –120 –110 –100
–90
–60
–50
–40
–30
–20
–10
0
10
20
30
Open-loop phase (deg)
Open-loop gain (db)
Be(20j) 
Be(10j) 
L0(10j) 
L0(20j) 
FIGURE 10.30
Nichols chart of the extended stability bounds of the system Pe(s). (Adapted from Garcia-Sanz, M. and Houpis, 
C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and 
Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

301
Case Study 1: Satellite Control
CS1.1  Description
Space technology is one of the main achievements of the twentieth century. It has evolved 
extraordinarily since the very first satellites, the Soviet Sputnik (October 1957) and the 
U.S. Explorer (January 1958). Our modern society depends greatly on satellites. They have 
become the key instruments for telecommunications, airplane navigation, GPS systems, 
meteorology, scientific research, cellphones, TV, internet, etc.
Satellites can operate from low Earth orbits (LEO) around 300 km altitude, to geo­
stationary Earth orbits (GEO) about 42,000 km, and beyond the Earth gravity, toward 
the exploration of other planets. Satellites can be very light, from just a few kilograms 
(nano-satellites), or quite heavy, with more than 1000 kg (large satellites). In most cases, 
they have solar panels to harvest energy from the Sun—see Figure CS1.1. This is usu­
ally possible if they are located not farther than the Asteroid belt, located between the 
orbits of the planets Mars and Jupiter. The physical laws that describe the dynamics and 
motion of a satellite are well known. The control system, and in particular the so-called 
attitude control system (ACS), is one of the key components of every satellite. For addi­
tional information about spacecraft dynamics and control, see Reference 363, written by 
Marcel Sidi, the first PhD student of Professor Isaac Horowitz. Incidentally, notice that 
the QFT-bounds are also known as the Horowitz–Sidi bounds.
This case study CS1 presents the design of an ACS for a satellite with flexible solar 
­panels. The control system has three simultaneous objectives for every plant within the 
model uncertainty: (1) to regulate the angle of motion of the satellite, (2) to reject unpredict­
able disturbances, and (3) to minimize the solar panel vibrations.
We propose a classical 2DOF control system that includes a feedback compensator G(s) 
and a prefilter F(s), as shown in Figure CS1.3. In the following sections, we model and ana­
lyze the dynamics of the satellite, propose a set of stability and performance specifications, 
design the controllers, and validate them in both the frequency and time domains.
CS1.2  Plant Model
Figure CS1.2 shows a model diagram for a satellite with two solar panels. It includes the 
variables and parameters that describe the dynamics of the system. We consider the satel­
lite as a rigid central body with two equal and flexible solar panels, each one modeled as a 
lumped mass at the end of a flexible beam.
The variable we want to control is θ(t), which is the angle of motion of the central body, in 
[rad]. The satellite is equipped with reaction wheels that provide a symmetric torque Tm(t) 

302
Case Study 1: Satellite Control
about the axis of rotation, in [Nm]. In addition, yp(t) is the deformation of the solar panel, 
in [m]. The main parameters of the system are
•	 J0, the moment of inertia of the central body, (kg m2)
•	 m, the mass of each solar panel, as a mass-point at the end of the panel, (kg)
•	 lp, the length of each solar panel, from center of the mass of the central body, (m)
•	 J = J0 + 2 m lp
2, the moment of inertia of the entire system, (kg m2)
•	 Kp, the panel translational stiffness coefficient, (N/m)
•	 Bp, the panel translational damping coefficient, (Ns/m)
•	 t, the time (s).
FIGURE CS1.1
Hispasat. A telecommunication satellite with solar panels.
x1
y1
θ(t)
J0
Tm(t)
m
Kp
Bp
yp(t)
m
Kp
Bp
yp(t)
lp
FIGURE CS1.2
Satellite with solar panels. Model description.

303
Case Study 1: Satellite Control
We start the modeling with the general equation of motion of a mechanical system, 
which is
	
M
C
K
Q



q
q
q
q q u t
+
+
=
( , , , )	
(CS1.1)
where M, C, and K are the mass, damping, and stiffness matrices, Q is the matrix of inputs, 
q is the vector of generalized coordinates, and u is the vector of inputs. Also, the general 
form of the Euler–Lagrange equation is
	
d
dt
L
q
L
q
D
q
Q
i
n
L
E
E
i
i
d
i
i
k
p
∂
∂





−∂
∂
+ ∂
∂
=
=
=
−


…
,
, ,
,
1 2
and
	
(CS1.2)
where qi are the generalized coordinates or degrees of freedom of the system, Qi the gen­
eralized forces applied to each subsystem “i,” Ek and Ep the kinetic and potential energies, 
Dd the dissipator co-content, and L the Lagrangian.236
The generalized coordinates for the satellite with two solar panels are the angle of 
motion of the central body and the deformation of each solar panel, which are, respec­
tively: q1 = θ(t), and q2 = yp(t)—see Figure CS1.2. The system contains the kinetic, potential, 
and dissipative functions described by Equations CS1.3 through CS1.5. Notice that we con­
sider a linear dissipator, which means that the Dd expression or dissipator co-content for 
the Lagrange equations equals one-half of the power being absorbed by the dissipator.236
	
E
J
m y
l
k
p
p
=
+
+
(
)






1
2
2 1
2
0
2
2



θ
θ
	
(CS1.3)
	
E
K y
p
p
p
= 





2 1
2
2
	
(CS1.4)
	
D
B y
d
p
p
= 





2 1
2
2
	
(CS1.5)
The generalized force applied about the axis of rotation of the central body, i = 1, is the 
torque: Q1 = Tm(t). Using Equations CS1.3 through CS1.5, the terms for the Euler–Lagrange 
equation are
	
d
dt
L
q
d
dt
E
E
y
J
i
k
k
p
∂
∂





=
∂
∂
∂
∂






=
+



θ
0
2
2
2
2
2
ml
ml
ml
m
y
p
p
p
p












=



θ
Mq
	
(CS1.6)
	
−∂
∂
= ∂
∂
=
∂
∂
∂
∂






=






L
q
E
q
E
E
y
K
y
i
p
i
p
p
p
p
θ
θ
0
0
0
2
p





= Kq
	
(CS1.7)

304
Case Study 1: Satellite Control
	
∂
∂
=
∂
∂
∂
∂






=







D
q
D
D
y
B
y
d
i
d
d
p
p
p





θ
θ
0
0
0
2





= C q
	
(CS1.8)
	
Q
R
=











=
1
0
0
0
0
Tm
u
	
(CS1.9)
Rearranging the equation of motion Equation CS1.1 as
	


q
q
q
u
=−
−
+
−
−
−
M
C
M
K
M
R
1
1
1
	
(CS1.10)
and using also Equations CS1.6 through CS1.9, we find the state space description of the 
system ( x
Ax
Bu
=
+
; y = Cx) with the expressions,
	
x
I
0
x
0
u
y
0 I x
=
−
−






+






=
−
−
−
M
C
M
K
M
R
1
1
1
[ | ]
	
(CS1.11)
with I = [1 0; 0 1], 0 = [0 0; 0 0], and,
	
A =
−
+
−
+
0
2
0
2
0
2
0
2
1
0
0
0
0
1
0
0
0
2
0
0
2
0
l B
J
l K
J
B J
ml
m J
K
J
ml
m J
p
p
p
p
p
p
p
p
(
)
(
)
0
0





	
(CS1.12)
	
B = −






1
0
0
0
0
0
0
0
0
J
l
J
p
	
(CS1.13)
	
C =






0
0
1
0
0
0
0
1 	
(CS1.14)
	
x
q
q
=





= 






θ
θ
y
y
p
p
T
	
(CS1.15)

305
Case Study 1: Satellite Control
	
u = 

Tm
T
0
	
(CS1.16)
	
y =[
]
θ
yp
T
	
(CS1.17)
Now, applying P(s) = C(sI−A)−1B for y(s) = P(s)u(s), the transfer function p11(s), from the 
torque Tm to the angular movement θ of the satellite, is
	
θ( )
( )
( )
(
)
(
)
(
s
T
s
p
s
J
s
B
m s
K
m
s
s
B
m
p
p
=
=






+
+
(
)
+
11
0
2
2
2
1
/
/
p
p
p
J
m J
s
K J
m J
J
J
ml
/(
)
/(
)
with
0
0
0
2
2
)
(
)
+
(
)
=
+
	
(CS1.18)
and the transfer function p21(s), from the torque Tm to the deformation of the solar panel yp, 
is—see also Figure CS1.3
	
y s
T
s
p
s
J
l
s
B J
m J
s
K J
p
m
p
p
p
( )
( )
( )
(
)
(
=
=






−
+
+
21
0
2
0
1
/(
)
/(m J
J
J
mlp
0
0
2
2
))
with
(
)
=
+
	
(CS1.19)
CS1.2.1  Parametric Uncertainty
For this study, we consider a medium size satellite with the parameters suggested in 
Reference 363. In particular, the mass of each panel is m = 20 kg, the length of each panel, 
from the center of the mass of the satellite to the end of the panel lp = 2 m, and the panel 
translational stiffness coefficient Kp = 320 N/m. The moment of inertia of the entire system 
follows the expression:J
J
ml
J
p
=
+
=
+
0
2
0
2
160.
Many satellites also have a significant mass of fuel to carry out orbit maneuvers with 
thrusters. This mass of fuel is typically up to a 40% of the mass of the central body. As 
this mass changes during the lifetime of the satellite, we include the corresponding uncer­
tainty in the moment of inertia J0 of the system. In addition, we include uncertainty in Bp, 
which is the panel translational damping coefficient for the flexible panels, as it is quite 
+
p11(s)
p21(s)
+
+
+
+
–
Tm(s)
yp(s)
do(s)
G(s)
H(s)
r(s)
n(s)
F(s)
θ(s)
FIGURE CS1.3
ACS for satellite with solar panels.

306
Case Study 1: Satellite Control
difficult to measure with enough precision. Thus, the transfer functions p11(s) and p21(s) 
described in Equations CS1.18 and CS1.19 become
	
θ( )
( )
( )
(
)
(
(
s
T
s
p
s
J
s
B
s
s
s
B J
m
p
p
=
=






+
+
(
)
+
11
0
2
2
2
1
20
16
/
0
0
0
0
160
20
16
160
+
+
+
(
)
)
)
(
(
)
)
/(
)
/
J
s
J
J
	
(CS1.20)
	
y s
T
s
p
s
J
s
B J
J
s
p
m
p
( )
( )
( )
(
(
)
)
=
=






−
+
+
21
0
2
0
0
1
2
160
20
/(
)
+
+
(
)
(
(
)
)
16
160
0
0
J
J
/
	
(CS1.21)
with: J0 ∈ [432, 720] kg m2, Bp ∈ [0.24, 0.48] Ns/m.
CS1.2.2  Frequencies
Figure CS1.5 shows the Bode diagram of the plant p11(s), including also the parametric 
uncertainty. Based on this picture, we select an array of frequencies so that
w =[ .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
0 00 0 00 0 0 0 0 0 0 0
0
0
0
0
0
0
0
0
1
5
1
2
5
1
2
3
4
5
6
7
8
9 1 2 3 4 4 68 5 1 15 rad/s
0
]
	
(CS1.22)
CS1.2.3  Nominal Plant
For the nominal plants p11,0(s) and p21,0(s), we select J0 = 432 and Bp = 0.24, resulting in the 
transfer functions
	
θ( )
( )
( )
(
.
)
(
.
,
s
T
s
p
s
s
s
s s
s
m
0
11 0
2
2
2
0 012
16
0 0164
=
=
+
+
+
+
0.002315
21.93) 	
(CS1.23)
	
y s
T
s
p
s
s
s
p
m
( )
( )
( )
(
.
)
,
0
21 0
2
0 0164
=
=
−
+
+
0.00463
21.93 	
(CS1.24)
CS1.2.4  QFT Templates
Figure CS1.4 shows the QFT templates for this case. They are calculated using the plant 
model and parametric uncertainty defined with Equation CS1.20, and the array of frequen­
cies of interest defined in Equation CS1.22.
CS1.3  Preliminary Analysis
Before starting the design of the controller, we conduct a brief preliminary analysis of the 
dynamics of the satellite. Figure CS1.5 shows the Bode diagram and the NC of p11(s) with 
four cases within the uncertainty:
Case p11-1(s): J0 = 720, Bp = 0.48;  Case p11-2(s): J0 = 720, Bp = 0.32
Case p11-3(s): J0 = 720, Bp = 0.24;  Case p11-4(s): J0 = 432, Bp = 0.48

307
Case Study 1: Satellite Control
As we can see, the system p11(s) has a double integrator. This means that there is initially 
no damping. The system is at the very limit of stability. If a disturbance enters into the 
system, it will oscillate forever, as we can expect for any body in orbit without a control 
system.
In addition, there is a severe resonance mode around ω = 4.50 rad/s, with an extremely 
low damping—see peak in the Bode diagram or loop in the Nichols chart (Figure CS1.5). 
This resonance is a consequence of the flexible panels. As a result, the bandwidth of the 
control system is limited due to this resonance mode.
Moreover, this resonance can also vary with the parametric uncertainty. Thus, the natu­
ral frequency and damping are, respectively, ωn ∈ [4.42, 4.68] rad/s and ζ ∈ [0.0017, 0.0037]. 
As a consequence, this variation of the parameters could eventually change the natural 
frequency and increase the peak of the resonance, making the system unstable.
Open-loop phase (deg)
–180
–179.5
–179
–178.5
–178
Open-loop magnitude (dB)
–105
–100
–95
–90
–85
–80
–75
–70
–65
–60
–55
0.9
1
2
3
5
10
15
QFTCT
FIGURE CS1.4
QFT templates for p11(s).
Magnitude (dB)
–120
–100
–80
–60
–40
–20
10–1
100
101
102
Phase (deg)
–180
–135
–90
–45
0
Bode diagram
Frequency (rad/s)
p11-4(s)
p11-1(s)
p11-2(s)
p11-3(s)
–180
–135
–90
–45
0
–120
–100
–80
–60
–40
–20
0
20
 –120 dB
 –100 dB
 –80 dB
 –60 dB
 –40 dB
 –20 dB
 –12 dB
 –6 dB
 –3 dB
 –1 dB
 3 dB
 6 dB
Nichols chart
Open-loop phase (deg)
Open-loop gain (dB)
p11-4(s)
p11-3(s)
p11-1(s)
p11-2(s)
(a)
(b)
FIGURE CS1.5
Frequency-domain p11-i(s). (a) Bode diagram and (b) Nichols chart.

308
Case Study 1: Satellite Control
Similarly, Figure CS1.6 shows the Bode diagram of the plant p21_i(s) for the same four 
cases. This plant describes the effect of the torque command Tm on the solar panel dis­
placement yp. Again, the peak at ωn ∈ [4.42, 4.68] rad/s is the resonance mode of the solar 
panels.
CS1.4  Control Specifications
Taking into account the dynamics of the satellite and the operator objectives and limita­
tions, we define the following robust control specifications—with H(s) = 1:
•	 Type 1: Stability specification
	
T j
p
j
G j
p
j
G j
Ws
1
1
1
1 93
(
)
(
) (
)
(
) (
)
( )
0.001 0.
11
11
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
005 0.01 0.02 0.05 0.1 
0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 2 3 4 4.68 5 10 15 rad/s
]
	
(CS1.25)
	
which is equivalent to PM = 30.03°, GM = 3.63 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification—see Figure CS1.7a
	
T j
j
d j
p
j
G j
s a
s a
a
o
d
d
d
3
11
3
1
1
1
(
)
(
)
(
)
(
) (
)
( )
(
)
(
)
;
ω
θ ω
ω
ω
ω
δ ω
=
=
+
≤
=
+
/
/
=
∈
0 2
0 001 0 005 0 01 0 02 0 05 0 1
.
[ .
.
.
.
.
. ]
ω
 
 
 
 
 
rad/s
	
(CS1.26)
Magnitude (dB)
–100
–80
–60
–40
100
101
Phase (deg)
0
45
90
135
180
Bode diagram
Frequency (rad/s)
p21-4(s)
p21-3(s)
p21-2(s)
p21-1(s)
FIGURE CS1.6
Bode diagram of p21-i(s).

309
Case Study 1: Satellite Control
•	 Type 6: Reference tracking specification—see Figure CS1.7b
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6-
6-
( )
(
)
( )
lo
up
T j
F j
p
j
G j
p
j
G j
<
=
+
≤
∈
6
11
11
1
(
)
(
) (
)
(
) (
)
[0.001 0.005 0.01 0.02 0.05 0.1 
0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 rad/s
]
	
(CS1.27)
	
δ6
2
1
1
0 13
- ( )
/
lo
L
L
s
s a
a
=
+
[
]
=
(
)
;
.
	
(CS1.28)
	
δ
ω
ζ
ω
ζ
6
2
1
2
1
0 1
0 8
- ( )
/
/
/
up
U
n
n
U
s
s a
s
s
a
=
+
+
+


=
=
[(
)
]
(
)
(
)
;
. ;
. ;
ωn
U
a
= 1 25
.
ζ
	
(CS1.29)
•	 Type k1: External disturbances do(s) over yp(s) via p21(s) × G(s) and control loop
	
T
j
y
j
d j
p
j
G j
p
j
G j
k
p
o
k
1
21
11
1
1
0 2
(
)
(
)
(
)
(
) (
)
(
) (
)
( )
.
ω
ω
ω
ω
ω
ω
ω
δ
ω
=
=
+
≤
=
0
4 4 68 5
ω ∈[
.
]
 
 
rad/s
	
(CS1.30)
CS1.5  Controller Design
CS1.5.1  QFT-Bounds
The QFT-bounds integrate the dynamics of the plant, the model uncertainty, and the control 
specifications at each frequency of interest. Figure CS1.8a–d shows the bounds for stability, 
0
10
20
30
40
50
60
70
80
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
Magnitude (dB)
–25
–20
–15
–10
–5
0
Bode diagram
Frequency (rad/s)
10–2
10–1
100
δ6-lo(s)
δ6-up(s)
δ3(s)
(a)
(b)
FIGURE CS1.7
Control specifications for p11(s). (a) Sensitivity or disturbance rejection at the output of the plant: δ3. (b) Reference 
tracking: δ6-up, δ6-lo.

310
Case Study 1: Satellite Control
sensitivity, reference tracking, and solar panel vibration attenuation, respectively. Figure 
CS1.9 presents the intersection of all these bounds at each frequency. As we have a bound 
solution for each frequency, the selected control specifications for the satellite are compatible.
CS1.5.2  Loop-Shaping—G(s)
The design of the feedback controller G(s) is carried out on the Nichols chart (NC). It is 
done by adding poles and zeros until the nominal loop, defined as L0(jω) = p11,0(jω)G(jω), 
meets the QFT-bounds presented in Figure CS1.9.
We start the design of G(s) by adding a low frequency zero (z1 = 0.1) to move L0(s) from 
−180° line to the right, and pass the stability bounds through the right. Then, we increase 
the controller gain to k = 20. Afterward, to meet the dashed-line bound at 4.68 rad/s, we 
add a notch filter (s2 + 2 ζa ωn s + ωn
2)/(s2 + 2 ζb ωn s + ωn
2), with a natural frequency of 
ωn = 4.68 rad/s, a damping numerator coefficient of ζa = 0.07, and a damping denominator 
coefficient of ζb = 1.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
5
10
15
20
25
30
35
40
45
50
QFTCT
0.02
0.05
0.005
0.01
0.1
0.001
Open-loop phase (deg)
Open-loop magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
QFTCT
5
4.68
4
–350
–300
–250
–200
–150
–100
–50
0
Open-loop phase (deg)
–220–200–180–160–140–120–100 –80 –60 –40
Open-loop magnitude (dB)
–10
–5
0
5
10
15
20
25
30
35
40
QFTCT
(b)
(a)
(d)
(c)
4.68
0.5
4
10
15
3
Open-loop magnitude (dB)
–10
0
10
20
30
40
50
60
70
80
QFTCT
0.001
0.005
0.02
0.2
0.1
0.05
0.01
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
From 0.001 to 2
FIGURE CS1.8
(a) Stability bounds, (b) sensitivity bounds, (c) reference tracking bounds, and (d) solar panel vibration attenu­
ation bounds.

311
Case Study 1: Satellite Control
This gives a depth of 20 × log10(ζa/ζb) dB = –23.1 dB, which is enough to place L0(4.68) 
below the B(4.68) dashed-line bound. Finally, we add two additional poles at a higher fre­
quency (p1 = p2 = 1), to filter out high frequency noise. The final controller G(s) is shown in 
Equation CS1.31 and the loop-shaping in Figure CS1.10.
	
G s
s
s
s
s
s
s
( )
/
=
+
(
)
+
+
+
+
+
20
0 1
1
1
3 066
21 9
43 80
21 9
2
2
2
(
. )
(
)
(
.
. )
(
.
. ) 	
(CS1.31)
CS1.5.3  Prefilter Design—F(s)
Taking into account the controller G(s) defined in Equation CS1.31, the reference track­
ing specifications presented in Equations CS1.27 through CS1.29, and the plant model 
described in Equation CS1.20, we design a prefilter F(s) to assure that all the input/output 
functions p11(s)G(s)F(s)/[1 + p11(s)G(s)] from low frequencies to 1 rad/s (which is before the 
flexible mode) are inside the band defined by the limits δ6-up(ω) and δ6-lo(ω). The prefilter 
is shown in Equation CS1.32, and the input/output functions and limits in Figure CS1.11.
	
F s
s
s
( )
/
/
=
+
(
)
+
(
)
(
. )
(
. )
0 5
1
0 1
1 	
(CS1.32)
CS1.6  Analysis and Validation
The analysis of the closed-loop stability in the frequency domain is shown in Figure 
CS1.12a. The dashed-line is the stability specification Ws, defined in Equation CS1.25. 
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–80
–60
–40
–20
0
20
40
60
80
QFTCT
0.01
0.02
0.05
4
4.68
5
0.1
0.2 to 3 and 10, 15
0.005
0.001
FIGURE CS1.9
QFT-bounds. Intersection of bounds.

312
Case Study 1: Satellite Control
The solid-line represents the worst case of all the possible functions p11G/(1 + p11G) at 
each frequency and due to the model uncertainty. The control system meets the stabil­
ity specification (the solid-line is below the dashed-line Ws) for all the plants within the 
uncertainty.
Frequency (rad/s)
10–3
10–2
10–1
100
101
Magnitude (dB)
–100
–80
–60
–40
–20
0
20
QFTCT
P G F/(1 + P G)
δ6-lo
δ6-up
FIGURE CS1.11
Prefilter F(s) for reference tracking specs: δ6-lo(ω) ≤ |T6| ≤ δ6-up(ω).
Open-loop phase (deg)
–300
–250
–200
–150
–100
Open-loop gain (dB)
–100
–80
–60
–40
–20
0
20
40
60
80
QFTCT
0.001
0.005
0.05 0.1
0.2
0.9
1
0.8
2
3
15
10
4
4.68
0.6
0.5
0.3
5
L0(s)
0.01
0.02
0.7
0.4
FIGURE CS1.10
QFT-bounds and G(s) design—loop-shaping.

313
Case Study 1: Satellite Control
The analysis of the robust sensitivity specification, or rejection of disturbances at the 
output of the plant, is shown in Figure CS1.12b. The dashed-line is the sensitivity specifi­
cation δ3(ω), defined in Equation CS1.26. The solid-line represents the worst case of all the 
possible functions 1/(1 + p11G) at each frequency and due to the model uncertainty. The 
control system meets the sensitivity specification in all cases (the solid-line is below the 
dashed-line δ3) from 0 to 0.1 rad/s.
The panel vibration analysis in the frequency domain is shown in Figure CS1.12c. It 
represents the attenuation of the effect of disturbances do(s) over the panel movement yp(s) 
through p21(s) × G(s) and the control loop—see also Figure CS1.3. The dashed-line is the 
specification δk1(ω) defined in Equation CS1.30. The solid-line represents the worst case of 
all the possible functions p21G/(1 + p11G) at each frequency due to the model uncertainty. 
Magnitude (dB)
–80
–70
–60
–50
–40
–30
–20
–10
0
10
0.001
0.005
0.01
0.02 0.05
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
2
3
4
15
10
4.68
5
QFTCT
(a)
(b)
(c)
Ws
Worst cases of
“p11G/(1+p11G)”
Frequency (rad/s)
10–3
10–2
10–1
100
101
Magnitude (dB)
–90
–80
–70
–60
–50
–40
–30
–20
–10
0
10
0.001
0.005
0.01
0.02
0.05
0.1
QFTCT
Worst cases of
“1/(1+p11G)”
Frequency (rad/s)
10–3
10–2
10–1
100
101
δ3
Magnitude (dB)
–120
–100
–80
–60
–40
–20
4
4.68
5
QFTCT
Worst cases of
“p21G/(1+p11G)”
Frequency (rad/s)
100
101
δk1
FIGURE CS1.12
Frequency-domain analysis: (a) stability, (b) sensitivity or disturbance rejection at plant output, and (c) panel 
vibration attenuation.

314
Case Study 1: Satellite Control
Once more, the control system meets the specification in all cases (solid-line is below 
dashed-line δk1).
The time-domain analysis of the reference tracking specification is shown in Figure 
CS1.13a. The figure shows the limits δ6-up(ω) and δ6-lo(ω)—see Equations CS1.29 and CS1.28, 
and the time responses of the angle θ(t) to a unitary step reference r(t). We simulate 200 
cases of the closed-loop transfer function p11GF/(1 + p11G)—see Figure CS1.3 with H(s) = 1. 
The control system meets the specification (is between the upper and lower limits) in all 
cases.
In addition, the time-domain analysis of the sensitivity is shown in Figure CS1.13b. The 
figure presents the time responses of the angle θ(t) to a unitary step disturbance do(t)—see 
also Figure CS1.3 with H(s) = 1. We simulate 200 cases of 1/(1 + p11G). The control system 
achieves a good disturbance rejection in all cases.
In addition, Figure CS1.14 shows the solar panels oscillation when a unitary step distur­
bance input do(s) is introduced into the system. The disturbance do(s) enters at the output of 
the plant p11(s), travels the control loop until Tm(s), and finally goes through p21(s) to yp(s)— 
see the block diagram in Figure CS1.3. We study two cases. The first one, represented in 
Figure CS1.14a, uses the complete controller G(s) described in Equation CS1.31. The second 
case, represented in Figure CS1.14b, uses this controller without the notch filter.
The solar panels oscillation is significantly reduced when we add this notch filter in 
the feedback controller G(s), that is, the complete Equation CS1.31. Figure CS1.14a shows 
the yp(t) results with the complete G(s), and Figure CS1.14b without the notch filter. Both 
analysis are performed for the same cases within the plant uncertainty. The figures have 
the same scale.
Finally, Figure CS1.15 zooms in one case of the simulations of Figure CS1.14a and b. As 
we can see, the frequency of the oscillation in the figure (15 peaks in 20 s) is the natural 
frequency of the solar panel oscillation: 0.75 Hz (4.68 rad/s). The results of the complete 
controller G(s) with the notch filter are represented by the solid-line—Equation CS1.31, 
and the results without the notch filter by the dashed-line. As anticipated, the complete 
Time (s)
0
5
10
15
20
25
30
35
40
45
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
QFTCT
Time (s)
0
10
20
30
40
50
60
70
80
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
(a)
(b)
δ6-lo
δ6-up
FIGURE CS1.13
Time-domain analysis. (a) Reference tracking: δ6-lo and δ6-up specs, and θ(t) of 200 cases of p11GF/(1 + p11G) to a 
unitary step reference r(t). (b) Sensitivity: θ(t) of 200 cases of 1/(1 + p11G) to a unitary step disturbance do(t).

315
Case Study 1: Satellite Control
Time (s)
0
10
20
30
40
50
60
70
80
90 100
–0.03
–0.025
–0.02
–0.015
–0.01
–0.005
0
0.005
0.01
0.015
0.02
QFTCT
Time (s)
0
10
20
30
40
50
60
70
80
90 100
–0.03
–0.025
–0.02
–0.015
–0.01
–0.005
0
0.005
0.01
0.015
0.02
QFTCT
(a)
(b)
FIGURE CS1.14
Solar panels oscillation yb(t). Simulation of 25 plants. (a) G(s) with the notch filter—see Equation CS1.31. (b) G(s) 
without the notch filter.
Time (s)
0
5
10
15
20
25
30
–0.025
–0.02
–0.015
–0.01
–0.005
0
0.005
0.01
0.015
0.02
QFTCT
Case G without notch ﬁlter
Case G with notch ﬁlter
Solar panel natural frequency
 ~0.75 Hz = ~15 peaks in 20 s
FIGURE CS1.15
Zooming in. Solar panel oscillation yb(t). G(s) with notch filter (solid-line), and without notch filter (dashed-line).

316
Case Study 1: Satellite Control
controller G(s) with the notch filter obtains a much better peak to peak reduction of the 
solar panels vibration.
CS1.7  Summary
This case study has successfully designed a robust QFT Attitude Control System for a sat­
ellite with flexible solar panels. The design considers the model uncertainty introduced by 
the fuel consumption and the imprecise knowledge of the damping coefficients. It accom­
plishes four simultaneous control objectives:
•	 Stability
•	 Reference tracking and regulation of the satellite angle
•	 Rejection of unpredictable disturbances
•	 Minimization of the solar panel vibrations

317
Case Study 2: Wind Turbine Control
CS2.1  Description
Wind turbines are complex systems with large and flexible structures that work under 
unpredictable environmental conditions and a variable electrical grid. The efficiency and 
reliability of a wind turbine depend on how the control system deals with the nonlin­
ear characteristics, high model uncertainty, stability limitations, energy capture maximi­
zation, and load and mechanical fatigue reduction. These objectives require the control 
system to coordinate numerous variables in real time, including the blade pitch angles, 
torques, active and reactive powers, rotor speed, yaw orientation, temperatures, currents, 
voltages, and power factors.
This case study presents the design of a pitch control system to regulate the rotor 
speed of a variable-speed pitch-controlled wind turbine in Region 3 (above-rated region, 
12 < wind speed < 17 m/s, see Figure CS2.19), while attenuating simultaneously the 
tower and blades vibration. The machine is composed of a gearless drive-train, a multi-
pole synchronous generator, and a full-power converter. It is also called a Type-4 wind 
turbine. As an example, Figure CS2.1 shows a picture of the first prototype of the TWT-
1.65, a 1.65 MW Type-4 wind turbine designed by the author and the MTOI team in the 
period 1998–2011.
The four objectives pursued in this case study are: (1) to control the rotor speed Ωr by 
pitching simultaneously the angles β of the turbine blades—also called collective pitch, 
(2) to reject the effect of unpredictable wind disturbances, (3) to minimize the tower fore-
aft oscillations, and (4) to attenuate the blades flap-wise vibrations.
For these objectives, we propose a classical 2DOF control system that includes a feedback 
compensator G(s) and a prefilter F(s), as shown in Figure CS2.5. In the following sections 
we model and analyze the dynamics of the wind turbine, propose a set of stability and 
performance specifications, design the controllers, and validate them in both frequency 
and time domains.
CS2.2  Plant Model
Figure CS2.2 shows the model diagram for the Type-4 wind turbine. The model consid­
ers four degrees of freedom: the rotor rotation θr(t), the generator rotation θg(t), the flap-
wise blade bending yb(t), and the fore-aft tower bending yt(t). The main variables and 
­parameters of the system are the following:

318
Case Study 2: Wind Turbine Control
Inputs
•	 v1 undisturbed upstream wind speed, [m/s]
•	 FT thrust force applied by the wind on the rotor, [N]
•	 Ta aerodynamic torque applied by the wind on the rotor, [Nm]
•	 Tg antagonistic electrical torque applied by the rectifier/generator, [Nm]
•	 β pitch angle of the blades, [rad]
FIGURE CS2.1
TWT-1.65 variable-speed pitch-controlled wind turbine, MTOI, 2001.
Ks
Bs
θg
θr
β
β
Jg
Tg
Kb
Bb
Bb
Kb
Kt
Bt
Jr
yt
mb
mb
mn
mt
Ta
rb
FT
rp
Shaft
Generator
Transformer
Full-power
converter
Rotor excitation
Grid
Nacelle
Blade
Tower
Foundation
Wind
P, Q
DC
Rotor
mh
Hub
ν1
yb
yb
FIGURE CS2.2
Variable-speed pitch-controlled gearless wind turbine with full-power converter (Type-4 wind turbine). 
Model description.

319
Case Study 2: Wind Turbine Control
•	 Tgd desired electrical torque, output of torque controller, [Nm]
•	 βd desired pitch angle, output of pitch controller, [rad]
Outputs
•	 yt fore-aft displacement of the tower at the nacelle level, [m]
•	 yb flap-wise displacement of the tip of the blade, [m]
•	 θr rotor angular position, [rad]
•	 θg generator angular position, [rad]
•	 Ω
θ
r
r
=   rotor angular speed, [rad/s]
•	 Ωg
g
= θ  generator angular speed, [rad/s]
•	 P active power at the output of the inverter, [W]
•	 Q reactive power at the output of the inverter, [VA]
Parameters
•	 ρ density of the air, [kg/m3]
•	 N number of blades, [−]
•	 rb radius of the blade, [m]
•	 rp distance from the center of the rotor to the center of pressure, or point where the 
equivalent lumped force FT is applied. rp = (2/3) rb, [m]
•	 Jg moment of inertia of the generator, at Ωg, [kg m2]
•	 Jh moment of inertia of the hub, at Ωr, [kg m2]
•	 Jb moment of inertia of one blade, about root, at Ωr, [kg m2]
•	 Jr = Jh + N Jb, moment of inertia of the rotor, at Ωr, [kg m2]
•	 mb mass of one blade, [kg]
•	 mh mass of the hub, [kg]
•	 mn mass of the nacelle, [kg]
•	 mt mass of the tower, [kg]
•	 Kt tower translational fore-aft stiffness coefficient, [N/m]
•	 Bt tower translational fore-aft damping coefficient, [Ns/m]
•	 Kb blade translational flap-wise stiffness coefficient, [N/m]
•	 Bb blade translational flap-wise damping coefficient, [Ns/m]
•	 Ks shaft torsional stiffness coefficient, [Nm]
•	 Bs shaft torsional damping coefficient, [Nms]
•	 m1 = mn + mh + (1/3)mt + Nmb. Equivalent mass at the tip of the tower, for fore-aft 
yt movement, [kg]
•	 m
J
r
b
b
2
2
=
/
. Equivalent mass at the tip of the blade, for flap-wise yb movement, [kg]
As in case study CS1, we start with the general equation of motion for the mechanical 
system, which is
	
M
C
K
Q



q
q
q
q q u
+
+
=
( , , , )t 	
(CS2.1)

320
Case Study 2: Wind Turbine Control
where M C,
K
,
and
 are the Mass, Damping, and Stiffness matrices, Q the matrix of inputs, 
q the vector of generalized coordinates, and u the vector of inputs. Also, we consider the 
general form of the Euler–Lagrange equation,
	
d
dt
L
q
L
q
D
q
Q i
n
L
E
E
i
i
d
i
i
k
p
∂
∂





−∂
∂
+ ∂
∂
=
=
=
−


…
,
, ,
,
1 2
and
	
(CS2.2)
where qi are the generalized coordinates or degrees of freedom of the system, Qi the gen­
eralized forces applied to each subsystem “i,” Ek the kinetic energy, Ep the potential energy, 
Dd the dissipator co-content, and L the Lagrangian.236
The generalized coordinates for the wind turbine are the linear displacement of the tower 
yt(t), the linear displacement of the blades yb(t), the rotor angle θr(t) and the generator angle 
θg(t), which are respectively: q1 = yt(t), q2 = yb(t), q3 = θr(t), and q4 = θg(t)—see Figure CS2.2. The 
system contains the kinetic, potential, and dissipative functions described by Equations CS2.3 
through CS2.5. Notice that we consider linear dissipators, which means that the Dd expression 
or dissipator co-content equals one-half of the power being absorbed by the dissipators.236
	
E
m y
N m y
y
J
J
k
t
t
b
r
r
g
g
=
+
+
+
+
1
2
1
2
1
2
1
2
1
2
2
2
2
2





(
)
θ
θ
	
(CS2.3)
	
E
K y
N K y
K
p
t
t
b
b
s
r
g
=
+
+
−
1
2
1
2
1
2
2
2
2
(
)
θ
θ
	
(CS2.4)
	
D
B y
N B y
B
d
t
t
b
b
s
r
g
=
+
+
−
1
2
1
2
1
2
2
2
2




(
)
θ
θ
	
(CS2.5)
The generalized forces applied to the wind turbine are the thrust force FT(t) and aero­
dynamic torque Ta(t), both applied by the wind to the rotor, and the antagonistic ­electrical 
torque Tg(t), applied by the power electronics and electrical generator. Now, using Equations 
CS2.3 through CS2.5, the terms for the Euler–Lagrange equation are
	
d
dt
L
q
d
dt
E
y
E
y
E
E
i
k
t
k
b
k
r
k
g
∂
∂





=
∂
∂
∂
∂
∂
∂
∂
∂








θ
θ




=
+


m
N m
N m
N m
N m
J
J
r
g
1
2
2
2
2
0
0
0
0
0
0
0
0
0
0










=





y
y
t
b
r
g
θ
θ
M q
	
(CS2.6)
	
−∂
∂
= ∂
∂
=
∂
∂
∂
∂
∂
∂
∂
∂






L
q
E
q
E
y
E
y
E
E
i
p
i
p
t
p
b
p
r
p
g
θ
θ

=
−
−






K
NK
K
K
K
K
y
y
t
b
s
s
s
s
t
b
r
0
0
0
0
0
0
0
0
0
0
θ
θg






= K q
	
(CS2.7)

321
Case Study 2: Wind Turbine Control
	
∂
∂
=
∂
∂
∂
∂
∂
∂
∂
∂






D
q
D
y
D
y
D
D
d
i
d
t
d
b
d
r
d
g





θ
θ

=
−
−






B
NB
B
B
B
B
y
t
b
s
s
s
s
t
0
0
0
0
0
0
0
0
0
0





yb
r
g
θ
θ






= C q
	
(CS2.8)
	
Q
R
=
−












=
1
0
0
1
0
0
0
1
0
0
0
1
F
T
T
T
a
g
u
	
(CS2.9)
Rearranging the equation of motion Equation CS2.1 as
	


q
q
q
u
=−
−
+
−
−
−
M
C
M
K
M
R
1
1
1
	
(CS2.10)
and applying Equations CS2.6 through CS2.9, we find a state space description of the 
­system (
;
)
x
Ax
Bu y
Cx
=
+
=
 with the expressions,
	
x
I
0
x
0
u
y
I 0 x
=
−
−






+






=
|
−
−
−
M
C
M
K
M
R
1
1
1
[
]
	
(CS2.11)
with I = [1 0 0 0; 0 1 0 0; 0 0 1 0; 0 0 0 1], 0 = [0 0 0 0; 0 0 0 0; 0 0 0 ; 0 0 0 0], and,
	
A =
−
−
−
+
−
+
B
m
N B
m
K
m
N K
m
B
m
B m
N m
m
K
m
K m
t
b
t
b
t
b
t
b
m
1
1
1
1
1
1
2
1
2
1
1
0
0
0
0
0
0
(
)
(
N m
m
B
J
B
J
K
J
K
J
B
J
B
J
K
J
K
J
m
s
r
s
r
s
r
s
r
s
g
s
g
s
g
s
g
2
1
2
0
0
0
0
0
0
0
0
0
0
1
0
0
)
−
−
−
−
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
1
0
0
0
0







(CS2.12)

322
Case Study 2: Wind Turbine Control
	
B =
+
−
−



0
0
0
1
0
0
0
1
0
0
0
1
0
0
0
0
0
0
0
0
0
0
0
0
1
2
1
2
1
m
N m
N m m
m
J
J
r
g



	
(CS2.13)
	
C =






1
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
1
0
0
0
0 	
(CS2.14)
	
x
q
q
=





=





[
]
y
y
y
y
t
b
r
g
t
b
r
g
T
θ
θ
θ
θ
	
(CS2.15)
	
u = [
]
F
T
T
T
a
g
T
	
(CS2.16)
	
y = [
]




y
y
t
b
r
g
T
θ
θ
	
(CS2.17)
The thrust force FT and aerodynamic torque Ta applied by the wind to the rotor are pro­
portional to the rotor area (
)
πrb
2 , the density of the air ρ, and the square and cubic of the 
wind velocity v1, respectively, as described by Equations CS2.18 and CS2.19, so that
	
F
r C
v
T
b
T
= 1
2
2
1
2
ρπ
λ β
( , )
	
(CS2.18)
	
T
r C
v
a
b
P
r
= ρπ
λ β
Ω
2
1
3
2
( , )
	
(CS2.19)
where Cp is the power coefficient and CT the torque coefficient. Both coefficients are a 
nonlinear function of the tip-speed ratio λ = Ωrrp/v1 and the pitch angle β, as shown in 
Figure CS2.3. For more information see the author’s book, Wind Energy Systems: Control 
Engineering Design, Reference 7.
According to these expressions and the characteristics of Cp and CT, the inputs FT and 
Ta of Equation CS2.16 depend on v1, β, and Ωr in a nonlinear way. Notice that Ω
θ
r
r
=  . Now, 
linearizing these equations around a working point (v10, β0, Ωr0), and ignoring the bias 

323
Case Study 2: Wind Turbine Control
components, the inputs FT and Ta are described by a transfer matrix whose elements are 
just gains, so that
	
F s
T s
K
K
K
K
K
K
s
v s
s
T
a
F
FV
F
T
TV
T
r
( )
( )
( )
( )
(





=






Ω
Ω
Ω
β
β
β
1
)





	
(CS2.20)
where the gains are calculated by using the CT and Cp curves (Figure CS2.3) and Equations 
CS2.18 and CS2.19, so that
	
K
F t
t
r
C
v
F
T
r
b
T
r
Ω
Ω
ρπ
Ω
= ∂
∂
=
∂
∂
( )
( ) 0
2
0
10
2
1
2
	
(CS2.21)
	
K
F t
v t
r
C
v
v
v C
FV
T
b
T
T
= ∂
∂
=
∂
∂
+






( )
( )
1
0
2
1 0
10
2
10
0
1
2
2
ρπ
	
(CS2.22)
	
K
F t
t
r
C
v
F
T
b
T
β = ∂
∂
=
∂
∂
( )
( )
β
ρπ
β
0
2
0
10
2
1
2
	
(CS2.23)
	
K
T t
t
r
C
C
T
a
r
b
p
r
r
p
r
Ω
Ω
ρπ
Ω
Ω
Ω
= ∂
∂
=
∂
∂
−






( )
( ) 0
2
0
0
0
0
2
1
2
1
1
v10
3
	
(CS2.24)
	
K
T t
v t
r
C
v
v
C v
TV
a
b
r
p
p
= ∂
∂
=
∂
∂
+






( )
( )
1
0
2
0
1 0
10
3
0
10
2
1
2
1
3
ρπ
Ω
	
(CS2.25)
0
2
0
0.05
0.1
0.15
0.2
Cp
0.25
0.3
Region 3
12 to 17 m/s
working points
Pitch angle β
increase
β = 3°
β = 2°
0.35
0.4
0.45
0.5
4
6
Tip-speed ratio
β = 22°
β = 0°
β = 1°
8
10
12
14
16
FIGURE CS2.3
Cp/λ curves for pitch angles 0° ≤ β ≤ 22° and working points.

324
Case Study 2: Wind Turbine Control
	
K
T t
t
r
C
v
T
a
b
r
p
β
β
ρπ
Ω
β
= ∂
∂
=
∂
∂
( )
( ) 0
2
0
0
10
3
1
2
1
	
(CS2.26)
Then, adding the electrical torque, we have
	
M
R
−






=






=
1
0
u
B
B
F s
T s
T s
K
K
K
T
a
g
F
FV
F
( )
( )
( )
Ω
β
0
0
0
0
0
1
1
K
K
K
s
v s
s
T s
T
TV
T
r
g
Ω
β
Ω
β









( )
( )
( )
( )


	
(CS2.27)
On the other hand, the transfer functions of the actuators are
	
β
β
β
( )
( )
( )
s
A s
s
d
=
	
(CS2.28)
	
T s
A
s T
s
g
T
gd
( )
( )
( )
=
	
(CS2.29)
where βd is the demanded blade pitch angle and Tgd the demanded electrical torque, both 
calculated by the control system, and where Aβ(s) and AT(s) are the transfer functions from 
the control signals (βd, Tgd) to the actual value of the actuators (β, Tg). Using these expres­
sions with Equation CS2.27, we have
	
M
R
−






=


1
0
u
B
K
K
K
A s
K
K
K
A s
A
s
F
FV
F
T
TV
T
T
Ω
β
β
Ω
β
β
( )
( )
( )
0
0
0
0
0










=
Ωr
d
gd
K
r
s
v s
s
T
s
( )
( )
( )
( )
(
1
β
Ω
B
s
v s
s
T
s
d
gd
)
( )
( )
( )
1
β





	
(CS2.30)
Now, putting all the Ω
θ
r
r
=   variables together, that is, adding the first column of BK to 
the third column of A {i.e., A(1:8,3) = A(1:8,3) + BK(1:8,1)}, and removing it from BK, {i.e., 
BK(:,1) = []}, the new vector of inputs is
	
u = [
]
v
T
d
gd
T
1
β
	
(CS2.31)
and applying P
C I
A
B
( )
(
)
s
s
K
=
−
−1
 for y
P
u
( )
( ) ( )
s
s
s
=
, the transfer matrix from the three 
independent inputs to the four outputs is
	


y s
y s
s
s
s
v s
s
t
b
r
g
d
( )
( )
( )
( )
( )
( )
( )
Ω
Ω






=
×
P4 3
1
β
TT
s
gd( )






	
(CS2.32)
The third row of P4×3(s) contains the transfer functions of the rotor speed Ωr(s) from the 
wind speed v1(s), the demanded blade pitch angle βd(s), and the demanded electrical torque 
Tgd(s), respectively, so that

325
Case Study 2: Wind Turbine Control
	
Ω
β
r
d
gd
s
p
s v s
p
s
s
p
s T
s
( )
( ) ( )
( )
( )
( )
( )
=
+
+
31
1
32
33
	
(CS2.33)
with
	
p
s
J s
B s
K
K
s
g
s
s
TV
31
2
( )
( )
=
+
+
(
)
∆
	
(CS2.34)
	
p
s
J s
B s
K
K
A s
s
g
s
s
T
32
2
( )
( )
( )
=
+
+
(
)
β
β
∆
	
(CS2.35)
	
p
s
B s
K A
s
s
s
s
T
33( )
(
)
( )
( )
= −
+
∆
	
(CS2.36)
	
∆
Ω
Ω
Ω
( )
(
)
(
)
s
J J s
B J
B J
J K
s
J K
B K
J K s
K
K
g r
s g
s r
g
T
g
s
s
T
r
s
T
s
=
+
+
−
+
−
+
−
3
2
	
(CS2.37)
Figure CS2.4 shows graphically the rotor speed signal Ωr(s) as a function of the wind 
speed v1(s), the demanded blade pitch angle βd(s), and the demanded electrical torque Tgd(s) 
according to Equations CS2.33 through CS2.37. In addition, Figure CS2.5 shows the com­
plete block diagram representation of Equation CS2.32 and the rotor speed/pitch control 
system, with the feedback controller G(s) and the prefilter F(s) to be designed in the next 
sections.
CS2.2.1  Parametric Uncertainty
The parameters for the model of the wind turbine considered in this case study are shown 
in Table CS2.1. They are taken from the NREL 5-MW baseline wind turbine described in 
Reference 364, and from the author’s book, Reference 7.
NOTE: the parameters KTΩ, KTV, and KTβ have been calculated from Figure CS2.3 and accord­
ing to Equations CS2.20 through CS2.26, and for a scenario of wind velocity between 12 
and 17 m/s. See Figure CS2.19 and Reference 7 for more details.
+
KTV
KTβ
Aβ(s)
AT(s)
Tgd(s)
βd(s)
v1(s)
β(s)
Tg(s)
Ωr(s)
∆(s)
(Jgs2 + Bss + Ks)
[–(Bss + Ks)]
1
KTΩ
+
+
+
Depending on
working point (v10, β0, Ωr0)
FIGURE CS2.4
Rotor speed linear transfer functions, p31(s), p32(s), p33(s), from the wind speed, demanded pitch angle, and 
­electrical torque, respectively. The parameters KTV, KTβ, and KTΩ have uncertainty to absorb the nonlinear 
characteristics.

326
Case Study 2: Wind Turbine Control
The wind turbine studied here presents three flexible modes: one for the shaft tor­
sion, another for the tower fore-aft movement, and another for the blade flap-wise 
movement.  These displacements are described in Figure CS2.2. Using the param­
eters of Table  CS2.1, the natural frequency and damping coefficients of these three 
movements are
	
ω
ζ
n shaft
s
g
shaft
s
s g
K
J
B
K J
.
.
( .
),
.
=
=
=
=
3 8987
0 6205
2
0 1586
rad/s
Hz
	
+
r(s)
F(s)
G(s)
H(s)
n(s)
–
v1(s)
v1(s)
v1(s)
Tgd(s)
Tgd(s)
Tgd(s)
βd(s)
βd(s)
βd(s)
+
+
.
+
yb(s)
.yt(s)
+
+
+
Ωr(s)
Ωg(s)
+
+
+
+
+
p11(s)
p21(s)
p22(s)
p23(s)
p41(s)
p42(s)
p43(s)
p12(s)
p13(s)
p31(s)
p32(s)
p33(s)
+
+
+
Pitch control
Torque
control
do(s)
FIGURE CS2.5
Complete block diagram representation of Equation CS2.32 and wind turbine rotor speed/pitch control system.
TABLE CS2.1
Wind Turbine Parameters
Power to the grid [W]—rated
5.0 × 106
ρ (air) [kg/m3]
1.225
Efficiency shaft and generator
94.5%
Efficiency converter
98.5%
Tg.max to generator [Nm]—rated
400,6111
h [m]—tower height
87.6
Ωr_nom [rad/s]
1.2671
N (number of blades)
3
rb (blade radius) [m]
61.5
rp [m]
41
Jg [kg m2]—generator
5,025,497
Jh [kg m2]—hub
115,926
Jb [kg m2]—one blade
11,776,047
Jr [kg m2]—rotor
35,444,067
mb [kg]—one blade
17,740
mh [kg]—hub
56,780
mn [kg]—nacelle
240,000
mt [kg]—tower
347,460
m1 [kg] = mn + mh + (1/3)mt + Nmb
465,820
m
J
r
b
p
2
2
[
]
kg
/
=
3113.5
Ks [Nm]—shaft
76,387,512
Bs [Nms]—shaft
6,215,000
Kt [N/m]—tower
1,930,491
Bt [Ns/m]—tower
18,965
Kb [N/m]—one blade
54,586
Bb [Ns/m]—one blade
124.5
KTβ min [Nm/deg]
−4.1439 × 105
KTβ max [Nm/deg]
−2.7894 × 104
KTΩ min [Nm/(rad/s)]
−3.3095 × 106
KTΩ max [Nm/(rad/s)]
−8.8646 × 105
KTV min [Nm/(m/s)]
5.0115 × 105
KTV max [Nm/(m/s)]
6.1698 × 105
Aβ(s)
1.0
AT(s)
1.0

327
Case Study 2: Wind Turbine Control
	
ω
ζ
n tower fore aft
t
tower fore a
K
m
.
.
.
.
.
.
( .
),
=
=
1
2 0358
0 3240
rad/s
Hz
ft
t
t
B
K m
=
=
2
0 01
1
.
	
	
ω
ζ
n blade flapwise
b
blade flapwi
K
m
.
.
.
.
( .
),
=
=
2
4 1871
0 6664
rad/s
Hz
se
b
b
B
K m
=
=
2
0 004775
2
.
	
This leads to the following expressions:
	
Ωr s
v s
p
s
s
s
K
( )
( )
( )
( .
,
,
.
)
1
31
6
2
7
5 025497
10
6 215 000
7 63875
10
=
=
×
+
+
×
TV
T
s
K
s
1 78124
10
2 51518
10
5 025497
10
3 0
14
3
14
6
2
.
( .
.
)
( .
×
+
×
−
×
+
+
Ω

 
9137
10
6 215 000
7 63875
10
15
7
×
−
−
×
,
,
)
( .
)
K
s
K
T
T
Ω
Ω
	
(CS2.38)
	
Ω
β
r
d
s
s
p
s
s
s
K
( )
( )
( )
( .
,
,
.
)
=
=
×
+
+
×
32
6
2
7
5 025497
10
6 215 000
7 63875
10
T
T
s
K
s
β
1 78124
10
2 51518
10
5 025497
10
3 0
14
3
14
6
2
.
( .
.
)
( .
×
+
×
−
×
+
+
Ω

 
9137
10
6 215 000
7 63875
10
15
7
×
−
−
×
,
,
)
( .
)
K
s
K
T
T
Ω
Ω
	
(CS2.39)
Open-loop phase (deg)
–270
–260
–250
–240
–230
–220
–210
–200
–190
–180
–170
Open-loop magnitude (dB)
–100
–80
–60
–40
–20
0
0.001
0.005
0.01
0.05
0.1
0.5
1
2.04
3
4.19
5
10
50
100
QFTCT
FIGURE CS2.6
QFT templates for p32(s).

328
Case Study 2: Wind Turbine Control
with the parametric uncertainty in the aerodynamic coefficients,
KTβ ∈ [−41.439, −2.7894] × 104 Nm/deg,
KTΩ ∈ [−33.095, −8.8646] × 105 Nm/(rad/s),
KTV ∈ [5.0115, 6.1698] × 105 Nm/(m/s).
CS2.2.2  Frequencies
Figures CS2.7 and CS2.8 show the Bode diagrams for the transfer functions p32(s), p12(s), 
and p22(s). We select the array of frequencies of interest based on this information—see 
Equation CS2.40. Notice that we include frequencies that represent the resonances (peaks) 
that appear in the diagrams, and which represent the flexible modes of the wind turbine 
for shaft torsion, and tower fore-aft and blade flap-wise displacements.
	
ω = [ .
.
.
.
.
.
.
.
]
0 001
0 005
0 01
0 05
0 1
0 5
1
2 04
3
4 19
5
10
50
100  rad/s

(CS2.40)
Magnitude (dB)
–60
–40
–20
10–3
10–2
10–1
101
100
Phase (deg)
90
135
180
Bode diagram
(a)
(b)
Frequency (rad/s)
p32-0(s)
90
135
180
225
–70
–60
–50
–40
–30
–20
–10
0
10
3 dB
6 dB
Nichols chart
Open-loop phase (deg)
Open-loop gain (dB)
p32-1(s)
p32-1(s)
p32-1(s)
p32-0(s)
p32-0(s)
FIGURE CS2.7
p32-0(s) and p32-1(s). (a) Bode diagram and (b) Nichols chart. See shaft resonant mode at ωn.shaft = 3.90 rad/s.
Magnitude (dB)
–100
–80
–60
–40
–20
100
101
Phase (deg)
–180
–90
0
90
180
Bode diagram
(a)
(b)
Bode diagram
Frequency (rad/s)
100
101
Frequency (rad/s)
p12-0(s)
Magnitude (dB)
–60
–40
–20
0
20
Phase (deg)
0
45
90
135
180
p12-1(s)
p12-1(s)
p12-0(s)
p22-0(s)
p22-0(s)
p22-1(s)
p22-1(s)
FIGURE CS2.8
Bode diagrams of (a) p12-0(s) and p12-1(s), (b) p22-0(s), and p22-1(s). See tower and blade modes at ωn.tower = 2.04 rad/s 
and ωn.blade = 4.19 rad/s.

329
Case Study 2: Wind Turbine Control
CS2.2.3  Nominal Plant
Equations CS2.41 and CS2.42 represent the nominal plants p32-0(s) and p31-0(s), respectively. 
They are based on the following selection of parameters within the uncertainty:
KTβ0 = −41.439 × 104 Nm/deg,
KTΩ0 = –33.095 × 105 Nm/(rad/s), and
KTV0 = 5.0115 × 105 Nm/(m/s), resulting the next transfer functions
	
Ωr s
v s
p
s
s
s
s
s
( )
( )
( )
.
.
.
.
.
1
0
31 0
2
3
2
0 01414
0 01749
0 2149
1 505
1
=
=
+
+
+
+ 7 47
1 419
.
.
s+
	
(CS2.41)
	
Ω
β
r
d
s
s
p
s
s
s
s
s
( )
( )
( )
.
.
.
.
,
0
32 0
2
3
2
0 01169
0 01446
0 1777
1 505
=
= −
−
−
+
+17 47
1 419
.
.
s+
	
(CS2.42)
CS2.2.4  QFT Templates
Figure CS2.6 shows the QFT templates for p32(s), which is the main plant of the control loop. 
They are calculated using the model and uncertainty defined after Equation CS2.39, and 
the array of frequencies of interest defined in Equation CS2.40.
CS2.3  Preliminary Analysis
Before starting the design of the controller, we conduct a brief preliminary analysis of 
the dynamics of the wind turbine. Figure CS2.7 shows the Bode diagram and the Nichols 
chart of p32(s) with two extreme cases within the uncertainty:
Case 0: p32,0(s). KTΩ = −33.095 × 105, KTβ = −41.439 × 104, KTV = 5.0115 × 105
Case 1: p32,1(s). KTΩ = −2.7894 × 105, KTβ = −8.8646 × 104, KTV = 6.1698 × 105
The plant p32(s) describes the effect of the pitch command βd on the rotor velocity Ωr. 
As we can see, the system has no integrators (system type 0) and has a negative gain. 
The uncertainty affects significantly the magnitude of the gain. It increases by a factor of 
2.5 as we go from case 0 (v1 = 12 m/s) to case 1 (v1 = 17 m/s). Numerically, dcgain ∈ [−0.125, 
−0.318]. This variation is due to the nonlinear changes of the aerodynamics between 12 
and 17 m/s, respectively.
In addition, there is a resonance mode at ω = 3.90 rad/s. This is represented by the peak 
in the Bode diagram and the loop in the Nichols chart. The damping coefficient is about 
ζ = 0.16. This resonance mode is a consequence of the shaft torsion. As a result, the band­
width of the control system will have to be below this resonance frequency to reduce the 
excitation of this shaft mode.
Furthermore, Figure CS2.8a shows the Bode diagram of the plant p12(s) for both cases, 
0 and 1. This plant describes the effect of the pitch command βd on the fore-aft tower 
­movement yt. The first peak in the Bode diagram, at ω = 2.04 rad/s, is the resonance mode 
related to the fore-aft tower movement, which is particularly undamped, with a damping 

330
Case Study 2: Wind Turbine Control
coefficient of about ζ = 0.01. The second peak, at ω = 4.19 rad/s, is the resonance mode 
related to the flap-wise blade movement. It is also extremely undamped, with a damping 
coefficient of about ζ = 0.004775.
Similarly, Figure CS2.8b shows the Bode diagram of the plant p22(s) for both cases, 0 and 
1. This plant describes the effect of the pitch command βd on the flap-wise blade displace­
ment yb. Again, the first peak, at ω = 2.04 rad/s, is the resonance mode of the tower, and the 
second peak, at ω = 4.19 rad/s, the resonance mode of the blade.
As we can see, both movements tower fore-aft and blade flap-wise are coupled. The two 
resonance modes appear in both transfer functions, p12(s) and p22(s), from the pitch com­
mand βd to the tower and blade movements, yt and yb, respectively. They are also much 
more severe than the shaft torsion mode. The bandwidth of the control system will have 
to be below these two resonance modes to reduce the movement of the tower and blades 
at these frequencies.
CS2.4  Control Specifications
Taking into account the dynamics of the wind turbine, the operator objectives and limita­
tions, we define the following robust control specifications—with H(s) = 1:
•	 Type 1: Stability specification
	
|
(
)|
(
) (
)
(
) (
)
( )
.
[ .
T j
p
j
G j
p
j
G j
Ws
1
32
32
1
1
1 46
0 001
0
ω
ω
ω
ω
ω
ω
ω
=
+
≤
=
=
∈
δ
.
.
.
.
.
.
.
]
005
0 01
0 05
0 1
0 5
1
2 04
3
4 19
5
10
50
100  rad/s

(CS2.43)
which is equivalent to PM = 40.05°, GM = 4.53 dB—see Equations 2.30 and 2.31.
10–2
10–1
100
Magnitude (dB)
–25
–20
–15
–10
–5
0
Bode diagram
(a)
(b)
Frequency (rad/s)
δ3(s) = δk1(s)
0
10
20
30
40
50
60
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
δ6–up(s)
δ6–lo(s)
FIGURE CS2.9
Control specifications. (a) Disturbance rejection specifications: δ3 = δk1 and (b) reference tracking: δ6-up, δ6-lo.

331
Case Study 2: Wind Turbine Control
•	 Type 3: Sensitivity or disturbances at plant output specification—see Figure CS2.9a
	
|
(
)|
(
)
(
)
(
) (
)
( )
T j
j
d j
p
j
G j
s
a
r
o
d
3
32
3
1
1
ω
Ω
ω
ω
ω
ω
ω
=
=
+
≤
=






δ
s
a
a
d
d





+
=
∈
1
0 2
0 001
0 005
0 01
0 05
0 1
;
.
[ .
.
.
.
. ]
ω
 rad/s
	
(CS2.44)
• Type k1: Wind disturbances v1(s) over Ωr(s) via p31(s) and loop—also Figure CS2.9a
	
|
(
)|
(
)
(
)
(
)
(
) (
)
( )
T
j
j
v j
p
j
p
j
G j
s
a
k
r
k
k
1
1
31
32
1
1
1
ω
Ω
ω
ω
ω
ω
ω
ω
=
=
+
≤
=


δ









+
=
∈
s
a
a
k
k
1
1
1
0 2
0 001
0 005
0 01
0 05
0
;
.
[ .
.
.
.
.
ω
1] rad/s
	
(CS2.45)
•	 Type 6: Reference tracking specification—see Figure CS2.9b
	
δ
δ
6
6
32
32
6
1
-
-
lo
up
T j
F j
p
j
G j
p
j
G j
( )
|
(
)|
(
)
(
) (
)
(
) (
)
( )
ω
ω
ω
ω
ω
ω
ω
ω
<
=
+
≤
ω ∈[ .
.
.
.
.
. ]
0 001
0 005
0 01
0 05
0 1
0 5  rad/s
	
(CS2.46)
	
δ6
2
1
1
0 22
-lo
L
L
s
s
a
a
( )
;
.
=





+






=
	
(CS2.47)
	
δ6
2
1
2
-up
U
n
n
s
s
a
s
s
( ) =





+











+


ω
ζ
ω



+






=
=
=
1
0 09
0 8
1 25
;
.
;
. ;
.
a
a
U
n
U
ζ
ω
ζ
	
(CS2.48)
•	 Type k2: Wind disturbances v1(s) over yt(s) via p12(s) × G(s) × p31(s)—Figure CS2.10
	
|
(
)|
(
)
(
)
(
)
(
) (
)
(
) (
)
T
j
y j
v j
p
j
p
j
G j
p
j
G j
k
t
2
1
12
31
32
1
ω
ω
ω
ω
ω
ω
ω
ω
=
=
+
≤δk
s
2
1
5
1
2 04
4 19
( )
[ .
.
]
ω
ω
=
+
∈
 rad/s
	
(CS2.49)
•	 Type k3: Wind disturbances v1(s) over yb(s) via p22(s) × G(s) × p31(s) and loop
	
|
(
)|
(
)
(
)
(
)
(
) (
)
(
) (
)
T
j
y
j
v j
p
j
p
j
G j
p
j
G j
k
b
3
1
22
31
32
1
ω
ω
ω
ω
ω
ω
ω
ω
=
=
+
≤δk3
0 85
2 04
4 19
( )
.
[ .
.
]
ω
ω
=
∈
 rad/s
	
(CS2.50)

332
Case Study 2: Wind Turbine Control
CS2.5  Controller Design
CS2.5.1  QFT Bounds
As mentioned, the QFT bounds take into account the plant dynamics, model, uncertainty, 
and control specifications. Figure CS2.11a–f, show the bounds for stability, sensitivity, ref­
erence tracking, wind disturbance rejection, tower fore-aft oscillation attenuation, and 
blade flap-wise vibration reduction, respectively. Figure CS2.12 presents the ­intersection 
of all these six bounds at each frequency. As we have a bound solution for each frequency, 
the selected control specifications for the wind turbine are compatible.
CS2.5.2  Loop Shaping—G(s)
The design of the feedback controller G(s) is carried out on the Nichols chart. It is done by 
adding poles and zeros until the nominal loop, defined as L0(jω) = p32,0(jω)G(jω), meets the 
QFT bounds presented in Figure CS2.12.
We start the design of G(s) by adding a negative sign, as the plant has a negative DC gain. 
Then, we add an integrator to obtain zero steady-state error for step reference inputs, and 
also to place L0(s) at the same phase of the indentation of the low-frequency bound B(0.001). 
After this, we increase the magnitude of the controller gain to k = 35, to put L0(0.001) above 
the B(0.001) bound. Next, we add a low-frequency zero (z1 = 0.11), to move L0(s) to the right, 
and to pass the stability bounds (“circles”) through the right.
Afterward, to meet the dashed-line bound at 2.04 rad/s, we add a notch filter 
s
s
s
s
a
n
n
b
n
n
2
2
2
2
+
+
(
)
+
+
(
)
ζ ω
ω
ζ ω
ω
/
2
2
, with a natural frequency of ωn = 2.04 rad/s, a damp­
ing numerator coefficient of ζa = 0.2, and a damping denominator coefficient of ζb = 1. 
10–2
10–1
100
101
Magnitude (dB)
–35
–30
–25
–20
–15
–10
–5
0
5
Bode diagram
Frequency (rad/s)
4.19 rad/s
2.04 rad/s
FIGURE CS2.10
Control specifications. Type k2: attenuation of the effect of wind disturbances v1(s) over the tower yt(s) through 
p12(s) × G(s) × p31(s) and control loop.

333
Case Study 2: Wind Turbine Control
Open-loop phase (deg)
–240
–220
–200
–180
–160
–140
–120
–100
Open-loop magnitude (dB)
–20
–10
0
10
20
30
40
(a)
(b)
(c)
(d)
(e)
(f)
QFTCT
0.001
0.005
0.01
0.1
0.05
0.5
1
2.04
3
10
5
4.19
50
100
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
10
20
30
40
50
60
70
QFTCT
0.005
0.05
0.1
0.001
0.01
Open-loop magnitude (dB)
0
20
40
60
80
100
120
QFTCT
0.001
0.005
0.01
0.05
0.1
0.5
Open-loop magnitude (dB)
–20
–10
0
10
20
30
40
50
60
QFTCT
0.005
0.001
0.05
0.1
0.01
Open-loop magnitude (dB)
–15
–10
–5
0
5
10
15
QFTCT
2.04
4.19
Open-loop magnitude (dB)
–5
0
5
10
15
20
QFTCT
4.19
2.04
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
FIGURE CS2.11
QFT bounds. (a) Stability bounds, (b) sensitivity bounds, (c) reference tracking bounds, (d) wind disturbance 
rejection bounds, (e) fore-aft tower vibration attenuation bounds, and (f) blade flap-wise vibration reduction 
bounds.

334
Case Study 2: Wind Turbine Control
This  gives a depth of 20 × log10(ζa/ζb)dB = −13.98 dB, which is enough to place L0(2.04) 
below the B(2.04) dashed-line bound.
Finally, we add one more additional pole at high frequency (p1 = 40), to filter out high-­
frequency noise. The final controller G(s) is shown in Equation CS2.51 and the loop 
­shaping in Figure CS2.13.
	
G s
s
s
s
( ) =
−





+











+




35
0 11
1
40
1
.


+
+
+
+
(
.
.
)
(
.
.
)
s
s
s
s
2
2
0 816
4 1616
4 08
4 1616
	
(CS2.51)
CS2.5.3  Prefilter Design—F(s)
With the controller G(s) just designed—see Equation CS2.51, the reference tracking specifi­
cations presented in Equations CS2.46 through CS2.48, and the plant model p32(s) described 
in Equation CS2.39, we design a prefilter F(s) to assure that all the input/output functions 
p32(s)G(s)F(s)/[1 + p32(s)G(s)], from low frequencies up to 0.5 rad/s are inside the band defined 
by the limits δ6-up(ω) and δ6-lo(ω). The designed prefilter is shown in Equation CS2.52, and the 
input/output functions and limits in Figure CS2.14.
	
F s
s
s
( )
.
.
=





+











+






2 5
1
0 2
1	
(CS2.52)
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–20
0
20
40
60
80
100
120
QFTCT
0.001
0.005
0.01
0.05
0.1
0.5
100 50
10
5
3
1
4.19
2.04
FIGURE CS2.12
QFT bounds. Intersection of bounds.

335
Case Study 2: Wind Turbine Control
Open-loop phase (deg)
–220
–200
–180
–160
–140
–120
–100
–80
–60
–40
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
80
100
120
QFTCT
L0(s)
0.001
0.005
0.01
0.05
0.1
0.5
1
100
50
2.04
5
3
4.19
10
FIGURE CS2.13
QFT bounds and G(s) design—loop shaping.
Frequency (rad/s)
10–2
10–1
100
101
Magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
QFTCT
δ6-up
p32GF/(1 + p32G)
δ6-lo
FIGURE CS2.14
Prefilter F(s) for reference tracking specs: δ6-lo(ω) ≤ |T6| ≤ δ6-up(ω).

336
Case Study 2: Wind Turbine Control
CS2.6  Analysis and Validation
The analysis of the closed-loop stability in the frequency domain is shown in 
Figure  CS2.15a.  The dashed line is the stability specification Ws defined in Equation 
CS2.43. The solid line  represents the worst case of all the possible functions p32G/
(1 + p32G) at each frequency due to the model uncertainty. The control system meets the 
stability specification (the solid line is below the dashed line Ws) for all the plants within 
the uncertainty.
The analysis of the robust sensitivity specification, or rejection of disturbances at the 
output of the plant, is shown in Figure CS2.15b. The dashed line is the sensitivity specifi­
cation δ3(ω) defined in Equation CS2.44. The solid line represents the worst case of all the 
possible functions 1/(1 + p32G) at each frequency due to the model uncertainty. The control 
system meets the sensitivity specification in all cases (the solid line is below the dashed 
line δ3) from 0 to 0.1 rad/s.
The analysis of the robust wind disturbance rejection in the frequency domain is 
shown in Figure CS2.15c. The dashed line is the specification δk1(ω) defined in Equation 
CS2.45. The solid line represents the worst case of all the possible functions p31/(1 + p32G) 
at each frequency due to the model uncertainty. Again, the control system meets the 
specification for all the plants within the uncertainty (the solid line is below the dashed 
line δk1).
The fore-aft tower vibration analysis in the frequency domain is shown in Figure CS2.15d. 
It represents the attenuation of the effect of wind disturbances v1(s) over the tower move­
ment yt(s) through p12(s) × G(s) × p31(s) and the control loop—see also Figure CS2.5. The 
dashed line is the specification δk2(ω) defined in Equation CS2.49. The solid line represents 
the worst case of all possible functions p12p31G/(1 + p32G) at each frequency due to the 
model uncertainty. Once more, the control system meets the specification in all cases (solid 
line is below dashed line δk2).
The flap-wise blade vibration analysis in the frequency domain is shown in 
Figure CS2.15e. It represents the attenuation of the effect of wind disturbances v1(s) over 
the blades ­movement yb(s) through p22(s) × G(s) × p31(s) and the control loop—see Figure 
CS2.5. The dashed line is the specification δk3(ω) defined in Equation CS2.50. The solid line 
represents the worst case of all possible functions p22p31G/(1 + p32G) at each frequency due 
to the model uncertainty. The control system meets the specification in all cases (solid line 
is below dashed line δk3).
The time-domain analysis of the reference tracking specification is presented in 
Figure  CS2.16a. The figure shows the limits δ6-up(ω) and δ6-lo(ω)—see Equations CS2.48 
and CS2.47, and the time responses of the rotor velocity Ωr(t) to a unitary step reference 
r(t). We simulate 100 cases of the closed-loop transfer function p32GF/(1 + p32G)—see 
Figure CS2.5, with H(s) = 1 and the electrical torque constant at Tgd = Tgdmax = 4,006,111 Nm, 
and Figure CS2.19, Region 3, above-rated. The results are given in per unit, the unit being 
Ωr_nom = 1.2671 rad/s = 12.1 rpm. The control system meets the specification (is between 
the upper and lower limits) in all cases.
Additionally, the time-domain analysis of the wind disturbance rejection is shown in 
Figure CS2.16b. The figure presents the time responses of the rotor velocity Ωr(t) to a uni­
tary step wind speed disturbance v1(t). We simulate 100 cases within the uncertainty of 
p31/(1 + p32G), also with H(s) = 1 and Tgd = Tgdmax = 4,006,111 Nm. Now, the zero level is the 
non-perturbed Ωr_nom = 1.2671 rad/s = 12.1 rpm. The control system achieves a good dis­
turbance rejection in all cases.

337
Case Study 2: Wind Turbine Control
Frequency (rad/s)
Magnitude (dB)
–25
–20
–15
–10
–5
0
5
0.001
0.005
0.01
0.05
0.1
0.5
1
2.04
3
4.19
5
10
50
100
QFTCT
(a)
Ws
Worst cases of
“p32G/(1+p32G)”
10–2
10–3
100
10–1
101
102
Frequency (rad/s)
QFTCT
Magnitude (dB)
–45
–40
–35
–30
–25
–20
–15
–10
–5
0
5
0.001
0.005
0.01
0.05
0.1
(b)
10–2
10–3
100
10–1
Worst cases of
“1/(1+p32G)”
δ3
Magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
0.001
0.005
0.01
0.05
0.1
QFTCT
(c)
Frequency (rad/s)
10–2
10–3
100
10–1
101
Worst cases of
“p31/(1+p32G)”
δk1
Magnitude (dB)
–100
–90
–80
–70
–60
–50
–40
–30
–20
–10
0
2.04
4.19
QFTCT
(d)
Worst cases of
“p12p31G/(1+p32G)”
Frequency (rad/s)
101
100
10–1
δk2
Magnitude (dB)
–50
–45
–40
–35
–30
–25
–20
–15
–10
–5
0
2.04
4.19
QFTCT
(e)
Worst cases of
“p22p31G/(1+p32G)”
Frequency (rad/s)
101
100
δk3
FIGURE CS2.15
Frequency-domain analysis: (a) stability, (b) sensitivity, (c) wind disturbance rejection, (d) fore-aft tower vibra­
tion, and (e) flap-wise blades vibration.

338
Case Study 2: Wind Turbine Control
Additionally, Figure CS2.17 shows the tower fore-aft oscillation when a unitary step 
wind velocity input v1(s) is introduced into the system. The disturbance v1(s) enters through 
p31(s), travels the pitch control loop until βd(s), and finally goes through p12(s) to yt(s)—see 
the block diagram in Figure CS2.5. We study two cases. The first one, represented in 
Figure CS2.17a, uses the complete controller described in Equation CS2.51. The second 
case, ­represented in Figure CS2.17b, uses this controller without the notch filter.
Time (s)
0
50
100
150
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
QFTCT
Time (s)
0
50
100
150
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
QFTCT
(a)
(b)
FIGURE CS2.17
Tower fore-aft oscillation, yt(t). Simulation of 100 plants. (a) G(s) with the notch filter—see Equation CS2.51 and 
(b) G(s) without the notch filter.
Time (s)
0
10
20
30
40
50
60
70
–0.01
–0.005
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
QFTCT
(b)
(a)
Time (s)
0
5
10
15
20
25
30
35
40
45
50
0
0.2
0.4
0.6
0.8
1
1.2
QFTCT
δ6-up
δ6-lo
FIGURE CS2.16
Time domain. (a) Reference tracking Ωr(s) = p32GF/(1 + p32G)r(s) and (b) wind disturbance rejection Ωr(s) = 
p31/(1 + p32G)v1(s).

339
Case Study 2: Wind Turbine Control
The tower oscillation is significantly reduced when we add the notch filter in the feed­
back controller G(s), that is, the complete Equation CS2.51. Figure CS2.17a shows the yt(t) 
results with the complete G(s), and Figure CS2.17b without the notch filter. Both analyses 
are performed for the same 100 cases within the plant uncertainty. The figures have the 
same scale.
Figure CS2.18a zooms in one case of the simulations of Figure CS2.17a and b. As we 
can see, the frequency of the oscillation in the figure (20 peaks in 60 s) is the natural fre­
quency of the tower fore-aft oscillation: 0.320 Hz. The results of yt(t) using the complete 
controller G(s) are represented by the solid line—Equation CS2.51, and the results of G(s) 
without the notch filter by the dashed line. As anticipated, the complete controller G(s) 
with the notch filter obtains a much better peak to peak reduction of the tower fore-aft 
oscillation.
Finally, Figure CS2.18b presents the attenuation of the blade flap-wise vibration yb(t) at 
its resonance frequency of 0.6664 Hz (13.3 peaks in 20 s), also with the controller G(s) with 
and without the notch filter. In this case, the step input disturbance v1(s) enters through 
p31(s), travels the pitch control loop until βd(s), and goes through p22(s) to yb(s)—see also the 
block diagram in Figure CS2.5. As in the tower vibration case, the complete ­controller 
G(s) with the notch filter obtains a better peak to peak reduction of the blade flap-wise 
oscillation.
CS2.7  Extension to Higher Wind Velocities
This case study has designed the wind turbine pitch control system for the first part of the 
above-rated region, also called Region 3—see Figure CS2.19, range of wind speed v1 from 
v1 = vr ∼ 12 m/s to v1 = 17 m/s.
Time (s)
40
50
60
70
80
90
100
0.07
0.072
0.074
0.076
0.078
0.08
QFTCT
Case G with notch filter
Case G without notch filter
Tower fore-aft natural freq. = 0.32 Hz =
~20 peaks in 60 s
Time (s)
50
52
54
56
58
60
62
64
66
68
70
0.85
0.855
0.86
0.865
0.87
0.875
0.88
0.885
0.89
0.895
QFTCT
(a)
(b)
Case G with notch filter
Case G without notch filter
Blade flap-wise natural freq. = 0.6664 Hz =
~13.3 peaks in 20 s
FIGURE CS2.18
Zooming in. (a) Tower fore-aft oscillation yt and (b) blade flap-wise oscillation yb. G(s) with notch filter (solid 
line) and without (dashed line).

340
Case Study 2: Wind Turbine Control
The proposed controller G(s) can be easily extended to the entire Region 3, from vr to v34 
in Figure CS2.19. As the aerodynamics changes significantly with the wind velocity, the 
parameters KTΩ, KTV, and KTβ also change considerably—see Figure CS2.3 and Equations 
CS2.20 through CS2.26. As a result, the gains and one pole of the denominators of p31(s), 
p32(s), and p33(s) change with the wind speed—see Equations CS2.38 and CS2.39. A quan­
titative analysis of these variations is in the author’s book, Wind Energy Systems: Control 
Engineering Design, Chapter 12, Reference 7.
To deal with this problem, the controller G(s), Equation CS2.51, had to modify its gain 
and zero in real time, as a function of the desired pitch angle βd, so that
	
k
f
d
=
×
–
(
)
35
1 β
	
(CS2.53)
	
z
f
d
1
2
0 11
=
×
.
(
)
β
	
(CS2.54)
As the magnitude of the gain of the plant Ωr(s)/βd(s) = p32(s) increases with the wind 
speed increase, the correcting function f1(βd) typically decreases with the pitch angle βd to 
compensate this effect. Also, as one pole of the plant p32(s) becomes faster with the wind 
speed increase, the correcting function f2(βd) typically increases with the pitch angle to 
make the controller zero faster as well.
The design, stability analysis, and validation of this extended control strategy can be 
easily done according to the methodology presented in Chapters 6 and 7.
CS2.8  Summary
This case study has successfully designed a robust QFT control system for a variable-speed 
pitch-controlled gearless wind turbine. The design considers the model nonlinearities 
Power (P)
Wind
speed (v1)
Below rated—power optimization 
Above rated—power limitation 
Region 1 
Torque control: 
maximum
aerodynamic
efficiency
Region 3
Pitch control:
stability,
disturbance
rejection
Region 4
Extended mode:
load limitation,
partial power
Region 2 
Transition:
good
efficiency,
smooth
transients
Rated
power
Pr
vcut-in
vcut-off
vr
v12
v34
This case study
12 < v1 < 17 m/s
FIGURE CS2.19
Wind turbine power curve: Active power P versus wind speed v1.

341
Case Study 2: Wind Turbine Control
and uncertainty introduced by the aerodynamics. It accomplishes five simultaneous con­
trol objectives:
•	 Stability
•	 Tracking and regulation of the rotor speed by pitching the angle of the blades
•	 Rejection of unpredictable wind disturbances
•	 Minimization of the tower fore-aft oscillations and
•	 Attenuation of the blades flap-wise vibrations


343
Case Study 3: Wastewater 
Treatment Plant Control
CS3.1  Description
Human activity is seriously increasing the amount of nitrogen and phosphorus in the 
environment. When the concentration of nitrogen or phosphorus is too high, the water 
becomes polluted. This affects streams, rivers, lakes, and ground water, often resulting 
in human health issues, environmental destruction, and economic impact. Fortunately, 
the environmental policies and standards on water pollution have become increasingly 
­stringent during the last few decades. Wastewater treatment plants (WWTP) with activated 
sludge processes (ASP) play a vital role in removing harmful organic matter, ­nitrogen, and 
phosphorus from domestic and industrial wastewater.
The high cost of WWTPs and the stringent water quality standards justify the effort 
to design advanced control strategies to manage ASP with maximum efficiency and 
­minimum cost. The large variety of biological mechanisms and processes involved, their 
nonlinearity and multi-input multi-output (MIMO) characteristics, and the uncertainties 
in the composition and flow of the influent challenge the design of control solutions.
This Case Study CS3 presents the design of a MIMO QFT robust control system for 
an ASP-WWTP that simultaneously reduces the concentration of ammonia (NH4) and 
nitrates (NO3) in the plant effluent to meet the environmental standards. As an example, 
Figure CS3.1 shows a picture of the Crispijana-Vitoria plant, a municipal water ­treatment 
plant for nitrogen removal, able to deal with a 5000 m3/h inflow, for which the author with 
the CEIT Research Centre designed an advanced robust control system in the 90s.192,208,212
In the following sections, we model and analyze the dynamics of an ASP-WWTP, 
­analyze  the MIMO characteristics, propose a set of robust stability and performance 
­specifications, design SISO and MIMO control solutions, and validate them in both the 
frequency and time domains.
CS3.2  Plant Model
Figure CS3.2 shows the plant layout of a municipal ASP-WWTP that reduces the 
­concentration of nitrogen (NH4 and NO3) and phosphorus (PO4) in water. In this case study, 
we propose the design of a MIMO controller for simultaneous removal of NH4 and NO3.
The influent flow (QIN) is the wastewater coming from the city, typically with a high 
concentration of nitrogen, that is NH4 and NO3. The plant objective is to reduce these con­
centrations in the effluent flow (QOUT). The WWTP hydraulic configuration is composed of 

344
Case Study 3: Wastewater Treatment Plant Control
three biological tanks in series (Anaerobic, Anoxic, and Aerobic) and one settler for effluent 
clarification and sludge thickening—see Figure CS3.2.
The purpose of the anaerobic tank (first tank) is to promote phosphorous removal 
through growth of PAO bacteria, which accumulate phosphorus in approximately 35% 
of their weight, compared with regular bacteria which accumulate only 2%. Additionally, 
an ­external feed of ferric hydroxide (XMeOH) is provided to ensure efficient phosphorus 
removal. In this way, the phosphates not biologically removed by the PAO bacteria are 
coagulated through a chemical reaction.
In the anoxic tank (second tank), heterotrophic bacteria are responsible for the denitrifi­
cation. These bacteria biodegrade the organic matter, which at the same time turns NO3 
recycled from the aerobic tank (QRI) into nitrogen (N2) gas. This reaction takes place in 
an anaerobic environment where the bacteria responsible for denitrification respire with 
nitrate instead of oxygen. The process, called denitrification, can be summarized by the 
formula:
	
4NO
5CH O
4H
2N
5CO
7H O
3
2
2
2
2
−
+
+
+
→
+
+
	
(CS3.1)
NO3 that enters the previous expression is both coming from the influent QRI and also 
the product of a nitrification process taking place in the aerobic tank (third tank) by means 
of nitrifying bacteria and the injection of air (u1 = KLa). In other words, NH4 is oxidized 
FIGURE CS3.1
WWTP, Crispijana, Spain. Inflow 5000 m3/h.
Anoxic
Tank
Anaerobic
Tank
Aerobic
Tank
QIN
QRI
u2(s) = Rext
QW
QOUT
Settler
XMeOH
u1(s) = KL
a
N2 gas
4NO3
– + 5CH2O + 4H+→ 2N2 + 5CO2 + 7H2O
NH4
+ + 2O2 → NO3
– + H2O + 2H+
FIGURE CS3.2
ASP-WWTP configuration.

345
Case Study 3: Wastewater Treatment Plant Control
to NO3 with an aeration system in the aerobic tank. The process, called nitrification, can be 
summarized by the formula:
	
NH
2O
NO
H O
2H
4
2
3
2
+
−
+
+
→
+
+
	
(CS3.2)
Additionally, in the settler the activated sludge is thickened, so that the clarified 
­supernatant overflows into the effluent. At the same time, the activated sludge is recycled 
to the anaerobic tank (u2 = Rext) to maintain a high biomass concentration in the reactors.
As a result, NH4 and NO3 that enter into the WWTP are removed from the water using 
two biological processes: nitrification in the 3rd tank and denitrification in the 2nd tank, 
­converting them finally into N2 gas. The case is a 2 × 2 MIMO plant, being the plant 
­outputs (sensors) and actuators respectively:
•	 y1(s) = NH4, or concentration of ammonia in the effluent QOUT
•	 y2(s) = NO3, or concentration of nitrates in the effluent QOUT
•	 u1(s) = KLa, or air flow injected in the aerobic tank
•	 u2(s) = Rext, or external sludge recirculation flow, from settler to anaerobic tank
Other variables of the plant are the internal recirculation flow QRI, the waste sludge flow 
QW and the ferric hydroxide added in anaerobic tank XMeOH. In this problem, we consider 
these three variables working at a fixed rate.
We use the International Water Association (IWA) ASM2d nonlinear model for our 
ASP-WWTP. We linearize the system around the working points, take the effect of the 
­nonlinearities as parametric uncertainty, and identify and calibrate a resulting 2 × 2 
MIMO model, as shown in Equation CS3.3,212
	
NH
NO
4
3
11
12
21
22
( )
( )
( )
( )
( )
( )
( )
s
s
s
p
s
p
s
p
s
p
s
w
w
w
w
w





=
=



P










K a s
R
s
L
ext
( )
( ) 	
(CS3.3)
where
	
p
s
k
s
a
p
s
k
s z
s z
w
w
11
11
11
12
12
12 1
1
1
( )
( )
(
)
(
.
=
+






=
+
(
)
;
 
/
/ 12 2
12
12
2
12
12
21
1
1
2
1
. )
(
)
(
)
(
)
( )
+
(
)
+
(
)
+
+


s a
s
s
p
s
n
n
w
/
/
/
ω
ζ
ω
=
+






=
+






k
s
a
p
s
k
s
a
w
21
21
22
22
22
1
1
;
( )
	
and where the parameters are
•	 k11 ∈ [−0.045, −0.035]; a11 ∈ [6.25 × 10−5, 8.25 × 10−5].
•	 k12 = −6.239 × 10−6; z12.1 = 7.534 × 10−4; z12.2 = −3.17 × 10−5; a12 = 8.04 × 10−5; ωn12 = 
4.58 × 10−4; ζ12 = 0.8493.
•	 k21 = 0.0464; a21 = 1.008 × 10−4.
•	 k22 ∈ [−2.2 × 10−5, −1.8 × 10−5]; a22 ∈ [1.57 × 10−4, 1.77 × 10−4].

346
Case Study 3: Wastewater Treatment Plant Control
Additionally, environmental regulations and operation procedures require the control 
of WWTPs following daily-average measurements of the output concentrations. For this 
reason, we multiply each pwij(s) plant by a low-pass filter fLP(s) with a unitary dc-gain and 
a 2π/(24 × 60 × 60) = 7.27 × 10−5 rad/s bandwidth (as a day is 24 h, with 60 min/h and 
60 s/min)—see Figure CS3.3. In this way, the daily-averaged plant models, now called 
pij(s), are
	
P
P
( )
( )
( )
( ) ,
( )
( )
( ) ;
s
s
f
s
f
s
p s
p
s f
s
i
w
LP
LP
ij
wij
LP
=
=
=






with
1 2
1 2
1
1 1 10
2
1 1 10
4
2
4
, ;
,
( )
.
.
j
f
s
s
LP
=
=
with
×





+
×




−
−
+






s
1
	
(CS3.4)
CS3.2.1  Frequencies
Figure CS3.4 shows the Bode diagram of the 2 × 2 MIMO plant P(s) = [pij(s)], i = 1, 2, j = 1, 2. 
Based on this picture, we select the array of frequencies of interest, so that
	
ω =
×
×
×
×
×
×
×
×
×
−
−
−
−
−
−
−
−
−
[1 1
5
1
1 1
5
1
1 1
2
1
5
1
1 1
2
1
5
7
7
6
6
5
5
5
4
4
0
0
0
0
0
0
0
0
0
×
×
×
×
−
−
−
−
1
1 1
2
1
5
1
rad/s
4
3
3
3
0
0
0
0
]
	 (CS3.5)
CS3.2.2  Nominal Plant
The nominal plant is selected at the operating point of the WWTP, which is described by 
the mean values in the intervals of uncertainty in Equations CS3.3.
2
1
0
–1
–2
Magnitude (dB)
–3
–4
–5
Frequency (rad/s)
Bandwidth (–3 dB)
Bode diagram
10–6
10–5
10–4
–6
–7
–8
FIGURE CS3.3
Bode diagram for daily-average low-pass filter fLP(s), Equation CS3.4.

347
Case Study 3: Wastewater Treatment Plant Control
CS3.3  Preliminary Analysis
Before starting the design of the controllers, we conduct a brief preliminary analysis of the 
dynamics of the WWTP. As just mentioned, Figure CS3.4 shows the Bode diagram of the 
2 × 2 MIMO plant P(s) = [pij(s)], i = 1, 2, j = 1, 2, including also the parametric uncertainty.
As expected, the plant elements pij(s) have no integrators (system type 0) and include neg­
ative (k11, k12, and k22) and positive (k21) dc gains. Also, the phases indicate that there is a non-
minimum phase zero component. This is analyzed in-depth with the relative gain array.
Figure CS3.5 presents the relative gain analysis (RGA) over the frequencies of ­interest 
of the nominal 2 × 2 MIMO plant P0(s). These graphical results are also presented numeri­
cally for very low frequency or ω = 0 rad/s in Equation CS3.6, and for very high ­frequency 
or ω = ∞ rad/s in Equation CS3.7.
	
Λ(
)
.
.
.
.
ω=
=










0
1
2
0 7414
0 2586
0 2586
0 7414
u
u





y
y
1
2 	
(CS3.6)
	
Λ(
)
.
.
.
.
ω=∞= −
−










0 8898
1 8898
1 8898
0 8898
1
2
u
u





y
y
1
2 	
(CS3.7)
–50
From: In(1)
p11(s)
p12(s)
p22(s)
p21(s)
From: In(2)
Bode diagram
–100
To: out(1)
–150
180
0
To: out(1)
Magnitude (dB); phase (deg)
–180
–50
–100
To: out(2)
–150
180
0
To: out(2)
–180
10–6
10–5
10–4
10–3
Frequency (rad/s)
10–6
10–5
10–4
10–3
FIGURE CS3.4
Bode diagram of P(s) = [pij(s)], i = 1,2, j = 1,2.

348
Case Study 3: Wastewater Treatment Plant Control
By looking at the matrix Λ(ω=0), Equation CS3.6, we select the input–output pairing for the 
2 × 2 MIMO system as: (KLa, NH4) and (Rext, NO3), that is, (u1, y1) and (u2, y2).
Also, comparing the two matrices Λ(ω=0) and Λ(ω=∞), Equations CS3.6 and CS3.7, we see 
that the signs of λ11, λ12, λ21, and λ22 change. As we discussed in Chapter 8, Section 8.3.3, 
this means that the MIMO system has a non-minimum phase (nmp) zero. By inspection of 
the transfer matrix, we find the nmp zero at: z1 = –2 × 10–4 rad/s, which is the frequency of 
the discontinuity in the diagrams of Figure CS3.5. As we will see next, this nmp zero will 
limit the bandwidth of the control system.
CS3.4  Control Specifications
Taking into account the dynamics of the WWTP and the operator objectives and limita­
tions, we define the following robust control specifications. They are the same for both 
channels, and include stability, output disturbance rejection, and reference tracking 
­objectives as presented below:
•	 Type 1: Stability specification
	
T j
p
j
g
j
p
j
g
j
W
i
ii
ii
ii
ii
s
1(
)
( )
1.66,
1,2
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
=
(
)
(
)
(
)
(
)
1
1
∈
×
×
×
×
×
×
×
×
×
−
−
−
−
−
−
−
−
−
[1 10
5
10
1 10
5
10
1 10
2
10
5
10
1 10
2
10
5
7
7
6
6
5
5
5
4
4
×
×
×
×
−
−
−
−
10
1 10
2
10
5
10
] rad/s
4
3
3
3
	
(CS3.8)
3
4
2
0
–2
–4
2
1
0
λ11
λ21
4
2
0
–2
–4
λ12
–1
–2
–3
3
2
1
0
λ22
–1
–2
–3
10–6
10–5
Frequency (rad/s)
10–4
10–3
10–2
10–6
10–5
Frequency (rad/s)
10–4
10–3
10–2
10–6
10–5
Frequency (rad/s)
10–4
10–3
10–2
10–6
10–5
Frequency (rad/s)
10–4
10–3
10–2
FIGURE CS3.5
RGA of P0(s) with frequency: λij, i = 1,2 and j = 1,2.

349
Case Study 3: Wastewater Treatment Plant Control
	
which is equivalent to PM = 35.06°, GM = 4.09 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification—see Figure CS3.6a
	
T j
y j
d j
p
j
g
j
s
a
o
ii
ii
op
d
3
1
1
(
)
(
)
(
)
( )
ω
ω
ω
ω
ω
δ
ω
=
=
+
≤
=






(
)
(
)
s
a
a
i
d
d





+
= ×
=
∈
×
×
×
×
−
−
−
−
1
2
10
1 2
5
;
,
, .
[
ω
1 10
5
10
1 10
5
1
7
7
6
0
1 10
2
10
rad/s
6
5
5
−
−
−
×
×
]
	
(CS3.9)
•	 Type 6: Reference tracking specification—see Figure CS3.6b
	
δ
ω
ω
ω
ω
ω
ω
δ
ω
lo
ii
ii
ii
ii
ii
up
p
j
g
j
p
j
g
j
f
j
i
( )
(
)
(
)
(
)
(
)
(
)
( ),
,
≤
+
≤
=
1
1 2
	
(CS3.10)
	
δlo
L
L
s
s
a
a
( ) =





+






= ×
−
1
1
2
10
2
5
;
	
(CS3.11)
	
δ
ω
ζ
ω
up
U
n
n
s
s
a
s
s
( ) =





+











+



1
2
2

+






= ×
=
=
−
1
2
10
0 8
1 25
5
;
;
. ;
.
a
a
U
n
U
ζ
ω
ζ
	
(CS3.12)
	
ω∈
×
×
×
×
×
×
×
×
−
−
−
−
−
−
−
−
[
]
1 10
5
10
1 10
5
10
1 10
2
10
5
10
1 10
rad/s
7
7
6
6
5
5
5
4
CS3.5  Controller Design
This section presents two control solutions for the WWTP. The first one is composed of 
two independent SISO PI controllers, and is implemented according to the structure in 
0
1.2
(b)
(a)
1
0.8
Amplitude
0.6
0.4
0.2
0
δup(s)
δlo(s)
δop(s)
Bode diagram
Step response
–5
–10
–15
Magnitude (dB)
–20
–25
10–6
Frequency (rad/s)
10–5
10–4
10–3
0
0.5
1
Time (s)
1.5
2
2.5
×105
FIGURE CS3.6
Control specifications for all channels. (a) Disturbance rejection at the output of the plant: δop. (b) Reference 
tracking: δup, δlo.

350
Case Study 3: Wastewater Treatment Plant Control
Figure CS3.7. The second solution applies the MIMO QFT Method 2 presented in Chapter 8, 
Sections 8.6 and 8.9, and is implemented according to the diagram of Figure CS3.14.
CS3.5.1  Independent SISO QFT Control
Controller Structure
Figure CS3.7 shows the SISO QFT controller structure for the WWTP. It is composed of 
a 2 × 2 diagonal matrix G s
g
s
g
s
i
i
i
( )
( ) ;
( )
= 

11
22
0 0
 and a 2 × 2 diagonal prefilter matrix 
F(s) = [f11(s) 0; 0 f22(s)].
Design of 2 × 2 Diagonal Matrix Gi(s) Controller and Prefilter F(s)
The SISO controller, or 2 × 2 diagonal controller Gi, is composed of two independent 
controllers, g
s
i
11( ) and g
s
i
22( ). The element g
s
i
11( ) is designed by means of the standard 
SISO QFT loop-shaping technique, for the plant p11(s), and for the control specifications 
described in Equations CS3.8 through CS3.12. The QFT bounds and the loop shaping 
for g
s
i
11( ) are shown in Figure CS3.8. The expression found for the controller g
s
i
11( ) is a 
PI so that
	
g
s
s
s
i
11
5
0 0006
1
3
10
1
( )
.
=
−
×
+






−
	
(CS3.13)
The f11(s) prefilter element is designed for the plant p11(s) and the controller g
s
i
11( ). 
Figure CS3.9 shows the design. The expression found for the prefilter f11(s) is
	
f
s
s
11
5
1
1
3 2
10
1
( )
.
=
×
+






−
	
(CS3.14)
Figure CS3.10 shows the analysis of the disturbance rejection at the output of the plant 
and the reference tracking specifications. The analysis is made using the plant p11(s) with 
uncertainty, the controller g
s
i
11( ) and the prefilter f11(s). When considering no coupling 
(p12 = p21 = 0), the first channel of the SISO control system meets the specifications for all 
the p11(s) plants within the uncertainty.
y2(s)
r2(s)
g11(s)
i
g22(s)
i
–
–
r1(s)
p11(s)
p12(s)
p21(s)
p22(s)
f11(s)
f22(s)
y1(s)
u1(s)
u2(s)
FIGURE CS3.7
SISO QFT control system for the WWTP.

351
Case Study 3: Wastewater Treatment Plant Control
60
QFTCT
1e-7 rad/s
40
20
0
Open-loop gain (dB)
–20
–40
–60
–260 –240 –220 –200 –180
Open-loop phase (deg)
–160 –140 –120 –100 –80
–60
L011 (s) = p11(s) g11i(s)
FIGURE CS3.8
Loop shaping of controller g
s
i
11( ). L0_11(s) = p11(s) g
s
i
11( ).
5
QFTCT
0
–5
–10
–15
Magnitude (dB)
–20
–25
–30
–35
–40
10–7
10–6
10–5
Frequency (rad/s)
10–4
δup
p11 g11i f11/(1 + p11 g11i)
δlo
FIGURE CS3.9
Design of prefilter f11(s) for p11(s) and g
s
i
11( ).

352
Case Study 3: Wastewater Treatment Plant Control
The element g
s
i
22( ) is also designed by means of the standard SISO QFT loop-shaping 
technique, for the plant p22(s), and for the control specifications described in Equations 
CS3.8 through CS3.12. The QFT bounds and the loop shaping for g
s
i
22( ) are shown in Figure 
CS3.11. The expression found for the controller g
s
i
22( ) is also a PI, so that
	
g
s
s
s
i
22
5
1 5
1
4 5
10
1
( )
.
.
=
−
×
+






−
	
(CS3.15)
10
QFTCT
(a)
(b)
Worst case at each frequency
QFTCT
0
–10
–20
–30
–40
–50
1.2
1
0.8
0.6
0.4
0.2
0
δup
δlo
δop
Magnitude (dB)
10–7
Frequency (rad/s)
10–5
10–6
10–4
10–3
0
0.5
1
Time (s)
1.5
2
×105
up to 2e-5 rad/s
FIGURE CS3.10
Analysis of controller g
s
i
11( ) and prefilter f11(s) for p11(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup, δlo.
QFTCT
60
80
1e-7 rad/s
40
20
0
Open-loop gain (dB)
–20
–40
–260 –240 –220 –200 –180
Open-loop phase (deg)
–160 –140 –120 –100 –80
–60
L022(s) = p22(s) g22i(s)
FIGURE CS3.11
Loop shaping of controller g
s
i
22( ). L0_22(s) = p22(s) g
s
i
22( ).

353
Case Study 3: Wastewater Treatment Plant Control
The f22(s) prefilter element is designed for the plant p22(s) and the controller g
s
i
22( ). 
Figure CS3.12 shows the design. The expression for the prefilter f22(s) is
	
f
s
s
22
5
1
1
3 2
10
1
( )
.
=
×
+






−
	
(CS3.16)
Figure CS3.13 shows the analysis of the disturbance rejection at the output of the plant 
and the reference tracking specifications, both for the plant p22(s) with the controller 
g
s
i
22( ) and the prefilter f22(s). When considering no coupling (p12 = p21 = 0), the second 
channel of the SISO control system meets the specifications for all the p22(s) plants within 
the uncertainty.
CS3.5.2  MIMO QFT Control, Method 2
In the next subsections, we follow the flow chart and steps presented in Figure 8.31 for the 
design of a MIMO QFT controller according to Method 2. See also Sections 8.6 and 8.9 for 
more details.
Step A:  Controller Structure
Figure CS3.14 shows the MIMO QFT Method-2 controller structure for the WWTP. It is 
­composed of a 2 × 2 full matrix Gα, a 2 × 2 diagonal matrix Gβ and a 2 × 2 diagonal pre­
filter matrix F.
5
QFTCT
0
–5
–10
–15
Magnitude (dB)
–20
–25
–30
–35
–40
10–7
10–6
10–5
Frequency (rad/s)
10–4
δup
δlo
p22 g22i  f22/(1 + p22 g22i)
FIGURE CS3.12
Design of prefilter f22(s) for p22(s) and g
s
i
22( ).

354
Case Study 3: Wastewater Treatment Plant Control
Step B:  Design of 2 × 2 Full Matrix Gα Controller
As discussed in Section 8.6.2, the fully populated matrix controller G is composed of two 
matrices: G = GαGβ , so that
	
G
G G
=
=






α
β
α
α
α
α
β
β
g
s
g
s
g
s
g
s
g
s
g
11
12
21
22
11
22
0
0
( )
( )
( )
( )
( )
(( )s





	
(CS3.17)
The main objective of the pre-compensator Gα is to diagonalize the plant P as much as 
possible. As discussed in Sections 8.6 and 8.9, the expression used to calculate Gα is based on
	
G
P
P
α
α
α
α
α
( )
( )
( )
( )
( )
( )
(
s
g
s
g
s
g
s
g
s
s
s
=






=
−
11
12
21
22
1
diag
)
( )
( )
( )
( )
( )
( )
*
*
*
*
=









p
s
p
s
p
s
p
s
p
s
p
s
11
12
21
22
11
22
0
0




	
(CS3.18)
where the plant matrix P, the corresponding inverse P–1, and the diagonal Pdiag are selected 
so that the expression of the extended matrix Px = P Gα presents the closest form to a 
diagonal matrix, nulling the off-diagonal terms as much as possible.
10
QFTCT
(a)
(b)
QFTCT
0
–10
–20
–30
–40
–50
1.2
1
0.8
0.6
0.4
0.2
0
δup
δlo
Magnitude (dB)
10–7
Frequency (rad/s)
10–5
10–6
10–4
10–3
0
0.5
1
Time (s)
1.5
2
×105
Up to 2e-5 rad/s
Worst case at each frequency
δop
FIGURE CS3.13
Analysis of controller g
s
i
22( ) and prefilter f22(s) for p22(s). (a) Disturbance rejection at plant output: δop. 
(b) Reference tracking: δup, δlo.
y2(s)
r2(s)
g11(s)
g22(s)
β
–
–
r1(s)
p11(s)
p12(s)
p21(s)
p22(s)
f11(s)
f22(s)
y1(s)
u1(s)
u2(s)
β
g11(s)
α
g12(s)
α
g21(s)
α
g22(s)
α
FIGURE CS3.14
MIMO QFT control system for the WWTP. Method 2.

355
Case Study 3: Wastewater Treatment Plant Control
The Bode diagrams for the four expressions p
s
p
s p
s
p
s p
s
p
s
11
11
12
22
21
11
*
*
*
( )
( ),
( )
( ),
( )
( ),
×
×
×
 
and p
s
p
s
22
22
* ( )
( )
×
, including all the model uncertainty, are shown in Figures CS3.15 
through CS3.18, respectively. The controller elements g
s
11
α ( ), g
s
12
α ( ), g
s
21
α ( ), and g
s
22
α ( ) are 
calculated as the transfer function that matches the mean value of the respective Bode 
diagram  at  low  frequencies and then filters out the dynamics before the nmp zero at 
−2 × 10–4 rad/s—see also Equations CS3.19 through CS3.22, respectively.
0
Pin v Pdiag (1:end).tfm(1,1) and g11-α
g11
–2
–4
Magnitude (dB)
–6
–8
–10
180
90
0
Phase (deg)
–90
10–5
10–4
Frequency (rad/s)
α
g11
α
FIGURE CS3.15
Controller element g
s
11
α ( ) and p
s
p
s
11
11
* ( )
( )
×
.
–65
Pin v Pdiag (1:end).tfm(1,2) and g12-α
–70
–75
Magnitude (dB)
180
135
Phase (deg)
90
10–5
10–4
10–3
Frequency (rad/s)
g12
α
g12
α
FIGURE CS3.16
Controller element g
s
12
α ( ) and p
s
p
s
12
22
∗( )
( )
×
.

356
Case Study 3: Wastewater Treatment Plant Control
62
Pin v Pdiag (1:end).tfm(2,1) and g21-α
g12
α
g12
α
60
58
56
Magnitude (dB)
180
90
0
Phase (deg)
–90
10–5
10–4
10–3
Frequency (rad/s)
FIGURE CS3.17
Controller element g
s
21
α ( ) and p
s
p
s
21
11
* ( )
( )
×
.
180
90
0
Phase (deg)
–90
10–5
10–4
10–3
Frequency (rad/s)
0
Pin v Pdiag (1:end).tfm(2,2) and g22-α
g22
α
g22
α
–2
–4
Magnitude (dB)
–6
–8
FIGURE CS3.18
Controller element g
s
22
α ( ) and p
s
p
s
22
22
* ( )
( )
×
.

357
Case Study 3: Wastewater Treatment Plant Control
	
g
s
s
11
0 9439
7143
1
α ( )
.
=
+
	
(CS3.19)
	
g
s
s
12
0 0001858
7143
1
α ( )
.
= −
+
	
(CS3.20)
	
g
s
s
21
1382
7143
1
α ( ) =
+
	
(CS3.21)
	
g
s
s
22
0 9439
7143
1
α ( )
.
=
+
	
(CS3.22)
Step C.1.1:  Design of the Diagonal Controller g
s
11
β ( )
The element g
s
11
β ( ) is designed by means of the standard SISO QFT loop-shaping ­technique, 
for the inverse of the extended equivalent plant qx11(s) = [p11
x*e]1
−1, and for the control 
­specifications described in Equations (CS3.8 through CS3.12). According to the iterative 
expression Equation 8.97, the extended equivalent plant is
	
p
s
p
s
x e
x
11
1
11
*
*
( )
( )
=
	
(CS3.23)
and the plant to be controlled by g
s
11
β ( )
	
q
s
p
s
x
x e
11
11
1
1
( )
( )
*
=
	
(CS3.24)
The MATLAB code that calculates the plant qx11(s) for all the cases within the paramet­
ric uncertainty is similar to the one included in Appendix 8, Example 8.1, and Section 8.9 
(QFT MIMO Method 2). The QFT bounds and the loop shaping for g
s
11
β ( ) are shown in 
Figure CS3.19. The expression found for the controller g
s
11
β ( ) is
	
g
s
s
s
11
5
5
0 0008
1
5
10
1
1
9
10
1
1
0
β ( )
.
.
=
−
×
+






×
+






−
−
00014
1
1
0 0003
1
1
0 0009
1
s
s
s
s
+






+






+






.
.

+






+






1
0 04
1
1
0 2
1
2
.
.
s
s
	
(CS3.25)
The design also fulfils the two stability conditions:
	
a.	 Lx0_11(s) = qx11(s) g
s
11
β ( ) satisfies the Nyquist encirclement condition and
	
b.	 There are no RHP pole-zero cancellations between qx11(s) and g
s
11
β ( ).
This is checked following to the methodology presented in Chapter 3, Section 3.4, 
with  the QFT Control Toolbox (QFTCT), Controller design window, File, Check stability 
option.

358
Case Study 3: Wastewater Treatment Plant Control
Step C.1.2:  Design of the Diagonal Prefilter f11(s)
The f11(s) prefilter element is designed for the equivalent plant qx11(s) and the diagonal 
controller g
s
11
β ( ) designed in the previous Step C.1.1. Figure CS3.20 shows the design. 
The expression found for the prefilter f11(s) is
	
f
s
s
11
5
1
1
3 2
10
1
( )
.
=
×
+






−
	
(CS3.26)
Figure CS3.21 shows the analysis of the disturbance rejection at the output of the plant 
and the reference tracking specifications for the equivalent plant qx11(s) and with the 
­controller g
s
11
β ( ) and the prefilter f11(s). The control system meets the specifications with 
qx11(s) in all cases within the uncertainty.
Step C.2.1:  Design of the Diagonal Controller g
s
22
β ( )
The element g
s
22
β ( ) is designed by means of the standard SISO QFT loop-shaping tech­
nique, for the inverse of the extended equivalent plant qx22(s) = [p22
x*e]2
−1, and for the ­control 
specifications described in Equations CS3.8 through CS3.12. According to the iterative 
expression Equation 8.97, the extended equivalent plant is
	
p
s
p
s
p
s
p
s
p
s
g
s
x e
x
x
x
x
22
2
22
1
21
1
12
1
11
1
11
*
*
*
*
*
( )
( )
( )
( )
( )
( )
=
−
+
β
	
(CS3.27)
and the plant to be controlled by g
s
22
β ( )
90
80
70
60
50
40
30
20
10
0
–10
QFTCT
1e-7 rad/s
Open-loop gain (dB)
–240 –220 –200 –180
Open-loop phase (deg)
–160 –140 –120 –100
–80
–60
Lx011(s) = qx11(s) g11b(s)
FIGURE CS3.19
Loop shaping of controller g
s
11
β ( ). Lx0_11(s) = qx11(s) g
s
11
β ( ).

359
Case Study 3: Wastewater Treatment Plant Control
5
0
–5
–10
–15
Magnitude (dB)
–20
–25
–30
–35
–45
–40
10–7
10–6
10–5
Frequency (rad/s)
10–4
10–3
QFTCT
δup
qx11 g11b  f11/(1 + qx11 g11b)
δlo
FIGURE CS3.20
Design of prefilter f11(s) for qx11(s) and g
s
11
β ( ).
10
QFTCT
(a)
(b)
QFTCT
0
–10
–20
–30
–40
–50
1.2
1
0.8
0.6
0.4
0.2
0
δup
δlo
Magnitude (dB)
10–7
Frequency (rad/s)
10–5
10–6
10–4
10–3
0
0.5
1
Time (s)
1.5
2
×105
Worst case at each frequency
δop
Up to 2e-5 rad/s
FIGURE CS3.21
Analysis of controller g
s
11
β ( ) and prefilter f11(s) for qx11(s). (a) Disturbance rejection at plant output: δop. 
(b) Reference tracking: δup, δlo.

360
Case Study 3: Wastewater Treatment Plant Control
	
q
s
p
s
x
x e
22
22
2
1
( )
( )
*
=
	
(CS3.28)
The MATLAB code that calculates the plant qx22(s) for all the cases within the paramet­
ric uncertainty is similar to the one included in Appendix 8, Example 8.1, and Section 8.9 
(QFT MIMO Method 2). The QFT bounds and the loop shaping for g
s
22
β ( ) are shown in 
Figure CS3.22. The expression for the controller g
s
22
β ( ) is
	
g
s
s
s
s
22
5
3
0 52
1
5
10
1
1
0 001
1
1
0 0
β ( )
.
.
.
=
−
×
+






+






−
013
1
2
s+





	
(CS3.29)
The design also fulfils the two stability conditions:
	
a.	 Lx0_22(s) = qx22(s) g
s
22
β ( ) satisfies the Nyquist encirclement condition, and
	
b.	 There are no RHP pole-zero cancellations between qx22(s) and g
s
22
β ( ).
This is checked following to the methodology presented in Chapter 3, Section 3.4, with 
the QFT Control Toolbox (QFTCT), Controller design ­window, File, Check stability option.
Step C.2.2:  Design of the Diagonal Prefilter f22(s)
The f22(s) prefilter element is designed for the equivalent plant qx22(s) and the diagonal 
controller g
s
22
β ( ) designed in the previous Step C.2.1. Figure CS3.23 shows the design. 
The expression found for the prefilter f22(s) is
QFTCT
60
80
1e-7 rad/s
40
20
0
Open-loop gain (dB)
–20
–40
–250
–200
Open-loop phase (deg)
–150
–100
Lx022(s) = qx22(s) g22b(s)
FIGURE CS3.22
Loop shaping of controller g
s
22
β ( ). Lx0_22(s) = qx22(s) g
s
22
β ( ).

361
Case Study 3: Wastewater Treatment Plant Control
	
f
s
s
22
5
1
1
3 2
10
1
( )
.
=
×
+






−
	
(CS3.30)
Figure CS3.24 shows the analysis of the disturbance rejection at the output of the plant 
and the reference tracking specifications for the equivalent plant qx22(s) and with the con­
troller g
s
22
β ( ) and the prefilter f22(s). The control system meets the specifications with qx22(s) 
in all cases within the uncertainty.
(a) Disturbance rejection at plant output: δop. (b) Reference tracking: δup, δlo.
Step D:  Final Checks
D.1. The design also fulfils the other additional two stability conditions:
•	 No Smith-McMillan pole-zero cancellations occur between P(s) and G(s), and
•	 No Smith-McMillan pole-zero cancellations occur in |P*(s) + G(s)|.
D.2. The final system P(s)G(s) does not have any additional RHP transmission zero.
5
0
–5
–10
–15
Magnitude (dB)
–20
–25
–30
–35
–40
10–7
10–6
10–5
Frequency (rad/s)
10–4
10–3
QFTCT
δup
qx22 g22b f22/(1 + qx22 g22b)
δlo
FIGURE CS3.23
Design of prefilter f22(s) for qx22(s) and g
s
22
β ( ).

362
Case Study 3: Wastewater Treatment Plant Control
CS3.6  Analysis and Validation
This section presents the time-domain analysis of the controllers designed in this 
case study. The analysis includes the simulation of the complete MIMO ASP-WWTP with 
both the SISO solution (Section CS3.5.1) and the MIMO QFT solution (Section CS3.5.2).
Figure CS3.25 shows the time-domain simulation of the two outputs, y1(s) = NH4 and 
y2(s) = NO3, of the MIMO nominal plant P0(s) = [p11(s) p12(s); p21(s) p22(s)], Equations CS3.3 
and CS3.4.
We introduce two reference inputs, r1(s) and r2(s), and two external disturbances, d1(s) and 
d2(s) in the system. The reference inputs start at a polluted water level and change to the 
level required by the standards, that is NH4 r1(s) from 2 g/m3 to 1 g/m3 at 2 × 106 s and NO3 
r2(s) from 8 g/m3 to 4 g/m3 at 3 × 106 s—see dashed lines in the figure.
The external disturbances introduce a significant step increase of the concentration of 
NH4 and NO3, respectively, in the water, with d1(s) from 0 to 0.5 g/m3 at 4 × 106 s and d2(s) 
from 0 to 2 g/m3 at 5 × 106 s.
The results with the SISO controllers are represented by the dotted lines. They use the 
control structure shown in Figure CS3.7, and the expressions for g
s
i
11( ), g
s
i
22( ), f11(s), and 
f22(s) in Equations CS3.13, CS3.15, CS3.14, and CS3.16, respectively.
The results with the MIMO QFT controller are represented by the solid lines. They use the 
control structure shown in Figure CS3.14, and the expressions for G = Gα Gβ in Equations 
CS3.19 through CS3.22, CS3.25, and CS3.29, and for F = [f11(s) 0; 0 f22(s)] in Equations CS3.26 
and CS3.30.
The independent SISO controllers achieve a good performance. The MIMO control­
ler improves the results, reducing significantly the effect of the coupling between the 
control loops.
10
QFTCT
(a)
(b)
QFTCT
0
–10
–20
–30
–40
–50
δup
δlo
Magnitude (dB)
10–7
Frequency (rad/s)
10–5
10–6
10–4
10–3
0
0.5
1
Time (s)
1.5
2
×105
Up to 2e-5 rad/s
Worst case at each frequency
δop
1.2
1
0.8
0.6
0.4
0.2
0
FIGURE CS3.24
Analysis of controller g
s
22
β ( ) and prefilter f22(s) for qx22(s). (a) Disturbance rejection at plant output: δop. (b) Reference 
tracking: δup, δlo.

363
Case Study 3: Wastewater Treatment Plant Control
CS3.7  Summary
This case study has designed a robust 2 × 2 MIMO QFT control system for a wastewa­
ter treatment plant (WWTP) with an activated sludge process (ASP) that simultaneously 
reduces the concentration of ammonia (NH4) and nitrates (NO3) in the plant effluent. The 
design considers the model uncertainty and MIMO loop interaction. It accomplishes four 
simultaneous control objectives:
•	 Stability
•	 Reference tracking
•	 Rejection of unpredictable disturbances and
•	 Minimization of loop interaction
2.5
(a)
(b)
d1 (step)
d2 (step)
r1 (step)
r2 (step)
MIMO control
MIMO control
SISO control
MIMO control
MIMO control
×106
SISO control
SISO control
SISO control
2
1.5
1
r1, y1
0.5
0
9
8
7
6
r2, y2
5
3
4
1.5
2
2.5
3
3.5
4
4.5
5
5.5
6
×106
1.5
2
2.5
3
3.5
Time (s)
4
4.5
5
5.5
6
FIGURE CS3.25
MIMO WWTP. SISO controllers (dotted line), MIMO controller (solid line), references (dashed line). 
(a) 1st ­channel NH4, (b) 2nd channel NO3.


365
Case Study 4: Radio-Telescope Control
CS4.1  Description
Radio astronomy is a young scientific field. It was born by serendipity in 1931, when Karl 
Jansky, a physicist and radio engineer at Bell Telephone Laboratories, built an antenna to 
study the properties of 20.5 MHz radio waves for use in transatlantic telephone services. 
While recording signals from all directions, Jansky found a unique radiation repeated 
every 23 h and 56 min, which is the period of the Earth’s rotation relative to the stars 
(sidereal day), instead of 24 h (solar day). Based on this unexpected observation, Jansky 
concluded that the radio signals came from the Milky Way, and radio astronomy was 
born.366
Since then, many radio telescopes have been built, and thousands of new astronomical 
discoveries have changed our understanding of the universe. One of the most prominent 
facilities is the Robert C. Byrd Green Bank Telescope, or GBT (WV). It is the world’s largest 
single-dish fully steerable radio telescope, operating at meter to millimeter wavelengths 
(0.1–116 GHz)—see Figure CS4.1. It has an enormous 100 × 110 m elliptical collecting area, 
an unblocked aperture, a 148 m structure, and an excellent surface accuracy with over 2200 
actuators.
The telescope is driven in the azimuth axis by 16 motors, each of 30 hp, coupled together 
in four trucks. In the elevation axis, there are eight motors, each of 40 hp. All motors are 
preloaded to remove backlash. The telescope has an off-axis geometric focus, with a feed 
arm and a sub-reflector, as shown in Figure CS4.2.
This case study presents the design of the velocity and position cascade control loops 
for the azimuth axis of a radio telescope similar to GBT. Coincidentally, the author has 
worked with National Radio Astronomy Observatory (NRAO) engineers on the design of 
advanced control solutions for the azimuth, elevation, and sub-reflector servo systems of 
GBT for a number of years.
In the following sections, we model and analyze the dynamics of the radio telescope, 
propose a set of stability and performance specifications, design the velocity and position 
cascade control systems, improve the results with a nonlinear dynamic control (NDC) 
strategy, and validate them in both frequency and time domains.
CS4.2  Plant Model
Figure CS4.2 shows the diagram for the azimuth axis of the radio telescope. The model 
considers four degrees of freedom: the angular displacement of the dish θd(t), the angular 
displacement of the central base of the structure θb(t), the angular displacement of each 

366
Case Study 4: Radio-Telescope Control
FIGURE CS4.1
Green Bank Telescope (GBT), NRAO, West Virginia.
Jd
θd
θb
θm
θw
θt
Tw
Ks
Bs
Main dish
Wind
Jb
Jm
Jt
Jw
Kb
Bb
Km
Bm
Motor
and
gearbox
Tm
Wheel
Truck 1
Lower structure
Truck 3
Truck 2
Truck 4
Upper structure
rb
rw
Arm
Azimuth
track
Feed arm
Sub-reﬂector
Radio-frequency waves
FIGURE CS4.2
Radio-telescope diagram. Azimuth model description.

367
Case Study 4: Radio-Telescope Control
truck system θt(t), and the angular displacement of each motor θm(t). The main variables 
and parameters of the system are the following:
Inputs
•	 Tw: aerodynamic torque applied by the wind on the dish and structure, [Nm]
•	 Tm equivalent torque applied by the four motors of each truck, [Nm]
Outputs
•	 θd: dish angular position, [rad]
•	 θb: base (lower structure) angular position, [rad]
•	 θt: truck angular position, [rad]
•	 θw: truck wheel angular position, θw = θt (rb/rw) [rad]
•	 θm: motor shaft angular position at the gearbox output, [rad]
Parameters
•	 N: number of truck systems. Each truck is composed of one arm and a drive-train 
system (with one equivalent motor, gearbox, brake, shaft, and pinion), [-]
•	 rb: radius of the arm between the lower structure and each truck, [m]
•	 rw: radius of the equivalent truck wheel, [m]
•	 R: radius rate, R = rb/rw, [-]
•	 Jd: moment of inertia of dish, feed arm, and upper structure, at θd, [kg m2]
•	 Jb: moment of inertia of lower structure, at θb, [kg m2]
•	 Jt: moment of inertia of each truck, at θt, [kg m2]
•	 Jw: moment of inertia of each equivalent truck wheel, at θw, [kg m2]
•	 Jm: moment of inertia of each equivalent motor with its brake, gearbox, and shaft, 
at θm, [kg m2]
•	 Ks: upper structure torsional stiffness coefficient, [Nm]
•	 Bs: upper structure torsional damping coefficient, [Nms]
•	 Kb: one arm torsional stiffness coefficient, [Nm]
•	 Bb: one arm torsional damping coefficient, [Nms]
•	 Km: one motor shaft torsional stiffness coefficient, [Nm]
•	 Bm: one motor shaft torsional damping coefficient, [Nms]
As in previous cases, we start with the general equation of motion for the mechanical 
system, which is
	
M
C
K
Q



q
q
q
q q u
+
+
=
(
, , )
,
t 	
(CS4.1)
where ℳ, C, and K are the Mass, Damping, and Stiffness matrices, Q the matrix of inputs, 
q the vector of generalized coordinates, and u the vector of inputs. Also, we consider the 
general form of the Euler–Lagrange equation,
	
d
dt
L
q
L
q
D
q
Q
i
n
L
E
i
i
d
i
i
k
∂
∂





−∂
∂
+ ∂
∂
=
=
=
−


,
, ,...,
1 2
and
Ep
	
(CS4.2)

368
Case Study 4: Radio-Telescope Control
where qi are the generalized coordinates or degrees of freedom of the system, Qi the gen­
eralized forces applied to each subsystem “i”, Ek and Ep the kinetic and potential energies, 
Dd the dissipator co-content, and L the Lagrangian.236
The generalized coordinates for the radio telescope are the angular displacement of the 
dish θd(t), the angular displacement of the central base of the structure θb(t), the angu­
lar displacement of each truck system θt(t), and the angular displacement of each motor 
θm(t), which are, respectively: q1 = θd(t), q2 = θb(t), q3 = θt(t), and q4 = θm(t)—see Figure CS4.2. 
The azimuth-axis displacement contains the kinetic, potential, and dissipative functions 
described by Equations CS4.3 through CS4.5. Notice that we consider linear dissipators, 
which means that the Dd expression or dissipator co-content equals one-half of the power 
being absorbed by the dissipators.236
	
E
J
J
N J
N J
R
N J
k
d
d
b
b
t
t
w
t
m
m
=
+
+
+
+
1
2
1
2
1
2
1
2
1
2
2
2
2
2
2





θ
θ
θ
θ
θ
(
)
	
(CS4.3)
	
E
K
N K
N K
R
p
s
d
b
b
b
t
m
t
m
=
−
+
−
+
−
1
2
1
2
1
2
2
2
2
(
)
(
)
(
)
θ
θ
θ
θ
θ
θ
	
(CS4.4)
	
D
B
N B
N B
R
d
s
d
b
b
b
t
m
t
m
=
−
+
−
+
−
1
2
1
2
1
2
2
2
2
(
)
(
)
(
)






θ
θ
θ
θ
θ
θ
	
(CS4.5)
The generalized forces applied to the radio telescope are the aerodynamic torque applied 
by the wind on the dish and upper structure Tw(t), and the torque applied by the N trucks, 
N Tm(t). Now, using Equations CS4.3 through CS4.5, the terms for the Euler–Lagrange 
equation are
	
d
dt
L
q
d
dt
E
E
E
E
i
k
d
k
b
k
t
k
m
∂
∂





=
∂
∂
∂
∂
∂
∂
∂
∂








θ
θ
θ
θ




=
+
J
J
N J
R J
N J
d
b
t
w
m
0
0
0
0
0
0
0
0
0
0
0
0
2
(
)












=





θ
θ
θ
θ
d
b
t
m
ℳq
	
(CS4.6)
−∂
∂
= ∂
∂
=
∂
∂
∂
∂
∂
∂
∂
∂






L
q
E
q
E
E
E
E
i
p
i
p
d
p
b
p
t
p
m
θ
θ
θ
θ

=
−
−
+
−
−
+
−
−
K
K
K
K
N K
N K
N K
N K
R K
N RK
s
s
s
s
b
b
b
b
m
m
0
0
0
0
0
0
2
(
)
N RK
N K
m
m
d
b
t
m












=
θ
θ
θ
θ
K q
	
(CS4.7)

369
Case Study 4: Radio-Telescope Control
	
∂
∂
=
∂
∂
∂
∂
∂
∂
∂
∂






D
q
D
D
D
D
d
i
d
d
d
b
d
t
d
m





θ
θ
θ
θ

=
−
−
+
−
−
+
−
−
B
B
B
B
N B
N B
N B
N B
R B
N RB
N R
s
s
s
s
b
b
b
b
m
m
0
0
0
0
0
0
2
(
)
B
N B
m
m
d
b
t
m












=




θ
θ
θ
θ
C q
	
(CS4.8)
	
Q
R
=











=
1
0
0
0
0
0
0
N
T
T
w
m
u
	
(CS4.9)
Rearranging the equation of motion Equation CS4.1 as
	


q
q
q
u
= −
−
+
−
−
−
M
C
M
K
M
R
1
1
1
	
(CS4.10)
and using Equations CS4.6 through CS4.9, we find a state space description of the system 
( x
Ax
Bu
=
+
;y
Cx
=
) with the expressions
	
x
I
0
x
0
u
y
C x
=
−
−






+






=
−
−
−
M
C
M
K
M
R
1
1
1
	
(CS4.11)
with I = [1 0 0 0; 0 1 0 0; 0 0 1 0; 0 0 0 1], 0 = [0 0 0 0; 0 0 0 0; 0 0 0 ; 0 0 0 0], and,
	
A =
−
−
−
+
−
+
B
J
B
J
K
J
K
J
B
J
B
N B
J
N B
J
K
J
K
N K
s
d
s
d
s
d
s
d
s
b
s
b
b
b
b
s
b
s
b
0
0
0
0
0
(
)
(
)
J
N K
J
B
J R
J
B
R B
J R
J
RB
J R
J
K
J R
J
b
b
b
b
w
t
b
m
w
t
m
w
t
b
w
t
0
0
0
2
2
2
2
2
+
−
+
+
+
+
−
(
)
(K
R K
J R
J
RK
J R
J
RB
J
B
J
RK
J
K
J
b
m
w
t
m
w
t
m
m
m
m
m
m
m
m
+
+
+
−
−
2
2
2
0
0
0
0
1
0
0
0
0
0
0
0
)
0
1
0
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
1
0
0
0
0





	
(CS4.12)

370
Case Study 4: Radio-Telescope Control
	
B =






1
0
0
0
0
0
0
1
0
0
0
0
0
0
0
0
J
J
d
m
	
(CS4.13)
	
C =






0
0
0
1
0
0
0
0
0
0
0
0
1
0
0
0 	
(CS4.14)
	
x
q
q
=





=





[
]
θ
θ
θ
θ
θ
θ
θ
θ
d
b
t
m
d
b
t
m
T
	
(CS4.15)
	
u = [
]
T
T
w
m
T
	
(CS4.16)
	
y = [
]
θ
θ
m
d
T
	
(CS4.17)
Now, applying P
C I
A
B
( )
(
)
s
s
=
−
−1
 for y
P
u
( )
( ) ( )
s
s
s
=
, the transfer matrix from the two 
independent inputs to the two outputs of interest is
	
θ
θ
m
d
w
m
s
s
s T
s
T
s
( )
( )
( )
( )
( )






=






×
P2 2
	
(CS4.18)
where the velocity of the motors dθm(s)/dt = θ’m(s) and the dish angular position θd(s), from 
both the wind torque Tw(s) and the motor torque Tm(s), are
	
θm
w
m
s
p
s T
s
p
s T
s
( )
( )
( )
( )
( )
=
+
11
12
	
(CS4.19)
	
θd
w
m
s
p
s T
s
p
s T
s
( )
( )
( )
( )
( )
=
+
21
22
	
(CS4.20)
Figure CS4.3 graphically shows the motor speed θ’m(s), position θm(s), and dish dis­
placement θd(s) as a function of the motor and wind torques, Tm(s) and Tw(s), according to 
Equations CS4.19 and CS4.20. In addition, the figure also shows the cascade control servo 
system, with the velocity controller Gv(s) and the position controllers, Gp(s) and Fp(s), all to 
be designed in the next sections.

371
Case Study 4: Radio-Telescope Control
Parameters and Parametric Uncertainty
The parameters for the model of the radio telescope considered in this case study are 
shown in Table CS4.1. They are based on the results published in Reference 365 about the 
NRAO-GBT. The parameters with uncertainty are the inertia of the dish and upper struc­
ture, which changes with the variation of the elevation-axis angle, and the three damping 
coefficients, so that
	
Jd ∈[
]×
86 7 117 3
106
2
. ,
.
 
kg m 	
(CS4.21)
	
Bs ∈
×


54 8 74 2
106
. ,
.
Ns/m 	
	
Bb ∈
×
[
]
2 66 3 59
105
.
,
.
/
 
Ns
m 	
	
Bm ∈[
]
233 67 316 14
.
,
.
 
Ns/m 	
TABLE CS4.1
Radio Telescope Parameters (Nominal Case)
Radio-telescope weight [kg]
3.85×106
Ld (dish dimensions) [m]
100×110
Sensitivity radio freq. [GHz]
0.1 to 116
h (total height) [m]
148
N—number of azimuth tracks
4
R—radius ratio rb / rw
50
Jd [kg m2]—dish, f.a., up.struct.
102×106
Jb [kg m2]—lower structure
34.3×106
Jw [kg m2]—equiv wheel, truck
426
Jm [kg m2]—equiv. motor, truck
517.56
Jt [kg m2]—equiv truck system
3.43×106
M(s)—motor dynamics
1
Ks [N/m]—upper structure
1.9731×109
Bs [Ns/m]—upper structure
4.4862×106
Kb [N/m]—lower structure
94.9×106
Bb [Ns/m]—lower structure
3.1249×105
Km [N/m]—motor shaft
1.6851×106
Bm [Ns/m]—motor shaft
274.89
Hv—feedback dynamics
1
Hp—feedback dynamics
1
Position
control
Velocity
control
+
p11(s)
p12(s)
p21(s)
p22(s)
+
+
+
+
+
+
+
+
+
–
–
Tw(s)
Tm(s)
θd(s)
θ ′m(s)
θm(s)
Hν(s)
nν(s)
Gν(s)
M(s)
Gp(s)
Hp(s)
θ dRef(s)×R =
θ mRef(s)
θ ′mRef(s)
np(s)
Fp(s)
1
s
FIGURE CS4.3
Block diagram representation of the radio-telescope dynamics and velocity/position control servo systems.

372
Case Study 4: Radio-Telescope Control
Frequencies
Figures CS4.4 through CS4.6 show the Bode diagrams for the transfer functions p11(s), p12(s), 
p21(s), and p22(s). We select an array of frequencies of interest based on this information—see 
Equation CS4.22. Notice that we include frequencies that represent the resonances (peaks) 
that appear in the diagrams, and which represent the flexible modes of the radio tele­
scope for upper structure and feed-arm torsion, lower structure and truck-arm torsion, 
and motor shaft torsion.
	
ω = [ .
.
.
.
.
]
0 01 0 05 0 1 0 5 1 1 5 2 3 4 5 10 50 60 65 70 100 500
 
 
 
  
     
 
 
 
 
 
 
rrad/s 	
(CS4.22)
–225
–180
–135
–90
–45
0
–180
–160
–140
–120
–100
–80
–60
–40
–20
0
20
 –120 dB
 –140 dB
 –160 dB
 –180 dB
 –100 dB
 –80 dB
 –60 dB
 –40 dB
 –20 dB
 –12 dB
 –6 dB
 –3 dB
 –1 dB
 0.5 dB
 1 dB
 3 dB
 6 dB
Nichols chart
Open-loop phase (deg)
Open-loop gain (dB)
p12-0(s)
Magnitude (dB)
–150
–100
–50
Phase (deg)
–180
–135
–90
–45
0
Bode diagram
Frequency (rad/s)
p12-0(s)
10–1
100
103
102
101
FIGURE CS4.5
Bode diagram and Nichols diagram of p12-0(s).
Magnitude (dB)
–250
–200
–150
–100
–50
10–1
100
101
102
Phase (deg)
–720
–540
–360
–180
0
180
Bode diagram
Frequency (rad/s)
p12-0(s)
p11-0(s)
p22-0(s)
p21-0(s)
p12-0(s)
p21-0(s)
p11-0(s)
p22-0(s)
FIGURE CS4.4
Bode diagram, nominal plants: p11-0(s), p12-0(s), p21-0(s), and p22-0(s).

373
Case Study 4: Radio-Telescope Control
Nominal Plant
The nominal plant for all, p11-0(s), p12-0(s), p21-0(s), and p22-0(s), is selected according to the fol­
lowing parameters within the uncertainty:
	
Jd =
×
102
106
2
kgm 	
(CS4.23)
	
Bs =
×
4 4862
106
.
m
Ns/
	
	
Bb =
×
3 1249
105
.
Ns/m 	
	
Bm = 274 89
.
Ns/m 	
CS4.3  Preliminary Analysis
Before starting the design of the controllers, we conduct a preliminary analysis of the 
dynamics of the radio telescope. Figure CS4.4 shows the Bode diagram of the nominal four 
plants: p11-0(s), p12-0(s), p21-0(s), and p22-0(s).
The plants p11(s) and p12(s) describe, respectively, the effect of torque applied by the wind 
Tw(s) and the torque applied by the motor Tm(s) on the motor speed θ’m(s). Both transfer 
functions are system-type 1, that is, they have one integrator.
The plants p21(s) and p22(s) describe, respectively, the effect of torque applied by the wind 
Tw(s) and the torque applied by the motor Tm(s) on the dish position θd(s). Both transfer func­
tions are system-type 2, that is, they have two integrators.
All the plants contain three resonance modes—see Figures CS4.4. The first one, at 
ω = 4.1 rad/s (0.65 Hz), represents the vibration of the dish, feed arm, and upper 
100
101
102
Magnitude (dB)
–130
–120
–110
–100
–90
–80
–70
–60
–50
–40
Bode diagram
Frequency (rad/s)
p12(s)
FIGURE CS4.6
Bode diagram (magnitude) of p12(s) with ±15% of uncertainty on Jd, Bs, Bb, and Bm.

374
Case Study 4: Radio-Telescope Control
structure in the azimuth direction (θd). The second mode, at ω = 9.35 rad/s (1.49 Hz), 
represents the vibration of the lower structure and arms in the azimuth direction (θb), 
and the third mode, at ω = 64.8 rad/s (10.31 Hz), represents the vibration of the shaft of 
the motors (θm).
The main plant to be controlled is p12(s), which is the transfer function from the truck 
equivalent motor torque to the motor velocity θ’m(s)/Tm(s)—see Figure CS4.3. The resonance 
modes of p12(s) limit the potential bandwidth of the control system, which will be below 
these modes to reduce the vibration of the dish and feed arm at these frequencies—see 
Figures CS4.5 and CS4.6.
CS4.4  Azimuth Axis. Velocity Control
Figure CS4.3 shows the cascade control diagram for the telescope azimuth-axis servo sys­
tem. It is composed of two control loops: an inner loop, which is the velocity (rate) control 
system, and an outer loop, which is the position control system. In this section, we design 
the inner controller: Gv(s).
CS4.4.1  QFT Templates
Figure CS4.7 shows the QFT templates for p12(s), which is the main plant of the velocity 
control loop. They are calculated using the model and uncertainty defined in Equations 
CS4.18 and CS4.21, and the array of frequencies defined in Equation CS4.22.
Open-loop phase (deg)
–300
–250
–200
–150
–100
–50
Open-loop magnitude (dB)
–120
–110
–100
–90
–80
–70
–60
–50
–40
0.01
0.05
0.1
0.5
1
1.5
2
3
4
5
10
50
60
65
70
100
500
QFTCT
1.5
1.5
FIGURE CS4.7
QFT templates for p12(s).

375
Case Study 4: Radio-Telescope Control
CS4.4.2  Control Specifications
Taking into account the dynamics of the radio telescope, the astronomers’ objectives 
and the system limitations, we define the following robust control specifications—with 
Hv(s) = 1:
Type 1: Stability specification
	
T j
p
j
G j
p
j
G j
W
v
v
s
1
1
1
1 46
(
)
(
)
(
)
(
)
(
)
( )
0.01  
12
12
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
0.05  0.1  0.5  1  1.5  2  3  4  5  10  50  60  65  70  100  500 rad/s
]
	
(CS4.24)
which is equivalent to PM = 40.05°, GM = 4.53 dB—see Equations 2.30 and 2.31.
Type k1: Wind disturbances Tw(s) over θ’m(s) via p11(s)—Figures CS4.3 and CS4.8.
	
T
j
j
T j
p
j
p
j
G j
k
m
w
v
k
k
1
1
1
1
(
)
(
)
(
)
(
)
(
)
(
)
( )
( )
11
12
ω
θ
ω
ω
ω
ω
ω
δ
ω
δ
ω
=
=
+
≤
=

s a
s a
a
k
k
k
1
1
1
5
1
3
10
(
)
(
)+
= ×
∈
;
;
[
]
ω
0.01  0.05  0.1  0.5 rad/s
	
(CS4.25)
CS4.4.3  Controller Design
QFT Bounds
As mentioned, the QFT bounds take into account the plant dynamics, model, uncer­
tainty, and control specifications. Figures CS4.9a and b show the bounds for stability and 
wind disturbance rejection calculated from Equations CS4.24 and CS4.25, respectively. 
Figure CS4.10 presents the intersection of the two bounds at each frequency. As we have 
10–3
10–2
10–1
100
101
102
103
Magnitude (dB)
–200
–180
–160
–140
–120
–100
–80
–60
–40
–20
0
Bode diagram
Frequency (rad/s)
δk1(s)
FIGURE CS4.8
Attenuation of wind disturbances Tw(s) over θ’m(s)—Type k1.

376
Case Study 4: Radio-Telescope Control
a bound solution for each frequency, these control specifications for the radio telescope 
are compatible.
Loop Shaping—Gv(s)
The design of the feedback controller Gv(s) is carried out on the Nichols chart. It is done 
by adding poles and zeros until the nominal loop, defined as Lv0(jω) = p12,0(jω)Gv(jω), meets 
the QFT bounds presented in Figure CS4.10.
We start the design of Gv(s) by adding an integrator to obtain zero steady-state error 
for ramp reference inputs. After this, we increase the magnitude of the controller gain 
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–15
–10
–5
0
5
10
15
20
25
30
QFTCT
4
3
1.5
1
0.5
0.1
5
2
500
70
100
60
50
100.05
0.01
65
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop magnitude (dB)
–10
0
10
20
30
40
50
60
70
QFTCT
(a)
(b)
0.05
0.01
0.5
0.1
FIGURE CS4.9
QFT bounds. (a) Stability and (b) wind disturbance rejection.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–60
–40
–20
0
20
40
60
QFTCT
0.01
Lv0(s)
0.05
500
3
4
5
10
2
1.5
50
100
70
1
0.1
0.5
65
FIGURE CS4.10
QFT bounds and Gv(s) design—loop shaping.

377
Case Study 4: Radio-Telescope Control
to k = 1900, to put Lv0(0.01) above the B(0.01) bound. Then, we add a low-frequency zero 
(z1 = 0.2), to move Lv0(s) to the right, and to pass the stability bounds (“circles”) through 
the right.
Afterward, to attenuate the effect of the first flexible mode at 4 rad/s, we add a notch 
filter (s2 + 2 ζa ωns + ωn
2)/(s2 + 2 ζb ωn s + ωn
2), with a natural frequency of ωn = 4 rad/s, 
a damping numerator coefficient of ζa = 0.1, and a damping denominator coefficient of 
ζb = 1. This gives a notch depth of 20 × log10(ζa/ζb) dB = –20 dB.
Finally, we add one more additional pole at high frequency (p1 = 5), to filter out high-
frequency noise. The final expression for Gv(s) is the PI with a low-pass filter and a notch 
filter controller shown in Equation CS4.26. The loop shaping is shown in Figure CS4.10.
	
G s
s
s
s
s
s
s
s
v( )
/
/
=
+
(
)
+
(
)
+
+
+
+
1900
0 2
1
5
1
0 8
16
8
16
2
2
(
. )
(
)
(
.
)
(
) 	
(CS4.26)
CS4.4.4  Analysis and Validation of Gv(s)
The analysis of the closed-loop stability in the frequency domain is shown in Figure 
CS4.11a. The dashed line is the stability specification Ws defined in Equation CS4.24. The 
solid line represents the worst case of all the possible functions p12Gv/(1 + p12Gv) at each fre­
quency due to the model uncertainty. The control system meets the stability specification 
(the solid line is below the dashed line Ws) for all the plants within the uncertainty, and 
including the flexible modes at 4.1, 9.35, and 64.8 rad/s.
The analysis of the robust wind disturbance rejection in the frequency domain is shown 
in Figure CS4.11b. The dashed line is the specification δk1(ω) defined in Equation CS4.25. 
The solid line represents the worst case of all the possible functions p11/(1 + p12Gv) at each 
frequency due to the model uncertainty. The control system meets the specification for all 
the plants within the uncertainty (the solid line is below the dashed line δk1).
Frequency (rad/s)
10–2
10–1
100
101
102
Magnitude (dB)
–70
–60
–50
–40
–30
–20
–10
0
10
0.01
0.05
0.1
0.5 1
1.5
2
3
4
5
10
50
60
65
70
100
500
QFTCT
Ws
Worst cases of
“p12Gv/(1 + p12Gv)’’
10–2
10–1
100
101
102
103
Frequency (rad/s)
Magnitude (dB)
–350
–300
–250
–200
–150
–100
–50
0.01
0.05
0.1
0.5
QFTCT
Worst cases of
“p11/(1 + p12Gv)’’
δk1
(a)
(b)
FIGURE CS4.11
Frequency-domain analysis. (a) Stability and (b) wind disturbance rejection.

378
Case Study 4: Radio-Telescope Control
Additionally, Figures CS4.20b and CS4.32a show the time-domain simulation of the 
velocity loop under different circumstances. In all cases, the controller Gv(s) achieves a 
good performance according to the required specifications.
CS4.5  Azimuth Axis—Position Control
This section presents the design of the position control system of the telescope azimuth-
axis servo system. The following sections propose a solution for the 2DOF controller, Gp(s) 
and Fp(s), of the outer loop. See again Figure CS4.3 with the cascade control diagram. We 
use the velocity controller Gv(s) designed in the previous section for the inner loop.
CS4.5.1  Plant
The plant pp(s) to be controlled by the position controller Gp(s) is composed of the inner veloc­
ity loop and the additional integrator, as shown in Figure CS4.3. In this way, the plant pp(s) is
	
p s
p
s M s G s
p
s M s G s H s
s
p
v
v
v
( )
( )
( )
( )
( )
( )
( )
( )
=
+






12
12
1
1
	
(CS4.27)
CS4.5.2  QFT Templates
Figure CS4.12 shows the QFT templates for pp(s)—Equation CS4.27. They are calculated 
using the pp(s) plant model, the uncertainty defined in Equation CS4.21, and the array of 
frequencies of interest selected in Equation CS4.22.
Open-loop phase (deg)
–250
–200
–150
–100
Open-loop magnitude (dB)
–140
–120
–100
–80
–60
–40
–20
0
20
40
0.01
0.05
0.1
0.5
1
1.5
2
3
4
5
10
50
60
65
70
100
500
QFTCT
FIGURE CS4.12
QFT templates for pp(s).

379
Case Study 4: Radio-Telescope Control
CS4.5.3  Control Specifications
Taking into account the dynamics of the radio telescope, the astronomers’ objectives, and 
the system limitations, we define the following robust control specifications for the posi­
tion control system—with Hp(s) = 1:
Type 1: Stability specification
	
T j
p j
G j
p j
G j
W
p
p
p
p
s
1
1
1
1 46
(
)
(
)
(
)
(
)
(
)
( )
0.01  0.
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
05  0.1  0.5  1  1.5  2  3  4  5  10  50  60  65  70  100  500 rad/s
]
	
(CS4.28)
which is equivalent to PM = 40.05°, GM = 4.53 dB—see Equations 2.30 and 2.31.
Type 3: Sensitivity or disturbances at plant output specification—see Figure CS4.13a.
	
T j
j
d j
p j
G j
s a
s a
a
m
o
p
p
d
d
3
3
1
1
1
(
)
(
)
(
)
(
)
(
)
( )
/
/
ω
θ
ω
ω
ω
ω
δ ω
=
=
+
≤
=
+
(
)
(
)
;
d =
∈
0 5.
[
]
ω
0.01  0.05  0.1 0.5 rad/s
	
(CS4.29)
Type 6: Reference tracking specification—see Figure CS4.13b.
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
6
1
_lo
p
p
p
p
_up
T j
F j
p j
G j
p j
G j
( )
(
)
(
)
(
)
(
)
(
)
(
)
( )
<
=
+
≤
∈[
]
0.01  0.05  0.1  0.5  1 rad/s
	
(CS4.30)
	
δ6
2
1
1
0 292
_lo
L
L
s
s a
a
( ) =
(
)+


=
;
.
	
(CS4.31)
Magnitude (dB)
–30
–25
–20
–15
–10
–5
0
Bode diagram
Frequency (rad/s)
10–2
10–1
100
δ3(s)
0
5
10
15
20
25
30
35
0
0.2
0.4
0.6
0.8
1
1.2
Step response
(a)
(b)
Time (s)
Amplitude
δ6-lo(s)
δ6-up(s)
FIGURE CS4.13
Control specifications. (a) Disturbance rejection specifications: δ3 and (b) reference tracking: δ6-up, δ6-lo.

380
Case Study 4: Radio-Telescope Control
	
δ
ω
ζ
ω
ζ
6
2
1
2
1
0 215
0 8
_up
U
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
[
]
+
+


=
=
(
)
(
)
(
)
;
.
;
. ;
.
ω
ζ
n
U
a
= 1 25
	
(CS4.32)
CS4.5.4  Controller Design
QFT Bounds
As mentioned, the QFT bounds take into account the plant dynamics, model, uncertainty, 
and control specifications. Figures CS4.14a through c, show the bounds for stability, sensi­
tivity, and reference tracking for the position loop, see Equations CS4.28 through CS4.32. 
Figure CS4.14d presents the intersection of the three bounds at each frequency of interest. 
As we have a bound solution for each frequency, the selected control specifications for the 
position loop are compatible.
Open-loop magnitude (dB)
–10
–5
0
5
10
15
20
25
30
QFTCT
1.5
1
4
3
500
100
70
60
50
10
2
0.5
65
0.01
0.05
5
0.1
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
Open-loop magnitude (dB)
–10
–5
0
5
10
15
20
25
30
35
QFTCT
0.01
0.5
0.05
0.1
Open-loop phase (deg)
–190 –185 –180 –175 –170 –165 –160 –155
Open-loop magnitude (dB)
–1
0
1
2
3
4
QFTCT
0.01
0.05
0.5
0.1
1
Open-loop magnitude (dB)
–10
–5
0
5
10
15
20
25
30
35
QFTCT
0.01
0.05
1.5
4
0.5
0.1
65
1
3
2
5
10
50
60
500
70
100
Open-loop phase (deg)
–350 –300 –250 –200 –150 –100
–50
0
(a)
(b)
(c)
(d)
FIGURE CS4.14
QFT bounds. (a) Stability, (b) sensitivity, (c) reference tracking, and (d) intersection of bounds.

381
Case Study 4: Radio-Telescope Control
Loop Shaping—Gp(s)
The design of the feedback controller Gp(s) is carried out on the Nichols chart. It is done by 
adding poles and zeros until the nominal loop, defined as Lp0(jω) = pp,0(jω)Gp(jω), meets the 
QFT bounds presented in Figure CS4.14d.
We start the design of Gp(s) by increasing the magnitude of the controller gain to 
k = 0.5, to put Lp0(0.01) above the B(0.01) bound. Next, we add a low-frequency zero 
(z1 = 0.6), to move Lp0(s) to the right, and to pass the stability bounds (“circles”) through 
the right.
Finally, we add one more additional pole at high frequency (p1 = 25), to filter out high-
frequency noise. The final expression for Gp(s) is the lead controller shown in Equation 
CS4.33. The loop shaping is shown in Figure CS4.15.
	
G s
s
s
p( )
/
/
=
+
(
)
+
(
)
0 5
0 6
1
25
1
.
(
. )
(
)
	
(CS4.33)
Prefilter Design—Fp(s)
With the controller Gp(s) just designed—see Equation CS4.33, the reference tracking specifi­
cations presented in Equations CS4.30 through CS4.32, and the plant model pp(s) described 
in Equation CS4.27, we design a prefilter Fp(s) to assure that all the input/output functions 
pp(s)Gp(s)Fp(s)/[1 + pp(s)Gp(s)], from low frequencies up to 1 rad/s are inside the band defined 
by the limits δ6-up(ω) and δ6-lo(ω). The designed prefilter is shown in Equation CS4.34, and 
the input/output functions and limits in Figure CS4.16.
Open-loop phase (deg)
–350
–300
–250
–200
–150
–100
–50
0
Open-loop gain (dB)
–80
–60
–40
–20
0
20
40
QFTCT
1.5
1
5
0.01
0.05
0.1
0.5
Lp0(s)
2
10
100
70
60
65
50
3
4
FIGURE CS4.15
QFT bounds and Gp(s) design—loop shaping.

382
Case Study 4: Radio-Telescope Control
	
F s
s
s
p( )
/
/
=
+
(
)
+
(
)
(
. )
(
.
)
0 3
1
0 38
1
2
	
(CS4.34)
CS4.5.5  Analysis and Validation of Gp(s) and Fp(s)
The analysis of the closed-loop stability of the position loop in the frequency domain 
is shown in Figure CS4.17a. The dashed line is the stability specification Ws defined in 
Equation CS4.28. The solid line represents the worst case of all the possible functions ppGp/
(1 + ppGp) at each frequency due to the model uncertainty. The control system meets the 
stability specification (the solid line is below the dashed line Ws) for all the plants within 
the uncertainty.
The analysis of the robust output disturbance rejection of the position loop in the fre­
quency domain is shown in Figure CS4.17b. The dashed line is the specification δ3(ω) 
defined in Equation CS4.29. The solid line represents the worst case of all the possible 
functions 1/(1 + ppGp) at each frequency due to the model uncertainty. The control system 
meets the specification for all the plants within the uncertainty (the solid line is below the 
dashed line δ3 from 0 to 0.1 rad/s).
The time-domain analysis of the reference tracking specification of the position loop is 
presented in Figure CS4.18a. The figure shows the limits δ6-up(ω) and δ6-lo(ω)—see Equations 
CS4.31 and CS4.32, and the time responses of the motor position θm(t) to a unitary step refer­
ence θmRef(t). We simulate multiple cases of the closed-loop transfer function ppGpFp/(1 + ppGp) 
within the uncertainty—see Figure CS4.3, with Hp(s) = 1. The results are given per unit. The 
control system meets the specification (is between the upper and lower limits) in all cases.
10
QFTCT
0
–10
Magnitude (dB)
–20
–30
–60
–40
–50
10–2
10–1
100
Frequency (rad/s)
δ6-up
δ6-lo
ppGpF/(1 + ppGp)
FIGURE CS4.16
Prefilter F(s) for reference tracking specs: δ6-lo(ω) ≤ |T6| ≤ δ6-up(ω).

383
Case Study 4: Radio-Telescope Control
Additionally, the time-domain analysis of the output disturbance rejection is shown in 
Figure CS4.18b. The figure presents the time responses of the motor position θm(t) to a 
unitary disturbance at the output of the plant. We simulate multiple cases of 1/(1 + ppGp) 
within the uncertainty, also with Hp(s) = 1. The zero level is the non-perturbed case. The 
control system achieves a good disturbance rejection in all cases.
5
0
–5
–10
–15
Magnitude (dB)
–20
–25
–30
10–2
10–1
Frequency (rad/s)
100
QFTCT
Ws
Worst cases of
“ppGp/(1 + ppGp)”
Worst cases of
“1/(1 + ppGp)”
QFTCT
20
(a)
(b)
0
–20
–40
–60
–80
–100
Magnitude (dB)
10–2
Frequency (rad/s)
100
10–1
101
102
500
100
70
65
50
60
10
3
4
2
1
1.5
0.5
0.1
0.01
0.05
0.05
0.1
0.5
0.01
5
δ3
FIGURE CS4.17
Frequency-domain analysis. (a) Stability and (b) sensitivity.
1.2
(a)
(b)
QFTCT
QFTCT
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
0
5
10
15
Time (s)
20
0
5
10
15
Time (s)
20
25
30
35
d6-up
d6-lo
FIGURE CS4.18
Time domain. (a) Reference tracking θm = ppGpFp/(1 + ppGp) θmRef and (b) output disturbance rejection θm = 
1/(1 + ppGp) do.

384
Case Study 4: Radio-Telescope Control
CS4.6  Simulation: Position and Velocity Loops
This section presents the time-domain simulation of the complete cascade control sys­
tem presented in Figure CS4.3, including the velocity controller Gv(s) in the inner loop—
Equations CS4.26, and the position controller Gp(s) and Fp(s) in the outer loop—Equations 
CS4.33 and CS4.34. We simulate the nominal plants—see Equation CS4.23, and include 
the velocity limitation of the azimuth axis, which is 0.67 deg/s or 0.0117 rad/s in terms of 
the dish movement dθd/dt, or 33.52 deg/s or 0.585 rad/s in terms of the motor movement 
dθm/dt—see Figure CS4.19.
The motor reference input θmRef changes as a step at t = 1 s, from 0° to 750°, which in 
terms of the dish (θdRef) means from 0° to 15°.
Also, at t = 60 s we introduce a step wind disturbance TW from 0 to 3 × 105 Nm, and 
keep this value until the end of the simulation. This torque TW is equivalent to a wind gust 
of about v = 6.12 m/s, and considers the worst case scenario where the wind affects only 
half of the surface of the dish (taken as a circular dish), and where the aerodynamic thrust 
coefficient is CT = 0.1. That is to say
	
T
F r
r
C v
r
w
T
p
air
dish
T
dish
=
=












1
2
2
2
3
2
2
ρ
π
	
(CS4.35)
where FT is the thrust force applied by the wind on the dish, and rp the distance from the 
center of the dish to the center of pressure, or point where the equivalent lumped force FT 
is applied, rp = (2/3) rdish. Also, the density of the air is ρair = 1.225 kg/m3, and the radius of 
the dish rdish = 50 m.
Figure CS4.20a shows the results of the position loop controlling the motor angle θm(t) 
and Figure CS4.20b the corresponding velocity loop controlling the motor velocity dθm(t)/dt 
at the same time. The two figures are in degrees of the motor, and confirm a good perfor­
mance in both reference tracking and wind disturbance rejection.
Additionally Figures CS4.21a and b show, respectively, the complete movement and the 
details of the dish position in the same simulation. The peak of the excursion of the dish 
angle θd(t) under the wind gust of 6.12 m/s is 0.35°. Also, notice that although the steady-
state error of the motor “θdRef –θm/R” is zero, the dish θd(t) ends up with a permanent error 
of 0.06° due to the constant force applied by the wind.
The effect of the wind in the dish angle is a limiting factor that compromises the qual­
ity of astronomical observations. In order to improve the results of the wind disturbance 
rejection achieved here, the next section proposes a new design based on NDC methodol­
ogy introduced in Chapter 7.
u
v
umax
umin
Slope = 1
FIGURE CS4.19
Velocity saturation. In dish: 0.6704 deg/s = 0.0117 rad/s. In motor: 33.52 deg/s = 0.585 rad/s. Slope = 1. 
umax = +0.585, umin = –0.585.

385
Case Study 4: Radio-Telescope Control
CS4.7  Improving with NDC
This section presents a nonlinear dynamic control (NDC) solution for the position loop of 
the azimuth axis of the radio telescope. The design is based on the theory and examples 
developed in Chapter 7. In the next sub-sections, we follow the 5-step methodology dis­
cussed for the NDC—see Section 7.5.
Step A:  Controller Structure
The NDC structure proposed for the position control system is shown in Figure CS4.22. It 
consists of two parallel channels, Gp1(s) N1 and Gp2(s) N2. The first channel Gp1(s) N1 is the 
aggressive one, and the second channel Gp2(s) N2 the moderate one. We take Gp2(s) = Gp(s), 
which is the position controller already designed in the previous section. Also, we keep 
900
(a)
(b)
Position loop: θmRef (t), θm(t)
Velocity loop: dθmRef (t)/dt, dθm(t)/dt
dθmRef(t)/dt
dθm(t)/dt
θmRef (t)
θm(t)
50
40
30
20
10
deg/s (motor)
0
–10
–20
–30
800
700
600
500
400
deg (motor)
300
200
100
0
0
10
20
30
40
50
Time (s)
60
70
80
90 100
0
10
20
30
40
50
Time (s)
60
70
80
90 100
FIGURE CS4.20
Simulation with Gp(s), Fp(s), and Gv(s). (a) Position loop, θm(t). (b) Velocity loop, dθm(t)/dt.
(a)
(b)
θdRef(t), θd (t), θm(t)/R
θdRef(t), θd (t), θm(t)/R
θdRef(t)
θdRef(t)
θd(t)
θd (t)
θm(t)/R
θm(t)/R
deg (dish)
deg (dish)
0
10
20
30
40
50
Time (s)
60
70
80
90 100
60
65
70
75
80
85
Time (s)
90
95
100
18
15.4
15.3
15.2
15.1
15
14.9
14.8
14.7
16
14
12
10
8
6
4
2
0
FIGURE CS4.21
Simulation with Gp(s), Fp(s), and Gv(s). Dish position θd(t) and motor θm(t)/R. (a) Full signals and (b) zoom at t = 60–100 s.

386
Case Study 4: Radio-Telescope Control
the same prefilter Fp(s) designed previously. The structure also includes an anti-wind-up 
nonlinear inner loop for the first channel, with a linear transfer function A(s) and a satura­
tion model ˆN0. Notice that it is not necessary any anti-wind-up loop for the second chan­
nel, as Gp2 does not include any integrator—see Equation CS4.33.
The nonlinear functions N1 and N2 are defined in Figure CS4.23—see also Figures 7.19 
and 7.20, respectively, where N1 = N01 is defined as in Equations 7.17 and 7.18, and N2 = N02 
as in Equations 7.19 and 7.20.
The parameters selected for these two nonlinearities are: δh = 0.75 and δl = 0.60. Notice 
that N01 + N02 = 1. As a summary, the system has four nonlinearities: the actuator satura­
tion N0, the actuator saturation model ˆN0 and the two control channels N1 and N2.
Step B.1:  Control Elements for First Channel, Gp1(s)—Aggressive
The control specifications for the position controller Gp1(s) are shown in Equations CS4.36 
and CS4.37. They are
Type 1: Stability specification
	
T j
p j
G
j
p j
G
j
W
p
p
p
p
s
1
1
1
1
1
4 0
(
)
(
)
(
)
(
)
(
)
( )
0.01  0
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
.05  0.1  0.5  1  1.5  2  3  4  5  10  50  60  65  70  100  500 rad/s
]
	
(CS4.36)
which is equivalent to PM = 14.36°, GM = 1.94 dB—see Equations 2.30 and 2.31.
Type 3: Sensitivity or disturbances at plant output specification
	
T j
j
d j
p j
G
j
s a
s a
a
m
o
p
p
d
d
d
3
1
3
1
1
1
(
)
(
)
(
)
(
)
(
)
( )
ω
θ
ω
ω
ω
ω
δ ω
=
=
+
≤
=
(
)
(
)+ ;
=
∈
3 3333
.
[
]
ω
0.01  0.05  0.1 0.5 rad/s
	
(CS4.37)
As the main objective for the NDC is to achieve a much better wind disturbance rejec­
tion, these two specifications for Gp1(s) are more aggressive than the ones defined for 
+
NDC
uNDC(s)
+
+
Velocity
loop
Saturation
-
e (s)
+
Fp(s)
-
+
+
+
N0
N^
0
N1
N2
uN1(s)
uN2(s)
uA(s)
+
θdRef(s)×R =
θmRef(s)
θ′mRef  (s)
θm(s)
θd(s)
Tm(s)
Tw(s)
Gp1(s)
Gp2 (s)
A(s)
Hp(s)
np(s)
pp(s)
p21(s)
p22(s)
+
+
FIGURE CS4.22
NDC block diagram. Hp(s) = 1.

387
Case Study 4: Radio-Telescope Control
Gp2(s) = Gp(s) in the previous section—see Equation CS4.29. Figure CS4.24 compares the 
disturbance rejection specifications required for Gp1(s) and Gp2(s).
The QFT bounds are calculated taking into account the pp(s) transfer function—Equation 
CS4.27, the parameter uncertainty given by Equation CS4.21, the array of frequencies of 
interest—Equation CS4.22, and the stability and output disturbance rejection specifica­
tions given by Equations CS4.36 and CS4.37. Figures CS4.25a and b show the QFT bounds 
of each specification, and Figure CS4.26 the intersection of bounds, which is compatible at 
each frequency.
To meet the specifications, we design a sixth order structure for the Gp1(s) controller, as 
shown in Equation CS4.38. The QFT bounds and the loop shaping of Lp0(s)  = pp0(s)Gp1(s) are 
shown in Figure CS4.26.
G
s
s
s
s
s
p1
0 04
0 134
1
0 25
1
0 3
1
0 33
1
( )
/
/
/
/
=
+
(
)
+
(
)
+
(
)
+
(
.
(
.
)
(
.
)
(
. )
(
.
)
)
+
(
)
+
(
)
+
+
+
+
s
s
s
s
s
s
s
2
2
2
50
1
70
1
0 13
4225
130
4225
(
)
(
)
(
.
)
(
)
/
/
	
(CS4.38)
10
d3(s) for Gp2(s)
d3(s) for Gp1(s)
Bode diagram
0
–10
–20
–30
–40
–50
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
Magnitude (dB)
FIGURE CS4.24
Comparison disturbance rejection specifications for Gp1(s) and Gp2(s).
–δh  –δl
–δh  –δl
δl
δl
δl
–δl
δh
δl
δh
δh
–δh
–δl
–δh
Input
Input
Output
(a)
(b)
N01
N02
Output
FIGURE CS4.23
Nonlinear elements for the NDC: (a) N1 = N01. (b) N2 = N02.

388
Case Study 4: Radio-Telescope Control
The analysis of the closed-loop stability of the position loop in the frequency domain 
is shown in Figure CS4.27a. The dashed line is the stability specification Ws defined in 
Equation CS4.36. The solid line represents the worst case of all the possible functions 
ppGp1/(1 + ppGp1) at each frequency due to the model uncertainty. The control system meets 
the stability specification (the solid line is below the dashed line Ws) for all the plants 
within the uncertainty.
The analysis of the robust output disturbance rejection of the position loop in the fre­
quency domain is shown in Figure CS4.27b. The dashed line is the specification δ3(ω) 
Frequency (rad/s)
–300
–250
–200
–150
–100
–50
Gain dB
–20
0
20
40
60
80
QFTCT
0.01
0.05
0.1
0.5
2
3
10
500
100
70
60
65
50
4
Lp0(s)
FIGURE CS4.26
QFT bounds and Gp1(s) design—loop shaping.
Open-loop phase (deg)
–240
–220
–200
–180
–160
–140
–120
Open-loop magnitude (dB)
–5
0
5
10
15
QFTCT
1.5
65
1
4
0.5
3
2
0.01
0.05
10
60
70
500
5
0.1
100
50
Open-loop phase (deg)
350
–300 –250 –200 –150 –100
–50
0
Open-loop magnitude (dB)
0
10
20
30
40
50
QFTCT
(a)
(b)
0.5
0.05
0.01
0.1
FIGURE CS4.25
QFT bounds for Gp1(s). (a) Stability and (b) sensitivity.

389
Case Study 4: Radio-Telescope Control
defined in Equation CS4.37. The solid line represents the worst case of all the possible 
functions 1/(1 + ppGp1) at each frequency due to the model uncertainty. The control system 
meets the specification for all the plants within the uncertainty (the solid line is below the 
dashed line δ3).
Step B.2:  Control Elements for Second Channel, Gp2(s) & Prefilter Fp(s)—Moderate
The controller proposed for the second channel (moderate) is the same expression we used 
in Section CS4.6, Equation CS4.33,
	
G
s
G s
s
s
p
p
2
0 5
0 6
1
25
1
( )
( )
/
/
=
=
+
(
)
+
(
)
.
(
. )
(
)
	
(CS4.39)
The purpose of implementing two channels, Gp1(s) and Gp2(s), is to improve the system 
performance beyond the linear limitations. The element Gp1(s) has been designed as an 
active/aggressive controller to work with small errors (see N1 = N01) and the element Gp2(s) 
as a moderate controller to work with large errors (see N2 = N02). The Bode diagram shown 
in Figure CS4.28 compares the two controllers, the aggressive Gp1(s) and the moderate 
Gp2(s). Notice that the magnitude of Gp1(s) is much larger for almost all frequencies, except 
at ω = 65 rad/s (motor shaft resonance), where a notch filter reduces Gp1(s) to the Gp2(s) 
level. Also, at low frequency, two integrators make Gp1(s) much more active rejecting exter­
nal disturbances.
Finally, we keep the same prefilter designed in Section CS4.6, Equation CS4.34, for the 
NDC structure. Again, the expression for this prefilter is
	
F s
s
s
p( )
/
/
=
+
(
)
+
(
)
(
. )
(
.
)
0 3
1
0 38
1
2
	
(CS4.40)
Magnitude (dB)
–35
–30
–25
–20
–15
–10
–5
0
5
10
15
(a)
(b)
0.01
0.05
0.1
0.5 1
1.5
2
3
4
5
10
50
60
65
70
100
500
QFTCT
Ws
Worst cases of
“ppGp1/(1 + ppGp1)”
Magnitude (dB)
–90
–80
–70
–60
–50
–40
–30
–20
–10
0
0.01
0.05
0.1
0.5
QFTCT
Worst cases of
“1/(1 + ppGp1)”
δ3
Frequency (rad/s)
10–2
10–1
100
101
102
10–2
10–1
100
Frequency (rad/s)
FIGURE CS4.27
Frequency-domain analysis, Gp1(s). (a) Stability and (b) sensitivity.

390
Case Study 4: Radio-Telescope Control
Step C:  Inner Loop and Control Element A(s)
The anti-wind-up inner loop is necessary for the first channel, as Gp1(s) includes two inte­
grators. At the same time, the second channel does not need this anti-wind-up inner loop, 
as Gp2(s) does not have any integrator. Then, the expression for A(s) is
	
A s
k
s
G
k
G
k
ND
a
p
a
p
a
( )
,
:
:
=
→
=
→
=
→
being:
case only
case only
case
1
2
1
0
C
G
k
G
k
p
a
p
a
: for
,
.
for
,
1
2
0 020
0
=
=




	
(CS4.41)
Step D:  Isolines—Stability Analysis for the Complete System
The describing functions DFs for each nonlinearity, both in the controller and in the plant, 
are given by the following expressions:
•	 N0 = N05, actuator saturation—Equations 7.25 and 7.26.
•	 ˆN
N
N
0
0
05
=
=
, controller actuator saturation model—Equations 7.25 and 7.26.
•	 N1 = N01, controller first channel nonlinearity—Equations 7.17 and 7.18.
•	 N2 = N02 , controller second channel nonlinearity—Equations 7.19 and 7.20.
The isolines are calculated cascading the linear and nonlinear elements. They include 
the DF of each nonlinearity at their specific position in the loop, from the input (right of the 
expression) to the output (left of the expression), as expressed by Equation CS4.42
Magnitude (dB)
–50
0
50
100
Phase (deg)
–180
–90
0
90
180
Gp1(–.), Gp2(–)
Gp1(s)
Gp2(s)
Gp2(s)
Gp1(s)
10–2
10–1
100
101
102
103
Frequency (rad/s)
FIGURE CS4.28
Controllers: aggressive Gp1(s), moderate Gp2(s).

391
Case Study 4: Radio-Telescope Control
	
L
p s DF
A s DF
G
s DF
G
s DF
p
N
N
p
N
p
N
=
+






+


( )
( )
( )
( )
0
0
1
1
2
2
1
1




	
(CS4.42)
The algorithm that calculates the isolines for every amplitude E of the input and fre­
quency ω is similar to the one included in Appendix 7. Figure CS4.29 represents in the 
Nichols chart the isolines L—Equation CS4.42, for the input errors 10–3 ≤ E ≤ 102 and 
for the frequencies 10–4 ≤ ω ≤ 102 rad/s. The figure is calculated for the nominal plant—
Equation CS4.23. It also shows the QFT stability bounds found for this nominal plant and 
Ws = 4.0 (or PM = 14.3°). As there is no RHP poles and the isolines do not enter into the 
QFT bounds, the NDC system is stable for all the cases within the model uncertainty. The 
method gives sufficient conditions for stability—see also Chapter 3.
Step E:  Simulations and Discussion—Position and Velocity Loops
Finally, Figures CS4.30 through CS4.33 show the results of the time-domain simulation 
of the complete cascade control system with the NDC presented in Figure CS4.22, includ­
ing the inner velocity loop shown in Figure CS4.3. We simulate the nominal plants—
see Equation CS4.23, and include the velocity limitation of the azimuth axis, which is 
±0.585 rad/s in terms of the motor movement dθm/dt—see Figure CS4.19. The expressions 
for the controllers are
•	 Inner loop.
	
Velocity controller Gv(s): Equation CS4.26
•	 Outer loop.
	
Prefilter Fp(s): Equation CS4.40
Channel 1. Gp1(s): Equation CS4.38, N1: Equations 7.17 and 7.18, δh = 0.75, δl = 0.60
Open-loop phase (deg)
–250
–200
–150
–100
–50
0
50
Open-loop (dB)
–80
–60
–40
–20
0
20
40
60
80
NDC. Isolines
QFT stability
bounds for
Ws = 4.0
Isolines
1e-3 < E < 1e2
L10(s)
FIGURE CS4.29
Isolines in the Nichols chart, for error E from 10–3 to 102, ω from 10–4 to 102 rad/s, and QFT stability bounds for 
Ws = 4.0 (or PM = 14.3 deg).

392
Case Study 4: Radio-Telescope Control
Channel 2. Gp2(s): Equation CS4.39, N2: Equations 7.19 and 7.20, δh = 0.75, δl = 0.60
Anti-wind-up. A(s): Equation CS4.41, ˆN0: Equations 7.25 and 7.26
We repeat the same simulation conditions of Section CS4.7. The motor reference input 
θmRef changes as a step at t = 1 s, from 0° to 750°, which in terms of the dish (θdRef) means from 
0° to 15°. Also, at t = 60 s we introduce a step wind disturbance TW from 0 to 3 × 105 Nm, 
and keep it until the end of the simulation.
Figure CS4.30 shows the simulation of the position loop—motor angle θm(t), including 
the results with only the aggressive controller Gp1(s)—dashed line, with only the moderate 
controller Gp2(s)—dashed-dotted line, and with the NDC solution—solid line. The control­
lers Gp2(s) and NDC perform better than Gp1(s) on reference tracking—see Figure CS4.30a. 
Also, as we intended, the NDC performs better than the original Gp2(s) on disturbance 
rejection, as shown in Figure CS4.30b.
Time (s)
0
10
20
30
40
50
60
70
80
90 100
deg (motor)
0
200
400
600
800
1000
1200
Position loop: θmRef(t), θm(t)
θmRef(t)
θm(t) with Gp1
θm(t) with Gp2
θm(t) with NDC
θmRef(t)
θm(t) with NDC
Time (s)
30
40
50
60
70
80
deg (motor)
710
720
730
740
750
760
770
780
Position loop: θmRef(t), θm(t)
(a)
(b)
θm(t) with Gp1
θm(t) with Gp2
FIGURE CS4.30
Simulation, motor angle θm(t). Position control loop. Strategies: aggressive Gp1, moderate Gp2, and NDC solutions. 
(a) Complete simulation and (b) zoom of the disturbance rejection part.
0
10 20 30 40 50 60 70 80 90 100
deg (dish)
0
2
4
6
8
10
12
14
16
18
θdRef(t), θd(t), θm(t)/R
(a)
Time (s)
θdRef(t)
θd(t)
θm(t)/R
θdRef(t), θd(t), θm(t)/R
(b)
30
40
50
60
70
80
90
100
deg (dish)
14.5
14.6
14.7
14.8
14.9
15
15.1
15.2
θdRef(t)
θd(t)
θm(t)/R
Time (s)
FIGURE CS4.31
Simulation, dish angle θd(t). NDC solution. (a) Complete simulation and (b) zoom of the disturbance rejection 
part.

393
Case Study 4: Radio-Telescope Control
Additionally, Figures CS4.31a and b show, respectively, the complete movement and the 
details of the dish position with the NDC solution. Also with the NDC solution, Figure 
CS4.32a presents the corresponding velocity loop controlling the motor velocity dθm(t)/dt 
simultaneously, and Figure CS4.32b the motor angle error e(t) and switching signals uN1(t), 
uN2(t), uA(t)—see signals in Figure CS4.22.
Finally, Figure CS4.33 shows the details of the dish angle θd(t) and motor angle θm(t)/R 
in dish degrees when we use the original moderate controller Gp2(s)—dashed-dotted line, 
and the NDC solution—solid line. The peak of the excursion of the dish angle θd(t) under 
the wind gust of 6.12 m/s is reduced from the 0.35° with Gp2(s) to 0.13° with NDC. Also, 
notice that although the steady-state error of the motor “θdRef–θm/R” is always zero, the 
Time (s)
0
10
20
30
40
50
60
70
80
deg (motor)
–50
0
50
100
Error(t) [–]
(b)
(a)
(c)
Time (s)
0
10
20
30
40
50
60
70
80
deg (motor)
Position error
uA
0
20
40
OutN1 (-), OutN2 (--), uA(-.)
OutN2
OutN1
Time (s)
0
10
20
30
40
50
60
70
80
90 100
deg/s (motor)
–30
–20
–10
0
10
20
30
40
50
Velocity loop: dθmRef(t)/dt, dθm(t)/dt
dθmRef(t)/dt
dθm(t)/dt
FIGURE CS4.32
Simulation NDC combining Gp1 and Gp2. (a) Motor velocity loop dθm(t)/dt, (b) motor angle error, and (c) switching 
signals uN1, uN2, and uA.
Time (s)
60
65
70
75
80
85
90
95
100
deg (dish)
14.7
14.8
14.9
15
15.1
15.2
15.3
15.4
θdRef(t), θd(t), θm(t)/R
θd(t), Gp2
θd(t), NDC
θm(t)/R, NDC
θm(t)/R, Gp2
θdRef(t)
FIGURE CS4.33
Disturbance rejection, dish angle θd(t) and motor angle θm(t)/R. Strategies: Gp2 (dashed-dotted line) and NDC 
(solid line).

394
Case Study 4: Radio-Telescope Control
dish θd(t) ends up with a permanent error of 0.06° due to the constant force applied by the 
wind in both cases, and also because the feedback sensor used in this case study is θm(t) 
and not θd(t).
CS4.8  Summary
This case study has designed two robust QFT control solutions for the velocity and posi­
tion loops of a radio-telescope servo system. The first solution is based on the classical QFT 
methodology and the second one proposes an NDC strategy. Both designs accomplish five 
simultaneous control objectives:
•	 Stability
•	 Tracking of the azimuth-axis telescope position
•	 Regulation of the azimuth-axis telescope velocity
•	 Rejection of unpredictable wind disturbances
•	 Reduction of dish and feed-arm vibration

395
Case Study 5: Attitude and Position Control of 
Spacecraft Telescopes with Flexible Appendages
CS5.1  Introduction
With high priority science objectives to break the current barriers of our understanding 
of the universe, and dealing with weight limitations of launch vehicles for cost-effective 
access to space, new NASA and ESA missions involve both formation flying technology 
and satellites with large flexible structures. See for instance the Terrestrial Planet Finder, 
Stellar and Planet Imager, Life Finder, Darwin, Lisa, and Proba-3 missions, etc.
Control of spacecraft with large flexible structures and very demanding astronomical 
specifications involves significant difficulties due to the combination of flexible modes 
with small damping, model uncertainty, and coupling among the inputs and outputs.
This case study deals with the design of a MIMO QFT robust control strategy to 
­simultaneously regulate the position and attitude of a spacecraft telescope with large flex­
ible appendages. The spacecraft is part of a multiple formation flying constellation of ESA 
cornerstone project: the Darwin mission (Figure CS5.1).211,216
The scientific objectives of this mission require high-performance control specifications, 
including micrometer accuracy for position and milli-arc-second precision for attitude, 
high disturbance rejection properties, loop-coupling attenuation, and low controller com­
plexity and order. The dynamics of the spacecraft presents a 6-inputs × 6-outputs MIMO 
plant, with 36 transfer functions of 50th order, significant model uncertainty, and high-
loop interactions introduced by the flexible modes of the low-stiffness appendages.
The results presented in this case study are part of a project developed by the author for 
the international benchmark proposed by ESA for the design of the control system of the 
Darwin mission. The design introduced here is based on the MIMO QFT methodology 
(Chapter 8), and got the best performance in that international competition.
CS5.2  System Description and Modeling
The Darwin mission consists of one master satellite (central hub) and three to six telescopes 
flying in formation (Figure CS5.1). They will operate together to analyze the atmosphere 
of remote planets through appropriate spectroscopy techniques. The mission will employ 
nulling interferometry to detect dim planets close to bright stars. The infrared light col­
lected by the free-flying telescopes will be recombined inside the hub-satellite in such a 
way that the light from the central star will be cancelled out by destructive interference, 
allowing the much fainter planets to stand out. That interferometry technology requires 
very accurate and stable positioning of the spacecraft in the constellation, which puts high 

396
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
demands on the attitude and position control system. Instead of an orbit around the Earth, 
the mission will be placed further away, at a distance of 1.5 million kilometers from Earth, 
in the opposite direction from the Sun (Earth–Sun Lagrangian Point L2).
Each telescope flyer is cylindrically shaped (2 m diameter, 2 m height) and weighs 
500 kg. In order to protect the instrument from sunlight, it is equipped with a sunshield 
modeled with six large flexible beams (4 m long and 7 kg) attached to the rigid structure 
(see Figure CS5.2; beam end-point coordinates in brackets).
For every beam, two different frequencies for the first modes along Y and Z beam axes are 
considered. Their frequency can vary from 0.05 to 0.5 Hz, with a nominal value of 0.1 Hz, 
and their damping can vary from 0.1% to 1%, with a nominal value of 0.5%. As regards 
spacecraft mass and inertia, the corresponding uncertainty around their nominal value 
is of 5%.
Based on this description, and using a mechanical modeling formulation for multiple 
flexible appendages of a rigid body spacecraft, the open-loop transfer function matrix 
­representation of the flyer is given in Equation CS5.1 and Figure CS5.3, where x, y, z are the 
FIGURE CS5.1
Spacecraft telescopes with large flexible appendages flying in formation. (Courtesy ESA.)
2 m
2 m
Xcont
Ycont
Zcont
Rigid body
1 m
4 m
1 m
[5; 0; –1] m
[–5; 0; –1] m
Beams
CoM
[–2.5; –5√3/2; –1] m
[–2.5; –5√3/2; –1] m
[2.5; 5√3/2; –1] m
[2.5; 5√3/2; –1] m
FIGURE CS5.2
Spacecraft description. (Adapted from Garcia-Sanz, M. et al. 2008. J. ASME J. Dyn. Syst. Meas. Control, 130, 
011006-1–011006-15.)

397
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
position coordinates; ϕ, θ, ψ are the corresponding attitude angles; Fx, Fy, Fz are the force 
inputs; Tϕ, Tθ, Tψ are the torque inputs; and where each pij(s), i, j = 1,…,6, is a 50th order 
Laplace transfer function with uncertainty.
	
x s
y s
z s
s
s
s
p
s
p
( )
( )
( )
( )
( )
( )
( )
φ
θ
ψ






=
11
12
13
14
15
16
21
22
23
24
25
( )
( )
( )
( )
( )
( )
( )
( )
( )
(
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
ss
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
)
( )
( )
( )
( )
( )
( )
( )
( )
( )
26
31
32
33
34
35
36
41
42
43
44
45
46
51
52
53
54
55
56
( )
( )
( )
( )
( )
( )
( )
( )
( )
(
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
p
s
)
( )
( )
( )
( )
( )
( )
61
62
63
64
65
66












F s
F s
F s
T s
T s
T s
x
y
z
( )
( )
( )
( )
( )
( )
φ
θ
ψ
	
(CS5.1)
The Bode diagram of the plant (Figure CS5.3) shows the dynamics of the 36 matrix ele­
ments. Each of them and the MIMO system (matrix) itself are minimum phase. The flex­
ible modes introduced by the appendages (second-order dipoles) affect all the elements 
around the frequencies ω = [0.19, 10] rad/s. The diagonal elements pii(s), i = 1,…,6, and 
the elements p15(s), p51(s), p24(s), and p42(s) are double integrators with additional flexible 
modes.
0
From: In(1)
From: In(2)
From: In(3)
From: In(4)
From: In(5)
From: In(6)
To: Out(1)
–50
–100
–150
0
To: Out(2)
–50
–100
–150
0
To: Out(3)
–50
–100
–150
0
To: Out(4)
–50
–100
–150
0
To: Out(5)
–50
–100
–150
0
To: Out(6)
–50
–100
–150
10–2
100 101
10–2
100 101
10–2
100 101
10–2
100 101
10–2
100 101
10–2
100 101
FIGURE CS5.3
Spacecraft model dynamics. (Adapted from Garcia-Sanz, M. et al. 2008. J. ASME J. Dyn. Syst. Meas. Control, 130, 
011006-1–011006-15.)

398
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
CS5.3  Control Specifications
The main objective of the spacecraft control system is to meet a set of astronomical require­
ments, which need to keep the flying telescope pointing at both the observed space target 
and the central hub-satellite. This set of specifications leads to some additional engineer­
ing requirements (bandwidth, saturation limits, noise rejection, etc.) and also needs some 
complementary control requirements (stability, low loop interaction, low controller com­
plexity and order, etc.). Specifically, the requirements are
	
1.	Astronomical specifications:
	
a.	 Position accuracy: maximum absolute error ≤1 µm, and standard deviation 
≤0.33 µm for x, y, z axes.
	
b.	 Pointing accuracy: maximum absolute error ≤25 mas, and standard deviation 
≤8.5 mas for ϕ, θ, ψ axes.
	
2.	Engineering specifications:
	
a.	 Bandwidth: ∼0.01 Hz for all axes.
	
b.	 Saturation limits: Fx, Fy, Fz maximum force = 150 µN, Tϕ, Tθ, Tψ maximum 
torque = 150 µNm.
	
c.	 High frequency noise rejection: high roll-off after the bandwidth.
	
3.	Control specifications:
	
a.	 Loop interaction: minimum.
	
b.	 Rejection of flexible modes: maximum.
	
c.	 Controller complexity and order: minimum.
To achieve these goals, the astronomical, engineering, and control specifications are 
translated into frequency-domain requirements. This translation into the frequency 
domain is based on control-ratio models,259 and takes into account the expected exter­
nal disturbances on the spacecraft flexible modes and the coupling among loops. As a 
result, four specifications are defined to calculate the QFT bounds: Spec.1: Robust stability; 
Spec.2: Robust sensitivity; Spec.3: Robust disturbance rejection at plant input; and Spec.4: 
Robust control effort attenuation. The set of frequencies of interest is within the range: 
ω = [6.28 ⋅ 10−4, 62.8] rad/s.
Spec.1: Robust Stability
This specification, shown in Equation CS5.2, is stated to guarantee a robust stable 
­control. All the required values, displayed loop-by-loop in Equations CS5.3 and CS5.4, 
imply at least 1.54 (3.75 dB) gain margin and at least 49.25° phase margin. The specifica­
tion ­corresponds not only to the closed-loop transfer function yi(s)/ri(s), but also to trans­
fer functions yi(s)/ni(s) and ui(s)/di(s)—see Equations 2.35 and 2.36. Hence, this condition 
­additionally imposes the requirements on sensor noise attenuation, disturbance rejection 
at plant input, and flexible modes attenuation.
	
p
s
g s
p
s
g s
ii
e
i
ii
ii
e
i
ii
*
*
( )
( )
( )
( )
( )


+ 

≤
−
−
1
1
1
δ ω
1
	
(CS5.2)

399
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
Note that p
s
ii
e
i
* ( )


−1 is the inverse of the equivalent plant—see Equation 8.86, which cor­
responds to the diagonal plants pii(s).
	
Loops 1 2, and 3
1 85
1
,
:
( )
.
;
δ ω
ω
=
=
∀
Ws
	
(CS5.3)
	
Loops 4 5, and 6
0.1687
0.4
0.0912
1
2
,
:
( )
;
δ ω
ω
=
+
+
∀
s
s
	
(CS5.4)
Spec.2: Sensitivity Reduction
The main objective of this specification, Equations CS5.5 and CS5.6, is sensor noise attenu­
ation and reduction of the effect of the parameter uncertainty on the closed-loop transfer 
function—see Equation 2.37. It corresponds to the ei(s)/ni(s) and “[dtii(s)/tii(s)]/[dpii(s)/pii(s)]” 
transfer functions.
	
1
1
1
+ 

≤
−
p
s
g s
ii
e
i
ii
* ( )
( )
( )
δ ω
2
	
(CS5.5)
	
All loops
2
2
:
( )
;
δ ω
ω
=
∀
	
(CS5.6)
Spec.3: Rejection of Disturbances at Plant Input
Solar pressure perturbation and gravity gradient are considered to affect at plant input in 
the form of both force and torque. The purpose of this specification, Equation CS5.7, which 
corresponds to ei(s)/di(s) and yi(s)/di(s) transfer functions—see Equation 2.38, is to attenuate 
the effect of plant input disturbances on the control error and the output signal. Thus, a 
high gain is required in the low-frequency band, Equations CS5.8 through CS5.10. Besides, 
since di(s) also represents the flexible modes, special attention is paid to their frequency 
range to accomplish the attitude requirements.
	
p
s
p
s
g s
ii
e
i
ii
e
i
ii
*
*
( )
( )
( )
( )


+ 

≤
−
−
1
1
1
δ ω
3
	
(CS5.7)
	
Loops 1 and 2 :
( )
.
(
.
)
(
.
)(
.
)(
.
δ ω
3
2
0 21553
0 385
0 307
6 18
0 4
=
+
+
+
+
s
s
s
s
s+
∀
0 0912
.
) ;
ω
	
(CS5.8)
	
Loop 3
0.313
0.01705
0.009974
5.104 10
0.
5
:
(
)(
)
(
δ
ω
3
2
( )=
−
+
+
⋅
−
−
s
s
s
s
01813)
0.02554
0.0004754)
(
;
s
s
2 +
+
∀ω
	
(CS5.9)
	
Loops 4 5, and 6
0.2
0.186
0.2044
0.003892
,
:
( )
(
)(
)(
)(
)
δ ω
3
=
+
+
+
+
s
s
s
s
(
(
)(
)(
s
s
s
s
s
s
2
2
+
+
+
+
+
+
0.06014
0.02736)
0.007333
0.445
0.07904
0.00326)
0.2352
0.0981)
(
;
s
s
2 +
+
∀ω

(CS5.10)

400
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
Spec.4: Control Effort Reduction
Because of saturation limits, control signal movements should be kept reasonably small 
despite disturbances—see Equation 2.39. This specification, Equation CS5.11, corresponds 
to ui(s)/ni(s) transfer function and is depicted in Equations CS5.12 through CS5.14.
	
g s
p
s
g s
ii
ii
e
i
ii
( )
( )
( )
( )
*
1
1
+ 

≤
−
δ ω
4
	
(CS5.11)
	
Loops 1 and 2
5
5
3
s
6
4
:
( )
. (
)
(
.
. ) ;
δ ω
ω
=
+
+
+
∀
57 1
23
5
2
s
s
	
(CS5.12)
	
Loop 3
4
:
( )
.
(
.
)(
.
.
)
(
. ) (
.
δ ω =
+
+
+
+
+
106 9210
0 55
0 04
0 13
1 4
0 1
2
2
2
s
s
s
s
s
227
0 097
s+
∀
.
)
;
ω
	
(CS5.13)
	
Loops 4 5, and 6
4
,
:
( )
.
(
.
.
)(
.
.
)
δ ω =
−
+
+
+
4 026
0 1854
0 203
0 04
0 54
2
2
s
s
s
s
(
.
.
)(
.
.
)
;
s
s
s
s
2
2
0 305
0 056
0 115
0 095
+
+
+
+
∀ω
	
(CS5.14)
Reducing Coupling Effects as much as Possible
The coupling effects from other axes are considered as part of the disturbances acting at 
the input of the equivalent SISO plant. The design of the non-diagonal elements of the 
matrix compensator intends also to minimize the off-diagonal elements of the coupling 
matrices—see Equations 8.71 through 8.73.
CS5.4  Control System Design
The MIMO QFT method 1, explained in Sections 8.5 and 8.8, is applied here to design the 
6 × 6 robust control system for the spacecraft telescope described in Section CS5.2, and 
with the performance specifications defined in Section CS5.3.
Step A:  Input–Output Pairing and Loop Ordering
An example of RGA, calculated from low frequency (steady state) up to 0.19 rad/s, and for 
all cases within the uncertainty, is shown in Equation CS5.15. According to it, the pairing is 
selected through the main diagonal of the matrix, which contains positive RGA elements. 
In addition, due to the very demanding specifications, the RGA elements λ15, λ24, λ42, and 
λ51 are considered relevant as well.
	
RGA(
.
)
ω=
⋅
−
=
6 28 10 4 rad/s
1.0064
0
0
0
0.0064
0
0
1.0064
0
0.0064
0
0
0
0
−
−
1
0
0
0
0
0.0064
0
1.0064
0
0
0.0064
0
0
0
1.0064
0
0
0
0
0
0
1
−
−






	
(CS5.15)

401
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
Also, in accordance with this RGA results and taking into account the requirement 
of minimum controller complexity and order (Section CS5.3, Specification 3c), we select 
a controller structure with only six diagonal elements and two additional off-diagonal 
­elements—see Equation CS5.16.
	
G( )
( )
( )
( )
( )
( )
(
s
g
s
g
s
g
s
g
s
g
s
g
=
11
22
33
42
44
51
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
s
g
s
g
s
)
( )
( )
0
0
0
0
0
0
0
0
0
55
66






	
(CS5.16)
From this, four independent control design problems are adopted, two SISO controllers, 
[g33(s)] and [g66(s)], and two 2 × 2 MIMO controllers, [g11(s) 0; g51(s) g55(s)] and [g22(s) 0; g42(s) 
g44(s)]. The SISO problems are considered as a classical SISO QFT problem, while the two 
2 × 2 MIMO subsystems are studied through the non-diagonal MIMO QFT method 1—see 
Sections 8.5 and 8.8.
Step B0:  Design of Diagonal Controllers gkk(s), k = 3, 6—SISO Cases
The controllers g33(s) and g66(s) are independently designed by using classical SISO QFT to 
satisfy the performance specifications stated in Section CS5.3 for every plant within the 
uncertainty. The corresponding QFT bounds and the nominal open-loop transfer func­
tions Lii(s) = pii(s) gii(s), i = 3, 6, are plotted on the Nichols charts shown in Figure CS5.4. 
The expressions for g33(s) and g66(s) are shown in Equations CS5.24 and CS5.27, respectively.
For the two 2 × 2 MIMO problems, we follow the flow chart presented in Figure 8.19, 
MIMO QFT Method 1. As we do not have reference tracking specifications, we do not need 
prefilters and just follow the Steps B.1.1, B.1.3, B.2.1, and B.2.3.
Step B.1.1 (1st):  Design of Diagonal Controller g11(s)—First MIMO Problem
The compensator g11(s) is designed according to the non-diagonal MIMO QFT method 1, 
explained in Section 8.5, for the inverse of the equivalent plant [
( )]
( )
*
*
p
s
p
s
e
11
11
1 =
. 
–360 –315 –270 –225 –180 –135
–90
–45
0
–100
–50
0
50
100
(a)
(b)
Open-loop phase (deg)
Open-loop gain (dB)
Open-loop gain (dB)
Loop-shaping L33
L33 (j 6.3 10–4)
L33 (j 4.3 10–3)
L33 (j 0.03)
L33 (j 0.2)
B33 (j 0.26)
L33 ( j 62.82)
L33 (j 15)
L33 (j 0.33)
L33 (j 3.53)
L33 (j 1.61)
B33 (j 4.3 10–3)
B33 (j 0.03)
B33 (j 0.33)
L33 (j 0.26)
B33 (j 3.53)
B33 (j 15)
B33 (j 62.82)
B33 (j 0.2)
B33 (j 1.61)
–360 –315 –270 –225 –180 –135
–90
–45
0
–150
–100
–50
0
50
Open-loop phase (deg)
Loop-shaping L66
L66 (j 6.3 10–4)
L66 (j 4.3 10–3)
L66 (j 0.03)
L66 (j 0.2)
L66 (j 15)
L66 (j 0.33)
L66 (j 0.26)
 B66 (j 0.26)
B66 (j 6.3 10–4)
B66 (j 4.3 10–3)
B66 (j 0.03)
B66 (j 3.53)
B66 (j 15)
B66 (j 62.82)
L66 (j 2.72)
B66 (j 2.72)
B66 (j 0.33)
B66 (j 0.2)
L66 (j 3.53)
L66 (j 62.82)
B33 (j 6.3 10–4)
FIGURE CS5.4
Loop shaping: (a) L33(s) = p33(s) g33(s) and (b) L66(s) = p66(s) g66(s). (Adapted from Garcia-Sanz, M. et al. 2008. 
J. ASME J. Dyn. Syst. Meas. Control, 130, 011006-1–011006-15.)

402
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
Figure CS5.5a presents the bounds and achieved loop shaping. The expression for g11(s) is 
shown in Equation CS5.21.
Step B.1.3 (1st):  Design of Non-Diagonal Controller g51(s)—First MIMO Problem
The non-diagonal compensator g51(s) is designed to minimize the (5,1) element of the cou­
pling matrix in the case of disturbance rejection at plant input, which gives the following 
expression:
	
g
s
p
s
opt
N
51
51
( )
( )
*
= −
	
(CS5.17)
where N denotes the middle plant that interpolates the expression [
( )]
*
−p
s
51
 from 0 to 
10−1 rad/s, as shown in Figure CS5.6a. The expression for g51(s) is shown in Equation CS5.22.
–100
–80
–60
–40
–20
0
20
40
60
80
100
–150
–100
–50
0
50
–360 –315 –270 –225 –180 –135
–90
–45
0
(a)
(b)
Open-loop phase (deg)
Open-loop phase (deg)
Open-loop gain (dB)
Open-loop gain (dB)
Loop-shaping L11
L11 (j 6.3 10–4)
L11 (j 4.3 10–3)
L11 (j 0.2)
L11 (j 0.03)
L11 (j 0.26)
B11 (j 0.2)
B11 (j 0.26)
L11 (j 62.82)
L11 (j 3.53) L11 (j 1.61)
B11 (j 4.3 10–3)
B11 (j 0.33)
L11 (j 0.33)
B11 (j 3.53)
B11 (j 15)
L11 (j 15)
B11 (j 62.82)
B11 (j 0.03)
B11 (j 1.61)
–360 –315 –270 –225 –180 –135
–90
–45
0
Loop-shaping L55
L55 (j 6.3 10–4)
L55 (j 4.3 10–3)
L55 (j 0.03)
L55 (j 0.2)
L55 (j 0.43)
B55 (j 3.53)
L55 (j 0.33)
L55 (j 0.26)
B55 (j 0.26)
B55 (j 4.3 10–3)
B55 (j 0.03)
B55 (j 0.73)
B55 (j 15)
L55 (j 15)
B55 (j 0.43)
L55 (j 0.73)
B55 (j 0.33)
B55 (j 0.2)
L55 (j 3.53)
B11 (j 6.3 10–4)
B55 (j 6.3 10–4)
FIGURE CS5.5
Loop shaping: (a) L
s
p
s
g
s
e
11
11
1
1
11
( )
( )
( )
*
= 

−
 and (b) L
s
p
s
g
s
e
55
55
2
1
55
( )
( )
( )
*
= 

−
. (Adapted from Garcia-Sanz, M. et al. 
2008. J. ASME J. Dyn. Syst. Meas. Control, 130, 011006-1–011006-15.)
10–4
10–3
10–2
10–1
100
101
102
–150
–100
–50
0
50
100
150
(a)
(b)
Magnitude plot of g51(s)
Frequency (rad/s)
10–3
10–2
10–1
100
101
102
–100
–50
0
50
100
Magnitude plot of g42(s)
Frequency (rad/s)
Magnitude (dB)
Magnitude (dB)
FIGURE CS5.6
(a) Magnitude plot of [
( )]
−
∗
p
s
51
 with uncertainty and g51(s)—solid line and (b) magnitude plot of [
( )]
−
∗
p
s
42
 with 
uncertainty and g42(s)—solid line. (Adapted from Garcia-Sanz, M. et al. 2008. J. ASME J. Dyn. Syst. Meas. Control, 
130, 011006-1–011006-15.)

403
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
Step B.2.1 (1st):  Design of Diagonal Controller g55(s)—First MIMO Problem
The compensator g55(s) is designed according to the non-diagonal MIMO QFT method 1, 
explained in Section 8.5, for the inverse of the equivalent plant [
( )]
*p
s
e
55
2, which is
	
p
s
p
s
p
s
g
s
p
s
e
e
e
e
55
2
55
1
51
1
51
1
15
*
*
*
*
( )
( )
( )
( )
(
=

−
+ 

(
)
)
( )
( )
*


(
)

+[
]
(
)
1
11
1
11
1
p
s
g
s
e
	
Figure CS5.5b presents the bounds and achieved loop shaping. The expression for g55(s) 
is shown in Equation CS5.26.
Step B.2.3 (1st):  Design of Non-Diagonal Controller g15(s)—First MIMO Problem
As mentioned, the non-diagonal compensator g15(s) is chosen as null to simplify the 
­controller complexity, according to the specification 3c in Section CS5.3 and the RGA 
results:
	
g
s
opt
15
0
( ) =
	
(CS5.18)
The second MIMO problem is presented in the following steps. It consists of the design 
of the elements g22(s), g42(s), g44(s), and g24(s), which are equivalently performed as in the 
previous Steps B.1.1, B.1.3, B.2.1, and B.2.3, respectively.
Step B.1.1 (2nd):  Design of Diagonal Controller g22(s)—Second MIMO Problem
The compensator g22(s) is designed according to the non-diagonal MIMO QFT method 
1, explained in Section 8.5, for the inverse of the equivalent plant p
s
p
s
e
22
22
*
*
( )
( )

=
1
. 
Figure CS5.7a presents the bounds and achieved loop shaping. The expression for g22(s) is 
shown in Equation CS5.21.
–100
–80
–60
–40
–20
0
20
40
60
80
100
–150
–100
–50
0
50
–360
–315
–270
–225
–180
–135
–90
–45
0
(a)
(b)
Open-loop phase (deg)
Open-loop gain (db)
Open-loop gain (db)
Loop-shaping L22
–360
–315
–270
–225
–180
–135
–90
–45
0
Open-loop phase (deg)
Loop-shaping L44
L44 (j 6.3 10–4)
L44 (j 4.3 10–3)
L44 (j 0.03)
L44 (j 0.2)
L44 (j 3.53)
L44 (j 0.33)
L44 (j 0.26)
B44(j 0.2)
B44 (j 6.3 10–4)
B44 (j 4.3 10–3)
B44 (j 0.03)
B44 (j 3.53)
B44 (j 15)
B44 (j 0.73)
B44 (j 0.33)
B44 (j 0.26)
L44 (j 0.73)
L44 (j 15)
L22 (j 6.3 10–4)
L22 (j 4.3 10–3)
L22 (j 0.03)
L22 (j 0.2)
L22 (j 0.33)
B22 (j 0.33)
L22 (j 62.82)
L22 (j 15)
L22 (j 3.53)
L22 (j 1.61)
B22 (j 6.3 10–4)
B22 (j 4.3 10–3)
B22 (j 1.61)
B22 (j 15)
B22 (j 0.03)
B22 (j 3.53)
B22 (j 62.82)
B22 (j 0.2)
FIGURE CS5.7
Loop shaping (a) L
s
p
s
g
s
e
22
22
1
1
22
( )
( )
( )
*
= 

−
 and (b) L
s
p
s
g
s
e
44
44
2
1
44
( )
( )
( )
*
= 

−
. (Adapted from Garcia-Sanz, M. et al. 2008. 
J. ASME J. Dyn. Syst. Meas. Control, 130, 011006-1–011006-15.)

404
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
Step B.1.3 (2nd):  Design of Non-Diagonal Controller g42(s)—Second MIMO Problem
The non-diagonal compensator g42(s) is designed to minimize the (4,2) element of 
the ­coupling matrix in the case of disturbance rejection at plant input, which gives 
the ­following expression:
	
g
s
p
s
opt
N
42
42
( )
( )
*
= −
	
(CS5.19)
where N denotes the middle plant that interpolates the expression [
( )]
−
∗
p
s
42
 from 0 to 
10−1 rad/s, as shown in Figure CS5.6b. The expression for g42(s) is shown in Equation CS5.22.
Step B.2.1 (2nd): Design of Diagonal Controller g44(s)—Second MIMO Problem
The compensator g44(s) is designed according to the non-diagonal MIMO QFT method 1, 
explained in Section 8.5, for the inverse of the equivalent plant p
s
e
44
* ( )

2, which is
	
p
s
p
s
p
s
g
s
p
s
e
e
e
e
44
2
44
1
42
1
42
1
24
*
*
*
*
( )
( )
( )
( )
(
=

−
+ 

(
)
)
( )
( )
*


(
)

+[
]
(
)
1
22
1
22
1
p
s
g
s
e
Figure CS5.7b presents the bounds and achieved loop shaping. The expression for g44(s) 
is shown in Equation CS5.25.
Step B.2.3 (2nd):  Design of Non-Diagonal Controller g24(s)—Second MIMO Problem
As in Step B.2.3 (1st), the non-diagonal compensator g24(s) is chosen as null to simplify 
the controller complexity, according to the specification 3c in Section CS5.3 and the RGA 
results:
	
g
s
opt
24
0
( ) =
	
(CS5.20)
Steps B.k.2:  Design of Prefilters fkk(s), k = 1, 2,…,6
There is not prefilter required in this example, because we do not have reference tracking 
specifications. Then, fkk(s) = 1, k = 1, 2,…,6.
Controller Expressions
The notation adopted below for the transfer function expressions of the controllers denotes 
the steady state gain as a constant without parenthesis; simple poles and zeros as (ω), which 
corresponds to (s/ω + 1) in the denominator and numerator respectively; poles and zeros 
at the origin as (0); conjugate poles and zeros as [ζ; ωn], with ((s/ωn)2 + (2ζ/ωn)s + 1) in the 
denominator and numerator respectively; n-multiplicity of poles and zeros as an exponent 
()n. Following this notation, the MIMO QFT controller designed in this section consists of 
the following elements:
	
g
s
g
s
11
22
31 5( 6194)( 2138)( 1663)( 1649)
66
( )
( )
{
.
.
.
.
.
}
{( .
=
=
0
0
0
0
0
6
4982
7526
676 1 479
)( .
)( .
)[ .
; .
]}
0
0 0
0
	
(CS5.21)

405
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
	
g
s
g
s
51
42
2
3
42 4( )
3
( )
( )
{
.
}/{( . ) }
=−
=
0
0
	
(CS5.22)
	
g
s
g
s
15
24
( )
( )
=
= 0 	
(CS5.23)
	
g
s
33
125( 13)(
57)[
7 19
3565][1
2]
1 48
( )
{
.
.
.
; .
; .
}
{( .
)(
=
0
0 0
0 0 0
0
0 0
0.
)( . )( .
)( .
)[ .
; .
]}
7875
2
4
246
18
314
0
0 00
0 00
0
0
	
(CS5.24)
	
g
s
44
2 242(
3412)[
8644
7114][ 1131
3414][ 11
( )
{ .
.
.
; .
.
; .
.
=
0 0
0 0
0
0
0
0
45
26 4][
8792
2593]
[ 7
52][1
7]
977
; .
.
; .
. ; .
; .
}
{( .
0
0
0 00
0
0
0 00
0 000
0
6
8
5
2451
27 8
297
2673
5
2
2
)( . )( .
) [ .
; .
][ .
; .
][
.
; .
0
0 000
0
0
0
0
0
0 000
0
−
54
14
252
7
45
]
[ .
; .
][ . ; .
]}
0
0
0
0 00

(CS5.25)
g
s
55
2 242( 13)(
3)[ 1 79
7 99][
7 69
341][
( )
{ .
.
.
.
; .
.
; .
.
=
0
0 0
0 0
0 0
0 0 0
0
0 0
0
0
0 00
0 000
0
0
0
0 0
3
2593][ 7
52][1
7]
9776
8
12
; .
. ; .
; .
}
{( .
)( . )( .
)( . 00
0
0
0
0 000
0
0
0
0
0 00
5
2451
27 8
8
254
3
25
7
45
2) [ .
; .
][
.
; .
][ . ; .
][ . ; .
]
−
}

(CS5.26)
	
g
s
66
2 242 (
2584)[
8644
7114][ 1131
3414][ 1
( )
{ .
.
.
; .
.
; .
.
=
0 0
0 0
0
0
0
0 145
26 4][
8792
2593]
[ 7
52][1
7]
97
; .
.
; .
. ; .
; .
}
{( .
0
0
0 00
0
0
0 00
0 000
0
76
8
5
2451
27 8
297
2673
7
2
)( . )( .
) [ .
; .
][ .
; .
][
.
; .
0
0 000
0
0
0
0
0
0 000
0
−
254
1687
241
7
45
]
[ .
; .
][ . ; .
]}
0
0
0
0 00

(CS5.27)
CS5.5  Simulation and Validation
Time domain simulations were performed for 300 plants in the ESA spacecraft telescope 
benchmark simulator—see Figure CS5.8. The plant models were selected randomly within 
the space of uncertainty using a Monte Carlo technique. The same plants were used for all 
the participants in the benchmark.
The performance achieved for the position and attitude control by the non-diagonal 
MIMO QFT was excellent, meeting all the required specifications—see Section CS5.3. 
Moreover, the MIMO QFT obtained the best results in the benchmark—see maximum 
and standard deviation results in Table CS5.1, improving by two orders of magnitude the 
results obtained by the second classified, that used a H-infinity control technique.
At the same time, while the second classified required controller structures with full-
matrices of 36 elements of 42nd order, the non-diagonal MIMO QFT design consisted of 
only eight compensators with simple structures, all from 3rd to 14th order—see Equations 
CS5.21 through CS5.27, dividing by more than 20 the number of operations per second 
needed for the real-time control algorithm—see Table CS5.2.

406
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
Commanded
position and
attitude
+
+
+
–
Controller
Disturbance
force and torque
Fx
x
y
z
Fy
Fz
Tψ
Tθ
Tϕ
FEEP
thruster
Position and
attitude
measurement
Darwin flyer 6DOF
dynamics
Position
and attitude
Sensor
External disturbances
Actuator
ϕ
θ
ψ
G(s)
FIGURE CS5.8
ESA telescope-type spacecraft simulator. (Adapted from Garcia-Sanz, M. et al. 2008. J. ASME J. Dyn. Syst. Meas. 
Control, 130, 011006-1–011006-15.)
TABLE CS5.1
Time Simulation Performance with Controllers
Spec.
Non-Diagonal
MIMO QFT Controller
H-Infinity
Controller
Maximum Position Error X
<1 µm
0.0131
0.0816
0.0293
0.511
Maximum Position Error Y
<1 µm
0.0120
0.0120
0.0299
0.0299
Maximum Position Error Z
<1 µm
0.0288
0.0288
0.0292
0.0292
Maximum Attitude Error X
<25.5 mas
25.27
25.27
25.95
25.95
Maximum Attitude Error Y
<25.5 mas
22.91
22.55
23.21
28.91
Maximum Attitude Error Z
<25.5 mas
21.15
21.15
22.84
22.84
Standard Deviation of Position Error X
<0.33 µm
0.00275
0.0511
0.00686
0.341
Standard Deviation of Position Error Y
<0.33 µm
0.00265
0.00265
0.00722
0.00722
Standard Deviation of Position Error Z
<0.33 µm
0.00668
0.00668
0.00691
0.00691
Standard Deviation of Attitude Error X
<8.5 mas
5.57
5.57
5.68
5.68
Standard Deviation of Attitude Error Y
<8.5 mas
5.76
5.80
6.01
8.23
Standard Deviation of Attitude Error Z
<8.5 mas
4.83
4.83
5.00
5.00
Note:	 At each specification (each row), the best result (QFT or H-infinity) is in bold.

407
Case Study 5: Attitude and Position Control of Spacecraft Telescopes
CS5.6  Summary
This case study demonstrated the feasibility of the sequential non-diagonal MIMO robust 
QFT control strategies to simultaneously regulate the position and attitude of a 6 × 6 
spacecraft telescope with large flexible appendages. The spacecraft was part of a multiple 
­formation flying constellation of a ESA cornerstone mission. The controller satisfactory 
met the astronomical, engineering, and control requirements.
TABLE CS5.2
Number of Operations per Second Required by Controllers
Controller
# Multips/s
# Sums/s
Non-diagonal MIMO QFT
130
124
H-infinity
2994
2988


409
Appendix 1: Projects and Problems
A1.1 Projects
Project P1. Vehicle Active Suspension Control
	
1.	Chapters and Sections Needed: Chapter 2; Appendix 2; QFTCT
	
2.	Project Description: The marketing department of a major car manufacturer wants 
to sell a car that offers the smoothest possible ride. For this, the control system must 
minimize the accelerations felt by the passengers in the vehicle while it passes over 
uneven surfaces. To achieve this goal, the engineering department has designed an 
active suspension system that couples a force actuator to a preexisting suspension.
	
	
A schematic of the vehicle suspension system appears in Figure P1.1. The total 
vehicle chassis has mass 4m2 (m2 affects each wheel). It is suspended on a passive 
suspension with spring constant ks and damping coefficient b per wheel. The tire 
system is modeled as mass m1 and a stiffness kt. An accelerometer provides the 
acceleration of the vehicle body for feedback control, z(t) = d2y(t)/dt2, y(t) being the 
height of the vehicle body with respect to the road reference, and x(t) the height of 
the tire system with respect to the road reference.
	
	
The acceleration of the car chassis z(s), measured by the accelerometer, is the 
plant output. The plant inputs are the control signal u(s) and the road height d(s) 
with respect to the road reference. The variation of the road height is considered 
as the disturbance d(s) on the system to be rejected.
	
3.	Modeling: The generalized coordinates are the height of the vehicle body and wheel 
system, which are, respectively, q1 = y(t) and q2 = x(t)—see Figure P1.1. The kinetic, 
potential, and dissipation functions of the system are described by Equations P1.1 
through P1.3
	
E
m y
m x
k =
+
1
2
1
2
2
2
1
2


	
(P1.1)
	
E
k y
x
k x
p
s
t
=
−
+
−
1
2
1
2
0
2
2
(
)
(
)
	
(P1.2)
	
D
b y
x
d =
−
1
2
2
(
)


	
(P1.3)
	
	   The generalized force applied by the active damper between the masses m1 and 
m2 is Q1 = u(t). The generalized force applied by the road to the wheel is Q2 = d(t). 
Using Equations P1.1 through P1.3, the terms for the Euler–Lagrange expression 
are
	
d
dt
L
q
L
q
D
q
Q
i
n
i
i
d
i
i
∂
∂





−∂
∂
+ ∂
∂
=
=


,
, ,...,
1 2
	
(P1.4)

410
Appendix 1
	
d
dt
L
q
d
dt
E
y
E
x
m
i
k
k
∂
∂





=
∂
∂
∂
∂






=



2
0
0
m
y
x
1











=



Mq
	
(P1.5)
	
−∂
∂
= ∂
∂
=
∂
∂
∂
∂






=
−
−
+



L
q
E
q
E
y
E
x
k
k
k
k
k
i
p
i
p
p
s
s
s
s
t








=
y
x
Kq
	
(P1.6)
	
∂
∂
=
∂
∂
∂
∂






=
−
−









D
q
D
y
D
x
b
b
b
b
y
x
d
i
d
d







= C q
	
(P1.7)
	
Q
R
= −











=
1
0
1
1
u
d
u
	
(P1.8)
	
	   As described in the case studies, substituting Equations P1.5 through P1.8 in the 
Euler–Lagrange equation—Equation P1.4, we write the system as the state space 
description in Equations P1.9 through P1.12,
	
x
I
x
u
A x
Bu
y
I x
=
−
−






+






=
+
= 

−
−
−
M
C
M
K
M
R
1
1
1
0
0
0
= C x
	
(P1.9)
b
ks
Road surface
G(s)
Wheel
z(s) = s2y(s)
Accelerometer
Actuator
m2
kt
m1
y(s)
u(s)
x(s)
d(s)
Vehicle body
Road reference
FIGURE P1.1
Vehicle active suspension system.

411
Appendix 1
	
A =
−
−
−
−
+



b
m
b
m
k
m
k
m
b
m
b
m
k
m
k
k
m
s
s
s
s
t
2
2
2
2
1
1
1
1
1
0
0
0
0
1
0
0
(
)



	
(P1.10)
	
B
C
= −






=





1
0
1
1
0
0
0
0
0
0
1
0
0
0
0
1
2
1
1
m
m
m ;

	
(P1.11)
	
x
q
q
u
y
=





= 

=
=



y
x
y
x
u
d
y
x
T
T
T
;
[
] ;
[
]
	
(P1.12)
	
	   Now, applying the transformation in Equation P1.13, we obtain the transfer 
function p11(s) from the controller output u(s) to the vehicle body position y(s), and 
the transfer function p12(s) from the road height disturbance d(s) to the vehicle body 
position y(s), as shown in Equations P1.14 and P1.15, respectively.
	
P
C I
A
B
y
P
u
( )
(
)
,
( )
( ) ( )
s
s
s
s
s
=
−
=
−1
	
(P1.13)
 
y s
u s
p
s
m  s
k
m  m  s
b m + m  s
k  m
k  
t
t
s
( )
( )
( )
(
)
(
)
[
(
=
=
+
+
+
+
11
1
2
1
2
4
1
2
3
2
m + m
 s
bk  s
k  k
t
t
s
1
2
2
)]
+
+
	
(P1.14)
 
y s
d s
p
s
b s
k
m  m  s
b m + m  s
k  m
k  m
s
t
s
( )
( )
( )
(
)
(
)
[
(
=
=
+
+
+
+
12
1
2
4
1
2
3
2
1 + m
 s
bk  s
k  k
t
t
s
2
2
)]
+
+
	
(P1.15)
	
	   The variable we want to control is the vehicle acceleration z(s), which is defined 
in Equation P1.16 from Equations P1.14 and P1.15—see also Figure P1.2.
	
z s
s
p
s u s
p
s d s
( )
[
( ) ( )
( ) ( )]
=
+
2
11
12
	
(P1.16)
	
	   The parameters for the system are m1 = 10 kg, m2 ∈ [280, 400] kg, ks = 27,000 N/m, 
kt ∈ [70,600, 90,600] N/m, and b ∈ [650, 750] Ns/m.
	
4.	Preliminary Analysis: A quick inspection of the plants [s2 p11(s)] and [s2 p12(s)] shows 
that the system contains a double derivative (due to the accelerometer) and two 
significant resonances with a low damping around 8 rad/s and 90 rad/s—see 

412
Appendix 1
Figure P1.3. The controller will have to provide enough damping to reduce the 
potential oscillations of the system at these frequencies.
	
5.	Control Specifications: Taking into account the dynamics of the active suspension 
system and the vehicle objectives, we define the following robust specifications to 
control the plant z(s)/u(s) = s2 p11(s):
•	 Type 1: Stability specification
	
T s
s p
s G s
s p
s G s
Ws
1
2
11
2
11
1
1
1 3
0 001 0 005
( )
( ) ( )
( ) ( )
( )
=
+
≤
=
=
∈
δ ω
ω
.
[ .
.
0.01  0.05  0.1  0.5  1  5  7 8 9 10  50  80 90 100  500 rad/s
]
	
(P1.17)
	
	 which is equivalent to PM = 45.24°, GM = 4.96 dB—see Equations 2.30 and 2.31.
Magnitude (dB)
–100
–80
–60
–40
100
101
102
103
Phase (deg)
–45
0
45
90
135
180
Bode diagram
Frequency (rad/s)
s2 p11 
s2 p12 
FIGURE P1.3
Bode diagram for nominal plants z(s)/u(s) = [s2 p110(s)] and z(s)/d(s) = [s2 p120(s)].
+
u(s)
p11(s)
+
e(s)
G(s)
y(s)
+
+
n(s)
+
–
zr(s) = 0
d(s)
p12(s)
s2
z(s)
FIGURE P1.2
Control diagram for active suspension system.

413
Appendix 1
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T s
y s
d s
s p
s G j
s a
s a
a
d
d
d
3
2
11
3
1
1
1
1
( )
( )
( )
( ) (
)
( )
/
/
=
=
+
≤
=
(
)
(
)+
=
ω
δ ω
ω
;
∈[ .
.
]
0 001 0 005 0.01  0.05  0.1  0.5 rad/s
	
(P1.18)
	
6.	Questions
	
a.	 Attenuate the road disturbances as much as possible, reducing the vehicle 
body acceleration z(s). For that, design a suitable controller G(s) to regulate the 
plant [s2 p11(s)]—Equations P1.14 and P1.16, considering all the plants within the 
model uncertainty, and guaranteeing the stability and disturbance rejection 
specifications defined in Equations P1.17 and P1.18.
	
b.	 Plot and compare the Bode diagrams of the sensitivity transfer function 
z(s)/d(s) in both cases, open-loop and closed-loop with the new controller G(s).
	
c.	 Simulate the time response of the vehicle acceleration z(t) when the road intro­
duces a unitary impulse d(t), and in both cases, open loop and closed loop with 
the new controller G(s).
Project P2. DVD-Disk Head Control
	
1.	Chapters and Sections Needed: Chapter 2; Appendix 2; QFTCT.
	
2.	Project Description: Consider the position control system for the read/write head of 
a DVD device shown in Figure P2.1. The mechanism consists of a primary motor 
(under the disk) that rotates the DVD disk at a constant speed, and an arm that 
holds the read/write head at a constant and small distance above the disk surface. 
At the same time, a second motor with a control system is used to move the read/
write head horizontally, following the reference xr(s) received from a computer.
	
3.	Modeling: The dynamics of the horizontal movement (plane of the paper) of the 
read/write head is described by Equation P2.1, where P(s) is the transfer function 
between the motor input u(s) and the horizontal position of the read/write head 
x(s). The control system for the DVD device is shown in Figure P2.2.
	
x s
u s
P s
K bs
s
s
s
n
n
( )
( )
( )
(
)
=
=
+
(
)+(
) +
(
)
1
2
1
2
2
2
ω
ζ ω
	
(P2.1)
Motor
Controller
Sensor
DVD
xr(s)
x(s)
u(s)
FIGURE P2.1
Position control system for the read/write head of a DVD device (top-down view).

414
Appendix 1
	
	   The parameters for the flexible arm are ωn = 50 rad/s, ζ ∈ [8, 12] × 10−4, and for 
the motor and mechanism K ∈ [1.5, 2.5], b ∈ [3, 5] × 10−5, M(s) = 1.
	
4.	Preliminary Analysis: A quick inspection of the plant P(s) shows that the system 
contains a double integrator with a very low damping second-order dynamics 
at ωn = 50 rad/s due to the flexible arm—see also Figure P2.3. These facts will 
require the controller to provide a significant damping to reduce the potential 
oscillations of the read/write head.
	
5.	Control Specifications: Taking into account the dynamics of the DVD mechanism 
and the operation objectives, we define the following robust control specifications:
•	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
Ws
1
1
1
1 3
0 001 0 005
(
)
(
) (
)
(
) (
)
( )
0.0
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[ .
.
1  0.05  0.1  0.5  1  5  10  50  100  500 rad/s
]
	
(P2.2)
+
u(s)
P(s)
+
e(s)
G(s)
F(s)
n(s)
+
+
+
–
xr(s)
d(s)
M(s)
x(s)
FIGURE P2.2
2DOF control system for the DVD device.
100
101
102
Frequency (rad/s)
Magnitude (dB)
–80
–60
–40
–20
0
Phase (deg)
–360
–315
–270
–225
–180
Bode diagram
P(s)
FIGURE P2.3
Bode diagram for nominal plant P0(s).

415
Appendix 1
	
	 which is equivalent to PM = 45.24°, GM = 4.96 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
x j
d j
P j
G j
s a
s a
a
d
d
d
3
3
1
1
1
1
(
)
(
)
(
)
(
) (
)
( )
/
/
o
ω
ω
ω
ω
ω
δ ω
=
=
+
≤
=
(
)
(
)+
=
;
00
0 001 0 005
ω ∈[ .
.
]
0.01  0.05  0.1  0.5  1  5  10 rad/s
	
(P2.3)
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
_lo
_up
T j
F j
P j
G j
P j
G j
<
=
+
≤
∈
6
1
0 0
[ . 01 0 005
.
]
0.01  0.05  0.1  0.5  1  5 rad/s
	
(P2.4)
	
δ
ε
ε
6
2
1
1
6
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
(
)+


=
=
(
)
;
;
	
(P2.5)
	
δ
ε
ω
ζ
ω
ζ
6
2
1
1
2
1
2
0 8
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
;
. ; ω
ζ
ε
n
U
up
a
=
=
1 25
0
.
;
	
(P2.6)
	
6.	Questions
	
a.	 Design a feedback controller G(s) and a prefilter F(s) to control the DVD head 
position—plant P(s), Equation P2.1, meeting the robust stability and perfor­
mance specifications defined above—Equations P2.2 through P2.6.
	
b.	 Simulate the output x(s) of the closed-loop control system when the reference 
xr(s) changes as a step input, from 0 to 1, at t = 1 s, and when a unitary step 
disturbance d(s) hits the system at t = 5 s—see Figure P2.2.
Project P3. Inverted Pendulum Control
	
1.	Chapters and Sections Needed: Chapters 2, 3, 9; Appendices 2, 3; QFTCT.
	
2.	Project Description: Consider an inverted pendulum mounted on a cart, as 
shown in Figure P3.1. The cart is moved horizontally by a motor connected to a 
belt-pulley system. The pendulum moves in the vertical plane and turns about 
a perpendicular axis fixed to the cart.
	
	
The system has two encoders that measure the two main variables: the angle of 
the pendulum with the vertical axis θ(t) and the horizontal position of the cart x(t). 
The motor applies a horizontal force F(t). The pendulum has a mass m at the end 
of a rod. The rod is assumed to have zero mass and a length h. The cart mass is M. 
There is no friction in the system.
	
3.	Modeling: The generalized coordinates are the horizontal position of the cart and 
the angle of the pendulum with the vertical axis, which are respectively q1 = x(t) 
and q2 = θ (t)—see Figure P3.1. The cart and pendulum have no friction. This means 

416
Appendix 1
that the dissipation function is zero (Dd = 0). The kinetic and potential functions of 
the system are described by Equations P3.1 and P3.2
	
E
M x
m
d
dt x
h
d
dt h
k =
+
+
(
)





+
(
)









1
2
1
2
2
2
2

sin
cos
θ
θ




	
(P3.1)
	
E
E
m g h
p
p
=
+
0
cosθ 	
(P3.2)
	
	 being Ep0 the potential energy of the mass m for θ = 90°. The generalized force 
applied horizontally by the motor to the cart is u = F(t). The expression for the 
Lagrangian (L = Ek – Ep) is
	
L
M x
m
x
h
h
E
m g h
p
=
+
+
+
−
−
1
2
1
2
2
2
2
0




[(
cos )
(
sin ) ]
cos
θ
θ
θ
θ
θ
	
(P3.3)
	
	 Using Equation P3.3 in the Euler–Lagrange equation
	
d
dt
L
q
L
q
D
q
Q
i
n
i
i
d
i
i
∂
∂





−∂
∂
+ ∂
∂
=
=


,
, ,...,
1 2
	
(P3.4)
	
	 we obtain the equations related to x and θ, so that
	
(
)
cos
sin
M
m x
mh
mh
F
+
+
−
=



θ
θ
θ
θ
2
	
(P3.5)
	


x
h
g
cos
sin
θ
θ
θ
+
−
= 0 	
(P3.6)
F(t)
Encoder 1
Cart
M
m
k
h
Encoder 2
Rail
x(t)
θ(t)
End
End
Frame
Motor
Belt
FIGURE P3.1
Inverted pendulum.

417
Appendix 1
	
	 which can be linearized for small θ angles as
	
(
)
M
m x
mh
F
+
+
=

θ
	
(P3.7)
	


x
h
g
+
−
=
θ
θ
0 	
(P3.8)
	
	
Using these expressions, and considering a state vector x = [
]
x
x
T


θ
θ , 
the state-space description of the system ( x
A x
Bu
=
+
;y
C x
=
) becomes
	




x
x
m g
M
M
m g
M h
θ
θ






=
−
+


0
1
0
0
0
0
0
0
0
0
1
0
0
0
(
)










+
−



x
x
M
M h


θ
θ
0
1
0
1




F
	
(P3.9)
	
x
x
x
θ
θ
θ





=












1
0
0
0
0
0
1
0


	
(P3.10)
	
	
Now, applying P
C
I
A
B
( )s
s
=
−
(
)
−1
 for y
P
u
( )
( ) ( )
s
s
s
=
, the transfer function 
p21(s), from the force F(s) to the angle of the pendulum θ(s), is
	
θ( )
( )
( )
[
(
) ]
s
F s
p
s
M hs
M
m g
=
= −
+
+
21
2
1
	
(P3.11)
	
	
Also, for the cases where the mass of the cart is much larger than the mass at 
the tip of the pendulum, M ≫ m, the transfer function p11(s) from the force F(s) to 
the cart position x(s) is
	
x s
F s
p
s
hs
g
s
M hs
M
m g
M s
( )
( )
( )
[
(
) ]
=
=
−
+
−
+
+
≈
11
2
2
2
2
1
	
(P3.12)
	
	
Figure P3.2 shows the block diagram with the transfer functions p11(s) and p21(s) 
and the angle control system.
	
	
The fixed parameters of the pendulum are h = 0.5 m, and g = 9.8 m/s2. 
The parameters with uncertainty are m ∈ [0.05, 0.09] kg and M ∈ [1.5, 2.5] kg.
	
4.	Preliminary Analysis: A quick inspection of the plant p21(s) shows that the system 
is unstable. It has two real and symmetric poles, one of them in the left-half plane 

418
Appendix 1
(stable) and the other one in the right-half plane (unstable)—see Equation P3.13. 
The controller will have to stabilize the system.
	
s
M
m g
M h
= ±
+
(
)
	
(P3.13)
	
	
On the other hand, the plant p11(s)—cart position control is a double integrator. 
The controller will have to provide enough damping to reduce the oscillations of 
the cart position.
	
5.	Control Specifications
•	 For the pendulum angle control, Gθ(s). Taking into account the dynamics of the 
inverted pendulum, we define the following robust control specifications—
with H(s) = 1:
–	 Type 1: Stability specification
	
T j
p
j
G j
p
j
G j
Ws
1
1
1
1 08
(
)
(
)
(
)
(
)
(
)
( )
0.01  
21
21
ω
ω
ω
ω
ω
δ ω
ω
θ
θ
=
+
≤
=
=
∈
.
[
0.05  0.1  0.5  1  5  10  50  100  500 rad/s
]
	
(P3.14)
	
which is equivalent to PM = 55.16°, GM = 5.69 dB—see Equations 2.30 
and 2.31.
–	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
j
d j
p
j
G j
s
s
o
3
3
2
1
1
0 025
0 2
0 0
(
)
(
)
(
)
(
)
(
)
( )
21
ω
θ ω
ω
ω
ω
δ ω
θ
=
=
+
≤
=
+
+
.
.
. 18
0 025
10
1
2
.
[
]
s
s
+
+
∈
ω
0.1  0.5  1  5  10  50 rad/s
	
(P3.15)
Control
system
+
+
+
F(s)
+
+
+
+
xr(s)
θr(s)
θ(s)
dx(s)
p11(s)
+
nx(s)
nθ(s)
dθ(s)
x(s)
p21(s)
FIGURE P3.2
Control system for inverted pendulum.

419
Appendix 1
•	 For the cart position control, Gx(s) and Fx(s). Taking into account the dynamics 
of the inverted pendulum, we define the following robust control specifica­
tions—also with H(s) = 1:
–	 Type 1: Stability specification
	
T j
p
j
G j
p
j
G j
W
x
x
s
1
1
1
1 08
(
)
(
)
(
)
(
)
(
)
( )
0.01  
11
11
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
0.05  0.1  0.5  1  5  10  50  100  500 rad/s
]
	
(P3.16)
	
which is equivalent to PM = 55.16°, GM = 5.69 dB—see Equations 2.30 
and 2.31.
–	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
6
6
( )
(
)
(
)
(
)
(
)
(
)
(
)
(
_lo
x
x
x
_up
T j
F j
p
j
G j
p
j
G j
<
=
+
≤
6
11
11
1
)
0.01  0.05  0.1  0.5  1 rad/s
ω ∈[
]
	
(P3.17)
	
δ
ε
ε
6
2
1
1
0 25
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
.
;
	
(P3.18)
 
δ
ε
ω
ζ
ω
ζ
6
2
1 1
2
1
0 1
0
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
. ;
.8
1 25
0 05
;
.
;
.
ω
ζ
ε
n
U
up
a
=
=
	
(P3.19)
	
6.	Questions
	
a.	 Design a feedback controller Gθ(s) to stabilize the angle of the pendulum—
plant p21(s), Equation P3.11, keeping it in the upright position (θr = θ = 0°) and 
meeting the stability and performance specifications defined above—Equa­
tions P3.14 and P3.15.
	
b.	 Design a feedback controller Gx(s) and a prefilter Fx(s) to control the position 
of the cart—plant p11(s), Equation P3.12, meeting the stability and performance 
specifications defined above—Equation P3.16 through P3.19.
	
c.	 As the system has two sensors, θ(s) and x(s), and only one actuator, F(s), design 
an override control topology to deal with the two objectives: stabilize and keep 
upright the angle of the pendulum (primary objective, θr = 0), and keep the 
cart position close to the middle of the rail (secondary objective, xr = 0). Design 
the selector based on the information of the sensors.
	
d.	 Simulate the complete system: override structure, with the pendulum angle 
control system and the cart position control system. Being at the initial condi­
tions (t = 0) at θr = θ = 0° (upright position) and xr = x = 0 (middle of the rail), 
introduce positive and negative small pulse disturbances dθ at the pendulum 
angle θ(s) and analyze the results—see Figure P3.2.
Project P4. Interconnected Micro-Grids Control
	
1.	Chapters and Sections Needed: Chapters 2, 9; Appendix 2; QFTCT.
	
2.	Project Description: Consider the two interconnected micro-grids shown in 
Figure P4.1. The first micro-grid “a” is composed of one conventional generator 

420
Appendix 1
and a wind farm. The second micro-grid “b” is composed of two conventional 
generators.
	
	
Each conventional generator includes a valve, a turbine, a gearbox, an electrical 
generator, and a transformer. The valve can regulate the mechanical power ΔPmec 
that enters in the turbine, and as a result the electrical power that goes to the micro-
grid. Each micro-grid has an electrical load ΔPload that consumes the power. The wind 
farm injects a random power ΔPWF into the first micro-grid. The micro-grids are con­
nected through a tie-line. The power that goes from micro-grid “a” to micro-grid 
“b” through the tie-line is denoted as ΔPtie-line. The frequency variation in the first 
micro-grid is expressed as Δωa = ωa − ωref, and the frequency variation in the second 
micro-grid as Δωb = ωb − ωref, being the frequency base ωref = 377 rad/s (= 60 Hz).
	
3.	Modeling: The Laplace model for the two micro-grids, with the electrical genera­
tors, turbines valves and the tie line, is shown in Figure P4.2. The details of the 
control system are shown in Figures P4.3 through P4.6.
	
	 The parameters of the system are:
	
	 Micro-grid “a”
	
	 Generator unit a1
•	 Turbine and generator: Ma1 = 4.5 pu MW/pu freq/s.
•	 Valve: Tva1 = 2 s. Valve saturation: upper limit = +1, lower limit = 0.
	
	 Change in load due to change in frequency in micro-grid “a”: Da = 0.9.
Micro-grid
“a”
Micro-grid
“b”
Pload_b(s)
Ptie_line(s)
from micro-grid_a_to_b
Tie-line
Generator a1
Transformer 
a1
Turbine 
a1
Valve 
a1
∆Pmec_a1(s)
Generator b1
Transformer 
b1
Turbine 
b1
Valve 
b1
∆Pmec_b1(s)
∆Pmec_b2(s)
Generator b2
Transformer 
b2
Turbine 
b2
Valve 
b2
∆Pload_a(s)
∆PWF(s)
Wind farm
FIGURE P4.1
Interconnected micro-grids.

421
Appendix 1
–
+
–
T
s
1
1
(Mb1 + Mb2) s + Db
Ma1 s + Da
+
Valve b1
Turbines + generators
Micro-grid “b”
1
+
Valve b2
+
Turbines + generators
Micro-grid “a”
1
Tva1 s + 1
Tvb1 s + 1
Tvb2 s + 1
+
Valve a1
–
1
–
T = Tie-line
stiffness coefficient
From “a” to “b”
+
ub1(s) = 
ua1(s) = 
∆Pvalve_a1(s)
∆Pload_a(s)
∆Pload_b(s)
∆Pmec_a1(s)
∆ωa(s)
∆ωb(s)
∆Pmec_b2(s)
∆Pmec_b1(s)
∆PWF(s)
∆Pvalve_b1(s)
ub2(s) = 
∆Pvalve_b2(s)
Ptie_line(s)
FIGURE P4.2
Model of micro-grids “a” and “b” and tie-line.
Micro-grid
“a”
Micro-grid
“b”
Tie-line
Generator a1
Transformer
a1
Turbine
a1
Valve
a1
Generator b1
Transformer
b1
Turbine 
b1
Valve 
b1
Generator b2
Transformer
b2
Turbine 
b2
Valve
b2
Wind farm
Control b1
Control a1
Control b2
ACE
Pload_b(s)
Ptie_line(s)
from micro-grid_a_to_b
Ptie_line(s)
∆Pmec_a1(s)
∆Pmec_b1(s)
∆Pmec_b2(s)
∆Pload_a(s)
∆PWF(s)
ub1(s) = 
ua1(s) = 
∆PC_a1(s)
∆Pvalve_a1(s)
∆PC_b1(s)
∆PC_b2(s)
Psi_ab(s)
∆Pvalve_b1(s)
ub2(s) = 
∆Pvalve_b2(s)
ωa(s)
ωa(s)
ωb(s)
ωb(s)
ωb(s)
ωb(s)
ωref (s)
ωref (s)
ωref (s)
ωa(s)
FIGURE P4.3
Frequency control systems (a1, b1, and b2) and area control error system (ACE) for the two interconnected 
micro-grids.

422
Appendix 1
+
T
s
+
+
+
+
from “a” to “b”
+
Control
Ca1
Control
Cb2
Control
Cb1
Control
ACEa
Control
ACEb
+
Scheduled net power interchange
from “a” to “b”
+
–
–
–
–
–
–
1
1
(Mb1 + Mb2) s + Db
Ma1 s + Da
Valve b1
Turbines + generators
Micro-grid “b”
1
Valve b2
1
Tva1 s + 1
Tvb1 s + 1
Tvb2 s + 1
Valve a1
1
T = Tie-line
stiffness coefficient
ub1(s) = 
ua1(s) = 
∆Pvalve_a1(s)
∆Pload_a(s)
∆Pload_b(s)
∆Pmec_a1(s)
∆ωa(s)
∆ωa(s)
∆ωa(s) = ωa(s) – ωref (s)
∆ωb(s) = ωb(s) – ωref (s)
∆ωb(s)
∆ωb(s)
∆ωb(s)
∆ωb(s)
∆Pmec_b2(s)
∆Pmec_b1(s)
∆PWF(s)
∆Pvalve_b1(s)
ub2(s) = 
∆Pvalve_b2(s)
Ptie_line(s)
Turbines + generators
Micro-grid “a”
Ptie_line(s) from “a” to “b”
Psi_ab(s)
∆PC_a1(s)
∆PC_b1(s)
∆PC_b2(s)
FIGURE P4.4
Frequency control systems (Ca1, Cb1, and Cb2) and area control error system (ACEa and ACEb) for the two inter­
connected micro-grids.
Gb1(s)
Gb2(s)
Hb1(s)
Hb2(s)
Ha1(s)
Ga1(s)
ub1(s) = 
ua1(s) = 
∆PC_a1(s)
∆Pvalve_a1(s)
∆PC_b1(s)
∆PC_b2(s)
∆Pvalve_b1(s)
ub2(s) = 
∆Pvalve_b2(s)
∆ωb(s)
∆ωb(s)
∆ωa(s)
−
−
+
+
−
+
FIGURE P4.5
Frequency control blocks: Ca1, Cb1, and Cb2.

423
Appendix 1
	
	 Participation factors: γa1 = 1.
	
	 Frequency bias factor: Ba = Da + Ha1.
	
	 Micro-grid “b”
	
	 Generator unit b1
•	 Turbine and generator: Mb1 = 2.5 pu MW/pu freq/s.
•	 Valve: Tvb1 = 5 s. Valve saturation: upper limit = +1, lower limit = 0.
	
	 Generator unit b2
•	 Turbine and generator: Mb2 = 3 pu MW/pu freq/s.
•	 Valve: Tvb2 = 4.5 s. Valve saturation: upper limit = +1, lower limit = 0.
	
	 Change in load due to change in frequency in micro-grid “b”: Db = 0.8.
	
	 Participation factors: γb1 = 0.7; γb2 = 0.3.
	
	 Frequency bias factor: Bb = Db + Hb1 + Hb2.
	
	 Tie line
	
	 Tie-line stiffness coefficient: T = 377 × 0.02 pu = 7.5 pu.
	
	 Bases
	
	 Frequency base = 377 rad/s (= 60 Hz).
Scheduled net
power inter-
change from
“a” to “b”
ACEa
ACEb
Control
ACEa
Control
ACEb
Ba
Bb
Fα
Gα
Fβ
Gβ
∆PC_a1(s)
Psi_ab(s)
∆PC_b1(s)
∆PC_b2(s)
∆Pωb(s)
∆Pωa(s)
γa1
γb1
γb2
∆PCb(s)
∆PCa(s)
∆ωb(s)
∆ωa(s)
−
−
−
+
+
+
Ptie_line(s) from “a” to “b”
FIGURE P4.6
Area control error blocks: ACEa and ACEb.

424
Appendix 1
	
	 Micro-grid “a”. MVA base = 2.
	
	 Micro-grid “b”. MVA base = 10.
	
4.	Control Specifications
•	 For the frequency control loops, Ga1(s), Gb1(s), and Gb2(s).
–	 Type 1: Stability specification
	
T j
p j
G j
p j
G j
Ws
1
1
1
2 62
(
)
(
) (
)
(
) (
)
( )
0.01  0.05  
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
0.1  0.5  1  5  10  50  100  500 rad/s
]
	
(P4.1)
	
which is equivalent to PM = 22.0°, GM = 2.8 dB—see Equations 2.30 
and 2.31.
•	 For the area control error loops, Gα(s), Fα(s), Gβ(s), and Fβ(s).
–	 Type 1: Stability specification
	
T j
p j
G j
p j
G j
Ws
1
1
1
1 001
(
)
(
) (
)
(
) (
)
( )
0.01  0.05 
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
 0.1  0.5  1  5  10  50  100  500 rad/s
]
	
(P4.2)
	
which is equivalent to PM = 59.93°, GM = 6.01 dB—see Equations 2.30 
and 2.31.
–	 Type 6: Reference tracking specification—see Figure P4.7
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
0.0
_lo
_up
T j
F j
p j
G j
p j
G j
<
=
+
≤
∈
6
1
[
1  0.05  0.1  0.5  1 rad/s
]
	
(P4.3)
0
5
10
15
20
25
30
0
0.2
0.4
0.6
0.8
1
1.2
Step response
Time (s)
Amplitude
δ6-up(s)
δ6-lo(s)
FIGURE P4.7
Reference tracking specifications for area control error.

425
Appendix 1
	
δ
ε
ε
6
2
1
1
0 35
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
.
;
	
(P4.4)
	
δ
ε
ω
ζ
ω
ζ
6
2
1 1
2
1
0 2
0
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
. ;
.8
1 25
0
;
.
;
ω
ζ
ε
n
U
up
a
=
=
	
(P4.5)
	
5.	Controllers’ Design: We propose two control solutions for this project. The first one 
is based on the popular Droop control + PI control, which is very common in 
power systems. The second one is an open design that allows the designer to use 
any structure for a higher performance.
•	 Case 1. Classical droop control and PI control.
–	 Frequency loops with droop control: Due to the load-sharing problem, the 
blocks Ga1(s), Gb1(s), and Gb2(s) are first-order systems and the blocks Ha1(s), 
Hb1(s), and Hb2(s) pure gains, as shown in Equations P4.6 through P4.8.
–	 Area control error with PI control: The blocks Gα(s), Gβ(s) are PI controllers and 
the blocks Fα(s), Fβ(s) unitary gains, as shown in Equations P4.9 and P4.10.
	
G
s
s
k
R
H
s
R
a
ia
a
a
a
1
1
1
1
1
1
1
1
( )
/(
)
=
+
=
(
)
;
( )
	
(P4.6)
	
G
s
s
k
R
H
s
R
b
ib
b
b
b
1
1
1
1
1
1
1
1
( )
/(
)
=
+
=
(
)
;
( )
	
(P4.7)
	
G
s
s
k
R
H
s
R
b
ib
b
b
b
2
2
2
2
2
1
1
1
( )
/(
)
=
+
=
(
)
;
( )
	
(P4.8)
	
G s
k
T
T s
s
F s
i
i
α
α
α
α
α
( ) =





+
=
(
) ;
( )
1
1
	
(P4.9)
	
G s
k
T
T s
s
F s
i
i
β
β
β
β
β
( ) =






+
=
(
) ;
( )
1
1
	
(P4.10)
•	 Case 2. Open design.
–	 Frequency loops: The blocks Ga1(s), Gb1(s), Gb2(s), Ha1(s), Hb1(s), and Hb2(s) have 
a non-restricted structure and are designed with the robust QFT control 
methodology.
–	 Area control error: The feedback controllers Gα(s), Gβ(s) and the prefilters 
Fα(s), Fβ(s) have a non-restricted structure and are designed with the robust 
QFT control methodology.
	
6.	Questions
	
a.	 Case 1. Classical droop control and PI control. For the frequency control loops 
of both micro-grids, design the parameters Ra1, kia1, Rb1, kib1, Rb2, and kib2 of the 
droop controllers—see Equations P4.6 through P4.8—to meet the specification 
defined in Equation P4.1. Use QFT with the restricted droop control structure.

426
Appendix 1
	
b.	 Case 1. Classical droop control and PI control. To control the interchange of 
power with the area control error loops, design the parameters kα, Tiα, kβ, and 
Tiβ of the PI controllers—see Equations P4.9 through P4.10—to meet the speci­
fications defined in Equations P4.2 through P4.5. Use QFT with the restricted 
PI control structure.
	
c.	 Case 1. Classical droop control and PI control. Simulate the frequency control of both 
micro-grids and the power exchange between them with the following events:
	
	
ωref = 60 Hz. Total time of simulation = 2500 s.
	
	
ΔPload_a(t = 0) = 0.6; ΔPload_a(t = 750) = 0.3;
	
	
ΔPload_b(t = 0) = 0.7; ΔPload_b(t = 1500) = 0.2;
	
	
ΔPWF = 0.1 sin(t 2π/500) + 0.1;
	
	
Psi_ab(t = 0) = 0; Psi_ab(t = 2000) = –0.4 (grid b gives 0.4 pu to grid a at t = 2000).
	
d.	 Case 2. Open design. For the frequency control loops of both micro-grids, 
design non-restricted structure functions Ga1(s), Gb1(s), Gb2(s), Ha1(s), Hb1(s), and 
Hb2(s) with the robust QFT control methodology to meet the specification 
defined in Equation P4.1.
	
e.	 Case 2. Open design. To control the interchange of power with the area con­
trol error loops, design non-restricted structure feedback controllers Gα(s) and 
Gβ(s), and the prefilters Fα(s) and Fβ(s), with the robust QFT control methodol­
ogy to meet the specifications defined in Equation P4.2 through P4.5.
	
f.	 Case 2. Open design. Simulate the frequency control of both micro-grids and 
the power exchange between them with the following events:
	
	
ωref = 60 Hz. Total time of simulation = 2500 s.
	
	
ΔPload_a(t = 0) = 0.6; ΔPload_a(t = 750) = 0.3;
	
	
ΔPload_b(t = 0) = 0.7; ΔPload_b(t = 1500) = 0.2;
	
	
ΔPWF = 0.1 sin(t 2π/500) + 0.1;
	
	
Psi_ab(t = 0) = 0; Psi_ab(t = 2000) = –0.4 (grid b gives 0.4 pu to grid a at t = 2000).
Project P5. Distillation Column Control
	
1.	Chapters and Sections Needed: Chapters 2, 8; Appendix 2; QFTCT
	
2.	Project Description: Consider the 2 × 2 distillation column shown in Figure P5.1. The 
inputs are the reflux u1(s) and the boil up u2(s), and the controlled outputs are the top 
and bottom product compositions y1(s) and y2(s). The transfer function matrix is260
	
y s
y s
s
k
k
u s
u s
1
2
1
2
1
2
1
1
86 4
108 2
( )
( )
.
.
( )
( )





=
+
−








τ




	
(P5.1)
	
	 with the parameters: k1 = 87.8, k2 = –109.6, and τ = 75.
	
3.	Control Specifications: For each loop, the control specifications are
•	 Type 1: Stability specification
	
p s g s
p s g s
W
ii
ii
ii
ii
s
( )
( )
( )
( )
( )
0.001  0.005  
1
1 305
1
+
≤
=
=
∈
δ ω
ω
.
[
0.01  0.05  0.1  0.5  1  5  10  50  100  500 rad/s
]
	
(P5.2)

427
Appendix 1
	
which is equivalent to PM = 45.06°, GM = 4.94 dB.
•	 Type 3: Sensitivity or disturbances at plant output specification
	
y s
d s
p s g s
s a
s a
a
i
i
ii
ii
d
d
d
( )
( )
( )
( )
( )
/
/
0.0
=
+
≤
=
(
)
(
)+
=
∈
1
1
1
1
3δ ω
ω
;
[
01  0.005  0.01  0.05  0.1  0.5  1 rad/s
]
	
(P5.3)
	
4.	Questions. Group 1
	
a.	 Calculate the Bristol relative gain analysis array.
	
b.	 Find the best input/output pairing and describe the coupling (in %) between 
the loops.
	
c.	 Design two SISO controllers, g11siso(s) and g22siso(s), with QFT. Suggested struc­
ture: 1 zero, 1 pole, and 1 integrator.
	
d.	 Simulate the MIMO system with the two independent SISO controllers 
­calculated in the previous question.
	
e.	 Design a MIMO QFT controller according to Method 2 (Sections 8-6.2 and 8.9, 
with a 2 × 2 Gα, g11
β and g22
β). Suggested structure for gii
β(s): 1 zero, 1 pole, 1 
integrator. Hint: for matrix transfer operations, use minreal(A,0.1).
	
f.	 Simulate the MIMO system with the MIMO QFT control solution calculated in 
the previous question.
NOTE: for the simulations, use the following parameters: tfinal = 80 s, tinc = 0.01 s, refer­
ence for the first loop: r1 = 0 (from t = 0 to t = 1 s), and r1 = 1 (from t = 1 to t = 80 s), and 
reference for the second loop: r2 = 0 (from t = 0 to t = 40 s), and r2 = 1 (from t = 40 to 
t = 80 s).
u1
y1
y2
u2
FIGURE P5.1
A 2 × 2 distillation column.

428
Appendix 1
	
5.	Questions. Group 2
	
a.	 Design a MIMO QFT controller according to Method 1 (Sections 8-5 and 8.8). 
Suggested structure for gii(s): 1 zero, 1 pole, and 1 integrator. Hint: for matrix 
transfer operations, use minreal(A,0.1).
	
b.	 Simulate the MIMO system with the MIMO QFT control solution calculated in 
the previous question.
	
6.	Questions. Group 3
	
	 Consider again the model of the distillation column (P5.1), now with parametric 
uncertainty as k1 ∈ [85, 95], k2 ∈ [–115, –105], and τ ∈ [70, 80].
	
a.	 Design a MIMO QFT controller according to Method 2 (Sections 8-6.2 and 
8.9, with a 2 × 2 Gα, g11
β and g22
β). Hint: for matrix transfer operations, use 
minreal(A,0.1).
	
b.	 Simulate the MIMO system with the MIMO QFT control solution calculated in 
the previous question.
	
7.	Questions. Group 4
	
	 Again with uncertainty k1 ∈ [85, 95], k2 ∈ [–115, –105], and τ ∈ [70, 80].
	
a.	 Design a MIMO QFT controller according to Method 1 (Sections 8-5 and 8.8). 
Hint: for matrix transfer operations, use minreal(A,0.1).
	
b.	 Simulate the MIMO system with the MIMO QFT control solution calculated in 
the previous question.
	
	 For the simulation parts, we suggest the following MATLAB code:
Project P6. Central Heating System Control
	
1.	Chapters and Sections Needed: Chapters 2, 4, 9; Appendix 2; QFTCT.
	
2.	Project Description: Consider the central heating system of a three floor build­
ing shown in Figure P6.1. The heating system consists of a number of radiators 
on every floor connected through a network of pipes to a 3-way mixing valve 
in the basement, which in turn connects to the boilers that heat up the water 
tau = 75;  k1 = 87.8;  k2 = -109.6;
P0 = [k1 -86.4;108.2 k2];  P = tf(1,[tau 1]) * P0;
P.InputName = {’u’};  P.OutputName = {’y’};
G = Ga*[g11b 0; 0 g22b]; % or G = [g11 0; 0 g22]; Group 1 or 3
                         % or G = [g11 g12; g21 g22]; Group 2 or 4
G.InputName = {’e’};  G.OutputName = {’u’};
Sum = sumblk(’e = r - y’,2);
CLry = connect(P,G,Sum,’r’,’y’); % Closed loop MIMO system
tinc = 0.01;  t = [0:tinc:80];
U1 = [[0:tinc:1]*0,1+[1+tinc:tinc:80]*0]; % input 1
U2 = [[0:tinc:40]*0,1+[40+tinc:tinc:80]*0]; % input 2
figure,lsim(CLry,[U1;U2],t); % Fig

429
Appendix 1
that flows through the pipes. The variable to be controlled is the room ­temperature 
Tr(s), which is measured by appropriate sensors located inside the building.
	
	
The actuator is the 3-way valve. The water temperature at the output of the 
3-way valve is the mixed temperature Tm(s), also measured by an appropriate sensor.
	
3.	Modeling: The transfer function between the desired mixed temperature Tmd(s), 
or controller output, and the actual mixed temperature Tm(s) at the output of the 
3-way valve is
	
T
s
T
s
P s
k
s
m
md
( )
( )
( )
=
=
+
2
2
2
1
τ
	
(P6.1)
	
	
Also, the transfer function between the actual mixed temperature Tm(s) at the 
output of the 3-way valve and the room temperature Tr(s) is
	
T s
T
s
P s
k
s
e sL
r
m
( )
( )
( )
=
=
+
−
1
1
1
1
1
τ
	
(P6.2)
	
	 and the transfer function between the disturbances d(s) and the actual mixed tem­
perature Tm(s) at the output of the 3-way valve is
	
T
s
d s
M s
m( )
( )
( )
=
= 1
	
(P6.3)
	
	
Using system identification techniques with experimental data, we found the 
following parameters: k2 ∈ [5, 8]; τ2 ∈ [2, 5] s; k1 ∈ [40, 60]; τ1 ∈ [800, 1200] s; and 
L1 ∈ [100, 200] s.
	
4.	Control System Topology: The proposed control system topology consists of a cas­
cade control diagram, with an inner loop (secondary loop) for the valve and water 
temperature control, and an outer loop (primary loop) with a Smith Predictor for 
the room temperature control—see Figure P6.2.
To
Tr
Tr
Tr
Tm
Mixing valve
Controller
Boilers
FIGURE P6.1
Central heating system.

430
Appendix 1
	
5.	Control Specifications
•	 Inner loop: Taking into account the dynamics of the 3-way valve, we define the 
following robust control specifications for the inner loop:
–	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
Ws
1
2
2
2
2
1
1
1 01
0 001 0 0
(
)
(
)
(
)
(
)
(
)
( )
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[ .
. 05 0.01  0.05  0.1  0.5  1  5  10  50  100  500 1000 rad/s
]
	
(P6.4)
	
which is equivalent to PM = 59.34°, GM = 5.97 dB—see Equations 2.30 and 2.31.
–	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
T j
d j
M j
P j
G j
s a
s a
m
d
d
3
2
2
3
1
(
)
(
)
(
)
(
)
(
)
(
)
( )
/
/
ω
ω
ω
ω
ω
ω
δ ω
=
=
+
≤
=
+
(
)
(
)
1
10
0 001 0 005
;
[ .
.
]
ad =
∈
ω
0.01  0.05  0.1  0.5  1  5  10 rad/s
	
(P6.5)
•	 Outer loop: Also, taking into account the dynamics of thermal behavior of 
the room, we define the following robust control specifications for the outer 
loop:
–	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
W
e
e
s
1
1
1
1
1
1 46
0 001 0 0
(
)
(
)
(
)
(
)
(
)
( )
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[ .
. 05 0.01  0.05  0.1  0.5  1  5  10  50  100  500 1000 rad/s
]
	
(P6.6)
	
which is equivalent to PM = 40.05°, GM = 4.53 dB—see Equations 2.30 and 2.31.
–	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
)
(
)
(
)
(
)
( )
_lo
e
e
_up
T j
F j
P j
G j
P j
G j
<
=
+
≤
6
1
1
1
1
∈[
]
0.01  0.05  0.1  0.5  1 rad/s
	
(P6.7)
Tr(s)
d(s)
Tm(s)
ˆ
Smith predictor
TrRef (s)
u1(s)
Tmd(s)
+
+
+
+
+
+
+
+
–
–
M(s)
P1(s)
P2(s)
–P0(s)
ˆ
e–s L1
–y1
*(s)
G2(s)
G1(s)
F1(s)
FIGURE P6.2
Control system: Cascade control and Smith predictor.

431
Appendix 1
	
δ
ε
ε
6
2
1
1
0 08
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
[
]
=
=
(
)
(
)
;
.
;
	
(P6.8)
	
δ
ε
ω
ζ
ω
ζ
6
2
1
1
2
1
0 05
0
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
.
;
. ;
.
;
8
1 25
0
ω
ζ
ε
n
U
up
a
=
=
	
(P6.9)
	
6.	Questions
	
a.	 Design a feedback controller G2(s) for the inner loop to control the water tem­
perature Tm(s) at the output of the 3-way valve according to the ­stability and 
performance specifications defined above—Equations P6.4 and P6.5.
	
b.	 Design the feedback controller G1(s), the prefilter F1(s), and the Smith predictor 
blocks for the outer loop to control the room temperature Tr(s) according to 
the stability and performance specifications defined above—Equations P6.6 
through P6.9. Note that the plant Pe(s) that this controller G1(s) sees is
	
P s
P s
P s G s
P s G s
e( )
( )
=
+
1
2
2
2
2
1
( )
( )
( )
( ) 	
(P6.10)
	
	
and its model
	
ˆ ( )
ˆ ( )
ˆ
ˆ
ˆ ( )
ˆ
P s
P s
P s G s
P s G s
P s e sL
e
=
+
=
−
1
2
2
2
2
0
1
1
( )
( )
( )
( )
	
(P6.11)
	
	
with (see Figure P6.2)
	
ˆ ( )
ˆ
( ˆ
)
[ ˆ
[
ˆ
P s
k
s
P s G s
P s G s
0
1
1
2
2
2
2
1
1
=
+
+
τ
( )
( )]
( )
( )] 	
(P6.12)
	
ˆ ( )
ˆ
ˆ
P s
k
s
2
2
2
1
=
+
τ
	
(P6.13)
	
	
  The feedback controller G1(s) and the prefilter F1(s) have to be designed for the 
plant P0(s)—Equation P6.12, and according the control specifications defined in 
Equations P6.6 through P6.9. Then, the Smith predictor blocks (see Figure P6.2) 
have to be added following the methodology presented in Chapter 4. Hint: 
when calculating Equation P6.12 in MATLAB, use the command minreal(P0) to 
avoid MATLAB round error problems.
	
c.	 Simulate the complete system: inner loop, outer loop, and Smith predictor—
see Figure P6.2. Consider a unitary step reference TrRef(s) at t = 1 s, and a uni­
tary step disturbance d(s) at t = 400 s. Simulation time t = 800 s.

432
Appendix 1
Project P7. Multi-Tank Hydraulic Control System
	
1.	Chapters and Sections Needed: Chapters 2, 9; Appendix 2; QFTCT.
	
2.	Project Description: Consider the multi-tank hydraulic system shown in 
Figure P7.1. It is composed of three tanks of water placed at different levels and 
connected through a network of pipes, two valves [v1(s) and v2(s)], four temperature 
sensors [T1(s) to T4(s)], a flow sensor F1(s), and a heat exchanger fed with hot oil in 
the ­second tank.
	
	   The water that enters into the system through the first valve has a low tempera­
ture—measured by T1(s). The heat exchanger in the second tank can increase the 
water temperature in the system. The project’s objective is to control the output 
temperature T4(s) following the reference Tref(s). The main disturbance of the sys­
tem is the variation of the water temperature at the input of the first valve.
	
3.	Modeling: The transfer functions between the input water temperature T1(s) and 
the temperature at the output of the second tank T3(s), between the second valve 
v2(s) and the temperature at the output of the second tank T3(s), and between the 
temperature at the output of the second tank T3(s) and the final output water 
­temperature T4(s) are, respectively,
	
T s
T s
P s
s
s
3
1
1
2
1
1
1
1
1
( )
( )
( )
=
=
+
+
τ
τ
	
(P7.1)
	
T s
v s
P s
F
C
s
Q
p
3
2
2
2
1
1
1
( )
( )
( )
=
=






+
ρ
τ
	
(P7.2)
	
T s
T s
P s
s
4
3
3
3
1
1
( )
( )
( )
=
=
+
τ
	
(P7.3)
Q(s)
Hot oil
v2(s)
v1(s)
With tank time constants:
Input
water
T4(s)
T3(s)
T2(s)
T1(s)
F1(s)
Tank 1
Tank 2
Tank 3
Valve 1
Valve 2
Output
water
τ1 < τ2 < τ3
FIGURE P7.1
Multi-tank hydraulic system.

433
Appendix 1
and
	
T s
P s T s
4
3
3
( )
( )
( )
=
	
(P7.4)
	
T s
P s v s
P s T s
3
2
2
1
1
( )
( )
( )
( )
( )
=
+
	
(P7.5)
	
	 with τ1 = 10 s, τ2 = 30 s, τ3 = 90 s, and [1/(FQ ρ Cp)] ∈ [2.9, 3.1].
	
4.	Control Specifications: Taking into account the dynamics of the multi-tank hydrau­
lic system and the operation objectives, we define the following robust control 
specifications:
•	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
Ws
1
1
1
1 46
0 0001 0 0005
(
)
(
) (
)
(
) (
)
( )
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[ .
.
0 001 0 005
.
.
]
0.01  0.05  0.1  0.5  1  5  10 rad/s 	
(P7.6)
	
which is equivalent to PM = 40.05°, GM = 4.53 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
x j
d j
P j
G j
s a
s a
a
o
d
d
d
3
3
1
1
1
0
(
)
(
)
(
)
(
) (
)
( )
/
/
ω
ω
ω
ω
ω
δ ω
=
=
+
≤
=
+
=
(
)
(
)
;
.
[ .
.
.
.
]
01
0 0001 0 0005 0 001 0 005
ω ∈
0.01 rad/s
	
(P7.7)
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
_lo
_up
T j
F j
P j
G j
P j
G j
<
=
+
≤
∈
6
1
0 0
[ . 001 0 0005 0 001 0 005
.
.
.
]
0.01  0.05  0.1 rad/s 	
(P7.8)
	
δ
ε
ε
6
2
1
1
0 01
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
.
;
	
(P7.9)
	
δ
ε
ω
ζ
ω
6
2
1 1
2
1
0 01
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
[
]
+
+
+


=
(
)
(
)
(
)
(
)
;
.
;
. ;
.
;
ζ
ω
ζ
ε
=
=
=
0 8
1 25
0
n
U
up
a
	
(P7.10)
	
5.	Questions
	
a.	 Design a single feedback controller G1s(s) and a prefilter F1s(s) for a control 
loop with the sensor T4(s) according to Figure P7.2. The project’s objective is 
to control the water temperature T4(s) at the output of the system following 
the ­performance specifications defined in Equations P7.6 through P7.10, and 
­rejecting the T1(s) disturbances as much as possible.
	
b.	 Design a cascade control system, with an inner controller G2c(s) that uses 
the sensor T3(s), and an outer controller G1c(s) and a prefilter F1c(s) with the 
sensor T4(s) according to Figure P7.3. The project’s objective is to control the 

434
Appendix 1
water temperature T4(s) at the output of the system following the performance 
specifications defined in Equations P7.6 through P7.10, and rejecting the T1(s) 
­disturbances as much as possible.
	
c.	 Design a feedforward/feedback control system, with the feedback controller G1s(s) 
designed in the first question, with a feedforward controller Gf(s) from the sensor 
T1(s) for disturbance rejection, and with a model matching (or reference feedfor­
ward) controller Mu(s) and My(s) from the reference Tref(s) according to Figure 
P7.4. The project’s objective is to control the water temperature T4(s) at the output 
of the system following the performance specifications defined in Equations P7.6 
through P7.10, and rejecting the T1(s) disturbances as much as possible.
Tref (s)
T1(s)
T4(s)
T3(s)
v2(s)
P3(s)
P2(s)
P1(s)
G1c(s)
G2c(s)
F1c(s)
+
+
+
+
+
+
–
–
+
n4(s)
n3(s)
FIGURE P7.3
Cascade control system for the multi-tank process.
Tref (s)
T1(s)
T4(s)
T3(s)
v2(s)
P3(s)
P2(s)
P1(s)
G1s(s)
My(s)
Mu(s)
Gf (s)
+
+
+
+
+
+
+
–
+
n4(s)
FIGURE P7.4
Feedforward/feedback control system for the multi-tank process.
Tref (s)
T1(s)
T4(s)
T3(s)
v2(s)
P3(s)
P2(s)
P1(s)
G1s(s)
F1s(s)
+
+
+
+
–
+
n4(s)
FIGURE P7.2
Single feedback control system for the multi-tank process.

435
Appendix 1
	
d.	 Simulate the system according to the block diagrams of Figures P7.2, P7.3 and 
P7.4, and with the controllers designed in questions 1, 2, and 3, respectively. 
The total time of simulation is 3000 s. The reference signal Tref(s) is a unitary 
step input that changes from 0 to 1 at time t = 1 s. The disturbance signal T1(s) 
is a step input that changes from 0 to 2 at time t = 1500 s.
Project P8. Attitude Control of a Satellite with Tanks Partially Filled
	
1.	Chapters and Sections Needed: Chapter 2; Appendix 2; QFTCT.
	
2.	Project Description: Large satellites need a substantial amount of fuel to place them 
into orbit or make orbit corrections. In some geostationary and deep space satel­
lites the initial fuel mass is typically about 40% of the total satellite mass, and is 
contained in tanks in a liquid state. When the tanks are partially filled and the 
satellite accelerates, the fuel moves uncontrollably inside the tanks, producing the 
so-called sloshing effect.
	
	   There are several approaches to model this sloshing effect. In this project, we 
apply the approach discussed by M. Sidi—see Reference 363. According to this 
approach, a mass connected to a spring and a damper models the movement of the 
liquid inside the tank. Figure P8.1 shows the variables and parameters for attitude 
dynamics of a satellite in deep space and for the fuel movement inside the tanks. 
The satellite has several thrusters, of which Th.0 to Th.4 appear in the figure. The 
main thruster Th.0 moves the satellite in the main direction (y1), and the addi­
tional Th.1 to Th.4 modify the angle θ(t).
θ(t)
J0
x(t)
Tank with
fuel 
m
k
h
b
f1(t)
d1
d2
c.m.
T.1
T.2
T.3
T.4
M0
T.0
y1
y0
T(t)
FIGURE P8.1
Satellite description. Attitude dynamics with fuel slosh.

436
Appendix 1
	
	   The moment of inertia of the satellite without fuel and with respect to the center 
of mass (c.m.) is J0. The total mass of the satellite without fuel is M0. The mass of 
the fuel is m, and its relative movement to the satellite frame is x(t), with second-
order dynamics with k as the stiffness and b as the damping coefficients. As we 
fire the thrusters Th.1/3 (or Th.2/4), a force f1(t) (or –f1(t)) at a distance d1 of the c.m. 
is applied. This means that we apply a clockwise (or counter clockwise) torque on 
the satellite c.m., which is:
	
T t
d f t
( )
( )
 =
1 1
	
(P8.1)
	
	 The relative movement of the mass m of fuel is x(t), and its absolute movement is
	
θ( )
( )
t d
x t
2 −
	
(P8.2)
	
	 The parameters of the satellite are the following:
•	 J0 = 575 (kg m2) is the moment of inertia of the satellite without fuel and respect 
to c.m.
•	 M0 = 900 (kg) is the mass of the satellite without fuel.
•	 m ∈ [100, 200] (kg) is the mass of fuel.
•	 k = 337.5 (N/m) is the stiffness coefficient of the fuel model.
•	 b ∈ [0.01, 0.02] (N/m s–1) is the damping coefficient of the fuel model.
•	 d1 = 1.2 (m) is the distance between the thrusters and c.m.
•	 d2 = 0.9 (m). This is the distance between the mass m that represents the fuel 
and the c.m. of the satellite.
	
	 The variable we want to control is θ(t), which is the angle of motion of the central 
body, in rad. The actuators input is the force f1(t), in N, applied by the thrusters 
Th.1/3 (or Th.2/4).
	
3.	Questions
	
a.	 Modeling I. Using the Euler–Lagrange approach and the symbolic MATLAB 
toolbox, calculate the state-space model of the attitude dynamics of the satellite 
with the fuel slosh. Find the equations in terms of the parameters J0, m, k, b, d1, 
and d2. As in previous projects, the general form of the Euler–Lagrange equa­
tion is
	
d
dt
L
q
L
q
D
q
Q
i
n
L
E
E
i
i
d
i
i
k
∂
∂





−∂
∂
+ ∂
∂
=
=
=
−


,
, ,...
1 2
and
p
	
(P8.3)
	
	
where qi are the generalized coordinates or degrees of freedom of the system, 
Qi the generalized forces applied to each subsystem “i”, Ek and Ep the kinetic 
and potential energies, respectively, Dd the dissipator co-content, and L the 
Lagrangian.The generalized coordinates for the satellite studied here are the 
angle of motion of the central body and the relative movement of the liquid in 
the tank, which are respectively: q1 = θ(t) and q2 = x(t). The generalized force 
applied to the satellite by the thrusters Th.1/3 (or by Th.2/4 in the opposite 

437
Appendix 1
direction) is f1(t). It produces a torque—see Equation P8.1, about the axis of 
rotation of the central body, i = 1, being: Q1 = f1(t) and Q2 = 0. Knowing that the 
general equation of motion of a mechanical system is
	
M
C
K
Q



q
q
q
q q u
+
+
=
(
, , )
,
t 	
(P8.4)
	
	
where M , C, and K are the Mass, Damping, and Stiffness matrices, Q the matrix 
of inputs, q the vector of generalized coordinates, and u the vector of inputs, 
find the symbolic state-space representation of the dynamics of the satellite. 
The terms for the Euler–Lagrange equation are
	
d
dt
L
q
d
dt
E
E
x
i
k
k
∂
∂





=
∂
∂
∂
∂






=




θ
θ
M 

x






= M q
	
(P8.5)
	
−∂
∂
= ∂
∂
=
∂
∂
∂
∂






=





=
L
q
E
q
E
E
x
x
i
p
i
p
p
θ
θ
K
K q
	
(P8.6)
	
∂
∂
=
∂
∂
∂
∂






=






=
D
q
D
D
x
x
d
i
d
d






θ
θ
C
C q
	
(P8.7)
	
Q
R
R
=





=
f1
0
u
	
(P8.8)
	
	 Rearranging the general equation of motion as
	


q
q
q
u
= −
−
+
−
−
−
M
C
M
K
M
R
1
1
1
, 	
(P8.9)
	
	 the state-space representation ( x
Ax
Bu
=
+
; y = Cx) is
	
x
I
0
x
0
u
y
I x
=
−
−






+






= 

−
−
−
M
C
M
K
M
R
1
1
1
0
	
(P8.10)
	
	 where the state vector is x
q
q
=





= 






θ
θ
x
x
T
, the input vector u = [f1 0]T, and 
the output vector y = [θ x]T.

438
Appendix 1
	
	
Please, provide the following answers:
	
a.1	 The symbolic expressions of the state-space matrices A, B, C, and D, in 
terms of the parameters J0, m, k, b, d1, and d2.
	
a.2	 The MATLAB m.file that calculates the symbolic expressions.
	
b.	 Modeling II. From the state-space representation of the dynamics of the sat­
ellite calculated in the previous question, and applying the expression  for 
P(s) = C(sI – A)−1B for y(s) = P(s)u(s), find the two transfer functions of the sat­
ellite: p11(s) = θ(s)/f1(s) and p21(s) = x(s)/f1(s), in terms of the parameters J0, m, k, b, 
d1, d2, and s. Use the symbolic MATLAB toolbox.
	
	
Please, provide the following answers:
	
b.1	 The symbolic expressions of the two transfer functions p11(s) and p21(s) in 
terms of the parameters J0, m, k, b, d1, d2, and s.
	
b.2	 The MATLAB m.file that calculates the symbolic expressions.
	
c.	 Controller Design I. For the transfer functions found in the previous question, 
the diagram of Figure P8.2, the numerical values of the parameters of the satel­
lite, and H(s) = 1, F(s) = 1:
	
c.1	 For the nominal case (first values of the parametric uncertainty), find the 
numerical expressions of p11(s) = θ(s)/f1(s) and p21(s) = x(s)/f1(s).
	
c.2	 Plot the Bode diagrams of p11(s) and p21(s) and analyze the characteristics.
	
c.3	 Design a lead/lag controller G(s) to control the angle of the satellite θ(s) with 
the thruster force f1(s). The control specifications are: Stability: PM ≥ 35°; 
Steady-state error: Ess = 0 (for a reference step input); Transient specifications: 
Overshoot Mp ≤ 0.10 per unit, Settling time ts ≤ 150 s.
	
c.4	 Using Simulink, simulate the closed-loop control system. Show the evo­
lution of the angle of the satellite θ(t) and the movement of the liquid x(t) 
when the reference r(t) changes from 0 to 1 rad at t = 1 s, and when an 
external disturbance d0(t) changes from 0 to 0.2  rad at t = 300  s. Total 
­simulation = 600 s.
	
d.	 Controller Design II. Improve the controller G(s) designed in the previous ques­
tion with an additional notch filter to reduce the vibration produced by the liq­
uid slosh. Consider the same control specifications in c.3. Also, using Simulink, 
+
n(s)
r(s)
-
+
H(s)
F(s)
G(s)
θ(s)
+
+
x(s)
do(s)
+
p21(s)
p11(s)
f1(s)
FIGURE P8.2
Control block diagram of the satellite.

439
Appendix 1
simulate the closed-loop control system in the same conditions described in 
c.4. Analyze the vibration of the angle of the satellite θ(t) and compare the two 
cases, with this new controller and with the previous controller.
A1.2 Quick Problems
Problem Q1. Definition of Uncertainty
Determine whether the transfer function P1(s) with three uncertain parameters can be 
reduced to the transfer function P2(s) with only two related uncertain parameters, in order 
to reduce the number of operations needed to compute the templates.
	
P s
c
as
b
a
b
c
1
1 5
10 12
1 2
( )
;
[ , ];
[
,
];
[ , ]
=
+
∈
∈
∈
	
(Q1.1)
	
P s
c a
s
b a
c a
c
a
c
a
b
2
0 2
2
( )
(
)
(
)
(
)
min
max
. , max
min
;
(
=
+
∈
=
=






/
/
/
/a
b
a
b
a
)
min
max
, max
min
∈
=
=






2
12
	
(Q1.2)
Obtain, on the Nichols chart, the templates at ω = 5 rad/s for both transfer functions. 
Explain the effect of the reduction (selection of P2 instead of P1), if any, in the controller 
design.
Problem Q2. Control of First-Order System with Uncertainty
Consider the simple first-order plant with parametric uncertainty shown in Equation Q2.1.
	
y s
u s
P s
k
s p
k
p
( )
( )
) ;
[ , ],
[ . , . ]
=
=
+
∈
∈
( )
(( / )
with
1
3 4
0 1 0 2
	
(Q2.1)
Design a G(s) feedback controller and a prefilter F(s) to regulate automatically the plant 
output y(s) by varying the plant input u(s), and following the next specifications:
•	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
Ws
1
1
1
1 05
0 001 0 005
(
)
(
) (
)
(
) (
)
( )
0.
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[ .
.
01  0.05 0.1  0.2 0.5  1  5  10  20  50 rad/s
]
	
(Q2.2)
which is equivalent to PM = 56.87°, GM = 5.81 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
y j
d j
P j
G j
s a
s a
a
o
d
d
d
3
3
1
1
1
1
(
)
(
)
(
)
(
) (
)
( )
/
/
ω
ω
ω
ω
ω
δ ω
=
=
+
≤
=
(
)
(
)+
=
;
ω ∈[ .
.
]
0 001 0 005 0.01  0.05 0.1  0.2 0.5  1 rad/s
	
(Q2.3)

440
Appendix 1
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
_lo
_up
T j
F j
P j
G j
P j
G j
<
=
+
≤
∈
6
1
0 0
[ . 01 0 005
.
]
0.01  0.05 0.1  0.2 0.5  1  5  10 rad/s 	
(Q2.4)
	
δ
ε
ε
6
2
1
1
1
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
;
	
(Q2.5)
 
δ
ε
ω
ζ
ω
ζ
6
2
1
1
2
1
1
0 8
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
;
. ; ω
ζ
ε
n
U
up
a
=
=
1 25
0
.
;
	
(Q2.6)
Problem Q3. Control of Third-Order State-Space System with Uncertainty
Consider the third-order plant with parametric uncertainty described according to the 
state-space representation shown in Equations Q3.1 and Q3.2.
	
A
B
C
=






=






=
a
a
a
a
1
2
3
4
0
0
0
1
0
2
0
0
1
1
0 75
;
;
.


=[ ]
;
D
0
	
(Q3.1)
	
x
Ax
Bu
y
Cx
Du
=
+
=
+
;
	
(Q3.2)
The parameters with uncertainty of the plant are
	
a
a
a
a
1
2
3
4
9
7
5
3
2
1
3 5
∈
∈
∈
∈
−
−
−
−
−
−
[
]
[
]
[
]
[
]
,
;
,
;
,
;
,
and
	
(Q3.3)
Design a G(s) feedback controller and a prefilter F(s) to regulate automatically the first 
plant output y1(s) by varying the first plant input u1(s), and following the next specifications:
•	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
Ws
1
1
1
1 46
0 001 0 005
(
)
(
) (
)
(
) (
)
( )
0.
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[ .
.
01  0.05 0.1  0.5  1  5  10  50 100 500 rad/s
]
	
(Q3.4)
which is equivalent to PM = 40.05°, GM = 4.53 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
y j
d j
P j
G j
s a
s a
a
o
d
d
d
3
3
1
1
1
1
(
)
(
)
(
)
(
) (
)
( )
/
/
ω
ω
ω
ω
ω
δ ω
=
=
+
≤
=
+
=
(
)
(
)
;
ω ∈[ .
.
]
0 001 0 005 0.01  0.05 0.1  0.5  1  5 rad/s
	
(Q3.5)

441
Appendix 1
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
_lo
_up
T j
F j
P j
G j
P j
G j
<
=
+
≤
∈
6
1
0 0
[ . 01 0 005
.
]
0.01  0.05 0.1  0.5  1  5  10 rad/s 	
(Q3.6)
	
δ
ε
ε
6
2
1
1
1
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
;
	
(Q3.7)
 
δ
ε
ω
ζ
ω
ζ
6
2
1
1
2
1
1
0 8
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
;
. ;
ω
ζ
ε
n
U
up
a
=
=
1 25
0
.
;
	
(Q3.8)
Problem Q4. Field-Controlled DC Motor
Direct current (DC) electrical motors can also vary the voltage applied to the field wind­
ings to change the magnetic field affecting the armature, to maintain a constant ­armature 
current ia—see Figure 2.2. In this case, the dynamics of the motor differs from the model 
derived in Example 2.1—see Equation 2.17, and can be expressed as Equation Q4.1.
	
θm
T
f
f
T
f
s
v s
P s
K
s J s
b L s
R
K
b R
s s
b J
s
( )
( )
(
)(
)
=
=
+
+
=
(
)
+
( )
/
( /( / ))
1)(( /(
/
))
1
R
L
f
f
+
(
) 	
(Q4.1)
The parameters of the motor are: KT ∈ [0.3, 0.5] Nm/A; J ∈ [5, 9] × 10−4 Nm/s2; b ∈ [5, 
8] × 10−5 rad/s; Rf ∈ [0.2, 0.5] Ω; Lf = 2 × 10−3 H.
Design a G(s) feedback controller and a prefilter F(s) to regulate automatically the angu­
lar position θm(s) of the motor by varying the applied voltage v(s), and following the next 
specifications:
•	 Type 1: Stability specification
	
T j
P j
G j
P j
G j
Ws
1
1
1
1 33
(
)
(
) (
)
(
) (
)
( )
0.01  0.1  0
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
.5  1  2  5  10  20  50  100 200 500 rad/s
]
	
(Q4.2)
which is equivalent to PM = 44.16°, GM = 4.87 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
j
d j
P j
G j
s a
s a
a
m
o
d
d
d
3
3
1
1
1
(
)
(
)
(
)
(
) (
)
( )
/
/
ω
θ
ω
ω
ω
ω
δ ω
=
=
+
≤
=
+
=
(
)
(
)
;
110
ω ∈[
]
0.01  0.1  0.5  1  2  5  10 rad/s
	
(Q4.3)
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
0.0
_lo
_up
T j
F j
P j
G j
P j
G j
<
=
+
≤
∈
6
1
[
1  0.1  0.5  1  2  5  10  20  50 rad/s
]
	
(Q4.4)

442
Appendix 1
	
δ
ε
ε
6
2
1
1
10
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
;
	
(Q4.5)
 
δ
ε
ω
ζ
ω
ζ
6
2
1
1
2
1
5
0 8
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
;
. ;
ω
ζ
ε
n
U
up
a
=
=
1 25
0
.
;
	
(Q4.6)
Problem Q5. Formation Flying Spacecraft Control. Deep Space
Consider two spacecraft flying in a formation in deep space. The second spacecraft is fixed, 
while the first spacecraft can activate the thrusters (ux1, uy1, and uz1) to control the relative 
distances (dx, dy, and dz) between both of them. The distances are measured by RF and 
laser-based metrology. The satellites present the plant model shown in Equations Q5.1 
through Q5.3, so that
	
dx
x
x
dy
y
y
dz
z
z
=
=
=
2
1
2
1
2
1
–
;
–
;
–
	
(Q5.1)
	
dx
dy
dz
p
s
p
s
p
s
x
y
z






=






1
1
1
0
0
0
0
0
0
( )
( )
( )






u
u
u
x
y
z
1
1
1 	
(Q5.2)
	
P
s
P
s
P
s
P s
m s
m
x
y
z
1
1
1
1
1
2
1
1
360 460
( )
( )
( )
( )
,
,
=
=
=
= −
∈
kg
	
(Q5.3)
Note that the formation has three independent SISO systems, one for each axis (x, y, and z), 
and the plant models have uncertainty due to fuel consumption.
Design a feedback controller G(s) and a prefilter F(s) to regulate automatically and with no 
ground intervention the relative distance dx between the two spacecraft—see Figure Q5.1, 
and for the following specifications:
F
G
P1x
–
dx
Dx
Ux1
Satellite 2
Satellite 1
Trajectory
generator
block
Control system block for every axis
Nx
drefx
drefy
drefz
FIGURE Q5.1
Formation flying spacecraft control system.

443
Appendix 1
•	 Type 1: Stability specification
	
T j
P
j
G j
P
j
G j
W
x
x
s
1
1
1
1
1
1 1
(
)
(
) (
)
(
) (
)
( )
0.00001 0
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
.00005 0.0001 0.0005 0.001 0.005 0.01 0.05 0.1 0.5 
1.0 2.0 3.0 5.0 rad/s
]
	
(Q5.4)
which is equivalent to PM = 54.1°, GM = 5.6 dB—see Equations 2.30 and 2.31.
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
_lo
x
x
_up
T j
F j
P
j
G j
P
j
G j
<
=
+
≤
∈
6
1
1
1
[[
.
. ]
0.00001 0.00005 0.0001 0.0005 0.001 0.005 0.01 
r
0 05 0 1
ad/s 	
(Q5.5)
	
δ
ε
ε
6
2
1
1
0 015
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
.
;
	
(Q5.6)
	
δ
ε
ω
ζ
ω
6
2
1 1
2
1
0 00
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
[
]
+
+
+


=
(
)
(
)
(
)
(
)
;
.
8
0 8
1 25
0
;
. ;
.
;
ζ
ω
ζ
ε
=
=
=
n
U
up
a
	
(Q5.7)
Problem Q6. Helicopter Control
Consider the helicopter prototype shown in Figure Q6.1. It is a laboratory scale plant with 
three degrees of freedom: roll angle φ, pitch angle θ, and yaw angle ψ. Each angle is mea­
sured by an absolute encoder. Two electrical DC motors are attached to the helicopter 
body, making the two propellers turn, providing an aerodynamic force F that makes the 
system turn around the angles. A counterweight of mass M balances the body weight.
The dynamics of the pitch angle is obtained by applying Euler–Lagrange’s equations, 
so that
	
Fl
mg
h
d
l
Mg l
l
Mg l
h
1
1
2
3
3
−
+
+
+
+
+
−
[(
)
]
(
)
(
)
sin
cos
cos
cos
sin
sin
θ
θ
α
θ
θ
θ
θ
θ
−
=
b d
dt
J d
dt
e
e
2
2

(Q6.1)
l1
l2
d
h
l3
m
M
F
Propellers
Rod
Counterweight
Body
of helicopter
Encoder θ
α
θ
FIGURE Q6.1
Lab-scale helicopter.

444
Appendix 1
where h, d, l1, l2, and l3 are lengths; m the sum of both motors’ mass; M the counterweight 
mass; be is the dynamic friction coefficient; g the gravity acceleration; Je the moment of iner­
tia of the system around the pitch angle θ, and α a fixed construction angle. The nonlinear 
model in Equation Q6.1 can be simplified by linearizing it around the operational point 
θ0 = 0 degrees. It yields a second-order transfer function between the motor control signal 
u(s) and the pitch angle θ(s) given by
	
P s
s
u s
k
s
s
e
n
n
n
sT
( )
( )
( )
=
=
+
+
−
θ
ω
ζ ω
ω
2
2
2
2
	
(Q6.2)
Using system identification techniques from experimental data, the parametric uncer­
tainty found is: k ∈ [0.0765, 0.132] rad/volt; ζ ∈ [0.025, 0.05]; Ωn ∈ [0.96, 1.58] rad/s; T ∈ [0.09, 
0.11] s. The motor control signal u(t) presents a saturation limit of ±10 volt.
Design the feedback controller G(s) and the prefilter F(s) to meet the following con­
trol objectives: (a) minimize the reference tracking error, (b) increase the damping, 
(c) increase the system stability, (c) reduce the overshoot, (d) reject the high-frequency noise 
­introduced at the feedback sensors, and (e) deal with the actuator constraints.
Problem Q7. Two Cart Problem
Consider the classical benchmark problem shown in Figure Q7.1. It is a frictionless 
train composed of two carts of masses M1 and M2, coupled by a link of stiffness γ. The 
objective is to control the position x2(t) of the second cart by applying a force u(t) to the 
first cart.
The model of the system in state space is
	
A
B
= −
−






=
0
0
1
0
0
0
0
1
0
0
0
0
0
0
1
1
1
2
2
γ
γ
γ
γ
M
M
M
M
;
M1
0
0
1
0
0
0






= 

=[ ]
;
;
C
D
	
(Q7.1)
	
x
Ax
Bu
y
Cx
Du
=
+
=
+
;
	
(Q7.2)
being x1(t) and x2(t) the positions of the carts 1 and 2, respectively, x3(t) and x4(t) the veloci­
ties of the carts 1 and 2, respectively, u(t) the control signal or force that acts on the first cart, 
and y(t) = x2(t) the sensor output, which is also the variable to be controlled. The paramet­
ric uncertainty is given by
	
M
M
1
2
0 9 1 1
0 9 1 1
0 4 0 6
∈
∈
∈
[ . ,
. ];
. ,
.
[ . ,
. ]
[
];
 
 
 
γ
	
(Q7.3)
x1(t)
u(t)
γ
x2(t)
M2
M1
FIGURE Q7.1
Two cart problem.

445
Appendix 1
Design a feedback controller G(s) to regulate automatically the position x2(t) of the sec­
ond cart by varying the force u(t) applied to the first cart—see Figure Q7.1, and the follow­
ing the next specifications:
•	 Type 1: Stability specification
	
T j
P
j
G j
P
j
G j
W
x
x
s
1
1
1
1
1
1 2
(
)
(
) (
)
(
) (
)
( )
0.001 0.0
ω
ω
ω
ω
ω
δ ω
ω
=
+
≤
=
=
∈
.
[
05 0.01 0.05 0.1 0.5 1.0 2.0 3.0 5.0 10 rad/s
]
	
(Q7.4)
which is equivalent to PM = 49.24°, GM = 5.26 dB—see Equations 2.30 and 2.31.
•	 Type 3: Sensitivity or disturbances at plant output specification
	
T j
x j
d j
P j
G j
s a
s a
a
o
d
d
d
3
2
3
1
1
1
(
)
(
)
(
)
(
) (
)
( )
/
/
ω
ω
ω
ω
ω
δ ω
=
=
+
≤
=
+
=
(
)
(
)
;
0 1
0 001 0 005
.
[ .
.
]
ω ∈
0.01  0.05 0.1 rad/s
	
(Q7.5)
•	 Type 6: Reference tracking specification
	
δ
ω
ω
ω
ω
ω
ω
ω
δ
ω
ω
6
6
( )
(
)
(
)
(
) (
)
(
) (
)
( )
0.0
_lo
_up
T j
F j
P j
G j
P j
G j
<
=
+
≤
∈
6
1
[
01  0.005
0.1  0.5 rad/s
0 01 0 05
.
.
]
	
(Q7.6)
	
δ
ε
ε
6
2
1
1
0 1
0
_lo
lo
L
L
lo
s
s a
a
( )
/
=
−
+
=
=
(
)
[(
)
] ;
. ;
	
(Q7.7)
	
δ
ε
ω
ζ
ω
ζ
6
2
1
1
2
1
0 08
0
_up
U
up
n
n
U
s
s a
s
s
a
( )
/
/
/
=
+
+
+
+
=
=
[(
)
] (
)
[(
)
(
)
] ;
.
;
. ;
.
;
.
8
1 25
0 05
ω
ζ
ε
n
U
up
a
=
=

(Q7.8)
Problem Q8. Two Flow Problem
Consider two gaseous elements A and B in the tanks showed in Figure Q8.1. Tank 1 has 
an 80% of A (X1 = 80%) and a 20% of B, whereas Tank 2 has a 20% of A (X2 = 20%) and a 
80% of B. The hydraulic system represented in the figure mixes two flows, F1 and F2, which 
F1(s)
F(s)= F1(s) + F2(s)
X1(s)
F2(s)
X2(s)
X(s)
Tank 1
Tank 2
FIGURE Q8.1
Two flow problem.

446
Appendix 1
come from the Tanks 1 and 2, respectively. The product has a composition of X% of A and 
a flow F, so that
	
F
F
F
=
+
1
2 	
(Q8.1)
	
F X
F X
F X
 
=
+
1
1
2
2 	
(Q8.2)
The plant inputs are the flows F1 and F2, and the plant outputs are the flow F and the concen­
tration X of element A. In order to control X around Xref = 60% and F around Fref = 200 mol/h:
	
1.	Calculate Bristol’s relative gain analysis array
	
2.	Find the best input/output pairing
	
3.	Analyze the existing coupling between loops
	
4.	Find the coupling worst case according to the set point Xref
Problem Q9. 2 × 2 MIMO System
Consider a 2 × 2 linear multivariable system with uncertainty, whose transfer function 
matrix is
	
P s
k
s
k
s
k
s
k
s
( )=
+
+
+
+






11
11
12
12
21
21
22
22
1
1
1
1
τ
τ
τ
τ
	
(Q9.1)
with
	
k
k
k
k
11
12
21
22
11
0 5 3
2 2
1 8
11 15
2 7
0 5
∈
∈−
−
∈
∈
∈
[ . , ],
[
. ,
. ] ,
[
,
] ,
[ , ]
[ . ,
τ
3
8 12
3 8
5 10
12
21
22
],
[ ,
],
[ , ],
[ ,
]
τ
τ
τ
∈
∈
∈
	
	
1.	Calculate the Bristol’s relative gain analysis array.
	
2.	Find the best input/output pairing.
	
3.	Analyze the existing coupling between loops.
	
4.	Using Method 1 (see Sections 8-5 and 8-8), design a MIMO QFT controller that 
meets the three specifications defined below.
	
5.	Using Method 2 (see Sections 8-6 and 8-9), design a MIMO QFT controller that 
meets the three specifications defined below:
	
	 Specifications
•	 Type 1: Stability specification, i = 1,2
	
t
j
W
ii
ii
s
,
,
.
1
1
1 2
(
)
( )
ω ≤
=
=
δ
ω
 for i = 1, 2, ∀ω, where the terms tii(jω) are the diago­
nal elements of the matrix Ty/r. This condition implies at least 50° lower phase 
margin and at least 1.833 (5.26 dB) lower gain margin.
•	 Type 3: Sensitivity or disturbances at plant output specification, i = 1,2
	
t
s
y s
d s
p s g s
s
s
ii
o
ii
ii
ii
,
,
( )
3
3
1
1
10
50
( )
( )
( )
( )
( )
rad/s
=
=
+
≤
=
+
<
δ
ω
ω
,
for
1,2
i=
	

447
Appendix 1
•	 Minimize the coupling effects cij as much as possible and within the range of 
frequencies: ω < 10−2 rad/s.
Problem Q10. 2 × 2 MIMO System
Consider a 2 × 2 linear multivariable system with uncertainty and the following transfer 
function matrix:
	
P( )
10
4
11
12
21
22
s
p
s
p
s
p
s
p
s
s
s
s
=





=
+
−
+
+
( )
( )
( )
( )
αβ
β
β
β
αγ
γ
2
2
3
8 10
]
αγ
γ
α
β
γ
0 5
0 8 1 2
5 6
.
[ . , . ];
[ ,
];
[ ,
s+






∈
∈
∈
	
(Q10.1)
	
1.	Calculate the Bristol’s relative gain analysis array.
	
2.	Find the best input/output pairing.
	
3.	Analyze the existing coupling between loops.
	
4.	Using Method 1 (see Sections 8-5 and 8-8), design a MIMO QFT controller that 
meets the three specifications defined below.
	
5.	Using Method 2 (see Sections 8-6 and 8-9), design a MIMO QFT controller that 
meets the three specifications defined below.
	
	 Specifications
•	 Type 1: Stability specification, i = 1,2
	
t
j
p
g
p
g
W
i
ii
ii
e
ii
ii
e
ii
ii
s
,
,
. ,
,
1
1
1
1
1
1 4
1 2
(
)
( )
*
*
ω
δ
ω
=
(
)
+(
)
≤
=
=
=
−
−
	
(Q10.2)
•	 Type 6: Reference tracking specification, i = 1,2
	
δ
ω
ω
δ
ω
ii, _lo
ii
Y / R
ii, _up
t
j
i
6
6
6
1 2
( )
(
)
( )
<
≤
=
,
,
,
	
(Q10.3)
	
where
	
δ
δ
11 6
2
11 6
16
7 6
16
10
1
16
15
, _lo
, _up
s
s
s
s
s
s
( )
(
.
) (
)
;
( )
(
)
=
+
+
+
(
)
=
+
/
/
1
3 6
16
100
16
100
20
1
2
22 6
2
22 6
(
)
+
+
=
+
+
+
(
)
s
s
s
s
s
s
, _lo
, _
.
( )
(
) (
)
;
δ
δ
/
up s
s
s
s
( )
(
)
=
+
(
)
+
+
100
25
1
14
100
2
/
	
(Q10.4)
•	 Minimize the coupling effects:
	
Reduce the interaction
and
as much as possible.
12
21
, t
t
Y / R
Y / R
	
(Q10.5)

448
Appendix 1
Problem Q11. Spacecraft Flying in Formation in Low Earth Orbit
A formation of spacecraft (s/c) in Low Earth Orbit (LEO) is shown in Figure Q11.1. The 
model of the formation relative to the center of mass of the ­formation (c.m.f.)  is
	
x
y
z
m
s
s s
s s
s






=
+
+
−
+
−
1
1
2
0
2
3
2
0
2
0
2
0
2
0
2
0
2
2
  
(
)
(
)
ω
ω
ω
ω
ω
ω0
2
2
2
0
2
2
0
2
0
0
0
1
s
s
s
Q
Q
Q
x
y
z
(
)
 
+
+









ω
ω




	
(Q11.1)
where ρ = [ ,
, ]
x y z Tare the distances of the s/c to the c.m.f. and [Qx, Qy, Qz]T the actuator 
forces (thrusters). Note that this is a 2 × 2 MIMO system (axes x and y) plus a SISO (single-
input single-output) system (axis z). Note also that although the p22 element of the system is 
non-minimum phase, the MIMO plant does not present RHP transmission zeros. Its Smith-
McMillan decomposition yields a double integrator and a conjugate pole at s = ±jω0, but 
no transmission zeros.
For an s/c flying in formation in a circular geostationary Earth orbit, the parameters are: 
mean orbit rate ω0 ∈ [7.2637 × 10−5, 7.3208 × 10−5] rad/s, and mass of the satellite m ∈ [1600, 
1650] kg.
Design a MIMO QFT controller according to Method 2 (see Sections 8-6 and 8-9) to 
achieve the following specifications:
Matrix Specifications on S(s) and T(s):
	
T jw
S jw
(
)
(
)
∞
∞
<
<
2
2
and
	
(Q11.2)
Classical loop-by-loop robust stability and performance specifications:
•	 Type 1: Stability specification, i = 1,2,3
c.m.f.
n1
n2
n3
R0
x(o1)
y(o2)
z(o3)
s/c
North
Vernal equinox
i1
Periapsis direction
Anti-nadir
Orbit normal
Earth
ω
ω1
ρ
Ω1
FIGURE Q11.1
Formation flying spacecraft problem.

449
Appendix 1
	
t
s
p s
g
s
p s
g
ii
ii
x
e
ii
ii
x
e
i
,
*
*
1
1
1
1
( )
( )
( )
( )
=
(
)




+ (
)




−
−
β
i
ii
s
s
W
i
β
δ
ω
ω
( )
( )
≤
=
=
∀
=
,
. ,
,
, ,
1
1 1
1 2 3
	
(Q11.3)
•	 Type 3: Sensitivity or disturbances at plant output specification, i = 3
	
t
s
z s
d s
p
s g
s
o
33 3
33
33
33 3
1
1
2
,
,
( )
( )
( )
( )
( )
( )
=
=
+
≤
=
∀
δ
ω
ω
	
(Q11.4)
•	 Type 4: Disturbances at plant input specification, i = 1,2,3
t
s
p s
p s
g
s
ii
ii
x
e
ii
x
e
ii
,
*
*
4
1
1
1
( )
( )
( )
( )
=
(
)




+ (
)




≤
−
−
β
δii
s
s
s
s
,
(
.
)
(
.
)
(
. )
4
20
0 008
1
0 06
1
0 6
1
1
( )
/
/
/
 rad/s
ω
ω
=
+
(
)
+
(
)
+
(
)
∀
<
	
(Q11.5)
Problem Q12. 3 × 3 MIMO System
Consider a 3 × 3 MIMO system whose transfer function matrix is
	
y s
y s
y s
e
s
s
s
s
1
2
3
0 4
0 1
0 92
1
2 3
1
4
1
( )
( )
( )
.
.
(
)
.






=
+
+
+
−
−
1
2
1
1
7
1
1
3
1
0 1
0 87
1
2
1
0 92
1
3
0 1
0 2
0
s
e
s
s
e
s
s
s
e
s
s
+
+
+
−
+
−
+
+
−
−
−
−
.
.
.
.
(
)
.
.
.
.
( )
( )
4
0 3
1
2
0 54
1
1
6
1
s
s
s
e
s
m s
m s
+
+






−
m s
3( )






	
(Q12.1)
	
1.	Calculate Bristol’s relative gain analysis array.
	
2.	Find the best input/output pairing.
	
3.	Analyze the existing coupling between loops.
	
4.	Suppose that the three control loops are designed and working. In that case, study 
the effect of an instantaneous opening of the loop y2(s).
	
5.	Using Method 1 (see Sections 8-5 and 8-8), design a MIMO QFT compensator so 
that the system reaches a good level of stability, disturbance rejection, and de-
coupling (no uncertainty).
	
6.	Using Method 2 (see Sections 8-6 and 8-9), design a MIMO QFT compensator so 
that the system reaches a good level of stability, disturbance rejection, and de-
coupling (no uncertainty).


451
Appendix 2: QFT Control 
Toolbox—User’s Guide175
A2.1  Introduction
This appendix presents the QFT Control Toolbox, or QFTCT, for MATLAB. It is the 
­interactive and object-oriented computer tool used through the book to design QFT con­
trollers. The toolbox includes the latest quantitative robust control techniques within a 
user-friendly and interactive environment. The toolbox, developed by Prof. Mario García-
Sanz, has been tested in numerous courses, universities, companies, and centers over 
the years.
A demo version of the toolbox can be found at http://cesc.case.edu. The student and 
standard versions of the QFTCT is at http://codypower.com. For additional information, 
see http://crcpress.com.
The QFT control toolbox runs under MATLAB and shows an architecture based on 
seven principal windows, which are: W1—Plant Definition; W2—Templates; W3—Control 
Specifications; W4—Bounds; W5—Controller Design; W6—Prefilter Design; and W7—
Analysis—see Figure A2.2 and also Figure 2.1.
The toolbox also includes a library of advanced functions in Windows, offers a user-
friendly and interactive environment, and allows the user to easily re-scale the problem 
from SISO to MIMO problems.
Following the QFT robust control methodology, the objective of the toolbox is to design 
2DOF (two degree of freedom) robust control systems, including plants with model 
­uncertainty and a multi-objective set of performance specifications—see Figure A2.1. The 
compensator G(s) and prefilter F(s) of the 2DOF control system are to be designed to meet 
the robust stability and performance specifications, including reference tracking r(s), 
disturbance rejection d(s), de(s), di(s), do(s), signal noise attenuation n(s), and control effort 
­minimization u(s) specifications, while reducing the complexity of the controllers (order) 
and quantifying the cost of feedback (gain at each frequency and bandwidth).
Figure A2.2 lists the steps involved in the QFT design procedure. Figure A2.3 represents 
the toolbox flowchart of the QFT design procedure and Figure A2.4 presents an overview 
of the QFT design process.
Required products:
Matlab 2015b (version 8.5) or later version.
Control System Toolbox 9.9 or later version.
Platform:
PC, Windows 10, 8, or 7.
Installation:
To install the QFTCT, copy the files of the toolbox in a folder.
Then add the folder to the path: file → set path → add folder 
→ save → close.
Start:
To start a new session with the QFT Control Toolbox.
type “QFTCT” in the MATLAB Command Window.

452
Appendix 2
A2.2  QFT Control Toolbox Windows
This section describes the seven main windows of QFTCT for MATLAB—see Figure A2.2 
and also Figure 2.1.
A2.2.1  General Description
The toolbox contains windows of the form shown in Figure A2.5. As mentioned, they fall 
into seven categories: W1: Plant Definition; W2: Templates; W3: Control Specifications; W4: 
Bounds; W5: Controller Design; W6: Prefilter Design; and W7: Analysis. All the windows have 
a navigator panel at the top—see Figure A2.6. This allows the user to change the active 
­window among the seven options. Not all the windows are available from the beginning, 
as some windows have prerequisites that have to be met in order to activate them. The 
seven categories are listed next, following the order that they have to be executed in the 
design process:
	
1.	Plant definition: No pre-requisites
	
2.	Templates: Needs plant definition
	
3.	Specifications: Needs plant definition
Step 1: Define plant models and uncertainty 
Step 2:  Select nominal plant P0(jω)
Step 3:  Obtain templates at specified frequencies
Step 4:  Define stability specifications
Step 5:  Define performance specifications
Step 6:  Calculate stability bounds
Step 7:  Calculate performance bounds 
Step 8:  Calculate worst case scenario bounds
Step 9:  Synthesize feedback controller G(jω)
Step 10:  Synthesize prefilter controller F(jω)
Step 11:  Analysis in the frequency domain
Step 12:  Analysis in the time domain (linear)
Step 13:  Analysis in the time domain (nonlinear)
W3. Control
specifications
W4. Bounds
W5.
Loop shaping
W6. Prefilter
W1.
Plant model
W7. Validation
W2.
QFT-templates
FIGURE A2.2
QFT design procedure and QFTCT windows.
+
u(s)
+
–
e(s)
y(s)
+
+
n(s)
+
r(s)
d(s)
M(s)
do(s)
+
di(s)
+
+
de(s)
+
+
H(s)
P(s)
G(s)
F(s)
FIGURE A2.1
2-Degree-of-freedom (2DOF) feedback control system.

453
Appendix 2
Prefilter design F(s)
Satisfactory
simulation
?
Readjustment
Industrial
implementation
Experimental
verification
?
Verification
in the frequency and
time domain?
Verification
in the frequency
domain?
Bounds computation
Yes
Specifications
discussion
Mathematical model
revision
Nonlinear models
Specifications
Templates
Linearization
Mathematical model
Does a
solution exist?
Loop shaping G(s)
Readjustment
Readjustment
No
No
No
Start
End
FIGURE A2.3
QFT flowchart for a multi-input single-output (MISO) control system. (Adapted from Garcia-Sanz, M. and 
Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine 
Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)
Performance
specifications
Plant model
+ uncertainty
QFT
controller
design
Performance
Robustness
F, G
Minimum order controller
Transparency
of the technique
Minimum cost of feedback
Bounds
Loop shaping
L0
FIGURE A2.4
An overview of the QFT design process. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy 
Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press 
book, Taylor & Francis Group, Boca Raton, FL.)

454
Appendix 2
	
4.	Bounds: Needs plant definition, templates, and specifications
	
5.	Controller Design: Needs plant definition, templates, specifications, and bounds
	
6.	Prefilter: Needs plant definition, templates, specifications, bounds, and controller 
design. It is only for reference tracking problems
	
7.	Analysis: Needs plant definition, templates, specifications, bounds, and controller 
design
FIGURE A2.5
Plant definition window.
FIGURE A2.6
Window toolbar with the seven window categories. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. 
Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). 
A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)
(a)
(b)
FIGURE A2.7
Common toolbars. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)

455
Appendix 2
•	 Common Toolbars: All the windows of the toolbox have a toolbar—see 
Figure  A2.7a, which allows the user to create a new project, open an existing 
one, or save the current project. The toolbar of the windows which have figures 
(Templates, Bounds, Controller Design, Prefilter Design, and Analysis) also has 
controls to zoom in and out on the plots—see Figure A2.7b.
•	 Menu Additionally, all the windows have the following two menus:
•	 File: Allows the user to create new projects, open existing projects, save the 
current project, and save the current project in a new file.
•	 Help: Provides information about the toolbox version, etc.
	
In addition,
•	 The windows that have figures include a menu item in the File menu that allows 
the user to save the plot in a file with the format .emf, .bmp, or .fig.
•	 Also, some windows have the following specific menu items:
–	 Templates: In the File menu, there is an option that allows the user to export 
the nominal plant as a transfer function.
–	 Controller Design: In the File menu, there are menu items that allow the 
user to—see Figure A2.8a:
–	 Load a controller from the hard disk (*.contr).
–	 Load a list of controllers from the hard disk (*.contrList).
–	 Save selected controller to the hard disk (*.contr).
–	 Save controller list to the hard disk (*.contrList).
–	 Export the selected controller as a transfer function to workspace.
–	 Save Figure to the hard disk (*.emf, *.bmp, or *.fig).
–	 Check nominal plant. It shows the selected nominal plant.
(a)
(b)
FIGURE A2.8
(a) File menu, controller design window. (b) Check stability.

456
Appendix 2
–	 Check stability. It checks the stability of the closed-loop system with 
the nominal plant and the selected controller. It applies the method 
presented in Chapter 3, Section 3.4, and the algorithms included in 
Appendix 3: The Nyquist Stability Criterion in the Nichols Chart—see 
example in Figure A2.8b.
	
The controller design window has also an Edit menu that allows the 
user to:
–	 Undo changes
–	 Redo changes
–	 Set the frequency vector for L(s): minimum frequency and maximum 
frequency (rad/s), and number of points.
–	 Prefilter Design: Similarly, this window category has the following menu 
items in the File menu:
–	 Load prefilter from the hard disk (*.prefltr)
–	 Load prefilter list from the hard disk (*.prefltrList)
–	 Save selected prefilter to the hard disk as (*.prefltr)
–	 Save prefilter list to the hard disk (*.prefltrList)
–	 Export the selected prefilter as a transfer function to the workspace
–	 Save Figure to the hard disk (*.emf, *.bmp, or *.fig)
A2.2.2  Plant Definition Window
In the Plant Definition window, see Figure A2.9, the user can define the plant type, model 
structure, parameters, uncertainty, and frequencies of interest, either for the System 
plant P(s), or for additional plants like M(s) in Figure A2.1 (add new plant button). In the 
Plant type panel, the user can select the way to describe the plant model, which can be: 
(1) Gain/Zero/Pole or ZPG transfer functions, (2) Numerator/Denominator ­transfer 
functions,  (3)  State  Space representation, (4) a general array of transfer functions, and 
(5) experimental data.
•	 Gain/Zero/Pole Transfer Function: The model structure and its elements are 
defined using the syntax listed in Table A2.1 and Equation A2.1. In this option, 
the user has to enter the information in the ZPG structure panel: number of real 
zeros, complex zeros, real poles, and complex poles—see Figures A2.9 and A2.10. 
The user also has to enter the value of the integrator/differentiator element: 0 
if it is not used, a positive integer for the number of differentiators and a nega­
tive ­integer for the number of integrators. In addition, the user has to specify 
whether the plant has time delay (Yes/No). After all this information is entered, 
the user clicks the Update button. Then, the Toolbox opens the ZPG parameters 
panel and the user can write the expressions for the elements of the plant.
	
	
Note that, at this point, it is possible to introduce alpha-numeric information 
with  numbers, letters, or expressions. If the user introduces expressions, the 
Toolbox identifies the letters in the expressions as parameters with uncertainty, and 
­automatically adds their names to the Parametric uncertainty panel. In Figures A2.9 
and A2.10, a gain is introduced as “k/(a*b)”, a real pole as “a”, and another real 
pole as “b”—see Equation A2.2.

457
Appendix 2
FIGURE A2.9
Plant definition window.
FIGURE A2.10
Gain/Zero/Pole or ZPG structure and ZPG parameters panels.
TABLE A2.1
Gain/Zero/Pole/Delay Element Syntax
Gain
kp
Complex zero
s
s
n
n
2
2
2
1
1
ω
ζ
ω
ζ
+
+
<
(
)
Real pole
1
1
s
p +
Integrator
1
sn
Real zero
s
z +1
Differentiator
sn
Complex pole
1
2
1
1
2
2
s
s
n
n
ω
ζ
ω
ζ
+
+
<
(
)
Time delay
e Ts
−

458
Appendix 2
	
P s
k zeros s
poles s
k
s
z
s
z
p
p
( )
( )
( )
=
=
+






+






1
2
1
1 

s
s
s
s
p
s
p
ni
i
ni
n
2
2
1
2
2
1
1
1
ω
ζ
ω
+
+






+






+






+
+






−


s
s
e
nj
j
nj
Ts
2
2
2
1
ω
ζ
ω
	
(A2.1)
	
P s
k
s
a s
b
k
ab
s
a
s
b
( )
(
)(
)
=
+
+
=






+






+






1
1	
(A2.2)
•	 Numerator/Denominator Transfer Function: The plants can also be 
defined as a transfer function, with a numerator and a denominator as 
Laplace polynomials—see Equation A2.3. The first step consists in enter­
ing the model structure: numerator and denominator polynomial orders—
see Figure A2.11 and Equation A2.3. At this point the user can also specify 
whether there is or there is not time delay in the plant. Then, after press­
ing the Update ­button, the Toolbox updates the Numerator and Denominator 
panels, and the user can enter the expressions for the coefficients of the 
polynomials and time delay. Note that, at this point, it is possible to intro­
duce numbers or letters. If  the user introduces letters, the Toolbox iden­
tifies them as ­parameters with uncertainty, and automatically adds their 
names to the parametric ­uncertainty panel, which will be defined afterward. 
As an ­example, the expression defined in Equation A2.4 is introduced in 
Figure A2.11.
	
P s
n s
d s
Ncoef s
Ncoef
s
Ncoef s
Ncoef
Dc
n
n
n
n
indep
( )
( )
( )
=
=
+
+
+
+
−
−
1
1
1

oef s
Dcoef
s
Dcoef s
Dcoef
e
m
m
m
m
indep
Ts
+
+
+
+
−
−
−
1
1
1

	
(A2.3)
	
P s
Lambda
M M
s
s
Lambda M
M
s
s
( )
(
)
(
)
=
+
+
+
+
+
1
2
4
3
1
2
2
0
0
0 	
(A2.4)
FIGURE A2.11
Numerator/denominator panels. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: 
Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor 
& Francis Group, Boca Raton, FL.)

459
Appendix 2
•	 State Space: The plants can also be described with a state space representa­
tion. In this case, we enter the dimension (n, m, and v) of the matrixes A (n×n), 
B (n×m), C (v×n), and D (v×m)—see Equation A2.5 and Figure A2.12. Also, 
we need to choose the input k (k ≤ m) and output q (q ≤ v) channels for the 
yq(s)/uk(s) = Pqk(s), with P(s)v×m = [C(sI–A)–1B + D]v×m. As the conversion from 
state space to transfer function typically involves some round errors, we can 
introduce a tolerance error for the minreral(.) function to remove the extra zeros 
and poles that could be added by MATLAB in the conversion. After clicking 
Create button, the Toolbox opens the State Space matrices panel, and we can 
enter the expressions for the elements of the four matrices and the input and 
output time delays. Note that, at this point, we can introduce numbers or 
­letters. If we introduce letters, the Toolbox identifies them as parameters with 
uncertainty, and automatically adds their names to the parametric uncertainty 
panel, which is defined later.
	
x
A x
B u
y
C x
D u
n
n n
n m
v
v n
v m
×
×
×
×
×
×
=
+
=
+
1
1
	
(A2.5)
•	 Load Transfer Function Array: If the plant cannot be defined using the 
three previous options, yet we can load an array of transfer functions from 
a file. After uploading the file, we enter the row of the array that represents 
the ­nominal plant.
	
	
Notice that this is a very powerful tool that can define any kind of plant, with 
different structures and parametric and nonparametric uncertainty.
	
	
For the SystemPlant, the technique is as follows: (1) Run first in MATLAB an 
m.file like the one described in Example A2.1; (2) then go to the Workspace; 
(3) click on P with the right bottom and save as PP.mat (or other name) in the 
hard disk; (4) then go to the Plant definition window; (5) click “Load transfer 
function array”; (6) select Nominal plant (usually number 1); (7) click “Import.
mat”; (8) select in the hard disk PP.mat and click “Open”; (9) click “Commit”; 
(10) the plant will appear in the list of plants as System Plant, P(s).
	
	
For an additional plant: steps (1–6) are the same—now save as MM.mat, for 
instance. Then (7) click “Add new plant”; (8) put a name in the “Plant name” 
FIGURE A2.12
State-space panel.

460
Appendix 2
cell at the bottom (for example M); (9) click “Import.mat”; (10) select in the hard 
disk MM.mat and click “Open”; (11) click “Commit”; (12) the plant will appear 
in the list of plants as M.
EXAMPLE A2.1:  M.FILE
c = 0;
for k = linspace(610,1050,3)
    for a = linspace(1,15,15)
        for b = linspace(150,170,2)
            c = c+1;
            P(1,1,c) = tf(k,[1 (a+b) a*b 0]);
            M(1,1,c) = tf(k,[1/a 1]);
        end
    end
end
	
	
Notice also that we have three nested “for” loops in the above example 
because there are three parameters with uncertainty: k ∈ [610,1050], a ∈ [1,15], 
b ∈ [150,170]. We can also put another type of grid, different from linespace, like 
logspace or others, or a mix. The definition of the plants in this example is
P(1,1,c)= tf(k,[1 (a+b) a*b 0]);
M(1,1,c)= tf(k,[1/a 1]);
	
which are: P(s) = k/[s3 + (a + b)s2 + ab s], and M(s) = k/[(s/a) + 1].
	
	
As we see, this option allows the user to include in these lines of the algo­
rithm any kind of structure or expression, even with different structures 
(uncertainty in the structure) and with any parametric or nonparametric 
uncertainty, interdependence in the uncertain parameters, and many other 
special features.
	
	
Finally, note that as this option is so open, it is important to make sure that 
the numbers of the plants are consistent, that is, the index “c” in P(1,1,c) and 
M(1,1,c) is related to the same values of the parameters that P(1,1,c) and M(1,1,c) 
share. This is easily done by defining P(1,1,c) and M(1,1,c) within the same for-
loop in the m.file, as shown in Example A2.1.
	
	
In case of a combination of “load transfer function array” plants with other 
plants, like Gain/Zero/Pole or Numerator/Denominator or State-Space plants, 
make sure that the definition of the parametric uncertainty (parameters and 
gridding) is consistent in all of them. Also select the same gridding in the 
parametric uncertainty of the Analysis window.
•	 Load Experimental Data: The user can also define the system by uploading 
experimental data in a frequency response data vector. The technique is as fol­
lows: (1) prepare an frd (Frequency Response Data model) system in MATLAB: 
freq = vector of frequencies in rad/s; resp = vector of complex numbers with the 
response of the system at each frequency (a + jb), experimentalData = frd(resp,freq). 
Note that the name of the frd structure can be experimentalData or any other.
	
	
For example, in MATLAB we can introduce the following arrays: freq = log­
space(–1,2,50); resp = 0.05*(freq).*exp(i*2*freq); experimentalData = frd(resp,freq)—or 
a collection of real data in resp and freq; (2) Then go to the Workspace; (3) Click on 

461
Appendix 2
experimentalData with right bottom and save as sys.mat (or other name) in the 
hard disk; (4) Then go to the Plant definition window; (5) Click “Load exper­
imental data”; (6) Select Nominal plant (usually num.1); (7) Click “Import 
experimental…”; (8) Select in the hard disk sys.mat and click “Open”; (9) Click 
“Commit”; (10) The plant will appear in the list of plants as System Plant, P(s).
•	 Expressions and Parametric Uncertainty: As seen, it is possible to introduce 
alpha-numeric expressions. The toolbox automatically recognizes letters as 
parameters with uncertainty. After entering the expressions of the plant, either 
as parameters in the zpk model, or in the numerator/denominator model, or in 
the state space matrices, and after pressing the Continue button, a new ­parametric 
uncertainty panel appears to define the parametric uncertainty of the plant—see 
Figure A2.13. This panel displays the following information of each parameter:
–	 The name of the parameter
–	 A button to open a window to modify the probability distribution of the 
parameter
–	 The minimum and the maximum value of the parameter (given by its 
­probability distribution)
–	 Number of points in the grid for each parameter (two is the minimum 
number, which means that there are only two points in the grid, the mini­
mum and the maximum), and its distribution (logarithmic or lineal)
–	 The nominal value of the parameter (it must be included in the minimum–
maximum range of the parameter)
•	 Probability Distribution of the Parameters: In order to define the prob­
ability distribution for the uncertainty of the parameters, the user needs to 
press the Modify button in the Parametric uncertainty panel to open a new sub-
window—see Figure A2.14. This sub-window has three probability distribu­
tions available: Uniform, Normal, and Weibull. After selecting the distribution 
and entering its parameters, a graphical representation of the distribution is 
­plotted. Also, the user can define the percentage to be reached. This percentage 
is applied to the distribution, and the resulting values will be the minimum 
and the maximum values of the parameter.
•	 System Plant Frequency Vector: The user has also to enter a vector with 
the frequencies of interest of the plant—see for example Figures A2.5 and 
A2.9. The textbox accepts an array of numbers or a MATLAB command that 
­produces  the array of numbers, e.g., logspace(–2,3,100). Note that it is very 
FIGURE A2.13
Parametric uncertainty panel. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: 
Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor 
& Francis Group, Boca Raton, FL.)

462
Appendix 2
important to define this vector correctly, populating the vector with an enough 
number of points in the frequency regions where there are resonances or quick 
changes in magnitude or phase, as well as selecting properly the lowest and 
the highest value of frequency.
A2.2.3  Templates Window
A template is the representation of the frequency response of the plants, including the 
uncertainty, in the Nichols chart at a particular frequency. There is a specific window to 
define the templates—see Figure A2.15.
FIGURE A2.14
Probability distribution: uniform, normal, and the Weibull cases. (Adapted from Garcia-Sanz, M. and Houpis, 
C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and 
Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)

463
Appendix 2
•	 Number of Template Points: The number of points of the templates depends on 
three parameters: template type, parametric uncertainty, and template contour. 
If the template is too sparse, then it might be not accurate enough to represent 
the plant. On the contrary, if the template has too many points, the number of 
­calculations to generate the bounds in the next step might be too high.
•	 Template Type: The user can select four different template types, ordered from 
sparse to dense: “Vertex”, “Edges”, “Faces,” and “All points”. Figure A2.16 shows 
different template types for a plant which has three uncertain parameters. 
The filled circle in each of the templates denotes the nominal plant.
•	 Grid of the Parametric Uncertainty Variables: The more points are considered—
see Figure A2.13, the denser the templates are (unless the template type is “Vertex”).
•	 Template Contour: In the lower part of the window, there is a slider which can be 
used to adjust the contour of the templates. When the slider is moved to the right, 
the inner points of the template become sparser. Figure A2.17 shows the template of 
a plant that has initially 1000 points (a), and the template of the same plant after its 
contour has been adjusted (b).
•	 Plant Frequencies: There is a template for each frequency of interest. The user can 
add and remove frequencies using the Templates window (or the Plant definition 
window as well).
•	 Add Frequency: Frequencies can be added using two different methods:
–	 By entering the value of the new frequency in the textbox beside “Manual” 
and pressing the Add button—see Figure A2.15.
FIGURE A2.15
Template definition window.

464
Appendix 2
–	 By using the slider—see the Add frequency panel in Figure A2.15. When 
the user clicks the Initialize button in the Add frequency panel, the slider 
is enabled and the user can pre-visualize the position and shape of the 
new template. The user can then use the slider to enter the value of 
the new ­frequency. Then, by clicking the Fix button, the new frequency is 
added to the list.
(a)
(b)
FIGURE A2.17
Template without contour adjustment [1000 points, (a)], and with contour adjustment with the slider [51 points, (b)]. 
(Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part I: 
QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis Group, Boca Raton, FL.)
Vertex (8 points)
Edges (64 points) 
Faces (178 points)
All (250 points)
FIGURE A2.16
Template types. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering 
Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis Group, 
Boca Raton, FL.)

465
Appendix 2
•	 Remove Frequency: To remove a frequency, the user has to click the Initialize 
button in the Remove frequency panel. A list box appears, and enables the user 
to select the frequency to be removed. The points markers of the template 
­associated with the frequency are indicated by ‘x’ instead of ‘o’. To remove 
the selected frequency, click “Remove”.
•	 Frequency Vector: The user can use the Frequency vector panel (see Figure A2.15) 
to change the visibility of the templates associated with the frequencies. If the 
user double clicks on a number of the frequency list that represents a ­template, 
the ­visibility of the template is switched (on/off). The user can also use the 
Show all and Hide all buttons to show all the templates or to hide them all, 
respectively.
•	 Modify Parametric Uncertainty: The user can modify the parametric uncertainty 
by pressing the Modify uncertainty button—see Figure A2.15. Then, a new sub-
window allows the user to modify the parametric uncertainty in the same way as 
in the plant definition window—see Figure A2.18. Also, using this sub-window, 
the user can see how the changes in the parametric uncertainty are applied in real 
time to the templates window.
•	 Export Nominal Plant: The templates window has a menu item that allows the 
user to export the nominal plant as a transfer function. The nominal plant is saved 
in the current directory as a *.mat file. Afterward, the user can load that file to 
the MATLAB’s Workspace (load *.mat) to use it.
A2.2.4  Specifications Window
This window allows the user to introduce robust stability and performance control 
­specifications—see Figure A2.19. The Choose specification type panel includes seven groups 
of specifications. The first six options are the classical specifications that correspond to 
Equations A2.9 through A2.14, and the last one is a general specification that corresponds 
to Equation A2.15. This last option is able to generate the first five specifications and 
many other possibilities, including additional transfer functions like M(s) in Figure A2.1 
and ­others. See Table A2.2 for more details.
•	 Predefined Specifications: (see Equations A2.9 through A2.14). The user can add 
specifications for any transfer function extracted from Figure A2.1, as defined in 
Equations A2.6 through A2.8. The most common control specifications, including 
FIGURE A2.18
Parameter uncertainty window. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: 
Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor 
& Francis Group, Boca Raton, FL.)

466
Appendix 2
stability, disturbance rejection, reference tracking, and control effort attenuation, 
are defined as T1, T2, …, T6 in the Choose specification type panel. They correspond 
to Equations A2.9 through A2.14, or Equations 2.35 through 2.40 in Chapter 2—see 
also Figure A2.19.
	
y
PG
PGH F r
PGH
PG d
P d
d
M d
PGH
PGH n
e
i
o
= +
+ +
+
+
+
−
+
1
1
1
1
(
)
	
(A2.6)
	
u
G
PGH F r
G
PGH
d
H P d
H d
H M d
GH
PGH n
e
i
o
=
+
+
+
−
−
−
−
+
1
1
1
(
)
	
(A2.7)
	
e
PGH F r
H
PGH
PGd
P d
d
M d
H
PGH n
e
i
o
=
+
−
+
−
−
−
−
+
1
1
1
1
(
)
	
(A2.8)
•	 User-Defined Specifications: (see Equation A2.15). All the predefined specifica­
tions, except the reference tracking, can be expressed using the Tk Defined by user 
specifications. Moreover, the option Tk opens the door to a wide variety of con­
trol specifications. It corresponds to Equations A2.15 and 2.41. By selecting the 
functions A, B, C, and D, we can define any one of the previous specifications 
(T1–T5) and also other cases that include additional plants introduced in the Plant 
definition window. In this way, we can define general disturbance rejection speci­
fications, cascade control loops, asymmetric topologies, specifications involving 
Smith predictor blocks, MIMO equivalent plants, DPS plants, etc. For instance, see 
FIGURE A2.19
Specifications window.

467
Appendix 2
TABLE A2.2
Control System Specifications
T1: Stability specs
	
|
|
,
|
|
T j
P j
G j
P j
G j
W
T j
s
1
1
1
1
1
(
)
(
) (
)
(
) (
)
( )
where
(
)
ω
ω
ω
ω
ω
δ ω
ω
ω
=
+
≤
=
∈Ω
=
y j
F j
r j
(
)
(
) (
)
ω
ω
ω
	
(A2.9)
T2: Complementary sensitivity specs
	
|
|
,
|
|
T j
P j
G j
P j
G j
T j
y
2
2
2
2
1
(
)
(
) (
)
(
) (
)
( )
where
(
)
(
ω
ω
ω
ω
ω
δ ω
ω
ω
=
+
≤
∈
=
Ω
j
F j
r j
y j
n j
u j
d j
y j
d j
e j
d
i
e
e
ω
ω
ω
ω
ω
ω
ω
ω
ω
ω
)
(
) (
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
=
=
=
=
jω) 	
(A2.10)
T3: Sensitivity or Disturbances at plant output specs
	
|
|
,
|
|
T j
P j
G j
T j
y j
d j
o
3
3
3
3
1
1
(
)
(
) (
)
( )
where
(
)
(
)
(
)
ω
ω
ω
δ ω
ω
ω
ω
ω
=
+
≤
∈
=
Ω
=
=
=
e j
d j
e j
F j
r j
e j
n j
o
(
)
(
)
(
)
(
) (
)
(
)
(
)
ω
ω
ω
ω
ω
ω
ω
	
(A2.11)
T4: Disturbances at plant input specs
	
|
|
,
|
|
T j
P j
P j
G j
T j
y j
di
4
4
4
4
1
(
)
(
)
(
) (
)
( )
where
(
)
(
)
ω
ω
ω
ω
δ ω
ω
ω
ω
=
+
≤
∈
=
Ω
(
)
(
)
(
)
j
e j
d j
i
ω
ω
ω
=
	
(A2.12)
T5: Control effort reduction specs
|
|
,
|
|
T j
G j
P j
G j
T j
u j
de
5
5
5
5
1
(
)
(
)
(
) (
)
( )
where
(
)
(
)
ω
ω
ω
ω
δ ω
ω
ω
ω
=
+
≤
∈
=
Ω
(
)
(
)
(
)
(
)
(
)
(
)
(
) (
)
j
u j
d j
u j
n j
u j
F j
r j
o
ω
ω
ω
ω
ω
ω
ω
ω
=
=
=
	
(A2.13)
T6: Reference tracking specs
δ
ω
ω
ω
ω
ω
ω
ω
ω
ω
δ
6
( )
(
)
(
)
(
)
(
)
(
) (
)
(
) (
)
_lo
T j
y j
r j
F j
P j
G j
P j
G j
<
=
=
+
≤
|
|
6
1
6
( )
(
) (
)
(
) (
)
(
) (
)
_up
d
e
e
P j
G j
P j
G j
P j
G j
P
ω
ω
ω
ω
ω
ω
ω
ω
,
|
|
|
|
|
|
|
∈
+
+
Ω6
1
1
d
up
lo
j
G j
(
) (
)
( )
( )
( )
ω
ω
δ ω
δ
ω
δ
ω
ω
|
,
_
_
≤
=
∈
6
6
6
6
Ω
	
(A2.14)
Tk: General specs
	
A j
B j
G j
C j
D j
G j
k
k
(
)
(
) (
)
(
)
(
) (
)
( ),
ω
ω
ω
ω
ω
ω
δ ω
ω
+
+
≤
∈Ω
	
(A2.15)

468
Appendix 2
the code for Example 4.1 in Appendix 4, or for Example 5.1 in Appendix 5, or for 
Example 8.1 (Sections 8.8 and 8.9) in Appendix 8.
•	 Equation A2.9 [T1(jω)] defines the robust closed-loop stability specification.
•	 Equation A2.10 [T2(jω)] defines complementary sensitivity, robust sensor noise 
attenuation, robust control effort limitation from the plant input disturbance, and 
robust rejection of disturbances at the input of the controller.
•	 Equation A2.11 [T3(jω)] defines the sensitivity, robust rejection of disturbances at 
the output of the plant, and robust sensor noise attenuation.
•	 Equation A2.12 [T4(jω)] defines robust rejection of disturbances at the input of the 
plant.
•	 Equation A2.13 [T5(jω)] defines robust control effort limitation from disturbances 
at the controller input, plant output, sensor noise, and filtered reference signal.
•	 Equation A2.14 [T6(jω)] defines the robust reference tracking specification.
•	 Equation A2.15 [Tk(jω)] defines any specification from type T2(jω) to T5(jω), and 
many other options in general, where A(jω), B(jω), C(jω), and D(jω) can be defined 
by the user, from several options like 0, 1, P(jω), or any other plant introduced 
in the Plant definition window, as for example M(jω) to define the specification 
|M(jω)/[1+P(jω)G(jω)]|.
The value of δi(ω) denotes the upper limit of the magnitude of the objective (the specifica­
tion) at every frequency of interest. Each specification can be defined for a different set of fre­
quencies ωi, always a sub-set of the original set of frequencies of interest—see also Figure 2.14.
FIGURE A2.20
Defining stability specifications, either as Ws or as GM and PM.

469
Appendix 2
•	 Defining a Specification: The user has to enter the value of the performance spec­
ification δi(ω) [δ6_up(ω) and δ6_lo(ω) in the reference tracking case]. The method to 
enter the value of δi(ω) depends on the type of specification being defined, so that:
•	 Robust Stability Specs: (see Table A2.2, Equation A2.9, and Figure A2.20). 
δ1(ω) is a constant (Ws). The user can enter directly the value of δ1(ω) = Ws for 
the stability specification. Ws is the closed-loop constant magnitude circle (in 
magnitude) in the Nichols chart. In this case, the gain and phase margins are 
calculated automatically. If the user introduces the phase margin PM, then Ws 
and GM are calculated automatically. The following equations are used in the 
calculations:
	
Gain margin:
	
GM
Ws
=
+






20
1
1
10
log
, indB
	
(A2.16)
	
Phase margin:
	
PM
Ws
=
−











180
2 180
π
acos 0.5
in deg
,
	
(A2.17)
	
Closed-loop M circle:
	
W
PM
s =






−






0 5
180
180
2
.
cos
,
π
inmagnitude
	
(A2.18)
•	 Robust Performance Specs: (see Table A2.2, Equations A2.10 through A2.13, 
and Figures A2.21 and A2.22). δi(ω), i = 2,3,4,5 can be defined as a constant 
(see Figure A2.21), a vector of constants of the same length as the specifica­
tion frequency vector, or as transfer function (zero/pole/gain or num/den, see 
Figure A2.22). In this case, if δi(ω) is a transfer function, its Bode diagram is also 
displayed in the Specification window (similar to Figure A2.19).
FIGURE A2.21
Defining δ2(ω) = 0.9, as a constant. Similar for δi(ω), i = 2,3,4, and 5.

470
Appendix 2
•	 Robust Reference Tracking Specs: (see Table A2.2, Equation A2.14, and 
Figures A2.23 and A2.24). In this case the user has to define δ6_up(ω) and δ6_lo(ω) 
(see Figure A2.23). Again, both values can be defined as constants, as a vector 
of constants or as transfer functions. Besides, if this type of specification is 
selected, there are more plots available: the step time-response of δ6_up(ω) and 
δ6_lo(ω), the Bode diagram of δ6_up(ω)–δ6_lo(ω), see Figure A2.24, and the Bode dia­
gram of δ6_up(ω) and δ6_lo(ω), see Figure A2.19. The reference tracking specification 
type button (Figure A2.20) is active only if the plant has model uncertainty.
•	 Defined by User Specs: (see Table A2.2, Equation A2.15 and Figure A2.25). In 
this case the user not only has to enter δk(ω), but also A(jω), B(jω), C(jω), and 
FIGURE A2.23
Defining δ6_up(ω) and δ6_lo(ω) specifications. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy 
Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press 
book, Taylor & Francis Group, Boca Raton, FL.)
FIGURE A2.22
Defining δi(ω), i = 2,3,4, and 5 as a transfer function. Click: Transfer function in Figure A2.21. Then: δ2(s) = 
(2.719  s + 32.63)/(s2 + 6.061 s + 32.63). (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy 
Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press 
book, Taylor & Francis Group, Boca Raton, FL.)

471
Appendix 2
D(jω), for a specification |[A(jω)+B(jω)G(jω)]/[C(jω)+D(jω)G(jω)]|≤δk(ω). They 
can be constants (0 or 1), the system plant P(jω), or other auxiliary plants like 
M(jω), defined in the Plant Definition window. Notice that G(jω) is the feedback 
controller.
•	 Frequency Vector: The user can define a different frequency vector for each 
specification. These vectors must be a subset of the initial frequency vector of the 
system plant.
•	 Specification Addition: The user can define new specifications by selecting them 
in the Choose specification type panel—see Figure A2.19 or A2.20. Then, once the 
parameters of the specification are entered, the user clicks the Commit button to 
finally add the specification.
•	 Specification Edition: To edit a specification, the user has to select it in the Defined 
specifications panel. Then, the data of the specification are displayed in the center 
80
70
60
50
40
Magnitude (dB)
10–1
100
101
Frequency (rad/s)
102
103
30
20
10
0
FIGURE A2.24
Bode diagram of the difference δ6_up(ω)–δ6_lo(ω). (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind 
Energy Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC 
Press book, Taylor & Francis Group, Boca Raton, FL.) 
FIGURE A2.25
Defining Defined by user specs. Equation A2.15, having for example M(jω) from the Plant definition window, 
and doing |M(jω)/[1+P(jω)G(jω)]|.

472
Appendix 2
panel of the window. Once the specification is edited, the user clicks the Update 
button to apply the changes.
•	 Specification Removal: To remove a specification, the user selects it in the Defined 
specifications panel and clicks the Delete button.
A2.2.5  Bounds Window
Given the plant templates and the control specifications, QFT converts the closed-loop 
­magnitude specifications [T1(jω) to Tk(jω)] into magnitude and phase constraints for 
a ­nominal open-loop function L0(jω) = P0(jω)G(jω). These constraints are called QFT 
bounds—see Figure A2.26. After the design of the controller G(s) (next section), the nom­
inal open-loop function L0(jω) must remain above the solid-line bounds and below the 
dashed-line bounds at each specific frequency of interest, to meet the specifications.
The Bounds window (see Figure A2.26) shows the QFT bounds of each specification 
defined in the Specification window, as well as the Union of all the bounds and the 
Intersection (worst case scenario) of all the bounds.
By clicking “Show all” or “Hide all”, the toolbox plots all the bounds or hides all of them. 
By double clicking on its corresponding frequency, the bound of that frequency is shown 
or hidden.
The user can define the minimum, maximum, and step value of the phase vector of the 
bounds with the Edit phase vector submenu in the Edit menu.
FIGURE A2.26
Bounds window.

473
Appendix 2
A2.2.6  Controller Design Window
Once the user has introduced the information of the plant and the control specifications, 
and once the templates and bounds have been calculated, the next step involves the design 
(loop  shaping) of the feedback controller G(s), so that the nominal open-loop transfer 
­function L0(s) = P0(s)G(s) meets the bounds—see Figure A2.27. Generally speaking, the 
loop shaping, or G(s) design, requires to change the gain and add poles and zeros, either 
real or complex, until the nominal loop L0(s) lies above the solid-line bounds and below the 
dashed-line bounds at each frequency of interest.
•	 Controller management
•	 Controller addition. There are two ways of adding a new controller:
–	 To create the new controller from scratch, the user has to enter the name of 
the controller and press the Add controller button. If there is not any other 
controller defined with that name, the new controller appears in the list of 
added controllers.
–	 If the user wants to add a new controller based of the dynamics of an exist­
ing controller, the user has to select it from the “Added controllers” list 
and press the Copy button. The user has then to enter the name of the new 
controller in the emerging sub-window.
•	 Controller removal. To remove a controller, the user has to select it from the list 
of “Added controllers” and press the Delete button.
FIGURE A2.27
Controller design window.

474
Appendix 2
TABLE A2.3
Controller Elements, Gi(s)
Gain
±k
Integrators, Differentiators
1
sn , sn
Real zero
s
zi
+1
Real pole
1
1
s
pj
+
Complex zero
s
s
n
n
2
2
2
1
1
ω
ζ
ω
ζ
+
+
<
,(
)­
Complex pole
1
2
1
2
2
1
s
s
n
n
ω
ζ
ω
ζ
+
+
<
,(
)
Lead/Lag network
s
z
s
p
i
j
+






+






1
1
Notch filter
s
s
s
s
n
n
n
n
2
2
1
2
2
2
2
1
2
1
ω
ζ
ω
ω
ζ
ω
+
+






+
+






P.I. controller
K
T s
p
i
1
1
+






P.D. controller
K
T s
T
N s
p
d
d
1
1
+
+






P.I.D. controller
K
T s
T s
T
N s
p
i
d
d
1
1
1
+
+
+






FIGURE A2.28
Windows for gain, real zero, real pole, and integrator/differentiator.

475
Appendix 2
FIGURE A2.29
Window for complex zero and complex pole.
FIGURE A2.30
Window for Lead/Lag element and Notch filter.
FIGURE A2.31
Window for PI, PD, and PID controllers.

476
Appendix 2
•	 Controller dynamics. When defining a controller, the user can work with the 
dynamics listed in the Table A2.3, according to Equation A2.19.
	
L s
P s
G s
i
i
n
0
0
0
( )
( )
( )
=
[
]
=∏
	
(A2.19)
	
To add a new dynamic element Gi(s) in the controller G(s) = Π Gi(s), the user 
has to press the Add dynamic button. The dynamic is added with its predefined 
values. In the lower left corner of the window, there is a panel which shows 
information about the selected dynamic. The information displayed depends 
on the type of the element, as shown in Figures A2.28 through A2.31.
•	 Dynamic edition.
	
All the dynamics can be edited by entering their new values in the textboxes 
that appear in the Edit selected controller dynamic panel (see Figure A2.27), as 
shown in Figures A2.28 through A2.31.
•	 Dynamic removal.
	
The user can remove any element of the controller by selecting it in the 
Controller dynamics panel and pressing the Delete selected dynamic button.
	
	
When the user edits some dynamics of the controller, the updated L0(jω) is 
shown in the Nichols plot as a red-dashed line, meaning that the changes are 
provisional. To commit the changes, the user has to press the Commit button. 
Then the red-dotted line is drawn as a solid black line. To discard the changes, 
the user has to press the Cancel button.
	
	
Figures A2.32 illustrate an example of the graphic dynamic edition. 
Figure  A2.32a shows the Controller design window and two details of the 
secondary window. To meet the bounds, the user changes the position of the 
selected real pole, from p = 0.1 to p = 300. Figure A2.32b shows how all the 
plots have been updated accordingly.
•	 Change History. Each time the user adds, edits, or removes a dynamic ele­
ment, the change is added to the Controller history panel (see Figure A2.33). The 
user can undo and redo changes by selecting different entries in the Controller 
history panel, by pressing Ctrl+x and Ctrl+y, respectively, and by using the 
Edit menu as well.
•	 Secondary Window. The user can open a secondary window with the follow­
ing plots (see Figures A2.32 and A2.34): Bode diagram of G(s), Bode diagram of 
L0(s), root locus of L0(s), and unit step response of L0(s)/[1+L0(s)]. The secondary 
window can be resized, and the changes made to the selected controller are 
applied in real time to all the diagrams.
•	 Pointer Information: In the upper right corner of the Controller design 
window, there is a panel that shows information about the pointer—
see Figure  A2.35. If the pointer is over the Nichols plot, the panel shows 
­information about where the pointer is (magnitude and phase). If the pointer 
is placed over the L0(jω) line, the panel also includes the frequency ω associ­
ated with that point.

477
Appendix 2
(a)
(b)
FIGURE A2.32
An example of the graphic dynamic edition. From (a) pole pj = 0.1 to (b) pole pj = 300. NC: Original L0(s) in 
black solid line. New L0(s) in red dashed line. Secondary window: plant poles (x) and zeros (o) in black, controller 
poles (x) and zeros (o): blue = original, or red, green = new.

478
Appendix 2
A2.2.7  Prefilter Design Window
If the plant has model uncertainty and the control problem requires reference track­
ing specifications, then the Prefilter design window is active after the design of the G(s) 
controller.
Figure A2.36 shows the Prefilter design window, with the following plots: the upper and 
lower reference tracking specifications [δ6_up(ω), δ6_lo(ω), dashed blue lines], see Equation 
A2.14 and Figure A2.23, and the maximum and minimum cases of L0(s)F(s)/[1+L0(s)] over 
the plant uncertainty (dashed black lines).
FIGURE A2.33
Controller history panel. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)
FIGURE A2.34
Panel to open the secondary window. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy 
Systems: Control Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press 
book, Taylor & Francis Group, Boca Raton, FL.) 
FIGURE A2.35
Pointer info panel. (Adapted from Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control 
Engineering Design (Part I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & 
Francis Group, Boca Raton, FL.)

479
Appendix 2
The design of the prefilter calculates automatically the worst upper and lower closed-
loop response cases of L0(s)F(s)/[1+L0(s)] over the plant uncertainty. These cases should 
be between the upper and lower reference tracking functions to meet the specifications. 
The Prefilter design window is similar to the Controller Design window. The way in which 
the prefilters are added, edited, and removed is the same.
The Prefilter design window has an additional List of controllers panel, which 
allows the user to select among the feedback controllers G(s) designed in the previous 
window.
A2.2.8  Analysis Window
Once the user finishes the controller (and prefilter) design, the Analysis window is active. 
The analysis is performed in both the frequency domain and time domain. The window 
analyzes the controller G(s) and prefilter F(s) performance in the worst case scenario over 
the plant uncertainty.
•	 The window allows the user to perform two types of analysis:
	
Frequency-Domain Analysis: Select the specification of interest in the Specification 
panel, and the Frequency-domain option in the Analysis type panel. The Toolbox 
shows the Bode diagram for the specification and the control system with the 
selected controller and prefilter (if any). The dashed line represents the desired 
specification δi(ω) and the solid line the worst case of the control system over the 
FIGURE A2.36
Prefilter design window.

480
Appendix 2
FIGURE A2.37
Analysis window: Frequency-domain specifications.

481
Appendix 2
FIGURE A2.38
Analysis window: Time-domain specifications.

482
Appendix 2
(a)
(b)
FIGURE A2.39
Stability analysis: (a) with not enough points in the frequency vector and (b) with a more populated grid.

483
Appendix 2
plant uncertainty at each frequency—see Figure A2.37 for the analysis of the stabil­
ity and plant input disturbance rejection specifications in the frequency domain. 
Notice that the solid line is not a transfer function, but the worst case among all 
the transfer functions over the plant uncertainty at every frequency.
	
Time-Domain Analysis: After selecting the specification, the input (step or 
impulse), the controller G(s), and prefilter F(s), and clicking the time domain simu­
lation button, the toolbox analyzes the time response of the control system with 
every plant defined in the Parametric uncertainty panel. Figure A2.38 shows two 
cases: (a) y(t) response for L0(s)F(s)/[1+L0(s)] with r(s) = unitary step; and (b) y(t) 
response for P0(s)/[1+L0(s)] with d(s) = unitary impulse. The number of plants ana­
lyzed (number of lines plotted) depends on the values introduced in the Parametric 
uncertainty panel.
•	 Controller/Prefilter Combinations: The user can select any combination of con­
trollers (from the Controller List panel) and prefilters (from the Prefilter List panel) 
previously defined (if any).
•	 Frequency Vector Panel for the Analysis: The Analysis frequency vector panel 
allows the user to enter the frequency vector to be used in the frequency-domain 
­analysis.  If there are not enough points in the frequency vector, the resulting 
­analysis may not be accurate enough—see Figure A2.39.
•	 Parametric Uncertainty Panel: As was explained, this panel allows the user to 
modify the grid of the parametric uncertainty variables. Again, if too few points 
are selected, the analysis may not be accurate enough. On the other hand, if too 
many points are selected, the analysis may be slow. This panel allows the user 
to analyze the system in both, (1) the points previously defined in the plant 
­definition window (with the parametric uncertainty panel), and (2) in new points of 
­uncertainty, defined now in the analysis window with the parametric uncertainty 
panel.
If the responses for all the selected plants satisfy the desired control performance speci­
fications at both frequency and time domains, then the design is completed. If the design 
fails at any frequency or time, you may decide to re-design the controller or prefilter, or to 
check the plant model, uncertainty, or specification definitions.


485
Appendix 3: Algorithm—Nyquist 
Stability Criterion in Nichols Chart
This appendix includes the MATLAB code for the algorithm that calculates the stability 
criterion presented in Chapter 3. This is the practical method developed by the author to 
study the Nyquist stability criterion for feedback control systems in the Nichols chart.125
The algorithm is included in the QFTCT, Controller design window, File menu, Check sta­
bility option. Also, it can be free-downloaded from the website:
http://cesc.case.edu/Stability_Nyquist_GarciaSanz.htm
The code is presented next and includes references to the main equations, figures, cases, 
and rules of the method as developed in Chapter 3.
function [zc,N,num_p_RHP,Na,Nb,Nc,Nd,zpCancel,k,sigm,alpha,gamma]=c
alc_zc(L)
% Function to calculate closed-loop system stability
% - Input: L(s) = P(s) C(s)
% - Outputs: zc,N,num_p_RHP,Na,Nb,Nc,Nd,zpCancel,k,sigm,alpha,gamma
%        according to method introduced by Mario Garcia-Sanz (2016)
% - Code free-download at:
%   http://cesc.case.edu/Stability_Nyquist_GarciaSanz.htm
%   And also included in the QFTCT, Controller design window
% -----------------------------------------------------------------
% 1. Initial values
% -----------------
tolPh = 1e-3; % tolerance phase
tolPh1 = 0.002; % tolerance phase
tolPh2 = 5; % tolerance phase
tolM = 0.05; % tolerance magnitude
tolA = 0.05; % tolerance for change around 0.
wmin = 1e-16; % lowest freq.
zpCancel = 0; % RHP zero-pole cancelations. "0"=no, "1"=yes
z_LHP = [];  z_RHP = [];  z_0 = [];  z_i = [];
p_LHP = [];  p_RHP = [];  p_0 = [];  p_i = [];
% 2. gain, zeroes, poles, delay
% -----------------------------
dc_gain = abs(dcgain(L));
[zzz,ppp,kkk]=tf2zpk(L.num{1},L.den{1});
zzz_roots = roots([L.num{1}]);
ppp_roots = roots([L.den{1}]);
orderNum = length(zzz_roots);
orderDen = length(ppp_roots); 

486
Appendix 3
timeDelay = L.iodelay;
zzzRe = real(zzz_roots);
pppRe = real(ppp_roots);
zzzMag = abs(zzz_roots);
pppMag = abs(ppp_roots);
[row_z_LHP,column_z_LHP] = find(zzzRe<0);
num_z_LHP = length(row_z_LHP);
for ii=1:num_z_LHP
    z_LHP(ii,1) = zzz_roots(row_z_LHP(ii),column_z_LHP(ii));
end
[row_z_RHP,column_z_RHP] = find(zzzRe>0);
num_z_RHP = length(row_z_RHP);
for ii=1:num_z_RHP
    z_RHP(ii,1) = zzz_roots(row_z_RHP(ii),column_z_RHP(ii));
end
[row_z_0,column_z_0] = find(zzzMag==0);
num_z_0 = length(row_z_0);
for ii=1:num_z_0
    z_0(ii,1) = zzz_roots(row_z_0(ii),column_z_0(ii));
end
[row_z_i,column_z_i] = find(zzzRe==0 & zzzMag∼=0);
num_z_i = length(row_z_i);
for ii=1:num_z_i
    z_i(ii,1) = zzz_roots(row_z_i(ii),column_z_i(ii));
end
[row_p_LHP,column_p_LHP] = find(pppRe<0);
num_p_LHP = length(row_p_LHP);
for ii=1:num_p_LHP
    p_LHP(ii,1) = ppp_roots(row_p_LHP(ii),column_p_LHP(ii));
end
[row_p_RHP,column_p_RHP] = find(pppRe>0);
num_p_RHP = length(row_p_RHP);
for ii=1:num_p_RHP
    p_RHP(ii,1) = ppp_roots(row_p_RHP(ii),column_p_RHP(ii));
end
[row_p_0,column_p_0] = find(pppMag==0);
num_p_0 = length(row_p_0);
for ii=1:num_p_0
    p_0(ii,1) = ppp_roots(row_p_0(ii),column_p_0(ii));
end
[row_p_i,column_p_i] = find(pppRe==0 & pppMag∼=0);
num_p_i = length(row_p_i);

487
Appendix 3
for ii=1:num_p_i
    p_i(ii,1) = ppp_roots(row_p_i(ii),column_p_i(ii));
end
% 3. RHP zero-pole cancelation
% ----------------------------  (Sec.3-4. Rule 1)
cc = 0;
dd = [];
if ∼isempty(z_RHP) & ∼isempty(p_RHP)
    for pp=1:num_p_RHP
        dd = find(p_RHP(pp)==z_RHP);
        if ∼isempty(dd)
            cc=1;
            break;
        end
    end
end
if (num_z_0>0 & num_p_0>0) || cc==1
  zpCancel = 1;  
end
% 4. mag, pha, ww
% ---------------
% LN
[LNnum,LNden] = zp2tf([z_LHP;z_RHP],[p_LHP;p_RHP],kkk); 
LN = tf(LNnum,LNden);
[magLN0,phaseLN0] = bode(LN,0);
% L
[magL0,phaseL0] = bode(L,0); % phase at w=0
phaseL0 = round(phaseL0*100)/100; % Protection numerical accuracy
[mag2,pha2,ww2] = nichols(L);
ww1 = logspace(log10(ww2(1)),log10(ww2(end)),5000);
[mag1,pha1] = nichols(L,ww1);
nn = length(pha1);
mag = [];
pha = [];
ww = [];
for jj=1:nn
    mag(jj) = mag1(1,1,jj);
    pha(jj) = pha1(1,1,jj);
    ww(jj) = ww1(jj);
end
indPh2 = find(phaseL0∼=pha2,1,’first’); % the first that is "∼="
phaseL1 = pha2(indPh2); % phase at w=0+
leftRightAt0 = sign(phaseL0-phaseL1); 
% 5. Find crosses at -900, -540, -180, +180 etc and mag>1
% -------------------------------------------------------
pha_neg360_0 = pha;
for jj=1:nn
    if pha_neg360_0(jj)>tolPh

488
Appendix 3
        d1 = ceil(pha_neg360_0(jj)/360);
        pha_neg360_0(jj) = pha_neg360_0(jj) - 360*d1;
    elseif pha_neg360_0(jj)<=-360-tolPh
        d1 = floor(-pha_neg360_0(jj)/360);
        pha_neg360_0(jj) = pha_neg360_0(jj) + 360*d1;
    end
end
changeAround0 = pha_neg360_0 + 180;
indSignChange = [];
for jj=1:nn-1
   if (sign(changeAround0(jj+1))∼=sign(changeAround0(jj))) &  
         abs(pha_neg360_0(jj+1)-pha_neg360_0(jj))<(180-tolPh1)…
         & abs(pha_neg360_0(jj+1)-pha_neg360_0(jj))>tolPh1        
	
indSignChange = [indSignChange jj];
   end
end
mm = length(indSignChange);
ind_kk_180 = [];
for jj=1:mm
    if mag(indSignChange(jj)+1)>1 & mag(indSignChange(jj))>1
        ind_kk_180 = [ind_kk_180 indSignChange(jj)];
    end
end
if ∼isempty(ind_kk_180)
    n_ind_kk_180 = length(ind_kk_180);
end
% 6. Na. Fig.3.7(a)
% -----------------
Na = 0;
Na_1 = 0;
nMaxPha = length(pha);
if ∼isempty(ind_kk_180)   
    for jj=1:n_ind_kk_180
        Na_1(jj) = 0;
        if mag(ind_kk_180(jj))>(1+tolM) % if greater than 0 dB
            if (ind_kk_180(jj)+1)<nMaxPha % Protection
                pha21 = pha(ind_kk_180(jj)+1)-pha(ind_kk_180(jj));
                if abs(pha21)<tolPh
                    pha21 = 0;
                end
                ss = 1;
                while pha21==0
                    ss = ss+1;
                    if (nMaxPha-ind_kk_180(jj))>ss
                        pha21 = pha(ind_kk_180(jj)+ss)…
                                -pha(ind_kk_180(jj));
                        if abs(pha21)<tolPh
                            pha21 = 0;
                        end
                    else
                        pha21 = 0;

489
Appendix 3
                        return;
                    end
                end
                if pha21>0
                    Na_1(jj) = -2; % Fig.3.7(a) to the right
                elseif pha21<0
                    Na_1(jj) = +2; % Fig.3.7(a) to the left
                else
                    Na_1(jj) = 0; % Fig.3.7(a) in axis  
                end
            end
        end
    end
end
Na = sum(Na_1);
% 7. Nb. Fig.3.7(b)
% -----------------
Nb = 0;
if isfinite(dc_gain)==1  % dc_gain is finite
    k_at_w0 = ((phaseL0/(-180))-1)/2; % at -900,-540,-180,+180,etc
    if abs(k_at_w0-round(k_at_w0))<tolPh 
        if dc_gain>1 % dc_gain is >1
            pha21 = pha(2)-pha(1);
            ss = 2;
            while pha21==0
                ss = ss+1;
                if nMaxPha>ss
                    pha21 = pha(ss)-pha(1);
                else
                    pha21 = 0;
                    return;
                end
            end
            if pha21>0
                Nb = -1; % Fig.3.7(b) to the right
            elseif pha21<0
                Nb = +1; % Fig.3.7(b) to the left
            else
                Nb = 0; % Fig.3.7(b) in axis            
            end
        else % dc_gain is <1
            Nb = 0; % Fig.3.7(b)        
        end
    else
        Nb = 0; % Fig.3.7(b)
    end
end
% 8. Nc. Fig.3.7(c)
% -----------------
Nc = 0;

490
Appendix 3
if mag(end)>1  % mag(w=inf)>1
    k_at_wInf = ((pha(end)/(-180))-1)/2;
    if abs(k_at_wInf-floor(k_at_wInf))<0.001 
        % at -900,-540,-180,+180,etc
        pha21 = pha(end)-pha(end-1);
        ss = 1;
        while pha21==0
            ss = ss+1;
            if nMaxPha>ss
                pha21 = pha(end)-pha(end-ss);
            else
                pha21 = 0;
                return;
            end
        end
        if pha21>0
            Nc = -1; % Fig.3.7(c) to the right
        elseif pha21<0
            Nc = +1; % Fig.3.7(c) to the left
        else
            Nc = 0; % Fig.3.7(c) in axis            
        end
    else
        Nc = 0; % Fig.3.7(c)
    end
end
% 9. Nd. Fig.3.7(d)
% -----------------
Nd = 0; k = 0; sigm = 0; alpha = 0; gamma = 0; % Initialization
if num_p_0>0;    
    if isfinite(dc_gain)==1  % dc_gain is finite
        Nd = 0; % Fig.3.7(d)       
    else % dc_gain is infinite        
        % -- k --          
            if phaseL1>-180 & phaseL1<90 % Case [a]
                k = -1; % Eq.(3.8)
            elseif phaseL1>90 & phaseL1<180 
                if leftRightAt0==1 % to the left. Case [c]
                    k = 0; % Eq.(3.10)
                elseif leftRightAt0==-1 % to the right. Case [b]
                    k = -1; % Eq.(3.9)
                end  
            elseif phaseL1<=-180 % to the left and right. Case [d]
                k = -ceil((phaseL1+180)/360); % Eq.(3.11)
            elseif phaseL1>=180 % to the left and right. Case [e]
                k = -ceil((phaseL1-180)/360); % Eq.(3.12)               
            end
        % -- sigm --
            dcgainLN = dcgain(LN);

491
Appendix 3
            if dcgainLN>=0 % Case [a]
                sigm = 0; % Eq.(3.13)
            else % Case [b]
                sigm = 1; % Eq.(3.14)
            end
        % -- gamma --
            numZP = num_z_RHP + num_p_LHP - num_z_LHP - num_p_RHP;
            gamma = 2 * numZP/max(abs(numZP),1); % Eq.(3.20)
        % -- alpha --
            if phaseL0<=0
                if leftRightAt0==1 % to the left. Case [a] 
                    alpha = -ceil((phaseL0+90*(num_p_0))/360); 
                    % Eq.(3.15)
                elseif leftRightAt0==-1 % to the right. Case [b]
                    alpha = -ceil((phaseL0+90*(num_p_0-2))/360); 
                    % Eq.(3.16)
                end             
            elseif phaseL0>0
                if leftRightAt0==1 % to the left. Case [c]                 
                    alpha = floor((phaseL0+90*(num_p_0-2))/360); 
                    % Eq.(3.17)
                elseif leftRightAt0==-1 % to the right. Case [d] 
                    alpha = -floor((phaseL0-90*(num_p_0))/360); 
                    % Eq.(3.18) 
                end                
            end            
            if orderNum==orderDen & …
               ( (pha(end)<180+tolPh2 & pha(end)>180-tolPh2)…
               | (pha(end)<tolPh2 & pha(end)>-tolPh2) ) % Case [e]
                alpha = 0; % Eq.(3.19) 
            end  
        Nd = 2*(k+1) + sigm + alpha*gamma; % Eq.(3.6)           
    end
end
% 10. N sum
% ---------
N = Na + Nb + Nc + Nd; % Eq.(3.5)
% 11. Zc sum
% ----------  (Sec.3-4. Rule 2)
zc = N + num_p_RHP;
% The closed-loop system is stable if:
% - Rule 1: “zpCancel=0”. RHP zero-pole cancelations "0"=no,"1"=yes
% - Rule 2: “zc = 0”. Being zc = N + num_p_RHP
% ---------------------------------------------


493
Appendix 4: Algorithms—Smith 
Predictor Robust Control
This appendix includes the MATLAB code of the algorithms presented in Chapter 4, 
Example 4.1, for the QFT design of a Smith predictor.
% Example 4.1
% ===========
% TABLE 4.1 (The First algorithm). Section 4-2.1
% ==============================================
% Table 4.1. Step 1 ----
n1 = 5;
n2 = 5;
n3 = 5;
k = linspace(8.1,9.9,n1);
tau = linspace(2.25,2.75,n2);
td = linspace(0.63,0.77,n3);
% Table 4.1. Step 2 ----
omegaBW = 2.25; % rad/sec 
magSelecUp = 1.4125; % 3 dB = 1.4125 in magnitude
magSelecLo = 1/1.4125; % 3 dB = 1.4125 in magnitude
rejectedModels = [];
r3 = 0;
% Table 4.1. Step 3 ----
r1 = 0;
for i1=1:1:n1
  km0 = k(i1);
  for j1=1:1:n2
    taum0 = tau(j1);
    for k1=1:1:n3
      tdm0 = td(k1);
      r1 = r1 + 1;
      Prm(r1) = tf(km0,[taum0 1]); % SP plant model, no delay
      Pm(r1) = tf(km0,[taum0 1],’iodelay’,tdm0); % SP plant model
      models(r1).km0 = km0;
      models(r1).taum0 = taum0;
      models(r1).tdm0 = tdm0;   
      % Table 4.1. Step 4 ----
      r2 = 0;
      for i2=1:1:n1
        k0 = k(i2);

494
Appendix 4
        for j2=1:1:n2
          tau0 = tau(j2);
          for k2=1:1:n3
            td0 = td(k2);
            r2 = r2 + 1;
            P(r2) = tf(k0,[tau0 1],’iodelay’,td0); % Real plant
            P0(r2) = tf(k0,[tau0 1]); % Real plant, no delay 
            exp_mod_cx = exp(-tdm0*omegaBW*j);
            exp_plant_cx = exp(-td0*omegaBW*j);
            Prm_cx = freqresp(Prm(r1),omegaBW);
            P0_cx = freqresp(P0(r2),omegaBW);
            H = (1 - exp_mod_cx) * (Prm_cx/P0_cx) + exp_plant_cx;
            Q = exp_plant_cx / H;
            magQ = abs(Q);
            % Table 4.1. Step 5 ----
            if magQ > magSelecUp || magQ < magSelecLo
              r3 = r3 + 1;
              rejectedModels(r3) = r1;
            end
          end
        end
      end            
    end      
  end   
end
nModels = [1 : 1 : n1*n2*n3];
rejectedModels = unique(rejectedModels);
acceptedModels = setxor(nModels,rejectedModels);
r1 = 0;
rr = 0;
for i1=1:1:n1
  km0 = k(i1);
  for j1=1:1:n2
    taum0 = tau(j1);
    for k1=1:1:n3
      tdm0 = td(k1);
      r1 = r1 + 1;
      if ∼isempty (find(acceptedModels==r1))
        rr = rr + 1;
        modelsStep1(rr).k = km0;
        modelsStep1(rr).tau = taum0;
        modelsStep1(rr).td = tdm0;   
        modelsStep1(rr).wBW = omegaBW;
        modelsStep1(rr).magUp = magSelecUp;
        modelsStep1(rr).magLo = magSelecLo;
      end          
    end
  end
end

495
Appendix 4
vv(:,1) = [modelsStep1(1:rr).tau]’;
vv(:,2) = [modelsStep1(1:rr).td]’;
vv(:,3) = [modelsStep1(1:rr).k]’;
figure;
plot3(vv(:,1),vv(:,2),vv(:,3),’.’,’MarkerSize’,10);
grid on;
xlabel(’{\tau}’,’FontSize’,16,’FontWeight’,’bold’,’Color’,’k’);
ylabel(’td’,’FontSize’,12,’FontWeight’,’bold’,’Color’,’k’);
zlabel(’K’,’FontSize’,12,’FontWeight’,’bold’,’Color’,’k’);
title([’wBW = ’,num2str(omegaBW),’ rad/sec’]);
bb = boundary(vv);
hold on;
trisurf(bb,vv(:,1),vv(:,2),vv(:,3),’Facecolor’,’red’,’FaceAl
pha’,0.1);
axis([tau(1)*0.95,tau(end)*1.05,td(1)*0.95,td(end)*1.05,k(1)*0.95,​
k(end)*1.05]);
view(-61.5,20);
% -----------------------------------------------------------------
% TABLE 4.2 (The Second algorithm). Section 4-2.2
% ===============================================
% Model selection for SP. From modelsStep1(1:rr)
ww = [0.5 1 1.5 2];
numFreq = length(ww);
for ff=1:numFreq  
  atW(ff).w0 = ww(ff);  
  % Table 4.2. Step 1 ----
  for numModel = 1:1:rr % select from 1 to end
    taum0 = modelsStep1(numModel).tau; % model selected for SP
    tdm0 = modelsStep1(numModel).td; % model selected for SP
    km0 = modelsStep1(numModel).k; % model selected for SP
    % Table 4.2. Step 2 ----
    c = 0;
    for i1=1:1:n1
      for j1=1:1:n2
        for k1=1:1:n3
          c = c + 1;
          Prm = tf(km0,[taum0 1]); % model without delay
          Pm = tf(km0,[taum0 1],’iodelay’,tdm0); % model with delay
          P = tf(k(i1),[tau(j1) 1],’iodelay’,td(k1)); % real plant  
          Prm_w0 = freqresp(Prm,ww(ff)); % at ww(ff)
          Pm_w0 = freqresp(Pm,ww(ff)); % at ww(ff)
          P_w0 = freqresp(P,ww(ff)); % at ww(ff) 
          % Eq.(4.19)
          atW(ff).Peq(numModel).complex(c) = Prm_w0 - Pm_w0 + P_w0;
          atW(ff).Peq(numModel).dB(c) = …
            20*log10(abs(atW(ff).Peq(numModel).complex(c)));
          atW(ff).Peq(numModel).ph(c) = …

496
Appendix 4
            angle(atW(ff).Peq(numModel).complex(c))*180/pi;
          if numModel==1 % only once
            atW(ff).Preal.complex(c) = P_w0; % P real a ww(ff)
            atW(ff).Preal.dB(c) = …
              20*log10(abs(atW(ff).Preal.complex(c)));
            atW(ff).Preal.ph(c) = …
              angle(atW(ff).Preal.complex(c))*180/pi;  
          end
        end
      end
    end
   end
end
colors = [’r’ ’g’ ’b’ ’c’ ’m’ ’k’];
figure;
hold on;
% Table 4.2. Step 3 ----
for ff=1:numFreq
  xr = atW(ff).Preal.ph;
  yr = atW(ff).Preal.dB;
  hr = convhull(xr,yr);
  plot(xr(hr),yr(hr),’-k’,xr(hr),yr(hr),’.k’,’MarkerSize’,10)
  atW(ff).areaTemplateReal = polyarea(xr(hr),yr(hr));
  for numModel=1:1:rr
    xx = atW(ff).Peq(numModel).ph;
    yy = atW(ff).Peq(numModel).dB;
    hh = convhull(xx,yy);
    plot(xx(hh),yy(hh),[’-’,colors(mod…
      (numModel-1,6)+1)],xx(hh),yy(hh),…
      [’.’,colors(mod(numModel-1,6)+1)],’MarkerSize’,10)
    atW(ff).areaTemplate(numModel) = polyarea(xx(hh),yy(hh));
    atW(ff).areaRatio(numModel) = …
      atW(ff).areaTemplate(numModel) / …
      atW(ff).areaTemplateReal; % Eq.(4.22)
  end
end
grid;
xlabel(’Phase (deg)’);
ylabel(’Magnitude (dB)’);
WeightF = 1 + 0 * [1:numFreq];
for numModel=1:1:rr
  sumAreaRatio = 0;
  for ff=1:numFreq 
    sumAreaRatio = sumAreaRatio + WeightF(ff) * …
      atW(ff).areaRatio(numModel);
  end
  Icost(numModel) = (1/numFreq) * sumAreaRatio;
end
figure;

497
Appendix 4
bar(Icost,0.5);
axis([0,numModel+1,0.93,1.02]);
grid;
xlabel(’model number’);
ylabel(’Icost’);
% -----------------------------------------------------------------
% Peq for the QFT Control Toolbox. Section 4-2.2
% ==============================================
% The model selected for the SP is model 6
km0 = 8.55; % model 6. Eq.(4.26)
taum0 = 2.75; % model 6. Eq.(4.26)
tdm0 = 0.77; % model 6. Eq.(4.26)
c = 0;
for i1=1:1:n1
  for j1=1:1:n2
    for k1=1:1:n3
      c = c + 1;
      Prm = tf(km0,[taum0 1]); % model without delay
      Pm = tf(km0,[taum0 1],’iodelay’,tdm0); % model with delay
      P = tf(k(i1),[tau(j1) 1],’iodelay’,td(k1)); % real plant 
      Peq(1,1,c) = Prm - Pm + P; % Peq for the QFTCT. Eq.(4.19)
      % Note that Peq includes internal delays. For this reason 
      % Matlab automatically calculates it in State Space 
    end
  end
end
save Peq Peq; % Plant to import, from disk into QFTCT
% ---------------------------------------------


499
Appendix 5: Algorithms—DPS Robust Control
This appendix includes the MATLAB code of the algorithms presented in Chapter 5, 
Example 5.1, for the design of a QFT robust control solution for a heat transmission distrib­
uted parameter system.
% Example 5.1
% ===========
% This m.file calculates the transfer functions with parametric
% uncertainty Pxoxd, Pxsxd, Pxoxa, Pxsxa and B1 for the QFTCT.
% ===================================================
====
% Symbolic representation ---
syms k1 k2 k3 R c s
q11 = (1/(k1*R)) + (k1*c*s/2) + (1/(k2*R)) + (k2*c*s/2); 
q12 = -(1/(k2*R));
q21 = -(1/(k2*R));
q22 = (1/(k2*R)) + (k2*c*s/2) + (1/(k3*R)) + (k3*c*s/2); 
Q = [q11 q12 ; q21 q22];
P = inv(Q); % P contents Eqs. (5.39) to (5.47)
% Transfer functions ---
% The following sentences introduce the parameters (both
% fixed parameters and parameters with uncertainty) in P
k1 = pi/4; % fixed parameter
k2 = pi/4; % fixed parameter
P1 = subs(P);
[P0,sigma] = subexpr(P1); % sigma is the common subexpression
commonDenP0 = 1/sigma;
commonDenP0Subs = subs(commonDenP0);
denP = coeffs(commonDenP0Subs,s);
P0withoutSigma = subs(P0,’sigma’,1); 
PxoxdNum = coeffs(P0withoutSigma(1,1),s); 
PxoxaNum = coeffs(P0withoutSigma(1,2),s);
PxsxdNum = coeffs(P0withoutSigma(2,1),s);
PxsxaNum = coeffs(P0withoutSigma(2,2),s);
k3v0 = pi/2; % parameters with uncertainty
Rv0 = 1;
cv0 = 1;
k3v = linspace(k3v0*0.9,k3v0*1.1,5);
Rv = linspace(Rv0*0.9,Rv0*1.1,5);
cv = linspace(cv0*0.9,cv0*1.1,5);

500
Appendix 5
n1Max = length(k3v);
n2Max = length(Rv);
n3Max = length(cv);
jj = 0;
for n1=1:n1Max
  k3 = k3v(n1);
  for n2=1:n2Max
    R = Rv(n2);
    for n3=1:n3Max
      c = cv(n3);
      PxoxdNumSubs = double(vpa(subs(PxoxdNum),5));
      PxoxaNumSubs = double(vpa(subs(PxoxaNum),5));
      PxsxdNumSubs = double(vpa(subs(PxsxdNum),5));
      PxsxaNumSubs = double(vpa(subs(PxsxaNum),5));
      denPSubs = double(vpa(subs(denP),5));
      jj = jj + 1;
      Pxoxd(1,1,jj) = tf(PxoxdNumSubs,denPSubs); 
      Pxoxa(1,1,jj) = tf(PxoxaNumSubs,denPSubs);
      Pxsxd(1,1,jj) = tf(PxsxdNumSubs,denPSubs);
      Pxsxa(1,1,jj) = tf(PxsxaNumSubs,denPSubs);
      B = Pxsxa(1,1,jj)*Pxoxd(1,1,jj)-Pxoxa(1,1,jj)*Pxsxd(1,1,jj);
      B1(1,1,jj) = minreal(B);
    end
  end
end
save Pxoxd Pxoxd; % Pxoxd plant. To import, from disk into QFTCT 
save Pxsxd Pxsxd; % Pxsxd plant. To import, from disk into QFTCT
save Pxoxa Pxoxa; % Pxoxa plant. To import, from disk into QFTCT 
save Pxsxa Pxsxa; % System plant. To import, from disk into QFTCT
save B1 B1; % For spec yxo/uxd. To import, from disk into QFTCT
% ---------------------------------------------

501
Appendix 6: Algorithms—Gain 
Scheduling/Switching Control
This appendix includes the MATLAB code of the algorithms presented in Chapter 6, 
Examples 6.1 and 6.2, for the design of gain scheduling/QFT switching robust control 
solutions.
% Example 6.1, Case 1
% ===================
A1 = [0 1 0;0 0 1;-1 -2 -3]; % Eq.(6.20)
B1 = [-1 0 0]’;
C1 = [0 1 1];
D1 = [0];
[numT1,denT1] = ss2tf(A1,B1,C1,D1);
numL1 = numT1; 
denL1 = denT1-numT1; 
L1 = tf(numL1,denL1); % Eq.(6.21)
A2 = [0 1 0;0 0 1;-2 -3 -1]; % Eq.(6.20)
B2 = [-1 0 0]’;
C2 = [0 1 1];
D2 = [0];
[numT2,denT2] = ss2tf(A2,B2,C2,D2);
numL2 = numT2; 
denL2 = denT2-numT2; 
L2 = tf(numL2,denL2); % Eq.(6.22)
w = [0.01:0.01:10]; %  frequency vector
FR_1L1 = freqresp((1+L1),w);
An_FR_1L1 = angle(FR_1L1(1,:));
FR_1L2 = freqresp((1+L2),w);
An_FR_1L2 = angle(FR_1L2(1,:));
Phi12 = abs((An_FR_1L2 - An_FR_1L1))*180/pi; %  Phi12. Eq.(6.16)
FR_alpha = freqresp(tf(denL2,denL1),w);
alpha = abs(angle(FR_alpha(1,:)))*180/pi; %  alpha. Eq.(6.17)
figure;
plot(w,Phi12+alpha,w,90+w*0); % Fig.6.5. To check Eq.(6.18)
xlabel (’w (rad/s)’); 
ylabel(’Phi12+alpha & 90 degrees’);

502
Appendix 6
% Example 6.1, Case 2
% ===================
A1 = [-3 -2 -1; 1 0 0; 0 1 0]; % Eq.(6.23)
B1 = [1 0 0]’;
C1 = [3 2 0];
D1 = [0];
[numT1,denT1] = ss2tf(A1,B1,C1,D1);
numL1 = numT1; 
denL1 = denT1-numT1; 
L1 = tf(numL1,denL1); % Eq.(6.24)
A2 = [-1 -3 -2; 1 0 0; 0 1 0]; % Eq.(6.23)
B2 = [1 0 0]’;
C2 = [1 3 1];
D2 = [0];
[numT2,denT2] = ss2tf(A2,B2,C2,D2);
numL2 = numT2; 
denL2 = denT2-numT2; 
L2 = tf(numL2,denL2); % Eq.(6.25)
w = [0.01:0.01:10]; %  frequency vector
FR_1L1 = freqresp((1+L1),w);
An_FR_1L1 = angle(FR_1L1(1,:));
FR_1L2 = freqresp((1+L2),w);
An_FR_1L2 = angle(FR_1L2(1,:));
Phi12 = abs((An_FR_1L2 - An_FR_1L1))*180/pi; %  Phi12. Eq.(6.16)
figure;
plot(w,Phi12,w,90+w*0); % Fig.6.6. To check Eq.(6.18)
xlabel (’w (rad/s)’); 
ylabel(’Phi12 & 90 degrees,(alpha=0)’);
% Example 6.2
% ===========
A1 = [-3 -2 -1;1 0 0;0 1 0]; % Eq.(6.26)
B1 = [1 0 0]’;
C1 = [0 0 1];
D1 = [0];
[numT1,denT1] = ss2tf(A1,B1,C1,D1);
numL1 = numT1; 
denL1 = denT1-numT1; 
L1 = tf(numL1,denL1); % Eq.(6.27)
A2 = [-3 -1 -1;1 0 0;0 1 0]; % Eq.(6.26)
B2 = [1 0 0]’;
C2 = [0 0 1];
D2 = [0];

503
Appendix 6
[numT2,denT2] = ss2tf(A2,B2,C2,D2);
numL2 = numT2; 
denL2 = denT2-numT2; 
L2 = tf(numL2,denL2); % Eq.(6.28)
w = [0.01:0.01:10]; %  frequency vector
FR_1L1 = freqresp((1+L1),w);
An_FR_1L1 = angle(FR_1L1(1,:));
FR_1L2 = freqresp((1+L2),w);
An_FR_1L2 = angle(FR_1L2(1,:));
Phi12 = abs((An_FR_1L2 - An_FR_1L1))*180/pi; %  Phi12. Eq.(6.16)
FR_alpha = freqresp(tf(denL2,denL1),w);
alpha = abs(angle(FR_alpha(1,:)))*180/pi; %  alpha. Eq.(6.17)
figure; 
plot(w,Phi12+alpha,w,90+w*0); % Fig.6.7. To check Eq.(6.18)
xlabel(’w (rad/s)’); 
ylabel(’Phi12+alpha & 90 degrees’);
% ---------------------------------------------


505
Appendix 7: Algorithms—Nonlinear 
Dynamic Control
This appendix includes the MATLAB code of the cases presented in Chapter 7, Sections 7.4 
and 7.5, for the design of nonlinear dynamic controllers.
% Section 7-4.
% Example 7.1. PID with anti wind-up
% ===================================
% (1) Model Definition. Nominal Plant. Eq.(7.7)
P0 = tf(0.5,conv(conv([1/0.83 1],[1/0.83 1]),[1/0.83 1])); %nominal
% (2) Controller G1(s). Designed with QFTCT. Eq.(7.11)
G1 = tf(0.7*[1/0.5^2 2*0.9/0.5 1],[1/300 1 0]); % QFTCT pid1.mat
% (3) Function L1(s)
L1 = minreal(P0 * G1);
% (4) Function A(s).
A = tf(0.9,[1 0]); % Eq.(7.13)
% (5) Function LE(s).
Le = minreal((L1-A)/(1+A)); % Eq.(7.14)
% (6) Figures
figure;step(L1/(1+L1));
ww1 = logspace(-2,4,10000);
figure; bode(G1,’g-’,A,’r--’,ww1);grid; % Fig.7.15a
ww2 = logspace(-3,2,10000);
figure; bode(L1,’b-’,Le,’--r’,ww2);grid; % Fig.7.15b
% (7) Circle criterion
n1 = 10; n2 = 10;
k1v = linspace(0.5,1.5,n1);
m1v = linspace(0.83,1.25,n2);
cc = 0;
figure; hold on;
for ii=1:n1
    k1 = k1v(ii);
    for jj=1:n2
        cc = cc + 1;
        m1 = m1v(jj);
        p = tf(k1,[1/m1 1]);
        L1 = p*G1;

506
Appendix 7
        Le(cc) = minreal((L1-A)/(1+A));
        nyquist(Le(cc)); % Fig.7.16
    end  
end
% Section 7-5. NDC
% Example 7.2. NDC with several nonlinearities
% ============================================
% (1) Model Definition. Nominal Plant P0(s).
k = 610;
a = 1;
b = 150;
numP = k/(a*b);
denP = conv(conv([1/a 1],[1/b 1]),[1 0]);
P0 = tf(numP,denP); % Nominal plant P0(s). Eq.(7.33)
% (2) Controller G1(s). Designed with QFTCT. NDC_Control_G1.mat
numG1 = 89 * conv([1/1.2 1],[1/5 1]);
denG1 = [1/500 1 0];
G1 = tf(numG1,denG1); % Eq.(7.37)
% (3) Controller G2(s). Designed with QFTCT. NDC_Control_G2.mat
numG2 = 0.0035 * conv([1/0.002 1],[1/3 1]);
denG2 = [1/10 1 0];
G2 = tf(numG2,denG2); % Eq.(7.42)
% (4) Function L01(s) and L02(s)
L10 = P0 * G1;
L20 = P0 * G2;
ww = logspace(-3,3,10000);
figure; bode(L10,L20,ww); grid; % Fig.7.38
% (5) Function A(s)
A = tf(4.5,[1 0]); % Eq.(7.44)
ww0 = logspace(-6,4,10000);
figure; 
bode(G1,’-.b’,G2,’--g’,A,’-r’,ww0); % Fig.7.39a
grid;
% (6) Functions Le10(s), Le20(s)
Le10 = minreal((L10-A)/(1+A));
Le20 = minreal((L20-A)/(1+A));
ww1 = logspace(-4,5,10000);
figure; 
bode(L10,’-b’,Le10,’-.b’,L20,’-g’,Le20,’-.g’,ww1); % Fig.7.39b
grid; 
% (7) Circle criterion for Le1 and Le2
n1 = 4; n2 = 4; n3 = 4;
kv = linspace(610,1050,n1);

507
Appendix 7
av = linspace(1,15,n2); 
bv = linspace(150,170,n2);
cc = 0;
figure(21); hold on;
figure(22); hold on;
for i1=1:n1
    k = kv(i1);
    for i2=1:n2
        a = av(i2);
        for i3=1:n3
            b = bv(i3);
            cc = cc + 1;
            numP = k/(a*b);
            denP = conv(conv([1/a 1],[1/b 1]),[1 0]);
            p = tf(numP,denP); % plants
            L1 = p*G1;
            L2 = p*G2;
            Le1(cc) = minreal((L1-A)/(1+A));
            Le2(cc) = minreal((L2-A)/(1+A));
            figure(21); nyquist(Le1(cc)); % Fig.7.40a
            figure(22); nyquist(Le2(cc)); % Fig.7.40b
        end
    end  
end
% (8) Iso-lines
UpperLimitSatAct = 1.1;
LowerLimitSatAct = -1.1;
ModelUpperLimitSatAct = 1.1; 
ModelLowerLimitSatAct =  -1.1;
delta_high = 0.15;
delta_low = 0.075;
fact_delta = delta_high^2 - delta_low^2;
clear phLc; clear dBLc;
e_st = -5;         
e_end = 2;         
e_num = 60;
error = logspace(e_st,e_end,e_num); % inputs: E = error
w_st = -4; 
w_end = 5;
w_num = 100; 
www = logspace(w_st,w_end,w_num); % frequencies
for jj=1:1:w_num    
   wc = www(jj);               
   [mod,deg] = bode(P0,wc); ph = deg*pi/180;
   pp = mod*(cos(ph)+j*sin(ph)); % plant at wc
   [mod,deg] = bode(G1,wc); ph = deg*pi/180;
   c1 = mod*(cos(ph)+j*sin(ph)); % controller G1(s) at wc
   [mod,deg] = bode(G2,wc); ph = deg*pi/180;
   c2 = mod*(cos(ph)+j*sin(ph)); % controller G2(s) at wc   
   [mod,deg] = bode(A,wc); ph = deg*pi/180;

508
Appendix 7
   aa = mod*(cos(ph)+j*sin(ph)); % function A(s) at wc
   for ii=1:1:e_num
       x0 = error(ii); % error (input to L)
       if (abs(x0)<=delta_low) 
           N1 = 1; % contr.nonlinearity N1
           N2 = 1 - N1; % contr.nonlinearity N2
       else
           N1 = j * (1/pi/x0^2)*fact_delta; % contr.nonlinearity N1
           N2 = 1 - N1; % contr.nonlinearity N2
       end;                  
       x1 = c1 * N1 * x0; % output of G1
       x2 = c2 * N2 * x0; % output of G2
       x3 = x1 + x2; % output of G1 + G2
       x4 = x3; % block inner-lopp with A(s) and Nsaturation
       mod_x4 = abs(x4);
       if mod_x4>ModelUpperLimitSatAct % Dead zone = 1-Saturation
           dE = ModelUpperLimitSatAct/mod_x4;  
           Ndz = (1 - (2/pi)*(asin(dE)+dE*sqrt(1-dE^2)));
           x4 = (1/(1+real(aa)*Ndz)) * x4;
       end
       if (abs(x4)<=UpperLimitSatAct) % Actuator Saturation
           Nsat = 1;
       else
           mod_x4 = abs(x4);               
           dE = UpperLimitSatAct/mod_x4;  
           Nsat = abs((2/pi)*(asin(dE)+dE*sqrt(1-dE^2)));
       end     
       x7 = Nsat * x4; % output of actuator saturation (= v)
       x8 = pp * x7; % plant output (= y)
       Lc(ii) = x8/x0;
       dBLc(ii,jj)=20*log10(abs(Lc(ii)));
       angLc=unwrap(angle(Lc(ii)));
       nn=angLc/2/pi; nn=ceil(nn); angLc=-(2*pi)*nn+angLc;
       phLc(ii,jj)=angLc*180/pi;
   end
end                    
figure; hold on;
nichols(L10,’b.’,L20,’g.’);
for kk=1:1:e_num, 
   plot(phLc(kk,:),dBLc(kk,:),’k:’); % plot iso-lines. Fig.7.41
end;
title(’NDC. Iso-lines.’);
axis([-270 0 -120 120]);
% -----------------------------------

509
Appendix 8: Algorithms—MIMO Robust Control
This appendix includes the MATLAB code for the examples and cases presented in 
Chapter 8: MIMO QFT robust control.
% Example 8.3. Section 8-3.3
% ==========================
p11 = tf(4*[1 -1],[1 1]); 
p12 = tf([1 0],[1 2]);
p21 = tf(-6,[1 1]);
p22 = tf([1 -2],[1 1]);
P = [p11 p12 ; p21 p22]; % Eq.(8.30)
Pinv = inv(P);
Pinv = minreal(Pinv); % Eq.(8.32)
zeros = roots(Pinv.den{1});
% Example 8.4. Section 8-3.3
% ==========================
p11 = tf([1 1],[5 1]);
p12 = tf([1 4],[5 1]);
p21 = tf([1 1],[5 1]);
p22 = tf([2 2],[5 1]);
P = [p11 p12 ; p21 p22]; % Eq.(8.33)
Pinv = inv(P);
Pinv = minreal(Pinv); % Eq.(8.34)
zeros = roots(Pinv.den{1});
P0 = dcgain(P); % Eq.(8.35)
rga = P0 .* (inv(P0))’; % Eq.(8.36)
Pinf = (1/5)*[1 1;1 2]; % Eq.(8.37)
rga = Pinf .* (inv(Pinf))’; % Eq.(8.38)
% Example 8.1. Section 8-3.5
% ==========================
p11 = tf(7,[1/0.25 1]);
p12 = tf(9,[1/0.2 1]);
p21 = tf(3,[1/0.125 1]);
p22 = tf(5,[1/0.5 1]);
P = [p11, p12 ; p21 , p22]; % Eq.(8.4)
P0 = dcgain(P); % Eq.(8.39)
[U,sig,V] = svd(P0); % Eq.(8.40)
% Example 8.1. Section 8-1
% ========================

510
Appendix 8
% Heat exchanger example.
% (1) Model Definition. Nominal Plant. Eq.(8.4)
p11 = tf(7,[1/0.25 1]);
p12 = tf(9,[1/0.2 1]);
p21 = tf(3,[1/0.125 1]);
p22 = tf(5,[1/0.5 1]);
Pn = [p11, p12 ; p21 , p22]; 
Pn.InputName = {’u’};
Pn.OutputName = {’y’};
% (2) Conversions
Pss = ss(Pn); % from transfer function matrix to state space model
Ptf = tf(Pss); % from state space to transfer function matrix
% (3) Independent design. g11 and g22 (PIDs with filter). Fig.8.2
% --- for p11. QFTCT project: main_indep_g11.mat
g11i = tf(0.18*[1/0.2 1],[1/390 1 0]); % Eq.(8.9)
% --- for p22. QFTCT project: main_indep_g22.mat
g22i = tf(0.25*[1/0.35 1],[1/190 1 0]);  % Eq.(8.10)
% --- Diagonal controller matrix
Gi = [g11i, 0; 0, g22i];
Gi.InputName = {’e’};
Gi.OutputName = {’u’};
% (4) Closed loop MIMO system
Sum = sumblk(’e = r - y’,2);
CLry = connect(Pn,Gi,Sum,’r’,’y’); % Closed loop MIMO system
% (5) Simulation closed loop MIMO system
tinc = 0.01;
tt = [0:tinc:300];
nn = length(tt);
U1 = [[0:tinc:20]*0,1+[20+tinc:tinc:300]*0]; % input 1
U2 = [[0:tinc:170]*0,1+[170+tinc:tinc:300]*0]; % input 2
figure,lsim(CLry,[U1;U2],tt); % Fig.8.9
% Example 8.1. Section 8-8 (MIMO QFT Method 1)
% ============================================
% Heat exchanger example.
% (1) Step A
% ----------
% --- RGA. According to nominal plant. 
p11 = tf(7,[1/0.25 1]);
p12 = tf(9,[1/0.2 1]);
p21 = tf(3,[1/0.125 1]);
p22 = tf(5,[1/0.5 1]);
Pn = [p11, p12 ; p21 , p22]; 

511
Appendix 8
P0 = dcgain(Pn);
rga = P0 .* inv(P0)’; % Eq.(8.5) and Eq.(8.163)
% --- Order. According to nominal plant.
Pninv = inv(Pn);
Pninv = minreal(Pninv);
pinv11_inv = 1/Pninv(1,1);
pinv22_inv = 1/Pninv(2,2);
figure; bode(pinv11_inv,pinv22_inv);grid; % Fig.8.21. 
% (2) Step B
% ----------
% --- Inverse plant "P(s)*" with uncertainty
% -- grid for uncertainty
n1 = 2; n2 = 2; n3 = 2; n4 = 2; 
n5 = 2; n6 = 2; n7 = 2; n8 = 2; 
% -- parameters
k11v = linspace(6.3,7.7,n1); % parameters, see Eq. (8.4)
k12v = linspace(8.9,9.1,n2);
k21v = linspace(2.9,3.1,n3);
k22v = linspace(4.5,5.5,n4);
tau11v = linspace(3.6,4.4,n5);
tau12v = linspace(4.9,5.1,n6);
tau21v = linspace(7.9,8.1,n7);
tau22v = linspace(1.8,2.2,n8);
cc = 0;
% --- for QFTCT, design of g22_med1(s) and f22_med1(s)
for i1=1:n1
  k11 = k11v(i1);
  for i2=1:n2
    k12 = k12v(i2);
    for i3=1:n3
      k21 = k21v(i3);
      for i4=1:n4
        k22 = k22v(i4);
        for i5=1:n5
          tau11 = tau11v(i5);
          for i6=1:n6
            tau12 = tau12v(i6);
            for i7=1:n7
              tau21 = tau21v(i7);
              for i8=1:n8
                cc = cc + 1;
                tau22 = tau22v(i8);
                p11 = tf(k11,[tau11 1]); % from Eq.(8.4)
                p12 = tf(k12,[tau12 1]); % from Eq.(8.4)
                p21 = tf(k21,[tau21 1]); % from Eq.(8.4)
                p22 = tf(k22,[tau22 1]); % from Eq.(8.4)
                Plant(cc).tfm = [p11, p12 ; p21 , p22]; 
                Pinverse = inv(Plant(cc).tfm); % Eq.(8.164) 

512
Appendix 8
                Pinv(cc).tfm(1,1) = minreal(Pinverse(1,1));
                Pinv(cc).tfm(1,2) = minreal(Pinverse(1,2));
                Pinv(cc).tfm(2,1) = minreal(Pinverse(2,1));
                Pinv(cc).tfm(2,2) = minreal(Pinverse(2,2));
              end
            end
          end
        end
      end
    end
  end
end
numPlants = cc;
for ii=1:numPlants
  q11(1,1,ii) = 1/Pinv(ii).tfm(1,1); % Eq.(8.166)
end
save q11 q11; % for QFTCT, design of g11_med1(s) and f11_med1(s)
g11_med1 = tf(20*conv([1/0.12 1],[1/0.24 1]),…
              [1/0.014 1 0]); % Eq.(8.167)
f11_med1 = tf(1,[1/1.5 1]);   % Eq.(8.168)
% --- for g21_med1(s)
g21_med1 = tf(0); % Eq.(8.169)
% --- for QFTCT, design of g22_med1(s) and f22_med1(s)
cc = 0;
for i1=1:n1
  for i2=1:n2
    for i3=1:n3
      for i4=1:n4
        for i5=1:n5
          for i6=1:n6
            for i7=1:n7
              for i8=1:n8
                cc = cc + 1;
                gg = Pinv(cc).tfm(2,2) - ((Pinv(cc).tfm(2,1) + …
                     g21_med1) * Pinv(cc).tfm(1,2) / …
                     (Pinv(cc).tfm(1,1) + g11_med1));
                p22_ast_eq2(cc) = minreal(gg,0.01); % Eq.(8.170)
              end
            end
          end
        end
      end
    end
  end
end
numPlants = cc;
for ii=1:numPlants
  q22(1,1,ii) = 1/p22_ast_eq2(ii); % Eq.(8.171)
end
save q22 q22; % for QFTCT, design of g22_med1(s) and f22_med1(s)

513
Appendix 8
g22_med1 = tf(30*[1/0.6 1],[1/300 1 0]);; % Eq.(8.172)
f22_med1 = tf(1,[1/0.75 1]); % Eq.(8.173)
% --- for g12_med1(s)
figure; hold on;
for jj=1:10:numPlants
  kkk2(jj) = g22_med1 * Pinv(jj).tfm(1,2) / Pinv(jj).tfm(2,2);
  bode(kkk2(jj)); % Fig.8.28
end
grid;
g12_med1 = g22_med1 * Pninv(1,2) / Pninv(2,2);
g12_med1 = minreal(g12_med1,0.01);
g12_med1 = tf(-40*[1/0.833 1],[1/300 1 0]); Eq.(8.174)
bode(g12_med1); % Fig.8.28
% (3) Step C
% ----------
% --- Closed loop MIMO system
Gmed1 = [g11_med1, g12_med1; g21_med1, g22_med1];
Gmed1.InputName = {’e’};
Gmed1.OutputName = {’u’};
% Fmed1 = [1, 0; 0, 1]; % for Fig.8.29
Fmed1 = [f11_med1, 0; 0, f22_med1]; % for Fig.8.30
Sum = sumblk(’e = r - y’,2);
CLry = connect(Pn,Gmed1,Sum,’r’,’y’)*Fmed1; % Closed loop MIMO syst
% --- Simulation closed loop MIMO system
tinc = 0.01;
tt = [0:tinc:300];
nn = length(tt);
U1 = [[0:tinc:20]*0,1+[20+tinc:tinc:300]*0]; % input 1
U2 = [[0:tinc:170]*0,1+[170+tinc:tinc:300]*0]; % input 2
figure,lsim(CLry,[U1;U2],tt); % Fig.8.29 and Fig.8.30
% Example 8.1. Section 8-9 (MIMO QFT Method 2)
% =============================================
% Heat exchanger example.
% (1) Step A
% ----------
% --- RGA. According to nominal plant. 
p11 = tf(7,[1/0.25 1]);
p12 = tf(9,[1/0.2 1]);
p21 = tf(3,[1/0.125 1]);
p22 = tf(5,[1/0.5 1]);
Pn = [p11, p12 ; p21 , p22]; 
P0 = dcgain(Pn);
rga = P0 .* inv(P0)’; % Eq.(8.5) and Eq.(8.163)
% (2) Step B. --- Ga

514
Appendix 8
% ------------------
% --- Inverse plant "P(s)*" with uncertainty
% grid for uncertainty
n1 = 2; n2 = 2; n3 = 2; n4 = 2; 
n5 = 2; n6 = 2; n7 = 2; n8 = 2; 
% parameters
k11v = linspace(6.3,7.7,n1); % parameters, see Eq. (8.4)
k12v = linspace(8.9,9.1,n2);
k21v = linspace(2.9,3.1,n3);
k22v = linspace(4.5,5.5,n4);
tau11v = linspace(3.6,4.4,n5);
tau12v = linspace(4.9,5.1,n6);
tau21v = linspace(7.9,8.1,n7);
tau22v = linspace(1.8,2.2,n8);
cc = 0;
% --- for g11a, g12a(s), g21a(s), g22a(s)
for i1=1:n1
  k11 = k11v(i1);
  for i2=1:n2
    k12 = k12v(i2);
    for i3=1:n3
      k21 = k21v(i3);
      for i4=1:n4
        k22 = k22v(i4);
        for i5=1:n5
          tau11 = tau11v(i5);
          for i6=1:n6
            tau12 = tau12v(i6);
            for i7=1:n7
              tau21 = tau21v(i7);
              for i8=1:n8
                cc = cc + 1;
                tau22 = tau22v(i8);
                p11 = tf(k11,[tau11 1]); % from Eq.(8.4)
                p12 = tf(k12,[tau12 1]); % from Eq.(8.4)
                p21 = tf(k21,[tau21 1]); % from Eq.(8.4)
                p22 = tf(k22,[tau22 1]); % from Eq.(8.4)
                Plant(cc).tfm = [p11, p12 ; p21 , p22]; 
                Pdiag(cc).tfm = [p11, 0 ; 0 , p22];
                Pinverse = inv(Plant(cc).tfm);  
                Pinv(cc).tfm(1,1) = minreal(Pinverse(1,1));
                Pinv(cc).tfm(1,2) = minreal(Pinverse(1,2));
                Pinv(cc).tfm(2,1) = minreal(Pinverse(2,1));
                Pinv(cc).tfm(2,2) = minreal(Pinverse(2,2));
                pp = Pinv(cc).tfm * Pdiag(cc).tfm; % Eq.(8.176)
                PinvPdiag(cc).tfm(1,1) = minreal(pp(1,1),0.01);
                k_PinvPdiag(cc).tfm(1,1) = …
                  dcgain(PinvPdiag(cc).tfm(1,1));
                PinvPdiag(cc).tfm(1,2) = minreal(pp(1,2),0.01);
                k_PinvPdiag(cc).tfm(1,2) = …
                  dcgain(PinvPdiag(cc).tfm(1,2));

515
Appendix 8
                PinvPdiag(cc).tfm(2,1) = minreal(pp(2,1),0.01);
                k_PinvPdiag(cc).tfm(2,1) = …
                  dcgain(PinvPdiag(cc).tfm(2,1));
                PinvPdiag(cc).tfm(2,2) = minreal(pp(2,2),0.01);
                k_PinvPdiag(cc).tfm(2,2) = …
                  dcgain(PinvPdiag(cc).tfm(2,2));
              end
            end
          end
        end
      end
    end
  end
end
numPlants = cc; 
kvector11 = [];kvector12 = [];kvector21 = [];kvector22 = [];
for jj=1:numPlants
  kvector11 = [kvector11 k_PinvPdiag(jj).tfm(1,1)];
  kvector12 = [kvector12 k_PinvPdiag(jj).tfm(1,2)];
  kvector21 = [kvector21 k_PinvPdiag(jj).tfm(2,1)];
  kvector22 = [kvector22 k_PinvPdiag(jj).tfm(2,2)];
end
kmean11 = mean(kvector11);
kmean12 = mean(kvector12);
kmean21 = mean(kvector21);
kmean22 = mean(kvector22);
e11 = inf; e12 = inf; e21 = inf; e22 = inf;
for jj=1:numPlants
  ne11 = abs((kmean11 - k_PinvPdiag(jj).tfm(1,1)));
  if ne11<=e11;
    nPinvPdiag11 = jj;
    e11 = ne11;
  end
end
g11a = minreal(PinvPdiag(nPinvPdiag11).tfm(1,1),0.1); 
g11a = tf([1.24 0.16],[1 0.01]); % Eq.(8.177)
figure; hold on;
for jj=1:10:numPlants
  bode(PinvPdiag(jj).tfm(1,1)); % Fig.8.33
end
bode(g11a,’b--’,g11a,’b*’); % Fig.8.33
title(’PinvPdiag(1:end).tfm(1,1) and g11-alpha’);
for jj=1:numPlants
  ne12 = abs((kmean12 - k_PinvPdiag(jj).tfm(1,2)));
  if ne12<=e12;
    nPinvPdiag12 = jj;
    e12 = ne12;
  end
end
g12a = minreal(PinvPdiag(nPinvPdiag12).tfm(1,2),0.1); 

516
Appendix 8
g12a = tf(-[1.53 0.19],[1 0.01]); % Eq.(8.178)
figure; hold on;
for jj=1:10:numPlants
  bode(PinvPdiag(jj).tfm(1,2)); % Fig.8.34
end
bode(g12a,’b--’,g12a,’b*’); % Fig.8.34
title(‘PinvPdiag(1:end).tfm(1,2) and g12-alpha’);
for jj=1:numPlants
  ne21 = abs((kmean21 - k_PinvPdiag(jj).tfm(2,1)));
  if ne21<=e21;
    nPinvPdiag21 = jj;
    e21 = ne21;
  end
end
g21a = minreal(PinvPdiag(nPinvPdiag21).tfm(2,1),0.1); 
g21a = tf(-[0.18 0.1],[1 0.01]); % Eq.(8.179)
figure; hold on;
for jj=1:10:numPlants
  bode(PinvPdiag(jj).tfm(2,1)); % Fig.8.35
end
bode(g21a,’b--’,g21a,’b*’); % Fig.8.35
title(‘PinvPdiag(1:end).tfm(2,1) and g21-alpha’);
for jj=1:numPlants
  ne22 = abs((kmean22 - k_PinvPdiag(jj).tfm(2,2)));
  if ne22<=e22;
    nPinvPdiag22 = jj;
    e22 = ne22;
  end
end
g22a = minreal(PinvPdiag(nPinvPdiag22).tfm(2,2),0.1); 
g22a = tf([1.24 0.16],[1 0.01]); % Eq.(8.180)
figure; hold on;
for jj=1:10:numPlants
  bode(PinvPdiag(jj).tfm(2,2)); % Fig.8.36
end
bode(g22a,’b--’,g22a,’b*’); % Fig.8.36
title(‘PinvPdiag(1:end).tfm(2,2) and g22-alpha’);
% (3) Step C
% ----------
% for QFTCT, design of g11b(s) and f11(s)
Ga = [g11a g12a; g21a g22a];
for jj=1:numPlants
  Px(jj).tfm = minreal(Plant(jj).tfm * Ga); 
  Pxinv(jj).tfm = inv(Px(jj).tfm); % Eq.(8.181)
end

517
Appendix 8
for ii=1:numPlants
  qx11(1,1,ii) = 1/Pxinv(ii).tfm(1,1); % Eq.(8.182)
end
save qx11 qx11; % for QFTCT, design of g11_med2(s) and f11_med2(s)
g11b = tf(0.9*[1/0.24 1],[1/40 1 0]); % Eq.(8.183)
f11 = tf([1/20 1],[1/2 1]); % Eq.(8.184)
% for QFTCT, design of g22b(s) and f22(s)
cc = 0;
for i1=1:n1
  for i2=1:n2
    for i3=1:n3
      for i4=1:n4
        for i5=1:n5
          for i6=1:n6
            for i7=1:n7
              for i8=1:n8
                cc = cc + 1;
                gg = Pxinv(cc).tfm(2,2) - …
                     ((Pxinv(cc).tfm(2,1) * Pxinv(cc).tfm(1,2)) / …
                     (Pxinv(cc).tfm(1,1) + g11b));
                px22_ast_eq2(cc) = minreal(gg,0.01); % Eq.(8.185)
              end
            end
          end
        end
      end
    end
  end
end
numPlants = cc;
for ii=1:numPlants
  qx22(1,1,ii) = 1/px22_ast_eq2(ii); % Eq.(8.186)
end
save qx22 qx22; % for QFTCT, design of g22a(s) and f11(s)
g22b = tf(0.4*[1/0.1 1],[1/40 1 0]); % Eq.(8.187)
f22 = tf([1/20 1],[1/2 1]); % Eq.(8.188)
% (4) Step D
% ----------
% --- Closed loop MIMO system
Gb = [g11b 0; 0 g22b];
Gmed2 = Ga * Gb;
Gmed2.InputName = {‘e’};
Gmed2.OutputName = {‘u’};
%Fmed21 = [1, 0; 0, 1]; % for Fig.8.43
Fmed2 = [f11, 0; 0, f22]; % for Fig.8.44
Sum = sumblk(‘e = r - y’,2);

518
Appendix 8
CLry = connect(Pn,Gmed2,Sum,’r’,’y’)*Fmed2; % Closed loop MIMO syst
% --- Simulation closed loop MIMO system
tinc = 0.01;
tt = [0:tinc:300];
nn = length(tt);
U1 = [[0:tinc:20]*0,1+[20+tinc:tinc:300]*0]; % input 1
U2 = [[0:tinc:170]*0,1+[170+tinc:tinc:300]*0]; % input 2
figure,lsim(CLry,[U1;U2],tt); % Fig.8.43 and Fig.8.44
% ---------------------------------------------

519
Appendix 9: Conversion of Units
Unit
Symbol
Conversion
International System 
of units (Metric 
system)
Meter
m
1 m = 3.2808 ft
Meter
m
1 m = 39.37 in
Meter
m
1 m = 1.0936 yd
Square meter
m2
1 m2 = 10.7639 ft2
Square meter
m2
1 m2 = 2.4710 × 10−4 ac
Square kilometer
km2
1 km2 = 0.3861 mi2
Cubic meter
m3
1 m3 = 35.3145 ft3
Cubic meter
m3
1 m3 = 264.17 gal
Meter/second
m s−1
1 m s−1 = 3.2808 ft s−1
Meter/second
m s−1
1 m s−1 = 2.2369 mi h−1
Kilometer/hour
km h−1
1 km h−1 = 0.6214 mi h−1
Kilogram
kg
1 kg = 2.2046 lb
Celsius degree
°C
T(°C) = 5/9[T(°F) − 32]
Watt
W
1 W = 1.3405 × 10−3 HP
American System of 
units (US)
Foot
ft
1 ft = 0.3048 m
Inch
in
1 in = 2.54 × 10−2 m
Yard
yd
1 yd = 0.9144 m
Square foot
sq. ft (ft2)
1 ft2 = 9.2903 × 10−2 m2
Acre
ac
1 ac = 4.0469 × 103 m2
Square mile
sq. mi (mi2)
1 mi2 = 2.59 km2
Cubic foot
cu. ft (ft3)
1 ft3 = 2.8317 × 10−2 m3
Gallon
gal
1 gal = 3.7854 × 10−3 m3
Foot/second
ft s−1
1 ft s−1 = 0.3048 m s−1
Mile/hour
mph (mi h−1)
1 mi h−1 = 1.6093 km h−1
Mile/hour
mph (mi h−1)
1 mi h−1 = 0.4470 m s−1
Pound
lb
1 lb = 0.4536 kg
Fahrenheit degree
°F
T(°F) = (9/5)T(°C) + 32
Horsepower
HP
1 HP = 746 W
Energy
Joule
J
1 J = 2.7778 × 10−7 kWh
Kilowatt-hour
kWh
1 kWh = 3.6 × 106 J
Angle
Radian
rad
1 rad = (180/π)°
Degree
°
1° = (π/180) rad
Frequency
Hertz
Hz
1 Hz = 60 rpm
Revolution/minute
rpm
1 rpm = (1/60) Hz
Radian/second
rad/s
1 rad/s = 9.5493 rpm
Revolution/minute
rpm
1 rpm = 0.1047 rad/s


521
References
This section compiles the main references used along the book as well as fundamental 
bibliography. It is arranged according to subject, and chronologically within each subject.
Books Related to QFT and Frequency-Domain Methods
	
1.	 Bode, H.W. 1945. Network Analysis and Feedback Amplifier Design. Van Nostrand Company, 
Princeton, NY.
	
2.	 Horowitz, I. 1963. Synthesis of Feedback Systems. Academic Press, New York, NY.
	
3.	 Horowitz, I. 1993. Quantitative Feedback Design Theory (QFT). QFT Publishers, Denver, CO.
	
4.	 Yaniv, O. 1999. Quantitative Feedback Design of Linear and Non-linear Control Systems. Kluwer 
Academic Publisher, Norwell, MA.
	
5.	 Sidi, M. 2002. Design of Robust Control Systems: From Classical to Modern Practical Approaches. 
Krieger Publishing, Malabar, FL.
	
6.	 Houpis, C.H., Rasmussen S.J., and Garcia-Sanz, M. 2006. Quantitative Feedback Theory: Fundamentals 
and Applications. 2nd Edition, A CRC Press book, Taylor & Francis Group, Boca Raton, FL.
	
7.	 Garcia-Sanz, M. and Houpis, C.H. 2012. Wind Energy Systems: Control Engineering Design (Part 
I: QFT Control, Part II: Wind Turbine Design and Control). A CRC Press book, Taylor & Francis 
Group, Boca Raton, FL.
Special Issues about QFT
	
8.	 Nwokah, O.D.I. (Guest Editor), 1994. Horowitz and QFT design methods special issue. Int. J. 
Robust Nonlinear Control, 4(1), 1–230.
	
9.	 Houpis, C.H. (Guest Editor), 1997. Quantitative feedback theory special issue. Int. J. Robust 
Nonlinear Control, 7(6), 513–674.
	 10.	 Eitelberg, E. (Guest Editor), 2001–2002. Isaac Horowitz special issue. Int. J. Robust Nonlinear 
Control, Part 1, 11(10), 883–999; Part 2, 12(4), 287–402.
	 11.	 Garcia-Sanz, M. (Guest Editor), 2003. Robust frequency domain special issue. Int. J. Robust 
Nonlinear Control, 13(7), 595–688.
	 12.	 Garcia-Sanz, M. and Houpis, C.H. (Guest Editors), 2007. Quantitative feedback theory: In 
memoriam of Isaac Horowitz, special issue. Int. J. Robust Nonlinear Control, 17(2–3), 91–264.
International QFT Symposia
	 13.	 Houpis, C.H. and Chander, P. (Editors), 1992. 1st International Symposium on QFT and Robust 
Frequency Domain Methods. Writght Patterson Airforce Base, Dayton, OH.
	 14.	 Nwokah, O.D.I. and Chander, P. (Editors), 1995. 2nd International Symposium on QFT and Robust 
Frequency Domain Methods. Purdue University, West Lafayette, IN.

522
References
	 15.	 Petropoulakis, L. and Leithead, W.E. (Editors), 1997. 3rd International Symposium on QFT and 
Robust Frequency Domain Methods. University of Strathclyde, Glasgow, Scotland, UK.
	 16.	 Boje, E. and Eitelberg, E. (Editors), 1999. 4th International Symposium on QFT and Robust Frequency 
Domain Methods. University of Natal, Durban, South Africa.
	 17.	 Garcia-Sanz, M. (Editor), 2001. 5th International Symposium on QFT and Robust Frequency Domain 
Methods. Public University of Navarra, Pamplona, Spain.
	 18.	 Boje, E. and Eitelberg, E. (Editors), 2003. 6th International Symposium on QFT and Robust Frequency 
Domain Methods. University of Cape Town, Cape Town, South Africa.
	 19.	 Colgren, R. (Editor), 2005. 7th International Symposium on Quantitative Feedback Theory and Robust 
Frequency Domain Methods. University Kansas, Lawrence, KS.
	 20.	 Gutman, P-O. (Editor), 2007. 8th International Symposium on Quantitative Feedback Theory and 
Robust Frequency Domain Methods. Weizmann Institute of Science, Rehovot, Israel.
	 21.	  From 2009 on, the International Symposium on Quantitative Feedback Theory and Robust Frequency 
Domain Methods merged the IFAC Symposium on Robust Control Design. The 9th QFT International 
Symposium merged the 6th ROCOND, June 2009, Haifa, Israel.
Tutorials about QFT
	 22.	 Horowitz, I. 1982. Quantitative feedback theory. IEE Control Theory Appl., 129(6), 215–226.
	 23.	 Horowitz, I. 1991. Survey of quantitative feedback theory. Int. J. Control, 53(2), 255–291.
	 24.	 Houpis, C.H. 1996. Quantitative feedback theory (QFT) technique. In The Control Handbook. 
(Editor W.S. Levine), Chapter 44, CRC Press, Boca Raton, FL, pp. 701–717.
	 25.	 Garcia-Sanz, M. 2005. Control Robusto Cuantitativo: Historia de una Idea, (in Spanish). Rev. 
Iberoam Autom., 2(3), 25–38.
	 26.	 Garcia-Sanz, M. 2015. Quantitative feedback theory. In Encyclopedia of Systems and Control. (Editors 
T. Samad, J. Baillieul). Springer Verlag, Berlin, Germany. Article ID: 366609, Chapter ID: 238.
About the QFT History
	 27.	 Horowitz, I.M. 1992. QFT—Past, present and future. Plenary address. 1st International 
Symposium on QFT & Robust Frequency Domain Methods, Dayton, OH, pp. 9–14.
	 28.	 Horowitz, I.M. 1999. Frequency response in control. Plenary. 4th International Symposium on 
QFT and Robust Frequency Domain Methods, Durban, South Africa, pp. 233–239.
	 29.	 Garcia-Sanz, M. 2001. QFT international symposia: Past, present and future. Editorial of 5th 
International Symposium on QFT and Robust Frequency Domain Methods, Pamplona, Spain, pp. ix–xii.
	 30.	 Horowitz, I.M. 2002. It was not easy: A personal view. Int. J. Robust Nonlinear Control, 12(4), 
289–293.
	 31.	 Houpis, C.H. 2002. Horowitz: Bridging the gap. Int. J. Robust Nonlinear Control, 12(4), 293–302.
First QFT Papers
	 32.	 Horowitz, I.M. 1959. Fundamental theory of automatic linear feedback control systems. I.R.E. 
Trans. Autom. Control, 4, 5–19.

523
References
	 33.	 Horowitz, I.M. and Sidi, M. 1972. Synthesis of feedback systems with large plant ignorance for 
prescribed time-domain tolerances. Int. J. Control, 16(2), 287–309.
	 34.	 Horowitz, I.M. 1973. Optimum loop transfer function in single-loop minimum-phase feedback 
systems. Int. J. Control, 18(1), 97–113.
QFT Templates
	 35.	 Bailey, F.N. and Hui, C.H. 1989. A fast algorithm for computing parametric rational functions. 
IEEE Trans Autom. Control, 34(11), 1209–1212.
	 36.	 Gutman, P.O., Baril, C., and Neumann, L. 1990. An image processing approach for computing 
value sets of uncertain transfer functions. Proceedings of the 29th IEEE Conference on Decision and 
Control, Honolulu, Hawaii, CA, pp. 1209–1212.
	 37.	 Bartlett, A.C. 1993. Computation of the frequency response of systems with uncertain param­
eters: A simplification. Int. J. Control, 57(6), 1293–1309.
	 38.	 Bartlett, A.C., Tesi, A., and Vicino, A. 1993. Frequency response of uncertain systems with 
interval plants. IEEE Trans. Autom. Control, 38(6), 929–933.
	 39.	 Gutman, P.O., Baril, C., and Neuman, L. 1994. An algorithm for computing value sets of uncer­
tain transfer functions in factored real form. IEEE Trans. Autom. Control, 39(6), 1268–1273.
	 40.	 Cohen, B., Nordin, M., and Gutman, P. 1995. Recursive grid methods to compute value sets for 
transfer functions with parametric uncertainty. Proceedings of the American Control Conference, 
Seattle, pp. 3861–3865.
	 41.	 Ballance, D.J. and Hughes, G. 1996. A survey of template generation methods for quantitative 
feedback theory. UKACC International Conference on Control ’96, Exeter, UK, pp. 172–174.
	 42.	 Sardar, G. and Nataraj, P.S.V. 1997. A template generation algorithm for non-rational transfer 
functions in QFT designs. Proceedings of the 36th Conference on Decision and Control, San Diego, 
USA, pp. 2684–2689.
	 43.	 Lasky, T.A. and Ravani, B. 1997. Use of convex hulls for plant template approximation in QFT 
design. ASME J. Dyn. Syst. Meas. Control, 119(3), 598–600.
	 44.	 Ballance, D.J. and Chen, W. 1998. Symbolic computation in value sets of plants with uncertain 
parameters. UKACC International Conference on Control ’98, Exeter, UK, pp. 1322–1327.
	 45.	 Chen, W. and Balance, D.J. 1999. Plant template generation for uncertain plants in QFT. ASME 
J. Dyn. Syst. Meas. Control, 121(3), 358–364.
	 46.	 Garcia-Sanz, M. and Vital, P. 1999. Efficient computation of the frequency representation of 
uncertain systems. 4th International Symposium on QFT and Robust Frequency Domain Methods, 
Durban, South Africa, pp. 117–126.
	 47.	 Nataraj, P.S.V. and Sardar, G. 2000. Template generation for continuous transfer functions 
using interval analysis. Automatica, 36, 111–119.
	 48.	 Boje, E. 2000, Finding non-convex hulls of QFT templates. Trans. ASME, 122, 230–232.
	 49.	 Nataraj, P.S.V. and Sheela, S. 2002. Template generation algorithm using vectorized function 
evaluations and adaptive subdivisions. ASME J. Dyn. Syst. Meas. Control, 124(4), 585–588.
	 50.	 Hwang, C. and Yang, S. 2002. QFT template generation for time-delay plants based on zero-
inclusion test. Syst. Control Lett., 45, 179–191.
	 51.	 Martin, J.J., Gil-Martinez, M., and Garcia-Sanz, M. 2007. Analytical formulation to compute 
QFT templates for plants with a high number of uncertain parameters. 15th Mediterranean 
Conference on Control and Automation, MED’07, Athens, Greece, doi: 10.1109/MED.2007.4433934.
	 52.	 Diaz, J.M., Dormido, S., and Aranda, J. 2008. An interactive approach to template generation in 
QFT methodology. Asian J. Control, 10(3), 361–367.
	 53.	 Yang, S. 2009. An improvement of QFT plant template generation for systems with affinely 
dependent parametric uncertainties. J. Franklin Inst., 346(7), 663–675.

524
References
QFT Bounds
	 54.	 Longdon, L. and East, D.J. 1978. A simple geometrical technique for determining loop fre­
quency bounds which achieve prescribed sensitivity specifications. Int. J. Control, 30(1), 
153–158.
	 55.	 Bailey, F.N., Panzer, D., and Gu, G. 1988. Two algorithms for frequency domain design of robust 
control systems. Int. J. Control, 48(5), 1787–1806.
	 56.	 Brown, M. and Petersen, I.R. 1991. Exact computation of the Horowitz bound for interval 
plants. Proceedings of the 30th IEEE Conference on Decision and Control, Brighton, England, pp. 
2268–2273.
	 57.	 Nwokah, O.D.I., Jayasuriya, S., and Chait, Y. 1991. Parametric robust control by quantitative 
feedback theory. American Control Conference, Boston, MA, pp. 1975–1980.
	 58.	Wang, G.G., Chen, C.W., and Wang, S.H. 1991. Equations for loop bound in quantitative 
feedback theory. Proceedings of the 30th Conference on Decision and Control, Brighton, pp. 
2968–2969.
	 59.	 Fialho, I.J., Pande, V., and Nataraj, P.S.V. 1992. Design of feedback systems using Kharitonov’s 
segments in quantitative feedback theory. Proceedings of the 1st QFT Symposium, Dayton, OH, 
pp. 457–470.
	 60.	 Chait, Y. and Yaniv, O. 1993. Multi-input/single-output computer-aided control design using 
the quantitative feedback theory. Int. J. Robust Nonlinear Control, 3(3), 47–54.
	 61.	 Zhao, Y. and Jayasuriya, S. 1994. On the generation of QFT bounds for general interval plants. 
Trans. ASME, 116, 618–627.
	 62.	 Chait, Y., Borghesani, C., and Zheng, Y. 1995. Single-loop QFT design for robust performance in 
the presence of non-parametric uncertainties. ASME J. Dyn. Syst. Meas. Control, 117(3), 420–425.
	 63.	 Moreno, J.C., Baños, A., and Montoya, J.F. 1997. An algorithm for computing QFT múltiple-
valued performance bounds. International Symposium on QFT and Robust Frequency Domain 
Methods, Scotland, pp. 29–34.
	 64.	 Rodrigues, J.M., Chait, Y., and Hollot, C.V. 1997. An efficient algorithm for computing QFT 
bounds. Trans. ASME, 119, 548–552.
	 65.	 Eitelberg, E. 2000. Quantitative feedback design for tracking error tolerance. Automatica, 36, 
319–326.
	 66.	 Nataraj, P. and Sardar, G. 2000. Template generation for continuous transfer functions using 
interval analysis. Automatica, 36(1), 111–119.
	 67.	 Nataraj, P. and Sardar, G. 2000. Computation of QFT bounds for robust sensitivity and gain-
phase margin specifications. Trans. ASME, 122, 528–534.
	 68.	 Nataraj, P. 2002. Computation of QFT bounds for robust tracking specifications. Automatica, 
38(2), 327–334.
	 69.	 Nataraj, P. 2002. Interval QFT: A mathematical and computational enhancement of QFT. Int. J. 
Robust Nonlinear Control, 12(4), 385–402.
	 70.	 Boje, E. 2003. Pre-filter design for tracking error specifications in QFT. Int. J. Robust Nonlinear 
Control, 13, 637–642.
	 71.	 Moreno, J.C., Baños, A., and Berenguel, M. 2006. Improvements on the computation of bound­
aries in QFT. Int. J. Robust Nonlinear Control, 16, 575–597.
	 72.	 Gutman, P.-O., Nordin, M., and Cohen, B. 2007. Recursive grid methods to compute value sets 
and Horowitz-Sidi bounds. Int. J. Robust Nonlinear Control, 17, 155–171.
	 73.	 Martin-Romero, J.J., Gil-Martinez, M., and Garcia-Sanz, M. 2009. Analytical formulation to 
compute QFT bounds: The envelope method. Int. J. Robust Nonlinear Control, 19(17), 1959–1971.
	 74.	 Yang, S.F. 2011. Generation of QFT bounds for robust tracking specifications for plants with 
affinely dependent uncertainties. Int. J. Robust Nonlinear Control, 21(3), 237–247.
	 75.	 Elso, J., Gil-Martinez, M., and Garcia-Sanz, M. 2012. Non-conservative QFT bounds for track­
ing error specifications. Int. J. Robust Nonlinear Control, 22, 2014–2025.

525
References
QFT Loop-Shaping. Controller Synthesis
	 76.	 Gera, A. and Horowitz, I.M. 1980. Optimization of the loop transfer function. Int. J. Control, 
31(2), 389–398.
	 77.	 Thompson, D.F. and Nwokah, O.D.I. 1989. Stability and optimal design in quantitative feed­
back theory. Proceedings of the ASME Winter Annual Meeting Conference, San Francisco, CA, 
ASME Paper No. 89-WA/DSC-39.
	 78.	 Thompson, D.F. and Nwokah, O.D.I. 1994. Analytic loop shaping methods in quantitative feed­
back theory. ASME J. Dyn. Syst. Meas. Control, 116(2), 169–177.
	 79.	 Chait, Y., Chen, Q., and Hollot, C.V. 1997. Automatic loop-shaping of QFT controllers via linear 
programming. 3rd International Symposium on QFT and Other Robust Frequency Domain Methods, 
Glasgow, UK, pp. 13–28.
	 80.	 Chait, Y., Chen, Q., and Hollot, C.V. 1999. Automatic loop-shaping of QFT controllers via linear 
programming. ASME J. Dyn. Syst. Meas. Control, 121(3), 351–357.
	 81.	 Garcia-Sanz, M. and Guillen, J.C. 2000. Automatic loop-shaping of QFT robust controllers via 
genetic algorithms. 3rd IFAC Symposium on Robust Control Design, Praha.
	 82.	 Khaki-Sedigh, A. and Lucas, C. 2000. Optimal design of robust quantitative feedback control­
lers using random optimization techniques. Int. J. Syst. Sci., 31(8), 1043–1052.
	 83.	 Lee, J.W., Chait, Y., and Steinbuch, M. 2000. On QFT tuning of multivariable µ controllers. 
Automatica, 36(11), 1701–1708.
	 84.	 Sidi, M.J. 2002. A combined QFT/Hinfinity design technique for TDOF uncertain feedback 
systems. Int. J. Control, 75(7), 475–489.
	 85.	 Garcia-Sanz, M., Brugarolas, M.J., and Eguinoa, I. 2004. Quantitative analysis of controller fra­
gility in the frequency domain. 23rd IASTED International Symposium. Modelling, Identification 
and Control, Grindelwald, Switzerland.
	 86.	 Garcia-Sanz, M. and Oses, J.A. 2004. Evolutionary algorithms for automatic tuning of QFT 
controllers. 23th IASTED International Symposium on Modelling, Identification and Control, 
Grindelwald, Switzerland.
	 87.	 Molins, C. and Garcia-Sanz, M. 2009. Automatic loop-shaping of QFT robust controllers. 61st 
National Aerospace & Electronics Conference, NAECON, July 2009, Dayton, OH, doi: 10.1109/
NAECON.2009.5426643.
	 88.	 Garcia-Sanz, M. and Molins, C. 2010. Automatic loop-shaping of QFT robust controllers with 
multi-objective specifications via nonlinear quadratic inequalities. 62nd National Aerospace & 
Electronics Conference, NAECON, July 2010, Dayton, OH, doi: 10.1109/NAECON.2010.5712975.
Existence Conditions for QFT Controllers
	 89.	 Nwokah, O.D.I., Thompson, D.F., and Perez, R.A. 1990. On some existence conditions for QFT 
controllers. DSC, 24, 1–10.
	 90.	 Jayasuriya, S. and Zhao, Y. 1994. Stability of quantitative feedback designs and the existence of 
robust QFT controllers. Int. J. Robust Nonlinear Control, 4(1), 21–46.
	 91.	 Gil-Martinez, M. and Garcia-Sanz, M. 2003. Simultaneous meeting of robust control specifica­
tions in QFT. Int. J. Robust Nonlinear Control, 13(7), 643–656.
MIMO QFT
	 92.	 Horowitz, I.M. 1979. Quantitative synthesis of uncertain multiple input-output feedback sys­
tems. Int. J. Control, 30(1), 81–106.

526
References
	 93.	 Horowitz, I.M. and Sidi, M. 1980. Practical design of feedback systems with uncertain multi­
variable plants. Int. J. Control, 11(7), 851–875.
	 94.	 Horowitz, I.M. and Loecher, C. 1981. Design 3 × 3 multivariable feedback system with large 
plant uncertainty. Int. J. Control, 33, 677–699.
	 95.	 Horowitz, I.M., Neumann, L., and Yaniv, O. 1981. A synthesis technique for highly uncer­
tain interacting multivariable flight control system (TYF16CCV). Proceedings on NAECON 
Conference, Dayton, OH, pp. 1276–1283.
	 96.	 Horowitz, I.M. 1982. Improved design technique for uncertain multiple input-output feedback 
systems. Int. J. Control, 36, 977–988.
	 97.	 Nwokah, O.D.I. 1984. Synthesis of controllers for uncertain multivariable plants for described 
time domain tolerances. Int. J. Control, 40, 1189–1206.
	 98.	 Yaniv, O. and Horowitz, I.M. 1986. A quantitative design method for MIMO linear feedback 
systems having uncertain plants. Int. J. Control, 43(2), 401–421.
	 99.	 Nwokah, O.D.I. 1988. Strong robustness in uncertain multivariable systems. IEEE Conference on 
Decision and Control, Austin, TX, doi: 10.1109/CDC.1988.194715.
	100.	 Park, M.S., Chait, Y., and Steinbuch, M. 1994. A new approach to multivariable quantitative 
feedback theory: Theoretical and experimental results. 1994 American Control Conference: ACC 
’94, Baltimore, MD, doi: 10.1109/ACC.1994.751755.
	101.	 Franchek, M.A. and Nwokah, O.D.I. 1995. Robust multivariable control of distillation columns 
using non-diagonal controller matrix. DSC-Vol. 57-1, IMECE, ASME Dynamics Systems and 
Control Division, San Francisco, CA, pp. 257–264.
	102.	 Yaniv, O. 1995. MIMO QFT using non-diagonal controllers. Int. J. Control, 61(1), 245–253.
	103.	 Zhao, Y. and Jayasuriya, S. 1996. A new formulation of multiple-input multiple-output quanti­
tative feedback theory. ASME J. Dyn. Syst. Meas. Control, 118(4), 748–752.
	104.	 Franchek, M.A., Herman, P., and Nwokah, O.D.I. 1997. Robust nondiagonal controller design 
for uncertain multivariable regulating systems. ASME J. Dyn. Syst. Meas. Control, 119, 80–85.
	105.	 Piedmonte, M.D., Meckl, P.H., Nwokah, O.D.I., and Franchek, M.A. 1998. Multivariable vibra­
tion control of a coupled flexible structure using QFT. Int. J.Control, 69(4), 475–498.
	106.	 Boje, E. and Nwokah, O.D.I. 2001. Quantitative feedback design using forward path decou­
pling. ASME J. Dyn. Syst. Meas. Control, 123(1), 129–132.
	107.	 Boje, E. 2002. Non-diagonal controllers in MIMO quantitative feedback design. Int. J. Robust 
Nonlinear Control, 12(4), 303–320.
	108.	 Boje, E. 2002. Multivariable quantitative feedback design for tracking error specifications. 
Automatica, 38, 131–138.
	109.	 De Bedout, J.M. and Franchek, M.A. 2002. Stability conditions for the sequential design of non-
diagonal mu1tivariable feedback controllers. Int. J. Control, 75(12), 910–922.
	110.	 Garcia-Sanz, M. and Egaña, I. 2002. Quantitative non-diagonal controller design for multivari­
able systems with uncertainty. Int. J. Robust Nonlinear Control, 12(4), 321–333.
	111.	 Eitelberg, E. 2003. On multivariable tracking. 6th International Symposium on Quantitative 
Feedback Theory, Cape Town, South Africa, Vol. 2, pp. 514–519.
	112.	 Kerr, M. and Jayasuriya, S. 2003. Sufficient conditions for robust stability in non-sequential 
MIMO QFT. 42nd IEEE International Conference on Decision and Control, Maui, HI, doi: 10.1109/
CDC.2003.1272876.
	113.	 Lan, C.Y., Kerr, M.L., and Jayasuriya, S. 2004. Synthesis of controllers for non-minimum phase 
and unstable systems using non-sequential MIMO quantitative feedback theory. 2004 American 
Control Conf. (ACC), Boston, MA.
	114.	 Garcia-Sanz, M., Egaña, I., and Barreras, M. 2005. Design of quantitative feedback theory 
non-diagonal controllers for use in uncertain MIMO systems. IEE Control Theory Appl., 152(2), 
177–187.
	115.	 Garcia-Sanz, M. and Eguinoa, I. 2005. Improved non-diagonal MIMO QFT design technique 
considering non-minimum phase aspects. 7th International Symposium on QFT and Robust 
Frequency Domain Methods, Lawrence, KS.

527
References
	116.	 Kerr, M.L., Jayasuriya, S., and Asokanthan, S.F. 2005. On stability in non-sequential MIMO 
QFT designs. ASME J. Dyn. Syst. Meas. Control, 127(1), 98–104.
	117.	 Kerr, M.L. and Jayasuriya, S. 2006. An improved non-sequential multi-input multi-output 
quantitative feedback theory design methodology. Int. J. Robust Nonlinear Control, 16(8), 
379–95.
	118.	 Mahdi Alavi, S.M., Khaki-Sedigh, A., Labibi, B., and Hayes, M.J. 2007. Improved multivariable 
feedback design for tracking error specifications. IET Control Theory Appl., 1, 1046–1053.
	119.	 Garcia-Sanz, M., Eguinoa, I., and Bennani, S. 2009. Non-diagonal MIMO QFT controller design 
reformulation. Int. J. Robust Nonlinear Control, 19(9), 1036–1064.
	120.	 Elso, J., Gil-Martinez, M., and Garcia-Sanz, M. 2014. A quantitative feedback solution to the 
multivariable tracking error problem. Int. J. Robust Nonlinear Control, 24(16), 2331–2346.
	121.	 Elso, J., Gil-Martinez, M., and Garcia-Sanz, M. 2017. Quantitative feedback control for mul­
tivariable model matching and disturbance rejection. Int. J. Robust Nonlinear Control, 27(1), 
121–134.
Time-Delay Systems. QFT Controller Design
	122.	 Garcia-Sanz, M. and Guillen, J.C. 1999. Smith Predictor for Uncertain Systems in the QFT 
Framework. Lecture Notes in Control and Information Sciences, Ed. Springer Verlag. vol. 243. 
Progress in System and Robot Analysis and Control Design. Chapter 20, pp. 243–250.
Unstable Systems and Non-Minimum Phase 
Systems. QFT Controller Design
	123.	 Chen, W. and Balance, D. 1998. QFT design for uncertain non-minimum phase and unstable 
plants. American Control Conference, vol. 4, Philadelphia, PA, pp. 2486–2490.
	124.	 Chen, W. and Balance, D. 2001. QFT design for uncertain non-minimum phase and unstable 
plants revisited. Int. J. Control, 74(9), 957–965.
	125.	 Garcia-Sanz, M. 2016. The Nyquist stability criterion in the Nichols chart. Int. J. Robust Nonlinear 
Control, 26(12), 2643–2651.
Digital QFT
	126.	 Horowitz, I.M. and Liao, Y. 1986. Quantitative feedback design for sampled-data systems. Int. 
J. Control, 44, 665–675.
	127.	 Yaniv, O. and Chait, Y. 1991. Direct robust control of uncertain sampled-data systems using the 
quantitative feedback theory. Proceedings of the ACC Conference, Boston, MA, pp. 1987–1988.
	128.	 Houpis, C.H. and Lamont, B.G. 1992. Digital Control Systems: Theory, Hardware, Software. 2nd 
Edition, McGraw Hill, New York, NY.
	129.	 Yaniv, O. and Chait, Y. 1993. Direct control design in sampled-data uncertain systems. 
Automatica, 29(2), 365–372.

528
References
Distributed Parameter Systems. QFT Controller Design
	130.	 Horowitz, I.M. and Azor, R. 1983. Quantitative synthesis of feedback systems with distributed 
uncertain plants. Int. J. Control, 38(2), 381–400.
	131.	 Horowitz, I.M. and Azor, R. 1984. Uncertain partially non-casual distributed feedback sys­
tems. Int. J. Control, 40(5), 989–1002.
	132.	 Chait, Y., Maccluer, C.R., and Radcliffe, C.J. 1989. A Nyquist stability criterion for distributed 
parameter systems. IEEE Trans. Autom. Control, 34(1), 90–92.
	133.	 Horowitz, I.M., Kannai, Y., and Kelemen, M. 1989. QFT approach to distributed systems con­
trol and applications. 1989 IEEE International Conference on Control and Applications, Jerusalem, 
Israel, pp. 516–519.
	134.	 Kelemen, M., Kanai, Y., and Horowitz, I.M. 1989. One-point feedback approach to distributed 
linear systems. Int. J. Control, 49(3), 969–980.
	135.	 Kelemen, M., Kanai, Y., and Horowitz, I.M. 1990. Improved method for designing linear dis­
tributed feedback systems. Int. J. Adapt. Control Signal Process., 4, 249–257.
	136.	 Hedge, M.D. and Nataraj, P.S.V. 1995. The two-point feedback approach to linear distributed 
systems. International Conference on Automatic Control, Indore, India, pp. 281–284.
	137.	 Garcia-Sanz, M., Huarte, A., and Asenjo, A. 2007. A quantitative robust control approach for 
distributed parameter systems. Int. J. Robust Nonlinear Control, 17(2–3), 135–153.
Feedforward and QFT Controller Design
	138.	 Elso, J., Gil-Martinez, M., and Garcia-Sanz, M. 2013. Quantitative feedback-feedforward con­
trol for model matching and disturbance rejection. IET Control Theory Appl., 7(6), 894–900.
Non-Minimum Phase Systems. QFT Controller Design
	139.	 Horowitz, I.M. and Sidi, M. 1978. Optimum synthesis of non-minimum phase systems with 
plant uncertainty. Int. J. Control, 27(3), 361–386.
	140.	 Horowitz, I.M. 1979. Design of feedback systems with non-minimum phase unstable plants. 
Int. J. Systems Sci., 10, 1025–1040.
	141.	 Horowitz, I.M. and Liao, Y. 1984. Limitations on non-minimum phase feedback systems. Int. J. 
Control, 40(5), 1003–1015.
	142.	 Horowitz, I.M. 1986. The singular-G method for unstable non-minimum phase plants. Int. J. 
Control, 44(2), 533–541.
	143.	 Horowitz, I.M., Oldak, S., and Yaniv, O. 1986. An important property of non-minimum phase 
multi-inputs multi-outputs feedback systems. Int. J. Control, 44(3), 677–688.
	144.	 Chen, W. and Ballance, D. 1998. QFT design for uncertain non-minimum phase and unstable 
plants. American Control Conference, Philadelphia, PA, pp. 2486–2490.
Multi-Loop Systems. QFT Controller Design
	145.	 Horowitz, I.M., Neumann, L., and Yaniv, O. 1985. Quantitative synthesis of uncertain cascade 
multi-input multi-output feedback systems. Int. J. Control, 42(2), 273–303.

529
References
	146.	 Horowitz, I.M. and Yaniv, O. 1985. Quantitative cascade MIMO synthesis by an improved 
method. Int. J. Control, 42(2), 305–331.
	147.	 Eitelberg, E. 1999. Load Sharing Control. NOYB Press, Durban, South Africa.
	148.	 Baños, A. and Horowitz, I.M. 2000. QFT design of multi-loop nonlinear control systems. Int. J. 
Robust Nonlinear Control, 10(15), 1263–1277.
Nonlinear Systems. QFT Controller Design
	149.	 Horowitz, I.M. 1976. Synthesis of feedback systems with non-linear time-varying uncertain 
plants to satisfy quantitative performance specifications. IEEE Proc., 64, 123–130.
	150.	 Horowitz, I.M. 1981. Quantitative synthesis of uncertain non-linear feedback systems with 
non-minimum phase inputs. Int. J. Syst. Sci., 1(12), 55–76.
	151.	 Horowitz, I.M. 1981. Improvements in quantitative non-linear feedback design by cancellation. 
Int. J. Control, 34(3), 547–560.
	152.	 Breiner, M. and Horowitz, I.M. 1981. Quantitative synthesis of feedback systems with uncer­
tain nonlinear multivariable plants. Int. J. Syst. Sci., 12, 539–563.
	153.	 Horowitz, I.M. 1982. Feedback systems with non-linear uncertain plants. Int. J. Control, 36, 155–171.
	154.	 Horowitz, I.M. 1983. A synthesis theory for a class of saturating systems. Int. J. Control, 38(1), 169–187.
	155.	 Horowitz, I.M. and Liao, Y. 1986. Quantitative non-linear compensation design for saturating 
unstable uncertain plants. Int. J. Control, 44, 1137–1146.
	156.	 Oldak, S., Baril, C., and Gutman, P.O. 1994. Quantitative design of a class of nonlinear systems 
with parameter uncertainty. Int. J. Robust Nonlinear Control, 4(1), 101–117.
	157.	 Baños, A. and Bailey, F.N. 1998. Design and validation of linear robust controllers for nonlinear 
plants. Int. J. Robust Nonlinear Control, 8(9), 803–816.
	158.	 Baños, A. and Barreiro, A. 2000. Stability of non-linear QFT designs based on robust absolute 
stability criteria. Int. Journal of Control, 73(1), 74–88.
	159.	 Baños, A., Barreiro, A., Gordillo, F., and Aracil, J. 2002. A QFT framework for nonlinear robust 
stability. Int. J. Robust Nonlinear Control, 12(4), 357–372.
Linear-Time-Variant (LTV) Systems. QFT Controller Design
	160.	 Horowitz, I.M. 1975. A synthesis theory for linear time-varying feedback systems with plant 
uncertainty. IEEE Trans. Autom. Control, AC-20, 454–463.
	161.	 Yaniv, O. and Boneh, R. 1997. Robust LTV feedback synthesis for SISO nonlinear plants. Int. J. 
Robust Nonlinear Control, 7, 11–28.
	162.	 Yaniv, O. 1999. Robust LTV feedback synthesis for nonlinear MIMO plants. Trans. ASME, 121, 
226–232.
	163.	 Garcia-Sanz, M. and Elso, J. 2009. Beyond the linear limitations by combining switching & QFT. 
Application to wind turbines pitch control systems. Int. J. Robust Nonlinear Control, 19(1), 40–58.
Stability Analysis and Controller Design in the Nichols Chart
	164.	 Cohen, N., Chait, Y. Yaniv, O., and Borghesani, C. 1994. Stability analysis using Nichols Charts. 
Int. J. Robust Nonlinear Control, 4(1), 3–20.

530
References
	165.	 Garcia-Sanz, M. 2016. The Nyquist stability criterion in the Nichols chart. Int. J. Robust Nonlinear 
Control, 26(12), 2643–2651.
CAD Tools for QFT Controller Design
	166.	 Bailey, F.N. and Hul, C.H. 1989. CACSD tools for loop gain-phase shaping design of SISO 
robust controllers. Proceedings of the IEEE Control System Society Workshop on Computer Aided 
Control System, Berkeley, CA, pp. 151–157.
	167.	 Sating, R.R. 1992. Development of an Analog MIMO Quantitative Feedback Theory (QFT) 
CAD Package, MS Thesis, AFIT/GE/ENG/92J-04, Air Force Institute of Technology, Wright 
Patterson AFB, OH.
	168.	 Houpis, C.H. and Sating, R.R. 1997. MIMO QFT CAD package (Ver.3). Int. J. Control, 7(6), 
533–549.
	169.	 Borghesani, C., Chait, Y., and Yaniv, O. 1994, 2002. Quantitative Feedback Theory Toolbox—For Use 
with MATLAB. Terasoft, San Diego, CA.
	170.	 Gutman, P.-O. 1996, 2001. Qsyn—the Toolbox for Robust Control Systems Design for Use with 
Matlab, User’s Manual, NovoSyn AB, Jonstorp, Sweden; Electro-Optics Industries Ltd, Rehovot, 
Israel.
	171.	 Houpis, C.H., Rasmussen, S.J., and Garcia-Sanz, M. 2006. CAD Tool for controller design. In 
Quantitative Feedback Theory: Fundamentals and Applications. 2nd Edition, CRC, Taylor & Francis, 
Boca Raton, FL.
	172.	 Garcia-Sanz, M., Vital, P., Barreras, M., and Huarte, A. 2001. InterQFT. Public University of 
Navarra. Also as Interactive Tool for Easy Robust Control Design. In IFAC International 
Workshop, Internet Based Control Education, Madrid, Spain, pp. 83–88.
	173.	 Diaz, J.M., Dormido, S., and Aranda, J. 2004. SISO-QFTIT, una herramienta software interac­
tiva para diseño de controladores robustos usando QFT. UNED, Madrid, Spain.
	174.	 Garcia-Sanz, M., Mauch, A., and Philippe, C. 2009. QFT control toolbox: An interactive object-
oriented Matlab CAD tool for quantitative feedback theory. 6th IFAC Symposium on Robust 
Control Design, ROCOND’09, Haifa, Israel.
	175.	 Garcia-Sanz, M. 2008–2017. The QFT Control Toolbox for Matlab—QFTCT. Standard and 
Student versions at http://codypower.com.
Real-World Applications with QFT
	176.	 Horowitz, I., Neumann, L., and Yaniv, O. 1981. A synthesis technique for highly uncertain 
interacting multivariable flight control system (TYF16CCV). Proceedings of the IEEE Naecon 
Conference, Dayton, OH.
	177.	 Horowitz, I.M. et  al. 1982. Multivariable Flight Control Design with Uncertain Parameters 
(YF16CCV). AFWAL-TR-83-3036, Air Force Wright Aeronautical Laboratories, Wright-
Patterson AFB, OH.
	178.	 Walke, J., Horowitz, I., and Houpis, C. 1984. Quantitative synthesis of highly uncertain MIMO 
flight control system for the forward swept wing X-29 aircraft. Proceedings of the IEEE Naecon 
Conference, Dayton, OH, pp. 576–583.
	179.	 Bossert, D.E. 1989. Design of Pseudo-Continuous-Time Quantitative Feedback Theory Robot 
Controllers. AFIT/GE/ENG/89D-2, Air Force Institute of Technology, Wright-Patterson 
AFB, OH.

531
References
	180.	 Trosen, D.W. 1993. Development of an Prototype Refueling Automatic Flight Control System Using 
Quantitative Feedback Theory. AFIT/GE/ENG/93-J-03, Air Force Institute of Technology, Wright-
Patterson AFB, OH.
	181.	 Kelemen, M. and Bagchi, A. 1993. Modeling and feedback control of a flexible arm of a robot 
for prescribed frequency domain tolerances. Automatica, 29, 899–909.
	182.	 Reynolds, O.R., Pachter, M., and Houpis, C.H. 1994. Design of a subsonic flight control sys­
tem for the Vista F-16 using quantitative feedback theory. Proceedings of the American Control 
Conference, Baltimore, MD, pp. 350–354.
	183.	 Rasmussen, S.J. and Houpis, C.H. 1994. Development implementation and flight of a MIMO 
digital flight control system for an unmanned research vehicle using quantitative feedback 
theory. Proceedings of the ASME Dynamic Systems and Control, Winter Annual Meeting of ASME, 
Chicago, IL.
	184.	 Bentley, A.E. 1994. Quantitative feedback theory with applications in welding. Int. J. Robust 
Nonlinear Control, 4(1), 119–160.
	185.	 Yau, C.H., Gallagher, J.E., and Nwokah, O.D.I. 1994. A model reference quantitative feedback 
design theory with application to turbomachinery. Int. J. Robust Nonlinear Control, 4(1), 181–210.
	186.	 Miller, R.B., Horowitz, I.M., Houpis, C.H., and Finley, B. 1994. Multi-input, multi-output flight 
control system design for the YF-16 using nonlinear QFT and pilot compensation. Int. J. Robust 
Nonlinear Control, 4(1), 211–230.
	187.	 Miller, R.B., Horowitz, I.M., Houpis, C.H., and Barfield, A.F. 1994. Multi-input, multi-output 
flight control system design for the YF-16 using nonlinear QFT and pilot compensation. Int. J. 
Robust Nonlinear Control, 4(1), 211–230.
	188.	 Osmon, C., Pachter, M., and Houpis, C.H. 1996. Active flexible wing control using QFT. IFAC 
13th World Congress, vol. H, San Francisco, CA, pp. 315–320.
	189.	 Franchek, M. and Hamilton, G.K. 1997. Robust controller design and experimental verification 
of I.C. engine speed control. Int. J. Robust Nonlinear Control, 7, 609–628.
	190.	 Pachter, M., Houpis, C.H., and Kang, K. 1997. Modelling and control of an electro-hydrostatic 
actuator. Int. J. Robust Nonlinear Control, 7, 591–608.
	191.	 Boje, E. and Nwokah, O.D.I. 1999. Quantitative multivariable feedback design for a turbofan 
engine with forward path decoupling. Int. J. Robust Nonlinear Control, 9(12), 857–882.
	192.	 Garcia-Sanz, M. and Ostolaza, J.X. 2000. QFT-control of a biological reactor for simultaneous 
ammonia and nitrates removal. Int. J. Syst. Anal. Model. Simul. SAMS, 36, 353–370.
	193.	 Egaña, I., Villanueva, J., and Garcia-Sanz, M. 2001. Quantitative multivariable feedback design 
for a SCARA robot arm. 5th International Symposium on QFT and Robust Frequency Domain 
Methods, Pamplona, Spain, pp. 67–72.
	194.	 Rueda, T.M. and Velasco, F.J. 2001. Robust QFT controller for marine course-changing control. 
5th International Symposium on QFT and Robust Frequency Domain Methods, Pamplona, Spain, pp. 
79–84.
	195.	 Kelemen, M. and Akhrif, O. 2001. Linear QFT control of a highly nonlinear multi-machine 
power system. Int. J. Robust Nonlinear Control, 11(10), 961–976.
	196.	 Bentley, A.E. 2001. Pointing control design for high precision flight telescope using quantita­
tive feedback theory. Int. J. Robust Nonlinear Control, 11(10), 923–960.
	197.	 Liberzon, A., Rubinstein, D., and Gutman, P.O. 2001. Active suspension for single wheel satin 
of on-road track vehicle. Int. J. Robust Nonlinear Control, 11(10), 977–999.
	198.	 Garcia-Sanz, M., Guillen, J.C., and Ibarrola, J.J. 2001. Robust controller design for time delay 
systems with application to a pasteurisation process. Control Eng. Pract. 9, 961–972.
	199.	 Yaniv, O., Fried, O., and Furst-Yust, M. 2002. QFT application for headphone’s active noise can­
cellation. Int. J. Robust Nonlinear Control, 12(4), 373–383.
	200.	 Niksefat, N. and Sepehri, N. 2002. A QFT fault-tolerant control for electrohydraulic positioning 
systems. IEEE Trans. Control Syst. Technol., 10(4), 626–632.
	201.	 Gutman, P.O., Horesh, E., Guetta, R., and Borshchevsky, M. 2003. Control of the aero-electric 
power station—An exciting QFT application for the 21st century. Int. J. Robust Nonlinear Control, 
13(7), 619–636.

532
References
	202.	 Torres, E. and Garcia-Sanz, M. 2004. Experimental results of the variable speed, direct drive 
multipole synchronous wind turbine: TWT1650. Wind Energy, 7(2), 109–118.
	203.	 Garcia-Sanz, M. and Hadaegh, F.Y. 2004. Coordinated Load Sharing QFT Control of Formation 
Flying Spacecrafts. 3D Deep Space and Low Earth Keplerian Orbit Problems with Model Uncertainty. 
NASA-JPL, JPL Document, D-30052, Pasadena, CA.
	204.	 Kerr, M. 2004. Robust Control of an Articulating Flexible Structure Using MIMO QFT, PhD 
Dissertation, University of Queensland, Australia.
	205.	 Barreras, M. and Garcia-Sanz, M. 2004. Multivariable QFT controllers design for heat exchang­
ers of solar systems. International Conference on Renewable Energy and Power Quality, Barcelona, 
Spain.
	206.	 Garcia-Sanz, M. and Barreras, M. 2006. Non-diagonal QFT controller design for a 3-input 
3-output industrial Furnace. Int. J. Dyn. Syst. Meas. Control ASME, 128(2), 319–329.
	207.	 Barreras, M., Villegas, C., Garcia-Sanz, M., and Kalkkuhl, J. 2006. Robust QFT tracking con­
troller design for a Car equipped with 4-wheel steer-by-wire. IEEE International Conference on 
Control Applications, CCA, Munich, Germany, doi: 10.1109/CACSD-CCA-ISIC.2006.4776832.
	208.	 Garcia-Sanz, M., Eguinoa, I., Ayesa, E., and Martin, C. 2006. Non-diagonal multivariable 
robust QFT control of a wastewater treatment plant for simultaneous nitrogen and phospho­
rus removal. Robust Control Design Conference, ROCOND’06, IFAC, Toulouse, France.
	209.	 Garcia-Sanz, M. and Hadaegh, F.Y. 2007. Load-sharing robust control of spacecraft formations: 
Deep space and low earth elliptic orbits. IET Control Theory Appl. (former IEE), 1(2), 475–484, 
UK.
	210.	 Kerr, M.L., Lan, C.Y., and Jayasuriya, S. 2007. Non-sequential MIMO QFT control of the X-29 
aircraft using a generalized formulation. Int. J. Robust Nonlinear Control, 17(2–3), 107–134.
	211.	 Garcia-Sanz, M., Eguinoa, I., Barreras, M., and Bennani, S. 2008. Non-diagonal MIMO QFT 
controller design for Darwin-type spacecraft with large flimsy appendages. J. ASME J. Dyn. 
Syst. Meas. Control, 130, 011006-1–011006-15.
	212.	 Garcia-Sanz, M., Eguinoa, I., Gil-Martinez, M., Irizar, I., and Ayesa, E. 2008. MIMO quantitative 
robust control of a wastewater treatment plant for biological removal of nitrogen and phospho­
rus. 16th Mediterranean Conference on Control and Automation, MED’08, Ajaccio, France.
	213.	 Garcia-Sanz, M. and Molins, C. 2008. QFT robust control of a Vega-type space launcher. 16th 
Mediterranean Conference on Control and Automation, Ajaccio, France.
	214.	 Garcia-Sanz, M. 2009. QFT: New developments and advanced real-world applications. Plenary 
session. 6th IFAC Symposium on Robust Control Design, Haifa, Israel.
	215.	 Karpenko, M. and Sepehri, N. 2010. On quantitative feedback design for robust position con­
trol of hydraulic actuators. Control Engineering Practice, 18(3), 289–299.
	216.	 Garcia-Sanz, M., Eguinoa, I., and Barreras, M. 2011. Advanced attitude and position MIMO 
robust control strategies for telescope-type spacecraft with large flexible appendages. In 
Advances in Spacecraft Technologies. INTECH. (Editor Jason Hall), ISBN: 978-953-307-551-8, doi: 
10.5772/14506
	217.	 Garcia-Sanz, M., Ranka, T., and Joshi, B.C. 2011. Advanced nonlinear robust controller design 
for high-performance servo-systems in large radar antennas. 63th National Aerospace & 
Electronics Conference, IEEE-NAECON, Dayton, OH.
	218.	 Tierno, N., White, N., and Garcia-Sanz, M. 2011. Longitudinal flight control for a novel airborne 
wind energy system: Robust MIMO control design techniques. ASME International Mechanical 
Engineering Congress & Exposition, IMECE-2011, November 11–17, Denver, CO.
	219.	 Karpenko, M. and Sepehri, N. 2012. Electrohydraulic force control design of a hardware-in-
the-loop load emulator using a nonlinear QFT technique. Control Eng. Pract., 20(6), 598–609.
	220.	 Garcia-Sanz, M., Ranka, T., and Joshi, B.C. 2012. High-performance switching QFT control 
for large radio telescopes with saturation constraints. 64th National Aerospace & Electronics 
Conference, IEEE-NAECON, Dayton, OH.
	221.	 Lounsbury, W. and Garcia-Sanz, M. 2014. High-performance quantitative robust switching 
control for optical telescopes. 2014 SPIE Astronomical Telescopes and Instrumentation Conference, 
SPIE, Software and Cyberinfrastructure for Astronomy III, Montreal, QC, doi: 10.1117/12.2056910.

533
References
	222.	 Garcia-Sanz, M., Labrie, H., and Cavalcanti, J. 2014. Wind farm lab test-bench for research/edu­
cation on optimum design and cooperative control of wind turbines. In Wind Turbine Control 
and Monitoring. (Editors Luo, Vidal, and Acho), Springer Verlag, Berlin, Germany, Chapter 14, 
Series of Green Energy and Technology, ISBN: 978-3-319-08412-1.
NATO/RTO Lecture Series about QFT
	223.	 Garcia-Sanz, M. 2003. Quantitative Feedback Theory (QFT): Bridging the Gap. NATO/RTO 
Lecture Series SCI-236. Systems Concepts and Integration Panel. Robust Integrated Control 
System Design Methods for the 21st Century Military Applications. Setubal, Portugal; Forli, 
Italy; and Los Angeles, CA.
	224.	 Garcia-Sanz, M. 2005. Quantitative Robust Control Engineering. Theory and Applications. 
NATO/RTO Lecture Series SCI-166. Partnership for Peace (PFP). Systems Concepts and 
Integration Panel. Achieving Successful Robust Integrated Control System Designs for the 21st 
Century Military Applications. Stockholm, Sweden; Zurich, Switzerland; Bucharest, Romania.
	225.	 Garcia-Sanz, M. 2007. Quantitative Robust Control of Spacecraft Formations. NATO/RTO 
Lecture Series SCI-175. Systems Concepts and Integration Panel: System Control Technologies, 
Design Considerations & Integrated Optimization Factors For Distributed Nano Unmanned 
Air Vehicle (UAV) Applications. Davis, CA; Rostock, Germany; Florence, Italy.
	226.	 Garcia-Sanz, M., Eguinoa, I., and Elso, J. 2008. Beyond the Classical Performance Limitations 
Controlling Uncertain MIMO Systems: UAV Applications. NATO/RTO Lecture Series SCI-195. 
Systems Concepts and Integration Panel: Advanced autonomous formation control and trajec­
tory management techniques for multiple micro UAV applications. Glasgow, UK; Pamplona, 
Spain; Cleveland, OH.
	227.	 Garcia-Sanz, M. 2009. MIMO QFT Controller Design Reformulation. Application to spacecraft 
with flexible appendages and to spacecraft flying in formation in a low Earth orbit. NATO/RTO 
Lecture Series SCI-209. Systems Concepts and Integration Panel: Small Satellite Formations for 
Distributed Surveillance: System Design and Optimal Control Considerations. Stanford, CA; 
Wurzburg, Germany; Rome, Italy.
Miscellaneous. QFT Control
	228.	 Nordgren, R.E., Nwokah, O.D.I., and Franchek, M.A. 1994. New formulations for quantitative 
feedback theory. Int. J. Robust Nonlinear Control, 4(1), 47–64.
Books Related to Control Engineering
	229.	 Rosenbrock, H.H. 1970. State-Space and Multivariable Theory. Thomas Nelson, London, UK.
	230.	 Takahaschi, Y., Rabims, M., and Auslander, D. 1970. Control and Dynamic Systems. Addison 
Wesley, Reading, MA.
	231.	 Rosenbrock, H.H. 1974. Computer-Aided Control System Design. Academic Press, New York, NY.
	232.	 Wolovich, W.A. 1974. Linear Multivariable Systems, 11, Springer-Verlag, Berlin, Germany.

534
References
	233.	 Desoer, C.A. and Vidyasagar, M. 1975. Feedback Systems: Input–Output Properties. Academic 
Press, New York, NY.
	234.	 Frank, P.M. 1978. Introduction to System Sensitivity Theory. Academic Press, New York, NY.
	235.	 Postlethwaite, I. and MacFarlane, A.G.J. 1979. A Complex Variable Approach to the Analysis of 
Linear Multivariable Feedback Systems, 12. Springer-Verlag, Berlin, Germany.
	236.	 Wellstead, P.E. 1979. Introduction to Physical System Modelling. Academic Press, New York, NY.
	237.	 Kailath, T. 1980. Linear Systems. Prentice-Hall, Englewood Cliffs, NJ.
	238.	 Hung, Y.S. and MacFarlane, A.G.J. 1982. Multivariable Feedback: A Quasi-Classical Approach, 40. 
Springer-Verlag, Berlin.
	239.	 McAvoy, T.J. 1983. Interaction Analysis—Principles and Applications. Instrument Society of 
America, Research Triangle Park, NC.
	240.	 Ljung, L. 1987. System Identification: Theory for the User. Prentice Hall, Englewood Cliffs, NJ. 
Information and System Science Series. And Ljung, L., (1997), System Identification Toolbox 
User’s Guide. The Mathworks, Inc.
	241.	 O’Reilly, J. 1987. Multivariable Control for Industrial Applications. Peter Peregrinus Ltd, London.
	242.	 Franklin, G.F. and Powell, J.D. 1988. Digital Control of Dynamic Systems. 2nd Edition, Addison-
Wesley, Reading, MA.
	243.	 Freudenberg, J.S. and Looze, D.P. 1988. Frequency Domain Properties of Scalar and Multivariable 
Feedback Systems. Springer-Verlag, Berlin.
	244.	 Deshpande, P.B. 1989. Multivariable Process Control. Instrument Society of America, Research 
Triangle Park, NC.
	245.	 Maciejowski, J.M. 1989. Multivariable Feedback Design. Addison-Wesley Publishing Company, 
Reading, MA.
	246.	 Morari, M. and Zafiriou, E. 1989. Robust Process Control. Prentice-Hall International, Englewood 
Cliffs, NJ.
	247.	 Houpis, C.H. and Lamont, G. 2016. Digital Control Systems: Theory, Hardware, Software. 3rd 
Edition, McGraw-Hill, NY.
	248.	 Franklin, G.F., Powell, J.D., and Emani-Naeini, A. 1994. Feedback Control of Dynamic Systems. 
Addison Wesley, New York, NY.
	249.	 Astrom, K.J. and Hagglund, T. 1995. PID Controllers: Theory, Design, and Tuning. 2nd Edition, 
ISA, North Carolina. Also 2nd ed., (2006) as Advanced PID Control.
	250.	 Bhattacharyya, S.P., Chapellat, H., and Keel, L.H. 1995. Robust Control: The Parametric Approach. 
Prentice Hall, UK.
	251.	 Zhou, K., Doyle, J., and Glover, K. 1996. Robust and Optimal Control. Prentice Hall, Englewood 
Cliffs, NJ.
	252.	 Dutton, K., Thompson, S., and Barraclough, B. 1997. The Art of Control Engineering. Pearson/
Prentice-Hall, UK.
	253.	 Datta, A., Ho, M.T., and Bhattacharyya, S.P. 2000. Structure and Synthesis of PID Controllers. 
Springer-Verlag, Berlin, Germany.
	254.	 Dorato, P. 2000. Analytic Feedback System Design. An Interpolation Approach. Brooks-Cole, Pacific 
Grove, CA.
	255.	 Kailath, T., Sayed, A.H., and Hassibi, B. 2000. Linear Estimation. Prentice Hall, Information and 
System Sciences Series, New Jersey.
	256.	 Lurie, B.J. and Enright, P.J. 2000. Classical Feedback Control with MATLAB. Marcel Dekker, New 
York, NY.
	257.	 Rosenwasser, E. and Yusupov, R. 2000. Sensitivity of Automatic Control Systems. CRC Press, 
Taylor & Francis Group, Boca Raton, FL.
	258.	 Pintelon, R. and Shoukens, J. 2012. System Identification: A Frequency Domain Approach. Wiley-
IEEE Press, Hoboken, NJ.
	259.	 Houpis, C.H. and Sheldon, S.N. 2013. Linear Control System Analysis and Design with Matlab. 6th 
Edition, CRC Press, Taylor & Francis Group, Boca Raton, FL.
	260.	 Skogestad, S. and Postlethwaite, I. 2005. Multivariable Feedback Control. Analysis and Design. 2nd 
Edition, John Wiley & Sons Ltd, UK.

535
References
	261.	 Verhaegen, M. and Verdult, V. 2007. Filtering and System Identification: An Introduction. Cambridge 
University Press, Cambridge, UK.
	262.	 Ogata, K. 2009. Modern Control Engineering. 5th edition, Prentice-Hall, New Jersey.
	263.	 Dorf, R.C. and Bishop, R.H. 2016. Modern Control Systems. 13th Edition, Pearson, New Jersey.
General MIMO Systems
	264.	 McMillan, B. 1952. Introduction to formal realizability theory—I, II. Bell Syst. Tech. J., 31(2, 3), 
217–279, 541–600.
	265.	 Bristol, E.H. 1966. On a new measure of interaction for multi-variable process control. IEEE 
Trans. Autom. Control, AC-11(1), 133–134.
	266.	 Hsu, C.-H. and Chen, C.-T. 1968. A proof of the stability of multivariable feedback systems. 
Proc. IEEE, 56(11), 2061–2062.
	267.	 Rosenbrock, H.H. 1969. Design of multivariable control systems using the inverse Nyquist 
array. IEE-Proc., 116(11), 1929–1936.
	268.	 Luyben, W.L. 1970. Distillation decoupling. AIChE J., 16, 198–203.
	269.	 Mayne, D.Q. 1973. The design of linear multivariable systems. Automatica, 9(2), 201–207.
	270.	 Rosenbrock, H.H. 1973. The zeros of a system. Int. J. Control, 18(2), 297–299.
	271.	 Barman, J.F. and Katzenelson, J. 1974. A generalized Nyquist-type stability criterion for multi­
variable feedback systems. Int. J. Control, 20(4), 593–622.
	272.	 Davison, E. and Wang, S.H. 1974. Properties and calculation of transmission zeros of linear 
multivariable systems. Automatica, 10(6), 643–658.
	273.	 Desoer, C.A. and Schulman, J.D. 1974. Zeros and poles of matrix transfer functions and their 
dynamical interpretation. IEEE Trans. Circuits Syst., CAS-21(1), 3–8.
	274.	 Rosenbrock, H.H. 1974. Corrections to “the zeros of a system”. Int. J. Control, 20(3), 525–527.
	275.	 MacFarlane, A.G.J. and Karcanias, N. 1976. Poles and zeros of linear multivariable systems: 
A survey of the algebraic, geometric and complex-variable theory. Int. J. Control, 24(1), 33–74.
	276.	 Shaked, U., Horowitz, I., and Golde, S. 1976. Synthesis of multivariable, basically non-interact­
ing systems with significant plant uncertainty. Automatica, 12(1), 61–71.
	277.	 MacFarlane, A.G.J. and Postlethwaite, I. 1977. The generalized Nyquist stability criterion and 
multivariable root loci. Int. J. Control, 25(1), 81–127.
	278.	 Postlethwaite, I. 1977. A generalized inverse Nyquist stability criterion. Int. J. Control, 26(3), 
325–40.
	279.	 Witcher, M.F. and McAvoy, T.J. 1977. Interacting control systems: Steady state and dynamic 
measurement of interaction. ISA Trans., 16(3), 35–41.
	280.	 Doyle, J.C. 1978. Robustness of multi-loop linear feedback systems. IEEE Conference on Decision 
and Control, 17th Symposium. Adaptive Processes, Fort Lauderdale, FL.
	281.	 MacFarlane, A.G.J. and Karcanias, N. 1978. Relationships between state space and frequency 
response concepts. Proceedings of the 7th IFAC Congress, Lisbon, Portugal, pp. 1771–1779.
	282.	 MacFarlane, A.G.J. and Scott-Jones, D.F.A. 1979. Vector gain. Int. J. Control, 29(1), 65–91.
	283.	 Mayne, D.Q. 1979. Sequential design of linear multivariable systems. Proc. IEE, 126(6), 
568–572.
	284.	 Desoer, C. and Wang, Y.-T. 1980. On the generalized Nyquist stability criterion. IEEE Trans. 
Autom. Control, 25(2), 187–196.
	285.	 Wall, J.E., Doyle, J.C., and Harvey, C.A. 1980. Tradeoffs in the design of multivariable feed­
back systems. 18th Allerton Conference on Communication, Control and Computing, Monticello, IL, 
pp. 715–725.
	286.	 Weischedel, K. and McAvoy, T.J. 1980. Feasibility of decoupling in conventionally controlled 
distillation columns. Ind. Eng. Chem. Fund., 19, 379–384.

536
References
	287.	 MacFarlane, A.G.J. and Hung, Y.S. 1981. Use of parameter groups in the analysis and design 
of multivariable feedback systems. 20th IEEE Conference on Decision and Control, Symposium on 
Adaptive Processes, San Diego, CA, doi: 10.1109/CDC.1981.269507.
	288.	 Mees, A.I. 1981. Achieving diagonal dominance. Syst. Control Lett., 1(3), 155–158.
	289.	 Postlethwaite, I., Edmunds, J., and MacFarlane, A. 1981. Principal gains and principal phases in 
the analysis of linear multivariable feedback systems. IEEE Trans. Autom. Control, 26(1), 32–46.
	290.	 Doyle, J. 1982. Analysis of feedback systems with structured uncertainties. IEE Proc. D (Control 
Theory Appl.), 129(6), 242–50.
	291.	 Doyle, J.C., Wall, J.E., and Stein, G. 1982. Performance and robustness analysis for structured 
uncertainty. 21st IEEE Conference on Decision and Control, Orlando, FL, pp. 629–636.
	292.	 Arkun, Y., Manousiouthakis, B., and Palazoglu, A. 1984. Robustness analysis of process con­
trol systems. A case study of decoupling control in distillation. Ind. Eng. Chem. Process Design 
Develop., 23, 93–101.
	293.	 Bryant, G.F. and Yeung, L.F. 1994. New sequential design procedures for multivariable systems 
based on Gauss-Jordan factorization. IEE Control Theory Appl., 141(6), 427–436.
	294.	 Grosdidier, P., Morari, M., and Holt, B.R. 1985. Closed-loop properties from steady-state gain 
information. Ind. Eng. Chem. Fund., 24(2), 221–235.
	295.	 Marino-Galarraga, M., Marlin, T.E., and McAvoy, T.J. 1985. Using the relative disturbance gain 
to analyse process operability. 1985 American Control Conference (Catalogue No. 85CH2119-6), 
Boston, MA, pp. 1078–1083.
	296.	 Stanley, G., Marino-Galarraga, M., and McAvoy, T.J. 1985. Shortcut operability analysis. I. The 
relative disturbance gain. Ind. Eng. Chem. Proc. Des. Dev., 24(4), 1181–1188.
	297.	 Grosdidier, P. and Morari, M. 1986. Interaction measures for systems under decentralized con­
trol. Automatica, 22(3), 309–319.
	298.	 Manousiouthakis, V., Savage, R., and Arkun, Y. 1986. Synthesis of decentralized process con­
trol structures using the concept of block relative gain. AIChE J., 32(6), 991–1003.
	299.	 Mijares, G., Cole, J.D., Naugle, N.W., Preisig, H.A., and Holland, C.D. 1986. New criterion for the 
pairing of control and manipulated variables. AIChE J., 32(9), 1439–1449.
	300.	 Slaby, J. and Rinard, I.H. 1986. Complete interpretation of the dynamic relative gain array. 
American Institute of Chemical Engineers, Annual Meeting, Miami, FL.
	301.	 Grosdidier, P. and Morari, M. 1987. A computer aided methodology for the design of decentral­
ized controllers. Comp. Amp; Chem. Eng., 11(4), 423–433.
	302.	 Nett, C.N. and Spang, H.A. 1987. Control structure design: A missing link in the evolution of 
modem control theories. American Control Conference, Minneapolis, MN.
	303.	 Skogestad, S. and Morari, M. 1987. Implications of large RGA elements on control performance. 
Ind. Eng. Chem. Res., 26(11), 2323–2330.
	304.	 Skogestad, S. and Morari, M. 1987. Effect of disturbance directions on closed-loop perfor­
mance. Ind. Eng. Chem. Res., 26(10), 2029–2035.
	305.	 Chiu, M.S. and Arkun, Y. 1990. Decentralized control structure selection based on integrity 
considerations. Ind. Eng. Chem. Res., 29(3), 369–373.
	306.	 Yu, C.-C. and Fan, M.K.H. 1990. Decentralized integral controllability and D-stability. Chem. 
Eng. Sci., 45(11), 3299–3309.
	307.	 Chang, J.-W. and Yu, C.-C. 1992. Relative disturbance gain array. AIChE J., 38(4), 521–534.
	308.	 Hovd, M. and Skogestad, S. 1992. Simple frequency-dependent tools for control system analy­
sis, structure selection and design. Automatica, 28(5), 989–996.
	309.	 Campo, P.J. and Morari, M. 1994. Achievable closed-loop properties of systems under decentral­
ized control: Conditions involving the steady-state gain. IEEE Trans. Autom. Control, 39(5), 932–943.
	310.	 Franchek, M.A., Herman, P.A., and Nwokah, O.D.I. 1995. Robust multivariable control of dis­
tillation columns using a non-diagonal controller matrix. 1995 ASME International Mechanical 
Engineering Congress and Exposition. Part 1 (of 2), November 12–17, 1995, San Francisco, CA.
	311.	 Van de Wal, M. and de Jager, B. 1995. Control structure design: A survey. American Control 
Conference, Seattle, WA, pp. 225–229.

537
References
	312.	 Skogestad, S. and Havre, K. 1996. The use of RGA and condition number as robustness mea­
sures. Comput. Chem. Eng., 20, S1005–S1010.
	313.	 Franchek, M.A., Herman, P., and Nwokah, O.D.I. 1997. Robust non-diagonal controller design 
for uncertain multivariable regulating systems. Transactions of the ASME. J. ASME J. Dyn. Syst. 
Meas. Control, 119(1), 80–85.
	314.	 Wade, H.L. 1997. Inverted decoupling: A neglected technique. ISA Trans., 36, 3–10.
Papers Related to Fragility
	315.	 Keel, L.H. and Bhattacharyya, S.P. 1997. Robust, fragile, or optimal? IEEE Trans. Automat. 
Control, 42, 1098–1105.
	316.	 Dorato, P. 1998. Non-fragile controller design, an overview. Proceedings of the American Control 
Conference, Philadelphia, PA, pp. 2829–2931.
	317.	 Famularo, P.D.D., Abdallah, C.T., Jadbabaie, A., and Haddad, W. 1998. Robust non-fragile 
LQ controllers: The static state feedback case. Proceedings of the American Control Conference, 
Philadelphia, PA, pp. 1109–1113.
	318.	 Haddad, W.M. and Corrado, J.R. 1998. Robust resilient dynamic controllers for systems with 
parametric uncertainty and controller gain variations. Proceedings of the American Control 
Conference, Philadelphia, PA, pp. 2837–2841.
	319.	 Jadbabaie, A., Chaouki, T., Famularo, D., and Dorato, P. 1998. Robust, non-fragile and optimal 
controller design via linear matrix inequalities. Proceedings of the American Control Conference, 
Philadelphia, PA, pp. 2842–2846.
	320.	 Keel, L.H. and Bhattacharyya, S.P. 1998. Authors’ reply. IEEE Trans. Automat. Contr., 43, 1268.
	321.	 Keel, L.H. and Bhattacharyya, S.P. 1998. Stability margins and digital implementation of con­
trollers. Proceedings of the American Control Conference, Philadelphia, PA, pp. 2852–2856.
	322.	 Mäkilä, P.M. 1998. Comments on “Robust, Fragile, or Optimal?”. IEEE Trans. Automat. Control, 
43, 1265–1267.
	323.	 Corrado, J.R. and Haddad, W.M. 1999. Static output feedback controllers for Systems with 
parametric uncertainty and controller gain variation. Proceedings of the 1999 American Control 
Conference, San Diego, CA, pp. 915–919.
	324.	 Yang, G.H., Wang, J.L., and Lin, C. 1999. H∞ control for linear systems with controller uncer­
tainty. Proceedings of the 1999 American Control Conference, San Diego, CA, pp. 3377–3381.
	325.	 Paattilammi, J. and Mäkilä, P.M. 2000. Fragility and robustness: A case study on paper machine 
headbox control. IEEE Control Syst. Mag., 20, 13–22.
Papers Related to Hybrid and Switching Control Systems
	326.	 Narendra, K. and Goldwyn, R. 1964. A geometrical criterion for the stability of certain nonlin­
ear nonautonomous systems. IEEE Trans. Circuits Syst., 11, 406–408.
	327.	 Willems, J. 1973. The circle criterion and quadratic Lyapunov functions for stability analysis. 
IEEE Trans. Autom. Control, 18, 184.
	328.	 Molchanov, A.P. and Pyatnitskii, E.S. 1989. Criteria of asymptotic stability of differential and 
difference inclusions encountered in control theory. Syst. Control Lett., 13, 59–64.
	329.	 Feuer, A., Goodwin, G.V., and Salgado, M. 1997. Potential benefits of hybrid control for linear 
time invariant plants. Proceedings of the American Control Conference, Albuquerque, NM.

538
References
	330.	 Seron, M.M., Braslavsky, J.H., and Goodwin, G.C. 1997. Fundamental Limitations in Filtering and 
Control. Springer, London.
	331.	 Dayawansa, W.P. and Martin, C.F. 1999. A converse Lyapunov theorem for a class of dynamical 
systems which undergo switching. IEEE Trans. Autom. Control, 44, 751–760.
	332.	 Liberzon, D. and Morse, A.S. 1999. Basic problems in stability and design of switched systems. 
IEEE Control Syst. Mag., 19, 59–70.
	333.	 Decarlo, R.A., Branicky, M.S., Pettersson, S., and Lennartson, B. 2000. Perspectives and results 
on the stability and stabilizability of hybrid systems. Proc. IEEE, 88, 1069–1082.
	334.	 Mcclamroch, N.H. and Kolmanovsky, I. 2000. Performance benefits of hybrid control design 
for linear and nonlinear systems. Proc. IEEE, 88, 1083–1096.
	335.	 Shorten, R.N., Mason, O., O’Cairbre, F., and Curran, P. 2004. A unifying framework for the 
SISO circle criterion and other quadratic stability criteria. Int. J. Control, 77, 1–8.
	336.	 Shorten, R., Wirth, F., Mason, O., Wulff, K., and King, C. 2007. Stability criteria for switched and 
hybrid systems. SIAM Rev., 49, 545–592.
Miscellaneous. Control
	337.	 Tustin, A. 1947. A method of analyzing the behavior of linear systems in terms of time series. 
JIEE, London, 94(Pt IIA), 152–160.
	338.	 Smith, O.J.M. 1957. Closer control of loops with dead time. Chem. Eng. Progr., 53, 217–219.
	339.	 Lepschy, A. and Ruberty, A. 1960. A rule for direct verification of the Nyquist criterion in non-
polar diagrams. 1st IFAC World Congress, Part I, vol. I, Moscow, URSS, pp. 13–17.
	340.	 Horowitz, I.M. and Shaked, U. 1975. Superiority of transfer function over state-variable meth­
ods in linear time-invariant feedback system design. IEEE Trans. Automat. Control, AC-20, 
84–97.
	341.	 Powell, J.D., Parsons, E., and Tashka, G. 1976. A comparison of flight control design methods. 
Guidance and Control Conference, San Diego, CA.
	342.	 Ioannides, A.C., Rogers, G.J., and Latham, V. 1979. Stability limits of a Smith controller in sim­
ple systems containing a dead-time. Int. J. Control, 29, 557–563.
	343.	 Palmor, Z. 1980. Stability properties of Smith dead-time compensator controllers. Int. J. Control, 
32, 937–949.
	344.	 Kannai, Y. 1982. Causality and stability of linear systems described by partial differential 
operators. Siam J. Control Opt., 10(5), 669–674.
	345.	 Horowitz, I. 1983. Some properties of delayed controls (Smith regulator). Int. J. Control, 38, 
977–990.
	346.	 Anderson, B.D.O. and Parks, P.C. 1985. Lumped approximation of distributed systems and 
controllability questions. IEE Proc., 132(3), 89–94.
	347.	 Yamanaka, K. and Shimemura, E. 1987. Effects of mismatched Smith controller on stability in 
systems with time-delay. Automatica, 23, 787–791.
	348.	 Vidyasagar, M., Bertschmann, R.K., and Sallaberger, C.S. 1988. Some simplifications of the 
graphical Nyquist criterion. IEEE Trans. Automat. Control, 33(3), 301–305.
	349.	 Collins, Jr., E.G., King, J.A., and Bernstein, D.S. 1991. Robust control design for a benchmark 
problem using the maximum entropy approach. Proceedings of the American Control Conference, 
Boston, MA.
	350.	 Wie, B. and Bernstein, D. 1992. Benchmark problems for robust control design. J. Guid. Control 
Dyn., 15, 1057–1059.
	351.	 Astrom, K.J., Hang, C.C., and Lim, B.C. 1994. A new Smith predictor for controlling a process 
with an integrator and long dead-time. IEEE Trans. Automat. Control, 39, 343–345.

539
References
	352.	 Matausek, M.R. and Micic, A.D. 1996. A modified Smith predictor for controlling a process 
with an integrator and long dead-time. IEEE Trans. Automat. Contr., 41, 1199–1203.
	353.	 Normey-Rico, J.E. and Camacho, E.F. 1999. Smith predictor and modifications: A comparative 
study. Proceedings of the European Control Conference on ECC’99, Karlsruhe, Germany.
	354.	 Glad, T. and Ljung, L. 2000. Control Theory. Multivariable and Nonlinear Methods. Taylor & 
Francis Group, London.
	355.	 Sein, G 2003. Respect the unstable. IEEE Control Syst. Mag., 23(4), 12–25.
	356.	 Belanger, P.R. 2005. Control Engineering: A Modern Approach. Oxford University Press, Orlando, 
FL.
	357.	 McCullough, D. 2015. The Wright Brothers. Simon & Schuster, New York, NY.
Miscellaneous
	358.	 Farlow, S.J. 1937. Partial Differential Equations for Scientists and Engineers. Dover Publications. 
Reprint edition 1993, New York, NY.
	359.	 Blakelock, J.H. 1965. Automatic Control of Aircraft and Missiles. Wiley, New York, NY.
	360.	 Isermann, R. 2005. Mechatronic systems. Springer, London, UK.
	361.	 Palm, III, W.J. 1999. Modeling, Analysis and Control of Dynamic Systems. 2nd Edition, Wiley, New 
York, NY.
	362.	 Egeland, O. and Gravdahl, T. 2002. Modeling and Simulation for Automatic Control. Marine 
Cybernetics, Norway.
	363.	 Sidi, M. 1997. Spacecraft Dynamics and Control. A Practical Engineering Approach. Cambridge 
University Press, Cambridge, UK.
	364.	 Jonkman, J., Butterfield, S., Musial, W., and Scott, G. 2009. Definition of a 5-MW Reference Wind 
Turbine for Offshore System Development. Technical Report NREL/TP-500-38060, Colorado, CO.
	365.	 Ranka, T., Garcia-Sanz, M., Symmes, A., Ford, J., and Weadon, T. 2016. Dynamic analysis of 
the Green Bank Telescope structure and servo system. J. Astron. Telesc. Instrum. Syst., 2(1), 
014001.1–014001.11, doi: 10.1117/1.JATIS.2.1.014001.
	366.	 Verschuur, G.L. 2007. The Invisible Universe: The Story of Radio Astronomy. 2nd Edition, Springer, 
New York, NY.
	367.	 Marlin, T.E. 2000. Process Control. Designing Processes and Control Systems for Dynamic 
Performance. 2nd Edition, McGraw-Hill, Singapore.


541
Index
A
ACC’92 benchmark problem, solution for, 
146–147
ACS, see Attitude control system
Activated sludge processes (ASP), 343
ASP-WWTP configuration, 344
Active RC circuits, 279, 280
Actuators, 267, 279
A/D C, see Analog-to-digital converter
Aerobic tank, 344–345
Aerodynamic condition static instability, 79
Air-conditioning system, 274
Airfoil, 1–2
Airplane flight control, 45
analysis in time domain, 52, 53
control specifications, 47
feedback and feedforward, 59–63
feedback and model matching, 55–58
frequency domain, 52
intersection of bounds, 50
plant models and uncertainty, 45
prefilter design, 51
QFT bounds and G(s) design, loop 
shaping, 50
QFT templates, 46
QFTCT analysis window, 51
reference tracking bounds, 49
sensitivity bounds, 49
sensitivity or plant output disturbance 
rejection analysis, 54
stability analysis, 52
stability bounds, 48
stability QFT bounds, 48
stability specification in Nichols chart, 47
system, 54–59, 59–63, 63–68
time domain, 54
Algorithms
DPS robust control, 499–500
gain scheduling/switching control, 501–503
MIMO robust control, 509–518
nonlinear dynamic control, 505–508
Nyquist stability criterion in Nichols chart, 
485–491
Smith predictor robust control, 493–497
Aliasing, 285, 286
All-pass filter (APF), 116
Alpha-numeric information, 456
Anaerobic tank, 344
Analog implementation, 279, see Digital 
implementation
complex poles and negative gain, 282
complex zeros and negative gain, 282
differentiator and negative gain, 280
gain, 280
integrator and negative gain, 280
lag controller and negative gain, 281
lead controller and negative gain, 281
nonlinearity, 283
notch filter, 283
PD with negative gain, 281
PI with negative gain, 281
PID with positive gain, 281
real pole and negative gain, 282
summer, 280
Analog-to-digital conversions, 296
Analog-to-digital converter (A/D C), 284, 286
Analysis window, 479–483
Anderson–Parks criteria, 121
Angular displacement, 365–366, 368
Anoxic tank, 344
Anti-windup solution for PID controllers, 156
analysis of controller, 161
circle criterion, 160–162
closed-loop system with central plant, 
162–163
control specifications, 157–159
design of prefilter, 159–160
example, 157
loop-shaping of controller, 159
APF, see All-pass filter
Applied control, 11
Armature-controlled DC motor, 20, 36–39, 41, 
42, 43
DC motor, 22, 23
format conversion, 67–68
frequencies, 27–28
motor model, 22
parametric uncertainty, 23–27
PID controller, 66
ASP, see Activated sludge processes

542
Index
Astronomical specifications of spacecraft 
telescopes, 398
Attitude control of satellite with tanks partially 
filled, 435
chapters and sections, 435
control block diagram of satellite, 438
project description, 435–436
questions, 436–439
satellite description, 435
Attitude control system (ACS), 9, 301
for satellite with solar panels, 305
Auctioneering control
design methodology, 276–277
pipe temperatures control, 276–277
systems, 276–277
Average residence time, 99
Azimuth-axis displacement, 366
Azimuth axis–velocity control, 374, 378
analysis and validation of Gp(s) and Fp(s), 
382–383
control specifications, 375, 379–380
controller design, 375, 380–382
plant, 378
QFT templates, 374, 378
Azimuth model description, 366
B
Backward difference approximation, 289
Bandwidth, 81, 398
Basically noninteracting (BNI), 205
Bilinear approximation, 289
Block Relative Gain, 198
BNI, see Basically noninteracting
Bode diagram for nominal plants, 241
Bode diagrams, 134, 147, 161, 180, 308
Bode’s integral expressions, 100
Bounds
QFT, 34–36, 38–39
window, 472
Brush, Charles, 3
wind turbine, 4
Bumpless algorithm, 294
C
CAD tools, see Computer-aided design 
tools
Cascade control, 430
design methodology, 263
for electrical motor, 263
feedforward/cascade control of multi-tank 
system, 434
for radio telescope servo-system, 365
systems, 261–263
CDC, see Control System Society
Central heating system with long time delays, 
428–431
Circle criterion, 160–162
Circle stability criterion, 151–153
Classical 2DOF
2DOF feedback structure, 121–122
control system, 317
Classical droop control, 425
CLF, see Common Lyapunov function
Closed-loop
control system, 82
MIMO system, 193, 247–248
stability, 311–312
transfer functions, 137, 314
Collective pitch, 317
Combustion processes, 269
Common Lyapunov function (CLF), 136
Common quadratic Lyapunov function 
(CQLF), 136
Complementary sensitivity specification, 32, 34
Complex plane, 139
Complex poles and negative gain, 282
Complex zeros and negative gain, 282
Computer-aided design tools (CAD tools), 
5–6, 17–18
Computer control algorithms, 288–292
Constraint control, see Override control
Continuous-time signal, 285
Control effort reduction, 400
specification, 33, 35
Control engineer, 1
leadership, 1–4
Control engineering, 2–5
Control loop, 269
Control of first-order system with uncertainty, 
439–440
Control of third-order state-space system with 
uncertainty, 440–441
Control signal, 22
Control specifications
airplane flight control, 47
in radio-telescope control
azimuth axis–position control, 379–380
azimuth axis–velocity control, 375
satellite control, 308–309
of spacecraft telescopes, 398
control effort reduction, 400
reducing coupling effects, 400
rejection of disturbances at plant 
input, 399

543
Index
robust stability, 398–399
sensitivity reduction, 399
wind turbine control, 330–332
of WWTP, 348–349
Control system design of spacecraft 
telescopes, 400
controller expressions, 404–405
design of diagonal controllers, 401
g11(s)—first MIMO problem, 401–402
g15(s)—first MIMO problem, 403
g22(s)—second MIMO problem, 403
g24(s)—second MIMO problem, 404
g42(s)—second MIMO problem, 404
g44(s)—second MIMO problem, 404
g51(s)—first MIMO problem, 402
g55(s)—first MIMO problem, 403
design of non-diagonal controller
design of prefilters, 404
input–output pairing and loop ordering, 
400–401
Control System Society (CDC), 80
Control systems, 5, 151, 301
control system with NDC, 153
Control topologies, 261
auctioneering control systems, 276–277
cascade control systems, 261–263
feedforward control systems, 263–267
inferential control systems, 274–276
load-sharing control systems, 272–273, 274
mid-range control systems, 270–272
override control systems, 267–269
ratio control systems, 269–270, 271
split-range control systems, 273–274, 275
Controller design, 42
of azimuth axis—position control
loop shaping—Gp(s), 381
prefilter design—Fp(s), 381–382
QFT bounds, 380
of azimuth axis–velocity control
analysis and validation of Gv(s), 377–378
loop shaping—Gv(s), 376
QFT bounds, 375–376
G(s)—loop shaping, 39–41
satellite control
loop-shaping—G(s), 310–311, 312
prefilter design—F(s), 311, 312
QFT-bounds, 309–310
window, 473–478
of WWTP, 349
independent SISO QFT control, 350–353
MIMO QFT control, 353–361
Controller implementation, 279–300
analog implementation, 279–284
active RC circuits, 280
integrator, differentiator, poles, zeros, 
gain, 280, 282
nonlinear control, 283
notch filters, low-pass filters, 291
PID, PI, PD, Lead and Lag controllers, 281
digital implementation, 284–296
aliasing, 285
analog to digital converters, 284
computer control algorithms, 288–292
digital to analog converters, 284
frequency warping, 291
Nyquist frequency, 285
PID control algorithms, 293
position and velocity algorithms, 292–294
pulse width modulation (PWM) 
algorithms, 294–296
quantization, 291–292
ringing, 291
s-to-z transformations (Forward, 
Backward, Tustin), 289
sample and hold, 285–288
switching and bumpless algorithms, 294
fragility analysis with QFT, 296–299, 300
analysis of fragility with QFT, 
296–299, 300
definition, 296–297
Controller structure, 196–197
Conventional generator, 420
Conversion of units, 519
Counter-flow heat exchanger, 185–186
Coupling, 196
effects, 215–217
reduction, 400
elements, 213–214
matrix, 208–209
CQLF, see Common quadratic Lyapunov 
function
Current control, 263
D
D/A C, see Digital-to-analog converter
Damping, 437
matrices, 303
Darwin mission, 395–396
2DOF, see Two-degree of freedom
3D Bode diagram, see Three-dimensional Bode 
diagram
4D Bode diagram, see Four-dimensional Bode 
diagram
5D Bode diagram, see Five-dimensional Bode 
diagram

544
Index
DC, see Direct current
Dead-band, 274
Dead-zone nonlinearity, 167
Decentralized control, 196
Denitrification, 344–345
Describing function technique (DF technique), 
163, 164
isolines, 169–182
nonlinear element, 164–169
Describing functions (DFs), 390
DF technique, see Describing function 
technique
DFs, see Describing functions
Diagonal controller for 2 × 2 heat exchanger 
MIMO system, 187
Diagonal matrix, 196
Diagonal structure, 209–210
Different number of sensors and actuators, see 
Control topologies
Differentiator and negative gain, 280
Digital control
algorithms, 288
system, 284
Digital implementation, 284; see also Analog 
implementation
computer control algorithms, 288–292
PMW, 294–296
positional and velocity algorithm, 292–294
sample and hold, 285–288
switching and bumpless algorithms, 294
Digital implementation of controllers, 279
Digital-to-analog conversions, 296
Digital-to-analog converter (D/A C), 284, 
286, 287
Direct current (DC), 8
electrical motors, 441
motor, 20
armature-controlled DC motor, 19–54, 
69–77
field-controlled DC motor, 441–442
position and velocity control systems, 22
velocity control system, 23
voltage regulator, 3–4
Direct Nyquist Array, 204
Directionality, 201
Dish angle, 384
Distillation column
control, 426–428
2 × 2 distillation column, 427
Distributed parameter systems (DPSs), 5, 
8, 119
extension of quantitative feedback theory to, 
124–134
generalized DPS control system structure, 
121–123
heat transmission system with distributed 
temperature, 134, 499–500
modeling approaches for PDE, 120–121
partial differential equations (PDE), 120–121
practical quantitative robust control 
technique, 119–120
QFT extension to, 124–134
robust control, 499–500
Disturbance
Condition Number, 202
of MIMO, 202
at plant input
rejection, 399
specification, 33, 35
at plant output specification, 308, 379
azimuth axis–position control, 379
NDC, 386
WWTP, 349
rejection, 264–267
specification, 33, 35
Double Laplace transform, 124
DPSs, see Distributed parameter systems
Droop control, 273
2D space problem, see Two-dimensional space 
problem
3D space problem, 124
DVD-disk head control, 413
Bode diagram for nominal plant, 414
chapters and sections, 413
control specifications, 414–415
2DOF control system, 414
modeling, 413–414
position control system for read/write 
head, 413
preliminary analysis, 414
project description, 413
questions, 415
1D wave equation, see One-dimensional wave 
equation
E
Elliptic equations, 120
Engineering specifications of spacecraft 
telescopes, 398
Equivalent control system, 155
with NDC, 154
Euler approximation, 289
Euler–Lagrange equation, 120, 303–304, 320, 
366, 368
Euler–Lagrange expression, 409, 410, 416

545
Index
Extended bounds, 297
Extended plant, 297
Extended templates, 297
External disturbances, 309
F
Feedback
compensator, 301
and feedforward, 59–63
and model matching, 55–58
specifications for DPS, 125
system, 152
Feedback control
fundamental theorem of, 92
principles, 79
system, 85, 86
Feedback controller, 261, 265, 431
design, see Loop-shaping
synthetization, 48, 51
Feedforward control
design methodology, 59–63, 263–264
for disturbance rejection, 264–265
feedforward/cascade control of multi-tank 
system, 434
feedforward/feedback for airplane flight 
control system, 59–62, 78
feedforward/feedback for disturbance 
rejection and reference tracking, 
266–267
for reference tracking (model matching), 266
Feedforward controller, 265
Feedforward–feedback control, 264–265
Field-controlled DC motor, 441–442
Five-dimensional Bode diagram (5D Bode 
diagram), 124
Flap-wise blade vibration analysis, 336
Food pasteurization processes, 185
Fore-aft tower vibration analysis, 336
Formation flying spacecraft control, 442–443
Forward difference approximation, 289
Forward elevator, 80
Four-dimensional Bode diagram (4D Bode 
diagram), 124
Fourier series, 121
Fragile controller, 298–299
Fragility analysis with QFT, 296
extended plant, 297
fragile controller, 298–299
Nichols chart of extended stability bounds 
of system, 300
Frequencies, 27–28
domain, 52, 398
frequency analysis, 313
methodology, 5
plant model, 306
in radio-telescope control, 372–373
warping, 291, 292
in WWTP, 346, 347
F(s) prefilter design, 334–335
Fundamental theorem of feedback control, 92
G
Gain and phase, 201–202
Gain crossover frequency, 82–83
Gain margin (GM), 30, 82–84, 95–97, 98
Gain scheduling, 135–149, 294
stability under switching, 135–141
systems with gain, zeros and poles 
variations, 141–142, 501–503
two-mass-spring benchmark system, 
142–147
Gain scheduling/switching control, 501–503
Gain/Zero/Pole Transfer Function, 456–458
GBT, see Green Bank Telescope
Generalized 2DOF DPS control system 
structure, 122–123
Generalized DPS control system structure, 
121–123
Generalized Nyquist stability criterion, 204
Generalized Relative Disturbance Gain, 198
Geostationary Earth orbits (GEO), 301
Gershgorin circles, 206
GM, see Gain margin
Gravity gradient, 399
Green Bank Telescope (GBT), 365–366
G(s) loop shaping, 332–333
Guidelines to design a controller to stabilize an 
unstable plant, 91–95
H
Heat exchange equation, 120
Heat exchangers, 185, 187–192
Bode diagram for nominal plants, 241
control system, 192–195, 509–518
controller structure, 240–241
design of element, 251–252
diagonal controller element design, 241–242, 
243–244
diagonal prefilter element design, 242–243, 
244–246
flow chart of MIMO QFT Method 2, 248–249
loop shaping of controller, 256–259
MATLAB code, 253–255

546
Index
Heat exchangers  (Continued)
MIMO QFT Method 1, 240
MIMO QFT Method 2, 248
simulation of closed-loop MIMO system, 
246–248
for 2 × 2 heat exchanger, 249–250
Heat transmission
problem, 127
system with distributed temperature, 134, 
499–500
Heavier-than-air airplane, 3
Helicopter control system, 443–444
High frequency noise rejection, 398
Horowitz’s method, 205
Horowitz–Sidi bounds, see QFT-bounds
Hybrid methodology, 135
Hydraulic system, 267–268
Hyperbolic equations, 120
I
Inferential control
control of variable with no direct sensor, 
274–276
design methodology, 274–276
Input–output pairing, 400–401
Integrator and negative gain, 280
Interaction analysis, 196–199
Interconnected micro-grids control, 419
area control error blocks, 423
chapters and sections, 419
control specifications, 424–425
controllers’ design, 425
frequency control blocks, 422
frequency control systems and area control 
error system, 421, 422
model of micro-grids “a” and “b” and tie-
line, 421
modeling, 420–424
project description, 419–420
questions, 425–426
reference tracking specifications for area 
control error, 424
Interferometry technology, 395–396
Internal-model based controller, 116
International Water Association (IWA), 345, 346
Intersection of bounds & compatibility, 48
Inverse Nyquist Array, 204
Inverted pendulum control, 415, 416
chapters and sections, 415
control specifications, 418–419
modeling, 415–417
preliminary analysis, 417–418
project description, 415
questions, 419
I-PD controller, 65
I-PD Kick-off solutions, 65
Isolines, 169, 390–391
channel comparison, 179
circle criterion for 64 plants, 180
control specifications, 171–173
design methodology, 169–171
design of prefilter, 175, 178
loop-shaping of controller, 174, 177
in NC, 181
NDC with several nonlinearities, 171
simulations and discussion, 181–182
stability analysis for complete system, 
179–181
IWA, see International Water Association
K
Kronecker delta, 211
L
Lab-scale helicopter, 443
Lag controller and negative gain, 281
Laplace model, 420
Laplace “s” transfer functions, 21
Laplace transfer function, 397
Laplace variable, 122
Lead controller and negative gain, 281
Lead/lag controller, 438
Left half plane (LHP), 115
LEO, see Low Earth orbits
LHP, see Left half plane
Limitation theory, 135
Linear dissipater, 303
Linear parameter varying system 
(LPV system), 139
Linear time invariant (LTI), 8, 85, 192
Load experimental data, 460–461
Load-sharing control systems, 272–273, 274
Load transfer function array, 129, 459–460
Loops, 205
coupling, 196–197
ordering, 400–401
Loop shaping, 131, 142
of controller, 159, 190
examples
airplane flight control, 39
armature-controlled DC motor, 39
radio telescope control, 373–374, 400
satellite control, 309

547
Index
spacecraft telescope, 401, 403
wastewater treatment plant, 343, 343–347
wind turbine control, 332
Gp(s), 381
G(s), 310–312, 332–333
G(s)–QFT feedback controller design
practical tips, 74–77
QFT Control Toolbox–loop-shaping 
window, 473
synthesise feedback controller in Nichols 
Chart, 39–41
Gv(s), 376
Low Earth orbits (LEO), 301, 448
Low-pass filters, 291
conjecture, 164
first-order filter, 293
LPV system, see Linear parameter varying 
system
LTI, see Linear time invariant
Lumped systems, 119
Lurie, Boris, 142
M
Manual/automatic modes, 294
Mass, 437
matrices, 303
Mathematical approaches, 121
MATLAB code, 5–6, 17–18, 86, 129, 357, 360
algorithms for 2 × 2 distillation column 
simulation, 427
algorithms for DPS QFT robust control 
examples, 499–500
algorithms for gain scheduling /Switching 
control examples, 501–503
algorithms for MIMO QFT robust control 
examples, 509–518
algorithms for nonlinear dynamic control 
examples, 505–508
algorithms for Nyquist stability criterion in 
the Nichols Chart, 485
algorithms for Smith predictor QFT robust 
control examples, 493–497
algorithms for templates calculation, 24
QFTCT for, 7
Mechanical loads, 1–2
Mees’ theorem, 204
Micro-grid control, 419–426
active power control, 10
frequency control, 421–422, 424–426
interconnected micro-grids, 419–426
Microprocessor (µP), 284
Mid-range control systems, 270
control of one variable with several 
motors, 273
control of one variable with two valves, 271
controlling range with high resolution of 
small valve, 271
design methodology, 270–271
design methodology, 272
load-sharing control
load-sharing control for interconnected 
micro-grids, 425
with two control loops and feedforward, 272
MIMO control systems, see Multi-input multi-
output control systems
MIMO QFT
control, 204–207, 353
controller structure, 353
design of 2 × 2 full matrix Gα controller, 
354–357
design of diagonal controller, 
357–358, 360
design of diagonal prefilter, 358, 359, 
360–361, 362
final checking, 361
method 1 for heat exchanger, 239
methodologies, 205
robust control strategy, 395
Minimum phase (mp), 114–115
minreral(.) function, 459
MISO systems, see Multi-input single-output 
systems
Model matching, 54–58, 266
Model uncertainty, 19, 23
Modeling of dynamic systems
active RC circuits with operational 
amplifiers, 279–284
armature-controlled DC motor, 20, 36–39, 41, 
42, 43
Euler-Lagrange method, 303, 320, 367–368, 
409–410, 416
heat conduction distributed temperature 
system, 127–134
inverted pendulum, 415–419
model uncertainty, 19, 413, 478
partial differential equations (pde), 119
plant modelling, 19–28, 456–462
radio telescope, 365, 365–366, 373
satellite with flexible appendages, 301, 
301–302, 316
vehicle active suspension system, 410
wind turbine, 317, 320, 329–330
Motor angular position, 22
Motor control signal, 444
mp, see Minimum phase

548
Index
Multi-input multi-output control systems 
(MIMO control systems), 5, 7, 9, 17, 
185, 343
characteristics, 196
control specifications, 188–189
controller expression, 186–187
counter-flow heat exchanger, 185–186, 187
directionality, 201
disturbance and noise signals, 202
formulation for n × n systems, 192–195
gain and phase, 201–202
heat exchanger, 240–259
input-output pairing, 187–188, 196, 222, 240, 
249, 348, 400–401, 427
interaction analysis, 197–199
loop coupling and controller structure, 
196–197
loop-shaping of controller, 190, 191
matrix performance specifications, 
228–238
H-infinity type specifications into QFT, 
221, 228, 231
MIMO QFT control, 204–207
MIMO QFT robust control. method 1, 
207–220, 240–248, 509–518
coupling matrix, 208–209, 213–214, 
215–217
disturbance rejection, 211–213, 215
example, 240–248
methodology, 218–220
tracking, 209–211, 215
MIMO QFT robust control. method 2, 
220–238, 248–259, 509–518
disturbance rejection at plant input, 
226–227
example, 248–259
reference tracking and disturbance 
rejection at plant output, 221–226
stability, 227–228
multivariable gain and phase, 201
multivariable poles and zeros, 199–201
non-diagonal MIMO QFT, 207–238
plant simulation and discussion, 190–192
effect of poles and zeros, 202
QFT bounds, 189–190
relative gain analysis (RGA), 197–200, 218, 
222–223, 240, 249, 347–348, 400–401, 
403, 404, 427, 510–511, 513
robust control, 509–518
singular value decomposition (SVD), 201
6 × 6 space telescope control, 400
spacecraft flying in formation. deep space, 
442–443
spacecraft flying in formation. low earth 
orbit, 448–449
stability, 203–204
2 × 2 distillation column, 427
2 × 2 flow problem, 445–447
2 × 2 heat exchanger system, 187, 225, 
234–238, 448
2 × 2 linear MIMO system, 234–238
2 × 2 MIMO system, 446–447
2 × 2 wastewater treatment plant, 345
3 × 3 MIMO system, 449
uncertainty, 202–203
Multi-input single-output systems (MISO 
systems), 205
Multi-objective control engineering 
methodology, 5
Multi-tank hydraulic control system, 432
cascade control system, 434
chapters and sections, 432
control specifications, 433
feedforward/feedback control system, 434
modeling, 432–433
project description, 432
questions, 433–435
single feedback control system, 434
Multi-tank hydraulic system, 432–435
Multivariable poles and zeros, 199–202
Multivariable systems, 196
µP, see Microprocessor
N
National Radio Astronomy Observatory 
(NRAO), 365
NC, see Nichols chart
NDC, see Nonlinear dynamic control
Newton’s second law, 21
Nichols chart (NC), 28–30, 140–141
Nyquist stability criterion in, 86–90
stability specification in, 31
Nichols diagram, 139
Nitrates (NO3), 343
Nitrification, 345
nmp systems, see Non-minimum phase 
systems
n × n linear MIMO system, 228–234
n × n systems, formulation for, 192–195
Noise signals, 202
Nominal loop, 381
Nominal plant, 306, 329
QFT robust control, 28
in radio-telescope control, 373
in WWTP, 346

549
Index
Non-diagonal compensators, 206
Non-diagonal controller for 2 × 2 heat 
exchanger MIMO system, 187
Non-diagonal MIMO QFT, 206
comparison of methods 1 and 2, 238–240
coupling effects, 215–217
coupling elements, 213–214
coupling matrix, 208–209
design methodology, 218–220
disturbance rejection at plant input, 211–212, 
226–227
disturbance rejection at plant output, 
212–213
method 1, 207
method 2, 220
method analyses, 207–208
methodology, 222–226
optimal non-diagonal compensator, 214–215
practical issues, 220
quality function of designed compensator, 
217–218
reference tracking and disturbance rejection 
at plant output, 221
reformulation, 221
stability conditions and final 
implementation, 227–228
tracking, 209–211
translating matrix performance 
specifications, 228–238
Non-diagonal sequential techniques, 204, 206
Non-diagonal structure, 210
Nonlinear dynamic control (NDC), 9, 151, 
153, 172, 294, 365, 505–508; see also 
Switching control
anti-windup solution for PID controllers, 
156–163
circle stability criterion, 151–153
control elements
for first channel, 386–389
for second channel, Gp2(s) & prefilter 
Fp(s)—moderate, 389–390
control system with, 153
controller structure, 385–386
equivalent control system with NDC, 154
improving with, 385
inner loop and control element, 390
isolines, 390–391
one nonlinearity, 153–156
one nonlinearity method, 9
PID controller with anti-windup solution 
as, 157
several nonlinearities, 163–182
several nonlinearities method, 9
simulations and discussion, 391–394
Nonlinear functions, 386
Nonlinear robust control
DC motor with saturation. PID with 
nonlinear dynamics, 182–183, 505–508
nonlinear dynamic control: One 
nonlinearity, 153–156
nonlinear dynamic control: Several 
nonlinearities, 163–182
radio telescope servo-system, 394
stability, 151–153
system with actuator saturation. PID with 
anti-wind up, 156–163, 505–508
Nonlinear switching robust controller design 
methodology, 135
Nonlinearity, 152, 283
Non-minimum phase systems (nmp systems), 
80, 82, 99–118, 114, 207, 348; see also 
Time-delay systems
analysis, 114–115
control methodology, 115–117
internal configuration of, 115
minimum phase systems and QFT, 118
and QFT, 118
SP concept to, 117
Nonrational functions, 8
Normalized time delay, 99
Notch filter, 283, 291, 316, 438
NRAO, see National Radio Astronomy 
Observatory
NSC, see Nyquist stability criterion
Numerator/denominator
panels, 458
transfer function, 458
Nyquist criterion for linear systems, 151
Nyquist frequency, 285
Nyquist stability criterion (NSC), 84–86, 169
for DPS, 124
in Nichols chart, 86–90, 485–491
O
ODEs, see Ordinary differential equations
One-dimensional wave equation (1D wave 
equation), 120
One nonlinearity, 153–156
One-point feedback approach, 124
On–off nonlinearity, 168–169
op-amp, see Operational amplifier
Open-loop stable systems, 8, 100–101
Open-loop transfer function, 299
matrix, 396–397
Operational amplifier (op-amp), 279

550
Index
Optimal non-diagonal compensator, 214–215
Ordinary differential equations (ODEs), 119
Override control, 267
control of two variables with one valve. one 
limit, 267
control of two variables with one valve. two 
limits, 368
design methodology, 267
for inverted pendulum, 419
systems, 267–269
topology, 419
Override solutions, 294
P
Pairing problem, 186
Parabolic equations, 120
Parametric uncertainty, 23–27, 203
Parametric uncertainty panel, 456, 459, 461
Parity interlacing property (p.i.p.), 91–92
Partial differential equations (PDEs), 8, 119
modeling approaches for, 120–121
Pasteurization process, 185
PD with negative gain, 281
PDEs, see Partial differential equations
Performance-fragile controller, 297
Performance QFT bounds, 48
Performance specifications, 31–34, 46
Phase margin (PM), 30, 82–84, 95–97, 98
PI algorithm, see Proportional integral
Π-equivalent electrical model, 120, 128
PID controllers, see Proportional integral 
derivative controllers
p.i.p, see Parity interlacing property
Pitch angle, 444
Plant definition window, 456, 457
expressions and parametric uncertainty, 461
gain/zero/pole transfer function, 456–458
gain/zero/pole/delay element syntax, 457
load experimental data, 460–461
load transfer function array, 459–460
numerator/denominator panels, 458
numerator/denominator transfer 
function, 458
probability distribution of parameters, 461
state space, 459
system plant frequency vector, 461–462
Plant models, 45–46, 192–193, 297, 301
ACS for satellite with solar panels, 305
Euler–Lagrange equation, 303–304
frequencies, 306
nominal plant, 306
parametric uncertainty, 305–306
QFT robust control, 19–28
QFT templates, 306, 307
in radio-telescope control, 365–373
satellite with solar panels. model 
description, 302
wind turbine control, 317–329
of WWTP, 343–347
PM, see Phase margin
PMW, see Pulse width modulation
Pointing accuracy, 398
Position accuracy, 398
Position control, 263
Position loop, 384–385
NDC, 391–394
Positional algorithm, 292–294
Powered airplane, 3
Practical quantitative robust control technique, 
119–120
Predefined specifications, 465–466
Prefilter design, 261, 431
examples
airplane flight control, 51
armature-controlled DC motor, 41–51
radio telescope control, 400
satellite control, 309–310
spacecraft telescope, 404
wastewater treatment plant, 257, 350–353, 
353–362: 254
wind turbine control, 332
F(s), 41–42, 77, 311, 312, 334–335
F(s)–QFT prefilter controller design
practical tips, 78
QFTControl Toolbox–prefilter window, 
478–479
synthetize prefilter in Bode diagram, 479
for plant, 132
window, 478–479
Preliminary analysis, 329–330
Preliminary linear controller, 141–142
Probability distribution of parameters, 461, 462
Problems, 439
control of first-order system with 
uncertainty, 439–440
control of third-order state-space system 
with uncertainty, 440–441
field-controlled DC motor, 441–442
formation flying spacecraft control, 
442–443
helicopter control, 443–444
spacecraft flying in formation in low earth 
orbit, 448–449
3 × 3 MIMO system, 449
two cart problem, 444–445

551
Index
two flow problem, 445–446
2 × 2 MIMO system, 446–447
uncertainty, 439
Projects
attitude control of satellite with tanks 
partially filled, 435–439
central heating system control, 428–431
distillation column control, 426–428
DVD-disk head control, 413–415
interconnected micro-grids control, 419–426
inverted pendulum control, 415–419
multi-tank hydraulic control system, 
432–435
2 × 2 distillation column, 427
vehicle active suspension control, 409–413
Proportional integral (PI algorithm), 13
control, 425
with negative gain, 281
Proportional integral derivative controllers 
(PID controllers), 6, 63, 65
analog implementation, 279–284
anti-windup solution for, 156
analysis of controller, 161
circle criterion, 160–162
closed-loop system with central plant, 
162–163
control specifications, 157–159
design of prefilter, 159–160
example, 157
loop-shaping of controller, 159
design with QFT, 69–77
digital implementation, 284–296
2DOF PID controller, 66
examples
armature-controlled DC motor, 19–54, 20, 
36–39, 41, 42, 43
DC motor with saturation. PID with 
nonlinear dynamics, 182–183, 
505–508
first-order system with delay & Smith 
predictor, 103–114
heat conduction distributed temperature 
system, 127–134, 499–500
MIMO QFT control (method 1), 2 × 2 heat 
exchanger system, 248–259, 509–518
MIMO QFT control (method 2), 2 × 2 heat 
exchanger system, 259, 509–518
radio telescope servo-system, 365–394
SISO control of 2 × 2 heat exchanger 
system, 185, 509–518
system with actuator saturation. PID with 
anti-wind up, 156–163, 505–508
wind turbine pitch control, 317–340
I-PD controller, 65
with low-pass filter, 64
with nonlinear dynamics, 182–183, 505–508
PI-D controller, 65, 67
PI-D solutions, 65
position and velocity PID forms, 292–294
with positive gain, 281
PWM implementation, 294–296
saturation and anti-wind up solutions, 
156–163, 505–508
Pulse width modulation (PMW), 294–296
control signal, 295
Q
QFT, see Quantitative feedback theory
QFT-bounds, 34–39, 72, 113, 204, 301, 309–311, 
332–334, 472
azimuth axis–position control, 380
azimuth axis–velocity control, 375–376
bound for matrix performance specifications 
(MIMO systems), 228–238
bounds for distributed parameter systems, 
124–134
compatibility of specifications, 39, 472
definition, 34–39, 472
for disturbance rejection specification, 61
and G(s) design, loop shaping, 61
intersection of bounds, 38, 472
for model-matching specification, 56
quadratic inequalities, 34, 35, 472
QFT Control Toolbox (QFTCT), 5, 17–18, 130, 357, 
360, 451, 452
analysis window, 51, 52, 479–483
bounds window, 48, 472
common toolbars, 454
controller design window, 48, 51, 473–478
design process, 453
2DOF control system, 451, 452
file menu, controller design window, check 
stability, 455
general description, 452–456
for MATLAB, 7
plant definition window, 45, 46, 454, 
456–462
prefilter design window, 51, 478–479
QFT design procedure and QFTCT 
windows, 452
QFT flowchart for MISO control system, 453
specifications window, 46, 465–472
templates window, 46, 462–465
window toolbar with seven window 
categories, 454

552
Index
QFTCT, see QFT Control Toolbox
QFT extension to DPS, 124
control specifications, 129–131
controller design, 131–132
feedback specifications for DPS, 125
loop shaping, 131
modeling, 127–129
QFT DPS control design methodology, 127
quadratic inequalities for DPS, 126
simulations, 132–134
QFT robust control, 17, 77; see also Quantitative 
feedback theory (QFT)
airplane flight control, 45–54
analysis and validation, 42–54, 479–483
using analytical and experimental 
techniques, 20
armature-controlled DC motor, 20–28, 36–39, 
41, 42, 43, 66–68
basic examples
airplane flight control, 45–54, 55–58, 
59–63
armature-controlled DC motor, 20–28, 
36–39, 41–42, 43–45, 66–68
controller design, 39–41, 473–476
G(s)—loop shaping, 39–41
loop-shaping, 39–41, 74–77, 473–476
Stability, 39–41, 473–476, 485–491
controller design practical tips, 69–77
loop-shaping: designing G(s), 74–77
Prefilter: designing F(s), 77
selection of specifications: stability, 
sensitivity, tracking, 69–74
feedforward control for disturbance 
rejection with QFT, 59–63, 
263–267
airplane flight control, 59–63
design, 59–63
frequency domain, 43, 44
frequencies of interest, 19–28, 456–462
loop shaping—designing G(s), 74–77
model matching specifications with QFT 
(or feedforward for tracking), 54–58, 
263–267
airplane flight control, 54–58
design, 54–58
model uncertainty, 19–28, 448–449, 
456–462
nominal plant, 28, 465
performance specifications, 31–34, 
465–472
complementary sensitivity, 32, 467
control effort reduction, 33, 467
distributed parameter systems 
specifications, 124–134
disturbance rejection at plant input, 
33, 467
general specification, 33–34, 467
matrix performance specifications 
(MIMO systems), 228–238
reference tracking, 33, 71–74, 467
sensitivity /Disturbance rejection at plant 
output, 33, 69–71, 467
PID control with QFT, 63–68
armature-controlled DC motor, 66–68
design, 63–68
plant modelling, 19–28, 456–462
prefilter design, 41–42, 77, 478–479
prefilter—designing F(s), 77
QFT-bounds, 34–39, 472
bound for matrix performance 
specifications (MIMO systems), 
228–238
bounds for distributed parameter 
systems, 124–134
compatibility of specifications, 39, 472
definition, 34–39, 472
intersection of bounds, 38, 472
quadratic inequalities, 34, 35, 472
QFT Control Toolbox (QFTCT) User’s guide, 
451–483
QFT-controller design methodology, 18
QFT templates, 28–30, 462–465
reference tracking, 71–74
analysis, 44
robust control engineering, 4–7
robust control method, 265
sensitivity or plant output disturbance 
rejection, 45
sensitivity specifications, 69–71
stability analysis, 43, 44
stability specifications, 30–31, 69, 465–472
time domain, 44
QFT templates, 306, 307
azimuth axis–position control, 378
azimuth axis–velocity control, 374
Quadratic inequalities for DPS, 126
Quality function of designed compensator, 
217–218
Quantitative feedback theory (QFT), 4, 17, 141, 
204; see also QFT robust control
cascade control solution for radio telescope 
servo system, 263
fragility analysis with, 296–299
method, 8–9
philosophy, 141

553
Index
Quantitative robust control, 7, 119, 451
Quantization, 291–292
R
Radio astronomy, 365
Ratio control systems, 269–270
control of ratio between two variables, one 
valve, 269
control of ratio between two variables, two 
valves, 270
design methodology, 269
with two sensors, two actuators and 
feedforward, 271
Radio-telescope control
azimuth axis–position control, 378–383
azimuth axis–velocity control, 374–378
azimuth model description, 366
frequencies, 372–373
GBT, 366
improving with NDC, 385–394
inputs, 366
nominal plant, 373
outputs, 366
parameters, 366–371
parametric uncertainty, 371
plant model, 365
preliminary analysis, 373–374
simulation, 384–385
Radio telescope servo-system, 365–394
azimuth axis. position control loop, 378–383, 
385–394
azimuth axis. velocity control loop, 374–378
RC, see Resistor–capacitor
Real pole and negative gain, 282
Rear rudder, 80
Reference tracking, 71–74, 266–267
bounds, 310
model matching, 266
specification, 33, 35, 37, 47, 112, 309
azimuth axis–position control, 379
WWTP, 349
Relative Disturbance Gain, 198
Relative gain analysis (RGA), 197–200, 218, 
222–223, 240, 249, 347–348, 400–401, 
403, 404, 427, 510–511, 513
Relative Gain Array, see Relative gain analysis 
(RGA)
Relay nonlinearity, 168
Resistor–capacitor (RC), 9, 279
Resonance, 307
RGA, see Relative gain analysis
Right half plane (RHP), 85, 100, 195
Ringing, 291
Robust 2 × 2 MIMO QFT control system, 10
Robust control
engineering, 5, 11
practical QFT solutions, 7
QFT, 4–7
methodology, 5, 19
QFT control system, 10
theory, 140
Robust stability, 398–399
Rotor speed, 2
S
SAAB Gripen JAS-39 airplane accident, 80
“Safety bicycle”, 79
Sampler and hold (S&H), 285–288
Sampler(s), 286
Sampling
continuous-time signal, 285
frequency, 285
process, 285
S&H, see Sampler and hold
Satellite, 9
Satellite control;  see also wind turbine 
control
analysis and validation, 311
attitude and position control, 395–407
bode diagram, 308
control specifications, 308–309
control system, 312
controller design, 309–311
frequency-domain, 307
analysis, 313
hispasat. telecommunication satellite with 
solar panels, 302
notch filter, 316
plant model, 301–306, 307
preliminary analysis, 306
satellite with flexible appendages, 301, 
395–407
satellites flying in formation. deep space, 
442–443
satellites flying in formation. low earth orbit, 
448–449
solar panels oscillation, 315
space technology, 301
space telescope control, 395–407
time-domain analysis, 314
Saturation limits, 398
Saturation nonlinearity, 167
s/c, see Spacecraft
Schauder’s fixed point theorem, 205

554
Index
s-domain expressions, 288
Selector control, see Override control
Sensitivity
bounds, 310
or disturbances at plant output specification, 
33, 35, 37
at plant output specification, 308
azimuth axis–position control, 379
NDC, 386
at plant output specification
WWTP, 349
reduction, 399
specifications, 69–71
Sensors, 279
output, 444
Sequential non-diagonal MIMO robust QFT 
control strategies, 10
Several nonlinearities, nonlinear dynamic 
control, 163
DF technique, 164–169
Shannon sampling theorem, 285
Single-input single-output systems (SISO 
systems), 5, 17, 185; see also Multi-input 
multi-output control systems (MIMO 
control systems)
independent SISO QFT control
controller structure, 350
design of 2 × 2 diagonal matrix Gi(s) 
controller and prefilter F(s), 350–353
QFT loop-shaping technique, 241–242
Singular-G method, 207
Singular Value Decomposition (SVD), 201
SISO systems, see Single-input single-output 
systems
Sloshing effect, 435
Small-gain theorem, 204
Small-phase theorem, 204
Smith-McMillan poles, 204
Smith predictor (SP), 8, 100, 430, 431
characteristics of SP, 102–103
loop-shaping of controller, 113
model-plant mismatch, 106
reference tracking problem, 105
robust control, 493–497
robust design of, 103
two-algorithm technique, 106–114
Solar panels, 301
vibration attenuation, 310
Solar pressure perturbation, 399
SP, see Smith predictor
Space technology, 301
Spacecraft (s/c), 448
control, see Satellite control
flying in formation in low earth orbit, 448–449
telescopes, 395
control specifications, 398–400
control system design, 400–405
with large flexible appendages, 396
simulation and validation, 405–407
system description and modeling, 
395–397
Spatial distribution, 8
Specifications window, 465–472
“Spillover” effects, 124
Split-range control
control of one variable with two 
valves, 274
design methodology, 273–274, 275
Split-range solutions, 294
Stability
analysis, 52, 142
bounds, 309–310
in QFT, 48
circle criterion, 151–153
common quadratic Lyapunov functions 
(CQLF), 136
conditions, 227–228
in MIMO QFT methods 1 and 2, 
227–234:238–239
gain and phase margins, 82–84
iso-lines, 169–182
of MIMO systems, 203–204
Nyquist stability criterion, 84–86
in Nichols chart, 86–89, 485–491
practical selection of stability specification, 69
QFT bounds, 48
specifications, 30–31, 32, 34, 36, 46, 69, 
112, 308
azimuth axis–position control, 379
azimuth axis–velocity control, 375
NDC, 386
in QFT, 30–31
in WWTP, 348
system stability under switching, 135–141
Ws circles, 82–84
Stability-fragile controller, 297
State space, 459
State vector, 417
Stiffness matrices, 303, 437
Structured singular value SSV, 204
Structured uncertainty, 203
SVD, see Singular Value Decomposition
Switching
algorithm, 294
and bumpless algorithms, 294
function, 142

555
Index
Switching control, 135–136; see also Nonlinear 
dynamic control
CQLF existing, 145
CQLF not existing, 143–145
examples, 142
methodology, 141–142
Nichols chart, 148
response to unit step reference 
tracking, 149
solution for ACC’92 benchmark problem, 
146–147
system stability under switching, 135–141
Synthesis techniques, 204
System plant frequency vector, 461–462
System stability under switching, 135
circle criterion, 137–138
closed-loop systems, 136–137
complex plane, 139
criterion for continuous switching, 140
Nichols chart, 140–141
switching control scheme, 135–136
SystemPlant, 459
T
Taylor series, 121
Telecommunication satellite with solar 
panels, 302
Telescope, 365
azimuth-axis servo system, 374
flyer, 396
Temperature-distributed prismatic plant, 127
Templates
QFT, 28–30
window, 462–465
TFM, see Transfer function matrix
TFs, see Transfer functions
Three-dimensional Bode diagram (3D Bode 
diagram), 124
Thrust force (FT), 322, 323
Time-delay systems, 99–118, 288; see also 
Non-minimum phase systems (nmp 
systems)
Bode’s integral expressions, 100
central heating system with long time 
delays, 428–431
characteristics of SP, 102–103
definition, 99–103, 106
first-order system with time-delay, 118, 
493–497
open-loop stable systems, 100–101
Smith predictor and QFT, 103–114, 118
time-delay model, 101
Time-domain
analysis, 314, 336, 338
differential equation for PID, 64
Time-response analysis of control system, 61
Transfer function matrix (TFM), 209
Transfer functions (TFs), 23, 119, 265, 417
Translating matrix performance 
specifications, 228
2 × 2 linear MIMO system, 234–238
n × n linear MIMO system, 228–234
Tustin approximation, 289
Two-algorithm technique, 106–114
Two cart problem, 142–147, 444–445, 501–503
Two complementary controllers, 142
Two-degree of freedom (2DOF), 31
control structure, 261
control system, 32, 301, 451, 452
MIMO system, 208
Two-dimensional space problem (2D space 
problem), 124
Two flow problem control, 445–446
Two-mass-spring benchmark system, 142–147, 
444–445, 501–503
Two-point feedback approach, 124
U
Uncertainty, 45–46, 439
of MIMO, 202–203
Unstable systems, 79–98
closed-loop control system, 81
definition, 79–82
design of control solutions to stabilize 
plants, 91–95
examples, 89–90, 92–95
minimum phase unstable systems, 89–90, 
92–95
non-minimum phase unstable systems, 
89–90, 92–95
fundamental theorem of feedback control, 92
gain/phase margins and Ws circles, 82–84
GM, 82–84, 95–97, 98
guidelines to design controllers, 91
inverted pendulum, 80
NSC, 84–86
Nyquist stability criterion, 84–86
in Nichols chart, 86–89, 485–491
Nyquist stability criterion in Nichols chart, 
86–90
parity interlacing property, 91–92
PM, 82–84, 95–97, 98
Wright brothers’ unstable airplane, 80
Ws circles, 82–84, 95–97, 98

556
Index
User-defined specifications, 466–468
V
Vehicle acceleration, 411
Vehicle active suspension control, 409, 410
Bode diagram for nominal plants, 412
chapters and sections, 409
control diagram for active suspension 
system, 412
control specifications, 412–413
modeling, 409–411
preliminary analysis, 411–412
project description, 409
questions, 413
Velocity
algorithm, 292–294
control, 263
loop, 384–385
NDC, 391–394
Voltage, 20
W
Wastewater treatment plant control 
(WWTP), 343
ammonia concentration control, 343
analysis and validation, 362–363
ASP-WWTP configuration, 344
control specifications, 348–349
controller design, 349
Crispijana, Spain, 344
frequencies, 346, 347
independent SISO QFT control, 350–353
IWA, 346
MIMO QFT control, 353–362
nitrates concentration control, 343
nominal plant, 346
plant model, 343
preliminary analysis, 347–348
Waterbed effect, 81
Weighting matrices, 196
Weirstrass factorization, 121
Wind disturbances, 375
Wind turbine, 2, 3
Wind turbine control, 317
analysis and validation, 336–339
control specifications, 330–332
controller design, 332–335
Euler–Lagrange equation, 320
flap-wise blades vibration attenuation, 333
fore-aft tower vibration attenuation, 333
frequencies, 328
frequency-domain analysis, 337
generalized coordinates for wind turbine, 
320
higher wind velocities, 339–340
inputs, 318–319
nominal plant, 329
outputs, 319
parameters, 319
parametric uncertainty, 325–328
pitch control system, 317
plant model, 317
preliminary analysis, 329–330
QFT templates, 329
rotor speed control /pitch control, 317
rotor speed linear transfer functions, 325
state space description of system, 321
time domain, 338
tower fore-aft oscillation, 338
transfer functions of actuators, 324
transfer matrix, 323
TWT-1. 65 variable-speed pitch-controlled 
wind turbine, 318
variable-speed pitch-controlled gearless 
wind turbine, 318
Wing-warping system, 80
Ws circles, 82–84, 95–97, 98
WWTP, see Wastewater treatment plant control
X
xy-space problem, 124
xyz-space problem, 124
Y
Yaw control system, 3–4
Z
z-domain expressions, 288
Zero-order hold (ZOH), 287

