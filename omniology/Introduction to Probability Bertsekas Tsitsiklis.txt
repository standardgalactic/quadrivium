
LECTURE NOTES
Course 6.041-6.431
M.I.T.
FALL 2000
Introduction to Probability
Dimitri P. Bertsekas and John N. Tsitsiklis
Professors of Electrical Engineering and Computer Science
Massachusetts Institute of Technology
Cambridge, Massachusetts
These notes are copyright-protected but may be freely distributed for
instructional nonproﬁt pruposes.


Contents
1. Sample Space and Probability
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
1.1. Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1.2. Probabilistic Models . . . . . . . . . . . . . . . . . . . . . . .
1.3. Conditional Probability
. . . . . . . . . . . . . . . . . . . . .
1.4. Independence . . . . . . . . . . . . . . . . . . . . . . . . . .
1.5. Total Probability Theorem and Bayes’ Rule
. . . . . . . . . . . .
1.6. Counting
. . . . . . . . . . . . . . . . . . . . . . . . . . .
1.7. Summary and Discussion
. . . . . . . . . . . . . . . . . . . .
2. Discrete Random Variables
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
2.1. Basic Concepts . . . . . . . . . . . . . . . . . . . . . . . . .
2.2. Probability Mass Functions
. . . . . . . . . . . . . . . . . . .
2.3. Functions of Random Variables . . . . . . . . . . . . . . . . . .
2.4. Expectation, Mean, and Variance . . . . . . . . . . . . . . . . .
2.5. Joint PMFs of Multiple Random Variables . . . . . . . . . . . . .
2.6. Conditioning . . . . . . . . . . . . . . . . . . . . . . . . . .
2.7. Independence . . . . . . . . . . . . . . . . . . . . . . . . . .
2.8. Summary and Discussion
. . . . . . . . . . . . . . . . . . . .
3. General Random Variables
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
3.1. Continuous Random Variables and PDFs
. . . . . . . . . . . . .
3.2. Cumulative Distribution Functions
. . . . . . . . . . . . . . . .
3.3. Normal Random Variables . . . . . . . . . . . . . . . . . . . .
3.4. Conditioning on an Event
. . . . . . . . . . . . . . . . . . . .
3.5. Multiple Continuous Random Variables
. . . . . . . . . . . . . .
3.6. Derived Distributions
. . . . . . . . . . . . . . . . . . . . . .
3.7. Summary and Discussion
. . . . . . . . . . . . . . . . . . . .
4. Further Topics on Random Variables and Expectations .
.
.
.
.
.
4.1. Transforms . . . . . . . . . . . . . . . . . . . . . . . . . . .
4.2. Sums of Independent Random Variables - Convolutions
. . . . . . .
iii

iv
Contents
4.3. Conditional Expectation as a Random Variable . . . . . . . . . . .
4.4. Sum of a Random Number of Independent Random Variables
. . . .
4.5. Covariance and Correlation
. . . . . . . . . . . . . . . . . . .
4.6. Least Squares Estimation
. . . . . . . . . . . . . . . . . . . .
4.7. The Bivariate Normal Distribution
. . . . . . . . . . . . . . . .
5. The Bernoulli and Poisson Processes .
.
.
.
.
.
.
.
.
.
.
.
.
.
5.1. The Bernoulli Process . . . . . . . . . . . . . . . . . . . . . .
5.2. The Poisson Process . . . . . . . . . . . . . . . . . . . . . . .
6. Markov Chains
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
6.1. Discrete-Time Markov Chains
. . . . . . . . . . . . . . . . . .
6.2. Classiﬁcation of States . . . . . . . . . . . . . . . . . . . . . .
6.3. Steady-State Behavior . . . . . . . . . . . . . . . . . . . . . .
6.4. Absorption Probabilities and Expected Time to Absorption
. . . . .
6.5. More General Markov Chains . . . . . . . . . . . . . . . . . . .
7. Limit Theorems .
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
.
7.1. Some Useful Inequalities . . . . . . . . . . . . . . . . . . . . .
7.2. The Weak Law of Large Numbers . . . . . . . . . . . . . . . . .
7.3. Convergence in Probability . . . . . . . . . . . . . . . . . . . .
7.4. The Central Limit Theorem
. . . . . . . . . . . . . . . . . . .
7.5. The Strong Law of Large Numbers
. . . . . . . . . . . . . . . .

Preface
These class notes are the currently used textbook for “Probabilistic Systems
Analysis,” an introductory probability course at the Massachusetts Institute of
Technology. The text of the notes is quite polished and complete, but the prob-
lems are less so.
The course is attended by a large number of undergraduate and graduate
students with diverse backgrounds. Acccordingly, we have tried to strike a bal-
ance between simplicity in exposition and sophistication in analytical reasoning.
Some of the more mathematically rigorous analysis has been just sketched or
intuitively explained in the text, so that complex proofs do not stand in the way
of an otherwise simple exposition. At the same time, some of this analysis and
the necessary mathematical results are developed (at the level of advanced calcu-
lus) in theoretical problems, which are included at the end of the corresponding
chapter. The theoretical problems (marked by *) constitute an important com-
ponent of the text, and ensure that the mathematically oriented reader will ﬁnd
here a smooth development without major gaps.
We give solutions to all the problems, aiming to enhance the utility of
the notes for self-study. We have additional problems, suitable for homework
assignment (with solutions), which we make available to instructors.
Our intent is to gradually improve and eventually publish the notes as a
textbook, and your comments will be appreciated
Dimitri P. Bertsekas
bertsekas@lids.mit.edu
John N. Tsitsiklis
jnt@mit.edu
v

1
Sample Space and
Probability
Contents
1.1. Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 3
1.2. Probabilistic Models . . . . . . . . . . . . . . . . . . . . p. 6
1.3. Conditional Probability
. . . . . . . . . . . . . . . . .
p. 16
1.4. Total Probability Theorem and Bayes’ Rule
. . . . . . . .
p. 25
1.5. Independence . . . . . . . . . . . . . . . . . . . . . .
p. 31
1.6. Counting
. . . . . . . . . . . . . . . . . . . . . . .
p. 41
1.7. Summary and Discussion
. . . . . . . . . . . . . . . .
p. 48
1

2
Sample Space and Probability
Chap. 1
“Probability” is a very useful concept, but can be interpreted in a number of
ways. As an illustration, consider the following.
A patient is admitted to the hospital and a potentially life-saving drug is
administered.
The following dialog takes place between the nurse and a
concerned relative.
RELATIVE: Nurse, what is the probability that the drug will work?
NURSE: I hope it works, we’ll know tomorrow.
RELATIVE: Yes, but what is the probability that it will?
NURSE: Each case is diﬀerent, we have to wait.
RELATIVE: But let’s see, out of a hundred patients that are treated under
similar conditions, how many times would you expect it to work?
NURSE (somewhat annoyed): I told you, every person is diﬀerent, for some
it works, for some it doesn’t.
RELATIVE (insisting): Then tell me, if you had to bet whether it will work
or not, which side of the bet would you take?
NURSE (cheering up for a moment):
I’d bet it will work.
RELATIVE (somewhat relieved):
OK, now, would you be willing to lose
two dollars if it doesn’t work, and gain one dollar if it does?
NURSE (exasperated):
What a sick thought! You are wasting my time!
In this conversation, the relative attempts to use the concept of probability to
discuss an uncertain situation. The nurse’s initial response indicates that the
meaning of “probability” is not uniformly shared or understood, and the relative
tries to make it more concrete. The ﬁrst approach is to deﬁne probability in
terms of frequency of occurrence, as a percentage of successes in a moderately
large number of similar situations. Such an interpretation is often natural. For
example, when we say that a perfectly manufactured coin lands on heads “with
probability 50%,” we typically mean “roughly half of the time.” But the nurse
may not be entirely wrong in refusing to discuss in such terms. What if this
was an experimental drug that was administered for the very ﬁrst time in this
hospital or in the nurse’s experience?
While there are many situations involving uncertainty in which the fre-
quency interpretation is appropriate, there are other situations in which it is
not. Consider, for example, a scholar who asserts that the Iliad and the Odyssey
were composed by the same person, with probability 90%. Such an assertion
conveys some information, but not in terms of frequencies, since the subject is
a one-time event. Rather, it is an expression of the scholar’s subjective be-
lief. One might think that subjective beliefs are not interesting, at least from a
mathematical or scientiﬁc point of view. On the other hand, people often have
to make choices in the presence of uncertainty, and a systematic way of making
use of their beliefs is a prerequisite for successful, or at least consistent, decision

Sec. 1.1
Sets
3
making.
In fact, the choices and actions of a rational person, can reveal a lot about
the inner-held subjective probabilities, even if the person does not make conscious
use of probabilistic reasoning. Indeed, the last part of the earlier dialog was an
attempt to infer the nurse’s beliefs in an indirect manner. Since the nurse was
willing to accept a one-for-one bet that the drug would work, we may infer
that the probability of success was judged to be at least 50%. And had the
nurse accepted the last proposed bet (two-for-one), that would have indicated a
success probability of at least 2/3.
Rather than dwelling further into philosophical issues about the appropri-
ateness of probabilistic reasoning, we will simply take it as a given that the theory
of probability is useful in a broad variety of contexts, including some where the
assumed probabilities only reﬂect subjective beliefs. There is a large body of
successful applications in science, engineering, medicine, management, etc., and
on the basis of this empirical evidence, probability theory is an extremely useful
tool.
Our main objective in this book is to develop the art of describing un-
certainty in terms of probabilistic models, as well as the skill of probabilistic
reasoning. The ﬁrst step, which is the subject of this chapter, is to describe
the generic structure of such models, and their basic properties. The models we
consider assign probabilities to collections (sets) of possible outcomes. For this
reason, we must begin with a short review of set theory.
1.1
SETS
Probability makes extensive use of set operations, so let us introduce at the
outset the relevant notation and terminology.
A set is a collection of objects, which are the elements of the set. If S is
a set and x is an element of S, we write x ∈S. If x is not an element of S, we
write x /∈S. A set can have no elements, in which case it is called the empty
set, denoted by Ø.
Sets can be speciﬁed in a variety of ways. If S contains a ﬁnite number of
elements, say x1, x2, . . . , xn, we write it as a list of the elements, in braces:
S = {x1, x2, . . . , xn}.
For example, the set of possible outcomes of a die roll is {1, 2, 3, 4, 5, 6}, and the
set of possible outcomes of a coin toss is {H, T}, where H stands for “heads”
and T stands for “tails.”
If S contains inﬁnitely many elements x1, x2, . . ., which can be enumerated
in a list (so that there are as many elements as there are positive integers) we
write
S = {x1, x2, . . .},

4
Sample Space and Probability
Chap. 1
and we say that S is countably inﬁnite. For example, the set of even integers
can be written as {0, 2, −2, 4, −4, . . .}, and is countably inﬁnite.
Alternatively, we can consider the set of all x that have a certain property
P, and denote it by
{x | x satisﬁes P}.
(The symbol “|” is to be read as “such that.”) For example the set of even
integers can be written as {k | k/2 is integer}. Similarly, the set of all scalars x
in the interval [0, 1] can be written as {x | 0 ≤x ≤1}. Note that the elements x
of the latter set take a continuous range of values, and cannot be written down
in a list (a proof is sketched in the theoretical problems); such a set is said to be
uncountable.
If every element of a set S is also an element of a set T, we say that S
is a subset of T, and we write S ⊂T or T ⊃S. If S ⊂T and T ⊂S, the
two sets are equal, and we write S = T. It is also expedient to introduce a
universal set, denoted by Ω, which contains all objects that could conceivably
be of interest in a particular context. Having speciﬁed the context in terms of a
universal set Ω, we only consider sets S that are subsets of Ω.
Set Operations
The complement of a set S, with respect to the universe Ω, is the set {x ∈
Ω| x /∈S} of all elements of Ωthat do not belong to S, and is denoted by Sc.
Note that Ωc = Ø.
The union of two sets S and T is the set of all elements that belong to S
or T (or both), and is denoted by S ∪T. The intersection of two sets S and T
is the set of all elements that belong to both S and T, and is denoted by S ∩T.
Thus,
S ∪T = {x | x ∈S or x ∈T},
S ∩T = {x | x ∈S and x ∈T}.
In some cases, we will have to consider the union or the intersection of several,
even inﬁnitely many sets, deﬁned in the obvious way. For example, if for every
positive integer n, we are given a set Sn, then
∞

n=1
Sn = S1 ∪S2 ∪· · · = {x | x ∈Sn for some n},
and
∞

n=1
Sn = S1 ∩S2 ∩· · · = {x | x ∈Sn for all n}.
Two sets are said to be disjoint if their intersection is empty. More generally,
several sets are said to be disjoint if no two of them have a common element. A
collection of sets is said to be a partition of a set S if the sets in the collection
are disjoint and their union is S.

Sec. 1.1
Sets
5
If x and y are two objects, we use (x, y) to denote the ordered pair of x
and y.
The set of scalars (real numbers) is denoted by ℜ; the set of pairs (or
triplets) of scalars, i.e., the two-dimensional plane (or three-dimensional space,
respectively) is denoted by ℜ2 (or ℜ3, respectively).
Sets and the associated operations are easy to visualize in terms of Venn
diagrams, as illustrated in Fig. 1.1.
S
T
Ω
T
Ω
Ω
S
S
T
(a)
(b)
S
T
Ω
(c)
S
T
Ω
(d)
(e)
U
S
T
Ω
(f)
U
Figure 1.1: Examples of Venn diagrams. (a) The shaded region is S ∩T. (b)
The shaded region is S ∪T. (c) The shaded region is S ∩T c. (d) Here, T ⊂S.
The shaded region is the complement of S. (e) The sets S, T, and U are disjoint.
(f) The sets S, T, and U form a partition of the set Ω.
The Algebra of Sets
Set operations have several properties, which are elementary consequences of the
deﬁnitions. Some examples are:
S ∪T = T ∪S,
S ∪(T ∪U) = (S ∪T) ∪U,
S ∩(T ∪U) = (S ∩T) ∪(S ∩U),
S ∪(T ∩U) = (S ∪T) ∩(S ∪U),
(Sc)c = S,
S ∩Sc = Ø,
S ∪Ω= Ω,
S ∩Ω= S.
Two particularly useful properties are given by de Morgan’s laws which
state that

n
Sn
c
=

n
Scn,

n
Sn
c
=

n
Scn.
To establish the ﬁrst law, suppose that x ∈(∪nSn)c. Then, x /∈∪nSn, which
implies that for every n, we have x /∈Sn. Thus, x belongs to the complement

6
Sample Space and Probability
Chap. 1
of every Sn, and xn ∈∩nScn. This shows that (∪nSn)c ⊂∩nScn. The converse
inclusion is established by reversing the above argument, and the ﬁrst law follows.
The argument for the second law is similar.
1.2
PROBABILISTIC MODELS
A probabilistic model is a mathematical description of an uncertain situation.
It must be in accordance with a fundamental framework that we discuss in this
section. Its two main ingredients are listed below and are visualized in Fig. 1.2.
Elements of a Probabilistic Model
• The sample space Ω, which is the set of all possible outcomes of an
experiment.
• The probability law, which assigns to a set A of possible outcomes
(also called an event) a nonnegative number P(A) (called the proba-
bility of A) that encodes our knowledge or belief about the collective
“likelihood” of the elements of A. The probability law must satisfy
certain properties to be introduced shortly.
Experiment
Sample Space Ω
(Set of Outcomes)
Event A
Event B
A
B
Events
P(A)
P(B)
Probability
Law
Figure 1.2: The main ingredients of a probabilistic model.
Sample Spaces and Events
Every probabilistic model involves an underlying process, called the experi-
ment, that will produce exactly one out of several possible outcomes. The set
of all possible outcomes is called the sample space of the experiment, and is
denoted by Ω. A subset of the sample space, that is, a collection of possible

Sec. 1.2
Probabilistic Models
7
outcomes, is called an event.† There is no restriction on what constitutes an
experiment. For example, it could be a single toss of a coin, or three tosses,
or an inﬁnite sequence of tosses. However, it is important to note that in our
formulation of a probabilistic model, there is only one experiment. So, three
tosses of a coin constitute a single experiment, rather than three experiments.
The sample space of an experiment may consist of a ﬁnite or an inﬁnite
number of possible outcomes. Finite sample spaces are conceptually and math-
ematically simpler. Still, sample spaces with an inﬁnite number of elements are
quite common. For an example, consider throwing a dart on a square target and
viewing the point of impact as the outcome.
Choosing an Appropriate Sample Space
Regardless of their number, diﬀerent elements of the sample space should be
distinct and mutually exclusive so that when the experiment is carried out,
there is a unique outcome. For example, the sample space associated with the
roll of a die cannot contain “1 or 3” as a possible outcome and also “1 or 4” as
another possible outcome. When the roll is a 1, the outcome of the experiment
would not be unique.
A given physical situation may be modeled in several diﬀerent ways, de-
pending on the kind of questions that we are interested in. Generally, the sample
space chosen for a probabilistic model must be collectively exhaustive, in the
sense that no matter what happens in the experiment, we always obtain an out-
come that has been included in the sample space. In addition, the sample space
should have enough detail to distinguish between all outcomes of interest to the
modeler, while avoiding irrelevant details.
Example 1.1.
Consider two alternative games, both involving ten successive coin
tosses:
Game 1: We receive $1 each time a head comes up.
Game 2: We receive $1 for every coin toss, up to and including the ﬁrst time
a head comes up. Then, we receive $2 for every coin toss, up to the second
time a head comes up. More generally, the dollar amount per toss is doubled
each time a head comes up.
† Any collection of possible outcomes, including the entire sample space Ωand
its complement, the empty set Ø, may qualify as an event. Strictly speaking, however,
some sets have to be excluded. In particular, when dealing with probabilistic models
involving an uncountably inﬁnite sample space, there are certain unusual subsets for
which one cannot associate meaningful probabilities. This is an intricate technical issue,
involving the mathematics of measure theory. Fortunately, such pathological subsets
do not arise in the problems considered in this text or in practice, and the issue can be
safely ignored.

8
Sample Space and Probability
Chap. 1
In game 1, it is only the total number of heads in the ten-toss sequence that mat-
ters, while in game 2, the order of heads and tails is also important.
Thus, in
a probabilistic model for game 1, we can work with a sample space consisting of
eleven possible outcomes, namely, 0, 1, . . . , 10. In game 2, a ﬁner grain description
of the experiment is called for, and it is more appropriate to let the sample space
consist of every possible ten-long sequence of heads and tails.
Sequential Models
Many experiments have an inherently sequential character, such as for example
tossing a coin three times, or observing the value of a stock on ﬁve successive
days, or receiving eight successive digits at a communication receiver. It is then
often useful to describe the experiment and the associated sample space by means
of a tree-based sequential description, as in Fig. 1.3.
1
1
2
2
3
3
4
4
Sequential Tree
Description
Sample Space
Pair of Rolls
1st Roll
2nd Roll
1, 1
1, 2
1, 3
1, 4
1
2
3
4
Root
Leaves
Figure 1.3: Two equivalent descriptions of the sample space of an experiment
involving two rolls of a 4-sided die. The possible outcomes are all the ordered pairs
of the form (i, j), where i is the result of the ﬁrst roll, and j is the result of the
second. These outcomes can be arranged in a 2-dimensional grid as in the ﬁgure
on the left, or they can be described by the tree on the right, which reﬂects the
sequential character of the experiment. Here, each possible outcome corresponds
to a leaf of the tree and is associated with the unique path from the root to that
leaf. The shaded area on the left is the event {(1, 4), (2, 4), (3, 4), (4, 4)} that the
result of the second roll is 4. That same event can be described as a set of leaves,
as shown on the right. Note also that every node of the tree can be identiﬁed with
an event, namely, the set of all leaves downstream from that node. For example,
the node labeled by a 1 can be identiﬁed with the event {(1, 1), (1, 2), (1, 3), (1, 4)}
that the result of the ﬁrst roll is 1.
Probability Laws
Suppose we have settled on the sample space Ωassociated with an experiment.

Sec. 1.2
Probabilistic Models
9
Then, to complete the probabilistic model, we must introduce a probability
law. Intuitively, this speciﬁes the “likelihood” of any outcome, or of any set of
possible outcomes (an event, as we have called it earlier). More precisely, the
probability law assigns to every event A, a number P(A), called the probability
of A, satisfying the following axioms.
Probability Axioms
1. (Nonnegativity) P(A) ≥0, for every event A.
2. (Additivity) If A and B are two disjoint events, then the probability
of their union satisﬁes
P(A ∪B) = P(A) + P(B).
Furthermore, if the sample space has an inﬁnite number of elements
and A1, A2, . . . is a sequence of disjoint events, then the probability of
their union satisﬁes
P(A1 ∪A2 ∪· · ·) = P(A1) + P(A2) + · · ·
3. (Normalization) The probability of the entire sample space Ωis
equal to 1, that is, P(Ω) = 1.
In order to visualize a probability law, consider a unit of mass which is
to be “spread” over the sample space. Then, P(A) is simply the total mass
that was assigned collectively to the elements of A. In terms of this analogy, the
additivity axiom becomes quite intuitive: the total mass in a sequence of disjoint
events is the sum of their individual masses.
A more concrete interpretation of probabilities is in terms of relative fre-
quencies: a statement such as P(A) = 2/3 often represents a belief that event A
will materialize in about two thirds out of a large number of repetitions of the
experiment. Such an interpretation, though not always appropriate, can some-
times facilitate our intuitive understanding. It will be revisited in Chapter 7, in
our study of limit theorems.
There are many natural properties of a probability law which have not been
included in the above axioms for the simple reason that they can be derived
from them.
For example, note that the normalization and additivity axioms
imply that
1 = P(Ω) = P(Ω∪Ø) = P(Ω) + P(Ø) = 1 + P(Ø),
and this shows that the probability of the empty event is 0:
P(Ø) = 0.

10
Sample Space and Probability
Chap. 1
As another example, consider three disjoint events A1, A2, and A3. We can use
the additivity axiom for two disjoint events repeatedly, to obtain
P(A1 ∪A2 ∪A3) = P

A1 ∪(A2 ∪A2)

= P(A1) + P(A2 ∪A3)
= P(A1) + P(A2) + P(A3).
Proceeding similarly, we obtain that the probability of the union of ﬁnitely many
disjoint events is always equal to the sum of the probabilities of these events.
More such properties will be considered shortly.
Discrete Models
Here is an illustration of how to construct a probability law starting from some
common sense assumptions about a model.
Example 1.2.
Coin tosses.
Consider an experiment involving a single coin
toss. There are two possible outcomes, heads (H) and tails (T). The sample space
is Ω= {H, T}, and the events are
{H, T}, {H}, {T}, Ø.
If the coin is fair, i.e., if we believe that heads and tails are “equally likely,” we
should assign equal probabilities to the two possible outcomes and specify that
P
{H}
= P
{T}
= 0.5. The additivity axiom implies that
P
{H, T}
= P
{H}
+ P
{T}
= 1,
which is consistent with the normalization axiom. Thus, the probability law is given
by
P
{H, T}
= 1,
P
{H}
= 0.5,
P
{T}
= 0.5,
P(Ø) = 0,
and satisﬁes all three axioms.
Consider another experiment involving three coin tosses. The outcome will
now be a 3-long string of heads or tails. The sample space is
Ω= {HHH, HHT, HTH, HTT, THH, THT, TTH, TTT}.
We assume that each possible outcome has the same probability of 1/8. Let us
construct a probability law that satisﬁes the three axioms. Consider, as an example,
the event
A = {exactly 2 heads occur} = {HHT, HTH, THH}.

Sec. 1.2
Probabilistic Models
11
Using additivity, the probability of A is the sum of the probabilities of its elements:
P
{HHT, HTH, THH}
= P
{HHT}
+ P
{HTH}
+ P
{THH}
= 1
8 + 1
8 + 1
8
= 3
8.
Similarly, the probability of any event is equal to 1/8 times the number of possible
outcomes contained in the event. This deﬁnes a probability law that satisﬁes the
three axioms.
By using the additivity axiom and by generalizing the reasoning in the
preceding example, we reach the following conclusion.
Discrete Probability Law
If the sample space consists of a ﬁnite number of possible outcomes, then the
probability law is speciﬁed by the probabilities of the events that consist of
a single element. In particular, the probability of any event {s1, s2, . . . , sn}
is the sum of the probabilities of its elements:
P

{s1, s2, . . . , sn}

= P

{s1}

+ P

{s2}

+ · · · + P

{sn}

.
In the special case where the probabilities P

{s1}), . . . , P({sn}

are all the
same (by necessity equal to 1/n, in view of the normalization axiom), we obtain
the following.
Discrete Uniform Probability Law
If the sample space consists of n possible outcomes which are equally likely
(i.e., all single-element events have the same probability), then the proba-
bility of any event A is given by
P(A) = Number of elements of A
n
.
Let us provide a few more examples of sample spaces and probability laws.
Example 1.3. Dice.
Consider the experiment of rolling a pair of 4-sided dice (cf.
Fig. 1.4). We assume the dice are fair, and we interpret this assumption to mean

12
Sample Space and Probability
Chap. 1
that each of the sixteen possible outcomes [ordered pairs (i, j), with i, j = 1, 2, 3, 4],
has the same probability of 1/16.
To calculate the probability of an event, we
must count the number of elements of event and divide by 16 (the total number of
possible outcomes). Here are some event probabilities calculated in this way:
P
{the sum of the rolls is even}
= 8/16 = 1/2,
P
{the sum of the rolls is odd}
= 8/16 = 1/2,
P
{the ﬁrst roll is equal to the second}
= 4/16 = 1/4,
P
{the ﬁrst roll is larger than the second}
= 6/16 = 3/8,
P
{at least one roll is equal to 4}
= 7/16.
1
1
2
2
3
3
4
4
Sample Space
Pair of Rolls
1st Roll
2nd Roll
Event 
{the first roll is equal to the second}
Probability = 4/16
Event 
{at least one roll is a 4}
Probability = 7/16
Figure 1.4: Various events in the experiment of rolling a pair of 4-sided dice,
and their probabilities, calculated according to the discrete uniform law.
Continuous Models
Probabilistic models with continuous sample spaces diﬀer from their discrete
counterparts in that the probabilities of the single-element events may not be
suﬃcient to characterize the probability law. This is illustrated in the following
examples, which also illustrate how to generalize the uniform probability law to
the case of a continuous sample space.

Sec. 1.2
Probabilistic Models
13
Example 1.4.
A wheel of fortune is continuously calibrated from 0 to 1, so the
possible outcomes of an experiment consisting of a single spin are the numbers in
the interval Ω= [0, 1].
Assuming a fair wheel, it is appropriate to consider all
outcomes equally likely, but what is the probability of the event consisting of a
single element? It cannot be positive, because then, using the additivity axiom, it
would follow that events with a suﬃciently large number of elements would have
probability larger than 1. Therefore, the probability of any event that consists of a
single element must be 0.
In this example, it makes sense to assign probability b −a to any subinterval
[a, b] of [0, 1], and to calculate the probability of a more complicated set by eval-
uating its “length.”†
This assignment satisﬁes the three probability axioms and
qualiﬁes as a legitimate probability law.
Example 1.5.
Romeo and Juliet have a date at a given time, and each will arrive
at the meeting place with a delay between 0 and 1 hour, with all pairs of delays
being equally likely. The ﬁrst to arrive will wait for 15 minutes and will leave if the
other has not yet arrived. What is the probability that they will meet?
Let us use as sample space the square Ω= [0, 1] × [0, 1], whose elements are
the possible pairs of delays for the two of them. Our interpretation of “equally
likely” pairs of delays is to let the probability of a subset of Ωbe equal to its area.
This probability law satisﬁes the three probability axioms. The event that Romeo
and Juliet will meet is the shaded region in Fig. 1.5, and its probability is calculated
to be 7/16.
Properties of Probability Laws
Probability laws have a number of properties, which can be deduced from the
axioms. Some of them are summarized below.
Some Properties of Probability Laws
Consider a probability law, and let A, B, and C be events.
(a) If A ⊂B, then P(A) ≤P(B).
(b) P(A ∪B) = P(A) + P(B) −P(A ∩B).
(c) P(A ∪B) ≤P(A) + P(B).
(d) P(A ∪B ∪C) = P(A) + P(Ac ∩B) + P(Ac ∩Bc ∩C).
† The “length” of a subset S of [0, 1] is the integral 
S dt, which is deﬁned, for
“nice” sets S, in the usual calculus sense. For unusual sets, this integral may not be
well deﬁned mathematically, but such issues belong to a more advanced treatment of
the subject.

14
Sample Space and Probability
Chap. 1
0
1
1
x
y
1/4
1/4
M
Figure 1.5: The event M that Romeo and Juliet will arrive within 15 minutes
of each other (cf. Example 1.5) is
M = 
(x, y)
		 |x −y| ≤1/4, 0 ≤x ≤1, 0 ≤y ≤1
,
and is shaded in the ﬁgure. The area of M is 1 minus the area of the two unshaded
triangles, or 1 −(3/4) · (3/4) = 7/16. Thus, the probability of meeting is 7/16.
These properties, and other similar ones, can be visualized and veriﬁed
graphically using Venn diagrams, as in Fig. 1.6. For a further example, note
that we can apply property (c) repeatedly and obtain the inequality
P(A1 ∪A2 ∪· · · ∪An) ≤
n

i=1
P(Ai).
In more detail, let us apply property (c) to the sets A1 and A2 ∪· · · ∪An, to
obtain
P(A1 ∪A2 ∪· · · ∪An) ≤P(A1) + P(A2 ∪· · · ∪An).
We also apply property (c) to the sets A2 and A3 ∪· · · ∪An to obtain
P(A2 ∪· · · ∪An) ≤P(A2) + P(A3 ∪· · · ∪An),
continue similarly, and ﬁnally add.
Models and Reality
Using the framework of probability theory to analyze a physical but uncertain
situation, involves two distinct stages.
(a) In the ﬁrst stage, we construct a probabilistic model, by specifying a prob-
ability law on a suitably deﬁned sample space. There are no hard rules to

Sec. 1.2
Probabilistic Models
15
A
A
B
A
B
C
B
(a)
(b)
(c)
A
B
U
U
A
B
c
C
U
A
B
c
U
c
U
A
B
c
Figure 1.6: Visualization and veriﬁcation of various properties of probability
laws using Venn diagrams. If A ⊂B, then B is the union of the two disjoint
events A and Ac ∩B; see diagram (a). Therefore, by the additivity axiom, we
have
P(B) = P(A) + P(Ac ∩B) ≥P(A),
where the inequality follows from the nonnegativity axiom, and veriﬁes prop-
erty (a).
From diagram (b), we can express the events A ∪B and B as unions of
disjoint events:
A ∪B = A ∪(Ac ∩B),
B = (A ∩B) ∪(Ac ∩B).
The additivity axiom yields
P(A ∪B) = P(A) + P(Ac ∩B),
P(B) = P(A ∩B) + P(Ac ∩B).
Subtracting the second equality from the ﬁrst and rearranging terms, we obtain
P(A ∪B) = P(A) + P(B) −P(A ∩B), verifying property (b). Using also the fact
P(A ∩B) ≥0 (the nonnegativity axiom), we obtain P(A ∪B) ≤P(A) + P(B),
verifying property (c)
From diagram (c), we see that the event A ∪B ∪C can be expressed as a
union of three disjoint events:
A ∪B ∪C = A ∪(Ac ∩B) ∪(Ac ∩Bc ∩C),
so property (d) follows as a consequence of the additivity axiom.

16
Sample Space and Probability
Chap. 1
guide this step, other than the requirement that the probability law con-
form to the three axioms. Reasonable people may disagree on which model
best represents reality. In many cases, one may even want to use a some-
what “incorrect” model, if it is simpler than the “correct” one or allows for
tractable calculations. This is consistent with common practice in science
and engineering, where the choice of a model often involves a tradeoﬀbe-
tween accuracy, simplicity, and tractability. Sometimes, a model is chosen
on the basis of historical data or past outcomes of similar experiments.
Systematic methods for doing so belong to the ﬁeld of statistics, a topic
that we will touch upon in the last chapter of this book.
(b) In the second stage, we work within a fully speciﬁed probabilistic model and
derive the probabilities of certain events, or deduce some interesting prop-
erties. While the ﬁrst stage entails the often open-ended task of connecting
the real world with mathematics, the second one is tightly regulated by the
rules of ordinary logic and the axioms of probability. Diﬃculties may arise
in the latter if some required calculations are complex, or if a probability
law is speciﬁed in an indirect fashion. Even so, there is no room for ambi-
guity: all conceivable questions have precise answers and it is only a matter
of developing the skill to arrive at them.
Probability theory is full of “paradoxes” in which diﬀerent calculation
methods seem to give diﬀerent answers to the same question. Invariably though,
these apparent inconsistencies turn out to reﬂect poorly speciﬁed or ambiguous
probabilistic models.
1.3
CONDITIONAL PROBABILITY
Conditional probability provides us with a way to reason about the outcome
of an experiment, based on partial information. Here are some examples of
situations we have in mind:
(a) In an experiment involving two successive rolls of a die, you are told that
the sum of the two rolls is 9. How likely is it that the ﬁrst roll was a 6?
(b) In a word guessing game, the ﬁrst letter of the word is a “t”. What is the
likelihood that the second letter is an “h”?
(c) How likely is it that a person has a disease given that a medical test was
negative?
(d) A spot shows up on a radar screen. How likely is it that it corresponds to
an aircraft?
In more precise terms, given an experiment, a corresponding sample space,
and a probability law, suppose that we know that the outcome is within some
given event B. We wish to quantify the likelihood that the outcome also belongs

Sec. 1.3
Conditional Probability
17
to some other given event A. We thus seek to construct a new probability law,
which takes into account this knowledge and which, for any event A, gives us
the conditional probability of A given B, denoted by P(A | B).
We would like the conditional probabilities P(A | B) of diﬀerent events A
to constitute a legitimate probability law, that satisﬁes the probability axioms.
They should also be consistent with our intuition in important special cases, e.g.,
when all possible outcomes of the experiment are equally likely. For example,
suppose that all six possible outcomes of a fair die roll are equally likely. If we
are told that the outcome is even, we are left with only three possible outcomes,
namely, 2, 4, and 6. These three outcomes were equally likely to start with,
and so they should remain equally likely given the additional knowledge that the
outcome was even. Thus, it is reasonable to let
P(the outcome is 6 | the outcome is even) = 1
3.
This argument suggests that an appropriate deﬁnition of conditional probability
when all outcomes are equally likely, is given by
P(A | B) = number of elements of A ∩B
number of elements of B
.
Generalizing the argument, we introduce the following deﬁnition of condi-
tional probability:
P(A | B) = P(A ∩B)
P(B)
,
where we assume that P(B) > 0; the conditional probability is undeﬁned if the
conditioning event has zero probability. In words, out of the total probability of
the elements of B, P(A | B) is the fraction that is assigned to possible outcomes
that also belong to A.
Conditional Probabilities Specify a Probability Law
For a ﬁxed event B, it can be veriﬁed that the conditional probabilities P(A | B)
form a legitimate probability law that satisﬁes the three axioms. Indeed, non-
negativity is clear. Furthermore,
P(Ω| B) = P(Ω∩B)
P(B)
= P(B)
P(B) = 1,
and the normalization axiom is also satisﬁed. In fact, since we have P(B | B) =
P(B)/P(B) = 1, all of the conditional probability is concentrated on B. Thus,
we might as well discard all possible outcomes outside B and treat the conditional
probabilities as a probability law deﬁned on the new universe B.

18
Sample Space and Probability
Chap. 1
To verify the additivity axiom, we write for any two disjoint events A1 and
A2,
P(A1 ∪A2 | B) = P

(A1 ∪A2) ∩B

P(B)
= P((A1 ∩B) ∪(A2 ∩B))
P(B)
= P(A1 ∩B) + P(A2 ∩B)
P(B)
= P(A1 ∩B)
P(B)
+ P(A2 ∩B)
P(B)
= P(A1 | B) + P(A2 | B),
where for the second equality, we used the fact that A1 ∩B and A2 ∩B are
disjoint sets, and for the third equality we used the additivity axiom for the
(unconditional) probability law.
The argument for a countable collection of
disjoint sets is similar.
Since conditional probabilities constitute a legitimate probability law, all
general properties of probability laws remain valid. For example, a fact such as
P(A ∪C) ≤P(A) + P(C) translates to the new fact
P(A ∪C | B) ≤P(A | B) + P(C | B).
Let us summarize the conclusions reached so far.
Properties of Conditional Probability
• The conditional probability of an event A, given an event B with
P(B) > 0, is deﬁned by
P(A | B) = P(A ∩B)
P(B)
,
and speciﬁes a new (conditional) probability law on the same sample
space Ω. In particular, all known properties of probability laws remain
valid for conditional probability laws.
• Conditional probabilities can also be viewed as a probability law on a
new universe B, because all of the conditional probability is concen-
trated on B.
• In the case where the possible outcomes are ﬁnitely many and equally
likely, we have
P(A | B) = number of elements of A ∩B
number of elements of B
.

Sec. 1.3
Conditional Probability
19
Example 1.6.
We toss a fair coin three successive times. We wish to ﬁnd the
conditional probability P(A | B) when A and B are the events
A = {more heads than tails come up},
B = {1st toss is a head}.
The sample space consists of eight sequences,
Ω= {HHH, HHT, HTH, HTT, THH, THT, TTH, TTT},
which we assume to be equally likely. The event B consists of the four elements
HHH, HHT, HTH, HTT, so its probability is
P(B) = 4
8.
The event A ∩B consists of the three elements outcomes HHH, HHT, HTH, so
its probability is
P(A ∩B) = 3
8.
Thus, the conditional probability P(A | B) is
P(A | B) = P(A ∩B)
P(B)
= 3/8
4/8 = 3
4.
Because all possible outcomes are equally likely here, we can also compute P(A | B)
using a shortcut. We can bypass the calculation of P(B) and P(A∩B), and simply
divide the number of elements shared by A and B (which is 3) with the number of
elements of B (which is 4), to obtain the same result 3/4.
Example 1.7.
A fair 4-sided die is rolled twice and we assume that all sixteen
possible outcomes are equally likely. Let X and Y be the result of the 1st and the
2nd roll, respectively. We wish to determine the conditional probability P(A | B)
where
A = 
max(X, Y ) = m
,
B = 
min(X, Y ) = 2
,
and m takes each of the values 1, 2, 3, 4.
As in the preceding example, we can ﬁrst determine the probabilities P(A∩B)
and P(B) by counting the number of elements of A ∩B and B, respectively, and
dividing by 16. Alternatively, we can directly divide the number of elements of
A ∩B with the number of elements of B; see Fig. 1.7.
Example 1.8.
A conservative design team, call it C, and an innovative design
team, call it N, are asked to separately design a new product within a month. From
past experience we know that:
(a) The probability that team C is successful is 2/3.

20
Sample Space and Probability
Chap. 1
1
1
2
2
3
3
4
4
All Outcomes Equally Likely
Probability = 1/16
1st Roll X
2nd Roll Y
B
Figure 1.7: Sample space of an experiment involving two rolls of a 4-sided die.
(cf. Example 1.7). The conditioning event B = {min(X, Y ) = 2} consists of the
5-element shaded set. The set A = {max(X, Y ) = m} shares with B two elements
if m = 3 or m = 4, one element if m = 2, and no element if m = 1. Thus, we have
P
{max(X, Y ) = m} | B
=
 2/5
if m = 3 or m = 4,
1/5
if m = 2,
0
if m = 1.
(b) The probability that team N is successful is 1/2.
(c) The probability that at least one team is successful is 3/4.
If both teams are successful, the design of team N is adopted. Assuming that exactly
one successful design is produced, what is the probability that it was designed by
team N?
There are four possible outcomes here, corresponding to the four combinations
of success and failure of the two teams:
SS: both succeed,
FF: both fail,
SF: C succeeds, N fails,
FS: C fails, N succeeds.
We are given that the probabilities of these outcomes satisfy
P(SS) + P(SF) = 2
3,
P(SS) + P(FS) = 1
2,
P(SS) + P(SF) + P(FS) = 3
4.
From these relations, together with the normalization equation P(SS) + P(SF) +
P(FS) + P(FF) = 1, we can obtain the probabilities of all the outcomes:
P(SS) = 5
12,
P(SF) = 1
4,
P(FS) = 1
12,
P(FF) = 1
4.
The desired conditional probability is
P
{FS} | {SF, FS}
=
1
12
1
4 + 1
12
= 1
4.

Sec. 1.3
Conditional Probability
21
Using Conditional Probability for Modeling
When constructing probabilistic models for experiments that have a sequential
character, it is often natural and convenient to ﬁrst specify conditional prob-
abilities and then use them to determine unconditional probabilities. The rule
P(A∩B) = P(B)P(A | B), which is a restatement of the deﬁnition of conditional
probability, is often helpful in this process.
Example 1.9. Radar detection.
If an aircraft is present in a certain area, a
radar correctly registers its presence with probability 0.99. If it is not present, the
radar falsely registers an aircraft presence with probability 0.10. We assume that
an aircraft is present with probability 0.05. What is the probability of false alarm
(a false indication of aircraft presence), and the probability of missed detection
(nothing registers, even though an aircraft is present)?
A sequential representation of the sample space is appropriate here, as shown
in Fig. 1.8. Let A and B be the events
A = {an aircraft is present},
B = {the radar registers an aircraft presence},
and consider also their complements
Ac = {an aircraft is not present},
Bc = {the radar does not register an aircraft presence}.
The given probabilities are recorded along the corresponding branches of the tree
describing the sample space, as shown in Fig. 1.8. Each event of interest corresponds
to a leaf of the tree and its probability is equal to the product of the probabilities
associated with the branches in a path from the root to the corresponding leaf. The
desired probabilities of false alarm and missed detection are
P(false alarm) = P(Ac ∩B) = P(Ac)P(B | Ac) = 0.95 · 0.10 = 0.095,
P(missed detection) = P(A ∩Bc) = P(A)P(Bc | A) = 0.05 · 0.01 = 0.0005.
Extending the preceding example, we have a general rule for calculating
various probabilities in conjunction with a tree-based sequential description of
an experiment. In particular:
(a) We set up the tree so that an event of interest is associated with a leaf.
We view the occurrence of the event as a sequence of steps, namely, the
traversals of the branches along the path from the root to the leaf.
(b) We record the conditional probabilities associated with the branches of the
tree.
(c) We obtain the probability of a leaf by multiplying the probabilities recorded
along the corresponding path of the tree.

22
Sample Space and Probability
Chap. 1
P(A) = 0.05
P(Ac) = 0.95
P(B | A) = 0.99
P(Bc| A) = 0.01
P(B | Ac) = 0.10
P(Bc| Ac )= 0.90
False Alarm
Missed
Detection
Aircraft Present
Aircraft not Present
Figure 1.8: Sequential description of the sample space for the radar detection
problem in Example 1.9
.
In mathematical terms, we are dealing with an event A which occurs if and
only if each one of several events A1, . . . , An has occurred, i.e., A = A1 ∩A2 ∩
· · · ∩An. The occurrence of A is viewed as an occurrence of A1, followed by
the occurrence of A2, then of A3, etc, and it is visualized as a path on the tree
with n branches, corresponding to the events A1, . . . , An. The probability of A
is given by the following rule (see also Fig. 1.9).
Multiplication Rule
Assuming that all of the conditioning events have positive probability, we
have
P

∩n
i=1 Ai

= P(A1)P(A2 | A1)P(A3 | A1 ∩A2) · · · P

An | ∩n−1
i=1 Ai

.
The multiplication rule can be veriﬁed by writing
P

∩n
i=1 Ai

= P(A1)P(A1 ∩A2)
P(A1)
P(A1 ∩A2 ∩A3)
P(A1 ∩A2)
· · · P

∩n
i=1 Ai

P

∩n−1
i=1 Ai
,
and by using the deﬁnition of conditional probability to rewrite the right-hand
side above as
P(A1)P(A2 | A1)P(A3 | A1 ∩A2) · · · P

An | ∩n−1
i=1 Ai

.

Sec. 1.3
Conditional Probability
23
...
A1
A2
A3
An-1
An
P(A1 )
P(A3 |A1  ∩A2 )
P(A2 |A1 )
P(An |A1  ∩A2 ∩ ...∩An-1)
Event A1  ∩A2  ∩A3 
Event A1  ∩A2 ∩ ...∩An
Figure 1.9: Visualization of the total probability theorem. The intersection event
A = A1∩A2∩· · ·∩An is associated with a path on the tree of a sequential descrip-
tion of the experiment. We associate the branches of this path with the events
A1, . . . , An, and we record next to the branches the corresponding conditional
probabilities.
The ﬁnal node of the path corresponds to the intersection event A, and
its probability is obtained by multiplying the conditional probabilities recorded
along the branches of the path
P(A1 ∩A2 ∩· · · ∩A3) = P(A1)P(A2 | A1) · · · P(An | A1 ∩A2 ∩· · · ∩An−1).
Note that any intermediate node along the path also corresponds to some inter-
section event and its probability is obtained by multiplying the corresponding
conditional probabilities up to that node. For example, the event A1 ∩A2 ∩A3
corresponds to the node shown in the ﬁgure, and its probability is
P(A1 ∩A2 ∩A3) = P(A1)P(A2 | A1)P(A3 | A1 ∩A2).
For the case of just two events, A1 and A2, the multiplication rule is simply the
deﬁnition of conditional probability.
Example 1.10.
Three cards are drawn from an ordinary 52-card deck without
replacement (drawn cards are not placed back in the deck). We wish to ﬁnd the
probability that none of the three cards is a heart. We assume that at each step,
each one of the remaining cards is equally likely to be picked. By symmetry, this
implies that every triplet of cards is equally likely to be drawn. A cumbersome
approach, that we will not use, is to count the number of all card triplets that
do not include a heart, and divide it with the number of all possible card triplets.
Instead, we use a sequential description of the sample space in conjunction with the
multiplication rule (cf. Fig. 1.10).
Deﬁne the events
Ai = {the ith card is not a heart},
i = 1, 2, 3.
We will calculate P(A1 ∩A2 ∩A3), the probability that none of the three cards is
a heart, using the multiplication rule,
P(A1 ∩A2 ∩A3) = P(A1)P(A2 | A1)P(A3 | A1 ∩A2).

24
Sample Space and Probability
Chap. 1
We have
P(A1) = 39
52,
since there are 39 cards that are not hearts in the 52-card deck. Given that the
ﬁrst card is not a heart, we are left with 51 cards, 38 of which are not hearts, and
P(A2 | A1) = 38
51.
Finally, given that the ﬁrst two cards drawn are not hearts, there are 37 cards which
are not hearts in the remaining 50-card deck, and
P(A3 | A1 ∩A2) = 37
50.
These probabilities are recorded along the corresponding branches of the tree de-
scribing the sample space, as shown in Fig. 1.10. The desired probability is now
obtained by multiplying the probabilities recorded along the corresponding path of
the tree:
P(A1 ∩A2 ∩A3) = 39
52 · 38
51 · 37
50.
Note that once the probabilities are recorded along the tree, the probability
of several other events can be similarly calculated. For example,
P(1st is not a heart and 2nd is a heart) =39
52 · 13
51,
P(1st two are not hearts and 3rd is a heart) =39
52 · 38
51 · 13
50.
Not a Heart
39/52
38/51
37/50
Not a Heart
Not a Heart
Heart
Heart
Heart
13/52
13/51
13/50
Figure 1.10: Sequential description of the sample space of the 3-card selection
problem in Example 1.10.

Sec. 1.4
Total Probability Theorem and Bayes’ Rule
25
Example 1.11.
A class consisting of 4 graduate and 12 undergraduate students
is randomly divided into 4 groups of 4. What is the probability that each group
includes a graduate student? We interpret randomly to mean that given the as-
signment of some students to certain slots, any of the remaining students is equally
likely to be assigned to any of the remaining slots. We then calculate the desired
probability using the multiplication rule, based on the sequential description shown
in Fig. 1.11. Let us denote the four graduate students by 1, 2, 3, 4, and consider
the events
A1 = {students 1 and 2 are in diﬀerent groups},
A2 = {students 1, 2, and 3 are in diﬀerent groups},
A3 = {students 1, 2, 3, and 4 are in diﬀerent groups}.
We will calculate P(A3) using the multiplication rule:
P(A3) = P(A1 ∩A2 ∩A3) = P(A1)P(A2 | A1)P(A3 | A1 ∩A2).
We have
P(A1) = 12
15,
since there are 12 student slots in groups other than the one of student 1, and there
are 15 student slots overall, excluding student 1. Similarly,
P(A2 | A1) = 8
14,
since there are 8 student slots in groups other than the one of students 1 and 2,
and there are 14 student slots, excluding students 1 and 2. Also,
P(A3 | A1 ∩A2) = 4
13,
since there are 4 student slots in groups other than the one of students 1, 2, and
3, and there are 13 student slots, excluding students 1, 2, and 3. Thus, the desired
probability is
12
15 · 8
14 · 4
13,
and is obtained by multiplying the conditional probabilities along the corresponding
path of the tree of Fig. 1.11.
1.4
TOTAL PROBABILITY THEOREM AND BAYES’ RULE
In this section, we explore some applications of conditional probability. We start
with the following theorem, which is often useful for computing the probabilities
of various events, using a “divide-and-conquer” approach.

26
Sample Space and Probability
Chap. 1
Students 1 & 2 are
in Different Groups 
12/15
Students 1, 2, & 3 are
in Different Groups 
8/14
Students 1, 2, 3, & 4 are
in Different Groups 
4/13
Figure 1.11: Sequential description of the sample space of the student problem
in Example 1.11.
Total Probability Theorem
Let A1, . . . , An be disjoint events that form a partition of the sample space
(each possible outcome is included in one and only one of the events A1, . . . , An)
and assume that P(Ai) > 0, for all i = 1, . . . , n. Then, for any event B, we
have
P(B) = P(A1 ∩B) + · · · + P(An ∩B)
= P(A1)P(B | A1) + · · · + P(An)P(B | An).
The theorem is visualized and proved in Fig. 1.12. Intuitively, we are par-
titioning the sample space into a number of scenarios (events) Ai. Then, the
probability that B occurs is a weighted average of its conditional probability
under each scenario, where each scenario is weighted according to its (uncondi-
tional) probability. One of the uses of the theorem is to compute the probability
of various events B for which the conditional probabilities P(B | Ai) are known or
easy to derive. The key is to choose appropriately the partition A1, . . . , An, and
this choice is often suggested by the problem structure. Here are some examples.
Example 1.12.
You enter a chess tournament where your probability of winning
a game is 0.3 against half the players (call them type 1), 0.4 against a quarter of
the players (call them type 2), and 0.5 against the remaining quarter of the players
(call them type 3). You play a game against a randomly chosen opponent. What
is the probability of winning?
Let Ai be the event of playing with an opponent of type i. We have
P(A1) = 0.5,
P(A2) = 0.25,
P(A3) = 0.25.

Sec. 1.4
Total Probability Theorem and Bayes’ Rule
27
A1
B
A2
A3
A1
A1  ∩B
B
A2  ∩B
A3  ∩B
A2
A3
Bc
Figure 1.12: Visualization and veriﬁcation of the total probability theorem. The
events A1, . . . , An form a partition of the sample space, so the event B can be
decomposed into the disjoint union of its intersections Ai ∩B with the sets Ai,
i.e.,
B = (A1 ∩B) ∪· · · ∪(An ∩B).
Using the additivity axiom, it follows that
P(B) = P(A1 ∩B) + · · · + P(An ∩B).
Since, by the deﬁnition of conditional probability, we have
P(Ai ∩B) = P(Ai)P(B | Ai),
the preceding equality yields
P(B) = P(A1)P(B | A1) + · · · + P(An)P(B | An).
For an alternative view, consider an equivalent sequential model, as shown
on the right. The probability of the leaf Ai ∩B is the product P(Ai)P(B | Ai) of
the probabilities along the path leading to that leaf. The event B consists of the
three highlighted leaves and P(B) is obtained by adding their probabilities.
Let also B be the event of winning. We have
P(B | A1) = 0.3,
P(B | A2) = 0.4,
P(B | A3) = 0.5.
Thus, by the total probability theorem, the probability of winning is
P(B) = P(A1)P(B | A1) + P(A2)P(B | A2) + P(A3)P(B | A3)
= 0.5 · 0.3 + 0.25 · 0.4 + 0.25 · 0.5
= 0.375.
Example 1.13.
We roll a fair four-sided die. If the result is 1 or 2, we roll once
more but otherwise, we stop. What is the probability that the sum total of our
rolls is at least 4?

28
Sample Space and Probability
Chap. 1
Let Ai be the event that the result of ﬁrst roll is i, and note that P(Ai) = 1/4
for each i. Let B be the event that the sum total is at least 4. Given the event A1,
the sum total will be at least 4 if the second roll results in 3 or 4, which happens
with probability 1/2. Similarly, given the event A2, the sum total will be at least
4 if the second roll results in 2, 3, or 4, which happens with probability 3/4. Also,
given the event A3, we stop and the sum total remains below 4. Therefore,
P(B | A1) = 1
2,
P(B | A2) = 3
4,
P(B | A3) = 0,
P(B | A4) = 1.
By the total probability theorem,
P(B) = 1
4 · 1
2 + 1
4 · 3
4 + 1
4 · 0 + 1
4 · 1 = 9
16.
The total probability theorem can be applied repeatedly to calculate proba-
bilities in experiments that have a sequential character, as shown in the following
example.
Example 1.14.
Alice is taking a probability class and at the end of each week
she can be either up-to-date or she may have fallen behind. If she is up-to-date in
a given week, the probability that she will be up-to-date (or behind) in the next
week is 0.8 (or 0.2, respectively). If she is behind in a given week, the probability
that she will be up-to-date (or behind) in the next week is 0.6 (or 0.4, respectively).
Alice is (by default) up-to-date when she starts the class. What is the probability
that she is up-to-date after three weeks?
Let Ui and Bi be the events that Alice is up-to-date or behind, respectively,
after i weeks. According to the total probability theorem, the desired probability
P(U3) is given by
P(U3) = P(U2)P(U3 | U2) + P(B2)P(U3 | B2) = P(U2) · 0.8 + P(B2) · 0.4.
The probabilities P(U2) and P(B2) can also be calculated using the total probability
theorem:
P(U2) = P(U1)P(U2 | U1) + P(B1)P(U2 | B1) = P(U1) · 0.8 + P(B1) · 0.4,
P(B2) = P(U1)P(B2 | U1) + P(B1)P(B2 | B1) = P(U1) · 0.2 + P(B1) · 0.6.
Finally, since Alice starts her class up-to-date, we have
P(U1) = 0.8,
P(B1) = 0.2.
We can now combine the preceding three equations to obtain
P(U2) = 0.8 · 0.8 + 0.2 · 0.4 = 0.72,
P(B2) = 0.8 · 0.2 + 0.2 · 0.6 = 0.28.

Sec. 1.4
Total Probability Theorem and Bayes’ Rule
29
and by using the above probabilities in the formula for P(U3):
P(U3) = 0.72 · 0.8 + 0.28 · 0.4 = 0.688.
Note that we could have calculated the desired probability P(U3) by con-
structing a tree description of the experiment, by calculating the probability of
every element of U3 using the multiplication rule on the tree, and by adding. In
experiments with a sequential character one may often choose between using the
multiplication rule or the total probability theorem for calculation of various prob-
abilities. However, there are cases where the calculation based on the total prob-
ability theorem is more convenient.
For example, suppose we are interested in
the probability P(U20) that Alice is up-to-date after 20 weeks. Calculating this
probability using the multiplication rule is very cumbersome, because the tree rep-
resenting the experiment is 20-stages deep and has 220 leaves. On the other hand,
with a computer, a sequential caclulation using the total probability formulas
P(Ui+1) = P(Ui) · 0.8 + P(Bi) · 0.4,
P(Bi+1) = P(Ui) · 0.2 + P(Bi) · 0.6,
and the initial conditions P(U1) = 0.8, P(B1) = 0.2 is very simple.
The total probability theorem is often used in conjunction with the fol-
lowing celebrated theorem, which relates conditional probabilities of the form
P(A | B) with conditional probabilities of the form P(B | A), in which the order
of the conditioning is reversed.
Bayes’ Rule
Let A1, A2, . . . , An be disjoint events that form a partition of the sample
space, and assume that P(Ai) > 0, for all i. Then, for any event B such
that P(B) > 0, we have
P(Ai | B) = P(Ai)P(B | Ai)
P(B)
=
P(Ai)P(B | Ai)
P(A1)P(B | A1) + · · · + P(An)P(B | An).
To verify Bayes’ rule, note that P(Ai)P(B | Ai) and P(Ai | B)P(B) are
equal, because they are both equal to P(Ai ∩B). This yields the ﬁrst equality.
The second equality follows from the ﬁrst by using the total probability theorem
to rewrite P(B).
Bayes’ rule is often used for inference. There are a number of “causes”
that may result in a certain “eﬀect.” We observe the eﬀect, and we wish to infer

30
Sample Space and Probability
Chap. 1
the cause. The events A1, . . . , An are associated with the causes and the event B
represents the eﬀect. The probability P(B | Ai) that the eﬀect will be observed
when the cause Ai is present amounts to a probabilistic model of the cause-eﬀect
relation (cf. Fig. 1.13). Given that the eﬀect B has been observed, we wish to
evaluate the (conditional) probability P(Ai | B) that the cause Ai is present.
A1
B
A2
A3
Cause 1
Malignant Tumor
Cause 3
Other
Cause 2
Nonmalignant
Tumor
Effect
Shade Observed
A1
A1  ∩B
B
A2  ∩B
A3  ∩B
A2
A3
Bc
B
Bc
B
Bc
Figure 1.13: An example of the inference context that is implicit in Bayes’
rule. We observe a shade in a person’s X-ray (this is event B, the “eﬀect”) and
we want to estimate the likelihood of three mutually exclusive and collectively
exhaustive potential causes: cause 1 (event A1) is that there is a malignant tumor,
cause 2 (event A2) is that there is a nonmalignant tumor, and cause 3 (event
A3) corresponds to reasons other than a tumor. We assume that we know the
probabilities P(Ai) and P(B | Ai), i = 1, 2, 3. Given that we see a shade (event
B occurs), Bayes’ rule gives the conditional probabilities of the various causes as
P(Ai | B) =
P(Ai)P(B | Ai)
P(A1)P(B | A1) + P(A2)P(B | A2) + P(A3)P(B | A3) ,
i = 1, 2, 3.
For an alternative view, consider an equivalent sequential model, as shown
on the right. The probability P(A1 | B) of a malignant tumor is the probability
of the ﬁrst highlighted leaf, which is P(A1 ∩B), divided by the total probability
of the highlighted leaves, which is P(B).
Example 1.15.
Let us return to the radar detection problem of Example 1.9 and
Fig. 1.8. Let
A ={an aircraft is present},
B ={the radar registers an aircraft presence}.
We are given that
P(A) = 0.05,
P(B | A) = 0.99,
P(B | Ac) = 0.1.

Sec. 1.5
Independence
31
Applying Bayes’ rule, with A1 = A and A2 = Ac, we obtain
P(aircraft present | radar registers) = P(A | B)
= P(A)P(B | A)
P(B)
=
P(A)P(B | A)
P(A)P(B | A) + P(Ac)P(B | Ac)
=
0.05 · 0.99
0.05 · 0.99 + 0.95 · 0.1
≈0.3426.
Example 1.16.
Let us return to the chess problem of Example 1.12. Here Ai is
the event of getting an opponent of type i, and
P(A1) = 0.5,
P(A2) = 0.25,
P(A3) = 0.25.
Also, B is the event of winning, and
P(B | A1) = 0.3,
P(B | A2) = 0.4,
P(B | A3) = 0.5.
Suppose that you win. What is the probability P(A1 | B) that you had an opponent
of type 1?
Using Bayes’ rule, we have
P(A1 | B) =
P(A1)P(B | A1)
P(A1)P(B | A1) + P(A2)P(B | A2) + P(A3)P(B | A3)
=
0.5 · 0.3
0.5 · 0.3 + 0.25 · 0.4 + 0.25 · 0.5
= 0.4.
1.5
INDEPENDENCE
We have introduced the conditional probability P(A | B) to capture the partial
information that event B provides about event A. An interesting and important
special case arises when the occurrence of B provides no information and does
not alter the probability that A has occurred, i.e.,
P(A | B) = P(A).

32
Sample Space and Probability
Chap. 1
When the above equality holds, we say that A is independent of B. Note that
by the deﬁnition P(A | B) = P(A ∩B)/P(B), this is equivalent to
P(A ∩B) = P(A)P(B).
We adopt this latter relation as the deﬁnition of independence because it can be
used even if P(B) = 0, in which case P(A | B) is undeﬁned. The symmetry of
this relation also implies that independence is a symmetric property; that is, if
A is independent of B, then B is independent of A, and we can unambiguously
say that A and B are independent events.
Independence is often easy to grasp intuitively. For example, if the occur-
rence of two events is governed by distinct and noninteracting physical processes,
such events will turn out to be independent. On the other hand, independence
is not easily visualized in terms of the sample space. A common ﬁrst thought
is that two events are independent if they are disjoint, but in fact the opposite
is true: two disjoint events A and B with P(A) > 0 and P(B) > 0 are never
independent, since their intersection A ∩B is empty and has probability 0.
Example 1.17.
Consider an experiment involving two successive rolls of a 4-sided
die in which all 16 possible outcomes are equally likely and have probability 1/16.
(a) Are the events
Ai = {1st roll results in i},
Bj = {2nd roll results in j},
independent? We have
P(A ∩B) = P
the result of the two rolls is (i, j)
= 1
16,
P(Ai) =
number of elements of Ai
total number of possible outcomes = 4
16,
P(Bj) =
number of elements of Bj
total number of possible outcomes = 4
16.
We observe that P(Ai ∩Bj) = P(Ai)P(Bj), and the independence of Ai and
Bj is veriﬁed. Thus, our choice of the discrete uniform probability law (which
might have seemed arbitrary) models the independence of the two rolls.
(b) Are the events
A = {1st roll is a 1},
B = {sum of the two rolls is a 5},
independent? The answer here is not quite obvious. We have
P(A ∩B) = P
the result of the two rolls is (1,4)
= 1
16,
and also
P(A) =
number of elements of A
total number of possible outcomes = 4
16.

Sec. 1.5
Independence
33
The event B consists of the outcomes (1,4), (2,3), (3,2), and (4,1), and
P(B) =
number of elements of B
total number of possible outcomes = 4
16.
Thus, we see that P(A ∩B) = P(A)P(B), and the events A and B are
independent.
(c) Are the events
A = {maximum of the two rolls is 2},
B = {minimum of the two rolls is 2},
independent? Intuitively, the answer is “no” because the minimum of the two
rolls tells us something about the maximum. For example, if the minimum is
2, the maximum cannot be 1. More precisely, to verify that A and B are not
independent, we calculate
P(A ∩B) = P
the result of the two rolls is (2,2)
= 1
16,
and also
P(A) =
number of elements of A
total number of possible outcomes = 3
16,
P(B) =
number of elements of B
total number of possible outcomes = 5
16.
We have P(A)P(B) = 15/(16)2, so that P(A ∩B) ̸= P(A)P(B), and A and
B are not independent.
Conditional Independence
We noted earlier that the conditional probabilities of events, conditioned on
a particular event, form a legitimate probability law. We can thus talk about
independence of various events with respect to this conditional law. In particular,
given an event C, the events A and B are called conditionally independent
if
P(A ∩B | C) = P(A | C)P(B | C).
The deﬁnition of the conditional probability and the multiplication rule yield
P(A ∩B | C) = P(A ∩B ∩C)
P(C)
= P(C)P(B | C)P(A | B ∩C)
P(C)
= P(B | C)P(A | B ∩C).

34
Sample Space and Probability
Chap. 1
After canceling the factor P(B | C), assumed nonzero, we see that conditional
independence is the same as the condition
P(A | B ∩C) = P(A | C).
In words, this relation states that if C is known to have occurred, the additional
knowledge that B also occurred does not change the probability of A.
Interestingly, independence of two events A and B with respect to the
unconditional probability law, does not imply conditional independence, and
vice versa, as illustrated by the next two examples.
Example 1.18.
Consider two independent fair coin tosses, in which all four
possible outcomes are equally likely. Let
H1 = {1st toss is a head},
H2 = {2nd toss is a head},
D = {the two tosses have diﬀerent results}.
The events H1 and H2 are (unconditionally) independent. But
P(H1 | D) = 1
2,
P(H2 | D) = 1
2,
P(H1 ∩H2 | D) = 0,
so that P(H1 ∩H2 | D) ̸= P(H1 | D)P(H2 | D), and H1, H2 are not conditionally
independent.
Example 1.19.
There are two coins, a blue and a red one. We choose one of
the two at random, each being chosen with probability 1/2, and proceed with two
independent tosses. The coins are biased: with the blue coin, the probability of
heads in any given toss is 0.99, whereas for the red coin it is 0.01.
Let B be the event that the blue coin was selected. Let also Hi be the event
that the ith toss resulted in heads. Given the choice of a coin, the events H1 and
H2 are independent, because of our assumption of independent tosses. Thus,
P(H1 ∩H2 | B) = P(H1 | B)P(H2 | B) = 0.99 · 0.99.
On the other hand, the events H1 and H2 are not independent. Intuitively, if we
are told that the ﬁrst toss resulted in heads, this leads us to suspect that the blue
coin was selected, in which case, we expect the second toss to also result in heads.
Mathematically, we use the total probability theorem to obtain
P(H1) = P(B)P(H1 | B) + P(Bc)P(H1 | Bc) = 1
2 · 0.99 + 1
2 · 0.01 = 1
2,

Sec. 1.5
Independence
35
as should be expected from symmetry considerations. Similarly, we have P(H2) =
1/2. Now notice that
P(H1 ∩H2) = P(B)P(H1 ∩H2 | B) + P(Bc)P(H1 ∩H2 | Bc)
= 1
2 · 0.99 · 0.99 + 1
2 · 0.01 · 0.01 ≈1
2.
Thus, P(H1 ∩H2) ̸= P(H1)P(H2), and the events H1 and H2 are dependent, even
though they are conditionally independent given B.
As mentioned earlier, if A and B are independent, the occurrence of B does
not provide any new information on the probability of A occurring. It is then
intuitive that the non-occurrence of B should also provide no information on the
probability of A. Indeed, it can be veriﬁed that if A and B are independent, the
same holds true for A and Bc (see the theoretical problems).
We now summarize.
Independence
• Two events A and B are said to independent if
P(A ∩B) = P(A)P(B).
If in addition, P(B) > 0, independence is equivalent to the condition
P(A | B) = P(A).
• If A and B are independent, so are A and Bc.
• Two events A and B are said to be conditionally independent, given
another event C with P(C) > 0, if
P(A ∩B | C) = P(A | C)P(B | C).
If in addition, P(B ∩C) > 0, conditional independence is equivalent
to the condition
P(A | B ∩C) = P(A | C).
• Independence does not imply conditional independence, and vice versa.
Independence of a Collection of Events
The deﬁnition of independence can be extended to multiple events.

36
Sample Space and Probability
Chap. 1
Deﬁnition of Independence of Several Events
We say that the events A1, A2, . . . , An are independent if
P

i∈S
Ai

=

i∈S
P(Ai),
for every subset S of {1, 2, . . . , n}.
If we have a collection of three events, A1, A2, and A3, independence
amounts to satisfying the four conditions
P(A1 ∩A2) = P(A1) P(A2),
P(A1 ∩A3) = P(A1) P(A3),
P(A2 ∩A3) = P(A2) P(A3),
P(A1 ∩A2 ∩A3) = P(A1) P(A2) P(A3).
The ﬁrst three conditions simply assert that any two events are independent,
a property known as pairwise independence.
But the fourth condition is
also important and does not follow from the ﬁrst three. Conversely, the fourth
condition does not imply the ﬁrst three; see the two examples that follow.
Example 1.20.
Pairwise independence does not imply independence.
Consider two independent fair coin tosses, and the following events:
H1 = {1st toss is a head},
H2 = {2nd toss is a head},
D = {the two tosses have diﬀerent results}.
The events H1 and H2 are independent, by deﬁnition. To see that H1 and D are
independent, we note that
P(D | H1) = P(H1 ∩D)
P(H1)
= 1/4
1/2 = 1
2 = P(D).
Similarly, H2 and D are independent. On the other hand, we have
P(H1 ∩H2 ∩D) = 0 ̸= 1
2 · 1
2 · 1
2 = P(H1)P(H2)P(D),
and these three events are not independent.
Example 1.21. The equality P(A1 ∩A2 ∩A3) = P(A1) P(A2) P(A3) is not
enough for independence.
Consider two independent rolls of a fair die, and

Sec. 1.5
Independence
37
the following events:
A = {1st roll is 1, 2, or 3},
B = {1st roll is 3, 4, or 5},
C = {the sum of the two rolls is 9}.
We have
P(A ∩B) = 1
6 ̸= 1
2 · 1
2 = P(A)P(B),
P(A ∩C) = 1
36 ̸= 1
2 · 4
36 = P(A)P(C),
P(B ∩C) = 1
12 ̸= 1
2 · 4
36 = P(B)P(C).
Thus the three events A, B, and C are not independent, and indeed no two of these
events are independent. On the other hand, we have
P(A ∩B ∩C) = 1
36 = 1
2 · 1
2 · 4
36 = P(A)P(B)P(C).
The intuition behind the independence of a collection of events is anal-
ogous to the case of two events. Independence means that the occurrence or
non-occurrence of any number of the events from that collection carries no
information on the remaining events or their complements. For example, if the
events A1, A2, A3, A4 are independent, one obtains relations such as
P(A1 ∪A2 | A3 ∩A4) = P(A1 ∪A2)
or
P(A1 ∪Ac
2 | Ac
3 ∩A4) = P(A1 ∪Ac
2);
see the theoretical problems.
Reliability
In probabilistic models of complex systems involving several components, it is
often convenient to assume that the components behave “independently” of each
other. This typically simpliﬁes the calculations and the analysis, as illustrated
in the following example.
Example 1.22.
Network connectivity.
A computer network connects two
nodes A and B through intermediate nodes C, D, E, F, as shown in Fig. 1.14(a).
For every pair of directly connected nodes, say i and j, there is a given probability
pij that the link from i to j is up. We assume that link failures are independent

38
Sample Space and Probability
Chap. 1
A
B
C
F
E
D
0.9
0.8
0.95
0.9
0.85
0.75
(a)
(b)
Series Connection
Parallel Connection
1
2
3
1
2
3
0.95
Figure 1.14: (a) Network for Example 1.22. The number next to each link
(i, j) indicates the probability that the link is up.
(b) Series and parallel
connections of three components in a reliability problem.
of each other. What is the probability that there is a path connecting A and B in
which all links are up?
This is a typical problem of assessing the reliability of a system consisting of
components that can fail independently. Such a system can often be divided into
subsystems, where each subsystem consists in turn of several components that are
connected either in series or in parallel; see Fig. 1.14(b).
Let a subsystem consist of components 1, 2, . . . , m, and let pi be the prob-
ability that component i is up (“succeeds”). Then, a series subsystem succeeds
if all of its components are up, so its probability of success is the product of the
probabilities of success of the corresponding components, i.e.,
P(series subsystem succeeds) = p1p2 · · · pm.
A parallel subsystem succeeds if any one of its components succeeds, so its prob-
ability of failure is the product of the probabilities of failure of the corresponding
components, i.e.,
P(parallel subsystem succeeds) = 1 −P(parallel subsystem fails)
= 1 −(1 −p1)(1 −p2) · · · (1 −pm).
Returning now to the network of Fig. 1.14(a), we can calculate the probabil-
ity of success (a path from A to B is available) sequentially, using the preceding
formulas, and starting from the end. Let us use the notation X →Y to denote the

Sec. 1.5
Independence
39
event that there is a (possibly indirect) connection from node X to node Y . Then,
P(C →B) = 1 −
1 −P(C →E and E →B)
1 −P(C →F and F →B)
= 1 −(1 −pCEpEB)(1 −pCF pF B)
= 1 −(1 −0.8 · 0.9)(1 −0.85 · 0.95)
= 0.946,
P(A →C and C →B) = P(A →C)P(C →B) = 0.9 · 0.946 = 0.851,
P(A →D and D →B) = P(A →D)P(D →B) = 0.75 · 0.95 = 0.712,
and ﬁnally we obtain the desired probability
P(A →B) = 1 −
1 −P(A →C and C →B)
1 −P(A →D and D →B)
= 1 −(1 −0.851)(1 −0.712)
= 0.957.
Independent Trials and the Binomial Probabilities
If an experiment involves a sequence of independent but identical stages, we say
that we have a sequence of independent trials. In the special case where there
are only two possible results at each stage, we say that we have a sequence of
independent Bernoulli trials. The two possible results can be anything, e.g.,
“it rains” or “it doesn’t rain,” but we will often think in terms of coin tosses and
refer to the two results as “heads” (H) and “tails” (T).
Consider an experiment that consists of n independent tosses of a biased
coin, in which the probability of “heads” is p, where p is some number between
0 and 1. In this context, independence means that the events A1, A2, . . . , An are
independent, where Ai = {ith toss is a head}.
We can visualize independent Bernoulli trials by means of a sequential
description, as shown in Fig. 1.15 for the case where n = 3. The conditional
probability of any toss being a head, conditioned on the results of any preced-
ing tosses is p, because of independence. Thus, by multiplying the conditional
probabilities along the corresponding path of the tree, we see that any particular
outcome (3-long sequence of heads and tails) that involves k heads and 3 −k
tails has probability pk(1 −p)3−k. This formula extends to the case of a general
number n of tosses. We obtain that the probability of any particular n-long
sequence that contains k heads and n −k tails is pk(1 −p)n−k, for all k from 0
to n.
Let us now consider the probability
p(k) = P(k heads come up in an n-toss sequence),

40
Sample Space and Probability
Chap. 1
p
p
p
p
p
p
p
1 - p
1 - p
1 - p
1 - p
1 - p
1 - p
1 - p
HHH
HHT
HTH
HTT
THH
THT
TTH
TTT
Prob = p2(1 - p)
Prob = p3
Prob = (1 - p)3
Prob = p(1 - p)2
Prob = p2(1 - p)
Prob = p2(1 - p)
Prob = p(1 - p)2
Prob = p(1 - p)2
HH
HT
TH
TT
H
T
Figure 1.15: Sequential description of the sample space of an experiment involv-
ing three independent tosses of a biased coin. Along the branches of the tree,
we record the corresponding conditional probabilities, and by the multiplication
rule, the probability of obtaining a particular 3-toss sequence is calculated by
multiplying the probabilities recorded along the corresponding path of the tree.
which will play an important role later. We showed above that the probability
of any given sequence that contains k heads is pk(1 −p)n−k, so we have
p(k) =
n
k

pk(1 −p)n−k,
where
n
k

= number of distinct n-toss sequences that contain k heads.
The numbers
n
k

(called “n choose k”) are known as the binomial coeﬃcients,
while the probabilities p(k) are known as the binomial probabilities. Using a
counting argument, to be given in Section 1.6, one ﬁnds that
n
k

=
n!
k! (n −k)!,
k = 0, 1, . . . , n,
where for any positive integer i we have
i! = 1 · 2 · · · (i −1) · i,

Sec. 1.6
Counting∗
41
and, by convention, 0! = 1. An alternative veriﬁcation is sketched in the theo-
retical problems. Note that the binomial probabilities p(k) must add to 1, thus
showing the binomial formula
n

k=0
n
k

pk(1 −p)n−k = 1.
Example 1.23. Grade of service.
An internet service provider has installed c
modems to serve the needs of a population of n customers. It is estimated that at a
given time, each customer will need a connection with probability p, independently
of the others. What is the probability that there are more customers needing a
connection than there are modems?
Here we are interested in the probability that more than c customers simul-
taneously need a connection. It is equal to
n

k=c+1
p(k),
where
p(k) =

n
k

pk(1 −p)n−k
are the binomial probabilities.
This example is typical of problems of sizing the capacity of a facility to
serve the needs of a homogeneous population, consisting of independently acting
customers. The problem is to select the size c to achieve a certain threshold prob-
ability (sometimes called grade of service) that no user is left unserved.
1.6
COUNTING∗
The calculation of probabilities often involves counting of the number of out-
comes in various events. We have already seen two contexts where such counting
arises.
(a) When the sample space Ωhas a ﬁnite number of equally likely outcomes,
so that the discrete uniform probability law applies. Then, the probability
of any event A is given by
P(A) = Number of elements of A
Number of elements of Ω,
and involves counting the elements of A and of Ω.
(b) When we want to calculate the probability of an event A with a ﬁnite
number of equally likely outcomes, each of which has an already known
probability p. Then the probability of A is given by
P(A) = p · (Number of elements of A),

42
Sample Space and Probability
Chap. 1
and involves counting of the number of elements of A. An example of this
type is the calculation of the probability of k heads in n coin tosses (the
binomial probabilities). We saw there that the probability of each distinct
sequence involving k heads is easily obtained, but the calculation of the
number of all such sequences is somewhat intricate, as will be seen shortly.
While counting is in principle straightforward, it is frequently challenging;
the art of counting constitutes a large portion of a ﬁeld known as combinatorics.
In this section, we present the basic principle of counting and apply it to a number
of situations that are often encountered in probabilistic models.
The Counting Principle
The counting principle is based on a divide-and-conquer approach, whereby the
counting is broken down into stages through the use of a tree. For example,
consider an experiment that consists of two consecutive stages. The possible
results of the ﬁrst stage are a1, a2, . . . , am; the possible results of the second
stage are b1, b2, . . . , bn. Then, the possible results of the two-stage experiment
are all possible ordered pairs (ai, bj), i = 1, . . . , m, j = 1, . . . , n. Note that the
number of such ordered pairs is equal to mn. This observation can be generalized
as follows (see also Fig. 1.16).
Leaves
. . . . . . 
. . . . . . 
. . . . . . 
. . . . 
Stage 1
Stage 2 Stage 3 Stage 4
n1
Choices
n2
Choices
n3
Choices
n4
Choices
Figure 1.16: Illustration of the basic counting principle. The counting is carried
out in r stages (r = 4 in the ﬁgure). The ﬁrst stage has n1 possible results. For
every possible result of the ﬁrst i −1 stages, there are ni possible results at the
ith stage. The number of leaves is n1n2 · · · nr. This is the desired count.

Sec. 1.6
Counting∗
43
The Counting Principle
Consider a process that consists of r stages. Suppose that:
(a) There are n1 possible results for the ﬁrst stage.
(b) For every possible result of the ﬁrst stage, there are n2 possible results
at the second stage.
(c) More generally, for all possible results of the ﬁrst i −1 stages, there
are ni possible results at the ith stage.
Then, the total number of possible results of the r-stage process is
n1 · n2 · · · nr.
Example 1.24. The number of telephone numbers.
A telephone number
is a 7-digit sequence, but the ﬁrst digit has to be diﬀerent from 0 or 1. How many
distinct telephone numbers are there? We can visualize the choice of a sequence
as a sequential process, where we select one digit at a time. We have a total of 7
stages, and a choice of one out of 10 elements at each stage, except for the ﬁrst
stage where we only have 8 choices. Therefore, the answer is
8 · 10 · 10 · · · 10



6 times
= 8 · 106.
Example 1.25. The number of subsets of an n-element set.
Consider an
n-element set {s1, s2, . . . , sn}. How many subsets does it have (including itself and
the empty set)? We can visualize the choice of a subset as a sequential process
where we examine one element at a time and decide whether to include it in the set
or not. We have a total of n stages, and a binary choice at each stage. Therefore
the number of subsets is
2 · 2 · · · 2



n times
= 2n.
It should be noted that the Counting Principle remains valid even if each
ﬁrst-stage result leads to a diﬀerent set of potential second-stage results, etc. The
only requirement is that the number of possible second-stage results is constant,
regardless of the ﬁrst-stage result. This observation is used in the sequel.
In what follows, we will focus primarily on two types of counting arguments
that involve the selection of k objects out of a collection of n objects. If the order
of selection matters, the selection is called a permutation, and otherwise, it is

44
Sample Space and Probability
Chap. 1
called a combination. We will then discuss a more general type of counting,
involving a partition of a collection of n objects into multiple subsets.
k-permutations
We start with n distinct objects, and let k be some positive integer, with k ≤n.
We wish to count the number of diﬀerent ways that we can pick k out of these
n objects and arrange them in a sequence, i.e., the number of distinct k-object
sequences. We can choose any of the n objects to be the ﬁrst one. Having chosen
the ﬁrst, there are only n −1 possible choices for the second; given the choice of
the ﬁrst two, there only remain n −2 available objects for the third stage, etc.
When we are ready to select the last (the kth) object, we have already chosen
k −1 objects, which leaves us with n −(k −1) choices for the last one. By the
Counting Principle, the number of possible sequences, called k-permutations,
is
n(n −1) · · · (n −k + 1) = n(n −1) · · · (n −k + 1)(n −k) · · · 2 · 1
(n −k) · · · 2 · 1
=
n!
(n −k)!.
In the special case where k = n, the number of possible sequences, simply called
permutations, is
n · (n −1) · (n −2) · · · 2 · 1 = n!.
(Let k = n in the formula for the number of k-permutations, and recall the
convention 0! = 1.)
Example 1.26.
Let us count the number of words that consist of four distinct
letters. This is the problem of counting the number of 4-permutations of the 26
letters in the alphabet. The desired number is
n!
(n −k)! = 26!
22! = 26 · 25 · 24 · 23 = 358, 800.
The count for permutations can be combined with the Counting Principle
to solve more complicated counting problems.
Example 1.27.
You have n1 classical music CDs, n2 rock music CDs, and n3
country music CDs. In how many diﬀerent ways can you arrange them so that the
CDs of the same type are contiguous?
We break down the problem in two stages, where we ﬁrst select the order of
the CD types, and then the order of the CDs of each type. There are 3! ordered se-
quences of the types of CDs (such as classical/rock/country, rock/country/classical,
etc), and there are n1! (or n2!, or n3!) permutations of the classical (or rock, or

Sec. 1.6
Counting∗
45
country, respectively) CDs. Thus for each of the 3! CD type sequences, there are
n1! n2! n3! arrangements of CDs, and the desired total number is 3! n1! n2! n3!.
Combinations
There are n people and we are interested in forming a committee of k. How
many diﬀerent committees are there? More abstractly, this is the same as the
problem of counting the number of k-element subsets of a given n-element set.
Notice that forming a combination is diﬀerent than forming a k-permutation,
because in a combination there is no ordering of the selected elements.
Thus for example, whereas the 2-permutations of the letters A, B, C, and D are
AB, AC, AD, BA, BC, BD, CA, CB, CD, DA, DB, DC,
the combinations of two out four of these letters are
AB, AC, AD, BC, BD, CD.
There is a close connection between the number of combinations and the
binomial coeﬃcient that was introduced in Section 1.5. To see this note that
specifying an n-toss sequence with k heads is the same as picking k elements
(those that correspond to heads) out of the n-element set of tosses. Thus, the
number of combinations is the same as the binomial coeﬃcient
n
k

introduced
in Section 1.5.
To count the number of combinations, note that selecting a k-permutation
is the same as ﬁrst selecting a combination of k items and then ordering them.
Since there are k! ways of ordering the k selected items, we see that the number
of k-permutations is equal to the number of combinations times k!. Hence, the
number of possible combinations, is given by
n
k

=
n!
k! (n −k)!.
Example 1.28.
The number of combinations of two out of the four letters A, B,
C, and D is found by letting n = 4 and k = 2. It is

4
2

=
4!
2! 2! = 6,
consistently with the listing given earlier.
It is worth observing that counting arguments sometimes lead to formulas
that are rather diﬃcult to derive algebraically. One example is the binomial
formula
n

k=0
n
k

pk(1 −p)n−k = 1

46
Sample Space and Probability
Chap. 1
discussed in Section 1.5. Here is another example. Since
n
k

is the number of
k-element subsets of a given n-element subset, the sum over k of
n
k

counts the
number of subsets of all possible cardinalities. It is therefore equal to the number
of all subsets of an n-element set, which is 2n, and we obtain
n

k=0
n
k

= 2n.
Partitions
Recall that a combination is a choice of k elements out of an n-element set
without regard to order. This is the same as partitioning the set in two: one
part contains k elements and the other contains the remaining n −k. We now
generalize by considering partitions in more than two subsets.
We have n distinct objects and we are given nonnegative integers n1, n2, . . . ,
nr, whose sum is equal to n.
The n items are to be divided into r disjoint groups,
with the ith group containing exactly ni items. Let us count in how many ways
this can be done.
We form the groups one at a time. We have
 n
n1

ways of forming the ﬁrst
group. Having formed the ﬁrst group, we are left with n −n1 objects. We need
to choose n2 of them in order to form the second group, and we have
n−n1
n2

choices, etc.
Using the Counting Principle for this r-stage process, the total
number of choices is
 n
n1
n −n1
n2
n −n1 −n2
n3

· · ·
n −n1 −· · · −nr−1
nr

,
which is equal to
n!
n1! (n −n1)!
(n −n1)!
n2! (n −n1 −n2)! · · ·
(n −n1 −· · · −nr−1)!
(n −n1 −· · · −nr−1 −nr)! nr!.
We note that several terms cancel and we are left with
n!
n1! n2! · · · nr!.
This is called the multinomial coeﬃcient and is usually denoted by

n
n1, n2, . . . , nr

.
Example 1.29. Anagrams.
How many diﬀerent letter sequences can be obtained
by rearranging the letters in the word TATTOO? There are six positions to be ﬁlled

Sec. 1.6
Counting∗
47
by the available letters. Each rearrangement corresponds to a partition of the set of
the six positions into a group of size 3 (the positions that get the letter T), a group
of size 1 (the position that gets the letter A), and a group of size 2 (the positions
that get the letter O). Thus, the desired number is
6!
1! 2! 3! = 1 · 2 · 3 · 4 · 5 · 6
1 · 1 · 2 · 1 · 2 · 3 = 60.
It is instructive to rederive this answer using an alternative argument. (This
argument can also be used to rederive the multinomial coeﬃcient formula; see
the theoretical problems.) Let us rewrite TATTOO in the form T1AT2T3O1O2
pretending for a moment that we are dealing with 6 distinguishable objects. These
6 objects can be rearranged in 6! diﬀerent ways. However, any of the 3! possible
permutations of T1, T1, and T3, as well as any of the 2! possible permutations of
O1 and O2, lead to the same word. Thus, when the subscripts are removed, there
are only 6!/(3! 2!) diﬀerent words.
Example 1.30.
A class consisting of 4 graduate and 12 undergraduate students
is randomly divided into four groups of 4. What is the probability that each group
includes a graduate student? This is the same as Example 1.11 in Section 1.3, but
we will now obtain the answer using a counting argument.
We ﬁrst determine the nature of the sample space. A typical outcome is a
particular way of partitioning the 16 students into four groups of 4. We take the
term “randomly” to mean that every possible partition is equally likely, so that the
probability question can be reduced to one of counting.
According to our earlier discussion, there are

16
4, 4, 4, 4

=
16!
4! 4! 4! 4!
diﬀerent partitions, and this is the size of the sample space.
Let us now focus on the event that each group contains a graduate student.
Generating an outcome with this property can be accomplished in two stages:
(a) Take the four graduate students and distribute them to the four groups; there
are four choices for the group of the ﬁrst graduate student, three choices for
the second, two for the third. Thus, there is a total of 4! choices for this stage.
(b) Take the remaining 12 undergraduate students and distribute them to the
four groups (3 students in each). This can be done in

12
3, 3, 3, 3

=
12!
3! 3! 3! 3!
diﬀerent ways.
By the Counting Principle, the event of interest can materialize in
4! 12!
3! 3! 3! 3!

48
Sample Space and Probability
Chap. 1
diﬀerent ways. The probability of this event is
4! 12!
3! 3! 3! 3!
16!
4! 4! 4! 4!
.
After some cancellations, we can see that this is the same as the answer 12 · 8 ·
4/(15 · 14 · 13) obtained in Example 1.11.
Here is a summary of all the counting results we have developed.
Summary of Counting Results
• Permutations of n objects: n!
• k-permutations of n objects: n!/(n −k)!
• Combinations of k out of n objects:
n
k

=
n!
k!(n −k)!
• Partitions of n objects into r groups with the ith group having ni
objects:

n
n1, n2, . . . , nr

=
n!
n1! n2! · · · nr!.
1.7
SUMMARY AND DISCUSSION
A probability problem can usually be broken down into a few basic steps:
1. The description of the sample space, that is, the set of possible outcomes
of a given experiment.
2. The (possibly indirect) speciﬁcation of the probability law (the probability
of each event).
3. The calculation of probabilities and conditional probabilities of various
events of interest.
The probabilities of events must satisfy the nonnegativity, additivity, and nor-
malization axioms. In the important special case where the set of possible out-
comes is ﬁnite, one can just specify the probability of each outcome and obtain
the probability of any event by adding the probabilities of the elements of the
event.
Conditional probabilities can be viewed as probability laws on the same
sample space. We can also view the conditioning event as a new universe, be-

Sec. 1.7
Summary and Discussion
49
cause only outcomes contained in the conditioning event can have positive condi-
tional probability. Conditional probabilities are derived from the (unconditional)
probability law using the deﬁnition P(A | B) = P(A ∩B)/P(B). However, the
reverse process is often convenient, that is, ﬁrst specify some conditional proba-
bilities that are natural for the real situation that we wish to model, and then
use them to derive the (unconditional) probability law. Two important tools in
this context are the multiplication rule and the total probability theorem.
We have illustrated through examples three methods of specifying proba-
bility laws in probabilistic models:
(1) The counting method. This method applies to the case where the num-
ber of possible outcomes is ﬁnite, and all outcomes are equally likely. To
calculate the probability of an event, we count the number of elements in
the event and divide by the number of elements of the sample space.
(2) The sequential method. This method applies when the experiment has a
sequential character, and suitable conditional probabilities are speciﬁed or
calculated along the branches of the corresponding tree (perhaps using the
counting method). The probabilities of various events are then obtained
by multiplying conditional probabilities along the corresponding paths of
the tree, using the multiplication rule.
(3) The divide-and-conquer method. Here, the probabilities P(B) of vari-
ous events B are obtained from conditional probabilities P(B | Ai), where
the Ai are suitable events that form a partition of the sample space and
have known probabilities P(Ai). The probabilities P(B) are then obtained
by using the total probability theorem.
Finally, we have focused on a few side topics that reinforce our main themes.
We have discussed the use of Bayes’ rule in inference, which is an important
application context. We have also discussed some basic principles of counting
and combinatorics, which are helpful in applying the counting method.

2
Discrete Random Variables
Contents
2.1. Basic Concepts . . . . . . . . . . . . . . . . . . . . . . p. 2
2.2. Probability Mass Functions
. . . . . . . . . . . . . . . . p. 4
2.3. Functions of Random Variables . . . . . . . . . . . . . . . p. 9
2.4. Expectation, Mean, and Variance . . . . . . . . . . . . .
p. 11
2.5. Joint PMFs of Multiple Random Variables . . . . . . . . .
p. 22
2.6. Conditioning . . . . . . . . . . . . . . . . . . . . . .
p. 27
2.7. Independence . . . . . . . . . . . . . . . . . . . . . .
p. 36
2.8. Summary and Discussion
. . . . . . . . . . . . . . . .
p. 42
1

2
Discrete Random Variables
Chap. 2
2.1
BASIC CONCEPTS
In many probabilistic models, the outcomes are of a numerical nature, e.g., if
they correspond to instrument readings or stock prices. In other experiments,
the outcomes are not numerical, but they may be associated with some numerical
values of interest. For example, if the experiment is the selection of students from
a given population, we may wish to consider their grade point average. When
dealing with such numerical values, it is often useful to assign probabilities to
them. This is done through the notion of a random variable, the focus of the
present chapter.
Given an experiment and the corresponding set of possible outcomes (the
sample space), a random variable associates a particular number with each out-
come; see Fig. 2.1. We refer to this number as the numerical value or the
experimental value of the random variable. Mathematically, a random vari-
able is a real-valued function of the experimental outcome.
1
1
2
2
3
3
4
4
Real Number Line
1
2
3
4
(a)
(b)
Sample Space
Ω
x
Random Variable X
Real Number Line
Random Variable:
X = Maximum Roll
Sample Space:
Pairs of Rolls
Figure 2.1: (a) Visualization of a random variable. It is a function that assigns
a numerical value to each possible outcome of the experiment. (b) An example
of a random variable. The experiment consists of two rolls of a 4-sided die, and
the random variable is the maximum of the two rolls.
If the outcome of the
experiment is (4, 2), the experimental value of this random variable is 4.
Here are some examples of random variables:
(a) In an experiment involving a sequence of 5 tosses of a coin, the number of
heads in the sequence is a random variable. However, the 5-long sequence

Sec. 2.1
Basic Concepts
3
of heads and tails is not considered a random variable because it does not
have an explicit numerical value.
(b) In an experiment involving two rolls of a die, the following are examples of
random variables:
(1) The sum of the two rolls.
(2) The number of sixes in the two rolls.
(3) The second roll raised to the ﬁfth power.
(c) In an experiment involving the transmission of a message, the time needed
to transmit the message, the number of symbols received in error, and the
delay with which the message is received are all random variables.
There are several basic concepts associated with random variables, which
are summarized below.
Main Concepts Related to Random Variables
Starting with a probabilistic model of an experiment:
• A random variable is a real-valued function of the outcome of the
experiment.
• A function of a random variable deﬁnes another random variable.
• We can associate with each random variable certain “averages” of in-
terest, such the mean and the variance.
• A random variable can be conditioned on an event or on another
random variable.
• There is a notion of independence of a random variable from an
event or from another random variable.
A random variable is called discrete if its range (the set of values that
it can take) is ﬁnite or at most countably inﬁnite. For example, the random
variables mentioned in (a) and (b) above can take at most a ﬁnite number of
numerical values, and are therefore discrete.
A random variable that can take an uncountably inﬁnite number of values
is not discrete. For an example, consider the experiment of choosing a point
a from the interval [−1, 1]. The random variable that associates the numerical
value a2 to the outcome a is not discrete. On the other hand, the random variable
that associates with a the numerical value
sgn(a) =

1
if a > 0,
0
if a = 0,
−1
if a < 0,
is discrete.

4
Discrete Random Variables
Chap. 2
In this chapter, we focus exclusively on discrete random variables, even
though we will typically omit the qualiﬁer “discrete.”
Concepts Related to Discrete Random Variables
Starting with a probabilistic model of an experiment:
• A discrete random variable is a real-valued function of the outcome
of the experiment that can take a ﬁnite or countably inﬁnite number
of values.
• A (discrete) random variable has an associated probability mass
function (PMF), which gives the probability of each numerical value
that the random variable can take.
• A function of a random variable deﬁnes another random variable,
whose PMF can be obtained from the PMF of the original random
variable.
We will discuss each of the above concepts and the associated methodology
in the following sections. In addition, we will provide examples of some important
and frequently encountered random variables.
In Chapter 3, we will discuss
general (not necessarily discrete) random variables.
Even though this chapter may appear to be covering a lot of new ground,
this is not really the case. The general line of development is to simply take
the concepts from Chapter 1 (probabilities, conditioning, independence, etc.)
and apply them to random variables rather than events, together with some
appropriate new notation. The only genuinely new concepts relate to means and
variances.
2.2
PROBABILITY MASS FUNCTIONS
The most important way to characterize a random variable is through the prob-
abilities of the values that it can take. For a discrete random variable X, these
are captured by the probability mass function (PMF for short) of X, denoted
pX. In particular, if x is any possible value of X, the probability mass of x,
denoted pX(x), is the probability of the event {X = x} consisting of all outcomes
that give rise to a value of X equal to x:
pX(x) = P

{X = x}

.
For example, let the experiment consist of two independent tosses of a fair coin,
and let X be the number of heads obtained. Then the PMF of X is
pX(x) =
 1/4
if x = 0 or x = 2,
1/2
if x = 1,
0
otherwise.

Sec. 2.2
Probability Mass Functions
5
In what follows, we will often omit the braces from the event/set notation,
when no ambiguity can arise. In particular, we will usually write P(X = x)
in place of the more correct notation P

{X = x}

.
We will also adhere to
the following convention throughout: we will use upper case characters
to denote random variables, and lower case characters to denote real
numbers such as the numerical values of a random variable.
Note that

x
pX(x) = 1,
where in the summation above, x ranges over all the possible numerical values
of X. This follows from the additivity and normalization axioms, because the
events {X = x} are disjoint and form a partition of the sample space, as x
ranges over all possible values of X. By a similar argument, for any set S of real
numbers, we also have
P(X ∈S) =

x∈S
pX(x).
For example, if X is the number of heads obtained in two independent tosses of
a fair coin, as above, the probability of at least one head is
P(X > 0) =

x>0
pX(x) = 1
2 + 1
4 = 3
4.
Calculating the PMF of X is conceptually straightforward, and is illus-
trated in Fig. 2.2.
Calculation of the PMF of a Random Variable X
For each possible value x of X:
1. Collect all the possible outcomes that give rise to the event {X = x}.
2. Add their probabilities to obtain pX(x).
The Bernoulli Random Variable
Consider the toss of a biased coin, which comes up a head with probability p,
and a tail with probability 1 −p. The Bernoulli random variable takes the two
values 1 and 0, depending on whether the outcome is a head or a tail:
X =
 1
if a head,
0
if a tail.
Its PMF is
pX(x) =

p
if x = 1,
1 −p
if x = 0.

6
Discrete Random Variables
Chap. 2
1
1
2
2
3
3
4
4
Sample Space:
Pairs of Rolls
1
2
3
4
Random Variable:
X  = Maximum Roll
1
16
3
16
7
16
5
16
(a)
(b)
Sample Space
Ω
pX(x)
x
x
pX(x)
Event {X=x}
Figure 2.2: (a) Illustration of the method to calculate the PMF of a random
variable X. For each possible value x, we collect all the outcomes that give rise
to X = x and add their probabilities to obtain pX(x). (b) Calculation of the
PMF pX of the random variable X = maximum roll in two independent rolls
of a fair 4-sided die.
There are four possible values x, namely, 1, 2, 3, 4.
To
calculate pX(x) for a given x, we add the probabilities of the outcomes that give
rise to x. For example, there are three outcomes that give rise to x = 2, namely,
(1, 2), (2, 2), (2, 1). Each of these outcomes has probability 1/16, so pX(2) = 3/16,
as indicated in the ﬁgure.
For all its simplicity, the Bernoulli random variable is very important. In
practice, it is used to model generic probabilistic situations with just two out-
comes, such as:
(a) The state of a telephone at a given time that can be either free or busy.
(b) A person who can be either healthy or sick with a certain disease.
(c) The preference of a person who can be either for or against a certain po-
litical candidate.
Furthermore, by combining multiple Bernoulli random variables, one can con-
struct more complicated random variables.

Sec. 2.2
Probability Mass Functions
7
The Binomial Random Variable
A biased coin is tossed n times. At each toss, the coin comes up a head with
probability p, and a tail with probability 1−p, independently of prior tosses. Let
X be the number of heads in the n-toss sequence. We refer to X as a binomial
random variable with parameters n and p. The PMF of X consists of the
binomial probabilities that were calculated in Section 1.4:
pX(k) = P(X = k) =
n
k

pk(1 −p)n−k,
k = 0, 1, . . . , n.
(Note that here and elsewhere, we simplify notation and use k, instead of x, to
denote the experimental values of integer-valued random variables.) The nor-
malization property 	
x pX(x) = 1, specialized to the binomial random variable,
is written as
n

k=0
n
k

pk(1 −p)n−k = 1.
Some special cases of the binomial PMF are sketched in Fig. 2.3.
0
1
2
9
8
7
6
5
4
3
Binomial PMF n = 9, p = 1/2
0
n
Binomial PMF 
n = Large, p = Small
pX(k)
k
pX(k)
k
Figure 2.3: The PMF of a binomial random variable. If p = 1/2, the PMF is
symmetric around n/2. Otherwise, the PMF is skewed towards 0 if p < 1/2, and
towards n if p > 1/2.
The Geometric Random Variable
Suppose that we repeatedly and independently toss a biased coin with probability
of a head p, where 0 < p < 1. The geometric random variable is the number
X of tosses needed for a head to come up for the ﬁrst time. Its PMF is given by
pX(k) = (1 −p)k−1p,
k = 1, 2, . . . ,
since (1 −p)k−1p is the probability of the sequence consisting of k −1 successive
tails followed by a head; see Fig. 2.4. This is a legitimate PMF because
∞

k=1
pX(k) =
∞

k=1
(1 −p)k−1p = p
∞

k=0
(1 −p)k = p ·
1
1 −(1 −p) = 1.

8
Discrete Random Variables
Chap. 2
Naturally, the use of coin tosses here is just to provide insight.
More
generally, we can interpret the geometric random variable in terms of repeated
independent trials until the ﬁrst “success.” Each trial has probability of success
p and the number of trials until (and including) the ﬁrst success is modeled by
the geometric random variable.
k
1
p
0
3
2
px(k)
Figure 2.4: The PMF
pX(k) = (1 −p)k−1p,
k = 1, 2, . . . ,
of a geometric random variable.
It decreases as a geometric progression with
parameter 1 −p.
The Poisson Random Variable
A Poisson random variable takes nonnegative integer values. Its PMF is given
by
pX(k) = e−λ λk
k! ,
k = 0, 1, 2, . . . ,
where λ is a positive parameter characterizing the PMF, see Fig. 2.5. It is a
legitimate PMF because
∞

k=0
e−λ λk
k! = e−λ

1 + λ + λ2
2! + λ3
3! + · · ·

= e−λeλ = 1.
To get a feel for the Poisson random variable, think of a binomial random
variable with very small p and very large n. For example, consider the number
of typos in a book with a total of n words, when the probability p that any one
word is misspelled is very small (associate a word with a coin toss which comes
a head when the word is misspelled), or the number of cars involved in accidents
in a city on a given day (associate a car with a coin toss which comes a head
when the car has an accident). Such a random variable can be well-modeled as
a Poisson random variable.

Sec. 2.3
Functions of Random Variables
9
k
px(k)
1
e −λ ~ 0.6
0
3
2
Poisson λ = 0.5
Poisson λ = 3
k
px(k)
1
e −λ ~ 0.05
0
3
2
4
6
5
7
Figure 2.5: The PMF e−λ λk
k! of the Poisson random variable for diﬀerent values
of λ.
Note that if λ < 1, then the PMF is monotonically decreasing, while if
λ > 1, the PMF ﬁrst increases and then decreases as the value of k increases (this
is shown in the end-of-chapter problems).
More precisely, the Poisson PMF with parameter λ is a good approximation
for a binomial PMF with parameters n and p, provided λ = np, n is very large,
and p is very small, i.e.,
e−λ λk
k! ≈
n!
(n −k)!k!pk(1 −p)n−k,
k = 0, 1, . . . , n.
In this case, using the Poisson PMF may result in simpler models and calcula-
tions. For example, let n = 100 and p = 0.01. Then the probability of k = 5
successes in n = 100 trials is calculated using the binomial PMF as
100!
95! 5!0.015(1 −0.01)95 = 0.00290.
Using the Poisson PMF with λ = np = 100 · 0.01 = 1, this probability is
approximated by
e−1 1
5! = 0.00306.
We provide a formal justiﬁcation of the Poisson approximation property
in the end-of-chapter problems and also in Chapter 5, where we will further
interpret it, extend it, and use it in the context of the Poisson process.
2.3
FUNCTIONS OF RANDOM VARIABLES
Consider a probability model of today’s weather, let the random variable X
be the temperature in degrees Celsius, and consider the transformation Y =
1.8X + 32, which gives the temperature in degrees Fahrenheit. In this example,
Y is a linear function of X, of the form
Y = g(X) = aX + b,

10
Discrete Random Variables
Chap. 2
where a and b are scalars.
We may also consider nonlinear functions of the
general form
Y = g(X).
For example, if we wish to display temperatures on a logarithmic scale, we would
want to use the function g(X) = log X.
If Y = g(X) is a function of a random variable X, then Y is also a random
variable, since it provides a numerical value for each possible outcome. This is
because every outcome in the sample space deﬁnes a numerical value x for X
and hence also the numerical value y = g(x) for Y . If X is discrete with PMF
pX, then Y is also discrete, and its PMF pY can be calculated using the PMF
of X. In particular, to obtain pY (y) for any y, we add the probabilities of all
values of x such that g(x) = y:
pY (y) =

{x | g(x)=y}
pX(x).
Example 2.1.
Let Y = |X| and let us apply the preceding formula for the PMF
pY to the case where
pX(x) =
 1/9
if x is an integer in the range [−4, 4],
0
otherwise.
The possible values of Y are y = 0, 1, 2, 3, 4. To compute pY (y) for some given
value y from this range, we must add pX(x) over all values x such that |x| = y. In
particular, there is only one value of X that corresponds to y = 0, namely x = 0.
Thus,
pY (0) = pX(0) = 1
9.
Also, there are two values of X that correspond to each y = 1, 2, 3, 4, so for example,
pY (1) = pX(−1) + pX(1) = 2
9.
Thus, the PMF of Y is
pY (y) =
 2/9
if y = 1, 2, 3, 4,
1/9
if y = 0,
0
otherwise.
For another related example, let Z = X2.
To obtain the PMF of Z, we
can view it either as the square of the random variable X or as the square of the
random variable Y .
By applying the formula pZ(z) = 	
{x | x2=z} pX(x) or the
formula pZ(z) = 	
{y | y2=z} pY (y), we obtain
pZ(z) =
 2/9
if z = 1, 4, 9, 16,
1/9
if z = 0,
0
otherwise.

Sec. 2.4
Expectation, Mean, and Variance
11
-4
pX(x)
x
-3 -2 -1
0 1
2
3
4
pY(y)
y
0 1
2
3
4
1
9
1
9
2
9
Y = |X|
Figure 2.7: The PMFs of X and Y = |X| in Example 2.1.
2.4
EXPECTATION, MEAN, AND VARIANCE
The PMF of a random variable X provides us with several numbers, the proba-
bilities of all the possible values of X. It would be desirable to summarize this
information in a single representative number. This is accomplished by the ex-
pectation of X, which is a weighted (in proportion to probabilities) average of
the possible values of X.
As motivation, suppose you spin a wheel of fortune many times. At each
spin, one of the numbers m1, m2, . . . , mn comes up with corresponding proba-
bility p1, p2, . . . , pn, and this is your monetary reward from that spin. What is
the amount of money that you “expect” to get “per spin”? The terms “expect”
and “per spin” are a little ambiguous, but here is a reasonable interpretation.
Suppose that you spin the wheel k times, and that ki is the number of times
that the outcome is mi. Then, the total amount received is m1k1 + m2k2 + · · · +
mnkn. The amount received per spin is
M = m1k1 + m2k2 + · · · + mnkn
k
.
If the number of spins k is very large, and if we are willing to interpret proba-
bilities as relative frequencies, it is reasonable to anticipate that mi comes up a
fraction of times that is roughly equal to pi:
pi ≈ki
k ,
i = 1, . . . , n.
Thus, the amount of money per spin that you “expect” to receive is
M = m1k1 + m2k2 + · · · + mnkn
k
≈m1p1 + m2p2 + · · · + mnpn.
Motivated by this example, we introduce an important deﬁnition.

12
Discrete Random Variables
Chap. 2
Expectation
We deﬁne the expected value (also called the expectation or the mean)
of a random variable X, with PMF pX(x), by†
E[X] =

x
xpX(x).
Example 2.2.
Consider two independent coin tosses, each with a 3/4 probability
of a head, and let X be the number of heads obtained. This is a binomial random
variable with parameters n = 2 and p = 3/4. Its PMF is
pX(k) =
 (1/4)2
if k = 0,
2 · (1/4) · (3/4)
if k = 1,
(3/4)2
if k = 2,
so the mean is
E[X] = 0 ·

1
4
2
+ 1 ·

2 · 1
4 · 3
4

+ 2 ·

3
4
2
= 24
16 = 3
2.
It is useful to view the mean of X as a “representative” value of X, which
lies somewhere in the middle of its range. We can make this statement more
precise, by viewing the mean as the center of gravity of the PMF, in the sense
explained in Fig. 2.8.
† When dealing with random variables that take a countably inﬁnite num-
ber of values, one has to deal with the possibility that the inﬁnite sum 	
x xpX(x)
is not well-deﬁned. More concretely, we will say that the expectation is well-
deﬁned if 	
x |x|pX(x) < ∞. In that case, it is known that the inﬁnite sum
	
x xpX(x) converges to a ﬁnite value that is independent of the order in which
the various terms are summed.
For an example where the expectation is not well-deﬁned, consider a ran-
dom variable X that takes the value 2k with probability 2−k, for k = 1, 2, . . ..
For a more subtle example, consider the random variable X that takes the val-
ues 2k and −2k with probability 2−k, for k = 2, 3, . . .. The expectation is again
undeﬁned, even though the PMF is symmetric around zero and one might be
tempted to say that E[X] is zero.
Throughout this book, in lack of an indication to the contrary, we implicitly
assume that the expected value of the random variables of interest is well-deﬁned.

Sec. 2.4
Expectation, Mean, and Variance
13
x
Center of Gravity
c = Mean E[X]
Figure 2.8: Interpretation of the mean as a center of gravity. Given a bar with
a weight pX(x) placed at each point x with pX(x) > 0, the center of gravity c is
the point at which the sum of the torques from the weights to its left are equal
to the sum of the torques from the weights to its right, that is,

x
(x −c)pX(x) = 0,
or c =

x
xpX(x),
and the center of gravity is equal to the mean E[X].
There are many other quantities that can be associated with a random
variable and its PMF. For example, we deﬁne the 2nd moment of the random
variable X as the expected value of the random variable X2. More generally, we
deﬁne the nth moment as E[Xn], the expected value of the random variable
Xn. With this terminology, the 1st moment of X is just the mean.
The most important quantity associated with a random variable X, other
than the mean, is its variance, which is denoted by var(X) and is deﬁned as
the expected value of the random variable

X −E[X]
2, i.e.,
var(X) = E

X −E[X]
2
.
Since

X −E[X]
2 can only take nonnegative values, the variance is always
nonnegative.
The variance provides a measure of dispersion of X around its mean. An-
other measure of dispersion is the standard deviation of X, which is deﬁned
as the square root of the variance and is denoted by σX:
σX =

var(X).
The standard deviation is often easier to interpret, because it has the same units
as X. For example, if X measures length in meters, the units of variance are
square meters, while the units of the standard deviation are meters.
One way to calculate var(X), is to use the deﬁnition of expected value,
after calculating the PMF of the random variable

X −E[X]
2.
This latter

14
Discrete Random Variables
Chap. 2
random variable is a function of X, and its PMF can be obtained in the manner
discussed in the preceding section.
Example 2.3.
Consider the random variable X of Example 2.1, which has the
PMF
pX(x) =
 1/9
if x is an integer in the range [−4, 4],
0
otherwise.
The mean E[X] is equal to 0. This can be seen from the symmetry of the PMF of
X around 0, and can also be veriﬁed from the deﬁnition:
E[X] =

x
xpX(x) = 1
9
4

x=−4
x = 0.
Let Z = 
X −E[X]2 = X2. As in Example 2.1, we obtain
pZ(z) =
 2/9
if z = 1, 4, 9, 16,
1/9
if z = 0,
0
otherwise.
The variance of X is then obtained by
var(X) = E[Z] =

z
zpZ(z) = 0 · 1
9 + 1 · 2
9 + 4 · 2
9 + 9 · 2
9 + 16 · 2
9 = 60
9 .
It turns out that there is an easier method to calculate var(X), which uses
the PMF of X but does not require the PMF of

X −E[X]
2. This method is
based on the following rule.
Expected Value Rule for Functions of Random Variables
Let X be a random variable with PMF pX(x), and let g(X) be a real-
valued function of X.
Then, the expected value of the random variable
g(X) is given by
E

g(X)

=

x
g(x)pX(x).

Sec. 2.4
Expectation, Mean, and Variance
15
To verify this rule, we use the formula pY (y) = 	
{x | g(x)=y} pX(x) derived
in the preceding section, we have
E

g(X)

= E[Y ]
=

y
ypY (y)
=

y
y

{x | g(x)=y}
pX(x)
=

y

{x | g(x)=y}
ypX(x)
=

y

{x | g(x)=y}
g(x)pX(x)
=

x
g(x)pX(x).
Using the expected value rule, we can write the variance of X as
var(X) = E

X −E[X]
2
=

x

x −E[X]
2pX(x).
Similarly, the nth moment is given by
E[Xn] =

x
xnpX(x),
and there is no need to calculate the PMF of Xn.
Example 2.3. (Continued) For the random variable X with PMF
pX(x) =
 1/9
if x is an integer in the range [−4, 4],
0
otherwise,
we have
var(X) = E

X −E[X]2
=

x

x −E[X]2pX(x)
= 1
9
4

x=−4
x2
since E[X] = 0
= 1
9(16 + 9 + 4 + 1 + 0 + 1 + 4 + 9 + 16)
= 60
9 ,

16
Discrete Random Variables
Chap. 2
which is consistent with the result obtained earlier.
As we have noted earlier, the variance is always nonnegative, but could it
be zero? Since every term in the formula 	
x

x −E[X]
2pX(x) for the variance
is nonnegative, the sum is zero if and only if

x −E[X])2pX(x) = 0 for every x.
This condition implies that for any x with pX(x) > 0, we must have x = E[X]
and the random variable X is not really “random”: its experimental value is
equal to the mean E[X], with probability 1.
Variance
The variance var(X) of a random variable X is deﬁned by
var(X) = E

X −E[X]
2
and can be calculated as
var(X) =

x

x −E[X]
2pX(x).
It is always nonnegative. Its square root is denoted by σX and is called the
standard deviation.
Let us now use the expected value rule for functions in order to derive some
important properties of the mean and the variance. We start with a random
variable X and deﬁne a new random variable Y , of the form
Y = aX + b,
where a and b are given scalars. Let us derive the mean and the variance of the
linear function Y . We have
E[Y ] =

x
(ax + b)pX(x) = a

x
xpX(x) + b

x
pX(x) = aE[X] + b.
Furthermore,
var(Y ) =

x

ax + b −E[aX + b]
2pX(x)
=

x

ax + b −aE[X] −b
2pX(x)
= a2 
x

x −E[X]
2pX(x)
= a2var(X).

Sec. 2.4
Expectation, Mean, and Variance
17
Mean and Variance of a Linear Function of a Random Variable
Let X be a random variable and let
Y = aX + b,
where a and b are given scalars. Then,
E[Y ] = aE[X] + b,
var(Y ) = a2var(X).
Let us also give a convenient formula for the variance of a random variable
X with given PMF.
Variance in Terms of Moments Expression
var(X) = E[X2] −

E[X]
2.
This expression is veriﬁed as follows:
var(X) =

x

x −E[X]
2pX(x)
=

x

x2 −2xE[X] +

E[X]
2
pX(x)
=

x
x2pX(x) −2E[X]

x
xpX(x) +

E[X]
2 
x
pX(x)
= E[X2] −2

E[X]
2 +

E[X]
2
= E[X2] −

E[X]
2.
We will now derive the mean and the variance of a few important random
variables.
Example 2.4. Mean and Variance of the Bernoulli.
Consider the experiment
of tossing a biased coin, which comes up a head with probability p and a tail with
probability 1 −p, and the Bernoulli random variable X with PMF
pX(k) =
 p
if k = 1,
1 −p
if k = 0.

18
Discrete Random Variables
Chap. 2
Its mean, second moment, and variance are given by the following calculations:
E[X] = 1 · p + 0 · (1 −p) = p,
E[X2] = 12 · p + 0 · (1 −p) = p,
var(X) = E[X2] −
E[X]2 = p −p2 = p(1 −p).
Example 2.5. Discrete Uniform Random Variable.
What is the mean and
variance of the roll of a fair six-sided die? If we view the result of the roll as a
random variable X, its PMF is
pX(k) =
 1/6
if k = 1, 2, 3, 4, 5, 6,
0
otherwise.
Since the PMF is symmetric around 3.5, we conclude that E[X] = 3.5. Regarding
the variance, we have
var(X) = E[X2] −
E[X]2
= 1
6(12 + 22 + 32 + 42 + 52 + 62) −(3.5)2,
which yields var(X) = 35/12.
The above random variable is a special case of a discrete uniformly dis-
tributed random variable (or discrete uniform for short), which by deﬁnition,
takes one out of a range of contiguous integer values, with equal probability. More
precisely, this random variable has a PMF of the form
pX(k) =

1
b −a + 1
if k = a, a + 1, . . . , b,
0
otherwise,
where a and b are two integers with a < b; see Fig. 2.9.
The mean is
E[X] = a + b
2
,
as can be seen by inspection, since the PMF is symmetric around (a + b)/2. To
calculate the variance of X, we ﬁrst consider the simpler case where a = 1 and
b = n. It can be veriﬁed by induction on n that
E[X2] = 1
n
n

k=1
k2 = 1
6(n + 1)(2n + 1).
We leave the veriﬁcation of this as an exercise for the reader. The variance can now
be obtained in terms of the ﬁrst and second moments
var(X) = E[X2] −
E[X]2
= 1
6(n + 1)(2n + 1) −1
4(n + 1)2
= 1
12(n + 1)(4n + 2 −3n −3)
= n2 −1
12
.

Sec. 2.4
Expectation, Mean, and Variance
19
a
b
b - a +1
1
px(k)
k
...
Figure 2.9: PMF of the discrete random variable that is uniformly dis-
tributed between two integers a and b. Its mean and variance are
E[X] = a + b
2
,
var(X) = (b −a)(b −a + 2)
12
.
For the case of general integers a and b, we note that the uniformly distributed
random variable over [a, b] has the same variance as the uniformly distributed ran-
dom variable over the interval [1, b −a + 1], since these two random variables diﬀer
by the constant a−1. Therefore, the desired variance is given by the above formula
with n = b −a + 1, which yields
var(X) = (b −a + 1)2 −1
12
= (b −a)(b −a + 2)
12
.
Example 2.6. The Mean of the Poisson.
The mean of the Poisson PMF
pX(k) = e−λ λk
k! ,
k = 0, 1, 2, . . . ,
can be calculated is follows:
E[X] =
∞

k=0
ke−λ λk
k!
=
∞

k=1
ke−λ λk
k!
the k = 0 term is zero
= λ
∞

k=1
e−λ
λk−1
(k −1)!
= λ
∞

m=0
e−λ λm
m!
let m = k −1
= λ.

20
Discrete Random Variables
Chap. 2
The last equality is obtained by noting that 	∞
m=0 e−λ λm
m! = 	∞
m=0 pX(m) = 1 is
the normalization property for the Poisson PMF.
A similar calculation shows that the variance of a Poisson random variable is
also λ (see the solved problems). We will have the occasion to derive this fact in a
number of diﬀerent ways in later chapters.
Expected values often provide a convenient vehicle for choosing optimally
between several candidate decisions that result in diﬀerent expected rewards. If
we view the expected reward of a decision as its “average payoﬀover a large
number of trials,” it is reasonable to choose a decision with maximum expected
reward. The following is an example.
Example 2.7. The Quiz Problem.
This example, when generalized appro-
priately, is a prototypical model for optimal scheduling of a collection of tasks that
have uncertain outcomes.
Consider a quiz game where a person is given two questions and must decide
which question to answer ﬁrst. Question 1 will be answered correctly with proba-
bility 0.8, and the person will then receive as prize $100, while question 2 will be
answered correctly with probability 0.5, and the person will then receive as prize
$200. If the ﬁrst question attempted is answered incorrectly, the quiz terminates,
i.e., the person is not allowed to attempt the second question. If the ﬁrst question
is answered correctly, the person is allowed to attempt the second question. Which
question should be answered ﬁrst to maximize the expected value of the total prize
money received?
The answer is not obvious because there is a tradeoﬀ: attempting ﬁrst the
more valuable but also more diﬃcult question 2 carries the risk of never getting a
chance to attempt the easier question 1. Let us view the total prize money received
as a random variable X, and calculate the expected value E[X] under the two
possible question orders (cf. Fig. 2.10):
0.2
0.5
0.8
0.2
0.5
0.8
0.5
0.5
$ 0
$ 0
$ 1 0 0
$ 3 0 0
$ 2 0 0
$ 3 0 0
Question 1
Answered 1st
Question 2
Answered 1st
Figure 2.10: Sequential description of the sample space of the quiz problem
for the two cases where we answer question 1 or question 2 ﬁrst.

Sec. 2.4
Expectation, Mean, and Variance
21
(a) Answer question 1 ﬁrst: Then the PMF of X is (cf. the left side of Fig. 2.10)
pX(0) = 0.2,
pX(100) = 0.8 · 0.5,
pX(300) = 0.8 · 0.5,
and we have
E[X] = 0.8 · 0.5 · 100 + 0.8 · 0.5 · 300 = $160.
(b) Answer question 2 ﬁrst: Then the PMF of X is (cf. the right side of Fig. 2.10)
pX(0) = 0.5,
pX(200) = 0.5 · 0.2,
pX(300) = 0.5 · 0.8,
and we have
E[X] = 0.5 · 0.2 · 200 + 0.5 · 0.8 · 300 = $140.
Thus, it is preferable to attempt the easier question 1 ﬁrst.
Let us now generalize the analysis. Denote by p1 and p2 the probabilities
of correctly answering questions 1 and 2, respectively, and by v1 and v2 the corre-
sponding prizes. If question 1 is answered ﬁrst, we have
E[X] = p1(1 −p2)v1 + p1p2(v1 + v2) = p1v1 + p1p2v2,
while if question 2 is answered ﬁrst, we have
E[X] = p2(1 −p1)v2 + p2p1(v2 + v1) = p2v2 + p2p1v1.
It is thus optimal to answer question 1 ﬁrst if and only if
p1v1 + p1p2v2 ≥p2v2 + p2p1v1,
or equivalently, if
p1v1
1 −p1 ≥
p2v2
1 −p2 .
Thus, it is optimal to order the questions in decreasing value of the expression
pv/(1 −p), which provides a convenient index of quality for a question with prob-
ability of correct answer p and value v. Interestingly, this rule generalizes to the
case of more than two questions (see the end-of-chapter problems).
We ﬁnally illustrate by example a common pitfall: unless g(X) is a linear
function, it is not generally true that E

g(X)

is equal to g

E[X]

.
Example 2.8. Average Speed Versus Average Time.
If the weather is good
(which happens with probability 0.6), Alice walks the 2 miles to class at a speed of
V = 5 miles per hour, and otherwise drives her motorcycle at a speed of V = 30
miles per hour. What is the mean of the time T to get to class?

22
Discrete Random Variables
Chap. 2
The correct way to solve the problem is to ﬁrst derive the PMF of T,
pT (t) =

0.6
if t = 2/5 hours,
0.4
if t = 2/30 hours,
and then calculate its mean by
E[T] = 0.6 · 2
5 + 0.4 · 2
30 = 4
15 hours.
However, it is wrong to calculate the mean of the speed V ,
E[V ] = 0.6 · 5 + 0.4 · 30 = 15 miles per hour,
and then claim that the mean of the time T is
2
E[V ] = 2
15 hours.
To summarize, in this example we have
T = 2
V ,
and E[T] = E
 2
V

̸=
2
E[V ].
2.5
JOINT PMFS OF MULTIPLE RANDOM VARIABLES
Probabilistic models often involve several random variables of interest. For exam-
ple, in a medical diagnosis context, the results of several tests may be signiﬁcant,
or in a networking context, the workloads of several gateways may be of interest.
All of these random variables are associated with the same experiment, sample
space, and probability law, and their values may relate in interesting ways. This
motivates us to consider probabilities involving simultaneously the numerical val-
ues of several random variables and to investigate their mutual couplings. In this
section, we will extend the concepts of PMF and expectation developed so far to
multiple random variables. Later on, we will also develop notions of conditioning
and independence that closely parallel the ideas discussed in Chapter 1.
Consider two discrete random variables X and Y associated with the same
experiment. The joint PMF of X and Y is deﬁned by
pX,Y (x, y) = P(X = x, Y = y)
for all pairs of numerical values (x, y) that X and Y can take. Here and elsewhere,
we will use the abbreviated notation P(X = x, Y = y) instead of the more precise
notations P({X = x} ∩{Y = y}) or P(X = x and Y = x).

Sec. 2.5
Joint PMFs of Multiple Random Variables
23
The joint PMF determines the probability of any event that can be speciﬁed
in terms of the random variables X and Y . For example if A is the set of all
pairs (x, y) that have a certain property, then
P

(X, Y ) ∈A

=

(x,y)∈A
pX,Y (x, y).
In fact, we can calculate the PMFs of X and Y by using the formulas
pX(x) =

y
pX,Y (x, y),
pY (y) =

x
pX,Y (x, y).
The formula for pX(x) can be veriﬁed using the calculation
pX(x) = P(X = x)
=

y
P(X = x, Y = y)
=

y
pX,Y (x, y),
where the second equality follows by noting that the event {X = x} is the union
of the disjoint events {X = x, Y = y} as y ranges over all the diﬀerent values of
Y . The formula for pY (y) is veriﬁed similarly. We sometimes refer to pX and
pY as the marginal PMFs, to distinguish them from the joint PMF.
The example of Fig. 2.11 illustrates the calculation of the marginal PMFs
from the joint PMF by using the tabular method. Here, the joint PMF of X
and Y is arranged in a two-dimensional table, and the marginal PMF of X
or Y at a given value is obtained by adding the table entries along a
corresponding column or row, respectively.
Functions of Multiple Random Variables
When there are multiple random variables of interest, it is possible to generate
new random variables by considering functions involving several of these random
variables. In particular, a function Z = g(X, Y ) of the random variables X and
Y deﬁnes another random variable. Its PMF can be calculated from the joint
PMF pX,Y according to
pZ(z) =

{(x,y) | g(x,y)=z}
pX,Y (x, y).
Furthermore, the expected value rule for functions naturally extends and takes
the form
E

g(X, Y )

=

x,y
g(x, y)pX,Y (x, y).
The veriﬁcation of this is very similar to the earlier case of a function of a single
random variable. In the special case where g is linear and of the form aX+bY +c,
where a, b, and c are given scalars, we have
E[aX + bY + c] = aE[X] + bE[Y ] + c.

24
Discrete Random Variables
Chap. 2
1
2
3
4
4
3
2
1
x 
y 
1/20
2/20
3/20
1/20
1/20
1/20
3/20
1/20
1/20
2/20
1/20
0
0
7/20
7/20
3/20
6/20 8/20
3/20
3/20
Column Sums:
Marginal PMF PX(x)
Joint PMF PX,Y(x,y)
in tabular form
3/20
Row Sums:
Marginal PMF PY(y)
1/20
1/20
1/20
Figure 2.11: Illustration of the tabular method for calculating marginal PMFs
from joint PMFs. The joint PMF is represented by a table, where the number in
each square (x, y) gives the value of pX,Y (x, y). To calculate the marginal PMF
pX(x) for a given value of x, we add the numbers in the column corresponding to
x. For example pX(2) = 8/20. Similarly, to calculate the marginal PMF pY (y)
for a given value of y, we add the numbers in the row corresponding to y. For
example pY (2) = 5/20.
More than Two Random Variables
The joint PMF of three random variables X, Y , and Z is deﬁned in analogy with
the above as
pX,Y,Z(x, y, z) = P(X = x, Y = y, Z = z),
for all possible triplets of numerical values (x, y, z).
Corresponding marginal
PMFs are analogously obtained by equations such as
pX,Y (x, y) =

z
pX,Y,Z(x, y, z),
and
pX(x) =

y

z
pX,Y,Z(x, y, z).
The expected value rule for functions takes the form
E

g(X, Y, Z)

=

x,y,z
g(x, y, z)pX,Y,Z(x, y, z),
and if g is linear and of the form aX + bY + cZ + d, then
E[aX + bY + cZ + d] = aE[X] + bE[Y ] + cE[Z] + d.

Sec. 2.5
Joint PMFs of Multiple Random Variables
25
Furthermore, there are obvious generalizations of the above to more than three
random variables. For example, for any random variables X1, X2, . . . , Xn and
any scalars a1, a2, . . . , an, we have
E[a1X1 + a2X2 + · · · + anXn] = a1E[X1] + a2E[X2] + · · · + anE[Xn].
Example 2.9. Mean of the Binomial.
Your probability class has 300 students
and each student has probability 1/3 of getting an A, independently of any other
student. What is the mean of X, the number of students that get an A? Let
Xi =
 1
if the ith student gets an A,
0
otherwise.
Thus X1, X2, . . . , Xn are Bernoulli random variables with common mean p = 1/3
and variance p(1 −p) = (1/3)(2/3) = 2/9. Their sum
X = X1 + X2 + · · · + Xn
is the number of students that get an A. Since X is the number of “successes” in
n independent trials, it is a binomial random variable with parameters n and p.
Using the linearity of X as a function of the Xi, we have
E[X] =
300

i=1
E[Xi] =
300

i=1
1
3 = 300 · 1
3 = 100.
If we repeat this calculation for a general number of students n and probability of
A equal to p, we obtain
E[X] =
n

i=1
E[Xi] =
n

i=1
p = np,
Example 2.10. The Hat Problem.
Suppose that n people throw their hats in
a box and then each picks up one hat at random. What is the expected value of
X, the number of people that get back their own hat?
For the ith person, we introduce a random variable Xi that takes the value
1 if the person selects his/her own hat, and takes the value 0 otherwise.
Since
P(Xi = 1) = 1/n and P(Xi = 0) = 1 −1/n, the mean of Xi is
E[Xi] = 1 · 1
n + 0 ·

1 −1
n

= 1
n.
We now have
X = X1 + X2 + · · · + Xn,

26
Discrete Random Variables
Chap. 2
so that
E[X] = E[X1] + E[X2] + · · · + E[Xn] = n · 1
n = 1.
Summary of Facts About Joint PMFs
Let X and Y be random variables associated with the same experiment.
• The joint PMF of X and Y is deﬁned by
pX,Y (x, y) = P(X = x, Y = y).
• The marginal PMFs of X and Y can be obtained from the joint PMF,
using the formulas
pX(x) =

y
pX,Y (x, y),
pY (y) =

x
pX,Y (x, y).
• A function g(X, Y ) of X and Y deﬁnes another random variable, and
E

g(X, Y )

=

x,y
g(x, y)pX,Y (x, y).
If g is linear, of the form aX + bY + c, we have
E[aX + bY + c] = aE[X] + bE[Y ] + c.
• The above have natural extensions to the case where more than two
random variables are involved.
2.6
CONDITIONING
If we have a probabilistic model and we are also told that a certain event A has
occurred, we can capture this knowledge by employing the conditional instead of
the original (unconditional) probabilities. As discussed in Chapter 1, conditional
probabilities are like ordinary probabilities (satisfy the three axioms) except that
they refer to a new universe in which event A is known to have occurred. In the
same spirit, we can talk about conditional PMFs which provide the probabilities
of the possible values of a random variable, conditioned on the occurrence of
some event. This idea is developed in this section. In reality though, there is

Sec. 2.6
Conditioning
27
not much that is new, only an elaboration of concepts that are familiar from
Chapter 1, together with a fair dose of new notation.
Conditioning a Random Variable on an Event
The conditional PMF of a random variable X, conditioned on a particular
event A with P(A) > 0, is deﬁned by
pX|A(x) = P(X = x | A) = P

{X = x} ∩A

P(A)
.
Note that the events {X = x} ∩A are disjoint for diﬀerent values of x, their
union is A, and, therefore,
P(A) =

x
P

{X = x} ∩A

.
Combining the above two formulas, we see that

x
pX|A(x) = 1,
so pX|A is a legitimate PMF.
As an example, let X be the roll of a die and let A be the event that the
roll is an even number. Then, by applying the preceding formula, we obtain
pX|A(x) = P(X = x | roll is even)
= P(X = x and X is even)
P(roll is even)
=
 1/3
if x = 2, 4, 6,
0
otherwise.
The conditional PMF is calculated similar to its unconditional counterpart:
to obtain pX|A(x), we add the probabilities of the outcomes that give rise to
X = x and belong to the conditioning event A, and then normalize by dividing
with P(A) (see Fig. 2.12).
Sample Space
Ω
pX|A(x|A) 
x
Event {X=x}
Event A
Event {X=x'}
x'
Figure 2.12: Visualization and calculation of the conditional PMF pX|A(x). For
each x, we add the probabilities of the outcomes in the intersection {X = x} ∩A
and normalize by diving with P(A).

28
Discrete Random Variables
Chap. 2
Conditioning one Random Variable on Another
Let X and Y be two random variables associated with the same experiment. If
we know that the experimental value of Y is some particular y (with pY (y) > 0),
this provides partial knowledge about the value of X. This knowledge is captured
by the conditional PMF pX|Y of X given Y , which is deﬁned by specializing
the deﬁnition of pX|A to events A of the form {Y = y}:
pX|Y (x | y) = P(X = x | Y = y).
Using the deﬁnition of conditional probabilities, we have
pX|Y (x | y) = P(X = x, Y = y)
P(Y = y)
= pX,Y (x, y)
pY (y)
.
Let us ﬁx some y, with pY (y) > 0 and consider pX|Y (x | y) as a function
of x. This function is a valid PMF for X: it assigns nonnegative values to each
possible x, and these values add to 1. Furthermore, this function of x, has the
same shape as pX,Y (x, y) except that it is normalized by dividing with pY (y),
which enforces the normalization property

x
pX|Y (x | y) = 1.
Figure 2.13 provides a visualization of the conditional PMF.
x 
y 
y  = 1
y = 2
y  = 3
PMF pX,Y(x,y)
Conditional PMF
pX|Y(x| 3)
"SLICE VIEW" 
of Conditional PMF
pX|Y(x|y)
Conditional PMF
pX|Y(x| 2)
Conditional PMF
pX|Y(x| 1 )
x 
x 
x 
Figure 2.13: Visualization of the conditional PMF pX|Y (x | y). For each y, we
view the joint PMF along the slice Y = y and renormalize so that

x
pX|Y (x | y) = 1.

Sec. 2.6
Conditioning
29
The conditional PMF is often convenient for the calculation of the joint
PMF, using a sequential approach and the formula
pX,Y (x, y) = pY (y)pX|Y (x | y),
or its counterpart
pX,Y (x, y) = pX(x)pY |X(y | x).
This method is entirely similar to the use of the multiplication rule from Chap-
ter 1. The following examples provide an illustration.
Example 2.11.
Professor May B. Right often has her facts wrong, and answers
each of her students’ questions incorrectly with probability 1/4, independently of
other questions. In each lecture May is asked 0, 1, or 2 questions with equal proba-
bility 1/3. Let X and Y be the number of questions May is asked and the number of
questions she answers wrong in a given lecture, respectively. To construct the joint
PMF pX,Y (x, y), we need to calculate all the probabilities P(X = x, Y = y) for all
combinations of values of x and y. This can be done by using a sequential descrip-
tion of the experiment and the multiplication rule pX,Y (x, y) = pY (y)pX|Y (x | y),
as shown in Fig. 2.14. For example, for the case where one question is asked and is
answered wrong, we have
pX,Y (1, 1) = pX(x)pY |X(y | x) = 1
4 · 1
3 = 1
12.
The joint PMF can be represented by a two-dimensional table, as shown in Fig.
2.14.
It can be used to calculate the probability of any event of interest.
For
instance, we have
P(at least one wrong answer) = pX,Y (1, 1) + pX,Y (2, 1) + pX,Y (2, 2)
= 4
48 + 6
48 + 1
48.
.
Example 2.12.
Consider four independent rolls of a 6-sided die. Let X be the
number of 1’s and let Y be the number of 2’s obtained. What is the joint PMF of
X and Y ?
The marginal PMF pY is given by the binomial formula
pY (y) =

4
y
 
1
6
y 
5
6
4−y
,
y = 0, 1, . . . , 4.
To compute the conditional PMF pX|Y , note that given that Y = y, X is the
number of 1’s in the remaining 4 −y rolls, each of which can take the 5 values

30
Discrete Random Variables
Chap. 2
1
2
0
2
1
x 
y 
9/48
6/48
16/48
1/48
12/48
4/48
0
0
0
0
0
0
2
1
2
1
1
0
X  : Number of
questions asked
Y  : Number of
questions answered
wrong
1/3
1/3
1/3
9/16
3/4
1/4
1/16
6/16
Prob: 1/48
Prob: 6/48
Prob: 9/48
Prob: 4/48
Prob: 12/48
Prob: 16/48
Joint PMF PX,Y(x,y)
in tabular form
Figure 2.14: Calculation of the joint PMF pX,Y (x, y) in Example 2.11.
1, 3, 4, 5, 6 with equal probability 1/5. Thus, the conditional PMF pX|Y is binomial
with parameters 4 −y and p = 1/5:
pX|Y (x | y) =

4 −y
x
 
1
5
x 
4
5
4−y−x
,
for all x and y such that x, y = 0, 1, . . . , 4, and 0 ≤x + y ≤4. The joint PMF is
now given by
pX,Y (x, y) = pY (y)pX|Y (x | y)
=

4
y
 
1
6
y 
5
6
4−y 
4 −y
x
 
1
5
x 
4
5
4−y−x
,
for all nonnegative integers x and y such that 0 ≤x + y ≤4. For other values of x
and y, we have pX,Y (x, y) = 0.
The conditional PMF can also be used to calculate the marginal PMFs. In
particular, we have by using the deﬁnitions,
pX(x) =

y
pX,Y (x, y) =

y
pY (y)pX|Y (x | y).
This formula provides a divide-and-conquer method for calculating marginal
PMFs. It is in essence identical to the total probability theorem given in Chap-
ter 1, but cast in diﬀerent notation. The following example provides an illustra-
tion.

Sec. 2.6
Conditioning
31
Example 2.13.
Consider a transmitter that is sending messages over a computer
network. Let us deﬁne the following two random variables:
X : the travel time of a given message,
Y : the length of the given message.
We know the PMF of the travel time of a message that has a given length, and we
know the PMF of the message length. We want to ﬁnd the (unconditional) PMF
of the travel time of a message.
We assume that the length of a message can take two possible values: y = 102
bytes with probability 5/6, and y = 104 bytes with probability 1/6, so that
pY (y) =

5/6
if y = 102,
1/6
if y = 104.
We assume that the travel time X of the message depends on its length Y and
the congestion level of the network at the time of transmission. In particular, the
travel time is 10−4Y secs with probability 1/2, 10−3Y secs with probability 1/3,
and 10−2Y secs with probability 1/6. Thus, we have
pX|Y (x | 102) =
 1/2
if x = 10−2,
1/3
if x = 10−1,
1/6
if x = 1,
pX|Y (x | 104) =
 1/2
if x = 1,
1/3
if x = 10,
1/6
if x = 100.
To ﬁnd the PMF of X, we use the total probability formula
pX(x) =

y
pY (y)pX|Y (x | y).
We obtain
pX(10−2) = 5
6 · 1
2,
pX(10−1) = 5
6 · 1
3,
pX(1) = 5
6 · 1
6 + 1
6 · 1
2,
pX(10) = 1
6 · 1
3,
pX(100) = 1
6 · 1
6.
Note ﬁnally that one can deﬁne conditional PMFs involving more than
two random variables, as in pX,Y |Z(x, y | z) or pX|Y,Z(x | y, z). The concepts and
methods described above generalize easily (see the end-of-chapter problems).

32
Discrete Random Variables
Chap. 2
Summary of Facts About Conditional PMFs
Let X and Y be random variables associated with the same experiment.
• Conditional PMFs are similar to ordinary PMFs, but refer to a uni-
verse where the conditioning event is known to have occurred.
• The conditional PMF of X given an event A with P(A) > 0, is deﬁned
by
pX|A(x) = P(X = x | A)
and satisﬁes

x
pX|A(x) = 1.
• The conditional PMF of X given Y = y is related to the joint PMF
by
pX,Y (x, y) = pY (y)pX|Y (x | y).
This is analogous to the multiplication rule for calculating probabilities
and can be used to calculate the joint PMF from the conditional PMF.
• The conditional PMF of X given Y can be used to calculate the
marginal PMFs with the formula
pX(x) =

y
pY (y)pX|Y (x | y).
This is analogous to the divide-and-conquer approach for calculating
probabilities using the total probability theorem.
• There are natural extensions to the above involving more than two
random variables.
Conditional Expectation
A conditional PMF can be thought of as an ordinary PMF over a new uni-
verse determined by the conditioning event. In the same spirit, a conditional
expectation is the same as an ordinary expectation, except that it refers to the
new universe, and all probabilities and PMFs are replaced by their conditional
counterparts. We list the main deﬁnitions and relevant facts below.

Sec. 2.6
Conditioning
33
Summary of Facts About Conditional Expectations
Let X and Y be random variables associated with the same experiment.
• The conditional expectation of X given an event A with P(A) > 0, is
deﬁned by
E[X | A] =

x
xpX|A(x | A).
For a function g(X), it is given by
E

g(X) | A

=

x
g(x)pX|A(x | A).
• The conditional expectation of X given a value y of Y is deﬁned by
E[X | Y = y] =

x
xpX|Y (x | y).
• We have
E[X] =

y
pY (y)E[X | Y = y].
This is the total expectation theorem.
• Let A1, . . . , An be disjoint events that form a partition of the sample
space, and assume that P(Ai) > 0 for all i. Then,
E[X] =
n

i=1
P(Ai)E[X | Ai].
Let us verify the total expectation theorem, which basically says that “the
unconditional average can be obtained by averaging the conditional averages.”
The theorem is derived using the total probability formula
pX(x) =

y
pY (y)pX|Y (x | y)

34
Discrete Random Variables
Chap. 2
and the calculation
E[X] =

x
xpX(x)
=

x
x

y
pY (y)pX|Y (x | y)
=

y
pY (y)

x
xpX|Y (x | y)
=

y
pY (y)E[X | Y = y].
The relation E[X] = 	n
i=1 P(Ai)E[X | Ai] can be veriﬁed by viewing it as
a special case of the total expectation theorem. Let us introduce the random
variable Y that takes the value i if and only if the event Ai occurs. Its PMF is
given by
pY (i) =
 P(Ai)
if i = 1, 2, . . . , n,
0
otherwise.
The total expectation theorem yields
E[X] =
n

i=1
P(Ai)E[X | Y = i],
and since the event {Y = i} is just Ai, we obtain the desired expression
E[X] =
n

i=1
P(Ai)E[X | Ai].
The total expectation theorem is analogous to the total probability theo-
rem. It can be used to calculate the unconditional expectation E[X] from the
conditional PMF or expectation, using a divide-and-conquer approach.
Example 2.14.
Messages transmitted by a computer in Boston through a data
network are destined for New York with probability 0.5, for Chicago with probability
0.3, and for San Francisco with probability 0.2. The transit time X of a message is
random. Its mean is 0.05 secs if it is destined for New York, 0.1 secs if it is destined
for Chicago, and 0.3 secs if it is destined for San Francisco. Then, E[X] is easily
calculated using the total expectation theorem as
E[X] = 0.5 · 0.05 + 0.3 · 0.1 + 0.2 · 0.3 = 0.115 secs.
Example 2.15. Mean and Variance of the Geometric Random Variable.
You write a software program over and over, and each time there is probability p

Sec. 2.7
Independence
35
that it works correctly, independently from previous attempts. What is the mean
and variance of X, the number of tries until the program works correctly?
We recognize X as a geometric random variable with PMF
pX(k) = (1 −p)k−1p,
k = 1, 2, . . . .
The mean and variance of X are given by
E[X] =
∞

k=1
k(1 −p)k−1p,
var(X) =
∞

k=1
(k −E[X])2(1 −p)k−1p,
but evaluating these inﬁnite sums is somewhat tedious. As an alternative, we will
apply the total expectation theorem, with A1 = {X = 1} = {ﬁrst try is a success},
A2 = {X > 1} = {ﬁrst try is a failure}, and end up with a much simpler calcula-
tion.
If the ﬁrst try is successful, we have X = 1, and
E[X | X = 1] = 1.
If the ﬁrst try fails (X > 1), we have wasted one try, and we are back where we
started. So, the expected number of remaining tries is E[X], and
E[X | X > 1] = 1 + E[X].
Thus,
E[X] = P(X = 1)E[X | X = 1] + P(X > 1)E[X | X > 1]
= p + (1 −p)
1 + E[X]
,
from which we obtain
E[X] = 1
p.
With similar reasoning, we also have
E[X2 | X = 1] = 1,
E[X2 | X > 1] = E
(1 + X)2
= 1 + 2E[X] + E[X2],
so that
E[X2] = p · 1 + (1 −p)
1 + 2E[X] + E[X2]
,
from which we obtain
E[X2] = 1 + 2(1 −p)E[X]
p
,
and
E[X2] = 2
p2 −1
p.
We conclude that
var(X) = E[X2] −
E[X]2 = 2
p2 −1
p −1
p2 = 1 −p
p2
.

36
Discrete Random Variables
Chap. 2
2.7
INDEPENDENCE
We now discuss concepts of independence related to random variables. These
concepts are analogous to the concepts of independence between events (cf. Chap-
ter 1). They are developed by simply introducing suitable events involving the
possible values of various random variables, and by considering their indepen-
dence.
Independence of a Random Variable from an Event
The independence of a random variable from an event is similar to the indepen-
dence of two events. The idea is that knowing the occurrence of the conditioning
event tells us nothing about the value of the random variable. More formally,
we say that the random variable X is independent of the event A if
P(X = x and A) = P(X = x)P(A) = pX(x)P(A),
for all x,
which is the same as requiring that the two events {X = x} and A be in-
dependent, for any choice x. As long as P(A) > 0, and using the deﬁnition
pX|A(x) = P(X = x and A)/P(A) of the conditional PMF, we see that indepen-
dence is the same as the condition
pX|A(x) = pX(x),
for all x.
Example 2.16.
Consider two independent tosses of a fair coin. Let X be the
number of heads and let A be the event that the number of heads is even. The
(unconditional) PMF of X is
pX(x) =



1/4
if x = 0,
1/2
if x = 1,
1/4
if x = 2,
and P(A) = 1/2. The conditional PMF is obtained from the deﬁnition pX|A(x) =
P
X = x and A
/P(A):
pX|A(x) =



1/2
if x = 0,
0
if x = 1,
1/2
if x = 2.
Clearly, X and A are not independent, since the PMFs pX and pX|A are diﬀerent.
For an example of a random variable that is independent of A, consider the random
variable that takes the value 0 if the ﬁrst toss is a head, and the value 1 if the ﬁrst
toss is a tail. This is intuitively clear and can also be veriﬁed by using the deﬁnition
of independence.

Sec. 2.7
Independence
37
Independence of Random Variables
The notion of independence of two random variables is similar. We say that two
random variables X and Y are independent if
pX,Y (x, y) = pX(x) pY (y),
for all x, y.
This is the same as requiring that the two events {X = x} and {Y = y} be in-
dependent for every x and y. Finally, the formula pX,Y (x, y) = pX|Y (x | y)pY (y)
shows that independence is equivalent to the condition
pX|Y (x | y) = pX(x),
for all y with pY (y) > 0 and all x.
Intuitively, independence means that the experimental value of Y tells us nothing
about the value of X.
There is a similar notion of conditional independence of two random vari-
ables, given an event A with P(A > 0. The conditioning event A deﬁnes a new
universe and all probabilities (or PMFs) have to be replaced by their conditional
counterparts. For example, X and Y are said to be conditionally indepen-
dent, given a positive probability event A, if
P(X = x, Y = y | A) = P(X = x | A)P(Y = y | A),
for all x and y,
or, in this chapter’s notation,
pX,Y |A(x, y) = pX|A(x)pY |A(y),
for all x and y.
Once more, this is equivalent to
pX|Y,A(x | y) = pX|A(x)
for all x and y such that pY |A(y) > 0.
As in the case of events (Section 1.4), conditional independence may not imply
unconditional independence and vice versa. This is illustrated by the example
in Fig. 2.15.
If X and Y are independent random variables, then
E[XY ] = E[X] E[Y ],
as shown by the following calculation:
E[XY ] =

x

y
xypX,Y (x, y)
=

x

y
xypX(x)pY (y)
by independence
=

x
xpX(x)

y
ypY (y)
= E[X] E[Y ].

38
Discrete Random Variables
Chap. 2
1
2
3
4
4
3
2
1
x 
y 
1/20
4/20
3/20
2/20
2/20
2/20
1/20
1/20
1/20
1/20
2/20
0
0
0
0
0
Figure 2.15: Example illustrating that conditional independence may not imply
unconditional independence. For the PMF shown, the random variables X and
Y are not independent. For example, we have
pX|Y (1 | 1) = P(X = 1 | Y = 1) = 0 ̸= P(X = 1) = pX(1).
On the other hand, conditional on the event A = {X ≤2, Y ≥3} (the shaded
set in the ﬁgure), the random variables X and Y can be seen to be independent.
In particular, we have
pX|Y,A(x | y) =
 1/3
if x = 1,
2/3
if x = 2,
for both values y = 3 and y = 4.
A very similar calculation also shows that if X and Y are independent, then
E

g(X)h(Y )

= E

g(X)

E

h(Y )

,
for any functions g and h. In fact, this follows immediately once we realize that
if X and Y are independent, then the same is true for g(X) and h(Y ). This is
intuitively clear and its formal veriﬁcation is left as an end-of-chapter problem.
Consider now the sum Z = X + Y of two independent random variables
X and Y , and let us calculate the variance of Z. We have, using the relation
E[X + Y ] = E[X] + E[Y ],
var(Z) = E

X + Y −E[X + Y ]
2
= E

X + Y −E[X] −E[Y ]
2
= E

X −E[X]

+

Y −E[Y ]
2
= E

X −E[X]
2
+ E

Y −E[Y ]
2
+ 2E

X −E[X]

Y −E[Y ]

= E

X −E[X]
2
+ E

Y −E[Y ]
2
.

Sec. 2.7
Independence
39
To justify the last equality, note that the random variables X−E[X] and Y −E[Y ]
are independent (they are functions of the independent random variables X and
Y , respectively) and
E

X −E[X]

Y −E[Y ]

= E

X −E[X]

E

Y −E[Y ]

= 0.
We conclude that
var(Z) = var(X) + var(Y ).
Thus, the variance of the sum of two independent random variables is equal to
the sum of their variances. As an interesting contrast, note that the mean of the
sum of two random variables is always equal to the sum of their means, even if
they are not independent.
Summary of Facts About Independent Random Variables
Let A be an event, with P(A) > 0, and let X and Y be random variables
associated with the same experiment.
• X is independent of the event A if
pX|A(x) = pX(x),
for all x,
that is, if for all x, the events {X = x} and A are independent.
• X and Y are independent if for all possible pairs (x, y), the events
{X = x} and {Y = y} are independent, or equivalently
pX,Y (x, y) = pX(x)pY (y),
for all x, y.
• If X and Y are independent random variables, then
E[XY ] = E[X]E[Y ].
Furthermore, for any functions f and g, the random variables g(X)
and h(Y ) are independent, and we have
E

g(X)h(Y )

= E

g(X)

E

h(Y )

.
• If X and Y are independent, then
var[X + Y ] = var(X) + var(Y ).

40
Discrete Random Variables
Chap. 2
Independence of Several Random Variables
All of the above have natural extensions to the case of more than two random
variables.
For example, three random variables X, Y , and Z are said to be
independent if
pX,Y,Z(x, y, z) = pX(x)pY (y)pZ(z),
for all x, y, z.
If X, Y , and Z are independent random variables, then any three random
variables of the form f(X), g(Y ), and h(Z), are also independent. Similarly, any
two random variables of the form g(X, Y ) and h(Z) are independent. On the
other hand, two random variables of the form g(X, Y ) and h(Y, Z) are usually
not independent, because they are both aﬀected by Y . Properties such as the
above are intuitively clear if we interpret independence in terms of noninter-
acting (sub)experiments. They can be formally veriﬁed (see the end-of-chapter
problems), but this is sometimes tedious. Fortunately, there is general agree-
ment between intuition and what is mathematically correct. This is basically a
testament that the deﬁnitions of independence we have been using adequately
reﬂect the intended interpretation.
Another property that extends to multiple random variables is the follow-
ing. If X1, X2, . . . , Xn are independent random variables, then
var(X1 + X2 + · · · + Xn) = var(X1) + var(X2) + · · · + var(Xn).
This can be veriﬁed by a calculation similar to the one for the case of two random
variables and is left as an exercise for the reader.
Example 2.17. Variance of the Binomial.
We consider n independent coin
tosses, with each toss having probability p of coming up a head. For each i, we let
Xi be the Bernoulli random variable which is equal to 1 if the ith toss comes up
a head, and is 0 otherwise. Then, X = X1 + X2 + · · · + Xn is a binomial random
variable. By the independence of the coin tosses, the random variables X1, . . . , Xn
are independent, and
var(X) =
n

i=1
var(Xi) = np(1 −p).
The formulas for the mean and variance of a weighted sum of random
variables form the basis for many statistical procedures that estimate the mean
of a random variable by averaging many independent samples. A typical case is
illustrated in the following example.
Example 2.18.
Mean and Variance of the Sample Mean.
We wish to
estimate the approval rating of a president, to be called C. To this end, we ask n

Sec. 2.7
Independence
41
persons drawn at random from the voter population, and we let Xi be a random
variable that encodes the response of the ith person:
Xi =
 1
if the ith person approves C’s performance,
0
if the ith person disapproves C’s performance.
We model X1, X2, . . . , Xn as independent Bernoulli random variables with common
mean p and variance p(1 −p). Naturally, we view p as the true approval rating of
C. We “average” the responses and compute the sample mean Sn, deﬁned as
Sn = X1 + X2 + · · · + Xn
n
.
Thus, Sn is the approval rating of C within our n-person sample.
We have, using the linearity of Sn as a function of the Xi,
E[Sn] =
n

i=1
1
nE[Xi] = 1
n
n

i=1
p = p,
and making use of the independence of X1, . . . , Xn,
var(Sn) =
n

i=1
1
n2 var(Xi) = p(1 −p)
n
.
The sample mean Sn can be viewed as a “good” estimate of the approval rating.
This is because it has the correct expected value, which is the approval rating p, and
its accuracy, as reﬂected by its variance, improves as the sample size n increases.
Note that even if the random variables Xi are not Bernoulli, the same calcu-
lation yields
var(Sn) = var(X)
n
,
as long as the Xi are independent, with common mean E[X] and variance var(X).
Thus, again, the sample mean becomes a very good estimate (in terms of variance)
of the true mean E[X], as the sample size n increases. We will revisit the properties
of the sample mean and discuss them in much greater detail in Chapter 7, when we
discuss the laws of large numbers.
Example 2.19. Estimating Probabilities by Simulation.
In many practical
situations, the analytical calculation of the probability of some event of interest is
very diﬃcult. However, if we have a physical or computer model that can generate
outcomes of a given experiment in accordance with their true probabilities, we can
use simulation to calculate with high accuracy the probability of any given event A.
In particular, we independently generate with our model n outcomes, we record the
number m that belong to the event A of interest, and we approximate P(A) by m/n.
For example, to calculate the probability p = P(Heads) of a biased coin, we ﬂip the
coin n times, and we approximate p with the ratio (number of heads recorded)/n.

42
Discrete Random Variables
Chap. 2
To see how accurate this process is, consider n independent Bernoulli random
variables X1, . . . , Xn, each with PMF
pXi(xi) =
 P(A)
if xi = 1,
0
if xi = 0.
In a simulation context, Xi corresponds to the ith outcome, and takes the value 1
if the ith outcome belongs to the event A. The value of the random variable
X = X1 + X2 + · · · + Xn
n
is the estimate of P(A) provided by the simulation. According to Example 2.17, X
has mean P(A) and variance P(A)
1 −P(A)
/n, so that for large n, it provides an
accurate estimate of P(A).
2.8
SUMMARY AND DISCUSSION
Random variables provide the natural tools for dealing with probabilistic mod-
els in which the outcome determines certain numerical values of interest.
In
this chapter, we focused on discrete random variables, and developed the main
concepts and some relevant tools. We also discussed several special random vari-
ables, and derived their PMF, mean, and variance, as summarized in the table
that follows.
Summary of Results for Special Random Variables
Discrete Uniform over [a, b]:
pX(k) =

1
b −a + 1
if k = a, a + 1, . . . , b,
0
otherwise,
E[X] = a + b
2
,
var(X) = (b −a)(b −a + 2)
12
.
Bernoulli with Parameter p: (Describes the success or failure in a single
trial.)
pX(k) =

p
if k = 1,
1 −p
if k = 0,
E[X] = p,
var(X) = p(1 −p).

Sec. 2.8
Summary and Discussion
43
Binomial with Parameters p and n: (Describes the number of successes
in n independent Bernoulli trials.)
pX(k) =
n
k

pk(1 −p)n−k,
k = 0, 1, . . . , n,
E[X] = np,
var(X) = np(1 −p).
Geometric with Parameter p: (Describes the number of trials until the
ﬁrst success, in a sequence of independent Bernoulli trials.)
pX(k) = (1 −p)k−1p,
k = 1, 2, . . . ,
E[X] = 1
p,
var(X) = 1 −p
p2
.
Poisson with Parameter λ: (Approximates the binomial PMF when n
is large, p is small, and λ = np.)
pX(k) = e−λ λk
k! ,
k = 0, 1, . . . ,
E[X] = λ,
var(X) = λ.
We also considered multiple random variables, and introduced their joint
and conditional PMFs, and associated expected values. Conditional PMFs are
often the starting point in probabilistic models and can be used to calculate
other quantities of interest, such as marginal or joint PMFs and expectations,
through a sequential or a divide-and-conquer approach. In particular, given the
conditional PMF pX|Y (x | y):
(a) The joint PMF can be calculated by
pX,Y (x, y) = pY (y)pX|Y (x | y).
This can be extended to the case of three or more random variables, as in
pX,Y,Z(x, y, z) = pY (y)pY |Z(y | z)pX|Y,Z(x | y, z),
and is analogous to the sequential tree-based calculation method using the
multiplication rule, discussed in Chapter 1.
(b) The marginal PMF can be calculated by
pX(x) =

y
pY (y)pX|Y (x | y),

44
Discrete Random Variables
Chap. 2
which generalizes the divide-and-conquer calculation method we discussed
in Chapter 1.
(c) The divide-and-conquer calculation method in (b) above can be extended
to compute expected values using the total expectation theorem:
E[X] =

y
pY (y)E[X | Y = y].
The concepts and methods of this chapter extend appropriately to general
random variables (see the next chapter), and are fundamental for our subject.

3
General Random Variables
Contents
3.1. Continuous Random Variables and PDFs
. . . . . . . . . . p. 2
3.2. Cumulative Distribution Functions
. . . . . . . . . . . .
p. 11
3.3. Normal Random Variables . . . . . . . . . . . . . . . .
p. 17
3.4. Conditioning on an Event
. . . . . . . . . . . . . . . .
p. 21
3.5. Multiple Continuous Random Variables
. . . . . . . . . .
p. 27
3.6. Derived Distributions
. . . . . . . . . . . . . . . . . .
p. 39
3.7. Summary and Discussion
. . . . . . . . . . . . . . . .
p. 51
1

2
General Random Variables
Chap. 3
Random variables with a continuous range of possible experimental values are
quite common – the velocity of a vehicle traveling along the highway could be one
example. If such a velocity is measured by a digital speedometer, the speedome-
ter’s reading is a discrete random variable. But if we also wish to model the exact
velocity, a continuous random variable is called for. Models involving continuous
random variables can be useful for several reasons. Besides being ﬁner-grained
and possibly more accurate, they allow the use of powerful tools from calculus
and often admit an insightful analysis that would not be possible under a discrete
model.
All of the concepts and methods introduced in Chapter 2, such as expec-
tation, PMFs, and conditioning, have continuous counterparts. Developing and
interpreting these counterparts is the subject of this chapter.
3.1
CONTINUOUS RANDOM VARIABLES AND PDFS
A random variable X is called continuous if its probability law can be described
in terms of a nonnegative function fX, called the probability density function
of X, or PDF for short, which satisﬁes
P(X ∈B) =

B
fX(x) dx,
for every subset B of the real line.† In particular, the probability that the value
of X falls within an interval is
P(a ≤X ≤b) =
 b
a
fX(x) dx,
and can be interpreted as the area under the graph of the PDF (see Fig. 3.1).
For any single value a, we have P(X = a) =
 a
a fX(x) dx = 0. For this reason,
including or excluding the endpoints of an interval has no eﬀect on its probability:
P(a ≤X ≤b) = P(a < X < b) = P(a ≤X < b) = P(a < X ≤b).
Note that to qualify as a PDF, a function fX must be nonnegative, i.e.,
fX(x) ≥0 for every x, and must also satisfy the normalization equation
 ∞
−∞
fX(x) dx = P(−∞< X < ∞) = 1.
† The integral 
B fX(x) dx is to be interpreted in the usual calculus/Riemann
sense and we implicitly assume that it is well-deﬁned. For highly unusual functions
and sets, this integral can be harder – or even impossible – to deﬁne, but such issues
belong to a more advanced treatment of the subject.
In any case, it is comforting
to know that mathematical subtleties of this type do not arise if fX is a piecewise
continuous function with a ﬁnite number of points of discontinuity, and B is the union
of a ﬁnite or countable number of intervals.

Sec. 3.1
Continuous Random Variables and PDFs
3
Sample Space
x 
PDF fX(x)
Event {a < X < b}
a 
b
Figure 3.1: Illustration of a PDF. The probability that X takes value in an
interval [a, b] is  b
a fX(x) dx, which is the shaded area in the ﬁgure.
Graphically, this means that the entire area under the graph of the PDF must
be equal to 1.
To interpret the PDF, note that for an interval [x, x + δ] with very small
length δ, we have
P

[x, x + δ]

=
 x+δ
x
fX(t) dt ≈fX(x) · δ,
so we can view fX(x) as the “probability mass per unit length” near x (cf.
Fig. 3.2). It is important to realize that even though a PDF is used to calculate
event probabilities, fX(x) is not the probability of any particular event.
In
particular, it is not restricted to be less than or equal to one.
x 
PDF fX(x )
δ
x  + δ 
Figure 3.2: Interpretation of the PDF
fX(x) as “probability mass per unit length”
around x. If δ is very small, the prob-
ability that X takes value in the inter-
val [x, x + δ] is the shaded area in the
ﬁgure, which is approximately equal to
fX(x) · δ.
Example 3.1.
Continuous Uniform Random Variable.
A gambler spins
a wheel of fortune, continuously calibrated between 0 and 1, and observes the
resulting number. Assuming that all subintervals of [0,1] of the same length are
equally likely, this experiment can be modeled in terms a random variable X with
PDF
fX(x) =
 c
if 0 ≤x ≤1,
0
otherwise,

4
General Random Variables
Chap. 3
for some constant c. This constant can be determined by using the normalization
property
1 =
 ∞
−∞
fX(x) dx =
 1
0
c dx = c
 1
0
dx = c
so that c = 1.
More generally, we can consider a random variable X that takes values in
an interval [a, b], and again assume that all subintervals of the same length are
equally likely. We refer to this type of random variable as uniform or uniformly
distributed. Its PDF has the form
fX(x) =
 c
if a ≤x ≤b,
0
otherwise,
where c is a constant. This is the continuous analog of the discrete uniform random
variable discussed in Chapter 2. For fX to satisfy the normalization property, we
must have (cf. Fig. 3.3)
1 =
 b
a
c dx = c
 b
a
dx = c(b −a),
so that
c =
1
b −a.
x 
PDF fX(x)
a 
b
1
b - a 
Figure 3.3: The PDF of a uniform
random variable.
Note that the probability P(X ∈I) that X takes value in a set I is
P(X ∈I) =

[a,b]∩I
1
b −a dx =
1
b −a

[a,b]∩I
dx = length of [a, b] ∩I
length of [a, b]
.
The uniform random variable bears a relation to the discrete uniform law, which
involves a sample space with a ﬁnite number of equally likely outcomes. The dif-
ference is that to obtain the probability of various events, we must now calculate
the “length” of various subsets of the real line instead of counting the number of
outcomes contained in various events.
Example 3.2.
Piecewise Constant PDF.
Alvin’s driving time to work is
between 15 and 20 minutes if the day is sunny, and between 20 and 25 minutes if

Sec. 3.1
Continuous Random Variables and PDFs
5
the day is rainy, with all times being equally likely in each case. Assume that a day
is sunny with probability 2/3 and rainy with probability 1/3. What is the PDF of
the driving time, viewed as a random variable X?
We interpret the statement that “all times are equally likely” in the sunny
and the rainy cases, to mean that the PDF of X is constant in each of the intervals
[15, 20] and [20, 25].
Furthermore, since these two intervals contain all possible
driving times, the PDF should be zero everywhere else:
fX(x) =
 c1
if 15 ≤x < 20,
c2
if 20 ≤x ≤25,
0
otherwise,
where c1 and c2 are some constants. We can determine these constants by using
the given probabilities of a sunny and of a rainy day:
2
3 = P(sunny day) =
 20
15
fX(x) dx =
 20
15
c1 dx = 5c1,
1
3 = P(rainy day) =
 25
20
fX(x) dx =
 25
20
c2 dx = 5c2,
so that
c1 = 2
15,
c2 = 1
15.
Generalizing this example, consider a random variable X whose PDF has the
piecewise constant form
fX(x) =
 ci
if ai ≤x < ai+1,
i = 1, 2, . . . , n −1,
0
otherwise,
where a1, a2, . . . , an are some scalars with ai < ai+1 for all i, and c1, c2, . . . , cn are
some nonnegative constants (cf. Fig. 3.4). The constants ci may be determined by
additional problem data, as in the case of the preceding driving context. Generally,
the ci must be such that the normalization property holds:
1 =
 an
a1
fX(x) dx =
n−1

i=1
 ai+1
ai
ci dx =
n−1

i=1
ci(ai+1 −ai).
x 
PDF fX(x)
a 1
a 2
a 3
a 4
c 1
c 2
c 3
Figure 3.4: A piecewise constant PDF involving three intervals.

6
General Random Variables
Chap. 3
Example 3.3. A PDF can be arbitrarily large.
Consider a random variable
X with PDF
fX(x) =

1
2√x
if 0 < x ≤1,
0
otherwise.
Even though fX(x) becomes inﬁnitely large as x approaches zero, this is still a valid
PDF, because
 ∞
−∞
fX(x) dx =
 1
0
1
2√x dx = √x

1
0
= 1.
Summary of PDF Properties
Let X be a continuous random variable with PDF fX.
• fX(x) ≥0 for all x.
•
 ∞
−∞fX(x) dx = 1.
• If δ is very small, then P

[x, x + δ]

≈fX(x) · δ.
• For any subset B of the real line,
P(X ∈B) =

B
fX(x) dx.
Expectation
The expected value or mean of a continuous random variable X is deﬁned
by†
E[X] =
 ∞
−∞
xfX(x) dx.
† One has to deal with the possibility that the integral  ∞
−∞xfX(x) dx is inﬁ-
nite or undeﬁned. More concretely, we will say that the expectation is well-deﬁned if
 ∞
−∞|x|fX(x) dx < ∞. In that case, it is known that the integral  ∞
−∞xfX(x) dx takes
a ﬁnite and unambiguous value.
For an example where the expectation is not well-deﬁned, consider a random vari-
able X with PDF fX(x) = c/(1 + x2), where c is a constant chosen to enforce the nor-
malization condition. The expression |x|fX(x) is approximately the same as 1/|x| when
|x| is large. Using the fact  ∞
1 (1/x) dx = ∞, one can show that  ∞
−∞|x|fX(x) dx = ∞.
Thus, E[X] is left undeﬁned, despite the symmetry of the PDF around zero.
Throughout this book, in lack of an indication to the contrary, we implicitly
assume that the expected value of the random variables of interest is well-deﬁned.

Sec. 3.1
Continuous Random Variables and PDFs
7
This is similar to the discrete case except that the PMF is replaced by the
PDF, and summation is replaced by integration. As in Chapter 2, E[X] can be
interpreted as the “center of gravity” of the probability law and, also, as the
anticipated average value of X in a large number of independent repetitions of
the experiment. Its mathematical properties are similar to the discrete case –
after all, an integral is just a limiting form of a sum.
If X is a continuous random variable with given PDF, any real-valued
function Y = g(X) of X is also a random variable.
Note that Y can be a
continuous random variable: for example, consider the trivial case where Y =
g(X) = X. But Y can also turn out to be discrete. For example, suppose that
g(x) = 1 for x > 0, and g(x) = 0, otherwise. Then Y = g(X) is a discrete
random variable. In either case, the mean of g(X) satisﬁes the expected value
rule
E
	
g(X)

=
 ∞
−∞
g(x)fX(x) dx,
in complete analogy with the discrete case.
The nth moment of a continuous random variable X is deﬁned as E[Xn],
the expected value of the random variable Xn.
The variance, denoted by
var(X), is deﬁned as the expected value of the random variable

X −E[X]
2.
We now summarize this discussion and list a number of additional facts
that are practically identical to their discrete counterparts.
Expectation of a Continuous Random Variable and its Properties
Let X be a continuous random variable with PDF fX.
• The expectation of X is deﬁned by
E[X] =
 ∞
−∞
xfX(x) dx.
• The expected value rule for a function g(X) has the form
E
	
g(X)

=
 ∞
−∞
g(x)fX(x) dx.
• The variance of X is deﬁned by
var(X) = E
	
X −E[X]
2
=
 ∞
−∞

x −E[X]
2fX(x) dx.

8
General Random Variables
Chap. 3
• We have
0 ≤var(X) = E[X2] −

E[X]
2.
• If Y = aX + b, where a and b are given scalars, then
E[Y ] = aE[X] + b,
var(Y ) = a2var(X).
Example 3.4.
Mean and Variance of the Uniform Random Variable.
Consider the case of a uniform PDF over an interval [a, b], as in Example 3.1. We
have
E[X] =
 ∞
−∞
xfX(x) dx
=
 b
a
x ·
1
b −a dx
=
1
b −a · 1
2x2
b
a
=
1
b −a · b2 −a2
2
= a + b
2
,
as one expects based on the symmetry of the PDF around (a + b)/2.
To obtain the variance, we ﬁrst calculate the second moment. We have
E[X2] =
 b
a
x2
b −a dx
=
1
b −a
 b
a
x2 dx
=
1
b −a · 1
3x3
b
a
= b3 −a3
3(b −a)
= a2 + ab + b2
3
.
Thus, the variance is obtained as
var(X) = E[X2] −
E[X]2 = a2 + ab + b2
3
−(a + b)2
4
= (b −a)2
12
,
after some calculation.

Sec. 3.1
Continuous Random Variables and PDFs
9
Suppose now that [a, b] = [0, 1], and consider the function g(x) = 1 if x ≤1/3,
and g(x) = 2 if x > 1/3. The random variable Y = g(X) is a discrete one with
PMF pY (1) = P(X ≤1/3) = 1/3, pY (2) = 1 −pY (1) = 2/3. Thus,
E[Y ] = 1
3 · 1 + 2
3 · 2 = 5
3.
The same result could be obtained using the expected value rule:
E[Y ] =
 1
0
g(x)fX(x) dx =
 1/3
0
dx +
 1
1/3
2 dx = 5
3.
Exponential Random Variable
An exponential random variable has a PDF of the form
fX(x) =

λe−λx
if x ≥0,
0
otherwise,
where λ is a positive parameter characterizing the PDF (see Fig. 3.5). This is a
legitimate PDF because
 ∞
−∞
fX(x) dx =
 ∞
0
λe−λx dx = −e−λx

∞
0 = 1.
Note that the probability that X exceeds a certain value falls exponentially.
Indeed, for any a ≥0, we have
P(X ≥a) =
 ∞
a
λe−λx dx = −e−λx

∞
a = e−λa.
An exponential random variable can be a very good model for the amount
of time until a piece of equipment breaks down, until a light bulb burns out,
or until an accident occurs. It will play a major role in our study of random
processes in Chapter 5, but for the time being we will simply view it as an
example of a random variable that is fairly tractable analytically.
0
x 
λ
0
x 
λ
Small λ
Large λ
Figure 3.5: The PDF λe−λx of an exponential random variable.

10
General Random Variables
Chap. 3
The mean and the variance can be calculated to be
E[X] = 1
λ,
var(X) = 1
λ2 .
These formulas can be veriﬁed by straightforward calculation, as we now show.
We have, using integration by parts,
E[X] =
 ∞
0
xλe−λx dx
= (−xe−λx)

∞
0 +
 ∞
0
e−λx dx
= 0 −e−λx
λ

∞
0
= 1
λ.
Using again integration by parts, the second moment is
E[X2] =
 ∞
0
x2λe−λx dx
= (−x2e−λx)

∞
0 +
 ∞
0
2xe−λx dx
= 0 + 2
λE[X]
= 2
λ2 .
Finally, using the formula var(X) = E[X2] −

E[X]
2, we obtain
var(X) = 2
λ2 −1
λ2 = 1
λ2 .
Example 3.5.
The time until a small meteorite ﬁrst lands anywhere in the Sahara
desert is modeled as an exponential random variable with a mean of 10 days. The
time is currently midnight. What is the probability that a meteorite ﬁrst lands
some time between 6am and 6pm of the ﬁrst day?
Let X be the time elapsed until the event of interest, measured in days.
Then, X is exponential, with mean 1/λ = 10, which yields λ = 1/10. The desired
probability is
P(1/4 ≤X ≤3/4) = P(X ≥1/4) −P(X > 3/4) = e−1/40 −e−3/40 = 0.0476,
where we have used the formula P(X ≥a) = P(X > a) = e−λa.

Sec. 3.2
Cumulative Distribution Functions
11
Let us also derive an expression for the probability that the time when a
meteorite ﬁrst lands will be between 6am and 6pm of some day. For the kth day,
this set of times corresponds to the event k −(3/4) ≤X ≤k −(1/4). Since these
events are disjoint, the probability of interest is
∞

k=1
P

k −3
4 ≤X ≤k −1
4

=
∞

k=1

P

X ≥k −3
4

−P

X > k −1
4

=
∞

k=1

e−(4k−3)/40 −e−(4k−1)/40
.
We omit the remainder of the calculation, which involves using the geometric series
formula.
3.2
CUMULATIVE DISTRIBUTION FUNCTIONS
We have been dealing with discrete and continuous random variables in a some-
what diﬀerent manner, using PMFs and PDFs, respectively. It would be desir-
able to describe all kinds of random variables with a single mathematical concept.
This is accomplished by the cumulative distribution function, or CDF for
short. The CDF of a random variable X is denoted by FX and provides the
probability P(X ≤x). In particular, for every x we have
FX(x) = P(X ≤x) =










k≤x
pX(k)
X: discrete,
 x
−∞
fX(t) dt
X: continuous.
Loosely speaking, the CDF FX(x) “accumulates” probability “up to” the value x.
Any random variable associated with a given probability model has a CDF,
regardless of whether it is discrete, continuous, or other. This is because {X ≤x}
is always an event and therefore has a well-deﬁned probability. Figures 3.6 and
3.7 illustrate the CDFs of various discrete and continuous random variables.
From these ﬁgures, as well as from the deﬁnition, some general properties of the
CDF can be observed.

12
General Random Variables
Chap. 3
PMF pX(x)
1
0
0
1
0
0
x
1
2
4
3
1
2
4
3
px(2)
px(2)
CDF FX(x)
PMF pX(x)
x
x
x
CDF FX(x)
.
.
.
. . . .
Figure 3.6: CDFs of some discrete random variables. The CDF is related to the
PMF through the formula
FX(x) = P(X ≤x) =

k≤x
pX(k),
and has a staircase form, with jumps occurring at the values of positive probability
mass. Note that at the points where a jump occurs, the value of FX is the larger
of the two corresponding values (i.e., FX is continuous from the right).
Properties of a CDF
The CDF FX of a random variable X is deﬁned by
FX(x) = P(X ≤x),
for all x,
and has the following properties.
• FX is monotonically nondecreasing:
if x ≤y, then FX(x) ≤FX(y).
• FX(x) tends to 0 as x →−∞, and to 1 as x →∞.
• If X is discrete, then FX has a piecewise constant and staircase-like
form.
• If X is continuous, then FX has a continuously varying form.

Sec. 3.2
Cumulative Distribution Functions
13
• If X is discrete and takes integer values, the PMF and the CDF can
be obtained from each other by summing or diﬀerencing:
FX(k) =
k

i=−∞
pX(i),
pX(k) = P(X ≤k) −P(X ≤k −1) = FX(k) −FX(k −1),
for all integers k.
• If X is continuous, the PDF and the CDF can be obtained from each
other by integration or diﬀerentiation:
FX(x) =
 x
−∞
fX(t) dt,
fX(x) = dFX
dx (x).
(The latter relation is valid for those x for which the CDF has a deriva-
tive.)
Because the CDF is deﬁned for any type of random variable, it provides
a convenient means for exploring the relations between continuous and discrete
random variables.
This is illustrated in the following example, which shows
that there is a close relation between the geometric and the exponential random
variables.
Example 3.6. The Geometric and Exponential CDFs.
Let X be a geometric
random variable with parameter p; that is, X is the number of trials to obtain the
ﬁrst success in a sequence of independent Bernoulli trials, where the probability of
success is p. Thus, for k = 1, 2, . . ., we have P(X = k) = p(1 −p)k−1 and the CDF
is given by
F geo(n) =
n

k=1
p(1 −p)k−1 = p1 −(1 −p)n
1 −(1 −p) = 1 −(1 −p)n,
for n = 1, 2, . . .
Suppose now that X is an exponential random variable with parameter λ > 0.
Its CDF is given by
F exp(x) = P(X ≤x) = 0,
for x ≤0,
and
F exp(x) =
 x
0
λe−λtdt = −e−λt
x
0
= 1 −e−λx,
for x > 0.

14
General Random Variables
Chap. 3
CDF FX(x)
x 
PDF fX (x)
a 
b
1
b - a 
a 
b
1
a 
b
2
b - a 
a 
b
1
x  - a
b - a
(x - a)2
(b - a)2
c
c
Area = Fx(c)
CDF FX(x)
PDF fX (x)
x 
x 
x 
Figure 3.7: CDFs of some continuous random variables. The CDF is related to
the PDF through the formula
FX(x) = P(X ≤x) =
 x
−∞
fX(t) dt.
Thus, the PDF fX can be obtained from the CDF by diﬀerentiation:
fX(x) = dFX(x)
dx
.
For a continuous random variable, the CDF has no jumps, i.e., it is continuous.
To compare the two CDFs above, let δ = −ln(1 −p)/λ, so that
e−λδ = 1 −p.
Then we see that the values of the exponential and the geometric CDFs are equal
for all x = nδ, where n = 1, 2, . . ., i.e.,
F exp(nδ) = F geo(n),
n = 1, 2, . . . ,
as illustrated in Fig. 3.8.
If δ is very small, there is close proximity of the exponential and the geometric
CDFs, provided that we scale the values taken by the geometric random variable by
δ. This relation is best interpreted by viewing X as time, either continuous, in the
case of the exponential, or δ-discretized, in the case of the geometric. In particular,
suppose that δ is a small number, and that every δ seconds, we ﬂip a coin with the
probability of heads being a small number p. Then, the time of the ﬁrst occurrence
of heads is well approximated by an exponential random variable. The parameter

Sec. 3.2
Cumulative Distribution Functions
15
1
0
x
Geometric CDF 
1 - (1 - p)n with p = 1 - e -λδ
δ
nδ
Exponential CDF 1 - e -λx
Figure 3.8: Relation of the geometric and the exponential CDFs. We have
F exp(nδ) = F geo(n),
n = 1, 2, . . . ,
if the interval δ is such that e−λδ = 1 −p. As δ approaches 0, the exponential
random variable can be interpreted as the “limit” of the geometric.
λ of this exponential is such that e−λδ = 1 −p or λ = −ln(1 −p)/δ. This relation
between the geometric and the exponential random variables will play an important
role in the theory of the Bernoulli and Poisson stochastic processes in Chapter 5.
Sometimes, in order to calculate the PMF or PDF of a discrete or contin-
uous random variable, respectively, it is more convenient to ﬁrst calculate the
CDF and then use the preceding relations. The systematic use of this approach
for the case of a continuous random variable will be discussed in Section 3.6.
The following is a discrete example.
Example 3.7.
The Maximum of Several Random Variables.
You are
allowed to take a certain test three times, and your ﬁnal score will be the maximum
of the test scores. Thus,
X = max{X1, X2, X3},
where X1, X2, X3 are the three test scores and X is the ﬁnal score. Assume that
your score in each test takes one of the values from 1 to 10 with equal probability
1/10, independently of the scores in other tests. What is the PMF pX of the ﬁnal
score?
We calculate the PMF indirectly. We ﬁrst compute the CDF FX(k) and then
obtain the PMF as
pX(k) = FX(k) −FX(k −1),
k = 1, . . . , 10.

16
General Random Variables
Chap. 3
We have
FX(k) = P(X ≤k)
= P(X1 ≤k, X2 ≤k, X3 ≤k)
= P(X1 ≤k)P(X2 ≤k)P(X3 ≤k)
=
 k
10
3
,
where the third equality follows from the independence of the events {X1 ≤k},
{X2 ≤k}, {X3 ≤k}. Thus the PMF is given by
pX(k) =
 k
10
3
−
k −1
10
3
,
k = 1, . . . , 10.
3.3
NORMAL RANDOM VARIABLES
A continuous random variable X is said to be normal or Gaussian if it has a
PDF of the form (see Fig. 3.9)
fX(x) =
1
√
2π σ e−(x−µ)2/2σ2,
where µ and σ are two scalar parameters characterizing the PDF, with σ assumed
nonnegative. It can be veriﬁed that the normalization property
1
√
2π σ
 ∞
−∞
e−(x−µ)2/2σ2 dx = 1
holds (see the theoretical problems).
1
2
-1
3
0
Normal PDF fx(x)
x 
1
2
-1
3
0
x 
Normal CDF FX(x)
1
0.5
µ = 1
µ = 1
Figure 3.9: A normal PDF and CDF, with µ = 1 and σ2 = 1. We observe that
the PDF is symmetric around its mean µ, and has a characteristic bell-shape.
As x gets further from µ, the term e−(x−µ)2/2σ2 decreases very rapidly. In this
ﬁgure, the PDF is very close to zero outside the interval [−1, 3].

Sec. 3.3
Normal Random Variables
17
The mean and the variance can be calculated to be
E[X] = µ,
var(X) = σ2.
To see this, note that the PDF is symmetric around µ, so its mean must be µ.
Furthermore, the variance is given by
var(X) =
1
√
2π σ
 ∞
−∞
(x −µ)2e−(x−µ)2/2σ2 dx.
Using the change of variables y = (x −µ)/σ and integration by parts, we have
var(X) =
σ2
√
2π
 ∞
−∞
y2e−y2/2 dy
=
σ2
√
2π

−ye−y2/2
 
∞
−∞
+ σ2
√
2π
 ∞
−∞
e−y2/2 dy
=
σ2
√
2π
 ∞
−∞
e−y2/2 dy
= σ2.
The last equality above is obtained by using the fact
1
√
2π
 ∞
−∞
e−y2/2 dy = 1,
which is just the normalization property of the normal PDF for the case where
µ = 0 and σ = 1.
The normal random variable has several special properties. The following
one is particularly important and will be justiﬁed in Section 3.6.
Normality is Preserved by Linear Transformations
If X is a normal random variable with mean µ and variance σ2, and if a, b
are scalars, then the random variable
Y = aX + b
is also normal, with mean and variance
E[Y ] = aµ + b,
var(Y ) = a2σ2.

18
General Random Variables
Chap. 3
The Standard Normal Random Variable
A normal random variable Y with zero mean and unit variance is said to be a
standard normal. Its CDF is denoted by Φ,
Φ(y) = P(Y ≤y) = P(Y < y) =
1
√
2π
 y
−∞
e−t2/2 dt.
It is recorded in a table (given in the next page), and is a very useful tool
for calculating various probabilities involving normal random variables; see also
Fig. 3.10.
Note that the table only provides the values of Φ(y) for y ≥0, because the
omitted values can be found using the symmetry of the PDF. For example, if Y
is a standard normal random variable, we have
Φ(−0.5) = P(Y ≤−0.5) = P(Y ≥0.5) = 1 −P(Y < 0.5)
= 1 −Φ(0.5) = 1 −.6915 = 0.3085.
Let X be a normal random variable with mean µ and variance σ2. We
“standardize” X by deﬁning a new random variable Y given by
Y = X −µ
σ
.
Since Y is a linear transformation of X, it is normal. Furthermore,
E[Y ] = E[X] −µ
σ
= 0,
var(Y ) = var(X)
σ2
= 1.
Thus, Y is a standard normal random variable. This fact allows us to calculate
the probability of any event deﬁned in terms of X: we redeﬁne the event in terms
of Y , and then use the standard normal table.
2
-1
0
Standard Normal PDF
0.399
Mean = 0
Variance = 1
2
-1
0
y 
Standard Normal CDF
Φ(y )
1
0.7
Area = Φ(0.7)
Φ(0.7)
0.7
Figure 3.10: The PDF
fY (y) =
1
√
2π
e−y2/2
of the standard normal random variable. Its corresponding CDF, which is denoted
by Φ(y), is recorded in a table.

Sec. 3.3
Normal Random Variables
19
Example 3.8. Using the Normal Table.
The annual snowfall at a particular
geographic location is modeled as a normal random variable with a mean of µ = 60
inches, and a standard deviation of σ = 20. What is the probability that this year’s
snowfall will be at least 80 inches?
Let X be the snow accumulation, viewed as a normal random variable, and
let
Y = X −µ
σ
= X −60
20
,
be the corresponding standard normal random variable. We want to ﬁnd
P(X ≥80) = P
X −60
20
≥80 −60
20

= P

Y ≥80 −60
20

= P(Y ≥1) = 1−Φ(1),
where Φ is the CDF of the standard normal. We read the value Φ(1) from the table:
Φ(1) = 0.8413,
so that
P(X ≥80) = 1 −Φ(1) = 0.1587.
Generalizing the approach in the preceding example, we have the following
procedure.
CDF Calculation of the Normal Random Variable
The CDF of a normal random variable X with mean µ and variance σ2 is
obtained using the standard normal table as
P(X ≤x) = P
X −µ
σ
≤x −µ
σ

= P

Y ≤x −µ
σ

= Φ
x −µ
σ

,
where Y is a standard normal random variable.
The normal random variable is often used in signal processing and com-
munications engineering to model noise and unpredictable distortions of signals.
The following is a typical example.
Example 3.9. Signal Detection.
A binary message is transmitted as a signal
that is either −1 or +1. The communication channel corrupts the transmission with
additive normal noise with mean µ = 0 and variance σ2. The receiver concludes
that the signal −1 (or +1) was transmitted if the value received is < 0 (or ≥0,
respectively); see Fig. 3.11. What is the probability of error?
An error occurs whenever −1 is transmitted and the noise N is at least 1 so
that N + S = N −1 ≥0, or whenever +1 is transmitted and the noise N is smaller

20
General Random Variables
Chap. 3
+1 if N + S > 0 
-1 if N +  S <0
Transmitter
Receiver
Noisy Channel
Signal 
S = +1 or -1
Normal zero-mean 
noise N 
with variance σ2
N  + S
0
-1
Region of error
when a -1 is
transmitted
0
Region of error
when a +1 is
transmitted
1
Figure 3.11: The signal detection scheme of Example 3.9. The area of the
shaded region gives the probability of error in the two cases where −1 and +1
is transmitted.
than −1 so that N + S = N + 1 < 0. In the former case, the probability of error is
P(N ≥1) = 1 −P(N < 1) = 1 −P
N −µ
σ
< 1 −µ
σ

= 1 −Φ
1 −µ
σ

= 1 −Φ
 1
σ

.
In the latter case, the probability of error is the same, by symmetry. The value
of Φ(1/σ) can be obtained from the normal table. For σ = 1, we have Φ(1/σ) =
Φ(1) = 0.8413, and the probability of the error is 0.1587.
The normal random variable plays an important role in a broad range of
probabilistic models. The main reason is that, generally speaking, it models well
the additive eﬀect of many independent factors, in a variety of engineering, phys-
ical, and statistical contexts. Mathematically, the key fact is that the sum of a
large number of independent and identically distributed (not necessarily normal)
random variables has an approximately normal CDF, regardless of the CDF of
the individual random variables.
This property is captured in the celebrated
central limit theorem, which will be discussed in Chapter 7.
3.4
CONDITIONING ON AN EVENT
The conditional PDF of a continuous random variable X, conditioned on a
particular event A with P(A) > 0, is a function fX|A that satisﬁes
P(X ∈B | A) =

B
fX|A(x) dx,

Sec. 3.4
Conditioning on an event
21
for any subset B of the real line. It is the same as an ordinary PDF, except that
it now refers to a new universe in which the event A is known to have occurred.
An important special case arises when we condition on X belonging to a
subset A of the real line, with P(X ∈A) > 0. We then have
P(X ∈B | X ∈A) = P(X ∈B and X ∈A)
P(X ∈A)
=

A∩B
fX(x) dx
P(X ∈A)
.
This formula must agree with the earlier one, and therefore,†
fX|A(x | A) =

fX(x)
P(X ∈A)
if x ∈A,
0
otherwise.
As in the discrete case, the conditional PDF is zero outside the conditioning
set.
Within the conditioning set, the conditional PDF has exactly the same
shape as the unconditional one, except that it is scaled by the constant factor
1/P(X ∈A). This normalization ensures that fX|A integrates to 1, which makes
it a legitimate PDF; see Fig. 3.13.
x 
fX(x)
a 
b
fX|A(x)
Figure 3.13: The unconditional PDF fX and the conditional PDF fX|A, where
A is the interval [a, b]. Note that within the conditioning event A, fX|A retains
the same shape as fX, except that it is scaled along the vertical axis.
Example 3.10. The exponential random variable is memoryless.
Alvin
goes to a bus stop where the time T between two successive buses has an exponential
PDF with parameter λ. Suppose that Alvin arrives t secs after the preceding bus
arrival and let us express this fact with the event A = {T > t}. Let X be the time
that Alvin has to wait for the next bus to arrive. What is the conditional CDF
FX|A(x | A)?
† We are using here the simpler notation fX|A(x) in place of fX|X∈A, which is
more accurate.

22
General Random Variables
Chap. 3
We have
P(X > x | A) = P(T > t + x | T > t)
= P(T > t + x and T > t)
P(T > t)
= P(T > t + x)
P(T > t)
= e−λ(t+x)
e−λt
= e−λx,
where we have used the expression for the CDF of an exponential random variable
derived in Example 3.6.
Thus, the conditional CDF of X is exponential with parameter λ, regardless
the time t that elapsed between the preceding bus arrival and Alvin’s arrival. This
is known as the memorylessness property of the exponential. Generally, if we model
the time to complete a certain operation by an exponential random variable X,
this property implies that as long as the operation has not been completed, the
remaining time up to completion has the same exponential CDF, no matter when
the operation started.
For a continuous random variable, the conditional expectation is deﬁned
similar to the unconditional case, except that we now need to use the condi-
tional PDF. We summarize the discussion so far, together with some additional
properties in the table that follows.
Conditional PDF and Expectation Given an Event
• The conditional PDF fX|A of a continuous random variable X given
an event A with P(A) > 0, satisﬁes
P(X ∈B | A) =

B
fX|A(x) dx.
• If A be a subset of the real line with P(X ∈A) > 0, then
fX|A(x) =



fX(x)
P(X ∈A)
if x ∈A,
0
otherwise,
and
P(X ∈B | X ∈A) =

B
fX|A(x) dx,
for any set B.

Sec. 3.4
Conditioning on an event
23
• The corresponding conditional expectation is deﬁned by
E[X | A] =
 ∞
−∞
xfX|A(x) dx.
• The expected value rule remains valid:
E
	
g(X) | A

=
 ∞
−∞
g(x)fX|A(x) dx.
• If A1, A2, . . . , An are disjoint events with P(Ai) > 0 for each i, that
form a partition of the sample space, then
fX(x) =
n

i=1
P(Ai)fX|Ai(x)
(a version of the total probability theorem), and
E[X] =
n

i=1
P(Ai)E[X | Ai]
(the total expectation theorem). Similarly,
E
	
g(X)

=
n

i=1
P(Ai)E
	
g(X) | Ai

.
To justify the above version of the total probability theorem, we use the
total probability theorem from Chapter 1, to obtain
P(X ≤x) =
n

i=1
P(Ai)P(X ≤x | Ai).
This formula can be rewritten as
 x
−∞
fX(t) dt =
n

i=1
P(Ai)
 x
−∞
fX|Ai(t) dt.
We take the derivative of both sides, with respect to x, and obtain the desired
relation
fX(x) =
n

i=1
P(Ai)fX|Ai(x).

24
General Random Variables
Chap. 3
If we now multiply both sides by x and then integrate from −∞to ∞, we obtain
the total expectation theorem for continuous random variables.
The total expectation theorem can often facilitate the calculation of the
mean, variance, and other moments of a random variable, using a divide-and-
conquer approach.
Example 3.11. Mean and Variance of a Piecewise Constant PDF. Suppose
that the random variable X has the piecewise constant PDF
fX(x) =
 1/3
if 0 ≤x ≤1,
2/3
if 1 < x ≤2,
0
otherwise,
(see Fig. 3.14). Consider the events
A1 = 
X lies in the ﬁrst interval [0, 1]
,
A2 = 
X lies in the second interval (1, 2]
.
We have from the given PDF,
P(A1) =
 1
0
fX(x) dx = 1
3,
P(A2) =
 2
1
fX(x) dx = 2
3.
Furthermore, the conditional mean and second moment of X, conditioned on A1
and A2, are easily calculated since the corresponding conditional PDFs fX|A1 and
fX|A2 are uniform. We recall from Example 3.4 that the mean of a uniform random
variable on an interval [a, b] is (a + b)/2 and its second moment is (a2 + ab + b2)/3.
Thus,
E[X | A1] = 1
2,
E[X | A2] = 3
2,
E	
X2 | A1

= 1
3,
E	
X2 | A2

= 7
3.
x
1
fx(x)
2
1/3
2/3
Figure 3.14: Piecewise con-
stant PDF for Example 3.11.

Sec. 3.4
Conditioning on an event
25
We now use the total expectation theorem to obtain
E[X] = P(A1)E[X | A1] + P(A2)E[X | A2] = 1
3 · 1
2 + 2
3 · 3
2 = 7
6,
E[X2] = P(A1)E[X2 | A1] + P(A2)E[X2 | A2] = 1
3 · 1
3 + 2
3 · 7
3 = 15
9 .
The variance is given by
var(X) = E[X2] −
E[X]2 = 15
9 −49
36 = 11
36.
Note that this approach to the mean and variance calculation is easily generalized
to piecewise constant PDFs with more than two pieces.
The next example illustrates a divide-and-conquer approach that uses the
total probability theorem to calculate a PDF.
Example 3.12.
The metro train arrives at the station near your home every
quarter hour starting at 6:00 AM. You walk into the station every morning between
7:10 and 7:30 AM, with the time in this interval being a uniform random variable.
What is the PDF of the time you have to wait for the ﬁrst train to arrive?
x 
fX(x)
7:10
7:15
7:30
fY|A(y)
y
5
1/5
fY(y)
y
fY|B(y)
y
15
1/15
5
15
1/10
1/20
(a)
(b)
(c)
(d)
Figure 3.15: The PDFs fX, fY |A, fY |B, and fY in Example 3.12.
The time of your arrival, denoted by X, is a uniform random variable on the
interval from 7:10 to 7:30; see Fig. 3.15(a). Let Y be the waiting time. We calculate
the PDF fY using a divide-and-conquer strategy. Let A and B be the events
A = {7:10 ≤X ≤7:15} = {you board the 7:15 train},

26
General Random Variables
Chap. 3
B = {7:15 < X ≤7:30} = {you board the 7:30 train}.
Conditioned on the event A, your arrival time is uniform on the interval from 7:10
to 7:15. In that case, the waiting time Y is also uniform and takes values between
0 and 5 minutes; see Fig. 3.15(b). Similarly, conditioned on B, Y is uniform and
takes values between 0 and 15 minutes; see Fig. 3.15(c). The PDF of Y is obtained
using the total probability theorem,
fY (y) = P(A)fY |A(y) + P(B)fY |B(y),
and is shown in Fig. 3.15(d). In particular,
fY (y) = 1
4 · 1
5 + 3
4 · 1
15 = 1
10,
for 0 ≤y ≤5,
and
fY (y) = 1
4 · 0 + 3
4 · 1
15 = 1
20,
for 5 < y ≤15.
3.5
MULTIPLE CONTINUOUS RANDOM VARIABLES
We will now extend the notion of a PDF to the case of multiple random vari-
ables. In complete analogy with discrete random variables, we introduce joint,
marginal, and conditional PDFs. Their intuitive interpretation as well as their
main properties parallel the discrete case.
We say that two continuous random variables associated with a common
experiment are jointly continuous and can be described in terms of a joint
PDF fX,Y , if fX,Y is a nonnegative function that satisﬁes
P

(X, Y ) ∈B

=
 
(x,y)∈B
fX,Y (x, y) dx dy,
for every subset B of the two-dimensional plane. The notation above means
that the integration is carried over the set B. In the particular case where B is
a rectangle of the form B = [a, b] × [c, d], we have
P(a ≤X ≤b, c ≤Y ≤d) =
 d
c
 b
a
fX,Y (x, y) dx dy.
Furthermore, by letting B be the entire two-dimensional plane, we obtain the
normalization property
 ∞
−∞
 ∞
−∞
fX,Y (x, y) dx dy = 1.

Sec. 3.5
Multiple Continuous Random Variables
27
To interpret the PDF, we let δ be very small and consider the probability
of a small rectangle. We have
P(a ≤X ≤a+δ, c ≤Y ≤c+δ) =
 c+δ
c
 a+δ
a
fX,Y (x, y) dx dy ≈fX,Y (a, c)·δ2,
so we can view fX,Y (a, c) as the “probability per unit area” in the vicinity of
(a, c).
The joint PDF contains all conceivable probabilistic information on the
random variables X and Y , as well as their dependencies. It allows us to calculate
the probability of any event that can be deﬁned in terms of these two random
variables. As a special case, it can be used to calculate the probability of an
event involving only one of them. For example, let A be a subset of the real line
and consider the event {X ∈A}. We have
P(X ∈A) = P

X ∈A and Y ∈(−∞, ∞)

=

A
 ∞
−∞
fX,Y (x, y) dy dx.
Comparing with the formula
P(X ∈A) =

A
fX(x) dx,
we see that the marginal PDF fX of X is given by
fX(x) =
 ∞
−∞
fX,Y (x, y) dy.
Similarly,
fY (y) =
 ∞
−∞
fX,Y (x, y) dx.
Example 3.13. Two-Dimensional Uniform PDF. Romeo and Juliet have a
date at a given time, and each will arrive at the meeting place with a delay between
0 and 1 hour (recall the example given in Section 1.2). Let X and Y denote the
delays of Romeo and Juliet, respectively.
Assuming that no pairs (x, y) in the
square [0, 1] × [0, 1] are more likely than others, a natural model involves a joint
PDF of the form
fX,Y (x, y) =
 c
if 0 ≤x ≤1 and 0 ≤y ≤1,
0
otherwise,
where c is a constant. For this PDF to satisfy the normalization property
 ∞
−∞
 ∞
−∞
fX,Y (x, y) dx dy =
 1
0
 1
0
c dx dy = 1,

28
General Random Variables
Chap. 3
we must have
c = 1.
This is an example of a uniform PDF on the unit square. More generally,
let us ﬁx some subset S of the two-dimensional plane. The corresponding uniform
joint PDF on S is deﬁned to be
fX,Y (x, y) =

1
area of S
if (x, y) ∈S,
0
otherwise.
For any set A ⊂S, the probability that the experimental value of (X, Y ) lies in A
is
P
(X, Y ) ∈A
=
 
(x,y)∈A
fX,Y (x, y) dx dy =
1
area of S
 
(x,y)∈A∩S
dx dy = area of A ∩S
area of S
.
Example 3.14.
We are told that the joint PDF of the random variables X and Y
is a constant c on the set S shown in Fig. 3.16 and is zero outside. Find the value
of c and the marginal PDFs of X and Y .
The area of the set S is equal to 4 and, therefore, fX,Y (x, y) = c = 1/4, for
(x, y) ∈S. To ﬁnd the marginal PDF fX(x) for some particular x, we integrate
(with respect to y) the joint PDF over the vertical line corresponding to that x.
The resulting PDF is shown in the ﬁgure. We can compute fY similarly.
x 
fX(x)
fY(y)
y
S
x 
1/4
3/4
y
1/4
1/2
1
3
4
2
2
1
3
Figure 3.16: The joint PDF in Example 3.14 and the resulting marginal
PDFs.

Sec. 3.5
Multiple Continuous Random Variables
29
Example 3.15.
Buﬀon’s Needle.
This is a famous example, which marks
the origin of the subject of geometrical probability, that is, the analysis of the
geometrical conﬁguration of randomly placed objects.
A surface is ruled with parallel lines, which are at distance d from each other
(see Fig. 3.17). Suppose that we throw a needle of length l on the surface at random.
What is the probability that the needle will intersect one of the lines?
x
d
θ
l
Figure 3.17: Buﬀon’s needle.
The
length of the line segment between the
midpoint of the needle and the point
of intersection of the axis of the needle
with the closest parallel line is x/ sin θ.
The needle will intersect the closest par-
allel line if and only if this length is less
than l/2.
We assume here that l < d so that the needle cannot intersect two lines
simultaneously.
Let X be the distance from the midpoint of the needle to the
nearest of the parallel lines, and let Θ be the acute angle formed by the axis of the
needle and the parallel lines (see Fig. 3.17). We model the pair of random variables
(X, Θ) with a uniform joint PDF over the rectangle [0, d/2] × [0, π/2], so that
fX,Θ(x, θ) =
 4/(πd)
if x ∈[0, d/2] and θ ∈[0, π/2],
0
otherwise.
As can be seen from Fig. 3.17, the needle will intersect one of the lines if and
only if
X ≤l
2 sin Θ,
so the probability of intersection is
P
X ≤(l/2) sin Θ
=
 
x≤(l/2) sin θ
fX,Θ(x, θ) dx dθ
= 4
πd
 π/2
0
 (l/2) sin θ
0
dx dθ
= 4
πd
 π/2
0
l
2 sin θ dθ
= 2l
πd(−cos θ)

π/2
0
= 2l
πd.
The probability of intersection can be empirically estimated, by repeating the ex-
periment a large number of times. Since it is equal to 2l/πd, this provides us with
a method for the experimental evaluation of π.

30
General Random Variables
Chap. 3
Expectation
If X and Y are jointly continuous random variables, and g is some function, then
Z = g(X, Y ) is also a random variable. We will see in Section 3.6 methods for
computing the PDF of Z, if it has one. For now, let us note that the expected
value rule is still applicable and
E
	
g(X, Y )

=
 ∞
−∞
 ∞
−∞
g(x, y)fX,Y (x, y) dx dy.
As an important special case, for any scalars a, b, we have
E[aX + bY ] = aE[X] + bE[Y ].
Conditioning One Random Variable on Another
Let X and Y be continuous random variables with joint PDF fX,Y . For any
ﬁxed y with fY (y) > 0, the conditional PDF of X given that Y = y, is deﬁned
by
fX|Y (x | y) = fX,Y (x, y)
fY (y)
.
This deﬁnition is analogous to the formula pX|Y = pX,Y /pY for the discrete case.
When thinking about the conditional PDF, it is best to view y as a ﬁxed
number and consider fX|Y (x | y) as a function of the single variable x. As a
function of x, the conditional PDF fX|Y (x | y) has the same shape as the joint
PDF fX,Y (x, y), because the normalizing factor fY (y) does not depend on x; see
Fig. 3.18. Note that the normalization ensures that
 ∞
−∞
fX|Y (x | y) dx = 1,
so for any ﬁxed y, fX|Y (x | y) is a legitimate PDF.
x 
fX|Y(x|1.5)
y
S
1
3
4
2
2
1
3
x 
x 
x 
1
3
2
fX|Y(x|2.5)
fX|Y(x|3.5)
1
1
1/2
Figure 3.18: Visualization of the conditional PDF fX|Y (x | y). Let X, Y have a
joint PDF which is uniform on the set S. For each ﬁxed y, we consider the joint
PDF along the slice Y = y and normalize it so that it integrates to 1.

Sec. 3.5
Multiple Continuous Random Variables
31
Example 3.16.
Circular Uniform PDF.
John throws a dart at a circular
target of radius r (see Fig. 3.19). We assume that he always hits the target, and
that all points of impact (x, y) are equally likely, so that the joint PDF of the
random variables X and Y is uniform. Following Example 3.13, and since the area
of the circle is πr2, we have
fX,Y (x, y) =

1
area of the circle
if (x, y) is in the circle,
0
otherwise,
=

1
πr2
if x2 + y2 ≤r2,
0
otherwise.
x 
y 
r
Figure 3.19: Circular target for
Example 3.16.
To calculate the conditional PDF fX|Y (x | y), let us ﬁrst calculate the marginal
PDF fY (y). For |y| > r, it is zero. For |y| ≤r, it can be calculated as follows:
fY (y) =
 ∞
−∞
fX,Y (x, y) dx
=
1
πr2

x2+y2≤r2
dx
=
1
πr2
 √
r2−y2
−√
r2−y2
dx
=
2
πr2

r2 −y2.
Note that the marginal fY (y) is not a uniform PDF.

32
General Random Variables
Chap. 3
The conditional PDF is
fX|Y (x | y) = fX,Y (x, y)
fY (y)
=
1
πr2
2
πr2

r2 −y2
=
1
2

r2 −y2 .
Thus, for a ﬁxed value of y, the conditional PDF fX|Y is uniform.
To interpret the conditional PDF, let us ﬁx some small positive numbers
δ1 and δ2, and condition on the event B = {y ≤Y ≤y + δ2}. We have
P(x ≤X ≤x + δ1 | y ≤Y ≤y + δ2) = P(x ≤X ≤x + δ1 and y ≤Y ≤y + δ2)
P(y ≤Y ≤y + δ2)
≈fX,Y (x, y)δ1δ2
fY (y)δ2
= fX|Y (x | y)δ1.
In words, fX|Y (x | y)δ1 provides us with the probability that X belongs in a
small interval [x, x + δ1], given that Y belongs in a small interval [y, y + δ2].
Since fX|Y (x | y)δ1 does not depend on δ2, we can think of the limiting case
where δ2 decreases to zero and write
P(x ≤X ≤x + δ1 | Y = y) ≈fX|Y (x | y)δ1,
(δ1 small),
and, more generally,
P(X ∈A | Y = y) =

A
fX|Y (x | y) dx.
Conditional probabilities, given the zero probability event {Y = y}, were left
undeﬁned in Chapter 1. But the above formula provides a natural way of deﬁning
such conditional probabilities in the present context. In addition, it allows us to
view the conditional PDF fX|Y (x | y) (as a function of x) as a description of the
probability law of X, given that the event {Y = y} has occurred.
As in the discrete case, the conditional PDF fX|Y , together with the
marginal PDF fY are sometimes used to calculate the joint PDF. Furthermore,
this approach can be also used for modeling: instead of directly specifying fX,Y ,
it is often natural to provide a probability law for Y , in terms of a PDF fY , and
then provide a conditional probability law fX|Y (x, y) for X, given any possible
value y of Y .
Example 3.17.
Let X be exponentially distributed with mean 1. Once we
observe the experimental value x of X, we generate a normal random variable Y
with zero mean and variance x + 1. What is the joint PDF of X and Y ?

Sec. 3.5
Multiple Continuous Random Variables
33
We have fX(x) = e−x, for x ≥0, and
fY |X(y | x) =
1

2π(x + 1)
e−y2/2(x+1).
Thus,
fX,Y (x, y) = fX(x)fY |X(y | x) = e−x
1

2π(x + 1)
e−y2/2(x+1),
for all x ≥0 and all y.
Having deﬁned a conditional probability law, we can also deﬁne a corre-
sponding conditional expectation by letting
E[X | Y = y] =
 ∞
−∞
xfX|Y (x | y) dx.
The properties of (unconditional) expectation carry though, with the obvious
modiﬁcations, to conditional expectation. For example the conditional version
of the expected value rule
E[g(X) | Y = y] =
 ∞
−∞
g(x)fX|Y (x | y) dx
remains valid.
Summary of Facts About Multiple Continuous Random Variables
Let X and Y be jointly continuous random variables with joint PDF fX,Y .
• The joint, marginal, and conditional PDFs are related to each other
by the formulas
fX,Y (x, y) = fY (y)fX|Y (x | y),
fX(x) =
 ∞
−∞
fY (y)fX | Y (x | y) dy.
The conditional PDF fX|Y (x | y) is deﬁned only for those y for which
fY (y) > 0.

34
General Random Variables
Chap. 3
• They can be used to calculate probabilities:
P

(X, Y ) ∈B

=
 
(x,y)∈B
fX,Y (x, y) dx dy,
P(X ∈A) =

A
fX(x) dx,
P(X ∈A | Y = y) =

A
fX|Y (x | y) dx.
• They can also be used to calculate expectations:
E[g(X)] =

g(x)fX(x) dx,
E
	
g(X, Y )

=
 
g(x, y)fX,Y (x, y) dx dy,
E
	
g(X) | Y = y

=

g(x)fX|Y (x | y) dx,
E
	
g(X, Y ) | Y = y

=

g(x, y)fX|Y (x | y) dx.
• We have the following versions of the total expectation theorem:
E[X] =

E[X | Y = y]fY (y) dy,
E
	
g(X)

=

E
	
g(X) | Y = y]fY (y) dy,
E
	
g(X, Y )

=

E
	
g(X, Y ) | Y = y]fY (y) dy.
To justify the ﬁrst version of the total expectation theorem, we observe
that

E[X | Y = y]fY (y) dy =
 
xfX|Y (x | y) dx

fY (y) dy
=
 
xfX|Y (x | y)fY (y) dx dy
=
 
xfX,Y (x, y) dx dy

Sec. 3.5
Multiple Continuous Random Variables
35
=

x

fX,Y (x, y) dy

dx
=

xfX(x) dx
= E[X].
The other two versions are justiﬁed similarly.
Inference and the Continuous Bayes’ Rule
In many situations, we have a model of an underlying but unobserved phe-
nomenon, represented by a random variable X with PDF fX, and we make
noisy measurements Y . The measurements are supposed to provide information
about X and are modeled in terms of a conditional PDF fY |X. For example, if
Y is the same as X, but corrupted by zero-mean normally distributed noise, one
would let the conditional PDF fY |X(y | x) of Y , given that X = x, be normal
with mean equal to x. Once the experimental value of Y is measured, what
information does this provide on the unknown value of X?
This setting is similar to that encountered in Section 1.4, when we intro-
duced the Bayes rule and used it to solve inference problems. The only diﬀerence
is that we are now dealing with continuous random variables.
Note that the information provided by the event {Y = y} is described by
the conditional PDF fX|Y (x | y). It thus suﬃces to evaluate the latter PDF. A
calculation analogous to the original derivation of the Bayes’ rule, based on the
formulas fXfY |X = fX,Y = fY fX|Y , yields
fX|Y (x | y) = fX(x)fY |X(y | x)
fY (y)
=
fX(x)fY |X(y | x)

fX(t)fY |X(y | t)dt
,
which is the desired formula.
Example 3.18.
A lightbulb produced by the General Illumination Company is
known to have an exponentially distributed lifetime Y . However, the company has
been experiencing quality control problems. On any given day, the parameter λ of
the PDF of Y is actually a random variable, uniformly distributed in the interval
[0, 1/2]. We test a lightbulb and record the experimental value y of its lifetime.
What can we say about the underlying parameter λ?
We model the parameter λ as a random variable X, with a uniform distri-
bution.
All available information about X is contained in the conditional PDF
fX|X(x | y). We view y as a constant (equal to the observed value of Y ) and con-
centrate on the dependence of the PDF on x. Note that fX(x) = 2, for 0 ≤x ≤1/2.
By the continuous Bayes rule, we have
fX|Y (x | y) =
2xe−xy
 1/2
0
2te−tydt
,
for 0 ≤x ≤1
2.

36
General Random Variables
Chap. 3
In some cases, the unobserved phenomenon is inherently discrete.
For
example, if a binary signal is observed in the presence of noise with a normal
distribution. Or if a medical diagnosis is to be made on the basis of continuous
measurements like temperature and blood counts. In such cases, a somewhat
diﬀerent version of Bayes’ rule applies.
Let X be a discrete random variable that takes values in a ﬁnite set
{1, . . . , n} and which represents the diﬀerent discrete possibilities for the un-
observed phenomenon of interest. The PMF pX of X is assumed to be known.
Let Y be a continuous random variable which, for any given value x, is described
by a conditional PDF fY | X(y | x). We are interested in the conditional PMF of
X given the experimental value y of Y .
Instead of working with conditioning event {Y = y} which has zero proba-
bility, let us instead condition on the event {y ≤Y ≤y + δ}, where δ is a small
positive number, and then take the limit as δ tends to zero. We have, using the
Bayes rule
P(X = x | Y = y) ≈P(X = x | y ≤Y ≤y + δ)
= pX(x)P(y ≤Y ≤y + δ | X = x)
P(y ≤Y ≤y + δ)
≈pX(x)fY |X(y | x)δ
fY (y)δ
= pX(x)fY |X(y | x)
fY (y)
.
The denominator can be evaluated using a version of the total probability theo-
rem introduced in Section 3.4. We have
fY (y) =
n

i=1
pX(i)fY |X(y | i).
Example 3.19.
Let us revisit the signal detection problem considered in 3.9. A
signal S is transmitted and we are given that P(S = 1) = p and P(S = −1) = 1−p.
The received signal is Y = N +S, where N is zero mean normal noise, with variance
σ2, independent of S. What is the probability that S = 1, as a function of the
observed value y of Y ?
Conditioned on S = s, the random variable Y has a normal distribution with
mean s and variance σ2. Applying the formula developed above, we obtain
P(S = 1 | Y = y) = pS(1)fY |S(y | 1)
fY (y)
=
p
√
2π σ e−(y−1)2/2σ2
p
√
2π σ e−(y−1)2/2σ2 +
1−p
√
2π σ e−(y+1)2/2σ2 .

Sec. 3.5
Multiple Continuous Random Variables
37
Independence
In full analogy with the discrete case, we say that two continuous random vari-
ables X and Y are independent if their joint PDF is the product of the marginal
PDFs:
fX,Y (x, y) = fX(x)fY (y),
for all x, y.
Comparing with the formula fX,Y (x, y) = fX|Y (x | y)fY (y), we see that inde-
pendence is the same as the condition
fX|Y (x | y) = fX(x),
for all x and all y with fY (y) > 0,
or, symmetrically,
fY |X(y | x) = fY (y),
for all y and all x with fX(x) > 0.
If X and Y are independent, then any two events of the form {X ∈A} and
{Y ∈B} are independent. Indeed,
P(X ∈A and Y ∈B) =

x∈A

y∈B
fX,Y (x, y) dy dx
=

x∈A

y∈B
fX(x)fY (y) dy dx
=

x∈A
fX(x) dx

y∈B
fY (y) dy
= P(X ∈A)P(Y ∈B).
A converse statement is also true; see the theoretical problems.
A calculation similar to the discrete case shows that if X and Y are inde-
pendent, then
E[g(X)h(Y )] = E[g(X)]E[h(Y )],
for any two functions g and h. Finally, the variance of the sum of independent
random variables is again equal to the sum of the variances.

38
General Random Variables
Chap. 3
Independence of Continuous Random Variables
Suppose that X and Y are independent, that is,
fX,Y (x, y) = fX(x)fY (y),
for all x, y.
We then have the following properties.
• The random variables g(X) and h(Y ) are independent, for any func-
tions g and h.
• We have
E[XY ] = E[X]E[Y ],
and, more generally,
E
	
g(X)h(Y )

= E
	
g(X)

E
	
h(Y )

,
• We have
var(X + Y ) = var(X) + var(Y ).
Joint CDFs
If X and Y are two random variables associated with the same experiment, we
deﬁne their joint CDF by
FX,Y (x, y) = P(X ≤x, Y ≤y).
As in the case of one random variable, the advantage of working with the CDF
is that it applies equally well to discrete and continuous random variables. In
particular, if X and Y are described by a joint PDF fX,Y , then
FX,Y (x, y) = P(X ≤x, Y ≤y) =
 x
−∞
 y
−∞
fX,Y (s, t) ds dt.
Conversely, the PDF can be recovered from the PDF by diﬀerentiating:
fX,Y (x, y) = ∂2FX,Y
∂x∂y (x, y).
Example 3.20.
Let X and Y be described by a uniform PDF on the unit square.
The joint CDF is given by
FX,Y (x, y) = P(X ≤x, Y ≤y) = xy,
for 0 ≤x, y ≤1.

Sec. 3.6
Derived Distributions
39
We then verify that
∂2FX,Y
∂x∂y (x, y) = ∂2(xy)
∂x∂y (x, y) = 1 = fX,Y (x, y),
for all (x, y) in the unit square.
More than Two Random Variables
The joint PDF of three random variables X, Y , and Z is deﬁned in analogy with
the above. For example, we have
P

(X, Y, Z) ∈B

=
  
(x,y,z)∈B
fX,Y,Z(x, y, z) dx dy dz,
for any set B. We also have relations such as
fX,Y (x, y) =

fX,Y,Z(x, y, z) dz,
and
fX(x) =
 
fX,Y,Z(x, y, z) dy dz.
One can also deﬁne conditional PDFs by formulas such as
fX,Y |Z(x, y | z) = fX,Y,Z(x, y, z)
fZ(z)
,
for fZ(z) > 0,
fX|Y,Z(x | y, z) = fX,Y,Z(x, y, z)
fY,Z(y, z)
,
for fY,Z(y, z) > 0.
There is an analog of the multiplication rule:
fX,Y,Z(x, y, z) = fX|Y,Z(x | y, z)fY |Z(y | z)fZ(z).
Finally, we say that the three random variables X, Y , and Z are independent if
fX,Y,Z(x, y, z) = fX(x)fY (y)fZ(z),
for all x, y, z.
The expected value rule for functions takes the form
E
	
g(X, Y, Z)

=
  
g(x, y, z)fX,Y,Z(x, y, z) dx dy dz,
and if g is linear and of the form aX + bY + cZ, then
E[aX + bY + cZ] = aE[X] + bE[Y ] + cE[Z].
Furthermore, there are obvious generalizations of the above to the case of more
than three random variables. For example, for any random variables X1, X2, . . . , Xn
and any scalars a1, a2, . . . , an, we have
E[a1X1 + a2X2 + · · · + anXn] = a1E[X1] + a2E[X2] + · · · + anE[Xn].

40
General Random Variables
Chap. 3
3.6
DERIVED DISTRIBUTIONS
We have seen that the mean of a function Y = g(X) of a continuous random
variable X, can be calculated using the expected value rule
E[Y ] =
 ∞
−∞
g(x)fX(x) dx,
without ﬁrst ﬁnding the PDF fY of Y . Still, in some cases, we may be interested
in an explicit formula for fY . Then, the following two-step approach can be
used.
Calculation of the PDF of a Function Y = g(X) of a Continuous
Random Variable X
1. Calculate the CDF FY of Y using the formula
FY (y) = P

g(X) ≤y

=

{x | g(x)≤y}
fX(x) dx.
2. Diﬀerentiate to obtain the PDF of Y :
fY (y) = dFY
dy (y).
Example 3.21.
Let X be uniform on [0, 1]. Find the PDF of Y =
√
X. Note
that Y takes values between 0 and 1. For every y ∈[0, 1], we have
FY (y) = P(Y ≤y) = P(
√
X ≤y) = P(X ≤y2) = y2,
0 ≤y ≤1.
We then diﬀerentiate and obtain
fY (y) = dFY
dy (y) = d(y2)
dy
= 2y,
0 ≤y ≤1.
Outside the range [0, 1], the CDF FY (y) is constant, with FY (y) = 0 for y ≤0, and
FY (y) = 1 for y ≥1. By diﬀerentiating, we see that fY (y) = 0 for y outside [0, 1].
Example 3.22.
John Slow is driving from Boston to the New York area, a
distance of 180 miles. His average speed is uniformly distributed between 30 and
60 miles per hour. What is the PDF of the duration of the trip?

Sec. 3.6
Derived Distributions
41
Let X be the speed and let Y = g(X) be the trip duration:
g(X) = 180
X .
To ﬁnd the CDF of Y , we must calculate
P(Y ≤y) = P
180
X
≤y

= P

180
y
≤X

.
We use the given uniform PDF of X, which is
fX(x) =
 1/30
if 30 ≤x ≤60,
0
otherwise,
and the corresponding CDF, which is
FX(x) =
 0
if x ≤30,
(x −30)/30
if 30 ≤x ≤60,
1
if 60 ≤x.
Thus,
FY (y) = P

180
y
≤X

= 1 −FX

180
y

=







0
if y ≤180/60,
1 −
180
y
−30
30
if 180/60 ≤y ≤180/30,
1
if 180/30 ≤y,
=
 0
if y ≤3,
2 −(6/y)
if 3 ≤y ≤6,
1
if 6 ≤y,
(see Fig. 3.20). Diﬀerentiating this expression, we obtain the PDF of Y :
fY (y) =
 0
if y ≤3,
6/y2
if 3 ≤y ≤6,
0
if 6 ≤y.
Example 3.23.
Let Y = g(X) = X2, where X is a random variable with known
PDF. For any y ≥0, we have
FY (y) = P(Y ≤y)
= P(X2 ≤y)
= P(−√y ≤X ≤√y)
= FX(√y) −FX(−√y),
and therefore, by diﬀerentiating and using the chain rule,
fY (y) =
1
2√y fX(√y) +
1
2√y fX(−√y),
y ≥0.

42
General Random Variables
Chap. 3
x 
PDF fX(x)
30 
60
1
30
x 
CDF FX(x)
1
30 
60
y 
PDF fY(y)
3 
6
y
CDF FY(y)
1
3 
6
Figure 3.20: The calculation of the PDF of Y = 180/X in Example 3.22. The
arrows indicate the ﬂow of the calculation.
The Linear Case
An important case arises when Y is a linear function of X. See Fig. 3.21 for a
graphical interpretation.
The PDF of a Linear Function of a Random Variable
Let X be a continuous random variable with PDF fX, and let
Y = aX + b,
for some scalars a ̸= 0 and b. Then,
fY (y) = 1
|a|fX
y −b
a

.
To verify this formula, we use the two-step procedure. We only show the

Sec. 3.6
Derived Distributions
43
fX
faX
−1
2
faX+b
3
4
9
−2
Figure 3.21: The PDF of aX + b in terms of the PDF of X.
In this ﬁgure,
a = 2 and b = 5. As a ﬁrst step, we obtain the PDF of aX. The range of Y is
wider than the range of X, by a factor of a. Thus, the PDF fX must be stretched
(scaled horizontally) by this factor. But in order to keep the total area under the
PDF equal to 1, we need to scale the PDF (vertically) by the same factor a. The
random variable aX + b is the same as aX except that its values are shifted by
b. Accordingly, we take the PDF of aX and shift it (horizontally) by b. The end
result of these operations is the PDF of Y = aX + b and is given mathematically
by
fY (y) = 1
|a| fX
 y −b
a

.
If a were negative,
the procedure would be the same except that the
PDF of X would ﬁrst need to be reﬂected around the vertical axis (“ﬂipped”)
yielding f−X. Then a horizontal and vertical scaling (by a factor of |a| and 1/|a|,
respectively) yields the PDF of −|a|X = aX. Finally, a horizontal shift of b would
again yield the PDF of aX + b.
steps for the case where a > 0; the case a < 0 is similar. We have
FY (y) = P(Y ≤y)
= P(aX + b ≤y)
= P

X ≤y −b
a

= FX
y −b
a

.
We now diﬀerentiate this equality and use the chain rule, to obtain
fY (y) = dFY
dy (y) = 1
a · dFX
dx
y −b
a

= 1
a · fX
y −b
a

.
Example 3.24.
A linear function of an exponential random variable.
Suppose that X is an exponential random variable with PDF
fX(x) =

λe−λx
if x ≥0,
0
otherwise,

44
General Random Variables
Chap. 3
where λ is a positive parameter. Let Y = aX + b. Then,
fY (y) =
 λ
|a|e−λ(y−b)/a
if (y −b)/a ≥0,
0
otherwise.
Note that if b = 0 and a > 0, then Y is an exponential random variable with
parameter λ/a. In general, however, Y need not be exponential. For example, if
a < 0 and b = 0, then the range of Y is the negative real axis.
Example 3.25. A linear function of a normal random variable is normal.
Suppose that X is a normal random variable with mean µ and variance σ2, and let
Y = aX + b, where a and b are some scalars. We have
fX(x) =
1
√
2π σ
e−(x−µ)2/2σ2.
Therefore,
fY (y) = 1
|a|fX
y −b
a

= 1
|a|
1
√
2π σ
e−((y−b)/a)−µ)2/2σ2
=
1
√
2π |a|σ
e−(y−b−aµ)2/2a2σ2.
We recognize this as a normal PDF with mean aµ + b and variance a2σ2.
In
particular, Y is a normal random variable.
The Monotonic Case
The calculation and the formula for the linear case can be generalized to
the case where g is a monotonic function. Let X be a continuous random variable
and suppose that its range is contained in a certain interval I, in the sense that
fX(x) = 0 for x /∈I. We consider the random variable Y = g(X), and assume
that g is strictly monotonic over the interval I. That is, either
(a) g(x) < g(x′) for all x, x′ ∈I satisfying x < x′ (monotonically increasing
case), or
(b) g(x) > g(x′) for all x, x′ ∈I satisfying x < x′ (monotonically decreasing
case).
Furthermore, we assume that the function g is diﬀerentiable.
Its derivative
will necessarily be nonnegative in the increasing case and nonpositive in the
decreasing case.

Sec. 3.6
Derived Distributions
45
An important fact is that a monotonic function can be “inverted” in the
sense that there is some function h, called the inverse of g, such that for all
x ∈I, we have y = g(x) if and only if x = h(y). For example, the inverse of the
function g(x) = 180/x considered in Example 3.22 is h(y) = 180/y, because we
have y = 180/x if and only if x = 180/y. Other such examples of pairs of inverse
functions include
g(x) = ax + b,
h(y) = y −b
a
,
where a and b are scalars with a ̸= 0 (see Fig. 3.22), and
g(x) = eax,
h(y) = ln y
a ,
where a is a nonzero scalar.
0
h(y) = 
x
y
Slope a
b
0
g(x) = ax + b
x
y
b
Slope 1/a
y - b
a
0
x
y
0
g(x)  
x
y
h(y)  
y = g(x)  
x = h(y)  
Figure 3.22: A monotonically increasing function g (on the left) and its inverse
(on the right). Note that the graph of h has the same shape as the graph of g,
except that it is rotated by 90 degrees and then reﬂected (this is the same as
interchanging the x and y axes).
For monotonic functions g, the following is a convenient analytical formula
for the PDF of the function Y = g(X).

46
General Random Variables
Chap. 3
PDF Formula for a Monotonic Function of a Continuous Random
Variable
Suppose that g is monotonic and that for some function h and all x in the
range I of X we have
y = g(x)
if and only if
x = h(y).
Assume that h has ﬁrst derivative (dh/dy)(y). Then the PDF of Y in the
region where fY (y) > 0 is given by
fY (y) = fX

h(y)
 
dh
dy (y)
 .
For a veriﬁcation of the above formula, assume ﬁrst that g is monotonically
increasing. Then, we have
FY (y) = P

g(X) ≤y

= P

X ≤h(y)

= FX

h(y)

,
where the second equality can be justiﬁed using the monotonically increasing
property of g (see Fig. 3.23).
By diﬀerentiating this relation, using also the
chain rule, we obtain
fY (y) = dFY
dy (y) = fX

h(y)
dh
dy (y).
Because g is monotonically increasing, h is also monotonically increasing, so its
derivative is positive:
dh
dy (y) =

dh
dy (y)
 .
This justiﬁes the PDF formula for a monotonically increasing function g. The
justiﬁcation for the case of monotonically decreasing function is similar: we
diﬀerentiate instead the relation
FY (y) = P

g(X) ≤y

= P

X ≥h(y)

= 1 −FX

h(y)

,
and use the chain rule.
There is a similar formula involving the derivative of g, rather than the
derivative of h. To see this, diﬀerentiate the equality g

h(y)

= y, and use the
chain rule to obtain
dg
dh

h(y)

· dh
dy (y) = 1.

Sec. 3.6
Derived Distributions
47
Let us ﬁx some x and y that are related by g(x) = y, which is the same as
h(y) = x. Then,
dg
dx(x) · dh
dy (y) = 1,
which leads to
fY (y) = fX(x)
 
dg
dx(x)
 .
x
y= g(x)
y 
h(y )
x
y 
h(y )
Event {X < h(Y)}
Event {X  >h(Y)}
y= g(x)
Figure 3.23: Calculating the probability P
g(X) ≤y
. When g is monotonically
increasing (left ﬁgure), the event {g(X) ≤y} is the same as the event {X ≤h(y)}.
When g is monotonically decreasing (right ﬁgure), the event {g(X) ≤y} is the
same as the event {X ≥h(y)}.
Example 3.22.
(Continued)
To check the PDF formula, let us apply it to
the problem of Example 3.22.
In the region of interest, x ∈[30, 60], we have
h(y) = 180/y, and
dFX
dh

h(y)
= 1
30,

dh
dy (y)
 = 180
y2 .
Thus, in the region of interest y ∈[3, 6], the PDF formula yields
fY (y) = fX

h(y) 
dh
dy (y)
 = 1
30 · 180
y2 = 6
y2 ,
consistently with the expression obtained earlier.
Example 3.26. Let Y = g(X) = X2, where X is a continuous uniform random
variable in the interval (0, 1]. Within this interval, g is monotonic, and its inverse

48
General Random Variables
Chap. 3
is h(y) = √y. Thus, for any y ∈(0, 1], we have

dh
dy (y)
 =
1
2√y ,
fX(√y) = 1,
and
fY (y) =

1
2√y
if y ∈(0, 1],
0
otherwise.
We ﬁnally note that if we interpret PDFs in terms of probabilities of small
intervals, the content of our formulas becomes pretty intuitive; see Fig. 3.24.
Functions of Two Random Variables
The two-step procedure that ﬁrst calculates the CDF and then diﬀerentiates to
obtain the PDF also applies to functions of more than one random variable.
Example 3.27.
Two archers shoot at a target. The distance of each shot from
the center of the target is uniformly distributed from 0 to 1, independently of the
other shot. What is the PDF of the distance of the losing shot from the center?
Let X and Y be the distances from the center of the ﬁrst and second shots,
respectively. Let also Z be the distance of the losing shot:
Z = max{X, Y }.
We know that X and Y are uniformly distributed over [0, 1], so that for all z ∈[0, 1],
we have
P(X ≤z) = P(Y ≤z) = z.
Thus, using the independence of X and Y , we have for all z ∈[0, 1],
FZ(z) = P
max{X, Y } ≤z
= P(X ≤z, Y ≤z)
= P(X ≤z)P(Y ≤z)
= z2.
Diﬀerentiating, we obtain
fZ(z) =
 2z
if 0 ≤z ≤1,
0
otherwise.
Example 3.28.
Let X and Y be independent random variables that are uniformly
distributed on the interval [0, 1]. What is the PDF of the random variable Z =
Y/X?

Sec. 3.6
Derived Distributions
49
x
g(x)
y 
[x, x+δ1]
[y, y+δ2]
slope dg
dx (x)
Figure 3.24: Illustration of the PDF formula for a monotonically increasing
function g. Consider an interval [x, x + δ1], where δ1 is a small number. Under
the mapping g, the image of this interval is another interval [y, y + δ2]. Since
(dg/dx)(x) is the slope of g, we have
δ2
δ1
≈dg
dx(x),
or in terms of the inverse function,
δ1
δ2
≈dh
dy (y),
We now note that the event {x ≤X ≤x + δ1} is the same as the event {y ≤Y ≤
y + δ2}. Thus,
fY (y)δ2 ≈P(y ≤Y ≤y + δ2)
= P(x ≤X ≤x + δ1)
≈fX(x)δ1.
We move δ1 to the left-hand side and use our earlier formula for the ratio δ2/δ1,
to obtain
fY (y) dg
dx(x) = fX(x).
Alternatively, if we move δ2 to the right-hand side and use the formula for δ1/δ2,
we obtain
fY (y) = fX

h(y)
· dh
dy (y).
We will ﬁnd the PDF of Z by ﬁrst ﬁnding its CDF and then diﬀerentiating.
We consider separately the cases 0 ≤z ≤1 and z > 1. As shown in Fig. 3.25, we
have
FZ(z) = P
 Y
X ≤z

=
 z/2
if 0 ≤z ≤1,
1 −1/(2z)
if z > 1,
0
otherwise.

50
General Random Variables
Chap. 3
By diﬀerentiating, we obtain
fZ(z) =
 1/2
if 0 ≤z ≤1,
1/(2z2)
if z > 1,
0
otherwise.
z 
0
Slope z 
x 
y 
0
Slope z 
x 
y 
z 
1
1
1
1
1
Figure 3.25: The calculation of the CDF of Z = Y/X in Example 3.28. The
value P(Y/X ≤z) is equal to the shaded subarea of the unit square. The ﬁgure
on the left deals with the case where 0 ≤z ≤1 and the ﬁgure on the right refers
to the case where z > 1.
Example 3.29.
Romeo and Juliet have a date at a given time, and each, inde-
pendently, will be late by an amount of time that is exponentially distributed with
parameter λ. What is the PDF of the diﬀerence between their times of arrival?
Let us denote by X and Y the amounts by which Romeo and Juliet are late,
respectively. We want to ﬁnd the PDF of Z = X −Y , assuming that X and Y are
independent and exponentially distributed with parameter λ. We will ﬁrst calculate
the CDF FZ(z) by considering separately the cases z ≥0 and z < 0 (see Fig. 3.26).
For z ≥0, we have (see the left side of Fig. 3.26)
FZ(z) = P(X −Y ≤z)
= 1 −P(X −Y > z)
= 1 −
 ∞
0
 ∞
z+y
fX,Y (x, y) dx

dy
= 1 −
 ∞
0
λe−λy
 ∞
z+y
λe−λx dx

dy
= 1 −
 ∞
0
λe−λye−λ(z+y) dy
= 1 −e−λz
 ∞
0
λe−2λy dy
= 1 −1
2e−λz.

Sec. 3.7
Summary and Discussion
51
z 
0
z 
0
Line x - y = z 
Line x - y = z 
x 
y 
x 
y
Figure 3.26: The calculation of the CDF of Z = X −Y in Example 3.29. To
obtain the value P(X −Y > z) we must integrate the joint PDF fX,Y (x, y)
over the shaded area in the above ﬁgures, which correspond to z ≥0 (left
side) and z < 0 (right side).
For the case z < 0, we can use a similar calculation, but we can also argue
using symmetry. Indeed, the symmetry of the situation implies that the random
variables Z = X −Y and −Z = Y −X have the same distribution. We have
FZ(z) = P(Z ≤z) = P(−Z ≥−z) = P(Z ≥−z) = 1 −FZ(−z).
With z < 0, we have −z ≥0 and using the formula derived earlier,
FZ(z) = 1 −FZ(−z) = 1 −

1 −1
2e−λ(−z)
= 1
2eλz.
Combining the two cases z ≥0 and z < 0, we obtain
FZ(z) =



1 −1
2e−λz
if z ≥0,
1
2eλz
if z < 0,
We now calculate the PDF of Z by diﬀerentiating its CDF. We obtain
fZ(z) =









λ
2 e−λz
if z ≥0,
λ
2 eλz
if z < 0,
or
fZ(z) = λ
2 e−λ|z|.
This is known as a two-sided exponential PDF, also known as the Laplace
PDF.

52
General Random Variables
Chap. 3
3.7
SUMMARY AND DISCUSSION
Continuous random variables are characterized by PDFs and arise in many ap-
plications. PDFs are used to calculate event probabilities. This is similar to
the use of PMFs for the discrete case, except that now we need to integrate
instead of adding. Joint PDFs are similar to joint PMFs and are used to de-
termine the probability of events that are deﬁned in terms of multiple random
variables. Finally, conditional PDFs are similar to conditional PMFs and are
used to calculate conditional probabilities, given the value of the conditioning
random variable.
We have also introduced a few important continuous probability laws and
derived their mean and variance.
A summary is provided in the table that
follows.
Summary of Results for Special Random Variables
Continuous Uniform Over [a, b]:
fX(x) =

1
b −a
if a ≤x ≤b,
0
otherwise,
E[X] = a + b
2
,
var(X) = (b −a)2
12
.
Exponential with Parameter λ:
fX(x) =

λe−λx
if x ≥0,
0
otherwise,
FX(x) =

1 −e−λx
if x ≥0,
0
otherwise,
E[X] = 1
λ,
var(X) = 1
λ2 .
Normal with Parameters µ and σ2:
fX(x) =
1
√
2πσ e−(x−µ)2/2σ2,
E[X] = µ,
var(X) = σ2.

4
Further Topics
on Random Variables and Expectations
Contents
4.1. Transforms
. . . . . . . . . . . . . . . . . . . . . . . p. 2
4.2. Sums of Independent Random Variables - Convolutions
. . .
p. 13
4.3. Conditional Expectation as a Random Variable . . . . . . .
p. 17
4.4. Sum of a Random Number of Independent Random Variables
p. 25
4.5. Covariance and Correlation
. . . . . . . . . . . . . . .
p. 29
4.6. Least Squares Estimation
. . . . . . . . . . . . . . . .
p. 32
4.7. The Bivariate Normal Distribution
. . . . . . . . . . . .
p. 39
1

2
Further Topics on Random Variables and Expectations
Chap. 4
In this chapter, we develop a number of more advanced topics. We introduce
methods that are useful in:
(a) dealing with the sum of independent random variables, including the case
where the number of random variables is itself random;
(b) addressing problems of estimation or prediction of an unknown random
variable on the basis of observed values of other random variables.
With these goals in mind, we introduce a number of tools, including transforms
and convolutions, and reﬁne our understanding of the concept of conditional
expectation.
4.1
TRANSFORMS
In this section, we introduce the transform associated with a random variable.
The transform provides us with an alternative representation of its probability
law (PMF or PDF). It is not particularly intuitive, but it is often convenient for
certain types of mathematical manipulations.
The transform of the distribution of a random variable X (also referred
to as the moment generating function of X) is a function MX(s) of a free
parameter s, deﬁned by
MX(s) = E[esX].
The simpler notation M(s) can also be used whenever the underlying random
variable X is clear from the context. In more detail, when X is a discrete random
variable, the corresponding transform is given by
M(s) =

x
esxpX(x),
while in the continuous case, we have†
M(s) =
 ∞
−∞
esxfX(x) dx.
Example 4.1.
Let
pX(x) =
 1/2,
if x = 2,
1/6,
if x = 3,
1/3,
if x = 5.
† The reader who is familiar with Laplace transforms may recognize that the trans-
form associated with a continuous random variable is essentially the same as the Laplace
transform of its PDF, the only diﬀerence being that Laplace transforms usually involve
e−sx rather than esx. For the discrete case, a variable z is sometimes used in place
of es and the resulting transform M(z) = 
x zxpX(x) is known as the z-transform.
However, we will not be using z-transforms in this book.

Sec. 4.1
Transforms
3
Then, the corresponding transform is
M(s) = 1
2e2s + 1
6e3s + 1
3e5s
(see Fig. 4.1).
2
3
5
1
2
1
6
1
3
x
pX(x)
M(s)
s
0
1
(1/2) e2s
(1/6) e3s
(1/3) e5s
0
Figure 4.1: The PMF and the corresponding transform for Example 4.1. The
transform M(s) consists of the weighted sum of the three exponentials shown.
Note that at s = 0, the transform takes the value 1. This is generically true since
M(0) =

x
e0·xpX(x) =

x
pX(x) = 1.
Example 4.2. The Transform of a Poisson Random Variable.
Consider a
Poisson random variable X with parameter λ:
pX(x) = λxe−λ
x!
,
x = 0, 1, 2, . . .
The corresponding transform is given by
M(s) =
∞

x=0
esx λxe−λ
x!
.

4
Further Topics on Random Variables and Expectations
Chap. 4
We let a = esλ and obtain
M(s) = e−λ
∞

x=0
ax
x! = e−λea = ea−λ = eλ(es−1).
Example 4.3. The Transform of an Exponential Random Variable.
Let
X be an exponential random variable with parameter λ:
fX(x) = λe−λx,
x ≥0.
Then,
M(s) =λ
 ∞
0
esxe−λx dx
=λ
 ∞
0
e(s−λ)x dx
=λ e(s−λ)x
s −λ

∞
0
(if s < λ)
=
λ
λ −s.
The above calculation and the formula for M(s) is correct only if the integrand
e(s−λ)x decays as x increases, which is the case if and only if s < λ; otherwise, the
integral is inﬁnite.
It is important to realize that the transform is not a number but rather a
function of a free variable or parameter s. Thus, we are dealing with a transfor-
mation that starts with a function, e.g., a PDF fX(x) (which is a function of a
free variable x) and results in a new function, this time of a real parameter s.
Strictly speaking, M(s) is only deﬁned for those values of s for which E[esX] is
ﬁnite, as noted in the preceding example.
Example 4.4. The Transform of a Linear Function of a Random Variable.
Let MX(s) be the transform associated with a random variable X. Consider a new
random variable Y = aX + b. We then have
MY (s) = E[es(aX+b)] = esbE[esaX] = esbMX(sa).
For example, if X is exponential with parameter λ = 1, so that MX(s) = 1/(1 −s),
and if Y = 2X + 3, then
MY (s) = e3s
1
1 −2s.

Sec. 4.1
Transforms
5
Example 4.5.
The Transform of a Normal Random Variable.
Let X
be a normal random variable with mean µ and variance σ2.
To calculate the
corresponding transform, we ﬁrst consider the special case of the standard normal
random variable Y , where µ = 0 and σ2 = 1, and then use the formula of the
preceding example.
The PDF of the standard normal is
fY (y) =
1
√
2π
e−y2/2,
and its transform is
MY (s) =
 ∞
−∞
1
√
2π
e−y2/2 esy dy
=
1
√
2π
 ∞
−∞
e−(y2/2)+sydy
= es2/2
1
√
2π
 ∞
−∞
e−(y2/2)+sy−(s2/2)dy
= es2/2
1
√
2π
 ∞
−∞
e−(y−s)2/2dy
= es2/2,
where the last equality follows by using the normalization property of a normal
PDF with mean s and unit variance.
A general normal random variable with mean µ and variance σ2 is obtained
from the standard normal via the linear transformation
X = σY + µ.
The transform of the standard normal is MY (s) = es2/2, as veriﬁed above. By
applying the formula of Example 4.4, we obtain
MX(s) = esµMY (sσ) = e
σ2s2
2
+µs.
From Transforms to Moments
The reason behind the alternative name “moment generating function” is that
the moments of a random variable are easily computed once a formula for the
associated transform is available. To see this, let us take the derivative of both
sides of the deﬁnition
M(s) =
 ∞
−∞
esxfX(x) dx,

6
Further Topics on Random Variables and Expectations
Chap. 4
with respect to s. We obtain
d
dsM(s) = d
ds
 ∞
−∞
esxfX(x) dx
=
 ∞
−∞
d
dsesxfX(x) dx
=
 ∞
−∞
xesxfX(x) dx.
This equality holds for all values of s. By considering the special case where
s = 0, we obtain†
d
dsM(s)

s=0
=
 ∞
−∞
xfX(x) dx = E[X].
More generally, if we diﬀerentiate n times the function M(s) with respect to s,
a similar calculation yields
dn
dsn M(s)

s=0
=
 ∞
−∞
xnfX(x) dx = E[Xn].
Example 4.6.
We saw earlier (Example 4.1) that the PMF
pX(x) =
 1/2,
if x = 2,
1/6,
if x = 3,
1/3,
if x = 5,
has the transform
M(s) = 1
2e2s + 1
6e3s + 1
3e5s.
Thus,
E[X] = d
dsM(s)

s=0
= 1
22e2s + 1
63e3s + 1
35e5s
s=0
= 1
2 · 2 + 1
6 · 3 + 1
3 · 5
= 19
6 .
† This derivation involves an interchange of diﬀerentiation and integration. The
interchange turns out to be justiﬁed for all of the applications to be considered in
this book.
Furthermore, the derivation remains valid for general random variables,
including discrete ones. In fact, it could be carried out more abstractly, in the form
d
dsM(s) = d
dsE[esX] = E
 d
dsesX
= E[XesX],
leading to the same conclusion.

Sec. 4.1
Transforms
7
Also,
E[X2] = d2
ds2 M(s)

s=0
= 1
24e2s + 1
69e3s + 1
325e5s
s=0
= 1
2 · 4 + 1
6 · 9 + 1
3 · 25
= 71
6 .
For an exponential random variable with PDF
fX(x) = λe−λx,
x ≥0,
we found earlier that
M(s) =
λ
λ −s.
Thus,
d
dsM(s) =
λ
(λ −s)2 ,
d2
ds2 M(s) =
2λ
(λ −s)3 .
By setting s = 0, we obtain
E[X] = 1
λ,
E[X2] = 2
λ2 ,
which agrees with the formulas derived in Chapter 3.
Inversion of Transforms
A very important property of transforms is the following.
Inversion Property
The transform MX(s) completely determines the probability law of the ran-
dom variable X. In particular, if MX(s) = MY (s) for all s, then the random
variables X and Y have the same probability law.
This property is a rather deep mathematical fact that we will use fre-
quently.†
There exist explicit formulas that allow us to recover the PMF or
PDF of a random variable starting from the associated transform, but they are
quite diﬃcult to use. In practice, transforms are usually inverted by “pattern
matching,” based on tables of known distribution-transform pairs. We will see
a number of such examples shortly.
† In fact, the probability law of a random variable is completely determined even
if we only know the transform M(s) for values of s in some interval of positive length.

8
Further Topics on Random Variables and Expectations
Chap. 4
Example 4.7.
We are told that the transform associated with a random variable
X is
M(s) = 1
4e−s + 1
2 + 1
8e4s + 1
8e5s.
Since M(s) is a sum of terms of the form esx, we can compare with the general
formula
M(s) =

x
esxpX(x),
and infer that X is a discrete random variable. The diﬀerent values that X can
take can be read from the corresponding exponents and are −1, 0, 4, and 5. The
probability of each value x is given by the coeﬃcient multiplying the corresponding
esx term. In our case, P(X = −1) = 1/4, P(X = 0) = 1/2, P(X = 4) = 1/8,
P(X = 5) = 1/8.
Generalizing from the last example, the distribution of a ﬁnite-valued dis-
crete random variable can be always found by inspection of the corresponding
transform. The same procedure also works for discrete random variables with
an inﬁnite range, as in the example that follows.
Example 4.8. The Transform of a Geometric Random Variable.
We are
told that the transform associated with random variable X is of the form
M(s) =
pes
1 −(1 −p)es ,
where p is a constant in the range 0 < p < 1. We wish to ﬁnd the distribution of
X. We recall the formula for the geometric series:
1
1 −α = 1 + α + α2 + · · · ,
which is valid whenever |α| < 1. We use this formula with α = (1 −p)es, and for s
suﬃciently close to zero so that (1 −p)es < 1. We obtain
M(s) = pes
1 + (1 −p)es + (1 −p)2e2s + (1 −p)3e3s + · · ·
	
.
As in the previous example, we infer that this is a discrete random variable that
takes positive integer values. The probability P(X = k) is found by reading the
coeﬃcient of the term eks. In particular, P(X = 1) = p, P(X = 2) = p(1 −p), etc.,
and
P(X = k) = p(1 −p)k−1,
k = 1, 2, . . .
We recognize this as the geometric distribution with parameter p.
Note that
d
dsM(s) =
pes
1 −(1 −p)es +
(1 −p)pes
(1 −(1 −p)es)2 .

Sec. 4.1
Transforms
9
If we set s = 0, the above expression evaluates to 1/p, which agrees with the formula
for E[X] derived in Chapter 2.
Example 4.9.
The Transform of a Mixture of Two Distributions.
The
neighborhood bank has three tellers, two of them fast, one slow. The time to assist
a customer is exponentially distributed with parameter λ = 6 at the fast tellers,
and λ = 4 at the slow teller. Jane enters the bank and chooses a teller at random,
each one with probability 1/3. Find the PDF of the time it takes to assist Jane and
its transform.
We have
fX(x) = 2
3 · 6e−6x + 1
3 · 4e−4x,
x ≥0.
Then,
M(s) =
 ∞
0
esx 2
36e−6x + 1
34e−4x	
dx
= 2
3
 ∞
0
esx6e−6x dx + 1
3
 ∞
0
esx4e−4x dx
= 2
3 ·
6
6 −s + 1
3 ·
4
4 −s
(for s < 4).
More generally, let X1, . . . , Xn be continuous random variables with PDFs
fX1, . . . fXn, and let Y be a random variable, which is equal to Xi with probability
pi.
Then,
fY (y) = p1fX1(y) + · · · + pnfXn(y),
and
MY (s) = p1MX1(s) + · · · + pnMXn(s).
The steps in this problem can be reversed. For example, we may be told that
the transform associated with a random variable Y is of the form
1
2 ·
1
2 −s + 3
4 ·
1
1 −s.
We can then rewrite it as
1
4 ·
2
2 −s + 3
4 ·
1
1 −s,
and recognize that Y is the mixture of two exponential random variables with
parameters 2 and 1, which are selected with probabilities 1/4 and 3/4, respectively.

10
Further Topics on Random Variables and Expectations
Chap. 4
Sums of Independent Random Variables
Transform methods are particularly convenient when dealing with a sum of ran-
dom variables. This is because it turns out that addition of independent random
variables corresponds to multiplication of transforms, as we now show.
Let X and Y be independent random variables, and let W = X + Y . The
transform associated with W is, by deﬁnition,
MW (s) = E[esW ] = E[es(X+Y )] = E[esXesY ].
Consider a ﬁxed value of the parameter s. Since X and Y are independent,
esX and esY are independent random variables. Hence, the expectation of their
product is the product of the expectations, and
MW (s) = E[esX]E[esY ] = MX(s)MY (s).
By the same argument, if X1, . . . , Xn is a collection of independent random
variables, and
W = X1 + · · · + Xn,
then
MW (s) = MX1(s) · · · MXn(s).
Example 4.10.
The Transform of the Binomial.
Let X1, . . . , Xn be inde-
pendent Bernoulli random variables with a common parameter p. Then,
MXi(s) = (1 −p)e0s + pe1s = 1 −p + pes,
for all i.
The random variable Y = X1 + · · · + Xn is binomial with parameters n and p. Its
transform is given by
MY (s) = 
1 −p + pesn.
Example 4.11.
The Sum of Independent Poisson Random Variables is
Poisson.
Let X and Y be independent Poisson random variables with means λ
and µ, respectively, and let W = X + Y . Then,
MX(s) = eλ(es−1),
MY (s) = eµ(es−1),
and
MW (s) = MX(s)MY (s) = eλ(es−1)eµ(es−1) = e(λ+µ)(es−1).
Thus, W has the same transform as a Poisson random variable with mean λ + µ.
By the uniqueness property of transforms, W is Poisson with mean λ + µ.

Sec. 4.1
Transforms
11
Example 4.12.
The Sum of Independent Normal Random Variables is
Normal.
Let X and Y be independent normal random variables with means µx,
µy, and variances σ2
x, σ2
y, respectively. Let W = X + Y . Then,
MX(s) = e
σ2xs2
2
+µxs,
MY (s) = e
σ2ys2
2
+µys,
and
MW (s) = e
(σ2x+σ2y)s2
2
+(µx+µy)s.
Thus, W has the same transform as a normal random variable with mean µx + µy
and variance σ2
x + σ2
y. By the uniqueness property of transforms, W is normal with
these parameters.
Summary of Transforms and their Properties
• The transform associated with the distribution of a random variable
X is given by
MX(s) = E[esX] =








x
esxpX(x),
x discrete,
 ∞
−∞
esxfX(x) dx,
x continuous.
• The distribution of a random variable is completely determined by the
corresponding transform.
• Moment generating properties:
MX(0) = 1,
d
dsMX(s)

s=0
= E[X],
dn
dsn MX(s)

s=0
= E[Xn].
• If Y = aX + b, then MY (s) = esbMX(as).
• If X and Y are independent, then MX+Y (s) = MX(s)MY (s).
We have derived formulas for the transforms of a few common random
variables. Such formulas can be derived with a moderate amount of algebra for
many other distributions. Some of the most useful ones are summarized in the
tables that follow.
Transforms of Joint Distributions
If two random variables X and Y are described by some joint distribution (e.g., a
joint PDF), then each one is associated with a transform MX(s) or MY (s). These

12
Further Topics on Random Variables and Expectations
Chap. 4
Transforms for Common Discrete Random Variables
Bernoulli(p)
pX(k) =

p,
if k = 1,
1 −p,
if k = 0.
MX(s) = 1 −p + pes.
Binomial(n, p)
pX(k) =
n
k

pk(1 −p)n−k,
k = 0, 1, . . . , n.
MX(s) = (1 −p + pes)n.
Geometric(p)
pX(k) = p(1 −p)k−1,
k = 1, 2, . . .
MX(s) =
pes
1 −(1 −p)es .
Poisson(λ)
pX(k) = e−λλk
k!
,
k = 0, 1, . . .
MX(s) = eλ(es−1).
Uniform(a, b)
pX(k) =
1
b −a + 1,
k = a, a + 1, . . . , b.
MX(s) =
eas
b −a + 1
e(b−a+1)s −1
es −1
.
are the transforms of the marginal distributions and do not convey information on
the dependence between the two random variables. Such information is contained
in a multivariate transform, which we now deﬁne.
Consider n random variables X1, . . . , Xn related to the same experiment.
Let s1, . . . , sn be scalar free parameters. The associated multivariate transform
is a function of these n parameters and is deﬁned by
MX1,...,Xn(s1, . . . , sn) = E

esX1+···+snXn
.
The inversion property of transforms discussed earlier extends to the multi-
variate case.
That is, if Y1, . . . , Yn is another set of random variables and
MX1,...,Xn(s1, . . . , sn), MY1,...,Yn(s1, . . . , sn) are the same functions of s1, . . . , sn,

Sec. 4.2
Sums of Independent Random Variables — Convolutions
13
Transforms for Common Continuous Random Variables
Uniform(a, b)
fX(x) =
1
b −a,
a ≤x ≤b.
MX(s) =
1
b −a
esb −esa
s
.
Exponential(λ)
fX(x) = λe−λx,
x ≥0.
MX(s) =
λ
λ −s,
(s > λ).
Normal(µ, σ2)
fX(x) =
1
σ
√
2π e−(x−µ)2/2σ2,
−∞< x < ∞.
MX(s) = e
σ2s2
2
+µs.
then the joint distribution of X1, . . . , Xn is the same as the joint distribution of
Y1, . . . , Yn.
4.2
SUMS OF INDEPENDENT RANDOM VARIABLES
— CONVOLUTIONS
If X and Y are independent random variables, the distribution of their sum
W = X + Y can be obtained by computing and then inverting the transform
MW (s) = MX(s)MY (s). But it can also be obtained directly, using the method
developed in this section.
The Discrete Case
Let W = X+Y , where X and Y are independent integer-valued random variables
with PMFs pX(x) and pY (y). Then, for any integer w,
pW (w) =P(X + Y = w)
=

(x,y): x+y=w
P(X = x and Y = y)
=

x
P(X = x and Y = w −x)
=

x
pX(x)pY (w −x).

14
Further Topics on Random Variables and Expectations
Chap. 4
x
y
. . . . .
.
(3,0)
(2,1)
(1,2)
(0,3)
Figure 4.2: The probability pW (3) that X+Y = 3 is the sum of the probabilities
of all pairs (x, y) such that x + y = 3, which are the points indicated in the
ﬁgure. The probability of a generic such point is of the form pX,Y (x, 3 −x) =
pX(x)pY (3 −x).
The resulting PMF pW (w) is called the convolution of the PMFs of X and Y .
See Fig. 4.2 for an illustration.
Example 4.13.
Let X and Y be independent and have PMFs given by
pX(x) =

1
3
if x = 1, 2, 3,
0
otherwise,
pY (y) =





1
2
if x = 0,
1
3
if x = 1,
1
6
if x = 2,
0
otherwise.
To calculate the PMF of W = X + Y by convolution, we ﬁrst note that the range
of possible values of w are the integers from the range [1, 5]. Thus we have
pW (w) = 0
if w ̸= 1, 2, 3, 4, 5.
We calculate pW (w) for each of the values w = 1, 2, 3, 4, 5 using the convolution
formula. We have
pW (1) =

x
pX(x)pY (1 −x) = pX(1) · pY (0) = 1
3 · 1
2 = 1
6,
where the second equality above is based on the fact that for x ̸= 1 either pX(x) or
pY (1 −x) (or both) is zero. Similarly, we obtain
pW (2) = pX(1) · pY (1) + pX(2) · pY (0) = 1
3 · 1
3 + 1
3 · 1
2 = 5
18,
pW (3) = pX(1) · pY (2) + pX(2) · pY (1) + pX(3) · pY (0) = 1
3 · 1
6 + 1
3 · 1
3 + 1
3 · 1
2 = 1
3,
pW (4) = pX(2) · pY (2) + pX(3) · pY (1) = 1
3 · 1
6 + 1
3 · 1
3 = 1
6,
pW (5) = pX(3) · pY (2) = 1
3 · 1
6 = 1
18.

Sec. 4.2
Sums of Independent Random Variables — Convolutions
15
The Continuous Case
Let X and Y be independent continuous random variables with PDFs fX(x) and
fY (y). We wish to ﬁnd the PDF of W = X + Y . Since W is a function of two
random variables X and Y , we can follow the method of Chapter 3, and start
by deriving the CDF FW (w) of W. We have
FW (w) = P(W ≤w)
= P(X + Y ≤w)
=
 ∞
x=−∞
 w−x
y=−∞
fX(x)fY (y) dy dx
=
 ∞
x=−∞
fX(x)
 w−x
y=−∞
fY (y) dy

dx
=
 ∞
x=−∞
fX(x)FY (w −x) dx.
The PDF of W is then obtained by diﬀerentiating the CDF:
fW (w) = dFW
dw (w)
= d
dw
 ∞
x=−∞
fX(x)FY (w −x) dx
=
 ∞
x=−∞
fX(x)dFY
dw (w −x) dx
=
 ∞
x=−∞
fX(x)fY (w −x) dx.
This formula is entirely analogous to the formula for the discrete case, except
that the summation is replaced by an integral and the PMFs are replaced by
PDFs. For an intuitive understanding of this formula, see Fig. 4.3.
Example 4.14.
The random variables X and Y are independent and uniformly
distributed in the interval [0, 1]. The PDF of W = X + Y is
fW (w) =
 ∞
−∞
fX(x)fY (w −x) dx.
The integrand fX(x)fY (w −x) is nonzero (and equal to 1) for 0 ≤x ≤1 and
0 ≤w −x ≤1. Combining these two inequalities, the integrand is nonzero for
max{0, w −1} ≤x ≤min{1, w}. Thus,
fW (w) =
 min{1, w} −max{0, w −1},
0 ≤w ≤2,
0,
otherwise,

16
Further Topics on Random Variables and Expectations
Chap. 4
x 
y 
x + y = w
w 
w 
x + y = w + δ
w + δ
Figure 4.3: Illustration of the convolution formula for the case of continuous
random variables (compare with Fig. 4.2).
For small δ, the probability of the
strip indicated in the ﬁgure is P(w ≤X + Y ≤w + δ) ≈fW (w) · δ. Thus,
fW (w) · δ =P(w ≤X + Y ≤w + δ)
=
 ∞
x=−∞
 w−x+δ
y=w−x
fX(x)fY (y) dy dx
≈
 ∞
x=−∞
fX(x)fY (w −x)δ dx.
The desired formula follows by canceling δ from both sides.
w 
fW(w)
2
1
Figure 4.4: The PDF of the sum of two independent uniform random variables
in [0, 1].
which has the triangular shape shown in Fig. 4.4.
The calculation in the last example was based on a literal application of the
convolution formula. The most delicate step was to determine the correct limits
for the integration. This is often tedious and error prone, but can be bypassed
using a graphical method described next.

Sec. 4.3
Conditional Expectation as a Random Variable
17
Graphical Calculation of Convolutions
We will use a dummy variable t as the argument of the diﬀerent functions in-
volved in this discussion; see also Fig. 4.5. Consider a PDF fX(t) which is zero
outside the range a ≤t ≤b and a PDF fY (t) which is zero outside the range
c ≤t ≤d. Let us ﬁx a value w, and plot fY (w −t) as a function of t. This plot
has the same shape as the plot of fY (t) except that it is ﬁrst “ﬂipped” and then
shifted by an amount w. (If w > 0, this is a shift to the right, if w < 0, this is a
shift to the left.) We then place the plots of fX(t) and fY (w −t) on top of each
other. The value of fW (w) is equal to the integral of the product of these two
plots. By varying the amount w by which we are shifting, we obtain fW (w) for
any w.
w  − c
w  − d
a
b
fX(t)
c
d
fY(t)
− c
− d
a
b
fY(w − t)
fY(− t)
t 
t 
t 
t 
t 
fY(w − t)fX(t)
Figure 4.5: Illustration of the convolution calculation. For the value of w under
consideration, fW (w) is equal to the integral of the function shown in the last
plot.
4.3
CONDITIONAL EXPECTATION AS A RANDOM VARIABLE
The value of the conditional expectation E[X | Y = y] of a random variable X
given another random variable Y depends on the realized experimental value y
of Y . This makes E[X | Y ] a function of Y , and therefore a random variable. In
this section, we study the expectation and variance of E[X | Y ]. In the process,

18
Further Topics on Random Variables and Expectations
Chap. 4
we obtain some useful formulas (the law of iterated expectations and the
law of conditional variances) that are often convenient for the calculation of
expected values and variances.
Recall that the conditional expectation E[X | Y = y] is deﬁned by
E[X | Y = y] =

x
xpX|Y (x | y),
(discrete case),
and
E[X | Y = y] =
 ∞
−∞
xfX|Y (x | y) dx,
(continuous case).
Once a value of y is given, the above summation or integration yields a numerical
value for E[X | Y = y].
Example 4.15.
Let the random variables X and Y have a joint PDF which
is equal to 2 for (x, y) belonging to the triangle indicated in Fig. 4.6(a), and zero
everywhere else. In order to compute E[X | Y = y], we ﬁrst need to obtain the
conditional density of X given Y = y.
x 
y 
1
1
fX,Y(x ,y) = 2
x 
1
fX|Y(x |y )
1 − y 
1 − y 
1
(a)
(b)
1 − y 
y 
Figure 4.6: (a) The joint PDF in Example 4.15. (b) The conditional density
of X.
We have
fY (y) =
 ∞
−∞
fX,Y (x, y) dx =
 1−y
0
2 dx = 2(1 −y),
0 ≤y ≤1,
and
fX|Y (x | y) = fX,Y (x, y)
fY (y)
=
1
1 −y ,
0 ≤x ≤1 −y.
The conditional density is shown in Fig. 4.6(b).

Sec. 4.3
Conditional Expectation as a Random Variable
19
Intuitively, since the joint PDF is constant, the conditional PDF (which is a
“slice” of the joint, at some ﬁxed y) is also a constant. Therefore, the conditional
PDF must be a uniform distribution. Given that Y = y, X ranges from 0 to 1 −y.
Therefore, for the PDF to integrate to 1, its height must be equal to 1/(1 −y), in
agreement with Fig. 4.6(b).
For y > 1 or y < 0, the conditional PDF is undeﬁned, since these values of
y are impossible. For y = 1, X must be equal to 0, with certainty, and E[X | Y =
1] = 0.
For 0 ≤y < 1, the conditional mean E[X | Y = y] is the expectation of the
uniform PDF in Fig. 4.6(b), and we have
E[X | Y = y] = 1 −y
2
,
0 ≤y < 1.
Since E[X | Y = 1] = 0, the above formula is also valid when y = 1. The conditional
expectation is undeﬁned when y is outside [0, 1].
For any number y, E[X | Y = y] is also a number. As y varies, so does
E[X | Y = y], and we can therefore view E[X | Y = y] as a function of y. Since
y is the experimental value of the random variable Y , we are dealing with a
function of a random variable, hence a new random variable. More precisely, we
deﬁne E[X | Y ] to be the random variable whose value is E[X | Y = y] when the
outcome of Y is y.
Example 4.15.
(continued)
We saw that E[X | Y = y] = (1 −y)/2. Hence,
E[X | Y ] is the random variable (1 −Y )/2:
E[X | Y ] = 1 −Y
2
.
Since E[X | Y ] is a random variable, it has an expectation E

E[X | Y ]

of
its own. Applying the expected value rule, this is given by
E

E[X | Y ]

=








y
E[X | Y = y]pY (y),
Y discrete,
 ∞
−∞
E[X | Y = y]fY (y) dy,
Y continuous.
Both expressions in the right-hand side should be familiar from Chapters 2 and
3, respectively. By the corresponding versions of the total expectation theorem,
they are equal to E[X]. This brings us to the following conclusion, which is
actually valid for every type of random variable Y (discrete, continuous, mixed,
etc.), as long as X has a well-deﬁned and ﬁnite expectation E[X].
Law of iterated expectations:
E

E[X | Y ]

= E[X].

20
Further Topics on Random Variables and Expectations
Chap. 4
Example 4.15
(continued) In Example 4.15, we found E[X | Y ] = (1 −Y )/2
[see Fig. 4.6(b)]. Taking expectations of both sides, and using the law of iterated
expectations to evaluate the left-hand side, we obtain E[X] = 
1−E[Y ]
/2. Because
of symmetry, we must have E[X] = E[Y ]. Therefore, E[X] = 
1 −E[X]
/2, which
yields E[X] = 1/3. In a slightly diﬀerent version of this example, where there is no
symmetry between X and Y , we would use a similar argument to express E[Y ].
Example 4.16.
We start with a stick of length ℓ. We break it at a point which
is chosen randomly and uniformly over its length, and keep the piece that contains
the left end of the stick. We then repeat the same process on the stick that we
were left with. What is the expected length of the stick that we are left with, after
breaking twice?
Let Y be the length of the stick after we break for the ﬁrst time. Let X be
the length after the second time. We have E[X | Y ] = Y/2, since the breakpoint is
chosen uniformly over the length Y of the remaining stick. For a similar reason, we
also have E[Y ] = ℓ/2. Thus,
E[X] = E
E[X | Y ]
= E
Y
2

= E[Y ]
2
= ℓ
4.
Example 4.17.
Averaging Quiz Scores by Section.
A class has n students
and the quiz score of student i is xi. The average quiz score is
m = 1
n
n

i=1
xi.
The class consists of S sections, with ns students in section s. The average score
in section s is
ms = 1
ns

stdnts. i in sec. s
xi.
The average score over the whole class can be computed by taking the average score
ms of each section, and then forming a weighted average; the weight given to section
s is proportional to the number of students in that section, and is ns/n. We verify
that this gives the correct result:
S

s=1
ns
n ms =
S

s=1
ns
n · 1
ns

stdnts. i in sec. s
xi
= 1
n
S

s=1

stdnts. i in sec. s
xi
= 1
n
n

i=1
xi.
= m.

Sec. 4.3
Conditional Expectation as a Random Variable
21
How is this related to conditional expectations? Consider an experiment in
which a student is selected at random, each student having probability 1/n of being
selected. Consider the following two random variables:
X = quiz score of a student,
Y = section of a student, (Y ∈{1, . . . , S}).
We then have
E[X] = m.
Conditioning on Y = s is the same as assuming that the selected student is
in section s. Conditional on that event, every student in that section has the same
probability 1/ns of being chosen. Therefore,
E[X | Y = s] = 1
ns

stdnts. i in sec. s
xi = ms.
A randomly selected student belongs to section s with probability ns/n, i.e., P(Y =
s) = ns/n. Hence,
E
E[X | Y ]
=
S

s=1
E[X | Y = s]P(Y = s) =
S

s=1
ns
n ms.
As shown earlier, this is the same as m. Thus, averaging by section can be viewed
as a special case of the law of iterated expectations.
Example 4.18.
Forecast Revisions.
Let Y be the sales of a company in the
ﬁrst semester of the coming year, and let X be the sales over the entire year. The
company has constructed a statistical model of sales, and so the joint distribution of
X and Y is assumed to be known. In the beginning of the year, the expected value
E[X] serves as a forecast of the actual sales X. In the middle of the year, the ﬁrst
semester sales have been realized and the experimental value of the random value Y
is now known. This places us in a new “universe,” where everything is conditioned
on the realized value of Y . We then consider the mid-year revised forecast of yearly
sales, which is E[X | Y ].
We view E[X | Y ] −E[X] as the forecast revision, in light of the mid-year
information. The law of iterated expectations implies that
E
E[X | Y ] −E[X]
= 0.
This means that, in the beginning of the year, we do not expect our forecast to
be revised in any speciﬁc direction. Of course, the actual revision will usually be
positive or negative, but the probabilities are such that it is zero on the average.
This is quite intuitive. For example, if a positive revision was expected, the original
forecast should have been higher in the ﬁrst place.

22
Further Topics on Random Variables and Expectations
Chap. 4
The Conditional Variance
The conditional distribution of X given Y = y has a mean, which is E[X | Y = y],
and by the same token, it also has a variance. This is deﬁned by the same formula
as the unconditional variance, except that everything is conditioned on Y = y:
var(X | Y = y) = E

X −E[X | Y = y]
2  Y = y

.
Note that the conditional variance is a function of the experimental value y of
the random variable Y . Hence, it is a function of a random variable, and is itself
a random variable that will be denoted by var(X | Y ).
Arguing by analogy to the law of iterated expectations, we may conjecture
that the expectation of the conditional variance var(X | Y ) is related to the
unconditional variance var(X). This is indeed the case, but the relation is more
complex.
Law of Conditional Variances:
var(X) = E

var(X | Y )

+ var

E[X | Y ]

To verify the law of conditional variances, we start with the identity
X −E[X] =

X −E[X | Y ]

+

E[X | Y ] −E[X]

.
We square both sides and then take expectations to obtain
var(X) = E

X −E[X]
2
= E

X −E[X | Y ]
2
+ E

E[X | Y ] −E[X]
2
+ 2E

X −E[X | Y ]

E[X | Y ] −E[X]

.
Using the law of iterated expectations, the ﬁrst term in the right-hand side of
the above equation can be written as
E

E

X −E[X | Y ]
2  Y
 
,
which is the same as E

var(X | Y )

. The second term is equal to var

E[X | Y ]

,
since E[X] is the mean of E[X | Y ]. Finally, the third term is zero, as we now
show. Indeed, if we deﬁne h(Y ) = 2

E[X | Y ] −E[X]

, the third term is
E

X −E[X | Y ]

h(Y )

= E

Xh(Y )

−E

E[X | Y ]h(Y )

= E

Xh(Y )

−E

E

Xh(Y ) | Y

= E

Xh(Y )

−E

Xh(Y )

= 0.

Sec. 4.3
Conditional Expectation as a Random Variable
23
Example 4.16. (continued) Consider again the problem where we break twice
a stick of length ℓ, at randomly chosen points, with Y being the length of the stick
after the ﬁrst break and X being the length after the second break. We calculated
the mean of X as ℓ/4, and now let us use the law of conditional variances to calculate
var(X). We have E[X | Y ] = Y/2, so since Y is uniformly distributed between 0
and ℓ,
var
E[X | Y ]
= var(Y/2) = 1
4var(Y ) = 1
4 · ℓ2
12 = ℓ2
48.
Also, since X is uniformly distributed between 0 and Y , we have
var(X | Y ) = Y 2
12 .
Thus, since Y is uniformly distributed between 0 and ℓ,
E
var(X | Y )
= 1
12
 ℓ
0
1
ℓy2dy = 1
12
1
3ℓy3ℓ
0 = ℓ2
36.
Using now the law of conditional variances, we obtain
var(X) = E
var(X | Y )
+ var
E[X | Y ]
= ℓ2
48 + ℓ2
36 = 7ℓ2
144.
Example 4.19. Averaging Quiz Scores by Section – Variance.
The setting
is the same as in Example 4.17 and we consider the random variables
X = quiz score of a student,
Y = section of a student,
(Y ∈{1, . . . , S}).
Let ns be the number of students in section s, and let n be the total number of
students. We interpret the diﬀerent quantities in the formula
var(X) = E
var(X | Y )
+ var
E[X | Y ]
.
In this context, var(X | Y = s) is the variance of the quiz scores within sec-
tion s. Then, E
var(X | Y )
is the average of the section variances. This latter
expectation is an average over the probability distribution of Y , i.e.,
E
var(X | Y )
=
S

s=1
ns
n var(X | Y = s).
Recall that E[X | Y = s] is the average score in section s. Then, var
E[X | Y ]
is a measure of the variability of the averages of the diﬀerent sections. The law of
conditional variances states that the total quiz score variance can be broken into
two parts:

24
Further Topics on Random Variables and Expectations
Chap. 4
(a) The average score variability E
var(X | Y )
within individual sections.
(b) The variability var
E[X | Y ]
between sections.
We have seen earlier that the law of iterated expectations (in the form of the
total expectation theorem) can be used to break down complicated expectation
calculations, by considering diﬀerent cases. A similar method applies to variance
calculations.
Example 4.20.
Computing Variances by Conditioning.
Consider a con-
tinuous random variable X with the PDF given in Fig. 4.7. We deﬁne an auxiliary
random variable Y as follows:
Y =
 1,
if x < 1,
2,
of x ≥1.
Here, E[X | Y ] takes the values 1/2 and 3/2, with probabilities 1/3 and 2/3, respec-
tively. Thus, the mean of E[X | Y ] is 7/6. Therefore,
var
E[X | Y ]
= 1
3
1
2 −7
6
	2
+ 2
3
3
2 −7
6
	2
= 2
9.
x 
1
fX(x )
2
1/3
2/3
Figure 4.7: The PDF in Example 4.20.
Conditioned on either value of Y , X is uniformly distributed on a unit length
interval. Therefore, var(X | Y = y) = 1/12 for each of the two possible values of y,
and E
var(X | Y )
= 1/12. Putting everything together, we obtain
var(X) = E
var(X | Y )
+ var
E[X | Y ]
= 1
12 + 2
9 = 11
36.

Sec. 4.4
Sum of a Random Number of Independent Random Variables
25
We summarize the main points in this section.
The Mean and Variance of a Conditional Expectation
• E[X | Y = y] is a number, whose value depends on y.
• E[X | Y ] is a function of the random variable Y , hence a random vari-
able. Its experimental value is E[X | Y = y] whenever the experimental
value of Y is y.
• E

E[X | Y ]

= E[X]
(law of iterated expectations).
• var(X | Y ) is a random variable whose experimental value is var(X | Y =
y), whenever the experimental value of Y is y.
• var(X) = E

var(X | Y )

+ var

E[X | Y ]

.
4.4
SUM OF A RANDOM NUMBER OF INDEPENDENT RANDOM
VARIABLES
In our discussion so far of sums of random variables, we have always assumed
that the number of variables in the sum is known and ﬁxed, i.e., it is nonrandom.
In this section we will consider the case where the number of random variables
being added is itself random. In particular, we consider the sum
Y = X1 + · · · + XN,
where N is a random variable that takes nonnegative integer values, and X1, X2, . . .
are identically distributed random variables. We assume that N, X1, X2, . . . are
independent, meaning that any ﬁnite subcollection of these random variables are
independent.
We ﬁrst note that the randomness of N can aﬀect signiﬁcantly the character
of the random sum Y = X1 + · · · + XN. In particular, the PMF/PDF of Y =
N
i=1 Yi is much diﬀerent from the PMF/PDF of the sum Y = E[N]
i=1 Yi where
N has been replaced by its expected value (assuming that E[N] is integer). For
example, let Xi be uniformly distributed in the interval [0, 1], and let N be
equal to 1 or 3 with probability 1/2 each. Then the PDF of the random sum Y
takes values in the interval [0, 3], whereas if we replace N by its expected value
E[N] = 2, the sum Y = X1 + X2 takes values in the interval [0, 2]. Furthermore,
using the total probability theorem, we see that the PDF of Y is a mixture of
the uniform PDF and the PDF of X1 + X2 + X3, and has considerably diﬀerent
character than the triangular PDF of Y = X1 + X2 which is given in Fig. 4.4.
Let us denote by µ and σ2 the common mean and the variance of the Xi.
We wish to derive formulas for the mean, variance, and the transform of Y . The

26
Further Topics on Random Variables and Expectations
Chap. 4
method that we follow is to ﬁrst condition on the event N = n, under which we
have the sum of a ﬁxed number of random of random variables, a case that we
already know how to handle.
Fix some number n. The random variable X1 + · · · + Xn is independent of
N and, therefore, independent of the event {N = n}. Hence,
E[Y | N = n] = E[X1 + · · · + XN | N = n]
= E[X1 + · · · + Xn | N = n]
= E[X1 + · · · + Xn]
= nµ.
This is true for every nonnegative integer n and, therefore,
E[Y | N] = Nµ.
Using the law of iterated expectations, we obtain
E[Y ] = E

E[Y | N]

= E[µN] = µE[N].
Similarly,
var(Y | N = n) = var(X1 + · · · + XN | N = n)
= var(X1 + · · · + Xn)
= nσ2.
Since this is true for every nonnegative integer n, the random variable var(Y | N)
is equal to Nσ2. We now use the law of conditional variances to obtain
var(Y ) = E

var(Y | N)

+ var

E[Y | N]

= E[N]σ2 + var(Nµ)
= E[N]σ2 + µ2var(N).
The calculation of the transform proceeds along similar lines. The trans-
form associated with Y , conditional on N = n, is E[esY | N = n]. However, condi-
tioned on N = n, Y is the sum of the independent random variables X1, . . . , Xn,
and
E[esY | N = n]= E

esX1 · · · esXN | N = n

= E

esX1 · · · esXn
= E[esX1] · · · E[esXn] =

MX(s)
n.
Using the law of iterated expectations, the (unconditional) transform associated
with Y is
E[esY ] = E

E[esY | N]

= E

MX(s)
N
=
∞

n=0
(MX(s))npN(n).

Sec. 4.4
Sum of a Random Number of Independent Random Variables
27
This is similar to the transform MN(s) = E[esN] associated with N, except that
es is replaced by MX(s).
Example 4.21.
A remote village has three gas stations, and each one of them
is open on any given day with probability 1/2, independently of the others. The
amount of gas available in each gas station is unknown and is uniformly distributed
between 0 and 1000 gallons. We wish to characterize the distribution of the total
amount of gas available at the gas stations that are open.
The number N of open gas stations is a binomial random variable with p =
1/2 and the corresponding transform is
MN(s) = (1 −p + pes)3 = 1
8(1 + es)3.
The transform MX(s) associated with the amount of gas available in an open gas
station is
MX(s) = e1000s −1
1000s
.
The transform associated with the total amount Y available is the same as MN(s),
except that each occurrence of es is replaced with MX(s), i.e.,
MY (s) = 1
8

1 +

e1000s −1
1000s
3
.
Example 4.22. Sum of a Geometric Number of Independent Exponential
Random Variables.
Jane visits a number of bookstores, looking for Great Ex-
pectations. Any given bookstore carries the book with probability p, independently
of the others. In a typical bookstore visited, Jane spends a random amount of time,
exponentially distributed with parameter λ, until she either ﬁnds the book or she
decides that the bookstore does not carry it. Assuming that Jane will keep visiting
bookstores until she buys the book and that the time spent in each is independent
of everything else, we wish to determine the mean, variance, and PDF of the total
time spent in bookstores.
The total number N of bookstores visited is geometrically distributed with pa-
rameter p. Hence, the total time Y spent in bookstores is the sum of a geometrically
distributed number N of independent exponential random variables X1, X2, . . .. We
have
E[Y ] = E[N]E[X] = 1
p · 1
λ.
Using the formulas for the variance of geometric and exponential random variables,
we also obtain
var(Y ) = E[N]var(X) + (E[X])2var(N) = 1
p · 1
λ2 + 1
λ2 · 1 −p
p2
=
1
λ2p2 .

28
Further Topics on Random Variables and Expectations
Chap. 4
In order to ﬁnd the transform MY (s), let us recall that
MX(s) =
λ
λ −s,
MN(s) =
pes
1 −(1 −p)es .
Then, MY (s) is found by starting with MN(s) and replacing each occurrence of es
with MX(s). This yields
MY (s) =
pMX(s)
1 −(1 −p)MX(s) =
pλ
λ −s
1 −(1 −p)
λ
λ −s
,
which simpliﬁes to
MY (s) =
pλ
pλ −s.
We recognize this as the transform of an exponentially distributed random variable
with parameter pλ, and therefore,
fY (y) = pλe−pλy,
y ≥0.
This result can be surprising because the sum of a ﬁxed number n of indepen-
dent exponential random variables is not exponentially distributed. For example,
if n = 2, the transform associated with the sum is 
λ/(λ −s)2, which does not
correspond to the exponential distribution.
Example 4.23. Sum of a Geometric Number of Independent Geometric
Random Variables.
This example is a discrete counterpart of the preceding one.
We let N be geometrically distributed with parameter p. We also let each random
variable Xi be geometrically distributed with parameter q. We assume that all of
these random variables are independent. Let Y = X1 + · · · + XN. We have
MN(s) =
pes
1 −(1 −p)es ,
MX(s) =
qes
1 −(1 −q)es .
To determine MY (s), we start with the formula for MN(s) and replace each occur-
rence of es with MX(s). This yields
MY (s) =
pMX(s)
1 −(1 −p)MX(s),
and, after some algebra,
MY (s) =
pqes
1 −(1 −pq)es .
We conclude that Y is geometrically distributed, with parameter pq.

Sec. 4.5
Covariance and Correlation
29
Properties of Sums of a Random Number of Independent Random
Variables
Let X1, X2, . . . be random variables with common mean µ and common
variance σ2. Let N be a random variable that takes nonnegative integer
values. We assume that all of these random variables are independent, and
consider
Y = X1 + · · · + XN.
Then,
• E[Y ] = µE[N].
• var(Y ) = σ2E[N] + µ2var(N).
• The transform MY (s) is found by starting with the transform MN(s)
and replacing each occurrence of es with MX(s).
4.5
COVARIANCE AND CORRELATION
The covariance of two random variables X and Y is denoted by cov(X, Y ), and
is deﬁned by
cov(X, Y ) = E

X −E[X]

Y −E[Y ]

.
When cov(X, Y ) = 0, we say that X and Y are uncorrelated.
Roughly speaking, a positive or negative covariance indicates that the val-
ues of X −E[X] and Y −E[Y ] obtained in a single experiment “tend” to have
the same or the opposite sign, respectively (see Fig. 4.8). Thus the sign of the
covariance provides an important qualitative indicator of the relation between
X and Y .
If X and Y are independent, then
cov(X, Y ) = E

X −E[X]

Y −E[Y ]

= E

X −E[X]

E

Y −E[Y ]

= 0.
Thus if X and Y are independent, they are also uncorrelated. However, the
reverse is not true, as illustrated by the following example.
Example 4.24.
The pair of random variables (X, Y ) takes the values (1, 0), (0, 1),
(−1, 0), and (0, −1), each with probability 1/4 (see Fig. 4.9). Thus, the marginal
PMFs of X and Y are symmetric around 0, and E[X] = E[Y ] = 0. Furthermore,
for all possible value pairs (x, y), either x or y is equal to 0, which implies that
XY = 0 and E[XY ] = 0. Therefore,
cov(X, Y ) = E
X −E[X]
Y −E[Y ]
= E[XY ] = 0,

30
Further Topics on Random Variables and Expectations
Chap. 4
x 
y 
x 
y 
(a)
(b)
Figure 4.8: Examples of positively and negatively correlated random variables.
Here X and Y are uniformly distributed over the ellipses shown. In case (a) the
covariance cov(X, Y ) is negative, while in case (b) it is positive.
x 
y 
(1,0)
(-1,0)
(0,1)
(0,-1)
Figure 4.9: Joint PMF of X and Y
for Example 4.21.
Each of the four
points shown has probability 1/4. Here
X and Y are uncorrelated but not in-
dependent.
and X and Y are uncorrelated. However, X and Y are not independent since, for
example, a nonzero value of X ﬁxes the value of Y to zero.
The correlation coeﬃcient ρ of two random variables X and Y that have
nonzero variances is deﬁned as
ρ =
cov(X, Y )

var(X)var(Y )
.
It may be viewed as a normalized version of the covariance cov(X, Y ), and in fact
it can be shown that ρ ranges from −1 to 1 (see the end-of-chapter problems).
If ρ > 0 (or ρ < 0), then the values of x −E[X] and y −E[Y ] “tend”
to have the same (or opposite, respectively) sign, and the size of |ρ| provides a
normalized measure of the extent to which this is true. In fact, always assuming
that X and Y have positive variances, it can be shown that ρ = 1 (or ρ = −1)
if and only if there exists a positive (or negative, respectively) constant c such
that
y −E[Y ] = c

x −E[X]

,
for all possible numerical values (x, y)

Sec. 4.5
Covariance and Correlation
31
(see the end-of-chapter problems). The following example illustrates in part this
property.
Example 4.25.
Consider n independent tosses of a biased coin with probability of
a head equal to p. Let X and Y be the numbers of heads and of tails, respectively,
and let us look at the correlation of X and Y . Here, for all possible pairs of values
(x, y), we have x + y = n, and we also have E[X] + E[Y ] = n. Thus,
x −E[X] = −
y −E[Y ]
,
for all possible (x, y).
We will calculate the correlation coeﬃcient of X and Y , and verify that it is indeed
equal to −1.
We have
cov(X, Y ) = E
X −E[X]
Y −E[Y ]
= −E 
(X −E[X])2
= −var(X).
Hence, the correlation coeﬃcient is
ρ(X, Y ) =
cov(X, Y )

var(X)var(Y )
=
−var(X)

var(X)var(X)
= −1.
The covariance can be used to obtain a formula for the variance of the
sum of several (not necessarily independent) random variables. In particular, if
X1, X2, . . . , Xn are random variables with ﬁnite variance, we have
var
 n

i=1
Xi

=
n

i=1
var(Xi) + 2
n

i,j=1
i<j
cov(Xi, Xj).
This can be seen from the following calculation, where for brevity, we denote
˜
Xi = Xi −E[Xi]:
var
 n

i=1
Xi

= E


 n

i=1
˜
Xi
2

= E


n

i=1
n

j=1
˜
Xi ˜
Xj


=
n

i=1
n

j=1
E[ ˜
Xi ˜
Xj]
=

i=1
E[ ˜
Xi
2] + 2
n

i,j=1
i<j
E[ ˜
Xi ˜
Xj]
=
n

i=1
var(Xi) + 2
n

i,j=1
i<j
cov(Xi, Xj).

32
Further Topics on Random Variables and Expectations
Chap. 4
The following example illustrates the use of this formula.
Example 4.26.
Consider the hat problem discussed in Section 2.5, where n
people throw their hats in a box and then pick a hat at random. Let us ﬁnd the
variance of X, the number of people that pick their own hat. We have
X = X1 + · · · + Xn,
where Xi is the random variable that takes the value 1 if the ith person selects
his/her own hat, and takes the value 0 otherwise. Noting that Xi is Bernoulli with
parameter p = P(Xi = 1) = 1/n, we obtain
var(Xi) = 1
n

1 −1
n
	
.
For i ̸= j, we have
cov(Xi, Xj) = E
Xi −E[Xi]
Xj −E[Xj]
= E[XiXj] −E[Xi]E[Xj]
= P(Xi = 1 and Xj = 1) −P(Xi = 1)P(Xj = 1)
= P(Xi = 1)P(Xj = 1 | Xi = 1) −P(Xi = 1)P(Xj = 1)
= 1
n
1
n −1 −1
n2
=
1
n2(n −1).
Therefore
var(X) = var

n

i=1
Xi

=
n

i=1
var(Xi) + 2
n

i,j=1
i<j
cov(Xi, Xj)
= n 1
n

1 −1
n
	
+ 2n(n −1)
2
1
n2(n −1)
= 1.
4.6
LEAST SQUARES ESTIMATION
In many practical contexts, we want to form an estimate of the value of a random
variable X given the value of a related random variable Y , which may be viewed

Sec. 4.6
Least Squares Estimation
33
as some form of “measurement” of X. For example, X may be the range of
an aircraft and Y may be a noise-corrupted measurement of that range.
In
this section we discuss a popular formulation of the estimation problem, which
is based on ﬁnding the estimate c that minimizes the expected value of the
squared error (X −c)2 (hence the name “least squares”).
If the value of Y is not available, we may consider ﬁnding an estimate (or
prediction) c of X. The estimation error X −c is random (because X is random),
but the mean squared error E

(X −c)2
is a number that depends on c and can
be minimized over c. With respect to this criterion, it turns out that the best
possible estimate is c = E[X], as we proceed to verify.
Let m = E[X]. For any estimate c, we have
E

(X −c)2
= E

(X −m + m −c)2
= E

(X −m)2
+ 2E

(X −m)(m −c)

+ E

(m −c)2
= E

(X −m)2
+ 2E[X −m](m −c) + (m −c)2
= E

(X −m)2
+ (m −c)2,
where we used the fact E[X −m] = 0. The ﬁrst term in the right-hand side
is the variance of X and is unaﬀected by our choice of c. Therefore, we should
choose c in a way that minimizes the second term, which leads to c = m = E[X]
(see Fig. 4.10).
c
E[X]
Expected Squared
Estimation Error
E [(X- c)2]
var(X)
Figure 4.10: The mean squared error E
(X −c)2], as a function of the estimate
c, is a quadratic in c and is minimized when c = E[X]. The minimum value of
the mean squared error is var(X).
Suppose now that we observe the experimental value y of some related
random variable Y , before forming an estimate of X. How can we exploit this
additional information? Once we are told that Y takes a particular value y, the
situation is identical to the one considered earlier, except that we are now in a
new “universe,” where everything is conditioned on Y = y. We can therefore
adapt our earlier conclusion and assert that c = E[X | Y = y] minimizes the

34
Further Topics on Random Variables and Expectations
Chap. 4
conditional mean squared error E

(c −X)2 | Y = y

. Note that the resulting
estimate c depends on the experimental value y of Y (as it should). Thus, we
call E[X | Y = y] the least-squares estimate of X given the experimental value y.
Example 4.27.
Let X be uniformly distributed in the interval [4, 10] and suppose
that we observe X with some random error W, that is, we observe the experimental
value of the random variable
Y = X + W.
We assume that W is uniformly distributed in the interval [−1, 1], and independent
of X. What is the least squares estimate of X given the experimental value of Y ?
We have fX(x) = 1/6 for 4 ≤x ≤10, and fX(x) = 0, elsewhere. Conditioned
on X being equal to some x, Y is the same as x + W, and is uniform over the
interval [x −1, x + 1]. Thus, the joint PDF is given by
fX,Y (x, y) = fX(x)fY |X(y | x) = 1
6 · 1
2 = 1
12,
if 4 ≤x ≤10 and x −1 ≤y ≤x + 1, and is zero for all other values of (x, y).
The slanted rectangle in the right-hand side of Fig. 4.11 is the set of pairs (x, y) for
which fX,Y (x, y) is nonzero.
Given an experimental value y of Y , the conditional PDF fX|Y of X is uniform
on the corresponding vertical section of the slanted rectangle. The optimal estimate
E[X | Y = y] is the midpoint of that section. In the special case of the present
example, it happens to be a piecewise linear function of y.
x 
fX(x )
4
10
1/6
x  
4
10
3
5
9
11
Y = X + W 
where W  is a measurement
error that is uniformly
distributed in the interval [-1,1]
y  
Least squares estimate
E [X | Y = y ]
Figure 4.11: The PDFs in Example 4.27. The least squares estimate of X given
the experimental value y of the random variable Y = X + W depends on y and
is represented by the piecewise linear function shown in the ﬁgure on the right.
As Example 4.27 illustrates, the estimate E[X | Y = y] depends on the
observed value y and should be viewed as a function of y; see Fig. 4.12. To

Sec. 4.6
Least Squares Estimation
35
amplify this point, we refer to any function of the available information as an
estimator. Given an experimental outcome y of Y , an estimator g(·) (which is
a function) produces an estimate g(y) (which is a number). However, if y is left
unspeciﬁed, then the estimator results in a random variable g(Y ). The expected
value of the squared estimation error associated with an estimator g(Y ) is
E

X −g(Y )
2
.
Out of all estimators, it turns out that the mean squared estimation error
is minimized when g(Y ) = E[X | Y ]. To see this, note that if c is any number,
we have
E

X −E[X | Y = y]
2  Y = y

≤E

(X −c)2 | Y = y

.
Consider now an estimator g(Y ). For a given value y of Y , g(y) is a number
and, therefore,
E

X −E[X | Y = y]
2 | Y = y

≤E

X −g(y)
2  Y = y

.
This inequality is true for every possible experimental value y of Y . Thus,
E

X −E[X | Y ]
2  Y

≤E

(X −g(Y )
2  Y

,
which is now an inequality between random variables (functions of Y ). We take
expectations of both sides, and use the law of iterated expectations, to conclude
that
E

X −E[X | Y ]
2
≤E

(X −g(Y )
2
for all functions g(Y ).
E[X  |Y = y ]
y 
LEAST SQUARES
ESTIMATOR
Figure 4.12: The least squares estimator.

36
Further Topics on Random Variables and Expectations
Chap. 4
Key Facts about Least Mean Squares Estimation
• E

(X −c)2
is minimized when c = E[X]:
E

X −E[X]
2
≤E

(X −c)2
,
for all c.
• E

(X −c)2 | Y = y

is minimized when c = E[X | Y = y]:
E

X −E[X | Y = y]
2  Y = y

≤E

(X −c)2 | Y = y

,
for all c.
• Out of all estimators g(Y ) of X based on Y , the mean squared esti-
mation error E

X −g(Y )
2
is minimized when g(Y ) = E[X | Y ]:
E

X −E[X | Y ]
2
≤E

X −g(Y )
2
,
for all functions g(Y ).
Some Properties of the Estimation Error
Let us introduce the notation
ˆX = E[X | Y ],
˜X = X −ˆX,
for the (optimal) estimator and the associated estimation error, respectively.
Note that both ˆX and ˜X are random variables, and by the law of iterated
expectations,
E[ ˜X] = E

X −E[X | Y ]

= E[X] −E[X] = 0.
The equation E[ ˜X] = 0 remains valid even if we condition on Y , because
E[ ˜X | Y ] = E[X −ˆX | Y ] = E[X | Y ] −E[ ˆX | Y ] = ˆX −ˆX = 0.
We have used here the fact that ˆX is completely determined by Y and therefore
E[ ˆX | Y ] = ˆX. For similar reasons,
E

 ˆX −E[X]
 ˜X | Y

=

 ˆX −E[X]

E[ ˜X | Y ] = 0.
Taking expectations and using the law of iterated expectations, we obtain
E

 ˆX −E[X]
 ˜X

= 0.

Sec. 4.6
Least Squares Estimation
37
Note that X = ˆX + ˜X, which yields X −E[X] = ˆX −E[X] + ˜X. We square
both sides of the latter equality and take expectations to obtain
var(X) = E

X −E[X]
2
= E

 ˆX −E[X] + ˜X
2
= E

 ˆX −E[X]
2
+ E[ ˜X2] + 2E

 ˆX −E[X]
 ˜X

= E

 ˆX −E[X]
2
+ E[ ˜X2]
= var( ˆX) + var( ˜X).
(The last equality holds because E[ ˆX] = E[X] and E[ ˜X] = 0.) In summary, we
have established the following important formula, which is just another version
of the law of conditional variances introduced in Section 4.3.
var(X) = var( ˆX) + var( ˜X).
Example 4.28.
Let us say that the observed random variable Y is uninformative if
the mean squared estimation error E[ ˜X2] = var( ˜X) is the same as the unconditional
variance var(X) of X. When is this the case?
Using the formula
var(X) = var( ˆX) + var( ˜X),
we see that Y is uninformative if and only if var
 ˆX
= 0. The variance of a random
variable is zero if and only if that random variable is a constant, equal to its mean.
We conclude that Y is uninformative if and only if ˆX = E[X | Y ] = E[X], for every
realization of Y .
If X and Y are independent, we have E[X | Y ] = E[X] and Y is indeed
uninformative, which is quite intuitive. The converse, however, is not true. That
is, it is possible for E[X | Y ] to be always equal to the constant E[X], without X
and Y being independent. (Can you construct an example?)
Estimation Based on Several Measurements
So far, we have discussed the case where we estimate one random variable X
on the basis of another random variable Y . In practice, one often has access
to the experimental values of several random variables Y1, . . . , Yn, that can be
used to estimate X. Generalizing our earlier discussion, and using essentially

38
Further Topics on Random Variables and Expectations
Chap. 4
the same argument, the mean squared estimation error is minimized if we use
E[X | Y1, . . . , Yn] as our estimator. That is,
E

X −E[X | Y1, . . . , Yn]
2
≤E

X −g(Y1, . . . , Yn)
2
,
for all functions g(Y1, . . . , Yn).
This provides a complete solution to the general problem of least squares
estimation, but is sometimes diﬃcult to implement, because:
(a) In order to compute the conditional expectation E[X | Y1, . . . , Yn], we need
a complete probabilistic model, that is, the joint PDF fX,Y1,...,Yn(·) of n+1
random variables.
(b) Even if this joint PDF is available, E[X | Y1, . . . , Yn] can be a very compli-
cated function of Y1, . . . , Yn.
As a consequence, practitioners often resort to approximations of the conditional
expectation or focus on estimators that are not optimal but are simple and easy
to implement. The most common approach involves linear estimators, of the
form
a1Y1 + · · · + anYn + b.
Given a particular choice of a1, . . . , an, b, the corresponding mean squared error
is
E

(X −a1Y1 −· · · −anYn −b)2
,
and it is meaningful to choose the coeﬃcients a1, . . . , an, b in a way that min-
imizes the above expression. This problem is relatively easy to solve and only
requires knowledge of the means, variances, and covariances of the diﬀerent ran-
dom variables. We develop the solution for the case where n = 1.
Linear Least Mean Squares Estimation Based on a Single Measurement
We are interested in ﬁnding a and b that minimize the mean squared estimation
error E

(X −aY −b)2
, associated with a linear estimator aY +b of X. Suppose
that a has already been chosen. How should we choose b? This is the same as
having to choose a constant b to estimate the random variable aX −Y and, by
our earlier results, the best choice is to let b = E[X −aY ] = E[X] −aE[Y ].
It now remains to minimize, with respect to a, the expression
E

X −aY −E[X] + aE[Y ]
2
,
which is the same as
E

(X −E[X]) −a(Y −E[Y ])
2
= E

(X −E[X])2
+ a2E

(Y −E[Y ])2
−2aE

X −E[X]

Y −E[Y ]

= σ2
X + a2σ2
Y −2a · cov(X, Y ),

Sec. 4.7
The Bivariate Normal Distribution
39
where cov(X, Y ) is the covariance of X and Y :
cov(X, Y ) = E

(X −E[X])(Y −E[Y ])

.
This is a quadratic function of a, which is minimized at the point where its
derivative is zero, that is, if
a = cov(X, Y )
σ2
Y
= ρσXσY
σ2
Y
= ρσX
σY
,
where
ρ = cov(X, Y )
σXσY
is the correlation coeﬃcient. With this choice of a, the mean squared estimation
error is given by
σ2
X + a2σ2
Y −2a · cov(X, Y ) =σ2
X + ρ2 σ2
X
σ2
Y
σ2
Y −2ρσX
σy
ρσXσY
=(1 −ρ2)σ2
X.
Linear Least Mean Squares Estimation Formulas
The least mean squares linear estimator of X based on Y is
E[X] + cov(X, Y )
σ2
Y

Y −E[Y ]

.
The resulting mean squared estimation error is equal to
(1 −ρ2)var(X).
4.7
THE BIVARIATE NORMAL DISTRIBUTION
We say that two random variables X and Y have a bivariate normal distribution
if there are two independent normal random variables U and V and some scalars
a, b, c, d, such that
X = aU + bV,
Y = cU + dV.

40
Further Topics on Random Variables and Expectations
Chap. 4
To keep the discussion simple, we restrict ourselves to the case where U, V (and
therefore, X and Y as well) have zero mean.
A most important property of the bivariate normal distribution is the fol-
lowing:
If two random variables X and Y have a bivariate normal distribution and
are uncorrelated, then they are independent.
This property can be veriﬁed using multivariate transforms. We assume
that X and Y have a bivariate normal distribution and are uncorrelated. Recall
that if z is a zero-mean normal random variable with variance σ2
Z, then E[eZ] =
MZ(1) = σ2
Z/2. Fix some scalars s1, s2 and let Z = s1X + s2Y . Then, Z is the
sum of the independent normal random variables (as1 +cs2)U and (bs1 +ds2)V ,
and is therefore normal. Since X and Y are uncorrelated, the variance of Z is
s2
1σ2
X + s2
2σ2
Y . Then,
MX,Y (s1, s2) = E [es1X+s2Y ]
= E[eZ]
= e(s2
1σ2
X+s2
2σ2
Y )/2.
Let X and Y be independent zero-mean normal random variables with the same
variances σ2
X and σ2
Y as X and Y . Since they are independent, they are uncor-
related, and the same argument as above yields
MX,Y (s1, s2) = e(s2
1σ2
X+s2
2σ2
Y )/2..
Thus, the two pairs of random variables (X, Y ) and (X, Y ) are associated with
the same multivariate transform. Since the multivariate transform completely
determines the joint PDF, it follows that the pair (X, Y ) has the same joint
PDF as the pair (X, Y ). Since X and Y are independent, X and Y must also
be independent.
Let us deﬁne
ˆX = E[XY ]
E[Y 2] Y,
˜X = X −ˆX.
Thus, ˆX is the best linear estimator of X given Y , and ˜X is the estimation error.
Since X and Y are linear combinations of independent normal random variables
U and V , it follows that Y and ˜X are also linear combinations of U and V . In
particular, Y and ˜X have a bivariate normal distribution. Furthermore,
cov(Y, ˜X) = E[Y ˜X] = E[Y X] −E[Y ˆX] = E[Y X] −E[XY ]
E[Y 2] E[Y 2] = 0.

Sec. 4.7
The Bivariate Normal Distribution
41
Thus, Y and ˜X are uncorrelated and, therefore, independent. Since ˆX is a scalar
multiple of Y , we also see that ˆX and ˜X are independent.
We now start from the identity
X = ˆX + ˜X,
which implies that
E[X | Y ] = E[ ˆX | Y ] + E[ ˜X | Y ].
But E[ ˆX | Y ] = ˆX because ˆX is completely determined by Y . Also, ˜X is inde-
pendent of Y and
E[ ˜X | Y ] = E[ ˜X] = E[X −ˆX] = 0.
(The last equality was obtained because X and Y are assumed to have zero mean
and ˆX is a constant multiple of Y .) Putting everything together, we come to
the important conclusion that the best linear estimator ˆX is of the form
ˆX = E[X | Y ].
Diﬀerently said, the optimal estimator E[X | Y ] turns out to be linear.
Let us now determine the conditional density of X, conditioned on Y . We
have X = ˆX + ˜X. After conditioning on Y , the value of the random variable
ˆX is completely determined. On the other hand, ˜X is independent of Y and its
distribution is not aﬀected by conditioning. Therefore, the conditional distribu-
tion of X given Y is the same as the distribution of ˜X, shifted by ˆX. Since ˜X is
normal with mean zero and some variance σ2
˜
X, we conclude that the conditional
distribution of X is also normal with mean ˆX and variance σ2
˜
X.
We summarize our conclusions below. Although our discussion used the
zero-mean assumption, these conclusions also hold for the non-zero mean case
and we state them with this added generality.
Properties of the Bivariate Normal Distribution
Let X and Y have a bivariate normal distribution. Then:
• X and Y are independent if and only if they are uncorrelated.
• The conditional expectation is given by
E[X | Y ] = E[X] + cov(X, Y )
σ2
Y
(Y −E[Y ]).
It is a linear function of Y and has a normal distribution.

42
Further Topics on Random Variables and Expectations
Chap. 4
• The conditional distribution of X given Y is normal with mean E[X | Y ]
and variance
σ2
˜
X = (1 −ρ2)σ2
X.
Finally, let us note that while if X and Y have a bivariate normal distri-
bution, then X and Y are (individually) normal random variables, the reverse
is not true even if X and Y are uncorrelated. This is illustrated in the following
example.
Example 4.29.
Let X have a normal distribution with zero mean and unit
variance. Let z be independent of X, with P(Z = 1) = P(Z = −1) = 1/2. Let
Y = ZX, which is also normal with zero mean (why?). Furthermore,
E[XY ] = E[ZX2] = E[Z]E[X2] = 0 × 1 = 0,
so X and Y are uncorrelated. On the other hand X and Y are clearly dependent.
(For example, if X = 1, then Y must be either −1 or 1.) This may seem to contradict
our earlier conclusion that zero correlation implies independence? However, in this
example, the joint PDF of X and Y is not multivariable normal, even though both
marginal distributions are normal.

5
Stochastic Processes
Contents
5.1. The Bernoulli Process . . . . . . . . . . . . . . . . . . . p. 3
5.2. The Poisson Process
. . . . . . . . . . . . . . . . . .
p. 15
1

2
Stochastic Processes
Chap. 5
A stochastic process is a mathematical model of a probabilistic experiment that
evolves in time and generates a sequence of numerical values. For example, a
stochastic process can be used to model:
(a) the sequence of daily prices of a stock;
(b) the sequence of scores in a football game;
(c) the sequence of failure times of a machine;
(d) the sequence of hourly traﬃc loads at a node of a communication network;
(e) the sequence of radar measurements of the position of an airplane.
Each numerical value in the sequence is modeled by a random variable, so a
stochastic process is simply a (ﬁnite or inﬁnite) sequence of random variables
and does not represent a major conceptual departure from our basic framework.
We are still dealing with a single basic experiment that involves outcomes gov-
erned by a probability law, and random variables that inherit their probabilistic
properties from that law.† However, stochastic processes involve some change in
emphasis over our earlier models. In particular:
(a) We tend to focus on the dependencies in the sequence of values generated
by the process. For example, how do future prices of a stock depend on
past values?
(b) We are often interested in long-term averages, involving the entire se-
quence of generated values. For example, what is the fraction of time that
a machine is idle?
(c) We sometimes wish to characterize the likelihood or frequency of certain
boundary events. For example, what is the probability that within a
given hour all circuits of some telephone system become simultaneously
busy, or what is the frequency with which some buﬀer in a computer net-
work overﬂows with data?
In this book, we will discuss two major categories of stochastic processes.
(a) Arrival-Type Processes: Here, we are interested in occurrences that have
the character of an “arrival,” such as message receptions at a receiver, job
completions in a manufacturing cell, customer purchases at a store, etc.
We will focus on models in which the interarrival times (the times between
successive arrivals) are independent random variables. In Section 5.1, we
consider the case where arrivals occur in discrete time and the interarrival
times are geometrically distributed – this is the Bernoulli process. In Sec-
tion 5.2, we consider the case where arrivals occur in continuous time and
† Let us emphasize that all of the random variables arising in a stochastic process
refer to a single and common experiment, and are therefore deﬁned on a common
sample space. The corresponding probability law can be speciﬁed directly or indirectly
(by assuming some of its properties), as long as it unambiguously determines the joint
CDF of any subset of the random variables involved.

Sec. 5.1
The Bernoulli Process
3
the interarrival times are exponentially distributed – this is the Poisson
process.
(b) Markov Processes: Here, we are looking at experiments that evolve in time
and in which the future evolution exhibits a probabilistic dependence on
the past. As an example, the future daily prices of a stock are typically
dependent on past prices. However, in a Markov process, we assume a very
special type of dependence: the next value depends on past values only
through the current value. There is a rich methodology that applies to
such processes, and which will be developed in Chapter 6.
5.1
THE BERNOULLI PROCESS
The Bernoulli process can be visualized as a sequence of independent coin tosses,
where the probability of heads in each toss is a ﬁxed number p in the range
0 < p < 1. In general, the Bernoulli process consists of a sequence of Bernoulli
trials, where each trial produces a 1 (a success) with probability p, and a 0 (a
failure) with probability 1 −p, independently of what happens in other trials.
Of course, coin tossing is just a paradigm for a broad range of contexts
involving a sequence of independent binary outcomes. For example, a Bernoulli
process is often used to model systems involving arrivals of customers or jobs at
service centers. Here, time is discretized into periods, and a “success” at the kth
trial is associated with the arrival of at least one customer at the service center
during the kth period. In fact, we will often use the term “arrival” in place of
“success” when this is justiﬁed by the context.
In a more formal description, we deﬁne the Bernoulli process as a sequence
X1, X2, . . . of independent Bernoulli random variables Xi with
P(Xi = 1) = P(success at the ith trial) = p,
P(Xi = 0) = P(failure at the ith trial) = 1 −p,
for each i.†
Given an arrival process, one is often interested in random variables such
as the number of arrivals within a certain time period, or the time until the ﬁrst
arrival. For the case of a Bernoulli process, some answers are already available
from earlier chapters. Here is a summary of the main facts.
† Generalizing from the case of a ﬁnite number of random variables, the inde-
pendence of an inﬁnite sequence of random variables Xi is deﬁned by the requirement
that the random variables X1, . . . , Xn be independent for any ﬁnite n.
Intuitively,
knowing the experimental values of any ﬁnite subset of the random variables does not
provide any new probabilistic information on the remaining random variables, and the
conditional distribution of the latter stays the same as the unconditional one.

4
Stochastic Processes
Chap. 5
Some Random Variables Associated with the Bernoulli Process
and their Properties
• The binomial with parameters p and n. This is the number S of
successes in n independent trials. Its PMF, mean, and variance are
pS(k) =
n
k

pk(1 −p)n−k,
k = 0, 1, . . . , n,
E[S] = np,
var(S) = np(1 −p).
• The geometric with parameter p. This is the number T of trials
up to (and including) the ﬁrst success. Its PMF, mean, and variance
are
pT (t) = (1 −p)t−1p,
t = 1, 2, . . . ,
E[T] = 1
p,
var(T) = 1 −p
p2
.
Independence and Memorylessness
The independence assumption underlying the Bernoulli process has important
implications, including a memorylessness property (whatever has happened in
past trials provides no information on the outcomes of future trials). An appreci-
ation and intuitive understanding of such properties is very useful, and allows for
the quick solution of many problems that would be diﬃcult with a more formal
approach. In this subsection, we aim at developing the necessary intuition.
Let us start by considering random variables that are deﬁned in terms of
what happened in a certain set of trials.
For example, the random variable
Z = (X1 + X3)X6X7 is deﬁned in terms of the ﬁrst, third, sixth, and seventh
trial. If we have two random variables of this type and if the two sets of trials
that deﬁne them have no common element, then these random variables are
independent. This is a generalization of a fact ﬁrst seen in Chapter 2: if two
random variables U and V are independent, then any two functions of them,
g(U) and h(V ), are also independent.
Example 5.1.
(a) Let U be the number of successes in trials 1 to 5. Let V be the number of
successes in trials 6 to 10. Then, U and V are independent. This is because
U = X1 +· · ·+X5, V = X6 +· · ·+X10, and the two collections {X1, . . . , X5},
{X6, . . . , X10} have no common elements.

Sec. 5.1
The Bernoulli Process
5
(b) Let U (respectively, V ) be the ﬁrst odd (respectively, even) time i in which we
have a success. Then, U is determined by the odd-time sequence X1, X3, . . .,
whereas V is determined by the even-time sequence X2, X4, . . .. Since these
two sequences have no common elements, U and V are independent.
Suppose now that a Bernoulli process has been running for n time steps,
and that we have observed the experimental values of X1, X2, . . . , Xn. We no-
tice that the sequence of future trials Xn+1, Xn+2, . . . are independent Bernoulli
trials and therefore form a Bernoulli process. In addition, these future trials are
independent from the past ones. We conclude that starting from any given point
in time, the future is also modeled by a Bernoulli process, which is independent
of the past. We refer to this as the fresh-start property of the Bernoulli process.
Let us now recall that the time T until the ﬁrst success is a geometric
random variable. Suppose that we have been watching the process for n time
steps and no success has been recorded. What can we say about the number T −n
of remaining trials until the ﬁrst success? Since the future of the process (after
time n) is independent of the past and constitutes a fresh-starting Bernoulli
process, the number of future trials until the ﬁrst success is described by the
same geometric PMF. Mathematically, we have
P(T −n = t | T > n) = (1 −p)t−1p = P(T = t),
t = 1, 2, . . . .
This memorylessness property can also be derived algebraically, using the
deﬁnition of conditional probabilities, but the argument given here is certainly
more intuitive.
Memorylessness and the Fresh-Start Property of the Bernoulli
Process
• The number T −n of trials until the ﬁrst success after time n has
a geometric distribution with parameter p, and is independent of the
past.
• For any given time n, the sequence of random variables Xn+1, Xn+2, . . .
(the future of the process) is also a Bernoulli process, and is indepen-
dent from X1, . . . , Xn (the past of the process).
The next example deals with an extension of the fresh-start property, in
which we start looking at the process at a random time, determined by the past
history of the process.
Example 5.2.
Let N be the ﬁrst time in which we have a success immediately
following a previous success. (That is, N is the ﬁrst i for which Xi−1 = Xi = 1.)
What is the probability P(XN+1 = XN+2 = 0) that there are no successes in the
two trials that follow?

6
Stochastic Processes
Chap. 5
Intuitively, once the condition XN−1 = XN = 1 is satisﬁed, from then on,
the future of the process still consists of independent Bernoulli trials. Therefore the
probability of an event that refers to the future of the process is the same as in a
fresh-starting Bernoulli process, so that P(XN+1 = XN+2 = 0) = (1 −p)2.
To make this argument precise, we argue that the time N is a random variable,
and by conditioning on the possible values of N, we have
P(XN+1 = XN+2 = 0) =

n
P(N = n)P(XN+1 = XN+2 = 0 | N = n)
=

n
P(N = n)P(Xn+1 = Xn+2 = 0 | N = n)
Because of the way that N was deﬁned, the event {N = n} occurs if and only if
the experimental values of X1, . . . , Xn satisfy a certain condition. But the latter
random variables are independent of Xn+1 and Xn+2. Therefore,
P(Xn+1 = Xn+2 = 0 | N = n) = P(Xn+1 = Xn+2 = 0) = (1 −p)2,
which leads to
P(XN+1 = XN+2 = 0) =

n
P(N = n)(1 −p)2 = (1 −p)2.
Interarrival Times
An important random variable associated with the Bernoulli process is the time
of the kth success, which we denote by Yk. A related random variable is the kth
interarrival time, denoted by Tk. It is deﬁned by
T1 = Y1,
Tk = Yk −Yk−1,
k = 2, 3, . . .
and represents the number of trials following the k −1st success until the next
success. See Fig. 5.1 for an illustration, and also note that
Yk = T1 + T2 + · · · + Tk.
1
Time
T1
0
1
0
0 0 0
0
0
0
1 1
0
T2
T3
T4
Y3
Figure 5.1: Illustration of interarrival times. In this example, T1 = 3, T2 = 5,
T3 = 2, T4 = 1. Furthermore, Y1 = 3, Y2 = 8, Y3 = 10, Y4 = 11.

Sec. 5.1
The Bernoulli Process
7
We have already seen that the time T1 until the ﬁrst success is a geometric
random variable with parameter p. Having had a success at time T1, the future
is a fresh-starting Bernoulli process. Thus, the number of trials T2 until the
next success has the same geometric PMF. Furthermore, past trials (up to and
including time T1) are independent of future trials (from time T1 + 1 onward).
Since T2 is determined exclusively by what happens in these future trials, we
see that T2 is independent of T1. Continuing similarly, we conclude that the
random variables T1, T2, T3, . . . are independent and all have the same geometric
distribution.
This important observation leads to an alternative, but equivalent way of
describing the Bernoulli process, which is sometimes more convenient to work
with.
Alternative Description of the Bernoulli Process
1. Start with a sequence of independent geometric random variables T1,
T2, . . ., with common parameter p, and let these stand for the interar-
rival times.
2. Record a success (or arrival) at times T1, T1 + T2, T1 + T2 + T3, etc.
Example 5.3.
A computer executes two types of tasks, priority and nonpriority,
and operates in discrete time units (slots). A priority task arises with probability
p at the beginning of each slot, independently of other slots, and requires one full
slot to complete. A nonpriority task is executed at a given slot only if no priority
task is available. In this context, it may be important to know the probabilistic
properties of the time intervals available for nonpriority tasks.
With this in mind, let us call a slot busy if within this slot, the computer
executes a priority task, and otherwise let us call it idle. We call a string of idle
(or busy) slots, ﬂanked by busy (or idle, respectively) slots, an idle period (or busy
period, respectively). Let us derive the PMF, mean, and variance of the following
random variables (cf. Fig. 5.2):
(a) T = the time index of the ﬁrst idle slot;
(b) B = the length (number of slots) of the ﬁrst busy period;
(c) I = the length of the ﬁrst idle period.
We recognize T as a geometrically distributed random variable with param-
eter 1 −p. Its PMF is
pT (k) = pk−1(1 −p),
k = 1, 2, . . . .
Its mean and variance are
E[T] =
1
1 −p,
var(T) =
p
(1 −p)2 .

8
Stochastic Processes
Chap. 5
Time
Busy
Period
B
I
B B
B B B B
I
I
B
I
I
I
T
Idle
Period
Time
I
B B B B
I
I
B
I
I
I
T
I
I
I
B
I
I
B
Z
Z
Figure 5.2: Illustration of busy (B) and idle (I) periods in Example 5.3. In
the top diagram, T = 4, B = 3, and I = 2. In the bottom diagram, T = 1,
I = 5, and B = 4.
Let us now consider the ﬁrst busy period. It starts with the ﬁrst busy slot,
call it slot L. (In the top diagram in Fig. 5.2, L = 1; in the bottom diagram, L = 6.)
The number Z of subsequent slots until (and including) the ﬁrst subsequent idle
slot has the same distribution as T, because the Bernoulli process starts fresh at
time L + 1. We then notice that Z = B and conclude that B has the same PMF
as T.
If we reverse the roles of idle and busy slots, and interchange p with 1 −p, we
see that the length I of the ﬁrst idle period has the same PMF as the time index
of the ﬁrst busy slot, so that
pI(k) = (1 −p)k−1p,
k = 1, 2, . . . ,
E[I] = 1
p,
var(I) = 1 −p
p2
.
We ﬁnally note that the argument given here also works for the second, third,
etc. busy (or idle) period. Thus the PMFs calculated above apply to the ith busy
and idle period, for any i.
The kth Arrival Time
The time Yk of the kth success is equal to the sum Yk = T1 + T2 + · · · + Tk of k
independent identically distributed geometric random variables. This allows us
to derive formulas for the mean, variance, and PMF of Yk, which are given in
the table that follows.

Sec. 5.1
The Bernoulli Process
9
Properties of the kth Arrival Time
• The kth arrival time is equal to the sum of the ﬁrst k interarrival times
Yk = T1 + T2 + · · · + Tk,
and the latter are independent geometric random variables with com-
mon parameter p.
• The mean and variance of Yk are given by
E[Yk] = E[T1] + · · · + E[Tk] = k
p,
var(Yk) = var(T1) + · · · + var(Tk) = k(1 −p)
p2
.
• The PMF of Yk is given by
pYk(t) =
t −1
k −1

pk(1 −p)t−k,
t = k, k + 1, . . . ,
and is known as the Pascal PMF of order k.
To verify the formula for the PMF of Yk, we ﬁrst note that Yk cannot be
smaller than k. For t ≥k, we observe that the event {Yk = t} (the kth success
comes at time t) will occur if and only if both of the following two events A and
B occur:
(a) event A: trial t is a success;
(b) event B: exactly k −1 successes occur in the ﬁrst t −1 trials.
The probabilities of these two events are
P(A) = p
and
P(B) =
t −1
k −1

pk−1(1 −p)t−k,
respectively. In addition, these two events are independent (whether trial t is a
success or not is independent of what happened in the ﬁrst t−1 trials). Therefore,
pYk(t) = P(Yk = t) = P(A ∩B) = P(A)P(B) =
t −1
k −1

pk(1 −p)t−k,
as claimed.

10
Stochastic Processes
Chap. 5
Example 5.4.
In each minute of basketball play, Alice commits a single foul with
probability p and no foul with probability 1 −p. The number of fouls in diﬀerent
minutes are assumed to be independent. Alice will foul out of the game once she
commits her sixth foul, and will play 30 minutes if she does not foul out. What is
the PMF of Alice’s playing time?
We model fouls as a Bernoulli process with parameter p. Alice’s playing time
Z is equal to Y6, the time until the sixth foul, except if Y6 is larger than 30, in which
case, her playing time is 30, the duration of the game; that is, Z = min{Y6, 30}.
The random variable Y6 has a Pascal PMF of order 6, which is given by
pY6(t) =

t −1
5

p6(1 −p)t−6,
t = 6, 7, . . .
To determine the PMF pZ(z) of Z, we ﬁrst consider the case where z is between 6
and 29. For z in this range, we have
pZ(z) = P(Z = z) = P(Y6 = z) =

z −1
5

p6(1 −p)z−6,
z = 6, 7, . . . , 29.
The probability that Z = 30 is then determined from
pZ(30) = 1 −
29

z=6
pZ(z).
Splitting and Merging of Bernoulli Processes
Starting with a Bernoulli process in which there is a probability p of an arrival
at each time, consider splitting it as follows. Whenever there is an arrival, we
choose to either keep it (with probability q), or to discard it (with probability
1−q); see Fig. 5.3. Assume that the decisions to keep or discard are independent
for diﬀerent arrivals. If we focus on the process of arrivals that are kept, we see
that it is a Bernoulli process: in each time slot, there is a probability pq of a
kept arrival, independently of what happens in other slots. For the same reason,
the process of discarded arrivals is also a Bernoulli process, with a probability
of a discarded arrival at each time slot equal to p(1 −q).
In a reverse situation, we start with two independent Bernoulli processes
(with parameters p and q, respectively) and merge them into a single process,
as follows.
An arrival is recorded in the merged process if and only if there
is an arrival in at least one of the two original processes, which happens with
probability p + q −pq [one minus the probability (1 −p)(1 −q) of no arrival in
either process.] Since diﬀerent time slots in either of the original processes are
independent, diﬀerent slots in the merged process are also independent. Thus,
the merged process is Bernoulli, with success probability p + q −pq at each time
step; see Fig. 5.4.

Sec. 5.1
The Bernoulli Process
11
Time
Time
Time
Original
process
q
1 - q
Figure 5.3: Splitting of a Bernoulli process.
Time
Time
Time
Merged process:
Bernoulli(p+q-pq)
Bernoulli(p)
Bernoulli(q)
Figure 5.4: Merging of independent Bernoulli process.
Splitting and merging of Bernoulli (or other) arrival processes arises in
many contexts. For example, a two-machine work center may see a stream of
arriving parts to be processed and split them by sending each part to a randomly
chosen machine. Conversely, a machine may be faced with arrivals of diﬀerent
types that can be merged into a single arrival stream.
The Poisson Approximation to the Binomial
The number of successes in n independent Bernoulli trials is a binomial random
variable with parameters n and p, and its mean is np. In this subsection, we
concentrate on the special case where n is large but p is small, so that the mean
np has a moderate value. A situation of this type arises when one passes from
discrete to continuous time, a theme to be picked up in the next section. For
some more examples, think of the number of airplane accidents on any given day:

12
Stochastic Processes
Chap. 5
there is a large number of trials (airplane ﬂights), but each one has a very small
probability of being involved in an accident. Or think of counting the number of
typos in a book: there is a large number n of words, but a very small probability
of misspelling each one.
Mathematically, we can address situations of this kind, by letting n grow
while simultaneously decreasing p, in a manner that keeps the product np at a
constant value λ. In the limit, it turns out that the formula for the binomial PMF
simpliﬁes to the Poisson PMF. A precise statement is provided next, together
with a reminder of some of the properties of the Poisson PMF that were derived
in earlier chapters.
Poisson Approximation to the Binomial
• A Poisson random variable Z with parameter λ takes nonnegative
integer values and is described by the PMF
pZ(k) = e−λ λk
k! ,
k = 0, 1, 2, . . . .
Its mean and variance are given by
E[Z] = λ,
var(Z) = λ.
• For any ﬁxed nonnegative integer k, the binomial probability
pS(k) =
n!
(n −k)!k!pk(1 −p)n−k
converges to pZ(k), when we take the limit as n →∞and p = λ/n,
while keeping λ constant.
• In general, the Poisson PMF is a good approximation to the binomial
as long as λ = np, n is very large, and p is very small.
The veriﬁcation of the limiting behavior of the binomial probabilities was
given in Chapter 2 as as an end-of-chapter problem, and is replicated here for
convenience. We let p = λ/n and note that
pS(k) =
n!
(n −k)!k!pk(1 −p)n−k
= n(n −1) · · · (n −k + 1)
k!
· λk
nk ·

1 −λ
n
n−k
.

Sec. 5.1
The Bernoulli Process
13
= n
n · (n −1)
n
· · · (n −k + 1)
n
· λk
k! ·

1 −λ
n
n−k
.
Let us focus on a ﬁxed k and let n →∞. Each one of the ratios (n −1)/n,
(n −2)/n, . . . , (n −k + 1)/n converges to 1. Furthermore,†

1 −λ
n
−k
→1,

1 −λ
n
n
→e−λ.
We conclude that for each ﬁxed k, and as n →∞, we have
pS(k) →e−λ λk
k! .
Example 5.5.
As a rule of thumb, the Poisson/binomial approximation
e−λ λk
k! ≈
n!
(n −k)!k!pk(1 −p)n−k,
k = 0, 1, . . . , n,
is valid to several decimal places if n ≥100, p ≤0.01, and λ = np. To check this,
consider the following.
Gary Kasparov, the world chess champion (as of 1999) plays against 100 ama-
teurs in a large simultaneous exhibition. It has been estimated from past experience
that Kasparov wins in such exhibitions 99% of his games on the average (in precise
probabilistic terms, we assume that he wins each game with probability 0.99, inde-
pendently of other games). What are the probabilities that he will win 100 games,
98 games, 95 games, and 90 games?
We model the number of games X that Kasparov does not win as a binomial
random variable with parameters n = 100 and p = 0.01. Thus the probabilities
that he will win 100 games, 98, 95 games, and 90 games are
pX(0) = (1 −0.01)100 = 0.366,
pX(2) = 100!
98!2!0.012(1 −0.01)98 = 0.185,
pX(5) = 100!
95!5!0.015(1 −0.01)95 = 0.00290,
pX(10) =
100!
90!10!0.0110(1 −0.01)90 = 7.006 × 10−8,
† We are using here, the well known formula limx→∞(1 −1
x)x = e−1. Letting
x = n/λ, we have limn→∞(1 −λ
n)n/λ = e−1, from which it follows that limn→∞(1 −
λ
n)n = e−λ.

14
Stochastic Processes
Chap. 5
respectively. Now let us check the corresponding Poisson approximations with λ =
100 · 0.01 = 1. They are:
pZ(0) = e−1 1
0! = 0.368,
pZ(2) = e−1 1
2! = 0.184,
pZ(5) = e−1 1
5! = 0.00306,
pZ(10) = e−1 1
10! = 1.001 × 10−8.
By comparing the binomial PMF values pX(k) with their Poisson approximations
pZ(k), we see that there is close agreement.
Suppose now that Kasparov plays simultaneously just 5 opponents, who are,
however, stronger so that his probability of a win per game is 0.9. Here are the
binomial probabilities pX(k) for n = 5 and p = 0.1, and the corresponding Poisson
approximations pZ(k) for λ = np = 0.5,
pX(0) = 0.590,
pZ(0) = 0.605,
pX(1) = 0.328,
pZ(1) = 0.303,
pX(2) = 0.0729,
pZ(2) = 0.0758,
pX(3) = 0.0081,
pZ(3) = 0.0126,
pX(4) = 0.00045,
pZ(4) = 0.0016,
pX(5) = 0.00001,
pZ(5) = 0.00016.
We see that the approximation, while not poor, is considerably less accurate than
in the case where n = 100 and p = 0.01.
Example 5.6.
A packet consisting of a string of n symbols is transmitted over
a noisy channel. Each symbol has probability p = 0.0001 of being transmitted in
error, independently of errors in the other symbols. How small should n be in order
for the probability of incorrect transmission (at least one symbol in error) to be less
than 0.001?
Each symbol transmission is viewed as an independent Bernoulli trial. Thus,
the probability of a positive number S of errors in the packet is
1 −P(S = 0) = 1 −(1 −p)n.
For this probability to be less than 0.001, we must have 1 −(1 −0.0001)n < 0.001
or
n < ln 0.999
ln 0.9999 = 10.0045.
We can also use the Poisson approximation for P(S = 0), which is e−λ with λ =
np = 0.0001 · n, and obtain the condition 1 −e−0.0001·n < 0.001, which leads to
n < −ln 0.999
0.0001
= 10.005.
Given that n must be integer, both methods lead to the same conclusion that n
can be at most 10.

Sec. 5.2
The Poisson Process
15
5.2
THE POISSON PROCESS
The Poisson process can be viewed as a continuous-time analog of the Bernoulli
process and applies to situations where there is no natural way of dividing time
into discrete periods.
To see the need for a continuous-time version of the Bernoulli process, let
us consider a possible model of traﬃc accidents within a city. We can start by
discretizing time into one-minute periods and record a “success” during every
minute in which there is at least one traﬃc accident. Assuming the traﬃc in-
tensity to be constant over time, the probability of an accident should be the
same during each period. Under the additional (and quite plausible) assumption
that diﬀerent time periods are independent, the sequence of successes becomes a
Bernoulli process. Note that in real life, two or more accidents during the same
one-minute interval are certainly possible, but the Bernoulli process model does
not keep track of the exact number of accidents. In particular, it does not allow
us to calculate the expected number of accidents within a given period.
One way around this diﬃculty is to choose the length of a time period to be
very small, so that the probability of two or more accidents becomes negligible.
But how small should it be? A second? A millisecond? Instead of answering
this question, it is preferable to consider a limiting situation where the length of
the time period becomes zero, and work with a continuous time model.
We consider an arrival process that evolves in continuous time, in the sense
that any real number t is a possible arrival time. We deﬁne
P(k, τ) = P(there are exactly k arrivals during an interval of length τ),
and assume that this probability is the same for all intervals of the same length
τ. We also introduce a positive parameter λ to be referred to as the arrival
rate or intensity of the process, for reasons that will soon be apparent.
Deﬁnition of the Poisson Process
An arrival process is called a Poisson process with rate λ if it has the fol-
lowing properties:
(a) (Time-homogeneity.) The probability P(k, τ) of k arrivals is the
same for all intervals of the same length τ.
(b) (Independence.) The number of arrivals during a particular interval
is independent of the history of arrivals outside this interval.
(c) (Small interval probabilities.) The probabilities P(k, τ) satisfy
P(0, τ) = 1 −λτ + o(τ),
P(1, τ) = λτ + o1(τ).

16
Stochastic Processes
Chap. 5
Here, o(τ) and o1(τ) are functions of τ that satisfy
lim
τ→0
o(τ)
τ
= 0,
lim
τ→0
o1(τ)
τ
= 0.
The ﬁrst property states that arrivals are “equally likely” at all times. The
arrivals during any time interval of length τ are statistically the same, in the
sense that they obey the same probability law.
This is a counterpart of the
assumption that the success probability p in a Bernoulli process is constant over
time.
To interpret the second property, consider a particular interval [t, t′], of
length t′ −t. The unconditional probability of k arrivals during that interval
is P(k, t′ −t). Suppose now that we are given complete or partial information
on the arrivals outside this interval. Property (b) states that this information
is irrelevant: the conditional probability of k arrivals during [t, t′] remains equal
to the unconditional probability P(k, t′ −t). This property is analogous to the
independence of trials in a Bernoulli process.
The third property is critical. The o(τ) and o1(τ) terms are meant to be
negligible in comparison to τ, when the interval length τ is very small. They can
be thought of as the O(τ 2) terms in a Taylor series expansion of P(k, τ). Thus,
for small τ, the probability of a single arrival is roughly λτ, plus a negligible
term. Similarly, for small τ, the probability of zero arrivals is roughly 1 −λτ.
Note that the probability of two or more arrivals is
1 −P(0, τ) −P(1, τ) = −o(τ) −o1(τ),
and is negligible in comparison to P(1, τ) as τ gets smaller and smaller.
Time
0
x
x
x
δ
Arrivals
probability of success
per period:
p =λδ
δ
δ
δ δ δ
δ δ
τ
number of
periods:
n=τ/δ
expected number
of arrivals:
np=λτ
Figure 5.5: Bernoulli approximation of the Poisson process.
Let us now start with a ﬁxed time interval of length τ and partition it
into τ/δ periods of length δ, where δ is a very small number; see Fig. 5.5. The
probability of more than two arrivals during any period can be neglected, because

Sec. 5.2
The Poisson Process
17
of property (c) and the preceding discussion.
Diﬀerent periods are independent,
by property (b).
Furthermore, each period has one arrival with probability
approximately equal to λδ, or zero arrivals with probability approximately equal
to 1 −λδ.
Therefore, the process being studied can be approximated by a
Bernoulli process, with the approximation becoming more and more accurate
the smaller δ is chosen. Thus the probability P(k, τ) of k arrivals in time τ, is
approximately the same as the (binomial) probability of k successes in n = τ/δ
independent Bernoulli trials with success probability p = λδ at each trial. While
keeping the length τ of the interval ﬁxed, we let the period length δ decrease
to zero. We then note that the number n of periods goes to inﬁnity, while the
product np remains constant and equal to λτ. Under these circumstances, we
saw in the previous section that the binomial PMF converges to a Poisson PMF
with parameter λτ. We are then led to the important conclusion that
P(k, τ) = (λτ)ke−λτ
k!
,
k = 0, 1, . . . .
Note that a Taylor series expansion of e−λτ, yields
P(0, τ) = e−λτ = 1 −λτ + O(τ 2)
P(1, τ) = λτe−λτ = λτ −λ2τ 2 + O(τ 3) = λτ + O(τ 2),
consistent with property (c).
Using our earlier formulas for the mean and variance of the Poisson PMF,
we obtain
E[Nτ] = λτ,
var(Nτ) = λτ,
where Nτ stands for the number of arrivals during a time interval of length τ.
These formulas are hardly surprising, since we are dealing with the limit of a
binomial PMF with parameters n = τ/δ, p = λδ, mean np = λτ, and variance
np(1 −p) ≈np = λτ.
Let us now derive the probability law for the time T of the ﬁrst arrival,
assuming that the process starts at time zero. Note that we have T > t if and
only if there are no arrivals during the interval [0, t]. Therefore,
FT (t) = P(T ≤t) = 1 −P(T > t) = 1 −P(0, t) = 1 −e−λt,
t ≥0.
We then diﬀerentiate the CDF FT (t) of T, and obtain the PDF formula
fT (t) = λe−λt,
t ≥0,
which shows that the time until the ﬁrst arrival is exponentially distributed with
parameter λ. We summarize this discussion in the table that follows. See also
Fig. 5.6.

18
Stochastic Processes
Chap. 5
Random Variables Associated with the Poisson Process and their
Properties
• The Poisson with parameter λτ. This is the number Nτ of arrivals
in a Poisson process with rate λ, over an interval of length τ. Its PMF,
mean, and variance are
pNτ (k) = P(k, τ) = (λτ)ke−λτ
k!
,
k = 0, 1, . . . .
E[Nτ] = λτ,
var(Nτ) = λτ.
• The exponential with parameter λ. This is the time T until the
ﬁrst arrival. Its PDF, mean, and variance are
fT (t) = λe−λt,
t ≥0,
E[T] = 1
λ,
var(T) = 1
λ2 .
Time
0
x
x
x
δ
Arrivals
p =λδ
δ
δ
δ δ δ
δ δ
POISSON
BERNOULLI
Times of Arrival
Continuous
Discrete
PMF of # of Arrivals
Poisson
Binomial
Interarrival Time CDF
Exponential
Geometric
Arrival Rate
λ/unit time
p/per trial
Figure 5.6: View of the Bernoulli process as the discrete-time version of the
Poisson. We discretize time in small intervals δ and associate each interval with
a Bernoulli trial whose parameter is p = λδ. The table summarizes some of the
basic correspondences.

Sec. 5.2
The Poisson Process
19
Example 5.7.
You get email according to a Poisson process at a rate of λ = 0.2
messages per hour. You check your email every hour. What is the probability of
ﬁnding 0 and 1 new messages?
These probabilities can be found using the Poisson PMF (λτ)ke−λτ/k!, with
τ = 1, and k = 0 or k = 1:
P(0, 1) = e−0.2 = 0.819,
P(1, 1) = 0.2 · e−0.2 = 0.164
Suppose that you have not checked your email for a whole day. What is the
probability of ﬁnding no new messages? We use again the Poisson PMF and obtain
P(0, 24) = e−0.2·24 = 0.008294.
Alternatively, we can argue that the event of no messages in a 24-hour period is
the intersection of the events of no messages during each of 24 hours. These latter
events are independent and the probability of each is P(0, 1) = e−0.2, so
P(0, 24) = 
P(0, 1)24 = 
e−0.224 = 0.008294,
which is consistent with the preceding calculation method.
Example 5.8. Sum of Independent Poisson Random Variables.
Arrivals
of customers at the local supermarket are modeled by a Poisson process with a
rate of λ = 10 customers per minute. Let M be the number of customers arriving
between 9:00 and 9:10. Also, let N be the number of customers arriving between
9:30 and 9:35. What is the distribution of M + N?
We notice that M is Poisson with parameter µ = 10·10 = 100 and N is Poisson
with parameter ν = 10·5 = 50. Furthermore, M and N are independent. As shown
in Section 4.1, using transforms, M +N is Poisson with parameter µ+ν = 150. We
will now proceed to derive the same result in a more direct and intuitive manner.
Let ˜N be the number of customers that arrive between 9:10 and 9:15. Note
that ˜N has the same distribution as N (Poisson with parameter 50). Furthermore,
˜N is also independent of N. Thus, the distribution of M + N is the same as the
distribution of M + ˜N. But M + ˜N is the number of arrivals during an interval of
length 15, and has therefore a Poisson distribution with parameter 10 · 15 = 150.
This example makes a point that is valid in general. The probability of k
arrivals during a set of times of total length τ is always given by P(k, τ), even if
that set is not an interval. (In this example, we dealt with the set [9 : 00, 9 : 10]∪[9 :
30, 9 : 35], of total length 15.)
Example 5.9.
During rush hour, from 8 am to 9 am, traﬃc accidents occur
according to a Poisson process with a rate µ of 5 accidents per hour. Between 9
am and 11 am, they occur as an independent Poisson process with a rate ν of 3
accidents per hour. What is the PMF of the total number of accidents between 8
am and 11 am?

20
Stochastic Processes
Chap. 5
This is the sum of two independent Poisson random variables with parameters
5 and 3·2 = 6, respectively. Since the sum of independent Poisson random variables
is also Poisson, the total number of accidents has a Poisson PMF with parameter
5+6=11.
Independence and Memorylessness
The Poisson process has several properties that parallel those of the Bernoulli
process, including the independence of nonoverlapping time sets, a fresh-start
property, and the memorylessness of the interarrival time distribution. Given
that the Poisson process can be viewed as a limiting case of a Bernoulli process,
the fact that it inherits the qualitative properties of the latter should be hardly
surprising.
(a) Independence of nonoverlapping sets of times. Consider two disjoint
sets of times A and B, such as A = [0, 1] ∪[4, ∞) and B = [1.5, 3.6], for
example. If U and V are random variables that are completely determined
by what happens during A (respectively, B), then U and V are indepen-
dent. This is a consequence of the second deﬁning property of the Poisson
process.
(b) Fresh-start property. As a special case of the preceding observation, we
notice that the history of the process until a particular time t is independent
from the future of the process. Furthermore, if we focus on that portion
of the Poisson process that starts at time t, we observe that it inherits the
deﬁning properties of the original process. For this reason, the portion of
the Poisson process that starts at any particular time t > 0 is a probabilistic
replica of the Poisson process starting at time 0, and is independent of the
portion of the process prior to time t. Thus, we can say that the Poisson
process starts afresh at each time instant.
(c) Memoryless interarrival time distribution. We have already seen that
the geometric PMF (interarrival time in the Bernoulli process) is memo-
ryless: the number of remaining trials until the ﬁrst future arrival does
not depend on the past. The exponential PDF (interarrival time in the
Poisson process) has a similar property: given the current time t and the
past history, the future is a fresh-starting Poisson process, hence the re-
maining time until the next arrival has the same exponential distribution.
In particular, if T is the time of the ﬁrst arrival and if we are told that
T > t, then the remaining time T −t is exponentially distributed, with the
same parameter λ. For an algebraic derivation of this latter fact, we ﬁrst
use the exponential CDF to obtain P(T > t) = e−λt. We then note that

Sec. 5.2
The Poisson Process
21
for all positive scalars s and t, we have
P(T > t + s | T > t) = P(T > t + s, T > t)
P(T > t)
= P(T > t + s)
P(T > t)
= e−λ(t+s)
e−λt
= e−λs.
Here are some examples of reasoning based on the memoryless property.
Example 5.10.
You and your partner go to a tennis court, and have to wait until
the players occupying the court ﬁnish playing. Assume (somewhat unrealistically)
that their playing time has an exponential PDF. Then the PDF of your waiting
time (equivalently, their remaining playing time) also has the same exponential
PDF, regardless of when they started playing.
Example 5.11.
When you enter the bank, you ﬁnd that all three tellers are busy
serving other customers, and there are no other customers in queue. Assume that
the service times for you and for each of the customers being served are independent
identically distributed exponential random variables. What is the probability that
you will be the last to leave?
The answer is 1/3. To see this, focus at the moment when you start service
with one of the tellers. Then, the remaining time of each of the other two customers
being served, as well as your own remaining time, have the same PDF. Therefore,
you and the other two customers have equal probability 1/3 of being the last to
leave.
Interarrival Times
An important random variable associated with a Poisson process that starts at
time 0, is the time of the kth arrival, which we denote by Yk. A related random
variable is the kth interarrival time, denoted by Tk. It is deﬁned by
T1 = Y1,
Tk = Yk −Yk−1,
k = 2, 3, . . .
and represents the amount of time between the k −1st and the kth arrival. Note
that
Yk = T1 + T2 + · · · + Tk.
We have already seen that the time T1 until the ﬁrst arrival is an exponen-
tial random variable with parameter λ. Starting from the time T1 of the ﬁrst

22
Stochastic Processes
Chap. 5
arrival, the future is a fresh-starting Poisson process. Thus, the time until the
next arrival has the same exponential PDF. Furthermore, the past of the process
(up to time T1) is independent of the future (after time T1). Since T2 is deter-
mined exclusively by what happens in the future, we see that T2 is independent
of T1. Continuing similarly, we conclude that the random variables T1, T2, T3, . . .
are independent and all have the same exponential distribution.
This important observation leads to an alternative, but equivalent, way of
describing the Poisson process.†
Alternative Description of the Poisson Process
1. Start with a sequence of independent exponential random variables
T1, T2,. . ., with common parameter λ, and let these stand for the in-
terarrival times.
2. Record an arrival at times T1, T1 + T2, T1 + T2 + T3, etc.
The kth Arrival Time
The time Yk of the kth arrival is equal to the sum Yk = T1 + T2 + · · · + Tk of
k independent identically distributed exponential random variables. This allows
us to derive formulas for the mean, variance, and PMF of Yk, which are given in
the table that follows.
Properties of the kth Arrival Time
• The kth arrival time is equal to the sum of the ﬁrst k interarrival times
Yk = T1 + T2 + · · · + Tk,
and the latter are independent exponential random variables with com-
mon parameter λ.
† In our original deﬁnition, a process was called Poisson if it possessed certain
properties.
However, the astute reader may have noticed that we have not so far
established that there exists a process with the required properties. In an alternative
line of development, we could have deﬁned the Poisson process by the alternative
description given here, and such a process is clearly well-deﬁned: we start with a
sequence of independent interarrival times, from which the arrival times are completely
determined.
Starting with this deﬁnition, it is then possible to establish that the
process satisﬁes all of the properties that were postulated in our original deﬁnition.

Sec. 5.2
The Poisson Process
23
• The mean and variance of Yk are given by
E[Yk] = E[T1] + · · · + E[Tk] = k
λ,
var(Yk) = var(T1) + · · · + var(Tk) = k
λ2 .
• The PDF of Yk is given by
fYk(y) = λkyk−1e−λy
(k −1)!
and is known as the Erlang PDF of order k.
To evaluate the PDF fYk of Yk, we can argue that for a small δ, the product
δ·fYk(y) is the probability that the kth arrival occurs between times y and y+δ.†
When δ is very small, the probability of more than one arrival during the interval
[y, y + δ] is negligible. Thus, the kth arrival occurs between y and y + δ if and
only if the following two events A and B occur:
(a) event A: there is an arrival during the interval [y, y + δ];
(b) event B: there are exactly k −1 arrivals before time y.
The probabilities of these two events are
P(A) ≈λδ,
and
P(B) = P(k −1, y) = λk−1yk−1e−λy
(k −1)!
.
† For an alternative derivation that does not rely on approximation arguments,
note that for a given y ≥0, the event 
Yk ≤y
is the same as the event
{number of arrivals in the interval [0, y] ≥k}.
Thus the CDF of Yk is given by
FYk(y) = P
Yk ≤y
=
∞

n=k
P(n, y) = 1 −
k−1

n=0
P(n, y) = 1 −
k−1

n=0
(λy)ne−λy
n!
.
The PDF of Yk can be obtained by diﬀerentiating the above expression, which by
straightforward calculation yields the Erlang PDF formula
fYk(y) = d
dy FYk(y) = λkyk−1e−λy
(k −1)!
.

24
Stochastic Processes
Chap. 5
Since A and B are independent, we have
δfYk(y) ≈P(y ≤Yk ≤y + δ) ≈P(A ∩B) = P(A)P(B) ≈λδ λk−1yk−1e−λy
(k −1)!
,
from which we obtain
fYk(y) = λkyk−1e−λy
(k −1)!
,
y ≥0.
Example 5.12.
You call the IRS hotline and you are told that you are the
56th person in line, excluding the person currently being served. Callers depart
according to a Poisson process with a rate of λ = 2 per minute. How long will you
have to wait on the average until your service starts, and what is the probability
you will have to wait for more than an hour?
By the memoryless property, the remaining service time of the person cur-
rently being served is exponentially distributed with parameter 2. The service times
of the 55 persons ahead of you are also exponential with the same parameter, and
all of these random variables are independent. Thus, your waiting time Y is Erlang
of order 56, and
E[Y ] = 56
λ = 28.
The probability that you have to wait for more than an hour is given by the formula
P(Y ≥60) =
 ∞
60
λ56y55e−λy
55!
dy.
Computing this probability is quite tedious. In Chapter 7, we will discuss a much
easier way to compute approximately this probability. This is done using the central
limit theorem, which allows us to approximate the CDF of the sum of a large number
of random variables with a normal CDF and then to calculate various probabilities
of interest by using the normal tables.
Splitting and Merging of Poisson Processes
Similar to the case of a Bernoulli process, we can start with a Poisson process
with rate λ and split it, as follows: each arrival is kept with probability p and
discarded with probability 1−p, independently of what happens to other arrivals.
In the Bernoulli case, we saw that the result of the splitting was also a Bernoulli
process. In the present context, the result of the splitting turns out to be a
Poisson process with rate λp.
Alternatively, we can start with two independent Poisson processes, with
rates λ1 and λ2, and merge them by recording an arrival whenever an arrival
occurs in either process. It turns out that the merged process is also Poisson

Sec. 5.2
The Poisson Process
25
with rate λ1 + λ2. Furthermore, any particular arrival of the merged process
has probability λ1/(λ1 +λ2) of originating from the ﬁrst process and probability
λ2/(λ1 + λ2) of originating from the second, independently of all other arrivals
and their origins.
We discuss these properties in the context of some examples, and at the
same time provide a few diﬀerent arguments to establish their validity.
Example 5.13. Splitting of Poisson Processes.
A packet that arrives at a
node of a data network is either a local packet which is destined for that node (this
happens with probability p), or else it is a transit packet that must be relayed to
another node (this happens with probability 1 −p). Packets arrive according to a
Poisson process with rate λ, and each one is a local or transit packet independently
of other packets and of the arrival times.
As stated above, the process of local
packet arrivals is Poisson with rate λp. Let us see why.
We verify that the process of local packet arrivals satisﬁes the deﬁning prop-
erties of a Poisson process. Since λ and p are constant (do not change with time),
the ﬁrst property (time homogeneity) clearly holds. Furthermore, there is no de-
pendence between what happens in disjoint time intervals, verifying the second
property. Finally, if we focus on an interval of small length δ, the probability of
a local arrival is approximately the probability that there is a packet arrival, and
that this turns out to be a local one, i.e., λδ · p. In addition, the probability of
two or more local arrivals is negligible in comparison to δ, and this veriﬁes the
third property. We conclude that local packet arrivals form a Poisson process and,
in particular, the number Lτ of such arrivals during an interval of length τ has a
Poisson PMF with parameter pλτ.
Let us now rederive the Poisson PMF of Lτ using transforms.
The total
number of packets Nτ during an interval of length τ is Poisson with parameter λτ.
For i = 1, . . . , Nτ, let Xi be a Bernoulli random variable which is 1 if the ith packet
is local, and 0 if not.
Then, the random variables X1, X2, . . . form a Bernoulli
process with success probability p. The number of local packets is the number of
“successes,” i.e.,
Lτ = X1 + · · · + XNτ .
We are dealing here with the sum of a random number of independent random
variables. As discussed in Section 4.4, the transform associated with Lτ is found
by starting with the transform associated with Nτ, which is
MNτ (s) = eλτ(es−1),
and replacing each occurrence of es by the transform associated with Xi, which is
MX(s) = 1 −p + pes.
We obtain
MLτ (s) = eλτ(1−p+pes−1) = eλτp(es−1).
We observe that this is the transform of a Poisson random variable with parameter
λτp, thus verifying our earlier statement for the PMF of Lτ.

26
Stochastic Processes
Chap. 5
We conclude with yet another method for establishing that the local packet
process is Poisson. Let T1, T2, . . . be the interarrival times of packets of any type;
these are independent exponential random variables with parameter λ. Let K be
the total number of arrivals up to and including the ﬁrst local packet arrival. In
particular, the time S of the ﬁrst local packet arrival is given by
S = T1 + T2 + · · · + TK.
Since each packet is a local one with probability p, independently of the others, and
by viewing each packet as a trial which is successful with probability p, we recognize
K as a geometric random variable with parameter p. Since the nature of the packets
is independent of the arrival times, K is independent from the interarrival times. We
are therefore dealing with a sum of a random (geometrically distributed) number of
exponential random variables. We have seen in Chapter 4 (cf. Example 4.21) that
such a sum is exponentially distributed with parameter λp. Since the interarrival
times between successive local packets are clearly independent, it follows that the
local packet arrival process is Poisson with rate λp.
Example 5.14. Merging of Poisson Processes.
People with letters to mail
arrive at the post oﬃce according to a Poisson process with rate λ1, while people
with packages to mail arrive according to an independent Poisson process with rate
λ2. As stated earlier the merged process, which includes arrivals of both types, is
Poisson with rate λ1 + λ2. Let us see why.
First, it should be clear that the merged process satisﬁes the time-homogeneity
property. Furthermore, since diﬀerent intervals in each of the two arrival processes
are independent, the same property holds for the merged process. Let us now focus
on a small interval of length δ. Ignoring terms that are negligible compared to δ,
we have
P(0 arrivals in the merged process) ≈(1 −λ1δ)(1 −λ2δ) ≈1 −(λ1 + λ2)δ,
P(1 arrival in the merged process) ≈λ1δ(1 −λ2δ) + (1 −λ1δ)λ2δ ≈(λ1 + λ2)δ,
and the third property has been veriﬁed.
Given that an arrival has just been recorded, what is the probability that it
is an arrival of a person with a letter to mail? We focus again on a small interval
of length δ around the current time, and we seek the probability
P(1 arrival of person with a letter | 1 arrival).
Using the deﬁnition of conditional probabilities, and ignoring the negligible proba-
bility of more than one arrival, this is
P(1 arrival of person with a letter)
P(1 arrival)
≈
λ1δ
(λ1 + λ2)δ =
λ1
λ1 + λ2 .
Example 5.15. Competing Exponentials.
Two light bulbs have independent
and exponentially distributed lifetimes T (1) and T (2), with parameters λ1 and λ2,

Sec. 5.2
The Poisson Process
27
respectively. What is the distribution of the ﬁrst time Z = min{T (1), T (2)} at which
a bulb burns out?
We can treat this as an exercise in derived distributions. For all z ≥0, we
have,
FZ(z) = P
min{T (1), T (2)} ≤z
= 1 −P
min{T (1), T (2)} > z
= 1 −P(T (1) > z, T (2) > z)
= 1 −P(T (1) > z)P(T (2) > z)
= 1 −e−λ1ze−λ2z
= 1 −e−(λ1+λ2)z.
This is recognized as the exponential CDF with parameter λ1 +λ2. Thus, the mini-
mum of two independent exponentials with parameters λ1 and λ2 is an exponential
with parameter λ1 + λ2.
For a more intuitive explanation of this fact, let us think of T (1) (respectively,
T (2)) as the times of the ﬁrst arrival in two independent Poisson process with rate
λ1 (respectively, T (2)). If we merge these two Poisson processes, the ﬁrst arrival
time will be min{T (1), T (2)}.
But we already know that the merged process is
Poisson with rate λ1 +λ2, and it follows that the ﬁrst arrival time, min{T (1), T (2)},
is exponential with parameter λ1 + λ2.
The preceding discussion can be generalized to the case of more than two
processes. Thus, the total arrival process obtained by merging the arrivals of
n independent Poisson processes with arrival rates λ1, . . . , λn is Poisson with
arrival rate equal to the sum λ1 + · · · + λn.
Example 5.16. More on Competing Exponentials.
Three light bulbs have
independent exponentially distributed lifetimes with a common parameter λ. What
is the expectation of the time until the last bulb burns out?
We think of the times when each bulb burns out as the ﬁrst arrival times
in independent Poisson processes. In the beginning, we have three bulbs, and the
merged process has rate 3λ. Thus, the time T1 of the ﬁrst burnout is exponential
with parameter 3λ, and mean 1/3λ. Once a bulb burns out, and because of the
memorylessness property of the exponential distribution, the remaining lifetimes
of the other two lightbulbs are again independent exponential random variables
with parameter λ. We thus have two Poisson processes running in parallel, and
the remaining time T2 until the ﬁrst arrival in one of these two processes is now
exponential with parameter 2λ and mean 1/2λ. Finally, once a second bulb burns
out, we are left with a single one. Using memorylessness once more, the remaining
time T3 until the last bulb burns out is exponential with parameter λ and mean
1/λ. Thus, the expectation of the total time is
E[T1 + T2 + T3] = 1
3λ + 1
2λ + 1
λ.

28
Stochastic Processes
Chap. 5
Note that the random variables T1, T2, T3 are independent, because of memoryless-
ness. This also allows us to compute the variance of the total time:
var(T1 + T2 + T3) = var(T1) + var(T2) + var(T3) =
1
9λ2 +
1
4λ2 + 1
λ2 .
We close by noting a related and quite deep fact, namely that the sum
of a large number of (not necessarily Poisson) independent arrival processes,
can be approximated by a Poisson process with arrival rate equal to the sum of
the individual arrival rates. The component processes must have a small rate
relative to the total (so that none of them imposes its probabilistic character on
the total arrival process) and they must also satisfy some technical mathematical
assumptions. Further discussion of this fact is beyond our scope, but we note
that it is in large measure responsible for the abundance of Poisson-like processes
in practice. For example, the telephone traﬃc originating in a city consists of
many component processes, each of which characterizes the phone calls placed by
individual residents. The component processes need not be Poisson; some people
for example tend to make calls in batches, and (usually) while in the process of
talking, cannot initiate or receive a second call. However, the total telephone
traﬃc is well-modeled by a Poisson process. For the same reasons, the process
of auto accidents in a city, customer arrivals at a store, particle emissions from
radioactive material, etc., tend to have the character of the Poisson process.
The Random Incidence Paradox
The arrivals of a Poisson process partition the time axis into a sequence of
interarrival intervals; each interarrival interval starts with an arrival and ends at
the time of the next arrival. We have seen that the lengths of these interarrival
intervals are independent exponential random variables with parameter λ and
mean 1/λ, where λ is the rate of the process. More precisely, for every k, the
length of the kth interarrival interval has this exponential distribution. In this
subsection, we look at these interarrival intervals from a diﬀerent perspective.
Let us ﬁx a time instant t∗and consider the length L of the interarrival
interval to which it belongs. For a concrete context, think of a person who shows
up at the bus station at some arbitrary time t∗and measures the time from the
previous bus arrival until the next bus arrival. The arrival of this person is often
referred to as a “random incidence,” but the reader should be aware that the
term is misleading: t∗is just a particular time instance, not a random variable.
We assume that t∗is much larger than the starting time of the Poisson
process so that we can be fairly certain that there has been an arrival prior
to time t∗. To avoid the issue of determining how large a t∗is large enough,
we can actually assume that the Poisson process has been running forever, so
that we can be fully certain that there has been a prior arrival, and that L is
well-deﬁned. One might superﬁcially argue that L is the length of a “typical”
interarrival interval, and is exponentially distributed, but this turns out to be
false. Instead, we will establish that L has an Erlang PDF of order two.

Sec. 5.2
The Poisson Process
29
This is known as the random incidence phenomenon or paradox, and it can
be explained with the help of Fig. 5.7. Let [U, V ] be the interarrival interval to
which t∗belongs, so that L = V −U. In particular, U is the time of the ﬁrst
arrival prior to t∗and V is the time of the ﬁrst arrival after t∗. We split L into
two parts,
L = (t∗−U) + (V −t∗),
where t∗−U is the elapsed time since the last arrival, and V −t∗is the remaining
time until the next arrival. Note that t∗−U is determined by the past history of
the process (before t∗), while V −t∗is determined by the future of the process
(after time t∗).
By the independence properties of the Poisson process, the
random variables t∗−U and V −t∗are independent. By the memorylessness
property, the Poisson process starts fresh at time t∗, and therefore V −t∗is
exponential with parameter λ. The random variable t∗−U is also exponential
with parameter λ. The easiest way of seeing this is to realize that if we run a
Poisson process backwards in time it remains Poisson; this is because the deﬁning
properties of a Poisson process make no reference to whether time moves forward
or backward. A more formal argument is obtained by noting that
P(t∗−U > x) = P

no arrivals during [t∗−x, t∗]

= P(0, x) = e−λx,
x ≥0.
We have therefore established that L is the sum of two independent exponential
random variables with parameter λ, i.e., Erlang of order two, with mean 2/λ.
x
x
Time
Chosen 
time instant
Remaining
time  V−t* 
Elapsed
time   t*−U
t*
L
U
V
Figure 5.7: Illustration of the random incidence phenomenon. For a ﬁxed time
instant t∗, the corresponding interarrival interval [U, V ] consists of the elapsed
time t∗−U and the remaining time V −t∗. These two times are independent
and are exponentially distributed with parameter λ, so the PDF of their sum is
Erlang of order two.
Random incidence phenomena are often the source of misconceptions and
errors, but these can be avoided with careful probabilistic modeling. The key
issue is that even though interarrival intervals have length 1/λ on the average, an
observer who arrives at an arbitrary time is more likely to fall in a large rather
than a small interarrival interval. As a consequence the expected length seen by
the observer is higher, 2/λ in this case. This point is ampliﬁed by the example
that follows.

30
Stochastic Processes
Chap. 5
Example 5.17. Random incidence in a non-Poisson arrival process.
Buses
arrive at a station deterministically, on the hour, and ﬁfteen minutes after the hour.
Thus, the interarrival times alternate between 15 and 45 minutes.
The average
interarrival time is 30 minutes. A person shows up at the bus station at a “random”
time. We interpret “random” to mean a time which is uniformly distributed within
a particular hour. Such a person falls into an interarrival interval of length 15 with
probability 1/4, and an interarrival interval of length 45 with probability 3/4. The
expected value of the length of the chosen interarrival interval is
15 · 1
4 + 45 · 3
4 = 37.5,
which is considerably larger than 30, the average interarrival time.

6
Markov Chains
Contents
6.1. Discrete-Time Markov Chains
. . . . . . . . . . . . . . . p. 2
6.2. Classiﬁcation of States . . . . . . . . . . . . . . . . . . . p. 9
6.3. Steady-State Behavior . . . . . . . . . . . . . . . . . .
p. 13
6.4. Absorption Probabilities and Expected Time to Absorption
.
p. 25
6.5. More General Markov Chains . . . . . . . . . . . . . . .
p. 33
1

2
Markov Chains
Chap. 6
The Bernoulli and Poisson processes studied in the preceding chapter are memo-
ryless, in the sense that the future does not depend on the past: the occurrences
of new “successes” or “arrivals” do not depend on the past history of the process.
In this chapter, we consider processes where the future depends on and can be
predicted to some extent by what has happened in the past.
We emphasize models where the eﬀect of the past on the future is summa-
rized by a state, which changes over time according to given probabilities. We
restrict ourselves to models whose state can take a ﬁnite number of values and
can change in discrete instants of time. We want to analyze the probabilistic
properties of the sequence of state values.
The range of applications of the models of this chapter is truly vast. It
includes just about any dynamical system whose evolution over time involves
uncertainty, provided the state of the system is suitably deﬁned. Such systems
arise in a broad variety of ﬁelds, such as communications, automatic control,
signal processing, manufacturing, economics, resource allocation, etc.
6.1
DISCRETE-TIME MARKOV CHAINS
We will ﬁrst consider discrete-time Markov chains, in which the state changes
at certain discrete time instants, indexed by an integer variable n. At each time
step n, the Markov chain has a state, denoted by Xn, which belongs to a ﬁnite
set S of possible states, called the state space. Without loss of generality, and
unless there is a statement to the contrary, we will assume that S = {1, . . . , m},
for some positive integer m.
The Markov chain is described in terms of its
transition probabilities pij: whenever the state happens to be i, there is
probability pij that the next state is equal to j. Mathematically,
pij = P(Xn+1 = j | Xn = i),
i, j ∈S.
The key assumption underlying Markov processes is that the transition proba-
bilities pij apply whenever state i is visited, no matter what happened in the
past, and no matter how state i was reached. Mathematically, we assume the
Markov property, which requires that
P(Xn+1 = j | Xn = i, Xn−1 = in−1, . . . , X0 = i0) = P(Xn+1 = j | Xn = i)
= pij,
for all times n, all states i, j ∈S, and all possible sequences i0, . . . , in−1 of earlier
states. Thus, the probability law of the next state Xn+1 depends on the past
only through the value of the present state Xn.
The transition probabilities pij must be of course nonnegative, and sum to
one:
m

j=1
pij = 1,
for all i.

Sec. 6.1
Discrete-Time Markov Chains
3
We will generally allow the probabilities pii to be positive, in which case it is
possible for the next state to be the same as the current one. Even though the
state does not change, we still view this as a state transition of a special type (a
“self-transition”).
Speciﬁcation of Markov Models
• A Markov chain model is speciﬁed by identifying
(a) the set of states S = {1, . . . , m},
(b) the set of possible transitions, namely, those pairs (i, j) for which
pij > 0, and,
(c) the numerical values of those pij that are positive.
• The Markov chain speciﬁed by this model is a sequence of random
variables X0, X1, X2, . . ., that take values in S and which satisfy
P(Xn+1 = j | Xn = i, Xn−1 = in−1, . . . , X0 = i0) = pij,
for all times n, all states i, j ∈S, and all possible sequences i0, . . . , in−1
of earlier states.
All of the elements of a Markov chain model can be encoded in a transition
probability matrix, which is simply a two-dimensional array whose element
at the ith row and jth column is pij:


p11
p12
· · ·
p1m
p21
p22
· · ·
p2m
...
...
...
...
pm1
pm2
· · ·
pmm

.
It is also helpful to lay out the model in the so-called transition probability
graph, whose nodes are the states and whose arcs are the possible transitions.
By recording the numerical values of pij near the corresponding arcs, one can
visualize the entire model in a way that can make some of its major properties
readily apparent.
Example 6.1.
Alice is taking a probability class and in each week she can be
either up-to-date or she may have fallen behind. If she is up-to-date in a given
week, the probability that she will be up-to-date (or behind) in the next week is
0.8 (or 0.2, respectively). If she is behind in the given week, the probability that
she will be up-to-date (or behind) in the next week is 0.6 (or 0.4, respectively). We
assume that these probabilities do not depend on whether she was up-to-date or
behind in previous weeks, so the problem has the typical Markov chain character
(the future depends on the past only through the present).

4
Markov Chains
Chap. 6
Let us introduce states 1 and 2, and identify them with being up-to-date and
behind, respectively. Then, the transition probabilities are
p11 = 0.8,
p12 = 0.2,
p21 = 0.6,
p22 = 0.4,
and the transition probability matrix is

0.8
0.2
0.6
0.4
	
.
The transition probability graph is shown in Fig. 6.1.
1
2
Up-to-Date
Behind
0.8
0.2
0.4
0.6
Figure 6.1: The transition probability graph in Example 6.1.
Example 6.2.
A ﬂy moves along a straight line in unit increments. At each
time period, it moves one unit to the left with probability 0.3, one unit to the right
with probability 0.3, and stays in place with probability 0.4, independently of the
past history of movements. A spider is lurking at positions 1 and m: if the ﬂy
lands there, it is captured by the spider, and the process terminates. We want to
construct a Markov chain model, assuming that the ﬂy starts in one of the positions
2, . . . , m −1.
Let us introduce states 1, 2, . . . , m, and identify them with the corresponding
positions of the ﬂy. The nonzero transition probabilities are
p11 = 1,
pmm = 1,
pij =

 0.3
if j = i −1 or j = i + 1,
0.4
if j = i,
for i = 2, . . . , m −1.
The transition probability graph and matrix are shown in Fig. 6.2.
Given a Markov chain model, we can compute the probability of any partic-
ular sequence of future states. This is analogous to the use of the multiplication
rule in sequential (tree) probability models. In particular, we have
P(X0 = i0, X1 = i1, . . . , Xin = in) = P(X0 = i0)pi0i1pi1i2 · · · pin−1in.

Sec. 6.1
Discrete-Time Markov Chains
5
1
2
0.3
1
0.4
3
4
1
0.4
0.3
0.3
0.3
0.3
1
0.4
pij
3
2
4
1
3
2
4
1.0
1.0
0
0
0
0
0
0
0
0
0.4
0.3
0.3
0.3
Figure 6.2: The transition probability graph and the transition probability ma-
trix in Example 6.2, for the case where m = 4.
To verify this property, note that
P(X0 = i0, X1 = i1, . . . , Xin = in)
= P(Xn = in | X0 = i0, . . . , Xn−1 = in−1)P(X0 = i0, . . . , Xn−1 = in−1)
= pin−1inP(X0 = i0, . . . , Xn−1 = in−1),
where the last equality made use of the Markov property. We then apply the
same argument to the term P(X0 = i0, . . . , Xn−1 = in−1) and continue similarly,
until we eventually obtain the desired expression. If the initial state X0 is given
and is known to be equal to some i0, a similar argument yields
P(X1 = i1, . . . , Xin = in | X0 = i0) = pi0i1pi1i2 · · · pin−1in.
Graphically, a state sequence can be identiﬁed with a sequence of arcs in the
transition probability graph, and the probability of such a path (given the ini-
tial state) is given by the product of the probabilities associated with the arcs
traversed by the path.
Example 6.3.
For the spider and ﬂy example (Example 6.2), we have
P(X1 = 2, X2 = 2, X3 = 3, X4 = 4 | X0 = 2) = p22p22p23p34 = (0.4)2(0.3)2.
We also have
P(X0 = 2, X1 = 2, X2 = 2, X3 = 3, X4 = 4) = P(X0 = 2)p22p22p23p34
= P(X0 = 2)(0.4)2(0.3)2.
Note that in order to calculate a probability of this form, in which there is no
conditioning on a ﬁxed initial state, we need to specify a probability law for the
initial state X0.

6
Markov Chains
Chap. 6
n-Step Transition Probabilities
Many Markov chain problems require the calculation of the probability law of
the state at some future time, conditioned on the current state. This probability
law is captured by the n-step transition probabilities, deﬁned by
rij(n) = P(Xn = j | X0 = i).
In words, rij(n) is the probability that the state after n time periods will be j,
given that the current state is i. It can be calculated using the following basic
recursion, known as the Chapman-Kolmogorov equation.
Chapman-Kolmogorov Equation for the n-Step Transition
Probabilities
The n-step transition probabilities can be generated by the recursive formula
rij(n) =
m

k=1
rik(n −1)pkj,
for n > 1,
and all i, j,
starting with
rij(1) = pij.
To verify the formula, we apply the total probability theorem as follows:
P(Xn = j | X0 = i) =
m

k=1
P(Xn−1 = k | X0 = i) · P(Xn = j | Xn−1 = k, X0 = i)
=
m

k=1
rik(n −1)pkj;
see Fig. 6.3 for an illustration. We have used here the Markov property: once
we condition on Xn−1 = k, the conditioning on X0 = i does not aﬀect the
probability pkj of reaching j at the next step.
We can view rij(n) as the element at the ith row and jth column of a two-
dimensional array, called the n-step transition probability matrix.† Figures
† Those readers familiar with matrix multiplication, may recognize that the
Chapman-Kolmogorov equation can be expressed as follows: the matrix of n-step tran-
sition probabilities rij(n) is obtained by multiplying the matrix of (n −1)-step tran-
sition probabilities rik(n −1), with the one-step transition probability matrix. Thus,
the n-step transition probability matrix is the nth power of the transition probability
matrix.

Sec. 6.1
Discrete-Time Markov Chains
7
1
k
j
m
...
pmj
p1j 
i
ri1(n-1)
rik(n-1)
rim(n-1)
...
pkj
Time 0
Time  n-1
Time  n
Figure 6.3: Derivation of the Chapman-Kolmogorov equation. The probability
of being at state j at time n is the sum of the probabilities rik(n −1)pkj of the
diﬀerent ways of reaching j.
B
UpD
B
UpD
0.8
0.2
0.4
0.6
.76
.24
.28
.72
.752 .248
.256
.744
.7504 .2496
.2512
.7488
rij (5)
.7501 .2499
.2502
.7498
rij (1)
rij (2)
rij (3)
rij (4)
Sequence of n -step transition probability matrices
 n-step transition probabilities as a function of the  numbern  of transitions
0
0.75
0.25
n
r11(n)
r12(n)
0
0.75
0.25
n
r22(n)
r21(n)
Figure 6.4: n-step transition probabilities for the “up-to-date/behind” Example
6.1. Observe that as n →∞, rij(n) converges to a limit that does not depend on
the initial state.
6.4 and 6.5 give the n-step transition probabilities rij(n) for the cases of Ex-
amples 6.1 and 6.2, respectively. There are some interesting observations about
the limiting behavior of rij(n) in these two examples. In Fig. 6.4, we see that

8
Markov Chains
Chap. 6
each rij(n) converges to a limit, as n →∞, and this limit does not depend on
the initial state. Thus, each state has a positive “steady-state” probability of
being occupied at times far into the future. Furthermore, the probability rij(n)
depends on the initial state i when n is small, but over time this dependence
diminishes. Many (but by no means all) probabilistic models that evolve over
time have such a character: after a suﬃciently long time, the eﬀect of their initial
condition becomes negligible.
In Fig. 6.5, we see a qualitatively diﬀerent behavior: rij(n) again converges,
but the limit depends on the initial state, and can be zero for selected states.
Here, we have two states that are “absorbing,” in the sense that they are inﬁnitely
repeated, once reached. These are the states 1 and 4 that correspond to the
capture of the ﬂy by one of the two spiders. Given enough time, it is certain
that some absorbing state will be reached. Accordingly, the probability of being
at the non-absorbing states 2 and 3 diminishes to zero as time increases.
1
3
2
4
1
3
2
4
0.3
0.4
1.0
1.0
0
0
0
0
0
0
0
0
0.4
0.3
0.3
0.3
.25
1.0
1.0
0
0
0
0
0
0
.09
.24
.42
.17
1.0
1.0
0
0
0
0
0
0
.16
.17
.50
.12
1.0
1.0
0
0
0
0
0
0
.21
.12
.55
0
1.0
1.0
0
0
0
0
0
0
1/3
0
2/3
rij (1)
rij (2)
rij (3)
rij (4)
rij (∞)
.09 .24
.42
.25
.17
.16 .17
.50
.12
.21 .12
.55
. . . .
0
1/3
0
2/3
Sequence of transition probability matrices
 n-step transition probabilities as a function of the  time n
0
n
r21(n)
r24(n)
2/3
1/3
r22(n)
r23(n)
Figure 6.5: n-step transition probabilities for the “spiders-and-ﬂy” Example 6.2.
Observe that rij(n) converges to a limit that depends on the initial state.
These examples illustrate that there is a variety of types of states and
asymptotic occupancy behavior in Markov chains. We are thus motivated to
classify and analyze the various possibilities, and this is the subject of the next
three sections.

Sec. 6.2
Classiﬁcation of States
9
6.2
CLASSIFICATION OF STATES
In the preceding section, we saw through examples several types of Markov chain
states with qualitatively diﬀerent characteristics. In particular, some states, after
being visited once, are certain to be revisited again, while for some other states
this may not be the case. In this section, we focus on the mechanism by which
this occurs. In particular, we wish to classify the states of a Markov chain with
a focus on the long-term frequency with which they are visited.
As a ﬁrst step, we make the notion of revisiting a state precise. Let us say
that a state j is accessible from a state i if for some n, the n-step transition
probability rij(n) is positive, i.e., if there is positive probability of reaching j,
starting from i, after some number of time periods. An equivalent deﬁnition is
that there is a possible state sequence i, i1, . . . , in−1, j, that starts at i and ends
at j, in which the transitions (i, i1), (i1, i2), . . . , (in−2, in−1), (in−1, j) all have
positive probability. Let A(i) be the set of states that are accessible from i. We
say that i is recurrent if for every j that is accessible from i, i is also accessible
from j; that is, for all j that belong to A(i) we have that i belongs to A(j).
When we start at a recurrent state i, we can only visit states j ∈A(i)
from which i is accessible. Thus, from any future state, there is always some
probability of returning to i and, given enough time, this is certain to happen.
By repeating this argument, if a recurrent state is visited once, it will be revisited
an inﬁnite number of times.
A state is called transient if it is not recurrent. In particular, there are
states j ∈A(i) such that i is not accessible from j. After each visit to state i,
there is positive probability that the state enters such a j. Given enough time,
this will happen, and state i cannot be visited after that. Thus, a transient state
will only be visited a ﬁnite number of times.
Note that transience or recurrence is determined by the arcs of the tran-
sition probability graph [those pairs (i, j) for which pij > 0] and not by the
numerical values of the pij. Figure 6.6 provides an example of a transition prob-
ability graph, and the corresponding recurrent and transient states.
1
2
3
4
Recurrent
Recurrent
Recurrent
Transient
Figure 6.6: Classiﬁcation of states given the transition probability graph. Start-
ing from state 1, the only accessible state is itself, and so 1 is a recurrent state.
States 1, 3, and 4 are accessible from 2, but 2 is not accessible from any of them,
so state 2 is transient. States 3 and 4 are accessible only from each other (and
themselves), and they are both recurrent.
If i is a recurrent state, the set of states A(i) that are accessible from i

10
Markov Chains
Chap. 6
form a recurrent class (or simply class), meaning that states in A(i) are all
accessible from each other, and no state outside A(i) is accessible from them.
Mathematically, for a recurrent state i, we have A(i) = A(j) for all j that belong
to A(i), as can be seen from the deﬁnition of recurrence. For example, in the
graph of Fig. 6.6, states 3 and 4 form a class, and state 1 by itself also forms a
class.
It can be seen that at least one recurrent state must be accessible from any
given transient state. This is intuitively evident, and a more precise justiﬁcation
is given in the theoretical problems section.
It follows that there must exist
at least one recurrent state, and hence at least one class. Thus, we reach the
following conclusion.
Markov Chain Decomposition
• A Markov chain can be decomposed into one or more recurrent classes,
plus possibly some transient states.
• A recurrent state is accessible from all states in its class, but is not
accessible from recurrent states in other classes.
• A transient state is not accessible from any recurrent state.
• At least one, possibly more, recurrent states are accessible from a given
transient state.
Figure 6.7 provides examples of Markov chain decompositions. Decompo-
sition provides a powerful conceptual tool for reasoning about Markov chains
and visualizing the evolution of their state. In particular, we see that:
(a) once the state enters (or starts in) a class of recurrent states, it stays within
that class; since all states in the class are accessible from each other, all
states in the class will be visited an inﬁnite number of times;
(b) if the initial state is transient, then the state trajectory contains an ini-
tial portion consisting of transient states and a ﬁnal portion consisting of
recurrent states from the same class.
For the purpose of understanding long-term behavior of Markov chains, it is im-
portant to analyze chains that consist of a single recurrent class. For the purpose
of understanding short-term behavior, it is also important to analyze the mech-
anism by which any particular class of recurrent states is entered starting from a
given transient state. These two issues, long-term and short-term behavior, are
the focus of Sections 6.3 and 6.4, respectively.
Periodicity
One more characterization of a recurrent class is of special interest, and relates

Sec. 6.2
Classiﬁcation of States
11
1
2
3
4
Single class of recurrent states
1
2
3
Single class of recurrent states (1 and 2)
and one transient state (3)
Two  classes of recurrent states 
(class of state1 and class of states 4 and 5)
and two transient states (2 and 3)
1
2
3
4
5
Figure 6.7: Examples of Markov chain decompositions into recurrent classes and
transient states.
to the presence or absence of a certain periodic pattern in the times that a state
is visited. In particular, a recurrent class is said to be periodic if its states can
be grouped in d > 1 disjoint subsets S1, . . . , Sd so that all transitions from one
subset lead to the next subset; see Fig. 6.8. More precisely,
if i ∈Sk and pij > 0,
then

j ∈Sk+1,
if k = 1, . . . , d −1,
j ∈S1,
if k = d.
A recurrent class that is not periodic, is said to be aperiodic.
Thus, in a periodic recurrent class, we move through the sequence of subsets
in order, and after d steps, we end up in the same subset.
As an example, the
recurrent class in the second chain of Fig. 6.7 (states 1 and 2) is periodic, and
the same is true of the class consisting of states 4 and 5 in the third chain of Fig.
6.7. All other classes in the chains of this ﬁgure are aperiodic.

12
Markov Chains
Chap. 6
6
1
2
3
4
5
S1
S3
S2
Figure 6.8: Structure of a periodic recurrent class.
Note that given a periodic recurrent class, a positive time n, and a state j in
the class, there must exist some state i such that rij(n) = 0. The reason is that,
from the deﬁnition of periodicity, the states are grouped in subsets S1, . . . , Sd,
and the subset to which j belongs can be reached at time n from the states in
only one of the subsets. Thus, a way to verify aperiodicity of a given recurrent
class R, is to check whether there is a special time n ≥1 and a special state
s ∈R that can be reached at time n from all initial states in R, i.e., ris(n) > 0
for all i ∈R. As an example, consider the ﬁrst chain in Fig. 6.7. State s = 2
can be reached at time n = 2 starting from every state, so the unique recurrent
class of that chain is aperiodic.
A converse statement, which we do not prove, also turns out to be true:
if a recurrent class is not periodic, then a time n and a special state s with the
above properties can always be found.
Periodicity
Consider a recurrent class R.
• The class is called periodic if its states can be grouped in d > 1
disjoint subsets S1, . . . , Sd, so that all transitions from Sk lead to Sk+1
(or to S1 if k = d).
• The class is aperiodic (not periodic) if and only if there exists a time
n and a state s in the class, such that pis(n) > 0 for all i ∈R.

Sec. 6.3
Steady-State Behavior
13
6.3
STEADY-STATE BEHAVIOR
In Markov chain models, we are often interested in long-term state occupancy
behavior, that is, in the n-step transition probabilities rij(n) when n is very
large. We have seen in the example of Fig. 6.4 that the rij(n) may converge to
steady-state values that are independent of the initial state, so to what extent
is this behavior typical?
If there are two or more classes of recurrent states, it is clear that the
limiting values of the rij(n) must depend on the initial state (visiting j far into
the future will depend on whether j is in the same class as the initial state i).
We will, therefore, restrict attention to chains involving a single recurrent class,
plus possibly some transient states. This is not as restrictive as it may seem,
since we know that once the state enters a particular recurrent class, it will stay
within that class. Thus, asymptotically, the presence of all classes except for one
is immaterial.
Even for chains with a single recurrent class, the rij(n) may fail to converge.
To see this, consider a recurrent class with two states, 1 and 2, such that from
state 1 we can only go to 2, and from 2 we can only go to 1 (p12 = p21 = 1).
Then, starting at some state, we will be in that same state after any even number
of transitions, and in the other state after any odd number of transitions. What
is happening here is that the recurrent class is periodic, and for such a class, it
can be seen that the rij(n) generically oscillate.
We now assert that for every state j, the n-step transition probabilities
rij(n) approach a limiting value that is independent of i, provided we exclude
the two situations discussed above (multiple recurrent classes and/or a periodic
class). This limiting value, denoted by πj, has the interpretation
πj ≈P(Xn = j),
when n is large,
and is called the steady-state probability of j. The following is an important
theorem. Its proof is quite complicated and is outlined together with several
other proofs in the theoretical problems section.
Steady-State Convergence Theorem
Consider a Markov chain with a single recurrent class, which is aperiodic.
Then, the states j are associated with steady-state probabilities πj that
have the following properties.
(a)
lim
n→∞rij(n) = πj,
for all i, j.

14
Markov Chains
Chap. 6
(b) The πj are the unique solution of the system of equations below:
πj =
m

k=1
πkpkj,
j = 1, . . . , m,
1 =
m

k=1
πk.
(c) We have
πj = 0,
for all transient states j,
πj > 0,
for all recurrent states j.
Since the steady-state probabilities πj sum to 1, they form a probability
distribution on the state space, called the stationary distribution of the chain.
The reason for the name is that if the initial state is chosen according to this
distribution, i.e., if
P(X0 = j) = πj,
j = 1, . . . , m,
then, using the total probability theorem, we have
P(X1 = j) =
m

k=1
P(X0 = k)pkj =
m

k=1
πkpkj = πj,
where the last equality follows from part (b) of the steady-state convergence
theorem. Similarly, we obtain P(Xn = j) = πj, for all n and j. Thus, if the
initial state is chosen according to the stationary distribution, all subsequent
states will have the same distribution.
The equations
πj =
m

k=1
πkpkj,
j = 1, . . . , m,
are called the balance equations. They are a simple consequence of part (a)
of the theorem and the Chapman-Kolmogorov equation. Indeed, once the con-
vergence of rij(n) to some πj is taken for granted, we can consider the equation,
rij(n) =
m

k=1
rik(n −1)pkj,

Sec. 6.3
Steady-State Behavior
15
take the limit of both sides as n →∞, and recover the balance equations.† The
balance equations are a linear system of equations that, together with m
k=1 πk =
1, can be solved to obtain the πj. The following examples illustrate the solution
process.
Example 6.4.
Consider a two-state Markov chain with transition probabilities
p11 = 0.8,
p12 = 0.2,
p21 = 0.6,
p22 = 0.4.
[This is the same as the chain of Example 6.1 (cf. Fig. 6.1).] The balance equations
take the form
π1 = π1p11 + π2p21,
π2 = π1p12 + π2p22,
or
π1 = 0.8 · π1 + 0.6 · π2,
π2 = 0.2 · π1 + 0.4 · π2.
Note that the above two equations are dependent, since they are both equivalent
to
π1 = 3π2.
This is a generic property, and in fact it can be shown that one of the balance equa-
tions depends on the remaining equations (see the theoretical problems). However,
we know that the πj satisfy the normalization equation
π1 + π2 = 1,
which supplements the balance equations and suﬃces to determine the πj uniquely.
Indeed, by substituting the equation π1 = 3π2 into the equation π1 + π2 = 1, we
obtain 3π2 + π2 = 1, or
π2 = 0.25,
which using the equation π1 + π2 = 1, yields
π1 = 0.75.
This is consistent with what we found earlier by iterating the Chapman-Kolmogorov
equation (cf. Fig. 6.4).
Example 6.5.
An absent-minded professor has two umbrellas that she uses when
commuting from home to oﬃce and back. If it rains and an umbrella is available in
† According to a famous and important theorem from linear algebra (called the
Perron-Frobenius theorem), the balance equations always have a nonnegative solution,
for any Markov chain. What is special about a chain that has a single recurrent class,
which is aperiodic, is that the solution is unique and is also equal to the limit of the
n-step transition probabilities rij(n).

16
Markov Chains
Chap. 6
her location, she takes it. If it is not raining, she always forgets to take an umbrella.
Suppose that it rains with probability p each time she commutes, independently of
other times. What is the steady-state probability that she gets wet on a given day?
We model this problem using a Markov chain with the following states:
State i: i umbrellas are available in her current location,
i = 0, 1, 2.
The transition probability graph is given in Fig. 6.9, and the transition probability
matrix is

0
0
1
0
1 −p
p
1 −p
p
0

.
The chain has a single recurrent class that is aperiodic (assuming 0 < p < 1), so
the steady-state convergence theorem applies. The balance equations are
π0 = (1 −p)π2,
π1 = (1 −p)π1 + pπ2,
π2 = π0 + pπ1.
From the second equation, we obtain π1 = π2, which together with the ﬁrst equation
π0 = (1 −p)π2 and the normalization equation π0 + π1 + π2 = 1, yields
π0 = 1 −p
3 −p,
π1 =
1
3 −p,
π2 =
1
3 −p.
According to the steady-state convergence theorem, the steady-state probability
that the professor ﬁnds herself in a place without an umbrella is π0. The steady-
state probability that she gets wet is π0 times the probability of rain p.
1
2
0
1
1 - p
1 - p
p
p
No umbrellas
Two umbrellas
One umbrella
Figure 6.9: Transition probability graph for Example 6.5.
Example 6.6.
A superstitious professor works in a circular building with m
doors, where m is odd, and never uses the same door twice in a row.
Instead
he uses with probability p (or probability 1 −p) the door that is adjacent in the
clockwise direction (or the counterclockwise direction, respectively) to the door he
used last. What is the probability that a given door will be used on some particular
day far into the future?

Sec. 6.3
Steady-State Behavior
17
1
2
3
p
1 - p
1 - p
1 - p
1 - p
p
p
p
Door 1
Door 3
Door 4
Door 2
5
4
Door 5
1 - p
p
Figure 6.10: Transition probability graph in Example 6.6, for the case of
m = 5 doors.
We introduce a Markov chain with the following m states:
State i: Last door used is door i,
i = 1, . . . , m.
The transition probability graph of the chain is given in Fig. 6.10, for the case
m = 5. The transition probability matrix is


0
p
0
0
. . .
0
1 −p
1 −p
0
p
0
. . .
0
0
0
1 −p
0
p
. . .
0
0
...
...
...
...
...
...
...
p
0
0
0
. . .
1 −p
0


.
Assuming that 0 < p < 1, the chain has a single recurrent class that is aperiodic.
[To verify aperiodicity, argue by contradiction: if the class were periodic, there
could be only two subsets of states such that transitions from one subset lead to
the other, since it is possible to return to the starting state in two transitions. Thus,
it cannot be possible to reach a state i from a state j in both an odd and an even
number of transitions. However, if m is odd, this is true for states 1 and m – a
contradiction (for example, see the case where m = 5 in Fig. 6.10, doors 1 and 5 can
be reached from each other in 1 transition and also in 4 transitions).] The balance
equations are
π1 = (1 −p)π2 + pπm,
πi = pπi−1 + (1 −p)πi+1,
i = 2, . . . , m −1,
πm = (1 −p)π1 + pπm−1.
These equations are easily solved once we observe that by symmetry, all doors
should have the same steady-state probability. This suggests the solution
πj = 1
m,
j = 1, . . . , m.

18
Markov Chains
Chap. 6
Indeed, we see that these πj satisfy the balance equations as well as the normal-
ization equation, so they must be the desired steady-state probabilities (by the
uniquenes part of the steady-state convergence theorem).
Note that if either p = 0 or p = 1, the chain still has a single recurrent
class but is periodic. In this case, the n-step transition probabilities rij(n) do not
converge to a limit, because the doors are used in a cyclic order. Similarly, if m is
even, the recurrent class of the chain is periodic, since the states can be grouped
into two subsets, the even and the odd numbered states, such that from each subset
one can only go to the other subset.
Example 6.7.
A machine can be either working or broken down on a given day.
If it is working, it will break down in the next day with probability b, and will
continue working with probability 1 −b. If it breaks down on a given day, it will
be repaired and be working in the next day with probability r, and will continue to
be broken down with probability 1 −r. What is the steady-state probability that
the machine is working on a given day?
We introduce a Markov chain with the following two states:
State 1: Machine is working,
State 2: Machine is broken down.
The transition probability graph of the chain is given in Fig. 6.11. The transition
probability matrix is

1 −b
b
r
1 −r
	
.
This Markov chain has a single recurrent class that is aperiodic (assuming 0 < b < 1
and 0 < r < 1), and from the balance equations, we obtain
π1 = (1 −b)π1 + rπ2,
π2 = bπ1 + (1 −r)π2,
or
bπ1 = rπ2.
This equation together with the normalization equation π1 + π2 = 1, yields the
steady-state probabilities
π1 =
r
b + r ,
π2 =
b
b + r .
1
2
Working
Broken
1 - b
r
b
1 - r
Figure 6.11: Transition probability graph for Example 6.7.

Sec. 6.3
Steady-State Behavior
19
The situation considered in the previous example has evidently the Markov
property, i.e., the state of the machine at the next day depends explicitly only on
its state at the present day. However, it is possible to use a Markov chain model
even if there is a dependence on the states at several past days. The general
idea is to introduce some additional states which encode what has happened in
preceding periods. Here is an illustration of this technique.
Example 6.8.
Consider a variation of Example 6.7.
If the machine remains
broken for a given number of ℓdays, despite the repair eﬀorts, it is replaced by a
new working machine. To model this as a Markov chain, we replace the single state
2, corresponding to a broken down machine, with several states that indicate the
number of days that the machine is broken. These states are
State (2, i): The machine has been broken for i days, i = 1, 2, . . . , ℓ.
The transition probability graph is given in Fig. 6.12 for the case where ℓ= 4.
Again this Markov chain has a single recurrent class that is aperiodic. From the
balance equations, we have
π1 = (1 −b)π1 + r(π(2,1) + · · · + π(2,ℓ−1)) + π(2,ℓ),
π(2,1) = bπ1,
π(2,i) = (1 −r)π(2,i−1),
i = 2, . . . , ℓ.
The last two equations can be used to express π(2,i) in terms of π1,
π(2,i) = (1 −r)i−1bπ1,
i = 1, . . . , ℓ.
Substituting into the normalization equation π1 + ℓ
i=1 π(2,i) = 1, we obtain
1 =

1 + b
ℓ

i=1
(1 −r)i−1

π1 =

1 +
b
1 −(1 −r)ℓ
r

π1,
or
π1 =
r
r + b
1 −(1 −r)ℓ.
Using the equation π(2,i) = (1 −r)i−1bπ1, we can also obtain explicit formulas for
the π(2,i).
1
2,1
Working
Broken
1 - b
r
b
1 - r
2,2
2,3
2,4
1 - r
1 - r
r
r
1
Figure 6.12: Transition probability graph for Example 6.8. A machine that has
remained broken for ℓ= 4 days is replaced by a new, working machine.

20
Markov Chains
Chap. 6
Long-Term Frequency Interpretations
Probabilities are often interpreted as relative frequencies in an inﬁnitely long
string of independent trials. The steady-state probabilities of a Markov chain
admit a similar interpretation, despite the absence of independence.
Consider, for example, a Markov chain involving a machine, which at the
end of any day can be in one of two states, working or broken-down. Each time it
breaks down, it is immediately repaired at a cost of $1. How are we to model the
long-term expected cost of repair per day? One possibility is to view it as the
expected value of the repair cost on a randomly chosen day far into the future;
this is just the steady-state probability of the broken down state. Alternatively,
we can calculate the total expected repair cost in n days, where n is very large,
and divide it by n. Intuition suggests that these two methods of calculation
should give the same result. Theory supports this intuition, and in general we
have the following interpretation of steady-state probabilities (a justiﬁcation is
given in the theoretical problems section).
Steady-State Probabilities as Expected State Frequencies
For a Markov chain with a single class that is aperiodic, the steady-state
probabilities πj satisfy
πj = lim
n→∞
vij(n)
n
,
where vij(n) is the expected value of the number of visits to state j within
the ﬁrst n transitions, starting from state i.
Based on this interpretation, πj is the long-term expected fraction of time
that the state is equal to j. Each time that state j is visited, there is probability
pjk that the next transition takes us to state k. We conclude that πjpjk can
be viewed as the long-term expected fraction of transitions that move the state
from j to k.†
† In fact, some stronger statements are also true. Namely, whenever we carry
out the probabilistic experiment and generate a trajectory of the Markov chain over
an inﬁnite time horizon, the observed long-term frequency with which state j is visited
will be exactly equal to πj, and the observed long-term frequency of transitions from
j to k will be exactly equal to πjpjk. Even though the trajectory is random, these
equalities hold with certainty, that is, with probability 1. The exact meaning of this
statement will become more apparent in the next chapter, when we discuss concepts
related to the limiting behavior of random processes.

Sec. 6.3
Steady-State Behavior
21
Expected Frequency of a Particular Transition
Consider n transitions of a Markov chain with a single class that is aperiodic,
starting from a given initial state. Let qjk(n) be the expected number of
such transitions that take the state from j to k. Then, regardless of the
initial state, we have
lim
n→∞
qjk(n)
n
= πjpjk.
The frequency interpretation of πj and πjpjk allows for a simple interpre-
tation of the balance equations. The state is equal to j if and only if there is a
transition that brings the state to j. Thus, the expected frequency πj of visits to
j is equal to the sum of the expected frequencies πkpkj of transitions that lead
to j, and
πj =
m

k=1
πkpkj;
see Fig. 6.13.
1
2
j
m
...
...
π1p1j
p2j
pmj
πm
π2
pj j 
π j
Figure 6.13: Interpretation of the balance equations in terms of frequencies.
In a very large number of transitions, there will be a fraction πkpkj that bring
the state from k to j. (This also applies to transitions from j to itself, which
occur with frequency πjpjj.) The sum of the frequencies of such transitions is the
frequency πj of being at state j.
Birth-Death Processes
A birth-death process is a Markov chain in which the states are linearly ar-
ranged and transitions can only occur to a neighboring state, or else leave the
state unchanged. They arise in many contexts, especially in queueing theory.

22
Markov Chains
Chap. 6
Figure 6.14 shows the general structure of a birth-death process and also intro-
duces some generic notation for the transition probabilities. In particular,
bi = P(Xn+1 = i + 1 | Xn = i),
(“birth” probability at state i),
di = P(Xn+1 = i −1 | Xn = i),
(“death” probability at state i).
. . . 
m - 1
m
1 - dm
bm-2
0
1
b0
d1
1 - b1 - d1
1 - b0
b1
d2
dm-1
1 - bm-1  - dm-1
bm-1
dm
Figure 6.14: Transition probability graph for a birth-death process.
For a birth-death process, the balance equations can be substantially sim-
pliﬁed. Let us focus on two neighboring states, say, i and i+1. In any trajectory
of the Markov chain, a transition from i to i+1 has to be followed by a transition
from i + 1 to i, before another transition from i to i + 1 can occur. Therefore,
the frequency of transitions from i to i + 1, which is πibi, must be equal to the
frequency of transitions from i + 1 to i, which is πi+1di+1. This leads to the
local balance equations†
πibi = πi+1di+1,
i = 0, 1, . . . , m −1.
Using the local balance equations, we obtain
πi = π0 b0b1 · · · bi−1
d1d2 · · · di
,
i = 1, . . . , m.
Together with the normalization equation 
i πi = 1, the steady-state probabil-
ities πi are easily computed.
Example 6.9. (Random Walk with Reﬂecting Barriers)
A person walks
along a straight line and, at each time period, takes a step to the right with prob-
ability b, and a step to the left with probability 1 −b. The person starts in one of
† A more formal derivation that does not rely on the frequency interpretation
proceeds as follows. The balance equation at state 0 is π0(1 −b0) + π1d1 = π0, which
yields the ﬁrst local balance equation π0b0 = π1d1.
The balance equation at state 1 is π0b0 + π1(1 −b1 −d1) + π2d2 = π1. Using
the local balance equation π0b0 = π1d1 at the previous state, this is rewritten as
π1d1 + π1(1 −b1 −d1) + π2d2 = π1, which simpliﬁes to π1b1 = π2d2. We can then
continue similarly to obtain the local balance states at all other states.

Sec. 6.3
Steady-State Behavior
23
the positions 1, 2, . . . , m, but if he reaches position 0 (or position m + 1), his step is
instantly reﬂected back to position 1 (or position m, respectively). Equivalently, we
may assume that when the person is in positions 1 or m. he will stay in that position
with corresponding probability 1 −b and b, respectively.
We introduce a Markov
chain model whose states are the positions 1, . . . , m.
The transition probability
graph of the chain is given in Fig. 6.15.
2
1
. . . 
m - 1
m
b
1 - b
b
b
b
1 - b
1 - b
1 - b
1 - b
b
Figure 6.15: Transition probability graph for the random walk Example 6.9.
The local balance equations are
πib = πi+1(1 −b),
i = 1, . . . , m −1.
Thus, πi+1 = ρπi, where
ρ =
b
1 −b,
and we can express all the πj in terms of π1, as
πi = ρi−1π1,
i = 1, . . . , m.
Using the normalization equation 1 = π1 + · · · + πm, we obtain
1 = π1(1 + ρ + · · · + ρm−1)
which leads to
πi =
ρi−1
1 + ρ + · · · + ρm−1 ,
i = 1, . . . , m.
Note that if ρ = 1, then πi = 1/m for all i.
Example 6.10. (Birth-Death Markov Chains – Queueing)
Packets arrive
at a node of a communication network, where they are stored in a buﬀer and then
transmitted.
The storage capacity of the buﬀer is m: if m packets are already
present, any newly arriving packets are discarded. We discretize time in very small
periods, and we assume that in each period, at most one event can happen that
can change the number of packets stored in the node (an arrival of a new packet or
a completion of the transmission of an existing packet). In particular, we assume
that at each period, exactly one of the following occurs:

24
Markov Chains
Chap. 6
(a) one new packet arrives; this happens with a given probability b > 0;
(b) one existing packet completes transmission; this happens with a given prob-
ability d > 0 if there is at least one packet in the node, and with probability
0 otherwise;
(c) no new packet arrives and no existing packet completes transmission; this
happens with a probability 1−b−d if there is at least one packet in the node,
and with probability 1 −b otherwise.
We introduce a Markov chain with states 0, 1, . . . , m, corresponding to the
number of packets in the buﬀer.
The transition probability graph is given in
Fig. 6.16.
The local balance equations are
πib = πi+1d,
i = 0, 1, . . . , m −1.
We deﬁne
ρ = b
d,
and obtain πi+1 = ρπi, which leads to πi = ρiπ0 for all i. By using the normalization
equation 1 = π0 + π1 + · · · + πm, we obtain
1 = π0(1 + ρ + · · · + ρm),
and
π0 =



1 −ρ
1 −ρm+1
if ρ ̸= 1,
1
m + 1
if ρ = 1.
The steady-state probabilities are then given by
πi =





ρi(1 −ρ)
1 −ρm+1
if ρ ̸= 1,
1
m + 1
if ρ = 1,
i = 0, 1, . . . , m.
0
1
. . . 
m - 1
m
b
d
1 - b - d
1 - b
1 - d
b
b
b
d
d
d
1 - b - d
Figure 6.16: Transition probability graph in Example 6.10.

Sec. 6.4
Absorption Probabilities and Expected Time to Absorption
25
It is interesting to consider what happens when the buﬀer size m is so large
that it can be considered as practically inﬁnite. We distinguish two cases.
(a) Suppose that b < d, or ρ < 1.
In this case, arrivals of new packets are
less likely than departures of existing packets.
This prevents the number
of packets in the buﬀer from growing, and the steady-state probabilities πi
decrease with i. We observe that as m →∞, we have 1 −ρm+1 →1, and
πi →ρi(1 −ρ),
for all i.
We can view these as the steady-state probabilities in a system with an inﬁnite
buﬀer. [As a check, note that we have ∞
i=0 ρi(1 −ρ) = 1.]
(b) Suppose that b > d, or ρ > 1. In this case, arrivals of new packets are more
likely than departures of existing packets. The number of packets in the buﬀer
tends to increase, and the steady-state probabilities πi increase with i. As we
consider larger and larger buﬀer sizes m, the steady-state probability of any
ﬁxed state i decreases to zero:
πi →0,
for all i.
Were we to consider a system with an inﬁnite buﬀer, we would have a Markov
chain with a countably inﬁnite number of states. Although we do not have
the machinery to study such chains, the preceding calculation suggests that
every state will have zero steady-state probability and will be “transient.” The
number of packets in queue will generally grow to inﬁnity, and any particular
state will be visited only a ﬁnite number of times.
6.4
ABSORPTION PROBABILITIES AND EXPECTED TIME
TO ABSORPTION
In this section, we study the short-term behavior of Markov chains. We ﬁrst
consider the case where the Markov chain starts at a transient state. We are
interested in the ﬁrst recurrent state to be entered, as well as in the time until
this happens.
When focusing on such questions, the subsequent behavior of the Markov
chain (after a recurrent state is encountered) is immaterial. We can therefore
assume, without loss of generality, that every recurrent state k is absorbing,
i.e.,
pkk = 1,
pkj = 0 for all j ̸= k.
If there is a unique absorbing state k, its steady-state probability is 1 (because
all other states are transient and have zero steady-state probability), and will be
reached with probability 1, starting from any initial state. If there are multiple
absorbing states, the probability that one of them will be eventually reached is
still 1, but the identity of the absorbing state to be entered is random and the

26
Markov Chains
Chap. 6
associated probabilities may depend on the starting state. In the sequel, we ﬁx a
particular absorbing state, denoted by s, and consider the absorption probability
ai that s is eventually reached, starting from i:
ai = P(Xn eventually becomes equal to the absorbing state s | X0 = i).
Absorption probabilities can be obtained by solving a system of linear equations,
as indicated below.
Absorption Probability Equations
Consider a Markov chain in which each state is either transient or absorbing.
We ﬁx a particular absorbing state s. Then, the probabilities ai of eventually
reaching state s, starting from i, are the unique solution of the equations
as = 1,
ai = 0,
for all absorbing i ̸= s,
ai =
m

j=1
pijaj,
for all transient i.
The equations as = 1, and ai = 0, for all absorbing i ̸= s, are evident
from the deﬁnitions. To verify the remaining equations, we argue as follows. Let
us consider a transient state i and let A be the event that state s is eventually
reached. We have
ai = P(A | X0 = i)
=
m

j=1
P(A | X0 = i, X1 = j)P(X1 = j | X0 = i)
(total probability thm.)
=
m

j=1
P(A | X1 = j)pij
(Markov property)
=
m

j=1
ajpij.
The uniqueness property of the solution of the absorption probability equations
requires a separate argument, which is given in the theoretical problems section.
The next example illustrates how we can use the preceding method to
calculate the probability of entering a given recurrent class (rather than a given
absorbing state).
Example 6.11.
Consider the Markov chain shown in Fig. 6.17(a). We would
like to calculate the probability that the state eventually enters the recurrent class

Sec. 6.4
Absorption Probabilities and Expected Time to Absorption
27
{4, 5} starting from one of the transient states. For the purposes of this problem,
the possible transitions within the recurrent class {4, 5} are immaterial. We can
therefore lump the states in this recurrent class and treat them as a single absorbing
state (call it state 6); see Fig. 6.17(b). It then suﬃces to compute the probability
of eventually entering state 6 in this new chain.
1
1
2
3
4
5
1
0.3
0.4
0.2
0.3
0.5
1
0.3
0.7
1
2
3
6
0.3
0.4
0.2
0.8
1
(a)
(b)
0.2
0.1
0.1
0.2
Figure 6.17: (a) Transition probability graph in Example 6.11. (b) A new
graph in which states 4 and 5 have been lumped into the absorbing state
s = 6.
The absorption probabilities ai of eventually reaching state s = 6 starting
from state i, satisfy the following equations:
a2 = 0.2a1 + 0.3a2 + 0.4a3 + 0.1a6,
a3 = 0.2a2 + 0.8a6.
Using the facts a1 = 0 and a6 = 1, we obtain
a2 = 0.3a2 + 0.4a3 + 0.1,
a3 = 0.2a2 + 0.8.
This is a system of two equations in the two unknowns a2 and a3, which can be
readily solved to yield a2 = 21/31 and a3 = 29/31.
Example 6.12.
(Gambler’s Ruin)
A gambler wins $1 at each round, with
probability p, and loses $1, with probability 1 −p. Diﬀerent rounds are assumed

28
Markov Chains
Chap. 6
independent. The gambler plays continuously until he either accumulates a tar-
get amount of $m, or loses all his money. What is the probability of eventually
accumulating the target amount (winning) or of losing his fortune?
We introduce the Markov chain shown in Fig. 6.18 whose state i represents
the gambler’s wealth at the beginning of a round. The states i = 0 and i = m
correspond to losing and winning, respectively.
All states are transient, except for the winning and losing states which are
absorbing. Thus, the problem amounts to ﬁnding the probabilities of absorption
at each one of these two absorbing states. Of course, these absorption probabilities
depend on the initial state i.
0
4
p
3
1
2
1 - p
p
p
1 - p
1 - p
Win
Lose
Figure 6.18: Transition probability graph for the gambler’s ruin problem
(Example 6.12). Here m = 4.
Let us set s = 0 in which case the absorption probability ai is the probability
of losing, starting from state i. These probabilities satisfy
a0 = 1,
ai = (1 −p)ai−1 + pai+1,
i = 1, . . . , m −1,
am = 0.
These equations can be solved in a variety of ways. It turns out there is an elegant
method that leads to a nice closed form solution.
Let us write the equations for the ai as
(1 −p)(ai−1 −ai) = p(ai −ai+1),
i = 1, . . . , m −1.
Then, by denoting
δi = ai −ai+1,
i = 1, . . . , m −1,
and
ρ = 1 −p
p
,
the equations are written as
δi = ρδi−1,
i = 1, . . . , m −1,
from which we obtain
δi = ρiδ0,
i = 1, . . . , m −1.

Sec. 6.4
Absorption Probabilities and Expected Time to Absorption
29
This, together with the equation δ0 + δ1 + · · · + δm−1 = a0 −am = 1, implies that
(1 + ρ + · · · + ρm−1)δ0 = 1.
Thus, we have
δ0 =



1 −ρ
1 −ρm
if ρ ̸= 1,
1
m
if ρ = 1,
and, more generally,
δi =





ρi(1 −ρ)
1 −ρm
if ρ ̸= 1,
1
m
if ρ = 1.
From this relation, we can calculate the probabilities ai. If ρ ̸= 1, we have
ai = a0 −δi−1 −· · · −δ0
= 1 −(ρi−1 + · · · + ρ + 1)δ0
= 1 −1 −ρi
1 −ρ · 1 −ρ
1 −ρm ,
= 1 −1 −ρi
1 −ρm ,
and ﬁnally the probability of losing, starting from a fortune i, is
ai = ρi −ρm
1 −ρm ,
i = 1, . . . , m −1.
If ρ = 1, we similarly obtain
ai = m −i
m
.
The probability of winning, starting from a fortune i, is the complement 1−ai,
and is equal to
1 −ai =





1 −ρi
1 −ρm
if ρ ̸= 1,
i
m
if ρ = 1.
The solution reveals that if ρ > 1, which corresponds to p < 1/2 and unfa-
vorable odds for the gambler, the probability of losing approaches 1 as m →∞
regardless of the size of the initial fortune. This suggests that if you aim for a large
proﬁt under unfavorable odds, ﬁnancial ruin is almost certain.

30
Markov Chains
Chap. 6
Expected Time to Absorption
We now turn our attention to the expected number of steps until a recurrent
state is entered (an event that we refer to as “absorption”), starting from a
particular transient state.
For any state i, we denote
µi = E

number of transitions until absorption, starting from i

= E

min{n ≥0 | Xn is recurrent}
 X0 = i

.
If i is recurrent, this deﬁnition sets µi to zero.
We can derive equations for the µi by using the total expectation theorem.
We argue that the time to absorption starting from a transient state i is equal
to 1 plus the expected time to absorption starting from the next state, which
is j with probability pij. This leads to a system of linear equations which is
stated below. It turns out that these equations have a unique solution, but the
argument for establishing this fact is beyond our scope.
Equations for the Expected Time to Absorption
The expected times µi to absorption, starting from state i are the unique
solution of the equations
µi = 0,
for all recurrent states i,
µi = 1 +
m

j=1
pijµj,
for all transient states i.
Example 6.13. (Spiders and Fly) Consider the spiders-and-ﬂy model of Ex-
ample 6.2. This corresponds to the Markov chain shown in Fig. 6.19. The states
correspond to possible ﬂy positions, and the absorbing states 1 and m correspond
to capture by a spider.
Let us calculate the expected number of steps until the ﬂy is captured. We
have
µ1 = µm = 0,
and
µi = 1 + 0.3 · µi−1 + 0.4 · µi + 0.3 · µi+1,
for i = 2, . . . , m −1.
We can solve these equations in a variety of ways, such as for example by
successive substitution. As an illustration, let m = 4, in which case, the equations
reduce to
µ2 = 1 + 0.4 · µ2 + 0.3 · µ3,
µ3 = 1 + 0.3 · µ2 + 0.4 · µ3.

Sec. 6.4
Absorption Probabilities and Expected Time to Absorption
31
The ﬁrst equation yields µ2 = (1/0.6) + (1/2)µ3, which we can substitute in the
second equation and solve for µ3. We obtain µ3 = 10/3 and by substitution again,
µ2 = 10/3.
2
. . . 
m - 2
1
0.4
0.4
0.4
0.4
m - 1
0.3
0.3
0.3
0.3
0.3
0.3
0.3
0.3
1
3
m
1
0.3
Figure 6.19: Transition probability graph in Example 6.13.
Mean First Passage Times
The same idea used to calculate the expected time to absorption can be used to
calculate the expected time to reach a particular recurrent state, starting from
any other state. Throughout this subsection, we consider a Markov chain with
a single recurrent class. We focus on a special recurrent state s, and we denote
by ti the mean ﬁrst passage time from state i to state s, deﬁned by
ti = E

number of transitions to reach s for the ﬁrst time, starting from i

= E

min{n ≥0 | Xn = s}
 X0 = i

.
The transitions out of state s are irrelevant to the calculation of the mean
ﬁrst passage times. We may thus consider a new Markov chain which is identical
to the original, except that the special state s is converted into an absorbing
state (by setting pss = 1, and psj = 0 for all j ̸= s). We then compute ti as the
expected number of steps to absorption starting from i, using the formulas given
earlier in this section. We have
ti = 1 +
m

j=1
pijtj,
for all i ̸= s,
ts = 0.
This system of linear equations can be solved for the unknowns ti, and is known
to have a unique solution.
The above equations give the expected time to reach the special state s
starting from any other state. We may also want to calculate the mean recur-
rence time of the special state s, which is deﬁned as
t∗s = E[number of transitions up to the ﬁrst return to s, starting from s]
= E

min{n > 1 | Xn = s}
 X0 = s

.

32
Markov Chains
Chap. 6
We can obtain t∗s, once we have the ﬁrst passage times ti, by using the equation
t∗s = 1 +
m

j=1
psjtj.
To justify this equation, we argue that the time to return to s, starting from s,
is equal to 1 plus the expected time to reach s from the next state, which is j
with probability psj. We then apply the total expectation theorem.
Example 6.14.
Consider the “up-to-date”–“behind” model of Example 6.1.
States 1 and 2 correspond to being up-to-date and being behind, respectively, and
the transition probabilities are
p11 = 0.8,
p12 = 0.2,
p21 = 0.6,
p22 = 0.4.
Let us focus on state s = 1 and calculate the mean ﬁrst passage time to state 1,
starting from state 2. We have t1 = 0 and
t2 = 1 + p21t1 + p22t2 = 1 + 0.4 · t2,
from which
t2 =
1
0.6 = 5
3.
The mean recurrence time to state 1 is given by
t∗
1 = 1 + p11t1 + p12t2 = 1 + 0 + 0.2 · 5
3 = 4
3.
Summary of Facts About Mean First Passage Times
Consider a Markov chain with a single recurrent class, and let s be a par-
ticular recurrent state.
• The mean ﬁrst passage times ti to reach state s starting from i, are
the unique solution to the system of equations
ts = 0,
ti = 1 +
m

j=1
pijtj,
for all i ̸= s.
• The mean recurrence time t∗s of state s is given by
t∗s = 1 +
m

j=1
psjtj.

Sec. 6.5
More General Markov Chains
33
6.5
MORE GENERAL MARKOV CHAINS
The discrete-time, ﬁnite-state Markov chain model that we have considered so
far is the simplest example of an important Markov process. In this section,
we brieﬂy discuss some generalizations that involve either a countably inﬁnite
number of states or a continuous time, or both. A detailed theoretical develop-
ment for these types of models is beyond our scope, so we just discuss their main
underlying ideas, relying primarily on examples.
Chains with Countably Inﬁnite Number of States
Consider a Markov process {X1, X2, . . .} whose state can take any positive inte-
ger value. The transition probabilities
pij = P(Xn+1 = j | Xn = i),
i, j = 1, 2, . . .
are given, and can be used to represent the process with a transition probability
graph that has an inﬁnite number of nodes, corresponding to the integers 1, 2, . . .
It is straightforward to verify, using the total probability theorem in a
similar way as in Section 6.1, that the n-step transition probabilities
rij(n) = P(Xn = j | X0 = i),
i, j = 1, 2, . . .
satisfy the Chapman-Kolmogorov equations
rij(n + 1) =
∞

k=1
rik(n)pkj,
i, j = 1, 2, . . .
Furthermore, if the rij(n) converge to steady-state values πj as n →∞, then by
taking limit in the preceding equation, we obtain
πj =
∞

k=1
πkpkj,
i, j = 1, 2, . . .
These are the balance equations for a Markov chain with states 1, 2, . . .
It is important to have conditions guaranteeing that the rij(n) indeed con-
verge to steady-state values πj as n →∞. As we can expect from the ﬁnite-state
case, such conditions should include some analog of the requirement that there
is a single recurrent class that is aperiodic. Indeed, we require that:
(a) each state is accessible from every other state;
(b) the set of all states is aperiodic in the sense that there is no d > 1 such
that the states can be grouped in d > 1 disjoint subsets S1, . . . , Sd so that
all transitions from one subset lead to the next subset.

34
Markov Chains
Chap. 6
These conditions are suﬃcient to guarantee the convergence to a steady-state
lim
n→∞rij(n) = πj,
i, j = 1, 2, . . .
but something peculiar may also happen here, which is not possible if the number
of states is ﬁnite: the limits πj may not add to 1, so that (π1, π2, . . .) may not
be a probability distribution. In fact, we can prove the following theorem (the
proof is beyond our scope).
Steady-State Convergence Theorem
Under the above accessibility and aperiodicity assumptions (a) and (b),
there are only two possibilities:
(1) The rij(n) converge to a steady state probability distribution (π1, π2, . . .).
In this case the πj uniquely solve the balance equations together with
the normalization equation π1 + π2 + · · · = 1. Furthermore, the πj
have an expected frequency interpretation:
πj = lim
n→∞
vij(n)
n
,
where vij(n) is the expected number of visits to state j within the ﬁrst
n transitions, starting from state i.
(2) All the rij(n) converge to 0 as n →∞and the balance equations have
no solution, other than πj = 0 for all j.
For an example of possibility (2) above, consider the packet queueing sys-
tem of Example 6.10 for the case where the probability b of a packet arrival in
each period is larger than the probability d of a departure. Then, as we saw
in that example, as the buﬀer size m increases, the size of the queue will tend
to increase without bound, and the steady-state probability of any one state
will tend to 0 as m →∞. In eﬀect, with inﬁnite buﬀer space, the system is
“unstable” when b > d, and all states are “transient.”
An important consequence of the steady-state convergence theorem is that
if we can ﬁnd a probability distribution (π1, π2, . . .) that solves the balance equa-
tions, then we can be sure that it is the steady-state distribution. This line of
argument is very useful in queueing systems as illustrated in the following two
examples.
Example 6.15. (Queueing with Inﬁnite Buﬀer Space) Consider, as in Ex-
ample 6.10, a communication node, where packets arrive and are stored in a buﬀer
before getting transmitted. We assume that the node can store an inﬁnite number

Sec. 6.5
More General Markov Chains
35
of packets. We discretize time in very small periods, and we assume that in each
period, one of the following occurs:
(a) one new packet arrives; this happens with a given probability b > 0;
(b) one existing packet completes transmission; this happens with a given prob-
ability d > 0 if there is at least one packet in the node, and with probability
0 otherwise;
(c) no new packet arrives and no existing packet completes transmission; this
happens with a probability 1−b−d if there is at least one packet in the node,
and with probability 1 −b otherwise.
. . . 
b
d
0
1
. . . 
m - 1
m
b
d
1 - b - d
1 - b
b
b
b
d
d
d
1 - b - d
1 - b - d
Figure 6.20: Transition probability graph in Example 6.15.
We introduce a Markov chain with states are 0, 1, . . ., corresponding to the
number of packets in the buﬀer.
The transition probability graph is given in
Fig. 6.20. As in the case of a ﬁnite number of states, the local balance equations
are
πib = πi+1d,
i = 0, 1, . . . ,
and we obtain πi+1 = ρπi, where ρ = b/d. Thus, we have πi = ρiπ0 for all i. If
ρ < 1, the normalization equation 1 = ∞
i=0 πi yields
1 = π0
∞

i=0
ρi =
π0
1 −ρ,
in which case π0 = 1 −ρ, and the steady-state probabilities are
πi = ρi(1 −ρ),
i = 0, 1, . . .
If ρ ≥1, which corresponds to the case where the arrival probability b is no less
than the departure probability d, the normalization equation 1 = π0(1+ρ+ρ2+· · ·)
implies that π0 = 0, and also πi = ρiπ0 = 0 for all i.
Example 6.16. (The M/G/1 Queue) Packets arrive at a node of a communi-
cation network, where they are stored at an inﬁnite capacity buﬀer and are then
transmitted one at a time. The arrival process of the packets is Poissson with rate

36
Markov Chains
Chap. 6
λ, and the transmission time of a packet has a given CDF. Furthermore, the trans-
mission times of diﬀerent packets are independent and are also independent from
all the interarrival times of the arrival process.
This queueing system is known as the M/G/1 system. With changes in ter-
minology, it applies to many diﬀerent practical contexts where “service” is provided
to “arriving customers,” such as in communication, transportation, and manufac-
turing, among others. The name M/G/1 is an example of shorthand terminology
from queueing theory, whereby the ﬁrst letter (M in this case) characterizes the
customer arrival process (Poisson in this case), the second letter (G in this case)
characterizes the distribution of the service time of the queue (general in this case),
and the number (1 in this case) characterizes the number of customers that can be
simultaneously served.
To model this system as a discrete-time Markov chain, we focus on the time
instants when a packet completes transmission and departs from the system. We
denote by Xn the number of packets in the system just after the nth customer’s
departure. We have
Xn+1 =

 Xn −1 + Sn
if Xn > 0,
Sn
if Xn = 0,
where Sn is the number of packet arrivals during the (n+1)st packet’s transmission.
In view of the Poisson assumption, the random variables S1, S2, . . . are independent
and their PMF can be calculated using the given CDF of the transmission time,
and the fact that in an interval of length r, the number of packet arrivals is Poisson-
distributed with parameter λr. In particular, let us denote
αk = P(Sn = k),
k = 0, 1, . . . ,
and let us assume that if the transmission time R of a packet is a discrete random
variable taking the values r1, . . . , rm with probabilities p1, . . . , pm. Then, we have
for all k ≥0,
αk =
m

j=1
pj e−λrj(λrj)k
k!
,
while if R is a continuous random variable with PDF fR(r), we have for all k ≥0,
αk =
 ∞
r=0
P(Sn = k | R = r)fR(r) dr =
 ∞
r=0
e−λr(λr)k
k!
fR(r) dr.
The probabilities αk deﬁne in turn the transition probabilities of the Markov chain
{Xn}, as follows (see Fig. 6.21):
pij =
 αj
if i = 0 and j > 0,
αj−i+1
if i > 0 and j ≥i −1,
0
otherwise.
Clearly, this Markov chain satisﬁes the accessibility and aperiodicity condi-
tions that guarantee steady-state convergence. There are two possibilities: either
(π0, π1, . . .) form a probability distribution, or else πj > 0 for all j. We will clarify

Sec. 6.5
More General Markov Chains
37
0
1
. . . 
α0
2
3
α0
α1
α1
α1
α0
α0
α1
α2
α2
α2
α3
α3
Figure 6.21: Transition probability graph for the number of packets left
behind by a packet completing transmission in the M/G/1 queue (Example
6.16).
the conditions under which each of these cases holds, and we will also calculate the
transform M(s) (when it exists) of the steady-state distribution (π0, π1, . . .):
M(s) =
∞

j=0
πjesj.
For this purpose, we will use the transform of the PMF {αk}:
A(s) =
∞

j=0
αjesj.
Indeed, let us multiply the balance equations
πj = π0αj +
j+1

i=1
πiαj−i+1,
with esj and add over all j. We obtain
M(s) =
∞

j=0
π0αjesj +
∞

j=0
j+1

i=1
πiαj−i+1

esj
= A(s) +
∞

i=1
πies(i−1)
∞

j=i−1
αj−i+1es(j−i+1)
= A(s) + A(s)
es
∞

i=1
πiesi
= A(s) +
A(s)
M(s) −π0

es
,
or
M(s) = (es −1)π0A(s)
es −A(s)
.

38
Markov Chains
Chap. 6
To calculate π0, we take the limit as s →0 in the above formula, and we use the
fact M(0) = 1 when {πj} is a probability distribution. We obtain, using the fact
A(0) = 1 and L’Hospital’s rule,
1 = lim
s→0
(es −1)π0A(s)
es −A(s)
=
π0
1−
dA(s)/ds
s=0
=
π0
1 −E[N],
where E[N] = ∞
j=0 jαj is the expected value of the number N of packet arrivals
within a packet’s transmission time. Using the iterated expectations formula, we
have
E[N] = λE[R],
where E[R] is the expected value of the transmission time. Thus,
π0 = 1 −λE[R],
and the transform of the steady-state distribution {πj} is
M(s) =
(es −1)
1 −λE[R]
A(s)
es −A(s)
.
For the above calculation to be correct, we must have E[N] < 1, i.e., packets should
arrive at a rate that is smaller than the transmission rate of the node. If this is not
true, the system is not “stable” and there is no steady-state distribution, i.e., the
only solution of the balance equations is πj = 0 for all j.
Let us ﬁnally note that we have introduced the πj as the steady-state prob-
ability that j packets are left behind in the system by a packet upon completing
transmission. However, it turns out that πj is also equal to the steady-state prob-
ability of j packets found in the system by an observer that looks at the system at
a “typical” time far into the future. This is discussed in the theoretical problems,
but to get an idea of the underlying reason, note that for each time the number of
packets in the system increases from n to n + 1 due to an arrival, there will be a
corresponding future decrease from n + 1 to n due to a departure. Therefore, in
the long run, the frequency of transitions from n to n + 1 is equal to the frequency
of transitions from n + 1 to n.
Therefore, in steady-state, the system appears
statistically identical to an arriving and to a departing packet. Now, because the
packet interarrival times are independent and exponentially distributed, the times
of packet arrivals are “typical” and do not depend on the number of packets in
the system. With some care this argument can be made precise, and shows that
at the times when packets complete their transmissions and depart, the system is
“typically loaded.”
Continuous-Time Markov Chains
We have implicitly assumed so far that the transitions between states take unit
time. When the time between transitions takes values from a continuous range,
some new questions arise. For example, what is the proportion of time that the

Sec. 6.5
More General Markov Chains
39
system spends at a particular state (as opposed to the frequency of visits into
the state)?
Let the states be denoted by 1, 2, . . ., and let us assume that state tran-
sitions occur at discrete times, but the time from one transition to the next is
random. In particular, we assume that:
(a) If the current state is i, the next state will be j with a given probability
pij.
(b) The time interval ∆i between the transition to state i and the transition
to the next state is exponentially distributed with a given parameter νi:
P(∆i ≤δ | current state is i) ≤1 −e−νiδ.
Furthermore, ∆i is independent of earlier transition times and states.
The parameter νi is referred to as the transition rate associated with state
i. Since the expected transition time is
E[∆i] =
 ∞
0
δνie−νiδdδ = 1
νi
,
we can interpret νi as the average number of transitions per unit time. We may
also view
qij = pijνi
as the rate at which the process makes a transition to j when at state i. Con-
sequently, we call qij the transition rate from i to j.
Note that given the
transition rates qij, one can obtain the node transition rates using the formula
νi = ∞
j=1 qij.
The state of the chain at time t ≥0 is denoted by X(t), and stays constant
between transitions. Let us recall the memoryless property of the exponential
distribution, which in our context implies that, for any time t between the kth
and (k + 1)st transition times tk and tk+1, the additional time tk+1 −t needed
to eﬀect the next transition is independent of the time t −tk that the system
has been in the current state. This implies the Markov character of the process,
i.e., that at any time t, the future of the process, [the random variables X(t) for
t > t] depend on the past of the process [the values of the random variables X(t)
for t ≤t] only through the present value of X(t).
Example 6.17. (The M/M/1 Queue) Packets arrive at a node of a communi-
cation network according to a Poissson process with rate λ. The packets are stored
at an inﬁnite capacity buﬀer and are then transmitted one at a time. The trans-
mission time of a packet is exponentially distributed with parameter µ, and the
transmission times of diﬀerent packets are independent and are also independent
from all the interarrival times of the arrival process. Thus, this queueing system is
identical to the special case of the M/G/1 system, where the transmission times are
exponentially distributed (this is indicated by the second M inthe M/M/1 name).

40
Markov Chains
Chap. 6
We will model this system using a continuous-time process with state X(t)
equal to the number of packets in the system at time t [if X(t) > 0, then X(t) −1
packets are waiting in the queue and one packet is under transmission]. The state
increases by one when a new packet arrives and decreases by one when an existing
packet departs. To show that this process is a continuous-time Markov chain, let
us identify the transition rates νi and qij at each state i.
Consider ﬁrst the case where at some time t, the system becomes empty,
i.e., the state becomes equal to 0. Then the next transition will occur at the next
arrival, which will happen in time that is exponentially distributed with parameter
λ. Thus at state 0, we have the transition rates
q0j =

 λ
if j = 1,
0
otherwise.
Consider next the case of a positive state i, and suppose that a transition oc-
curs at some time t to X(t) = i. If the next transition occurs at time t+∆i, then ∆i
is the minimum of two exponentially distributed random variables: the time to the
next arrival, call it Y, which has parameter λ, and the time to the next departure,
call it Z, which has parameter µ. (We are again using here the memoryless property
of the exponential distribution.) Thus according to Example 5.15, which deals with
“competing exponentials,” the time ∆i is exponentially distributed with parameter
νi = λ + µ. Furthermore, the probability that the next transition corresponds to
an arrival is
P(Y ≤Z) =

y≤z
λe−λy · µeµz dy dz
= λµ
 ∞
0
e−λy
 ∞
y
eµz dz

dy
= λµ
 ∞
0
e−λy

e−µy
µ

dy
= λ
 ∞
0
e−(λ+µ)y dy
=
λ
λ + µ.
We thus have for i > 0, qi,i+1 = νiP(Y ≤Z) = (λ + µ)
λ/(λ + µ)
= λ. Similarly,
we obtain that the probability that the next transition corresponds to a departure
is µ/(λ + µ), and we have qi,i−1 = νiP(Y ≥Z) = (λ + µ)
µ/(λ + µ)
= µ. Thus
qij =
 λ
if j = i + 1,
µ
if j = i −1,
0
otherwise.
The positive transition rates qij are recorded next to the arcs (i, j) of the transition
diagram, as in Fig. 6.22.
We will be interested in chains for which the discrete-time Markov chain
corresponding to the transition probabilities pij satisﬁes the accessibility and

Sec. 6.5
More General Markov Chains
41
. . . 
0
1
. . . 
m - 1
m
λ
µ
λ
λ
λ
λ
µ
µ
µ
µ
Figure 6.22: Transition graph for the M/M/1 queue (Example 6.17).
aperiodicity assumptions of the preceding section. We also require a technical
condition, namely that the number of transitions in any ﬁnite length of time
is ﬁnite with probability one.
Almost all models of practical use satisfy this
condition, although it is possible to construct examples that do not.
Under the preceding conditions, it can be shown that the limit
πj = lim
t→∞P

X(t) = j | X(0) = i

exists and is independent of the initial state i. We refer to πj as the steady-state
probability of state j. It can be shown that if Tj(t) is the expected value of the
time spent in state j up to time t, then, regardless of the initial state, we have
πj = lim
t→∞
Tj(t)
t
that is, πj can be viewed as the long-term proportion of time the process spends
in state j.
The balance equations for a continuous-time Markov chain take the form
pj
∞

i=0
qji =
∞

i=0
piqij,
j = 0, 1, . . .
Similar to discrete-time Markov chains, it can be shown that there are two
possibilities:
(1) The steady-state probabilities are all positive and solve uniquely the bal-
ance equations together with the normalization equation π1 + π2 + · · · = 1.
(2) The steady-state probabilities are all zero.
To interpret the balance equations, we note that since πi is the proportion
of time the process spends in state i, it follows that πiqij can be viewed as
frequency of transitions from i to j (expected number of transitions from i to
j per unit time). It is seen therefore that the balance equations express the
intuitive fact that the frequency of transitions out of state j (the left side term
πj
∞
i=1 qji) is equal to the frequency of transitions into state j (the right side
term ∞
i=0 πiqij).
The continuous-time analog of the local balance equations for discrete-time
chains is
πjqji = πiqij,
i, j = 1, 2, . . .

42
Markov Chains
Chap. 6
These equations hold in birth-death systems where qij = 0 for |i −j| > 1, but
need not hold in other types of Markov chains. They express the fact that the
frequencies of transitions from i to j and from j to i are equal.
To understand the relationship between the balance equations for continuous-
time chains and the balance equations for discrete-time chains, consider any
δ > 0, and the discrete-time Markov chain {Zn | n ≥0}, where
Zn = X(nδ),
n = 0, 1, . . .
The steady-state distribution of {Zn} is clearly {πj | j ≥0}, the steady-state
distribution of the continuous chain. The transition probabilities of {Zn | n ≥0}
can be derived by using the properties of the exponential distribution. We obtain
pij = δqij + o(δ),
i ̸= j,
pjj = 1 −δ
∞

i=0
i̸=j
qji + o(δ)
Using these expressions, the balance equations
πj =
∞

i=0
πi pij
j ≥0
for the discrete-time chain {Zn}, we obtain
πj =
∞

i=0
πipij = pj

1 −δ
∞

i=0
i̸=j
qji + o(δ)

+

i=0
i̸=j
pi

δqij + o(δ)

.
Taking the limit as δ →0, we obtain the balance equations for the continuous-
time chain.
Example 6.18. (The M/M/1 Queue – Continued) As in the case of a ﬁnite
number of states, the local balance equations are
πiλ = πi+1µ,
i = 0, 1, . . . ,
and we obtain πi+1 = ρπi, where ρ = λ/µ. Thus, we have πi = ρiπ0 for all i. If
ρ < 1, the normalization equation 1 = ∞
i=0 πi yields
1 = π0
∞

i=0
ρi =
π0
1 −ρ,
in which case π0 = 1 −ρ, and the steady-state probabilities are
πi = ρi(1 −ρ),
i = 0, 1, . . .

Sec. 6.5
More General Markov Chains
43
If ρ ≥1, which corresponds to the case where the arrival probability b is no less
than the departure probability d, the normalization equation 1 = π0(1+ρ+ρ2+· · ·)
implies that π0 = 0, and also πi = ρiπ0 = 0 for all i.
Example 6.19. (The M/M/m and M/M/∞Queues) The M/M/m queueing
system is identical to the M/M/1 system except that m packets can be simul-
taneously transmitted (i.e., the transmission line of the node has m transmission
channels).
A packet at the head of the queue is routed to any channel that is
available. The corresponding state transition diagram is shown in Fig. 6.24.
. . . 
λ
mµ
0
1
. . . 
m - 1
m
λ
µ
λ
λ
λ
2µ
(m - 1)µ
mµ
mµ
m+1
λ
Figure 6.24: Transition graph for the M/M/m queue (Example 6.19).
By writing down the local balance equations for the steady-state probabilities
πn, we obtain
λπn−1 =

 nµπn
if n ≤m,
mµπn
if n > m.
From these equations, we obtain
πn =









p0 (mρ)n
n!
, n ≤m
p0 mmρn
m!
, n > m
where ρ is given by
ρ =
λ
mµ.
Assuming ρ < 1, we can calculate π0 using the above equations and the condition
∞
n=0 πn = 1. We obtain
π0 =

1 +
m−1

n=1
(mρ)n
n!
+
∞

n=m
(mρ)n
m!
1
mn−m
−1
and, ﬁnally,
π0 =
m−1

n=0
(mρ)n
n!
+
(mρ)m
m!(1 −ρ)
−1
.

44
Markov Chains
Chap. 6
In the limiting case where m = ∞in the M/M/m system (which is called
the M/M/∞system), the local balance equations become
λπn−1 = nµπn,
n = 1, 2, . . .
so
πn = π0

λ
µ
n 1
n!,
n = 1, 2, . . .
From the condition ∞
n=0 πn = 1, we obtain
π0 =

1 +
∞

n=1

λ
µ
n 1
n!
−1
= e−λ/µ,
so, ﬁnally,
πn =

λ
µ
n e−λ/µ
n!
,
n = 0, 1, . . .
Therefore, in steady-state, the number in the system is Poisson distributed with
parameter λ/µ.

7
Limit Theorems
Contents
7.1. Some Useful Inequalities . . . . . . . . . . . . . . . . . . p. 3
7.2. The Weak Law of Large Numbers . . . . . . . . . . . . . . p. 5
7.3. Convergence in Probability . . . . . . . . . . . . . . . . . p. 7
7.4. The Central Limit Theorem
. . . . . . . . . . . . . . . . p. 9
7.5. The Strong Law of Large Numbers
. . . . . . . . . . . .
p. 16
1

2
Limit Theorems
Chap. 7
Consider a sequence X1, X2, . . . of independent identically distributed random
variables with mean µ and variance σ2. Let
Sn = X1 + · · · + Xn
be the sum of the ﬁrst n of them. Limit theorems are mostly concerned with the
properties of Sn and related random variables, as n becomes very large.
Because of independence, we have
var(Sn) = var(X1) + · · · + var(Xn) = nσ2.
Thus, the distribution of Sn spreads out as n increases, and does not have a
meaningful limit. The situation is diﬀerent if we consider the sample mean
Mn = X1 + · · · + Xn
n
= Sn
n .
A quick calculation yields
E[Mn] = µ,
var(Mn) = σ2
n .
In particular, the variance of Mn decreases to zero as n increases, and the bulk of
its distribution must be very close to the mean µ. This phenomenon is the subject
of certain laws of large numbers, which generally assert that the sample mean
Mn (a random variable) converges to the true mean µ (a number), in a precise
sense. These laws provide a mathematical basis for the loose interpretation of an
expectation E[X] = µ as the average of a large number of independent samples
drawn from the distribution of X.
We will also consider a quantity which is intermediate between Sn and Mn.
We ﬁrst subtract nµ from Sn, to obtain the zero-mean random variable Sn −nµ
and then divide by σ√n, to obtain
Zn = Sn −nµ
σ√n
.
It can be veriﬁed (see Section 7.4) that
E[Zn] = 0,
var(Zn) = 1.
Since the mean and the variance of Zn remain unchanged as n increases, its
distribution neither spreads, nor shrinks to a point. The central limit theorem
is concerned with the asymptotic shape of the distribution of Zn and asserts that
it becomes the standard normal distribution.
Limit theorems are useful for several reasons:
(a) Conceptually, they provide an interpretation of expectations (as well as
probabilities) in terms of a long sequence of identical independent experi-
ments.
(b) They allow for an approximate analysis of the properties of random vari-
ables such as Sn. This is to be contrasted with an exact analysis which
would require a formula for the PMF or PDF of Sn, a complicated and
tedious task when n is large.

Sec. 7.1
Some Useful Inequalities
3
7.1
SOME USEFUL INEQUALITIES
In this section, we derive some important inequalities. These inequalities use the
mean, and possibly the variance, of a random variable to draw conclusions on
the probabilities of certain events. They are primarily useful in situations where
the mean and variance of a random variable X are easily computable, but the
distribution of X is either unavailable or hard to calculate.
We ﬁrst present the Markov inequality. Loosely speaking it asserts that
if a nonnegative random variable has a small mean, then the probability that it
takes a large value must also be small.
Markov Inequality
If a random variable X can only take nonnegative values, then
P(X ≥a) ≤E[X]
a
,
for all a > 0.
To justify the Markov inequality, let us ﬁx a positive number a and consider
the random variable Ya deﬁned by
Ya =

0,
if X < a,
a,
if X ≥a.
It is seen that the relation
Ya ≤X
always holds and therefore,
E[Ya] ≤E[X].
On the other hand,
E[Ya] = aP(Ya = a) = aP(X ≥a),
from which we obtain
aP(X ≥a) ≤E[X].
Example 7.1.
Let X be uniformly distributed on the interval [0, 4] and note that
E[X] = 2. Then, the Markov inequality asserts that
P(X ≥2) ≤2
2 = 1,
P(X ≥3) ≤2
3 = 0.67,
P(X ≥4) ≤2
4 = 0.5.

4
Limit Theorems
Chap. 7
By comparing with the exact probabilities
P(X ≥2) = 0.5,
P(X ≥3) = 0.25,
P(X ≥4) = 0,
we see that the bounds provided by the Markov inequality can be quite loose.
We continue with the Chebyshev inequality. Loosely speaking, it asserts
that if the variance of a random variable is small, then the probability that it
takes a value far from its mean is also small. Note that the Chebyshev inequality
does not require the random variable to be nonnegative.
Chebyshev Inequality
If X is a random variable with mean µ and variance σ2, then
P

|X −µ| ≥c

≤σ2
c2 ,
for all c > 0.
To justify the Chebyshev inequality, we consider the nonnegative random
variable (X −µ)2 and apply the Markov inequality with a = c2. We obtain
P

(X −µ)2 ≥c2
≤E

(X −µ)2
c2
= σ2
c2 .
The derivation is completed by observing that the event (X−µ)2 ≥c2 is identical
to the event |X −µ| ≥c and
P

|X −µ| ≥c

= P

(X −µ)2 ≥c2
≤σ2
c2 .
An alternative form of the Chebyshev inequality is obtained by letting
c = kσ, where k is positive, which yields
P

|X −µ| ≥kσ

≤
σ2
k2σ2 = 1
k2 .
Thus, the probability that a random variable takes a value more than k standard
deviations away from its mean is at most 1/k2.
The Chebyshev inequality is generally more powerful than the Markov in-
equality (the bounds that it provides are more accurate), because it also makes
use of information on the variance of X. Still, the mean and the variance of
a random variable are only a rough summary of the properties of its distribu-
tion, and we cannot expect the bounds to be close approximations of the exact
probabilities.

Sec. 7.2
The Weak Law of Large Numbers
5
Example 7.2.
As in Example 7.1, let X be uniformly distributed on [0, 4]. Let
us use the Chebyshev inequality to bound the probability that |X −2| ≥1. We
have σ2 = 16/12 = 4/3, and
P
|X −2| ≥1
≤4
3,
which is not particularly informative.
For another example, let X be exponentially distributed with parameter λ =
1, so that E[X] = var(X) = 1. For c > 1, using Chebyshev’s inequality, we obtain
P(X ≥c) = P(X −1 ≥c −1) ≤P
|X −1| ≥c −1) ≤
1
(c −1)2 .
This is again conservative compared to the exact answer P(X ≥c) = e−c.
7.2
THE WEAK LAW OF LARGE NUMBERS
The weak law of large numbers asserts that the sample mean of a large number
of independent identically distributed random variables is very close to the true
mean, with high probability.
As in the introduction to this chapter, we consider a sequence X1, X2, . . . of
independent identically distributed random variables with mean µ and variance
σ2, and deﬁne the sample mean by
Mn = X1 + · · · + Xn
n
.
We have
E[Mn] = E[X1] + · · · + E[Xn]
n
= nµ
n = µ,
and, using independence,
var(Mn) = var(X1 + · · · + Xn)
n2
= var(X1) + · · · + var(Xn)
n2
= nσ2
n2 = σ2
n .
We apply Chebyshev’s inequality and obtain
P

|Mn −µ| ≥ϵ

≤σ2
nϵ2 ,
for any ϵ > 0.
We observe that for any ﬁxed ϵ > 0, the right-hand side of this inequality goes to
zero as n increases. As a consequence, we obtain the weak law of large numbers,
which is stated below. It turns out that this law remains true even if the Xi

6
Limit Theorems
Chap. 7
have inﬁnite variance, but a much more elaborate argument is needed, which we
omit. The only assumption needed is that E[Xi] is well-deﬁned and ﬁnite.
The Weak Law of Large Numbers (WLLN)
Let X1, X2, . . . be independent identically distributed random variables with
mean µ. For every ϵ > 0, we have
P

|Mn −µ| ≥ϵ

= P

X1 + · · · + Xn
n
−µ
 ≥ϵ

→0,
as n →∞.
The WLLN states that for large n, the “bulk” of the distribution of Mn is
concentrated near µ. That is, if we consider a positive length interval [µ−ϵ, µ+ϵ]
around µ, then there is high probability that Mn will fall in that interval; as
n →∞, this probability converges to 1. Of course, if ϵ is very small, we may
have to wait longer (i.e., need a larger value of n) before we can assert that Mn
is highly likely to fall in that interval.
Example 7.3. Probabilities and Frequencies.
Consider an event A deﬁned
in the context of some probabilistic experiment. Let p = P(A) be the probability of
that event. We consider n independent repetitions of the experiment, and let Mn
be the fraction of time that event A occurred; in this context, Mn is often called
the empirical frequency of A. Note that
Mn = X1 + · · · + Xn
n
,
where Xi is 1 whenever A occurs, and 0 otherwise; in particular, E[Xi] = p. The
weak law applies and shows that when n is large, the empirical frequency is most
likely to be within ϵ of p. Loosely speaking, this allows us to say that empirical fre-
quencies are faithful estimates of p. Alternatively, this is a step towards interpreting
the probability p as the frequency of occurrence of A.
Example 7.4. Polling.
Let p be the fraction of voters who support a particular
candidate for oﬃce.
We interview n “randomly selected” voters and record the
fraction Mn of them that support the candidate. We view Mn as our estimate of p
and would like to investigate its properties.
We interpret “randomly selected” to mean that the n voters are chosen in-
dependently and uniformly from the given population.
Thus, the reply of each
person interviewed can be viewed as an independent Bernoulli trial Xi with success
probability p and variance σ2 = p(1 −p). The Chebyshev inequality yields
P
|Mn −p| ≥ϵ
≤p(1 −p)
nϵ2
.

Sec. 7.3
Convergence in Probability
7
The true value of the parameter p is assumed to be unknown. On the other hand,
it is easily veriﬁed that p(1 −p) ≤1/4, which yields
P
|Mn −p| ≥ϵ
≤
1
4nϵ2 .
For example, if ϵ = 0.1 and n = 100, we obtain
P
|M100 −p| ≥0.1
≤
1
4 · 100 · (0.1)2 = 0.25.
In words, with a sample size of n = 100, the probability that our estimate is wrong
by more than 0.1 is no larger than 0.25.
Suppose now that we impose some tight speciﬁcations on our poll. We would
like to have high conﬁdence (probability at least 95%) that our estimate will be
very accurate (within .01 of p). How many voters should be sampled?
The only guarantee that we have at this point is the inequality
P
|Mn −p| ≥0.01
≤
1
4n(0.01)2 .
We will be sure to satisfy the above speciﬁcations if we choose n large enough so
that
1
4n(0.01)2 ≤1 −0.95 = 0.05,
which yields n ≥50, 000. This choice of n has the speciﬁed properties but is actually
fairly conservative, because it is based on the rather loose Chebyshev inequality. A
reﬁnement will be considered in Section 7.4.
7.3
CONVERGENCE IN PROBABILITY
We can interpret the WLLN as stating that “Mn converges to µ.” However,
since M1, M2, . . . is a sequence of random variables, not a sequence of numbers,
the meaning of convergence has to be made precise.
A particular deﬁnition
is provided below.
To facilitate the comparison with the ordinary notion of
convergence, we also include the deﬁnition of the latter.
Convergence of a Deterministic Sequence
Let a1, a2, . . . be a sequence of real numbers, and let a be another real
number. We say that the sequence an converges to a, or limn→∞an = a, if
for every ϵ > 0 there exists some n0 such that
|an −a| ≤ϵ,
for all n ≥n0.

8
Limit Theorems
Chap. 7
Intuitively, for any given accuracy level ϵ, an must be within ϵ of a, when
n is large enough.
Convergence in Probability
Let Y1, Y2, . . . be a sequence of random variables (not necessarily indepen-
dent), and let a be a real number. We say that the sequence Yn converges
to a in probability, if for every ϵ > 0, we have
lim
n→∞P

|Yn −a| ≥ϵ

= 0.
Given this deﬁnition, the WLLN simply says that the sample mean con-
verges in probability to the true mean µ.
If the random variables Y1, Y2, . . . have a PMF or a PDF and converge in
probability to a, then according to the above deﬁnition, “almost all” of the PMF
or PDF of Yn is concentrated to within a an ϵ-interval around a for large values
of n. It is also instructive to rephrase the above deﬁnition as follows: for every
ϵ > 0, and for every δ > 0, there exists some n0 such that
P

|Yn −a| ≥ϵ

≤δ,
for all n ≥n0.
If we refer to ϵ as the accuracy level, and δ as the conﬁdence level, the deﬁnition
takes the following intuitive form: for any given level of accuracy and conﬁdence,
Yn will be equal to a, within these levels of accuracy and conﬁdence, provided
that n is large enough.
Example 7.5.
Consider a sequence of independent random variables Xn that are
uniformly distributed over the interval [0, 1], and let
Yn = min{X1, . . . , Xn}.
The sequence of values of Yn cannot increase as n increases, and it will occasionally
decrease (when a value of Xn that is smaller than the preceding values is obtained).
Thus, we intuitively expect that Yn converges to zero. Indeed, for ϵ > 0, we have
using the independence of the Xn,
P
|Yn −0| ≥ϵ
= P(X1 ≥ϵ, . . . , Xn ≥ϵ)
= P(X1 ≥ϵ) · · · P(Xn ≥ϵ)
= (1 −ϵ)n.
Since this is true for every ϵ > 0, we conclude that Yn converges to zero, in proba-
bility.

Sec. 7.4
The Central Limit Theorem
9
Example 7.6.
Let Y be an exponentially distributed random variable with
parameter λ = 1.
For any positive integer n, let Yn = Y/n.
(Note that these
random variables are dependent.) We wish to investigate whether the sequence Yn
converges to zero.
For ϵ > 0, we have
P
|Yn −0| ≥ϵ
= P(Yn ≥ϵ) = P(Y ≥nϵ) = e−nϵ.
In particular,
lim
n→∞P
|Yn −0| ≥ϵ
= lim
n→∞e−nϵ = 0.
Since this is the case for every ϵ > 0, Yn converges to zero, in probability.
One might be tempted to believe that if a sequence Yn converges to a
number a, then E[Yn] must also converge to a. The following example shows
that this need not be the case.
Example 7.7.
Consider a sequence of discrete random variables Yn with the
following distribution:
P(Yn = y) =





1 −1
n,
for y = 0,
1
n,
for y = n2,
0,
elsewhere.
For every ϵ > 0, we have
lim
n→∞P
|Yn| ≥ϵ
= lim
n→∞
1
n = 0,
and Yn converges to zero in probability. On the other hand, E[Yn] = n2/n = n,
which goes to inﬁnity as n increases.
7.4
THE CENTRAL LIMIT THEOREM
According to the weak law of large numbers, the distribution of the sample
mean Mn is increasingly concentrated in the near vicinity of the true mean µ.
In particular, its variance tends to zero. On the other hand, the variance of the
sum Sn = X1 + · · · + Xn = nMn increases to inﬁnity, and the distribution of
Sn cannot be said to converge to anything meaningful. An intermediate view
is obtained by considering the deviation Sn −nµ of Sn from its mean nµ, and
scaling it by a factor proportional to 1/√n. What is special about this particular
scaling is that it keeps the variance at a constant level. The central limit theorem

10
Limit Theorems
Chap. 7
asserts that the distribution of this scaled random variable approaches a normal
distribution.
More speciﬁcally, let X1, X2, . . . be a sequence of independent identically
distributed random variables with mean µ and variance σ2. We deﬁne
Zn = Sn −nµ
σ√n
= X1 + · · · + Xn −nµ
σ√n
.
An easy calculation yields
E[Zn] = E[X1 + · · · + Xn] −nµ
σ√n
= 0,
and
var(Zn) = var(X1 + · · · + Xn)
σ2n
= var(X1) + · · · + var(Xn)
σ2n
= nσ2
nσ2 = 1.
The Central Limit Theorem
Let X1, X2, . . . be a sequence of independent identically distributed random
variables with common mean µ and variance σ2, and deﬁne
Zn = X1 + · · · + Xn −nµ
σ√n
.
Then, the CDF of Zn converges to the standard normal CDF
Φ(z) =
1
√
2π
 z
−∞
e−x2/2 dx,
in the sense that
lim
n→∞P(Zn ≤z) = Φ(z),
for every z.
The central limit theorem is surprisingly general. Besides independence,
and the implicit assumption that the mean and variance are well-deﬁned and
ﬁnite, it places no other requirement on the distribution of the Xi, which could be
discrete, continuous, or mixed random variables. It is of tremendous importance
for several reasons, both conceptual, as well as practical. On the conceptual side,
it indicates that the sum of a large number of independent random variables
is approximately normal.
As such, it applies to many situations in which a
random eﬀect is the sum of a large number of small but independent random

Sec. 7.4
The Central Limit Theorem
11
factors. Noise in many natural or engineered systems has this property. In a wide
array of contexts, it has been found empirically that the statistics of noise are
well-described by normal distributions, and the central limit theorem provides a
convincing explanation for this phenomenon.
On the practical side, the central limit theorem eliminates the need for
detailed probabilistic models and for tedious manipulations of PMFs and PDFs.
Rather, it allows the calculation of certain probabilities by simply referring to the
normal CDF table. Furthermore, these calculations only require the knowledge
of means and variances.
Approximations Based on the Central Limit Theorem
The central limit theorem allows us to calculate probabilities related to Zn as
if Zn were normal. Since normality is preserved under linear transformations,
this is equivalent to treating Sn as a normal random variable with mean nµ and
variance nσ2.
Normal Approximation Based on the Central Limit Theorem
Let Sn = X1 + · · · + Xn, where the Xi are independent identically dis-
tributed random variables with mean µ and variance σ2. If n is large, the
probability P(Sn ≤c) can be approximated by treating Sn as if it were
normal, according to the following procedure.
1. Calculate the mean nµ and the variance nσ2 of Sn.
2. Calculate the normalized value z = (c −nµ)/σ√n.
3. Use the approximation
P(Sn ≤c) ≈Φ(z),
where Φ(z) is available from standard normal CDF tables.
Example 7.8.
We load on a plane 100 packages whose weights are independent
random variables that are uniformly distributed between 5 and 50 pounds. What is
the probability that the total weight will exceed 3000 pounds? It is not easy to cal-
culate the CDF of the total weight and the desired probability, but an approximate
answer can be quickly obtained using the central limit theorem.
We want to calculate P(S100 > 3000), where S100 is the sum of the 100
packages. The mean and the variance of the weight of a single package are
µ = 5 + 50
2
= 27.5,
σ2 = (50 −5)2
12
= 168.75,

12
Limit Theorems
Chap. 7
based on the formulas for the mean and variance of the uniform PDF. We thus
calculate the normalized value
z = 3000 −100 · 27.5
√
168.75 · 100
=
250
129.9 = 1.92,
and use the standard normal tables to obtain the approximation
P(S100 ≤3000) ≈Φ(1.92) = 0.9726.
Thus the desired probability is
P(S100 > 3000) = 1 −P(S100 ≤3000) ≈1 −0.9726 = 0.0274.
Example 7.9.
A machine processes parts, one at a time. The processing times
of diﬀerent parts are independent random variables, uniformly distributed on [1, 5].
We wish to approximate the probability that the number of parts processed within
320 time units is at least 100.
Let us call N320 this number. We want to calculate P(N320 ≥100). There is
no obvious way of expressing the random variable N320 as the sum of independent
random variables, but we can proceed diﬀerently. Let Xi be the processing time
of the ith part, and let S100 = X1 + · · · + X100 be the total processing time of the
ﬁrst 100 parts. The event {N320 ≥100} is the same as the event {S100 ≤320},
and we can now use a normal approximation to the distribution of S100. Note that
µ = E[Xi] = 3 and σ2 = var(Xi) = 16/12 = 4/3. We calculate the normalized
value
z = 320 −nµ
σ√n
= 320 −300

100 · 4/3
= 1.73,
and use the approximation
P(S100 ≤320) ≈Φ(1.73) = 0.9582.
If the variance of the Xi is unknown, but an upper bound is available,
the normal approximation can be used to obtain bounds on the probabilities of
interest.
Example 7.10.
Let us revisit the polling problem in Example 7.4. We poll n
voters and record the fraction Mn of those polled who are in favor of a particular
candidate.
If p is the fraction of the entire voter population that supports this
candidate, then
Mn = X1 + · · · + Xn
n
,
where the Xi are independent Bernoulli random variables with parameter p. In
particular, Mn has mean p and variance p(1 −p)/n. By the normal approximation,

Sec. 7.4
The Central Limit Theorem
13
X1 + · · · + Xn is approximately normal, and therefore Mn is also approximately
normal.
We are interested in the probability P
|Mn −p| ≥ϵ
that the polling error is
larger than some desired accuracy ϵ. Because of the symmetry of the normal PDF
around the mean, we have
P
|Mn −p| ≥ϵ
≈2P(Mn −p ≥ϵ).
The variance p(1−p)/n of Mn −p depends on p and is therefore unknown. We note
that the probability of a large deviation from the mean increases with the variance.
Thus, we can obtain an upper bound on P
Mn −p ≥ϵ
by assuming that Mn −p
has the largest possible variance, namely, 1/4n. To calculate this upper bound, we
evaluate the standardized value
z =
ϵ
1/(2√n),
and use the normal approximation
P
Mn −p ≥ϵ
≤1 −Φ(z) = 1 −Φ
2ϵ√n
.
For instance, consider the case where n = 100 and ϵ = 0.1. Assuming the
worst-case variance, we obtain
P
|M100 −p| ≥0.1
≈2P(Mn −p ≥0.1)
≤2 −2Φ
2 · 0.1 ·
√
100
= 2 −2Φ(2) = 2 −2 · 0.977 = 0.046.
This is much smaller (more accurate) than the estimate that was obtained in Ex-
ample 7.4 using the Chebyshev inequality.
We now consider a reverse problem. How large a sample size n is needed
if we wish our estimate Mn to be within 0.01 of p with probability at least 0.95?
Assuming again the worst possible variance, we are led to the condition
2 −2Φ
2 · 0.01 · √n
≤0.05,
or
Φ
2 · 0.01 · √n
≥0.975.
From the normal tables, we see that Φ(1.96) = 0.975, which leads to
2 · 0.01 · √n ≥1.96,
or
n ≥
(1.96)2
4 · (0.01)2 = 9604.
This is signiﬁcantly better than the sample size of 50,000 that we found using
Chebyshev’s inequality.
The normal approximation is increasingly accurate as n tends to inﬁnity,
but in practice we are generally faced with speciﬁc and ﬁnite values of n. It

14
Limit Theorems
Chap. 7
would be useful to know how large an n is needed before the approximation
can be trusted, but there are no simple and general guidelines. Much depends
on whether the distribution of the Xi is close to normal to start with and, in
particular, whether it is symmetric. For example, if the Xi are uniform, then S8
is already very close to normal. But if the Xi are, say, exponential, a signiﬁcantly
larger n will be needed before the distribution of Sn is close to a normal one.
Furthermore, the normal approximation to P(Sn ≤c) is generally more faithful
when c is in the vicinity of the mean of Sn.
The De Moivre – Laplace Approximation to the Binomial
A binomial random variable Sn with parameters n and p can be viewed as the
sum of n independent Bernoulli random variables X1, . . . , Xn, with common
parameter p:
Sn = X1 + · · · + Xn.
Recall that
µ = E[Xi] = p,
σ =

var(Xi) =

p(1 −p),
We will now use the approximation suggested by the central limit theorem to
provide an approximation for the probability of the event {k ≤Sn ≤ℓ}, where
k and ℓare given integers. We express the event of interest in terms of a stan-
dardized random variable, using the equivalence
k ≤Sn ≤ℓ
⇐⇒
k −np

np(1 −p)
≤
Sn −np

np(1 −p)
≤
ℓ−np

np(1 −p)
.
By the central limit theorem, (Sn −np)/

np(1 −p) has approximately a stan-
dard normal distribution, and we obtain
P(k ≤Sn ≤ℓ) =P

k −np

np(1 −p)
≤
Sn −np

np(1 −p)
≤
ℓ−np

np(1 −p)

≈Φ

ℓ−np

np(1 −p)

−Φ

k −np

np(1 −p)

.
An approximation of this form is equivalent to treating Sn as a normal
random variable with mean np and variance np(1 −p). Figure 7.1 provides an
illustration and indicates that a more accurate approximation may be possible if
we replace k and ℓby k −1
2 and ℓ+ 1
2, respectively. The corresponding formula
is given below.

Sec. 7.4
The Central Limit Theorem
15
k
l
k
l
(a)
(b)
Figure 7.1:
The central limit approximation treats a binomial random variable
Sn as if it were normal with mean np and variance np(1 −p). This ﬁgure shows a
binomial PMF together with the approximating normal PDF. (a) A ﬁrst approx-
imation of a binomial probability P(k ≤Sn ≤ℓ) is obtained by integrating the
area under the normal PDF from k to ℓ, which is the shaded area in the ﬁgure.
(b) With the approach in (a), if we have k = ℓ, the probability P(Sn = k) would
be approximated by zero. A potential remedy would be to use the normal prob-
ability between k −1
2 and k + 1
2 to approximate P(Sn = k). By extending this
idea, P(k ≤Sn ≤ℓ) can be approximated by using the area under the normal
PDF from k −1
2 to ℓ+ 1
2, which corresponds to the shaded area.
De Moivre – Laplace Approximation to the Binomial
If Sn is a binomial random variable with parameters n and p, n is large, and
k, ℓare nonnegative integers, then
P(k ≤Sn ≤ℓ) ≈Φ

ℓ+ 1
2 −np

np(1 −p)

−Φ

k −1
2 −np

np(1 −p)

.
Example 7.11.
Let Sn be a binomial random variable with parameters n = 36
and p = 0.5. An exact calculation yields
P(Sn ≤21) =
21

k=0

36
k

(0.5)36 = 0.8785.
The central limit approximation, without the above discussed reﬁnement, yields
P(Sn ≤21) ≈Φ

21 −np

np(1 −p)

= Φ
21 −18
3

= Φ(1) = 0.8413.
Using the proposed reﬁnement, we have
P(Sn ≤21) ≈Φ

21.5 −np

np(1 −p)

= Φ
21.5 −18
3

= Φ(1.17) = 0.879,

16
Limit Theorems
Chap. 7
which is much closer to the exact value.
The de Moivre – Laplace formula also allows us to approximate the probability
of a single value. For example,
P(Sn = 19) ≈Φ
19.5 −18
3

−Φ
18.5 −18
3

= 0.6915 −05675 = 0.124.
This is very close to the exact value which is

36
19

(0.5)36 = 0.1251.
7.5
THE STRONG LAW OF LARGE NUMBERS
The strong law of large numbers is similar to the weak law in that it also deals
with the convergence of the sample mean to the true mean.
It is diﬀerent,
however, because it refers to another type of convergence.
The Strong Law of Large Numbers (SLLN)
Let X1, X2, . . . be a sequence of independent identically distributed random
variables with mean µ. Then, the sequence of sample means Mn = (X1 +
· · · + Xn)/n converges to µ, with probability 1, in the sense that
P

lim
n→∞
X1 + · · · + Xn
n
= µ

= 1.
In order to interpret the SSLN, we need to go back to our original de-
scription of probabilistic models in terms of sample spaces. The contemplated
experiment is inﬁnitely long and generates experimental values for each one of
the random variables in the sequence X1, X2, . . .. Thus, it is best to think of the
sample space Ωas a set of inﬁnite sequences ω = (x1, x2, . . .) of real numbers:
any such sequence is a possible outcome of the experiment. Let us now deﬁne the
subset A of Ωconsisting of those sequences (x1, x2, . . .) whose long-term average
is µ, i.e.,
(x1, x2, . . .) ∈A
⇐⇒
lim
n→∞
x1 + · · · + xn
n
= µ.
The SLLN states that all of the probability is concentrated on this particular
subset of Ω. Equivalently, the collection of outcomes that do not belong to A
(inﬁnite sequences whose long-term average is not µ) has probability zero.

Sec. 7.5
The Strong Law of Large Numbers
17
The diﬀerence between the weak and the strong law is subtle and deserves
close scrutiny. The weak law states that the probability P

|Mn −µ| ≥ϵ

of a
signiﬁcant deviation of Mn from µ goes to zero as n →∞. Still, for any ﬁnite
n, this probability can be positive and it is conceivable that once in a while,
even if infrequently, Mn deviates signiﬁcantly from µ. The weak law provides
no conclusive information on the number of such deviations, but the strong law
does. According to the strong law, and with probability 1, Mn converges to µ.
This implies that for any given ϵ > 0, the diﬀerence |Mn −µ| will exceed ϵ only
a ﬁnite number of times.
Example 7.12.
Probabilities and Frequencies.
As in Example 7.3, con-
sider an event A deﬁned in terms of some probabilistic experiment. We consider
a sequence of independent repetitions of the same experiment, and let Mn be the
fraction of the ﬁrst n trials in which A occurs. The strong law of large numbers
asserts that Mn converges to P(A), with probability 1.
We have often talked intuitively about the probability of an event A as the
frequency with which it occurs in an inﬁnitely long sequence of independent trials.
The strong law backs this intuition and establishes that the long-term frequency
of occurrence of A is indeed equal to P(A), with certainty (the probability of this
happening is 1).
Convergence with Probability 1
The convergence concept behind the strong law is diﬀerent than the notion em-
ployed in the weak law. We provide here a deﬁnition and some discussion of this
new convergence concept.
Convergence with Probability 1
Let Y1, Y2, . . . be a sequence of random variables (not necessarily indepen-
dent) associated with the same probability model. Let c be a real number.
We say that Yn converges to c with probability 1 (or almost surely) if
P

lim
n→∞Yn = c

= 1.
Similar to our earlier discussion, the right way of interpreting this type of
convergence is in terms of a sample space consisting of inﬁnite sequences: all
of the probability is concentrated on those sequences that converge to c. This
does not mean that other sequences are impossible, only that they are extremely
unlikely, in the sense that their total probability is zero.

18
Limit Theorems
Chap. 7
The example below illustrates the diﬀerence between convergence in prob-
ability and convergence with probability 1.
Example 7.13.
Consider a discrete-time arrival process. The set of times is
partitioned into consecutive intervals of the form Ik = {2k, 2k + 1, . . . , 2k+1 −1}.
Note that the length of Ik is 2k, which increases with k. During each interval Ik,
there is exactly one arrival, and all times within an interval are equally likely. The
arrival times within diﬀerent intervals are assumed to be independent. Let us deﬁne
Yn = 1 if there is an arrival at time n, and Yn = 0 if there is no arrival.
We have P(Yn ̸= 0) = 1/2k, if n ∈Ik. Note that as n increases, it belongs to
intervals Ik with increasingly large indices k. Consequently,
lim
n→∞P(Yn ̸= 0) = lim
k→∞
1
2k = 0,
and we conclude that Yn converges to 0 in probability. However, when we carry out
the experiment, the total number of arrivals is inﬁnite (one arrival during each
interval Ik).
Therefore, Yn is unity for inﬁnitely many values of n, the event
{limn→∞Yn = 0} has zero probability, and we do not have convergence with prob-
ability 1.
Intuitively, the following is happening. At any given time, there is a small
(and diminishing with n) probability of a substantial deviation from 0 (convergence
in probability).
On the other hand, given enough time, a substantial deviation
from 0 is certain to occur, and for this reason, we do not have convergence with
probability 1.
Example 7.14.
Let X1, X2, . . . be a sequence of independent random variables
that are uniformly distributed on [0, 1], and let Yn = min{X1, . . . , Xn}. We wish
to show that Yn converges to 0, with probability 1.
In any execution of the experiment, the sequence Yn is nonincreasing, i.e.,
Yn+1 ≤Yn for all n. Since this sequence is bounded below by zero, it must have a
limit, which we denote by Y . Let us ﬁx some ϵ > 0. If Y ≥ϵ, then Xi ≥ϵ for all i,
which implies that
P(Y ≥ϵ) ≤P(X1 ≥ϵ, . . . , Xn ≥ϵ) = (1 −ϵ)n.
Since this is true for all n, we must have
P(Y ≥ϵ) ≤lim
n→∞(1 −ϵ)n = 0.
This shows that P(Y ≥ϵ) = 0, for any positive ϵ. We conclude that P(Y > 0) = 0,
which implies that P(Y = 0) = 1.
Since Y is the limit of Yn, we see that Yn
converges to zero with probability 1.

