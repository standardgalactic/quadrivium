
Microwave Network Design  
Using the Scattering Matrix

For a listing of recent titles in the Artech House Microwave Library,  
turn to the back of this book.

Microwave Network Design  
Using the Scattering Matrix
Janusz A. Dobrowolski
artechhouse.com

Library of Congress Cataloging-in-Publication Data
A catalog record for this book is available from the U.S. Library of Congress.
British Library Cataloguing in Publication Data
A catalog record for this book is available from the British Library.
  ISBN 13: 978-1-60807-129-6
Cover design by Vicki Kane
© 2010 ARTECH HOUSE
685 Canton Street
Norwood, MA 02062
All rights reserved. Printed and bound in the United States of America. No part of 
this book may be reproduced or utilized in any form or by any means, electronic or 
mechanical, includ­ing photocopying, recording, or by any information storage and 
retrieval system, without permission in writing from the publisher.
All terms mentioned in this book that are known to be trademarks or service 
marks have been appropriately capitalized. Artech House cannot attest to the ac-
curacy of this informa­tion. Use of a term in this book should not be regarded as 
affecting the validity of any trade­mark or service mark.
10 9 8 7 6 5 4 3 2 1

Contents
1	
Introduction	
1
References	
4
2	
Theory of Uniform Waveguides	
7
2.1	
Modal Electromagnetic Fields	
8
2.2	
Power Transmitted in a Waveguide	
9
2.3	
Characteristic Impedance	
11
2.4	
Normalization of Waveguide Voltage	
	
and Current	
13
2.5	
Transmission Line Equivalent 	
	
Circuit of a Waveguide	
14
References	
15
v

vi 
Microwave Network Design Using the Scattering Matrix
3	
Theory of Transmission Lines	
17
3.1	
Lumped Element Circuit Model of a	
 
	
Transmisssion Line	
18
3.2	
Voltage and Current Wave Propagation	
  
	
in a Transmission Line	
18
3.3	
Terminated Transmission Line	
21
3.4	
Terminated Transmission Line Special Cases     24
References	
26
4	
Wave Variables and the Scattering Matrix	
27
4.1	
Voltage Traveling Waves and	
  
	
the Scattering Matrix	
28
4.1.1	
Physical Interpretation of Scattering Parameters   30
4.1.2	
A Shift in Reference Plane	
32
4.1.3	
Scattering Matrix Properties	
34
4.1.4	
Conversions Between the Scattering	  
	
Matrix and Other Matrix Descriptions of	
  
	
Microwave Networks	
35
4.2	
Normalized Voltage Traveling Waves and the	
  
	
Generalized Scattering Matrix	
36
4.2.1	
Physical Interpretation of Generalized	
  
	
Scattering Parameters	
37
4.3	
Traveling Wave Intensities and the True	
  
	
Scattering Matrix	
39
4.4	
Pseudowaves and the Pseudoscattering Matrix     42
4.4.1	
Pseudoscattering Matrix Properties	
44
4.4.2	
Conversions Between the Pseudoscattering 	  
	
Matrix and Other Matrix Descriptions	
	
of Microwave Networks	
48

4.4.3	
Change of Reference Impedances	
51
4.4.4	
One-Port Reference Impedance Transformation   53
4.4.5	
Multiport Network Reference 	
 
	
Impedance Transformation	
55
4.4.6	
Two-Port Reference Impedance Transformation   55
4.4.7	
Three-Port to Two-Port Network 	  
	
Scattering Matrix Transformation	
56
4.4.8	
Scattering Matrix of the Cascade	
  
	
of Two-Port Networks	
60
4.4.9	
Scattering Matrix of an Embedded 	 
	
Multiport Network	
62
4.5	
Generalized Multiport Network	
  
	
Cascade Matrix	
64
4.5.1	
T-Matrix to S-Matrix and S-Matrix to 	
 
	
T-Matrix Transformation for Multiport 	
 
	
Networks with the Same Number of Input 	  
	
and Output Ports (Balanced Networks)	
68
4.5.2	
T-Matrix to S-Matrix and S-Matrix to T-Matrix 	
 
	
Transformation for Multiport  Networks 	
 
	
with Different Numbers of Input and Output 	
 
	
Ports (Unbalanced Networks)	
69
4.6	
Load Impedance	
71
4.7	
Power Waves and the Power Scattering Matrix   72
4.7.1	
Physical Interpretation of Power Waves	
75
4.7.2	
Physical Interpretation of Power Scattering 	  
	
Parameters	
77
4.7.3 	
Conversions Between Power Wave Scattering
	
  
	
Matrix and Other Matrix Descriptions of 	  
	
Microwave Networks	
83
4.7.4	
Power Scattering Matrix Properties	
84
4.7.5	
Port Connections	
85
References	
87
	
Contents	
vii

viii 
Microwave Network Design Using the Scattering Matrix
5	
Signal Analysis of Multiport Networks	
89
5.1	
Wave Relations For Basic Elements of 	
 
	
Multiport Networks	
90
5.1.1	
Signal Source	
90
5.1.2	
Load	
92
5.2	
Microwave Network Analysis Using Scattering 	
 
	
Parameters and Signal Flow Graphs	
96
5.3	
Signal Analysis of Two-Port Networks	
100
5.3.1	
Transducer Power Gain	
100
5.3.2	
Power Gain	
102
5.3.3	
Available Power Gain	
103
5.3.4	
Stability Consideration for Active	   
	
Two-Port Networks	
103
5.3.5	
Maximum Power Gain	
108
5.3.6	
Constant Power Gain Circles	
109
5.3.7	
Constant Available Power Gain Circles	
110
5.3.8	
Insertion Loss	
110
5.3.9	
Voltage Gain	
112
5.3.10	 Voltage Transfer Gain	
113
5.4	
Multiport Network Analysis	
114
5.5	
Multielement Multiport Network 	  
	
Analysis Using Connection Scattering 	
 
	
Matrix Approach 	
120
References	
125
6	
Mode Wave Variables and Mixed Mode	
 
	
Scattering Matrix of Differential Networks	
127
6.1	
Differential and Common Mode Definitions   128 
6.2	
Mode-Specific Waves and Impedances	
130

6.3	
Mixed Mode Scattering Parameters	
132
6.4	
Transformation Between Standard- and	
 
	
Mixed-Mode Scattering Parameters	
134
6.5	
Generalized Mixed-Mode	   
	
Pseudoscattering Matrix	
138
6.6	
Mixed-Mode Cascade Matrix	
158
References	
163
7	
Noise Wave Variables and the 	
	
Scattering Matrix	
165
7.1	
Noise Waves	
166
7.1.1	
Noise Power Waves	
166
7.1.2	
Noise Pseudowaves	
167
7.2	
Noise Wave Representation of Microwave	   
	
Networks	
168
7.3	
Other Noise Representations of Noisy 	
 
	
Networks and Their Transformations	
 
	
to Noise Wave Parameters	
171
7.3.1	
Chain Matrix Noise Representation	
171
7.3.2	
Cascade Matrix Noise Representation	
175
7.3.3	
Impedance Matrix and Admittance	  
	
Matrix Noise Representations	
179
7.4	
Noise Modeling of Microwave 	
 
	
Network Elements	
181
7.4.1	
Noise Wave Correlation Matrices of Passive	  
	
Multiport Networks	
181
7.4.2	
Noise Correlation Matrices of Passive	
 
	
Multiport Networks Embedded in Lossy 	
 
	
Waveguides	
185
	
Contents	
ix

 
Microwave Network Design Using the Scattering Matrix
7.4.3	
Noise Wave Correlation Matrices of Active 	 
	
Two-Port Networks	
186
7.5	
Two-Port to Three-Port Noise Wave 	
 
	
Transformation	
190
7.6	
Noise Wave Correlation Matrices of	
 
	
Embedded Multiport Networks	
196
7.7	
Deembedding Noise Wave Parameters 	
 
	
of Cascaded Noisy Two-Port Networks	
198
References	
200
8	
Noise Analysis of Multiport Networks	
203
8.1	
Basic Relationships For Noisy	
  
	
Multiport Networks	
204
8.2	
Classical Two-Port Network Noise Theory	
205
8.3	
Noise Figure of a Two-Port Network	
208
8.3.1	
Constant Noise Figure Circles	
209
8.4	
Two-Port Network Noise Analysis Using 	
 
	
Scattering Matrix	
211
8.5	
Noise Analysis of Two-Port Networks 	
 
	
Using Noise Waves And Cascade 	  
	
(Transfer Scattering) Matrix	
215
8.5.1	
Noise Wave Parameters Of Cascade Connected 	
 
	
Two-Port Networks	
218
8.6	
Noise Analysis of Multielement Multiport 	  
	
Networks Using Connection Scattering 	
 
	
Matrix Approach	
220
8.6.1	
Noise Figure	
223

8.6.2	
Signal-to-Noise Ratio	
227
8.7	
Noise Analysis of Multiport Networks	
228
8.7.1	
Noise Figure	
230
8.7.2	
Signal-to-Noise Ratio	
231
References	
238
9	
Scattering Functions in Nonlinear Modeling	
 
	
of Microwave Devices	
241
9.1	
Large-Signal Scattering Functions	
242
9.2	
Linearization of Scattering Functions	
245
9.3	
The Time Reference	
250
9.4	
Application of the Response Coefficients 	
 
	
Matrices S and S/ to Predict Nonlinear 	
 
	
Device Performance	
252
9.5	
Experimental Determination of the 	 
	
Response Coefficients Matrices S and S/	
254
References	
258
	
Appendix	
261
	
About the Author	
265
	
Index	
267
 
 
	
Contents	
xi


1
1
Introduction
For the past 60 years, the scattering parameters have been used very exten-
sively by microwave community for characterization, modeling, and design 
of microwave devices and networks. Because at RF and microwave frequen-
cies impedance or admittance description of networks is in many aspects 
abstraction since the voltages, currents, impedances or admittances cannot 
be measured in direct manner, then using equipment called vector network 
analyzer (VNA) we measure wave reflection coefficient at particular network 
ports or wave transmission coefficient through a network [1–3]. The directly 
measurable quantities are magnitudes and phase angles of the waves reflected 
or scattered from the junction relative to the incident wave magnitude and 
phase angle. Thanks to linearity of the field equations and thanks to assumed 
linearity of such devices as transistors and diodes, the amplitudes of scattered 
waves are linearly dependent on amplitudes of the incident waves. The matrix 
describing the linear relationship between the incident and scattered waves at 
ports of a network is called the scattering matrix.
A vector network analyzer (VNA) measures the magnitude and phase 
characteristics of microwave devices including passive and active compo-
nents of microwave networks, as well as multifunctional monolithic micro-
wave integrated circuits (MMICs) and radio frequency integrated circuits 
(RFICs). The scattering parameters and the network analyzer have equipped 
microwave engineers and researchers with very valuable device information,  

2 
Microwave Network Design Using the Scattering Matrix
transcending the role of test equipment and data to become vital components 
in the design process.
The first introduction of the scattering representation of microwave net-
works took place many years ago [4, 5]. Since then, definitions of wave variables 
have been modified many times. In relation to this fact it is important to know, 
to understand, and to realize consequences of different approaches to the micro-
wave networks scattering representation that are presented in the literature of the 
subject [4, 6–12]. In particular, an understanding of scattering description based 
on wave variables referenced to complex impedances is very important because 
incorrect use of this tool may lead to unacceptable results and mistakes.
This book presents in detail the theoretical foundation for the wave 
approach to microwave network characterization, analysis, and design using 
scattering parameters.
Chapter 2 briefly presents theory of uniform waveguides helpful to 
understand the microwave network concept of incident wave and reflected 
or scattered wave, which is the basis for scattering parameter description of 
microwave networks. Modal electromagnetic field representation discussed 
here will be used in Chapter 4 to define wave variables and the scattering 
matrix. Properly normalized modal fields are used to determine electromag-
netic power transmitted in a waveguide, to define characteristic impedance 
of a waveguide, and to introduce normalized waveguide voltage and current. 
At the end of this chapter the reader will find considerations on transmission 
line equivalent circuit of a single mode waveguide.
Theory of transmission lines given briefly in Chapter 3 is of significant 
importance in microwave network theory. As a bridge between field analy-
sis and microwave network theory it is very helpful in many considerations 
and developments of some basic relations applied to scattering parameters. 
This will be demonstrated with examples given in Chapter 4. Starting from 
lumped element circuit model of a transmission line we present and discuss 
voltage and current wave propagation, and impedance relations for termi-
nated transmission lines.
In Chapter 4 we introduce wave variables and the scattering matrix. 
There are presented definitions of voltage traveling waves and scattering ma-
trix, normalized voltage scattering waves and generalized scattering matrix, 
traveling wave intensities and true scattering matrix, pseudowaves and pseu-
doscattering matrix, and finally definitions of power scattering waves and 
power scattering matrix. The physical interpretation of these quantities is 
presented and compared. These considerations are illustrated by examples 
showing different approaches to wave variables and the scattering matrix. In 
addition, the consequences of the change of the reference impedance in the 

	
Introduction	
3
scattering matrix definition and the relations between the scattering matrix, 
the pseudoscattering matrix, the power scattering matrix, and other matrix 
representations of microwave networks are discussed.
The book guides the reader through various applications of a scattering 
matrix. The remaining chapters of the book are devoted to scattering matrix– 
based methods of microwave network analysis.
Microwave network signal analysis methods based on scattering matrix 
description of network elements are discussed in Chapter 5. Three approaches 
to this problem are presented: multiport network analysis based on signal 
flow graph, multiport network analysis, and multielement network analysis 
using connection scattering matrix approach. The multiport network analysis 
approach may be applied to networks considered as a single multiport excited 
by one-port signal sources and loaded by one-port terminations. The connec-
tion scattering matrix approach may be used to analyze multiport networks 
considered as a connection of many individual multiport elements character-
ized by their individual scattering matrices. Microwave networks with any 
arbitrary topology may be analyzed using this matrix formalism. Algorithms 
for different network function calculations are presented in detail.
In Chapter 6 we present the theory related to the mixed mode scatter-
ing matrix of differential networks. Based on differential mode and common 
mode definitions, mode-specific wave variables and mixed mode scattering 
parameters are introduced here. Also discussed here are transformation rela-
tions between standard single-ended and mixed mode scattering parameters 
of multiport networks. A generalized mixed mode scattering matrix for mul-
tiport networks with single-ended and differential inputs and outputs is also 
discussed. At the end of this chapter, the presented theory is applied to the 
analysis of the differential amplifier.
In Chapter 7 we introduce the definition of noise wave variables and 
noise wave representation of noisy microwave networks in the form of a noise 
wave correlation matrix. Chain matrix, impedance matrix, and admittance 
matrix noise representations of noisy multiport networks are also presented. 
Two-port to three-port noise wave correlation matrix transformation and the 
noise wave correlation matrix of embedded multiport networks are discussed. 
We present also noise wave modeling of passive multiport networks and of 
active two-ports. These relations are essential in noise wave modeling prob-
lems of microwave semiconductor devices such as MESFETs, HEMTs, or 
HJTs.
In Chapter 8, a scattering matrix and noise wave correlation matrix are 
used for the noise analysis of multiport networks. First we define and discuss  
the noise figure for two-port networks and extend the definition of this  

4 
Microwave Network Design Using the Scattering Matrix
parameter to noisy multiports. Then two methods of multiport network 
noise analysis are given. The first one, applicable to multielement multiport 
networks, is based on the connection scattering matrix approach. The second 
method may be applied to networks considered as a single multiport termi-
nated at its ports by signal sources and loads. In both cases algorithms of noise 
figure and signal to noise ratio calculations are discussed in detail.
The scattering parameters discussed in this book can only accurately 
represent linear networks such as filters, directional couplers, waveguides, and 
transmission lines. They are based on the superposition principle and may 
represent semiconductor devices such as transistors, diodes, and amplifiers  
when the applied signal is assumed to be small enough to justify the super­
position principle. To break the limitations of the small-signal scattering pa-
rameters, a large-signal scattering function theory has been invented. This 
theory, which has been very extensively studied in last years, extends small-
signal theory by taking into account not only the scattering wave variables 
at one fundamental frequency, but also at harmonic and nonharmonic fre-
quencies. The contribution of all such spectral components is formulated 
into nonlinear scattering functions that allow characterization of nonlinear 
devices and networks. In Chapter 9 we introduce scattering functions, their 
linearization, and application to modeling of nonlinear microwave devices.
In the Appendix, the reader can find the basics of the Fourier transform 
in application to noise waves.
This book is an excellent source of theoretical as well as practical in-
formation on the wave variables and scattering matrix and their application 
to microwave network characterization, modeling, analysis, and design. It 
is suitable for beginners and students as well as experienced engineers and 
researchers working in the field of microwaves.
References
[1]	
Adam, S.F., “A New Precision Automatic Microwave Measurement System,” IEEE 
Trans. on Instrumentation and Measurements, Vol. 17, No. 4, 1968, pp. 308–313.
[2]	
Howell, K., and K. Wong, “DC to 110 GHz Measurements in Coax Using 1 mm Con-
nectors,” Microwave J., Vol. 42, July 1999, pp. 22–34.
[3]	
Rumiantsev, A. and N. Ridler, “VNA Calibration,” IEEE Microwave Magazine, Vol. 9, 
No. 3, June 2008, pp. 86–99.
[4]	
Montgomery, C. G., R. H. Dicke, and E. M. Purcell (eds.), Principles of Microwave 
Circuits, McGraw Hill, 1948.

	
Introduction	
5
  [5]	 Marcuvitz, N., Waveguide Handbook, McGraw Hill, 1951.
  [6]	 Harrington, R. F., Time Harmonic Electromagnetic Waves, New York: McGraw Hill, 
1961.
  [7]	 Kurokawa, K., “Power Waves and the Scattering Matrix,” IEEE Trans. Microwave 
Theory Tech., Vol. MTT-13, No. 2, 1965, pp. 194–202.
  [8]	 Kurokawa, K., An Introduction to the Theory of Microwave Circuits, New York: Aca-
demic Press, 1969.
  [9]	 Collin, R. E., Foundations for Microwave Engineering, Tokyo: McGraw Hill Kogakusha, 
Ltd., 1966.
[10]	 Marks, R. B., and D. F. Williams, “A General Waveguide Circuit Theory,” Journal  
of Research of the National Institute of Standards and Technology, Vol. 97, 1992,  
pp. 533–562.
[11]	 Altman, J. L., Microwave Circuits, Princeton, NJ: D. Van Nostrand Company, Inc., 
1964.
[12]	 Pozar, D. M., Microwave Engineering, New York: Addison-Wesley Publishing Co., 
1990.


7
2
Theory of Uniform Waveguides
This chapter is based on a fundamental work of Roger B. Marks and Dylan F. 
Williams published in [1]. There is presented a theory of uniform waveguides 
required to understand the concept of waveguide voltage and current waves 
that propagate in a waveguide. Defined here, voltage and current waves are 
properly normalized to simplify further derivations and results. There are 
derived and discussed relations for transmitted power and the modal char-
acteristic impedance of the uniform waveguide. The chapter ends with the 
definitions of the equivalent circuit parameters in terms of the characteristic 
impedance of the uniform waveguide. There are also given explicit expres-
sions for L, R, C, and G parameters in terms of the modal fields in a lossy 
waveguide. They are used for theoretical determination of the L, R, C, G 
network parameters of any lossy waveguide [2].
According to relations presented and discussed in this chapter, transverse 
electric and magnetic fields of waves propagating in the waveguide may be 
expressed in terms of waveguide voltage and waveguide current. It can be as-
sumed that the characteristic impedance of the mode equals the ratio of com-
plex amplitudes of waveguide voltage and waveguide current waves propagat-
ing in forward direction. These quantities, waveguide voltage and waveguide 
current and mode characteristic impedance are the basis for the definition of 
traveling wave intensities (or shortly, traveling waves) and the true scattering 
parameters that will be introduced and discussed in Chapter 4.

8 
Microwave Network Design Using the Scattering Matrix 
Relations for transmitted power and the waveguide characteristic im-
pedance presented here on the basis of field theory will be exploited and 
discussed in detail in Chapter 4 in connection with traveling wave intensities 
on the basis of microwave network theory.
The L, R, C, G equivalent circuit of the uniform lossy waveguide will be 
exploited in Chapter 3 in order to derive transmission line impedance equa-
tions that are very useful in scattering matrix theory.
2.1  Modal Electromagnetic Fields
In a uniform waveguide propagating a single mode the transverse compo-
nents of the total fields E and H are given as [1]
	
γ
γ
-
+
+
-
=
+
º
0
( )
z
z
t
t
t
v z
c e
c e
v
t
E
e
e
e
	
(2.1)
and
	
γ
γ
-
+
+
-
=
-
º
0
( )
z
z
t
t
t
i z
c e
c e
i
t
H
h
h
h
	
(2.2)
where γ is the modal propagation constant having real and imaginary parts 
α and β
	
º
+ j
γ
α
β	
(2.3)
It is assumed that the z-axis is oriented along the waveguide axis.
The fields in the waveguide are linear combinations of the forward and 
backward mode fields. The first terms in (2.1) and (2.2) are transverse normal-
ized fields that correspond to a mode propagating in the +z direction with prop-
agating constant +γ while the second terms are transverse normalized fields of 
the same mode propagating in the –z direction with propagating constant -γ.
In (2.1)
( )
( )
( )
( )
0
0
0
0
( )
 
( )
( )
z
z
z
z
v z
c v e
c v e
V
e
V
e
v
z
v
z
γ
γ
γ
γ
-
+
+
-
-
+
+
-
+
-
=
+
=
+
=
+
	 (2.4)
is the waveguide voltage associated with the transverse components of the 
total electric field in the waveguide.
Similarly, in (2.2)
	
i(z) = c+i0e-γ z - c-i0 e+γ z = 
+
-
-
+
+
-
+
=
+
( )
( )
( )
( )
0
0
( )
( )
z
z
I
e
I
e
i
z
i
z
γ
γ
	 (2.5)

	
Theory of Uniform Waveguides	
9
is the waveguide current associated with the transverse components of the 
total magnetic field in the waveguide.
In (2.4) and (2.5), waveguide voltage 
	
+
-
+
-
+
=
=
( )
0
0
( )
z
z
v
z
c v e
V
e
γ
γ
	
(2.6)
and the waveguide current
	
+
-
+
-
+
=
=
( )
0
0
( )
z
z
i
z
c i e
I
e
γ
γ
	
(2.7)
are voltage and current waves that propagate in forward direction while wave-
guide voltage
	
-
+
-
+
-
=
=
( )
0
0
( )
z
z
v
z
c v e
V
e
γ
γ
	
(2.8)
and the waveguide current
	
-
+
-
+
-
=
=
( )
0
0
( )
z
z
i
z
c i e
I
e
γ
γ
	
(2.9)
are voltage and current waves that propagate in backward direction.
v0 and i0 are normalizing constants. Units of v0 are volts and units of i0 
are ampers. Thanks to such normalization Et and et have units appropriate to 
electric fields, Ht and ht have units appropriate to magnetic fields, while v has 
units of voltage and i has units of current.
2.2  Power Transmitted in a Waveguide
The integral of the Poynting vector over the cross section S of the waveguide 
equals the net complex power p(z) crossing a given transverse plane in the 
waveguide
[1, 3, 4]
	
(
)
=
´
×
=
ò
0
0 0
*
( )
( )
*
( )
*
t
t
S
v z i
z
p z
dS
p
v i
E
H
z
	
(2.10)
where 
	
(
)
º
´
×
ò
0
*
t
t
S
p
dS
e
h
z
	
(2.11)
is the complex power that is carried by the normalized mode across the sur-
face S.

10 
Microwave Network Design Using the Scattering Matrix 
In (2.10) there is not the ½ factor, which means that the magnitudes of 
the complex time dependent fields are assumed to be the root mean square, 
not the peak values.
As in electrical circuit theory, it is convenient to require that
	
p z
v z i
z
( )
( ) *( )
=
	
(2.12)
than the normalizing constants v0 and i0 cannot be arbitrary chosen. They 
have to satisfy the constraint
	
p
v i
0
0
0
=
*
	
(2.13)
The forward mode is defined as that in which the power flows in the + z 
direction; that is
	
0
Re{
}
0
P
p
=
³ 	
(2.14)
The average power flow P(z) across the cross section S of a waveguide 
equals the real part of p(z)
	
(
)
{
}
*
*
( )
Re{ ( )}
Re
Re
( )
( )
t
S
P z
p z
dS
v z i
z
ì
ü
ï
ï
=
=
´
×
=
í
ý
ï
ï
î
þ
ò
t
E
H
z
	
(2.15)
In a case when only the forward mode propagates in the waveguide, the 
complex power is
	
α
-
=
2
0
( )
z
p z
p e
	
(2.16)
Similarly, when only the backward mode is present in the waveguide, 
the complex power is
	
α
+
= -
2
0
( )
z
p z
p e
	
(2.17)
The associated average powers are, respectively
	
{
} -
=
2
0
( )
Re
z
P z
p
e
α
	
(2.18)
and
	
{
} +
= -
2
0
( )
Re
z
P z
p
e
α
	
(2.19)

	
Theory of Uniform Waveguides	
11
As it comes from the nonlinear relation in (2.15), in general the net real 
power is not a simple difference of the forward and backward mode powers 
[5]. This will be presented and discussed in Chapter 4.
2.3  Characteristic Impedance
The forward mode characteristic impedance is defined as the ratio of complex 
amplitudes of waveguide voltage and waveguide current waves propagating in 
forward direction, or as the ratio with minus sign of complex amplitudes of 
waveguide voltage and waveguide current waves propagating in the backward 
direction [1]
	
=
0
0
0
v
Z
i 	
(2.20)
Because (2.13) is imposed we can also write
	
Z
v
i
v
p
p
i
0
0
0
0
2
0
0
0
2
=
=
=
*
	
(2.21)
The three definitions of Z0—voltage-current, voltage-power, and cur-
rent-power—are consistent. If p0, v0, and i0 were defined independently, as 
for example, in terms of some power, voltage drop, and current in the wave-
guide, the three definitions of Z0 would be inconsistent and (2.21) would 
not hold. Such an approach to the characteristic impedance definition can be 
found in the literature.
The phase of the characteristic impedance Z0 is identical to that of p0. 
The phase of Z0 is a fixed, inherent, and unambiguous property of the mode. 
Equations (2.14) and (2.20) constrain the sign of Z0 such that
	
{
} ³
0
Re
0
Z
	
(2.22)
The characteristic impedance Z0 of any propagating mode of a lossless 
line is real and positive.
When only a single forward propagating mode exists in a waveguide, 
then v(z)/i(z) = v0/i0 = Z0 for all z. Likewise, when only a single backward 
mode exists in a waveguide, then v(z)/i(z) = -v0/i0 = Z0. In a case, when both, 
forward and backward modes exist, v(z)/i(z) depends on z due to interference 
between the two waves propagating in the waveguide in opposite directions.

12 
Microwave Network Design Using the Scattering Matrix 
Let us consider now the correspondence between the above pre-
sented definition of Z0 and the conventional definitions of the characteristic  
impedance.
In homogeneous waveguides, fields of TE, TM, and TEM modes sat-
isfy the equation
	
η
´
=
t
t
z
e
h 	
(2.23)
where η is the wave impedance that is constant over the cross section S of the 
waveguide. In such case
	
η
=
ò
2
0
0
2
t
S
v
Z
dS
e
	
(2.24)
Because the modal field et is normalized and because of this the value 
of the denominator is fixed, the magnitude of Z0 depends only on v0. From 
(2.24) it is also seen that the phase of the characteristic impedance Z0 is equal 
to that of the wave impedance η.
This result indicates that the definition of mode characteristic imped-
ance given by (2.21) is in coincidence with most conventional definitions of 
Z0.
In particular for the TEM modes, η equals to the intrinsic wave imped-
ance of the medium fulfilling the line
	
=
µ
η
ε 	
(2.25)
and from this
	
{
}
0
1
arg
(arg{ }
arg{ })
2
Z
µ
ε
=
-
	
(2.26)
In the case when the medium of the line is a lossy dielectric and m is 
real then 
	
{
} = -
0
1
arg
2
Z
δ
	
(2.27)
where tgδ º Im{ε}/Re{ε} is the dielectric loss tangent.

	
Theory of Uniform Waveguides	
13
If in (2.24) v0 is taken to be the voltage between two conductors of 
the TEM line, then the mode characteristic impedance Z0 defined by (2.21) 
equals the conventional characteristic impedance of the TEM transmission 
line.
For TE and TM modes
	
±
æ
ö
=
-
ç
÷
ç
÷
è
ø
1/2
2
2
1
ck
µ
η
ε
ω µε
	
(2.28)
where the + sign corresponds to TM and the - sign corresponds to TE modes 
and 
π λ
= 2 /
c
c
k
 is the cutoff wave number in which λc is the cutoff wave-
length of a mode.
2.4  Normalization of Waveguide Voltage and Current
The magnitude of Z0 depends on the choice of v0 and i0. Because of a modal 
field normalization ((2.1) and (2.2)) and the constraint defined by (2.13), 
only one of these quantities may be assigned independently. One useful nor-
malization defines the constant v0 as the path integral
	
= -
×
ò
0
t
v
d
path
e
l
	
(2.29)
The path is restricted to a single transverse plane and the integral in 
general depends on the path between two given endpoints. When the mode 
in a waveguide is TEM or TM this integral depends only on the endpoints, 
not on the path between them.
Voltage v0 defined by (2.29) is analogous to voltage given by
	
= -
×
ò
( )
( )
t
v z
z
d
path
E
l
	
(2.30)
Normalization given by (2.29) together with (2.21) leads to the so-
called “voltage-power” definition of the characteristic impedance Z0. 
It is possible also to use the “current-power” definition by choosing i0 
to be a current. But because of (2.21) it is not possible to use the “voltage- 
current” definition of the characteristic impedance. It is so, because phases of 
v0 and i0 may not satisfy the relation v0 /i0 = Z0.

14 
Microwave Network Design Using the Scattering Matrix 
2.5  Transmission Line Equivalent Circuit of a Waveguide
Figure 2.1 presents the equivalent circuit of a uniform waveguide with dis-
tributed shunt capacitance C and conductance G and series resistance R and 
inductance L, all per unit length. These parameters are defined by [1, 2]
	
+
º
0
G
j C
Z
γ
ω
	
(2.31)
and
	
+
º
0
R
j L
Z
ω
γ
	
(2.32)
Derivations presented in [1, 2] lead to the following relations for the 
circuit parameters
	
é
ù
=
-
ê
ú
ê
ú
ë
û
ò
ò
2
2
2
0
1
'
'
z
S
S
C
ds
dS
v
ε
µ
te
h
	
(2.33)
	
é
ù
=
-
ê
ú
ê
ú
ë
û
ò
ò
2
2
2
0
1
'
'
z
S
S
L
ds
dS
i
µ
ε
t
h
e
	
(2.34)
	
é
ù
=
+
ê
ú
ê
ú
ë
û
ò
ò
2
2
2
0
1
''
''
z
S
S
G
ds
dS
v
ε
µ
te
h
	
(2.35)
	
é
ù
=
+
ê
ú
ê
ú
ë
û
ò
ò
2
2
2
0
1
''
''
z
S
S
R
ds
dS
i
µ
ε
t
h
e
	
(2.36)
where ε
ε
ε
º
-'
''
j
 and µ
µ
µ
º
-'
''
j
. In passive media all these parameters 
are nonnegative.
A transmission line with circuit parameters given above model a lossy 
waveguide characterized by a complex propagation constant γ  and a complex 
Figure 2.1  Uniform waveguide equivalent circuit.

	
Theory of Uniform Waveguides	
15
power flow P(z). This fact is very important when one wants to model prop-
erties of lines over lossy semiconductor substrates.
As it comes from these relations the parameters C, L, G, and R are nor-
malized, as Z0, with respect to v0 and i0. In a case of a lossless TEM line, when 
v0 is taken as the voltage between two active conductors, then L and C are the 
conventional inductance and capacitance per unit length of the line.
From (2.31) and (2.32), the characteristic impedance of the waveguide 
	
+
=
+
0
j L
R
Z
j C
G
ω
ω
	
(2.37)
and the propagation constant
	
(
)(
)
=
+
+
j L
R
j C
G
γ
ω
ω
	
(2.38)
The above relations are identical to those derived from the conven-
tional circuit theory for a transmission line with distributed shunt admittance  
Y = jωC + G and series impedance Z = jωL + R in which C, L, G, and R are 
the capacitance, inductance, conductance, and resistance per unit length of the 
line. In the steady state, sinusoidal voltage v and current i in a transmission line 
are described by equations presented and discussed in Chapter 3.
References
[1]	
Marks, R. B., and D. F. Williams, “A General Waveguide Circuit Theory,” Jour-
nal of Research of the National Institute of Standards and Technology, Vol. 97, 1992,  
pp. 533–62.
[2]	
Brews, J. R., “Transmission Line Models for Lossy Waveguide Interconnections in 
VLSI,” IEEE Trans. Electron Devices, ED-33, 1986, pp. 1356–65.
[3]	
Harrington, R. F., Time Harmonic Electromagnetic Waves, New York: McGraw Hill, 
1961.
[4]	
Montgomery, C. G., R. H. Dicke, and E. M. Purcell (eds.), Principles of Microwave 
Circuits, McGraw Hill, 1948.
[5]	
Marcuvitz, N., Waveguide Handbook, McGraw Hill, 1951.
[6]	
Collin, R.E., Foundations for Microwave Engineering, McGraw Hill Kogakusha, Ltd., 
Tokyo, 1966.


17
3
Theory of Transmission Lines
The use of transmission lines to model waveguides is very common. The 
theory of transmission lines plays a very important role in the analysis and 
design of a microwave network composed of waveguides. The analogy be-
tween waveguides and transmission lines comes from the fact that both struc-
tures propagate waves. A waveguide propagates waves of electric and mag-
netic fields, while voltage and current waves propagate in a transmission line. 
If the direction of wave propagation is chosen as the z-direction, then the  
z-dependence of the waves of transverse electric field in the waveguide and 
the z-dependence of the voltage in the equivalent transmission line are the 
same. The same statement is true for waves of transverse magnetic field in the 
waveguide and of the current waves in a transmission line.
In this chapter we present voltage and current wave propagation in 
transmission lines, define transmission line characteristic impedance, and 
discuss the total power flow. The relations for total voltage and total current 
are presented and discussed, and resulting from this the input impedance of 
terminated transmission line are given.
The relations presented here are helpful in deriving scattering parameters 
of many microwave elements composed of waveguides, coupled waveguides, 
terminated waveguides, and so forth. They will be used in next chapter, in 
examples illustrating theoretical derivation of transmission line segment scat-
tering parameters.

18 
Microwave Network Design Using the Scattering Matrix
3.1  Lumped Element Circuit Model of a Transmission Line
The transmission line can be described as a distributed-parameter electric net-
work [1–5]. The equivalent circuit of a section of transmission line of differential 
length is presented in Figure 2.1. Parameters R[W/m], L[H/m], G[S/m], and 
C [F/m] of this circuit are, respectively, resistance, inductance, conductance, and 
capacitance per unit length of the line. They are given by (2.33) through (2.36).
Resulting from Kirchhoff laws, equations of this equivalent circuit are 
[1–5]
	
¶
¶
= -
-
¶
¶
( , )
( , )
( , )
v z t
i z t
Ri z t
L
z
t
	
(3.1)
and
	
¶
¶
= -
-
¶
¶
( , )
( , )
( , )
i z t
v z t
G v z t
C
z
t
	
(3.2)
For sinusoidal steady state, when v(z) and i(z) represent the voltage and cur-
rent without the time dependence j t
e ω , the basic equations for the circuit are
	
= -
+
( )
(
) ( )
dv z
  j L
R  I z
dz
ω
	
(3.3)
	
= +
+
( )
(
) ( )
di z    j C
G  v z
dz
ω
	
(3.4)
where v(z.t) = v(z) e jωt and i(z,t) = i(z) e jωt are complex voltage and current 
in the line.
3.2  Voltage and Current Wave Propagation in a Transmission Line
From (3.3) and (3.4), the wave equations for v(z) and i(z) in a transmission 
line have the form
	
-
=
2
2
2
( )
( )
0
v z
d
  
 v z   
dz
γ
	
(3.5)
	
-
=
2
2
2
( )
( )
0
i z
d
  
 i z   
dz
γ
	
(3.6)

	
Theory of Transmission Lines	
19
where
	
=
+
=
+
+
=
-
+
+
+
2
(
)(
)
(
)
j   
R
j L G
j C
 
LC
RG
j
RC
LG
γ
α
β
ω
ω
ω
ω
	
(3.7)
is the complex propagation constant.
The general solution to (3.5) is
	
+
-
+
-
-
=
+
=
+
( )
( )
( )
( )
0
0
( )
( )
( )
z
z
v z
V
 
  V
 
V
z
V
z
e
e
γ
γ
	
(3.8)
The solution for the currrent i from (3.6) is
	
+
-
+
-
-
=
-
=
-
( )
( )
( )
( )
0
0
( )
( )
( )
z
z
i z   I
 
  I
 
I
z
I
z
e
e
γ
γ
	
(3.9)
or
	
( )
( )
0
0
0
0
( )
z
z
V
V
i z   
 
  
 
e
e
Z
Z
γ
γ
+
-
-
=
-
	
(3.10)
where
	
+
+
=
+
0
R  j  L
R
j L
= 
Z
G
j C
ω
ω
γ
ω
	
(3.11)
is the characteristic impedance of the line.
In both (3.10) and (3.11), the first term represents the wave propagat-
ing in the +z direction, and the second term represents the wave propagating 
in –z direction of the z-axis. Quantities V0
(+), I0
(+), V0
(-), and I0
(-) are complex 
amplitudes of voltages and currents of voltage waves and current waves at 
point z = 0 of the transmission line.
The characteristic impedance 
	
+
-
+
-
=
= -
( )
( )
0
0
0
( )
( )
0
0
V
V
 
Z
I
I
	
(3.12)
of the line is equal to the ratio of the complex voltage amplitude 
+
( )
0
V
 (or 
-
( )
0
V
) of the voltage wave, to the complex current amplitude 
+
( )
0I
 (or - 
-
( )
0I
) of 
the current wave propagating in +z direction (or in –z direction) of the line.

20 
Microwave Network Design Using the Scattering Matrix
A ratio of reflected and incident voltage wave amplitudes at any point 
l = - z of the line
	
-
-
-
-
+
+
G
=
=
= G
( )
( )
2
2
0
( )
( )
0
( )
l
l
L
V
V
l
e
e
V
V
γ
γ
	
(3.13)
is called the voltage reflection coefficient. In (3.13) 
	
-
+
-
G =
=
+
( )
0
0
( )
0
0
L
L
L
V
Z
Z
Z
Z
V
	
(3.14)
is the load reflection coefficient.
The total power flow at z is given by
	
(
)
(
)(
)
{
}
(
)
(
)
{
}
{ }
{ }
+
-
+
-
+
-
+
-
+
=
=
+
-
=
+
-
æ
ö
=
- G
-
G
ç
÷
è
ø
*
*
( )
( )
( )
( )
*
( )
( )
*
( )
( )
0
2
0
0
( )
1
2
{ }
P z
Re vi
Re
V
V
I
I
Re
V
V
Y
V
V
Im Y
P
Im
Re Y
	
(3.15)
where
	
{ }
{ }
α
-
+
+
+
=
=
2
2
2
( )
( )
0
0
0
( )
z
P
z
Re Y
V
Re Y
V
e
	
(3.16)
is the power transmitted by the wave propagating in the +z direction and  
Y0 = 1/Z0 is the complex characteristic admittance of the transmission line.
In the case of a dissipative transmission line G 2 cannot be regarded as 
the power reflection coefficient. The value of G may exceed unity if Z0 is not 
real.
In the case of a lossless line, R = 0 and G = 0, (3.7) describing propaga-
tion coefficient has a form
	
 =  + j  = j  LC
γ
α
β
ω
	
(3.17)
which means that
	
0 oraz
 =   
   =  LC
α
β
ω
	
(3.18)

	
Theory of Transmission Lines	
21
and the characteristic impedance of a transmission line is real and equal
	
0
L
 = 
Z
C 	
(3.19)
The resulting traveling wave solutions are now represented as 
	
+
-
+
-
-
=
+
=
+
0
0
( )
( )
( )
j z
j z
v z
V  
 V  
V
z
V
z
e
e
β
β
	
(3.20)
	
0
0
0
0
( )
( )
( )
j z
j z
V
V
i z
 
  
 
I
z
I
z
e
e
Z
Z
β
β
+
-
+
-
-
=
-
=
-
	
(3.21)
The voltage reflection coefficient is now
	
-
-
-
+
G
=
= G
0
0
0
2 (
)
2 (
)
0
0
( )
(
)
j
z z
j
z z
V
z
e
z
e
V
β
β
	
(3.22)
In a nondissipative uniform transmission line the total average power 
flow at any point z becomes
      
(
)
(
)
(
)
2
2
2
( )
( )
( )
0
0
0
2
2
*
0
0
0
Re
1
1
V
V
V
P
vi
P
Z
Z
Z
+
-
+
+
=
=
-
=
- G
=
- G
	
(3.23)
This equation is simple to interpret. This power equals the difference 
between the incident and the reflected power flowing down the transmission 
line. G 2 is the just the power reflection coefficient.
3.3  Terminated Transmission Line
We assume now that a transmission line presented in Figure 3.1 is excited by a 
signal source located on the left of the origin of the coordinate system (z < 0). 
Because at the end of the line the ratio v/i is equal to ZL, and simultaneously 
+
+ =
0
/
V
I
Z , it means that the wave transmitted in the line must be reflected 
from the load in such a way that the ratio of the resultant voltage v and  the 
resultant current  i at the end of the line is equal to ZL.

22 
Microwave Network Design Using the Scattering Matrix
The total voltage and total current in the line can be expressed as
	
( )
0
( )
l
l
L
v l
 V
 
  
 
e
e
γ
γ
+
-
é
ù
=
+ G
ë
û	
(3.24)
and
	
( )
0
0
( )
l
l
L
V
i l   
 
 
 
e
e
Z
γ
γ
+
-
é
ù
=
- G
ë
û
	
(3.25)
where l = –z is the positive distance measured from the load toward the  
generator.
For a lossless transmission line, (3.24) and (3.25) are
	
( )
0
( )
j l
j l
L
v l
 V
 
 
e
e
β
β
+
-
é
ù
=
+ G
ë
û	
(3.26)
	
( )
0
0
( )
j l
j l
L
V
i l
 
 
e
e
Z
β
β
+
-
é
ù
=
- G
ë
û
	
(3.27)
where
	
-
+
-
=
=
G
+
( )
0
0
( )
0
0
L
L
L
V
  
Z
Z
  
  
  
V
Z
Z 	
(3.28)
When the load impedance equals the characteristic impedance, 
0
L = 
Z
Z , 
then 
=
G
0
L  , which means that there is no reflected wave. When GL = 0, the 
i z( )
u z( )
Z , γ
0
iL
ZL
vL
z
l
0
l
Figure 3.1  Terminated transmission line.

	
Theory of Transmission Lines	
23
whole power transmitted in the wave propagating in the +z dirrection dissipates 
in the load.
Using (3.24) and (3.25), we can determine the input impedance at a 
distance l = -z from the end of the line (from the load ZL), “looking” toward 
the load. This impedance
	
( )
0
( )
2
0
2
( )
( )
( )
1
1
l
l
L
in
l
l
L
l
L
l
L
V l
V
e
e
 l
 
  
Z
Z
I l
V
e
e
 e
 
 
Z
 e
γ
γ
γ
γ
γ
γ
+
-
+
-
-
-
é
ù
+ G
ë
û
=
=
é
ù
- G
ë
û
+ G
=
- G
	
(3.29)
Using (3.29) in (3.28), we also have
	
-
-
+
+
-
=
+
-
-
+
=
+
+
=
+
0
0
0
0
0
0
0
0
0
0
0
(
)
(
)
( )
(
)
(
)
cosh
sinh
cosh
sinh
tanh
tanh
l
l
L
L
in
l
l
L
L
L
L
L
L
 
 
e
e
Z
Z
Z
Z
l   
 
 
Z
Z
 
 
e
e
Z
Z
Z
Z
 
l
 
l
Z
Z
 
 
 
Z
 
l  
 
l
Z
Z
 
 
l
Z
Z
 
 
Z
 
l
Z
Z
γ
γ
γ
γ
γ
γ
γ
γβ
γ
γ
	
(3.30)
For a lossless transmission line 
	
0
0
0
0
0
0
0
0
(
)
(
)
( )
(
)
(
)
cos
sin
cos
sin
tan
tan
j l
j l
L
0
L
0
in
j l
j l
L
0
L
L
L
L
L
 
 
e
e
Z
Z
Z
Z
l
 
 
Z
Z
 
 
e
e
Z
Z
Z
Z
 
l
 j
 
l
Z
Z
 
 
Z
jZ
 
l
 
 
l
Z
j 
 
l
Z
Z
 
 
Z
j 
 
l
Z
Z
β
β
β
β
β
β
β
β
β
β
-
-
+
+
-
=
+
-
-
+
=
+
+
=
+
	
(3.31)
It comes from the above relation that the lossless transmission line in-
put impedance is a periodic function of the line length l, with a period equal 
to λg/2.

24 
Microwave Network Design Using the Scattering Matrix
In the same way we can determine the input admittance of the line. It 
is
	
0
0
0
0
0
0
0
0
0
0
0
(
)
(
)
( )
(
)
(
)
cosh
sinh
cosh
sinh
tanh
tanh
l
l
L
L
in
l
l
L
L
L
L
L
L
 
 
e
e
Y
Y
Y
Y
Y
l
 
  
Y
 
 
e
e
Y
Y
Y
Y
 
l
Y  
l
Y
 
 
Y
 
l
 
 
l
Y
Y
 
l
Y
Y
 
 
Y
 
l
Y
Y
γ
γ
γ
γ
γ
γ
γ
γ
γ
γ
-
-
+
+
-
=
+
-
-
+
=
+
+
=
+
	
(3.32)
and for a lossless transmission line
	
-
-
+
+
-
=
+
-
-
+
=
+
+
=
+
0
0
0
0
0
0
0
0
0
(
)
(
)
( )
(
)
(
)
cos
sin
cos
sin
tan
tan
j l
j l
L
L
in
j l
j l
L
L
L
L
L
0
0
L
 
 
e
e
Y
Y
Y
Y
l
 
 
 
Y           Y
 
 
e
e
Y
Y
Y
Y
 
l
j
 
l
Y
Y
 
 
Y
jY
 
l
 
l
Y
j 
 
l
Y
Y
 
 
Y
j 
 
l
Y
Y
β
β
β
β
β
β
β
β
β
β
	
(3.33)
where Y0 = 1/Z0 and YL = 1/ZL.
For lossless transmission lines, both functions Zin(βl ) and Yin(βl ) are 
periodic and the period equals π. Because βl = 2π l/λg, the same value of the 
input impedance Zin (or the input admittance Yin) repeats along the line every 
distance equal to λg/2, which means that
	
=
+
=
( )
(
/2),
1,2,3,...
in
in
g
Z
l
Z
l
k
k
λ
	
(3.34)
	
=
+
=
( )
(
/2),
1,2.3,...
in
in
g
Y
l
Y
l
k
k
λ
	
(3.35)
3.4  Terminated Transmission Line Special Cases
The special cases of terminated transmission lines considered now are short 
circuited (ZL = 0) and open circuited (ZL = ∞) lossless transmission lines.

	
Theory of Transmission Lines	
25
In the case of a short circuit at the end transmission line, the load reflec-
tion coefficient ΓL = -1, the load voltage v(0) = 0, the load current i(0) reaches 
maximum value and according to (3.28), the input impedance of such a line
	
=
=
0
( )
tan
in
in
Z
l
jZ
l
jX
β
	
(3.36)
The input impedance Zin of the short-circuited transmission line is 
purely imaginary and its value depends on line length l. For l = 0 + k λg / 2, k =  
1,2,3,..., Zin = 0, and for l = λg /4 + k λg /2, k = 0,1,2,3,..., Zin = ¥.
In a case of an open circuit at the end of the transmission line, the load 
reflection coefficient GL = 1, load current i(0) = 0, load voltage reaches maxi-
mum, and according to (3.28), the input impedance of such line is
	
= -
=
0
( )
cot
in
in
Z
l
jZ
l
jX
β
	
(3.37)
Input impedance Zin of the open circuited transmission line is purely 
imaginary and its value depends on line length l. For l = 0 + k λg / 2, k = 
0,1,2,3..., Zin = ¥ (open circuit), and for l = λg/4 + k λg / 2, k = 0,1,2,3...,, Zin 
= 0 (short circuit).
Two other very important cases of terminated transmission lines are a 
line with length l = λg /2 and a line with length l = λg /4.
If l = λg /2, then according to (3.31)
	
=
in
L
Z
Z 	
(3.38)
which means that the transmision line with length equal to a half of a wave-
length or a multiple of a half of a wavelength does not change the impedance 
value. This property does not depend on the value of the transmission line 
characteristic impedance Z0.
When the transmission line length equals λg /4 (a quarter of the wave-
length), or more generally, when l = λg /4 + k λg /2, k = 0,1,2,3,..., then ac-
cording to (3.31) its input impedance satisfies the relation
	
=
20
in
L
Z
Z
Z 	
(3.39)
Such a line is called a quarter wavelength transformer.
In a case when a transmission line is terminated by a load with imped-
ance ZL equal to the transmission line characteristic impedance Z0, then in-
dependently on line length l

26 
Microwave Network Design Using the Scattering Matrix
	
=
0
in
Z
Z 	
(3.40)
Such a line load is called a matching load.
References
[1]	
Collin, R. E., Foundations for Microwave Engineering, Tokyo: McGraw-Hill, Ltd., 
1992.
[2]	
Pozar, D. M., Microwave Engineering, New York: Addison-Wesley Publishing Co., 
1990.
[3]	
Russer, P., Elecomagnetics, Microwave Circuit and Antenna Design for Communications 
Engineering, Norwood, MA: Artech House, 2006.
[4]	
Nibler, F., High-Frequency Circuit Engineering, IEE Circuits and Systems, Series 6, 
London: The Institution of Electrical Engineers, 1990.
[5]	
Ramo, S., J. R. Whinnery, and T. Van Duzer, Field and Waves in Communication Elec-
tronics, New York: J. Wiley & Sons, Inc., 1965.

27
4
Wave Variables and the Scattering  
Matrix
In this chapter, we review different definitions of wave variables that are 
presented in the literature [1–6, 8–10]. Definitions of voltage traveling 
waves and the scattering matrix, normalized voltage traveling waves and the 
generalized scattering matrix, traveling wave intensities and the true scatter-
ing matrix, pseudowaves and the pseudoscattering matrix, and power scat-
tering waves and the power scattering matrix are discussed and compared. 
We also discuss the physical interpretation of these wave variables, proper-
ties of different scattering parameters, conversions between scattering ma-
trices and the impedance and the admittance matrices, and the relations for 
reference impedance renormalization. Some examples illustrate differences 
between the different approaches to the wave variables and the scattering 
parameters. Because many microwave networks and systems may be con-
sidered as cascade connections of two-port networks, we discuss an efficient 
method for computation of the resultant scattering matrix of a cascade of 
two two-port networks described by their individual scattering matrices. 
We present generalized multiport cascade (transfer scattering) matrix, very 
useful and convenient in network description of cascaded multiport net-
works, applicable in analysis of multiline interconnects. We also present 
problems encountered in characterization of active devices, and how to 

28 
Microwave Network Design Using the Scattering Matrix 
transform three-port scattering parameters of three-terminal devices into 
equivalent two-port scattering parameters and vice versa. These procedures 
have their place in transistor scattering parameter transformation for differ-
ent common terminal configurations. Finally, we present a procedure for 
resultant scattering matrix computations of embedded multiport networks. 
This procedure is used in active device modeling and characterization prob-
lems. An embedded network represents an intrinsic chip of an active de-
vice, while passive parasitic elements, such as resistances, inductances, and 
capacitances create an embedding network. Similar procedures are used in 
deembedding real DUT data from vector network analyzer measurement  
data.
4.1  Voltage Traveling Waves and the Scattering Matrix
Let us consider a linear microwave network with an arbitrary number of uni-
form transmission lines (waveguides) that create ports of the network. To 
define a port in each waveguide a cross-sectional reference is chosen. It is 
assumed that at the reference plane only a single mode exists. This condi-
tion will be fulfilled by choosing the reference plane sufficiently far from 
waveguide connection that it can be assumed that higher-order modes have 
decayed and are negligible.
As discussed in Chapter 3, the incident and reflected voltage waves trav-
eling in the transmission lines creating ports of a multiport can be considered 
as wave variables at these ports of the network. This definition of wave vari-
ables was introduced by R.E. Collin in 1966 [1]
	
( )
a
v +
º
	
(4.1)
	
( )
b
v -
º
	
(4.2)
Voltage traveling waves are discussed in Chapter 3 and they are de-
fined by (3.8). Figure 4.1 illustrates a multiport network with incident and 
reflected waves at its ports.
The scattering matrix, or S-matrix, is defined in relation to these inci-
dent and reflected voltage waves by the equation
	
=
b
Sa	
(4.3)

 
Wave Variables and the Scattering Matrix 
29
In (4.3)
	
( )
1
1
( )
2
2
( )
( )
:
:
N
N
v
a
a
v
a
v
+
+
+
+
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
=
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ê
ú
ë
û
a
V
	
(4.4)
and
	
( )
1
1
( )
2
2
( )
( )
:
:
N
N
v
b
b
v
b
v
-
-
-
-
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
=
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ê
ú
ë
û
b
V
	
(4.5)
are vectors of incident and reflected voltage waves. S is the complex squared 
matrix.
S
-port
N
a1
b1
a2
b2
ai
bi
an
bn
aj
bj
Figure 4.1  N-port network with scattered waves at its ports.

30 
Microwave Network Design Using the Scattering Matrix 
4.1.1  Physical Interpretation of Scattering Parameters
A specific element of the scattering matrix from the main diagonal can be 
determined as
	
( )
( )
( )
0 for
k
i
ii
i
v
k i
v
S
v
+
-
+
=
¹
=
	
(4.6)
Thus, Sii is the voltage reflection coefficient of the ith port when all 
other ports are terminated in matched loads. Matched loads requirement 
comes from the condition ( )
0 for 
kv
k
i
+ =
¹ .
The off-diagonal element of the S-matrix can be determined as
	
( )
( )
( )
0 for
k
i
ij
j
v
k
j
v
S
v
+
-
+
=
¹
=
	
(4.7)
which means that Sij is the ratio of the outgoing wave voltage amplitude ( )
iv - , 
coming out of port i, to the incident wave voltage amplitude ( )
jv +
 
at the port 
j, when all other ports are terminated in matched loads. Both voltage ampli-
tudes are referenced to reference planes of the considered ports. At the same 
time the incident waves at all ports except driven port j are equal to 0, which 
means that all ports must be terminated in matched loads.
The Sij parameter is the voltage transmission coefficient from port j to 
port i, with the assumption that all other ports are loaded by matched loads.
Because scattering parameters relate amplitudes (both magnitude and 
phase) of traveling wave voltages, reference planes must be specified at each 
port of the network.
If we want to relate wave variables defined by (4.1) and (4.2) with a 
power transmitted in all ports, it is possible to assume that transmitted in + z 
direction power in ith port is given by [1]
	
2
( )
1
2
i
i
P
v
+
+
=
	
(4.8)
while a power transmitted in a port in the –z direction
	
2
( )
1
2
i
i
P
v
-
-
=
	
(4.9)

 
Wave Variables and the Scattering Matrix 
31
This corresponds to choosing, for all ports, the equivalent characteristic 
impedances Z0 equal to unity. Of course any value different from Z0 = 1W 
would also be possible and suitable. In such case transmitted powers will al-
ways be equal to 
2
( )
iv +
 and 
2
( )
v -
 multiplied by some constant.
With the assumed normalization (Z0 = 1W) the total voltage v and the 
total current i at the reference plane of the port are
	
( )
( )
v
v
v
+
-
=
+
	
(4.10)
and
	
( )
( )
( )
( )
i
i
i
v
v
+
-
+
-
=
-
=
-
	
(4.11)
Thus the wave variables are linear combinations of variables v and i
	
( )
2
v
i
v +
+
=
	
(4.12)
and
	
( )
2
v
i
v -
-
=
	
(4.13)
The real power that flows across reference plane of a port is 
	
{ }
(
)
{
}
(
)
2
2
( )
( )
( ) ( )
( ) ( )
2
2
2
2
( )
( )
1
1
*
*
*
( )
R
R
2
2
1
1
2
2
P z
e vi
e v
v
v
v
v
v
v
v
a
b
+
-
-
+
+
-
+
-
=
=
-
+
-
æ
ö
=
-
=
-
è
ø
	
(4.14)
since the quantity 
 (
)
( ) ( )
( ) ( )
*
*
v
v
v
v
-
+
+
-
-
 is purely imaginary. The net real 
power P crossing the reference plane is equal to the difference of the power 
carried by the forward and backward waves acting independently. This result 
comes from the fact that the uniform transmission line propagating voltage 
waves is assumed to be lossless.
The reflection coefficient G of voltage waves is defined by
	
( )
( )
( )
1
( )
( )
1
b z
v
v
i
Z
z
a z
v
i
Z
v
-
+
-
-
G
=
=
=
=
+
+ 	
(4.15)

32 
Microwave Network Design Using the Scattering Matrix 
In (4.15) Z = v/i is the impedance seen at the reference plane looking 
forward to the line.
4.1.2  A Shift in Reference Plane
The scattering matrix elements (scattering parameters) are functions of fre-
quency and of locations of reference planes that define the network ports. Val-
ues of scattering matrix elements change with frequency in a manner that is 
not generally deduced analytically. At fixed frequency, changes of locations of 
reference planes specified for each port and related to this transformation of 
the scattering matrix is easy to establish. To do this let us consider the N-port 
presented in Figure 4.2.
The original terminal plane of the ith port is located at zi = 0 (zi is the 
length coordinate measured along the transmission line forming the ith port). 
The scattering matrix of the original network is S. Let us assume now that ref-
erence planes have been shifted outward to the locations zi = li , i = 1,2,…,N, 
and the new scattering matrix be denoted as S/.
For the network defined by a set of original reference planes located at 
zi = 0 we can write
	
( )
( )
-
+
=
V
SV
	
(4.16)
while for the network referenced to the new set of reference planes located 
at zi = li
	
/( )
/
/( )
-
+
=
V
S V
	
(4.17)
S, S´
-port
N
z
0
=
j
z
l
=
j
j
z
0
=
i
z
l
=
i
i
z
0
=
n
z
l
=
n
n
z
0
=
2
z
l
=
1
1
Figure 4.2  N-port with shifted reference planes at its ports.

 
Wave Variables and the Scattering Matrix 
33
Using the theory of lossless transmission lines we can write relations 
between voltage wave amplitudes at original reference planes (zi = 0) and at 
new reference planes (zi = li)
	
/( )
( )
i
j
i
i
v
v
e θ
+
+
=
	
(4.18)
	
( )/
( )
i
j
i
i
v
v
e
θ
-
-
-
=
	
(4.19)
where qi = bli is the electrical length of the outward shift of the reference 
plane of port i.
Writing (4.18) and (4.19) in matrix form gives
	
/( )
( )
+
+
=
V
DV
	
(4.20)
	
/( )
( )
*
-
-
=
V
D V
	
(4.21)
where V/(+) and V(+)  are vectors of voltage amplitudes of incident waves and 
V/ - and V- voltage amplitudes of outgoing waves at all circuit ports of the 
original network and of the network with new reference planes, respectively. 
D is the diagonal matrix whose ith diagonal component is given by 
i
je θ . D* 
indicates the complex conjugate of D.
Substituting (4.20) and (4.21) into (4.17) gives
	
( )
/
( )
*
-
+
=
D V
S DV
	
(4.22)
Then using (4.16) we get
	
D SV
S DV
*
( )
/
( )
+
+
=
	
(4.23)
and finally multiplying (4.23) (from the right side) by the inverse of DV(+) we 
find the desired result
	
/
*
*
*
-
=
=
1
S
D SD
D SD 	
(4.24)
(because D-1 = D*). It is important to note that 
2
/
i
j
ii
ii
S
e
S
θ
-
=
, which means 
that the change in phase of Sii is twice the electrical length of the shift in the 
ith reference plane. This is because the wave travels reference shift distance 
twice, forth and back.

34 
Microwave Network Design Using the Scattering Matrix 
4.1.3  Scattering Matrix Properties
In special cases of networks, their scattering matrices have to satisfy some 
conditions.
4.1.3.1  Reciprocal Network
For a reciprocal network, the scattering matrix defined by (4.1) through (4.5) 
is symmetrical; that is [1]
	
=
T
S
S 	
(4.25)
provided that the equivalent voltages are chosen so that the transmitted power 
is given by 
2
1
2
iv
 for all ports. Equation (4.25) comes from the fact that the 
reciprocal network is assumed to be lossless.
4.1.3.2  Lossless Network
In a case of lossless network, the total power entering the N-ports must be 
equal to the total leaving power. This is a power conservation condition and 
mathematically it is represented as
	
2
2
( )
( )
1
1
0
N
N
i
i
i
i
v
v
+
-
=
=
-
=
å
å
	
(4.26)
As it has been shown in [1], this equation can hold only if
	
*T =
S S
I	
(4.27)
where * stands for complex conjugate, T for transpose, and I is the unit, or 
identity, matrix. The result (4.27) is the definition of the unitary matrix.
Example 4.1
Using definitions of voltage traveling waves and of the scattering matrix 
given by (4.1) through (4.3), find the S-parameters of a transmission 
line segment with the characteristic impedance Z0, phase constant b, 
and the length l.
Solution
Equation (3.8) describes traveling voltage waves in a transmission line. 
From (4.6) it can be found that S11 is the voltage reflection coefficient 

 
Wave Variables and the Scattering Matrix 
35
seen at port 1 when port 2 is terminated by a matched load. It means 
that there is no voltage wave in the line traveling back:
	
( )
2
2
( )
1
1
11
( )
( )
1
1
0
0
0
(
0)
0
0
(
0)
a
V
b
v
z
S
a
v
z
V
+
-
+
+
=
=
=
=
=
=
=
=
	
(4.28)
Similarly, we have
	
( )
2
2
( )
( )
2
0
2
21
( )
( )
1
1
0
0
(
)
(
0)
j l
j l
o
a
V
V
e
b
v
z
l
S
e
a
v
z
V
β
β
+
-
+
-
-
+
+
=
=
=
=
=
=
=
=
	
(4.29)
Because of the symmetry of the discussed network, the S matrix is sym-
metrical, and the following relations hold: S11 = S22 and S12 = S21. Then 
we can write
	
0
0
j l
j l
e
e
β
β
-
-
é
ù
= ê
ú
ê
ú
ë
û
S
	
(4.30)
4.1.4  Conversions Between the Scattering Matrix and Other Matrix  
Descriptions of Microwave Networks
4.1.4.1  The Impedance Matrix
The impedance matrix is defined as
	
=
v
Zi	
(4.31)
where v and i are vectors of waveguide voltages and currents at the vari-
ous ports of a network. Waveguide voltages and currents discussed in Chap-
ter 2 are variables independent of the reference impedance. Because of this, 
the Z matrix also does not depend on the reference impedance of network  
ports.
The scattering matrix in terms of the impedance matrix is [1]
	
1
(
)(
)-
=
-
+
S
Z
I Z
I
	
(4.32)
or
	
(
) (
)
-
=
+
-
1
S
Z
I
Z
I 	
(4.33)
where I is the unit matrix.

36 
Microwave Network Design Using the Scattering Matrix 
The reverse relation is [1]
	
(
) (
)
-
=
-
+
1
Z
I
S
I
S 	
(4.34)
or
	
1
(
)(
)-
=
+
-
Z
I
S I
S
	
(4.35)
4.2  Normalized Voltage Traveling Waves and the  
Generalized Scattering Matrix
It is possible to normalize the incident and reflected voltage waves at each 
port of the network in such a way that amplitudes of the new wave variables 
receive physically meaningful relationships with transmitted powers. Such an 
approach was proposed by S. Ramo, T. R. Whinnery, and T. van Duzer in 
1965 [2].
If we assume that characteristic impedance Z0i of each port of an N-port 
is real, we may define a new set of wave variables as
	
+
+
=
=
0
0
( )
( )
( )
i
i
i
i
i
v
z
a z
i
z
Z
Z
	
(4.36)
	
-
-
=
=
0
0
( )
( )
( )
i
i
i
i
i
v
z
b z
i
z
Z
Z
	
(4.37)
where ai represents an incident wave at the ith port, and bi represents a re-
flected wave at that port. Using (4.36) and (3.37), we receive
	
+
-
=
+
=
+
( )
( )
0
( )
( )
( )
(
)
i
i
i
i
i
i
v z
v
z
v
z
Z
a
b 	
(4.38)
	
( )
( )
( )
( )
0
0
1
1
( )
( )
( )
(
)
(
)
i
i
i
i
i
i
i
i
i
i z
i
z
i
z
v
v
a
b
Z
Z
+
-
+
-
=
-
=
-
=
-
	
(4.39)
	
+
-
+
-
=
= -
( )
( )
0
( )
( )
( )
( )
( )
( )
i
i
i
i
i
v
z
v
z
  
  
Z
i
z
i
z 	
 (4.40)

 
Wave Variables and the Scattering Matrix 
37
Now the real power, which flows across reference plane of the i-th port is
	
{
}
(
)
{
}
=
=
-
+
-
=
-
2
2
2
2
1
1
*
*
*
2
2
1
1
2
2
i i
i
i
i i
n n
i
i
P
Re v i
Re a
b
b a
b a
a
b
	
(4.41)
This result means that the average power delivered to the ith port is 
equal to the difference of power transmitted by incident wave a and power 
transmitted by reflected wave b.
A generalized scattering matrix is defined now by the equation
	
=
b
S a	
(4.42)
in which b and a are vectors whose elements are outgoing and ingoing nor-
malized wave variables.
4.2.1  Physical Interpretation of Generalized Scattering Parameters
The i,ith element of the generalized scattering matrix 
	
( )
( )
0
( )
0
1,2,...,
1,2,...,
k
k
i
i
a
ii
v
k
N
i
i
k
N
k i
k i
b
v
S
a
v
+
-
=
+
=
=
=
¹
¹
=
=
	
(4.43)
is analogous to the scattering parameter resulting from (4.6) for networks 
with identical characteristic impedances Z0 at all ports. It is the voltage reflec-
tion coefficient at the ith port of the network with all other ports terminated 
by matched loads.
The j,ith element of the generalized scattering matrix 
	
( ) 0
1,2
( )
0
( )
0
v
 = 0
a
k
k
k
...,N
 k = 1,2,...,N
 k  i
 k  i
j
j
i
ji
j
i
i
v
b
Z
 = 
  
 = 
  
s
Z
v
a
+ =
=
¹
¹
-
+
	
(4.44)
is a transmission coefficient from port i to port j of the voltage wave when all 
ports of the junction are terminated by matched loads.

38 
Microwave Network Design Using the Scattering Matrix 
This result shows also that the scattering parameters of a junction (net-
work) with equal characteristic impedances of ports can be converted to the 
S-parameters corresponding to a network with ports in a form of transmis-
sion lines with unequal characteristic impedances.
Example 4.2
Using definitions of normalized voltage traveling waves and of the gen-
eralized scattering matrix given by (4.36), (4.37), and (4.42), find the  
S-parameters of a transmission line segment with the characteristic im-
pedance Z0, phase constant b, and the length l. This two-port is pre-
sented in Figure 4.3.
Solution
Equation (3.8) describes traveling voltage waves in a transmission line. 
From (4.43), it can be found that S11 is the voltage reflection coefficient 
seen at port 1 when port 2 is terminated by a matched load. It means 
that there is no voltage wave in the line traveling back:
	
( )
2
2
( )
1
1
11
( )
( )
1
1
0
0
0
(
0)
0
0
(
0)
a
V
b
v
z
S
a
v
z
V
+
-
+
+
=
=
=
=
=
=
=
=
	
(4.45)
Similarly, from (4.44), we have
	
( )
2
2
( )
( )
2
01
0
2
21
( )
( )
1
02
1
0
0
0
(
)
(
0)
j l
j l
a
V
V
e
b
v
z
l
Z
S
e
a
Z
v
z
V
β
β
+
-
+
-
-
+
+
=
=
=
=
=
=
=
=
	
(4.46)
Because this network is symmetrical, the S-matrix is symmetrical, and 
the following relations hold: S11 = S22 and S12 = S21. Then we can write
a1
Z  , γ
0
b1
a2
b2
l
Figure 4.3  Segment of a transmission line with length l.

 
Wave Variables and the Scattering Matrix 
39
	
0
0
j l
j l
e
e
β
β
-
-
é
ù
= ê
ú
ê
ú
ë
û
S
	
(4.47)
4.3  Traveling Wave Intensities and the True Scattering Matrix
In 1992 R. B. Marks and D. F. Williams introduced another definition of 
wave variables that they called traveling wave intensities [6]. By normalizing 
the forward and backward mode fields in uniform waveguide and given by 
(2.1) and (2.2), they defined the forward and backward wave variables as 
traveling wave intensities
	
0
0
0
0
0
{
}
{
}
(
)
2
z
Re p
a
Re p c e
v
iZ
v
γ
-
+
º
=
+
	
(4.48)
and
	
0
0
0
0
0
{
}
{
}
(
)
2
z
Re p
b
Re p c e
v
iZ
v
γ
+
-
º
=
-
	
(4.49)
It is assumed in (4.48) and (4.49) that the positive square root is  
mandated.
Because traveling wave intensities, or shortly, traveling waves are solu-
tions of Maxwell’s equations they depend exponentially on the axial coordinate 
z as 
z
e γ
±
, where g   is the propagation constant. Ratios of the traveling wave 
amplitudes can be measured using “old” slotted line techniques or present- 
day vector network analyzer instrumentation.
It can be shown that traveling waves a0 and b0 are [6]:
1.	 Independent of the arbitrary normalization of v0;
2.	 Dependent on the phase of the modal field et (2.1);
3.	 Independent of the magnitude of the modal field et.
The reverse relationships to (4.48) and (4.49) are
	
0
0
0
0
( )
(
)
{
}
v
v z
a
b
Re p
=
+
	
(4.50)

40 
Microwave Network Design Using the Scattering Matrix 
	
0
0
0
0
( )
(
)
{
}
i
i z
a
b
Re p
=
-
	
(4.51)
The reflection coefficient of traveling waves is defined as
	
0
0
0
0
0
( )
( )
( )
b
Z z
Z
z
a
Z z
Z
-
G
=
=
+
	
(4.52)
where
	
( )
( )
( )
v z
Z z
i z
=
	
(4.53)
The real power is
	
{
}
{ }
{ }
=
=
-
+
2
2
0
0
0
0 0
0
*
*
( )
2
Im Z
P z
vi
a
b
Im a b
Re Z
	
(4.54)
From this equation we see that the net real power P crossing a reference 
plane is not equal to the difference of the powers carried by the forward and 
backward waves. P(z) depends also on the phase of Z0 and as it was shown in 
Chapter 2 this phase is not arbitrary.
The real power can be expressed also as
	
{
}
{
}
{
}
2
2
0
0
0
0
0
( )
1
2
Im Z
P z
a
Im
Re Z
é
ù
=
- G
-
G
ê
ú
ë
û	
(4.55)
It is obvious from (4.54) or (4.55) that 
2
0
G
 is not a power reflection co­
efficient. If Z0 is complex, not real, for passive loads 
2
0
G
 may be bigger than 1.
The real power is
	
2
2
0
0
*
( )
P z
vi
a
b
=
=
-
	
(4.56)
only when the characteristic impedance Z0 is real (Im{Z0} = 0) or when either 
forward or backward waves do not exist in the waveguide.
The true scattering matrix S0 is defined as
	
0
0 0
=
b
S a 	
(4.57)
where a0 and b0 are vectors of incoming and outgoing traveling wave intensi-
ties whose elements are the a0i and b0i of individual ports, where i indicates 

 
Wave Variables and the Scattering Matrix 
41
the port number. Characteristic impedances Z0i of individual ports may be, 
in general, nonidentical.
In the case of a one-port network, (4.57) reduces to
	
0
0
0
b
a
= G
	
(4.58)
in which the reflection coefficient 
0
G  is the single element of the scattering 
matrix S0 of the one-port.
Example 4.3
Using definitions of traveling waves given by (4.48) and (4.49), find the 
S-parameters of a segment of a transmission line with the characteristic 
impedance Z0, propagation constant g, and the length l.
Solution
The S11 parameter is the traveling wave reflection coefficient seen at 
port 1 when port 2 is terminated by a matched load.
	
2
1
11
1
0
a
b
S
a
=
=
	
(4.59)
From the definition (4.48) of ingoing wave amplitude a, it is evident 
that condition a2 = 0 may be achieved when the load impedance is equal to the 
characteristic impedance of the line ZL = Z0 ( 2
2
2
0
2
0
0).
R
v
i Z
i Z
i Z
+
= -
+
=
 
Using (4.48) and (4.49) in (4.59), we have
	
1
0 1
0
11
1
0 1
0
in
in
v
Z i
Z
Z
S
v
Z i
Z
Z
-
-
=
=
+
+
	
(4.60)
where from (3.32) for ZL = Z0
	
0
0
0
0
0
0
tanh
tanh
in
Z
Z
l
Z
Z
Z
Z
Z
l
γ
γ
+
=
=
+
	
(4.61)
From (4.60) and (4.61), we have
	
11
0
S
= 	
(4.62)
The S21 parameter is the traveling wave transmission coefficient from 
port 1 to port 2 when port 2 is terminated by a matched load:

42 
Microwave Network Design Using the Scattering Matrix 
	
2
2
21
1
0
a
b
S
a
=
=
	
(4.63)
Using (4.48) and (4.49) in (4.63), because ZL=Z0 , 1
1
1
0
in
v
i Z
i Z
=
=
, and 
2
2
0
v
i Z
= -
, we have
	
2
2
0
2
2
21
1
1
0
1
0
1
2
in
in
v
i Z
v
Z
v
S
v
i Z
v Z
Z
v
-
=
=
=
+
+
	
(4.64)
From (3.6), we find
	
1
0
0
0
(
0)
(1
)
in
v
v z
V
V
V
+
-
+
=
=
=
+
=
+ G
	
(4.65)
	
(
)
γ
γ
γ
γ
+ -
-
+
-
=
=
=
+
=
+ G
2
0
0
0
(
)
l
l
l
l
in
v
v z
l
V e
V e
V
e
e
	
(4.66)
where
	
0
0
in
in
in
Z
Z
Z
Z
-
G
=
+
	
(4.67)
Because Zin = Z0 and 
0
in
G
= , 1
0
v
V +
=
, 2
0
l
v
V e γ
+ -
=
, we receive
	
2
0
21
1
0
l
l
v
V e
S
e
v
V
γ
γ
+ -
-
+
=
=
=
	
(4.68)
Because of the symmetry of the network, the following relations hold: 
S11 = S22 and S12 = S21. Finally, the true scattering matrix of a segment of a 
transmission line is
	
0
0
l
l
e
e
γ
γ
-
-
é
ù
= ê
ú
ê
ú
ë
û
S
	
(4.69)
4.4  Pseudowaves and the Pseudoscattering Matrix
B. Marks and F. Williams have defined and introduced yet another set of 
wave variables, the so-called pseudowaves [6]. The complex pseudowave am-
plitudes a and b are defined as

 
Wave Variables and the Scattering Matrix 
43
	
{
}
0
0
R
( )
(
)
2 Z
R
R
Re Z
v
a z
v
iZ
v
é
ù
º
+
ê
ú
ê
ú
ë
û
	
(4.70)
	
{
}
0
0
R
( )
(
)
2 Z
R
R
Re Z
v
b z
v
iZ
v
é
ù
º
-
ê
ú
ê
ú
ë
û
	
(4.71)
where ZR is an arbitrary reference impedance, with Re{ZR} ³ 0.
The inverse representations to (4.70) and (4.71) are
	
{
}
0
0
( )
(
)
R
R
Z
v
v z
a
b
v
Re Z
é
ù
=
+
ê
ú
ê
ú
ë
û
	
(4.72)
	
{
}
0
R
0
1
( )
(
)
R
R
Z
v
i z
a
b
Z
v
Re Z
é
ù
=
-
ê
ú
ê
ú
ë
û
	
(4.73)
In(4.70) through (4.73), only positive square roots are used.
The reflection coefficient of pseudowaves is defined as
	
( )
( )
( )
( )
R
R
b z
Z z
Z
a z
Z z
Z
-
G º
=
+
	
(4.74)
The net power flowing through the reference plane z is
	
(
)
{
}
{
}
=
-
+
2
2
*
( )
R
R
Im Z
P z
a
b
Im ab
Re Z
	
(4.75)
which can also be rewritten as
	
{
}
{
}
é
ù
=
- G
-
G
ê
ú
ë
û
2
2
( )
1
2
{ }
R
R
Im Z
P z
a
Im
Re Z
	
(4.76)
When we compare equations defining traveling waves and pseudowaves 
((4.48) and (4.49) with (4.70) and (4.71)), we see that pseudowaves a and b 
are equal to traveling waves a0 and b0 when the reference impedance ZR used 
to define a and b equals the characteristic impedance Z0 of the mode. Very of-
ten this is natural choice for ZR but the value of the characteristic impedance  

44 
Microwave Network Design Using the Scattering Matrix 
Z0 must be known. In practice, the characteristic impedance Z0 of a given 
mode is often unknown and also difficult to measure.
Again, when ZR is chosen to be real the power is simply 
	
2
2
*
( )
P z
vi
a
b
=
=
-
	
(4.77)
and the reflection coefficient G of passive loads has its magnitude less than 1.
The choice of real ZR simplifies wave and power relations significantly.
For a multiport, the pseudoscattering matrix S linearly relates the vector 
of outgoing pseudowaves b with the vector of ingoing pseudowaves a
	
=
b
Sa	
(4.78)
And for a one-port the scattering matrix S reduces to the reflection coef-
ficient G given by
	
b
a
= G 	
(4.79)
The pseudoscattering matrix S is equal to the true scattering matrix S0 
when the reference impedance ZR of each port is equal to the respective char-
acteristic impedance Z0 of a transmission line forming a port.
4.4.1  Pseudoscattering Matrix Properties
In special cases of networks their scattering matrices have to satisfy some 
conditions.
4.4.1.1  Passive Network
For a passive network the net power entering it is nonnegative
	
1
0
n
i
i
P
=
³
å
	
(4.80)
Using (4.75), we have
	
{
}
{
}
{
}
=
=
æ
ö
=
-
+
ç
÷
è
ø
å
å
2
2
1
1
*
2
Z
n
n
Ri
i
i
i
i i
Ri
i
i
Im Z
P
a
b
Im a b
Im
	
(4.81)
Because
	
2
2
(
)
i
i
a
b
+
+
+
+
+
+
+
-
=
-
=
-
=
-
å
a a
b b
a a
a S Sa
a
I
S S a	
(4.82)

 
Wave Variables and the Scattering Matrix 
45
and
	
{
}
{
}
{
}
{
}
+
+
=
= -
å
1
*
2
2
Z
n
Ri
i i
Ri
i
Im Z
Im a b
Re j
Im
a S Va
	
(4.83)
Equations (4.80) and (4.81) require that
	
+
+
+
-
-
³
{
[
2
] }
0
Re
j
a
I
S S
S V a
	
(4.84)
where V is a diagonal matrix 
{
}
{
}
diag
/
Ri
Ri
Im Z
Re Z
=
é
ù
ë
û
V
 and “+” indi-
cates the Hermitian adjoint.
If all reference impedances ZRi of a passive network are real, then from 
(4.84) it is seen that
	
{
}
[
]
0
Re
+
+
-
³
a
I
S S a
	
(4.85)
which means that the matrix I – S+S is positive semidefinite.
If the network is lossless, inequalities in (4.80) and (4.85) should be 
replaced by equalities. For the lossless network with all real reference imped-
ances we have
	
0
+
-
=
I
S S
	
(4.86)
which means that the scattering matrix S is unitary.
4.4.1.2  Reciprocal Network
Electromagnetic reciprocity is the other special case of a network that influ-
ences the property of the scattering matrix. It is applicable to networks with 
isotropic materials. The reciprocity relations in waveguide junctions have 
been studied extensively by D. F. Williams and R. B. Marks [6, 7]. As they 
have shown, the reciprocity condition has a form
	
{
}
{
}
{
}
{
}
1
1
Z
ji
Ri
Ri
i
ij
j
Rj
Rj
S
j Im Z
Re Z
K
S
K
j Im Z
Re
-
=
-
	
(4.87)
where the reciprocity factor K  for the ith port is defined as
	
0
0*
i
i
i
p
K
p
=
	
(4.88)

46 
Microwave Network Design Using the Scattering Matrix 
In (4.88)
	
0
i
t
t
i
S
p
dS
=
´
×
ò e
h
z
	
(4.89)
where Si is the cross-section of the waveguide creating the ith port of the 
network.
When the reference impedance equals the characteristic impedance,  
ZRi = Z0i, for all ports of a network, the reciprocity condition simplifies to
	
{
}
{
}
0
0
0
0
0
0
j
ji
i
ij
j
i
Re p
p
S
S
p
Re p
=
	
(4.90)
An analysis of (4.87) indicates that the electromagnetic reciprocity 
does not necessarily mean the symmetry of the scattering matrix S. We can 
consider different cases of the network. When ports are lossy waveguides, 
the reciprocity factors Ki are generally not equal to 1. As it was presented by 
D. F. Williams and R. B. Marks in [7], Ki for typical waveguides is close to 
1, but for the same waveguides with lossy dielectrics the value of this param-
eter may be much less than one. This means that in such cases the scattering 
matrix S is not symmetrical. Even when the reciprocity factor Ki = 1 but the 
reference impedance ZRi is complex, generally the pseudoscattering matrix 
is not symmetrical. For networks with more than two ports, in generally, it 
is not possible to choose values of reference impedances so as to make the 
pseudoscattering matrix symmetrical. For a two-port, the pseudoscattering 
matrix S can always be made symmetric. According to (4.87), the phase of 
the appropriate reference impedance ZRi of each port will depend on Ki at 
both ports [7].
In the case of lossless waveguides, Z0 is real and according to (4.88)  
Ki = 1. It means that for lossless waveguide ports, electromagnetic reciprocity 
is equivalent to the symmetry of the true scattering matrix S0.
Example 4.4
Using definitions of pseudowaves given by (4.70) and (4.71), find the 
pseudoscattering parameters of a segment of transmission line with the 
characteristic impedance Z0, propagation constant g, and the length l. 
Assume the same reference impedances of both ports.

 
Wave Variables and the Scattering Matrix 
47
Solution
The S11 parameter is the pseudowave reflection coefficient seen at port 
1 when port 2 is terminated by a matched load:
	
=
=
2
1
11
1
0
a
b
S
a
	
(4.91)
From the definition of ingoing pseudowave amplitude a (4.70), it is evi-
dent that condition a2 = 0 may be achieved when the load impedance is equal to 
the reference impedance of line ports ZL = ZR ( 2
2
2
2
0).
R
R
R
v
i Z
i Z
i Z
+
= -
+
=
 
Following this we have
	
1
1
11
1
1
R
in
R
R
in
R
v
Z i
Z
Z
S
v
Z i
Z
Z
-
-
=
=
+
+
	
(4.92)
where, from (3.32)
	
0
0
0
tanh
tanh
R
in
R
Z
Z
l
Z
Z Z
Z
l
γ
γ
+
=
+
	
(4.93)
Continuing calculations we receive
	
(
)
(
)
2
2
0
11
2
2
0
0
tanh
2
tanh
R
R
R
Z
Z
l
S
Z Z
Z
Z
l
γ
γ
-
=
+
+
	
(4.94)
The S21 parameter is the pseudowave transmission coefficient from port 
1 to port 2 when port 2 is terminated by a matched load:
	
=
=
2
2
21
1
0
a
b
S
a
	
(4.95)
Because ZL = ZR, 1
1
in
v
i Z
=
 and 2
2
R
v
i Z
= -
, we have
	
2
2
2
21
1
1
1
2
R
in
R
in
R
v
i Z
v
Z
S
v
i Z
v Z
Z
-
=
=
+
+
	
(4.96)
From (3.8), we calculate
	
1
0
0
0
(
0)
(1
)
in
v
v z
V
V
V
+
-
+
=
=
=
+
=
+ G
	
(4.97)

48 
Microwave Network Design Using the Scattering Matrix 
	
(
)
2
0
0
0
(
)
l
l
l
l
in
v
v z
l
V e
V e
V
e
e
γ
γ
γ
γ
+ -
-
+
-
=
=
=
+
=
+ G
	
(4.98)
where
	
0
0
in
in
in
Z
Z
Z
Z
-
G
=
+
	
(4.99)
Using (4.96) through (4.99), we receive
	
(
)
1
0
21
2
2
0
0
2
cosh
2
tanh l
R
R
R
Z Z
l
S
Z Z
Z
Z
γ
γ
-
=
+
+
	
(4.100)
Because the network is symmetric and ZR1 = ZR2 = ZR, the following 
relations hold: S11 = S22 and S12 = S21. Then we can write
	
(
)
(
)
(
)
γ
γ
γ
γ
-
=
+
+
é
ù
-
ê
ú
´
ê
ú
-
ë
û
1
2
2
0
0
2
2
0
0
2
2
0
0
cosh
2
tanh l
Z
Z
sinh l
2
2
Z
Z
sinh
R
R
R
R
R
R
l
Z Z
Z
Z
Z Z
Z Z
l
S
	
(4.101)
When the reference impedance ZR of both ports equals the characteris-
tic impedance Z0 of the line, then (4.101) simplifies to 
	
0
0
l
l
e
e
γ
γ
-
-
é
ù
= ê
ú
ê
ú
ë
û
S
	
(4.102)
This is the true scattering matrix of a segment of a transmission line.
4.4.2  Conversions Between the Pseudoscattering Matrix and Other Matrix 
Descriptions of Microwave Networks
4.4.2.1  The Cascade (Transfer Scattering Matrix)
The cascade matrices are very convenient representations of networks being  
cascaded connections of two-ports. The cascade matrix of two cascade- 
connected two-ports is the product of the two cascade matrices of connected 
two-ports. But this formula holds only when the connected ports are composed  

 
Wave Variables and the Scattering Matrix 
49
of two identical waveguides without any discontinuities at the joint. Of 
course reference impedances of two connected ports have to be equal to each  
other.
A two-port may be described using the cascade matrix T, which relates 
input port pseudowaves with output port pseudowaves
	
1
1
2
2
(1,2)
1
1
2
2
(
)
(
)
(
)
(
)
R
R
R
R
b Z
a
Z
a Z
b Z
é
ù
é
ù
=
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
T
	
(4.103)
Record T(1,2) indicates that the T matrix depends on reference imped-
ances at both ports.
Conversion formulas between scattering matrix and cascade matrix (or 
scattering transfer matrix) can be developed by manipulating the scattering 
parameter equations into appropriate form. They are [8]
	
12 21
11 22
11
22
21
1
1
S S
S S
S
S
S
-
é
ù
=
ê
ú
-
ë
û
T
	
(4.104)
and
	
12
11 22
12 21
21
22
1
1
T
T T
T T
T
T
-
é
ù
=
ê
ú
-
ë
û
S
	
(4.105)
Notice that the denominator of each term in (4.104) is S21, and the 
denominator of each term in (4.105) is T22.
It is possible to define T parameters assuming that the output port 
waves are dependent variables and the input port waves are the independent 
variables
	
2
1
2
1
A
b
a
a
b
é
ù
é
ù
=
ê
ú
ê
ú
ë
û
ë
û
T
	
(4.106)
The reverse cascade matrix TA derived from S-parameters  is
	
12 21
11 22
22
11
12
1
1
A
S S
S S
S
S
S
-
é
ù
=
ê
ú
-
ë
û
T
	
(4.107)
This alternate definition can result in some problems when S12 = 0.

50 
Microwave Network Design Using the Scattering Matrix 
Because the relation (4.103) holds also for true traveling waves, we may 
also write
	
01
02
(0)
01
02
b
a
a
b
é
ù
é
ù
=
ê
ú
ê
ú
ë
û
ë
û
T
	
(4.108)
and call T(0) a true cascade matrix. It can be shown easily that T = T(0) only 
when ZR1 = Z01 and ZR2 = Z01.
4.4.2.2  The Impedance Matrix
Another matrix description of microwave networks is the impedance matrix 
Z, which relates a vector of waveguide voltages v to the vector of waveguide 
currents i defined at reference planes of network ports
	
=
v
Z i	
(4.109)
The admittance matrix Y is the inverse of the impedance matrix Z. The 
matrix Y satisfies the equation
	
1
-
=
=
i
Z
v
Y v	
(4.110)
Because v and i do not depend on port reference impedances, the im-
pedance matrix Z does not depend on these parameters, either. However the 
Z matrix depends on the normalization of v0 (see (2.4)).
The pseudoscattering matrix S and the impedance matrix Z interrela-
tion are [6]
 
(
)(
)
(
)(
)
1
-
-
-
-
-
-
=
-
+
=
-
+
1
1
1
1
1
R
R
R
R
S
U Z
Z
Z
Z
U
U ZZ
I ZZ
I
U
	 (4.111)
and the reverse relation
	
(
) (
)
1
-
-
-
=
-
+
1
1
R
Z
I
U
SU
I
U
SU Z 	
(4.112)
where I is the unit matrix and ZR and U are diagonal matrices defined as
	
[
]
=
1
2
diag
,
,.....,
R
R
R
RN
Z
Z
Z
Z
	
(4.113)
	
{
}
{
}
{
}
1
01
01
1
2
02
0
02
2
0
diag
,
,....,
R
R
R
RN
N
R
N
RN
Re Z
v
v
Z
Re Z
Re Z
v
v
v
Z
v
Z
é
=
ê
êë
ù
ú
úû
U
	
(4.114)

 
Wave Variables and the Scattering Matrix 
51
It can be proved that Z like S are generally asymmetrical matrices, even 
when the network is reciprocal and v0 are chosen real at each port. The off-
diagonal elements of the impedance matrix Z satisfy the relation [6,7]
	
0
0
*
*
ji
oj
i
i
ij
j
i
oj
Z
v
K
v
Z
K
v
v
=
	
(4.115)
where Ki and Kj are the reciprocity factors given by (4.88).
4.4.3  Change of Reference Impedances
The choice of reference impedance for the scattering matrix depends on the 
circumstances and applications. The most natural choice is to set the refer-
ence impedance equal to the characteristic impedance of the mode propagat-
ing in the waveguide (ZR = Z0). Another choice is to assume the real value of 
the reference impedance.
To find relationship between the pseudowaves based on different refer-
ence impedances, we use (4.70) and (4.71) to express (
)
( )
n
R
a Z
 and (
)
( )
n
R
b Z
 
in terms of v and i and then we use (4.72) and (4.73) to express v and i in 
terms of (
)
( )
m
R
a Z
 and (
)
( )
m
R
b Z
. Here, 
( )
m
R
Z
 and 
( )
n
R
Z
 represent two different 
values of reference impedances. After eliminating v and i from these relations 
we receive [6]
	
(
)
(
)
(
)
(
)
( )
( )
(
)
( )
( )
n
m
R
R
nm
n
m
R
R
a Z
a Z
b Z
b Z
é
ù
é
ù
ê
ú
ê
ú
=
ê
ú
ê
ú
ë
û
ë
û
Q
	
(4.116)
where
	
{
}
=
é
ù
+
-
´ ê
ú
-
+
ê
ú
ë
û
(n)
( )
R
(
)
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
( )
Z
1
2
m
nm
R
m
n
m
R
R
R
m
n
m
n
R
R
R
R
m
n
m
n
R
R
R
R
Re
Z
Z
Z
Re Z
Z
Z
Z
Z
Z
Z
Z
Z
Q
}
{
	
(4.117)
These equations are the exact expression of the complex impedance 
transform. Such transformation also means that we can consider pseudowaves 
as impedance transformed traveling waves.

52 
Microwave Network Design Using the Scattering Matrix 
If we introduce a new parameter
	
( )
(
)
( )
n
nm
R
m
R
Z
N
Z
=
	
(4.118)
it is possible to express the matrix Q(nm) in the form
	
{ }
{
}
(
)
(
)
(
)
(
)
=
é
ù
+
-
ê
ú
´ ê
ú
-
+
ë
û
( )
R
(
)
2
( )
(
)
2
2
(
)
(
)
2
2
(
)
(
)
Z
1
2
1
1
1
1
n
nm
m
nm
R
nm
nm
nm
nm
Re
Re Z
N
N
N
N
N
Q
	
(4.119)
Examining (4.119), we can recognize the following properties of ref-
erence impedance transformation. Two consecutive transformations can be 
considered as a single transform because
	
(
)
(
)
(
)
mp
np
nm
=
Q
Q
Q
	
(4.120)
From (4.119) it is evident that
	
(
)
nn =
Q
I	
(4.121)
where I is the identity matrix.
From (4.120) and (4.121) it is also evident that
	
(
)
(
)
nm
mn =
Q
Q
I	
(4.122)
or
	
1
(
)
(
)
nm
mn
-
é
ù
=
ë
û
Q
Q
	
(4.123)
which means that the transformation is inverted by a return to the original 
reference impedance.
After manipulation of (4.119), we may find another form of Q(nm)

 
Wave Variables and the Scattering Matrix 
53
	
{
}
{
}
{
}
{
}
(
)
-
=
-
é
ù
G
´
ê
ú
G
ê
ú
ë
û
- G
( )
( )
(
)
( )
( )
(
)
(
)
2
(
)
1
/
1
/
1
1
1
1
m
m
R
R
nm
n
n
R
R
mn
mn
mn
jIm Z
Re Z
jIm Z
Re Z
Q
	
(4.124)
in which
	
( )
( )
(
)
( )
m
n
mn
R
R
m
nR
R
Z
Z
Z
Z
-
G
=
+
	
(4.125)
Examining (4.105), which describes the relationship between the scat-
tering matrix S and the cascade matrix T, we see that the S matrix is sym-
metrical ( 12
21
S
S
=
) when 
11 22
12 21
1
T T
T T
-
= , or in other words when the 
determinant of the T matrix is equal 1. From the definitions of the Q matrix 
(4.116) and the T matrix (4.103), it is evident that the scattering matrix as-
sociated with the Q(mn) matrix is symmetrical if and only if det[Q(nm)] = 1.
Because the determinant of the Q(nm) matrix is [6]
	
{
}
{
}
{
}
{
}
( )
( )
(
)
( )
( )
det[
]
1
1
Z
m
n
R
R
nm
m
n
R
R
Im Z
Im Z
j
j
Re Z
Re
æ
ö æ
ö
ç
÷ ç
÷
=
-
-
ç
÷ ç
÷
è
ø è
ø
Q
	
(4.126)
it is evident that the scattering matrix that represents the transform between 
the complex and the real reference impedance is in general asymmetric. This 
means that a symmetric scattering matrix will not remain symmetric when 
the reference impedance of a single port changes from a real to a nonreal 
value [6].
4.4.4  One-Port Reference Impedance Transformation
Using (4.116), we can get the relationship
	
(
)
(
)
(
)
( )
21
22
( )
( )
11
12
m
R
n
R
m
R
Q
Q
Z
Z
Q
Q
Z
+
G
G
=
+
G
	
(4.127)

54 
Microwave Network Design Using the Scattering Matrix 
where
	
(
)
(
)
(
)
(
)
(
)
(
)
( )
( )
( )
( )
( )
( )
   and   
n
m
R
R
n
m
R
R
n
m
R
R
b Z
b Z
Z
Z
a Z
a Z
G
=
G
=
	
(4.128)
In (4.127) Q 11, Q 12, Q 21, and Q 22 are elements of the 2 ´ 2 Q(nm) matrix.
After simple manipulation we arrive at a formula presenting the effect 
of the complex reference impedance transform on the reflection coefficient
	
(
)
(
)
(
)
(
)
( )
( )
(
)
( )
1
nm
m
R
n
R
nm
m
R
Z
Z
Z
G
+ G
G
=
+ G
G
	
(4.129)
where G(nm) has been defined by (4.125).
Let us investigate properties of this transform for some important  
networks.
The first one is a short circuit which is defined as a perfectly conduct-
ing electric wall that terminates the entire cross section of the waveguide. 
At a perfect electric wall which coincides with the reference plane of the 
considered one-port, the tangential electric field has to vanish. This means 
that at the reference plane of the short circuit v = 0, and according to defi-
nitions of a and b given by (4.70) and (4.71), always b = - a, and always 
/
1
b a
G =
= -  independently on the reference impedance ZR. The same re-
sult comes from (4.129). The reflection coefficient of the perfect short is 
always equal to -1, independently on the reference impedance ZR.
The reflection coefficient of the perfect open circuit also does not de-
pend on the reference impedance ZR. In this case at a perfect magnetic wall 
the transverse magnetic field (tangential to the magnetic wall) has to vanish. 
It means that at the reference plane of the open circuit i = 0 and according 
to definitions of a and b, always b = a, and always 
/
1
b a
G =
=  independently 
on the reference impedance ZR.
Let us now consider a perfect match. Let us assume that the reflection  
coefficient with respect to reference impedance 
( )
m
R
Z
  is equal to 0, (
)
G
=
( )
0
m
R
Z
. 
According to (4.129), a change of the reference impedance to 
( )
n
R
Z
 changes 
the reflection coefficient of a perfect match to a nonzero value
	
(
)
( )
(
)
n
nm
R
Z
G
= G
	
(4.130)
From the other side, if after a change of the reference impedance  
we would like to have zero value of the reflection coefficient, (
)
( )
0
n
R
Z
G
= , 
then according to (4.129) the original reflection coefficient should be

 
Wave Variables and the Scattering Matrix 
55
	
(
)
( )
(
)
m
nm
R
Z
G
= -G
	
(4.131)
4.4.5  Multiport Network Reference Impedance Transformation
There is not a single equation known for the direct computation of the scat-
tering matrix S due to a change of the reference impedance.
Computation of the transformed S matrix is done in two steps. The 
first step is to convert given matrix S to the impedance matrix Z. This is 
performed using (4.112). Subsequently, (4.111) is used to compute the 
transformed matrix S for a new reference impedance. This procedure is valid  
because the impedance matrix Z does not depend on the reference impedance.
4.4.6  Two-Port Reference Impedance Transformation
In the case of a two-port network, the most convenient way to compute the 
transform of the scattering matrix S due to the change of reference impedances 
is to compute the associated cascade matrix T first, then perform a reference 
impedance transformation on T, and finally convert the T matrix back to the 
scattering matrix S. To find transformation relations for the T matrix, we insert 
(4.116)
	
(
)
(
)
(
)
(
)
( )
( )
2
2
(
)
( )
( )
2
2
q
n
R
R
nq
n
q
R
R
a
Z
a
Z
b
Z
b
Z
é
ù
é
ù
ê
ú
ê
ú =
ê
ú
ê
ú
ë
û
ë
û
Q
	
(4.132)
into the right-hand side of (4.103)
	
(
)
(
)
(
)
(
)
( )
( )
1
2
(
)
( )
( )
1
2
m
n
R
R
mn
m
n
R
R
b Z
a
Z
a
Z
b
Z
é
ù
é
ù
ê
ú
ê
ú
=
ê
ú
ê
ú
ë
û
ë
û
T
	
(4.133)
to receive 
	
(
)
(
)
(
)
(
)
( )
( )
1
2
(
)
(
)
( )
( )
1
2
q
m
R
R
nq
mn
m
q
R
R
b Z
a
Z
a
Z
b
Z
é
ù
é
ù
ê
ú
ê
ú =
ê
ú
ê
ú
ë
û
ë
û
T
Q
	
(4.134)
Because the matrix Q is symmetrical with respect to both diagonals 
(Q 11 = Q 22 and Q 12 = Q 21), (4.103) relating the vector of wave variables 

56 
Microwave Network Design Using the Scattering Matrix 
(
)
( )
1
m
R
b Z
 and (
)
( )
1
m
R
a
Z
 to the vector of wave variables (
)
( )
1
p
R
b Z
 and (
)
( )
1
p
R
a
Z
 
may be written also in the form
	
(
)
(
)
(
)
(
)
( )
( )
1
1
(
)
( )
( )
1
1
p
m
R
R
pm
p
m
R
R
b Z
b Z
b Z
a
Z
é
ù
é
ù
ê
ú
ê
ú
=
ê
ú
ê
ú
ë
û
ë
û
Q
	
(4.135)
After simple matrix manipulations with (4.135) we receive the required  
equation
   
(
)
(
)
(
)
(
)
(
)
(
)
( )
( )
( )
1
2
2
(
)
(
)
(
)
(
)
( )
( )
( )
1
2
2
q
q
p
R
R
R
nq
pq
pm
mn
p
q
q
R
R
R
b Z
a
Z
a
Z
a
Z
b
Z
b
Z
é
ù
é
ù
é
ù
ê
ú
ê
ú
ê
ú =
=
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
Q
T
Q
T
	 (4.136)
from which we have searched the relationship
	
=
(
)
(
)
(
)
(
)
pq
nq
pm
mn
T
Q
T
Q
	
(4.137)
This equation presents transformation of the two-port cascade matrix 
T(mn) caused by altering the reference impedance of port 1 from 
( )
m
R
Z
 to 
( )
p
R
Z
and that of port 2 from 
( )
n
R
Z
 to 
( )
q
R
Z
.
In many practical cases both ports of a two-ports are normalized to the 
identical reference impedances. When the reference impedance of both ports 
is changed from 
( )
R
m
Z
 to 
( )
R
p
Z
 the equation defining the transformed cascade 
matrix has a form
 
(
)
(
)
(
)
(
)
(
)
(
)
(
)
2
(
)
(
)
(
)
1
1
1
1
1
1
pp
pm
(mp)
mm
pm
pm
mm
pm
pm
pm
=
é
ù
é
ù
G
-G
=
ê
ú
ê
ú
G
-G
ê
ú
ê
ú
- G
ë
û
ë
û
T
Q
T
Q
T
	
(4.138)
4.4.7  Three-Port to Two-Port Network Scattering Matrix Transformation
Measurement of the three-port scattering parameters of three-terminal devices 
such as CMOSFETs, MESFETs, or BJTs is interesting from a practical point 

 
Wave Variables and the Scattering Matrix 
57
for two reasons: first, because of the difficulty in obtaining a short-circuit 
terminal required for common source or common gate configuration over 
a wide frequency range, and second, because of the difficulty in obtaining 
transistor stability in the case of the two-port system over the frequency range 
from dc to fmax  of the microwave transistor. Three-port scattering parameters 
of transistors are obtained by measuring the reflected and transmitted waves, 
with all ports terminated with matched loads.
As shown in Figure 4.4, three-port scattering parameters are defined by 
usual matrix equation
	
1
11
12
13
1
2
21
22
23
2
3
31
32
33
3
b
S
S
S
a
b
S
S
S
a
b
S
S
S
a
é
ù
é
ùé
ù
ê
ú
ê
úê
ú
=
ê
ú
ê
úê
ú
ê
ú
ê
úê
ú
ë
û
ë
ûë
û	
(4.139)
The assumption that terminal three is short-circuited to the ground 
means that port 3 is constrained by the reflection coefficient G3 = -1,
(b)
(a)
1
2
3
1
2
Figure 4.4  (a) Three-terminal transistor treated as a three-port, and (b) the same transis-
tor with one terminal short circuited to the ground.

58 
Microwave Network Design Using the Scattering Matrix 
	
3
3
a
b
= - 	
(4.140)
Substituting (4.140) into (4.139) and then eliminating b3 yields
	
13 21
13 32
11
12
1
1
33
33
2
23 31
23 32
2
21
11
33
33
1
1
1
1
S S
S S
S
S
b
a
S
S
b
S S
S S
a
S
S
S
S
é
ù
-
-
ê
ú
+
+
é
ù
é
ù
ê
ú
=
ê
ú
ê
ú
ê
ú
ë
û
ë
û
-
-
ê
ú
+
+
ë
û
	
(4.141)
From (4.141) it is easy to recognize that two-port parameters of a two-
port presented in Figure 4.4(b) are
	
13 21
/11
11
33
1
S S
S
S
S
=
- +
	
(4.142)
	
13 32
/12
12
33
1
S S
S
S
S
=
- +
	
(4.143)
	
23 31
/21
21
33
1
S S
S
S
S
=
- +
	
(4.144)
	
23 32
/22
22
33
1
S S
S
S
S
=
- +
	
(4.145)
It is important to mention here that nine elements of the scattering ma-
trix S in (4.139) are not independent if they correspond to a three-terminal 
device considered as a three-port. In fact, there are only four independent 
elements of the scattering matrix S in (4.139). If they are known, the other 
can be found because they are all related by the condition
	
3
3
1
1
1
ij
ij
i
j
S
S
=
=
=
=
å
å
	
(4.146)
This theory indicates how a set of two-port scattering parameters of a 
transistor in any common configuration (common source, common gate, or 
common drain) can be converted to any other set of the two-port scattering 
parameters for another common configuration.

 
Wave Variables and the Scattering Matrix 
59
Proof of (4.146) can be found in [9]. It is based on the definition of 
S-parameters and on Kirchhoff ’s low for voltages and currents at the termi-
nals for the n-port junction with no ground connection at the junction. The 
wavelength effect is not taken into account in the derivations. A transistor is 
a point with zero dimensions.
The three-port scattering parameters of three-terminal devices offer 
several advantages over the two-port scattering parameters of such elements. 
Three-port scattering parameters allow for obtaining two-port scattering pa-
rameters for common source, common gate, and common drain configu-
ration, and also for all common lead impedance configuration. Figure 4.5 
presents a transistor in common lead impedance configuration.
For such a configuration, we have [8, 9]
	
/
1
ik kj
ij
ij
kk
k
S S
S
S
S
=
+
-
G
	
(4.147)
where
	
R
k
R
Z
Z
Z
Z
-
G =
+
	
(4.148)
In (4.148) Z is the common lead impedance and ZR is the reference 
impedance of the kth port.
It can be proven on the basis of the definition of the scattering matrix 
and pseudowaves, and Kirchhoff ’s law for currents at the terminals for the 
n-port junction with no ground connection at the junction that [9]
Three-port with
no ground
i
j
k
Z
Figure 4.5  Common lead impedance configuration.

60 
Microwave Network Design Using the Scattering Matrix 
	
1
1
n
ij
i
S
=
=
å
	
(4.149)
	
1
1
n
ij
j
S
=
=
å
	
(4.150)
These equations mean that for the scattering matrix of discussed n-port 
junctions the sum of elements of each column and of each row must be equal 
to unity.
4.4.8  Scattering Matrix of the Cascade of Two-Port Networks
The cascade (transfer scattering) matrix T of two two-port networks con-
nected in cascade is equal to the product of the individual transfer scattering 
matrices of the constitutive two-ports
	
(net)
(1)
(2)
=
T
T
T
	
(4.151)
This approach is used very often for solving the cascade of two-port net-
works.
Because microwave elements are characterized by their S-parameters, 
application of (4.151) requires first, the transformation of both S-matrices to 
T-matrices, second, the multiplication of T-matrices, and third, the transfor-
mation of the overall T-matrix to the overall S-matrix.
There is a simpler derivation of the overall scattering matrix of two 
cascaded two-port networks based solely on the definition of the scattering 
matrix and the connectivity relationship at the joint ports. It does not require 
S-matrix to T-matrix and vice versa transformations [13].
Using the indexing scheme presented in Figure 4.6, the scattering ma-
trix equations for both two-ports are
	
(1)
(1)
1
1
11
12
(1)
(1)
3
3
21
22
b
S
S
a
b
a
S
S
é
ù
é
ù
é
ù
= ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
	
(4.152)
	
(2)
(2)
4
4
11
12
(2)
(2)
2
2
21
22
b
S
S
a
b
a
S
S
é
ù
é
ù
é
ù
= ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
	
(4.153)

 
Wave Variables and the Scattering Matrix 
61
These two matrix equations are equivalent to 
	
(1)
(1)
11
12
1
1
(2)
(2)
2
2
22
21
(1)
(1)
3
3
21
22
(2)
(2)
4
4
12
11
0
0
0
0
0
0
0
0
S
S
b
a
b
S
S
a
b
a
S
S
b
a
S
S
é
ù
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
	
(4.154)
which can be split back into two matrix equations
	
(1)
(1)
1
1
3
11
12
(2)
(2)
2
2
4
22
21
0
0
0
0
b
S
a
S
a
b
a
a
S
S
é
ù
é
ù
é
ù
é
ù
é
ù
=
+
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û
ë
û
	
(4.155)
	
(1)
(1)
3
1
3
21
22
(2)
(2)
4
2
4
12
11
0
0
0
0
b
S
a
S
a
b
a
a
S
S
é
ù
é
ù
é
ù
é
ù
é
ù
=
+
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û
ë
û
	
(4.156)
We assume now that the reference impedances of connected ports, port 
3 and port 4, of both networks are the same and that the connection is reflec-
tionless. Following this assumption we can write
	
3
4
3
4
and     
a
b
b
a
=
=
	
(4.157)
or in matrix form
	
3
3
3
4
4
4
0
1
1
0
b
a
a
b
a
a
é
ù
é
ù
é
ù é
ù
= G
=
ê
ú
ê
ú
ê
ú ê
ú
ë
û
ë
û
ë
û ë
û	
(4.158)
Eliminating first vector [
]
3
4
T
b
b
 from (4.156) and (4.158), we get
	
1
(1)
(1)
3
1
22
21
(2)
(2)
4
2
11
12
0
0
0
0
a
S
S
a
a
a
S
S
-
é
ù
é
ù
-
é
ù
é
ù
= ê
ú
ê
ú
ê
ú
ê
ú
-
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û
	
(4.159)
a1
b1
a2
a3
a4
b2
b3
b4
S
(1)
S
(2)
Figure 4.6  Cascade connection of two two-ports described by their scattering matrices.

62 
Microwave Network Design Using the Scattering Matrix 
Next, eliminating vector [a3  a4]T from (4.155) and (4.159), we have
	
-
éé
ù
é
ù é
ù
-
é
ù
ê
=
+
ê
ú
ê
ú ê
ú
ê
ú
ê
-
ê
ú
ê
ú ê
ú
ë
û
ë
û
ë
û ë
û
ë
ù
é
ù é
ù
ú
´ ê
ú ê
ú
ú
ê
ú ë
û
ë
ûû
1
(1)
(1)
(1)
1
11
12
22
(2)
(2)
(2)
2
22
21
11
(1)
1
21
(2)
2
12
0
0
0
0
0
0
0
0
b
S
S
S
b
S
S
S
S
a
a
S
	 (4.160)
The coefficient matrix in (4.60) is the overall scattering matrix of the 
cascaded network. Calculation from (4.160) of the overall scattering matrix 
elements leads to the following results
	
(
)
1
(net)
(1) (2)
(1) (2)
(1)
(1)
11
12 11
22 11
21
11
1
S
S
S
S
S
S
S
-
=
-
+
	
(4.161)
	
(
)
1
(net)
(1)
(1) (2)
(2)
12
12
22 11
12
1
S
S
S
S
S
-
=
-
	
(4.162)
	
(
)
1
(net)
(1)
(1) (2)
(2)
21
21
22 11
21
1
S
S
S
S
S
-
=
-
	
(4.163)
	
(
)
1
(net)
(2)
(1) (2)
(2) (1)
(2)
22
12
22 11
21
22
22
1
S
S
S
S
S
S
S
-
=
-
+
	
(4.164)
4.4.9  Scattering Matrix of an Embedded Multiport Network
In active device measurement and modeling problems it is very common 
to investigate the equivalent circuit of the intrinsic chip and the equivalent 
circuit of the embedding of the external chip. The equivalent circuit of the in-
trinsic device chip contains mostly controlled voltage and/or current sources 
responsible for transistor action of amplification. The embedding, usually a 
passive circuit, is composed of parasitic stray capacitances, lead resistances, 
and inductances. At microwave frequencies this embedding passive circuit 
strongly influences signal behavior of the entire device. The effect of the ad-
ditional elements on the scattering matrix of the entire device may be calcu-
lated using the procedure presented below. Figure 4.7 illustrates a network 
composed of two subnetworks connected by internal ports.

 
Wave Variables and the Scattering Matrix 
63
The scattering matrix of the entire resultant network is derived by parti-
tioning the scattering matrix T of the embedding network into submatrices
	
c
cc
ci
c
i
ic
ii
i
é
ù
é
ùé
ù
=
ê
ú
ê
úê
ú
ë
û
ë
ûë
û
b
T
T
a
b
T
T
a
	
(4.165)
where ac, bc, and ai, bi are vectors of incoming and outgoing pseudowaves, 
respectively, in the external and internal ports of the network.
The embedded subnetwork describes the matrix equation
	
s
s
=
b
Sa 	
(4.166)
The connections between pairs of internal ports of T subnetwork and 
ports of S subnetwork impose restrictions on vectors of internal incoming 
and outgoing waves of the form
	
i
s
=
a
b 	
(4.167)
	
i
s
=
b
a 	
(4.168)
By writing these restrictions, we assume that the reference impedances 
of pairs of connected ports are equal to each other and that connections are 
reflectionless.
S
T
Figure 4.7  A multiport intrinsic network with scattering matrix S embedded with the net-
work with the scattering matrix T. The resultant scattering matrix of the entire 
network referred to the external ports is S(net).

64 
Microwave Network Design Using the Scattering Matrix 
Using (4.165) through (4.168), by first eliminating bi , we get
	
1
1
i
ii
ic
c
-
-
é
ù
=
-
ë
û
a
S
T
T a 	
(4.169)
and after substituting (4.169) into the first equation of (4.165)
	
(
)
1
1
c
cc
ci
ii
ic
c
-
-
é
ù
=
+
-
ë
û
b
T
T
S
T
T
a
	
(4.170)
The coefficient matrix in this equation
	
(
)
1
1
net
cc
ci
ii
ic
-
-
=
+
-
S
T
T
S
T
T 	
(4.171)
is the scattering matrix of the entire network referred to the external ports.
We can also write (4.171) in the form
	
(net)
cc
ic
=
+ L
S
T
ST 	
(4.172)
where
	
[
]
1
ci
ii
-
L =
-
T
I
ST
	
(4.173)
In (4.173) I is the unit matrix.
4.5  Generalized Multiport Network Cascade Matrix
Originally the cascade matrix was used for two-port networks in cascade. 
Present-day applications of two-port network cascade matrix are related 
mostly to deembedding procedures of VNA measurement data. In vector 
analyzer measurements a device under test (DUT) is embedded into the 
test setup. In order to extract the scattering parameters of the DUT from 
the embedded system we apply a procedure called deembedding. The two-
port cascade matrix is used in some of these procedures [12]. Present-day 
interconnects are multiline networks. They may be considered as intercon-
nections of some basic four-port and three-port network. Deembedding 
of multiline systems requires application of multiport network cascade 
matrices.

 
Wave Variables and the Scattering Matrix 
65
A general multiport T-matrix may be defined by the matrix equation 
[13]
	
1
1
2
2
11
12
1
21
22
2
1
1
2
1
2
...
...
:
:
...
...
:
:
.
...
:
:
:
:
.
:
...
...
:
:
m
m
N
N
m
m n
m
m
M
M
MN
m
m n
b
a
b
a
T
T
T
T
T
T
b
a
a
b
a
b
T
T
T
a
b
+
+
+
+
+
+
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û	
(4.174)
The general T-matrix is defined in such a way that the cascade ma-
trix of the overall network being a cascade connection of multiports equals 
the product of cascade matrices of individual multiport networks. The ele-
ments of the left-hand side vector are wave variables corresponding to m 
input ports and the size of this vector equals M = 2m while the elements of 
the right-hand side vector are wave variables at n output ports of a multi­
port network and the size of this vector equals N = 2n. The size of the 
T-matrix is M ´ N. In the case when a number of input ports m equals 
a number of output ports n, the T-matrix is square of size N ´ N. But in 
general case the numbers of input ports and output ports are not equal. 
This results in a nonsquare T-matrix with a size of M ´ N. The number 
of elements of nonsquare T-matrix elements of a multiport network is al-
ways smaller than the number of elements of the S-matrix of this multiport  
network.
It should be mentioned here that the exact ordering of the incident and 
reflected waves in the left-hand side vector of (4.174) (and in consequence in 
the right-hand side vector) has not been standardized and we should not ex-
pect any real and good solution for this problem. Ordering of the wave vari-
ables in the vector of input ports should be always taken into account when 
somebody wants to use the cascade matrix formalism to solve a particular  
problem.
Figure 4.8 illustrates an example of the same three-port networks but 
with different port ordering as the input and the output ports.
The scattering matrix of both networks is a 3 ´ 3 square matrix regard-
less of port ordering

66 
Microwave Network Design Using the Scattering Matrix 
	
1
11
12
13
1
2
21
22
23
2
3
31
32
33
3
b
S
S
S
a
b
S
S
S
a
b
S
S
S
a
é
ù
é
ùé
ù
ê
ú
ê
úê
ú
=
ê
ú
ê
úê
ú
ê
ú
ê
úê
ú
ë
û
ë
ûë
û	
(4.175)
The T-matrices of considered networks are nonsquare and their size 
depends on the ordering of ports. In the case of the network illustrated in 
Figure 4.8(a), we have
	
1
11
12
2
21
22
3
1
31
32
3
2
41
42
b
T
T
b
T
T
a
a
T
T
b
a
T
T
é
ù
é
ù
ê
ú
ê
ú é
ù
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú ë
û
ê
ú
ê
ú
ë
û
ë
û
	
(4.176)
This T-matrix is 4 ´ 2. The number of rows equals the number of input 
ports multiplied by 2 and the number of columns equals the number of out-
put ports multiplied by 2. For the network presented in Figure 4.8(b)
Figure 4.8  A three-port network with different port ordering and in consequence different 
cascade matrices. (a) The network with ports 1 and 2 considered as input ports 
and with port 3 considered as an output port. (b) The same network with port 1 
considered as an input port and ports 2 and 3 considered as two output ports.

 
Wave Variables and the Scattering Matrix 
67
	
2
1
11
12
13
14
3
1
21
22
23
24
2
3
a
b
T
T
T
T
a
a
T
T
T
T
b
b
é
ù
ê
ú
é
ù
é
ù ê
ú
=
ê
ú
ê
ú ê
ú
ë
û
ë
û ê
ú
ë
û	
(4.177)
This time the T-matrix is 2 ´ 4.
Figure 4.9 presents a four-port network with the number of ports con-
sidered as input ports equal to the number of ports considered as output 
ports. Networks with equal number of input and output ports are called bal-
anced networks [13].
The T-matrix of this network is a square 4 ´ 4 matrix in the form
	
[ ]
11
12
13
14
1
3
21
22
23
24
2
4
31
32
33
34
1
3
41
42
44
43
2
4
T
T
T
T
b
a
T
T
T
T
b
a
T
T
T
T
a
b
T
T
T
T
a
b
é
ù
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
	
(4.178)
The multiport T-matrix defined by (4.174) can be partitioned into sub-
matrices TI,I, TI,II, TII,I, and TII,II 
	
,
,
,
,
I I
I II
II I
II II
é
ù
= ê
ú
ë
û
T
T
T
T
T
	
(4.179)
which may be considered and interpreted as higher degree equivalents of stan-
dard two-port cascade matrix elements T11, T12, T21, and T22. This concept 
of the multiport T-matrix partitioning is a basis in further considerations on 
cascaded connections of the multiport networks and their resultant general 
cascade matrices.
a1
b1
a2
a3
b2
b3
T, S
2
3
1
4
a4
b4
Figure 4.9  A four-port network with two input ports and two output ports.

68 
Microwave Network Design Using the Scattering Matrix 
4.5.1  T-Matrix to S-Matrix and S-Matrix to T-Matrix Transformation for Multiport  
Networks with the Same Number of Input and Output Ports (Balanced  
Networks)
The simplest multiport network with the same number of input and output 
ports is a two-port network. The relation determining the T-matrix to S- 
matrix transformation is
	
1
1
11
12
12 22
11
12 22
21
1
1
21
22
22
22
21
S
S
T T
T
T T
T
S
S
T
T
T
-
-
-
-
é
ù
-
é
ù = ê
ú
ê
ú
-
ê
ú
ë
û
ë
û	
(4.180)
and vice versa the S-matrix to T-matrix transformation has a form
	
1
1
11
12
12
11 21
22
11 21
1
1
21
22
21
22
21
T
T
S
S S
S
S S
T
T
S
S
S
-
-
-
-
é
ù
-
é
ù = ê
ú
ê
ú
-
ê
ú
ë
û
ë
û	
(4.181)
In the case of four-port network with two input and two output ports, 
the T-matrix defined in (4.174) may be partitioned into four square 2 ´ 2 
submatrices TI, TI,II, TII,I, and TII,II
	
11
12
13
14
21
22
23
24
,
,
,
,
31
32
33
34
41
42
43
44
|
|
|
|
|
I I
I II
II I
II II
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
é
ù
ê
ú
ê
ú
é
ù
ê
ú
-
-
-
-
=
= ê
ú
ê
ú
ë
û
ê
ú
ê
ú
ë
û
T
T
T
T
T
	
(4.182)
The S-matrix of considered four-port network may be partitioned in 
similar way
	
11
12
13
14
21
22
23
24
,
,
,
,
31
32
33
34
41
42
43
44
|
|
|
|
|
I I
I II
II I
II II
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
é
ù
ê
ú
ê
ú
é
ù
ê
ú
-
-
-
-
=
= ê
ú
ê
ú
ë
û
ê
ú
ê
ú
ë
û
S
S
S
S
S
	
(4.183)

 
Wave Variables and the Scattering Matrix 
69
For a six-port network with three input and three output ports, the T-
matrix defined in (4.174) partitioned in similar way is [13]
	
11
12
13
14
15
16
21
22
23
24
25
26
31
32
33
34
35
36
,
,
,
,
41
42
43
44
45
46
51
52
53
54
55
56
61
62
63
64
65
66
|
|
|
|
|
|
|
I I
I II
II I
II II
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
é
ù
ê
ú
ê
ú
ê
ú
é
ù
ê
ú
-
-
-
-
-
-
=
= ê
ú
ê
ú
ë
û
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
T
T
T
T
T
	
(4.184)
Each submatrix of the partitioned multiport T-matrix has the same 
mathematical meaning as the elements of the two-port T-matrix. By replac-
ing in relations (4.180) and (4.181) elements of the two-port T-matrix with 
their equivalent submatrices, we receive [13]
	
1
1
,
,
,
,
,
,
,
1
1
,
,
,
,
,
II
I II
I II
II II
I I
I II
II II
II I
II I
II II
II II
II II
II I
-
-
-
-
é
ù
-
é
ù = ê
ú
ê
ú
-
ê
ú
ë
û
ë
û
S
S
T
T
T
T
T
T
S
S
T
T
T
	
(4.185)
and
	
1
1
,
,
,
,
,
,
,
,
1
1
,
,
,
,
,
I I
I II
I II
I I
II I
II II
I I
II I
II I
II II
II I
II II
II I
-
-
-
-
é
ù
-
é
ù = ê
ú
ê
ú
-
ê
ú
ë
û
ë
û
T
T
S
S
S
S
S
S
T
T
S
S
S
	
(4.186)
These equations represent interrelations between the scattering matrices 
and the cascade matrices for large multiport networks with the same number 
of input and output ports.
4.5.2  T-Matrix to S-Matrix and S-Matrix to T-Matrix Transformation for  
Multiport  Networks with Different Numbers of Input and Output Ports 
(Unbalanced Networks)
Figure 4.8 shows the simplest examples of multiport networks with different 
numbers of input and output ports. As a consequence of this the T-matrix 
becomes nonsquare with the number of elements smaller than the number of 

70 
Microwave Network Design Using the Scattering Matrix 
elements of the scattering matrix of this multiport. Despite this, T-matrices 
of unbalanced multiport networks may be portioned into four submatrices 
corresponding to elements of the two-port network cascade matrix T. The  
T-matrix of the three-port network presented in Figure 4.8(a) partitioned 
into four submatrices has the form
	
11
12
21
22
,
,
,
,
31
32
41
42
|
|
|
|
|
I I
I II
II I
II II
T
T
T
T
T
T
T
T
é
ù
ê
ú
ê
ú
é
ù
ê
ú
-
-
=
= ê
ú
ê
ú
ë
û
ê
ú
ê
ú
ë
û
T
T
T
T
T
	
(4.187)
The scattering matrix S of this network partitioned into four submatri-
ces corresponding to the input ports and to the output ports is
	
11
12
13
,
,
21
22
23
,
,
31
32
33
|
|
|
I I
I II
II I
II II
S
S
S
S
S
S
S
S
S
é
ù
ê
ú
é
ù
ê
ú
=
= ê
ú
ê
ú
-
-
-
-
ë
û
ê
ú
ë
û
S
S
S
S
S
	
(4.188)
Similarly for the network presented in Figure 4.8(b), we have
	
11
12
13
14
,
,
,
,
21
22
23
24
I I
I II
II I
II II
T
T
|
T
T
|
T
T
|
T
T
é
ù
é
ù
ê
ú
=
-
-
-
-
= ê
ú
ê
ú
ë
û
ê
ú
ë
û
T
T
T
T
T
	
(4.189)
	
11
12
13
,
,
,
,
21
22
23
31
32
33
|
|
|
|
I I
I II
II I
II II
S
S
S
S
S
S
S
S
S
é
ù
ê
ú
-
-
-
é
ù
ê
ú
=
= ê
ú
ê
ú
ë
û
ê
ú
ë
û
S
S
S
S
S
	
(4.190)
The submatrices TI,I, TI,II, TII,I, and TII,II in (4.187) and (4.189) are now 
nonsquare but their mathematical meaning is the same as their corresponding 
elements of the two-port network cascade T-matrix: T11, T12, T21, and T22.

 
Wave Variables and the Scattering Matrix 
71
Equivalent to two-port relations given by (4.180) and (4.181), relations for 
the multiport T-matrix and the multiport S-matrix for multiport networks with 
different numbers of input and output ports may be written as [13]
	
,
,
,
,
,
,
,
,
,
,
,
,
II
I II
I II
II II
I I
I II
II II
II I
II I
II II
II II
II II
II I
+
+
+
+
é
ù
-
é
ù = ê
ú
ê
ú
-
ê
ú
ë
û
ë
û
S
S
T
T
T
T
T
T
S
S
T
T
T
	
(4.191)
and
	
,
,
,
,
,
,
,
,
,
,
,
,
,
I I
I II
I II
I I
II I
II II
I I
II I
II I
II II
II I
II II
II I
+
+
+
+
é
ù
-
é
ù = ê
ú
ê
ú
-
ê
ú
ë
û
ë
û
T
T
S
S
S
S
S
S
T
T
S
S
S
	
(4.192)
where 
,
,
and 
II II
II I
+
+
T
S
 are the pseudoinverse of, respectively, the matrix TII,II 
and the matrix SII,I. This is because TII,II and SII,I are nonsquare matrices. The 
pseudoinverse of any nonzero matrix is a classical generalization of the square 
matrix inverse. The pseudoinverse can be found in several ways. Derivation 
based on the singular value decomposition is an “intuitive” derivation of the 
pseudoinverse [14]. The asymmetry in size between the scattering matrix and 
the chain matrix of the multiport networks with different numbers of input 
and output ports results in inaccurate conversion from the T-matrix to the S-
matrix. This phenomenon can be recognized easily using an example of three-
port network presented in Figure 4.8(a). For this network, information on 
interaction between ports 1 and 2 are present as S12 and S21 parameters in the 
S-matrix. This information does not exist in the T-matrix representation of 
this network. It is evident that conversion from the S-matrix to the T-matrix  
is “lossy.” This is evident because the number of the T-matrix elements of 
unbalanced multiport networks is smaller than the number of the S-matrix 
elements of such multiport.
The theory and methodology presented here allow their practical appli-
cation to cascade and deembed multiport networks in a way similar to those 
applied to standard two-port networks.
4.6  Load Impedance
The load impedance results from the definition of the impedance matrix of a 
linear one-port. It is defined as
	
L
v
Z
i
=
	
(4.193)

72 
Microwave Network Design Using the Scattering Matrix 
where v and i are given by (4.72) and (4.73), at the reference plane, at which 
only a single mode exists.
The load impedance ZL, like v and i, does not depend on the value 
of the reference impedance ZR. In the case of low frequency circuits ZL is a 
unique property of the one port itself. For one-port loads terminating high-
frequency transmission lines, the nature of ZL is much more complicated. The 
impedance of a particular one-port terminating a particular transmission line 
depends on the fields of the EM mode incident upon it. For a different EM 
mode the load impedance of the same device in the same transmission line 
will be different. It is important to realize also that the same one-port device 
located as a load at the end of a different waveguide may have drastically differ-
ent impedance ZL. And finally, because v and i in their definitions depend on  
normalization that determines v0 and i0, ZL also depends on normalization.
According to its definition, when the reference impedance equals the 
load impedance, ZR = ZL = vL/iL, then the reflected wave a(ZR = ZL ) = 0. In 
consequence, according to the definition (4.74) of the pseudowave reflection 
coefficient 
	
(
)
0
R
L
Z
Z
G
=
= 	
(4.194)
This result means that the reference impedance as a load is a perfect 
match. Vice versa, if we insist that the reflection coefficient of a particular 
load terminating a line is equal to zero, it means that we have chosen the 
reference impedance to be equal to the load impedance.
Using (4.194) and (4.74), we have
	
(
)
L
R
R
L
R
Z
Z
Z
Z
Z
-
G
=
+
	
(4.195)
The reversed relation is 
	
1
(
)
1
(
)
R
L
R
R
Z
Z
Z
Z
+ G
=
- G
	
(4.196)
A value of the load impedance calculated from this equation does not 
depend on the value of the reference impedance ZR with respect to which the 
reflection coefficient G has been defined.
4.7  Power Waves and the Power Scattering Matrix
The so-called incident and reflected wave amplitudes normalized to com-
plex port numbers have been used in circuit theory by D.C. Youla [11]. 

 
Wave Variables and the Scattering Matrix 
73
When the main interest is in power relations for networks with uncorrelated 
sources, the traveling waves, discussed in previous sections, are not the best 
choice for network analysis. In such cases, variables called power waves and 
the so-called power scattering matrix defined by K. Kurokawa in 1965 are 
more convenient [12]. The incident and reflected power waves ai and bi are  
defined as
	
2
i
i
i
i
Ri
 + 
 
v
i
Z
 = 
a
ReZ
	
(4.197)
	
*
2
i
i i
i
Ri
v
Z i
b
ReZ
-
=
	
(4.198) 
where vi and ii are the terminal voltage and the terminal current of the ith 
network port, and ZRi is the complex reference impedance of the ith port. 
Only when ZR is real, the power waves reduce to pseudowaves, except for a 
phase factor.
Power waves have nothing in common with traveling waves for any 
choice of the reference impedance ZR as long as the transmission line char-
acteristic impedance Z0 is complex. Only when Z0 is real and equal to the 
reference impedance ZR, also real, are the power waves equal to the traveling 
waves.
Reflected power waves bi, i = 1,2,...N, in all network ports, linearly 
depend on incident power waves ai, i = 1,2,...,N, in all circuit ports. This 
relation in matrix form is
	
ˆ
=
b
Sa	
(4.199)
where coefficient matrix ˆS is called the power scattering matrix of the net-
work. The dimension of the ˆS matrix equals the number N of network  
ports.
Inverse relations to (4.197) and (4.198) are 
	
Ri
Ri
i
i
i
Ri
*
 + 
 
a
b
Z
Z
 = 
v
| Re
|
Z
	
(4.200)
	
i
i
i
Ri
  
a
b
 = 
i
| Re
|
Z
-
	
(4.201)

74 
Microwave Network Design Using the Scattering Matrix 
In the following considerations we will assume that real parts of  
the reference impedances of all network ports are positive: Re {Zi} > 0, i = 
1,2,3, ... N.
By network port we understand a pair of terminals, two nodes of the 
circuit. Definitions of complex power waves given by (4.197) and (4.198) 
does not require that a network port is defined by a reference plane located 
across a waveguide or a transmission line.
It is very important to mention here that variables defined by (4.197) 
and (4.198) are called “power waves” but these quantities have a little in com-
mon with voltage and current waves traveling in transmission lines. First of 
all, power waves do not depend exponentially on z. Furthermore, properties 
of power waves differ fundamentally from those of the renormalized traveling 
waves. For example, the power wave reflection coefficient is
	
*
*
*
(
)
/
/
(
)
(
)
/
1
R
R
L
R
L
R
R
R
R
R
R
L
R
L
R
b Z
v
iZ
Z
Z
Z
Z
Z
Z
Z
a Z
v
iZ
Z
Z
Z
Z
-
-
-
G
=
=
=
=
+
+
+

	
(4.202)
The power wave reflection coefficient of an open circuit (i = 0) is equal 
to 1, the same as the traveling wave reflection coefficient defined in (4.58). 
For a short circuit (v = 0) power wave reflection coefficient is
	
*
(
)
R
R
R
Z
Z
Z
G
= -

	
(4.203)
Because traveling wave reflection coefficient for a short is equal to -1, 
then from (4.203) we see that power wave reflection coefficient is in generally 
not equal to the traveling wave reflection coefficient. This indicates clearly 
that the power waves are not generally related to the traveling waves by the 
impedance transformation.
The implications of this are very significant. As we know from Section 
4.4.1, it is possible to renormalize the traveling waves by introducing a refer-
ence impedance ZR, which may differ from the transmission line characteris-
tic impedance that forms a port. The renormalized reflection coefficient G of 
a load of impedance ZL (which is a pseudoscattering parameter of a one-port 
network) is now
	
/
1
/
1
L
R
L
R
L
R
L
R
Z
Z
Z
Z
Z
Z
Z
Z
-
-
G =
=
+
+ 	
(4.204)

 
Wave Variables and the Scattering Matrix 
75
This relation is the basis for the Smith chart, which presents the graphi-
cal representation of transformation between reflection coefficient and the 
normalized load impedance z´ = ZL/ZR.
Comparison of (4.202) and (4.204) indicates that the Smith chart is 
not applicable to power wave based parameters. Power wave reflection co-
efficient given by (4.202) is not uniquely determined by normalized load 
impedance ZL/ZR. The renormalized reflection coefficient of traveling waves 
of a short circuit (ZL = 0) is always equal to -1 (G = -1) independently on 
the value of reference impedance ZR. This rule does not apply to power wave 
reflection coefficient G. As it has been shown earlier, power wave reflection 
coefficient of a short is equal to 
* /
R
R
Z
Z
-
. This quantity has magnitude 1 but 
is not generally real.
The discussion presented here indicates also that power wave scatter-
ing parameters cannot be measured using the slotted line instrumentation or 
modern vector network analyzer instrumentation.
4.7.1  Physical Interpretation of Power Waves
In order to find physical interpretation of power waves, let us consider the ith 
port of a network, Figure 4.10, connected to a signal source with EMF E and  
internal impedance ZS equal to the reference impedance ZRi of this port.
Figure 4.10  A port excited by a signal source with internal impedance ZS equal to port 
reference impedance ZRi of this port.

Calculating the incident power wave ai at this port, we receive
	
{
}
{
}
{
}
Ri i
Ri
i
Ri
i
i
i
Ri
Ri
Ri
  Z
I
E
  
E
V
Z
I
Z
I
 
  
 = 
a
2 Re 
2  Re
2 Re
Z
Z
Z
+
-
+
=
=
	
(4.205)
Taking the square of the magnitude of ai, we have 
	
{
}
2
2
SA
i
i
i
Ri
|
| E
*
|
|
 =  
 = 
 = 
a
a a
P
4Re Z
	
(4.206)
and realize that this quantity equals the available power of the signal source.
Next, let us consider a circuit presented in Figure 4.10 and calculate 
quantity |ai|2 - |bi|2.
 
(
)(
) (
)(
)
{ }
{
}
+
+
-
-
-
-
=
=
=
2
2
*
4 
*i
i
i
i
i
i
i
i
i
i
i
i
i
i
i
i
i
L
i
*
*
*
*
  
I
  
  
  
  
I
V
V
V
V
Z
Z I
Z I
Z
|
|
|
  |
  
 
a
b
Re Z
*
 Re 
 
  
V I
P
	
(4.207)
It is equal to the real power dissipated in a network and represented at 
terminals of the ith port by the load impedance ZL. It is interesting to note 
that when ZL = Zi*, then
	
{
}
0
RL
i
Ri
i
i
Ri
*
   
Z
I
Z
I
  
  
b
2 Re Z
-
=
=
	
(4.208)
and at the same time
 	
{
}
2
2
2
0
4
L
SA
i
i
Ri
|
| E
|
|
P
|
  |
  
     
a
b
P
 Re Z
=
-
=
-
=
	
(4.209)
Based on the above considerations it is possible to present the fol-
lowing interpretation of power waves ai and bi. Independently on load im-
pedance the signal source transmits to the load ZL a power wave ai, whose 
active power is equal 
2
i|
| a
. If the load is not matched, it means that the  
condition
	
L
i*
 = 
Z
Z 	
(4.210)
76 
Microwave Network Design Using the Scattering Matrix

is not satisfied, then reflected waves return back to the signal source. The real 
power of the reflected power wave bi is equal to 
2
i|
|b
, and in this way the real 
power dissipated in the load equals 
2
2
i
i
|
|
|
  |
a
b
-
.
The ratio of the reflected wave and the incident wave 
	
*
i
Ri i
i
i
Ri i
i
v
Z i
b
  
v
Z i
a
-
G =
=
+

	
(4.211)
is called the power wave reflection coefficient. Squared magnitude of the 
power wave reflection coefficient |G|2 equals the power reflection coefficient. 
Assuming that vi = ZLii, the power wave reflection coefficient of the load may 
be expressed as
	
L
Ri
L
L
Ri
*
  
Z
Z
 
  
Z
Z
-
G
=
+

	
(4.212)
Power reflection coefficient equals
	
2
2
|
L
Ri
L
Ri
*
  
Z
Z
|
 
  
Z
Z
-
G
=
+

	
(4.213)
When the power matching condition (4.210) is satisfied, both power 
wave reflection coefficient and power reflection coefficient are equal to zero.
4.7.2  Physical Interpretation of Power Scattering Parameters
Let us consider a multiport excited in ith port by a signal source with the 
internal impedance equal to the reference impedance ZRi of this port. All 
other ports are terminated with loads whose impedances are equal to refer-
ence impedances of particular ports, which mean that in all other ports except 
for port ith, the incident power waves ak are equal to zero. 
According to (4.199), we have
	
k
Ri
ini
Ri
i
i
i
ii
 
  0
Ri
ini
Ri
i
i
i
k  1,2,...,N
 k i
*
*
  
 
b
v
i
Z
Z
Z
  
  
  = 
  
S
  
  
a
v
i
a
Z
Z
Z
=
=
¹
-
-
=
=
+
+
	
(4.214)
 
Wave Variables and the Scattering Matrix 
77

78 
Microwave Network Design Using the Scattering Matrix 
which means that Sii is a power wave reflection coefficient at the ith port, 
when all other ports are terminated with matched loads (ZLi = ZRi).
However
	
=
=
¹
=
=
2
2
k
Ri
i
ii
 
SAi
i
 
  0
 k  1,2,...,N
 k i
b
P
|
|
  
  
  
S
a
P
a
	
(4.215)
is power reflection coefficient at ith port of a network matched at all other 
ports. It is a ratio of reflected power from this port to the available power of 
the signal source with the internal impedance equal to the reference imped-
ance ZRi of this port.
Similarly, using (4.199)
	
k
j
ji
  0
i k  1,2,...,N
k i
b
  
 
S
a
a =
=
¹
=
	
(4.216)
which means that Sji is a power wave transmission coefficient between ith 
port as an input and jth port as an output in a network, in which all ports are 
terminated with matched loads (ZLi = Zi).
Next
	
=
=
=
2
2
2
j
L
ji
T
SA
i
|
|b
P
|
|
  
  
  
S
G
|
|
P
a
	
(4.217)
is a transducer power gain between ith and jth port, when all other ports are 
terminated with matched loads.
In the case of a two-port presented in Figure 4.11, we have following 
interpretation of four scattering parameters of the network:
	
2
1
11
1
2
input port power wave reflection
coefficient, when 
0
L
R
b
S
a
Z
Z
a
=
=
=
=
	
(4.218)

 
Wave Variables and the Scattering Matrix 
79
 
2
21
L
R2
1
2
power wave transmission coefficient between
input port and output port, when
.
0
b
S  = 
 
Z
Z
a a
=
=
=
	 (4.219)
 
=
=
=
=
1
21
1
2
1
power wave transmission coefficient between 
output port and input port, when 
0
S
R
b
S   
 
Z
Z
a
a
	
(4.220)
	
2
22
1
2
1
output port wave reflection coefficient, 
when 
0
S
R
b
S
  
Z
Z
a a
=
=
=
=
	 (4.221)
and
	
=
=
2
11
2
power reflection coefficient at the input port, 
when 
L
R
S
 
Z
Z
	
(4.222)
2
21
1
2
trasducer power gain between input
and output, when 
 and 
L
SA
T
S
R
L
R
|
|
  
/
  
   
S
G
P
P
Z
Z
Z
Z
=
=
=
=
=
	
(4.223)
	
=
=
=
=
2
12
1
2
trasducer power gain between output 
and input, when 
 and 
R
S
R
L
R
|
|
  
 
S
G
Z
Z
Z
Z
	
(4.224)
Figure 4.11  Two-port network.

80 
Microwave Network Design Using the Scattering Matrix 
	
2
22
R1
power reflection coefficient at the output port, 
when 
S
S
 
Z
Z
=
=
	
(4.225)
In the above relations, ZR1 and ZR2 indicate, respectively, the reference 
impedance of the input port and of the output port.
Besides transducer power gain, two other power gains are defined here 
for a two-port, namely
(1)	Power gain:
	
=
=
-
2
21
2
1
11
1
L
|
| S
P
G
 
 
|
  |
P
S
	
(4.226)
where PL is the real power dissipated in the load ZL = ZR2, and P1 is the real 
power delivered to the input port 1, and 
(2)	Available power gain:
	
=
=
-
2
2
21
2
22
1
A
A
SA
|
| S
P
 
  
G
|
  |
P
S
	
(4.227)
In (4.227), P2A is the available power at the output port of the two-port 
and PSA is the available power of the signal source with internal impedance 
equal to the reference impedance of the input port (ZS = ZR1).
Example 4.5
Using definitions of power waves given by (4.197) and (4.198), find  
the power scattering parameters of a segment of transmission line with 
the characteristic impedance Z0, propagation constant g = a + jb, and 
the length l.
Solution
The S11 parameter is the power wave reflection coefficient seen at port 
1 when port 2 is terminated by a matched load. 
	
2
1
11
1
0
a
b
S
a
=
=
	
(4.228)

 
Wave Variables and the Scattering Matrix 
81
From the definition of ingoing power wave amplitude a (4.197), 
it is evident that condition a2 = 0 may be achieved when ZL = ZR 
( 2
2
2
2
0).
R
R
R
v
i Z
i Z
i Z
+
= -
+
=
 From (4.214), we have
	
-
-
=
=
+
+
1
1
11
1
1
*
*
R
in
R
R
in
R
v
Z i
Z
Z
S
v
Z i
Z
Z 	
(4.229)
where
	
0
0
0
tanh
tanh
R
in
R
Z
Z
l
Z
Z Z
Z
l
γ
γ
+
=
+
	
(4.230)
From (4.229) and (4.230) we receive
	
{
} (
)
(
)
2
2
0
0
11
2
2
0
0
2
Z
tanh
2
tanh
R
R
R
R
j Z Im
Z
Z
l
S
Z Z
Z
Z
l
γ
γ
+
-
=
+
+
	
(4.231)
The S21 parameter is the transmission coefficient from port 1 to port 2 
when port 2 is terminated by a matched load:
	
2
2
21
1
0
a
b
S
a
=
=
	
(4.232)
Because ZL = ZR, 1
1
in
v
i Z
=
 and 2
2
R
v
i Z
= -
, we have
	
{
}
2
2
2
21
1
1
1
*
2
2
R
R
in
R
in
R
R
Re Z
v
i Z
v
Z
S
v
i Z
v Z
Z
Z
-
=
=
+
+
	
(4.233)
From (3.8) we calculate
	
( )
( )
( )
1
0
0
0
(
0)
(1
)
in
v
v z
V
V
V
+
-
+
=
=
=
+
=
+ G
	
(4.234)
	
(
)
( )
( )
( )
2
0
0
0
(
)
l
l
l
l
in
v
v z
l
V
e
V
e
V
e
e
γ
γ
γ
γ
+
-
-
+
-
=
=
=
+
=
+ G
	 (4.235)
where
	
0
0
in
in
in
Z
Z
Z
Z
-
G
=
+
	
(4.236)

82 
Microwave Network Design Using the Scattering Matrix 
Using (4.233) through (4.236), we receive
	
{
}
(
)
1
0
21
2
2
0
0
2
cosh
2
tanh l
R
R
R
Re Z
Z
l
S
Z Z
Z
Z
γ
γ
-
=
+
+
	
(4.237)
Because of the symmetry of the network, and because ZR1 = ZR2 = ZR 
the following relations hold: S11 = S22 and S12=S21. Then we can write
	
(
)
{
} (
)
{
}
{
}
{
} (
)
2
2
0
0
2
2
0
0
1
0
1
0
2
2
0
R
0
1
2
tanh
2
tanh
2
cosh
2
cosh
2
Z
tanh
R
R
R
R
R
R
R
Z Z
Z
Z
l
j Z Im Z
Z
Z
l
Re Z
Z
l
Re Z
Z
l
j Z Im
Z
Z
l
γ
γ
γ
γ
γ
-
-
=
+
+
é
+
-
ê
êë
ù
ú
ú
+
-
û
S
	
(4.238)
When reference impedance ZR equals the characteristic impedance of 
the line Z0, then (4.238) simplifies to 
	
{
} (
)
{
}
{
}
{
} (
)
20
2
2
0
0
0
0
1
0
0
1
0
0
2
2
0
0
0
0
1
2
(1 tanh
)
2
tanh
2
cosh
2
cosh
2
tanh
Z
l
j Z Im Z
Z
Z
l
Re Z
Z
l
Re Z
Z
l
j Z Im Z
Z
Z
l
γ
γ
γ
γ
γ
-
-
=
+
é
+
-
ê
êë
ù
ú
ú
+
-
û
S
	
(4.239)
And finally, when Z0 is real
	
0
0
j l
j l
e
e
β
β
-
-
é
ù
= ê
ú
ê
ú
ë
û
S
	
(4.240)

 
Wave Variables and the Scattering Matrix 
83
4.7.3  Conversions Between Power Wave Scattering Matrix and Other Matrix 
Descriptions of Microwave Networks
4.7.3.1  Impedance Matrix
Let as consider an n-port network and let a, b, v, and i denote vectors whose 
ith elements are quantities ai, bi, vi, and ii (ingoing and outgoing power waves 
and terminal voltage and terminal current of the ith network port). The vec-
tors a and b can be written as linear combinations of terminal voltage v and 
terminal current i vectors as [16] 
	
(
)
=
+
a
F v
Gi 	
(4.241)
	
+
=
-
(
)
b
F v
G i 	
(4.242)
where F and G are diagonal matrices
	
1
2
diag 1/2
,1/2
,...1/2
R
R
Rn
ReZ
ReZ
ReZ
é
ù
=
ë
û
F
	
(4.243)
and
	
[
]
1
2
diag Z
,
,...,
R
R
Rn
Z
Z
=
G
	
(4.244)
and + indicates the complex conjugate transposed matrix.
Because the impedance matrix is defined by the matrix relation
	
=
v
Zi	
(4.245)
and the power wave scattering matrix relates vectors a and b
	
ˆ
=
b
Sa	
(4.246)
then elimination of a, b, and v from (4.191) and (4.192) gives [6, 16]
	
ˆ
(
)
(
)
+
-
=
+
F Z
G
i
SF Z
G i	
(4.247)
from which one can obtain
	
1
1
ˆ
(
)(
)
+
-
-
=
-
+
S
F Z
G
Z
G
F
	
(4.248)
The reverse relation is
	
1
1
ˆ
ˆ
(
) (
)
-
-
+
=
-
+
Z
F
I
S
SG
G
F	
(4.249)
where I is a unit matrix.

84 
Microwave Network Design Using the Scattering Matrix 
4.7.4  Power Scattering Matrix Properties
4.7.4.1  Reciprocal Network
The impedance matrix of a reciprocal network (a network that contains only 
linear materials) satisfies the relation [6, 7]
	
-
=
T
1
Z
WZW
	
(4.250)
where index T indicates the transposed matrix and W is the diagonal matrix 
with diagonal elements
	
0
0
0
0 0
0
0
*
,
1,2,...,
*
i
i
i
i
i
i
i
i
p
p
v
W
i
N
v i
v
p
=
=
=
	
(4.251)
In (4.251), 
0
0
0 ,
and 
i
i
i
p
v
i  are given by (4.89), (2.4), and (2.5).
Equation (4.250) requires that the off-diagonal elements of the Z ma-
trix satisfy the reciprocity relation
	
j
ij
ji
i
W
Z
Z
W
=
	
(4.252)
It has been proved by R. B. Marks and D. F. Williams [6] that the 
power wave scattering matrix obeys the same reciprocity relation as the im-
pedance matrix
	
1
ˆ
ˆ
T
-
=
S
WSW
	
(4.253)
or
	
ˆ
ˆ
j
ij
ji
i
W
S
S
W
=
	
(4.254)
Relations (4.252) and (4.254) indicate that the Z matrices, like the ˆS 
matrices of reciprocal networks, are generally asymmetrical.
4.7.4.2  Lossless Network
Because real power submitted into the ith port of the network is equal to
-
2
2
i
i
|
|
|
  |
a
b
, then the total power delivered to the network is
	
(
)
2
2
1
N
i
i
i
P
a
b
=
=
-
å
	
(4.255)

 
Wave Variables and the Scattering Matrix 
85
When the network is lossless, then the total power P has to be equal to 0 
	
(
)
2
2
1
0
N
i
i
i
a
b
=
-
=
å
	
(4.256)
The matrix form of this relation is
	
0
+
+
-
=
a a
b b
	
(4.257)
from which after substitution 
ˆ
=
b
Sa, one receives
	
ˆ ˆ
(
)
0
+
+
-
=
a
I
S S a
	
(4.258)
Because the vector a ¹ 0 then (4.258) indicates that
	
ˆ ˆ
+ - =
S S
I
0	
(4.259)
which means that the power wave scattering matrix of a lossless network is a 
unitary matrix (I – the unit matrix).
4.7.5  Port Connections
When two devices are joined as shown in Figure 4.12, we usually assume that 
when reference impedances of two connected together ports are identical, we 
use the simple boundary condition that (i, j – numbers of connected ports)
	
 and     
 
 
i
j
j
i
a
b
a
b
=
=
	
(4.260)
These conditions are intuitive and fundamental for signal analysis and 
modeling of microwave networks.
j-port
i-port
ai
bi
vi
ii
ij
aj
bj
vj
Figure 4.12  Connection of two ports.

86 
Microwave Network Design Using the Scattering Matrix 
In classical waveguide network theory, these conditions come directly 
from the continuity of the voltage and the currents at the junction
	
     and      
i
j
i
j
v
v
i
i
=
= - 	
(4.261)
To find relation between power wave amplitudes at a junction, we sub-
stitute into (4.261) the relations for currents and voltages as functions of 
ingoing and outgoing power waves ((4.200) and (4.201)) on both sides of the 
port connection, and get
    
{
}
{
}
é
ù =
ê
ú
+
ë
û
é
ù
-
é
ù
ê
ú
´
ê
ú
ê
ú ë
û
-
ê
ú
ë
û
1
*
2
*
2
i
j
Ri
Rj
Rj
Ri
Ri
Rj
i
j
Ri
Rj
Ri
Rj
b
b
Z
Z
Z
Z
Re Z
Re Z
a
b
Re Z
Re Z
Z
Z
{
}
{
}
	   
(4.262)
From (4.262) we observe that when the reference impedances of the 
adjoint ports are identical (ZRi = ZRj) the power waves at both sides of the 
junction do not satisfy the boundary conditions given by (4.260). Instead of 
this we have 
	
{
}
{
}
{
}
{
}
1
i
i
R
R
j
j
R
R
R
b
a
Im Z
Re Z
b
a
Z
Re Z
Im Z
é
ù
é
ù
é
ù
=
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
	
(4.263)
Only when reference impedances of the adjoint ports satisfy the  
condition
	
*
Ri
Rj
Z
Z
=
	
(4.264)
(4.262) relating the ingoing and outgoing waves on both sides of the port 
junction simplifies to
	
0
1
1
0
i
i
j
j
b
a
b
a
é
ù
é
ù
é
ù
=
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û	
(4.265)
It is a very important conclusion because network analysis based on 
power wave variables referenced to complex impedances may lead to unac-
ceptable results if the relations presented above are not taken into account. 

 
Wave Variables and the Scattering Matrix 
87
References
  [1]	 Collin, R. E., Foundations for Microwave Engineering, Tokyo: McGraw-Hill Kogakusha 
Ltd., 1966, and New York, 1992 (second edition).
  [2]	 Ramo, S., T. R. Whinnery, and T. van Duzer, Fields and Waves in Communication 
Electronics, New York: John Wiley & Sons, 1965.
  [3]	 Montgomery, C. G., R. H. Dicke, and E. M. Purcell, Principles of Microwave Circuits, 
Vol. 8 of MIT Rad. Lab. Series, New York: McGraw-Hill, 1948.
  [4]	 Marcuvitz, N., Microwave Handbook, Vol. 10 of MIT Rad. Lab. Series, New York: 
McGraw-Hill, 1948.
  [5]	 Pozar, D. M., Microwave Engineering, Reading, MA: Addison-Wesley Publishing Com-
pany, 1990.
  [6]	 Marks, R. B., and D. F. Williams, “A General Waveguide Circuit Theory,” J. Res. Natl. 
Inst. Stan., Vol. 97, 1992, pp. 533–62.
  [7]	 Williams, D. F., and R. B. Marks, “Reciprocity Relations in Waveguide Junctions,” 
IEEE Trans. Microwave Theory Tech., Vol. 41, No. 6/7, pp. 1105–10, June/July 1993.
  [8]	 Kerns, D. M., and R. W. Beatty, “Basic Theory of Waveguide Junctions and Introduc-
tory Microwave Network Analysis,” Oxford: Pergamon Press, 1966.
  [9]	 Bodway, G. E., “Circuit Design and Characterization of Transistors by Means of 
Three-Port Scattering Parameters,” Microwave J., May 1968, pp. 55–63.
[10]	 Satoga, Y., and G. E. Bodway, “Three-Port Scattering Parameters for Microwave 
Transistor Measurement,” IEEE J. Solid State Circuits, Vol. SC-3, No. 3, Sept. 1968,  
pp. 250–53.
[11]	 H. Shi, W. T. Beyene, and J. Feng, et al., “ Properties of Mixed Parameters of Cascaded 
Balanced Networks and Their Applications in Modeling of Differential Interconnects,” 
IEEE Trans. Microwave Theory Tech., Vol. 54, No.1, January 2006, pp. 360–71.
[12]	 R. B. Marks, “A Multiline Method of Network Analyzer Calibration,” IEEE Trans. 
Microwave Theory Tech., Vol. 39, 1991, pp. 1205–15.
[13]	 J. Frei, X. D. Cai, and S. Muller, “Multiport S-Parameters and T-Parameters Con-
version with Symmetry Extension,” IEEE Trans. Microwave Theory Tech., Vol. 56,  
November 2008, pp. 2493–504.
[14]	 G. H. Golub, and C. F. Van Loan, “Matrix Computation,” Baltimore, MD, The Johns 
Hopkins University Press.
[15]	 D. C. Youla, “On Scattering Matrices Normalized to Complex Port Numbers,” Proc. 
IRE, Vol. 49, 1961, p. 122.
[16]	 K. Kurokawa, “Power Waves and the Scattering Matrix,” IEEE Trans. Microwave The-
ory Tech., Vol. MTT-13, No. 2, 1965, pp. 194–202.


89
5
Signal Analysis of Multiport Networks
Scattering parameters are very much suited for analysis and design of micro-
wave networks for which basic parameters are power gains, insertion loss, 
reflection loss, voltage transfer gain, or group delay [1–15]. Typical examples 
of such circuits are transistor amplifiers, filters, phase shifters, or switches. 
In this chapter we discuss microwave network analysis methods based on 
scattering matrix and wave variables, and present four approaches to these 
problems. First, there is a short presentation of the signal flow graph method. 
We provide a basic outline of this approach. Deeper considerations on the 
application of the signal flow graph method in microwave network analysis 
can be found in the literature [1, 7, 8].
Next, we present relations applicable to two-port network signal analysis. 
We consider and derive relations to compute power gain, available power gain, 
transducer power gain, insertion loss, voltage gain, and voltage transfer gain. 
Two-port network stability problems are also a subject of considerations in this 
chapter. We present conditions for unconditional two-port network stability, 
conjugate match conditions for maximum power gain, and relations determining 
constant power gain circles as well as constant available power gain circles.
We also present multiport network analysis method applicable to net-
works characterized as single multiports excited by signal sources at input 
ports and loaded at output ports by one-port terminations.
Finally, we present the most general method for signal analysis of micro-
wave networks. The method is based on the so-called connection scattering  

90 
Microwave Network Design Using the Scattering Matrix 
matrix. It is used to multielement multiport networks considered as a connection 
of many multiport elements described by their individual scattering matrices.
5.1  Wave Relations for Basic Elements of Multiport Networks
Basic elements of multiport networks are two particular one-ports: a signal 
source and a load.
5.1.1  Signal Source
Figure 5.1 illustrates the signal source and its equivalent circuit. Using the 
relation
	
S
S
S S
v
E
Z i
=
+
	
(5.1)
and (4.50) and (4.51) representing voltage and current in terms of ingoing 
and outgoing traveling waves, we receive
	
{ }
-
=
+
º G
+
+
+
0
0
0
0
0
(
)
S
G
S
S
G
S
Re p
E
Z
Z
b
a
a
b
Z
Z
i Z
Z
	
(5.2)
from which we have
	
0
0
S
S
S
Z
Z
Z
Z
-
G =
+
	
(5.3)
which is the reflection coefficient of the signal source port and
	
0
0
0
{
}
(
)
S
S
S
Re p E
b
i Z
Z
=
+
	
(5.4)
∼
∼
a
b
a
b
=
+
s
vS
iS
ZS
ES
Figure 5.1  Signal source and its circuit model.

	
Signal Analysis of Multiport Networks	
91
is the impressed wave of the signal source.
Because
	
{
}
2
2
0
2
0
Re Z
S
S
S
E
b
Z
Z
=
+
	
(5.5)
we see that 
2
Sb
 is equal to the real power dissipated in a load equal to the 
characteristic impedance Z0.
For pseudowaves, similar relations are
	
{
}
0
0
0
(
)
R
S
S
R
R
S
S
S
S
R
R
S
Re Z
E
v
Z
Z
Z
b
a
a
b
Z
Z
v
Z
Z
Z
-
=
+
º G
+
+
+
	
(5.6)
	
S
R
S
S
R
Z
Z
Z
Z
-
G =
+
	
(5.7)
	
{
}
0
0
0
(
)
R
S
R
S
R
S
Re Z
E
v
Z
b
v
Z
Z
Z
=
+
	
(5.8)
and
	
{
}
2
2
2
S
S
R
S
R
E
b
Re Z
Z
Z
=
+
	
(5.9)
which is a real power dissipated in a load equal to the reference impedance ZR.
For power waves, the same relationships may be found as follows.
Inserting (4.200) and (4.201) into v = ES + i ZS creates a new equa-
tion describing the signal source in the scattering matrix and power waves 
domain
	
=
+
GS
S
b  
a  b 	
(5.10)
where
	
{
}
R
S
S
R
S
Re Z
E
 =  
b
 Z
Z
+
	
(5.11)
is a complex wave impressed by signal source and

92 
Microwave Network Design Using the Scattering Matrix 
	
*R
S
S
R
S
  Z
Z
  
  Z
Z
-
=
G
+
	
(5.12)
is the power wave reflection coefficient at the signal source port (with respect 
to the reference impedance ZR of this port).
Calculating 
2
S|
|b
, we get
	
(
)
- G
2
2|
1
SA
S
S
= 
  |
b
P
	
(5.13)
where
	
{
}
2
4
S
SA
S
E
  
P
Re Z
=
	
(5.14)
5.1.2  Load
The second very important one-port is a load. Figure 5.2 presents this ele-
ment and its circuit model.
The equation describing this element using traveling waves is
	
0
0
b
a
= G
	
(5.15)
where
	
0
0
L
L
Z
Z
Z
Z
-
G =
+
	
(5.16)
Load
a
b
i
v
ZL
Figure 5.2  A load and its circuit model.

	
Signal Analysis of Multiport Networks	
93
Calculation of the real power 
{
}
=
2
L
L
P
i
Re Z
 dissipated in this one 
port leads to
	
{
}
ς
ζ
=
-
+
é
ù
=
- G
-
G
ë
û
2
2
0
0
0 0
2
2
0
*
2tan
a
1
2Im{ }tan
L
P
a
b
Im
b
a
	
(5.17)
where ς is the phase of the characteristic impedance Z0
	
{
}
{
}
ς =
0
0
tan
Im Z
Re Z
	
(5.18)
For pseudowaves, the same relationships are
	
b
a
= G 	
(5.19)
where
	
L
R
L
R
Z
Z
Z
Z
-
G =
+
	
(5.20)
Calculation of the real power 
{
}
=
2
L
L
L
P
i
Re Z
, which dissipates in this 
one port, leads to the relationship
	
{
}
ς
ζ
=
-
+
é
ù
=
- G
-
G
ë
û
2
2
2
*
2tan
1
2
{ }tan
L
P
a
b
Im ab
a
Im
	
(5.21)
where ς is the phase of the reference impedance ZR
	
{
}
{
}
tan
R
R
Im Z
Re Z
ς =
	
(5.22)
For power waves, the equations describing the load are
	
= GL
b  
 a	
(5.23)

94 
Microwave Network Design Using the Scattering Matrix 
where
	
*R
L
R
L
  Z
Z
  
  Z
Z
-
G =
+
	
(5.24)
and ZR is the reference impedance of the load port.
The calculation of real power 
{
}
=
2
L
L
P
i
Re Z
, which dissipates in the 
load, leads to the relationship
	
(
)
2
2
2
2 1
L
P
a
b
a
=
-
=
- G
	
(5.25)
To find the relationship for the available power of the signal source we 
have to consider the network presented in Figure 5.3.
For this network we have
	
L
L L
a
b
a
=
= G
	
(5.26)
and
	
L
S
S
S
L L
S
a
b
a
b
a
b
=
= G
+
= G G
+
	
(5.27)
from which
	
1
S
L
S
L
b
a =
- G G 	
(5.28)
Signal
source
Load
a
b
b
a
= Γ
+
L
L
L
L
b
a
b
= Γ
+
S
S
aL
Figure 5.3  Signal source and a load.

	
Signal Analysis of Multiport Networks	
95
Then (5.17) becomes
	
{
}
{
}
2
2
L
2
2
L
2
1
2tan
1
2tan
1
L
L
L
S
L
S
L
P
a
Im
b
Im
ζ
ζ
é
ù
=
- G
-
G
ë
û
é
ù
=
- G
-
G
ë
û
- G G
	
(5.29)
where ζ is the phase of the characteristic impedance Z0 for traveling waves or 
ζ is the phase of the reference impedance ZR for pseudowaves.
The available power is obtained by replacing in (5.29) GL with the  
value GLopt, which maximizes PL. With some effort, it can be shown that this 
value is
	
*
tan
*
1
tan
S
Lopt
S
j
j
ζ
ζ
G -
G
=
- G
	
(5.30)
Substituting 
L
Lopt
G
= G
 in (5.29), we receive the expression for the 
available power of the signal source
	
{
}
2
2
2
1
2
tan
cos
S
SA
S
S
b
P
Im
ζ
ζ
= é
ù
- G
-
G
ë
û
	
(5.31)
The relation (5.30) replaces the very well known relation
	
*
Lopt
S
G
= G 	
(5.32)
which is applicable for a case with lossless transmission line as a port (real 
characteristic impedance Z0). For a lossless line case, (5.29) simplifies to
	
(
)
(
)
2
2
2
2
2
1
1
1
S
L
L
L
L
S
L
b
P
a
=
- G
=
- G
- G G
	
(5.33)
In the lossless case the available power of the signal source is
	
2
2
1
S
SA
S
b
P
=
- G
	
(5.34)

96 
Microwave Network Design Using the Scattering Matrix 
In the case of power waves to fulfill conditions of continuity of power 
waves at the junction (5.26) and (5.27), reference impedances of connected 
ports have to be complex conjugate. The real power dissipated in the load is
	
(
)
(
)
=
- G
=
- G
- G G
2
2
2
2
2
1
1
1
S
L
L
L
L
S
L
b
P
a
	
(5.35)
where
	
*
S
R
S
S
R
Z
Z
Z
Z
-
G =
+
	
(5.36)
and
	
*
L
R
L
L
R
Z
Z
Z
Z
-
G =
+
	
(5.37)
The optimal value of 
L
G , which maximizes PL is
	
*
*
*
*
S
R
Lopt
S
S
R
Z
Z
Z
Z
-
G
= G =
+
	
(5.38)
Substituting 
L
Lopt
G
= G
 in (5.35) we receive the expression for the avail-
able power of the signal source in the power wave domain
	
{
}
=
=
+
2
2
2
s
R
SA
S
S
R
E
Re Z
P
b
Z
Z
	
(5.39)
5.2  Microwave Network Analysis Using Scattering Parameters 
and Signal Flow Graphs
As unitless quantities, scattering parameters create a very useful parameter set 
for signal flow graph based analysis of microwave networks [1, 7]. In a signal 
flow graph each port of a network is represented by two nodes. The node 
signed ai represents incident wave and the node signed bi represents reflected 
wave in the ith port. Scattering parameters are transmittances of flow graph 
branches (directed paths). Signal flow graph method of network analysis is 
particularly suitable in a case of cascaded networks with feedback loops.

	
Signal Analysis of Multiport Networks	
97
Figure 5.4 presents an equivalent network of a signal source and a signal 
flow graph of this element.
In the case of a one-port network (a load with impedance ZL ), its signal 
flow graph is very simple. It is shown in Figure 5.5.
A set of linear equations describing a two-port network is
	
1
11
12
1
2
21
22
2
b
S
S
a
b
S
S
a
é
ù
é
ùé
ù
=
ê
ú
ê
úê
ú
ë
û
ë
ûë
û	
(5.40)
The signal flow graph of a two-port network is presented in Figure 5.6.
Knowing the relationships presented above, we are able to draw the sig-
nal flow graph of a two-port network excited at the input by the signal source 
and terminated at the output by the load with the reflection coefficient 
L
G . 
In Figure 5.7, we present the signal flow chart of the considered network. It 
is true and correct under the assumption that connections of ports are reflec-
tionless. In the case of traveling waves, satisfaction of this condition means 
that characteristic impedances Z0 of connected ports are equal, in the case of 
pseudowaves, the reference impedances of connected ports have to be equal, 
and in the case of power waves, the reference impedances of connected ports 
have to satisfy the condition: 
*
Ri
Rj
Z
Z
=
.
Using the signal flow graph, any transfer function between independent 
and dependent nodes can be derived by the nontouching loop rules of signal 
flow theory, which are called Mason’s rules [1, 7, 8].
To present these rules, we have to introduce terms related to flow graphs:
1.	 Independent variable node : Independent variable node is a node cor-
responding to an incident wave.
Signal
source
a
a
1
b
a
b
= Γ
+
S
S
ΓS
bS
b
Figure 5.4  Signal source and its signal flow graph.

98 
Microwave Network Design Using the Scattering Matrix 
2.	 Dependent variable node : Dependent variable node is a node cor-
responding to a reflected wave.
3.	 Path : Path is a series of directed lines followed in sequence and in 
the same direction in such a way that no node is touched more than 
once. The value of the path is the product of all coefficients encoun-
tered en route. In Figure 5.7, which is a flow graph of a terminated 
two-port network, there is only one path from node bS to node b2 
and the value of the path is S21. There are two paths from bS to b1, 
and the values are S11 and S21GLS12. There are also two paths from 
node a1 to node b1, with values S11 and S21GLS12.
4.	 First-order loop : A first-order loop is defined as the product of all 
coefficients along the paths starting from a node and moving in the 
direction of the arrows back to that original node without passing 
the same node twice. In Figure 5.7 there are three first-order loops, 
and the values are S11GS, S22GL, and S21GLS12GL.
Two-port
a1
a1
b1
b1
a2
a2
b2
b2
S21
S12
S11
S22
Figure 5.6  A two-port and its signal flow graph.
Load
a
a
b
a
= ΓS
b
ΓS
Figure 5.5  Signal flow graph of a load.

	
Signal Analysis of Multiport Networks	
99
5.	 Second-order loop : A second-order loop is defined as the product of 
any two nontouching first-order loops. In Figure 5.7, there is only 
one second-order loop and its value is S11GS S22GL. 
6.	 Third-order loop : A third-order loop is the product of any three non-
touching first-order loops. In Figure 5.7 there is no third-order loop.
Then, Mason’s rule for the ratio of a dependent variable to an indepen-
dent variable is given by
 
	
(1)
(1)
(2)
1
2
1
(1)
(2)
...
1
(1)
...
....
1
(1)
(2)
(3)
...
P
L
L
P
L
T
L
L
L
é
ù
é
ù
-
+
-
+
-
+
+
ê
ú
ê
ú
ë
û
ë
û
=
-
+
-
+
å
å
å
å
å
å
	
(5.41)
where:
P1, P2, P3,… are the various paths connecting these variables;
åL(1), åL(2), åL(3),… are the sums of all first-order, second-order, 
third-order, …, loops, respectively;
åL(1)(1), åL(2)(1), åL(3)(1),… are the sums of all first-order, second-
order, third-order, …, loops that do not touch the first path between 
the variable;
åL(1)(2), åL(2)(2), åL(3)(2),… are the sums of all first-order, second-
order, third-order, …, loops that do not touch the second path between 
the variable.
a1
b1
a2
b2
ΓL
S12
S11
S22
ΓS
bS
1
S12
Figure 5.7  Signal flow graph of a two-port network with the signal source at the input and a 
load at the output.

100 
Microwave Network Design Using the Scattering Matrix 
5.3  Signal Analysis of Two-Port Networks
Scattering parameters are especially suitable in application to signal analysis 
of two-port networks such as small signal amplifiers, low noise amplifiers, fil-
ters, transformers, phase shifters, and attenuators. Working parameters used 
in analysis and design of microwave networks are three power gains, in par-
ticular, power gain, available power and transducer power gain, voltage gain, 
and voltage transfer gain.
5.3.1  Transducer Power Gain
Using Figure 5.8 and pseudowaves, we calculate transducer power gain GT in 
the following way. Because real power dissipated in the load is
 	
{
}
ς
é
ù
=
-
-
G
G
ë
û
2
2
2
|
|
1
|
2
tan
L
L
L
|
  
  
Im
b
P
	
(5.42)
and available signal source power
 	
{
}
ς
ς
é
ù
-
-
G
G
ë
û
2
2
2
S
1
2Im
tan
cos
S
SA
S
|
|b
 = 
P
  
	
(5.43)
then
	
{
}
{
}
ς
ς
ς
é
ù
=
=
-
-
G
G
ë
û
é
ù
´
-
-
G
G
ë
û
2
2
S
2
2
1
|
2
tan
1
|
2
tan
cos
2
L
S
T
SA
S
L
L
b
P
|
  
   
 
  
Im
G
b
P
|
  
Im
(5.44)
Signal
source
b
a
b
= Γ
+
S
S
Two-port
Load
b1
b2
a1
a2
b
a
= ΓL
L
a
aL
Figure 5.8  A two-port network driven by a signal source and terminated by a load. Power 
gain G is a function of the two-port S-parameters and GL. Available power gain GA 
is a function of the two-port S-parameters and GS, while transducer power gain 
GT is a function of the two-port S-parameters, GS and GL. 

	
Signal Analysis of Multiport Networks	
101
After determining b2/bS from a flow graph using Mason’s rule we can 
find the expression for the transducer power gain as a function of two-port 
network scattering and signal source and load reflection coefficients.
Example 5.1
Derive the expression for the transducer power gain as a function of 
scattering parameters using signal flow graph and Mason’s rule.
Solution:
According to (5.44), from inspection of the signal flow graph presented 
in Figure 5.7, we have to determine transfer function of b2 over bS. In 
this case bS is the independent variable and b2 is the dependent variable. 
There is one path from node bS to node b2:
	
P1 = S21	
(5.45)
There are three first-order loops S11GS , S22 GL , and S21GLS12GL with 
sum:
	
L(1) = S11GS + S22GL + S21GLS12GL	
(5.46)
and there is one second-order loop S11GS S22GL. The sum of second-
order loops is
	
L(2) = S11GS S22GL	
(5.47)
There are no first-order (or higher) loops that do not touch the S21 path, 
so
	
S L(1) = 0	
(5.48)
Then from (5.41) we have the transfer function of b2 over bS given by
	
2
21
11
22
21
12
11
22
1
S
S
L
S
L
S
L
b
S
b
S
S
S
S
S
S
=
-
G -
G -
G
G +
G
G 	
(5.49)
After setting (5.49) into (5.44), we have
{
}
{
}
ς
ς
ς
=
é
ù é
ù
-
-
-
-
G
G
G
G
ë
û ë
û
-
-
-
+
G
G
G
G
G
G
2
2
2
2
S
L
L
21
11
22
21
12
11
22
1
|
2Im
tan
1
|
2Im
tan
cos
|1
T
S
2
S
L
S
L
S
L
  
G
|
|
|
|
 
 
S
|
  
  
  
S
S
S
S
S
S
	
(5.50)

102 
Microwave Network Design Using the Scattering Matrix 
or
{
}
{
}
ς
ς
ς
é
ù é
ù
-
-
-
-
G
G
G
G
ë
û
ë
û
-
-
-
G
G
G G
2
2
2
2
S
21
2
S
11
22
21 12
1
|
2
tan
1
|
2
tan
cos
|(1
)(1
)
T
S
L
L
S
L
L
 = 
G
|
|
|
|
 
Im
 
Im
S
|
  
 
  
S
S
S
S
	
(5.51)
In the case of real reference impedance ZR of network ports (Im{ZR} = 0, 
tan
0, cos
1)
ς
ς
=
= ) this relationship simplifies to
	
é
ù é
ù
-
-
G
G
ë
û ë
û
=
-
-
-
G
G
G G
2
2
2
21
2
L
11
22
21 12
|
1
|
1
|
|(1
)(1
)
S
L
T
S
S
L
|
S
|
|
  
 
G   
|
  
  
  
S
S
S
S
	
(5.52)
The transducer power gain is a function of the two-port network 
scattering parameters and of both the signal source port reflection coef-
ficient GS and the load port reflection coefficient GL.
5.3.2  Power Gain
Using pseudowaves and proceeding in the way similar to transducer power 
gain derivations, we calculate power gain as
       
{
}
{
}
ξ
ς
=
é
ù
-
-
G
G
ë
û
=
-
-
- D
-
G
-
G
G
G
L
2
2
21
2
2
2
11
22
22
1
2
tan
|1
|
|
2
tan |1
|
IN
L
L
IN
L
L
L
P
G  
P
|
|
|
  |
Im
S
 
|
  
 S
Im
S
S
	
(5.53)
where PIN is the power delivered to the input port,
	
- DG
G
=
-
G
11
22
1
L
IN
L
S
  
S
	
(5.54)
is the input port reflection coefficient and
	
11 22
12 21
S S
S S
D =
-
	
(5.55)
In the case of real reference impedance ZR, (5.53) simplifies to
	
é
ù
- G
ë
û
-
-
- D
G
G
2
2
21
2
2
22
11
|
1 |
|1
L
L
IN
L
L
|
S
|
P
G = 
= 
|
|
P
  |
|
S
S
	
(5.56)

	
Signal Analysis of Multiport Networks	
103
The power gain is a function of the two-port network scattering param-
eters and of the load port reflection coefficient GL only. Power gain does not 
depend on the signal source port reflection coefficient GS.
5.3.3  Available Power Gain
Available power gain is the third power gain parameter used in analysis and 
design of microwave networks. It is defined as a ratio of the power available 
at the output port of the network POUT and of the power available from the 
signal source PSA. The available power POUTA is the power delivered to the 
output port load under matching conditions; that is, when GL = G*OUT. Be-
cause the output port reflection coefficient of a two-port loaded at the input 
port with the signal source with the reflection coefficient GS equals
	
G
+ D G
G
=
+
=
-
G
-
G
12 21
22
22
11
11
1
1
S
S
OUT
S
S
S S
S
S
S
S
	
(5.57)
then substituting in (5.51) or (5.52) GL by complex conjugate value of GOUT 
given by (5.57), we receive the expression for the available power gain of a 
two-port. For real and the same reference impedance for all ports of the net-
work, we get
	
(
)
(
)
{
}
- G
-
+
-
G
G
- D
2
2
21
2
2
2
2
1
22
11
1
|
1
|
|
2
|
|
S
OUTA
A
SA
S
S
|
| S
|
  
P
G  = 
= 
|
|
P
  
  
  Re C
S
|
|
  
S
	
(5.58)
where D = S11S22 - S12S21 and C1 = S11 - D 22*
S .
The available power gain is a function of the two-port network scat-
tering parameters and of the signal source port reflection coefficient GS only. 
Available power gain does not depend on the load port reflection coefficient 
GL.
5.3.4  Stability Consideration for Active Two-Port Networks
In active network design, stability considerations are of a basic nature. De-
signing a transistor amplifier with no attention to its stability usually leads 
to useless results. Scattering parameters are the most convenient and reliable 
network parameters that are used in considerations for predicting and assur-
ing stability of active networks at microwave frequencies [1, 9–15].

104 
Microwave Network Design Using the Scattering Matrix 
In linear theory, two-port networks loaded at the input port and at the 
output port by particular passive impedances are considered at a particular 
frequency to be stable, if the real parts of their impedance seen at its input 
port and of the impedance seen at the output port are both positive. If the 
real parts of the input and output impedances remain positive (Re{ZIN}>0 
and Re{ZOUT}>0) for all passive signal source impedances and load imped-
ances (Re{ZS}>0 and Re{ZL}>0), than it is said that a two-port network is 
unconditionally stable.
The two-port network is conditionally stable if the real parts of its input 
and output impedances become negative for some passive signal source im-
pedances and/or for some passive load impedances. It is important to note that 
these two conditions (for the input port and for the output port) are applied 
and considered at a specific frequency. As a matter of fact, the conditions for 
two-port stability that are going to be presented here will have to be investigated  
at many frequencies to ensure broadband stability of the network.
Investigations on two-port network stability performed in the domain 
of the input port impedance and of the output port impedance may be car-
ried on in the reflection coefficient domain.
The input port and the output port reflection coefficients of a two-port 
network are
	
G
G
=
-
-
G
21 12
11
22
1
L
IN
L
S S
S
S
	
(5.59)
	
G
G
=
-
-
G
21 12
22
11
1
S
OUT
S
S S
S
S
	
(5.60)
where GS and GL are the reflection coefficients of the signal source port and 
the load port, respectively.
The condition for the passivity of the input and output impedances of the 
two-port (Re{ZIN}> 0 and Re{ZOUT}> 0) for all possible combinations of pas-
sive signal source internal impedance and load impedance is equivalent to
	
G
G
=
-
<
G
<
-
G
21 12
11
22
1     for any    
1
1
L
IN
L
L
S S
S
S
	
(5.61)
and
	
G
G
=
-
<
G
<
-
G
21 12
22
11
1     for any    
1
1
S
OUT
S
S
S S
S
S
	
(5.62)

	
Signal Analysis of Multiport Networks	
105
but with one very important assumption that the reference impedances of 
both ports are real. This assumption comes from the fact that only when the 
reference impedance ZR is real, the reflection coefficient of passive load has 
the magnitude less than 1. For complex ZR this is not always true.
The necessary and sufficient conditions for unconditional stability of 
a two-port network are a consequence of (3.61) and (3.62). They have the 
form of two inequalities [1, 9–15].
	
+ D
-
-
=
>
2
2
2
11
22
12
21
1
1
2
S
S
K
S
S
	
(5.63)
and
	
11 22
21 22
1
S S
S S
D =
-
< 	
(5.64)
Usually many of microwave transistors, such as MESFET, MOSFET, 
or HEMT, are potentially unstable over a certain frequency band. In such 
cases it is necessary to know the signal source and the load reflection coef-
ficients that correspond to the unstable operation of the device. If the magni-
tude of GIN is set to one, a boundary between the stable and unstable regions 
on the plane of load reflection coefficient GL may be determined. As it can be 
proved, equation G
=1
IN
 represents a circle on the load reflection coefficient 
plane. Such circle is called the stability circle. The center and the radius of the 
stability circle on the load reflection coefficient plane GL are [1, 9–15].
	
(
)
22
11
2
2
22
*
*
center:      CL
S
S
S
- D
=
- D
	
(5.65)
	
=
- D
12 21
L
2
2
22
radius:      
S S
r
S
	
(5.66)
Similarly, solving equation G
=1
OUT
 for all possible values of GS yields 
the stability circle on the signal source reflection coefficient plane GS . The 
center and the radius of the stability circle on the signal source reflection coef-
ficient plane are [1, 9–15]
	
(
)
11
22
2
2
11
*
*
center:      CS
S
S
S
- D
=
- D
	
(5.67)

106 
Microwave Network Design Using the Scattering Matrix 
	
=
- D
12 21
2
2
11
radius:      S
S S
r
S
	
(5.68)
In (5.65) through (5.68) 
11 22
12 21
S S
S S
D =
-
.
The stability circles may be plotted directly on the Smith chart, as 
shown in Figure 5.9. They delimit the load or the signal source reflection 
coefficient plane into the stable and unstable regions.
To determine which area of the chart represents the stable region, it 
is necessary to perform some considerations. In investigations to follow, we 
will consider the stability circles on the load reflection coefficient plane GL 
and discuss two different cases of the stability regions corresponding to these 
circles.
As it comes from the principles of the Smith chart construction, its 
center corresponds to the reflection coefficient equal zero. We assume now 
that GL = 0 (the matched load corresponds to a point located at the center of 
the Smith chart), then according to (5.59) GIN = S11 and if |S11| < 1, then also 
1
IN
G
< . According to the stability conditions of a linear two-port network 
this means that the center of the Smith chart must belong to the stability 
Stable
region
Stable
region
Stable
region
Stable
region
(b)
(a)
(d)
(b)
Figure 5.9  Stability circle of an active two-port plotted on the plane of complex load re-
flection coefficient GL of the Smith chart. (a) and (b) Stability circles and the 
stable regions of GL for two-ports with |S11| < 1. (c) and (d) Stability circles and 
the stable regions of GL for two-ports with |S11| > 1.

	
Signal Analysis of Multiport Networks	
107
region on the load reflection coefficient plane. In consequence, this means 
in this case, that if the stability circle encloses the origin of the Smith chart 
then the area inside the stability circle represents the stability region for the 
load reflection coefficient GL. If the origin of the Smith chart lies outside the 
stability circles, then this means that the whole area of the Smith chart out-
side the load stability circle represents the stable region for the load reflection 
coefficient GL. These two cases are illustrated in Figure 5.9(a) and (b).
If |S11| > 1 then for GL = 0 also G
>1
IN
, which means that the Smith 
chart origin belongs to the unstable region on the load reflection coefficient 
plane GL. This time if the stability circle does not enclose the Smith chart 
origin then only the area inside the stability circle represents the stable region 
for the load reflection coefficient GL. If the stability circle encloses the Smith 
chart center then the whole area of the Smith chart outside the stability circle 
corresponds to the stable region for the load reflection coefficient GL. Figure 
5.9(c) and (d) illustrate two cases of stability circle locations for 
>
11
1
S
.
Similar investigations on the stability circles and stability regions could 
be performed for the signal source port reflection coefficient GS.
If a two-port device is conditionally stable, but we intend to get its 
“working” stability, chosen values of both reflection coefficients GS and GL 
must correspond to points located inside stable regions on the GS and GL 
planes.
Graphical interpretation of the unconditional stability of a two-port 
network means that the stability circles must be located totally outside or 
totally inside the Smith chart. This graphical interpretation of a two-port 
network unconditional stability translated into mathematical form is
	
-
>
<
11
1    for    
1
L
L
C
r
S
	
(5.69)
or
	
-
>
<
22
1    for    
1
S
S
C
r
S
	
(5.70)
These two inequalities translate into the necessary and sufficient con-
ditions for unconditional stability of a two-port network given by relations 
(5.63) and (5.64).
Examples of practical application of this theory can be found in very 
rich literature devoted mainly to microwave transistor amplifier design, for 
example in [1, 8–15]. Stability considerations of active two-ports are very 
characteristic and fundamental for transistor amplifier design procedures.

108 
Microwave Network Design Using the Scattering Matrix 
5.3.5  Maximum Power Gain
Only in the case when an active two-port is unconditionally stable, it is pos-
sible to achieve maximum power gain in the network by conjugately match-
ing the input and the output port of the active two-port network.
The conditions for simultaneous match of a two-port network are  
[1, 9–15]
	
12 21
11
22
*
1
L
IN
S
L
S S
S
S
G
G
=
+
= G
-
G
	
(5.71)
and
	
12 21
22
11
*
1
S
OUT
L
S
S S
S
S
G
G
=
+
= G
-
G
	
(5.72)
It may be proven that the only useful solution of the above set of equa-
tions for GS and GL is
	
æ
ö
G
=
-
-
ç
÷
ç
÷
è
ø
2
1
1
1
2
1
1
1
*
1
2
2
Sm
C
B
B
C
C
C
	
(5.73)
	
æ
ö
G
=
-
-
ç
÷
ç
÷
è
ø
2
2
2
2
2
2
2
2
*
1
2
2
Lm
C
B
B
C
C
C
	
(5.74)
where
	
2
1
11
22
C
S
S
=
- D
	
(5.75)
	
2
2
2
1
22
11
1
B
S
S
= -
+
- D 	
(5.76)
	
2
2
22
11
C
S
S
=
- D
	
(5.77)
	
2
2
2
2
11
22
1
B
S
S
= -
+
- D 	
(5.78)

	
Signal Analysis of Multiport Networks	
109
Under the conjugate match at the input and output ports of the two-
port network, the power gain, the available power gain and the transducer 
power gain all reach the same maximum value and this value is called the 
maximum possible gain GMAX of a two-port network. It is given as
	
(
)
=
±
-
21
2
12
1
MAX
S
G
K
K
S
	
(5.79)
where K > 1 and the minus sign is used before the radical if the quantity B1 
given by (5.76) is positive. If B1 is negative the plus sign should be used in 
(5.79) to calculate GMAX. Maximum possible power gain GMAX exists only for 
unconditionally stable two-port active devices.
5.3.6  Constant Power Gain Circles
When parameter K < 1, the two-port network is potentially unstable, and 
simultaneous conjugate match at the input and output ports can not be 
achieved. GMAX for such network does not exist. To design amplifiers with 
potentially unstable active devices one has to investigate the power gain or the 
available power gain as the working parameters of the network.
Very useful information in determining proper and acceptable values 
of the load port reflection coefficient provide constant power gain circles  
[1, 9–15].
It can be shown that (5.56) expressing power gain G as a function of the 
load port reflection coefficient GL represents, for a given and constant value of 
G, a circle, called constant power gain circle. This circle is a locus of all values 
of GL for which the power gain of the two-port network is constant and equal 
to a particular value.
On the complex load port reflection coefficient plane (in particular, on 
the Smith chart) the center CP and the radius rp of the constant power gain 
circles are given by the equations [1, 9–15]
	
(
)
(
)
- D
=
+
- D
22
11
2
2
22
*
*
center:     
1
p
g S
S
C
g S
	
(5.80)
	
(
)
(
)
-
+
=
+
- D
1/2
2
2
12 21
12 21
2
2
22
1
2
radius:    
1
p
K S S
g
S S
g
r
g S
	
(5.81)

110 
Microwave Network Design Using the Scattering Matrix 
where 
2
21
/
g
G S
=
 is a normalized value of the two-port network power gain. 
It is a parameter of the family of circles given by (5.80) and (5.81).
5.3.7  Constant Available Power Gain Circles
The other useful information in determining proper and acceptable values, 
this time, of the signal source port reflection coefficient driving a potentially 
unstable two-port active device, are circles of the constant available power 
gain. As it can be proved, (5.58) expressing the available power gain as func-
tion of  GS represents, for a given and constant value of GA, a circle, called 
constant available power gain circle. This circle is a locus of all values of GS 
for which the available power gain GA of a two-port network is constant and 
equal to a particular value.
The center and the radius of the constant available power gain of a two-
port network are given by the following equations  [1, 9–15]
	
(
)
(
)
- D
=
+
- D
11
22
2
2
11
*
*
center:     
1
A
A
A
g
S
S
C
g
S
	
(5.82)
	
(
)
(
)
-
+
=
+
- D
1/2
2
2
12 21
12 21
2
2
11
2
2
radius:        
1
A
A
A
A
K g
S S
g
S S
r
g
S
	
(5.83)
where 
=
2
21
/
A
A
g
G
S
 is a normalized value of the two-port network available 
power gain. It is a parameter of the family of circles given by (5.82) and (5.83). 
In (3.83) K is the stability factor given by (5.63) and 
11 22
12 21
S S
S S
D =
-
.
Examples of practical application of constant power gain and constant 
available power gain circles in design procedures of transistor amplifiers can 
be found in very rich literature of this subject, for example in [8, 9–15].
5.3.8  Insertion Loss
Insertion loss is a network function used in design and characterization of 
microwave filters, attenuators, switches, and phase shifters. It is defined as
	
=
0
L
L
P
IL
P
	
(5.84)

	
Signal Analysis of Multiport Networks	
111
where PL0 is the power delivered to the load connected directly to the signal 
source port and PL is the power delivered to the load with the network in-
serted between the signal source and the load. In Figure 5.10 we illustrate the 
networks and quantities used in definition of the insertion loss.
Because signal power delivered to the load connected directly to the 
signal source port is
	
(
)
- G
=
- G G
2
2
0
2
1
1
S
L
L
S
L
b
P
	
(5.85)
and the signal power dissipated in the load of the two-port network is
	
(
)
(
)
- G
=
=
- G
-
G -
G + DG G
2
2
2
21
2
2
2
11
22
1
1
1
S
L
L
L
L
S
L
S
L
b
S
P
a
S
S
	
(5.86)
the insertion loss of the two-port network equals
	
-
G -
G + DG G
=
- G G
2
11
22
2
2
21
1
IL
1
S
L
S
L
S
L
S
S
S
	
(5.87)
where 
11 22
12 21
S S
S S
D =
-
.
Signal
source
Signal
source
Two-port
S
Load
Load
ΓS
ΓL
ΓS
ΓL
(b)
(a)
Figure 5.10  Network illustration of the insertion loss definition and computation. (a) The 
load directly connected to the signal source port. (b) A two-port network in-
serted between the signal source and the load.

112 
Microwave Network Design Using the Scattering Matrix 
Deriving these relations we assume that reference impedances of all 
ports in the network are the same and real.
5.3.9  Voltage Gain
At radio frequencies voltage gain is used for characterization of amplifiers and 
filters. Voltage gain is defined as
	
=
V
L
IN
v
G
v
	
(5.88)
where vL is the signal voltage at the load and vIN is the voltage at the input 
port of the network.
In Figure 5.11 we present quantities applied in the definition of voltage 
gain and voltage transfer gain.
Using relation for port voltage expressed in terms of the ingoing and 
outgoing pseudowaves given by (4.72) and assuming the same value of  the 
reference impedances of all network ports, we have
	
+
+ G
=
=
+
+ G
V
1
1
1
1
1
L
L
L
L
IN
a
b
a
G
a
b
a
	
(5.89)
Because
	
=
-
G
21
1
22
a
1
L
L
a
S
S
	
(5.90)
Two-port
ZL
ZS
ES ∼
v1
i1
b1
a1
vL
aL
bL
Figure 5.11  Network illustration of voltage gain and voltage transfer gain definition and 
computation.

	
Signal Analysis of Multiport Networks	
113
finally we get
	
+ G
=
-
G
+ G
21
22
1
1
1
L
V
L
IN
S
G
S
	
(5.91)
In (5.91)
	
G
G
=
+
-
G
12 21
11
22
1
L
IN
L
S S
S
S
	
(5.92)
and
	
-
G
=
+
L
R
L
L
R
Z
Z
Z
Z 	
(5.93)
In derivation of (5.91) it is assumed that the reference impedances of all 
ports of the network are the same and real.
It is very important to notice here that 
{
}
arg
V
G
φ =
 is the phase charac-
teristic of the analyzed network.
5.3.10  Voltage Transfer Gain
Voltage transfer gain is defined as
	
=
L
VT
S
v
G
E 	
(5.94)
where vL is the voltage at the load and ES is the signal source voltage.
Because 
=
+
S
1
1
S
E
v
Z i , using pseudowaves, (4.72) and (4.73), we have
	
+
=
+
+
-
+ G
=
+ G
+
- G
L
L
1
1
1
1
L
1
(
)
(a
)
(
)
(1
)
(1
)
(1
)
R
VT
R
S
R
L
R
IN
S
IN
Z
a
b
G
Z
b
Z
a
b
a
Z
a Z
Z
	
(5.95)

114 
Microwave Network Design Using the Scattering Matrix 
and finally
	
+ G
=
-
G
+ G
+
- G
21
22
L
(1
)
1
(1
)
(1
)
R
L
VT
R
IN
S
IN
S
Z
G
S
Z
Z
	
(5.96)
In (5.96) GIN and GL are given by (5.92) and (5.93), respectively. It is 
assumed that the reference impedances of all ports of the network are the 
same and equal ZR.
In power wave domain voltage transfer gain is given as
	
+
G
=
-
G
+
G
+
- G
21
22
L
*
1
*
(1
)
R
R
L
VT
R
R
IN
S
IN
S
Z
Z
G
S
Z
Z
Z
	
(5.97)
where GIN is given by (5.92) and
	
-
G
=
+
*
L
R
L
L
R
Z
Z
Z
Z 	
(5.98)
In (5.96) it is assumed that the reference impedances of  all ports of the 
network have the same real values ZR. 
The argument of GVT is the transmission phase characteristic of the 
analyzed network, 
{
}
arg
T
VT
G
φ
=
.
5.4  Multiport Network Analysis
In the approach to microwave network signal analysis presented in this para-
graph we assume that a network may be considered as a multiport with con-
nected to it one-port elements representing signal sources and loads.
A general N-port network illustrated in Figure 5.12 can be represented 
by its N ´ N scattering matrix, which relates amplitudes of ingoing and out-
going traveling waves
	
=
b
Sa	
(5.99)
The incident wave vector can be expressed as [2, 4]
	
S
= G +
a
b
b 	
(5.100)
In (5.100) bS is the vector of signal waves generated by signal sources 
connected to the N port, and G is the N ´ N diagonal matrix of reflection 
coefficients seen at each signal source port or load port.

	
Signal Analysis of Multiport Networks	
115
Inserting (5.99) into (5.100) yields the equation for the vector of out-
going waves 
	
[
]
-
=
- G
1
S
b
I
S
Sb 	
(5.101)
The real power dissipated in the load of the ith port of the multiport is
	
ζ
é
ù
=
- G
-
G
ë
û
2
2
1
2
tan 
Li
i
i
i
i
P
b
Im
	
(5.102)
where zi is the phase of the reference impedance ZRi.
Because 
	
+
=
2
T
i
i
i
b
δ
δ
bb
	
(5.103)
where δ i is a vector with ith element equal 1 and the rest of elements equal 0
	
é ù
ê ú
ê ú
ê ú
ê ú
= ê ú
ê ú
ê ú
ê ú
ê ú
ë û
0
0
:
1
:
0
0
i
i
δ
	
(5.104)
a1
b1
a2
an
ak+1
ak−1
ak
b2
bn
bk+1
bk−1
bk
Γ1
Γ2
Γk−1
Γn
Γk
Γk+1
Multiport
S
Figure 5.12  Multiport network with signal sources and loads connected to its ports.

116 
Microwave Network Design Using the Scattering Matrix 
then using (5.104), we have
	
[
]
[
]
-
- +
+
+
=
- G
- G
2
1
1
T
i
i
i
b
δ
δ
S
S
I
S
Sb b S
I
S
	
(5.105)
In the above relations the + indicates a Hermitian conjugate.
The available power of the signal source connected to the jth port of 
the multiport is
	
{ }
ζ
ζ
= é
ù
- G
-
G
ë
û
2
2
2
cos
1
2
tan
S j
SA
j
j
j
j
b
P
Im
	
(5.106)
where
	
2
*
T
S j
S j S j
j
S
S
j
b
b
b
δ
δ
+
=
=
b b
	
(5.107)
The transducer power gain of a multiport circuit between jth port as the 
input and the ith port as the output is
	
{ }
δ
δ
ς
ζ
ζ
-
+
+
- +
+
- G
- G
=
δ
δ
é
ù
é
ù
´
- G
-
G
- G
-
G
ë
û ë
û
1
1
2
2
2
i
j
]
]
cos
1
2
tan
1
2
tan
Ti
S
S
i
T
Tj
S
j
S
i
j
G
Im
Im
[I
S
Sb b
S [I
S
b b
{ }
	
(5.108)
This is a general relation. It is assumed here that the reference imped-
ance ZRi and ZRj are complex.
If we assume that the reference impedances are real, (5.108) simplifies 
to
[
]
[
]
-
- +
+
+
+
- G
- G
d é
ù é
ù
=
- G
- G
ë
û
ë
û
1
1
2
2
1
1 |
|
Ti
i
T
i
j
Tj
S
S
j
G
δ
δ
δ
S
S
I
S
Sb b S
I
S
b b
	
(5.109)
Equations (5.108) and (5.109) represent transducer power gain be-
tween the jth port as the input port and the ith port as the output port of a 
general multiport network.

	
Signal Analysis of Multiport Networks	
117
In a case of a two-port network presented in Figure 5.13, from (5.101) 
we have
	
1 21
2
11 1
22
2
12 21 1
2
(1
)(1
)
Sb S
b
S
S
S S
=
-
G
-
G
-
G G 	
(5.110)
	
2
2
2
1
21
2
2
11 1
22
2
12 21 1
2
(1
)(1
)
Sb
S
b
S
S
S S
=
-
G
-
G
-
G G
	
(5.111)
Because real power dissipated in the load
	
{
}
ζ
é
ù
=
- G
-
G
ë
û
2
2
2
2
2
2
1
2
tan 
L
P
b
Im
	
(5.112)
and the available power of the signal source 
	
{
}
ζ
ζ
= é
ù
- G
-
G
ë
û
2
1
2
2
1
1
1
1 cos
1
2
tan
S
SA
b
P
Im
	
(5.113)
the transducer power gain
	
{
}
{
}
ζ
ζ
ς
=
ê
ú ê
ú
- G
-
G
- G
-
G
ë
û ë
û
=
-
G
-
G
-
G G
2
2
2
2
21
1
1
1
2
2
2
2
2
11 1
22
2
12 21 1
2
1
2
tan
1
2
tan
cos
(1
)(1
)
L
T
SA
P
G
P
S
Im
Im
S
S
S S
	
(5.114)
Γ1
Γ2
Two-port
Figure 5.13  Multiport network reduced to two-port network.

118 
Microwave Network Design Using the Scattering Matrix 
This equation is a general one. It corresponds to a two-port network 
with complex reference impedances of its ports.
When the reference impedances of the input and output port are real, 
we have
	
é
ù é
ù
- G
- G
ë
û ë
û
=
-
G
-
G
-
G G
2
2
2
21
1
2
2
11 1
22
2
12 21 1
2
1
1
(1
)(1
)
T
S
G
S
S
S S
	
(5.115)
This equation is similar to (5.52) and is very often presented in litera-
ture devoted to microwave transistor amplifier design [1, 9–15].
The second important working parameter is the power gain. It is de-
fined as
	
Lj
INi
P
G
P
=
	
(5.116)
where PLj is the real power dissipated in the load of the jth port and PINi is the 
real input power at the ith port of a multiport.
The load power is described by (5.110) through(5.112) whereas the 
input power at the ith port is
	
{
}
ζ
ê
ú
=
- G
-
G
ë
û
2
2
1
2
tan
INi
i
INi
INi
i
P
a
Im
	
(5.117)
where GINi is the input port (ith port) reflection coefficient and ςi is the phase 
of ZRi.
Using (5.99) and (5.100), we calculate 
	
-
= G +
= G
- G
+
1
[
]
S
S
S
a
b
b
I
S
Sb
b 	
(5.118)
	
+
-
+
-
+
=
=
G
- G
+
G
- G
+
d
2
1
1
[ [
]
]
[ [
]
]
T
i
i
i
Ti
S
S
i
a
δ
δ
δ
aa
I
S
S
I b b
I
S
S
I
	
(5.119)

	
Signal Analysis of Multiport Networks	
119
and finally
	
{
}
δ
δ
δ
δ
ζ
ζ
-
- +
+
+
+
+
-
-
- G
- G
=
é
ù
é
ù
G
- G
=
G
- G
+
ë
û
ë
û
- G
-
G
´
- G
-
G
1
1
1
1
2
2
[
]
[
]
[
]
[
]
1
2
tan
1
2
tan
Ti
S
i
S
Ti
S
s
i
j
j
INi
INi
G
Im
Im
I
S
Sb b S
I
S
b b
I
S
S
I
I
S
S
I
{
}
	
(5.120)
where I is a unit matrix and
	
[
]
1
1
[ [
]
]
T
T
i
i
i
INi
T
T
i
i
i
b
a
δ
δ
δ
δ
-
-
- G
G
=
=
=
G
- G
+
I
S
Sc
b
a
I
S
S
I c	
(5.121)
In a case with real reference impedance of the ports of the multiport, 
(5.120) simplifies to
δ
δ
δ
δ
-
+
+
- +
+
+
-
-
- G
- G
- G
=
- G
é
ù
é
ù
G
- G
+
G
- G
+
ë
û
ë
û
2
1
1
2
1
1
1
[
]
[
]
1
[
]
[
]
T
j
i
S
i
S
T
INi
i
i
G
I
S
Sb b S
I
S
cc
I
S
S
I
I
S
S
I
	
(5.122)
For a multiport reduced to a two-port network, from (5.120) we have
{
}
{
}
ζ
ζ
é
ù
- G
-
G
ë
û
=
-
G
-
- DG
-
-
G
G
2
2
21
2
2
2
2
2
22
2
11
2
22
2
IN1
1
1
2
tan
1
21
tan
S
Im
G
S
S
S
Im
	
(5.123)
where
	
11
2
1
22
2
1
IN
S
S
- DG
G
=
-
G 	
(5.124)
is the input port reflection coefficient (D = S11S22 - S12S21).

120 
Microwave Network Design Using the Scattering Matrix 
And again with real reference impedance (Im{ZR} = 0, tanζ = 0), 
(5.123) simplifies to
	
é
ù
- G
ë
û
=
-
G
-
- DG
2
2
21
2
2
2
22
2
11
2
1
1
S
G
S
S
	
(5.125)
5.5  Multielement Multiport Network Analysis Using Connection 
Scattering Matrix Approach
Application of the so-called connection scattering matrix is another approach 
that can be used to analyze networks composed of many multiports described 
by their scattering matrices. Figure 5.14 presents such a network.
The kth element of the network is described by the equation
	
( )
( ) ( )
k
k
k
=
b
S
a
	
(5.126)
where S(k) is its scattering matrix and a(k) and b(k) are vectors, respectively, of 
ingoing and outgoing waves at its ports.
An independent signal source is described by the equation
	
S
b
Sa
b
=
+
	
(5.127)
In matrix notation, a set of linear equations that relate amplitudes of 
traveling waves at ports of all network elements has the form [2, 4, 5]
	
S
=
+
b
Sa
b 	
(5.128)
S
(1)
S
(2)
S
(3)
S
( )i
S
(  )k
S
( )
m
Figure 5.14  Microwave network containing interconnected multiports.

	
Signal Analysis of Multiport Networks	
121
where
	
é
ù
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
=
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
(1)
(1)
(1)
(2)
(2)
(2)
( )
( )
( )
( )
( )
( )
:
:
:
:
:
:
S
S
S
k
k
k
S
m
m
m
S
a
b
b
a
b
b
a
b
b
a
b
b
a
b
b
	
(5.129)
and
	
(1)
(2)
( )
( )
..
..
.
.
.
:
.
:
:
:
.
:
:
:
....
...
..
k
m
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
S
0
0
0
0
S
0
S
0
S
0
0
0
S
	
(5.130)
is the block diagonal matrix in which S(k) is the scattering matrix of the kth 
element, a(k) and b(k) are vectors of incident and reflected waves at its ports, 
and bS
(k) is the vector of impressed waves of signal sources.
Taking into account connections between the elements of the network, 
it is necessary to introduce constraints on vectors a and b in the form of ma-
trix equation
	
=
b
Ka	
(5.131)
where K is the connection matrix of the network.
Substituting (5.131) into (5.128), we obtain
	
S
=
Wa
b 	
(5.132)
where the coefficient matrix in (5.132)
	
=
-
W
K
S	
(5.133)

122 
Microwave Network Design Using the Scattering Matrix 
is called the connection scattering matrix of the network. The right-hand 
side vector bS is the vector of the impressed waves of the independent signal 
sources in the network. The solution of the matrix equation (5.132) is the 
vector of ingoing waves at all ports of the analyzed network
	
-
=
S
1
a
W
b 	
(5.134)
Substituting (5.134) into (5.131) we can compute a vector of outgoing 
waves in all ports of the network as
	
-
=
1
b
K W
c	
(5.135)
The connection scattering matrix fully describes the network because scat-
tering matrix parameters of all network elements are given in the matrix S while 
information on the network topology is given in the connection matrix K.
It is assumed now that all port connectors are reflectionless and that the 
reference impedances at adjoining ports are identical. Such connection of two 
ports is a nonreflecting connection, which means that the outgoing and ingo-
ing traveling waves at ports i and j connected together satisfy the relation
	
i
j
a
b
=
	
(5.136)
and
	
i
j
b
a
=
	
(5.137)
The connection matrix of such pair of ports is
	
0
1
1
0
é
ù
= ê
ú
ë
û
K
	
(5.138)
The elements of the connection matrix K of the whole network are 
zeros and ones. Only the elements κij and κji corresponding to port pairs of 
the connected ports are ones.
Using vectors a and b given by (5.134) and (5.135), we are able to de-
termine any working parameter of the analyzed network.

	
Signal Analysis of Multiport Networks	
123
The real power dissipated in the load with port number i is
	
ζ
é
ù
=
-
-
ë
û
2
2
1
2
tan 
Li
i
ii
ii
i
P
a
S
ImS
	
(5.139)
Because 
	
+
=
2
T
i
i
i
a
δ
δ
a a
	
(5.140)
where δi is a vector with the ith element equal to 1 and the rest of the ele-
ments equal to 0, than using (5.134), we have 
	
-
+
- +
=
2
1
1
T
i
i
i
b
δ
δ
S
S
W
b b W
	
(5.141)
The available power of the signal source with port number j is
	
ζ
ζ
= é
ù
-
-
ë
û
2
2
2
cos
1
2
{
}tan
S j
SA
j
jj
jj
j
b
P
S
Im S
	
(5.142)
where
	
2
*
T
S j
S j S j
j
S
j
S
b
b
b
δ
δ
+
=
=
b b
	
(5.143)
The transducer power gain of a multiport circuit between jth port of 
the signal source and the ith port of the load is
	
{
}
{ }
ζ
ς
ζ
-
+
- +
+
δ
δ é
ù
=
=
-
-
ë
û
δ
δ
é
ù
´
-
-
ë
û
1
1
2
2
2
1
2
tan
cos
1
2
tan
T
L
i
S
S
i
T
ii
ii
i
T
SA
j
S
j
S
j
jj
jj
j
P
G
S
Im S
P
S
Im S
W
b b
W
b b
	
(5.144)
In (5.139), (5.142), and (5.144) ςi and ςj are phase angles of, respec-
tively, ZRi and  ZRj.

124 
Microwave Network Design Using the Scattering Matrix 
For real characteristic impedances (or real reference impedances) of sig-
nal source port and load port, (5.144) simplifies to
	
δ
δ
δ
δ
-
+
- +
+
é
ù é
ù
=
-
-
ë
û ë
û
1
1
2
2
1
1
Ti
S
S
i
T
ii
ii
Tj
S
j
S
G
S
S
W
b b
W
b b
	
(5.145)
In a similar way we calculate power gain of the network.
The load power is described by (5.139) whereas the input power at the 
ith port is
	
{
}
ζ
ê
ú
=
- G
-
G
ë
û
2
2
1
2
tan
INi
i
INi
INi
i
P
a
Im
	
(5.146)
where GINi is the input port (ith port) reflection coefficient given by
	
δ
δ
δ
δ
-
-
G
G
=
=
=
i
S
i
i
INi
i
i
i
S
b
a
1
1
W
b
b
a
W
b
	
(5.147)
Using (5.140) we calculate
	
2
1
T
T
i
i
i
i
S
S
i
a
δ
δ
δ
δ
+
-
+
- +
=
=
1
aa
W
b b W
	
(5.148)
and
         
{
}
ζ
δ
δ
δ
δ
ζ
-
+
- +
-
+
- +
-
-
=
- G
-
G
2
1
1
1
1
2
1
2
tan
1
2
tan
T
jj
jj
j
j
S
j
S
Ti
S
s
i
INi
INi
S
Im S
G
Im
W
b b W
W
b b W
{
}
	
(5.149)
In a case with real reference impedances of the input port and of the 
load port, (5.149) simplifies to
	
2
1
1
1
1
2
1
1
T
jj
j
S
S
j
Ti
S
s
i
INi
S
G
δ
δ
δ
δ
-
+
- +
-
+
- +
-
=
- G
W
b b W
W
b b W
	
(5.150)

	
Signal Analysis of Multiport Networks	
125
References
  [1]	 Pozar, D. M., Microwave Engineering, New York: Addison-Wesley Publishing Co., 
1990.
  [2]	 Dobrowolski, J. A., Introduction to Computer Methods for Microwave Circuit Analysis 
and Design, Norwood, MA: Artech House, 1991.
  [3]	 Engen, G. E., Microwave Circuit Theory and Foundations of Microwave Metrology, Lon-
don: Peter Peregrinus Ltd., 1992.
  [4]	 Dobrowolski, J. A., Computer Aided Analysis, Modeling and Design of Microwave Net-
works: The Wave Approach, Norwood, MA: Artech House, 1996.
  [5]	 Monaco, V. A., and P. Tiberio, “Computer-Aided Analysis of Microwave Circuits,” 
IEEE Trans. Microwave Theory Tech., Vol. MTT-22, March 1974, pp. 249–63.
  [6]	 Bodway, G. E.,“Two-Port Power Flow Analysis Using Generalized Scattering Param-
eters,” Microwave Journal, Vol. 10, May 1967, pp. 61–69.
  [7]	 S-Parameter Design, Hewlett-Packard Application Note 154, April 1972.
  [8]	 Collin, R. E., Foundations for Microwave Engineering, New York: McGraw-Hill, Inc., 
1992.
  [9]	 Vendelin, G. D., Design of Amplifiers and Oscillators by the S-Parameter Method, New 
York: J. Wiley and Sons, 1982.
[10]	 Gonzales, G., Microwave Transistor Amplifiers, Analysis and Design, Englewood Cliffs, 
NJ: Prentice-Hall, 1984.
[11]	 Gentile, C., Microwave Amplifiers and Oscillators, New York: McGraw-Hill, 1987.
[12]	 Bahl, I., and P. Bhartia, Microwave Solid State Circuit Design, New York: J. Wiley and 
Sons, 1988.
[13]	 Liao, S. Y., Microwave Circuit Analysis and Amplifier Design, Englewood Cliffs, NJ: 
Prentice-Hall, 1987.
[14]	 Carson, R. S., High-Frequency Amplifiers, New York: J. Wiley and Sons, 1982.
[15]	 Ha, T. T., Solid State Amplifier Design, New York: J. Wiley and Sons, 1981.


127
6
Mode Wave Variables and Mixed  
Mode Scattering Matrix of  
Differential Networks
Scattering parameters and wave variables considered in previous chapters are 
standard single-ended parameters that are referenced to single-ended systems 
that have all their ports referenced to ground. Many present-day circuits 
and systems are designed and built as differential ones [1, 2]. In this chap-
ter we present the wave and scattering matrix approach applicable to micro-
wave differential network analysis and design. Based on differential mode 
and common mode definitions, mode-specific wave variables and mixed 
mode scattering parameters are presented here. Mixed-mode transformation 
is a very useful technique allowing separation of differential and common 
modes. In general, a differential network responds to differential-mode and  
common-mode input signals. Therefore, a complete characterization of a 
differential network requires knowledge of differential mode and common 
mode responses, but also differential to common and common to differential 
conversion responses. Mixed-mode scattering matrix fulfils these conditions. 
Standard scattering matrix transformation to mixed-mode scattering matrix 
is also presented in this chapter. Thanks to this transformation we are able 
to derive differential mode and common mode parameters of a network on 

128 
Microwave Network Design Using the Scattering Matrix
the basis of standard scattering parameters. A general mixed-mode scattering 
matrix for multiport networks with single-ended, as well as with differential 
input and output ports is also discussed. A general mixed-mode scattering 
matrix is best suited for modeling differentials amplifiers that are classical ex-
amples of networks with differential input and common mode output. A few 
examples present practical application of the theory. The chapter ends with 
an introduction to mixed-mode cascade matrix, the matrix with properties 
similar to the standard cascade matrix. A mixed-mode cascade matrix should 
be used for modeling and analysis of differential interconnects considered as 
the cascaded connection of many individual differential networks. This ap-
proach is very useful in studying and understanding parasitic effects of the 
interconnects.
6.1  Differential and Common Mode Definitions
The simplest and very common differential network is a four port with one 
pair of ports at the input and one pair at the output. Two single-ended ports 
1 and 2 are paired as a single differential port number 1 and two single-ended 
ports 3 and 4 are also paired as a single differential port number 2. In such a 
network, differential signals are referenced between the hot terminals of the 
pairs of ports. Figure 6.1 presents a four-port network that can be analyzed as 
a system with four separate single-ended ports or as a system with two mixed-
mode differential ports.
In this discussion we will call the left-side port the “input port” and the 
right-side port the “output port.”
Single-ended
four-port
or
mixed mode
two-port
b1
a1
b2
a2
v 2
b3
bd2
a3
ad2
b4
bc2
a4
ac2
bd1
ad1
bc1
ac1
v 1
i 1
i 3
v 4
v 3
Figure 6.1  Differential two-port network with waves at its ports.

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
129
The differential voltage and current applied to the differential input 
port is (port 1)
	
1
1
2
dv
v
v
º
-
	
(6.1)
This definition of differential voltage establishes signal that is not ref-
erenced to ground.
Because in a differential network it is expected that the magnitude of 
a current entering the positive input terminal is equal to the magnitude of a 
current leaving the negative input terminal, therefore the differential mode 
current is defined as one-half of the difference between currents entering 
nodes 1 and 2
	
1
2
1
2
d
i
i
i
-
º
	
(6.2)
We can write analogous equations to the differential output port (port 2)
	
2
3
4
dv
v
v
º
-
	
(6.3)
	
3
4
2
2
d
i
i
i
-
º
	
(6.4)
The common-mode voltage in a differential circuit is usually defined as 
the average voltage on two nodes of a port. Hence, the common-mode volt-
age at the input port is 
	
1
2
1
2
c
v
v
v
+
º
	
(6.5)
The common-mode current at a port is defined as the sum of currents 
entering two nodes of a port. It is the total current flowing into the port. The 
common-mode current at the input port (port 1) is
	
1
1
2
ci
i
i
º
+
	
(6.6)
It is obvious that the return current for the common-mode signal flows 
through the ground terminal.
Analogous equations can be written for the common-mode signal at the 
output port (port 2)
	
3
4
2
2
c
v
v
v
+
º
	
(6.7)

130 
Microwave Network Design Using the Scattering Matrix
	
2
3
4
ci
i
i
º
+
	
(6.8)
6.2  Mode-Specific Waves and Impedances
Based on the above definitions of differential-mode and common-mode volt-
ages and currents, it is possible to define wave variables— first, differential 
mode waves and common-mode waves, and next, mixed-mode scattering pa-
rameters of microwave differential network.
Before doing this we introduce a practical simplification which assumes 
that each pair of ports in the network is a symmetric coupled pair of trans-
mission lines (in the case of a microstrip circuit it means that two coupled 
microstrip lines creating a differential port are of the same width). This sim-
plification is not limiting, because the length of such lines as reference lines 
of differential circuit ports may be made arbitrarily short.
In symmetric coupled transmission lines propagate two modes, the 
even mode and the odd mode. At each terminal of symmetric coupled lines 
voltages and currents of both modes are referenced to ground. The theory 
of symmetric coupled lines is given in [3, 4]. The voltage and the current 
at a point z along each transmission line of the symmetric coupled lines are 
superpositions of voltage waves and current waves of both modes, even and 
odd, propagating in both directions in both lines
	
( )
( )
( )
( )
1
0
0
0
0
( )
( )
( )
( )
( )
( )
( )
( )
( )
e
e
o
o
z
z
z
z
e
e
o
o
e
e
o
o
v z
V
e
V
e
V
e
V
e
v
z
v
z
v
z
v
z
γ
γ
γ
γ
+
-
-
+
-
-
+
-
+
-
=
+
+
+
=
+
+
+
	
(6.9)
	
( )
( )
( )
( )
1
0
0
0
0
( )
( )
( )
( )
0
0
0
0
0
0
0
0
( )
( )
( )
( )
( )
( )
( )
( )
( )
e
e
o
o
e
e
o
o
z
z
z
z
e
e
o
o
z
z
z
z
e
e
o
o
e
e
o
o
e
e
o
o
i z
I
e
I
e
I
e
I
e
V
V
V
V
e
e
e
e
Z
Z
Z
Z
i
z
i
z
i
z
i
z
γ
γ
γ
γ
γ
γ
γ
γ
+
-
-
+
-
-
+
-
+
-
-
-
+
-
+
-
=
-
+
-
=
-
+
-
=
-
+
-
	
(6.10)
	
( )
( )
( )
( )
2
0
0
0
0
( )
( )
( )
( )
( )
( )
( )
( )
( )
e
e
o
o
z
z
z
z
e
e
o
o
e
e
o
o
v
z
V
e
V
e
V
e
V
e
v
z
v
z
v
z
v
z
γ
γ
γ
γ
+
-
-
+
-
-
+
-
+
-
=
+
-
-
=
+
-
-
	
(6.11)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
131
	
( )
( )
( )
( )
2
0
0
0
0
( )
( )
( )
( )
0
0
0
0
0
0
0
0
( )
( )
( )
( )
( )
( )
( )
( )
( )
e
e
o
o
e
e
o
o
z
z
z
z
e
e
o
o
z
z
z
z
e
e
o
o
e
e
o
o
e
e
o
o
i z
I
e
I
e
I
e
I
e
V
V
V
V
e
e
e
e
Z
Z
Z
Z
i
z
i
z
i
z
i
z
γ
γ
γ
γ
γ
γ
γ
γ
+
-
-
+
-
-
+
-
+
-
-
-
+
-
+
-
=
-
-
+
=
-
-
+
=
-
-
+
	
(6.12)
In (6.9) through (6.12), Z0e and ge are the characteristic impedance of 
one line and the propagation constant of the even mode waves, and Z0o and 
go are the characteristic impedance of one line and the propagation constant 
of the odd mode waves propagating in these lines.
Characteristic impedances of differential-mode and common-mode 
waves propagating in the discussed system of lines are defined as the ratio of 
complex amplitude of the voltage wave to complex amplitude of the current 
wave of appropriate mode propagating in +z direction of the system.
Using (6.1) through (6.6) and (6.9) through (6.12), the differential- 
and common-mode voltages and currents may be expressed as
	
(
)
(
)
( )
( )
( )
( )
0
0
( )
2
2
( )
( )
o
oz
z
z
d
o
o
o
o
v
z
V
e
V
e
v
z
v
z
γ
γ
+
-
-
+
-
=
+
=
+
	
(6.13)
	
( )
( )
( )
( )
0
0
0
0
( )
( )
0
( )
( )
( )
( )
( )
o
o
z
z
o
o
d
o
o
o
o
o
o
o
V
V
i
z
e
e
i
z
i
z
Z
Z
v
z
v
z
Z
γ
γ
+
-
-
+
-
+
-
=
-
=
-
-
=
	
(6.14)
	
( )
( )
( )
( )
0
0
( )
( )
( )
e
e
z
z
c
e
e
e
e
v z
V
e
V
e
v
z
v
z
γ
γ
+
-
-
+
-
=
+
=
+
	
(6.15)
	
(
)
( )
( )
0
0
0
0
( )
( )
( )
( )
0
( )
2
( )
( )
2
( )
( )
2
e
e
z
z
e
e
c
e
e
e
e
e
e
e
V
V
i z
e
e
Z
Z
v
z
v
z
i
z
i
z
Z
γ
γ
+
-
-
+
-
+
-
æ
ö
=
-
ç
÷
è
ø
-
=
-
=
	
(6.16)
In (6.9) through (6.16), index (+) is referenced to voltage and current 
waves propagating in +z direction of lines, while index (-) is referenced with 
voltage and current waves propagating in – z direction of lines.

132 
Microwave Network Design Using the Scattering Matrix
6.3  Mixed-Mode Scattering Parameters
Once the voltages, currents, and characteristic impedances have been defined 
for the differential mode and the common mode, the wave wariables cor-
responding to these two modes can be also introduced. These waves may 
be defined as power waves or as pseudowaves. In [5] D. E. Bockelmam and  
W. R. Eisenstadt have used the definition of power waves introduced in [6] 
by K. Kurokawa, while A. Ferrero nad M. Pirola [7] have applied the defini-
tion of pseudowaves introduced by R. B. Marks and D. F. Williams in [8]. 
All these definitions are explaned in detail in Chapter 4.
In the first case the differential mode power waves are given as [5]
	
{
}
( )
( )
( )
2
d
d
Rd
d
Rd
v
z
i
z Z
a
z
Re Z
+
º
	
(6.17)
	
{
}
*
( )
( )
( )
2
d
d
Rd
d
Rd
v
z
i
z Z
b
z
Re Z
-
º
	
(6.18)
and similarly, the common-mode power waves 
	
{
}
( )
( )
( )
2
c
c
Rc
c
Rc
v z
i z Z
a z
Re Z
+
º
	
(6.19)
	
{
}
*
( )
( )
( )
2
c
c
Rc
c
Rc
v z
i z Z
b z
Re Z
-
º
	
(6.20)
In (6.17) through (6.20), ZRd  and ZRc are reference impedances of, re-
spectively, the differential mode power waves and the common-mode power 
waves.
In Figure 6.1, ad1, ad 2 are differential-mode incident waves at mixed mode 
ports 1 and 2, bd 1, bd 2 are differential-mode reflected waves at mixed-mode  
ports 1 and 2, while ac1, ac 2 are common-mode incident waves at mixed  
mode ports 1 and 2, and bc1 and bc2 are common-mode reflected waves at mixed 
ports 1 and 2.
If we assume that the reference impedances ZRd and ZRc are real then the 
definitions presented above are simplified to [5]
	
( )
( )
( )
2
d
d
Rd
d
Rd
v
z
i
z Z
a
z
Z
+
º
	
(6.21) 

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
133
	
( )
( )
( )
2
d
d
Rd
d
Rd
v
z
i
z Z
b
z
Z
-
º
	
(6.22)
	
( )
( )
( )
2
c
c
Rc
c
Rc
v z
i z Z
a z
Z
+
º
	
(6.23)
	
( )
( )
( )
2
c
c
Rc
c
Rc
v z
i z Z
b z
Z
-
º
	
(6.24)
As in the case of conventional scattering matrix, mixed-mode scattering 
matrix relates ingoing and outgoing differential and common-mode waves
	
d
dd
dc
d
c
cd
cc
c
é
ù
é
ùé
ù
=
ê
ú
ê
úê
ú
ë
û
ë
ûë
û
b
S
S
a
b
S
S
a
	
(6.25)
or
	
o
o o
=
b
Sa	
(6.26)
Equation (6.25) is the definition for the mixed-mode scattering matrix 
in which
	
1
2
[
..
..
]T
d
d
d
dp
a
a
a
=
a
	
(6.27)
and
	
1
2
[
..
..
]
c
c
c
cp
a
a
a
=
a
	
(6.28)
are vectors of, respectively, differential-mode ingoing waves and common-
mode ingoing waves.
Similarly
	
1
2
[
..
..
]T
d
d
d
dp
b
b
b
=
b
	
(6.29)
and
	
1
2
[
..
..
]
c
c
c
cp
b
b
b
=
b
	
(6.30)
are vectors of, respectively, differential-mode outgoing waves and common- 
mode outgoing waves. Sdd, Sdc, Scd, and Scc are p ´ p square submatrices 

134 
Microwave Network Design Using the Scattering Matrix
and p is the number of mixed mode (differential/common) ports of the  
network. 
For a mixed-mode two-port, this matrix relation may be written as
	
1
11
12
11
12
1
2
21
22
21
22
2
1
11
12
11
12
1
2
21
22
21
22
2
d
dd
dd
dc
dc
d
d
dd
dd
dc
dc
d
c
cd
cd
cc
cc
c
c
cd
cd
cc
cc
c
b
S
S
S
S
a
b
S
S
S
S
a
b
S
S
S
S
a
b
S
S
S
S
a
é
ù
é
ù é
ù
ê
ú
ê
ú ê
ú
ê
ú
ê
ú ê
ú
=
ê
ú
ê
ú ê
ú
ê
ú
ê
ú ê
ú
ë
û
ë
û ë
û
	
(6.31)
or
	
1
1
2
2
1
1
2
2
d
d
dd
dc
d
d
c
c
cd
cc
c
c
b
a
b
a
b
a
b
a
é
ù
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
S
S
S
S
	
(6.32)
From (6.25) and (6.32), it is evident that the mixed-mode scattering parameters 
decompose into differential-mode scattering parameters and common-mode 
scattering parameters. This is the main feature of mixed-mode scattering pa-
rameters. Mixed-mode scattering parameters describe transmission of the dif-
ferential-mode signals, common-mode signals, and cross-mode signals. There 
are four possible mode-specific wave network responses and corresponding to 
them a set of four p ´ p mixed mode scattering matrices.
These four submatrices represent network behavior and responses for 
differential-mode input to differential-mode output, differential-mode input 
to common-mode output, common-mode input to differential-mode out-
put, and common-mode input to common-mode output. The submatrices 
defined above are called Sdd, the differential mode scattering matrix, Scc, the 
common-mode scattering matrix, Sdc, and Scd, the mode convertion scatter-
ing matrices [5].
6.4  Transformation Between Standard- and Mixed-Mode  
Scattering Parameters
In our further derivations we will limit our discussion to the differential two-
port network presented in Figure 6.1. Without any problems they may be 

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
135
generalized to multiport differential networks. The mixed-mode scattering 
parameters defined in (6.30) are directly related to the four-port network 
standard scattering parameters of the discussed two-port mixed-mode net-
work. These relations come from definitions of mixed-mode power waves 
given by (6.21) through (6.24) and the conventional power waves given in 
Chapter 4 by (4.143) through (4.144).
Figure 6.2 presents, as an example, a cross section of a mixed-mode port 
in a form of symmetrical pair of coupled microstrip lines. In Figure 6.2(a) we 
see odd-mode voltages, while in Figure 6.2(b) we see even-mode voltages in 
the system of coupled microstrip lines.
The differential-mode characteristic impedances Z0d and the common-
mode characteristic impedance Z0c can be expressed in terms of the even-mode 
characteristic impedance Z0e and the odd-mode characteristic impedance Z0o of 
symmetrical couped transmission lines
	
( )
( )
0
0
0
0
( )
( )
0
0
0
2
2
/
d
o
d
o
o
o
d
V
V
Z
Z
I
V
Z
+
+
+
+
º
=
=
	
(6.33)
	
(
)
( )
( )
0
0
( )
( )
0
2
2
/
c
e
e
c
c
e
e
V
V
Z
Z
I
V
Z
+
+
+
+
º
=
=
	
(6.34)
When the lines are uncoupled, even-mode and odd-mode characteristic 
impedances are equal to the characteristic impedance of the single line: Z0e = 
Z0o = Z0 [4].
In further considerations we assume that the reference lines of the 
mixed-mode scattering matrix are the uncoupled transmission lines and that 
Z 0o
Z 0o
Z 0e
Z 0e
V ( )
+
o
V ( )
+
o
V ( )
+
o
2
V ( )
+
e
V ( )
+
e
(a)
(b)
Magnetic wall
Electric wall
Figure 6.2  Example of mixed-mode port; cross-section of a symmetrical pair of coupled 
microstrip lines. (a) Odd-mode voltages, and (b) even-mode voltages.

136 
Microwave Network Design Using the Scattering Matrix
the reference plane for the mixed-mode S-matrix is the interface between the 
uncoupled transmission lines and the coupled transmission lines.
Assuming that the reference impedance of the power waves in uncou-
pled reference lines equals the real characteristic impedance Z0 of the single 
uncoupled line at the interface with the coupled lines system, these waves 
are
	
0
0
1
(
)
2
i
i
i
a
v
i Z
Z
=
+
	
(6.35)
	
0
0
1
(
)
2
i
i
i
b
v
i Z
Z
=
-
	
(6.36)
while differential-mode and common-mode power waves propagating in a 
coupled line system are given by (6.21.) through (6.24) with the reference 
impedances
	
0
0
2
d
Z
Z
=
	
(6.37)
for differential mode wave and
	
0
0
2
c
Z
Z
=
	
(6.38)
for common-mode waves.
Taking into account relations (6.21) through (6.24), (6.35) through 
(6.36), and (6.37) through (6.38), we receive
	
1
1
2
1 (
)
2
da
a
a
=
-
	
(6.39)
	
1
1
2
1 (
)
2
db
b
b
=
-
	
(6.40)
	
1
1
2
1 (
)
2
ca
a
a
=
+
	
(6.41)
	
1
1
2
1 (
)
2
cb
b
b
=
+
	
(6.42)
for mixed-mode port 1, and

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
137
	
2
3
4
1 (
)
2
da
a
a
=
-
	
(6.43)
	
2
3
4
1 (
)
2
db
b
b
=
-
	
(6.44)
	
2
3
4
1 (
)
2
ca
a
a
=
+
	
(6.45)
	
2
3
4
1 (
)
2
cb
b
b
=
+
	
(6.46)
for mixed-mode port 2.
Using the relations presented above, we can find the transformation 
between mixed-mode and standard power scattering parameters.
For the ingoing waves we can write
	
1
1
2
2
1
3
2
4
1
1
0
0
0
0
1
1
1
1
1
0
0
2
0
0
1
1
d
d
c
c
a
a
a
a
a
a
a
a
-
é
ù
é
ùé
ù
ê
ú
ê
úê
ú
-
ê
ú
ê
úê
ú
=
ê
ú
ê
úê
ú
ê
ú
ê
úê
ú
ë
û
ë
ûë
û	
(6.47)
or
	
o =
a
Ma	
(6.48)
where ao is a vector of mixed mode ingoing waves, a is a vector of ingoing 
standard waves, and
	
1
1
0
0
0
0
1
1
1
1
1
0
0
2
0
0
1
1
-
é
ù
ê
ú
-
ê
ú
=
ê
ú
ê
ú
ë
û
M
	
(6.49)
Similarly, for the outgoing waves, we have
	
o
=
b
Mb	
(6.50)

138 
Microwave Network Design Using the Scattering Matrix
where vectors b
o
 and b are constructed in the same way as, respectively, ao 
and a.
Applying (6.48) and (6.50) into the definition of the mixed-mode scat-
tering matrix given by (6.25) and using the definition of standard scattering 
matrix b = Sa, we get
	
o
-
=
1
S
MSM
	
(6.51)
and vice versa
	
o
-
=
1
S
M
SM	
(6.52)
In (6.51) and (6.52) S is a standard power scattering matrix and S
o is a 
mixed-mode power scattering matrix of the differential network defined by 
(6.25).
6.5  Generalized Mixed-Mode Pseudoscattering Matrix
Figure 6.3, shows the general n-port representing a mixed-mode network 
with p differential ports and (n - p) single-ended ports. The overall number 
of ports n of this network is devided into two sets. The mixed-mode set 
composed of even number of p ports requires differential- as well as common-
mode description. The remaining (n - p) ports are all single-ended and they 
require only standard, common-mode descriptions [7].
Figure 6.3  A general n-port representing a mixed-mode network.

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
139
Following definitions given by (6.1) through (6.2) and (6.5) through 
(6.6), the differential- and common-mode voltages and currents associated 
with the generic port pair j and k are defined as
	
djk
j
k
v
v
v
º
-
	
(6.53)
	
2
j
k
djk
i
i
i
-
º
	
(6.54)
	
c
2
j
k
jk
v
v
v
+
º
	
(6.55)
	
º
+
cjk
j
k
i
i
i 	
(6.56)
A state vector containing the single-ended voltage and current for the 
ith port is
	
[
] T
i
i
i
v i
=
r
	
(6.57)
whereas the state vector containing mixed-mode voltage and current of a port 
pair j and k is
	
[
] T
jk
djk
djk
cjk
cjk
v
i
v
i
=
r
	
(6.58)
Relations (6.53) through (6.56) can be presented in matrix notation as
	
o
jk
jk
=
r
T r 	
(6.59)
where
	
1
0
1
0
0
1/2
0
1/2
1/2
0
1/2
0
0
1
0
1
-
é
ù
ê
ú
-
ê
ú
= ê
ú
ê
ú
ë
û
T
	
(6.60)
and
	
j
jk
k
é
ù
º ê
ú
ë
û
r
r
r
	
(6.61)

140 
Microwave Network Design Using the Scattering Matrix
According to the definition of incident and reflected pseudowaves given 
by [8]
	
{
}
i
0
0
Z
(
)
2
R
i
Ri
Ri
Re
v
a
v
iZ
v
Z
é
ù
º
+
ê
ú
ê
ú
ë
û
	
(6.62)
	
{
}
0
0
Re Z
(
)
2 Z
Ri
i
Ri
Ri
v
b
v
iZ
v
é
ù
º
-
ê
ú
ê
ú
ë
û
	
(6.63)
the port state vector of waves at the single-ended ith port can be written as
	
i
i
i i
i
a
b
é
ù
º
=
ê
ú
ë
û
w
M r
	
(6.64)
where
	
1
1
2
Ri
i
i
Ri
Ri
Z
R
Z
Z
é
ù
=
ê
ú
-
ë
û
M
	
(6.65)
In (6.65) ZRi is the reference impedance of the ith port and Ri = 
Re{ZRi}.
By analogy to the single-ended port pseudowaves given by (6.62) and 
(6.63), we define mixed-mode pseudowaves corresponding to a mixed mode 
port as
	
2
djk
djk
djk
djk
djk
djk
v
i
Z
a
R
Z
+
=
	
(6.66)
	
2
djk
djk
djk
djk
djk
djk
v
i
Z
b
R
Z
-
=
	
(6.67)
	
2
cjk
cjk
cjk
cjk
cjk
cjk
v
i
Z
a
R
Z
+
=
	
(6.68)
	
2
cjk
cjk
cjk
cjk
cjk
cjk
v
i
Z
b
R
Z
-
=
	
(6.69)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
141
where j and k indicate a port pair of the mixed-mode port, Zcjk indicates the 
reference impedances for the common mode, Zdjk indicates the reference im-
pedance for differential mode, and Rcjk = Re{Zcjk} and Rdjk = Re{Zdjk}.
Using (6.59) and (6.66) through (6.69), we can write the mixed-mode 
state vector as
	
[
]T
jk
jk
jk
djk
djk
cjk
cjk
a
b
a
b
=
=
o
o
o
w
M
r 	
(6.70)
where
	
0
0
2
2
0
0
2
2
0
0
2
2
0
0
2
2
djk
djk
djk
djk
djk
djk
djk
djk
djk
djk
jk
cjk
cjk
cjk
cjk
cjk
cjk
cjk
cjk
cjk
cjk
R
Z
R
Z
Z
R
Z
R
Z
Z
R
Z
R
Z
Z
R
Z
R
Z
Z
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
o
M
	
(6.71)
Using (6.54) and (6.65), the overall wave state vector of the j and k port 
pair defined as
	
j
jk
k
é
ù
= ê
ú
ë
û
w
w
w
	
(6.72)
may be expressed as
	
0
0
j
jk
jk jk
jk
k
é
ù
=
= ê
ú
ë
û
M
w
M r
r
M
	
(6.73)
Using the matrix formalism presented above it is possible to write the 
relationship linking the classical single-ended pseudowave state vector with 
the mixed-mode pseudowave state vector [7]
	
jk
jk
jk
jk
jk
jk
-
=
=
o
o
1
w
M
TM
w
X
w 	
(6.74)

142 
Microwave Network Design Using the Scattering Matrix
  
We introduce the overall generalized mixed-mode wave state network 
in the form
	
12
34
(
1)
1
2
1
[
....
.....
]T
p
p
p
p
n
n
-
+
+
-
=
o
o
o
o
w
w
w
w
w
w
w
w
	
(6.76)
Because the original single-ended overall state vector is
	
1
2
1
2
[
...
] T
n-
=
w
w w
w
w
	
(6.77)
then using (6.70), (6.73), and (6.74), we find the relation between two over-
all state vectors in the form
	
= X
ow
w	
(6.78)
where X is the 2n ´ 2n block diagonal matrix
	
12
34
1
(p
)p
-
é
ù
ê
ú
ê
ú
ê
ú
X =
ê
ú
ê
ú
ê
ú
ë
û
X
0
:
:
0
0
X
:
:
0
:
:
:
:
:
:
:
:
X
:
:
:
:
:
I 	
(6.79)
while I is the 2(n – p) ´ 2(n – p) identity matrix relative to the single-ended 
ports.
The generalized mixed-mode pseudoscattering matrix S
o  can be defined 
by the equation
	
=
o
o o
b
Sa	
(6.80)
where
=
+
+
+
+
-
-
+
+
+
+
-
-
(2
)
(2
)
(2
)
(2
)
4
4
4
4
(2
)
(2
)
(2
)
(2
)
4
4
4
4
jk
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
j
djk
j
j
djk
j
j
djk
j
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
djk
j
j
djk
j
j
djk
j
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
X
+
+
+
+
+
+
+
+
(2
)
(2
)
(2
)
(2
)
4
4
4
4
(2
)
(2
)
(2
)
(2
)
4
4
4
4
j
djk
j
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
j
cjk
j
j
cjk
j
j
cjk
j
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
cjk
j
j
cjk
j
j
cjk
j
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
R
Z
Z
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
j
cjk
j
R
Z
Z
(6.75)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
143
where ao and b
o
 are the generalized mixed-mode wave vectors, in which we 
combine the p mixed-mode port set with the remaining (n - p) single-ended 
ports given as
	
12
12
34
34
(
1)
(
1)
12
12
34
34
(
1)
(
1)
1
1
1
1
.
.
.
.
.
.
.
.
.
.
.
.
d
d
d
d
d p
p
d p
p
c
c
c
c
c p
p
c p
p
p
p
n
n
n
n
a
b
a
b
a
b
a
b
a
b
a
b
a
b
a
b
a
b
-
-
-
-
+
+
-
-
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
o
oa
b
	
(6.81)
To find the relationship between the generalized mixed-mode scatter-
ing matrix S
o and the standard single-ended scattering matrix S, the vector  
wo defined in (6.76) should be properly reordered [7]
	
da
ca
a
db
cb
b
é
ù
ê
ú
ê
ú
é ù
ê
ú
ê ú
º
=
=
ê
ú
ê ú
ê
ú
ê ú
ë û
ê
ú
ê
ú
ê
ú
ë
û

o
o
o
o
o
P
P
a
P
w
w
Pw
P
b
P
P
	
(6.82)
where P is a (2n ´ 2n) permutation matrix composed of a set of four  matrices 
Pda, Pca, Pdb, Pcb of size ( p/2 ´ 2n) having a single “1” in each row, and all 
other elements equal zero:
	
( ,4
3)
1, 
1,..., /2;       
0,   elsewhere
da
da
P
i
i
i
p
P
-
=
=
=
	
(6.83)

144 
Microwave Network Design Using the Scattering Matrix
	
( ,4
1)
1, 
1,..., /2;       
0,   elsewhere
ca
ca
P
i
i
i
p
P
-
=
=
=
	
(6.84)
	
( ,4
2)
1, 
1,..., /2;       
0,   elsewhere
db
db
P
i
i
i
p
P
-
=
=
=
	
(6.85)
	
( ,4 )
1, 
1,..., /2;       
0,   elsewhere
cb
cb
P
i
i
i
p
P
=
=
=
 
(6.86)
and two matrices Pa and Pb of size ((n - p) ´ 2n):
	
( ,2
2
1)
1, 
1,...,(
);    
0   elsewhere
a
a
P i
p
i
i
n
p
P
+
-
=
=
-
=
	
(6.87)
	
( ,2
2 )
1, 
1,...,(
);        
0   elsewhere
b
b
P i
p
i
i
n
p
P
+
=
=
-
=
	
(6.88)
To order the whole single-ended wave state vector w and obtain the 
swapped state vector w
	
é ù
é
ù
=
=
=
ê ú
ê
ú
ë û
ë
û

a
b
a
Q
w
w
Qw
b
Q
	
(6.89)
we introduce and define another two matrices Q a and Q b of size (n ´ 2n):
	
( ,2
1)
1, 
1,..., ;    
0   elsewhere
a
a
Q l
l
l
p
Q
-
=
=
=
	
(6.90)
	
( ,2 )
1, 
1,..., ;         
0   elsewhere
b
b
Q l
l
l
p
Q
=
=
=
	
(6.91)
Combining (6.82) and (6.89), we receive the relationship between the 
reordered single-ended state vector and corresponding generalized mixed-
mode state vector
	
o =
X
= X




T
w
P Q w
w	
(6.92)
from which we get
	
o
o
11
12
21
22
= X
+ X
= X
+ X




a
a
b
b
a
b	
(6.93)
where X˜i,j, i,j = 1,2 are four squared (n ´ n) submatices received by spliting X˜
	
11
12
21
22
é
ù
X
X
X = ê
ú
X
X
ë
û





	
(6.94)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
145
Finally, using (6.46), (6.80), and (6.93), the direct and inverse trans-
formations between the standard (single-ended) scattering matrix S and the 
mixed-mode scattering matrix S
o  may be written as [7]
	
1
)(
)-
21
22
11
12
= (X
+ X
X
+ X




o
S
S
S
	
(6.95)
	
1
o
o
22
12
21
11
-
æ
ö
æ
ö
= X
- X
X
- X
ç
÷
ç
÷
è
ø
è
ø




S
S
S
	
(6.96)
Equations (6.95) and (6.96) are the general forms of (6.51) and 
(6.52).
In the case of the network presented in Figure 6.1 with two pairs of 
single-ended ports forming two mixed-mode ports only, and when it is as-
sumed that Zc12 = ZR/2 and Zd12 = 2ZR, where ZR is real reference impedance 
of the single-ended ports, we get
	
11
22
1
1
0
0
0
0
1
1
1
1
1
0
0
2
0
0
1
1
-
é
ù
ê
ú
-
ê
ú
X
= X
=
=
ê
ú
ê
ú
ë
û


M
	
(6.97)
and
	
21
X
= X
=


12
0	
(6.98)
where 0 is (4 ´ 4) null matrix.
As expected (6.95), simplifies to (6.51)
	
-
=
o
1
S
MSM
	
(6.99)
In a case of a network with only n standard single-ended ports, the ma-
trix X˜ is the (n ´ n) identity matrix, X˜22 = X˜11 = 1, X˜12 = X˜21 = 0, and from 
(6.90), as expected, we receive S
o  = S.

146 
Microwave Network Design Using the Scattering Matrix
The generalized S
o  matrix can be split into nine submatrices, which in-
dicate the self- and cross-coupling between the differential-, common-, and 
single-ended modes:
	
[ , ]
[ , ]
[ ,
2 ]
[ , ]
[ , ]
[ ,
2 ]
[
2 , ]
[
2 , ]
[
2 ,
2 ]
dd
dc
de
cd
cc
ce
ed
ec
ee
p p
p p
p n
p
p p
p p
p n
p
n
p p
n
p p
n
p n
p
é
ù
ê
ú
ê
ú
-
ê
ú
ê
ú
-
-
-
-
-
ê
ú
ê
ú
ê
ú
= ê
ú
-
ê
ú
ê
ú
-
-
-
-
-
ê
ú
ê
ú
ê
ú
ê
ú
-
-
-
-
ê
ú
ë
û
o
o
o
o
o
o
o
o
o
o
S
S
S
S
S
S
S
S
S
S
	
(6.100)
where the d, c, and e subscripts used at symbols of nine submatrices refer to 
the differential-, common-, and single-ended modes, respectively. As shown in 
Figure 6.4, the general mixed-mode scattering matrix S
o given by (6.100) cor-
responds to the n-port network with first 2p ports grouped in pairs as p mixed 
common-differential ports and the remaining (n -2p) single-ended ports.
Example 6.1
Calculate the mixed-mode scattering matrix S
o of two identical uncou-
pled transmission lines considered as a differential two-port. We illus-
trate this network in Figure 6.4.
1
2
3
4
Figure 6.4  Two uncoupled transmission lines considered as a mixed-mode two-port  
network.

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
147
Solution
This network has two mixed mode ports numbered 1–2 and 3–4. There 
are no single-ended ports in the network. According to the convention 
of port numbering presented in Figures 6.3 and 6.4, p = 4 and n = 4. The 
generalized mixed-mode scattering matrix is the coefficient matrix in the 
equation
	
o
o
=
o
b
Sa	
(6.101)
where
	
12
12
o
o
34
34
12
12
34
34
and 
d
d
d
d
c
c
c
c
b
a
b
a
b
a
b
a
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
=
=
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
b
a
	
(6.102)
Adopting real and the same reference impedance of all single-ended 
ports ZR1 = ZR2 = ZR3 = ZR4 = ZR and assuming that the reference impedances 
of both ports for differential-mode waves are Zd12 = Zd34 = 2 ZR and that the 
reference impedances of both ports for common-mode waves are Zc12 = Zc34 
= ZR /2, then using (6.82) through (6.95), we get
	
1 0 0 0 0 0 0 0
0 0 0 0 1 0 0 0
0 0 1 0 0 0 0 0
0 0 0 0 0 0 1 0
0 1 0 0 0 0 0 0
0 0 0 0 0 1 0 0
0 0 0 1 0 0 0 0
0 0 0 0 0 0 0 1
1 0 0 0 0 0 0 0
0 0 1 0 0 0 0 0
0 0 0 0 1 0 0 0
0 0 0 0 1 0 0 0
0 1 0 0 0 0 0 0
0 0 0 1 0 0 0 0
0 0
da
ca
db
cb
a
b
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
é
ù
ê
ú
ê
ú
=
=
ê
ú
ê
ú
ë
û
P
P
P
P
P
Q
Q
Q
0 0 0 1 0 0
0 0 0 0 0 0 0 1
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û	
(6.103)

148 
Microwave Network Design Using the Scattering Matrix
	
1
0
1
0
0
0
0
0
0 1
0
1 0
0
0
0
1
0
1
0
0
0
0
0
0 1
0
1
0
0
0
0
1
0
0
0
0
1
0
1
0
2
0
0
0
0
0 1
0
1
0
0
0
0
1
0
1
0
0
0
0
0
0 1
0
1
1
1 0
0
0
0
0
0
0
0
1
1 0
0
0
0
1
1
0
0
0
0
0
0
0
0
1
1
0
0
0
0
1
0
0
0
0
1
1 0
0
2
0
0
0
0
0
0
1
1
0
0
0
0
1
1
0
0
0
0
0
0
0
0
1
1
-
é
ù
ê
ú
-
ê
ú
ê
ú
ê
ú
ê
ú
X =
ê
ú
-
ê
ú
-
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
-
é
ù
ê
ú
-
ê
ú
ê
ú
ê
ú
ê
ú
X =
ê
ú
-
ê
ú
-
ê
ú
ê
ú
ê
ú
ê
ú
ë
û

	
(6.104)
From (6.104), we have
and	
11
22
12
21
1
1
0
0
0
0
1
1
1
1
1
0
0
2
0
0
1
1
-
é
ù
ê
ú
-
ê
ú
X
= X
=
ê
ú
ê
ú
ë
û
X
= X
= 0




	
(6.105)
Because the transmission lines of the analyzed network are uncoupled 
than the standard scattering matrix of the analyzed network
	
11
14
22
23
32
33
41
44
0
0
0
0
0
0
0
0
S
S
S
S
S
S
S
S
é
ù
ê
ú
ê
ú
= ê
ú
ê
ú
ë
û
S
	
(6.106)
where
            
(
)
(
)
2
2
0
11
22
33
44
2
2
0
0
tanh
2
tanh
R
R
R
Z
Z
l
S
S
S
S
Z Z
Z
Z
l
γ
γ
-
=
=
=
=
+
+
	
(6.107)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
149
	
(
)
1
0
14
41
23
32
2
2
0
0
2
cosh
2
tanh l
R
R
R
Z Z
l
S
S
S
S
Z Z
Z
Z
γ
γ
-
=
=
=
=
+
+
	
(6.108)
are the elements of the pseudoscattering matrix of a single transmission line 
(see (4.96) and (4.101)).
Now using (6.93) representing the general form of the single-ended 
to mixed-mode scattering matrix transformation, we find the mixed-mode 
scattering matrix
	
11
14
o
14
11
11
14
14
11
0
0
0
0
0
0
0
0
S
S
S
S
S
S
S
S
-
é
ù
ê
ú
-
ê
ú
= ê
ú
ê
ú
ë
û
S
	
(6.109)
This matrix can be split into four submatrices. The submatrix
	
11
14
14
11
dd
S
S
S
S
-
é
ù
= ê
ú
-
ë
û
S
	
(6.110)
specifies differential-mode scattering parameters, while the submatrix
	
11
14
14
11
cc
S
S
S
S
é
ù
= ê
ú
ë
û
S
	
(6.111)
There is no crosscoupling between the differential-mode and common- 
mode waves. The submatrices Sdc and Scd are zero matrices.
Example 6.2
Calculate the mixed-mode scattering matrix S
o of the two coupled trans-
mission lines presented in Figure 6.5.
Solution
This network, like the network in Example 6.1, has two mixed-mode 
ports numbered 1–2 and 3–4. There are no single-ended ports in the 
network. According to the convention of port numbering presented in 

150 
Microwave Network Design Using the Scattering Matrix
Figures 6.3 and 6.5, p = 4 and n = 4. The generalized scattering matrix 
is the coefficient matrix in the equation
	
o
o
=
o
b
Sa	
(6.112)
where
	
12
12
o
o
34
34
12
12
34
34
and 
d
d
d
d
c
c
c
c
b
a
b
a
b
a
b
a
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
=
=
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
b
a
	
(6.113)
The standard scattering matrix of coupled symmetrical transmission 
lines has the form [4]
	
11
12
13
14
12
11
14
13
13
14
11
12
14
13
12
44
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
é
ù
ê
ú
ê
ú
= ê
ú
ê
ú
ë
û
S
	
(6.114)
where
	
11
11
11
11
11
12
2
2
e
o
e
o
S
S
S
S
S
S
+
-
=
=
	
(6.115)
	
12
12
12
12
13
14
2
2
e
o
e
o
S
S
S
S
S
S
-
+
=
=
	
(6.116)
1
2
Coupled lines
3
4
Figure 6.5  Two symmetric coupled transmission lines considered as a mixed-mode two-
port network.

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
151
In (6.115) and (6.116), S11e and S12e are the scattering parameters of an 
even-mode single transmission line with the characteristic impedance Z0e and 
the propagation constant ge , while S11o and S12o are the scattering parameters 
of an odd-mode single transmission line with the characteristic impedance 
Z0o and the propagation constant go. They are given as
	
(
)
(
)
2
2
0
11
2
2
0
0
tanh
2
tanh
q
Rq
q
q
q
Rq
q
Rq
q
Z
Z
l
S
Z
Z
Z
Z
l
γ
γ
-
=
+
+
	
(6.117)
	
(
)
1
0
12
2
2
0
0
2
cosh
2
tanh
q
Rq
q
q
q
Rq
q
Rq
q
Z
Z
l
S
Z
Z
Z
Z
l
γ
γ
-
=
+
+
	
(6.118)
In (6.117) and (6.118), index q should be replaced by e for the even-mode 
transmission line and by o for the odd-mode transmission line.
Adopting real and the same reference impedance for even-mode and 
odd-mode transmission lines ZRe = ZRo = ZR and assuming that the reference 
impedances of both ports for the differential mode are Zd12 = Zd34 = 2 ZR and 
that the reference impedances of both ports for common mode are Zc12 = Zc34 
= ZR /2, then performing the procedure given by (6.82) through (6.95), we 
transform the standard single-ended scattering matrix S into the correspond-
ing mixed-mode scattering matrix S
o. The result is
	
11
12
12
11
11
12
12
11
0
0
0
0
0
0
0
0
o
o
o
o
dd
dc
e
e
cc
cd
e
e
S
S
S
S
S
S
S
S
-
é
ù
é
ù
ê
ú
-
ê
ú
ê
ú
=
= ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
o
S
S
S
S
S
	
(6.119)
where S11e, S11o,S12e and S12o are given by (6.117) and (6.118). 
As expected, there is no crosscoupling between the differential-mode 
and common-mode waves. Entries of the submatrices Sdc and Scd all equal 
zero. Furthermore, the elements of the differential-mode submatrix Sdd cor-
respond to the odd-mode transmission line scattering parameters, while the 
elements of the common-mode submatrix Scc correspond to the even-mode 
transmission line scattering parameters.

152 
Microwave Network Design Using the Scattering Matrix
Example 6.3
Calculate the generalized mixed-mode scattering parameters of the 
equal-split Wilkinson power divider/combiner presented in Figure 6.6.
Solution
A pair of two single-ended ports 1 and 2 create mixed differential-common 
port while port 3 is the single-ended port. Assuming that the transmission 
lines of this network are lossless and that the reference impedances of all 
ports are the same, real and equal to the characteristic impedances Z0 of 
transmission lines forming all three ports (ZR1 = ZR2 = ZR3 = Z0), at center 
frequency the conventional scattering matrix of this network is given as
	
0
0
1
0
0
2
0
j
j
j
j
-
é
ù
ê
ú
=
-
ê
ú
ê
ú
-
-
ë
û
S
	
(6.120)
The generalized mixed-mode scattering matrix S
o of this network de-
scribes the equation in the form
	
12
12
12
12
3
3
d
d
c
c
b
a
b
a
b
a
é
ù
é
ù
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
o
S
	
(6.121)
1
2
3
R
Z
= 2
0
Figure 6.6  An equal-split Wilkinson power divider as a microstrip network.

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
153
Assuming that the reference impedances of mixed-mode port for dif-
ferential mode is Zd12 = 2 Z0 and that the reference impedances of this 
port for common mode is Zc12 = Z0 / 2, then using (6.82) through (6.95) 
we get
	
1
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
1
0
0
1
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
1
1
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
1
0
0
1
0
0
0
0
0
0
0
1
0
0
0
0
0
0
0
1
da
ca
a
db
cb
da
a
b
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
é
ù é
ù
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
= ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ê
ú
ê
ú ë
û
ë
û
P
P
P
P
P
P
P
Q
Q
Q
	
(6.122)
	
1
0
1
0
0
0
0
1
0
1
0
0
1
0
1
0
0
0
0
1
0
1
0
0
0
0
0
0
1
0
0
0
0
0
0
1
1
1
0
0
0
0
1
1
0
0
0
0
0
0
2
0
0
0
1
0
0
0
1
1
0
2
0
0
0
1
1
0
0
0
0
0
0
2
-
é
ù
ê
ú
-
ê
ú
ê
ú
X = ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
-
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
X =
-
ê
ú
ê
ú
ê
ú
ê
ú
ë
û

	
(6.123)

154 
Microwave Network Design Using the Scattering Matrix
From (6.94)
	
11
22
12
21
1
1
0
1
1
1
0
and
2
0
0
2
é
ù
-
ê
ú
X
= X
=
X
= X
=
ê
ú
ê
ú
ë
û




0
	
(6.124)
Using (6.122), (6.123), and (6.124), we receive
	
11
12
11
12
13
31
33
0
0
0
0
0
0
2
0
0
0
0
0
2
dd
dc
de
cd
cc
ce
ed
ec
ee
S
S
S
S
S
j
j
S
S
é
ù
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ë
û
-
é
ù
é
ù
ê
ú
ê
ú
=
+
=
-
ê
ú
ê
ú
ê
ú
ê
ú
-
ë
û
ë
û
o
S
S
S
S
S
S
S
S
S
S
	
(6.125)
From (6.125) we see that
	
0
dd
dc
de
cd
cc
ed
ee
=
=
=
=
=
=
=
S
S
S
S
S
S
S
	
(6.126)
	
ce
ec
j
=
= -
S
S
	
(6.127)
Equations (6.125) through (6.127) indicate that there is no coupling be-
tween the differential mode and common mode in the network. There is also no 
component of differential input signal in the output signal of the combiner.
Example  6.4
Determine the generalized mixed-mode scattering matrix of an opera-
tional amplifier presented in Figure 6.7(a).
Solution
An operational amplifier is a classical example of a network with one 
mixed, common differential input port and a single-ended output port. 
In Figure 6.5(b) there is presented the simplified circuit model of the 
differential amplifier.

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
155
Figure 6.7  (a) Differential amplifier, and (b) its simplified circuit model.
The reference impedances for two input ports are the same, real and 
equal ZR. The reference impedance of the output port is also real and 
equal ZR3. Using rules presented in Chapter 4, we find the elements of 
the single-ended (3 ´ 3) standard scattering matrix S as
	
2
2
11
22
2
2
(2
)
2
(
)
(2
)
C
D
C
D
R
C
C
D
R
C
D
C
D
R
R R
R
R
Z
S
S
R
R
R
Z
R R
R
R
Z
-
+
=
=
+
+
+
+
	
(6.128)
	
2
12
21
2
2
2
2
(
)
(2
)
C
R
C
C
D
R
C
D
C
D
R
R Z
S
S
R
R
R
Z
R R
R
R
Z
=
=
+
+
+
+
	
(6.129)

156 
Microwave Network Design Using the Scattering Matrix
	
13
31
0
S
S
=
= 	
(6.130)
        
31
32
3
3
2
2
C
R
R
C
D
D
OUT
R
C
R
D
R
C
R
C
D
S
S
R
Z Z
A
A R
R
Z
R
Z
R Z
R Z
R R
=
=
æ
ö
+
ç
÷
è
ø
+
+
+
+
	
(6.131)
	
3
33
3
OUT
R
OUT
R
R
Z
S
R
Z
-
=
+
	
(6.132)
The conventional scattering matrix does not supply information on the 
differential and common-mode signal amplification. These parameters are 
embedded within the S31 and S32 elements of the single-ended standard scat-
tering matrix.
Because of the same topology of the example networks, the permuta-
tion matrices P and Q for the Wilkinson combiner and for the operational 
amplifier are the same. The elements of the conventional scattering matrix 
S can be simply transformed into the elements of the corresponding mixed-
mode scattering matrix S
o. Using relations presented as (6.82) through (6.95), 
we receive the elements of the matrix S
o in the form
	
12
13
21
23
33
0
S
S
S
S
S
=
=
=
=
=
o
o
o
o
o
	
(6.133)
	
12
12
11
12
12
2
2
2
2
o
C
D
d
C
d
D
C
D
d
C
d
D
R R
R
R
R
R
S
R R
R
R
R
R
-
-
=
+
+
	
(6.134)
	
12
22
12
2
2
o
C
c
C
c
R
R
S
R
R
-
=
+
	
(6.135)
	
3
33
3
o
OUT
R
OUT
R
R
Z
S
R
Z
-
=
+
	
(6.136)
	
3
12
31
12
12
3
4
2
(2
2
)(
)
o
D
R
d
C
D
C
D
d
C
d
D
OUT
R
A
Z
R
R R
S
R R
R
R
R
R
R
Z
=
+
+
+
	
(6.137)
	
3
12
32
12
3
2
2
(
)(
)
o
C
R
d
C
C
c
OUT
R
A
Z
R
R
S
R R
R
Z
=
+
	
(6.138)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
157
The above relations indicate the absence of  cross-mode components 
at the output of the operational amplifier. As it is seen from (6.137) and 
(6.138), the element S
o
31 depends only on AD while the element S
o
32 is de-
pendent only on AC. This fact shows, in the most straightforward way, the 
separated contributions of the input differential-mode signal and of the input 
common-mode signal to the single-ended output port signal.
Assuming matched output port (S33 = 0) and the same reference imped-
ance for all ports, ROUT = ZR3 = ZR, we receive
	
13
21
23
33
12
0
o
o
o
S
S
S
S
S
=
=
=
=
=
o
o
	
(6.139)
	
12
12
11
12
12
2
2
2
2
o
C
D
d
C
d
D
C
D
d
C
d
D
R R
R
R
R
R
S
R R
R
R
R
R
-
-
=
+
+
	
(6.140)
	
12
22
12
2
2
o
C
c
C
c
R
R
S
R
R
-
=
+
	
(6.141)
	
12
31
12
12
2
2
2
2
o
d
C
D
D
R
C
D
d
C
d
D
R
R R
S
A
Z
R R
R
R
R
R
=
+
+
	
(6.142)
	
12
32
12
2
2
o
c
C
C
R
C
c
R
R
S
A
Z
R
R
=
+
	
(6.143)
And, finally assuming that Rd12 = RD = 2 ZR and Rc12 = RC/2 = ZR/2, 
we get
	
dd
dc
de
cd
cc
ce
ed
ec
1
0
0
3
0
0
0
2
0
3
2
ee
D
C
A
A
é
ù
-
ê
ú
é
ù
ê
ú
ê
ú
=
= ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ê
ú
ë
û
o
S
S
S
S
S
S
S
S
S
S
	
(6.144)
or
	
dc
de
cd
cc
ce
ee
=
=
=
=
=
=
S
S
S
S
S
S
0	
(6.145)

158 
Microwave Network Design Using the Scattering Matrix
	
ed
2
2
D
A
=
S
	
(6.146)
and
	
ec
2
cA
=
S
	
(6.147)
Using the same assumptions for the single ended scattering matrix we 
receive
	
1
1
0
6
6
1
1
0
6
6
0
4
3
4
3
C
D
C
D
A
A
A
A
é
ù
-
ê
ú
ê
ú
ê
ú
=
-
ê
ú
ê
ú
ê
ú
+
-
ë
û
S
	
(6.148)
Comparing the above matrices S
o and S we see that only generalized 
mixed-mode scattering matrix can be used for clear and precise presentation 
of networks with differential and single-ended ports.
6.6  Mixed-Mode Cascade Matrix
Let as consider a mixed-mode two-port network presented in Figure 6.1.
By analogy to the standard single-ended T-matrix, the mixed-mode cas-
cade matrix T
o is defined as [11]
	
1
11
12
11
12
2
1
21
22
21
22
2
1
11
12
11
12
2
1
21
22
21
22
2
d
dd
dd
dc
dc
d
d
dd
dd
dc
dc
d
c
cd
cd
cc
cc
c
c
cd
cd
cc
cc
c
a
T
T
T
T
b
b
T
T
T
T
a
a
T
T
T
T
b
b
T
T
T
T
a
é
ù
é
ù é
ù
ê
ú
ê
ú ê
ú
ê
ú
ê
ú ê
ú
=
ê
ú
ê
ú ê
ú
ê
ú
ê
ú ê
ú
ë
û
ë
û ë
û
	
(6.149)
To find interrelation between the mixed-mode scattering parameters S
o 
and the mixed-mode T-parameters we should rearrange the original mixed-
mode scattering matrix S
o, defined in (6.31), to the form

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
159
	
1
11
11
12
12
1
1
11
11
12
12
1
2
21
21
22
22
2
2
21
21
22
22
2
c
cc
cd
cc
cd
c
d
dc
dd
dc
dd
d
c
cc
cd
cc
cd
c
d
dc
d
dc
dd
d
b
S
S
S
S
a
b
S
S
S
S
a
b
S
S
S
S
a
b
S
S
S
S
a
é
ù
é
ù é
ù
ê
ú
ê
ú ê
ú
ê
ú
ê
ú ê
ú
=
ê
ú
ê
ú ê
ú
ê
ú
ê
ú ê
ú
ë
û
ë
û ë
û	
(6.150)
To simplify calculations, the set of equations given by (6.150) should 
be divided into four sets of matrix equations
	
1
1
11
12
21
22
2
2
é
ù
é
ù
é
ù
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û




b
S
S
a
S
S
b
a
	
(6.151)
or written as two equations
	
1
1
2
11
12
=
+



b
S a
S a 	
(6.152)
	
2
1
21
22
=
+



2
b
S
a
S
a 	
(6.153)
with submatrices
	
11
11
11
11
11
cc
cd
dc
dd
S
S
S
S
é
ù
= ê
ú
ë
û
S
	
(6.154)
	
12
12
12
12
12
cc
cd
dc
dd
S
S
S
S
é
ù
= ê
ú
ë
û
S
	
(6.155)
	
21
21
21
21
21
cc
cd
dc
dd
S
S
S
S
é
ù
= ê
ú
ë
û
S
	
(6.156)
	
22
22
22
22
22
cc
cd
dc
dd
S
S
S
S
é
ù
= ê
ú
ë
û
S
	
(6.157)
and subvectors
	
1
1
1
c
d
b
b
é
ù
= ê
ú
ë
û

b
	
(6.158)

160 
Microwave Network Design Using the Scattering Matrix
	
2
2
2
c
d
b
b
é
ù
= ê
ú
ë
û

b
	
(6.159)
	
1
1
1
c
d
a
a
é
ù
= ê
ú
ë
û

a
	
(6.160)
	
2
2
2
c
d
a
a
é
ù
= ê
ú
ë
û

a
	
(6.161)
Solving (6.152) and (6.153) for 1
a

 and 1
b

, we get
	
1
1
1
2
2
21
21 22
-
-
=
-



a
S
b
S
S
a 	
(6.162)
	
(
)
1
1
1
2
2
11 21
12
11 21 22
-
-
=
+
-



b
S S
b
S
S S
S
a 	
(6.163)
Both equations (6.162) and (6.163) written in matrix form are:
	
1
1
1
2
21
21 22
1
1
1
2
11 21
12
11 21 22
-
-
-
-
é
ù
é
ù
é
ù
-
=
ê
ú
ê
ú
ê
ú
ê
ú
-
ê
ú
ê
ú
ë
û
ë
û
ë
û




a
S
S
S
b
S S
S
S S
S
b
a
	
(6.164)
or
	
c1
c2
1
1
d1
21
21 22
d2
1
1
c1
c2
11 21
12
11 21 22
d1
d2
a
b
a
b
b
a
b
a
-
-
-
-
é
ù
é
ù
ê
ú
ê
ú
é
ù
-
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
-
ê
ú
ë
û
ê
ú
ê
ú
ë
û
ë
û
S
S
S
S S
S
S S
S
	
(6.165)
Comparing (6.149) and (6.165) it is very easy to recognize that the 
coefficient matrix in (6.165) equals the mixed-mode cascade (transfer scatter-
ing) matrix T (6.149) with properly permutated rows. Comparing the result-
ing coefficients of (6.149) with the proper ones from (6.165), we get [11]
	
11
21
cc
x dd
T
S S
=
	
(6.166)
	
11
21
cd
x cd
T
S S
= -
	
(6.167)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
161
	
11
21
dc
x dc
T
S S
= -
	
(6.168)
	
11
21
dd
x cc
T
S S
=
	
(6.169)
	
12
21
22
21
22
(
)
cc
x
cd
dc
dd
cc
T
S S
S
S
S
=
-
	
(6.170)
	
12
21
22
21
22
(
)
cd
x
cd
dd
dd
cd
T
S S
S
S
S
=
-
	
(6.171)
	
12
21
22
21
22
(
)
dc
x
dc
cc
cc
dc
T
S S
S
S
S
=
-
	
(6.172)
	
12
21
22
21
22
(
)
dd
x
dc
cd
cc
dd
T
S S
S
S
S
=
-
	
(6.173)
	
21
11
21
11
21
(
)
cc
x
cc
dd
cd
dc
T
S S
S
S
S
=
-
	
(6.174)
	
21
11
21
11
21
(
)
cd
x
cd
cc
cc
cd
T
S S
S
S
S
=
-
	
(6.175)
	
21
11
21
11
21
(
)
dc
x
dc
dd
dd
dc
T
S S
S
S
S
=
-
	
(6.176)
	
21
11
21
11
21
(
)
dd
x
dd
cc
dc
cd
T
S S
S
S
S
=
-
	
(6.177)
   
22
12
21
21
21
21
21
22
11
21
22
11
21
22
11
21
22
11
21
(
)
cc
x
cc
cc
dd
cc
cd
dc
cc
cc
dd
cc
cd
dc
dc
cc
cd
dc
cd
cc
T
S S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
=
-
-
+
+
-
	
(6.178)
   
22
12
21
21
12
21
21
22
11
21
22
11
21
22
11
21
22
11
21
(
)
cd
x
cd
cc
dd
cd
cd
dc
cd
cc
dd
cd
cd
dc
dd
cc
cd
dd
cd
cd
T
S S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
=
-
-
+
+
-
	
(6.179)
   
22
12
21
21
12
21
21
22
11
21
22
11
21
22
11
21
22
11
21
(
)
dc
x
dc
cc
dd
dc
cd
dc
cd
cc
dd
cd
cd
dc
dd
cc
cd
dd
cd
cc
T
S S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
=
-
-
+
+
-
	
(6.180)
   
22
12
21
21
12
21
21
22
11
21
22
11
21
22
11
21
22
11
21
(
)
dc
x
dc
cc
dd
dc
cd
dc
cc
dc
cd
cc
dd
dc
dc
dc
cd
dc
dd
cc
T
S S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
=
-
-
+
+
-
	
(6.181)
with the common factor
	
21
21
21
21
21
1
1
det
x
cc
dd
cd
dc
S
S
S
S
S
=
=
-
S
	
(6.182)

162 
Microwave Network Design Using the Scattering Matrix
The reverse transformation, transformation of the mixed-mode trans-
mission matrix T
o to the mixed-mode scattering matrix S
o results from (6.150) 
through (6.165). It is given by [11]
	
11
21
11
21
11
(
)
cc
x
cc
dd
cd
dc
S
T T
T
T
T
=
-
	
(6.183)
	
11
21
11
21
11
(
)
cd
x
cd
cc
cc
cd
S
T T
T
T
T
=
-
	
(6.184)
	
11
21
11
21
11
(
)
dc
x
dc
dd
dd
dc
S
T T
T
T
T
=
-
	
(6.185)
	
=
-
11
21
11
21
11
(
)
dd
x
dd
cc
dc
cd
S
T T
T
T
T
	
(6.186)
	
12
22
11
11
22
11
11
12
21
11
12
21
11
12
21
11
12
21
11
(
)
cc
x
cc
cc
dd
cc
cd
dc
cc
cc
dd
cc
cd
dc
dc
cc
cd
dc
cd
cc
S
T T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
=
-
-
+
+
-
 
  (6.187)
	
12
22
11
11
22
11
11
12
21
11
12
21
11
12
21
11
12
21
11
(
)
cd
x
cd
cc
dd
cd
cd
dc
cd
cc
dd
cd
cd
dc
dd
cc
cd
dd
cd
cc
S
T T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
=
-
-
+
+
-
 
(6.188)
	
=
-
-
+
+
-
12
22
11
11
22
11
11
12
21
11
12
21
11
12
21
11
12
21
11
(
)
dc
x
dc
cc
dd
dc
cd
dc
cc
dc
dd
cc
dd
dc
dc
dc
cd
dc
dd
cc
S
T T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
 
(6.189)
	
=
-
-
+
+
-
12
22
11
11
22
11
11
12
21
11
12
21
11
12
21
11
12
21
11
(
)
dd
x
dd
cc
dd
dd
cd
dc
cd
dc
dd
cd
dd
dc
dd
dc
cd
dd
dd
cc
S
T T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
T
   
(6.190)
	
21
11
cc
x dd
S
T T
=
	
(6.191)
	
21
11
cd
x cd
S
T T
= -
	
(6.192)
	
21
11
dc
x dc
S
T T
= -
	
(6.193)
	
21
11
dd
x cc
S
T T
=
	
(6.194)
	
22
11
12
11
12
(
)
cc
x
cd
dc
dd
cc
S
T T
T
T
T
=
-
	
(6.195)

 
Mode Wave Variables and Mixed Mode Scattering Matrix 
163
	
22
11
12
11
12
(
)
cd
x
cd
dd
dd
cd
S
T T
T
T
T
=
-
	
(6.196)
	
22
11
12
11
12
(
)
dc
x
dc
cc
cc
dc
S
T T
T
T
T
=
-
	
(6.197)
	
22
11
12
11
12
(
)
dd
x
dc
cd
cc
dd
S
T T
T
T
T
=
-
	
(6.198)
with the factor
	
11
11
11
11
11
1
1
det
x
cc
dd
cd
dc
T
T
T
T
T
=
=
-
T
	
(6.199)
Figure 6.8 illustrates cascaded connection of mixed-mode two-port  
networks.
The mixed mode transfer scattering matrix of the entire network, of the 
whole cascade is
	
o
o
o
o
1
2
3
TOT =
T
T T T 	
(6.200)
where, according to Figure 6.6, T
o 
1, T
o 
2, and T
o 
3 are the mixed-mode transfer 
scattering matrices of cascaded mixed-mode two-port networks (differential 
two-port networks).
References
  [1]	 Rogers, J. and C. Plett, Radio Frequency Integrated Circuit Design, Norwood, MA: 
Artech House, 2003.
T1
T3
T2
Figure 6.8  Chain connection of mixed mode two-port networks.

164 
Microwave Network Design Using the Scattering Matrix
  [2]	 Eisenstadt, W. R., B. Stenger, and B. M. Thompson, Microwave Differential Circuit 
Design Using Mixed-Mode S-Parameters, Norwood, MA: Artech House, 2006.
  [3]	 Cohn, S. B., “Shielded Coupled-Strip Transmission Lines,” IRE Trans. Microwave 
Theory Tech., Vol. MTT-5, October 1955, pp. 29–38.
  [4]	 Jones, E. M. T., and J. T. Bolljahn, “Coupled-Strip-Transmission-Line Filters and 
Directional Couplers,” IRE Trans. Microwave Theory Tech., Vol. MTT-6, April 1956, 
pp. 75–81.
  [5]	 Bockelman, D. E., and W. R. Eisenstadt, “Combined Differential and Common Mode 
Scattering Parameters: Theory and Simulation,” IEEE Trans. Microwave Theory and 
Techniques, Vol. 43, No. 7, July 1997, pp. 1530–39.
  [6]	 Kurokawa, K., “Power Waves and the Scattering Matrix,” IEEE Trans. Microwave 
Theory and Techniques, Vol. MTT- 13, March 1965, pp. 194–202.
  [7]	 Ferrero, A., and M. Pirola, “Generalized Mixed-Mode S-Parameters,” IEEE Trans. Mi-
crowave Theory and Techniques, Vol. 54, No.1, January 2006, pp. 458–63.
  [8]	 Marks, R. B., and D. F. Williams, “A General Waveguide Circuit Theory,” Jour-
nal of Research of the National Institute of Standards and Technology, Vol. 97, 1992,  
pp. 533–62.
  [9]	 Bockelman, D. E., and W. R. Eisenstadt, “Pure-Mode Network Analyzer for On- 
Wafer Measurements of Mixed-Mode S-Parameters of Differencial Circuits,” IEEE 
Trans. Microwave Theory and Techniques, Vol. 47, No. 7, July 1997, pp. 1071–77.
[10]	 Bockelman, D. E., and W. R. Eisenstadt, “Combined Differential and Common-Mode 
Analysis of Power Spliters and Combiners,” IEEE Trans. Microwave Theory and Tech-
niques, Vol. 43, No. 11, November 1995, pp. 2627–32.
[11]	 Erkens, H., and H. Heuermann, “Mixed-Mode Chain Matrix Scattering Parameters: 
Theory and Verification”, IEEE Trans. Microwave Theory Tech., Vol. 55, No. 8, August 
2007, pp. 1704–07.

165
7
Noise Wave Variables and the  
Scattering Matrix
There are many ways and alternatives for the characterization of noise in lin-
ear microwave networks. The most commonly used representations of noise 
generated in networks are equivalent voltage or current sources, or a combi-
nation of both. Impedance and admittance matrix representations, chain ma-
trix representation, and few others are used in computer-aided design (CAD) 
analysis of noisy networks [1–3].
At microwave frequencies, however, a wave representation of noise is 
advantageous. It permits the use of scattering matrices for noise computa-
tions leading to advantages in CAD of microwave networks. The power of 
the wave representation of noise lies in its compatibility with the scatter-
ing matrix description of microwave networks. Noise analysis problems are 
formulated and solved using scattering parameters. Common availability of 
accurate scattering parameter using vector network analyzers contributes to 
the accuracy of noise analysis.
In this chapter we present a definition of the noise wave variables and 
the noise wave representation of noisy microwave networks in the form of 
noise wave correlation matrices. We discuss the chain noise representation, 
cascade matrix noise representation, impedance and admittance matrix noise 
representation, and their mutual interrelations. We state relations that de-
scribe two-port-to-three-port noise wave transformations and transformation 

166 
Microwave Network Design Using the Scattering Matrix
formulas for noise wave correlation matrices of embedded multiports. We 
present and discuss relations for noise wave matrices of passive multiports, 
passive multiports embedded by lossy waveguides, and active two-port net-
works. Finally, there are derived relations for deembedding noise wave pa-
rameters of cascaded noisy two-port networks.
7.1  Noise Waves
Noise wave amplitudes are usually defined in terms of noise voltages and 
noise currents. This approach has been presented in [1, 3, 5–11]. There are 
also papers in which wave techniques are used for noise modeling, character-
ization and analysis, but used noise waves are not referenced to noise voltages 
and currents [12–16].
As it will be seen, noise wave representation for microwave networks 
has a lot in common with the description used in deterministic signal analysis 
of microwave networks.
7.1.1  Noise Power Waves
By analogy to signal power waves defined by Kurokawa [4] and presented 
in Chapter 4, amplitudes of ingoing and outgoing noise power waves are 
defined as [5–7]
	
{
}
2
i
Ri i
i
Ri
v
Z i
a
Re Z
+
=
	
(7.1)
and
	
{
}
*
2
i
Ri i
i
Ri
v
Z
i
b
Re Z
-
=
	
(7.2)
where vi is the noise voltage and ii is the noise current at the ith port termi-
nals, and ZRi is the complex reference impedance of the port.
Equations (7.1) and (7.2) are identical to the standard definition of 
power waves for deterministic signals presented in Chapter 4. Variables ai 
and bi are the complex amplitudes of the ingoing and outgoing noise power 
waves, respectively, while the time average square of the absolute value of the 
wave amplitudes, 
2
ia
 and 
2
ib
, are the spectral power densities of these noise 

	
Noise Wave Variables and the Scattering Matrix	
167
waves. It is assumed that the amplitudes of noise waves are approximately 
constant in narrow bandwidth around the frequency of interest.
Application of noise waves defined by (7.1) and (7.2) in network analy-
sis creates some problems. When elements of a network are joined at a reflec-
tionless connection and when the reference impedances at adjoined ports are 
identical it is generally assumed that incident and scattered waves satisfy the 
simple connection low
	
and
i
j
j
i
a
b
a
b
=
=
	
(7.3)
These conditions are the basis of network modeling and of signal flow 
graph analysis. However the connection low (7.3) does not apply to power waves 
with complex reference impedances. The connection low is satisfied only when 
the reference impedances of adjoined ports are complex conjugate.
If noise power wave amplitudes are defined with the assumption that 
the reference impedance ZRi of a port is real; that is [8, 9]
	
2
i
Ri i
i
Ri
v
Z i
a
Z
+
=
	
(7.4)
and
	
i
2
i
Ri
i
Ri
v
Z i
b
Z
-
=
	
(7.5)
the problem with the connection low is solved because it is satisfied as long as 
the reference impedances of connected ports are identical.
7.1.2  Noise Pseudowaves
An alternative wave representation of noise in microwave networks are, related 
to noise voltage and noise current, noise pseudowaves defined as [17, 18]
	
{
}
0
0
Z
Z
2
Ri
i
i
Ri i
i
i
Ri
Re
v
v
Z i
a
v
+
=
	
(7.6)
and
	
{
}
0
0
Z
Z
2
Ri
i
i
Ri i
i
i
Ri
Re
v
v
Z i
b
v
-
=
	
(7.7)

168 
Microwave Network Design Using the Scattering Matrix
These definitions of noise waves allow for complex characteristic and 
reference impedances, preserve the connection low and the essential features 
of the classical microwave network theory.
Equations (7.6) and (7.7) are identical to the standard definitions of 
pseudowaves for deterministic signals discussed in Chapter 4.
7.2  Noise Wave Representation of Microwave Networks
In the noise wave representation, a network element’s noise is described using 
waves that emanate from its ports [5, 11].
As shown in Figure 7.1, noise generated in a two-port network is repre-
sented by two noise wave sources c1 and c2, one source at each port of the two-
port. Because the port noise wave sources arise from the same internal noise 
sources, in general they are correlated. The linear matrix equation describing 
the noisy two-port has a form
	
1
11
12
1
1
2
21
22
2
2
b
S
S
a
c
b
S
S
a
c
é
ù
é
ùé
ù
é
ù
=
+
ê
ú
ê
úê
ú
ê
ú
ë
û
ë
ûë
û
ë
û	
(7.8)
The noise wave sources c1 and c2 representing noise generated in a two-
port are time-varying complex variables. A physically significant descrip-
tion of noise sources existing in the equivalent circuits of noisy multiports is 
given by their self- and crosspower spectral densities that are defined as the 
Fourier transform of their auto- and crosscorrelation functions. Arranging 
these spectral densities in matrix form leads to the so-called noise correlation  
matrices [5, 6].
a1
a2
b1
b2
c1
c2
Two-port
Figure 7.1  A noisy two-port with noise waves ingoing and outgoing at its ports.

	
Noise Wave Variables and the Scattering Matrix	
169
In a case of a two-port network the noise wave sources c1 and c2 are 
characterized by a correlation matrix CS given by
	
2
1
1 2
1
1
1 1
1 2
2
2
2
2 1
2
2 1
2 2
*
*
*
*
*
*
c
c c
c
c
c c
c c
c
c
c c
c
c c
c c
+
é
ù
é
ù
é
ùé
ù
ê
ú
ê
ú
=
=
=
ê
úê
ú
ê
ú
ê
ú
ë
ûë
û
ë
û
ë
û
S
C
	
(7.9)
where the overbars indicate time averaging, + is the Hermitian conjugate, and 
* is the complex conjugate. The diagonal terms of CS give the noise power 
deliverable to the matched noiseless terminations of ports in a 1-Hz band-
width. The off diagonal terms are correlation products. The noise wave cor-
relation matrices CS are Hermitian matrices. Their components are referred 
to as noise wave parameters.
In the general multiport case, noise generated in a network is repre-
sented by correlated noise wave sources, one source at each port. The matrix 
equation for the noise wave representation of a linear noisy multiport net-
work is
	
=
+
b
Sa
c	
(7.10)
where S denotes the scattering matrix of the multiport
1
2
[
...
]T
n
a a
a
=
a
 — a vector of the port incoming noise waves;
1 2
[
...
]T
n
b b
b
=
b
 — a vector of the port outgoing noise waves;
1 2
[
....
]T
n
c c
c
=
c
 — a vector of the port noise wave sources.
The noise wave correlation matrix CS of a multiport network is given 
by
	
2
1
1 2
1 3
1
2
2 1
2
2 3
2
2
3 1
3 2
3
3
2
1
2
3
*
*
*
...
*
*
*
...
*
*
*
...
:
:
:
.
:
*
*
*
...
n
n
S
n
n
n
n
n
c
c c
c c
c c
c c
c
c c
c c
c c
c c
c
c c
c c
c c
c c
c
+
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
=
= ê
ú
ê
ú
ê
ú
ê
ú
ë
û
C
cc
	
(7.11)
For each noise wave ci the diagonal element 
2
ic
 yields a value for the 
noise power deliverable to the matched termination given in terms of statisti-
cal expectation of ci if all terminations were reflectionless and noiseless. For 

170 
Microwave Network Design Using the Scattering Matrix
the diagonal element it is possible to introduce a characteristic noise tempera-
ture associated with each port
	
2
i
i
c
kT
=
	
(7.12)
where k  is Boltzmann’s constant.
The off-diagonal element yields a correlation product of a port noise 
wave source with each of the other port noise wave source, given by 
*
i j
c c . We 
can write
	
*
i j
i
j
ij
c c
k TT ρ
=
	
(7.13)
The absolute value of the correlation coefficient ρij can range from 0 to 1.
Scattering parameters as well as noise wave parameters of a linear mul-
tiport network are frequency dependent. Full characterization of signal and 
noise properties of a multiport requires knowledge of the scattering matrix 
and of the noise wave correlation matrix at each frequency of interest.
Noise correlation matrices are Hermitian matrices because
	
Im{cii} = 0  for i = 1,2, …,n	
(7.14)
and
	
*
ij
ji
c
c
=
  for   i, j = 1,2,…,n	
(7.15)
In the case of linear noisy two-ports their noise properties are fully de-
scribed by four real numbers
	
{
}
{
}
11
22
12
12
,
,
and 
c
c
Re c
Im c
	
(7.16)
Another very important property of these matrices is that they are posi-
tive semidefinite, that is
	
11
22
0  and  
0
c
c
³
³ 	
(7.17)
and
	
2
11 22
12
det 
0
c c
c
=
-
³
S
C
	
(7.18)
Noise correlation matrices have been known for years [19, 20]. In 1975 
H. Hillbrandt and P. Russer [21] and K. Reiss [22] proved their importance 
for the analysis of linear noisy networks.

	
Noise Wave Variables and the Scattering Matrix	
171
7.3  Other Noise Representations of Noisy Networks and Their 
Transformations to Noise Wave Parameters
7.3.1  Chain Matrix Noise Representation
The classical W. Rothe and W. Dahlke approach allows representing an arbi-
trary noisy two-port network as its noiseless equivalent and a pair of external, 
equivalent noise sources that are mutually correlated.
Figure 7.2(a) illustrates the Rothe and Dahlke equivalent circuit of a noisy 
two-port network [23]. It uses two external, input port noise sources en and in. 
Because the primary physical noise sources existing inside the circuit contribute 
to the equivalent external noise sources, en and in are not statistically indepen-
dent. The equations describing this noise representation have the form
	
1
2
1
2
n
n
v
A
B
v
e
i
C
D
i
i
é
ù
é
ù é
ù
é
ù
=
-
ê
ú
ê
ú ê
ú
ê
ú
-
ë
û
ë
û ë
û
ë
û	
 (7.19)
where ABCD are the chain matrix parameters.
a1
v1
a2
v2
b1
b2
c1
c2
Two-port
v´1
i´1
i 1
in
en
i 2
Two-port
(b)
(a)
Figure 7.2  The schematic representation of noisy two-ports: (a) using the chain matrix 
and the equivalent noise current and voltage sources, both located at the input 
port, and (b) using the scattering matrix and noise wave sources located at the 
input port and at the output port.

172 
Microwave Network Design Using the Scattering Matrix
The noise correlation matrix for chain matrix representation is
	
2
2
*
*
*
*
*
*
n
n n
n
n
n n
n n
n
n
n n
n
n n
n n
e
e i
e
e
e e
e i
i
i
i e
i
i e
i i
+
é
ù
é
ù
é
ùé
ù
ê
ú
ê
ú
=
=
=
ê
úê
ú
ê
ú
ê
ú
ë
ûë
û
ë
û
ë
û
A
C
	
(7.20)
where + denotes the conjugate transpose, * denotes the complex conjugate 
and the overbars time averaging.
Noise parameters for the chain matrix representation of a noisy two-
port network are Rn, gn and ρ, where
	
2
0
4
n
n
e
R
kT df
=
   
2
0
4
n
n
i
g
kT df
=
	
(7.21)
and
	
2
2
*n n
n
n
e i
e
i
ρ =
	
(7.22)
The ABCD-matrix (chain) representation is quit convenient, as it refers 
both noise sources to the input of the two-port. This is very useful if we want 
to describe the noisy network in terms of the noise figure.
7.3.1.1  Interrelation Between Chain Matrix and Power Scattering  
Matrix Noise Representations
The interrelation of the chain matrix and the scattering matrix noise repre-
sentations depends on the applied definition of the noise waves. Because the 
circuit in Figure 7.2(a) fulfills the following relations
	
/
/
1
1
1
1
    and    
n
n
v
v
e
i
i
i
=
+
=
+ 	
(7.23)
Then using definitions of power noise waves and (7.23), we get
	
{
}
{
}
{
}
/
/
1
1
1
1
1
1
/1
1
1
1
1
(
)
2
2
2
R
n
R
n
n
R n
R
R
R
v
Z i
e
v
Z
i
i
e
Z
i
a
a
Re Z
Re Z
Re Z
+
+
+
+
+
=
=
=
+
	
(7.24)

	
Noise Wave Variables and the Scattering Matrix	
173
and
   
{
}
{
}
{
}
/
/
1
1 1
1
1
1
1
/1
1
1
1
1
*
*
*
(
)
2
2
2
R
n
R
n
n
R n
R
R
R
v
Z
i
e
v
Z
i
i
e
Z
i
b
b
Re Z
Re Z
Re Z
-
+
-
+
-
=
=
=
+
	
(7.25)
where
	
{
}
1
1
1
1
2
R
R
v
Z i
a
Re Z
+
=
  and 
{
}
-
=
1
1 1
1
1
*
2
R
R
v
Z
i
b
Re Z
	
(7.26)
Because
	
/
/
11
12
1
1
21
22
2
2
S
S
a
b
S
S
a
b
é
ù
é
ù
é
ù
=
ê
ú
ê
ú
ê
ú
ë
û ë
û
ë
û	
(7.27)
and
	
11
12
1
1
1
21
22
2
2
2
S
S
c
a
b
S
S
c
a
b
é
ù
é
ù
é
ù
é
ù
+
=
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û	
(7.28)
then using relations (7.24) through (7.25), we derive formulas for the noise 
wave sources c1 and c2 as functions of en and in
	
{
}
{
}
1
1
1
11
1
1
*
2
2
n
R n
n
R n
R
R
e
Z
i
e
Z
i
c
S
Re Z
Re Z
+
-
=
-
	
(7.29)
	
{
}
2
21
1
2
n
R n
R
e
Z i
c
S
Re Z
+
=
	
 (7.30)
To derive relations between the noise correlation matrices for the chain 
matrix and for the scattering matrix representations we write equations (7.29) 
and (7.30) in matrix form as
     
{
}
1
1
11
2
21
1
1
1
1
*
0
2
1
R
n
n
R
R
Z
c
S
e
c
S
i
Re Z
Z
é
ù
-
é
ù
é
ù
é
ù
=
=
ê
ú
ê
ú
ê
ú
ê
ú
-
ë
û
ë
û
ë
û
ê
ú
ë
û
c
	
(7.31)

174 
Microwave Network Design Using the Scattering Matrix
from which we receive interrelations between both representations
	
{
}
{
}
{
}
{
}
2
1
1 2
1
1
11
12
2
2
2
21
22
2 1
2
1
1
2
2
1
1
*
*
1
1
2
2
*
1
1
4
4
*
S
S
S
S
n
n
n
n
R
R
n
n n
A
R
R
n n
n
c
c c
c
c
C
C
c
c
C
C
c c
c
e
e
i
i
Re Z
Re Z
e
e i
Re Z
Re Z
e i
i
+
+
+
+
+
+
+
+
+
é
ù
é
ùé
ù
é
ù
ê
ú
=
=
=
=
ê
úê
ú
ê
ú
ê
ú
ë
ûë
û
ë
û
ë
û
é
ùé
ù
=
ê
úê
ú
ë
ûë
û
é
ù
ê
ú
=
=
ê
ú
ë
û
S
C
cc
P R
R P
P R
R P
P R C R P






	
(7.32)
where CS is the power noise wave correlation matrix for the power scattering 
matrix representation, and CA is the noise correlation matrix for the chain 
matrix representation. According to (7.31) the transformation matrices P 
and R are
	
11
21
1
0
S
S
-
é
ù
= ê
ú
ë
û
P
  and 
1
1
*
1
R
R
Z
Z
é
ù
= ê
ú
-
ê
ú
ë
û
R
	
(7.33)
The relation reversed to (7.32) has the form
	
{
}
1
1
1
4Re
(
) (
)
R
Z
-
-
+ -
+ -
=
1
1
A
S
C
R
P
C
P
R


	
(7.34)
7.3.1.2  Interrelation Between the Chain Matrix and the Pseudoscattering  
Matrix Noise Representations
Using definitions of noise pseudowaves given by (7.6) and (7.7) and applying 
the same approach, we receive
	
1
1
11
1
2
21
1
1
1
0
1
R
n
n
R
Z
c
S
e
U
c
S
i
Z
é
ù
-
é
ù
é
ù
é
ù
=
ê
ú
ê
ú
ê
ú
ê
ú
-
ë
û
ë
û
ë
û
ë
û
	
(7.35)
where
	
{
}
1
1
1
1
1
2
R
o
o
R
Re Z
v
U
v
Z
=
	
(7.36)

	
Noise Wave Variables and the Scattering Matrix	
175
Finally using (7.35) we have
   
{
}
2
1
1
2
1
1
4
R
A
A
R
Re Z
U
Z
+
+
+
+
+
=
=
=
S
C
cc
P R C R P
P R C R P
	
(7.37)
where the transformation matrices P and R have now the forms
	
11
21
1
0
S
S
-
é
ù
= ê
ú
ë
û
P
  and 
1
1
1
R
R
Z
Z
é
ù
= ê
ú
-
ë
û
R
	
(7.38)
7.3.2  Cascade Matrix Noise Representation
In Figure 7.3 we present the cascade matrix noise representation for a two-
port network. Here both noise wave sources are located at the input port of 
the network. Circuit equation of a noisy two-port described by the cascade 
matrix T has the form
	
1
2
1
2
n
n
b
a
b
a
b
a
é
ù
é
ù
é
ù
=
+
ê
ú
ê
ú
ê
ú
-
ë
û
ë
û
ë
û
T
	
(7.39)
where an and bn are two noise pseudowave sources representing noise gener-
ated in the two-port.
The noise correlation matrix for cascade matrix is
	
2
T
2
*
*
n
n n
n
n
n
n
n n
n
a
a b
a
a
b
b
a b
b
+
é
ù
-
-
-
é
ùé
ù
ê
ú
=
=
ê
úê
ú
ê
ú
ë
ûë
û
-
ë
û
C
	
(7.40)
a1
an
a2
b1
bn
b2
T
Figure 7.3  Cascade matrix noise representation.

176 
Microwave Network Design Using the Scattering Matrix
7.3.2.1  Interrelation Between the Chain Matrix and the Cascade  
Matrix Noise Representations
Using the noise equivalent circuit for chain matrix noise representation 
shown in Figure 7.4, we are able to derive noise waves an and bn correspond-
ing to the cascade matrix noise representation. The interrelation of the chain 
matrix and the cascade matrix noise representations depends on the applied 
definition of the noise waves.
For noise pseudowaves defined by (7.6) and (7.7), we have
{
}
{
}
1
1
01
01
/
/
1
1 1
1
01
1
01
1
1
1
(
)
(
)
2
2
R
R
n
R
n
R n
R
R
Re Z
Re Z
v
v
a
v
Z
i
e
Z
i
v
Z
v
Z
=
+
=
+
	
(7.41)
and
{
}
{
}
1
1
01
01
1
1 1
1
01
1
01
1
1
1
(
)
(
)
2
2
R
R
n
R
n
R n
R
R
Re Z
Re Z
v
v
b
v
Z
i
e
Z
i
v
Z
v
Z
=
-
= -
-
	
(7.42)
Equations (7.41) and (7.42) may be written in matrix form
	
1
1
1
1
1
1
2
n
R
n
n
R
n
a
Z
e
U
b
Z
i
-
é
ù
é
ù é
ù
= -
ê
ú
ê
ú ê
ú
-
ë
û
ë
û ë
û	
(7.43)
where
	
{
}
1
01
1
01
1
R
R
Re Z
v
U
v
Z
=
	
 (7.44)
an
in
v´1
v1
i´1
i1
bn
en
ZR1
ZR1
Figure 7.4  Circuit model of noisy two-port described by the chain matrix loaded at both 
ports by the matched terminations ZR.

	
Noise Wave Variables and the Scattering Matrix	
177
From (7.43) and (7.44), we receive
	
2
2
1
2
*
1
4
*
n
n n
n
n
T
A
n
n
n n
n
a
a b
a
a
U
b
b
a b
b
+
+
é
ù
-
-
-
é
ùé
ù
ê
ú
=
=
=
ê
úê
ú
ê
ú
ë
ûë
û
-
ë
û
C
RC R
	
(7.45)
where R is given by (7.38).
The same relations for the power noise waves are
	
{
} (
)
{
}
1
/
/
1
1 1
1
1
1
1
*
(
)
2
2
R
n
R
n
R
n
R
R
Re Z
a
v
Z
i
e
Z
i
Z
Re Z
=
+
=
+
	
(7.46)
	
{
} (
)
{
}
1
1
1 1
1
1
1
1
*
(
)
2
2
R
n
R
n
R
n
R
R
Re Z
b
v
Z
i
e
Z
i
Z
Re Z
=
-
= -
-
	
(7.47)
In matrix form (7.46) and (7.48) are
	
{
}
1
1
1
1
1
2
n
R
n
R
n
R
n
R
a
Z
e
Re Z
b
Z
i
Z
-
é
ù
é
ùé
ù
= -
ê
ú
ê
úê
ú
-
ë
û
ë
ûë
û	
(7.48)
From (7.48), we get
   
{
}
+
+
é
ù
-
-
-
é
ù é
ù
ê
ú
=
=
=
ê
ú ê
ú
ê
ú
ë
û ë
û
-
ë
û
2
1
2
2
1
*
1
4
*
n
n n
n
n
R
T
A
n
n
R
n n
n
a
a b
a
a
Re Z
b
b
Z
a b
b
C
RC R
	
(7.49)
where R is given by (7.38).
7.3.2.2  Interrelation Between the Chain (Transfer Scattering) Matrix Noise  
Representation and the Scattering Matrix Noise Representations
We assume now matched and noiseless loads at both ports of the network in 
Figure 7.2(b) and of the network in Figure 7.3. From the network presented 
in Figure 7.3 we get
	
1
11 n
n
b
S a
b
=
+
	
(7.50)
	
2
21 n
b
S a
=
	
(7.51)

178 
Microwave Network Design Using the Scattering Matrix
or
	
1
12 2
n
b
T b
b
=
+
	
(7.52)
	
22 2
0
n
T b
a
=
-
	
(7.53)
Because both noise representations presented in Figure 7.2(b) and in 
Figure 7.3 are equivalent, then b1 = c1 and b2 = c2. From (7.50) and (7.51), 
we receive
	
1
21
11
2
21
1
0
0
n
n
a
c
S
b
S
c
S
é
ù
-
ê
ú
-
é
ù
é
ù
ê
ú
=
ê
ú
ê
ú
ê
ú
ë
û
ë
û
-
ê
ú
ë
û
	
(7.54)
Using (7.54), we receive interrelation between noise correlation matri-
ces for the scattering matrix and the cascade matrix two-port representations
	
CT = PCSP+	
(7.55)
where
	
21
11
21
1
1
1
S
S
S
é
ù
-
ê
ú
ê
ú
=
ê
ú
-
ê
ú
ë
û
P
	
(7.56)
The reverse relation we find using (7.52) and (7.53). We have
	
12
1
22
2
22
1
1
0
n
n
T
c
a
T
c
b
T
é
ù
-
ê
ú -
é
ù
é
ù
ê
ú
=
ê
ú
ê
ú
ê
ú
ë
û
ë
û
-
ê
ú
ë
û
	
(7.57)
and finally the interrelation between noise correlation matrices for the cas-
cade matrix and scattering matrix network representations
	
S
T
T T
+
=
C
P C P 	
(7.58)

	
Noise Wave Variables and the Scattering Matrix	
179
where
	
12
22
22
1
1
0
T
T
T
T
é
ù
-
ê
ú
ê
ú
=
ê
ú
-
ê
ú
ë
û
P
	
(7.59)
7.3.3  Impedance Matrix and Admittance Matrix Noise Representations
Figure 7.5 presents the impedance matrix and the admittance matrix noise 
representations of noisy multiports. The use of multiple noise representations 
for noise analysis has been shown in [1, 5]. Transformations are used to sim-
plify calculations, or to avoid singularities.
The family of relations describing transformations between wave, im-
pedance, and admittance noise parameters are given below.
Circuit equation using admittance matrix Y of a noisy multiport with 
N ports has a form
	
n
=
+
i
Yv
i 	
(7.60)
where
	
n
1
2
3
[
. . . .
] T
n
n
n
nN
i
i
i
i
=
i
	
(7.61)
is a vector of equivalent noise currents sources referenced to each port.
Noise current correlation matrix
	
n n+
=
Y
C
i i 	
(7.62)
Figure 7.5  (a) Impedance matrix noise representation, and (b) admittance matrix noise 
representation.

180 
Microwave Network Design Using the Scattering Matrix
In the case of impedance matrix representation of a multiport, the net-
work equation is
	
n
=
+
v
Zi
v 	
(7.63)
where
	
n
1
2
3
[
. . . .
] T
n
n
n
nN
v
v
v
v
=
v
	
(7.64)
is a vector of equivalent noise voltage sources referenced to each port.
Noise voltage correlation matrix
	
Z
n
n+
=
C
v v 	
(7.65)
The interrelation between CY  and CZ has the form
	
Z
Y
+
=
C
ZC Z 	
(7.66)
and
	
Y
Z
+
=
C
Y C Y 	
(7.67)
Interrelation between admittance matrix and power scattering matrix 
noise representations
	
+
1
1
1
1
1
cc
[
][
]
[
]
[
]
4
S
SC
SC
Y
SC
SC
-
-
- +
- +
+
=
=
- G
G
-
G
-
- G
C
I
S
I
F C F
I
I
S
	
(7.68)
where
	
æ
ö
G
=
-
ç
÷
è
ø
diag
*
Ri
SC
Ri
Z
Z
	
(7.69)
	
{
}
1
diag
2
Ri
Re Z
æ
ö
=
ç
÷
è
ø
F
	
(7.70)
I is the init matrix and ZRi is the reference impedance of the ith port.

	
Noise Wave Variables and the Scattering Matrix	
181
When the reference impedances of all ports are the same and real GSC = 
- I and (7.68) simplifies to
	
(
)
(
)
4
R
S
Y
Z
+
=
+
+
C
I
S C
I
S
	
(7.71)
7.3.3.1  Interrelation Between Admittance Matrix and Pseudoscattering  
Matrix Noise Representations
	
1[
]
[
]
4
S
R
Y
R
+
+
+
+
=
=
+
+
C
cc
I
S UZ C Z U
I
S
	
(7.72)
where
	
{
}
0
0
diag
Ri
i
i
Ri
Re Z
v
v
Z
æ
ö
=
ç
÷
è
ø
U
	
(7.73)
	
diag(
)
R
Ri
Z
=
Z
	
(7.74)
When the reference impedances of all ports are the same and real (7.72) 
simplifies to (7.71).
7.4  Noise Modeling of Microwave Network Elements
7.4.1  Noise Wave Correlation Matrices of Passive Multiport Networks
In general elements of microwave networks can be divided into two groups—
passive and active multiports. Lossy passive multiports generate only thermal 
noise. The noise wave correlation matrix of lossy passive multiport is derived 
directly from its scattering matrix S [8, 14]
	
(
)
S
kT
+
=
-
C
I
SS
	
(7.75)
where k is the Boltzmann’s constant, T - physical absolute temperature of a 
multiport, and I is the identity matrix. 

182 
Microwave Network Design Using the Scattering Matrix
When the lossy multiport is reduces to a one-port network the pseu-
dowave reflection coefficient G replaces the pseudowave scattering matrix S 
in (7.75)
	
(
)
2
2
1
| |
S
C
c
kT
=
=
- G
	
(7.76)
Relations (7.75) and (7.76) are applicable only to the case when the 
ports of passive networks are assumed to be lossless waveguides.
In the case of a passive two-port at physical temperature T, the noise 
wave parameters may be found directly from its S-parameters. Using (7.75), 
we have
	
(
)
2
2
11
11
12
1
S
C
kT
S
S
=
-
-
	
(7.77)
	
(
)
12
11 21
12 22
*
*
S
C
kT S S
S S
= -
+
	
(7. 78)
	
21
12
*
S
S
C
C
=
	
(7. 79)
	
(
)
2
2
22
21
22
1
S
C
kT
S
S
=
-
-
	
(7. 80)
Expressions for the scattering matrix noise wave parameters in terms of 
the cascade matrix parameters are easily obtained from (4.105). Substituting 
these into (7.77) through (7.80), we get
	
(
)
2
2
2
11
22
12
11 22
12 21
2
22
S
kT
C
T
T
T T
T T
T
=
-
-
-
	
(7.81)
	
(
)
12
12
11 21 22
12 21 22
2
22
*
*
S
kT
C
T
T T T
T T T
T
= -
-
+
	
(7.82)
	
21
12
*
S
S
C
C
=
	
(7.83)
	
(
)
2
2
22
22
21
2
22
1
S
kT
C
T
T
T
=
-
-
	
(7. 84)

	
Noise Wave Variables and the Scattering Matrix	
183
To obtain the cascade matrix noise wave parameters in terms of the 
cascade parameters, we use (7.58) and receive
	
2
2
22
11
22
22
2
21
S
T
n
S
C
C
a
C
T
S
=
=
=
	
(7.85)
	
12
22
12
12 22
22
11
12
22
21
21
*
*
*
*
1
*
*
T
n n
S
S
S
S
C
a b
T C
T T C
S
C
C
S
S
= -
=
-
æ
ö
= -
-
ç
÷
è
ø
	
(7.86)
	
21
12
*
T
T
C
C
=
	
(7.87)
	
(
)
{
}
2
2
22
11
12
22
12 12
21 12
2
11
12
22
12 12
11
11
11
S11
S12
S12
22
21
21
21
*
*
2
*
*
*
*
*
T
n
S
S
S
S
S
S
S
S
C
b
C
T
C
C
T
C
T
C
T
C
Re C
T
S
S
S
C
C
C
C
S
S
S
=
=
+
-
+
=
+
-
æ
ö
=
-
-
-
ç
÷
è
ø 	
(7.88)
And finally substituting (7.81) through (7.84) into (7.85) through 
(7.88) we receive the cascade matrix noise parameters in terms of the T- 
parameters of a passive two-port network. These are given by
	
(
)
2
2
11
22
21
1
T
C
kT T
T
=
-
-
	
(7.89)
	
12 22
11 21
12
11
22
*
*
T
T
T
T T
T T
C
kT
C
C
-
= -
	
(7.90)
	
21
12
*
T
T
C
C
=
	
(7.91)
	
(
)
2
2
22
12
11
1
T
C
kT
T
T
=
+
-
	
(7.92)

184 
Microwave Network Design Using the Scattering Matrix
Example 7.1
Consider a lossy transmission line, held at the temperature T, and de-
termine its noise wave correlation matrix.
Solution
Because the pseudoscattering matrix of a transmission line segment is
	
0
0
l
l
e
e
γ
γ
-
-
é
ù
= ê
ú
ê
ú
ë
û
S
	
(7.93)
where g = a + jb, then using (7.77) through (7.80), we receive
	
(
)
(
)
2
2
11
12
1
1
l
S
C
kT
S
kT
e
α
-
=
-
=
-
	
(7.94)
	
12
21
*
0
S
S
C
C
=
= 	
(7.95)
	
(
)
(
)
2
2
22
21
1
1
l
S
C
kT
S
kT
e
α
-
=
-
=
-
	
(7.96)
or
	
2
S
2
1
0
0
1
l
l
e
kT
e
α
α
-
-
é
ù
-
=
ê
ú
-
ê
ú
ë
û
C
	
(7.96)
Using (7.85) through (7.88), we calculate noise wave parameters of a 
lossy transmission line for the cascade matrix representation. We get
	
(
)
2
11
1
l
T
C
kT e α
=
-
	
(7.97)
	
12
21
*
0
T
T
C
C
=
= 	
(7.98)
	
(
)
2
22
1
l
T
C
kT
e
α
-
=
-
	
(7.99)
or
	
α
α
-
é
ù
-
=
ê
ú
-
ê
ú
ë
û
2
2
1
0
0
1
l
T
l
e
kT
e
C
	
(7.100)

	
Noise Wave Variables and the Scattering Matrix	
185
7.4.2  Noise Correlation Matrices of Passive Multiport Networks  
Embedded in Lossy Waveguides
The theory of explicit circuit representation for the noise generated by arbi-
trary passive networks embedded in lossy waveguides has been developed and 
presented in detail by D. F. Williams in [24]. For passive multiport network 
embedded by lossy waveguides equivalent to (7.75), the relation has the form
	
1
[(
)
(
)
(
) (
) ]
2
S
kT
+
+
+
+
=
=
-
+
+
+
-
C
cc
I
S A
I
S
I
S A I
S
	
(7.101)
where
	
1
(
)
R
+ -
+
º
A
Z U X
U 	
(7.102)
In (7.102) U and ZR are matrices defined by (7.73) and (7.74) while X 
is the crosspower matrix whose elements are
	
0
0
1
*
*
nm
wtn
wtm
w n w m
X
dS
v
i
º
´
òe
h
z
	
(7.103)
where ewtm and hwtm are the transverse fields of the mth forward propagating 
mode of the lossy waveguide and vw0m and iw0m are normalizing factors [24].
The total transverse electric field Ewt and magnetic field Hwt are ex-
pressed in terms of the modal voltages vwm and modal currents iwm as
	
¥
=
=
= å
0
1
(
0)
wm
wt
wtm
w m
m
v
z
v
E
e
	
(7.104)
	
¥
=
=
= å
0
1
(
0)
wm
wt
wtm
w m
m
i
z
i
H
h
	
(7.105)
The total power transferred across the reference plane at z = 0 in the 
lossy waveguide is
	
0
0
0
1
1
*
*
wt
wt
z
wn
wm
wtn
wtm
w n
w m
n
m
P
Re
dS
v
i
Re
dS
v
i
=
¥
¥
=
=
æ
ö
=
´
ç
÷
è
ø
é
ù
æ
ö
æ
ö
ê
ú
=
´
ç
÷
ç
÷
ê
ú
è
ø
è
ø
ê
ú
ë
û
ò
å
å
ò
E
H
z
e
h
z
	
(7.106)

186 
Microwave Network Design Using the Scattering Matrix
Using the definition (7.103) of the X matrix the above relation may be 
expressed as
	
(
)
w
w
P
Re
+
=
i Xv
	
(7.107)
The diagonal elements of the matrix X are equal to 1. The off-diagonal 
elements of X, in the presence of loss, are nonzero elements.
In the case a one-port network the relation (7.101) reduces to
   
2
1
*
(1
)
(1
)
(1
) (1
)
2
Sc
cc
c
kT
+
+
+
é
ù
=
=
=
- G
+ G
+
+ G
- G
ë
û
A
A
	
(7.108)
where G is the pseudowave reflection coefficient at the reference place in a 
lossy waveguide.
Assuming simplification of single mode propagation in the lossy wave-
guide, (7.108) simplifies to
	
2
2
R
S
2
Re(Z )
*
Re
[1
2 Im( )]
R
R
c
cc
c
kT
Z
j
Z
é
ù
=
=
=
- G
+
G
ê
ú
ê
ú
ë
û	
(7.109)
Equation (7.109) simplifies to (7.75) when ZR is real.
In the case of the matched load terminating the lossy waveguide rela-
tion, (7.109) becomes
	
2
2
2
(
)
R
S
R
Re
Z
c
c
kT
Z
=
=
	
(7.110)
And finally for matched termination when ZR is real
	
2
Sc
c
kT
=
=
	
(7.111)
7.4.3  Noise Wave Correlation Matrices of Active Two-Port Networks
Noise wave correlation matrices of active two-port networks such as all kinds 
of transistors may be obtained using measured experimental noise parameter 
data or using noise equivalent circuits [26–28].
Example 7.2
Figure 7.6 presents simple noise equivalent model of an intrinsic MOS-
FET chip. The noise properties of an intrinsic transistor are represented 

	
Noise Wave Variables and the Scattering Matrix	
187
by two equivalent noise sources eg and id , one located between gate and 
source and the second one located between drain and source of the 
transistor.
This model uses three parameters, P, R, and C. P is the normalized 
dimensionless term representing the drain noise, R is the similar param-
eter for the gate noise, and C  is the magnitude of the correlation coef-
ficient. The noise parameters of the model are defined as [28]
	
2
0
4
d
m
i
P
kT g df
=
	
(7.112)
	
2
2
2
0
4
gs
gs
m
e
R
C
kT
df
g
ω
=
æ
ö
ç
÷
è
ø
	
(7.113)
and
	
2
2
*g d
d
g
i i
jC
i
i
=
	
(7.114)
Noise contributions of ohmic resistances Rg, Rd, and Rs, external to the 
intrinsic transistor, are determined by physical temperature Ta of a chip and 
may be considered as related to passive multiport network embedding in-
trinsic chip of the transistor. Considering the circuit presented in Figure 7.7, 
vg
eg
g v
m g
id
G
D
S
Figure 7.6  Noise equivalent circuit of a MESFET intrinsic chip.

188 
Microwave Network Design Using the Scattering Matrix
we derive noise pseudowaves c1 and c2 emanating, respectively, from the gate 
port and from the drain port.
Because impedances of loads at both ports of the circuit are equal to the 
reference impedance ZR , the same for both ports, there are no noise waves a1 and 
a2 entering ports of the circuit. According to (7.8) and the definition (7.7) of out-
going noise pseudowaves, the equivalent noise wave sources c1 and c2 are
	
0
1
1
1
1
0
(
)
2
R
R
R
v
Re Z
c
b
v
Z i
v
Z
=
=
-
	
(7.115)
	
0
2
2
2
2
0
(
)
2
R
R
R
v
Re Z
c
b
v
Z i
v
Z
=
=
-
	
(7.116)
Because v1 = -ZR i1 and v2 = -ZR i2 then we have
	
0
1
2
0
R
R
v
Re Z
c
v
v
Z
=
	
(7.117)
	
0
2
2
2
0
R
R
v
Re Z
c
b
v
v
Z
=
=
	
(7.118)
and using (7.9) we determine elements of noise wave correlation matrix for 
scattering matrix representation
	
2
2
11
1
1
2
R
S
R
Re Z
C
c
v
Z
=
=
	
(7.119)
D
G
i1
vg
eg
gmvg
id
S
v1
v2
c1
c2
ZR
ZR
Figure 7.7  Noise equivalent circuit of an intrinsic chip with at all three ports loaded by 
matched impedances.

	
Noise Wave Variables and the Scattering Matrix	
189
	
2
2
22
2
2
2
R
S
R
Re Z
C
c
v
Z
=
=
	
(7.120)
	
12
1 2
1 2
2
*
R
S
R
Re Z
C
c c
v v
Z
=
=
	
(7.121)
Voltages v1 and v2 are derived from the circuit presented in Figure 7.7 as
	
1
1
g
g
g
R
j C
i
e
j C Z
ω
ω
= - +
	
(7.122)
	
1
1
1
g
R
R
g
g
R
j C Z
v
i Z
e
j C Z
ω
ω
= -
=
+
	
(7.123)
	
2
m g
d
i
g v
i
=
+
	
(7.124)
	
2
2
(
)
R
m g
d
R
v
i Z
g v
i
Z
= -
= -
+
	
(7.125)
where
	
1
1
g
g
g
R
v
e
j C Z
ω
= - +
	
(7.126)
In cases when the correlation matrix cannot be derived from theoretical 
considerations, measurements of active networks noise parameters provide 
required information. Suitable measurements techniques are used to obtain 
four noise parameters of active two-port network. These parameters are mini-
mum noise figure Fmin, the equivalent noise resistance Rn, and the optimum 
signal source internal admittance Yopt = Gopt + j Bopt at which the noise figure 
has a minimum value [29]. The other set of four noise parameters of an active 
two-port network is: Fmin, Rn and the optimum reflection coefficient of the 
signal source port Gopt [30]. With these noise parameters estimated, the noise 
pseudowave correlation matrix of the active two-port is given as
	
(
)
{
}
{
}
2
11
11
1
2
11
3
11
n
1
4
2
4
S
c
R C
R
c
opt
R
kT
C
S
F
Z F
Z
Re S
F
Im S
R B
Z
é
=
+
-
ë
-
-
ùû	
(7.127)

190 
Microwave Network Design Using the Scattering Matrix
	
12
11 21
1
21
3
*
*
2
S
C
C
n
opt
R
R
kT
C
S S F
S F
j R B
Z
Z
é
ù
=
-
+
ë
û	
(7.128)
	
21
12
*
S
S
C
C
=
	
(7.129)
	
2
22
21
1
S
C
R
kT
C
S
F
Z
=
	
(7.130)
where
	
1
2
3
2
C
n
c
C
F
R
F
F
=
+
-
	
(7.131)
	
2
(
1)
2
C
R
min
R
n
opt
F
Z
F
Z R G
=
-
-
	
(7.132)
	
(
)
2
2
3
1
C
n
opt
R
F
R
Y
Z
=
-
	
(7.133)
Often, instead of of Rn, the noise parameter N is used. It is defined as
	
4 n
opt
N
R G
=
	
(7.134)
The parameters Fmin and Rn are invariant under lossless transformation. 
It can also be shown that [30]
	
0
1
min
F
N
<
- £
	
(7.135)
7.5  Two-Port to Three-Port Noise Wave Transformation
The two-port scattering matrix parameters of a three terminal device, such as 
BJT, MESFET, and HEMT transistors, with one terminal grounded can be con-
verted to three-port S-parameters when the grounded terminal is used as a third 
terminal. The three terminals are all referred to a common ground. A compli-
mentary noise wave transformation has to be known for evaluation of noise wave 
correlation matrices for transistor equivalent circuits of arbitrary topology.

	
Noise Wave Variables and the Scattering Matrix	
191
In Figure 7.8(a) we present a noisy three-terminal transistor considered 
as a three-port element. It is characterized by the matrix equation
	
/
/
/
/
/
/
1
11
12
13
1
1
/
/
/
/
/
/
2
21
22
23
2
2
/
/
/
/
/
/
3
31
32
33
3
3
b
S
S
S
a
c
b
S
S
S
a
c
b
S
S
S
a
c
é
ù
é
ùé
ù
é
ù
ê
ú
ê
úê
ú
ê
ú
=
+
ê
ú
ê
úê
ú
ê
ú
ê
ú
ê
úê
ú
ê
ú
ê
ú
ê
úê
ú
ê
ú
ë
û
ë
ûë
û
ë
û	
(7.136)
where scattering parameters S’ are the three-port network scattering param-
eters and ci
/ are equivalent noise wave sources associated with each port.
a´1
a´3
Z 3
c´1
c´3
b´1
b´3
an3
(b)
(a)
a´2
c´2
b´2
c1
c2
a 1
b 1
a 2
b 2
Figure 7.8  (a) A noisy tree-port with port 3 terminated with an impedance Z3, and (b) the 
same device with port 3 short-circuited (Z3 = 0).

192 
Microwave Network Design Using the Scattering Matrix
We will consider first a general case when port 3 is terminated with an 
arbitrary impedance Z3. This means that port 3 is terminated by a load with 
a reflection coefficient G3. The termination at port 3 introduces an additional 
noise wave an3 incident on port 3. The considered network is now a two-port 
network.
This new two-port network is characterized by two linear equations
	
/
/
/
/
3 13 31
3 13 32
/
/
1
11
1
12
2
1
/
/
3 33
3 33
1
1
S S
S S
b
S
a
S
a
c
S
S
æ
ö
æ
ö
G
G
=
-
+
-
+
ç
÷
ç
÷
+ G
+ G
è
ø
è
ø
	
(7.137)
	
/
/
/
/
3 23 31
3 23 32
/
/
2
21
1
22
2
2
/
/
3 33
3 33
1
1
S S
S S
b
S
a
S
a
c
S
S
æ
ö
æ
ö
G
G
=
-
+
-
+
ç
÷
ç
÷
+ G
+ G
è
ø
è
ø
	
(7.138)
The quantities in the parentheses give the two-port scattering param-
eters, whereas the noise waves c1 and c2 are
	
3 13
13
/
/
1
1
3
3
3 33
3 33
1
1
n
S
S
c
c
c
a
S
S
G
=
+
+
+ G
- G
	
 (7.139)
	
3 23
23
/
/
2
2
3
3
3 33
3 33
1
1
n
S
S
c
c
c
a
S
S
G
=
+
+
- G
- G
	
 (7.140)
where an3 is the thermal noise wave generated in the passive load Z3 of port 3.
Equations (7.139) and (7.140) may be written in matrix form [24]
   
/1
1
/
/
/
/ /
/
2
3
3
2
3 33
3 33
/3
1
1
1
1
n
n
c
c
c
a
a
c
S
S
c
é
ù
ê
ú
é
ù =
+
=
+
ê
ú
ê
ú
- G
- G
ê
ú
ë
û
ê
ú
ë
û
K
D
K c
D
	
(7.141)
where
	
3 13
13
3 33
/
/
3 23
23
3 33
1
0
1
and
0
1
1
S
S
S
S
S
S
G
é
ù
ê
ú
- G
é
ù
ê
ú
=
= ê
ú
G
ê
ú
ë
û
ê
ú
- G
ë
û
K
D
	
(7.142)

	
Noise Wave Variables and the Scattering Matrix	
193
Using (7.141) we can derive a relation that transforms a three-port 
noise wave correlation matrix CS3 into the two-port noise wave correlation 
matrix CS2
   
1
1
2
/
/
/
/
S3
3
2
2
2
3 33
1
1
S
n
c
c
a
c
c
S
+
+
+
é
ùé
ù
=
=
+
ê
úê
ú
- G
ë
ûë
û
2
C
K C K
D D
	
(7.143)
where
	
+
+
é
ù é
ù
ê
ú ê
ú
é
ù é
ù
=
=
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ë
û ë
û
ê
ú ê
ú
ë
û ë
û
/
/
1
1
1
1
/
/
3
2
2
2
2
2
/
/
3
3
   
S
S
c
c
c
c
c
c
c
c
c
c
C
C
	
(7.144)
and
	
2
2
3
2
(
) 1
2
( )
R
n
R
R
Re Z
a
kT Re Z
jIm
Z
é
ù
é
ù
=
- G
+
G
ê
ú
ë
û
ê
ú
ë
û	
(7.145)
The noise wave parameters of a two-port network obtained by ground-
ing terminal 3 (short circuiting port 3, G3 = -1) of the three-port network 
are obtained from 
	
1
1
/
/
S3
2
2
S
c
c
c
c
+
+
é
ùé
ù
=
=
ê
úê
ú
ë
ûë
û
2
C
K C K
	
(7.146)
with
	
13
33
/
23
33
1
0
1
0
1
1
S
S
S
S
-
é
ù
ê
ú
+
ê
ú
=
-
ê
ú
ê
ú
+
ë
û
K
	
(7.147)
Using (7.146) we can also derive the reverse relation that transforms 
the two-port noise wave correlation matrix CS2 into the three-port noise wave 
correlation matrix CS3.

194 
Microwave Network Design Using the Scattering Matrix
The three-port noise waves are found by using the principle that
	
3
3
/ /
/ /
1
1
*
*
0
i
j
i
j
i
j
c c
c c
=
=
=
=
å
å
	
(7.148)
Since the noise waves in (7.141) are going to be time averaged, we can 
assume that [24]
	
/
/
/
1
2
3
0
c
c
c
+
+
= 	
 (7.149)
From (7.139), (7.140), and (7.149), the three-port noise waves are 
found to be
	
/
/
/
3 13
3 13
13
/1
1
2
3
3
3
3
1
1
1
1
n
S
S
S
c
c
c
a
æ
ö
G
G
=
+
+
+
ç
÷
- G
- G
G -
è
ø
	
 (7.150)
	
/
/
/
3 23
3 23
23
/2
1
2
3
3
3
3
1
1
1
1
n
S
S
S
c
c
c
a
æ
ö
G
G
=
+
+
+
ç
÷
- G
- G
G -
è
ø
	
(7.151)
	
/
/
/
3 33
3 33
33
/3
1
2
3
3
3
3
1
1
1
1
1
1
n
S
S
S
c
c
c
a
- G
- G
-
=
+
-
G -
G -
G -
	
(7.152)
Equations (7.150) through (7.152) can be written in a matrix form
	
[
]
/
3
3
1
1
n
a
=
-
- G
c
Kc
D
	
(7.153)
where
	
(
)
(
)
3
13
3 13
3 23
3
23
3 33
3 33
1
1
1
1
1
1
S
S
S
S
S
S
é + G
-
G
ù
ê
ú
=
G
+ G
-
ê
ú
ê
ú
G
-
G
-
ë
û
K
	
(7.154)
	
13
23
33
1
S
S
S
é
ù
ê
ú
= ê
ú
ê
ú
-
ë
û
D
	
(7.155)

	
Noise Wave Variables and the Scattering Matrix	
195
	
/1
1
/
/2
2
/3
and        
c
c
c
c
c
é
ù
ê
ú
é
ù
=
=
ê
ú
ê
ú
ê
ú
ë
û
ê
ú
ë
û
c
c
	
(7.156)
The three-port network noise wave correlation matrix CS3 can be com-
puted from the two-port network noise wave correlation matrix CS2 using 
the relation
	
2
/ /
3
2
3
2
3
1
1
S
S
n
a
+
+
+
é
ù
=
=
+
ê
ú
ë
û
- G
C
c c
KC
K
DD
	
(7.157)
The three-port network scattering parameters derived from the two-
port network parameters of the network presented in Figure 7.8(a) are
	
3
3 3
/
3 33
,
,
1,2
1
i
j
ij
ij
S S
S
S
i j
S
G
=
-
=
- G
	
(7.158)
	
(
)
2
3 33
/3
1
3
1
1
,
1,2
1
i
ij
j
S
S
S
i
=
- G
=
-
=
- G
å
	
(7.159)
	
(
)
2
3 33
/3
1
3
1
1
,
1,2
1
j
ij
i
S
S
S
j
=
- G
=
-
=
- G
å
	
(7.160)
	
2
2
3
1
1
33
2
2
3
1
1
1
1
3
ij
i
j
ij
i
j
S
S
S
=
=
=
=
- G -
=
- G -
å
å
å å
	
(7.161)
They are found from (7.137) to (7.138) and using the principle that 
[25]
	
3
3
1
1
1
ij
ij
i
j
S
S
=
=
=
=
å
å
	
(7.162)

196 
Microwave Network Design Using the Scattering Matrix
7.6  Noise Wave Correlation Matrices of Embedded  
Multiport Networks
Realistic noise modeling of microwave semiconductor devices requires con-
sideration of parasitic elements embedding an intrinsic chip of the device. 
The embedding circuit composed of parasitic stray capacitances, lead resis-
tances, and inductances is typically passive. It produces only thermal noise. 
Mechanism of noise generation of the intrinsic device is of more complicated 
nature and it is very convenient to consider and model it separately. The ef-
fects of parasitic element circuit on the correlation matrix of the entire device 
may be computed using appropriate embedding formulas [13].
Figure 7.9 presents a noisy multiport subnetwork with the scattering 
matrix S embedded in a noisy subnetwork with scattering matrix T. It is 
assumed that noise properties of both subnetworks are described by their 
noise wave correlation matrices CS and CT, respectively. The noise wave cor-
relation matrix of the resultant network is computed by partitioning ports of 
the embedding subnetwork into two categories: external and internal ports. 
According to this the system of equations
	
=
+
b
Ta
c	
(7.163)
can be written as [13]
	
ee
ei
e
e
e
i
i
i
ie
ii
é
ù
é
ù
é
ù
é
ù
=
+
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û
T
T
b
a
c
b
a
c
T
T
	
(7.164)
S  C
,
S
T  C
,
T
Figure 7.9  Multiport subnetwork with the scattering matrix S and noise correlation matrix CS 
embedded in a noisy subnetwork with the scattering matrix T and noise correlation 
matrix CT.

	
Noise Wave Variables and the Scattering Matrix	
197
where ae, be, ce and ai, bi, ci are vectors of noise waves, respectively, at the 
external and at the internal ports of the subnetwork T.
The embedded subnetwork is described by the system of equations
	
=
+
S
S
S
b
Sa
c 	
(7.165)
The connection of internal ports of the embedding subnetwork T with 
appropriate ports of the subnetwork S impose restrictions on the vectors of 
ingoing and outgoing noise waves in the form
	
i
S
=
a
b 	
(7.166)
	
i
S
=
b
a 	
(7.167)
They come from the assumption that the reference impedances of noise 
pseudowaves at pairs of connected ports are the same or in the case of power 
noise waves that they are the same and real.
From (7.165)–(7.167) and the second equation of (7.164), by first 
eliminating bi, we obtain
	
1
1
1
1
1
S
[
]
[
]
[
]
i
ii
ie
e
ii
ii
i
-
-
-
-
-
=
-
+
-
+
-
a
S
T
T a
I
ST
c
S
T
c 	
(7.168)
and, after eliminating ai from the first equation of (7.164)
	
{
}
1
1
1
1
[
]
[
]
[
]
e
ee
ei
ii
ie
e
ei
ii
S
ei
ii
i
e
-
-
-
-
=
+
-
+
-
+
-
+
b
T
T S
T
T
a
T I
ST
c
T I
ST
Sc
c 	
(7.169)
In (7.169)
	
1
1
[
]
[
]
out
ei
ii
S
ei
ii
i
e
-
-
=
-
+
-
+
c
T I
ST
c
T I
ST
Sc
c 	
(7.170)
is a vector of resultant noise waves of the whole network referred to the ex-
ternal ports.
Using (7.170), the resultant noise wave correlation matrix of the net-
work can be found as [13]
	
[ |
]
[ |
]
net
S
T
+
+
= L
L +
L
L
C
C
I
S C
I
S
	
(7.171)

198 
Microwave Network Design Using the Scattering Matrix
where
	
é
ù
= ê
ú
ë
û
T
cc
cc
C
cc
cc 	
(7.172)
is the noise wave correlation matrix of the subnetwork T, L is the matrix 
given as
	
1
ei
ii
[
]-
L =
-
T I
ST
	
(7.173)
and I is the identity matrix.
7.7  Deembedding Noise Wave Parameters of Cascaded Noisy 
Two-Port Networks
Figure 7.10 illustrates the cascade of two noisy two-port networks. In mi-
crowave noise measurements a common problem is to determine the noise 
parameters of the first two-port network from knowledge of the noise param-
eters of the second noisy two-port network and the total noise parameters of 
both two-port networks in cascade. This is a typical situation in noise mea-
surements where the first two-port network represents the device under test 
(DUT) and the second two-port represent a receiver, whose noise parameters 
are assumed to be known. Here we present relations for accurately deembed-
ding the noise wave parameters of both the first and the second two-port 
network considered in a cascade of two noisy two-ports.
We assume that both two-port networks are described by their cascade 
matrix noise parameters. Then we can write
	
(1)
(1)
(1)
1
2
( )
(1)
(1)
(1)
1
2
n
n
b
a
b
a
b
a
é
ù
é
ù
é
ù
=
+
ê
ú
ê
ú
ê
ú
-
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
1
T
	
(7.174)
T    C,
(1)
(1)
T
T    C,
(2)
(2)
T
Figure 7.10  The cascade of two noisy two-port networks.

	
Noise Wave Variables and the Scattering Matrix	
199
	
(2)
(2)
(2)
1
2
(2)
(2)
(2)
(2)
1
2
n
n
b
a
b
a
b
a
é
ù
é
ù
é
ù
=
+
ê
ú
ê
ú
ê
ú
-
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
T
	
(7.175)
In further considerations we assume that the reference impedances of 
connected ports of cascaded two-ports are the same and that the connection 
is reflectionless. Inserting (7.175) into (7.174), we receive
	
(1)
(2)
(2)
(1)
1
2
(1)
(2)
(1)
(1)
(2)
(2)
(1)
1
2
n
n
n
n
b
a
b
b
a
b
a
a
é
ù
é
ù
é
ù
é
ù
=
+
+
ê
ú
ê
ú
ê
ú
ê
ú
-
-
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û
T
T
T
	
(7.176)
From (7.176) we recognize that
	
(1 2)
(2)
(1)
( )
(1 2)
(2)
(1)
n
n
n
n
n
n
b
b
b
a
a
a
+
+
é
ù
é
ù
é
ù
=
+
ê
ú
ê
ú
ê
ú
-
-
-
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
1
T
	
(7.177)
is a vector representing cascade matrix noise wave sources of the single total 
two-port network (1+2). Using (7.177) and assuming that the noise gener-
ated in two-port 1 is not correlated with that generated by two-port 2, we are 
able to derive expression representing cascade matrix noise wave parameters 
of the two two-port cascade. It is
   
(1 2)
(1 2)
(1 2)
(1 2)
(1 2)
(2)
(1)
(2)
(1)
( )
( )
(2)
(1)
(2)
(1)
n
n
n
n
n
n
n
n
n
n
n
n
b
b
a
a
b
b
b
b
a
a
a
a
+
+
+
+
+
+
+
é
ùé
ù
= ê
úê
ú
-
-
ê
úê
ú
ë
ûë
û
æ
ö æ
ö
é
ù
é
ù
é
ù
é
ù
=
+
+
ê
ú
ê
ú
ê
ú
ê
ú
ç
÷ ç
÷
ç
÷ ç
÷
-
-
-
-
ê
ú
ê
ú
ê
ú
ê
ú
è
ø è
ø
ë
û
ë
û
ë
û
ë
û
T
1
1
C
T
T
	
(7.178)
or finally 
	
(
)
(1 2)
(1)
(1)
(2)
(1)
T
T
T
+
+
=
+
C
C
T C
T
	
(7.179)
where 
(1 2)
+
T
C
 is the resultant noise wave correlation matrix for the two two-
port network cascade, 
(1)
( )
 and 
T
1
C
T
 is the noise wave correlation matrix and 

200 
Microwave Network Design Using the Scattering Matrix
the cascade matrix of the two-port 1, while 
( )
2
T
C
 is the noise wave correlation 
matrix of the two-port 2.
Equation (7.179) may be applied in noise parameter measurements of 
the DUT by measuring the noise wave parameters of the cascade and sepa-
rately, the noise wave parameters of the receiver. The noise parameters of the 
DUT are
	
(
)
(1)
(1 2)
(1)
(2)
(1)
T
T
T
+
+
=
-
C
C
T C
T
	
(7.180)
In (7.180) the two-port network 1 has been deembedded from the  
cascade.
As we see from (7.180), the signal parameters of the receiver do not 
influence noise parameter measurements of the DUT.
Another problem in microwave noise parameter measurements exists 
when one wants to determine the noise parameters of the two-port network 
2 from knowledge of the noise parameters of the cascade and of the two-port 
network 1. Determining 
( )
2
T
C
 from (7.179), we get
	
[
] (
)
1
1
(2)
(1)
(1 2)
(1)
(1)
(
)
T
T
T
-
-
+
+
é
ù
=
-
ë
û
C
T
C
C
T
	
(7.181)
Equation (7.181) gives the noise wave parameters of two-port network 
2, which has been deembedded from the cascade.
References
  [1]	 Engberg, J., and T. Larsen, Noise Theory of Linear and Nonlinear Circuits, Chichester, 
England: J. Wiley & Sons, 1995.
  [2]	 Dobrowolski, J. A., “Computer-Aided Analysis, Modeling and Design of Microwave 
Networks—The Wave Approach,” Norwood, MA: Artech House, 1996.
  [3]	 Dobrowolski, J. A., Introduction to Computer Methods for Microwave Circuit Analysis 
and Design, Norwood, MA: Artech House, 1991.
  [4]	 Kurokawa, K., “Power Waves and the Scattering Matrix,” IEEE Trans. Microwave 
Theory Tech., Vol. MTT-13, March 1965, pp. 194–202.
  [5]	 Penfield, P., “Wave Representation of Amplifier Noise,” IRE Trans. Circuit Theory, 
March 1962, pp. 84–86.
  [6]	 Meys, R. P., “A Wave Approach to the Noise Properties of Linear Microwave Devices,” 
IEEE Trans. Microwave Theory Tech., Vol. MTT-26, January 1978, pp. 34–37.

	
Noise Wave Variables and the Scattering Matrix	
201
  [7]	 Dobrowolski, J. A., “A CAD Oriented Method for Noise Figure Computation of Two-
Ports with Any Internal Topology,” IEEE Trans. Microwave Theory Tech., Vol. MTT-
37, January 1989, pp. 15–20.
  [8]	 Dobrowolski, J. A., “Noise Power Sensitivities and Noise Figure Minimization of Two-
Ports with any Internal Topology,” IEEE Trans. Microwave Theory Tech., Vol. MTT-
39, January 1991, pp. 136–40.
  [9]	 Hiramo, K., and S. Kanema, “Matrix Representations of Noise Figures and Noise Fig-
ure Charts in Terms of Power Wave Variables,” IEEE Trans. Microwave Theory Tech., 
Vol. MTT-16, No. 9, September 1968, pp. 692–99.
[10]	 Hecken, R. P., “Analysis of Linear Noisy Two-Ports Using Scattering Waves,” IEEE 
Trans. Microwave Theory Tech., Vol. MTT-29, October 1981, pp. 997–1003.
[11]	 Withington, S., “Scattered Noise Waves in Microwave and mm Wave Networks,” Mi-
crowave J., June 1989, pp. 169–78.
[12]	 Wedge, S. W., and D. B. Rutledge, “Noise Waves and Passive Linear Multiports,” 
IEEE Microwave Guided Wave Lett., Vol. 1., May 1991, pp. 117–19.
[13]	 Wedge, S. W., and D. B. Rutledge, “Wave Techniques for Noise Modeling and Mea-
surement,” IEEE Trans. Microwave Theory Tech., Vol. MTT-40, November 1992,  
pp. 2004–12.
[14]	 Randa, J., “Noise Characterization of Multiport Amplifiers,” IEEE Trans. Microwave 
Theory Tech., Vol. 49, No. 10, October 2001, pp. 1757–63.
[15]	 Randa, J., “Noise Temperature Measurements on Wafer,” NIST Technical Note 1390, 
March 1997.
[16]	 Randa, J., R. L. Billinger, and J. L. Rice, “On-Wafer Measurements of Noise Tem-
perature,” IEEE Trans. Microwave Theory Tech., Vol. 48, No. 6, December 1999,  
pp. 1259–69.
[17]	 Marks, R. B., and D.F. Williams, “A General Waveguide Circuit Theory,” Journal of Re-
search of the National Institute of Standards and Technology, Vol. 97, 1992, pp. 533–62.
[18]	 Williams, D. F., “Thermal Noise in Lossy Waveguides,” IEEE Trans. Microwave Theory 
Tech., Vol. 44, No. 7, July 1996, pp. 1067–73.
[19]	 Haus, H. A., and R. B. Adler, Circuit Theory of Linear Noisy Networks, New York: John 
Wiley, 1959.
[20]	 Bosma, H., On the Theory of Linear Noisy Systems, Philips Research Reports, Suppl., 
No. 10, 1967.
[21]	 Hillbrandt, H., and P. H. Russer, “An Efficient Method for Computer Aided Noise 
Analysis of Linear Amplifier Networks,” IEEE Trans. Circuits Syst., Vol. CAS-23, April 
1976, pp. 235–38.
[22]	 Reiss, R., “Four-Pole Based Noise Analysis by Digital Computer,” Proc. 1976 Eu-
ropean Conf. on Circuit Theory and Design, Genova, Italy, September 7–10, 1976,  
pp. 632–42.

202 
Microwave Network Design Using the Scattering Matrix
[23]	 Rothe, H., and W. Dahlke, “Theory of Noisy Fourpoles,” Proc. IRE, Vol. 44, June 
1956, pp. 811–18.
[24]	 Grosch, T. O., and L. A. Carpenter, “Two-port to Three-Port Noise Wave Transfor-
mation for CAD Applications,” IEEE Trans. Microwave Theory Tech., Vol. MTT-41, 
September 1993, pp. 1543–48.
[25]	 Bodway, G. E., “Circuit Design and Characterization of Transistors by Means of Tree-
Port Scattering Parameters,” Microwave J., May 1968, pp. 55–63.
[26] 	 Froelich, R. K., “An Improved Model for Noise Characterization of Microwave 
GaAs FET’s,” IEEE Trans. Microwave Theory Tech., Vol. MTT-38, June 1990,  
pp. 703–706.
[27]	 Pospieszalski, M. W., “Modeling of Noise Parameters of MESFET’s and MODFET’s 
and their Frequency and Temperature Dependence,” IEEE Trans. Microwave Theory 
Tech., Vol. 37, September 1989, pp. 1340–50.
[28]	 Pucel, R. A., H. A. Haus, and H. Statz, “Signal and Noise Properties of Gallium Arse-
nide Microwave Field Effect Transistors,” Advances in Electronics and Electron Physics, 
Vol. 38, New York: Academic Press, 1975.
[29]	 Pospieszalski, M. W., “On the Measurement of Noise Parameters of Microwave Two-
Ports,” IEEE Trans. Microwave Theory Tech., Vol. MTT-34, 1986, pp. 456–58.
[30]	 Wiatr, W., “A Method of Estimating Noise Parameters of Linear Microwave Two-
Ports,” PhD. Dissertation, Warsaw University of Technology, Warsaw, Poland, 1980.
[31]	 Valk, E. C., D. Routledge, and J. F. Vaneldik, et al., “De-Embendding Two-Port Noise 
Parameters Using a Noise Wave Model,” IEEE Trans. Instrumentation and Measure-
ment, Vol. 37, No. 3, June 1988, pp. 195–200.

203
8
Noise Analysis of Multiport Networks
Wave representation of noise discussed in previous chapter allows us to use 
scattering matrices and noise wave correlation matrices in noise analysis of 
microwave networks. The power of the wave representation of noise lies in its 
compatibility with the scattering matrix description of microwave networks. 
This allows noise analysis problems of microwave multiport networks to be 
formalized and solved using scattering parameters. In this chapter noise anal-
ysis methods applicable to two-port and multiport networks are presented. 
One method is based on the connection scattering matrix approach and may 
be used for networks considered as a connection of many multiport elements 
[1, 2]. The second method is applicable to multiport networks loaded by 
many one-port terminations [3, 4]. The noise figure for a multiport network 
is considered and derived as a function of scattering parameters and noise 
matrix as well as of the correlations of the input noise waves. The deriva-
tion of the noise parameter known as the degradation of the signal to noise 
ratio is also demonstrated. Both of these approaches are fully compatible with 
conventional network analysis for deterministic (sinusoidal) excitations pre-
sented in Chapter 5. An illustration of the presented theory includes three ex-
amples in which there are demonstrated in detail noise analysis of a three-port 
differential amplifier, of the four-port network considered as a mixed-mode 
amplifier, and of the balanced amplifier.

204 
Microwave Network Design Using the Scattering Matrix
8.1  Basic Relationships for Noisy Multiport Networks
The IEEE definition of a noise figure for a two-port at a given frequency is 
[5, 6]
	
1
in
ni
ni
in
n
P G
P
P
F
P
P
+
=
= +
	
(8.1)
where Pin = kT0 and Pni is the intrinsic noise output power. In words it is a 
ratio of the total output noise power per unit bandwidth to that portion of 
the output noise power that originates from input noise whose power equals 
kT0, where T0 = 290K. According to the IEEE definition of the noise figure 
F, the (available) noise power of the input port termination must be equal to 
the thermal noise power of the signal generator internal impedance in stan-
dard temperature T0 = 290K.
We can extend this definition for a multiport amplifier case. As in the 
case of a two-port we define the noise figure of a multiport networks as a ratio 
of the total output noise power per unit bandwidth to that portion of the 
output noise power that originates from input noise whose power equals kT0, 
where T0 = 290K. We have
	
( )
( )
1
( )
( )
( )
( )
1
1
1
k
m
m
ni
in
ni
m
k
k
m
m
m
m
in
in
m
m
P
G
P
P
F
P
G
P
G
=
=
=
+
=
= +
å
å
å
	
(8.2)
where k is the number of input ports, G(m) is the power gain between the mth 
input port and the output port (mth signal channel), Pni is the intrinsic noise 
power at the output port, and 
( )
0
m
in
P
kT
=
, T0 = 290K. Following the IEEE 
definition of the noise figure for a two-port we assume here that the input 
noise power at all input ports is kT0 and that the input noise at each physi-
cally separate port is uncorrelated with the input noise at each other port.
In the two-port definition of the noise figure it is assumed that the ter-
mination of the output port is noiseless or in other words that the definition 
does not include noise generated in the output load.
In the definition of the noise figure of the multiport amplifier the same 
convention may be assumed that there is not noise source located in the load 
of the output port.
Assumption that the noise figure should not include noise contribution 
from the output load is not absolute. It should be mentioned here that the 

 
Noise Analysis of Multiport Networks 
205
IEEE definition of the operating temperature does include such contribu-
tions [7].
8.2  Classical Two-Port Network Noise Theory
The noise figure is a useful measure of the noise performance of a network. 
The noise figure determines the degradation in signal-to-noise ratio that a 
network introduces. Very simple and rapid evaluation of how the internal ad-
mittance of signal source effects the noise performance of  a two-port network 
can be performed using equivalent noise model of noisy two-port driven by 
noisy signal source presented in Figure 8.1. This model illustrates the classical 
approach by Rothe and Dahlke that allows us to represent an arbitrary noisy 
two-port network as its noiseless equivalent and a pair of mutually correlated, 
external noise sources en and in .
In this model, all of the noise appears at the input port of the noiseless 
network, so computation of the noise figure may be performed at the input 
to the noiseless two-port. A simple method of noise figure calculation is to 
determine the ratio of the total short-circuit mean square noise current to the 
short-circuit mean square noise current originated from the signal source. If 
we assume that the signal source thermal noise and the noise of the two-port 
are uncorrelated, then the equation for the noise figure is
	
2
2
2
s
n
S n
s
i
i
Y e
F
i
+
+
=
	
(8.3)
or
	
2
2
2
0
* *
*
1
4
n
S
n n
S n n
S
n
S
i
Y e i
Y e i
Y
e
F
kT G
+
+
+
= +
	
(8.4)
where YS = GS + j BS is the internal admittance of the signal source.
iS
in
en
YS
Noiseless
two-port
Figure 8.1  Equivalent noise model of a noisy two-port driven by noisy signal source.

206 
Microwave Network Design Using the Scattering Matrix
Because the numerator of (8.4) may be written in matrix form
	
2
2
2
2
2
*
* *
*
[
1]
1
*
n
n n
S
n
S
n n
S n n
S
n
S
n n
n
e
e i
Y
i
Y e i
Y e i
Y
e
Y
e i
i
é
ù é
ù
ê
ú
+
+
+
=
ê
ú
ê
ú ë
û
ë
û
	
(8.5)
then we finally have
	
(
)
A
0
1
*
2
S
S
F
kT Y
Y
+
= +
+
Y C Y
	
(8.6)
where
	
2
A
2
*
*
n
n n
n n
n
e
e i
e i
i
é
ù
ê
ú
= ê
ú
ë
û
C
	
(8.7)
is the equivalent noise current-voltage correlation matrix and
	
1
S
Y
+
é
ù
= ê
ú
ë
û
Y
	
(8.8)
Once noise of the two-port has been characterized with its four noise  
parameters (
)
2
2
*
*
, 
,
{
} and 
{
}
n
n
n n
n n
e
i
Re e i
Im e i
, we are ready to find general 
conditions for minimizing the noise factor of a noisy two-port. Calculating 
the first derivative of F with respect to the signal source admittance YS and 
setting it equal to 0 gives
	
{
}
2
2
2
2
*
n n
n
S
opt
n
n
Im e i
i
G
G
e
e
æ
ö
ç
÷
=
=
- ç
÷
ç
÷
è
ø
	
(8.9)
and
	
{
}
2
*
n n
S
opt
n
Im e i
B
B
e
=
=
	
(8.10)

 
Noise Analysis of Multiport Networks 
207
The minimum value Fmin of the noise factor corresponding to the op-
timum value Yopt = Gopt + j Bopt of the signal source admittance is found by 
direct substitution of (8.9) and (8.10) into (8.4). We receive
	
{
}
{
}
2
2
2
0
1
*
*
1
2
min
n
n
n n
n n
F
e
i
Im e i
Re e i
kT
æ
ö
æ
ö
= +
-
+
ç
÷
ç
÷
è
ø
ç
÷
è
ø
	
(8.11)
Using (8.9), (8.10), and (8.11), we may express equivalent to (8.4) rela-
tion for the noise factor as
	
2
2
(
)
(
)
n
min
S
opt
S
opt
S
R
F
F
G
G
B
B
G
é
ù
=
+
-
+
-
ë
û	
(8.12)
or
	
2
n
min
S
opt
S
R
F
F
Y
Y
G
=
+
-
	
(8.13)
In (8.12) and (8.13)
	
2
0
4
n
n
e
R
kT
=
	
(8.14)
is the equivalent noise resistance of a two-port.
Using the above relations, the elements of the equivalent noise current-
voltage correlation matrix can be written as
	
2
11
4
A
n
n
C
e
kTR
=
=
	
(8.15)
	
12
0
1
*
*
4
2
min
A
n n
n opt
F
C
e i
kT
R Y
-
æ
ö
=
=
-
ç
÷
è
ø 	
(8.16)
	
21
12
*
A
A
C
C
=
	
(8.17)
	
2
2
22
0
4
A
n
n
opt
C
i
kT R Y
=
=
	
(8.18)

208 
Microwave Network Design Using the Scattering Matrix
where:
Fmin is the minimum noise figure;
Yopt = Gopt + j Bopt is the optimum admittance of the signal source;
=
2
0
4
n
n
R
e
kT df  is the noise resistance of a two-port.
is a set of four noise parameters obtained usually through measurements.
It is easy to notice that entries of any noise correlation matrices dis-
cussed in Chapter 7 depend on 
2
2
*
, 
, and 
n
n
n n
e
i
e i , which means that any 
kind of the noise correlation matrix may be expressed in terms of Fmin, 
Yopt = Gopt + j Bopt, and Rn.
8.3  Noise Figure of a Two-Port Network
The noise figure F may be expressed also as a function of four noise param-
eters Fmin, Gopt, Rn in the domain of the signal source port reflection coeffi-
cient GS. In (8.13), instead of the  signal source admittance YS and optimum 
signal source admittance Yopt, we can use reflection coefficients GS and Gopt by 
substituting
	
1 1
1
S
S
R
S
Y
Z
- G
=
+ G 	
(8.19)
and
	
1
1
1
opt
opt
R
opt
Y
Z
- G
=
+ G
	
(8.20)
GS is the reflection coefficient of signal source port given by
	
R
S
S
R
S
Y
Y
Y
Y
-
G =
+
	
(8.21)
and
	
R
opt
opt
R
opt
Y
Y
Y
Y
-
G
=
+
	
(8.22)
Using (8.19) and (8.20), we have

 
Noise Analysis of Multiport Networks 
209
	
{ }
(
)
{
} (
)
{
}
2
2
2
*
1
1
1 1
1 1
*
*
2
2
1
1
1
2 tan
1
S
S
S
S
S
S
R
S
S
R
S
S
R
R
S
G
Re Y
Y
Y
Z
Z
Im
Re Z
Z
ζ
æ
ö
- G
- G
=
=
+
=
+
ç
÷
+ G
+ G
è
ø
- G
-
G
=
+ G
	
(8.23)
where
	
{
}
{
}
tan
R
R
Im Z
Re Z
ζ =
	
(8.24)
Similarly, using (8.21) and (8.22), we express the quantity 
2
S
opt
Y
Y
-
 
as a function of GS and Gopt :
	
2
2
2
2
2
2
1
1 1
1
1
1
4
1
1
opt
S
S
opt
R
S
R
opt
S
opt
R
S
opt
Y
Y
Z
Z
Z
- G
- G
-
=
-
+ G
+ G
G - G
=
+ G
+ G
	
(8.25)
Substituting (8.23) and (8.25) into (8.13), we get the noise figure as
	
{
} (
)
{
}
2
2
2
4
1
2 tan
1
S
opt
n
min
R
S
S
opt
R
F
F
Re Z
Im
ζ
G -G
=
+
é
ù
- G
-
G
+ G
ê
ú
ë
û
	
(8.26)
When the reference impedance ZR is real we have the very well known 
relation for F [9]
	
(
)
2
2
2
4
1
1
S
opt
n
min
R
S
opt
R
F
F
Z
G -G
=
+
- G
+ G
	
(8.27)
8.3.1  Constant Noise Figure Circles
We will show now that for a fixed value of the noise figure F, (8.26) defines a 
circle in the GS plane. We define first the noise figure parameter N, as

210 
Microwave Network Design Using the Scattering Matrix
	
{
}
2
(
)
1
4
min
R
opt
n
F
F
Re Z
N
R
-
=
+ G
	
(8.28)
For a given set of noise parameters and given value of F, parameter N  is 
a constant. Because from (8.26) and (8.28) we have 
	
{
}
2
2
1
2 tan
S
opt
S
S
N
Im
ζ
G -G
=
- G
-
G
	
(8.29)
Then we can rewrite (8.26) as
	
(
)
{
}
2
2
*
*
2
tan
1
1
1
S
opt
S
opt
opt
S
S
N
N
Im
N
N
N
ζ
G G
+ G G
- G
G
G
-
+
=
+
+
+
	
(8.30)
and
	
{ }
{
}
{
}
{
}
(
)
{
}
2
2
2
2
2
2
tan
1
1
N
1
2
tan
tan
(1
)
opt
opt
S
S
opt
opt
Re
Im
N
Re
Im
N
N
N
N
Im
N
N
ζ
ζ
ζ
æ
ö
æ
ö
G
G
-
G
-
+
G
-
ç
÷
ç
÷
+
+
è
ø
è
ø
+
- G
-
G
+
=
+
	
(8.31)
This result defines the circle of constant noise figure with the center at
	
{
}
{
}
tan
tan
1
1
1
opt
opt
opt
F
Re
Im
N
N
C
j
N
N
N
ζ
ζ
G
G
-
G
-
=
+
=
+
+
+
	
(8.32)
and the radius of
	
(
)
{
}
2
2
2
1
2
tan
tan
1
opt
opt
F
N
N
N
Im
N
r
N
ζ
ζ
+
- G
-
G
+
=
+
	
(8.33)
When the reference impedance ZR is real, (8.32) and (8.33) simplify 
to

 
Noise Analysis of Multiport Networks 
211
	
1
opt
F
C
N
G
=
+
	
(8.34)
and
	
(
)
2
1
1
opt
F
N
N
r
N
+
- G
=
+
	
(8.35)
8.4  Two-Port Network Noise Analysis Using Scattering Matrix
Figure 8.2 presents a two-port noisy network with signal source terminating 
the input port and a load terminating the output port. It is assumed here  
that the load is matched and noiseless. With such assumption the noise wave 
at the output port is
	
1
2
21
2
11
1
S
S
S
c
c
b
S
c
S
G
+
=
+
-
G
	
(8.36)
or
	
11
1
2
21
2
11
21
1
1
S
S
S
S
S
c
c
c
S
b
S
S
-
G
G
+
+
=
-
G
	
(8.37)
The output noise wave originating from the two-port internal noise 
sources is
Figure 8.2  A network model for two-port noise figure calculation.

212 
Microwave Network Design Using the Scattering Matrix
	
11
1
2
21
2
11
21
1
1
S
S
INT
S
S
c
c
S
b
S
S
-
G
G
+
=
-
G
	
(8.38)
while the output noise wave originating from the signal source internal  
impedance
	
2
11
21
1
S
S
S
c
b
S
S
=
-
G
	
(8.39)
In (8.36) through (8.39), GS is the reflection coefficient of the signal 
source port. GS expressed in terms of the signal source internal impedance ZS 
and the reference impedance ZR of the signal source port is
	
-
G
=
+
S
R
S
S
R
Z
Z
Z
Z 	
(8.40)
The noise figure is
	
11
11
1
2
1
2
2INT 2INT
21
21
2
2
2
*
1
1
*
1
1
*
S
S
S
S
S
S
S
S
S
c
c
c
c
b
b
S
S
F
c
b b
-
G
-
G
æ
ö æ
ö
G
+
G
+
ç
÷ ç
÷
è
ø è
ø
= +
= +
	
(8.41)
or, for real reference impedance ZR
	
(
)
2
21
21
11
22
S12
11
11
2
2
21
0
11
2
1
1
1
1
1
S
S
S
S
S
S
S
S
S
S
C
C
Re C
S
S
F
S
kT
S
G
G
ì
ü
+
+
í
ý
-
G
-
G
î
þ
= +
- G
-
G
	
(8.42)
where 
2
2
11
1
22
2
12
1 2*
,
,
c
S
S
S
C
c
C
c
C
c
=
=
=
.
Because we can write
	
1
11
11
1
2
2
21
21
1
1
S
S
S
S
c
S
S
c
c
c
S
S
α
é
ù
-
G
-
G
é
ù
G
+
= G
=
ê
ú
ê
ú
ë
û ë
û
c
	
(8.43)

 
Noise Analysis of Multiport Networks 
213
then
	
(
)
+
+
+
= +
= +
- G
2
2
0
1
1
1
S
S
F
kT
c
S
cc
C
α
α
α
α
	
(8.44)
In the above relations a is a row vector in the form
	
-
G
é
ù
= G
ê
ú
ë
û
11
21
1
S
S
S
S
α
	
(8.45)
The equivalent noise temperature of a two-port network may be ex-
pressed as
	
+
=
- G
2
1
n
S
kT
S
C
α
α
	
(8.46)
In a case of a matched signal source, that is for 
é
ù
G =
= ê
ú
ë
û
21
1
0,
0
S
S
α
 
and
	
2
2
S22
2
2
21
21
S
n
c
C
kT
S
=
=
	
(8.47)
Once the two-port network noise figure has been characterized with 
its four noise parameters (
=
=
=
2
2
11
1
22
2
12
1 2*
,
,
(
)
(
) and
S
S
S
C
c
C
c
Re C
Re c c
=
12
1 2*
(
)
(
)
S
Im C
Im c c
, using (8.44) we are allowed to identify the general con-
ditions for minimizing the noise figure. Taking the first derivative of F with 
respect to the signal source reflection coefficient and setting it equal to zero 
yields [8]
	
2
4
1
1
2
opt
η
η
æ
ö
G
=
-
-
ç
÷
è
ø	
(8.48)
where
	
(
)
2
2
2
1 21
2 11
2
2
11
1 2 21
2
2
22
11
21
S12 21 11
22
11
22 11
12 21
*
*
2
C
S
S
S
S
S
c
c S
c S
c
S
c c S
C
C
S
Re
S S
C
S
C
S
C
S
η
+
-
=
-
+
-
+
=
-
	
(8.49)

214 
Microwave Network Design Using the Scattering Matrix
The noise factor corresponding to this choice is found by direct substi-
tution of (8.48) into (8.42) [8]
	
(
)
(
)
(
)
(
)
2
2
2
2
1 21
2 11
2
2
0
21
2
2
2
22
11
11 21
12 21 11
2
2
0
21
1
1
1
*
1
2
1
1
1
opt
min
opt
S
opt
S
opt
S
opt
opt
c
c S
c S
F
kT
S
C
S
C
S
Re C
S S
kT
S
-
-
G
= +
+ G
+
G
-
G
-
G
= +
+ G
	
(8.50)
and
	
2
11
1
2
0
21
1
4
R
n
Z
S
R
c
c
kT
S
+
=
-
	
(8.51)
In the above relations ZR is real reference impedance.
In terms of Tmin , Gopt , and Rn, the noise wave parameters are [8]
	
(
)
2
11
2
2
11
1
11
2
1
1
1
opt
S
min
opt
kt
S
C
c
kT
S
-
G
=
=
-
+
+ G
	
(8.52)
	
2
2
22
21
2
1
opt
S
min
opt
kt
C
S
kT
æ
ö
G
ç
÷
=
+
ç
÷
+ G
è
ø	
(8.53)
	
21
11
1 2
22
2
21
*
*
*
1
opt
S
opt
ktS
S
c c
C
S
G
= -
+
+ G
	
(8.54)
where
	
0
4
n
R
kT R
kt
Z
=
	
(8.55)
and ZR is the real reference impedance.

 
Noise Analysis of Multiport Networks 
215
Example 8.1
Determine the noise factor of lossy transmission line segment held at a tem-
perature T. Assume that the line is excited by matched signal source.
Solution
Because according to (8.47) for matched signal source
	
22
2
0
21
1
S
C
F
kT S
= +
	
(8.56)
then inserting into (8.56) 
α
-
=
-
2
22
(1
)
l
S
C
kT
e
 and 21
l
S
e α
-
=
, we get
	
2
0
1
1
1
l
T
F
T
e
α
-
æ
ö
= +
-
ç
÷
è
ø	
(8.57)
Defining the loss factor of the transmission line as
	
2
1
l
L
e
α
-
=
	
(8.58)
then the noise figure is
	
0
1
(
1)
T
F
L
T
= +
-
	
(8.59)
If the line is in standard reference temperature T0 = 290K, then 
F = L.
8.5  Noise Analysis of Two-Port Networks Using Noise Waves 
and Cascade (Transfer Scattering) Matrix
Figure 8.3 illustrates a noisy two-port network described by its cascade (trans-
fer scattering) matrix and two equivalent noise wave sources an and bn rep-
resenting internal noise of the two-port network. The two-port network is 
terminated at the input by the signal source and at the output by matched 
and noiseless load. Matrix equation relating pseudonoise waves at ports of 
the two-port are

216 
Microwave Network Design Using the Scattering Matrix
	
1
11
12
2
1
21
22
2
n
n
b
T
T
a
b
a
T
T
b
a
é
ù
é
ùé
ù
é
ù
=
+
ê
ú
ê
úê
ú
ê
ú
-
ë
û
ë
ûë
û
ë
û	
(8.60)
(The minus sign before an occurs because the input port quantity a1 is 
augmented by the noise source an .) 
The noise wave correlation matrix for the T-matrix representation of a 
network is
	
2
T
2
*
*
n
n n
n
n
n
n
n n
n
a
a b
a
a
b
b
a b
b
+
é
ù
-
-
-
é
ùé
ù
ê
ú
=
=
ê
úê
ú
ê
ú
ë
ûë
û
-
ë
û
C
	
(8.61)
It is assumed here that the internal noise of the network is not corre-
lated with thermal noise generated by the signal source. We also assume that 
reference impedances of connected ports are the same and that connectors 
used are reflectionless.
Because equivalent noise sources an and bn are located at the input 1/ of 
noiseless two-port network, we can compute the noise figure there. The noise 
wave at the input port is
	
/1
n
S n
S
a
a
b
c
=
+ G
+
	
(8.62)
where GS is the reflection coefficient of the signal source port.
The input port noise pseudowave originating from the two-port inter-
nal noise sources is
cS
an
bn
ΓS
a1
b1
b´1
Signal
source
Noiseless
two-port
Load
a´1
1
1´
Figure 8.3  A network model for the two-port network noise figure calculation.

 
Noise Analysis of Multiport Networks 
217
	
/
1
n
S
n
INT
a
a
b
=
+ G
	
(8.63)
while the input noise pseudonoise wave originating from the thermal noise of 
the signal source internal impedance 
	
1S
S
a
c
=
	
(8.64)
The noise figure is
	
/
/
1 NT 1
2
1
1
2
2
2
2
*
*
(
)(
)
1
*
*
* *
n
S n
n
S n
I
INT
S
S
S
n
S
n
S n n
S n
n
S
a
a
a
b
a
b
F
c
a a
a
b
b a
b a
c
+ G
+ G
= +
=
+ G
+ G
+ G
=
	
(8.65)
For lossless signal source port waveguide with real reference impedance, 
because 
2
2
(1
)
S
S
c
kT
=
- G
, we can write
	
(
)
2
T11
T22
T12
T12
2
0
*
*
1
1
1
S
S
S
e
S
C
C
C
C
F
F
kT
+ G
- G
+ G
= +
= +
- G
	
(8.66)
In (8.66) 
2
11
T
n
C
a
=
, 
2
22
T
n
C
b
=
, and 
12
*
T
n n
C
a b
= -
 are the elements 
of the noise wave correlation matrix for the cascade matrix representation of 
a network 
Because we can write
	
[ 1
]
n
n
S n
S
n
a
a
b
b
-
é
ù
+ G
= -
G
= G
ê
ú
ë
û
n
	
(8.67)
and
	
2
1
1
0
1
[ 1
]
*
0
1
S
S
S
-
é
ù
é
ù
- G
= -
G
ê
ú
ê
ú
-
G
ë
ûê
ú
ë
û	
(8.68)
then
	
T
0
1
1
F
kT
+
+
G
G
= +
G
G
C
H
	
(8.69)

218 
Microwave Network Design Using the Scattering Matrix
In (8.69)
	
S
[ 1
]
G = -
G
	
(8.70)
and
	
1
0
0
1
é
ù
= ê
ú
-
ë
û
H
	
(8.71)
Standard noise parameters of a two-port network are the minimum noise 
figure Fmin , optimum signal source reflection coefficient 
F
G
= G
opt
j
opt
opt e
, 
and equivalent two-port noise resistance Rn can be expressed also in terms 
of noise wave parameters for the cascade matrix network representation. For 
real reference impedance ZR , equations of the conversion between these pa-
rameters are
	
(
)2
2
11
22
11
22
12
0
1
1
4
2
min
T
T
T
T
T
F
C
C
C
C
C
kT
æ
ö
= +
-
+
+
-
è
ø 	
(8.72)
	
2
11
22
11
22
12
12
1
2
2
T
T
T
T
opt
T
T
C
C
C
C
C
C
æ
ö
+
+
G
=
-
-
ç
÷
è
ø
	
(8.73)
	
{
}
12
arg
opt
T
C
φ
π
=
+
	
(8.74)
	
{
}
2
12
0
1
1
2
4
R
T
n
opt
opt
opt
Z
C
R
Re
kT
é
ù
=
+ G
+
G
ê
ú
ë
û
G
	
(8.75)
where T0 = 290K is the standard reference temperature.
8.5.1  Noise Wave Parameters of Cascade Connected Two-Port Networks
In the case of the cascade connection of two-port networks presented in Fig-
ure 8.4, the resultant cascade matrix is
	
(net)
(1)
(2)
(3)
(
)
N
=
×
×
×× ××
T
T
T
T
T
	
(8.76)
The same fixed value of the reference impedance ZR is assumed at all 
ports throughout the cascade.

 
Noise Analysis of Multiport Networks 
219
Formula for the resultant correlation matrix 
(net)
T
C
 is more complicated. 
Because for the first two two-port networks we have
	
(1)
(2)
(2)
(1)
1
2
(1)
(2)
(1)
(1)
(2)
(2)
(1)
1
2
n
n
n
n
b
a
b
b
a
b
a
a
é
ù
é
ù
é
ù
é
ù
=
+
+
ê
ú
ê
ú
ê
ú
ê
ú
-
-
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û
T
T
T
	
(8.77)
from which comes that 
	
(1 2)
(1)
(1)
(2)
(1)
T
T
T
+
+
=
+
C
C
T C
T
	
(8.78)
It is assumed here that noise generated by two-port 1 is not correlated 
with noise generated by two-port 2.
For the first three two-ports in cascade, we can write
	
(1)
(3)
(3)
(2)
(1)
1
2
(1)
(2)
(3)
(1)
(2)
( )
(1)
(3)
(3)
(2)
(1)
1
2
n
n
n
n
n
n
b
a
b
b
b
a
b
a
a
a
é
ù
é
ù
é
ù
é
ù
é
ù
=
+
+
+
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
-
-
-
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
ë
û
ë
û
1
T
T
T
T
T
T
	
(8.79)
and
	
(1 2 3)
(1)
(1)
(2)
(1)
(1)
(2)
(3)
(2)
(1)
T
T
T
T
+ +
+
+
+
=
+
+
C
C
T C
T
T
T
C
T
T
	
(8.80)
For the whole cascade of N noisy two ports, we have
	
(net)
(1)
(1)
(2)
(1)
(1)
(2)
(3)
(2)
(1)
(1)
(2)
(
1)
(
)
(
1)
(2)
(1)
.....
.....
T
T
T
T
N
N
N
T
+
+
+
-
- +
+
+
=
+
+
+
+
×××
C
C
T C
T
T
T
C
T
T
T
T
T
C
T
T
T
	
(8.81)
In (8.81) 
( )
( )
and 
i
i
T
T
C  indicate, respectively, the cascade matrix and 
the noise wave correlation matrix of the ith two-port in the cascade network 
composed of N two-ports. Subindex + indicates complex conjugate trans-
pose. This formula is true only when noise generated by each two-port in the 
(1)
(2)
(3)
( )
N
Figure 8.4  Cascade of noisy two-ports described by their individual cascade matrices T 
and noise wave correlation matrices CT.

220 
Microwave Network Design Using the Scattering Matrix
cascade is not correlated with noise generated by any other two-port and that 
the same fixed value of the reference impedance ZR is assumed for all ports 
throughout the cascade.
8.6  Noise Analysis of Multielement Multiport Networks Using 
Connection Scattering Matrix Approach
Figure 8.5 presents the equivalent circuit of noisy multiport network with 
noiseless elements and noise pseudowave sources at each port. Each element 
of the network is represented by its noiseless equivalent having the same scat-
tering matrix as the original element while noise generated in each element 
is represented by correlated noise pseudowave sources, one source at each  
port.
In matrix notation, a set of linear equations that relates complex ampli-
tudes of noise pseudo-waves at ports of a network element has a form [1, 2]
	
{ )
( ) ( )
( )
k
k
k
k
=
+
b
S
a
c
	
(8.82)
where S(k) is the scattering matrix of the kth element, a(k) and b(k) are vectors 
of ingoing and outgoing noise pseudowaves at its ports, and c(k) is a vector of 
correlated noise pseudowaves representing noise generated in the kth element 
of the network.
Considering the whole network composed of m elements (multiports), 
we can write a set of linear equations in matrix form
	
=
+
b
Sa
c	
(8.83)
c 3
c 6
c i+1
c 4
c 8
c i
c 7
c 1
c 3
c j
cj+3
cj+2
ci+2
cj+1
cn
c 2
S(1)
S(2)
S(3)
S(  +1)
k
S(  )k
S( )
m
S(4)
Figure 8.5  Equivalent circuit of noisy multiport network.

 
Noise Analysis of Multiport Networks 
221
where
	
(1)
(1)
(1)
(2)
(2)
(2)
( )
( )
( )
( )
( )
( )
:
:
:
:
:
:
k
k
k
m
m
m
é
ù
é
ù
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
=
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
ë
û
ë
û
a
b
c
a
b
c
a
b
c
a
b
c
a
b
c
	
(8.84)
and
	
(1)
(2)
( )
( )
..
..
.
.
.
:
:
.
:
:
:
:
:
.
:
:
:
:
....
...
..
k
m
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
S
0
0
0
0
S
0
S
0
S
0
0
0
S
	
(8.85)
is the block diagonal matrix in which S(k) is the scattering matrix of the k-th 
element, a(k) and b(k) are vectors of incident and reflected noise pseudowaves 
at its ports, and c(k) is the vector of noise pseudowave sources representing 
noise generated in each network element.
Taking into account the connections between the m elements of the 
network, it is necessary to introduce constraints on vectors a and b in the 
form of matrix equation
	
=
b
Ka	
(8.86)
where K is the connection matrix of the network.
Substituting (8.86) into (8.83), we obtain
	
=
Wa
c	
(8.87)
where the coefficient matrix
	
=
-
W
K
S	
(8.88)

222 
Microwave Network Design Using the Scattering Matrix
is called the connection scattering matrix of the network. The right-hand 
side vector c is the vector of the noise wave sources located in each port of the 
network. The solution of the matrix equation (8.87) is the vector of ingoing 
noise pseudowave at all ports of the analyzed network
	
-
=
1
a
W
c	
(8.89)
We are able now to compute a correlation matrix of the incident noise 
pseudowave at all network ports. Using (8.89), we have
	
+
-
+
- +
-
- +
=
=
=
1
1
1
1
N
a a
W
cc W
W
C W
	
(8.90)
In (8.90)
	
+
=
C
cc 	
(8.91)
is the correlation matrix of the noise wave sources representing noise gener-
ated in all network elements.
Because the noise wave sources c(k) of the kth element are uncorrelated 
with those of any other network element, the correlation matrix C is a block 
diagonal matrix of the form [1, 2]
	
(1)
(2)
( )
( )
..
..
..
..
..
:
:
..
.
..
..
:
..
..
:
..
..
..
.
:
..
..
..
S
S
i
S
m
S
+
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
=
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
C
0
0
0
0
C
C
cc
0
C
0
0
0
C
	
(8.92)
in which 
(1)
(2)
( )
,
, .....,
m
S
S
S
C
C
C
 are correlation matrices of the noise wave 
sources of individual network elements and the 0s represent null matrices.
The noise matrix N, given by (8.90), supplemented by the scattering 
matrix, contains full information on the noise parameters of the network.
The diagonal elements of the noise correlation matrix N
	
2
ii
i
N
a
=
	
(8.93)
give the power spectral density of the noise wave entering each port of the 
network. The off-diagonal elements

 
Noise Analysis of Multiport Networks 
223
	
*
ij
i
j
N
a a
=
	
(8.94)
are the correlations between the input noise in different ports.
8.6.1  Noise Figure
If l is the load port number of the analyzed network, then the power spectral 
density of noise entering the load port is
	
N
ll
P
N
=
	
(8.95)
where Nll is the lth diagonal element of the noise matrix N.
The evaluation of Nll can be derived easily from (8.90). In fact, if only 
the lth diagonal element of the noise correlation matrix N is to be deter-
mined, by letting el to be a vector whose elements are all zeros except a 1 in 
position l; that is
	
0
0
1
0
0
l
l
é ù
ê ú
ê ú
ê ú
=
ê ú
ê ú
ê ú
ë û
e
	
(8.96)
we have
	
1
1
1
1
(
)
(
)
(
)
ll
l
l
l
l
l
l
N
+
+
+
-
+ -
+ -
+ -
é
ù
=
=
= ë
û
e Ne
e W
C W
e
W
e
C W
e 	
(8.97)
Relation (8.97) may be also written as
	
ll
N
+
= X CX	
(8.98)
where a vector
	
1
(
)
l
+ -
=
X
W
e 	
(8.99)
is the solution vector of a set of linear equations

224 
Microwave Network Design Using the Scattering Matrix
	
l
+
=
W X
e 	
(8.100)
In (8.100) the coefficient matrix is complex transpose of the connection 
scattering matrix W of the network.
According to the definition of the multiport noise figure give by (8.2), 
this measure in terms of notation given in this section can be written as
	
1
1
1
1
(
)
1
(
)
INT
l
l
A
l
l
F
+
-
+ -
+
-
+ -
= + e W
C
W
e
e W
C
W
e
	
(8.101)
where 
1
2
(1)
(2)
1
( )
2
( )
:
:
:
:
:
:
:
:
..
..
0
:
:
:
:
:
:
..
..
..
..
0
:
:
..
..
..
..
..
0
:
..
..
..
..
..
.....
0
S
S
S
k
S
INT
S
m
S
i
i
i
l
i
i
i
l
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
C
C
C
C
C
	
(8.102)
is the block diagonal noise correlation matrix corresponding to noise wave 
sources generated in network elements. This is the intrinsic noise correlation 
matrix. Zero elements represent no noise power generated in signal genera-
tors and loads. The indices i1, i2, … is indicate port numbers of signal source 
ports and the index l equals to the load port number.
In (8.101) the noise correlation matrix called CA applies to the case 
when noise in the network originates only from noise sources located in all 
signal source ports. In general case the noise from signal source ports may be 
correlated to some degree and also each signal source port may have a dif-
ferent noise temperature. This complication may be contained in the signal 
source ports noise correlation matrix CA.
However, following the definition of noise figure given by (8.2) and as-
suming that uncorrelated noise in a network originates only from the equiva-

 
Noise Analysis of Multiport Networks 
225
lent thermal noise sources located in all signal source ports, the matrix CA 
appearing in the denominator of (8.101) is a diagonal matrix in the form
	
1
2
1
1
2
2
:
:
:
:
:
:
:
:
..
..
:
:
:
:
:
:
..
..
..
..
:
:
..
..
..
..
..
:
..
..
..
..
..
..
0
S
S
i
A
i
S
i
i
i
i
l
i
C
i
C
i
C
l
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
0
0
0
C
0
	
(8.103)
The nonzero elements of this matrix correspond to thermal noise gen-
erated only in signal source ports. All other submatrices and elements in the 
matrix CA are equal zero. By putting 0 on the main diagonal of CINT and CA 
in location ll, we adopt the convention that output noise does not contain 
contribution from the output load.
According to (7.71) the nonzero diagonal elements of CA are
	
(
)
2
0 1
i
ii
C
kT
S
=
-
	
(8.104)
where Sii is the reflection coefficient of the signal source port with port num-
ber i. In (8.102) and (8.103) we assume the same reference noise temperature 
T0 = 290K for all signal source ports. Equation (8.104) is applicable for real 
reference impedance case only.
In a case of complex reference impedance of signal source ports, we 
have
	
2
0
2
(Z ) 1
2
(
)
R
i
R
i
i
R
Re
C
kT Re Z
jIm
Z
ì
ü
ï
ï
é
ù
=
- G
+
G
í
ý
ë
û
ï
ï
î
þ	
(8.105)
where Gi = Sii is the reflection coefficient referenced to complex ZR.
According to (8.101), the noise figure of a multiport depends on the 
reflection coefficients of the signal sources and the load.
The noise figure of a multiport network with many inputs may be ex-
pressed also as

226 
Microwave Network Design Using the Scattering Matrix
	
1
1
1
1
(
)
(
)
TOT
l
l
A
l
l
F
+
-
+ -
+
-
+ -
= e W
C
W
e
e W
C
W
e
	
(8.106)
where
	
+
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
(1)
(2)
( )
( )
(
1)
( )
:
:
:
:
:
:
:
:
..
..
:
:
:
:
:
:
..
..
..
..
:
:
..
..
..
..
..
:
..
..
..
..
..
.....
0
0
0
S
S
i
S
k
S
TOT
k
S
S
m
S
l
l
C
0
0
0
0
C
C
0
C
C
C
C
0
0
C
	
(8.107)
is the block-diagonal matrix corresponding to noise wave sources generated 
in all network elements except the load with the port number l terminating 
the output port. Relations (8.101) and (8.106) for F are equivalent.
It is interesting to realize here that the presented approach for the noise 
analysis of the multiport networks may be also applied to cases when noise 
originating from different signal sources is correlated and also when each 
signal source port may have different noise temperature.
For a two-port amplifier there are four real noise parameters: Fmin , com-
plex Gopt , and N, which is a parameter describing the rate of variation of the 
noise figure F as the value of the signal source reflection coefficient deviates 
from its optimal value. Equivalently, these parameters are the independent 
elements of the intrinsic noise matrix CINT: 
2
2
1
2
1 2*
,
and
c
c
c c  or T1, T2 and a  
complex correlation function 1 2*
c c . For a three-port amplifier we have nine real  
parameters: Fmin , optimum reflection coefficients of two signal sources Gopt1 
and Gopt2, and four rate of F variation parameters. Equivalently, the noise pa-
rameters of three port amplifier are: 
2
2
2
1
2
3
1 2
1 3
2 3
*
*
*
,
,
,
,
, and 
c
c
c
c c
c c
c c .
This set of nine parameters could be expressed also as functions of the 
scattering matrix elements and noise waves.

 
Noise Analysis of Multiport Networks 
227
8.6.2  Signal-to-Noise Ratio
For a two-port network with the temperature of the signal source internal 
impedance equal to the standard noise reference temperature T0 = 290K, 
the noise figure directly defines degradation of the signal to noise ratio. 
For a network with the number of input ports bigger than one the ra-
tio (s/n)in/(s/nout) is not equal to the noise figure F given by (8.101) or 
(8.106). The value of the signal to noise degradation can be determined 
easy using the presented approach of the noise analysis of microwave  
networks.
If we assume that i is the signal source port connected to the input port 
of the signal channel than the output signal power density in the load of 
output port is given by
 
1
1
T
out
S
l
in
l
s
s
-
- +
= e W
A W
e
 
(8.108)
where
	
S
0
0
0
0
..
..
0
0
0
0
..
..
0
0
1
0
..
..
0
0
0
0
..
..
.
.
:
.
.
.
.
.
:
.
.
.
i
i
é
ù
ê
ú
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
A
	
(8.109)
el is given by (8.96) and Sin is the input signal power density.
Because the input noise power density
	
A
in
i
i
n
+
= e C e 	
(8.110)
and the output noise power density in the load with the port number l is
	
1
1
TOT
out
l
l
n
+
-
- +
= e W
C
W
e 	
(8.111)
where CTOT given by (8.107) represents total output noise, then the degrada-
tion of the signal to noise ratio

228 
Microwave Network Design Using the Scattering Matrix
	
1
1
TOT
1
1
A
( / )
( / )
l
in
l
T
out
i
i
S
l
l
s n
s n
+
-
- +
+
-
- +
=
e W
C
W
e
e C e
e W
A W
e 	
(8.112)
The difference between F given by (8.106) and (8.112) lies in the de-
nominators of both formulas. In (8.106) the CA matrix corresponds to inci-
dent noise at all input ports, whereas in (8.112) the A S matrix corresponds to 
the incident noise in the signal channel only.
8.7  Noise Analysis of Multiport Networks
The second approach to the analysis of noisy microwave networks is an  
assumption that a linear network can be represented by a single n ´ n 
scattering matrix S and a vector c representing all internal noise sources. 
As it has been described in Chapter 7, for such network we can write  
[4, 5]
	
=
+
b
Sa
c	
(8.113)
where a and b are vectors of ingoing and outgoing noise wave amplitudes 
and c is a vector of amplitudes of internal noise sources in the multiport 
network.
As mentioned in Section 8.3, here we also assume such a normalization 
that the spectral power density of noise is equal to the square of the absolute 
value of the noise wave amplitude.
One-port terminations of the multiport are characterized by the  
equation
	
L
= G +
a
b
c 	
(8.114)
in which cL is the vector of equivalent noise wave sources of signal sources 
and terminations connected to the ports of the multiport, and G is the n ´ n 
reflection coefficients matrix of signal sources and loads connected to the n 
ports of the multiport. In usual cases G is the diagonal matrix in which ele-
ments Gii are reflection coefficients of one-ports terminating each port of the 
multiport. In general case G may have off-diagonal elements Gij correspond-
ing to a wave emerging from port or mode j and being reflected back into 
port or mode i [3, 4].
Eliminating the vector a from (8.113) and (8.114), we receive the equa-
tion for the outgoing noise wave vector versus the waves of noise sources

 
Noise Analysis of Multiport Networks 
229
	
1
L
[
] [
]
-
=
- G
+
b
I
S
Sc
c 	
(8.115)
The noise wave correlation matrix for outgoing noise waves is
	
+
=
N
bb 	
(8.116)
The diagonal elements of the noise correlation matrix N are equal to 
the power spectral densities of the output noise in respective ports. The off-
diagonal elements are the correlation between the output noise in different 
ports. Using (8.115), we can write [4, 5]
1
1
1
1
L L
1
1
1
1
L
S
[
]
[
]
[
]
[
]
[
]
[
]
[
]
[
]
+
-
+
+
- +
-
+
- +
-
+
- +
-
- +
=
=
- G
- G
+
- G
- G
=
- G
- G
+
- G
- G
N
bb
I
S
S c c
S
I
S
I
S
cc
I
S
I
S
S C S
I
S
I
S
C I
S
	
(8.117)
We have taken into account the obvious fact that the noise waves origi-
nated in the multiport are not correlated with noise waves generated in the 
terminations. The matrix
	
S
*
=
C
cc 	
(8.118)
in (8.117) is the intrinsic noise wave correlation matrix of the multiport net-
work while
	
L
L L+
=
C
c c 	
(8.119)
is the noise correlation matrix for noise waves due to terminations loading 
each port.
The diagonal element of this matrix equals
	
2
0
Lii
Li
ii
C
c
kT A
=
=
	
(8.120)
where Aii = Ti /T0 and T0 = 290K is the standard reference temperature. The 
off-diagonal elements of CL are correlation functions
	
0
*
Li Lj
ij
c c
kT A
=
	
(8.121)
Usually, thermal noise generated in terminations loading each port of 
the network is uncorrelated. In such a case the noise correlation matrix CL is 
the diagonal matrix. The elements of this matrix are given by

230 
Microwave Network Design Using the Scattering Matrix
	
(
)
2
0
1
i
ii
i
T
A
T
=
- G
	
(8.122)
where Gi is the reflection coefficient of the signal source port with port num-
ber i and Ti is the physical absolute temperature of the signal source internal 
impedance.
In the case of complex reference impedance of termination ports we have
	
2
2
0
(
) 1
2
(
)
i
R
ii
R
i
i
R
T
Re Z
A
Re Z
jIm
T
Z
é
ù
é
ù
=
- G
+
G
ê
ú
ë
û
ê
ú
ë
û 	
(8.123)
The interpretation of both terms in (8.117) is very obvious. The first 
term is related to noise generated in the signal sources and terminations con-
nected to the input and output ports of the multiport network while the 
second term is related to the noise generated in the network. In the case when 
all external noise sources are equal to zero, CL = 0, (for example, when tem-
perature of all terminations equals 0K) and the first term in (8.117) vanishes. 
Similarly, a case of noiseless amplifier corresponds to CS = 0, and the second 
term in (5.117) vanishes.
Using (8.120) and (8.121), (8.117) may be written in the form
1
1
1
1
0
S
[
]
[
]
[
]
[
]
kT
+
-
+
- +
-
- +
=
=
- G
- G
+
- G
- G
N
bb
I
S
SAS
I
S
I
S
C I
S
	(8.124)
8.7.1  Noise Figure
In the definition of two-port network noise figure it is assumed that the ter-
mination of the output port is noiseless or in other words that the definition 
does not include noise generated in the output load. In the definition of the 
noise figure of the multiport network, we use the same convention that there 
is not a noise source located in the load of the output port.
With such a definition of the noise figure, we can write it as [4, 5]
	
1
1
1
1
0
S
1
1
0
1
1
S
1
1
0
[
]
[
]
[
]
[
]
[
]
[
]
[
]
[
]
1
1
[
]
[
]
l
l
l
l
l
l
l
l
l
l
kT
F
kT
kT
+
-
+
- +
+
-
- +
+
-
+
- +
+
-
- +
+
-
+
- +
- G
- G
+
- G
- G
=
- G
- G
- G
- G
= +
- G
- G
e
I
S
SAS
I
S
e
e
I
S
C I
S
e
e
I
S
SAS
I
S
e
e
I
S
C I
S
e
e
I
S
SAS
I
S
e
	
(8.125)

 
Noise Analysis of Multiport Networks 
231
where el is a vector whose elements are all zeros except a 1 in position l and l 
is the network output port number.
In a two-port case this relation reduces to the conventional definition of 
the noise figure and it has the form
	
(
)
2
21
21
11
22
S12
11
11
2
2
21
0
11
2Re C
1
1
1
1
1
S
S
S
S
S
S
S
S
S
S
C
C
S
S
F
S
kT
S
G
G
ì
ü
+
+
í
ý
-
G
-
G
î
þ
= +
- G
-
G
	
(8.126)
for real reference impedance ZR.
8.7.2  Signal-to-Noise Ratio
In general, the signal-to-noise ratio degradation is not equal to the noise  
figure given by (8.125). In our consideration we assume that i is the number 
of the signal channel input port and that l is the number of the output port.
The output signal power density at port l is
 
1
1
[
]
[
]
out
S
l
in
l
s
s
+
-
- +
=
- G
- G
e
I
S
A
I
S
e
 
(8.127)
where
	
0
0
0
0
..
..
0
0
0
0
..
..
0
0
1
0
..
..
0
0
0
0
..
..
.
.
:
.
.
.
.
.
:
.
.
.
S
i
i
é
ù
ê
ú
ê
ú
ê
ú
=
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
A
	
(8.128)
where el is a vector whose elements are all zeros except a 1 in position l and  
sin is the input signal power density.
Because the power density of noise entering the signal channel input 
port is

232 
Microwave Network Design Using the Scattering Matrix
	
L L
0
in
i
i
i
i
n
kT
+
+
+
=
=
e c c e
e Ae 	
(8.129)
and the total output noise power density in output port l is given by
	
{
}
+
-
+
- +
-
- +
=
- G
- G
+
- G
- G
1
1
0
1
1
[
]
[
]
[
]
[
]
out
l
l
S
n
kT
e
I
S
SAS
I
S
e
I
S
S I
S
	
(8.130)
where A is the incident noise correlation matrix for the actual network, then 
the degradation factor of the signal to noise ratio is given by
	
{
}
1
1
1
1
0
1
1
0
( / )
( / )
[
]
[
]
[
]
[
]
[
]
[
]
in
out
S
l
l
T
i
i
S
l
l
s n
s n
kT
kT
+
-
+
- +
-
- +
+
-
+
- +
=
- G
- G
+
- G
- G
- G
- G
e
I
S
SAS
I
S
I
S
C I
S
e
e Ae e
I
S
SA S
I
S
e
	
(8.131)
When the signal source is matched (8.131) simplifies to
	
{
}
1
1
1
1
0
1
1
0
( / )
( / )
[
]
[
]
[
]
[
]
[
]
[
]
in
out
S
l
l
S
l
l
s n
s n
kT
kT
+
-
+
- +
-
- +
+
-
+
- +
=
- G
- G
+
- G
- G
- G
- G
e
I
S
SAS
I
S
I
S
C I
S
e
e
I
S
SA S
I
S
e
	
(8.132)
This relation is different to (8.125) because in (8.132) the total output 
noise density is divided by the output noise coming from the incident noise 
in the signal channel only. In (8.125) determining F the total output noise is 
divided by the output noise due to all the incident noise.
In the case when all terminations of the network are matched, (8.132) 
reduces to
	
0
S
0
[
]
( / )
( / )
l
in
l
out
S
l
l
kT
s n
s n
kT
+
+
+
+
= e
SAS
C e
e SA S e
	
(8.133)

 
Noise Analysis of Multiport Networks 
233
Example 8.2
To clarify the multiport noise figure definition, we will consider noise 
properties of the differential amplifier presented in Figure 8.6. It is a 
three-port network with single output and two inputs.
The output signal is proportional to the difference between the sig-
nals at the two input ports. The input waves and the scattering parame-
ters for differential (d) mode and for common (c) mode are defined as
	
1
2
2
d
a
a
a
-
=
	
(8.134)
and
	
1
2
2
c
a
a
a
+
=
	
(8.135)
where a1 and a2 are the noise wave amplitudes relative to the ground of 
the noise waves at the input ports.
The output noise signal amplitude at port 3 of the amplifier is
	
3
3
3
3
d
d
c c
b
S
a
S a
c
=
+
+
	
(8.136)
In the case of a differential amplifier, one might think that the noise in 
the differential mode might correlate with the noise in the common mode 
because they receive contributions from common noise sources, but it is not 
so.
Γ1
Γ2
Γ3
S
1
2
3
Figure 8.6  Differential amplifier with matched signal sources and load.

234 
Microwave Network Design Using the Scattering Matrix
The correlation between the common-mode and differential-mode 
noise waves ac and ad is 
	
2
2
1
2
*
2
c d
a
a
a a
-
=
	
(8.137)
from which we see that it is the difference between the noise wave power 
densities in the two referenced to ground lines. If the two noise wave power 
densities are the same, correlation between differential mode noise wave and 
the common mode noise wave vanishes.
In further considerations we will assume that both input ports as well as 
the output port are loaded with reflectionless terminations. In such case we 
can then write the output noise power density as
	
2
3
31 1
32 2
3
n
S a
S a
c
=
+
+
	
(8.138)
which in the case of uncorrelated noise sources at both input ports is
	
2
2
2
2
2
3
31
1
32
2
3
31 1
32 2
3
[
]
n
S
a
S
a
c
k G T
G T
T
=
+
+
=
+
+
	
(8.139)
where 
2
1
1
T
a
k
=
, 
2
2
2
T
a
k
=
, 
2
3
3
T
c
k
=
, 
2
31
31
G
S
=
 and 
=
2
32
32
G
S
.
Using (8.125) defining multiport noise factor and (8.139) we get
	
2
3
2
2
2
2
31
1
32
2
3
31
32
0
0
1
1
1
(
)
e
c
F
S
a
S
a
T
T
G
G
T
T
= +
+
= +
= +
+
	
(8.140)
which corresponds to the case G = 0 and A = 1.
The value of the noise factor given by (8.140) is not equal to the value 
of the degradation factor of the signal-to-noise ratio. As discussed earlier 
in this chapter this noise measure is given by (8.131) and for reflectionless  

 
Noise Analysis of Multiport Networks 
235
terminations by (8.133). For a differential amplifier with a differential 
mode as the input channel and for T1 = T2 = T0, the relation (8.133) is
	
3
3
0
3
3
3
0
3
0
( / )
(
)
1
1
( / )
in
d
c
c
e
out
d
d
s n
G
G
T
T
G
T
s n
G T
G
T
æ
ö
+
+
æ
ö
=
=
+
+
ç
÷
ç
÷ è
ø
è
ø
	
(8.141)
When the noise waves incident on different input ports of differential 
amplifier are correlated, (8.76) is
	
(
)
3
3
3
0
3
3
0
*
Re
( / )
1
( / )
c
cc
c
d
cd
in
out
d
G
A
S S
A
T
T
s n
s n
G T
é
ù
+
+
ê
ú
ë
û
= +
	
(8.142)
where Acc and Acd are elements of the incident noise wave correlation matrix
	
2
2
*
*
c
c d
c
d
d
a
a a
a a
a
é
ù
ê
ú
= ê
ú
ë
û
A
	
(8.143)
Example 8.3
Let us calculate the noise parameters of a four-port network discussed 
in Chapter 6 that is called the mixed-mode two-port. This network is 
presented in Figure 8.7.
In this network we have two referenced to ground input ports 1 and 
2. They could be considered as two separate input ports of two signals, 
the differential mode and the common mode. Similarly at the output 
we take port 3 and port 4 as the output port for the differential output 
Γ1
Γ2
Γ3
S
1
2
3
Γ4
4
Figure 8.7  Mixed-mode two-port network.

236 
Microwave Network Design Using the Scattering Matrix
mode and as the output port for the common mode. To simplify the 
analysis we consider the case when loads of ports are reflectionless and 
when incident input noise is uncorrelated. In such a case the noise fig-
ure for the port 3 as the output port is
	
2
3
3
2
2
2
2
31
1
32
2
3
31
32
0
0
1
1
1
(
)
e
c
F
S
a
S
a
T
T
G
G
T
T
= +
+
= +
= +
+
	
(8.144)
The same equation determines the noise figure for port 4 as the out-
put port. In (8.144) index 3 must be replaced by 4.
The signal-to-noise degradation factor for uncorrelated input noise is
	
3
3
0
3
3
0
( / )
(
)
( / )
in
d
c
out
d
s n
G
G
T
T
s n
G T
+
+
=
	
(8.145)
For correlated input noise this noise measure is given by
	
(
)
3
3
3
0
3
3
0
*
Re
( / )
1
( / )
c
cc
c
d
cd
in
out
d
G
A
S S
A
T
T
s n
s n
G T
é
ù
+
+
ê
ú
ë
û
= +
	
(8.146)
Comparing (8.144) through (8.146) with (8.140) through (8.142), 
we recognize that they are the same.
Example 8.4
Let us calculate the noise figure and signal-to-noise degradation factor 
of the balanced amplifier that was proposed as a way of providing good 
input port match when an amplifier is tuned for minimum noise figure 
[11]. We consider the balanced amplifier presented in Figure 8.8.
It is assumed here that the input and output 3 dB/900 hybrids are 
ideal (lossless) with the scattering matrices given as
	
0
0
0
0
0
0
0
0
t
q
t
q
q
t
q
t
é
ù
ê
ú
ê
ú
= ê
ú
ê
ú
ë
û
S
	
(8.147)

 
Noise Analysis of Multiport Networks 
237
where 
(
/2)
(1/ 2) j
q
e
θ π
-
=
 and 
(1/ 2) j
t
e θ
=
. Losslessness of these ele-
ments is equivalent to the assumption that we neglect noise produced in 
them. The noise of each of the two component amplifiers is characterized 
by noise wave correlation matrices 
 
 
A
B
S
S
and
C
C . If the component ampli-
fiers are identical their noise wave correlation matrices are equal but the 
noise of the amplifier A is not correlated with noise of the amplifier B.
There are two additional components of output noise in the balanced 
amplifier. This is the thermal noise from the matched terminations lo-
cated at port 2 of the input hybrid and at port 4 of the output hybrid. 
Noise from the termination of port 4 of the output hybrid adds to the 
output noise of the balanced amplifier if the outputs of the component 
amplifiers are not matched. But if the gain of the component amplifies 
is sufficiently large this part of the output noise is negligible.
The output noise wave of the balanced amplifier due to the amplifier 
internal noise sources is
	
1
2
2
21
21
A
B
B
A
i
n
n
b
c t
c q
c qS q
c tS t
=
+
+
+
	
(8.148)
where 
2
nc
 = kT. In (8.148) the first two components originate from 
both component amplifiers while the third and forth term is the ther-
mal noise of the port 3 termination of the input hybrid.
The output noise wave of the balanced amplifier due to the thermal 
noise of the signal source internal impedance is
	
0
21
0
21
a
B
Sb
c qS t
c tS q
=
+
	
(8.149)
where 
2
0
0
c
kT
=
.
T 0
Input
Source
Termination
Termination
Output
T
A
B
Figure 8.8  A balanced amplifier.

238 
Microwave Network Design Using the Scattering Matrix
Using (8.148) and (8.149), we receive
	
(
)
2
2
2
2
2
2
4
2
4
2
2
21
21
2
2
2
0
21
21
21 21
1
1
2
S
i
s
A
B
A
B
A
B
A
B
b
F
b
c
c
t
kT
t
S
q
S
kT tq
S
S
Re
S
= +
æ
ö
æ
ö
+
+
+
ç
÷
è
ø
è
ø
= +
é
ù
+
+
ê
ú
ë
û
	
(8.150)
At hybrid center frequency where 
1
2
t
q
=
=
. Equation (8.150) 
simplifies to
	
(
)
2
2
2
2
2
2
21
21
2
2
2
0
21
21
21 21
2
1
2
A
B
A
B
A
B
A
B
c
c
kT
S
S
F
kT tq
S
S
Re S S
æ
ö
æ
ö
+
+
+
ç
÷
è
ø
è
ø
= +
é
ù
+
+
ê
ú
ë
û
	
(8.151)
And finally assuming that the two component amplifiers are identi-
cal, we have
	
2
2
2
0
0
21
1
2
c
T
F
T
kT S
= +
+
	
(8.152)
References
  [1]	 Rothe, H. and W. Dahlke, “Theory of Noisy Fourpoles,” Proc. IRE, Vol. 44, June 
1956, pp. 811–18.
  [2]	 Dobrowolski, J. A., “A CAD Oriented Method for Noise Figure Computation of Two-
Ports with Any Internal Topology,” IEEE Trans. Microwave Theory Techn., Vol. 37, 
January 1989, pp. 15–20.
  [3]	 Dobrowolski, J. A., Computer-Aided Analysis, Modeling and Design of Microwave Net-
works – the Wave Approach, Norwood, MA: Artech House, 1996.
  [4]	 Randa, J., “Noise Characterization of Multiport Amplifiers,” IEEE Trans. Microwave 
Theory Techn., Vol. 49, No. 10, October 2001, pp. 1757–63.

 
Noise Analysis of Multiport Networks 
239
  [5]	 Randa, J., “Multiport Noise Characterization and Differential Amplifiers,” in 55th 
ARFTG Conf. Digest, Boston, MA, June 2000, pp. 106–115.
  [6]	 Hause, H. A., et al., “IRE Standards on Methods of Measuring Noise in Linear Two 
Ports 1959,” Proc. IRE, Vol. 48, January 1960, pp. 60–68.
  [7]	 Hause, H. A., et al.,  “Representation of Noise in Linear Twoports,” Proc. IRE., Vol. 
48, January 1960, pp. 69–74.
  [8]	 Hause, H. A., et al., “Description of the Noise Performance of Amplifiers and Receiv-
ing Systems,” Proc. IEEE, Vol. 52, March 1963, pp. 436–42.
  [9]	 Wedge, S. W., and D. B. Rutledge, “Wave Techniques for Noise Modeling and Mea-
surement,” IEEE Trans. Microwave Theory Techn., Vol. 40, No. 11, November 1992, 
pp. 2004–12.
[10]	 Meys, R. P., “A Wave Approach to the Noise Properties of Linear Microwave  
Devices,” IEEE Trans. Microwave Theory Techn., Vol. MTT-26, No. 1, January 1978,  
pp. 34–37.
[11]	 Engelbrecht, R. S., and K. Kurokawa, “A Wideband Low Noise L-Band Balanced 
Transistor Amplifier,” Proc. IEEE, Vol. 53, March 1965, pp. 237–47.


241
9
Scattering Functions in Nonlinear  
Modeling of Microwave Devices
Small-signal scattering parameters discussed in many aspects in previous chap-
ters are used very successfully for characterization and analysis of linear devices 
and components. Scattering parameter representation is used extensively for a 
frequency domain behavioral modeling of linear networks. They represent the 
relationship between the incident and reflected wave variables at network ports 
at a set of specific frequencies. Since they deal with linear reflection and linear 
transfer relationships only, they cannot be used to model component (e.g., power 
transistors, power amplifiers, mixers) that present significant nonlinearities.
To break the limitations of the small-signal scattering parameters, a 
large-signal scattering function theory has been proposed by Jan Verspecht 
and his coworkers and coauthors [1, 2, 15]. This theory, which has been very 
extensively studied in last few years, extends small-signal theory by taking into 
account not only the scattering wave variables at one fundamental frequency, 
but also at harmonic and non-harmonic frequencies [3–7]. The contribution 
of all such spectral components is formulated into nonlinear scattering func-
tions that allow characterizing nonlinear devices and networks. Scattering 
functions may be considered as natural extension of S-parameters. To mea-
sure scattering functions and to derive such behavioral models of nonlinear 
devices, a specific measurement system is required. This system is called vec-
torial nonlinear network analyzer (VNNA) [2, 4].

242 
Microwave Network Design Using the Scattering Matrix 
9.1  Large-Signal Scattering Functions
Classical scattering matrices S are used interactively for characterization, 
modeling, analysis, and design of linear devices and networks. They relate 
ingoing and outgoing wave variables considered as signals applied to a linear 
multiport network. Only most of passive lumped constant and distributed 
elements, networks, and systems are linear. In a case of semiconductor de-
vices and radio frequency/microwave monolithic integrated circuits we may 
consider them approximately as linear assuming a small signal applied around 
operating point determined by fixed bias voltages and currents and by fixed 
operating frequency. The scattering parameters are sufficient to predict the 
response of a linear network excited at its ports by any signals. This follows 
from the property of superposition, which applies to linear networks. Because 
all real semiconductor devices are nonlinear, scattering parameters are good 
linear approximation valid only for small-signal operation of such devices. 
They cannot be applied for large-signal modeling and analysis in order to 
determine or even to estimate a response of real nonlinear system.
For a nonlinear multiport network (device) relation between incident 
and scattered pseudowaves may be given by the nonlinear scattering function 
Á defined by the following equation [6–8]
	
( )
= Á
B
A 	
(9.1)
where A and B are vectors containing the pseudowave amplitudes of, respec­
tively, the large-signal incident and reflected pseudowaves at all ports and 
at all frequencies that are present in the system. Symbol Á indicates that 
wave variables B are functions of wave variables A. In general case frequencies 
at which elements of the A and B are considered may not be harmonically  
related.
Pseudo-waves A and B are defined as [11]
	
2
R
V
Z I
A
+
=
	
(9.2)
and
	
2
R
V
Z I
B
-
=
	
(9.3)
where V is the signal voltage and I is the signal current at a reference plane of 
a port. In (9.2) and (9.3) ZR is the real reference impedance and its default 

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
243
value is usually 50W. Thanks to assumption that ZR is real, interpretation of 
wave variables and of quantities derived from them is easier.
In further considerations we will assume that the spectrum of signals 
existing in a nonlinear system is limited to a fundamental frequency and its 
harmonics. It means that the signal is periodic or that it is narrowband modu-
lated fundamental tone with harmonics. This limitation is introduced only to 
apply, in further considerations, a simple system of identification for different 
frequencies existing in a nonlinear multiport device.
In (9.1), Á represents a set of multivariate complex functions that relate 
all input spectral components Aqn with the output spectral components Bpm 
	
11
12
21
22
31
32
(
,
,...,
,
,....,
,
,....)
pm
pm
B
F
A
A
A
A
A
A
=
	
(9.4)
where p and q range from one to the number of nonlinear network signal 
ports and where m and n range from one to the highest harmonic index 
considered in the system. The functions Fpm are called scattering functions 
[5–12] or X-parameters [13, 14]. For m = 1 the scattering function Fp1 de-
termines the complex amplitude of the fundamental frequency ouput signal 
Bp1 at port p as a function of all input signals spectral components at all ports 
of a nonlinear device.
In the case of the two-port network presented in Figure 9.1, we have
	
1
1
11
12
21
22
(
,
,....,
,
,.....)
m
m
B
F
A
A
A
A
=
	
(9.5)
	
2
2
11
12
21
22
(
,
,....,
,
,.....)
m
m
B
F
A
A
A
A
=
	
(9.6)
Because considered nonlinear networks are time-invariant, this feature 
determines mathematical properties of the scattering functions (describing 
functions) given by (9.4). Time-invariant property always requires the same 
time delay of the output signal as it was introduced in the input signal. This 
property of S-function may be written as [7, 11]
    
(
)
2
2
2
11
12
21
22
31
32
,
,...,
,
,....,
,
,....
jm
pm
j
j
j
j
j
j
pm
B
e
F
A e
A e
A e
A e
A e
A e
θ
θ
θ
θ
θ
θ
θ
=
	
(9.7)
because the same time delay of signal spectrum components requires applica-
tion of linear, proportional to the frequency phase shift.
.	
X-parameters is a registered trademark of Agilent Technologies.

244 
Microwave Network Design Using the Scattering Matrix 
As presented in (9.4), the functional relation between the output signal 
spectral components and the input signal spectral components is a general 
relation that is a basis for developing frequency domain practical models of 
nonlinear devices [7–9]. An appropriate set of approximations, mainly linear-
izations, experiment designs, and model identification schemes can be used 
together to derive practical frequency domain behavioral models of nonlin-
ear microwave devices [4]. One such model, the phase harmonic distortion 
model (PHD), has been developed and is described in detail by J. Verspecht 
and D. E. Root in [11].
To be able to derive frequency domain behavioral models of nonlinear 
devices, it is necessary to establish phase referencing to the input and output 
pseudo-wave signals in (9.4). Because relation (9.7) is valid for any value of 
A 11 A 12
A 13
A N
A 21 A 22
A 23
A 2N
f 1
2f1
3f1
Nf1
f
f 1
2f1
3f1
Nf1
f
f 1
2f1
3f1
Nf1
f
f 1
2f1
3f1
Nf1
f
B 11 B 12
B 13
B    ,
11 B    ,
12 B    , ...
13
B N
B 21 B 22
B 23
B 2N
B    ,
21 B    ,
22 B    , ...
23
A    ,
11 A    ,
12 A    , ...
13
A    ,
21 A    ,
22 A    , ...
23
Nonlinear
two-port
Figure 9.1  Nonlinear two-port device with harmonically related input and output pseu-
dowaves at its ports.

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
245
phase delay Q, one may set Q = - j11, where φ11 = arg(A11) is the phase of the 
incident pseudo-wave A11, fundamental frequency tone of the input signal at 
port 1 of the network. This is a proper choice for power transistor or power tran-
sistor amplifier modeling, because the incident pseudowave A11 is the dominant 
component of the large signal delivered to port 1 of the device or network.
Introducing the phasor
	
11
j
P
e
ϕ
-
=
	
(9.8)
and substituting in (9.7) 
11
j
j
e
e
P
θ
ϕ
-
=
=
, one gets [11]
    
(
)
2
3
2
2
11
12
13
21
22
31
32
,
,
,...,
,
,....,
,
,....
pm
m
pm
B
F
A
A P
A P
A P A P
A P A P
P -
=
×
	
(9.9)
From (9.9) we see that the complex amplitude of the fundamental com-
ponent of the input signal is set to a real and positive number, which makes 
further processing simpler.
9.2  Linearization of Scattering Functions
In many practical cases we can consider large-signal operating conditions of 
devices as not heavily nonlinear. We have such a situation in the case of a 
power transistor amplifier driven by narrowband input signal. This corre-
sponds to a single dominant large input signal component. The other input 
signal components are of relatively small magnitude. In such cases it is pos-
sible to use linearization and the superposition principle for the relatively 
small input signal components. Such an approach has been proposed in  
[1–3, 8], which describe linearization of scattering functions Á relating the 
large-signal incident and scattered pseudowave coefficients at ports of weakly 
nonlinear time invariant device. As a weakly nonlinear, we understand the de-
vice whose output signals are stable, single valued, and continuous functions 
of the input signal. Output signal spectrum may contain only components 
having frequencies that are linear combinations with integer coefficients of 
the frequencies present in the input signal. It is assumed that a device oper-
ates in a stable large-signal operating point. The linearization is applied in 
order to describe nonlinear device behavior in terms of a large-signal operat-
ing point and a set of approximate linear relations between small magnitude 
input and output signals.

246 
Microwave Network Design Using the Scattering Matrix 
Assuming that the device operates in a stable single-valued and continu-
ous point, (9.1) may be linearized by writing [8]
	
0
=
+
A
A
a	
(9.10)
and
	
0
=
+
B
B
b	
(9.11)
where B0 is a vector describing the steady state large-signal response to the 
large-signal steady state excitation A0. In (9.10) and (9.11) vector a represents 
a small excitation signal superimposed on A0 and b is a vector representing 
the small signal response superimposed on B0.
When the device is linear and time-invariant, the scattering function Á 
is analytic and the vectors A and B are related by linear scattering matrix Slin
	
lin
=
B
S
A	
(9.12)
From (9.10) through (9.12), it is evident also that for linear and time 
invariant devices the vectors B0 and A0 as well as the vectors b and a are re-
lated by the same Slin
	
0
0
lin
=
B
S
A 	
(9.13)
and
	
lin
=
b
S
a	
(9.14)
Because the device is linear, the elements of the Slin matrix relating wave 
variables at different frequencies must be equal zero. Most passive microwave 
elements are linear and time-invariant and their behavior describes the linear 
scattering matrix Slin.
In the case of a weakly nonlinear device the scattering function Á is in 
general not analytical and large-signal vectors B and A cannot be related by 
linear scattering matrices [8]. Even small-signal components a and b cannot 
be related by linear scattering matrices.
The only solution to this problem is application of the Jacobian J of the 
Á function of a weakly nonlinear device. The elements of J are evaluated at 
operating point defined by a pair of vectors A0 and B0. Jacobian J is used to 

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
247
linearly approximate relation between small input signal a and small output 
signal b.
Using the Jacobian J, we can write [8]
	
( )
( )
( )
( )
( )
( )
RR
RI
IR
II
Re
Re
Re
Im
Im
Im
é
ù
é
ù
é
ù é
ù
»
º
ê
ú
ê
ú
ê
ú ê
ú
ë
û
ë
û
ë
û ë
û
b
a
J
J
a
J
b
a
J
J
a 	
(9.15)
where Re(Z) and Im(Z) indicate real and imaginary parts of the argument Z. 
The Jacobian J is a real matrix. Its elements are the first partial derivatives of the 
real and imaginary parts of B with respect to real and imaginary parts of A evalu-
ated at the operating point given by vectors A0 and B0. In particular, elements of 
submatrix JRR in (9.15) are partial derivatives of the real parts of B with respect to 
the real parts of A derived at the operating point (A0, B0). Similarly, the elements 
of submatrix JRI are partial derivatives of the real parts of B with respect to the 
imaginary parts of A at the operating point (A0, B0), and so on.
In (9.15) the real and imaginary parts of the input small-signal pseu-
dowaves a are treated as separate and independent entities. Complex func-
tions with complex arguments treated as separate and independent entities 
are called nonanalytic [8, 11]. In the mathematical sense, the scattering func-
tion Á is nonanalytic [8, 11].
Equation (9.15) may be written also in the form
(
)
(
)(
)
(
)(
)
/
( )
( )
( )
( )
( )
( )
1
(
( )
( )
2
1
(
( )
( )
2
*
RR
RI
IR
Ri
RR
II
IR
RI
RR
II
IR
RI
Re
jIm
Re
Im
j
Re
Im
j
Re
jIm
j
Re
jIm
+
»
+
+
+
=
+
+
-
+
+
-
+
+
-
=
+
b
b
J
a
J
a
J
a
J
a
J
J
J
J
a
a
J
J
J
J
a
a
Sa
S a
	
(9.16)
In (9.16), S and S/ are complex matrices defined as [8]
	
(
)
(
)
1
2
RR
II
IR
RI
j
=
+
+
-
S
J
J
J
J
	
(9.17)
	
(
)
(
)
/
1
2
RR
II
IR
RI
j
=
-
+
+
S
J
J
J
J
	
(9.18)

248 
Microwave Network Design Using the Scattering Matrix 
Using the above relations, the total approximate response of a nonlinear 
network may be expressed as
	
0
=
+
B
B
b = Á(A) = Á(A0 + a)	
 
	
» Á(A0) + S a + S/ a*	
(9.19)
in which
	
0 =
B
 Á(A0)	
(9.20)
is the large-signal response of a device, and
	
/ *
=
+
b
Sa
S a 	
(9.21)
is a response of a device to additional small input signals superimposed on 
A0 and B0. 
Equation (9.19) represents the superposition principle for the relatively 
small input signal components. According to (9.19), the overall deviation b 
of the output spectrum B is the superposition of all individual deviations. It 
is called the harmonic superposition principle [11]. It is assumed here that 
a nonlinear device can depend in a strongly nonlinear way on its large input 
signal A0, but nevertheless to respond linearly to additional small signal a 
considered as small perturbations at steady state operating point (A0, B0). 
Equation (9.16) may be written also as
	
=
+
( )
( )
Re
Im
b
G
a
H
a 	
(9.22)
where matrices G and H are defined as [11]
	
/
=
+
G
S
S 	
(9.23)
	
/
(
)
j
=
-
H
S
S 	
(9.24)
From (9.19) we see the consequences of linearization of the functional 
relation B = Á(A). Large-signal operation of a weakly nonlinear device is 
described by two pairs of quantities (A0, B0) and (S, S/). The pair (A0, B0) 
represents the steady state operating point of the weakly nonlinear device. 
Linearization is performed at operating point (the elements of the Jacobian 
J are derived at operating point (A0, B0)). A0 and B0 contain information 
about nonlinear operation state of the device. The second pair of quantities 
are two matrices (S, S/), which describe the device response to the additional 

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
249
small signals a and b superimposed on A0 and B0. The matrix S is a matrix of 
response coefficients for small-signal perturbation a, while the matrix S/ is a 
matrix of response coefficients for conjugate small-signal perturbation b.
With the assumption that the spectrum of input small signals in a con-
tains only three tones and that spectrum of output small signals in b also 
contains three tones, for a weekly nonlinear two-port device, the small-signal 
part of (9.19) will have the form
11
12
13
/
21
22
23
11,11
11,12
11,13
12,11
12,12
12,13
11,21
11,22
11,23
12,21
12,22
12,23
11,31
11,32
11,33
12,31
12,32
12,33
21,11
21,12
21,13
22,11
22,12
22,13
21,21
*
b
b
b
b
b
b
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
é
ù
ê
ú
ê
ú
ê
ú
=
=
+
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
=
b
Sa
S a
11
12
13
21
21,22
21,23
22,21
22,22
22,23
22
21,31
21,32
21,33
22,31
22,32
22,33
23
/
/
/
/
/
/
11,11
11,12
11,13
12,11
12,12
12,13
/
/
/
/
11,21
11,22
11,23
12,21
12,22
a
a
a
a
S
S
S
S
a
S
S
S
S
S
S
a
S
S
S
S
S
S
S
S
S
S
S
é
ù é
ù
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ê
ú ê
ú
ë
û ë
û
+
1
/
/12,23
/
/
/
/
/
/
11,31
11,32
11,33
12,31
12,32
12,33
/
/
/
/
/
/
21,11
21,12
21,13
22,11
22,12
22,13
/
/
/
/
/
/
21,21
21,22
21,23
22,21
22,22
22,23
/
/
/
/
/
/
21,31
21,32
21,33
22,31
22,32
22,33
a
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
S
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
1
12
13
21
22
23
*
*
*
*
*
*
a
a
a
a
a
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û	
(9.25)
In nonlinear regime of operation of a device the elements of S, which 
relate elements of a and b representing tones of different frequencies, are 
nonzero element. Even in a case of weakly nonlinear devices, output sig-
nals spectrum contains mixing products at the sum and at the difference 
frequencies of the input signals. If we consider mixing products that include  

250 
Microwave Network Design Using the Scattering Matrix 
difference frequency, we realize that their phase or frequency may behave in a 
special way. In particular, an increase of phase or frequency of an input signal 
can result in decrease in the phase or frequency of the output signal. The 
existence of the conjugate response coefficients matrix S/ in equations (9.16) 
and (9.19) solves such a situation and behavior of a network. Thanks to the 
matrix S/ that relates elements of the vector b to the conjugate of elements of 
the vector a, linearization described by (9.19) may be applied to all first-order 
mixing products generated by a weakly nonlinear device.
When a device is linear and time-invariant, the matrix S reduces to the 
matrix Slin , whose elements are sets of small-signal scattering parameters at 
frequencies represented in the input signal to the network. Now the matrix 
S relates elements of the vector b directly with elements of the vector a, and 
as the phase of an element of a increases the phase of corresponding elements 
of the vector b increases, too. Mixing products are not generated by a linear 
device and the elements of Slin relating different frequency elements of vectors 
a and b are zeros. Equation (9.26) presents the S-matrix of a two-port device 
working in linear regime.
	
11,11
12,11
11,22
12,22
11,33
12,33
21,11
22,11
21,22
22,22
21,33
22,33
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
0
lin
S
S
S
S
S
S
S
S
S
S
S
S
é
ù
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
S
	
(9.26)
9.3  The Time Reference
As discussed in Section 9.1, to simplify the form of the S-function Á and in 
consequence to simplify measurement procedure of Á using a vectorial nonlinear 
network analyzer, the phase of the element of A corresponding to the fundamen-
tal frequency of the input signal incident on the device is set to zero [11].
Such a choice of time reference is not convenient for cases when vector 
A0 contains not one but several large signals that are not harmonically related. 
For example, this is the case when using a two-tone test input signal one 
wants to determine second-order intermodulation distortions in a network.
The choice of the time reference based on this fundamental frequency 
may create some problems even when the input signal A0, which determines 

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
251
the steady state large-signal operating point, has a well-defined fundamental 
frequency. For example, in a case when a fundamental component of a small 
input signal a is superimposed in quadrature upon the fundamental compo-
nent of a large input signal A0, the time referencing complicates. The large 
signal sets the operating point of the nonlinear device and defines time refer-
ence. But adding a small signal in quadrature to the large fundamental signal 
will shift that time reference and this shift will depend on the magnitude of 
this small quadrature input signal. This shift of time reference has to be taken 
into account when we want to determine adequate nonlinear model of device 
driven by such input signal.
To solve such a problem with quadrature small signals, another choice 
of time reference has been proposed [8]. It is based on the fact that all fre-
quency domain complex vectors of wave coefficients A(t), B(t), A(t), B0(t), 
a(t), and b(t) taken at time t are related to A(t0), B(t0), A(t0), B0(t0), a(t0), and 
b(t0) taken at time t0 with similar equations
	
0
(
)
0
( )
( )
j
t t
t
e
t
- W -
=
A
A
	
(9.27)
	
0
(
)
0
( )
( )
j
t t
t
e
t
- W -
=
B
B
	
(9.28)
	
0
(
)
0
0
0
( )
( )
j
t t
t
e
t
- W -
=
A
A
	
(9.29)
	
0
(
)
0
0
0
( )
( )
j
t t
t
e
t
- W -
=
B
B
	
(9.30)
	
0
(
)
0
( )
( )
j
t t
t
e
t
- W -
=
a
a
	
(9.31)
	
0
(
)
0
( )
( )
j
t t
t
e
t
- W -
=
b
b
	
(9.32)
where W is the diagonal matrix of angular frequencies of each of the elements 
of vectors presented in (9.27) through (9.32).
Because it is assumed that a device is time-invariant, then inserting 
(9.27) through (9.28) into (9.1), we have
	
Á(A(t)) = 
0
(
)
j
t t
e- W -
 Á(A(t0))	
(9.33)
Similarly, using (9.31) – (9.32) in (9.19) and (9.21) we have
	
0
0
(
)
(
)
0
( )
( )
j
t t
j
t t
t
e
t e
- W
-
+ W -
=
S
S
	
(9.34)

252 
Microwave Network Design Using the Scattering Matrix 
and
	
0
0
(
)
(
)
/
/
0
( )
( )
j
t t
j
t t
t
e
t e
- W -
- W
-
=
S
S
	
(9.35) 
Formulas (9.34) and (9.35) allow us to determine matrices S and S/ at 
a new time once they have been determined at some specific time reference 
t0. This means that one can measure the device and determine its parameters 
with a specific choice of time reference, and then these parameters may be 
used with any other choice of time reference [8].
9.4  Application of the Response Coefficients Matrices  
S and S/ to Predict Nonlinear Device Performance
The equation
	
/ *
»
+
b
Sa
S a 	
(9.36)
describes response of a weakly nonlinear device for a small-signal excitation 
a. Because of the second component S/a* on the right-hand side of this equa-
tion, standard methods of analysis of linear multiport networks discussed in 
Chapter 5 cannot be applied directly to weakly nonlinear devices embedded 
in large linear networks.
When a linear network embedding a nonlinear device does not create 
signal couplings between ports of nonlinear device it is possible to derive 
formulas describing and predicting electrical behavior of a weakly nonlinear 
device embedded in this network. Figure 9.2 illustrates such a network. One-
Γ1
Γi
Γj
S, S´
A  ,B
Weakly nonlinear
device
at operating
point (
)
1
A
B
i
j
Γp
p
0
0
Figure 9.2  Linear one-port loads and signal sources connected to ports of weakly non-
linear device.

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
253
ports connected to ports of a weakly nonlinear device represent linear time- 
invariant passive loads described by their reflection coefficients or signal  
sources described by their signal source amplitudes and reflection coefficients.
In further considerations we assume that reference impedances of con-
nected ports are real and that pairs of reference impedances corresponding to 
connected ports are equal to each other. Thanks to this assumption, the in­
going and outgoing waves at ports connected together are equal to each other.
For a considered weakly nonlinear device embedded by linear network, 
we may write an equation that results from the fact that linear network loads 
a device at all its ports
	
S
S
= G
+
A
B
A 	
(9.37)
in which GS is the diagonal matrix whose elements are reflection coefficients 
presented to the device by the linear external network and AS is the vector of 
impressed waves of signal sources located in linear network and incident on 
the device.
The equation describing a nonlinear device has a form 
	
/
0
*
»
+
+
B
B
Sa
S a 	
(9.38)
Substituting (9.38) into (9.37), we receive [8]
	
/
0
0
*
(
)
S
S
S
S
- G
- G
»
-
+ G
I
S a
S a
A
A
B 	
(9.39)
where I indicates the identity matrix. This equation can be solved directly for 
a by rewriting it as a linear matrix equation
	
(
)
(
)
(
)
(
)
(
)
(
)
/
/
S
/
/
0
0
0
0
1
1
1
1
( )
( )
S
S
S
S
S
S
S
S
S
S
S
Re
Im
Im
Re
Re
Re
Im
Im
é
ù
- G
- G
-
- G
- G
ê
ú
ê
ú
- G
- G
- G
- G
ë
û
é
-
+ G
ù
é
ù
´
» ê
ú
ê
ú
-
+ G
ë
û
ë
û
S
S
S
S
S
S
S
S
a
A
A
B
a
A
A
B
	
(9.40)
Solving this equation for the estimation of a = Re(a) + j Im(a)  allows us 
to predict the first-order behavior of a nonlinear device embedded in an ex-
ternal linear network. Substituting vector a into (9.36) allows us to determine 
the device small-signal response superimposed on A0 and B0.

254 
Microwave Network Design Using the Scattering Matrix 
9.5  Experimental Determination of the Response  
Coefficients Matrices S and S/
The matrices S and S/ of small-signal response coefficients should be mea-
sured at a particular operating point (A0, B0) created with measurement set 
presented in Figure 9.3.
It is composed of two appropriate signal sources and large-signal net-
work analyzer (LSNA) [4, 11, 12]. Signal source 1 is used for generation of 
A0 components. In general, this source must be capable of generating mul-
tiple signals in accordance with assumed, for particular experiment, spec-
trum of the large input signal A0. The second signal source generates small 
input signal components a. A switch is used to implement the introduction 
of the small signal to the input port and to the output port of a DUT. A 
large-signal network analyzer is used to measure all components of A0, B0, a 
and b.
Assume now that using the measurement system presented in Figure 
9.3, we want to determine response coefficients 
/
and
, ,
1,2
ij
ij
S
S i j =
 of the 
Source 1
Large signal
Wilkinson
combiner
Source 2
Small signal
Match
Switch for small signal
LSNA
1
2
DUT
CH2
CH4
CH3
CH1
Figure 9.3  Block diagram of the measurement system. The vectorial nonlinear network 
analyzer is used to determine the large signal operating point (A0, B0) as well 
as and small-signal input and output perturbations delivered to the input/output 
port of the device under test (DUT).

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
255
DUT at a particular operating point (A0, B0) defined by the large signal of 
source 1. The measurement procedure is straightforward. Because for the 
individual elements of S and S/ we can write
	
/ *
i
ij
j
ij
j
b
S a
S a
=
+
	
(9.41)
then substituting into (9.41)
	
(cos
sin )
j
j
a
a
j
θ
θ
=
+
	
(9.42)
	
θ
θ
=
+
+
-
/
/
[(
)cos
(
)sin ]
i
j
ij
ij
ij
ij
b
a
S
S
j S
S
	
(9.43)
Using (9.43), we receive
	
I
Q
j
j
ij
j
b
b
S
a
+
=
	
(9.44)
and
	
I
Q
/
j
j
ij
j
b
b
S
a
-
=
	
(9.45)
where bjI and bjQ are the small-signal responses of the DUT to the input sig-
nal aj with a zero phase (θ = 0o) and with a 90o phase, respectively.
From (9.44) and (9.45) it is evident that derivation of Sij and S/
ij re-
quires two measurements, performed separately for two, quadrature in phase, 
small signals.
Figure 9.4 represents a graphical representation of the Sij and S/
ij re-
sponse coefficients extraction procedure.
More precise extraction procedure of response coefficients matrices S 
and S/ that best satisfy (9.19) is based on taking many more than two mea-
surements and application of a linear least square regression technique. In 
such a procedure it can also be taken into account that the actual operat-
ing point (A0, B0) of the DUT is not known precisely. This means that A 
and B have to be measured at a number of operating states and interpola-
tion of matrices S and S/ should be performed in the range of operating  
points.

256 
Microwave Network Design Using the Scattering Matrix 
To find an approximation of Sij and Sij
/ it is necessary to estimate B0i, Sij 
and Sij
/ that best fit the equation
	
/
0
*
i
i
ij
j
ij
j
B
B
S a
S a
»
+
+
	
(9.46)
in which Bi and B0i are the ith elements of B and B0, respectively. Since (8.46) 
is linear in B0i, Sij and Sij
/, we can apply a linear least square fit to estimate 
B0i, Sij and Sij
/.
To do this we have to get a set of large signal measurement data, by 
determining the large-signal responses Bik to the different small-signal input 
signal ajk, where index k corresponds to measurement number and each mea-
surement is performed with different small-signal input signal ajk.
To perform least square fit procedure, we arrange the small-signal input 
wave complex amplitudes into a vector
	
1
2
:
:
j
j
jk
jK
a
a
a
a
é
ù
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
a
	
(9.47)
Im( )
aj
Re( )
aj
Im(
/| |)
b
a
i
j
Re(
/| |)
b
a
j
j
S
S
−
ij
ij
S
S´
−
ij
ij
Figure 9.4  Graphical representation of Sij and S /
ij response coefficients extraction  
procedure.

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
257
and large-signal responses into another vector
	
1
2
:
:
i
i
ik
iK
B
B
B
B
é
ù
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û
B
	
(9.48)
We also define a matrix 
	
1
1
2
2
*
1
*
1
:
:
:
*
1
:
:
:
*
1
j
j
j
j
jk
jk
jK
jK
a
a
a
a
a
a
a
a
β
é
ù
ê
ú
ê
ú
ê
ú
ê
ú
= ê
ú
ê
ú
ê
ú
ê
ú
ê
ú
ë
û	
(9.49)
in which the first column is filled with ones, the second column is the vector 
a, and the third column is the varactor *
a . We define also a vector of esti-
mated parameters
	
0
?
i
ij
ij
B
S
S
é
ù
ê
ú
= ê
ú
ê
ú
ê
ú
ë
û
s
	
(9.50)
Then we construct a merit function
	
2
2
1
K
k
k
χ
ε
ε ε
+
=
=
=
å
	
(9.51)
where
	
ε
β
=
-
B
s	
(9.52)
and K >> 3. 

258 
Microwave Network Design Using the Scattering Matrix 
Because the normal equation of (9.51) has a form
	
T
(
)
0
ε ε
ββ
β
+
¶
=
-
=
¶
s
B
s
	
(9.53)
then its solution vector is
	
1
[
] [
]
β β
β
+
-
+
=
s
B 	
(9.54)
According to (9.50), three elements of vector s are required least squares 
estimators of  B0i, Sij and Sij
/.
In multiple measurements performed with different small-signal input 
signal, it is convenient to keep the magnitude of each ajk constant and to 
change the phase of each ajk.
In the procedure we present, we find individual elements of the response 
coefficient matrices S and S/ one at a time using a classic linear least square fit.
References
  [1]	 Verspecht, J., M. Vanden Bossche, and F. Ferbeyst, “Characterizing Components 
Under Large Signal Excitation: Defining Sensible “Large Signal S-Parameters,” 49th 
ARFTG Conf. Digest, 1997, pp. 109–117.
  [2]	 www.janverspecht.com.
  [3]	 Verbejst, F., and M. Vanden Bossche, “VIOMAP, the S-Parameter Equivalent for 
Weakly Nonlinear RF and Microwave Devices,” IEEE Trans Microwave Theory Tech., 
Vol. 42, No. 12, December 1994, pp. 2531–35.
  [4]	 Van den Broeck, T., and J. Verspecht, Calibrated Vectorial Nonlinear Network Ana­
lyzer,” IEEE MTT-S Int. Microwave Symposium Dig., San Diego, CA, May 1994,  
pp. 1069–72.
  [5]	 Verspecht, J., D. Schreurs, and B. Nauwelears, “Black Box Modeling of Hard Non­
linear Behavior in the Frequency Domain,” IEEE MTT-S International Microwave 
Symposium Digest, San Francisco, CA, June 1996, pp. 1735–38.
  [6]	 Verspecht, J., and P. Van Esch, “Accurately Characterizing Hard Nonlinear Behavior 
of Microwave Components with the Nonlinear Network Measurement System: Intro-
ducing Nonlinear Scattering Functions,” Proc. 5th Int. Workshop Integrated Nonlinear 
Microwave and Millimeterwave Circuits, Germany, October 1998, pp. 17–26.
  [7]	 Verspecht, J., “Scattering Functions for Nonlinear Behavioral Modeling in the Fre-
quency Domain,” 2003 IEEE MTT-S Int. Microwave Symp. Workshop, June 2003.

 
Scattering Functions in Nonlinear Modeling of Microwave Devices 
259
  [8]	 Verspecht, J., D. F. Williams, and D. Schreurs, et al., “ Linearization of Large- 
Signal Scattering Functions,” IEEE Trans Microwave Theory Tech., Vol. 53, No. 4, 
April 2005, pp. 1369–76.
  [9]	 Verspecht, J., J. Root, and D. E. Wood, et al., “Broad-Band Multi-Harmonic Fre-
quency Domain Behavioral Models from Automated Large-Signal Vectorial Network 
Measurements,” IEEE MTT-S Microwave Symposium Digest, June 12–17, 2005.
[10]	 Root, D. E., J. Verspecht, and D. Sharritet al., “Broad-Band Poly-Harmonic Distor-
tion (PHD) Behavioral Models from Fast Automated Simulations and Large-Signal 
Vectorial Network Measurements,” IEEE Trans Microwave Theory Tech., Vol. 53, No. 
11 November 2005, pp. 3656–64.
[11]	 Verspecht, J., and D. E. Root, “Polyharmonic Distortion Modeling,” IEEE Microwave 
Magazine, June 2006, pp. 44–57.
[12]	 “S-Functions, Measure, Model, Simulate, An Application in Integrated Component 
Characterization Environment”, NMDG NV, www.nmdg.be.
[13]	 Horn, J., D. Gunyan, and L. Betts, et al., “Measurement-Based Large-Signal Simula­
tion of active Components From Automated Nonlinear Vector Network Analyzer 
Data Via X-Parameters,” Int. Conference on Microwaves, Communications and Electronic  
Systems, COMSAS 2008, May 13–14, 2008.
[14]	 Horn, J., J. Verspecht, D. Gunyan, L. Betts, D. E. Root, and J. Ericksson, “X-Param-
eter Measurement and Simulation of a GSM Handset Amplifier,” Proc. 3rd European 
Microwave Integrated Circuits Conference, Amsterdam, the Netherlands, October 2008, 
pp. 135–138.


261
Appendix
Basics of Fourier Transform in Application to Noise Waves
Wave variables can be described in the time domain, as functions of time 
(e.g., h(t)), or else in the frequency domain, where the process is specified by 
giving its amplitude H (generally a complex number having its magnitude 
and phase) as a function of frequency f; that is, H( f   ), with -¥ <
< ¥
f
. The 
Fourier transform equations that define back and forth transitions between 
these two representations are
	
¥
-¥
= ò
2
( )
( )
jft
H f
h t e
dt
π
	
(A.1)
	
¥
-
-¥
= ò
2
( )
( )
jft
h t
H f e
dt
π
	
(A.2)
When using angular frequency w , (A.1) and (A.2) look like this
	
¥
-¥
= ò
( )
( ) j t
H
h t e
dt
ω
ω
	
(A.3)
	
¥
-
-¥
= ò
( )
( )
j t
h t
H
e
dt
ω
ω
	
(A.4)
From the above equations it is evident at once that Fourier transforma-
tion is a linear operation. The transformation of the sum of two functions is 

262 
Microwave Network Design Using the Scattering Matrix
equal to the sum of the transforms. The transform of a constant times a func-
tion is that same constant times the transform of the function.
The correlation of two functions, denoted Corr( g , h), is defined by
	
º
+
ò
Corr( , )
(
) ( )
g h
g
t h
d
τ
τ
τ	
(A.5)
The correlation function is a function of t, and it turns out to be one 
number of the transform pair:
	
Û
*
Corr( , )
( )
( )
g h
G f H
f 	
(A.6)
(The symbol Û in (A.6) is used to indicate transform pairs). The above 
relation is called correlation theorem. This theorem tells us that multiplying 
the Fourier transform of one function by the complex conjugate of the Fou-
rier transform of the other gives the Fourier transform of their correlation. 
(More generally, the second term of pair in (A.6) is G( f )H(-f ), but in a usual 
case in which g(t) and h(t) are real functions, we use one of elementary prop-
erties of the Fourier transform, and set 
*
(
)
( )
H
f
H
f
-
=
.
The correlation function with itself is called its autocorrelation. In this 
case (A.6) becomes the transform pair
	
Û
2
Corr( , )
( )
g g
G f
	
(A.7)
Equation (A.7) is called the Wiener-Khinchin theorem.
The total power in a signal is the same when computed in the time do-
main or in the frequency domain
	
¥
¥
¥
¥
º
=
ò
ò
2
2
Total power
( )
( )
h t
dt
H f
df
	
(A.8)
This result is known as Parseval’s theorem.
Very often we want to know how much power is contained in the fre-
quency interval between f and f + df. In such a case we usually do not distin-
guish between positive and negative f , but we consider f  as varying from 0 
to +¥. In consequency, we define the one-sided power spectral density (PDS) 
of the function h(t) as
	
º
+
-
£
< ¥
2
2
( )
( )
(
)
for
0
S f
H f
H
f
f
	
(A.9)

	
Appendix	
263
and the total power of a signal is just the integral of S(f ) from f = 0 to f = ¥. 
When the function h(t) is real, then H(-f ) = H*(f ), what means that two 
terms in (A.9) are equal, so
	
=
2
( )
2
( )
S f
H f
	
(A.10)
It is important to remember that in the definition of the one sided spec-
tral density function there is factor two, as it is shown in (A.10).
In Chapters 7 and 8 we were concerned with a frequency-domain 
noise quantities. The Fourier transform cannot be applied directly to noise, 
because it is a random process not limited in time and not periodic. But 
it is possible to use the following approach. We consider a single sample 
of noise over a period of time T, and we take the Fourier transform of this 
sample, as
	
-
= ò
/2
/2
( , )
( )
T
j t
n
n
T
a
T
a t e
dt
ω
ω
	
(A.11)
Because noise is considered in linear networks, it can be viewed in 
wider frequency band as a superposition of contiguous, narrowband noise 
processes
The power spectral density of a random process can be obtained as a 
limit, as T ® ¥, of the average of a large number of such spectral samples. 
According to (A.10) and (A.11), we have
	
®¥
=
=
2
2
T
( , )
( )
lim
( )
n
a
n
a
T
S
a
T
ω
ω
ω
	
(A.12)
In a similar way it is possible to define power cross-spectral densities of 
two random processes an1(t) and an2(t). Using (A.6) and (A.12), we receive
	
1
2
1 2
1
2
T
*
( , )
( , )
*
( )
lim
( )
( )
n
n
a a
n
n
a
T a
T
S
a
a
T
ω
ω
ω
ω
ω
®¥
=
=
	
(A.13)
which relates directly to correlation in frequency domain. From (A.12) and 
(A.13) it is evident that the noise power spectral density in frequency domain 
is expressed as a mean square quantity.
Continuing the discussion it is evident to say that 
2
*
( )
( )
( )
n
n
n
a
a
a
ω
ω
ω
=
 
rep­resents, by definition, the average power carried by the noise wave in a unit  

264 
Microwave Network Design Using the Scattering Matrix
bandwidth centered at angular frequency w, or 
ω
=
D
D =
2
( )
with  f
n
a
a
S
f
 
1 Hz. The units of 
2
n
a
 are W, but 
2
n
a
 has the same numerical value as the  
power spectral density Sa(w).
Following (A.6), the correlation between two noise wave processes con-
sidered in narrow bandwidth centered at the angular frequency w is 
	
1, 2
1
2
1
2*
Corr(
( ),
( ))
( )
( )
a a
n
n
n
n
C
a
t a
t
a
a
ω
ω
=
=
	
(A.14)
This quantity is, in generally, complex.
According to (A.7) the correlation of a noise wave with itself is
	
2
1, 1
1
1
1
1
1
*
Corr(
( ),
( ))
( )
( )
( )
a a
n
n
n
n
n
C
a
t a
t
a
a
a
ω
ω
ω
=
=
=
	
(A.15)
The correlation coefficient between two noise processes is defined as
	
1
2
2
2
1
2
*
( )
( )
n
n
n
n
a
a
c
a
a
ω
ω
=
	
(A.16)
In many practical circuit noise analysis, we have to consider noise waves 
that are combinations of two noise waves
	
=
+
3
1
2
n
n
n
a
Aa
B a 	
(A.17)
where A and B are constants. Because all these quantities represent random 
processes, they cannot be added as vectors (frequency domain phasors).
It is only possible to find its mean square value that corresponds with 
the real power of it. We have
   
{
}
=
=
+
+
=
+
+
+
=
+
+
2
3
3
3
1
2
1
2
2
2
1
1
2
2
1
2
1
2
2
2
2
2
1
2
1
1
*
*
(
)(
)
*
*
*
*
2
*
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
a
a
a
Aa
Ba
Aa
Ba
A a a
B a
a
ABa a
ABa a
A a
B a
AB Re a a
	 (A.18)
As it is seen from (A.18), to find the noise power of noise wave source 
that is a combination of two noise wave sources, we have to know the correla-
tion between combined noise waves.

265
About the Author
Janusz A. Dobrowolski received an M.Sc. in 1965, a Ph.D. in 1973, and a 
D.Sc. in 1979, all in electronic engineering from the Warsaw University of 
Technology, Warsaw, Poland. Since 1965, he has been with the Institute of 
Electronic Systems, Department of Electronics and Information Technology, 
Warsaw University of Technology, Warsaw, Poland, where he is currently 
a full professor. From 1990 to 2005 he was the director of the Institute of 
Electronic Systems.
While on leave during the academic years 1974–1975 and 1983–1984, 
he was a research associate at the Department of Electrical Engineering, Uni-
versity of Manitoba, Winnipeg, Manitoba, Canada, where he worked on the 
development and design of antennas and microwave components for satellite 
communication systems.
His current interests are in the areas of computer-aided design of micro-
wave networks and microwave measurements.
Prof. Dobrowolski is a fellow of the IEEE.


267
Admittance matrix, 35
noise correlation matrix, 179
Analysis, 89–126, 203–240
signal flow graph, 96–99
signal, 89–126
two-port network, 100–114, 117
multielement network, 120–124
multiport network, 114–120
noise, 203–240
of two-ports, 211–214, 215–220
of multielement networks, 220–228
of multiport networks, 228–232
Cascade matrix, 48, 64–68
generalized, 64–68
noise representation, 175
Change of reference impedance, 51–56
Chain matrix, 171
noise representation, 171
scattering matrix interrelation, 172–175
Characteristic impedance, 11, 19
transmission line, 19, 184
waveguide, 11
Connection scattering matrix, 121, 221
matrix equations, 121
method, 120–124
Constant gain circles, 109–110
power, 109
available power, 110
Constant noise figure circles, 209–211
Conversion, 48, 50, 83
power scattering matrix—impedance 
matrix, 83
pseudo-scattering matrix—impedance 
matrix, 50
pseudo-scattering matrix—admittance 
matrix, 50
pseudo-scattering matrix—cascade 
matrix, 48
Correlation, 262
coefficient, 264
matrix, 169, 172, 175, 179, 181, 186
Coupled transmission lines, scattering 
matrix, 150
Current traveling waves, 8
De-embedding of cascaded noisy two-port 
networks, 198–200
Embedded multiports, 62–64
scattering matrix, 64
noise correlation matrix, 196–200
Gain, 100, 102, 103, 112, 113, 117, 120, 123 
available power, 103
maximum power, 108–109
transducer power, 100, 117, 123
power, 102, 120
voltage, 112
voltage transfer, 113
Generalized mixed mode scattering matrix 
138–146
uncoupled transmission lines, 146
Index

268 
Microwave Network Design Using the Scattering Matrix 
Generalized mixed mode scattering matrix 
(continued)
coupled transmission lines, 149
Wilkinson power divider, 152
Operational amplifier, 154
Harmonic superposition principle, 248
Impedance
characteristic, 11–12, 15,19
reference, 36, 39, 43, 51, 53, 73, 86
Impedance matrix
noise correlation matrix, 179
noise representation, 179
Independent signal source
circuit representation, 90
impressed wave, 90, 91
reflection coefficient, 90
Insertion loss, 110
Large signal
scattering functions, 242
device modeling, 243
network analyzer, 254
Load
impedance, 71, 92
circuit model, 92
signal flow graph, 98
Mode waves
common, 129, 131, 132
differential, 129, 131, 132
Mixed mode scattering matrix, 133, 138
transformation, 137
Modal fields, 8
Mode specific waves, 9
Multiport
passive, noise wave representation,  
181, 185
noise wave correlation matrix, 181, 185
cascade matrix, 64
Noise correlation matrices
admittance matrix representation, 179
cascade matrix representation, 175
chain matrix representation, 171
impedance matrix representation, 179
scattering matrix representation, 168, 169
Noise figure, 204, 205, 206, 208, 212, 217, 
224, 226, 230, 234, 238
Noise modeling
active two-port networks, 186
passive elements, 181, 184, 185
multiports, 181, 185
one-ports, 186
Noise representation
cascade matrix, 175
chain matrix, 171
admittance matrix, 179
impedance matrix, 179
scattering matrix, 168, 169
Noise waves
power waves, 166
pseudo waves, 167
Normalization
current waves, 9
voltage waves, 9
Passive multiports, noise wave correlation 
matrix, 181, 185
Physical interpretation
generalized scattering parameters, 30
power scattering parameters, 77
power waves, 75
Port connections, 85
nonreflecting, 86, 122
Power gain
available, 80, 103
circles, 109, 110
maximum 108
transducer 101
Power scattering matrix, 73
Power transmitted, 9, 20, 31, 37, 40, 43
Power waves
definition, 73
Principle of harmonic superposition, 248
Propagation constant, 15, 20
Pseudo-scattering matrix, 44
Pseudo-waves
definition, 43
Reciprocal network, 34, 45
Reference impedance
change, 51
transformation
one-port, 53
two-port, 55
multiport, 55

 
Index 
269
Reference plane 32
shift, 32
Reflection coefficient, 31
input port, 104, 108, 124
load, 22, 92, 94
output port, 104, 108
signal source, 90, 94
Response coefficients matrices,  
252
Scattering functions, 242 
Linearization, 245
Scattering matrix
connection method, 120
coupled transmission lines, 150
generalized, 36
mixed mode, 133
power-, 73
pseudo-, 44
true, 40
transmission line section, 34, 38, 41, 
47, 80
Signal to noise ratio, 227, 231, 235,  
236
Signal source,
circuit model, 90
flow graph, 97
Stability 103–107
two-port, 103
circles, 105
unconditional, 105, 107
Transmission lines, 17–26
characteristic impedance, 19
circuit model, 14, 18
equivalent circuit, 14
terminated, 21
Transformation of noise waves
three-port-to two-port, 195
two-port to three-port, 190
Two-port
wave noise representation, 168
signal flow graph, 98, 99
Voltage traveling waves, 8, 28, 36
Voltage gain, 112
Transfer gain, 113
Wave variables
power, 73
physical interpretation, 75
pseudo, 42
physical interpretation, 43
traveling intensities, 39
voltage traveling, 32, 36
Waveguide
characteristic impedance, 11
current, 13
voltage, 13
capacitance,14
conductance, 14
inductance, 14
resistance, 14


Recent Titles in the Artech House Microwave Library
Active Filters for Integrated-Circuit Applications, Fred H. Irons
Advanced Techniques in RF Power Amplifier Design, Steve C. Cripps
Automated Smith Chart, Version 4.0: Software and User's Manual,
Leonard M. Schwab
Behavioral Modeling of Nonlinear RF and Microwave Devices,
Thomas R. Turlington
Broadband Microwave Amplifiers, Bal S. Virdee, Avtar S. Virdee, and
Ben Y. Banyamin
Computer-Aided Analysis of Nonlinear Microwave Circuits,
Paulo J. C. Rodrigues
Designing Bipolar Transistor Radio Frequency Integrated Circuits,
Allen A. Sweet
Design of FET Frequency Multipliers and Harmonic Oscillators,
Edmar Camargo
Design of Linear RF Outphasing Power Amplifiers, Xuejun Zhang,
Lawrence E. Larson, and Peter M. Asbeck
Design Methodology for RF CMOS Phase Locked Loops,
Carlos Quemada, Guillermo Bistué, and Iñigo Adin
Design of RF and Microwave Amplifiers and Oscillators, Second
Edition, Pieter L. D. Abrie
Digital Filter Design Solutions, Jolyon M. De Freitas
Discrete Oscillator Design Linear, Nonlinear, Transient, and Noise
Domains, Randall W. Rhea
Distortion in RF Power Amplifiers, Joel Vuolevi and Timo Rahkonen
EMPLAN: Electromagnetic Analysis of Printed Structures in Planarly
Layered Media, Software and User’s Manual, Noyan Kinayman
and M. I. Aksun
An Engineer’s Guide to Automated Testing of High-Speed
Interfaces, José Moreira and Hubert Werkmann

Essentials of RF and Microwave Grounding, Eric Holzman
FAST: Fast Amplifier Synthesis Tool—Software and User’s Guide,
Dale D. Henkes
Feedforward Linear Power Amplifiers, Nick Pothecary
Foundations of Oscillator Circuit Design, Guillermo Gonzalez
Fundamentals of Nonlinear Behavioral Modeling for RF and
Microwave Design, John Wood and David E. Root, editors
Generalized Filter Design by Computer Optimization, Djuradj
Budimir
High-Linearity RF Amplifier Design, Peter B. Kenington
High-Speed Circuit Board Signal Integrity, Stephen C. Thierauf
Intermodulation Distortion in Microwave and Wireless Circuits,
José Carlos Pedro and Nuno Borges Carvalho
Introduction to Modeling HBTs, Matthias Rudolph
Lumped Elements for RF and Microwave Circuits, Inder Bahl
Lumped Element Quadrature Hybrids, David Andrews
Microwave Circuit Modeling Using Electromagnetic Field Simulation,
Daniel G. Swanson, Jr. and Wolfgang J. R. Hoefer
Microwave Component Mechanics, Harri Eskelinen and
Pekka Eskelinen
Microwave Differential Circuit Design Using Mixed-Mode
S-Parameters, William R. Eisenstadt, Robert Stengel, and
Bruce M. Thompson
Microwave Engineers’ Handbook, Two Volumes,
Theodore Saad, editor
Microwave Filters, Impedance-Matching Networks, and Coupling
Structures, George L. Matthaei, Leo Young, and E.M.T. Jones
Microwave Materials and Fabrication Techniques, Second Edition,
Thomas S. Laverghetta
Microwave Mixers, Second Edition, Stephen A. Maas

Microwave Network Design Using the Scattering Matrix,
Janusz A. Dobrowolski
Microwave Radio Transmission Design Guide, Second Edition,
Trevor Manning
Microwaves and Wireless Simplified, Third Edition,
Thomas S. Laverghetta
Modern Microwave Circuits, Noyan Kinayman and M. I. Aksun
Modern Microwave Measurements and Techniques, Second Edition,
Thomas S. Laverghetta
Neural Networks for RF and Microwave Design, Q. J. Zhang and
K. C. Gupta
Noise in Linear and Nonlinear Circuits, Stephen A. Maas
Nonlinear Microwave and RF Circuits, Second Edition,
Stephen A. Maas
QMATCH: Lumped-Element Impedance Matching, Software and
User’s Guide, Pieter L. D. Abrie
Practical Analog and Digital Filter Design, Les Thede
Practical Microstrip Design and Applications, Günter Kompa
Practical RF Circuit Design for Modern Wireless Systems, Volume I:
Passive Circuits and Systems, Les Besser and Rowan Gilmore
Practical RF Circuit Design for Modern Wireless Systems, Volume II:
Active Circuits and Systems, Rowan Gilmore and Les Besser
Production Testing of RF and System-on-a-Chip Devices for Wireless
Communications, Keith B. Schaub and Joe Kelly
Radio Frequency Integrated Circuit Design, Second Edition,
John W. M. Rogers and Calvin Plett
RF Bulk Acoustic Wave Filters for Communications,
Ken-ya Hashimoto
RF Design Guide: Systems, Circuits, and Equations, Peter Vizmuller
RF Measurements of Die and Packages, Scott A. Wartenberg
The RF and Microwave Circuit Design Handbook, Stephen A. Maas

RF and Microwave Coupled-Line Circuits, Rajesh Mongia, Inder Bahl,
and Prakash Bhartia
RF and Microwave Oscillator Design, Michal Odyniec, editor
RF Power Amplifiers for Wireless Communications, Second Edition,
Steve C. Cripps
RF Systems, Components, and Circuits Handbook, Ferril A. Losee
The Six-Port Technique with Microwave and Wireless Applications,
Fadhel M. Ghannouchi and Abbas Mohammadi
Solid-State Microwave High-Power Amplifiers, Franco Sechi and
Marina Bujatti
Stability Analysis of Nonlinear Microwave Circuits, Almudena Suárez
and Raymond Quéré
Substrate Noise Coupling in Analog/RF Circuits, Stephane Bronckers,
Geert Van der Plas, Gerd Vandersteen, and Yves Rolain
System-in-Package RF Design and Applications, Michael P. Gaynor
TRAVIS 2.0: Transmission Line Visualization Software and User's
Guide, Version 2.0, Robert G. Kaires and Barton T. Hickman
Understanding Microwave Heating Cavities, Tse V. Chow Ting Chan
and Howard C. Reader
For further information on these and other Artech House titles, in-
cluding previously considered out-of-print books now available
through our In-Print- Forever® (IPF®) program, contact:
Artech House Publishers
Artech House Books
685 Canton Street
16 Sussex Street
Norwood, MA 02062
London SW1V 4RW UK
Phone: 781-769-9750
Phone: +44 (0)20 7596 8750
Fax: 781-769-6334
Fax: +44 (0)20 7630 0166
e-mail: artech@artechhouse.com
e-mail:
artech-uk@artechhouse.com
Find us on the World Wide Web at: www.artechhouse.com

