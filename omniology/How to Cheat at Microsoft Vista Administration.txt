

w w w. s y n g re s s . c o m
Syngress is committed to publishing high-quality books for IT Professionals and deliv-
ering those books in media and formats that ﬁt the demands of our customers. We are
also committed to extending the utility of the book you purchase via additional mate-
rials available from our Web site. 
SOLUTIONS WEB SITE
To register your book, visit www.syngress.com/solutions. Once registered, you can access
our solutions@syngress.com Web pages. There you may ﬁnd an assortment of value-
added features such as free e-books related to the topic of this book, URLs of related
Web sites, FAQs from the book, corrections, and any updates from the author(s).
ULTIMATE CDs
Our Ultimate CD product line offers our readers budget-conscious compilations of some
of our best-selling backlist titles in Adobe PDF form. These CDs are the perfect way to
extend your reference library on key topics pertaining to your area of expertise,
including Cisco Engineering, Microsoft Windows System Administration, CyberCrime
Investigation, Open Source Security, and Firewall Conﬁguration, to name a few.
DOWNLOADABLE E-BOOKS
For readers who can’t wait for hard copy, we offer most of our titles in downloadable
Adobe PDF form. These e-books are often available weeks before hard copies, and are
priced affordably.
SYNGRESS OUTLET
Our outlet store at syngress.com features overstocked, out-of-print, or slightly hurt
books at signiﬁcant savings.
SITE LICENSING
Syngress has a well-established program for site licensing our e-books onto servers in
corporations, educational institutions, and large organizations. Contact us at sales@
syngress.com for more information.
CUSTOM PUBLISHING
Many organizations welcome the ability to combine parts of multiple Syngress books, as
well as their own content, into a single volume for their own internal use. Contact us at
sales@syngress.com for more information.
Visit us at


How to Cheat at
Microsoft
Jan Kanclirz Jr.
Technical Editor
Pawan K. Bhardwaj
Larry Chafﬁn
Laura Hunter
Gene Whitley

Elsevier, Inc., the author(s), and any person or ﬁrm involved in the writing, editing, or production (collectively
“Makers”) of this book (“the Work”) do not guarantee or warrant the results to be obtained from the Work.
There is no guarantee of any kind, expressed or implied, regarding the Work or its contents.The Work is sold AS IS
and WITHOUT WARRANTY.You may have other legal rights, which vary from state to state.
In no event will Makers be liable to you for damages, including any loss of proﬁts, lost savings, or other incidental or
consequential damages arising out from the Work or its contents. Because some states do not allow the exclusion or
limitation of liability for consequential or incidental damages, the above limitation may not apply to you.
You should always use reasonable care, including backup and other appropriate precautions, when working with
computers, networks, data, and ﬁles.
Syngress Media®, Syngress®,“Career Advancement Through Skill Enhancement®,”“Ask the Author UPDATE®,”
and “Hack Prooﬁng®,” are registered trademarks of Elsevier, Inc.“Syngress:The Deﬁnition of a Serious Security
Library”™,“Mission Critical™,” and “The Only Way to Stop a Hacker is to Think Like One™” are trademarks of
Elsevier, Inc. Brands and product names mentioned in this book are trademarks or service marks of their respective
companies.
KEY
SERIAL NUMBER
001
HJIRTCV764
002
PO9873D5FG
003
829KM8NJH2
004
BAL923457U
005
CVPLQ6WQ23
006
VBP965T5T5
007
HJJJ863WD3E
008
2987GVTWMK
009
629MP5SDJT
010
IMWQ295T6T
PUBLISHED BY
Syngress Publishing, Inc.
Elsevier, Inc.
30 Corporate Drive
Burlington, MA 01803
How to Cheat at Microsoft Vista Administration
Copyright © 2007 by Elsevier, Inc.All rights reserved. Printed in the United States of America. Except as permitted
under the Copyright Act of 1976, no part of this publication may be reproduced or distributed in any form or by
any means, or stored in a database or retrieval system, without the prior written permission of the publisher, with
the exception that the program listings may be entered, stored, and executed in a computer system, but they may
not be reproduced for publication.
Printed in the United States of America
1  2  3  4  5  6  7  8  9  0
ISBN-13: 978-1-59749-174-7
Publisher:Amorette Pedersen
Project Manager: Gary Byrne
Acquisitions Editor:Andrew Williams
Page Layout and Art: Patricia Lupien
Technical Editor: Jan Kanclirz
Copy Editors: Mike McGee,Audrey Doyle
Cover Designer: Michael Kavish
Indexer: Nara Wood
For information on rights, translations, and bulk sales, contact Matt Pedersen, Commercial Sales Director and
Rights, at Syngress Publishing; email m.pedersen@elsevier.com.

v
Technical Editor
Jan Kanclirz Jr. (CCIE #12136-Security, CCSP, CCNP, CCIP, CCNA,
CCDA, INFOSEC Professional, Cisco WLAN Support/Design Specialist) is
currently a Senior Network Information Security Architect at IBM Global
Services. Jan specializes in multivendor designs and post-sale implementa-
tions for several technologies such as VPNs, IPS/IDS, LAN/WAN, ﬁrewalls,
content networking, wireless, and VoIP. Beyond network designs and engi-
neering, Jan’s background includes extensive experience with open source
applications and Linux. Jan has contributed to several Syngress book titles:
Managing and Securing Cisco SWAN, Practical VoIP Security, and How to Cheat
at Securing a Wireless Network.
In addition to Jan’s full-time position at IBM G.S., Jan runs a security
portal, www.MakeSecure.com, where he dedicates his time to security
awareness and consulting. Jan lives in Colorado, where he enjoys outdoor
adventures. Jan would like to thank his family, slunicko, and friends for all of
their support.
Pawan K. Bhardwaj (MCSE, MCT, Security+, Network+, I-Net+ and
A+) is an independent technical trainer and author. He has been actively
involved in Windows administration ever since Windows NT 3.51 was
released. In the past 16 years he has worked at various system and network
support levels for small and medium-sized companies. Some of his major
projects included working for one of India’s largest newspaper groups and a
large e-commerce organization in the United States where he had an active
involvement in design and implementation of large-scale LAN and WAN
solutions based on Windows technologies.
Contributors

vi
In 1997, Pawan was one of the ﬁrst 100 in India to attain MCSE certi-
ﬁcation. He teaches Windows administration and networking classes and
also acts as a consultant to training institutions. He has authored or con-
tributed to more than 12 certiﬁcation books by Syngress/McGraw Hill. He
also coauthored MCSE 2003 Electives Exams in a Nutshell (O’Reilly Media,
Inc., 2006).
Larry Chafﬁn is the CEO/Chairman of Pluto Networks, a worldwide
network consulting company specializing in VoIP, WLAN, and security.An
accomplished author, he contributed to Syngress’s Managing Cisco Secure
Networks (ISBN: 1931836566); Skype Me! (ISBN: 1597490326); Practical
VoIP Security (ISBN: 1597490601); Conﬁguring Check Point NGX VPN-
1/FireWall-1 (ISBN: 1597490318); Conﬁguring Juniper Networks NetScreen
and SSG Firewalls (ISBN: 1597491187); and Essential Computer Security:
Everyone’s Guide to Email, Internet, and Wireless Security (ISBN: 1597491144).
He is the author of Building a VoIP Network with Nortel’s MS5100 (ISBN:
1597490784), and he has coauthored or ghostwritten 11 other technology
books on VoIP, WLAN, security, and optical technologies.
Larry has over 29 vendor certiﬁcations from companies such as Nortel,
Cisco Avaya, Juniper, PMI, isc2, Microsoft, IBM, VMware, and HP. Larry has
been a principal architect designing VoIP, security, WLAN, and optical net-
works in 22 countries for many Fortune 100 companies. He is viewed by
his peers as one of the most well respected experts in the ﬁeld of VoIP and
security in the world. Larry has spent countless hours teaching and con-
ducting seminars/workshops around the world in the ﬁeld of voice/VoIP,
security, and wireless networks. Larry is currently working on a follow-up
to Building a VoIP Network with Nortel’s MCS 5100 as well as new books on
Cisco VoIP networks, practical VoIP case studies, and WAN acceleration
with Riverbed.
Laura E. Hunter (CISSP, MCSE: Security, MCDBA, Microsoft MVP) is
an Active Directory architect with a publicly held engineering and stafﬁng
ﬁrm, where she provides network planning, implementation, and trou-
bleshooting services for Active Directory and other Microsoft technologies.
Her specialties include Windows 2000 and 2003 Active Directory design
and implementation, troubleshooting, and security topics. Laura has more

vii
than a decade of experience with Windows computers; her previous expe-
rience includes a position as an IT project leader with the University of
Pennsylvania and as the director of computer services for the Salvation
Army. She is a contributor to the TechTarget family of Web sites and to
Redmond Magazine (formerly Microsoft Certiﬁed Professional Magazine).
Laura has previously contributed to the Syngress Windows Server 2003
MCSE/MCSA DVD Guide & Training System series as a DVD presenter,
author, and technical reviewer. Laura is the author of the Active Directory
Consultant’s Field Guide (ISBN: 1-59059-492-4) from APress, and the coau-
thor of the Active Directory Cookbook, Second Edition (ISBN: 059610202X)
from O’Reilly Media. Laura is a four-time recipient of the prestigious
Microsoft MVP award in the area of Windows Server—Networking. Laura
holds a master’s degree in Computer Science from the University of
Pennsylvania and also works as a freelance writer, trainer, speaker and con-
sultant.
Gene Whitley (MBA, MCSE, MCSA) is the President of SiGR Solutions
(www.sigrsolutions.com), a systems integrator and value-added reseller in
Charlotte, NC. He entered into the systems integration and value-added
reseller industry in 1995, and in 2005, he started his own company, SiGR
Solutions, which provides services and product procurement for businesses
of all sizes, including Fortune 1000 companies.
Gene started his IT career in 1992 with Microsoft, earning his MCP in
1993 and MCSE in 1994. He has been the lead consultant and project
manager on numerous Active Directory and Exchange migration projects
for companies throughout the U.S. When not working, he spends his time
with his wife and best friend, Samantha. Gene holds an MBA from
Winthrop University and a BSBA in Management Information Systems
from the University of North Carolina at Charlotte.


ix
Contents
Chapter 1 Introducing and Installing Microsoft Vista . . . . 1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .2
Introduction to Windows Vista  . . . . . . . . . . . . . . . . . . . . . . .2
Installing Windows Vista . . . . . . . . . . . . . . . . . . . . . . . . . . . .5
Minimum Hardware Requirements  . . . . . . . . . . . . . . . . .5
Vista Capable and Vista Premium Ready PCs  . . . . . . .5
Checking Hardware Compatibility  . . . . . . . . . . . . . . . . .6
Checking the Compatibility of the System BIOS  . . . . . . .6
Obtaining Device Drivers 
Compatible with Windows Vista  . . . . . . . . . . . . . . . . . . .7
Knowing Your Disk Drives and Partitions . . . . . . . . . . . . .7
Deciding between a Clean Install or an Upgrade  . . . . . . .7
Performing a Clean Installation  . . . . . . . . . . . . . . . . . . . .8
Collecting Information . . . . . . . . . . . . . . . . . . . . . . . .8
Installing Windows . . . . . . . . . . . . . . . . . . . . . . . . . . .9
Setting Up Windows  . . . . . . . . . . . . . . . . . . . . . . . .10
Migrating to Windows Vista  . . . . . . . . . . . . . . . . . . . . . . . .11
Planning for an Upgrade  . . . . . . . . . . . . . . . . . . . . . . . .11
Hardware Compatibility  . . . . . . . . . . . . . . . . . . . . . .12
Application Compatibility . . . . . . . . . . . . . . . . . . . . .12
Windows Vista Upgrade Advisor . . . . . . . . . . . . . . . .12
Performing an Upgrade Installation  . . . . . . . . . . . . . . . .15
Collecting Information  . . . . . . . . . . . . . . . . . . . . . . .15
Upgrading Windows . . . . . . . . . . . . . . . . . . . . . . . . .16
Setting Up Windows  . . . . . . . . . . . . . . . . . . . . . . . .17
Upgrading from One Vista Edition to Another . . . . . . . .17
Migrating Previous Files and Settings  . . . . . . . . . . . . . . .18
Windows Easy Transfer  . . . . . . . . . . . . . . . . . . . . . . .18
User State Migration Tool . . . . . . . . . . . . . . . . . . . . .20
Automating Windows Vista Installations . . . . . . . . . . . . . . . .21
Unattended Installations  . . . . . . . . . . . . . . . . . . . . . . . .23
Windows Deployment Services  . . . . . . . . . . . . . . . . . . .23

x
Contents
Installing WDS . . . . . . . . . . . . . . . . . . . . . . . . . . . . .24
The System Preparation Tool  . . . . . . . . . . . . . . . . . . . . .24
Using the System Preparation Tool  . . . . . . . . . . . . . .25
Running Windows Vista  . . . . . . . . . . . . . . . . . . . . . . . . . . .27
Activating Windows Vista  . . . . . . . . . . . . . . . . . . . . . . .27
Updating Windows Vista . . . . . . . . . . . . . . . . . . . . . . . .28
Dual-Booting with Other Operating Systems . . . . . . . . .30
Running Windows Vista on a Virtual PC . . . . . . . . . . . .31
Installing Virtual Machine with Virtual PC 2007  . . . .32
Preparing the Virtual Machine for Windows Vista  . . .34
Installing Windows Vista on the Virtual PC . . . . . . . .35
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .37
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .37
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . . .39
Chapter 2 Installing and Maintaining 
Hardware Devices and Drivers . . . . . . . . . . . . . . . . . . . . . 41
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .42
Viewing Currently Installed Devices  . . . . . . . . . . . . . . . . . .42
Using the Device Manager to Manage Devices . . . . . . . .44
Installing and Maintaining Devices  . . . . . . . . . . . . . . . . . . .46
Installing Hardware Devices . . . . . . . . . . . . . . . . . . . . . .46
Installing a PnP Hardware Device  . . . . . . . . . . . . . . .47
Installing a non-PnP Hardware Device  . . . . . . . . . . .48
Maintaining Devices  . . . . . . . . . . . . . . . . . . . . . . . . . . .49
Disabling a Device  . . . . . . . . . . . . . . . . . . . . . . . . . .50
Enabling a Device  . . . . . . . . . . . . . . . . . . . . . . . . . .51
Uninstalling a Device  . . . . . . . . . . . . . . . . . . . . . . . .51
Removing a Device  . . . . . . . . . . . . . . . . . . . . . . . . .54
Device Drivers  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .55
Driver Signature Verification  . . . . . . . . . . . . . . . . . . . . .58
Updating Device Drivers . . . . . . . . . . . . . . . . . . . . . . . .61
Configuring Windows Update Driver Settings . . . . . .61
Manually Updating a Device Driver  . . . . . . . . . . . . .62
Rolling Back Drivers  . . . . . . . . . . . . . . . . . . . . . . . . . .64
Using Automated Help with Hardware  . . . . . . . . . . . . . . . .65
Windows Vista Hardware Assessment  . . . . . . . . . . . . . . .65
Windows Vista Upgrade Advisor  . . . . . . . . . . . . . . . . . .66

Contents
xi
Windows Help and Support  . . . . . . . . . . . . . . . . . . . . .66
Support for PnP Devices and Drivers . . . . . . . . . . . . . . .67
Customizing Hardware Devices . . . . . . . . . . . . . . . . . . . . . .68
Customizing Keyboard Settings  . . . . . . . . . . . . . . . . . . .68
Working with the Keyboard Device Driver  . . . . . . . .69
Customizing Mouse Settings  . . . . . . . . . . . . . . . . . . . . .70
Working with the Mouse Driver . . . . . . . . . . . . . . . .71
Customizing Audio Settings . . . . . . . . . . . . . . . . . . . . . .72
Setting the Volume Control  . . . . . . . . . . . . . . . . . . .72
Configuring Playback and Recording Devices  . . . . . .73
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .76
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .77
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . . .79
Chapter 3 Customizing Desktop Properties . . . . . . . . . . 81
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .82
Customizing the Display Appearance and Screensaver . . . . . .82
Customizing the Desktop Background . . . . . . . . . . . . . .82
The Vista Dual Time Zone Clock for Your Desktop  . . . .85
Vista Sidebar Gadgets  . . . . . . . . . . . . . . . . . . . . . . . . . .85
Customizing the Screensaver  . . . . . . . . . . . . . . . . . . . . .88
Customizing the Taskbar and Toolbar . . . . . . . . . . . . . . . . . .90
Customizing with Desktop Themes  . . . . . . . . . . . . . . . . . . .94
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .95
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .95
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . . .96
Chapter 4 Managing File Systems and Disks . . . . . . . . . . 97
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .98
Managing Basic and Dynamic Disks  . . . . . . . . . . . . . . . . . .98
Managing File System Formats, Partitions, and Volumes  . . .103
Partitions and Volumes . . . . . . . . . . . . . . . . . . . . . . . . .103
Partition Style . . . . . . . . . . . . . . . . . . . . . . . . . . . . .105
File Systems  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .111
FAT  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .111
FAT32  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .111
NTFS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .112
Compact Disc File System . . . . . . . . . . . . . . . . . . . . . .115
Universal Disk Format . . . . . . . . . . . . . . . . . . . . . . . . .115

xii
Contents
FSUTIL  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .117
Increasing File System Performance  . . . . . . . . . . . . . . . . . .118
Disk Defrag  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .118
Cluster Size (Allocation Unit) Adjustment  . . . . . . . . . .119
Short Filenames  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .119
Folder Structure  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .119
Compression . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .120
Relocating Pagefile.sys . . . . . . . . . . . . . . . . . . . . . . . . .120
Sharing File Systems  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .120
Public Folder Sharing  . . . . . . . . . . . . . . . . . . . . . . . . .120
Any Folder Sharing  . . . . . . . . . . . . . . . . . . . . . . . . . . .123
Implementing Local and Network File System Security  . . .126
Windows Rights Management Service . . . . . . . . . . . . .127
User Account Control  . . . . . . . . . . . . . . . . . . . . . . . .127
BitLocker  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .128
Encrypting File System  . . . . . . . . . . . . . . . . . . . . . . . .129
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .133
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .134
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .135
Chapter 5 General Administrative Tasks. . . . . . . . . . . . . 137
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .138
Backup and Recovery . . . . . . . . . . . . . . . . . . . . . . . . . . . .138
Backing Up and Restoring Files  . . . . . . . . . . . . . . . . .140
Scheduling Backup Jobs  . . . . . . . . . . . . . . . . . . . . .142
Backup Computer and Restore Computer  . . . . . . . . . .143
System Restore  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .144
Creating a System Restore Point  . . . . . . . . . . . . . . .145
Using System Restore . . . . . . . . . . . . . . . . . . . . . . .146
Printer Management  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .148
Installing a Local Printer  . . . . . . . . . . . . . . . . . . . . . . .149
Automatic Detection and Installation . . . . . . . . . . . .149
Manual Installation  . . . . . . . . . . . . . . . . . . . . . . . . .149
Installing a Network Printer  . . . . . . . . . . . . . . . . . .151
Configuring Printer Properties . . . . . . . . . . . . . . . . . . .153
Sharing a Printer . . . . . . . . . . . . . . . . . . . . . . . . . . . . .153
Setting Printer Permissions  . . . . . . . . . . . . . . . . . . . . .155
Working with Print Management  . . . . . . . . . . . . . . . .156

Contents
xiii
Listing and Removing Printers in Active Directory  .158
Managing Device Drivers  . . . . . . . . . . . . . . . . . . . .158
Managing Print Jobs  . . . . . . . . . . . . . . . . . . . . . . . .159
Administer via Remote . . . . . . . . . . . . . . . . . . . . . . . . . . .160
Configuring the Remote Desktop Host  . . . . . . . . . . . .160
Configuring the Remote Desktop Client  . . . . . . . . . . .162
Firewall Settings for Remote Desktop Connection  . . . .164
Scheduling Tasks and Managing Time and Date  . . . . . . . . .165
Creating Scheduled Tasks . . . . . . . . . . . . . . . . . . . . . . .167
Creating a Basic Task  . . . . . . . . . . . . . . . . . . . . . . .167
Creating an Advanced Task  . . . . . . . . . . . . . . . . . . .169
Troubleshooting Scheduled Tasks . . . . . . . . . . . . . . .171
Managing Date and Time  . . . . . . . . . . . . . . . . . . . . . .171
Daylight Saving Time  . . . . . . . . . . . . . . . . . . . . . . .172
Synchronizing with the Internet Time Server . . . . . .173
Working with Power Plans  . . . . . . . . . . . . . . . . . . . . . . . .174
Changing Standard Power Plan Settings  . . . . . . . . . . . .175
Power Buttons and Password Protection on Wakeup  . . .177
Creating a Custom Power Plan  . . . . . . . . . . . . . . . . . .178
Managing Services  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .179
Configuring Service Properties  . . . . . . . . . . . . . . . . . .180
Changing the Startup Type of a Service  . . . . . . . . . .181
Configuring Service Recovery Options . . . . . . . . . .182
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .183
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .183
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .185
Chapter 6 Managing Local Networking Essentials . . . . 187
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .188
A New Generation of TCP/IP  . . . . . . . . . . . . . . . . . . . . .188
IPv6 and Dual Layer  . . . . . . . . . . . . . . . . . . . . . . . . . .188
Overview of IPv6 Addressing  . . . . . . . . . . . . . . . . .189
Windows Vista Support for IPv6 . . . . . . . . . . . . . . .189
Name Resolution . . . . . . . . . . . . . . . . . . . . . . . . . .189
DHCPv6  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .190
What Is Dual Layer Architecture?  . . . . . . . . . . . . . .190
Configuring TCP/IP in Vista  . . . . . . . . . . . . . . . . . . . . . .191
How to Configure TCP/IPv4 in Vista  . . . . . . . . . . . . .191

xiv
Contents
How to Configure TCP/IPv6 in Vista  . . . . . . . . . . . . .194
Enabling and Disabling IPv6  . . . . . . . . . . . . . . . . . . . .197
The Network and Sharing Center  . . . . . . . . . . . . . . . . . . .198
Network Explorer . . . . . . . . . . . . . . . . . . . . . . . . . . . .200
Network Discovery  . . . . . . . . . . . . . . . . . . . . . . . .200
File and Printer Sharing  . . . . . . . . . . . . . . . . . . . . .202
Public Folder Sharing  . . . . . . . . . . . . . . . . . . . . . . .202
Media Sharing  . . . . . . . . . . . . . . . . . . . . . . . . . . . .203
Network Location Types  . . . . . . . . . . . . . . . . . . . . . . .203
The Network Map  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .204
Network Access Protection  . . . . . . . . . . . . . . . . . . . . . . .206
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .210
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .210
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .212
Chapter 7 Managing the Wireless 
World and Its Security . . . . . . . . . . . . . . . . . . . . . . . . . . . 213
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .214
What’s New with Wireless in Vista? . . . . . . . . . . . . . . . . . .214
Single Sign-on Feature  . . . . . . . . . . . . . . . . . . . . . . . .214
Behavior Change with No 
Preferred Wireless Network Available  . . . . . . . . . . . . . .215
Hidden Wireless Network Support  . . . . . . . . . . . . . . .215
Command-Line Configuration  . . . . . . . . . . . . . . . . . .215
WPA2 Support  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .216
Integration with NAP  . . . . . . . . . . . . . . . . . . . . . . . . .216
Understanding Wireless Security in Vista  . . . . . . . . . . . . . .216
Passive and Active Countermeasures . . . . . . . . . . . . . . .217
Connecting to Unprotected Networks  . . . . . . . . . . . . .219
Improved Ad Hoc Networking Security . . . . . . . . . . . .220
Single Sign-On  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .220
Network Location Types  . . . . . . . . . . . . . . . . . . . . . . .220
Security Protocols  . . . . . . . . . . . . . . . . . . . . . . . . . . . .221
Extensibility via EAPHost  . . . . . . . . . . . . . . . . . . . . . .222
Installing a Wireless Network  . . . . . . . . . . . . . . . . . . . . . .223
Wireless Networking Protocols  . . . . . . . . . . . . . . . . . .223
Setting Up Infrastructure Mode  . . . . . . . . . . . . . . . . . .224
Setting Up the Wireless Router . . . . . . . . . . . . . . . .224
Connecting to a Wireless Router  . . . . . . . . . . . . . .229

Contents
xv
Setting Up an Ad Hoc Network  . . . . . . . . . . . . . . . . .240
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .243
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .243
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .244
Chapter 8 Managing Security Essentials . . . . . . . . . . . . 247
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .248
Managing the Windows Firewall and IPSec  . . . . . . . . . . . .248
Windows Filtering Platform . . . . . . . . . . . . . . . . . . . . .249
Windows Service Hardening  . . . . . . . . . . . . . . . . . . . .250
Firewall Profiles . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .250
Windows Firewall Setup  . . . . . . . . . . . . . . . . . . . . . . .251
Built-In Firewall Exceptions  . . . . . . . . . . . . . . . . . .254
Managing the Windows Firewall for Enterprises  . . . . . .258
Windows Firewall with Advanced Security Snap-In 258
Windows Firewall with 
Advanced Security Node in Group Policy  . . . . . . . .261
Managing the Windows Firewall with netsh . . . . . . .261
Using Scripts to Manage the Windows Firewall  . . . .262
Creating Firewall Rules  . . . . . . . . . . . . . . . . . . . . . . . .263
Monitoring the Firewall  . . . . . . . . . . . . . . . . . . . . .268
IPSec Integration  . . . . . . . . . . . . . . . . . . . . . . . . . . . .269
New IPSec Features  . . . . . . . . . . . . . . . . . . . . . . . .269
Managing Patching  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .275
Windows Update Settings  . . . . . . . . . . . . . . . . . . . . . .277
Installing Updates Automatically  . . . . . . . . . . . . . . .279
Choosing Whether to Install Downloaded Updates  281
Checking for Updates but Choosing 
Whether to Download and Install Them  . . . . . . . . .281
Never Checking for Updates  . . . . . . . . . . . . . . . . .282
Using Microsoft Update  . . . . . . . . . . . . . . . . . . . . . . .282
Installing Microsoft Update . . . . . . . . . . . . . . . . . . .282
Enabling and Disabling Microsoft Update  . . . . . . . .283
Managing Updates  . . . . . . . . . . . . . . . . . . . . . . . . . . .283
Checking for Updates . . . . . . . . . . . . . . . . . . . . . . .283
Installing Updates  . . . . . . . . . . . . . . . . . . . . . . . . . .284
Viewing the Update History  . . . . . . . . . . . . . . . . . .286

xvi
Contents
Restoring Hidden Updates  . . . . . . . . . . . . . . . . . . .287
Uninstalling Updates . . . . . . . . . . . . . . . . . . . . . . . .287
Managing Malware Protection . . . . . . . . . . . . . . . . . . . . . .290
Using Windows Defender  . . . . . . . . . . . . . . . . . . . . . .291
How to Use the Windows Defender Software Explorer 294
Using Software Explorer  . . . . . . . . . . . . . . . . . . . . .295
Managing Internet Browser Security  . . . . . . . . . . . . . . . . .297
Introduction to Web Browser Security  . . . . . . . . . . . . .297
Browser Exploits . . . . . . . . . . . . . . . . . . . . . . . . . . .297
Web Spoofing . . . . . . . . . . . . . . . . . . . . . . . . . . . . .298
Configuring Internet Explorer Securely  . . . . . . . . . . .299
Protected Mode  . . . . . . . . . . . . . . . . . . . . . . . . . . .300
ActiveX Opt-In  . . . . . . . . . . . . . . . . . . . . . . . . . . .300
Fix My Settings  . . . . . . . . . . . . . . . . . . . . . . . . . . .301
The Security Status Bar  . . . . . . . . . . . . . . . . . . . . .302
Windows Defender . . . . . . . . . . . . . . . . . . . . . . . . .302
Setting Internet Zones  . . . . . . . . . . . . . . . . . . . . . .303
Configuring Privacy  . . . . . . . . . . . . . . . . . . . . . . . .304
Advanced Security Settings  . . . . . . . . . . . . . . . . . .307
Configuring the Microsoft Phishing Filter   . . . . . . . . .308
Managing User Account Controls  . . . . . . . . . . . . . . . . . . .310
Using User Access Control  . . . . . . . . . . . . . . . . . . . . .311
Marking an Application . . . . . . . . . . . . . . . . . . . . . .312
Using the Local Security Policy to Configure UAC 313
Disabling UAC When Installing Applications  . . . . .314
Changing the Prompt for UAC . . . . . . . . . . . . . . . .314
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .316
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .316
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .319
Chapter 9 Securing User Access . . . . . . . . . . . . . . . . . . . 321
Improving the Logon Architecture . . . . . . . . . . . . . . . . . . .322
Impact of Session 0 Isolation  . . . . . . . . . . . . . . . . . . . .323
User Account Control . . . . . . . . . . . . . . . . . . . . . . . . . . . .327
How UAC Protects Administrators . . . . . . . . . . . . . . . .329
Marking an Application  . . . . . . . . . . . . . . . . . . . . . . . .331
UAC Virtualization  . . . . . . . . . . . . . . . . . . . . . . . . . . .332
Configuring UAC  . . . . . . . . . . . . . . . . . . . . . . . . . . . .332

Contents
xvii
Group Policy Settings for UAC  . . . . . . . . . . . . . . . .333
Disabling UAC in the Control Panel  . . . . . . . . . . . .334
Disabling UAC via Msconfig.exe . . . . . . . . . . . . . . .335
Disable UAC via the Registry . . . . . . . . . . . . . . . . .337
Managing User Accounts  . . . . . . . . . . . . . . . . . . . . . . . . .338
Account Types in Vista . . . . . . . . . . . . . . . . . . . . . . . . .338
Administrator  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .338
Standard User . . . . . . . . . . . . . . . . . . . . . . . . . . . . .339
Guest  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .339
Creating User Accounts . . . . . . . . . . . . . . . . . . . . . . . .340
Creating a User with the User Interface  . . . . . . . . .340
Creating a User Account via the Command Prompt  343
Adding Users to Local Groups . . . . . . . . . . . . . . . . . . .345
Using the User Interface for 
Creating Groups and Adding Users  . . . . . . . . . . . . .345
Using the Command Line for 
Creating Groups and Adding Users  . . . . . . . . . . . . .348
Using a Guest Account in Vista  . . . . . . . . . . . . . . . . . .350
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .352
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .352
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .354
Chapter 10 Tuning for Better Performance . . . . . . . . . . 355
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .356
The Windows Experience Index  . . . . . . . . . . . . . . . . . . . .356
Optimizing Windows Startup  . . . . . . . . . . . . . . . . . . . . . .359
Stopping a Program from 
Loading Automatically on Startup  . . . . . . . . . . . . . . . .359
Turning Off Windows Features  . . . . . . . . . . . . . . . . . .361
Visual Effects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .362
Optimizing the Hard Disk . . . . . . . . . . . . . . . . . . . . . . . . .364
Disk Cleanup  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .364
Permanently Deleting Files from the Recycle Bin  . .367
Disk Defragmentation  . . . . . . . . . . . . . . . . . . . . . . . . .368
Checking Disks for Errors  . . . . . . . . . . . . . . . . . . . . . .370
Optimizing Memory . . . . . . . . . . . . . . . . . . . . . . . . . . . . .372
Adjusting Virtual Memory . . . . . . . . . . . . . . . . . . . . . .373
Enabling Automatic Allocation of Virtual Memory . .374

xviii
Contents
Windows ReadyBoost . . . . . . . . . . . . . . . . . . . . . . . . .375
Enabling ReadyBoost  . . . . . . . . . . . . . . . . . . . . . . .375
Configuring ReadyBoost Properties  . . . . . . . . . . . .375
Protecting Memory from Malicious Applications  . . . . .377
Enabling Data Execution Prevention  . . . . . . . . . . . .377
Optimizing Applications  . . . . . . . . . . . . . . . . . . . . . . . . . .378
Optimizing the Network Connection  . . . . . . . . . . . . . . . .379
Using Software Explorer to 
Identify Network Connected Programs  . . . . . . . . . . . .380
Using Task Manager to View 
Network Performance and Connected Users  . . . . . . . .381
Using the Task Manager to View Connected Users  .382
Using Reliability and Performance 
Monitor to View Network Performance  . . . . . . . . . . .383
Improving Network Performance . . . . . . . . . . . . . . . . .384
Uninstalling Unused 
Network Protocols and Services  . . . . . . . . . . . . . . .384
Keeping the Network Device Driver Updated . . . . .385
Installing Fast Network Adapters  . . . . . . . . . . . . . . .385
Closing Unused Network Programs  . . . . . . . . . . . .385
Disconnecting Unwanted Network Users  . . . . . . . .386
Disconnecting Unused Mapped Network Drives  . . .386
Turning Off Public Folder Sharing if Not Required  386
Turning Off Media Sharing If Not Required . . . . . .387
Keeping the Computer 
Closer to Wireless Access Point  . . . . . . . . . . . . . . . .388
Monitoring Performance . . . . . . . . . . . . . . . . . . . . . . . . . .389
Monitoring System Activities . . . . . . . . . . . . . . . . . . . .390
Using the Performance Monitor  . . . . . . . . . . . . . . . . .392
Adding Counters to the Performance Monitor . . . . .393
Working with Performance Logs  . . . . . . . . . . . . . . .394
Using the Reliability Monitor  . . . . . . . . . . . . . . . . . . .395
Creating Data Collector Sets  . . . . . . . . . . . . . . . . . . . .397
Creating a Data Collector Set Using a Wizard  . . . . .397
Creating a Data Collector Set from a Template . . . . .398
Creating a Data Collector Set 
from the Performance Monitor  . . . . . . . . . . . . . . . .399
Creating Performance Alerts 
Using Data Collector Sets  . . . . . . . . . . . . . . . . . . . .399

Contents
xix
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .401
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .401
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .404
Chapter 11 Troubleshooting . . . . . . . . . . . . . . . . . . . . . . 407
Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .408
Working with Windows Remote Assistance  . . . . . . . . . . . .408
Enabling Remote Assistance . . . . . . . . . . . . . . . . . . . . .408
Getting Help with Remote Assistance  . . . . . . . . . . . . .410
Working with Logs and Errors . . . . . . . . . . . . . . . . . . . . . .415
Opening the Event Viewer Console . . . . . . . . . . . . . . .415
Event Levels  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .418
Using Custom View Filters  . . . . . . . . . . . . . . . . . . . . .419
Network Connectivity and TCP/IP . . . . . . . . . . . . . . . . . .421
The Network and Sharing Center  . . . . . . . . . . . . . . . .422
Network Discovery  . . . . . . . . . . . . . . . . . . . . . . . . . . .424
Diagnosing and Repairing the Connection . . . . . . . . . .424
Command-Line Network Diagnostic Utilities  . . . . . . .426
ipconfig  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .426
ping  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .428
tracert  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .430
Troubleshooting Common Connectivity Problems  . . . .431
Data Access Issues  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .432
Disabled File Sharing . . . . . . . . . . . . . . . . . . . . . . . . . .432
Permissions  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .434
Effective Permissions . . . . . . . . . . . . . . . . . . . . . . . .434
Encryption  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .436
An Access Denied Message 
Appears When Opening an Encrypted File  . . . . . . .436
Inability to Open Files after 
Transferring from Another Computer  . . . . . . . . . . .436
The Caching of Offline Files  . . . . . . . . . . . . . . . . . . . .437
Windows Help and Support  . . . . . . . . . . . . . . . . . . . . . . .438
Problem Reports and Solutions  . . . . . . . . . . . . . . . . . . . . .441
Summary  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .443
Solutions Fast Track  . . . . . . . . . . . . . . . . . . . . . . . . . . . . .443
Frequently Asked Questions  . . . . . . . . . . . . . . . . . . . . . . .445
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447


1
Introducing 
and Installing
Microsoft Vista
Solutions in this chapter:
■
Introduction to Windows Vista
■
Installing Windows Vista
■
Migrating to Windows Vista
■
Automating Windows Vista Installations
■
Running Windows Vista
Chapter 1
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
The Microsoft Windows Vista operating system offers several changes and improvements over its pre-
decessors. It not only brings a new and redesigned interface, but also improves on many administra-
tive utilities and management consoles, as well as enhancing the system’s reliability, performance, and
problem-solving tools. Needless to say, the 3-D interface,Aero, is the most attractive feature of
Windows Vista. But that’s for users. For you, as administrators, Vista will sometimes look like its pre-
decessor, Windows XP, and at other times, look like an all-new operating system. By the end of this
chapter, you should have a solid idea of all the important changes and improvements the new
Microsoft Vista has to offer.You will also understand the different versions of Microsoft Vista and
their hardware as well as license requirements.
We will go over the installation and upgrade process step by step so you are ready to install or
upgrade your own Microsoft Vista. In this chapter, and throughout this book, you will ﬁnd step-by-step
instructions on how to successfully work with different administrative tools available in Windows Vista.
Here, we will ﬁrst take a look at various Windows Vista editions, the features available in each
edition, the attended and unattended installation of Windows Vista, and procedures to migrate from
earlier versions of Windows such as Windows XP.Toward the chapter’s end, we will look at running
Microsoft Vista in a multiboot environment as well as in a virtual operation system.
Introduction to Windows Vista
Let’s ﬁrst take a look at different versions of Windows Vista. It comes in six different editions, each
targeted at different home and business market segments.All editions of Windows Vista, except the
Windows Vista Starter edition, are available for 32-bit Intel x86-based processors, as well as 64-bit
processors.Available Windows Vista editions are
■
Starter This edition is available only in developing countries where piracy is a major con-
cern, so it is not available in United States or Europe. It does not include the Windows
Aero interface.
■
Home Basic This edition is targeted at basic home users and mainly includes entertain-
ment features.This edition also does not include the Windows Aero interface.
■
Home Premium This edition has additional entertainment features for the home user.
■
Business This edition is the starting point for basic business requirements.
■
Enterprise This edition is for use in corporate environments and includes enhanced man-
agement features such as Group Policies.
■
Ultimate This edition includes all features available in other editions.
Let’s take a look at the different Windows Vista editions and the features included with each.
Table 1.1 lists some of the key differences in the Windows Vista editions.
www.syngress.com
2
Chapter 1 • Introducing and Installing Microsoft Vista

Table 1.1 Comparing Windows Vista Editions
Home 
Home 
Feature
Basic
Premium
Business
Enterprise
Ultimate
BitLocker Drive 
Yes
Yes
Encryption
GPO-based Power 
Yes
Yes
Yes
Management
Desktop 
Yes
Yes
Yes
Deployment Tools
Encrypting File 
Yes
Yes
Yes
System
Folder Redirection
Yes
Yes
Yes
GPO Support
Yes
Yes
Yes
Internet 
Yes
Yes
Yes
Information 
Server 7
Ability to Join a 
Yes
Yes
Yes
Domain
Network Access 
Yes
Yes
Yes
Protection Client 
Agent
Ofﬂine Files
Yes
Yes
Yes
Policy-based QoS
Yes
Yes
Yes
Rights Management
Yes
Yes
Yes
Services Client
Remote Desktop
Client 
Client 
Yes
Yes
Yes
Service 
Service 
Only
Only
Roaming User 
Yes
Yes
Yes
Proﬁles
Scheduled Backups
Yes
Yes
Yes
Yes
Backup to a 
Yes
Yes 
Yes
Yes
Network Computer 
or Device
Subsystem for Unix-
Yes
Yes
based Applications
Themed Slide Shows
Yes
Yes
User Account 
Yes
Yes
Yes
Yes
Yes
Control
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
3
Continued

Table 1.1 continued Comparing Windows Vista Editions
Home 
Home 
Feature
Basic
Premium
Business
Enterprise
Ultimate
Complete PC Image 
Yes
Yes
Yes
Backup and 
Recovery
Multiprocessor 
Yes
Yes
Support
Maximum RAM 
4GB
4GB
4GB
4GB
4GB
32-bit
Maximum RAM 
8GB
16GB
128GB
128GB
128GB
64-bit
Tablet PC Support
Yes
Yes
Yes
Yes
Volume Shadow 
Yes
Yes
Yes
Copy
Windows Anytime 
Yes
Yes
Yes
Upgrade
Windows Aero
Yes
Yes
Yes
Yes
Virtual PC Express
Yes
Yes
Windows DVD 
Yes
Yes
Maker
Windows Fax 
Yes
Yes
Yes
and Scan
Windows Firewall
Yes
Yes
Yes
Yes
Yes
Windows Media 
Yes
Yes
Center
Windows Meeting 
Read Only
Yes
Yes
Yes
Yes
Space
Windows Movie 
Yes
Yes
Yes
Maker
Windows Side Show
Yes
Yes
Yes
Wireless Network 
Yes
Yes
Yes
Provisioning
Windows Anti-
Yes
Yes
Yes
Yes
Yes
phishing Filter in 
IE7 and Mail
Xbox 360
Yes
Yes
www.syngress.com
4
Chapter 1 • Introducing and Installing Microsoft Vista

Besides the features listed in Table 1.1, sundry others are available depending on the edition you
choose. Microsoft has provided a detailed comparison of different editions and their supported fea-
tures at its Web site: www.microsoft.com/windows/products/windowsvista/editions/choose.mspx.
NOTE
Unlike Windows XP, which had separate editions for Media Center and Tablet PC,
Windows Vista does not include any editions for these capabilities. While Windows
Media Center is included as a standard feature in the Home Premium and Ultimate
editions, Tablet PC support is included in the Home Premium, Business, Enterprise,
and Ultimate editions.
You may have noticed from Table 1.1 that the Home Basic, Home Premium, and Business edi-
tions include a feature called Windows Anytime Upgrade.This feature enables a user to upgrade the
existing edition of Windows Vista to a higher edition any time after the installation. Windows Anytime
Upgrade, which is a Control Panel utility, is covered later in this chapter in the section “Migrating to
Windows Vista.” We will also take a look at other upgrade options.
Installing Windows Vista
Perhaps there is nothing easier than installing Windows Vista.A clean install of Windows Vista is
pretty straightforward. It is interesting that, unlike Windows XP, there is no text phase in the installa-
tion process. But, before you insert the Vista DVD in your DVD drive and start the installation, there
are certain preparatory steps you must complete. Some of the essential things you should do include
the following.
Minimum Hardware Requirements
Windows Vista will need different minimum hardware for different editions. If you have just pur-
chased a new computer, it is unlikely it will not meet the minimum hardware requirements. Indeed,
most new PCs will surpass these requirements. Verifying that your PC has the speciﬁed minimum
hardware is critical when you want to use your old PC to install Windows Vista.
Vista Capable and Vista Premium Ready PCs
Microsoft provides a broad classiﬁcation of minimum hardware requirements as Vista Capable PC and
Vista Premium Ready PC. Even if you do not have a PC with any of these logos, you must make sure
your PC meets the requirements for these categories.Table 1.2 lists the minimum hardware require-
ments for each of these PCs.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
5

Table 1.2 Minimum Hardware Requirements
Hardware Component
Vista Capable PC
Vista Premium Ready PC
CPU
800MHz or faster 32-bit 
1GHz or faster 32-bit or
or 64-bit processor
64-bit processor
Physical Memory (RAM)
512MB
1GB
Hard Disk Drive
20GB with minimum 
40GB with minimum 15GB 
15GB free disk space
free disk space
Graphics Processor
SVGA adapter with 
Video adapter compatible 
DirectX-9 Support and 
with DirectX 9, WDDM 
min of 800 x 600 
driver support and 
resolution
minimum 128MB RAM
Optical Drive
CD- or DVD-ROM Drive
DVD-ROM Drive
When you buy a new PC, which has a Windows Vista Capable PC logo or the Windows Vista
Premium Ready PC log, you can be sure the PC meets or surpasses the minimum hardware require-
ments. In order to support all the enhanced features of Windows Vista, the hardware requirements
and capabilities may be different from the minimum requirements.
Checking Hardware Compatibility
In case you are preparing to install Windows Vista on an old computer, you must check that the
computer meets the minimum hardware requirements, as given in Table 1.2.Additionally, you must
also make sure that all hardware components are compatible with the Windows Vista operating
system. Microsoft maintains a list of supported hardware for every operating system.You can check
the latest, updated version of the Hardware Compatibility List (HCL) by visiting Microsoft’s Web site at
https://winqual.microsoft.com/HCL/Default.aspx.
On this Web page, you can select the Windows Vista Logo, the type of processor (32-bit or 64-
bit) and the category of the hardware device. When you click the Start button, a list of products
along with the manufacturer name is displayed.
Checking the Compatibility of the System BIOS
Successful installation and availability of most Windows Vista features requires that your system BIOS
be compatible with Windows Vista. Certain features such as Plug and Play (PnP), Advanced
Conﬁguration and Power Interface (ACPI), BitLocker Drive Encryption, and so on are available only if the
system BIOS supports them. Make sure the system BIOS is compatible with Windows Vista. If it
isn’t, contact the system vendor, BIOS manufacturer, or the Web site to look for an updated version
of the system BIOS.
www.syngress.com
6
Chapter 1 • Introducing and Installing Microsoft Vista

Obtaining Device Drivers 
Compatible with Windows Vista
Although Windows Vista includes hundreds of device drivers for most common PnP devices, you
may still need to obtain device drivers for specialized hardware components.At the least, you must
make sure the device drivers you have will work on Windows Vista. Chapter 2 offers a detailed dis-
cussion on devices and drivers.
Knowing Your Disk Drives and Partitions
When installing the Windows Vista operating system, you must decide about hard disk drives and the
number of partitions you will need. Microsoft recommends that in case you need to create more than
one disk partition, you should create only one partition during installation.This should be the parti-
tion where you will install Windows Vista (the system and boot partition). Other partitions should be
created after the installation is complete. Disk management is covered in greater detail in Chapter 5.
Deciding between a Clean Install or an Upgrade
Finally, you should decide whether you wish to perform a fresh installation, or upgrade the previously
installed operating system to Windows Vista. On a new PC, you will perform a clean install.The
upgrade option exists only if you have another operating system running on the computer.
Remember that not all previous versions of Windows operating systems can be upgraded to
Windows Vista. In Microsoft terminology, a fresh installation is known as a clean install and the
upgrade process is known as an in-place upgrade.
When you perform a clean install, the old Windows operating system is replaced by Windows
Vista.You will need to reinstall all your applications.The previous data ﬁles and settings are retained
and can be transferred using the Windows Easy Transfer Wizard. The Windows Easy Transfer Wizard is
discussed later in this chapter. When you perform an in-place upgrade, Windows Vista retains all your
applications and user settings as well as the data ﬁles.
Ideally, you should perform a clean install when:
■
The system does not currently have any operating system installed.
■
The currently installed operating system cannot be directly upgraded. In other words, no
upgrade path exists from the current operating system to Windows Vista.These include
MS-DOS, Windows 9x, Windows ME, Windows NT, and Windows 2000 Professional.
■
You do not want to keep the existing applications or application settings.
■
You do not want to keep the existing user and group accounts and other user-deﬁned 
settings.
■
You want to make the system dual-boot or multiboot between Windows Vista and an
older Windows operating system.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
7

You should perform an in-place upgrade when:
■
An upgrade path exists from the currently installed Windows operating system to Windows
Vista.These systems include Windows XP Home, Windows XP Professional, Windows XP
Tablet PC, and Windows XP 64-bit Edition.
■
You want to keep the existing applications and its settings.
■
You want to keep the existing user-deﬁned settings.
Later in this chapter, we will take a look at upgrading to Windows Vista and migrating system,
application, and user settings to Windows Vista in the section “Migrating to Windows Vista.”
Performing a Clean Installation
Windows Vista installation can be started either directly from the DVD or from setup ﬁles located on
a network ﬁle server. When you use the DVD media for installation, the setup program starts auto-
matically as soon as you insert the DVD and restart your computer. Windows Vista DVD is bootable
and will start the installation process.The entire installation process is split into the following three
sections:
■
Collecting Information
■
Installing Windows
■
Set Up Windows
We will summarize various steps involved in each phase in the following sections.
Collecting Information
The steps involved in this phase of clean installation are as follows:
1.
Insert the Windows Vista DVD in the DVD drive and restart your computer. When
prompted, select the DVD drive as the boot drive.Alternatively, if you are currently run-
ning an operating system, you can run the setup.exe ﬁle from the DVD.The setup program
starts the Windows Pre-installation Environment (Windows PE) and begins copying ﬁles to
your computer.
2.
In the Install Windows dialog box, select the language, time and currency format, and the
keyboard layout. Click Next.
3.
Click the Install Now button that appears in the center of the screen.This page also
shows two more options: What to Know Before Installing Windows and Repair Your
Computer.
4.
Type in the 25-digit Product Key when prompted. Click Next.You need not insert
dashes when typing the Product Key.The setup will insert dashes automatically.
5.
Read the License Terms in the next page. Click I accept the license terms (required
to use Windows). Click Next.
www.syngress.com
8
Chapter 1 • Introducing and Installing Microsoft Vista

6.
Select Custom (Advanced) as the installation type since you are performing a clean
install.You can select the installation drive and change disk partitions.
7.
When prompted, choose the disk drive to which you want to install Windows. Click Next.
8.
If the disk or partition you selected in the previous step contains another version of
Windows, the Setup program will display a warning prompt that existing user and applica-
tion settings will be relocated to a folder named Windows.old.The prompt also says you
must copy these settings to the new operating system in case you wish to use them. Read
the warning prompt and click OK.
Installing Windows
Once the setup program has collected the necessary information, it proceeds to the next step and
starts installing Windows on your computer. During this phase of the installation, the system restarts
several times. Figure 1.1 shows the steps to be completed by the Setup program.
Figure 1.1 Installing Windows
The steps involved in this phase are as follows:
1.
The Setup program copies Windows Vista ﬁles to the hard disk location you earlier
selected.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
9

2.
The copied ﬁles are in a compressed state.These ﬁles are then expanded.
3.
Windows Vista features are installed.The installed features depend on the system hardware
that the Setup program detects.
4.
Updates, if any, are installed.
5.
The operating system is loaded and the installation phase completes.The Setup program
now enters the Setup Windows phase.
Setting Up Windows
In this phase of installation, you are required to provide user information, the computer name, the
conﬁgure Windows Update, and security.The steps involved in this phase are as follows:
1.
You must enter a username to create a user account, as well as input a password and a pass-
word hint (optional). Enter the required information in the appropriate boxes.You will
need to conﬁrm the password once you have entered it.You can also choose a picture for
this user account. Click Next.
2.
Enter a computer name up to a maximum of 15 characters.This computer name should be
unique in the network and is used to identify the computer. Select a desktop background.
Click Next.
3.
The Windows Update and Security options dialog box appears. Read the information
carefully and make your selections. If you do not want automatic updates, click the Ask
Me Later button. With recommended settings, the different options selected for Windows
Updates are as follows:
Windows Updates are conﬁgured to automatically download and install updates as they
become available.
Updated drivers are automatically downloaded from Microsoft’s Web site for the hard-
ware devices installed on the system.
Internet Explorer will be conﬁgured with Phishing Filter.
Windows Defender is installed and conﬁgured to collect and send the computer infor-
mation to Microsoft.
4.
The Date,Time, and Time Zone settings are displayed next. Make your selections or
changes as required and click Next.
5.
If the Setup program detects a network adapter, the networking components are automati-
cally installed.You will see the network conﬁguration pages only if you have multiple net-
work adapters on your computer.
6.
The Start button now appears in the bottom right-hand corner of the screen.
7.
Windows checks the system performance and assigns it a performance rating.This rating
later appears in the Windows Experience page.
8.
Windows displays the username for the user account you just created.This is the standard
Windows Vista logon screen. Enter the password to start your ﬁrst working session with
Windows Vista.
www.syngress.com
10
Chapter 1 • Introducing and Installing Microsoft Vista

Migrating to Windows Vista
In this section, we discuss some of the essential topics related to upgrading an existing installation of
the Windows desktop operating system to Windows Vista. Like the clean installation, an in-place
upgrade also requires that you perform certain checks on the existing system hardware, device
drivers, and applications to ﬁnd out if they can be successfully ported to Windows Vista.The fol-
lowing sections explain the things you must take care of before performing an in-place upgrade.
Planning for an Upgrade
Before you upgrade an existing Windows operating system, ﬁrst check that the current version of
Windows can be upgraded to Windows Vista. If yes, you must also check which version of Windows
Vista is most suitable for your requirements. In case you have Windows 95, Windows 98, Windows
ME or Windows NT Workstation, you can only perform a clean install. Upgrade from these oper-
ating systems if not supported in Windows Vista.Table 1.3 provides an overview of the available
upgrade options with other Windows desktop operating systems.
Table 1.3 Upgrade Paths Available for Windows Vista
Operating 
Home 
System
Home Basic
Premium
Business
Enterprise Ultimate
Windows 2000 
No
No
No
No
No
Professional
Windows XP 
Yes
Yes
Yes
Yes
Yes
Home
Windows XP 
No
No
Yes
Yes
Yes
Professional 
32-bit
Windows XP 
No
Yes
No
No
Yes
Media Center
Windows XP 
No
Yes
Yes
Yes
Yes
Tablet PC
Windows XP 
No
Yes
Yes
Yes
Yes
Professional 
64-bit
If your operating system is not listed in Table 1.3, or if you want to dual-boot your computer
with another version of Windows, you must perform a clean install.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
11

NOTE
You can upgrade only desktop operating systems such as Windows XP to Windows
Vista. It is not possible to upgrade any server operating system like Windows 2000
Server or Windows Server 2003 to Windows Vista.
Hardware Compatibility
As with a clean install, you must also check your current system hardware to make sure it is compat-
ible with Windows Vista.The most important step is to check that the hardware device drivers will
work with the upgraded operating system. For example, if you have any custom PnP devices or
legacy non-PnP devices, obtain Vista-compatible device drivers beforehand. If you do not have a
compatible device driver, check with the manufacturer and obtain a device driver that is compatible
with Windows Vista.
Application Compatibility
When you upgrade the existing installation of a previous version of the Windows operating system,
most applications will be available in Window Vista also, along with any settings you may have con-
ﬁgured for it. But, before you can really enjoy the applications with the upgraded operating system,
make sure these applications are compatible with Windows Vista and there won’t be any functional
problems. If necessary, update these applications before starting the upgrade installation.
The Microsoft Application Compatibility Toolkit (ACT) version 5.0 can help you check compati-
bility issues with currently installed applications.This tool will identify the currently installed applica-
tions and report any problems.You can get the download link for ACT 5.0 tool from Microsoft’s Web
site at http://technet.microsoft.com/en-us/windowsvista/aa905102.aspx.
Windows Vista Upgrade Advisor
The simplest way to check the compatibility of existing system hardware, applications, device drivers,
and so on is to run Windows Vista Upgrade Advisor.This utility provides a detailed report after running
a check on all system components.You can run this utility on 32-bit versions of Windows Vista
Windows 2000 Professional SP 4 and Windows XP SP2.You can launch the Windows Vista Upgrade
Advisor in several ways:
■
Download Windows Vista Upgrade Advisor from Microsoft’s Web site at www.microsoft.
com/windows/products/windowsvista/buyorupgrade/upgradeadvisor.mspx.
■
Run the Windows Vista Upgrade Advisor directly from the preceding Web site.
■
Run the setup.exe program from Windows Vista DVD and click the Check
Compatibility Online option when you start the upgrade installation.
It may be noted that Windows Vista Upgrade Advisor needs Microsoft Core XML Services
(MSXML) 6.0 and .NET Framework 1.1. When Windows Vista Upgrade Advisor completes system
www.syngress.com
12
Chapter 1 • Introducing and Installing Microsoft Vista

checks, it displays a detailed report.The utility will tell you which version of Windows Vista you
should install so as to get the maximum out of existing system components.The Windows Vista
Upgrade Advisor report also lists the actions you should take after the Windows Vista upgrade is
complete. Figure 1.2 displays the report shown by this utility.
Figure 1.2 The Windows Vista Upgrade Advisor Report
The displayed report is divided into the following categories:
■
System The information under the System tab of the report tells you about any problems
while running some editions of Windows Vista. For example, a computer may be well
suited for Vista Home Basic edition, but it may not have the necessary hardware to run
Vista Ultimate edition.
■
Devices The information under the Devices tab of the report tells you about any prob-
lems with existing device driver ﬁles.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
13

■
Programs Information under the report’s Programs tab tells you about any potential
problems with application compatibility.
■
Task List The information under the Task List tab tells you about the most appropriate
Windows Vista edition.This page also contains information on what you need to do before
installing Windows Vista.You can print the Task List or save it by clicking the Print and
Save Task List link located at the top-right corner of the window.A sample Task List is
shown in Figure 1.3.
Figure 1.3 A Task List Prepared by Windows Vista Upgrade Advisor
NOTE
Windows Vista Upgrade Advisor works on individual computers to perform a check
on existing system components and determines which edition of Windows Vista is
most suitable. When working on a large number of computers, it may not be pos-
sible for administrators to run this utility on each and every desktop. Microsoft pro-
www.syngress.com
14
Chapter 1 • Introducing and Installing Microsoft Vista

vides the Windows Vista Hardware Assessment tool, which can be used in a network
to check all desktops that need to be upgraded to Windows Vista. This tool can be
downloaded from Microsoft’s Web site at http://www.microsoft.com/technet/solution-
accelerators/hardwareassessment/wv/default.mspx.
Performing an Upgrade Installation
Similar to the clean installation process discussed earlier in this chapter, the upgrade process is also
divided into several phases. First of all, the upgrade installation must start from within the existing
Windows operating system that can be upgraded to Windows Vista. Starting the installation directly
by inserting Windows Vista DVD will start the clean installation process.These phases are as follows:
■
Collection information
■
Upgrading Windows
■
Set Up Windows
The following sections explain the steps involved in the entire upgrade installation process.
Collecting Information
The upgrade installation process starts when you insert the Windows Vista DVD in the DVD drive.
The steps involved in this phase are as follows:
1.
Log on to the current operating system using an administrative account.
2.
Insert the Windows Vista DVD in the DVD drive. Double-click the Setup.exe ﬁle to start
the upgrade process.You can also start the upgrade process by running the Setup.exe ﬁle
from a shared folder located on a ﬁle server should you be connected to the network.
3.
The Windows Vista installation page appears (as shown in Figure 1.4).
4.
You can click the Install now link to start the installation, click the Check online to see
if your computer can run Windows Vista link (which starts Windows Vista Upgrade
Advisor), or migrate ﬁles and user settings from a previous version of Windows by clicking
the Transfer ﬁles and settings from another computer link (which starts the
Windows Easy Transfer Wizard). For this exercise, click Install now to start the upgrade
process.
5.
Choose whether or not to get updates from the Microsoft Web site.This requires an
Internet connection. Click either Go online to get the latest updates for installation
if you want to download updates for the operating system and device drivers. Otherwise,
click the Do not get the updates for installation link.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
15

Figure 1.4 The Windows Vista Installation Page
6.
Enter the 25-digit Product Key when prompted. Click Next.
7.
The Licensing page appears. Read the licensing terms and click I agree to the license
terms (recommended to use Windows). Click Next.
8.
In the next page, select the installation type as Upgrade. Note that the upgrade process
will proceed only if the existing operating system can be upgraded to Windows Vista.
9.
A compatibility report is displayed that indicates any issues with existing device drivers
and/or applications. Click Next.
Upgrading Windows
The next phase of upgrade installation starts with copying Windows Vista ﬁles to the hard disk.
Various steps involved in this phase are as follows:
1.
The Setup program copies Windows Vista ﬁles to the hard disk location you earlier
selected.These compressed ﬁles are then expanded.
2.
Windows Vista features are installed.The installed features depend on the system hardware
that the Setup program detects.
3.
Updates, if any, are installed.
4.
The operating system is loaded and the installation phase completes.The Setup program
now enters the Setup Windows phase.
www.syngress.com
16
Chapter 1 • Introducing and Installing Microsoft Vista

Setting Up Windows
The Setup Windows phase starts when the Setup program ﬁnishes copying and expanding ﬁles from
the DVD media. Since you are already working on the existing operating system, the username, pass-
word, and computer name options are not displayed.These settings are taken from the existing
Windows operating system. Other steps involved in this phase are as follows:
1.
Select the country, time and currency format, and keyboard layout as appropriate. Click
Next.
2.
The Windows Update and Security options dialog box appears. Read the information
carefully and make your selections. If you do not want automatic updates, click the Ask
Me Later button. With recommended settings, the different options selected for Windows
Updates are as follows:
■
Windows Updates is conﬁgured to automatically download and install updates as they
become available.
■
Updated drivers are automatically downloaded from Microsoft’s Web site for the hard-
ware devices installed on the system.
■
Internet Explorer will be conﬁgured with Phishing Filter.
■
Windows Defender is installed and conﬁgured to collect and send the computer infor-
mation to Microsoft.
3.
Check the displayed Date, Time, and Time Zone. Make any changes as necessary. Click
Next.
Windows checks the system performance and assigns it a performance rating.This
rating later appears in the Windows Experience page.
The upgrade is now complete and you can log on to Windows Vista.
Upgrading from One Vista Edition to Another
Chances are you have already installed a basic edition of Windows Vista and now want to upgrade it
to a higher edition. For example, you might have installed Home Basic edition and later you realize
you needed more out of your Vista experience. Similarly, a business user may feel at some point that
the Business edition is not good enough for his/her requirements and that Windows Vista Ultimate
would have been a better choice. Microsoft has made it easy to upgrade from one version of
Windows Vista to another higher edition.All you have to do is pay Microsoft an additional charge
for the license of a higher edition and upgrade the existing Windows Vista version from within the
existing installation. In this section, we will look at Windows Anytime Upgrade, a feature available in the
Control Panel.
Windows Anytime Upgrade allows you to upgrade your existing Windows Vista installation to a
higher edition.As discussed earlier brieﬂy, the following upgrade paths exist:
■
Home Basic edition can be upgraded to Home Premium edition or Ultimate edition.
■
Home Premium edition can be upgraded to Ultimate edition.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
17

■
Business edition can be upgraded to Enterprise or Ultimate edition.
■
Enterprise edition can be upgraded to Ultimate edition.
To start the upgrade process using Windows Anytime Upgrade, complete the following procedure:
1.
Click Start | Control Panel | System and Maintenance.
2.
Click the Windows Anytime Upgrade link.
The utility takes you to Microsoft’s Web site where you can purchase the upgrade license for the
Vista edition you wish to upgrade to and get instructions for upgrading. Microsoft will provide you
with a Product Key.This Product Key will be used with your existing Windows Vista DVD to
unlock the next higher version that you wish to upgrade to.
NOTE
It is interesting to note that the Windows Vista DVD you initially purchase contains
all the editions of Windows Vista. It is the Product Key that unlocks the appropriate
Vista edition depending on the license you have purchased from Microsoft. When
you use Windows Anytime Upgrade, you only have to pay Microsoft a nominal fee
for the upgrade to get a new Product Key. Once you get the new Product Key, you
simply upgrade the existing Vista edition using the Windows Vista DVD you already
have with you.
Migrating Previous Files and Settings
When you install Windows Vista on a single computer, it is very easy to spend another hour or so to
conﬁgure the new computer so it is similar to the old one. However, at times you may wish to
transfer the settings from the old computer in order to save you from having to conﬁgure the new
Windows Vista computer from scratch.This is where Windows Easy Transfer and User State Migration
Tool (USMT) come in handy.These tools help you transfer your system and application settings from
one computer to another. In this section, we will take a look at these utilities.
Windows Easy Transfer
Windows Easy Transfer lets you transfer user and application settings as well as data ﬁles from one
computer to another computer.The wizard allows you to transfer the following items from the old
computer:
■
User Accounts
■
Folders and Files (including music, pictures, and video ﬁles)
■
Application Settings
■
Internet Explorer Settings
www.syngress.com
18
Chapter 1 • Introducing and Installing Microsoft Vista

■
E-mail Settings (including contacts and messages)
NOTE
Windows Easy Transfer works only with Windows 2000 Professional (for transferring
ﬁles only), Windows XP SP2, and Windows Vista. If you wish to transfer ﬁles from a
Windows 2000 Professional computer, make sure that SP4 has been installed on it.
The following methods can be employed to transfer ﬁles and settings:
■
Easy Transfer cable, which is a special USB cable used to connect the old (source) and new
(destination) computer
■
A USB ﬂash drive or other removable media such as a CD or a DVD
■
A shared folder on a network ﬁle server
■
A direct connection through the network
We noted earlier that when you insert the Windows Vista DVD in the DVD drive, the installa-
tion screen provides an option to transfer ﬁles and settings from another computer.You can also start
the Windows Easy Transfer Wizard by following the steps given here.
1.
Click Start | All Programs | Accessories | System Tools | Windows Easy
Transfer.
2.
Click Continue in the User Account Control dialog box. If you are not logged on as an
Administrator, provide a username and password with administrative privileges.
3.
The Windows Easy Transfer Wizard starts, as shown in Figure 1.5.
Figure 1.5 The Windows Easy Transfer Wizard
Introducing and Installing Microsoft Vista • Chapter 1
19
www.syngress.com

During the transfer process, neither the new computer nor the old one is available for use. Click
the Next button in the Windows Easy Transfer Wizard to start the transfer process and then follow
further onscreen instructions.
NOTE
The Windows Easy Transfer utility is useful only when you have a few computers
from which you wish to transfer user settings and data ﬁles. It cannot be used on a
large ﬂeet of computers. For a large number of computers, administrators must use
the User State Migration Tool (USMT) 3.0, which is a command line utility included
with Windows Vista.
User State Migration Tool
User State Migration Tool (USMT) is an administrative command-line tool that helps migrate user set-
tings, applications, and data on a large ﬂeet of computers.The current version of this tool shipped
with Windows Vista is USMT 3.0.Administrators can include USMT commands in scripts to auto-
mate Windows Vista deployments. USMT mainly consists of following two commands:
■
ScanState.exe This utility is run on the source computer from where the settings are to
be transferred.The purpose of this tool is to collect system data, application settings, and
user settings from the source computer.The three pre-conﬁgured but modiﬁable ﬁles con-
taining rules for migration are named Migsys.xml, Migapp.xml, and Miguser.xml. These ﬁles
are compressed by the ScanState.exe utility and stored as an image ﬁle named Usmt3.mig. In
addition to this, you can create the Conﬁg.xml ﬁle to exclude the data you do not want to
transfer from the source computer.The collected data is stored in an intermediate store
such as a CD or a DVD.
■
LoadState.exe This utility is run on the destination computer performing a clean installa-
tion of Windows Vista.This utility accesses the data stored in the Usmt.mig ﬁle from the
intermediate store (CD or DVD) and transfers them to the destination computer.
Transferring Data with USMT 3.0
As noted earlier, the USMT 3.0 utility is a command-line tool that is either run on individual com-
puters or is included in administrative scripts for the automated deployment of Windows Vista.The
following procedure explains how this utility can be used on individual computers:
1.
On the source computer, close all applications and run the ScanState.exe from the command
prompt.The utility will collect necessary data and save it on the intermediate store (CD or
DVD).
www.syngress.com
20
Chapter 1 • Introducing and Installing Microsoft Vista

2.
Perform a clean installation of Windows Vista on the destination computer. Install all appli-
cations that were on the source computer. Make sure that the versions of the applications
on the source and destination computers match.
3.
Run LoadState.exe with appropriate parameters on the destination computer from the
command prompt.This command will transfer data from the intermediate store (CD or
DVD).
Command-Line Parameters for ScanState.exe and LoadState.exe
Both the ScanState.exe and LoadState.exe commands have a large number of parameters that are used
to conﬁgure how these commands collect or restore data respectively.These parameters further ﬁne-
tune the transfer process.To get a list of these parameters and their functions, type ScanState.exe /?
or LoadState.exe /? at the command prompt.
NOTE
Both Windows Easy Transfer and User State Migration Tool (USMT) are not required
when you are upgrading your previous version of the Windows operating system.
This is because the upgrade process automatically transfers system, application, and
user settings during the installation. In addition to this, you cannot use USMT on
server operating systems such as Windows 2000 Server or Windows Server 2003. This
tool is meant for desktop operating systems only.
Automating Windows Vista Installations
Installing Windows Vista on a large number of computers is usually a challenging task for most
administrators. Unless the installation is automated, installing the operating system individually on
hundreds or thousands of desktops is a difﬁcult task and may take months to complete. Microsoft
realizes this and ships several tools with Windows Vista for large-scale deployments.These tools can
be use in the following manner:
■
Performing unattended installations with Setup.exe and using an answer ﬁle.
■
Using Windows Deployment Service (WDS) on a Windows Server 2003 computer for
remote installation.
■
Using the System Preparation Tool (Sysprep.exe) for preparing a reference computer for
disk imaging and distributing the disk image to a large number of computers using ImageX
or a third-party disk imaging utility.
■
Using Microsoft Systems Management Server (SMS).
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
21

In the following sections, we will take a look at each of these tools. Details about how to use
SMS are beyond the scope of this book.Table 1.4 lists a summary of automation tools and their
requirements:
Table 1.4 Summary of Windows Vista Deployment Tools
Deployment Tool
Description
Setup.exe
For running the Windows Vista installation program.
Unattend.xml
The answer ﬁle used in unattended installations. The
answer ﬁle contains answers for most of the GUI
dialog boxes. The answer ﬁle can be created using
Windows SIM.
Sysprep.exe
The system preparation tool for capturing the disk
image.
ImageX
For capturing, modifying, and installing disk images.
Included with Windows Automated Installation Kit
(WAIK).
Windows System Image 
Windows Vista tool for creating and managing the 
Manager (Windows SIM)
answer ﬁle (unattend.xml) for unattended setup.
Included with Windows Automated Installation Kit
(WAIK).
Windows PE
Windows Preinstallation Environment (Windows PE).
A limited 32-bit command-line version of Windows
Vista used for capturing and installing disk images.
Windows PE starts a computer in command-line mode
so you can run a disk imaging tool such as ImageX.
NOTE
Windows Automated Installation Kit (WAIK) can be downloaded from the Microsoft
Web site for free. WAIK contains both the ImageX utility and the Windows System
Image Manager. You will need to install WAIK on the computer, which will serve as a
reference computer for the rest of your installations. The WAIK download is avail-
able at http://go.microsoft.com/fwlink/?LinkID=53552. When installed, the
ImageX.exe utility is available in the C:\Program Files\Windows AIK\Tools\x86 folder,
and the Windows SIM utility ImgMgr.exe is available in the C:\Program Files\Windows
AIK\Tools\Image Manager folder.
www.syngress.com
22
Chapter 1 • Introducing and Installing Microsoft Vista

Unattended Installations
An unattended installation is the traditional method of deploying a Windows operating system.
Unattended installations use an answer ﬁle named Unattend.xml, which contains user input to various
GUI dialog boxes that appear during the installation process. Unattended installation is the most
practical way to install Windows Vista when the client computers have different hardware compo-
nents. Unattended installations save deployment time and can be used either for clean installs or in-
place upgrades.
You need not distribute Windows Vista media to every single user since it can be located on a
network share.This network share is known as the distribution point.The answer ﬁle is located at the
same network share where the Windows Vista installation ﬁles are located.The client computers must
be able to connect to the distribution point to start the installation.Although the installation is called
unattended installation, an administrator or a user must be physically present at the client computer
to start the process. For more information on sharing folders and creating distribution points on a
Windows Vista computer, refer to Chapter 5.
NOTE
Unlike the previous versions of Windows in which the name of the answer ﬁle used
to be Unattend.txt, the answer ﬁle for Windows Vista unattended installations is
named Unattend.xml. Instead of using several answer ﬁles, you need only one
answer ﬁle in Windows Vista that contains custom conﬁguration information for dif-
ferent types of computer hardware in an organization.
Windows Deployment Services
Windows Deployment Services (WDS) is the new name for Remote Installation Services (RIS).
WDS is a suite of server and client components that help fast deployments of Windows operating
systems, especially Windows Vista. WDS helps automate the remote installation of a Windows oper-
ating system to a large number of client computers.Administrators need not be physically present at
the client computers to start the installation process, and need not distribute Windows Vista media to
every user.
WDS is composed of the following primary components:
■
Server components Server components of WDS include a Pre-Boot Execution
Environment (PXE) server and Trivial File Transfer Protocol (TFTP) server.These compo-
nents help the client computer boot and connect to a WDS server to start the installation
process.The WDS server also includes a shared folder with Windows Vista operating
system images.
■
Client components Client components include a graphical user interface that runs from
within the Windows PXE and communicates with the WDS server to select and download
the Windows Vista operating system image.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
23

■
Management components These are the components administrators can use to manage
the WDS server, operating system images and client computer accounts. Management com-
ponents provide control over WDS installations.
Installing WDS
WDS must be downloaded and installed on a server running the Windows Server 2003 SP1 oper-
ating system. WDS is included in Windows Automated Installation Kit (WAIK), which is available for
free download at the Microsoft Web site at http://go.microsoft.com/fwlink/?LinkId=81030.The
entire setup must meet the following requirements:
■
Windows Server 2003 SP1 Windows Deployment Services requires a Windows Server
2003 server with at least SP1 installed. Remote Installation Service (RIS) must be running
on the server.
■
Active Directory WDS server must be a member of an Active Directory domain.Active
Directory is required to authorize WDS clients in the network.
■
Domain Name Service DNS server must be available in the network. DNS service is
required to locate the Active Directory services in the domain.
■
DHCP Service The network where WDS server is running must also have a DHCP
server with an active scope for the WDS client computers. WDS clients use the PXE envi-
ronment and receive a temporary IP address from the DHCP server.
■
NTFS Volume The disk partition on the WDS server where you will store Windows
Vista images must be formatted using NTFS.
NOTE
Windows Deployment Service is included in Windows Server 2003 Service Pack 2. In
case you already have installed Remote Installation Service (RIS) on a Windows Server
2003 computer and later updated it with SP2, you need not install the Windows
Deployment Services. 
When WDS is installed on a Windows Server 2003 computer, the WDS MMC snap-in and
other WDS utilities become available on the server.The WDS MMC snap-in is used to further con-
ﬁgure and manage the WDS services on the server. For further instructions on how to use WDS for
Windows Vista deployments, visit Microsoft Web site for Windows Vista at www.microsoft.com/
windows/products/windowsvista/default.mspx.
The System Preparation Tool
System Preparation Tool 3.14 (sysprep.exe) is included with Windows Vista for preparing a computer for
disk imaging.Administrators can prepare a reference computer that has Windows Vista and applications
www.syngress.com
24
Chapter 1 • Introducing and Installing Microsoft Vista

installed, and use the System Preparation Tool to create the image of the system.The image can be cap-
tured using ImageX or a third-party imaging software and then deployed to a large number of com-
puters with similar hardware.All computers receive the same settings conﬁgured on the reference
computer.The only exception is that the system-speciﬁc information, such as the Security IDentiﬁer
(SID), which is unique to every computer, is not copied to target computers.The System Preparation
Tool can also detect any PnP devices on target computers, which may be different on target computers
from the reference computer, and automatically install appropriate device drivers.
NOTE
System Preparation Tool 3.14 that comes with Windows Vista is different from pre-
vious versions. You must use this tool to automate Windows Vista deployments.
Previous versions of the System Preparation Tool will not work with Windows Vista.
Additionally, Microsoft now ships ImageX, a disk imaging utility, with Windows Vista.
You can either use ImageX to capture and transfer images or use a third-party disk
imaging utility. 
Using the System Preparation Tool
In order to create a system image, you will ﬁrst need to install and conﬁgure Windows Vista on one
of the computers.This computer is called the reference computer.You can also install any applications
after Windows Vista is installed. Once the reference computer is ready, the System Preparation Tool
(sysprep.exe) can be run on this computer to create a system image that will include the fully conﬁg-
ured operating system, as well as any applications you have installed.
NOTE
Remember that the System Preparation Tool (Sysprep.exe) is used for preparing the
system for imaging. It does not actually capture the image or distribute it.
Furthermore, the System Preparation Tool can only be used for clean installations.
You cannot use this tool for upgrading a previous version of Windows. Also, the ref-
erence computer should not be a member of a domain when the Sysprep tool is run
to prepare it for imaging.
Sysprep.exe is located in the \Windows\System32\Sysprep folder. Locate the sysprep.exe ﬁle and
double-click it to start the utility.You can also run this ﬁle from the command prompt window using
appropriate switches.Table 1.5 lists the command-line parameters for the sysprep.exe ﬁle:
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
25

Table 1.5 Command-Line Parameters for Simper
Parameter
Description
/audit
Speciﬁes that the computer should be started in audit
mode. Audit mode allows administrators to include addi-
tional applications and device drivers. This parameter can
also be used to test the installation before the image is
deployed to other computers.
/generalize
Speciﬁes that any system-speciﬁc information such as SID
should be removed from the image.
/oobe
Speciﬁes that the Windows Welcome screen be displayed
after the computer reboots. OOBE stands for Out Of Box
Experience.
/quite
Speciﬁes that the installation will run without any user
interaction.
/quit
Quits the Sysprep tool after the process is complete.
/reboot
Speciﬁes that the target computer will reboot after the
process is complete.
/shutdown
Speciﬁes that the target computer will shut down after
the process is complete.
/unattend
Speciﬁes an answer ﬁle for unattended installation.
The following is the general procedure for using the Sysprep tool:
■
Install and conﬁgure Windows Vista and applications on the reference computer.
■
Run Sysprep tool to prepare the reference computer for imaging.
■
Use ImageX to create the disk image on the reference computer.
■
Install the image on target computers using ImageX.
Preparing the Reference Computer
In order to prepare a computer as reference, you must install windows Vista and its applications. Once
the operating system and applications are installed and conﬁgured, run the Sysprep tool to prepare it
for imaging.The following exercise explains the procedure:
1.
Perform a clean installation of Windows Vista on the reference computer.
2.
Log on to the reference computer with an administrative account.Apply updates, if 
available.
3.
Install and conﬁgure applications and install updated device drivers.
4.
Test the reference computer to ensure it meets the requirements.
5.
Run the sysprep.exe ﬁle from the C:\Windows\System32\Sysprep folder.
www.syngress.com
26
Chapter 1 • Introducing and Installing Microsoft Vista

6.
The System Preparation Tool window is displayed (as shown in Figure 1.6).
Figure 1.6 The System Preparation Tool
7.
Make your selections as appropriate. Click the Generalize checkbox to remove system-
speciﬁc information such as the SID of the computer. Click OK.
8.
If you selected the Reboot option, as shown in Figure 1.6, the computer will be restarted
and the Setup will start immediately after the system reboots. Follow the instructions in the
setup.
The system is now ready for imaging.You can capture the system image using ImageX, as dis-
cussed in the next section
Capturing and Installing the Image with Imagex
ImageX is a command-line utility included with Windows Vista to capture and install disk images.
You will need to boot the reference computer into Windows PE mode that facilitates creation and
distribution of disk images. For further instructions on how to capture and distribute disk images
using ImageX, you can access the step-by-step instructions on Windows Vista deployments by vis-
iting the Microsoft Web site for IT professionals at http://technet.microsoft.com/en-us/win-
dowsvista/aa905079.aspx.
Running Windows Vista
Once Windows Vista is installed, you must activate it before you can start enjoying the new features
of the operating system.You will also need to keep the system updated with new features, critical
updates, and security patches from Microsoft. In this section, we will also take a look at multibooting
Windows Vista with other operating systems on the same computer. Finally, we will discuss how to
install and run Windows Vista as a virtual operating system on Microsoft Virtual Server 2007.
Activating Windows Vista
Once Windows Vista is installed, you must activate it in order to register the product with Microsoft
and validate your product license. Microsoft has made it mandatory to activate Windows Vista in
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
27

order to prevent software piracy. Product Activation can be done either online (provided you are con-
nected to the Internet) or by telephone, interacting with an automated telephone system.Activation
must be completed within 30 days of installing Windows Vista.After the 30-day period expires, cer-
tain features of the product will not work until the time you activate your copy of Windows Vista.
After this period, the Windows Activation Wizard screen will automatically appear when you start
your computer.
Updating Windows Vista
After Windows Vista installation is done and applications are installed and conﬁgured, it is necessary
to keep the operating system up-to-date with the latest updates, service packs, security patches, and
device drivers from Microsoft. Windows Update is a built-in feature that can be used for this pur-
pose. With the appropriate conﬁguration, you can either have Windows Update automatically down-
load and install updates or you can set a schedule for downloading and installing updates. By default,
Windows Vista is conﬁgured to check for updates from the Windows Update Web site everyday at
3:00 A.M.
Windows Update can be accessed using either of the following methods:
■
Click Start and type update in the Search box. Click the Windows Update link that
appears in the search results box.
■
Click Start | Control Panel | System and Maintenance | Windows Update.
The Windows Update dialog box is shown in Figure 1.7.This page shows whether or not
Windows is up-to-date, and if any updates are available. It also shows when the most recent updates
were checked and installed.You can also view your current settings for downloading and installing
updates.
Figure 1.7 Windows Update
www.syngress.com
28
Chapter 1 • Introducing and Installing Microsoft Vista

You can click the View Available Updates link to see what updates are available for installation.
On the left side panel, the following options are available:
■
Check for Updates
■
Change Settings
■
View Update History
■
Restore Hidden Updates
■
Updates: Frequently Asked Questions
If the current update settings are not appropriate, click the Change Settings link in the left side
panel.As shown in Figure 1.8, you can change the default settings to suit your requirements. For
example, if you know that the computer will be powered off at 3:00 A.M., change the time.
Figure 1.8 Changing Windows Update Settings
The following settings are available:
■
Install Updates Automatically (Recommended)
■
Download Updates But Let Me Choose Whether to Install Them
■
Check for Updates But Let Me Choose Whether to Download and Install Them
■
Never Check for Updates (Not Recommended)
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
29

The ﬁrst option Install Updates Automatically (Recommended) is selected by default.You
can change the day and time to download and install updates. When you have ﬁnalized the settings,
click the OK button.You will also need to click Continue in the User Account dialog box to con-
ﬁrm the changes (notice the Windows security shield icon inside the OK button).
Dual-Booting with Other Operating Systems
You can install Windows Vista in a dual-boot or multiboot conﬁguration. Dual-boot or multiboot
conﬁguration allows you to keep the previous version of Windows as well as Windows Vista. When
you perform a clean installation of Windows Vista when another Windows operating system exists
and select a different disk partition, the system will automatically be conﬁgured as a dual-boot
system. In the real world, dual-boot systems are usually conﬁgured for either test environments or
when applications installed on the old operating system are not supported on the new operating
system.
Some of the important considerations for conﬁguring a dual-boot or multiboot system are as 
follows:
■
Hard Disk Partitions and Free Space The hard disk drive should have a separate par-
tition for each operating system. Each operating system must be installed in a separate disk
partition.There should be sufﬁcient free disk space for each operating system as well as
applications.
■
Order of Installation Operating systems should be installed from oldest to newest. For
example, if you are multibooting between Windows 2000 Professional, Windows XP, and
Windows Vista, install Windows 2000 Professional ﬁrst, then Windows XP, and ﬁnally
Windows Vista.
■
File System Be very careful about ﬁle systems. If an older operating system such as
Windows 98 does not recognize the NTFS ﬁle system and you need to access the
Windows Vista partition from within Windows 98, do not use NTFS on Windows Vista.
Even with Windows NT 4.0, you should have SP4 installed in order to use NTFS. In these
situations, use the FAT or FAT 32 ﬁle system.
■
Encrypting File System (EFS) Windows NT 4.0 or older operating systems cannot
read ﬁles encrypted in Windows Vista. Only Windows 2000 Professional, Windows XP, and
Windows Vista can read encrypted ﬁles. If dual-booting between Windows Vista and
Windows 2000 or Windows XP, use NTFS compression.
■
Dynamic Disks Do not use dynamic disks since Windows XP Home, Windows NT 4.0,
Windows ME, and older operating systems do not recognize them. By default, all disks are
installed and initialized as basic disks.
■
Windows 9x Disk Compression Disable disk compression if dual-booting with
Windows 95 or Windows 98. Windows Vista cannot read data from compressed disks in
Windows 95 and Windows 98.
Once you have installed all the operating systems, make sure the applications for each operating
system are installed separately. When you power on the dual-boot or multiboot computer, you can
select the operating system to start.The boot menu is displayed for 30 seconds by default.The
www.syngress.com
30
Chapter 1 • Introducing and Installing Microsoft Vista

behavior of the boot menu can be changed by editing the Boot Conﬁguration Data (BCD).You can
directly edit the BCD by using BCDEdit, which is a command-line utility.To change the boot menu
using the BCDEdit command, open the command prompt window from the Start menu. In the
command prompt window, run the bcdedit.exe command.
The Boot tab in the System Conﬁguration (msconﬁg.exe) utility can also be used to change the
default operating system on a dual-boot or multiboot system.To change the boot menu, use the
System Conﬁguration utility from the Run dialog box. Click Start | Run and type msconﬁg.exe.
Press the Enter key and click Continue in the User Account Control dialog box. When the
System Conﬁguration utility window opens, click the Boot tab. Different options in this tab are
shown in Figure 1.9.
Figure 1.9 Changing Boot Options in the System Conﬁguration Utility
Click the operating system in the upper box and click Set as default. Click OK to save your
settings and then close the System Conﬁguration utility.
NOTE
The Boot Conﬁguration Data (BCD) store in Windows Vista is similar to the Boot.ini
ﬁle in old Windows operating systems. The best way to change the boot menu
options is to use the System Conﬁguration utility. Use the BCDEdit command line
utility only if there is no other option.
Running Windows Vista on a Virtual PC
Virtualization technology helps system administrators perform exhaustive testing of the operating
system, check application and driver compatibility, and lets you experiment with an operating system
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
31

without actually installing it on a machine. Even if you are not using Windows Vista as your primary
operating system, you can still test the operating system by using one of the virtualization technolo-
gies available in the market. While VMWare is one of the most popular virtualization applications to
date, Microsoft Virtual PC and Microsoft Virtual Server are also widely used. In this section, we will
discuss how to use Microsoft Virtual PC 2007 to install the Windows Vista operating system as a virtual
operating system.
It is important to talk a bit about the difference between a dual-boot or a multiboot system and
a virtual machine.A dual-boot or a multiboot system has all the operating systems installed on actual
hard disks.You can boot the computer using any of the operating systems and each operating system
works independently.A virtual machine, on the other hand, needs only one base operating system,
which should be preinstalled.A virtualization application such as Microsoft Virtual PC 2007 or
VMWare needs to be installed to prepare a virtual machine. On this machine, you can install multiple
operating systems, depending on the hardware capabilities of the computer. Once installed, you can
work on the virtual machine as you would the actual machine. Hence, in case of a virtual machine, if
you cannot start the base operating system, you cannot work on any virtual operating system.
Microsoft Virtual PC 2007 can be downloaded free of charge as a single executable ﬁle from the
Microsoft Web site. Double-click the setup.exe ﬁle to install Microsoft Virtual PC 2007. When
installed, it appears under All Programs in the Start menu.The entire process can be divided into
three stages:
1.
Installing Virtual Machine with Virtual PC 2007
2.
Preparing the Virtual Machine for Windows Vista
3.
Installing Windows Vista on the Virtual PC
These stages are explained step-by-step in the following sections.
Installing Virtual Machine with Virtual PC 2007
In this stage, we will install a virtual machine using Microsoft Virtual PC.The following steps explain
the procedure:
1.
Click Start | All Programs | Microsoft Virtual PC.
2.
As shown in Figure 1.10, the Virtual PC Console opens. By default, no virtual machine is
installed.
Figure 1.10 The Empty Microsoft Virtual PC Console
32
Chapter 1 • Introducing and Installing Microsoft Vista
www.syngress.com

3.
Click New to add the Microsoft Windows Vista machine to the console.
4.
On the next page, ensure that Create a New Virtual Machine is selected by default.
Click Next.
5.
Select the Name and Location for the virtual machine ﬁle. Make sure you choose a
drive with about 15GB of free hard disk space. Click Next.
6.
Select the operating system in the next page.As shown in Figure 1.11, Windows Vista is
selected as the virtual machine to be installed. Click Next.
Figure 1.11 Selecting the Operating System to Be Installed on Virtual PC
7.
On the Memory page, check the settings for RAM. Use the recommended settings or click
the Adjusting the RAM button, as appropriate. If you do not have sufﬁcient RAM on
your computer, the wizard will not allow you to increase the recommended size of virtual
memory. Click Next.
8.
Check and adjust virtual hard disk options on the Virtual Hard Disk Options page. If you
need to create a new virtual hard disk, click A New Virtual Hard Disk radio button and
specify the size of the hard disk.This is shown in Figure 1.12. Click Next.
9.
The wizard displays a summary of settings for the new virtual machine. Click Finish to
close the dialog box.The new virtual machine is now created.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
33

Figure 1.12 Creating a New Virtual Hard Disk for Windows Vista
Preparing the Virtual Machine for Windows Vista
When the new virtual machine is installed in Microsoft Virtual PC 2007, it is shown as one of the
available virtual machines on the Virtual PC console.To open the Virtual PC console, click Start |
All Programs | Microsoft Virtual PC.The Virtual PC Console appears, as shown in Figure 1.13.
Figure 1.13 Virtual Machine for Windows Vista
The following operations are available from this console:
■
New To install another virtual machine on the Virtual PC.You can install another desktop
operating system on this console.
■
Settings To conﬁgure settings for the selected virtual machine. Figure 1.14 shows settings
for the Windows Vista virtual machine.You can select any of the components and con-
ﬁgure it according to your requirements.
■
Remove To remove an installed virtual machine.
www.syngress.com
34
Chapter 1 • Introducing and Installing Microsoft Vista

■
Start To start the virtual machine.You must start the virtual machine before you can use
it. When the operating system is not installed, you must start the virtual machine to per-
form the installation. Installation is explained in the next section.
Figure 1.14 Settings for Windows Vista Virtual Machine
NOTE
Microsoft Virtual PC 2007 requires that you have sufﬁcient physical memory (RAM)
on your computer. In case you do not have sufﬁcient RAM, the virtual machine will
not be able to start any virtual machine properly. For example, if you have only
512MB of RAM in your system, it will not be sufﬁcient for Virtual PC. For ﬂawless
Virtual PC operations, make sure you have at least 2GB of RAM on your computer.
Installing Windows Vista on the Virtual PC
The next step is to install Windows Vista on the new virtual machine we just created. For this pur-
pose, you can either use a disk image captured on a CD or use your original Windows Vista Media.
The following steps explain the procedure for installing Windows Vista from the DVD.
1.
Click Start | All Programs | Microsoft Virtual PC to start the Virtual PC console.
2.
Insert the Windows Vista DVD in the DVD drive.
3.
In the Virtual PC Console, click the name of the virtual machine, which is Windows
Vista in our case.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
35

4.
Assuming that the DVD drive is labeled as D:, click Use Physical Drive D: from the CD
menu.
5.
The installation starts.You must enter the 25-digit Product Key again for this installation.
6.
The procedure from here on is similar to the one explained earlier in the section
“Performing a Clean Installation.”
Once the installation is complete, the Windows Vista Virtual PC will be ready to use.You can
conﬁgure the operating system, add users and groups and install applications in a similar way, as you
would for an actual operating system.The logon and logoff procedure for this installation will also be
similar to the actual installation of Windows Vista.
www.syngress.com
36
Chapter 1 • Introducing and Installing Microsoft Vista

Summary
Microsoft Windows Vista is perhaps the most awaited desktop operating system so far. It comes as a
completely redesigned operating system with transparent windows, a 3-D interface called Aero, and a
bunch of enhanced features. In this chapter, we discussed various editions of Windows Vista targeted
at different segments of user and business markets. Windows Vista has six different editions: Starter,
Home Basic, Home Premium, Business, Enterprise, and Ultimate.The starter edition is meant for
emerging markets only and is not available in the USA or Europe. Windows Vista can be either
installed as a fresh operating system using a process called clean install or it can be installed as an
upgrade to a previous version of Windows such as Windows XP.You can also install Windows Vista
in a dual-boot or multiboot system or, as a virtual operating system using any of the available virtual-
ization applications, such as Microsoft Virtual PC.
Windows Vista allows you to migrate your ﬁles and settings using the Windows Easy Transfer
Wizard. For a large number of computers, administrators can use the User State Migration Tool
(USMT) to transfer ﬁles and settings from an old computer to the Windows Vista computer. USMT
is comprised of two executable ﬁles named ScanState.exe and LoadState.exe, which are run on the
source and target computer, respectively.
In Windows Vista, the Setup.exe ﬁle is used to start clean installations as well as the upgrade
installations. Windows Vista installations can be automated by using an answer ﬁle named
Unattend.xml.You can also download Windows Automated Installation Kit (WAIK) free of cost from
the Microsoft Web site for large-scale installations. WAIK contains Windows System Image Manager
(Windows SIM) and ImageX, a command-line utility to capture and transfer disk images. WAIK also
contains Windows Deployment Services (WDS), which is a replacement of Remote Installation
Service (RIS). WDS allows administrators to install Windows Vista Disk images to a large ﬂeet of
computers. WDS runs on a Windows Server 2003 SP1 computer that is a member of the Windows
Active Directory domain.
Solutions Fast Track
Introduction to Windows Vista

Windows Vista is available in six editions: Starter, Home Basic, Home Premium, Business,
Enterprise, and Ultimate.The Starter edition is meant for emerging markets and is not
available in the U.S. and Europe.

Windows Vista Starter edition can run only three applications simultaneously and all
incoming network connections are blocked.The new 3-D interface,Aero, is available in
Home Premium and higher editions. Windows Vista Ultimate edition has all the features
available in other editions.

Windows Vista includes the functionality of Tablet PC and Media Center, which were sold
as separate operating systems in Windows XP.
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
37

Installing Windows Vista

Before Windows Vista is installed, check that the system meets the minimum hardware
requirements for the Vista edition you are installing. Microsoft provides minimum hardware
requirements as Vista Capable PCs and Vista Premium Ready PCs.

Windows Vista installation can be a clean install or an upgrade install.The installation
executable ﬁle is named Setup.exe for both a clean install as well as an upgrade install.

You must check for hardware compatibility, as well as driver and application compatibility
before starting the installation.
Migrating to Windows Vista

Windows Vista Upgrade Advisor is used to check for compatibility issues on Windows XP
computers to ensure that hardware, applications, and device drivers will work well with
Windows Vista.

Windows Anytime Upgrade facilitates upgrading one edition of Windows Vista to another
higher edition.

After the upgrade, system settings from one computer can be transferred to a Windows
Vista computer using Windows Easy Transfer or User State Migration Tool (USMT).
USMT is composed of two executable ﬁles: ScanState.exe, which is run on the old
Windows computer to collect information; and LoadState.exe, which is run on the new
Windows Vista computer to transfer information.
Automating Windows Vista Installations

Windows installations can be automated for large-scale deployments. Windows Automated
Installation Kit (WAIK) is a free tool available from the Microsoft Web site that contains
Windows System Image manager (Windows SIM), ImageX, and Windows Deployment
Services (WDS).

You can automate Windows Vista installations using unattended setup with an answer ﬁle
named Unattend.xml.The System Preparation (Sysprep.exe) tool can also be used to
prepare a system for imaging. ImageX is a command-line tool used to capture and transfer
disk images.

Windows Deployment Services (WDS) is a replacement for Remote Installation Service
(RIS). It is installed on a Windows Server 2003 computer, which should be a member of
the Active Directory domain. WDS requires Active Directory, DNS, and DHCP services for
the remote installation of Windows Vista images.
www.syngress.com
38
Chapter 1 • Introducing and Installing Microsoft Vista

Running Windows Vista

Windows Vista must be activated within 30 days of installation, after which the system does
not allow you to log on.After activation, the operating system must be updated regularly.
Windows Update is a Control Panel utility where you can conﬁgure automatic updates.

You can make a computer dual-boot or multiboot Windows Vista with another Windows
operating system.The oldest operating system should be the ﬁrst target install, and
Windows Vista should be installed as the last operating system.

Windows Vista and applications can be tested by installing the operating system on
Microsoft Virtual PC or Virtual Server. Virtual Server is available for download free of cost
from the Microsoft Web site. Virtualization allows administrators to test the operating
system and applications without actually installing the operating system on a dedicated
computer.
Q: I installed Windows Vista on my XP computer but selected the Windows XP folder by mistake.
Where are my Windows XP ﬁles now? Did the setup delete these ﬁles? 
A: No. When you select the same disk partition where you have a previous version of Windows, the
old ﬁles are moved to a folder named Windows.old.The Windows directory is not deleted by
the Windows XP setup program.
Q: My computer is already a dual-dual boot system with Windows 2000 Professional and Windows
XP. I have two hard disks with two partitions each. Can I still install Windows Vista on it?
A: Yes, you can make the system a multiboot with another installation of Windows Vista. Check the
minimum hardware requirements and perform a clean installation. Make sure you install
Windows Vista on a partition separate from Windows 2000 Professional and Windows XP
Professional.
Q: I am running Windows Vista Ultimate edition on my computer. I want to use Windows
Anytime Upgrade to install Windows Vista Business or Enterprise edition, but the Windows
Anytime Upgrade is not available in the Control Panel. Why?
A: Windows Anytime Upgrade allows you to upgrade the current edition to a higher edition with
more features.The Ultimate edition has all the features and is the highest edition in Windows
www.syngress.com
Introducing and Installing Microsoft Vista • Chapter 1
39
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

Vista family. If you are running Windows Vista Ultimate edition, the Windows Anytime Upgrade
will not be available in the Control Panel.
Q: I am trying to prepare an answer ﬁle for an unattended installation. I heard that the answer ﬁle is
not a text ﬁle and cannot be prepared using a text editor such as the Notepad. How do I prepare
the answer ﬁle?
A: You will need Windows System Image Manager (Windows SIM) to prepare the Unattend.xml
answer ﬁle. Windows SIM is available with Windows Automated Installation Kit (WAIK).You
can download Windows SIM from the Microsoft Web site.
Q: I need to upgrade my Windows XP Professional computer to Windows Vista. Where can I ﬁnd
the Winnt32.exe ﬁle to start the upgrade?
A: With Windows Vista, both Winnt.exe and Winnt32.exe have been replaced with a single setup
ﬁle named Setup.exe.This ﬁle is used to start the installation process regardless of the type of
installation.
Q: My computer is a part of the Windows workgroup. I do not have a DVD drive on my computer
but the Windows Vista setup program has come on a DVD. Is there any other method to start
the installation?
A: You can use a network share to start the installation. Use a computer with a DVD drive and
share the drive on the network. Map a network drive on your computer to connect to the net-
work share.You can start the installation by running the Setup.exe ﬁle from the network share.
www.syngress.com
40
Chapter 1 • Introducing and Installing Microsoft Vista

41
Installing and
Maintaining
Hardware Devices
and Drivers
Solutions in this chapter:
■
Viewing Currently Installed Devices
■
Installing and Maintaining Devices
■
Device Drivers
■
Using Automated Help with Hardware
■
Customizing Hardware Devices
Chapter 2
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
Several new features on installing and maintaining hardware components and device drivers have
changed from earlier Microsoft Windows releases. Many of these new features include automatic
maintenance and conﬁguration without the need of administrator interaction. By the end of this
chapter, you will know how to install, conﬁgure, and maintain hardware devices and their drivers in
Microsoft Vista.You will learn about new features such as the automated help system and how it
helps you install and maintain your hardware components.As we go, we will customize common
hardware components, such as the mouse, keyboard, and others.
Before we learn about the installation and maintenance techniques and procedures, or discuss
options for updating device drivers for hardware devices, we will discuss how we can take a look at
the currently installed devices and drivers. It would be a good idea to take a look at these devices
using the Device Manager snap-in. For those of you who have worked with the Device Manager
before, you can skip to the next section,“Installing and Maintaining Hardware Devices.”
Viewing Currently Installed Devices
In most cases, you will have a computer with several devices preinstalled in it, each one with a dif-
ferent role. Getting to know these devices, their purpose, and the resources used by them will give
you a better idea of how the system is using these devices.The Device Manager snap-in, which was
available in earlier versions of Windows operating systems is available with Windows Vista also.The
Device Manager makes it easy to manage hardware devices from one place. However, it is possible to
manage individual devices from their respective properties pages, as we will learn later in this chapter.
SOME INDEPENDENT ADVICE
You can use the Device Manager snap-in on a local computer or a remote computer.
The limitation is that you can only use this snap-in to read device conﬁguration
information on a remote computer. To manage devices and device drivers on a
remote computer, you must be logged on locally. To use the Device Manager snap-in
on a remote computer, you must use the Computer Management console. The proce-
dure is outlined in the following steps:
1.
Right-click the Computer icon on the desktop and select Manage.
2.
Click Continue in the User Account Control dialog box to conﬁrm your
administrative action. This opens the Computer Management MMC.
3.
Right-click the Computer Management (Local) node and select Connect to
Another Computer. This can also be done from the Action menu.
4.
Type in the IP address or the name of the remote computer in the Select
Computer dialog box. Alternatively, click the Browse button to locate the
locate computer. 
5.
Click OK. The focus of the Computer Management console is now the
remote computer.
www.syngress.com
42
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

You can open the Device Manager snap-in using any of the following methods. Remember that
since the Device manager snap-in is an administrative tool, you will need to click the Continue
button in the User Account Control dialog box to conﬁrm your administrative action.
■
Click Start and type device in the Search dialog box. Click the Device Manager link
that appears in the search results box.
■
Click Start | Control Panel | Hardware and Sound and click the Device Manager
link.
■
Click Start | Control Panel | System and Maintenance and click the Device
Manager link.
■
Right-click the Computer icon on the desktop and click Manage to open the Computer
Management Console.The Device Manager snap-in is located under the System Tools
node.
Figure 2.1 shows the Device Manager snap-in. Notice from this ﬁgure that the Device Manager
provides a quick snapshot of all hardware devices installed on the system. By default, the snap-in
shows the hardware devices classiﬁed by their type.To view a particular type of device, click the
device type node to expand it.This will show the actual devices installed for that type. For example,
if you click the Disk Drives node, the Device Manager shows the actual disk drives installed on the
system.These devices include internal, external, and removable drives.
Figure 2.1 The Device Manager Snap-in in Windows Vista
The view menu in the Device Manager allows you to view installed devices in several different
ways, as summarized in the following list:
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
43

■
Devices by Type This is the default view in the Device Manager. It shows the devices by
type. For example, all network adapters are grouped under the type Network Adapters.The
actual devices for a particular device type can be viewed by expanding the node.
■
Devices by Connection This view lists the devices by the type of connection. For
example, when you expand the ACPI x86-based PC node, you will notice the Microsoft
ACPI-Compliant System node. Expand this node and you will see the ACPI components
such as the CPU and the PCI bus.You can further expand the PCI Bus node to view dif-
ferent devices connected to the PCI bus.
■
Resources by Type This view enables you to list system resources and the type of
devices using these resources.These resources include Direct Memory Access (DMA),
Input/Output (I/O), Interrupt Request (IRQ), and Memory.To view a particular system
resource and the device using that resource, expand any of the resource nodes.
Administrators frequently use the Resources by Type view to troubleshoot problems caused
by resource conﬂicts.
■
Resources by Connection This view lists resources by the type of connection.This is
different from the Resources by Type view because in this view, the resources are listed by
connection instead of the types of devices using them.
■
Show Hidden Devices Hidden devices refer to non-Plug and Play devices and other
devices that were previously removed from the system but whose drivers were not unin-
stalled. Note that you can enable the Show Hidden Devices option in the View menu with
any of the previously listed views.
Each device type and device shown in the Device Manager has an icon assigned to it. It is easy
to ﬁgure out if a particular device has any problems, as shown in the following:
■
If the device is working normally, it does not have any warning sign on the device icon.
■
If the device has some problem, it is indicated by a yellow warning sign and the exclama-
tion symbol.
■
If a device is improperly installed or is disabled, it is shown with a red X symbol.
Using the Device Manager to Manage Devices
As noted earlier, the Device Manager snap-in is a centralized administrative tool to manage the prop-
erties of any device installed on a system.The property pages for devices provide sufﬁcient informa-
tion to manage them as well as uninstall, enable, disable, and update device drivers.The tabs available
in device properties pages may vary from one device to another but the following actions are
common to all devices. In this section, we will summarize some general actions that can be per-
formed using the Device Manager.
The Action menu in the Device Manager provides the following options, depending on whether
you have selected a device type node or a particular device under that node.As an administrator, you
will be performing these actions quite often. Select a device node or a particular device and click
Action Menu.You can also right-click the node or a device and the context menu will give you the
following options:
www.syngress.com
44
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

■
Scan for Hardware Changes This action manually scans the system for any changes that
have taken place and updates the Device Manager information. By default, if any hardware
changes happen, the Device Manager automatically updates its information.This action
forces another scan of the system hardware.
■
Properties The properties for a particular device contain several pages or tabs you can use
to view the status of the device, enable or disable the device, or update or rollback device
drivers.You can also view the resources used by the device, as well as manually assign
resources. For example, Figure 2.2 shows the General tab of the properties pages for a net-
work adapter.
Figure 2.2 Viewing the Properties Pages of a Hardware Device in Device Manager
■
Uninstall This action uninstalls the device from the system along with its device driver.
■
Disable This action disables the device but does not remove its device driver and does not
uninstall it.
■
Enable This action enables a disabled device.
■
Update Driver Software This action starts the Update Driver Software Wizard in order
to update the device driver either automatically or manually.
The most important action is to open the properties of a device and view information from the
available tabs. From here, you can manage several properties. We will discuss most of the conﬁgurable
properties in the following sections.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
45

Installing and Maintaining Devices
Like its predecessor Windows XP, Windows Vista also makes it easy for you to install, manage, and
maintain hardware devices. Because every other computer has a different set of hardware devices, the
job of installing and maintaining devices is typically done very cautiously. With a variety of devices
available in the marketplace, you need to be absolutely sure the device you are purchasing for your
Vista computer is compatible with the existing system and the operating system. Microsoft maintains
a Hardware Compatibility list for every version of the Windows operating system.You can check the
HCL for Windows Vista on the Microsoft Web page located at http://winqual.microsoft.com/hcl/.
Checking the compatibility of a hardware device before installing it makes sure the device will
function with Windows Vista as expected.The devices listed on the Microsoft Web site are thor-
oughly tested to work with Windows Vista.A device that is not on the HCL might function but will
not be supported by Microsoft. Such an untested device may even fail to install or, if it installs, may
cause functional problems after the installation is done. Most hardware devices supported on a
Windows Vista operating system fall into the following categories:
■
Internal Devices Internal hardware devices are those devices installed inside the com-
puter case either directly on one of the free expansion bus slots or by using a connecting
cable.
■
External Devices External hardware devices are those not located or installed inside the
computer case.You normally connect these devices to one of the available ports of the
computer.
■
Network Devices Network devices refer to those devices connected directly to the net-
work where an appropriate device driver is installed on the Windows computer to access
and use the device.A typical example of a network device is a network printer connected
directly to one of the network ports.
When installing an internal device, you must shut down the computer, physically install the
device, power on the computer, and load its device drivers. In case of external hardware devices, you
need not open the computer case. Moreover, for external Plug-and-Play (PnP) devices such as USB
or FireWire devices, you do not even have to shut down the computer. When installing internal PnP
devices, you must shut down the computer, install the device, and then turn on the computer again.
When the computer is turned on, the device is detected by the operating system.The following sec-
tions provide details on installing both PnP and non-PnP hardware devices.
Installing Hardware Devices
Hardware devices fall mainly into two categories: Plug and Play (PnP) and non-Plug and Play (non-
PnP). Since most of the new devices are PnP-compatible, the non-PnP devices are known as legacy
hardware in Windows Vista terminology. Each hardware device comes with appropriate device driver
ﬁles.These device drivers act as an interface between the device and the operating system. Before you
can install a hardware device, you need to obtain the associated device driver also and make sure the
device driver is written for Windows Vista.
We will learn in the section “Device Drivers” later in this chapter that Windows Vista comes
with a huge library of device drivers. Most of these device drivers are for PnP devices. For non-PnP
www.syngress.com
46
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

or legacy devices, you may need to obtain a device driver from the manufacturer and ensure it is
compatible with Windows Vista. In the following sections, we will discuss how PnP and non-PnP
devices are installed.
Installing a PnP Hardware Device
When you install a PnP device, Windows Vista will automatically detect the device and attempt to
locate a suitable device driver from its device driver library. If a suitable and compatible driver is
found, the driver is automatically installed. For example, when you connect a USB ﬂash drive in one
of the USB ports, it is quickly detected and a driver is automatically installed for it.All you notice is a
small balloon in the Taskbar displaying a message that the device is ready to use.
If the built-in driver library does not have a suitable driver for the hardware device, it will
prompt you to insert a disk containing the device driver.The procedure is quite similar to the one in
Windows XP. Let’s take a look at how compatible and non-compatible PnP devices are installed.
Installing a Compatible PnP Device
A typical installation procedure for a compatible PnP hardware device is as follows:
1.
Run the setup program for the device.
2.
Connect the device. For internal devices, you must shut down the computer and then
install the device. For external USB or FireWire devices, you can simply plug them in or
connect them to an appropriate connector.
3.
Restart the computer in case you shut it down to connect an internal device.
4.
Windows automatically detects the device and installs the device driver.
Installing a Noncompatible PnP Device
In case the device you want to install is a PnP device and Windows does not have a suitable device
driver in its driver library, the device will be detected but Windows Vista will launch the Found New
Hardware Wizard.The procedure to complete the installation is explained in the following steps.
1.
Click the link for Locate and Install Driver Software (Recommended). When you
click this link, Windows will try to locate a suitable device driver from its driver software
library, the CD/DVD drive, and the Internet.
2.
Windows searches for suitable device driver ﬁles. If it does not ﬁnd the driver, you are
prompted to insert the installation disk.
3.
Insert the installation disk that came with the device and follow further onscreen instruc-
tions to complete the installation.
Scanning the System to Detect a New Device
In some situations, a PnP device is installed but Windows does not automatically detect it.You can
force the operating system to detect the PnP device from the Device Manager snap-in, as outlined in
the following steps:
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
47

1.
Click Start | Control Panel | System and Maintenance and click the Device
Manager link.
2.
Click Continue in the User Account Control dialog box to conﬁrm your administrative
action.
3.
Click the device type node.
4.
Right-click the node and select Scan for Hardware Changes.
5.
Windows will attempt to detect the new device (as shown in Figure 2.3).
Figure 2.3 Forcing Windows Vista to Scan for New Devices
If the device is still not detected, make sure the device is connected properly to an appropriate
connector or is seated properly in the expansion slot. If everything else seems to be ﬁne, the device is
either not compatible with Windows Vista or is a non-PnP device.The procedure for installing non-
PnP devices is described next.
Installing a non-PnP Hardware Device
As noted earlier, non-PnP devices are called legacy hardware in Windows Vista. If you need to install a
legacy device in a Windows Vista computer, you should ﬁrst ensure you have a correct device driver
that will work with Windows Vista. Check with the device manufacturer to ensure you get a device
driver that has been tested to work with Windows vista.The procedure for installing legacy hardware
devices on a Windows Vista computer is outlined in the following steps:
1.
Click Start | Control Panel | System and Maintenance and click the Device
Manager link.
2.
Click Continue in the User Account Control dialog box to conﬁrm your administrative
action.
3.
In the Device Manager, select the device type node.
4.
Click Add Legacy Hardware on the Action menu.
5.
The Windows Add Hardware Wizard starts. Click Next to continue.
6.
The next page gives you two options: Search for and install the hardware automatically
(Recommended) and Install the hardware that I manually select from a list (Advanced).This step
assumes you have already obtained the device driver.As shown in Figure 2.4, click the
radio button for Install the hardware that I manually select from a list (Advanced).
www.syngress.com
48
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Figure 2.4 Installing non-PnP Devices Using the Add Hardware Wizard
7.
Click Next. Select the type of device from the list (for example, imaging device). Click
Next.
8.
Select a manufacturer and model. If the manufacturer or the device is not listed in this
page, click Have Disk to install the device from the disk that came with your device.
9.
Follow further prompts to complete the installation process.
NOTE
You can also launch the Add Hardware Wizard from the Control Panel. Open the
Control Panel from the Start menu and switch to Classic View. Click the Add
Hardware icon. Click Continue in the User Account Control dialog box to start the
Add Hardware Wizard.
Maintaining Devices
Administrators are regularly involved in system maintenance tasks, which essentially include tasks
related to installing, maintaining, and managing devices. Some of the common tasks related to
internal and external devices connected to a Windows computer are disabling, enabling, uninstalling,
and removing them.Troubleshooting Windows computers may also require one or more of these
functions. In this section, we will take a look at how device maintenance tasks can be safely com-
pleted using the Device Manager.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
49

Disabling a Device
Disabling a device from the system allows you to keep the device connected and installed in the
system. In case you do not need a device such as a network adapter, you may simply disable the
device using the Device Manager. In case you to need to use the adapter a second time, you can
enable the device using the Device Manager again.
The following steps explain the procedure for disabling an internal or external device.
1.
Open the Device Manager snap-in using any of the previously given methods.
2.
Expand the device type node and select the device you wish to disable.
3.
Right-click the device and click Disable.
4.
A warning prompt appears (as shown in Figure 2.5).
Figure 2.5 Disabling a Device Using Device Manager
5.
Click Yes.The disabled device is shown with an arrow pointing downwards in the Device
Manager.
6.
Close the Device Manager.
TIP
Disabling a device saves you from removing the device driver ﬁles and physically
removing it from the system. This feature is helpful in creating multiple hardware
proﬁles for a system as well as in diagnosing problems with devices.
Let’s look at how disabling devices helps create multiple hardware proﬁles. For
example, consider a laptop that has two network adapters (and most new laptops do
have them!), one wireless and the other an Ethernet adapter. When using the laptop
in your ofﬁce, you connect to the ofﬁce network using a network cable. When at
home, you connect to your home network, which is a wireless network. You can
create two hardware proﬁles for the laptop: Ofﬁce and Home. You can disable the
wireless adapter in the Ofﬁce proﬁle and disable the Ethernet network adapter in
the Home proﬁle.
Another speciﬁc use of this feature is troubleshooting. When a computer with a
number of hardware devices is causing problems, you can pinpoint the problem
www.syngress.com
50
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

device by disabling and enabling them. Disabling a device prevents the operating
system from loading its driver ﬁles. The simple troubleshooting procedure is to dis-
able all the devices you suspect, restart the system, and then enable one device.
Restart the system again and repeat the process for the other devices until you
locate the device that is causing problems.
Enabling a Device
Enabling a device makes it possible for Windows to use the device.A device can be enabled using the
Device Manager snap-in when previously disabled manually or by the system.As noted earlier, a dis-
abled device is shown with an arrow pointing downwards in the Device Manager.
The following steps explain the procedure for enabling a disabled device:
1.
Open the Device Manager snap-in using any of the previously given methods.
2.
Expand the device type node and select the device you wish to enable.
3.
Right-click the device and click Enable.The device is immediately enabled and becomes
ready to use.
4.
The enabled device is shown with a normal icon in the Device Manager.
5.
Close the Device Manager.
Alternatively, you can right-click the device and select Properties.The Device Status section
of the General properties page will show the device as disabled. Click the Enable Device button to
enable the device.
Uninstalling a Device
Uninstalling a device is different from disabling the device. When you disable a device, Windows only
disables the functionality of the device but does not remove its device driver.You can enable the
device anytime and start using it right away. Uninstalling a device works in a bit different manner.
When you uninstall a device from the system, Windows removes all device driver ﬁles and frees up
system resources allocated to the device.This allows you to shut down the system and physically
remove the device.
In case you no longer need a device, you can permanently remove it from the system by unin-
stalling it using the Device Manager.The following steps explain the procedure.
1.
Open the Device Manager snap-in using any of the previously noted methods.
2.
Expand the device type node and select the device you wish to uninstall.
3.
Right-click the device and click Uninstall.
4.
A Conﬁrm Device Uninstall prompt appears (as shown in Figure 2.6).
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
51

Figure 2.6 Uninstalling a Device
5.
Select the checkbox for Delete the driver software for this device. This prevents
Windows from automatically reinstalling the device.
6.
Click OK to uninstall the device and close the conﬁrmation dialog box.
Notice that the uninstalled device does not appear in the Device Manager anymore.You can shut
down the system and physically remove the device from the system.
More about Driver Packages in Vista Software Library
When you uninstall a device for the purpose of physically removing it from the system, you must
select the checkbox for Delete the driver software for this device. This ensures that the driver
ﬁles for the device will be properly removed from Driver Package in the Software Library.This also
ensures that in case you do not immediately physically remove the device from the system, Windows
will not reinstall it using the existing driver ﬁles.
Deleting the driver software for the device removes the driver ﬁles from the Windows Driver
Software library. Windows Vista keeps a library of device drivers in the %SystemRoot%
\System32\DriverStore folder. It does not, however, remove any installed version of the driver for
another similar device using the same driver. In case the device is installed again, Windows starts the
process of looking for a suitable driver for the device.The search locations, include vendor-supplied
media, the Internet, and/or the driver software library.
Windows Vista includes a command-line utility called pnputil.exe you can use for managing
device driver packages stored in the library.This utility is very helpful in determining information
about device driver packages stored in the library, as well as removing speciﬁc device drivers.
Just in case, you need to remove a driver package from the software library, it is a good idea to
obtain information about the driver ﬁles before you actually remove the entire package.The fol-
lowing steps explain the procedure:
1.
Click Start | All Programs | Accessories to expand the Accessories folder.
2.
Right-click the link for Command Prompt and select Run As Administrator.
3.
Click Continue in the User Account dialog box to conﬁrm your administrative action.
This opens the Windows command prompt.
www.syngress.com
52
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

4.
In the command prompt window, type the following command and press the Enter key:
Pnputil.exe –e
The output of the command is a detailed list of driver packages available in the software library.
Take a look at the following output:
C:\Users\User>pnputil.exe -e
Microsoft PnP Utility
Published name : oem0.inf
Driver package provider : Belkin
Class : Network adapters
Driver version and date : 06/01/2005 4.1.2.56
Signer name : microsoft windows hardware compatibility publisher
Published name : oem1.inf
Driver package provider : MSN
Class : Universal Serial Bus controllers
Driver version and date : 04/19/2006 1.1.0.2
Signer name : microsoft windows hardware compatibility publisher
Published name : oem2.inf
Driver package provider : MSN
Class : Universal Serial Bus controllers
Driver version and date : 10/11/2006 1.2.0.6
Signer name : microsoft windows hardware compatibility publisher
Published name : oem3.inf
Driver package provider : NVIDIA
Class : Display adapters
Driver version and date : 08/22/2006 07.15.10.9746
Signer name : microsoft windows hardware compatibility publisher
Published name : oem4.inf
Driver package provider : Belkin
Class : Network adapters
Driver version and date : 10/19/2006 5.87.19.106
Signer name : microsoft windows hardware compatibility publisher
Notice that each driver package has an .INF ﬁle and is named oem#.inf. You will need to know
the name of the ﬁle with an .INF extension to work with a particular driver package.
The following steps explain the procedure for removing a driver package from the library:
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
53

1.
As explained in the previous exercise, obtain the name of the .INF ﬁle for the driver
package you need to remove from the library.
2.
Open the Windows command prompt with administrative privileges.
3.
Type the following command and press the Enter key:
Pnputil.exe –d OEM#.INF
where the # sign represents the actual number of the OEM driver package ﬁle. In case the
driver is currently in use by another device, you must ﬁrst uninstall the device.
Alternatively, you can use the –f switch with the pnputil.exe –d command to force the
deletion of the driver package.
Removing a Device
The process of removing a device from the system depends on the type of device. Most new external
devices are USB or FireWire-compatible such as removable storage devices, scanners, cameras, and
printers. In order to remove a USB printer, camera, or scanner from the system, you must check the
product documentation.The general procedure is to uninstall the device using the Device Manager as
given in the previous section. Once the device is uninstalled, you can disconnect it from the system.
Removing USB and FireWire Devices
Removing a PnP device such as the USB device or a FireWire device is pretty simple.The process is
similar to Windows XP where the notiﬁcation area of the Taskbar shows an icon for the inserted or
installed device.This icon launches the Safely Remove Hardware option that can be used to remove
the device from the computer.The following procedure explains how you can remove a USB ﬂash
drive device from the system.
1.
Click the Safely Remove Hardware icon and click the Safely Remove USB Mass
Storage Device button.
2.
Alternatively, right-click the Safely Remove Hardware icon and select Safely Remove
Hardware.
3.
The Safely Remove Hardware window opens (as shown in Figure 2.7).
Figure 2.7 Removing a USB Device from the System
54
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers
www.syngress.com

NOTE
The deﬁnition of PnP devices states that external PnP devices can be unplugged
without powering off the computer. The question is: why do we need to use the
Safely Remove Hardware function to remove a USB ﬂash drive or any other external
PnP device? When you use the Safely Remove Hardware function, Windows unin-
stalls the device by disabling it and removing its device driver from the operating
system. Until the time you physically unplug the device it is shown in the Device
Manager as disabled and uninstalled. If you do not physically remove the PnP device
from the computer and use the Scan for Hardware Changes option or restart your
computer, the device is detected again and installed. When a device is uninstalled, it
can be safely unplugged without powering off the computer. If you simply unplug
the device, chances are that the device might be damaged. So, it is a good idea to
use the Safely Remove hardware option.
4.
Select the device from the list and click the Stop button.
5.
The Stop A Hardware Device page appears. Select the USB device and click OK.This
stops the device.
6.
Windows prompts you that the device can now be safely removed from the system. Click
OK and remove the USB ﬂash drive from the USB port.
NOTE
When you want to remove a USB device from the system, you must make sure the
device is not in use. For example, when removing a USB ﬂash drive, you must close
all applications using the device. If the device is in use, the system will not allow you
to remove it, displaying a warning message that the device is being used. In case you
have opened a ﬁle from the USB ﬂash drive, close it. If the ﬂash drive or any ﬁle is
currently selected in Windows Explorer, either close Windows Explorer or select some
other drive.
Device Drivers
Each device in the computer is associated with a device driver.The device driver acts as an interface
between the operating systems and the device.A properly installed and conﬁgured device driver
allows the device to interact with the underlying operating system and use the resources allocated to
it.The most common system resources include Direct Memory Address (DMA), Interrupt Request
(IRQ), and Input/Output Address (I/O Address). It is important to update these device drivers as and
when the updates are available. In this section, we will focus our discussions on most common
administrative tasks that involve devices and their associated drivers.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
55

Information on currently installed drivers for a particular device can be obtained from the Driver
tab of the device properties.The following procedure explains how you can use the Device Manager
to view details of the installed device driver.
1.
Open the Device Manager using any of the previously mentioned methods.
2.
Click the + sign opposite a device node to expand it.
3.
Locate the device you wish to work with, right-click it, and select Properties from the
context menu.
4.
Click the Driver tab to open the device driver page (as shown in Figure 2.8).
Figure 2.8 Viewing Details about the Installed Device Driver
The Driver tab provides information about the name of the device, the driver provider, date,
driver version, and who has digitally signed the driver. Digital Signature Veriﬁcation is covered in the
next section.
In order to get detailed information about a device driver, you can click the Driver Details
button to open the Device Driver Details page for the selected device.As shown in Figure 2.9, this
page provides detailed information about the location of the device driver and the speciﬁc name of
the driver ﬁle.
www.syngress.com
56
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Figure 2.9 The Device Driver Details Page
You may notice the location of the device driver ﬁle from Figure 2.8.The device driver installed
on the system is stored in the %SystemRoot%\System32\Drivers folder. All driver ﬁles in this folder
have a .SYS extension that indicates it is the source ﬁle for the driver (as shown in Figure 2.10).The
localized versions of these installed drivers are stored in another subfolder. For example, the U.S.
English versions are stored in the %SystemRoot%\System32\Driver\En-US folder.
Windows Vista keeps a library of device drivers in the %SystemRoot%\System32\DriverStore folder.
Inside this folder, the En-US subfolder has the U.S. English versions of the device drivers.This folder
also has a File Repository subfolder that holds thousands of subfolders containing thousands of dif-
ferent types of devices.The File Repository is the main storage for all device drivers supported by
Windows Vista. Figure 2.10 shows the location of installed device drivers on a typical Windows Vista
installation.
When a device driver is installed, it is written to the %SystemRoot%\System32\Drivers folder.The
corresponding information ﬁle with an .INF extension for each driver is stored in the
%SystemRoot%\System32\DriverStore\FileRespository subfolder.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
57

Figure 2.10 The Location of Installed Device Drivers in Windows Vista
Driver Signature Veriﬁcation
The Windows Hardware Quality Lab performs tests on device drivers to verify them and validate
their compatibility with the Windows Vista operating system. When a device driver is validated,
Microsoft digitally signs the driver so it cannot be tampered with. Digital signing ensures the device
driver has not changed since it was tested by Microsoft or any other authorized manufacturer. If
someone tries to change the driver ﬁles after the digital signature has been placed on it, the digital
signature becomes void. Even if the manufacturer makes changes to the device driver after it has been
digitally signed by Microsoft, that would make it unauthentic.
So, the question here is why does Microsoft or a manufacturer digitally sign device drivers? The
answer is simple. Digital signatures prove the authenticity of a device driver. If a device driver is not
digitally signed, it may not be tested to work with Windows Vista, or the code might have been tam-
pered with after it was written and signed. In case you install a device driver that has not been thor-
www.syngress.com
58
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

oughly tested by the manufacturer or by Microsoft, you can never be sure it will work well with the
operating system.An unsigned device driver can make your Windows Vista installation unstable or
cause unexpected system crashes.
By default, Windows Vista will check the digital signatures or authenticity of a device driver
when you try to install it. If it ﬁnds that the driver is not digitally signed, it will prompt you with a
warning and allow you to stop the installation process.You can conﬁgure the system behavior when
an administrator or a user tries to install a device driver. Use the Group Policies in Windows Vista to
conﬁgure the default system behavior when an unsigned device driver is installed.This Group Policy,
called Code Signing for Device Drivers, is located in the User Conﬁguration\Administrative
Templates\System\Driver Installation subnode under the Local Computer Policy node. Figure 2.11 shows
the location of this Group Policy.
Figure 2.11 Locating the Group Policy Object for Conﬁguring Driver Signing
Options
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
59

NOTE
The purpose of showing Figure 2.10 in this chapter is to explain how you can access
and set the Group Policy for Code Signing For Device Drivers. It is important to note
that in Windows XP, you could conﬁgure the system behavior for unsigned device
drivers using the Control Panel. This has changed in Windows Vista since you can
enable these settings only through Group Policy settings.
When you double-click the Code Signing For Device Drivers policy object, the policy settings
page appears, which is shown in Figure 2.12.
Figure 2.12 Conﬁguring the Code Signing Policy for Device Drivers
The policy has three settings: Not Conﬁgured, Enabled, and Disabled. Click the radio button for
Enabled to enable the policy. Next, in the When Windows Detects A Driver File Without A Digital
Signature drop down box, set the system response in one of the following ways:
■
Ignore This setting allows you to install unsigned device drivers without displaying any
warning prompt.
■
Warn This is the default setting in Windows Vista.This setting lets you display a warning
prompt each time an unsigned device driver is detected.You can still continue with the
installation.
■
Block This setting does not allow you to install an unsigned device driver.
www.syngress.com
60
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

By default, the Warn option automatically selected when you enable the Group Policy of Code
Signing For Unsigned Device Drivers.This default setting works well for most installations. In case you
do not want anyone to install any kind of unsigned device drivers, you may set the policy to Block.
As part of your routine administrative functions, you may be required to conﬁgure this policy appro-
priately for a given group of users.
Updating Device Drivers
In most cases, Windows Vista will automatically update device drivers along with regular Windows
Updates.The only condition here is that the device driver should be included with the operating
system when it is installed.You can conﬁgure the Windows Update feature to check for updated
device drivers along with regular operating system updates. In this section, we will discuss how
Windows Vista can be conﬁgured to automatically check for updated device drivers and how you
can manually update a device driver.
Conﬁguring Windows Update Driver Settings
If you have tried to install a common and known device on a Windows Vista computer, you might
have noticed that the operating system prompts you to check for an updated version of the device
driver.This is because the device driver for that particular device is included in the driver library of
the operating system. If your computer is connected to the Internet, the operating system can auto-
matically check, download, and install an updated driver for your device.This option is enabled by
default and is good for you, the administrator, because manufacturers keep updating their devices and
drivers. Most of these actions run in the background, but your system gets an updated device driver
instead of using the one included with the operating system.
You can change this default behavior of the operating system.The following steps explain the
procedure:
1.
Click Start | Control Panel | System and Maintenance | System.
2.
Click the Advanced System Settings link in the left-hand side panel. Click the
Continue button in the User Account Control dialog box to conﬁrm your administra-
tive action.
3.
The System Properties window opens. Click the Hardware tab.
4.
Click the Windows Update Driver Settings button in the lower half of the page.
5.
The Windows Update Driver Settings page appears (as shown in Figure 2.13).
From this window, you can conﬁgure how Windows Vista behaves when you install a new
device in the computer.The three available settings are as follows:
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
61

Figure 2.13 Conﬁguring Windows Update Driver Settings
■
Check for drivers automatically This is the recommended setting.
■
Ask me each time I connect a new device before checking for drivers This is the
default setting and Windows will prompt you whether or not you want to check for an
updated driver.
■
Never check for drivers when I connect a device Windows will neither prompt you
nor will it check for a device driver when a new device is connected.
Manually Updating a Device Driver
Windows Vista allows you to manually install updates for a device driver or install a different driver
altogether. In order to manually update a device driver or replace an existing driver, you can use the
Device Manager snap-in.The updated device driver can be located on the Internet or may already
have been downloaded and stored in the local system.The following steps explain the procedure.
1.
Open Device Manager using any of the previously explained methods.
2.
Expand the device node and select the device for which you wish to update the driver.
3.
Right-click the device name and select Update Driver Software.
4.
The Update Driver Software page appears (as shown in Figure 2.14).
Notice from Figure 2.14 that you have two options for obtaining the updated device driver.You
can either have Windows Vista check for an updated device driver in its driver library, or you can
browse the computer yourself if you have obtained the driver on a CD or previously downloaded it
from the manufacturer’s Web site.
www.syngress.com
62
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Figure 2.14 Manually Updating Device Driver Software
The update procedure is different, depending on whether you wish to have Windows automati-
cally check for and install updated a device driver or you wish to install the driver manually. If select
the ﬁrst option, Windows will check for an updated driver and will install it if it ﬁnds a newer ver-
sion for the installed driver. If it does not ﬁnd a newer version, it will keep the previously installed
driver.
In case you select the second option—Browse My Computer for Driver Software—the fol-
lowing steps explain the procedure:
1.
Use the Browse button to point to the correct location of the device driver on your com-
puter and click Next.
2.
Otherwise, click the link for Let Me Pick From a List of Device Drivers on My Computer.
3.
Select the manufacturer and choose a device from the list of devices (as shown in Figure
2.15). Click Next.
4.
If you have the device driver on a CD-ROM, click Have Disk.
5.
When the operating system ﬁnds an appropriate driver, it will be installed.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
63

Figure 2.15 Selecting a Device Manually
Rolling Back Drivers
Updating a device driver or replacing a working device driver with another version of the driver
doesn’t always work as expected. In some situations, you may ﬁnd that an updated device driver is
more of a problem than offering any new features or enhanced functionality.You may feel that the
previously installed driver was working trouble-free and it was a mistake to update the driver. It is
rare but quite possible that the system will not restart properly after you have updated a device driver.
As with Windows XP, Windows Vista also offers a feature called Rollback Driver in Device
Manager.This feature allows you to revert to a working copy of the device driver in case the updated
driver does not work with your system.The following steps outline the procedure:
1.
Open the Device Manager using any of the previously described methods.
2.
Expand the device node and select the device for which you wish to update the driver.
3.
Right-click the device name and select Properties.
4.
Click the Driver tab in the device Properties window.
5.
Click the Roll Back Driver button.
6.
The Driver Package Rollback dialog box appears (as shown in Figure 2.16).
7.
Click Yes to continue the process.
8.
Click Close to close the device Properties window.
9.
Close the Device Manager snap-in.
www.syngress.com
64
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Figure 2.16 The Driver Package Rollback Prompt
NOTE
When I tried to use the Roll Back Driver option in my Windows Vista installation, I
noticed that the option was grayed out. Then I ﬁgured out that if I have not
changed the device driver since its ﬁrst installation, why would the system allow me
to roll it back? The reason was simple. There was no backup device driver for the
rollback operation. So, if you have never updated a device driver, you will not be
able to roll it back.
Rolling back a device driver is not always a very good option for the adminis-
trator when he/she wants to update the installed device driver with a new version in
order to take advantage of new features. It is always good to check with the device
manufacturer if a newer and Vista-compatible version of the device driver is avail-
able. As you may notice from Figure 2.15, rolling back a device driver may result in
the reduced functionality of the device and could also pose a security risk. 
Using Automated Help with Hardware
Windows Vista makes it easy for you to install, manage and maintain system hardware using built-in
automated systems, support for hundreds of commonly used PnP devices, and a huge library of
device drivers.The automated help starts right from the time you decide to install Windows Vista on
a new computer or when you upgrade an existing one. In this section, we will look at how Windows
Vista offers you help in installing, maintaining, and troubleshooting computer hardware.
Windows Vista Hardware Assessment
The Windows Vista Hardware Assessment tool helps you determine if the existing hardware in com-
puters on a network are compatible with Windows Vista or not. Unlike the Windows Vista Upgrade
Advisor that can be used on a standalone computer, this tool is helpful if you are managing a ﬂeet of
desktops in a corporate environment. It uses Windows Management Instrumentation (WMI) to com-
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
65

plete this process.This tool can be used to provide a quick and detailed inventory of existing com-
puters in a network.The computer where you run this tool must be running Windows XP with SP2.
Windows Vista Upgrade Advisor
Even when the Windows Vista operating system is not installed on your computer, Microsoft helps
you determine whether your existing Windows XP computer hardware will be able to support a
Windows Vista installation or not.The Windows Vista Upgrade Advisor tool can be downloaded for free
from the Microsoft Web site.This tool analyzes the current hardware in your computer and provides
detailed feedback.The tool will also advise you as to which edition of Windows Vista will run on the
existing computer.You can get more details on Windows Vista Upgrade Advisor and download it
from www.microsoft.com/windows/products/windowsvista/buyorupgrade/upgradeadvisor.mspx.
Windows Help and Support
Windows Help and Support is a great place to look for help when you have trouble installing or
troubleshooting a device.The Help and Support link is located in the Start menu. Windows Help and
Support offers help in several ways, such as:
■
Uses ofﬂine help from the built-in help documentation.
■
Uses online help when you are connected to the Internet.
■
Gets help from Microsoft online customer support.
■
The Search Knowledge Base (KB) on the Microsoft Web site.
■
You can post a question in Microsoft Communities.
■
You can use Remote Assistance to get help from an expert.
Even when you are not connected to the Internet, the ofﬂine help is a great place to get infor-
mation about hardware devices and drivers.To start, perform the following steps:
1.
Click Start | Help and Support.
2.
In the Help and Support window, type hardware devices in the Search box.
3.
Locate the link for the speciﬁc hardware problem you are facing.
Figure 2.17 shows an example of one of the available Help and Support pages related to hard-
ware, devices, and drivers.
www.syngress.com
66
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Figure 2.17 Using Windows Help and Support for Hardware Devices
Support for PnP Devices and Drivers
Windows Vista supports a wide variety of internal and external devices that conform to the PnP
standard. It also includes hundreds of device driver ﬁles to automate the installation of the most com-
monly used PnP devices.As discussed earlier in this chapter, Windows Vista automatically detects PnP
devices and installs an appropriate compatible device driver for it.The process is usually transparent to
the user. Besides this, when you install a new PnP device, Windows Vista can search automatically for
an updated version of the driver for you.You can also conﬁgure Windows Update to automatically
search for updated device drivers whenever Windows Update is scheduled to run, and then later
install these drivers along with any other Windows updates. Refer back to the section Updating
Device Drivers for more details on conﬁguring Windows Update to include device drivers. Figure
2.11 in that section shows different conﬁguration options for updating device drivers.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
67

Customizing Hardware Devices
Hardware devices can be customized based on your personal preferences.This not only increases your
own productivity but also provides ease of use for some users. Of all the devices, the keyboard and
mouse are probably the most commonly used input devices that provide you with an interface to the
actual computer system. In this section, we will focus on customizing settings for some of the com-
monly used hardware devices, such as the keyboard, the mouse, and audio settings.
Customizing Keyboard Settings
Keyboard settings can be customized to provide ease of use as well as fulﬁll special requirements. In
almost all installations, the keyboard is connected to the system before the operating system is
installed.The operating system installs the necessary device drivers for the keyboard and conﬁgures it
for optimum performance.The following steps explain the procedure for modifying default keyboard
settings:
1.
Click Start | Control Panel | Hardware and Sound.
2.
Click the Keyboard link to open the Keyboard Properties window.This is shown in
Figure 2.18.
Figure 2.18 Customizing Keyboard Settings
3.
The Repeat Delay slider is used to conﬁgure how long it takes to repeat a character
when you hold down a particular key. Four stops for this slider provide four different delay
intervals.The leftmost end Long provides the longest delay while the right most stop pro-
vides the shortest delay. By default, this slider is set at the third stop.
www.syngress.com
68
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

4.
The Repeat Rate slider is used to conﬁgure how fast the characters repeat when a key is
kept pressed. By default, this slider is set at the rightmost end, which is Fast.This means the
characters would be repeated at a fast pace when a key is kept pressed.You can reduce the
speed by moving the slider towards the left side.The leftmost setting, Slow, repeats the
characters extremely slowly. When adjusting this slider, you can test the character repeat
rate by clicking the test box and holding down a key.
5.
The bottom part of the window is used to conﬁgure the Cursor Blink Rate by using
another slider. If you bring the slider to the leftmost end, the cursor stops blinking. Moving
it to the rightmost end makes it blink at a high rate.The blinking test cursor provided on
the left side of this setting shows your settings.
SOME INDEPENDENT ADVICE
The Repeat Delay setting for the keyboard is helpful in adjusting character repeti-
tions when a key is kept pressed. If the computer is mainly used for data entry oper-
ations, you may need to adjust the slider toward Short (the left side). This helps in
quickly repeating the character. If the computer is being used by someone who has
difﬁculty using the keyboard (for example, a physically disabled person), you can set
the slider toward the right side. This will ensure that characters are not unnecessarily
repeated if the person cannot quickly lift his/her ﬁngers from a particular key.
Working with the Keyboard Device Driver
The keyboard is like other devices installed on the system and has a driver associated with it.You can
change the installed device driver using the keyboard properties dialog box, which can be accessed
either from the Control Panel or from the Device Manager.The following steps explain the proce-
dure using the Control Panel:
1.
Click Start | Control Panel | Hardware and Sound.
2.
Click the Keyboard link to open the keyboard properties window.
3.
Select the Hardware tab and click the Properties button.
4.
In the keyboard properties window, click the Change Settings button. Click Continue in
the User Account Control dialog box to conﬁrm your administrative action.
5.
Click the Driver tab.
6.
To view information on the installed driver, click the Driver Details button.
7.
To update a driver, click the Update Driver button.
8.
To uninstall the device driver, click the Uninstall Driver button.
9.
If an updated driver is not working as expected, click the Roll Back Driver button to
reinstall the previous driver that was working well.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
69

Customizing Mouse Settings
The mouse is another input device that is used quite often in Windows-based operating systems.You
can customize several settings for the mouse in order to improve productivity as well as increase the
ease of use.The following steps explain the procedure.
1.
Click Start | Control Panel | Hardware and Sound.
2.
Click the Mouse link to open the Mouse Properties window (as shown in Figure 2.19).
Figure 2.19 Customizing Mouse Settings
3.
In the Button conﬁguration section on the Buttons tab, click the checkbox for Switch
primary and secondary buttons.This switches the functions of the left and right but-
tons.The left-click (or simply click) now becomes right-click and vice versa.This is useful
when operating the mouse with your left hand.
4.
Adjust the speed of the mouse’s double-click using the slider in the Double-click speed
section of the Buttons tab.To slow down the speed, move the slider to the left; move it to
the right to increase the speed.
5.
The ClickLock option allows you to select or drag without holding down the mouse
button. Click the checkbox next to Turn on ClickLock to enable this option. When
ClickLock is turned on, you must brieﬂy hold the mouse button to set the lock, move the
mouse pointer to another location on the screen, and release the lock with another click.
6.
On the Pointers tab, select a mouse pointer scheme from the drop-down menu. Each
pointer can further be customized depending on your preferences.You can save the cus-
tomized mouse pointer scheme settings in a ﬁle using the Save As button.
www.syngress.com
70
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

7.
The Pointer Options tab lets you adjust the pointer speed using a slider.You can click the
Snap-to checkbox so that the pointer automatically goes to the default selection in a speciﬁc
dialog box.The Visibility section has settings for displaying pointer trails, hiding the pointer
while typing, and displaying the position of the pointer when the CTRL key is pressed.
8.
The Wheel tab allows you to set vertical and horizontal scrolling properties of the mouse
wheel. By default, when you roll one notch of the wheel, the wheel scrolls three lines ver-
tically.You can increase or decrease the number of lines or click the checkbox for One
screen at a time.This will result in scrolling a full page when you roll one notch of the
wheel vertically. Similarly, for horizontal scrolling, the number of characters is set to 3 by
default when you tilt the wheel.You can increase or decrease this number.
9.
The Hardware tab lets you view or change the properties of the mouse.As discussed in
the next section, you can update, roll back, or uninstall the mouse driver.
Working with the Mouse Driver
As with the keyboard, the mouse is also treated as an external device by the system. It, too, has an
associated device driver.You can use the Properties pages of the mouse to update, roll back, and unin-
stall the mouse driver ﬁles or disable the mouse.You can either use the Device Manager or the
Control Panel to open the mouse properties window.The following steps explain the procedure
using the Control Panel:
1.
Click Start | Control Panel | Hardware and Sound.
2.
Click the Mouse link to open the mouse properties window.
3.
Select the Hardware tab and then click the Properties button.
4.
In the mouse properties window, click the Change Settings button. Click Continue in
the User Account Control dialog box to conﬁrm your administrative action.
5.
Select the Driver tab (shown in Figure 2.20).
Figure 2.20 Working with the Mouse Driver
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
71
www.syngress.com

6.
To view information on an installed driver, click the Driver Details button.
7.
To update a driver, click the Update Driver button.
8.
To uninstall the device driver, click the Uninstall button.
9.
If an updated driver is not working as expected, click the Roll Back Driver button to
install the previous driver that was working.
You may notice from Figure 2.20 that the Roll Back Driver and the Disable buttons are not
available.The reason for the unavailability of the Roll Back Driver button is that there is no backup
driver ﬁle for the mouse. In other words, the driver has never been updated since its installation.The
reason for the unavailability of the Disable button is that the mouse is currently in use. Windows will
not allow you to disable any device that is currently in use.
Customizing Audio Settings
The easiest way to conﬁgure settings for audio devices such as the speaker and the microphone is to use
the speaker icon located in the notiﬁcation area of the Windows Vista taskbar. Using this icon, you can
adjust the main volume of the computer speakers, conﬁgure speaker and microphone properties, and
conﬁgure Windows sounds. In this section, we will look at some of these conﬁguration options.
Setting the Volume Control
The notiﬁcation area of the taskbar includes a speaker icon. If the operating system does not ﬁnd any
audio device connected to the computer, this icon is shown with an X sign in red.Two actions are
possible from this icon, as summarized in the following paragraphs.
Click the speaker icon to open the volume control slider (as shown in Figure 2.21), Move the
slider up or down to increase or decrease the volume control, respectively. Click the speaker icon in
this window to mute the speakers.The Mixer link opens the Volume Mixer dialog box.
Figure 2.21 Adjusting the Speaker Volume
www.syngress.com
72
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Note that when you increase or decrease the volume, it controls the master volume of the com-
puter.You can separately adjust the volume from within individual audio applications, but the max-
imum volume will be limited by the settings done here.
The second option is to right-click the speaker icon in the taskbar and select Volume Mixer.
Figure 2.22 shows the Volume Mixer window. In this window, you can separately adjust the volume
for each application using various sliders.You can also mute speakers for one or more applications by
clicking the speaker button.
Figure 2.22 Adjusting the Volume for Individual Applications Using Volume Mixer
Notice that when you move the slider in the Device box, the corresponding volume of the
applications is also affected.This is because Windows Vista can adjust the volume of individual appli-
cations separately.
Conﬁguring Playback and Recording Devices
The main playback devices for the computer are your speakers or headphones.The settings for these
speakers are controlled using the Sounds utility in the Control Panel.As noted earlier, you can open
the Sound Control Panel utility directly from the taskbar. Right-click the taskbar and select any of
the options: Playback Devices, Recording Devices, or Sounds.Alternatively, you can use the following
method:
Click Start | Control Panel | System and Maintenance | Hardware and Sound. Click
the link for Sound to open the Sound property window, as shown in Figure 2.23.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
73

Figure 2.23 The Sound Control Panel Utility in Windows Vista
Similarly, in most cases, the recording input device for the computer is the microphone con-
nected to the audio input of the sound card.
Conﬁguring Speaker Settings
The following steps outline the procedure for conﬁguring speaker settings:
1.
Open the Sound Control Panel utility using any of the previously given methods.
2.
Click the Speakers headphones icon.
3.
Click the Conﬁgure button to open the Speaker Setup window. Select the Audio channel
from these options: Stereo, Quadraphonic, 5.1 Surround, and 7.1 Surround.These options
may vary from one sound card to another. Click the Test button to test the speaker setup.
4.
Click the Properties button to open the Speakers Properties dialog box (as shown in
Figure 2.24).
5.
Enable or disable the device from the Device Usage box on the General tab.Adjust the
speaker balance using the slider on the Levels tab.Apply enhancements to the current
speaker conﬁguration from the Enhancements tab.
6.
Click OK to save the settings and return to the Sound Control Panel utility.
7.
Click OK to close the Sound Control Panel utility.
www.syngress.com
74
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Figure 2.24 Conﬁguring Speaker Properties
Conﬁguring Recording Devices
The following steps outline the procedure for conﬁguring settings for the recording device or the
microphone:
1.
Open the Sound Control Panel utility using any of the previously given methods.
2.
Click the Recording tab. Select the microphone from the given list.
3.
Click the Properties button to open the Microphone Properties window (as shown in
Figure 2.25).
4.
Enable or disable the recording device from the Device Usage box in the General tab.
Adjust the recording volume levels using the slider from the Levels tab. Use the
Advanced tab to conﬁgure the audio recording format.
5.
Click OK to save the settings and return to the Sound Control Panel utility.
6.
Click OK to close the Sound Control Panel utility.
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
75
www.syngress.com

Figure 2.25 Conﬁguring Settings for the Recording Device (Microphone)
Summary
In this chapter, we discussed the installation, management, and maintenance of hardware devices and
drivers. We looked at topics that included getting information on currently installed hardware devices
using the Device manager snap-in, installing PnP and non-PnP (legacy) hardware devices, updating
and rolling back device drivers, using Windows Help and Support for automated help with hardware,
and customizing settings for some common devices such as the keyboard, mouse, and audio.
Windows Vista provides several automated wizards to help users with hardware installations. In
most situations, users will not be required to use the Add Hardware Wizard.This is because most of
the new hardware is PnP-compatible and Windows Vista can detect a new device and automatically
search for and install a suitable device driver. Vista includes a huge library of device drivers for hun-
dreds of supported PnP devices.You can also conﬁgure Windows Update to search for updated
device drivers for the installed hardware.
As with Windows XP, the Device Manager snap-in is the main utility used for maintaining
devices and drivers in Windows Vista.You can use this snap-in to view device information, check its
status, update device drivers, rollback drivers, uninstall a device, or disable one.The utility can manage
most of the aspects of devices and drivers on the local computer. When used within the Computer
Management Console, the Device Manager snap-in provides information on installed hardware on
remote computers as well.
Windows Help and Support offers online and ofﬂine help in installing and troubleshooting hard-
ware devices.The ofﬂine documentation is very useful when you are not connected to the Internet.
The step-by-step procedures described are easy even for a novice. Commonly used devices can also
be customized to suit individual preferences.You can adjust the speed of mouse clicks, switch the
functions of left and right mouse buttons and conﬁgure how the scroll button will behave. Similarly,
www.syngress.com
76
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

the keyboard can be conﬁgured for a person who is an experienced data entry operator or for
someone who has physical disabilities.Audio settings let you adjust speaker settings, volume controls,
and audio channels for individual applications used for listening or recording.
Solutions Fast Track
Viewing Currently Installed Devices

Currently installed hardware devices on a Windows Vista computer can be viewed from
the Device Manager snap-in.The Device Manager snap-in is part of the Computer
Management console.To view devices on a remote computer, you must use the Device
Manager from within the Computer Management console.

The Device Manager can be used to view the status of the devices as well as the resources
utilized by them. It displays device and resource information by type and connection.

You can also use the Device Manager to manage device drivers. Disabling a device,
uninstalling a driver, updating a driver, or driver rollback functions are performed using this
snap-in
Installing and Maintaining Devices

Windows Vista contains device drivers for hundreds of PnP devices. It comes with a
software device driver library containing drivers for compatible hardware devices.This
feature makes it easy for a novice user to install hardware devices.

Compatible PnP devices that have been tested to work with Windows Vista are
automatically detected. Windows Vista automatically installs a suitable device driver. For
non-compatible PnP drivers, the operating system detects and launches the Found New
Hardware Wizard.

Non-PnP devices are known as legacy devices in Windows Vista terminology.You can use
the Add Hardware utility in the Control Panel (Classic View) or use the Add Legacy
Hardware application in the Device Manager snap-in to install a legacy device.
Device Drivers

The Device Manager snap-in is the main utility on a local computer for managing device
drivers.The Driver page of the device properties window has buttons to view driver
details, update the driver, disable the device, roll back the driver, and uninstall the device.

When you disable a device, the Device Manager does not remove its driver from the
operating system.The driver remains installed but does not load when the system starts.
When a device is uninstalled, the Device Manager removes the driver for the device from
the operating system.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
77


If an updated device driver does not work as expected, you can always use the Rollback
button to have Windows Vista remove the updated driver and reinstall the previous driver
that worked normally.
Using Automated Help with Hardware

Windows Vista comes with the Help and Support utility, which is located in the Start
menu.This utility is the best place to start when you have trouble installing or
troubleshooting hardware devices.

Windows Help and Support can be used ofﬂine, employing the built-in documentation to
help you accomplish tasks related to hardware, and can also be used online, connecting you
to the Microsoft Web site to help resolve your problem.

Windows Help and Support contains searchable documentation. It also helps you locate
and launch suitable utilities when installing a device, managing it, or diagnosing a problem.
Customizing Hardware Devices

The properties of most commonly used hardware devices such as the keyboard, the mouse,
the speakers, and the microphone can be customized to suit individual needs.

You can set the click and double-click speed of the mouse or switch the functions of the
left and right buttons. Similarly, you can set the repeat delay and repeat rate timings for the
keyboard.

The speaker icon in the Taskbar allows you to conﬁgure audio settings for playback
(speaker) and recording (microphone) devices.The volume mixer is used to set the master
volume control as well as the volume control for individual applications.
www.syngress.com
78
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

Q: I opened the Device Manager snap-in from within the Computer Management console but am
unable to update driver ﬁles for the audio adapter. What could be the problem?
A: There is no problem at all. When the Device Manager utility is used on a remote computer, you
can only view information, not modify it.You must use the Device Manager locally to modify
device drivers. Moreover, if you open the Device Manager as a standalone snap-in, you cannot
even connect to a remote computer.
Q: What is the quickest way to ﬁnd out whether Windows Vista includes device drivers for the new
AGP adapter I purchased?
A: Most new devices are PnP devices, so your new AGP adapter should be as well. When you install
the adapter, it will automatically be detected by the operating system. If the Windows Vista soft-
ware driver library has a suitable driver for it, the device will be installed. Otherwise, Windows
will launch the Found New Hardware Wizard.
Q: I need to see which IRQ numbers are being used by different devices on my computer. How
can I do this?
A: Use the Device Manager snap-in. Click View and select Resources by Connection. Expand
the Interrupt Request (IRQ) node to view a list of IRQ numbers and devices connected to
each.
Q: If Windows Vista includes drivers for hundreds of PnP devices, how can I update these drivers
automatically?
A: Windows Update can be conﬁgured to update device drivers automatically when it updates the
operating system.
Q: What is the difference between uninstalling a device and disabling a device using the Device
Manager?
A: When you uninstall a device, the device drivers are uninstalled and removed from the operating
system.This gives you an option to remove the device from the system. If the device is con-
nected again, you will need to install the device driver again. On the other hand, when you dis-
able a device, the operating system just disables the device but does not remove device driver
ﬁles.You can use the Enable Device function anytime to start using the device. Disabling devices
are helpful in diagnosing device problems as well as creating multiple hardware proﬁles.
www.syngress.com
Installing and Maintaining Hardware Devices and Drivers • Chapter 2
79
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

Q: I am working in a small organization and my computer is used by two other employees. How
can I make sure none of the other employees installs an unsigned device driver and makes the
system unstable?
A: Enable the Code Signing for Device Drivers Policy and set it to Block unsigned device
drivers.You can ﬁnd this Group Policy in the User Conﬁguration\Administrative
Templates\System\Driver Installation subnode under the Local Computer Policy node.To open the
Local Computer Policy MMC, run the GPEDIT.MSC command from the Run dialog box.
Q: How does Windows Vista handle audio settings differently from Windows XP?
A: Windows Vista provides you with an option to set the volume control separately for each appli-
cation that uses audio devices.
www.syngress.com
80
Chapter 2 • Installing and Maintaining Hardware Devices and Drivers

81
Customizing
Desktop Properties 
Solutions in this chapter:
■
Customizing the Display Appearance and
Screensaver
■
Customizing the Taskbar and Toolbar
■
Customizing Desktop Themes
Chapter 3
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
Microsoft Vista provides several changes and options regarding the way you can customize your
desktop. In this chapter, we will focus on how to customize your desktop, and by doing so, improve
your user experience. By the end of this chapter, you should know how to customize your menus,
taskbar, screensaver, desktop backgrounds, and other customizable desktop features. Understanding
how to customize your desktop in Microsoft Vista is essential since users will often ask for your help
in customizing theirs.
Customizing the Display 
Appearance and Screensaver
You can customize the appearance of your Microsoft Vista screen in many different ways, and in the
pages to come, we will show you how to use some very handy tools. Without going into all of the
details, and describing what Microsoft says word for word, we will show you the down-and-dirty
ways of getting things done. First, we’ll look at easy ways to make changes to your desktop without
having to open the Control Panel for everything.
If users can make changes by simply right-clicking, it will make their Vista experiences much easier
than trying to search for options in the sundry Windows menus. However, we will describe both here,
just so the user understands both methods, along with the easiest way to get at these options.
Customizing the Desktop Background
All users like to put pictures on their desktops. Whether you want to post a family picture or that of
a friend on your desktop, it’s very easy to give your workspace a cool and personal touch. So let’s
look at the ﬁrst way to customize your desktop: changing your desktop background. In Figure 3.1,
we’ve right-clicked the desktop to bring up the menu. We then selected the Personalize option at
the bottom of the list.
Figure 3.1 Desktop Customization Personalize
82
Chapter 3 • Customizing Desktop Properties
www.syngress.com

After you select the Personalize option, Vista displays a new GUI for the user. In Figure 3.2, we
will select Desktop Background, where the user can choose between Microsoft preloaded pictures
(as shown in Figure 3.3) or browse through the computer for pictures already saved to the user’s hard
disk.This is one of the easiest ways for users to customize their backgrounds, but as we will show in
Figure 3.4, there is an even simpler method.
Figure 3.2 Appearance and Personalization—Personalization
Figure 3.3 Appearance and Personalization—Personalization—Desktop
Background
www.syngress.com
Customizing Desktop Properties • Chapter 3
83

In Figure 3.3, the users may choose the picture to set as their backgrounds by selecting the pic-
ture and then clicking OK.They will also be able to display the picture in different ways, as shown
on the bottom left.They have the option to center the picture, display it as widescreen, or have
smaller pictures displayed in a widescreen format.The user simply selects one of these and clicks OK.
This can be changed if the user does not like the format of the picture on the desktop since some
pictures, due to their low resolution, might look grainy if blown up to ﬁt the full screen.Also, having
the same picture displayed multiple times can be distracting.
If users right-click a picture or a picture on a Web page, they can choose to set that picture as
their backgrounds, thereby providing themselves with a quick shortcut so that they don’t have to save
and reopen pictures on their computers. In Figure 3.5, note how our picture looks after we’ve made
it our desktop background by following the link in Figure 3.4.
Figure 3.4 Appearance and Personalization: Set As Desktop Background
SOME INDEPENDENT ADVICE
There is no undo when selecting a background picture if you don’t like the way it
looks. Remember that not all pictures off the Web are going to look good as a back-
ground. This is due to the size and/or type of ﬁle you are using. People also ask if
they can set a video to play as their desktop backgrounds. Right now, Vista doesn’t
have such an option.  
www.syngress.com
84
Chapter 3 • Customizing Desktop Properties

In Figure 3.5, the picture on our desktop has now been made our new desktop background.This
can be undone by going back to the desktop background (as shown in Figure 3.3) and selecting the
old background.
Figure 3.5 Set As Desktop Background: New Background
The Vista Dual Time Zone Clock for Your Desktop
Next, we will look at some other ways to customize your Vista appearance. One way is to right-click
the bottom right of your clock and adjust it to have dual time zones.This feature comes in handy for
any user who needs to know different times around the world simultaneously.After users adjust their
clocks and name each one (only two clocks are allowed), they can easily see dual time zones on their
desktops (as in Figure 3.6) by moving the mouse over the clock.
Vista Sidebar Gadgets
Users are always looking for ways to personalize their desktops whether at work or home. Some very
easy ways to do this can be found at a Microsoft Web site called Vista Sidebar
(http://vista.gallery.microsoft.com/vista/SideBar.aspx?mkt=en-us).The site’s gadgets, as they are
called, can be added to your desktop for fun, or to make it more interactive. We added a few gadgets
from the Microsoft Web site to our desktop in Figure 3.7.These are displayed on the side of your
desktop, such as the name Vista Sidebar.You can choose from many different gadgets, but here we
selected only a few for display.
www.syngress.com
Customizing Desktop Properties • Chapter 3
85

Figure 3.6 A Dual Time Zone Clock
Figure 3.7 Vista Sidebar Gadgets for Your Desktop
www.syngress.com
86
Chapter 3 • Customizing Desktop Properties

Choices range from a clock to an eBay gadget that allows you to be logged in to your eBay
account when using the gadgets.The Weatherbug is also a great gadget; it informs you of the weather
anywhere in the world wherever you are. But as you’ve probably guessed, there are things you need
to know about the Vista Sidebar.
As with everything you add to Vista, various options are available, and if users right-click the
Vista Sidebar and choose Properties, they will be able to change the way Vista Sidebar looks on
their desktops.The settings in Figure 3.8 are the default settings in the Properties menu. We recom-
mend that the user check the box to start the sidebar when Windows begins.
Figure 3.8 Vista Sidebar Gadgets for Your Desktop: Properties
We also recommend that you do not select the options to keep the sidebar on top of all the
other Windows programs.This can cause some problems and resizing issues when using common
Windows programs. If users have other questions about how to customize the sidebar, they can go to
Help or select the How Do I link at the bottom of the Properties window (as shown in Figure 3.8).
In Figure 3.9, we show how you can get the properties for each gadget.To the right of each
gadget an X and a wrench will appear if you move your mouse over it.The X will close the gadget,
while the wrench, if selected, will display the properties for the gadget (as shown also in the ﬁgure’s
images).This allows for the quick and easy conﬁguration of each gadget on your desktop.
www.syngress.com
Customizing Desktop Properties • Chapter 3
87

Figure 3.9 Vista Sidebar Gadgets for Your Desktop: Gadget Properties
SOME INDEPENDENT ADVICE
Remember to use gadgets only from the Microsoft Web site. If you just download
gadgets from other Web sites, they could be harmful to your computer. Also, when
using these gadgets, use only what you really need. They can use a lot of your com-
puter’s memory and resources. If you have a ﬁrewall other than Microsoft, you might
have to allow these to communicate with the outside world or create a rule that
allows them to do so. 
Customizing the Screensaver
Adding a screensaver to Vista is the same as it was in XP, as you can see in Figure 3.10.You just
choose the screensaver or photos you would like and then select your time.The user can reach this
screen by following the Screensaver Settings from the same menu used in Figure 3.2.Although
nothing has really changed, there are some problems with certain preloaded screensavers because
Microsoft did not load options for them. However, as we continue, we will show you how to hack
the Registry and change the settings for certain screensavers.
www.syngress.com
88
Chapter 3 • Customizing Desktop Properties

Figure 3.10 Vista Screensaver Settings
Users can select videos to add to their screensavers but not directly. Instead, the user must ﬁnd a
screensaver program that will change the video to an SCR ﬁle so that Windows can recognize it.
NOTE
Be careful when making any changes to the Registry.   
To make changes to certain screensavers in Vista, the user must click the Start
button, type Regedit, and press Enter. Navigate through the paths listed in the fol-
lowing for each screensaver and create the required DWORD or String entries for
each. The following four screensavers can be changed: Aurora, Mystify, Bubbles, and
Ribbons. In the list that follows, we will show the DWORD that can be modiﬁed.
People have many different views as to what values work best, so our recommenda-
tion is to make your changes and test them.
Before you start, however, remember to back up your Registry. This should also
be done before trying to hack your Registry.
Aurora Screensaver:
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Screensavers\
Aurora
Amplitude—Slow Motion
Brightness—Brightness
NumLayers—Brightness
www.syngress.com
Customizing Desktop Properties • Chapter 3
89

Speed—Fast or slow
SpanMultiMon—For Dual Monitors
Bubbles Screensaver: 
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Screensavers\
Bubbles
BMP—Path for Bitmap
ShowShadows—Shadows
MaterialGlass—Transparency 
ShowBubbles—Bubbles
TurbulenceForce—Bubble Interaction
TurbulenceSpeed—Bubble Interaction Speed
TurbulenceNumOctaves—Speed of Bubbles Changing Colors
Radius—Size of the bubbles
SphereDensity—Number of Bubbles on the screen
SpanMultiMon—For Dual Monitors
Mystify Screensaver:
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Screensavers\
Mystify
BMP—Path for Bitmap
CameraFOV—View of Angle
LineWidth—Thickness of Line
NumLines—Number of Lines
SpanMultiMon—For Dual Monitors
Ribbons Screensaver:
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Screensavers\
Ribbons
CameraFOV—View of Angle
RibbonWidth—Thickness
NumRibbons—Number of Ribbons
Blur—Ribbon Fade
SpanMultiMon—For Dual Monitors
Customizing the Taskbar and Toolbar
The customization of the taskbar and toolbar within Vista is as easy as right-clicking the taskbar on
the bottom of the Vista screen and selecting properties. Once you have done this, you will see a
menu with four tabs (see Figure 3.11).This will allow the user to change the settings in the taskbar,
Start menu, notiﬁcation area, and toolbars. For now, we will look at the Taskbar—and the ﬁrst option
is to lock the taskbar.This will prevent any changes to the taskbar’s size.
www.syngress.com
90
Chapter 3 • Customizing Desktop Properties

Figure 3.11 The Vista Taskbar and Start Menu Properties: Taskbar
If this is unchecked, the user may make the taskbar larger, which is good in case the user has
many documents open or many programs running that they need quick access to.All of the options
shown in the taskbar menu are the default.The user may drag and drop programs into the taskbar to
add more for faster use.As shown in the ﬁgure, there are three, such as Internet Explorer.
Making your toolbar more user friendly is simple. In Figure 3.12, the user would right-click the
toolbar to bring up the menu below, and then select Toolbars.The ﬁgure shows the current toolbars
available and at the bottom you can add more toolbars if needed from Vista. In our ﬁgure, we
selected the desktop to show how this works.The user simply clicks the toolbar they would like to
use or the toolbar they would like to remove by deleting the check beside the name.
Figure 3.12 Vista Toolbar: Options
Customizing Desktop Properties • Chapter 3
91
www.syngress.com

Once the user selects the toolbar he or she wants, it is loaded into the toolbar, as shown in
Figure 3.13.Then, after you click the arrows to the right of the new toolbar loaded, a menu will
appear, or items will launch depending on what was selected. Remember that you need to select the
arrows to the right of the word, not the word itself since that will do nothing.This may also be done
by using the tab in Figure 3.12, but it is easier if you just right-click and use the method shown in
Figure 3.13.
Figure 3.13 Vista Toolbar: Desktop
NOTE
The favorite Windows balloon that shows up all the time on your taskbar or toolbar
can be a pain. Here’s a quick way to hack into your Registry and stop this from hap-
pening. This will keep all balloons from appearing on your screen, so be careful
when using this because you might want to see certain balloons keep coming up.
Figure 3.14 shows a typical balloon that appears from time to time. Now if you go to
Start and regedit, you can stop this from coming up again along with all others. 
You must go to HKEY_CURRENT_USER\Software\Microsoft\Windows\
CurrentVersion\Policies\Explorer. From there, create a new REG_DWORD called
Taskbarnonotiﬁcation and give it a value of 1. Then, restart your computer.
www.syngress.com
92
Chapter 3 • Customizing Desktop Properties

Figure 3.14 Vista Toolbar: Balloons
Another way to have more control over your Start menu and taskbar is to go to Start and Search,
and then type gpedit.msc.This will bring up the group policy object editor. From there, select user
administration and administrative template. From there, select the Start menu and taskbar.This
will allow many more changes to your system without having to search for all of them. Figure 3.15
shows what it would look like. Users must right-click the setting they would like to change.
Figure 3.15 The Vista Group Policy Object Editor
Following their right-click, the users would select Properties. A box will appear (as shown in
Figure 3.16) with settings and an explanation tab. It is recommended the user read the description if
they are unsure which setting they are trying to change.
www.syngress.com
Customizing Desktop Properties • Chapter 3
93

Figure 3.16 Vista Group Policy Object Editor: Properties
Customizing with Desktop Themes
Your desktop theme is really what it says: it’s a theme.The theme contains all of the settings you have
made to your desktop, such as color, size, background, and screensavers.As you can see in Figure 3.17,
we have selected Theme Settings from the same menu as in Figure 3.2. Here, our current theme is
our modiﬁed theme with Other being listed.You may switch or save different themes as you wish.
Figure 3.17 Vista Appearance and Personalization—Personalization—Theme
Settings 
94
Chapter 3 • Customizing Desktop Properties
www.syngress.com

Summary
Microsoft Vista has made some changes from the older version of XP, but when it comes to the
changes made in this chapter, there are really very few. Most everything you will change will have the
same cut and feel that you had in XP but it just might be in a different place. If you can remember
to do a right click on your desktop and go to Personalize, it will make your changes much easier
than the kind you’d have by going to the Control Panel.
The hacks that we did show in this chapter should be done with some care; any changes made to
the Registry can cause harm if you make a mistake. So please remember to back up your Registry or
at least make sure regular users are not working in it.This could cause administrators more work if
they have to start ﬁxing users who wanted to try some of the changes described in this book. More
hacks for other parts of Vista other than what has been covered in this chapter.
Solutions Fast Track
Customizing the Display Appearance and Screensaver

Right-click the desktop to bring up your personalization page.This is a better way to make
changes than going through the Control Panel.

Right-click a picture on your computer or on a Web page to set it as you’re desktop
background.

Pictures can be used for your screensaver, but without a third-party product you cannot use
a video screensaver.
Customizing the Taskbar and Toolbar

The taskbar may be locked into place or hidden by right-clicking the taskbar, choosing
Properties, and selecting various options in the window that appears.

Folders or programs may be added to the toolbar by selecting new toolbars and then
checking them within the display.

To use the items on your taskbar, the user must click the arrow to the right of the
program, not the name.
Customizing Desktop Themes

Once all changes have been made to your computer?such as size, color, desktop, and
screensaver?make sure to save the theme.

The user may move between different themes by selecting them and clicking OK on the
menu, but this is not always good given that things do change from theme to theme.
www.syngress.com
Customizing Desktop Properties • Chapter 3
95

Q: I have copied a picture from a Web page. It was very clear on the Web page, but when I make it
my background it’s fuzzy. How can I ﬁx this?
A: This could be due to the size and type of picture.You could save it to your desktop and then try
to change the dpi settings of the image. However, it is always better to ﬁnd the same picture else-
where on the Web, but at a higher resolution.
Q: I have found sidebars on a Web site and they look very cool. Can I use them?
A: “User beware” is always the rule when downloading anything from the Internet, but if the side-
bars were made for Vista, they should work.
Q: Can I have multiple pictures display for my screensaver as a slide show?
A: Yes, you can save them to one folder and point your screensaver to that folder for those images
to be used.
Q: Do I have to worry about the messages after I use the hack for the message balloons?
A: You could miss a message if you have all of them off.This is for users who do not need to see
them at all and know what’s really going on within their computers.
Q: If I make a change using the Group Policy Object Editor, can it be undone in case I make a mis-
take or don’t like the changes I’ve made?
A: All changes can be undone by going back and returning the settings to the way they were.Thus,
it’s a good idea to make a text ﬁle of what changes you made.
Q: Can I control which screen the sidebars are displayed on if I have two monitors?
A: Yes, this can be changed in the Sidebar Properties window, as shown in Figure 3.8.
www.syngress.com
96
Chapter 3 • Customizing Desktop Properties
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

97
Managing File
Systems and Disks
Solutions in this chapter:
■
Managing Basic and Dynamic Disks
■
Managing File System Formats, Partitions,
and Volumes
■
Increasing File System Performance
■
Sharing File Systems
■
Implementing Local and Network File System
Security
Chapter 4
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
Most computers have multiple ﬁle systems such as physical drives, network drives, and removable
drives that you as the administrator need to manage. By the end of this chapter, you will be able to
manage local and network disk drives and ﬁle systems.You will learn how to perform administrative
ﬁle system tasks such as partitioning your disk drive, formatting your disk drive, sharing ﬁles with
remote users, and using tools like FSUTIL, DiskPart, and Disk Manager.
Managing Basic and Dynamic Disks
Throughout the years, storage requirements and drive sizes have changed, increasing in both cases. In
the early ‘90s, it was nearly unheard of for personal computers to use more than one physical hard drive.
Now it doesn’t seem so strange. Requirements such as fault tolerance, multiple partitions, and quick
accessibility are some of the necessities today. In years past, no one would have ever thought more than
50 to 100MB would be needed on a hard drive. Now we see laptops alone with close to 200GB drives.
With these new requirements and drive sizes comes the need to better manage data storage.
Since Windows 2000, we’ve had two different disk types: basic disks and dynamic disks.A basic
disk is one that can be accessed by MS-DOS and previous versions of Windows, depending on the
ﬁle system installed. Basic disks use the same structure as previous versions of Windows, so if you
have a system that’s a multiboot system with an older version of Windows NT 4.0, you will want to
have a basic disk. Basic disks can contain up to four primary partitions, or three primaries and one
extended. Partitions on a basic disk cannot share or split data with other partitions.
Dynamic disks offer options not available on basic disks.They allow greater ﬂexibility than basic
disks because they use a hidden database to track information about dynamic volumes on the physical
disk, as well as information about other dynamic disks on the system. Since each dynamic disk in a PC
stores a replica of the dynamic disk database,Windows Vista can repair a corrupted database on one
dynamic disk by using the database on another dynamic disk.The location of the database is deter-
mined by the partition style chosen (we will cover this later). Dynamic disks can contain an unlimited
number of dynamic volumes that behave like primary partitions on basic disks. One of the biggest dif-
ferences between basic disks and dynamic disks is that dynamic disks can split or share data across two
or more dynamic hard disks on a computer. Disk management is accessed by going to Start Button
| Control Panel | Administrative Tools | Computer Management | Storage | Disk
Management. Once in Disk Management, you can see the disk drives on your system, which should
be similar to Figure 4.1.Table 4.1 shows a comparison between basic and dynamic disks.
Table 4.1 Comparison between Basic and Dynamic Disks
Feature
Basic Disk
Dynamic Disk
Allows older operating systems such as 
X
MS-DOS, Windows 9x, and Windows ME to 
access the drive locally
Able to span a volume across multiple 
X
dynamic disks or stripe multiple dynamic 
disks
www.syngress.com
98
Chapter 4 • Managing File Systems and Disks
Continued

Table 4.1 continued Comparison between Basic and Dynamic Disks
Feature
Basic Disk
Dynamic Disk
Can contain any combination of ﬁle systems 
X
X
(FAT, FAT32, and NTFS)
Able to expand or shrink a volume
X
X
Able to repair a corrupted database on 
X
one disk by using the database on another
Figure 4.1 Disk Management in Windows Vista
Shortcut…
A Quicker Way to Access Computer Management
A quicker way to get to Computer Management is to click the Start button, right-click
Computer, and then select Manage. 
www.syngress.com
Managing File Systems and Disks • Chapter 4
99

Basic disks can be converted into dynamic disks by going into Disk Management under
Storage within Computer Management, and then right-clicking the disk you want converted and
choosing Convert to Dynamic Disk…, as shown in Figure 4.2.
Figure 4.2 Converting Basic Disks to Dynamic Disks in User Interface
NOTE
Laptop computers are not allowed to convert basic disks to dynamic. This is further
explained in the Microsoft Knowledge Base article located at
http://support.microsoft.com/default.aspx/kb/232463. 
You also have the option of using the command line to convert a basic disk to a dynamic disk.
The utility you would use is diskpart.exe. DiskPart can do everything Disk Management can in the
user interface.This command can be invaluable to administrators who use scripts. Figure 4.3 displays
the DiskPart prompt, along with the convert /? command, showing the options available in creating
disk types.
www.syngress.com
100
Chapter 4 • Managing File Systems and Disks

Figure 4.3 Diskpart.exe Convert Options
In Figure 4.4, we’ve converted Disk 1 from basic to dynamic using the diskpart command. Once
we started diskpart, we selected disk 1 (which you saw in Figure 4.2 as being a basic disk), and then
we issued the convert command to convert it from a basic disk to a dynamic disk.
Figure 4.4 Converting Disk 1 to Dynamic via diskpart
Going to Disk Management in the user interface, you can see that indeed Disk 1 (as seen in
Figure 4.5) has been converted to a dynamic disk
www.syngress.com
Managing File Systems and Disks • Chapter 4
101

Figure 4.5 Disk 1 Converted to Dynamic
BEST PRACTICES ACCORDING TO MICROSOFT
Microsoft recommends ALL administrators become familiar with diskpart.exe. If you
are ever in a situation where you are in the Windows Recovery Environment (WinRE),
the only way you’ll be able to manage the disks is by using diskpart.exe.
SOME INDEPENDENT ADVICE
Practice using diskpart.exe in a controlled environment (such as a lab) and test it in a
simulated WinRE situation. By doing so, you will not ﬁnd yourself being forced to
learn how to use the command while trying to troubleshoot a serious problem for a
user. This will save you and the user a great deal of time and make your efforts look
more professional. As a result, users’ conﬁdence in your skills will increase.
Now that we know the differences between a basic and dynamic disk, and two ways of con-
ducting a conversion, we must understand the different ﬁle systems available, the partition types and
styles, and volumes.
www.syngress.com
102
Chapter 4 • Managing File Systems and Disks

Managing File System 
Formats, Partitions, and Volumes
Managing the ﬁle systems, partitions, and volumes are key in the setup of Windows Vista. Without an
understanding of these concepts, you can’t even install an operating system from scratch. In this sec-
tion, we will cover the ﬁle systems supported by Windows Vista, the types of partitions available, and
volumes. Continuing on with our previous example, we must decide on what ﬁle system to choose,
what type of partition(s) will be created, and the type of volume used so we will can into practice
what we learn. Before doing so, we must deﬁne a ﬁle system, a partition, and a volume. We must also
be familiar with the choices we have in each. For example, when we create a partition with the new
drive, should we create a primary partition or create an extended one? Or should we do a combina-
tion of both? As you can see, there is a lot to think about. Before moving on, we should ﬁrst deﬁne
some important terms and concepts, which are shown in Table 4.2.
Table 4.2 Disk Management Terms
Term
Deﬁnition
File System
A system for storing and organizing folders and ﬁles on a
storage medium making it easy to ﬁnd and access them—for
example, FAT32, NTFS, and so on.
Format
Prepares a disk for storage using a particular ﬁle system.
Partition
Used to segment hard drives into isolated sections. Each parti-
tion is treated by the operating system as a separate drive.
Volume
Can be a disk or a subdivision of a disk that is formatted and
available for storage. 
Partitions and Volumes
Table 4.2 deﬁned for us what a partition is in general terms.The terms partitions and volumes are
used interchangeably.After you install a new disk, you must create at least one partition on the new
disk. Windows Vista supports two types of volumes:
■
Basic volumes
■
Dynamic volumes
Basic volumes are partitions on a basic disk.The storage for a basic volume must reside on a
single physical disk. Basic volumes can only be simple volumes. So a basic volume is made up of:
■
Primary partitions (Master Boot Record [MBR] and Globally Unique Identiﬁer Partition
Table [GPT types])
■
Logical drives within extended partitions (only available with MBR partition styles)
www.syngress.com
Managing File Systems and Disks • Chapter 4
103

Dynamic volumes reside on dynamic disks and include simple and spanned volumes. Simple
volume types under dynamic volumes are the equivalent of primary partitions. Some rules to be
aware of with simple volumes on dynamic disks:
■
If only one dynamic disk exists, you can only create simple volumes.
■
Simple volumes can be increased in size to include any unallocated space on a physical
dynamic disk or even on a separate disk.
Spanned volumes are able to combine areas of unallocated space from two or more disks into
one logical volume.The areas of unallocated space do not have to be the same size. In other words,
you can have one drive that is 100GB and another that is 50GB created as a spanned volume and
appearing as one logical volume. When implementing spanned volumes, keep these points in mind:
■
NTFS or unformatted volumes can only be extended.
■
After the creation of a spanned volume, you cannot delete any portion of it without
deleting the entire volume.
■
You cannot stripe spanned volumes.
■
Spanned volumes do not provide fault tolerance.
NOTE
Windows Vista no longer supports the use of software RAID, which under Windows
XP and NT was available. Only server versions of Windows such as the upcoming
Longhorn Server will support them.
What we need to do now is explore the different types of partitions available to us in Windows
Vista so we make the best decision possible for our own scenarios. We know that a basic disk that can
only contain basic volumes can have up to four partitions, but if we go further, we see that this limi-
tation actually applies to those disks that use a Master Boot Record (MBR). Basic disks using GUID
Partition Tables (GPT) can have as many as 128 partitions, but more about partition styles later.The
following are descriptions of the partition types available in Windows Vista.
■
Primary Partition The partition on a drive that holds and starts the operating system.
Multiple primary partitions can reside on a disk, but not all have to hold an operating
system.
■
Extended Partition A partition that does not hold a drive letter in itself but can be
divided into logical drives.An extended partition is not formatted; the logical drives that
reside on it are instead.
■
Active Partition The partition from which x86-based systems start up.The active parti-
tion must be on the ﬁrst physical drive (Disk 0).
■
Boot Partition The partition where the Windows system ﬁles are located.
■
System Partition The partition that contains the bootstrap ﬁles that Windows uses to
start the system.The system partition displays the boot menu.
www.syngress.com
104
Chapter 4 • Managing File Systems and Disks

Now that we’ve reviewed volumes and partitions and the types available, we must deﬁne what
partition styles are and discuss the two varieties available.
Partition Style
Most administrators who have not installed Windows 2003 Server with Service Pack 1 or the 64-bit
version of Windows XP Professional will ﬁnd the concept of partition styles a bit foreign.A partition
style is the method that Windows Vista uses to organize partitions on a disk. Windows XP
Professional only supported MBR partition styles on x86 computers while also supporting GPT on
its 64-bit version. Windows Vista supports both on the x86 architecture.
Master Boot Record
The Master Boot Record (MBR) is the traditional partition style.The MBR contains a partition
table that describes where the partitions are located on the disk. Before Windows 2003 SP1 and XP
Professional 64-bit, administrators never had to worry about choosing the MBR, it was the only style
supported. MBR disks can support up to four primary partitions or three primaries and one
extended. Within the extended partition you can created unlimited logical drives.
Globally Unique Identiﬁer Partition Table 
The Globally Unique Identiﬁer Partition Table (GPT) provides a more ﬂexible way of partitioning
disks than the older MBR scheme. It was introduced as part of Intel’s Extensible Firmware Interface
(EFI).This speciﬁcation deﬁnes a new model for the interface between operating systems and plat-
form ﬁrmware.You can ﬁnd more information about EFI at www.intel.com/technology/eﬁ.
Although it may seem a bit more confusing with the use of GPT, this partition style can reside on
either basic disks or dynamic disks. GPT in Windows Vista supports up to 18 exabytes and 128 parti-
tions per disk. Since GPT does not limit administrators to four primary partitions, extended parti-
tions and logical drives are not available with it. Figure 4.6 shows us being asked what type of
partition style we want during the installation of a new hard drive.
Figure 4.6 The Partition Style during a New Drive Installation
www.syngress.com
Managing File Systems and Disks • Chapter 4
105

Conﬁguring a New Disk
In this section, we will conﬁgure and manage a new disk under Windows Vista. We will initialize the
disk, create volumes, choose the ﬁle system for each volume, and even demonstrate how to shrink a
volume. We’ll start by partitioning a new drive after it has been installed.
In our example (as shown in Figure 4.6), when we ﬁrst installed our new drive, we decided to
use the MBR partition style.After selecting the partition style, you then decide if you want to use a
basic disk or dynamic disk.As you know already, we converted a basic disk to a dynamic disk using
the diskpart command. Now we need to create a volume on our new drive. In disk management, we
must right-click the area of the new drive labeled as unallocated (shown in Figure 4.7).As you can
see, the only option we have is to create a new simple volume. Remember, the reason for this is
because we only have one disk we are creating this dynamic volume for.
Figure 4.7 Selecting a New Simple Volume
Now Windows Vista will run through a new simple volume wizard (as shown in Figure 4.8).At
the New Simple Wizard initial screen, click Next.
Figure 4.8 The New Simple Volume Wizard
www.syngress.com
106
Chapter 4 • Managing File Systems and Disks

Next you are asked to specify the volume size. In our example, we will only choose 4GB (see
Figure 4.9).After you have speciﬁed the volume size, click Next.
Figure 4.9 Specifying Volume Size
Now we assign the drive letter E to our newly created simple volume (see Figure 4.10).After
doing so, click Next.
Figure 4.10 Assigning a Drive Letter to a Simple Volume
Now we come to the part regarding what ﬁle system we want to format this volume with. We
will cover ﬁle systems in the next section, but as you can see in Figure 4.11, we have the choice of
FAT, FAT32, and NTFS. Select NTFS and change the volume label to read Simple Volume. Keep
the Allocation unit size as the default.After selecting NTFS, change the volume label and click Next.
www.syngress.com
Managing File Systems and Disks • Chapter 4
107

Figure 4.11 Choosing the File System Type
We now come to the last screen in creating our simple volume.The Simple Volume Wizard pro-
vides us with a list of the settings we’ve chosen (see Figure 4.12). Since we know these are the set-
tings we want, click Finish. If by chance you saw a setting you didn’t mean to select, just click the
Back button to the point where you made your mistake and make the correction there.
Figure 4.12 The New Simple Volume Wizard Completed
Once formatting of the new volume is complete, you should see the new simple volume listed in
disk management, as shown in Figure 4.13.
www.syngress.com
108
Chapter 4 • Managing File Systems and Disks

Figure 4.13 The New Simple Volume Is Created
Something new in Windows Vista is the ability to shrink a volume without the use of third-
party software. Shrinking a volume allows administrators to easily repartition drives without having to
completely remove and re-create them.To shrink a volume, go to Computer Management |
Storage | Disk Management. Select the volume you intend to shrink and right-click it.You’ll see
the option Shrink Volume, as shown in Figure 4.14.
Figure 4.14 Shrink Volume
Managing File Systems and Disks • Chapter 4
109
www.syngress.com

When you select Shrink Volume, Windows Vista will query the volume for available shrink
space. Next, you will see the screen to choose what size you want to shrink the volume to. In our
example, we have chosen to shrink it to 1.95GB, but it will appear as 2.05GB, as shown in Figure
4.15. Click the Shrink button.
Figure 4.15 Choosing the Size for Volume Shrinkage
After Windows Vista has shrunk the volume, it will appear as shown in Figure 4.16. Our volume
labeled Simple Volume is now 2.05GB, and the amount of unallocated space is up to 7.95GB.
Figure 4.16 The End Results of Volume Shrinking
www.syngress.com
110
Chapter 4 • Managing File Systems and Disks

File Systems
A ﬁle system by deﬁnition is the structure in which ﬁles are named and where they are placed logi-
cally for storage and retrieval. File systems specify conventions for naming ﬁles.This includes the
maximum number of characters in a ﬁlename and which characters are allowed. For a ﬁle system to
be placed on a volume, the operating system must format it. We accomplished this earlier with our
example in this chapter, which you can review in Figure 4.11.
After reviewing Figure 4.11, you may have noticed there is an option to change the size of the
allocation unit.An allocation unit (or cluster) is the smallest amount of disk space that can be allocated
to hold a ﬁle.All ﬁle systems under Windows Vista organize their drives based on allocation units.
This is determined by the number of sectors the allocation unit contains.An example would be a
disk that uses 512 byte sectors: a 512-byte allocation unit contains one sector, whereas a 4KB alloca-
tion unit contains eight sectors. Each ﬁle system under Windows Vista uses different allocation unit
sizes depending on the size of the volume, plus each ﬁle system has a maximum number of allocation
units it can support.The smaller the allocation unit size the more efﬁcient a disk stores information.
This is because the unused space within an allocation unit cannot be used by another ﬁle. So the
smaller the cluster size (or allocation unit) the more efﬁcient the ﬁle system.
Let’s examine the different ﬁle systems supported by Windows Vista:
■
File Allocation Table (FAT)
■
File Allocation Table 32 (FAT32)
■
New Technology File System (NTFS)
■
Universal Disk Format (UDF)
■
CD-ROM File System (CDFS)
Selecting which ﬁle system is best depends on the type of media you are formatting. With hard
disks, you have the option of choosing FAT, FAT32, or NTFS. Optical media such as DVDs or CDs
can be formatted using UDF or CDFS. Windows Vista provides you with choices that should ﬁt any
ﬁle system needs. We will now go over each of the ﬁle systems Windows Vista supports.
FAT
File Allocation Table (FAT), sometimes referred to as FAT16, has its origins back in the days of DOS,
so it’s been around a long time. FAT is a 16-bit ﬁle system. It can support volume sizes of up to
4GBs, although in today’s world that wouldn’t even be ideal for holding the operating system, much
less the pageﬁle that accompanies it. It does not provide any ﬁle system security. FAT is appropriate
for ﬂoppy disks or very small hard drive partitions. It supports the old 8.3 ﬁlename format. FAT’s
allocation unit size can grow to 64KB, which on drives up to 4GB in size wastes a lot of space.
FAT32 
Introduced with Windows 95 OSR2, FAT32 provides better support for users. FAT32 supports long
ﬁlenames (LFN) of up to 255 characters. In theory, FAT32 supports volumes up to 8TB (8 terabytes),
but under Windows Vista, you are forced to use NTFS for volumes larger than 32GB. Just like its
www.syngress.com
Managing File Systems and Disks • Chapter 4
111

predecessor, FAT32 does not include any ﬁle system security.The size of a FAT32 allocation unit is
determined by the system, and can range in size from 1 sector (512 bytes) to 128 sectors (64KB).
FAT32 is ideal for USB ﬂash drives.
NTFS
One could actually write an entire book on NTFS—in fact, some have. What you need to know
about NTFS is it is the preferred ﬁle system of Windows Vista. NTFS is a true 64-bit ﬁle system. It
always has been ever since NT 3.1. NTFS can support drives up to 16TBs (minus 64KBs) in size. It
uses a Master File Table (MFT), which is the ﬁrst ﬁle located on an NTFS drive.The MFT keeps
records of each ﬁle and directory on the drive. NTFS is also a recoverable ﬁle system guaranteeing
the consistency of a volume by using transaction logging and recovery techniques. More detailed
information about NTFS and its architecture is available on the Internet, but is beyond the scope of
this book.
If you convert either a FAT or FAT32 drive to NTFS, you cannot convert it back. If you need to
change the drive back to the previous ﬁle system, you would need to reformat the drive.The fol-
lowing features listed in Table 4.3 are supported in NTFS:
Table 4.3 NTFS Features
Feature
Description
Indexing Service
Provides the ability to perform searches on directories
located on the system. 
File and Folder 
Provides the ability to set permissions on ﬁles and folders. 
Permissions
Can specify which users or groups have access.
Encryption
Provided by the BitLocker Drive Encryption or the
Encrypted File System (EFS). BitLocker encrypts entire hard
drives while EFS can encrypt individual ﬁles and directo-
ries.
Disk Quotas
Controls disk space usage on NTFS volumes. 
File Compression
Provides the ability to compress individual ﬁles, ﬁles in a
directory, and even entire NTFS volumes.
Mounted Drives
Volumes attached to an empty folder on an NTFS drive.
Functionality is similar to other volumes except that
mounted drives are assigned labels and not drive letters.
Distributed Link 
Ensures that OLE (Object Linking and Embedding) links 
Tracking
shell shortcuts continue to work even after the target ﬁle
is moved or renamed.
Sparse Files
Used by the Indexing Service, sparse ﬁles provide a
method of saving disk space for ﬁles containing mean-
ingful data.
POSIX Compliance
Available in Vista only after the Subsystem for Unix-based
Applications feature is enabled. 
www.syngress.com
112
Chapter 4 • Managing File Systems and Disks
Continued

Table 4.3 continued NTFS Features
Feature
Description
NTFS Change Journal
Provides a persistent log of changes made to ﬁles on an
NTFS volume. Is used to track information about ﬁles that
are added, deleted, and/or modiﬁed.
In our example, here we will simply convert a volume formatted as FAT32 to NTFS using the
convert command.The convert command is used to convert FAT and FAT32 drives to NTFS.The fol-
lowing is the syntax for the convert command:
CONVERT volume /FS:NTFS [/V] [/CvtArea:ﬁlename] [/NoSecurity] [/X]
volume Speciﬁes the drive letter, mount point, or volume name.
/FS:NTFS Speciﬁes that the volume will be converted to NTFS.
/CvtArea:ﬁlename Speciﬁes a contiguous ﬁle in the root directory that will be the place
holder for NTFS system ﬁles.
/NoSecurity Speciﬁes that the security settings on the converted ﬁles and directories
allow access by all users.
/X Forces the volume to dismount ﬁrst if necessary.All open handles to the volume will
not be valid.
As you can see in Figure 4.17, we have created a new volume called CONVERT, which is
FAT32. We will be converting this volume, which is the F drive, to NTFS.
Figure 4.17 FAT32 Volume
Managing File Systems and Disks • Chapter 4
113
www.syngress.com

The following steps will convert our F drive from FAT32 to NTFS:
1.
Open a command window by going to Start. Right-click Command Prompt. Choose
Run as administrator, put in the administrator’s credentials, and click OK.
2.
Once in the command prompt, type: CONVERT F: / FS:NTFS.
3.
You are now asked for the volume label. For our example, the volume label is CONVERT,
so type that in, and press Enter.
4.
After the conversion is complete, you’ll see a screen similar to that in Figure 4.18.
Figure 4.18 Conversion Completed
Now go back to disk management.You should see (as shown in Figure 4.19) that our F drive is
now an NTFS volume.
Figure 4.19 Verifying NTFS Conversion in Disk Management
114
Chapter 4 • Managing File Systems and Disks
www.syngress.com

Compact Disc File System
Compact Disc File System (CDFS) is the ﬁle system used on compact discs. Windows Vista is able to
read from, and write to, compact discs that are formatted in the ISO 9660 standard. CDFS is consid-
ered an old format and has been all but replaced by UDF.
Universal Disk Format
Universal Disk Format (UDF) is a ﬁle system deﬁned by the Optical Storage Technology Association.
UDF is based on ISO 13346 and is the successor to the ISO 9660 (CDFS) format. UDF is used for
removable media like DVDs and CDs. Windows Vista is able to read and write to versions 1.02, 1.50,
2.0x, and 2.50. It can read, but not write to, 2.60.
In our example, we will burn a DVD using Windows Vista. Before you can burn a blank DVD,
you must format it just like you would any other disk. First, insert the blank media in the DVD
drive. Windows Vista AutoPlay will recognize that you have inserted a blank DVD (see Figure 4.20).
Choose Burn ﬁles to disc using Windows.
Figure 4.20 AutoPlay Recognizes a Blank DVD
Next, you’ll come to the Burn A Disc screen. In Figure 4.21, we have chosen to Show format-
ting options.The Disc Title will come up automatically to today’s date. We have chosen instead to
change the title of our disc to Example.
Notice that you have the Change Version link just below Live File System. If you click that, you
will be able to change what UDF version you want to use (as shown in Figure 4.22).
www.syngress.com
Managing File Systems and Disks • Chapter 4
115

Figure 4.21 Burning a Disc
Figure 4.22 UDF Options
Keep the default of 2.01 for this example.At this window, you can choose OK. Now we are
back at the Burn A Disc screen. Choose the Live File System option so you can add and delete
ﬁles from your DVD with ease. Plus, your DVD will only be used by Windows Vista systems, so we
are not concerned about backward compatibility. From here, click Next.
Now Windows Vista will format the DVD (see Figure 4.23).
Figure 4.23 Formatting a DVD
www.syngress.com
116
Chapter 4 • Managing File Systems and Disks

After the DVD has been formatted, you can add and delete ﬁles to the newly formatted DVD
with ease.
FSUTIL
Now that we have covered each of the different ﬁle systems available in Windows Vista, we should go
over FSUTIL. FSUTIL is a command-line tool that performs many tasks related to ﬁle systems such as
managing reparse points, sparse ﬁles, or dismounting a volume. FSUTIL is a powerful tool and should
only be used by those who have a thorough knowledge of Windows Vista.To use FSUTIL, you must
be a member of the Administrators group.An example of the FSUTIL syntax is shown next.
FSUTIL fsinfo drives
The preceding command would show you the drives available on your local system.Table 4.4 is a
breakdown of each FSUTIL command, which have subcommands underneath them as well. In the
preceding example, FSUTIL used the command FSINFO.After that, the subcommand DRIVES is
called, which provides us with information about the drives on the local computer. Microsoft pro-
vides a full explanation of the commands within each subcommand of FSUTIL at http://
technet2.microsoft.com/windowsserver/en/library/3dd141a8-57b8-4bd8-81dd-
69c515fd059f1033.mspx?pf=true.
Table 4.4 FSUTIL Subcommands
Command
Description
behavior
Controls ﬁle system behavior such as querying, changing,
enabling, or disabling the settings that generate the 8.3 char-
acter length ﬁlenames.
dirty
Manages the volume dirty bit. When a dirty bit is set, autochk
automatically checks the volume for errors the next time the
system is restarted.
ﬁle
Finds a ﬁle by username if Disk Quotas are enabled. Queries
allocated ranges for a ﬁle, sets a ﬁle’s short name, sets a ﬁle’s
valid data length, or sets zero data for a ﬁle.
fsinfo
Provides ﬁle system information.
hardlink
Provides hard link management. Hard links are directory
entries for ﬁles.  
objectid
Manages object identiﬁers.
quota
Provides disk quota management.
repair
New to Windows Vista. Provides self-healing management,
such as setting the self-healing state of a volume.
reparsepoint
Manages reparse points, which are used for directory junction
points and volume mount points.
www.syngress.com
Managing File Systems and Disks • Chapter 4
117
Continued

Table 4.4 continued FSUTIL Subcommands
Command
Description
resource
New to Windows Vista. Transactional Resource Manager man-
agement.
sparse
Provides sparse ﬁle control. A sparse ﬁle is a ﬁle with one or
more regions or unallocated data in it.
transaction
New to Windows Vista. Provides transaction management.
usn
Manages update sequence number change journal.
volume
Provides volume management. Dismounts a volume or queries
to see how much free space is available on a disk.
Increasing File System Performance
When we talk about increasing or improving ﬁle system performance, we have to talk about the hard
drive. On new systems today with such fast processors, the biggest bottleneck is the performance of the
hard drive itself.All Windows operating systems use virtual memory.They do this by a process referred
to as paging. Paging is the process of moving virtual memory back and forth between physical memory
and the hard drive. By optimizing the performance of the ﬁle system on the hard drive, we in essence
improve the performance of the system itself.There are ways in Windows Vista to improve ﬁle system
performance. Some are through regular maintenance, and others are through settings within the oper-
ating system.We will go over seven different ways of improving ﬁle system performance.
■
Disk defrag
■
Cluster size adjustment
■
Short ﬁlenames
■
Folder structure
■
Compression
■
Relocate pageﬁle.sys
Disk Defrag
File system fragmentation is the inability of the ﬁle system to lay out related data contiguously.Thus,
the hard drive works harder during seeks, which hinders performance. Defragging hard drives is an
effort to improve performance and has been going on for years regardless of the ﬁle system. In the
early days of NTFS, very little talk about fragmentation came up. So little was the subject brought up
that some quite mistakenly believed that NTFS couldn’t be fragmented.This is not the case at all.
NTFS can and does become fragmented the longer a system is used and the more data that is put on
the drive.
www.syngress.com
118
Chapter 4 • Managing File Systems and Disks

Cluster Size (Allocation Unit) Adjustment
As you’ve seen, the performance of NTFS can be affected by disk fragmentation. NTFS performance
can also be affected by cluster size (allocation unit).As discussed earlier, regardless whether a ﬁle is
smaller than the cluster size, the size of that cluster will ﬁll the drive, which means if you don’t
choose the right cluster size when creating a volume, you could face a signiﬁcant performance hit.
Some things to think about when creating an NTFS volume and determining the cluster size:
■
Will the ﬁles typically be about the same size?
■
Will the ﬁles be smaller than the default cluster size?
■
Will the ﬁles on the drive remain about the same size or will they grow larger and by how
much?
Files that are smaller than the default cluster size, and stay relatively the same size, should use the
default size to reduce disk space.The caveat to smaller clusters though is that they tend to fragment
much easier and more often than larger cluster sizes. If the ﬁles you will be storing on the drive tend
to be large (for example, CAD drawings), then you may want to use 16 or 32KB clusters instead of
the default 4KB size.
Short Filenames
On NTFS volumes, each time a user creates a ﬁle with a long ﬁlename, Windows Vista creates a
second ﬁle entry that has a similar 8.3 short ﬁlename. Remember the old 8.3 limitation of FAT12
and FAT16? No? Well, ﬁlenames back then could only have a maximum of eight characters for the
ﬁlename itself, plus a three-character extension.An example would have been genedoc1.doc. With
restrictions like that, it was very difﬁcult to know what ﬁle contained what without a decent descrip-
tion in the ﬁlename.This all changed in the Windows world when NTFS came on. Now we have a
maximum of 256 characters for our ﬁlenames.
On systems with a large number of ﬁles with long ﬁlenames that contain the same initial charac-
ters, the time required to create the ﬁles increases, thus ﬁle system performance is hurt.This is
because NTFS bases the 8.3 ﬁlename on the ﬁrst six characters of the long name. When you have a
large number of ﬁles with similar long names under the same folder, this can cause problems.To
reduce the time required to create ﬁles, use the FSUTIL command, as shown next, to disable the 8.3
short ﬁlename service.After disabling 8.3, don’t forget to restart the system.
fsutil behavior set disable8dot3 1
Folder Structure
One of the advantages of NTFS is its ability to support volumes that contain large numbers of ﬁles
and folders. Some guidelines, however, can improve performance by altering your folder structure.
First, do not put a large number of ﬁles into a single folder. Users that have programs that quickly
open and close ﬁles frequently can cause a performance hit.Try separating the ﬁles into folders that
will distribute the workload on multiple folders at a time. If this is not possible, keep the ﬁles in one
folder, and just like we did previously in this section, disable the 8.3 ﬁlename structure.
www.syngress.com
Managing File Systems and Disks • Chapter 4
119

Compression
It’s no secret that ﬁle compression causes a performance hit.This is because on a compressed NTFS
ﬁle it is decompressed, copied, and then recompressed as a new ﬁle, even if it’s copied onto the same
computer. Systems that are CPU-bound should not use compression.
Relocating Pageﬁle.sys
Another way to improve ﬁle system performance is to relocate pageﬁle.sys to another physical drive
and dedicate that drive to it. By relocating the page ﬁle to a separate dedicated hard drive, you take
advantage of the spindles of that drive and speed up the process of paging.This improves system per-
formance and limits the amount of fragmenting on each physical drive. For more information about
disk optimization, see Chapter 10.
Sharing File Systems
Ever since the release of Windows for Workgroups in the early ‘90s, users have been able to share ﬁles
across the network in a peer-to-peer setup. Sharing resources with others across the network is pretty
straightforward.You decide what you want to share with other users, whether it be ﬁles or printers,
you enabling sharing if it isn’t enabled already, you create the share, and then decide who has access
to the resources and the type of access they have. Windows Vista provides a new capability in that
users can actually share individual ﬁles from within their own Users directory. Versions before
Windows Vista were only capable of sharing folders and not individual ﬁles. Windows Vista provides
two ways of sharing:
■
Public folder sharing
■
Any folder sharing
Each method provides easy ways of collaborating with other users, whether across the network
or locally on the system itself. Public folder sharing provides users with an easy way of sharing ﬁles
without having to create a share.The public folder is designed speciﬁcally for sharing ﬁles.As you
already know, Windows Vista (just like XP and NT) is a multiuser operating system. Multiple users
can share the same system and log on with their own IDs, thereby having their own separate proﬁles
on one PC.
Public Folder Sharing
Users who share a single system can share ﬁles amongst themselves. In Windows XP, this was done
using the Shared Documents folder. Now in Windows Vista, you have a Public folder that automati-
cally allows all users of the local system to access ﬁles in this folder. Figure 4.24 shows the location of
the Public folder. Microsoft has replaced the old Documents And Settings folder, which housed the
user proﬁles, with the Users folder instead, where the Public folder resides. Notice that the Public
folder is also listed in the Favorite Links section in the left window pane.This provides quicker access
to all users on the system.
www.syngress.com
120
Chapter 4 • Managing File Systems and Disks

Figure 4.24 The Public Folder Location
Now let’s say you want to share the contents of your Public folder with users on the network.
You must do two things:
■
Turn on ﬁle sharing.
■
Turn on sharing for the Public folder.
You must enable ﬁle sharing in Windows Vista to share both the Public folder and any other
folders you decide to make available to users across the network.To do this, go to Control Panel |
Network and Sharing Center. In the Network and Sharing Center, you will see an area called
Sharing and Discovery, as shown in Figure 4.25.
Sharing and Discovery contains ﬁve sharing settings:
■
Network discovery
■
File sharing
■
Public folder sharing
■
Printer sharing
■
Media sharing 
www.syngress.com
Managing File Systems and Disks • Chapter 4
121

Figure 4.25 Sharing and Discovery
Notice that all sharing is disabled by default. First, we must turn on ﬁle sharing.To do so, just
click the down arrow button to the right of it and select Turn on ﬁle sharing, as shown in Figure
4.26.This allows us to share any ﬁles we want. User Access Control (UAC) will prompt you for the
administrator’s password if it is still enabled.
Figure 4.26 Enabling File Sharing
122
Chapter 4 • Managing File Systems and Disks
www.syngress.com

Turning on ﬁle sharing shares the %SystemDrive%\Users folder.After we’ve enabled ﬁle sharing,
we must enable Public folder sharing so that we can make available any documents or ﬁles we place
there for network users.As we did when turning on ﬁle sharing, click the right down-arrow button
beside Public ﬁle sharing.As you can see in Figure 4.27, you have three options:
■
Turn on sharing so anyone with network access can open ﬁles
■
Turn on sharing so anyone with network access can open, change, and create ﬁles
■
Turn off sharing (people logged on to this computer can still access this folder)
Figure 4.27 Turning On Public Folder Sharing
In our example, we will allow anyone with network access to open ﬁles, but we will not allow
them to change existing ﬁles or create new ones.
After you’ve turned on Public folder sharing, users from the network will now have read access
to the Public folder.
Any Folder Sharing
We’ve just shown how users can use Public folder sharing amongst local and network users. Now,
what if you need to share different folders throughout your system and not just the Public folder?
Windows Vista provides two ways of sharing other ﬁles and folders. One way is to use the Advanced
Sharing Interface.This is the same method you’ve come to know and love that allows you to manu-
ally conﬁgure share permissions on the folder.The other method is running through the new File
Sharing Wizard.
www.syngress.com
Managing File Systems and Disks • Chapter 4
123

The File Sharing Wizard can be used to share ﬁles and folders in a workgroup or domain envi-
ronment.The shared ﬁles and folders can be stored outside the users proﬁle if need be.Though the
sharing of individual folders with ﬁles in them can be shared outside the user’s directory, the ability
to share an individual ﬁle is lost and the user cannot share an individual ﬁle that resides outside their
user directory. In this example, we will walk through the File Sharing Wizard.
Earlier, we enabled ﬁle sharing along with Public folder sharing. Now we will share a folder
called Marketing that resides in the user Gene Whitley’s user directory. Inside this Marketing folder is
a ﬁle called “my test.txt.” First, let’s go to the C:\Users\gwhitley folder. Figure 4.28 shows a list of
directories, one of which is Marketing.
Figure 4.28 The Marketing Directory
Right-click the Marketing folder and select Share (see Figure 4.29).
Next, you must choose people on your network to share with.As you see in our example in
Figure 4.30, we have chosen Samantha Whitley, who is a member of the domain. We will leave her
permission level at Reader for now. Now, click Share.
www.syngress.com
124
Chapter 4 • Managing File Systems and Disks

Figure 4.29 Selecting Share
Figure 4.30 Choosing Users
Windows Vista now goes through the process of sharing the Marketing folder. Once complete,
the Marketing directory is now shared as \\VISTA1\Users\gwhitley\Marketing. You can see this in Figure
4.31. Click Done.
www.syngress.com
Managing File Systems and Disks • Chapter 4
125

Figure 4.31 The Folder Is Shared
BEST PRACTICES ACCORDING TO MICROSOFT
When in a domain environment, turn off Network Discovery. It can generate unnec-
essary network trafﬁc. Use Group Policies to prevent users on Vista systems from
sharing ﬁles from their user proﬁles unless they are local administrators.
SOME INDEPENDENT ADVICE
After turning off Network Discovery, be sure to publish any shared folders in Active
Directory. This will make it easier for users throughout the domain to ﬁnd them.
Implementing Local and 
Network File System Security
No other issue has dominated the PC industry like that of security. Data theft is one of the biggest
concerns companies have today, whether it’s someone physically stealing a laptop, an internal
employee gaining unauthorized access to information, computer viruses and network worms, or
unauthorized copying of conﬁdential data onto removable media security, the risks are high and
numerous.All of this seems extremely overwhelming, but Microsoft provides incredible tools and fea-
tures to help you in securing your systems.The subject of security is large enough to create a volume
www.syngress.com
126
Chapter 4 • Managing File Systems and Disks

of books, but for our purposes we will be focusing on implementing local and network ﬁle system
security. We will brieﬂy cover four features that Windows Vista provides in aiding you in securing the
ﬁle system.
■
Windows Rights Management Service
■
User Account Control (UAC)
■
BitLocker
■
Encrypted File System (EFS)
Windows Rights Management Service
Have you ever received an e-mail from someone that had a notice at the bottom saying that the mes-
sage was for the recipient only and that any reproduction of the e-mail was strictly prohibited? We all
have received e-mails like this; many of us have conﬁdentiality notices at the bottom of our e-mails just
like it. So what is to prevent you or whomever from forwarding the e-mail on or even printing it out? 
Microsoft has moved toward allowing users to better control the use of the content they send by
means of Windows Rights Management Services (RMS). Windows Vista comes with an RMS client
installed.This enables Windows Vista PCs to open RMS-encrypted documents and enforce whatever
restrictions have been placed on them.To use RMS, you must have an RMS infrastructure in place
and applications that support it.An RMS infrastructure consists of a server running the RMS service,
an RMS client (Windows Vista), and supporting applications such as Microsoft Ofﬁce. When in
place, RMS can:
■
Allow a user to view a document, but not save a copy of it, print it, or forward it.
■
Restrict users from copying and pasting text within a document.
■
Make it difﬁcult to open a document using a client that does not enforce RMS protection.
User Account Control 
Many threats to the operating system have occurred in the context of the user having administrative
privileges.Viruses, worms, spyware,Trojan horses, and now most recently malware have been the biggest
threats so far.To combat this, Microsoft recommends using accounts with limited privileges.The logic is
this: If a user lacks the permission to install a new application to the %systemroot%\Program Files direc-
tory, any malware the user accidentally runs is prevented from installing.
For years now, we’ve been making users members of the local administrators group of their PCs
because of the limitations of having a limited user account such as those in Windows XP. UAC pro-
vides the best of both worlds. It offers the beneﬁts of a standard user account from a security stand-
point without the limitations of previous versions of Windows.The following are three advantages of
using UAC.
■
All users including administrators run limited privileges by default, therefore reducing 
security risks.
www.syngress.com
Managing File Systems and Disks • Chapter 4
127

■
Standard users are able to perform most common tasks without having to provide adminis-
trative credentials.
■
UAC enables most applications that required administrative privileges in Windows XP to
run with no problems under standard user accounts.
Figure 4.32 is a UAC message telling a standard user that they must provide an administrator’s
username and password to continue their action. In this case, the standard user was trying to access
another user’s directory and was then prompted by the UAC.
Figure 4.32 User Account Control
For more information about User Account Control (UAC), see Chapter 8.
BitLocker
Using Windows Vista’s BitLocker volume encryption can reduce the risk of important data being
removed if a user’s laptop is stolen. BitLocker provides a full-volume encryption and is especially
useful against “ofﬂine” attacks.An ofﬂine attack is one where another user attempts to gain access to
the data on the hard drive. One way of doing this is to install another operating system on that drive
to gain access to the data. It seals the symmetric encryption key in a Trusted Platform Module or
TPM chip. BitLocker can also store the key on a USB ﬂash drive as well.There are two TPM modes,
as shown in Table 4.5:
Table 4.5 TPM Modes
Mode
Description
TPM only
Transparent to the user and does not change the user’s logon
procedure. If missing or altered, BitLocker will go into recovery
mode. To gain access to the drive, you will need a recovery key
or PIN. This provides protection from hard disk theft. 
www.syngress.com
128
Chapter 4 • Managing File Systems and Disks
Continued

Table 4.5 continued TPM Modes
Mode
Description
TPM with 
The user must have a startup key to log on to the system. 
startup key
The key can be stored on a USB ﬂash drive or can even be a
password. 
BitLocker provides the following for users:
■
Causes great difﬁculty for an attacker to gain access to data from a stolen system or drive
■
Encrypts the entire volume, including the hibernation ﬁle, page ﬁle, and temporary ﬁles
■
Allows users to easily recycle or reuse drives by simply deleting the encryption keys
BitLocker, on the other hand, does NOT do the following:
■
Protect data from network attacks
■
Protect data while Windows is running
■
Protect data on volumes other than the Windows partition
Encrypting File System
Supported only on NTFS volumes, Encrypting File System (EFS) has been with us since Windows
2000. Just like BitLocker, EFS also protects against ofﬂine attacks.To the end user, EFS is transparent.
They still access ﬁles just as they did before EFS was implemented, as long as they have the correct
decryption key—without it, any ﬁles that have been encrypted are impossible to open.
EFS uses a symmetric key encryption along with public key technology in protecting ﬁles and
folders of the system. Users of EFS are issued a digital certiﬁcate with a public and private key pair. It
then uses these keys to encrypt and decrypt ﬁles for the logged-on user. Files are encrypted using a
single symmetrical key.That key is then encrypted twice: once with the user’s EFS public key, and
once with the recovery agent’s key to allow for data recovery. Windows Vista includes two new fea-
tures in its EFS implementation.
■
The ability to store both user and recovery keys on smart cards
■
The ability to encrypt pageﬁle.sys
In our example here, we will encrypt a folder called Finance on our Windows Vista machine.
First, we’ll go to the Finance folder, which for our example is located at C:\Finance. Right-click the
Finance folder (as shown in Figure 4.33) and select Properties.
www.syngress.com
Managing File Systems and Disks • Chapter 4
129

Figure 4.33 Selecting the Finance Folder
Once the properties box for the Finance folder comes up, click the Advanced button on the
right (as shown in Figure 4.34).
Figure 4.34 Selecting the Advanced Button
www.syngress.com
130
Chapter 4 • Managing File Systems and Disks

The Advanced Attributes control box should now appear. Go to the section at the bottom
called Compress or Encrypt attributes and put a check mark in the box beside Encrypt con-
tents to secure data (as shown in Figure 4.35).
Figure 4.35 Encrypting the Contents
After you click OK, you will be asked to Conﬁrm Attribute Changes.The option to Apply
changes to this folder, subfolders and ﬁles should be selected for this example (as shown in
Figure 4.36).
Figure 4.36 Conﬁrm Attribute Changes
Now click OK and you will see Windows Vista applying attributes on the Finance directory.
After the encryption is complete, the Finance directory will change to a green color, indicating the
folder has indeed been encrypted. More detailed information about EFS can be found at
www.microsoft.com/technet/prodtechnol/winxppro/deploy/cryptfs.mspx.
Another way we could have encrypted the Finance directory would have been via the cipher
command.To accomplish the same results in our example using cipher.exe, you would open a com-
mand window and type:
www.syngress.com
Managing File Systems and Disks • Chapter 4
131

cipher /e /s:C:\Finance
The results are the same regardless of which method you choose.
BEST PRACTICES ACCORDING TO MICROSOFT
Microsoft recommends using both BitLocker and EFS together. BitLocker is able to
encrypt all ﬁles on the system partition, including the system ﬁles, while EFS is able
to encrypt volumes that are outside of the system partition, which BitLocker cannot
touch. Together they provide a solid solution. 
SOME INDEPENDENT ADVICE
Encrypt the pageﬁle, this is one of the new features of EFS within Windows Vista. By
encrypting it, you make reading the pageﬁle practically impossible for thieves. 
www.syngress.com
132
Chapter 4 • Managing File Systems and Disks

Summary
Storage requirements and drive sizes have changed throughout the years.The sizes have increased and
so have the requirements. In years past, it was nearly unheard of for personal computers to have more
than one physical hard drive.Today, it isn’t so strange. Understanding and better managing PC storage
is more important than ever.
Windows 2000 provided us with a choice in disk types and it has been with us ever since. We
now have the choice of creating basic disks and dynamic disks.A basic disk is one that can be
accessed by MS-DOS and previous versions of Windows depending on the ﬁle system installed. Basic
disks use the same structure as previous versions of Windows and NT. Dynamic disks offer options
not available on basic disks.They provide greater ﬂexibility than basic disks because they use a hidden
database to track information about dynamic volumes on the physical disk and monitor other
dynamic disks on the system.
Managing the ﬁle systems, partitions, and volumes are key in setting up Windows Vista. Without
an understanding of these concepts, you can’t even install an operating system from scratch. Partitions
and volumes these days are terms that are used interchangeably. Both terms are used to segment
storage on drives. Deciding what type of volume to use also depends on the disk type you create.As
expected, basic volumes only reside on basic disks, whereas dynamic volumes exist on dynamic disks.
Dynamic volumes can contain simple and spanned volumes, whereas basic volumes can only contain
simple volumes.
The ﬁle system you choose is determined upon many factors, including, but not limited to, the
size of your drive, whether security is required, and whether any recoverability is expected. For hard
drives, Windows Vista supports FAT, FAT32, and NTFS. NTFS is the ﬁle system of choice for
Windows Vista because of its vast capabilities, but there are situations where FAT or FAT32 is pre-
ferred, such as with the use of a USB ﬂash drive. Other forms of removable media, like CDs and
DVDs, are supported by Windows Vista with such ﬁle systems as CDFS and UDF.
When we talk about increasing or improving ﬁle system performance, we are typically talking
about the hard drive. On new systems today with such fast processors, the biggest bottleneck is the
performance of the hard drive itself. Windows Vista provides many ways of improving ﬁle system
performance, such as disk defrag, cluster size adjustment, relocating the pageﬁle, creating a more log-
ical folder structure, removing support for both short ﬁlenames, and ﬁle compression.
In the last ﬁve years, no other topic has dominated the industry more than security.The threat of
data being stolen is a key concern for companies these days. Everyday mobile devices storing impor-
tant information are stolen. Windows Vista provides ways of securing data even if the device is stolen.
Features such as the use of Windows Rights Management Service (RMS), User Account Control
(UAC), BitLocker, and EFS make Windows Vista the most secure operating system ever released by
Microsoft.
www.syngress.com
Managing File Systems and Disks • Chapter 4
133

Solutions Fast Track
Managing Basic and Dynamic Disks

Basic disks are the same types used in older versions of Windows and NT and are limited
in what they can do.

Basic disks can support up to four primary partitions or three primaries and one extended.

Dynamic disks are more ﬂexible than basic disks and can span multiple volumes.
Managing File System Formats, Partitions, and Volumes

Windows Vista supports both basic and dynamic volumes.

Basic volumes only include simple volumes.

Dynamic volumes can contain both simple and spanned volumes.

Windows Vista supports two partition styles: MBR and GPT.

Master Boot Record (MBR) is a traditional partition style.

Globally Unique Identiﬁer Partition Table (GPT) is more ﬂexible than MBR and supports
up to 18 Exabytes of data and 128 partitions.

Windows Vista supports FAT, FAT32, NTFS, UDF, and CDFS ﬁle systems.
Increasing File System Performance

Disk defragging allows the ﬁle system to lay out ﬁles contiguously on the drive.

Cluster size adjustment allows each cluster to be better utilized, thereby eliminating wasted
space.

Removing short ﬁlename support reduces the time required to create ﬁles.

Logically laying out ﬁles and folders helps distribute the workload of the ﬁle system.

Compression causes a performance hit any time a compressed ﬁle is opened or closed.

Placing the pageﬁle on a separate disk and volume allows the system to better perform.
That way, data that needs to be accessed isn’t delayed because something is being written to
the pageﬁle at the same time.
Sharing File Systems

Users can better share documents in Windows Vista without compromising security.
www.syngress.com
134
Chapter 4 • Managing File Systems and Disks


Users can share ﬁles amongst other users on the same system by placing documents and
ﬁles in the Public folder.

Users can share ﬁles as they did in previous versions of Windows by manually creating
shares.
Implementing Local and Network File System Security

Windows Vista provides better features in securing the ﬁle system such as Windows Rights
Management (RMS), User Account Control (UAC), BitLocker, and Encrypted File System.

BitLocker encrypts the entire system partition. It protects against ofﬂine attacks, such as a
hard drive that is stolen and then inserted into another system for reading.

EFS can encrypt ﬁles, folders, and entire volumes for the exception of the system ﬁles.You
can use EFS to even encrypt the pageﬁle.
Q: If dynamic disks are so much better than basic disks, why would I ever create a basic disk?
A: For a couple of reasons. If you are running on a laptop, you are not allowed to create dynamic
disks if it isn’t supported. Second, if you are using a system where you multiboot to older oper-
ating systems, you must use a basic disk.
Q: Why should administrators understand how to use diskpart.exe?
A: Because in the case of a system crash, an administrator may only be able to gain access to the
system using the Windows Recovery Environment (WinRE). In this environment, the only way
to manage disks is by using diskpart.exe.
Q: Is GPT only supported on dynamic disks?
A: No. GPT is supported on basic disks as well.
Q: Do all volumes on a single hard drive have to be formatted with the same ﬁle system?
A: No. Volumes are separate entities and therefore each volume can have whatever ﬁle system is
required regardless of whether it shares the same hard drive with other volumes.
www.syngress.com
Managing File Systems and Disks • Chapter 4
135
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

Q: Will the disk defrag utility built into Windows Vista defrag the pageﬁle?
A: No.To do this you need to purchase a defrag utility from a third party like Diskeeper or Raxco
Software.
Q: If I want to share ﬁles with other people who also use my computer, what do I do?
A: The only thing you need to do is simply copy over the ﬁles you want to share and drop them
into the C:\Users\Public directory.That’s it!
Q: Why would I ever use both BitLocker and EFS together? Don’t they do the same thing?
A: These technologies actually complement each other when implemented correctly. BitLocker
encrypts the entire system partition, including system ﬁles that EFS cannot encrypt. If you keep
your data on a separate partition from your operating system, you will need to use EFS to
encrypt those folders and directories because BitLocker itself only encrypts the system partition.
These are only a few reasons.There are many more.
www.syngress.com
136
Chapter 4 • Managing File Systems and Disks

137
General
Administrative Tasks
Solutions in this chapter:
■
Backup and Recovery
■
Printer Management
■
Administer via Remote
■
Scheduling Tasks and Managing Time and
Date
■
Working with Power Plans
■
Managing Services
Chapter 5
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
As an administrator, you must be able to perform several tasks, such as system backup and recovery of
your ﬁle system as well as administering via Remote Desktop.This chapter will outline several of
these general tasks which will help you with your day-to-day administration duties. By the end of
this chapter, you will know how to successfully recover your ﬁles during a disaster and you will know
about application tools that will help make your administration job a little easier. We will explore and
guide you through tasks such as printer management, how to keep your time and date accurate, and
how to save your battery power with power plans.
Windows Vista introduces a new Print Management snap-in that you can use to centrally
manage all printers installed in the enterprise and control print queues individually or as a group. In
addition to this, we will discuss the Task Scheduler service and learn how to create basic and
advanced tasks as well as manage previously scheduled tasks. We will also explore the Services snap-
in, which is one of the essential parts of everyday system administration.
Backup and Recovery
The Backup utility in Windows Vista is one of the administrative tools that has changed a lot from its
Windows XP version. Do not confuse the Backup and Restore Center, located under the System and
Maintenance grouping on the Control Panel, with the Backup Status and Conﬁguration utility.
Whereas you use the Backup and Restore Center to conﬁgure backup jobs and schedule backups,
the Backup Status and Conﬁguration utility helps determine the status of scheduled backups.You can
conﬁgure automatic backups and change settings of previously set up backups. When automatic
backups are conﬁgured on the computer, this is the utility you will be using to view the status of the
backups. Some of the features of the Backup and Restore Center include the following:
■
Use of optical media such as DVD-R and CD-R discs
■
Use of external drives such as USB drives and other external hard disks
■
The ability to back up to a network share
■
The ability to create a complete image of the PC or to restore the entire PC
■
The ability to schedule backup jobs
Additionally, you can use the System Restore utility from the Backup and Restore Center to
create system restore points. System Restore helps you restore system ﬁles and settings to an earlier
point in time.
You can access the Backup and Restore Center from the Control Panel by clicking Backup
Your Computer under the System and Maintenance Group. If you’re using the classic view,
click the Backup and Restore Center icon. From the Start menu, type backup in the search
box and click the Backup and Restore Center link, which appears in the search results box.
If User Account Control (UAC) is turned on, you will be prompted for administrative conﬁrma-
tion. Figure 5.1 shows the Backup and Restore Center.
www.syngress.com
138
Chapter 5 • General Administrative Tasks

Figure 5.1 The Backup and Restore Center in Windows Vista 
In Figure 5.1 you may notice that you can create a Complete PC Backup using the Back up
computer button.To use this feature, you will need to create a Windows Complete PC Backup
image.You can use this image later to restore the entire computer in case there is a major hardware
failure.
NOTE
It is important to note that the Vista Backup Wizard will back up only the most
common types of ﬁles. Some of the ﬁles not included in the backup are:
Files that have been encrypted using the Encrypting File System (EFS)
Files stored on FAT volumes
System and Program ﬁles
User proﬁle settings and Internet e-mail messages that are not stored locally
Temporary and Internet ﬁles
Files in the Recycle Bin
www.syngress.com
General Administrative Tasks • Chapter 5
139

If you do not want to use the Backup Wizard, you are free to choose any type of
ﬁle and any type of backup media, such as a ﬁle, writable CD, or DVD. You can also
use external hard drives or USB drives as the backup location. Just make sure you
have sufﬁcient space to store all the ﬁles you need to back up. As an additional note,
remember that tape drives are not supported as backup media.
Different features of the Backup and Restore Center are discussed in the following sections.
Backing Up and Restoring Files
Backing up and restoring ﬁles and folders in Windows Vista is as easy as clicking a few buttons. Click
the Backup ﬁles button in the Backup and Restore Center and follow the instructions. UAC will
prompt you to conﬁrm your action. In the next window, you can select whether you want to back
up to a hard disk, a CD, a DVD, or a network folder. Make your selection appropriately.
SOME INDEPENDENT ADVICE
When working with Windows Vista Backup, you will ﬁnd that the utility is protected
by UAC. A Windows Security Shield icon appears before the Back up ﬁles and Back
up computer buttons. UAC is a new feature in Windows Vista that prevents unautho-
rized running of any programs or utilities on the computer that make changes to the
computer conﬁguration. UAC is a dialog box that gives you a chance to check what
activity is about to run on the computer. The message you see in the UAC dialog box
depends on what action is being performed. Some examples of messages in the UAC
dialog box are:
■
Windows needs your permission to continue This message appears when
someone attempts to use a Windows function. This message is accompanied
by a Windows Security Shield icon. 
■
A program needs your permission to continue This message appears when
a program that is not a part of Windows but has a valid digital signature
attempts to start. This message is accompanied by an exclamation point
inside the Windows Security Shield icon.
■
An unidentiﬁed program wants access to your computer This message
appears when an unidentiﬁed program without a valid digital signature
attempts to start. This message is accompanied by a question mark inside
the Windows Security Shield icon. 
■
This program has been blocked This message appears when a user tries to
run a program that the administrator has speciﬁcally blocked from running.
This message is accompanied by a red X inside the Windows Security Shield
icon.
You must read the message inside the UAC dialog box very carefully. The purpose
of UAC is to prevent unauthorized changes to the computer that may make it
unstable. If you are logged on as an administrator, UAC asks you to conﬁrm your
www.syngress.com
140
Chapter 5 • General Administrative Tasks

actions by clicking the Continue button in the UAC dialog box. If you are logged on
with a nonadministrative account, you will be prompted for the administrative pass-
word to continue.
Unlike Windows XP, Windows Vista does not give you a chance to select which particular ﬁles
and folders you want to back up. Instead, the Backup Wizard shows you a menu from which you can
select the types of ﬁles, as shown in Figure 5.2.
Figure 5.2 Selecting File Types for Backup
Referring back to Figure 5.1, restoring ﬁles is similar to backing up ﬁles. Click the Restore ﬁles
button and follow the instructions.You can also click the Repair Windows using System Restore
link to replace system ﬁles.As a user , you are supposed to restore only your own ﬁles or ﬁles backed up
on the local computer.As an administrator, you may be required to restore ﬁles for all users of the com-
puter, or ﬁles backed up on another computer.To restore ﬁles for all users, click the Advanced restore
link.This brings up the Backup Status and Conﬁguration window, as shown in Figure 5.3.
www.syngress.com
General Administrative Tasks • Chapter 5
141

Figure 5.3 The Advanced Restore Link Opens the Backup Status and
Conﬁguration Window
You can use the Backup Status and Conﬁguration utility to schedule backup jobs, as discussed in
the following section.
Scheduling Backup Jobs
When setting up a backup job, you can schedule the backup to run once, or automatically at prede-
termined intervals.The Back Up Files window allows you to set up recurring backups on a daily,
weekly, or monthly basis.You can also set the time when the backup job will start. When performing
the backup for the ﬁrst time, the backup utility will make a full backup of the system.
The backup scheduler appears as soon as you click the Next button after selecting ﬁles. Figure
5.4 shows this dialog box.
In this dialog box, you can select how often (daily, weekly, or monthly) to back up, as well as the
day and the time when the backup process will start. If this is the ﬁrst time you are creating a backup
job, the backup utility will take a full backup of the system, including system ﬁles and your data ﬁles.
When you have made your selections, click the Save settings and start backup button.
www.syngress.com
142
Chapter 5 • General Administrative Tasks

Figure 5.4 Scheduling the Backup Job
Backup Computer and Restore Computer
Perhaps the most important improvement of the Backup utility is its capability to create a complete
image of the computer.The Backup and Restore Center includes Backup computer and Restore
computer buttons for this purpose. But this feature comes with its own limitations, some of which
are as follows:
■
It is available only on Vista Business, Ultimate, and Enterprise editions.
■
It can back up only if all volumes on the computer are New Technology File System
(NTFS) volumes.
■
The destination volume must also be formatted using NTFS.
■
None of the hard drives should be a dynamic disk.A combination of basic and dynamic
disks will also not work.
In spite of all these limitations,“Backup computer” and “Restore computer” are good features.
Microsoft recommends that you make a complete backup of the Vista computer when it is com-
pletely set up.This will help you restore the complete image of the computer in case something goes
wrong with software or hardware settings at a later stage. For example, if you install an application or
a device driver that makes your system unstable, or a virus infects your computer and deletes or cor-
rupts system ﬁles, the backup taken using the “Backup computer” feature can help you restore the
entire system.“Backup computer” backs up all system settings, including the program settings as well
as device driver conﬁgurations.
www.syngress.com
General Administrative Tasks • Chapter 5
143

Backing Up the Computer
The Backup and Restore Center is where you can create a complete image of the computer imme-
diately after setting it up. Click the Backup computer button and conﬁrm your action when UAC
prompts you to do so. Follow the on-screen instructions to create the backup.
You also can perform a complete computer backup using the Backup Status and Conﬁguration
Wizard shown earlier in Figure 5.3. Click the Complete PC Backup button in the left-hand pane.
Select a destination drive in the next window and click Create Backup Now.
NOTE
Interestingly, Complete PC Backup can back up ﬁles either on a hard disk or onto a
DVD. Windows Vista Backup does not allow you to use CDs or tape drives for this
purpose.
Restoring the Computer
If something happens to your computer and you need to bring it up again using Complete PC
Backup, make sure you have the following two items with you:
■
The original Windows Vista installation DVD
■
The DVD that contains the Complete PC Backup ﬁles
The procedure is as follows:
1.
Insert the Windows Vista installation DVD and restart the computer.
2.
Choose the Repair option when prompted.
3.
Select the operating system you wish to repair.
4.
The System Recovery Options menu appears. Select Windows Complete PC
Restore.
5.
Follow the on-screen instructions to complete the process.
System Restore
In case you or any user in your ofﬁce has made some changes to the system conﬁguration and the
system is not responding as it should be, System Restore helps you recover the system settings.The
Backup and Restore Center contains links for creating and using the System Restore feature. System
Restore is speciﬁcally useful when the system becomes unstable after:
■
Users make unwanted changes to program and device settings.
■
A new application is installed and it does not behave as expected.
■
Device drivers are updated or some hotﬁxes are installed for applications.
www.syngress.com
144
Chapter 5 • General Administrative Tasks

One of the main differences between Complete PC Backup and System Restore is that
Complete PC Backup includes system ﬁles as well as your personal ﬁles, whereas System Restore
contains only the system ﬁles required to run your system. System restore points that help to restore
the system to an earlier point in time contain only system settings speciﬁc to the operating system
conﬁguration. For this reason, you cannot use System Restore in place of Complete PC Backup. Use
Complete PC Backup when you intend to back up your personal ﬁles.
As discussed in the following sections, the System Restore utility can be a great resource if any of
the aforementioned situations arise.
NOTE
By default, Windows Vista automatically creates system restore points at regular
intervals using the System Protection feature. This includes main system ﬁles and set-
tings stored in the Windows Registry. Even when the system identiﬁes that a major
change has taken place, a separate restore point is created.
Creating a System Restore Point
A system restore point is an image of the system conﬁguration and settings in the Windows Registry
that helps in restoring the system to an earlier date when the system was running perfectly.You can
create a system restore point manually from the System Protection tab of the System Properties
window.The Backup and Restore Center also takes you to the same window when you click the
Create a restore point or Change settings button.The following explains how you can manually
create a system restore point:
1.
Open the Control Panel from the Start menu.
2.
Click the System link in the System and Maintenance group.
3.
Click the System protection link.
4.
Click Continue in the User Account Control dialog box to conﬁrm your action. Figure
5.5 shows the System Protection tab.
5.
You can turn on or off the default automatic creation of system restore points by clearing
the checkboxes under Available Disks.
6.
If you want to create a restore point for only one of the disks, clear the checkbox for the
other.
7.
Click the Create button and follow further instructions.
www.syngress.com
General Administrative Tasks • Chapter 5
145

Figure 5.5 Creating a System Restore Point
The system restore point is created on the same disk where the operating system is installed. It
uses a maximum of 15 percent of the disk space; older ﬁles are automatically deleted in order to
make space for new ﬁles.
Using System Restore
You can use the System Restore button in the System Protection tab of the System Properties
Control Panel to use a previously created system restore point.Alternatively, you can use Repair
Windows Using System Restore from the Backup and Restore Center. UAC prompts you to con-
ﬁrm your action before proceeding.
The Restore system ﬁles and settings dialog box appears, as shown in Figure 5.6.You can
click either the Recommended restore option or the Choose a different restore point option.
Figure 5.6 The Recommended Restore Point in the System Restore Utility
146
Chapter 5 • General Administrative Tasks
www.syngress.com

The “Recommended restore” option is selected by default.The window provides details
regarding the date and time when the restore point was created and which application or update was
installed that initiated the creation of the restore point. If you suspect that the system became unstable
after installing this application, you can choose this option.
The second option in the System Restore window is “Choose a different restore point”. If you
wish to use a restore point created on some other date, choose this option.This option displays the
Choose a restore point page, as shown in Figure 5.7. Select a date and time and click Next.
Follow the instructions to complete the process.
Figure 5.7 Manually Choosing a System Restore Point
You will need to restart the system after the restore process is complete.
Shortcut…
Several Ways to Launch Control Panel Utilities and Services
With Windows Vista, the task of ﬁnding a particular Control Panel utility or a system
service has become very easy with the search box in the Start menu. Typing just a few
letters of the utility name will provide a list of all matching entries in the search results
box, and from there you can select the utility you wish to work with. With Windows
XP and older operating systems you must go through a number of steps to launch a
utility. For example, if you wanted to open the Power Options, you must ﬁrst click
www.syngress.com
General Administrative Tasks • Chapter 5
147
Continued

Start | Control Panel and then click the Power Options icon. In Windows Vista, all you
need to do is click Start and type power in the search box. The link for the Power
Options utility appears in the search results box under the Programs group. Similarly,
if you want to open the Print Management snap-in, just type print in the search box
and press the Enter key. Both the Printers and the Print Management links are shown
in the search results box. Refer to Figure 5.8 for a view of how to perform this trick.
Figure 5.8 Using Shortcuts to Launch Vista Utilities
Printer Management
Microsoft has added a new Print Management snap-in for easy management of printers and print
servers.This snap-in provides a centralized point from which you can manage all printers, fax
machines, and scanners installed on a particular Windows Vista computer. It is particularly helpful if
one of the Vista computers is designated as a print server.You can access locally installed as well as
remote printers from this.
But before we dig deeper into the details of managing printers from the Print Management
snap-in, let us ﬁrst look into some basic tasks regarding installation of local and network printers.The
following sections explain the details of installing, conﬁguring, and managing printers on a Windows
Vista computer.
www.syngress.com
148
Chapter 5 • General Administrative Tasks

Installing a Local Printer
For most new printers that are Plug and Play (PnP)-compatible, PnP technology makes it easy to
detect and install devices in computers.The installation is very straightforward; provided that either
the printer driver is included with Windows Vista or you have a correct driver for the printer that
supports Windows Vista.As of this writing, not many printers had Vista-compatible drivers.The
problem is particularly noticeable with older printers. Not all printer manufacturers have provided
updated drivers for Windows Vista. In some cases, the printer drivers supported in Windows XP will
also be supported in Windows Vista, but there is no guarantee. For the following text, we assume that
you have a printer driver that is supported in Windows Vista.
Automatic Detection and Installation
For installing a PnP printer attached to any of the local ports, such as LPT1 or the USB port, all you
need to do is to turn on the device and let Vista automatically detect the device and install the
appropriate driver for it. In some cases, Windows Vista will launch the Found New Hardware Wizard
because it does not ﬁnd an appropriate driver.You must click the Locate and Install Driver
Software (Recommended) link. Windows will search its driver database and the Windows Update
Web site to locate a driver for the printer. If no suitable driver is found, you will be prompted to
insert the driver disk that came with the printer. Insert the disk and follow further prompts to com-
plete the installation.
Manual Installation
If you prefer to install the printer manually, you can do so from the Printers Control Panel utility.
There are a number of ways to access this utility, including the following:
■
Click Start and type print in the search box. Click the Printers link that appears in the
search results box.
■
Click Start | Control Panel | Hardware and Sound and click the Add a Printer
link under the Printers group.
■
Click Start | Control Panel and click the Printer link under the Hardware and
Sound group.This opens the Printers utility. Right-click the empty space in the details
pane and select Add Printer.
Figure 5.9 shows the Add Printer page.
www.syngress.com
General Administrative Tasks • Chapter 5
149

Figure 5.9 Adding a Non-USB Local Printer
The following explains the steps involved in installing a local printer:
1.
Click Add a local printer in the Add Printer page.The link clearly says that you should
use this option only if the printer is not a USB printer.This is because most USB printers
are PnP-compatible and Windows Vista automatically detects and installs them.
2.
Select the port in the Choose a printer port page.The default is to use an existing port
such as LPT (parallel) or COM (serial). Click Next.
3.
The Install the printer driver page appears. Select the printer manufacturer and printer
model from the lists, as shown in Figure 5.10.
Figure 5.10 Selecting a Printer Make and Model
150
Chapter 5 • General Administrative Tasks
www.syngress.com

4.
If the list does not include your printer or model, you must supply the driver ﬁles. Click
Have Disk.
5.
If you have a driver CD, insert it; or if you have downloaded the driver from the Internet
and saved it, click Browse to locate the correct driver ﬁles. Click Next.
6.
In the Type a Printer Name box, enter a name for the printer.The printer is set as the
default printer automatically. Clear this checkbox if you do not want to set this printer as
the default. Click Next.
7.
The Add Printer Wizard completes the installation and prints a test page.
8.
The newly added printer is now shown in the Printers Control Panel.
Installing a Network Printer
The procedure for installing network printers is a little different from installing locally attached
printers.These printers either are directly connected to a network port or use wireless or Bluetooth
printers. For printers that are connected directly to a network port, such as TCP/IP printers or wire-
less printers, the following steps explain the procedure:
1.
Select Add a Network, Wireless, or a Bluetooth Printer in the Add Printer page.
The wizard starts searching for the printer.
2.
The wizard will display a list of available printers. Select your printer and click Finish.
3.
If your printer is not listed, click The Printer That I Want Isn’t Listed.
4.
The Find a printer by name or TCP/IP address page appears, as shown in 
Figure 5.11.
Figure 5.11 Installing a Network Printer
www.syngress.com
General Administrative Tasks • Chapter 5
151

5.
You can add the printer by browsing the network again, by typing the UNC name of the
printer, or by specifying the TCP/IP address of the printer. For this exercise, we will select
Add a printer using a TCP/IP address or hostname. Click Next.
6.
The Type a printer hostname or IP address page appears, as shown in Figure 5.12.
Figure 5.12 Adding a TCP/IP Port for the Printer 
7.
Select TCP/IP Device in the Device type list.Type the hostname or the IP address of
the printer. Notice that Windows automatically adds the port name. Click Next.
8.
The Add Printer Wizard tries to connect to the speciﬁed printer.You must make sure that
the printer is connected to the network; you have speciﬁed a correct TCP/IP address and
hostname; and the printer is turned on. If the wizard is not able to connect to the speciﬁed
port, the Additional Port Information Required page appears, as shown in Figure 5.13.
Figure 5.13 Additional Port Information for the Network Printer
152
Chapter 5 • General Administrative Tasks
www.syngress.com

9.
Select the type of network adapter installed in the printer in the Device Type drop-down
list.You can also click Custom to specify custom settings for the network printer. Click
Next.
10.
From here onward, the procedure is similar to the one explained previously regarding
manual installation of a local printer.
Conﬁguring Printer Properties
Once the printer is installed, you can conﬁgure its properties, such as updating the driver, setting
printing preferences, and applying security settings, color management, and other advanced properties
from either the Printers utility or the Print Management snap-in. We discuss the Print Management
snap-in a little later in this chapter. In this section, we will use the Printers utility to understand some
of the common administrative tasks associated with printers.
Right-click the installed printer in the Printers utility and select Properties to open the
printer’s Properties pages.The different tabs of the printer properties are as follows:
■
General Displays the printer name, its location (if speciﬁed), and a description. It allows
you to conﬁgure printing preferences and print a test page.
■
Sharing Allows you to share the printer on the network. Printer sharing is explained later
in this section.
■
Ports Displays the port(s) to which the printer is connected.You can add or remove a
speciﬁc port or conﬁgure a port.You can also create printer pools when you have identical
printers and share the printing workload.
■
Advanced Allows you to set the hours the printer will be available, set printer priority,
change the printer driver, set spooling options, and set how the printer handles mismatched
jobs.
■
Color Management For adjusting the printer’s color settings.
■
Security Allows you to conﬁgure permissions for the printer.This is explained later in
this section.
■
Device Settings For setting device-speciﬁc settings, such as assignment of trays for paper
sizes, and so on. Most of these settings are dependent on the type of printer.
■
Services Also dependent on the installed printer. Different printer manufacturers provide
different options in this page. Most of the options relate to alignment and/or cleaning print
heads.
Sharing a Printer
Sharing a locally installed printer or a network printer allows other users on the network to print to
the same printing device through the computer where it is installed.The host computer maintains
the control of the printer and the print jobs. Sharing permissions deﬁne which users have permis-
sions to print or which users have necessary permissions to manage the print jobs.You deﬁne sharing
permissions using the Network and Sharing Center.
www.syngress.com
General Administrative Tasks • Chapter 5
153

The following steps explain how you can share a local printer:
1.
Open the printer properties and click the Sharing tab.You can also right-click the printer
in the Printers utility and select Sharing from the context menu. Figure 5.14 shows the
Sharing tab.
Figure 5.14 Sharing a Printer
2.
Click the Change Sharing Options button. UAC prompts you to click the Continue
button in order to conﬁrm your administrative action.
3.
Click the Share this printer checkbox.The default share name is the original name of
the printer.You can change the share name if you want.
4.
Click the Additional Drivers button to provide additional drivers for different versions of
Windows.
5.
Next, you will need to turn on printer sharing from the Network and Sharing Center.
Click the Network and Sharing Center link. Locate Printer Sharing and click the
down arrow.
6.
Click Turn on Printer Sharing and then click Apply.
7.
Click Continue in the User Account Control prompt. Close the Network and Sharing
Center.
When you share a printer installed on one of the computers in a workgroup, you will also need
to set printer permissions. Printer permissions are explained in the next section. When the printer is
shared, you must make sure the computer is not turned off while other users are using the shared
printer.
www.syngress.com
154
Chapter 5 • General Administrative Tasks

Setting Printer Permissions
Now that you have installed a printer and shared it, you need to set permissions for the printer. Once
again, we will use the Printer Properties window to accomplish this task. But before we go into the
step-wise details, let’s discuss the types of printing permissions available and what actions they allow a
speciﬁc user on the printer.
Windows Vista allows you to set the following permissions on the printer:
■
Print Allows the user to print to the printer.
■
Manage Printers Allows the user to install and uninstall printers and manage documents.
■
Manage Documents Allows the user to manage print documents.
■
Special Permissions Allow you to conﬁgure the explicitly deﬁned permissions for a par-
ticular user or a group, deﬁne ownership and printer ownership, and calculate effective per-
missions for a user or a group.
Here are the steps to conﬁgure printer permissions:
1.
Open the printer properties and click the Security tab, shown in Figure 5.15.
Figure 5.15 Conﬁguring Security for the Printer Through Permissions
2.
To add a user click the Add button and select a user or a group.
3.
Click the checkboxes under Allow or Deny against the permission you wish to grant.
Click Apply.
4.
To conﬁgure special permissions, click the Advanced button.
www.syngress.com
General Administrative Tasks • Chapter 5
155

5.
Highlight a permission entry and use the Add, Edit, or Remove button to reconﬁgure
permissions.
6.
Click the Ownership tab to change the ownership of the printer.
7.
Click the Effective Permissions tab to view the effective permissions for a particular user
or group.
Figure 5.16 shows the Advanced Settings window for printer security properties.
Figure 5.16 Advanced Security Settings for the Printer
When you click the Add button, you can add any security principles to grant or deny access to
the printer.The Select User or Group dialog box allows you to select an individual user or a group of
users and computers.
Working with Print Management
The Print Management snap-in is new to Windows Vista and provides a centralized location for
managing all print servers, printers, and print jobs on local and remote computers.You can use this
snap-in to complete several printer-related administrative tasks, including the following:
■
Automatically detect and add printers on the local network segment to the local print
server.
■
Remove printers from the print server.
■
Automatically install appropriate drivers for detected printers.
www.syngress.com
156
Chapter 5 • General Administrative Tasks

■
Set up printer sharing print queue management.
■
Set up Print Filters to view and manage only those printers that match speciﬁed criteria.
Print Filters help detect problems with printers.
The only requirement is that you must be a member of the Administrators group in order to
perform these actions.Additionally, the print servers must be running Windows 2000 or later oper-
ating systems.You can launch the Print Management snap-in via any of the following methods:
■
Click Start and type print in the search box. Click the Print Management link that
appears in the search results box.
■
Click Start | Run to open the Run dialog box.Type printmanagement.msc and press
Enter.
■
Click Start | Control Panel | System and Maintenance | Administrative Tools |
Print Management.
Figure 5.17 shows the Print Management snap-in.
Figure 5.17 Windows Vista Print Management Snap-In
Now we’ll discuss some of the core printer management tasks and how to perform them using
the Print Management snap-in.
www.syngress.com
General Administrative Tasks • Chapter 5
157

Listing and Removing Printers in Active Directory
Printers published (listed) in Active Directory make it easy for users to locate printers in the entire
enterprise network.At the same time, administrators can easily manage printers from one location.
The following steps explain the procedure:
1.
Open the Print Management snap-in, select a print server, and locate the printer you
want to work with.
2.
Right-click the printer in the center pane or select the printer and click the More
Actions node in the Actions pane.
3.
Click List in Directory.
4.
To remove a printer already listed in Active Directory, follow the same procedure and click
Remove Printer from Directory.
NOTE
The Custom Filters node located in the scope pane of the Print Management snap-in
allows you to conﬁgure ﬁlters to list only the printers that match speciﬁc criteria.
You can also set up a custom Print Filter to view a group of speciﬁc printers. You can
select the printers based on printer names, print drivers, printer status, print queues,
and so on. Once the ﬁlter is conﬁgured, you can select all the printers and list or
remove them simultaneously. 
Managing Device Drivers
The Print Management snap-in makes it easy for administrators to update, install, or uninstall printer
drivers for a single printer or a group of printers simultaneously using Custom Filters.Although you
can manage individual printer drivers from the printer properties, managing a group of printers in an
enterprise becomes easy with the help of the Print Management snap-in.As an administrator, you
will ﬁnd this utility quite helpful for managing a device driver for a group of printers.The following
steps explain the procedure:
1.
Open the Print Management snap-in, select a print server, and click the Drivers node.
2.
Click More Actions in the Actions pane, or just right-click the Drivers node and select
Manage Drivers.The Print Server Properties window opens, as shown in Figure 5.18.
www.syngress.com
158
Chapter 5 • General Administrative Tasks

Figure 5.18 Managing Printer Drivers
3.
Select the printer and use the Add and Remove buttons to install or uninstall the printer
driver. Click Properties to view the properties of the currently installed printer driver.
4.
When you click the Add button, the Add Driver Wizard guides you through the process.
For managing a group of printers in an enterprise network, you can use the Custom Filters node
and create a new ﬁlter based on printer drivers.The custom ﬁlter will allow you to install, update, or
uninstall printer drivers for all printers that match the speciﬁed criteria.
Managing Print Jobs
You can use the Print Management snap-in to manage print queues and print jobs for all the printers
that are added to print servers available in the snap-in.The following is a brief list of some of the
common actions you can perform:
■
View print queues and print jobs on one or more printers
■
Pause or resume print jobs
■
Cancel a particular job or all jobs in a print queue
■
Set the printer ofﬂine
■
Set printing preferences for a printer
The procedure for performing one or more of the given actions is as follows:
1.
Open the Print Management snap-in and select the print server you wish to manage.
2.
Click the Printers node and select the printer in the details pane.
www.syngress.com
General Administrative Tasks • Chapter 5
159

3.
Right-click the printer or click More Actions under the printer name.
4.
Select Pause Printing or Cancel All Jobs as required.
5.
If you want to work with individual print jobs, select Open Printer Queue.This opens
the print queue on the selected printer, as shown in Figure 5.19.
Figure 5.19 Managing Print Jobs with Print Management
6.
Select the particular print job. Click the Document menu and select Pause, Restart, or
Cancel, as required.You can view other details about the document by selecting
Properties.
As with printer drivers, you can use the Print Management console to create custom ﬁlters to
manage print jobs on a group of printers in an enterprise network.
Administer via Remote
Remote Desktop, which was introduced in Windows XP, is a powerful administration tool. It allows
administrators to perform everyday admin jobs while sitting at their desks. In Windows Vista,
Remote Desktop is available only in the Business, Ultimate, and Enterprise editions.You can con-
ﬁgure Vista Home Basic and Home Premium computers for outgoing Remote Desktop connections
only. In this section, we will explain how to set up Windows Vista computers for incoming and out-
going Remote Desktop connections.
Conﬁguring the Remote Desktop Host
The host computer is the one which will allow remote computers to connect to it using the Remote
Desktop connection.You must conﬁgure this computer appropriately in order to accept incoming
connections.The procedure is as follows:
1.
Open the Control Panel utility and click the System and Maintenance link.
2.
Under the System group, click the Allow Remote Desktop link. UAC will prompt
you to conﬁrm your action. Click Continue.
3.
The Remote tab of the System Properties window appears, as shown in Figure 5.20.
4.
Click one of the options from the Remote Desktop portion of the window, as
explained shortly.
www.syngress.com
160
Chapter 5 • General Administrative Tasks

Figure 5.20 Conﬁguring the Remote Desktop Host
The three settings in the Remote Desktop portion of this window are as follows:
■
Don’t allow connections to this computer This option will block all incoming con-
nection attempts.
■
Allow connections from computers running any version of Remote Desktop
(less secure) If you are working in a mixed Windows Vista and Windows XP environ-
ment, this is the option to select.
■
Allow connections only from computers running Remote Desktop with
Network Level Authentication (more secure) Select this option if the computer
trying to connect supports Network Level Authentication.
By default, a Windows Vista computer is conﬁgured not to allow any Remote Desktop connec-
tions. Once you make a selection, click the Select Users button to specify the users who will be
allowed to connect to this computer using Remote Desktop.
To add users, click the Select Users button.The Remote Desktop Users dialog box appears,
as shown in Figure 5.21. Click the Add button to add users or the Remove button to remove any
user who has been previously granted Remote Desktop access.You use the User Accounts link to
add any users who do not already exist on the computer.
www.syngress.com
General Administrative Tasks • Chapter 5
161

Figure 5.21 Remote Desktop Users
Conﬁguring the Remote Desktop Client
Once you have conﬁgured the Remote Desktop host to accept incoming connections, the client
computer must connect to the host using the Remote Desktop Connection dialog box.You can
open this dialog box using the following methods:
■
Click Start | All Programs | Accessories | Remote Desktop Connection.
■
Click Start and type Remote in the search box. Click the Remote Desktop connec-
tion from the list that appears.
The Remote Desktop Connection window appears, as shown in Figure 5.22.There are a lot
more options for conﬁguring the outgoing connection, and we will explain them a little later in this
section.
Figure 5.22 Remote Desktop Connection
Type the name of the remote computer and click Connect.You can click the little down arrow
at the end of the name box and click Browse for More to determine which one is the remote
www.syngress.com
162
Chapter 5 • General Administrative Tasks

computer.The computer name is either the Fully Qualiﬁed Domain Name (FQDN) or the IP
address of the remote host.
To view other options available for conﬁguring the Remote Desktop connection, click the
Options button. Figure 5.23 shows the window that appears.
Figure 5.23 Conﬁguring Outgoing Remote Desktop Connection Settings
Various tabs in this window allow you to completely conﬁgure the connection settings, as sum-
marized in the following list:
■
General You can conﬁgure the outgoing connection and save your settings by using the
Save or Save As button. Click the Open button to open a previously saved connection set-
ting’s RDP ﬁle.
■
Display The Display tab contains options for setting the size for the remote desktop and
setting the number of colors to display. By default, the Display the Connection Bar When
in Full Screen Mode option is checked.
■
Local Resources Settings in this tab allow you to conﬁgure sound from the remote
computer and whether special keyboard commands (such as Alt + Tab and Ctrl + Alt +
Del) will be executed on the local computer or the remote computer.The Local Devices
and Resources section allows you to conﬁgure which devices on the remote computer can
be used.
■
Programs You can specify a particular application to execute when the connection is
established.
■
Experience This tab contains settings that you can conﬁgure for the entire Remote
Desktop session.These depend on the connection speed, and they include desktop back-
ground, font smoothing, desktop composition, menus and window animation, and themes,
among others.
www.syngress.com
General Administrative Tasks • Chapter 5
163

■
Advanced You can use the settings in this tab to conﬁgure how the computer behaves if
the authentication fails.You can also conﬁgure settings for a Terminal Services Gateway
server. By default, the Remote Desktop connection is conﬁgured to Warn Me If
Authentication Fails.You can set it to Always Connect Even If Authentication Fails or Do
Not Connect If Authentication Fails.The Settings button in the Connect From Anywhere
section opens the Terminal Services Gateway Settings window.
Firewall Settings for Remote Desktop Connection
Remote Desktop uses TCP port number 3389 by default. Because Windows Firewall in Windows
XP and Windows Vista blocks this port, you will need to conﬁgure Windows Firewall in order to
allow Remote Desktop connections. Here is the procedure to conﬁgure Firewall settings:
1.
Click Start | Control Panel.
2.
Click the Allow a Program Through Windows Firewall link under the Security
group.
3.
Click Continue in the User Account Control dialog box to conﬁrm your action.
4.
The Windows Firewall Settings page appears, as shown in Figure 5.24.
5.
Click the Remote Desktop checkbox and click OK.
6.
Close the Control Panel.
Figure 5.24 Conﬁguring Windows Firewall to Allow a Remote Desktop
Connection
Another way to access the Windows Firewall Settings page is to right-click the Security Center
icon on the taskbar and select Open Security Center. Click Windows Firewall in the left-hand
panel to open the Windows Firewall page. Click Allow a Program Through Windows Firewall.
www.syngress.com
164
Chapter 5 • General Administrative Tasks

Because Remote Desktop and Remote Assistance both rely on Terminal Services, it is necessary to
open port 3389 on Windows Firewall on both the Remote Desktop host and client to allow incoming
and outgoing connections. If the computers are located behind routers, you will need to conﬁgure the
routers at both ends to open this port. Refer to the documentation of the router for changing these set-
tings. Chapter 9 covers conﬁguring and troubleshooting Windows Vista Firewall in more detail.
Scheduling Tasks and 
Managing Time and Date
The Task Scheduler utility allows you to automate several tasks that you would otherwise perform
manually. Many of the system maintenance tasks are preconﬁgured to run automatically at predeter-
mined times.The Task Scheduler utility is located in the Administrative Tools under the System and
Maintenance group in the Control Panel.You can open this utility in any of the following ways:
■
Click Start and type task in the search box. Click the Task Scheduler link in the results
box.
■
Click the Computer icon on the desktop and select Manage.This opens the Computer
Management console.The Task Scheduler utility is located under the System Tools folder.
■
Click Start | Control Panel | System and Maintenance | Administrative Tools |
Task Scheduler.
The User Account Control dialog box prompts you to conﬁrm your action. Click the Continue
button to open the Task Scheduler utility, which is shown in Figure 5.25.
Figure 5.25 The Task Scheduler Utility in Windows Vista
General Administrative Tasks • Chapter 5
165
www.syngress.com

The Task Scheduler utility has three panes: Scope, Details, and Action.The Scope pane on the left-
hand side shows the Task Scheduler Library, which includes several tasks that are listed under the
Microsoft grouping.The center pane provides an overview of the Task Scheduler, a summary of the
status of scheduled tasks, and a list of active tasks.The right-hand pane is called the Actions pane, and
it’s where you can create basic and advanced tasks, import a task ﬁle, or connect to a remote computer.
Every scheduled task has certain properties associated with it. For example, if you expand the
Windows folder under the Scheduled Tasks Library and click on the System Restore task, the center
pane provides the detailed properties of the task. Refer to Figure 5.26 for a view of the properties for
the selected task.
Figure 5.26 Viewing Properties of Scheduled System Tasks
From this window, you can run the selected task, end it, export it to a ﬁle, or view its properties
in a separate window. If you no longer require the task, you can also delete it. From this window, you
can only view the task properties. In order to change any of the settings, you will need to click the
Properties link in the Action pane.The task properties have the following conﬁgurable tabs:
■
General The name and description of the task and the account used to run the task.
■
Triggers The conditions that are used to trigger the task. For example, a task may be trig-
gered at system startup.
www.syngress.com
166
Chapter 5 • General Administrative Tasks

■
Actions The action that will be performed when the task starts.
■
Conditions The conditions that are used in combination with the trigger that decide
whether the task should start or stop.
■
Settings Additional settings that affect the behavior of the scheduled task.
■
History The history of the task that provides information on dates and times when the
task was started and stopped.
NOTE
The Task Scheduler utility depends on the Task Scheduler service, which is conﬁgured
to start at system startup. In other words, the startup type of the Task Scheduler ser-
vice is automatic. It runs under the Local System account. If you ever suspect that the
scheduled tasks are not being run or have stopped unexpectedly, it is a good idea to
check that this service is running.
Creating Scheduled Tasks
To enable administrators to automate their regular jobs, Windows Vista allows you to create and
schedule two different types of tasks using the Task Scheduler utility: basic and advanced.You create
basic tasks using the Create Basic Task link, which launches a wizard to guide you through the var-
ious steps involved.You create advanced tasks using the Create Task link, in which you need to con-
ﬁgure the task properties.The following sections describe how to create and manage basic and
advanced tasks.
Creating a Basic Task
Creating a basic task is wizard-driven. Basic tasks allow you to conﬁgure only two types of task prop-
erties: triggers and actions. It is the fastest way to create a scheduled task.The following steps explain
how to create a basic task:
1.
Open the Task Scheduler utility using any of the previously mentioned methods.
2.
Click the Create a Basic Task link in the Actions pane. If you are in the Computer
Management console, you can right-click the Task Scheduler node in the left-hand
Scope pane and select Create a Basic Task.This launches the Create Basic Task wizard.
3.
Enter a Name and Description for the task and click Next.
4.
The Task Trigger page appears. Select the frequency of the task as Daily, Weekly, or
Monthly.You can also select whether the task will be triggered by a speciﬁc event, such as
When the Computer Starts, When I log On, or When a Speciﬁc Event is Logged.
Select One Time if you want the task to run only once. Click Next.
www.syngress.com
General Administrative Tasks • Chapter 5
167

5.
The next page depends on what you selected in the Task Trigger page. If you selected
Daily, the next page allows you to Select the Start Date and Time and whether the
task will be run every day or every nth day. For example, you may set the task to recur after
every three days or ﬁve days.
6.
If you selected Weekly in the Task Trigger page, the next page allows you to set the Start
Date and Time as well as the day of the week.You can also set the recurrence of the task
to every week or every nth week. For example, you can set the task to recur every alternate
week.
7.
If you selected Monthly in the Task Trigger page, the next page allows you to set the Start
Date and Time, the names of the months, and the weeks of the month. For example, you
can set the task to recur every second and fourth Friday of March,April, May, June, and so
on. Refer to Figure 5.27, which shows the settings in this page.
Figure 5.27 Conﬁguring the Recurring Schedule for a Basic Task
8.
If you selected One Time in the Task Trigger page, the next page allows you to set the
Start Date and Time.
9.
If you selected When a Speciﬁc Event is Logged, the next page allows you to specify
the Log, Source, and Event ID that will trigger the task.You can check the Event
Viewer snap-in to get a list of event IDs associated with speciﬁc events.
10.
When the Task Trigger schedule is set, the Action page appears, where you will specify the
action that the scheduled task is supposed to perform.This can be Start a Program, Send
an Email, or Display a Message.This is shown in Figure 5.28.
www.syngress.com
168
Chapter 5 • General Administrative Tasks

Figure 5.28 Selecting the Action for the Scheduled Task
11.
If you selected Start a Program, the next page allows you to specify the program that
will be executed. If you selected Send an Email, the next page allows you to type the e-
mail address and full message in the provided box. If you selected Display a Message, the
next page allows you to type the message that will be displayed on the desktop.
12.
The next page is the Summary page that displays a summary of the settings you conﬁg-
ured for the task. Review the information and click Finish to complete the task.
Creating an Advanced Task
Unlike the basic task, which uses a wizard and allows you to conﬁgure only the trigger and action,
the advanced task allows you to conﬁgure many other settings for the scheduled task. Here are the
steps involved in creating an advanced task:
1.
Open the Task Scheduler utility using any of the previously mentioned methods.
2.
Click the Create Task link in the Actions pane. If you are in the Computer Management
console, you can right-click the Task Scheduler node in the Scope pane and select
Create Task.This launches the Create Task window, as shown in Figure 5.29.
3.
Type the Name and Description for the task. Select the user account that the task will
use for executing the task using the Change User or Group button in the Security
options section. Select when the task will be run: Run only when user is logged on or
Run whether user is logged on or not. If you want the task to run with highest privi-
leges, click the Run with highest privileges checkbox.Additionally, if you want the task
to run as a hidden task, click the Hidden checkbox.
www.syngress.com
General Administrative Tasks • Chapter 5
169

Figure 5.29 Creating an Advanced Task
4.
Click the Triggers tab. Click New to launch the New Trigger page. Select the frequency
(One Time, Daily, Weekly, or Monthly) and Start Date and Time for the task in the
Settings section. Make other advanced settings as appropriate.
5.
Click the Actions tab. Click New to launch the New Action page. Select any of the
actions from the drop-down list.You can select to Start a Program, Send an Email, or
Display a Message.
6.
Click the Conditions tab, as shown in Figure 5.30. Specify the conditions in this page.The
task will start and stop only when the speciﬁed condition(s) is true.
7.
Click the Settings tab. Specify any additional settings for the task as appropriate.
8.
Click OK to create the new task.
www.syngress.com
170
Chapter 5 • General Administrative Tasks

Figure 5.30 Specifying Conditions for the Advanced Scheduled Task
Troubleshooting Scheduled Tasks
Scheduled tasks do not always run as expected or as conﬁgured. For example, you may schedule a
one-time backup job to run once at midnight, and when you return to work the next day, you ﬁnd
that the backup did not occur.There may be more than one reason behind the failure of the task to
start.The Task Scheduler in Windows Vista provides an excellent view of all the scheduled tasks con-
ﬁgured on the local computer or a remote computer.
As you may notice from Figure 5.20, the bottommost part of the center pane allows you to get a
complete view of all the conﬁgured properties of a particular task. Even when no task is selected the
Task Status part of the center pane shows a summary of active, running, successful, stopped, and failed
tasks.
To diagnose a problem with a particular task, select the task from the Task Scheduler Library to get
the details of the task.When you click the History tab, you can see the details of the events associated
with the task. Click any of the events and its details are available in the bottom part of the window.
Managing Date and Time
Changing the date and time and the time zone for a Windows Vista computer is as easy as clicking a
few buttons.You can change the date and time of your computer as well as the time zone from the
Date and Time Control Panel utility, which you can access by using any of the following methods:
■
Click Start and type date in the search box. Click the Date and Time link in the search
box.
■
Click Start | Control Panel | Clock, Language and Region | Date and Time.
■
Right-click the displayed time on the taskbar and select Adjust Date/Time.
www.syngress.com
General Administrative Tasks • Chapter 5
171

All of these actions open the Date and Time Control Panel utility, as shown in Figure 5.31.
Figure 5.31 Adjusting Date and Time and Time Zone Settings
The Date and Time window shows the current date and time and the currently conﬁgured time
zone. When you click the Change date and time button, UAC prompts you to click the
Continue button to conﬁrm your administrative action. Conﬁgure the new date and time and click
OK to save your settings.You can change the time zone in a similar way.
Windows Vista allows you to conﬁgure up to two additional clocks on your computer. For
example, if you are working in the United States and want to view the current time in another
country, such as India, you can conﬁgure that time as an additional clock.You can do this using the
Additional Clocks tab in the Date and Time window.The additional clock is shown when you move
your mouse over the displayed time in the taskbar.
Daylight Saving Time
Daylight Saving Time (DST) for the United States and Canada is already set for you when you select
the time zone during installation.You can change the DST settings using the Change time zone
button. DST start and end dates were recently changed in the United States and in some provinces of
Canada. If you feel that the preconﬁgured time is not applicable in your region, you can use the
Change time zone button to conﬁgure the time in your region.The Remind me one week
before this change occurs checkbox will remind you when the DST settings will automatically
change the time on your computer.
If the DST settings do not apply to your region, click the Change time zone button.The Time
Zone Settings dialog box appears, as shown in Figure 5.32. Use the Time zone drop-down box to
select the correct time zone for your region. Clear the Automatically adjust clock for Daylight
Saving Time box. Click OK to save your settings.
www.syngress.com
172
Chapter 5 • General Administrative Tasks

Figure 5.32 Changing Time Zone and DST Settings
Synchronizing with the Internet Time Server
You can set up a Windows Vista computer to conﬁgure the date and time with an Internet time
server.This is very helpful when you want to make sure the date and time on all computers in an
enterprise network are accurate and in sync with an Internet time server. When conﬁgured, the com-
puters will synchronize their date and time with an Internet time server once a week.The computers
must be connected to the Internet when the synchronization is scheduled.
To set up a Windows Vista computer with an Internet time server, complete the following steps:
1.
Open the Date and Time window using any of the methods previously explained.
2.
Click the Internet Time tab.The current settings, such as the next synchronization date
and time, are displayed, as shown in Figure 5.33. If there was an error during the previous
synchronization, it is also displayed.
Figure 5.33 Internet Time Settings
www.syngress.com
General Administrative Tasks • Chapter 5
173

3.
To reconﬁgure the current settings, click the Change settings button.
4.
Click Continue in the User Account Control dialog box to conﬁrm your action.
5.
The Conﬁgure Internet time settings dialog box appears, as shown in Figure 5.34.
Figure 5.34 Changing the Internet Time Settings
6.
Make sure the Synchronize with an Internet time server box is checked. Clear this
box if you do not want to use the Internet time server feature.
7.
Select the time server from the Server drop-down box. Note that you can change only the
name of the time server, and not the synchronization schedule.
8.
Click the Update now button if you want to immediately update the date and time on
your computer.
9.
Click OK twice to save your settings and close all of the Date and Time windows.
Working with Power Plans
Power plans in Windows Vista control how the computer system as a whole, its monitor, or the hard
disk conserves power. Power conservation puts these components in standby, sleep, and hibernate
modes.The operating system includes three basic preconﬁgured power plans, as follows:
■
Balanced This is the default power plan used on Vista computers. It helps to save power
by moderately managing power options.
■
Power Saver The Power Saver plan helps conserve power by quickly turning off the
computer, the monitor, and the hard disks when not in use.
■
High Performance The High Performance power plan is ﬁne-tuned for performance
and uses maximum power.
The Power Options dialog box is shown in Figure 5.35.
174
Chapter 5 • General Administrative Tasks
www.syngress.com

Figure 5.35 Power Options in Windows Vista
You can use any of the standard power plans in its preconﬁgured settings or select one of them
and further ﬁne-tune it depending on your requirements.
Changing Standard Power Plan Settings
Each power plan has two settings: basic and advanced.The following procedure shows the steps that
you will need to perform in order to change the settings in any of the standard power plans:
1.
Click Start | Control Panel | System and Maintenance | Power Options.As
always, you can also open the Power Options utility by simply typing power in the Start
menu search box and clicking the Power Options link.
2.
Select one of the power plans and click the Change Plan Settings link.
3.
The Edit Plan Settings window appears, as shown in Figure 5.36.
4.
Select the number of minutes in the Turn off the display box using the drop-down
button.This can be anywhere between 1 minute and 5 hours. Select Never if you do not
want to turn off the monitor.
5.
Select the number of minutes in the Put the computer to sleep box using the drop-
down button.
www.syngress.com
General Administrative Tasks • Chapter 5
175

Figure 5.36 Modifying Settings for Standard Power Plans
If you want to change the advanced power settings, click the Change advanced power set-
tings link.This opens the Advanced settings window, as shown in Figure 5.37.You can select any
of the components and change its settings for a speciﬁc power plan.
Figure 5.37 Conﬁguring Advanced Settings for a Standard Power Plan
www.syngress.com
176
Chapter 5 • General Administrative Tasks

For example, if you want to change when the hard disk is turned off, click the + sign next to
Hard disk and use the up or down arrow in the Settings (Minutes) box to select the number of
minutes.
If at any point in time, you feel you have improperly conﬁgured a setting, click Restore plan
defaults to go back to the default settings for the selected plan.
Power Buttons and 
Password Protection on Wakeup
In Windows Vista, you can conﬁgure how the computer’s power button works.You can also con-
ﬁgure a password when the computer wakes from sleep or hibernate mode.These features help you
determine what the computer’s power button does or what happens when you press the sleep button
on a laptop.
The four options available for the power button are as follows:
■
Do Nothing
■
Sleep
■
Hibernate
■
Shut Down
The following explains how to conﬁgure these power settings:
1.
Open the Power Options Control Panel utility.
2.
Click Require a password on wakeup or Choose what the power button does.
Both of these links open the Deﬁne power button and turn on password protection
window, as shown in Figure 5.38.
3.
Modify the settings in the When I press the power button box using the drop-down
menu.The default is Shut down.
4.
Select the Require a password on wakeup or Don’t require a password radio
button.The Require a password on wakeup radio button is the default.
5.
Click Save Changes.
www.syngress.com
General Administrative Tasks • Chapter 5
177

Figure 5.38 Conﬁguring the Power Button and Password Protection on Wakeup
NOTE
The settings you make to the power button and password protection on wakeup
apply to all standard and custom power plans available in the Power Options utility.
By default, all power plans use these settings:
Shut down the computer when the Power Button is pressed.
Password is required when the system wakes up from sleep.
Creating a Custom Power Plan
Just in case none of the standard power plans ﬁts your requirements, you can create your own custom
power plan. Here’s how to do this:
1.
Open the Power Options Control Panel utility.
2.
Click the Create a power plan link in the left-hand panel.This opens the Create a
Power Plan window.
3.
Select one of the standard power plans that closely matches your requirements.
4.
Type a Name for your custom power plan and click Next.
5.
Conﬁgure the basic and advanced settings.The procedure is similar to modifying the stan-
dard power plan.
6.
Click Create to save the new power plan.
www.syngress.com
178
Chapter 5 • General Administrative Tasks

7.
The custom power plan now appears in the Power Options Control Panel utility.You can
again change its settings when required following the same procedure.
Managing Services
Every operating system depends on essential system services.These services help the operating system
to run in the way it should.Although many services start automatically when the system is started,
some services remain stopped until an application requires them.Administrators often have to start,
stop, or restart services when troubleshooting problems with operating systems or applications.You
manage system services using the Services snap-in in the Computer Management console.You can
access the Services snap-in any of the following ways:
■
Click Start and type Services in the search box (even if you type serv the link will
appear). Click the Services link that appears in the search results box.
■
Right-click the Computer icon on the desktop and select Manage.This opens the
Computer Management console.The Services snap-in is located under the Services and
Applications folder.
■
Click Start | Control Panel and click the link for System and Maintenance. Click
Administrative Tools and click Services.
You will need to click the Continue button in the User Account Control dialog box to conﬁrm
your action. Figure 5.39 shows the Services snap-in.
Figure 5.39 The Services Snap-in in Windows Vista
General Administrative Tasks • Chapter 5
179
www.syngress.com

The Services window shows the name and description of all system services, along with their
status, startup type, and Log On As information.The Log On As information comprises the user
account that a particular service uses to start.You can scroll down the window to ﬁnd a particular
service that might be causing trouble.You can right-click the service and select Stop or Restart
from the context menu. Click Properties to conﬁgure the advanced properties of any service, as
explained in the following section.
If you need to manage services on a remote computer, right-click the Services node in the left-
hand Scope panel and click Connect to another computer.Type the name or IP address of the
remote computer or click the Browse button to locate the remote computer. In addition to Remote
Desktop, the Services snap-in is another helpful tool that you can use to manage services on a remote
computer.
Conﬁguring Service Properties
Once you are familiar with basic tasks related to managing services, such as starting, stopping,
restarting, and pausing the service, you may want to conﬁgure the advanced properties of a service.
Figure 5.40 shows the Properties window of a service.
Figure 5.40 Conﬁguring Properties of a Service
Here are descriptions of the different tabs in this window:
■
General The General tab shows the name and description of the service as well as its
startup type.You can conﬁgure the service startup type as Automatic,Automatic (Delayed
Start), Manual, or Disabled.You can also stop a running service or start a manual service.
www.syngress.com
180
Chapter 5 • General Administrative Tasks

Some services allow you to pause and resume them. Figure 5.39 shows the General tab of
the DNS service properties window.
■
Log On This tab shows the account that the service uses. Most services use the Local
System Account, but some others use the Network Account.You can also enable or disable
any service from a particular hardware proﬁle.
■
Recovery The Recovery tab allows you to conﬁgure the actions the system should take
on ﬁrst, second, and third failures of a service. Conﬁguring recovery options is discussed
later in this section.
■
Dependencies The Dependencies tab shows the services that depend on the selected ser-
vice and the services on which the selected service depends.
Changing the Startup Type of a Service
Troubleshooting system problems sometimes requires administrators to enable or disable a service or
change its startup behavior. If you suspect that a particular service is stopping the system from starting
properly, you may change the startup type of that service from automatic to manual. Changing the
startup type of some nonessential services from automatic to manual or disabling them saves system
resources and speeds up system startup time.
To change the startup type of a service, follow these steps:
1.
Open the Services snap-in using any of the previously given methods.
2.
Locate the service, right-click it, and select Properties (refer back to Figure 5.40 for a
look at the Properties window).
3.
Click the Startup Type down arrow button and select Automatic, Automatic (Delayed
Start), Manual, or Disabled, as required.
4.
Click OK to close the Services properties window.
5.
Close the Services snap-in.
SOME INDEPENDENT ADVICE
Windows Vista comes with a number of system services. Several other services are
added to the system when you install applications or other third-party utilities. When
you keep on adding applications and programs to the system, system performance
eventually starts to degrade. This is because a host of services must start with system
startup and remain active as long as the system is powered on.
To improve system performance, you must thoroughly study the services and try
to ﬁnd out what services are not actually required. Sometimes if we uninstall a
poorly written application, its related service remains installed. You must remove or
disable all nonessential services from the system. You must also be careful to check
the dependencies of the service you want to remove to make sure that disabling a
service does not affect other applications.
www.syngress.com
General Administrative Tasks • Chapter 5
181

Conﬁguring Service Recovery Options
Services do cause problems during normal system operation.An essential service might stop unex-
pectedly and cause a cascading effect on some other services that depend on it.The Recovery tab in
the Service properties window allows you to conﬁgure how the system behaves when a particular
service fails. Figure 5.41 shows the Recovery tab of the DNS service.
Figure 5.41 Conﬁguring Recovery Options for Services
By default, a system will restart the service on the ﬁrst and second failures and will take no
action on subsequent failures.You can conﬁgure the recovery options as follows:
■
Take No Action The system does not take any action on failure of a service.
■
Restart the Service The system attempts to restart the service.
■
Run a Program You can specify a program that the system will execute when it detects
that the service has failed.You can specify a batch ﬁle or a script in the Run Program box,
which is enabled when this option is selected. Specify the full UNC path of the program.
■
Restart the Computer The computer is restarted.
You can reset the service failure counter using the following two options:
■
Reset Fail Count After This option speciﬁes that the failure counter will be reset after
the given number of days.
■
Restart Service After This option speciﬁes the number of minutes the system will wait
before restarting the service.
When you are done, click OK to save your conﬁguration settings.
www.syngress.com
182
Chapter 5 • General Administrative Tasks

Summary
In this chapter, we explored several different administrative tasks that you will need to accomplish
using the features of Windows Vista.The Backup and Restore Center and the Backup Status and
Conﬁguration utility allow you to back up system and data ﬁles as well as schedule your backup jobs.
The System Restore utility is also a part of Windows Backup and is helpful when the system
becomes unstable when you update a device driver or apply some patch to an application.The Print
Management snap-in is new in Windows Vista and provides a centralized location to manage enter-
prise-wide printers, drivers, and print jobs.
Remote administration is not new to Windows Vista. It was available in Windows XP desktops
also.This feature is helpful in remotely administering Windows Vista, Windows XP, and Windows
Server 2003 computers. We discussed the Task Scheduler utility that helps in scheduling recurring
administrative tasks.You can view scheduled tasks, create new tasks, as well as diagnose problems with
tasks using this utility.The Task Scheduler is closely associated with system time and date, and we dis-
cussed how to change the time and date of the system as well.
Windows Vista come equipped with three preconﬁgured power plans: Balanced, Power Saver,
and High Performance, each of which is conﬁgured to optimize power used by system components
such as the hard disk and the monitor.You can customize any of these plans to ﬁt your needs.
Additionally, you can conﬁgure the power button of your computer as well as the sleep mode. Finally,
we discussed the Services snap-in, which is used to view the status, conﬁgure service recovery
options, and set the service account.
By now, you should have a better idea of how different administration tools and services in
Windows Vista work and how you can conﬁgure different settings to customize the way your Vista
desktop works. One of the most appealing features of Windows Vista is the search box in the Start
menu. Use the search box more often to launch programs or ﬁnd ﬁle or folders.
Solutions Fast Track
Backup and Recovery

You can perform the backup and recovery functions in Windows Vista from the Backup
and Recovery Center utility in the System and Maintenance group in the Control Panel.

You can schedule backup jobs to run at predetermined times.You also can use the Backup
Status and Conﬁguration utility to view scheduled backup jobs and change their
properties.

The Complete PC Backup is helpful in taking a complete image of the system
immediately after you install the operating system.You can use this backup image to restore
the system in the event of a crash.
www.syngress.com
General Administrative Tasks • Chapter 5
183

Printer Management

You can install, conﬁgure, and manage printers on the local Vista computer using the
Printers utility in the Control Panel. In order to manage multiple printers installed on
several computers, you must use the Print Management snap-in.

Most new printers are PnP and are automatically detected and installed in Windows Vista.
You can still use the Printers utility to add a non-USB printer manually.

The Print Management snap-in allows you to install or update device drivers and manage
print queues simultaneously on multiple printers.You do this by creating custom Print
Filters and displaying only those printers that you wish to work with.
Administer via Remote

Remote Desktop helps administrators perform administrative tasks on remote computers
without having to physically be present.

Both the host computer as well as the client computer must be conﬁgured to allow a
Remote Desktop connection.You conﬁgure the Remote Desktop host through the
Remote tab of the System properties, and you conﬁgure the remote client from the
Remote Desktop Connection link in the Accessories folder.

Windows Firewall must also be conﬁgured to allow Remote Desktop connection on both
the host and the client. Remote Desktop is dependent on Terminal Services, which uses
TCP port 3389.
Scheduling Tasks and Managing Time and Date

The Task Scheduler snap-in allows you to centrally manage scheduled tasks on the local
computer as well as on a remote computer.This utility is dependent on the Task Scheduler
service, which starts automatically on system startup.

You can create two types of tasks from the Task Scheduler snap-in: basic and advanced.You
can create the basic tasks quickly, as you only have to conﬁgure triggers and actions.The
advanced tasks allow you to conﬁgure triggers and actions, set conditions, and provide
additional settings.

You can change the time and date on the system by launching the Date and Time window
either from the taskbar or from the System and Maintenance group in the Control Panel.
Windows Vista allows you to conﬁgure time zones in additional to the primary time zone.
Working with Power Plans

Windows Vista offers three preconﬁgured power plans: Balanced, Power Saver, and High
Performance.You can customize each plan to ﬁt individual needs.
www.syngress.com
184
Chapter 5 • General Administrative Tasks


You use the Power Options Control Panel utility to manage power saving options on the
computer.You can conﬁgure when to turn off the display, when the computer will go into
sleep mode, and what the computer does when you press the power button.

If your computer has security requirements, you can conﬁgure a password when it wakes
up from sleep mode.
Managing Services

The Services utility allows you to view the status of services.You can select a service and
view the status of that service as well as start, stop, pause, and resume a service.

You can disable nonessential services using the Services utility.You can conﬁgure the
service startup type as Automatic,Automatic (Delayed Start), Manual, or Disabled.

The properties pages of a particular service allow you to view the service dependencies,
conﬁgure the service recovery options, and choose the account service uses to run.
Q: Why can’t I select individual ﬁles and folders in the Vista Backup and Restore Center?
A: The Backup and Restore Center is presented as an improved utility in Windows Vista. It now
includes a new feature known as Complete PC Backup. But believe it or not, some of the very
useful features, such as the selection of individual ﬁles and folders, are missing, and the new inter-
face looks very annoying. Hopefully, Microsoft will soon provide a workaround for this problem.
Q: I have installed Windows Vista on a Pentium 4 computer with 1 GB of RAM, a DVD drive, and
a 250 GB hard disk. My hard disk has two partitions: the ﬁrst is a 100 GB basic disk and the
second is a 150 GB dynamic disk. Why can I not perform a Complete PC Backup on my
desktop?
A: Unfortunately, the Complete PC Backup will not work if you have a mix of basic and dynamic
disks.All your disks must be basic disks in order to take advantage of this feature.
Q: I am trying to make a Remote Desktop connection to a Windows 2000 Professional desktop,
but the connection fails. What could be the reason?
www.syngress.com
General Administrative Tasks • Chapter 5
185
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

A: Remote Desktop is supported only on Windows Vista, Windows XP, and Windows Server 2003.
You cannot connect to desktops or servers that are running Windows 2000 or older operating
systems.
Q: I have conﬁgured both of my home computers to allow Remote Desktop but still I am not able
to connect from one computer to another. What could be the reason?
A: Windows Firewall is probably blocking the connection attempts.You must conﬁgure Windows
Firewall to allow Remote Desktop connections on both computers. Open the Windows Firewall
utility and click the Allow a Program Through Firewall link. Click the Continue button in
the User Account Control dialog box.This opens the Windows Firewall Settings page. Scroll
down and click the Remote Desktop checkbox. Click OK to save your settings.
Q: None of the Power Plans in Windows Vista suits my notebook computer. Is there a way I can
modify one of these plans or create a new power plan?
A: Yes.You can create a custom power plan depending on your requirements.All you need to do is
click the Create a Power Plan link in the Power Options utility. Select the plan that is close
to your requirements, type a name for it, and click Next. Choose the Turn off Display and
Put the Computer to Sleep timings and click Create.You are done!
Q: I want to manage printers installed on another computer. How is this possible?
A: First, make sure you are a member of the Administrators group. Open the Print Management
snap-in. Right-click the Print Management node and select Add/Remove Servers. In the
Add Servers dialog box, type a name for the computer or click Browse to locate the computer
where the printers are installed. Click Add to List and click OK.The remote computer will be
listed in the Print Management snap-in under the Print Servers Group.
Q: There are eight identical printers in our ofﬁce. Is it possible to cancel all jobs running on all
these printers simultaneously?
A: Yes.The Print Management snap-in allows you to create custom Print Filters depending on spe-
ciﬁc criteria.You can use this ﬁlter to display all identical printers. Select all printers simultane-
ously and use the More Actions link to cancel all documents.
www.syngress.com
186
Chapter 5 • General Administrative Tasks

187
Managing 
Local Networking
Essentials
Solutions in this chapter:
■
A New Generation of TCP/IP
■
Conﬁguring TCP/IP in Vista
■
The Network and Sharing Center
■
The Network Map
■
Network Access Protection
Chapter 6
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
Successfully connecting a PC to a network is perhaps an administrator’s most important task.
Therefore, knowing how to manage wired network connectivity is essential. In this chapter, we will
review and guide you through the steps of successfully connecting a PC to a network. Connecting to
a network requires an understanding of services such as domain name system (DNS) and the
Dynamic Host Conﬁguration Protocol (DHCP); as such, in addition to discussing these services, we
will also take you step by step through the tasks of DNS and DHCP conﬁguration.
A New Generation of TCP/IP
In the 1990s, we kept hearing about the upcoming arrival of IP Next Generation (IPng). In 2007, IPng
became IPNow! That’s right;Windows Vista natively supports IPv6, and it’s the ﬁrst Microsoft operating
system to do so.You’re probably thinking that XP supported IPv6; although that’s true, XP did not fully
support the IPv6 standard.Windows Vista comes right out of the box supporting it. IPv6 offers
numerous beneﬁts for users, administrators, developers, and Internet service providers (ISPs).
Why the push for IPv6? One of the biggest reasons is IPv4’s limited address space. IPv4 uses a 32-
bit address space, whereas IPv6 uses a 128-bit space. Other issues with IPv4 include security, which is
not natively built in.Yes, you can use IPSec, but these implementations are usually vendor-speciﬁc.
Also, IPv4 does not natively support Quality of Service (QoS).To alleviate these shortcomings,
Request for Comments (RFC) 2460 (www.faqs.org/rfcs/rfc2460.html) was created and deﬁnes IPv6.
This does not mean Windows Vista no longer supports IPv4; it does support IPv4, just like the
previous versions of Windows have. However, Microsoft believes IPv6 will receive greater adoption
during the life cycle of Windows Vista than it ever has before.
IPv6 and Dual Layer 
As we already discussed, shortages in public Internet Protocol (IP) addresses, a lack of built-in secu-
rity, and a lack of native QoS support are just some of the reasons IPv4 will eventually go by the
wayside.Administrators need to understand IPv6 and how it works before leaving the world of IPv4
for good. Here is a list of problems that IPv6 solves:
■
Increase in address space The theoretical address space increases from 4.3 x 109 with
IPv4 to 3.4 x 1038 with IPv6.
■
Hierarchical addressing IPv6 was designed to be hierarchical rather than ﬂat, as IPv4
was.This creates smaller routing tables for IPv6 routers, therefore making them more efﬁ-
cient than their IPv4 brethren.
■
Enhanced support for QoS IPv6 includes a Trafﬁc Class ﬁled in the header which spec-
iﬁes how trafﬁc should be handled, and a new Flow Label ﬁeld in the header that allows
routers to identify packets that belong to a trafﬁc ﬂow and handle them appropriately.
■
Native IPSec support IPv6 requires IPSec support, thereby automatically creating end-
to-end security.
www.syngress.com
188
Chapter 6 • Managing Local Networking Essentials

Overview of IPv6 Addressing
We already know that IPv6 uses a 128-bit address scheme. We haven’t mentioned that IPv6 addresses
are hexadecimal. For instance, an IPv6 address might look like this:
2311:DC8:2FB8:0000:0000:0000:00C2:8B4D
with each block of four-digit numbers representing a 16-bit binary number.Thus, the eight blocks
equal 128 bits (8 ? 16).Although that notation is large, we can shorten it a bit. Because our address
has blocks with leading zeros, we can shorten it by using double colons (::) for those blocks. Using
this notation, the preceding address would now look like this:
2311:DC8:2FB8::C2:8B4D
Windows Vista Support for IPv6
As you already know, Windows Vista is the ﬁrst Microsoft operating system to natively support IPv6.
Vista supports the following:
■
IPSec Both Windows Vista and the upcoming Longhorn Server IPSec support are the
same in IPv4 and IPv6.This includes support for Internet Key Exchange (IKE) and well as
128-, 192-, and 256-bit Advanced Encryption Standard (AES) encryption.
■
Link-Local Multicast Name Resolution (LLMNR) In IPv6, there are a number of
different classiﬁcations for addresses. Global unique addresses are one example, and they are
analogous to public IP addresses in IPv4. Rather than force network administrators to rely
only on public/private classiﬁcation, IPv6 includes multiple types of local-use addresses that
you can use under various circumstances. Site-local addresses correspond most closely to
private IP addresses under IPv4; you cannot reach them outside a private site and IPv6 type
routers do not forward them. IPv6 also deﬁnes link-local addresses, which nodes on a single
network that are not separated by a router can use. LLMNR allows link-local addresses on
a single subnet to resolve each other’s names even without the use of DNS. It does this by
sending a name resolution query to a multicast address to which any LLMNR-capable
system will respond.
■
IPv6 over PPP The Windows Vista remote access client allows the conﬁguration of a
Point-to-Point (PPP) connection using IPv6, as well as providing support for creating
L2TP-based virtual private network (VPN) connections over IPv6.
■
GUI conﬁguration With both Windows XP and Windows Server 2003, you can con-
ﬁgure IPv6 only from the command line using netsh. Windows Vista allows you to con-
ﬁgure IPv6 settings through the properties sheet of a network connection in the Network
and Sharing Center.
Name Resolution
Just like IPv4, DNS is the fundamental method of name resolution on IPv6 networks.With IPv4 net-
works, name servers use host (A) records to resolve domain name queries. In IPv6, name resolution
www.syngress.com
Managing Local Networking Essentials • Chapter 6
189

works basically the same way. Host records for IPv6 hosts are known as AAAA (quad-A) records, and
instead of in-addr-arpa being used for reverse lookups, in IPv6 its ip6.arpa.
Windows Server 2003 does support dynamically registering both A and AAAA records for
Windows Vista systems. When a Windows Vista system starts up on a network, the DNS client ser-
vice will try to register the following records to the DNS server:
■
A records for any IPv4 addresses assigned to all interfaces conﬁgured with the address of a
DNS server
■
AAAA records for any IPv6 addresses assigned to all interfaces conﬁgured with the address
of a DNS server
■
Pointer records (PTRs) for all IPv4 addresses assigned to all interfaces conﬁgured with the
address of a DNS server
As we just mentioned, Windows Server 2003 does support dynamically registering AAAA
records. What Windows Server 2003 does not do is to listen for DNS trafﬁc sent over IPv6. So, for
Windows Server 2003 to dynamically register IPv6 names and listen for lookups, you conﬁgure the
server using this command:
dnscmd /conﬁg/EnableIPv6 1
Afterward, you must conﬁgure each Windows Vista system with the unicast IPv6 addresses of
your DNS server(s) using this command:
netsh interface ipv6 add dns interface=NameOrIndex address=IPv6Address
index=PreferenceLevel
DHCPv6
Windows Vista includes a DHCPv6 client.The client is enabled by default, but only attempts
DHCPv6-based conﬁguration when indicated by the Managed Address Conﬁguration ﬂag (M ﬂag)
and the Other Stateful Conﬁguration ﬂag (O ﬂag) in the received Router Advertisement message.
The M ﬂag, when set, instructs the host to use a stateful address conﬁguration protocol to obtain a
stateful address.The M ﬂag is also known as DHCPv6 stateful.The O ﬂag instructs the host to use a
stateful address conﬁguration protocol to obtain conﬁguration settings. In order to use DHCPv6, you
must conﬁgure IPv6 routers to set these two ﬂags at their appropriate values and then conﬁgure
DHCPv6 servers and relay agents to service each IPv6 subnet.
It is possible for the M ﬂag to be cleared and the O ﬂag to be set. In this situation, a DHCPv6
host does not use DHCPv6 to obtain addresses, but to obtain conﬁguration settings.This is known as
DHCPv6 stateless. When either ﬂag is set, a DHCPv6-capable system attempts to discover a DHCPv6
server to obtain address or conﬁguration settings with a DHCPv6 message exchange.
What Is Dual Layer Architecture?
Microsoft completely reengineered the Transmission Control Protocol/Internet Protocol (TCP/IP) in
Windows Vista to support dual-layer architecture. Previously, XP and Windows Server 2003 sup-
ported dual-stack architecture, meaning that both IPv4 and IPv6 had their own Transport and
Framing layers. Now Windows Vista supports dual-layer architecture, meaning that both IPv6 and
www.syngress.com
190
Chapter 6 • Managing Local Networking Essentials

IPv4 are supported by one driver (tcpip.sys) and that both protocols share a common Transport and
Framing layer.This allows developers to write applications that can take advantage of both IPv6 and
IPv4, and it allows network administrators to use the Windows Firewall and IPSec to control the
trafﬁc of both simultaneously.
NOTE
To learn more about IPv6 and Microsoft’s implementation, download and read the
white paper at www.microsoft.com/technet/network/ipv6/introipv6.mspx. 
Conﬁguring TCP/IP in Vista
Now that you have a better understanding of TCP/IP and the changes Vista brings, you may be
wondering how you conﬁgure your system for it.The good news is that for environments that use
DHCP, you won’t need to do a thing. By default, Windows Vista is set up to use DHCP. Only when
setting up static addresses do you need to be concerned with conﬁguring TCP/IP manually.The two
methods you can use to manually conﬁgure TCP/IP (IPv4 or IPv6) are:
■
User interface
■
netsh command
How to Conﬁgure TCP/IPv4 in Vista
You assign IPv4 addresses to a Vista machine in three ways:
■
Manually The user or administrator assigns a static IP address to the system.
■
DHCP  By being a DHCP client, Vista can communicate to a DHCP server and request a
valid IP address and other settings that are speciﬁc to the network (e.g., Default Gateway,
DNS, the Windows Internet Name Service [WINS], etc.).
■
Automatic Private IP Addressing (APIPA) This randomly assigns the system an
address from the range 169.254.0.0–169.254.255.255 with a subnet mask of 255.255.255.0.
By default,Windows Vista will attempt to ﬁrst communicate to a DHCP server; if it can’t ﬁnd
one,APIPA will assign an address to the system.Administrators and users can manually conﬁgure static
IP addresses to their systems. In Vista, you do this more or less as you did in previous versions of
Windows.The difference is in how to get there. In the following example, we will be going through
the user interface to set up our system with a static IPv4 address.Table 6.1 lists our conﬁguration.
www.syngress.com
Managing Local Networking Essentials • Chapter 6
191

Table 6.1 TCP/IPv4 Parameters for Our Example
Setting
Parameter
IP address 
192.168.1.102
Subnet mask
255.255.255.0
Default gateway 
192.168.1.1
Preferred DNS server
192.168.1.1
First, we must get to the Network and Sharing Center, which you will read more about in
the next section.To get there click Start | Network | Network and Sharing Center, as shown
in Figure 6.1.You’ll then come to the Network and Sharing Center, which is shown later in this
chapter, in Figure 6.10.
Figure 6.1 Selecting the Network and Sharing Center
Under Tasks, select Manage network connections. On the resulting Network Connections
screen, similar to the one in Figure 6.2, just right-click the Local Area Connection you want to
conﬁgure and select Properties. If you are not logged in as an administrator you will need to pro-
vide administrator credentials at the User Account Control (UAC) prompt to go further.
www.syngress.com
192
Chapter 6 • Managing Local Networking Essentials

Figure 6.2 Network Connections
On the Local Area Connection Properties screen, shown in Figure 6.3, highlight Internet
Protocol Version 4 (TCP/IPv4) and click Properties.
Figure 6.3 Local Area Connection Properties
Next you’ll see the Internet Protocol Version 4 (TCP/IPv4) Properties page. Select the
Use the following IP address: option. For IP address, enter 192.168.1.102; for Subnet mask,
enter 255.255.255.0; for Default gateway, enter 192.168.1.1; and for Preferred DNS server,
enter 192.168.1.1. Now your screen should look like Figure 6.4. Click OK, and that’s it; you have
conﬁgured a static IPv4 address for your system.
www.syngress.com
Managing Local Networking Essentials • Chapter 6
193

Figure 6.4 IPv4 Properties
If you need to conﬁgure your system for DHCP, simply select Obtain an IP address auto-
matically on the Internet Protocol Version 4 (TCP/IPv4) Properties page.
How to Conﬁgure TCP/IPv6 in Vista
We’ve just discussed how to set up IPv4 in Windows Vista using the interface. On IPv6 networks,
routers are usually the only devices that are assigned static addresses. IPv6 addresses are usually
assigned automatically via a process called address auto-conﬁguration.You can apply auto-conﬁguration
in three ways:
■
Stateless  Based on receiving ICMPv6 router advertisements.
■
Stateful Uses DHCPv6 to obtain address and other conﬁguration settings from a
DHCPv6 server.
■
Both
Windows Vista allows you to conﬁgure static IPv6 addresses, though. Just like IPv4, you can set
up IPv6 using the user interface or the netsh command. In this example, we will set up IPv6 using
the netsh command.Table 6.2 lists the parameters we’ll use for setting up IPv6 in Vista.
www.syngress.com
194
Chapter 6 • Managing Local Networking Essentials

Table 6.2 TCP/IPv6 Parameters for Our Example
Setting
Parameter
IP address
2001:DB8::8:800:20C4:0
Default gateway
2001:DB8:0:2F3B:2AA:FF:FE28:9C5A
DNS server
2001:DB8:0:1::1
1.
First, open the command prompt by clicking Start | All Programs | Accessories, then
right-clicking on Command Prompt and selecting Run as administrator. UAC will
either prompt you for administrator credentials or, if you are an administrator, ask you
whether you want to continue. We obviously want to continue.
2.
To add the IPv6 address to the interface named Local Area Connection type the fol-
lowing command and then press Enter, as shown in Figure 6.5:
netsh interface ipv6 add address “Local Area Connection” 2001:DB8::8:800:20C4:0 
Figure 6.5 Conﬁguring IPv6 with netsh
3.
Now you need to conﬁgure your default gateway.To do so type the following command,
and then press Enter:
netsh interface ipv6 add route  ::/0 “Local Area Connection”
2001:DB8:0:2F3B:2AA:FF:FE28:9C5A 
Once the route has been added, you’ll see an Ok in the command prompt, as shown in
Figure 6.6.
www.syngress.com
Managing Local Networking Essentials • Chapter 6
195

Figure 6.6 Adding the Default Gateway for IPv6
4.
Last but not least, you need to conﬁgure a DNS server.To do so issue the following com-
mand and then press Enter:
netsh interface ipv6 add dnsserver “Local Area Connection” 2001:DB8:0:1::1 index=1.
Once complete, you’ll come to a blinking cursor at the command prompt, as shown in
Figure 6.7.
Figure 6.7 Conﬁguring the DNS Server for IPv6
You can verify your settings using ipconﬁg in the command prompt, as you did in Figure 6.8, or
view the Internet Protocol Version 6 (TCP/IPv6) Properties page, as shown in Figure 6.9.
www.syngress.com
196
Chapter 6 • Managing Local Networking Essentials

Figure 6.8 Verifying Changes via ipconﬁg
Figure 6.9 IPv6 Properties
To conﬁgure Windows Vista to obtain an IPv6 address via DHCPv6 select Obtain an IPv6
address automatically within the Internet Protocol Version 6 (TCP/IPv6) Properties page.
Enabling and Disabling IPv6
It’s probably obvious that you cannot uninstall IPv4 in Vista, but did you know the same applies to
IPv6? That’s right, you cannot uninstall IPv6; you can only enable or disable it.To disable IPv6 do the
following:
www.syngress.com
Managing Local Networking Essentials • Chapter 6
197

1.
Go to the Local Area Connection Properties page by selecting Start | Network |
Network and Sharing Center | Manage network connections.
2.
Right-click on Local Area Connection and choose Properties.
3.
At the UAC prompt, either enter the administrator’s credentials or click Continue if you
are an administrator.
4.
Clear the checkbox labeled Internet Protocol Version 6 (TCP/IPv6), as shown in
Figure 6.10, and then click OK.
Figure 6.10 Disabling IPv6
The Network and Sharing Center
A new feature in Windows Vista is the Network and Sharing Center. It is a central location for con-
trolling many aspects of networking within Windows Vista.The ﬁrst time you see the Network and
Sharing Center you can easily get disoriented, as you see in Figure 6.11, mainly because it’s so dif-
ferent from anything you’ve seen in Windows XP.The Network and Sharing Center provides easy-
to-read information about any networks you’re connected to, what networking features you have
enabled, and a list of networking tasks you can select.To get to the Network and Sharing Center
select Start | Network | Network and Sharing Center.
www.syngress.com
198
Chapter 6 • Managing Local Networking Essentials

Figure 6.11 The Network and Sharing Center
You also can use the Network and Sharing Center to troubleshoot network connectivity issues.
Take, for example, Figure 6.12, which reveals via the Network and Sharing Center that connectivity
to the Internet is lost.
Figure 6.12 Troubleshooting Network Connectivity
Managing Local Networking Essentials • Chapter 6
199
www.syngress.com

By simply placing your cursor on the X signifying the break in connectivity, you are prompted
to “Click to diagnose”.You can then click on the X and Windows Vista will begin to diagnose the
problem. Figure 6.13 shows that Windows Vista has diagnosed the problem as a possible problem
with the DNS server, and adds that we need to contact our ISP or network administrator.
Figure 6.13 Windows Network Diagnostics
In our example, Windows Network Diagnostics could not ﬁx the problem, but it did give us
more detailed information about what the problem may be, allowing us to inform our administrators
so that they can take the actions required to resolve the issue.
Network Explorer
Remember My Network Places in Windows XP? Well, you can think of Network Explorer in
Windows Vista as My Network Places on steroids, because of a feature in Network Explorer called
Network Discovery.
Network Discovery
Network Discovery simpliﬁes conﬁguring and connecting network devices, primarily in small envi-
ronments such as home ofﬁces and small ofﬁces. Previous versions of Windows used NetBIOS to
announce their presence on the network.These broadcasts were also used to advertise what shares
each system had. Network Discovery accomplishes the same thing; it uses the Function Discovery
Resource Publication service to publish the local computer and its attached resources (drive shares,
printer shares, etc.). In ﬁnding other Windows Vista systems, it uses the Function Discovery Provider
Host service and Web Services Dynamic Discovery (WS-Discovery). Windows Vista still uses the
older method of announcing itself to previous Windows systems such as XP to provide backward
compatibility. Laptop users are prime examples of people who may ﬁnd Network Discovery useful in
their home networks as long as it is implemented correctly with Network Location Types. Enabling
Network Discovery opens the following inbound ports in the Windows Firewall:
■
Network Discovery (LLMNR-UDP-In)  Creates an inbound rule to allow Link Local
Multicast Name Resolution on UDP port 5355.
■
Network Discovery (NB-Datagram-In)  Creates an inbound rule to allow NetBIOS
Datagram transmission and reception on UDP port 138.
www.syngress.com
200
Chapter 6 • Managing Local Networking Essentials

■
Network Discovery (NB-Name-In) Creates an inbound rule to allow NetBIOS Name
Resolution on UDP port 137.
■
Network Discovery (Pub-WSD-In)  Creates an inbound rule to discover devices via
Function Discovery on UDP port 3702.
■
Network Discovery (SSDP-In)  Creates an inbound rule to allow use of the Simple
Service Discovery Protocol on UDP port 1900.
■
Network Discovery (UPnP-In)  Creates an inbound rule to allow use of Universal Plug
and Play on TCP port 2869.
■
Network Discovery (WSD Events-In)  Creates an inbound rule to allow WSDAPI
Events via Function Discovery on TCP port 5357.
■
Network Discovery (WSD EventsSecure-In)  Creates an inbound rule to allow
Secure WSDAPI Events via Function Discovery on TCP port 5358.
■
Network Discovery (WSD-In)  Creates an inbound rule to discover devices via
Function Discovery on UDP port 3702.
Enabling Network Discovery opens the following outbound ports in the Windows Firewall:
■
Network Discovery (LLMNR-TCP-Out)  Creates an outbound rule to allow
LLMNR on TCP port 5355.
■
Network Discovery (LLMNR-UDP-Out)  Creates an outbound rule to allow
LLMNR on UDP port 5355.
■
Network Discovery (NB-Datagram-Out)  Creates an outbound rule to allow
NetBIOS Datagram transmission and reception on UDP port 138.
■
Network Discovery (NB-Name-Out)  Creates an outbound rule to allow NetBIOS
Name Resolution on UDP port 137.
■
Network Discovery (Pub WSD-Out)  Creates an outbound rule to discover devices via
Function Discovery on UDP port 3702.
■
Network Discovery (SSDP-Out)  Creates an outbound rule to allow use of the Simple
Service Discovery Protocol on UDP port 1900.
■
Network Discovery (UPnPHost-Out)  Creates an outbound rule to allow the use of
Universal Plug and Play over TCP (all ports).
■
Network Discovery (UPnP-Out)  Creates a second outbound rule to allow the use of
Universal Plug and Play over TCP (all ports).
■
Network Discovery (WSD Events-Out)  Creates an outbound rule to allow WSDAPI
Events via Function Discovery on TCP port 5357.
■
Network Discovery (WSD EventsSecure-Out)  Creates an outbound rule to allow for
Secure WSDAPI Events via Function Discovery on TCP port 5358.
■
Network Discovery (WSD-Out)  Creates an outbound rule to discover devices via
Function Discovery on UDP port 3702.
www.syngress.com
Managing Local Networking Essentials • Chapter 6
201

File and Printer Sharing
Since the days of Windows for Workgroups, Microsoft has enabled users to share locally attached
resources such as disk drives and printers with other users on the network from their own PCs.
Windows Vista offers the same feature, which you can enable in the Network and Sharing Center.
Although both ﬁle and printer sharing are listed separately, enabling one or the other enables the fol-
lowing inbound port exceptions in the Windows Firewall:
■
File and Printer Sharing (Echo Request–ICMPv4-In)  This exception allows PING
messages to be sent to the local computer from any computer attached to the network
using ICMPv4, including those attached to the Internet or other remote networks.
■
File and Printer Sharing (Echo Request–ICMPv6-In)  This allows IPv6-enabled
computers to send PING messages to the local computer using ICMPv6.This exception is
enabled for all network-attached computers, regardless of location.
■
File and Printer Sharing (NB-Datagram-In)  This creates an inbound rule to allow
NetBIOS Datagram transmission and reception over UDP port 138 from machines on the
local subnet.
■
File and Printer Sharing (NB-Name-In)  This creates an inbound rule to allow
NetBIOS Name Resolution over UDP port 137 from machines on the local subnet.
■
File and Printer Sharing (NB-Session-In)  This creates an inbound rule to allow
NetBIOS Session Service connection from the local subnet on TCP port 139.
■
File and Printer Sharing (SMB-In)  This creates an inbound rule to allow Server
Message Block (SMB) transmission and reception via Named Pipes over TCP port 445
from machines on the local subnet.
■
File and Printer Sharing (Spooler Service–RPC)  This creates an inbound rule to
allow the Print Spooler Service to accept dynamic Remote Procedure Call (RPC) connec-
tions over TCP from machines on the local subnet.
■
File and Printer Sharing (Spooler Service–RPC-EPMAP)  This creates an inbound
rule to allow RPC-EPMAP connections over TCP from the local subnet.
The following outbound exceptions are enabled when ﬁle and printer sharing is turned on:
■
Outbound PING trafﬁc, both ICMPv4 and ICMPv6  Outbound Internet Control
Message Protocol (ICMP) connections are enabled to all network-connected devices.
■
Outbound NetBIOS and SMB trafﬁc Creates outbound rules for UDP ports 137 and
138, and TCP ports 139 and 445, to machines on the local subnet.
Public Folder Sharing
As we saw in Chapter 3, Public folder sharing allows multiple users on a single PC to share ﬁles with
each other.You can also enable Windows Vista to share the Public folder on the network as well.
When you enable Public folder sharing under the Network and Sharing Center, you allow the local
Public folder to be available to users on the network. Users on a PC with Public folder sharing
www.syngress.com
202
Chapter 6 • Managing Local Networking Essentials

enabled can simply drop ﬁles and directories inside the Public folder, and they will be accessible to
other users. If security is a concern, Windows Vista takes care of that with password-protected sharing
of the Public folder. Enabling this feature only allows users with local accounts on the PC to access
the contents of the Public folder. Disabling Public folder sharing only prevents network users from
gaining access to the Public folder’s contents; it does not turn off the feature that enables local users
to share with each other.
Media Sharing
When you enable the media sharing option, users and devices on the network can access shared
music, pictures, and videos stored on your computer. When media sharing is enabled the following
ports and services are required:
■
Windows Media Player Network Sharing Service (HTTP-Streaming-In) Accepts
inbound connections on TCP port 10243 from the local subnet.
■
svchost.exe  Accepts inbound QoS trafﬁc on TCP and UDP ports 2177 from the local
subnet.
■
Simple Service Discovery Protocol Accepts inbound trafﬁc on UDP port 1900 from
the local subnet.
■
wmpnetwk.exe  Conﬁgured to accept inbound TCP and UDP connections on all ports
from the local subnet.
■
The Windows Media Player Network Sharing Service (UPnP-In)  Accepts
inbound TCP trafﬁc on port 2869 from the local subnet.
Network Location Types 
You can enable and disable Network Discovery by location type if you like. Windows Vista provides
three location types:
■
Domain The computer is connected to a network that contains a domain controller for
the domain in which the computer is a member. Network Discovery is disabled by default.
■
Public The computer is connected to a network that has a direct connection to the
Internet. Examples are airports, libraries, and coffee shops. Network Discovery is disabled
by default.
■
Private The computer is connected to a network that has some level of protection from
the Internet, such as a router with a ﬁrewall. Examples are home ofﬁces and small ofﬁce
networks. Private networks are designated by the user. Network Discovery is disabled by
default, but it typically is safe for this network type.
www.syngress.com
Managing Local Networking Essentials • Chapter 6
203

NOTE
Be aware that using network location types can affect the exceptions that are set up
in the Windows Firewall. If you have made changes to the ﬁrewall for a speciﬁc loca-
tion type, you’ll need to make those same adjustments to the ﬁrewall for each loca-
tion type you create if you want those settings to be across the board.  
The Network Map
As you’ve seen, the Network and Sharing Center in Windows Vista provides you with a visual of
your computer’s path to your gateway.The Network Map, another Vista feature, provides an even
more detailed map of the network.Although the tool is designed to make networking easier for end
users, administrators can also see its value.To view the Network Map, select Network and Sharing
Center | View full map.The View full map option sits off to the right in the Network and
Sharing Center (see Figure 6.12 or 6.13). Figure 6.14 shows the Network Map of our test network.
Figure 6.14 A Network Map of Our Test Network
As you see in the Network Map, if you simply point your mouse over an object you get infor-
mation about that object. In this case, we pointed our mouse over our machine (Vista1) and in return
received our machine name, IPv4 address, IPv6 address, and Media Access Control (MAC) address.
www.syngress.com
204
Chapter 6 • Managing Local Networking Essentials

The other PC we see (Alderon) is also a Windows Vista machine.You can see that both Vista systems
are connected to a switch which connects to a gateway.
At the bottom of the Network Map screen are two systems that were discovered, but could not be
placed on the map because these systems do not support the Link Layer Topology Discovery (LLTD)
protocol.This protocol functions at Layer 2 of the Open Systems Interconnection (OSI) model and
allows network devices to identify each other, learn the network, and establish communications.
Normally you don’t need to administer LLTD, but you can conﬁgure two Group Policy settings
to alter its state.To do so click on the Start Button and then click Run. In the Run box type
gpedit.msc; you will need to be an administrator to do this, so in the UAC box click Continue or
enter the administrator’s credentials. Once the Group Policy Object Editor comes up, select
Computer Conﬁguration | Administrative Templates | Network | Link Layer Topology
Discover.You have two settings, as listed here and shown on the right pane in Figure 6.15:
■
Turn on Mapper I/O (LLTDIO) driver Enables the computer to discover the
topology of the local network and to initiate QoS requests.
■
Turn on Mapping Responder (RSPNDR) driver  Enables a computer to be discov-
ered on a network and to participate in QoS activities.
Figure 6.15 Group Policy for LLTD
www.syngress.com
Managing Local Networking Essentials • Chapter 6
205

Because LLTD is not a secure protocol, there is no guarantee that the Network Map that
Windows Vista creates is completely accurate.The possibility of devices sending false announcements
exists. Because each user in Windows Vista can have a network proﬁle, network maps are actually
created on a per-user basis. With each network proﬁle that a user creates, Windows Vista generates
two maps: the current map and a copy of the most recent functional map. When the user sees the
Network Map from Windows Vista, he or she actually sees the combination of both the most recent
and the current maps.
SOME INDEPENDENT ADVICE
Previous versions of Windows did not support LLTD, and therefore they do not show
up in the Network Map that Windows Vista creates. Microsoft, though, does have an
LLTD responder that is available for download for Windows XP. The responder will
not allow Windows XP systems to create Network Maps; it will allow them to be seen
in it, however. You can download the XP LLTD responder from
http://support.microsoft.com/kb/922120. 
Network Access Protection 
Network Access Protection (NAP) is a tool that protects the network by forcing computers to
comply with an administrator’s predeﬁned computer health requirements.These health requirements
can include, but are not limited to, the following:
■
Updated software patches
■
Latest virus signatures
■
Any necessary certiﬁcates
For example, if an administrator has created a health requirement that PCs on the network must
have the latest Microsoft updates, any system that is not updated can be prevented from accessing the
corporate network until it does become compliant. NAP is an enforcement platform built into both
Windows Vista and Longhorn Server.
Let’s say you wanted to enable a NAP health policy for VPN connections on a Windows Vista
system; you would do the following:
1.
Click Start | Control Panel | Administrative Tools | Services.
TIP
To get to the Services Console faster, you can also click Start | Run, type services.msc,
and then press Enter. 
www.syngress.com
206
Chapter 6 • Managing Local Networking Essentials

2.
In the Services Console, double-click on the Network Access Protection Agent ser-
vice and change the startup type to Automatic, as shown in Figure 6.16. Click OK.
Figure 6.16 Changing the NAP Agent to Automatic
3.
Select Start | Run, type napclcfg.msc, and press Enter. Respond to the UAC prompt
that pops up.
4.
Once the NAP Client Conﬁguration console comes up, on the left click on Enforcement
Clients and in the Details pane right-click Remote Access Quarantine Enforcement
Client and select Enable, as shown in Figure 6.17.
Figure 6.17 NAP Client Conﬁguration
Managing Local Networking Essentials • Chapter 6
207
www.syngress.com

5.
Restart the system to apply the changes you just made.
6.
Once you’re back in Windows Vista, pull up the properties of your VPN connection and
then go to the Security tab. Select Advanced (custom settings), as shown in Figure
6.18, and then click on Settings.
Figure 6.18 VPN Client Security Properties
7.
In the Advanced Security Settings screen change the Logon security to Use
Extensible Authentication Protocol (EAP) and select Protected EAP (PEAP)
(encryption enabled), as shown in Figure 6.19.Then click Properties.
Figure 6.19 Advanced Security Settings
208
Chapter 6 • Managing Local Networking Essentials
www.syngress.com

8.
In the Protected EAP Properties screen, go down to the bottom, under Select
Authentication Method:, and click the Enable Quarantine checks checkbox, as shown
in Figure 6.20. Now NAP health policy enforcement is enabled.
Figure 6.20 Enabling Quarantine Checks
NOTE
In implementing NAP, you would also need to conﬁgure the server side of the infras-
tructure which runs on Windows Longhorn Server. To learn more about how NAP
works visit www.microsoft.com/technet/itsolutions/network/nap/default.mspx.
www.syngress.com
Managing Local Networking Essentials • Chapter 6
209

Summary
Windows Vista is the ﬁrst Microsoft operating system to natively support IPv6. IPv6 offers numerous
beneﬁts for users, administrators, developers, and ISPs. Implementing IPv6 relieves us of the limited
address space of IPv4 and the lack of built-in security, and provides QoS support.
You can conﬁgure TCP/IP in Windows Vista in two ways: through the user interface or via the
netsh command. IPv4 addresses can be static or dynamic.You assign static addresses manually, whereas
dynamic addressing can occur via DHCP or even via APIPA. IPv6 addresses are rarely statically
assigned, with the exceptions of routers and servers.Auto-conﬁguration is the process that IPv6
devices use to obtain an IP address. Because IPv6 is now natively supported in Windows Vista, you
cannot uninstall it.You can only disable it.
One of the new features in Windows Vista is the Network and Sharing Center. It is a central
location for controlling many aspects of networking.The Network and Sharing Center provides easy-
to-read information about any networks you’re connected to, what networking features you have
enabled, and a list of networking tasks that you can select.
The Network Map is a Windows Vista feature that provides a detailed map of the network.
Although the tool is designed to make networking easier for end users, administrators can also see its
value.The Network Map uses the LLTD protocol to identify devices and create a graphical depiction
of the network.
NAP protects the network by forcing computers to comply with an administrator’s predeﬁned
computer health requirements. Health requirements can include such things as compliance with
updated software patches, updated virus signatures, and any required certiﬁcates. Systems not meeting
the requirements may be unable to access the corporate network.
Windows Vista provides numerous changes in networking compared to its predecessors—changes
which administrators as well as users will welcome.
Solutions Fast Track
A New Generation of TCP/IP

Windows Vista provides native support for IPv6.

Windows Vista supports a dual-layer architecture, allowing both IPv4 and IPv6 to have
their own Transport and Framing layers.

You can conﬁgure IPv6 using the Control Panel or the netsh command.
Conﬁguring TCP/IP in Vista

You can conﬁgure TCP/IP (both IPv4 and IPv6) via the user interface or via the netsh
command.

You can assign IPv4 addresses manually (static addressing) or dynamically (DHCP or
APIPA).
www.syngress.com
210
Chapter 6 • Managing Local Networking Essentials


You can assign IPv6 addresses manually (static addressing) or dynamically (auto-
conﬁguration).

You cannot uninstall IPv6 from Windows Vista; you can only disable it.
The Network and Sharing Center

The Network and Sharing Center is the central location for managing network resources
in Windows Vista.

The Network and Sharing Center uses the concept of network locations, thereby allowing
different settings for Public, Private, and Domain-based networks.

Network Discovery simpliﬁes conﬁguring and connecting network devices in small ofﬁce
environments.
The Network Map

The Network Map provides a graphical view of the network on which the PC resides.

The Network Map is useful for troubleshooting issues with segments becoming
disconnected among others.

The Network Map uses LLTD, a Layer 2 protocol, to identify systems on the network.
Network Access Protection

NAP protects the network by enforcing computer health policies.

Users can enforce requirements on such things as software patches, virus signatures, and
certiﬁcates.

The NAP client runs on Windows Vista, whereas the server infrastructure resides on
Longhorn Server.
www.syngress.com
Managing Local Networking Essentials • Chapter 6
211

Q: What is the difference between how XP handled IPv6 and IPv4 and the way Windows Vista
does?
A: Windows XP ran what’s referred to as a dual stack. Both IPv6 and IPv4 ran with separate
Transport and Framing layers, which was inefﬁcient. In Windows Vista, they share common
Transport and Framing layers.
Q: I ran the Network Map and I don’t see a lot of the systems on my network. Why is that?
A: Systems that do not support the LLTD protocol will not show up in the map.There is a down-
load for Windows XP systems for the LLTD responder, which will allow them to be seen in the
Network Map.
Q: Can I implement NAP with Windows Server 2003?
A: Windows Server 2003 cannot support the server infrastructure required for a NAP solution.
Only Longhorn Server can.
Q: I noticed that the Advanced TCP/IP Settings page for IPv6 doesn’t have a WINS tab. How
come?
A: IPv6 does not use NetBIOS for name resolution; therefore, there is no need for a WINS tab.
Q: Does Windows Server 2003 support DHCPv6?
A: No. Windows Longhorn Server will include support for the DHCPv6 role.
www.syngress.com
212
Chapter 6 • Managing Local Networking Essentials
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

213
Managing the
Wireless World 
and Its Security
Solutions in this chapter:
■
What’s New with Wireless in Vista?
■
Understanding Wireless Security in Vista
■
Installing a Wireless Network
Chapter 7
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
The new Microsoft Vista operation system has introduced many changes and improvements regarding
how it deals with wireless technology. In this chapter, we will review these new changes and
improvements that allow you to successfully manage a wireless Microsoft Vista network.As with any
technology, security is very important in wireless networks. By the end of this chapter, you will
understand the vulnerabilities in wireless networks and how you can protect your wireless network
with the proper conﬁguration settings. Microsoft has made signiﬁcant changes in the new Microsoft
Vista operation system that are helpful in administration and in improving security.
What’s New with Wireless in Vista?
Microsoft has designed Windows Vista to provide better support for wireless networking that is more
closely integrated with the operating system than ever before.This has resulted in improved stability
and reliability. In 2001, wireless networking wasn’t prevalent; therefore, Windows XP didn’t support it
natively.You could use wireless network cards with XP but what you got was typically a proprietary
interface from the hardware vendor.This meant that when enterprises implemented wireless local
area networks (WLANs) their IT departments would have to learn different vendor-speciﬁc wireless
software depending on the computer hardware they used. Windows Vista provides a single wireless
client that, regardless of the computer’s manufacturer, is consistent for users and IT personnel.
The new Native Wi-Fi Architecture in Windows Vista has been redesigned. Now 802.11 is rep-
resented as its own media type in Windows, separate from 802.3, which now allows features such as
larger frame sizes to be taken advantage of. Wireless support in Windows Vista also includes the fol-
lowing changes:
■
The Single Sign-on feature
■
Behavior change with no preferred wireless network available
■
Hidden wireless network support
■
Command-line conﬁguration
■
WPA2 support
■
Integration with NAP
Other changes with wireless support can be found in Windows Vista, such as the Network
Diagnostics Framework, Network Location Types, and the next generation of TCP/IP to name a few.
These also apply to general networking and were covered in Chapter 6.Therefore, we’ll focus on
those changes speciﬁc to wireless.
Single Sign-on Feature
Single Sign-on allows users to connect to wireless networks before they log on to the domain. By
doing so, users can authenticate to a domain and the network all at once.Administrators allow this by
using a Group Policy setting to conﬁgure Single Sign-on (SSO) proﬁles on client computers. Once
the SSO proﬁle is conﬁgured, 802.1x authentications will precede the logon to the domain and users
www.syngress.com
214
Chapter 7 • Managing the Wireless World and Its Security

are only prompted for wireless credential information if required.This ensures that a wireless connec-
tion is in place before the domain logon, then Vista can apply Group Policy updates, run logon
scripts, and even download software updates.
Behavior Change with No 
Preferred Wireless Network Available
In Windows XP, if no preferred wireless network was available it would create a random wireless net-
work name, switch the wireless adapter to infrastructure mode, and if automatically connecting to a
nonpreferred network, it was disabled. Windows then scanned for preferred wireless networks every
60 seconds. Now, Windows Vista will no longer create a randomly named network. Instead it “parks”
the wireless adapter while periodically scanning for available networks.This prevents the chance of a
randomly generated wireless network name matching a network name that might be in existence in
close proximity. It also prevents the situation of the randomly generated network name and hence the
XP system from being seen by those with malicious intentions.
Hidden Wireless Network Support
Now I know what you’re thinking:“Windows XP can connect to hidden wireless networks?”Yes,
that is true, but here is the difference. Windows XP always connected to a network that broadcast its
service set identiﬁer (SSID) even if the hidden network had a higher priority.This is not the case in
Windows Vista. Wireless network connectivity is determined by the priority level of that network,
not whether it is or isn’t broadcasting its SSID.
Command-Line Conﬁguration
As we saw in Chapter 6, the netsh command is a powerful command-line tool in conﬁguring net-
work settings. By using the wlan context of the netsh command, we can conﬁgure wireless settings as
well. Having commands available for conﬁguring your wireless settings allows you to support auto-
mated scripts for wireless settings without using Group Policy or, worse, manually creating them.
Wireless network policy settings apply only in Active Directory domains. In environments that do
not have Active Directory, a script can automate the process of conﬁguring wireless settings. Some of
the things you can do with the netsh wlan command include the following:
■
Conﬁgure all wireless client settings in a named proﬁle, such as one indicating an SSID, the
type of authentication, the type of encryption, and the 802.1x authentication type
■
Conﬁgure a list of allowed and denied wireless networks
■
Display wireless conﬁgurations
■
Remove wireless conﬁgurations
■
Migrate settings among wireless clients
Figure 7.1 shows the available commands within the wlan context of netsh. Under each command
are additional commands and parameters used in conﬁguring wireless settings with netsh wlan.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
215

Figure 7.1 The netsh wlan Context
WPA2 Support
Windows Vista supports Wi-Fi Protected Access Two (WPA2) authentication options that can be
conﬁgured by the end user or by the administrator via Active Directory using Group Policies. Both
Enterprise (IEEE 802.1x authentication) and Personal (pre-shared key) can connect to both infras-
tructure and ad hoc wireless networks. WPA2 can also provide Advanced Encryption Standard (AES)
encryption to enterprises and users alike.
Integration with NAP
Dynamic WEP, WPA Enterprise, and WPA2 Enterprise modes using 802.1x authentication can
leverage the NAP platform to prevent wireless clients that do not comply with system health settings
and requirements (for example, clients that are not running antivirus software) from gaining full
access to the wireless network.As shown in Chapter 6, NAP in Microsoft Vista provides policy
enforcement components that help ensure a computer’s health prior to connecting to a network with
administrator-deﬁned requirements. Some of the health components that can be automatically
checked with NAP on a client’s PC prior to allowing connectivity to the network may include
whether the latest patch level is applied, whether a ﬁrewall is installed and running, whether antivirus
software is running, and whether proper passwords are set and conﬁgured. If the client’s PC fails to
pass these administrator-deﬁned health policy requirements, it will be alerted with administrator-con-
ﬁgured instructions on how to comply before full network connectivity is granted.
Understanding Wireless Security in Vista
In the wireless world, data is constantly ﬂowing through the air.A person that is technically savvy can
view, steal and manipulate data that travels wirelessly. Users and administrators must be aware of secu-
rity issues in a wireless network and do their best to secure their data in transit. Windows Vista’s
wireless security improvements are dramatic compared to those of Windows XP.These improvements
include:
www.syngress.com
216
Chapter 7 • Managing the Wireless World and Its Security

■
Passive and Active Countermeasures
■
Connecting to Unprotected Networks
■
Improved Ad Hoc Networking Security
■
Single-Sign-On
■
Network Location Types
■
Security Protocols Supported
■
Extensibility via EAPHostwww.syngress.com
Passive and Active Countermeasures
Throughout the wireless boom, hackers have found different ways to exploit the weaknesses of client
systems even before they connect to the network.This is done by the fact that wireless clients broadcast
information to discover and connect to some wireless networks. Broadcasts from these clients can list
every wireless network a computer connects to even if they aren’t in the vicinity of those networks.
For instance, if your company’s wireless network has an SSID of Net1 and you’re at an airport
connecting to the wireless network there, it is possible for your PC to broadcast the SSID of your
company’s network to potential hackers who might be “listening” in.After gathering this informa-
tion, an attacker could then trick your wireless client into connecting to a phony access point and
thus take advantage of it.This is why Windows Vista has been designed to broadcast as little informa-
tion about the wireless networks it connects to versus its predecessors. Does this mean that all broad-
casts as they pertain to SSIDs are eliminated? The answer is no. Windows Vista will broadcast the
names of only preferred networks that are marked as nonbroadcast, meaning that the SSIDs of those
networks are not sent out—thus, the network is “hidden.” So those wireless networks set up to not
broadcast their identities will actually be broadcasted by the clients that connect to them. Microsoft
has recommendations on broadcasting and nonbroadcasting wireless networks, which you can see in
the upcoming “Best Practices According to Microsoft” box in this section.
Another common issue in previous versions of Windows was that an exploit happens when a
wireless client generates a temporary network name when no preferred network is available.An
attacker could actually connect to the “temporary” network that the wireless client has created and
then continuously send network requests to the wireless system, thus making it nearly if not com-
pletely unusable since the system would be tied up responding to the continuous network requests.
Windows Vista deals with this in one of two ways:
■
If a native wireless driver is installed, the wireless adapter is “parked” and does not generate
a temporary network name that could be exploited, thus removing that vulnerability.
■
If using a legacy type wireless driver, Windows Vista will create a random key for the tem-
porary network, making it practically impossible for an attacker to exploit.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
217

BEST PRACTICES ACCORDING TO MICROSOFT
Microsoft recommends that companies broadcast their SSIDs for their wireless net-
works from their access points. The idea behind this is that by not broadcasting the
SSID, you are not necessarily protecting the network. Tools from malicious users
don’t actually rely on SSID broadcasts from Wireless Routers and Access Points. By
disabling the broadcast of SSIDs, you make it more difﬁcult for legitimate users to
ﬁnd the network, who have not previously connected to it. By disabling the SSID
broadcasts, you can actually negatively affect the users you want to let connect to
the wireless network.  
SOME INDEPENDENT ADVICE
Although the preference is to broadcast the SSID whenever possible sometimes com-
pany policy dictates that they not be broadcast, and as the administrator you’re left
holding the bag. If you are in that situation, all is not lost; you can lower the likeli-
hood of the SSID being sent out from a client by doing the following: In the
Connection tab of the Wireless Network properties window, do NOT enable the
Connect automatically when this network is in range option (as shown in Figure
7.2). Users will then have to manually connect to nonbroadcast networks each time.
This controls the wireless client’s “send probe requests,” which is what actually sends
out the SSID information of a wireless network from a wireless client. By doing this,
you protect the SSID of a wireless network when wireless clients are on the road. 
Figure 7.2 The Wireless Networking Properties Connection Tab
218
Chapter 7 • Managing the Wireless World and Its Security
www.syngress.com

Connecting to Unprotected Networks
Many wireless networks are unprotected and unsecured. Connecting to them thus creates a signiﬁ-
cant risk.These wireless networks are a hacker’s dream.They can capture and view all unprotected
network trafﬁc. Most publicly available wireless hot spots are unprotected networks. Places like your
neighborhood coffee shop or restaurant that provides free Internet access can open you up to all sorts
of malicious attacks, but sometimes you can’t avoid having to use these networks, like when you are
in an airport terminal and you have to get an e-mail out before you catch a ﬂight.
In our example, we are at a coffee shop called Jane’s Coffee Shop. Jane offers free Internet access
to patrons. Figure 7.3 shows a list of networks we can connect to, one of them being janes-coffee. By
just moving our mouse over the entry for janes-coffee, we see information about her wireless net-
work. We know the SSID, that the network is unsecured, and that it receives 802.11g. If we choose to
connect to the janes-coffee wireless network, Windows Vista informs us that the network we are
connecting to is unsecured and that information sent on this network may be visible to others, as
shown in Figure 7.4.
Figure 7.3 Details of an Unsecured Network
When it comes to unsecured networks,Windows Vista will never automatically connect to them,
nor will it automatically connect to ad-hoc networks either. Users are informed about what risks, if
any, exist when connecting to wireless networks and they can base their decisions on that information.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
219

Figure 7.4 An Unsecured Network Warning
Improved Ad Hoc Networking Security
Ad hoc wireless networks consist of two or more wireless clients communicating to each other
without the aid of a wireless access point or any network infrastructure. Users setting up ad hoc net-
works need to be aware of the potential security risks associated with these networks.The chances of
creating an unprotected network or even connecting to a malicious one are possibilities.
By default, Windows Vista will attempt to make the network as secure as possible. Using WPA2-
Personal better protects users from common attacks and vulnerabilities if no security was in place.
After the ad hoc network is created, Windows Vista will delete it after all users disconnect or are no
longer within range of each other.
Single Sign-On
As we stated earlier, Single Sign-on (SSO) gives users the ability to connect to protected wireless net-
works before domain logon, therefore allowing wireless users to authenticate to a domain and the
network in a single step. SSO is supported by both standard Extensible Authentication Protocol
(EAP) methods:
■
Protected EAP-Microsoft Challenge Handshake Authentication Protocol version 2 (PEAP-
MS-CHAP v2)
■
EAP-Transport Layer Security (EAP-TLS)
Network Location Types
As we discussed in Chapter 6, the three network location types consist of the following:
www.syngress.com
220
Chapter 7 • Managing the Wireless World and Its Security

■
Public Includes unidentiﬁed networks, wired and wireless hotspots. Examples are coffee
shops, airports, libraries, and so on.
■
Private These typically include home and small ofﬁce networks.
■
Domain Used when Windows Vista can connect to, and authenticate against, an Active
Directory domain controller.
Network location types allow wireless clients the ability to have a higher level of security when
connected to public networks without sacriﬁcing capabilities when connecting to private networks.
This is very similar to a ﬁrewall policy that will have hardened rules for public networks and fewer
rules for private networks.
Security Protocols
Security protocols and encryption prevents an attacker from tapping into the air and reading data as it
passes by.Today, we have a mix of different standards and protocols to choose from. It’s easy to see
how someone would become confused and even frustrated in understanding this. Windows Vista
supports the major security protocols and initiatives for wireless networking.This ensures there is
interoperability between Windows Vista and the wireless network infrastructure, regardless of the
manufacturer.The security protocols supported by Windows Vista are listed in Table 7.1.
Table 7.1 Security Protocols Supported by Vista
Protocol
Description
Wired Equivalent 
Considered older technology and the least secure of the 
Privacy (WEP)
wireless security protocols. Originally designed with a 40-
bit key but now also supports a 104-bit key.   
WPA
Created due to the vulnerabilities found in WEP. Uses
Temporal Key Integrity Protocol (TKIP) encryption.
Provides a scheme of mutual authentication using
802.1x/EAP authentication or a pre-shared key. Supported
in two modes with Windows Vista: Personal and
Enterprise. WPA Personal is designed for home and small
ofﬁce users. Enterprise mode is designed for larger envi-
ronments that can leverage 802.1x authentication using
EAP. This is used with an authentication server, providing
strong mutual authentication between the client and the
wireless network via the access point. Uses TKIP 
encryption.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
221
Continued

Table 7.1 continued Security Protocols Supported by Vista
Protocol
Description
WPA2
The newest of the standards, launched in 2004, WPA2 is
the most secure standard. It supports 802.1x/EAP authen-
tication but also includes support for AES encryption.
WPA2 may require implementers to purchase new hard-
ware. Also comes in two modes: Personal and Enterprise.
Just like WPA Personal, WPA2 Personal is designed for
home and small ofﬁce environments. Enterprise mode for
WPA2 is identical to that of WPA Enterprise, with the
exception that it uses AES encryption.
PEAP
Open standard for transmitting encrypted authentication
information across wireless networks. Uses only server-
side public keys to authenticate wireless clients. 
PEAP-MS-CHAP v2
Wireless authentication protocol where wireless clients
can use Active Directory accounts and passwords to
authenticate to a wireless network. 
EAP-TLS
Wireless authentication protocol where clients can
authenticate to the wireless network using certiﬁcates or
even smart cards. Earlier versions of Windows-supported
EAP-TLS.
The security protocols listed in Table 7.1 can be administered and conﬁgured using Group
Policies in Active Directory or using local policies within Vista itself. Each of these protocols is
helpful in securing any wireless network. Understanding what each does and provides is key for
administrators in choosing which one to implement in their own environments.
Extensibility via EAPHost
Windows Vista supports the EAP architecture in the form of EAPHost.This provides easier develop-
ment of EAP authentication methods for wireless networks, and offers a framework for creating
authentication schemes that are not provided as part of Windows Vista.This allows administrators to
use third-party plug-ins for providing wireless authentication. EAPHost offers the following features:
■
EAP Method Coexistence Allowing numerous implementations of the same EAP
method to coexist. Example: two versions of PEAP from different manufactures can coexist
and be installed.
■
New Standards Support Supports network discovery.
Since EAPHost is integrated with NAP, any new supplicants do not have to be NAP aware.All
that needs to be done is for the new supplicant to register a connection identiﬁer and a callback
function, informing the supplicant to reauthenticate.
www.syngress.com
222
Chapter 7 • Managing the Wireless World and Its Security

Installing a Wireless Network
Now that we understand the new features of wireless networking in Windows Vista and the security
options available to us, we must be able to put into practice what we’ve learned.To do so means we
need to set up a wireless network. Remember wireless networks come in two modes: infrastructure
and ad hoc. We will go about setting up each type and applying some of the principles we’ve just
learned. Before setting up wireless though, we need to understand some of the basics about it.
Wireless Networking Protocols
Wireless networking provides a choice of ﬁve protocols for communicating with devices.Those pro-
tocols are:
■
802.11a
■
802.11b
■
802.11g
■
802.11n (draft)
■
Bluetooth
In Table 7.2, we list some of the technical information about each wireless protocol, while in
Table 7.3 we list the pros and cons of each option.
Table 7.2 Speciﬁcations on Wireless Protocols
Protocol
Max. Speed
Indoor Range
Frequency Used
802.11a
54 Mbps
180 feet
5GHz
802.11b
11 Mbps
350 feet
2.4GHz
802.11g
54 Mbps
350 feet
2.4GHz
802.11n (draft)
540 Mbps
1000 feet
2.4GHz
Bluetooth
< 1 Mbps
32 feet
2.4GHz
Table 7.3 Pros and Cons of Wireless Protocols
Protocol
Pros
Cons
802.11a
Fast speeds; uses regulated 
Short range; easily obstructed.
frequency, preventing signal
interference from other devices.
802.11b
Low cost, excellent signal 
Slow wireless speeds; fewer 
range, not easily obstructed.
simultaneous users; unregulated
frequency; susceptible to 
interference.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
223
Continued

Table 7.3 continued Pros and Cons of Wireless Protocols
Protocol
Pros
Cons
802.11g
Fast maximum speed; 
Uses unregulated frequency; 
supports large number of 
makes it susceptible to 
simultaneous users; not 
interference.
easily obstructed.
802.11n (draft) Fastest maximum speed 
Still in draft form; early products 
available.
may not work with ﬁnal draft.
Bluetooth
Solid and proven technology 
Short range; provides very little 
for PDAs and cell phones.
WLAN value.
Setting Up Infrastructure Mode
Infrastructure mode joins a wireless network with an existing wired network. It does so by a wireless
access point (AP).To join the WLAN, the AP and all wireless clients must be conﬁgured to use the
same SSID.The AP is then connected to the existing wired network, allowing communications with
wireless clients and wired systems such as servers, routers, printers, and other desktops. Figure 7.5 shows
an example of an infrastructure mode wireless network connected to an existing wired network.
Figure 7.5 An Infrastructure Mode Wireless Network
Setting Up the Wireless Router
In setting up our wireless network, we need to conﬁgure our wireless router so other wireless clients
can access it. We’ll be setting up a Linksys WRVS4400N Broadband Router for our network. It will
www.syngress.com
224
Chapter 7 • Managing the Wireless World and Its Security
Server
`
Wireless Laptops
Desktop PC
Printer
Wireless Router
Internet

be set up to connect to the Internet.The following are the settings we will conﬁgure for the new
wireless router.
■
SSID – PRACTICE
■
IP Versions – Dual-Stack IP
■
Wireless Network Mode – Mixed (802.11b, 802.11g, and 802.11n)
■
Wireless SSID Broadcast – Enabled
■
Security Mode – WPA2-Personal
■
Encryption – AES
1.
Plug a PC (laptop or desktop) into the Linksys router in any of the four switched ports. Do
not plug into the port labeled Internet.
2.
Once you’ve booted up and logged on to your PC, open up Internet Explorer and go to
http://192.168.1.1 and press Enter.You should now see the screen asking you to log on
to the router, as shown in Figure 7.6. For the User name, type admin, and for the pass-
word, type admin. Click OK.
Figure 7.6 The Router Logon Screen
Now we will do two things. First, we will change the IP address of the router and then disable
the DHCP server function built into it. Go to Setup | LAN and beside Local IP Address, change
the address to 10.10.10.1.You can leave the Subnet Mask as it is. Next, go to DHCP Server and
click Disable, as shown in Figure 7.7. Click Save Settings. We are doing this because we will be
receiving IP addresses from a Windows 2003 Server running DHCP.Although we didn’t necessarily
have to change the local IP address of the router, we did this so as to change the defaults, including
the IP address scheme.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
225

Figure 7.7 Changing the IP Addressing Scheme
Now we need to set up the SSID.To do this, once again log on to the router, but this time
remember you must connect to it using http://10.10.10.1. Once in the Web-based conﬁguration
utility, go to Wireless | Basic Wireless Settings. For the Network Name (SSID), type in PRAC-
TICE since that is the SSID we stated earlier we would be using. For Wireless Network Mode,
choose B/G/N-Mixed. Leave Wireless Channel to Auto and set Wireless SSID Broadcast to
Enable, as shown in Figure 7.8. Now, click Save settings.
Figure 7.8 Conﬁguring SSID and Wireless Mode
www.syngress.com
226
Chapter 7 • Managing the Wireless World and Its Security

As you’ve noticed after saving the settings, you are still in the router’s administrative utility. Go to
Wireless Security, which is the next tab over to the right. In Figure 7.9, you see the choices you
have for Security Mode (for a description of each, see Table 7.4). For Security Mode, select WPA2-
Personal. Encryption will be set to AES with the Pre-shared Key set to thisis1coolrouter, as
shown in Figure 7.10.
Figure 7.9 Wireless Security Modes Available
Table 7.4 Security Modes Available for Linksys WRVS4400N
Mode
Description
WEP
Older security mode. Not recommended due to weak security
protection. WEP encryption can be 64 or 128 bits. See Table
7.1 for more details.
WPA-Personal
More secure than WEP. Offers two encryption methods TKIP
and AES. Default is TKIP. WPA shared key can be 8 to 63
characters. See Table 7.1 for more details.
WPA2-Personal 
The newest standard. Similar to WPA. Always uses AES for
encryption. Shared key can be between 8 and 63 characters.
See Table 7.1 for more details.
WPA-Enterprise
Used in coordination with a RADIUS server for client authen-
tication. Can use either TKIP or AES. Defaults to TKIP.
WPA2-Enterprise
Similar to WPA-Enterprise but only uses AES. Considered the
most secure of security modes.
WPA2-Personal 
Supports the transition from WPA-Personal to WPA2-
Mixed
Personal. Client systems can use either one.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
227
Continued

Table 7.4 continued Security Modes Available for Linksys WRVS4400N
Mode
Description
WPA2-Enterprise 
Supports the transition from WPA-Enterprise to WPA2-
Mixed
Enterprise. Client systems can use either one.
Figure 7.10 Wireless Security Options
Now go to Setup | WAN as shown in Figure 7.11 and enter your WAN information. If you
are provided a static IP address, enter the appropriate information, but if you use DHCP, just select it
from the list in Internet Connection Type. Once you’ve done this, click Save Settings and the
router will reboot.After rebooting, the wireless router is ready to receive wireless clients.
NOTE
The option Wireless Isolation (within SSID), as shown in Figure 7.11, is relatively new
to small ofﬁce and home ofﬁce (SOHO) wireless routers. When enabled, this feature
prevents computers connected to the wireless network from seeing each other. They
can still see and connect to systems on the wired network though.
www.syngress.com
228
Chapter 7 • Managing the Wireless World and Its Security

Figure 7.11 WAN Conﬁguration
Connecting to a Wireless Router
Now that we’ve set up our wireless router, we need to set up our wireless clients. Since we set up our
new wireless router to broadcast its SSID, our wireless client can now see there are wireless networks
available.You can see this by looking at the lower right-hand corner and highlighting the net-
working icon. When you do this, you will see there are wireless networks available (as shown in
Figure 7.12).
Figure 7.12 Networks Available
If we click Connect to a network (shown in Figure 7.12), we will see the new wireless net-
work connection for the SSID of PRACTICE. In Figure 7.13, we have moved our mouse over the
entry for the wireless network PRACTICE. Notice the detailed information that Windows Vista
gives you about this wireless network.You are given information about the SSID, the signal strength,
the type of security, and the radio type.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
229

Figure 7.13 Choosing the PRACTICE Wireless Network
After highlighting PRACTICE, click Connect.You are now given the opportunity to connect
to the PRACTICE wireless network.To do so, you must type in the phrase we entered as our pre-
shared key when setting up the wireless router. Remember that our passphrase is thisis1coolrouter.
Just type this into the Security key or passphrase ﬁeld.As you can see in Figure 7.14, we’ve done
just that.
Figure 7.14 Entering the Passphrase to Connect to a Wireless Network
www.syngress.com
230
Chapter 7 • Managing the Wireless World and Its Security

Once you’ve entered the correct passphrase, Windows Vista will attempt to connect to the net-
work, as shown in Figure 7.15.
Figure 7.15 Connecting to the Wireless Network PRACTICE
Once the connection is successful you have the option to save the network in the list of net-
works you connect to and also whether you want to automatically connect to this network every
time (see Figure 7.16). Remember, you can always disable this, as we showed earlier in Figure 7.2.
Figure 7.16 Successfully Connected to a Wireless Network
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
231

Go to Start | Network | Network and Sharing Center | Manage Network
Connections, right-click the Wireless Network Connection icon, and choose Status. You will
then see the status of the wireless connection, like that shown in Figure 7.17. We have successfully
connected to the PRACTICE wireless network and now also have statistics to examine if we so
choose.
Figure 7.17 Wireless Conﬁguration Properties and Statistics
On the Wireless Network Connection Status screen, you have ﬁve different options (not
including Close). If you select Details, you will be provided with information such as the physical
address/MAC address of the wireless card.You’ll also see if the network connection is DHCP Enabled
or not, the IP Address (IPv4 and IPv6), along with other information, as shown in Figure 7.18.
Figure 7.18 Details of the Wireless Connection
232
Chapter 7 • Managing the Wireless World and Its Security
www.syngress.com

If we choose Wireless Properties, within the Wireless Network Connection Status screen we
will see two tabs.The ﬁrst one is the Connection tab, which is the same screen you saw in Figure 7.2
earlier in this chapter.The other tab is the Security tab.The Security tab shows the security type,
encryption type, and the network security key.The network security key characters are hidden, as
shown in Figure 7.19.
Figure 7.19 The Security Tab of the Wireless Network Properties Screen in Vista
If you click the Properties button in the Wireless Network Connection Status screen, you
come to the familiar Wireless Network Connection Property screen shown in Figure 7.20.You’ll
see the name of the wireless network card you are using under Connect using, along with a list of
items under This connection uses the following items.You can install additional items, uninstall
selected items, or even examine an item’s properties.
Figure 7.20 The Wireless Network Connection Properties Screen
Managing the Wireless World and Its Security • Chapter 7
233
www.syngress.com

Back at the Wireless Network Connection Status screen, you have two remaining options.The
ﬁrst one is Disable, which is probably self-explanatory, but just to make sure, clicking this will actually
disable the wireless network card on the system.The second option is something quite new in Vista:
the Diagnose button. If you lose a connection for some reason, choosing Diagnose can help you ﬁnd
out what the problem is and where it lies.This is a powerful feature in Windows Vista since it allows
users to go beyond just knowing that the wireless network is down.This feature can allow users to
ﬁnd out in more detail what the problem may be and then they can relay it to the help desk.
Using Windows Connect Now and Creating a UFD
Windows Vista supports Windows Connect Now, which is quite useful in situations where you
have multiple systems you need to conﬁgure to connect to a wireless network. Using a USB ﬂash
drive (UFD) may be an option.This streamlines the wireless setup across multiple machines and keeps
the administrator from having to constantly input the passphrase, the SSID, and other information.
To set up a UFD, do the following:
1.
Go to the Network and Sharing Center in Windows Vista.
2.
In the Network and Sharing Center, click Set up a connection or network (as
shown in Figure 7.21).
Figure 7.21 Setting Up a Connection or Network
3.
Select Set up a wireless router or access point (as shown in Figure 7.22).
www.syngress.com
234
Chapter 7 • Managing the Wireless World and Its Security

Figure 7.22 Choosing a Connection Option
4.
You will now see an information screen about what the wizard will do (see Figure 7.23),
just click Next.
Figure 7.23 The Wizard Information Screen
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
235

The wizard will now try to ﬁnd a compatible access point, as shown in Figure 7.24, that it can
download information from and copy to the USB ﬂash drive. Linksys routers are not compatible with
this feature; therefore, you will see the screen in Figure 7.25. Do not fret; you can still create the UDF.
Figure 7.24 Detecting Network Hardware
Figure 7.25 Creating Settings and Saving to a USB Flash Drive
After Windows doesn’t detect a wireless hardware device, as shown previously, just click Create
wireless network settings and save to USB ﬂash drive. Now you should get a screen asking
www.syngress.com
236
Chapter 7 • Managing the Wireless World and Its Security

you for the SSID, as shown in Figure 7.26. For our example, we will type in PRACTICE since we
used it previously in our setup. Click Next.
Figure 7.26 Entering an SSID
The next screen will ask you for the passphrase, but it defaults to WPA. We are using WPA2-
Personal, but no problem. Just choose Advanced network security options at the bottom and the
screen shown in Figure 7.27 will appear. In the list of security methods, select WPA2-Personal and
enter the passphrase as thisis1coolrouter. Click Next.
Figure 7.27 Selecting the Security Method and Passphrase
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
237

You will now be asked to Choose ﬁle and printer sharing options (see Figure 7.28). For our
example, we will keep the default settings we already have.
Figure 7.28 File and Printer Sharing Options
Windows Vista will now ask you to insert your USB drive in the PC. It then gives you the
option of where you would like to save the settings. In our example, we are going to save this to the
G drive (see Figure 7.29). Click Next.
Figure 7.29 Selecting the Drive Letter of the USB Drive
www.syngress.com
238
Chapter 7 • Managing the Wireless World and Its Security

Windows Vista will now write the conﬁguration information to the USB ﬂash drive.After it has
ﬁnished, you will see the screen shown in Figure 7.30 informing you on how to distribute the UFD
to multiple systems.After you are satisﬁed that you understand how to install the settings using the
UFD, just click Close and you’re done.
Figure 7.30 The UFD Creation Is Complete
BEST PRACTICES ACCORDING TO MICROSOFT
Although using UFDs helps streamline the setup of multiple wireless clients,
Microsoft recommends using Group Policies for those systems that are members of
an Active Directory domain to better centrally manage wireless settings and their
deployments.
SOME INDEPENDENT ADVICE
If your laptops aren’t currently members of your existing Active Directory domain,
now is a good time to do it. Even by using a UFD, an administrator still loses control
of that data as soon as they physically pass it on to a user for them to install. You
also lose control of when the wireless networking is installed and conﬁgured. Using
Group Policies allows you to control the installation from beginning to end and at
what time. 
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
239

Setting Up an Ad Hoc Network
Ad hoc networks are created between two or more wireless PCs together, without the use of a wire-
less router or an access point.The computers communicate directly with each other.Ad hoc net-
works can be very helpful during meetings or in any location where a network doesn’t exist and
where people need to share ﬁles.An ad hoc network can also be useful in situations where only one
PC has Internet access and that access needs to be shared.To set up an ad hoc wireless network, do
the following:
1.
Go to the Network and Sharing Center and in the Tasks list, choose Set up a con-
nection or network.
2.
On the Set up a connection or network screen, choose Set up a wireless ad hoc
(computer to computer) network (as shown in Figure 7.31), and then click Next.
Figure 7.31 Choosing to Set Up an Ad Hoc Network
Now you will come to an information screen about ad hoc networks, as shown in Figure 7.32.
Click Next to continue.
You will now be asked for the network name, security type, and passphrase. In Figure 7.33,
notice we have chosen our network name to be Project-4, the security type to be WPA2-
Personal, and the passphrase to be thekeytoournetwork. If you plan on using this network in the
future, select Save this network. Windows automatically deletes the network either after the user
who set it up or all the other users disconnect. In our example, we will not be using this network
again so we don’t need to save it.After entering your information, click Next.
www.syngress.com
240
Chapter 7 • Managing the Wireless World and Its Security

Figure 7.32 The Ad Hoc Wizard Information Screen
Figure 7.33 Details about the Ad Hoc Network
Next you’ll come to the screen that informs you that your newly created ad hoc network is
ready for use (as shown in Figure 7.34). Click Close to complete the setup.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
241

Figure 7.34 Ad Hoc Network Setup Complete
As you see, setting up an ad hoc network is easy under Windows Vista, and in cases where mul-
tiple persons need to share resources and there is no networking infrastructure in place, or Internet
sharing through a single PC is required, an ad hoc network can do the trick.
www.syngress.com
242
Chapter 7 • Managing the Wireless World and Its Security

Summary
Microsoft has designed Windows Vista to provide better support for wireless networking that is more
closely integrated with the operating system than ever before.This provides improved stability and
reliability. Inside Windows Vista is a single wireless client, so regardless of the computer’s manufac-
turer it is consistent for users and IT personnel.
IEEE 802.11 is represented as its own media type in Windows, separate from 802.3, which now
allows features such as larger frame sizes to be taken advantage of. Windows Vista includes improve-
ments and added features to its wireless implementation with Single Sign-on, hidden wireless net-
work support, command-line conﬁguration capabilities, WPA2 support, integration with NAP, and
behavioral changes when no preferred wireless network is available.
The biggest concern for anyone involved with or using a wireless network is security. Users and
administrators must be aware of security issues in a wireless network and do their best to secure their
data in transit. Windows Vista’s wireless security improvements are dramatic compared to those of its
predecessors. Improvements such as passive and active countermeasures, connecting to unprotected
networks, improved ad hoc networking security, network location types, and extensibility via
EAPHost make Windows Vista the most secure wireless platform created by Microsoft.
Installation of wireless networks is becoming easier and easier. Setting up a wireless router for an
infrastructure mode network is just a matter of deciding on your SSID, the security mode you will
use, the encryption type, the passphrase (if required), and whether or not to broadcast the SSID.Ad
hoc setup is even easier, by just deciding on the name of the network, the security mode, and the
passphrase, you can be up and running in minutes with others ready to join you.
Windows Vista is a huge improvement when it comes to working with wireless.As administra-
tors, we can appreciate the consistency that Microsoft has pursued in this area. Wireless three years
ago was a nice thing to have—now it’s becoming more and more a necessity with businesses.
Administrators must keep up with the growing demand from their bosses for fast, secure, and reliable
wireless networks.
Solutions Fast Track
What’s New with Wireless in Vista?

Single Sign-on simpliﬁes network authentication while providing more convenience for
users.

The netsh wlan command and context can be used to conﬁgure wireless network settings
via a script.

WPA2 in Vista supports AES encryption, which is used by the U.S. government.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
243

Understanding Wireless Security in Vista

By disabling the Connect automatically when this wireless network is in range
option for a particular wireless network, you prevent Windows Vista from automatically
sending out probe requests that can be used by malicious users attempting to detect the
SSID of your network.

Before ever connecting to any unprotected network, such as one at a coffee shop, Vista will
warn the user of the risk.

Windows Vista supports WEP, WPA, WPA2, PEAP, PEAP-MS-CHAPv2, and EAP-TLS.
Installing a Wireless Network

Wireless protocols such as 802.11b, 802.11g, 802.11n (draft), and Bluetooth use the
2.4GHz frequency and are more susceptible to interference than 802.11a, which uses the
5GHz frequency.

A UFD can be created to help set up wireless on multiple systems connecting to the same
wireless network.

Ad hoc networking in Vista supports WPA2-Personal with AES, providing better security.
Q: Why does Microsoft recommend broadcasting my SSID from my access point instead of hiding
it?
A: If you have Vista set to automatically connect to a hidden wireless network, it will announce any
hidden network SSIDs it’s connected to and try connecting to those networks regardless of
where it is.That can be at an airport, hotel, coffee shop, even at the user’s home. By broadcasting
the SSID at the access point, you prevent this from happening.
Q: If 802.11a is less susceptible to interference, why aren’t we all using it?
A: 802.11a only supports a very short distance, so you would need to implement numerous access
points no further than 180 feet apart. Hardware for 802.11a is expensive; therefore, the cost may
not outweigh the beneﬁt.
Q: If I wanted to create a script for installing network settings, what would I use?
www.syngress.com
244
Chapter 7 • Managing the Wireless World and Its Security
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

A: You would need to use the netsh command within the wlan context.
Q: What is the preferred way of distributing wireless settings?
A: It depends on your situation.An enterprise may choose to implement settings via a script or
Active Directory group policies.Administrators of a small number of workstations may want to
use a UFD instead.
Q: What is so great about AES encryption?
A: It is the strongest encryption type available under Windows Vista wireless networking and is used
by the U.S. government for security purposes.
www.syngress.com
Managing the Wireless World and Its Security • Chapter 7
245


247
Managing 
Security Essentials
Solutions in this chapter:
■
Managing the Windows Firewall and IPSec
■
Managing Patching
■
Managing Malware Protection
■
Managing Internet Browser Security
■
Managing User Account Controls
Chapter 8
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
Keeping our computer systems secure has become part of our daily lives in Information Technology.
Keeping Microsoft Vista secure is no different—it is important for you as the administrator to protect
your users and data.This chapter will guide you through the essentials of how to keep your Microsoft
Vista system secure from possible attacks.You will learn how to run and conﬁgure a ﬁrewall to keep
attacks from reaching your PC, and ﬁnd out how to protect yourself from viruses and worms by
scheduling and patching your system on a regular basis. Furthermore, we will look at Internet secu-
rity and the various measures you can take to ensure your Internet browsing is secure. Knowing how
to keep your workstation secure is an essential and required task for any administrator.
Managing the Windows Firewall and IPSec
Microsoft released its ﬁrst ﬁrewall, the Internet Connection Firewall (ICF), for the desktop when it
released Windows XP. Most users were not even aware that ICF came with Windows XP because it
was turned off by default. Not until SP2 for XP did users become aware of the desktop ﬁrewall. SP2
brought what is now referred to as the Windows Firewall.The Windows Firewall that came with SP2
allowed network administrators to use Active Directory Group Policies to conﬁgure them. Group
Policies had numerous conﬁgurations that you could use with the Windows Firewall, such as speci-
fying which applications or ports to open and whether connections to those resources must be secure.
Windows XP with SP2 brought about signiﬁcant and needed changes in securing the desktop
with the Windows Firewall. Windows Vista has taken this even further by introducing the Windows
Firewall with Advanced Security.The Windows Firewall in Vista is a stateful, authenticating ﬁrewall
that provides more granular rules. It can block both incoming and outgoing trafﬁc. It fully supports
IPv6, is capable of using location-aware proﬁles, enforces network service hardening, and provides
integrated IPSec protection. In this section, we will examine how to conﬁgure and manage the
Windows Firewall with IPSec.Table 8.1 is a feature comparison of the Windows ﬁrewalls from SP2
of XP and Vista.
Table 8.1 The Windows Firewall in Vista versus XP
Feature
XP SP2
Vista
Protocols 
TCP, UDP, ICMP
Any Internet Assigned Numbers 
supported
Authority (IANA) IP protocols
Filtering direction
Inbound only
Inbound and outbound
Default ﬁltering 
Block 
Conﬁgurable for inbound and 
action
outbound trafﬁc
www.syngress.com
248
Chapter 8 • Managing Security Essentials
Continued

Table 8.1 continued The Windows Firewall in Vista versus XP
Feature
XP SP2
Vista
Rule types
Filter by port, application, 
Filter by any combination of 
or ICMP type
protocol, local or remote port
(TCP and UDP), ICMPv4 and v6
type and code, local or remote
IP addresses, interface types,
programs, services, and IPSec
metadata
Possible rule 
Allow only
Allow, block, and bypass
actions
Group Policy 
Via ADM ﬁles
Custom Group Policy extension 
support
snap-in that is the same as the
snap-in used to conﬁgure local
policies
Remote 
None
Microsoft Management Console 
management
(MMC) snap-in, netsh command,
APIs
User interface 
Control Panel tool and 
MMC snap-in, Control Panel 
and tools
netsh
tool, and netsh
APIs
Public Component Object 
Enhanced Public COM APIs
Model (COM) APIs
IPSec integration
None
IPSec-aware rules
Firewall proﬁles
Limited
Takes advantage of Windows
Vista’s Network Location
Awareness (NLA) feature; allows
the Windows Firewall to recon-
ﬁgure itself depending on the
category of connected network
it senses
IPv6
None
Full support
To better understand the features of the Windows Firewall in Vista, administrators need to
understand the Windows Filtering Platform (WFP) and how Windows Service Hardening (WSH) is
implemented.
Windows Filtering Platform
Windows Filtering Platform (WFP) is a new architectural component in Windows Vista that allows
access to the TCP/IP packet processing path.You now can examine or even modify outgoing and
incoming packets before they are allowed to be processed further. By doing this, independent soft-
ware vendors (ISVs) can create their own ﬁrewalls, antivirus software, diagnostic software, and other
www.syngress.com
Managing Security Essentials • Chapter 8
249

applications and services.The APIs in WFP allow ISVs to participate in ﬁltering decisions that take
place at different layers in the IP protocol stack. However, WFP is not a ﬁrewall; it is simply a set of
system services and APIs that enable ﬁrewalls to be developed. WFP creates a more stable environ-
ment, reducing the number of ﬁrewall and antivirus crashes. More detailed information on WFP is
available at http://msdn2.microsoft.com/en-us/library/aa366510.aspx.
Windows Service Hardening
Windows Service Hardening (WSH) is another new feature in Windows Vista and will be present in
Longhorn Server. It protects network services running on a system. If a service is attacked or com-
promised, WSH will reduce the possible damage by reducing the attack surface that malicious code
could exploit. WSH provides the following improvements over previous versions of Windows:
■
When possible, running services at a lower-privileged LocalService or NetworkService context
instead of LocalSystem, as was the case in previous Windows releases
■
Implementation of a new type of per-service security identiﬁer (Service SID) which
extends the access control model to services and the system resources they access
■
Implementing a write-restricted access token to the process for each service so that any
attempt to access a system resource that does not have an explicit allow access control entry
(ACE) for the Service SID will fail
■
Tighter control over svchost.exe groupings and distribution of services
■
A reduction in the number of privileges assigned to a service to only those needed by the
service
Just like the Windows Firewall, WSH uses rules to protect services in Windows Vista.The rules
are referred to as service restriction rules. Service restriction rules can specify on which ports a service
should listen or over which ports the service should send data.The rules add additional protection to
network services because network objects such as ports do not support access control lists (ACLs).
WSH rules restrict the trafﬁc that is allowed to and from a service, regardless of any administrator-
created ﬁrewall rules.
The rules WSH uses are also merged into the ﬁltering process.This happens when the Windows
Firewall decides whether to pass or drop a packet. It detects when a service restriction rule is
blocking trafﬁc and drops the packet accordingly, even if no ﬁrewall rule applies to the trafﬁc.
Firewall Proﬁles
The Windows Firewall that came with XP SP2 had two proﬁles: the Domain proﬁle and the
Standard proﬁle. Only one proﬁle was active at a time. Windows Vista expands ﬁrewall proﬁles to
three, with the active proﬁle at any given time being determined as shown in Table 8.2.
www.syngress.com
250
Chapter 8 • Managing Security Essentials

Table 8.2 Firewall Proﬁles
Proﬁle
Description
Domain proﬁle
Active only when the computer can authenticate with an Active
Directory domain controller. This proﬁle can be more or less
restrictive than the other two proﬁles depending on manage-
ment’s needs and the network security policy.
Private proﬁle
Active whenever the network type for all network connections
on the computer is identiﬁed as Private. Systems that are not
part of a domain are asked whether the network is Home,
Work, or Public. If the user selects either Home or Work, the
proﬁle is set to Private. Typically less restrictive than the Public
proﬁle because the network is trusted more than a public net-
work.  
Public proﬁle
Active when the system is not on a domain or private network.
Examples are an airport, coffee shop, or library. Considered the
most stringent of the ﬁrewall proﬁles.  
Windows Vista selects the proﬁle type with a feature called Network Location Awareness (NLA).A
set of APIs, NLA senses the state of each connection to a network on a system. It queries each net-
work to determine three things:
■
Connectivity state of the network A network might be connected to a local network
only, connected to a local network with Internet access, or completely disconnected from a
network.
■
Network interfaces used to connect to the network A multihomed system may be
connected to one network with a domain and to another without a domain.
■
Network location type The network may be a Public, Private, or Domain network.
NLA allows the Windows Firewall to switch among proﬁles as needed, without user interven-
tion. Here’s how it works. NLA uses a service called the Network Location service (NLASVC),
which monitors the local system for changes in its connectivity status. When a Windows Vista system
connects to a new network, the NLASVC assigns a globally unique identiﬁer (GUID) to the newly
connected network. If the NLASVC detects a change in network connectivity on the system, it noti-
ﬁes the Network List Service which then notiﬁes the Windows Firewall, indicating that the active
proﬁle should be changed. It typically takes 200 milliseconds for this change to occur.
Windows Firewall Setup 
The Windows Firewall in Vista defaults to the on position, so once the operating system is installed,
the ﬁrewall is active.As we stated earlier, the Windows Firewall with Advanced Security is a stateful,
host-based ﬁrewall that you can conﬁgure to allow or disallow trafﬁc that is generated by a particular
executable ﬁle or trafﬁc that is destined for one or more TCP or UDP ports.
www.syngress.com
Managing Security Essentials • Chapter 8
251

You’ll ﬁnd that the basic ﬁrewall conﬁguration tasks haven’t changed much between Windows
XP and Windows Vista; you’ll continue to make these changes using the Windows Firewall Control
Panel applet. But even this has been updated to make it more intuitive and informative for the end
user. When you open the Windows Firewall applet, the ﬁrst thing you see is a summary of your cur-
rent Windows Firewall settings, as shown in Figure 8.1.As you can see, this provides a summary of
the current state of the ﬁrewall; whether it is turned on or off, how exceptions and notiﬁcations are
being handled, and the network location to which the computer is currently connected. By clicking
Change settings, you’ll be taken to a familiar-looking interface that will actually allow you to make
changes, as shown in Figure 8.2.As you see in Figure 8.2, the settings have not changed since
Windows XP.
Figure 8.1 The Windows Firewall from the Control Panel
The Advanced tab in the Control Panel applet has had most of its functionality removed rela-
tive to Windows XP SP2. In XP SP2, the Advanced tab allowed you to conﬁgure settings for ﬁrewall
logging, to allow or disallow inbound ICMP trafﬁc, and to create exceptions on a per-interface basis.
The majority of these settings are now conﬁgured in the Windows Firewall and Advanced Security
console.As you can see in Figure 8.3, the Advanced tab in the Vista ﬁrewall allows you to do only
the following:
www.syngress.com
252
Chapter 8 • Managing Security Essentials

Figure 8.2 Basic Windows Firewall Settings
■
Enable or disable ﬁrewall protection on any of the network connections
■
Restore to the default settings
Figure 8.3 The Advanced Tab in the Windows Firewall Settings
www.syngress.com
Managing Security Essentials • Chapter 8
253

Built-In Firewall Exceptions
You use Windows Firewall Exceptions to control how programs communicate through the Windows
Firewall. Windows Vista has increased the number of exceptions available to administrators since
Windows XP, as shown in both Figure 8.4 and Table 8.3.
Figure 8.4 Firewall Exceptions
Table 8.3 List of Firewall Exceptions
Exception 
Description
BITS Peercaching
Allows Background Intelligent Transfer Service (BITS)
clients that are in the same subnet to be located and
share ﬁles that are stored in the BITS cache. Uses WSDAPI
and RPC.
Connect to a Network 
Enables users to connect to projectors over wired or 
Projector
wireless networks to project presentations. Also uses
WSDAPI.
Core Networking
Firewall rules that are required for reliable IPv4 and IPv6
connectivity.
Distributed Transaction Coordinates transactions that update transaction-
Coordinator
protected resources, such as databases, message queues,
and ﬁle systems.
www.syngress.com
254
Chapter 8 • Managing Security Essentials
Continued

Table 8.3 continued List of Firewall Exceptions
Exception 
Description
File and Printer Sharing Used for sharing local ﬁles and printers with other users
on the network. Uses NetBIOS, SMB/CIFS, and RPC.
FTP Server
Enables/disables ﬁrewall rules for the FTP server.
iSCSI Service
Used for connecting to iSCSI target servers and devices.
Media Center Extenders Allows Media Center Extenders to communicate with a
computer running Windows Media Center. Uses SSDP and
qWAVE.
Network Discovery
Allows the computer to discover other devices and be
discovered by other devices on the network. Uses
Function Discovery Host and Publication Services, UPnP,
SSDP, NetBIOS, and LLMNR.
Performance Logs 
Allows remote management of Performance Logs and 
and Alerts
Alerts. Uses RPC.
Remote Administration Allows remotely manageable services to receive RPC
trafﬁc. Uses Named Pipes and RPC.
Remote Assistance
Allows users of the computer to request remote assis-
tance from other users on the network. Uses UPnP, SSDP,
and Teredo.
Remote Desktop
Used for accessing the desktop from a remote system.
Remote Event Log 
Allows remote viewing and management of the local 
Management
event log. Uses Named Pipes and RPC.
Remote Scheduled 
Allows remote management of the local task scheduling 
Tasks Management
service. Uses RPC.
Remote Service 
Allows remote management of local services. Uses 
Management
Named Pipes and RPC.
Remote Volume 
Provides remote software and hardware disk volume 
Management
management. Uses RPC.
Routing and Remote 
Used to allow incoming VPN and Remote Access Server 
Access
(RAS) connections.  
SNMP Trap
Receives trap messages generated by local or remote
SNMP agents and forwards them to an SNMP manage-
ment program running on the local computer.  
Windows Collaboration Allows other computers to ﬁnd and communicate with 
Computer Name 
your computer using the Peer Name Resolution Protocol 
Registration Service
(PNRP) and SSDP.
Windows Firewall 
Allows remote management of the local Windows 
Remote Management
Firewall. Uses RPC.
www.syngress.com
Managing Security Essentials • Chapter 8
255
Continued

Table 8.3 continued List of Firewall Exceptions
Exception 
Description
Windows Management Allows remote management of Windows by exposing a 
Instrumentation (WMI)
set of manageable components in a set of classes deﬁned
by the Common Information Model (CIM) of the dis-
tributed management task force. Uses the Distributed
Component Object Model (DCOM).
Windows Media Player
Allows users to receive streaming media over UDP.
Windows Media 
Enables users to share media over a network using 
Player Network 
UPnP, SSDP, and qWave.
Sharing Service
Windows Meeting 
Used for collaborating over a network to share 
Space
documents, programs, or even your desktop with others.
Uses DFSR and P2P.
Windows Peer to Peer 
Is required to enable various peer-to-peer programs and 
Collaboration 
technologies. Uses SSDP and PNRP.
Foundation
Windows Remote 
Allows remote management of the system via 
Management
WS-Management.
Wireless Portable 
Allows the transfer of media from your network-enabled 
Devices
camera or media device to your PC using the Media
Transfer Protocol (MTP). Uses UPnP and SSDP.
In addition to the built-in ﬁrewall exceptions we just discussed, you can also create additional
ﬁrewall exceptions to allow inbound trafﬁc to pass through the Windows Firewall. In many cases,
these manual exceptions will be created automatically by the installer for a particular program; other-
wise, you’ll need to manually specify them from the Exceptions tab.The two types of exceptions you
can create are:
■
Port exceptions Allow incoming trafﬁc destined for particular TCP or UDP ports.
■
Program exceptions Allow all incoming trafﬁc that is destined for a particular exe-
cutable ﬁle running on the local workstation, which typically corresponds to a service run-
ning on the local computer.
Let’s run through an example for creating a program exception. In the Control Panel, pull up the
Windows Firewall and then click Change settings. Go to the Exceptions tab of the Windows
Firewall Settings screen, as you saw back in Figure 8.4, and click Add program, located at the
bottom of the screen.You should now be at the Add a Program screen, as shown in Figure 8.5.
www.syngress.com
256
Chapter 8 • Managing Security Essentials

Figure 8.5 Creating an Exception
By default, any new exception that you create will be accessible by any computer, including
those on the Internet.To restrict the scope of an exception that you’ve created, click on the Change
scope button.You’ll be presented with the screen shown in Figure 8.6, which will allow you to set
one of the following three scopes:
■
Any computer (including those on the Internet) Allows any computer on any net-
work to access this program, including systems located on the Internet.
■
My Network (subnet) only The exception will be accessible only by systems on the
same subnet.
■
Custom List You can specify a list of individual IP addresses or ranges and their associ-
ated subnet masks; separate multiple entries with commas. For example, you can allow an
exception for an entire range of clients plus an administrative workstation as follows:
192.168.1.146/255.255.255.255, 192.168.2.0/255.255.255.0
Figure 8.6 Changing Scope
Managing Security Essentials • Chapter 8
257
www.syngress.com

To create a port exception, you’ll likewise click the Add port button when creating the excep-
tion. Creating a port exception requires the following information:
■
Name A descriptive name for the exception, such as “HTTP”.
■
Port  Port number of the exception.
■
TCP/UDP Whether the exception corresponds to a TCP or UDP port.
■
Scope After clicking Change scope, you specify the scope of the exception just as you
would for a program exception.
Managing the Windows Firewall for Enterprises
Although you can manage desktop ﬁrewalls via the Control Panel applet, as we’ve just shown, conﬁg-
uring it for the enterprise requires an advanced approach and the tools to achieve that. Windows
Vista now has new and improved tools for managing the Windows Firewall.Those tools are:
■
Windows Firewall with Advanced Security Snap-In
■
Windows Firewall with Advanced Security node in Group Policy
■
The advﬁrewall context of the netsh command
■
Newly available COM APIs
Windows Firewall with Advanced Security Snap-In
Microsoft has created the Windows Firewall with Advanced Security snap-in so that administrators
can manage nearly all aspects of the Windows Firewall on either the local PC or a remote one. Using
the Windows Firewall with Advanced Security snap-in is pretty easy. Click Start | Control Panel
| Administrative Tools | Windows Firewall with Advanced Security.You will see the
Windows Firewall with Advanced Security console, as shown in Figure 8.7.
Figure 8.7 The Windows Firewall with Advanced Security Console
258
Chapter 8 • Managing Security Essentials
www.syngress.com

To use the Windows Firewall with Advanced Security snap-in to manage the Windows Firewall
on a remote computer, do the following:
1.
Log on to your workstation with an account that has administrator rights on the remote
system. If you are a member of the Domain Admins group this will sufﬁce.
2.
Enable remote management of the Windows Firewall on the remote system.You can do
this in any of the following ways:
■
When logged on to the remote system, use the Windows Firewall from the Control
Panel on the remote computer to enable the Windows Firewall Remote Management
rules.
■
Use the Windows Firewall with Advanced Security snap-in on the remote system to
enable all rules for the active proﬁle that belong to the Windows Remote
Management rule group.
■
Open a command prompt with administrator rights and type netsh advﬁrewall ﬁre-
wall set rule group=”Windows Firewall Remote Management” enable=yes.
Using the netsh advﬁrewall set rule command will enable or disable a rule group for all
ﬁrewall proﬁles. We’ll cover netsh and advﬁrewall a little later.
■
Open the Windows Firewall Remote Management rule group via Group Policy on
the remote system.
3.
On the management system, click Start | Control Panel | Administrative Tools |
Windows Firewall with Advanced Security.
4.
Select the option Another Computer in the Select Computer dialog box, and then
click Browse to ﬁnd the remote system in Active Directory. Once the remote computer
name is populated in the Another Computer ﬁeld, click Finish and then OK.
The main screen of the snap-in provides a view of the three available ﬁrewall proﬁles, as well as a
visual indicator of which proﬁle is active. In Figure 8.7, you see that the Domain Proﬁle is Active on
our system.The Vista ﬁrewall allows you to create different ﬁrewall settings for the each proﬁle type
we mentioned earlier in the chapter: Domain, Private, and Public. Referring back to Figure 8.7, the
default Windows Firewall settings are similar for all three proﬁles:The Windows Firewall is turned
on, inbound connections that do not have a deﬁned exception are blocked, and all outbound trafﬁc is
permitted.To customize this default behavior for one or more proﬁles, click on the Windows Firewall
Properties link underneath Actions on the right; you’ll see the screen shown in Figure 8.8. From
here, you can change the ﬁrewall state from on to off, and change the behavior for inbound and out-
bound connections.You can change the behavior for inbound connections to one of the following:
■
Block Blocks any inbound connection attempt that doesn’t have an exception associated
with it.This is the default setting for inbound connections on all three ﬁrewall proﬁles.
■
Block all connections Blocks all incoming connection attempts regardless of whether
there is a rule associated with them; corresponds to the Block all incoming connections
checkbox in the Windows Firewall Control Panel applet.
■
Allow Allows any inbound connection attempt.
www.syngress.com
Managing Security Essentials • Chapter 8
259

You can set outbound connections to Block or Allow (Default).
Figure 8.8 Customizing Windows Firewall Settings
Clicking Customize under the Settings header will allow you to conﬁgure the following:
■
Whether to display a notiﬁcation when the Windows Firewall blocks an incoming connec-
tion. By default, notiﬁcations are enabled for all three ﬁrewall proﬁles.
■
Whether to allow a unicast response to broadcast or multicast trafﬁc.This is permitted by
default in all three ﬁrewall proﬁles. Disabling this feature does not interfere with the opera-
tion of a DHCP server, as the Windows Firewall always permits responses to DHCP mes-
sages. It will, however, interfere with network discovery protocols such as NetBIOS, SSDP,
and WSDAPI.
Clicking Customize under the Logging header will allow you to conﬁgure these settings:
■
The name, size, and location of the logﬁle. By default, the ﬁle is located at
%systemroot%\system32\LogFiles\Firewall\pﬁrewall.log and has a maximum size of 4,096 KB.
■
Whether to log dropped packets and/or successful connection within the logﬁle. By
default, neither dropped packets nor successful connections are logged within any of the
three ﬁrewall proﬁles.
The last tab you see in Windows Firewall with Advanced Security is the one for IPSec settings.
We’ll cover IPSec later in this chapter.
www.syngress.com
260
Chapter 8 • Managing Security Essentials

Windows Firewall with 
Advanced Security Node in Group Policy
Managing the Windows Firewall through Group Policies isn’t that different from managing it via the
Windows Firewall with Advanced Security tool, with the exception of the monitoring node and its
subnodes missing in Group Policies.To pull up the Group Policies just select Start | Run and type
gpedit.exe. In the Group Policy Object Editor, select Computer Conﬁguration | Windows
Settings | Security Settings | Windows Firewall with Advanced Security and you will see
the same settings you saw with the Windows Firewall with Advanced Security console. Figure 8.9
shows the Group Policy Object Editor highlighting the Windows Firewall with Advanced Security
settings.
Figure 8.9 The Group Policy Object Editor
Managing the Windows Firewall with netsh
You can manage the Windows Firewall using the netsh command along with the advﬁrewall context.
To manage the Windows Firewall via netsh, open a command window with administrative credentials
and run netsh. Figure 8.10 shows the advﬁrewall context of netsh.
www.syngress.com
Managing Security Essentials • Chapter 8
261

Figure 8.10 netsh and advﬁrewall
Once in the advﬁrewall context, you can use any of the commands in Table 8.4 to manage the
Windows Firewall.
Table 8.4 netsh and advﬁrewall Context
Command
Description
Consec
Allows you to display and conﬁgure connection security rules.
Dump
Displays a conﬁguration script.
Export
Exports the current Windows Firewall policy to the speciﬁed
ﬁle.
Firewall
Allows you to display and conﬁgure inbound and outbound
ﬁrewall rules.
Import
Imports the Windows Firewall policy from the speciﬁed ﬁle.
Monitor
Allows you to display monitoring settings.
Reset
Restores the Windows Firewall conﬁguration to its out-of-the-
box policy.
Set
Sets global or per-proﬁle settings. Use set ﬁle to copy the con-
sole output to a ﬁle; use set machine to set the current com-
puter on which to operate.
Show
Displays global settings and the properties for the speciﬁed
proﬁle or for all proﬁles.
Using Scripts to Manage the Windows Firewall
As we mentioned at the beginning of this section, Microsoft has included newly available COM APIs
in Windows Vista. Because of this, you can programmatically manage the Windows Firewall using
www.syngress.com
262
Chapter 8 • Managing Security Essentials

scripts you create.Although discussing the actual code for doing this is beyond the scope of this
book, it is important to know that this capability is available.To learn more check out http://win-
dowssdk.msdn.microsoft.com/en-us/library/aa366459.aspx.
Creating Firewall Rules
Now that you understand the different ways to manage the Windows Firewall in Vista, we will dis-
cuss each type of rule you can create.There are four rule types from which to choose:
■
Program Creates a rule that is associated with a particular executable ﬁle, similar to the
Add Program option on the Exceptions tab of the Windows Firewall Control Panel applet.
■
Port Creates a rule associated with a network port, similar to the Add Port option in the
Windows Firewall Control Panel applet.
■
Predeﬁned Creates a rule associated with one of the services that have been predeﬁned
within the Windows Vista ﬁrewall, such as BITS Peercaching, or Network Discovery.
■
Custom Creates a custom rule when none of the preconﬁgured choices is appropriate for
your needs.
Let’s walk through creating an inbound ﬁrewall rule.The method of creating outbound rules is
very similar, so we will not go over that. In this example, we’ll be using the Windows Firewall with
Advanced Security console.
To create a new rule, right-click on Inbound Rules and select New Rule, as you can see in
Figure 8.11.
Figure 8.11 Adding a New Rule
www.syngress.com
Managing Security Essentials • Chapter 8
263

When you see the screen shown in Figure 8.12, click Next.
Figure 8.12 Choosing the Rule Type to Create
You are given the choice of applying the inbound rule to All programs or naming one by
clicking on This program path.As you can see in Figure 8.13, for our example we chose iex-
plore.exe. Click Next.
You are asked to choose what action should be taken when a connection matches the speciﬁed
conditions. In our example, we chose Allow the connection, as you see in Figure 8.14.This will
allow connections that have been protected with IPSec as well as those that have not. Choose Next.
www.syngress.com
264
Chapter 8 • Managing Security Essentials

Figure 8.13 Choosing a Speciﬁc Program
Figure 8.14 Choosing the Action to Take
www.syngress.com
Managing Security Essentials • Chapter 8
265

The next step is to choose what proﬁle(s) to apply to our new rule. Remember, you can choose
from Domain, Private, Public, or all three.As you see in Figure 8.15, we chose Domain. Click Next.
Figure 8.15 Choosing the Proﬁle to Apply the Rule
Now you need to give your rule a name and a description (if you want). In Figure 8.16, we
named our rule IE-Rule and gave it the description Rule designed to show how to create
inbound rules. Click Next when you’re done.
As you see in Figure 8.17, our newly created rule, IE-Rule, is listed in Inbound Rules in the
Windows Firewall with Advanced Security window.
www.syngress.com
266
Chapter 8 • Managing Security Essentials

Figure 8.16 Providing a Name and Description for the New Rule
Figure 8.17 The New Inbound Rule Listed
www.syngress.com
Managing Security Essentials • Chapter 8
267

Monitoring the Firewall
Using the Windows Firewall with the Advanced Security MMC snap-in, administrators now have
access to real-time ﬁrewall conﬁguration information that can be invaluable when troubleshooting
connectivity issues on Vista workstations. Simply open the MMC snap-in and select Monitoring in
the left-hand pane, as shown in Figure 8.18.
Figure 8.18 The Monitoring Section
From the main Monitoring screen, you will see an at-a glance summary of your current ﬁrewall
settings, describing the overall state of the ﬁrewall, which proﬁle is active, as well as notiﬁcation and
logging settings.You also have the ability to drill down to a detailed view of any of the following:
■
Active ﬁrewall rules
■
Active security connection rules
■
Active IPSec security associations (SAs)
In Figure 8.19, you can see the information that is displayed when you drill down to the Firewall
node: which ﬁrewall rules are currently active, as well as speciﬁc details of each rule, including the
name of the rule, the action associated with that rule (allow, secure, block), and whether it is an
inbound or an outbound ﬁrewall rule.
www.syngress.com
268
Chapter 8 • Managing Security Essentials

Figure 8.19 Monitoring the Windows Firewall
IPSec Integration
Possibly the biggest enhancement of the Windows Firewall is the integration of IPSec with ﬁrewall ﬁl-
tering. Microsoft has updated the ability to process and create IPSec policies in Windows Vista and has
reduced the number of rules required to create a useful IPSec policy. Now updates to IPSec policy
integration and the integration of IPSec into the Windows Firewall greatly simpliﬁes the creation and
maintenance of IPSec ﬁlters and rules for different network protection scenarios.Administrators no
longer have to create IPSec ﬁlters and rules using the IPSec Security Policy Management snap-in, and
instead can create connection security rules using the Windows Firewall with Advanced Security to
conﬁgure IPSec policy protection on the computer. Now the Windows Firewall with Advanced
Security is the central tool for managing both ﬁrewall rules and IPSec policies.
New IPSec Features
The new user interface for managing IPSec policies isn’t the only enhancement for IPSec in
Windows Vista.Additional enhancements include the following:
■
New cryptographic and data integrity algorithms, credential types, and authentication
methods
■
AuthIP
www.syngress.com
Managing Security Essentials • Chapter 8
269

■
Negotiation discovery
■
NIST Common Criteria (CC) compliance
■
Fully integrated Domain IPSec and Group Policy stored in .pol ﬁles on sysvol
New Cryptographic and Data Integrity Algorithms
Table 8.5 lists the encryption algorithms supported for IPSec in Windows Vista, and Table 8.6 lists
data integrity algorithms. Figure 8.20 shows the customize IPSec settings available through the
Windows Firewall with Advanced Security.
Table 8.5 Encryption Algorithms
Algorithm
Description
AES-256
Provides the strongest security, yet causes the highest level of
resource usage. Not backward-compatible with anything before
Windows Vista.
AES-192
Provides less security than AES-256, but also uses fewer
resources. Not backward-compatible with anything before
Windows Vista.
AES-128
Provides less security than both AES-256 and AES-192, but uses
fewer resources than both. Not backward-compatible with any-
thing before Windows Vista.
3DES
Sometimes referred to as the “triple” Data Encryption Standard
(DES). Less secure than AES, but is backward-compatible with
Windows XP and Windows Server 2003.
DES
Least secure method available. Does provide backward 
compatibility.
Table 8.6 Data Integrity Algorithms
Algorithm
Description
SHA1
Supported in Windows Vista, XP, and Server 2003. Stronger than
MD5.
MD5
Least secure method. Just like DES, it is provided for backward
compatibility only.
www.syngress.com
270
Chapter 8 • Managing Security Essentials

Figure 8.20 Customizable IPSec Settings in the Windows Firewall
You use IPSec key exchange to establish authentication and data encryption between two com-
puters.This process is divided into two phases: Main Mode and Quick Mode. In Main Mode, the two
computers that are communicating use the IKE protocol to set up a secure, authenticated channel
between them.This process creates a Main Mode SA.You’ll sometimes also hear this referred to as a
PhaseI SA.
Main Mode Algorithm Order
During IPSec key exchange, known as Main Mode in Windows Vista, the order in which encryption
and data integrity algorithms are tried under the default IPSec conﬁguration is as follows:
■
AES-128 for encryption and SHA1 for data integrity
■
3DES for encryption and SHA1 for data integrity
Quick Mode Algorithm Order
Phase 2 of the IKE process provides for the integrity and/or encryption of the data that’s being trans-
mitted between two computers that have established a Main Mode SA. Windows Vista tries the
methods of data protection in the following order to secure network trafﬁc using IPSec:
www.syngress.com
Managing Security Essentials • Chapter 8
271

■
Order of methods tried when data integrity only is conﬁgured (no encryption):
■
ESP using SHA1 for integrity
■
AH using SHA1 for integrity
■
Order of methods tried when both data integrity and encryption are conﬁgured:
■
ESP using SHA1 for integrity and AES-128 for encryption
■
ESP using SHA1 for integrity and 3DES for encryption
Table 8.7 lists available key exchange algorithms.
Table 8.7 Key Exchange Algorithms
Algorithm
Description
Elliptic Curve Difﬁe-Hellman P-384
Provides the strongest security, yet uses the
most resources. Not backward-compatible.
Elliptic Curve Difﬁe-Hellman P-256
Is less secure than P-384, and is not back-
ward-compatible.
Difﬁe-Hellman Group 14
Supported in Windows Vista, XP, and Server
2003.
Difﬁe-Hellman Group 1
Provided only for backward compatibility.
Authentication Method
The authentication method settings determine how two computers will authenticate one another in
order to create an IPSec SA.The default authentication method is Computer (using Kerberos V5),
but you can choose any of the preconﬁgured methods in Table 8.8.
Table 8.8 Authentication Methods
Authentication Method
Description
Computer and User 
Requires both computer and user 
(using Kerberos V5)
authentication for the two computers to
communicate.
Computer (using Kerberos V5)
Only requires that the computer account
authenticate before communication can take
place. The computer must be a member of
the same Active Directory domain or in a sep-
arate domain that has a trust relationship
conﬁgured.
www.syngress.com
272
Chapter 8 • Managing Security Essentials
Continued

Table 8.8 continued Authentication Methods
Authentication Method
Description
User (using Kerberos V5)
Requires authentication from the user who is
logged on to the remote computer; the user
must belong to the same Active Directory
domain or a trusted domain.
Computer certiﬁcate from this 
Will authenticate computers using certiﬁcates 
certiﬁcate authority
issued by a particular certiﬁcate authority
(CA). Useful if you need to allow IPSec trafﬁc
to nondomain computers. Can further specify
that this method will accept only health cer-
tiﬁcates, which the NAP service uses to con-
ﬁrm that a computer that is requesting a
connection is up-to-date on patches, antivirus
deﬁnitions, and other health checks.
IPSec authentication can take place in two steps.The ﬁrst authentication method describes
how the computer account is authenticated, and the second authentication method describes user
authentication.Table 8.9 lists the authentication methods available for the ﬁrst authentication and
Table 8.10 does the same for the second authentication.
Table 8.9 First Authentication and Its Authentication Methods
Authentication Method
Description
Computer (Kerberos v5)
Uses a computer account in Active Directory to
authenticate the computer using Kerberos. This is the
default method used for ﬁrst authentication. Both sys-
tems must belong to the same Active Directory
domain or to trusting domains.
Computer (NTLMv2)
Uses a computer account for a standalone computer
or a computer belonging to a down-level Windows
domain to authenticate the computer using NTLMv2.
Computer (Certiﬁcate)
Uses a computer certiﬁcate from a speciﬁed CA to
authenticate the computer.  
Preshared key
Uses a secret preshared key to authenticate the com-
puter. The key must be manually conﬁgured.
www.syngress.com
Managing Security Essentials • Chapter 8
273

Table 8.10 Second Authentication and Its Authentication Methods
Authentication Method
Description
User (Kerberos v5)
Uses a computer account in Active Directory to authen-
ticate the user using Kerberos. The default method for
second authentication.
User (NTLMv2)
Users a user account for a standalone computer or a
computer belonging to a down-level Windows domain
to authenticate the user using NTLMv2.
User (Certiﬁcate)
Uses a certiﬁcate from a speciﬁed CA to authenticate
the user.
Computer (Health 
Uses a computer certiﬁcate from a speciﬁed CA to 
Certiﬁcate)
authenticate the computer.  
What Is AuthIP?
A new key exchange protocol was created that extends the IKE protocol IPSec uses to negotiate SAs
for the purpose of protecting AH and ESP trafﬁc.That new key exchange protocol is Authenticated
Internet Protocol (AuthIP).AuthIP is an extension of the present IKE but provides additional sup-
port for transport mode to make it more efﬁcient. It was designed to simplify the key exchange pro-
cess by reducing the amount of complexity and the number of round trips required.
AuthIP performs mutual authentication between two peers. It establishes an SA that you can use
to further establish SAs for both ESP and AH trafﬁc. It is a request/response protocol, meaning that
the initiating peer sends a message to the responding peer.The responding peer then returns a mes-
sage to the initiating peer.AuthIP is typically used to negotiate ESP transport-mode trafﬁc between
two peers, but you can also use it to protect AH trafﬁc.
Negotiation Discovery
Windows Vista has the capability to determine whether it needs to use IPSec to protect a TCP con-
nection even when no prior SA exists with the responder.This is called Negotiation Discovery and it is
a new feature in Windows Vista. Negotiation Discovery resolves the delay that existed in Windows
XP. XP supported a method known as the default responder, in which the initiator would send its
request in the clear. If the responder required IPSec the responder would have to accept the unse-
cured inbound packet. If it didn’t do this, trafﬁc would continuously travel in the clear between the
peers.This was known as fallback to clear, which allowed outbound trafﬁc to ﬂow even if IKE authen-
tication failed.This often took a relatively long time (about three seconds) and caused delays in estab-
lishing IPSec communication.
Negotiation Discovery eliminates this delay problem. It does so by having the initiator simultane-
ously start a TCP session with the responder, and then begin negotiating an IKE session.This guaran-
tees that client-initiated trafﬁc succeeds and eliminates the three-second delay that was experienced
with fallback to clear.
www.syngress.com
274
Chapter 8 • Managing Security Essentials

NIST Common Criteria
By enabling the Windows Firewall to log audit events to the Security event log along with the
default ﬁrewall log.The Windows Firewall in Windows XP SP2 and Windows Server 2003 SP1
keeps ﬁrewall log information in two locations:
■
%windir%\Pﬁrewall.log
■
Security event log
The problems with this scenario are that it is difﬁcult to troubleshoot Windows Firewall connec-
tivity issues, and you are not compliant with the Common Criteria.The Common Criteria state that
all security auditing needs to be comprehensive and contain all security-oriented events.They also
mandate that if auditing cannot be performed, the system fails. For example, if the audit log becomes
full—a condition known as CrashOnAuditFail—the Pﬁrewall.log ﬁle doesn’t satisfy these two criteria.
On the other hand, the Windows Security event log does.Therefore, all logging of both ﬁltering and
policy happens in the Security event log, complying with the Common Criteria requirements, which
makes it easier for enterprises in the government, healthcare, and ﬁnancial industry sectors.
NOTE
Windows Vista allows administrators to continue using Pﬁrewall.log, although it is
now stored in %windir%\system32\LogFiles\Firewall\Pﬁrewall.log.
Domain IPSec Policy Fully Integrated with Group Policy
The Domain IPSec policy fully integrates with Group Policies and is stored on the sysvol of domain
controllers in Active Directory. It is easier now to manage ﬁrewall rules and IPSec ﬁlters along with
rules in an Active Directory domain using Group Policies. IPSec policy also inherits from the
dynamic per-proﬁle approach to the Windows Firewall. Just like ﬁrewall rules, you can have different
IPSec policies per proﬁle.
Managing Patching
Regularly updating the applications, operating system (OS), and drivers on your desktop and server
systems is an essential part of being a system administrator. If you have ever been in the position of
having to administer a large group of desktop and server systems, you know that patch management
is one of the most tedious and frustrating pieces to the security puzzle. It is also one of the most
important and, unfortunately, overlooked pieces.
We need to be diligent in patching the systems we manage throughout our organization, but indi-
vidual users also need to make sure they are keeping their home systems up-to-date and secure.
Although it seems like we’ve got all the assets we need to worry about within the walls of our ofﬁce,
those home systems are an important aspect of organizational security, the security of individuals’ per-
sonal information, and the security of the Internet in general. If those systems are left open to be com-
www.syngress.com
Managing Security Essentials • Chapter 8
275

promised, a great deal of personal data is at risk.Also, those in charge of the security of an enterprise
risk being attacked by home systems.We give the attacker a valuable starting point toward breaking
into our work environment if we leave our PC systems at risk. How many of us have a laptop that we
bring home from work and plug directly into our home network, and then link back to our work
network with a virtual private network (VPN)? If the system at home is compromised, and an attacker
is able to start logging passwords used on that machine, the attacker will quickly build a bank of
working credentials to use in attacks.We quickly begin to see the importance of keeping our systems
patched and why there has been such a push toward building a better software update system.
Microsoft has long held a majority of the market share for desktop OSes, and because of
widespread use of its software, it ﬁnds itself under constant attack by malicious individuals and under
continual scrutiny from users, administrators, and security research groups. Windows Update was
brought into existence to provide an easy way to apply updates, but several problems with the system
are now evident.The ﬁrst problem lies with the home users who should be updating their systems on
a regular basis, but in reality rarely check the Windows Update site for patches.The second problem
lies with the system administrators who are in the awful position of either setting the system to auto-
matic updates and hoping a patch doesn’t incapacitate their users’ systems, or spending a lot of man-
power to manually update the systems under their control. It took events such as SQL Slammer to
expose the ﬂaws in enterprise patch management systems, since it showed that a security update for a
known vulnerability is worth very little if most of the population doesn’t go to the Windows Update
Web site to install it.
Notes from the Underground…
A History Lesson 
Table 8.11 shows some of the more destructive worms in recent history and the
amount of time users and administrators had to patch their systems. We can’t decide
which is more disheartening—the fact that some of these worms were in the wild in
such a short amount of time, or the fact that users had four to six months to patch
their systems prior to the release of the worms. The increasingly short time between
the announcement of a vulnerability and the release of a worm exploiting it illustrates
the importance of timely patching our Windows systems.
Table 8.11 Destructive Worms
Worm Public 
Worm
Discovery
Bulletin Date
Days to Patch
Sasser
April 30, 2004
April 13, 2004
17 days
MS Blaster
August 11, 2003
July 16, 2003
26 days
SQL Slammer
January 24, 2003
July 24, 2002
184 days
www.syngress.com
276
Chapter 8 • Managing Security Essentials
Continued

Table 8.11 continued Destructive Worms
Worm Public 
Worm
Discovery
Bulletin Date
Days to Patch
Nimda
September 18, 2001 May 16, 2001
125 days
Code Red
July 16, 2001
June 18, 2001
28 days
Microsoft provides the user with a very capable OS update system built into the OS through
Windows Update.The Windows Update system provides updates for the Windows kernel, as well as
any number of userland applications considered part of the base OS: Internet Explorer, Windows
Media Player (WMP), Outlook Express, and so on. Windows Update mostly provides security and
other critical updates, but new versions of WMP and Internet Explorer are pushed out through the
system as well when new versions of these products are available. Microsoft will also push Service
Packs (updates to the Windows software that ﬁxes existing problems and, in some cases, delivers
product enhancements), Update Rollups, and Feature Packs through the Windows Update system. In
addition, we can, if we are so inclined, update signed hardware drivers.
Windows Update has been around for many versions of Windows, but the earlier versions were
rarely used by home users and were reserved mostly for use in the corporate world. If a home user’s
computer had patches applied, it was either immediately after the initial install or because an SP was
released. When Windows XP Service Pack 2 was released, Microsoft implemented a notiﬁcation
system to inform users when automatic updates and other security software weren’t enabled, as well
as notifying users when new updates were available for download or installation.
Windows Update Settings
The Windows Update mechanism in Vista operates very similarly to XP SP2, but with a few differ-
ences. Vista will give you a choice of three options during installation.These options not only relate
to update settings, but also encompass error reporting, driver installation, and antispyware protection.
Table 8.12 is a matrix of the options available, and the ultimate outcome of your choice.
Table 8.12 Security Settings during Windows Vista Installation
Setting
Description
Use recommended settings.
Windows will download and install important as
well as recommended updates. Windows
Defender Anti-Spyware will be enabled and the
user will be automatically enrolled in Microsoft
SpyNet. Windows will also automatically check
for drivers when new hardware devices are
installed and, when errors occur, will send error
reports to Microsoft and check for solutions
online.
Install important updates only.
Windows will download and install security and
other important updates only.
www.syngress.com
Managing Security Essentials • Chapter 8
277
Continued

Table 8.12 continued Security Settings during Windows Vista Installation
Setting
Description
Ask me later
Neither of the preceding options will be set, and
automatic updating will be turned off. Windows
will ask you what you’d like to do once installa-
tion is completed and you have logged in for
the ﬁrst time.
After installation, or on an existing installation, you can change these settings through the
Windows Update Control Panel applet, as shown in Figure 8.21.
Figure 8.21 Accessing the Windows Update Control Panel Applet 
You can reach the Windows Update Control Panel applet by following these steps:
1.
Go to Start | Control Panel.
2.
Select Classic View on the right.
3.
Double-click Windows Update.
Alternatively, you can reach the Windows Update Control Panel applet through the new
Windows Vista Control Panel layout in the Security Center.The new layout is nice, because it groups
related items together, such as the security-related items under the Security Center. But using the new
layout will add an extra click when you’re trying to reach speciﬁc items, such as Windows Update. In
the end, it becomes a personal choice, but we prefer a more familiar layout with fewer clicks.
www.syngress.com
278
Chapter 8 • Managing Security Essentials

You may notice that the Windows Update Control Panel applet is very different from what
Windows XP offered. First, you now have access to all aspects of updating from one main screen. In
previous versions, the Windows Update Control Panel applet was reserved for one task: to set
whether you wanted to use automatic updating, and on what schedule you wanted the service to
operate. Gone are the days of visiting the Windows Update Web site and dealing with installing
ActiveX controls and browser settings in order to apply updates manually.This is a boon for adminis-
trators who wish to limit their end users’ ability to install potentially malicious ActiveX controls on
their systems. We also gain the ability to view our update history and, possibly the greatest addition of
all, uninstall updates.
You can change Windows Update settings by selecting Change Settings from the main
Windows Update screen.You will be presented with the Change Settings window (see Figure
8.22), where you’ll see familiar automatic update choices.
Figure 8.22 Changing Windows Update Settings 
Installing Updates Automatically 
The Install Updates Automatically (Recommended) option will automatically check for new updates,
download those updates that are pertinent to your system, and, according to the schedule you specify,
install those updates.To use this option, follow these steps:
1.
Select the Install updates automatically (recommended) radio button.The scheduling
options will no longer be grayed out.
www.syngress.com
Managing Security Essentials • Chapter 8
279

2.
Choose Every day at Speciﬁed Time (12 A.M. to 11 P.M.) to install new updates every
day, or choose Every (Speciﬁc Day) to install new updates only once a week .
3.
Select the Include recommended updates when downloading, installing, or noti-
fying me about updates checkbox, under the Recommended updates section, if you
want recommended updates to be included.
4.
Click OK.
5.
Click Continue on the User Account Control dialog box to save the settings and return
to the main Windows Update screen.
6.
At this point, Windows Update will automatically check for and download new updates.
You can either ignore the notiﬁcation (see Figure 8.23) and Windows Update will simply
install the updates during the scheduled time frame, or click Install updates to immedi-
ately install the updates.
Figure 8.23 Installing or Deferring Updates 
NOTE
Keep in mind that the schedule we are setting at this point refers only to the time
when Windows Update will install any new updates it has previously found and
downloaded.
www.syngress.com
280
Chapter 8 • Managing Security Essentials

Choosing Whether to Install Downloaded Updates 
The Download Updates But Let Me Choose Whether To Install Them option will automatically
check for new updates, download those updates, and then provide a taskbar notiﬁcation balloon
informing you of the new updates available for installation if you wish to choose your own schedule
to install new updates.To use this option, follow these steps:
1.
Select the Download updates but let me choose whether to install them radio
button.
2.
Select the Include recommended updates when downloading, installing, or noti-
fying me about updates checkbox, under the Recommended updates section, if you
want recommended updates to be included.
3.
Click OK.
4.
Click Continue on the User Account Control dialog box to save the settings and return
to the main Windows Update screen.
5.
At this point, Windows Update will automatically check for and download new updates.
You can either ignore the notiﬁcation (refer to Figure 8.23), in which case you will receive
the taskbar notiﬁcation balloon until you install the updates, or you can click Install
updates to immediately install the updates.
Checking for Updates but Choosing 
Whether to Download and Install Them
The Check For Updates But Let Me Choose Whether To Download And Install Them option will
automatically check for new updates and then provide a taskbar notiﬁcation balloon informing you
of the new updates available for installation.This option works in an identical manner to the pre-
ceding option, but it provides the beneﬁt of conserving bandwidth until you determine exactly
which updates to download and install.To use this option, follow these steps:
1.
Select the Check for updates but let me choose whether to download and install
them radio button.
2.
Select the Include recommended updates when downloading, installing, or noti-
fying me about updates checkbox, under the Recommended updates section, if you
want recommended updates to be included.
3.
Click OK.
4.
Click Continue on the User Account Control dialog box to save the settings and return
to the main Windows Update screen.
5.
At this point, Windows Update will automatically check for new updates.You can either
ignore the notiﬁcation, in which case you will receive the taskbar notiﬁcation balloon until
you install the updates, or you can click Install updates to immediately install the updates.
www.syngress.com
Managing Security Essentials • Chapter 8
281

Never Checking for Updates 
The Never Check For Updates (Not Recommended) option will turn off all Windows Update auto-
matic features and allow the user to manually check, download, and install new updates. Microsoft
lists this choice as “not recommended,” and it is correct in labeling it as such for the majority of
users.There will always be exceptions, though, and through this option any user can choose to manu-
ally manage her updates through Windows Update, or use some other Microsoft-based or third-party
update service. If you do choose this option, you will receive a rather persistent notiﬁcation from the
Windows Security Center.To disable the notiﬁcation, follow these steps:
1.
Click the Security Center taskbar icon or go to Start | Control Panel | Classic View
| Security Center.
2.
Click Change the way security center alerts me.
3.
Choose from one of these two options: Don’t notify me, but display the icon or
Don’t notify me and don’t display the icon (not recommended).
Using Microsoft Update
Microsoft Update is the expanded software update service from Microsoft that encompasses many of
its product lines and server technologies. It works identically to Windows Update and is actually just
a simple update to the Windows Update mechanism. We have not been able to ﬁnd a good answer as
to why Microsoft is “marketing” Microsoft Update as something entirely new instead of rolling it out
as an update to the Windows Update service.All in all, the Microsoft Update service is a welcome
enhancement and we tend to use it on all our systems, including servers. Microsoft Update can pro-
vide updates for the following Microsoft products in addition to the Windows OS family:
■
Microsoft SQL Server 2000 and later
■
Microsoft Exchange Server 2000 and later
■
Microsoft Visual Studio
■
Microsoft Internet Security and Acceleration Server
■
Microsoft Data Protection Manager
■
Microsoft Ofﬁce System XP and later
■
Windows Defender
■
MSN
Installing Microsoft Update
After installing Microsoft Update, you will be able to utilize the new features and receive updates for
the previously mentioned Microsoft products, all through the Windows Update Control Panel applet.
To install Microsoft Update, follow these steps:
www.syngress.com
282
Chapter 8 • Managing Security Essentials

1.
Click Get updates for more products on the main Windows Update applet screen.
This will open Internet Explorer, displaying the Windows Vista–speciﬁc Microsoft Update
installation Web page.
2.
Select I accept the Terms of Use and click Install.
3.
Click Continue on the User Account Control dialog box.
4.
Once the installation is complete, a Web page instructing you to “use your Start menu to
check for updates” and conﬁrming the successful installation of Microsoft Updates with a
large green check is displayed.
Enabling and Disabling Microsoft Update
If you decide at some point to disable or re-enable Microsoft Update features, Windows Vista greatly
improves on the options you had in previous versions of Windows. Here’s how to enable and disable
Microsoft Update:
1.
Go to Start | Control Panel | Classic View | Windows Update.
2.
Click Change Settings.
3.
Under the Update service heading , select or deselect the Use Microsoft Update
checkbox.
4.
Click OK.
5.
Click Continue on the User Account Control dialog box to save the settings and return
to the main Windows Update screen.
Managing Updates
Windows Update lets us see our update history, view update details, hide and unhide certain
unwanted updates, and read about methods to uninstall problematic updates. However, it has suffered
from a few critical drawbacks associated with serving as a Web application on the Microsoft site.
Windows Vista has all of these same functions available to the user, but as we have seen, it takes the
entire Windows Update service and integrates it into the Control Panel.This seems trivial at ﬁrst, but
the bonuses to this are that we don’t need to rely on Internet Explorer to get updates, there is no
need to install a potentially spoofed ActiveX control, and we do not need to worry about users get-
ting tricked into going to a spoofed Windows Update Web site, both of which can lead to a security
compromise of the local workstation, often without the user’s knowledge.
Checking for Updates
Checking for updates is as easy as navigating to the Windows Update Control Panel applet and
clicking Check for updates.You will see a status bar and the system will inform you it is checking
for available updates. Once Windows Update is done checking for updates, it will ask you to down-
load and install the updates pertinent to your system (see Figure 8.24).
www.syngress.com
Managing Security Essentials • Chapter 8
283

Figure 8.24 Checking and Installing New Updates 
Installing Updates
At this time, you can simply accept that Windows Update knows best and click Install updates, or
you can delve a little deeper to make choices about the updates available by clicking View available
updates.The View available updates screen (see Figure 8.25) shows you what updates are cur-
rently available for your system.At the time of this writing, only three updates were available, but as
time passes, more and more updates will inevitably become available and new installs of Vista will
begin to require quite a few updates to be patched properly.
In our example, we have handy ﬁlter options that work just like any other Windows
Explorer–based mechanism. Updates are initially grouped and sorted by the name of the program or
system component to which the update is related. Clicking the Type heading will sort the updates
according to their classiﬁcation: Important, Recommended, and so on. Clicking the Published
heading will sort the updates by the date that Microsoft published them.Toggling the checkbox in
the header will select or deselect all the updates at once.Toggling the individual checkboxes next to
each update will let the user choose which updates to install. Clicking Install at this point will return
you to the main Windows Update screen and the selected updates will be downloaded and installed.
www.syngress.com
284
Chapter 8 • Managing Security Essentials

Figure 8.25 Viewing and Sorting Available Updates 
The View available updates screen also allows you to view the details of an update by right-
clicking and choosing View Details.The Windows Update Details dialog box shows information
about the speciﬁc update, such as size, type, description, Microsoft Knowledge Base code, a link to an
informational Web page, and a link to a help and support Web page that is speciﬁc to that update (see
Figure 8.26).
Figure 8.26 Viewing Update Details 
www.syngress.com
Managing Security Essentials • Chapter 8
285

You can also hide unwanted updates by right-clicking the speciﬁc update and choosing Hide
update.The update will then be deselected and grayed out.The update will also no longer appear in
the list of available updates when checking for updates.
Viewing the Update History
Viewing your update history can be a useful troubleshooting tool, particularly if a new batch of
updates has caused your computer to behave strangely or malfunction. It is useful to see a history of
what updates were installed and when they were applied, however. For instance, if your network is
attacked and a system is compromised, you would want to search for other internal systems that may
have been compromised if the ﬁrst system was used as the staging area for further attacks.The
problem is that a lot of exploits are available for an attacker to use. How do you efﬁciently search for
evidence of an exploit? One way to narrow your search is to check your list of known exploits
against your update history to see which ones you can eliminate because the patch for that exploit
was applied prior to the system compromise.
1.
Go to Start | Control Panel | Classic View | Windows Update.
2.
Click View update history.
3.
Click Installed Updates to uninstall an update; click Name, Status, Type, and Date
Installed to sort the list of updates by attribute; or right-click the speciﬁc update and
choose View Details to access the details dialog for that update (see Figure 8.27).
Figure 8.27 Viewing the Update History 
www.syngress.com
286
Chapter 8 • Managing Security Essentials

4.
Click OK to return to the main Windows Update screen.
Restoring Hidden Updates
If you have previously hidden certain updates for your system that you later decide to install, you will
need to restore those previously hidden updates.To do so, follow these steps:
1.
Go to Start | Control Panel | Classic View | Windows Update.
2.
Click Restore hidden updates.
3.
Select the checkboxes next to the updates you want to restore, or mark the checkbox in
the header to select all the updates (see Figure 8.28).
Figure 8.28 Restoring Hidden Updates 
4.
Click Restore and then click Continue on the User Account Control pop-up dialog
box.This will return you to the main Windows Update Control Panel applet screen and
automatically trigger the system to check for new updates.
Uninstalling Updates
We have all been in the situation where we need to uninstall a previously installed update, and if you
haven’t been in that position and you work in IT, you will most likely run into that situation at some
point. In previous versions of Windows, the updates were placed under Add and Remove Programs
in the Control Panel. Windows Vista separates the user-installed programs and the installed updates
for easier viewing and manageability. Vista also makes the Installed Programs and Installed Updates
screens part of the new Windows Explorer interface (see Figure 8.23), which means you get familiar
ﬁle-sorting and searching functionality.The Installed Updates screen also has a customized header that
allows for quick sorting by name, related program, publisher, and when the update was installed.You
can also customize the header to show any number of update-speciﬁc attributes, such as the update
ID and update info link.To uninstall updates, either as a troubleshooting step or because an update
has been interacting badly with an installed application on the local computer, follow these steps:
www.syngress.com
Managing Security Essentials • Chapter 8
287

1.
Go to Start | Control Panel | Classic View | Windows Update.
2.
Click Installed updates in the bottom left-hand corner of the main Windows Update
Control Panel applet, under the heading See also.This will display the Installed
Updates screen, which you can also reach through Start | Control Panel | Classic
View | Programs and Features | Uninstall an update.
3.
At this point, you can customize the header and list additional attributes, or you can sort
the list of installed updates by clicking any of the attributes listed on the header.You can
also right-click in the Installed Updates window to bring up a menu allowing you to
change how the items are viewed, sorted, and grouped.The default grouping for updates is
to group them by program, but you can change that to a chronological grouping by right-
clicking and choosing Group By | Installed On, or Group By | Publisher to group
by the publisher of the update.
4.
Once you have found the update you want to uninstall, simply select the speciﬁc update
and click Uninstall above the header next to the Organize and Views menus.You may
also right-click the speciﬁc update and choose Uninstall.
5.
Click Yes on the Uninstall an update pop-up dialog box, and then click Continue on
the User Account Control pop-up dialog box to continue the process.
SOME INDEPENDENT ADVICE
During our use and testing of Windows Vista, we found that the Installed Updates
window shows only certain updates. At ﬁrst, when we did some preliminary research,
we thought that maybe only updates marked as Recommended (in other words,
updates not marked Important) would show up and be available for us to uninstall.
(This, after all, makes a bit of sense. You’ve got people to patch; you shouldn’t give
them or an attacker the ability to uninstall updates that patch security holes. If they
really need to, they can roll the system back using a restore point.) After further
testing, we found that important updates available for Ofﬁce 2003 would show up in
the Installed Updates screen, so we thought that maybe the important Ofﬁce 2003
updates were available for uninstall because they were attached to a user program
and not to the base OS itself. That theory also failed after we right-clicked one of the
Ofﬁce 2003 updates (Update for Ofﬁce 2003: KB907417) and didn’t receive any right-
click menu. The Uninstall button also did not appear when we highlighted the
update. We could uninstall the other available update for Ofﬁce 2003 (Update for
Outlook 2003: Junk E-mail Filter KB925254). At that point, we decided to accept the
fact that some updates can be uninstalled and some can’t, and that the criteria used
to make this decision are not available to the user.
Remember, not all updates will be available for a simple uninstall from the
Installed Updates screen, and even some updates that show on the Installed Updates
screen will not be able to be uninstalled. In order to remove an update you can’t
uninstall from the Installed Updates screen, refer to the update history to see when
the update was installed and then roll the system back using a system restore point.
The unfortunate outcome of having to use the system restore point is obviously that
www.syngress.com
288
Chapter 8 • Managing Security Essentials

any changes made between the installation of that update and when you roll the
system back will be lost. Figure 8.29 shows a dialog box for uninstalling updates.
Figure 8.29 Uninstalling Updates 
Microsoft releases scheduled patches on the second Tuesday of every month, although it has been
known to skip a scheduled patch day in the past. Microsoft will also rarely release extremely critical
patches on-the-ﬂy, so to speak.The reality of patching is that most users will choose one of the initial
security settings (refer to Table 8.1) during installation, or leave the setting as the factory-installed
default and never think about the security of their system again because the default setting is usually
the Microsoft-recommended setting, which may be sufﬁcient for most home users. However, for
some home users, and for systems in a corporate environment, this may not be the be-all and end-all
of software update services. Many users will simply choose Install important updates only, which
means they will only receive security updates and other important updates.This setting sounds like a
valid choice, especially from the perspective of this book, because after all, we are talking about secu-
rity and Windows Vista. Unfortunately, this fails to take into account other Microsoft products and
their security updates. Microsoft Ofﬁce and other Microsoft-produced applications are not included
in the default update process without ﬁrst installing Microsoft Update, and third-party user applica-
tions aren’t included without a completely separate update service. Windows Update, Microsoft
Update, and Windows Vista go a long way toward increasing the security of work and home systems
www.syngress.com
Managing Security Essentials • Chapter 8
289

alike, but security awareness and taking control of your own security posture is something that can’t
be forced. Unfortunately, there will always be home users, and even system administrators, who will
not take control of the systems under their care.
Managing Malware Protection
Microsoft’s Vista is by far the most secure version of its client-based operating system (OS) to date.
Living by its motto of “Trustworthy Computing,” Microsoft has taken many steps in ensuring new
levels of security to the Windows Vista base OS.Along with other tools and programs, Microsoft has
released Internet Explorer 7, which is the securest version of the famous browser released to date.
Microsoft has also updated and released a plethora of documentation on the company’s main Web site
and on TechNet in coordination with the Vista release, to help you harden and prepare your system
for use on the Internet or on a corporate network.These documents can be found from the Vista
landing page at www.microsoft.com/vista.
With all of these tools, documentation updates, and newly developed forms of technology and
security, you’re probably wondering why we still have to deal with so many computer-related issues.
The fact is that every time we browse the Internet, we open our doors to danger. It’s also a fact that
we may never catch up to quell the growing threat. In the world of IT, the playing ﬁeld is constantly
changing, so as programming code becomes more bloated and newer features are added, consequently
more exploits are added. Newly made software and software that has been updated will always have
issues that will be resolved only through update installations, hotﬁxes, service packs (SPs), and/or
complete OS or program upgrades.You do have an option to protect yourself, though.
Vista includes many new features that help thwart malware threats. Behind the actual making of
the software was a major plan to shift the way Microsoft does business in the security sector. Now,
making a secure, private, and reliable computing experience has become the company’s top priority
and has been dubbed “Trustworthy Computing.”To preserve data conﬁdentiality, integrity, and avail-
ability (CIA), Windows Vista brings a new level of conﬁdence to computing through improved secu-
rity, reliability, and management. It achieves this by establishing innovative engineering, applying best
practices, and creating a system where the OS can be updated and maintained consistently to avoid
intrusion or exploitation.
New features include 
■
Windows Service Hardening (WSH)  Windows Service Hardening limits the amount of
damage an attacker can do if a service is compromised.
■
Network Access Protection (NAP) Network Access Protection is used to prevent
clients from connecting to the network if they are infected with malware.
■
Internet Explorer 7 Internet Explorer 7 comes with Windows Vista by default as the
built-in Web browser. It includes many security enhancements that protect users from mal-
ware attacks such as phishing and spooﬁng, and it uses a new mode, called Protected Mode,
to further secure the user’s browsing experience.
■
Updated Windows Firewall The new outbound ﬁltering feature in the personal ﬁrewall
helps apply more granular control over the trafﬁc traversing it.
www.syngress.com
290
Chapter 8 • Managing Security Essentials

■
User Account Control (UAC) This feature will allow a user to change computer set-
tings while running as a standard user, instead of requiring administrator privileges to per-
form most tasks.
■
Windows Defender The Windows Defender utility detects malware on your system and,
when used in conjunction with SpyNet, can help eliminate most spyware attacks and
exploits.
In December 2004, Microsoft acquired the Windows Defender security technology from
GIANT Company Software, Inc. Windows Defender provides continuous security against malware,
and if it detects anything suspicious, it will alert you about what it ﬁnds. It does this by using three
speciﬁc tools:
■
Internet agents Internet agents are used to monitor changes to Internet access settings, as
well as to stop unauthorized connection attempts via the network.
■
System agents System agents are used to monitor changes to your system’s settings, such
as passwords and permissions.
■
Application agents Application agents are used to monitor changes to applications
installed on your OS, such as Internet Explorer being modiﬁed by downloadable toolbar
applications.
NOTE
Windows Defender is used locally to protect an end-user’s Web-browsing experience.
Windows Defender does not include enterprise management tools. 
Windows Defender protects against and removes malware as well as provides control over modi-
ﬁcations to software installed on the system. Windows Defender provides real-time monitoring func-
tionality, which means it will always run and keep you protected while you’re using your Windows
Vista system.The Windows Vista version of Windows Defender features an updated scanning engine,
simpliﬁed alerting functionality, multiple-language support, and other enhancements.
Windows Defender provides top-notch spyware detection and removal, and it is connected to an
online service that will keep it updated and on top of the latest threat trends. Because malware con-
stantly evolves, so does Windows Defender and its support team.
Using Windows Defender 
You can ﬁnd Windows Defender by opening the WSC and selecting the Windows Defender link.
This will invoke the Windows Defender application, as shown in Figure 8.30. If your system is
already up-to-date, Windows Defender will report that there is no harmful or unwanted software on
your system and that your computer is running normally. If you have not run a scan yet, or your last
scan was a while ago, you will be prompted with scan options.
www.syngress.com
Managing Security Essentials • Chapter 8
291

Figure 8.30 Using Windows Defender 
Select the scan option that best suits what you want to do. If you want to perform a quick scan
of the most common areas within your system affected by malware, check the Quick scan radio
button. If you want to check your entire system, check the Full system scan radio button (note that
a full system scan will take far longer to perform than a quick scan since it will scan your entire hard
drive rather than only searching through the Windows Registry and the ~\Windows\system32 direc-
tory).You can also specify which drives or areas of your system you want Windows Defender to scan.
Figure 8.31 shows Windows Defender prompting you to begin a scan. Click Scan Now to
begin the scan.
Once the scan is complete, you can view the report. If anything malicious is found, you will be
asked how you want to handle it. Figure 8.32 shows Windows Defender completing a quick scan and
not ﬁnding any malware on the system. (Because this was a quick scan, there still may be an issue
with this system, however; a full system scan should be run to verify that the system is in fact free of
malicious software.) 
www.syngress.com
292
Chapter 8 • Managing Security Essentials

Figure 8.31 Starting a Scan with Windows Defender 
Figure 8.32 Viewing Windows Defender Reporting a Quick Scan Completed 
Managing Security Essentials • Chapter 8
293
www.syngress.com

By clicking Tools at the top of the Windows Defender dialog box, you can adjust the settings
for Windows Defender and select other tools to further secure your system.As shown in Figure 8.33,
once you open the Tools and Settings conﬁguration within Windows Defender, you can change
the settings, use Microsoft SpyNet, view quarantined items, use the Windows Defender Software
Explorer, set allowed items, and visit and use the Microsoft Windows Defender public Web site.
Figure 8.33 Setting Windows Defender Options 
How to Use the 
Windows Defender Software Explorer
One of the newest and most helpful tools Microsoft has added to Vista and Windows Defender is
Software Explorer. Software Explorer provides you with an unfettered view of the software currently
running on your computer, along with details of each piece. It also helps you monitor programs set
to start when the computer boots, programs that run in the background or as background processes,
and programs that are used to perform low-level network functions (for example, Winsock service
providers).
www.syngress.com
294
Chapter 8 • Managing Security Essentials

NOTE
To use some Software Explorer options, you must be logged on as Administrator or
be a member of the Administrators group.
Using Software Explorer
Changing how a program runs on your computer, such as blocking Internet or network connections
and ending processes, can cause problems with Windows and other programs you use. Use Software
Explorer to change how a program runs on your computer only if you are certain the program is
causing a problem. Once you open Software Explorer, you can select which category of programs
you want to view or adjust. For example, in Figure 8.34, you can see Software Explorer in use. Here,
the Startup Programs category is shown but blurred out to protect the identity of the system in use.
Figure 8.34 Using Software Explorer 
BEST PRACTICES ACCORDING TO MICROSOFT
Periodically update every piece of software you install on your system, as well as the
OS itself, which also needs to be updated periodically. You can do this by installing
the latest updates, hotﬁxes, security patches, and SPs available for your software.
Keep on top of when new patches come out, and try to test and then install the cur-
rent patches to keep your system at its best. 
www.syngress.com
Managing Security Essentials • Chapter 8
295

When using your e-mail client, pay close attention to “who” is sending you e-
mail and “where” the e-mail originates. Because e-mail can be spoofed, you may not
always be able to do this, but in most cases, a spam ﬁlter can quickly identify
unspoofed e-mail and send it right to the trash or automatically remove it. 
If you receive ﬁles from sources you do not recognize, it’s wise not to execute
them. Instead, delete them. In other words, if someone sends you a ﬁle such as
harmless.jpg.exe, it’s a good idea to delete the ﬁle and not execute it because it
seems to fall into the characteristic of a typical malware hoax intent on getting you
to launch it. 
When using your e-mail client, make sure you turn off any preview pane func-
tionality so you do not open and, therefore, execute any attached scripts simply by
opening your Inbox. 
To prevent macro viruses, ensure macro security is enabled in Ofﬁce so if you
open a Word document, you won’t necessarily run a malicious script that may also be
contained within it. 
Do not use ﬂoppy disks from untrusted sources. Also, pay attention to any ﬁle
that enters your system from any source, whether it is a CD or DVD-ROM, USB ﬂash
device, or something similar. 
Use host-based instruction detection/prevention (IDS/IPS) software if possible, as
well as ﬁrewall software, antivirus software, and spyware removal software such as
Microsoft Defender. 
Harden your systems and disable unneeded or unwanted services. 
Use a strong password policy. If malware does attempt to try to steal your cre-
dentials, having a strong password policy in place will help you if your system does
become infected. 
Conﬁgure your Web browser (such as Internet Explorer 7) to ignore or warn
about cookies, and disable JavaScript and ActiveX, two commonly exploited scripting
languages. Keep a close eye on sites that are not trusted and try to block sites you
know are malware-infected.
Changing how a program runs on your computer, such as blocking Internet or
network connections and ending processes, can cause problems with Windows and
other programs you use. Use Software Explorer to change how a program runs on
your computer only if you are certain the program is causing a problem. Once you
open Software Explorer, you can select which category of programs you want to
view or adjust.
Microsoft SpyNet is the network of Windows Defender users that helps deter-
mine which programs are classiﬁed as spyware. 
SpyNet builds known signature ﬁles for commonly seen malware and ﬁnds mal-
ware that is new to the scene. It is recommended you visit SpyNet to get acclimated
with the site and the beneﬁts it offers, and that you check back often for updates.
www.syngress.com
296
Chapter 8 • Managing Security Essentials

NOTE
Since its release, Microsoft Windows Vista has already been reported to be affected
by old malware. In particular, Vista has been found to be susceptible to three
common malware exploits: 
■
Stratio-Zip W32/Stratio-Zip is a family of Zip ﬁles containing worms in the
Stration family. 
■
Netsky-D W32/Netsky-D is a worm that spreads via e-mail. When e-mailing
itself, the worm can spoof the sender’s e-mail address.
■
MyDoom-O W32/MyDoom-O is an e-mail worm that creates a ﬁle named
services.exe in the Windows or Temp folder, and then runs the ﬁle.
Services.exe is a backdoor component. The worm then searches the hard
disk’s e-mail addresses. 
When deploying Vista, be aware that although malware defense has been forti-
ﬁed, it still has its faults. For more information on this subject, visit
www.sophos.com/pressofﬁce/news/articles/2006/11/toptennov.html and
http://news.zdnet.co.uk/security/0,1000000189,39284939,00.htm.
Managing Internet Browser Security
With the release of Windows Vista, you can expect to use the newest and securest version of
Microsoft’s Web browser to date. New features in Internet Explorer 7 help prevent the inception and
spread of malware.To help protect a user’s personal information and the security of Vista in general,
Internet Explorer 7 comes with many new advances in security and tools to help prevent or limit
damage from an attack. One simple change is with the Secure Sockets Layer (SSL) protection offered
when using the browser. Commonly, a padlock icon will show up at the bottom of the browser indi-
cating you are entering a “secure” site that uses encryption technologies. Now, the new security status
bar helps by showing you in clearer terms that a site you are visiting is safe.The padlock also appears
closer to the top of the browser and is highlighted blue when safe.This is but one very simple
example of things that have changed to make your browsing experience easier and safer.
Introduction to Web Browser Security
When you are surﬁng the Internet, it’s easy to visit sites you think are safe but are not.These sites can
introduce malware when you click the site itself, when you download a ﬁle from the site manually
and install it, or worse, when you are conned into believing the site you’re visiting is a real site, but in
fact is nothing more than a fake used to garner your personal information.
Browser Exploits
Web browsers are client software programs, such as Internet Explorer, Netscape, and Opera, that con-
nect to servers running Web server software (such as IIS or Apache) and request Web pages via a
www.syngress.com
Managing Security Essentials • Chapter 8
297

URL.The URL is a “friendly” address that represents the IP address of a remote Web server, as well
as the particular ﬁles on the server that the user is trying to access.The browser receives ﬁles that are
encoded (usually in Hypertext Markup Language [HTML]) and must interpret the code or
“markup” that determines how the page will be displayed on the user’s monitor. Browsers are open
to a number of attack types.The embedded scripts (and even some of the markup language) can be
used to exploit your browser—for example, by enacting a phishing attack that attempts to trick you
into entering sensitive information on a malicious Web site without you realizing it. With Internet
Explorer 7, new tools such as the Phishing Filter help thwart these attacks.
Early browser programs were fairly simple and could be exploited by using minimal techniques.
Today’s browsers are highly complex, signaling the need to secure them even further.These newer
browsers are capable of not only displaying text and graphics, but also playing sound ﬁles and movies
and running executable code.The browser software also usually stores information about the com-
puter on which it is installed, as well as the user (via data stored as cookies on the local hard disk),
which can be uploaded to Web servers—either deliberately by the user, or in response to code on a
Web site.These characteristics serve useful purposes. Support for running code (as “active content,”
such as Java, JavaScript, and ActiveX) allows Web designers to create pages that interact with users in
sophisticated ways. Cookies allow users to set preferences on sites that will be retained the next time
they visit the site.
However, hackers and attackers can exploit these characteristics in many ways. For example, an
attacker can program a Web site to run code that transfers a virus to the client computer through the
browser, erases key system ﬁles, or plants a “backdoor” program that then allows the hacker to take
control of the user’s system.
Web Spooﬁng
Web spooﬁng is a means by which an attacker is able to see and even make changes to Web pages
that are transmitted to or from another computer (the target machine).These pages include conﬁden-
tial information such as credit card numbers entered into online commerce forms and passwords that
are used to access restricted Web sites. JavaScript can be used to route Web pages and information
through the attacker’s computer, which impersonates the destination Web server.The attacker can
send e-mail to the victim that contains a link to the forged page, or put a link into a popular search
engine. SSL doesn’t necessarily prevent this sort of “Man in the Middle” attack; the connection
appears to the victim to be secure, because it is secure.The problem is that the secure connection is
to a different site than the one the victim thinks he is connecting to. Hyperlink spooﬁng exploits the
fact that SSL doesn’t verify hyperlinks that the user follows, so if a user gets to a site by following a
link, he can be sent to a spoofed site that appears to be legitimate. Let’s say you click an e-mail link
which you think is connecting you to www.amazon.com, but the link actually directs you to a forged
(or “spoofed”) site that resembles amazon.com, called evilhackers.com. If evilhackers.com is conﬁg-
ured with an SSL certiﬁcate, the SSL certiﬁcate will show the site as “secure” even though it is a
malicious site. In this case, SSL is not “smart enough” to realize that the Web site is malicious; the SSL
certiﬁcate only cares that the administrator of evilhacker.com has conﬁgured SSL correctly. (Think of
it this way: SSL certiﬁcates cannot measure the intent of the owner of a Web site.)
Web spooﬁng is a high-tech form of con artistry.The point of the scam is to fool the user into
giving conﬁdential information such as credit card numbers, bank account numbers, or Social
Security numbers (SSNs) to an entity that the user thinks is legitimate, and then using that informa-
www.syngress.com
298
Chapter 8 • Managing Security Essentials

tion for criminal purposes such as identity theft or credit card fraud.The only difference between this
and the “real-world” con artist who knocks on a victim’s door and pretends to be from the bank,
requiring account information, is in the technology used to pull it off.
Certain clues may tip off an observant victim that a Web site is not what it appears to be, such as
the URL or status line of the browser.You may think you are going to a Web site simply because it’s
listed in the URL ﬁeld, while in another location on the browser, it’s indicated that you are going to
a different URL.An attacker can also use JavaScript to cover his or her tracks by modifying these ele-
ments from your view.An attacker can even go so far as to use JavaScript to replace the browser’s
menu bar with one that looks the same but replaces functions that provide clues to the invalidity of
the page, such as display of the page’s source code. Later versions of browser software have been mod-
iﬁed to make Web spooﬁng more difﬁcult. Older browsers are highly vulnerable to this type of
attack. Improvements in Internet Explorer thwart spooﬁng attacks, because now you can check the
validity of each site you visit by checking the status of the Phishing Filter. If the Phishing Filter
detects that a site you are browsing to is a suspected Phishing site, you will see the screen shown in
Figure 8.35.
Figure 8.35 Internet Explorer’s Phishing Filter
Conﬁguring Internet Explorer Securely 
Now that you have an understanding of some of the common types of attacks your users are vulner-
able to when surﬁng the Internet, let’s discuss how to conﬁgure and use these tools and settings. With
Internet Explorer 7, there are many ways to improve security. Internet Explorer 7 in Windows Vista
represents a major step forward in browser security and privacy protection.All of Internet Explorer
7’s security features revolve around making your computer and Web-browsing experience all that it
can—and should—be.
www.syngress.com
Managing Security Essentials • Chapter 8
299

Protected Mode
Internet Explorer 7 has a new mode, called Protected Mode. When in Protected Mode, the browser
will run without fear of malware taking over with elevated privileges, because IE7 is running with
extremely low security privileges. In previous versions of IE, if you were logged on to your worksta-
tion as an Administrator and accidentally downloaded a malicious script or ActiveX control, that
malicious software would run in the security context of a local administrator, since that was the privi-
lege level you were logged in with. Now IE7 runs in an extremely restricted security context even if
you are logged on as a local administrator; IE7 Protected Mode only has the ability to write ﬁles to
the Temporary Internet Files directory by default. In addition to providing a more secure architecture
in which to work, Protected Mode also assists with handling and verifying any scripted or automated
action that attempts to move data around the system, such as moving a script or malicious executable
from the Temporary Internet Files folder to the critical ~\windows\system32 directory. Because the
Temporary Internet Files directory is the location where Internet Explorer saves temporary ﬁles
during a browsing session, this directory can be a haven for malware. Figure 8.36 shows the browser
with Protected Mode enabled (or on) by default.
Figure 8.36 Internet Explorer’s Protected Mode 
ActiveX Opt-In
Internet Explorer 7 allows for tighter control and security when working with ActiveX components.
Many attacks have exploited ActiveX in the past because ActiveX controls can take actions against the
local workstation such as copying, deleting, or modifying system ﬁles.ActiveX components can
handle ﬁle download and installation for the computer user.Although this is handy, malware takes full
advantage of it whenever it can.ActiveX runs only on Microsoft-based systems since it is made and
updated by Microsoft in a proprietary fashion.
A new feature called ActiveX Opt-In will disable all ActiveX controls that haven’t been pre-
screened. In other words, if an ISV does not preset the control to work with Vista and Internet
Explorer 7, it will not work. In fact, the security status information bar in Internet Explorer 7 will
give you the option to work with each ActiveX control on a case-by-case basis.This allows the user
to know exactly what each control is doing, what’s being installed, and so on.You can manage
installed ActiveX controls by clicking Tools | Manage Add-Ons | Enable or Disable Add-
Ons, which will take you to the screen shown in Figure 8.37.You can manage an individual add-on
by clicking the add-on and then selecting Enable, Disable, or Delete.
www.syngress.com
300
Chapter 8 • Managing Security Essentials

Figure 8.37 A Managing ActiveX Controls Note
NOTE
ActiveX is a software technology developed by Microsoft that enables Internet
Explorer to download applets and other tools and programs to be used with the
browser to display pictures and video as examples. These programs are similar to
Java applets, although Java is not constrained to using Microsoft-based products
only. 
Fix My Settings
Nothing could be easier than pressing one button to accomplish multiple tasks.Toward that end,
Internet Explorer 7 has a new feature called Fix My Settings, which allows you to adjust the
browser’s default settings with just a single click. Used with the Security Status Bar, Fix My Settings
helps users quickly determine whether a Web site is authentic and whether changes to their settings
by a site are appropriate. It will even suggest settings for the user.
Figure 8.38 shows the Fix My Settings feature in action. If you visit a Web site that is question-
able and Internet Explorer believes you may be at risk, the Security Status Bar will warn you of
danger and give you options to ﬁx or avert that danger. Here, you can see the Fix Settings for Me
option, which will walk you through adjusting your settings so you are not exploited.
www.syngress.com
Managing Security Essentials • Chapter 8
301

Figure 8.38 Internet Explorer’s Fix My Settings Feature 
If you have issues with your browser, you can always reset it from within the Internet Options
settings found in Internet Explorer, by going to the Tools menu and selecting either the Security
tab (which will allow you to reset the zone directly) or the Advanced tab (where you can choose
the Restore advanced settings option).Then, you can turn your browser back to the manufac-
turer’s settings, as shown in Figure 8.39.
Figure 8.39 Internet Explorer’s Restore Advanced Settings Option 
The Security Status Bar
As you saw with the Phishing Filter, the new Security Status Bar used with Internet Explorer 7 keeps
an eye out for you as you browse, and makes suggestions based on your browsing habits. In other
words, if Internet Explorer feels you are at risk, it will warn you and suggest a way to protect yourself
from the possible threat.The Security Status Bar operates by alerting you to issues it believes may
harm your system, and gives you options to help you navigate a potential issue. Users can now very
quickly be warned about Web sites that are either authentic or spoofed/malicious in nature. By
enhancing access to digital certiﬁcate information, which in turn helps validate the trustworthiness of
e-commerce Web sites, you can now shop online with more conﬁdence.
Windows Defender
Windows Defender enhances security and privacy protections when used with Internet Explorer 7.
Although we will cover Windows Defender in more depth later in this chapter, it’s important to
know how it works with Internet Explorer 7 to secure your browsing experience.
Windows Defender is Microsoft’s new spyware destroyer. When used with Internet Explorer 7,
Windows Defender can help scan all data traversing the browser for malware signatures. If it ﬁnds
such a signature, it will work with Internet Explorer 7 and help you rid yourself of it. Defender will
also keep an eye on spyware that is attached to (piggybacking onto) legitimate software that tries to
install without your knowledge.
www.syngress.com
302
Chapter 8 • Managing Security Essentials

Setting Internet Zones
One of the most important features of Internet Explorer 7 is the ability to conﬁgure zones. When
you open Internet Explorer’s properties, you will ﬁnd the Security tab, which houses the Internet,
Local intranet,Trusted sites, and Restricted sites zones (see Figure 8.40).You can conﬁgure these
zones to allow for tighter security, or less-restrictive security, based on your browsing habits. For
example, if you access the Internet and your local intranet simultaneously, you may need to conﬁgure
security differently in each zone so that less trusted sites have fewer features enabled.
Figure 8.40 Setting Security Zones 
As you can see in Figure 8.40, you can set each zone to the speciﬁc level of security you need.
For instance, you may want to set the Internet zone to a very high level to avoid malware attacks (for
the most part), even though it will reduce your browsing functionality severely, or you may want to
set the Internet zone to a very low level so you can do anything you want to do with your browser.
You also can enable Protected Mode within this dialog to provide the functionality we discussed ear-
lier, in which IE runs in an extremely restricted security context.
If you need to conﬁgure more granular security, you can click the Custom level button, which
will open the Security Settings dialog for the zone you have selected. So, if you want to conﬁgure
more granular levels of security on the Internet zone, select that zone and choose Custom level,
which will open the settings for that particular zone. Figure 8.41 shows advanced settings in which
you can adjust for the Internet zone to include advanced cookies.
www.syngress.com
Managing Security Essentials • Chapter 8
303

Figure 8.41 Setting Advanced Settings in the Internet Zone 
Conﬁguring Privacy
The next tab you can conﬁgure within Internet Options is your privacy level. In the Internet
Options dialog box, select the Privacy tab. In the Privacy tab, you will ﬁnd many settings to help
secure your browser further. For example, you can select privacy settings that determine whether
your browser will accept cookies or allow pop-ups while browsing. In Figure 8.28, you can see pri-
vacy settings for the Internet zone. When conﬁgured correctly, you can either raise or lower the pri-
vacy settings you want based on your browsing habits. In Figure 8.42, the Internet zone is conﬁgured
with a medium privacy rating.This makes sure all third-party cookies are blocked from doing things
you may not want them to do.You can raise or lower this slider to control your default browser
behavior, or click the Sites button to specify individual Web sites from which your browser should
always (or never) accept cookies.
You can also select the Sites button, which will allow you to conﬁgure speciﬁc sites that you
will either allow or not allow to use cookies, regardless of the privacy policy you select. In Figure
8.43, you can see that Internet Explorer 7 is always set to “allow” cookies from www.syngress.com.
Although the privacy settings may disallow cookies altogether, this setting lets you manually override
Internet Explorer’s privacy settings to allow cookies from any site you feel is not a threat.
www.syngress.com
304
Chapter 8 • Managing Security Essentials

Figure 8.42 Conﬁguring the Privacy Tab 
Figure 8.43 Setting Per Site Privacy Actions
The Advanced button on the Privacy tab also allows you to specify how cookies should be
handled in a particular zone. For the Internet zone, you can conﬁgure IE to override automatic
cookie handling, and specify more granular settings, as shown in Figure 8.44.
www.syngress.com
Managing Security Essentials • Chapter 8
305

Figure 8.44 Conﬁguring Automatic Cookie Handling 
Internet Explorer 7 also provides settings that allow you to control how your Web browser
responds to Web sites that attempt to use pop-up windows; these pop-up windows can be annoying
at best or represent an attempt at a phishing attack at worst.At the bottom of the Privacy tab dialog,
you will ﬁnd the Pop-up Blocker. Here, you can enable the Pop-up Blocker to block any pop-up
(or warn of a pop-up) whenever you surf the Internet. By clicking the Settings button, you can fur-
ther control the Pop-up Blocker.You also can specify sites from which you will allow pop-ups
without the need to be prompted (see Figure 8.45), in case you often visit sites with pop-ups that are
generally benign in nature.
Figure 8.45 Conﬁguring the Pop-up Blocker 
www.syngress.com
306
Chapter 8 • Managing Security Essentials

Advanced Security Settings 
The last tab in the Internet Options dialog is the Advanced tab, as seen in Figure 8.46. Within this
tab, you will ﬁnd more than 100 settings you can adjust.The best way to see what you can do is to
scroll through all the options and read them one at a time since they are very self-explanatory. In
Figure 8.46, you can see a few settings that are crucial to applying security to Internet Explorer 7 and
should not be overlooked.
Figure 8.46 Setting Advanced Security Features 
For example, you can set more advanced security settings within the Security branch of the
Advanced tab. Here you can adjust Internet Explorer’s behavior by further controlling what it can
and cannot do. For example, you can choose to Allow software to run or install, even if the
signature is invalid, referring to digital signatures that are conﬁgured on most commercial IE plug-
ins and ActiveX controls. While not a 100-percent failsafe measure, you would still want to leave this
option unchecked because an invalid digital signature can be the ﬁrst indication that a particular
plug-in or ActiveX control might be malicious.
Figure 8.47 speciﬁes more settings you can adjust to control Internet Explorer 7. Here you can
adjust how the Phishing Filter behaves, as well as use of the SSL and Transport Layer Security (TLS)
protocols.
www.syngress.com
Managing Security Essentials • Chapter 8
307

Figure 8.47 Setting More Advanced Security Features 
Once you have completed setting your Advanced security options, click OK to close the dialog
box. Some changes may require you to restart Internet Explorer. Simply close the browser and
reopen it to continue working with your new settings.
Conﬁguring the Microsoft Phishing Filter  
Phishing is a technique that attackers use to trick you into giving up personal data, credentials, or
other information by posing as legitimate businesses or operations. Phishing attacks are not new—for
example, clever attackers in the past have spammed AOL users with spoofed e-mail purporting to be
AOL. Many users were tricked into giving up their account information because they had no idea
that a Web site operator could trick them into doing so with nothing but a similar-looking Web site
that claimed to be something it wasn’t. It wasn’t until the end-user community started learning about
spoofed Web sites and other ways attackers were getting people’s personal information (sometimes
without them even knowing about it) that AOL began to warn users against giving up their personal
account information to anybody other than AOL, and to practice due diligence in checking for signs
of phishing attacks by examining the URL to ensure they were being approached by AOL and not a
spoofed site.
Phishing is the exploit hackers use to obtain personal information from unsuspecting users. It
continues today, and you can ﬁnd examples on the wildly popular site MySpace (www.myspace.com).
MySpace has suffered from the same issues AOL worked through—using similar spoofed e-mail
addresses, malicious Web site operators pretended they were from MySpace when they were really
gathering legitimate users’ credentials and, inevitability, their personal information. MySpace owners
posted the same types of warnings that AOL did years ago.The Microsoft Phishing Filter is a new
www.syngress.com
308
Chapter 8 • Managing Security Essentials

feature of Internet Explorer 7 that is designed to help protect you against attacks of this nature while
you’re surﬁng the Internet.
To improve users’ abilities to protect themselves from phishing attacks, Microsoft designed and
implemented the Phishing Filter into Internet Explorer 7. Now, if the end user wants to stay secure
and not have to worry about checking his browser for clues that the site he is visiting is the real deal,
he can simply turn on the Phishing Filter and it will ensure through veriﬁcation steps that the site
the end user is visiting is, in fact, legitimate.
When the Phishing Filter is turned on, it performs a few steps every time you visit a Web site.
First, it veriﬁes against a locally stored list that the Web sites you are trying to visit are not fraudulent.
It will also analyze visited sites for suspicious behavior that is commonly associated with Phishing
Web sites.Then, it will connect to an online service that constantly updates it with phishing attack
sites that have been found and blacklisted.
You can adjust the Phishing Filter’s settings from within Internet Explorer. When you open
Internet Explorer 7, click Tools and then Phishing Filter. Here you can turn the ﬁlter on or off
(see Figure 8.48). Microsoft recommends you use the ﬁlter at all times, as this will provide you with
the highest level of security.
Figure 8.48 Using the Microsoft Phishing Filter 
To see the Phishing Filter at work, you can manually run a check on a suspicious Web site.To
verify the validity of a site, click Tools, then Phishing Filter, and then Check This Website. If the
site is safe and legitimate, as in Figure 8.49, the Phishing Filter will report it as such.
www.syngress.com
Managing Security Essentials • Chapter 8
309

Figure 8.49 The Phishing Filter Reporting a Safe Site 
Internet Explorer 7 is the securest version of the browser to date, and strides in programming to
make it safer have been successful. In the next section, we will take a look at the Windows Security
Center (WSC), which is used to keep your system’s security centralized.
SOME INDEPENDENT ADVICE
You will notice that your Web surﬁng will become painfully slow as your browser
veriﬁes every site you visit. As always with security, you have to consider the trade-
off between usability and security and ﬁnd a happy medium. If you ﬁnd your surﬁng
habits consist of visiting sites that are commonly spoofed, you may want to wait the
few seconds it takes to verify that sites you are visiting are safe to visit. 
Social engineering attacks are similar to phishing. With social engineering, an
attacker will call someone on the phone, for instance, and trick them into giving up
secure information by pretending to be someone he or she is not. 
By using the opt-in online service, you can update the Phishing Filter in Internet
Explorer 7 to a more secure level.
Managing User Account Controls
User Access Control (UAC) is a major development within access control and Windows Vista. For
example, most of us remember how to use the Run As process in Windows XP and earlier: if you
were logged on to your workstation as a normal user and needed to open a program with adminis-
trative privileges, you would’ve needed to use the Run As feature and manually enter an adminis-
trator’s credentials. In previous versions of Windows, local user accounts were often conﬁgured as
members of the local Administrators group, which provided those users with unneeded system privi-
leges and the ability to install and conﬁgure applications as well as perform management and admin-
istrative tasks on the workstation. With the advent of UAC, Windows Vista allows a user to function
as a normal user until they perform an action that requires administrative rights, at which point UAC
will prompt them accordingly.
User accounts should not be able to do things they do not need to do.All that does is leave the
door wide open for malware (or other forms of attack) that could compromise these accounts and
www.syngress.com
310
Chapter 8 • Managing Security Essentials

allow access to system resources. Users should have only the privileges they need, and nothing more.
With Windows Vista, UAC is used to separate user privileges from those that would require adminis-
trative rights and access. UAC deﬁnes access security by ﬁrst limiting the surface area for attack.
Accounts have been redeﬁned so that if they are compromised, they will pose no security threat, but
at the same time will allow for “nonthreatening” tasks to be functional, such as currently conﬁgured
time zones, for example. When administrative privileges are needed (such as when installing an appli-
cation), the user will be prompted for an administrator password. UAC makes user accounts safer for
use by prompting the user for approval before allowing him to perform any administrative tasks.
UAC will also help shield users from malware and other exploits by allowing each user to require
an administrative password to be able to see and use content on the Web. By combining UAC with
the new parental controls feature in Vista, users can now enjoy a safer Web surﬁng experience, and
children will not be so easily duped into doing things that compromised security in the past.
Using User Access Control 
To use UAC, simply boot your Vista system and use it—it’s enabled by default. UAC will pop up
when administrative privileges are required. Figure 8.50 shows the UAC logon screen.
Figure 8.50 Viewing the UAC Logon Screen 
When UAC is invoked, simply supply the credentials needed.Also, note the program icon, which
shows the path to the program that invoked UAC to begin with. Sometimes, if a program is mali-
cious, it will appear to be an unknown program or from an unknown publisher.To allow this pro-
gram to run, simply click the Submit button within the Windows Security dialog.You can also
specify different accounts to use if you prefer to not use the Administrator account.
UAC can be used in other ways, too. For example, you can mark an application to run in an ele-
vated fashion at all times, as well as set other advanced conﬁgurations.You also can disable UAC alto-
gether. When you want to run a program as elevated, simply right-click the application to show the
Run as administrator menu option, as shown in Figure 8.51. Here, we run Regedit, which is used
to open and modify the contents of the Registry with administrative privileges, since this is often
required to modify critical sections of the Registry such as HKEY_Local_Machine.
www.syngress.com
Managing Security Essentials • Chapter 8
311

Figure 8.51 Invoking UAC 
Marking an Application
You can mark applications to run in an elevated fashion very easily by ﬁnding the application in
which you want to conﬁgure and right-clicking it, selecting the Compatibility tab from the
Properties dialog box, and under Privilege Level, selecting Run this program as an adminis-
trator. In Figure 8.52, we view the elevation of Regedit by modifying the privilege level to allow
the program to run as an administrator.
Figure 8.52 Setting Regedit’s Privilege Level 
312
Chapter 8 • Managing Security Essentials
www.syngress.com

WARNING
If the Run This Program As An Administrator option is unavailable, it means one of
three things: the application is blocked from always running elevated, the applica-
tion does not require administrative credentials to run, or you are not logged on to
the computer as an administrator.
Using the Local Security Policy to Conﬁgure UAC
You can disable Admin Approval Mode and UAC from prompting for credentials to install applica-
tions, and change the elevation prompt behavior, by changing the conﬁguration within the Local
Security Policy.
To disable Admin Approval Mode and UAC, click the Start menu. When you open the menu,
select All Programs | Accessories | Run.Type secpol.msc in the text area to open the Local
Security Policy Microsoft Management Console (MMC), and click OK.The Local Security
Policy MMC will open, as seen in Figure 8.53.
Figure 8.53 Opening the Local Security Policy MMC 
Once it is opened, drill down to the Security Options node in the MMC navigation pane.You
can access this by going to Local Policies, and then clicking the Security Options node. Scroll
down until you ﬁnd the User Account Control settings. Once there, you will ﬁnd quite a few
options you can adjust for UAC. Figure 8.54 shows disabling the Admin Approval Mode and UAC by
selecting Disabled and clicking OK.
www.syngress.com
Managing Security Essentials • Chapter 8
313

Figure 8.54 Disabling Admin Approval Mode and UAC 
Disabling UAC When Installing Applications 
You may want to disable UAC from prompting for credentials to install applications if you trust the
users using the system to install applications without being prompted every time they do. For
example, some users may be trusted to handle the installation of applications on their systems, or you
may support a number of remote users that need to install applications remotely from time to time.
In cases such as these, you may disable UAC from prompting each time someone needs to install an
application.
From the Local Security Policy MMC, drill back down the UAC options in the Security
Options node and select User Account Control: Detect application installations and prompt
for elevation.As shown in Figure 8.55, you can enable or disable this option. Click OK for the set-
tings to take place.
Changing the Prompt for UAC
You can also change how UAC will be invoked by changing the behavior of the elevation prompt
for standard users. When standard users use the Vista system, either UAC can prompt them or you
can conﬁgure it to automatically deny any elevation requests.You would do this to lock down the
system completely and not allow users to even be prompted when privileges need to be elevated.The
user can either be prompted for credentials (this setting requires username and password input before
an application or task will run as elevated) or denied completely. Figure 8.56 shows the UAC settings
you can adjust.
www.syngress.com
314
Chapter 8 • Managing Security Essentials

Figure 8.55 Changing How UAC Handles Application Installations 
Figure 8.56 Changing How UAC Handles Standard Users 
www.syngress.com
Managing Security Essentials • Chapter 8
315

Summary
Securing your Windows Vista PC is a crucial step in protecting your critical data and even your
identity in this interconnected world. In this chapter, we discussed a number of tools available within
Vista to improve the security of your computer, including major improvements to the Windows
Firewall within Vista. Microsoft created Windows Vista to eliminate the most common Windows-
based attacks, such as buffer overﬂows and the manipulation and exploitation of service accounts. In
addition, Vista provides secured user access. User access has always been tough to secure. Because of
the way Windows was initially designed, an attacker could exploit the OS’s subsystems in many ways.
Additional enhancements to the Vista logon architecture include a new feature called User Account
Control. When using UAC, a malicious attacker won’t be allowed to bypass controls placed on stan-
dard user accounts, because if one is jeopardized, it most likely won’t offer any kind of path to
administrative privileges that could be used for harmful purposes.
Windows Vista and Internet Explorer 7 were developed to thwart many common exploits and
build a foundation in which new ones can be mitigated. New to Vista and Internet Explorer 7 is
an updated Windows Firewall.The new outbound filtering feature in the personal firewall helps
apply more granular control over the traffic traversing it, and is more flexible than previous ver-
sions.The new Phishing Filter is used to verify the validity of the sites you visit so your personal
information and data are not compromised. User Account Control (UAC) allows a user to change
computer settings while running as a standard user, instead of requiring administrator privileges to
perform most tasks.The updated Windows Defender utility detects malware on your system and,
when used in conjunction with SpyNet, can help eliminate most spyware attacks and exploits.The
new Windows Security Center (WSC) is full of configurable options and tools to help you build a
strong security posture so you can safely surf the Internet without constantly worrying about your
system.As you can see, there are many ways you can apply defense in depth for a more secure
computing environment.
Solutions Fast Track
Managing the Windows Firewall and IPSec

You should enable the Windows Firewall on all Vista computers unless you are already
using a reliable third-party ﬁrewall product.

Conﬁgure inbound exceptions to the Windows Firewall with care, ensuring you are only
allowing inbound trafﬁc that originates from trusted sources.

Use Group Policy Objects to create a consistent Windows Firewall conﬁguration for
networked computers in a small ofﬁce or larger corporate environment.
www.syngress.com
316
Chapter 8 • Managing Security Essentials

Managing Patching

You can turn on automatic updating in the Windows Security Center, which will allow
Windows to monitor and download updates for you.

The Malicious Software Removal Tool can help you remove malware from your OS and is
usually downloaded via Windows Update.

You should periodically update every piece of software you install on your system.You can
do this by installing the latest updates, hotﬁxes, security patches, and service packs. Keep on
top of when new patches come out, and try to test and install them to keep your system at
its best.
Managing Malware Protection

Windows Defender provides continuous security against malware. If it detects anything
suspicious, it will alert you as to what it ﬁnds.

Windows Defender is composed of three separate agents. Internet agents are used to
monitor changes to Internet access settings, as well as to stop unauthorized connection
attempts via the network. System agents are used to monitor changes to your system’s
settings, like passwords and permissions.Application agents are used to monitor changes to
applications installed on your OS, such as Internet Explorer being modiﬁed by
downloadable toolbar applications.

Windows Defender is used locally to protect an end-user’s Web-browsing experience.
Windows Defender does not include enterprise management tools.

Windows Defender features an updated scanning engine, simpliﬁed alerting functionality,
multiple-language support, and other enhancements.
Managing Internet Browser Security

Internet Explorer 7 comes with Windows Vista by default as the built-in Web browser.
New features in Internet Explorer 7 help prevent the inception and spread of malware.To
help protect a user’s personal information and the security of Vista in general, Internet
Explorer 7 comes with many advances in security, as well as tools that protect users from
such malware attacks as phishing and spooﬁng. It also includes a new Protected Mode to
further secure a user’s browsing experience.

The new outbound ﬁltering feature in the Windows Firewall helps users apply more
granular control over trafﬁc traversing the ﬁrewall.

Phishing is the exploit that hackers use to obtain personal information from unsuspecting
users.The Microsoft Phishing Filter is new to Internet Explorer 7. It protects you from
phishing attacks while you surf the Internet
www.syngress.com
Managing Security Essentials • Chapter 8
317

Managing User Account Controls

UAC is used to secure access to administrative privileges by allowing only standard
accounts to have limited functionality.

Administrator accounts will run in Administrator Approval Mode by default, as will UAC.
If changes need to be made, the “shield” icon will appear, marking the use of, or need for,
administrative action. Unless turned off, UAC will be invoked when needed.

User accounts should not be able to do things they do not need to do.All that does is leave
the door wide open for malware (or other forms of attack) that could compromise these
accounts and allow access to system resources. Users should have only the privileges they
need, and nothing more. With Windows Vista, UAC is used to separate user privileges from
those that would require administrative rights and access.

UAC deﬁnes access security by ﬁrst limiting the surface area for attack.Accounts have been
redeﬁned so that if they are compromised, they will pose no security threat, but at the same
time will allow for nonthreatening tasks to be functional. When administrative privileges
are needed (such as when installing an application), the user will be prompted for an
administrator password. UAC makes user accounts safer by prompting the user for approval
before allowing her to perform any administrative tasks.

UAC is also easier to understand. Now, when users are prompted for credentials, UAC
more clearly deﬁnes what process is invoking it.

UAC will also help shield users from malware and other exploits by allowing each user that
is deﬁned to require an administrative password to be able to see and use content on the
Web. With UAC and parental controls, users can now enjoy a safer Web surﬁng experience,
and children will not so easily be duped into doing things that compromised security in
the past.
www.syngress.com
318
Chapter 8 • Managing Security Essentials

Q: I have an infected system and I cannot ﬁgure out what is wrong. Where can I ﬁnd further infor-
mation on the Internet? 
A: Information about speciﬁc viruses and instructions on how to clean an infected system is available
at www.symantec.com and www.mcafee.com. Both antivirus vendors provide detailed databases
that list and describe known viruses. For more information on viruses, worms, and Trojans, see
the article “How Computer Viruses Work,” at www.howstuffworks.com/virus.htm.
Q: Malware has completely taken over my PC and I cannot do anything to ﬁx it. What is the best
next step?
A: You used to be able to clean up most malware infections using various kinds of specialized
antivirus and antimalware software. Sadly, this is no longer the case. Once upon a time, malware
was written by amateurs and teenagers. But now, many very skilled programmers work on mal-
ware because it is a money-making business. Malware has become so insidious that it is often
impossible to remove without expert or professional help.
You should ﬁrst attempt to remove an infection with automated tools. If that fails (and most
likely it will), there are two classes of antimalware software you should use.The ﬁrst is traditional
antivirus software, which is very good at handling viruses and worms and not so great at han-
dling newer styles of malware.The other kind of software is antispyware software, which is good
at the newer sort of malware but not so good at the old kind. When attempting to clean up an
infected system, you should run at least one of each. If you were running antivirus software when
you became infected, you should see whether it was keeping itself up-to-date, or try running a
different program. Proven antivirus software companies include Symantec (a.k.a., Norton),
McAfee, Panda Software,Trend Micro, F-Secure, Eset (maker of NOD32), and Kaspersky Labs.
Many of these companies have free Web-based scanners (ironically based on ActiveX) or down-
loadable tryout versions.
Antispyware software is a little more difﬁcult.The various antivirus companies have been in
business a long time, but antispyware is a new kind of software that was born at the same time as
the modern age of malware.Therefore, many antispyware software companies are either incom-
petent or outright frauds.
It’s been discovered that malware is very quickly outgrowing the capability for automated
software to clean it.The automated tools you try may not work, even if you try multiple ones.
Therefore, you will probably end up having to get help. Many local computer repair companies
www.syngress.com
Managing Security Essentials • Chapter 8
319
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

can clean infected computers.You may know an expert who is willing to help you. Sometimes
the experts will tell you that the best or only way to take care of a really bad infection is to back
up your personal data, clean out the computer completely, and start from scratch.They are not
lying.Attempting to eradicate an infection by hand can be extremely time-consuming and is
often unsuccessful, even for experts.
Q: Exactly how does social engineering work? Why would anyone reveal his password to a stranger?
Does this really happen?
A: Yes, it really happens—and more often than you might think. Skilled social engineers are good
con artists; they are masters at making other people trust them. In large companies, employees
often aren’t personally familiar with all other employees, so it’s relatively easy for the social engi-
neer to stroll in or even call on the phone and persuade a user that he is a member of the IT
department and needs the user’s password.The social engineer might have a convincing story,
saying, for instance, that a hacker has gotten into the system and discovered all the password ﬁles,
and now the IT department needs to know everyone’s old password so they can reset them and
issue new ones to protect against the hacker. Like all con artists, the social engineer usually plays
on common human emotions. For example, the engineer will play up the danger that the hacker
can access and destroy all of the user’s data if the “IT worker” doesn’t get the password immedi-
ately and make the change. In other cases, the engineer might exploit other emotions, such as
people’s natural desire to help, claiming that the “IT worker” will get in trouble with the “big
boss,” maybe even lose his job, if he is unable to get the password information needed. Social
engineers are not above appealing to the user’s ego or pretending sexual/romantic interest in the
user to get the password, either.Although some might not categorize it as social engineering,
another technique involves simply spying on the user to obtain the password (“shoulder surﬁng,”
or looking over the user’s shoulder as she types the password), or going through the user’s papers
to ﬁnd a written record of the password. Infamous hacker Kevin Mitnik is quoted as saying “You
can have the best technology, ﬁrewalls, intrusion-detection systems, [and] biometric devices.All it
takes is a call to an unsuspecting employee who gives up the information needed.”
Q: Do I need additional antimalware and spyware tools now that Vista and Internet Explorer are
supposedly more secure and provide them? 
A: With Windows Vista and Internet Explorer 7, you are deﬁnitely more secure than you were using
older versions of the OS and Web browser.The fact is that you now get these applications with
the base OS instead of having to pay for, or download, a third-party vendor’s utility. Vista does
not come with antivirus software, so you will need to acquire that separately. What Vista does
have is a built-in spyware tool that helps prevent “some” malware exploits from taking place.
Vista also has a built-in host-based ﬁrewall. Make sure you add antivirus software for full 
protection.
www.syngress.com
320
Chapter 8 • Managing Security Essentials

321
Securing 
User Access 
Solutions in this chapter:
■
Improving the Logon Architecture
■
User Account Control
■
Managing User Accounts
Chapter 9
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Improving the Logon Architecture
When a user logs on to Windows, they are given access to local resources and, in Active Directory
environments, network resources.Today, companies are asking for more than just a username and
password.They require multifactor authentication that uses both a password and a smart card, bio-
metric identiﬁcation, or a one-time password token. With Windows XP and earlier versions, imple-
menting custom authentication methods required developers to rewrite the Graphical Identiﬁcation
and Authentication (GINA) interface. In addition, Windows XP only supported one GINA at a time.
When Windows Vista was on the drawing board, much effort went into redesigning the logon
architecture.The logon architecture is the grouping of systems and subsystems that allow you to log
on to your workstation. With Windows Vista, the new logon architecture provides enhanced security
beneﬁts. Besides offering an improved, stable, and more reliable logon experience, Microsoft has com-
pletely rewritten the logon architecture to ensure any services or functions not directly related to the
logon process are now removed and used in other subsystems within Windows Vista.
The logon architecture has been designed to facilitate more secure forms of authentication, such
as smart cards and/or biometrics, to name a few. With this redevelopment, Microsoft made sure there
was a stronger level of security that could be used when a user logged on to a system. Because the
logon architecture has been extended to meet new security demands, developers can now easily work
with new credential types by using the new Credential Provider, an application programming inter-
face (API) that allows the Vista OS to remain secure, while still enabling developers to write or
develop code to interact with the OS.This requires less development time and effort, thus opening
the door for more organizations to offer custom authentication methods with Windows Vista.
The Credential Provider API was created to support multiple credential types when logging on
to the Vista system. Because Windows Vista doesn’t support the use of a GINA, it’s important that
new Credential Providers handle this function. With the use of the Credential Provider API, you can
now choose or combine multiple authentication methods when logging on to Vista.The Credential
Provider also allows developers to manipulate the existing architecture to build new or future
methods of authentication into Windows Vista.
The Windows Vista logon architecture has also been redesigned to accommodate new security
features that will make malware and other forms of exploitation almost nonexistent. When you log
on to a Vista system, your logon request is handled by three separate sections: the Access Control ser-
vices, the Cryptography services, and the secure OS (as shown in Figure 9.1). Within the Access
Control module, you ﬁnd Authentication services such as two-factor authentication, logon, and iden-
tity controls.Authorization is handled by processes such as Discretionary Access Control (DAC),
Mandatory Access Control (MAC), and Role-Based Access Control (RBAC), which is used to
restrict system access to authorized users.The Access Control module also handles auditing functions
such as event logging. Credential management is handled within this module as well, so any use of a
certiﬁcate server or smart card resides here in the Access Control module.
www.syngress.com
322
Chapter 9 • Securing User Access

Figure 9.1 Access Control, Cryptography, and Secure OS Services
Cryptography services are used to secure a user’s logon experience.This is done by using X.509,
or the cryptographic application programming interface (CAPI), which is the cryptographic library
provided with Microsoft Windows Vista. Once the secure OS is reached, new features such as isolated
desktop and kernel-mode signing are utilized.
Impact of Session 0 Isolation
In Windows XP, Windows Server 2003, and earlier versions of the Windows OS, all services run in
the same session as the ﬁrst user who logs on to the console.This session is called Session 0. Running
services and user applications together in Session 0 poses a security risk because services run at ele-
vated privileges and therefore are targets for malicious agents looking for a way to elevate their own
privilege level. Figure 9.2 shows how services and applications run within the same session. Each sub-
sequent session is generated by a new logged-on user, as well as by remote users.
The Windows Vista OS mitigates this security risk by isolating services in Session 0 and making
Session 0 non-interactive. In Windows Vista, only system processes and services run in Session 0, as
shown in Figure 9.3.
www.syngress.com
Securing User Access • Chapter 9
323
Secure Startup
Isolated Desktop
Kernel Mode Code 
Signing
Secure Operating System
CAPI
Cryptography Services
CNG
X.509 Processing
Credential 
Managment
Certificate Server
Lifecycle Mgmt
Credential Roaming
Smart Cards
Eventing
Audit
Logging
Common 
Criteria
FIPS
Policy exp.
RBAC
Persistence
Authorization 
MGR
Identity
Protocol
Logon
2 Factor AuthN
Authentication
Authorization
Access Control

Figure 9.2 Session Utilization under XP and Server 2003
Figure 9.3 Session Utilization in Windows Vista
324
Chapter 9 • Securing User Access
Application 1
Application 2
Application 3
Application 4
Application 5
Application 6
Application 7
Application 8
Application 9
Service 1
Service 2
Service 3
Session 0
Session 1
Session 2
Service 1
Service 2
Service 3
Session 0
Session 1
Session 2
Application 9
Application 8
Application 7
Application 6
Application 5
Application 4
Application 1
Application 2
Application 3
Session 3
www.syngress.com

The ﬁrst user logs on to Session 1, and subsequent users log on to subsequent sessions.This
means that services never run in the same session as users’ applications, and are therefore protected
from attacks that originate in application code. Figure 9.4 is a view of the Windows Task Manager
showing applications using the logged-on user’s ID running in Session 1 while services are running
in Session 0.
Figure 9.4 Session Utilization as Shown in Task Manager
So what is the difference between the logon architecture of XP and that of Vista? The difference
is that anything that directly interfaces with the user will run in Session 1. Services, as we’ve already
seen, will reside in Session 0 and are therefore protected from the user and anything that tries to pig-
gyback on them. In Figure 9.5, we’ve outlined how the WinLogon architecture looked in Windows
XP.You notice that WinLogon runs in every session. It initiates the logon process and directly inter-
faces with the local security authority (LSA), the service control manager (SCM), and, of course, the
shell itself.
In Windows Vista, this changes. WinInit spawns the LSA and the SCM in Session 0, as shown in
Figure 9.6.The SCM initiates Proﬁles, Group Policy, and other modules. In other sessions, WinLogon
handles each credential provider under the Logon User Interface (LogonUI).Thus, we have a securer
logon architecture.
www.syngress.com
Securing User Access • Chapter 9
325

Figure 9.5 The WinLogon Architecture in XP
Figure 9.6 The WinLogon Architecture in Vista
326
Chapter 9 • Securing User Access
LSA
SCM
Shell
Shell
User Group 
Policy
WinLogon
Session 0
Machine 
Group Policy
Profiles
MSGINA
Additional Sessions
WinLogon
User Group 
Policy
MSGINA
Session 0
Additional Sessions
WinInit
WinLogon
LSA
SCM
RCM
Profiles
Group Policy
Credential 
Provider 1
Credential 
Provider 2
Credential 
Provider 3
Logon User Interface
www.syngress.com

User Account Control
With so many threats attaching themselves to a user’s ID and security level, how do we protect users
from… well, themselves in essence.The ﬁrst thing that needs to happen is a change in the mindsets
of administrators.Yes us! For years now, we’ve been giving end users carte blanche by making them
local administrators on their PCs.This, of course, has opened up these systems to numerous risks.
Well it’s not all our faults.The fact is many of us gave users local administrator rights to their systems
because the lack of functionality provided by a regular user account made it impracticable to use and
limited functionality to the point that it affected productivity. Many older applications would only
run with administrative privileges.Adding a printer driver or even changing the time zone required
administrator rights. So, as you see, it really wasn’t our fault.
Now enter User Account Control (UAC). No other feature in Windows Vista has received more
publicity good or bad than this one. So what is UAC? UAC is a feature in Windows Vista that
improves client security by making accounts that do not have administrative rights much easier and
more practical to use. It also helps us administrators in protecting us… from ourselves, but more on
that later. UAC basically provides the following beneﬁts, as shown in Table 9.1.
Table 9.1 UAC Beneﬁts
Beneﬁt
Description
Most applications can now 
New applications designed for Vista will not 
run without administrative 
require administrative rights. UAC, though, 
privileges.
virtualizes common ﬁle and Registry locations,
thereby providing backward compatibility with
earlier versions of Windows that do. 
Users are prompted by 
Standard users are prompted for administrative 
applications that require 
credentials by applications that do require 
administrative rights.
higher-level rights. Administrators, on the other
hand, are prompted to conﬁrm a speciﬁc action
where an application requires more rights than a
standard user.
Common Tasks no longer 
Users can now perform such tasks as changing 
require administrator rights.
time zones and others without administrative
rights.
System components display a 
Now end users no longer have to wonder if 
shield icon when administrative what they are about to do requires 
credentials are required.
administrative credentials. An icon with a shield
indicates when this is necessary.
Applications run as standard 
If a user logs on to Windows Vista with an 
users even if the administrator 
administrative account, the applications that 
is logged on.
he/she uses will run as a standard user.
www.syngress.com
Securing User Access • Chapter 9
327

So now that we know some of the beneﬁts UAC provides, what can a standard user do in
Windows Vista without getting a prompt that they couldn’t do in XP without administrative privi-
leges? That’s a good question and in the following you can see there are quite a few tasks:
■
Install critical Windows Updates
■
Change the time zone
■
Change display settings and the desktop background
■
View the system clock and calendar
■
Connect to a virtual private network (VPN)
■
Connect to a wired or wireless network
■
Add printers (as long as they haven’t been denied in a Group Policy)
■
Connect to another PC with Remote Desktop
■
Restore backed-up ﬁles from the same user
■
Connect and conﬁgure a Bluetooth device
■
Conﬁgure and synchronize with a mobile device
■
Change battery power options on laptops
■
Install ActiveX controls from administrative approved sites
■
Conﬁgure accessibility settings
■
Change their own passwords
Figure 9.7 shows a standard user attempting to install a new application. Standard users cannot
install or uninstall applications without administrative privileges.The user in this case is asked to type
in the administrator’s username and password. If the user does not have this, they will not be able to
install the application.
Figure 9.7 Standard User Prompted by UAC
328
Chapter 9 • Securing User Access
www.syngress.com

UAC uses color-coded prompts indicating the level of risk associated with an application or
command. Users need to be aware of each color prompt and what they mean.Table 9.2 lists the
UAC prompt colors and the risks associated with each.
Table 9.2 UAC Color Codes
Color
Description
Red
Policy will prevent the application from running and users do not
have an option of allowing it to execute.
Yellow
The application is unsigned, or it is signed but its certiﬁcate is not
trusted.
Green
The application is a component of Windows Vista—for example,
Microsoft Management Console (MMC).
Gray
The application is signed and trusted by the local computer.
How UAC Protects Administrators
Remember when we said that UAC helps protect administrators from themselves? Well, here’s how it
does it. UAC uses Admin Approval Mode which protects administrators from malicious software such
as malware, spyware, and even viruses. It achieves this by doing the following. When an administrator
logs on to Windows Vista, it generates two access tokens.The ﬁrst token is a standard user access token.
This token is used to launch explorer.exe and any applications the user launches.The second token
generated is the full administrator access token.This token is used only after the administrator conﬁrms
his/her intention to move forward at the UAC prompt. Figure 9.8 shows an administrator being
prompted by the UAC before agreeing to install a certain application. If the administrator clicks
Allow, the full administrator access token will be invoked by the Application Information service. If
he/she clicks Cancel, it won’t.
Figure 9.8 Administrator Prompted by UAC
www.syngress.com
Securing User Access • Chapter 9
329

Command prompts, on the other hand, need special consideration. When a standard user
attempts to run a command that requires administrative rights, UAC does not provide them with a
prompt.They are simply told “A required privilege is not held by the client,” as shown in Figure 9.9.
Figure 9.9 A Message Stating Administrative Rights Are Required for this
Command
To run a command that requires administrative rights, click Start, and then right-click
Command Prompt | Run As Administrator (as shown in Figure 9.10).
Figure 9.10 Run As Administrator with Command Prompt
After you enter the administrator credentials, the command prompt will have a title of
“Administrator: Command Prompt” (as shown in Figure 9.11), and the standard user can then per-
form the task they need to complete. In our case, this user needs to change the time on the system,
and unlike in earlier Windows versions they now can change the time.
www.syngress.com
330
Chapter 9 • Securing User Access

Figure 9.11 An Administrator Command Prompt
NOTE
Admin Approval Mode does not apply to the built-in Administrator account. This
account, by default, is disabled, protecting the system from attack.
Marking an Application
For applications that do not automatically run with administrative credentials, you can mark them to
run in an elevated fashion very easily by ﬁnding the application in which you want to conﬁgure,
right-clicking it, selecting the Compatibility tab from the Properties dialog box, and under
Privilege Level, selecting Run this program as an administrator (see Figure 9.12).
Figure 9.12 Marking Application
www.syngress.com
Securing User Access • Chapter 9
331

Applications need to be marked only if they require administrative credentials to run but do not
cause the UAC to automatically prompt the user. If the Run this program as an administrator is
grayed out, it most likely means the application is prevented from running in an elevated state, it does
not require administrative privileges to run, or the user is not logged on as an administrator.
UAC Virtualization
Remember in Table 9.1, we mentioned that one of the beneﬁts of UAC is its capability to virtualize
common ﬁle and Registry locations, thereby providing backward compatibility with earlier versions
of Windows that do require an application to run with administrative privileges. UAC in Windows
Vista virtualizes requests for protected resources providing compatibility with applications that were
not designed with UAC in mind.This is important for older legacy applications that ran on Windows
XP and 2000, which may assume the user has administrator rights and therefore attempt to write to
some protected resources like the Program Files or System folders.The following are redirected to
safer user-speciﬁc locations:
■
%Windir%
■
%Windir%\System32
■
HKEY_LOCAL_MACHINE\Software
■
%Program Files%
So how does this work? When a process running under the user’s context attempts to write to a
protected folder, UAC will redirect the request to the C:\Users\%username%\AppData\
Local\VirtualStore folder. Here is an example.A user named SWhitley runs an application that cre-
ates a log ﬁle and normally stores it in the C:\Program Files\MyApps\Logs directory as logs.txt. In
Windows Vista, this will succeed even though the Program Files directory is a protected resource.
How come, you might ask? Well, UAC will actually store the ﬁle logs.txt in the
C:\Users\SWhitley\AppData\Local\VirtualStore\Program Files\MyApps\Logs\logs.txt.The applica-
tion that SWhitley is using will believe its accessing and writing the log ﬁle to C:\Program
Files\MyApps\Logs, so it won’t miss a beat. SWhitley, on the other hand, will need to go to
C:\Users\SWhitley\AppData\Local\VirtualStore\Program Files\MyApps\Logs\logs.txt to access the
ﬁle directly. Remember UAC is only virtualizing for the sake of the application and not that of the
user. UAC’s virtualization allows applications that require administrative rights to run ﬂawlessly under
a standard user’s account.
Conﬁguring UAC
UAC settings can be modiﬁed and conﬁgured using Group Policies.Administrators also have the
ability to disable UAC via the Control Panel, msconﬁg.exe, or even by editing the Registry. We’ll
cover each of these techniques in greater detail in the next few sections.
www.syngress.com
332
Chapter 9 • Securing User Access

Group Policy Settings for UAC
UAC settings can be conﬁgured using local or Active Directory Group Policies by going to the
Computer Conﬁguration | Windows Settings | Security Settings | Local Policies |
Security Options node, as shown in Figure 9.13.
Figure 9.13 UAC Group Policies
The following UAC settings can be conﬁgured with Group Policies:
■
User Account Control: Admin Approval Mode for the Built-in Administrator
account Applies only to the built-in Administrator account, which enables UAC Admin
Approval Mode for it just like other administrator accounts. When this setting is disabled,
the built-in Administrator account in Vista acts like the Administrator account from XP,
thereby all processes run using Administrator privileges.
■
User Account Control: Behavior of the elevation prompt for administrators in
Admin Approval Mode  Set to Prompt for consent by default, this setting causes UAC to
prompt any time a process needs more than standard user privilege. Prompt for credentials
causes Admin Approval Mode UAC prompts to behave like those a standard user would
see, whereby the user must enter the administrative password to move forward. Elevate
without prompting reduces the security protection of UAC by automatically giving processes
administrative privileges.
www.syngress.com
Securing User Access • Chapter 9
333

■
User Account Control: Behavior of the elevation prompt for standard users  In
workgroup environments, this is set to Prompt for credentials.This causes the UAC to prompt
the user for the administrative username and password. In Active Directory domain envi-
ronments, this setting defaults to Automatically deny elevation requests, which disables the UAC
prompt because standard users aren’t expected to know the administrative username and
password and therefore there would be no need in even prompting them for it.
■
User Account Control: Detect application installations and prompt for elevation
Enabled for workgroup environments and disabled in domain environments. When
enabled, UAC prompts for administrator credentials any time the user tries to install an
application that attempts to make changes to protected parts of the system. Domain envi-
ronments that make use of Group Policy Software Install (GPSI) or Systems Management
Server (SMS) should not need this setting enabled.
■
User Account Control: Only elevate executables that are signed and validated
Great for environments that require all applications including in-house programs to be
signed and validated with a trusted certiﬁcate that increases security.This setting is disabled
by default, thereby allowing users to run any application whether it is signed or not.
■
User Account Control: Only elevate UIAccess applications that are installed in
secure locations Enabled by default, this setting causes Windows Vista to grant user
interface access to only those applications executed from Program Files, the
\Windows\System32 directory, or from one of its subdirectories.This setting prevents any
non-administrator from downloading and running an application.This is because non-
administrators will not have the necessary privileges to copy an executable ﬁle to one of
those locations.
■
User Account Control: Run all administrators in Admin Approval Mode Enabled
by default, this setting causes all administrator accounts, with the exception of the built-in
account, to use Admin Approval Mode.
■
User Account Control: Switch to the secure desktop when prompting for eleva-
tion Enabled by default, this setting caused the screen to darken in the background when
the UAC prompt appears.This darkening makes it difﬁcult for malware to emulate the
UAC prompt.
■
User Account Control: Virtualize ﬁle and Registry write failures to per-user
locations Enabled by default, this setting improves compatibility with older applications
that weren’t developed for UAC by redirecting requests for protected resources.
Disabling UAC in the Control Panel
The best method of managing and disabling UAC in domain environments is through Group
Policies, but in workgroup environments it may be easier to do it through the Control Panel.To dis-
able UAC via the Control Panel, do the following:
1.
Go to Control Panel | User Accounts | User Accounts | Turn User Account
Control On or Off.
www.syngress.com
334
Chapter 9 • Securing User Access

2.
To disable, remove the check mark beside Use User Account Control (UAC) to help
protect your computer (as shown in Figure 9.14) and then click OK.
Figure 9.14 Disable UAC via the Control Panel
3.
Restart your computer when prompted.
NOTE
Disabling UAC via the Control Panel disables it for ALL users that share a single PC,
not just for the one who disabled it. 
Disabling UAC via Msconﬁg.exe
The System Conﬁguration utility (better known to many administrators as msconﬁg.exe) has been
around since the days of Windows 98. In Windows Vista, msconﬁg.exe can be used to disable UAC
whether it’s temporarily to test if UAC is causing any compatibility issues or if an administrator is
looking to disable it for good.The steps in doing this are as follows:
1.
Click Start | Run, type msconﬁg.exe, and press Enter.
2.
The system conﬁguration utility opens, go to the Tools tab.
3.
Click Disable UAC, and then click Launch (as shown in Figure 9.15).
www.syngress.com
Securing User Access • Chapter 9
335

Figure 9.15 Disable UAC via msconﬁg.exe
BEST PRACTICES ACCORDING TO MICROSOFT
Microsoft highly recommends leaving UAC enabled for PCs in your organization. All
users including IT staff should log on with standard user privileges, while administra-
tors should use two different accounts: one account that runs as a standard user, and
a second in which, when prompted by UAC, the administrator can enter its username
and password.
SOME INDEPENDENT ADVICE
Make sure all developers on your network only use standard user accounts and not
administrative ones. This prevents programs that are being written from depending
on the user having administrator rights. It makes testing and debugging for devel-
opers a lot easier and more “real world.”
4.
A command window will appear, followed by a notiﬁcation bubble informing you that
UAC is disabled and that you must restart your computer to apply the change. Go ahead
and restart your computer.
www.syngress.com
336
Chapter 9 • Securing User Access

Disable UAC via the Registry
For the most part, no matter what version of Windows you run, you can always ﬁnd a way to turn
something on or off via the Registry. Disabling UAC is no different and can be easily done by per-
forming the following:
1.
Click Start | Run, type regedit.exe, and press Enter.
2.
The Windows Vista Registry will open. Go to
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System.
3.
Change the value for EnableLUA to 0 (as shown in Figure 9.16).This will disable the
UAC.You must restart your computer for the changes to take effect.
Figure 9.16 Disabling UAC in the Registry
NOTE
During the early beta period in Windows Vista, what’s now known as UAC was
known then as Limited User Access (LUA), which is why you see the EnableLUA
Registry key.
www.syngress.com
Securing User Access • Chapter 9
337

Managing User Accounts
User accounts in Windows are used for uniquely identifying each person that uses a computer and its
resources.Access is granted and restricted to user accounts.You can restrict who can log on to what
computer, access which printers, and use particular servers thanks to user accounts. Windows Vista
and its predecessors—such as Windows XP, 2000, and NT—assign a security ID (SID) to each user
account.This is actually what the operating system uses to identify a user account. When a user logs
on to a computer running Windows Vista, a security access token is created.This security access token
includes the username, the SID, and information about any security groups the account belongs to.
When UAC is enabled, any time a user attempts to perform an action, the operating system checks
the access token. If the user has the appropriate rights, they see nothing and can go about their busi-
ness, but any time their credentials do not have the proper permissions, they see the UAC prompt we
showed earlier in the chapter. Windows Vista like its predecessors (XP, 2000, and NT) checks a
resource’s Access Control List (ACL) to see what user accounts have access to a resource, what type
of access they have, or if that user account is explicitly denied access. Permissions and rights some-
times get intermingled when administrators and even consultants talk about them, but they are actu-
ally two types of access privileges. When we talk about permissions, we are referring to the ability to
access a particular object in some manner.An example would be if our user account has permission
to write to a folder on a drive formatted with NTFS.A right, on the other hand, allows a user to per-
form a particular systemwide action, such as changing the time on the clock.Although many of us
already know about user accounts, SIDs, access tokens,ACLs, the UAC, rights, and permissions, it’s
always good to refresh our memories once in a while.
Account Types in Vista
An account type is a simple way of describing a user account’s membership in a security group. Vista
has three user account types:
■
Administrator
■
Standard User
■
Guest
Each account type provides the user with a different level of control over his/her PC.
Administrators obviously have the most control, whereas Guest has extremely limited control of the
system. We’ll cover each user account type and some of the tasks that each can perform.
Administrator
The administrators group includes the ﬁrst user account you create when setting up Vista on a
system, along with the Administrator account, which is disabled by default and hidden.Administrators
in Vista, just like their predecessors, have full control of the system. Some of the tasks that administra-
tors can perform are
■
Grant rights to other user accounts
■
Conﬁgure the Windows Firewall
www.syngress.com
338
Chapter 9 • Securing User Access

■
Create, change, and delete user accounts and groups
■
Install and uninstall programs
■
Install and remove hardware device drivers
■
Share folders
■
Access all ﬁles on the system
■
Take ownership of ﬁles on the system
■
Restore system ﬁles from backup
■
Install ActiveX controls
■
Conﬁgure Windows Automatic Updates
Standard User
Standard users are members of the Users group in Vista. In Windows Vista, a standard user has more
authority than they ever have without sacriﬁcing security.The reason for this is because the limita-
tions we all experienced in previous versions of Windows became impractical for administrators to
keep their users as standard user accounts on their individual systems. So we were all pretty much
forced to make each user an administrator to their machine, sacriﬁcing security and system stability
for user productivity.Things have changed in Windows Vista.The following are some of the tasks that
standard users are able to perform:
■
Install approved ActiveX controls
■
View permissions
■
Change the password and picture of their own account
■
Safely use programs that have been installed on their systems
■
Conﬁgure a wireless connection
■
Add, modify, and delete ﬁles and folders within their own documents folder and in the
shared folder on the local system
■
Restore their own ﬁles from backup
■
Change the time zone
■
Log on in Safe Mode
■
Conﬁgure power options
Guest
Members of the guest group have similar privileges to standard user accounts but with more limita-
tions. Guest accounts in Vista are typically for users who do not have permanent accounts on an
individual computer or are not members of a domain.The guest account, by default, is disabled in
Windows Vista. Guests cannot do any of the following:
www.syngress.com
Securing User Access • Chapter 9
339

■
Access other user ﬁles located on the system
■
Install software or hardware
■
Change settings
■
Assign a password to any account
Creating User Accounts
When installing Windows Vista, you create one user account local to the system.The user you create
has an administrative account. If you upgraded from XP to Vista, all local user accounts were migrated
along with their group memberships.After Vista is installed, you can create additional user accounts
and groups either via the user interface or the command prompt using the net user command.
Creating a User with the User Interface
To create additional user accounts via the user interface just go to Start button | Control Panel |
User Accounts.You should then see the User Accounts screen, similar to that shown in Figure 9.17.
Figure 9.17 User Accounts within the Control Panel
As you can see under User Accounts in Figure 9.17, you have the option to change your
account’s picture, provide other users access to the computer, or even change the account type of an
existing account. For now, let’s create a new local user account in Vista.
www.syngress.com
340
Chapter 9 • Securing User Access

To create a new user under User Accounts, select Give other users access to this com-
puter. If the UAC is enabled, you will be prompted for the administrator’s credentials. If you are
logged on as an Administrator, you can choose to Continue, so let’s do just that and Continue.
Next, you will see a screen that shows the existing user accounts on the system, similar to the
one in Figure 9.18. Our system currently has the original user account named Gene, which we cre-
ated during setup. From here click the Advanced tab at the top.
Figure 9.18 Users for this Computer
In the Advanced tab within the User Accounts screen, you see sections for passwords,
advanced user management, and secure logon, as shown in Figure 9.19.The passwords area allows
Windows to store your logon credentials for such things as servers, web sites, and even programs.You
are also able to back, restore, or even transfer your credentials to another computer.The secure logon
section is where you can enable or disable the Ctrl + Alt + Delete prompt. For our example, we
will go to the Advanced User Management area since this is where we can create, delete, or
modify users and groups. Click the Advanced tab from here.
Now you should see the MMC for Lusrmgr – [Local Users and Groups (Local)\Users]
similar to the one shown in Figure 9.20.You’ll notice on the far left side underneath Local Users
and Groups (Local), two folders: one folder for Users and the second for Groups.To create a new
user, right-click the Users folder and select New User.
www.syngress.com
Securing User Access • Chapter 9
341

Figure 9.19 The Advanced Tab in User Accounts
Figure 9.20 Lusrmgr – Local Users and Groups
TIP
To quickly bring up the Lusrmgr console, just pull up a command prompt and type
Lusrmgr.msc, then press Enter. Et voilà! The Lusrmgr console appears.
We now come to the New User screen shown in Figure 9.21. Here we will create our new user:
Samantha Whitley.We will use a naming convention that takes the user’s ﬁrst initial and combines it
www.syngress.com
342
Chapter 9 • Securing User Access

with their last name to come up with the username. So user Samantha will have a username of
swhitley.We can optionally include the user’s full name and a description, both of which we have done
here.Also we have typed in a temporary password for swhitley and have set Vista to force her to
change her password at the next logon. Once we’ve ﬁnished here, we can click Create at the bottom
of the dialog screen.After you create the user, the New User screen becomes blank waiting for you to
create another user. Since we are only creating one user, you can go ahead and click Close to ﬁnish.
Figure 9.21 Creating a New User
Now that our user account has been created, we should see it listed under Lusrmgr, which we
do in Figure 9.22.
Figure 9.22 Lusrmgr with the New User Account Created
Creating a User Account via the Command Prompt
Creating a user account with the user interface looks pretty easy, so why would anyone use the com-
mand prompt for creating users? One reason is if you need to create numerous users on a system.To
www.syngress.com
Securing User Access • Chapter 9
343

do that via the user interface is possible but incredibly tedious.That’s where the net user command
comes in.The parameters for the net user command are shown in Table 9.3.
Table 9.3 net user Parameters
Parameter
Description
Password or * or /random
Sets the password. By typing an asterisk (*), the net
user command will prompt you for a password to
assign to the account. The /random switch generates
an eight-character password for the user.
/add
Creates a new user account. 
/fullname:“name”
Speciﬁes the user’s full name.
/passwordchg:yes or 
Speciﬁes whether the user is allowed to change 
/passwordchg:no
their password.
/active:no or /active:yes
Disables or enables the user account.
/expires:date or 
Sets the expiration date for the account. If you use 
/expires:never
the date parameter, use the format that is set in the
Regional Options. 
/passwordreq:yes or 
Speciﬁes whether the user account is required to 
/passwordreq:no
have a password or not. If set to no, the password can
be blank.
/times:times or /times:all
Set the times when the account is allowed to log on
to the system. When specifying times, enter the days
of the week you want to allow the account to log on.
Let’s walk through an example on how you create a user via the net user command.
1.
Click the Start button, then right-click the Command Prompt, and select Run as
administrator.The UAC will prompt you, letting you know that Windows needs your
permission to continue. If you are already an administrator, just click Continue. If you are
not, you need to provide the administrator’s credentials to move forward.You will now
come to a command prompt.
2.
For our example we will create a user named Robert Jordan. Just as before, the username
will consist of the user’s ﬁrst initial and their last name. Robert’s username will be rjordan.
To create Robert’s user account, we would type the following at the command prompt:
net user rjordan /add /random /Passwordchg:yes /Passwordreq:yes /Fullname: “Robert Jordan”
/Comment:“Robert Jordan’s Standard User Account”
Figure 9.23 shows us that the account has been created successfully and that rjordan’s
randomly created password is VJsA#8$V.
www.syngress.com
344
Chapter 9 • Securing User Access

Figure 9.23 Creating a User Account with the net user Command
By looking at Lusrmgr, you can see the user rjordan listed in the Users folder (as shown in
Figure 9.24).
Figure 9.24 Lusrmgr, Showing All User Accounts on the PC
Adding Users to Local Groups
Just as we created users in Vista using both the user interface and the command line, we can do the
same with groups. Let’s walk through creating a group and adding a user to that group using both the
user interface and the command line.
Using the User Interface for 
Creating Groups and Adding Users
To create a local group on a system running Windows Vista, we need to pull up the Lusrmgr con-
sole. Remember our shortcut in doing that is to click the Start button and click the Command
prompt. In the command prompt, just type Lusrmgr.msc and press Enter.To create a new local
group, do the following:
1.
When in Lusrmgr, go to the left window pane, right-click Groups, and select New
Group.
2.
The New Group screen will appear (as shown in Figure 9.25).Type in the name you want
to call the group beside the Group name entry.The name of the group we are creating is
www.syngress.com
Securing User Access • Chapter 9
345

called UIGroup.You can also type a description of the group in the space beside
Description. Our description is Group created via User Interface.
Figure 9.25 The Create New Group Screen
3.
As you can see on the New Group screen, we can add members to the group, so let’s do
that. Click Add. You will now come to a screen called Select Users. If you’ve ever added
users to groups in Windows XP or Windows 2003 Server, this screen should look familiar
to you. In the Select this object type, leave it as Users or Built-in security
principals. In the From this location section, we need to point to the local workstation’s
name. If your system is not a member of a domain, it should already have your machine’s
name entered. If you are a member of a domain, to add local users to a new local group
you’ll need to click the button labeled Locations. On the Locations screen, choose your
local workstation from the list and click OK. Back at the Select Users screen, we need to
type in the username of the user we want to add to our group. In this example, we’ve
chosen rjordan.After you type the username, click the Check Names button.You should
now see a screen similar to Figure 9.26. Click OK.
Figure 9.26 Select Users
www.syngress.com
346
Chapter 9 • Securing User Access

4.
Back at the New Group screen, notice that the user is now listed as a member of our
newly created local group (as shown in Figure 9.27). Now all we need to do to make it
ﬁnal is click Create.After clicking Create, the New Group screen comes back up blank.
Just click Close since we will not be creating another group.
Figure 9.27 User Added to New Group
In the Lusrmgr console in Figure 9.28, you can see in the middle pane that our group UIGroup
is listed. If you double-click the newly created group, you’ll notice rjordan is a member of the
UIGroup (as shown in Figure 9.29).
Figure 9.28 A Newly Created Local Group in Lusrmgr
www.syngress.com
Securing User Access • Chapter 9
347

Figure 9.29 UIGroup’s Properties
Using the Command Line for 
Creating Groups and Adding Users
Creating local groups and adding users via the command line is quite simple.As we discussed previ-
ously, a good use of command-line tools such as the net command is if you have numerous groups
and users that need to be created, doing so using a script makes more sense than individually adding
them via the user interface. In this example, we will create a new local group called CMDGroup and
add the user swhitley to it. Here is how to do it:
1.
Click the Start button, right-click the Command Prompt, then select Run as admin-
istrator. If you are an administrator, click Continue at the UAC prompt. If you are not an
administrator, you will need to enter the administrator’s credentials before moving forward.
2.
To create the new local group CMDGroup, we must use the net localgroup command. In the
command prompt, type the following command to create our local group (just as shown in
Figure 9.30):
net localgroup CMDGroup /add
3.
After the local group is created, we need to add users to it. For our example, we will add
the user swhitley.To do this, we will type the following command (as shown in Figure
9.31):
net localgroup CMDGroup swhitley /add
www.syngress.com
348
Chapter 9 • Securing User Access

Figure 9.30 Creating Local Group via Command Prompt
Figure 9.31 Adding Local User to Group via net command
We can now pull up Lusrmgr and see that our newly created local group CMDGroup is listed
(as shown in Figure 9.32). If we pull up the properties on CMDGroup, as we did for the UIGroup
we created earlier, you will see that swhitley is a member of the local group (as shown in Figure 9.33).
Figure 9.32 Lusrmgr Listing CMDGroup
www.syngress.com
Securing User Access • Chapter 9
349

Figure 9.33 CMDGroup Properties
Using a Guest Account in Vista
Guest accounts are used to allow users who do not have accounts on the local system to access it. By
default, the guest account is disabled.To enable the guest account, go to Control Panel | User
Accounts | User Accounts | Manage User Accounts. When the UAC prompt comes up, click
Continue if you are an administrator, if not enter the administrator’s credentials. Once the User
Accounts control screen appears, go to the Advanced tab. On the Advanced tab screen, go to the
Advanced user management section and click the Advanced tab there. Just as you saw earlier,
the Lusrmgr screen will appear. On the left side, click the Users folder.The middle window pane
will show the local users of the system, right-click the Guest account and choose Properties.You
will see the properties screen for the Guest account (as shown in Figure 9.34). Remove the check
mark beside Account is disabled, then click OK.
Once the Guest account is enabled, in the Lusrmgr management console, right-click the Guest
account and choose Set Password. You will see a screen titled Set Password for Guest, which is a
warning screen (see Figure 9.35).After reading the warning, click Proceed.
www.syngress.com
350
Chapter 9 • Securing User Access

Figure 9.34 Properties for the Guest Account
Figure 9.35 The Warning for Creating a Password for a Guest Account
Now you can enter the password you want to provide for the Guest account. Just type it in the
box beside New password, and then re-type it in the Confirm password box below (as shown
in Figure 9.36).After you’ve finished, click OK. Now the Guest account has a password and is
ready for use.
www.syngress.com
Securing User Access • Chapter 9
351

Figure 9.36 Setting a Password for a Guest Account
Summary
Windows Vista provides many new security beneﬁts to secure access to users’ systems. User access has
always been a concern for Windows systems, but with the release of Windows Vista, those concerns
have been addressed. Enhancements to the Vista logon architecture include replacing the old GINA
model with that of the Credential Provider API. Now it is easier for third parties to create custom
credential providers, thereby offering even more security than ever before. No longer is Session 0 in
Windows available for obvious exploit. Session 0 is no longer interactive with the user; it completely
isolates services from applications and therefore provides better security and stability to Windows
Vista.
A new feature called User Account Control (UAC) improves client security by making accounts
that do not have administrative rights easier and more practical to use, eliminating the old mindset
and practice of making end users the administrators of their own workstations. UAC also protects
administrators by prompting them any time a task, application, or process they invoke requires ele-
vated permissions. Virtualization is a way that UAC protects areas such as %Windir%,
%Windir%\System32, HKEY_LOCAL_MACHINE/Software, and %Program Files%. UAC can be
conﬁgured via Group Policies, the Control Panel, msconﬁg.exe, and the Registry.Administrator,
Standard User, and Guest are the three account types supported by Windows Vista.Administrators
can manage users and groups using the user interface console of Lusrmgr.msc or the net command in
the command prompt.
Solutions Fast Track
Improving the Logon Architecture

Windows Vista no longer supports the GINA model. Developers must now use the
Credential Provider APIs to create custom authentication methods

Users and the applications they load no longer interact with Session 0, which threatens the
stability of the OS platform. Only services are allowed in this session.
www.syngress.com
352
Chapter 9 • Securing User Access


WinInit replaces WinLogon in Session 0. It now interfaces with the local security authority
(LSA) and the service control manager (SCM) instead of WinLogon, which itself interacts
in Sessions 1 and above.
User Account Control

UAC helps users run as Standard Users with more ﬂexibility without sacriﬁcing security as
in years past when administrators made local users the administrators of their own
machines.

Standard Users in Vista can now do the following: Change the time zone, install Windows
critical updates, change display settings and the desktop background, and even add printers
as long as Group Policies haven’t been designed to prevent them from doing so.

UAC can be managed by Group Policies, the Control Panel, msconﬁg.exe, and the
Registry.

Applications that do not automatically run with administrative credentials can do so if they
are marked by conﬁguring the Privilege Level of the application’s properties.

UAC virtualizes the %Windir%, %Windir%\System32,
HKEY_LOCAL_MACHINE\Software, and %Program Files% areas.
Managing User Accounts

Windows Vista supports three account types:Administrator, Standard User, and Guest.

Both the original Administrator and Guest accounts are disabled by default.

Administrators can use Lusrmgr.msc to manage users and groups via the user interface.
They can use the net command at the command prompt to accomplish the same tasks if
they so choose.
www.syngress.com
Securing User Access • Chapter 9
353

Q: Why was the GINA removed in Windows Vista?
A: In earlier versions of Windows, the customization of interactive user logon was done by creating
a custom GINA. Custom GINAs were complex to create and sometimes required the help of
Microsoft Product Support Services (PSS) for successful implementation. Some implementations
of custom GINAs resulted in unintended side effects, such as preventing fast user switching
(FUS) and smartcard logon. GINAs are now replaced with a new modular Credential Provider
model that is easier to program and implement.
Q: Why are user applications no longer able to load in Session 0?
A: This is because running services and user applications together in Session 0 poses a security risk.
Services run at elevated privileges and therefore are targets for malicious agents who are looking
for a way to elevate their own privilege level.
Q: Doesn’t UAC actually limit a user on what he/she can do?
A: Not necessarily, UAC is what allows users to work in a secure environment without sacriﬁcing
their ability to perform the tasks necessary to do their jobs. Making users local administrators to
their own PCs was overkill and put the system and data as a whole at risk.
Q: I tried to log on to Vista with the built-in administrator account, but it won’t let me. How
come?
A: The built-in administrator account is disabled by default unless it is the only account on the
system.The built-in administrator account does not adhere to the Admin Approval Mode and
thus can be a security risk, which is why it is disabled by default.
Q: Which method is best for creating users and groups?
A: It depends on your situation. If you are creating a small number of users and groups, then using
Lusrmgr.msc is probably your best bet. If you have to create numerous users and groups at the
same time, then using the net command within a script is probably your best option.
www.syngress.com
354
Chapter 9 • Securing User Access
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

355
Tuning for 
Better Performance
Solutions in this chapter:
■
The Windows Experience Index
■
Optimizing Windows Startup
■
Optimizing the Hard Disk
■
Optimizing Memory
■
Optimizing Applications
■
Optimizing the Network Connection
■
Monitoring Performance
Chapter 10
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
A desktop that is slow and takes a long time to load applications must be tuned to ensure the best
performance possible. Indeed, purchasing expensive hardware upgrades can sometimes be avoided
with proper tuning. In this chapter, we will explore essential techniques to monitor and optimize
your desktop’s performance. We will learn how to optimize your startup performance, hard disk
speeds, and virtual memory to both better the performance of your applications and the overall com-
puter user experience.
With Windows Vista, each computer will receive a Windows Experience Index Score.This index
indicates the overall score of different core components of the computer. We will study how to inter-
pret this index score and what can be done to improve it. We will also cover details about optimizing
Windows startup, optimizing the hard disk, memory, application performance, and the network con-
nection. Finally, we will cover the performance monitoring tools included in Windows Vista.
The Windows Experience Index
The Windows Experience Index is new in Windows Vista.This is a score that the operating system
assigns to your computer based on the capabilities of core components of the computer.The higher
the score, the better the overall performance of the computer.These components and the basis of
their score are as follows:
■
Processor Calculations per second.
■
Memory Memory operations per second.
■
Graphics Desktop performance for Windows Aero.
■
Gaming Graphics 3D business and gaming graphics performance.
■
Primary Hard Disk Disk data transfer rate.
Each of these components is assigned a subscore, which is used to calculate the base score.The
base score is the lowest of all subscores. Note that graphics performance is divided into two different
sections: one for general Windows interfaces, including Aero, and a second for 3D gaming.At the
time this book was written, Microsoft had estimated the best experience index to be between 1 and
5.9. With upcoming advances in technology, these scores might reach a value of 8, 9, or even 10.
You can check the Windows Experience Index Score of your computer by using the
Performance and Information Tools utility.This utility can be opened by employing either of the fol-
lowing methods:
■
Click Start and type perf in the search box. Click the Performance Information and
Tools link that appears in the search results box.
■
Click Start | Control Panel | System and Maintenance | Performance
Information and Tools.
Figure 10.1 shows the Windows Experience Index Score for a typical computer.
www.syngress.com
356
Chapter 10 • Tuning for Better Performance

Figure 10.1 The Windows Experience Index Score
In order to understand the meaning of the Windows Experience Index Score, Microsoft has pro-
vided the following guidelines:
■
A computer with a base score between 1 and 2 will have acceptable performance levels to
run most general applications such as MS Ofﬁce and the Internet.This computer will not
be able to support Windows Aero or other advanced multimedia features of Windows
Vista.
■
A computer with a base score of 3 will run Windows Aero and many Windows Vista fea-
tures but only at the basic performance level.
■
A computer with a base score between 4 and 5 will be able to run all new and advanced
features of Windows Vista, including Windows Aero.
Once you understand the base score of the computer and the underlying subscores with indi-
vidual components, you can decide which components are degrading the overall performance of
your computer.You can then shop around and upgrade these components. In order to enable you to
check the details of how the subscores have been calculated, Windows Vista also provides details of
the scoring, which you can print and analyze. Click the link for View and print details. Figure
10.2 shows details of all the components considered to calculate the base score.
www.syngress.com
Tuning for Better Performance • Chapter 10
357

Figure 10.2 The Detailed Conﬁguration of the Computer
As noted earlier, the Windows Experience Index Score is assigned at the time of installation.
After you have upgraded one or more hardware components of the computer, open the Performance
Tools and Information utility. Click the Update My Score link to recalculate the subscores and the
overall base score of the computer.You will need to conﬁrm your administrative action by clicking
the Continue button in the User Account Control dialog box. On some computers, you may not
see the base score and subscores. Click the link for Score This Computer.
www.syngress.com
358
Chapter 10 • Tuning for Better Performance

SOME INDEPENDENT ADVICE
Usually, it’s best to try and upgrade those hardware components on your computer
that have the lowest subscore. For example, even if you have the latest Intel dual
core processor but have a graphics card with only 128MB memory, the base score will
be very low due to the limited graphics capabilities. Similarly, upgrading only the
RAM will not improve the overall score if some other component is driving the base
score low. So, it is a better idea to look for at least two components that have the
lowest subscore.
Optimizing Windows Startup
Often, nothing is more annoying for computer users than a long wait for system startup and shut-
down—and system startup and shutdown times signiﬁcantly increase when a computer is loaded with
applications.
Stopping a Program 
from Loading Automatically on Startup
If a number of programs load at system startup, you may notice a signiﬁcant slowdown in the process.
Many programs may start automatically with or without your knowledge.You can stop a program
from loading or starting automatically to help free system resources required during startup.This not
only improves the system startup time but also helps improve overall system performance during
normal operation.
The following procedure explains how you can stop a program from loading automatically when
your Windows Vista computer starts:
1.
Click Start | Control Panel | System and Maintenance | Performance
Information and Tools.
2.
Click the Manage Startup Programs link in the left-hand side panel.This opens the
Software Explorer window of the Windows Defender, as shown in Figure 10.3.
3.
If more than one user works on the computer, click the Show for all users button. Click
the Continue button in the User Account Control dialog box to conﬁrm your adminis-
trative action.
4.
Select Startup Programs in the Category drop-down menu. Notice the number of pro-
grams that are permitted to start automatically under the Classiﬁcation column.
5.
Click any unwanted program in the left-hand side panel.The details panel on the right-
hand side provides detailed information about the program, its publisher, ﬁle type, path,
size, version, installation date, location, and startup type.
www.syngress.com
Tuning for Better Performance • Chapter 10
359

Figure 10.3 Managing Startup Programs with Software Explorer
6.
Click the Remove or Disable buttons to remove the program or disable it from starting
automatically. Figure 10.4 shows the status of the PowerDVD application after it is disabled.
You can click the Enable button to enable the application again.
Figure 10.4 Disabling a Startup Application Using Software Explorer
360
Chapter 10 • Tuning for Better Performance
www.syngress.com

Turning Off Windows Features
Another method to speed up system startup performance is to turn off some of the built-in features
in Windows Vista.The more features you have enabled (or enabled by default), the more system
resources you need to support these features. By selecting only those features required for your
everyday job will speed up system startup as well as your overall system performance. For example,
you can turn off undesired features such as Games on a busy ofﬁce computer.You need to be careful
when selecting the features you do not need. Features such as Internet Explorer Access, Print
Services, Simple TCP/IP Services, and so on are required for the normal operation of the computer.
On a home computer, you may disable the Internet Information Service, SNMP Service, and/or the
Services for NFS.
Windows features can be turned on or off using the Programs and Features link in the
Control Panel.The following procedure explains the steps:
1.
Click Start | Control Panel | Programs.
2.
Click the link for Turn Windows Features On or Off under the Programs and Features
group.
3.
Click Continue in the User Account Control dialog box to conﬁrm your administrative
action.
4.
The Windows Features page is displayed (as shown in Figure 10.5).
Figure 10.5 Turning Windows Features On or Off
www.syngress.com
Tuning for Better Performance • Chapter 10
361

5.
Clear the checkbox for any undesired feature to turn them off. For a group of features,
expand the tree by clicking the + sign and selecting individual features.
6.
Click OK to save your settings and close the window.
NOTE
When you see a ﬁlled box against any group of features, this means that only some
of the features in this group are turned on. Click the plus sign (+) against the
checkbox to expand the tree.
Visual Effects
There is more you can do to enhance the performance for your computer. Needless to say, Windows
Vista comes loaded with a number of visual effects, including the new Aero interface.The new inter-
face contains a number of elements that control the appearance of the operating system. Chances are
you prefer to use only the selected visual effects, thus sparing signiﬁcant system resources for applica-
tions.The appearance and performance of Windows Vista can be adjusted as per your requirements.
The options you can conﬁgure to adjust visual effects are as follows:
■
Adjust for best performance This option disables all visual effects and ﬁne-tunes the
system for best overall system performance.
■
Adjust for best appearance This option enables visual effects for most of the Vista
interfaces.The visual effects further depend on the hardware conﬁguration of your com-
puter.
■
Customize visual effects You can select visual effects manually.
Alternatively, you can let Windows decide what is best for your computer, which is the default
setting. In this setting, Windows takes care of your computer hardware and decides which visual
effects will optimize both the best appearance and performance.
To manually conﬁgure any of the visual effects, complete the following procedure:
1.
Click Start | Control Panel | System and Maintenance | Performance
Information and Tools.
2.
Click the Visual Effects link in the left-hand side panel. Click the Continue button in
the User Account Control dialog box to conﬁrm your administrative action.
3.
The Visual Effects window is shown in Figure 10.6. Note that Let Windows choose
what’s best for my computer is selected by default.
www.syngress.com
362
Chapter 10 • Tuning for Better Performance

Figure 10.6 Adjusting Visual Effects
4.
Select the radio button for Adjust for best appearance or Adjust for best perfor-
mance, as required.
5.
Alternatively, select the Custom button to choose individual visual effects.
6.
Click OK to save your settings and close the window.
When you select the Custom button in the Visual Effects tab of the Performance Options
window, the following effects can be enabled or disabled:
■
Animate controls and elements inside windows
■
Animate windows when minimizing and maximizing
■
Enable desktop composition
■
Enable transparent glass
■
Fade or slide menus into view
■
Fade or slide tooltips into view
■
Fade out menu items after clicking
■
Show preview and ﬁlters in folder
■
Show shadows under menus
■
Show shadows under mouse pointer
■
Show thumbnails instead of icons
www.syngress.com
Tuning for Better Performance • Chapter 10
363

■
Show translucent selection triangle
■
Show window contents while dragging
■
Slide open combo boxes
■
Slide taskbar buttons
■
Smooth edges of screen fonts
■
Smooth-scroll list boxes
■
Use a background image for each folder type
■
Use drop shadows for icon labels on the desktop
■
Use visual styles on windows and buttons
You can enable or disable any or all of these visual effects. Remember that the more effects you
enable, the more system resources you will need to support them.This ultimately results in degrading
performance for both programs as well as background services. If the Vista desktop is being used
mainly for applications, consider disabling the nonessential visual effects.The deﬁnition of nonessential
visual effects depends on how the Vista computer is being used and the personal preferences of the
user. In a network environment, Group Policies can be used to allow or restrict use of visual effects.
Optimizing the Hard Disk
Hard disks are without doubt one of the core components of a computer system that affect the
overall performance of the system. Hard disks need regular maintenance so system read/write opera-
tions to the disk remain efﬁcient. Some of the most important tasks involved with disk maintenance
are covered in this section: Disk Cleanup, Disk Defragmentation, and checking the disks for errors
using the Check Disk utility.
Disk Cleanup
The available space on the hard disk of your computer keeps ﬁlling up over a period of time. Some
of the ﬁles are useful, while several others are not needed.These ﬁles include the Recycle Bin, tem-
porary Internet ﬁles, downloaded program ﬁles, temporary ﬁles created by applications, and so on and
so on.All these ﬁles take up a signiﬁcant amount of disk space, which ultimately affects the disk per-
formance.The performance of a disk that is relatively less ﬁlled up is much better than a disk that is
almost full of data.As the disk space is ﬁlled up, the read/write heads have to scan through more ﬁles
to fetch data, consuming more time.This results in poor disk performance. On the other hand, a disk
that has comparatively less ﬁlled up space is quick in searching for ﬁles and completing other disk-
related operations such as backups, virus scans, launching applications, and so forth. It is necessary to
clean up the disk regularly to save space as well as optimize disk performance.
Windows Vista gives you two options for disk cleanup.You can either clean up only your own
ﬁles or clean up ﬁles for all users.The Disk Cleanup dialog box can be opened using several methods,
including the following:
www.syngress.com
364
Chapter 10 • Tuning for Better Performance

■
Click Start and type disk in the Search box. Select the Disk Cleanup link in the search
results box.
■
Click Start | All Programs | Accessories | System Tools | Disk Cleanup.
■
Click Start | Run.Type Cleanmgr in the Run dialog box and press Enter.
The Disk Cleanup Options dialog box appears as shown in Figure 10.7.
Figure 10.7 Disk Cleanup Options
To start the Disk Cleanup process, follow these steps:
1.
To clean up only your ﬁles, click the My Files Only link.
2.
To cleanup ﬁles for all users of the computer, click the link for Files from all users on
this computer. Click the Continue button in the User Account Control dialog box to
conﬁrm the administrative action.
3.
Select the disk drive in the Disk Cleanup: Drive Selection dialog box. Click OK.
4.
The Disk Cleanup For (Drive:) window appears as shown in Figure 10.8.
Figure 10.8 Selecting Files for Cleanup
www.syngress.com
Tuning for Better Performance • Chapter 10
365

5.
Select the ﬁles you want to delete. Notice the total amount of disk space you will gain. If
you want to view the details of ﬁles selected for deletion, click the View Files button.
6.
When you have selected the ﬁles, click OK. Click the Yes button in the conﬁrmation
dialog box.
The Disk Cleanup in Windows Vista provides more options for cleaning up the disk if deleting
the ﬁles does not empty sufﬁcient disk space. If you want to clean up more ﬁles from your computer,
click the More Options tab.This is shown in Figure 10.9.
Figure 10.9 Deleting Programs, Features, and System Restore Files
Notice from Figure 10.9 that you are given two additional options to free up more space on the
hard disk.These are:
■
Programs and Features This opens the Programs and features Control Panel where you
can select the programs you do not use and can delete.
■
System Restore This option prompts you to delete all System Restore Point ﬁles except
the most recent one.
NOTE
It is always good to back up your computer before you use the Disk Cleanup feature.
You never know when you will make a mistake and delete some or all of your impor-
tant data ﬁles. Backup will ensure that any ﬁles deleted by error can be recovered
using backup media. Additionally, you must be very careful when deleting System
www.syngress.com
366
Chapter 10 • Tuning for Better Performance

Restore Point ﬁles. Use this option only if your computer is running trouble free.
Always restart your computer after the cleanup process is complete.
Permanently Deleting Files from the Recycle Bin
When you delete a ﬁle from your computer, it is usually sent to the Recycle Bin.This helps you
recover the ﬁle in case you have deleted it by mistake.The Recycle Bin is just like any other folder
on your hard disk and takes up disk space.To reclaim space used by the Recycle Bin and speed up
disk performance, you can permanently delete ﬁles stored in the Recycle Bin.The following proce-
dure explains the process:
1.
Right-click the Recycle Bin icon on the desktop and click Open.
2.
To delete just one ﬁle, right-click the ﬁle and select Delete.
3.
To delete all ﬁles from the Recycle Bin, right-click the Recycle Bin folder on the left-
hand side panel and select Empty Recycle Bin.Alternatively, you can also right-click the
Recycle Bin icon on the Desktop and select Empty Recycle Bin.
4.
Click Yes in the conﬁrmation dialog box.
Customizing the Size of the Recycle Bin
Windows reserves disk space for the Recycle Bin on all disk partitions. If you are running short of
disk space, you can set the size of this folder for each disk partition.The following steps explain the
procedure:
1.
Right-click the Recycle Bin icon on the desktop and select Properties.The Recycle Bin
Properties window is shown in Figure 10.10.
Figure 10.10 Setting Custom Size for the Recycle Bin Folder
www.syngress.com
Tuning for Better Performance • Chapter 10
367

2.
Select a disk or a disk partition.The Settings for selected location area shows the cur-
rently allocated disk space in MB on the selected partition. Enter the size in MB.
3.
Repeat the preceding step for each disk partition.
4.
If you want to permanently delete ﬁles from the computer without storing them in the
Recycle Bin, select the Do not move ﬁles to the Recycle Bin option. When this
option is selected, ﬁles and folders are immediately and permanently deleted instead of
being sent to the Recycle Bin.
5.
The Display Delete Conﬁrmation Dialog checkbox is selected by default. Clear this
checkbox if you do not want a conﬁrmation dialog box displayed when you delete ﬁles in
the Recycle Bin.
6.
Click OK to save your settings and close the window.
TIP
The main purpose of having the Recycle Bin in Windows operating systems is to give
the user a chance to review the deleted ﬁles and folders one more time before they
are permanently removed from the system. In case you have deleted a ﬁle acciden-
tally, you can check the Recycle Bin on the desktop and restore the ﬁle to its original
location. Open the Recycle Bin, right-click the ﬁle(s) and click Restore.
When you select the Do Not Move Files To The Recycle Bin option, the ﬁles are
immediately deleted from the system. Use this option carefully since the deleted ﬁles
are not recoverable. If a ﬁle or folder is accidentally deleted and you do not have a
backup of the ﬁle/folder, it will be permanently lost.
Disk Defragmentation
Disk fragmentation causes ﬁles on your computer to be scattered on different parts of the disk.This
usually happens when you install some application or delete a large number of ﬁles. When the ﬁles
are stored in a contiguous space on the hard disk, the system must do extra work to retrieve ﬁles
from the disk.This causes your computer to slow down. Disks become fragmented over a period of
time after continuous usage. Disk defragmentation helps rearrange the ﬁles on the disk to contiguous
spaces and thus improve disk performance.
NOTE
The Disk Defragmenter is included in Windows Vista as a utility. It used to be a snap-
in for the Computer Management Microsoft Management Console (MMC) in
Windows XP and older operating systems. 
www.syngress.com
368
Chapter 10 • Tuning for Better Performance

The Disk Defragmenter snap-in can be opened in several ways, including the following:
■
Click Start and type defrag in the Search box. Click the Disk Defragmenter link in the
search results box.
■
Right-click the Computer icon on the desktop and select Open. Right-click a disk and
select Properties. Click the Tools tab. Click Defragment Now.
■
Click Start | Run.Type Defrag.exe in the Run dialog box and press Enter.
You will be prompted to conﬁrm your administrative action. Click the Continue button in the
User Account Control dialog box.The Disk Defragmenter is shown in Figure10.11.
Figure 10.11 The Disk Defragmenter in Windows Vista
Notice that Disk defragmenter is scheduled to run automatically by default on preconﬁgured
dates and timings.You can turn off this default-scheduled task by clearing the checkbox next to the
Run on a schedule (recommended) option. If you wish to modify the schedule, click the
Modify Schedule button. Figure 10.12 shows the Modify Schedule dialog box where you can
reschedule the frequency, day of the week, and the time.
Figure 10.12 Modifying the Schedule for the Disk Defragmenter to Run
Automatically
www.syngress.com
Tuning for Better Performance • Chapter 10
369

Notice from Figure 10.12 that, by default, the disk defragmenter is scheduled to run on a weekly
basis.You will need to make sure the computer is powered on when the Disk Defragmenter is sched-
uled to run.The utility will not run if the computer is turned off at the time of scheduled defrag-
mentation. In case the computer is turned off, the scheduled defragmentation will not start. In this
case, the defragmentation will start at the next scheduled time.
When you click the Defragment Now button, the defragmentation starts immediately. Note
that it may take a long time before the defragmentation process is complete. Unlike Windows XP
and older operating systems, Disk Defragmenter in Windows Vista does not slow down your com-
puter.The Disk Defragmenter is run as a background process and does not affect the performance of
foreground applications.
Depending on the size of the hard disk and the amount of fragmentation that has occurred, it
may take several minutes to several hours before the process is complete.The completion time also
depends on how many applications are running when the defragmentation is in progress.
You can press the Cancel button any time you wish to cancel the disk defragmentation.
BEST PRACTICES ACCORDING TO MICROSOFT
In previous versions of Windows desktop and server operating systems, Microsoft
always recommended that you run the Disk Defragmenter when the computer is rel-
atively idle. Although this is still recommended and is done by default, you need not
wait for idle hours.
One of the major differences between the process of disk defragmentation in
Windows XP and older operating systems and the one in Windows Vista is that
Windows Vista does not slow down your computer during the defragmentation pro-
cess. Thus, you can defragment the hard disk at any time. You will hardly notice any
performance degradation during the process because Windows Vista will always give
priority to currently running programs instead of Disk Defragmenter, which is consid-
ered a background process. This simply means that unlike old Windows operating
systems, Windows Vista will not let the Disk Defragmenter program affect the per-
formance of currently running programs on the system.
In spite of this new feature, by default, the Disk Defragmenter is scheduled to
run automatically every Wednesday at 1 A.M. If you need to modify this schedule,
make sure the new defragmentation is set to occur when the computer will be least
used.
Checking Disks for Errors
The hard disk is probably the most important component of your computer system after the mother-
board. It is used as the main storage for the operating system, applications, and your data.After pro-
longed usage and millions of read and write operations, disks may become a performance bottleneck.
It is essential to regularly check the disk for errors so its performance does not suffer due to bad sec-
tors or ﬁle system errors.The Check Disk utility n Windows Vista helps you automatically detect and
recover bad sectors on the disk and ﬁx ﬁle system errors.
www.syngress.com
370
Chapter 10 • Tuning for Better Performance

You can open the Check Disk utility using any of the following methods:
■
Click Start and type chkdsk in the Search box. Click the chkdsk link that appears in the
search results box.
■
Right-click the Computer icon on the desktop and click Explore. Right-click a disk or
a volume and select Properties.The Check Disk is located under the Tools tab of the disk
properties.The Check Now button starts the Check Disk utility.
You will need to click the Continue button in the User Account Control dialog box to con-
ﬁrm your administrative action. Figure 10.13 shows the Check Disk utility.
Figure 10.13 The Check Disk Utility in Windows Vista
The Check Disk utility provides two options for checking and ﬁxing disk errors:
■
Automatically ﬁx ﬁle system errors This option is selected by default.The operating
system attempts to ﬁx ﬁle system errors when you click the Start button.
■
Scan for and attempt recovery of bad sectors When this option is selected, the
operating system scans and tries to recover information located on bad sectors of the disk.
One of the primary requirements of the Check Disk utility is that the disk must not be in use.
When you click the Start button, Windows Vista displays a dialog box indicating that the disk or the
volume is in use. Windows Vista gives you the option of scheduling the Check Disk process.This is
shown in Figure 10.14.
Figure 10.14 Scheduling Check Disk
www.syngress.com
Tuning for Better Performance • Chapter 10
371

Click the Schedule disk check button. Check Disk will run the next time the computer is
started.
NOTE
As with Windows XP, Windows Vista also includes disk compression and encryption
features. With disk compression, you can compress data stored on a disk to save disk
space. Similarly, with disk encryption, the data stored on a disk is encrypted to pre-
vent unauthorized access. While these two utilities are good to have, they also slow
down disk performance. With compression or encryption, the data must be com-
pressed or encrypted before it is written to the disk, which slows down write perfor-
mance. Similarly, the read performance of the disk suffers since the data must be
uncompressed or encrypted before it is sent to the requesting application or the
user. 
Optimizing Memory
Like other core components of the computer, such as the processor and the hard disk, memory also
plays an important role in overall system performance.The physical memory is dynamically allocated
to running system services and applications. Computer memory is mainly classiﬁed into two types:
physical memory, which is the Random Access Memory (RAM), and the Virtual Memory, a combi-
nation of the RAM and a fraction of hard disk space. Windows uses virtual memory when it runs
out of available RAM installed in the system. It also transfers data in and out of RAM as, and when,
required to make room for working programs.
For most applications and background system services, Windows Vista will automatically manage
the available physical memory installed in the system. In addition to this, Vista will also take care of
the virtual memory, which is used in case the physical memory is unable to handle all memory
requirements of systems services and applications.The process of writing information to virtual
memory is known as paging. The information is written to a paging ﬁle named pageﬁle.sys.
Windows automatically sets the initial size of the virtual memory equal to the amount of RAM
plus 300MB.The maximum amount can be as large as three times the amount of RAM. For better
performance, however, you should not set the maximum size to more than twice the amount of
RAM. Doing this might cause hard disk fragmentation. In this section, we will learn how to ﬁne-
tune the virtual memory settings in order to boost the overall system performance.
SOME INDEPENDENT ADVICE
Under ideal situations, the more RAM you have in the system, the better the system
performance. Virtual memory is only a temporary solution to a enhance performance
of a system that lacks sufﬁcient RAM. This is because the system can read and write
www.syngress.com
372
Chapter 10 • Tuning for Better Performance

data much faster on a RAM as compared to the hard disk. Consider upgrading RAM
instead of adjusting the size of the paging ﬁle.
Adjusting Virtual Memory
As noted earlier, if required, Windows Vista will automatically reserve a fraction of hard disk space to
be used as virtual memory or a paging ﬁle. Virtual memory is used as a temporary storage when the
system runs out of physical RAM. In most cases, you will not need to manually adjust the virtual
memory settings.Typically, Vista will allocate a minimum amount of virtual memory equal to the
amount of RAM in the system.The Task Manager, located in the Taskbar, provides a quick view of
memory usage in the system and can help you decide if you need to adjust the virtual memory set-
tings.The Resource Monitor also provides details on the available resources in the computer,
including system memory.Any of these two utilities can tell you if the system is running out of
memory. Under normal working conditions, if you are running out of virtual memory, Windows
Vista will display a warning message, indicating you need to adjust the size of the paging ﬁle.
Should you want to manually adjust the size of the paging ﬁle, the following steps will help you
understand the procedure:
1.
Click Start | Control Panel | System and Maintenance | Performance and
Information Tools.
2.
Click the link for Adjust Visual Effects on the left-hand panel.You will need to click the
Continue button in the User Account Control dialog box to conﬁrm your action.
3.
The Performance Options window opens. Click the Advanced tab.
4.
Click the Change button in the Virtual Memory section to open the Virtual Memory set-
tings page, as shown in Figure 10.15.
Figure 10.15 Setting Virtual Memory
Tuning for Better Performance • Chapter 10
373
www.syngress.com

5.
Notice that the Automatically Manage Paging File Size For All Drives option is checked,
while other options are grayed out. Click this option to clear the checkbox, as shown in
Figure 10.15.
6.
Select the hard disk drive in the Drive (Volume Label) box.This will provide informa-
tion about the existing size of the paging ﬁle on each drive. Note there are three options to
select for the paging File size: Custom Size, System Managed Size, and No Paging File.
7.
To manually adjust the paging ﬁle size, click the Custom Size radio button.
8.
Type the Initial Size and Maximum Size in MB.
9.
If you want to clear the paging ﬁle earlier conﬁgured, click the No Paging File radio
button.
10.
Review the information in the Total Paging File Size For All Drives section.This informa-
tion is helpful in determining the minimum, recommended, and currently allocated size for
the paging ﬁle on each drive.
11.
Click OK twice to close the Virtual Memory and the Performance Options windows.
NOTE
If you increase the size of the paging ﬁle on any drive, you may immediately start
using the increased size. However, when you decrease the size of the paging ﬁle on
any drive, you will need to restart the system so the changes can take effect.
Enabling Automatic Allocation of Virtual Memory
At any point in time, you can have Windows Vista automatically manage the size of the paging ﬁle
for all drives.This might become necessary when one of the users has incorrectly set the page ﬁle
size.You can revert to default settings by completing the following steps:
1.
Open the Virtual Memory settings page as described previously and shown in Figure
10.15.
2.
Click the Automatically manage paging ﬁle size for all drives checkbox.
3.
Review the information in the Total Paging File Size For All Drives section.
4.
Click OK twice to close the Virtual Memory and the Performance Options windows.
BEST PRACTICES ACCORDING TO MICROSOFT
Microsoft recommends that you never ever disable or delete a paging ﬁle. By
default, Windows Vista takes care of the requirements of the paging ﬁle size for
each drive; you will hardly need to adjust these settings. Normally, if the virtual
www.syngress.com
374
Chapter 10 • Tuning for Better Performance

memory is insufﬁcient, you will get a warning message. This is the time you will need
to adjust the paging ﬁle size manually.
Windows ReadyBoost
Another signiﬁcant addition to Windows Vista is the Windows ReadyBoost feature. Windows
ReadyBoost enables Windows to use a USB ﬂash drive instead of hard disk space to manage virtual
memory requirements. Since reading and writing data on a USB drive is much faster than the hard
disk, you can signiﬁcantly enhance system performance using this new feature.This helps improve the
overall system performance and user experience rating of the system.
The following conditions must be met in order to use the ReadyBoost feature:
■
The USB drive must be USB 2.0 ﬂash drives, Secure Digital (SD) memory cards, or
CompactFlash Cards.
■
The USB drive must be of the Fast Flash Memory type.
■
The size of the drive must be 512MB or larger.
■
The maximum amount of USB drive size you can use with ReadyBoost is three times the
size of physical RAM. For example, if you have only 512MB of physical RAM in the com-
puter, you can use a maximum of 1.5GB from two USB drives for the purpose.
Enabling ReadyBoost
The following procedure explains how you can enable Windows ReadyBoost for a particular USB
drive (removal storage device):
1.
Insert the USB 2.0 ﬂash drive into one of the available USB ports.This displays the
AutoPlay dialog box.
2.
If Windows Vista detects that the USB drive is fast enough to enhance performance using
the Windows ReadyBoost feature, it will display a Speed Up My Computer option in the
AutoPlay dialog box.
3.
Click the Speed Up My Computer Using Windows ReadyBoost option.This will
cause Windows to automatically use space from the USB drive for improving system speed.
Conﬁguring ReadyBoost Properties
The following procedure explains how you can conﬁgure Windows Vista to use space from a USB
2.0 drive to enhance system performance.
1.
Click Start | Computer to open Windows Explorer.
2.
Right-click the USB drive in the Removable Drives group and select Properties.
www.syngress.com
Tuning for Better Performance • Chapter 10
375

3.
Click the ReadyBoost tab. Click the Test Again button.This helps you test a new USB
ﬂash drive just in case a previously used USB drive did not support Windows ReadyBoost.
Figure 10.16 shows the properties of a USB 2.0 drive. Notice that the drive does not sup-
port the ReadyBoost feature in Windows Vista.
Figure 10.16 Testing a USB 2.0 Drive for ReadyBoost
4.
If the USB drive is found capable of supporting Windows ReadyBoost, click the Use This
Device radio button.
5.
Type the amount of space in MB to use from this drive or use the slider bar. Notice the
amount of space that Windows recommends.
6.
Click OK to close the Removable Disk Properties window.
NOTE
The amount of space you reserve on the USB drive for use with Windows ReadyBoost
will not be available for normal ﬁle storage. Also, note that Windows does not have
to use all of the available space on the USB drive. The remaining space can be used
to store your personal ﬁles.
Removing a USB drive being used for Windows ReadyBoost from the computer does not cause
any data loss if you safely remove the drive. Right-click the drive in Windows Explorer and select
www.syngress.com
376
Chapter 10 • Tuning for Better Performance

Eject or Safely Remove.You can also use the Safely Remove Hardware icon in the taskbar for this
purpose.
Protecting Memory from Malicious Applications
Windows Vista includes Data Execution Prevention (DEP), a memory protection application that
monitors the use of memory by applications. By default, it does not allow applications to use those
memory locations reserved for the system.This essentially helps protect the system from malicious
code that may insert itself into a system memory location. In other words, DEP is a security feature
that allows only system applications to use system memory locations. If DEP detects that any appli-
cation is inappropriately using system memory locations, it shuts down the application and displays a
message.
By default, DEP is enabled only for essential Windows services and applications.You can con-
ﬁgure DEP for all services and programs as well as specify exceptions. Vista provides this feature as a
software-based solution for protecting system memory. Some hardware vendors provide DEP as a
hardware-based solution. Even if your computer hardware does not support DEP, a malicious applica-
tion such as a virus program can be prevented by Windows Vista DEP from undesired use of system
memory.This helps in keeping the system stable by preventing inappropriate memory usage by mali-
cious software.
Enabling Data Execution Prevention
To check whether your computer supports DEP or not, or to enable DEP, use the following 
procedure:
1.
Click Start | Control Panel |System and Maintenance | Performance
Information and Tools.
2.
Click the Adjust Visual Effects link on the left-hand side panel.
3.
Click the Continue button in the User Account Control dialog box to conﬁrm your
administrative action.
4.
Click the Data Execution Prevention tab in the Performance Options window.The
DEP window is shown in Figure 10.17.
5.
Notice that DEP is enabled by default for essential Windows programs and services only.
The information on the bottom part of the window indicates that the computer’s processor
supports hardware-based DEP.
6.
To enable DEP for all programs and services (including Windows programs and services),
click the radio button for Turn on DEP for all programs and services except those
I select.
7.
Click the Add button to add exceptions. Select the applications for which you do not wish
to enable DEP.
www.syngress.com
Tuning for Better Performance • Chapter 10
377

Figure 10.17 Enabling Data Execution Prevention
8.
Click OK twice to close the Performance Options window.
Optimizing Applications
By default, Windows Vista gives priority to programs and applications over background services.
Unless you have a very speciﬁc reason to do so, you will hardly need to ﬁne-tune Windows Vista for
better application performance.Two options let you ﬁne-tune application performance:
■
Programs
■
Background Services
The default setting for Windows Vista is Programs.This means that programs and applications are
given priority over background services.You will need to change this setting only when you want to
prioritize background services over normal applications. Use this option if you have a Vista computer
as a server. For example, you might be using a Vista computer as a print server or as a Web server
where background services such as the print spooler service or the World Wide Web publishing ser-
vice is more important than any other foreground applications.
You can change the default performance settings to give priority to background services.This is
done by changing the Processor Scheduling options in the Performance Options utility. Processor
scheduling lets you choose whether you want to give priority to programs or to background services.
The following steps explain the procedure:
www.syngress.com
378
Chapter 10 • Tuning for Better Performance

1.
Click Start | Control Panel | System and Maintenance | Performance
Information and Tools.
2.
Click the Visual Effects link in the left-hand side panel. Click the Continue button in
the User Account Control dialog box to conﬁrm your administrative action.
3.
Click the Advanced tab in the Performance Options window.This tab is shown in
Figure 10.18.
Figure 10.18 Setting Processor Scheduling
4.
Click the radio button for Background Services under the heading Adjust For Best
Performance Of.
5.
Click OK to save your settings and close the window.
Optimizing the Network Connection
The performance of the network connection depends on several factors that include the speed of the
network, the throughput of the network adapters in the computer, the number of network drives
mapped, and so on.The number and performance of network applications currently running on the
computer also affect the overall network connectivity. In addition to this, you will notice that ﬁle,
printer, and media sharing, as well as the number of other computers connected to your computer,
will also call for more network resources on the local computer.
www.syngress.com
Tuning for Better Performance • Chapter 10
379

Before we cover some of the methods to ﬁne-tune network connections, we will discuss the
Software Explorer, one of the new utilities introduced in Windows Vista that can be helpful in
ﬁnding out information on network connected programs.
Using Software Explorer 
to Identify Network Connected Programs
The Software Explorer utility in Windows Defender can be a good source of information on all net-
work connected programs currently running on the local computer.These include programs running
on the local network as well as those running from the Internet such as MSN Messenger.You will
notice that if the computer is downloading something from the Internet or is installing some soft-
ware from the Internet, it is also shown in Software Explorer.
You can open the Software Explorer utility from within the Windows Defender.The following
steps describe the procedure:
1.
Click Start | Control Panel | Security | Windows Defender.Alternatively, you can
open the Windows Defender by typing defend in the Search box located in the Start
menu and selecting the link for Windows Defender.
2.
Click the Tools button.The Software Explorer link is located within the Tools and Settings
window.
3.
Select Network Connected Programs from the Category drop-down menu, as shown
in Figure 10.19.
Figure 10.19 Using Software Explorer to Find Network Connected Programs
380
Chapter 10 • Tuning for Better Performance
www.syngress.com

A close inspection of Software Explorer can offer a good look at all the network connected pro-
grams currently running on your computer. Since every network application consumes some amount
of system and network resources, you can check if some application is heavily consuming network
resources. If you identify an application that should not be running on your system, click the End
Process button to close it.
By default, Software Explorer displays only the network programs running under the context of
currently logged on user.To view all network programs for all users of the computer, click the Show
For All Users button. Click Continue in the User Account Control dialog box to conﬁrm your
administrative action.
Using Task Manager to View 
Network Performance and Connected Users
Another handy tool to check the network performance of your computer is to use the Task Manager.
The Task Manager provides a quick real-time view of the current network activities for all network
connections (or network adapters).Additionally, you can identify the users currently connected to
your computer.
Right-click the Taskbar and select Task Manager. Click the Networking tab in the Windows
Task Manager.This window provides a real-time graphical view of the current network activities of
the computer.The information provided is for all network adapters installed on the computer. Figure
10.20 shows the Networking tab.
Figure 10.20 Using Task Manager to View Network Performance
By default, the Networking tab of the Task Manager shows only the following information:
www.syngress.com
Tuning for Better Performance • Chapter 10
381

■
Name of Adapter
■
Network Utilization
■
Link Speed
■
State of the Connection
You can get more information, click the View menu and click Select Columns.You can select
more items to display, as shown in Figure 10.21.
Figure 10.21 Getting More Networking Information from Task Manager
Looking at the percentage of network utilization for a particular adapter, you can quickly deter-
mine if the connection is running as expected or if it is overused. Once you identify a bottleneck,
you can use other methods to reduce the load on a particular network adapter.A bottleneck is a par-
ticular component of the system that is not performing at expected levels. Identifying a performance
bottleneck depends on how the system is being used. For example, a slow network adapter in a ﬁle
server can quickly become a performance bottleneck.The network performance of a computer is
usually measured by the percentage of network utilization.This percentage of network utilization
should normally remain below 40 percent.This percentage is indicated in the Task Manager.
Using the Task Manager to View Connected Users
Another feature of the Task Manager is that it can provide a summary of all the network users con-
nected to your computer.This is helpful in determining the number of connected users and whether
or not their sessions are currently active. If you are facing network congestion, you can disconnect
some of the users. Open Task Manager and click the Users tab.The following options are available
on this page:
■
Log Off To forcibly log off a network user.
■
Disconnect To forcibly disconnect a network user.
www.syngress.com
382
Chapter 10 • Tuning for Better Performance

■
Send Message To send a pop-up message to a connected user.
When you wish to log off a network user or disconnect him from your computer, it is always
good to send him/her a message ﬁrst.This will allow the user to close any open programs or ﬁles and
save his/her work.
Using Reliability and Performance 
Monitor to View Network Performance
You can always use the Reliability and Performance Monitor for network activities and to identify
problem areas.The Reliability and Performance Monitor is an improved version of the Performance
Monitor in previous versions of Windows operating systems.The next section covers the Reliability
and Performance Monitor snap-in in detail. For this section, we will discuss only the networking
components we wish to monitor.
The following procedure will help you understand how you can use the Reliability and
Performance Monitor to monitor the network activities of the computer.
1.
Open the Reliability and Performance Monitor snap-in from the Administrative
Tools folder in the Control Panel.
2.
Expand the Monitoring Tools node and click Performance Monitor.
3.
Right-click the Performance Monitor window and select Add Counters.
4.
In the Add Counters window, you will notice a number of Object groups in the Available
Counters box. Each group has several performance counters.
5.
Click one or more of the network-related objects you wish to monitor in order to view
and select the counters for the group. For example, you may choose Network,TCPv4,
IPv4, or any other objects, and select one or more available performance counters. Click
the Add button for every counter you select.
6.
When ﬁnished, click the OK button to return to the Performance Monitor window.
The selected counters are displayed in the bottom part of the Performance Monitor window
while the activity for each counter is displayed as a graph in the main window. Figure 10.22 shows
the Performance Monitor window with some counters added for the Network Interface,TCPv4, and
IPv4 objects.
You will learn about creating performance alerts and gathering performance information in log
ﬁles in the upcoming section,“Monitoring Performance.”
www.syngress.com
Tuning for Better Performance • Chapter 10
383

Figure 10.22 Monitoring Network Performance
Improving Network Performance
Now, let us come to the main point of this section-improving network performance. If the computer
where you wish to improve network performance is a standalone computer or a home computer, you
need not worry about the network performance.This is because Windows Vista will automatically
take care of the best system and network performance. Network performance is important when the
computer is connected to a corporate network or in case it is being used as a print, ﬁle, or media
server. In this scenario, the network performance of the Windows Vista computer is indeed very
important.The following are some guidelines to improve network performance.
Uninstalling Unused Network Protocols and Services
Unwanted network protocols and services consume network resources.You should uninstall these ser-
vices and protocols if they are not used in the network. If you have multiple network protocols
installed for a particular network adapter, check their binding order as well.The Network and
Sharing Center in Windows Vista provides a central place to manage networking hardware, protocols,
and resource sharing. In order to view the protocols installed for a particular adapter, perform the fol-
lowing steps:
1.
Right-click the network icon on the Taskbar and click Network and Sharing Center.
www.syngress.com
384
Chapter 10 • Tuning for Better Performance

2.
In the Network and Sharing Center, click the Manage Network Connections link.
3.
Right-click the network connection (for example, Local Area Connection) and select
Properties.
4.
Click the Continue button in the User Account Control dialog box.
5.
In the Local Area Connection Properties window, check the installed protocols and
services for the network adapter.This is shown in Figure 10.23.
Figure 10.23 Viewing Protocols and Services for a Network Connection
6.
Clear the checkbox for a service or protocol that is not required.
7.
Click OK to save your settings and close the Properties window.
Keeping the Network Device Driver Updated
Manufacturers of network adapters keep updating the device drivers from time to time. Make sure
the network adapter in your computer has the latest or updated device driver.
Installing Fast Network Adapters
While most new network adapters support 100-Mbps network speeds and are full-duplex, if your
computer does not have a fast Ethernet adapter, you should install one in your computer.
Closing Unused Network Programs
If the computer is running unwanted network programs, you should close them.This will free up
system resources as well as improve network speed.As discussed earlier in this section, you can use
www.syngress.com
Tuning for Better Performance • Chapter 10
385

the Software Explorer in the Windows Defender utility to view network programs running on the
system. Using information from this utility, you can quickly determine from Task Manager if a net-
work program is taking up most of the system resources and then close it.
Disconnecting Unwanted Network Users
Allowing too many network users to connect to your computer deﬁnitely degrades its performance.
Use the Users tab of the taskbar to identify such users and log off or disconnect them if they are not
actively using your computer. Software Explorer also displays the names of users running network
programs.
Disconnecting Unused Mapped Network Drives
If any of the mapped network drives are not used anymore, disconnect them. Mapped network drives
affect network performance as well as Windows startup.You can use the Windows Explorer to dis-
connect any mapped network drive. Mapped network drives slow down the system startup as the
system attempts to reconnect to the mapped drives when it boots up.
To quickly view a list of mapped drives and disconnect any of them, right-click the Computer
icon on the desktop and click Disconnect Network Drive.The Disconnect Mapped Drive dialog
box appears as shown in Figure 10.24. Select a mapped drive and click Disconnect.
Figure 10.24 Disconnecting Mapped Network Drives
Turning Off Public Folder Sharing if Not Required
Public folder sharing should be turned off on home computers and on those connected to corporate
networks.This action improves security as well. Public folder sharing is turned off by default. In case
it has been turned on, you can turn it off again by completing the following steps.
www.syngress.com
386
Chapter 10 • Tuning for Better Performance

1.
Open the Network Sharing Center from the networking icon on the taskbar or by going
to the Control Panel and selecting Network and Internet.
2.
Locate the Public Folder Sharing link in the Sharing and Discovery section.
3.
Click the downward arrow button opposite Public Folder Sharing to view the options.
4.
Click the radio button for Turn off sharing (people logged on this computer can
still access this folder), as shown in Figure 10.25.
Figure 10.25 Turning Off Public Folder Sharing
5.
Click Apply and then click Continue in the User Account Control dialog box.
6.
Close the Network and Sharing Center window.
Turning Off Media Sharing If Not Required
If your computer is not used for running or sharing media ﬁles, turn media sharing off using the net-
work and Sharing Center. Media sharing is not turned on by default. In case you have previously
turned it on, you can turn it off again from the Network and Sharing center.The following proce-
dure explains the steps required to complete this action.
www.syngress.com
Tuning for Better Performance • Chapter 10
387

1.
Open the Network Sharing Center from the networking icon on the taskbar or from the
Control Panel | Network and Internet.
2.
Locate the Media Sharing link in the Sharing and Discovery section.
3.
Click the downward arrow button opposite Media Sharing to view the options.
4.
Clear the checkbox for Share My Media in Sharing Settings, as shown in Figure 10.26.
Figure 10.26 Turning Off Media Sharing
5.
Click OK. Click Continue in the User Account Control dialog box.
6.
Close the Network and Sharing Center window.
Keeping the Computer Closer to Wireless Access Point
Desktops and laptop computers that have wireless network adapters should be located closer to the
wireless access points for better speed and performance.The strength of the wireless signal can be
viewed from the Network and Sharing Center. Figure 10.27 shows the strength of the wireless signal
as Excellent.
Figure 10.27 Viewing the Wireless Signal Strength
388
Chapter 10 • Tuning for Better Performance
www.syngress.com

Even when you move your mouse over the networking icon in the Taskbar, the wireless signal
strength is shown.The farther the computer is from the wireless access point, the weaker the wireless
signal. Chapter 7 offers more details on wireless networking.
Monitoring Performance
Windows Vista comes with new and improved performance monitoring tools.The mostly redesigned
performance monitor is now named Reliability and Performance snap-in. In addition to monitoring
real-time performance of the system, you can now have detailed information about reliability of the
system components as well as collect performance data for later analysis.This includes software
installs/uninstalls, application and hardware failures and failure of other components. Other new fea-
tures include Resource Overview window, Data Collector Sets (system and user deﬁned), wizards for
collecting logs and user-friendly reports.
You can open the Reliability and Performance Monitor using any of the following methods:
■
Click Start and type perf in the s\Search box. Click the link for Reliability and
Performance Monitor in the search results box.
■
Right-click the Computer icon on the desktop and select Manage.This opens the
Computer Management console. Click the Reliability and Performance Monitor,
which is located in the System Tools folder.
■
Click Start | Control Panel | System and Maintenance | Administrative Tools |
Reliability and Performance Monitor.
■
Right-click the Taskbar and select Task Manager. Click the Performance tab and click
the Resource Monitor button.
You will need to click the Continue button in the User Account Control dialog box to conﬁrm
your administrative action.As shown in Figure 10.28, the Reliability and Performance Monitor con-
sists of the following main components:
■
Resource Overview This window provides a graphical view of the real-time usage of
core system components such as the CPU, disk, network, and memory.At the same time,
you can view the percentage of usage in ﬁgures in the bottom pane. When you click the
down arrow button for any component, the detailed usage is displayed. In the Learn More
section, you can click any of the links for using other features of the Reliability and
Performance Monitor.
■
Monitoring Tools The Monitoring Tools section consists of two components:
Performance Monitor and the Reliability Monitor. We will discuss these tools a little later
in this section.
■
Data Collector Sets Data collector sets are used to construct a basic information base
for displaying and collecting performance and reliability reports.You can use the data col-
lector sets to generate logs, reports, and performance alerts, and create rules for scheduling
data collection at speciﬁc time intervals. Data collector sets consist of performance coun-
ters, event trace data, and system conﬁguration information from Windows Registry.
www.syngress.com
Tuning for Better Performance • Chapter 10
389

■
Reports The Reports section of the Reliability and Performance Monitor collects user-
deﬁned and system reports.
Figure 10.28 The Resource Overview Window in the Reliability and Performance
Monitor
In the sections that follow, we will focus on some main components of the Reliability and
Performance Monitor.
Monitoring System Activities
The Resource Monitor is the default page shown in the Reliability and Performance Monitor snap-
in.This page shows the real-time activities and percentage of usage of core system components such
as the CPU, the hard disk, network, and memory.The center pane of this window contains detailed
information about each resource.This page is shown in Figure 10.28.
www.syngress.com
390
Chapter 10 • Tuning for Better Performance

NOTE
You can also start the Resource Monitor as an independent window (standalone snap-
in). Click Start | Run and type the command perfmon /res in the Run dialog box. Press
the Enter key and click the Continue button in the User Account Control dialog box.
While the graphical view for each component provides an overall real-time usage of main com-
ponents, you can get detailed information on usage by clicking the down arrow button on the right-
hand side. For example, if you click the down arrow button for CPU, the details provided includes
information on applications, process IDs, process threads, and average CPU usage over the past 60
seconds. Similarly, the details on disk usage include information such as applications currently
accessing the disk, the read and write speed, the I/O priority, and the disk response time. Details for
the network component include information on applications using the network, the address of the
remote computer with which the local computer is exchanging information, total bytes currently
being sent and received, and the total bandwidth presently in use. Figure 10.29 shows the details on
CPU and the disk on a typical Vista computer.
Figure 10.29 Viewing Performance Details with the Reliability and Performance
Monitor
www.syngress.com
Tuning for Better Performance • Chapter 10
391

Using the Performance Monitor
The Performance Monitor provides a detailed view of system performance both in real-time and in
the form of saved log ﬁles. When you open the Performance Monitor for the ﬁrst time, it shows a
blank screen.You will need to add counters in order to monitor performance of individual system
objects.A variety of objects and their instances can be added to the Performance Monitor display
depending on what aspect of system performance you wish to monitor. Some of the common
objects include the processor, memory, logical disk, network,TCP, IPv4, and so on.
The Performance Monitor is shown in Figure 10.30.
Figure 10.30 The Performance Monitor
NOTE
You can also start the Performance Monitor as an independent window (standalone
snap-in). Click Start | Run and type the command perfmon /sys in the Run dialog box.
Press the Enter key and click the Continue button in the User Account Control dialog
box.
www.syngress.com
392
Chapter 10 • Tuning for Better Performance

Adding Counters to the Performance Monitor
By default, the Performance Monitor window will not show any information unless you add coun-
ters for speciﬁc objects you wish to monitor.You can add counters to the Performance Monitor by
doing the following:
1.
Right-click the empty space in the Performance Monitor window and select Add
Counters.
2.
Alternatively, right-click the empty space inside the window and select Properties. Click
the Data tab and click the Add button.
3.
The list of available counters is shown in the Available Counters box. Select an object by
clicking the down arrow and choosing the counters from the list shown.To select all coun-
ters for an object, click the main object node.
4.
Click the Add button.The added counter is shown in the right-hand side box.
5.
If there is more than one instance of an object, select the instance you wish to add counters
for.
6.
Click OK to close the Add Counters dialog box.
Figure 10.31 shows the Add Counters page. If you wish to monitor performance on a remote
computer, select the computer from the drop-down list or click the Browse button.
Figure 10.31 Adding Counters to the Performance Monitor
www.syngress.com
Tuning for Better Performance • Chapter 10
393

Once you have added speciﬁc counters, you can save your settings as a report ﬁle or as a Web
page. Right-click the window and select Save Settings As. Enter the ﬁlename, select a folder and
click OK in the box that appears.To remove all the counters previously added to the display, right-
click the window and select Remove All Counters.
Working with Performance Logs
You can display previously collected performance data that has been saved as a log ﬁle in the
Performance Monitor window.The following procedure explains the process:
1.
Open the Performance Monitor.
2.
Right-click the performance monitor display window and click Properties.
3.
Click the Source tab.
4.
Click the radio button for Log Files and click Add.
5.
Select the log ﬁle and click Open. If you want to view multiple ﬁles, click the Add button
again and repeat the steps for each log ﬁle.
6.
Select the counters from the list of counters saved in the log ﬁle. Right-click the
Performance Monitor Display window and select Add Counters. Remember that
only those counters you have saved in the log ﬁle will be available.
7.
Click the Time Range button to see the time range for which the data was collected.The
time slider allows you to select and display only a portion of the collected performance
data.
Short Cut…
Displaying and Comparing 
Performance Data from Multiple Log Files
The new Performance Monitor in Windows Vista lets you open multiple performance
log ﬁles in a single window. This helps you compare a speciﬁc set of performance data
against a baseline. Another advantage is that even members of a local users group can
use this feature. Two conditions must be met for a meaningful comparison:
■
The Performance Monitor must be open as an independent window or a
standalone snap-in for this purpose. This means that if you open the
Reliability and Performance Monitor snap-in, this feature will not work.
You must open the Performance Monitor in standalone mode from the
command prompt or from the Run dialog box in the Start menu. 
www.syngress.com
394
Chapter 10 • Tuning for Better Performance
Continued

■
The data set used to compare two performance log ﬁles must be identical.
This simply means that the objects and counters used in the ﬁrst perfor-
mance log must be similar to the ones used in the second log ﬁle.
The following procedure explains the steps for comparing two or more perfor-
mance log ﬁles using the Performance Monitor:
1. Click Start | Run and type perfmon /sys. Press the Enter key to open the
standalone Performance Monitor window.
2. Create a view for the baseline performance data by opening a previously
saved performance log ﬁle. Add counters for this data set as required.
3. Open another instance of standalone Performance Monitor by repeating
step 1. Add the performance data you wish to compare to the baseline
performance logs and add counters as required.
4. In the window you want to compare, click Set Transparency from the
Compare menu and select 70% Transparency.
5. Click Snap to Compare from the Compare menu in the window you want
to compare with the baseline. This will align the two windows.
Using the Reliability Monitor
The Reliability Monitor is a part of the Windows Vista Reliability and Performance Monitor snap-
in. It provides information about system stability as a summary and also provides detailed information
about speciﬁc events that affect the system stability. In addition, it creates a Stability Index and dis-
plays it in the System Reliability Chart.This chart shows all the events that happen over the lifetime
of the system.The summary information is useful to get a quick view of the major failures that have
occurred in the system ever since the operating system was installed.
NOTE
You can use the Reliability Monitor on the local computer as well as on a remote
computer. For monitoring reliability information on a remote computer, the fol-
lowing conditions must be met:
* The Remote Registry Service must be running on the remote computer. 
* The remote computer must be running the RACAgent scheduled task.
* You must be a member of local users group on the remote computer.
You then open the Computer Management console on the local computer and
connect to the remote computer. To add the Reliability Monitor snap-in from the
remote computer, expand the Performance Diagnostics node and click Reliability
Monitor.
www.syngress.com
Tuning for Better Performance • Chapter 10
395

Figure 10.32 shows the Reliability Monitor window.
Figure 10.32 The Reliability Monitor in Windows Vista
In its default view, the Reliability Monitor displays the System Reliability Chart and the
Reliability Index.Above the Index, you can select a particular date or click the Select All option for
a complete history of events. When you select a particular date, the entire window displays the chart,
index, and the report for only that date. When you select the Select All option, all events are dis-
played right from the time the operating system was installed on the computer.
In the bottom part of the window, you can view the System Reliability Report.This again shows
the events from a selected date or all recorded events.The chart and the report consist of the fol-
lowing components:
■
Software (Un)Installs
■
Application Failures
■
Hardware Failures
■
Windows Failures
■
Miscellaneous Failures
www.syngress.com
396
Chapter 10 • Tuning for Better Performance

Click the + sign against any of the preceding components and you can view detailed informa-
tion about the failure.The Reliability Monitor is an excellent tool for diagnosing and troubleshooting
system problems.This part of the Reliability Monitor is covered in detail in Chapter 11.
NOTE
The Reliability Monitor depends on the RACAgent scheduled task, which collects
data on behalf of the Reliability Monitor. This task is conﬁgured, by default, on all
new Windows Vista installations. The ﬁrst time you can see data in the Reliability
Monitor is 24 hours after the installation is complete.
Creating Data Collector Sets
Data Collector Sets are mainly used as the basis for performance information that the Reliability and
Performance Monitor uses to display and create log ﬁles. It organizes different data collection points
into a single component that can be used to display or log performance information.These sets can
further be used to generate performance-related administrative alerts when the system performance
reaches speciﬁed thresholds.
Each Data Collector Set can consist of data collectors from any of the following types:
■
Performance Counters
■
Event Trace Data
■
System Conﬁguration Information from Windows Registry
You can create Data Collector Sets from templates or use the Data Collector Set creation wizard or
do so from existing Data Collector Sets.The following is a brief discussion of each of these processes.
Creating a Data Collector Set Using a Wizard
The Reliability and Performance Monitor allows you to manually create Data Collector Sets.The
following steps explain how you can create Data Collector Sets.
1.
Open the Reliability and Performance Monitor and expand the Data Collector Sets
node.
2.
Click the User Deﬁned node.
3.
Right-click an empty space in the window, click New and select Data Collector Set.
This launches the New Data Collector Set Wizard.
4.
Type a Name for the set and select the radio button for Create Manually (Advanced).
5.
On the next page, select either Create Data Logs or the Performance Alert radio
button.
www.syngress.com
Tuning for Better Performance • Chapter 10
397

6.
Click one or more checkboxes for Performance Counter, Event Trace Data, and
System Conﬁguration Information as shown in Figure 10.33. On the next page, select
the objects and counters.
Figure 10.33 Creating a Data Collector Set
7.
Click Finish or click the Next button to specify a user account to create the set.
Creating a Data Collector Set from a Template
The initial steps in the procedure for creating a new Data Collector Set using a template are similar
to using a wizard. On the Create New Data Collector Set page of the wizard, select Create
from a template (recommended) and click Next. On the next page, select from the following
three options:
■
Basic This template for creating a Data Collector Set can be used to create a very basic
set.You can add or remove performance counters as required, and change scheduling
options by editing the properties.
■
System Diagnostics This template helps create a Data Collector Set that can be used to
generate a detailed report about hardware resources, system response times, processes, and
system conﬁguration information.
■
System Performance This template helps create a Data Collector Set to identify possible
causes of performance issues on the local computer.
Click Finish or click the Next button to specify a user account to create the set.
www.syngress.com
398
Chapter 10 • Tuning for Better Performance

Creating a Data Collector 
Set from the Performance Monitor
To create a Data Collector Set using the Performance Monitor, right-click the Performance
Monitor node, click New and select Data Collector Set.Type a name for the new Data Collector
Set and click Next. Select a folder where the Data Collector Set will be saved. Click Finish or the
Next button to specify a user account to create the set.
Creating Performance Alerts Using Data Collector Sets
Data Collector Sets can be used to generate administrative alerts related to system performance.You
can create a Data Collector Set to monitor speciﬁc performance counters and generate alerts and
actions when some performance threshold is reached.The procedure for this task is explained in the
following steps.
1.
Open the Reliability and Performance snap-in and expand the Data Collector Sets
node.
2.
Right-click the User Deﬁned node, click New and select Data Collector Set.
3.
On the Create New Data Collector Set page, type a name for the set, select Create
manually (advanced), and click Next.
4.
Click the radio button for Performance Counter Alert. Click Next.
5.
On the Which Performance Counters Would You Like to Monitor page, click Add
to add a Performance Counter. Select objects and counters in the Available Counters
window. Click OK when done.
6.
Back on the Which Performance Counters Would You Like to Monitor page, choose
a counter. Select Above or Below in the Alert When box and type a threshold value in
the Limit box, as shown in Figure 10.34.
Figure 10.34 Creating a Performance Alert Using a Data Collector Set
www.syngress.com
Tuning for Better Performance • Chapter 10
399

7.
Click the radio button for Save and Finish.
8.
Right-click the Data Collector Set and select Properties.
9.
Click the Alert Action and Alert Task tabs to conﬁgure alert properties.
10.
Click OK to close the Properties window of the Data Collector Set.
11.
Right-click the new Data Collector Set and select Start This Collector Set Now.
The actions you can deﬁne for a Data Collector Set created for Performance alerts are as follows:
■
Log an entry in the application event log
■
Start another Data Collector Set
These actions can be used together.This means you can record an event in the application event
log and also start another Data Collector Set.
BEST PRACTICES ACCORDING TO MICROSOFT
The Data Collector Sets start using the System user account by default. You can
change this default behavior either during the creation of the set or at a later time.
Microsoft recommends that you should not change this user account unless you have
some compelling reason to do so. This account is used in order to maintain best secu-
rity for your system
www.syngress.com
400
Chapter 10 • Tuning for Better Performance

Summary
This chapter highlighted some of the core administrative tasks to ﬁne-tune the overall performance
of the system running Windows Vista. We started with checking the Windows Experience Index
Score of the system, which is assigned during the operating system installation. It depends on the
capability of various hardware components of the computer and the overall score is assigned
according to the component that has the lowest subscore. We discussed how Windows startup can be
speeded up by uninstalling unused programs and disabling nonessential services.
The hard disk, where the operating system, applications, and data ﬁles are stored, can become
fragmented due to continuous usage over a period of time.The Disk Defragmenter is automatically
run by Windows Vista at preconﬁgured schedules to control the fragmentation.Additionally, you can
use the Disk Cleanup utility to delete unwanted temporary ﬁles and free space for other useful pro-
grams and data. Similarly, virtual memory settings can enhance system performance when the phys-
ical RAM cannot handle the memory requirements of the system. Windows Vista comes
preconﬁgured to allocate most system resources for best application performance. Network perfor-
mance of the system can be ﬁne-tuned using a number of methods discussed in this chapter.
Regular monitoring of the system performance ensures that a Windows Vista computer provides
best performance during peak usage periods also.The Reliability and Performance Monitor in
Windows Vista has been completely redesigned. It now provides a Reliability Monitor in addition to
the Performance Monitor.The Reliability Monitor keeps track of software installs and uninstalls (as
well as failures) of applications, hardware, and the network. Data Collectors Sets can be created based
on custom counters.The collected data can be saved in performance logs, and alerts can be generated
when performance of a speciﬁc component falls below a speciﬁed threshold.
Solutions Fast Track
The Windows Experience Index

The Windows Experience Index Score shows the performance level of core hardware
components of the system: processor, memory, graphics, 3D gaming graphics, and the
primary hard disk.The overall score is based on the lowest subscore of individual
components.

A computer with a score between 1 and 2 will run most of the common applications but
will not be able to support Windows Aero.A computer with a score of 3 will be able to
run some features of Vista, including Windows Aero, but advanced graphics features will
not be available.A computer with a score of 5 and above will support all new and advanced
features of Windows Vista.

The Windows Experience Index Score is generated at the time of installation. If you
upgrade a component at a later date, you can manually calculate the new score. Remember
that if one of the components is still having a low subscore, the overall score will still be
low.
www.syngress.com
Tuning for Better Performance • Chapter 10
401

Optimizing Windows Startup

Windows startup speed can be enhanced by disabling some of Windows features that are
not essential for regular jobs.Additionally, several system services that are not required can
be disabled depending on how the computer is being used.This also helps in speeding up
the Windows shutdown process.

The Software Explorer utility in Windows Defender helps you identify the programs
conﬁgured to start when the system starts.

The visual effects also slow down the Windows startup process. Selecting only those effects
that are required on a speciﬁc computer can help speed up Windows startup and normal
operation.
Optimizing the Hard Disk

Hard disks become slow after continuous usage over a period of time.This is due to storage
of temporary ﬁles and fragmentation of the disk itself.Temporary ﬁles consume available
space in the hard disk and slow down the read/write process.

The Disk Cleanup utility in Windows Vista can be used to delete temporary ﬁles stored on
the hard disk and allows you to select the ﬁles you wish to delete.You must also empty the
Recycle Bin regularly to free up disk space.

Disk Defragmenter runs on Windows Vista computers on preconﬁgured schedules by
default. Defragmentation helps reorganize ﬁles on the disk in contiguous locations.This
helps in improving the disk read/write process.
Optimizing Memory

Windows systems use two types of memory for temporary storage: the physical RAM and
the virtual memory. Virtual memory is a combination of the available space in physical
RAM and the paging ﬁle called pageﬁle.sys.The system moves data in and out of the
paging ﬁle when it runs out of the RAM.

The size of the paging ﬁle can be adjusted to improve system performance. So far as
possible, you should try to increase the physical RAM in the system instead of increasing
the size of the paging ﬁle.

Data Execution Prevention is another utility in Windows Vista that helps protect memory
from malicious applications.
Optimizing Applications

Windows Vista gives priority to programs and applications over background services by
default.
www.syngress.com
402
Chapter 10 • Tuning for Better Performance


Unless you have a very speciﬁc reason to do so, you will hardly need to ﬁne-tune Windows
Vista for better application performance.

The Processor scheduling options in Windows Vista are in Programs and Background
Services.The Programs option is selected by default. If the Vista computer is being used as
a print server or a Web server, you can select the Background Services for better
performance.
Optimizing the Network Connection

Network performance of a Windows Vista computer can be enhanced using several
methods that include utilizing fast Ethernet cards, using only essential network protocols
and services, disconnecting unused mapped network drives, and disconnecting from
network programs not in use.

The Networking tab in the Task Manager provides a real-time graphical statistics of
network utilization.You can also use the Reliability and Performance Monitor to monitor
network performance.

The Users tab in Task Manager shows currently connected network users. If you are
experiencing networking performance bottlenecks, you can log off or disconnect select
users from your computer.
Monitoring Performance

The Performance Monitor in earlier versions of Windows has been redesigned and
renamed the Reliability and Performance Monitor.The Reliability Monitor keeps track of
software installs/uninstalls and all system, application, and hardware failures over the lifetime
of the system.

The Performance Monitor can be used to display real-time performance information as
well as collect performance data using Data Collector Sets and by saving the information in
log ﬁles.You can also generate performance alerts based on speciﬁc thresholds for
performance objects such as the processor, the hard disk, memory, networking interfaces
and protocols, and so on.

The Performance Monitor can be used to compare the performance information stored in
two or more log ﬁles.You must use the Performance Monitor as a standalone utility to use
this feature.
www.syngress.com
Tuning for Better Performance • Chapter 10
403

Q: I have all the latest components in my computer, an Intel Dual Core processor, 2GB RAM, the
fastest 3D graphics card, and the fastest hard drive. Nevertheless, my computer is showing a
Windows Experience Index score of only 5.5. What kind of computer should I buy that has a
score of 9 or 10?
A: As the time of this writing, no computer had a Windows Experience Index score of more than
6. Microsoft has designed this scoring scheme keeping in mind the technological advancements
of coming years. If your computer has a score of 5 or more, it will run all the new and advanced
features of Windows Vista and show excellent performance.
Q: I want to check what applications and services start when my Vista computer starts.Apart from
the Software Explorer in Windows Defender, is there any other way to see what applications or
services start when I start my computer? 
A: The Software Explorer in Windows Defender will show all the applications installed on the
computer.You can identify the applications that have the startup type as Automatic. In addition
to this, you can check the Services snap-in to ﬁnd out which system services are conﬁgured to
start automatically.You can also check the System Conﬁguration utility (msconﬁg.exe) for this
purpose. Figure 10.35 shows the Startup tab of this utility where you can check the name of the
startup application, its manufacturer, the command used to execute it, and its location in
Windows Registry. Clearing the checkbox against the application will prevent the application
from starting during Windows startup.
www.syngress.com
404
Chapter 10 • Tuning for Better Performance
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

Figure 10.35 Using the System Conﬁguration Utility to Check Startup
Applications
Remember that you will need administrative privileges to run this utility. If you are logged on as
an administrator, you must click the Continue button in the User Account Control dialog
box to conﬁrm your administrative action.
Q: Disk Defragmenter on my computer runs when I am transferring ﬁles to and from the ﬁle server
in my head ofﬁce. How can I change the time when Disk Defragmenter automatically runs? 
A: You can change the default schedule of Disk Defragmenter using the Modify Schedule button
in the Disk Defragmenter dialog box. Remember that Disk Defragmenter runs as a back-
ground application and the Windows Vista operating system gives it low priority when other
applications are running. If you are transferring ﬁles when Disk Defragmenter is running, the ﬁle
transfer process is given priority over the defragmentation process.
Q: I have just added 1GB RAM to my Vista computer to make the total amount of RAM 2GB.
What should be the size of the new paging ﬁle now?
A: Microsoft recommends that the minimum size of the paging ﬁle be the amount of RAM plus
300MB, and the maximum size can be three times that of the amount of RAM. So, in your case,
the minimum size of the paging ﬁle should be 2,300MB ([2GB + 300MB = 2,300MB] and the
maximum can be 9GB [3 x 3GB = 9GB]).
Q: I am trying to conﬁgure performance alerts based on thresholds for a recent application using
Event Trace Data but there is no option to include data from the application. Is there a speciﬁc
reason for this?
A: Yes. In order to use Event Trace Data to collect information for generating performance alerts
based on events related to a speciﬁc application, the application must support reporting events to
the Windows Vista Reliability and Performance Monitor.The Performance Monitor will not be
able to collect any events trace data if the application does not support this function.
www.syngress.com
Tuning for Better Performance • Chapter 10
405


407
Troubleshooting
Solutions in this chapter:
■
Working with Windows Remote Assistance
■
Working with Logs and Errors
■
Network Connectivity and TCP/IP
■
Data Access Issues
■
Windows Help and Support
■
Problem Reports and Solutions
Chapter 11
 Summary
 Solutions Fast Track
 Frequently Asked Questions

Introduction
When an application fails to install, or your networking connectivity isn’t working, it’s time to trou-
bleshoot. Part of the art of troubleshooting is ﬁrst understanding how something should work. In this
chapter, we will go over troubleshooting techniques and tools such as Event Viewer to ﬁx common
issues like network connectivity and ﬁle access permissions. We will explore the remote assistance
feature and how it can help you troubleshoot issues. Understanding troubleshooting techniques is
important since it is your daily task as a system administrator to ﬁx problems with user computers.
Working with Windows Remote Assistance
Both Windows XP and Windows Vista include two different utilities for remote access to another
computer.These are Remote Desktop and Remote Assistance. Remote Desktop is basically an
administrative tool commonly used to remotely maintain and manage computers. It allows access to
resources located on a remote computer. Remote Assistance, on the other hand, lets Windows users
get help remotely in order to resolve problems related to the operating system or applications. Both
of these services are dependent on Terminal Services in Windows, which is installed and enabled by
default on Windows XP, Windows Vista, and Windows Server 2003 computers. More importantly, it
takes two persons to use the Remote Assistance feature: a user, who needs help; and a helper or expert,
who is a trusted person providing it.
Enabling Remote Assistance
In order to use the Remote Assistance utility, it must be ﬁrst enabled and conﬁgured through the
Control Panel. It is not enabled by default.The following procedure explains the steps involved in
enabling and conﬁguring Remote Assistance.
1.
Click Start | Control Panel | System and Maintenance.
2.
In the System group, click the Allow Remote Access link.Alternatively, click the
System link to open the System Information window and click Remote Settings in
the left pane.
3.
Click Continue in the User Account Control dialog box to conﬁrm your administrative
action.
4.
The Remote tab of the System Properties window opens to display the remote settings
(as shown in Figure 11.1).
5.
Click the checkbox for Allow Remote Assistance Connections to this Computer in
the Remote Assistance section. Clear this checkbox if you wish to disable Remote
Assistance and it was previously enabled and conﬁgured.
www.syngress.com
408
Chapter 11 • Troubleshooting

Figure 11.1 Enabling Remote Assistance in the Control Panel
6.
Click the Advanced button to display the Remote Assistance Settings window (as shown
in Figure 11.2).
Figure 11.2 Conﬁguring Remote Assistance Settings
7.
Notice in Figure 11.2 that the option Allow this Computer to Be Controlled
Remotely is checked by default. Clear this checkbox if you do not want the helper/expert
to control your computer. Clearing this checkbox will allow the helper view-only access.
www.syngress.com
Troubleshooting • Chapter 11
409

8.
In the Invitations section, set the maximum amount of time the invitation will remain
open. By default, the invitation remains open or valid for six hours.After this time, the
invitation automatically expires and cannot be used to connect remotely to your computer.
9.
In the bottom part of this window, you can choose whether the invitation can be used
only from Windows Vista or a later computer, or from Windows Vista and other computers
such as Windows XP and Windows Server 2003.
10.
Click OK to save your settings. Click OK again to close the System Properties window.
Once Remote Assistance is enabled, you can use this feature in Windows Help and Support to
get help from an expert/helper or to provide help remotely.
NOTE
Remote Assistance works only with Windows Vista, Windows XP, and Windows
Server 2003 operating systems. Computers running older operating systems such as
Windows 2000, Windows NT, and Windows 9x do not support the Remote Assistance
feature.
Getting Help with Remote Assistance 
As explained earlier in this section, you can use the Remote Assistance feature in Windows Vista,
Windows XP, and Windows Server 2003 computers to get help from an expert user (helper) or to
provide help to a user in case you are an administrator or an expert user. Remote Assistance must be
enabled ﬁrst from the System Properties window in the Control Panel.
To start the process of getting help using Windows Remote Assistance, a user must create an
invitation and send it to the helper. Once the helper receives the invitation, the user and the helper
can both sit on their respective Remote Assistance–enabled computers to exchange information,
transfer ﬁles, or even chat to resolve speciﬁc problems. Invitations can be generated using the fol-
lowing two methods:
■
By sending an e-mail message.
■
By creating an invitation ﬁle, securing it with a password, and sending it to the helper.
The following procedure explains the steps involved in creating and sending an invitation using
both of these methods.
■
Click Start | Help and Support to open the Windows Help and Support window.
■
Click the Windows Remote Assistance link in the Ask Someone section.
The Windows Remote Assistance Wizard starts (as shown in Figure 11.3).You can choose the
invitation method on this page.
www.syngress.com
410
Chapter 11 • Troubleshooting

Figure 11.3 Creating a Windows Remote Assistance Invitation
If you click Use E-mail to Send an Invitation option, you must have an e-mail client conﬁg-
ured on your computer. Otherwise, clicking this link starts the e-mail conﬁguration wizard. If an e-
mail client is already conﬁgured on the computer, you can just type the message as an e-mail message
and click the Send button inside the e-mail client application (for example, Microsoft Outlook) to
send the message containing your invitation. Use this option if the e-mail server (say, Microsoft
Exchange) is located within your corporate network.
As shown on the right hand side in Figure 11.3, the Windows Remote Assistance Wizard dis-
plays any invitations previously created. If you have already created an invitation, you can use it again.
If you click the Save this Invitation as a File option, the wizard opens it, as shown in Figure
11.4. Choose this option if you use a Web-based e-mail such as Windows Live Mail.
Notice from Figure 11.4 that the invitation ﬁle is stored on your desktop by default.You can
click the Browse button and save the ﬁle at a desired location on your hard drive.
Enter a password of at least six characters in the Password box and retype it in the Conﬁrm
the Password box.
Click Finish to save the ﬁle and close the Windows Remote Assistance Wizard.
If the invitation is sent using the e-mail option, the helper receives the message with an attach-
ment. Opening the attachment starts Remote Assistance and the helper must click the attachment to
start the Remote Assistance session. If the invitation is sent to the helper as a ﬁle, you must disclose
the password to the helper for them to open the invitation ﬁle.
www.syngress.com
Troubleshooting • Chapter 11
411

Figure 11.4 Creating a Remote Assistance Invitation File
When the helper is ready to offer help, he will use the Windows Remote Assistance link in
Help and Support and click the Offer to Help Someone option in the Windows Remote
Assistance Wizard.As shown in Figure 11.5, the Windows Remote Assistance Wizard displays the
connection dialog box where the helper can type the name of the ﬁle, click the Browse button to
locate the ﬁle, or click the Use a Previous Connection link on the right side.
Figure 11.5 Offering Help Using Windows Remote Assistance
www.syngress.com
412
Chapter 11 • Troubleshooting

Once the helper selects the invitation ﬁle, the password dialog box is displayed, as shown in
Figure 11.6.As another option, the helper can also connect to the user’s computer by using the com-
puter name or the IP address in the box.This option is mainly used by technical support centers to
connect remotely to their clients.
Figure 11.6 Remote Assistance Invitation Password
TIP
When you have created an invitation ﬁle and speciﬁed a password for getting
remote assistance from a helper, the helper will need the password to initiate the
Remote Assistance session using the invitation ﬁle. You must convey the password to
the helper in some way or other. Microsoft recommends that the mode for con-
veying the password be something other than that used to send the invitation. For
example, if you used e-mail to send the invitation, do not use e-mail to convey the
password. Instead, you may call the helper over the telephone and tell them your
password.
When the helper opens the invitation, Windows attempts to connect to the remote computer.
The Windows Remote Assistance dialog box is displayed as shown in Figure 11.7.
Figure 11.7 Remote Assistance Session
Troubleshooting • Chapter 11
413
www.syngress.com

The following options are available to the user to control a Remote Assistance connection.
■
Cancel Clicking this button cancels the Remote Assistance offer by not accepting the
incoming connection request by the helper.
■
Start Sharing/Stop Sharing This button allows the user to start or stop sharing the
control of the computer with the helper.
■
Pause/Resume Using this button temporarily hides the user’s computer from the helper.
The user can click the Resume button again to display the screen on helper’s computer.
■
Settings This button displays properties of the Remote Assistance session.
■
Chat This button opens a chat window where the user and the helper can start chatting
online.
■
Send File This button is used to transfer a ﬁle from the user’s computer to the helper’s
computer.
Shortcut…
Remote Assistance Improvements in Windows Vista
From the discussion so far, it is evident that it takes two persons, the user and the
helper, to initiate the Remote Assistance session. This can be termed as a secure
arrangement in addition to setting the expiry time and using a password for the invi-
tation. The helper cannot initiate the Remote Assistance session if users are not pre-
sent on their desktops. The user must also accept the incoming connection to let the
helper establish a connection and offer help. Consider a situation where the user
sends an invitation that does not expire in the next two days. The helper cannot use
this invitation to connect to the user’s computer through Remote Assistance if the user
is not physically present on their computer. Even when the Remote Assistance session
is in progress, the user can easily and quickly terminate the session by pressing the ESC
key any time he is concerned about the activities of the helper.
In Windows XP, the invitation could also be sent using MSN Messenger, which has
been removed in Windows Vista. Another improvement is efﬁcient use of network
bandwidth. The vernal communication feature in Windows XP Remote Assistance has
now been removed in Windows Vista so that network bandwidth can be conserved. In
spite of some differences in Remote Assistance features of Windows XP and Windows
Vista, it is still possible to establish Remote Assistance connections between a
Windows XP computer and a Windows Vista computer. The Start Sharing/Stop Sharing
and Pause/Resume functions are also new to Remote Assistance in Windows Vista. All
other functions such as ﬁle transfers and chatting are available in Windows XP also.
Another improved feature in Windows Vista is Session Logging. Session logs are
saved on both the user’s and helper’s computer as XML ﬁles in the \Documents\Remote
www.syngress.com
414
Chapter 11 • Troubleshooting
Continued

Assistance Logs folder. These logs are very useful in diagnosing problems with a
Remote Assistance session. 
Working with Logs and Errors
It is a common understanding that only administrators use system utilities such as Event Viewer,
System Monitor, and Performance Logs to resolve computer problems.This is true, but with
Windows Vista, use of these utilities has become so easy that even a nontechnical user can use them
to identify and diagnose problems related to the operating system, hardware devices and drivers,
applications, Internet connectivity, and so forth.The Event Viewer console in Windows Vista provides
a central place to look for information about several different types of events related to the operating
system, applications, network connectivity, and so on. Windows tracks important system events and
stores them in event log ﬁles. In Windows Vista, events are mainly classiﬁed into two types:
■
Windows Logs Events related to applications, the operating system, security, setup, and so
on are stored in this category.
■
Applications and Services Logs Events related to hardware, system services, speciﬁc
applications, and so forth are stored in this category.
Opening the Event Viewer Console
Event Viewer can be opened as a snap-in to the Computer Management console or as a standalone
console.You will need to click the Continue button in the User Account Control dialog box to
conﬁrm your administrative action. If you are currently logged on with a non-administrative user
account, you will need to supply the Administrator password. Event Viewer can be opened using any
of the following methods:
■
Click Start and type event in the Search box. Click the Event Viewer link that appears in
the Search Results box.
■
Right-click the Computer icon on the desktop and select Manage to open the
Computer Management console.The Event Viewer is located in the System Tools folder.
■
Click Start | Control Panel |System and Maintenance | Administrative Tools |
Event Viewer.
■
Click Start | All Programs | Administrative Tools | Event Viewer.
Figure 11.8 shows the Event Viewer as a snap-in within the Computer Management console.
www.syngress.com
Troubleshooting • Chapter 11
415

Figure 11.8 The Event Viewer Console in Windows Vista
NOTE
You can use the Event Viewer to view and manage event logs or troubleshoot prob-
lems on the local computer as well as on a remote computer. To use the Event
Viewer on a remote computer, open the Event Viewer, right-click the Event Viewer
(Local) node and select Connect to Another Computer. Type the name or IP address
of the remote computer or click the Browse button to browse the network to locate
the computer you wish to work on. When connected, the focus of the Event Viewer
will be on the selected remote computer.
As explained earlier in this section, the event logs you may be most interested in are located
under the Windows Logs node and Applications and Services Logs node. Expand either of these
nodes and select the log category you are interested in. For example, Figure 11.9 shows the events
recorded in the System category.
www.syngress.com
416
Chapter 11 • Troubleshooting

Figure 11.9 Events Related to System Activities
The details pane in the center of the console shows the list of most recent system events tracked
and recorded. Each entry contains the following information:
■
Level Shows the type of event such as information, warning, error, audit success, audit
failure, and so on.
■
Date and Time The date and time when the event was tracked and recorded.
■
Source The source of the event. In other words, the application, service, or Windows
component that reported the event.
■
Event ID A unique identiﬁer for the recorded event. Event ID is very useful in getting
online help from Microsoft support services.
■
Task Category The category into which the task falls.
For the purpose of clarity, Windows shows only the preceding columns in the details pane.You
can add or remove columns in the details pane by right-clicking any column and selecting
Add/Remove Columns.
www.syngress.com
Troubleshooting • Chapter 11
417

Event Levels
Each event entry in the log is ﬂagged by a particular icon and its type and is shown in the Level
column. Different types of event entries are classiﬁed as follows:
■
Information Indicates that the event is for information only.A particular application, pro-
cess, or system event has completed successfully.
■
Warning This indicates a warning about a system component, application, process, or ser-
vice.A warning event can be an indication of a future problem.
■
Error Indicates that some event did not complete successfully. Error events are very
helpful in diagnosing and troubleshooting problems.
■
Audit Success Indicates the successful completion of a task audit.This event appears in
the Security log.
■
Audit Failure Indicates a failed attempt to audit a task.This event also appears in the
Security log.
When you click any of the events in the details pane, the information about the event is dis-
played in the bottom-most part of the details pane.You can also double-click the event you think
may lead to diagnosing the problem.This action opens a separate window showing detailed informa-
tion about the information.As shown in Figure 11.10, complete recorded information about the
event is shown when you double-click a particular event.
Figure 11.10 Viewing Details Information for an Event
www.syngress.com
418
Chapter 11 • Troubleshooting

NOTE
Instead of adding more columns in the details pane of the Event Viewer, it is always
good to double-click the event, which opens the Event Properties window. This
window includes all the columns you would otherwise add to the details pane.
Adding more columns in the details pane only makes the details pane more con-
gested.
Using Custom View Filters
The Event Viewer contains a listing of hundreds or thousands of events.All of these events may not
be of much interest to an administrator. It may also not be very convenient to scroll through the list
of events in order to locate a particular event. Log ﬁltering allows you to specify the criteria for dis-
playing recorded events. Once the ﬁlter is conﬁgured, Event Viewer will display only those events
that satisfy the speciﬁed ﬁlter conditions. For example, you may not be interested in browsing
through hundreds of event entries that have been recorded only for informational purposes.At a
given point in time, you might be looking for a speciﬁc event that tells you about unsuccessful
attempts to access one or more of your conﬁdential ﬁles or folders. In other words, you may be inter-
ested in looking at events that relate to a security breach. For this purpose, you can create a custom
ﬁlter to display only the events related to unsuccessful object access attempts.
Let’s consider other examples to emphasize the usefulness of custom ﬁlters.You may want to
check only the events that took place on a particular date or, in another situation, you might be
interested in looking at all possible events on a particular date that recorded an Error entry in the
event log ﬁles.You may also be looking for a system event that matched a particular EventID. For all
these purposes, you need not browse through hundreds of entries in the Event Viewer. Instead, you
create custom ﬁlters and narrow down your search.The following discussion details how you can
create custom ﬁlters in Event Viewer.
As a built-in feature, the Event Viewer console contains a Custom View ﬁlter for administrative
purposes.This view holds the critical errors and warnings events.The ﬁlter is located under the
Administrative Events folder in the Custom Views node. Figure 11.11 shows the events displayed
when the Administrative Events node is selected on a typical Windows Vista computer.
You can also create your own custom view ﬁlters to view only the events you are most interested
in. For example, you may want to create a custom view ﬁlter that shows critical errors and warnings
events related to hardware in the last 24 hours.The following procedure explains the steps involved in
creating such a custom view ﬁlter.
www.syngress.com
Troubleshooting • Chapter 11
419

Figure 11.11 The Custom View Filter for Administrative Events
1.
Open the Event Viewer console by using any of the methods previously described.
2.
Expand the Custom Views node.
3.
Right-click the Custom Views node and select Create Custom View.Alternatively, click
the Create Custom View link in the Action pane located on the right-hand side.The
Create Custom View window opens, as shown in Figure 11.12.
Figure 11.12 Creating a Custom View Filter
420
Chapter 11 • Troubleshooting
www.syngress.com

4.
In the Create Custom View window, select the time period in the Logged box. For this
exercise, choose Last 24 Hours.
5.
Select the type of events in the Event Level section. For this exercise, click the checkboxes
for Critical, Error, and Warning.
6.
Select the type of logs you want to ﬁlter.You can select the events from a speciﬁc category
or by speciﬁc events by source. For this exercise, select Hardware Events located in the
Applications and Services node.
7.
Click OK.The Save Filter to Custom View dialog box opens.
8.
Select a location and click OK.The new ﬁltered custom view appears in the Custom
Views node in the Event Viewer (see Figure 11.13).
Figure 11.13 Saving the Custom View Filter
Network Connectivity and TCP/IP
Computer networks are indispensable these days and you can hardly ﬁnd a computer that is not con-
nected to a network. Even if you have a home computer, the Internet connection makes it a part of
that larger worldwide network. Connecting to a private home network, or a public network such as
the Internet, not only increases productivity but also provides good return on your investment.
However, sometimes things do not always work the way we expect. Problems arise and you are
required to identify or diagnose the problem and ﬁnd a suitable resolution. Network problems are no
exception. Network connectivity problems as well as performance issues are some of the common
tasks faced by network administrators. Even on a small wireless home network, problems can occur
and you will need to ﬁx them as soon as possible. In this section, we will look at some common net-
work connectivity problems, and methods to identify and diagnose them and ﬁnd solutions.
www.syngress.com
Troubleshooting • Chapter 11
421

The Network and Sharing Center
Identifying and diagnosing network problems in Windows Vista has become easier than its predeces-
sors Windows XP and Windows 2000 Professional.The newly designed Network and Sharing
Center interface can create and display a full map of the network to which your Windows Vista
computer is connected. Even on a standalone Vista computer connected only to the Internet, you
can see a network map consisting of your computer, the network router, and the Internet (shown as a
globe).
The ﬁrst place to look at when you face a network connectivity problem is the Network and
Sharing Center.You can open the Network and Sharing Center using any of the following methods:
■
Right-click the network icon on the taskbar and select Network and Sharing Center.
Alternatively, click the network icon and then the Network and Sharing Center link.
■
Click Start and type network in the search box. Click the Network and Sharing
Center link in the Search Results box.
■
Click Start | Control Panel | Network and Internet | Network and Sharing
Center.
The Network and Sharing Center for a typical wireless home network is shown in Figure 11.14.
This opening window shows a partial network map at the top, the details of the network you are
currently connected to, and the network and sharing settings conﬁgured on the computer in the
bottom part of the window.
Figure 11.14 The Network and Sharing Center in Windows Vista
www.syngress.com
422
Chapter 11 • Troubleshooting

To view a full map of the network, click the View Full Map link located at the top right-hand
corner of the screen.A new window shows the complete network map.The Network and Sharing
Center also provides links in the left pane for the following tasks:
■
View computers and networks
■
Connect to a network
■
Manage wireless networks
■
Set up a connection or network
■
Manage network connections
■
Diagnose and repair
For more details on networking in Windows Vista refer to Chapters 6 and 7.
When you are troubleshooting a network connectivity problem, you will be interested in identi-
fying the cause of the problem before you can ﬁnd a suitable resolution.Take a look at the Network
and Sharing Center and use the Diagnose and Repair link in the left pane.
TIP
When you click the View Full Map link in the Network and Sharing center, do not be
surprised if you don’t see any Windows XP computers or other network devices. This
is because the utility relies on Link Layer Topology Discovery (LLTD) protocol, which is
not included in Windows XP and certain network devices. To view Windows XP com-
puters in this map, you must download and install LLTD protocol from Microsoft’s
web site.
In case you do not see some of the Windows Vista computers on the map, it may
be due to one or more of the following reasons:
The LLTD protocol might be disabled for the network adapter.
Network Discovery might be turned off on the computer.
Firewall settings on a Windows XP computer may be preventing the computer
from being discovered.
The computer is connected to a network that is assigned a Public Network loca-
tion. Change the network location to Private Network from the Network
and Sharing Center window.
If the computer is on a wireless network, the wireless signal strength may be
poor. Move the computer closer to the access point.
You can turn on Network Discovery from the Network and Sharing Center as
explained in this section. If LLTD protocol is disabled for a network adapter, you can
enable it by completing the following steps:
1.
Click the Manage Network Connections link in the left pane of the Network
and Sharing Center.
2.
Right-click the network adapter and select Properties. Click Continue in the
User Account Control dialog box.
www.syngress.com
Troubleshooting • Chapter 11
423

3.
Click the checkboxes for Link Layer Topology Discovery Mapper I/O Driver
and Link Layer Topology Discovery Responder.
4.
Click OK to save your settings and close the Properties window of the net-
work adapter.
You might also notice that a network device such as a router is shown on the
map as a router, a switch, or a wireless access point. To make sure the network
device is shown correctly on the Windows Vista network map, check if the device has
a Windows Vista logo. You may ﬁnd this information on the device documentation.
Network Discovery
You can also start network diagnostics by right-clicking the network icon on the Task Bar and
selecting Diagnose and Repair. But before the computer can detect any other computers on the
network or before it is visible to other computers, the Network Discovery must be turned on.The
Network and Sharing Center shows whether or not the Network Discovery is turned on in the
Sharing and Discovery section. Figure 11.15 shows the part of the Network and Sharing Center
where you can ﬁnd out the details about Network Discovery.
Figure 11.15 Turning On Network Discovery
If network discovery is turned off, click the Turn On Network Discovery radio button. When
you click the Apply button, you will also need to click Continue in the User Account Control
dialog box to conﬁrm your action.After you turn on Network Discovery, it takes a while before the
computer can see other computers on the network or is visible to other computers.
Diagnosing and Repairing the Connection
The Diagnose and Repair function in the Windows Vista Network and Sharing center is helpful in
troubleshooting connectivity problems on small networks such as the home network. If you are
facing a connectivity problem, you can use this feature to have Windows Vista diagnose the problem
and search for a suitable solution.
www.syngress.com
424
Chapter 11 • Troubleshooting

The following steps explain how you can launch the Windows network Diagnostics utility:
1.
Open the Network and Sharing Center using any of the methods explained earlier.
2.
Click the Diagnose and Repair link in the left pane located under the Tasks heading.
Clicking the Diagnostics and Repair link launches the Windows Network Diagnostics program
as shown in Figure 11.16.
Figure 11.16 Windows Network Diagnostics
After the diagnostics is complete, the program reports the results and a possible solution. For
example, a problem with the Domain Name Server (DNS) and its possible solution is shown in
Figure 11.17. If the program could repair the connection itself,
Figure 11.17 The Results of Windows Network Diagnostics
Figure 11.18 shows another instance of a network connectivity problem.This diagnostics result
applies to both wired and wireless networks.The results show that either the network cable is
unplugged or the wireless network is not available.
www.syngress.com
Troubleshooting • Chapter 11
425

Figure 11.18 Windows Network Diagnostics Results for a Disconnected Computer
In this case, you might want to check your network cable or the signal strength of the wireless
network. If you are on a wired network, check the activity lights on the network adapter or inspect
the cable for any visible damage. If you are on a wireless network, move the computer closer to the
access point. On a home network, the wireless router is your access point.
Command-Line Network Diagnostic Utilities
While the Windows Network Diagnostics utility in Network and Sharing Center might be very
helpful on a small network, you may have to rely on some well-known command-line utilities to
resolve connectivity problems on a corporate network.This section describes some of the common
command-line utilities, such as ipconﬁg, ping, and tracert. To run the command, you will need to open
the command prompt window.This can be done by performing the following steps:
1.
Click Start | All Programs | Accessories.
2.
Click the Command Prompt link.
3.
Click Continue in the User Account Control dialog box.
If you have enabled the Run option in the Start menu, you can also open the command prompt
window using the following steps:
1.
Click Start | Run.
2.
Type cmd in the Run dialog box and press the Enter key.
3.
Click Continue in the User Account Control dialog box.
ipconﬁg
The ipconﬁg command is useful in detecting problems with the computer’s TCP/IP conﬁguration.
This utility helps uncover conﬂicts in IP addresses as well as many other parameters of the TCP/IP
protocol, such as DHCP, DNS, and so forth conﬁgured on the computer. When used with the /all
parameter, it shows the complete TCP/IP conﬁguration of all network adapters installed on the com-
puter.The command can be used as follows:
www.syngress.com
426
Chapter 11 • Troubleshooting

ipconﬁg /all
The output of this command is as shown in the following listing.
C:\>ipconﬁg /all
Windows IP Conﬁguration
Host Name . . . . . . . . . . . . : User-PC
Primary Dns Sufﬁx
. . . . . . . :
Node Type . . . . . . . . . . . . : Hybrid
IP Routing Enabled. . . . . . . . : No
WINS Proxy Enabled. . . . . . . . : No
DNS Sufﬁx Search List. . . . . . : phub.net.cable.rogers.com
Ethernet adapter Local Area Connection:
Media State . . . . . . . . . . . : Media disconnected
Connection-speciﬁc DNS Sufﬁx
. :
Description . . . . . . . . . . . : Realtek RTL8169 PCI Gigabit NIC
Physical Address. . . . . . . . . : 00-16-17-BC-59-38
DHCP Enabled. . . . . . . . . . . : Yes
Autoconﬁguration Enabled . . . . : Yes
Wireless LAN adapter Wireless Network Connection 2:
Connection-speciﬁc DNS Sufﬁx
. : phub.net.cable.rogers.com
Description . . . . . . . . . . . : Belkin Wireless G Desktop Card #4
Physical Address. . . . . . . . . : 00-17-3F-2E-69-BC
DHCP Enabled. . . . . . . . . . . : Yes
Autoconﬁguration Enabled . . . . : Yes
Link-local IPv6 Address . . . . . : e80::25e6:d262:716c:2bb%15(Preferred)
IPv4 Address. . . . . . . . . . . : 192.168.1.100(Preferred)
Subnet Mask . . . . . . . . . . . : 255.255.255.0
Lease Obtained. . . . . . . . . . : Sunday, April 29, 2007 3:59:07 PM
Lease Expires . . . . . . . . . . : Sunday, April 29, 2007 6:10:16 PM
Default Gateway . . . . . . . . . : 192.168.1.1
DHCP Server . . . . . . . . . . . : 192.168.1.1
DHCPv6 IAID . . . . . . . . . . . : 335550271
DNS Servers . . . . . . . . . . . : 192.168.1.1
NetBIOS over Tcpip. . . . . . . . : Enabled
From this listing, you should look for all important conﬁguration information, which includes
the following:
www.syngress.com
Troubleshooting • Chapter 11
427

■
The IP address, the subnet mask, and the address of the default gateway
■
The IP address of the DHCP server and the DNS server
In most situations, your computer should be obtaining an IP address automatically from a DHCP
server.You must ensure that the DHCP Enabled setting is conﬁgured as Yes from the output of the
ipconﬁg /all command.
In case you have manually conﬁgured the IP addresses on the computer, make sure the address is
not being used in any of the DHCP scopes conﬁgured on the DHCP server. Check with your net-
work administrator to obtain the IP addresses to be conﬁgured manually on your computer.
The ipconﬁg command can also be used to renew the IP address lease with the DHCP server.To
renew the IP address lease, use the following command:
ipconﬁg /renew
When this command is used, the computer attempts to obtain a new IP address lease from the
DHCP server.This command resolves the problem of IP address conﬂicts if there is any.
ping
The ping command is perhaps the most commonly used command to test connectivity between two
TCP/IP devices on a network.This command not only works on local networks but also on the
Internet, provided ICMP protocol is not blocked by a ﬁrewall or a router.The command can be used
as follows:
ping 192.168.1.1:
C:\>ping 192.168.1.1
Pinging 192.168.1.1 with 32 bytes of data:
Reply from 192.168.1.1: bytes=32 time=3ms TTL=127
Reply from 192.168.1.1: bytes=32 time=3ms TTL=127
Reply from 192.168.1.1: bytes=32 time=3ms TTL=127
Reply from 192.168.1.1: bytes=32 time=3ms TTL=127
Ping statistics for 192.168.1.1:
Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate roundtrip times in milliseconds:
Minimum = 3ms, Maximum = 3ms, Average = 3ms
In this example, the ping command successfully received replies from the remote host. If there
was no connectivity, the Request Timed Out or Destination Host Unreachable messages appear in the
output of the command. Sometimes, it is helpful to ping your own network adapter to test whether it
is functioning or not.The following listing shows how you can ping the local network adapter:
C:\>ping 127.0.0.1
www.syngress.com
428
Chapter 11 • Troubleshooting

Pinging 127.0.0.1 with 32 bytes of data:
Reply from 127.0.0.1: bytes=32 time<1ms TTL=128
Reply from 127.0.0.1: bytes=32 time<1ms TTL=128
Reply from 127.0.0.1: bytes=32 time<1ms TTL=128
Reply from 127.0.0.1: bytes=32 time<1ms TTL=128
Ping statistics for 127.0.0.1:
Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate roundtrip times in milliseconds:
Minimum = 0ms, Maximum = 0ms, Average = 0ms
The time given in milliseconds (ms) in the output of the ping commands denotes the time it takes
for the ping command to receive a response from the remote host.You can also use a hostname with
the ping command. For example, you can test connectivity to a host on the Internet as shown in the
following example listing:
C:\>ping microsoft.com
Pinging microsoft.com [207.46.197.32] with 32 bytes of data:
Reply from 207.46.197.32: bytes=32 time=103ms TTL=115
Reply from 207.46.197.32: bytes=32 time=93ms TTL=115
Reply from 207.46.197.32: bytes=32 time=93ms TTL=115
Reply from 207.46.197.32: bytes=32 time=1405ms TTL=115
Ping statistics for 207.46.197.32:
Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),
Approximate roundtrip times in milliseconds:
Minimum = 93ms, Maximum = 1405ms, Average = 423ms
Using the ping command to test connectivity should be done in a sequential manner. Network
administrators commonly use the following method:
1.
Ping the local network adapter (127.0.0.1).
2.
Ping another computer on the local network segment.
3.
Ping the default gateway.
4.
Ping a computer on a different network segment.
5.
Ping using the remote computer and employing its host name.This will verify the DNS
service is working.
Failure of the ping command at any of the given steps should be diagnosed carefully to pinpoint
the location of the problem. In case you are successful in pinging a host using the IP address, but not
www.syngress.com
Troubleshooting • Chapter 11
429

using its hostname, there might be some problem with the DNS server.The DNS server is used to
resolve hostnames to IP addresses.
NOTE
The ping command depends on the Internet Control Message Protocol (ICMP). If
there is a ﬁrewall at the destination network blocking the ICMP protocol, the ping
command will fail to get a response from the remote host.
tracert
The tracert command is used to trace the route taken by a network packet from the local host to the
destination host on a TCP/IP network. Like the ping command, it can be used with both an IP
address and a host name.The following is the syntax of the tracert command:
tracert <destination host name or IP address>
The tracert command reports the route taken to the destination and a maximum of 30 hops.The
output of this command is very helpful in locating the problem spot on a network.The following
example listing indicates the problem point as the network packet travels from the local computer to
the Web site named syngress.com.
C:\Users\User>tracert syngress.com
Tracing route to syngress.com [155.212.56.73] over a maximum of 30 hops:
1
1 ms
1 ms
1 ms
192.168.1.1
2
*
*
*
Request timed out.
3
8 ms
13 ms
9 ms
gw10.wlfdle.rnc.net.cable.rogers.com [66.185.91.
65]
4
10 ms
15 ms
12 ms
24.153.7.37
5
9 ms
14 ms
9 ms
gw02.mtnk.phub.net.cable.rogers.com [66.185.81.9
4]
6
19 ms
9 ms
19 ms
66.185.80.41
7
44 ms
28 ms
26 ms
pos-1-0-0.igw01.vaash.phub.net.cable.rogers.com
[66.185.80.190]
8
587 ms
132 ms
223 ms
POS2-1.ar2.DCA3.gblx.net [208.51.239.201]
9
24 ms
27 ms
26 ms
sbc-1.ar2.DCA3.gblx.net [64.208.110.30]
10
45 ms
26 ms
25 ms
dcx-core-01.inet.qwest.net [205.171.251.57]
11
33 ms
33 ms
32 ms
ewr-core-02.inet.qwest.net [205.171.17.2]
12
34 ms
35 ms
35 ms
bos-core-01.inet.qwest.net [205.171.8.113]
13
40 ms
36 ms
37 ms
bos-edge-02.inet.qwest.net [205.171.28.14]
www.syngress.com
430
Chapter 11 • Troubleshooting

14
41 ms
49 ms
41 ms
65.126.224.10
15
293 ms
50 ms
47 ms
ma1-gw6-ae0-conversent.net [216.41.101.99]
16
46 ms
44 ms
41 ms
ma-brockton-s1-0.conversent.net [209.113.217.126
]
17
74 ms
70 ms
88 ms
host65.155.212.56.conversent.net [155.212.56.65]
18
*
*
*
Request timed out.
19
*
*
*
Request timed out.
20
*
*
*
Request timed out.
21
*
*
*
Request timed out.
22
*
*
*
Request timed out.
23
*
*
*
Request timed out.
24
*
*
*
Request timed out.
25
*
*
*
Request timed out.
26
*
*
*
Request timed out.
27
*
*
*
Request timed out.
28
*
*
*
Request timed out.
29
*
*
*
Request timed out.
30
*
*
*
Request timed out.
Trace complete.
It is evident from the listing that the packet was dropped at hop number 18 and did not travel
any further. If you carefully note the time taken in milliseconds (ms) for the tracert command to get a
response from intermediary hosts, the network problem can be diagnosed. With each hop, the IP
address of the host is also given in the tracert output.This way you can identify the problem point
using the tracert command.
Troubleshooting Common Connectivity Problems
Although there is no straightforward formula to resolve any computer problem (or the network
problem in particular), you can still use the following general guidelines on resolving network con-
nectivity problems:
■
Adapter Conﬁguration Check the conﬁguration of the network adapter. If any of the
parameters are doubtful, make appropriate changes. If this does not work, try to move the
network adapter to a different slot on the motherboard.
■
Disconnected Network Cable Check the physical connection of the computer to the
rest of the network. Check the activity lights on the network adapter.
■
Damaged Network Cable Make sure the network cable is not damaged.A sharp bend
on the cable can cause one or more of its copper wires to break. Replace the cable with a
new one if it is damaged.
www.syngress.com
Troubleshooting • Chapter 11
431

■
Network Protocol Conﬁguration Check that the TCP/IP protocol is properly conﬁg-
ured for the network adapter. In most of the network implementations, the computer
should be conﬁgured to obtain an IP address automatically from a DHCP server.
■
Outdated Network Adapter Driver Check if you are using an outdated driver for the
installed network adapter. Obtain the updated network adapter driver from the vendor or
download it from the vendor’s Web site. Use the Device Manager to update the device
driver.Additionally, keep the network driver updated.
■
Unrecognized Network Adapter Use the Device Manager to see if Windows Vista
does not recognize the network adapter. Obtain the network driver from the vendor and
make sure it is compatible with Windows Vista.
■
Location of Access Point Check the strength of the wireless signal. If the signal strength
is too low, move the computer to another location where the signal strength is sufﬁcient.
■
Improperly Conﬁgured SSID When connected to a secure wireless network, make sure
the SSID settings are correctly conﬁgured on the computer. Check with your network
administrator to obtain correct SSID conﬁguration parameters.
Data Access Issues
Files and folders are shared among network users and permissions are conﬁgured either for individual
users or groups so as to enable them to complete their everyday jobs. If, for some reason, the users
are not able to access their home folders or are not able to connect to a ﬁle server to access ﬁles or
folders, the administrator will have to jump in to resolve the problem. Problems with data access can
arise on the local computer when the computer is shared by several users, or on a network computer.
The problem can result from a number of issues. Some of these are as follows:
■
Loss of network connectivity
■
Disabled ﬁle sharing
■
Insufﬁcient, conﬂicting, or inherited permissions
■
File and folder encryption
■
The improperly conﬁgured caching of shared data
In the sections that follow, we will look at some of these issues and methods to resolve them.
In the case where all users in the network are complaining about data access issues on a partic-
ular server, the problem obviously lies with the ﬁle server or network connectivity. Make sure the ﬁle
server is available on the network. For more on network connectivity–related problems, please refer
back to the “Network Connectivity and TCP/IP” section earlier in this chapter.
Disabled File Sharing
In order to let other users on a network access ﬁles or folders on a Windows Vista computer, ﬁle
sharing must be enabled from the Network and Sharing Center. By default, ﬁle sharing is disabled on
Windows Vista computers. Enabling ﬁle sharing allows other network users to access ﬁles and
www.syngress.com
432
Chapter 11 • Troubleshooting

printers shared on your Vista computer.Additionally, if you have enabled ﬁle sharing, you must
ensure that in case Password Protected Sharing is turned on, every user who needs access to the data
on the local Vista computer has a user account.The following steps explain how you can check ﬁle
sharing settings, and also enable ﬁle sharing if it is disabled:
1.
Click Start | Control Panel. Click the Setup File Sharing link under the Network and
Internet group.Alternatively, right-click the network icon on the taskbar and select
Network and Sharing Center.
2.
In the Network and Sharing Center, ensure that File Sharing is turned on in the Sharing
and Discovery section (as shown in Figure 11.19).Additionally, make sure Password
Protected Sharing is also turned on.
Figure 11.19 File Sharing and Password Protected Sharing in the Network and
Sharing Center
3.
If File Sharing is turned off, click the downward arrow icon on the right side of File
Sharing to view the details.
4.
Click the Turn On File Sharing radio button.
5.
Click the Apply button. Click Continue in the User Account Control dialog box.
6.
Similarly, expand Password Protected Sharing and click the Turn On Password
Protected Sharing.
7.
Close the Network and Sharing Center.
www.syngress.com
Troubleshooting • Chapter 11
433

Permissions
Once you have turned on ﬁle sharing, you must ensure that users who need access to shared ﬁles and
folders are granted proper access permissions. Even if you have conﬁgured ﬁle and folder permissions,
there may be several reasons users are not able to access ﬁles on your computer.These problems may
result from any of the following:
■
Insufﬁcient permissions Access to shared ﬁles and folders is conﬁgured through permis-
sions. User access can be assigned either using shared permissions or by ﬁle system permis-
sions (NTFS permissions). In either case, the user must have sufﬁcient permissions to access
the shared ﬁle or folder to successfully connect and work on the shared ﬁle. For example, if
a user has been given read-only access to a ﬁle, they will not be able to make any changes
to the ﬁle. Furthermore, the permissions for a particular user are combined when he/she is
a member of multiple groups.
■
Inherited permissions Permissions on ﬁles and folders are inherited from the parent
folders by default. In case you have assigned ﬁle system permissions (also called NTFS per-
missions) on the parent folder, the same would be applicable to all subfolders and ﬁles
within the parent folder. In case you have disabled inheritance and conﬁgured a different
set of permissions on either individual ﬁles or subfolders, you must ensure that users are still
allowed the level of access they need to work on shared data resources. In a domain envi-
ronment, certain group policies or inherited permissions from a parent organizational unit,
site, or domain may also cause data access problems.
■
Conﬂicting NTFS and share permissions When you have conﬁgured both share per-
missions and NTFS permissions, the most restrictive set of permissions apply. For example,
even if you have granted a user Full Control NTFS permission, he will not be able to
make any changes to the ﬁle if the share permission is conﬁgured as Read-Only and the
user is accessing the ﬁle from a network. Remember that share permissions apply only
when a user is accessing the resource from the network.
■
Denied Permission Believe it or not, it sometimes happens. We, as administrators, make
mistakes and sometimes accidentally click the Deny checkbox when conﬁguring NTFS or
share permissions. Remember that a Deny permission overrides the Allow permission. Use
the Deny permission very carefully (and rarely) and for selected users only.
Effective Permissions
Windows Vista provides a method to calculate effective permissions for a user for a particular ﬁle or
folder.You can check the effective permissions using the ﬁle system (NTFS) permissions conﬁgured
on a ﬁle or folder. Effective permissions are a combination of all permissions conﬁgured for a user or
group from all sources.This makes it easy for administrators to identify and resolve data access issues.
The following procedure explains how you can check effective permissions:
1.
Open Windows Explorer and locate the folder for which you wish to check effective
permissions.
2.
Right-click the folder and select Properties.
www.syngress.com
434
Chapter 11 • Troubleshooting

3.
In the Properties window, click the Security tab.
4.
Click Advanced to open Advanced Security Settings for the Folder dialog box.
5.
Click the Effective Permissions tab.
6.
In the Effective Permissions tab, click Select in the Group or User Name box.
7.
Type the account name of the user or the group in the Select User or Group dialog
box.
8.
The effective set of permissions for the selected user or group is displayed in the Effective
Permissions box, as shown in Figure 11.20.
Figure 11.20 Checking Effective Permissions for a User or Group
9.
Note the effective permissions for the selected user or group.
10.
Close all dialog boxes.
The effective permissions can be very helpful in resolving problems with data access and, in par-
ticular, the level of access that has been granted to a user or a group.
NOTE
The effective permissions feature in Windows Vista does take into account any share
permissions conﬁgured on the folder. You must be aware that a data access problem
might be caused by a combination of NTFS and share permissions. 
www.syngress.com
Troubleshooting • Chapter 11
435

For more information on share permissions and ﬁle system permissions, refer back to Chapter 4
and Chapter 9.
Encryption
Windows Vista supports Encrypting File System (EFS) for security of your critical and conﬁdential
data. If a user has encrypted a ﬁle or folder, other users might not be able to view its contents.This is
when some users might complain of their inability to access encrypted data. By default, a use that
encrypts a ﬁle or folder should not have any access problem. Other users must have an appropriate
certiﬁcate, which should be added to the ﬁle, to access the encrypted ﬁle. However, in certain situa-
tions, even the user that encrypts a ﬁle will face access problems.This section focuses on data access
issues related to encrypted ﬁles or folders.
Some of the common issues with accessing encrypted ﬁles by the owner (a user who created the
ﬁle) include the following.
An Access Denied Message 
Appears When Opening an Encrypted File
An Access Denied message is displayed when a user is unable to open an encrypted ﬁle.The main
reason for this is that either the ﬁle was transferred from another computer or the user himself did
not encrypt the ﬁle. In case the ﬁle was transferred from another computer, the encryption key must
also be imported from that computer to the local computer. In case another user is trying to open
the encrypted ﬁle, his certiﬁcate should be added to the ﬁle.
Inability to Open Files after 
Transferring from Another Computer
This problem is encountered when an encrypted ﬁle is transferred from a computer running an ear-
lier version of Windows, such as Windows XP or Windows 2000, using the Windows Easy Transfer
Wizard. When the ﬁle is accessed for the ﬁrst time on the Windows Vista computer after migration,
Windows Vista prompts you for the password on the old computer so it can update your account
with new account information.You must provide the old password to update the EFS certiﬁcate and
the key that is transferred during the migration. If you do not provide the password and instead
cancel the password prompt, you will not be able to access the encrypted ﬁle.This problem occurs
even if you were the owner of the ﬁle on the old computer.
You can resolve this problem by recovering the encrypted ﬁle.This is possible only when you
import the EFS certiﬁcate and the key from the old computer.You can use the command prompt for
quickly resolving the problem, as explained in following steps:
1.
Click Start | All Programs | Accessories | Command Prompt.
2.
Click Continue in the User Account Control dialog box.
3.
In the command prompt window, type dpapimig.exe and press Enter.
4.
Type the password you used on the old computer.
5.
Click Conﬁrm My Account Information And Update Content Protection.
www.syngress.com
436
Chapter 11 • Troubleshooting

6.
Exit the command prompt window.
This will resolve the problem and you should be able to access the encrypted ﬁles you trans-
ferred from an old Windows XP or Windows 2000 computer.
For more information on resolving problems with encrypted ﬁles, use the Windows Help and
Support utility in the Start menu and search for solutions using the keywords ﬁle encryption.
The Caching of Ofﬂine Files
Ofﬂine ﬁles enable network users to cache copies of ﬁles stored on a network ﬁle server on local
computers.The advantage is that users can keep working on remote ﬁles even when the connection
to the remote server is lost due to some reason. Ofﬂine ﬁles are not only supported on server oper-
ating systems but also on desktop operating systems such as Windows Vista.
In order to successfully utilize the ofﬂine ﬁles feature, it should be conﬁgured from the sharing
properties of a folder. Inability of a user to use the ofﬂine ﬁles may be caused either due to improper
conﬁguration or no conﬁguration at all.You can check the ofﬂine ﬁles conﬁguration as explained in
the following steps:
1.
Open Windows Explorer and locate the shared folder.
2.
Right-click the shared folder and select Properties from the context menu.
3.
In the folder properties, click the Sharing tab.
4.
In the Sharing tab, click the Advanced Sharing button.
5.
Click Continue in the User Account Control dialog box.
6.
In the Advanced Sharing dialog box, click the Caching button.This opens the Ofﬂine
Files dialog box, as shown in Figure 11.21.
Figure 11.21 Checking the Conﬁguration of Ofﬂine Files
www.syngress.com
Troubleshooting • Chapter 11
437

7.
The default setting is Only the ﬁles and programs that users specify will be avail-
able ofﬂine.You can change this setting to All ﬁles and programs that users open
from the share will be automatically available ofﬂine. If you do not want ﬁles and
programs to be made available ofﬂine, click Files or programs from the share will not
be available ofﬂine.
8.
Click OK to save your settings and close the Ofﬂine Settings dialog box.
Windows Help and Support
Most common problems with Windows Vista are fairly easy to resolve.The only thing you need to
know is where to start. Windows Help and Support can be your starting point in the troubleshooting
issues on a standalone computer as well as a computer on the network.Additionally, Microsoft pro-
vides lots of useful information on troubleshooting problems with Windows Vista on its Web site:
www.windowshelp.microsoft.com.As with previous versions, the Help and Support link is located
in the Start menu of the Vista computer. Clicking this link opens Windows Help and Support. Click
the Troubleshooting link on this page to open the starting page for troubleshooting, as shown in
Figure 11.22.
Figure 11.22 Troubleshooting with the Help of Windows Help and Support
438
Chapter 11 • Troubleshooting
www.syngress.com

You can quickly browse through the contents of this page, which is classiﬁed into the following
sections:
■
Networking Get help on wireless and wired network problems, as well as Internet con-
nectivity issues.
■
Using the Web Get help on browsing the Internet.
■
E-mail Get help on using e-mail and ﬁxing problems related to sending or viewing
attachments.
■
Hardware and Drivers Get help on ﬁnding solutions to hardware devices and drivers.
■
Your Computer Get help on general maintenance issues such as updating the computer
and performance problems.
If you are facing a speciﬁc problem that is not listed on the page, you can always search for trou-
bleshooting topics related to a speciﬁc problem using the Search box located at the top of the page.
For example, if you are facing a problem with monitors, type monitor in the Search box and press
the Enter key.A list of related topics will appear in the Help and Support window, as shown in
Figure 11.23.Take a look at the related topics and click the link that is closely related to the problem
you are facing.
Figure 11.23 Searching for Related Help Topics in Help and Support
www.syngress.com
Troubleshooting • Chapter 11
439

If none of the listed topics relate to your current problem, click the Ask Someone or Expand
your Search link located at the bottom of the Windows Help and Support page. When you click
this link, additional help options appear, as shown in Figure 11.24.
Figure 11.24 Additional Help and Support Options
The additional help and support options are as follows:
■
Use Remote Assistance to get help from a friend.You can also use this link when you
are providing help to someone else. (Remote Assistance was covered earlier in this chapter.)
■
Post a question in Windows communities or search for an answer to your problem online.
■
Get technical support from Microsoft.This link connects you to the
www.support.microsoft.com/windowsvista Web site.
■
Search the Microsoft Knowledge Base (KB) articles for related topics.
■
Visit Microsoft’s dedicated Web site for IT professionals: www.technet.microsoft.com.
■
Click the Windows Help Online link that takes you to the
www.windowshelp.microsoft.com Web site.
For most of these options, you must be connected to the Internet either directly or through the
local network.
www.syngress.com
440
Chapter 11 • Troubleshooting

Problem Reports and Solutions
The Problem Reports and Solutions utility in Windows Vista is another utility that can help you
detect problems with applications, systems, and components.This utility not only tracks failures of
applications and hardware devices but also suggests possible solutions to speciﬁc problems.This utility
provides the following options:
■
Check for new solutions
■
See problems to check
■
View problem history
■
Clear problem history
To open the Problem Reports and Solutions utility, click Start and type problem in the Search
box. Click the link for Problem Reports and Solutions that appears in the search results box. In
the Problem Reports and Solutions, click the link for See Problems to Check. Figure 11.25 shows
the page of this utility when the See Problems to Check link is selected on the opening page of the
utility.
Figure 11.25 The Problem Reports and Solutions Utility
It is evident from Figure 11.25 that Windows has detected several problems on the computer.
You can click the View Details link against any issue to view detailed information on the problem.
For example, Figure 11.26 shows the details of a problem detected with the video hardware installed
on the computer.
www.syngress.com
Troubleshooting • Chapter 11
441

Figure 11.26 Viewing Detailed Information for a Speciﬁc Problem
The Check for Solutions button at the bottom of the window causes the system to check for
reported problems online.The computer must be connected to the Internet when you click this
button.
www.syngress.com
442
Chapter 11 • Troubleshooting

Summary
In this chapter, we discussed some of the utilities included in Windows Vista for identifying, diag-
nosing, and resolving problems with the operating system.These utilities included Windows Help and
Support, Windows Remote Assistance, Network Diagnostics, Effective Permissions, Event Viewer, and
Problem Reports and Solutions. While Windows Help and Support remains one of the core help
centers to resolve issues related to installation and troubleshooting the operating system, devices, and
drivers, a new utility called Problem Reports and Solutions has also been added in Windows Vista for
identifying potential problems with system devices.
The Event Viewer console has been fully redesigned in Windows Vista.This utility is very
helpful in keeping track of system activities and not only helps diagnose potential problems with the
system but is also a helpful tool to monitor system security. With the new Event Viewer, you can
create custom ﬁlters to view only the events you are interested in. Custom ﬁlters save you from
wasting time browsing through hundreds of entries in the Event Viewer.
The Network and Sharing Center includes the network Diagnostics tool that helps identify and
resolve network connectivity problems.This tool is indeed very helpful for nontechnical users who
do not know much about troubleshooting network connectivity issues. System and network adminis-
trators can, no doubt, take advantage of well-known command-line utilities such as ping, ipconﬁg,
tracert, and so on to resolve network problems.
Most of the data access issues can be resolved by checking permissions granted to a user or a
group. In Windows operating systems, the share permissions and ﬁle system (NTFS) permissions are
combined and the more restrictive of the two are applied when a user accesses a ﬁle or folder from
the network. Permissions can also be inherited from parent folders.The Effective Permissions tab in
the advanced security properties of a folder is an easy-to-use tool for calculating the ﬁnal NTFS per-
missions that apply to a user on the selected folder.
Solutions Fast Track
Working with Windows Remote Assistance

Windows Remote Assistance can be used to get help from a remote user called the helper.
The Remote Assistance link is located within Windows Help and Support.

Remote Assistance must be enabled before the utility can be used.An invitation must be
generated in the form of a ﬁle or an e-mail message.The helper must accept the invitation
and initiate the connection.

When the connection is established, the helper and the user can exchange ﬁles, chat, or the
helper can even take control of the user’s computer in order to resolve a problem.
www.syngress.com
Troubleshooting • Chapter 11
443

Working with Logs and Errors

The redesigned Event Viewer console is helpful in tracking events related to system and
application activities and monitoring security-related events.

Event logs are classiﬁed into two categories: Windows Logs and Application and Service
Logs. Events are classiﬁed by their types: error, warning, information, audit success, and
audit failure.

You can create custom event views to ﬁlter only the events you are interested in.The
Administrative Custom View includes critical error and warning events for the system.
Network Connectivity and TCP/IP

Network connectivity problems may arise from several reasons: disabled network discovery
and/or loss of physical connectivity.The Network and Sharing Center in Windows Vista is
used to enable or disable Network Discovery, which further helps in sharing resources and
locating shared resources on the network.

Network Diagnostics is a tool to help diagnose a network connectivity problem. It works
on both wired and wireless networks.

Administrators can use command-line tools such as ping, ipconﬁg, and tracert to resolve net-
work connectivity problems.
Data Access Issues

Most data access problems arise from loss of connectivity or from insufﬁcient permissions.

Conﬂicting permissions, inherited permissions, and conﬂicting share and ﬁle system per-
missions can also create data access problems.

The Effective Permissions tab in advanced security settings provides a useful tool to calcu-
late the effective permissions for a user or group on a speciﬁc resource.This tool does not
take into account the share permissions that may be restricting access.
Windows Help and Support

The Windows Help and Support link is located in the Start menu and is the starting point
for looking for documentation and help in installing or troubleshooting problems with the
operating system and hardware devices and drivers.

Windows Help and Support is a fully searchable set of documents, where you can enter
keywords to look for a list of articles related to the problem.

Windows Help and Support also includes links to connect to Microsoft Web sites to help
you troubleshoot problems.
www.syngress.com
444
Chapter 11 • Troubleshooting

Problem Reports and Solutions

Problem Reports and Solutions is a new feature in Windows Vista that helps identify
potential problems in the operating system, applications, devices, and drivers.

You can open the utility from within the System and Maintenance group in the Control
Panel.

Problem Reports and Solutions is a fully conﬁgurable utility where administrators can set
limits on the level of reporting for the users of the computer.
Q: I am trying to send a Remote Assistance invitation using MSN Messenger but I cannot ﬁnd a
link to do so. Why?
A: Remote Assistance in Windows Vista does not support sending invitations using instant mes-
saging.This used to be an option for sending RA invitations in Windows XP. In Windows Vista,
you can send RA invitations only through an invitation ﬁle or by sending an e-mail message.
Q: What happens if I have given remote control of my computer and the helper is trying to per-
form unwanted operations on my computer? Is there a way I can stop him or end the session
quickly.
A: Yes.You can always click the Disconnect button in the Windows Remote Assistance menu to
forcibly disconnect the helper if you suspect his/her activities.
Q: The newly designed Event Viewer utility in Windows Vista is very complicated. What is the eas-
iest way to view only the events I am interested in?
A: The new Event Viewer looks complicated at ﬁrst but it has many new features that will actually
make your administrative tasks easier than before. If you are interested in viewing only some spe-
ciﬁc events, use the Custom View ﬁlters.You can create a new Custom View from the Custom
Views node in the scope panel and specify the events you are interested in.The Custom View
ﬁlter can be saved inside the Event Viewer MMC snap-in.
www.syngress.com
Troubleshooting • Chapter 11
445
Frequently Asked Questions
The following Frequently Asked Questions, answered by the authors of this book, are
designed to both measure your understanding of the concepts presented in 
this chapter and to assist you with real-life implementation of these concepts. To have
your questions about this chapter answered by the author, browse to www.
syngress.com/solutions and click on the “Ask the Author” form. 

Q: The company where I work has a medium-sized network with a ﬁle server that is accessed by
nearly 150 users. Users have been grouped according to their departments and also according to
their job functions.The share and NTFS permissions are a mess. It is very difﬁcult to ﬁnd out
what permissions are assigned to a particular use because there are multiple sources of access per-
missions. How can I ﬁnd effective permissions from all groups, individual permissions, and share
permissions for a user?
A: You can use the Effective Permissions tab in the Advanced Security properties of a shared folder.
In this tab, you can select a user or group and ﬁnd out their effective permissions. Remember
that these effective permissions do not take into account the shared folder permissions for the
user or the group.You will still need to consider share permissions in addition to effective NTFS
permissions to ﬁnd the correct set of applicable permissions.
Q: I can successfully ping all computers in my own network segment on the second ﬂoor of the
building but I’m not able to get any response from any computers located on the third ﬂoor of
the building. What could be the problem?
A: The network segment on the third ﬂoor of the building is possibly in a different network seg-
ment connected by a network router. Check the IP address of the default gateway using the
ipconﬁg /all command. Note the IP address and ping it to see if you get a response. If no response
is received from the default gateway, there is some problem with the IP address or the default
gateway itself.
www.syngress.com
446
Chapter 11 • Troubleshooting

447
Index
802.11, 214
802.11a, 223, 244
802.11b, 223
802.11g, 223, 224
802.11n (draft), 223, 224
A
access, 432–438
See also user access, securing; User Account
Control
Access Control List (ACL), 338
Access Control services, 322–323
Access Denied Message, 436
access point
computer proximity to, 388–389
connectivity, troubleshooting, 432
SSID broadcast from, 244
access token, 329, 338
ACL (Access Control List), 338
Actions pane
advanced task creation, 169–170
basic task creation, 168–169
of Task Scheduler, 166–167
activation, of Microsoft Windows Vista, 27–28
Active Directory
listing/removing printers in, 158
UFD and, 239
for WDS installation, 24
active partition, 104
ActiveX, 296
ActiveX Opt-In, 300–301
ad hoc network
security improvement, 220
setting up, 240–242
Admin Approval Mode
administrator protection with, 329–331
in UAC configuration, 333, 334
administrative tasks
backup and recovery, 138–148
power plans, 174–179
printer management, 148–160
Remote Desktop, 160–165
scheduling tasks, 165–171
services management, 179–182
time/date management, 171–174
administrator account
marking application, 331–332
tasks performed with, 338–339
UAC, disabling, 336
UAC and, 327
UAC protection of, 329–331
UAC virtualization, 332
Administrator account, built-in, 354
Advanced Security snap-in
Windows Firewall, managing with, 258–260
Windows Firewall, monitoring with, 268–269
Advanced Sharing Interface, 123
advanced task, 169–171
advfirewall context, 261–262
Aero interface, 2, 362
AES encryption, 245
alerts, performance, 399–400, 405
allocation unit
of FAT32, 112
size adjustment for performance, 119
on Windows Vista, 111
answer file, 23, 40
antimalware, 320
any folder sharing, 123–126
AOL, 308
Application agents, 291
Application Compatibility Toolkit (ACT), 12
applications
compatibility for Vista migration, 12
disabling UAC when installing, 314
marking to run in elevated fashion, 312–313
marking with UAC, 331–332
memory, protection from malicious
applications, 377–378
optimization of, 378–379, 402–403
running in elevated fashion, 311
Applications and Services Logs, 415, 416–417
audio settings
customizing, 72
playback/recording devices, 73–76
Vista vs. XP, 80
volume control, 72–73
audit failure event, 418
audit success event, 418
Aurora screensaver, 89–90
authentication
logon architecture improvements, 322–326
method, IPSec, 272–274
See also user access, securing
AuthIP, 274
automation

448
Index
automatic program load at startup, 359–360
local printer installation, 149
of memory allocation, 374–375
of Windows Vista installation, 21–27, 38
B
background, desktop, 82–85
background services, 377–378
backup and recovery
Backup and Restore Center, 138–140
Backup computer, Restore computer, 143–144
Control Panel utilities, 147–148
Disk Cleanup and, 366–367
process of, 140–142
scheduling backup jobs, 142–143
System Restore feature, 144–147
Backup and Restore Center
backing up/restoring files, 140–142
Backup computer, Restore computer, 143–144
features of, 138–140
scheduling backup jobs, 142–143
selection of individual files, 185
System Restore, 144–147
Backup Status and Configuration utility
opening, 141–142
scheduling backup jobs, 142–143
Balanced power plan, 174–175
balloons, 92–93, 94
base score, 357–359
basic disks, 98–102, 135
basic task, 167–169
basic volumes, 103
BCD (Boot Configuration Data), 31
BCDEdit command, 31
BitLocker
with EFS, 132, 136
function of, 128
TPM modes, 128–129
Bluetooth, 223, 224
boot, 30–31
Boot Configuration Data (BCD), 31
boot partition, 104
bottleneck, 382
broadcast, 217, 218
browser, 297–299, 317
. See also Internet Explorer 7 security
Bubbles screensaver, 90
C
caching, 437–438
CDFS (Compact Disc File System), 115
certificates, 436
Check Disk utility, 370–372
cipher command, 131–132
clean install
in-place upgrade vs., 7–8
steps of, 8–10
client components, of WDS, 23
client configuration, for Remote Desktop,
162–164
clock
date/time management, 171–174
dual time zone clock, 85, 86
cluster, 111, 119
Code Signing for Device Drivers, 59–61, 80
color codes, of UAC, 329
command-line
for groups, 348–350
for ScanState.exe, LoadState.exe, 21
for System Preparation Tool, 25–26
for troubleshooting network connection,
426–431
UAC and, 330–331
user account creation via, 343–345
wireless network configuration, 215
Compact Disc File System (CDFS), 115
Complete PC Backup
backup/restore computer, 144
issues of, 185
System Restore vs., 145
compression, 120, 372
computer, backup and recovery, 143–144
Computer Management, 99
connected users, 382–383
connections
Remote Desktop client configuration, 162–164
Remote Desktop, firewall settings for, 164–165,
186
Remote Desktop host configuration, 161
to unprotected wireless network, 219–220
wireless router, connecting to, 229–239
. See also network connection, optimization of;
network connection, troubleshooting
Control Panel
launching utilities, services, 147–148
Remote Assistance, enabling through, 408–409
UAC, disabling in, 334–335
Windows Firewall from, 252
convert command, 113–114
cookies, 296, 304–306
counters, 392, 393–394
CPU, 391
Credential Provider API, 322
credentials, 341, 343
cryptographic integrity algorithms, 270–271
Cryptography services, 322–323

Index
449
Custom filters node, 158–159
custom power plan, 178–179
Custom View filters, 419–421, 445
customization. See desktop properties, customizing
D
data access issues, 432–438
Data Collector Set creation wizard, 397–398
Data Collector Sets, 389, 397–400
Data Execution Prevention (DEP), 377–378
data integrity algorithms, 270–271
data storage, 98–102
. See also file system
date, 171–174
Date and Time Control Panel utility, 171–174
Daylight Saving Time (DST), 172–173
defragmentation. See disk defragmentation
Deny permission, 434
DEP (Data Execution Prevention), 377–378
desktop background, 82–85
desktop properties, customizing
desktop background, 82–85
desktop themes, 94
dual time zone clock, 85
overview of, 95
screensaver, 88–90
taskbar, toolbar, 90–94
Vista Sidebar gadgets, 85–88
desktop themes, 94
device drivers
compatibility with Windows Vista, 7
connectivity, troubleshooting, 432
Print Management snap-in for, 158–159
updating, 385
Device Manager snap-in
overview of, 42–44
on remote computers, 42, 79
using, 44–45
devices. See device drivers; hardware
devices/drivers
DHCP server, 428
DHCP service, 24
DHCPv6, 190
Diagnose and Repair function, 423, 424–426
Diagnose button, 234
diagnostics
command-line diagnostics, 426–431
Diagnose and Repair function, 424–426
with Network and Sharing Center, 200
digital signatures, 58–61
Disable button, 234
disabling
startup program, 359–360
UAC, 334–337
discovery. See Network Discovery
discovery, negotiation, 274
disk. See hard disk
Disk Cleanup feature, 364–368
disk compression, 30, 372
disk defragmentation
with Disk Defragmenter, 368–370
for file system performance, 118
for pagefile, 136
Disk Defragmenter
disk defragmentation with, 368–370
scheduling, 405
disk encryption, 372
diskpart.exe, 100–102, 135
display appearance, 82–90
distribution point, 23
domain location type, 203
Domain Name Service (DNS), 24
domain network, 221
Domain profile, 251
downloads. See Web site resources
Driver Package, 52–54
drivers. See device drivers; hardware
devices/drivers
DST (Daylight Saving Time), 172–173
dual time zone clock, 85, 86
dual-boot, 30–31, 32
dual-layer architecture, 190–191
DVD, 115–117
. See also Windows Vista DVD
dynamic disks
dual-booting and, 30
management of, 98–102
dynamic volumes, 104
E
EAP (Extensible Authentication Protocol), 220
EAPHost, 222
EAP-TLS, 222
effective permissions, 434–436, 446
EFI (Extensible Firmware Interface), 105
EFS. See Encrypting File System
elevation, 334
e-mail
Phishing and, 308
Remote Assistance invitation via, 410, 411
RMS and, 127
security, 296
EnableLUA Registry key, 337
Encrypting File System (EFS)
BitLocker and, 136
encryption example, 129–132

450
Index
function of, 129
troubleshooting encryption, 436–437
encryption
AES, 245
BitLocker for, 128–129
disk encryption, 372
dual-booting and, 30
Encrypting File System, 129–132
troubleshooting, 436–437
enterprises, Windows Firewall for, 258
error event, 418
errors, 370–372
event levels, 418–419
event logs, 415–421
Event Trace Data, 405
Event Viewer console
custom view filters, 419–421
event levels, 418–419
function of, 415
opening, 415–417
viewing events with, 445
exceptions, firewall, 254–258
exploits, browser
overview of, 297–298
Web spoofing, 298–299
extended partition, 104
Extensible Authentication Protocol (EAP), 220
Extensible Firmware Interface (EFI), 105
external devices, 46
F
features, turning off, 361–362
File Allocation Table 32 (FAT32)
conversion to NTFS, 113–114
description of, 111–112
File Allocation Table (FAT), 111
file sharing
any folder sharing, 123–126
disabled, 432–433
file system, 120–126
overview of, 202
public folder sharing, 386–387
File Sharing Wizard, 123–126
file system
basic/dynamic disks, 98–102
Compact Disc File System, 115
definition of, 103, 111
dual-booting and, 30
FAT, 111
FAT32, 111–112
file systems supported by Windows Vista, 111
FSUTIL, 117–118
NTFS, 112–114
partitions, volumes, 103–110
performance, increasing, 118–120
security, local/network, 126–132
sharing file systems, 120–126
terms, 103
Universal Disk Format, 115–117
filenames, short, 119
files
data access issues, troubleshooting, 432–438
deleting from Recycle Bin, 367–368
disk cleanup, 364–368
disk defragmentation, 368–370
migrating previous files, 18–21
security and, 296
filters
Event Viewer, custom view filters, 419–421
Microsoft Phishing Filter, 308–310
printer management with, 158–159, 186
firewall
filtering, IPSec with, 269
firewall profiles, 250–251
monitoring, 268–269
Remote Desktop connection and, 164–165, 186
rules, creating, 263–267
. See also Windows Firewall
FireWire, 54–55
Fix My Settings, 301–302
flash drives, 55
floppy disks, 296
folders
any folder sharing, 123–126
data access issues, troubleshooting, 432–438
performance and, 119
public folder sharing, 120–123, 202–203,
386–387
format, 103
formatting, DVD, 115–117
fragmentation. See disk defragmentation
FSUTIL
commands, 117–118
function of, 117
short filename service and, 119
G
gadgets, Vista Sidebar, 85–88
GIANT Computer Software, Inc., 291
Globally Unique Identifier Partition Table (GPT),
105
GPEDIT.MSC, 80
Graphical Identification and Authentication
(GINA), 322, 354
Group Policy
Code Signing for Device Drivers, 59–61

Index
451
Domain IPSec policy, integration with, 275
UAC configuration with, 332–334
Windows Firewall management, 261
for wireless management, 239
Group Policy Object Editor, 93–94
groups
adding users to local groups, 345–350
effective permissions, 434–435
guest account
creation of, 350–352
tasks performed with, 339–340
GUI, 189
H
hard disk
basic/dynamic, management of, 98–102
Compact Disc File System, 115
disk management terms, 103
dual-booting and, 30
FAT, 111
FAT32, 111–112
fie systems supported by Windows Vista, 111
file system security, local/network, 126–132
FSUTIL, 117–118
NTFS, 112–114
optimization of, 364–372, 402
partitions, volumes, 103–110
performance, increasing, 118–120
sharing file systems, 120–126
Universal Disk Format, 115–117
virtual memory, optimization of, 373–375
Windows Vista installation and, 7
hard disk, optimization of
Check Disk, for errors, 370–372
disk cleanup, 364–368
disk defragmentation, 368–370
hardware
assessment, 65
compatibility for Vista migration, 12
compatibility with Vista, 6
requirements for Windows Vista, 5–6
Hardware Compatibility List (HCL), 6
hardware devices/drivers
audio settings, customizing, 72–76
automated help, using, 65–67
device drivers, overview of, 55–58, 77–78
devices, customizing, 68, 78
devices, disabling, 50–51
devices, enabling, 51, 79
devices, maintaining, 48–49
devices, removing, 54–55, 79
devices, uninstalling, 51–54
driver signature verification, 58–61
drivers, rolling back, 64–65
drivers, updating, 61–64
installed devices, viewing, 42–45, 77
installing/maintaining, 46–47, 77
keyboard settings, customizing, 68–69
mouse settings, customizing, 70–72
non-PnP device, installing, 48–49
overview of, 42
PnP device, installing, 47–48
HCL (Hardware Compatibility List), 6
help
with Remote Assistance, 410–414
Windows Help and Support, 438–440
help, automated
for hardware assessment, 65
PnP devices/drivers, 67
upgrade advisor, 66
Windows Help and Support, 66–67
helper, 410–414, 445
hidden updates, 287
High Performance power plan, 174–175
hops, 430–431
host configuration, for Remote Desktop, 160–162
host-based instruction detection/prevention
(IDS/IPS), 296
I
IKE protocol, 271, 274
images, for desktop background, 82–85
ImageX
for system image, 25, 26, 27
Windows Vista installation, automating, 22
information event, 418
infrastructure mode
wireless router, connecting to, 229–239
wireless router, setting up, 224–229
inherited permissions, 434
in-place upgrade
definition of, 7
installation, steps of, 15–17
migrating files, settings, 18–21
planning for, 11–15
upgrading from one Vista edition to another,
17–18
installation
automation of, 21–27
upgrade installation, 11–21
of Windows Deployment Services, 24
of Windows Vista, 38
of Windows Vista on virtual PC, 35–36
installation, of Microsoft Windows Vista, 5–10
clean installation, 8–10
clean install/upgrade, decision between, 7–8

452
Index
device drivers, 7
disk drives, partitions, 7
hardware compatibility, 6
hardware requirements, 5–6
system BIOS compatibility, 6
internal devices, 46
Internet agents, 291
Internet browser security, 297–299, 317
Internet Explorer 7 security
ActiveX Opt-In, 300–301
advanced settings, 307–308
features, 290
Fix My Settings, 301–302
Internet zones, setting, 303–304
Microsoft Phishing Filter, 308–310
Phishing filter, 299
privacy, configuring, 304–306
protected mode, 300
secure configuration, 297–299
security overview, 297–299
Security Status Bar, 302
Windows Defender, 302
Internet time server, 173–174
Internet zones, 303–304
invitations, 410–415, 445
IP address
network connection diagnostics, 426–431
ping command and, 446
wireless router settings, 225–226
ipconfig command, 426–428
IPSec
AuthIP, description of, 274
cryptographic/data integrity algorithms,
270–271
domain policy/Group Policy integration, 275
firewall filtering and, 269
main mode algorithm order, 271
managing, 316
negotiation discovery, 274
new features of, 269–270
NIST common criteria, 275
quick mode algorithm order, 271–274
Vista support for, 189
IPv4
configuring in Vista, 191–194
limitations of, 188
IPv6
addressing, 189
configuring in Vista, 194–198
DHCPv6, 190
dual-layer architecture and, 190–191
enabling/disabling, 197–198
name resolution, 189–190
overview of, 188, 210
Vista and, 188
Vista support for, 189
IPv6 over PPP, 189
IRQ numbers, 79
J
JavaScript, 296
K
Key Exchange algorithms, 272
keyboard settings, 68–69
keys, 129–130
L
laptop computers, 100, 239
legacy hardware, 46, 48–49
Link Layer Topology Discovery (LLTD)
Network Map and, 205–206, 212
to view network map, 423
Link-Local Multicast Name Resolution
(LLMNR), 189
links. See Web site resources
Linksys WRVS4400N Broadband Router,
224–229
LLTD. See Link Layer Topology Discovery
LoadState.exe, 20, 21
local groups, 345–350
local printer, 149–152
Local Security Policy, 313–314
logon
Single Sign-on, 214–215
for user account, 341, 343
Windows Vista improvements, 322–326
logs
performance logs in Performance Monitor,
394–395
Pfirewall.log, 275
session logs with Remote Assistance, 414–415
troubleshooting with Event Viewer console,
415–421
Lusrmgr console
groups, adding users to, 345–348
guest account creation, 350–352
user account creation, 341–343
user accounts view, 345
when to use, 354

Index
453
M
macro security, 296
main mode algorithm order, 268–269, 271
malicious applications, 377–378
malware protection
managing, 290–291, 317
removing infections, 319–320
Windows Defender Software Explorer, 294–297
Windows Defender, using, 291–294
management components, of WDS, 24
map, network, 422–424
mapped network drives, 386
Master Boot Record (MBR)
limitations with, 104
new disk configuration with, 105–110
partition style, 105
Master File Table (MFT), 112
McAfee, 319
media sharing
overview of, 203
turning off, 387–388
memory, optimization of, 372–378, 402
MFT (Master File Table), 112
Microsoft Office, 296
Microsoft Phishing Filter, 308–310
Microsoft SpyNet, 296
Microsoft Update
enabling/disabling, 283
installing, 282–283
overview of, 282
update history, viewing, 286–287
updates, checking for, 283–284
updates, installing, 284–286
updates, managing, 283
updates, restoring hidden, 287
updates, uninstalling, 287–290
Microsoft Virtual PC, 31–36
Microsoft Windows, 11–12
Microsoft Windows Vista. See Windows Vista
migration, to Windows Vista, 11–21
migrating files, settings, 18–21
overview of, 38
upgrade, planning for, 11–15
upgrade installation, steps of, 15–17
upgrading from one Vista edition to another,
17–18
monitoring, performance, 389–400
Monitoring Tools section, 389
mouse settings, 70–72
msconfig.ex, 335–336
MSN Messenger, 445
multiboot system
dual-booting Windows Vista, 30–31
virtual machine vs., 32
with Windows Vista, 39
MyDoom-O, 297
Mystify screensaver, 90
N
name resolution, 189–190
NAP. See Network Access Protection
negotiation discovery, 274
net command, 348–349, 354
net user command, 340, 344–345
NetBIOS, 212
netlocal command, 348–349
netsh command, 215–216, 261–262
Netsky-D, 297
network, 203–204
. See also wireless
Network Access Protection (NAP)
advanced security settings, 208–209
client configuration, 207–208
description of, 290
EAPHost and, 222
integration with, 216
overview of, 206–207, 211
network adapters
connectivity, troubleshooting, 431, 432
fast, 385
pinging local adapter, 428–429
Network and Sharing Center
for ad hoc network, 240–242
Diagnose and Repair function, 425
file sharing settings in, 432–433
file/printer sharing, 202
media sharing, 203, 387–388
Network Explorer, 200–201
network location types, 203–204
network protocols/services, uninstalling,
384–385
overview of, 198–200, 211
public folder sharing, 121–123, 202–203
sharing printer, 153–154
for troubleshooting network connection,
422–424
UFD creation, 234–239
network bandwidth, 414
network cable, 431
network connected programs, 380–381
network connection, optimization of
factors of performance, 379
network performance improvements, 384–389
overview of, 403
Reliability and Performance Monitor, 383–384
Software Explorer, 380–381

454
Index
Task Manager to view network performance,
381–383
network connection, troubleshooting
command-line diagnostics, 426–431
Diagnose and Repair function, 424–426
guidelines, 431–432
Network and Sharing Center, 422–424
Network Discovery, 424
problems, 421
network device driver, 385
network devices, 46
Network Discovery
enabling, 423–424
folder sharing and, 126
overview of, 200–201
for troubleshooting network connection, 424
Network Explorer, 200–201
Network Location Awareness (NLA), 251
Network Location service (NLASVC), 251
network location types, 220–221
Network Map, 204–206, 211
network map, 422–424
network printer, 152–153
network protocols, 384–385
networking, managing local
IPv6 and Dual Layer, 188–191
NAP, 206–209
Network and Sharing Center, 198–204
Network Map, 204–206
overview of, 188
TCP/IP, configuring, 191–198
Vista and IPv6, 188
new simple volume wizard, 106–109
New Technology File System (NTFS)
conversion of FAT32 to, 113–114
features of, 112–113
file system performance, 118–120
permissions, troubleshooting, 434–436
NIST, 275
NLA (Network Location Awareness), 251
NLASVC (Network Location service), 251
non Plug-and-Play devices, 46, 48–49
NTFS Volume, 24
O
offline attack, 128, 129
offline files, caching, 437–438
operating system
dual-booting Windows Vista, 30–31
on virtual machine, 32
Vista upgrade and, 11–12
Optical Storage Technology Association, 115
optimization. See performance, tuning for
opt-in online service, 310
P
pagefile.sys
automatic allocation of memory, 374–375
defrag, 136
encryption of, 132
memory optimization, 372–375
relocation of, 120
size of, 405
paging, 118, 372
paraphrase, 230–231, 237
partition, definition of, 103
partition style
configuration of new disk, 105–110
definition of, 105
GPT, 105
Master Boot Record, 105
partitions
on basic, dynamic disks, 98
basic/dynamic volumes, 103–104
partition styles, 105–110
types in Windows Vista, 104–105
Windows Vista installation and, 7
password
for EFS certificate, 436
for guest account, 350–352
password protection on wakeup, 177–178
policy, 296
Remote Assistance invitation, 411, 413
on UAC, 311
UAC configuration and, 334
for user account, 341, 343
in Windows Vista installation, 10
Password Protection Sharing, 433
patch management
overview of, 275–277, 317
Windows Update settings, 277–282
PEAP, 222
PEAP-MS-CHAP v2, 222
performance
alerts, 399–400, 405
of file system, 118–120, 134
system services and, 181
performance, monitoring
Data Collector Sets, 397–400
overview of, 403
Performance Monitor, 392–395
Reliability and Performance Monitor, 389–390
Reliability Monitor, 395–397
system activities, 390–391
performance, tuning for
applications, 378–379
hard disk, 364–372
memory optimization, 372–378
monitoring performance, 389–400

Index
455
network connection, 379–389
startup, 359–364
Windows Experience Index, 356–359
Performance and Information Tools utility
startup optimization, 359–360
visual effects, 362–363
for Windows Experience Index, 356–357
performance logs, 394–395
Performance Monitor
adding counters to, 393–394
Data Collector Set creation from, 399
description of, 392
performance logs in, 394–395
Performance Options utility, 378–379
permissions
data access issues, troubleshooting, 434–436
definition of, 338
effective, 446
printer, setting, 155–156
sharing printer, 153–154
Pfirewall.log, 275
Phishing, 308–310
physical memory, 372
picture, for desktop background, 82–85, 96
ping command, 428–430, 446
Plug-and-Play (PnP) devices
compatible, installing, 47
external, Safely Remove hardware option for, 55
help, automated, 67
installation overview, 46–47
local printer installation, 149
noncompatible, installing, 47
system scan for new device detection, 47–48
port exceptions, 256, 258
power buttons, 177–178
Power Options Control Panel utility
custom power plan, 178–179
dialog box options, 174–175
standard power plans, changing, 175–177
power plans
changing standard power plan settings, 175–177
custom power plan, 178–179, 186
power buttons, 177–178
types of, 174
Power Saver plan, 174–175
primary partition, 104
print jobs, 159–160
Print Management snap-in
device driver management, 158–159
function of, 148, 156–157
launching, 157
listing/removing printers in Active Directory,
158
Print Filters of, 186
print job management, 159–160
printer management, 148–160
configuration of printer properties, 153
issues of, 186
local printer installation, 149–152
network printer installation, 152–153
Print Management snap-in, 148, 156–160
printer permissions, setting, 155–156
sharing printer, 153–154
printer permissions, 155–156
printer properties, 153
printer sharing, 153–154, 202
Printers Control Panel utility, 149–151, 153
privacy, configuring, 304–306
private location type, 203
private network, 221
Private profile, 251
privileges, 127–128
Problem Reports and Solutions utility, 441–442
Processor Scheduling options, 378–379
product activation, Windows Vista, 27–28
profiles, Firewall, 250–251
program exceptions, Windows Firewall, 256–257
programs
automatic load at startup, 359–360
closing unused, 385–386
Software Explorer to identify network
connected programs, 380–381
prompts
elevation, changing, 314–315
of UAC, 328–329
in UAC configuration, 333–334
protected mode, IE 7, 300
public folder sharing
overview of, 202–203
settings, 120–123
turning off, 386–387
public location type, 203
public network, 221
Public profile, Windows firewall, 251
Q
Quick Mode algorithm order, 271–274
R
RACAgent scheduled task, 397
Random Access Memory (RAM), 35, 372–378
random wireless network, 215
RDI (Remote Installation Services). See Windows
Deployment Services
recording devices, 75–76
recovery, 182
. See also backup and recovery

456
Index
Recovery tab, 182
Recycle Bin, 367–368
reference computer, 25–27
Registry, 89–90, 337
Reliability and Performance Monitor
components of, 389–390
Data Collector Sets, 397–400
function of, 389
Performance Monitor, 392–395
Reliability Monitor, 395–397
system activities monitoring, 390–391
to view network performance, 383–384
Reliability Monitor, 395–397
Remote Assistance
enabling, 408–410
function of, 408
getting help with, 410–414
invitation, 445
Windows Vista improvements, 414–415
remote computer
Event Viewer console on, 416
Reliability Monitor on, 395
Virtual PC, 31–36
Remote Desktop
client configuration, 162–164
firewall settings for connections, 164–165
function of, 408
host configuration, 160–162
OS support of, 185–186
Remote Desktop Connection window, 162–164
Remote Installation Services (RDI). See Windows
Deployment Services
report
Problem Reports and Solutions utility, 441–442
of Reliability and Performance Monitor, 390
from Reliability Monitor, 395–397
of Windows Vista Upgrade Advisor, 12–15
Resource Monitor, 373, 390–391
Resource Overview window, 389, 390
resources. See Web site resources
restore. See backup and recovery
Ribbons screensaver, 90
right, 338
roll back, 64–65
router
wireless router, connecting to, 229–239
wireless router, setting up, 224–229
rules, firewall, 263–267
Run As feature, 310
S
ScanState.exe, 20–21
schedule
Check Disk, 371–372
Disk Defragmenter, 369–370, 405
processor, 378–379
scheduling backup jobs, 142–143
tasks with Task Scheduler, 165–171
Scope pane, 166
screensaver, 88–90, 94
scripts, 262–263
search, in Windows Help and Support, 439–440
search box, 147–148
secure OS services, 322–323
Secure Sockets Layer (SSL), 297
security
Data Execution Prevention, 377–378
wireless, 216–222
security, file systems, 126–132
BitLocker, 128–129
Encrypting File System, 129–132
in general, 126–127
overview of, 135
User Account Control, 127–128
Windows Rights Management Service, 127
security, managing
firewall profiles, 250–251
firewall rules, creating, 263–267
firewalls, monitoring, 268–269
internet browser security, 297–310
IPSec integration, 269–275
malware protection, managing, 290–297
overview of, 248
patch management, 275–277
update history, viewing, 286
updates, installing, 284–286
updates, managing, 283–284
updates, restoring hidden, 287
updates, uninstalling, 287–290
user account controls, 310–316
WFP, 249–250
Windows Firewall for enterprises, 258–263
Windows Firewall setup, 251–258
Windows Firewall/IPSec, 248–249
Windows Update settings, 277–282
Windows Update, using, 282–283
WSH, 250
security access token, 338
security ID (SID), 338
security modes, Linksys WRVS4400N, 227–228
security protocols, wireless security, 221–222
Security Status Bar, IE 7, 302

Index
457
server components, of WDS, 23
service set identifier (SSID)
broadcast from access point, 244
hidden wireless network, 215
improperly configured, 432
passive/active countermeasures, 217, 218
for UFD, 237
wireless router, connecting to, 229–230
wireless router setting, 226
services
configuration of service properties, 180–182
disabling unneeded, 296
network services, uninstalling, 384–385
Services snap-in for, 179–180
Session 0, isolation of, 323–325
Services Console, 206
Services snap-in
checking startup programs, 404
configuration of service properties, 180–182
description of, 179–180
Session 0, 323–325, 354
Session Logs, 414–415
session utilization, 323–325
settings, migrating, 18–21
Setup Windows phase, 17
Setup.exe
for upgrades, 40
Windows Vista installation, 21, 22
share permissions, 434
sharing
file sharing, disabled, 432–433
file systems, 120–126, 134–135
media sharing, turning off, 387–388
offline files, caching of, 437–438
printer, 153–154, 202
public folder sharing, 386–387
Sharing and Discovery, 121–123
sharing permissions, 153–154
shortcuts, 147–148
shrinking, volume, 109–110
SID (security ID), 338
sidebars, 85–88, 96
signature verification, 58–61
signatures, digital, 58–61
Single Sign-on (SSO), 214–215, 220
social engineering, 310, 320
Software Explorer
to identify network connected programs,
380–381
startup program management with, 359–360,
404
using, 295–297
Windows Defender and, 294–295
sound. See audio settings
spanned volumes, 104
speaker settings, 74–75
spoofing, Web, 298–299
SSID. See service set identifier
SSL (Secure Sockets Layer), 297
SSO (Single Sign-on), 214–215, 220
Stability Index, 395
standard power plans, 174, 175–177
standard user account, 339
startup
changing startup service, 181
optimization of, 359–364, 402
programs, checking, 404–405
Stratio-Zip, 297
Symantec, 319
Sysprep.exe, 22
system activities
events related to, 416–417
monitoring, 390–391
System agents, 291
system BIOS, 6
System Configuration utility
checking startup programs, 404–405
UAC, disabling in, 335–336
system image, 24–27
system partition, 105
system performance, 181
System Preparation Tool, 24–27
System Reliability Chart, 395, 396–397
System Restore feature
description of, 144–145
options of, 146–147
system restore point, 145–146
system restore point, 145–147
system scans, 47–48
system services
configuration of service properties, 180–182
Services snap-in for, 179–180
System user account, 400
T
Task Manager
memory usage view, 373
for network performance view, 381–383
Task Scheduler service, 167
Task Scheduler utility
description of, 165–167
scheduled tasks, creating, 167–171
troubleshooting scheduled tasks, 167–171
taskbar, customization of, 90–91
tasks
scheduled tasks, creating, 167–171
scheduling with Task Scheduler, 165–167

458
Index
troubleshooting scheduled tasks, 171
. See also administrative tasks
TCP/IP
configuration of, 191
configuring in Vista, 210–211
connectivity, troubleshooting, 432
network connection diagnostics, 426–431
in network printer installation, 152
TCP/IPv4 configuration, 191–194
TCP/IPv6 configuration, 194–198
template, 398
themes, desktop, 94
time
Daylight Saving Time, 172–173
management of, 171–172
synchronization with Internet time server,
173–174
toolbar, customization of, 91–94
TPM (Trusted Platform Model), 128–129
tracert command, 430–431
transfer
encryption issues after, 436–437
with User State Migration Tool, 20–21
with Windows Easy Transfer, 18–20
troubleshooting
data access issues, 432–438
Event Viewer console, 415–421
network connectivity, 199–200
network connectivity,TCP/IP, 421–432
Problem Reports and Solutions utility, 441–442
scheduled tasks, 171
Windows Help and Support, 438–440
Windows Remote Assistance, 408–415
Trusted Platform Model (TPM), 128–129
tuning. See performance, tuning for
U
UAC. See User Account Control
UDF (Universal Disk Format), 115–117
UFD (USB flash drive)
creating with Windows Connect Now, 234–239
Windows ReadyBoost, 375–377
unattended installation, 22, 23
Unattend.xml, 22, 23, 40
Universal Disk Format (UDF), 115–117
Universal Serial Bus (USB), 54–55
unprotected networks, 219–220
updates
device driver, 61–64
history, viewing, 286
installing, 284–286
managing, 283–284
Microsoft Windows Vista, 28–30
restoring hidden, 287
uninstalling, 287–290
in upgrade installation setup, 17
. See also Windows Update
upgrade
clean installation vs., 7–8
migrating files, settings, 18–21
planning for, 11–15
upgrade installation, steps of, 15–17
upgrading from one Vista edition to another,
17–18
Windows Anytime Upgrade, 5
Upgrade Advisor, Windows Vista, 12–15, 66
USB (Universal Serial Bus), 54–55
USB flash drive (UFD)
creating with Windows Connect Now, 234–239
Windows ReadyBoost, 375–377
user
disconnecting unwanted, 386
effective permissions, 434–435
Remote Assistance, getting help with, 410–414
Task Manager to view connected, 382–383
user access, securing
guest account, 350–352
local groups, adding users to, 345–350
logon architecture, improving, 322–326
overview of, 352–353
User Account Control, 327–337
user account types, 338–340
user accounts, creation of, 340–345
user account
creation of, 340–345
Data Collector Sets and, 400
types of, 338–340
User Account Control, 327–337
in Windows Vista installation, 10
User Account Control (UAC)
administrator protection, 329–331
application marking, 312–313
backup/recovery and, 140–141
benefits of, 327–328
changing prompt for, 314–315
color codes, 329
configuration of, 332–337
configuring with Local Security Policy, 313–314
description of, 291
disabling for application installation, 314
function of, 127–128
for guest account, 350
managing, 310–311, 318
marking application, 331–332
user account access process, 338
user limits, 354
using, 311–312
virtualization, 332

Index
459
User Accounts screen, 340–343
user interface
groups, adding users to, 345–348
user account creation with, 340–343
User State Migration Tool (USMT), 18, 20–21
username
UAC configuration and, 334
for user account, 343
in Windows Vista installation, 10
USMT (User State Migration Tool), 18, 20–21
V
video, 89
View Full Map link, 423
virtual machine
description of, 31–32
installation of Windows Vista on, 35–36
installation with Virtual PC, 32–34
preparation for Windows Vista, 34–35
virtual memory, 372, 373–375
Virtual PC, Microsoft, 31–36
virtualization, 31–36, 332
virus. See malware protection
Vista Capable PC, 5–6
Vista Premium Ready PC, 5–6
Vista Sidebar gadgets, 85–88
visual effects, 362–364
volume, definition of, 103
volume control, 72–73
volumes
basic/dynamic volumes, 103–104
cluster size, 119
encryption with BitLocker, 128–129
file system placement on, 111
new disk configuration, 105–109
partition types in Windows Vista, 104–105
shrinking, 109–110
W
WAIK (Windows Automated Installation Kit), 22,
24
wakeup, password protection on, 177–178
WAN, 228–229
warning event, 418
WDS (Windows Deployment Services), 23–24
Weatherbug gadget, 87, 88
Web site resources
EFI, 105
FSUTIL commands, 117
Hardware Compatibility List, 6
for IPv6, 188, 191
for LLTD responder, 206
for malware information, 319
Microsoft Virtual PC 2007, 32
for Vista security, 290, 297
Vista Sidebar, 85
for WFP, 250
Windows Automated Installation Kit, 22
Windows Help Online, 440
Windows Vista deployment, 27
Windows Vista editions, 5
Windows Vista Hardware Assessment tool, 12–13
Windows Vista Upgrade Advisor download, 12
Web spoofing, 298–299
WEP (Wired Equivalent Privacy), 221
WFP (Windows Filtering Platform), 249–250
Wi-Fi Protected Access Two (WPA2), 216, 222
Wi-Fi Protected Access (WPA), 221
Windows Anytime Upgrade
function of, 5
upgrading from one Vista edition to another,
17–18
Windows Vista Ultimate Edition and, 39–40
Windows Automated Installation Kit (WAIK), 22,
24
Windows Connect Now, 234–239
Windows Defender
description of, 291
IE 7, 302
Software Explorer, 294–297
using, 291–294
Windows Deployment Services (WDS), 23–24
Windows Easy Transfer Wizard
encryption issues after transfer, 436–437
for migrating files/settings, 18–20
for Windows Vista installation, 7
Windows Experience Index
base score, 359
computer score issues, 404
function of, 356
overview of, 401
score guidelines, 357–358
Windows Filtering Platform (WFP), 249–250
Windows Firewall
for enterprises, 258
managing with Advanced Security snap-in,
258–260
managing with Group Policy, 261
managing with netsh, 261–262
managing with scripts, 262–263
outbound filtering feature, 290
overview of, 248–249, 316
Remote Desktop connection and, 164–165, 186
setup, 251–258
Windows Help and Support
for device installation, 66–67
help, automated, 66–67

460
Index
troubleshooting with, 438–440
Windows Logs, 415, 416–417
Windows Pre-installation Environment (Windows
PE), 8–9, 22
Windows ReadyBoost, 375–377
Windows Remote Assistance, 408–415
Windows Rights Management Service, 127
Windows Server 2003
DHCPv6 and, 212
logon architecture of, 323, 324
NAP and, 212
for Windows Deployment Services installation,
24
Windows Service Hardening (WSH), 250, 290
Windows System Image Manager (Windows
SIM), 22, 40
Windows Update
automatic driver update with, 79
configuration of, 10
driver settings, configuring, 61–62
settings, 277–282
updating Windows Vista, 28–30
in upgrade installation setup, 17
using, 282–283
Windows Vista
activation of, 27–28
antimalware and, 320
automatic driver update with, 79
dual-booting, 30–31
editions of, 2–5
fie systems supported by, 111
installation, automation of, 21–27
installation of, 5–10
logon architecture improvements, 322–326
migration to, 11–21
overview of, 37–39
Remote Assistance improvements in, 414–415
security protocols supported by, 221–222
software driver library, 79
startup, optimization of, 359–364
updating, 28–30
on Virtual PC, 31–36
vulnerabilities, 297
wireless features with, 214–216
wireless security improvements with, 216–222
Windows Vista DVD
for restoring computer, 144
for upgrade installation, 15–17
upgrading from one Vista edition to another, 18
for Windows Vista installation, 8–9
Windows Vista Hardware Assessment tool, 12–13,
65–66
Windows Vista Ultimate Edition, 39–40
Windows Vista Upgrade Advisor, 12–15, 66
Windows XP
audio settings, 80
Disk Defragmenter in, 370
logon architecture of, 323, 324, 325
Remote Assistance in, 414
Windows Vista installation and, 39
wireless networking and, 214, 215
WinLogon, 325–326
WINS, 212
Wired Equivalent Privacy (WEP), 221
wireless
ad hoc network, setting up, 240–242
infrastructure mode wireless network, 224
new features with Vista, 214–216
overview of, 243–244
security in Vista, 216–222
wireless networking protocols, 223–224
wireless router, connecting to, 229–239
wireless router setup, 224–229
wireless access point, 388–389
Wireless Isolation (within SSID) option, 228–229
wireless network. See wireless
Wireless Network Connection Properties screen,
233
Wireless Network Connection Status, 232–234
wireless networking protocols, 223–224
wireless router
connecting to, 229–239
setting up, 224–229
wireless security, 216–222
ad hoc network, 220
EAPHost, extensibility with, 222
network location types, 220–221
passive/active countermeasures, 217–218
security protocols, 221–222
Single Sign-on, 220
unprotected networks, 219–220
Windows Vista improvements, 216–217
wlan context, 215–216
worms, 276–277, 319
. See also malware protection
WPA (Wi-Fi Protected Access), 221
WPA2 (Wi-Fi Protected Access Two), 216, 222
WSH (Windows Service Hardening), 250, 290

