Topics In Analysis
Kuttler
December 18, 2006

2

Contents
I
Review Of Advanced Calculus
15
1
Set Theory
17
1.1
Basic Deï¬nitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
1.2
The Schroder Bernstein Theorem . . . . . . . . . . . . . . . . . . . .
20
1.3
Equivalence Relations
. . . . . . . . . . . . . . . . . . . . . . . . . .
23
1.4
Partially Ordered Sets . . . . . . . . . . . . . . . . . . . . . . . . . .
24
2
Continuous Functions Of One Variable
25
2.1
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
2.2
Theorems About Continuous Functions
. . . . . . . . . . . . . . . .
27
3
The Riemann Stieltjes Integral
33
3.1
Upper And Lower Riemann Stieltjes Sums . . . . . . . . . . . . . . .
33
3.2
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
3.3
Functions Of Riemann Integrable Functions . . . . . . . . . . . . . .
38
3.4
Properties Of The Integral . . . . . . . . . . . . . . . . . . . . . . . .
41
3.5
Fundamental Theorem Of Calculus . . . . . . . . . . . . . . . . . . .
45
3.6
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
4
Some Important Linear Algebra
51
4.1
Algebra in Fn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
4.2
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
4.3
Subspaces Spans And Bases . . . . . . . . . . . . . . . . . . . . . . .
55
4.4
An Application To Matrices . . . . . . . . . . . . . . . . . . . . . . .
59
4.5
The Mathematical Theory Of Determinants . . . . . . . . . . . . . .
61
4.6
Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
74
4.7
The Cayley Hamilton Theorem . . . . . . . . . . . . . . . . . . . . .
74
4.8
An Identity Of Cauchy . . . . . . . . . . . . . . . . . . . . . . . . . .
76
4.9
Block Multiplication Of Matrices . . . . . . . . . . . . . . . . . . . .
77
4.10 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
4.11 Shurâ€™s Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
4.12 The Right Polar Decomposition . . . . . . . . . . . . . . . . . . . . .
87
3

4
CONTENTS
5
Multi-variable Calculus
91
5.1
Continuous Functions
. . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.1.1
Distance In Fn . . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.2
Open And Closed Sets . . . . . . . . . . . . . . . . . . . . . . . . . .
94
5.3
Continuous Functions
. . . . . . . . . . . . . . . . . . . . . . . . . .
96
5.3.1
Suï¬ƒcient Conditions For Continuity . . . . . . . . . . . . . .
96
5.4
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
97
5.5
Limits Of A Function
. . . . . . . . . . . . . . . . . . . . . . . . . .
98
5.6
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
5.7
The Limit Of A Sequence . . . . . . . . . . . . . . . . . . . . . . . . 102
5.7.1
Sequences And Completeness . . . . . . . . . . . . . . . . . . 104
5.7.2
Continuity And The Limit Of A Sequence . . . . . . . . . . . 105
5.8
Properties Of Continuous Functions
. . . . . . . . . . . . . . . . . . 106
5.9
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.10 Proofs Of Theorems
. . . . . . . . . . . . . . . . . . . . . . . . . . . 107
5.11 The Space L (Fn, Fm)
. . . . . . . . . . . . . . . . . . . . . . . . . . 112
5.11.1 The Operator Norm . . . . . . . . . . . . . . . . . . . . . . . 112
5.12 The Frechet Derivative . . . . . . . . . . . . . . . . . . . . . . . . . . 114
5.13 C1 Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
5.14 Ck Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
5.15 Mixed Partial Derivatives . . . . . . . . . . . . . . . . . . . . . . . . 123
5.16 Implicit Function Theorem
. . . . . . . . . . . . . . . . . . . . . . . 125
5.16.1 More Continuous Partial Derivatives . . . . . . . . . . . . . . 129
5.17 The Method Of Lagrange Multipliers . . . . . . . . . . . . . . . . . . 130
6
Metric Spaces And General Topological Spaces
133
6.1
Metric Space
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
6.2
Compactness In Metric Space . . . . . . . . . . . . . . . . . . . . . . 135
6.3
Some Applications Of Compactness . . . . . . . . . . . . . . . . . . . 139
6.4
Ascoli Arzela Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . 140
6.5
The Tietze Extension Theorem . . . . . . . . . . . . . . . . . . . . . 144
6.6
General Topological Spaces
. . . . . . . . . . . . . . . . . . . . . . . 147
6.7
Connected Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152
7
Weierstrass Approximation Theorem
157
7.1
The Bernstein Polynomials
. . . . . . . . . . . . . . . . . . . . . . . 157
7.2
Stone Weierstrass Theorem
. . . . . . . . . . . . . . . . . . . . . . . 161
7.2.1
The Case Of Compact Sets . . . . . . . . . . . . . . . . . . . 161
7.2.2
The Case Of Locally Compact Sets . . . . . . . . . . . . . . . 164
7.2.3
The Case Of Complex Valued Functions . . . . . . . . . . . . 165
7.3
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166

CONTENTS
5
II
Real And Abstract Analysis
169
8
Abstract Measure And Integration
171
8.1
Ïƒ Algebras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
8.2
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 182
8.3
The Abstract Lebesgue Integral . . . . . . . . . . . . . . . . . . . . . 183
8.3.1
Preliminary Observations . . . . . . . . . . . . . . . . . . . . 183
8.3.2
Deï¬nition Of The Lebesgue Integral For Nonnegative Mea-
surable Functions . . . . . . . . . . . . . . . . . . . . . . . . . 185
8.3.3
The Lebesgue Integral For Nonnegative Simple Functions . . 187
8.3.4
Simple Functions And Measurable Functions
. . . . . . . . . 190
8.3.5
The Monotone Convergence Theorem
. . . . . . . . . . . . . 192
8.3.6
Other Deï¬nitions . . . . . . . . . . . . . . . . . . . . . . . . . 193
8.3.7
Fatouâ€™s Lemma . . . . . . . . . . . . . . . . . . . . . . . . . . 194
8.3.8
The Righteous Algebraic Desires Of The Lebesgue Integral
. 196
8.4
The Space L1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197
8.5
Vitali Convergence Theorem . . . . . . . . . . . . . . . . . . . . . . . 203
8.6
Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205
9
The Construction Of Measures
209
9.1
Outer Measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
9.2
Regular Measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215
9.3
Urysohnâ€™s lemma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
9.4
Positive Linear Functionals
. . . . . . . . . . . . . . . . . . . . . . . 221
9.5
One Dimensional Lebesgue Measure
. . . . . . . . . . . . . . . . . . 231
9.6
The Distribution Function . . . . . . . . . . . . . . . . . . . . . . . . 231
9.7
Product Measures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 233
9.8
Alternative Treatment Of Product Measure . . . . . . . . . . . . . . 245
9.8.1
Monotone Classes And Algebras
. . . . . . . . . . . . . . . . 245
9.8.2
Product Measure . . . . . . . . . . . . . . . . . . . . . . . . . 248
9.9
Completion Of Measures . . . . . . . . . . . . . . . . . . . . . . . . . 253
9.10 Another Version Of Product Measures . . . . . . . . . . . . . . . . . 257
9.10.1 General Theory . . . . . . . . . . . . . . . . . . . . . . . . . . 257
9.10.2 Completion Of Product Measure Spaces . . . . . . . . . . . . 261
9.11 Disturbing Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . 263
9.12 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 265
10 Lebesgue Measure
267
10.1 Basic Properties
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267
10.2 The Vitali Covering Theorem . . . . . . . . . . . . . . . . . . . . . . 271
10.3 The Vitali Covering Theorem (Elementary Version) . . . . . . . . . . 273
10.4 Vitali Coverings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 276
10.5 Change Of Variables For Linear Maps . . . . . . . . . . . . . . . . . 279
10.6 Change Of Variables For C1 Functions . . . . . . . . . . . . . . . . . 283
10.7 Mappings Which Are Not One To One . . . . . . . . . . . . . . . . . 289

6
CONTENTS
10.8 Lebesgue Measure And Iterated Integrals
. . . . . . . . . . . . . . . 290
10.9 Spherical Coordinates In Many Dimensions . . . . . . . . . . . . . . 292
10.10The Brouwer Fixed Point Theorem . . . . . . . . . . . . . . . . . . . 294
10.11The Brouwer Fixed Point Theorem Another Proof
. . . . . . . . . . 298
11 Some Extension Theorems
303
11.1 Caratheodory Extension Theorem
. . . . . . . . . . . . . . . . . . . 303
11.2 The Tychonoï¬€Theorem . . . . . . . . . . . . . . . . . . . . . . . . . 305
11.3 Kolmogorov Extension Theorem
. . . . . . . . . . . . . . . . . . . . 308
11.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 313
12 The Lp Spaces
315
12.1 Basic Inequalities And Properties . . . . . . . . . . . . . . . . . . . . 315
12.2 Density Considerations . . . . . . . . . . . . . . . . . . . . . . . . . . 323
12.3 Separability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 325
12.4 Continuity Of Translation . . . . . . . . . . . . . . . . . . . . . . . . 327
12.5 Molliï¬ers And Density Of Smooth Functions
. . . . . . . . . . . . . 328
12.6 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 332
13 Banach Spaces
337
13.1 Theorems Based On Baire Category
. . . . . . . . . . . . . . . . . . 337
13.1.1 Baire Category Theorem . . . . . . . . . . . . . . . . . . . . . 337
13.1.2 Uniform Boundedness Theorem . . . . . . . . . . . . . . . . . 341
13.1.3 Open Mapping Theorem . . . . . . . . . . . . . . . . . . . . . 342
13.1.4 Closed Graph Theorem
. . . . . . . . . . . . . . . . . . . . . 344
13.2 Hahn Banach Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . 346
13.3 Weak And Weak âˆ—Topologies . . . . . . . . . . . . . . . . . . . . . . 354
13.3.1 Basic Deï¬nitions . . . . . . . . . . . . . . . . . . . . . . . . . 354
13.3.2 Banach Alaoglu Theorem . . . . . . . . . . . . . . . . . . . . 355
13.3.3 Eberlein Smulian Theorem
. . . . . . . . . . . . . . . . . . . 357
13.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 360
14 Hilbert Spaces
365
14.1 Basic Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365
14.2 Approximations In Hilbert Space . . . . . . . . . . . . . . . . . . . . 371
14.3 The MÂ¨untz Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . 374
14.4 Orthonormal Sets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 378
14.5 Fourier Series, An Example . . . . . . . . . . . . . . . . . . . . . . . 380
14.6 Compact Operators
. . . . . . . . . . . . . . . . . . . . . . . . . . . 382
14.6.1 Compact Operators In Hilbert Space . . . . . . . . . . . . . . 382
14.6.2 Nuclear Operators . . . . . . . . . . . . . . . . . . . . . . . . 387
14.6.3 Hilbert Schmidt Operators
. . . . . . . . . . . . . . . . . . . 390
14.7 Compact Operators In Banach Space . . . . . . . . . . . . . . . . . . 394
14.8 The Fredholm Alternative . . . . . . . . . . . . . . . . . . . . . . . . 396

CONTENTS
7
15 Representation Theorems
399
15.1 Radon Nikodym Theorem . . . . . . . . . . . . . . . . . . . . . . . . 399
15.2 Vector Measures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 405
15.3 Representation Theorems For The Dual Space Of Lp . . . . . . . . . 412
15.4 The Dual Space Of C (X) . . . . . . . . . . . . . . . . . . . . . . . . 420
15.5 The Dual Space Of C0(X) . . . . . . . . . . . . . . . . . . . . . . . . 422
15.6 More Attractive Formulations . . . . . . . . . . . . . . . . . . . . . . 424
15.7 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 425
16 Integrals And Derivatives
429
16.1 The Fundamental Theorem Of Calculus . . . . . . . . . . . . . . . . 429
16.2 Absolutely Continuous Functions . . . . . . . . . . . . . . . . . . . . 434
16.3 Diï¬€erentiation Of Measures With Respect To Lebesgue Measure
. . 439
16.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 444
17 Hausdorï¬€Measure
449
17.1 Deï¬nition Of Hausdorï¬€Measures . . . . . . . . . . . . . . . . . . . . 449
17.1.1 Properties Of Hausdorï¬€Measure . . . . . . . . . . . . . . . . 450
17.1.2 Hn And mn . . . . . . . . . . . . . . . . . . . . . . . . . . . . 453
17.1.3 A Formula For Î± (n) . . . . . . . . . . . . . . . . . . . . . . . 456
17.1.4 Hausdorï¬€Measure And Linear Transformations . . . . . . . . 458
17.2 The Area Formula
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 460
17.2.1 Preliminary Results
. . . . . . . . . . . . . . . . . . . . . . . 460
17.2.2 The Area Formula . . . . . . . . . . . . . . . . . . . . . . . . 468
17.3 The Area Formula Alternate Version . . . . . . . . . . . . . . . . . . 471
17.3.1 Preliminary Results
. . . . . . . . . . . . . . . . . . . . . . . 471
17.3.2 The Area Formula . . . . . . . . . . . . . . . . . . . . . . . . 478
17.4 The Divergence Theorem
. . . . . . . . . . . . . . . . . . . . . . . . 480
18 Diï¬€erentiation With Respect To General Radon Measures
495
18.1 Besicovitch Covering Theorem
. . . . . . . . . . . . . . . . . . . . . 495
18.2 Fundamental Theorem Of Calculus For Radon Measures . . . . . . . 500
18.3 Slicing Measures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 504
18.4 Vitali Coverings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 509
18.5 Diï¬€erentiation Of Radon Measures . . . . . . . . . . . . . . . . . . . 512
18.6 The Radon Nikodym Theorem For Radon Measures
. . . . . . . . . 515
19 Fourier Transforms
517
19.1 An Algebra Of Special Functions . . . . . . . . . . . . . . . . . . . . 517
19.2 Fourier Transforms Of Functions In G
. . . . . . . . . . . . . . . . . 518
19.3 Fourier Transforms Of Just About Anything . . . . . . . . . . . . . . 521
19.3.1 Fourier Transforms Of Functions In L1 (Rn) . . . . . . . . . . 525
19.3.2 Fourier Transforms Of Functions In L2 (Rn) . . . . . . . . . . 528
19.3.3 The Schwartz Class
. . . . . . . . . . . . . . . . . . . . . . . 532
19.3.4 Convolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . 534
19.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 536

8
CONTENTS
20 Fourier Analysis In Rn An Introduction
541
20.1 The Marcinkiewicz Interpolation Theorem . . . . . . . . . . . . . . . 541
20.2 The Calderon Zygmund Decomposition
. . . . . . . . . . . . . . . . 544
20.3 Mihlinâ€™s Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 546
20.4 Singular Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 559
20.5 Helmholtz Decompositions . . . . . . . . . . . . . . . . . . . . . . . . 569
21 The Bochner Integral
577
21.1 Strong And Weak Measurability
. . . . . . . . . . . . . . . . . . . . 577
21.2 The Bochner Integral . . . . . . . . . . . . . . . . . . . . . . . . . . . 585
21.2.1 Deï¬nition And Basic Properties
. . . . . . . . . . . . . . . . 585
21.2.2 Taking A Closed Operator Out Of The Integral . . . . . . . . 589
21.3 Operator Valued Functions
. . . . . . . . . . . . . . . . . . . . . . . 594
21.3.1 Review Of Hilbert Schmidt Theorem . . . . . . . . . . . . . . 596
21.3.2 Measurable Compact Operators . . . . . . . . . . . . . . . . . 600
21.4 Fubiniâ€™s Theorem For Bochner Integrals . . . . . . . . . . . . . . . . 600
21.5 The Spaces Lp (â„¦; X)
. . . . . . . . . . . . . . . . . . . . . . . . . . 603
21.6 Measurable Representatives . . . . . . . . . . . . . . . . . . . . . . . 610
21.7 Vector Measures
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 612
21.8 The Riesz Representation Theorem . . . . . . . . . . . . . . . . . . . 617
21.9 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 621
III
Complex Analysis
623
22 The Complex Numbers
625
22.1 The Extended Complex Plane . . . . . . . . . . . . . . . . . . . . . . 627
22.2 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 628
23 Riemann Stieltjes Integrals
629
23.1 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 639
24 Fundamentals Of Complex Analysis
641
24.1 Analytic Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 641
24.1.1 Cauchy Riemann Equations . . . . . . . . . . . . . . . . . . . 643
24.1.2 An Important Example
. . . . . . . . . . . . . . . . . . . . . 645
24.2 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 646
24.3 Cauchyâ€™s Formula For A Disk . . . . . . . . . . . . . . . . . . . . . . 647
24.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 654
24.5 Zeros Of An Analytic Function . . . . . . . . . . . . . . . . . . . . . 657
24.6 Liouvilleâ€™s Theorem
. . . . . . . . . . . . . . . . . . . . . . . . . . . 659
24.7 The General Cauchy Integral Formula . . . . . . . . . . . . . . . . . 660
24.7.1 The Cauchy Goursat Theorem
. . . . . . . . . . . . . . . . . 660
24.7.2 A Redundant Assumption . . . . . . . . . . . . . . . . . . . . 663
24.7.3 Classiï¬cation Of Isolated Singularities . . . . . . . . . . . . . 664
24.7.4 The Cauchy Integral Formula . . . . . . . . . . . . . . . . . . 667

CONTENTS
9
24.7.5 An Example Of A Cycle . . . . . . . . . . . . . . . . . . . . . 674
24.8 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 678
25 The Open Mapping Theorem
681
25.1 A Local Representation
. . . . . . . . . . . . . . . . . . . . . . . . . 681
25.2 Branches Of The Logarithm . . . . . . . . . . . . . . . . . . . . . . . 683
25.3 Maximum Modulus Theorem
. . . . . . . . . . . . . . . . . . . . . . 685
25.4 Extensions Of Maximum Modulus Theorem . . . . . . . . . . . . . . 687
25.4.1 PhragmË†en LindelÂ¨of Theorem
. . . . . . . . . . . . . . . . . . 687
25.4.2 Hadamard Three Circles Theorem
. . . . . . . . . . . . . . . 689
25.4.3 Schwarzâ€™s Lemma . . . . . . . . . . . . . . . . . . . . . . . . . 690
25.4.4 One To One Analytic Maps On The Unit Ball
. . . . . . . . 691
25.5 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 692
25.6 Counting Zeros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 694
25.7 An Application To Linear Algebra
. . . . . . . . . . . . . . . . . . . 698
25.8 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 702
26 Residues
705
26.1 Roucheâ€™s Theorem And The Argument Principle . . . . . . . . . . . 708
26.1.1 Argument Principle
. . . . . . . . . . . . . . . . . . . . . . . 708
26.1.2 Roucheâ€™s Theorem . . . . . . . . . . . . . . . . . . . . . . . . 711
26.1.3 A Diï¬€erent Formulation . . . . . . . . . . . . . . . . . . . . . 712
26.2 Singularities And The Laurent Series . . . . . . . . . . . . . . . . . . 713
26.2.1 What Is An Annulus? . . . . . . . . . . . . . . . . . . . . . . 713
26.2.2 The Laurent Series . . . . . . . . . . . . . . . . . . . . . . . . 716
26.2.3 Contour Integrals And Evaluation Of Integrals . . . . . . . . 720
26.3 The Spectral Radius Of A Bounded Linear Transformation
. . . . . 729
26.4 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 731
27 Complex Mappings
735
27.1 Conformal Maps
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 735
27.2 Fractional Linear Transformations
. . . . . . . . . . . . . . . . . . . 736
27.2.1 Circles And Lines
. . . . . . . . . . . . . . . . . . . . . . . . 736
27.2.2 Three Points To Three Points . . . . . . . . . . . . . . . . . . 738
27.3 Riemann Mapping Theorem . . . . . . . . . . . . . . . . . . . . . . . 739
27.3.1 Montelâ€™s Theorem
. . . . . . . . . . . . . . . . . . . . . . . . 740
27.3.2 Regions With Square Root Property . . . . . . . . . . . . . . 742
27.4 Analytic Continuation . . . . . . . . . . . . . . . . . . . . . . . . . . 746
27.4.1 Regular And Singular Points
. . . . . . . . . . . . . . . . . . 746
27.4.2 Continuation Along A Curve . . . . . . . . . . . . . . . . . . 748
27.5 The Picard Theorems
. . . . . . . . . . . . . . . . . . . . . . . . . . 749
27.5.1 Two Competing Lemmas
. . . . . . . . . . . . . . . . . . . . 751
27.5.2 The Little Picard Theorem
. . . . . . . . . . . . . . . . . . . 754
27.5.3 Schottkyâ€™s Theorem
. . . . . . . . . . . . . . . . . . . . . . . 755
27.5.4 A Brief Review . . . . . . . . . . . . . . . . . . . . . . . . . . 759

10
CONTENTS
27.5.5 Montelâ€™s Theorem
. . . . . . . . . . . . . . . . . . . . . . . . 761
27.5.6 The Great Big Picard Theorem . . . . . . . . . . . . . . . . . 762
27.6 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 764
28 Approximation By Rational Functions
767
28.1 Rungeâ€™s Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 767
28.1.1 Approximation With Rational Functions . . . . . . . . . . . . 767
28.1.2 Moving The Poles And Keeping The Approximation . . . . . 769
28.1.3 Mertenâ€™s Theorem. . . . . . . . . . . . . . . . . . . . . . . . . 769
28.1.4 Rungeâ€™s Theorem . . . . . . . . . . . . . . . . . . . . . . . . . 774
28.2 The Mittag-Leï¬„er Theorem . . . . . . . . . . . . . . . . . . . . . . . 776
28.2.1 A Proof From Rungeâ€™s Theorem
. . . . . . . . . . . . . . . . 776
28.2.2 A Direct Proof Without Rungeâ€™s Theorem . . . . . . . . . . . 778
28.2.3 Functions Meromorphic On bC . . . . . . . . . . . . . . . . . . 780
28.2.4 A Great And Glorious Theorem About Simply Connected
Regions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 780
28.3 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 784
29 Inï¬nite Products
785
29.1 Analytic Function With Prescribed Zeros
. . . . . . . . . . . . . . . 789
29.2 Factoring A Given Analytic Function . . . . . . . . . . . . . . . . . . 794
29.2.1 Factoring Some Special Analytic Functions
. . . . . . . . . . 796
29.3 The Existence Of An Analytic Function With Given Values . . . . . 798
29.4 Jensenâ€™s Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 802
29.5 Blaschke Products
. . . . . . . . . . . . . . . . . . . . . . . . . . . . 805
29.5.1 The MÂ¨untz-Szasz Theorem Again . . . . . . . . . . . . . . . . 808
29.6 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 810
30 Elliptic Functions
819
30.1 Periodic Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 820
30.1.1 The Unimodular Transformations . . . . . . . . . . . . . . . . 824
30.1.2 The Search For An Elliptic Function . . . . . . . . . . . . . . 827
30.1.3 The Diï¬€erential Equation Satisï¬ed By â„˜. . . . . . . . . . . . 830
30.1.4 A Modular Function . . . . . . . . . . . . . . . . . . . . . . . 832
30.1.5 A Formula For Î» . . . . . . . . . . . . . . . . . . . . . . . . . 838
30.1.6 Mapping Properties Of Î»
. . . . . . . . . . . . . . . . . . . . 840
30.1.7 A Short Review And Summary . . . . . . . . . . . . . . . . . 848
30.2 The Picard Theorem Again . . . . . . . . . . . . . . . . . . . . . . . 852
30.3 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 853
IV
Stochastic Processes, An Introduction
855
31 Random Variables And Basic Probability
857
31.1 The Characteristic Function . . . . . . . . . . . . . . . . . . . . . . . 860
31.2 Conditional Probability
. . . . . . . . . . . . . . . . . . . . . . . . . 861

CONTENTS
11
31.3 The Multivariate Normal Distribution . . . . . . . . . . . . . . . . . 867
31.4 The Central Limit Theorem . . . . . . . . . . . . . . . . . . . . . . . 875
31.5 Brownian Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 881
32 Conditional Expectation And Martingales
893
32.1 Conditional Expectation . . . . . . . . . . . . . . . . . . . . . . . . . 893
32.2 Discrete Martingales . . . . . . . . . . . . . . . . . . . . . . . . . . . 896
33 Filtrations And Martingales
903
33.1 Continuous Martingales . . . . . . . . . . . . . . . . . . . . . . . . . 910
33.2 Doobâ€™s Martingale Estimate . . . . . . . . . . . . . . . . . . . . . . . 915
34 The ItË†o Integral
917
34.1 Properties Of The ItË†o Integral . . . . . . . . . . . . . . . . . . . . . . 925
35 Stochastic Processes
933
35.1 An Important Filtration . . . . . . . . . . . . . . . . . . . . . . . . . 933
35.2 ItË†o Processes
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 936
35.3 Some Representation Theorems . . . . . . . . . . . . . . . . . . . . . 948
35.4 Stochastic Diï¬€erential Equations . . . . . . . . . . . . . . . . . . . . 960
35.4.1 Gronwallâ€™s Inequality
. . . . . . . . . . . . . . . . . . . . . . 960
35.4.2 Review Of ItË†o Integrals And A Filtration
. . . . . . . . . . . 961
35.4.3 A Function Space . . . . . . . . . . . . . . . . . . . . . . . . . 963
35.4.4 An Extension Of The ItË†o Integral . . . . . . . . . . . . . . . . 964
35.4.5 A Vector Valued Deterministic Integral
. . . . . . . . . . . . 965
35.4.6 The Existence And Uniqueness Theorem . . . . . . . . . . . . 968
35.4.7 Some Simple Examples
. . . . . . . . . . . . . . . . . . . . . 972
35.5 A Diï¬€erent Proof Of Existence And Uniqueness . . . . . . . . . . . . 975
35.5.1 Gronwallâ€™s Inequality
. . . . . . . . . . . . . . . . . . . . . . 975
35.5.2 Review Of ItË†o Integrals
. . . . . . . . . . . . . . . . . . . . . 976
35.5.3 The Existence And Uniqueness Theorem . . . . . . . . . . . . 978
35.5.4 Some Simple Examples
. . . . . . . . . . . . . . . . . . . . . 982
36 Probability In Inï¬nite Dimensions
987
36.1 Expected Value Covariance And Correlation . . . . . . . . . . . . . . 987
36.2 Independence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 990
36.3 Conditional Expectation . . . . . . . . . . . . . . . . . . . . . . . . . 996
36.4 Probability Measures And Tightness . . . . . . . . . . . . . . . . . . 1000
36.5 A Major Existence And Convergence Theorem
. . . . . . . . . . . . 1007
36.6 Characteristic Functions . . . . . . . . . . . . . . . . . . . . . . . . . 1014
36.7 Convolution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1019
36.8 The Multivariate Normal Distribution . . . . . . . . . . . . . . . . . 1024
36.9 Gaussian Measures . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1031
36.9.1 Deï¬nitions And Basic Properties . . . . . . . . . . . . . . . . 1031
36.10Gaussian Measures For A Separable Hilbert Space
. . . . . . . . . . 1033
36.11Abstract Wiener Spaces . . . . . . . . . . . . . . . . . . . . . . . . . 1036

12
CONTENTS
36.12White Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1046
36.13Existence Of Abstract Wiener Spaces
. . . . . . . . . . . . . . . . . 1050
36.14Ferniqueâ€™s Theorem
. . . . . . . . . . . . . . . . . . . . . . . . . . . 1055
36.15Reproducing Kernels . . . . . . . . . . . . . . . . . . . . . . . . . . . 1061
36.16Reproducing Kernels And White Noise . . . . . . . . . . . . . . . . . 1071
V
Sobolev Spaces
1077
37 Weak Derivatives
1079
37.1 Weak âˆ—Convergence . . . . . . . . . . . . . . . . . . . . . . . . . . . 1079
37.2 Test Functions And Weak Derivatives
. . . . . . . . . . . . . . . . . 1080
37.3 Weak Derivatives In Lp
loc . . . . . . . . . . . . . . . . . . . . . . . . . 1084
37.4 Morreyâ€™s Inequality . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1087
37.5 Rademacherâ€™s Theorem
. . . . . . . . . . . . . . . . . . . . . . . . . 1090
37.6 Change Of Variables Formula Lipschitz Maps . . . . . . . . . . . . . 1093
38 The Area And Coarea Formulas
1103
38.1 The Area Formula Again
. . . . . . . . . . . . . . . . . . . . . . . . 1103
38.2 Mappings That Are Not One To One . . . . . . . . . . . . . . . . . . 1106
38.3 The Coarea Formula . . . . . . . . . . . . . . . . . . . . . . . . . . . 1110
38.4 A Nonlinear Fubiniâ€™s Theorem
. . . . . . . . . . . . . . . . . . . . . 1121
39 Integration On Manifolds
1123
39.1 Partitions Of Unity . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1123
39.2 Integration On Manifolds
. . . . . . . . . . . . . . . . . . . . . . . . 1127
39.3 Comparison With Hn
. . . . . . . . . . . . . . . . . . . . . . . . . . 1133
40 Basic Theory Of Sobolev Spaces
1135
40.1 Embedding Theorems For W m,p (Rn) . . . . . . . . . . . . . . . . . . 1144
40.2 An Extension Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . 1157
40.3 General Embedding Theorems . . . . . . . . . . . . . . . . . . . . . . 1165
40.4 More Extension Theorems . . . . . . . . . . . . . . . . . . . . . . . . 1168
41 Sobolev Spaces Based On L2
1173
41.1 Fourier Transform Techniques . . . . . . . . . . . . . . . . . . . . . . 1173
41.2 Fractional Order Spaces . . . . . . . . . . . . . . . . . . . . . . . . . 1178
41.3 Embedding Theorems
. . . . . . . . . . . . . . . . . . . . . . . . . . 1186
41.4 The Trace On The Boundary Of A Half Space
. . . . . . . . . . . . 1188
41.5 Sobolev Spaces On Manifolds . . . . . . . . . . . . . . . . . . . . . . 1195
41.5.1 General Theory . . . . . . . . . . . . . . . . . . . . . . . . . . 1195
41.5.2 The Trace On The Boundary . . . . . . . . . . . . . . . . . . 1200
42 Weak Solutions
1205
42.1 The Lax Milgram Theorem
. . . . . . . . . . . . . . . . . . . . . . . 1205

CONTENTS
13
43 Kornâ€™s Inequality
1211
43.1 A Fundamental Inequality . . . . . . . . . . . . . . . . . . . . . . . . 1211
43.2 Kornâ€™s Inequality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1217
44 Elliptic Regularity And Nirenberg Diï¬€erences
1219
44.1 The Case Of A Half Space . . . . . . . . . . . . . . . . . . . . . . . . 1219
44.2 The Case Of Bounded Open Sets . . . . . . . . . . . . . . . . . . . . 1229
45 Interpolation In Banach Space
1239
45.1 An Assortment Of Important Theorems . . . . . . . . . . . . . . . . 1239
45.1.1 Weak Vector Valued Derivatives
. . . . . . . . . . . . . . . . 1239
45.1.2 Some Imbedding Theorems . . . . . . . . . . . . . . . . . . . 1249
45.2 The K Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1254
45.3 The J Method
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1259
45.4 Duality And Interpolation . . . . . . . . . . . . . . . . . . . . . . . . 1265
46 Trace Spaces
1275
46.1 Deï¬nition And Basic Theory Of Trace Spaces . . . . . . . . . . . . . 1275
46.2 Equivalence Of Trace And Interpolation Spaces . . . . . . . . . . . . 1281
47 Traces Of Sobolev Spaces And Fractional Order Spaces
1289
47.1 Traces Of Sobolev Spaces On The Boundary Of A Half Space . . . . 1289
47.2 A Right Inverse For The Trace For A Half Space . . . . . . . . . . . 1292
47.3 Fractional Order Sobolev Spaces
. . . . . . . . . . . . . . . . . . . . 1294
48 Sobolev Spaces On Manifolds
1299
48.1 Basic Deï¬nitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1299
48.2 The Trace On The Boundary Of An Open Set . . . . . . . . . . . . . 1301
A The Hausdorï¬€Maximal Theorem
1305
A.1 Exercises
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1309
Copyright câƒ2004,

14
CONTENTS

Part I
Review Of Advanced
Calculus
15


Set Theory
1.1
Basic Deï¬nitions
A set is a collection of things called elements of the set. For example, the set of
integers, the collection of signed whole numbers such as 1,2,-4, etc. This set whose
existence will be assumed is denoted by Z. Other sets could be the set of people in
a family or the set of donuts in a display case at the store. Sometimes parentheses,
{ } specify a set by listing the things which are in the set between the parentheses.
For example the set of integers between -1 and 2, including these numbers could
be denoted as {âˆ’1, 0, 1, 2}. The notation signifying x is an element of a set S, is
written as x âˆˆS. Thus, 1 âˆˆ{âˆ’1, 0, 1, 2, 3}. Here are some axioms about sets.
Axioms are statements which are accepted, not proved.
1. Two sets are equal if and only if they have the same elements.
2. To every set, A, and to every condition S (x) there corresponds a set, B, whose
elements are exactly those elements x of A for which S (x) holds.
3. For every collection of sets there exists a set that contains all the elements
that belong to at least one set of the given collection.
4. The Cartesian product of a nonempty family of nonempty sets is nonempty.
5. If A is a set there exists a set, P (A) such that P (A) is the set of all subsets
of A. This is called the power set.
These axioms are referred to as the axiom of extension, axiom of speciï¬cation,
axiom of unions, axiom of choice, and axiom of powers respectively.
It seems fairly clear you should want to believe in the axiom of extension. It is
merely saying, for example, that {1, 2, 3} = {2, 3, 1} since these two sets have the
same elements in them. Similarly, it would seem you should be able to specify a
new set from a given set using some â€œconditionâ€ which can be used as a test to
determine whether the element in question is in the set. For example, the set of all
integers which are multiples of 2. This set could be speciï¬ed as follows.
{x âˆˆZ : x = 2y for some y âˆˆZ} .
17

18
SET THEORY
In this notation, the colon is read as â€œsuch thatâ€ and in this case the condition is
being a multiple of 2.
Another example of political interest, could be the set of all judges who are not
judicial activists. I think you can see this last is not a very precise condition since
there is no way to determine to everyoneâ€™s satisfaction whether a given judge is an
activist. Also, just because something is grammatically correct does not mean it
makes any sense. For example consider the following nonsense.
S = {x âˆˆset of dogs : it is colder in the mountains than in the winter} .
So what is a condition?
We will leave these sorts of considerations and assume our conditions make sense.
The axiom of unions states that for any collection of sets, there is a set consisting
of all the elements in each of the sets in the collection. Of course this is also open to
further consideration. What is a collection? Maybe it would be better to say â€œset
of setsâ€ or, given a set whose elements are sets there exists a set whose elements
consist of exactly those things which are elements of at least one of these sets. If S
is such a set whose elements are sets,
âˆª{A : A âˆˆS} or âˆªS
signify this union.
Something is in the Cartesian product of a set or â€œfamilyâ€ of sets if it consists
of a single thing taken from each set in the family. Thus (1, 2, 3) âˆˆ{1, 4, .2} Ã—
{1, 2, 7}Ã—{4, 3, 7, 9} because it consists of exactly one element from each of the sets
which are separated by Ã—. Also, this is the notation for the Cartesian product of
ï¬nitely many sets. If S is a set whose elements are sets,
Y
AâˆˆS
A
signiï¬es the Cartesian product.
The Cartesian product is the set of choice functions, a choice function being a
function which selects exactly one element of each set of S. You may think the axiom
of choice, stating that the Cartesian product of a nonempty family of nonempty sets
is nonempty, is innocuous but there was a time when many mathematicians were
ready to throw it out because it implies things which are very hard to believe, things
which never happen without the axiom of choice.
A is a subset of B, written A âŠ†B, if every element of A is also an element of
B. This can also be written as B âŠ‡A. A is a proper subset of B, written A âŠ‚B
or B âŠƒA if A is a subset of B but A is not equal to B, A Ì¸= B. A âˆ©B denotes the
intersection of the two sets, A and B and it means the set of elements of A which
are also elements of B. The axiom of speciï¬cation shows this is a set. The empty
set is the set which has no elements in it, denoted as âˆ…. A âˆªB denotes the union
of the two sets, A and B and it means the set of all elements which are in either of
the sets. It is a set because of the axiom of unions.

1.1.
BASIC DEFINITIONS
19
The complement of a set, (the set of things which are not in the given set ) must
be taken with respect to a given set called the universal set which is a set which
contains the one whose complement is being taken. Thus, the complement of A,
denoted as AC ( or more precisely as X \ A) is a set obtained from using the axiom
of speciï¬cation to write
AC â‰¡{x âˆˆX : x /âˆˆA}
The symbol /âˆˆmeans: â€œis not an element ofâ€. Note the axiom of speciï¬cation takes
place relative to a given set. Without this universal set it makes no sense to use
the axiom of speciï¬cation to obtain the complement.
Words such as â€œallâ€ or â€œthere existsâ€ are called quantiï¬ers and they must be
understood relative to some given set. For example, the set of all integers larger
than 3. Or there exists an integer larger than 7. Such statements have to do with a
given set, in this case the integers. Failure to have a reference set when quantiï¬ers
are used turns out to be illogical even though such usage may be grammatically
correct. Quantiï¬ers are used often enough that there are symbols for them. The
symbol âˆ€is read as â€œfor allâ€ or â€œfor everyâ€ and the symbol âˆƒis read as â€œthere
existsâ€. Thus âˆ€âˆ€âˆƒâˆƒcould mean for every upside down A there exists a backwards
E.
DeMorganâ€™s laws are very useful in mathematics. Let S be a set of sets each of
which is contained in some universal set, U. Then
âˆª
Â©
AC : A âˆˆS
Âª
= (âˆ©{A : A âˆˆS})C
and
âˆ©
Â©
AC : A âˆˆS
Âª
= (âˆª{A : A âˆˆS})C .
These laws follow directly from the deï¬nitions. Also following directly from the
deï¬nitions are:
Let S be a set of sets then
B âˆªâˆª{A : A âˆˆS} = âˆª{B âˆªA : A âˆˆS} .
and: Let S be a set of sets show
B âˆ©âˆª{A : A âˆˆS} = âˆª{B âˆ©A : A âˆˆS} .
Unfortunately, there is no single universal set which can be used for all sets.
Here is why: Suppose there were. Call it S. Then you could consider A the set
of all elements of S which are not elements of themselves, this from the axiom of
speciï¬cation. If A is an element of itself, then it fails to qualify for inclusion in A.
Therefore, it must not be an element of itself. However, if this is so, it qualiï¬es for
inclusion in A so it is an element of itself and so this canâ€™t be true either. Thus
the most basic of conditions you could imagine, that of being an element of, is
meaningless and so allowing such a set causes the whole theory to be meaningless.
The solution is to not allow a universal set. As mentioned by Halmos in Naive
set theory, â€œNothing contains everythingâ€. Always beware of statements involving
quantiï¬ers wherever they occur, even this one.

20
SET THEORY
1.2
The Schroder Bernstein Theorem
It is very important to be able to compare the size of sets in a rational way. The
most useful theorem in this context is the Schroder Bernstein theorem which is the
main result to be presented in this section. The Cartesian product is discussed
above. The next deï¬nition reviews this and deï¬nes the concept of a function.
Deï¬nition 1.1 Let X and Y be sets.
X Ã— Y â‰¡{(x, y) : x âˆˆX and y âˆˆY }
A relation is deï¬ned to be a subset of X Ã— Y . A function, f, also called a mapping,
is a relation which has the property that if (x, y) and (x, y1) are both elements of
the f, then y = y1. The domain of f is deï¬ned as
D (f) â‰¡{x : (x, y) âˆˆf} ,
written as f : D (f) â†’Y .
It is probably safe to say that most people do not think of functions as a type
of relation which is a subset of the Cartesian product of two sets. A function is like
a machine which takes inputs, x and makes them into a unique output, f (x). Of
course, that is what the above deï¬nition says with more precision. An ordered pair,
(x, y) which is an element of the function or mapping has an input, x and a unique
output, y,denoted as f (x) while the name of the function is f. â€œmappingâ€ is often
a noun meaning function. However, it also is a verb as in â€œf is mapping A to B
â€. That which a function is thought of as doing is also referred to using the word
â€œmapsâ€ as in: f maps X to Y . However, a set of functions may be called a set of
maps so this word might also be used as the plural of a noun. There is no help for
it. You just have to suï¬€er with this nonsense.
The following theorem which is interesting for its own sake will be used to prove
the Schroder Bernstein theorem.
Theorem 1.2 Let f : X â†’Y and g : Y â†’X be two functions. Then there exist
sets A, B, C, D, such that
A âˆªB = X, C âˆªD = Y, A âˆ©B = âˆ…, C âˆ©D = âˆ…,
f (A) = C, g (D) = B.
The following picture illustrates the conclusion of this theorem.
B = g(D)
A
-

D
C = f(A)
Y
X
f
g

1.2.
THE SCHRODER BERNSTEIN THEOREM
21
Proof: Consider the empty set, âˆ…âŠ†X. If y âˆˆY \ f (âˆ…), then g (y) /âˆˆâˆ…because
âˆ…has no elements. Also, if A, B, C, and D are as described above, A also would
have this same property that the empty set has. However, A is probably larger.
Therefore, say A0 âŠ†X satisï¬es P if whenever y âˆˆY \ f (A0) , g (y) /âˆˆA0.
A â‰¡{A0 âŠ†X : A0 satisï¬es P}.
Let A = âˆªA. If y âˆˆY \ f (A), then for each A0 âˆˆA, y âˆˆY \ f (A0) and so
g (y) /âˆˆA0. Since g (y) /âˆˆA0 for all A0 âˆˆA, it follows g (y) /âˆˆA. Hence A satisï¬es
P and is the largest subset of X which does so. Now deï¬ne
C â‰¡f (A) , D â‰¡Y \ C, B â‰¡X \ A.
It only remains to verify that g (D) = B.
Suppose x âˆˆB = X \ A. Then A âˆª{x} does not satisfy P and so there exists
y âˆˆY \ f (A âˆª{x}) âŠ†D such that g (y) âˆˆA âˆª{x} . But y /âˆˆf (A) and so since A
satisï¬es P, it follows g (y) /âˆˆA. Hence g (y) = x and so x âˆˆg (D) and this proves
the theorem.
Theorem 1.3 (Schroder Bernstein) If f : X â†’Y and g : Y â†’X are one to one,
then there exists h : X â†’Y which is one to one and onto.
Proof: Let A, B, C, D be the sets of Theorem1.2 and deï¬ne
h (x) â‰¡
Â½ f (x)
if x âˆˆA
gâˆ’1 (x) if x âˆˆB
Then h is the desired one to one and onto mapping.
Recall that the Cartesian product may be considered as the collection of choice
functions.
Deï¬nition 1.4 Let I be a set and let Xi be a set for each i âˆˆI.
f is a choice
function written as
f âˆˆ
Y
iâˆˆI
Xi
if f (i) âˆˆXi for each i âˆˆI.
The axiom of choice says that if Xi Ì¸= âˆ…for each i âˆˆI, for I a set, then
Y
iâˆˆI
Xi Ì¸= âˆ….
Sometimes the two functions, f and g are onto but not one to one. It turns out
that with the axiom of choice, a similar conclusion to the above may be obtained.
Corollary 1.5 If f : X â†’Y is onto and g : Y â†’X is onto, then there exists
h : X â†’Y which is one to one and onto.

22
SET THEORY
Proof: For each y âˆˆY , f âˆ’1 (y) â‰¡{x âˆˆX : f (x) = y} Ì¸= âˆ…. Therefore, by the
axiom of choice, there exists f âˆ’1
0
âˆˆQ
yâˆˆY f âˆ’1 (y) which is the same as saying that
for each y âˆˆY , f âˆ’1
0
(y) âˆˆf âˆ’1 (y). Similarly, there exists gâˆ’1
0
(x) âˆˆgâˆ’1 (x) for all
x âˆˆX. Then f âˆ’1
0
is one to one because if f âˆ’1
0
(y1) = f âˆ’1
0
(y2), then
y1 = f
Â¡
f âˆ’1
0
(y1)
Â¢
= f
Â¡
f âˆ’1
0
(y2)
Â¢
= y2.
Similarly gâˆ’1
0
is one to one. Therefore, by the Schroder Bernstein theorem, there
exists h : X â†’Y which is one to one and onto.
Deï¬nition 1.6 A set S, is ï¬nite if there exists a natural number n and a map Î¸
which maps {1, Â· Â· Â·, n} one to one and onto S. S is inï¬nite if it is not ï¬nite. A
set S, is called countable if there exists a map Î¸ mapping N one to one and onto
S.(When Î¸ maps a set A to a set B, this will be written as Î¸ : A â†’B in the future.)
Here N â‰¡{1, 2, Â· Â· Â·}, the natural numbers. S is at most countable if there exists a
map Î¸ : N â†’S which is onto.
The property of being at most countable is often referred to as being countable
because the question of interest is normally whether one can list all elements of the
set, designating a ï¬rst, second, third etc. in such a way as to give each element of
the set a natural number. The possibility that a single element of the set may be
counted more than once is often not important.
Theorem 1.7 If X and Y are both at most countable, then X Ã— Y is also at most
countable. If either X or Y is countable, then X Ã— Y is also countable.
Proof: It is given that there exists a mapping Î· : N â†’X which is onto. Deï¬ne
Î· (i) â‰¡xi and consider X as the set {x1, x2, x3, Â· Â· Â·}. Similarly, consider Y as the
set {y1, y2, y3, Â· Â· Â·}. It follows the elements of X Ã— Y are included in the following
rectangular array.
(x1, y1)
(x1, y2)
(x1, y3)
Â· Â· Â·
â†Those which have x1 in ï¬rst slot.
(x2, y1)
(x2, y2)
(x2, y3)
Â· Â· Â·
â†Those which have x2 in ï¬rst slot.
(x3, y1)
(x3, y2)
(x3, y3)
Â· Â· Â·
â†Those which have x3 in ï¬rst slot.
...
...
...
...
.
Follow a path through this array as follows.
(x1, y1)
â†’
(x1, y2)
(x1, y3)
â†’
â†™
â†—
(x2, y1)
(x2, y2)
â†“
â†—
(x3, y1)
Thus the ï¬rst element of X Ã— Y is (x1, y1), the second element of X Ã— Y is (x1, y2),
the third element of X Ã— Y is (x2, y1) etc. This assigns a number from N to each
element of X Ã— Y. Thus X Ã— Y is at most countable.

1.3.
EQUIVALENCE RELATIONS
23
It remains to show the last claim. Suppose without loss of generality that X
is countable. Then there exists Î± : N â†’X which is one to one and onto. Let
Î² : X Ã— Y â†’N be deï¬ned by Î² ((x, y)) â‰¡Î±âˆ’1 (x). Thus Î² is onto N. By the ï¬rst
part there exists a function from N onto X Ã— Y . Therefore, by Corollary 1.5, there
exists a one to one and onto mapping from X Ã— Y to N. This proves the theorem.
Theorem 1.8 If X and Y are at most countable, then X âˆªY is at most countable.
If either X or Y are countable, then X âˆªY is countable.
Proof: As in the preceding theorem,
X = {x1, x2, x3, Â· Â· Â·}
and
Y = {y1, y2, y3, Â· Â· Â·} .
Consider the following array consisting of X âˆªY and path through it.
x1
â†’
x2
x3
â†’
â†™
â†—
y1
â†’
y2
Thus the ï¬rst element of X âˆªY is x1, the second is x2 the third is y1 the fourth is
y2 etc.
Consider the second claim. By the ï¬rst part, there is a map from N onto X Ã—Y .
Suppose without loss of generality that X is countable and Î± : N â†’X is one to one
and onto. Then deï¬ne Î² (y) â‰¡1, for all y âˆˆY ,and Î² (x) â‰¡Î±âˆ’1 (x). Thus, Î² maps
X Ã— Y onto N and this shows there exist two onto maps, one mapping X âˆªY onto
N and the other mapping N onto X âˆªY . Then Corollary 1.5 yields the conclusion.
This proves the theorem.
1.3
Equivalence Relations
There are many ways to compare elements of a set other than to say two elements
are equal or the same. For example, in the set of people let two people be equiv-
alent if they have the same weight. This would not be saying they were the same
person, just that they weighed the same. Often such relations involve considering
one characteristic of the elements of a set and then saying the two elements are
equivalent if they are the same as far as the given characteristic is concerned.
Deï¬nition 1.9 Let S be a set. âˆ¼is an equivalence relation on S if it satisï¬es the
following axioms.
1. x âˆ¼x
for all x âˆˆS. (Reï¬‚exive)
2. If x âˆ¼y then y âˆ¼x. (Symmetric)
3. If x âˆ¼y and y âˆ¼z, then x âˆ¼z. (Transitive)

24
SET THEORY
Deï¬nition 1.10 [x] denotes the set of all elements of S which are equivalent to x
and [x] is called the equivalence class determined by x or just the equivalence class
of x.
With the above deï¬nition one can prove the following simple theorem.
Theorem 1.11 Let âˆ¼be an equivalence class deï¬ned on a set, S and let H denote
the set of equivalence classes. Then if [x] and [y] are two of these equivalence classes,
either x âˆ¼y and [x] = [y] or it is not true that x âˆ¼y and [x] âˆ©[y] = âˆ….
1.4
Partially Ordered Sets
Deï¬nition 1.12 Let F
be a nonempty set. F is called a partially ordered set if
there is a relation, denoted here by â‰¤, such that
x â‰¤x for all x âˆˆF.
If x â‰¤y and y â‰¤z then x â‰¤z.
C âŠ†F is said to be a chain if every two elements of C are related. This means that
if x, y âˆˆC, then either x â‰¤y or y â‰¤x. Sometimes a chain is called a totally ordered
set. C is said to be a maximal chain if whenever D is a chain containing C, D = C.
The most common example of a partially ordered set is the power set of a given
set with âŠ†being the relation. It is also helpful to visualize partially ordered sets
as trees.
Two points on the tree are related if they are on the same branch of
the tree and one is higher than the other. Thus two points on diï¬€erent branches
would not be related although they might both be larger than some point on the
trunk. You might think of many other things which are best considered as partially
ordered sets. Think of food for example. You might ï¬nd it diï¬ƒcult to determine
which of two favorite pies you like better although you may be able to say very
easily that you would prefer either pie to a dish of lard topped with whipped cream
and mustard. The following theorem is equivalent to the axiom of choice. For a
discussion of this, see the appendix on the subject.
Theorem 1.13 (Hausdorï¬€Maximal Principle) Let F
be a nonempty partially
ordered set. Then there exists a maximal chain.

Continuous Functions Of
One Variable
There is a theorem about the integral of a continuous function which requires the
notion of uniform continuity. This is discussed in this section. Consider the function
f (x) = 1
x for x âˆˆ(0, 1) . This is a continuous function because, it is continuous at
every point of (0, 1) . However, for a given Îµ > 0, the Î´ needed in the Îµ, Î´ deï¬nition of
continuity becomes very small as x gets close to 0. The notion of uniform continuity
involves being able to choose a single Î´ which works on the whole domain of f. Here
is the deï¬nition.
Deï¬nition 2.1 Let f : D âŠ†R â†’R be a function. Then f is uniformly continuous
if for every Îµ > 0, there exists a Î´ depending only on Îµ such that if |x âˆ’y| < Î´
then |f (x) âˆ’f (y)| < Îµ.
It is an amazing fact that under certain conditions continuity implies uniform
continuity.
Deï¬nition 2.2 A set, K âŠ†R is sequentially compact if whenever {an} âŠ†K is a
sequence, there exists a subsequence, {ank} such that this subsequence converges to
a point of K.
The following theorem is part of the Heine Borel theorem.
Theorem 2.3 Every closed interval, [a, b] is sequentially compact.
Proof: Let {xn} âŠ†[a, b] â‰¡I0. Consider the two intervals
Â£
a, a+b
2
Â¤
and
Â£ a+b
2 , b
Â¤
each of which has length (b âˆ’a) /2. At least one of these intervals contains xn for
inï¬nitely many values of n. Call this interval I1. Now do for I1 what was done for I0.
Split it in half and let I2 be the interval which contains xn for inï¬nitely many values
of n. Continue this way obtaining a sequence of nested intervals I0 âŠ‡I1 âŠ‡I2 âŠ‡I3Â·Â·Â·
where the length of In is (b âˆ’a) /2n. Now pick n1 such that xn1 âˆˆI1, n2 such that
n2 > n1 and xn2 âˆˆI2, n3 such that n3 > n2 and xn3 âˆˆI3, etc. (This can be done
because in each case the intervals contained xn for inï¬nitely many values of n.) By
25

26
CONTINUOUS FUNCTIONS OF ONE VARIABLE
the nested interval lemma there exists a point, c contained in all these intervals.
Furthermore,
|xnk âˆ’c| < (b âˆ’a) 2âˆ’k
and so limkâ†’âˆžxnk = c âˆˆ[a, b] . This proves the theorem.
Theorem 2.4 Let f : K â†’R be continuous where K is a sequentially compact set
in R. Then f is uniformly continuous on K.
Proof: If this is not true, there exists Îµ > 0 such that for every Î´ > 0 there exists
a pair of points, xÎ´ and yÎ´ such that even though |xÎ´ âˆ’yÎ´| < Î´, |f (xÎ´) âˆ’f (yÎ´)| â‰¥Îµ.
Taking a succession of values for Î´ equal to 1, 1/2, 1/3, Â·Â·Â·, and letting the exceptional
pair of points for Î´ = 1/n be denoted by xn and yn,
|xn âˆ’yn| < 1
n, |f (xn) âˆ’f (yn)| â‰¥Îµ.
Now since K is sequentially compact, there exists a subsequence, {xnk} such that
xnk â†’z âˆˆK. Now nk â‰¥k and so
|xnk âˆ’ynk| < 1
k .
Consequently, ynk â†’z also. ( xnk is like a person walking toward a certain point
and ynk is like a dog on a leash which is constantly getting shorter. Obviously ynk
must also move toward the point also. You should give a precise proof of what is
needed here.) By continuity of f
0 = |f (z) âˆ’f (z)| = lim
kâ†’âˆž|f (xnk) âˆ’f (ynk)| â‰¥Îµ,
an obvious contradiction. Therefore, the theorem must be true.
The following corollary follows from this theorem and Theorem 2.3.
Corollary 2.5 Suppose I is a closed interval, I = [a, b] and f : I â†’R is continu-
ous. Then f is uniformly continuous.
2.1
Exercises
1. A function, f : D âŠ†R â†’R is Lipschitz continuous or just Lipschitz for short
if there exists a constant, K such that
|f (x) âˆ’f (y)| â‰¤K |x âˆ’y|
for all x, y âˆˆD. Show every Lipschitz function is uniformly continuous.
2. If |xn âˆ’yn| â†’0 and xn â†’z, show that yn â†’z also.
3. Consider f : (1, âˆž) â†’R given by f (x) = 1
x. Show f is uniformly continuous
even though the set on which f is deï¬ned is not sequentially compact.

2.2.
THEOREMS ABOUT CONTINUOUS FUNCTIONS
27
4. If f is uniformly continuous, does it follow that |f| is also uniformly continu-
ous? If |f| is uniformly continuous does it follow that f is uniformly continu-
ous? Answer the same questions with â€œuniformly continuousâ€ replaced with
â€œcontinuousâ€. Explain why.
2.2
Theorems About Continuous Functions
In this section, proofs of some theorems which have not been proved yet are given.
Theorem 2.6 The following assertions are valid
1. The function, af + bg is continuous at x when f, g are continuous at x
âˆˆD (f) âˆ©D (g) and a, b âˆˆR.
2. If and f and g are each real valued functions continuous at x, then
fg is
continuous at x. If, in addition to this, g (x) Ì¸= 0, then f/g is continuous at
x.
3. If f is continuous at x, f (x) âˆˆD (g) âŠ†R, and g is continuous at f (x) ,then
g â—¦f is continuous at x.
4. The function f : R â†’R, given by f (x) = |x| is continuous.
Proof:
First consider 1.)
Let Îµ > 0 be given.
By assumption, there exist
Î´1 > 0 such that whenever |x âˆ’y| < Î´1, it follows |f (x) âˆ’f (y)| <
Îµ
2(|a|+|b|+1) and
there exists Î´2 > 0 such that whenever |x âˆ’y| < Î´2, it follows that |g (x) âˆ’g (y)| <
Îµ
2(|a|+|b|+1). Then let 0 < Î´ â‰¤min (Î´1, Î´2) . If |x âˆ’y| < Î´, then everything happens
at once. Therefore, using the triangle inequality
|af (x) + bf (x) âˆ’(ag (y) + bg (y))|
â‰¤|a| |f (x) âˆ’f (y)| + |b| |g (x) âˆ’g (y)|
< |a|
Âµ
Îµ
2 (|a| + |b| + 1)
Â¶
+ |b|
Âµ
Îµ
2 (|a| + |b| + 1)
Â¶
< Îµ.
Now consider 2.) There exists Î´1 > 0 such that if |y âˆ’x| < Î´1, then
|f (x) âˆ’f (y)| < 1.
Therefore, for such y,
|f (y)| < 1 + |f (x)| .
It follows that for such y,
|fg (x) âˆ’fg (y)| â‰¤|f (x) g (x) âˆ’g (x) f (y)| + |g (x) f (y) âˆ’f (y) g (y)|

28
CONTINUOUS FUNCTIONS OF ONE VARIABLE
â‰¤|g (x)| |f (x) âˆ’f (y)| + |f (y)| |g (x) âˆ’g (y)|
â‰¤(1 + |g (x)| + |f (y)|) [|g (x) âˆ’g (y)| + |f (x) âˆ’f (y)|] .
Now let Îµ > 0 be given. There exists Î´2 such that if |x âˆ’y| < Î´2, then
|g (x) âˆ’g (y)| <
Îµ
2 (1 + |g (x)| + |f (y)|),
and there exists Î´3 such that if |xâˆ’y| < Î´3, then
|f (x) âˆ’f (y)| <
Îµ
2 (1 + |g (x)| + |f (y)|)
Now let 0 < Î´ â‰¤min (Î´1, Î´2, Î´3) . Then if |xâˆ’y| < Î´, all the above hold at once and
so
|fg (x) âˆ’fg (y)| â‰¤
(1 + |g (x)| + |f (y)|) [|g (x) âˆ’g (y)| + |f (x) âˆ’f (y)|]
< (1 + |g (x)| + |f (y)|)
Âµ
Îµ
2 (1 + |g (x)| + |f (y)|) +
Îµ
2 (1 + |g (x)| + |f (y)|)
Â¶
= Îµ.
This proves the ï¬rst part of 2.) To obtain the second part, let Î´1 be as described
above and let Î´0 > 0 be such that for |xâˆ’y| < Î´0,
|g (x) âˆ’g (y)| < |g (x)| /2
and so by the triangle inequality,
âˆ’|g (x)| /2 â‰¤|g (y)| âˆ’|g (x)| â‰¤|g (x)| /2
which implies |g (y)| â‰¥|g (x)| /2, and |g (y)| < 3 |g (x)| /2.
Then if |xâˆ’y| < min (Î´0, Î´1) ,
Â¯Â¯Â¯Â¯
f (x)
g (x) âˆ’f (y)
g (y)
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
f (x) g (y) âˆ’f (y) g (x)
g (x) g (y)
Â¯Â¯Â¯Â¯
â‰¤|f (x) g (y) âˆ’f (y) g (x)|
Â³
|g(x)|2
2
Â´
= 2 |f (x) g (y) âˆ’f (y) g (x)|
|g (x)|2
â‰¤
2
|g (x)|2 [|f (x) g (y) âˆ’f (y) g (y) + f (y) g (y) âˆ’f (y) g (x)|]
â‰¤
2
|g (x)|2 [|g (y)| |f (x) âˆ’f (y)| + |f (y)| |g (y) âˆ’g (x)|]
â‰¤
2
|g (x)|2
Â·3
2 |g (x)| |f (x) âˆ’f (y)| + (1 + |f (x)|) |g (y) âˆ’g (x)|
Â¸
â‰¤
2
|g (x)|2 (1 + 2 |f (x)| + 2 |g (x)|) [|f (x) âˆ’f (y)| + |g (y) âˆ’g (x)|]
â‰¡M [|f (x) âˆ’f (y)| + |g (y) âˆ’g (x)|]

2.2.
THEOREMS ABOUT CONTINUOUS FUNCTIONS
29
where M is deï¬ned by
M â‰¡
2
|g (x)|2 (1 + 2 |f (x)| + 2 |g (x)|)
Now let Î´2 be such that if |xâˆ’y| < Î´2, then
|f (x) âˆ’f (y)| < Îµ
2M âˆ’1
and let Î´3 be such that if |xâˆ’y| < Î´3, then
|g (y) âˆ’g (x)| < Îµ
2M âˆ’1.
Then if 0 < Î´ â‰¤min (Î´0, Î´1, Î´2, Î´3) , and |xâˆ’y| < Î´, everything holds and
Â¯Â¯Â¯Â¯
f (x)
g (x) âˆ’f (y)
g (y)
Â¯Â¯Â¯Â¯ â‰¤M [|f (x) âˆ’f (y)| + |g (y) âˆ’g (x)|]
< M
hÎµ
2M âˆ’1 + Îµ
2M âˆ’1i
= Îµ.
This completes the proof of the second part of 2.)
Note that in these proofs no eï¬€ort is made to ï¬nd some sort of â€œbestâ€ Î´. The
problem is one which has a yes or a no answer. Either is it or it is not continuous.
Now consider 3.). If f is continuous at x, f (x) âˆˆD (g) âŠ†Rp, and g is continuous
at f (x) ,then g â—¦f is continuous at x. Let Îµ > 0 be given. Then there exists Î· > 0
such that if |yâˆ’f (x)| < Î· and y âˆˆD (g) , it follows that |g (y) âˆ’g (f (x))| < Îµ. From
continuity of f at x, there exists Î´ > 0 such that if |xâˆ’z| < Î´ and z âˆˆD (f) , then
|f (z) âˆ’f (x)| < Î·. Then if |xâˆ’z| < Î´ and z âˆˆD (g â—¦f) âŠ†D (f) , all the above hold
and so
|g (f (z)) âˆ’g (f (x))| < Îµ.
This proves part 3.)
To verify part 4.), let Îµ > 0 be given and let Î´ = Îµ. Then if |xâˆ’y| < Î´, the
triangle inequality implies
|f (x) âˆ’f (y)| = ||x| âˆ’|y||
â‰¤|xâˆ’y| < Î´ = Îµ.
This proves part 4.) and completes the proof of the theorem.
Next here is a proof of the intermediate value theorem.
Theorem 2.7 Suppose f : [a, b] â†’R is continuous and suppose f (a) < c < f (b) .
Then there exists x âˆˆ(a, b) such that f (x) = c.
Proof: Let d =
a+b
2
and consider the intervals [a, d] and [d, b] . If f (d) â‰¥c,
then on [a, d] , the function is â‰¤c at one end point and â‰¥c at the other. On the
other hand, if f (d) â‰¤c, then on [d, b] f â‰¥0 at one end point and â‰¤0 at the

30
CONTINUOUS FUNCTIONS OF ONE VARIABLE
other. Pick the interval on which f has values which are at least as large as c and
values no larger than c. Now consider that interval, divide it in half as was done for
the original interval and argue that on one of these smaller intervals, the function
has values at least as large as c and values no larger than c. Continue in this way.
Next apply the nested interval lemma to get x in all these intervals. In the nth
interval, let xn, yn be elements of this interval such that f (xn) â‰¤c, f (yn) â‰¥c.
Now |xn âˆ’x| â‰¤(b âˆ’a) 2âˆ’n and |yn âˆ’x| â‰¤(b âˆ’a) 2âˆ’n and so xn â†’x and yn â†’x.
Therefore,
f (x) âˆ’c = lim
nâ†’âˆž(f (xn) âˆ’c) â‰¤0
while
f (x) âˆ’c = lim
nâ†’âˆž(f (yn) âˆ’c) â‰¥0.
Consequently f (x) = c and this proves the theorem.
Lemma 2.8 Let Ï† : [a, b] â†’R be a continuous function and suppose Ï† is 1 âˆ’1 on
(a, b). Then Ï† is either strictly increasing or strictly decreasing on [a, b] .
Proof: First it is shown that Ï† is either strictly increasing or strictly decreasing
on (a, b) .
If Ï† is not strictly decreasing on (a, b), then there exists x1 < y1, x1, y1 âˆˆ(a, b)
such that
(Ï† (y1) âˆ’Ï† (x1)) (y1 âˆ’x1) > 0.
If for some other pair of points, x2 < y2 with x2, y2 âˆˆ(a, b) , the above inequality
does not hold, then since Ï† is 1 âˆ’1,
(Ï† (y2) âˆ’Ï† (x2)) (y2 âˆ’x2) < 0.
Let xt â‰¡tx1 + (1 âˆ’t) x2 and yt â‰¡ty1 + (1 âˆ’t) y2. Then xt < yt for all t âˆˆ[0, 1]
because
tx1 â‰¤ty1 and (1 âˆ’t) x2 â‰¤(1 âˆ’t) y2
with strict inequality holding for at least one of these inequalities since not both t
and (1 âˆ’t) can equal zero. Now deï¬ne
h (t) â‰¡(Ï† (yt) âˆ’Ï† (xt)) (yt âˆ’xt) .
Since h is continuous and h (0) < 0, while h (1) > 0, there exists t âˆˆ(0, 1) such
that h (t) = 0. Therefore, both xt and yt are points of (a, b) and Ï† (yt) âˆ’Ï† (xt) = 0
contradicting the assumption that Ï† is one to one. It follows Ï† is either strictly
increasing or strictly decreasing on (a, b) .
This property of being either strictly increasing or strictly decreasing on (a, b)
carries over to [a, b] by the continuity of Ï†. Suppose Ï† is strictly increasing on (a, b) ,
a similar argument holding for Ï† strictly decreasing on (a, b) . If x > a, then pick
y âˆˆ(a, x) and from the above, Ï† (y) < Ï† (x) . Now by continuity of Ï† at a,
Ï† (a) = lim
xâ†’a+ Ï† (z) â‰¤Ï† (y) < Ï† (x) .
Therefore, Ï† (a) < Ï† (x) whenever x âˆˆ(a, b) . Similarly Ï† (b) > Ï† (x) for all x âˆˆ(a, b).
This proves the lemma.

2.2.
THEOREMS ABOUT CONTINUOUS FUNCTIONS
31
Corollary 2.9 Let f : (a, b) â†’R be one to one and continuous. Then f (a, b) is
an open interval, (c, d) and f âˆ’1 : (c, d) â†’(a, b) is continuous.
Proof: Since f is either strictly increasing or strictly decreasing, it follows that
f (a, b) is an open interval, (c, d) . Assume f is decreasing.
Now let x âˆˆ(a, b).
Why is f âˆ’1 is continuous at f (x)? Since f is decreasing, if f (x) < f (y) , then
y â‰¡f âˆ’1 (f (y)) < x â‰¡f âˆ’1 (f (x)) and so f âˆ’1 is also decreasing. Let Îµ > 0 be given.
Let Îµ > Î· > 0 and (x âˆ’Î·, x + Î·) âŠ†(a, b) . Then f (x) âˆˆ(f (x + Î·) , f (x âˆ’Î·)) . Let
Î´ = min (f (x) âˆ’f (x + Î·) , f (x âˆ’Î·) âˆ’f (x)) . Then if
|f (z) âˆ’f (x)| < Î´,
it follows
z â‰¡f âˆ’1 (f (z)) âˆˆ(x âˆ’Î·, x + Î·) âŠ†(x âˆ’Îµ, x + Îµ)
so
Â¯Â¯f âˆ’1 (f (z)) âˆ’x
Â¯Â¯ =
Â¯Â¯f âˆ’1 (f (z)) âˆ’f âˆ’1 (f (x))
Â¯Â¯ < Îµ.
This proves the theorem in the case where f is strictly decreasing. The case where
f is increasing is similar.

32
CONTINUOUS FUNCTIONS OF ONE VARIABLE

The Riemann Stieltjes
Integral
The integral originated in attempts to ï¬nd areas of various shapes and the ideas
involved in ï¬nding integrals are much older than the ideas related to ï¬nding deriva-
tives. In fact, Archimedes1 was ï¬nding areas of various curved shapes about 250
B.C. using the main ideas of the integral. What is presented here is a generaliza-
tion of these ideas. The main interest is in the Riemann integral but if it is easy to
generalize to the so called Stieltjes integral in which the length of an interval, [x, y]
is replaced with an expression of the form F (y) âˆ’F (x) where F is an increasing
function, then the generalization is given. However, there is much more that can
be written about Stieltjes integrals than what is presented here. A good source for
this is the book by Apostol, [3].
3.1
Upper And Lower Riemann Stieltjes Sums
The Riemann integral pertains to bounded functions which are deï¬ned on a bounded
interval. Let [a, b] be a closed interval. A set of points in [a, b], {x0, Â· Â· Â·, xn} is a
partition if
a = x0 < x1 < Â· Â· Â· < xn = b.
Such partitions are denoted by P or Q. For f a bounded function deï¬ned on [a, b] ,
let
Mi (f) â‰¡sup{f (x) : x âˆˆ[xiâˆ’1, xi]},
mi (f) â‰¡inf{f (x) : x âˆˆ[xiâˆ’1, xi]}.
1Archimedes 287-212 B.C. found areas of curved regions by stuï¬ƒng them with simple shapes
which he knew the area of and taking a limit. He also made fundamental contributions to physics.
The story is told about how he determined that a gold smith had cheated the king by giving him
a crown which was not solid gold as had been claimed. He did this by ï¬nding the amount of water
displaced by the crown and comparing with the amount of water it should have displaced if it had
been solid gold.
33

34
THE RIEMANN STIELTJES INTEGRAL
Deï¬nition 3.1 Let F be an increasing function deï¬ned on [a, b] and let âˆ†Fi â‰¡
F (xi) âˆ’F (xiâˆ’1) . Then deï¬ne upper and lower sums as
U (f, P) â‰¡
n
X
i=1
Mi (f) âˆ†Fi and L (f, P) â‰¡
n
X
i=1
mi (f) âˆ†Fi
respectively. The numbers, Mi (f) and mi (f) , are well deï¬ned real numbers because
f is assumed to be bounded and R is complete. Thus the set S = {f (x) : x âˆˆ
[xiâˆ’1, xi]} is bounded above and below.
In the following picture, the sum of the areas of the rectangles in the picture on
the left is a lower sum for the function in the picture and the sum of the areas of the
rectangles in the picture on the right is an upper sum for the same function which
uses the same partition. In these pictures the function, F is given by F (x) = x and
these are the ordinary upper and lower sums from calculus.
y = f(x)
x0
x1
x2
x3
x0
x1
x2
x3
What happens when you add in more points in a partition?
The following
pictures illustrate in the context of the above example. In this example a single
additional point, labeled z has been added in.
y = f(x)
x0
x1
x2
x3
z
x0
x1
x2
x3
z
Note how the lower sum got larger by the amount of the area in the shaded
rectangle and the upper sum got smaller by the amount in the rectangle shaded by
dots. In general this is the way it works and this is shown in the following lemma.
Lemma 3.2 If P âŠ†Q then
U (f, Q) â‰¤U (f, P) , and L (f, P) â‰¤L (f, Q) .

3.1.
UPPER AND LOWER RIEMANN STIELTJES SUMS
35
Proof: This is veriï¬ed by adding in one point at a time. Thus let
P = {x0, Â· Â· Â·, xn}
and let
Q = {x0, Â· Â· Â·, xk, y, xk+1, Â· Â· Â·, xn}.
Thus exactly one point, y, is added between xk and xk+1. Now the term in the
upper sum which corresponds to the interval [xk, xk+1] in U (f, P) is
sup {f (x) : x âˆˆ[xk, xk+1]} (F (xk+1) âˆ’F (xk))
(3.1)
and the term which corresponds to the interval [xk, xk+1] in U (f, Q) is
sup {f (x) : x âˆˆ[xk, y]} (F (y) âˆ’F (xk))
+ sup {f (x) : x âˆˆ[y, xk+1]} (F (xk+1) âˆ’F (y))
â‰¡M1 (F (y) âˆ’F (xk)) + M2 (F (xk+1) âˆ’F (y))
(3.2)
All the other terms in the two sums coincide. Now sup {f (x) : x âˆˆ[xk, xk+1]} â‰¥
max (M1, M2) and so the expression in 3.2 is no larger than
sup {f (x) : x âˆˆ[xk, xk+1]} (F (xk+1) âˆ’F (y))
+ sup {f (x) : x âˆˆ[xk, xk+1]} (F (y) âˆ’F (xk))
= sup {f (x) : x âˆˆ[xk, xk+1]} (F (xk+1) âˆ’F (xk)) ,
the term corresponding to the interval, [xk, xk+1] and U (f, P) . This proves the
ï¬rst part of the lemma pertaining to upper sums because if Q âŠ‡P, one can obtain
Q from P by adding in one point at a time and each time a point is added, the
corresponding upper sum either gets smaller or stays the same. The second part
about lower sums is similar and is left as an exercise.
Lemma 3.3 If P and Q are two partitions, then
L (f, P) â‰¤U (f, Q) .
Proof: By Lemma 3.2,
L (f, P) â‰¤L (f, P âˆªQ) â‰¤U (f, P âˆªQ) â‰¤U (f, Q) .
Deï¬nition 3.4
I â‰¡inf{U (f, Q) where Q is a partition}
I â‰¡sup{L (f, P) where P is a partition}.
Note that I and I are well deï¬ned real numbers.

36
THE RIEMANN STIELTJES INTEGRAL
Theorem 3.5 I â‰¤I.
Proof: From Lemma 3.3,
I = sup{L (f, P) where P is a partition} â‰¤U (f, Q)
because U (f, Q) is an upper bound to the set of all lower sums and so it is no
smaller than the least upper bound. Therefore, since Q is arbitrary,
I = sup{L (f, P) where P is a partition}
â‰¤inf{U (f, Q) where Q is a partition} â‰¡I
where the inequality holds because it was just shown that I is a lower bound to the
set of all upper sums and so it is no larger than the greatest lower bound of this
set. This proves the theorem.
Deï¬nition 3.6 A bounded function f is Riemann Stieltjes integrable, written as
f âˆˆR ([a, b])
if
I = I
and in this case,
Z b
a
f (x) dF â‰¡I = I.
When F (x) = x, the integral is called the Riemann integral and is written as
Z b
a
f (x) dx.
Thus, in words, the Riemann integral is the unique number which lies between
all upper sums and all lower sums if there is such a unique number.
Recall the following Proposition which comes from the deï¬nitions.
Proposition 3.7 Let S be a nonempty set and suppose sup (S) exists. Then for
every Î´ > 0,
S âˆ©(sup (S) âˆ’Î´, sup (S)] Ì¸= âˆ….
If inf (S) exists, then for every Î´ > 0,
S âˆ©[inf (S) , inf (S) + Î´) Ì¸= âˆ….
This proposition implies the following theorem which is used to determine the
question of Riemann Stieltjes integrability.
Theorem 3.8 A bounded function f is Riemann integrable if and only if for all
Îµ > 0, there exists a partition P such that
U (f, P) âˆ’L (f, P)
< Îµ.
(3.3)

3.2.
EXERCISES
37
Proof: First assume f is Riemann integrable. Then let P and Q be two parti-
tions such that
U (f, Q) < I + Îµ/2, L (f, P) > I âˆ’Îµ/2.
Then since I = I,
U (f, Q âˆªP) âˆ’L (f, P âˆªQ) â‰¤U (f, Q) âˆ’L (f, P) < I + Îµ/2 âˆ’(I âˆ’Îµ/2) = Îµ.
Now suppose that for all Îµ > 0 there exists a partition such that 3.3 holds. Then
for given Îµ and partition P corresponding to Îµ
I âˆ’I â‰¤U (f, P) âˆ’L (f, P) â‰¤Îµ.
Since Îµ is arbitrary, this shows I = I and this proves the theorem.
The condition described in the theorem is called the Riemann criterion .
Not all bounded functions are Riemann integrable. For example, let F (x) = x
and
f (x) â‰¡
Â½ 1 if x âˆˆQ
0 if x âˆˆR \ Q
(3.4)
Then if [a, b] = [0, 1] all upper sums for f equal 1 while all lower sums for f equal
0. Therefore the Riemann criterion is violated for Îµ = 1/2.
3.2
Exercises
1. Prove the second half of Lemma 3.2 about lower sums.
2. Verify that for f given in 3.4, the lower sums on the interval [0, 1] are all equal
to zero while the upper sums are all equal to one.
3. Let f (x) = 1 + x2 for x âˆˆ[âˆ’1, 3] and let P =
Â©
âˆ’1, âˆ’1
3, 0, 1
2, 1, 2
Âª
. Find
U (f, P) and L (f, P) for F (x) = x and for F (x) = x3.
4. Show that if f âˆˆR ([a, b]) for F (x) = x, there exists a partition, {x0, Â· Â· Â·, xn}
such that for any zk âˆˆ[xk, xk+1] ,
Â¯Â¯Â¯Â¯Â¯
Z b
a
f (x) dx âˆ’
n
X
k=1
f (zk) (xk âˆ’xkâˆ’1)
Â¯Â¯Â¯Â¯Â¯ < Îµ
This sum, Pn
k=1 f (zk) (xk âˆ’xkâˆ’1) , is called a Riemann sum and this exercise
shows that the Riemann integral can always be approximated by a Riemann
sum. For the general Riemann Stieltjes case, does anything change?
5. Let P =
Â©
1, 1 1
4, 1 1
2, 1 3
4, 2
Âª
and F (x) = x. Find upper and lower sums for the
function, f (x) = 1
x using this partition. What does this tell you about ln (2)?
6. If f âˆˆR ([a, b]) with F (x) = x and f is changed at ï¬nitely many points,
show the new function is also in R ([a, b]) . Is this still true for the general case
where F is only assumed to be an increasing function? Explain.

38
THE RIEMANN STIELTJES INTEGRAL
7. In the case where F (x) = x, deï¬ne a â€œleft sumâ€ as
n
X
k=1
f (xkâˆ’1) (xk âˆ’xkâˆ’1)
and a â€œright sumâ€,
n
X
k=1
f (xk) (xk âˆ’xkâˆ’1) .
Also suppose that all partitions have the property that xk âˆ’xkâˆ’1 equals a
constant, (b âˆ’a) /n so the points in the partition are equally spaced, and
deï¬ne the integral to be the number these right and left sums get close to as
n gets larger and larger. Show that for f given in 3.4,
R x
0 f (t) dt = 1 if x is
rational and
R x
0 f (t) dt = 0 if x is irrational. It turns out that the correct
answer should always equal zero for that function, regardless of whether x is
rational. This is shown when the Lebesgue integral is studied. This illustrates
why this method of deï¬ning the integral in terms of left and right sums is total
nonsense. Show that even though this is the case, it makes no diï¬€erence if f
is continuous.
3.3
Functions Of Riemann Integrable Functions
It is often necessary to consider functions of Riemann integrable functions and a
natural question is whether these are Riemann integrable. The following theorem
gives a partial answer to this question. This is not the most general theorem which
will relate to this question but it will be enough for the needs of this book.
Theorem 3.9 Let f, g be bounded functions and let
f ([a, b]) âŠ†[c1, d1] , g ([a, b]) âŠ†[c2, d2] .
Let H : [c1, d1] Ã— [c2, d2] â†’R satisfy,
|H (a1, b1) âˆ’H (a2, b2)| â‰¤K [|a1 âˆ’a2| + |b1 âˆ’b2|]
for some constant K. Then if f, g âˆˆR ([a, b]) it follows that H â—¦(f, g) âˆˆR ([a, b]) .
Proof: In the following claim, Mi (h) and mi (h) have the meanings assigned
above with respect to some partition of [a, b] for the function, h.
Claim: The following inequality holds.
|Mi (H â—¦(f, g)) âˆ’mi (H â—¦(f, g))| â‰¤
K [|Mi (f) âˆ’mi (f)| + |Mi (g) âˆ’mi (g)|] .
Proof of the claim: By the above proposition, there exist x1, x2 âˆˆ[xiâˆ’1, xi]
be such that
H (f (x1) , g (x1)) + Î· > Mi (H â—¦(f, g)) ,

3.3.
FUNCTIONS OF RIEMANN INTEGRABLE FUNCTIONS
39
and
H (f (x2) , g (x2)) âˆ’Î· < mi (H â—¦(f, g)) .
Then
|Mi (H â—¦(f, g)) âˆ’mi (H â—¦(f, g))|
< 2Î· + |H (f (x1) , g (x1)) âˆ’H (f (x2) , g (x2))|
< 2Î· + K [|f (x1) âˆ’f (x2)| + |g (x1) âˆ’g (x2)|]
â‰¤2Î· + K [|Mi (f) âˆ’mi (f)| + |Mi (g) âˆ’mi (g)|] .
Since Î· > 0 is arbitrary, this proves the claim.
Now continuing with the proof of the theorem, let P be such that
n
X
i=1
(Mi (f) âˆ’mi (f)) âˆ†Fi <
Îµ
2K ,
n
X
i=1
(Mi (g) âˆ’mi (g)) âˆ†Fi <
Îµ
2K .
Then from the claim,
n
X
i=1
(Mi (H â—¦(f, g)) âˆ’mi (H â—¦(f, g))) âˆ†Fi
<
n
X
i=1
K [|Mi (f) âˆ’mi (f)| + |Mi (g) âˆ’mi (g)|] âˆ†Fi < Îµ.
Since Îµ > 0 is arbitrary, this shows H â—¦(f, g) satisï¬es the Riemann criterion and
hence H â—¦(f, g) is Riemann integrable as claimed. This proves the theorem.
This theorem implies that if f, g are Riemann Stieltjes integrable, then so is
af + bg, |f| , f 2, along with inï¬nitely many other such continuous combinations of
Riemann Stieltjes integrable functions. For example, to see that |f| is Riemann
integrable, let H (a, b) = |a| . Clearly this function satisï¬es the conditions of the
above theorem and so |f| = H (f, f) âˆˆR ([a, b]) as claimed. The following theorem
gives an example of many functions which are Riemann integrable.
Theorem 3.10 Let f : [a, b] â†’R be either increasing or decreasing on [a, b] and
suppose F is continuous. Then f âˆˆR ([a, b]) .
Proof: Let Îµ > 0 be given and let
xi = a + i
Âµb âˆ’a
n
Â¶
, i = 0, Â· Â· Â·, n.
Since F is continuous, it follows from Corollary 2.5 on Page 26 that it is uniformly
continuous. Therefore, if n is large enough, then for all i,
F (xi) âˆ’F (xiâˆ’1) <
Îµ
f (b) âˆ’f (a) + 1

40
THE RIEMANN STIELTJES INTEGRAL
Then since f is increasing,
U (f, P) âˆ’L (f, P) =
n
X
i=1
(f (xi) âˆ’f (xiâˆ’1)) (F (xi) âˆ’F (xiâˆ’1))
â‰¤
Îµ
f (b) âˆ’f (a) + 1
n
X
i=1
(f (xi) âˆ’f (xiâˆ’1))
=
Îµ
f (b) âˆ’f (a) + 1 (f (b) âˆ’f (a)) < Îµ.
Thus the Riemann criterion is satisï¬ed and so the function is Riemann Stieltjes
integrable. The proof for decreasing f is similar.
Corollary 3.11 Let [a, b] be a bounded closed interval and let Ï† : [a, b] â†’R be
Lipschitz continuous and suppose F is continuous. Then Ï† âˆˆR ([a, b]) . Recall that
a function, Ï†, is Lipschitz continuous if there is a constant, K, such that for all
x, y,
|Ï† (x) âˆ’Ï† (y)| < K |x âˆ’y| .
Proof: Let f (x) = x. Then by Theorem 3.10, f is Riemann Stieltjes integrable.
Let H (a, b) â‰¡Ï† (a). Then by Theorem 3.9 H â—¦(f, f) = Ï† â—¦f = Ï† is also Riemann
Stieltjes integrable. This proves the corollary.
In fact, it is enough to assume Ï† is continuous, although this is harder. This
is the content of the next theorem which is where the diï¬ƒcult theorems about
continuity and uniform continuity are used. This is the main result on the existence
of the Riemann Stieltjes integral for this book.
Theorem 3.12 Suppose f : [a, b] â†’R is continuous and F is just an increasing
function deï¬ned on [a, b]. Then f âˆˆR ([a, b]) .
Proof: By Corollary 2.5 on Page 26, f is uniformly continuous on [a, b] . There-
fore, if Îµ > 0 is given, there exists a Î´ > 0 such that if |xi âˆ’xiâˆ’1| < Î´, then
Mi âˆ’mi <
Îµ
F (b)âˆ’F (a)+1. Let
P â‰¡{x0, Â· Â· Â·, xn}
be a partition with |xi âˆ’xiâˆ’1| < Î´. Then
U (f, P) âˆ’L (f, P)
<
n
X
i=1
(Mi âˆ’mi) (F (xi) âˆ’F (xiâˆ’1))
<
Îµ
F (b) âˆ’F (a) + 1 (F (b) âˆ’F (a)) < Îµ.
By the Riemann criterion, f âˆˆR ([a, b]) . This proves the theorem.

3.4.
PROPERTIES OF THE INTEGRAL
41
3.4
Properties Of The Integral
The integral has many important algebraic properties. First here is a simple lemma.
Lemma 3.13 Let S be a nonempty set which is bounded above and below. Then if
âˆ’S â‰¡{âˆ’x : x âˆˆS} ,
sup (âˆ’S) = âˆ’inf (S)
(3.5)
and
inf (âˆ’S) = âˆ’sup (S) .
(3.6)
Proof: Consider 3.5. Let x âˆˆS. Then âˆ’x â‰¤sup (âˆ’S) and so x â‰¥âˆ’sup (âˆ’S) . If
follows that âˆ’sup (âˆ’S) is a lower bound for S and therefore, âˆ’sup (âˆ’S) â‰¤inf (S) .
This implies sup (âˆ’S) â‰¥âˆ’inf (S) . Now let âˆ’x âˆˆâˆ’S. Then x âˆˆS and so x â‰¥inf (S)
which implies âˆ’x â‰¤âˆ’inf (S) . Therefore, âˆ’inf (S) is an upper bound for âˆ’S and
so âˆ’inf (S) â‰¥sup (âˆ’S) . This shows 3.5. Formula 3.6 is similar and is left as an
exercise.
In particular, the above lemma implies that for Mi (f) and mi (f) deï¬ned above
Mi (âˆ’f) = âˆ’mi (f) , and mi (âˆ’f) = âˆ’Mi (f) .
Lemma 3.14 If f âˆˆR ([a, b]) then âˆ’f âˆˆR ([a, b]) and
âˆ’
Z b
a
f (x) dF =
Z b
a
âˆ’f (x) dF.
Proof: The ï¬rst part of the conclusion of this lemma follows from Theorem 3.10
since the function Ï† (y) â‰¡âˆ’y is Lipschitz continuous. Now choose P such that
Z b
a
âˆ’f (x) dF âˆ’L (âˆ’f, P) < Îµ.
Then since mi (âˆ’f) = âˆ’Mi (f) ,
Îµ >
Z b
a
âˆ’f (x) dF âˆ’
n
X
i=1
mi (âˆ’f) âˆ†Fi =
Z b
a
âˆ’f (x) dF +
n
X
i=1
Mi (f) âˆ†Fi
which implies
Îµ >
Z b
a
âˆ’f (x) dF +
n
X
i=1
Mi (f) âˆ†Fi â‰¥
Z b
a
âˆ’f (x) dF +
Z b
a
f (x) dF.
Thus, since Îµ is arbitrary,
Z b
a
âˆ’f (x) dF â‰¤âˆ’
Z b
a
f (x) dF
whenever f âˆˆR ([a, b]) . It follows
Z b
a
âˆ’f (x) dF â‰¤âˆ’
Z b
a
f (x) dF = âˆ’
Z b
a
âˆ’(âˆ’f (x)) dF â‰¤
Z b
a
âˆ’f (x) dF
and this proves the lemma.

42
THE RIEMANN STIELTJES INTEGRAL
Theorem 3.15 The integral is linear,
Z b
a
(Î±f + Î²g) (x) dF = Î±
Z b
a
f (x) dF + Î²
Z b
a
g (x) dF.
whenever f, g âˆˆR ([a, b]) and Î±, Î² âˆˆR.
Proof: First note that by Theorem 3.9, Î±f + Î²g âˆˆR ([a, b]) . To begin with,
consider the claim that if f, g âˆˆR ([a, b]) then
Z b
a
(f + g) (x) dF =
Z b
a
f (x) dF +
Z b
a
g (x) dF.
(3.7)
Let P1,Q1 be such that
U (f, Q1) âˆ’L (f, Q1) < Îµ/2, U (g, P1) âˆ’L (g, P1) < Îµ/2.
Then letting P â‰¡P1 âˆªQ1, Lemma 3.2 implies
U (f, P) âˆ’L (f, P) < Îµ/2, and U (g, P) âˆ’U (g, P) < Îµ/2.
Next note that
mi (f + g) â‰¥mi (f) + mi (g) , Mi (f + g) â‰¤Mi (f) + Mi (g) .
Therefore,
L (g + f, P) â‰¥L (f, P) + L (g, P) , U (g + f, P) â‰¤U (f, P) + U (g, P) .
For this partition,
Z b
a
(f + g) (x) dF âˆˆ[L (f + g, P) , U (f + g, P)]
âŠ†[L (f, P) + L (g, P) , U (f, P) + U (g, P)]
and
Z b
a
f (x) dF +
Z b
a
g (x) dF âˆˆ[L (f, P) + L (g, P) , U (f, P) + U (g, P)] .
Therefore,
Â¯Â¯Â¯Â¯Â¯
Z b
a
(f + g) (x) dF âˆ’
ÃƒZ b
a
f (x) dF +
Z b
a
g (x) dF
!Â¯Â¯Â¯Â¯Â¯ â‰¤
U (f, P) + U (g, P) âˆ’(L (f, P) + L (g, P)) < Îµ/2 + Îµ/2 = Îµ.
This proves 3.7 since Îµ is arbitrary.

3.4.
PROPERTIES OF THE INTEGRAL
43
It remains to show that
Î±
Z b
a
f (x) dF =
Z b
a
Î±f (x) dF.
Suppose ï¬rst that Î± â‰¥0. Then
Z b
a
Î±f (x) dF â‰¡sup{L (Î±f, P) : P is a partition} =
Î± sup{L (f, P) : P is a partition} â‰¡Î±
Z b
a
f (x) dF.
If Î± < 0, then this and Lemma 3.14 imply
Z b
a
Î±f (x) dF =
Z b
a
(âˆ’Î±) (âˆ’f (x)) dF
= (âˆ’Î±)
Z b
a
(âˆ’f (x)) dF = Î±
Z b
a
f (x) dF.
This proves the theorem.
In the next theorem, suppose F is deï¬ned on [a, b] âˆª[b, c] .
Theorem 3.16 If f âˆˆR ([a, b]) and f âˆˆR ([b, c]) , then f âˆˆR ([a, c]) and
Z c
a
f (x) dF =
Z b
a
f (x) dF +
Z c
b
f (x) dF.
(3.8)
Proof: Let P1 be a partition of [a, b] and P2 be a partition of [b, c] such that
U (f, Pi) âˆ’L (f, Pi) < Îµ/2, i = 1, 2.
Let P â‰¡P1 âˆªP2. Then P is a partition of [a, c] and
U (f, P) âˆ’L (f, P)
= U (f, P1) âˆ’L (f, P1) + U (f, P2) âˆ’L (f, P2) < Îµ/2 + Îµ/2 = Îµ.
(3.9)
Thus, f âˆˆR ([a, c]) by the Riemann criterion and also for this partition,
Z b
a
f (x) dF +
Z c
b
f (x) dF âˆˆ[L (f, P1) + L (f, P2) , U (f, P1) + U (f, P2)]
= [L (f, P) , U (f, P)]
and
Z c
a
f (x) dF âˆˆ[L (f, P) , U (f, P)] .
Hence by 3.9,
Â¯Â¯Â¯Â¯Â¯
Z c
a
f (x) dF âˆ’
ÃƒZ b
a
f (x) dF +
Z c
b
f (x) dF
!Â¯Â¯Â¯Â¯Â¯ < U (f, P) âˆ’L (f, P) < Îµ
which shows that since Îµ is arbitrary, 3.8 holds. This proves the theorem.

44
THE RIEMANN STIELTJES INTEGRAL
Corollary 3.17 Let F be continuous and let [a, b] be a closed and bounded interval
and suppose that
a = y1 < y2 Â· Â·Â· < yl = b
and that f is a bounded function deï¬ned on [a, b] which has the property that f is
either increasing on [yj, yj+1] or decreasing on [yj, yj+1] for j = 1, Â· Â· Â·, l âˆ’1. Then
f âˆˆR ([a, b]) .
Proof: This follows from Theorem 3.16 and Theorem 3.10.
The symbol,
R b
a f (x) dF
when a > b has not yet been deï¬ned.
Deï¬nition 3.18 Let [a, b] be an interval and let f âˆˆR ([a, b]) . Then
Z a
b
f (x) dF â‰¡âˆ’
Z b
a
f (x) dF.
Note that with this deï¬nition,
Z a
a
f (x) dF = âˆ’
Z a
a
f (x) dF
and so
Z a
a
f (x) dF = 0.
Theorem 3.19 Assuming all the integrals make sense,
Z b
a
f (x) dF +
Z c
b
f (x) dF =
Z c
a
f (x) dF.
Proof: This follows from Theorem 3.16 and Deï¬nition 3.18. For example, as-
sume
c âˆˆ(a, b) .
Then from Theorem 3.16,
Z c
a
f (x) dF +
Z b
c
f (x) dF =
Z b
a
f (x) dF
and so by Deï¬nition 3.18,
Z c
a
f (x) dF =
Z b
a
f (x) dF âˆ’
Z b
c
f (x) dF
=
Z b
a
f (x) dF +
Z c
b
f (x) dF.
The other cases are similar.

3.5.
FUNDAMENTAL THEOREM OF CALCULUS
45
The following properties of the integral have either been established or they
follow quickly from what has been shown so far.
If f âˆˆR ([a, b]) then if c âˆˆ[a, b] , f âˆˆR ([a, c]) ,
(3.10)
Z b
a
Î± dF = Î± (F (b) âˆ’F (a)) ,
(3.11)
Z b
a
(Î±f + Î²g) (x) dF = Î±
Z b
a
f (x) dF + Î²
Z b
a
g (x) dF,
(3.12)
Z b
a
f (x) dF +
Z c
b
f (x) dF =
Z c
a
f (x) dF,
(3.13)
Z b
a
f (x) dF â‰¥0 if f (x) â‰¥0 and a < b,
(3.14)
Â¯Â¯Â¯Â¯Â¯
Z b
a
f (x) dF
Â¯Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯Â¯
Z b
a
|f (x)| dF
Â¯Â¯Â¯Â¯Â¯ .
(3.15)
The only one of these claims which may not be completely obvious is the last one.
To show this one, note that
|f (x)| âˆ’f (x) â‰¥0, |f (x)| + f (x) â‰¥0.
Therefore, by 3.14 and 3.12, if a < b,
Z b
a
|f (x)| dF â‰¥
Z b
a
f (x) dF
and
Z b
a
|f (x)| dF â‰¥âˆ’
Z b
a
f (x) dF.
Therefore,
Z b
a
|f (x)| dF â‰¥
Â¯Â¯Â¯Â¯Â¯
Z b
a
f (x) dF
Â¯Â¯Â¯Â¯Â¯ .
If b < a then the above inequality holds with a and b switched. This implies 3.15.
3.5
Fundamental Theorem Of Calculus
In this section F (x) = x so things are specialized to the ordinary Riemann integral.
With these properties, it is easy to prove the fundamental theorem of calculus2.
2This theorem is why Newton and Liebnitz are credited with inventing calculus. The integral
had been around for thousands of years and the derivative was by their time well known. However
the connection between these two ideas had not been fully made although Newtonâ€™s predecessor,
Isaac Barrow had made some progress in this direction.

46
THE RIEMANN STIELTJES INTEGRAL
Let f âˆˆR ([a, b]) . Then by 3.10 f âˆˆR ([a, x]) for each x âˆˆ[a, b] . The ï¬rst version
of the fundamental theorem of calculus is a statement about the derivative of the
function
x â†’
Z x
a
f (t) dt.
Theorem 3.20 Let f âˆˆR ([a, b]) and let
F (x) â‰¡
Z x
a
f (t) dt.
Then if f is continuous at x âˆˆ(a, b) ,
F â€² (x) = f (x) .
Proof: Let x âˆˆ(a, b) be a point of continuity of f and let h be small enough
that x + h âˆˆ[a, b] . Then by using 3.13,
hâˆ’1 (F (x + h) âˆ’F (x)) = hâˆ’1
Z x+h
x
f (t) dt.
Also, using 3.11,
f (x) = hâˆ’1
Z x+h
x
f (x) dt.
Therefore, by 3.15,
Â¯Â¯hâˆ’1 (F (x + h) âˆ’F (x)) âˆ’f (x)
Â¯Â¯ =
Â¯Â¯Â¯Â¯Â¯hâˆ’1
Z x+h
x
(f (t) âˆ’f (x)) dt
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯hâˆ’1
Z x+h
x
|f (t) âˆ’f (x)| dt
Â¯Â¯Â¯Â¯Â¯ .
Let Îµ > 0 and let Î´ > 0 be small enough that if |t âˆ’x| < Î´, then
|f (t) âˆ’f (x)| < Îµ.
Therefore, if |h| < Î´, the above inequality and 3.11 shows that
Â¯Â¯hâˆ’1 (F (x + h) âˆ’F (x)) âˆ’f (x)
Â¯Â¯ â‰¤|h|âˆ’1 Îµ |h| = Îµ.
Since Îµ > 0 is arbitrary, this shows
lim
hâ†’0 hâˆ’1 (F (x + h) âˆ’F (x)) = f (x)
and this proves the theorem.
Note this gives existence for the initial value problem,
F â€² (x) = f (x) , F (a) = 0

3.5.
FUNDAMENTAL THEOREM OF CALCULUS
47
whenever f is Riemann integrable and continuous.3
The next theorem is also called the fundamental theorem of calculus.
Theorem 3.21 Let f âˆˆR ([a, b]) and suppose there exists an antiderivative for
f, G, such that
Gâ€² (x) = f (x)
for every point of (a, b) and G is continuous on [a, b] . Then
Z b
a
f (x) dx = G (b) âˆ’G (a) .
(3.16)
Proof: Let P = {x0, Â· Â· Â·, xn} be a partition satisfying
U (f, P) âˆ’L (f, P) < Îµ.
Then
G (b) âˆ’G (a) = G (xn) âˆ’G (x0)
=
n
X
i=1
G (xi) âˆ’G (xiâˆ’1) .
By the mean value theorem,
G (b) âˆ’G (a) =
n
X
i=1
Gâ€² (zi) (xi âˆ’xiâˆ’1)
=
n
X
i=1
f (zi) âˆ†xi
where zi is some point in [xiâˆ’1, xi] . It follows, since the above sum lies between the
upper and lower sums, that
G (b) âˆ’G (a) âˆˆ[L (f, P) , U (f, P)] ,
and also
Z b
a
f (x) dx âˆˆ[L (f, P) , U (f, P)] .
Therefore,
Â¯Â¯Â¯Â¯Â¯G (b) âˆ’G (a) âˆ’
Z b
a
f (x) dx
Â¯Â¯Â¯Â¯Â¯ < U (f, P) âˆ’L (f, P) < Îµ.
Since Îµ > 0 is arbitrary, 3.16 holds. This proves the theorem.
3Of course it was proved that if f is continuous on a closed interval, [a, b] , then f âˆˆR ([a, b])
but this is a hard theorem using the diï¬ƒcult result about uniform continuity.

48
THE RIEMANN STIELTJES INTEGRAL
The following notation is often used in this context. Suppose F is an antideriva-
tive of f as just described with F continuous on [a, b] and F â€² = f on (a, b) . Then
Z b
a
f (x) dx = F (b) âˆ’F (a) â‰¡F (x) |b
a.
Deï¬nition 3.22 Let f be a bounded function deï¬ned on a closed interval [a, b] and
let P â‰¡{x0, Â·Â·Â·, xn} be a partition of the interval. Suppose zi âˆˆ[xiâˆ’1, xi] is chosen.
Then the sum
n
X
i=1
f (zi) (xi âˆ’xiâˆ’1)
is known as a Riemann sum. Also,
||P|| â‰¡max {|xi âˆ’xiâˆ’1| : i = 1, Â· Â· Â·, n} .
Proposition 3.23 Suppose f âˆˆR ([a, b]) . Then there exists a partition, P â‰¡
{x0, Â· Â· Â·, xn} with the property that for any choice of zk âˆˆ[xkâˆ’1, xk] ,
Â¯Â¯Â¯Â¯Â¯
Z b
a
f (x) dx âˆ’
n
X
k=1
f (zk) (xk âˆ’xkâˆ’1)
Â¯Â¯Â¯Â¯Â¯ < Îµ.
Proof: Choose P such that U (f, P) âˆ’L (f, P) < Îµ and then both
R b
a f (x) dx
and Pn
k=1 f (zk) (xk âˆ’xkâˆ’1) are contained in [L (f, P) , U (f, P)] and so the claimed
inequality must hold. This proves the proposition.
It is signiï¬cant because it gives a way of approximating the integral.
The deï¬nition of Riemann integrability given in this chapter is also called Dar-
boux integrability and the integral deï¬ned as the unique number which lies between
all upper sums and all lower sums which is given in this chapter is called the Dar-
boux integral . The deï¬nition of the Riemann integral in terms of Riemann sums
is given next.
Deï¬nition 3.24 A bounded function, f deï¬ned on [a, b] is said to be Riemann
integrable if there exists a number, I with the property that for every Îµ > 0, there
exists Î´ > 0 such that if
P â‰¡{x0, x1, Â· Â· Â·, xn}
is any partition having ||P|| < Î´, and zi âˆˆ[xiâˆ’1, xi] ,
Â¯Â¯Â¯Â¯Â¯I âˆ’
n
X
i=1
f (zi) (xi âˆ’xiâˆ’1)
Â¯Â¯Â¯Â¯Â¯ < Îµ.
The number
R b
a f (x) dx is deï¬ned as I.
Thus, there are two deï¬nitions of the Riemann integral. It turns out they are
equivalent which is the following theorem of of Darboux.

3.6.
EXERCISES
49
Theorem 3.25 A bounded function deï¬ned on [a, b] is Riemann integrable in the
sense of Deï¬nition 3.24 if and only if it is integrable in the sense of Darboux.
Furthermore the two integrals coincide.
The proof of this theorem is left for the exercises in Problems 10 - 12. It isnâ€™t
essential that you understand this theorem so if it does not interest you, leave it
out. Note that it implies that given a Riemann integrable function f in either sense,
it can be approximated by Riemann sums whenever ||P|| is suï¬ƒciently small. Both
versions of the integral are obsolete but entirely adequate for most applications and
as a point of departure for a more up to date and satisfactory integral. The reason
for using the Darboux approach to the integral is that all the existence theorems
are easier to prove in this context.
3.6
Exercises
1. Let F (x) =
R x3
x2
t5+7
t7+87t6+1 dt. Find F â€² (x) .
2. Let F (x) =
R x
2
1
1+t4 dt. Sketch a graph of F and explain why it looks the way
it does.
3. Let a and b be positive numbers and consider the function,
F (x) =
Z ax
0
1
a2 + t2 dt +
Z a/x
b
1
a2 + t2 dt.
Show that F is a constant.
4. Solve the following initial value problem from ordinary diï¬€erential equations
which is to ï¬nd a function y such that
yâ€² (x) =
x7 + 1
x6 + 97x5 + 7, y (10) = 5.
5. If F, G âˆˆ
R
f (x) dx for all x âˆˆR, show F (x) = G (x) + C for some constant,
C. Use this to give a diï¬€erent proof of the fundamental theorem of calculus
which has for its conclusion
R b
a f (t) dt = G (b) âˆ’G (a) where Gâ€² (x) = f (x) .
6. Suppose f is Riemann integrable on [a, b] and continuous. (In fact continuous
implies Riemann integrable.) Show there exists c âˆˆ(a, b) such that
f (c) =
1
b âˆ’a
Z b
a
f (x) dx.
Hint: You might consider the function F (x) â‰¡
R x
a f (t) dt and use the mean
value theorem for derivatives and the fundamental theorem of calculus.

50
THE RIEMANN STIELTJES INTEGRAL
7. Suppose f and g are continuous functions on [a, b] and that g (x) Ì¸= 0 on (a, b) .
Show there exists c âˆˆ(a, b) such that
f (c)
Z b
a
g (x) dx =
Z b
a
f (x) g (x) dx.
Hint: Deï¬ne F (x) â‰¡
R x
a f (t) g (t) dt and let G (x) â‰¡
R x
a g (t) dt. Then use
the Cauchy mean value theorem on these two functions.
8. Consider the function
f (x) â‰¡
Â½
sin
Â¡ 1
x
Â¢
if x Ì¸= 0
0 if x = 0
.
Is f Riemann integrable? Explain why or why not.
9. Prove the second part of Theorem 3.10 about decreasing functions.
10. Suppose f is a bounded function deï¬ned on [a, b] and |f (x)| < M for all
x âˆˆ[a, b] . Now let Q be a partition having n points, {xâˆ—
0, Â· Â· Â·, xâˆ—
n} and let P
be any other partition. Show that
|U (f, P) âˆ’L (f, P)| â‰¤2Mn ||P|| + |U (f, Q) âˆ’L (f, Q)| .
Hint: Write the sum for U (f, P)âˆ’L (f, P) and split this sum into two sums,
the sum of terms for which [xiâˆ’1, xi] contains at least one point of Q, and
terms for which [xiâˆ’1, xi] does not contain any points of Q. In the latter case,
[xiâˆ’1, xi] must be contained in some interval,
Â£
xâˆ—
kâˆ’1, xâˆ—
k
Â¤
. Therefore, the sum
of these terms should be no larger than |U (f, Q) âˆ’L (f, Q)| .
11. â†‘If Îµ > 0 is given and f is a Darboux integrable function deï¬ned on [a, b],
show there exists Î´ > 0 such that whenever ||P|| < Î´, then
|U (f, P) âˆ’L (f, P)| < Îµ.
12. â†‘Prove Theorem 3.25.

Some Important Linear
Algebra
This chapter contains some important linear algebra as distinguished from that
which is normally presented in undergraduate courses consisting mainly of uninter-
esting things you can do with row operations.
The notation, Cn refers to the collection of ordered lists of n complex numbers.
Since every real number is also a complex number, this simply generalizes the usual
notion of Rn, the collection of all ordered lists of n real numbers. In order to avoid
worrying about whether it is real or complex numbers which are being referred to,
the symbol F will be used. If it is not clear, always pick C.
Deï¬nition 4.1 Deï¬ne
Fn â‰¡{(x1, Â· Â· Â·, xn) : xj âˆˆF for j = 1, Â· Â· Â·, n} .
(x1, Â· Â· Â·, xn) = (y1, Â· Â· Â·, yn) if and only if for all j = 1, Â· Â· Â·, n, xj = yj. When
(x1, Â· Â· Â·, xn) âˆˆFn,
it is conventional to denote (x1, Â· Â· Â·, xn) by the single bold face letter, x. The num-
bers, xj are called the coordinates. The set
{(0, Â· Â· Â·, 0, t, 0, Â· Â· Â·, 0) : t âˆˆF}
for t in the ith slot is called the ith coordinate axis. The point 0 â‰¡(0, Â· Â· Â·, 0) is
called the origin.
Thus (1, 2, 4i) âˆˆF3 and (2, 1, 4i) âˆˆF3 but (1, 2, 4i) Ì¸= (2, 1, 4i) because, even
though the same numbers are involved, they donâ€™t match up. In particular, the
ï¬rst entries are not equal.
The geometric signiï¬cance of Rn for n â‰¤3 has been encountered already in
calculus or in precalculus. Here is a short review. First consider the case when
n = 1. Then from the deï¬nition, R1 = R. Recall that R is identiï¬ed with the
points of
a line. Look at the number line again. Observe that this amounts to
51

52
SOME IMPORTANT LINEAR ALGEBRA
identifying a point on this line with a real number. In other words a real number
determines where you are on this line. Now suppose n = 2 and consider two lines
which intersect each other at right angles as shown in the following picture.
2
6
Â· (2, 6)
âˆ’8
3
Â·
(âˆ’8, 3)
Notice how you can identify a point shown in the plane with the ordered pair,
(2, 6) . You go to the right a distance of 2 and then up a distance of 6. Similarly,
you can identify another point in the plane with the ordered pair (âˆ’8, 3) . Go to
the left a distance of 8 and then up a distance of 3. The reason you go to the left
is that there is a âˆ’sign on the eight.
From this reasoning, every ordered pair
determines a unique point in the plane. Conversely, taking a point in the plane,
you could draw two lines through the point, one vertical and the other horizontal
and determine unique points, x1 on the horizontal line in the above picture and x2
on the vertical line in the above picture, such that the point of interest is identiï¬ed
with the ordered pair, (x1, x2) . In short, points in the plane can be identiï¬ed with
ordered pairs similar to the way that points on the real line are identiï¬ed with
real numbers. Now suppose n = 3. As just explained, the ï¬rst two coordinates
determine a point in a plane. Letting the third component determine how far up
or down you go, depending on whether this number is positive or negative, this
determines a point in space. Thus, (1, 4, âˆ’5) would mean to determine the point
in the plane that goes with (1, 4) and then to go below this plane a distance of 5
to obtain a unique point in space. You see that the ordered triples correspond to
points in space just as the ordered pairs correspond to points in a plane and single
real numbers correspond to points on a line.
You canâ€™t stop here and say that you are only interested in n â‰¤3. What if you
were interested in the motion of two objects? You would need three coordinates
to describe where the ï¬rst object is and you would need another three coordinates
to describe where the other object is located. Therefore, you would need to be
considering R6. If the two objects moved around, you would need a time coordinate
as well. As another example, consider a hot object which is cooling and suppose
you want the temperature of this object. How many coordinates would be needed?
You would need one for the temperature, three for the position of the point in the
object and one more for the time.
Thus you would need to be considering R5.
Many other examples can be given. Sometimes n is very large. This is often the
case in applications to business when they are trying to maximize proï¬t subject
to constraints. It also occurs in numerical analysis when people try to solve hard
problems on a computer.

4.1.
ALGEBRA IN FN
53
There are other ways to identify points in space with three numbers but the one
presented is the most basic. In this case, the coordinates are known as Cartesian
coordinates after Descartes1 who invented this idea in the ï¬rst half of the seven-
teenth century. I will often not bother to draw a distinction between the point in n
dimensional space and its Cartesian coordinates.
The geometric signiï¬cance of Cn for n > 1 is not available because each copy of
C corresponds to the plane or R2.
4.1
Algebra in Fn
There are two algebraic operations done with elements of Fn. One is addition and
the other is multiplication by numbers, called scalars. In the case of Cn the scalars
are complex numbers while in the case of Rn the only allowed scalars are real
numbers. Thus, the scalars always come from F in either case.
Deï¬nition 4.2 If x âˆˆFn and a âˆˆF, also called a scalar, then ax âˆˆFn is deï¬ned
by
ax = a (x1, Â· Â· Â·, xn) â‰¡(ax1, Â· Â· Â·, axn) .
(4.1)
This is known as scalar multiplication. If x, y âˆˆFn then x + y âˆˆFn and is deï¬ned
by
x + y = (x1, Â· Â· Â·, xn) + (y1, Â· Â· Â·, yn)
â‰¡(x1 + y1, Â· Â· Â·, xn + yn)
(4.2)
With this deï¬nition, the algebraic properties satisfy the conclusions of the fol-
lowing theorem.
Theorem 4.3 For v, w âˆˆFn and Î±, Î² scalars, (real numbers), the following hold.
v + w = w + v,
(4.3)
the commutative law of addition,
(v + w) + z = v+ (w + z) ,
(4.4)
the associative law for addition,
v + 0 = v,
(4.5)
the existence of an additive identity,
v+ (âˆ’v) = 0,
(4.6)
1RenÂ´e Descartes 1596-1650 is often credited with inventing analytic geometry although it seems
the ideas were actually known much earlier. He was interested in many diï¬€erent subjects, physi-
ology, chemistry, and physics being some of them. He also wrote a large book in which he tried to
explain the book of Genesis scientiï¬cally. Descartes ended up dying in Sweden.

54
SOME IMPORTANT LINEAR ALGEBRA
the existence of an additive inverse, Also
Î± (v + w) = Î±v+Î±w,
(4.7)
(Î± + Î²) v =Î±v+Î²v,
(4.8)
Î± (Î²v) = Î±Î² (v) ,
(4.9)
1v = v.
(4.10)
In the above 0 = (0, Â· Â· Â·, 0).
You should verify these properties all hold. For example, consider 4.7
Î± (v + w) = Î± (v1 + w1, Â· Â· Â·, vn + wn)
= (Î± (v1 + w1) , Â· Â· Â·, Î± (vn + wn))
= (Î±v1 + Î±w1, Â· Â· Â·, Î±vn + Î±wn)
= (Î±v1, Â· Â· Â·, Î±vn) + (Î±w1, Â· Â· Â·, Î±wn)
= Î±v + Î±w.
As usual subtraction is deï¬ned as x âˆ’y â‰¡x+ (âˆ’y) .
4.2
Exercises
1. Verify all the properties 4.3-4.10.
2. Compute 5 (1, 2 + 3i, 3, âˆ’2) + 6 (2 âˆ’i, 1, âˆ’2, 7) .
3. Draw a picture of the points in R2 which are determined by the following
ordered pairs.
(a) (1, 2)
(b) (âˆ’2, âˆ’2)
(c) (âˆ’2, 3)
(d) (2, âˆ’5)
4. Does it make sense to write (1, 2) + (2, 3, 1)? Explain.
5. Draw a picture of the points in R3 which are determined by the following
ordered triples.
(a) (1, 2, 0)
(b) (âˆ’2, âˆ’2, 1)
(c) (âˆ’2, 3, âˆ’2)

4.3.
SUBSPACES SPANS AND BASES
55
4.3
Subspaces Spans And Bases
Deï¬nition 4.4 Let {x1, Â· Â· Â·, xp} be vectors in Fn. A linear combination is any ex-
pression of the form
p
X
i=1
cixi
where the ci are scalars.
The set of all linear combinations of these vectors is
called span (x1, Â· Â· Â·, xn) . If V âŠ†Fn, then V is called a subspace if whenever Î±, Î²
are scalars and u and v are vectors of V, it follows Î±u + Î²v âˆˆV . That is, it is
â€œclosed under the algebraic operations of vector addition and scalar multiplicationâ€.
A linear combination of vectors is said to be trivial if all the scalars in the linear
combination equal zero. A set of vectors is said to be linearly independent if the
only linear combination of these vectors which equals the zero vector is the trivial
linear combination. Thus {x1, Â· Â· Â·, xn} is called linearly independent if whenever
p
X
k=1
ckxk = 0
it follows that all the scalars, ck equal zero. A set of vectors, {x1, Â· Â· Â·, xp} , is called
linearly dependent if it is not linearly independent. Thus the set of vectors is linearly
dependent if there exist scalars, ci, i = 1, Â·Â·Â·, n, not all zero such that Pp
k=1 ckxk = 0.
Lemma 4.5 A set of vectors {x1, Â· Â· Â·, xp} is linearly independent if and only if
none of the vectors can be obtained as a linear combination of the others.
Proof: Suppose ï¬rst that {x1, Â· Â· Â·, xp} is linearly independent. If
xk =
X
jÌ¸=k
cjxj,
then
0 = 1xk +
X
jÌ¸=k
(âˆ’cj) xj,
a nontrivial linear combination, contrary to assumption. This shows that if the
set is linearly independent, then none of the vectors is a linear combination of the
others.
Now suppose no vector is a linear combination of the others. Is {x1, Â· Â· Â·, xp}
linearly independent? If it is not there exist scalars, ci, not all zero such that
p
X
i=1
cixi = 0.
Say ck Ì¸= 0. Then you can solve for xk as
xk =
X
jÌ¸=k
(âˆ’cj) /ckxj

56
SOME IMPORTANT LINEAR ALGEBRA
contrary to assumption. This proves the lemma.
The following is called the exchange theorem.
Theorem 4.6 (Exchange Theorem) Let {x1, Â· Â· Â·, xr} be a linearly independent set
of vectors such that each xi is in span(y1, Â· Â· Â·, ys) . Then r â‰¤s.
Proof:
Deï¬ne span{y1, Â· Â· Â·, ys} â‰¡V, it follows there exist scalars, c1, Â· Â· Â·, cs
such that
x1 =
s
X
i=1
ciyi.
(4.11)
Not all of these scalars can equal zero because if this were the case, it would follow
that x1 = 0 and so {x1, Â· Â· Â·, xr} would not be linearly independent.
Indeed, if
x1 = 0, 1x1 + Pr
i=2 0xi = x1 = 0 and so there would exist a nontrivial linear
combination of the vectors {x1, Â· Â· Â·, xr} which equals zero.
Say ck Ì¸= 0. Then solve (4.11) for yk and obtain
yk âˆˆspan
ï£«
ï£­x1,
s-1 vectors here
z
}|
{
y1, Â· Â· Â·, ykâˆ’1, yk+1, Â· Â· Â·, ys
ï£¶
ï£¸.
Deï¬ne {z1, Â· Â· Â·, zsâˆ’1} by
{z1, Â· Â· Â·, zsâˆ’1} â‰¡{y1, Â· Â· Â·, ykâˆ’1, yk+1, Â· Â· Â·, ys}
Therefore, span {x1, z1, Â· Â· Â·, zsâˆ’1} = V because if v âˆˆV, there exist constants c1, Â· Â·
Â·, cs such that
v =
sâˆ’1
X
i=1
cizi + csyk.
Now replace the yk in the above with a linear combination of the vectors,
{x1, z1, Â· Â· Â·, zsâˆ’1}
to obtain
v âˆˆspan {x1, z1, Â· Â· Â·, zsâˆ’1} .
The vector yk, in the list {y1, Â· Â· Â·, ys} , has now been replaced with the vector x1
and the resulting modiï¬ed list of vectors has the same span as the original list of
vectors, {y1, Â· Â· Â·, ys} .
Now suppose that r > s and that
span (x1, Â· Â· Â·, xl, z1, Â· Â· Â·, zp) = V
where the vectors, z1, Â·Â·Â·, zp are each taken from the set, {y1, Â· Â· Â·, ys} and l +p = s.
This has now been done for l = 1 above. Then since r > s, it follows that l â‰¤s < r

4.3.
SUBSPACES SPANS AND BASES
57
and so l + 1 â‰¤r. Therefore, xl+1 is a vector not in the list, {x1, Â· Â· Â·, xl} and since
span {x1, Â· Â· Â·, xl, z1, Â· Â· Â·, zp} = V, there exist scalars, ci and dj such that
xl+1 =
l
X
i=1
cixi +
p
X
j=1
djzj.
(4.12)
Now not all the dj can equal zero because if this were so, it would follow that
{x1, Â· Â· Â·, xr} would be a linearly dependent set because one of the vectors would
equal a linear combination of the others. Therefore, (4.12) can be solved for one of
the zi, say zk, in terms of xl+1 and the other zi and just as in the above argument,
replace that zi with xl+1 to obtain
span
ï£«
ï£­x1, Â· Â· Â·xl, xl+1,
p-1 vectors here
z
}|
{
z1, Â· Â· Â·zkâˆ’1, zk+1, Â· Â· Â·, zp
ï£¶
ï£¸= V.
Continue this way, eventually obtaining
span (x1, Â· Â· Â·, xs) = V.
But then xr âˆˆspan (x1, Â· Â· Â·, xs) contrary to the assumption that {x1, Â· Â· Â·, xr} is
linearly independent. Therefore, r â‰¤s as claimed.
Deï¬nition 4.7 A ï¬nite set of vectors, {x1, Â· Â· Â·, xr} is a basis for Fn if
span (x1, Â· Â· Â·, xr) = Fn
and {x1, Â· Â· Â·, xr} is linearly independent.
Corollary 4.8 Let {x1, Â· Â· Â·, xr} and {y1, Â· Â· Â·, ys} be two bases2 of Fn. Then r =
s = n.
Proof: From the exchange theorem, r â‰¤s and s â‰¤r. Now note the vectors,
ei =
1 is in the ith slot
z
}|
{
(0, Â· Â· Â·, 0, 1, 0 Â· Â·Â·, 0)
for i = 1, 2, Â· Â· Â·, n are a basis for Fn. This proves the corollary.
Lemma 4.9 Let {v1, Â· Â· Â·, vr} be a set of vectors. Then V â‰¡span (v1, Â· Â· Â·, vr) is a
subspace.
2This is the plural form of basis. We could say basiss but it would involve an inordinate amount
of hissing as in â€œThe sixth shiekâ€™s sixth sheep is sickâ€. This is the reason that bases is used instead
of basiss.

58
SOME IMPORTANT LINEAR ALGEBRA
Proof: Suppose Î±, Î² are two scalars and let Pr
k=1 ckvk and Pr
k=1 dkvk are two
elements of V. What about
Î±
r
X
k=1
ckvk + Î²
r
X
k=1
dkvk?
Is it also in V ?
Î±
r
X
k=1
ckvk + Î²
r
X
k=1
dkvk =
r
X
k=1
(Î±ck + Î²dk) vk âˆˆV
so the answer is yes. This proves the lemma.
Deï¬nition 4.10 A ï¬nite set of vectors, {x1, Â· Â· Â·, xr} is a basis for a subspace, V
of Fn if span (x1, Â· Â· Â·, xr) = V and {x1, Â· Â· Â·, xr} is linearly independent.
Corollary 4.11 Let {x1, Â· Â· Â·, xr} and {y1, Â· Â· Â·, ys} be two bases for V . Then r = s.
Proof: From the exchange theorem, r â‰¤s and s â‰¤r. Therefore, this proves
the corollary.
Deï¬nition 4.12 Let V be a subspace of Fn. Then dim (V ) read as the dimension
of V is the number of vectors in a basis.
Of course you should wonder right now whether an arbitrary subspace even has
a basis. In fact it does and this is in the next theorem. First, here is an interesting
lemma.
Lemma 4.13 Suppose v /âˆˆspan (u1, Â· Â· Â·, uk) and {u1, Â· Â· Â·, uk} is linearly indepen-
dent. Then {u1, Â· Â· Â·, uk, v} is also linearly independent.
Proof: Suppose Pk
i=1 ciui + dv = 0. It is required to verify that each ci = 0
and that d = 0. But if d Ì¸= 0, then you can solve for v as a linear combination of
the vectors, {u1, Â· Â· Â·, uk},
v = âˆ’
k
X
i=1
Â³ci
d
Â´
ui
contrary to assumption. Therefore, d = 0. But then Pk
i=1 ciui = 0 and the linear
independence of {u1, Â· Â· Â·, uk} implies each ci = 0 also. This proves the lemma.
Theorem 4.14 Let V be a nonzero subspace of Fn. Then V has a basis.
Proof: Let v1 âˆˆV where v1 Ì¸= 0. If span {v1} = V, stop. {v1} is a basis for V .
Otherwise, there exists v2 âˆˆV which is not in span {v1} . By Lemma 4.13 {v1, v2}
is a linearly independent set of vectors. If span {v1, v2} = V stop, {v1, v2} is a basis
for V. If span {v1, v2} Ì¸= V, then there exists v3 /âˆˆspan {v1, v2} and {v1, v2, v3} is
a larger linearly independent set of vectors. Continuing this way, the process must
stop before n + 1 steps because if not, it would be possible to obtain n + 1 linearly
independent vectors contrary to the exchange theorem. This proves the theorem.
In words the following corollary states that any linearly independent set of vec-
tors can be enlarged to form a basis.

4.4.
AN APPLICATION TO MATRICES
59
Corollary 4.15 Let V be a subspace of Fn and let {v1, Â· Â· Â·, vr} be a linearly inde-
pendent set of vectors in V . Then either it is a basis for V or there exist vectors,
vr+1, Â· Â· Â·, vs such that {v1, Â· Â· Â·, vr, vr+1, Â· Â· Â·, vs} is a basis for V.
Proof: This follows immediately from the proof of Theorem 31.23.
You do
exactly the same argument except you start with {v1, Â· Â· Â·, vr} rather than {v1}.
It is also true that any spanning set of vectors can be restricted to obtain a
basis.
Theorem 4.16 Let V be a subspace of Fn and suppose span (u1 Â· Â·Â·, up) = V
where the ui are nonzero vectors. Then there exist vectors, {v1 Â· Â·Â·, vr} such that
{v1 Â· Â·Â·, vr} âŠ†{u1 Â· Â·Â·, up} and {v1 Â· Â·Â·, vr} is a basis for V .
Proof: Let r be the smallest positive integer with the property that for some
set, {v1 Â· Â·Â·, vr} âŠ†{u1 Â· Â·Â·, up} ,
span (v1 Â· Â·Â·, vr) = V.
Then r â‰¤p and it must be the case that {v1 Â· Â·Â·, vr} is linearly independent because
if it were not so, one of the vectors, say vk would be a linear combination of the
others. But then you could delete this vector from {v1 Â· Â·Â·, vr} and the resulting list
of r âˆ’1 vectors would still span V contrary to the deï¬nition of r. This proves the
theorem.
4.4
An Application To Matrices
The following is a theorem of major signiï¬cance.
Theorem 4.17 Suppose A is an n Ã— n matrix. Then A is one to one if and only
if A is onto. Also, if B is an n Ã— n matrix and AB = I, then it follows BA = I.
Proof: First suppose A is one to one. Consider the vectors, {Ae1, Â· Â· Â·, Aen}
where ek is the column vector which is all zeros except for a 1 in the kth position.
This set of vectors is linearly independent because if
n
X
k=1
ckAek = 0,
then since A is linear,
A
Ãƒ n
X
k=1
ckek
!
= 0
and since A is one to one, it follows
n
X
k=1
ckek = 03

60
SOME IMPORTANT LINEAR ALGEBRA
which implies each ck = 0. Therefore, {Ae1, Â· Â· Â·, Aen} must be a basis for Fn because
if not there would exist a vector, y /âˆˆspan (Ae1, Â· Â· Â·, Aen) and then by Lemma 4.13,
{Ae1, Â· Â· Â·, Aen, y} would be an independent set of vectors having n+1 vectors in it,
contrary to the exchange theorem. It follows that for y âˆˆFn there exist constants,
ci such that
y =
n
X
k=1
ckAek = A
Ãƒ n
X
k=1
ckek
!
showing that, since y was arbitrary, A is onto.
Next suppose A is onto. This means the span of the columns of A equals Fn. If
these columns are not linearly independent, then by Lemma 4.5 on Page 55, one of
the columns is a linear combination of the others and so the span of the columns of
A equals the span of the n âˆ’1 other columns. This violates the exchange theorem
because {e1, Â· Â· Â·, en} would be a linearly independent set of vectors contained in the
span of only n âˆ’1 vectors. Therefore, the columns of A must be independent and
this equivalent to saying that Ax = 0 if and only if x = 0. This implies A is one to
one because if Ax = Ay, then A (x âˆ’y) = 0 and so x âˆ’y = 0.
Now suppose AB = I. Why is BA = I? Since AB = I it follows B is one to
one since otherwise, there would exist, x Ì¸= 0 such that Bx = 0 and then ABx =
A0 = 0 Ì¸= Ix. Therefore, from what was just shown, B is also onto. In addition to
this, A must be one to one because if Ay = 0, then y = Bx for some x and then
x = ABx = Ay = 0 showing y = 0. Now from what is given to be so, it follows
(AB) A = A and so using the associative law for matrix multiplication,
A (BA) âˆ’A = A (BA âˆ’I) = 0.
But this means (BA âˆ’I) x = 0 for all x since otherwise, A would not be one to
one. Hence BA = I as claimed. This proves the theorem.
This theorem shows that if an nÃ—n matrix, B acts like an inverse when multiplied
on one side of A it follows that B = Aâˆ’1and it will act like an inverse on both sides
of A.
The conclusion of this theorem pertains to square matrices only. For example,
let
A =
ï£«
ï£­
1
0
0
1
1
0
ï£¶
ï£¸, B =
Âµ
1
0
0
1
1
âˆ’1
Â¶
(4.13)
Then
BA =
Âµ
1
0
0
1
Â¶
but
AB =
ï£«
ï£­
1
0
0
1
1
âˆ’1
1
0
0
ï£¶
ï£¸.

4.5.
THE MATHEMATICAL THEORY OF DETERMINANTS
61
4.5
The Mathematical Theory Of Determinants
It is assumed the reader is familiar with matrices. However, the topic of determi-
nants is often neglected in linear algebra books these days. Therefore, I will give a
fairly quick and grubby treatment of this topic which includes all the main results.
Two books which give a good introduction to determinants are Apostol [3] and
Rudin [44]. A recent book which also has a good introduction is Baker [7]
Let (i1, Â· Â· Â·, in) be an ordered list of numbers from {1, Â· Â· Â·, n} . This means the
order is important so (1, 2, 3) and (2, 1, 3) are diï¬€erent.
The following Lemma will be essential in the deï¬nition of the determinant.
Lemma 4.18 There exists a unique function, sgnn which maps each list of n num-
bers from {1, Â· Â· Â·, n} to one of the three numbers, 0, 1, or âˆ’1 which also has the
following properties.
sgnn (1, Â· Â· Â·, n) = 1
(4.14)
sgnn (i1, Â· Â· Â·, p, Â· Â· Â·, q, Â· Â· Â·, in) = âˆ’sgnn (i1, Â· Â· Â·, q, Â· Â· Â·, p, Â· Â· Â·, in)
(4.15)
In words, the second property states that if two of the numbers are switched, the
value of the function is multiplied by âˆ’1. Also, in the case where n > 1 and
{i1, Â· Â· Â·, in} = {1, Â· Â· Â·, n} so that every number from {1, Â· Â· Â·, n} appears in the ordered
list, (i1, Â· Â· Â·, in) ,
sgnn (i1, Â· Â· Â·, iÎ¸âˆ’1, n, iÎ¸+1, Â· Â· Â·, in) â‰¡
(âˆ’1)nâˆ’Î¸ sgnnâˆ’1 (i1, Â· Â· Â·, iÎ¸âˆ’1, iÎ¸+1, Â· Â· Â·, in)
(4.16)
where n = iÎ¸ in the ordered list, (i1, Â· Â· Â·, in) .
Proof: To begin with, it is necessary to show the existence of such a func-
tion. This is clearly true if n = 1. Deï¬ne sgn1 (1) â‰¡1 and observe that it works.
No switching is possible.
In the case where n = 2, it is also clearly true.
Let
sgn2 (1, 2) = 1 and sgn2 (2, 1) = 0 while sgn2 (2, 2) = sgn2 (1, 1) = 0 and verify it
works. Assuming such a function exists for n, sgnn+1 will be deï¬ned in terms of
sgnn . If there are any repeated numbers in (i1, Â· Â· Â·, in+1) , sgnn+1 (i1, Â· Â· Â·, in+1) â‰¡0.
If there are no repeats, then n + 1 appears somewhere in the ordered list.
Let
Î¸ be the position of the number n + 1 in the list. Thus, the list is of the form
(i1, Â· Â· Â·, iÎ¸âˆ’1, n + 1, iÎ¸+1, Â· Â· Â·, in+1) . From 4.16 it must be that
sgnn+1 (i1, Â· Â· Â·, iÎ¸âˆ’1, n + 1, iÎ¸+1, Â· Â· Â·, in+1) â‰¡
(âˆ’1)n+1âˆ’Î¸ sgnn (i1, Â· Â· Â·, iÎ¸âˆ’1, iÎ¸+1, Â· Â· Â·, in+1) .
It is necessary to verify this satisï¬es 4.14 and 4.15 with n replaced with n + 1. The
ï¬rst of these is obviously true because
sgnn+1 (1, Â· Â· Â·, n, n + 1) â‰¡(âˆ’1)n+1âˆ’(n+1) sgnn (1, Â· Â· Â·, n) = 1.

62
SOME IMPORTANT LINEAR ALGEBRA
If there are repeated numbers in (i1, Â· Â· Â·, in+1) , then it is obvious 4.15 holds because
both sides would equal zero from the above deï¬nition. It remains to verify 4.15 in
the case where there are no numbers repeated in (i1, Â· Â· Â·, in+1) . Consider
sgnn+1
Â³
i1, Â· Â· Â·,
rp, Â· Â· Â·,
sq, Â· Â· Â·, in+1
Â´
,
where the r above the p indicates the number, p is in the rth position and the s
above the q indicates that the number, q is in the sth position. Suppose ï¬rst that
r < Î¸ < s. Then
sgnn+1
Âµ
i1, Â· Â· Â·,
rp, Â· Â· Â·,
Î¸
n + 1, Â· Â· Â·,
sq, Â· Â· Â·, in+1
Â¶
â‰¡
(âˆ’1)n+1âˆ’Î¸ sgnn
Â³
i1, Â· Â· Â·,
rp, Â· Â· Â·,
sâˆ’1
q , Â· Â· Â·, in+1
Â´
while
sgnn+1
Âµ
i1, Â· Â· Â·,
rq, Â· Â· Â·,
Î¸
n + 1, Â· Â· Â·,
sp, Â· Â· Â·, in+1
Â¶
=
(âˆ’1)n+1âˆ’Î¸ sgnn
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·,
sâˆ’1
p , Â· Â· Â·, in+1
Â´
and so, by induction, a switch of p and q introduces a minus sign in the result.
Similarly, if Î¸ > s or if Î¸ < r it also follows that 4.15 holds. The interesting case
is when Î¸ = r or Î¸ = s. Consider the case where Î¸ = r and note the other case is
entirely similar.
sgnn+1
Â³
i1, Â· Â· Â·,
r
n + 1, Â· Â· Â·,
sq, Â· Â· Â·, in+1
Â´
=
(âˆ’1)n+1âˆ’r sgnn
Â³
i1, Â· Â· Â·,
sâˆ’1
q , Â· Â· Â·, in+1
Â´
(4.17)
while
sgnn+1
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·,
s
n + 1, Â· Â· Â·, in+1
Â´
=
(âˆ’1)n+1âˆ’s sgnn
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·, in+1
Â´
.
(4.18)
By making s âˆ’1 âˆ’r switches, move the q which is in the s âˆ’1th position in 4.17 to
the rth position in 4.18. By induction, each of these switches introduces a factor of
âˆ’1 and so
sgnn
Â³
i1, Â· Â· Â·,
sâˆ’1
q , Â· Â· Â·, in+1
Â´
= (âˆ’1)sâˆ’1âˆ’r sgnn
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·, in+1
Â´
.
Therefore,
sgnn+1
Â³
i1, Â· Â· Â·,
r
n + 1, Â· Â· Â·,
sq, Â· Â· Â·, in+1
Â´
=
(âˆ’1)n+1âˆ’r sgnn
Â³
i1, Â· Â· Â·,
sâˆ’1
q , Â· Â· Â·, in+1
Â´

4.5.
THE MATHEMATICAL THEORY OF DETERMINANTS
63
= (âˆ’1)n+1âˆ’r (âˆ’1)sâˆ’1âˆ’r sgnn
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·, in+1
Â´
=
(âˆ’1)n+s sgnn
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·, in+1
Â´
=
(âˆ’1)2sâˆ’1 (âˆ’1)n+1âˆ’s sgnn
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·, in+1
Â´
= âˆ’sgnn+1
Â³
i1, Â· Â· Â·,
rq, Â· Â· Â·,
s
n + 1, Â· Â· Â·, in+1
Â´
.
This proves the existence of the desired function.
To see this function is unique, note that you can obtain any ordered list of
distinct numbers from a sequence of switches. If there exist two functions, f and
g both satisfying 4.14 and 4.15, you could start with f (1, Â· Â· Â·, n) = g (1, Â· Â· Â·, n)
and applying the same sequence of switches, eventually arrive at f (i1, Â· Â· Â·, in) =
g (i1, Â· Â· Â·, in) . If any numbers are repeated, then 4.15 gives both functions are equal
to zero for that ordered list. This proves the lemma.
In what follows sgn will often be used rather than sgnn because the context
supplies the appropriate n.
Deï¬nition 4.19 Let f be a real valued function which has the set of ordered lists
of numbers from {1, Â· Â· Â·, n} as its domain. Deï¬ne
X
(k1,Â·Â·Â·,kn)
f (k1 Â· Â· Â· kn)
to be the sum of all the
f (k1 Â· Â· Â· kn)
for all possible choices of ordered lists
(k1, Â· Â· Â·, kn)
of numbers of
{1, Â· Â· Â·, n} .
For example,
X
(k1,k2)
f (k1, k2) = f (1, 2) + f (2, 1) + f (1, 1) + f (2, 2) .
Deï¬nition 4.20 Let (aij) = A denote an n Ã— n matrix. The determinant of A,
denoted by det (A) is deï¬ned by
det (A) â‰¡
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) a1k1 Â· Â· Â· ankn
where the sum is taken over all ordered lists of numbers from {1, Â· Â· Â·, n}. Note it
suï¬ƒces to take the sum over only those ordered lists in which there are no repeats
because if there are, sgn (k1, Â· Â· Â·, kn) = 0 and so that term contributes 0 to the sum.

64
SOME IMPORTANT LINEAR ALGEBRA
Let A be an n Ã— n matrix, A = (aij) and let (r1, Â· Â· Â·, rn) denote an ordered list
of n numbers from {1, Â· Â· Â·, n}. Let A (r1, Â· Â· Â·, rn) denote the matrix whose kth row
is the rk row of the matrix, A. Thus
det (A (r1, Â· Â· Â·, rn)) =
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) ar1k1 Â· Â· Â· arnkn
(4.19)
and
A (1, Â· Â· Â·, n) = A.
Proposition 4.21 Let
(r1, Â· Â· Â·, rn)
be an ordered list of numbers from {1, Â· Â· Â·, n}. Then
sgn (r1, Â· Â· Â·, rn) det (A)
=
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) ar1k1 Â· Â· Â· arnkn
(4.20)
=
det (A (r1, Â· Â· Â·, rn)) .
(4.21)
Proof: Let (1, Â· Â· Â·, n) = (1, Â· Â· Â·, r, Â· Â· Â·s, Â· Â· Â·, n) so r < s.
det (A (1, Â· Â· Â·, r, Â· Â· Â·, s, Â· Â· Â·, n)) =
(4.22)
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kr, Â· Â· Â·, ks, Â· Â· Â·, kn) a1k1 Â· Â· Â· arkr Â· Â· Â· asks Â· Â· Â· ankn,
and renaming the variables, calling ks, kr and kr, ks, this equals
=
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, ks, Â· Â· Â·, kr, Â· Â· Â·, kn) a1k1 Â· Â· Â· arks Â· Â· Â· askr Â· Â· Â· ankn
=
X
(k1,Â·Â·Â·,kn)
âˆ’sgn
ï£«
ï£­k1, Â· Â· Â·,
These got switched
z
}|
{
kr, Â· Â· Â·, ks
, Â· Â· Â·, kn
ï£¶
ï£¸a1k1 Â· Â· Â· askr Â· Â· Â· arks Â· Â· Â· ankn
= âˆ’det (A (1, Â· Â· Â·, s, Â· Â· Â·, r, Â· Â· Â·, n)) .
(4.23)
Consequently,
det (A (1, Â· Â· Â·, s, Â· Â· Â·, r, Â· Â· Â·, n)) =
âˆ’det (A (1, Â· Â· Â·, r, Â· Â· Â·, s, Â· Â· Â·, n)) = âˆ’det (A)
Now letting A (1, Â· Â· Â·, s, Â· Â· Â·, r, Â· Â· Â·, n) play the role of A, and continuing in this way,
switching pairs of numbers,
det (A (r1, Â· Â· Â·, rn)) = (âˆ’1)p det (A)

4.5.
THE MATHEMATICAL THEORY OF DETERMINANTS
65
where it took p switches to obtain(r1, Â· Â· Â·, rn) from (1, Â· Â· Â·, n). By Lemma 4.18, this
implies
det (A (r1, Â· Â· Â·, rn)) = (âˆ’1)p det (A) = sgn (r1, Â· Â· Â·, rn) det (A)
and proves the proposition in the case when there are no repeated numbers in the
ordered list, (r1, Â· Â· Â·, rn). However, if there is a repeat, say the rth row equals the
sth row, then the reasoning of 4.22 -4.23 shows that A (r1, Â· Â· Â·, rn) = 0 and also
sgn (r1, Â· Â· Â·, rn) = 0 so the formula holds in this case also.
Observation 4.22 There are n! ordered lists of distinct numbers from {1, Â· Â· Â·, n} .
To see this, consider n slots placed in order. There are n choices for the ï¬rst
slot. For each of these choices, there are n âˆ’1 choices for the second. Thus there
are n (n âˆ’1) ways to ï¬ll the ï¬rst two slots. Then for each of these ways there are
n âˆ’2 choices left for the third slot. Continuing this way, there are n! ordered lists
of distinct numbers from {1, Â· Â· Â·, n} as stated in the observation.
With the above, it is possible to give a more symmetric description of the de-
terminant from which it will follow that det (A) = det
Â¡
AT Â¢
.
Corollary 4.23 The following formula for det (A) is valid.
det (A) = 1
n!Â·
X
(r1,Â·Â·Â·,rn)
X
(k1,Â·Â·Â·,kn)
sgn (r1, Â· Â· Â·, rn) sgn (k1, Â· Â· Â·, kn) ar1k1 Â· Â· Â· arnkn.
(4.24)
And also det
Â¡
AT Â¢
= det (A) where AT is the transpose of A.
(Recall that for
AT =
Â¡
aT
ij
Â¢
, aT
ij = aji.)
Proof: From Proposition 4.21, if the ri are distinct,
det (A) =
X
(k1,Â·Â·Â·,kn)
sgn (r1, Â· Â· Â·, rn) sgn (k1, Â· Â· Â·, kn) ar1k1 Â· Â· Â· arnkn.
Summing over all ordered lists, (r1, Â· Â· Â·, rn) where the ri are distinct, (If the ri are
not distinct, sgn (r1, Â· Â· Â·, rn) = 0 and so there is no contribution to the sum.)
n! det (A) =
X
(r1,Â·Â·Â·,rn)
X
(k1,Â·Â·Â·,kn)
sgn (r1, Â· Â· Â·, rn) sgn (k1, Â· Â· Â·, kn) ar1k1 Â· Â· Â· arnkn.
This proves the corollary since the formula gives the same number for A as it does
for AT .

66
SOME IMPORTANT LINEAR ALGEBRA
Corollary 4.24 If two rows or two columns in an nÃ—n matrix, A, are switched, the
determinant of the resulting matrix equals (âˆ’1) times the determinant of the original
matrix. If A is an n Ã— n matrix in which two rows are equal or two columns are
equal then det (A) = 0. Suppose the ith row of A equals (xa1 + yb1, Â· Â· Â·, xan + ybn).
Then
det (A) = x det (A1) + y det (A2)
where the ith row of A1 is (a1, Â· Â· Â·, an) and the ith row of A2 is (b1, Â· Â· Â·, bn) , all
other rows of A1 and A2 coinciding with those of A. In other words, det is a linear
function of each row A. The same is true with the word â€œrowâ€ replaced with the
word â€œcolumnâ€.
Proof: By Proposition 4.21 when two rows are switched, the determinant of the
resulting matrix is (âˆ’1) times the determinant of the original matrix. By Corollary
4.23 the same holds for columns because the columns of the matrix equal the rows
of the transposed matrix. Thus if A1 is the matrix obtained from A by switching
two columns,
det (A) = det
Â¡
AT Â¢
= âˆ’det
Â¡
AT
1
Â¢
= âˆ’det (A1) .
If A has two equal columns or two equal rows, then switching them results in the
same matrix. Therefore, det (A) = âˆ’det (A) and so det (A) = 0.
It remains to verify the last assertion.
det (A) â‰¡
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) a1k1 Â· Â· Â· (xaki + ybki) Â· Â· Â· ankn
= x
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) a1k1 Â· Â· Â· aki Â· Â· Â· ankn
+y
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) a1k1 Â· Â· Â· bki Â· Â· Â· ankn
â‰¡x det (A1) + y det (A2) .
The same is true of columns because det
Â¡
AT Â¢
= det (A) and the rows of AT are
the columns of A.
Deï¬nition 4.25 A vector, w, is a linear combination of the vectors {v1, Â· Â· Â·, vr} if
there exists scalars, c1, Â· Â· Â·cr such that w = Pr
k=1 ckvk. This is the same as saying
w âˆˆspan {v1, Â· Â· Â·, vr} .
The following corollary is also of great use.
Corollary 4.26 Suppose A is an n Ã— n matrix and some column (row) is a linear
combination of r other columns (rows). Then det (A) = 0.

4.5.
THE MATHEMATICAL THEORY OF DETERMINANTS
67
Proof: Let A =
Â¡
a1
Â· Â· Â·
an
Â¢
be the columns of A and suppose the condition
that one column is a linear combination of r of the others is satisï¬ed. Then by using
Corollary 4.24 you may rearrange the columns to have the nth column a linear
combination of the ï¬rst r columns. Thus an = Pr
k=1 ckak and so
det (A) = det
Â¡
a1
Â· Â· Â·
ar
Â· Â· Â·
anâˆ’1
Pr
k=1 ckak
Â¢
.
By Corollary 4.24
det (A) =
r
X
k=1
ck det
Â¡
a1
Â· Â· Â·
ar
Â· Â· Â·
anâˆ’1
ak
Â¢
= 0.
The case for rows follows from the fact that det (A) = det
Â¡
AT Â¢
. This proves the
corollary.
Recall the following deï¬nition of matrix multiplication.
Deï¬nition 4.27 If A and B are n Ã— n matrices, A = (aij) and B = (bij), AB =
(cij) where
cij â‰¡
n
X
k=1
aikbkj.
One of the most important rules about determinants is that the determinant of
a product equals the product of the determinants.
Theorem 4.28 Let A and B be n Ã— n matrices. Then
det (AB) = det (A) det (B) .
Proof: Let cij be the ijth entry of AB. Then by Proposition 4.21,
det (AB) =
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) c1k1 Â· Â· Â· cnkn
=
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn)
ÃƒX
r1
a1r1br1k1
!
Â· Â· Â·
ÃƒX
rn
anrnbrnkn
!
=
X
(r1Â·Â·Â·,rn)
X
(k1,Â·Â·Â·,kn)
sgn (k1, Â· Â· Â·, kn) br1k1 Â· Â· Â· brnkn (a1r1 Â· Â· Â· anrn)
=
X
(r1Â·Â·Â·,rn)
sgn (r1 Â· Â· Â· rn) a1r1 Â· Â· Â· anrn det (B) = det (A) det (B) .
This proves the theorem.

68
SOME IMPORTANT LINEAR ALGEBRA
Lemma 4.29 Suppose a matrix is of the form
M =
Âµ A
âˆ—
0
a
Â¶
(4.25)
or
M =
Âµ
A
0
âˆ—
a
Â¶
(4.26)
where a is a number and A is an (n âˆ’1) Ã— (n âˆ’1) matrix and âˆ—denotes either a
column or a row having length n âˆ’1 and the 0 denotes either a column or a row of
length n âˆ’1 consisting entirely of zeros. Then
det (M) = a det (A) .
Proof: Denote M by (mij) . Thus in the ï¬rst case, mnn = a and mni = 0 if
i Ì¸= n while in the second case, mnn = a and min = 0 if i Ì¸= n. From the deï¬nition
of the determinant,
det (M) â‰¡
X
(k1,Â·Â·Â·,kn)
sgnn (k1, Â· Â· Â·, kn) m1k1 Â· Â· Â· mnkn
Letting Î¸ denote the position of n in the ordered list, (k1, Â· Â· Â·, kn) then using the
earlier conventions used to prove Lemma 4.18, det (M) equals
X
(k1,Â·Â·Â·,kn)
(âˆ’1)nâˆ’Î¸ sgnnâˆ’1
Âµ
k1, Â· Â· Â·, kÎ¸âˆ’1,
Î¸
kÎ¸+1, Â· Â· Â·,
nâˆ’1
kn
Â¶
m1k1 Â· Â· Â· mnkn
Now suppose 4.26. Then if kn Ì¸= n, the term involving mnkn in the above expression
equals zero. Therefore, the only terms which survive are those for which Î¸ = n or
in other words, those for which kn = n. Therefore, the above expression reduces to
a
X
(k1,Â·Â·Â·,knâˆ’1)
sgnnâˆ’1 (k1, Â· Â· Â·knâˆ’1) m1k1 Â· Â· Â· m(nâˆ’1)knâˆ’1 = a det (A) .
To get the assertion in the situation of 4.25 use Corollary 4.23 and 4.26 to write
det (M) = det
Â¡
M T Â¢
= det
ÂµÂµ
AT
0
âˆ—
a
Â¶Â¶
= a det
Â¡
AT Â¢
= a det (A) .
This proves the lemma.
In terms of the theory of determinants, arguably the most important idea is
that of Laplace expansion along a row or a column. This will follow from the above
deï¬nition of a determinant.
Deï¬nition 4.30 Let A = (aij) be an n Ã— n matrix. Then a new matrix called
the cofactor matrix, cof (A) is deï¬ned by cof (A) = (cij) where to obtain cij delete
the ith row and the jth column of A, take the determinant of the (n âˆ’1) Ã— (n âˆ’1)
matrix which results, (This is called the ijth minor of A. ) and then multiply this
number by (âˆ’1)i+j. To make the formulas easier to remember, cof (A)ij will denote
the ijth entry of the cofactor matrix.

4.5.
THE MATHEMATICAL THEORY OF DETERMINANTS
69
The following is the main result. Earlier this was given as a deï¬nition and the
outrageous totally unjustiï¬ed assertion was made that the same number would be
obtained by expanding the determinant along any row or column. The following
theorem proves this assertion.
Theorem 4.31 Let A be an n Ã— n matrix where n â‰¥2. Then
det (A) =
n
X
j=1
aij cof (A)ij =
n
X
i=1
aij cof (A)ij .
(4.27)
The ï¬rst formula consists of expanding the determinant along the ith row and the
second expands the determinant along the jth column.
Proof: Let (ai1, Â· Â· Â·, ain) be the ith row of A. Let Bj be the matrix obtained
from A by leaving every row the same except the ith row which in Bj equals
(0, Â· Â· Â·, 0, aij, 0, Â· Â· Â·, 0) . Then by Corollary 4.24,
det (A) =
n
X
j=1
det (Bj)
Denote by Aij the (n âˆ’1) Ã— (n âˆ’1) matrix obtained by deleting the ith row and
the jth column of A. Thus cof (A)ij â‰¡(âˆ’1)i+j det
Â¡
AijÂ¢
. At this point, recall that
from Proposition 4.21, when two rows or two columns in a matrix, M, are switched,
this results in multiplying the determinant of the old matrix by âˆ’1 to get the
determinant of the new matrix. Therefore, by Lemma 4.29,
det (Bj)
=
(âˆ’1)nâˆ’j (âˆ’1)nâˆ’i det
ÂµÂµ
Aij
âˆ—
0
aij
Â¶Â¶
=
(âˆ’1)i+j det
ÂµÂµ
Aij
âˆ—
0
aij
Â¶Â¶
= aij cof (A)ij .
Therefore,
det (A) =
n
X
j=1
aij cof (A)ij
which is the formula for expanding det (A) along the ith row. Also,
det (A)
=
det
Â¡
AT Â¢
=
n
X
j=1
aT
ij cof
Â¡
AT Â¢
ij
=
n
X
j=1
aji cof (A)ji
which is the formula for expanding det (A) along the ith column. This proves the
theorem.
Note that this gives an easy way to write a formula for the inverse of an n Ã— n
matrix.

70
SOME IMPORTANT LINEAR ALGEBRA
Theorem 4.32 Aâˆ’1 exists if and only if det(A) Ì¸= 0. If det(A) Ì¸= 0, then Aâˆ’1 =
Â¡
aâˆ’1
ij
Â¢
where
aâˆ’1
ij = det(A)âˆ’1 cof (A)ji
for cof (A)ij the ijth cofactor of A.
Proof: By Theorem 4.31 and letting (air) = A, if det (A) Ì¸= 0,
n
X
i=1
air cof (A)ir det(A)âˆ’1 = det(A) det(A)âˆ’1 = 1.
Now consider
n
X
i=1
air cof (A)ik det(A)âˆ’1
when k Ì¸= r. Replace the kth column with the rth column to obtain a matrix, Bk
whose determinant equals zero by Corollary 4.24. However, expanding this matrix
along the kth column yields
0 = det (Bk) det (A)âˆ’1 =
n
X
i=1
air cof (A)ik det (A)âˆ’1
Summarizing,
n
X
i=1
air cof (A)ik det (A)âˆ’1 = Î´rk.
Using the other formula in Theorem 4.31, and similar reasoning,
n
X
j=1
arj cof (A)kj det (A)âˆ’1 = Î´rk
This proves that if det (A) Ì¸= 0, then Aâˆ’1 exists with Aâˆ’1 =
Â¡
aâˆ’1
ij
Â¢
, where
aâˆ’1
ij = cof (A)ji det (A)âˆ’1 .
Now suppose Aâˆ’1 exists. Then by Theorem 4.28,
1 = det (I) = det
Â¡
AAâˆ’1Â¢
= det (A) det
Â¡
Aâˆ’1Â¢
so det (A) Ì¸= 0. This proves the theorem.
The next corollary points out that if an n Ã— n matrix, A has a right or a left
inverse, then it has an inverse.
Corollary 4.33 Let A be an nÃ—n matrix and suppose there exists an nÃ—n matrix,
B such that BA = I. Then Aâˆ’1 exists and Aâˆ’1 = B. Also, if there exists C an
n Ã— n matrix such that AC = I, then Aâˆ’1 exists and Aâˆ’1 = C.

4.5.
THE MATHEMATICAL THEORY OF DETERMINANTS
71
Proof: Since BA = I, Theorem 4.28 implies
det B det A = 1
and so det A Ì¸= 0. Therefore from Theorem 4.32, Aâˆ’1 exists. Therefore,
Aâˆ’1 = (BA) Aâˆ’1 = B
Â¡
AAâˆ’1Â¢
= BI = B.
The case where CA = I is handled similarly.
The conclusion of this corollary is that left inverses, right inverses and inverses
are all the same in the context of n Ã— n matrices.
Theorem 4.32 says that to ï¬nd the inverse, take the transpose of the cofactor
matrix and divide by the determinant.
The transpose of the cofactor matrix is
called the adjugate or sometimes the classical adjoint of the matrix A. It is an
abomination to call it the adjoint although you do sometimes see it referred to in
this way. In words, Aâˆ’1 is equal to one over the determinant of A times the adjugate
matrix of A.
In case you are solving a system of equations, Ax = y for x, it follows that if
Aâˆ’1 exists,
x =
Â¡
Aâˆ’1A
Â¢
x = Aâˆ’1 (Ax) = Aâˆ’1y
thus solving the system. Now in the case that Aâˆ’1 exists, there is a formula for
Aâˆ’1 given above. Using this formula,
xi =
n
X
j=1
aâˆ’1
ij yj =
n
X
j=1
1
det (A) cof (A)ji yj.
By the formula for the expansion of a determinant along a column,
xi =
1
det (A) det
ï£«
ï£¬
ï£­
âˆ—
Â· Â· Â·
y1
Â· Â· Â·
âˆ—
...
...
...
âˆ—
Â· Â· Â·
yn
Â· Â· Â·
âˆ—
ï£¶
ï£·
ï£¸,
where here the ith column of A is replaced with the column vector, (y1 Â· Â· Â· Â·, yn)T ,
and the determinant of this modiï¬ed matrix is taken and divided by det (A). This
formula is known as Cramerâ€™s rule.
Deï¬nition 4.34 A matrix M, is upper triangular if Mij = 0 whenever i > j. Thus
such a matrix equals zero below the main diagonal, the entries of the form Mii as
shown.
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
âˆ—
âˆ—
Â· Â· Â·
âˆ—
0
âˆ—
...
...
...
...
...
âˆ—
0
Â· Â· Â·
0
âˆ—
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£¸
A lower triangular matrix is deï¬ned similarly as a matrix for which all entries above
the main diagonal are equal to zero.

72
SOME IMPORTANT LINEAR ALGEBRA
With this deï¬nition, here is a simple corollary of Theorem 4.31.
Corollary 4.35 Let M be an upper (lower) triangular matrix. Then det (M) is
obtained by taking the product of the entries on the main diagonal.
Deï¬nition 4.36 A submatrix of a matrix A is the rectangular array of numbers
obtained by deleting some rows and columns of A. Let A be an m Ã— n matrix. The
determinant rank of the matrix equals r where r is the largest number such that
some r Ã— r submatrix of A has a non zero determinant. The row rank is deï¬ned
to be the dimension of the span of the rows. The column rank is deï¬ned to be the
dimension of the span of the columns.
Theorem 4.37 If A has determinant rank, r, then there exist r rows of the matrix
such that every other row is a linear combination of these r rows.
Proof: Suppose the determinant rank of A = (aij) equals r. If rows and columns
are interchanged, the determinant rank of the modiï¬ed matrix is unchanged. Thus
rows and columns can be interchanged to produce an r Ã— r matrix in the upper left
corner of the matrix which has non zero determinant. Now consider the r+1Ã—r+1
matrix, M,
ï£«
ï£¬
ï£¬
ï£¬
ï£­
a11
Â· Â· Â·
a1r
a1p
...
...
...
ar1
Â· Â· Â·
arr
arp
al1
Â· Â· Â·
alr
alp
ï£¶
ï£·
ï£·
ï£·
ï£¸
where C will denote the r Ã— r matrix in the upper left corner which has non zero
determinant. I claim det (M) = 0.
There are two cases to consider in verifying this claim. First, suppose p > r.
Then the claim follows from the assumption that A has determinant rank r. On the
other hand, if p < r, then the determinant is zero because there are two identical
columns. Expand the determinant along the last column and divide by det (C) to
obtain
alp = âˆ’
r
X
i=1
cof (M)ip
det (C) aip.
Now note that cof (M)ip does not depend on p. Therefore the above sum is of the
form
alp =
r
X
i=1
miaip
which shows the lth row is a linear combination of the ï¬rst r rows of A. Since l is
arbitrary, this proves the theorem.
Corollary 4.38 The determinant rank equals the row rank.

4.5.
THE MATHEMATICAL THEORY OF DETERMINANTS
73
Proof: From Theorem 4.37, the row rank is no larger than the determinant
rank. Could the row rank be smaller than the determinant rank? If so, there exist
p rows for p < r such that the span of these p rows equals the row space. But this
implies that the r Ã— r submatrix whose determinant is nonzero also has row rank
no larger than p which is impossible if its determinant is to be nonzero because at
least one row is a linear combination of the others.
Corollary 4.39 If A has determinant rank, r, then there exist r columns of the
matrix such that every other column is a linear combination of these r columns.
Also the column rank equals the determinant rank.
Proof: This follows from the above by considering AT . The rows of AT are the
columns of A and the determinant rank of AT and A are the same. Therefore, from
Corollary 4.38, column rank of A = row rank of AT = determinant rank of AT =
determinant rank of A.
The following theorem is of fundamental importance and ties together many of
the ideas presented above.
Theorem 4.40 Let A be an n Ã— n matrix. Then the following are equivalent.
1. det (A) = 0.
2. A, AT are not one to one.
3. A is not onto.
Proof: Suppose det (A) = 0.
Then the determinant rank of A = r < n.
Therefore, there exist r columns such that every other column is a linear com-
bination of these columns by Theorem 4.37.
In particular, it follows that for
some m, the mth column is a linear combination of all the others. Thus letting
A =
Â¡ a1
Â· Â· Â·
am
Â· Â· Â·
an
Â¢
where the columns are denoted by ai, there exists
scalars, Î±i such that
am =
X
kÌ¸=m
Î±kak.
Now consider the column vector, x â‰¡
Â¡
Î±1
Â· Â· Â·
âˆ’1
Â· Â· Â·
Î±n
Â¢T . Then
Ax = âˆ’am +
X
kÌ¸=m
Î±kak = 0.
Since also A0 = 0, it follows A is not one to one. Similarly, AT is not one to one
by the same argument applied to AT . This veriï¬es that 1.) implies 2.).
Now suppose 2.). Then since AT is not one to one, it follows there exists x Ì¸= 0
such that
AT x = 0.
Taking the transpose of both sides yields
xT A = 0

74
SOME IMPORTANT LINEAR ALGEBRA
where the 0 is a 1 Ã— n matrix or row vector. Now if Ay = x, then
|x|2 = xT (Ay) =
Â¡
xT A
Â¢
y = 0y = 0
contrary to x Ì¸= 0. Consequently there can be no y such that Ay = x and so A is
not onto. This shows that 2.) implies 3.).
Finally, suppose 3.).
If 1.) does not hold, then det (A) Ì¸= 0 but then from
Theorem 4.32 Aâˆ’1 exists and so for every y âˆˆFn there exists a unique x âˆˆFn such
that Ax = y. In fact x = Aâˆ’1y. Thus A would be onto contrary to 3.). This shows
3.) implies 1.) and proves the theorem.
Corollary 4.41 Let A be an n Ã— n matrix. Then the following are equivalent.
1. det(A) Ì¸= 0.
2. A and AT are one to one.
3. A is onto.
Proof: This follows immediately from the above theorem.
4.6
Exercises
1. Let m < n and let A be an m Ã— n matrix. Show that A is not one to one.
Hint: Consider the n Ã— n matrix, A1 which is of the form
A1 â‰¡
Âµ
A
0
Â¶
where the 0 denotes an (n âˆ’m) Ã— n matrix of zeros. Thus det A1 = 0 and so
A1 is not one to one. Now observe that A1x is the vector,
A1x =
Âµ
Ax
0
Â¶
which equals zero if and only if Ax = 0.
4.7
The Cayley Hamilton Theorem
Deï¬nition 4.42 Let A be an nÃ—n matrix. The characteristic polynomial is deï¬ned
as
pA (t) â‰¡det (tI âˆ’A)
and the solutions to pA (t) = 0 are called eigenvalues. For A a matrix and p (t) =
tn + anâˆ’1tnâˆ’1 + Â· Â· Â· + a1t + a0, denote by p (A) the matrix deï¬ned by
p (A) â‰¡An + anâˆ’1Anâˆ’1 + Â· Â· Â· + a1A + a0I.
The explanation for the last term is that A0 is interpreted as I, the identity matrix.

4.7.
THE CAYLEY HAMILTON THEOREM
75
The Cayley Hamilton theorem states that every matrix satisï¬es its characteristic
equation, that equation deï¬ned by PA (t) = 0. It is one of the most important
theorems in linear algebra. The following lemma will help with its proof.
Lemma 4.43 Suppose for all |Î»| large enough,
A0 + A1Î» + Â· Â· Â· + AmÎ»m = 0,
where the Ai are n Ã— n matrices. Then each Ai = 0.
Proof: Multiply by Î»âˆ’m to obtain
A0Î»âˆ’m + A1Î»âˆ’m+1 + Â· Â· Â· + Amâˆ’1Î»âˆ’1 + Am = 0.
Now let |Î»| â†’âˆžto obtain Am = 0. With this, multiply by Î» to obtain
A0Î»âˆ’m+1 + A1Î»âˆ’m+2 + Â· Â· Â· + Amâˆ’1 = 0.
Now let |Î»| â†’âˆžto obtain Amâˆ’1 = 0. Continue multiplying by Î» and letting
Î» â†’âˆžto obtain that all the Ai = 0. This proves the lemma.
With the lemma, here is a simple corollary.
Corollary 4.44 Let Ai and Bi be n Ã— n matrices and suppose
A0 + A1Î» + Â· Â· Â· + AmÎ»m = B0 + B1Î» + Â· Â· Â· + BmÎ»m
for all |Î»| large enough. Then Ai = Bi for all i. Consequently if Î» is replaced by
any n Ã— n matrix, the two sides will be equal. That is, for C any n Ã— n matrix,
A0 + A1C + Â· Â· Â· + AmCm = B0 + B1C + Â· Â· Â· + BmCm.
Proof: Subtract and use the result of the lemma.
With this preparation, here is a relatively easy proof of the Cayley Hamilton
theorem.
Theorem 4.45 Let A be an n Ã— n matrix and let p (Î») â‰¡det (Î»I âˆ’A) be the
characteristic polynomial. Then p (A) = 0.
Proof: Let C (Î») equal the transpose of the cofactor matrix of (Î»I âˆ’A) for |Î»|
large. (If |Î»| is large enough, then Î» cannot be in the ï¬nite list of eigenvalues of A
and so for such Î», (Î»I âˆ’A)âˆ’1 exists.) Therefore, by Theorem 4.32
C (Î») = p (Î») (Î»I âˆ’A)âˆ’1 .
Note that each entry in C (Î») is a polynomial in Î» having degree no more than nâˆ’1.
Therefore, collecting the terms,
C (Î») = C0 + C1Î» + Â· Â· Â· + Cnâˆ’1Î»nâˆ’1

76
SOME IMPORTANT LINEAR ALGEBRA
for Cj some n Ã— n matrix. It follows that for all |Î»| large enough,
(A âˆ’Î»I)
Â¡
C0 + C1Î» + Â· Â· Â· + Cnâˆ’1Î»nâˆ’1Â¢
= p (Î») I
and so Corollary 4.44 may be used. It follows the matrix coeï¬ƒcients corresponding
to equal powers of Î» are equal on both sides of this equation. Therefore, if Î» is
replaced with A, the two sides will be equal. Thus
0 = (A âˆ’A)
Â¡
C0 + C1A + Â· Â· Â· + Cnâˆ’1Anâˆ’1Â¢
= p (A) I = p (A) .
This proves the Cayley Hamilton theorem.
4.8
An Identity Of Cauchy
There is a very interesting identity for determinants due to Cauchy.
Theorem 4.46 The following identity holds.
Y
i,j
(ai + bj)
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
1
a1+b1
Â· Â· Â·
1
a1+bn
...
...
1
an+b1
Â· Â· Â·
1
an+bn
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
=
Y
j<i
(ai âˆ’aj) (bi âˆ’bj) .
(4.28)
Proof: What is the exponent of a2 on the right? It occurs in (a2 âˆ’a1) and in
(am âˆ’a2) for m > 2. Therefore, there are exactly n âˆ’1 factors which contain a2.
Therefore, a2 has an exponent of n âˆ’1. Similarly, each ak is raised to the n âˆ’1
power and the same holds for the bk as well. Therefore, the right side of 4.28 is of
the form
canâˆ’1
1
anâˆ’1
2
Â· Â· Â· anâˆ’1
n
bnâˆ’1
1
Â· Â· Â· bnâˆ’1
n
where c is some constant. Now consider the left side of 4.28.
This is of the form
1
n!
Y
i,j
(ai + bj)
X
i1Â·Â·Â·in,j1,Â·Â·Â·jn
sgn (i1 Â· Â· Â· in) sgn (j1 Â· Â· Â· jn) Â·
1
ai1 + bj1
1
ai2 + bj2
Â· Â· Â·
1
ain + bjn
.
For a given i1 Â· Â· Â· in, j1, Â· Â· Â·jn, let
S (i1 Â· Â· Â· in, j1, Â· Â· Â·jn) â‰¡{(i1, j1) , (i2, j2) Â· Â·Â·, (in, jn)} .
This equals
1
n!
X
i1Â·Â·Â·in,j1,Â·Â·Â·jn
sgn (i1 Â· Â· Â· in) sgn (j1 Â· Â· Â· jn)
Y
(i,j)/âˆˆ{(i1,j1),(i2,j2)Â·Â·Â·,(in,jn)}
(ai + bj)

4.9.
BLOCK MULTIPLICATION OF MATRICES
77
where you can assume the ik are all distinct and the jk are also all distinct because
otherwise sgn will produce a 0. Therefore, in
Y
(i,j)/âˆˆ{(i1,j1),(i2,j2)Â·Â·Â·,(in,jn)}
(ai + bj) ,
there are exactly n âˆ’1 factors which contain ak for each k and similarly, there are
exactly n âˆ’1 factors which contain bk for each k. Therefore, the left side of 4.28 is
of the form
danâˆ’1
1
anâˆ’1
2
Â· Â· Â· anâˆ’1
n
bnâˆ’1
1
Â· Â· Â· bnâˆ’1
n
and it remains to verify that c = d. Using the properties of determinants, the left
side of 4.28 is of the form
Y
iÌ¸=j
(ai + bj)
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
1
a1+b1
a1+b2
Â· Â· Â·
a1+b1
a1+bn
a2+b2
a2+b1
1
Â· Â· Â·
a2+b2
a2+bn
...
...
...
...
an+bn
an+b1
an+bn
an+b2
Â· Â· Â·
1
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Let ak â†’âˆ’bk. Then this converges to Q
iÌ¸=j (âˆ’bi + bj) . The right side of 4.28
converges to
Y
j<i
(âˆ’bi + bj) (bi âˆ’bj) =
Y
iÌ¸=j
(âˆ’bi + bj) .
Therefore, d = c and this proves the identity.
4.9
Block Multiplication Of Matrices
Suppose A is a matrix of the form
ï£«
ï£¬
ï£­
A11
Â· Â· Â·
A1m
...
...
...
Ar1
Â· Â· Â·
Arm
ï£¶
ï£·
ï£¸
(4.29)
where Aij is a si Ã—pj matrix where si does not depend on j and pj does not depend
on i. Such a matrix is called a block matrix. Let n = P
j pj and k = P
i si so A
is an k Ã— n matrix. What is Ax where x âˆˆFn? From the process of multiplying a
matrix times a vector, the following lemma follows.
Lemma 4.47 Let A be an m Ã— n block matrix as in 4.29 and let x âˆˆFn. Then Ax
is of the form
Ax =
ï£«
ï£¬
ï£­
P
j A1jxj
...
P
j Arjxj
ï£¶
ï£·
ï£¸
where x = (x1, Â· Â· Â·, xm)T and xi âˆˆFpi.

78
SOME IMPORTANT LINEAR ALGEBRA
Suppose also that B is a l Ã— k block matrix of the form
ï£«
ï£¬
ï£­
B11
Â· Â· Â·
B1p
...
...
...
Bm1
Â· Â· Â·
Bmp
ï£¶
ï£·
ï£¸
(4.30)
and that for all i, j, it makes sense to multiply BisAsj for all s âˆˆ{1, Â· Â· Â·, m}. (That
is the two matrices are conformable.) and that for each s, BisAsj is the same size
so that it makes sense to write P
s BisAsj.
Theorem 4.48 Let B be an l Ã—k block matrix as in 4.30 and let A be a k Ã—n block
matrix as in 4.29 such that Bis is conformable with Asj and each product, BisAsj
is of the same size so they can be added. Then BA is a l Ã— n block matrix having
rp blocks such that the ijth block is of the form
X
s
BisAsj.
(4.31)
Proof: Let Bis be a qi Ã—ps matrix and Asj be a ps Ã—rj matrix. Also let x âˆˆFn
and let x = (x1, Â· Â· Â·, xm)T and xi âˆˆFri so it makes sense to multiply Asjxj. Then
from the associative law of matrix multiplication and Lemma 4.47 applied twice,
(BA) x = B (Ax)
=
ï£«
ï£¬
ï£­
B11
Â· Â· Â·
B1p
...
...
...
Bm1
Â· Â· Â·
Bmp
ï£¶
ï£·
ï£¸
ï£«
ï£¬
ï£­
P
j A1jxj
...
P
j Arjxj
ï£¶
ï£·
ï£¸
=
ï£«
ï£¬
ï£­
P
s
P
j B1sAsjxj
...
P
s
P
j BmsAsjxj
ï£¶
ï£·
ï£¸=
ï£«
ï£¬
ï£­
P
j (P
s B1sAsj) xj
...
P
j (P
s BmsAsj) xj
ï£¶
ï£·
ï£¸.
By Lemma 4.47, this shows that (BA) x equals the block matrix whose ijth entry is
given by 4.31 times x. Since x is an arbitrary vector in Fn, this proves the theorem.
The message of this theorem is that you can formally multiply block matrices as
though the blocks were numbers. You just have to pay attention to the preservation
of order.
This simple idea of block multiplication turns out to be very useful later. For now
here is an interesting and signiï¬cant application. In this theorem, pM (t) denotes
the polynomial, det (tI âˆ’M) . Thus the zeros of this polynomial are the eigenvalues
of the matrix, M.
Theorem 4.49 Let A be an mÃ—n matrix and let B be an nÃ—m matrix for m â‰¤n.
Then
pBA (t) = tnâˆ’mpAB (t) ,
so the eigenvalues of BA and AB are the same including multiplicities except that
BA has n âˆ’m extra zero eigenvalues.

4.10.
EXERCISES
79
Proof: Use block multiplication to write
Âµ
AB
0
B
0
Â¶ Âµ
I
A
0
I
Â¶
=
Âµ
AB
ABA
B
BA
Â¶
Âµ
I
A
0
I
Â¶ Âµ
0
0
B
BA
Â¶
=
Âµ
AB
ABA
B
BA
Â¶
.
Therefore,
Âµ
I
A
0
I
Â¶âˆ’1 Âµ
AB
0
B
0
Â¶ Âµ
I
A
0
I
Â¶
=
Âµ
0
0
B
BA
Â¶
By Problem 11 of Page 80, it follows that
Âµ
0
0
B
BA
Â¶
and
Âµ
AB
0
B
0
Â¶
have the
same characteristic polynomials. Therefore, noting that BA is an n Ã— n matrix and
AB is an m Ã— m matrix,
tm det (tI âˆ’BA) = tn det (tI âˆ’AB)
and so det (tI âˆ’BA) = pBA (t) = tnâˆ’m det (tI âˆ’AB) = tnâˆ’mpAB (t) . This proves
the theorem.
4.10
Exercises
1. Show that matrix multiplication is associative. That is, (AB) C = A (BC) .
2. Show the inverse of a matrix, if it exists, is unique. Thus if AB = BA = I,
then B = Aâˆ’1.
3. In the proof of Theorem 4.32 it was claimed that det (I) = 1. Here I = (Î´ij) .
Prove this assertion. Also prove Corollary 4.35.
4. Let v1, Â·Â·Â·, vn be vectors in Fn and let M (v1, Â· Â· Â·, vn) denote the matrix whose
ith column equals vi. Deï¬ne
d (v1, Â· Â· Â·, vn) â‰¡det (M (v1, Â· Â· Â·, vn)) .
Prove that d is linear in each variable, (multilinear), that
d (v1, Â· Â· Â·, vi, Â· Â· Â·, vj, Â· Â· Â·, vn) = âˆ’d (v1, Â· Â· Â·, vj, Â· Â· Â·, vi, Â· Â· Â·, vn) ,
(4.32)
and
d (e1, Â· Â· Â·, en) = 1
(4.33)
where here ej is the vector in Fn which has a zero in every position except
the jth position in which it has a one.
5. Suppose f : Fn Ã— Â· Â· Â· Ã— Fn â†’F satisï¬es 4.32 and 4.33 and is linear in each
variable. Show that f = d.

80
SOME IMPORTANT LINEAR ALGEBRA
6. Show that if you replace a row (column) of an nÃ—n matrix A with itself added
to some multiple of another row (column) then the new matrix has the same
determinant as the original one.
7. If A = (aij) , show det (A) = P
(k1,Â·Â·Â·,kn) sgn (k1, Â· Â· Â·, kn) ak11 Â· Â· Â· aknn.
8. Use the result of Problem 6 to evaluate by hand the determinant
det
ï£«
ï£¬
ï£¬
ï£­
1
2
3
2
âˆ’6
3
2
3
5
2
2
3
3
4
6
4
ï£¶
ï£·
ï£·
ï£¸.
9. Find the inverse if it exists of the matrix,
ï£«
ï£­
et
cos t
sin t
et
âˆ’sin t
cos t
et
âˆ’cos t
âˆ’sin t
ï£¶
ï£¸.
10. Let Ly = y(n)+anâˆ’1 (x) y(nâˆ’1)+Â·Â·Â·+a1 (x) yâ€²+a0 (x) y where the ai are given
continuous functions deï¬ned on a closed interval, (a, b) and y is some function
which has n derivatives so it makes sense to write Ly. Suppose Lyk = 0 for
k = 1, 2, Â· Â· Â·, n. The Wronskian of these functions, yi is deï¬ned as
W (y1, Â· Â· Â·, yn) (x) â‰¡det
ï£«
ï£¬
ï£¬
ï£¬
ï£­
y1 (x)
Â· Â· Â·
yn (x)
yâ€²
1 (x)
Â· Â· Â·
yâ€²
n (x)
...
...
y(nâˆ’1)
1
(x)
Â· Â· Â·
y(nâˆ’1)
n
(x)
ï£¶
ï£·
ï£·
ï£·
ï£¸
Show that for W (x) = W (y1, Â· Â· Â·, yn) (x) to save space,
W â€² (x) = det
ï£«
ï£¬
ï£¬
ï£¬
ï£­
y1 (x)
Â· Â· Â·
yn (x)
yâ€²
1 (x)
Â· Â· Â·
yâ€²
n (x)
...
...
y(n)
1
(x)
Â· Â· Â·
y(n)
n
(x)
ï£¶
ï£·
ï£·
ï£·
ï£¸.
Now use the diï¬€erential equation, Ly = 0 which is satisï¬ed by each of these
functions, yi and properties of determinants presented above to verify that
W â€² +anâˆ’1 (x) W = 0. Give an explicit solution of this linear diï¬€erential equa-
tion, Abelâ€™s formula, and use your answer to verify that the Wronskian of
these solutions to the equation, Ly = 0 either vanishes identically on (a, b) or
never.
11. Two n Ã— n matrices, A and B, are similar if B = Sâˆ’1AS for some invertible
n Ã— n matrix, S. Show that if two matrices are similar, they have the same
characteristic polynomials.

4.11.
SHURâ€™S THEOREM
81
12. Suppose the characteristic polynomial of an n Ã— n matrix, A is of the form
tn + anâˆ’1tnâˆ’1 + Â· Â· Â· + a1t + a0
and that a0 Ì¸= 0. Find a formula Aâˆ’1 in terms of powers of the matrix, A.
Show that Aâˆ’1 exists if and only if a0 Ì¸= 0.
13. In constitutive modeling of the stress and strain tensors, one sometimes con-
siders sums of the form Pâˆž
k=0 akAk where A is a 3Ã—3 matrix. Show using
the Cayley Hamilton theorem that if such a thing makes any sense, you can
always obtain it as a ï¬nite sum having no more than n terms.
4.11
Shurâ€™s Theorem
Every matrix is related to an upper triangular matrix in a particularly signiï¬cant
way. This is Shurâ€™s theorem and it is the most important theorem in the spectral
theory of matrices.
Lemma 4.50 Let
{x1, Â· Â· Â·, xn}
be a basis for Fn. Then there exists an orthonormal basis for Fn,
{u1, Â· Â· Â·, un}
which has the property that for each k â‰¤n,
span (x1, Â· Â· Â·, xk) = span (u1, Â· Â· Â·, uk) .
Proof: Let {x1, Â· Â· Â·, xn} be a basis for Fn. Let u1 â‰¡x1/ |x1| . Thus for k = 1,
span (u1) = span (x1) and {u1} is an orthonormal set. Now suppose for some k < n,
u1, Â· Â· Â·, uk have been chosen such that (uj Â· ul) = Î´jl and span (x1, Â· Â· Â·, xk) =
span (u1, Â· Â· Â·, uk). Then deï¬ne
uk+1 â‰¡
xk+1 âˆ’Pk
j=1 (xk+1 Â· uj) uj
Â¯Â¯Â¯xk+1 âˆ’Pk
j=1 (xk+1 Â· uj) uj
Â¯Â¯Â¯
,
(4.34)
where the denominator is not equal to zero because the xj form a basis and so
xk+1 /âˆˆspan (x1, Â· Â· Â·, xk) = span (u1, Â· Â· Â·, uk)
Thus by induction,
uk+1 âˆˆspan (u1, Â· Â· Â·, uk, xk+1) = span (x1, Â· Â· Â·, xk, xk+1) .
Also, xk+1 âˆˆspan (u1, Â· Â· Â·, uk, uk+1) which is seen easily by solving 4.34 for xk+1
and it follows
span (x1, Â· Â· Â·, xk, xk+1) = span (u1, Â· Â· Â·, uk, uk+1) .

82
SOME IMPORTANT LINEAR ALGEBRA
If l â‰¤k,
(uk+1 Â· ul)
=
C
ï£«
ï£­(xk+1 Â· ul) âˆ’
k
X
j=1
(xk+1 Â· uj) (uj Â· ul)
ï£¶
ï£¸
=
C
ï£«
ï£­(xk+1 Â· ul) âˆ’
k
X
j=1
(xk+1 Â· uj) Î´lj
ï£¶
ï£¸
=
C ((xk+1 Â· ul) âˆ’(xk+1 Â· ul)) = 0.
The vectors, {uj}n
j=1 , generated in this way are therefore an orthonormal basis
because each vector has unit length.
The process by which these vectors were generated is called the Gram Schmidt
process. Recall the following deï¬nition.
Deï¬nition 4.51 An n Ã— n matrix, U, is unitary if UU âˆ—= I = U âˆ—U where U âˆ—is
deï¬ned to be the transpose of the conjugate of U.
Theorem 4.52 Let A be an n Ã— n matrix. Then there exists a unitary matrix, U
such that
U âˆ—AU = T,
(4.35)
where T is an upper triangular matrix having the eigenvalues of A on the main
diagonal listed according to multiplicity as roots of the characteristic equation.
Proof:
Let v1 be a unit eigenvector for A . Then there exists Î»1 such that
Av1 = Î»1v1, |v1| = 1.
Extend {v1} to a basis and then use Lemma 4.50 to obtain {v1, Â· Â· Â·, vn}, an or-
thonormal basis in Fn. Let U0 be a matrix whose ith column is vi. Then from the
above, it follows U0 is unitary. Then U âˆ—
0 AU0 is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£­
Î»1
âˆ—
Â· Â· Â·
âˆ—
0
...
A1
0
ï£¶
ï£·
ï£·
ï£·
ï£¸
where A1 is an n âˆ’1 Ã— n âˆ’1 matrix. Repeat the process for the matrix, A1 above.
There exists a unitary matrix eU1 such that eU âˆ—
1 A1 eU1 is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£­
Î»2
âˆ—
Â· Â· Â·
âˆ—
0
...
A2
0
ï£¶
ï£·
ï£·
ï£·
ï£¸.

4.11.
SHURâ€™S THEOREM
83
Now let U1 be the n Ã— n matrix of the form
Âµ 1
0
0
eU1
Â¶
.
This is also a unitary matrix because by block multiplication,
Âµ 1
0
0
eU1
Â¶âˆ—Âµ 1
0
0
eU1
Â¶
=
Âµ 1
0
0
eU âˆ—
1
Â¶ Âµ 1
0
0
eU1
Â¶
=
Âµ 1
0
0
eU âˆ—
1 eU1
Â¶
=
Âµ
1
0
0
I
Â¶
Then using block multiplication, U âˆ—
1 U âˆ—
0 AU0U1 is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
Î»1
âˆ—
âˆ—
Â· Â· Â·
âˆ—
0
Î»2
âˆ—
Â· Â· Â·
âˆ—
0
0
...
...
A2
0
0
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
where A2 is an n âˆ’2 Ã— n âˆ’2 matrix. Continuing in this way, there exists a unitary
matrix, U given as the product of the Ui in the above construction such that
U âˆ—AU = T
where T is some upper triangular matrix. Since the matrix is upper triangular, the
characteristic equation is Qn
i=1 (Î» âˆ’Î»i) where the Î»i are the diagonal entries of T.
Therefore, the Î»i are the eigenvalues.
What if A is a real matrix and you only want to consider real unitary matrices?
Theorem 4.53 Let A be a real n Ã— n matrix. Then there exists a real unitary
matrix, Q and a matrix T of the form
T =
ï£«
ï£¬
ï£­
P1
Â· Â· Â·
âˆ—
...
...
0
Pr
ï£¶
ï£·
ï£¸
(4.36)
where Pi equals either a real 1 Ã— 1 matrix or Pi equals a real 2 Ã— 2 matrix having
two complex eigenvalues of A such that QT AQ = T. The matrix, T is called the real
Schur form of the matrix A.
Proof: Suppose
Av1 = Î»1v1, |v1| = 1
where Î»1 is real. Then let {v1, Â· Â· Â·, vn} be an orthonormal basis of vectors in Rn.
Let Q0 be a matrix whose ith column is vi. Then Qâˆ—
0AQ0 is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£­
Î»1
âˆ—
Â· Â· Â·
âˆ—
0
...
A1
0
ï£¶
ï£·
ï£·
ï£·
ï£¸

84
SOME IMPORTANT LINEAR ALGEBRA
where A1 is a real n âˆ’1 Ã— n âˆ’1 matrix. This is just like the proof of Theorem 4.52
up to this point.
Now in case Î»1 = Î± + iÎ², it follows since A is real that v1 = z1 + iw1 and
that v1 = z1 âˆ’iw1 is an eigenvector for the eigenvalue, Î± âˆ’iÎ². Here z1 and w1
are real vectors. It is clear that {z1, w1} is an independent set of vectors in Rn.
Indeed,{v1, v1} is an independent set and it follows span (v1, v1) = span (z1, w1) .
Now using the Gram Schmidt theorem in Rn, there exists {u1, u2} , an orthonormal
set of real vectors such that span (u1, u2) = span (v1, v1) . Now let {u1, u2, Â· Â· Â·, un}
be an orthonormal basis in Rn and let Q0 be a unitary matrix whose ith column
is ui. Then Auj are both in span (u1, u2) for j = 1, 2 and so uT
k Auj = 0 whenever
k â‰¥3. It follows that Qâˆ—
0AQ0 is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
âˆ—
âˆ—
Â· Â· Â·
âˆ—
âˆ—
âˆ—
0
...
A1
0
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
where A1 is now an n âˆ’2 Ã— n âˆ’2 matrix. In this case, ï¬nd eQ1 an n âˆ’2 Ã— n âˆ’2
matrix to put A1 in an appropriate form as above and come up with A2 either an
n âˆ’4 Ã— n âˆ’4 matrix or an n âˆ’3 Ã— n âˆ’3 matrix. Then the only other diï¬€erence is
to let
Q1 =
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
1
0
0
Â· Â· Â·
0
0
1
0
Â· Â· Â·
0
0
0
...
...
eQ1
0
0
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
thus putting a 2 Ã— 2 identity matrix in the upper left corner rather than a one.
Repeating this process with the above modiï¬cation for the case of a complex eigen-
value leads eventually to 4.36 where Q is the product of real unitary matrices Qi
above. Finally,
Î»I âˆ’T =
ï£«
ï£¬
ï£­
Î»I1 âˆ’P1
Â· Â· Â·
âˆ—
...
...
0
Î»Ir âˆ’Pr
ï£¶
ï£·
ï£¸
where Ik is the 2 Ã— 2 identity matrix in the case that Pk is 2 Ã— 2 and is the num-
ber 1 in the case where Pk is a 1 Ã— 1 matrix. Now, it follows that det (Î»I âˆ’T) =
Qr
k=1 det (Î»Ik âˆ’Pk) . Therefore, Î» is an eigenvalue of T if and only if it is an eigen-
value of some Pk. This proves the theorem since the eigenvalues of T are the same
as those of A because they have the same characteristic polynomial due to the
similarity of A and T.
Deï¬nition 4.54 When a linear transformation, A, mapping a linear space, V to
V has a basis of eigenvectors, the linear transformation is called non defective.

4.11.
SHURâ€™S THEOREM
85
Otherwise it is called defective. An nÃ—n matrix, A, is called normal if AAâˆ—= Aâˆ—A.
An important class of normal matrices is that of the Hermitian or self adjoint
matrices. An n Ã— n matrix, A is self adjoint or Hermitian if A = Aâˆ—.
The next lemma is the basis for concluding that every normal matrix is unitarily
similar to a diagonal matrix.
Lemma 4.55 If T is upper triangular and normal, then T is a diagonal matrix.
Proof: Since T is normal, T âˆ—T = TT âˆ—. Writing this in terms of components
and using the description of the adjoint as the transpose of the conjugate, yields
the following for the ikth entry of T âˆ—T = TT âˆ—.
X
j
tijtâˆ—
jk =
X
j
tijtkj =
X
j
tâˆ—
ijtjk =
X
j
tjitjk.
Now use the fact that T is upper triangular and let i = k = 1 to obtain the following
from the above.
X
j
|t1j|2 =
X
j
|tj1|2 = |t11|2
You see, tj1 = 0 unless j = 1 due to the assumption that T is upper triangular.
This shows T is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£­
âˆ—
0
Â· Â· Â·
0
0
âˆ—
Â· Â· Â·
âˆ—
...
...
...
...
0
Â· Â· Â·
0
âˆ—
ï£¶
ï£·
ï£·
ï£·
ï£¸.
Now do the same thing only this time take i = k = 2 and use the result just
established. Thus, from the above,
X
j
|t2j|2 =
X
j
|tj2|2 = |t22|2 ,
showing that t2j = 0 if j > 2 which means T has the form
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
âˆ—
0
0
Â· Â· Â·
0
0
âˆ—
0
Â· Â· Â·
0
0
0
âˆ—
Â· Â· Â·
âˆ—
...
...
...
...
...
0
0
0
0
âˆ—
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
.
Next let i = k = 3 and obtain that T looks like a diagonal matrix in so far as the
ï¬rst 3 rows and columns are concerned. Continuing in this way it follows T is a
diagonal matrix.
Theorem 4.56 Let A be a normal matrix. Then there exists a unitary matrix, U
such that U âˆ—AU is a diagonal matrix.

86
SOME IMPORTANT LINEAR ALGEBRA
Proof: From Theorem 4.52 there exists a unitary matrix, U such that U âˆ—AU
equals an upper triangular matrix. The theorem is now proved if it is shown that
the property of being normal is preserved under unitary similarity transformations.
That is, verify that if A is normal and if B = U âˆ—AU, then B is also normal. But
this is easy.
Bâˆ—B
=
U âˆ—Aâˆ—UU âˆ—AU = U âˆ—Aâˆ—AU
=
U âˆ—AAâˆ—U = U âˆ—AUU âˆ—Aâˆ—U = BBâˆ—.
Therefore, U âˆ—AU is a normal and upper triangular matrix and by Lemma 4.55 it
must be a diagonal matrix. This proves the theorem.
Corollary 4.57 If A is Hermitian, then all the eigenvalues of A are real and there
exists an orthonormal basis of eigenvectors.
Proof: Since A is normal, there exists unitary, U such that U âˆ—AU = D, a
diagonal matrix whose diagonal entries are the eigenvalues of A. Therefore, Dâˆ—=
U âˆ—Aâˆ—U = U âˆ—AU = D showing D is real.
Finally, let
U =
Â¡
u1
u2
Â· Â· Â·
un
Â¢
where the ui denote the columns of U and
D =
ï£«
ï£¬
ï£­
Î»1
0
...
0
Î»n
ï£¶
ï£·
ï£¸
The equation, U âˆ—AU = D implies
AU
=
Â¡
Au1
Au2
Â· Â· Â·
Aun
Â¢
=
UD =
Â¡
Î»1u1
Î»2u2
Â· Â· Â·
Î»nun
Â¢
where the entries denote the columns of AU and UD respectively. Therefore, Aui =
Î»iui and since the matrix is unitary, the ijth entry of U âˆ—U equals Î´ij and so
Î´ij = uT
i uj = uT
i uj = ui Â· uj.
This proves the corollary because it shows the vectors {ui} form an orthonormal
basis.
Corollary 4.58 If A is a real symmetric matrix, then A is Hermitian and there
exists a real unitary matrix, U such that U T AU = D where D is a diagonal matrix.
Proof: This follows from Theorem 4.53 and Corollary 4.57.

4.12.
THE RIGHT POLAR DECOMPOSITION
87
4.12
The Right Polar Decomposition
This is on the right polar decomposition.
Theorem 4.59 Let F be an m Ã— n matrix where m â‰¥n. Then there exists an
m Ã— n matrix R and a n Ã— n matrix U such that
F = RU, U = U âˆ—,
all eigenvalues of U are non negative,
U 2 = F âˆ—F, Râˆ—R = I,
and |Rx| = |x|.
Proof: (F âˆ—F)âˆ—= F âˆ—F and so F âˆ—F is self adjoint. Also,
(F âˆ—Fx, x) = (Fx, Fx) â‰¥0.
Therefore, all eigenvalues of F âˆ—F must be nonnegative because if F âˆ—Fx = Î»x for
x Ì¸= 0,
0 â‰¤(Fx, Fx) = (F âˆ—Fx, x) = (Î»x, x) = Î» |x|2 .
From linear algebra, there exists Q such that Qâˆ—Q = I and F âˆ—F = Qâˆ—DQ where
D is a diagonal matrix of the form
ï£«
ï£¬
ï£­
Î»1
Â· Â· Â·
0
...
...
...
0
Â· Â· Â·
Î»n
ï£¶
ï£·
ï£¸
where each Î»i â‰¥0. Therefore, you can consider
D1/2 â‰¡
ï£«
ï£¬
ï£­
Î»1/2
1
Â· Â· Â·
0
...
...
...
0
Â· Â· Â·
Î»1/2
n
ï£¶
ï£·
ï£¸â‰¡
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
Âµ1
Â· Â· Â·
Â· Â· Â·
Â· Â· Â·
Â· Â· Â·
0
0
...
v
...
Âµr
...
...
0
...
...
...
...
0
Â· Â· Â·
Â· Â· Â·
Â· Â· Â·
Â· Â· Â·
0
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
(4.37)
where the Âµi are the positive eigenvalues of D1/2.
Let U â‰¡Qâˆ—D1/2Q. This matrix is the square root of F âˆ—F because
Â³
Qâˆ—D1/2Q
Â´ Â³
Qâˆ—D1/2Q
Â´
= Qâˆ—D1/2D1/2Q = Qâˆ—DQ = F âˆ—F
It is self adjoint because
Â¡
Qâˆ—D1/2Q
Â¢âˆ—= Qâˆ—D1/2Qâˆ—âˆ—= Qâˆ—D1/2Q.

88
SOME IMPORTANT LINEAR ALGEBRA
Let {x1, Â· Â· Â·, xr} be an orthogonal set of eigenvectors such that Uxi = Âµixi and
normalize so that
{Âµ1x1, Â· Â· Â·, Âµrxr} = {Ux1, Â· Â· Â·, Uxr}
is an orthonormal set of vectors. By 4.37 it follows rank (U) = r and so
{Ux1, Â· Â· Â·, Uxr}
is also an orthonormal basis for U (Fn).
Then {Fxr, Â· Â· Â·, Fxr} is also an orthonormal set of vectors in Fm because
(Fxi, Fxj) = (F âˆ—Fxi, xj) =
Â¡
U 2xi, xj
Â¢
= (Uxi, Uxj) = Î´ij.
Let
{Ux1, Â· Â· Â·, Uxr, yr+1, Â· Â· Â·, yn}
be an orthonormal basis for Fn and let
{Fxr, Â· Â· Â·, Fxr, zr+1, Â· Â· Â·, zn, Â· Â· Â·, zm}
be an orthonormal basis for Fm. Then a typical vector of Fn is of the form
r
X
k=1
akUxk +
n
X
j=r+1
bjyj.
Deï¬ne
R
ï£«
ï£­
r
X
k=1
akUxk +
n
X
j=r+1
bjyj
ï£¶
ï£¸â‰¡
r
X
k=1
akFxk +
n
X
j=r+1
bjzj
Then since
{Ux1, Â· Â· Â·, Uxr, yr+1, Â· Â· Â·, yn}
and
{Fxr, Â· Â· Â·, Fxr, zr+1, Â· Â· Â·, zn, Â· Â· Â·, zm}
are orthonormal,
Â¯Â¯Â¯Â¯Â¯Â¯
R
ï£«
ï£­
r
X
k=1
akUxk +
n
X
j=r+1
bjyj
ï£¶
ï£¸
Â¯Â¯Â¯Â¯Â¯Â¯
2
=
Â¯Â¯Â¯Â¯Â¯Â¯
r
X
k=1
akFxk +
n
X
j=r+1
bjzj
Â¯Â¯Â¯Â¯Â¯Â¯
2
=
r
X
k=1
|ak|2 +
n
X
j=r+1
|bj|2
=
Â¯Â¯Â¯Â¯Â¯Â¯
r
X
k=1
akUxk +
n
X
j=r+1
bjyj
Â¯Â¯Â¯Â¯Â¯Â¯
2
.
Therefore, R preserves distances.

4.12.
THE RIGHT POLAR DECOMPOSITION
89
Letting x âˆˆFn,
Ux =
r
X
k=1
akUxk
(4.38)
for some unique choice of scalars, ak because {Ux1, Â· Â· Â·, Uxr} is a basis for U (Fn).
Therefore,
RUx = R
Ãƒ r
X
k=1
akUxk
!
â‰¡
r
X
k=1
akFxk = F
Ãƒ r
X
k=1
akxk
!
.
Is F (Pr
k=1 akxk) = F (x)? Using 4.38,
F âˆ—F
Ãƒ r
X
k=1
akxk âˆ’x
!
=
U 2
Ãƒ r
X
k=1
akxk âˆ’x
!
=
r
X
k=1
akÂµ2
kxk âˆ’U (Ux)
=
r
X
k=1
akÂµ2
kxk âˆ’U
Ãƒ r
X
k=1
akUxk
!
=
r
X
k=1
akÂµ2
kxk âˆ’U
Ãƒ r
X
k=1
akÂµkxk
!
= 0.
Therefore,
Â¯Â¯Â¯Â¯Â¯F
Ãƒ r
X
k=1
akxk âˆ’x
!Â¯Â¯Â¯Â¯Â¯
2
=
Ãƒ
F
Ãƒ r
X
k=1
akxk âˆ’x
!
, F
Ãƒ r
X
k=1
akxk âˆ’x
!!
=
Ãƒ
F âˆ—F
Ãƒ r
X
k=1
akxk âˆ’x
!
,
Ãƒ r
X
k=1
akxk âˆ’x
!!
= 0
and so F (Pr
k=1 akxk) = F (x) as hoped. Thus RU = F on Fn.
Since R preserves distances,
|x|2 + |y|2 + 2 (x, y) = |x + y|2 = |R (x + y)|2
= |x|2 + |y|2 + 2 (Rx,Ry).
Therefore,
(x, y) = (Râˆ—Rx, y)
for all x, y and so Râˆ—R = I as claimed. This proves the theorem.

90
SOME IMPORTANT LINEAR ALGEBRA

Multi-variable Calculus
5.1
Continuous Functions
In what follows, F will denote either R or C. It turns out it is more eï¬ƒcient to not
make a distinction. However, the main interest is in R so if you like, you can think
R whenever you see F.
5.1.1
Distance In Fn
It is necessary to give a generalization of the dot product for vectors in Cn. This
deï¬nition reduces to the usual one in the case the components of the vector are real.
Deï¬nition 5.1 Let x, y âˆˆCn. Thus x = (x1, Â· Â· Â·, xn) where each xk âˆˆC and a
similar formula holding for y. Then the dot product of these two vectors is deï¬ned
to be
x Â· y â‰¡
X
j
xjyj â‰¡x1y1 + Â· Â· Â· + xnyn.
Notice how you put the conjugate on the entries of the vector, y. It makes no
diï¬€erence if the vectors happen to be real vectors but with complex vectors you
must do it this way. The reason for this is that when you take the dot product of a
vector with itself, you want to get the square of the length of the vector, a positive
number.
Placing the conjugate on the components of y in the above deï¬nition
assures this will take place. Thus
x Â· x =
X
j
xjxj =
X
j
|xj|2 â‰¥0.
If you didnâ€™t place a conjugate as in the above deï¬nition, things wouldnâ€™t work out
correctly. For example,
(1 + i)2 + 22 = 4 + 2i
and this is not a positive number.
The following properties of the dot product follow immediately from the deï¬ni-
tion and you should verify each of them.
Properties of the dot product:
91

92
MULTI-VARIABLE CALCULUS
1. u Â· v = v Â· u.
2. If a, b are numbers and u, v, z are vectors then (au + bv) Â· z = a (u Â· z) +
b (v Â· z) .
3. u Â· u â‰¥0 and it equals 0 if and only if u = 0.
The norm is deï¬ned in the usual way.
Deï¬nition 5.2 For x âˆˆCn,
|x| â‰¡
Ãƒ n
X
k=1
|xk|2
!1/2
= (x Â· x)1/2
Here is a fundamental inequality called the Cauchy Schwarz inequality which
is stated here in Cn. First here is a simple lemma.
Lemma 5.3 If z âˆˆC there exists Î¸ âˆˆC such that Î¸z = |z| and |Î¸| = 1.
Proof: Let Î¸ = 1 if z = 0 and otherwise, let Î¸ =
z
|z|. Recall that for z =
x + iy, z = x âˆ’iy and zz = |z|2.
Theorem 5.4 (Cauchy Schwarz)The following inequality holds for xi and yi âˆˆC.
|(x Â· y)| =
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
xiyi
Â¯Â¯Â¯Â¯Â¯ â‰¤
Ãƒ n
X
i=1
|xi|2
!1/2 Ãƒ n
X
i=1
|yi|2
!1/2
= |x| |y|
(5.1)
Proof: Let Î¸ âˆˆC such that |Î¸| = 1 and
Î¸
n
X
i=1
xiyi =
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
xiyi
Â¯Â¯Â¯Â¯Â¯
Thus
Î¸
n
X
i=1
xiyi =
n
X
i=1
xi
Â¡
Î¸yi
Â¢
=
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
xiyi
Â¯Â¯Â¯Â¯Â¯ .
Consider p (t) â‰¡Pn
i=1
Â¡
xi + tÎ¸yi
Â¢ Â³
xi + tÎ¸yi
Â´
where t âˆˆR.
0
â‰¤
p (t) =
n
X
i=1
|xi|2 + 2t Re
Ãƒ
Î¸
n
X
i=1
xiyi
!
+ t2
n
X
i=1
|yi|2
=
|x|2 + 2t
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
xiyi
Â¯Â¯Â¯Â¯Â¯ + t2 |y|2

5.1.
CONTINUOUS FUNCTIONS
93
If |y| = 0 then 5.1 is obviously true because both sides equal zero.
Therefore,
assume |y| Ì¸= 0 and then p (t) is a polynomial of degree two whose graph opens
up. Therefore, it either has no zeroes, two zeros or one repeated zero. If it has two
zeros, the above inequality must be violated because in this case the graph must
dip below the x axis. Therefore, it either has no zeros or exactly one. From the
quadratic formula this happens exactly when
4
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
xiyi
Â¯Â¯Â¯Â¯Â¯
2
âˆ’4 |x|2 |y|2 â‰¤0
and so
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
xiyi
Â¯Â¯Â¯Â¯Â¯ â‰¤|x| |y|
as claimed. This proves the inequality.
By analogy to the case of Rn, length or magnitude of vectors in Cn can be
deï¬ned.
Deï¬nition 5.5 Let z âˆˆCn. Then |z| â‰¡(z Â· z)1/2. Also numbers in F will often be
referred to as scalars.
Theorem 5.6 For length deï¬ned in Deï¬nition 5.5, the following hold.
|z| â‰¥0 and |z| = 0 if and only if z = 0
(5.2)
If Î± is a scalar, |Î±z| = |Î±| |z|
(5.3)
|z + w| â‰¤|z| + |w| .
(5.4)
Proof: The ï¬rst two claims are left as exercises. To establish the third,
|z + w|2
=
(z + w, z + w)
=
z Â· z + w Â· w + w Â· z + z Â· w
=
|z|2 + |w|2 + 2 Re w Â· z
â‰¤
|z|2 + |w|2 + 2 |w Â· z|
â‰¤
|z|2 + |w|2 + 2 |w| |z| = (|z| + |w|)2 .
The main diï¬€erence between Cn and Rn is that the scalars are complex numbers.
Deï¬nition 5.7 Suppose you have a vector space, V and for z, w âˆˆV and Î± a scalar
a norm is a way of measuring distance or magnitude which satisï¬es the properties
5.2 - 5.4. Thus a norm is something which does the following.
||z|| â‰¥0 and ||z|| = 0 if and only if z = 0
(5.5)
If Î± is a scalar, ||Î±z|| = |Î±| ||z||
(5.6)
||z + w|| â‰¤||z|| + ||w|| .
(5.7)
Here is is understood that for all z âˆˆV, ||z|| âˆˆ[0, âˆž).
Note that |Â·| provides a norm on Fn from the above.

94
MULTI-VARIABLE CALCULUS
5.2
Open And Closed Sets
Eventually, one must consider functions which are deï¬ned on subsets of Fn and
their properties. The next deï¬nition will end up being quite important. It describe
a type of subset of Fn with the property that if x is in this set, then so is y whenever
y is close enough to x.
Deï¬nition 5.8 Let U âŠ†Fn. U is an open set if whenever x âˆˆU, there exists
r > 0 such that B (x, r) âŠ†U. More generally, if U is any subset of Fn, x âˆˆU is
an interior point of U if there exists r > 0 such that x âˆˆB (x, r) âŠ†U. In other
words U is an open set exactly when every point of U is an interior point of U.
If there is something called an open set, surely there should be something called
a closed set and here is the deï¬nition of one.
Deï¬nition 5.9 A subset, C, of Fn is called a closed set if Fn \ C is an open set.
They symbol, Fn \ C denotes everything in Fn which is not in C. It is also called
the complement of C. The symbol, SC is a short way of writing Fn \ S.
To illustrate this deï¬nition, consider the following picture.
qx
U
B(x, r)
You see in this picture how the edges are dotted. This is because an open set,
can not include the edges or the set would fail to be open. For example, consider
what would happen if you picked a point out on the edge of U in the above picture.
Every open ball centered at that point would have in it some points which are
outside U. Therefore, such a point would violate the above deï¬nition. You also see
the edges of B (x, r) dotted suggesting that B (x, r) ought to be an open set. This
is intuitively clear but does require a proof. This will be done in the next theorem
and will give examples of open sets. Also, you can see that if x is close to the edge
of U, you might have to take r to be very small.
It is roughly the case that open sets donâ€™t have their skins while closed sets do.
Here is a picture of a closed set, C.

5.2.
OPEN AND CLOSED SETS
95
B(x, r)
x
q
C
Note that x /âˆˆC and since Fn \ C is open, there exists a ball, B (x, r) contained
entirely in Fn \ C. If you look at Fn \ C, what would be its skin? It canâ€™t be in
Fn \C and so it must be in C. This is a rough heuristic explanation of what is going
on with these deï¬nitions. Also note that Fn and âˆ…are both open and closed. Here
is why. If x âˆˆâˆ…, then there must be a ball centered at x which is also contained in
âˆ…. This must be considered to be true because there is nothing in âˆ…so there can be
no example to show it false1. Therefore, from the deï¬nition, it follows âˆ…is open.
It is also closed because if x /âˆˆâˆ…, then B (x, 1) is also contained in Fn \ âˆ…= Fn.
Therefore, âˆ…is both open and closed. From this, it follows Fn is also both open and
closed.
Theorem 5.10 Let x âˆˆFn and let r â‰¥0. Then B (x, r) is an open set. Also,
D (x, r) â‰¡{y âˆˆFn : |y âˆ’x| â‰¤r}
is a closed set.
Proof: Suppose y âˆˆB (x,r) . It is necessary to show there exists r1 > 0 such
that B (y, r1) âŠ†B (x, r) . Deï¬ne r1 â‰¡r âˆ’|x âˆ’y| . Then if |z âˆ’y| < r1, it follows
from the above triangle inequality that
|z âˆ’x|
=
|z âˆ’y + y âˆ’x|
â‰¤
|z âˆ’y| + |y âˆ’x|
<
r1 + |y âˆ’x| = r âˆ’|x âˆ’y| + |y âˆ’x| = r.
Note that if r = 0 then B (x, r) = âˆ…, the empty set. This is because if y âˆˆFn,
|x âˆ’y| â‰¥0 and so y /âˆˆB (x, 0) . Since âˆ…has no points in it, it must be open because
1To a mathematician, the statment: Whenever a pig is born with wings it can ï¬‚y must be taken
as true. We do not consider biological or aerodynamic considerations in such statements. There
is no such thing as a winged pig and therefore, all winged pigs must be superb ï¬‚yers since there
can be no example of one which is not. On the other hand we would also consider the statement:
Whenever a pig is born with wings it canâ€™t possibly ï¬‚y, as equally true. The point is, you can say
anything you want about the elements of the empty set and no one can gainsay your statement.
Therefore, such statements are considered as true by default. You may say this is a very strange
way of thinking about truth and ultimately this is because mathematics is not about truth. It is
more about consistency and logic.

96
MULTI-VARIABLE CALCULUS
every point in it, (There are none.) satisï¬es the desired property of being an interior
point.
Now suppose y /âˆˆD (x, r) . Then |x âˆ’y| > r and deï¬ning Î´ â‰¡|x âˆ’y| âˆ’r, it
follows that if z âˆˆB (y, Î´) , then by the triangle inequality,
|x âˆ’z|
â‰¥
|x âˆ’y| âˆ’|y âˆ’z| > |x âˆ’y| âˆ’Î´
=
|x âˆ’y| âˆ’(|x âˆ’y| âˆ’r) = r
and this shows that B (y, Î´) âŠ†Fn \ D (x, r) . Since y was an arbitrary point in
Fn \ D (x, r) , it follows Fn \ D (x, r) is an open set which shows from the deï¬nition
that D (x, r) is a closed set as claimed.
A picture which is descriptive of the conclusion of the above theorem which also
implies the manner of proof is the following.
y
x
q
q
6
-
r
r1
B(x, r)
y
x
q
q
6
-
r
r1
D(x, r)
5.3
Continuous Functions
With the above deï¬nition of the norm in Fp, it becomes possible to deï¬ne continuity.
Deï¬nition 5.11 A function f : D (f) âŠ†Fp â†’Fq is continuous at x âˆˆD (f) if for
each Îµ > 0 there exists Î´ > 0 such that whenever y âˆˆD (f) and
|y âˆ’x| < Î´
it follows that
|f (x) âˆ’f (y)| < Îµ.
f is continuous if it is continuous at every point of D (f) .
Note the total similarity to the scalar valued case.
5.3.1
Suï¬ƒcient Conditions For Continuity
The next theorem is a fundamental result which will allow us to worry less about
the Îµ Î´ deï¬nition of continuity.
Theorem 5.12 The following assertions are valid.
1. The function, af + bg is continuous at x whenever f, g are continuous at x
âˆˆD (f) âˆ©D (g) and a, b âˆˆF.

5.4.
EXERCISES
97
2. If f is continuous at x, f (x) âˆˆD (g) âŠ†Fp, and g is continuous at f (x) ,then
g â—¦f is continuous at x.
3. If f = (f1, Â· Â· Â·, fq) : D (f) â†’Fq, then f is continuous if and only if each fk is
a continuous F valued function.
4. The function f : Fp â†’F, given by f (x) = |x| is continuous.
The proof of this theorem is in the last section of this chapter. Its conclusions
are not surprising. For example the ï¬rst claim says that (af + bg) (y) is close to
(af + bg) (x) when y is close to x provided the same can be said about f and g.
For the second claim, if y is close to x, f (x) is close to f (y) and so by continuity
of g at f (x), g (f (y)) is close to g (f (x)) . To see the third claim is likely, note that
closeness in Fp is the same as closeness in each coordinate. The fourth claim is
immediate from the triangle inequality.
For functions deï¬ned on Fn, there is a notion of polynomial just as there is for
functions deï¬ned on R.
Deï¬nition 5.13 Let Î± be an n dimensional multi-index. This means
Î± = (Î±1, Â· Â· Â·, Î±n)
where each Î±i is a natural number or zero. Also, let
|Î±| â‰¡
n
X
i=1
|Î±i|
The symbol, xÎ±,means
xÎ± â‰¡xÎ±1
1 xÎ±2
2 Â· Â· Â· xÎ±n
3 .
An n dimensional polynomial of degree m is a function of the form
p (x) =
X
|Î±|â‰¤m
dÎ±xÎ±.
where the dÎ± are complex or real numbers.
The above theorem implies that polynomials are all continuous.
5.4
Exercises
1. Let f (t) = (t, sin t) . Show f is continuous at every point t.
2. Suppose |f (x) âˆ’f (y)| â‰¤K |x âˆ’y| where K is a constant. Show that f is
everywhere continuous.
Functions satisfying such an inequality are called
Lipschitz functions.
3. Suppose |f (x) âˆ’f (y)| â‰¤K |x âˆ’y|Î± where K is a constant and Î± âˆˆ(0, 1).
Show that f is everywhere continuous.

98
MULTI-VARIABLE CALCULUS
4. Suppose f : F3 â†’F is given by f (x) = 3x1x2 + 2x2
3. Use Theorem 5.12 to
verify that f is continuous. Hint: You should ï¬rst verify that the function,
Ï€k : F3 â†’F given by Ï€k (x) = xk is a continuous function.
5. Generalize the previous problem to the case where f : Fq â†’F is a polynomial.
6. State and prove a theorem which involves quotients of functions encountered
in the previous problem.
5.5
Limits Of A Function
As in the case of scalar valued functions of one variable, a concept closely related to
continuity is that of the limit of a function. The notion of limit of a function makes
sense at points, x, which are limit points of D (f) and this concept is deï¬ned next.
Deï¬nition 5.14 Let A âŠ†Fm be a set. A point, x, is a limit point of A if B (x, r)
contains inï¬nitely many points of A for every r > 0.
Deï¬nition 5.15 Let f : D (f) âŠ†Fp â†’Fq be a function and let x be a limit point
of D (f) . Then
lim
yâ†’x f (y) = L
if and only if the following condition holds. For all Îµ > 0 there exists Î´ > 0 such
that if
0 < |y âˆ’x| < Î´, and y âˆˆD (f)
then,
|L âˆ’f (y)| < Îµ.
Theorem 5.16 If limyâ†’x f (y) = L and limyâ†’x f (y) = L1, then L = L1.
Proof: Let Îµ > 0 be given. There exists Î´ > 0 such that if 0 < |y âˆ’x| < Î´ and
y âˆˆD (f) , then
|f (y) âˆ’L| < Îµ, |f (y) âˆ’L1| < Îµ.
Pick such a y. There exists one because x is a limit point of D (f) . Then
|L âˆ’L1| â‰¤|L âˆ’f (y)| + |f (y) âˆ’L1| < Îµ + Îµ = 2Îµ.
Since Îµ > 0 was arbitrary, this shows L = L1.
As in the case of functions of one variable, one can deï¬ne what it means for
limyâ†’x f (x) = Â±âˆž.
Deï¬nition 5.17 If f (x) âˆˆF, limyâ†’x f (x) = âˆžif for every number l, there exists
Î´ > 0 such that whenever |y âˆ’x| < Î´ and y âˆˆD (f) , then f (x) > l.
The following theorem is just like the one variable version presented earlier.

5.5.
LIMITS OF A FUNCTION
99
Theorem 5.18 Suppose limyâ†’x f (y) = L and limyâ†’x g (y) = K where K, L âˆˆFq.
Then if a, b âˆˆF,
lim
yâ†’x (af (y) + bg (y)) = aL + bK,
(5.8)
lim
yâ†’x f Â· g (y) = LK
(5.9)
and if g is scalar valued with limyâ†’x g (y) = K Ì¸= 0,
lim
yâ†’x f (y) g (y) = LK.
(5.10)
Also, if h is a continuous function deï¬ned near L, then
lim
yâ†’x h â—¦f (y) = h (L) .
(5.11)
Suppose limyâ†’x f (y) = L. If |f (y) âˆ’b| â‰¤r for all y suï¬ƒciently close to x, then
|L âˆ’b| â‰¤r also.
Proof: The proof of 5.8 is left for you. It is like a corresponding theorem for
continuous functions. Now 5.9is to be veriï¬ed. Let Îµ > 0 be given. Then by the
triangle inequality,
|f Â· g (y) âˆ’L Â· K| â‰¤|fg (y) âˆ’f (y) Â· K| + |f (y) Â· K âˆ’L Â· K|
â‰¤|f (y)| |g (y) âˆ’K| + |K| |f (y) âˆ’L| .
There exists Î´1 such that if 0 < |y âˆ’x| < Î´1 and y âˆˆD (f) , then
|f (y) âˆ’L| < 1,
and so for such y, the triangle inequality implies, |f (y)| < 1 + |L| . Therefore, for
0 < |y âˆ’x| < Î´1,
|f Â· g (y) âˆ’L Â· K| â‰¤(1 + |K| + |L|) [|g (y) âˆ’K| + |f (y) âˆ’L|] .
(5.12)
Now let 0 < Î´2 be such that if y âˆˆD (f) and 0 < |x âˆ’y| < Î´2,
|f (y) âˆ’L| <
Îµ
2 (1 + |K| + |L|), |g (y) âˆ’K| <
Îµ
2 (1 + |K| + |L|).
Then letting 0 < Î´ â‰¤min (Î´1, Î´2) , it follows from 5.12 that
|f Â· g (y) âˆ’L Â· K| < Îµ
and this proves 5.9.
The proof of 5.10 is left to you.
Consider 5.11. Since h is continuous near L, it follows that for Îµ > 0 given,
there exists Î· > 0 such that if |y âˆ’L| < Î·, then
|h (y) âˆ’h (L)| < Îµ

100
MULTI-VARIABLE CALCULUS
Now since limyâ†’x f (y) = L, there exists Î´ > 0 such that if 0 < |y âˆ’x| < Î´, then
|f (y) âˆ’L| < Î·.
Therefore, if 0 < |y âˆ’x| < Î´,
|h (f (y)) âˆ’h (L)| < Îµ.
It only remains to verify the last assertion. Assume |f (y) âˆ’b| â‰¤r for all y
close enough to x. It is required to show that |L âˆ’b| â‰¤r. If this is not true, then
|L âˆ’b| > r. Consider B (L, |L âˆ’b| âˆ’r) . Since L is the limit of f, it follows f (y) âˆˆ
B (L, |L âˆ’b| âˆ’r) whenever y âˆˆD (f) is close enough to x. Thus, by the triangle
inequality,
|f (y) âˆ’L| < |L âˆ’b| âˆ’r
and so
r
<
|L âˆ’b| âˆ’|f (y) âˆ’L| â‰¤||b âˆ’L| âˆ’|f (y) âˆ’L||
â‰¤
|b âˆ’f (y)| ,
a contradiction to the assumption that |b âˆ’f (y)| â‰¤r.
Theorem 5.19 For f : D (f) â†’Fq and x âˆˆD (f) a limit point of D (f) , f is
continuous at x if and only if
lim
yâ†’x f (y) = f (x) .
Proof: First suppose f is continuous at x a limit point of D (f) . Then for
every Îµ > 0 there exists Î´ > 0 such that if |y âˆ’x| < Î´ and y âˆˆD (f) , then
|f (x) âˆ’f (y)| < Îµ. In particular, this holds if 0 < |x âˆ’y| < Î´ and this is just the
deï¬nition of the limit. Hence f (x) = limyâ†’x f (y) .
Next suppose x is a limit point of D (f) and limyâ†’x f (y) = f (x) . This means
that if Îµ > 0 there exists Î´ > 0 such that for 0 < |x âˆ’y| < Î´ and y âˆˆD (f) , it follows
|f (y) âˆ’f (x)| < Îµ. However, if y = x, then |f (y) âˆ’f (x)| = |f (x) âˆ’f (x)| = 0 and
so whenever y âˆˆD (f) and |x âˆ’y| < Î´, it follows |f (x) âˆ’f (y)| < Îµ, showing f is
continuous at x.
The following theorem is important.
Theorem 5.20 Suppose f : D (f) â†’Fq. Then for x a limit point of D (f) ,
lim
yâ†’x f (y) = L
(5.13)
if and only if
lim
yâ†’x fk (y) = Lk
(5.14)
where f (y) â‰¡(f1 (y) , Â· Â· Â·, fp (y)) and L â‰¡(L1, Â· Â· Â·, Lp) .

5.5.
LIMITS OF A FUNCTION
101
Proof: Suppose 5.13. Then letting Îµ > 0 be given there exists Î´ > 0 such that
if 0 < |y âˆ’x| < Î´, it follows
|fk (y) âˆ’Lk| â‰¤|f (y) âˆ’L| < Îµ
which veriï¬es 5.14.
Now suppose 5.14 holds. Then letting Îµ > 0 be given, there exists Î´k such that
if 0 < |y âˆ’x| < Î´k, then
|fk (y) âˆ’Lk| <
Îµ
âˆšp.
Let 0 < Î´ < min (Î´1, Â· Â· Â·, Î´p) . Then if 0 < |y âˆ’x| < Î´, it follows
|f (y) âˆ’L|
=
Ãƒ p
X
k=1
|fk (y) âˆ’Lk|2
!1/2
<
Ãƒ p
X
k=1
Îµ2
p
!1/2
= Îµ.
This proves the theorem.
This theorem shows it suï¬ƒces to consider the components of a vector valued
function when computing the limit.
Example 5.21 Find lim(x,y)â†’(3,1)
Â³
x2âˆ’9
xâˆ’3 , y
Â´
.
It is clear that lim(x,y)â†’(3,1)
x2âˆ’9
xâˆ’3 = 6 and lim(x,y)â†’(3,1) y = 1. Therefore, this
limit equals (6, 1) .
Example 5.22 Find lim(x,y)â†’(0,0)
xy
x2+y2 .
First of all observe the domain of the function is F2 \ {(0, 0)} , every point in F2
except the origin. Therefore, (0, 0) is a limit point of the domain of the function
so it might make sense to take a limit. However, just as in the case of a function
of one variable, the limit may not exist. In fact, this is the case here. To see this,
take points on the line y = 0. At these points, the value of the function equals 0.
Now consider points on the line y = x where the value of the function equals 1/2.
Since arbitrarily close to (0, 0) there are points where the function equals 1/2 and
points where the function has the value 0, it follows there can be no limit. Just
take Îµ = 1/10 for example. You canâ€™t be within 1/10 of 1/2 and also within 1/10
of 0 at the same time.
Note it is necessary to rely on the deï¬nition of the limit much more than in the
case of a function of one variable and it is the case there are no easy ways to do
limit problems for functions of more than one variable. It is what it is and you will
not deal with these concepts without agony.

102
MULTI-VARIABLE CALCULUS
5.6
Exercises
1. Find the following limits if possible
(a) lim(x,y)â†’(0,0)
x2âˆ’y2
x2+y2
(b) lim(x,y)â†’(0,0)
x(x2âˆ’y2)
(x2+y2)
(c) lim(x,y)â†’(0,0) (x2âˆ’y4)
2
(x2+y4)2 Hint: Consider along y = 0 and along x = y2.
(d) lim(x,y)â†’(0,0) x sin
Â³
1
x2+y2
Â´
(e) The limit as (x, y) â†’(1, 2) of the expression
âˆ’2yx2 + 8yx + 34y + 3y3 âˆ’18y2 + 6x2 âˆ’13x âˆ’20 âˆ’xy2 âˆ’x3
âˆ’y2 + 4y âˆ’5 âˆ’x2 + 2x
.
Hint: It might help to write this in terms of the variables (s, t) =
(x âˆ’1, y âˆ’2) .
2. In the deï¬nition of limit, why must x be a limit point of D (f)? Hint: If x
were not a limit point of D (f), show there exists Î´ > 0 such that B (x, Î´)
contains no points of D (f) other than possibly x itself. Argue that 33.3 is a
limit and that so is 22 and 7 and 11. In other words the concept is totally
worthless.
5.7
The Limit Of A Sequence
As in the case of real numbers, one can consider the limit of a sequence of points
in Fp.
Deï¬nition 5.23 A sequence {an}âˆž
n=1 converges to a, and write
lim
nâ†’âˆžan = a or an â†’a
if and only if for every Îµ > 0 there exists nÎµ such that whenever n â‰¥nÎµ ,
|anâˆ’a| < Îµ.
In words the deï¬nition says that given any measure of closeness, Îµ, the terms
of the sequence are eventually all this close to a. There is absolutely no diï¬€erence
between this and the deï¬nition for sequences of numbers other than here bold face
is used to indicate an and a are points in Fp.
Theorem 5.24 If limnâ†’âˆžan = a and limnâ†’âˆžan = a1 then a1 = a.

5.7.
THE LIMIT OF A SEQUENCE
103
Proof: Suppose a1 Ì¸= a. Then let 0 < Îµ < |a1âˆ’a| /2 in the deï¬nition of the limit.
It follows there exists nÎµ such that if n â‰¥nÎµ, then |anâˆ’a| < Îµ and |anâˆ’a1| < Îµ.
Therefore, for such n,
|a1âˆ’a|
â‰¤
|a1âˆ’an| + |anâˆ’a|
<
Îµ + Îµ < |a1âˆ’a| /2 + |a1âˆ’a| /2 = |a1âˆ’a| ,
a contradiction.
As in the case of a vector valued function, it suï¬ƒces to consider the components.
This is the content of the next theorem.
Theorem 5.25 Let an =
Â¡
an
1, Â· Â· Â·, an
p
Â¢
âˆˆFp. Then limnâ†’âˆžan = a â‰¡(a1, Â· Â· Â·, ap)
if and only if for each k = 1, Â· Â· Â·, p,
lim
nâ†’âˆžan
k = ak.
(5.15)
Proof: First suppose limnâ†’âˆžan = a. Then given Îµ > 0 there exists nÎµ such
that if n > nÎµ, then
|an
k âˆ’ak| â‰¤|an âˆ’a| < Îµ
which establishes 5.15.
Now suppose 5.15 holds for each k. Then letting Îµ > 0 be given there exist nk
such that if n > nk,
|an
k âˆ’ak| < Îµ/âˆšp.
Therefore, letting nÎµ > max (n1, Â· Â· Â·, np) , it follows that for n > nÎµ,
|an âˆ’a| =
Ãƒ n
X
k=1
|an
k âˆ’ak|2
!1/2
<
Ãƒ n
X
k=1
Îµ2
p
!1/2
= Îµ,
showing that limnâ†’âˆžan = a. This proves the theorem.
Example 5.26 Let an =
Â³
1
n2+1, 1
n sin (n) ,
n2+3
3n2+5n
Â´
.
It suï¬ƒces to consider the limits of the components according to the following
theorem. Thus the limit is (0, 0, 1/3) .
Theorem 5.27 Suppose {an} and {bn} are sequences and that
lim
nâ†’âˆžan = a and lim
nâ†’âˆžbn = b.
Also suppose x and y are numbers in F. Then
lim
nâ†’âˆžxan + ybn = xa + yb
(5.16)
lim
nâ†’âˆžan Â· bn = a Â· b
(5.17)
If bn âˆˆF, then
anbn â†’ab.

104
MULTI-VARIABLE CALCULUS
Proof: The ï¬rst of these claims is left for you to do. To do the second, let Îµ > 0
be given and choose n1 such that if n â‰¥n1 then
|anâˆ’a| < 1.
Then for such n, the triangle inequality and Cauchy Schwarz inequality imply
|an Â· bnâˆ’a Â· b|
â‰¤
|an Â· bnâˆ’an Â· b| + |an Â· b âˆ’a Â· b|
â‰¤
|an| |bnâˆ’b| + |b| |anâˆ’a|
â‰¤
(|a| + 1) |bnâˆ’b| + |b| |anâˆ’a| .
Now let n2 be large enough that for n â‰¥n2,
|bnâˆ’b| <
Îµ
2 (|a| + 1), and |anâˆ’a| <
Îµ
2 (|b| + 1).
Such a number exists because of the deï¬nition of limit. Therefore, let
nÎµ > max (n1, n2) .
For n â‰¥nÎµ,
|an Â· bnâˆ’a Â· b|
â‰¤
(|a| + 1) |bnâˆ’b| + |b| |anâˆ’a|
<
(|a| + 1)
Îµ
2 (|a| + 1) + |b|
Îµ
2 (|b| + 1) â‰¤Îµ.
This proves 5.16. The proof of 5.17 is entirely similar and is left for you.
5.7.1
Sequences And Completeness
Recall the deï¬nition of a Cauchy sequence.
Deï¬nition 5.28 {an} is a Cauchy sequence if for all Îµ > 0, there exists nÎµ such
that whenever n, m â‰¥nÎµ,
|anâˆ’am| < Îµ.
A sequence is Cauchy means the terms are â€œbunching up to each otherâ€ as m, n
get large.
Theorem 5.29 Let {an}âˆž
n=1 be a Cauchy sequence in Fp. Then there exists a
unique a âˆˆFp such that an â†’a.
Proof: Let an =
Â¡
an
1, Â· Â· Â·, an
p
Â¢
. Then
|an
k âˆ’am
k | â‰¤|an âˆ’am|
which shows for each k = 1, Â· Â· Â·, p, it follows {an
k}âˆž
n=1 is a Cauchy sequence in F.
This requires that both the real and imaginary parts of an
k are Cauchy sequences
in R which means the real and imaginary parts converge in R. This shows {an
k}âˆž
n=1

5.7.
THE LIMIT OF A SEQUENCE
105
must converge to some ak. That is limnâ†’âˆžan
k = ak. Letting a = (a1, Â· Â· Â·, ap) , it
follows from Theorem 5.25 that
lim
nâ†’âˆžan = a.
This proves the theorem.
Theorem 5.30 The set of terms in a Cauchy sequence in Fp is bounded in the
sense that for all n, |an| < M for some M < âˆž.
Proof: Let Îµ = 1 in the deï¬nition of a Cauchy sequence and let n > n1. Then
from the deï¬nition,
|anâˆ’an1| < 1.
It follows that for all n > n1,
|an| < 1 + |an1| .
Therefore, for all n,
|an| â‰¤1 + |an1| +
n1
X
k=1
|ak| .
This proves the theorem.
Theorem 5.31 If a sequence {an} in Fp converges, then the sequence is a Cauchy
sequence.
Proof: Let Îµ > 0 be given and suppose anâ†’a. Then from the deï¬nition of
convergence, there exists nÎµ such that if n > nÎµ, it follows that
|anâˆ’a| < Îµ
2
Therefore, if m, n â‰¥nÎµ + 1, it follows that
|anâˆ’am| â‰¤|anâˆ’a| + |a âˆ’am| < Îµ
2 + Îµ
2 = Îµ
showing that, since Îµ > 0 is arbitrary, {an} is a Cauchy sequence.
5.7.2
Continuity And The Limit Of A Sequence
Just as in the case of a function of one variable, there is a very useful way of thinking
of continuity in terms of limits of sequences found in the following theorem. In
words, it says a function is continuous if it takes convergent sequences to convergent
sequences whenever possible.
Theorem 5.32 A function f : D (f) â†’Fq is continuous at x âˆˆD (f) if and only
if, whenever xnâ†’x with xn âˆˆD (f) , it follows f (xn) â†’f (x) .

106
MULTI-VARIABLE CALCULUS
Proof: Suppose ï¬rst that f is continuous at x and let xnâ†’x. Let Îµ > 0 be given.
By continuity, there exists Î´ > 0 such that if |y âˆ’x| < Î´, then |f (x) âˆ’f (y)| < Îµ.
However, there exists nÎ´ such that if n â‰¥nÎ´, then |xnâˆ’x| < Î´ and so for all n this
large,
|f (x) âˆ’f (xn)| < Îµ
which shows f (xn) â†’f (x) .
Now suppose the condition about taking convergent sequences to convergent
sequences holds at x. Suppose f fails to be continuous at x. Then there exists Îµ > 0
and xn âˆˆD (f) such that |x âˆ’xn| < 1
n , yet
|f (x) âˆ’f (xn)| â‰¥Îµ.
But this is clearly a contradiction because, although xnâ†’x, f (xn) fails to converge
to f (x) . It follows f must be continuous after all. This proves the theorem.
5.8
Properties Of Continuous Functions
Functions of p variables have many of the same properties as functions of one
variable. First there is a version of the extreme value theorem generalizing the one
dimensional case.
Theorem 5.33 Let C be closed and bounded and let f : C â†’R be continuous.
Then f achieves its maximum and its minimum on C. This means there exist,
x1, x2 âˆˆC such that for all x âˆˆC,
f (x1) â‰¤f (x) â‰¤f (x2) .
There is also the long technical theorem about sums and products of continuous
functions. These theorems are proved in the next section.
Theorem 5.34 The following assertions are valid
1. The function, af + bg is continuous at x when f, g are continuous at x âˆˆ
D (f) âˆ©D (g) and a, b âˆˆF.
2. If and f and g are each F valued functions continuous at x, then
fg is
continuous at x. If, in addition to this, g (x) Ì¸= 0, then f/g is continuous at
x.
3. If f is continuous at x, f (x) âˆˆD (g) âŠ†Fp, and g is continuous at f (x) ,then
g â—¦f is continuous at x.
4. If f = (f1, Â· Â· Â·, fq) : D (f) â†’Fq, then f is continuous if and only if each fk is
a continuous F valued function.
5. The function f : Fp â†’F, given by f (x) = |x| is continuous.

5.9.
EXERCISES
107
5.9
Exercises
1. f : D âŠ†Fp â†’Fq is Lipschitz continuous or just Lipschitz for short if there
exists a constant, K such that
|f (x) âˆ’f (y)| â‰¤K |x âˆ’y|
for all x, y âˆˆD. Show every Lipschitz function is uniformly continuous which
means that given Îµ > 0 there exists Î´ > 0 independent of x such that if
|x âˆ’y| < Î´, then |f (x) âˆ’f (y)| < Îµ.
2. If f is uniformly continuous, does it follow that |f| is also uniformly continu-
ous? If |f| is uniformly continuous does it follow that f is uniformly continu-
ous? Answer the same questions with â€œuniformly continuousâ€ replaced with
â€œcontinuousâ€. Explain why.
5.10
Proofs Of Theorems
This section contains the proofs of the theorems which were just stated without
proof.
Theorem 5.35 The following assertions are valid
1. The function, af + bg is continuous at x when f, g are continuous at x âˆˆ
D (f) âˆ©D (g) and a, b âˆˆF.
2. If and f and g are each F valued functions continuous at x, then
fg is
continuous at x. If, in addition to this, g (x) Ì¸= 0, then f/g is continuous at
x.
3. If f is continuous at x, f (x) âˆˆD (g) âŠ†Fp, and g is continuous at f (x) ,then
g â—¦f is continuous at x.
4. If f = (f1, Â· Â· Â·, fq) : D (f) â†’Fq, then f is continuous if and only if each fk is
a continuous F valued function.
5. The function f : Fp â†’F, given by f (x) = |x| is continuous.
Proof: Begin with 1.) Let Îµ > 0 be given. By assumption, there exist Î´1 > 0
such that whenever |x âˆ’y| < Î´1, it follows |f (x) âˆ’f (y)| <
Îµ
2(|a|+|b|+1) and there
exists Î´2 > 0 such that whenever |x âˆ’y| < Î´2, it follows that |g (x) âˆ’g (y)| <
Îµ
2(|a|+|b|+1). Then let 0 < Î´ â‰¤min (Î´1, Î´2) . If |x âˆ’y| < Î´, then everything happens
at once. Therefore, using the triangle inequality
|af (x) + bf (x) âˆ’(ag (y) + bg (y))|

108
MULTI-VARIABLE CALCULUS
â‰¤|a| |f (x) âˆ’f (y)| + |b| |g (x) âˆ’g (y)|
< |a|
Âµ
Îµ
2 (|a| + |b| + 1)
Â¶
+ |b|
Âµ
Îµ
2 (|a| + |b| + 1)
Â¶
< Îµ.
Now begin on 2.) There exists Î´1 > 0 such that if |y âˆ’x| < Î´1, then
|f (x) âˆ’f (y)| < 1.
Therefore, for such y,
|f (y)| < 1 + |f (x)| .
It follows that for such y,
|fg (x) âˆ’fg (y)| â‰¤|f (x) g (x) âˆ’g (x) f (y)| + |g (x) f (y) âˆ’f (y) g (y)|
â‰¤|g (x)| |f (x) âˆ’f (y)| + |f (y)| |g (x) âˆ’g (y)|
â‰¤(1 + |g (x)| + |f (y)|) [|g (x) âˆ’g (y)| + |f (x) âˆ’f (y)|] .
Now let Îµ > 0 be given. There exists Î´2 such that if |x âˆ’y| < Î´2, then
|g (x) âˆ’g (y)| <
Îµ
2 (1 + |g (x)| + |f (y)|),
and there exists Î´3 such that if |x âˆ’y| < Î´3, then
|f (x) âˆ’f (y)| <
Îµ
2 (1 + |g (x)| + |f (y)|)
Now let 0 < Î´ â‰¤min (Î´1, Î´2, Î´3) . Then if |x âˆ’y| < Î´, all the above hold at once and
|fg (x) âˆ’fg (y)| â‰¤
(1 + |g (x)| + |f (y)|) [|g (x) âˆ’g (y)| + |f (x) âˆ’f (y)|]
< (1 + |g (x)| + |f (y)|)
Âµ
Îµ
2 (1 + |g (x)| + |f (y)|) +
Îµ
2 (1 + |g (x)| + |f (y)|)
Â¶
= Îµ.
This proves the ï¬rst part of 2.) To obtain the second part, let Î´1 be as described
above and let Î´0 > 0 be such that for |x âˆ’y| < Î´0,
|g (x) âˆ’g (y)| < |g (x)| /2
and so by the triangle inequality,
âˆ’|g (x)| /2 â‰¤|g (y)| âˆ’|g (x)| â‰¤|g (x)| /2
which implies |g (y)| â‰¥|g (x)| /2, and |g (y)| < 3 |g (x)| /2.

5.10.
PROOFS OF THEOREMS
109
Then if |x âˆ’y| < min (Î´0, Î´1) ,
Â¯Â¯Â¯Â¯
f (x)
g (x) âˆ’f (y)
g (y)
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
f (x) g (y) âˆ’f (y) g (x)
g (x) g (y)
Â¯Â¯Â¯Â¯
â‰¤|f (x) g (y) âˆ’f (y) g (x)|
Â³
|g(x)|2
2
Â´
= 2 |f (x) g (y) âˆ’f (y) g (x)|
|g (x)|2
â‰¤
2
|g (x)|2 [|f (x) g (y) âˆ’f (y) g (y) + f (y) g (y) âˆ’f (y) g (x)|]
â‰¤
2
|g (x)|2 [|g (y)| |f (x) âˆ’f (y)| + |f (y)| |g (y) âˆ’g (x)|]
â‰¤
2
|g (x)|2
Â·3
2 |g (x)| |f (x) âˆ’f (y)| + (1 + |f (x)|) |g (y) âˆ’g (x)|
Â¸
â‰¤
2
|g (x)|2 (1 + 2 |f (x)| + 2 |g (x)|) [|f (x) âˆ’f (y)| + |g (y) âˆ’g (x)|]
â‰¡M [|f (x) âˆ’f (y)| + |g (y) âˆ’g (x)|]
where
M â‰¡
2
|g (x)|2 (1 + 2 |f (x)| + 2 |g (x)|)
Now let Î´2 be such that if |x âˆ’y| < Î´2, then
|f (x) âˆ’f (y)| < Îµ
2M âˆ’1
and let Î´3 be such that if |x âˆ’y| < Î´3, then
|g (y) âˆ’g (x)| < Îµ
2M âˆ’1.
Then if 0 < Î´ â‰¤min (Î´0, Î´1, Î´2, Î´3) , and |x âˆ’y| < Î´, everything holds and
Â¯Â¯Â¯Â¯
f (x)
g (x) âˆ’f (y)
g (y)
Â¯Â¯Â¯Â¯ â‰¤M [|f (x) âˆ’f (y)| + |g (y) âˆ’g (x)|]
< M
hÎµ
2M âˆ’1 + Îµ
2M âˆ’1i
= Îµ.
This completes the proof of the second part of 2.) Note that in these proofs no
eï¬€ort is made to ï¬nd some sort of â€œbestâ€ Î´. The problem is one which has a yes or
a no answer. Either it is or it is not continuous.
Now begin on 3.). If f is continuous at x, f (x) âˆˆD (g) âŠ†Fp, and g is continuous
at f (x) ,then g â—¦f is continuous at x. Let Îµ > 0 be given. Then there exists Î· > 0

110
MULTI-VARIABLE CALCULUS
such that if |y âˆ’f (x)| < Î· and y âˆˆD (g) , it follows that |g (y) âˆ’g (f (x))| < Îµ. It
follows from continuity of f at x that there exists Î´ > 0 such that if |x âˆ’z| < Î´ and
z âˆˆD (f) , then |f (z) âˆ’f (x)| < Î·. Then if |x âˆ’z| < Î´ and z âˆˆD (g â—¦f) âŠ†D (f) ,
all the above hold and so
|g (f (z)) âˆ’g (f (x))| < Îµ.
This proves part 3.)
Part 4.) says: If f = (f1, Â· Â· Â·, fq) : D (f) â†’Fq, then f is continuous if and only
if each fk is a continuous F valued function. Then
|fk (x) âˆ’fk (y)| â‰¤|f (x) âˆ’f (y)|
â‰¡
Ãƒ q
X
i=1
|fi (x) âˆ’fi (y)|2
!1/2
â‰¤
q
X
i=1
|fi (x) âˆ’fi (y)| .
(5.18)
Suppose ï¬rst that f is continuous at x. Then there exists Î´ > 0 such that if |x âˆ’y| <
Î´, then |f (x) âˆ’f (y)| < Îµ. The ï¬rst part of the above inequality then shows that for
each k = 1, Â· Â· Â·, q, |fk (x) âˆ’fk (y)| < Îµ. This shows the only if part. Now suppose
each function, fk is continuous. Then if Îµ > 0 is given, there exists Î´k > 0 such
that whenever |x âˆ’y| < Î´k
|fk (x) âˆ’fk (y)| < Îµ/q.
Now let 0 < Î´ â‰¤min (Î´1, Â· Â· Â·, Î´q) . For |x âˆ’y| < Î´, the above inequality holds for all
k and so the last part of 5.18 implies
|f (x) âˆ’f (y)| â‰¤
q
X
i=1
|fi (x) âˆ’fi (y)|
<
q
X
i=1
Îµ
q = Îµ.
This proves part 4.)
To verify part 5.), let Îµ > 0 be given and let Î´ = Îµ. Then if |x âˆ’y| < Î´, the
triangle inequality implies
|f (x) âˆ’f (y)| = ||x| âˆ’|y||
â‰¤|x âˆ’y| < Î´ = Îµ.
This proves part 5.) and completes the proof of the theorem.
Here is a multidimensional version of the nested interval lemma.
The following deï¬nition is similar to that given earlier. It deï¬nes what is meant
by a sequentially compact set in Fp.

5.10.
PROOFS OF THEOREMS
111
Deï¬nition 5.36 A set, K âŠ†Fp is sequentially compact if and only if whenever
{xn}âˆž
n=1 is a sequence of points in K, there exists a point, x âˆˆK and a subsequence,
{xnk}âˆž
k=1 such that xnk â†’x.
It turns out the sequentially compact sets in Fpare exactly those which are closed
and bounded. Only half of this result will be needed in this book and this is proved
next. First note that C can be considered as R2. Therefore, Cp may be considered
as R2p.
Theorem 5.37 Let C âŠ†Fp be closed and bounded. Then C is sequentially compact.
Proof: Let {an} âŠ†C.
Then let an =
Â¡
an
1, Â· Â· Â·, an
p
Â¢
. It follows the real and
imaginary parts of the terms of the sequence,
Â©
an
j
Âªâˆž
n=1 are each contained in some
suï¬ƒciently large closed bounded interval. By Theorem 2.3 on Page 25, there is a
subsequence of the sequence of real parts of
Â©
an
j
Âªâˆž
n=1 which converges. Also there
is a further subsequence of the imaginary parts of
Â©
an
j
Âªâˆž
n=1 which converges. Thus
there is a subsequence, nk with the property that ank
j
converges to a point, aj âˆˆF.
Taking further subsequences, one obtains the existence of a subsequence, still called
nk such that for each r = 1, Â· Â· Â·, p, ank
r
converges to a point, ar âˆˆF as k â†’âˆž.
Therefore, letting a â‰¡(a1, Â· Â· Â·, ap) , limkâ†’âˆžank = a. Since C is closed, it follows
a âˆˆC. This proves the theorem.
Here is a proof of the extreme value theorem.
Theorem 5.38 Let C be closed and bounded and let f : C â†’R be continuous.
Then f achieves its maximum and its minimum on C. This means there exist,
x1, x2 âˆˆC such that for all x âˆˆC,
f (x1) â‰¤f (x) â‰¤f (x2) .
Proof: Let M = sup {f (x) : x âˆˆC} . Recall this means +âˆžif f is not bounded
above and it equals the least upper bound of these values of f if f is bounded above.
Then there exists a sequence, {xn} such that f (xn) â†’M. Since C is sequentially
compact, there exists a subsequence, xnk, and a point, x âˆˆC such that xnk â†’x.
But then since f is continuous at x, it follows from Theorem 5.32 on Page 105
that f (x) = limkâ†’âˆžf (xnk) = M. This proves f achieves its maximum and also
shows its maximum is less than âˆž. Let x2 = x. The case of a minimum is handled
similarly.
Recall that a function is uniformly continuous if the following deï¬nition holds.
Deï¬nition 5.39 Let f : D (f) â†’Fq. Then f is uniformly continuous if for every
Îµ > 0 there exists Î´ > 0 such that whenever |x âˆ’y| < Î´, it follows |f (x) âˆ’f (y)| < Îµ.
Theorem 5.40 Let f :C â†’Fq be continuous where C is a closed and bounded set
in Fp. Then f is uniformly continuous on C.
Proof: If this is not so, there exists Îµ > 0 and pairs of points, xn and yn satisfy-
ing |xn âˆ’yn| < 1/n but |f (xn) âˆ’f (yn)| â‰¥Îµ. Since C is sequentially compact, there

112
MULTI-VARIABLE CALCULUS
exists x âˆˆC and a subsequence, {xnk} satisfying xnk â†’x. But |xnk âˆ’ynk| < 1/k
and so ynk â†’x also. Therefore, from Theorem 5.32 on Page 105,
Îµ â‰¤lim
kâ†’âˆž|f (xnk) âˆ’f (ynk)| = |f (x) âˆ’f (x)| = 0,
a contradiction. This proves the theorem.
5.11
The Space L (Fn, Fm)
Deï¬nition 5.41 The symbol, L (Fn, Fm) will denote the set of linear transforma-
tions mapping Fn to Fm. Thus L âˆˆL (Fn, Fm) means that for Î±, Î² scalars and x, y
vectors in Fn,
L (Î±x + Î²y) = Î±L (x) + Î²L (y) .
It is convenient to give a norm for the elements of L (Fn, Fm) . This will allow
the consideration of questions such as whether a function having values in this space
of linear transformations is continuous.
5.11.1
The Operator Norm
How do you measure the distance between linear transformations deï¬ned on Fn? It
turns out there are many ways to do this but I will give the most common one here.
Deï¬nition 5.42 L (Fn, Fm) denotes the space of linear transformations mapping
Fn to Fm. For A âˆˆL (Fn, Fm) , the operator norm is deï¬ned by
||A|| â‰¡max {|Ax|Fm : |x|Fn â‰¤1} < âˆž.
Theorem 5.43 Denote by |Â·| the norm on either Fn or Fm. Then L (Fn, Fm) with
this operator norm is a complete normed linear space of dimension nm with
||Ax|| â‰¤||A|| |x| .
Here Completeness means that every Cauchy sequence converges.
Proof: It is necessary to show the norm deï¬ned on L (Fn, Fm) really is a norm.
This means it is necessary to verify
||A|| â‰¥0 and equals zero if and only if A = 0.
For Î± a scalar,
||Î±A|| = |Î±| ||A|| ,
and for A, B âˆˆL (Fn, Fm) ,
||A + B|| â‰¤||A|| + ||B||

5.11.
THE SPACE L
Â¡
FN, FMÂ¢
113
The ï¬rst two properties are obvious but you should verify them. It remains to verify
the norm is well deï¬ned and also to verify the triangle inequality above. First if
|x| â‰¤1, and (Aij) is the matrix of the linear transformation with respect to the
usual basis vectors, then
||A||
=
max
ï£±
ï£²
ï£³
ÃƒX
i
|(Ax)i|2
!1/2
: |x| â‰¤1
ï£¼
ï£½
ï£¾
=
max
ï£±
ï£´
ï£´
ï£²
ï£´
ï£´
ï£³
ï£«
ï£¬
ï£­
X
i
Â¯Â¯Â¯Â¯Â¯Â¯
X
j
Aijxj
Â¯Â¯Â¯Â¯Â¯Â¯
2ï£¶
ï£·
ï£¸
1/2
: |x| â‰¤1
ï£¼
ï£´
ï£´
ï£½
ï£´
ï£´
ï£¾
which is a ï¬nite number by the extreme value theorem.
It is clear that a basis for L (Fn, Fm) consists of linear transformations whose
matrices are of the form Eij where Eij consists of the mÃ—n matrix having all zeros
except for a 1 in the ijth position. In eï¬€ect, this considers L (Fn, Fm) as Fnm. Think
of the m Ã— n matrix as a long vector folded up.
If x Ì¸= 0,
|Ax| 1
|x| =
Â¯Â¯Â¯Â¯A x
|x|
Â¯Â¯Â¯Â¯ â‰¤||A||
(5.19)
It only remains to verify completeness. Suppose then that {Ak} is a Cauchy
sequence in L (Fn, Fm) . Then from 5.19 {Akx} is a Cauchy sequence for each x âˆˆFn.
This follows because
|Akx âˆ’Alx| â‰¤||Ak âˆ’Al|| |x|
which converges to 0 as k, l â†’âˆž. Therefore, by completeness of Fm, there exists
Ax, the name of the thing to which the sequence, {Akx} converges such that
lim
kâ†’âˆžAkx = Ax.
Then A is linear because
A (ax + by)
â‰¡
lim
kâ†’âˆžAk (ax + by)
=
lim
kâ†’âˆž(aAkx + bAky)
=
a lim
kâ†’âˆžAkx + b lim
kâ†’âˆžAky
=
aAx + bAy.
By the ï¬rst part of this argument, ||A|| < âˆžand so A âˆˆL (Fn, Fm) . This proves
the theorem.
Proposition 5.44 Let A (x) âˆˆL (Fn, Fm) for each x âˆˆU âŠ†Fp. Then letting
(Aij (x)) denote the matrix of A (x) with respect to the standard basis, it follows
Aij is continuous at x for each i, j if and only if for all Îµ > 0, there exists a Î´ > 0
such that if |x âˆ’y| < Î´, then ||A (x) âˆ’A (y)|| < Îµ. That is, A is a continuous
function having values in L (Fn, Fm) at x.

114
MULTI-VARIABLE CALCULUS
Proof: Suppose ï¬rst the second condition holds. Then from the material on
linear transformations,
|Aij (x) âˆ’Aij (y)|
=
|ei Â· (A (x) âˆ’A (y)) ej|
â‰¤
|ei| |(A (x) âˆ’A (y)) ej|
â‰¤
||A (x) âˆ’A (y)|| .
Therefore, the second condition implies the ï¬rst.
Now suppose the ï¬rst condition holds. That is each Aij is continuous at x. Let
|v| â‰¤1.
|(A (x) âˆ’A (y)) (v)|
=
ï£«
ï£¬
ï£­
X
i
Â¯Â¯Â¯Â¯Â¯Â¯
X
j
(Aij (x) âˆ’Aij (y)) vj
Â¯Â¯Â¯Â¯Â¯Â¯
2ï£¶
ï£·
ï£¸
1/2
(5.20)
â‰¤
ï£«
ï£¬
ï£­
X
i
ï£«
ï£­X
j
|Aij (x) âˆ’Aij (y)| |vj|
ï£¶
ï£¸
2ï£¶
ï£·
ï£¸
1/2
.
By continuity of each Aij, there exists a Î´ > 0 such that for each i, j
|Aij (x) âˆ’Aij (y)| <
Îµ
nâˆšm
whenever |x âˆ’y| < Î´. Then from 5.20, if |x âˆ’y| < Î´,
|(A (x) âˆ’A (y)) (v)|
<
ï£«
ï£¬
ï£­
X
i
ï£«
ï£­X
j
Îµ
nâˆšm |v|
ï£¶
ï£¸
2ï£¶
ï£·
ï£¸
1/2
â‰¤
ï£«
ï£¬
ï£­
X
i
ï£«
ï£­X
j
Îµ
nâˆšm
ï£¶
ï£¸
2ï£¶
ï£·
ï£¸
1/2
= Îµ
This proves the proposition.
5.12
The Frechet Derivative
Let U be an open set in Fn, and let f : U â†’Fm be a function.
Deï¬nition 5.45 A function g is o (v) if
lim
|v|â†’0
g (v)
|v|
= 0
(5.21)

5.12.
THE FRECHET DERIVATIVE
115
A function f : U â†’Fm is diï¬€erentiable at x âˆˆU if there exists a linear transfor-
mation L âˆˆL (Fn, Fm) such that
f (x + v) = f (x) + Lv + o (v)
This linear transformation L is the deï¬nition of Df (x). This derivative is often
called the Frechet derivative. .
Usually no harm is occasioned by thinking of this linear transformation as its
matrix taken with respect to the usual basis vectors.
The deï¬nition 5.21 means that the error,
f (x + v) âˆ’f (x) âˆ’Lv
converges to 0 faster than |v|. Thus the above deï¬nition is equivalent to saying
lim
|v|â†’0
|f (x + v) âˆ’f (x) âˆ’Lv|
|v|
= 0
(5.22)
or equivalently,
lim
yâ†’x
|f (y) âˆ’f (x) âˆ’Df (x) (y âˆ’x)|
|y âˆ’x|
= 0.
(5.23)
Now it is clear this is just a generalization of the notion of the derivative of a
function of one variable because in this more specialized situation,
lim
|v|â†’0
|f (x + v) âˆ’f (x) âˆ’f â€² (x) v|
|v|
= 0,
due to the deï¬nition which says
f â€² (x) = lim
vâ†’0
f (x + v) âˆ’f (x)
v
.
For functions of n variables, you canâ€™t deï¬ne the derivative as the limit of a diï¬€erence
quotient like you can for a function of one variable because you canâ€™t divide by a
vector. That is why there is a need for a more general deï¬nition.
The term o (v) is notation that is descriptive of the behavior in 5.21 and it is
only this behavior that is of interest. Thus, if t and k are constants,
o (v) = o (v) + o (v) , o (tv) = o (v) , ko (v) = o (v)
and other similar observations hold.
The sloppiness built in to this notation is
useful because it ignores details which are not important. It may help to think of
o (v) as an adjective describing what is left over after approximating f (x + v) by
f (x) + Df (x) v.
Theorem 5.46 The derivative is well deï¬ned.

116
MULTI-VARIABLE CALCULUS
Proof: First note that for a ï¬xed vector, v, o (tv) = o (t). Now suppose both
L1 and L2 work in the above deï¬nition. Then let v be any vector and let t be a
real scalar which is chosen small enough that tv + x âˆˆU. Then
f (x + tv) = f (x) + L1tv + o (tv) , f (x + tv) = f (x) + L2tv + o (tv) .
Therefore, subtracting these two yields (L2 âˆ’L1) (tv) = o (tv) = o (t).
There-
fore, dividing by t yields (L2 âˆ’L1) (v) =
o(t)
t . Now let t â†’0 to conclude that
(L2 âˆ’L1) (v) = 0. Since this is true for all v, it follows L2 = L1. This proves the
theorem.
Lemma 5.47 Let f be diï¬€erentiable at x. Then f is continuous at x and in fact,
there exists K > 0 such that whenever |v| is small enough,
|f (x + v) âˆ’f (x)| â‰¤K |v|
Proof: From the deï¬nition of the derivative, f (x + v)âˆ’f (x) = Df (x) v+o (v).
Let |v| be small enough that o(|v|)
|v|
< 1 so that |o (v)| â‰¤|v|. Then for such v,
|f (x + v) âˆ’f (x)|
â‰¤
|Df (x) v| + |v|
â‰¤
(|Df (x)| + 1) |v|
This proves the lemma with K = |Df (x)| + 1.
Theorem 5.48 (The chain rule) Let U and V be open sets, U âŠ†Fn and V âŠ†
Fm. Suppose f : U â†’V is diï¬€erentiable at x âˆˆU and suppose g : V â†’Fq is
diï¬€erentiable at f (x) âˆˆV . Then g â—¦f is diï¬€erentiable at x and
D (g â—¦f) (x) = D (g (f (x))) D (f (x)) .
Proof: This follows from a computation. Let B (x,r) âŠ†U and let r also be small
enough that for |v| â‰¤r, it follows that f (x + v) âˆˆV . Such an r exists because f is
continuous at x. For |v| < r, the deï¬nition of diï¬€erentiability of g and f implies
g (f (x + v)) âˆ’g (f (x)) =
Dg (f (x)) (f (x + v) âˆ’f (x)) + o (f (x + v) âˆ’f (x))
=
Dg (f (x)) [Df (x) v + o (v)] + o (f (x + v) âˆ’f (x))
=
D (g (f (x))) D (f (x)) v + o (v) + o (f (x + v) âˆ’f (x)) .
(5.24)
It remains to show o (f (x + v) âˆ’f (x)) = o (v).
By Lemma 5.47, with K given there, letting Îµ > 0, it follows that for |v| small
enough,
|o (f (x + v) âˆ’f (x))| â‰¤(Îµ/K) |f (x + v) âˆ’f (x)| â‰¤(Îµ/K) K |v| = Îµ |v| .

5.12.
THE FRECHET DERIVATIVE
117
Since Îµ > 0 is arbitrary, this shows o (f (x + v) âˆ’f (x)) = o (v) because whenever
|v| is small enough,
|o (f (x + v) âˆ’f (x))|
|v|
â‰¤Îµ.
By 5.24, this shows
g (f (x + v)) âˆ’g (f (x)) = D (g (f (x))) D (f (x)) v + o (v)
which proves the theorem.
The derivative is a linear transformation.
What is the matrix of this linear
transformation taken with respect to the usual basis vectors? Let ei denote the
vector of Fn which has a one in the ith entry and zeroes elsewhere. Then the matrix
of the linear transformation is the matrix whose ith column is Df (x) ei. What is
this? Let t âˆˆR such that |t| is suï¬ƒciently small.
f (x + tei) âˆ’f (x)
=
Df (x) tei + o (tei)
=
Df (x) tei + o (t) .
Then dividing by t and taking a limit,
Df (x) ei = lim
tâ†’0
f (x + tei) âˆ’f (x)
t
â‰¡âˆ‚f
âˆ‚xi
(x) .
Thus the matrix of Df (x) with respect to the usual basis vectors is the matrix of
the form
ï£«
ï£¬
ï£­
f1,x1 (x)
f1,x2 (x)
Â· Â· Â·
f1,xn (x)
...
...
...
fm,x1 (x)
fm,x2 (x)
Â· Â· Â·
fm,xn (x)
ï£¶
ï£·
ï£¸.
As mentioned before, there is no harm in referring to this matrix as Df (x) but it
may also be referred to as Jf (x) .
This is summarized in the following theorem.
Theorem 5.49 Let f : Fn â†’Fm and suppose f is diï¬€erentiable at x. Then all the
partial derivatives âˆ‚fi(x)
âˆ‚xj
exist and if Jf (x) is the matrix of the linear transformation
with respect to the standard basis vectors, then the ijth entry is given by fi,j or
âˆ‚fi
âˆ‚xj (x).
What if all the partial derivatives of f exist? Does it follow that f is diï¬€eren-
tiable? Consider the following function.
f (x, y) =
Â½
xy
x2+y2 if (x, y) Ì¸= (0, 0)
0 if (x, y) = (0, 0)
.
Then from the deï¬nition of partial derivatives,
lim
hâ†’0
f (h, 0) âˆ’f (0, 0)
h
= lim
hâ†’0
0 âˆ’0
h
= 0

118
MULTI-VARIABLE CALCULUS
and
lim
hâ†’0
f (0, h) âˆ’f (0, 0)
h
= lim
hâ†’0
0 âˆ’0
h
= 0
However f is not even continuous at (0, 0) which may be seen by considering the
behavior of the function along the line y = x and along the line x = 0. By Lemma
5.47 this implies f is not diï¬€erentiable. Therefore, it is necessary to consider the
correct deï¬nition of the derivative given above if you want to get a notion which
generalizes the concept of the derivative of a function of one variable in such a way
as to preserve continuity whenever the function is diï¬€erentiable.
5.13
C1 Functions
However, there are theorems which can be used to get diï¬€erentiability of a function
based on existence of the partial derivatives.
Deï¬nition 5.50 When all the partial derivatives exist and are continuous the func-
tion is called a C1 function.
Because of Proposition 5.44 on Page 113 and Theorem 5.49 which identiï¬es the
entries of Jf with the partial derivatives, the following deï¬nition is equivalent to
the above.
Deï¬nition 5.51 Let U âŠ†Fn be an open set. Then f : U â†’Fm is C1 (U) if f is
diï¬€erentiable and the mapping
x â†’Df (x) ,
is continuous as a function from U to L (Fn, Fm).
The following is an important abstract generalization of the familiar concept of
partial derivative.
Deï¬nition 5.52 Let g : U âŠ†Fn Ã— Fm â†’Fq, where U is an open set in Fn Ã— Fm.
Denote an element of Fn Ã— Fm by (x, y) where x âˆˆFn and y âˆˆFm. Then the map
x â†’g (x, y) is a function from the open set in X,
{x : (x, y) âˆˆU}
to Fq. When this map is diï¬€erentiable, its derivative is denoted by
D1g (x, y) , or sometimes by Dxg (x, y) .
Thus,
g (x + v, y) âˆ’g (x, y) = D1g (x, y) v + o (v) .
A similar deï¬nition holds for the symbol Dyg or D2g. The special case seen in
beginning calculus courses is where g : U â†’Fq and
gxi (x) â‰¡âˆ‚g (x)
âˆ‚xi
â‰¡lim
hâ†’0
g (x + hei) âˆ’g (x)
h
.

5.13.
C1 FUNCTIONS
119
The following theorem will be very useful in much of what follows. It is a version
of the mean value theorem.
Theorem 5.53 Suppose U is an open subset of Fn and f : U â†’Fm
has the
property that Df (x) exists for all x in U and that, x+t (y âˆ’x) âˆˆU for all t âˆˆ[0, 1].
(The line segment joining the two points lies in U.) Suppose also that for all points
on this line segment,
||Df (x+t (y âˆ’x))|| â‰¤M.
Then
|f (y) âˆ’f (x)| â‰¤M |y âˆ’x| .
Proof: Let
S â‰¡{t âˆˆ[0, 1] : for all s âˆˆ[0, t] ,
|f (x + s (y âˆ’x)) âˆ’f (x)| â‰¤(M + Îµ) s |y âˆ’x|} .
Then 0 âˆˆS and by continuity of f, it follows that if t â‰¡sup S, then t âˆˆS and if
t < 1,
|f (x + t (y âˆ’x)) âˆ’f (x)| = (M + Îµ) t |y âˆ’x| .
(5.25)
If t < 1, then there exists a sequence of positive numbers, {hk}âˆž
k=1 converging to 0
such that
|f (x + (t + hk) (y âˆ’x)) âˆ’f (x)| > (M + Îµ) (t + hk) |y âˆ’x|
which implies that
|f (x + (t + hk) (y âˆ’x)) âˆ’f (x + t (y âˆ’x))|
+ |f (x + t (y âˆ’x)) âˆ’f (x)| > (M + Îµ) (t + hk) |y âˆ’x| .
By 5.25, this inequality implies
|f (x + (t + hk) (y âˆ’x)) âˆ’f (x + t (y âˆ’x))| > (M + Îµ) hk |y âˆ’x|
which yields upon dividing by hk and taking the limit as hk â†’0,
|Df (x + t (y âˆ’x)) (y âˆ’x)| â‰¥(M + Îµ) |y âˆ’x| .
Now by the deï¬nition of the norm of a linear operator,
M |y âˆ’x|
â‰¥
||Df (x + t (y âˆ’x))|| |y âˆ’x|
â‰¥
|Df (x + t (y âˆ’x)) (y âˆ’x)| â‰¥(M + Îµ) |y âˆ’x| ,
a contradiction. Therefore, t = 1 and so
|f (x + (y âˆ’x)) âˆ’f (x)| â‰¤(M + Îµ) |y âˆ’x| .
Since Îµ > 0 is arbitrary, this proves the theorem.
The next theorem proves that if the partial derivatives exist and are continuous,
then the function is diï¬€erentiable.

120
MULTI-VARIABLE CALCULUS
Theorem 5.54 Let g : U âŠ†Fn Ã— Fm â†’Fq. Then g is C1 (U) if and only if D1g
and D2g both exist and are continuous on U. In this case,
Dg (x, y) (u, v) = D1g (x, y) u+D2g (x, y) v.
Proof: Suppose ï¬rst that g âˆˆC1 (U). Then if (x, y) âˆˆU,
g (x + u, y) âˆ’g (x, y) = Dg (x, y) (u, 0) + o (u) .
Therefore, D1g (x, y) u =Dg (x, y) (u, 0). Then
|(D1g (x, y) âˆ’D1g (xâ€², yâ€²)) (u)| =
|(Dg (x, y) âˆ’Dg (xâ€², yâ€²)) (u, 0)| â‰¤
||Dg (x, y) âˆ’Dg (xâ€², yâ€²)|| |(u, 0)| .
Therefore,
|D1g (x, y) âˆ’D1g (xâ€², yâ€²)| â‰¤||Dg (x, y) âˆ’Dg (xâ€², yâ€²)|| .
A similar argument applies for D2g and this proves the continuity of the function,
(x, y) â†’Dig (x, y) for i = 1, 2. The formula follows from
Dg (x, y) (u, v)
=
Dg (x, y) (u, 0) + Dg (x, y) (0, v)
â‰¡
D1g (x, y) u+D2g (x, y) v.
Now suppose D1g (x, y) and D2g (x, y) exist and are continuous.
g (x + u, y + v) âˆ’g (x, y) = g (x + u, y + v) âˆ’g (x, y + v)
+g (x, y + v) âˆ’g (x, y)
= g (x + u, y) âˆ’g (x, y) + g (x, y + v) âˆ’g (x, y) +
[g (x + u, y + v) âˆ’g (x + u, y) âˆ’(g (x, y + v) âˆ’g (x, y))]
= D1g (x, y) u + D2g (x, y) v + o (v) + o (u) +
[g (x + u, y + v) âˆ’g (x + u, y) âˆ’(g (x, y + v) âˆ’g (x, y))] .
(5.26)
Let h (x, u) â‰¡g (x + u, y + v) âˆ’g (x + u, y). Then the expression in [
] is of the
form,
h (x, u) âˆ’h (x, 0) .
Also
D2h (x, u) = D1g (x + u, y + v) âˆ’D1g (x + u, y)
and so, by continuity of (x, y) â†’D1g (x, y),
||D2h (x, u)|| < Îµ

5.13.
C1 FUNCTIONS
121
whenever ||(u, v)|| is small enough. By Theorem 5.53 on Page 119, there exists
Î´ > 0 such that if ||(u, v)|| < Î´, the norm of the last term in 5.26 satisï¬es the
inequality,
||g (x + u, y + v) âˆ’g (x + u, y) âˆ’(g (x, y + v) âˆ’g (x, y))|| < Îµ ||u|| .
(5.27)
Therefore, this term is o ((u, v)). It follows from 5.27 and 5.26 that
g (x + u, y + v) =
g (x, y) + D1g (x, y) u + D2g (x, y) v+o (u) + o (v) + o ((u, v))
= g (x, y) + D1g (x, y) u + D2g (x, y) v + o ((u, v))
Showing that Dg (x, y) exists and is given by
Dg (x, y) (u, v) = D1g (x, y) u + D2g (x, y) v.
The continuity of (x, y) â†’Dg (x, y) follows from the continuity of (x, y) â†’
Dig (x, y). This proves the theorem.
Not surprisingly, it can be generalized to many more factors.
Deï¬nition 5.55 Let g : U âŠ†Qn
i=1 Fri â†’Fq, where U is an open set. Then the
map xi â†’g (x) is a function from the open set in Fri,
{xi : x âˆˆU}
to Fq. When this map is diï¬€erentiable, its derivative is denoted by Dig (x). To aid
in the notation, for v âˆˆXi, let Î¸iv âˆˆQn
i=1 Fri be the vector (0, Â· Â· Â·, v, Â· Â· Â·, 0) where
the v is in the ith slot and for v âˆˆQn
i=1 Fri, let vi denote the entry in the ith slot of
v. Thus by saying xi â†’g (x) is diï¬€erentiable is meant that for v âˆˆXi suï¬ƒciently
small,
g (x + Î¸iv) âˆ’g (x) = Dig (x) v + o (v) .
Here is a generalization of Theorem 5.54.
Theorem 5.56 Let g, U, Qn
i=1 Fri, be given as in Deï¬nition 5.55. Then g is C1 (U)
if and only if Dig exists and is continuous on U for each i. In this case,
Dg (x) (v) =
X
k
Dkg (x) vk
(5.28)
Proof: The only if part of the proof is left for you. Suppose then that Dig
exists and is continuous for each i. Note that Pk
j=1 Î¸jvj = (v1, Â· Â· Â·, vk, 0, Â· Â· Â·, 0).
Thus Pn
j=1 Î¸jvj = v and deï¬ne P0
j=1 Î¸jvj â‰¡0. Therefore,
g (x + v) âˆ’g (x) =
n
X
k=1
ï£®
ï£°g
ï£«
ï£­x+
k
X
j=1
Î¸jvj
ï£¶
ï£¸âˆ’g
ï£«
ï£­x +
kâˆ’1
X
j=1
Î¸jvj
ï£¶
ï£¸
ï£¹
ï£»
(5.29)

122
MULTI-VARIABLE CALCULUS
Consider the terms in this sum.
g
ï£«
ï£­x+
k
X
j=1
Î¸jvj
ï£¶
ï£¸âˆ’g
ï£«
ï£­x +
kâˆ’1
X
j=1
Î¸jvj
ï£¶
ï£¸= g (x+Î¸kvk) âˆ’g (x) +
(5.30)
ï£«
ï£­g
ï£«
ï£­x+
k
X
j=1
Î¸jvj
ï£¶
ï£¸âˆ’g (x+Î¸kvk)
ï£¶
ï£¸âˆ’
ï£«
ï£­g
ï£«
ï£­x +
kâˆ’1
X
j=1
Î¸jvj
ï£¶
ï£¸âˆ’g (x)
ï£¶
ï£¸
(5.31)
and the expression in 5.31 is of the form h (vk) âˆ’h (0) where for small w âˆˆFrk,
h (w) â‰¡g
ï£«
ï£­x+
kâˆ’1
X
j=1
Î¸jvj + Î¸kw
ï£¶
ï£¸âˆ’g (x + Î¸kw) .
Therefore,
Dh (w) = Dkg
ï£«
ï£­x+
kâˆ’1
X
j=1
Î¸jvj + Î¸kw
ï£¶
ï£¸âˆ’Dkg (x + Î¸kw)
and by continuity, ||Dh (w)|| < Îµ provided |v| is small enough.
Therefore, by
Theorem 5.53, whenever |v| is small enough, |h (Î¸kvk) âˆ’h (0)| â‰¤Îµ |Î¸kvk| â‰¤Îµ |v|
which shows that since Îµ is arbitrary, the expression in 5.31 is o (v). Now in 5.30
g (x+Î¸kvk)âˆ’g (x) = Dkg (x) vk +o (vk) = Dkg (x) vk +o (v). Therefore, referring
to 5.29,
g (x + v) âˆ’g (x) =
n
X
k=1
Dkg (x) vk + o (v)
which shows Dg exists and equals the formula given in 5.28.
The way this is usually used is in the following corollary, a case of Theorem 5.56
obtained by letting Frj = F in the above theorem.
Corollary 5.57 Let U be an open subset of Fn and let f :U â†’Fm be C1 in the sense
that all the partial derivatives of f exist and are continuous. Then f is diï¬€erentiable
and
f (x + v) = f (x) +
n
X
k=1
âˆ‚f
âˆ‚xk
(x) vk + o (v) .
5.14
Ck Functions
Recall the notation for partial derivatives in the following deï¬nition.
Deï¬nition 5.58 Let g : U â†’Fn. Then
gxk (x) â‰¡âˆ‚g
âˆ‚xk
(x) â‰¡lim
hâ†’0
g (x + hek) âˆ’g (x)
h

5.15.
MIXED PARTIAL DERIVATIVES
123
Higher order partial derivatives are deï¬ned in the usual way.
gxkxl (x) â‰¡
âˆ‚2g
âˆ‚xlâˆ‚xk
(x)
and so forth.
To deal with higher order partial derivatives in a systematic way, here is a useful
deï¬nition.
Deï¬nition 5.59 Î± = (Î±1, Â· Â· Â·, Î±n) for Î±1 Â· Â· Â· Î±n positive integers is called a multi-
index. For Î± a multi-index, |Î±| â‰¡Î±1 + Â· Â· Â· + Î±n and if x âˆˆFn,
x = (x1, Â· Â· Â·, xn),
and f a function, deï¬ne
xÎ± â‰¡xÎ±1
1 xÎ±2
2 Â· Â· Â· xÎ±n
n , DÎ±f(x) â‰¡
âˆ‚|Î±|f(x)
âˆ‚xÎ±1
1 âˆ‚xÎ±2
2 Â· Â· Â· âˆ‚xÎ±n
n
.
The following is the deï¬nition of what is meant by a Ck function.
Deï¬nition 5.60 Let U be an open subset of Fn and let f : U â†’Fm. Then for k a
nonnegative integer, f is Ck if for every |Î±| â‰¤k, DÎ±f exists and is continuous.
5.15
Mixed Partial Derivatives
Under certain conditions the mixed partial derivatives will always be equal.
This astonishing fact is due to Euler in 1734.
Theorem 5.61 Suppose f : U âŠ†F2 â†’R where U is an open set on which fx, fy,
fxy and fyx exist. Then if fxy and fyx are continuous at the point (x, y) âˆˆU, it
follows
fxy (x, y) = fyx (x, y) .
Proof: Since U is open, there exists r > 0 such that B ((x, y) , r) âŠ†U. Now let
|t| , |s| < r/2, t, s real numbers and consider
âˆ†(s, t) â‰¡1
st{
h(t)
z
}|
{
f (x + t, y + s) âˆ’f (x + t, y) âˆ’
h(0)
z
}|
{
(f (x, y + s) âˆ’f (x, y))}.
(5.32)
Note that (x + t, y + s) âˆˆU because
|(x + t, y + s) âˆ’(x, y)|
=
|(t, s)| =
Â¡
t2 + s2Â¢1/2
â‰¤
Âµr2
4 + r2
4
Â¶1/2
=
r
âˆš
2 < r.

124
MULTI-VARIABLE CALCULUS
As implied above, h (t) â‰¡f (x + t, y + s) âˆ’f (x + t, y). Therefore, by the mean
value theorem from calculus and the (one variable) chain rule,
âˆ†(s, t)
=
1
st (h (t) âˆ’h (0)) = 1
sthâ€² (Î±t) t
=
1
s (fx (x + Î±t, y + s) âˆ’fx (x + Î±t, y))
for some Î± âˆˆ(0, 1) . Applying the mean value theorem again,
âˆ†(s, t) = fxy (x + Î±t, y + Î²s)
where Î±, Î² âˆˆ(0, 1).
If the terms f (x + t, y) and f (x, y + s) are interchanged in 5.32, âˆ†(s, t) is un-
changed and the above argument shows there exist Î³, Î´ âˆˆ(0, 1) such that
âˆ†(s, t) = fyx (x + Î³t, y + Î´s) .
Letting (s, t) â†’(0, 0) and using the continuity of fxy and fyx at (x, y) ,
lim
(s,t)â†’(0,0) âˆ†(s, t) = fxy (x, y) = fyx (x, y) .
This proves the theorem.
The following is obtained from the above by simply ï¬xing all the variables except
for the two of interest.
Corollary 5.62 Suppose U is an open subset of Fn and f : U â†’R has the property
that for two indices, k, l, fxk, fxl, fxlxk, and fxkxl exist on U and fxkxl and fxlxk
are both continuous at x âˆˆU. Then fxkxl (x) = fxlxk (x) .
By considering the real and imaginary parts of f in the case where f has values
in F you obtain the following corollary.
Corollary 5.63 Suppose U is an open subset of Fn and f : U â†’F has the property
that for two indices, k, l, fxk, fxl, fxlxk, and fxkxl exist on U and fxkxl and fxlxk
are both continuous at x âˆˆU. Then fxkxl (x) = fxlxk (x) .
Finally, by considering the components of f you get the following generalization.
Corollary 5.64 Suppose U is an open subset of Fn and f : U â†’F mhas the
property that for two indices, k, l, fxk, fxl, fxlxk, and fxkxl exist on U and fxkxl and
fxlxk are both continuous at x âˆˆU. Then fxkxl (x) = fxlxk (x) .
It is necessary to assume the mixed partial derivatives are continuous in order
to assert they are equal. The following is a well known example [5].
Example 5.65 Let
f (x, y) =
(
xy(x2âˆ’y2)
x2+y2
if (x, y) Ì¸= (0, 0)
0 if (x, y) = (0, 0)

5.16.
IMPLICIT FUNCTION THEOREM
125
From the deï¬nition of partial derivatives it follows immediately that fx (0, 0) =
fy (0, 0) = 0. Using the standard rules of diï¬€erentiation, for (x, y) Ì¸= (0, 0) ,
fx = y x4 âˆ’y4 + 4x2y2
(x2 + y2)2
, fy = xx4 âˆ’y4 âˆ’4x2y2
(x2 + y2)2
Now
fxy (0, 0)
â‰¡
lim
yâ†’0
fx (0, y) âˆ’fx (0, 0)
y
=
lim
yâ†’0
âˆ’y4
(y2)2 = âˆ’1
while
fyx (0, 0)
â‰¡
lim
xâ†’0
fy (x, 0) âˆ’fy (0, 0)
x
=
lim
xâ†’0
x4
(x2)2 = 1
showing that although the mixed partial derivatives do exist at (0, 0) , they are not
equal there.
5.16
Implicit Function Theorem
The implicit function theorem is one of the greatest theorems in mathematics. There
are many versions of this theorem. However, I will give a very simple proof valid in
ï¬nite dimensional spaces.
Theorem 5.66 (implicit function theorem) Suppose U is an open set in Rn Ã— Rm.
Let f : U â†’Rn be in C1 (U) and suppose
f (x0, y0) = 0, D1f (x0, y0)âˆ’1 âˆˆL (Rn, Rn) .
(5.33)
Then there exist positive constants, Î´, Î·, such that for every y âˆˆB (y0, Î·) there
exists a unique x (y) âˆˆB (x0, Î´) such that
f (x (y) , y) = 0.
(5.34)
Furthermore, the mapping, y â†’x (y) is in C1 (B (y0, Î·)).
Proof: Let
f (x, y) =
ï£«
ï£¬
ï£¬
ï£¬
ï£­
f1 (x, y)
f2 (x, y)
...
fn (x, y)
ï£¶
ï£·
ï£·
ï£·
ï£¸.

126
MULTI-VARIABLE CALCULUS
Deï¬ne for
Â¡
x1, Â· Â· Â·, xnÂ¢
âˆˆB (x0, Î´)
n and y âˆˆB (y0, Î·) the following matrix.
J
Â¡
x1, Â· Â· Â·, xn, y
Â¢
â‰¡
ï£«
ï£¬
ï£­
f1,x1
Â¡
x1, y
Â¢
Â· Â· Â·
f1,xn
Â¡
x1, y
Â¢
...
...
fn,x1 (xn, y)
Â· Â· Â·
fn,xn (xn, y)
ï£¶
ï£·
ï£¸.
Then by the assumption of continuity of all the partial derivatives, there exists
Î´0 > 0 and Î·0 > 0 such that if Î´ < Î´0 and Î· < Î·0, it follows that for all
Â¡
x1, Â· Â· Â·, xnÂ¢
âˆˆ
B (x0, Î´)
n and y âˆˆB (y0, Î·) ,
det
Â¡
J
Â¡
x1, Â· Â· Â·, xn, y
Â¢Â¢
> r > 0.
(5.35)
and B (x0, Î´0)Ã— B (y0, Î·0) âŠ†U. Pick y âˆˆB (y0, Î·) and suppose there exist x, z âˆˆ
B (x0, Î´) such that f (x, y) = f (z, y) = 0. Consider fi and let
h (t) â‰¡fi (x + t (z âˆ’x) , y) .
Then h (1) = h (0) and so by the mean value theorem, hâ€² (ti) = 0 for some ti âˆˆ(0, 1) .
Therefore, from the chain rule and for this value of ti,
hâ€² (ti) = Dfi (x + ti (z âˆ’x) , y) (z âˆ’x) = 0.
(5.36)
Then denote by xi the vector, x + ti (z âˆ’x) . It follows from 5.36 that
J
Â¡
x1, Â· Â· Â·, xn, y
Â¢
(z âˆ’x) = 0
and so from 5.35 z âˆ’x = 0. Now it will be shown that if Î· is chosen suï¬ƒciently
small, then for all y âˆˆB (y0, Î·) , there exists a unique x (y) âˆˆB (x0, Î´) such that
f (x (y) , y) = 0.
Claim: If Î· is small enough, then the function, hy (x) â‰¡|f (x, y)|2 achieves its
minimum value on B (x0, Î´) at a point of B (x0, Î´) .
Proof of claim: Suppose this is not the case. Then there exists a sequence
Î·k â†’0 and for some yk having |ykâˆ’y0| < Î·k, the minimum of hyk occurs on a point
of the boundary of B (x0, Î´), xk such that |x0âˆ’xk| = Î´. Now taking a subsequence,
still denoted by k, it can be assumed that xk â†’x with |x âˆ’x0| = Î´ and yk â†’y0.
Let Îµ > 0. Then for k large enough, hyk (x0) < Îµ because f (x0, y0) = 0. Therefore,
from the deï¬nition of xk, hyk (xk) < Îµ. Passing to the limit yields hy0 (x) â‰¤Îµ. Since
Îµ > 0 is arbitrary, it follows that hy0 (x) = 0 which contradicts the ï¬rst part of the
argument in which it was shown that for y âˆˆB (y0, Î·) there is at most one point, x
of B (x0, Î´) where f (x, y) = 0. Here two have been obtained, x0 and x. This proves
the claim.
Choose Î· < Î·0 and also small enough that the above claim holds and let x (y)
denote a point of B (x0, Î´) at which the minimum of hy on B (x0, Î´) is achieved.
Since x (y) is an interior point, you can consider hy (x (y) + tv) for |t| small and
conclude this function of t has a zero derivative at t = 0. Thus
Dhy (x (y)) v = 0 = 2f (x (y) , y)T D1f (x (y) , y) v

5.16.
IMPLICIT FUNCTION THEOREM
127
for every vector v.
But from 5.35 and the fact that v is arbitrary, it follows
f (x (y) , y) = 0. This proves the existence of the function y â†’x (y) such that
f (x (y) , y) = 0 for all y âˆˆB (y0, Î·) .
It remains to verify this function is a C1 function. To do this, let y1 and y2 be
points of B (y0, Î·) . Then as before, consider the ith component of f and consider
the same argument using the mean value theorem to write
0 = fi (x (y1) , y1) âˆ’fi (x (y2) , y2)
= fi (x (y1) , y1) âˆ’fi (x (y2) , y1) + fi (x (y2) , y1) âˆ’fi (x (y2) , y2)
= D1fi
Â¡
xi, y1
Â¢
(x (y1) âˆ’x (y2)) + D2fi
Â¡
x (y2) , yiÂ¢
(y1 âˆ’y2) .
Therefore,
J
Â¡
x1, Â· Â· Â·, xn, y1
Â¢
(x (y1) âˆ’x (y2)) = âˆ’M (y1 âˆ’y2)
(5.37)
where M is the matrix whose ith row is D2fi
Â¡
x (y2) , yiÂ¢
. Then from 5.35 there
exists a constant, C independent of the choice of y âˆˆB (y0, Î·) such that
Â¯Â¯Â¯
Â¯Â¯Â¯J
Â¡
x1, Â· Â· Â·, xn, y
Â¢âˆ’1Â¯Â¯Â¯
Â¯Â¯Â¯ < C
whenever
Â¡
x1, Â· Â· Â·, xnÂ¢
âˆˆB (x0, Î´)
n. By continuity of the partial derivatives of f it
also follows there exists a constant, C1 such that ||D2fi (x, y)|| < C1 whenever,
(x, y) âˆˆB (x0, Î´) Ã— B (y0, Î·) . Hence ||M|| must also be bounded independent of
the choice of y1 and y2 in B (y0, Î·) . From 5.37, it follows there exists a constant,
C such that for all y1, y2 in B (y0, Î·) ,
|x (y1) âˆ’x (y2)| â‰¤C |y1 âˆ’y2| .
(5.38)
It follows as in the proof of the chain rule that
o (x (y + v) âˆ’x (y)) = o (v) .
(5.39)
Now let y âˆˆB (y0, Î·) and let |v| be suï¬ƒciently small that y + v âˆˆB (y0, Î·) .
Then
0
=
f (x (y + v) , y + v) âˆ’f (x (y) , y)
=
f (x (y + v) , y + v) âˆ’f (x (y + v) , y) + f (x (y + v) , y) âˆ’f (x (y) , y)
= D2f (x (y + v) , y) v + D1f (x (y) , y) (x (y + v) âˆ’x (y)) + o (|x (y + v) âˆ’x (y)|)
=
D2f (x (y) , y) v + D1f (x (y) , y) (x (y + v) âˆ’x (y)) +
o (|x (y + v) âˆ’x (y)|) + (D2f (x (y + v) , y) vâˆ’D2f (x (y) , y) v)
=
D2f (x (y) , y) v + D1f (x (y) , y) (x (y + v) âˆ’x (y)) + o (v) .
Therefore,
x (y + v) âˆ’x (y) = âˆ’D1f (x (y) , y)âˆ’1 D2f (x (y) , y) v + o (v)

128
MULTI-VARIABLE CALCULUS
which shows that Dx (y) = âˆ’D1f (x (y) , y)âˆ’1 D2f (x (y) , y) and y â†’Dx (y) is
continuous. This proves the theorem.
In practice, how do you verify the condition, D1f (x0, y0)âˆ’1 âˆˆL (Fn, Fn)?
f (x, y) =
ï£«
ï£¬
ï£­
f1 (x1, Â· Â· Â·, xn, y1, Â· Â· Â·, yn)
...
fn (x1, Â· Â· Â·, xn, y1, Â· Â· Â·, yn)
ï£¶
ï£·
ï£¸.
The matrix of the linear transformation, D1f (x0, y0) is then
ï£«
ï£¬
ï£¬
ï£­
âˆ‚f1(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚x1
Â· Â· Â·
âˆ‚f1(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚xn
...
...
âˆ‚fn(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚x1
Â· Â· Â·
âˆ‚fn(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚xn
ï£¶
ï£·
ï£·
ï£¸
and from linear algebra, D1f (x0, y0)âˆ’1 âˆˆL (Fn, Fn) exactly when the above matrix
has an inverse. In other words when
det
ï£«
ï£¬
ï£¬
ï£­
âˆ‚f1(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚x1
Â· Â· Â·
âˆ‚f1(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚xn
...
...
âˆ‚fn(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚x1
Â· Â· Â·
âˆ‚fn(x1,Â·Â·Â·,xn,y1,Â·Â·Â·,yn)
âˆ‚xn
ï£¶
ï£·
ï£·
ï£¸Ì¸= 0
at (x0, y0). The above determinant is important enough that it is given special
notation. Letting z = f (x, y) , the above determinant is often written as
âˆ‚(z1, Â· Â· Â·, zn)
âˆ‚(x1, Â· Â· Â·, xn).
Of course you can replace R with F in the above by applying the above to the
situation in which each F is replaced with R2.
Corollary 5.67 (implicit function theorem) Suppose U is an open set in Fn Ã— Fm.
Let f : U â†’Fn be in C1 (U) and suppose
f (x0, y0) = 0, D1f (x0, y0)âˆ’1 âˆˆL (Fn, Fn) .
(5.40)
Then there exist positive constants, Î´, Î·, such that for every y âˆˆB (y0, Î·) there
exists a unique x (y) âˆˆB (x0, Î´) such that
f (x (y) , y) = 0.
(5.41)
Furthermore, the mapping, y â†’x (y) is in C1 (B (y0, Î·)).
The next theorem is a very important special case of the implicit function the-
orem known as the inverse function theorem.
Actually one can also obtain the
implicit function theorem from the inverse function theorem. It is done this way in
[36] and in [3].

5.16.
IMPLICIT FUNCTION THEOREM
129
Theorem 5.68 (inverse function theorem) Let x0 âˆˆU âŠ†Fn and let f : U â†’Fn .
Suppose
f is C1 (U) ,
and Df(x0)âˆ’1 âˆˆL(Fn, Fn).
(5.42)
Then there exist open sets, W, and V such that
x0 âˆˆW âŠ†U,
(5.43)
f : W â†’V is one to one and onto,
(5.44)
f âˆ’1 is C1.
(5.45)
Proof: Apply the implicit function theorem to the function
F (x, y) â‰¡f (x) âˆ’y
where y0 â‰¡f (x0). Thus the function y â†’x (y) deï¬ned in that theorem is f âˆ’1.
Now let
W â‰¡B (x0, Î´) âˆ©f âˆ’1 (B (y0, Î·))
and
V â‰¡B (y0, Î·) .
This proves the theorem.
5.16.1
More Continuous Partial Derivatives
Corollary 5.67 will now be improved slightly. If f is Ck, it follows that the function
which is implicitly deï¬ned is also in Ck, not just C1. Since the inverse function
theorem comes as a case of the implicit function theorem, this shows that the
inverse function also inherits the property of being Ck.
Theorem 5.69 (implicit function theorem) Suppose U is an open set in Fn Ã— Fm.
Let f : U â†’Fn be in Ck (U) and suppose
f (x0, y0) = 0, D1f (x0, y0)âˆ’1 âˆˆL (Fn, Fn) .
(5.46)
Then there exist positive constants, Î´, Î·, such that for every y âˆˆB (y0, Î·) there
exists a unique x (y) âˆˆB (x0, Î´) such that
f (x (y) , y) = 0.
(5.47)
Furthermore, the mapping, y â†’x (y) is in Ck (B (y0, Î·)).
Proof: From Corollary 5.67 y â†’x (y) is C1. It remains to show it is Ck for
k > 1 assuming that f is Ck. From 5.47
âˆ‚x
âˆ‚yl = âˆ’D1 (x, y)âˆ’1 âˆ‚f
âˆ‚yl .

130
MULTI-VARIABLE CALCULUS
Thus the following formula holds for q = 1 and |Î±| = q.
DÎ±x (y) =
X
|Î²|â‰¤q
MÎ² (x, y) DÎ²f (x, y)
(5.48)
where MÎ² is a matrix whose entries are diï¬€erentiable functions of DÎ³ (x) for |Î³| < q
and DÏ„f (x, y) for |Ï„| â‰¤q. This follows easily from the description of D1 (x, y)âˆ’1 in
terms of the cofactor matrix and the determinant of D1 (x, y). Suppose 5.48 holds
for |Î±| = q < k. Then by induction, this yields x is Cq. Then
âˆ‚DÎ±x (y)
âˆ‚yp
=
X
|Î²|â‰¤|Î±|
âˆ‚MÎ² (x, y)
âˆ‚yp
DÎ²f (x, y) + MÎ² (x, y) âˆ‚DÎ²f (x, y)
âˆ‚yp
.
By the chain rule âˆ‚MÎ²(x,y)
âˆ‚yp
is a matrix whose entries are diï¬€erentiable functions of
DÏ„f (x, y) for |Ï„| â‰¤q+1 and DÎ³ (x) for |Î³| < q+1. It follows since yp was arbitrary
that for any |Î±| = q + 1, a formula like 5.48 holds with q being replaced by q + 1.
By induction, x is Ck. This proves the theorem.
As a simple corollary this yields an improved version of the inverse function
theorem.
Theorem 5.70 (inverse function theorem) Let x0 âˆˆU âŠ†Fn and let f : U â†’Fn .
Suppose for k a positive integer,
f is Ck (U) ,
and Df(x0)âˆ’1 âˆˆL(Fn, Fn).
(5.49)
Then there exist open sets, W, and V such that
x0 âˆˆW âŠ†U,
(5.50)
f : W â†’V is one to one and onto,
(5.51)
f âˆ’1 is Ck.
(5.52)
5.17
The Method Of Lagrange Multipliers
As an application of the implicit function theorem, consider the method of Lagrange
multipliers from calculus. Recall the problem is to maximize or minimize a function
subject to equality constraints. Let f : U â†’R be a C1 function where U âŠ†Rn and
let
gi (x) = 0, i = 1, Â· Â· Â·, m
(5.53)
be a collection of equality constraints with m < n. Now consider the system of
nonlinear equations
f (x)
=
a
gi (x)
=
0, i = 1, Â· Â· Â·, m.

5.17.
THE METHOD OF LAGRANGE MULTIPLIERS
131
x0 is a local maximum if f (x0) â‰¥f (x) for all x near x0 which also satisï¬es the
constraints 5.53. A local minimum is deï¬ned similarly. Let F : U Ã— R â†’Rm+1 be
deï¬ned by
F (x,a) â‰¡
ï£«
ï£¬
ï£¬
ï£¬
ï£­
f (x) âˆ’a
g1 (x)
...
gm (x)
ï£¶
ï£·
ï£·
ï£·
ï£¸.
(5.54)
Now consider the m + 1 Ã— n Jacobian matrix,
ï£«
ï£¬
ï£¬
ï£¬
ï£­
fx1 (x0)
Â· Â· Â·
fxn (x0)
g1x1 (x0)
Â· Â· Â·
g1xn (x0)
...
...
gmx1 (x0)
Â· Â· Â·
gmxn (x0)
ï£¶
ï£·
ï£·
ï£·
ï£¸.
If this matrix has rank m + 1 then some m + 1 Ã— m + 1 submatrix has nonzero
determinant. It follows from the implicit function theorem that there exist m + 1
variables, xi1, Â· Â· Â·, xim+1 such that the system
F (x,a) = 0
(5.55)
speciï¬es these m + 1 variables as a function of the remaining n âˆ’(m + 1) variables
and a in an open set of Rnâˆ’m. Thus there is a solution (x,a) to 5.55 for some x
close to x0 whenever a is in some open interval. Therefore, x0 cannot be either a
local minimum or a local maximum. It follows that if x0 is either a local maximum
or a local minimum, then the above matrix must have rank less than m + 1 which
requires the rows to be linearly dependent. Thus, there exist m scalars,
Î»1, Â· Â· Â·, Î»m,
and a scalar Âµ, not all zero such that
Âµ
ï£«
ï£¬
ï£­
fx1 (x0)
...
fxn (x0)
ï£¶
ï£·
ï£¸= Î»1
ï£«
ï£¬
ï£­
g1x1 (x0)
...
g1xn (x0)
ï£¶
ï£·
ï£¸+ Â· Â· Â· + Î»m
ï£«
ï£¬
ï£­
gmx1 (x0)
...
gmxn (x0)
ï£¶
ï£·
ï£¸.
(5.56)
If the column vectors
ï£«
ï£¬
ï£­
g1x1 (x0)
...
g1xn (x0)
ï£¶
ï£·
ï£¸, Â· Â· Â·
ï£«
ï£¬
ï£­
gmx1 (x0)
...
gmxn (x0)
ï£¶
ï£·
ï£¸
(5.57)
are linearly independent, then, Âµ Ì¸= 0 and dividing by Âµ yields an expression of the
form
ï£«
ï£¬
ï£­
fx1 (x0)
...
fxn (x0)
ï£¶
ï£·
ï£¸= Î»1
ï£«
ï£¬
ï£­
g1x1 (x0)
...
g1xn (x0)
ï£¶
ï£·
ï£¸+ Â· Â· Â· + Î»m
ï£«
ï£¬
ï£­
gmx1 (x0)
...
gmxn (x0)
ï£¶
ï£·
ï£¸
(5.58)

132
MULTI-VARIABLE CALCULUS
at every point x0 which is either a local maximum or a local minimum. This proves
the following theorem.
Theorem 5.71 Let U be an open subset of Rn and let f : U â†’R be a C1 function.
Then if x0 âˆˆU is either a local maximum or local minimum of f subject to the
constraints 5.53, then 5.56 must hold for some scalars Âµ, Î»1, Â· Â· Â·, Î»m not all equal to
zero. If the vectors in 5.57 are linearly independent, it follows that an equation of
the form 5.58 holds.

Metric Spaces And General
Topological Spaces
6.1
Metric Space
Deï¬nition 6.1 A metric space is a set, X and a function d : X Ã— X â†’[0, âˆž)
which satisï¬es the following properties.
d (x, y) = d (y, x)
d (x, y) â‰¥0 and d (x, y) = 0 if and only if x = y
d (x, y) â‰¤d (x, z) + d (z, y) .
You can check that Rn and Cn are metric spaces with d (x, y) = |x âˆ’y| . How-
ever, there are many others. The deï¬nitions of open and closed sets are the same
for a metric space as they are for Rn.
Deï¬nition 6.2 A set, U in a metric space is open if whenever x âˆˆU, there exists
r > 0 such that B (x, r) âŠ†U. As before, B (x, r) â‰¡{y : d (x, y) < r} . Closed sets are
those whose complements are open. A point p is a limit point of a set, S if for every
r > 0, B (p, r) contains inï¬nitely many points of S. A sequence, {xn} converges to
a point x if for every Îµ > 0 there exists N such that if n â‰¥N, then d (x, xn) < Îµ.
{xn} is a Cauchy sequence if for every Îµ > 0 there exists N such that if m, n â‰¥N,
then d (xn, xm) < Îµ.
Lemma 6.3 In a metric space, X every ball, B (x, r) is open. A set is closed if
and only if it contains all its limit points. If p is a limit point of S, then there exists
a sequence of distinct points of S, {xn} such that limnâ†’âˆžxn = p.
Proof: Let z âˆˆB (x, r). Let Î´ = r âˆ’d (x, z) . Then if w âˆˆB (z, Î´) ,
d (w, x) â‰¤d (x, z) + d (z, w) < d (x, z) + r âˆ’d (x, z) = r.
Therefore, B (z, Î´) âŠ†B (x, r) and this shows B (x, r) is open.
The properties of balls are presented in the following theorem.
133

134
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
Theorem 6.4 Suppose (X, d) is a metric space.
Then the sets {B(x, r) : r >
0, x âˆˆX} satisfy
âˆª{B(x, r) : r > 0, x âˆˆX} = X
(6.1)
If p âˆˆB (x, r1) âˆ©B (z, r2), there exists r > 0 such that
B (p, r) âŠ†B (x, r1) âˆ©B (z, r2) .
(6.2)
Proof:
Observe that the union of these balls includes the whole space, X so
6.1 is obvious. Consider 6.2. Let p âˆˆB (x, r1) âˆ©B (z, r2). Consider
r â‰¡min (r1 âˆ’d (x, p) , r2 âˆ’d (z, p))
and suppose y âˆˆB (p, r). Then
d (y, x) â‰¤d (y, p) + d (p, x) < r1 âˆ’d (x, p) + d (x, p) = r1
and so B (p, r) âŠ†B (x, r1). By similar reasoning, B (p, r) âŠ†B (z, r2). This proves
the theorem.
Let K be a closed set. This means KC â‰¡X \ K is an open set. Let p be a
limit point of K. If p âˆˆKC, then since KC is open, there exists B (p, r) âŠ†KC. But
this contradicts p being a limit point because there are no points of K in this ball.
Hence all limit points of K must be in K.
Suppose next that K contains its limit points.
Is KC open?
Let p âˆˆKC.
Then p is not a limit point of K. Therefore, there exists B (p, r) which contains at
most ï¬nitely many points of K. Since p /âˆˆK, it follows that by making r smaller if
necessary, B (p, r) contains no points of K. That is B (p, r) âŠ†KC showing KC is
open. Therefore, K is closed.
Suppose now that p is a limit point of S. Let x1 âˆˆ(S \ {p})âˆ©B (p, 1) . If x1, Â·Â·Â·, xk
have been chosen, let
rk+1 â‰¡min
Â½
d (p, xi) , i = 1, Â· Â· Â·, k,
1
k + 1
Â¾
.
Let xk+1 âˆˆ(S \ {p}) âˆ©B (p, rk+1) . This proves the lemma.
Lemma 6.5 If {xn} is a Cauchy sequence in a metric space, X and if some subse-
quence, {xnk} converges to x, then {xn} converges to x. Also if a sequence converges,
then it is a Cauchy sequence.
Proof: Note ï¬rst that nk â‰¥k because in a subsequence, the indices, n1, n2, Â·Â·Â· are
strictly increasing. Let Îµ > 0 be given and let N be such that for k > N, d (x, xnk) <
Îµ/2 and for m, n â‰¥N, d (xm, xn) < Îµ/2. Pick k > n. Then if n > N,
d (xn, x) â‰¤d (xn, xnk) + d (xnk, x) < Îµ
2 + Îµ
2 = Îµ.
Finally, suppose limnâ†’âˆžxn = x. Then there exists N such that if n > N, then
d (xn, x) < Îµ/2. it follows that for m, n > N,
d (xn, xm) â‰¤d (xn, x) + d (x, xm) < Îµ
2 + Îµ
2 = Îµ.

6.2.
COMPACTNESS IN METRIC SPACE
135
This proves the lemma.
A useful idea is the idea of distance from a point to a set.
Deï¬nition 6.6 Let (X, d) be a metric space and let S be a nonempty set in X.
Then
dist (x, S) â‰¡inf {d (x, y) : y âˆˆS} .
The following lemma is the fundamental result.
Lemma 6.7 The function, x â†’dist (x, S) is continuous and in fact satisï¬es
|dist (x, S) âˆ’dist (y, S)| â‰¤d (x, y) .
Proof: Suppose dist (x, y) is as least as large as dist (y, S). Then pick z âˆˆS
such that d (y, z) â‰¤dist (y, S) + Îµ. Then
|dist (x, S) âˆ’dist (y, S)|
=
dist (x, S) âˆ’dist (y, S)
â‰¤
d (x, z) âˆ’(d (y, z) âˆ’Îµ)
=
d (x, z) âˆ’d (y, z) + Îµ
â‰¤
d (x, y) + d (y, z) âˆ’d (y, z) + Îµ
=
d (x, y) + Îµ.
Since Îµ > 0 is arbitrary, this proves the lemma.
6.2
Compactness In Metric Space
Many existence theorems in analysis depend on some set being compact. Therefore,
it is important to be able to identify compact sets. The purpose of this section is
to describe compact sets in a metric space.
Deï¬nition 6.8 Let A be a subset of X. A is compact if whenever A is contained
in the union of a set of open sets, there exists ï¬nitely many of these open sets whose
union contains A.
(Every open cover admits a ï¬nite subcover.) A is â€œsequen-
tially compactâ€ means every sequence has a convergent subsequence converging to
an element of A.
In a metric space compact is not the same as closed and bounded!
Example 6.9 Let X be any inï¬nite set and deï¬ne d (x, y) = 1 if x Ì¸= y while
d (x, y) = 0 if x = y.
You should verify the details that this is a metric space because it satisï¬es the
axioms of a metric. The set X
is closed and bounded because its complement is
âˆ…which is clearly open because every point of âˆ…is an interior point. (There are
none.) Also X is bounded because X = B (x, 2). However, X is clearly not compact
because
Â©
B
Â¡
x, 1
2
Â¢
: x âˆˆX
Âª
is a collection of open sets whose union contains X but

136
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
since they are all disjoint and nonempty, there is no ï¬nite subset of these whose
union contains X. In fact B
Â¡
x, 1
2
Â¢
= {x}.
From this example it is clear something more than closed and bounded is needed.
If you are not familiar with the issues just discussed, ignore them and continue.
Deï¬nition 6.10 In any metric space, a set E is totally bounded if for every Îµ > 0
there exists a ï¬nite set of points {x1, Â· Â· Â·, xn} such that
E âŠ†âˆªn
i=1B (xi, Îµ).
This ï¬nite set of points is called an Îµ net.
The following proposition tells which sets in a metric space are compact. First
here is an interesting lemma.
Lemma 6.11 Let X be a metric space and suppose D is a countable dense subset
of X. In other words, it is being assumed X is a separable metric space. Consider
the open sets of the form B (d, r) where r is a positive rational number and d âˆˆD.
Denote this countable collection of open sets by B. Then every open set is the union
of sets of B. Furthermore, if C is any collection of open sets, there exists a countable
subset, {Un} âŠ†C such that âˆªnUn = âˆªC.
Proof: Let U be an open set and let x âˆˆU. Let B (x, Î´) âŠ†U. Then by density of
D, there exists d âˆˆDâˆ©B (x, Î´/4) . Now pick r âˆˆQâˆ©(Î´/4, 3Î´/4) and consider B (d, r) .
Clearly, B (d, r) contains the point x because r > Î´/4. Is B (d, r) âŠ†B (x, Î´)? if so,
this proves the lemma because x was an arbitrary point of U. Suppose z âˆˆB (d, r) .
Then
d (z, x) â‰¤d (z, d) + d (d, x) < r + Î´
4 < 3Î´
4 + Î´
4 = Î´
Now let C be any collection of open sets. Each set in this collection is the union
of countably many sets of B. Let Bâ€² denote the sets of B which are contained in
some set of C. Thus âˆªBâ€² = âˆªC. Then for each B âˆˆBâ€², pick UB âˆˆC such that
B âŠ†UB. Then {UB : B âˆˆBâ€²} is a countable collection of sets of C whose union
equals âˆªC. Therefore, this proves the lemma.
Proposition 6.12 Let (X, d) be a metric space. Then the following are equivalent.
(X, d) is compact,
(6.3)
(X, d) is sequentially compact,
(6.4)
(X, d) is complete and totally bounded.
(6.5)
Proof: Suppose 6.3 and let {xk} be a sequence. Suppose {xk} has no convergent
subsequence. If this is so, then by Lemma 6.3, {xk} has no limit point and no value
of the sequence is repeated more than ï¬nitely many times. Thus the set
Cn = âˆª{xk : k â‰¥n}

6.2.
COMPACTNESS IN METRIC SPACE
137
is a closed set because it has no limit points and if
Un = CC
n ,
then
X = âˆªâˆž
n=1Un
but there is no ï¬nite subcovering, because no value of the sequence is repeated more
than ï¬nitely many times. This contradicts compactness of (X, d). This shows 6.3
implies 6.4.
Now suppose 6.4 and let {xn} be a Cauchy sequence. Is {xn} convergent? By
sequential compactness xnk â†’x for some subsequence. By Lemma 6.5 it follows
that {xn} also converges to x showing that (X, d) is complete.
If (X, d) is not
totally bounded, then there exists Îµ > 0 for which there is no Îµ net. Hence there
exists a sequence {xk} with d (xk, xl) â‰¥Îµ for all l Ì¸= k.
By Lemma 6.5 again,
this contradicts 6.4 because no subsequence can be a Cauchy sequence and so no
subsequence can converge. This shows 6.4 implies 6.5.
Now suppose 6.5. What about 6.4? Let {pn} be a sequence and let {xn
i }mn
i=1 be
a 2âˆ’n net for n = 1, 2, Â· Â· Â·. Let
Bn â‰¡B
Â¡
xn
in, 2âˆ’nÂ¢
be such that Bn contains pk for inï¬nitely many values of k and Bn âˆ©Bn+1 Ì¸= âˆ….
To do this, suppose Bn contains pk for inï¬nitely many values of k. Then one of
the sets which intersect Bn, B
Â¡
xn+1
i
, 2âˆ’(n+1)Â¢
must contain pk for inï¬nitely many
values of k because all these indices of points from {pn} contained in Bn must be
accounted for in one of ï¬nitely many sets, B
Â¡
xn+1
i
, 2âˆ’(n+1)Â¢
. Thus there exists a
strictly increasing sequence of integers, nk such that
pnk âˆˆBk.
Then if k â‰¥l,
d (pnk, pnl)
â‰¤
kâˆ’1
X
i=l
d
Â¡
pni+1, pni
Â¢
<
kâˆ’1
X
i=l
2âˆ’(iâˆ’1) < 2âˆ’(lâˆ’2).
Consequently {pnk} is a Cauchy sequence. Hence it converges because the metric
space is complete. This proves 6.4.
Now suppose 6.4 and 6.5 which have now been shown to be equivalent. Let Dn
be a nâˆ’1 net for n = 1, 2, Â· Â· Â· and let
D = âˆªâˆž
n=1Dn.
Thus D is a countable dense subset of (X, d).

138
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
Now let C be any set of open sets such that âˆªC âŠ‡X. By Lemma 6.11, there
exists a countable subset of C,
eC = {Un}âˆž
n=1
such that âˆªeC = âˆªC. If C admits no ï¬nite subcover, then neither does eC and there ex-
ists pn âˆˆX \âˆªn
k=1Uk. Then since X is sequentially compact, there is a subsequence
{pnk} such that {pnk} converges. Say
p = lim
kâ†’âˆžpnk.
All but ï¬nitely many points of {pnk} are in X \ âˆªn
k=1Uk. Therefore p âˆˆX \ âˆªn
k=1Uk
for each n. Hence
p /âˆˆâˆªâˆž
k=1Uk
contradicting the construction of {Un}âˆž
n=1 which required that âˆªâˆž
n=1Un âŠ‡X. Hence
X is compact. This proves the proposition.
Consider Rn. In this setting totally bounded and bounded are the same. This
will yield a proof of the Heine Borel theorem from advanced calculus.
Lemma 6.13 A subset of Rn is totally bounded if and only if it is bounded.
Proof: Let A be totally bounded. Is it bounded? Let x1, Â· Â· Â·, xp be a 1 net for
A. Now consider the ball B (0, r + 1) where r > max (|xi| : i = 1, Â· Â· Â·, p) . If z âˆˆA,
then z âˆˆB (xj, 1) for some j and so by the triangle inequality,
|z âˆ’0| â‰¤|z âˆ’xj| + |xj| < 1 + r.
Thus A âŠ†B (0,r + 1) and so A is bounded.
Now suppose A is bounded and suppose A is not totally bounded. Then there
exists Îµ > 0 such that there is no Îµ net for A. Therefore, there exists a sequence of
points {ai} with |ai âˆ’aj| â‰¥Îµ if i Ì¸= j. Since A is bounded, there exists r > 0 such
that
A âŠ†[âˆ’r, r)n.
(x âˆˆ[âˆ’r, r)n means xi âˆˆ[âˆ’r, r) for each i.) Now deï¬ne S to be all cubes of the form
n
Y
k=1
[ak, bk)
where
ak = âˆ’r + i2âˆ’pr, bk = âˆ’r + (i + 1) 2âˆ’pr,
for i âˆˆ{0, 1, Â· Â· Â·, 2p+1 âˆ’1}. Thus S is a collection of
Â¡
2p+1Â¢n non overlapping cubes
whose union equals [âˆ’r, r)n and whose diameters are all equal to 2âˆ’prâˆšn. Now
choose p large enough that the diameter of these cubes is less than Îµ. This yields a
contradiction because one of the cubes must contain inï¬nitely many points of {ai}.
This proves the lemma.
The next theorem is called the Heine Borel theorem and it characterizes the
compact sets in Rn.

6.3.
SOME APPLICATIONS OF COMPACTNESS
139
Theorem 6.14 A subset of Rn is compact if and only if it is closed and bounded.
Proof: Since a set in Rn is totally bounded if and only if it is bounded, this
theorem follows from Proposition 6.12 and the observation that a subset of Rn is
closed if and only if it is complete. This proves the theorem.
6.3
Some Applications Of Compactness
The following corollary is an important existence theorem which depends on com-
pactness.
Corollary 6.15 Let X be a compact metric space and let f : X â†’R be continuous.
Then max {f (x) : x âˆˆX} and min {f (x) : x âˆˆX} both exist.
Proof: First it is shown f (X) is compact. Suppose C is a set of open sets whose
union contains f (X). Then since f is continuous f âˆ’1 (U) is open for all U âˆˆC.
Therefore,
Â©
f âˆ’1 (U) : U âˆˆC
Âª
is a collection of open sets whose union contains X.
Since X is compact, it follows ï¬nitely many of these,
Â©
f âˆ’1 (U1) , Â· Â· Â·, f âˆ’1 (Up)
Âª
contains X in their union. Therefore, f (X) âŠ†âˆªp
k=1Uk showing f (X) is compact
as claimed.
Now since f (X) is compact, Theorem 6.14 implies f (X) is closed and bounded.
Therefore, it contains its inf and its sup. Thus f achieves both a maximum and a
minimum.
Deï¬nition 6.16 Let X, Y be metric spaces and f : X â†’Y a function.
f is
uniformly continuous if for all Îµ > 0 there exists Î´ > 0 such that whenever x1 and
x2 are two points of X satisfying d (x1, x2) < Î´, it follows that d (f (x1) , f (x2)) < Îµ.
A very important theorem is the following.
Theorem 6.17 Suppose f : X â†’Y is continuous and X is compact. Then f is
uniformly continuous.
Proof: Suppose this is not true and that f is continuous but not uniformly
continuous. Then there exists Îµ > 0 such that for all Î´ > 0 there exist points,
pÎ´ and qÎ´ such that d (pÎ´, qÎ´) < Î´ and yet d (f (pÎ´) , f (qÎ´)) â‰¥Îµ. Let pn and qn
be the points which go with Î´ = 1/n. By Proposition 6.12 {pn} has a convergent
subsequence, {pnk} converging to a point, x âˆˆX. Since d (pn, qn) < 1
n, it follows
that qnk â†’x also. Therefore,
Îµ â‰¤d (f (pnk) , f (qnk)) â‰¤d (f (pnk) , f (x)) + d (f (x) , f (qnk))
but by continuity of f, both d (f (pnk) , f (x)) and d (f (x) , f (qnk)) converge to 0
as k â†’âˆžcontradicting the above inequality. This proves the theorem.
Another important property of compact sets in a metric space concerns the ï¬nite
intersection property.

140
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
Deï¬nition 6.18 If every ï¬nite subset of a collection of sets has nonempty inter-
section, the collection has the ï¬nite intersection property.
Theorem 6.19 Suppose F is a collection of compact sets in a metric space, X
which has the ï¬nite intersection property. Then there exists a point in their inter-
section. (âˆ©F Ì¸= âˆ…).
Proof: If this were not so, âˆª
Â©
F C : F âˆˆF
Âª
= X and so, in particular, picking
some F0 âˆˆF,
Â©
F C : F âˆˆF
Âª
would be an open cover of F0. Since F0 is compact,
some ï¬nite subcover, F C
1 , Â· Â· Â·, F C
m exists. But then F0 âŠ†âˆªm
k=1F C
k
which means
âˆ©âˆž
k=0Fk = âˆ…, contrary to the ï¬nite intersection property.
Theorem 6.20 Let Xi be a compact metric space with metric di. Then Qm
i=1 Xi is
also a compact metric space with respect to the metric, d (x, y) â‰¡maxi (di (xi, yi)).
Proof: This is most easily seen from sequential compactness.
Let
Â©
xkÂªâˆž
k=1
be a sequence of points in Qm
i=1 Xi.
Consider the ith component of xk, xk
i .
It
follows
Â©
xk
i
Âª
is a sequence of points in Xi and so it has a convergent subsequence.
Compactness of X1 implies there exists a subsequence of xk, denoted by
Â©
xk1Âª
such
that
lim
k1â†’âˆžxk1
1 â†’x1 âˆˆX1.
Now there exists a further subsequence, denoted by
Â©
xk2Âª
such that in addition to
this, xk2
2 â†’x2 âˆˆX2. After taking m such subsequences, there exists a subsequence,
Â©
xlÂª
such that limlâ†’âˆžxl
i = xi âˆˆXi for each i. Therefore, letting x â‰¡(x1, Â· Â· Â·, xm),
xl â†’x in Qm
i=1 Xi. This proves the theorem.
6.4
Ascoli Arzela Theorem
Deï¬nition 6.21 Let (X, d) be a complete metric space. Then it is said to be locally
compact if B (x, r) is compact for each r > 0.
Thus if you have a locally compact metric space, then if {an} is a bounded
sequence, it must have a convergent subsequence.
Let K be a compact subset of Rn and consider the continuous functions which
have values in a locally compact metric space, (X, d) where d denotes the metric on
X. Denote this space as C (K, X) .
Deï¬nition 6.22 For f, g âˆˆC (K, X) , where K is a compact subset of Rn and X
is a locally compact complete metric space deï¬ne
ÏK (f, g) â‰¡sup {d (f (x) , g (x)) : x âˆˆK} .
Then ÏK provides a distance which makes C (K, X) into a metric space.
The Ascoli Arzela theorem is a major result which tells which subsets of C (K, X)
are sequentially compact.

6.4.
ASCOLI ARZELA THEOREM
141
Deï¬nition 6.23 Let A âŠ†C (K, X) for K a compact subset of Rn. Then A is said
to be uniformly equicontinuous if for every Îµ > 0 there exists a Î´ > 0 such that
whenever x, y âˆˆK with |x âˆ’y| < Î´ and f âˆˆA,
d (f (x) , f (y)) < Îµ.
The set, A is said to be uniformly bounded if for some M < âˆž, and a âˆˆX,
f (x) âˆˆB (a, M)
for all f âˆˆA and x âˆˆK.
Uniform equicontinuity is like saying that the whole set of functions, A, is uni-
formly continuous on K uniformly for f âˆˆA. The version of the Ascoli Arzela
theorem I will present here is the following.
Theorem 6.24 Suppose K is a nonempty compact subset of Rn and A âŠ†C (K, X)
is uniformly bounded and uniformly equicontinuous. Then if {fk} âŠ†A, there exists
a function, f âˆˆC (K, X) and a subsequence, fkl such that
lim
lâ†’âˆžÏK (fkl, f) = 0.
To give a proof of this theorem, I will ï¬rst prove some lemmas.
Lemma 6.25 If K is a compact subset of Rn, then there exists D â‰¡{xk}âˆž
k=1 âŠ†K
such that D is dense in K. Also, for every Îµ > 0 there exists a ï¬nite set of points,
{x1, Â· Â· Â·, xm} âŠ†K, called an Îµ net such that
âˆªm
i=1B (xi, Îµ) âŠ‡K.
Proof: For m âˆˆN, pick xm
1 âˆˆK. If every point of K is within 1/m of xm
1 , stop.
Otherwise, pick
xm
2 âˆˆK \ B (xm
1 , 1/m) .
If every point of K contained in B (xm
1 , 1/m) âˆªB (xm
2 , 1/m) , stop. Otherwise, pick
xm
3 âˆˆK \ (B (xm
1 , 1/m) âˆªB (xm
2 , 1/m)) .
If every point of K is contained in B (xm
1 , 1/m) âˆªB (xm
2 , 1/m) âˆªB (xm
3 , 1/m) , stop.
Otherwise, pick
xm
4 âˆˆK \ (B (xm
1 , 1/m) âˆªB (xm
2 , 1/m) âˆªB (xm
3 , 1/m))
Continue this way until the process stops, say at N (m).
It must stop because
if it didnâ€™t, there would be a convergent subsequence due to the compactness of
K. Ultimately all terms of this convergent subsequence would be closer than 1/m,
violating the manner in which they are chosen. Then D = âˆªâˆž
m=1 âˆªN(m)
k=1
{xm
k } . This
is countable because it is a countable union of countable sets. If y âˆˆK and Îµ > 0,
then for some m, 2/m < Îµ and so B (y, Îµ) must contain some point of {xm
k } since
otherwise, the process stopped too soon. You could have picked y. This proves the
lemma.

142
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
Lemma 6.26 Suppose D is deï¬ned above and {gm} is a sequence of functions of
A having the property that for every xk âˆˆD,
lim
mâ†’âˆžgm (xk) exists.
Then there exists g âˆˆC (K, X) such that
lim
mâ†’âˆžÏ (gm, g) = 0.
Proof: Deï¬ne g ï¬rst on D.
g (xk) â‰¡lim
mâ†’âˆžgm (xk) .
Next I show that {gm} converges at every point of K. Let x âˆˆK and let Îµ > 0 be
given. Choose xk such that for all f âˆˆA,
d (f (xk) , f (x)) < Îµ
3.
I can do this by the equicontinuity. Now if p, q are large enough, say p, q â‰¥M,
d (gp (xk) , gq (xk)) < Îµ
3.
Therefore, for p, q â‰¥M,
d (gp (x) , gq (x))
â‰¤
d (gp (x) , gp (xk)) + d (gp (xk) , gq (xk)) + d (gq (xk) , gq (x))
<
Îµ
3 + Îµ
3 + Îµ
3 = Îµ
It follows that {gm (x)} is a Cauchy sequence having values X. Therefore, it con-
verges. Let g (x) be the name of the thing it converges to.
Let Îµ > 0 be given and pick Î´ > 0 such that whenever x, y âˆˆK and |x âˆ’y| < Î´,
it follows d (f (x) , f (y)) < Îµ
3 for all f âˆˆA. Now let {x1, Â· Â· Â·, xm} be a Î´ net for K
as in Lemma 6.25. Since there are only ï¬nitely many points in this Î´ net, it follows
that there exists N such that for all p, q â‰¥N,
d (gq (xi) , gp (xi)) < Îµ
3
for all {x1, Â· Â· Â·, xm} Â· Therefore, for arbitrary x âˆˆK, pick xi âˆˆ{x1, Â· Â· Â·, xm} such
that |xi âˆ’x| < Î´. Then
d (gq (x) , gp (x))
â‰¤
d (gq (x) , gq (xi)) + d (gq (xi) , gp (xi)) + d (gp (xi) , gp (x))
<
Îµ
3 + Îµ
3 + Îµ
3 = Îµ.
Since N does not depend on the choice of x, it follows this sequence {gm} is uni-
formly Cauchy. That is, for every Îµ > 0, there exists N such that if p, q â‰¥N,
then
Ï (gp, gq) < Îµ.

6.4.
ASCOLI ARZELA THEOREM
143
Next, I need to verify that the function, g is a continuous function. Let N be
large enough that whenever p, q â‰¥N, the above holds. Then for all x âˆˆK,
d (g (x) , gp (x)) â‰¤Îµ
3
(6.6)
whenever p â‰¥N. This follows from observing that for p, q â‰¥N,
d (gq (x) , gp (x)) < Îµ
3
and then taking the limit as q â†’âˆžto obtain 6.6. In passing to the limit, you can
use the following simple claim.
Claim: In a metric space, if an â†’a, then d (an, b) â†’d (a, b) .
Proof of the claim: You note that by the triangle inequality, d (an, b) âˆ’
d (a, b) â‰¤d (an, a) and d (a, b) âˆ’d (an, b) â‰¤d (an, a) and so
|d (an, b) âˆ’d (a, b)| â‰¤d (an, a) .
Now let p satisfy 6.6 for all x whenever p > N. Also pick Î´ > 0 such that if
|x âˆ’y| < Î´, then
d (gp (x) , gp (y)) < Îµ
3.
Then if |x âˆ’y| < Î´,
d (g (x) , g (y))
â‰¤
d (g (x) , gp (x)) + d (gp (x) , gp (y)) + d (gp (y) , g (y))
<
Îµ
3 + Îµ
3 + Îµ
3 = Îµ.
Since Îµ was arbitrary, this shows that g is continuous.
It only remains to verify that Ï (g, gk) â†’0. But this follows from 6.6. This
proves the lemma.
With these lemmas, it is time to prove Theorem 6.24.
Proof of Theorem 6.24: Let D = {xk} be the countable dense set of K
gauranteed by Lemma 6.25 and let
{(1, 1) , (1, 2) , (1, 3) , (1, 4) , (1, 5) , Â· Â· Â·}
be a subsequence of N such that
lim
kâ†’âˆžf(1,k) (x1) exists.
This is where the local compactness of X is being used. Now let
{(2, 1) , (2, 2) , (2, 3) , (2, 4) , (2, 5) , Â· Â· Â·}
be a subsequence of
{(1, 1) , (1, 2) , (1, 3) , (1, 4) , (1, 5) , Â· Â· Â·}

144
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
which has the property that
lim
kâ†’âˆžf(2,k) (x2) exists.
Thus it is also the case that
f(2,k) (x1) converges to
lim
kâ†’âˆžf(1,k) (x1) .
because every subsequence of a convergent sequence converges to the same thing as
the convergent sequence. Continue this way and consider the array
f(1,1), f(1,2), f(1,3), f(1,4), Â· Â· Â· converges at x1
f(2,1), f(2,2), f(2,3), f(2,4) Â· Â· Â· converges at x1 and x2
f(3,1), f(3,2), f(3,3), f(3,4) Â· Â· Â· converges at x1, x2, and x3
...
Now let gk â‰¡f(k,k). Thus gk is ultimately a subsequence of
Â©
f(m,k)
Âª
whenever
k > m and therefore, {gk} converges at each point of D. By Lemma 6.26 it follows
there exists g âˆˆC (K) such that
lim
kâ†’âˆžÏ (g, gk) = 0.
This proves the Ascoli Arzela theorem.
Actually there is an if and only if version of it but the most useful case is what
is presented here. The process used to get the subsequence in the proof is called
the Cantor diagonalization procedure.
6.5
The Tietze Extension Theorem
It turns out that if H is a closed subset of a metric space, (X, d) and if f : H â†’[a, b]
is continuous, then there exists g deï¬ned on all of X such that g = f on H and g
is continuous. This is called the Tietze extension theorem. First it is well to recall
continuity in the context of metric space.
Deï¬nition 6.27 Let (X, d) be a metric space and suppose f : X â†’Y is a function
where (Y, Ï) is also a metric space. For example, Y = R. Then f is continuous at
x âˆˆX if for every Îµ > 0 there exists Î´ > 0 such that Ï (f (x) , f (z)) < Îµ whenever
d (x, z) < Î´. As is usual in such deï¬nitions, f is said to be continuous if it is
continuous at every point of X.
The following lemma gives an important example of a continuous real valued
function deï¬ned on a metric space, (X, d) .
Lemma 6.28 Let (X, d) be a metric space and let S âŠ†X be a nonempty subset.
Deï¬ne
dist (x, S) â‰¡inf {d (x, y) : y âˆˆS} .

6.5.
THE TIETZE EXTENSION THEOREM
145
Then x â†’dist (x, S) is a continuous function satisfying the inequality,
|dist (x, S) âˆ’dist (y, S)| â‰¤d (x, y) .
(6.7)
Proof: The continuity of x â†’dist (x, S) is obvious if the inequality 6.7 is estab-
lished. So let x, y âˆˆX. Without loss of generality, assume dist (x, S) â‰¥dist (y, S)
and pick z âˆˆS such that d (y, z) âˆ’Îµ < dist (y, S) . Then
|dist (x, S) âˆ’dist (y, S)|
=
dist (x, S) âˆ’dist (y, S) â‰¤d (x, z) âˆ’(d (y, z) âˆ’Îµ)
â‰¤
d (z, y) + d (x, y) âˆ’d (y, z) + Îµ = d (x, y) + Îµ.
Since Îµ is arbitrary, this proves 6.7.
Lemma 6.29 Let H, K be two nonempty disjoint closed subsets of a metric space,
(X, d) . Then there exists a continuous function, g : X â†’[âˆ’1, 1] such that g (H) =
âˆ’1/3, g (K) = 1/3, g (X) âŠ†[âˆ’1/3, 1/3] .
Proof: Let
f (x) â‰¡
dist (x, H)
dist (x, H) + dist (x, K).
The denominator is never equal to zero because if dist (x, H) = 0, then x âˆˆH
becasue H is closed. (To see this, pick hk âˆˆB (x, 1/k) âˆ©H. Then hk â†’x and
since H is closed, x âˆˆH.) Similarly, if dist (x, K) = 0, then x âˆˆK and so the
denominator is never zero as claimed. Hence, by Lemma 6.28, f is continuous and
from its deï¬nition, f = 0 on H and f = 1 on K. Now let g (x) â‰¡2
3
Â¡
h (x) âˆ’1
2
Â¢
.
Then g has the desired properties.
Deï¬nition 6.30 For f a real or complex valued bounded continuous function de-
ï¬ned on a metric space, M
||f||M â‰¡sup {|f (x)| : x âˆˆM} .
Lemma 6.31 Suppose M is a closed set in X where (X, d) is a metric space and
suppose f : M â†’[âˆ’1, 1] is continuous at every point of M. Then there exists a
function, g which is deï¬ned and continuous on all of X such that ||f âˆ’g||M < 2
3.
Proof:
Let H = f âˆ’1 ([âˆ’1, âˆ’1/3]) , K = f âˆ’1 ([1/3, 1]) . Thus H and K are
disjoint closed subsets of M. Suppose ï¬rst H, K are both nonempty.
Then by
Lemma 6.29 there exists g such that g is a continuous function deï¬ned on all of X
and g (H) = âˆ’1/3, g (K) = 1/3, and g (X) âŠ†[âˆ’1/3, 1/3] . It follows ||f âˆ’g||M <
2/3. If H = âˆ…, then f has all its values in [âˆ’1/3, 1] and so letting g â‰¡1/3, the
desired condition is obtained. If K = âˆ…, let g â‰¡âˆ’1/3. This proves the lemma.
Lemma 6.32 Suppose M is a closed set in X where (X, d) is a metric space and
suppose f : M â†’[âˆ’1, 1] is continuous at every point of M. Then there exists a
function, g which is deï¬ned and continuous on all of X such that g = f on M and
g has its values in [âˆ’1, 1] .

146
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
Proof: Let g1 be such that g1 (X) âŠ†[âˆ’1/3, 1/3] and ||f âˆ’g1||M â‰¤2
3. Suppose
g1, Â· Â· Â·, gm have been chosen such that gj (X) âŠ†[âˆ’1/3, 1/3] and
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯f âˆ’
m
X
i=1
Âµ2
3
Â¶iâˆ’1
gi
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
M
<
Âµ2
3
Â¶m
.
(6.8)
Then
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Âµ3
2
Â¶m Ãƒ
f âˆ’
m
X
i=1
Âµ2
3
Â¶iâˆ’1
gi
!Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
M
â‰¤1
and so
Â¡ 3
2
Â¢m Â³
f âˆ’Pm
i=1
Â¡ 2
3
Â¢iâˆ’1 gi
Â´
can play the role of f in the ï¬rst step of the
proof. Therefore, there exists gm+1 deï¬ned and continuous on all of X such that
its values are in [âˆ’1/3, 1/3] and
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Âµ3
2
Â¶m Ãƒ
f âˆ’
m
X
i=1
Âµ2
3
Â¶iâˆ’1
gi
!
âˆ’gm+1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
M
â‰¤2
3.
Hence
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Ãƒ
f âˆ’
m
X
i=1
Âµ2
3
Â¶iâˆ’1
gi
!
âˆ’
Âµ2
3
Â¶m
gm+1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
M
â‰¤
Âµ2
3
Â¶m+1
.
It follows there exists a sequence, {gi} such that each has its values in [âˆ’1/3, 1/3]
and for every m 6.8 holds. Then let
g (x) â‰¡
âˆž
X
i=1
Âµ2
3
Â¶iâˆ’1
gi (x) .
It follows
|g (x)| â‰¤
Â¯Â¯Â¯Â¯Â¯
âˆž
X
i=1
Âµ2
3
Â¶iâˆ’1
gi (x)
Â¯Â¯Â¯Â¯Â¯ â‰¤
m
X
i=1
Âµ2
3
Â¶iâˆ’1 1
3 â‰¤1
and since convergence is uniform, g must be continuous. The estimate 6.8 implies
f = g on M.
The following is the Tietze extension theorem.
Theorem 6.33 Let M be a closed nonempty subset of a metric space (X, d) and
let f : M â†’[a, b] is continuous at every point of M. Then there exists a function,
g continuous on all of X which coincides with f on M such that g (X) âŠ†[a, b] .
Proof: Let f1 (x) = 1 +
2
bâˆ’a (f (x) âˆ’b) . Then f1 satisï¬es the conditions of
Lemma 6.32 and so there exists g1 : X â†’[âˆ’1, 1] such that g is continuous on X
and equals f1 on M. Let g (x) = (g1 (x) âˆ’1)
Â¡ bâˆ’a
2
Â¢
+ b. This works.

6.6.
GENERAL TOPOLOGICAL SPACES
147
6.6
General Topological Spaces
It turns out that metric spaces are not suï¬ƒciently general for some applications.
This section is a brief introduction to general topology. In making this generaliza-
tion, the properties of balls which are the conclusion of Theorem 6.4 on Page 134
are stated as axioms for a subset of the power set of a given set which will be known
as a basis for the topology. More can be found in [35] and the references listed
there.
Deï¬nition 6.34 Let X be a nonempty set and suppose B âŠ†P (X). Then B is a
basis for a topology if it satisï¬es the following axioms.
1.) Whenever p âˆˆA âˆ©B for A, B âˆˆB, it follows there exists C âˆˆB such that
p âˆˆC âŠ†A âˆ©B.
2.) âˆªB = X.
Then a subset, U, of X is an open set if for every point, x âˆˆU, there exists
B âˆˆB such that x âˆˆB âŠ†U. Thus the open sets are exactly those which can be
obtained as a union of sets of B. Denote these subsets of X by the symbol Ï„ and
refer to Ï„ as the topology or the set of open sets.
Note that this is simply the analog of saying a set is open exactly when every
point is an interior point.
Proposition 6.35 Let X be a set and let B be a basis for a topology as deï¬ned
above and let Ï„ be the set of open sets determined by B. Then
âˆ…âˆˆÏ„, X âˆˆÏ„,
(6.9)
If C âŠ†Ï„, then âˆªC âˆˆÏ„
(6.10)
If A, B âˆˆÏ„, then A âˆ©B âˆˆÏ„.
(6.11)
Proof: If p âˆˆâˆ…then there exists B âˆˆB such that p âˆˆB âŠ†âˆ…because there are
no points in âˆ…. Therefore, âˆ…âˆˆÏ„. Now if p âˆˆX, then by part 2.) of Deï¬nition 6.34
p âˆˆB âŠ†X for some B âˆˆB and so X âˆˆÏ„.
If C âŠ†Ï„, and if p âˆˆâˆªC, then there exists a set, B âˆˆC such that p âˆˆB.
However, B is itself a union of sets from B and so there exists C âˆˆB such that
p âˆˆC âŠ†B âŠ†âˆªC. This veriï¬es 6.10.
Finally, if A, B âˆˆÏ„ and p âˆˆA âˆ©B, then since A and B are themselves unions
of sets of B, it follows there exists A1, B1 âˆˆB such that A1 âŠ†A, B1 âŠ†B, and
p âˆˆA1 âˆ©B1. Therefore, by 1.) of Deï¬nition 6.34 there exists C âˆˆB such that
p âˆˆC âŠ†A1 âˆ©B1 âŠ†A âˆ©B, showing that A âˆ©B âˆˆÏ„ as claimed. Of course if
A âˆ©B = âˆ…, then A âˆ©B âˆˆÏ„. This proves the proposition.
Deï¬nition 6.36 A set X together with such a collection of its subsets satisfying
6.9-6.11 is called a topological space. Ï„ is called the topology or set of open sets of
X.

148
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
Deï¬nition 6.37 A topological space is said to be Hausdorï¬€if whenever p and q
are distinct points of X, there exist disjoint open sets U, V such that p âˆˆU, q âˆˆV .
In other words points can be separated with open sets.
Hausdorï¬€
Â·p
U
Â·q
V
Deï¬nition 6.38 A subset of a topological space is said to be closed if its comple-
ment is open. Let p be a point of X and let E âŠ†X. Then p is said to be a limit
point of E if every open set containing p contains a point of E distinct from p.
Note that if the topological space is Hausdorï¬€, then this deï¬nition is equivalent
to requiring that every open set containing p contains inï¬nitely many points from
E. Why?
Theorem 6.39 A subset, E, of X is closed if and only if it contains all its limit
points.
Proof: Suppose ï¬rst that E is closed and let x be a limit point of E. Is x âˆˆE?
If x /âˆˆE, then EC is an open set containing x which contains no points of E, a
contradiction. Thus x âˆˆE.
Now suppose E contains all its limit points. Is the complement of E open? If
x âˆˆEC, then x is not a limit point of E because E has all its limit points and so
there exists an open set, U containing x such that U contains no point of E other
than x. Since x /âˆˆE, it follows that x âˆˆU âŠ†EC which implies EC is an open set
because this shows EC is the union of open sets.
Theorem 6.40 If (X, Ï„) is a Hausdorï¬€space and if p âˆˆX, then {p} is a closed
set.
Proof: If x Ì¸= p, there exist open sets U and V such that x âˆˆU, p âˆˆV and
U âˆ©V = âˆ…. Therefore, {p}C is an open set so {p} is closed.
Note that the Hausdorï¬€axiom was stronger than needed in order to draw the
conclusion of the last theorem. In fact it would have been enough to assume that
if x Ì¸= y, then there exists an open set containing x which does not intersect y.
Deï¬nition 6.41 A topological space (X, Ï„) is said to be regular if whenever C is
a closed set and p is a point not in C, there exist disjoint open sets U and V such
that p âˆˆU, C âŠ†V . Thus a closed set can be separated from a point not in the
closed set by two disjoint open sets.

6.6.
GENERAL TOPOLOGICAL SPACES
149
Regular
Â·p
U
C
V
Deï¬nition 6.42 The topological space, (X, Ï„) is said to be normal if whenever C
and K are disjoint closed sets, there exist disjoint open sets U and V such that
C âŠ†U, K âŠ†V . Thus any two disjoint closed sets can be separated with open sets.
Normal
C
U
K
V
Deï¬nition 6.43 Let E be a subset of X. E is deï¬ned to be the smallest closed set
containing E.
Lemma 6.44 The above deï¬nition is well deï¬ned.
Proof: Let C denote all the closed sets which contain E. Then C is nonempty
because X âˆˆC.
(âˆ©{A : A âˆˆC})C = âˆª
Â©
AC : A âˆˆC
Âª
,
an open set which shows that âˆ©C is a closed set and is the smallest closed set which
contains E.
Theorem 6.45 E = E âˆª{limit points of E}.
Proof: Let x âˆˆE and suppose that x /âˆˆE. If x is not a limit point either, then
there exists an open set, U,containing x which does not intersect E. But then U C
is a closed set which contains E which does not contain x, contrary to the deï¬nition
that E is the intersection of all closed sets containing E. Therefore, x must be a
limit point of E after all.
Now E âŠ†E so suppose x is a limit point of E. Is x âˆˆE? If H is a closed set
containing E, which does not contain x, then HC is an open set containing x which
contains no points of E other than x negating the assumption that x is a limit point
of E.
The following is the deï¬nition of continuity in terms of general topological spaces.
It is really just a generalization of the Îµ - Î´ deï¬nition of continuity given in calculus.
Deï¬nition 6.46 Let (X, Ï„) and (Y, Î·) be two topological spaces and let f : X â†’Y .
f is continuous at x âˆˆX if whenever V is an open set of Y containing f(x), there
exists an open set U âˆˆÏ„ such that x âˆˆU and f(U) âŠ†V .
f is continuous if
f âˆ’1(V ) âˆˆÏ„ whenever V âˆˆÎ·.

150
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
You should prove the following.
Proposition 6.47 In the situation of Deï¬nition 6.46 f is continuous if and only
if f is continuous at every point of X.
Deï¬nition 6.48 Let (Xi, Ï„ i) be topological spaces. Qn
i=1 Xi is the Cartesian prod-
uct. Deï¬ne a product topology as follows. Let B = Qn
i=1 Ai where Ai âˆˆÏ„ i. Then B
is a basis for the product topology.
Theorem 6.49 The set B of Deï¬nition 6.48 is a basis for a topology.
Proof: Suppose x âˆˆQn
i=1 Aiâˆ©Qn
i=1 Bi where Ai and Bi are open sets. Say
x = (x1, Â· Â· Â·, xn) .
Then xi âˆˆAi âˆ©Bi for each i. Therefore, x âˆˆQn
i=1 Ai âˆ©Bi âˆˆB and Qn
i=1 Ai âˆ©Bi âŠ†
Qn
i=1 Ai.
The deï¬nition of compactness is also considered for a general topological space.
This is given next.
Deï¬nition 6.50 A subset, E, of a topological space (X, Ï„) is said to be compact if
whenever C âŠ†Ï„ and E âŠ†âˆªC, there exists a ï¬nite subset of C, {U1 Â· Â· Â· Un}, such that
E âŠ†âˆªn
i=1Ui. (Every open covering admits a ï¬nite subcovering.) E is precompact if
E is compact. A topological space is called locally compact if it has a basis B, with
the property that B is compact for each B âˆˆB.
A useful construction when dealing with locally compact Hausdorï¬€spaces is the
notion of the one point compactiï¬cation of the space.
Deï¬nition 6.51 Suppose (X, Ï„) is a locally compact Hausdorï¬€space.
Then let
e
X â‰¡X âˆª{âˆž} where âˆžis just the name of some point which is not in X which is
called the point at inï¬nity. A basis for the topology eÏ„ for e
X is
Ï„ âˆª
Â©
KC where K is a compact subset of X
Âª
.
The complement is taken with respect to e
X and so the open sets, KC are basic open
sets which contain âˆž.
The reason this is called a compactiï¬cation is contained in the next lemma.
Lemma 6.52 If (X, Ï„) is a locally compact Hausdorï¬€space, then
Â³
e
X, eÏ„
Â´
is a com-
pact Hausdorï¬€space.
Proof: Since (X, Ï„) is a locally compact Hausdorï¬€space, it follows
Â³
e
X, eÏ„
Â´
is
a Hausdorï¬€topological space. The only case which needs checking is the one of
p âˆˆX and âˆž. Since (X, Ï„) is locally compact, there exists an open set of Ï„, U
having compact closure which contains p. Then p âˆˆU and âˆžâˆˆU
C and these are

6.6.
GENERAL TOPOLOGICAL SPACES
151
disjoint open sets containing the points, p and âˆžrespectively. Now let C be an
open cover of e
X with sets from eÏ„. Then âˆžmust be in some set, Uâˆžfrom C, which
must contain a set of the form KC where K is a compact subset of X. Then there
exist sets from C, U1, Â· Â· Â·, Ur which cover K. Therefore, a ï¬nite subcover of e
X is
U1, Â· Â· Â·, Ur, Uâˆž.
In general topological spaces there may be no concept of â€œboundedâ€. Even if
there is, closed and bounded is not necessarily the same as compactness. However,
in any Hausdorï¬€space every compact set must be a closed set.
Theorem 6.53 If (X, Ï„) is a Hausdorï¬€space, then every compact subset must also
be a closed set.
Proof: Suppose p /âˆˆK. For each x âˆˆX, there exist open sets, Ux and Vx such
that
x âˆˆUx, p âˆˆVx,
and
Ux âˆ©Vx = âˆ….
If K is assumed to be compact, there are ï¬nitely many of these sets, Ux1, Â· Â· Â·, Uxm
which cover K. Then let V â‰¡âˆ©m
i=1Vxi. It follows that V is an open set containing
p which has empty intersection with each of the Uxi. Consequently, V contains no
points of K and is therefore not a limit point of K. This proves the theorem.
Deï¬nition 6.54 If every ï¬nite subset of a collection of sets has nonempty inter-
section, the collection has the ï¬nite intersection property.
Theorem 6.55 Let K be a set whose elements are compact subsets of a Hausdorï¬€
topological space, (X, Ï„).
Suppose K has the ï¬nite intersection property.
Then
âˆ…Ì¸= âˆ©K.
Proof: Suppose to the contrary that âˆ…= âˆ©K. Then consider
C â‰¡
Â©
KC : K âˆˆK
Âª
.
It follows C is an open cover of K0 where K0 is any particular element of K. But
then there are ï¬nitely many K âˆˆK, K1, Â· Â· Â·, Kr such that K0 âŠ†âˆªr
i=1KC
i
implying
that âˆ©r
i=0Ki = âˆ…, contradicting the ï¬nite intersection property.
Lemma 6.56 Let (X, Ï„) be a topological space and let B be a basis for Ï„. Then K
is compact if and only if every open cover of basic open sets admits a ï¬nite subcover.
Proof: Suppose ï¬rst that X is compact. Then if C is an open cover consisting
of basic open sets, it follows it admits a ï¬nite subcover because these are open sets
in C.
Next suppose that every basic open cover admits a ï¬nite subcover and let C be
an open cover of X. Then deï¬ne eC to be the collection of basic open sets which are
contained in some set of C. It follows eC is a basic open cover of X and so it admits

152
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
a ï¬nite subcover, {U1, Â· Â· Â·, Up}. Now each Ui is contained in an open set of C. Let
Oi be a set of C which contains Ui. Then {O1, Â· Â· Â·, Op} is an open cover of X. This
proves the lemma.
In fact, much more can be said than Lemma 6.56. However, this is all which I
will present here.
6.7
Connected Sets
Stated informally, connected sets are those which are in one piece. More precisely,
Deï¬nition 6.57 A set, S in a general topological space is separated if there exist
sets, A, B such that
S = A âˆªB, A, B Ì¸= âˆ…, and A âˆ©B = B âˆ©A = âˆ….
In this case, the sets A and B are said to separate S. A set is connected if it is not
separated.
One of the most important theorems about connected sets is the following.
Theorem 6.58 Suppose U and V are connected sets having nonempty intersection.
Then U âˆªV is also connected.
Proof: Suppose U âˆªV = A âˆªB where A âˆ©B = B âˆ©A = âˆ…. Consider the sets,
A âˆ©U and B âˆªU. Since
(A âˆ©U) âˆ©(B âˆ©U) = (A âˆ©U) âˆ©
Â¡
B âˆ©U
Â¢
= âˆ…,
It follows one of these sets must be empty since otherwise, U would be separated.
It follows that U is contained in either A or B. Similarly, V must be contained in
either A or B. Since U and V have nonempty intersection, it follows that both V
and U are contained in one of the sets, A, B. Therefore, the other must be empty
and this shows U âˆªV cannot be separated and is therefore, connected.
The intersection of connected sets is not necessarily connected as is shown by
the following picture.
U
V

6.7.
CONNECTED SETS
153
Theorem 6.59 Let f : X â†’Y be continuous where X and Y are topological spaces
and X is connected. Then f (X) is also connected.
Proof: To do this you show f (X) is not separated. Suppose to the contrary
that f (X) = AâˆªB where A and B separate f (X) . Then consider the sets, f âˆ’1 (A)
and f âˆ’1 (B) . If z âˆˆf âˆ’1 (B) , then f (z) âˆˆB and so f (z) is not a limit point of
A. Therefore, there exists an open set, U containing f (z) such that U âˆ©A = âˆ….
But then, the continuity of f implies that f âˆ’1 (U) is an open set containing z such
that f âˆ’1 (U)âˆ©f âˆ’1 (A) = âˆ…. Therefore, f âˆ’1 (B) contains no limit points of f âˆ’1 (A) .
Similar reasoning implies f âˆ’1 (A) contains no limit points of f âˆ’1 (B). It follows
that X is separated by f âˆ’1 (A) and f âˆ’1 (B) , contradicting the assumption that X
was connected.
An arbitrary set can be written as a union of maximal connected sets called
connected components. This is the concept of the next deï¬nition.
Deï¬nition 6.60 Let S be a set and let p âˆˆS. Denote by Cp the union of all
connected subsets of S which contain p. This is called the connected component
determined by p.
Theorem 6.61 Let Cp be a connected component of a set S in a general topological
space. Then Cp is a connected set and if Cp âˆ©Cq Ì¸= âˆ…, then Cp = Cq.
Proof: Let C denote the connected subsets of S which contain p. If Cp = A âˆªB
where
A âˆ©B = B âˆ©A = âˆ…,
then p is in one of A or B. Suppose without loss of generality p âˆˆA. Then every
set of C must also be contained in A also since otherwise, as in Theorem 6.58, the
set would be separated. But this implies B is empty. Therefore, Cp is connected.
From this, and Theorem 6.58, the second assertion of the theorem is proved.
This shows the connected components of a set are equivalence classes and par-
tition the set.
A set, I is an interval in R if and only if whenever x, y âˆˆI then (x, y) âŠ†I. The
following theorem is about the connected sets in R.
Theorem 6.62 A set, C in R is connected if and only if C is an interval.
Proof: Let C be connected. If C consists of a single point, p, there is nothing
to prove. The interval is just [p, p] . Suppose p < q and p, q âˆˆC. You need to show
(p, q) âŠ†C. If
x âˆˆ(p, q) \ C
let C âˆ©(âˆ’âˆž, x) â‰¡A, and C âˆ©(x, âˆž) â‰¡B. Then C = A âˆªB and the sets, A and B
separate C contrary to the assumption that C is connected.
Conversely, let I be an interval. Suppose I is separated by A and B. Pick x âˆˆA
and y âˆˆB. Suppose without loss of generality that x < y. Now deï¬ne the set,
S â‰¡{t âˆˆ[x, y] : [x, t] âŠ†A}

154
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES
and let l be the least upper bound of S. Then l âˆˆA so l /âˆˆB which implies l âˆˆA.
But if l /âˆˆB, then for some Î´ > 0,
(l, l + Î´) âˆ©B = âˆ…
contradicting the deï¬nition of l as an upper bound for S. Therefore, l âˆˆB which
implies l /âˆˆA after all, a contradiction. It follows I must be connected.
The following theorem is a very useful description of the open sets in R.
Theorem 6.63 Let U be an open set in R. Then there exist countably many dis-
joint open sets, {(ai, bi)}âˆž
i=1 such that U = âˆªâˆž
i=1 (ai, bi) .
Proof: Let p âˆˆU and let z âˆˆCp, the connected component determined by p.
Since U is open, there exists, Î´ > 0 such that (z âˆ’Î´, z + Î´) âŠ†U. It follows from
Theorem 6.58 that
(z âˆ’Î´, z + Î´) âŠ†Cp.
This shows Cp is open. By Theorem 6.62, this shows Cp is an open interval, (a, b)
where a, b âˆˆ[âˆ’âˆž, âˆž] . There are therefore at most countably many of these con-
nected components because each must contain a rational number and the rational
numbers are countable. Denote by {(ai, bi)}âˆž
i=1 the set of these connected compo-
nents. This proves the theorem.
Deï¬nition 6.64 A topological space, E is arcwise connected if for any two points,
p, q âˆˆE, there exists a closed interval, [a, b] and a continuous function, Î³ : [a, b] â†’E
such that Î³ (a) = p and Î³ (b) = q. E is locally connected if it has a basis of connected
open sets. E is locally arcwise connected if it has a basis of arcwise connected open
sets.
An example of an arcwise connected topological space would be the any subset
of Rn which is the continuous image of an interval. Locally connected is not the
same as connected. A well known example is the following.
Â½Âµ
x, sin 1
x
Â¶
: x âˆˆ(0, 1]
Â¾
âˆª{(0, y) : y âˆˆ[âˆ’1, 1]}
(6.12)
You can verify that this set of points considered as a metric space with the metric
from R2 is not locally connected or arcwise connected but is connected.
Proposition 6.65 If a topological space is arcwise connected, then it is connected.
Proof:
Let X be an arcwise connected space and suppose it is separated.
Then X = A âˆªB where A, B are two separated sets. Pick p âˆˆA and q âˆˆB.
Since X is given to be arcwise connected, there must exist a continuous function
Î³ : [a, b] â†’X such that Î³ (a) = p and Î³ (b) = q. But then we would have Î³ ([a, b]) =
(Î³ ([a, b]) âˆ©A) âˆª(Î³ ([a, b]) âˆ©B) and the two sets, Î³ ([a, b]) âˆ©A and Î³ ([a, b]) âˆ©B are
separated thus showing that Î³ ([a, b]) is separated and contradicting Theorem 6.62
and Theorem 6.59. It follows that X must be connected as claimed.

6.7.
CONNECTED SETS
155
Theorem 6.66 Let U be an open subset of a locally arcwise connected topological
space, X. Then U is arcwise connected if and only if U if connected. Also the
connected components of an open set in such a space are open sets, hence arcwise
connected.
Proof: By Proposition 6.65 it is only necessary to verify that if U is connected
and open in the context of this theorem, then U is arcwise connected. Pick p âˆˆU.
Say x âˆˆU satisï¬es P if there exists a continuous function, Î³ : [a, b] â†’U such that
Î³ (a) = p and Î³ (b) = x.
A â‰¡{x âˆˆU such that x satisï¬es P.}
If x âˆˆA, there exists, according to the assumption that X is locally arcwise con-
nected, an open set, V, containing x and contained in U which is arcwise connected.
Thus letting y âˆˆV, there exist intervals, [a, b] and [c, d] and continuous functions
having values in U, Î³, Î· such that Î³ (a) = p, Î³ (b) = x, Î· (c) = x, and Î· (d) = y.
Then let Î³1 : [a, b + d âˆ’c] â†’U be deï¬ned as
Î³1 (t) â‰¡
Â½
Î³ (t) if t âˆˆ[a, b]
Î· (t) if t âˆˆ[b, b + d âˆ’c]
Then it is clear that Î³1 is a continuous function mapping p to y and showing that
V âŠ†A. Therefore, A is open. A Ì¸= âˆ…because there is an open set, V containing p
which is contained in U and is arcwise connected.
Now consider B â‰¡U \ A. This is also open. If B is not open, there exists a
point z âˆˆB such that every open set containing z is not contained in B. Therefore,
letting V be one of the basic open sets chosen such that z âˆˆV âŠ†U, there exist
points of A contained in V. But then, a repeat of the above argument shows z âˆˆA
also. Hence B is open and so if B Ì¸= âˆ…, then U = B âˆªA and so U is separated by
the two sets, B and A contradicting the assumption that U is connected.
It remains to verify the connected components are open. Let z âˆˆCp where Cp
is the connected component determined by p. Then picking V an arcwise connected
open set which contains z and is contained in U, Cp âˆªV is connected and contained
in U and so it must also be contained in Cp. This proves the theorem.
As an application, consider the following corollary.
Corollary 6.67 Let f : â„¦â†’Z
be continuous where â„¦is a connected open set.
Then f must be a constant.
Proof: Suppose not. Then it achieves two diï¬€erent values, k and l Ì¸= k. Then
â„¦= f âˆ’1 (l) âˆªf âˆ’1 ({m âˆˆZ : m Ì¸= l}) and these are disjoint nonempty open sets
which separate â„¦. To see they are open, note
f âˆ’1 ({m âˆˆZ : m Ì¸= l}) = f âˆ’1
Âµ
âˆªmÌ¸=l
Âµ
m âˆ’1
6, n + 1
6
Â¶Â¶
which is the inverse image of an open set.

156
METRIC SPACES AND GENERAL TOPOLOGICAL SPACES

Weierstrass Approximation
Theorem
7.1
The Bernstein Polynomials
This short chapter is on the important Weierstrass approximation theorem. It is
about approximating an arbitrary continuous function uniformly by a polynomial.
It will be assumed only that f has values in C and that all scalars are in C. First
here is some notation.
Deï¬nition 7.1 Î± = (Î±1, Â·Â·Â·, Î±n) for Î±1Â·Â·Â·Î±n positive integers is called a multi-index.
For Î± a multi-index, |Î±| â‰¡Î±1 + Â· Â· Â· + Î±n and if x âˆˆRn,
x = (x1, Â· Â· Â·, xn) ,
and f a function, deï¬ne
xÎ± â‰¡xÎ±1
1 xÎ±2
2 Â· Â· Â· xÎ±n
n .
A polynomial in n variables of degree m is a function of the form
p (x) =
X
|Î±|â‰¤m
aÎ±xÎ±.
Here Î± is a multi-index as just described.
The following estimate will be the basis for the Weierstrass approximation the-
orem. It is actually a statement about the variance of a binomial random variable.
Lemma 7.2 The following estimate holds for x âˆˆ[0, 1].
m
X
k=0
Âµm
k
Â¶
(k âˆ’mx)2 xk (1 âˆ’x)mâˆ’k â‰¤1
4m
157

158
WEIERSTRASS APPROXIMATION THEOREM
Proof: By the Binomial theorem,
m
X
k=0
Âµm
k
Â¶ Â¡
etx
Â¢k (1 âˆ’x)mâˆ’k =
Â¡
1 âˆ’x + etx
Â¢m .
(7.1)
Diï¬€erentiating both sides with respect to t and then evaluating at t = 0 yields
m
X
k=0
Âµm
k
Â¶
kxk (1 âˆ’x)mâˆ’k = mx.
Now doing two derivatives of 7.1 with respect to t yields
Pm
k=0
Â¡m
k
Â¢
k2 (etx)k (1 âˆ’x)mâˆ’k = m (m âˆ’1) (1 âˆ’x + etx)mâˆ’2 e2tx2
+m (1 âˆ’x + etx)mâˆ’1 xet.
Evaluating this at t = 0,
m
X
k=0
Âµm
k
Â¶
k2 (x)k (1 âˆ’x)mâˆ’k = m (m âˆ’1) x2 + mx.
Therefore,
m
X
k=0
Âµm
k
Â¶
(k âˆ’mx)2 xk (1 âˆ’x)mâˆ’k
=
m (m âˆ’1) x2 + mx âˆ’2m2x2 + m2x2
=
m
Â¡
x âˆ’x2Â¢
â‰¤1
4m.
This proves the lemma.
Now for x = (x1, Â· Â· Â·, xn) âˆˆ[0, 1]n consider the polynomial,
pm (x) â‰¡
m
X
k1=1
Â· Â· Â·
m
X
kn=1
Âµm
k1
Â¶Âµm
k2
Â¶
Â· Â· Â·
Âµm
kn
Â¶
xk1
1 (1 âˆ’x1)mâˆ’k1 xk2
2 (1 âˆ’x2)mâˆ’k2
Â· Â· Â· xkn
n (1 âˆ’xn)mâˆ’kn f
Âµk1
m , Â· Â· Â·, kn
m
Â¶
.
(7.2)
Also deï¬ne if I is a set in Rn
||h||I â‰¡sup {|h (x)| : x âˆˆI} .
Thus pm converges uniformly to f on a set, I if
lim
mâ†’âˆž||pm âˆ’f||I = 0.
Also to simplify the notation, let k = (k1, Â· Â· Â·, kn) where each ki âˆˆ[0, m],
k
m â‰¡
Â¡ k1
m , Â· Â· Â·, kn
m
Â¢
, and let
Âµm
k
Â¶
â‰¡
Âµm
k1
Â¶Âµm
k2
Â¶
Â· Â· Â·
Âµm
kn
Â¶
.

7.1.
THE BERNSTEIN POLYNOMIALS
159
Also deï¬ne
||k||âˆžâ‰¡max {ki, i = 1, 2, Â· Â· Â·, n}
xk (1 âˆ’x)mâˆ’k â‰¡xk1
1 (1 âˆ’x1)mâˆ’k1 xk2
2 (1 âˆ’x2)mâˆ’k2 Â· Â· Â· xkn
n (1 âˆ’xn)mâˆ’kn .
Thus in terms of this notation,
pm (x) =
X
||k||âˆžâ‰¤m
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k f
Âµ k
m
Â¶
Lemma 7.3 For x âˆˆ[0, 1]n , f a continuous function deï¬ned on [0, 1]n , and pm
given in 7.2, pm converges uniformly to f on [0, 1]n as m â†’âˆž.
Proof: The function, f is uniformly continuous because it is continuous on a
compact set. Therefore, there exists Î´ > 0 such that if |x âˆ’y| < Î´, then
|f (x) âˆ’f (y)| < Îµ.
Denote by G the set of k such that (ki âˆ’mxi)2 < Î·2m2 for each i where Î· = Î´/âˆšn.
Note this condition is equivalent to saying that for each i,
Â¯Â¯ ki
m âˆ’xi
Â¯Â¯ < Î·. By the
binomial theorem,
X
||k||âˆžâ‰¤m
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k = 1
and so for x âˆˆ[0, 1]n ,
|pm (x) âˆ’f (x)| â‰¤
X
||k||âˆžâ‰¤m
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k
Â¯Â¯Â¯Â¯f
Âµ k
m
Â¶
âˆ’f (x)
Â¯Â¯Â¯Â¯
â‰¤
X
kâˆˆG
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k
Â¯Â¯Â¯Â¯f
Âµ k
m
Â¶
âˆ’f (x)
Â¯Â¯Â¯Â¯
+
X
kâˆˆGC
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k
Â¯Â¯Â¯Â¯f
Âµ k
m
Â¶
âˆ’f (x)
Â¯Â¯Â¯Â¯
(7.3)
Now for k âˆˆG it follows that for each i
Â¯Â¯Â¯Â¯
ki
m âˆ’xi
Â¯Â¯Â¯Â¯ <
Î´
âˆšn
(7.4)
and so
Â¯Â¯f
Â¡ k
m
Â¢
âˆ’f (x)
Â¯Â¯ < Îµ because the above implies
Â¯Â¯ k
m âˆ’x
Â¯Â¯ < Î´. Therefore, the
ï¬rst sum on the right in 7.3 is no larger than
X
kâˆˆG
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k Îµ â‰¤
X
||k||âˆžâ‰¤m
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k Îµ = Îµ.

160
WEIERSTRASS APPROXIMATION THEOREM
Letting M â‰¥max {|f (x)| : x âˆˆ[0, 1]n} it follows
|pm (x) âˆ’f (x)|
â‰¤
Îµ + 2M
X
kâˆˆGC
Âµm
k
Â¶
xk (1 âˆ’x)mâˆ’k
â‰¤
Îµ + 2M
Âµ
1
Î·2m2
Â¶n X
kâˆˆGC
Âµm
k
Â¶
n
Y
j=1
(kj âˆ’mxj)2 xk (1 âˆ’x)mâˆ’k
â‰¤
Îµ + 2M
Âµ
1
Î·2m2
Â¶n
X
||k||âˆžâ‰¤m
Âµm
k
Â¶
n
Y
j=1
(kj âˆ’mxj)2 xk (1 âˆ’x)mâˆ’k
because on GC,
(kj âˆ’mxj)2
Î·2m2
< 1, j = 1, Â· Â· Â·, n.
Now by Lemma 7.2,
|pm (x) âˆ’f (x)| â‰¤Îµ + 2M
Âµ
1
Î·2m2
Â¶n Â³m
4
Â´n
.
Therefore, since the right side does not depend on x, it follows
lim sup
mâ†’âˆž||pm âˆ’f||[0,1]n â‰¤Îµ
and since Îµ is arbitrary, this shows limmâ†’âˆž||pm âˆ’f||[0,1]n = 0. This proves the
lemma.
The following is not surprising.
Lemma 7.4 Let f be a continuous function deï¬ned on [âˆ’M, M]n . Then there ex-
ists a sequence of polynomials, {pm} converging uniformly to f on [âˆ’M, M]n.
Proof: Let h (t) = âˆ’M + 2Mt so h : [0, 1] â†’[âˆ’M, M] and let h (t) â‰¡
(h (t1) , Â· Â· Â·, h (tn)) . Therefore, f â—¦h is a continuous function deï¬ned on [0, 1]n .
From Lemma 7.3 there exists a polynomial, p (t) such that ||pm âˆ’f â—¦h||[0,1]n < 1
m.
Now for x âˆˆ[âˆ’M, M]n , hâˆ’1 (x) =
Â¡
hâˆ’1 (x1) , Â· Â· Â·, hâˆ’1 (xn)
Â¢
and so
Â¯Â¯Â¯Â¯pm â—¦hâˆ’1 âˆ’f
Â¯Â¯Â¯Â¯
[âˆ’M,M]n = ||pm âˆ’f â—¦h||[0,1]n < 1
m.
But hâˆ’1 (x) =
x
2M + 1
2 and so pm is still a polynomial. This proves the lemma.
The classical version of the Weierstrass approximation theorem involved showing
that a continuous function of one variable deï¬ned on a closed and bounded interval
is the uniform limit of a sequence of polynomials. This is certainly included as a
special case of the above. Now recall the Tietze extension theorem found on Page
146. In the general version about to be presented, the set on which f is deï¬ned is
just a compact subset of Rn, not the Cartesian product of intervals. For convenience
here is the Tietze extension theorem.

7.2.
STONE WEIERSTRASS THEOREM
161
Theorem 7.5 Let M be a closed nonempty subset of a metric space (X, d) and let
f : M â†’[a, b] is continuous at every point of M. Then there exists a function, g
continuous on all of X which coincides with f on M such that g (X) âŠ†[a, b] .
The Weierstrass approximation theorem follows.
Theorem 7.6 Let K be a compact set in Rn and let f be a continuous function de-
ï¬ned on K. Then there exists a sequence of polynomials {pm} converging uniformly
to f on K.
Proof: Choose M large enough that K âŠ†[âˆ’M, M]n and let ef denote a contin-
uous function deï¬ned on all of [âˆ’M, M]n such that ef = f on K. Such an extension
exists by the Tietze extension theorem, Theorem 7.5 applied to the real and imagi-
nary parts of f. By Lemma 7.4 there exists a sequence of polynomials, {pm} deï¬ned
on [âˆ’M, M]n such that
Â¯Â¯Â¯
Â¯Â¯Â¯ ef âˆ’pm
Â¯Â¯Â¯
Â¯Â¯Â¯
[âˆ’M,M]n â†’0. Therefore,
Â¯Â¯Â¯
Â¯Â¯Â¯ ef âˆ’pm
Â¯Â¯Â¯
Â¯Â¯Â¯
K â†’0 also.
This proves the theorem.
7.2
Stone Weierstrass Theorem
7.2.1
The Case Of Compact Sets
There is a profound generalization of the Weierstrass approximation theorem due
to Stone.
Deï¬nition 7.7 A is an algebra of functions if A is a vector space and if whenever
f, g âˆˆA then fg âˆˆA.
To begin with assume that the ï¬eld of scalars is R. This will be generalized
later. Theorem 7.6 implies the following very special case.
Corollary 7.8 The polynomials are dense in C ([a, b]).
The next result is the key to the profound generalization of the Weierstrass
theorem due to Stone in which an interval will be replaced by a compact or locally
compact set and polynomials will be replaced with elements of an algebra satisfying
certain axioms.
Corollary 7.9 On the interval [âˆ’M, M], there exist polynomials pn such that
pn (0) = 0
and
lim
nâ†’âˆž||pn âˆ’|Â·|||âˆž= 0.
Proof: By Corollary 7.8 there exists a sequence of polynomials, {Ëœpn} such that
Ëœpn â†’|Â·| uniformly. Then let pn (t) â‰¡Ëœpn (t) âˆ’Ëœpn (0) . This proves the corollary.

162
WEIERSTRASS APPROXIMATION THEOREM
Deï¬nition 7.10 An algebra of functions, A deï¬ned on A, annihilates no point of
A if for all x âˆˆA, there exists g âˆˆA such that g (x) Ì¸= 0. The algebra separates
points if whenever x1 Ì¸= x2, then there exists g âˆˆA such that g (x1) Ì¸= g (x2).
The following generalization is known as the Stone Weierstrass approximation
theorem.
Theorem 7.11 Let A be a compact topological space and let A âŠ†C (A; R) be an
algebra of functions which separates points and annihilates no point. Then A is
dense in C (A; R).
Proof: First here is a lemma.
Lemma 7.12 Let c1 and c2 be two real numbers and let x1 Ì¸= x2 be two points of
A. Then there exists a function fx1x2 such that
fx1x2 (x1) = c1, fx1x2 (x2) = c2.
Proof of the lemma: Let g âˆˆA satisfy
g (x1) Ì¸= g (x2).
Such a g exists because the algebra separates points. Since the algebra annihilates
no point, there exist functions h and k such that
h (x1) Ì¸= 0, k (x2) Ì¸= 0.
Then let
u â‰¡gh âˆ’g (x2) h, v â‰¡gk âˆ’g (x1) k.
It follows that u (x1) Ì¸= 0 and u (x2) = 0 while v (x2) Ì¸= 0 and v (x1) = 0. Let
fx1x2 â‰¡
c1u
u (x1) +
c2v
v (x2).
This proves the lemma. Now continue the proof of Theorem 7.11.
First note that A satisï¬es the same axioms as A but in addition to these axioms,
A is closed. The closure of A is taken with respect to the usual norm on C (A),
||f||âˆžâ‰¡max {|f (x)| : x âˆˆA} .
Suppose f âˆˆA and suppose M is large enough that
||f||âˆž< M.
Using Corollary 7.9, let pn be a sequence of polynomials such that
||pn âˆ’|Â·|||âˆžâ†’0, pn (0) = 0.

7.2.
STONE WEIERSTRASS THEOREM
163
It follows that pn â—¦f âˆˆA and so |f| âˆˆA whenever f âˆˆA. Also note that
max (f, g) = |f âˆ’g| + (f + g)
2
min (f, g) = (f + g) âˆ’|f âˆ’g|
2
.
Therefore, this shows that if f, g âˆˆA then
max (f, g) , min (f, g) âˆˆA.
By induction, if fi, i = 1, 2, Â· Â· Â·, m are in A then
max (fi, i = 1, 2, Â· Â· Â·, m) , min (fi, i = 1, 2, Â· Â· Â·, m) âˆˆA.
Now let h âˆˆC (A; R) and let x âˆˆA. Use Lemma 7.12 to obtain fxy, a function
of A which agrees with h at x and y. Letting Îµ > 0, there exists an open set U (y)
containing y such that
fxy (z) > h (z) âˆ’Îµ if z âˆˆU(y).
Since A is compact, let U (y1) , Â· Â· Â·, U (yl) cover A. Let
fx â‰¡max (fxy1, fxy2, Â· Â· Â·, fxyl).
Then fx âˆˆA and
fx (z) > h (z) âˆ’Îµ
for all z âˆˆA and fx (x) = h (x). This implies that for each x âˆˆA there exists an
open set V (x) containing x such that for z âˆˆV (x),
fx (z) < h (z) + Îµ.
Let V (x1) , Â· Â· Â·, V (xm) cover A and let
f â‰¡min (fx1, Â· Â· Â·, fxm).
Therefore,
f (z) < h (z) + Îµ
for all z âˆˆA and since fx (z) > h (z) âˆ’Îµ for all z âˆˆA, it follows
f (z) > h (z) âˆ’Îµ
also and so
|f (z) âˆ’h (z)| < Îµ
for all z. Since Îµ is arbitrary, this shows h âˆˆA and proves A = C (A; R). This
proves the theorem.

164
WEIERSTRASS APPROXIMATION THEOREM
7.2.2
The Case Of Locally Compact Sets
Deï¬nition 7.13 Let (X, Ï„) be a locally compact Hausdorï¬€space. C0 (X) denotes
the space of real or complex valued continuous functions deï¬ned on X with the
property that if f âˆˆC0 (X) , then for each Îµ > 0 there exists a compact set K such
that |f (x)| < Îµ for all x /âˆˆK. Deï¬ne
||f||âˆž= sup {|f (x)| : x âˆˆX}.
Lemma 7.14 For (X, Ï„) a locally compact Hausdorï¬€space with the above norm,
C0 (X) is a complete space.
Proof: Let
Â³
e
X, eÏ„
Â´
be the one point compactiï¬cation described in Lemma 6.52.
D â‰¡
n
f âˆˆC
Â³
e
X
Â´
: f (âˆž) = 0
o
.
Then D is a closed subspace of C
Â³
e
X
Â´
. For f âˆˆC0 (X) ,
ef (x) â‰¡
Â½ f (x) if x âˆˆX
0 if x = âˆž
and let Î¸ : C0 (X) â†’D be given by Î¸f = ef. Then Î¸ is one to one and onto and also
satisï¬es ||f||âˆž= ||Î¸f||âˆž. Now D is complete because it is a closed subspace of a
complete space and so C0 (X) with ||Â·||âˆžis also complete. This proves the lemma.
The above refers to functions which have values in C but the same proof works
for functions which have values in any complete normed linear space.
In the case where the functions in C0 (X) all have real values, I will denote the
resulting space by C0 (X; R) with similar meanings in other cases.
With this lemma, the generalization of the Stone Weierstrass theorem to locally
compact sets is as follows.
Theorem 7.15 Let A be an algebra of functions in C0 (X; R) where (X, Ï„) is a
locally compact Hausdorï¬€space which separates the points and annihilates no point.
Then A is dense in C0 (X; R).
Proof: Let
Â³
e
X, eÏ„
Â´
be the one point compactiï¬cation as described in Lemma
6.52. Let e
A denote all ï¬nite linear combinations of the form
( n
X
i=1
ci efi + c0 : f âˆˆA, ci âˆˆR
)
where for f âˆˆC0 (X; R) ,
ef (x) â‰¡
Â½
f (x) if x âˆˆX
0 if x = âˆž
.

7.2.
STONE WEIERSTRASS THEOREM
165
Then e
A is obviously an algebra of functions in C
Â³
e
X; R
Â´
. It separates points because
this is true of A. Similarly, it annihilates no point because of the inclusion of c0 an
arbitrary element of R in the deï¬nition above. Therefore from Theorem 7.11, e
A is
dense in C
Â³
e
X; R
Â´
. Letting f âˆˆC0 (X; R) , it follows ef âˆˆC
Â³
e
X; R
Â´
and so there
exists a sequence {hn} âŠ†e
A such that hn converges uniformly to ef. Now hn is of
the form Pn
i=1 cn
i f
f n
i + cn
0 and since ef (âˆž) = 0, you can take each cn
0 = 0 and so
this has shown the existence of a sequence of functions in A such that it converges
uniformly to f. This proves the theorem.
7.2.3
The Case Of Complex Valued Functions
What about the general case where C0 (X) consists of complex valued functions
and the ï¬eld of scalars is C rather than R? The following is the version of the Stone
Weierstrass theorem which applies to this case. You have to assume that for f âˆˆA
it follows f âˆˆA. Such an algebra is called self adjoint.
Theorem 7.16 Suppose A is an algebra of functions in C0 (X) , where X is a
locally compact Hausdorï¬€space, which separates the points, annihilates no point,
and has the property that if f âˆˆA, then f âˆˆA. Then A is dense in C0 (X).
Proof: Let Re A â‰¡{Re f : f âˆˆA}, Im A â‰¡{Im f : f âˆˆA}. First I will show
that A = Re A + i Im A = Im A + i Re A. Let f âˆˆA. Then
f = 1
2
Â¡
f + f
Â¢
+ 1
2
Â¡
f âˆ’f
Â¢
= Re f + i Im f âˆˆRe A + i Im A
and so A âŠ†Re A + i Im A. Also
f = 1
2i
Â¡
if + if
Â¢
âˆ’i
2
Â³
if + (if)
Â´
= Im (if) + i Re (if) âˆˆIm A + i Re A
This proves one half of the desired equality. Now suppose h âˆˆRe A + i Im A. Then
h = Re g1 +i Im g2 where gi âˆˆA. Then since Re g1 = 1
2 (g1 + g1) , it follows Re g1 âˆˆ
A. Similarly Im g2 âˆˆA. Therefore, h âˆˆA. The case where h âˆˆIm A + i Re A is
similar. This establishes the desired equality.
Now Re A and Im A are both real algebras. I will show this now. First consider
Im A.
It is obvious this is a real vector space.
It only remains to verify that
the product of two functions in Im A is in Im A. Note that from the ï¬rst part,
Re A, Im A are both subsets of A because, for example, if u âˆˆIm A then u + 0 âˆˆ
Im A + i Re A = A.
Therefore, if v, w âˆˆIm A, both iv and w are in A and so
Im (ivw) = vw and ivw âˆˆA. Similarly, Re A is an algebra.
Both Re A and Im A must separate the points. Here is why: If x1 Ì¸= x2, then
there exists f âˆˆA such that f (x1) Ì¸= f (x2) . If Im f (x1) Ì¸= Im f (x2) , this shows
there is a function in Im A, Im f which separates these two points. If Im f fails
to separate the two points, then Re f must separate the points and so you could
consider Im (if) to get a function in Im A which separates these points. This shows
Im A separates the points. Similarly Re A separates the points.

166
WEIERSTRASS APPROXIMATION THEOREM
Neither Re A nor Im A annihilate any point. This is easy to see because if x
is a point there exists f âˆˆA such that f (x) Ì¸= 0. Thus either Re f (x) Ì¸= 0 or
Im f (x) Ì¸= 0. If Im f (x) Ì¸= 0, this shows this point is not annihilated by Im A.
If Im f (x) = 0, consider Im (if) (x) = Re f (x) Ì¸= 0. Similarly, Re A does not
annihilate any point.
It follows from Theorem 7.15 that Re A and Im A are dense in the real valued
functions of C0 (X). Let f âˆˆC0 (X) . Then there exists {hn} âŠ†Re A and {gn} âŠ†
Im A such that hn â†’Re f uniformly and gn â†’Im f uniformly. Therefore, hn +
ign âˆˆA and it converges to f uniformly. This proves the theorem.
7.3
Exercises
1. Let (X, Ï„) , (Y, Î·) be topological spaces and let A âŠ†X be compact. Then if
f : X â†’Y is continuous, show that f (A) is also compact.
2. â†‘In the context of Problem 1, suppose R = Y where the usual topology is
placed on R. Show f achieves its maximum and minimum on A.
3. Let V be an open set in Rn. Show there is an increasing sequence of compact
sets, Km, such that V = âˆªâˆž
m=1Km. Hint: Let
Cm â‰¡
Â½
x âˆˆRn : dist
Â¡
x,V CÂ¢
â‰¥1
m
Â¾
where
dist (x,S) â‰¡inf {|y âˆ’x| such that y âˆˆS}.
Consider Km â‰¡Cm âˆ©B (0,m).
4. Let B (X; Rn) be the space of functions f, mapping X to Rn such that
sup{|f (x)| : x âˆˆX} < âˆž.
Show B (X; Rn) is a complete normed linear space if
||f|| â‰¡sup{|f (x)| : x âˆˆX}.
5. Let Î± âˆˆ[0, 1]. Deï¬ne, for X a compact subset of Rp,
CÎ± (X; Rn) â‰¡{f âˆˆC (X; Rn) : ÏÎ± (f) + ||f|| â‰¡||f||Î± < âˆž}
where
||f|| â‰¡sup{|f (x)| : x âˆˆX}
and
ÏÎ± (f) â‰¡sup{|f (x) âˆ’f (y)|
|x âˆ’y|Î±
: x, y âˆˆX, x Ì¸= y}.
Show that (CÎ± (X; Rn) , ||Â·||Î±) is a complete normed linear space.

7.3.
EXERCISES
167
6. Let {fn}âˆž
n=1 âŠ†CÎ± (X; Rn) where X is a compact subset of Rp and suppose
||fn||Î± â‰¤M
for all n. Show there exists a subsequence, nk, such that fnk converges in
C (X; Rn). The given sequence is called precompact when this happens. (This
also shows the embedding of CÎ± (X; Rn) into C (X; Rn) is a compact embed-
ding.)
7. Use the general Stone Weierstrass approximation theorem to prove Theorem
7.6.
8. Let (X, d) be a metric space where d is a bounded metric. Let C denote the
collection of closed subsets of X. For A, B âˆˆC, deï¬ne
Ï (A, B) â‰¡inf {Î´ > 0 : AÎ´ âŠ‡B and BÎ´ âŠ‡A}
where for a set S,
SÎ´ â‰¡{x : dist (x, S) â‰¡inf {d (x, s) : s âˆˆS} â‰¤Î´} .
Show x â†’dist (x, S) is continuous and that therefore, SÎ´ is a closed set
containing S. Also show that Ï is a metric on C. This is called the Hausdorï¬€
metric.
9. â†‘Suppose (X, d) is a compact metric space. Show (C, Ï) is a complete met-
ric space.
Hint:
Show ï¬rst that if Wn â†“W where Wn is closed, then
Ï (Wn, W) â†’0. Now let {An} be a Cauchy sequence in C. Then if Îµ > 0
there exists N such that when m, n â‰¥N, then Ï (An, Am) < Îµ. Therefore, for
each n â‰¥N,
(An)Îµ âŠ‡âˆªâˆž
k=nAk.
Let A â‰¡âˆ©âˆž
n=1âˆªâˆž
k=nAk. By the ï¬rst part, there exists N1 > N such that for
n â‰¥N1,
Ï
Â¡
âˆªâˆž
k=nAk, A
Â¢
< Îµ, and (An)Îµ âŠ‡âˆªâˆž
k=nAk.
Therefore, for such n, AÎµ âŠ‡Wn âŠ‡An and (Wn)Îµ âŠ‡(An)Îµ âŠ‡A because
(An)Îµ âŠ‡âˆªâˆž
k=nAk âŠ‡A.
10. â†‘Let X be a compact metric space. Show (C, Ï) is compact. Hint: Let Dn
be a 2âˆ’n net for X. Let Kn denote ï¬nite unions of sets of the form B (p, 2âˆ’n)
where p âˆˆDn. Show Kn is a 2âˆ’(nâˆ’1) net for (C, Ï) .

168
WEIERSTRASS APPROXIMATION THEOREM

Part II
Real And Abstract Analysis
169


Abstract Measure And
Integration
8.1
Ïƒ Algebras
This chapter is on the basics of measure theory and integration. A measure is a real
valued mapping from some subset of the power set of a given set which has values
in [0, âˆž]. Many apparently diï¬€erent things can be considered as measures and also
there is an integral deï¬ned. By discussing this in terms of axioms and in a very
abstract setting, many diï¬€erent topics can be considered in terms of one general
theory. For example, it will turn out that sums are included as an integral of this
sort. So is the usual integral as well as things which are often thought of as being
in between sums and integrals.
Let â„¦be a set and let F be a collection of subsets of â„¦satisfying
âˆ…âˆˆF, â„¦âˆˆF,
(8.1)
E âˆˆF implies EC â‰¡â„¦\ E âˆˆF,
If {En}âˆž
n=1 âŠ†F, then âˆªâˆž
n=1 En âˆˆF.
(8.2)
Deï¬nition 8.1 A collection of subsets of a set, â„¦, satisfying Formulas 8.1-8.2 is
called a Ïƒ algebra.
As an example, let â„¦be any set and let F = P(â„¦), the set of all subsets of â„¦
(power set). This obviously satisï¬es Formulas 8.1-8.2.
Lemma 8.2 Let C be a set whose elements are Ïƒ algebras of subsets of â„¦. Then
âˆ©C is a Ïƒ algebra also.
Be sure to verify this lemma. It follows immediately from the above deï¬nitions
but it is important for you to check the details.
Example 8.3 Let Ï„ denote the collection of all open sets in Rnand let Ïƒ (Ï„) â‰¡
intersection of all Ïƒ algebras that contain Ï„. Ïƒ (Ï„) is called the Ïƒ algebra of Borel
sets . In general, for a collection of sets, Î£, Ïƒ (Î£) is the smallest Ïƒ algebra which
contains Î£.
171

172
ABSTRACT MEASURE AND INTEGRATION
This is a very important Ïƒ algebra and it will be referred to frequently as the
Borel sets. Attempts to describe a typical Borel set are more trouble than they are
worth and it is not easy to do so. Rather, one uses the deï¬nition just given in the
example. Note, however, that all countable intersections of open sets and countable
unions of closed sets are Borel sets. Such sets are called GÎ´ and FÏƒ respectively.
Deï¬nition 8.4 Let F
be a Ïƒ algebra of sets of â„¦and let Âµ : F â†’[0, âˆž]. Âµ is
called a measure if
Âµ(
âˆž
[
i=1
Ei) =
âˆž
X
i=1
Âµ(Ei)
(8.3)
whenever the Ei are disjoint sets of F.
The triple, (â„¦, F, Âµ) is called a measure
space and the elements of F are called the measurable sets. (â„¦, F, Âµ) is a ï¬nite
measure space when Âµ (â„¦) < âˆž.
The following theorem is the basis for most of what is done in the theory of
measure and integration. It is a very simple result which follows directly from the
above deï¬nition.
Theorem 8.5 Let {Em}âˆž
m=1 be a sequence of measurable sets in a measure space
(â„¦, F, Âµ). Then if Â· Â· Â·En âŠ†En+1 âŠ†En+2 âŠ†Â· Â· Â·,
Âµ(âˆªâˆž
i=1Ei) = lim
nâ†’âˆžÂµ(En)
(8.4)
and if Â· Â· Â·En âŠ‡En+1 âŠ‡En+2 âŠ‡Â· Â· Â· and Âµ(E1) < âˆž, then
Âµ(âˆ©âˆž
i=1Ei) = lim
nâ†’âˆžÂµ(En).
(8.5)
Stated more succinctly, Ek â†‘E implies Âµ (Ek) â†‘Âµ (E) and Ek â†“E with Âµ (E1) < âˆž
implies Âµ (Ek) â†“Âµ (E).
Proof: First note that âˆ©âˆž
i=1Ei = (âˆªâˆž
i=1EC
i )C âˆˆF so âˆ©âˆž
i=1Ei is measurable.
Also note that for A and B sets of F, A \ B â‰¡
Â¡
AC âˆªB
Â¢C âˆˆF. To show 8.4, note
that 8.4 is obviously true if Âµ(Ek) = âˆžfor any k. Therefore, assume Âµ(Ek) < âˆž
for all k. Thus
Âµ(Ek+1 \ Ek) + Âµ(Ek) = Âµ(Ek+1)
and so
Âµ(Ek+1 \ Ek) = Âµ(Ek+1) âˆ’Âµ(Ek).
Also,
âˆž
[
k=1
Ek = E1 âˆª
âˆž
[
k=1
(Ek+1 \ Ek)
and the sets in the above union are disjoint. Hence by 8.3,
Âµ(âˆªâˆž
i=1Ei) = Âµ(E1) +
âˆž
X
k=1
Âµ(Ek+1 \ Ek) = Âµ(E1)

8.1.
Ïƒ ALGEBRAS
173
+
âˆž
X
k=1
Âµ(Ek+1) âˆ’Âµ(Ek)
= Âµ(E1) + lim
nâ†’âˆž
n
X
k=1
Âµ(Ek+1) âˆ’Âµ(Ek) = lim
nâ†’âˆžÂµ(En+1).
This shows part 8.4.
To verify 8.5,
Âµ(E1) = Âµ(âˆ©âˆž
i=1Ei) + Âµ(E1 \ âˆ©âˆž
i=1Ei)
since Âµ(E1) < âˆž, it follows Âµ(âˆ©âˆž
i=1Ei) < âˆž. Also, E1 \ âˆ©n
i=1Ei â†‘E1 \ âˆ©âˆž
i=1Ei and
so by 8.4,
Âµ(E1) âˆ’Âµ(âˆ©âˆž
i=1Ei) = Âµ(E1 \ âˆ©âˆž
i=1Ei) = lim
nâ†’âˆžÂµ(E1 \ âˆ©n
i=1Ei)
= Âµ(E1) âˆ’lim
nâ†’âˆžÂµ(âˆ©n
i=1Ei) = Âµ(E1) âˆ’lim
nâ†’âˆžÂµ(En),
Hence, subtracting Âµ (E1) from both sides,
lim
nâ†’âˆžÂµ(En) = Âµ(âˆ©âˆž
i=1Ei).
This proves the theorem.
It is convenient to allow functions to take the value +âˆž. You should think of
+âˆž, usually referred to as âˆžas something out at the right end of the real line and
its only importance is the notion of sequences converging to it. xn â†’âˆžexactly
when for all l âˆˆR, there exists N such that if n â‰¥N, then
xn > l.
This is what it means for a sequence to converge to âˆž. Donâ€™t think of âˆžas a
number. It is just a convenient symbol which allows the consideration of some limit
operations more simply. Similar considerations apply to âˆ’âˆžbut this value is not
of very great interest. In fact the set of most interest is the complex numbers or
some vector space. Therefore, this topic is not considered.
Lemma 8.6 Let f : â„¦â†’(âˆ’âˆž, âˆž] where F is a Ïƒ algebra of subsets of â„¦. Then
the following are equivalent.
f âˆ’1((d, âˆž]) âˆˆF for all ï¬nite d,
f âˆ’1((âˆ’âˆž, d)) âˆˆF for all ï¬nite d,
f âˆ’1([d, âˆž]) âˆˆF for all ï¬nite d,
f âˆ’1((âˆ’âˆž, d]) âˆˆF for all ï¬nite d,
f âˆ’1 ((a, b)) âˆˆF for all a < b, âˆ’âˆž< a < b < âˆž.

174
ABSTRACT MEASURE AND INTEGRATION
Proof: First note that the ï¬rst and the third are equivalent. To see this, observe
f âˆ’1([d, âˆž]) = âˆ©âˆž
n=1f âˆ’1((d âˆ’1/n, âˆž]),
and so if the ï¬rst condition holds, then so does the third.
f âˆ’1((d, âˆž]) = âˆªâˆž
n=1f âˆ’1([d + 1/n, âˆž]),
and so if the third condition holds, so does the ï¬rst.
Similarly, the second and fourth conditions are equivalent. Now
f âˆ’1((âˆ’âˆž, d]) = (f âˆ’1((d, âˆž]))C
so the ï¬rst and fourth conditions are equivalent. Thus the ï¬rst four conditions are
equivalent and if any of them hold, then for âˆ’âˆž< a < b < âˆž,
f âˆ’1((a, b)) = f âˆ’1((âˆ’âˆž, b)) âˆ©f âˆ’1((a, âˆž]) âˆˆF.
Finally, if the last condition holds,
f âˆ’1 ([d, âˆž]) =
Â¡
âˆªâˆž
k=1f âˆ’1 ((âˆ’k + d, d))
Â¢C âˆˆF
and so the third condition holds. Therefore, all ï¬ve conditions are equivalent. This
proves the lemma.
This lemma allows for the following deï¬nition of a measurable function having
values in (âˆ’âˆž, âˆž].
Deï¬nition 8.7 Let (â„¦, F, Âµ) be a measure space and let f : â„¦â†’(âˆ’âˆž, âˆž]. Then
f is said to be measurable if any of the equivalent conditions of Lemma 8.6 hold.
When the Ïƒ algebra, F equals the Borel Ïƒ algebra, B, the function is called Borel
measurable. More generally, if f : â„¦â†’X where X is a topological space, f is said
to be measurable if f âˆ’1 (U) âˆˆF whenever U is open.
Theorem 8.8 Let fn and f be functions mapping â„¦to (âˆ’âˆž, âˆž] where F is a Ïƒ al-
gebra of measurable sets of â„¦. Then if fn is measurable, and f(Ï‰) = limnâ†’âˆžfn(Ï‰),
it follows that f is also measurable. (Pointwise limits of measurable functions are
measurable.)
Proof:
First is is shown f âˆ’1 ((a, b)) âˆˆF.
Let Vm â‰¡
Â¡
a + 1
m, b âˆ’1
m
Â¢
and
V m =
Â£
a + 1
m, b âˆ’1
m
Â¤
. Then for all m, Vm âŠ†(a, b) and
(a, b) = âˆªâˆž
m=1Vm = âˆªâˆž
m=1V m.
Note that Vm Ì¸= âˆ…for all m large enough. Since f is the pointwise limit of fn,
f âˆ’1(Vm) âŠ†{Ï‰ : fk(Ï‰) âˆˆVm for all k large enough} âŠ†f âˆ’1(V m).
You should note that the expression in the middle is of the form
âˆªâˆž
n=1 âˆ©âˆž
k=n f âˆ’1
k (Vm).

8.1.
Ïƒ ALGEBRAS
175
Therefore,
f âˆ’1((a, b)) = âˆªâˆž
m=1f âˆ’1(Vm) âŠ†âˆªâˆž
m=1 âˆªâˆž
n=1 âˆ©âˆž
k=nf âˆ’1
k (Vm)
âŠ†âˆªâˆž
m=1f âˆ’1(V m) = f âˆ’1((a, b)).
It follows f âˆ’1((a, b)) âˆˆF because it equals the expression in the middle which is
measurable. This shows f is measurable.
The following theorem considers the case of functions which have values in a
metric space. Its proof is similar to the proof of the above.
Theorem 8.9 Let {fn} be a sequence of measurable functions mapping â„¦to (X, d)
where (X, d) is a metric space and (â„¦, F) is a measure space. Suppose also that
f (Ï‰) = limnâ†’âˆžfn (Ï‰) for all Ï‰. Then f is also a measurable function.
Proof: It is required to show f âˆ’1 (U) is measurable for all U open. Let
Vm â‰¡
Â½
x âˆˆU : dist
Â¡
x, U CÂ¢
> 1
m
Â¾
.
Thus
Vm âŠ†
Â½
x âˆˆU : dist
Â¡
x, U CÂ¢
â‰¥1
m
Â¾
and Vm âŠ†Vm âŠ†Vm+1 and âˆªmVm = U. Then since Vm is open,
f âˆ’1 (Vm) = âˆªâˆž
n=1 âˆ©âˆž
k=n f âˆ’1
k
(Vm)
and so
f âˆ’1 (U)
=
âˆªâˆž
m=1f âˆ’1 (Vm)
=
âˆªâˆž
m=1 âˆªâˆž
n=1 âˆ©âˆž
k=nf âˆ’1
k
(Vm)
âŠ†
âˆªâˆž
m=1f âˆ’1 Â¡
Vm
Â¢
= f âˆ’1 (U)
which shows f âˆ’1 (U) is measurable.
Now here is a simple observation.
Observation 8.10 Let f : â„¦â†’X where X is some topological space. Suppose
f (Ï‰) =
m
X
k=1
xkXAk (Ï‰)
where each xk âˆˆX and the Ak are disjoint measurable sets. (Such functions are
often referred to as simple functions.) Then f is measurable.
Proof: Letting U be open, f âˆ’1 (U) = âˆª{Ak : xk âˆˆU} , a ï¬nite union of mea-
surable sets.
There is also a very interesting theorem due to Kuratowski [34] which is pre-
sented next.

176
ABSTRACT MEASURE AND INTEGRATION
Theorem 8.11 Let E be a compact metric space and let (â„¦, F) be a measure space.
Suppose Ïˆ : E Ã— â„¦â†’R has the property that x â†’Ïˆ (x, Ï‰) is continuous and
Ï‰ â†’Ïˆ (x, Ï‰) is measurable.
Then there exists a measurable function, f having
values in E such that
Ïˆ (f (Ï‰) , Ï‰) = sup
xâˆˆE
Ïˆ (x, Ï‰) .
Furthermore, Ï‰ â†’Ïˆ (f (Ï‰) , Ï‰) is measurable.
Proof: Let C1 be a 2âˆ’1 net of E. Suppose C1, Â·Â·Â·, Cm have been chosen such that
Ck is a 2âˆ’k net and Ci+1 âŠ‡Ci for all i. Then consider E\âˆª
Â©
B
Â¡
x, 2âˆ’(m+1)Â¢
: x âˆˆCm
Âª
.
If this set is empty, let Cm+1 = Cm. If it is nonempty, let {yi}r
i=1 be a 2âˆ’(m+1) net
for this compact set. Then let Cm+1 = Cm âˆª{yi}r
i=1 . It follows {Cm}âˆž
m=1 satisï¬es
Cm is a 2âˆ’m net and Cm âŠ†Cm+1.
Let
Â©
x1
k
Âªm(1)
k=1 equal C1. Let
A1
1 â‰¡
Â½
Ï‰ : Ïˆ
Â¡
x1
1, Ï‰
Â¢
= max
k
Ïˆ
Â¡
x1
k, Ï‰
Â¢Â¾
For Ï‰ âˆˆA1
1, deï¬ne s1 (Ï‰) â‰¡x1
1. Next let
A1
2 â‰¡
Â½
Ï‰ /âˆˆA1
1 : Ïˆ
Â¡
x1
2, Ï‰
Â¢
= max
k
Ïˆ
Â¡
x1
k, Ï‰
Â¢Â¾
and let s1 (Ï‰) â‰¡x1
2 on A1
2. Continue in this way to obtain a simple function, s1
such that
Ïˆ (s1 (Ï‰) , Ï‰) = max {Ïˆ (x, Ï‰) : x âˆˆC1}
and s1 has values in C1.
Suppose s1 (Ï‰) , s2 (Ï‰) , Â· Â· Â·, sm (Ï‰) are simple functions with the property that if
m > 1,
|sk (Ï‰) âˆ’sk+1 (Ï‰)|
<
2âˆ’k,
Ïˆ (sk (Ï‰) , Ï‰)
=
max {Ïˆ (x, Ï‰) : x âˆˆCk}
sk has values in Ck
for each k + 1 â‰¤m, only the second and third assertions holding if m = 1. Letting
Cm = {xk}N
k=1 , it follows sm (Ï‰) is of the form
sm (Ï‰) =
N
X
k=1
xkXAk (Ï‰) , Ai âˆ©Aj = âˆ….
(8.6)
Denote by {y1i}n1
i=1 those points of Cm+1 which are contained in B (x1, 2âˆ’m) . Let-
ting Ak play the role of â„¦in the ï¬rst step in which s1 was constructed, for each
Ï‰ âˆˆA1 let sm+1 (Ï‰) be a simple function which has one of the values y1i and satisï¬es
Ïˆ (sm+1 (Ï‰) , Ï‰) = max
iâ‰¤n1 Ïˆ (y1i, Ï‰)

8.1.
Ïƒ ALGEBRAS
177
for each Ï‰ âˆˆA1. Next let {y2i}n2
i=1 be those points of Cm+1 diï¬€erent than {y1i}n1
i=1
which are contained in B (x2, 2âˆ’m). Then deï¬ne sm+1 (Ï‰) on A2 to have values
taken from {y2i}n2
i=1 and
Ïˆ (sm+1 (Ï‰) , Ï‰) = max
iâ‰¤n2 Ïˆ (y2i, Ï‰)
for each Ï‰ âˆˆA2. Continuing this way deï¬nes sm+1 on all of â„¦and it satisï¬es
|sm (Ï‰) âˆ’sm+1 (Ï‰)| < 2âˆ’m for all Ï‰ âˆˆâ„¦
(8.7)
It remains to verify
Ïˆ (sm+1 (Ï‰) , Ï‰) = max {Ïˆ (x, Ï‰) : x âˆˆCm+1} .
(8.8)
To see this is so, pick Ï‰ âˆˆâ„¦. Let
max {Ïˆ (x, Ï‰) : x âˆˆCm+1} = Ïˆ (yj, Ï‰)
(8.9)
where yj âˆˆCm+1 and out of all the balls B (xl, 2âˆ’m) , the ï¬rst one which contains
yj is B (xk, 2âˆ’m). Then by the construction, sm+1 (Ï‰) = yj. This and 8.9 veriï¬es
8.8.
From 8.7 it follows sm (Ï‰) converges uniformly on â„¦to a measurable function,
f (Ï‰) . Then from the construction, Ïˆ (f (Ï‰) , Ï‰) â‰¥Ïˆ (sm (Ï‰) , Ï‰) for all m and Ï‰.
Now pick Ï‰ âˆˆâ„¦and let z be such that Ïˆ (z, Ï‰) = maxxâˆˆE Ïˆ (x, Ï‰). Letting yk â†’z
where yk âˆˆCk, it follows from continuity of Ïˆ in the ï¬rst argument that
max
xâˆˆE Ïˆ (x, Ï‰)
=
Ïˆ (z, Ï‰) = lim
kâ†’âˆžÏˆ (yk, Ï‰)
â‰¤
lim
mâ†’âˆžÏˆ (sm (Ï‰) , Ï‰) = Ïˆ (f (Ï‰) , Ï‰) â‰¤max
xâˆˆE Ïˆ (x, Ï‰) .
To show Ï‰ â†’Ïˆ (f (Ï‰) , Ï‰) is measurable, note that since E is compact, there exists
a countable dense subset, D. Then using continuity of Ïˆ in the ï¬rst argument,
Ïˆ (f (Ï‰) , Ï‰)
=
sup
xâˆˆE
Ïˆ (x, Ï‰)
=
sup
xâˆˆD
Ïˆ (x, Ï‰)
which equals a measurable function of Ï‰ because D is countable. This proves the
theorem.
Theorem 8.12 Let B consist of open cubes of the form
Qx â‰¡
n
Y
i=1
(xi âˆ’Î´, xi + Î´)
where Î´ is a positive rational number and x âˆˆQn. Then every open set in Rn can be
written as a countable union of open cubes from B. Furthermore, B is a countable
set.

178
ABSTRACT MEASURE AND INTEGRATION
Proof: Let U be an open set and let y âˆˆU. Since U is open, B (y, r) âŠ†U for
some r > 0 and it can be assumed r/âˆšn âˆˆQ. Let
x âˆˆB
Âµ
y,
r
10âˆšn
Â¶
âˆ©Qn
and consider the cube, Qx âˆˆB deï¬ned by
Qx â‰¡
n
Y
i=1
(xi âˆ’Î´, xi + Î´)
where Î´ = r/4âˆšn. The following picture is roughly illustrative of what is taking
place.
qy
qx
Qx
B(y, r)
Then the diameter of Qx equals
Ãƒ
n
Âµ
r
2âˆšn
Â¶2!1/2
= r
2
and so, if z âˆˆQx, then
|z âˆ’y|
â‰¤
|z âˆ’x| + |x âˆ’y|
<
r
2 + r
2 = r.
Consequently, Qx âŠ†U. Now also,
Ãƒ n
X
i=1
(xi âˆ’yi)2
!1/2
<
r
10âˆšn
and so it follows that for each i,
|xi âˆ’yi| <
r
4âˆšn

8.1.
Ïƒ ALGEBRAS
179
since otherwise the above inequality would not hold. Therefore, y âˆˆQx âŠ†U. Now
let BU denote those sets of B which are contained in U. Then âˆªBU = U.
To see B is countable, note there are countably many choices for x and countably
many choices for Î´. This proves the theorem.
Recall that g : Rn â†’R is continuous means gâˆ’1 (open set) = an open set. In
particular gâˆ’1 ((a, b)) must be an open set.
Theorem 8.13 Let fi : â„¦â†’R for i = 1, Â· Â· Â·, n be measurable functions and let
g : Rn â†’R be continuous where f â‰¡(f1 Â·Â·Â·fn)T . Then gâ—¦f is a measurable function
from â„¦to R.
Proof: First it is shown
(g â—¦f)âˆ’1 ((a, b)) âˆˆF.
Now (g â—¦f)âˆ’1 ((a, b)) = f âˆ’1 Â¡
gâˆ’1 ((a, b))
Â¢
and since g is continuous, it follows that
gâˆ’1 ((a, b)) is an open set which is denoted as U for convenience. Now by Theorem
8.12 above, it follows there are countably many open cubes, {Qk} such that
U = âˆªâˆž
k=1Qk
where each Qk is a cube of the form
Qk =
n
Y
i=1
(xi âˆ’Î´, xi + Î´) .
Now
f âˆ’1
Ãƒ n
Y
i=1
(xi âˆ’Î´, xi + Î´)
!
= âˆ©n
i=1f âˆ’1
i
((xi âˆ’Î´, xi + Î´)) âˆˆF
and so
(g â—¦f)âˆ’1 ((a, b))
=
f âˆ’1 Â¡
gâˆ’1 ((a, b))
Â¢
= f âˆ’1 (U)
=
f âˆ’1 (âˆªâˆž
k=1Qk) = âˆªâˆž
k=1f âˆ’1 (Qk) âˆˆF.
This proves the theorem.
Corollary 8.14 Sums, products, and linear combinations of measurable functions
are measurable.
Proof: To see the product of two measurable functions is measurable, let
g (x, y) = xy, a continuous function deï¬ned on R2. Thus if you have two mea-
surable functions, f1 and f2 deï¬ned on â„¦,
g â—¦(f1, f2) (Ï‰) = f1 (Ï‰) f2 (Ï‰)
and so Ï‰ â†’f1 (Ï‰) f2 (Ï‰) is measurable. Similarly you can show the sum of two
measurable functions is measurable by considering g (x, y) = x + y and you can

180
ABSTRACT MEASURE AND INTEGRATION
show a linear combination of two measurable functions is measurable by considering
g (x, y) = ax + by. More than two functions can also be considered as well.
The message of this corollary is that starting with measurable real valued func-
tions you can combine them in pretty much any way you want and you end up with
a measurable function.
Here is some notation which will be used whenever convenient.
Deï¬nition 8.15 Let f : â„¦â†’[âˆ’âˆž, âˆž]. Deï¬ne
[Î± < f] â‰¡{Ï‰ âˆˆâ„¦: f (Ï‰) > Î±} â‰¡f âˆ’1 ((Î±, âˆž])
with obvious modiï¬cations for the symbols [Î± â‰¤f] , [Î± â‰¥f] , [Î± â‰¥f â‰¥Î²], etc.
Deï¬nition 8.16 For a set E,
XE(Ï‰) =
Â½ 1 if Ï‰ âˆˆE,
0 if Ï‰ /âˆˆE.
This is called the characteristic function of E.
Sometimes this is called the
indicator function which I think is better terminology since the term characteristic
function has another meaning. Note that this â€œindicatesâ€ whether a point, Ï‰ is
contained in E. It is exactly when the function has the value 1.
Theorem 8.17 (Egoroï¬€) Let (â„¦, F, Âµ) be a ï¬nite measure space,
(Âµ(â„¦) < âˆž)
and let fn, f be complex valued functions such that Re fn, Im fn are all measurable
and
lim
nâ†’âˆžfn(Ï‰) = f(Ï‰)
for all Ï‰ /âˆˆE where Âµ(E) = 0. Then for every Îµ > 0, there exists a set,
F âŠ‡E, Âµ(F) < Îµ,
such that fn converges uniformly to f on F C.
Proof: First suppose E = âˆ…so that convergence is pointwise everywhere. It
follows then that Re f and Im f are pointwise limits of measurable functions and
are therefore measurable. Let Ekm = {Ï‰ âˆˆâ„¦: |fn(Ï‰) âˆ’f(Ï‰)| â‰¥1/m for some
n > k}. Note that
|fn (Ï‰) âˆ’f (Ï‰)| =
q
(Re fn (Ï‰) âˆ’Re f (Ï‰))2 + (Im fn (Ï‰) âˆ’Im f (Ï‰))2
and so, By Theorem 8.13,
Â·
|fn âˆ’f| â‰¥1
m
Â¸

8.1.
Ïƒ ALGEBRAS
181
is measurable. Hence Ekm is measurable because
Ekm = âˆªâˆž
n=k+1
Â·
|fn âˆ’f| â‰¥1
m
Â¸
.
For ï¬xed m, âˆ©âˆž
k=1Ekm = âˆ…because fn converges to f . Therefore, if Ï‰ âˆˆâ„¦there
exists k such that if n > k, |fn (Ï‰) âˆ’f (Ï‰)| <
1
m which means Ï‰ /âˆˆEkm. Note also
that
Ekm âŠ‡E(k+1)m.
Since Âµ(E1m) < âˆž, Theorem 8.5 on Page 172 implies
0 = Âµ(âˆ©âˆž
k=1Ekm) = lim
kâ†’âˆžÂµ(Ekm).
Let k(m) be chosen such that Âµ(Ek(m)m) < Îµ2âˆ’m and let
F =
âˆž
[
m=1
Ek(m)m.
Then Âµ(F) < Îµ because
Âµ (F) â‰¤
âˆž
X
m=1
Âµ
Â¡
Ek(m)m
Â¢
<
âˆž
X
m=1
Îµ2âˆ’m = Îµ
Now let Î· > 0 be given and pick m0 such that mâˆ’1
0
< Î·. If Ï‰ âˆˆF C, then
Ï‰ âˆˆ
âˆž
\
m=1
EC
k(m)m.
Hence Ï‰ âˆˆEC
k(m0)m0 so
|fn(Ï‰) âˆ’f(Ï‰)| < 1/m0 < Î·
for all n > k(m0). This holds for all Ï‰ âˆˆF Cand so fn converges uniformly to f on
F C.
Now if E Ì¸= âˆ…, consider {XECfn}âˆž
n=1 . Each XECfn has real and imaginary
parts measurable and the sequence converges pointwise to XEf everywhere. There-
fore, from the ï¬rst part, there exists a set of measure less than Îµ, F such that on
F C, {XECfn} converges uniformly to XECf. Therefore, on (E âˆªF)C , {fn} con-
verges uniformly to f. This proves the theorem.
Finally here is a comment about notation.
Deï¬nition 8.18 Something happens for Âµ a.e. Ï‰ said as Âµ almost everywhere, if
there exists a set E with Âµ(E) = 0 and the thing takes place for all Ï‰ /âˆˆE. Thus
f(Ï‰) = g(Ï‰) a.e. if f(Ï‰) = g(Ï‰) for all Ï‰ /âˆˆE where Âµ(E) = 0. A measure space,
(â„¦, F, Âµ) is Ïƒ ï¬nite if there exist measurable sets, â„¦n such that Âµ (â„¦n) < âˆžand
â„¦= âˆªâˆž
n=1â„¦n.

182
ABSTRACT MEASURE AND INTEGRATION
8.2
Exercises
1. Let â„¦= N ={1, 2, Â· Â· Â·}. Let F = P(N) and let Âµ(S) = number of elements in
S. Thus Âµ({1}) = 1 = Âµ({2}), Âµ({1, 2}) = 2, etc. Show (â„¦, F, Âµ) is a measure
space. It is called counting measure. What functions are measurable in this
case?
2. Let â„¦be any uncountable set and let F = {A âŠ†â„¦: either A or AC is
countable}. Let Âµ(A) = 1 if A is uncountable and Âµ(A) = 0 if A is countable.
Show (â„¦, F, Âµ) is a measure space. This is a well known bad example.
3. Let F be a Ïƒ algebra of subsets of â„¦and suppose F has inï¬nitely many
elements. Show that F is uncountable. Hint: You might try to show there
exists a countable sequence of disjoint sets of F, {Ai}. It might be easiest to
verify this by contradiction if it doesnâ€™t exist rather than a direct construction.
Once this has been done, you can deï¬ne a map, Î¸, from P (N) into F which
is one to one by Î¸ (S) = âˆªiâˆˆSAi. Then argue P (N) is uncountable and so F
is also uncountable.
4. Prove Lemma 8.2.
5. g is Borel measurable if whenever U is open, gâˆ’1(U) is Borel. Let f : â„¦â†’Rn
and let g : Rn â†’R and F is a Ïƒ algebra of sets of â„¦. Suppose f is measurable
and g is Borel measurable.
Show g â—¦f is measurable.
To say g is Borel
measurable means gâˆ’1 (open set) = (Borel set) where a Borel set is one of
those sets in the smallest Ïƒ algebra containing the open sets of Rn. See Lemma
8.2. Hint: You should show, using Theorem 8.12 that f âˆ’1 (open set) âˆˆF.
Now let
S â‰¡
Â©
E âŠ†Rn : f âˆ’1 (E) âˆˆF
Âª
By what you just showed, S contains the open sets. Now verify S is a Ïƒ
algebra. Argue that from the deï¬nition of the Borel sets, it follows S contains
the Borel sets.
6. Let (â„¦, F) be a measure space and suppose f : â„¦â†’C. Then f is said to be
mesurable if
f âˆ’1 (open set) âˆˆF.
Show f is measurable if and only if Re f and Im f are measurable real-valued
functions. Thus it suï¬ƒces to deï¬ne a complex valued function to be mea-
surable if the real and imaginary parts are measurable. Hint: Argue that
f âˆ’1 (((a, b) + i (c, d))) = (Re f)âˆ’1 ((a, b)) âˆ©(Im f)âˆ’1 ((c, d)) . Then use Theo-
rem 8.12 to verify that if Re f and Im f are measurable, it follows f is. Con-
versely, argue that (Re f)âˆ’1 ((a, b)) = f âˆ’1 ((a, b) + iR) with a similar formula
holding for Im f.
7. Let (â„¦, F, Âµ) be a measure space. Deï¬ne Âµ : P(â„¦) â†’[0, âˆž] by
Âµ(A) = inf{Âµ(B) : B âŠ‡A, B âˆˆF}.

8.3.
THE ABSTRACT LEBESGUE INTEGRAL
183
Show Âµ satisï¬es
Âµ(âˆ…)
=
0, if A âŠ†B, Âµ(A) â‰¤Âµ(B),
Âµ(âˆªâˆž
i=1Ai)
â‰¤
âˆž
X
i=1
Âµ(Ai), Âµ (A) = Âµ (A) if A âˆˆF.
If Âµ satisï¬es these conditions, it is called an outer measure. This shows every
measure determines an outer measure on the power set.
8. Let {Ei} be a sequence of measurable sets with the property that
âˆž
X
i=1
Âµ(Ei) < âˆž.
Let S = {Ï‰ âˆˆâ„¦such that Ï‰ âˆˆEi for inï¬nitely many values of i}. Show
Âµ(S) = 0 and S is measurable. This is part of the Borel Cantelli lemma.
Hint: Write S in terms of intersections and unions. Something is in S means
that for every n there exists k > n such that it is in Ek. Remember the tail
of a convergent series is small.
9. â†‘Let fn, f be measurable functions. fn converges in measure if
lim
nâ†’âˆžÂµ(x âˆˆâ„¦: |f(x) âˆ’fn(x)| â‰¥Îµ) = 0
for each ï¬xed Îµ > 0. Prove the theorem of F. Riesz. If fn converges to f
in measure, then there exists a subsequence {fnk} which converges to f a.e.
Hint: Choose n1 such that
Âµ(x : |f(x) âˆ’fn1(x)| â‰¥1) < 1/2.
Choose n2 > n1 such that
Âµ(x : |f(x) âˆ’fn2(x)| â‰¥1/2) < 1/22,
n3 > n2 such that
Âµ(x : |f(x) âˆ’fn3(x)| â‰¥1/3) < 1/23,
etc. Now consider what it means for fnk(x) to fail to converge to f(x). Then
use Problem 8.
8.3
The Abstract Lebesgue Integral
8.3.1
Preliminary Observations
This section is on the Lebesgue integral and the major convergence theorems which
are the reason for studying it. In all that follows Âµ will be a measure deï¬ned on a

184
ABSTRACT MEASURE AND INTEGRATION
Ïƒ algebra F of subsets of â„¦. 0 Â· âˆž= 0 is always deï¬ned to equal zero. This is a
meaningless expression and so it can be deï¬ned arbitrarily but a little thought will
soon demonstrate that this is the right deï¬nition in the context of measure theory.
To see this, consider the zero function deï¬ned on R. What should the integral of
this function equal? Obviously, by an analogy with the Riemann integral, it should
equal zero. Formally, it is zero times the length of the set or inï¬nity. This is why
this convention will be used.
Lemma 8.19 Let f (a, b) âˆˆ[âˆ’âˆž, âˆž] for a âˆˆA and b âˆˆB where A, B are sets.
Then
sup
aâˆˆA
sup
bâˆˆB
f (a, b) = sup
bâˆˆB
sup
aâˆˆA
f (a, b) .
Proof: Note that for all a, b, f (a, b) â‰¤supbâˆˆB supaâˆˆA f (a, b) and therefore, for
all a,
sup
bâˆˆB
f (a, b) â‰¤sup
bâˆˆB
sup
aâˆˆA
f (a, b) .
Therefore,
sup
aâˆˆA
sup
bâˆˆB
f (a, b) â‰¤sup
bâˆˆB
sup
aâˆˆA
f (a, b) .
Repeating the same argument interchanging a and b, gives the conclusion of the
lemma.
Lemma 8.20 If {An} is an increasing sequence in [âˆ’âˆž, âˆž], then sup {An} =
limnâ†’âˆžAn.
The following lemma is useful also and this is a good place to put it. First
{bj}âˆž
j=1 is an enumeration of the aij if
âˆªâˆž
j=1 {bj} = âˆªi,j {aij} .
In other words, the countable set, {aij}âˆž
i,j=1 is listed as b1, b2, Â· Â· Â·.
Lemma 8.21 Let aij â‰¥0. Then Pâˆž
i=1
Pâˆž
j=1 aij = Pâˆž
j=1
Pâˆž
i=1 aij. Also if {bj}âˆž
j=1
is any enumeration of the aij, then Pâˆž
j=1 bj = Pâˆž
i=1
Pâˆž
j=1 aij.
Proof: First note there is no trouble in deï¬ning these sums because the aij are
all nonnegative. If a sum diverges, it only diverges to âˆžand so âˆžis written as the
answer.
âˆž
X
j=1
âˆž
X
i=1
aij â‰¥sup
n
âˆž
X
j=1
n
X
i=1
aij = sup
n
lim
mâ†’âˆž
m
X
j=1
n
X
i=1
aij
= sup
n
lim
mâ†’âˆž
n
X
i=1
m
X
j=1
aij = sup
n
n
X
i=1
âˆž
X
j=1
aij =
âˆž
X
i=1
âˆž
X
j=1
aij.
(8.10)
Interchanging the i and j in the above argument the ï¬rst part of the lemma is
proved.

8.3.
THE ABSTRACT LEBESGUE INTEGRAL
185
Finally, note that for all p,
p
X
j=1
bj â‰¤
âˆž
X
i=1
âˆž
X
j=1
aij
and so Pâˆž
j=1 bj â‰¤Pâˆž
i=1
Pâˆž
j=1 aij. Now let m, n > 1 be given. Then
m
X
i=1
n
X
j=1
aij â‰¤
p
X
j=1
bj
where p is chosen large enough that {b1, Â· Â· Â·, bp} âŠ‡{aij : i â‰¤m and j â‰¤n} . There-
fore, since such a p exists for any choice of m, n,it follows that for any m, n,
m
X
i=1
n
X
j=1
aij â‰¤
âˆž
X
j=1
bj.
Therefore, taking the limit as n â†’âˆž,
m
X
i=1
âˆž
X
j=1
aij â‰¤
âˆž
X
j=1
bj
and ï¬nally, taking the limit as m â†’âˆž,
âˆž
X
i=1
âˆž
X
j=1
aij â‰¤
âˆž
X
j=1
bj
proving the lemma.
8.3.2
Deï¬nition Of The Lebesgue Integral For Nonnegative
Measurable Functions
The following picture illustrates the idea used to deï¬ne the Lebesgue integral to be
like the area under a curve.
h
2h
3h
hÂµ([h < f])
hÂµ([2h < f])
hÂµ([3h < f])
You can see that by following the procedure illustrated in the picture and letting
h get smaller, you would expect to obtain better approximations to the area under

186
ABSTRACT MEASURE AND INTEGRATION
the curve1 although all these approximations would likely be too small. Therefore,
deï¬ne
Z
fdÂµ â‰¡sup
h>0
âˆž
X
i=1
hÂµ ([ih < f])
Lemma 8.22 The following inequality holds.
âˆž
X
i=1
hÂµ ([ih < f]) â‰¤
âˆž
X
i=1
h
2 Âµ
ÂµÂ·
ih
2 < f
Â¸Â¶
.
Also, it suï¬ƒces to consider only h smaller than a given positive number in the above
deï¬nition of the integral.
Proof:
Let N âˆˆN.
2N
X
i=1
h
2 Âµ
ÂµÂ·
ih
2 < f
Â¸Â¶
=
2N
X
i=1
h
2 Âµ ([ih < 2f])
=
N
X
i=1
h
2 Âµ ([(2i âˆ’1) h < 2f]) +
N
X
i=1
h
2 Âµ ([(2i) h < 2f])
=
N
X
i=1
h
2 Âµ
ÂµÂ·(2i âˆ’1)
2
h < f
Â¸Â¶
+
N
X
i=1
h
2 Âµ ([ih < f])
â‰¥
N
X
i=1
h
2 Âµ ([ih < f]) +
N
X
i=1
h
2 Âµ ([ih < f]) =
N
X
i=1
hÂµ ([ih < f]) .
Now letting N â†’âˆžyields the claim of the lemma.
To verify the last claim, suppose M <
R
fdÂµ and let Î´ > 0 be given. Then there
exists h > 0 such that
M <
âˆž
X
i=1
hÂµ ([ih < f]) â‰¤
Z
fdÂµ.
By the ï¬rst part of this lemma,
M <
âˆž
X
i=1
h
2 Âµ
ÂµÂ·
ih
2 < f
Â¸Â¶
â‰¤
Z
fdÂµ
1Note the diï¬€erence between this picture and the one usually drawn in calculus courses where
the little rectangles are upright rather than on their sides. This illustrates a fundamental philo-
sophical diï¬€erence between the Riemann and the Lebesgue integrals. With the Riemann integral
intervals are measured. With the Lebesgue integral, it is inverse images of intervals which are
measured.

8.3.
THE ABSTRACT LEBESGUE INTEGRAL
187
and continuing to apply the ï¬rst part,
M <
âˆž
X
i=1
h
2n Âµ
ÂµÂ·
i h
2n < f
Â¸Â¶
â‰¤
Z
fdÂµ.
Choose n large enough that h/2n < Î´. It follows
M < sup
Î´>h>0
âˆž
X
i=1
hÂµ ([ih < f]) â‰¤
Z
fdÂµ.
Since M is arbitrary, this proves the last claim.
8.3.3
The Lebesgue Integral For Nonnegative Simple Func-
tions
Deï¬nition 8.23 A function, s, is called simple if it is a measurable real valued
function and has only ï¬nitely many values. These values will never be Â±âˆž. Thus
a simple function is one which may be written in the form
s (Ï‰) =
n
X
i=1
ciXEi (Ï‰)
where the sets, Ei are disjoint and measurable. s takes the value ci at Ei.
Note that by taking the union of some of the Ei in the above deï¬nition, you
can assume that the numbers, ci are the distinct values of s. Simple functions are
important because it will turn out to be very easy to take their integrals as shown
in the following lemma.
Lemma 8.24 Let s (Ï‰) = Pp
i=1 aiXEi (Ï‰) be a nonnegative simple function with
the ai the distinct non zero values of s. Then
Z
sdÂµ =
p
X
i=1
aiÂµ (Ei) .
(8.11)
Also, for any nonnegative measurable function, f, if Î» â‰¥0, then
Z
Î»fdÂµ = Î»
Z
fdÂµ.
(8.12)
Proof: Consider 8.11 ï¬rst. Without loss of generality, you can assume 0 < a1 <
a2 < Â· Â· Â· < ap and that Âµ (Ei) < âˆž. Let Îµ > 0 be given and let
Î´1
p
X
i=1
Âµ (Ei) < Îµ.

188
ABSTRACT MEASURE AND INTEGRATION
Pick Î´ < Î´1 such that for h < Î´ it is also true that
h < 1
2 min (a1, a2 âˆ’a1, a3 âˆ’a2, Â· Â· Â·, an âˆ’anâˆ’1) .
Then for 0 < h < Î´
âˆž
X
k=1
hÂµ ([s > kh])
=
âˆž
X
k=1
h
âˆž
X
i=k
Âµ ([ih < s â‰¤(i + 1) h])
=
âˆž
X
i=1
i
X
k=1
hÂµ ([ih < s â‰¤(i + 1) h])
=
âˆž
X
i=1
ihÂµ ([ih < s â‰¤(i + 1) h]) .
(8.13)
Because of the choice of h there exist positive integers, ik such that i1 < i2 < Â·Â·Â·, < ip
and
i1h
<
a1 â‰¤(i1 + 1) h < Â· Â· Â· < i2h < a2 <
<
(i2 + 1) h < Â· Â· Â· < iph < ap â‰¤(ip + 1) h
Then in the sum of 8.13 the only terms which are nonzero are those for which
i âˆˆ{i1, i2 Â· Â·Â·, ip}. From the above, you see that
Âµ ([ikh < s â‰¤(ik + 1) h]) = Âµ (Ek) .
Therefore,
âˆž
X
k=1
hÂµ ([s > kh]) =
p
X
k=1
ikhÂµ (Ek) .
It follows that for all h this small,
0
<
p
X
k=1
akÂµ (Ek) âˆ’
âˆž
X
k=1
hÂµ ([s > kh])
=
p
X
k=1
akÂµ (Ek) âˆ’
p
X
k=1
ikhÂµ (Ek) â‰¤h
p
X
k=1
Âµ (Ek) < Îµ.
Taking the inf for h this small and using Lemma 8.22,
0
â‰¤
p
X
k=1
akÂµ (Ek) âˆ’sup
Î´>h>0
âˆž
X
k=1
hÂµ ([s > kh])
=
p
X
k=1
akÂµ (Ek) âˆ’
Z
sdÂµ â‰¤Îµ.
Since Îµ > 0 is arbitrary, this proves the ï¬rst part.

8.3.
THE ABSTRACT LEBESGUE INTEGRAL
189
To verify 8.12 Note the formula is obvious if Î» = 0 because then [ih < Î»f] = âˆ…
for all i > 0. Assume Î» > 0. Then
Z
Î»fdÂµ
â‰¡
sup
h>0
âˆž
X
i=1
hÂµ ([ih < Î»f])
=
sup
h>0
âˆž
X
i=1
hÂµ ([ih/Î» < f])
=
sup
h>0
Î»
âˆž
X
i=1
(h/Î») Âµ ([i (h/Î») < f])
=
Î»
Z
fdÂµ.
This proves the lemma.
Lemma 8.25 Let the nonnegative simple function, s be deï¬ned as
s (Ï‰) =
n
X
i=1
ciXEi (Ï‰)
where the ci are not necessarily distinct but the Ei are disjoint. It follows that
Z
s =
n
X
i=1
ciÂµ (Ei) .
Proof: Let the values of s be {a1, Â· Â· Â·, am}. Therefore, since the Ei are disjoint,
each ai equal to one of the cj. Let Ai â‰¡âˆª{Ej : cj = ai}. Then from Lemma 8.24
it follows that
Z
s
=
m
X
i=1
aiÂµ (Ai) =
m
X
i=1
ai
X
{j:cj=ai}
Âµ (Ej)
=
m
X
i=1
X
{j:cj=ai}
cjÂµ (Ej) =
n
X
i=1
ciÂµ (Ei) .
This proves the lemma.
Note that
R
s could equal +âˆžif Âµ (Ak) = âˆžand ak > 0 for some k, but
R
s is
well deï¬ned because s â‰¥0. Recall that 0 Â· âˆž= 0.
Lemma 8.26 If a, b â‰¥0 and if s and t are nonnegative simple functions, then
Z
as + bt = a
Z
s + b
Z
t.

190
ABSTRACT MEASURE AND INTEGRATION
Proof: Let
s(Ï‰) =
n
X
i=1
Î±iXAi(Ï‰), t(Ï‰) =
m
X
i=1
Î²jXBj(Ï‰)
where Î±i are the distinct values of s and the Î²j are the distinct values of t. Clearly
as + bt is a nonnegative simple function because it is measurable and has ï¬nitely
many values. Also,
(as + bt)(Ï‰) =
m
X
j=1
n
X
i=1
(aÎ±i + bÎ²j)XAiâˆ©Bj(Ï‰)
where the sets Ai âˆ©Bj are disjoint. By Lemma 8.25,
Z
as + bt
=
m
X
j=1
n
X
i=1
(aÎ±i + bÎ²j)Âµ(Ai âˆ©Bj)
=
a
n
X
i=1
Î±iÂµ(Ai) + b
m
X
j=1
Î²jÂµ(Bj)
=
a
Z
s + b
Z
t.
This proves the lemma.
8.3.4
Simple Functions And Measurable Functions
There is a fundamental theorem about the relationship of simple functions to mea-
surable functions given in the next theorem.
Theorem 8.27 Let f â‰¥0 be measurable. Then there exists a sequence of nonneg-
ative simple functions {sn} satisfying
0 â‰¤sn(Ï‰)
(8.14)
Â· Â· Â· sn(Ï‰) â‰¤sn+1(Ï‰) Â· Â·Â·
f(Ï‰) = lim
nâ†’âˆžsn(Ï‰) for all Ï‰ âˆˆâ„¦.
(8.15)
If f is bounded the convergence is actually uniform.
Proof: Letting I â‰¡{Ï‰ : f (Ï‰) = âˆž} , deï¬ne
tn(Ï‰) =
2n
X
k=0
k
nX[k/nâ‰¤f<(k+1)/n](Ï‰) + nXI(Ï‰).
Then tn(Ï‰) â‰¤f(Ï‰) for all Ï‰ and limnâ†’âˆžtn(Ï‰) = f(Ï‰) for all Ï‰. This is because
tn (Ï‰) = n for Ï‰ âˆˆI and if f (Ï‰) âˆˆ[0, 2n+1
n
), then
0 â‰¤f (Ï‰) âˆ’tn (Ï‰) â‰¤1
n.
(8.16)

8.3.
THE ABSTRACT LEBESGUE INTEGRAL
191
Thus whenever Ï‰ /âˆˆI, the above inequality will hold for all n large enough. Let
s1 = t1, s2 = max (t1, t2) , s3 = max (t1, t2, t3) , Â· Â· Â·.
Then the sequence {sn} satisï¬es 8.14-8.15.
To verify the last claim, note that in this case the term nXI(Ï‰) is not present.
Therefore, for all n large enough, 8.16 holds for all Ï‰. Thus the convergence is
uniform. This proves the theorem.
Although it is not needed here, there is a similar theorem which applies to
measurable functions which have values in a separable metric space. In this context,
a simple function is one which is of the form
m
X
k=1
xkXEk (Ï‰)
where the Ek are disjoint measurable sets and the xk are in X.
Theorem 8.28 Let (â„¦, F) be a measure space and let f : â„¦â†’X where (X, d) is a
separable metric space. Then f be a measurable function if and only if there exists
a sequence of simple functions,{fn} such that for each Ï‰ âˆˆâ„¦and n âˆˆN,
d (fn (Ï‰) , f (Ï‰)) â‰¥d (fn+1 (Ï‰) , f (Ï‰))
(8.17)
and
lim
nâ†’âˆžd (fn (Ï‰) , f (Ï‰)) = 0.
(8.18)
Proof: Let D = {xk}âˆž
k=1 be a countable dense subset of X. First suppose f is
measurable. Then since in a metric space every open set is the countable intersection
of closed sets, it follows f âˆ’1 (closed set) âˆˆF. Now let Dn = {xk}n
k=1 . Let
A1 â‰¡
Â½
Ï‰ : d (x1, f (Ï‰)) = min
kâ‰¤n d (xk, f (Ï‰))
Â¾
That is, A1 are those Ï‰ such that f (Ï‰) is approximated best out of Dn by x1.
Why is this a measurable set?
It is because Ï‰ â†’d (x, f (Ï‰)) is a real valued
measurable function, being the composition of a continuous function, y â†’d (x, y)
and a measurable function, Ï‰ â†’f (Ï‰) . Next let
A2 â‰¡
Â½
Ï‰ /âˆˆA1 : d (x2, f (Ï‰)) = min
kâ‰¤n d (xk, f (Ï‰))
Â¾
and continue in this manner obtaining disjoint measurable sets, {Ak}n
k=1 such that
for Ï‰ âˆˆAk the best approximation to f (Ï‰) from Dn is xk. Then
fn (Ï‰) â‰¡
n
X
k=1
xkXAk (Ï‰) .

192
ABSTRACT MEASURE AND INTEGRATION
Note
min
kâ‰¤n+1 d (xk, f (Ï‰)) â‰¤min
kâ‰¤n d (xk, f (Ï‰))
and so this veriï¬es 8.17. It remains to verify 8.18.
Let Îµ > 0 be given and pick Ï‰ âˆˆâ„¦. Then there exists xn âˆˆD such that
d (xn, f (Ï‰)) < Îµ. It follows from the construction that d (fn (Ï‰) , f (Ï‰)) â‰¤d (xn, f (Ï‰)) <
Îµ. This proves the ï¬rst half.
Now suppose the existence of the sequence of simple functions as described
above.
Each fn is a measurable function because f âˆ’1
n
(U) = âˆª{Ak : xk âˆˆU}.
Therefore, the conclusion that f is measurable follows from Theorem 8.9 on Page
175.
8.3.5
The Monotone Convergence Theorem
The following is called the monotone convergence theorem. This theorem and re-
lated convergence theorems are the reason for using the Lebesgue integral.
Theorem 8.29 (Monotone Convergence theorem) Let f have values in [0, âˆž] and
suppose {fn} is a sequence of nonnegative measurable functions having values in
[0, âˆž] and satisfying
lim
nâ†’âˆžfn(Ï‰) = f(Ï‰) for each Ï‰.
Â· Â· Â·fn(Ï‰) â‰¤fn+1(Ï‰) Â· Â·Â·
Then f is measurable and
Z
fdÂµ = lim
nâ†’âˆž
Z
fndÂµ.
Proof: From Lemmas 8.19 and 8.20,
Z
fdÂµ
â‰¡
sup
h>0
âˆž
X
i=1
hÂµ ([ih < f])
=
sup
h>0
sup
k
k
X
i=1
hÂµ ([ih < f])
=
sup
h>0
sup
k
sup
m
k
X
i=1
hÂµ ([ih < fm])
=
sup
m sup
h>0
âˆž
X
i=1
hÂµ ([ih < fm])
â‰¡
sup
m
Z
fmdÂµ
=
lim
mâ†’âˆž
Z
fmdÂµ.

8.3.
THE ABSTRACT LEBESGUE INTEGRAL
193
The third equality follows from the observation that
lim
mâ†’âˆžÂµ ([ih < fm]) = Âµ ([ih < f])
which follows from Theorem 8.5 since the sets, [ih < fm] are increasing in m and
their union equals [ih < f]. This proves the theorem.
To illustrate what goes wrong without the Lebesgue integral, consider the fol-
lowing example.
Example 8.30 Let {rn} denote the rational numbers in [0, 1] and let
fn (t) â‰¡
Â½ 1 if t /âˆˆ{r1, Â· Â· Â·, rn}
0 otherwise
Then fn (t) â†‘f (t) where f is the function which is one on the rationals and zero
on the irrationals. Each fn is Riemann integrable (why?) but f is not Riemann
integrable. Therefore, you canâ€™t write
R
fdx = limnâ†’âˆž
R
fndx.
A meta-mathematical observation related to this type of example is this. If you
can choose your functions, you donâ€™t need the Lebesgue integral. The Riemann
integral is just ï¬ne. It is when you canâ€™t choose your functions and they come to
you as pointwise limits that you really need the superior Lebesgue integral or at
least something more general than the Riemann integral. The Riemann integral
is entirely adequate for evaluating the seemingly endless lists of boring problems
found in calculus books.
8.3.6
Other Deï¬nitions
To review and summarize the above, if f â‰¥0 is measurable,
Z
fdÂµ â‰¡sup
h>0
âˆž
X
i=1
hÂµ ([f > ih])
(8.19)
another way to get the same thing for
R
fdÂµ is to take an increasing sequence of
nonnegative simple functions, {sn} with sn (Ï‰) â†’f (Ï‰) and then by monotone
convergence theorem,
Z
fdÂµ = lim
nâ†’âˆž
Z
sn
where if sn (Ï‰) = Pm
j=1 ciXEi (Ï‰) ,
Z
sndÂµ =
m
X
i=1
cim (Ei) .
Similarly this also shows that for such nonnegative measurable function,
Z
fdÂµ = sup
Â½Z
s : 0 â‰¤s â‰¤f, s simple
Â¾

194
ABSTRACT MEASURE AND INTEGRATION
which is the usual way of deï¬ning the Lebesgue integral for nonnegative simple
functions in most books. I have done it diï¬€erently because this approach led to an
easier proof of the Monotone convergence theorem. Here is an equivalent deï¬nition
of the integral. The fact it is well deï¬ned has been discussed above.
Deï¬nition 8.31 For s a nonnegative simple function,
s (Ï‰) =
n
X
k=1
ckXEk (Ï‰) ,
Z
s =
n
X
k=1
ckÂµ (Ek) .
For f a nonnegative measurable function,
Z
fdÂµ = sup
Â½Z
s : 0 â‰¤s â‰¤f, s simple
Â¾
.
8.3.7
Fatouâ€™s Lemma
Sometimes the limit of a sequence does not exist.
There are two more general
notions known as lim sup and lim inf which do always exist in some sense. These
notions are dependent on the following lemma.
Lemma 8.32 Let {an} be an increasing (decreasing) sequence in [âˆ’âˆž, âˆž] . Then
limnâ†’âˆžan exists.
Proof: Suppose ï¬rst {an} is increasing. Recall this means an â‰¤an+1 for all n.
If the sequence is bounded above, then it has a least upper bound and so an â†’a
where a is its least upper bound. If the sequence is not bounded above, then for
every l âˆˆR, it follows l is not an upper bound and so eventually, an > l. But this
is what is meant by an â†’âˆž. The situation for decreasing sequences is completely
similar.
Now take any sequence, {an} âŠ†[âˆ’âˆž, âˆž] and consider the sequence {An} where
An â‰¡inf {ak : k â‰¥n} .
Then as n increases, the set of numbers whose inf is being taken is getting smaller.
Therefore, An is an increasing sequence and so it must converge. Similarly, if Bn â‰¡
sup {ak : k â‰¥n} , it follows Bn is decreasing and so {Bn} also must converge. With
this preparation, the following deï¬nition can be given.
Deï¬nition 8.33 Let {an} be a sequence of points in [âˆ’âˆž, âˆž] . Then deï¬ne
lim inf
nâ†’âˆžan â‰¡lim
nâ†’âˆžinf {ak : k â‰¥n}
and
lim sup
nâ†’âˆžan â‰¡lim
nâ†’âˆžsup {ak : k â‰¥n}
In the case of functions having values in [âˆ’âˆž, âˆž] ,
Â³
lim inf
nâ†’âˆžfn
Â´
(Ï‰) â‰¡lim inf
nâ†’âˆž(fn (Ï‰)) .
A similar deï¬nition applies to lim supnâ†’âˆžfn.

8.3.
THE ABSTRACT LEBESGUE INTEGRAL
195
Lemma 8.34 Let {an} be a sequence in [âˆ’âˆž, âˆž] . Then limnâ†’âˆžan exists if and
only if
lim inf
nâ†’âˆžan = lim sup
nâ†’âˆžan
and in this case, the limit equals the common value of these two numbers.
Proof: Suppose ï¬rst limnâ†’âˆžan = a âˆˆR. Then, letting Îµ > 0 be given, an âˆˆ
(a âˆ’Îµ, a + Îµ) for all n large enough, say n â‰¥N. Therefore, both inf {ak : k â‰¥n}
and sup {ak : k â‰¥n} are contained in [a âˆ’Îµ, a + Îµ] whenever n â‰¥N. It follows
lim supnâ†’âˆžan and lim infnâ†’âˆžan are both in [a âˆ’Îµ, a + Îµ] , showing
Â¯Â¯Â¯Â¯lim inf
nâ†’âˆžan âˆ’lim sup
nâ†’âˆžan
Â¯Â¯Â¯Â¯ < 2Îµ.
Since Îµ is arbitrary, the two must be equal and they both must equal a. Next suppose
limnâ†’âˆžan = âˆž. Then if l âˆˆR, there exists N such that for n â‰¥N,
l â‰¤an
and therefore, for such n,
l â‰¤inf {ak : k â‰¥n} â‰¤sup {ak : k â‰¥n}
and this shows, since l is arbitrary that
lim inf
nâ†’âˆžan = lim sup
nâ†’âˆžan = âˆž.
The case for âˆ’âˆžis similar.
Conversely, suppose lim infnâ†’âˆžan = lim supnâ†’âˆžan = a. Suppose ï¬rst that
a âˆˆR. Then, letting Îµ > 0 be given, there exists N such that if n â‰¥N,
sup {ak : k â‰¥n} âˆ’inf {ak : k â‰¥n} < Îµ
therefore, if k, m > N, and ak > am,
|ak âˆ’am| = ak âˆ’am â‰¤sup {ak : k â‰¥n} âˆ’inf {ak : k â‰¥n} < Îµ
showing that {an} is a Cauchy sequence. Therefore, it converges to a âˆˆR, and
as in the ï¬rst part, the lim inf and lim sup both equal a. If lim infnâ†’âˆžan =
lim supnâ†’âˆžan = âˆž, then given l âˆˆR, there exists N such that for n â‰¥N,
inf
n>N an > l.
Therefore, limnâ†’âˆžan = âˆž. The case for âˆ’âˆžis similar. This proves the lemma.
The next theorem, known as Fatouâ€™s lemma is another important theorem which
justiï¬es the use of the Lebesgue integral.

196
ABSTRACT MEASURE AND INTEGRATION
Theorem 8.35 (Fatouâ€™s lemma) Let fn be a nonnegative measurable function with
values in [0, âˆž]. Let g(Ï‰) = lim infnâ†’âˆžfn(Ï‰). Then g is measurable and
Z
gdÂµ â‰¤lim inf
nâ†’âˆž
Z
fndÂµ.
In other words,
Z Â³
lim inf
nâ†’âˆžfn
Â´
dÂµ â‰¤lim inf
nâ†’âˆž
Z
fndÂµ
Proof: Let gn(Ï‰) = inf{fk(Ï‰) : k â‰¥n}. Then
gâˆ’1
n ([a, âˆž]) = âˆ©âˆž
k=nf âˆ’1
k ([a, âˆž]) âˆˆF.
Thus gn is measurable by Lemma 8.6 on Page 173. Also g(Ï‰) = limnâ†’âˆžgn(Ï‰) so
g is measurable because it is the pointwise limit of measurable functions. Now the
functions gn form an increasing sequence of nonnegative measurable functions so
the monotone convergence theorem applies. This yields
Z
gdÂµ = lim
nâ†’âˆž
Z
gndÂµ â‰¤lim inf
nâ†’âˆž
Z
fndÂµ.
The last inequality holding because
Z
gndÂµ â‰¤
Z
fndÂµ.
(Note that it is not known whether limnâ†’âˆž
R
fndÂµ exists.) This proves the Theo-
rem.
8.3.8
The Righteous Algebraic Desires Of The Lebesgue In-
tegral
The monotone convergence theorem shows the integral wants to be linear. This is
the essential content of the next theorem.
Theorem 8.36 Let f, g be nonnegative measurable functions and let a, b be non-
negative numbers. Then
Z
(af + bg) dÂµ = a
Z
fdÂµ + b
Z
gdÂµ.
(8.20)
Proof:
By Theorem 8.27 on Page 190 there exist sequences of nonnegative
simple functions, sn â†’f and tn â†’g. Then by the monotone convergence theorem
and Lemma 8.26,
Z
(af + bg) dÂµ
=
lim
nâ†’âˆž
Z
asn + btndÂµ
=
lim
nâ†’âˆž
Âµ
a
Z
sndÂµ + b
Z
tndÂµ
Â¶
=
a
Z
fdÂµ + b
Z
gdÂµ.

8.4.
THE SPACE L1
197
As long as you are allowing functions to take the value +âˆž, you cannot consider
something like f + (âˆ’g) and so you canâ€™t very well expect a satisfactory statement
about the integral being linear until you restrict yourself to functions which have
values in a vector space. This is discussed next.
8.4
The Space L1
The functions considered here have values in C, a vector space.
Deï¬nition 8.37 Let (â„¦, S, Âµ) be a measure space and suppose f : â„¦â†’C. Then f
is said to be measurable if both Re f and Im f are measurable real valued functions.
Deï¬nition 8.38 A complex simple function will be a function which is of the form
s (Ï‰) =
n
X
k=1
ckXEk (Ï‰)
where ck âˆˆC and Âµ (Ek) < âˆž. For s a complex simple function as above, deï¬ne
I (s) â‰¡
n
X
k=1
ckÂµ (Ek) .
Lemma 8.39 The deï¬nition, 8.38 is well deï¬ned. Furthermore, I is linear on the
vector space of complex simple functions. Also the triangle inequality holds,
|I (s)| â‰¤I (|s|) .
Proof: Suppose Pn
k=1 ckXEk (Ï‰) = 0. Does it follow that P
k ckÂµ (Ek) = 0?
The supposition implies
n
X
k=1
Re ckXEk (Ï‰) = 0,
n
X
k=1
Im ckXEk (Ï‰) = 0.
(8.21)
Choose Î» large and positive so that Î» + Re ck â‰¥0. Then adding P
k Î»XEk to both
sides of the ï¬rst equation above,
n
X
k=1
(Î» + Re ck) XEk (Ï‰) =
n
X
k=1
Î»XEk
and by Lemma 8.26 on Page 189, it follows upon taking
R
of both sides that
n
X
k=1
(Î» + Re ck) Âµ (Ek) =
n
X
k=1
Î»Âµ (Ek)

198
ABSTRACT MEASURE AND INTEGRATION
which implies Pn
k=1 Re ckÂµ (Ek) = 0.
Similarly, Pn
k=1 Im ckÂµ (Ek) = 0 and so
Pn
k=1 ckÂµ (Ek) = 0. Thus if
X
j
cjXEj =
X
k
dkXFk
then P
j cjXEj + P
k (âˆ’dk) XFk = 0 and so the result just established veriï¬es
P
j cjÂµ (Ej) âˆ’P
k dkÂµ (Fk) = 0 which proves I is well deï¬ned.
That I is linear is now obvious. It only remains to verify the triangle inequality.
Let s be a simple function,
s =
X
j
cjXEj
Then pick Î¸ âˆˆC such that Î¸I (s) = |I (s)| and |Î¸| = 1. Then from the triangle
inequality for sums of complex numbers,
|I (s)|
=
Î¸I (s) = I (Î¸s) =
X
j
Î¸cjÂµ (Ej)
=
Â¯Â¯Â¯Â¯Â¯Â¯
X
j
Î¸cjÂµ (Ej)
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
X
j
|Î¸cj| Âµ (Ej) = I (|s|) .
This proves the lemma.
With this lemma, the following is the deï¬nition of L1 (â„¦) .
Deï¬nition 8.40 f âˆˆL1(â„¦) means there exists a sequence of complex simple func-
tions, {sn} such that
sn (Ï‰) â†’f (Ï‰) for all Ï‰ âˆˆâ„¦
limm,nâ†’âˆžI (|sn âˆ’sm|) = limn,mâ†’âˆž
R
|sn âˆ’sm| dÂµ = 0
(8.22)
Then
I (f) â‰¡lim
nâ†’âˆžI (sn) .
(8.23)
Lemma 8.41 Deï¬nition 8.40 is well deï¬ned.
Proof: There are several things which need to be veriï¬ed. First suppose 8.22.
Then by Lemma 8.39
|I (sn) âˆ’I (sm)| = |I (sn âˆ’sm)| â‰¤I (|sn âˆ’sm|)
and for m, n large enough this last is given to be small so {I (sn)} is a Cauchy
sequence in C and so it converges. This veriï¬es the limit in 8.23 at least exists. It
remains to consider another sequence {tn} having the same properties as {sn} and

8.4.
THE SPACE L1
199
verifying I (f) determined by this other sequence is the same. By Lemma 8.39 and
Fatouâ€™s lemma, Theorem 8.35 on Page 196,
|I (sn) âˆ’I (tn)|
â‰¤
I (|sn âˆ’tn|) =
Z
|sn âˆ’tn| dÂµ
â‰¤
Z
|sn âˆ’f| + |f âˆ’tn| dÂµ
â‰¤
lim inf
kâ†’âˆž
Z
|sn âˆ’sk| dÂµ + lim inf
kâ†’âˆž
Z
|tn âˆ’tk| dÂµ < Îµ
whenever n is large enough. Since Îµ is arbitrary, this shows the limit from using
the tn is the same as the limit from using sn. This proves the lemma.
What if f has values in [0, âˆž)? Earlier
R
fdÂµ was deï¬ned for such functions and
now I (f) has been deï¬ned. Are they the same? If so, I can be regarded as an
extension of
R
dÂµ to a larger class of functions.
Lemma 8.42 Suppose f has values in [0, âˆž) and f âˆˆL1 (â„¦) . Then f is measurable
and
I (f) =
Z
fdÂµ.
Proof: Since f is the pointwise limit of a sequence of complex simple func-
tions, {sn} having the properties described in Deï¬nition 8.40, it follows f (Ï‰) =
limnâ†’âˆžRe sn (Ï‰) and so f is measurable. Also
Z Â¯Â¯Â¯(Re sn)+ âˆ’(Re sm)+Â¯Â¯Â¯ dÂµ â‰¤
Z
|Re sn âˆ’Re sm| dÂµ â‰¤
Z
|sn âˆ’sm| dÂµ
where x+ â‰¡1
2 (|x| + x) , the positive part of the real number, x. 2Thus there is no
loss of generality in assuming {sn} is a sequence of complex simple functions having
values in [0, âˆž). Then since for such complex simple functions, I (s) =
R
sdÂµ,
Â¯Â¯Â¯Â¯I (f) âˆ’
Z
fdÂµ
Â¯Â¯Â¯Â¯ â‰¤|I (f) âˆ’I (sn)| +
Â¯Â¯Â¯Â¯
Z
sndÂµ âˆ’
Z
fdÂµ
Â¯Â¯Â¯Â¯ < Îµ +
Z
|sn âˆ’f| dÂµ
whenever n is large enough. But by Fatouâ€™s lemma, Theorem 8.35 on Page 196, the
last term is no larger than
lim inf
kâ†’âˆž
Z
|sn âˆ’sk| dÂµ < Îµ
whenever n is large enough.
Since Îµ is arbitrary, this shows I (f) =
R
fdÂµ as
claimed.
As explained above, I can be regarded as an extension of
R
dÂµ so from now on,
the usual symbol,
R
dÂµ will be used. It is now easy to verify
R
dÂµ is linear on L1 (â„¦) .
2The negative part of the real number x is deï¬ned to be xâˆ’â‰¡1
2 (|x| âˆ’x) . Thus |x| = x+ + xâˆ’
and x = x+ âˆ’xâˆ’. .

200
ABSTRACT MEASURE AND INTEGRATION
Theorem 8.43
R
dÂµ is linear on L1 (â„¦) and L1 (â„¦) is a complex vector space. If
f âˆˆL1 (â„¦) , then Re f, Im f, and |f| are all in L1 (â„¦) . Furthermore, for f âˆˆL1 (â„¦) ,
Z
fdÂµ =
Z
(Re f)+ dÂµ âˆ’
Z
(Re f)âˆ’dÂµ + i
ÂµZ
(Im f)+ dÂµ âˆ’
Z
(Im f)âˆ’dÂµ
Â¶
Also the triangle inequality holds,
Â¯Â¯Â¯Â¯
Z
fdÂµ
Â¯Â¯Â¯Â¯ â‰¤
Z
|f| dÂµ
Proof: First it is necessary to verify that L1 (â„¦) is really a vector space because
it makes no sense to speak of linear maps without having these maps deï¬ned on
a vector space. Let f, g be in L1 (â„¦) and let a, b âˆˆC. Then let {sn} and {tn}
be sequences of complex simple functions associated with f and g respectively as
described in Deï¬nition 8.40. Consider {asn + btn} , another sequence of complex
simple functions. Then asn (Ï‰) + btn (Ï‰) â†’af (Ï‰) + bg (Ï‰) for each Ï‰. Also, from
Lemma 8.39
Z
|asn + btn âˆ’(asm + btm)| dÂµ â‰¤|a|
Z
|sn âˆ’sm| dÂµ + |b|
Z
|tn âˆ’tm| dÂµ
and the sum of the two terms on the right converge to zero as m, n â†’âˆž. Thus
af + bg âˆˆL1 (â„¦) . Also
Z
(af + bg) dÂµ
=
lim
nâ†’âˆž
Z
(asn + btn) dÂµ
=
lim
nâ†’âˆž
Âµ
a
Z
sndÂµ + b
Z
tndÂµ
Â¶
=
a lim
nâ†’âˆž
Z
sndÂµ + b lim
nâ†’âˆž
Z
tndÂµ
=
a
Z
fdÂµ + b
Z
gdÂµ.
If {sn} is a sequence of complex simple functions described in Deï¬nition 8.40
corresponding to f, then {|sn|} is a sequence of complex simple functions satisfying
the conditions of Deï¬nition 8.40 corresponding to |f| . This is because |sn (Ï‰)| â†’
|f (Ï‰)| and
Z
||sn| âˆ’|sm|| dÂµ â‰¤
Z
|sm âˆ’sn| dÂµ
with this last expression converging to 0 as m, n â†’âˆž. Thus |f| âˆˆL1 (â„¦). Also, by
similar reasoning, {Re sn} and {Im sn} correspond to Re f and Im f respectively in
the manner described by Deï¬nition 8.40 showing that Re f and Im f are in L1 (â„¦).
Now (Re f)+ = 1
2 (|Re f| + Re f) and (Re f)âˆ’= 1
2 (|Re f| âˆ’Re f) so both of these
functions are in L1 (â„¦) . Similar formulas establish that (Im f)+ and (Im f)âˆ’are in
L1 (â„¦) .

8.4.
THE SPACE L1
201
The formula follows from the observation that
f = (Re f)+ âˆ’(Re f)âˆ’+ i
Â³
(Im f)+ âˆ’(Im f)âˆ’Â´
and the fact shown ï¬rst that
R
dÂµ is linear.
To verify the triangle inequality, let {sn} be complex simple functions for f as
in Deï¬nition 8.40. Then
Â¯Â¯Â¯Â¯
Z
fdÂµ
Â¯Â¯Â¯Â¯ = lim
nâ†’âˆž
Â¯Â¯Â¯Â¯
Z
sndÂµ
Â¯Â¯Â¯Â¯ â‰¤lim
nâ†’âˆž
Z
|sn| dÂµ =
Z
|f| dÂµ.
This proves the theorem.
The following description of L1 (â„¦) is the version most often used because it is
easy to verify the conditions for it.
Corollary 8.44 Let (â„¦, S, Âµ) be a measure space and let f : â„¦â†’C. Then f âˆˆ
L1 (â„¦) if and only if f is measurable and
R
|f| dÂµ < âˆž.
Proof: Suppose f âˆˆL1 (â„¦) . Then from Deï¬nition 8.40, it follows both real and
imaginary parts of f are measurable. Just take real and imaginary parts of sn and
observe the real and imaginary parts of f are limits of the real and imaginary parts
of sn respectively. By Theorem 8.43 this shows the only if part.
The more interesting part is the if part. Suppose then that f is measurable and
R
|f| dÂµ < âˆž. Suppose ï¬rst that f has values in [0, âˆž). It is necessary to obtain the
sequence of complex simple functions. By Theorem 8.27, there exists a sequence of
nonnegative simple functions, {sn} such that sn (Ï‰) â†‘f (Ï‰). Then by the monotone
convergence theorem,
lim
nâ†’âˆž
Z
(2f âˆ’(f âˆ’sn)) dÂµ =
Z
2fdÂµ
and so
lim
nâ†’âˆž
Z
(f âˆ’sn) dÂµ = 0.
Letting m be large enough, it follows
R
(f âˆ’sm) dÂµ < Îµ and so if n > m
Z
|sm âˆ’sn| dÂµ â‰¤
Z
|f âˆ’sm| dÂµ < Îµ.
Therefore, f âˆˆL1 (â„¦) because {sn} is a suitable sequence.
The general case follows from considering positive and negative parts of real and
imaginary parts of f. These are each measurable and nonnegative and their integral
is ï¬nite so each is in L1 (â„¦) by what was just shown. Thus
f = Re f + âˆ’Re f âˆ’+ i
Â¡
Im f + âˆ’Im f âˆ’Â¢
and so f âˆˆL1 (â„¦). This proves the corollary.

202
ABSTRACT MEASURE AND INTEGRATION
Theorem 8.45 (Dominated Convergence theorem) Let fn âˆˆL1(â„¦) and suppose
f(Ï‰) = lim
nâ†’âˆžfn(Ï‰),
and there exists a measurable function g, with values in [0, âˆž],3 such that
|fn(Ï‰)| â‰¤g(Ï‰) and
Z
g(Ï‰)dÂµ < âˆž.
Then f âˆˆL1(â„¦) and
Z
fdÂµ = lim
nâ†’âˆž
Z
fndÂµ.
Proof: f is measurable by Theorem 8.8. Since |f| â‰¤g, it follows that
f âˆˆL1(â„¦) and |f âˆ’fn| â‰¤2g.
By Fatouâ€™s lemma (Theorem 8.35),
Z
2gdÂµ
â‰¤
lim inf
nâ†’âˆž
Z
2g âˆ’|f âˆ’fn|dÂµ
=
Z
2gdÂµ âˆ’lim sup
nâ†’âˆž
Z
|f âˆ’fn|dÂµ.
Subtracting
R
2gdÂµ,
0 â‰¤âˆ’lim sup
nâ†’âˆž
Z
|f âˆ’fn|dÂµ.
Hence
0
â‰¥
lim sup
nâ†’âˆž(
Z
|f âˆ’fn|dÂµ) â‰¥lim sup
nâ†’âˆž|
Z
fdÂµ âˆ’
Z
fndÂµ|
â‰¥
lim inf
nâ†’âˆž|
Z
fdÂµ âˆ’
Z
fndÂµ| â‰¥0.
This proves the theorem by Lemma 8.34 on Page 195 because the lim sup and lim inf
are equal.
Corollary 8.46 Suppose fn âˆˆL1 (â„¦) and f (Ï‰) = limnâ†’âˆžfn (Ï‰) . Suppose also
there exist measurable functions, gn, g with values in [0, âˆž] such that
lim
nâ†’âˆž
Z
gndÂµ =
Z
gdÂµ,
gn (Ï‰) â†’g (Ï‰) Âµ a.e. and both
R
gndÂµ and
R
gdÂµ are ï¬nite. Also suppose |fn (Ï‰)| â‰¤
gn (Ï‰) . Then
lim
nâ†’âˆž
Z
|f âˆ’fn| dÂµ = 0.
3Note that, since g is allowed to have the value âˆž, it is not known that g âˆˆL1 (â„¦) .

8.5.
VITALI CONVERGENCE THEOREM
203
Proof: It is just like the above. This time g + gn âˆ’|f âˆ’fn| â‰¥0 and so by
Fatouâ€™s lemma,
Z
2gdÂµ âˆ’lim sup
nâ†’âˆž
Z
|f âˆ’fn| dÂµ =
lim inf
nâ†’âˆž
Z
(gn + g) âˆ’lim sup
nâ†’âˆž
Z
|f âˆ’fn| dÂµ
=
lim inf
nâ†’âˆž
Z
((gn + g) âˆ’|f âˆ’fn|) dÂµ â‰¥
Z
2gdÂµ
and so âˆ’lim supnâ†’âˆž
R
|f âˆ’fn| dÂµ â‰¥0.
Deï¬nition 8.47 Let E be a measurable subset of â„¦.
Z
E
fdÂµ â‰¡
Z
fXEdÂµ.
If L1(E) is written, the Ïƒ algebra is deï¬ned as
{E âˆ©A : A âˆˆF}
and the measure is Âµ restricted to this smaller Ïƒ algebra. Clearly, if f âˆˆL1(â„¦),
then
fXE âˆˆL1(E)
and if f âˆˆL1(E), then letting Ëœf
be the 0 extension of f oï¬€of E, it follows Ëœf
âˆˆL1(â„¦).
8.5
Vitali Convergence Theorem
The Vitali convergence theorem is a convergence theorem which in the case of a
ï¬nite measure space is superior to the dominated convergence theorem.
Deï¬nition 8.48 Let (â„¦, F, Âµ) be a measure space and let S âŠ†L1(â„¦). S is uni-
formly integrable if for every Îµ > 0 there exists Î´ > 0 such that for all f âˆˆS
|
Z
E
fdÂµ| < Îµ whenever Âµ(E) < Î´.
Lemma 8.49 If S is uniformly integrable, then |S| â‰¡{|f| : f âˆˆS} is uniformly
integrable. Also S is uniformly integrable if S is ï¬nite.
Proof: Let Îµ > 0 be given and suppose S is uniformly integrable. First suppose
the functions are real valued. Let Î´ be such that if Âµ (E) < Î´, then
Â¯Â¯Â¯Â¯
Z
E
fdÂµ
Â¯Â¯Â¯Â¯ < Îµ
2

204
ABSTRACT MEASURE AND INTEGRATION
for all f âˆˆS. Let Âµ (E) < Î´. Then if f âˆˆS,
Z
E
|f| dÂµ
â‰¤
Z
Eâˆ©[fâ‰¤0]
(âˆ’f) dÂµ +
Z
Eâˆ©[f>0]
fdÂµ
=
Â¯Â¯Â¯Â¯Â¯
Z
Eâˆ©[fâ‰¤0]
fdÂµ
Â¯Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯Â¯
Z
Eâˆ©[f>0]
fdÂµ
Â¯Â¯Â¯Â¯Â¯
<
Îµ
2 + Îµ
2 = Îµ.
In general, if S is a uniformly integrable set of complex valued functions, the in-
equalities,
Â¯Â¯Â¯Â¯
Z
E
Re fdÂµ
Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯
Z
E
fdÂµ
Â¯Â¯Â¯Â¯ ,
Â¯Â¯Â¯Â¯
Z
E
Im fdÂµ
Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯
Z
E
fdÂµ
Â¯Â¯Â¯Â¯ ,
imply Re S â‰¡{Re f : f âˆˆS} and Im S â‰¡{Im f : f âˆˆS} are also uniformly inte-
grable. Therefore, applying the above result for real valued functions to these sets
of functions, it follows |S| is uniformly integrable also.
For the last part, is suï¬ƒces to verify a single function in L1 (â„¦) is uniformly
integrable. To do so, note that from the dominated convergence theorem,
lim
Râ†’âˆž
Z
[|f|>R]
|f| dÂµ = 0.
Let Îµ > 0 be given and choose R large enough that
R
[|f|>R] |f| dÂµ < Îµ
2. Now let
Âµ (E) <
Îµ
2R. Then
Z
E
|f| dÂµ
=
Z
Eâˆ©[|f|â‰¤R]
|f| dÂµ +
Z
Eâˆ©[|f|>R]
|f| dÂµ
<
RÂµ (E) + Îµ
2 < Îµ
2 + Îµ
2 = Îµ.
This proves the lemma.
The following theorem is Vitaliâ€™s convergence theorem.
Theorem 8.50 Let {fn} be a uniformly integrable set of complex valued functions,
Âµ(â„¦) < âˆž, and
fn(x) â†’f(x)
a.e.
where f is a measurable complex valued
function. Then f âˆˆL1 (â„¦) and
lim
nâ†’âˆž
Z
â„¦
|fn âˆ’f|dÂµ = 0.
(8.24)
Proof: First it will be shown that f âˆˆL1 (â„¦). By uniform integrability, there
exists Î´ > 0 such that if Âµ (E) < Î´, then
Z
E
|fn| dÂµ < 1

8.6.
EXERCISES
205
for all n. By Egoroï¬€â€™s theorem, there exists a set, E of measure less than Î´ such
that on EC, {fn} converges uniformly. Therefore, for p large enough, and n > p,
Z
EC |fp âˆ’fn| dÂµ < 1
which implies
Z
EC |fn| dÂµ < 1 +
Z
â„¦
|fp| dÂµ.
Then since there are only ï¬nitely many functions, fn with n â‰¤p, there exists a
constant, M1 such that for all n,
Z
EC |fn| dÂµ < M1.
But also,
Z
â„¦
|fm| dÂµ
=
Z
EC |fm| dÂµ +
Z
E
|fm|
â‰¤
M1 + 1 â‰¡M.
Therefore, by Fatouâ€™s lemma,
Z
â„¦
|f| dÂµ â‰¤lim inf
nâ†’âˆž
Z
|fn| dÂµ â‰¤M,
showing that f âˆˆL1 as hoped.
Now Sâˆª{f} is uniformly integrable so there exists Î´1 > 0 such that if Âµ (E) < Î´1,
then
R
E |g| dÂµ < Îµ/3 for all g âˆˆS âˆª{f}. By Egoroï¬€â€™s theorem, there exists a set,
F with Âµ (F) < Î´1 such that fn converges uniformly to f on F C. Therefore, there
exists N such that if n > N, then
Z
F C |f âˆ’fn| dÂµ < Îµ
3.
It follows that for n > N,
Z
â„¦
|f âˆ’fn| dÂµ
â‰¤
Z
F C |f âˆ’fn| dÂµ +
Z
F
|f| dÂµ +
Z
F
|fn| dÂµ
<
Îµ
3 + Îµ
3 + Îµ
3 = Îµ,
which veriï¬es 8.24.
8.6
Exercises
1. Let â„¦= N = {1, 2, Â· Â· Â·} and Âµ(S) = number of elements in S. If
f : â„¦â†’C
what is meant by
R
fdÂµ? Which functions are in L1(â„¦)? Which functions are
measurable?

206
ABSTRACT MEASURE AND INTEGRATION
2. Show that for f â‰¥0 and measurable,
R
fdÂµ â‰¡limhâ†’0+
Pâˆž
i=1 hÂµ ([ih < f]).
3. For the measure space of Problem 1, give an example of a sequence of nonneg-
ative measurable functions {fn} converging pointwise to a function f, such
that inequality is obtained in Fatouâ€™s lemma.
4. Fill in all the details of the proof of Lemma 8.49.
5. Let Pn
i=1 ciXEi (Ï‰) = s (Ï‰) be a nonnegative simple function for which the ci
are the distinct nonzero values. Show with the aid of the monotone conver-
gence theorem that the two deï¬nitions of the Lebesgue integral given in the
chapter are equivalent.
6. Suppose (â„¦, Âµ) is a ï¬nite measure space and S âŠ†L1 (â„¦). Show S is uniformly
integrable and bounded in L1 (â„¦) if there exists an increasing function h which
satisï¬es
lim
tâ†’âˆž
h (t)
t
= âˆž, sup
Â½Z
â„¦
h (|f|) dÂµ : f âˆˆS
Â¾
< âˆž.
S is bounded if there is some number, M such that
Z
|f| dÂµ â‰¤M
for all f âˆˆS.
7. Let {an}, {bn} be sequences in [âˆ’âˆž, âˆž] and a âˆˆR. Show
lim inf
nâ†’âˆž(a âˆ’an) = a âˆ’lim sup
nâ†’âˆžan.
This was used in the proof of the Dominated convergence theorem. Also show
lim sup
nâ†’âˆž(âˆ’an) = âˆ’lim inf
nâ†’âˆž(an)
lim sup
nâ†’âˆž(an + bn) â‰¤lim sup
nâ†’âˆžan + lim sup
nâ†’âˆžbn
provided no sum is of the form âˆžâˆ’âˆž. Also show strict inequality can hold
in the inequality. State and prove corresponding statements for lim inf.
8. Let (â„¦, F, Âµ) be a measure space and suppose f, g : â„¦â†’(âˆ’âˆž, âˆž] are mea-
surable. Prove the sets
{Ï‰ : f(Ï‰) < g(Ï‰)} and {Ï‰ : f(Ï‰) = g(Ï‰)}
are measurable. Hint: The easy way to do this is to write
{Ï‰ : f(Ï‰) < g(Ï‰)} = âˆªrâˆˆQ [f < r] âˆ©[g > r] .
Note that l (x, y) = x âˆ’y is not continuous on (âˆ’âˆž, âˆž] so the obvious idea
doesnâ€™t work.

8.6.
EXERCISES
207
9. Let {fn} be a sequence of real or complex valued measurable functions. Let
S = {Ï‰ : {fn(Ï‰)} converges}.
Show S is measurable. Hint: You might try to exhibit the set where fn
converges in terms of countable unions and intersections using the deï¬nition
of a Cauchy sequence.
10. Let (â„¦, S, Âµ) be a measure space and let f be a nonnegative measurable func-
tion deï¬ned on â„¦. Also let Ï† : [0, âˆž) â†’[0, âˆž) be strictly increasing and
have a continuous derivative and Ï† (0) = 0. Suppose f is bounded and that
0 â‰¤Ï† (f (Ï‰)) â‰¤M for some number, M. Show that
Z
â„¦
Ï† (f) dÂµ =
Z âˆž
0
Ï†â€² (s) Âµ ([s < f]) ds,
where the integral on the right is the ordinary improper Riemann integral.
Hint: First note that s â†’Ï†â€² (s) Âµ ([s < f]) is Riemann integrable because Ï†â€²
is continuous and s â†’Âµ ([s < f]) is a nonincreasing function, hence Riemann
integrable.
From the second description of the Lebesgue integral and the
assumption that Ï† (f (Ï‰)) â‰¤M, argue that for [M/h] the greatest integer less
than M/h,
Z
â„¦
Ï† (f) dÂµ
=
sup
h>0
[M/h]
X
i=1
hÂµ ([ih < Ï† (f)])
=
sup
h>0
[M/h]
X
i=1
hÂµ
Â¡Â£
Ï†âˆ’1 (ih) < f
Â¤Â¢
=
sup
h>0
[M/h]
X
i=1
hâˆ†i
âˆ†i
Âµ
Â¡Â£
Ï†âˆ’1 (ih) < f
Â¤Â¢
where âˆ†i =
Â¡
Ï†âˆ’1 (ih) âˆ’Ï†âˆ’1 ((i âˆ’1) h)
Â¢
. Now use the mean value theorem to
write
âˆ†i
=
Â¡
Ï†âˆ’1Â¢â€² (ti) h
=
1
Ï†â€² Â¡
Ï†âˆ’1 (ti)
Â¢h
for some ti between (i âˆ’1) h and ih. Therefore, the right side is of the form
sup
h
[M/h]
X
i=1
Ï†â€² Â¡
Ï†âˆ’1 (ti)
Â¢
âˆ†iÂµ
Â¡Â£
Ï†âˆ’1 (ih) < f
Â¤Â¢
where Ï†âˆ’1 (ti) âˆˆ
Â¡
Ï†âˆ’1 ((i âˆ’1) h) , Ï†âˆ’1 (ih)
Â¢
. Argue that if ti were replaced
with ih, this would be a Riemann sum for the Riemann integral
Z Ï†âˆ’1(M)
0
Ï†â€² (t) Âµ ([t < f]) dt =
Z âˆž
0
Ï†â€² (t) Âµ ([t < f]) dt.

208
ABSTRACT MEASURE AND INTEGRATION
11. Let (â„¦, F, Âµ) be a measure space and suppose fn converges uniformly to f
and that fn is in L1(â„¦). When is
lim
nâ†’âˆž
Z
fndÂµ =
Z
fdÂµ?
12. Suppose un(t) is a diï¬€erentiable function for t âˆˆ(a, b) and suppose that for
t âˆˆ(a, b),
|un(t)|, |uâ€²
n(t)| < Kn
where Pâˆž
n=1 Kn < âˆž. Show
(
âˆž
X
n=1
un(t))â€² =
âˆž
X
n=1
uâ€²
n(t).
Hint: This is an exercise in the use of the dominated convergence theorem
and the mean value theorem.
13. Show that {Pâˆž
i=1 2âˆ’nÂµ ([i2âˆ’n < f])} for f a nonnegative measurable function
is an increasing sequence. Could you deï¬ne
Z
fdÂµ â‰¡lim
nâ†’âˆž
âˆž
X
i=1
2âˆ’nÂµ
Â¡Â£
i2âˆ’n < f
Â¤Â¢
and would it be equivalent to the above deï¬nitions of the Lebesgue integral?
14. Suppose {fn} is a sequence of nonnegative measurable functions deï¬ned on a
measure space, (â„¦, S, Âµ). Show that
Z
âˆž
X
k=1
fkdÂµ =
âˆž
X
k=1
Z
fkdÂµ.
Hint: Use the monotone convergence theorem along with the fact the integral
is linear.

The Construction Of
Measures
9.1
Outer Measures
What are some examples of measure spaces? In this chapter, a general procedure
is discussed called the method of outer measures. It is due to Caratheodory (1918).
This approach shows how to obtain measure spaces starting with an outer mea-
sure. This will then be used to construct measures determined by positive linear
functionals.
Deï¬nition 9.1 Let â„¦be a nonempty set and let Âµ : P(â„¦) â†’[0, âˆž] satisfy
Âµ(âˆ…) = 0,
If A âŠ†B, then Âµ(A) â‰¤Âµ(B),
Âµ(âˆªâˆž
i=1Ei) â‰¤
âˆž
X
i=1
Âµ(Ei).
Such a function is called an outer measure. For E âŠ†â„¦, E is Âµ measurable if for
all S âŠ†â„¦,
Âµ(S) = Âµ(S \ E) + Âµ(S âˆ©E).
(9.1)
To help in remembering 9.1, think of a measurable set, E, as a process which
divides a given set into two pieces, the part in E and the part not in E as in
9.1. In the Bible, there are four incidents recorded in which a process of division
resulted in more stuï¬€than was originally present.1
Measurable sets are exactly
11 Kings 17, 2 Kings 4, Mathew 14, and Mathew 15 all contain such descriptions. The stuï¬€
involved was either oil, bread, ï¬‚our or ï¬sh. In mathematics such things have also been done with
sets. In the book by Bruckner Bruckner and Thompson there is an interesting discussion of the
Banach Tarski paradox which says it is possible to divide a ball in R3 into ï¬ve disjoint pieces and
assemble the pieces to form two disjoint balls of the same size as the ï¬rst. The details can be
found in: The Banach Tarski Paradox by Wagon, Cambridge University press. 1985. It is known
that all such examples must involve the axiom of choice.
209

210
THE CONSTRUCTION OF MEASURES
those for which no such miracle occurs. You might think of the measurable sets as
the nonmiraculous sets. The idea is to show that they form a Ïƒ algebra on which
the outer measure, Âµ is a measure.
First here is a deï¬nition and a lemma.
Deï¬nition 9.2 (ÂµâŒŠS)(A) â‰¡Âµ(S âˆ©A) for all A âŠ†â„¦. Thus ÂµâŒŠS is the name of a
new outer measure, called Âµ restricted to S.
The next lemma indicates that the property of measurability is not lost by
considering this restricted measure.
Lemma 9.3 If A is Âµ measurable, then A is ÂµâŒŠS measurable.
Proof: Suppose A is Âµ measurable. It is desired to to show that for all T âŠ†â„¦,
(ÂµâŒŠS)(T) = (ÂµâŒŠS)(T âˆ©A) + (ÂµâŒŠS)(T \ A).
Thus it is desired to show
Âµ(S âˆ©T) = Âµ(T âˆ©A âˆ©S) + Âµ(T âˆ©S âˆ©AC).
(9.2)
But 9.2 holds because A is Âµ measurable. Apply Deï¬nition 9.1 to S âˆ©T instead of
S.
If A is ÂµâŒŠS measurable, it does not follow that A is Âµ measurable. Indeed, if
you believe in the existence of non measurable sets, you could let A = S for such a
Âµ non measurable set and verify that S is ÂµâŒŠS measurable.
The next theorem is the main result on outer measures. It is a very general
result which applies whenever one has an outer measure on the power set of any
set. This theorem will be referred to as Caratheodoryâ€™s procedure in the rest of the
book.
Theorem 9.4 The collection of Âµ measurable sets, S, forms a Ïƒ algebra and
If Fi âˆˆS, Fi âˆ©Fj = âˆ…, then Âµ(âˆªâˆž
i=1Fi) =
âˆž
X
i=1
Âµ(Fi).
(9.3)
If Â· Â· Â·Fn âŠ†Fn+1 âŠ†Â· Â· Â·, then if F = âˆªâˆž
n=1Fn and Fn âˆˆS, it follows that
Âµ(F) = lim
nâ†’âˆžÂµ(Fn).
(9.4)
If Â· Â· Â·Fn âŠ‡Fn+1 âŠ‡Â· Â· Â·, and if F = âˆ©âˆž
n=1Fn for Fn âˆˆS then if Âµ(F1) < âˆž,
Âµ(F) = lim
nâ†’âˆžÂµ(Fn).
(9.5)
Also, (S, Âµ) is complete. By this it is meant that if F âˆˆS and if E âŠ†â„¦with
Âµ(E \ F) + Âµ(F \ E) = 0, then E âˆˆS.

9.1.
OUTER MEASURES
211
Proof: First note that âˆ…and â„¦are obviously in S. Now suppose A, B âˆˆS. I
will show A \ B â‰¡A âˆ©BC is in S. To do so, consider the following picture.
S T AC T BC
S T AC T B
S T A T B
S T A T BC
A
B
S
Since Âµ is subadditive,
Âµ (S) â‰¤Âµ
Â¡
S âˆ©A âˆ©BCÂ¢
+ Âµ (A âˆ©B âˆ©S) + Âµ
Â¡
S âˆ©B âˆ©ACÂ¢
+ Âµ
Â¡
S âˆ©AC âˆ©BCÂ¢
.
Now using A, B âˆˆS,
Âµ (S)
â‰¤
Âµ
Â¡
S âˆ©A âˆ©BCÂ¢
+ Âµ (S âˆ©A âˆ©B) + Âµ
Â¡
S âˆ©B âˆ©ACÂ¢
+ Âµ
Â¡
S âˆ©AC âˆ©BCÂ¢
=
Âµ (S âˆ©A) + Âµ
Â¡
S âˆ©ACÂ¢
= Âµ (S)
It follows equality holds in the above. Now observe using the picture if you like that
(A âˆ©B âˆ©S) âˆª
Â¡
S âˆ©B âˆ©ACÂ¢
âˆª
Â¡
S âˆ©AC âˆ©BCÂ¢
= S \ (A \ B)
and therefore,
Âµ (S)
=
Âµ
Â¡
S âˆ©A âˆ©BCÂ¢
+ Âµ (A âˆ©B âˆ©S) + Âµ
Â¡
S âˆ©B âˆ©ACÂ¢
+ Âµ
Â¡
S âˆ©AC âˆ©BCÂ¢
â‰¥
Âµ (S âˆ©(A \ B)) + Âµ (S \ (A \ B)) .
Therefore, since S is arbitrary, this shows A \ B âˆˆS.
Since â„¦âˆˆS, this shows that A âˆˆS if and only if AC âˆˆS. Now if A, B âˆˆS,
A âˆªB = (AC âˆ©BC)C = (AC \ B)C âˆˆS. By induction, if A1, Â· Â· Â·, An âˆˆS, then so is
âˆªn
i=1Ai. If A, B âˆˆS, with A âˆ©B = âˆ…,
Âµ(A âˆªB) = Âµ((A âˆªB) âˆ©A) + Âµ((A âˆªB) \ A) = Âµ(A) + Âµ(B).

212
THE CONSTRUCTION OF MEASURES
By induction, if Ai âˆ©Aj = âˆ…and Ai âˆˆS, Âµ(âˆªn
i=1Ai) = Pn
i=1 Âµ(Ai).
Now let A = âˆªâˆž
i=1Ai where Ai âˆ©Aj = âˆ…for i Ì¸= j.
âˆž
X
i=1
Âµ(Ai) â‰¥Âµ(A) â‰¥Âµ(âˆªn
i=1Ai) =
n
X
i=1
Âµ(Ai).
Since this holds for all n, you can take the limit as n â†’âˆžand conclude,
âˆž
X
i=1
Âµ(Ai) = Âµ(A)
which establishes 9.3. Part 9.4 follows from part 9.3 just as in the proof of Theorem
8.5 on Page 172. That is, letting F0 â‰¡âˆ…, use part 9.3 to write
Âµ (F)
=
Âµ (âˆªâˆž
k=1 (Fk \ Fkâˆ’1)) =
âˆž
X
k=1
Âµ (Fk \ Fkâˆ’1)
=
lim
nâ†’âˆž
n
X
k=1
(Âµ (Fk) âˆ’Âµ (Fkâˆ’1)) = lim
nâ†’âˆžÂµ (Fn) .
In order to establish 9.5, let the Fn be as given there. Then, since (F1 \ Fn)
increases to (F1 \ F), 9.4 implies
lim
nâ†’âˆž(Âµ (F1) âˆ’Âµ (Fn)) = Âµ (F1 \ F) .
Now Âµ (F1 \ F) + Âµ (F) â‰¥Âµ (F1) and so Âµ (F1 \ F) â‰¥Âµ (F1) âˆ’Âµ (F). Hence
lim
nâ†’âˆž(Âµ (F1) âˆ’Âµ (Fn)) = Âµ (F1 \ F) â‰¥Âµ (F1) âˆ’Âµ (F)
which implies
lim
nâ†’âˆžÂµ (Fn) â‰¤Âµ (F) .
But since F âŠ†Fn,
Âµ (F) â‰¤lim
nâ†’âˆžÂµ (Fn)
and this establishes 9.5. Note that it was assumed Âµ (F1) < âˆžbecause Âµ (F1) was
subtracted from both sides.
It remains to show S is closed under countable unions. Recall that if A âˆˆS, then
AC âˆˆS and S is closed under ï¬nite unions. Let Ai âˆˆS, A = âˆªâˆž
i=1Ai, Bn = âˆªn
i=1Ai.
Then
Âµ(S)
=
Âµ(S âˆ©Bn) + Âµ(S \ Bn)
(9.6)
=
(ÂµâŒŠS)(Bn) + (ÂµâŒŠS)(BC
n ).
By Lemma 9.3 Bn is (ÂµâŒŠS) measurable and so is BC
n .
I want to show Âµ(S) â‰¥
Âµ(S \ A) + Âµ(S âˆ©A). If Âµ(S) = âˆž, there is nothing to prove. Assume Âµ(S) < âˆž.

9.1.
OUTER MEASURES
213
Then apply Parts 9.5 and 9.4 to the outer measure, ÂµâŒŠS in 9.6 and let n â†’âˆž.
Thus
Bn â†‘A, BC
n â†“AC
and this yields Âµ(S) = (ÂµâŒŠS)(A) + (ÂµâŒŠS)(AC) = Âµ(S âˆ©A) + Âµ(S \ A).
Therefore A âˆˆS and this proves Parts 9.3, 9.4, and 9.5. It remains to prove the
last assertion about the measure being complete.
Let F âˆˆS and let Âµ(E \ F) + Âµ(F \ E) = 0. Consider the following picture.
E
F
S
Then referring to this picture and using F âˆˆS,
Âµ(S)
â‰¤
Âµ(S âˆ©E) + Âµ(S \ E)
â‰¤
Âµ (S âˆ©E âˆ©F) + Âµ ((S âˆ©E) \ F) + Âµ (S \ F) + Âµ (F \ E)
â‰¤
Âµ (S âˆ©F) + Âµ (E \ F) + Âµ (S \ F) + Âµ (F \ E)
=
Âµ (S âˆ©F) + Âµ (S \ F) = Âµ (S)
Hence Âµ(S) = Âµ(S âˆ©E)+Âµ(S \E) and so E âˆˆS. This shows that (S, Âµ) is complete
and proves the theorem.
Completeness usually occurs in the following form. E âŠ†F âˆˆS and Âµ (F) = 0.
Then E âˆˆS.
Where do outer measures come from? One way to obtain an outer measure is
to start with a measure Âµ, deï¬ned on a Ïƒ algebra of sets, S, and use the following
deï¬nition of the outer measure induced by the measure.
Deï¬nition 9.5 Let Âµ be a measure deï¬ned on a Ïƒ algebra of sets, S âŠ†P (â„¦). Then
the outer measure induced by Âµ, denoted by Âµ is deï¬ned on P (â„¦) as
Âµ(E) = inf{Âµ(F) : F âˆˆS and F âŠ‡E}.
A measure space, (S, â„¦, Âµ) is Ïƒ ï¬nite if there exist measurable sets, â„¦i with Âµ (â„¦i) <
âˆžand â„¦= âˆªâˆž
i=1â„¦i.
You should prove the following lemma.
Lemma 9.6 If (S, â„¦, Âµ) is Ïƒ ï¬nite then there exist disjoint measurable sets, {Bn}
such that Âµ (Bn) < âˆžand âˆªâˆž
n=1Bn = â„¦.
The following lemma deals with the outer measure generated by a measure
which is Ïƒ ï¬nite. It says that if the given measure is Ïƒ ï¬nite and complete then no
new measurable sets are gained by going to the induced outer measure and then
considering the measurable sets in the sense of Caratheodory.

214
THE CONSTRUCTION OF MEASURES
Lemma 9.7
Let (â„¦, S, Âµ) be any measure space and let Âµ : P(â„¦) â†’[0, âˆž] be the
outer measure induced by Âµ. Then Âµ is an outer measure as claimed and if S is the
set of Âµ measurable sets in the sense of Caratheodory, then S âŠ‡S and Âµ = Âµ on S.
Furthermore, if Âµ is Ïƒ ï¬nite and (â„¦, S, Âµ) is complete, then S = S.
Proof: It is easy to see that Âµ is an outer measure. Let E âˆˆS. The plan is to
show E âˆˆS and Âµ(E) = Âµ(E). To show this, let S âŠ†â„¦and then show
Âµ(S) â‰¥Âµ(S âˆ©E) + Âµ(S \ E).
(9.7)
This will verify that E âˆˆS. If Âµ(S) = âˆž, there is nothing to prove, so assume
Âµ(S) < âˆž. Thus there exists T âˆˆS, T âŠ‡S, and
Âµ(S)
>
Âµ(T) âˆ’Îµ = Âµ(T âˆ©E) + Âµ(T \ E) âˆ’Îµ
â‰¥
Âµ(T âˆ©E) + Âµ(T \ E) âˆ’Îµ
â‰¥
Âµ(S âˆ©E) + Âµ(S \ E) âˆ’Îµ.
Since Îµ is arbitrary, this proves 9.7 and veriï¬es S âŠ†S. Now if E âˆˆS and V âŠ‡E
with V âˆˆS, Âµ(E) â‰¤Âµ(V ). Hence, taking inf, Âµ(E) â‰¤Âµ(E). But also Âµ(E) â‰¥Âµ(E)
since E âˆˆS and E âŠ‡E. Hence
Âµ(E) â‰¤Âµ(E) â‰¤Âµ(E).
Next consider the claim about not getting any new sets from the outer measure
in the case the measure space is Ïƒ ï¬nite and complete.
Claim 1: If E, D âˆˆS, and Âµ(E \ D) = 0, then if D âŠ†F âŠ†E, it follows F âˆˆS.
Proof of claim 1:
F \ D âŠ†E \ D âˆˆS,
and E\D is a set of measure zero. Therefore, since (â„¦, S, Âµ)
is complete, F \D âˆˆS
and so
F = D âˆª(F \ D) âˆˆS.
Claim 2: Suppose F âˆˆS and Âµ (F) < âˆž. Then F âˆˆS.
Proof of the claim 2: From the deï¬nition of Âµ, it follows there exists E âˆˆS
such that E âŠ‡F and Âµ (E) = Âµ (F) . Therefore,
Âµ (E) = Âµ (E \ F) + Âµ (F)
so
Âµ (E \ F) = 0.
(9.8)
Similarly, there exists D1 âˆˆS such that
D1 âŠ†E, D1 âŠ‡(E \ F) , Âµ (D1) = Âµ (E \ F) .
and
Âµ (D1 \ (E \ F)) = 0.
(9.9)

9.2.
REGULAR MEASURES
215
E
F
D1
D
Now let D = E \ D1. It follows D âŠ†F because if x âˆˆD, then x âˆˆE but
x /âˆˆ(E \ F) and so x âˆˆF. Also F \ D = D1 \ (E \ F) because both sides equal
D1 âˆ©F \ E.
Then from 9.8 and 9.9,
Âµ (E \ D)
â‰¤
Âµ (E \ F) + Âµ (F \ D)
=
Âµ (E \ F) + Âµ (D1 \ (E \ F)) = 0.
By Claim 1, it follows F âˆˆS. This proves Claim 2.
Now since (â„¦, S,Âµ) is Ïƒ ï¬nite, there are sets of S, {Bn}âˆž
n=1 such that Âµ (Bn) <
âˆž, âˆªnBn = â„¦. Then F âˆ©Bn âˆˆS by Claim 2. Therefore, F = âˆªâˆž
n=1F âˆ©Bn âˆˆS and
so S =S. This proves the lemma.
9.2
Regular Measures
Usually â„¦is not just a set. It is also a topological space. It is very important to
consider how the measure is related to this topology.
Deï¬nition 9.8 Let Âµ be a measure on a Ïƒ algebra S, of subsets of â„¦, where (â„¦, Ï„)
is a topological space. Âµ is a Borel measure if S contains all Borel sets. Âµ is called
outer regular if Âµ is Borel and for all E âˆˆS,
Âµ(E) = inf{Âµ(V ) : V is open and V âŠ‡E}.
Âµ is called inner regular if Âµ is Borel and
Âµ(E) = sup{Âµ(K) : K âŠ†E, and K is compact}.
If the measure is both outer and inner regular, it is called regular.
It will be assumed in what follows that (â„¦, Ï„) is a locally compact Hausdorï¬€
space. This means it is Hausdorï¬€: If p, q âˆˆâ„¦such that p Ì¸= q, there exist open

216
THE CONSTRUCTION OF MEASURES
sets, Up and Uq containing p and q respectively such that Up âˆ©Uq = âˆ…and Locally
compact: There exists a basis of open sets for the topology, B such that for each
U âˆˆB, U is compact. Recall B is a basis for the topology if âˆªB = â„¦and if every
open set in Ï„ is the union of sets of B.
Also recall a Hausdorï¬€space is normal if
whenever H and C are two closed sets, there exist disjoint open sets, UH and UC
containing H and C respectively. A regular space is one which has the property
that if p is a point not in H, a closed set, then there exist disjoint open sets, Up and
UH containing p and H respectively.
9.3
Urysohnâ€™s lemma
Urysohnâ€™s lemma which characterizes normal spaces is a very important result which
is useful in general topology and in the construction of measures. Because it is
somewhat technical a proof is given for the part which is needed.
Theorem 9.9 (Urysohn) Let (X, Ï„) be normal and let H âŠ†U where H is closed
and U is open. Then there exists g : X â†’[0, 1] such that g is continuous, g (x) = 1
on H and g (x) = 0 if x /âˆˆU.
Proof: Let D â‰¡{rn}âˆž
n=1 be the rational numbers in (0, 1). Choose Vr1 an open
set such that
H âŠ†Vr1 âŠ†V r1 âŠ†U.
This can be done by applying the assumption that X is normal to the disjoint closed
sets, H and U C, to obtain open sets V and W with
H âŠ†V, U C âŠ†W, and V âˆ©W = âˆ….
Then
H âŠ†V âŠ†V , V âˆ©U C = âˆ…
and so let Vr1 = V .
Suppose Vr1, Â· Â· Â·, Vrk have been chosen and list the rational numbers r1, Â· Â· Â·, rk
in order,
rl1 < rl2 < Â· Â· Â· < rlk for {l1, Â· Â· Â·, lk} = {1, Â· Â· Â·, k}.
If rk+1 > rlk then letting p = rlk, let Vrk+1 satisfy
V p âŠ†Vrk+1 âŠ†V rk+1 âŠ†U.
If rk+1 âˆˆ(rli, rli+1), let p = rli and let q = rli+1. Then let Vrk+1 satisfy
V p âŠ†Vrk+1 âŠ†V rk+1 âŠ†Vq.
If rk+1 < rl1, let p = rl1 and let Vrk+1 satisfy
H âŠ†Vrk+1 âŠ†V rk+1 âŠ†Vp.

9.3.
URYSOHNâ€™S LEMMA
217
Thus there exist open sets Vr for each r âˆˆQ âˆ©(0, 1) with the property that if
r < s,
H âŠ†Vr âŠ†V r âŠ†Vs âŠ†V s âŠ†U.
Now let
f (x) = inf{t âˆˆD : x âˆˆVt}, f (x) â‰¡1 if x /âˆˆ
[
tâˆˆD
Vt.
I claim f is continuous.
f âˆ’1 ([0, a)) = âˆª{Vt : t < a, t âˆˆD},
an open set.
Next consider x âˆˆf âˆ’1 ([0, a]) so f (x) â‰¤a. If t > a, then x âˆˆVt because if not,
then
inf{t âˆˆD : x âˆˆVt} > a.
Thus
f âˆ’1 ([0, a]) = âˆ©{Vt : t > a} = âˆ©{V t : t > a}
which is a closed set. If a = 1, f âˆ’1 ([0, 1]) = f âˆ’1 ([0, a]) = X. Therefore,
f âˆ’1 ((a, 1]) = X \ f âˆ’1 ([0, a]) = open set.
It follows f is continuous. Clearly f (x) = 0 on H. If x âˆˆU C, then x /âˆˆVt for any
t âˆˆD so f (x) = 1 on U C. Let g (x) = 1 âˆ’f (x). This proves the theorem.
In any metric space there is a much easier proof of the conclusion of Urysohnâ€™s
lemma which applies.
Lemma 9.10 Let S be a nonempty subset of a metric space, (X, d) . Deï¬ne
f (x) â‰¡dist (x, S) â‰¡inf {d (x, y) : y âˆˆS} .
Then f is continuous.
Proof:
Consider |f (x) âˆ’f (x1)|and suppose without loss of generality that
f (x1) â‰¥f (x) . Then choose y âˆˆS such that f (x) + Îµ > d (x, y) . Then
|f (x1) âˆ’f (x)|
=
f (x1) âˆ’f (x) â‰¤f (x1) âˆ’d (x, y) + Îµ
â‰¤
d (x1, y) âˆ’d (x, y) + Îµ
â‰¤
d (x, x1) + d (x, y) âˆ’d (x, y) + Îµ
=
d (x1, x) + Îµ.
Since Îµ is arbitrary, it follows that |f (x1) âˆ’f (x)| â‰¤d (x1, x) and this proves the
lemma.
Theorem 9.11 (Urysohnâ€™s lemma for metric space) Let H be a closed subset of
an open set, U in a metric space, (X, d) . Then there exists a continuous function,
g : X â†’[0, 1] such that g (x) = 1 for all x âˆˆH and g (x) = 0 for all x /âˆˆU.

218
THE CONSTRUCTION OF MEASURES
Proof: If x /âˆˆC, a closed set, then dist (x, C) > 0 because if not, there would
exist a sequence of points of C converging to x and it would follow that x âˆˆC.
Therefore, dist (x, H) + dist
Â¡
x, U CÂ¢
> 0 for all x âˆˆX. Now deï¬ne a continuous
function, g as
g (x) â‰¡
dist
Â¡
x, U CÂ¢
dist (x, H) + dist (x, U C).
It is easy to see this veriï¬es the conclusions of the theorem and this proves the
theorem.
Theorem 9.12 Every compact Hausdorï¬€space is normal.
Proof: First it is shown that X, is regular. Let H be a closed set and let p /âˆˆH.
Then for each h âˆˆH, there exists an open set Uh containing p and an open set Vh
containing h such that Uh âˆ©Vh = âˆ…. Since H must be compact, it follows there
are ï¬nitely many of the sets Vh, Vh1 Â· Â· Â· Vhn such that H âŠ†âˆªn
i=1Vhi. Then letting
U = âˆ©n
i=1Uhi and V = âˆªn
i=1Vhi, it follows that p âˆˆU, H âˆˆV and U âˆ©V = âˆ…. Thus
X is regular as claimed.
Next let K and H be disjoint nonempty closed sets.Using regularity of X, for
every k âˆˆK, there exists an open set Uk containing k and an open set Vk containing
H such that these two open sets have empty intersection. Thus Hâˆ©U k = âˆ…. Finitely
many of the Uk, Uk1, Â·Â·Â·, Ukp cover K and so âˆªp
i=1U ki is a closed set which has empty
intersection with H. Therefore, K âŠ†âˆªp
i=1Uki and H âŠ†
Â¡
âˆªp
i=1U ki
Â¢C. This proves
the theorem.
A useful construction when dealing with locally compact Hausdorï¬€spaces is the
notion of the one point compactiï¬cation of the space discussed earler. However, it
is reviewed here for the sake of convenience or in case you have not read the earlier
treatment.
Deï¬nition 9.13 Suppose (X, Ï„) is a locally compact Hausdorï¬€space.
Then let
e
X â‰¡X âˆª{âˆž} where âˆžis just the name of some point which is not in X which is
called the point at inï¬nity. A basis for the topology eÏ„ for e
X is
Ï„ âˆª
Â©
KC where K is a compact subset of X
Âª
.
The complement is taken with respect to e
X and so the open sets, KC are basic open
sets which contain âˆž.
The reason this is called a compactiï¬cation is contained in the next lemma.
Lemma 9.14 If (X, Ï„) is a locally compact Hausdorï¬€space, then
Â³
e
X, eÏ„
Â´
is a com-
pact Hausdorï¬€space.
Proof: Since (X, Ï„) is a locally compact Hausdorï¬€space, it follows
Â³
e
X, eÏ„
Â´
is
a Hausdorï¬€topological space. The only case which needs checking is the one of
p âˆˆX and âˆž. Since (X, Ï„) is locally compact, there exists an open set of Ï„, U

9.3.
URYSOHNâ€™S LEMMA
219
having compact closure which contains p. Then p âˆˆU and âˆžâˆˆU
C and these are
disjoint open sets containing the points, p and âˆžrespectively. Now let C be an
open cover of e
X with sets from eÏ„. Then âˆžmust be in some set, Uâˆžfrom C, which
must contain a set of the form KC where K is a compact subset of X. Then there
exist sets from C, U1, Â· Â· Â·, Ur which cover K. Therefore, a ï¬nite subcover of e
X is
U1, Â· Â· Â·, Ur, Uâˆž.
Theorem 9.15 Let X be a locally compact Hausdorï¬€space, and let K be a compact
subset of the open set V . Then there exists a continuous function, f : X â†’[0, 1],
such that f equals 1 on K and {x : f (x) Ì¸= 0} â‰¡spt (f) is a compact subset of V .
Proof: Let e
X be the space just described. Then K and V are respectively
closed and open in eÏ„. By Theorem 9.12 there exist open sets in eÏ„, U, and W such
that K âŠ†U, âˆžâˆˆV C âŠ†W, and U âˆ©W = U âˆ©(W \ {âˆž}) = âˆ…. Thus W \ {âˆž} is
an open set in the original topological space which contains V C, U is an open set in
the original topological space which contains K, and W \ {âˆž} and U are disjoint.
Now for each x âˆˆK, let Ux be a basic open set whose closure is compact and
such that
x âˆˆUx âŠ†U.
Thus Ux must have empty intersection with V C because the open set, W \ {âˆž}
contains no points of Ux. Since K is compact, there are ï¬nitely many of these sets,
Ux1, Ux2, Â· Â· Â·, Uxn which cover K. Now let H â‰¡âˆªn
i=1Uxi.
Claim: H = âˆªn
i=1Uxi
Proof of claim: Suppose p âˆˆH. If p /âˆˆâˆªn
i=1Uxi then if follows p /âˆˆUxi
for
each i. Therefore, there exists an open set, Ri containing p such that Ri contains
no other points of Uxi. Therefore, R â‰¡âˆ©n
i=1Ri is an open set containing p which
contains no other points of âˆªn
i=1Uxi = W, a contradiction. Therefore, H âŠ†âˆªn
i=1Uxi.
On the other hand, if p âˆˆUxi then p is obviously in H so this proves the claim.
From the claim, K âŠ†H âŠ†H âŠ†V and H is compact because it is the ï¬nite
union of compact sets. Repeating the same argument, there exists an open set, I
such that H âŠ†I âŠ†I âŠ†V with I compact. Now
Â¡
I, Ï„ I
Â¢
is a compact topological
space where Ï„ I is the topology which is obtained by taking intersections of open
sets in X with I. Therefore, by Urysohnâ€™s lemma, there exists f : I â†’[0, 1] such
that f is continuous at every point of I and also f (K) = 1 while f
Â¡
I \ H
Â¢
= 0.
Extending f to equal 0 on I
C, it follows that f is continuous on X, has values in
[0, 1] , and satisï¬es f (K) = 1 and spt (f) is a compact subset contained in I âŠ†V.
This proves the theorem.
In fact, the conclusion of the above theorem could be used to prove that the
topological space is locally compact. However, this is not needed here.
Deï¬nition 9.16 Deï¬ne spt(f) (support of f) to be the closure of the set {x :
f(x) Ì¸= 0}. If V is an open set, Cc(V ) will be the set of continuous functions f,
deï¬ned on â„¦having spt(f) âŠ†V . Thus in Theorem 9.15, f âˆˆCc(V ).

220
THE CONSTRUCTION OF MEASURES
Deï¬nition 9.17 If K is a compact subset of an open set, V , then K â‰ºÏ† â‰ºV if
Ï† âˆˆCc(V ), Ï†(K) = {1}, Ï†(â„¦) âŠ†[0, 1],
where â„¦denotes the whole topological space considered. Also for Ï† âˆˆCc(â„¦), K â‰ºÏ†
if
Ï†(â„¦) âŠ†[0, 1] and Ï†(K) = 1.
and Ï† â‰ºV if
Ï†(â„¦) âŠ†[0, 1] and spt(Ï†) âŠ†V.
Theorem 9.18 (Partition of unity) Let K be a compact subset of a locally compact
Hausdorï¬€topological space satisfying Theorem 9.15 and suppose
K âŠ†V = âˆªn
i=1Vi, Vi open.
Then there exist Ïˆi â‰ºVi with
n
X
i=1
Ïˆi(x) = 1
for all x âˆˆK.
Proof: Let K1 = K \ âˆªn
i=2Vi. Thus K1 is compact and K1 âŠ†V1. Let K1 âŠ†
W1 âŠ†W 1 âŠ†V1 with W 1compact. To obtain W1, use Theorem 9.15 to get f such
that K1 â‰ºf â‰ºV1 and let W1 â‰¡{x : f (x) Ì¸= 0} . Thus W1, V2, Â· Â· Â·Vn covers K and
W 1 âŠ†V1. Let K2 = K \ (âˆªn
i=3Vi âˆªW1). Then K2 is compact and K2 âŠ†V2. Let
K2 âŠ†W2 âŠ†W 2 âŠ†V2 W 2 compact. Continue this way ï¬nally obtaining W1, Â·Â·Â·, Wn,
K âŠ†W1 âˆªÂ· Â· Â· âˆªWn, and W i âŠ†Vi W i compact. Now let W i âŠ†Ui âŠ†U i âŠ†Vi , U i
compact.
Wi
Ui Vi
By Theorem 9.15, let U i â‰ºÏ†i â‰ºVi, âˆªn
i=1W i â‰ºÎ³ â‰ºâˆªn
i=1Ui. Deï¬ne
Ïˆi(x) =
Â½ Î³(x)Ï†i(x)/ Pn
j=1 Ï†j(x) if Pn
j=1 Ï†j(x) Ì¸= 0,
0 if Pn
j=1 Ï†j(x) = 0.
If x is such that Pn
j=1 Ï†j(x) = 0, then x /âˆˆâˆªn
i=1U i. Consequently Î³(y) = 0 for
all y near x and so Ïˆi(y) = 0 for all y near x. Hence Ïˆi is continuous at such x.
If Pn
j=1 Ï†j(x) Ì¸= 0, this situation persists near x and so Ïˆi is continuous at such
points. Therefore Ïˆi is continuous. If x âˆˆK, then Î³(x) = 1 and so Pn
j=1 Ïˆj(x) = 1.
Clearly 0 â‰¤Ïˆi (x) â‰¤1 and spt(Ïˆj) âŠ†Vj. This proves the theorem.
The following corollary wonâ€™t be needed immediately but is of considerable in-
terest later.

9.4.
POSITIVE LINEAR FUNCTIONALS
221
Corollary 9.19 If H is a compact subset of Vi, there exists a partition of unity
such that Ïˆi (x) = 1 for all x âˆˆH in addition to the conclusion of Theorem 9.18.
Proof: Keep Vi the same but replace Vj with f
Vj â‰¡Vj \ H. Now in the proof
above, applied to this modiï¬ed collection of open sets, if j Ì¸= i, Ï†j (x) = 0 whenever
x âˆˆH. Therefore, Ïˆi (x) = 1 on H.
9.4
Positive Linear Functionals
Deï¬nition 9.20 Let (â„¦, Ï„) be a topological space.
L : Cc(â„¦) â†’C is called a
positive linear functional if L is linear,
L(af1 + bf2) = aLf1 + bLf2,
and if Lf â‰¥0 whenever f â‰¥0.
Theorem 9.21 (Riesz representation theorem) Let (â„¦, Ï„) be a locally compact Haus-
dorï¬€space and let L be a positive linear functional on Cc(â„¦). Then there exists a
Ïƒ algebra S containing the Borel sets and a unique measure Âµ, deï¬ned on S, such
that
Âµ is complete,
(9.10)
Âµ(K)
<
âˆžfor all K compact,
(9.11)
Âµ(F) = sup{Âµ(K) : K âŠ†F, K compact},
for all F open and for all F âˆˆS with Âµ(F) < âˆž,
Âµ(F) = inf{Âµ(V ) : V âŠ‡F, V open}
for all F âˆˆS, and
Z
fdÂµ = Lf
for all f âˆˆCc(â„¦).
(9.12)
The plan is to deï¬ne an outer measure and then to show that it, together with the
Ïƒ algebra of sets measurable in the sense of Caratheodory, satisï¬es the conclusions
of the theorem. Always, K will be a compact set and V will be an open set.
Deï¬nition 9.22 Âµ(V ) â‰¡sup{Lf : f â‰ºV } for V open, Âµ(âˆ…) = 0. Âµ(E) â‰¡
inf{Âµ(V ) : V âŠ‡E} for arbitrary sets E.
Lemma 9.23 Âµ is a well-deï¬ned outer measure.
Proof: First it is necessary to verify Âµ is well deï¬ned because there are two
descriptions of it on open sets. Suppose then that Âµ1 (V ) â‰¡inf{Âµ(U) : U âŠ‡V
and U is open}. It is required to verify that Âµ1 (V ) = Âµ (V ) where Âµ is given as
sup{Lf : f â‰ºV }. If U âŠ‡V, then Âµ (U) â‰¥Âµ (V ) directly from the deï¬nition. Hence

222
THE CONSTRUCTION OF MEASURES
from the deï¬nition of Âµ1, it follows Âµ1 (V ) â‰¥Âµ (V ) . On the other hand, V âŠ‡V and
so Âµ1 (V ) â‰¤Âµ (V ) . This veriï¬es Âµ is well deï¬ned.
It remains to show that Âµ is an outer measure. Let V = âˆªâˆž
i=1Vi and let f â‰ºV .
Then spt(f) âŠ†âˆªn
i=1Vi for some n. Let Ïˆi â‰ºVi, Pn
i=1 Ïˆi = 1 on spt(f).
Lf =
n
X
i=1
L(fÏˆi) â‰¤
n
X
i=1
Âµ(Vi) â‰¤
âˆž
X
i=1
Âµ(Vi).
Hence
Âµ(V ) â‰¤
âˆž
X
i=1
Âµ(Vi)
since f â‰ºV is arbitrary. Now let E = âˆªâˆž
i=1Ei. Is Âµ(E) â‰¤Pâˆž
i=1 Âµ(Ei)? Without
loss of generality, it can be assumed Âµ(Ei) < âˆžfor each i since if not so, there is
nothing to prove. Let Vi âŠ‡Ei with Âµ(Ei) + Îµ2âˆ’i > Âµ(Vi).
Âµ(E) â‰¤Âµ(âˆªâˆž
i=1Vi) â‰¤
âˆž
X
i=1
Âµ(Vi) â‰¤Îµ +
âˆž
X
i=1
Âµ(Ei).
Since Îµ was arbitrary, Âµ(E) â‰¤Pâˆž
i=1 Âµ(Ei) which proves the lemma.
Lemma 9.24 Let K be compact, g â‰¥0, g âˆˆCc(â„¦), and g = 1 on K.
Then
Âµ(K) â‰¤Lg. Also Âµ(K) < âˆžwhenever K is compact.
Proof: Let Î± âˆˆ(0, 1) and VÎ± = {x : g(x) > Î±} so VÎ± âŠ‡K and let h â‰ºVÎ±.
g > Î±
VÎ±
K
Then h â‰¤1 on VÎ± while gÎ±âˆ’1 â‰¥1 on VÎ± and so gÎ±âˆ’1 â‰¥h which implies
L(gÎ±âˆ’1) â‰¥Lh and that therefore, since L is linear,
Lg â‰¥Î±Lh.
Since h â‰ºVÎ± is arbitrary, and K âŠ†VÎ±,
Lg â‰¥Î±Âµ (VÎ±) â‰¥Î±Âµ (K) .
Letting Î± â†‘1 yields Lg â‰¥Âµ(K). This proves the ï¬rst part of the lemma. The
second assertion follows from this and Theorem 9.15. If K is given, let
K â‰ºg â‰ºâ„¦
and so from what was just shown, Âµ (K) â‰¤Lg < âˆž. This proves the lemma.

9.4.
POSITIVE LINEAR FUNCTIONALS
223
Lemma 9.25 If A and B are disjoint compact subsets of â„¦, then Âµ(A âˆªB) =
Âµ(A) + Âµ(B).
Proof: By Theorem 9.15, there exists h âˆˆCc (â„¦) such that A â‰ºh â‰ºBC. Let
U1 = hâˆ’1(( 1
2, 1]), V1 = hâˆ’1([0, 1
2)). Then A âŠ†U1, B âŠ†V1 and U1 âˆ©V1 = âˆ….
B
V1
A
U1
From Lemma 9.24 Âµ(A âˆªB) < âˆžand so there exists an open set, W such that
W âŠ‡A âˆªB, Âµ (A âˆªB) + Îµ > Âµ (W) .
Now let U = U1 âˆ©W and V = V1 âˆ©W. Then
U âŠ‡A, V âŠ‡B, U âˆ©V = âˆ…, and Âµ(A âˆªB) + Îµ â‰¥Âµ (W) â‰¥Âµ(U âˆªV ).
Let A â‰ºf â‰ºU, B â‰ºg â‰ºV . Then by Lemma 9.24,
Âµ(A âˆªB) + Îµ â‰¥Âµ(U âˆªV ) â‰¥L(f + g) = Lf + Lg â‰¥Âµ(A) + Âµ(B).
Since Îµ > 0 is arbitrary, this proves the lemma.
From Lemma 9.24 the following lemma is obtained.
Lemma 9.26 Let f âˆˆCc(â„¦), f(â„¦) âŠ†[0, 1]. Then Âµ(spt(f)) â‰¥Lf. Also, every
open set, V satisï¬es
Âµ (V ) = sup {Âµ (K) : K âŠ†V } .
Proof: Let V âŠ‡spt(f) and let spt(f) â‰ºg â‰ºV . Then Lf â‰¤Lg â‰¤Âµ(V ) because
f â‰¤g. Since this holds for all V âŠ‡spt(f), Lf â‰¤Âµ(spt(f)) by deï¬nition of Âµ.
V
spt(f)
Finally, let V be open and let l < Âµ (V ) . Then from the deï¬nition of Âµ, there
exists f â‰ºV such that L (f) > l. Therefore, l < Âµ (spt (f)) â‰¤Âµ (V ) and so this
shows the claim about inner regularity of the measure on an open set.
Lemma 9.27 If K is compact there exists V open, V âŠ‡K, such that Âµ(V \ K) â‰¤
Îµ. If V is open with Âµ(V ) < âˆž, then there exists a compact set, K âŠ†V with
Âµ(V \ K) â‰¤Îµ.

224
THE CONSTRUCTION OF MEASURES
Proof: Let K be compact. Then from the deï¬nition of Âµ, there exists an open
set U, with Âµ(U) < âˆžand U âŠ‡K. Suppose for every open set, V , containing
K, Âµ(V \ K) > Îµ.
Then there exists f â‰ºU \ K with Lf > Îµ.
Consequently,
Âµ((f)) > Lf > Îµ. Let K1 = spt(f) and repeat the construction with U \ K1 in
place of U.
U
K1
K
K2
K3
Continuing in this way yields a sequence of disjoint compact sets, K, K1, Â· Â· Â·
contained in U such that Âµ(Ki) > Îµ. By Lemma 9.25
Âµ(U) â‰¥Âµ(K âˆªâˆªr
i=1Ki) = Âµ(K) +
r
X
i=1
Âµ(Ki) â‰¥rÎµ
for all r, contradicting Âµ(U) < âˆž. This demonstrates the ï¬rst part of the lemma.
To show the second part, employ a similar construction. Suppose Âµ(V \ K) > Îµ
for all K âŠ†V . Then Âµ(V ) > Îµ so there exists f â‰ºV with Lf > Îµ. Let K1 = spt(f)
so Âµ(spt(f)) > Îµ. If K1 Â· Â· Â· Kn, disjoint, compact subsets of V have been chosen,
there must exist g â‰º(V \ âˆªn
i=1Ki) be such that Lg > Îµ. Hence Âµ(spt(g)) > Îµ. Let
Kn+1 = spt(g). In this way there exists a sequence of disjoint compact subsets of
V , {Ki} with Âµ(Ki) > Îµ. Thus for any m, K1 Â· Â· Â· Km are all contained in V and
are disjoint and compact. By Lemma 9.25
Âµ(V ) â‰¥Âµ(âˆªm
i=1Ki) =
m
X
i=1
Âµ(Ki) > mÎµ
for all m, a contradiction to Âµ(V ) < âˆž. This proves the second part.
Lemma 9.28 Let S be the Ïƒ algebra of Âµ measurable sets in the sense of Carath-
eodory. Then S âŠ‡Borel sets and Âµ is inner regular on every open set and for every
E âˆˆS with Âµ(E) < âˆž.
Proof: Deï¬ne
S1 = {E âŠ†â„¦: E âˆ©K âˆˆS}
for all compact K.

9.4.
POSITIVE LINEAR FUNCTIONALS
225
Let C be a compact set. The idea is to show that C âˆˆS. From this it will follow
that the closed sets are in S1 because if C is only closed, C âˆ©K is compact. Hence
C âˆ©K = (C âˆ©K) âˆ©K âˆˆS. The steps are to ï¬rst show the compact sets are in
S and this implies the closed sets are in S1. Then you show S1 is a Ïƒ algebra and
so it contains the Borel sets. Finally, it is shown that S1 = S and then the inner
regularity conclusion is established.
Let V be an open set with Âµ (V ) < âˆž. I will show that
Âµ (V ) â‰¥Âµ(V \ C) + Âµ(V âˆ©C).
By Lemma 9.27, there exists an open set U containing C and a compact subset of
V , K, such that Âµ(V \ K) < Îµ and Âµ (U \ C) < Îµ.
U
C
V
K
Then by Lemma 9.25,
Âµ(V )
â‰¥
Âµ(K) â‰¥Âµ((K \ U) âˆª(K âˆ©C))
=
Âµ(K \ U) + Âµ(K âˆ©C)
â‰¥
Âµ(V \ C) + Âµ(V âˆ©C) âˆ’3Îµ
Since Îµ is arbitrary,
Âµ(V ) = Âµ(V \ C) + Âµ(V âˆ©C)
(9.13)
whenever C is compact and V is open. (If Âµ (V ) = âˆž, it is obvious that Âµ (V ) â‰¥
Âµ(V \ C) + Âµ(V âˆ©C) and it is always the case that Âµ (V ) â‰¤Âµ (V \ C) + Âµ (V âˆ©C) .)
Of course 9.13 is exactly what needs to be shown for arbitrary S in place of V .
It suï¬ƒces to consider only S having Âµ (S) < âˆž. If S âŠ†â„¦, with Âµ(S) < âˆž, let
V âŠ‡S, Âµ(S) + Îµ > Âµ(V ). Then from what was just shown, if C is compact,
Îµ + Âµ(S)
>
Âµ(V ) = Âµ(V \ C) + Âµ(V âˆ©C)
â‰¥
Âµ(S \ C) + Âµ(S âˆ©C).
Since Îµ is arbitrary, this shows the compact sets are in S. As discussed above, this
veriï¬es the closed sets are in S1.
Therefore, S1 contains the closed sets and S contains the compact sets. There-
fore, if E âˆˆS and K is a compact set, it follows K âˆ©E âˆˆS and so S1 âŠ‡S.
To see that S1 is closed with respect to taking complements, let E âˆˆS1.
K = (EC âˆ©K) âˆª(E âˆ©K).

226
THE CONSTRUCTION OF MEASURES
Then from the fact, just established, that the compact sets are in S,
EC âˆ©K = K \ (E âˆ©K) âˆˆS.
Similarly S1 is closed under countable unions. Thus S1 is a Ïƒ algebra which contains
the Borel sets since it contains the closed sets.
The next task is to show S1 = S. Let E âˆˆS1 and let V be an open set with
Âµ(V ) < âˆžand choose K âŠ†V such that Âµ(V \ K) < Îµ. Then since E âˆˆS1, it
follows E âˆ©K âˆˆS and
Âµ(V )
=
Âµ(V \ (K âˆ©E)) + Âµ(V âˆ©(K âˆ©E))
â‰¥
Âµ(V \ E) + Âµ(V âˆ©E) âˆ’Îµ
because
Âµ (V âˆ©(K âˆ©E)) +
<Îµ
z
}|
{
Âµ (V \ K) â‰¥Âµ (V âˆ©E)
Since Îµ is arbitrary,
Âµ(V ) = Âµ(V \ E) + Âµ(V âˆ©E).
Now let S âŠ†â„¦. If Âµ(S) = âˆž, then Âµ(S) = Âµ(S âˆ©E) + Âµ(S \ E). If Âµ(S) < âˆž, let
V âŠ‡S, Âµ(S) + Îµ â‰¥Âµ(V ).
Then
Âµ(S) + Îµ â‰¥Âµ(V ) = Âµ(V \ E) + Âµ(V âˆ©E) â‰¥Âµ(S \ E) + Âµ(S âˆ©E).
Since Îµ is arbitrary, this shows that E âˆˆS and so S1 = S. Thus S âŠ‡Borel sets as
claimed.
From Lemma 9.26 and the deï¬nition of Âµ it follows Âµ is inner regular on all
open sets. It remains to show that Âµ(F) = sup{Âµ(K) : K âŠ†F} for all F âˆˆS with
Âµ(F) < âˆž. It might help to refer to the following crude picture to keep things
straight.
F
K
K âˆ©V C
U
V
In this picture the shaded area is V.
Let U be an open set, U âŠ‡F, Âµ(U) < âˆž. Let V be open, V âŠ‡U \ F, and
Âµ(V \ (U \ F)) < Îµ. This can be obtained because Âµ is a measure on S. Thus from
outer regularity there exists V âŠ‡U \ F such that Âµ (U \ F) + Îµ > Âµ (V ) . Then
Âµ (V \ (U \ F)) + Âµ (U \ F) = Âµ (V )

9.4.
POSITIVE LINEAR FUNCTIONALS
227
and so
Âµ (V \ (U \ F)) = Âµ (V ) âˆ’Âµ (U \ F) < Îµ.
Also,
V \ (U \ F)
=
V âˆ©
Â¡
U âˆ©F CÂ¢C
=
V âˆ©
Â£
U C âˆªF
Â¤
=
(V âˆ©F) âˆª
Â¡
V âˆ©U CÂ¢
âŠ‡
V âˆ©F
and so
Âµ(V âˆ©F) â‰¤Âµ (V \ (U \ F)) < Îµ.
Since V âŠ‡U âˆ©F C, V C âŠ†U C âˆªF so U âˆ©V C âŠ†U âˆ©F = F. Hence U âˆ©V C is a
subset of F. Now let K âŠ†U, Âµ(U \ K) < Îµ. Thus K âˆ©V C is a compact subset of
F and
Âµ(F)
=
Âµ(V âˆ©F) + Âµ(F \ V )
<
Îµ + Âµ(F \ V ) â‰¤Îµ + Âµ(U âˆ©V C) â‰¤2Îµ + Âµ(K âˆ©V C).
Since Îµ is arbitrary, this proves the second part of the lemma. Formula 9.11 of this
theorem was established earlier.
It remains to show Âµ satisï¬es 9.12.
Lemma 9.29
R
fdÂµ = Lf for all f âˆˆCc(â„¦).
Proof: Let f âˆˆCc(â„¦), f real-valued, and suppose f(â„¦) âŠ†[a, b]. Choose t0 < a
and let t0 < t1 < Â· Â· Â· < tn = b, ti âˆ’tiâˆ’1 < Îµ. Let
Ei = f âˆ’1((tiâˆ’1, ti]) âˆ©spt(f).
(9.14)
Note that âˆªn
i=1Ei is a closed set and in fact
âˆªn
i=1 Ei = spt(f)
(9.15)
since â„¦= âˆªn
i=1f âˆ’1((tiâˆ’1, ti]). Let Vi âŠ‡Ei, Vi is open and let Vi satisfy
f (x) < ti + Îµ for all x âˆˆVi,
(9.16)
Âµ(Vi \ Ei) < Îµ/n.
By Theorem 9.18 there exists hi âˆˆCc(â„¦) such that
hi â‰ºVi,
n
X
i=1
hi(x) = 1 on spt(f).
Now note that for each i,
f(x)hi(x) â‰¤hi(x)(ti + Îµ).

228
THE CONSTRUCTION OF MEASURES
(If x âˆˆVi, this follows from 9.16. If x /âˆˆVi both sides equal 0.) Therefore,
Lf
=
L(
n
X
i=1
fhi) â‰¤L(
n
X
i=1
hi(ti + Îµ))
=
n
X
i=1
(ti + Îµ)L(hi)
=
n
X
i=1
(|t0| + ti + Îµ)L(hi) âˆ’|t0|L
Ãƒ n
X
i=1
hi
!
.
Now note that |t0| + ti + Îµ â‰¥0 and so from the deï¬nition of Âµ and Lemma 9.24,
this is no larger than
n
X
i=1
(|t0| + ti + Îµ)Âµ(Vi) âˆ’|t0|Âµ(spt(f))
â‰¤
n
X
i=1
(|t0| + ti + Îµ)(Âµ(Ei) + Îµ/n) âˆ’|t0|Âµ(spt(f))
â‰¤|t0|
n
X
i=1
Âµ(Ei) + |t0|Îµ +
n
X
i=1
tiÂµ(Ei) + Îµ(|t0| + |b|)
+Îµ
n
X
i=1
Âµ(Ei) + Îµ2 âˆ’|t0|Âµ(spt(f)).
From 9.15 and 9.14, the ï¬rst and last terms cancel. Therefore this is no larger than
(2|t0| + |b| + Âµ(spt(f)) + Îµ)Îµ +
n
X
i=1
tiâˆ’1Âµ(Ei) + ÎµÂµ(spt(f))
â‰¤
Z
fdÂµ + (2|t0| + |b| + 2Âµ(spt(f)) + Îµ)Îµ.
Since Îµ > 0 is arbitrary,
Lf â‰¤
Z
fdÂµ
(9.17)
for all f âˆˆCc(â„¦), f real. Hence equality holds in 9.17 because L(âˆ’f) â‰¤âˆ’
R
fdÂµ
so L(f) â‰¥
R
fdÂµ. Thus Lf =
R
fdÂµ for all f âˆˆCc(â„¦). Just apply the result for
real functions to the real and imaginary parts of f. This proves the Lemma.
This gives the existence part of the Riesz representation theorem.
It only remains to prove uniqueness. Suppose both Âµ1 and Âµ2 are measures on
S satisfying the conclusions of the theorem. Then if K is compact and V âŠ‡K, let
K â‰ºf â‰ºV . Then
Âµ1(K) â‰¤
Z
fdÂµ1 = Lf =
Z
fdÂµ2 â‰¤Âµ2(V ).

9.4.
POSITIVE LINEAR FUNCTIONALS
229
Thus Âµ1(K) â‰¤Âµ2(K) for all K. Similarly, the inequality can be reversed and so it
follows the two measures are equal on compact sets. By the assumption of inner
regularity on open sets, the two measures are also equal on all open sets. By outer
regularity, they are equal on all sets of S. This proves the theorem.
An important example of a locally compact Hausdorï¬€space is any metric space
in which the closures of balls are compact. For example, Rn with the usual metric
is an example of this. Not surprisingly, more can be said in this important special
case.
Theorem 9.30 Let (â„¦, Ï„) be a metric space in which the closures of the balls are
compact and let L be a positive linear functional deï¬ned on Cc (â„¦) . Then there
exists a measure representing the positive linear functional which satisï¬es all the
conclusions of Theorem 9.15 and in addition the property that Âµ is regular. The
same conclusion follows if (â„¦, Ï„) is a compact Hausdorï¬€space.
Theorem 9.31 Let (â„¦, Ï„) be a metric space in which the closures of the balls are
compact and let L be a positive linear functional deï¬ned on Cc (â„¦) . Then there
exists a measure representing the positive linear functional which satisï¬es all the
conclusions of Theorem 9.15 and in addition the property that Âµ is regular. The
same conclusion follows if (â„¦, Ï„) is a compact Hausdorï¬€space.
Proof: Let Âµ and S be as described in Theorem 9.21. The outer regularity
comes automatically as a conclusion of Theorem 9.21. It remains to verify inner
regularity. Let F âˆˆS and let l < k < Âµ (F) . Now let z âˆˆâ„¦and â„¦n = B (z, n)
for
n âˆˆN. Thus F âˆ©â„¦n â†‘F. It follows that for n large enough,
k < Âµ (F âˆ©â„¦n) â‰¤Âµ (F) .
Since Âµ (F âˆ©â„¦n) < âˆžit follows there exists a compact set, K such that K âŠ†
F âˆ©â„¦n âŠ†F and
l < Âµ (K) â‰¤Âµ (F) .
This proves inner regularity. In case (â„¦, Ï„) is a compact Hausdorï¬€space, the con-
clusion of inner regularity follows from Theorem 9.21. This proves the theorem.
The proof of the above yields the following corollary.
Corollary 9.32 Let (â„¦, Ï„) be a locally compact Hausdorï¬€space and suppose Âµ
deï¬ned on a Ïƒ algebra, S represents the positive linear functional L where L is
deï¬ned on Cc (â„¦) in the sense of Theorem 9.15. Suppose also that there exist â„¦n âˆˆS
such that â„¦= âˆªâˆž
n=1â„¦n and Âµ (â„¦n) < âˆž. Then Âµ is regular.
The following is on the uniqueness of the Ïƒ algebra in some cases.
Deï¬nition 9.33 Let (â„¦, Ï„) be a locally compact Hausdorï¬€space and let L be a
positive linear functional deï¬ned on Cc (â„¦) such that the complete measure deï¬ned
by the Riesz representation theorem for positive linear functionals is inner regular.
Then this is called a Radon measure.
Thus a Radon measure is complete, and
regular.

230
THE CONSTRUCTION OF MEASURES
Corollary 9.34 Let (â„¦, Ï„) be a locally compact Hausdorï¬€space which is also Ïƒ
compact meaning
â„¦= âˆªâˆž
n=1â„¦n, â„¦n is compact,
and let L be a positive linear functional deï¬ned on Cc (â„¦) . Then if (Âµ1, S1) , and
(Âµ2, S2) are two Radon measures, together with their Ïƒ algebras which represent L
then the two Ïƒ algebras are equal and the two measures are equal.
Proof: Suppose (Âµ1, S1) and (Âµ2, S2) both work.
It will be shown the two
measures are equal on every compact set. Let K be compact and let V be an open
set containing K. Then let K â‰ºf â‰ºV. Then
Âµ1 (K) =
Z
K
dÂµ1 â‰¤
Z
fdÂµ1 = L (f) =
Z
fdÂµ2 â‰¤Âµ2 (V ) .
Therefore, taking the inï¬mum over all V containing K implies Âµ1 (K) â‰¤Âµ2 (K) .
Reversing the argument shows Âµ1 (K) = Âµ2 (K) . This also implies the two measures
are equal on all open sets because they are both inner regular on open sets. It is
being assumed the two measures are regular. Now let F âˆˆS1 with Âµ1 (F) < âˆž.
Then there exist sets, H, G such that H âŠ†F âŠ†G such that H is the countable
union of compact sets and G is a countable intersection of open sets such that
Âµ1 (G) = Âµ1 (H) which implies Âµ1 (G \ H) = 0. Now G \ H can be written as the
countable intersection of sets of the form Vk \Kk where Vk is open, Âµ1 (Vk) < âˆžand
Kk is compact. From what was just shown, Âµ2 (Vk \ Kk) = Âµ1 (Vk \ Kk) so it follows
Âµ2 (G \ H) = 0 also. Since Âµ2 is complete, and G and H are in S2, it follows F âˆˆS2
and Âµ2 (F) = Âµ1 (F) . Now for arbitrary F possibly having Âµ1 (F) = âˆž, consider
F âˆ©â„¦n. From what was just shown, this set is in S2 and Âµ2 (F âˆ©â„¦n) = Âµ1 (F âˆ©â„¦n).
Taking the union of these F âˆ©â„¦n gives F âˆˆS2 and also Âµ1 (F) = Âµ2 (F) . This shows
S1 âŠ†S2. Similarly, S2 âŠ†S1.
The following lemma is often useful.
Lemma 9.35 Let (â„¦, F, Âµ) be a measure space where â„¦is a metric space having
closed balls compact or more generally a topological space. Suppose Âµ is a Radon
measure and f is measurable with respect to F. Then there exists a Borel measurable
function, g, such that g = f a.e.
Proof: Assume without loss of generality that f â‰¥0. Then let sn â†‘f pointwise.
Say
sn (Ï‰) =
Pn
X
k=1
cn
kXEn
k (Ï‰)
where En
k âˆˆF. By the outer regularity of Âµ, there exists a Borel set, F n
k âŠ‡En
k such
that Âµ (F n
k ) = Âµ (En
k ). In fact F n
k can be assumed to be a GÎ´ set. Let
tn (Ï‰) â‰¡
Pn
X
k=1
cn
kXF n
k (Ï‰) .

9.5.
ONE DIMENSIONAL LEBESGUE MEASURE
231
Then tn is Borel measurable and tn (Ï‰) = sn (Ï‰) for all Ï‰ /âˆˆNn where Nn âˆˆF is
a set of measure zero. Now let N â‰¡âˆªâˆž
n=1Nn. Then N is a set of measure zero
and if Ï‰ /âˆˆN, then tn (Ï‰) â†’f (Ï‰). Let N â€² âŠ‡N where N â€² is a Borel set and
Âµ (N â€²) = 0. Then tnX(Nâ€²)C converges pointwise to a Borel measurable function, g,
and g (Ï‰) = f (Ï‰) for all Ï‰ /âˆˆN â€². Therefore, g = f a.e. and this proves the lemma.
9.5
One Dimensional Lebesgue Measure
To obtain one dimensional Lebesgue measure, you use the positive linear functional
L given by
Lf =
Z
f (x) dx
whenever f âˆˆCc (R) . Lebesgue measure, denoted by m is the measure obtained
from the Riesz representation theorem such that
Z
fdm = Lf =
Z
f (x) dx.
From this it is easy to verify that
m ([a, b]) = m ((a, b)) = b âˆ’a.
(9.18)
This will be done in general a little later but for now, consider the following picture
of functions, f k and gk converging pointwise as k â†’âˆžto X[a,b].
a + 1/k
@
@
R
a
Â£
Â£
Â£
Â£
1
B
B
B
B
b âˆ’1/k
Â¡
Â¡
Âª
b
f k
a âˆ’1/k
@
@@
R
a
Â£
Â£
Â£
Â£
1
B
B
B
B
b
b + 1/k
Â¡
Â¡
Âª
gk
Then
Âµ
b âˆ’a âˆ’2
k
Â¶
â‰¤
Z
f kdx =
Z
f kdm â‰¤m ((a, b)) â‰¤m ([a, b])
=
Z
X[a,b]dm â‰¤
Z
gkdm =
Z
gkdx â‰¤
Âµ
b âˆ’a + 2
k
Â¶
.
From this the claim in 9.18 follows.
9.6
The Distribution Function
There is an interesting connection between the Lebesgue integral of a nonnegative
function with something called the distribution function.

232
THE CONSTRUCTION OF MEASURES
Deï¬nition 9.36 Let f â‰¥0 and suppose f is measurable. The distribution function
is the function deï¬ned by
t â†’Âµ ([t < f]) .
Lemma 9.37 If {fn} is an increasing sequence of functions converging pointwise
to f then
Âµ ([f > t]) = lim
nâ†’âˆžÂµ ([fn > t])
Proof: The sets, [fn > t] are increasing and their union is [f > t] because if
f (Ï‰) > t, then for all n large enough, fn (Ï‰) > t also. Therefore, from Theorem 8.5
on Page 172 the desired conclusion follows.
Lemma 9.38 Suppose s â‰¥0 is a measurable simple function,
s (Ï‰) â‰¡
n
X
k=1
akXEk (Ï‰)
where the ak are the distinct nonzero values of s, a1 < a2 < Â· Â· Â· < an. Suppose Ï† is
a C1 function deï¬ned on [0, âˆž) which has the property that Ï† (0) = 0, Ï†â€² (t) > 0 for
all t. Then
Z âˆž
0
Ï†â€² (t) Âµ ([s > t]) dm =
Z
Ï† (s) dÂµ.
Proof: First note that if Âµ (Ek) = âˆžfor any k then both sides equal âˆžand
so without loss of generality, assume Âµ (Ek) < âˆžfor all k. Letting a0 â‰¡0, the left
side equals
n
X
k=1
Z ak
akâˆ’1
Ï†â€² (t) Âµ ([s > t]) dm
=
n
X
k=1
Z ak
akâˆ’1
Ï†â€² (t)
n
X
i=k
Âµ (Ei) dm
=
n
X
k=1
n
X
i=k
Âµ (Ei)
Z ak
akâˆ’1
Ï†â€² (t) dm
=
n
X
k=1
n
X
i=k
Âµ (Ei) (Ï† (ak) âˆ’Ï† (akâˆ’1))
=
n
X
i=1
Âµ (Ei)
i
X
k=1
(Ï† (ak) âˆ’Ï† (akâˆ’1))
=
n
X
i=1
Âµ (Ei) Ï† (ai) =
Z
Ï† (s) dÂµ.
This proves the lemma.
With this lemma the next theorem which is the main result follows easily.
Theorem 9.39 Let f â‰¥0 be measurable and let Ï† be a C1 function deï¬ned on
[0, âˆž) which satisï¬es Ï†â€² (t) > 0 for all t > 0 and Ï† (0) = 0. Then
Z
Ï† (f) dÂµ =
Z âˆž
0
Ï†â€² (t) Âµ ([f > t]) dt.

9.7.
PRODUCT MEASURES
233
Proof: By Theorem 8.27 on Page 190 there exists an increasing sequence of
nonnegative simple functions, {sn} which converges pointwise to f. By the monotone
convergence theorem and Lemma 9.37,
Z
Ï† (f) dÂµ
=
lim
nâ†’âˆž
Z
Ï† (sn) dÂµ = lim
nâ†’âˆž
Z âˆž
0
Ï†â€² (t) Âµ ([sn > t]) dm
=
Z âˆž
0
Ï†â€² (t) Âµ ([f > t]) dm
This proves the theorem.
9.7
Product Measures
Let (X, S, Âµ) and (Y, T , Î½) be two complete measure spaces. In this section consider
the problem of deï¬ning a product measure, Âµ Ã— Î½ which is deï¬ned on a Ïƒ algebra of
sets of X Ã— Y such that (Âµ Ã— Î½) (E Ã— F) = Âµ (E) Î½ (F) whenever E âˆˆS and F âˆˆT .
I found the following approach to product measures in [20] and they say they got
it from [22].
Deï¬nition 9.40 Let R denote the set of countable unions of sets of the form AÃ—B,
where A âˆˆS and B âˆˆT
(Sets of the form A Ã— B are referred to as measurable
rectangles) and also let
Ï (A Ã— B) = Âµ (A) Î½ (B)
(9.19)
More generally, deï¬ne
Ï (E) â‰¡
Z Z
XE (x, y) dÂµdÎ½
(9.20)
whenever E is such that
x â†’XE (x, y) is Âµ measurable for all y
(9.21)
and
y â†’
Z
XE (x, y) dÂµ is Î½ measurable.
(9.22)
Note that if E = A Ã— B as above, then
Z Z
XE (x, y) dÂµdÎ½
=
Z Z
XAÃ—B (x, y) dÂµdÎ½
=
Z Z
XA (x) XB (y) dÂµdÎ½ = Âµ (A) Î½ (B) = Ï (E)
and so there is no contradiction between 9.20 and 9.19.
The ï¬rst goal is to show that for Q âˆˆR, 9.21 and 9.22 both hold. That is,
x â†’XQ (x, y) is Âµ measurable for all y and y â†’
R
XQ (x, y) dÂµ is Î½ measurable.
This is done so that it is possible to speak of Ï (Q) . The following lemma will be
the fundamental result which will make this possible. First here is a picture.

234
THE CONSTRUCTION OF MEASURES
C
D
A
B
Lemma 9.41 Given C Ã— D and {Ai Ã— Bi}n
i=1 , there exist ï¬nitely many disjoint
rectangles, {Câ€²
i Ã— Dâ€²
i}p
i=1 such that none of these sets intersect any of the Ai Ã— Bi,
each set is contained in C Ã— D and
(âˆªn
i=1Ai Ã— Bi) âˆª(âˆªp
k=1Câ€²
k Ã— Dâ€²
k) = (C Ã— D) âˆª(âˆªn
i=1Ai Ã— Bi) .
Proof: From the above picture, you see that
(C Ã— D) \ (A1 Ã— B1) = C Ã— (D \ B1) âˆª(C \ A1) Ã— (D âˆ©B1)
and these last two sets are disjoint, have empty intersection with A1 Ã— B1, and
(C Ã— (D \ B1) âˆª(C \ A1) Ã— (D âˆ©B1)) âˆª(âˆªn
i=1Ai Ã— Bi) = (C Ã— D) âˆª(âˆªn
i=1Ai Ã— Bi)
Now suppose disjoint sets,
n
eCi Ã— eDi
om
i=1 have been obtained, each being a subset
of C Ã— D such that
(âˆªn
i=1Ai Ã— Bi) âˆª
Â³
âˆªm
k=1 eCk Ã— eDk
Â´
= (âˆªn
i=1Ai Ã— Bi) âˆª(C Ã— D)
and for all k, eCk Ã— eDk has empty intersection with each set of {Ai Ã— Bi}p
i=1 . Then
using the same procedure, replace each of eCk Ã— eDk with ï¬nitely many disjoint
rectangles such that none of these intersect Ap+1 Ã—Bp+1 while preserving the union
of all the sets involved. The process stops when you have gotten to n. This proves
the lemma.
Lemma 9.42 If Q = âˆªâˆž
i=1Ai Ã— Bi âˆˆR, then there exist disjoint sets, of the form
Aâ€²
i Ã— Bâ€²
i such that Q = âˆªâˆž
i=1Aâ€²
i Ã— Bâ€²
i, each Aâ€²
i Ã— Bâ€²
i is a subset of some Ai Ã— Bi, and
Aâ€²
i âˆˆS while Bâ€²
i âˆˆT . Also, the intersection of ï¬nitely many sets of R is a set of
R. For Ï deï¬ned in 9.20, it follows that 9.21 and 9.22 hold for any element of R.
Furthermore,
Ï (Q) =
X
i
Âµ (Aâ€²
i) Î½ (Bâ€²
i) =
X
i
Ï (Aâ€²
i Ã— Bâ€²
i) .
Proof: Let Q be given as above. Let Aâ€²
1 Ã— Bâ€²
1 = A1 Ã— B1. By Lemma 9.41, it
is possible to replace A2 Ã— B2 with ï¬nitely many disjoint rectangles, {Aâ€²
i Ã— Bâ€²
i}m2
i=2
such that none of these rectangles intersect Aâ€²
1 Ã— Bâ€²
1, each is a subset of A2 Ã— B2,
and
âˆªâˆž
i=1Ai Ã— Bi = (âˆªm2
i=1Aâ€²
i Ã— Bâ€²
i) âˆª(âˆªâˆž
k=3Ak Ã— Bk)

9.7.
PRODUCT MEASURES
235
Now suppose disjoint rectangles, {Aâ€²
i Ã— Bâ€²
i}mp
i=1 have been obtained such that each
rectangle is a subset of Ak Ã— Bk for some k â‰¤p and
âˆªâˆž
i=1Ai Ã— Bi =
Â¡
âˆªmp
i=1Aâ€²
i Ã— Bâ€²
i
Â¢
âˆª
Â¡
âˆªâˆž
k=p+1Ak Ã— Bk
Â¢
.
By Lemma 9.41 again, there exist disjoint rectangles {Aâ€²
i Ã— Bâ€²
i}mp+1
i=mp+1 such that
each is contained in Ap+1 Ã— Bp+1, none have intersection with any of {Aâ€²
i Ã— Bâ€²
i}mp
i=1
and
âˆªâˆž
i=1Ai Ã— Bi =
Â¡
âˆªmp+1
i=1 Aâ€²
i Ã— Bâ€²
i
Â¢
âˆª
Â¡
âˆªâˆž
k=p+2Ak Ã— Bk
Â¢
.
Note that no change is made in {Aâ€²
i Ã— Bâ€²
i}mp
i=1 . Continuing this way proves the
existence of the desired sequence of disjoint rectangles, each of which is a subset of
at least one of the original rectangles and such that
Q = âˆªâˆž
i=1Aâ€²
i Ã— Bâ€²
i.
It remains to verify x â†’XQ (x, y) is Âµ measurable for all y and
y â†’
Z
XQ (x, y) dÂµ
is Î½ measurable whenever Q âˆˆR. Let Q â‰¡âˆªâˆž
i=1Ai Ã— Bi âˆˆR. Then by the ï¬rst
part of this lemma, there exists {Aâ€²
i Ã— Bâ€²
i}âˆž
i=1 such that the sets are disjoint and
âˆªâˆž
i=1Aâ€²
i Ã— Bâ€²
i = Q. Therefore, since the sets are disjoint,
XQ (x, y) =
âˆž
X
i=1
XAâ€²
iÃ—Bâ€²
i (x, y) =
âˆž
X
i=1
XAâ€²
i (x) XBâ€²
i (y) .
It follows x â†’XQ (x, y) is measurable. Now by the monotone convergence theorem,
Z
XQ (x, y) dÂµ
=
Z
âˆž
X
i=1
XAâ€²
i (x) XBâ€²
i (y) dÂµ
=
âˆž
X
i=1
XBâ€²
i (y)
Z
XAâ€²
i (x) dÂµ
=
âˆž
X
i=1
XBâ€²
i (y) Âµ (Aâ€²
i) .
It follows y â†’
R
XQ (x, y) dÂµ is measurable and so by the monotone convergence
theorem again,
Z Z
XQ (x, y) dÂµdÎ½
=
Z
âˆž
X
i=1
XBâ€²
i (y) Âµ (Aâ€²
i) dÎ½
=
âˆž
X
i=1
Z
XBâ€²
i (y) Âµ (Aâ€²
i) dÎ½
=
âˆž
X
i=1
Î½ (Bâ€²
i) Âµ (Aâ€²
i) .
(9.23)

236
THE CONSTRUCTION OF MEASURES
This shows the measurability conditions, 9.21 and 9.22 hold for Q âˆˆR and also
establishes the formula for Ï (Q) , 9.23.
If âˆªiAi Ã— Bi and âˆªjCj Ã— Dj are two sets of R, then their intersection is
âˆªi âˆªj (Ai âˆ©Cj) Ã— (Bi âˆ©Dj)
a countable union of measurable rectangles. Thus ï¬nite intersections of sets of R
are in R. This proves the lemma.
Now note that from the deï¬nition of R if you have a sequence of elements of R
then their union is also in R. The next lemma will enable the deï¬nition of an outer
measure.
Lemma 9.43 Suppose {Ri}âˆž
i=1 is a sequence of sets of R then
Ï (âˆªâˆž
i=1Ri) â‰¤
âˆž
X
i=1
Ï (Ri) .
Proof: Let Ri = âˆªâˆž
j=1Ai
j Ã— Bi
j. Using Lemma 9.42, let {Aâ€²
m Ã— Bâ€²
m}âˆž
m=1 be a
sequence of disjoint rectangles each of which is contained in some Ai
j Ã— Bi
j for some
i, j such that
âˆªâˆž
i=1Ri = âˆªâˆž
m=1Aâ€²
m Ã— Bâ€²
m.
Now deï¬ne
Si â‰¡
Â©
m : Aâ€²
m Ã— Bâ€²
m âŠ†Ai
j Ã— Bi
j for some j
Âª
.
It is not important to consider whether some m might be in more than one Si. The
important thing to notice is that
âˆªmâˆˆSiAâ€²
m Ã— Bâ€²
m âŠ†âˆªâˆž
j=1Ai
j Ã— Bi
j = Ri.
Then by Lemma 9.42,
Ï (âˆªâˆž
i=1Ri)
=
X
m
Ï (Aâ€²
m Ã— Bâ€²
m)
â‰¤
âˆž
X
i=1
X
mâˆˆSi
Ï (Aâ€²
m Ã— Bâ€²
m)
â‰¤
âˆž
X
i=1
Ï (âˆªmâˆˆSiAâ€²
m Ã— Bâ€²
m) â‰¤
âˆž
X
i=1
Ï (Ri) .
This proves the lemma.
So far, there is no measure and no Ïƒ algebra. However, the next step is to deï¬ne
an outer measure which will lead to a measure on a Ïƒ algebra of measurable sets
from the Caratheodory procedure. When this is done, it will be shown that this
measure can be computed using Ï which implies the important Fubini theorem.
Now it is possible to deï¬ne an outer measure.

9.7.
PRODUCT MEASURES
237
Deï¬nition 9.44 For S âŠ†X Ã— Y, deï¬ne
(Âµ Ã— Î½) (S) â‰¡inf {Ï (R) : S âŠ†R, R âˆˆR} .
(9.24)
The following proposition is interesting but is not needed in the development
which follows. It gives a diï¬€erent description of (Âµ Ã— Î½) .
Proposition 9.45 (Âµ Ã— Î½) (S) = inf {Pâˆž
i=1 Âµ (Ai) Î½ (Bi) : S âŠ†âˆªâˆž
i=1Ai Ã— Bi}
Proof: Let Î» (S) â‰¡inf {Pâˆž
i=1 Âµ (Ai) Î½ (Bi) : S âŠ†âˆªâˆž
i=1Ai Ã— Bi} . Suppose S âŠ†
âˆªâˆž
i=1Ai Ã— Bi â‰¡Q âˆˆR. Then by Lemma 9.42, Q = âˆªiAâ€²
i Ã— Bâ€²
i where these rectan-
gles are disjoint. Thus by this lemma, Ï (Q) = Pâˆž
i=1 Âµ (Aâ€²
i) Î½ (Bâ€²
i) â‰¥Î» (S) and so
Î» (S) â‰¤(Âµ Ã— Î½) (S) . If Î» (S) = âˆž, this shows Î» (S) = (Âµ Ã— Î½) (S) . Suppose then
that Î» (S) < âˆžand Î» (S) + Îµ > Pâˆž
i=1 Âµ (Ai) Î½ (Bi) where Q = âˆªâˆž
i=1Ai Ã— Bi âŠ‡S.
Then by Lemma 9.42 again, âˆªâˆž
i=1AiÃ—Bi = âˆªâˆž
i=1Aâ€²
iÃ—Bâ€²
i where the primed rectangles
are disjoint, each is a subset of some Ai Ã— Bi and so
Î» (S) + Îµ â‰¥
âˆž
X
i=1
Âµ (Ai) Î½ (Bi) â‰¥
âˆž
X
i=1
Âµ (Aâ€²
i) Î½ (Bâ€²
i) = Ï (Q) â‰¥(Âµ Ã— Î½) (S) .
Since Îµ is arbitrary, this shows Î» (S) â‰¥(Âµ Ã— Î½) (S) and this proves the proposition.
Lemma 9.46 Âµ Ã— Î½ is an outer measure on X Ã— Y and for R âˆˆR
(Âµ Ã— Î½) (R) = Ï (R) .
(9.25)
Proof: First consider 9.25. Since R âŠ‡R, it follows Ï (R) â‰¥(Âµ Ã— Î½) (R) . On the
other hand, if Q âˆˆR and Q âŠ‡R, then Ï (Q) â‰¥Ï (R) and so, taking the inï¬mum
on the left yields (Âµ Ã— Î½) (R) â‰¥Ï (R) . This shows 9.25.
It is necessary to show that if S âŠ†T, then
(Âµ Ã— Î½) (S) â‰¤(Âµ Ã— Î½) (T) ,
(9.26)
(Âµ Ã— Î½) (âˆªâˆž
i=1Si) â‰¤
âˆž
X
i=1
(Âµ Ã— Î½) (Si) .
(9.27)
To do this, note that 9.26 is obvious. To verify 9.27, note that it is obvious if
(Âµ Ã— Î½) (Si) = âˆžfor any i. Therefore, assume (Âµ Ã— Î½) (Si) < âˆž. Then letting Îµ > 0
be given, there exist Ri âˆˆR such that
(Âµ Ã— Î½) (Si) + Îµ
2i > Ï (Ri) , Ri âŠ‡Si.

238
THE CONSTRUCTION OF MEASURES
Then by Lemma 9.43, 9.25, and the observation that âˆªâˆž
i=1Ri âˆˆR,
(Âµ Ã— Î½) (âˆªâˆž
i=1Si)
â‰¤
(Âµ Ã— Î½) (âˆªâˆž
i=1Ri)
=
Ï (âˆªâˆž
i=1Ri) â‰¤
âˆž
X
i=1
Ï (Ri)
â‰¤
âˆž
X
i=1
Â³
(Âµ Ã— Î½) (Si) + Îµ
2i
Â´
=
Ãƒ âˆž
X
i=1
(Âµ Ã— Î½) (Si)
!
+ Îµ.
Since Îµ is arbitrary, this proves the lemma.
By Caratheodoryâ€™s procedure, it follows there is a Ïƒ algebra of subsets of X Ã—Y,
denoted here by S Ã— T such that (Âµ Ã— Î½) is a complete measure on this Ïƒ algebra.
The ï¬rst thing to note is that every rectangle is in this Ïƒ algebra.
Lemma 9.47 Every rectangle is (Âµ Ã— Î½) measurable.
Proof: Let S âŠ†X Ã— Y. The following inequality must be established.
(Âµ Ã— Î½) (S) â‰¥(Âµ Ã— Î½) (S âˆ©(A Ã— B)) + (Âµ Ã— Î½) (S \ (A Ã— B)) .
(9.28)
The following claim will be used to establish this inequality.
Claim: Let P, A Ã— B âˆˆR. Then
Ï (P âˆ©(A Ã— B)) + Ï (P \ (A Ã— B)) = Ï (P) .
Proof of the claim: From Lemma 9.42, P = âˆªâˆž
i=1Aâ€²
i Ã— Bâ€²
i where the Aâ€²
i Ã— Bâ€²
i
are disjoint. Therefore,
P âˆ©(A Ã— B) =
âˆž
[
i=1
(A âˆ©Aâ€²
i) Ã— (B âˆ©Bâ€²
i)
while
P \ (A Ã— B) =
âˆž
[
i=1
(Aâ€²
i \ A) Ã— Bâ€²
i âˆª
âˆž
[
i=1
(A âˆ©Aâ€²
i) Ã— (Bâ€²
i \ B) .
Since all of the sets in the above unions are disjoint,
Ï (P âˆ©(A Ã— B)) + Ï (P \ (A Ã— B)) =
Z Z
âˆž
X
i=1
X(Aâˆ©Aâ€²
i) (x) XBâˆ©Bâ€²
i (y) dÂµdÎ½ +
Z Z
âˆž
X
i=1
X(Aâ€²
i\A) (x) XBâ€²
i (y) dÂµdÎ½
+
Z Z
âˆž
X
i=1
XAâˆ©Aâ€²
i (x) XBâ€²
i\B (y) dÂµdÎ½

9.7.
PRODUCT MEASURES
239
=
âˆž
X
i=1
Âµ (A âˆ©Aâ€²
i) Î½ (B âˆ©Bâ€²
i) + Âµ (Aâ€²
i \ A) Î½ (Bâ€²
i) + Âµ (A âˆ©Aâ€²
i) Î½ (Bâ€²
i \ B)
=
âˆž
X
i=1
Âµ (A âˆ©Aâ€²
i) Î½ (Bâ€²
i) + Âµ (Aâ€²
i \ A) Î½ (Bâ€²
i) =
âˆž
X
i=1
Âµ (Aâ€²
i) Î½ (Bâ€²
i) = Ï (P) .
This proves the claim.
Now continuing to verify 9.28, without loss of generality, (Âµ Ã— Î½) (S) can be
assumed ï¬nite. Let P âŠ‡S for P âˆˆR and
(Âµ Ã— Î½) (S) + Îµ > Ï (P) .
Then from the claim,
(Âµ Ã— Î½) (S) + Îµ
>
Ï (P) = Ï (P âˆ©(A Ã— B)) + Ï (P \ (A Ã— B))
â‰¥
(Âµ Ã— Î½) (S âˆ©(A Ã— B)) + (Âµ Ã— Î½) (S \ (A Ã— B)) .
Since Îµ > 0 this shows A Ã— B is Âµ Ã— Î½ measurable as claimed.
Lemma 9.48 Let R1 be deï¬ned as the set of all countable intersections of sets of
R. Then if S âŠ†X Ã— Y, there exists R âˆˆR1 for which it makes sense to write Ï (R)
because 9.21 and 9.22 hold such that
(Âµ Ã— Î½) (S) = Ï (R) .
(9.29)
Also, every element of R1 is Âµ Ã— Î½ measurable.
Proof: Consider 9.29. Let S âŠ†X Ã— Y. If (Âµ Ã— Î½) (S) = âˆž, let R = X Ã— Y and
it follows Ï (X Ã— Y ) = âˆž= (Âµ Ã— Î½) (S) . Assume then that (Âµ Ã— Î½) (S) < âˆž.
Therefore, there exists Pn âˆˆR such that Pn âŠ‡S and
(Âµ Ã— Î½) (S) â‰¤Ï (Pn) < (Âµ Ã— Î½) (S) + 1/n.
(9.30)
Let Qn = âˆ©n
i=1Pi âˆˆR. Deï¬ne
P â‰¡âˆ©âˆž
i=1Qi âŠ‡S.
Then 9.30 holds with Qn in place of Pn. It is clear that
x â†’XP (x, y) is Âµ measurable
because this function is the pointwise limit of functions for which this is so. It
remains to consider whether y â†’
R
XP (x, y) dÂµ is Î½ measurable.
First observe
Qn âŠ‡Qn+1, XQi â‰¤XPi, and
Ï (Q1) = Ï (P1) =
Z Z
XP1 (x, y) dÂµdÎ½ < âˆž.
(9.31)

240
THE CONSTRUCTION OF MEASURES
Therefore, there exists a set of Î½ measure 0, N, such that if y /âˆˆN, then
Z
XP1 (x, y) dÂµ < âˆž.
It follows from the dominated convergence theorem that
lim
nâ†’âˆžXNC (y)
Z
XQn (x, y) dÂµ = XNC (y)
Z
XP (x, y) dÂµ
and so
y â†’XNC (y)
Z
XP (x, y) dÂµ
is also measurable. By completeness of Î½,
y â†’
Z
XP (x, y) dÂµ
must also be Î½ measurable and so it makes sense to write
Z Z
XP (x, y) dÂµdÎ½
for every P âˆˆR1. Also, by the dominated convergence theorem,
Z Z
XP (x, y) dÂµdÎ½
=
Z
XNC (y)
Z
XP (x, y) dÂµdÎ½
=
lim
nâ†’âˆž
Z
XN C (y)
Z
XQn (x, y) dÂµdÎ½
=
lim
nâ†’âˆž
Z Z
XQn (x, y) dÂµdÎ½
=
lim
nâ†’âˆžÏ (Qn) âˆˆ[(Âµ Ã— Î½) (S) , (Âµ Ã— Î½) (S) + 1/n]
for all n. Therefore,
Ï (P) â‰¡
Z Z
XP (x, y) dÂµdÎ½ = (Âµ Ã— Î½) (S) .
The sets of R1 are Âµ Ã— Î½ measurable because these sets are countable intersec-
tions of countable unions of rectangles and Lemma 9.47 veriï¬es the rectangles are
Âµ Ã— Î½ measurable. This proves the Lemma.
The following theorem is the main result.
Theorem 9.49 Let E âŠ†X Ã—Y be Âµ Ã— Î½ measurable and suppose (Âµ Ã— Î½) (E) < âˆž.
Then
x â†’XE (x, y) is Âµ measurable a.e. y.
Modifying XE on a set of measure zero, it is possible to write
Z
XE (x, y) dÂµ.

9.7.
PRODUCT MEASURES
241
The function,
y â†’
Z
XE (x, y) dÂµ
is Î½ measurable and
(Âµ Ã— Î½) (E) =
Z Z
XE (x, y) dÂµdÎ½.
Similarly,
(Âµ Ã— Î½) (E) =
Z Z
XE (x, y) dÎ½dÂµ.
Proof: By Lemma 9.48, there exists R âˆˆR1 such that
Ï (R) = (Âµ Ã— Î½) (E) , R âŠ‡E.
Therefore, since R is Âµ Ã— Î½ measurable and Ï (R) = (Âµ Ã— Î½) (R), it follows
(Âµ Ã— Î½) (R \ E) = 0.
By Lemma 9.48 again, there exists P âŠ‡R \ E with P âˆˆR1 and
Ï (P) = (Âµ Ã— Î½) (R \ E) = 0.
Thus
Z Z
XP (x, y) dÂµdÎ½ = 0.
(9.32)
Since P âˆˆR1 Lemma 9.48 implies x â†’XP (x, y) is Âµ measurable and it follows
from the above there exists a set of Î½ measure zero, N such that if y /âˆˆN, then
R
XP (x, y) dÂµ = 0. Therefore, by completeness of Î½,
x â†’XN C (y) XR\E (x, y)
is Âµ measurable and
Z
XN C (y) XR\E (x, y) dÂµ = 0.
(9.33)
Now also
XN C (y) XR (x, y) = XN C (y) XR\E (x, y) + XN C (y) XE (x, y)
(9.34)
and this shows that
x â†’XN C (y) XE (x, y)
is Âµ measurable because it is the diï¬€erence of two functions with this property.
Then by 9.33 it follows
Z
XNC (y) XE (x, y) dÂµ =
Z
XN C (y) XR (x, y) dÂµ.

242
THE CONSTRUCTION OF MEASURES
The right side of this equation equals a Î½ measurable function and so the left side
which equals it is also a Î½ measurable function. It follows from completeness of Î½
that y â†’
R
XE (x, y) dÂµ is Î½ measurable because for y outside of a set of Î½ measure
zero, N it equals
R
XR (x, y) dÂµ. Therefore,
Z Z
XE (x, y) dÂµdÎ½
=
Z Z
XN C (y) XE (x, y) dÂµdÎ½
=
Z Z
XN C (y) XR (x, y) dÂµdÎ½
=
Z Z
XR (x, y) dÂµdÎ½
=
Ï (R) = (Âµ Ã— Î½) (E) .
In all the above there would be no change in writing dÎ½dÂµ instead of dÂµdÎ½. The
same result would be obtained. This proves the theorem.
Now let f : X Ã— Y â†’[0, âˆž] be Âµ Ã— Î½ measurable and
Z
fd (Âµ Ã— Î½) < âˆž.
(9.35)
Let s (x, y) â‰¡Pm
i=1 ciXEi (x, y) be a nonnegative simple function with ci being the
nonzero values of s and suppose
0 â‰¤s â‰¤f.
Then from the above theorem,
Z
sd (Âµ Ã— Î½) =
Z Z
sdÂµdÎ½
In which
Z
sdÂµ =
Z
XNC (y) sdÂµ
for N a set of Î½ measure zero such that y â†’
R
XNC (y) sdÂµ is Î½ measurable. This
follows because 9.35 implies (Âµ Ã— Î½) (Ei) < âˆž. Now let sn â†‘f where sn is a non-
negative simple function and
Z
snd (Âµ Ã— Î½) =
Z Z
XN C
n (y) sn (x, y) dÂµdÎ½
where
y â†’
Z
XN C
n (y) sn (x, y) dÂµ
is Î½ measurable. Then let N â‰¡âˆªâˆž
n=1Nn. It follows N is a set of Î½ measure zero.
Thus
Z
snd (Âµ Ã— Î½) =
Z Z
XN C (y) sn (x, y) dÂµdÎ½

9.7.
PRODUCT MEASURES
243
and letting n â†’âˆž, the monotone convergence theorem implies
Z
fd (Âµ Ã— Î½)
=
Z Z
XNC (y) f (x, y) dÂµdÎ½
=
Z Z
f (x, y) dÂµdÎ½
because of completeness of the measures, Âµ and Î½. This proves Fubiniâ€™s theorem.
Theorem 9.50 (Fubini) Let (X, S, Âµ) and (Y, T , Î½) be complete measure spaces
and let
(Âµ Ã— Î½) (E) â‰¡inf
Â½Z Z
XR (x, y) dÂµdÎ½ : E âŠ†R âˆˆR
Â¾
2
where Ai âˆˆS and Bi âˆˆT .
Then Âµ Ã— Î½ is an outer measure on the subsets of
X Ã— Y and the Ïƒ algebra of Âµ Ã— Î½ measurable sets, S Ã— T , contains all measurable
rectangles. If f â‰¥0 is a Âµ Ã— Î½ measurable function satisfying
Z
XÃ—Y
fd (Âµ Ã— Î½) < âˆž,
(9.36)
then
Z
XÃ—Y
fd (Âµ Ã— Î½) =
Z
Y
Z
X
fdÂµdÎ½,
where the iterated integral on the right makes sense because for Î½ a.e. y, x â†’f (x, y)
is Âµ measurable and y â†’
R
f (x, y) dÂµ is Î½ measurable. Similarly,
Z
XÃ—Y
fd (Âµ Ã— Î½) =
Z
X
Z
Y
fdÎ½dÂµ.
In the case where (X, S, Âµ) and (Y, T , Î½) are both Ïƒ ï¬nite, it is not necessary to
assume 9.36.
Corollary 9.51 (Fubini) Let (X, S, Âµ) and (Y, T , Î½) be complete measure spaces
such that (X, S, Âµ) and (Y, T , Î½) are both Ïƒ ï¬nite and let
(Âµ Ã— Î½) (E) â‰¡inf
Â½Z Z
XR (x, y) dÂµdÎ½ : E âŠ†R âˆˆR
Â¾
where Ai âˆˆS and Bi âˆˆT .
Then Âµ Ã— Î½ is an outer measure. If f â‰¥0 is a Âµ Ã— Î½
measurable function then
Z
XÃ—Y
fd (Âµ Ã— Î½) =
Z
Y
Z
X
fdÂµdÎ½,
2Recall this is the same as
inf
( âˆž
X
i=1
Âµ (Ai) Î½ (Bi) : E âŠ†âˆªâˆž
i=1Ai Ã— Bi
)
in which the Ai and Bi are measurable.

244
THE CONSTRUCTION OF MEASURES
where the iterated integral on the right makes sense because for Î½ a.e. y, x â†’f (x, y)
is Âµ measurable and y â†’
R
f (x, y) dÂµ is Î½ measurable. Similarly,
Z
XÃ—Y
fd (Âµ Ã— Î½) =
Z
X
Z
Y
fdÎ½dÂµ.
Proof: Let âˆªâˆž
n=1Xn = X and âˆªâˆž
n=1Yn = Y where Xn âˆˆS, Yn âˆˆT , Xn âŠ†
Xn+1, Yn âŠ†Yn+1 for all n and Âµ (Xn) < âˆž, Î½ (Yn) < âˆž. From Theorem 9.50
applied to Xn, Yn and fm â‰¡min (f, m) ,
Z
XnÃ—Yn
fmd (Âµ Ã— Î½) =
Z
Yn
Z
Xn
fmdÂµdÎ½
Now take m â†’âˆžand use the monotone convergence theorem to obtain
Z
XnÃ—Yn
fd (Âµ Ã— Î½) =
Z
Yn
Z
Xn
fdÂµdÎ½.
Then use the monotone convergence theorem again letting n â†’âˆžto obtain the
desired conclusion. The argument for the other order of integration is similar.
Corollary 9.52 If f âˆˆL1 (X Ã— Y ) , then
Z
fd (Âµ Ã— Î½) =
Z Z
f (x, y) dÂµdÎ½ =
Z Z
f (x, y) dÎ½dÂµ.
If Âµ and Î½ are Ïƒ ï¬nite, then if f is Âµ Ã— Î½ measurable having complex values and
either
R R
|f| dÂµdÎ½ < âˆžor
R R
|f| dÎ½dÂµ < âˆž, then
R
|f| d (Âµ Ã— Î½) < âˆžso f âˆˆ
L1 (X Ã— Y ) .
Proof: Without loss of generality, it can be assumed that f has real values.
Then
f = |f| + f âˆ’(|f| âˆ’f)
2
and both f + â‰¡|f|+f
2
and f âˆ’â‰¡|f|âˆ’f
2
are nonnegative and are less than |f|. There-
fore,
R
gd (Âµ Ã— Î½) < âˆžfor g = f + and g = f âˆ’so the above theorem applies and
Z
fd (Âµ Ã— Î½)
â‰¡
Z
f +d (Âµ Ã— Î½) âˆ’
Z
f âˆ’d (Âµ Ã— Î½)
=
Z Z
f +dÂµdÎ½ âˆ’
Z Z
f âˆ’dÂµdÎ½
=
Z Z
fdÂµdÎ½.
It remains to verify the last claim. Suppose s is a simple function,
s (x, y) â‰¡
m
X
i=1
ciXEi â‰¤|f| (x, y)

9.8.
ALTERNATIVE TREATMENT OF PRODUCT MEASURE
245
where the ci are the nonzero values of s. Then
sXRn â‰¤|f| XRn
where Rn â‰¡Xn Ã— Yn where Xn â†‘X and Yn â†‘Y with Âµ (Xn) < âˆžand Î½ (Yn) < âˆž.
It follows, since the nonzero values of sXRn are achieved on sets of ï¬nite measure,
Z
sXRnd (Âµ Ã— Î½) =
Z Z
sXRndÂµdÎ½.
Letting n â†’âˆžand applying the monotone convergence theorem, this yields
Z
sd (Âµ Ã— Î½) =
Z Z
sdÂµdÎ½.
(9.37)
Now let sn â†‘|f| where sn is a nonnegative simple function. From 9.37,
Z
snd (Âµ Ã— Î½) =
Z Z
sndÂµdÎ½.
Letting n â†’âˆžand using the monotone convergence theorem, yields
Z
|f| d (Âµ Ã— Î½) =
Z Z
|f| dÂµdÎ½ < âˆž
9.8
Alternative Treatment Of Product Measure
9.8.1
Monotone Classes And Algebras
Measures are deï¬ned on Ïƒ algebras which are closed under countable unions. It is
for this reason that the theory of measure and integration is so useful in dealing
with limits of sequences. However, there is a more basic notion which involves only
ï¬nite unions and diï¬€erences.
Deï¬nition 9.53 A is said to be an algebra of subsets of a set, Z if Z âˆˆA, âˆ…âˆˆA,
and when E, F âˆˆA, E âˆªF and E \ F are both in A.
It is important to note that if A is an algebra, then it is also closed under ï¬nite
intersections. This is because E âˆ©F = (EC âˆªF C)C âˆˆA since EC = Z \ E âˆˆA and
F C = Z \ F âˆˆA. Note that every Ïƒ algebra is an algebra but not the other way
around.
Something satisfying the above deï¬nition is called an algebra because union is
like addition, the set diï¬€erence is like subtraction and intersection is like multipli-
cation. Furthermore, only ï¬nitely many operations are done at a time and so there
is nothing like a limit involved.
How can you recognize an algebra when you see one? The answer to this question
is the purpose of the following lemma.

246
THE CONSTRUCTION OF MEASURES
Lemma 9.54 Suppose R and E are subsets of P(Z)3 such that E is deï¬ned as the
set of all ï¬nite disjoint unions of sets of R. Suppose also
âˆ…, Z âˆˆR
A âˆ©B âˆˆR whenever A, B âˆˆR,
A \ B âˆˆE
whenever A, B âˆˆR.
Then E is an algebra of sets of Z.
Proof: Note ï¬rst that if A âˆˆR, then AC âˆˆE because AC = Z \ A.
Now suppose that E1and E2 are in E,
E1 = âˆªm
i=1Ri, E2 = âˆªn
j=1Rj
where the Ri are disjoint sets in R and the Rj are disjoint sets in R. Then
E1 âˆ©E2 = âˆªm
i=1 âˆªn
j=1 Ri âˆ©Rj
which is clearly an element of E because no two of the sets in the union can intersect
and by assumption they are all in R. Thus by induction, ï¬nite intersections of sets
of E are in E. Consider the diï¬€erence of two elements of E next.
If E = âˆªn
i=1Ri âˆˆE,
EC = âˆ©n
i=1RC
i = ï¬nite intersection of sets of E
which was just shown to be in E. Now, if E1, E2 âˆˆE,
E1 \ E2 = E1 âˆ©EC
2 âˆˆE
from what was just shown about ï¬nite intersections.
Finally consider ï¬nite unions of sets of E. Let E1 and E2 be sets of E. Then
E1 âˆªE2 = (E1 \ E2) âˆªE2 âˆˆE
because E1 \ E2 consists of a ï¬nite disjoint union of sets of R and these sets must
be disjoint from the sets of R whose union yields E2 because (E1 \ E2) âˆ©E2 = âˆ….
This proves the lemma.
The following corollary is particularly helpful in verifying the conditions of the
above lemma.
Corollary 9.55 Let (Z1, R1, E1) and (Z2, R2, E2) be as described in Lemma 9.54.
Then (Z1 Ã— Z2, R, E) also satisï¬es the conditions of Lemma 9.54 if R is deï¬ned as
R â‰¡{R1 Ã— R2 : Ri âˆˆRi}
and
E â‰¡{ ï¬nite disjoint unions of sets of R}.
Consequently, E is an algebra of sets.
3Set of all subsets of Z

9.8.
ALTERNATIVE TREATMENT OF PRODUCT MEASURE
247
Proof: It is clear âˆ…, Z1 Ã— Z2 âˆˆR. Let A Ã— B and C Ã— D be two elements of R.
A Ã— B âˆ©C Ã— D = A âˆ©C Ã— B âˆ©D âˆˆR
by assumption.
A Ã— B \ (C Ã— D) =
A Ã—
âˆˆE2
z }| {
(B \ D) âˆª
âˆˆE1
z }| {
(A \ C) Ã—
âˆˆR2
z
}|
{
(D âˆ©B)
= (A Ã— Q) âˆª(P Ã— R)
where Q âˆˆE2, P âˆˆE1, and R âˆˆR2.
A
B
C
D
Since A Ã— Q and P Ã— R do not intersect, it follows the above expression is in E
because each of these terms are. This proves the corollary.
Deï¬nition 9.56 M âŠ†P(Z) is called a monotone class if
a.) Â· Â· Â·En âŠ‡En+1 Â· Â·Â·, E = âˆ©âˆž
n=1En, and En âˆˆM, then E âˆˆM.
b.) Â· Â· Â·En âŠ†En+1 Â· Â·Â·, E = âˆªâˆž
n=1En, and En âˆˆM, then E âˆˆM.
(In simpler notation, En â†“E and En âˆˆM implies E âˆˆM. En â†‘E and En âˆˆM
implies E âˆˆM.)
Theorem 9.57 (Monotone Class theorem) Let A be an algebra of subsets of Z and
let M be a monotone class containing A. Then M âŠ‡Ïƒ(A), the smallest Ïƒ-algebra
containing A.
Proof: Consider all monotone classes which contain A, and take their inter-
section. The result is still a monotone class which contains A and is therefore the
smallest monotone class containing A. Therefore, assume without loss of general-
ity that M is the smallest monotone class containing A because if it is shown the
smallest monotone class containing A contains Ïƒ (A), then the given monotone class
does also. To avoid more notation, let M denote this smallest monotone class.
The plan is to show M is a Ïƒ-algebra. It will then follow M âŠ‡Ïƒ(A) because
Ïƒ (A) is deï¬ned as the intersection of all Ïƒ algebras which contain A. For A âˆˆA,
deï¬ne
MA â‰¡{B âˆˆM such that A âˆªB âˆˆM}.
Clearly MA is a monotone class containing A. Hence MA âŠ‡M because M is
the smallest such monotone class.
But by construction, MA âŠ†M.
Therefore,

248
THE CONSTRUCTION OF MEASURES
M = MA. This shows that A âˆªB âˆˆM whenever A âˆˆA and B âˆˆM. Now pick
B âˆˆM and deï¬ne
MB â‰¡{D âˆˆM such that D âˆªB âˆˆM}.
It was just shown that A âŠ†MB. It is clear that MB is a monotone class. Thus
by a similar argument, MB = M and it follows that D âˆªB âˆˆM whenever D âˆˆM
and B âˆˆM. This shows M is closed under ï¬nite unions.
Next consider the diference of two sets. Let A âˆˆA
MA â‰¡{B âˆˆM such that B \ A and A \ B âˆˆM}.
Then MA, is a monotone class containing A. As before, M = MA. Thus B \ A
and A \ B are both in M whenever A âˆˆA and B âˆˆM. Now pick A âˆˆM and
consider
MA â‰¡{B âˆˆM such that B \ A and A \ B âˆˆM}.
It was just shown MA contains A. Now MA is a monotone class and so MA = M
as before.
Thus M is both a monotone class and an algebra.
Hence, if E âˆˆM then
Z \ E âˆˆM. Next consider the question of whether M is a Ïƒ-algebra. If Ei âˆˆM
and Fn = âˆªn
i=1Ei, then Fn âˆˆM and Fn â†‘âˆªâˆž
i=1Ei. Since M is a monotone class,
âˆªâˆž
i=1Ei âˆˆM and so M is a Ïƒ-algebra. This proves the theorem.
9.8.2
Product Measure
Deï¬nition 9.58 Let (X, S, Âµ) and (Y, F, Î») be two measure spaces. A measurable
rectangle is a set AÃ—B âŠ†X Ã—Y where A âˆˆS and B âˆˆF. An elementary set will be
any subset of X Ã—Y which is a ï¬nite union of disjoint measurable rectangles. S Ã—F
will denote the smallest Ïƒ algebra of sets in P(X Ã— Y ) containing all elementary
sets.
Example 9.59 It follows from Lemma 9.54 or more easily from Corollary 9.55
that the elementary sets form an algebra.
Deï¬nition 9.60 Let E âŠ†X Ã— Y,
Ex = {y âˆˆY : (x, y) âˆˆE},
Ey = {x âˆˆX : (x, y) âˆˆE}.
These are called the x and y sections.

9.8.
ALTERNATIVE TREATMENT OF PRODUCT MEASURE
249
x
X
Y
Ex
Theorem 9.61 If E âˆˆS Ã— F, then Ex âˆˆF and Ey âˆˆS for all x âˆˆX and y âˆˆY .
Proof: Let
M = {E âŠ†S Ã— F such that for all x âˆˆX,
Ex âˆˆF,
and for all y âˆˆY, Ey âˆˆS.}
Then M contains all measurable rectangles. If Ei âˆˆM,
(âˆªâˆž
i=1Ei)x = âˆªâˆž
i=1(Ei)x âˆˆF.
Similarly,
(âˆªâˆž
i=1Ei)y = âˆªâˆž
i=1Ey
i âˆˆS.
It follows M is closed under countable unions.
If E âˆˆM,
Â¡
ECÂ¢
x = (Ex)C âˆˆF.
Similarly,
Â¡
ECÂ¢y âˆˆS. Thus M is closed under complementation. Therefore M is a
Ïƒ-algebra containing the elementary sets. Hence, M âŠ‡S Ã— Fbecause S Ã— F is the
smallest Ïƒ algebra containing these elementary sets. But M âŠ†S Ã— Fby deï¬nition
and so M = S Ã— F. This proves the theorem.
It follows from Lemma 9.54 that the elementary sets form an algebra because
clearly the intersection of two measurable rectangles is a measurable rectangle and
(A Ã— B) \ (A0 Ã— B0) = (A \ A0) Ã— B âˆª(A âˆ©A0) Ã— (B \ B0),
an elementary set.
Theorem 9.62 If (X, S, Âµ) and (Y, F, Î») are both ï¬nite measure spaces (Âµ(X),
Î»(Y ) < âˆž), then for every E âˆˆS Ã— F,
a.) x â†’Î»(Ex) is Âµ measurable, y â†’Âµ(Ey) is Î» measurable
b.)
R
X Î»(Ex)dÂµ =
R
Y Âµ(Ey)dÎ».

250
THE CONSTRUCTION OF MEASURES
Proof: Let
M = {E âˆˆS Ã— F such that both a.) and b.) hold} .
Since Âµ and Î» are both ï¬nite, the monotone convergence and dominated convergence
theorems imply M is a monotone class.
Next I will argue M contains the elementary sets. Let
E = âˆªn
i=1Ai Ã— Bi
where the measurable rectangles, Ai Ã— Bi are disjoint. Then
Î» (Ex)
=
Z
Y
XE (x, y) dÎ» =
Z
Y
n
X
i=1
XAiÃ—Bi (x, y) dÎ»
=
n
X
i=1
Z
Y
XAiÃ—Bi (x, y) dÎ» =
n
X
i=1
XAi (x) Î» (Bi)
which is clearly Âµ measurable. Furthermore,
Z
X
Î» (Ex) dÂµ =
Z
X
n
X
i=1
XAi (x) Î» (Bi) dÂµ =
n
X
i=1
Âµ (Ai) Î» (Bi) .
Similarly,
Z
Y
Âµ (Ey) dÎ» =
n
X
i=1
Âµ (Ai) Î» (Bi)
and y â†’Âµ (Ey) is Î» measurable and this shows M contains the algebra of elemen-
tary sets. By the monotone class theorem, M = S Ã— F. This proves the theorem.
One can easily extend this theorem to the case where the measure spaces are Ïƒ
ï¬nite.
Theorem 9.63 If (X, S, Âµ) and (Y, F, Î») are both Ïƒ ï¬nite measure spaces, then for
every E âˆˆS Ã— F,
a.) x â†’Î»(Ex) is Âµ measurable, y â†’Âµ(Ey) is Î» measurable.
b.)
R
X Î»(Ex)dÂµ =
R
Y Âµ(Ey)dÎ».
Proof: Let X = âˆªâˆž
n=1Xn, Y = âˆªâˆž
n=1Yn where,
Xn âŠ†Xn+1, Yn âŠ†Yn+1, Âµ (Xn) < âˆž, Î»(Yn) < âˆž.
Let
Sn = {A âˆ©Xn : A âˆˆS}, Fn = {B âˆ©Yn : B âˆˆF}.
Thus (Xn, Sn, Âµ) and (Yn, Fn, Î») are both ï¬nite measure spaces.
Claim: If E âˆˆS Ã— F, then E âˆ©(Xn Ã— Yn) âˆˆSn Ã— Fn.
Proof: Let
Mn = {E âˆˆS Ã— F : E âˆ©(Xn Ã— Yn) âˆˆSn Ã— Fn} .

9.8.
ALTERNATIVE TREATMENT OF PRODUCT MEASURE
251
Clearly Mn contains the algebra of elementary sets. It is also clear that Mn is a
monotone class. Thus Mn = S Ã— F.
Now let E âˆˆS Ã— F. By Theorem 9.62,
Z
Xn
Î»((E âˆ©(Xn Ã— Yn))x)dÂµ =
Z
Yn
Âµ((E âˆ©(Xn Ã— Yn))y)dÎ»
(9.38)
where the integrands are measurable. Also
(E âˆ©(Xn Ã— Yn))x = âˆ…
if x /âˆˆXn and a similar observation holds for the second integrand in 9.38 if y /âˆˆYn.
Therefore,
Z
X
Î»((E âˆ©(Xn Ã— Yn))x)dÂµ
=
Z
Xn
Î»((E âˆ©(Xn Ã— Yn))x)dÂµ
=
Z
Yn
Âµ((E âˆ©(Xn Ã— Yn))y)dÎ»
=
Z
Y
Âµ((E âˆ©(Xn Ã— Yn))y)dÎ».
Then letting n â†’âˆž, the monotone convergence theorem implies b.)
and the
measurability assertions of a.) are valid because
Î» (Ex)
=
lim
nâ†’âˆžÎ»((E âˆ©(Xn Ã— Yn))x)
Âµ (Ey)
=
lim
nâ†’âˆžÂµ((E âˆ©(Xn Ã— Yn))y).
This proves the theorem.
This theorem makes it possible to deï¬ne product measure.
Deï¬nition 9.64 For E âˆˆS Ã— F and (X, S, Âµ), (Y, F, Î») Ïƒ ï¬nite, (Âµ Ã— Î»)(E) â‰¡
R
X Î»(Ex)dÂµ =
R
Y Âµ(Ey)dÎ».
This deï¬nition is well deï¬ned because of Theorem 9.63.
Theorem 9.65 If A âˆˆS, B âˆˆF, then (Âµ Ã— Î»)(A Ã— B) = Âµ(A)Î»(B), and Âµ Ã— Î» is
a measure on S Ã— F called product measure.
Proof: The ï¬rst assertion about the measure of a measurable rectangle was
established above. Now suppose {Ei}âˆž
i=1 is a disjoint collection of sets of S Ã— F.
Then using the monotone convergence theorem along with the observation that

252
THE CONSTRUCTION OF MEASURES
(Ei)x âˆ©(Ej)x = âˆ…,
(Âµ Ã— Î») (âˆªâˆž
i=1Ei)
=
Z
X
Î»((âˆªâˆž
i=1Ei)x)dÂµ
=
Z
X
Î» (âˆªâˆž
i=1 (Ei)x) dÂµ =
Z
X
âˆž
X
i=1
Î» ((Ei)x) dÂµ
=
âˆž
X
i=1
Z
X
Î» ((Ei)x) dÂµ
=
âˆž
X
i=1
(Âµ Ã— Î») (Ei)
This proves the theorem.
The next theorem is one of several theorems due to Fubini and Tonelli. These
theorems all have to do with interchanging the order of integration in a multiple
integral.
Theorem 9.66 Let f : X Ã— Y â†’[0, âˆž] be measurable with respect to S Ã— F and
suppose Âµ and Î» are Ïƒ ï¬nite. Then
Z
XÃ—Y
fd(Âµ Ã— Î») =
Z
X
Z
Y
f(x, y)dÎ»dÂµ =
Z
Y
Z
X
f(x, y)dÂµdÎ»
(9.39)
and all integrals make sense.
Proof: For E âˆˆS Ã— F,
Z
Y
XE(x, y)dÎ» = Î»(Ex),
Z
X
XE(x, y)dÂµ = Âµ(Ey).
Thus from Deï¬nition 9.64, 9.39 holds if f = XE. It follows that 9.39 holds for
every nonnegative simple function. By Theorem 8.27 on Page 190, there exists an
increasing sequence, {fn}, of simple functions converging pointwise to f. Then
Z
Y
f(x, y)dÎ» = lim
nâ†’âˆž
Z
Y
fn(x, y)dÎ»,
Z
X
f(x, y)dÂµ = lim
nâ†’âˆž
Z
X
fn(x, y)dÂµ.
This follows from the monotone convergence theorem. Since
x â†’
Z
Y
fn(x, y)dÎ»
is measurable with respect to S, it follows that x â†’
R
Y f(x, y)dÎ» is also measurable
with respect to S. A similar conclusion can be drawn about y â†’
R
X f(x, y)dÂµ. Thus
the two iterated integrals make sense. Since 9.39 holds for fn, another application
of the Monotone Convergence theorem shows 9.39 holds for f.
This proves the
theorem.

9.9.
COMPLETION OF MEASURES
253
Corollary 9.67 Let f : XÃ—Y â†’C be S Ã— F measurable. Suppose either
R
X
R
Y |f| dÎ»dÂµ
or
R
Y
R
X |f| dÂµdÎ» < âˆž. Then f âˆˆL1(X Ã— Y, Âµ Ã— Î») and
Z
XÃ—Y
fd(Âµ Ã— Î») =
Z
X
Z
Y
fdÎ»dÂµ =
Z
Y
Z
X
fdÂµdÎ»
(9.40)
with all integrals making sense.
Proof: Suppose ï¬rst that f is real valued.
Apply Theorem 9.66 to f +and
f âˆ’. 9.40 follows from observing that f = f + âˆ’f âˆ’; and that all integrals are ï¬nite.
If f is complex valued, consider real and imaginary parts. This proves the corollary.
Suppose f is product measurable. From the above discussion, and breaking f
down into a sum of positive and negative parts of real and imaginary parts and then
using Theorem 8.27 on Page 190 on approximation by simple functions, it follows
that whenever f is S Ã— F measurable, x â†’f (x, y) is Âµ measurable, y â†’f (x, y) is
Î» measurable.
9.9
Completion Of Measures
Suppose (â„¦, F, Âµ) is a measure space. Then it is always possible to enlarge the Ïƒ
algebra and deï¬ne a new measure Âµ on this larger Ïƒ algebra such that
Â¡
â„¦, F, Âµ
Â¢
is
a complete measure space. Recall this means that if N âŠ†N â€² âˆˆF and Âµ (N â€²) = 0,
then N âˆˆF. The following theorem is the main result. The new measure space is
called the completion of the measure space.
Theorem 9.68 Let (â„¦, F, Âµ) be a Ïƒ ï¬nite measure space.
Then there exists a
unique measure space,
Â¡
â„¦, F, Âµ
Â¢
satisfying
1.
Â¡
â„¦, F, Âµ
Â¢
is a complete measure space.
2. Âµ = Âµ on F
3. F âŠ‡F
4. For every E âˆˆF there exists G âˆˆF such that G âŠ‡E and Âµ (G) = Âµ (E) .
5. For every E âˆˆF there exists F âˆˆF such that F âŠ†E and Âµ (F) = Âµ (E) .
Also for every E âˆˆF there exist sets G, F âˆˆF such that G âŠ‡E âŠ‡F and
Âµ (G \ F) = Âµ (G \ F) = 0
(9.41)
Proof:
First consider the claim about uniqueness.
Suppose (â„¦, F1, Î½1) and
(â„¦, F2, Î½2) both work and let E âˆˆF1. Also let Âµ (â„¦n) < âˆž, Â· Â· Â·â„¦n âŠ†â„¦n+1 Â· Â·Â·, and
âˆªâˆž
n=1â„¦n = â„¦. Deï¬ne En â‰¡E âˆ©â„¦n. Then pick Gn âŠ‡En âŠ‡Fn such that Âµ (Gn) =

254
THE CONSTRUCTION OF MEASURES
Âµ (Fn) = Î½1 (En). It follows Âµ (Gn \ Fn) = 0. Then letting G = âˆªnGn, F â‰¡âˆªnFn,
it follows G âŠ‡E âŠ‡F and
Âµ (G \ F)
â‰¤
Âµ (âˆªn (Gn \ Fn))
â‰¤
X
n
Âµ (Gn \ Fn) = 0.
It follows that Î½2 (G \ F) = 0 also. Now E \ F âŠ†G \ F and since (â„¦, F2, Î½2) is
complete, it follows E \ F âˆˆF2. Since F âˆˆF2, it follows E = (E \ F) âˆªF âˆˆF2.
Thus F1 âŠ†F2. Similarly F2 âŠ†F1. Now it only remains to verify Î½1 = Î½2. Thus let
E âˆˆF1 = F2 and let G and F be as just described. Since Î½i = Âµ on F,
Âµ (F)
â‰¤
Î½1 (E)
=
Î½1 (E \ F) + Î½1 (F)
â‰¤
Î½1 (G \ F) + Î½1 (F)
=
Î½1 (F) = Âµ (F)
Similarly Î½2 (E) = Âµ (F) . This proves uniqueness. The construction has also veriï¬ed
9.41.
Next deï¬ne an outer measure, Âµ on P (â„¦) as follows. For S âŠ†â„¦,
Âµ (S) â‰¡inf {Âµ (E) : E âˆˆF} .
Then it is clear Âµ is increasing. It only remains to verify Âµ is subadditive. Then let
S = âˆªâˆž
i=1Si. If any Âµ (Si) = âˆž, there is nothing to prove so suppose Âµ (Si) < âˆžfor
each i. Then there exist Ei âˆˆF such that Ei âŠ‡Si and
Âµ (Si) + Îµ/2i > Âµ (Ei) .
Then
Âµ (S)
=
Âµ (âˆªiSi)
â‰¤
Âµ (âˆªiEi) â‰¤
X
i
Âµ (Ei)
â‰¤
X
i
Â¡
Âµ (Si) + Îµ/2iÂ¢
=
X
i
Âµ (Si) + Îµ.
Since Îµ is arbitrary, this veriï¬es Âµ is subadditive and is an outer measure as claimed.
Denote by F the Ïƒ algebra of measurable sets in the sense of Caratheodory.
Then it follows from the Caratheodory procedure, Theorem 9.4, on Page 210 that
Â¡
â„¦, F, Âµ
Â¢
is a complete measure space. This veriï¬es 1.
Now let E âˆˆF. Then from the deï¬nition of Âµ, it follows
Âµ (E) â‰¡inf {Âµ (F) : F âˆˆF and F âŠ‡E} â‰¤Âµ (E) .
If F âŠ‡E and F âˆˆF, then Âµ (F) â‰¥Âµ (E) and so Âµ (E) is a lower bound for all such
Âµ (F) which shows that
Âµ (E) â‰¡inf {Âµ (F) : F âˆˆF and F âŠ‡E} â‰¥Âµ (E) .

9.9.
COMPLETION OF MEASURES
255
This veriï¬es 2.
Next consider 3. Let E âˆˆF and let S be a set. I must show
Âµ (S) â‰¥Âµ (S \ E) + Âµ (S âˆ©E) .
If Âµ (S) = âˆžthere is nothing to show. Therefore, suppose Âµ (S) < âˆž. Then from
the deï¬nition of Âµ there exists G âŠ‡S such that G âˆˆF and Âµ (G) = Âµ (S) . Then
from the deï¬nition of Âµ,
Âµ (S)
â‰¤
Âµ (S \ E) + Âµ (S âˆ©E)
â‰¤
Âµ (G \ E) + Âµ (G âˆ©E)
=
Âµ (G) = Âµ (S)
This veriï¬es 3.
Claim 4 comes by the deï¬nition of Âµ as used above. The only other case is when
Âµ (S) = âˆž. However, in this case, you can let G = â„¦.
It only remains to verify 5. Let the â„¦n be as described above and let E âˆˆF
such that E âŠ†â„¦n. By 4 there exists H âˆˆF such that H âŠ†â„¦n, H âŠ‡â„¦n \ E, and
Âµ (H) = Âµ (â„¦n \ E) .
(9.42)
Then let F â‰¡â„¦n âˆ©HC. It follows F âŠ†E and
E \ F
=
E âˆ©F C = E âˆ©
Â¡
H âˆªâ„¦C
n
Â¢
=
E âˆ©H = H \ (â„¦n \ E)
Hence from 9.42
Âµ (E \ F) = Âµ (H \ (â„¦n \ E)) = 0.
It follows
Âµ (E) = Âµ (F) = Âµ (F) .
In the case where E âˆˆF is arbitrary, not necessarily contained in some â„¦n, it
follows from what was just shown that there exists Fn âˆˆF such that Fn âŠ†E âˆ©â„¦n
and
Âµ (Fn) = Âµ (E âˆ©â„¦n) .
Letting F â‰¡âˆªnFn
Âµ (E \ F) â‰¤Âµ (âˆªn (E âˆ©â„¦n \ Fn)) â‰¤
X
n
Âµ (E âˆ©â„¦n \ Fn) = 0.
Therefore, Âµ (E) = Âµ (F) and this proves 5. This proves the theorem.
Now here is an interesting theorem about complete measure spaces.
Theorem 9.69 Let (â„¦, F, Âµ) be a complete measure space and let f â‰¤g â‰¤h be
functions having values in [0, âˆž] . Suppose also that f (Ï‰) = h (Ï‰) a.e. Ï‰ and that
f and h are measurable. Then g is also measurable. If
Â¡
â„¦, F, Âµ
Â¢
is the completion

256
THE CONSTRUCTION OF MEASURES
of a Ïƒ ï¬nite measure space (â„¦, F, Âµ) as described above in Theorem 9.68 then if f
is measurable with respect to F
having values in [0, âˆž] , it follows there exists g
measurable with respect to F , g â‰¤f, and a set N âˆˆF with Âµ (N) = 0 and g = f
on N C. There also exists h measurable with respect to F such that h â‰¥f, and a
set of measure zero, M âˆˆF such that f = h on M C.
Proof: Let Î± âˆˆR.
[f > Î±] âŠ†[g > Î±] âŠ†[h > Î±]
Thus
[g > Î±] = [f > Î±] âˆª([g > Î±] \ [f > Î±])
and [g > Î±] \ [f > Î±] is a measurable set because it is a subset of the set of measure
zero,
[h > Î±] \ [f > Î±] .
Now consider the last assertion. By Theorem 8.27 on Page 190 there exists an
increasing sequence of nonnegative simple functions, {sn} measurable with respect
to F which converges pointwise to f. Letting
sn (Ï‰) =
mn
X
k=1
cn
kXEn
k (Ï‰)
(9.43)
be one of these simple functions, it follows from Theorem 9.68 there exist sets,
F n
k âˆˆF such that F n
k âŠ†En
k and Âµ (F n
k ) = Âµ (En
k ) . Then let
tn (Ï‰) â‰¡
mn
X
k=1
cn
kXF n
k (Ï‰) .
Thus tn = sn oï¬€a set of measure zero, Nn âˆˆF, tn â‰¤sn. Let N â€² â‰¡âˆªnNn. Then by
Theorem 9.68 again, there exists N âˆˆF such that N âŠ‡N â€² and Âµ (N) = 0. Consider
the simple functions,
sâ€²
n (Ï‰) â‰¡tn (Ï‰) XN C (Ï‰) .
It is an increasing sequence so let g (Ï‰) = limnâ†’âˆžsnâ€² (Ï‰) . It follows g is mesurable
with respect to F and equals f oï¬€N.
Finally, to obtain the function, h â‰¥f, in 9.43 use Theorem 9.68 to obtain the
existence of F n
k âˆˆF such that F n
k âŠ‡En
k and Âµ (F n
k ) = Âµ (En
k ). Then let
tn (Ï‰) â‰¡
mn
X
k=1
cn
kXF n
k (Ï‰) .
Thus tn = sn oï¬€a set of measure zero, Mn âˆˆF, tn â‰¥sn, and tn is measurable with
respect to F. Then deï¬ne
sâ€²
n = max
kâ‰¤n tn.
It follows sâ€²
n is an increasing sequence of F measurable nonnegative simple functions.
Since each sâ€²
n â‰¥sn, it follows that if h (Ï‰) = limnâ†’âˆžsâ€²
n (Ï‰) ,then h (Ï‰) â‰¥f (Ï‰) .
Also if h (Ï‰) > f (Ï‰) , then Ï‰ âˆˆâˆªnMn â‰¡M â€², a set of F having measure zero. By
Theorem 9.68, there exists M âŠ‡M â€² such that M âˆˆF and Âµ (M) = 0. It follows
h = f oï¬€M. This proves the theorem.

9.10.
ANOTHER VERSION OF PRODUCT MEASURES
257
9.10
Another Version Of Product Measures
9.10.1
General Theory
Given two ï¬nite measure spaces, (X, F, Âµ) and (Y, S, Î½) , there is a way to deï¬ne a
Ïƒ algebra of subsets of X Ã— Y , denoted by F Ã— S and a measure, denoted by Âµ Ã— Î½
deï¬ned on this Ïƒ algebra such that
Âµ Ã— Î½ (A Ã— B) = Âµ (A) Î» (B)
whenever A âˆˆF and B âˆˆS. This is naturally related to the concept of iterated
integrals similar to what is used in calculus to evaluate a multiple integral. The
approach is based on something called a Ï€ system, [15].
Deï¬nition 9.70 Let (X, F, Âµ) and (Y, S, Î½) be two measure spaces. A measurable
rectangle is a set of the form A Ã— B where A âˆˆF and B âˆˆS.
Deï¬nition 9.71 Let â„¦be a set and let K be a collection of subsets of â„¦. Then K
is called a Ï€ system if âˆ…âˆˆK and whenever A, B âˆˆK, it follows A âˆ©B âˆˆK.
Obviously an example of a Ï€ system is the set of measurable rectangles because
A Ã— B âˆ©Aâ€² Ã— Bâ€² = (A âˆ©Aâ€²) Ã— (B âˆ©Bâ€²) .
The following is the fundamental lemma which shows these Ï€ systems are useful.
Lemma 9.72 Let K be a Ï€ system of subsets of â„¦, a set. Also let G be a collection
of subsets of â„¦which satisï¬es the following three properties.
1. K âŠ†G
2. If A âˆˆG, then AC âˆˆG
3. If {Ai}âˆž
i=1 is a sequence of disjoint sets from G then âˆªâˆž
i=1Ai âˆˆG.
Then G âŠ‡Ïƒ (K) , where Ïƒ (K) is the smallest Ïƒ algebra which contains K.
Proof: First note that if
H â‰¡{G : 1 - 3 all hold}
then âˆ©H yields a collection of sets which also satisï¬es 1 - 3. Therefore, I will assume
in the argument that G is the smallest collection satisfying 1 - 3. Let A âˆˆK and
deï¬ne
GA â‰¡{B âˆˆG : A âˆ©B âˆˆG} .
I want to show GA satisï¬es 1 - 3 because then it must equal G since G is the smallest
collection of subsets of â„¦which satisï¬es 1 - 3. This will give the conclusion that for
A âˆˆK and B âˆˆG, A âˆ©B âˆˆG. This information will then be used to show that if

258
THE CONSTRUCTION OF MEASURES
A, B âˆˆG then A âˆ©B âˆˆG. From this it will follow very easily that G is a Ïƒ algebra
which will imply it contains Ïƒ (K). Now here are the details of the argument.
Since K is given to be a Ï€ system, K âŠ†GA. Property 3 is obvious because if
{Bi} is a sequence of disjoint sets in GA, then
A âˆ©âˆªâˆž
i=1Bi = âˆªâˆž
i=1A âˆ©Bi âˆˆG
because A âˆ©Bi âˆˆG and the property 3 of G.
It remains to verify Property 2 so let B âˆˆGA. I need to verify that BC âˆˆGA.
In other words, I need to show that A âˆ©BC âˆˆG. However,
A âˆ©BC =
Â¡
AC âˆª(A âˆ©B)
Â¢C âˆˆG
Here is why. Since B âˆˆGA, A âˆ©B âˆˆG and since A âˆˆK âŠ†G it follows AC âˆˆG. It
follows the union of the disjoint sets, AC and (A âˆ©B) is in G and then from 2 the
complement of their union is in G. Thus GA satisï¬es 1 - 3 and this implies since G is
the smallest such, that GA âŠ‡G. However, GA is constructed as a subset of G. This
proves that for every B âˆˆG and A âˆˆK, A âˆ©B âˆˆG. Now pick B âˆˆG and consider
GB â‰¡{A âˆˆG : A âˆ©B âˆˆG} .
I just proved K âŠ†GB. The other arguments are identical to show GB satisï¬es 1 - 3
and is therefore equal to G. This shows that whenever A, B âˆˆG it follows Aâˆ©B âˆˆG.
This implies G is a Ïƒ algebra. To show this, all that is left is to verify G is closed
under countable unions because then it follows G is a Ïƒ algebra. Let {Ai} âŠ†G.
Then let Aâ€²
1 = A1 and
Aâ€²
n+1
â‰¡
An+1 \ (âˆªn
i=1Ai)
=
An+1 âˆ©
Â¡
âˆ©n
i=1AC
i
Â¢
=
âˆ©n
i=1
Â¡
An+1 âˆ©AC
i
Â¢
âˆˆG
because ï¬nite intersections of sets of G are in G. Since the Aâ€²
i are disjoint, it follows
âˆªâˆž
i=1Ai = âˆªâˆž
i=1Aâ€²
i âˆˆG
Therefore, G âŠ‡Ïƒ (K) and this proves the Lemma.
With this lemma, it is easy to deï¬ne product measure.
Let (X, F, Âµ) and (Y, S, Î½) be two ï¬nite measure spaces. Deï¬ne K to be the set
of measurable rectangles, A Ã— B, A âˆˆF and B âˆˆS. Let
G â‰¡
Â½
E âŠ†X Ã— Y :
Z
Y
Z
X
XEdÂµdÎ½ =
Z
X
Z
Y
XEdÎ½dÂµ
Â¾
(9.44)
where in the above, part of the requirement is for all integrals to make sense.
Then K âŠ†G. This is obvious.

9.10.
ANOTHER VERSION OF PRODUCT MEASURES
259
Next I want to show that if E âˆˆG then EC âˆˆG. Observe XEC = 1 âˆ’XE and so
Z
Y
Z
X
XECdÂµdÎ½
=
Z
Y
Z
X
(1 âˆ’XE) dÂµdÎ½
=
Z
X
Z
Y
(1 âˆ’XE) dÎ½dÂµ
=
Z
X
Z
Y
XECdÎ½dÂµ
which shows that if E âˆˆG, then EC âˆˆG.
Next I want to show G is closed under countable unions of disjoint sets of G. Let
{Ai} be a sequence of disjoint sets from G. Then
Z
Y
Z
X
Xâˆªâˆž
i=1AidÂµdÎ½
=
Z
Y
Z
X
âˆž
X
i=1
XAidÂµdÎ½
=
Z
Y
âˆž
X
i=1
Z
X
XAidÂµdÎ½
=
âˆž
X
i=1
Z
Y
Z
X
XAidÂµdÎ½
=
âˆž
X
i=1
Z
X
Z
Y
XAidÎ½dÂµ
=
Z
X
âˆž
X
i=1
Z
Y
XAidÎ½dÂµ
=
Z
X
Z
Y
âˆž
X
i=1
XAidÎ½dÂµ
=
Z
X
Z
Y
Xâˆªâˆž
i=1AidÎ½dÂµ,
(9.45)
the interchanges between the summation and the integral depending on the mono-
tone convergence theorem.
Thus G is closed with respect to countable disjoint
unions.
From Lemma 9.72, G âŠ‡Ïƒ (K) . Also the computation in 9.45 implies that on
Ïƒ (K) one can deï¬ne a measure, denoted by Âµ Ã— Î½ and that for every E âˆˆÏƒ (K) ,
(Âµ Ã— Î½) (E) =
Z
Y
Z
X
XEdÂµdÎ½ =
Z
X
Z
Y
XEdÎ½dÂµ.
(9.46)
Now here is Fubiniâ€™s theorem.
Theorem 9.73 Let f : X Ã—Y â†’[0, âˆž] be measurable with respect to the Ïƒ algebra,
Ïƒ (K) just deï¬ned and let Âµ Ã— Î½ be the product measure of 9.46 where Âµ and Î½ are
ï¬nite measures on (X, F) and (Y, S) respectively. Then
Z
XÃ—Y
fd (Âµ Ã— Î½) =
Z
Y
Z
X
fdÂµdÎ½ =
Z
X
Z
Y
fdÎ½dÂµ.

260
THE CONSTRUCTION OF MEASURES
Proof: Let {sn} be an increasing sequence of Ïƒ (K) measurable simple functions
which converges pointwise to f. The above equation holds for sn in place of f from
what was shown above. The ï¬nal result follows from passing to the limit and using
the monotone convergence theorem. This proves the theorem.
The symbol, F Ã— S denotes Ïƒ (K).
Of course one can generalize right away to measures which are only Ïƒ ï¬nite.
Theorem 9.74 Let f : X Ã—Y â†’[0, âˆž] be measurable with respect to the Ïƒ algebra,
Ïƒ (K) just deï¬ned and let Âµ Ã— Î½ be the product measure of 9.46 where Âµ and Î½ are
Ïƒ ï¬nite measures on (X, F) and (Y, S) respectively. Then
Z
XÃ—Y
fd (Âµ Ã— Î½) =
Z
Y
Z
X
fdÂµdÎ½ =
Z
X
Z
Y
fdÎ½dÂµ.
Proof: Since the measures are Ïƒ ï¬nite, there exist increasing sequences of sets,
{Xn} and {Yn} such that Âµ (Xn) < âˆžand Âµ (Yn) < âˆž. Then Âµ and Î½ restricted
to Xn and Yn respectively are ï¬nite. Then from Theorem 9.73,
Z
Yn
Z
Xn
fdÂµdÎ½ =
Z
Xn
Z
Yn
fdÎ½dÂµ
Passing to the limit yields
Z
Y
Z
X
fdÂµdÎ½ =
Z
X
Z
Y
fdÎ½dÂµ
whenever f is as above. In particular, you could take f = XE where E âˆˆF Ã— S
and deï¬ne
(Âµ Ã— Î½) (E) â‰¡
Z
Y
Z
X
XEdÂµdÎ½ =
Z
X
Z
Y
XEdÎ½dÂµ.
Then just as in the proof of Theorem 9.73, the conclusion of this theorem is obtained.
This proves the theorem.
It is also useful to note that all the above holds for Qn
i=1 Xi in place of X Ã— Y.
You would simply modify the deï¬nition of G in 9.44 including all permutations for
the iterated integrals and for K you would use sets of the form Qn
i=1 Ai where Ai
is measurable. Everything goes through exactly as above. Thus the following is
obtained.
Theorem 9.75 Let {(Xi, Fi, Âµi)}n
i=1 be Ïƒ ï¬nite measure spaces and let Qn
i=1 Fi de-
note the smallest Ïƒ algebra which contains the measurable boxes of the form Qn
i=1 Ai
where Ai âˆˆFi. Then there exists a measure, Î» deï¬ned on Qn
i=1 Fi such that if
f : Qn
i=1 Xi â†’[0, âˆž] is Qn
i=1 Fi measurable, and (i1, Â· Â· Â·, in) is any permutation of
(1, Â· Â· Â·, n) , then
Z
fdÎ» =
Z
Xin
Â· Â· Â·
Z
Xi1
fdÂµi1 Â· Â· Â· dÂµin

9.10.
ANOTHER VERSION OF PRODUCT MEASURES
261
9.10.2
Completion Of Product Measure Spaces
Using Theorem 9.69 it is easy to give a generalization to yield a theorem for the
completion of product spaces.
Theorem 9.76 Let {(Xi, Fi, Âµi)}n
i=1 be Ïƒ ï¬nite measure spaces and let Qn
i=1 Fi de-
note the smallest Ïƒ algebra which contains the measurable boxes of the form Qn
i=1 Ai
where Ai âˆˆFi. Then there exists a measure, Î» deï¬ned on Qn
i=1 Fi such that if
f : Qn
i=1 Xi â†’[0, âˆž] is Qn
i=1 Fi measurable, and (i1, Â· Â· Â·, in) is any permutation of
(1, Â· Â· Â·, n) , then
Z
fdÎ» =
Z
Xin
Â· Â· Â·
Z
Xi1
fdÂµi1 Â· Â· Â· dÂµin
Let
Â³Qn
i=1 Xi, Qn
i=1 Fi, Î»
Â´
denote the completion of this product measure space and
let
f :
n
Y
i=1
Xi â†’[0, âˆž]
be Qn
i=1 Fi measurable. Then there exists N âˆˆQn
i=1 Fi such that Î» (N) = 0 and a
nonnegative function, f1 measurable with respect to Qn
i=1 Fi
such that f1 = f oï¬€
N and if (i1, Â· Â· Â·, in) is any permutation of (1, Â· Â· Â·, n) , then
Z
fdÎ» =
Z
Xin
Â· Â· Â·
Z
Xi1
f1dÂµi1 Â· Â· Â· dÂµin.
Furthermore, f1 may be chosen to satisfy either f1 â‰¤f or f1 â‰¥f.
Proof: This follows immediately from Theorem 9.75 and Theorem 9.69. By the
second theorem, there exists a function f1 â‰¥f such that f1 = f for all (x1, Â· Â· Â·, xn) /âˆˆ
N, a set of Qn
i=1 Fi having measure zero. Then by Theorem 9.68 and Theorem 9.75
Z
fdÎ» =
Z
f1dÎ» =
Z
Xin
Â· Â· Â·
Z
Xi1
f1dÂµi1 Â· Â· Â· dÂµin.
To get f1 â‰¤f, just use that part of Theorem 9.69.
Since f1 = f oï¬€a set of measure zero, I will dispense with the subscript. Also
it is customary to write
Î» = Âµ1 Ã— Â· Â· Â· Ã— Âµn
and
Î» = Âµ1 Ã— Â· Â· Â· Ã— Âµn.
Thus in more standard notation, one writes
Z
fd (Âµ1 Ã— Â· Â· Â· Ã— Âµn) =
Z
Xin
Â· Â· Â·
Z
Xi1
fdÂµi1 Â· Â· Â· dÂµin
This theorem is often referred to as Fubiniâ€™s theorem. The next theorem is also
called this.

262
THE CONSTRUCTION OF MEASURES
Corollary 9.77 Suppose f âˆˆL1 Â³Qn
i=1 Xi, Qn
i=1 Fi, Âµ1 Ã— Â· Â· Â· Ã— Âµn
Â´
where each Xi
is a Ïƒ ï¬nite measure space. Then if (i1, Â· Â· Â·, in) is any permutation of (1, Â· Â· Â·, n) , it
follows
Z
fd (Âµ1 Ã— Â· Â· Â· Ã— Âµn) =
Z
Xin
Â· Â· Â·
Z
Xi1
fdÂµi1 Â· Â· Â· dÂµin.
Proof: Just apply Theorem 9.76 to the positive and negative parts of the real
and imaginary parts of f. This proves the theorem.
Here is another easy corollary.
Corollary 9.78 Suppose in the situation of Corollary 9.77, f = f1 oï¬€N, a set of
Qn
i=1 Fi having Âµ1 Ã— Â· Â· Â· Ã— Âµn measure zero and that f1 is a complex valued function
measurable with respect to Qn
i=1 Fi.
Suppose also that for some permutation of
(1, 2, Â· Â· Â·, n) , (j1, Â· Â· Â·, jn)
Z
Xjn
Â· Â· Â·
Z
Xj1
|f1| dÂµj1 Â· Â· Â· dÂµjn < âˆž.
Then
f âˆˆL1
Ãƒ n
Y
i=1
Xi,
n
Y
i=1
Fi, Âµ1 Ã— Â· Â· Â· Ã— Âµn
!
and the conclusion of Corollary 9.77 holds.
Proof: Since |f1| is Qn
i=1 Fi measurable, it follows from Theorem 9.75 that
âˆž
>
Z
Xjn
Â· Â· Â·
Z
Xj1
|f1| dÂµj1 Â· Â· Â· dÂµjn
=
Z
|f1| d (Âµ1 Ã— Â· Â· Â· Ã— Âµn)
=
Z
|f1| d (Âµ1 Ã— Â· Â· Â· Ã— Âµn)
=
Z
|f| d (Âµ1 Ã— Â· Â· Â· Ã— Âµn) .
Thus f âˆˆL1 Â³Qn
i=1 Xi, Qn
i=1 Fi, Âµ1 Ã— Â· Â· Â· Ã— Âµn
Â´
as claimed and the rest follows from
Corollary 9.77. This proves the corollary.
The following lemma is also useful.
Lemma 9.79 Let (X, F, Âµ) and (Y, S, Î½) be Ïƒ ï¬nite complete measure spaces and
suppose f â‰¥0 is F Ã— S measurable. Then for a.e. x,
y â†’f (x, y)
is S measurable. Similarly for a.e. y,
x â†’f (x, y)
is F measurable.

9.11.
DISTURBING EXAMPLES
263
Proof: By Theorem 9.69, there exist F Ã— S measurable functions, g and h and
a set, N âˆˆF Ã— S of Âµ Ã— Î» measure zero such that g â‰¤f â‰¤h and for (x, y) /âˆˆN, it
follows that g (x, y) = h (x, y) . Then
Z
X
Z
Y
gdÎ½dÂµ =
Z
X
Z
Y
hdÎ½dÂµ
and so for a.e. x,
Z
Y
gdÎ½ =
Z
Y
hdÎ½.
Then it follows that for these values of x, g (x, y) = h (x, y) and so by Theorem 9.69
again and the assumption that (Y, S, Î½) is complete, y â†’f (x, y) is S measurable.
The other claim is similar. This proves the lemma.
9.11
Disturbing Examples
There are examples which help to deï¬ne what can be expected of product measures
and Fubini type theorems.
Three such examples are given in Rudin [45].
The
theorems given above are more general than those in this reference but the same
examples are still useful for showing that the hypotheses of the above theorems are
all necessary.
Example 9.80 Let {an} be an increasing sequence of numbers in (0, 1) which
converges to 1. Let gn âˆˆCc (an, an+1) such that
R
gndx = 1. Now for (x, y) âˆˆ
[0, 1) Ã— [0, 1) deï¬ne
f (x, y) â‰¡
âˆž
X
k=1
gn (y) (gn (x) âˆ’gn+1 (x)) .
Note this is actually a ï¬nite sum for each such (x, y) . Therefore, this is a continuous
function on [0, 1) Ã— [0, 1). Now for a ï¬xed y,
Z 1
0
f (x, y) dx =
âˆž
X
k=1
gn (y)
Z 1
0
(gn (x) âˆ’gn+1 (x)) dx = 0
showing that
R 1
0
R 1
0 f (x, y) dxdy =
R 1
0 0dy = 0. Next ï¬x x.
Z 1
0
f (x, y) dy =
âˆž
X
k=1
(gn (x) âˆ’gn+1 (x))
Z 1
0
gn (y) dy = g1 (x) .
Hence
R 1
0
R 1
0 f (x, y) dydx =
R 1
0 g1 (x) dx = 1. The iterated integrals are not equal.
Note the function, g is not nonnegative even though it is measurable. In addition,
neither
R 1
0
R 1
0 |f (x, y)| dxdy nor
R 1
0
R 1
0 |f (x, y)| dydx is ï¬nite and so you canâ€™t apply
Corollary 9.52.
The problem here is the function is not nonnegative and is not
absolutely integrable.

264
THE CONSTRUCTION OF MEASURES
Example 9.81 This time let Âµ = m, Lebesgue measure on [0, 1] and let Î½ be count-
ing measure on [0, 1] , in this case, the Ïƒ algebra is P ([0, 1]) . Let l denote the line
segment in [0, 1] Ã— [0, 1] which goes from (0, 0) to (1, 1).
Thus l = (x, x) where
x âˆˆ[0, 1] . Consider the outer measure of l in m Ã— Î½. Let l âŠ†âˆªkAk Ã— Bk where Ak
is Lebesgue measurable and Bk is a subset of [0, 1] . Let B â‰¡{k âˆˆN : Î½ (Bk) = âˆž} .
If m (âˆªkâˆˆBAk) has measure zero, then there are uncountably many points of [0, 1]
outside of âˆªkâˆˆBAk. For p one of these points, (p, p) âˆˆAi Ã—Bi and i /âˆˆB. Thus each
of these points is in âˆªi/âˆˆBBi, a countable set because these Bi are each ï¬nite. But
this is a contradiction because there need to be uncountably many of these points as
just indicated. Thus m (Ak) > 0 for some k âˆˆB and so m Ã— Î½ (Ak Ã— Bk) = âˆž. It
follows m Ã— Î½ (l) = âˆžand so l is m Ã— Î½ measurable. Thus
R
Xl (x, y) d m Ã— Î½ = âˆž
and so you cannot apply Fubiniâ€™s theorem, Theorem 9.50. Since Î½ is not Ïƒ ï¬nite,
you cannot apply the corollary to this theorem either. Thus there is no contradiction
to the above theorems in the following observation.
Z Z
Xl (x, y) dÎ½dm =
Z
1dm = 1,
Z Z
Xl (x, y) dmdÎ½ =
Z
0dÎ½ = 0.
The problem here is that you have neither
R
fd m Ã— Î½ < âˆžnot Ïƒ ï¬nite measure
spaces.
The next example is far more exotic. It concerns the case where both iterated
integrals make perfect sense but are unequal. In 1877 Cantor conjectured that the
cardinality of the real numbers is the next size of inï¬nity after countable inï¬nity.
This hypothesis is called the continuum hypothesis and it has never been proved
or disproved4. Assuming this continuum hypothesis will provide the basis for the
following example. It is due to Sierpinski.
Example 9.82 Let X be an uncountable set.
It follows from the well ordering
theorem which says every set can be well ordered which is presented in the ap-
pendix that X can be well ordered. Let Ï‰ âˆˆX be the ï¬rst element of X which is
preceded by uncountably many points of X. Let â„¦denote {x âˆˆX : x < Ï‰} . Then
â„¦is uncountable but there is no smaller uncountable set.
Thus by the contin-
uum hypothesis, there exists a one to one and onto mapping, j which maps [0, 1]
onto â„¦. Thus, for x âˆˆ[0, 1] , j (x) is preceeded by countably many points.
Let
Q â‰¡
n
(x, y) âˆˆ[0, 1]2 : j (x) < j (y)
o
and let f (x, y) = XQ (x, y) . Then
Z 1
0
f (x, y) dy = 1,
Z 1
0
f (x, y) dx = 0
In each case, the integrals make sense. In the ï¬rst, for ï¬xed x, f (x, y) = 1 for all
but countably many y so the function of y is Borel measurable. In the second where
4In 1940 it was shown by Godel that the continuum hypothesis cannot be disproved. In 1963 it
was shown by Cohen that the continuum hypothesis cannot be proved. These assertions are based
on the axiom of choice and the Zermelo Frankel axioms of set theory. This topic is far outside the
scope of this book and this is only a hopefully interesting historical observation.

9.12.
EXERCISES
265
y is ï¬xed, f (x, y) = 0 for all but countably many x. Thus
Z 1
0
Z 1
0
f (x, y) dydx = 1,
Z 1
0
Z 1
0
f (x, y) dxdy = 0.
The problem here must be that f is not m Ã— m measurable.
9.12
Exercises
1. Let â„¦= N, the natural numbers and let d (p, q) = |p âˆ’q|, the usual dis-
tance in R. Show that (â„¦, d) the closures of the balls are compact. Now let
Î›f â‰¡Pâˆž
k=1 f (k) whenever f âˆˆCc (â„¦). Show this is a well deï¬ned positive
linear functional on the space Cc (â„¦). Describe the measure of the Riesz rep-
resentation theorem which results from this positive linear functional. What
if Î› (f) = f (1)? What measure would result from this functional? Which
functions are measurable?
2. Verify that Âµ deï¬ned in Lemma 9.7 is an outer measure.
3. Let F : R â†’R be increasing and right continuous. Let Î›f â‰¡
R
fdF where
the integral is the Riemann Stieltjes integral of f. Show the measure Âµ from
the Riesz representation theorem satisï¬es
Âµ ([a, b])
=
F (b) âˆ’F (aâˆ’) , Âµ ((a, b]) = F (b) âˆ’F (a) ,
Âµ ([a, a])
=
F (a) âˆ’F (aâˆ’) .
4. Let â„¦be a metric space with the closed balls compact and suppose Âµ is a
measure deï¬ned on the Borel sets of â„¦which is ï¬nite on compact sets. Show
there exists a unique Radon measure, Âµ which equals Âµ on the Borel sets.
5. â†‘Random vectors are measurable functions, X, mapping a probability space,
(â„¦, P, F) to Rn. Thus X (Ï‰) âˆˆRn for each Ï‰ âˆˆâ„¦and P is a probability
measure deï¬ned on the sets of F, a Ïƒ algebra of subsets of â„¦. For E a Borel
set in Rn, deï¬ne
Âµ (E) â‰¡P
Â¡
Xâˆ’1 (E)
Â¢
â‰¡probability that X âˆˆE.
Show this is a well deï¬ned measure on the Borel sets of Rn and use Problem 4
to obtain a Radon measure, Î»X deï¬ned on a Ïƒ algebra of sets of Rn including
the Borel sets such that for E a Borel set, Î»X (E) =Probability that (X âˆˆE).
6. Suppose X and Y are metric spaces having compact closed balls. Show
(X Ã— Y, dXÃ—Y )
is also a metric space which has the closures of balls compact. Here
dXÃ—Y ((x1, y1) , (x2, y2)) â‰¡max (d (x1, x2) , d (y1, y2)) .

266
THE CONSTRUCTION OF MEASURES
Let
A â‰¡{E Ã— F : E is a Borel set in X, F is a Borel set in Y } .
Show Ïƒ (A), the smallest Ïƒ algebra containing A contains the Borel sets. Hint:
Show every open set in a metric space which has closed balls compact can be
obtained as a countable union of compact sets. Next show this implies every
open set can be obtained as a countable union of open sets of the form U Ã— V
where U is open in X and V is open in Y .
7. Suppose (â„¦, S, Âµ) is a measure space which may not be complete. Could you
obtain a complete measure space,
Â¡
â„¦, S, Âµ1
Â¢
by simply letting S consist of all
sets of the form E where there exists F âˆˆS such that (F \ E) âˆª(E \ F) âŠ†N
for some N âˆˆS which has measure zero and then let Âµ (E) = Âµ1 (F)?
8. If Âµ and Î½ are Radon measures deï¬ned on Rn and Rm respectively, show
Âµ Ã— Î½ is also a radon measure on Rn+m. Hint: Show the Âµ Ã— Î½ measurable
sets include the open sets using the observation that every open set in Rn+m
is the countable union of sets of the form U Ã— V where U and V are open in
Rn and Rm respectively. Next verify outer regularity by considering A Ã— B
for A, B measurable. Argue sets of R deï¬ned above have the property that
they can be approximated in measure from above by open sets. Then verify
the same is true of sets of R1. Finally conclude using an appropriate lemma
that Âµ Ã— Î½ is inner regular as well.
9. Let (â„¦, S, Âµ) be a Ïƒ ï¬nite measure space and let f : â„¦â†’[0, âˆž) be measurable.
Deï¬ne
A â‰¡{(x, y) : y < f (x)}
Verify that A is Âµ Ã— m measurable. Show that
Z
fdÂµ =
Z Z
XA (x, y) dÂµdm =
Z
XAdÂµ Ã— m.

Lebesgue Measure
10.1
Basic Properties
Deï¬nition 10.1 Deï¬ne the following positive linear functional for f âˆˆCc (Rn) .
Î›f â‰¡
Z âˆž
âˆ’âˆž
Â· Â· Â·
Z âˆž
âˆ’âˆž
f (x) dx1 Â· Â· Â· dxn.
Then the measure representing this functional is Lebesgue measure.
The following lemma will help in understanding Lebesgue measure.
Lemma 10.2 Every open set in Rn is the countable disjoint union of half open
boxes of the form
n
Y
i=1
(ai, ai + 2âˆ’k]
where ai = l2âˆ’k for some integers, l, k. The sides of these boxes are of equal length.
One could also have half open boxes of the form
n
Y
i=1
[ai, ai + 2âˆ’k)
and the conclusion would be unchanged.
Proof: Let
Ck = {All half open boxes
n
Y
i=1
(ai, ai + 2âˆ’k] where
ai = l2âˆ’k for some integer l.}
Thus Ck consists of a countable disjoint collection of boxes whose union is Rn. This
is sometimes called a tiling of Rn. Think of tiles on the ï¬‚oor of a bathroom and
267

268
LEBESGUE MEASURE
you will get the idea. Note that each box has diameter no larger than 2âˆ’kâˆšn. This
is because if
x, y âˆˆ
n
Y
i=1
(ai, ai + 2âˆ’k],
then |xi âˆ’yi| â‰¤2âˆ’k. Therefore,
|x âˆ’y| â‰¤
Ãƒ n
X
i=1
Â¡
2âˆ’kÂ¢2
!1/2
= 2âˆ’kâˆšn.
Let U be open and let B1 â‰¡all sets of C1 which are contained in U. If B1, Â· Â· Â·, Bk
have been chosen, Bk+1 â‰¡all sets of Ck+1 contained in
U \ âˆª
Â¡
âˆªk
i=1Bi
Â¢
.
Let Bâˆž= âˆªâˆž
i=1Bi. In fact âˆªBâˆž= U. Clearly âˆªBâˆžâŠ†U because every box of every
Bi is contained in U. If p âˆˆU, let k be the smallest integer such that p is contained
in a box from Ck which is also a subset of U. Thus
p âˆˆâˆªBk âŠ†âˆªBâˆž.
Hence Bâˆžis the desired countable disjoint collection of half open boxes whose union
is U. The last assertion about the other type of half open rectangle is obvious. This
proves the lemma.
Now what does Lebesgue measure do to a rectangle, Qn
i=1(ai, bi]?
Lemma 10.3 Let R = Qn
i=1[ai, bi], R0 = Qn
i=1(ai, bi). Then
mn (R0) = mn (R) =
n
Y
i=1
(bi âˆ’ai).
Proof: Let k be large enough that
ai + 1/k < bi âˆ’1/k
for i = 1, Â· Â· Â·, n and consider functions gk
i and f k
i having the following graphs.
ai + 1
k
@
@
R
ai
Â£
Â£
Â£Â£
1
B
B
BB
bi âˆ’1
k
Â¡
Â¡
Âª
bi
f k
i
ai âˆ’1
k
@
@
@
R
ai
Â£
Â£
Â£Â£
1
B
B
BB
bi
bi + 1
k
Â¡
Â¡
Âª
gk
i
Let
gk(x) =
n
Y
i=1
gk
i (xi), f k(x) =
n
Y
i=1
f k
i (xi).

10.1.
BASIC PROPERTIES
269
Then by elementary calculus along with the deï¬nition of Î›,
n
Y
i=1
(bi âˆ’ai + 2/k) â‰¥Î›gk =
Z
gkdmn â‰¥mn(R) â‰¥mn(R0)
â‰¥
Z
f kdmn = Î›f k â‰¥
n
Y
i=1
(bi âˆ’ai âˆ’2/k).
Letting k â†’âˆž, it follows that
mn(R) = mn(R0) =
n
Y
i=1
(bi âˆ’ai).
This proves the lemma.
Lemma 10.4 Let U be an open or closed set. Then mn (U) = mn (x + U) .
Proof: By Lemma 10.2 there is a sequence of disjoint half open rectangles,
{Ri} such that âˆªiRi = U. Therefore, x + U = âˆªi (x + Ri) and the x + Ri are also
disjoint rectangles which are identical to the Ri but translated. From Lemma 10.3,
mn (U) = P
i mn (Ri) = P
i mn (x + Ri) = mn (x + U) .
It remains to verify the lemma for a closed set. Let H be a closed bounded set
ï¬rst. Then H âŠ†B (0,R) for some R large enough. First note that x+H is a closed
set. Thus
mn (B (x, R))
=
mn (x + H) + mn ((B (0, R) + x) \ (x + H))
=
mn (x + H) + mn ((B (0, R) \ H) + x)
=
mn (x + H) + mn ((B (0, R) \ H))
=
mn (B (0, R)) âˆ’mn (H) + mn (x + H)
=
mn (B (x, R)) âˆ’mn (H) + mn (x + H)
the last equality because of the ï¬rst part of the lemma which implies mn (B (x, R)) =
mn (B (0, R)) . Therefore, mn (x + H) = mn (H) as claimed. If H is not bounded,
consider Hm â‰¡B (0, m) âˆ©H. Then mn (x + Hm) = mn (Hm) . Passing to the limit
as m â†’âˆžyields the result in general.
Theorem 10.5 Lebesgue measure is translation invariant. That is
mn (E) = mn (x + E)
for all E Lebesgue measurable.
Proof: Suppose mn (E) < âˆž. By regularity of the measure, there exist sets
G, H such that G is a countable intersection of open sets, H is a countable union
of compact sets, mn (G \ H) = 0, and G âŠ‡E âŠ‡H. Now mn (G) = mn (G + x) and

270
LEBESGUE MEASURE
mn (H) = mn (H + x) which follows from Lemma 10.4 applied to the sets which
are either intersected to form G or unioned to form H. Now
x + H âŠ†x + E âŠ†x + G
and both x+H and x+G are measurable because they are either countable unions
or countable intersections of measurable sets. Furthermore,
mn (x + G \ x + H) = mn (x + G) âˆ’mn (x + H) = mn (G) âˆ’mn (H) = 0
and so by completeness of the measure, x + E is measurable. It follows
mn (E)
=
mn (H) = mn (x + H) â‰¤mn (x + E)
â‰¤
mn (x + G) = mn (G) = mn (E) .
If mn (E) is not necessarily less than âˆž, consider Em â‰¡B (0, m) âˆ©E. Then
mn (Em) = mn (Em + x) by the above. Letting m â†’âˆžit follows mn (Em) =
mn (Em + x). This proves the theorem.
Corollary 10.6 Let D be an nÃ—n diagonal matrix and let U be an open set. Then
mn (DU) = |det (D)| mn (U) .
Proof:
If any of the diagonal entries of D equals 0 there is nothing to prove
because then both sides equal zero. Therefore, it can be assumed none are equal
to zero.
Suppose these diagonal entries are k1, Â· Â· Â·, kn. From Lemma 10.2 there
exist half open boxes, {Ri} having all sides equal such that U = âˆªiRi. Suppose
one of these is Ri = Qn
j=1(aj, bj], where bj âˆ’aj = li. Then DRi = Qn
j=1 Ij where
Ij = (kjaj, kjbj] if kj > 0 and Ij = [kjbj, kjaj) if kj < 0. Then the rectangles, DRi
are disjoint because D is one to one and their union is DU. Also,
mn (DRi) =
n
Y
j=1
|kj| li = |det D| mn (Ri) .
Therefore,
mn (DU) =
âˆž
X
i=1
mn (DRi) = |det (D)|
âˆž
X
i=1
mn (Ri) = |det (D)| mn (U) .
and this proves the corollary.
From this the following corollary is obtained.
Corollary 10.7 Let M > 0. Then mn (B (a, Mr)) = M nmn (B (0, r)) .
Proof: By Lemma 10.4 there is no loss of generality in taking a = 0. Let D be
the diagonal matrix which has M in every entry of the main diagonal so |det (D)| =
M n.
Note that DB (0, r) = B (0, Mr) . By Corollary 10.6 mn (B (0, Mr)) =
mn (DB (0, r)) = M nmn (B (0, r)) .

10.2.
THE VITALI COVERING THEOREM
271
There are many norms on Rn. Other common examples are
||x||âˆžâ‰¡max {|xk| : x = (x1, Â· Â· Â·, xn)}
or
||x||p â‰¡
Ãƒ n
X
i=1
|xi|p
!1/p
.
With ||Â·|| any norm for Rn you can deï¬ne a corresponding ball in terms of this
norm.
B (a, r) â‰¡{x âˆˆRn such that ||x âˆ’a|| < r}
It follows from general considerations involving metric spaces presented earlier that
these balls are open sets. Therefore, Corollary 10.7 has an obvious generalization.
Corollary 10.8 Let ||Â·|| be a norm on Rn. Then for M > 0, mn (B (a, Mr)) =
M nmn (B (0, r)) where these balls are deï¬ned in terms of the norm ||Â·||.
10.2
The Vitali Covering Theorem
The Vitali covering theorem is concerned with the situation in which a set is con-
tained in the union of balls. You can imagine that it might be very hard to get
disjoint balls from this collection of balls which would cover the given set. How-
ever, it is possible to get disjoint balls from this collection of balls which have the
property that if each ball is enlarged appropriately, the resulting enlarged balls do
cover the set. When this result is established, it is used to prove another form of
this theorem in which the disjoint balls do not cover the set but they only miss a
set of measure zero.
Recall the Hausdorï¬€maximal principle, Theorem 1.13 on Page 24 which is
proved to be equivalent to the axiom of choice in the appendix. For convenience,
here it is:
Theorem 10.9 (Hausdorï¬€Maximal Principle) Let F
be a nonempty partially
ordered set. Then there exists a maximal chain.
I will use this Hausdorï¬€maximal principle to give a very short and elegant proof
of the Vitali covering theorem. This follows the treatment in Evans and Gariepy
[20] which they got from another book. I am not sure who ï¬rst did it this way but
it is very nice because it is so short. In the following lemma and theorem, the balls
will be either open or closed and determined by some norm on Rn. When pictures
are drawn, I shall draw them as though the norm is the usual norm but the results
are unchanged for any norm. Also, I will write (in this section only) B (a, r) to
indicate a set which satisï¬es
{x âˆˆRn : ||x âˆ’a|| < r} âŠ†B (a, r) âŠ†{x âˆˆRn : ||x âˆ’a|| â‰¤r}
and bB (a, r) to indicate the usual ball but with radius 5 times as large,
{x âˆˆRn : ||x âˆ’a|| < 5r} .

272
LEBESGUE MEASURE
Lemma 10.10
Let ||Â·|| be a norm on Rn and let F be a collection of balls deter-
mined by this norm. Suppose
âˆž> M â‰¡sup{r : B(p, r) âˆˆF} > 0
and k âˆˆ(0, âˆž) . Then there exists G âŠ†F such that
if B(p, r) âˆˆG then r > k,
(10.1)
if B1, B2 âˆˆG then B1 âˆ©B2 = âˆ…,
(10.2)
G is maximal with respect to 10.1 and 10.2.
Note that if there is no ball of F which has radius larger than k then G = âˆ….
Proof: Let H = {B âŠ†F such that 10.1 and 10.2 hold}. If there are no balls
with radius larger than k then H = âˆ…and you let G =âˆ…. In the other case, H Ì¸= âˆ…
because there exists B(p, r) âˆˆF with r > k. In this case, partially order H by set
inclusion and use the Hausdorï¬€maximal principle (see the appendix on set theory)
to let C be a maximal chain in H. Clearly âˆªC satisï¬es 10.1 and 10.2 because if B1
and B2 are two balls from âˆªC
then since C
is a chain, it follows there is some
element of C, B such that both B1 and B2 are elements of B and B satisï¬es 10.1 and
10.2. If âˆªC is not maximal with respect to these two properties, then C was not a
maximal chain because then there would exist B âŠ‹âˆªC, that is, B contains C as a
proper subset and {C, B} would be a strictly larger chain in H. Let G = âˆªC.
Theorem 10.11
(Vitali) Let F be a collection of balls and let
A â‰¡âˆª{B : B âˆˆF}.
Suppose
âˆž> M â‰¡sup{r : B(p, r) âˆˆF} > 0.
Then there exists G âŠ†F such that G consists of disjoint balls and
A âŠ†âˆª{ bB : B âˆˆG}.
Proof: Using Lemma 10.10, there exists G1 âŠ†F â‰¡F0 which satisï¬es
B(p, r) âˆˆG1 implies r > M
2 ,
(10.3)
B1, B2 âˆˆG1 implies B1 âˆ©B2 = âˆ…,
(10.4)
G1 is maximal with respect to 10.3, and 10.4.
Suppose G1, Â· Â· Â·, Gm have been chosen, m â‰¥1. Let
Fm â‰¡{B âˆˆF : B âŠ†Rn \ âˆª{G1 âˆªÂ· Â· Â· âˆªGm}}.

10.3.
THE VITALI COVERING THEOREM (ELEMENTARY VERSION)
273
Using Lemma 10.10, there exists Gm+1 âŠ†Fm such that
B(p, r) âˆˆGm+1 implies r >
M
2m+1 ,
(10.5)
B1, B2 âˆˆGm+1 implies B1 âˆ©B2 = âˆ…,
(10.6)
Gm+1 is a maximal subset of Fm with respect to 10.5 and 10.6.
Note it might be the case that Gm+1 = âˆ…which happens if Fm = âˆ…. Deï¬ne
G â‰¡âˆªâˆž
k=1Gk.
Thus G is a collection of disjoint balls in F. I must show { bB : B âˆˆG} covers A.
Let x âˆˆB(p, r) âˆˆF and let
M
2m < r â‰¤
M
2mâˆ’1 .
Then B (p, r) must intersect some set, B (p0, r0) âˆˆG1 âˆªÂ· Â· Â· âˆªGm since otherwise,
Gm would fail to be maximal. Then r0 > M
2m because all balls in G1 âˆªÂ·Â·Â·âˆªGm satisfy
this inequality.
r0
p0
?
r p.x
Then for x âˆˆB (p, r) , the following chain of inequalities holds because r â‰¤
M
2mâˆ’1
and r0 > M
2m
|x âˆ’p0|
â‰¤
|x âˆ’p| + |p âˆ’p0| â‰¤r + r0 + r
â‰¤
2M
2mâˆ’1 + r0 = 4M
2m + r0 < 5r0.
Thus B (p, r) âŠ†bB (p0, r0) and this proves the theorem.
10.3
The Vitali Covering Theorem (Elementary
Version)
The proof given here is from Basic Analysis [35]. It ï¬rst considers the case of open
balls and then generalizes to balls which may be neither open nor closed or closed.
Lemma 10.12
Let F
be a countable collection of balls satisfying
âˆž> M â‰¡sup{r : B(p, r) âˆˆF} > 0
and let k âˆˆ(0, âˆž) . Then there exists G âŠ†F such that
If B(p, r) âˆˆG then r > k,
(10.7)
If B1, B2 âˆˆG then B1 âˆ©B2 = âˆ…,
(10.8)
G is maximal with respect to 10.7 and 10.8.
(10.9)

274
LEBESGUE MEASURE
Proof: If no ball of F has radius larger than k, let G = âˆ…. Assume therefore, that
some balls have radius larger than k. Let F â‰¡{Bi}âˆž
i=1. Now let Bn1 be the ï¬rst ball
in the list which has radius greater than k. If every ball having radius larger than k
intersects this one, then stop. The maximal set is just Bn1. Otherwise, let Bn2 be
the next ball having radius larger than k which is disjoint from Bn1. Continue this
way obtaining {Bni}âˆž
i=1, a ï¬nite or inï¬nite sequence of disjoint balls having radius
larger than k. Then let G â‰¡{Bni}. To see that G is maximal with respect to 10.7
and 10.8, suppose B âˆˆF, B has radius larger than k, and G âˆª{B} satisï¬es 10.7
and 10.8. Then at some point in the process, B would have been chosen because it
would be the ball of radius larger than k which has the smallest index. Therefore,
B âˆˆG and this shows G is maximal with respect to 10.7 and 10.8.
For the next lemma, for an open ball, B = B (x, r) , denote by eB the open ball,
B (x, 4r) .
Lemma 10.13
Let F
be a collection of open balls, and let
A â‰¡âˆª{B : B âˆˆF} .
Suppose
âˆž> M â‰¡sup {r : B(p, r) âˆˆF} > 0.
Then there exists G âŠ†F such that G consists of disjoint balls and
A âŠ†âˆª{ eB : B âˆˆG}.
Proof: Without loss of generality assume F is countable. This is because there
is a countable subset of F, Fâ€² such that âˆªFâ€² = A. To see this, consider the set
of balls having rational radii and centers having all components rational. This is a
countable set of balls and you should verify that every open set is the union of balls
of this form. Therefore, you can consider the subset of this set of balls consisting of
those which are contained in some open set of F, G so âˆªG = A and use the axiom
of choice to deï¬ne a subset of F consisting of a single set from F containing each
set of G. Then this is Fâ€² . The union of these sets equals A . Then consider Fâ€²
instead of F. Therefore, assume at the outset F is countable. By Lemma 10.12,
there exists G1 âŠ†F which satisï¬es 10.7, 10.8, and 10.9 with k = 2M
3 .
Suppose G1, Â· Â· Â·, Gmâˆ’1 have been chosen for m â‰¥2. Let
Fm = {B âˆˆF : B âŠ†Rn \
union of the balls in these Gj
z
}|
{
âˆª{G1 âˆªÂ· Â· Â· âˆªGmâˆ’1}
}
and using Lemma 10.12, let Gm be a maximal collection of disjoint balls from Fm
with the property that each ball has radius larger than
Â¡ 2
3
Â¢m M. Let G â‰¡âˆªâˆž
k=1Gk.
Let x âˆˆB (p, r) âˆˆF. Choose m such that
Âµ2
3
Â¶m
M < r â‰¤
Âµ2
3
Â¶mâˆ’1
M

10.3.
THE VITALI COVERING THEOREM (ELEMENTARY VERSION)
275
Then B (p, r) must have nonempty intersection with some ball from G1 âˆªÂ· Â· Â· âˆªGm
because if it didnâ€™t, then Gm would fail to be maximal. Denote by B (p0, r0) a ball
in G1 âˆªÂ· Â· Â· âˆªGm which has nonempty intersection with B (p, r) . Thus
r0 >
Âµ2
3
Â¶m
M.
Consider the picture, in which w âˆˆB (p0, r0) âˆ©B (p, r) .
wÂ·
 r0
p0
?
r
p
Â·x
Then
|x âˆ’p0|
â‰¤
|x âˆ’p| + |p âˆ’w| +
<r0
z
}|
{
|w âˆ’p0|
<
r + r + r0 â‰¤2
< 3
2 r0
z
}|
{
Âµ2
3
Â¶mâˆ’1
M + r0
<
2
Âµ3
2
Â¶
r0 + r0 = 4r0.
This proves the lemma since it shows B (p, r) âŠ†B (p0, 4r0) .
With this Lemma consider a version of the Vitali covering theorem in which
the balls do not have to be open.
A ball centered at x of radius r will denote
something which contains the open ball, B (x, r) and is contained in the closed ball,
B (x, r). Thus the balls could be open or they could contain some but not all of
their boundary points.
Deï¬nition 10.14 Let B be a ball centered at x having radius r. Denote by bB the
open ball, B (x, 5r).
Theorem 10.15 (Vitali) Let F
be a collection of balls, and let
A â‰¡âˆª{B : B âˆˆF} .
Suppose
âˆž> M â‰¡sup {r : B(p, r) âˆˆF} > 0.
Then there exists G âŠ†F such that G consists of disjoint balls and
A âŠ†âˆª{ bB : B âˆˆG}.
Proof: For B one of these balls, say B (x, r) âŠ‡B âŠ‡B (x, r), denote by B1, the
ball B
Â¡
x, 5r
4
Â¢
. Let F1 â‰¡{B1 : B âˆˆF} and let A1 denote the union of the balls in
F1. Apply Lemma 10.13 to F1 to obtain
A1 âŠ†âˆª{f
B1 : B1 âˆˆG1}

276
LEBESGUE MEASURE
where G1 consists of disjoint balls from F1. Now let G â‰¡{B âˆˆF : B1 âˆˆG1}. Thus
G consists of disjoint balls from F because they are contained in the disjoint open
balls, G1. Then
A âŠ†A1 âŠ†âˆª{f
B1 : B1 âˆˆG1} = âˆª{ bB : B âˆˆG}
because for B1 = B
Â¡
x, 5r
4
Â¢
, it follows f
B1 = B (x, 5r) = bB. This proves the theorem.
10.4
Vitali Coverings
There is another version of the Vitali covering theorem which is also of great impor-
tance. In this one, balls from the original set of balls almost cover the set,leaving
out only a set of measure zero. It is like packing a truck with stuï¬€. You keep trying
to ï¬ll in the holes with smaller and smaller things so as to not waste space. It is
remarkable that you can avoid wasting any space at all when you are dealing with
balls of any sort provided you can use arbitrarily small balls.
Deï¬nition 10.16 Let F
be a collection of balls that cover a set, E, which have
the property that if x âˆˆE and Îµ > 0, then there exists B âˆˆF, diameter of B < Îµ
and x âˆˆB. Such a collection covers E in the sense of Vitali.
In the following covering theorem, mn denotes the outer measure determined by
n dimensional Lebesgue measure.
Theorem 10.17 Let E âŠ†Rn and suppose 0 < mn(E) < âˆžwhere mn is the
outer measure determined by mn, n dimensional Lebesgue measure, and let F be
a collection of closed balls of bounded radii such that F covers E in the sense of
Vitali. Then there exists a countable collection of disjoint balls from F, {Bj}âˆž
j=1,
such that mn(E \ âˆªâˆž
j=1Bj) = 0.
Proof: From the deï¬nition of outer measure there exists a Lebesgue measurable
set, E1 âŠ‡E such that mn (E1) = mn (E). Now by outer regularity of Lebesgue
measure, there exists U, an open set which satisï¬es
mn(E1) > (1 âˆ’10âˆ’n)mn(U), U âŠ‡E1.
E1
U

10.4.
VITALI COVERINGS
277
Each point of E is contained in balls of F of arbitrarily small radii and so
there exists a covering of E with balls of F which are themselves contained in U.
Therefore, by the Vitali covering theorem, there exist disjoint balls, {Bi}âˆž
i=1 âŠ†F
such that
E âŠ†âˆªâˆž
j=1 bBj, Bj âŠ†U.
Therefore,
mn (E1)
=
mn (E) â‰¤mn
Â³
âˆªâˆž
j=1 bBj
Â´
â‰¤
X
j
mn
Â³
bBj
Â´
=
5n X
j
mn (Bj) = 5nmn
Â¡
âˆªâˆž
j=1Bj
Â¢
Then
mn(E1) > (1 âˆ’10âˆ’n)mn(U)
â‰¥(1 âˆ’10âˆ’n)[mn(E1 \ âˆªâˆž
j=1Bj) + mn(âˆªâˆž
j=1Bj)]
â‰¥(1 âˆ’10âˆ’n)[mn(E1 \ âˆªâˆž
j=1Bj) + 5âˆ’n
=mn(E1)
z }| {
mn(E) ].
and so
Â¡
1 âˆ’
Â¡
1 âˆ’10âˆ’nÂ¢
5âˆ’nÂ¢
mn (E1) â‰¥(1 âˆ’10âˆ’n)mn(E1 \ âˆªâˆž
j=1Bj)
which implies
mn(E1 \ âˆªâˆž
j=1Bj) â‰¤(1 âˆ’(1 âˆ’10âˆ’n) 5âˆ’n)
(1 âˆ’10âˆ’n)
mn (E1)
Now a short computation shows
0 < (1 âˆ’(1 âˆ’10âˆ’n) 5âˆ’n)
(1 âˆ’10âˆ’n)
< 1
Hence, denoting by Î¸n a number such that
(1 âˆ’(1 âˆ’10âˆ’n) 5âˆ’n)
(1 âˆ’10âˆ’n)
< Î¸n < 1,
mn
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
â‰¤mn(E1 \ âˆªâˆž
j=1Bj) < Î¸nmn (E1) = Î¸nmn (E)
Now pick N1 large enough that
Î¸nmn(E) â‰¥mn(E1 \ âˆªN1
j=1Bj) â‰¥mn(E \ âˆªN1
j=1Bj)
(10.10)
Let F1 = {B âˆˆF : Bj âˆ©B = âˆ…, j = 1, Â· Â· Â·, N1}. If E \ âˆªN1
j=1Bj = âˆ…, then F1 = âˆ…
and
mn
Â³
E \ âˆªN1
j=1Bj
Â´
= 0

278
LEBESGUE MEASURE
Therefore, in this case let Bk = âˆ…for all k > N1. Consider the case where
E \ âˆªN1
j=1Bj Ì¸= âˆ….
In this case, F1 Ì¸= âˆ…and covers E \ âˆªN1
j=1Bj in the sense of Vitali. Repeat the same
argument, letting E \ âˆªN1
j=1Bj play the role of E and letting U \ âˆªN1
j=1 Bj play the
role of U. (You pick a diï¬€erent E1 whose measure equals the outer measure of
E \ âˆªN1
j=1Bj.) Then choosing Bj for j = N1 + 1, Â· Â· Â·, N2 as in the above argument,
Î¸nmn(E \ âˆªN1
j=1Bj) â‰¥mn(E \ âˆªN2
j=1Bj)
and so from 10.10,
Î¸2
nmn(E) â‰¥mn(E \ âˆªN2
j=1Bj).
Continuing this way
Î¸k
nmn(E) â‰¥mn
Â³
E \ âˆªNk
j=1Bj
Â´
.
If it is ever the case that E \ âˆªNk
j=1Bj = âˆ…, then, as in the above argument,
mn
Â³
E \ âˆªNk
j=1Bj
Â´
= 0.
Otherwise, the process continues and
mn
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
â‰¤mn
Â³
E \ âˆªNk
j=1Bj
Â´
â‰¤Î¸k
nmn (E)
for every k âˆˆN. Therefore, the conclusion holds in this case also. This proves the
Theorem.
There is an obvious corollary which removes the assumption that 0 < mn(E).
Corollary 10.18 Let E âŠ†Rn and suppose mn(E) < âˆžwhere mn is the outer
measure determined by mn, n dimensional Lebesgue measure, and let F, be a col-
lection of closed balls of bounded radii such that F covers E in the sense of Vitali.
Then there exists a countable collection of disjoint balls from F, {Bj}âˆž
j=1, such that
mn(E \ âˆªâˆž
j=1Bj) = 0.
Proof: If 0 = mn(E) you simply pick any ball from F for your collection of
disjoint balls.
It is also not hard to remove the assumption that mn (E) < âˆž.
Corollary 10.19 Let E âŠ†Rn and let F, be a collection of closed balls of bounded
radii such that F covers E in the sense of Vitali. Then there exists a countable
collection of disjoint balls from F, {Bj}âˆž
j=1, such that mn(E \ âˆªâˆž
j=1Bj) = 0.
Proof: Let Rm â‰¡(âˆ’m, m)n be the open rectangle having sides of length 2m
which is centered at 0 and let R0 = âˆ…. Let Hm â‰¡Rm \ Rm. Since both Rm
and Rm have the same measure, (2m)n , it follows mn (Hm) = 0. Now for all
k âˆˆN, Rk âŠ†Rk âŠ†Rk+1. Consider the disjoint open sets, Uk â‰¡Rk+1 \ Rk. Thus

10.5.
CHANGE OF VARIABLES FOR LINEAR MAPS
279
Rn = âˆªâˆž
k=0Uk âˆªN where N is a set of measure zero equal to the union of the Hk.
Let Fk denote those balls of F which are contained in Uk and let Ek â‰¡Uk âˆ©E.
Then from Theorem 10.17, there exists a sequence of disjoint balls, Dk â‰¡
Â©
Bk
i
Âªâˆž
i=1
of Fk such that mn(Ek \ âˆªâˆž
j=1Bk
j ) = 0. Letting {Bi}âˆž
i=1 be an enumeration of all
the balls of âˆªkDk, it follows that
mn(E \ âˆªâˆž
j=1Bj) â‰¤mn (N) +
âˆž
X
k=1
mn(Ek \ âˆªâˆž
j=1Bk
j ) = 0.
Also, you donâ€™t have to assume the balls are closed.
Corollary 10.20 Let E âŠ†Rn and let F, be a collection of open balls of bounded
radii such that F covers E in the sense of Vitali. Then there exists a countable
collection of disjoint balls from F, {Bj}âˆž
j=1, such that mn(E \ âˆªâˆž
j=1Bj) = 0.
Proof: Let F be the collection of closures of balls in F. Then F covers E in
the sense of Vitali and so from Corollary 10.19 there exists a sequence of disjoint
closed balls from F satisfying mn
Â¡
E \ âˆªâˆž
i=1Bi
Â¢
= 0. Now boundaries of the balls,
Bi have measure zero and so {Bi} is a sequence of disjoint open balls satisfying
mn (E \ âˆªâˆž
i=1Bi) = 0. The reason for this is that
(E \ âˆªâˆž
i=1Bi) \
Â¡
E \ âˆªâˆž
i=1Bi
Â¢
âŠ†âˆªâˆž
i=1Bi \ âˆªâˆž
i=1Bi âŠ†âˆªâˆž
i=1Bi \ Bi,
a set of measure zero. Therefore,
E \ âˆªâˆž
i=1Bi âŠ†
Â¡
E \ âˆªâˆž
i=1Bi
Â¢
âˆª
Â¡
âˆªâˆž
i=1Bi \ Bi
Â¢
and so
mn (E \ âˆªâˆž
i=1Bi)
â‰¤
mn
Â¡
E \ âˆªâˆž
i=1Bi
Â¢
+ mn
Â¡
âˆªâˆž
i=1Bi \ Bi
Â¢
=
mn
Â¡
E \ âˆªâˆž
i=1Bi
Â¢
= 0.
This implies you can ï¬ll up an open set with balls which cover the open set in
the sense of Vitali.
Corollary 10.21 Let U âŠ†Rn be an open set and let F be a collection of closed or
even open balls of bounded radii contained in U such that F covers U in the sense
of Vitali. Then there exists a countable collection of disjoint balls from F, {Bj}âˆž
j=1,
such that mn(U \ âˆªâˆž
j=1Bj) = 0.
10.5
Change Of Variables For Linear Maps
To begin with certain kinds of functions map measurable sets to measurable sets.
It will be assumed that U is an open set in Rn and that h : U â†’Rn satisï¬es
Dh (x) exists for all x âˆˆU,
(10.11)

280
LEBESGUE MEASURE
Lemma 10.22 Let h satisfy 10.11. If T âŠ†U and mn (T) = 0, then mn (h (T)) =
0.
Proof: Let
Tk â‰¡{x âˆˆT : ||Dh (x)|| < k}
and let Îµ > 0 be given.
Now by outer regularity, there exists an open set, V ,
containing Tk which is contained in U such that mn (V ) < Îµ. Let x âˆˆTk. Then by
diï¬€erentiability,
h (x + v) = h (x) + Dh (x) v + o (v)
and so there exist arbitrarily small rx < 1 such that B (x,5rx) âŠ†V and whenever
|v| â‰¤rx, |o (v)| < k |v| . Thus
h (B (x, rx)) âŠ†B (h (x) , 2krx) .
From the Vitali covering theorem there exists a countable disjoint sequence of
these sets, {B (xi, ri)}âˆž
i=1 such that {B (xi, 5ri)}âˆž
i=1 =
n
c
Bi
oâˆž
i=1 covers Tk Then
letting mn denote the outer measure determined by mn,
mn (h (Tk)) â‰¤mn
Â³
h
Â³
âˆªâˆž
i=1 bBi
Â´Â´
â‰¤
âˆž
X
i=1
mn
Â³
h
Â³
bBi
Â´Â´
â‰¤
âˆž
X
i=1
mn (B (h (xi) , 2krxi))
=
âˆž
X
i=1
mn (B (xi, 2krxi)) = (2k)n
âˆž
X
i=1
mn (B (xi, rxi))
â‰¤
(2k)n mn (V ) â‰¤(2k)n Îµ.
Since Îµ > 0 is arbitrary, this shows mn (h (Tk)) = 0. Now
mn (h (T)) = lim
kâ†’âˆžmn (h (Tk)) = 0.
This proves the lemma.
Lemma 10.23 Let h satisfy 10.11. If S is a Lebesgue measurable subset of U, then
h (S) is Lebesgue measurable.
Proof: Let Sk = S âˆ©B (0, k) , k âˆˆN. By inner regularity of Lebesgue measure,
there exists a set, F, which is the countable union of compact sets and a set T with
mn (T) = 0 such that
F âˆªT = Sk.
Then h (F) âŠ†h (Sk) âŠ†h (F) âˆªh (T). By continuity of h, h (F) is a countable
union of compact sets and so it is Borel. By Lemma 10.22, mn (h (T)) = 0 and so
h (Sk) is Lebesgue measurable because of completeness of Lebesgue measure. Now
h (S) = âˆªâˆž
k=1h (Sk) and so it is also true that h (S) is Lebesgue measurable. This
proves the lemma.
In particular, this proves the following corollary.

10.5.
CHANGE OF VARIABLES FOR LINEAR MAPS
281
Corollary 10.24 Suppose A is an nÃ—n matrix. Then if S is a Lebesgue measurable
set, it follows AS is also a Lebesgue measurable set.
Lemma 10.25 Let R be unitary (Râˆ—R = RRâˆ—= I) and let V be a an open or
closed set. Then mn (RV ) = mn (V ) .
Proof: First assume V is a bounded open set. By Corollary 10.21 there is a
disjoint sequence of closed balls, {Bi} such that U = âˆªâˆž
i=1BiâˆªN where mn (N) = 0.
Denote by xi the center of Bi and let ri be the radius of Bi. Then by Lemma 10.22
mn (RV ) = Pâˆž
i=1 mn (RBi) . Now by invariance of translation of Lebesgue measure,
this equals Pâˆž
i=1 mn (RBi âˆ’Rxi) = Pâˆž
i=1 mn (RB (0, ri)) . Since R is unitary, it
preserves all distances and so RB (0, ri) = B (0, ri) and therefore,
mn (RV ) =
âˆž
X
i=1
mn (B (0, ri)) =
âˆž
X
i=1
mn (Bi) = mn (V ) .
This proves the lemma in the case that V is bounded. Suppose now that V
is just
an open set. Let Vk = V âˆ©B (0, k) . Then mn (RVk) = mn (Vk) . Letting k â†’âˆž,
this yields the desired conclusion. This proves the lemma in the case that V is open.
Suppose now that H is a closed and bounded set. Let B (0,R) âŠ‡H. Then letting
B = B (0, R) for short,
mn (RH)
=
mn (RB) âˆ’mn (R (B \ H))
=
mn (B) âˆ’mn (B \ H) = mn (H) .
In general, let Hm = H âˆ©B (0,m). Then from what was just shown, mn (RHm) =
mn (Hm) . Now let m â†’âˆžto get the conclusion of the lemma in general. This
proves the lemma.
Lemma 10.26 Let E be Lebesgue measurable set in Rn and let R be unitary. Then
mn (RE) = mn (E) .
Proof: First suppose E is bounded. Then there exist sets, G and H such that
H âŠ†E âŠ†G and H is the countable union of closed sets while G is the countable
intersection of open sets such that mn (G \ H) = 0. By Lemma 10.25 applied to
these sets whose union or intersection equals H or G respectively, it follows
mn (RG) = mn (G) = mn (H) = mn (RH) .
Therefore,
mn (H) = mn (RH) â‰¤mn (RE) â‰¤mn (RG) = mn (G) = mn (E) = mn (H) .
In the general case, let Em = E âˆ©B (0, m) and apply what was just shown and let
m â†’âˆž.
Lemma 10.27 Let V be an open or closed set in Rn and let A be an n Ã— n matrix.
Then mn (AV ) = |det (A)| mn (V ).

282
LEBESGUE MEASURE
Proof: Let RU be the right polar decomposition (Theorem 4.59 on Page 87) of
A and let V be an open set. Then from Lemma 10.26,
mn (AV ) = mn (RUV ) = mn (UV ) .
Now U = Qâˆ—DQ where D is a diagonal matrix such that |det (D)| = |det (A)| and
Q is unitary. Therefore,
mn (AV ) = mn (Qâˆ—DQV ) = mn (DQV ) .
Now QV is an open set and so by Corollary 10.6 on Page 270 and Lemma 10.25,
mn (AV ) = |det (D)| mn (QV ) = |det (D)| mn (V ) = |det (A)| mn (V ) .
This proves the lemma in case V is open.
Now let H be a closed set which is also bounded. First suppose det (A) = 0.
Then letting V be an open set containing H,
mn (AH) â‰¤mn (AV ) = |det (A)| mn (V ) = 0
which shows the desired equation is obvious in the case where det (A) = 0. Therefore,
assume A is one to one. Since H is bounded, H âŠ†B (0, R) for some R > 0. Then
letting B = B (0, R) for short,
mn (AH)
=
mn (AB) âˆ’mn (A (B \ H))
=
|det (A)| mn (B) âˆ’|det (A)| mn (B \ H) = |det (A)| mn (H) .
If H is not bounded, apply the result just obtained to Hm â‰¡H âˆ©B (0, m) and then
let m â†’âˆž.
With this preparation, the main result is the following theorem.
Theorem 10.28 Let E be Lebesgue measurable set in Rn and let A be an n Ã— n
matrix. Then mn (AE) = |det (A)| mn (E) .
Proof: First suppose E is bounded. Then there exist sets, G and H such that
H âŠ†E âŠ†G and H is the countable union of closed sets while G is the countable
intersection of open sets such that mn (G \ H) = 0. By Lemma 10.27 applied to
these sets whose union or intersection equals H or G respectively, it follows
mn (AG) = |det (A)| mn (G) = |det (A)| mn (H) = mn (AH) .
Therefore,
|det (A)| mn (E)
=
|det (A)| mn (H) = mn (AH) â‰¤mn (AE)
â‰¤
mn (AG) = |det (A)| mn (G) = |det (A)| mn (E) .
In the general case, let Em = E âˆ©B (0, m) and apply what was just shown and let
m â†’âˆž.

10.6.
CHANGE OF VARIABLES FOR C1 FUNCTIONS
283
10.6
Change Of Variables For C1 Functions
In this section theorems are proved which generalize the above to C1 functions.
More general versions can be seen in Kuttler [35], Kuttler [36], and Rudin [45].
There is also a very diï¬€erent approach to this theorem given in [35]. The more
general version in [35] follows [45] and both are based on the Brouwer ï¬xed point
theorem and a very clever lemma presented in Rudin [45]. This same approach will
be used later in this book to prove a diï¬€erent sort of change of variables theorem
in which the functions are only Lipschitz. The proof will be based on a sequence of
easy lemmas.
Lemma 10.29 Let U and V be bounded open sets in Rn and let h, hâˆ’1 be C1
functions such that h (U) = V. Also let f âˆˆCc (V ) . Then
Z
V
f (y) dy =
Z
U
f (h (x)) |det (Dh (x))| dx
Proof: Let x âˆˆU. By the assumption that h and hâˆ’1 are C1,
h (x + v) âˆ’h (x)
=
Dh (x) v + o (v)
=
Dh (x)
Â¡
v + Dhâˆ’1 (h (x)) o (v)
Â¢
=
Dh (x) (v + o (v))
and so if r > 0 is small enough then B (x, r) is contained in U and
h (B (x, r)) âˆ’h (x) = h (x+B (0,r)) âˆ’h (x) âŠ†Dh (x) (B (0, (1 + Îµ) r)) .
(10.12)
Making r still smaller if necessary, one can also obtain
|f (y) âˆ’f (h (x))| < Îµ
(10.13)
for any y âˆˆh (B (x, r)) and
|f (h (x1)) |det (Dh (x1))| âˆ’f (h (x)) |det (Dh (x))|| < Îµ
(10.14)
whenever x1 âˆˆB (x, r) . The collection of such balls is a Vitali cover of U. By
Corollary 10.21 there is a sequence of disjoint closed balls {Bi} such that U =
âˆªâˆž
i=1Bi âˆªN where mn (N) = 0. Denote by xi the center of Bi and ri the radius.
Then by Lemma 10.22, the monotone convergence theorem, and 10.12 - 10.14,
R
V f (y) dy = Pâˆž
i=1
R
h(Bi) f (y) dy
â‰¤Îµmn (V ) + Pâˆž
i=1
R
h(Bi) f (h (xi)) dy
â‰¤Îµmn (V ) + Pâˆž
i=1 f (h (xi)) mn (h (Bi))
â‰¤Îµmn (V ) + Pâˆž
i=1 f (h (xi)) mn (Dh (xi) (B (0, (1 + Îµ) ri)))
= Îµmn (V ) + (1 + Îµ)n Pâˆž
i=1
R
Bi f (h (xi)) |det (Dh (xi))| dx
â‰¤Îµmn (V ) + (1 + Îµ)n Pâˆž
i=1
Â³R
Bi f (h (x)) |det (Dh (x))| dx + Îµmn (Bi)
Â´
â‰¤Îµmn (V ) + (1 + Îµ)n Pâˆž
i=1
R
Bi f (h (x)) |det (Dh (x))| dx + (1 + Îµ)n Îµmn (U)
= Îµmn (V ) + (1 + Îµ)n R
U f (h (x)) |det (Dh (x))| dx + (1 + Îµ)n Îµmn (U)

284
LEBESGUE MEASURE
Since Îµ > 0 is arbitrary, this shows
Z
V
f (y) dy â‰¤
Z
U
f (h (x)) |det (Dh (x))| dx
(10.15)
whenever f âˆˆCc (V ) . Now x â†’f (h (x)) |det (Dh (x))| is in Cc (U) and so using the
same argument with U and V switching roles and replacing h with hâˆ’1,
Z
U
f (h (x)) |det (Dh (x))| dx
â‰¤
Z
V
f
Â¡
h
Â¡
hâˆ’1 (y)
Â¢Â¢ Â¯Â¯det
Â¡
Dh
Â¡
hâˆ’1 (y)
Â¢Â¢Â¯Â¯ Â¯Â¯det
Â¡
Dhâˆ’1 (y)
Â¢Â¯Â¯ dy
=
Z
V
f (y) dy
by the chain rule. This with 10.15 proves the lemma.
Corollary 10.30 Let U and V be open sets in Rn and let h, hâˆ’1 be C1 functions
such that h (U) = V. Also let f âˆˆCc (V ) . Then
Z
V
f (y) dy =
Z
U
f (h (x)) |det (Dh (x))| dx
Proof: Choose m large enough that spt (f) âŠ†B (0,m) âˆ©V â‰¡Vm. Then let
hâˆ’1 (Vm) = Um. From Lemma 10.29,
Z
V
f (y) dy
=
Z
Vm
f (y) dy =
Z
Um
f (h (x)) |det (Dh (x))| dx
=
Z
U
f (h (x)) |det (Dh (x))| dx.
This proves the corollary.
Corollary 10.31 Let U and V be open sets in Rn and let h, hâˆ’1 be C1 functions
such that h (U) = V. Also let E âŠ†V be measurable. Then
Z
V
XE (y) dy =
Z
U
XE (h (x)) |det (Dh (x))| dx.
Proof: Let Em = E âˆ©Vm where Vm and Um are as in Corollary 10.30. By
regularity of the measure there exist sets, Kk, Gk such that Kk âŠ†Em âŠ†Gk, Gk
is open, Kk is compact, and mn (Gk \ Kk) < 2âˆ’k.
Let Kk â‰ºfk â‰ºGk. Then
fk (y) â†’XEm (y) a.e.
because if y is such that convergence fails, it must be
the case that y is in Gk \ Kk inï¬nitely often and P
k mn (Gk \ Kk) < âˆž. Let
N = âˆ©m âˆªâˆž
k=m Gk \ Kk, the set of y which is in inï¬nitely many of the Gk \ Kk.
Then fk (h (x)) must converge to XE (h (x)) for all x /âˆˆhâˆ’1 (N) , a set of measure
zero by Lemma 10.22. By Corollary 10.30
Z
Vm
fk (y) dy =
Z
Um
fk (h (x)) |det (Dh (x))| dx.

10.6.
CHANGE OF VARIABLES FOR C1 FUNCTIONS
285
By the dominated convergence theorem using a dominating function, XVm in the
integral on the left and XUm |det (Dh)| on the right,
Z
Vm
XEm (y) dy =
Z
Um
XEm (h (x)) |det (Dh (x))| dx.
Therefore,
Z
V
XEm (y) dy
=
Z
Vm
XEm (y) dy =
Z
Um
XEm (h (x)) |det (Dh (x))| dx
=
Z
U
XEm (h (x)) |det (Dh (x))| dx
Let m â†’âˆžand use the monotone convergence theorem to obtain the conclusion
of the corollary.
With this corollary, the main theorem follows.
Theorem 10.32 Let U and V be open sets in Rn and let h, hâˆ’1 be C1 functions
such that h (U) = V. Then if g is a nonnegative Lebesgue measurable function,
Z
V
g (y) dy =
Z
U
g (h (x)) |det (Dh (x))| dx.
(10.16)
Proof: From Corollary 10.31, 10.16 holds for any nonnegative simple function
in place of g. In general, let {sk} be an increasing sequence of simple functions
which converges to g pointwise. Then from the monotone convergence theorem
Z
V
g (y) dy
=
lim
kâ†’âˆž
Z
V
skdy = lim
kâ†’âˆž
Z
U
sk (h (x)) |det (Dh (x))| dx
=
Z
U
g (h (x)) |det (Dh (x))| dx.
This proves the theorem.
This is a pretty good theorem but it isnâ€™t too hard to generalize it. In particular,
it is not necessary to assume hâˆ’1 is C1.
Lemma 10.33 Suppose V is an n âˆ’1 dimensional subspace of Rn and K is a
compact subset of V . Then letting
KÎµ â‰¡âˆªxâˆˆKB (x,Îµ) = K + B (0, Îµ) ,
it follows that
mn (KÎµ) â‰¤2nÎµ (diam (K) + Îµ)nâˆ’1 .
Proof: Let an orthonormal basis for V be {v1, Â· Â· Â·, vnâˆ’1} and let
{v1, Â· Â· Â·, vnâˆ’1, vn}

286
LEBESGUE MEASURE
be an orthonormal basis for Rn. Now deï¬ne a linear transformation, Q by Qvi = ei.
Thus QQâˆ—= Qâˆ—Q = I and Q preserves all distances because
Â¯Â¯Â¯Â¯Â¯Q
X
i
aiei
Â¯Â¯Â¯Â¯Â¯
2
=
Â¯Â¯Â¯Â¯Â¯
X
i
aivi
Â¯Â¯Â¯Â¯Â¯
2
=
X
i
|ai|2 =
Â¯Â¯Â¯Â¯Â¯
X
i
aiei
Â¯Â¯Â¯Â¯Â¯
2
.
Letting k0 âˆˆK, it follows K âŠ†B (k0, diam (K)) and so,
QK âŠ†Bnâˆ’1 (Qk0, diam (QK)) = Bnâˆ’1 (Qk0, diam (K))
where Bnâˆ’1 refers to the ball taken with respect to the usual norm in Rnâˆ’1. Every
point of KÎµ is within Îµ of some point of K and so it follows that every point of QKÎµ
is within Îµ of some point of QK. Therefore,
QKÎµ âŠ†Bnâˆ’1 (Qk0, diam (QK) + Îµ) Ã— (âˆ’Îµ, Îµ) ,
To see this, let x âˆˆQKÎµ. Then there exists k âˆˆQK such that |k âˆ’x| < Îµ. There-
fore, |(x1, Â· Â· Â·, xnâˆ’1) âˆ’(k1, Â· Â· Â·, knâˆ’1)| < Îµ and |xn âˆ’kn| < Îµ and so x is contained
in the set on the right in the above inclusion because kn = 0. However, the measure
of the set on the right is smaller than
[2 (diam (QK) + Îµ)]nâˆ’1 (2Îµ) = 2n [(diam (K) + Îµ)]nâˆ’1 Îµ.
This proves the lemma.
Note this is a very sloppy estimate. You can certainly do much better but this
estimate is suï¬ƒcient to prove Sardâ€™s lemma which follows.
Deï¬nition 10.34 In any metric space, if x is a point of the metric space and S is
a nonempty subset,
dist (x,S) â‰¡inf {d (x, s) : s âˆˆS} .
More generally, if T, S are two nonempty sets,
dist (S, T) â‰¡inf {d (t, s) : s âˆˆS, t âˆˆT} .
Lemma 10.35 The function x â†’dist (x,S) is continuous.
Proof: Let x, y be given. Suppose dist (x, S) â‰¥dist (y, S) and pick s âˆˆS such
that dist (y, S) + Îµ â‰¥d (y, s) . Then
0
â‰¤
dist (x, S) âˆ’dist (y, S) â‰¤dist (x, S) âˆ’(d (y, s) âˆ’Îµ)
â‰¤
d (x, s) âˆ’d (y, s) + Îµ â‰¤d (x, y) + d (y, s) âˆ’d (y, s) + Îµ = d (x, y) + Îµ.
Since Îµ > 0 is arbitrary, this shows |dist (x, S) âˆ’dist (y, S)| â‰¤d (x, y) . This proves
the lemma.
Lemma 10.36 Let h be a C1 function deï¬ned on an open set, U and let K be a
compact subset of U. Then if Îµ > 0 is given, there exits r1 > 0 such that if |v| â‰¤r1,
then for all x âˆˆK,
|h (x + v) âˆ’h (x) âˆ’Dh (x) v| < Îµ |v| .

10.6.
CHANGE OF VARIABLES FOR C1 FUNCTIONS
287
Proof: Let 0 < Î´ < dist
Â¡
K, U CÂ¢
. Such a positive number exists because if there
exists a sequence of points in K, {kk} and points in U C, {sk} such that |kk âˆ’sk| â†’
0, then you could take a subsequence, still denoted by k such that kk â†’k âˆˆK and
then sk â†’k also. But U C is closed so k âˆˆK âˆ©U C, a contradiction. Then
|h (x + v) âˆ’h (x) âˆ’Dh (x) v|
|v|
â‰¤
Â¯Â¯Â¯
R 1
0 Dh (x + tv) vdt âˆ’Dh (x) v
Â¯Â¯Â¯
|v|
â‰¤
R 1
0 |Dh (x + tv) v âˆ’Dh (x) v| dt
|v|
.
Now from uniform continuity of Dh on the compact set, {x : dist (x,K) â‰¤Î´} it
follows there exists r1 < Î´ such that if |v| â‰¤r1, then ||Dh (x + tv) âˆ’Dh (x)|| < Îµ
for every x âˆˆK. From the above formula, it follows that if |v| â‰¤r1,
|h (x + v) âˆ’h (x) âˆ’Dh (x) v|
|v|
â‰¤
R 1
0 |Dh (x + tv) v âˆ’Dh (x) v| dt
|v|
<
R 1
0 Îµ |v| dt
|v|
= Îµ.
This proves the lemma.
A diï¬€erent proof of the following is in [35]. See also [36].
Lemma 10.37 (Sard) Let U be an open set in Rn and let h : U â†’Rn be C1. Let
Z â‰¡{x âˆˆU : det Dh (x) = 0} .
Then mn (h (Z)) = 0.
Proof: Let {Uk}âˆž
k=1 be an increasing sequence of open sets whose closures are
compact and whose union equals U and let Zk â‰¡Z âˆ©Uk. To obtain such a sequence,
let Uk =
Â©
x âˆˆU : dist
Â¡
x,U CÂ¢
< 1
k
Âª
âˆ©B (0, k) . First it is shown that h (Zk) has
measure zero. Let W be an open set contained in Uk+1 which contains Zk and
satisï¬es
mn (Zk) + Îµ > mn (W)
where here and elsewhere, Îµ < 1. Let
r = dist
Â¡
Uk, U C
k+1
Â¢
and let r1 > 0 be a constant as in Lemma 10.36 such that whenever x âˆˆUk and
0 < |v| â‰¤r1,
|h (x + v) âˆ’h (x) âˆ’Dh (x) v| < Îµ |v| .
(10.17)
Now the closures of balls which are contained in W and which have the property
that their diameters are less than r1 yield a Vitali covering of W. Therefore, by
Corollary 10.21 there is a disjoint sequence of these closed balls,
n
eBi
o
such that
W = âˆªâˆž
i=1 eBi âˆªN

288
LEBESGUE MEASURE
where N is a set of measure zero. Denote by {Bi} those closed balls in this sequence
which have nonempty intersection with Zk, let di be the diameter of Bi, and let zi
be a point in Bi âˆ©Zk. Since zi âˆˆZk, it follows Dh (zi) B (0,di) = Di where Di is
contained in a subspace, V which has dimension n âˆ’1 and the diameter of Di is no
larger than 2Ckdi where
Ck â‰¥max {||Dh (x)|| : x âˆˆZk}
Then by 10.17, if z âˆˆBi,
h (z) âˆ’h (zi) âˆˆDi + B (0, Îµdi) âŠ†Di + B (0,Îµdi) .
Thus
h (Bi) âŠ†h (zi) + Di + B (0,Îµdi)
By Lemma 10.33
mn (h (Bi))
â‰¤
2n (2Ckdi + Îµdi)nâˆ’1 Îµdi
â‰¤
dn
i
Â³
2n [2Ck + Îµ]nâˆ’1Â´
Îµ
â‰¤
Cn,kmn (Bi) Îµ.
Therefore, by Lemma 10.22
mn (h (Zk))
â‰¤
mn (W) =
X
i
mn (h (Bi)) â‰¤Cn,kÎµ
X
i
mn (Bi)
â‰¤
ÎµCn,kmn (W) â‰¤ÎµCn,k (mn (Zk) + Îµ)
Since Îµ is arbitrary, this shows mn (h (Zk)) = 0 and so 0 = limkâ†’âˆžmn (h (Zk)) =
mn (h (Z)).
With this important lemma, here is a generalization of Theorem 10.32.
Theorem 10.38 Let U be an open set and let h be a 1âˆ’1, C1 function with values
in Rn. Then if g is a nonnegative Lebesgue measurable function,
Z
h(U)
g (y) dy =
Z
U
g (h (x)) |det (Dh (x))| dx.
(10.18)
Proof: Let Z = {x : det (Dh (x)) = 0} . Then by the inverse function theorem,
hâˆ’1 is C1 on h (U \ Z) and h (U \ Z) is an open set. Therefore, from Lemma 10.37
and Theorem 10.32,
Z
h(U)
g (y) dy
=
Z
h(U\Z)
g (y) dy =
Z
U\Z
g (h (x)) |det (Dh (x))| dx
=
Z
U
g (h (x)) |det (Dh (x))| dx.
This proves the theorem.
Of course the next generalization considers the case when h is not even one to
one.

10.7.
MAPPINGS WHICH ARE NOT ONE TO ONE
289
10.7
Mappings Which Are Not One To One
Now suppose h is only C1, not necessarily one to one. For
U+ â‰¡{x âˆˆU : |det Dh (x)| > 0}
and Z the set where |det Dh (x)| = 0, Lemma 10.37 implies mn(h(Z)) = 0. For
x âˆˆU+, the inverse function theorem implies there exists an open set Bx such that
x âˆˆBx âŠ†U+, h is one to one on Bx.
Let {Bi} be a countable subset of {Bx}xâˆˆU+ such that U+ = âˆªâˆž
i=1Bi.
Let
E1 = B1. If E1, Â· Â· Â·, Ek have been chosen, Ek+1 = Bk+1 \ âˆªk
i=1Ei. Thus
âˆªâˆž
i=1Ei = U+, h is one to one on Ei, Ei âˆ©Ej = âˆ…,
and each Ei is a Borel set contained in the open set Bi. Now deï¬ne
n(y) â‰¡
âˆž
X
i=1
Xh(Ei)(y) + Xh(Z)(y).
The set, h (Ei) , h (Z) are measurable by Lemma 10.23. Thus n (Â·) is measurable.
Lemma 10.39
Let F âŠ†h(U) be measurable. Then
Z
h(U)
n(y)XF (y)dy =
Z
U
XF (h(x))| det Dh(x)|dx.
Proof: Using Lemma 10.37 and the Monotone Convergence Theorem or Fubiniâ€™s
Theorem,
Z
h(U)
n(y)XF (y)dy
=
Z
h(U)
ï£«
ï£¬
ï£­
âˆž
X
i=1
Xh(Ei)(y) +
mn(h(Z))=0
z
}|
{
Xh(Z)(y)
ï£¶
ï£·
ï£¸XF (y)dy
=
âˆž
X
i=1
Z
h(U)
Xh(Ei)(y)XF (y)dy
=
âˆž
X
i=1
Z
h(Bi)
Xh(Ei)(y)XF (y)dy
=
âˆž
X
i=1
Z
Bi
XEi(x)XF (h(x))| det Dh(x)|dx
=
âˆž
X
i=1
Z
U
XEi(x)XF (h(x))| det Dh(x)|dx
=
Z
U
âˆž
X
i=1
XEi(x)XF (h(x))| det Dh(x)|dx

290
LEBESGUE MEASURE
=
Z
U+
XF (h(x))| det Dh(x)|dx =
Z
U
XF (h(x))| det Dh(x)|dx.
This proves the lemma.
Deï¬nition 10.40
For y âˆˆh(U), deï¬ne a function, #, according to the formula
#(y) â‰¡number of elements in hâˆ’1(y).
Observe that
#(y) = n(y)
a.e.
(10.19)
because n(y) = #(y) if y /âˆˆh(Z), a set of measure 0. Therefore, # is a measurable
function.
Theorem 10.41
Let g â‰¥0, g measurable, and let h be C1(U). Then
Z
h(U)
#(y)g(y)dy =
Z
U
g(h(x))| det Dh(x)|dx.
(10.20)
Proof: From 10.19 and Lemma 10.39, 10.20 holds for all g, a nonnegative simple
function. Approximating an arbitrary measurable nonnegative function, g, with an
increasing pointwise convergent sequence of simple functions and using the mono-
tone convergence theorem, yields 10.20 for an arbitrary nonnegative measurable
function, g. This proves the theorem.
10.8
Lebesgue Measure And Iterated Integrals
The following is the main result.
Theorem 10.42 Let f â‰¥0 and suppose f is a Lebesgue measurable function de-
ï¬ned on Rn and
R
Rn fdmn < âˆž. Then
Z
Rn fdmn =
Z
Rk
Z
Rnâˆ’k fdmnâˆ’kdmk.
This will be accomplished by Fubiniâ€™s theorem, Theorem 9.50 and the following
lemma.
Lemma 10.43 mk Ã— mnâˆ’k = mn on the mn measurable sets.
Proof: First of all, let R = Qn
i=1(ai, bi] be a measurable rectangle and let
Rk = Qk
i=1(ai, bi], Rnâˆ’k = Qn
i=k+1(ai, bi]. Then by Fubiniâ€™s theorem,
Z
XRd (mk Ã— mnâˆ’k)
=
Z
Rk
Z
Rnâˆ’k XRkXRnâˆ’kdmkdmnâˆ’k
=
Z
Rk XRkdmk
Z
Rnâˆ’k XRnâˆ’kdmnâˆ’k
=
Z
XRdmn

10.8.
LEBESGUE MEASURE AND ITERATED INTEGRALS
291
and so mk Ã— mnâˆ’k
and mn agree on every half open rectangle. By Lemma 10.2
these two measures agree on every open set.
Now if K is a compact set, then
K = âˆ©âˆž
k=1Uk where Uk is the open set, K + B
Â¡
0, 1
k
Â¢
. Another way of saying this
is Uk â‰¡
Â©
x : dist (x,K) < 1
k
Âª
which is obviously open because x â†’dist (x,K) is a
continuous function. Since K is the countable intersection of these decreasing open
sets, each of which has ï¬nite measure with respect to either of the two measures,
it follows that mk Ã— mnâˆ’k and mn agree on all the compact sets. Now let E be
a bounded Lebesgue measurable set.
Then there are sets, H and G such that
H is a countable union of compact sets, G a countable intersection of open sets,
H âŠ†E âŠ†G, and mn (G \ H) = 0. Then from what was just shown about compact
and open sets, the two measures agree on G and on H. Therefore,
mn (H)
=
mk Ã— mnâˆ’k (H) â‰¤mk Ã— mnâˆ’k (E)
â‰¤
mk Ã— mnâˆ’k (G) = mn (E) = mn (H)
By completeness of the measure space for mk Ã— mnâˆ’k, it follows E is mk Ã— mnâˆ’k
measurable and
mk Ã— mnâˆ’k (E) = mn (E) .
This proves the lemma.
You could also show that the two Ïƒ algebras are the same. However, this is not
needed for the lemma or the theorem.
Proof of Theorem 10.42: By the lemma and Fubiniâ€™s theorem, Theorem 9.50,
Z
Rn fdmn =
Z
Rn fd (mk Ã— mnâˆ’k) =
Z
Rk
Z
Rnâˆ’k fdmnâˆ’kdmk.
Corollary 10.44 Let f be a nonnegative real valued measurable function. Then
Z
Rn fdmn =
Z
Rk
Z
Rnâˆ’k fdmnâˆ’kdmk.
Proof: Let Sp â‰¡{x âˆˆRn : 0 â‰¤f (x) â‰¤p} âˆ©B (0, p) . Then
R
Rn fXSpdmn < âˆž.
Therefore, from Theorem 10.42,
Z
Rn fXSpdmn =
Z
Rk
Z
Rnâˆ’k XSpfdmnâˆ’kdmk.
Now let p â†’âˆžand use the Monotone convergence theorem and the Fubini Theorem
9.50 on Page 243.
Not surprisingly, the following corollary follows from this.
Corollary 10.45 Let f âˆˆL1 (Rn) where the measure is mn.
Then
Z
Rn fdmn =
Z
Rk
Z
Rnâˆ’k fdmnâˆ’kdmk.
Proof: Apply Corollary 10.44 to the postive and negative parts of the real and
imaginary parts of f.

292
LEBESGUE MEASURE
10.9
Spherical Coordinates In Many Dimensions
Sometimes there is a need to deal with spherical coordinates in more than three
dimensions. In this section, this concept is deï¬ned and formulas are derived for
these coordinate systems. Recall polar coordinates are of the form
y1 = Ï cos Î¸
y2 = Ï sin Î¸
where Ï > 0 and Î¸ âˆˆ[0, 2Ï€). Here I am writing Ï in place of r to emphasize a pattern
which is about to emerge. I will consider polar coordinates as spherical coordinates
in two dimensions.
I will also simply refer to such coordinate systems as polar
coordinates regardless of the dimension. This is also the reason I am writing y1 and
y2 instead of the more usual x and y. Now consider what happens when you go to
three dimensions. The situation is depicted in the following picture.
Ï†1





Ï
r(x1, x2, x3)
R2
R
From this picture, you see that y3 = Ï cos Ï†1. Also the distance between (y1, y2)
and (0, 0) is Ï sin (Ï†1) . Therefore, using polar coordinates to write (y1, y2) in terms
of Î¸ and this distance,
y1 = Ï sin Ï†1 cos Î¸,
y2 = Ï sin Ï†1 sin Î¸,
y3 = Ï cos Ï†1.
where Ï†1 âˆˆ[0, Ï€] . What was done is to replace Ï with Ï sin Ï†1 and then to add in
y3 = Ï cos Ï†1. Having done this, there is no reason to stop with three dimensions.
Consider the following picture:
Ï†2





Ï
r(x1, x2, x3, x4)
R3
R
From this picture, you see that y4 = Ï cos Ï†2. Also the distance between (y1, y2, y3)
and (0, 0, 0) is Ï sin (Ï†2) . Therefore, using polar coordinates to write (y1, y2, y3) in

10.9.
SPHERICAL COORDINATES IN MANY DIMENSIONS
293
terms of Î¸, Ï†1, and this distance,
y1 = Ï sin Ï†2 sin Ï†1 cos Î¸,
y2 = Ï sin Ï†2 sin Ï†1 sin Î¸,
y3 = Ï sin Ï†2 cos Ï†1,
y4 = Ï cos Ï†2
where Ï†2 âˆˆ[0, Ï€] .
Continuing this way, given spherical coordinates in Rn, to get the spherical
coordinates in Rn+1, you let yn+1 = Ï cos Ï†nâˆ’1 and then replace every occurance of
Ï with Ï sin Ï†nâˆ’1 to obtain y1 Â· Â· Â· yn in terms of Ï†1, Ï†2, Â· Â· Â·, Ï†nâˆ’1,Î¸, and Ï.
It is always the case that Ï measures the distance from the point in Rn to the
origin in Rn, 0. Each Ï†i âˆˆ[0, Ï€] , and Î¸ âˆˆ[0, 2Ï€). It can be shown using math
induction that these coordinates map Qnâˆ’2
i=1 [0, Ï€] Ã— [0, 2Ï€) Ã— (0, âˆž) one to one onto
Rn \ {0} .
Theorem 10.46 Let y = h (Ï†, Î¸, Ï) be the spherical coordinate transformations in
Rn. Then letting A = Qnâˆ’2
i=1 [0, Ï€] Ã— [0, 2Ï€), it follows h maps A Ã— (0, âˆž) one to one
onto Rn \ {0} . Also |det Dh (Ï†, Î¸, Ï)| will always be of the form
|det Dh (Ï†, Î¸, Ï)| = Ïnâˆ’1Î¦ (Ï†, Î¸) .
(10.21)
where Î¦ is a continuous function of Ï† and Î¸.1 Furthermore whenever f is Lebesgue
measurable and nonnegative,
Z
Rn f (y) dy =
Z âˆž
0
Ïnâˆ’1
Z
A
f (h (Ï†, Î¸, Ï)) Î¦ (Ï†, Î¸) dÏ† dÎ¸dÏ
(10.22)
where here dÏ† dÎ¸ denotes dmnâˆ’1 on A. The same formula holds if f âˆˆL1 (Rn) .
Proof: Formula 10.21 is obvious from the deï¬nition of the spherical coordinates.
The ï¬rst claim is also clear from the deï¬nition and math induction. It remains to
verify 10.22. Let A0 â‰¡Qnâˆ’2
i=1 (0, Ï€)Ã—(0, 2Ï€) . Then it is clear that (A \ A0)Ã—(0, âˆž) â‰¡
N is a set of measure zero in Rn. Therefore, from Lemma 10.22 it follows h (N)
is also a set of measure zero. Therefore, using the change of variables theorem,
Corollary 10.44, and Sardâ€™s lemma,
Z
Rn f (y) dy
=
Z
Rn\{0}
f (y) dy =
Z
Rn\({0}âˆªh(N))
f (y) dy
=
Z
A0Ã—(0,âˆž)
f (h (Ï†, Î¸, Ï)) Ïnâˆ’1Î¦ (Ï†, Î¸) dmn
=
Z
XAÃ—(0,âˆž) (Ï†, Î¸, Ï) f (h (Ï†, Î¸, Ï)) Ïnâˆ’1Î¦ (Ï†, Î¸) dmn
=
Z âˆž
0
Ïnâˆ’1
ÂµZ
A
f (h (Ï†, Î¸, Ï)) Î¦ (Ï†, Î¸) dÏ† dÎ¸
Â¶
dÏ.
1Actually it is only a function of the ï¬rst but this is not important in what follows.

294
LEBESGUE MEASURE
Now the claim about f âˆˆL1 follows routinely from considering the positive and
negative parts of the real and imaginary parts of f in the usual way. This proves
the theorem.
Notation 10.47 Often this is written diï¬€erently. Note that from the spherical co-
ordinate formulas, f (h (Ï†, Î¸, Ï)) = f (ÏÏ‰) where |Ï‰| = 1. Letting Snâˆ’1 denote the
unit sphere, {Ï‰ âˆˆRn : |Ï‰| = 1} , the inside integral in the above formula is some-
times written as
Z
Snâˆ’1 f (ÏÏ‰) dÏƒ
where Ïƒ is a measure on Snâˆ’1. See [35] for another description of this measure.
It isnâ€™t an important issue here. Later in the book when integration on manifolds
is discussed, more general considerations will be dealt with. Either 10.22 or the
formula
Z âˆž
0
Ïnâˆ’1
ÂµZ
Snâˆ’1 f (ÏÏ‰) dÏƒ
Â¶
dÏ
will be referred to as polar coordinates and is very useful in establishing estimates.
Here Ïƒ
Â¡
Snâˆ’1Â¢
â‰¡
R
A Î¦ (Ï†, Î¸) dÏ† dÎ¸.
Example 10.48 For what values of s is the integral
R
B(0,R)
Â³
1 + |x|2Â´s
dy bounded
independent of R? Here B (0, R) is the ball, {x âˆˆRn : |x| â‰¤R} .
I think you can see immediately that s must be negative but exactly how neg-
ative? It turns out it depends on n and using polar coordinates, you can ï¬nd just
exactly what is needed. From the polar coordinats formula above,
Z
B(0,R)
Â³
1 + |x|2Â´s
dy
=
Z R
0
Z
Snâˆ’1
Â¡
1 + Ï2Â¢s Ïnâˆ’1dÏƒdÏ
=
Cn
Z R
0
Â¡
1 + Ï2Â¢s Ïnâˆ’1dÏ
Now the very hard problem has been reduced to considering an easy one variable
problem of ï¬nding when
Z R
0
Ïnâˆ’1 Â¡
1 + Ï2Â¢s dÏ
is bounded independent of R. You need 2s + (n âˆ’1) < âˆ’1 so you need s < âˆ’n/2.
10.10
The Brouwer Fixed Point Theorem
This seems to be a good place to present a short proof of one of the most important
of all ï¬xed point theorems.
There are many approaches to this but one of the
easiest and shortest I have ever seen is the one in Dunford and Schwartz [18]. This
is what is presented here. In Evans [21] there is a diï¬€erent proof which depends on

10.10.
THE BROUWER FIXED POINT THEOREM
295
integration theory. A good reference for an introduction to various kinds of ï¬xed
point theorems is the book by Smart [48]. This book also gives an entirely diï¬€erent
approach to the Brouwer ï¬xed point theorem.
The proof given here is based on the following lemma. Recall that the mixed
partial derivatives of a C2 function are equal. In the following lemma, and elsewhere,
a comma followed by an index indicates the partial derivative with respect to the
indicated variable. Thus, f,j will mean
âˆ‚f
âˆ‚xj . Also, write Dg for the Jacobian matrix
which is the matrix of Dg taken with respect to the usual basis vectors in Rn. Recall
that for A an n Ã— n matrix, cof (A)ij is the determinant of the matrix which results
from deleting the ith row and the jth column and multiplying by (âˆ’1)i+j.
Lemma 10.49 Let g : U â†’Rn be C2 where U is an open subset of Rn. Then
n
X
j=1
cof (Dg)ij,j = 0,
where here (Dg)ij â‰¡gi,j â‰¡âˆ‚gi
âˆ‚xj . Also, cof (Dg)ij = âˆ‚det(Dg)
âˆ‚gi,j
.
Proof: From the cofactor expansion theorem,
det (Dg) =
n
X
i=1
gi,j cof (Dg)ij
and so
âˆ‚det (Dg)
âˆ‚gi,j
= cof (Dg)ij
(10.23)
which shows the last claim of the lemma. Also
Î´kj det (Dg) =
X
i
gi,k (cof (Dg))ij
(10.24)
because if k Ì¸= j this is just the cofactor expansion of the determinant of a matrix
in which the kth and jth columns are equal. Diï¬€erentiate 10.24 with respect to xj
and sum on j. This yields
X
r,s,j
Î´kj
âˆ‚(det Dg)
âˆ‚gr,s
gr,sj =
X
ij
gi,kj (cof (Dg))ij +
X
ij
gi,k cof (Dg)ij,j .
Hence, using Î´kj = 0 if j Ì¸= k and 10.23,
X
rs
(cof (Dg))rs gr,sk =
X
rs
gr,ks (cof (Dg))rs +
X
ij
gi,kcof (Dg)ij,j .
Subtracting the ï¬rst sum on the right from both sides and using the equality of
mixed partials,
X
i
gi,k
ï£«
ï£­X
j
(cof (Dg))ij,j
ï£¶
ï£¸= 0.

296
LEBESGUE MEASURE
If det (gi,k) Ì¸= 0 so that (gi,k) is invertible, this shows P
j (cof (Dg))ij,j = 0. If
det (Dg) = 0, let
gk = g + ÎµkI
where Îµk â†’0 and det (Dg + ÎµkI) â‰¡det (Dgk) Ì¸= 0. Then
X
j
(cof (Dg))ij,j = lim
kâ†’âˆž
X
j
(cof (Dgk))ij,j = 0
and this proves the lemma.
To prove the Brouwer ï¬xed point theorem, ï¬rst consider a version of it valid for
C2 mappings. This is the following lemma.
Lemma 10.50 Let Br = B (0,r) and suppose g is a C2 function deï¬ned on Rn
which maps Br to Br. Then g (x) = x for some x âˆˆBr.
Proof: Suppose not. Then |g (x) âˆ’x| must be bounded away from zero on Br.
Let a (x) be the larger of the two roots of the equation,
|x+a (x) (x âˆ’g (x))|2 = r2.
(10.25)
Thus
a (x) =
âˆ’(x, (x âˆ’g (x))) +
r
(x, (x âˆ’g (x)))2 +
Â³
r2 âˆ’|x|2Â´
|x âˆ’g (x)|2
|x âˆ’g (x)|2
(10.26)
The expression under the square root sign is always nonnegative and it follows
from the formula that a (x) â‰¥0. Therefore, (x, (x âˆ’g (x))) â‰¥0 for all x âˆˆBr.
The reason for this is that a (x) is the larger zero of a polynomial of the form
p (z) = |x|2 + z2 |x âˆ’g (x)|2 âˆ’2z (x, x âˆ’g (x)) and from the formula above, it is
nonnegative. âˆ’2 (x, x âˆ’g (x)) is the slope of the tangent line to p (z) at z = 0. If
x Ì¸= 0, then |x|2 > 0 and so this slope needs to be negative for the larger of the two
zeros to be positive. If x = 0, then (x, x âˆ’g (x)) = 0.
Now deï¬ne for t âˆˆ[0, 1],
f (t, x) â‰¡x+ta (x) (x âˆ’g (x)) .
The important properties of f (t, x) and a (x) are that
a (x) = 0 if |x| = r.
(10.27)
and
|f (t, x)| = r for all |x| = r
(10.28)
These properties follow immediately from 10.26 and the above observation that for
x âˆˆBr, it follows (x, (x âˆ’g (x))) â‰¥0.
Also from 10.26, a is a C2 function near Br. This is obvious from 10.26 as long
as |x| < r. However, even if |x| = r it is still true. To show this, it suï¬ƒces to verify

10.10.
THE BROUWER FIXED POINT THEOREM
297
the expression under the square root sign is positive. If this expression were not
positive for some |x| = r, then (x, (x âˆ’g (x))) = 0. Then also, since g (x) Ì¸= x,
Â¯Â¯Â¯Â¯
g (x) + x
2
Â¯Â¯Â¯Â¯ < r
and so
r2 >
Âµ
x,g (x) + x
2
Â¶
= 1
2 (x, g (x)) + r2
2 = |x|2
2
+ r2
2 = r2,
a contradiction. Therefore, the expression under the square root in 10.26 is always
positive near Br and so a is a C2 function near Br as claimed because the square
root function is C2 away from zero.
Now deï¬ne
I (t) â‰¡
Z
Br
det (D2f (t, x)) dx.
Then
I (0) =
Z
Br
dx = mn (Br) > 0.
(10.29)
Using the dominated convergence theorem one can diï¬€erentiate I (t) as follows.
Iâ€² (t)
=
Z
Br
X
ij
âˆ‚det (D2f (t, x))
âˆ‚fi,j
âˆ‚fi,j
âˆ‚t dx
=
Z
Br
X
ij
cof (D2f)ij
âˆ‚(a (x) (xi âˆ’gi (x)))
âˆ‚xj
dx.
Now from 10.27 a (x) = 0 when |x| = r and so integration by parts and Lemma
10.49 yields
Iâ€² (t)
=
Z
Br
X
ij
cof (D2f)ij
âˆ‚(a (x) (xi âˆ’gi (x)))
âˆ‚xj
dx
=
âˆ’
Z
Br
X
ij
cof (D2f)ij,j a (x) (xi âˆ’gi (x)) dx = 0.
Therefore, I (1) = I (0). However, from 10.25 it follows that for t = 1,
X
i
fifi = r2
and so, P
i fi,jfi = 0 which implies since |f (1, x)| = r by 10.25, that det (fi,j) =
det (D2f (1, x)) = 0 and so I (1) = 0, a contradiction to 10.29 since I (1) = I (0).
This proves the lemma.
The following theorem is the Brouwer ï¬xed point theorem for a ball.
Theorem 10.51 Let Br be the above closed ball and let f : Br â†’Br be continuous.
Then there exists x âˆˆBr such that f (x) = x.

298
LEBESGUE MEASURE
Proof: Let fk (x) â‰¡
f(x)
1+kâˆ’1 . Thus ||fk âˆ’f|| <
r
1+k where
||h|| â‰¡max {|h (x)| : x âˆˆBr} .
Using the Weierstrass approximation theorem, there exists a polynomial gk such
that ||gk âˆ’fk|| <
r
k+1. Then if x âˆˆBr, it follows
|gk (x)|
â‰¤
|gk (x) âˆ’fk (x)| + |fk (x)|
<
r
1 + k +
kr
1 + k = r
and so gk maps Br to Br. By Lemma 10.50 each of these gk has a ï¬xed point, xk
such that gk (xk) = xk. The sequence of points, {xk} is contained in the compact
set, Br and so there exists a convergent subsequence still denoted by {xk} which
converges to a point, x âˆˆBr. Then
|f (x) âˆ’x|
â‰¤
|f (x) âˆ’fk (x)| + |fk (x) âˆ’fk (xk)| +
Â¯Â¯Â¯Â¯Â¯Â¯
fk (xk) âˆ’
=xk
z }| {
gk (xk)
Â¯Â¯Â¯Â¯Â¯Â¯
+ |xk âˆ’x|
â‰¤
r
1 + k + |f (x) âˆ’f (xk)| +
r
1 + k + |xk âˆ’x| .
Now let k â†’âˆžin the right side to conclude f (x) = x. This proves the theorem.
It is not surprising that the ball does not need to be centered at 0.
Corollary 10.52 Let f : B (a, r) â†’B (a, r) be continuous. Then there exists x âˆˆ
B (a, r) such that f (x) = x.
Proof: Let g : Br â†’Br be deï¬ned by g (y) â‰¡f (y + a) âˆ’a. Then g is a
continuous map from Br to Br. Therefore, there exists y âˆˆBr such that g (y) = y.
Therefore, f (y + a) âˆ’a = y and so letting x = y + a, f also has a ï¬xed point as
claimed.
10.11
The Brouwer Fixed Point Theorem Another
Proof
This proof is also based on Lemma 10.49. I found this proof of the Brouwer ï¬xed
point theorem or one close to it in Evans [21]. It is even shorter than the proof just
presented. I think it might be easier to remember also. It is also based on Lemma
10.49 which is stated next for convenience.
Lemma 10.53 Let g : U â†’Rn be C2 where U is an open subset of Rn. Then
n
X
j=1
cof (Dg)ij,j = 0,
where here (Dg)ij â‰¡gi,j â‰¡âˆ‚gi
âˆ‚xj . Also, cof (Dg)ij = âˆ‚det(Dg)
âˆ‚gi,j
.

10.11.
THE BROUWER FIXED POINT THEOREM ANOTHER PROOF
299
Deï¬nition 10.54 Let h be a function deï¬ned on an open set, U âŠ†Rn. Then
h âˆˆCk Â¡
U
Â¢
if there exists a function g deï¬ned on an open set, W containng U such
that g = h on U and g is Ck (W) .
Lemma 10.55 There does not exist h âˆˆC2 Â³
B (0, R)
Â´
such that h :B (0, R) â†’
âˆ‚B (0, R) which also has the property that h (x) = x for all x âˆˆâˆ‚B (0, R) . Such a
function is called a retraction.
Proof: Suppose such an h exists. Let Î» âˆˆ[0, 1] and let pÎ» (x) â‰¡x+Î» (h (x) âˆ’x) .
This function, pÎ» is a homotopy of the identity map and the retraction, h. Let
I (Î») â‰¡
Z
B(0,R)
det (DpÎ» (x)) dx.
Then using the dominated convergence theorem,
Iâ€² (Î»)
=
Z
B(0,R)
X
i.j
âˆ‚det (DpÎ» (x))
âˆ‚pÎ»i,j
âˆ‚pÎ»ij (x)
âˆ‚Î»
=
Z
B(0,R)
X
i
X
j
âˆ‚det (DpÎ» (x))
âˆ‚pÎ»i,j
(hi (x) âˆ’xi),j dx
=
Z
B(0,R)
X
i
X
j
cof (DpÎ» (x))ij (hi (x) âˆ’xi),j dx
Now by assumption, hi (x) = xi on âˆ‚B (0, R) and so one can integrate by parts and
write
Iâ€² (Î») = âˆ’
X
i
Z
B(0,R)
X
j
cof (DpÎ» (x))ij,j (hi (x) âˆ’xi) dx = 0.
Therefore, I (Î») equals a constant. However,
I (0) = mn (B (0, R)) > 0
but
I (1) =
Z
B(0,1)
det (Dh (x)) dmn =
Z
âˆ‚B(0,1)
# (y) dmn = 0
because from polar coordinates or other elementary reasoning, mn (âˆ‚B (0, 1)) = 0.
This proves the lemma.
The following is the Brouwer ï¬xed point theorem for C2 maps.
Lemma 10.56 If h âˆˆC2 Â³
B (0, R)
Â´
and h : B (0, R) â†’B (0, R), then h has a
ï¬xed point, x such that h (x) = x.
Proof: Suppose the lemma is not true. Then for all x, |x âˆ’h (x)| Ì¸= 0. Then
deï¬ne
g (x) = h (x) + x âˆ’h (x)
|x âˆ’h (x)|t (x)

300
LEBESGUE MEASURE
where t (x) is nonnegative and is chosen such that g (x) âˆˆâˆ‚B (0, R) . This mapping
is illustrated in the following picture.
tf(x)
t
x
Â¡
Â¡
Â¡
Â¡
t
g(x)
If x â†’t (x) is C2 near B (0, R), it will follow g is a C2 retraction onto âˆ‚B (0, R)
contrary to Lemma 10.55. Thus t (x) is the nonnegative solution to
H (x, t) = |h (x)|2 + 2
Âµ
h (x) , x âˆ’h (x)
|x âˆ’h (x)|
Â¶
t + t2 = R2
(10.30)
Then
Ht (x, t) = 2
Âµ
h (x) , x âˆ’h (x)
|x âˆ’h (x)|
Â¶
+ 2t.
If this is nonzero for all x near B (0, R), it follows from the implicit function theorem
that t is a C2 function of x. Then from 10.30
2t
=
âˆ’2
Âµ
h (x) , x âˆ’h (x)
|x âˆ’h (x)|
Â¶
Â±
s
4
Âµ
h (x) , x âˆ’h (x)
|x âˆ’h (x)|
Â¶2
âˆ’4
Â³
|h (x)|2 âˆ’R2
Â´
and so
Ht (x, t)
=
2t + 2
Âµ
h (x) , x âˆ’h (x)
|x âˆ’h (x)|
Â¶
=
Â±
s
4
Â³
R2 âˆ’|h (x)|2Â´
+ 4
Âµ
h (x) , x âˆ’h (x)
|x âˆ’h (x)|
Â¶2
If |h (x)| < R, this is nonzero. If |h (x)| = R, then it is still nonzero unless
(h (x) , x âˆ’h (x)) = 0.
But this cannot happen because the angle between h (x) and x âˆ’h (x) cannot be
Ï€/2. Alternatively, if the above equals zero, you would need
(h (x) , x) = |h (x)|2 = R2
which cannot happen unless x = h (x) which is assumed not to happen. Therefore,
x â†’t (x) is C2 near B (0, R) and so g (x) given above contradicts Lemma 10.55.
This proves the lemma.
Now it is easy to prove the Brouwer ï¬xed point theorem.

10.11.
THE BROUWER FIXED POINT THEOREM ANOTHER PROOF
301
Theorem 10.57 Let f : B (0, R) â†’B (0, R) be continuous. Then f has a ï¬xed
point.
Proof: If this is not so, there exists Îµ > 0 such that for all x âˆˆB (0, R),
|x âˆ’f (x)| > Îµ.
By the Weierstrass approximation theorem, there exists h, a polynomial such that
max
n
|h (x) âˆ’f (x)| : x âˆˆB (0, R)
o
< Îµ
2.
Then for all x âˆˆB (0, R),
|x âˆ’h (x)| â‰¥|x âˆ’f (x)| âˆ’|h (x) âˆ’f (x)| > Îµ âˆ’Îµ
2 = Îµ
2
contradicting Lemma 10.56. This proves the theorem.

302
LEBESGUE MEASURE

Some Extension Theorems
11.1
Caratheodory Extension Theorem
The Caratheodory extension theorem is a fundamental result which makes possible
the consideration of measures on inï¬nite products among other things. The idea is
that if a ï¬nite measure deï¬ned only on an algebra is trying to be a measure, then
in fact it can be extended to a measure.
Deï¬nition 11.1 Let E be an algebra of sets of â„¦and let Âµ0 be a ï¬nite measure on
E. This means Âµ0 is ï¬nitely additive and if Ei, E are sets of E with the Ei disjoint
and
E = âˆªâˆž
i=1Ei,
then
Âµ0 (E) =
âˆž
X
i=1
Âµ (Ei)
while Âµ0 (â„¦) < âˆž.
In this deï¬nition, Âµ0 is trying to be a measure and acts like one whenever pos-
sible. Under these conditions, Âµ0 can be extended uniquely to a complete measure,
Âµ, deï¬ned on a Ïƒ algebra of sets containing E such that Âµ agrees with Âµ0 on E. The
following is the main result.
Theorem 11.2 Let Âµ0 be a measure on an algebra of sets, E, which satisï¬es
Âµ0 (â„¦) < âˆž. Then there exists a complete measure space (â„¦, S, Âµ) such that
Âµ (E) = Âµ0 (E)
for all E âˆˆE. Also if Î½ is any such measure which agrees with Âµ0 on E, then Î½ = Âµ
on Ïƒ (E), the Ïƒ algebra generated by E.
Proof: Deï¬ne an outer measure as follows.
Âµ (S) â‰¡inf
( âˆž
X
i=1
Âµ0 (Ei) : S âŠ†âˆªâˆž
i=1Ei, Ei âˆˆE
)
303

304
SOME EXTENSION THEOREMS
Claim 1: Âµ is an outer measure.
Proof of Claim 1: Let S âŠ†âˆªâˆž
i=1Si and let Si âŠ†âˆªâˆž
j=1Eij, where
Âµ (Si) + Îµ
2i â‰¥
âˆž
X
j=1
Âµ (Eij) .
Then
Âµ (S) â‰¤
X
i
X
j
Âµ (Eij) =
X
i
Â³
Âµ (Si) + Îµ
2i
Â´
=
X
i
Âµ (Si) + Îµ.
Since Îµ is arbitrary, this shows Âµ is an outer measure as claimed.
By the Caratheodory procedure, there exists a unique Ïƒ algebra, S, consisting
of the Âµ measurable sets such that
(â„¦, S, Âµ)
is a complete measure space. It remains to show Âµ extends Âµ0.
Claim 2: If S is the Ïƒ algebra of Âµ measurable sets, S âŠ‡E and Âµ = Âµ0 on E.
Proof of Claim 2:
First observe that if A âˆˆE, then Âµ (A) â‰¤Âµ0 (A) by
deï¬nition. Letting
Âµ (A) + Îµ >
âˆž
X
i=1
Âµ0 (Ei) , âˆªâˆž
i=1EiâŠ‡A, Ei âˆˆE,
it follows
Âµ (A) + Îµ >
âˆž
X
i=1
Âµ0 (Ei âˆ©A) â‰¥Âµ0 (A)
since A = âˆªâˆž
i=1Ei âˆ©A. Therefore, Âµ = Âµ0 on E.
Consider the assertion that E âŠ†S. Let A âˆˆE and let S âŠ†â„¦be any set. There
exist sets {Ei} âŠ†E such that âˆªâˆž
i=1Ei âŠ‡S but
Âµ (S) + Îµ >
âˆž
X
i=1
Âµ (Ei) .
Then
Âµ (S) â‰¤Âµ (S âˆ©A) + Âµ (S \ A)
â‰¤Âµ (âˆªâˆž
i=1Ei \ A) + Âµ (âˆªâˆž
i=1 (Ei âˆ©A))
â‰¤
âˆž
X
i=1
Âµ (Ei\A) +
âˆž
X
i=1
Âµ (Ei âˆ©A) =
âˆž
X
i=1
Âµ (Ei) < Âµ (S) + Îµ.
Since Îµ is arbitrary, this shows A âˆˆS.
This has proved the existence part of the theorem. To verify uniqueness, Let
M â‰¡{E âˆˆÏƒ (E) : Âµ (E) = Î½ (E)} .
Then M is given to contain E and is obviously a monotone class. Therefore by
Theorem 9.57 on monotone classes, M = Ïƒ (E) and this proves the lemma.
The following lemma is also very signiï¬cant.

11.2.
THE TYCHONOFF THEOREM
305
Lemma 11.3 Let M be a metric space with the closed balls compact and suppose
Âµ is a measure deï¬ned on the Borel sets of M which is ï¬nite on compact sets.
Then there exists a unique Radon measure, Âµ which equals Âµ on the Borel sets. In
particular Âµ must be both inner and outer regular on all Borel sets.
Proof: Deï¬ne a positive linear functional, Î› (f) =
R
fdÂµ. Let Âµ be the Radon
measure which comes from the Riesz representation theorem for positive linear
functionals. Thus for all f continuous,
Z
fdÂµ =
Z
fdÂµ.
If V is an open set, let {fn} be a sequence of continuous functions which is increasing
and converges to XV pointwise. Then applying the monotone convergence theorem,
Z
XV dÂµ = Âµ (V ) =
Z
XV dÂµ = Âµ (V )
and so the two measures coincide on all open sets. Every compact set is a countable
intersection of open sets and so the two measures coincide on all compact sets. Now
let B (a, n) be a ball of radius n and let E be a Borel set contained in this ball.
Then by regularity of Âµ there exist sets F, G such that G is a countable intersection
of open sets and F is a countable union of compact sets such that F âŠ†E âŠ†G and
Âµ (G \ F) = 0. Now Âµ (G) = Âµ (G) and Âµ (F) = Âµ (F) . Thus
Âµ (G \ F) + Âµ (F)
=
Âµ (G)
=
Âµ (G) = Âµ (G \ F) + Âµ (F)
and so Âµ (G \ F) = Âµ (G \ F) . It follows
Âµ (E) = Âµ (F) = Âµ (F) = Âµ (G) = Âµ (E) .
If E is an arbitrary Borel set, then
Âµ (E âˆ©B (a, n)) = Âµ (E âˆ©B (a, n))
and letting n â†’âˆž, this yields Âµ (E) = Âµ (E) .
11.2
The Tychonoï¬€Theorem
Sometimes it is necessary to consider inï¬nite Cartesian products of topological
spaces. When you have ï¬nitely many topological spaces in the product and each is
compact, it can be shown that the Cartesian product is compact with the product
topology. It turns out that the same thing holds for inï¬nite products but you have
to be careful how you deï¬ne the topology. The ï¬rst thing likely to come to mind
by analogy with ï¬nite products is not the right way to do it.
First recall the Hausdorï¬€maximal principle.

306
SOME EXTENSION THEOREMS
Theorem 11.4 (Hausdorï¬€maximal principle) Let F be a nonempty partially or-
dered set. Then there exists a maximal chain.
The main tool in the study of products of compact topological spaces is the
Alexander subbasis theorem which is presented next. Recall a set is compact if
every basic open cover admits a ï¬nite subcover. This was pretty easy to prove.
However, there is a much smaller set of open sets called a subbasis which has this
property. The proof of this result is much harder.
Deï¬nition 11.5 S âŠ†Ï„ is called a subbasis for the topology Ï„ if the set B of ï¬nite
intersections of sets of S is a basis for the topology, Ï„.
Theorem 11.6 Let (X, Ï„) be a topological space and let S âŠ†Ï„ be a subbasis for
Ï„. Then if H âŠ†X, H is compact if and only if every open cover of H consisting
entirely of sets of S admits a ï¬nite subcover.
Proof: The only if part is obvious because the subasic sets are themselves open.
By Lemma 6.56 on Page 6.56, if every basic open cover admits a ï¬nite subcover
then the set in question is compact. Suppose then that H is a subset of X having
the property that subbasic open covers admit ï¬nite subcovers.
Is H compact?
Assume this is not so. Then what was just observed about basic covers implies
there exists a basic open cover of H, O, which admits no ï¬nite subcover. Let F be
deï¬ned as
{O : O is a basic open cover of H which admits no ï¬nite subcover}.
The assumption is that F is nonempty. Partially order F by set inclusion and use
the Hausdorï¬€maximal principle to obtain a maximal chain, C, of such open covers
and let
D = âˆªC.
If D admits a ï¬nite subcover, then since C is a chain and the ï¬nite subcover has only
ï¬nitely many sets, some element of C would also admit a ï¬nite subcover, contrary
to the deï¬nition of F. Therefore, D admits no ï¬nite subcover. If Dâ€² â«ŒD and Dâ€²
is a basic open cover of H, then Dâ€² has a ï¬nite subcover of H since otherwise, C
would fail to be a maximal chain, being properly contained in Câˆª{Dâ€²}. Every set
of D is of the form
U = âˆ©m
i=1Bi, Bi âˆˆS
because they are all basic open sets. If it is the case that for all U âˆˆD one of the
Bi is found in D, then replace each such U with the subbasic set from D containing
it. But then this would be a subbasic open cover of H which by assumption would
admit a ï¬nite subcover contrary to the properties of D. Therefore, one of the sets
of D, denoted by U, has the property that
U = âˆ©m
i=1Bi, Bi âˆˆS

11.2.
THE TYCHONOFF THEOREM
307
and no Bi is in D. Thus D âˆª{Bi} admits a ï¬nite subcover, for each of the above
Bi because it is strictly larger than D. Let this ï¬nite subcover corresponding to Bi
be denoted by
V i
1 , Â· Â· Â·, V i
mi, Bi
Consider
{U, V i
j , j = 1, Â· Â· Â·, mi, i = 1, Â· Â· Â·, m}.
If p âˆˆH \ âˆª{V i
j }, then p âˆˆBi for each i and so p âˆˆU. This is therefore a ï¬nite
subcover of D contradicting the properties of D. Therefore, F must be empty and
by Lemma 6.56, this proves the theorem.
Let I be a set and suppose for each i âˆˆI, (Xi, Ï„ i) is a nonempty topological
space. The Cartesian product of the Xi, denoted by Q
iâˆˆI Xi, consists of the set
of all choice functions deï¬ned on I which select a single element of each Xi. Thus
f âˆˆQ
iâˆˆI Xi means for every i âˆˆI, f (i) âˆˆXi. The axiom of choice says Q
iâˆˆI Xi
is nonempty. Let
Pj (A) =
Y
iâˆˆI
Bi
where Bi = Xi if i Ì¸= j and Bj = A. A subbasis for a topology on the product
space consists of all sets Pj (A) where A âˆˆÏ„ j. (These sets have an open set from
the topology of Xj in the jth slot and the whole space in the other slots.) Thus a
basis consists of ï¬nite intersections of these sets. Note that the intersection of two
of these basic sets is another basic set and their union yields Q
iâˆˆI Xi. Therefore,
they satisfy the condition needed for a collection of sets to serve as a basis for a
topology. This topology is called the product topology and is denoted by Q Ï„ i.
It is tempting to deï¬ne a basis for a topology to be sets of the form Q
iâˆˆI Ai
where Ai is open in Xi. This is not the same thing at all. Note that the basis just
described has at most ï¬nitely many slots ï¬lled with an open set which is not the
whole space. The thing just mentioned in which every slot may be ï¬lled by a proper
open set is called the box topology and there exist people who are interested in it.
The Alexander subbasis theorem is used to prove the Tychonoï¬€theorem which
says that if each Xi is a compact topological space, then in the product topology,
Q
iâˆˆI Xi is also compact.
Theorem 11.7 If (XiÏ„ i) is compact, then so is (Q
iâˆˆI Xi, Q Ï„ i).
Proof: By the Alexander subbasis theorem, the theorem will be proved if every
subbasic open cover admits a ï¬nite subcover. Therefore, let O be a subbasic open
cover of Q
iâˆˆI Xi. Let
Oj = {Q âˆˆO : Q = Pj (A) for some A âˆˆÏ„ j}.
Thus Oj consists of those sets of O which have a possibly proper subset of Xi only
in the slot i = j. Let
Ï€jOj = {A : Pj (A) âˆˆOj}.
Thus Ï€jOj picks out those proper open subsets of Xj which occur in Oj.

308
SOME EXTENSION THEOREMS
If no Ï€jOj covers Xj, then by the axiom of choice, there exists
f âˆˆ
Y
iâˆˆI
Xi \ âˆªÏ€iOi
Therefore, f (j) /âˆˆâˆªÏ€jOj for each j âˆˆI.
Now f is a point of Q
iâˆˆI Xi and so
f âˆˆPk (A) âˆˆO for some k. However, this is a contradiction it was shown that f (k)
is not an element of A. (A is one of the sets whose union makes up âˆªÏ€kOk.) This
contradiction shows that for some j, Ï€jOj covers Xj. Thus
Xj = âˆªÏ€jOj
and so by compactness of Xj, there exist A1, Â· Â· Â·, Am, sets in Ï„ j such that Xj âŠ†
âˆªm
i=1Ai and Pj (Ai) âˆˆO. Therefore, {Pj (Ai)}m
i=1 covers Q
iâˆˆI Xi. By the Alexander
subbasis theorem this proves Q
iâˆˆI Xi is compact.
11.3
Kolmogorov Extension Theorem
Here Mt will be a metric space in which the closed balls are compact. (The case
of interest is Rn but it is easier to write M.) Thus it is also a locally compact
Hausdorï¬€space. I will denote a totally ordered index set, and the interest will
be in building a measure on the product space, Q
tâˆˆI Mt. The example of interest
for I is [0, âˆž) but all that I will use is that I is totally ordered. By well ordering
principle, you can always put an order on the index set. Also, I will denote M â€²
t as
the one point compactiï¬cation of Mt.
Let J âŠ†I. Then if E â‰¡Q
tâˆˆI Et, deï¬ne
Î³JE â‰¡
Y
tâˆˆI
Ft
where
Ft =
Â½
Et if t âˆˆJ
M â€²
t if t /âˆˆJ
Thus Î³JE leaves alone Et for t âˆˆJ and changes the other Et into M â€²
t. If Î³JE = E,
then this means Et = M â€²
t for all t /âˆˆJ. Also deï¬ne for J a subset of I,
Ï€Jx â‰¡
Y
tâˆˆJ
xt
so Ï€J is a continuous mapping from Q
tâˆˆI M â€²
t to Q
tâˆˆJ M â€²
t.
Ï€JE â‰¡
Y
tâˆˆJ
Et.

11.3.
KOLMOGOROV EXTENSION THEOREM
309
Deï¬nition 11.8 Now deï¬ne for J a ï¬nite subset of I,
RJ
â‰¡
(
E =
Y
tâˆˆI
Et : Î³JE = E, Et a Borel set in M â€²
t
)
R
â‰¡
âˆª{RJ : J âŠ†I, and J ï¬nite}
Thus R consists of those sets of Q
tâˆˆI M â€²
t for which every slot is ï¬lled with M â€²
except for a ï¬nite set, J âŠ†I where the slots are ï¬lled with a Borel set, Et. Deï¬ne
E as ï¬nite disjoint unions of sets of R.
In fact E is an algebra of sets.
Lemma 11.9 The sets, E
deï¬ned above form an algebra of sets of Q
tâˆˆI M â€²
t.
Proof: Clearly âˆ…and Q
tâˆˆI M â€²
t are both in E. Suppose A, B âˆˆR. Then for
some ï¬nite set, J,
Î³JA = A, Î³JB = B.
Then
Î³J (A \ B) = A \ B âˆˆE,Î³J (A âˆ©B) = A âˆ©B âˆˆR.
By Lemma 9.54 on Page 246 this shows E is an algebra.
Here is a lemma which is useful although fussy.
Lemma 11.10 Let J be a ï¬nite subset of I. Then U is a Borel set in Q
tâˆˆJ Mt if
and only if there exists a Borel set, Uâ€² in Q
tâˆˆJ M â€²
t such that U = Uâ€² âˆ©Q
tâˆˆJ Mt.
Proof:
First suppose Borel is replaced with open.
If U is an open set in
Q
tâˆˆJ Mt, then it is open in Q
tâˆˆJ M â€²
t from the deï¬nition of the open sets of Q
tâˆˆJ M â€²
t
which consist of open sets of Q
tâˆˆJ Mt along with complements of compact sets which
have the point âˆžadded in. Thus you can let Uâ€² = U in this case. Next suppose
U = Uâ€²âˆ©Q
tâˆˆJ Mt where Uâ€² is open in Q
tâˆˆJ M â€²
t. I need show U is open in Q
tâˆˆJ Mt.
Letting x âˆˆU, it follows xt Ì¸= âˆžfor each t. It follows from Uâ€² open in Q
tâˆˆJ M â€²
t
that xt âˆˆV â€²
t where V â€²
t is open in M â€²
t and
x âˆˆ
Y
tâˆˆJ
V â€²
t âŠ†Uâ€²
Letting Vt = V â€²
t \ {âˆž} , it follows Vt is open in Mt and
x âˆˆ
Y
tâˆˆJ
Vt âŠ†Uâ€² âˆ©
Y
tâˆˆJ
Mt.
This shows that U is an open set in Q
tâˆˆJ Mt. Now let
G â‰¡
(
F Borel in
Y
tâˆˆJ
M â€²
t such that F âˆ©
Y
tâˆˆJ
Mt is Borel in
Y
tâˆˆJ
Mt
)

310
SOME EXTENSION THEOREMS
then from what was just shown G contains the open sets. It is also clearly a Ïƒ
algebra. Hence G equals the Borel sets of Q
tâˆˆJ M â€²
t .
It only remains to verify that any Borel set in Q
tâˆˆJ Mt is the intersection of a
Borel set of Q
tâˆˆJ M â€²
t with Q
tâˆˆJ Mt. Let
H â‰¡
(
F Borel in
Y
tâˆˆJ
Mt such that F = Fâ€² âˆ©
Y
tâˆˆJ
Mt, Fâ€² Borel in
Y
tâˆˆJ
M â€²
t
)
From the ï¬rst part of the argument, H contains the open sets.
Now let {Fn}
be a sequence in H. Thus Fn = Fâ€²
n âˆ©Q
tâˆˆJ Mt where Fâ€²
n is Borel in Q
tâˆˆJ M â€²
t.
Then âˆªnFn = âˆªnFâ€²
n âˆ©Q
tâˆˆJ Mt and âˆªnFâ€²
n is Borel in Q
tâˆˆJ M â€²
t. Thus H is closed
under countable intersections.
Next let F âˆˆH and F = Fâ€² âˆ©Q
tâˆˆJ Mt.
Then
Fâ€²C â‰¡Q
tâˆˆJ M â€²
t \ Fâ€² is Borel in Q
tâˆˆJ M â€²
t and
Â¡Q
tâˆˆJ Mt \ F
Â¢
= Fâ€²C âˆ©Q
tâˆˆJ Mt.
Thus H is a Ïƒ algebra containing the open sets and so H equals the Borel sets in
Q
tâˆˆJ Mt. This proves this wretched little lemma.
With this preparation here is the Kolmogorov extension theorem. In the state-
ment and proof of the theorem, Fi, Gi, and Ei will denote Borel sets. Any list of
indices from I will always be assumed to be taken in order. Thus, if J âŠ†I and
J = (t1, Â· Â· Â·, tn) , it will always be assumed t1 < t2 < Â· Â· Â· < tn.
Theorem 11.11 (Kolmogorov extension theorem) For each ï¬nite set
J = (t1, Â· Â· Â·, tn) âŠ†I,
suppose there exists a Borel probability measure, Î½J = Î½t1Â·Â·Â·tn deï¬ned on the Borel
sets of Q
tâˆˆJ Mt such that if
(t1, Â· Â· Â·, tn) âŠ†(s1, Â· Â· Â·, sp) ,
then
Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn) = Î½s1Â·Â·Â·sp
Â¡
Gs1 Ã— Â· Â· Â· Ã— Gsp
Â¢
(11.1)
where if si = tj, then Gsi = Ftj and if si is not equal to any of the indices, tk,
then Gsi = Msi. Then there exists a probability space, (â„¦, P, F) and measurable
functions, Xt : â„¦â†’Mt for each t âˆˆI such that for each (t1 Â· Â· Â· tn) âŠ†I,
Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn) = P ([Xt1 âˆˆFt1] âˆ©Â· Â· Â· âˆ©[Xtn âˆˆFtn]) .
(11.2)
Proof: First of all, note that for J ï¬nite, Q
tâˆˆJ Mt is a metric space in which
the closures of the balls are compact. Therefore, by Lemma 11.3 Î½t1Â·Â·Â·tn is both
inner and outer regular. Also, it is convenient to extend each Î½t1Â·Â·Â·tn to the Borel
sets of Q
tâˆˆJ M â€²
t where M â€²
t is the one point compactiï¬cation of Mt as follows. For
F a Borel set of Q
tâˆˆJ M â€²
t,
Î½t1Â·Â·Â·tn (F) â‰¡Î½t1Â·Â·Â·tn
Ãƒ
F âˆ©
Y
tâˆˆJ
Mt
!
.

11.3.
KOLMOGOROV EXTENSION THEOREM
311
By Lemma 11.10 this is well deï¬ned.
Letting E be the algebra of sets deï¬ned in Deï¬nition 11.8 and suppose E = E1 âˆª
E2 âˆªÂ· Â· Â· âˆªEm where Î³JkEk = Ek. Thus E âˆˆE. Let
Â¡
tk
1 Â· Â· Â· tk
mk
Â¢
= Jk. Then letting
J = (s1, Â· Â· Â·, sp) âŠ‡âˆªm
k=1Jk
deï¬ne
P0 (E) â‰¡
m
X
k=1
Î½s1Â·Â·Â·sp
Â³
Gk
s1 Ã— Â· Â· Â· Ã— Gk
sp
Â´
where Gk
si = Ek
tk
j in case si = tk
j and M â€²
si otherwise. By 11.1 this is well deï¬ned
and equals
m
X
k=1
Î½tk
1Â·Â·Â·tk
mk
Â³
Ek
tk
1 Ã— Â· Â· Â· Ã— Ek
tk
mk
Â´
.
P0 is clearly ï¬nitely additive because the Î½J are measures and one can pick J as
large as desired. Also, from the deï¬nition,
P0
ÃƒY
tâˆˆI
M â€²
t
!
= Î½t1
Â¡
M â€²
t1
Â¢
= 1.
Next I will show P0 is a ï¬nite measure on E. From this it is only a matter of using
the Caratheodory extension theorem.
Claim: If En â†“âˆ…, then P0 (En) â†“0.
Proof of the claim: If not, there exists a sequence such that although En â†“
âˆ…, P0 (En) â†“Îµ > 0. Since each of the Î½s1Â·Â·Â·sm is inner regular, there exists a compact
set, Kn âŠ†Ï€J (En) for suitably large J such that if Knâ€² âŠ†Q
tâˆˆI M â€²
t is deï¬ned by
Î³J (Knâ€²) = Knâ€² and Ï€J (Knâ€²) = Kn and P0 (En \ Knâ€²) < Îµ/2n+1. (Less precisely,
you get Knâ€² by ï¬lling in all the slots other than in J with the appropriate M â€²
t.)
Thus by Tychonoï¬€â€™s theorem, Knâ€² is compact. The interesting thing about these
Knâ€² is they have the ï¬nite intersection property. Here is why.
Îµ
â‰¤
P0
Â¡
âˆ©m
k=1Kkâ€²Â¢
+ P0
Â¡
Em \ âˆ©m
k=1Kkâ€²Â¢
â‰¤
P0
Â¡
âˆ©m
k=1Kkâ€²Â¢
+ P0
Â¡
âˆªm
k=1Ek \ Kkâ€²Â¢
<
P0
Â¡
âˆ©m
k=1Kkâ€²Â¢
+
âˆž
X
k=1
Îµ
2k+1 < P0
Â¡
âˆ©m
k=1Kkâ€²Â¢
+ Îµ
and so P0
Â¡
âˆ©m
k=1Kkâ€²Â¢
> 0. Now this yields a contradiction because this ï¬nite inter-
section property implies the intersection of all the Knâ€² is nonempty contradicting
En â†“âˆ…since each Knâ€² is contained in En.
With the claim, it follows P0 is a measure on E. Here is why: If E = âˆªâˆž
k=1Ek
where E, Ek âˆˆE, then (E \ âˆªn
k=1Ek) â†“âˆ…and so
P0 (âˆªn
k=1Ek) â†’P0 (E) .
Hence if the Ek are disjoint, P0 (âˆªn
k=1Ek) = Pn
k=1 P0 (Ek) â†’P0 (E) .

312
SOME EXTENSION THEOREMS
Now to conclude the proof, apply the Caratheodory extension theorem to obtain
P a probability measure which extends P0 to Ïƒ (E) the sigma algebra generated by
E. Let S â‰¡
Â©
E âˆ©Q
tâˆˆI Mt : E âˆˆÏƒ (E)
Âª
. It follows
Â¡Q
tâˆˆI Mt, S, P
Â¢
is a probability
measure space with the property that when Î³J (E) = E for J = (t1 Â· Â· Â· tn) a ï¬nite
subset of I, P (E) = P0 (E) = Î½t1Â·Â·Â·tn (Et1 Ã— Â· Â· Â· Ã— Etn) .
For the last part, let
Â¡Q
tâˆˆI Mt, S, P
Â¢
be the probability space and for x âˆˆ
Q
tâˆˆI Mt let Xt (x) = xt, the tth entry of x. (xt = Ï€tx). It follows Xt is measurable
because if U is open in Mt, then Xâˆ’1
t
(U) has a U in the tth slot and Ms everywhere
else for s Ì¸= t so this is actually in E. Also, letting (t1 Â· Â· Â· tn) be a ï¬nite subset of I
and Ft1, Â· Â· Â·, Ftn be Borel sets in Mt1 Â· Â· Â· Mtn respectively,
P ([Xt1 âˆˆFt1] âˆ©[Xt2 âˆˆFt2] âˆ©Â· Â· Â· âˆ©[Xtn âˆˆFtn]) =
P ((Xt1, Xt2, Â· Â· Â·, Xtn) âˆˆFt1 Ã— Â· Â· Â· Ã— Ftn) = P (Ft1 Ã— Â· Â· Â· Ã— Ftn)
= Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn)
This proves the theorem.
As a special case, you can obtain a version of product measure for possibly
inï¬nitely many factors. Suppose in the context of the above theorem that Î½t is a
probability measure deï¬ned on the Borel sets of Mt and let the measures, Î½t1Â·Â·Â·tn
be deï¬ned on the Borel sets of Qn
i=1 Mti by
Î½t1Â·Â·Â·tn (E) â‰¡(Î½t1 Ã— Â· Â· Â· Ã— Î½tn) (E) .
Then these measures satisfy the necessary consistency condition and so the Kol-
mogorov extension theorem given above can be applied to obtain a measure, P
deï¬ned on a
Â¡Q
tâˆˆI Mt, F
Â¢
and measurable functions Xs : Q
tâˆˆI Mt â†’Ms such that
for Fti a Borel set in Mti,
P
Ãƒ
(Xt1, Â· Â· Â·, Xtn) âˆˆ
n
Y
i=1
Fti
!
= Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn)
= Î½t1 (Ft1) Â· Â· Â· Î½tn (Ftn) .
(11.3)
In particular, P (Xt âˆˆFt) = Î½t (Ft) . Then P in the resulting probability space,
ÃƒY
tâˆˆI
Mt, F, P
!
will be denoted as Q
tâˆˆI Î½t. This proves the following theorem which describes an
inï¬nite product measure.
Theorem 11.12 Let Mt for t âˆˆI be given as in Theorem 11.11 and let Î½t be a
Borel probability measure deï¬ned on the Borel sets of Mt. Then there exists a mea-
sure, P and a Ïƒ algebra F âŠ†P (Q
t Mt) containing the algebra deï¬ned in Deï¬nition
11.8 such that (Q
t Mt, F, P) is a probability space satisfying 11.3 whenever each
Fti is a Borel set of Mti. This probability measure is sometimes denoted as Q
t Î½t.

11.4.
EXERCISES
313
11.4
Exercises
1. Let (X, S, Âµ) and (Y, F, Î») be two ï¬nite measure spaces. A subset of X Ã— Y
is called a measurable rectangle if it is of the form A Ã— B where A âˆˆS and
B âˆˆF. A subset of X Ã— Y is called an elementary set if it is a ï¬nite disjoint
union of measurable rectangles. Denote this set of functions by E. Show that
E is an algebra of sets.
2. â†‘For A âˆˆÏƒ (E) , the smallest Ïƒ algebra containing E, show that x â†’XA (x, y)
is Âµ measurable and that
y â†’
Z
XA (x, y) dÂµ
is Î» measurable. Show similar assertions hold for y â†’XA (x, y) and
x â†’
Z
XA (x, y) dÎ»
and that
Z Z
XA (x, y) dÂµdÎ» =
Z Z
XA (x, y) dÎ»dÂµ.
(11.4)
Hint: Let M â‰¡{A âˆˆÏƒ (E) : 11.4 holds} along with all relevant measurability
assertions. Show M contains E and is a monotone class. Then apply the
Theorem 9.57.
3. â†‘For A âˆˆÏƒ (E) deï¬ne (Âµ Ã— Î») (A) â‰¡
R R
XA (x, y) dÂµdÎ». Show that (Âµ Ã— Î») is
a measur on Ïƒ (E) and that whenever f â‰¥0 is measurable with respect to
Ïƒ (E) ,
Z
XÃ—Y
fd (Âµ Ã— Î») =
Z Z
f (x, y) dÂµdÎ» =
Z Z
f (x, y) dÎ»dÂµ.
This is a common approach to Fubiniâ€™s theorem.
4. â†‘Generalize the above version of Fubiniâ€™s theorem to the case where the mea-
sure spaces are only Ïƒ ï¬nite.
5. â†‘Suppose now that Âµ and Î» are both complete Ïƒ ï¬nite measures. Let (Âµ Ã— Î»)
denote the completion of this measure.
Let the larger measure space be
Â³
X Ã— Y, Ïƒ (E), (Âµ Ã— Î»)
Â´
. Thus if E âˆˆÏƒ (E), it follows there exists a set A âˆˆ
Ïƒ (E) such that E âˆªN = A where (Âµ Ã— Î») (N) = 0. Now argue that for Î»
a.e. y, x â†’XN (x, y) is measurable because it is equal to zero Âµ a.e. and Âµ is
complete. Therefore,
Z Z
XN (x, y) dÂµdÎ»

314
SOME EXTENSION THEOREMS
makes sense and equals zero. Use to argue that for Î» a.e. y, x â†’XE (x, y)
is Âµ measurable and equals
R
XA (x, y) dÂµ. Then by completeness of Î», y â†’
R
XE (x, y) dÂµ is Î» measurable and
Z Z
XA (x, y) dÂµdÎ» =
Z Z
XE (x, y) dÂµdÎ» = (Âµ Ã— Î») (E) .
Similarly
Z Z
XE (x, y) dÎ»dÂµ = (Âµ Ã— Î») (E) .
Use this to give a generalization of the above Fubini theorem. Prove that if f
is measurable with respect to the Ïƒ algebra, Ïƒ (E) and nonnegative, then
Z
XÃ—Y
fd(Âµ Ã— Î») =
Z Z
f (x, y) dÂµdÎ» =
Z Z
f (x, y) dÎ»dÂµ
where the iterated integrals make sense.

The Lp Spaces
12.1
Basic Inequalities And Properties
One of the main applications of the Lebesgue integral is to the study of various
sorts of functions space. These are vector spaces whose elements are functions of
various types. One of the most important examples of a function space is the space
of measurable functions whose absolute values are pth power integrable where p â‰¥1.
These spaces, referred to as Lp spaces, are very useful in applications. In the chapter
(â„¦, S, Âµ) will be a measure space.
Deï¬nition 12.1 Let 1 â‰¤p < âˆž. Deï¬ne
Lp(â„¦) â‰¡{f : f is measurable and
Z
â„¦
|f(Ï‰)|pdÂµ < âˆž}
In terms of the distribution function,
Lp (â„¦) = {f : f is measurable and
Z âˆž
0
ptpâˆ’1Âµ ([|f| > t]) dt < âˆž}
For each p > 1 deï¬ne q by
1
p + 1
q = 1.
Often one uses pâ€² instead of q in this context.
Lp (â„¦) is a vector space and has a norm. This is similar to the situation for Rn
but the proof requires the following fundamental inequality. .
Theorem 12.2 (Holderâ€™s inequality) If f and g are measurable functions, then if
p > 1,
Z
|f| |g| dÂµ â‰¤
ÂµZ
|f|pdÂµ
Â¶ 1
p ÂµZ
|g|qdÂµ
Â¶ 1
q
.
(12.1)
Proof: First here is a proof of Youngâ€™s inequality .
Lemma 12.3 If
p > 1, and 0 â‰¤a, b then ab â‰¤ap
p + bq
q .
315

316
THE LP SPACES
Proof: Consider the following picture:
b
a
x
t
x = tpâˆ’1
t = xqâˆ’1
From this picture, the sum of the area between the x axis and the curve added to
the area between the t axis and the curve is at least as large as ab. Using beginning
calculus, this is equivalent to the following inequality.
ab â‰¤
Z a
0
tpâˆ’1dt +
Z b
0
xqâˆ’1dx = ap
p + bq
q .
The above picture represents the situation which occurs when p > 2 because the
graph of the function is concave up. If 2 â‰¥p > 1 the graph would be concave down
or a straight line. You should verify that the same argument holds in these cases
just as well. In fact, the only thing which matters in the above inequality is that
the function x = tpâˆ’1 be strictly increasing.
Note equality occurs when ap = bq.
Here is an alternate proof.
Lemma 12.4 For a, b â‰¥0,
ab â‰¤ap
p + bq
q
and equality occurs when if and only if ap = bq.
Proof: If b = 0, the inequality is obvious. Fix b > 0 and consider
f (a) â‰¡ap
p + bq
q âˆ’ab.
Then f â€² (a) = apâˆ’1 âˆ’b. This is negative when a < b1/(pâˆ’1) and is positive when
a > b1/(pâˆ’1). Therefore, f has a minimum when a = b1/(pâˆ’1). In other words, when
ap = bp/(pâˆ’1) = bq since 1/p + 1/q = 1. Thus the minimum value of f is
bq
p + bq
q âˆ’b1/(pâˆ’1)b = bq âˆ’bq = 0.
It follows f â‰¥0 and this yields the desired inequality.
Proof of Holderâ€™s inequality: If either
R
|f|pdÂµ or
R
|g|pdÂµ equals âˆž, the
inequality 12.1 is obviously valid because âˆžâ‰¥anything.
If either
R
|f|pdÂµ or

12.1.
BASIC INEQUALITIES AND PROPERTIES
317
R
|g|pdÂµ equals 0, then f = 0 a.e. or that g = 0 a.e. and so in this case the left side
of the inequality equals 0 and so the inequality is therefore true. Therefore assume
both
R
|f|pdÂµ and
R
|g|pdÂµ are less than âˆžand not equal to 0. Let
ÂµZ
|f|pdÂµ
Â¶1/p
= I (f)
and let
Â¡R
|g|pdÂµ
Â¢1/q = I (g). Then using the lemma,
Z
|f|
I (f)
|g|
I (g) dÂµ â‰¤1
p
Z
|f|p
I (f)p dÂµ + 1
q
Z
|g|q
I (g)q dÂµ = 1.
Hence,
Z
|f| |g| dÂµ â‰¤I (f) I (g) =
ÂµZ
|f|pdÂµ
Â¶1/p ÂµZ
|g|qdÂµ
Â¶1/q
.
This proves Holderâ€™s inequality.
The following lemma will be needed.
Lemma 12.5 Suppose x, y âˆˆC. Then
|x + y|p â‰¤2pâˆ’1 (|x|p + |y|p) .
Proof: The function f (t) = tp is concave up for t â‰¥0 because p > 1. Therefore,
the secant line joining two points on the graph of this function must lie above the
graph of the function. This is illustrated in the following picture.
Â¡
Â¡
Â¡
Â¡
Â¡Â¡
|x|
|y|
m
(|x| + |y|)/2 = m
Now as shown above,
Âµ|x| + |y|
2
Â¶p
â‰¤|x|p + |y|p
2
which implies
|x + y|p â‰¤(|x| + |y|)p â‰¤2pâˆ’1 (|x|p + |y|p)
and this proves the lemma.
Note that if y = Ï† (x) is any function for which the graph of Ï† is concave up,
you could get a similar inequality by the same argument.

318
THE LP SPACES
Corollary 12.6 (Minkowski inequality) Let 1 â‰¤p < âˆž. Then
ÂµZ
|f + g|p dÂµ
Â¶1/p
â‰¤
ÂµZ
|f|p dÂµ
Â¶1/p
+
ÂµZ
|g|p dÂµ
Â¶1/p
.
(12.2)
Proof: If p = 1, this is obvious because it is just the triangle inequality. Let
p > 1. Without loss of generality, assume
ÂµZ
|f|p dÂµ
Â¶1/p
+
ÂµZ
|g|p dÂµ
Â¶1/p
< âˆž
and
Â¡R
|f + g|p dÂµ
Â¢1/p Ì¸= 0 or there is nothing to prove. Therefore, using the above
lemma,
Z
|f + g|pdÂµ â‰¤2pâˆ’1
ÂµZ
|f|p + |g|pdÂµ
Â¶
< âˆž.
Now |f (Ï‰) + g (Ï‰)|p â‰¤|f (Ï‰) + g (Ï‰)|pâˆ’1 (|f (Ï‰)| + |g (Ï‰)|). Also, it follows from the
deï¬nition of p and q that p âˆ’1 = p
q . Therefore, using this and Holderâ€™s inequality,
Z
|f + g|pdÂµ â‰¤
Z
|f + g|pâˆ’1|f|dÂµ +
Z
|f + g|pâˆ’1|g|dÂµ
=
Z
|f + g|
p
q |f|dÂµ +
Z
|f + g|
p
q |g|dÂµ
â‰¤
(
Z
|f + g|pdÂµ)
1
q (
Z
|f|pdÂµ)
1
p + (
Z
|f + g|pdÂµ)
1
q (
Z
|g|pdÂµ)
1
p.
Dividing both sides by (
R
|f + g|pdÂµ)
1
q yields 12.2. This proves the corollary.
The following follows immediately from the above.
Corollary 12.7 Let fi âˆˆLp (â„¦) for i = 1, 2, Â· Â· Â·, n. Then
ÃƒZ Â¯Â¯Â¯Â¯Â¯
n
X
i=1
fi
Â¯Â¯Â¯Â¯Â¯
p
dÂµ
!1/p
â‰¤
n
X
i=1
ÂµZ
|fi|p
Â¶1/p
.
This shows that if f, g âˆˆLp, then f + g âˆˆLp. Also, it is clear that if a is a
constant and f âˆˆLp, then af âˆˆLp because
Z
|af|p dÂµ = |a|p
Z
|f|p dÂµ < âˆž.
Thus Lp is a vector space and
a.)
Â¡R
|f|p dÂµ
Â¢1/p â‰¥0,
Â¡R
|f|p dÂµ
Â¢1/p = 0 if and only if f = 0 a.e.

12.1.
BASIC INEQUALITIES AND PROPERTIES
319
b.)
Â¡R
|af|p dÂµ
Â¢1/p = |a|
Â¡R
|f|p dÂµ
Â¢1/p if a is a scalar.
c.)
Â¡R
|f + g|p dÂµ
Â¢1/p â‰¤
Â¡R
|f|p dÂµ
Â¢1/p +
Â¡R
|g|p dÂµ
Â¢1/p.
f â†’
Â¡R
|f|p dÂµ
Â¢1/p would deï¬ne a norm if
Â¡R
|f|p dÂµ
Â¢1/p = 0 implied f = 0.
Unfortunately, this is not so because if f = 0 a.e.
but is nonzero on a set of
measure zero,
Â¡R
|f|p dÂµ
Â¢1/p = 0 and this is not allowed. However, all the other
properties of a norm are available and so a little thing like a set of measure zero
will not prevent the consideration of Lp as a normed vector space if two functions
in Lp which diï¬€er only on a set of measure zero are considered the same. That is,
an element of Lp is really an equivalence class of functions where two functions are
equivalent if they are equal a.e. With this convention, here is a deï¬nition.
Deï¬nition 12.8 Let f âˆˆLp (â„¦). Deï¬ne
||f||p â‰¡||f||Lp â‰¡
ÂµZ
|f|p dÂµ
Â¶1/p
.
Then with this deï¬nition and using the convention that elements in Lp are
considered to be the same if they diï¬€er only on a set of measure zero, || ||p is a
norm on Lp (â„¦) because if ||f||p = 0 then f = 0 a.e. and so f is considered to be
the zero function because it diï¬€ers from 0 only on a set of measure zero.
The following is an important deï¬nition.
Deï¬nition 12.9 A complete normed linear space is called a Banach1 space.
Lp is a Banach space. This is the next big theorem.
Theorem 12.10 The following hold for Lp(â„¦)
a.) Lp(â„¦) is complete.
b.) If {fn} is a Cauchy sequence in Lp(â„¦), then there exists f âˆˆLp (â„¦) and a
subsequence which converges a.e. to f âˆˆLp(â„¦), and ||fn âˆ’f||p â†’0.
Proof: Let {fn} be a Cauchy sequence in Lp(â„¦). This means that for every
Îµ > 0 there exists N such that if n, m â‰¥N, then ||fn âˆ’fm||p < Îµ. Now select a
subsequence as follows. Let n1 be such that ||fn âˆ’fm||p < 2âˆ’1 whenever n, m â‰¥n1.
1These spaces are named after Stefan Banach, 1892-1945. Banach spaces are the basic item of
study in the subject of functional analysis and will be considered later in this book.
There is a recent biography of Banach, R. KatuË™za, The Life of Stefan Banach, (A. Kostant and
W. WoyczyÂ´nski, translators and editors) Birkhauser, Boston (1996). More information on Banach
can also be found in a recent short article written by Douglas Henderson who is in the department
of chemistry and biochemistry at BYU.
Banach was born in Austria, worked in Poland and died in the Ukraine but never moved. This
is because borders kept changing. There is a rumor that he died in a German concentration camp
which is apparently not true. It seems he died after the war of lung cancer.
He was an interesting character. He hated taking examinations so much that he did not receive
his undergraduate university degree. Nevertheless, he did become a professor of mathematics due
to his important research. He and some friends would meet in a cafe called the Scottish cafe where
they wrote on the marble table tops until Banachâ€™s wife supplied them with a notebook which
became the â€Scotish notebookâ€ and was eventually published.

320
THE LP SPACES
Let n2 be such that n2 > n1 and ||fnâˆ’fm||p < 2âˆ’2 whenever n, m â‰¥n2. If n1, Â·Â·Â·, nk
have been chosen, let nk+1 > nk and whenever n, m â‰¥nk+1, ||fn âˆ’fm||p < 2âˆ’(k+1).
The subsequence just mentioned is {fnk}. Thus, ||fnk âˆ’fnk+1||p < 2âˆ’k. Let
gk+1 = fnk+1 âˆ’fnk.
Then by the corollary to Minkowskiâ€™s inequality,
âˆž>
âˆž
X
k=1
||gk+1||p â‰¥
m
X
k=1
||gk+1||p â‰¥
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
m
X
k=1
|gk+1|
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
p
for all m. It follows that
Z Ãƒ m
X
k=1
|gk+1|
!p
dÂµ â‰¤
Ãƒ âˆž
X
k=1
||gk+1||p
!p
< âˆž
(12.3)
for all m and so the monotone convergence theorem implies that the sum up to m
in 12.3 can be replaced by a sum up to âˆž. Thus,
Z Ãƒ âˆž
X
k=1
|gk+1|
!p
dÂµ < âˆž
which requires
âˆž
X
k=1
|gk+1(x)| < âˆža.e. x.
Therefore, Pâˆž
k=1 gk+1(x) converges for a.e. x because the functions have values in
a complete space, C, and this shows the partial sums form a Cauchy sequence. Now
let x be such that this sum is ï¬nite. Then deï¬ne
f(x) â‰¡fn1(x) +
âˆž
X
k=1
gk+1(x)= lim
mâ†’âˆžfnm (x)
since Pm
k=1 gk+1(x) = fnm+1(x) âˆ’fn1(x). Therefore there exists a set, E having
measure zero such that
lim
kâ†’âˆžfnk(x) = f(x)
for all x /âˆˆE. Redeï¬ne fnk to equal 0 on E and let f(x) = 0 for x âˆˆE. It then
follows that limkâ†’âˆžfnk(x) = f(x) for all x. By Fatouâ€™s lemma, and the Minkowski
inequality,
||f âˆ’fnk||p =
ÂµZ
|f âˆ’fnk|p dÂµ
Â¶1/p
â‰¤
lim inf
mâ†’âˆž
ÂµZ
|fnm âˆ’fnk|p dÂµ
Â¶1/p
= lim inf
mâ†’âˆž||fnm âˆ’fnk||p â‰¤

12.1.
BASIC INEQUALITIES AND PROPERTIES
321
lim inf
mâ†’âˆž
mâˆ’1
X
j=k
Â¯Â¯Â¯Â¯fnj+1 âˆ’fnj
Â¯Â¯Â¯Â¯
p â‰¤
âˆž
X
i=k
Â¯Â¯Â¯Â¯fni+1 âˆ’fni
Â¯Â¯Â¯Â¯
p â‰¤2âˆ’(kâˆ’1).
(12.4)
Therefore, f âˆˆLp(â„¦) because
||f||p â‰¤||f âˆ’fnk||p + ||fnk||p < âˆž,
and limkâ†’âˆž||fnk âˆ’f||p = 0. This proves b.).
This has shown fnk converges to f in Lp (â„¦). It follows the original Cauchy
sequence also converges to f in Lp (â„¦). This is a general fact that if a subsequence
of a Cauchy sequence converges, then so does the original Cauchy sequence. You
should give a proof of this. This proves the theorem.
In working with the Lp spaces, the following inequality also known as Minkowskiâ€™s
inequality is very useful. It is similar to the Minkowski inequality for sums. To see
this, replace the integral,
R
X with a ï¬nite summation sign and you will see the usual
Minkowski inequality or rather the version of it given in Corollary 12.7.
To prove this theorem ï¬rst consider a special case of it in which technical con-
siderations which shed no light on the proof are excluded.
Lemma 12.11 Let (X, S, Âµ) and (Y, F, Î») be ï¬nite complete measure spaces and
let f be Âµ Ã— Î» measurable and uniformly bounded. Then the following inequality is
valid for p â‰¥1.
Z
X
ÂµZ
Y
|f(x, y)|p dÎ»
Â¶ 1
p
dÂµ â‰¥
ÂµZ
Y
(
Z
X
|f(x, y)| dÂµ)pdÎ»
Â¶ 1
p
.
(12.5)
Proof: Since f is bounded and Âµ (X) , Î» (X) < âˆž,
ÂµZ
Y
(
Z
X
|f(x, y)|dÂµ)pdÎ»
Â¶ 1
p
< âˆž.
Let
J(y) =
Z
X
|f(x, y)|dÂµ.
Note there is no problem in writing this for a.e. y because f is product measurable.
Then by Fubiniâ€™s theorem,
Z
Y
ÂµZ
X
|f(x, y)|dÂµ
Â¶p
dÎ»
=
Z
Y
J(y)pâˆ’1
Z
X
|f(x, y)|dÂµ dÎ»
=
Z
X
Z
Y
J(y)pâˆ’1|f(x, y)|dÎ» dÂµ

322
THE LP SPACES
Now apply Holderâ€™s inequality in the last integral above and recall p âˆ’1 = p
q . This
yields
Z
Y
ÂµZ
X
|f(x, y)|dÂµ
Â¶p
dÎ»
â‰¤
Z
X
ÂµZ
Y
J(y)pdÎ»
Â¶ 1
q ÂµZ
Y
|f(x, y)|pdÎ»
Â¶ 1
p
dÂµ
=
ÂµZ
Y
J(y)pdÎ»
Â¶ 1
q Z
X
ÂµZ
Y
|f(x, y)|pdÎ»
Â¶ 1
p
dÂµ
=
ÂµZ
Y
(
Z
X
|f(x, y)|dÂµ)pdÎ»
Â¶ 1
q Z
X
ÂµZ
Y
|f(x, y)|pdÎ»
Â¶ 1
p
dÂµ.
(12.6)
Therefore, dividing both sides by the ï¬rst factor in the above expression,
ÂµZ
Y
ÂµZ
X
|f(x, y)|dÂµ
Â¶p
dÎ»
Â¶ 1
p
â‰¤
Z
X
ÂµZ
Y
|f(x, y)|pdÎ»
Â¶ 1
p
dÂµ.
(12.7)
Note that 12.7 holds even if the ï¬rst factor of 12.6 equals zero. This proves the
lemma.
Now consider the case where f is not assumed to be bounded and where the
measure spaces are Ïƒ ï¬nite.
Theorem 12.12 Let (X, S, Âµ) and (Y, F, Î») be Ïƒ-ï¬nite measure spaces and let f
be product measurable. Then the following inequality is valid for p â‰¥1.
Z
X
ÂµZ
Y
|f(x, y)|p dÎ»
Â¶ 1
p
dÂµ â‰¥
ÂµZ
Y
(
Z
X
|f(x, y)| dÂµ)pdÎ»
Â¶ 1
p
.
(12.8)
Proof: Since the two measure spaces are Ïƒ ï¬nite, there exist measurable sets,
Xm and Yk such that Xm âŠ†Xm+1 for all m, Yk âŠ†Yk+1 for all k, and Âµ (Xm) , Î» (Yk) <
âˆž. Now deï¬ne
fn (x, y) â‰¡
Â½
f (x, y) if |f (x, y)| â‰¤n
n if |f (x, y)| > n.
Thus fn is uniformly bounded and product measurable. By the above lemma,
Z
Xm
ÂµZ
Yk
|fn(x, y)|p dÎ»
Â¶ 1
p
dÂµ â‰¥
ÂµZ
Yk
(
Z
Xm
|fn(x, y)| dÂµ)pdÎ»
Â¶ 1
p
.
(12.9)
Now observe that |fn (x, y)| increases in n and the pointwise limit is |f (x, y)|. There-
fore, using the monotone convergence theorem in 12.9 yields the same inequality
with f replacing fn. Next let k â†’âˆžand use the monotone convergence theorem
again to replace Yk with Y . Finally let m â†’âˆžin what is left to obtain 12.8. This
proves the theorem.

12.2.
DENSITY CONSIDERATIONS
323
Note that the proof of this theorem depends on two manipulations, the inter-
change of the order of integration and Holderâ€™s inequality. Note that there is nothing
to check in the case of double sums. Thus if aij â‰¥0, it is always the case that
ï£«
ï£­X
j
ÃƒX
i
aij
!pï£¶
ï£¸
1/p
â‰¤
X
i
ï£«
ï£­X
j
ap
ij
ï£¶
ï£¸
1/p
because the integrals in this case are just sums and (i, j) â†’aij is measurable.
The Lp spaces have many important properties.
12.2
Density Considerations
Theorem 12.13 Let p â‰¥1 and let (â„¦, S, Âµ) be a measure space. Then the simple
functions are dense in Lp (â„¦).
Proof: Recall that a function, f, having values in R can be written in the form
f = f + âˆ’f âˆ’where
f + = max (0, f) , f âˆ’= max (0, âˆ’f) .
Therefore, an arbitrary complex valued function, f is of the form
f = Re f + âˆ’Re f âˆ’+ i
Â¡
Im f + âˆ’Im f âˆ’Â¢
.
If each of these nonnegative functions is approximated by a simple function, it
follows f is also approximated by a simple function. Therefore, there is no loss of
generality in assuming at the outset that f â‰¥0.
Since f is measurable, Theorem 8.27 implies there is an increasing sequence of
simple functions, {sn}, converging pointwise to f(x). Now
|f(x) âˆ’sn(x)| â‰¤|f(x)|.
By the Dominated Convergence theorem,
0 = lim
nâ†’âˆž
Z
|f(x) âˆ’sn(x)|pdÂµ.
Thus simple functions are dense in Lp.
Recall that for â„¦a topological space, Cc(â„¦) is the space of continuous functions
with compact support in â„¦. Also recall the following deï¬nition.
Deï¬nition 12.14 Let (â„¦, S, Âµ) be a measure space and suppose (â„¦, Ï„) is also a
topological space. Then (â„¦, S, Âµ) is called a regular measure space if the Ïƒ algebra
of Borel sets is contained in S and for all E âˆˆS,
Âµ(E) = inf{Âµ(V ) : V âŠ‡E and V open}

324
THE LP SPACES
and if Âµ (E) < âˆž,
Âµ(E) = sup{Âµ(K) : K âŠ†E and K is compact }
and Âµ (K) < âˆžfor any compact set, K.
For example Lebesgue measure is an example of such a measure.
Lemma 12.15 Let â„¦be a metric space in which the closed balls are compact and
let K be a compact subset of V , an open set. Then there exists a continuous function
f : â„¦â†’[0, 1] such that f(x) = 1 for all x âˆˆK and spt(f) is a compact subset of
V . That is, K â‰ºf â‰ºV.
Proof: Let K âŠ†W âŠ†W âŠ†V and W is compact.
To obtain this list of
inclusions consider a point in K, x, and take B (x, rx) a ball containing x such that
B (x, rx) is a compact subset of V . Next use the fact that K is compact to obtain
the existence of a list, {B (xi, rxi/2)}m
i=1 which covers K. Then let
W â‰¡âˆªm
i=1B
Â³
xi, rxi
2
Â´
.
It follows since this is a ï¬nite union that
W = âˆªm
i=1B
Â³
xi, rxi
2
Â´
and so W, being a ï¬nite union of compact sets is itself a compact set. Also, from
the construction
W âŠ†âˆªm
i=1B (xi, rxi) .
Deï¬ne f by
f(x) =
dist(x, W C)
dist(x, K) + dist(x, W C).
It is clear that f is continuous if the denominator is always nonzero. But this is
clear because if x âˆˆW C there must be a ball B (x, r) such that this ball does not
intersect K. Otherwise, x would be a limit point of K and since K is closed, x âˆˆK.
However, x /âˆˆK because K âŠ†W.
It is not necessary to be in a metric space to do this. You can accomplish the
same thing using Urysohnâ€™s lemma.
Theorem 12.16 Let (â„¦, S, Âµ) be a regular measure space as in Deï¬nition 12.14
where the conclusion of Lemma 12.15 holds. Then Cc(â„¦) is dense in Lp(â„¦).
Proof: First consider a measurable set, E where Âµ (E) < âˆž. Let K âŠ†E âŠ†V
where Âµ (V \ K) < Îµ. Now let K â‰ºh â‰ºV. Then
Z
|h âˆ’XE|p dÂµ â‰¤
Z
X p
V \KdÂµ = Âµ (V \ K) < Îµ.

12.3.
SEPARABILITY
325
It follows that for each s a simple function in Lp (â„¦) , there exists h âˆˆCc (â„¦) such
that ||s âˆ’h||p < Îµ. This is because if
s(x) =
m
X
i=1
ciXEi(x)
is a simple function in Lp where the ci are the distinct nonzero values of s each
Âµ (Ei) < âˆžsince otherwise s /âˆˆLp due to the inequality
Z
|s|p dÂµ â‰¥|ci|p Âµ (Ei) .
By Theorem 12.13, simple functions are dense in Lp (â„¦) ,and so this proves the
Theorem.
12.3
Separability
Theorem 12.17 For p â‰¥1 and Âµ a Radon measure, Lp(Rn, Âµ) is separable. Recall
this means there exists a countable set, D, such that if f âˆˆLp(Rn, Âµ) and Îµ > 0,
there exists g âˆˆD such that ||f âˆ’g||p < Îµ.
Proof: Let Q be all functions of the form cX[a,b) where
[a, b) â‰¡[a1, b1) Ã— [a2, b2) Ã— Â· Â· Â· Ã— [an, bn),
and both ai, bi are rational, while c has rational real and imaginary parts. Let D be
the set of all ï¬nite sums of functions in Q. Thus, D is countable. In fact D is dense in
Lp(Rn, Âµ). To prove this it is necessary to show that for every f âˆˆLp(Rn, Âµ), there
exists an element of D, s such that ||s âˆ’f||p < Îµ. If it can be shown that for every
g âˆˆCc (Rn) there exists h âˆˆD such that ||g âˆ’h||p < Îµ, then this will suï¬ƒce because
if f âˆˆLp (Rn) is arbitrary, Theorem 12.16 implies there exists g âˆˆCc (Rn) such
that ||f âˆ’g||p â‰¤Îµ
2 and then there would exist h âˆˆCc (Rn) such that ||h âˆ’g||p < Îµ
2.
By the triangle inequality,
||f âˆ’h||p â‰¤||h âˆ’g||p + ||g âˆ’f||p < Îµ.
Therefore, assume at the outset that f âˆˆCc (Rn).
Let Pm consist of all sets of the form [a, b) â‰¡Qn
i=1[ai, bi) where ai = j2âˆ’mand
bi = (j + 1)2âˆ’m for j an integer. Thus Pm consists of a tiling of Rn into half open
rectangles having diameters 2âˆ’mn
1
2 . There are countably many of these rectangles;
so, let Pm = {[ai, bi)}âˆž
i=1 and Rn = âˆªâˆž
i=1[ai, bi). Let cm
i be complex numbers with
rational real and imaginary parts satisfying
|f(ai) âˆ’cm
i | < 2âˆ’m,
|cm
i | â‰¤|f(ai)|.
(12.10)

326
THE LP SPACES
Let
sm(x) =
âˆž
X
i=1
cm
i X[ai,bi) (x) .
Since f(ai) = 0 except for ï¬nitely many values of i, the above is a ï¬nite sum. Then
12.10 implies sm âˆˆD. If sm converges uniformly to f then it follows ||sm âˆ’f||p â†’0
because |sm| â‰¤|f| and so
||sm âˆ’f||p
=
ÂµZ
|sm âˆ’f|p dÂµ
Â¶1/p
=
ÃƒZ
spt(f)
|sm âˆ’f|p dÂµ
!1/p
â‰¤
[Îµmn (spt (f))]1/p
whenever m is large enough.
Since f âˆˆCc (Rn) it follows that f is uniformly continuous and so given Îµ > 0
there exists Î´ > 0 such that if |x âˆ’y| < Î´, |f (x) âˆ’f (y)| < Îµ/2. Now let m be large
enough that every box in Pm has diameter less than Î´ and also that 2âˆ’m < Îµ/2.
Then if [ai, bi) is one of these boxes of Pm, and x âˆˆ[ai, bi),
|f (x) âˆ’f (ai)| < Îµ/2
and
|f (ai) âˆ’cm
i | < 2âˆ’m < Îµ/2.
Therefore, using the triangle inequality, it follows that
|f (x) âˆ’cm
i | = |sm (x) âˆ’f (x)| < Îµ
and since x is arbitrary, this establishes uniform convergence.
This proves the
theorem.
Here is an easier proof if you know the Weierstrass approximation theorem.
Theorem 12.18 For p â‰¥1 and Âµ a Radon measure, Lp(Rn, Âµ) is separable. Recall
this means there exists a countable set, D, such that if f âˆˆLp(Rn, Âµ) and Îµ > 0,
there exists g âˆˆD such that ||f âˆ’g||p < Îµ.
Proof: Let P denote the set of all polynomials which have rational coeï¬ƒcients.
Then P is countable. Let Ï„ k âˆˆCc ((âˆ’(k + 1) , (k + 1))n) such that [âˆ’k, k]n â‰ºÏ„ k â‰º
(âˆ’(k + 1) , (k + 1))n . Let Dk denote the functions which are of the form, pÏ„ k where
p âˆˆP. Thus Dk is also countable. Let D â‰¡âˆªâˆž
k=1Dk. It follows each function in D is
in Cc (Rn) and so it in Lp (Rn, Âµ). Let f âˆˆLp (Rn, Âµ). By regularity of Âµ there exists
g âˆˆCc (Rn) such that ||f âˆ’g||Lp(Rn,Âµ) < Îµ
3. Let k be such that spt (g) âŠ†(âˆ’k, k)n .
Now by the Weierstrass approximation theorem there exists a polynomial q such
that
||g âˆ’q||[âˆ’(k+1),k+1]n
â‰¡
sup {|g (x) âˆ’q (x)| : x âˆˆ[âˆ’(k + 1) , (k + 1)]n}
<
Îµ
3Âµ ((âˆ’(k + 1) , k + 1)n).

12.4.
CONTINUITY OF TRANSLATION
327
It follows
||g âˆ’Ï„ kq||[âˆ’(k+1),k+1]n
=
||Ï„ kg âˆ’Ï„ kq||[âˆ’(k+1),k+1]n
<
Îµ
3Âµ ((âˆ’(k + 1) , k + 1)n).
Without loss of generality, it can be assumed this polynomial has all rational coef-
ï¬cients. Therefore, Ï„ kq âˆˆD.
||g âˆ’Ï„ kq||p
Lp(Rn)
=
Z
(âˆ’(k+1),k+1)n |g (x) âˆ’Ï„ k (x) q (x)|p dÂµ
â‰¤
Âµ
Îµ
3Âµ ((âˆ’(k + 1) , k + 1)n)
Â¶p
Âµ ((âˆ’(k + 1) , k + 1)n)
<
Â³Îµ
3
Â´p
.
It follows
||f âˆ’Ï„ kq||Lp(Rn,Âµ) â‰¤||f âˆ’g||Lp(Rn,Âµ) + ||g âˆ’Ï„ kq||p
Lp(Rn,Âµ) < Îµ
3 + Îµ
3 < Îµ.
This proves the theorem.
Corollary 12.19 Let â„¦be any Âµ measurable subset of Rn and let Âµ be a Radon
measure. Then Lp(â„¦, Âµ) is separable. Here
the Ïƒ algebra of measurable sets will
consist of all intersections of measurable sets with â„¦and the measure will be Âµ
restricted to these sets.
Proof: Let eD be the restrictions of D to â„¦. If f âˆˆLp(â„¦), let F be the zero
extension of f to all of Rn. Let Îµ > 0 be given. By Theorem 12.17 or 12.18 there
exists s âˆˆD such that ||F âˆ’s||p < Îµ. Thus
||s âˆ’f||Lp(â„¦,Âµ) â‰¤||s âˆ’F||Lp(Rn,Âµ) < Îµ
and so the countable set eD is dense in Lp(â„¦).
12.4
Continuity Of Translation
Deï¬nition 12.20 Let f be a function deï¬ned on U âŠ†Rn and let w âˆˆRn. Then
fw will be the function deï¬ned on w + U by
fw(x) = f(x âˆ’w).
Theorem 12.21 (Continuity of translation in Lp) Let f âˆˆLp(Rn) with the mea-
sure being Lebesgue measure. Then
lim
||w||â†’0 ||fw âˆ’f||p = 0.

328
THE LP SPACES
Proof: Let Îµ > 0 be given and let g âˆˆCc(Rn) with ||g âˆ’f||p <
Îµ
3.
Since
Lebesgue measure is translation invariant (mn(w + E) = mn(E)),
||gw âˆ’fw||p = ||g âˆ’f||p < Îµ
3.
You can see this from looking at simple functions and passing to the limit or you
could use the change of variables formula to verify it.
Therefore
||f âˆ’fw||p
â‰¤
||f âˆ’g||p + ||g âˆ’gw||p + ||gw âˆ’fw||
<
2Îµ
3 + ||g âˆ’gw||p.
(12.11)
But lim|w|â†’0 gw(x) = g(x) uniformly in x because g is uniformly continuous. Now
let B be a large ball containing spt (g) and let Î´1 be small enough that B (x, Î´) âŠ†B
whenever x âˆˆspt (g). If Îµ > 0 is given there exists Î´ < Î´1 such that if |w| < Î´, it
follows that |g (x âˆ’w) âˆ’g (x)| < Îµ/3
Â³
1 + mn (B)1/pÂ´
. Therefore,
||g âˆ’gw||p
=
ÂµZ
B
|g (x) âˆ’g (x âˆ’w)|p dmn
Â¶1/p
â‰¤
Îµ
mn (B)1/p
3
Â³
1 + mn (B)1/pÂ´ < Îµ
3.
Therefore, whenever |w| < Î´, it follows ||gâˆ’gw||p < Îµ
3 and so from 12.11 ||fâˆ’fw||p <
Îµ. This proves the theorem.
Part of the argument of this theorem is signiï¬cant enough to be stated as a
corollary.
Corollary 12.22 Suppose g âˆˆCc (Rn) and Âµ is a Radon measure on Rn. Then
lim
wâ†’0 ||g âˆ’gw||p = 0.
Proof: The proof of this follows from the last part of the above argument simply
replacing mn with Âµ. Translation invariance of the measure is not needed to draw
this conclusion because of uniform continuity of g.
12.5
Molliï¬ers And Density Of Smooth Functions
Deï¬nition 12.23 Let U be an open subset of Rn. Câˆž
c (U) is the vector space of all
inï¬nitely diï¬€erentiable functions which equal zero for all x outside of some compact
set contained in U. Similarly, Cm
c (U) is the vector space of all functions which are
m times continuously diï¬€erentiable and whose support is a compact subset of U.

12.5.
MOLLIFIERS AND DENSITY OF SMOOTH FUNCTIONS
329
Example 12.24 Let U = B (z, 2r)
Ïˆ (x) =
ï£±
ï£²
ï£³
exp
Â·Â³
|x âˆ’z|2 âˆ’r2Â´âˆ’1Â¸
if |x âˆ’z| < r,
0 if |x âˆ’z| â‰¥r.
Then a little work shows Ïˆ âˆˆCâˆž
c (U). The following also is easily obtained.
Lemma 12.25 Let U be any open set. Then Câˆž
c (U) Ì¸= âˆ….
Proof: Pick z âˆˆU and let r be small enough that B (z, 2r) âŠ†U. Then let
Ïˆ âˆˆCâˆž
c (B (z, 2r)) âŠ†Câˆž
c (U) be the function of the above example.
Deï¬nition 12.26 Let U = {x âˆˆRn : |x| < 1}. A sequence {Ïˆm} âŠ†Câˆž
c (U) is
called a molliï¬er (sometimes an approximate identity) if
Ïˆm(x) â‰¥0, Ïˆm(x) = 0, if |x| â‰¥1
m,
and
R
Ïˆm(x) = 1. Sometimes it may be written as {ÏˆÎµ} where ÏˆÎµ satisï¬es the above
conditions except ÏˆÎµ (x) = 0 if |x| â‰¥Îµ. In other words, Îµ takes the place of 1/m
and in everything that follows Îµ â†’0 instead of m â†’âˆž.
As before,
R
f(x, y)dÂµ(y) will mean x is ï¬xed and the function y â†’f(x, y)
is being integrated. To make the notation more familiar, dx is written instead of
dmn(x).
Example 12.27 Let
Ïˆ âˆˆCâˆž
c (B(0, 1)) (B(0, 1) = {x : |x| < 1})
with Ïˆ(x) â‰¥0 and
R
Ïˆdm = 1. Let Ïˆm(x) = cmÏˆ(mx) where cm is chosen in such
a way that
R
Ïˆmdm = 1. By the change of variables theorem cm = mn.
Deï¬nition 12.28 A function, f, is said to be in L1
loc(Rn, Âµ) if f is Âµ measurable
and if |f|XK âˆˆL1(Rn, Âµ) for every compact set, K. Here Âµ is a Radon measure
on Rn. Usually Âµ = mn, Lebesgue measure. When this is so, write L1
loc(Rn) or
Lp(Rn), etc. If f âˆˆL1
loc(Rn, Âµ), and g âˆˆCc(Rn),
f âˆ—g(x) â‰¡
Z
f(y)g(x âˆ’y)dÂµ.
The following lemma will be useful in what follows. It says that one of these very
unregular functions in L1
loc (Rn, Âµ) is smoothed out by convolving with a molliï¬er.
Lemma 12.29 Let f âˆˆL1
loc(Rn, Âµ), and g âˆˆCâˆž
c (Rn). Then f âˆ—g is an inï¬nitely
diï¬€erentiable function. Here Âµ is a Radon measure on Rn.

330
THE LP SPACES
Proof: Consider the diï¬€erence quotient for calculating a partial derivative of
f âˆ—g.
f âˆ—g (x + tej) âˆ’f âˆ—g (x)
t
=
Z
f(y)g(x + tej âˆ’y) âˆ’g (x âˆ’y)
t
dÂµ (y) .
Using the fact that g âˆˆCâˆž
c (Rn), the quotient,
g(x + tej âˆ’y) âˆ’g (x âˆ’y)
t
,
is uniformly bounded. To see this easily, use Theorem 5.53 on Page 119 to get the
existence of a constant, M depending on
max {||Dg (x)|| : x âˆˆRn}
such that
|g(x + tej âˆ’y) âˆ’g (x âˆ’y)| â‰¤M |t|
for any choice of x and y. Therefore, there exists a dominating function for the
integrand of the above integral which is of the form C |f (y)| XK where K is a
compact set containing the support of g.
It follows the limit of the diï¬€erence
quotient above passes inside the integral as t â†’0 and
âˆ‚
âˆ‚xj
(f âˆ—g) (x) =
Z
f(y) âˆ‚
âˆ‚xj
g (x âˆ’y) dÂµ (y) .
Now letting
âˆ‚
âˆ‚xj g play the role of g in the above argument, partial derivatives of all
orders exist. This proves the lemma.
Theorem 12.30 Let K be a compact subset of an open set, U. Then there exists
a function, h âˆˆCâˆž
c (U), such that h(x) = 1 for all x âˆˆK and h(x) âˆˆ[0, 1] for all
x.
Proof: Let r > 0 be small enough that K + B(0, 3r) âŠ†U.
The symbol,
K + B(0, 3r) means
{k + x : k âˆˆK and x âˆˆB (0, 3r)} .
Thus this is simply a way to write
âˆª{B (k, 3r) : k âˆˆK} .
Think of it as fattening up the set, K. Let Kr = K + B(0, r). A picture of what is
happening follows.
K
Kr U
Consider XKr âˆ—Ïˆmwhere Ïˆmis a molliï¬er.
Let m be so large that
1
m < r.
Then from the deï¬nition of what is meant by a convolution, and using that Ïˆm has

12.5.
MOLLIFIERS AND DENSITY OF SMOOTH FUNCTIONS
331
support in B
Â¡
0, 1
m
Â¢
, XKr âˆ—Ïˆm = 1 on K and that its support is in K + B (0, 3r).
Now using Lemma 12.29, XKr âˆ—Ïˆm is also inï¬nitely diï¬€erentiable. Therefore, let
h = XKr âˆ—Ïˆm.
The following corollary will be used later.
Corollary 12.31 Let K be a compact set in Rn and let {Ui}âˆž
i=1 be an open cover
of K. Then there exist functions, Ïˆk âˆˆCâˆž
c (Ui) such that Ïˆi â‰ºUi and
âˆž
X
i=1
Ïˆi (x) = 1.
If K1 is a compact subset of U1 there exist such functions such that also Ïˆ1 (x) = 1
for all x âˆˆK1.
Proof: This follows from a repeat of the proof of Theorem 9.18 on Page 220,
replacing the lemma used in that proof with Theorem 12.30.
Theorem 12.32 For each p â‰¥1, Câˆž
c (Rn) is dense in Lp(Rn). Here the measure
is Lebesgue measure.
Proof: Let f âˆˆLp(Rn) and let Îµ > 0 be given. Choose g âˆˆCc(Rn) such that
||f âˆ’g||p < Îµ
2. This can be done by using Theorem 12.16. Now let
gm (x) = g âˆ—Ïˆm (x) â‰¡
Z
g (x âˆ’y) Ïˆm (y) dmn (y) =
Z
g (y) Ïˆm (x âˆ’y) dmn (y)
where {Ïˆm} is a molliï¬er. It follows from Lemma 12.29 gm âˆˆCâˆž
c (Rn). It vanishes
if x /âˆˆspt(g) + B(0, 1
m).
||g âˆ’gm||p
=
ÂµZ
|g(x) âˆ’
Z
g(x âˆ’y)Ïˆm(y)dmn(y)|pdmn(x)
Â¶ 1
p
â‰¤
ÂµZ
(
Z
|g(x) âˆ’g(x âˆ’y)|Ïˆm(y)dmn(y))pdmn(x)
Â¶ 1
p
â‰¤
Z ÂµZ
|g(x) âˆ’g(x âˆ’y)|pdmn(x)
Â¶ 1
p
Ïˆm(y)dmn(y)
=
Z
B(0, 1
m )
||g âˆ’gy||pÏˆm(y)dmn(y) < Îµ
2
whenever m is large enough. This follows from Corollary 12.22. Theorem 12.12 was
used to obtain the third inequality. There is no measurability problem because the
function
(x, y) â†’|g(x) âˆ’g(x âˆ’y)|Ïˆm(y)
is continuous. Thus when m is large enough,
||f âˆ’gm||p â‰¤||f âˆ’g||p + ||g âˆ’gm||p < Îµ
2 + Îµ
2 = Îµ.

332
THE LP SPACES
This proves the theorem.
This is a very remarkable result. Functions in Lp (Rn) donâ€™t need to be continu-
ous anywhere and yet every such function is very close in the Lp norm to one which
is inï¬nitely diï¬€erentiable having compact support.
Another thing should probably be mentioned. If you have had a course in com-
plex analysis, you may be wondering whether these inï¬nitely diï¬€erentiable functions
having compact support have anything to do with analytic functions which also have
inï¬nitely many derivatives. The answer is no! Recall that if an analytic function
has a limit point in the set of zeros then it is identically equal to zero. Thus these
functions in Câˆž
c (Rn) are not analytic. This is a strictly real analysis phenomenon
and has absolutely nothing to do with the theory of functions of a complex variable.
12.6
Exercises
1. Let E be a Lebesgue measurable set in R. Suppose m(E) > 0. Consider the
set
E âˆ’E = {x âˆ’y : x âˆˆE, y âˆˆE}.
Show that E âˆ’E contains an interval. Hint: Let
f(x) =
Z
XE(t)XE(x + t)dt.
Note f is continuous at 0 and f(0) > 0 and use continuity of translation in
Lp.
2. Establish the inequality ||fg||r â‰¤||f||p ||g||q whenever 1
r = 1
p + 1
q.
3. Let (â„¦, S, Âµ) be counting measure on N. Thus â„¦= N and S = P (N) with
Âµ (S) = number of things in S. Let 1 â‰¤p â‰¤q. Show that in this case,
L1 (N) âŠ†Lp (N) âŠ†Lq (N) .
Hint: This is real easy if you consider what
R
â„¦fdÂµ equals. How are the
norms related?
4. Consider the function, f (x, y) = xpâˆ’1
py + yqâˆ’1
qx
for x, y > 0 and 1
p + 1
q = 1. Show
directly that f (x, y) â‰¥1 for all such x, y and show this implies xy â‰¤xp
p + yq
q .
5. Give an example of a sequence of functions in Lp (R) which converges to zero
in Lp but does not converge pointwise to 0. Does this contradict the proof of
the theorem that Lp is complete?
6. Let K be a bounded subset of Lp (Rn) and suppose that there exists G such
that G is compact with
Z
Rn\G
|u (x)|p dx < Îµp

12.6.
EXERCISES
333
and for all Îµ > 0, there exist a Î´ > 0 and such that if |h| < Î´, then
Z
|u (x + h) âˆ’u (x)|p dx < Îµp
for all u âˆˆK. Show that K is precompact in Lp (Rn). Hint: Let Ï†k be a
molliï¬er and consider
Kk â‰¡{u âˆ—Ï†k : u âˆˆK} .
Verify the conditions of the Ascoli Arzela theorem for these functions deï¬ned
on G and show there is an Îµ net for each Îµ > 0. Can you modify this to let
an arbitrary open set take the place of Rn?
7. Let (â„¦, d) be a metric space and suppose also that (â„¦, S, Âµ) is a regular mea-
sure space such that Âµ (â„¦) < âˆžand let f âˆˆL1 (â„¦) where f has complex
values. Show that for every Îµ > 0, there exists an open set of measure less
than Îµ, denoted here by V and a continuous function, g deï¬ned on â„¦such
that f = g on V C. Thus, aside from a set of small measure, f is continuous.
If |f (Ï‰)| â‰¤M, show that it can be assumed that |g (Ï‰)| â‰¤M. This is called
Lusinâ€™s theorem. Hint: Use Theorems 12.16 and 12.10 to obtain a sequence
of functions in Cc (â„¦) , {gn} which converges pointwise a.e. to f and then use
Egoroï¬€â€™s theorem to obtain a small set, W of measure less than Îµ/2 such that
convergence is uniform on W C. Now let F be a closed subset of W C such
that Âµ
Â¡
W C \ F
Â¢
< Îµ/2. Let V = F C. Thus Âµ (V ) < Îµ and on F = V C,
the convergence of {gn} is uniform showing that the restriction of f to V C is
continuous. Now use the Tietze extension theorem.
8. Let Ï†m âˆˆCâˆž
c (Rn), Ï†m (x) â‰¥0,and
R
Rn Ï†m(y)dy = 1 with
lim
mâ†’âˆžsup {|x| : x âˆˆspt (Ï†m)} = 0.
Show if f âˆˆLp(Rn), limmâ†’âˆžf âˆ—Ï†m = f in Lp(Rn).
9. Let Ï† : R â†’R be convex. This means
Ï†(Î»x + (1 âˆ’Î»)y) â‰¤Î»Ï†(x) + (1 âˆ’Î»)Ï†(y)
whenever Î» âˆˆ[0, 1]. Verify that if x < y < z, then Ï†(y)âˆ’Ï†(x)
yâˆ’x
â‰¤
Ï†(z)âˆ’Ï†(y)
zâˆ’y
and that
Ï†(z)âˆ’Ï†(x)
zâˆ’x
â‰¤
Ï†(z)âˆ’Ï†(y)
zâˆ’y
.
Show if s âˆˆR there exists Î» such that
Ï†(s) â‰¤Ï†(t) + Î»(s âˆ’t) for all t. Show that if Ï† is convex, then Ï† is continuous.
10. â†‘Prove Jensenâ€™s inequality. If Ï† : R â†’R is convex, Âµ(â„¦) = 1, and f : â„¦â†’R
is in L1(â„¦), then Ï†(
R
â„¦f du) â‰¤
R
â„¦Ï†(f)dÂµ. Hint: Let s =
R
â„¦f dÂµ and use
Problem 9.
11. Let 1
p + 1
pâ€² = 1, p > 1, let f âˆˆLp(R), g âˆˆLpâ€²(R). Show f âˆ—g is uniformly
continuous on R and |(f âˆ—g)(x)| â‰¤||f||Lp||g||Lpâ€². Hint: You need to consider
why f âˆ—g exists and then this follows from the deï¬nition of convolution and
continuity of translation in Lp.

334
THE LP SPACES
12. B(p, q) =
R 1
0 xpâˆ’1(1 âˆ’x)qâˆ’1dx, Î“(p) =
R âˆž
0
eâˆ’ttpâˆ’1dt for p, q > 0. The ï¬rst
of these is called the beta function, while the second is the gamma function.
Show a.) Î“(p + 1) = pÎ“(p);
b.) Î“(p)Î“(q) = B(p, q)Î“(p + q).
13. Let f âˆˆCc(0, âˆž) and deï¬ne F(x) = 1
x
R x
0 f(t)dt. Show
||F||Lp(0,âˆž) â‰¤
p
p âˆ’1||f||Lp(0,âˆž) whenever p > 1.
Hint: Argue there is no loss of generality in assuming f â‰¥0 and then assume
this is so. Integrate
R âˆž
0
|F(x)|pdx by parts as follows:
Z âˆž
0
F pdx =
show = 0
z }| {
xF p|âˆž
0
âˆ’p
Z âˆž
0
xF pâˆ’1F â€²dx.
Now show xF â€² = f âˆ’F and use this in the last integral.
Complete the
argument by using Holderâ€™s inequality and p âˆ’1 = p/q.
14. â†‘Now suppose f âˆˆLp(0, âˆž), p > 1, and f not necessarily in Cc(0, âˆž). Show
that F(x) = 1
x
R x
0 f(t)dt still makes sense for each x > 0. Show the inequality
of Problem 13 is still valid. This inequality is called Hardyâ€™s inequality. Hint:
To show this, use the above inequality along with the density of Cc (0, âˆž) in
Lp (0, âˆž).
15. Suppose f, g â‰¥0. When does equality hold in Holderâ€™s inequality?
16. Prove Vitaliâ€™s Convergence theorem: Let {fn} be uniformly integrable and
complex valued, Âµ(â„¦) < âˆž, fn(x) â†’f(x) a.e. where f is measurable. Then
f âˆˆL1 and limnâ†’âˆž
R
â„¦|fn âˆ’f|dÂµ = 0. Hint: Use Egoroï¬€â€™s theorem to show
{fn} is a Cauchy sequence in L1 (â„¦). This yields a diï¬€erent and easier proof
than what was done earlier. See Theorem 8.50 on Page 204.
17. â†‘Show the Vitali Convergence theorem implies the Dominated Convergence
theorem for ï¬nite measure spaces but there exist examples where the Vitali
convergence theorem works and the dominated convergence theorem does not.
18. â†‘Suppose Âµ(â„¦) < âˆž, {fn} âŠ†L1(â„¦), and
Z
â„¦
h (|fn|) dÂµ < C
for all n where h is a continuous, nonnegative function satisfying
lim
tâ†’âˆž
h (t)
t
= âˆž.
Show {fn} is uniformly integrable. In applications, this often occurs in the
form of a bound on ||fn||p.

12.6.
EXERCISES
335
19. â†‘Sometimes, especially in books on probability, a diï¬€erent deï¬nition of uni-
form integrability is used than that presented here. A set of functions, S,
deï¬ned on a ï¬nite measure space, (â„¦, S, Âµ) is said to be uniformly integrable
if for all Îµ > 0 there exists Î± > 0 such that for all f âˆˆS,
Z
[|f|â‰¥Î±]
|f| dÂµ â‰¤Îµ.
Show that this deï¬nition is equivalent to the deï¬nition of uniform integrability
given earlier in Deï¬nition 8.48 on Page 203 with the addition of the condition
that there is a constant, C < âˆžsuch that
Z
|f| dÂµ â‰¤C
for all f âˆˆS.
20. f âˆˆLâˆž(â„¦, Âµ) if there exists a set of measure zero, E, and a constant C < âˆž
such that |f(x)| â‰¤C for all x /âˆˆE.
||f||âˆžâ‰¡inf{C : |f(x)| â‰¤C a.e.}.
Show || ||âˆžis a norm on Lâˆž(â„¦, Âµ) provided f and g are identiï¬ed if f(x) =
g(x) a.e. Show Lâˆž(â„¦, Âµ) is complete. Hint: You might want to show that
[|f| > ||f||âˆž] has measure zero so ||f||âˆžis the smallest number at least as
large as |f (x)| for a.e. x. Thus ||f||âˆžis one of the constants, C in the above.
21. Suppose f âˆˆLâˆžâˆ©L1. Show limpâ†’âˆž||f||Lp = ||f||âˆž. Hint:
(||f||âˆžâˆ’Îµ)p Âµ ([|f| > ||f||âˆžâˆ’Îµ]) â‰¤
Z
[|f|>||f||âˆžâˆ’Îµ]
|f|p dÂµ â‰¤
Z
|f|p dÂµ =
Z
|f|pâˆ’1 |f| dÂµ â‰¤||f||pâˆ’1
âˆž
Z
|f| dÂµ.
Now raise both ends to the 1/p power and take lim inf and lim sup as p â†’âˆž.
You should get ||f||âˆžâˆ’Îµ â‰¤lim inf ||f||p â‰¤lim sup ||f||p â‰¤||f||âˆž
22. Suppose Âµ(â„¦) < âˆž. Show that if 1 â‰¤p < q, then Lq(â„¦) âŠ†Lp(â„¦). Hint Use
Holderâ€™s inequality.
23. Show L1(R) âŠˆL2(R) and L2(R) âŠˆL1(R) if Lebesgue measure is used. Hint:
Consider 1/âˆšx and 1/x.
24. Suppose that Î¸ âˆˆ[0, 1] and r, s, q > 0 with
1
q = Î¸
r + 1 âˆ’Î¸
s
.

336
THE LP SPACES
show that
(
Z
|f|qdÂµ)1/q â‰¤((
Z
|f|rdÂµ)1/r)Î¸((
Z
|f|sdÂµ)1/s)1âˆ’Î¸.
If q, r, s â‰¥1 this says that
||f||q â‰¤||f||Î¸
r||f||1âˆ’Î¸
s
.
Using this, show that
ln
Â³
||f||q
Â´
â‰¤Î¸ ln (||f||r) + (1 âˆ’Î¸) ln (||f||s) .
Hint:
Z
|f|qdÂµ =
Z
|f|qÎ¸|f|q(1âˆ’Î¸)dÂµ.
Now note that 1 = Î¸q
r + q(1âˆ’Î¸)
s
and use Holderâ€™s inequality.
25. Suppose f is a function in L1 (R) and f is inï¬nitely diï¬€erentiable. Is f â€² âˆˆ
L1 (R)?
Hint: What if Ï† âˆˆCâˆž
c (0, 1) and f (x) = Ï† (2n (x âˆ’n)) for x âˆˆ
(n, n + 1) , f (x) = 0 if x < 0?

Banach Spaces
13.1
Theorems Based On Baire Category
13.1.1
Baire Category Theorem
Some examples of Banach spaces that have been discussed up to now are Rn, Cn,
and Lp (â„¦). Theorems about general Banach spaces are proved in this chapter.
The main theorems to be presented here are the uniform boundedness theorem, the
open mapping theorem, the closed graph theorem, and the Hahn Banach Theorem.
The ï¬rst three of these theorems come from the Baire category theorem which is
about to be presented. They are topological in nature. The Hahn Banach theorem
has nothing to do with topology. Banach spaces are all normed linear spaces and as
such, they are all metric spaces because a normed linear space may be considered
as a metric space with d (x, y) â‰¡||x âˆ’y||. You can check that this satisï¬es all the
axioms of a metric. As usual, if every Cauchy sequence converges, the metric space
is called complete.
Deï¬nition 13.1 A complete normed linear space is called a Banach space.
The following remarkable result is called the Baire category theorem. To get an
idea of its meaning, imagine you draw a line in the plane. The complement of this
line is an open set and is dense because every point, even those on the line, are limit
points of this open set. Now draw another line. The complement of the two lines
is still open and dense. Keep drawing lines and looking at the complements of the
union of these lines. You always have an open set which is dense. Now what if there
were countably many lines? The Baire category theorem implies the complement
of the union of these lines is dense. In particular it is nonempty. Thus you cannot
write the plane as a countable union of lines. This is a rather rough description of
this very important theorem. The precise statement and proof follow.
Theorem 13.2 Let (X, d) be a complete metric space and let {Un}âˆž
n=1 be a se-
quence of open subsets of X satisfying Un = X (Un is dense). Then D â‰¡âˆ©âˆž
n=1Un
is a dense subset of X.
337

338
BANACH SPACES
Proof: Let p âˆˆX and let r0 > 0. I need to show D âˆ©B(p, r0) Ì¸= âˆ…. Since U1 is
dense, there exists p1 âˆˆU1 âˆ©B(p, r0), an open set. Let p1 âˆˆB(p1, r1) âŠ†B(p1, r1) âŠ†
U1 âˆ©B(p, r0) and r1 < 2âˆ’1. This is possible because U1 âˆ©B (p, r0) is an open set
and so there exists r1 such that B (p1, 2r1) âŠ†U1 âˆ©B (p, r0). But
B (p1, r1) âŠ†B (p1, r1) âŠ†B (p1, 2r1)
because B (p1, r1) = {x âˆˆX : d (x, p) â‰¤r1}. (Why?)
 r0 p
p1Â·
There exists p2 âˆˆU2 âˆ©B(p1, r1) because U2 is dense. Let
p2 âˆˆB(p2, r2) âŠ†B(p2, r2) âŠ†U2 âˆ©B(p1, r1) âŠ†U1 âˆ©U2 âˆ©B(p, r0).
and let r2 < 2âˆ’2. Continue in this way. Thus
rn < 2âˆ’n,
B(pn, rn) âŠ†U1 âˆ©U2 âˆ©... âˆ©Un âˆ©B(p, r0),
B(pn, rn) âŠ†B(pnâˆ’1, rnâˆ’1).
The sequence, {pn} is a Cauchy sequence because all terms of {pk} for k â‰¥n
are contained in B (pn, rn), a set whose diameter is no larger than 2âˆ’n. Since X is
complete, there exists pâˆžsuch that
lim
nâ†’âˆžpn = pâˆž.
Since all but ï¬nitely many terms of {pn} are in B(pm, rm), it follows that pâˆžâˆˆ
B(pm, rm) for each m. Therefore,
pâˆžâˆˆâˆ©âˆž
m=1B(pm, rm) âŠ†âˆ©âˆž
i=1Ui âˆ©B(p, r0).
This proves the theorem.
The following corollary is also called the Baire category theorem.
Corollary 13.3 Let X be a complete metric space and suppose X = âˆªâˆž
i=1Fi where
each Fi is a closed set. Then for some i, interior Fi Ì¸= âˆ….
Proof: If all Fi has empty interior, then F C
i
would be a dense open set. There-
fore, from Theorem 13.2, it would follow that
âˆ…= (âˆªâˆž
i=1Fi)C = âˆ©âˆž
i=1F C
i
Ì¸= âˆ….

13.1.
THEOREMS BASED ON BAIRE CATEGORY
339
The set D of Theorem 13.2 is called a GÎ´ set because it is the countable inter-
section of open sets. Thus D is a dense GÎ´ set.
Recall that a norm satisï¬es:
a.) ||x|| â‰¥0, ||x|| = 0 if and only if x = 0.
b.) ||x + y|| â‰¤||x|| + ||y||.
c.) ||cx|| = |c| ||x|| if c is a scalar and x âˆˆX.
From the deï¬nition of continuity, it follows easily that a function is continuous
if
lim
nâ†’âˆžxn = x
implies
lim
nâ†’âˆžf(xn) = f(x).
Theorem 13.4 Let X and Y be two normed linear spaces and let L : X â†’Y be
linear (L(ax + by) = aL(x) + bL(y) for a, b scalars and x, y âˆˆX). The following
are equivalent
a.) L is continuous at 0
b.) L is continuous
c.)
There exists K > 0 such that ||Lx||Y â‰¤K ||x||X for all x âˆˆX (L is
bounded).
Proof: a.)â‡’b.) Let xn â†’x. It is necessary to show that Lxn â†’Lx. But
(xn âˆ’x) â†’0 and so from continuity at 0, it follows
L (xn âˆ’x) = Lxn âˆ’Lx â†’0
so Lxn â†’Lx. This shows a.) implies b.).
b.)â‡’c.) Since L is continuous, L is continuous at 0. Hence ||Lx||Y < 1 whenever
||x||X â‰¤Î´ for some Î´. Therefore, suppressing the subscript on the || ||,
||L
Âµ Î´x
||x||
Â¶
|| â‰¤1.
Hence
||Lx|| â‰¤1
Î´ ||x||.
c.)â‡’a.) follows from the inequality given in c.).
Deï¬nition 13.5 Let L : X â†’Y be linear and continuous where X and Y are
normed linear spaces. Denote the set of all such continuous linear maps by L(X, Y )
and deï¬ne
||L|| = sup{||Lx|| : ||x|| â‰¤1}.
(13.1)
This is called the operator norm.

340
BANACH SPACES
Note that from Theorem 13.4 ||L|| is well deï¬ned because of part c.) of that
Theorem.
The next lemma follows immediately from the deï¬nition of the norm and the
assumption that L is linear.
Lemma 13.6 With ||L|| deï¬ned in 13.1, L(X, Y ) is a normed linear space. Also
||Lx|| â‰¤||L|| ||x||.
Proof: Let x Ì¸= 0 then x/ ||x|| has norm equal to 1 and so
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯L
Âµ x
||x||
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤||L|| .
Therefore, multiplying both sides by ||x||, ||Lx|| â‰¤||L|| ||x||. This is obviously a
linear space. It remains to verify the operator norm really is a norm. First of all,
if ||L|| = 0, then Lx = 0 for all ||x|| â‰¤1. It follows that for any x Ì¸= 0, 0 = L
Â³
x
||x||
Â´
and so Lx = 0. Therefore, L = 0. Also, if c is a scalar,
||cL|| = sup
||x||â‰¤1
||cL (x)|| = |c| sup
||x||â‰¤1
||Lx|| = |c| ||L|| .
It remains to verify the triangle inequality. Let L, M âˆˆL (X, Y ) .
||L + M||
â‰¡
sup
||x||â‰¤1
||(L + M) (x)|| â‰¤sup
||x||â‰¤1
(||Lx|| + ||Mx||)
â‰¤
sup
||x||â‰¤1
||Lx|| + sup
||x||â‰¤1
||Mx|| = ||L|| + ||M|| .
This shows the operator norm is really a norm as hoped. This proves the lemma.
For example, consider the space of linear transformations deï¬ned on Rn having
values in Rm. The fact the transformation is linear automatically imparts conti-
nuity to it. You should give a proof of this fact. Recall that every such linear
transformation can be realized in terms of matrix multiplication.
Thus, in ï¬nite dimensions the algebraic condition that an operator is linear is
suï¬ƒcient to imply the topological condition that the operator is continuous. The
situation is not so simple in inï¬nite dimensional spaces such as C (X; Rn). This
explains the imposition of the topological condition of continuity as a criterion for
membership in L (X, Y ) in addition to the algebraic condition of linearity.
Theorem 13.7 If Y is a Banach space, then L(X, Y ) is also a Banach space.
Proof: Let {Ln} be a Cauchy sequence in L(X, Y ) and let x âˆˆX.
||Lnx âˆ’Lmx|| â‰¤||x|| ||Ln âˆ’Lm||.
Thus {Lnx} is a Cauchy sequence. Let
Lx = lim
nâ†’âˆžLnx.

13.1.
THEOREMS BASED ON BAIRE CATEGORY
341
Then, clearly, L is linear because if x1, x2 are in X, and a, b are scalars, then
L (ax1 + bx2)
=
lim
nâ†’âˆžLn (ax1 + bx2)
=
lim
nâ†’âˆž(aLnx1 + bLnx2)
=
aLx1 + bLx2.
Also L is continuous. To see this, note that {||Ln||} is a Cauchy sequence of real
numbers because |||Ln|| âˆ’||Lm||| â‰¤||Lnâˆ’Lm||. Hence there exists K > sup{||Ln|| :
n âˆˆN}. Thus, if x âˆˆX,
||Lx|| = lim
nâ†’âˆž||Lnx|| â‰¤K||x||.
This proves the theorem.
13.1.2
Uniform Boundedness Theorem
The next big result is sometimes called the Uniform Boundedness theorem, or the
Banach-Steinhaus theorem. This is a very surprising theorem which implies that for
a collection of bounded linear operators, if they are bounded pointwise, then they are
also bounded uniformly. As an example of a situation in which pointwise bounded
does not imply uniformly bounded, consider the functions fÎ± (x) â‰¡X(Î±,1) (x) xâˆ’1
for Î± âˆˆ(0, 1). Clearly each function is bounded and the collection of functions is
bounded at each point of (0, 1), but there is no bound for all these functions taken
together. One problem is that (0, 1) is not a Banach space. Therefore, the functions
cannot be linear.
Theorem 13.8 Let X be a Banach space and let Y be a normed linear space. Let
{LÎ±}Î±âˆˆÎ› be a collection of elements of L(X, Y ). Then one of the following happens.
a.) sup{||LÎ±|| : Î± âˆˆÎ›} < âˆž
b.) There exists a dense GÎ´ set, D, such that for all x âˆˆD,
sup{||LÎ±x|| Î± âˆˆÎ›} = âˆž.
Proof: For each n âˆˆN, deï¬ne
Un = {x âˆˆX : sup{||LÎ±x|| : Î± âˆˆÎ›} > n}.
Then Un is an open set because if x âˆˆUn, then there exists Î± âˆˆÎ› such that
||LÎ±x|| > n
But then, since LÎ± is continuous, this situation persists for all y suï¬ƒciently close
to x, say for all y âˆˆB (x, Î´). Then B (x, Î´) âŠ†Un which shows Un is open.
Case b.) is obtained from Theorem 13.2 if each Un is dense.
The other case is that for some n, Un is not dense. If this occurs, there exists
x0 and r > 0 such that for all x âˆˆB(x0, r), ||LÎ±x|| â‰¤n for all Î±. Now if y âˆˆ

342
BANACH SPACES
B(0, r), x0 + y âˆˆB(x0, r). Consequently, for all such y, ||LÎ±(x0 + y)|| â‰¤n. This
implies that for all Î± âˆˆÎ› and ||y|| < r,
||LÎ±y|| â‰¤n + ||LÎ±(x0)|| â‰¤2n.
Therefore, if ||y|| â‰¤1,
Â¯Â¯Â¯Â¯ r
2y
Â¯Â¯Â¯Â¯ < r and so for all Î±,
||LÎ±
Â³r
2y
Â´
|| â‰¤2n.
Now multiplying by r/2 it follows that whenever ||y|| â‰¤1, ||LÎ± (y)|| â‰¤4n/r. Hence
case a.) holds.
13.1.3
Open Mapping Theorem
Another remarkable theorem which depends on the Baire category theorem is the
open mapping theorem.
Unlike Theorem 13.8 it requires both X and Y to be
Banach spaces.
Theorem 13.9 Let X and Y be Banach spaces, let L âˆˆL(X, Y ), and suppose L
is onto. Then L maps open sets onto open sets.
To aid in the proof, here is a lemma.
Lemma 13.10 Let a and b be positive constants and suppose
B(0, a) âŠ†L(B(0, b)).
Then
L(B(0, b)) âŠ†L(B(0, 2b)).
Proof of Lemma 13.10: Let y âˆˆL(B(0, b)). There exists x1 âˆˆB(0, b) such
that ||y âˆ’Lx1|| < a
2. Now this implies
2y âˆ’2Lx1 âˆˆB(0, a) âŠ†L(B(0, b)).
Thus 2y âˆ’2Lx1 âˆˆL(B(0, b)) just like y was. Therefore, there exists x2 âˆˆB(0, b)
such that ||2y âˆ’2Lx1 âˆ’Lx2|| < a/2. Hence ||4y âˆ’4Lx1 âˆ’2Lx2|| < a, and there
exists x3 âˆˆB (0, b) such that ||4y âˆ’4Lx1 âˆ’2Lx2 âˆ’Lx3|| < a/2. Continuing in this
way, there exist x1, x2, x3, x4, ... in B(0, b) such that
||2ny âˆ’
n
X
i=1
2nâˆ’(iâˆ’1)L(xi)|| < a
which implies
||y âˆ’
n
X
i=1
2âˆ’(iâˆ’1)L(xi)|| = ||y âˆ’L
Ãƒ n
X
i=1
2âˆ’(iâˆ’1)(xi)
!
|| < 2âˆ’na
(13.2)

13.1.
THEOREMS BASED ON BAIRE CATEGORY
343
Now consider the partial sums of the series, Pâˆž
i=1 2âˆ’(iâˆ’1)xi.
||
n
X
i=m
2âˆ’(iâˆ’1)xi|| â‰¤b
âˆž
X
i=m
2âˆ’(iâˆ’1) = b 2âˆ’m+2.
Therefore, these partial sums form a Cauchy sequence and so since X is complete,
there exists x = Pâˆž
i=1 2âˆ’(iâˆ’1)xi. Letting n â†’âˆžin 13.2 yields ||y âˆ’Lx|| = 0. Now
||x|| = lim
nâ†’âˆž||
n
X
i=1
2âˆ’(iâˆ’1)xi||
â‰¤lim
nâ†’âˆž
n
X
i=1
2âˆ’(iâˆ’1)||xi|| < lim
nâ†’âˆž
n
X
i=1
2âˆ’(iâˆ’1)b = 2b.
This proves the lemma.
Proof of Theorem 13.9: Y = âˆªâˆž
n=1L(B(0, n)). By Corollary 13.3, the set,
L(B(0, n0)) has nonempty interior for some n0. Thus B(y, r) âŠ†L(B(0, n0)) for
some y and some r > 0. Since L is linear B(âˆ’y, r) âŠ†L(B(0, n0)) also. Here is
why. If z âˆˆB(âˆ’y, r), then âˆ’z âˆˆB(y, r) and so there exists xn âˆˆB (0, n0) such
that Lxn â†’âˆ’z. Therefore, L (âˆ’xn) â†’z and âˆ’xn âˆˆB (0, n0) also. Therefore
z âˆˆL(B(0, n0)). Then it follows that
B(0, r)
âŠ†
B(y, r) + B(âˆ’y, r)
â‰¡
{y1 + y2 : y1 âˆˆB (y, r) and y2 âˆˆB (âˆ’y, r)}
âŠ†
L(B(0, 2n0))
The reason for the last inclusion is that from the above, if y1 âˆˆB (y, r) and y2 âˆˆ
B (âˆ’y, r), there exists xn, zn âˆˆB (0, n0) such that
Lxn â†’y1, Lzn â†’y2.
Therefore,
||xn + zn|| â‰¤2n0
and so (y1 + y2) âˆˆL(B(0, 2n0)).
By Lemma 13.10, L(B(0, 2n0)) âŠ†L(B(0, 4n0)) which shows
B(0, r) âŠ†L(B(0, 4n0)).
Letting a = r(4n0)âˆ’1, it follows, since L is linear, that B(0, a) âŠ†L(B(0, 1)). It
follows since L is linear,
L(B(0, r)) âŠ‡B(0, ar).
(13.3)
Now let U be open in X and let x + B(0, r) = B(x, r) âŠ†U. Using 13.3,
L(U) âŠ‡L(x + B(0, r))
= Lx + L(B(0, r)) âŠ‡Lx + B(0, ar) = B(Lx, ar).

344
BANACH SPACES
Hence
Lx âˆˆB(Lx, ar) âŠ†L(U).
which shows that every point, Lx âˆˆLU, is an interior point of LU and so LU is
open. This proves the theorem.
This theorem is surprising because it implies that if |Â·| and ||Â·|| are two norms
with respect to which a vector space X is a Banach space such that |Â·| â‰¤K ||Â·||,
then there exists a constant k, such that ||Â·|| â‰¤k |Â·| . This can be useful because
sometimes it is not clear how to compute k when all that is needed is its existence.
To see the open mapping theorem implies this, consider the identity map id x = x.
Then id : (X, ||Â·||) â†’(X, |Â·|) is continuous and onto. Hence id is an open map which
implies idâˆ’1 is continuous. Theorem 13.4 gives the existence of the constant k.
13.1.4
Closed Graph Theorem
Deï¬nition 13.11 Let f : D â†’E.
The set of all ordered pairs of the form
{(x, f(x)) : x âˆˆD} is called the graph of f.
Deï¬nition 13.12 If X and Y are normed linear spaces, make XÃ—Y into a normed
linear space by using the norm ||(x, y)|| = max (||x||, ||y||) along with component-
wise addition and scalar multiplication. Thus a(x, y) + b(z, w) â‰¡(ax + bz, ay + bw).
There are other ways to give a norm for X Ã— Y . For example, you could deï¬ne
||(x, y)|| = ||x|| + ||y||
Lemma 13.13 The norm deï¬ned in Deï¬nition 13.12 on X Ã— Y along with the
deï¬nition of addition and scalar multiplication given there make X Ã— Y into a
normed linear space.
Proof: The only axiom for a norm which is not obvious is the triangle inequality.
Therefore, consider
||(x1, y1) + (x2, y2)||
=
||(x1 + x2, y1 + y2)||
=
max (||x1 + x2|| , ||y1 + y2||)
â‰¤
max (||x1|| + ||x2|| , ||y1|| + ||y2||)
â‰¤
max (||x1|| , ||y1||) + max (||x2|| , ||y2||)
=
||(x1, y1)|| + ||(x2, y2)|| .
It is obvious X Ã— Y is a vector space from the above deï¬nition. This proves the
lemma.
Lemma 13.14 If X and Y are Banach spaces, then X Ã— Y with the norm and
vector space operations deï¬ned in Deï¬nition 13.12 is also a Banach space.

13.1.
THEOREMS BASED ON BAIRE CATEGORY
345
Proof: The only thing left to check is that the space is complete. But this
follows from the simple observation that {(xn, yn)} is a Cauchy sequence in X Ã— Y
if and only if {xn} and {yn} are Cauchy sequences in X and Y respectively. Thus
if {(xn, yn)} is a Cauchy sequence in X Ã—Y , it follows there exist x and y such that
xn â†’x and yn â†’y. But then from the deï¬nition of the norm, (xn, yn) â†’(x, y).
Lemma 13.15 Every closed subspace of a Banach space is a Banach space.
Proof: If F âŠ†X where X is a Banach space and {xn} is a Cauchy sequence
in F, then since X is complete, there exists a unique x âˆˆX such that xn â†’x.
However this means x âˆˆF = F since F is closed.
Deï¬nition 13.16 Let X and Y be Banach spaces and let D âŠ†X be a subspace. A
linear map L : D â†’Y is said to be closed if its graph is a closed subspace of X Ã—Y .
Equivalently, L is closed if xn â†’x and Lxn â†’y implies x âˆˆD and y = Lx.
Note the distinction between closed and continuous. If the operator is closed
the assertion that y = Lx only follows if it is known that the sequence {Lxn}
converges. In the case of a continuous operator, the convergence of {Lxn} follows
from the assumption that xn â†’x. It is not always the case that a mapping which
is closed is necessarily continuous. Consider the function f (x) = tan (x) if x is not
an odd multiple of Ï€
2 and f (x) â‰¡0 at every odd multiple of Ï€
2 . Then the graph
is closed and the function is deï¬ned on R but it clearly fails to be continuous. Of
course this function is not linear. You could also consider the map,
d
dx :
Â©
y âˆˆC1 ([0, 1]) : y (0) = 0
Âª
â‰¡D â†’C ([0, 1]) .
where the norm is the uniform norm on C ([0, 1]) , ||y||âˆž. If y âˆˆD, then
y (x) =
Z x
0
yâ€² (t) dt.
Therefore, if dyn
dx â†’f âˆˆC ([0, 1]) and if yn â†’y in C ([0, 1]) it follows that
yn (x)
=
R x
0
dyn(t)
dx
dt
â†“
â†“
y (x)
=
R x
0 f (t) dt
and so by the fundamental theorem of calculus f (x) = yâ€² (x) and so the mapping
is closed. It is obviously not continuous because it takes y (x) and y (x)+ 1
n sin (nx)
to two functions which are far from each other even though these two functions are
very close in C ([0, 1]). Furthermore, it is not deï¬ned on the whole space, C ([0, 1]).
The next theorem, the closed graph theorem, gives conditions under which closed
implies continuous.
Theorem 13.17 Let X and Y be Banach spaces and suppose L : X â†’Y is closed
and linear. Then L is continuous.

346
BANACH SPACES
Proof: Let G be the graph of L. G = {(x, Lx) : x âˆˆX}. By Lemma 13.15
it follows that G is a Banach space. Deï¬ne P : G â†’X by P(x, Lx) = x. P maps
the Banach space G onto the Banach space X and is continuous and linear. By the
open mapping theorem, P maps open sets onto open sets. Since P is also one to
one, this says that P âˆ’1 is continuous. Thus ||P âˆ’1x|| â‰¤K||x||. Hence
||Lx|| â‰¤max (||x||, ||Lx||) â‰¤K||x||
By Theorem 13.4 on Page 339, this shows L is continuous and proves the theorem.
The following corollary is quite useful. It shows how to obtain a new norm on
the domain of a closed operator such that the domain with this new norm becomes
a Banach space.
Corollary 13.18 Let L : D âŠ†X â†’Y where X, Y are a Banach spaces, and L is
a closed operator. Then deï¬ne a new norm on D by
||x||D â‰¡||x||X + ||Lx||Y .
Then D with this new norm is a Banach space.
Proof: If {xn} is a Cauchy sequence in D with this new norm, it follows both
{xn} and {Lxn} are Cauchy sequences and therefore, they converge. Since L is
closed, xn â†’x and Lxn â†’Lx for some x âˆˆD. Thus ||xn âˆ’x||D â†’0.
13.2
Hahn Banach Theorem
The closed graph, open mapping, and uniform boundedness theorems are the three
major topological theorems in functional analysis. The other major theorem is the
Hahn-Banach theorem which has nothing to do with topology. Before presenting
this theorem, here are some preliminaries about partially ordered sets.
Deï¬nition 13.19 Let F
be a nonempty set. F is called a partially ordered set if
there is a relation, denoted here by â‰¤, such that
x â‰¤x for all x âˆˆF.
If x â‰¤y and y â‰¤z then x â‰¤z.
C âŠ†F is said to be a chain if every two elements of C are related. This means that
if x, y âˆˆC, then either x â‰¤y or y â‰¤x. Sometimes a chain is called a totally ordered
set. C is said to be a maximal chain if whenever D is a chain containing C, D = C.
The most common example of a partially ordered set is the power set of a given
set with âŠ†being the relation. It is also helpful to visualize partially ordered sets
as trees.
Two points on the tree are related if they are on the same branch of
the tree and one is higher than the other. Thus two points on diï¬€erent branches
would not be related although they might both be larger than some point on the

13.2.
HAHN BANACH THEOREM
347
trunk. You might think of many other things which are best considered as partially
ordered sets. Think of food for example. You might ï¬nd it diï¬ƒcult to determine
which of two favorite pies you like better although you may be able to say very
easily that you would prefer either pie to a dish of lard topped with whipped cream
and mustard. The following theorem is equivalent to the axiom of choice. For a
discussion of this, see the appendix on the subject.
Theorem 13.20 (Hausdorï¬€Maximal Principle) Let F
be a nonempty partially
ordered set. Then there exists a maximal chain.
Deï¬nition 13.21 Let X be a real vector space Ï : X â†’R is called a gauge function
if
Ï(x + y) â‰¤Ï(x) + Ï(y),
Ï(ax) = aÏ(x) if a â‰¥0.
(13.4)
Suppose M is a subspace of X and z /âˆˆM. Suppose also that f is a linear
real-valued function having the property that f(x) â‰¤Ï(x) for all x âˆˆM. Consider
the problem of extending f to M âŠ•Rz such that if F is the extended function,
F(y) â‰¤Ï(y) for all y âˆˆM âŠ•Rz and F is linear. Since F is to be linear, it suï¬ƒces
to determine how to deï¬ne F(z). Letting a > 0, it is required to deï¬ne F (z) such
that the following hold for all x, y âˆˆM.
f(x)
z }| {
F (x) + aF (z) = F(x + az) â‰¤Ï(x + az),
f(y)
z }| {
F (y) âˆ’aF (z) = F(y âˆ’az) â‰¤Ï(y âˆ’az).
(13.5)
Now if these inequalities hold for all y/a, they hold for all y because M is given to
be a subspace. Therefore, multiplying by aâˆ’1 13.4 implies that what is needed is
to choose F (z) such that for all x, y âˆˆM,
f(x) + F(z) â‰¤Ï(x + z), f(y) âˆ’Ï(y âˆ’z) â‰¤F(z)
and that if F (z) can be chosen in this way, this will satisfy 13.5 for all x, y and the
problem of extending f will be solved. Hence it is necessary to choose F(z) such
that for all x, y âˆˆM
f(y) âˆ’Ï(y âˆ’z) â‰¤F(z) â‰¤Ï(x + z) âˆ’f(x).
(13.6)
Is there any such number between f(y) âˆ’Ï(y âˆ’z) and Ï(x + z) âˆ’f(x) for every
pair x, y âˆˆM? This is where f(x) â‰¤Ï(x) on M and that f is linear is used.
For x, y âˆˆM,
Ï(x + z) âˆ’f(x) âˆ’[f(y) âˆ’Ï(y âˆ’z)]
= Ï(x + z) + Ï(y âˆ’z) âˆ’(f(x) + f(y))
â‰¥Ï(x + y) âˆ’f(x + y) â‰¥0.

348
BANACH SPACES
Therefore there exists a number between
sup {f(y) âˆ’Ï(y âˆ’z) : y âˆˆM}
and
inf {Ï(x + z) âˆ’f(x) : x âˆˆM}
Choose F(z) to satisfy 13.6. This has proved the following lemma.
Lemma 13.22 Let M be a subspace of X, a real linear space, and let Ï be a gauge
function on X. Suppose f : M â†’R is linear, z /âˆˆM, and f (x) â‰¤Ï (x) for all
x âˆˆM. Then f can be extended to M âŠ•Rz such that, if F is the extended function,
F is linear and F(x) â‰¤Ï(x) for all x âˆˆM âŠ•Rz.
With this lemma, the Hahn Banach theorem can be proved.
Theorem 13.23 (Hahn Banach theorem) Let X be a real vector space, let M be a
subspace of X, let f : M â†’R be linear, let Ï be a gauge function on X, and suppose
f(x) â‰¤Ï(x) for all x âˆˆM. Then there exists a linear function, F : X â†’R, such
that
a.) F(x) = f(x) for all x âˆˆM
b.) F(x) â‰¤Ï(x) for all x âˆˆX.
Proof: Let F = {(V, g) : V âŠ‡M, V is a subspace of X, g : V â†’R is linear,
g(x) = f(x) for all x âˆˆM, and g(x) â‰¤Ï(x) for x âˆˆV }. Then (M, f) âˆˆF so F Ì¸= âˆ….
Deï¬ne a partial order by the following rule.
(V, g) â‰¤(W, h)
means
V âŠ†W and h(x) = g(x) if x âˆˆV.
By Theorem 13.20, there exists a maximal chain, C âŠ†F. Let Y = âˆª{V : (V, g) âˆˆC}
and let h : Y â†’R be deï¬ned by h(x) = g(x) where x âˆˆV and (V, g) âˆˆC. This
is well deï¬ned because if x âˆˆV1 and V2 where (V1, g1) and (V2, g2) are both in the
chain, then since C is a chain, the two element related. Therefore, g1 (x) = g2 (x).
Also h is linear because if ax + by âˆˆY , then x âˆˆV1 and y âˆˆV2 where (V1, g1)
and (V2, g2) are elements of C. Therefore, letting V denote the larger of the two Vi,
and g be the function that goes with V , it follows ax + by âˆˆV where (V, g) âˆˆC.
Therefore,
h (ax + by)
=
g (ax + by)
=
ag (x) + bg (y)
=
ah (x) + bh (y) .
Also, h(x) = g (x) â‰¤Ï(x) for any x âˆˆY because for such x, x âˆˆV where (V, g) âˆˆC.
Is Y = X? If not, there exists z âˆˆX \ Y and there exists an extension of h to
Y âŠ•Rz using Lemma 13.22. Letting h denote this extended function, contradicts

13.2.
HAHN BANACH THEOREM
349
the maximality of C. Indeed, C âˆª{
Â¡
Y âŠ•Rz, h
Â¢
} would be a longer chain. This
proves the Hahn Banach theorem.
This is the original version of the theorem. There is also a version of this theorem
for complex vector spaces which is based on a trick.
Corollary 13.24 (Hahn Banach) Let M be a subspace of a complex normed linear
space, X, and suppose f : M â†’C is linear and satisï¬es |f(x)| â‰¤K||x|| for all
x âˆˆM.
Then there exists a linear function, F, deï¬ned on all of X such that
F(x) = f(x) for all x âˆˆM and |F(x)| â‰¤K||x|| for all x.
Proof: First note f(x) = Re f(x) + i Im f (x) and so
Re f(ix) + i Im f(ix) = f(ix) = if(x) = i Re f(x) âˆ’Im f(x).
Therefore, Im f(x) = âˆ’Re f(ix), and
f(x) = Re f(x) âˆ’i Re f(ix).
This is important because it shows it is only necessary to consider Re f in under-
standing f. Now it happens that Re f is linear with respect to real scalars so the
above version of the Hahn Banach theorem applies. This is shown next.
If c is a real scalar
Re f(cx) âˆ’i Re f(icx) = cf(x) = c Re f(x) âˆ’ic Re f(ix).
Thus Re f(cx) = c Re f(x). Also,
Re f(x + y) âˆ’i Re f(i (x + y))
=
f(x + y)
=
f (x) + f (y)
= Re f(x) âˆ’i Re f(ix) + Re f(y) âˆ’i Re f(iy).
Equating real parts, Re f(x + y) = Re f(x) + Re f(y). Thus Re f is linear with
respect to real scalars as hoped.
Consider X as a real vector space and let Ï(x) â‰¡K||x||. Then for all x âˆˆM,
| Re f(x)| â‰¤|f (x)| â‰¤K||x|| = Ï(x).
From Theorem 13.23, Re f may be extended to a function, h which satisï¬es
h(ax + by)
=
ah(x) + bh(y) if a, b âˆˆR
h(x)
â‰¤
K||x|| for all x âˆˆX.
Actually, |h (x)| â‰¤K ||x|| . The reason for this is that h (âˆ’x) = âˆ’h (x) â‰¤K ||âˆ’x|| =
K ||x|| and therefore, h (x) â‰¥âˆ’K ||x||. Let
F(x) â‰¡h(x) âˆ’ih(ix).

350
BANACH SPACES
By arguments similar to the above, F is linear.
F (ix)
=
h (ix) âˆ’ih (âˆ’x)
=
ih (x) + h (ix)
=
i (h (x) âˆ’ih (ix)) = iF (x) .
If c is a real scalar,
F (cx)
=
h(cx) âˆ’ih(icx)
=
ch (x) âˆ’cih (ix) = cF (x)
Now
F (x + y)
=
h(x + y) âˆ’ih(i (x + y))
=
h (x) + h (y) âˆ’ih (ix) âˆ’ih (iy)
=
F (x) + F (y) .
Thus
F ((a + ib) x)
=
F (ax) + F (ibx)
=
aF (x) + ibF (x)
=
(a + ib) F (x) .
This shows F is linear as claimed.
Now wF(x) = |F(x)| for some |w| = 1. Therefore
|F(x)|
=
wF(x) = h(wx) âˆ’
must equal zero
z }| {
ih(iwx)
= h(wx)
=
|h(wx)| â‰¤K||wx|| = K ||x|| .
This proves the corollary.
Deï¬nition 13.25 Let X be a Banach space. Denote by Xâ€² the space of continuous
linear functions which map X to the ï¬eld of scalars.
Thus Xâ€² = L(X, F). By
Theorem 13.7 on Page 340, Xâ€² is a Banach space. Remember with the norm deï¬ned
on L (X, F),
||f|| = sup{|f(x)| : ||x|| â‰¤1}
Xâ€² is called the dual space.
Deï¬nition 13.26 Let X and Y be Banach spaces and suppose L âˆˆL(X, Y ). Then
deï¬ne the adjoint map in L(Y â€², Xâ€²), denoted by Lâˆ—, by
Lâˆ—yâˆ—(x) â‰¡yâˆ—(Lx)
for all yâˆ—âˆˆY â€².

13.2.
HAHN BANACH THEOREM
351
The following diagram is a good one to help remember this deï¬nition.
Xâ€²
Lâˆ—
â†
Y â€²
X
â†’
L
Y
This is a generalization of the adjoint of a linear transformation on an inner
product space. Recall
(Ax, y) = (x, Aâˆ—y)
What is being done here is to generalize this algebraic concept to arbitrary Banach
spaces.
There are some issues which need to be discussed relative to the above
deï¬nition. First of all, it must be shown that Lâˆ—yâˆ—âˆˆXâ€². Also, it will be useful to
have the following lemma which is a useful application of the Hahn Banach theorem.
Lemma 13.27 Let X be a normed linear space and let x âˆˆX. Then there exists
xâˆ—âˆˆXâ€² such that ||xâˆ—|| = 1 and xâˆ—(x) = ||x||.
Proof: Let f : Fx â†’F be deï¬ned by f(Î±x) = Î±||x||. Then for y = Î±x âˆˆFx,
|f (y)| = |f (Î±x)| = |Î±| ||x|| = |y| .
By the Hahn Banach theorem, there exists xâˆ—âˆˆXâ€² such that xâˆ—(Î±x) = f(Î±x) and
||xâˆ—|| â‰¤1. Since xâˆ—(x) = ||x|| it follows that ||xâˆ—|| = 1 because
||xâˆ—|| â‰¥
Â¯Â¯Â¯Â¯xâˆ—
Âµ x
||x||
Â¶Â¯Â¯Â¯Â¯ = ||x||
||x|| = 1.
This proves the lemma.
Theorem 13.28 Let L âˆˆL(X, Y ) where X and Y are Banach spaces. Then
a.) Lâˆ—âˆˆL(Y â€², Xâ€²) as claimed and ||Lâˆ—|| = ||L||.
b.) If L maps one to one onto a closed subspace of Y , then Lâˆ—is onto.
c.) If L maps onto a dense subset of Y , then Lâˆ—is one to one.
Proof: It is routine to verify Lâˆ—yâˆ—and Lâˆ—are both linear. This follows imme-
diately from the deï¬nition. As usual, the interesting thing concerns continuity.
||Lâˆ—yâˆ—|| = sup
||x||â‰¤1
|Lâˆ—yâˆ—(x)| = sup
||x||â‰¤1
|yâˆ—(Lx)| â‰¤||yâˆ—|| ||L|| .
Thus Lâˆ—is continuous as claimed and ||Lâˆ—|| â‰¤||L|| .
By Lemma 13.27, there exists yâˆ—
x âˆˆY â€² such that ||yâˆ—
x|| = 1 and yâˆ—
x (Lx) =
||Lx|| .Therefore,
||Lâˆ—||
=
sup
||yâˆ—||â‰¤1
||Lâˆ—yâˆ—|| =
sup
||yâˆ—||â‰¤1
sup
||x||â‰¤1
|Lâˆ—yâˆ—(x)|
=
sup
||yâˆ—||â‰¤1
sup
||x||â‰¤1
|yâˆ—(Lx)| = sup
||x||â‰¤1
sup
||yâˆ—||â‰¤1
|yâˆ—(Lx)|
â‰¥
sup
||x||â‰¤1
|yâˆ—
x (Lx)| = sup
||x||â‰¤1
||Lx|| = ||L||

352
BANACH SPACES
showing that ||Lâˆ—|| â‰¥||L|| and this shows part a.).
If L is one to one and onto a closed subset of Y , then L (X) being a closed
subspace of a Banach space, is itself a Banach space and so the open mapping
theorem implies Lâˆ’1 : L(X) â†’X is continuous. Hence
||x|| = ||Lâˆ’1Lx|| â‰¤
Â¯Â¯Â¯Â¯Lâˆ’1Â¯Â¯Â¯Â¯ ||Lx||
Now let xâˆ—âˆˆXâ€² be given. Deï¬ne f âˆˆL(L(X), C) by f(Lx) = xâˆ—(x). The function,
f is well deï¬ned because if Lx1 = Lx2, then since L is one to one, it follows x1 = x2
and so f (L (x1)) = xâˆ—(x1) = xâˆ—(x2) = f (L (x1)). Also, f is linear because
f (aL (x1) + bL (x2))
=
f (L (ax1 + bx2))
â‰¡
xâˆ—(ax1 + bx2)
=
axâˆ—(x1) + bxâˆ—(x2)
=
af (L (x1)) + bf (L (x2)) .
In addition to this,
|f(Lx)| = |xâˆ—(x)| â‰¤||xâˆ—|| ||x|| â‰¤||xâˆ—||
Â¯Â¯Â¯Â¯Lâˆ’1Â¯Â¯Â¯Â¯ ||Lx||
and so the norm of f on L (X) is no larger than ||xâˆ—||
Â¯Â¯Â¯Â¯Lâˆ’1Â¯Â¯Â¯Â¯. By the Hahn Banach
theorem, there exists an extension of f to an element yâˆ—âˆˆY â€² such that ||yâˆ—|| â‰¤
||xâˆ—||
Â¯Â¯Â¯Â¯Lâˆ’1Â¯Â¯Â¯Â¯. Then
Lâˆ—yâˆ—(x) = yâˆ—(Lx) = f(Lx) = xâˆ—(x)
so Lâˆ—yâˆ—= xâˆ—because this holds for all x. Since xâˆ—was arbitrary, this shows Lâˆ—is
onto and proves b.).
Consider the last assertion. Suppose Lâˆ—yâˆ—= 0. Is yâˆ—= 0? In other words
is yâˆ—(y) = 0 for all y âˆˆY ? Pick y âˆˆY . Since L (X) is dense in Y, there exists
a sequence, {Lxn} such that Lxn â†’y. But then by continuity of yâˆ—, yâˆ—(y) =
limnâ†’âˆžyâˆ—(Lxn) = limnâ†’âˆžLâˆ—yâˆ—(xn) = 0. Since yâˆ—(y) = 0 for all y, this implies
yâˆ—= 0 and so Lâˆ—is one to one.
Corollary 13.29 Suppose X and Y are Banach spaces, L âˆˆL(X, Y ), and L is one
to one and onto. Then Lâˆ—is also one to one and onto.
There exists a natural mapping, called the James map from a normed linear
space, X, to the dual of the dual space which is described in the following deï¬nition.
Deï¬nition 13.30 Deï¬ne J : X â†’Xâ€²â€² by J(x)(xâˆ—) = xâˆ—(x).
Theorem 13.31 The map, J, has the following properties.
a.) J is one to one and linear.
b.) ||Jx|| = ||x|| and ||J|| = 1.
c.) J(X) is a closed subspace of Xâ€²â€² if X is complete.
Also if xâˆ—âˆˆXâ€²,
||xâˆ—|| = sup {|xâˆ—âˆ—(xâˆ—)| : ||xâˆ—âˆ—|| â‰¤1, xâˆ—âˆ—âˆˆXâ€²â€²} .

13.2.
HAHN BANACH THEOREM
353
Proof:
J (ax + by) (xâˆ—)
â‰¡
xâˆ—(ax + by)
=
axâˆ—(x) + bxâˆ—(y)
=
(aJ (x) + bJ (y)) (xâˆ—) .
Since this holds for all xâˆ—âˆˆXâ€², it follows that
J (ax + by) = aJ (x) + bJ (y)
and so J is linear.
If Jx = 0, then by Lemma 13.27 there exists xâˆ—such that
xâˆ—(x) = ||x|| and ||xâˆ—|| = 1. Then
0 = J(x)(xâˆ—) = xâˆ—(x) = ||x||.
This shows a.).
To show b.), let x âˆˆX and use Lemma 13.27 to obtain xâˆ—âˆˆXâ€² such that
xâˆ—(x) = ||x|| with ||xâˆ—|| = 1. Then
||x||
â‰¥
sup{|yâˆ—(x)| : ||yâˆ—|| â‰¤1}
=
sup{|J(x)(yâˆ—)| : ||yâˆ—|| â‰¤1} = ||Jx||
â‰¥
|J(x)(xâˆ—)| = |xâˆ—(x)| = ||x||
Therefore, ||Jx|| = ||x|| as claimed. Therefore,
||J|| = sup{||Jx|| : ||x|| â‰¤1} = sup{||x|| : ||x|| â‰¤1} = 1.
This shows b.).
To verify c.), use b.). If Jxn â†’yâˆ—âˆ—âˆˆXâ€²â€² then by b.), xn is a Cauchy sequence
converging to some x âˆˆX because
||xn âˆ’xm|| = ||Jxn âˆ’Jxm||
and {Jxn} is a Cauchy sequence. Then Jx = limnâ†’âˆžJxn = yâˆ—âˆ—.
Finally, to show the assertion about the norm of xâˆ—, use what was just shown
applied to the James map from Xâ€² to Xâ€²â€²â€² still referred to as J.
||xâˆ—|| = sup {|xâˆ—(x)| : ||x|| â‰¤1} = sup {|J (x) (xâˆ—)| : ||Jx|| â‰¤1}
â‰¤sup {|xâˆ—âˆ—(xâˆ—)| : ||xâˆ—âˆ—|| â‰¤1} = sup {|J (xâˆ—) (xâˆ—âˆ—)| : ||xâˆ—âˆ—|| â‰¤1}
â‰¡||Jxâˆ—|| = ||xâˆ—||.
This proves the theorem.
Deï¬nition 13.32 When J maps X onto Xâ€²â€², X is called reï¬‚exive.
It happens the Lp spaces are reï¬‚exive whenever p > 1. This is shown later.

354
BANACH SPACES
13.3
Weak And Weak âˆ—Topologies
13.3.1
Basic Deï¬nitions
Let X be a Banach space and let Xâ€² be its dual space.1 For Aâ€² a ï¬nite subset of
Xâ€², denote by ÏAâ€² the function deï¬ned on X
ÏAâ€² (x) â‰¡max
xâˆ—âˆˆAâ€² |xâˆ—(x)|
(13.7)
and also let BAâ€² (x, r) be deï¬ned by
BAâ€² (x, r) â‰¡{y âˆˆX : ÏAâ€² (y âˆ’x) < r}
(13.8)
Then certain things are obvious. First of all, if a âˆˆF and x, y âˆˆX,
ÏAâ€² (x + y)
â‰¤
ÏAâ€² (x) + ÏAâ€² (y) ,
ÏAâ€² (ax)
=
|a| ÏAâ€² (x) .
Similarly, letting A be a ï¬nite subset of X, denote by ÏA the function deï¬ned
on Xâ€²
ÏA (xâˆ—) â‰¡max
xâˆˆA |xâˆ—(x)|
(13.9)
and let BA (xâˆ—, r) be deï¬ned by
BA (xâˆ—, r) â‰¡{yâˆ—âˆˆXâ€² : ÏA (yâˆ—âˆ’xâˆ—) < r} .
(13.10)
It is also clear that
ÏA (xâˆ—+ yâˆ—)
â‰¤
Ï (xâˆ—) + ÏA (yâˆ—) ,
ÏA (axâˆ—)
=
|a| ÏA (xâˆ—) .
Lemma 13.33 The sets, BAâ€² (x, r) where Aâ€² is a ï¬nite subset of Xâ€² and x âˆˆX
form a basis for a topology on X known as the weak topology. The sets BA (xâˆ—, r)
where A is a ï¬nite subset of X and xâˆ—âˆˆXâ€² form a basis for a topology on Xâ€²
known as the weak âˆ—topology.
Proof: The two assertions are very similar. I will verify the one for the weak
topology. The union of these sets, BAâ€² (x, r) for x âˆˆX and r > 0 is all of X. Now
suppose z is contained in the intersection of two of these sets. Say
z âˆˆBAâ€² (x, r) âˆ©BAâ€²
1 (x1, r1)
Then let Câ€² = Aâ€² âˆªAâ€²
1 and let
0 < Î´ â‰¤min
Â³
r âˆ’ÏAâ€² (z âˆ’x) , r1 âˆ’ÏAâ€²
1 (z âˆ’x1)
Â´
.
1Actually, all this works in much more general settings than this.

13.3.
WEAK AND WEAK âˆ—TOPOLOGIES
355
Consider y âˆˆBCâ€² (z, Î´) . Then
r âˆ’ÏAâ€² (z âˆ’x) â‰¥Î´ > ÏCâ€² (y âˆ’z) â‰¥ÏAâ€² (y âˆ’z)
and so
r > ÏAâ€² (y âˆ’z) + ÏAâ€² (z âˆ’x) â‰¥ÏAâ€² (y âˆ’x)
which shows y âˆˆBAâ€² (x, r) . Similar reasoning shows y âˆˆBAâ€²
1 (x1, r1) and so
BCâ€² (z, Î´) âŠ†BAâ€² (x, r) âˆ©BAâ€²
1 (x1, r1) .
Therefore, the weak topology consists of the union of all sets of the form BA (x, r).
13.3.2
Banach Alaoglu Theorem
Why does anyone care about these topologies? The short answer is that in the
weak âˆ—topology, closed unit ball in Xâ€² is compact. This is not true in the normal
topology. This wonderful result is the Banach Alaoglu theorem. First recall the
notion of the product topology, and the Tychonoï¬€theorem, Theorem 11.7 on Page
307 which are stated here for convenience.
Deï¬nition 13.34 Let I be a set and suppose for each i âˆˆI, (Xi, Ï„ i) is a nonempty
topological space. The Cartesian product of the Xi, denoted by Q
iâˆˆI Xi, consists
of the set of all choice functions deï¬ned on I which select a single element of each
Xi. Thus f âˆˆQ
iâˆˆI Xi means for every i âˆˆI, f (i) âˆˆXi. The axiom of choice says
Q
iâˆˆI Xi is nonempty. Let
Pj (A) =
Y
iâˆˆI
Bi
where Bi = Xi if i Ì¸= j and Bj = A. A subbasis for a topology on the product
space consists of all sets Pj (A) where A âˆˆÏ„ j. (These sets have an open set from
the topology of Xj in the jth slot and the whole space in the other slots.) Thus a
basis consists of ï¬nite intersections of these sets. Note that the intersection of two
of these basic sets is another basic set and their union yields Q
iâˆˆI Xi. Therefore,
they satisfy the condition needed for a collection of sets to serve as a basis for a
topology. This topology is called the product topology and is denoted by Q Ï„ i.
Theorem 13.35 If (Xi, Ï„ i) is compact, then so is (Q
iâˆˆI Xi, Q Ï„ i).
The Banach Alaoglu theorem is as follows.
Theorem 13.36 Let Bâ€² be the closed unit ball in Xâ€². Then Bâ€² is compact in the
weak âˆ—topology.
Proof: By the Tychonoï¬€theorem, Theorem 13.35
P â‰¡
Y
xâˆˆX
B (0, ||x||)

356
BANACH SPACES
is compact in the product topology where the topology on B (0, ||x||) is the usual
topology of F. Recall P is the set of functions which map a point, x âˆˆX to a point
in B (0, ||x||). Therefore, Bâ€² âŠ†P. Also the basic open sets in the weak âˆ—topology
on Bâ€² are obtained as the intersection of basic open sets in the product topology
of P to Bâ€² and so it suï¬ƒces to show Bâ€² is a closed subset of P. Suppose then that
f âˆˆP \ Bâ€². It follows f cannot be linear. There are two ways this can happen. One
way is that for some x, y
f (x + y) Ì¸= f (x) + f (y)
for some x, y âˆˆX. However, if g is close enough to f at the three points, x + y, x,
and y, the above inequality will hold for g in place of f. In other words there is a
basic open set containing f such that for all g in this basic open set, g /âˆˆBâ€². A
similar consideration applies in case f (Î»x) Ì¸= Î»f (x) for some scalar, Î» and x. Since
P \ Bâ€² is open, it follows Bâ€² is a closed subset of P and is therefore, compact. This
proves the theorem.
Sometimes one can consider the weak âˆ—topology in terms of a metric space.
Theorem 13.37 If K âŠ†Xâ€² is compact in the weak âˆ—topology and X is separable
then there exists a metric, d, on K such that if Ï„ d is the topology on K induced by
d and if Ï„ is the topology on K induced by the weak âˆ—topology of Xâ€², then Ï„ = Ï„ d.
Thus one can consider K with the weak âˆ—topology as a metric space.
Proof: Let D = {xn} be the dense countable subset. The metric is
d (f, g) â‰¡
âˆž
X
n=1
2âˆ’n
Ïxn (f âˆ’g)
1 + Ïxn (f âˆ’g)
where Ïxn (f) = |f (xn)|. Clearly d (f, g) = d (g, f) â‰¥0. If d (f, g) = 0, then this
requires f (xn) = g (xn) for all xn âˆˆD. Since f and g are continuous and D is
dense, this requires that f (x) = g (x) for all x. It is routine to verify the triangle
inequality from the easy to establish inequality,
x
1 + x +
y
1 + y â‰¥
x + y
1 + x + y ,
valid whenever x, y â‰¥0. Therefore this is a metric. Now for each n
g â†’
Ïxn (f âˆ’g)
1 + Ïxn (f âˆ’g)
is a continuous function from (K, Ï„) to [0, âˆž) and also the above sum deï¬ning d
converges uniformly. It follows
g â†’d (f, g)
is continuous. Therefore, the ball with respect to d,
Bd (f, r) â‰¡{g âˆˆK : d (g, f) < r}

13.3.
WEAK AND WEAK âˆ—TOPOLOGIES
357
is open in Ï„ which implies Ï„ d âŠ†Ï„.
Now suppose U âˆˆÏ„. Then K \ U is closed in K. Hence, K \ U is compact in Ï„
because it is a closed subset of the compact set K. It follows that K \ U is compact
with respect to Ï„ d because Ï„ d âŠ†Ï„. But (K, Ï„ d) is a Hausdorï¬€space and so K \ U
must be closed with respect to Ï„ d. This implies U âˆˆÏ„ d. Thus Ï„ âŠ†Ï„ d and this
proves Ï„ = Ï„ d. This proves the theorem.
The fact that this set with the weak âˆ—
topology can be considered a metric
space is very signiï¬cant because if a point is a limit point in a metric space, one
can extract a convergent sequence.
Corollary 13.38 If X is separable and K âŠ†Xâ€² is compact in the weak âˆ—topology,
then K is sequentially compact.
That is, if {fn}âˆž
n=1 âŠ†K, then there exists a
subsequence fnk and f âˆˆK such that for all x âˆˆX,
lim
kâ†’âˆžfnk (x) = f (x).
Proof: By Theorem 13.37, K is a metric space for the metric described there
and it is compact.
Therefore by the characterization of compact metric spaces,
Proposition 6.12 on Page 136, K is sequentially compact. This proves the corollary.
13.3.3
Eberlein Smulian Theorem
Next consider the weak topology. The most interesting results have to do with a
reï¬‚exive Banach space. The following lemma ties together the weak and weak âˆ—
topologies in the case of a reï¬‚exive Banach space.
Lemma 13.39 Let J : X â†’Xâ€²â€² be the James map
Jx (f) â‰¡f (x)
and let X be reï¬‚exive so that J is onto. Then J is a homeomorphism of (X, weak topology)
and (Xâ€²â€², weak âˆ—topology).This means J is one to one, onto, and both J and Jâˆ’1
are continuous.
Proof: Let f âˆˆXâ€² and let
Bf (x, r) â‰¡{y : |f (x) âˆ’f (y)| < r}.
Thus Bf (x, r) is a subbasic set for the weak topology on X. Now by the deï¬nition
of J,
y âˆˆBf (x, r) if and only if |Jy (f) âˆ’Jx (f)| < r
if and only if Jy âˆˆBf (Jx, r) â‰¡
{yâˆ—âˆ—âˆˆXâ€²â€² : |yâˆ—âˆ—(f) âˆ’J (x) (f)| < r},
a subbasic set for the weak âˆ—topology on Xâ€²â€². Since Jâˆ’1 and J are one to one and
onto and map subbasic sets to subbasic sets, it follows that J is a homeomorphism.
This proves the Lemma.
The following is an easy corollary.

358
BANACH SPACES
Corollary 13.40 If X is a reï¬‚exive Banach space, then the closed unit ball is
weakly compact.
Proof: Let B be the closed unit ball. Then B = Jâˆ’1 (Bâˆ—âˆ—) where Bâˆ—âˆ—is the
unit ball in Xâ€²â€² which is compact in the weak âˆ—topology. Therefore B is weakly
compact because Jâˆ’1 is continuous.
Corollary 13.41 Let X be a reï¬‚exive Banach space. If K âŠ†X is compact in the
weak topology and Xâ€² is separable then there exists a metric d, on K such that if
Ï„ d is the topology on K induced by d and if Ï„ is the topology on K induced by the
weak topology of X, then Ï„ = Ï„ d. Thus one can consider K with the weak topology
as a metric space.
Proof:
This follows from Theorem 13.37 and Lemma 13.39.
Lemma 13.39
implies J (K) is compact in Xâ€²â€². Then since Xâ€² is separable, there is a metric, dâ€²â€²
on J (K) which delivers the weak âˆ—topology. Let d (x, y) â‰¡dâ€²â€² (Jx, Jy) . Then
(K, Ï„ d)
Jâ†’(J (K) , Ï„ dâ€²â€²)
id
â†’(J (K) , Ï„ weak âˆ—)
Jâˆ’1
â†’(K, Ï„ weak)
and all the maps are homeomorphisms.
Next is the Eberlein Smulian theorem which states that a Banach space is re-
ï¬‚exive if and only if the closed unit ball is weakly sequentially compact. Actually,
only half the theorem is proved here, the more useful only if part. The book by
Yoshida [52] has the complete theorem discussed. First here is an interesting lemma
for its own sake.
Lemma 13.42 A closed subspace of a reï¬‚exive Banach space is reï¬‚exive.
Proof: Let Y be the closed subspace of the reï¬‚exive space, X. Consider the
following diagram
Y â€²â€²
iâˆ—âˆ—1-1
â†’
Xâ€²â€²
Y â€²
iâˆ—onto
â†
Xâ€²
Y
iâ†’
X
This diagram follows from Theorem 13.28 on Page 351, the theorem on adjoints.
Now let yâˆ—âˆ—âˆˆY â€²â€². Then iâˆ—âˆ—yâˆ—âˆ—= JX (y) because X is reï¬‚exive. I want to show
that y âˆˆY . If it is not in Y then since Y is closed, there exists xâˆ—âˆˆXâ€² such that
xâˆ—(y) Ì¸= 0 but xâˆ—(Y ) = 0. Then iâˆ—xâˆ—= 0. Hence
0 = yâˆ—âˆ—(iâˆ—xâˆ—) = iâˆ—âˆ—yâˆ—âˆ—(xâˆ—) = J (y) (xâˆ—) = xâˆ—(y) Ì¸= 0,
a contradiction. Hence y âˆˆY . Letting JY denote the James map from Y to Y â€²â€²
and xâˆ—âˆˆXâ€²,
yâˆ—âˆ—(iâˆ—xâˆ—)
=
iâˆ—âˆ—yâˆ—âˆ—(xâˆ—) = JX (y) (xâˆ—)
=
xâˆ—(y) = xâˆ—(iy) = iâˆ—xâˆ—(y) = JY (y) (iâˆ—xâˆ—)
Since iâˆ—is onto, this shows yâˆ—âˆ—= JY (y) and this proves the lemma.

13.3.
WEAK AND WEAK âˆ—TOPOLOGIES
359
Theorem 13.43 (Eberlein Smulian) The closed unit ball in a reï¬‚exive Banach
space X, is weakly sequentially compact.
By this is meant that if {xn} is con-
tained in the closed unit ball, there exists a subsequence, {xnk} and x âˆˆX such that
for all xâˆ—âˆˆXâ€²,
xâˆ—(xnk) â†’xâˆ—(x) .
Proof: Let {xn} âŠ†B â‰¡B (0, 1). Let Y be the closure of the linear span of
{xn}. Thus Y is a separable. It is reï¬‚exive because it is a closed subspace of a
reï¬‚exive space so the above lemma applies. By the Banach Alaoglu theorem, the
closed unit ball Bâˆ—in Y â€² is weak âˆ—compact. Also by Theorem 13.37, Bâˆ—is a metric
space with a suitable metric. Thus Bâˆ—is complete and totally bounded with respect
to this metric and it follows that Bâˆ—with the weak âˆ—topology is separable. This
implies Y â€² is also separable in the weak âˆ—topology. To see this, let {yâˆ—
n} â‰¡D be a
weak âˆ—dense set in Bâˆ—and let yâˆ—âˆˆY â€². Let p be a large enough positive rational
number that yâˆ—/p âˆˆBâˆ—. Then if A is any ï¬nite set from Y, there exists yâˆ—
n âˆˆD such
that ÏA (yâˆ—/p âˆ’yâˆ—
n) < Îµ
p. It follows pyâˆ—
n âˆˆBA (yâˆ—, Îµ) showing that rational multiples
of D are weak âˆ—dense in Y â€². Since Y is reï¬‚exive, the weak and weak âˆ—topologies on
Y â€² coincide and so Y â€² is weakly separable. Since Y â€² is separable, Corollary 13.38
implies Bâˆ—âˆ—, the closed unit ball in Y â€²â€² is weak âˆ—sequentially compact. Then by
Lemma 13.39 B, the unit ball in Y , is weakly sequentially compact. It follows there
exists a subsequence xnk, of the sequence {xn} and a point x âˆˆY , such that for all
f âˆˆY â€²,
f (xnk) â†’f (x).
Now if xâˆ—âˆˆXâ€², and i is the inclusion map of Y into X,
xâˆ—(xnk) = iâˆ—xâˆ—(xnk) â†’iâˆ—xâˆ—(x) = xâˆ—(x).
which shows xnk converges weakly and this shows the unit ball in X is weakly
sequentially compact.
Corollary 13.44 Let {xn} be any bounded sequence in a reï¬‚exive Banach space,
X. Then there exists x âˆˆX and a subsequence, {xnk} such that for all xâˆ—âˆˆXâ€²,
lim
kâ†’âˆžxâˆ—(xnk) = xâˆ—(x)
Proof:
If a subsequence, xnk has ||xnk|| â†’0, then the conclusion follows.
Simply let x = 0. Suppose then that ||xn|| is bounded away from 0.
That is,
||xn|| âˆˆ[Î´, C]. Take a subsequence such that ||xnk|| â†’a. Then consider xnk/ ||xnk||.
By the Eberlein Smulian theorem, this subsequence has a further subsequence,
xnkj /
Â¯Â¯Â¯
Â¯Â¯Â¯xnkj
Â¯Â¯Â¯
Â¯Â¯Â¯ which converges weakly to x âˆˆB where B is the closed unit ball.
It follows from routine considerations that xnkj â†’ax weakly.
This proves the
corollary.

360
BANACH SPACES
13.4
Exercises
1. Is N a GÎ´ set? What about Q? What about a countable dense subset of a
complete metric space?
2. â†‘Let f : R â†’C be a function. Deï¬ne the oscillation of a function in B (x, r)
by Ï‰rf(x) = sup{|f(z) âˆ’f(y)| : y, z âˆˆB(x, r)}. Deï¬ne the oscillation of the
function at the point, x by Ï‰f(x) = limrâ†’0 Ï‰rf(x). Show f is continuous
at x if and only if Ï‰f(x) = 0.
Then show the set of points where f is
continuous is a GÎ´ set (try Un = {x : Ï‰f(x) <
1
n}).
Does there exist a
function continuous at only the rational numbers? Does there exist a function
continuous at every irrational and discontinuous elsewhere? Hint: Suppose
D is any countable set, D = {di}âˆž
i=1, and deï¬ne the function, fn (x) to equal
zero for every x /âˆˆ{d1, Â· Â· Â·, dn} and 2âˆ’n for x in this ï¬nite set. Then consider
g (x) â‰¡Pâˆž
n=1 fn (x). Show that this series converges uniformly.
3. Let f âˆˆC([0, 1]) and suppose f â€²(x) exists. Show there exists a constant, K,
such that |f(x) âˆ’f(y)| â‰¤K|x âˆ’y| for all y âˆˆ[0, 1]. Let Un = {f âˆˆC([0, 1])
such that for each x âˆˆ[0, 1] there exists y âˆˆ[0, 1] such that |f(x) âˆ’f(y)| >
n|xâˆ’y|}. Show that Un is open and dense in C([0, 1]) where for f âˆˆC ([0, 1]),
||f|| â‰¡sup {|f (x)| : x âˆˆ[0, 1]} .
Show that âˆ©nUn is a dense GÎ´ set of nowhere diï¬€erentiable continuous func-
tions.
Thus every continuous function is uniformly close to one which is
nowhere diï¬€erentiable.
4. â†‘Suppose f (x) = Pâˆž
k=1 uk (x) where the convergence is uniform and each uk
is a polynomial. Is it reasonable to conclude that f â€² (x) = Pâˆž
k=1 uâ€²
k (x)? The
answer is no. Use Problem 3 and the Weierstrass approximation theorem do
show this.
5. Let X be a normed linear space. We say A âŠ†X is â€œweakly boundedâ€ if for
each xâˆ—âˆˆXâ€², sup{|xâˆ—(x)| : x âˆˆA} < âˆž, while A is bounded if sup{||x|| : x âˆˆ
A} < âˆž. Show A is weakly bounded if and only if it is bounded.
6. Let X and Y be two Banach spaces. Deï¬ne the norm
|||(x, y)||| â‰¡||x||X + ||y||Y .
Show this is a norm on X Ã— Y which is equivalent to the norm given in the
chapter for X Ã— Y . Can you do the same for the norm deï¬ned for p > 1 by
|(x, y)| â‰¡(||x||p
X + ||y||p
Y )1/p?
7. Let f be a 2Ï€ periodic locally integrable function on R. The Fourier series for
f is given by
âˆž
X
k=âˆ’âˆž
akeikx â‰¡lim
nâ†’âˆž
n
X
k=âˆ’n
akeikx â‰¡lim
nâ†’âˆžSnf (x)

13.4.
EXERCISES
361
where
ak = 1
2Ï€
Z Ï€
âˆ’Ï€
eâˆ’ikxf (x) dx.
Show
Snf (x) =
Z Ï€
âˆ’Ï€
Dn (x âˆ’y) f (y) dy
where
Dn(t) = sin((n + 1
2)t)
2Ï€ sin( t
2)
.
Verify that
R Ï€
âˆ’Ï€ Dn (t) dt = 1. Also show that if g âˆˆL1 (R) , then
lim
aâ†’âˆž
Z
R
g (x) sin (ax) dx = 0.
This last is called the Riemann Lebesgue lemma. Hint: For the last part,
assume ï¬rst that g âˆˆCâˆž
c (R) and integrate by parts. Then exploit density of
the set of functions in L1 (R).
8. â†‘It turns out that the Fourier series sometimes converges to the function point-
wise. Suppose f is 2Ï€ periodic and Holder continuous. That is |f (x) âˆ’f (y)| â‰¤
K |x âˆ’y|Î¸ where Î¸ âˆˆ(0, 1]. Show that if f is like this, then the Fourier series
converges to f at every point. Next modify your argument to show that if
at every point, x, |f (x+) âˆ’f (y)| â‰¤K |x âˆ’y|Î¸ for y close enough to x and
larger than x and |f (xâˆ’) âˆ’f (y)| â‰¤K |x âˆ’y|Î¸ for every y close enough to x
and smaller than x, then Snf (x) â†’f(x+)+f(xâˆ’)
2
, the midpoint of the jump
of the function. Hint: Use Problem 7.
9. â†‘Let Y = {f such that f is continuous, deï¬ned on R, and 2Ï€ periodic}. Deï¬ne
||f||Y = sup{|f(x)| : x âˆˆ[âˆ’Ï€, Ï€]}. Show that (Y, || ||Y ) is a Banach space. Let
x âˆˆR and deï¬ne Ln(f) = Snf(x). Show Ln âˆˆY â€² but limnâ†’âˆž||Ln|| = âˆž.
Show that for each x âˆˆR, there exists a dense GÎ´ subset of Y such that for f
in this set, |Snf(x)| is unbounded. Finally, show there is a dense GÎ´ subset of
Y having the property that |Snf(x)| is unbounded on the rational numbers.
Hint: To do the ï¬rst part, let f(y) approximate sgn(Dn(xâˆ’y)). Here sgn r =
1 if r > 0, âˆ’1 if r < 0 and 0 if r = 0. This rules out one possibility of the
uniform boundedness principle. After this, show the countable intersection of
dense GÎ´ sets must also be a dense GÎ´ set.
10. Let Î± âˆˆ(0, 1]. Deï¬ne, for X a compact subset of Rp,
CÎ± (X; Rn) â‰¡{f âˆˆC (X; Rn) : ÏÎ± (f) + ||f|| â‰¡||f||Î± < âˆž}
where
||f|| â‰¡sup{|f (x)| : x âˆˆX}

362
BANACH SPACES
and
ÏÎ± (f) â‰¡sup{|f (x) âˆ’f (y)|
|x âˆ’y|Î±
: x, y âˆˆX, x Ì¸= y}.
Show that (CÎ± (X; Rn) , ||Â·||Î±) is a complete normed linear space.
This is
called a Holder space. What would this space consist of if Î± > 1?
11. â†‘Now recall Problem 10 about the Holder spaces.
Let X be the Holder
functions which are periodic of period 2Ï€. Deï¬ne Lnf (x) = Snf (x) where
Ln : X â†’Y for Y given in Problem 9. Show ||Ln|| is bounded independent
of n. Conclude that Lnf â†’f in Y for all f âˆˆX. In other words, for the
Holder continuous and 2Ï€ periodic functions, the Fourier series converges to
the function uniformly. Hint: Lnf (x) is given by
Lnf (x) =
Z Ï€
âˆ’Ï€
Dn (y) f (x âˆ’y) dy
where f (x âˆ’y) = f (x) + g (x, y) where |g (x, y)| â‰¤C |y|Î±. Use the fact the
Dirichlet kernel integrates to one to write
Â¯Â¯Â¯Â¯
Z Ï€
âˆ’Ï€
Dn (y) f (x âˆ’y) dy
Â¯Â¯Â¯Â¯ â‰¤
=|f(x)|
z
}|
{
Â¯Â¯Â¯Â¯
Z Ï€
âˆ’Ï€
Dn (y) f (x) dy
Â¯Â¯Â¯Â¯
+C
Â¯Â¯Â¯Â¯
Z Ï€
âˆ’Ï€
sin
ÂµÂµ
n + 1
2
Â¶
y
Â¶
(g (x, y) / sin (y/2)) dy
Â¯Â¯Â¯Â¯
Show the functions, y â†’g (x, y) / sin (y/2) are bounded in L1 independent of
x and get a uniform bound on ||Ln||. Now use a similar argument to show
{Lnf} is equicontinuous in addition to being uniformly bounded.
If Lnf
fails to converge to f uniformly, then there exists Îµ > 0 and a subsequence,
nk such that ||Lnkf âˆ’f||âˆžâ‰¥Îµ where this is the norm in Y or equivalently
the sup norm on [âˆ’Ï€, Ï€]. By the Arzela Ascoli theorem, there is a further
subsequence, Lnkl f which converges uniformly on [âˆ’Ï€, Ï€]. But by Problem 8
Lnf (x) â†’f (x).
12. Let X be a normed linear space and let M be a convex open set containing
0. Deï¬ne
Ï(x) = inf{t > 0 : x
t âˆˆM}.
Show Ï is a gauge function deï¬ned on X. This particular example is called a
Minkowski functional. It is of fundamental importance in the study of locally
convex topological vector spaces. A set, M, is convex if Î»x + (1 âˆ’Î»)y âˆˆM
whenever Î» âˆˆ[0, 1] and x, y âˆˆM.
13. â†‘The Hahn Banach theorem can be used to establish separation theorems. Let
M be an open convex set containing 0. Let x /âˆˆM. Show there exists xâˆ—âˆˆXâ€²
such that Re xâˆ—(x) â‰¥1 > Re xâˆ—(y) for all y âˆˆM. Hint: If y âˆˆM, Ï(y) < 1.

13.4.
EXERCISES
363
Show this. If x /âˆˆM, Ï(x) â‰¥1. Try f(Î±x) = Î±Ï(x) for Î± âˆˆR. Then extend
f to the whole space using the Hahn Banach theorem and call the result F,
show F is continuous, then ï¬x it so F is the real part of xâˆ—âˆˆXâ€².
14. A Banach space is said to be strictly convex if whenever ||x|| = ||y|| and x Ì¸= y,
then
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
x + y
2
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ < ||x||.
F : X â†’Xâ€² is said to be a duality map if it satisï¬es the following: a.)
||F(x)|| = ||x||. b.) F(x)(x) = ||x||2. Show that if Xâ€² is strictly convex, then
such a duality map exists. The duality map is an attempt to duplicate some
of the features of the Riesz map in Hilbert space which is discussed in the
chapter on Hilbert space. Hint: For an arbitrary Banach space, let
F (x) â‰¡
n
xâˆ—: ||xâˆ—|| â‰¤||x|| and xâˆ—(x) = ||x||2o
Show F (x) Ì¸= âˆ…by using the Hahn Banach theorem on f(Î±x) = Î±||x||2.
Next show F (x) is closed and convex.
Finally show that you can replace
the inequality in the deï¬nition of F (x) with an equal sign. Now use strict
convexity to show there is only one element in F (x).
15. Prove the following theorem which is an improved version of the open mapping
theorem, [17]. Let X and Y be Banach spaces and let A âˆˆL (X, Y ). Then
the following are equivalent.
AX = Y,
A is an open map.
There exists a constant M such that for every y âˆˆY , there exists x âˆˆX with
y = Ax and
||x|| â‰¤M ||y||.
Note this gives the equivalence between A being onto and A being an open
map. The open mapping theorem says that if A is onto then it is open.
16. Suppose D âŠ†X and D is dense in X. Suppose L : D â†’Y is linear and
||Lx|| â‰¤K||x|| for all x âˆˆD. Show there is a unique extension of L, eL, deï¬ned
on all of X with ||eLx|| â‰¤K||x|| and eL is linear. You do not get uniqueness
when you use the Hahn Banach theorem. Therefore, in the situation of this
problem, it is better to use this result.
17. â†‘A Banach space is uniformly convex if whenever ||xn||, ||yn|| â‰¤1 and
||xn + yn|| â†’2, it follows that ||xn âˆ’yn|| â†’0.
Show uniform convexity
implies strict convexity (See Problem 14). Hint: Suppose it is not strictly
convex. Then there exist ||x|| and ||y|| both equal to 1 and
Â¯Â¯Â¯Â¯ xn+yn
2
Â¯Â¯Â¯Â¯ = 1
consider xn â‰¡x and yn â‰¡y, and use the conditions for uniform convexity to
get a contradiction. It can be shown that Lp is uniformly convex whenever
âˆž> p > 1. See Hewitt and Stromberg [26] or Ray [43].

364
BANACH SPACES
18. Show that a closed subspace of a reï¬‚exive Banach space is reï¬‚exive. Hint:
The proof of this is an exercise in the use of the Hahn Banach theorem. Let
Y be the closed subspace of the reï¬‚exive space X and let yâˆ—âˆ—âˆˆY â€²â€². Then
iâˆ—âˆ—yâˆ—âˆ—âˆˆXâ€²â€² and so iâˆ—âˆ—yâˆ—âˆ—= Jx for some x âˆˆX because X is reï¬‚exive.
Now argue that x âˆˆY as follows. If x /âˆˆY , then there exists xâˆ—such that
xâˆ—(Y ) = 0 but xâˆ—(x) Ì¸= 0. Thus, iâˆ—xâˆ—= 0. Use this to get a contradiction.
When you know that x = y âˆˆY , the Hahn Banach theorem implies iâˆ—is onto
Y â€² and for all xâˆ—âˆˆXâ€²,
yâˆ—âˆ—(iâˆ—xâˆ—) = iâˆ—âˆ—yâˆ—âˆ—(xâˆ—) = Jx (xâˆ—) = xâˆ—(x) = xâˆ—(iy) = iâˆ—xâˆ—(y).
19. We say that xn converges weakly to x if for every xâˆ—âˆˆXâ€², xâˆ—(xn) â†’xâˆ—(x).
xn â‡€x denotes weak convergence. Show that if ||xn âˆ’x|| â†’0, then xn â‡€x.
20. â†‘Show that if X is uniformly convex, then if xn â‡€x and ||xn|| â†’||x||, it
follows ||xnâˆ’x|| â†’0. Hint: Use Lemma 13.27 to obtain f âˆˆXâ€² with ||f|| = 1
and f(x) = ||x||.
See Problem 17 for the deï¬nition of uniform convexity.
Now by the weak convergence, you can argue that if x Ì¸= 0, f (xn/ ||xn||) â†’
f (x/ ||x||). You also might try to show this in the special case where ||xn|| =
||x|| = 1.
21. Suppose L âˆˆL (X, Y ) and M âˆˆL (Y, Z). Show ML âˆˆL (X, Z) and that
(ML)âˆ—= Lâˆ—M âˆ—.
22. Let X and Y be Banach spaces and suppose f âˆˆL (X, Y ) is compact. Recall
this means that if B is a bounded set in X, then f (B) has compact closure
in Y. Show that f âˆ—is also a compact map. Hint: Take a bounded subset of
Y â€², S. You need to show f âˆ—(S) is totally bounded. You might consider using
the Ascoli Arzela theorem on the functions of S applied to f (B) where B is
the closed unit ball in X.

Hilbert Spaces
14.1
Basic Theory
Deï¬nition 14.1 Let X be a vector space. An inner product is a mapping from
X Ã— X to C if X is complex and from X Ã— X to R if X is real, denoted by (x, y)
which satisï¬es the following.
(x, x) â‰¥0, (x, x) = 0 if and only if x = 0,
(14.1)
(x, y) = (y, x).
(14.2)
For a, b âˆˆC and x, y, z âˆˆX,
(ax + by, z) = a(x, z) + b(y, z).
(14.3)
Note that 14.2 and 14.3 imply (x, ay + bz) = a(x, y) + b(x, z). Such a vector space
is called an inner product space.
The Cauchy Schwarz inequality is fundamental for the study of inner product
spaces.
Theorem 14.2 (Cauchy Schwarz) In any inner product space
|(x, y)| â‰¤||x|| ||y||.
Proof: Let Ï‰ âˆˆC, |Ï‰| = 1, and Ï‰(x, y) = |(x, y)| = Re(x, yÏ‰). Let
F(t) = (x + tyÏ‰, x + tÏ‰y).
If y = 0 there is nothing to prove because
(x, 0) = (x, 0 + 0) = (x, 0) + (x, 0)
and so (x, 0) = 0. Thus, it can be assumed y Ì¸= 0. Then from the axioms of the
inner product,
F(t) = ||x||2 + 2t Re(x, Ï‰y) + t2||y||2 â‰¥0.
365

366
HILBERT SPACES
This yields
||x||2 + 2t|(x, y)| + t2||y||2 â‰¥0.
Since this inequality holds for all t âˆˆR, it follows from the quadratic formula that
4|(x, y)|2 âˆ’4||x||2||y||2 â‰¤0.
This yields the conclusion and proves the theorem.
Proposition 14.3 For an inner product space, ||x|| â‰¡(x, x)1/2 does specify a
norm.
Proof: All the axioms are obvious except the triangle inequality. To verify this,
||x + y||2
â‰¡
(x + y, x + y) â‰¡||x||2 + ||y||2 + 2 Re (x, y)
â‰¤
||x||2 + ||y||2 + 2 |(x, y)|
â‰¤
||x||2 + ||y||2 + 2 ||x|| ||y|| = (||x|| + ||y||)2.
The following lemma is called the parallelogram identity.
Lemma 14.4 In an inner product space,
||x + y||2 + ||x âˆ’y||2 = 2||x||2 + 2||y||2.
The proof, a straightforward application of the inner product axioms, is left to
the reader.
Lemma 14.5 For x âˆˆH, an inner product space,
||x|| = sup
||y||â‰¤1
|(x, y)|
(14.4)
Proof: By the Cauchy Schwarz inequality, if x Ì¸= 0,
||x|| â‰¥sup
||y||â‰¤1
|(x, y)| â‰¥
Âµ
x,
x
||x||
Â¶
= ||x|| .
It is obvious that 14.4 holds in the case that x = 0.
Deï¬nition 14.6 A Hilbert space is an inner product space which is complete. Thus
a Hilbert space is a Banach space in which the norm comes from an inner product
as described above.
In Hilbert space, one can deï¬ne a projection map onto closed convex nonempty
sets.
Deï¬nition 14.7 A set, K, is convex if whenever Î» âˆˆ[0, 1] and x, y âˆˆK, Î»x+(1âˆ’
Î»)y âˆˆK.

14.1.
BASIC THEORY
367
Theorem 14.8 Let K be a closed convex nonempty subset of a Hilbert space, H,
and let x âˆˆH. Then there exists a unique point Px âˆˆK such that ||Px âˆ’x|| â‰¤
||y âˆ’x|| for all y âˆˆK.
Proof: Consider uniqueness. Suppose that z1 and z2 are two elements of K
such that for i = 1, 2,
||zi âˆ’x|| â‰¤||y âˆ’x||
(14.5)
for all y âˆˆK. Also, note that since K is convex,
z1 + z2
2
âˆˆK.
Therefore, by the parallelogram identity,
||z1 âˆ’x||2
â‰¤
||z1 + z2
2
âˆ’x||2 = ||z1 âˆ’x
2
+ z2 âˆ’x
2
||2
=
2(||z1 âˆ’x
2
||2 + ||z2 âˆ’x
2
||2) âˆ’||z1 âˆ’z2
2
||2
=
1
2 ||z1 âˆ’x||2 + 1
2 ||z2 âˆ’x||2 âˆ’||z1 âˆ’z2
2
||2
â‰¤
||z1 âˆ’x||2 âˆ’||z1 âˆ’z2
2
||2,
where the last inequality holds because of 14.5 letting zi = z2 and y = z1. Hence
z1 = z2 and this shows uniqueness.
Now let Î» = inf{||x âˆ’y|| : y âˆˆK} and let yn be a minimizing sequence. This
means {yn} âŠ†K satisï¬es limnâ†’âˆž||x âˆ’yn|| = Î». Now the following follows from
properties of the norm.
||yn âˆ’x + ym âˆ’x||2 = 4(||yn + ym
2
âˆ’x||2)
Then by the parallelogram identity, and convexity of K, yn+ym
2
âˆˆK, and so
|| (yn âˆ’x) âˆ’(ym âˆ’x) ||2
=
2(||yn âˆ’x||2 + ||ym âˆ’x||2) âˆ’
=||ynâˆ’x+ymâˆ’x||2
z
}|
{
4(||yn + ym
2
âˆ’x||2)
â‰¤
2(||yn âˆ’x||2 + ||ym âˆ’x||2) âˆ’4Î»2.
Since ||x âˆ’yn|| â†’Î», this shows {yn âˆ’x} is a Cauchy sequence. Thus also {yn} is
a Cauchy sequence. Since H is complete, yn â†’y for some y âˆˆH which must be in
K because K is closed. Therefore
||x âˆ’y|| = lim
nâ†’âˆž||x âˆ’yn|| = Î».
Let Px = y.

368
HILBERT SPACES
Corollary 14.9 Let K be a closed, convex, nonempty subset of a Hilbert space, H,
and let x âˆˆH. Then for z âˆˆK, z = Px if and only if
Re(x âˆ’z, y âˆ’z) â‰¤0
(14.6)
for all y âˆˆK.
Before proving this, consider what it says in the case where the Hilbert space is
Rn.
-
X
X
X
y
K
y
Î¸
x
z
Condition 14.6 says the angle, Î¸, shown in the diagram is always obtuse. Re-
member from calculus, the sign of x Â· y is the same as the sign of the cosine of the
included angle between x and y. Thus, in ï¬nite dimensions, the conclusion of this
corollary says that z = Px exactly when the angle of the indicated angle is obtuse.
Surely the picture suggests this is reasonable.
The inequality 14.6 is an example of a variational inequality and this corollary
characterizes the projection of x onto K as the solution of this variational inequality.
Proof of Corollary:
Let z âˆˆK and let y âˆˆK also. Since K is convex, it
follows that if t âˆˆ[0, 1],
z + t(y âˆ’z) = (1 âˆ’t) z + ty âˆˆK.
Furthermore, every point of K can be written in this way. (Let t = 1 and y âˆˆK.)
Therefore, z = Px if and only if for all y âˆˆK and t âˆˆ[0, 1],
||x âˆ’(z + t(y âˆ’z))||2 = ||(x âˆ’z) âˆ’t(y âˆ’z)||2 â‰¥||x âˆ’z||2
for all t âˆˆ[0, 1] and y âˆˆK if and only if for all t âˆˆ[0, 1] and y âˆˆK
||x âˆ’z||2 + t2 ||y âˆ’z||2 âˆ’2t Re (x âˆ’z, y âˆ’z) â‰¥||x âˆ’z||2
If and only if for all t âˆˆ[0, 1],
t2 ||y âˆ’z||2 âˆ’2t Re (x âˆ’z, y âˆ’z) â‰¥0.
(14.7)
Now this is equivalent to 14.7 holding for all t âˆˆ(0, 1). Therefore, dividing by
t âˆˆ(0, 1) , 14.7 is equivalent to
t ||y âˆ’z||2 âˆ’2 Re (x âˆ’z, y âˆ’z) â‰¥0
for all t âˆˆ(0, 1) which is equivalent to 14.6. This proves the corollary.

14.1.
BASIC THEORY
369
Corollary 14.10 Let K be a nonempty convex closed subset of a Hilbert space, H.
Then the projection map, P is continuous. In fact,
|Px âˆ’Py| â‰¤|x âˆ’y| .
Proof: Let x, xâ€² âˆˆH. Then by Corollary 14.9,
Re (xâ€² âˆ’Pxâ€², Px âˆ’Pxâ€²) â‰¤0, Re (x âˆ’Px, Pxâ€² âˆ’Px) â‰¤0
Hence
0
â‰¤
Re (x âˆ’Px, Px âˆ’Pxâ€²) âˆ’Re (xâ€² âˆ’Pxâ€², Px âˆ’Pxâ€²)
=
Re (x âˆ’xâ€², Px âˆ’Pxâ€²) âˆ’|Px âˆ’Pxâ€²|2
and so
|Px âˆ’Pxâ€²|2 â‰¤|x âˆ’xâ€²| |Px âˆ’Pxâ€²| .
This proves the corollary.
The next corollary is a more general form for the Brouwer ï¬xed point theorem.
Corollary 14.11 Let f : K â†’K where K is a convex compact subset of Rn. Then
f has a ï¬xed point.
Proof:
Let K âŠ†B (0, R) and let P be the projection map onto K. Then
consider the map f â—¦P which maps B (0, R) to B (0, R) and is continuous. By the
Brouwer ï¬xed point theorem for balls, this map has a ï¬xed point. Thus there exists
x such that
f â—¦P (x) = x
Now the equation also requires x âˆˆK and so P (x) = x. Hence f (x) = x.
Deï¬nition 14.12 Let H be a vector space and let U and V be subspaces. U âŠ•V =
H if every element of H can be written as a sum of an element of U and an element
of V in a unique way.
The case where the closed convex set is a closed subspace is of special importance
and in this case the above corollary implies the following.
Corollary 14.13 Let K be a closed subspace of a Hilbert space, H, and let x âˆˆH.
Then for z âˆˆK, z = Px if and only if
(x âˆ’z, y) = 0
(14.8)
for all y âˆˆK. Furthermore, H = K âŠ•KâŠ¥where
KâŠ¥â‰¡{x âˆˆH : (x, k) = 0 for all k âˆˆK}
and
||x||2 = ||x âˆ’Px||2 + ||Px||2 .
(14.9)

370
HILBERT SPACES
Proof: Since K is a subspace, the condition 14.6 implies Re(x âˆ’z, y) â‰¤0
for all y âˆˆK. Replacing y with âˆ’y, it follows Re(x âˆ’z, âˆ’y) â‰¤0 which implies
Re(x âˆ’z, y) â‰¥0 for all y. Therefore, Re(x âˆ’z, y) = 0 for all y âˆˆK. Now let
|Î±| = 1 and Î± (x âˆ’z, y) = |(x âˆ’z, y)|. Since K is a subspace, it follows Î±y âˆˆK for
all y âˆˆK. Therefore,
0 = Re(x âˆ’z, Î±y) = (x âˆ’z, Î±y) = Î± (x âˆ’z, y) = |(x âˆ’z, y)|.
This shows that z = Px, if and only if 14.8.
For x âˆˆH, x = x âˆ’Px + Px and from what was just shown, x âˆ’Px âˆˆKâŠ¥
and Px âˆˆK. This shows that KâŠ¥+ K = H. Is there only one way to write
a given element of H as a sum of a vector in K with a vector in KâŠ¥? Suppose
y + z = y1 + z1 where z, z1 âˆˆKâŠ¥and y, y1 âˆˆK. Then (y âˆ’y1) = (z1 âˆ’z) and
so from what was just shown, (y âˆ’y1, y âˆ’y1) = (y âˆ’y1, z1 âˆ’z) = 0 which shows
y1 = y and consequently z1 = z. Finally, letting z = Px,
||x||2
=
(x âˆ’z + z, x âˆ’z + z) = ||x âˆ’z||2 + (x âˆ’z, z) + (z, x âˆ’z) + ||z||2
=
||x âˆ’z||2 + ||z||2
This proves the corollary.
The following theorem is called the Riesz representation theorem for the dual of
a Hilbert space. If z âˆˆH then deï¬ne an element f âˆˆHâ€² by the rule (x, z) â‰¡f (x). It
follows from the Cauchy Schwarz inequality and the properties of the inner product
that f âˆˆHâ€². The Riesz representation theorem says that all elements of Hâ€² are of
this form.
Theorem 14.14 Let H be a Hilbert space and let f âˆˆHâ€². Then there exists a
unique z âˆˆH such that
f (x) = (x, z)
(14.10)
for all x âˆˆH.
Proof: Letting y, w âˆˆH the assumption that f is linear implies
f (yf(w) âˆ’f(y)w) = f (w) f (y) âˆ’f (y) f (w) = 0
which shows that yf(w)âˆ’f(y)w âˆˆf âˆ’1 (0), which is a closed subspace of H since f is
continuous. If f âˆ’1 (0) = H, then f is the zero map and z = 0 is the unique element
of H which satisï¬es 14.10. If f âˆ’1 (0) Ì¸= H, pick u /âˆˆf âˆ’1 (0) and let w â‰¡uâˆ’Pu Ì¸= 0.
Thus Corollary 14.13 implies (y, w) = 0 for all y âˆˆf âˆ’1 (0). In particular, let y =
xf(w) âˆ’f(x)w where x âˆˆH is arbitrary. Therefore,
0 = (f(w)x âˆ’f(x)w, w) = f(w)(x, w) âˆ’f(x)||w||2.
Thus, solving for f (x) and using the properties of the inner product,
f(x) = (x, f(w)w
||w||2 )

14.2.
APPROXIMATIONS IN HILBERT SPACE
371
Let z = f(w)w/||w||2. This proves the existence of z. If f (x) = (x, zi) i = 1, 2,
for all x âˆˆH, then for all x âˆˆH, then (x, z1 âˆ’z2) = 0 which implies, upon taking
x = z1 âˆ’z2 that z1 = z2. This proves the theorem.
If R : H â†’Hâ€² is deï¬ned by Rx (y) â‰¡(y, x) , the Riesz representation theorem
above states this map is onto. This map is called the Riesz map. It is routine to
show R is linear and |Rx| = |x|.
14.2
Approximations In Hilbert Space
The Gram Schmidt process applies in any Hilbert space.
Theorem 14.15 Let {x1, Â· Â· Â·, xn} be a basis for M a subspace of H a Hilbert space.
Then there exists an orthonormal basis for M, {u1, Â· Â· Â·, un} which has the property
that for each k â‰¤n, span(x1, Â· Â· Â·, xk) = span (u1, Â· Â· Â·, uk) . Also if {x1, Â· Â· Â·, xn} âŠ†H,
then
span (x1, Â· Â· Â·, xn)
is a closed subspace.
Proof: Let {x1, Â· Â· Â·, xn} be a basis for M. Let u1 â‰¡x1/ |x1| . Thus for k = 1,
span (u1) = span (x1) and {u1} is an orthonormal set.
Now suppose for some
k < n, u1, Â·Â·Â·, uk have been chosen such that (uj Â· ul) = Î´jl and span (x1, Â· Â· Â·, xk) =
span (u1, Â· Â· Â·, uk). Then deï¬ne
uk+1 â‰¡
xk+1 âˆ’Pk
j=1 (xk+1 Â· uj) uj
Â¯Â¯Â¯xk+1 âˆ’Pk
j=1 (xk+1 Â· uj) uj
Â¯Â¯Â¯
,
(14.11)
where the denominator is not equal to zero because the xj form a basis and so
xk+1 /âˆˆspan (x1, Â· Â· Â·, xk) = span (u1, Â· Â· Â·, uk)
Thus by induction,
uk+1 âˆˆspan (u1, Â· Â· Â·, uk, xk+1) = span (x1, Â· Â· Â·, xk, xk+1) .
Also, xk+1 âˆˆspan (u1, Â· Â· Â·, uk, uk+1) which is seen easily by solving 14.11 for xk+1
and it follows
span (x1, Â· Â· Â·, xk, xk+1) = span (u1, Â· Â· Â·, uk, uk+1) .
If l â‰¤k,
(uk+1 Â· ul)
=
C
ï£«
ï£­(xk+1 Â· ul) âˆ’
k
X
j=1
(xk+1 Â· uj) (uj Â· ul)
ï£¶
ï£¸
=
C
ï£«
ï£­(xk+1 Â· ul) âˆ’
k
X
j=1
(xk+1 Â· uj) Î´lj
ï£¶
ï£¸
=
C ((xk+1 Â· ul) âˆ’(xk+1 Â· ul)) = 0.

372
HILBERT SPACES
The vectors, {uj}n
j=1 , generated in this way are therefore an orthonormal basis
because each vector has unit length.
Consider the second claim about ï¬nite dimensional subspaces. Without loss of
generality, assume {x1, Â· Â· Â·, xn} is linearly independent. If it is not, delete vectors un-
til a linearly independent set is obtained. Then by the ï¬rst part, span (x1, Â· Â· Â·, xn) =
span (u1, Â· Â· Â·, un) â‰¡M where the ui are an orthonormal set of vectors. Suppose
{yk} âŠ†M and yk â†’y âˆˆH. Is y âˆˆM? Let
yk â‰¡
n
X
j=1
ck
j uj
Then let ck â‰¡
Â¡
ck
1, Â· Â· Â·, ck
n
Â¢T . Then
Â¯Â¯ck âˆ’clÂ¯Â¯2
â‰¡
n
X
j=1
Â¯Â¯ck
j âˆ’cl
j
Â¯Â¯2 =
ï£«
ï£­
n
X
j=1
Â¡
ck
j âˆ’cl
j
Â¢
uj,
n
X
j=1
Â¡
ck
j âˆ’cl
j
Â¢
uj
ï£¶
ï£¸
=
||yk âˆ’yl||2
which shows
Â©
ckÂª
is a Cauchy sequence in Fn and so it converges to c âˆˆFn. Thus
y = lim
kâ†’âˆžyk = lim
kâ†’âˆž
n
X
j=1
ck
j uj =
n
X
j=1
cjuj âˆˆM.
This completes the proof.
Theorem 14.16 Let M be the span of {u1, Â· Â· Â·, un} in a Hilbert space, H and let
y âˆˆH. Then Py is given by
Py =
n
X
k=1
(y, uk) uk
(14.12)
and the distance is given by
v
u
u
t|y|2 âˆ’
n
X
k=1
|(y, uk)|2.
(14.13)
Proof:
Ãƒ
y âˆ’
n
X
k=1
(y, uk) uk, up
!
=
(y, up) âˆ’
n
X
k=1
(y, uk) (uk, up)
=
(y, up) âˆ’(y, up) = 0
It follows that
Ãƒ
y âˆ’
n
X
k=1
(y, uk) uk, u
!
= 0

14.2.
APPROXIMATIONS IN HILBERT SPACE
373
for all u âˆˆM and so by Corollary 14.13 this veriï¬es 14.12.
The square of the distance, d is given by
d2
=
Ãƒ
y âˆ’
n
X
k=1
(y, uk) uk, y âˆ’
n
X
k=1
(y, uk) uk
!
=
|y|2 âˆ’2
n
X
k=1
|(y, uk)|2 +
n
X
k=1
|(y, uk)|2
and this shows 14.13.
What if the subspace is the span of vectors which are not orthonormal? There
is a very interesting formula for the distance between a point of a Hilbert space and
a ï¬nite dimensional subspace spanned by an arbitrary basis.
Deï¬nition 14.17 Let {x1, Â· Â· Â·, xn} âŠ†H, a Hilbert space. Deï¬ne
G (x1, Â· Â· Â·, xn) â‰¡
ï£«
ï£¬
ï£­
(x1, x1)
Â· Â· Â·
(x1, xn)
...
...
(xn, x1)
Â· Â· Â·
(xn, xn)
ï£¶
ï£·
ï£¸
(14.14)
Thus the ijth entry of this matrix is (xi, xj). This is sometimes called the Gram
matrix. Also deï¬ne G (x1, Â· Â· Â·, xn) as the determinant of this matrix, also called the
Gram determinant.
G (x1, Â· Â· Â·, xn) â‰¡
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
(x1, x1)
Â· Â· Â·
(x1, xn)
...
...
(xn, x1)
Â· Â· Â·
(xn, xn)
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
(14.15)
The theorem is the following.
Theorem 14.18 Let M = span (x1, Â· Â· Â·, xn) âŠ†H, a Real Hilbert space where
{x1, Â· Â· Â·, xn} is a basis and let y âˆˆH. Then letting d be the distance from y to
M,
d2 = G (x1, Â· Â· Â·, xn, y)
G (x1, Â· Â· Â·, xn) .
(14.16)
Proof: By Theorem 14.15 M is a closed subspace of H. Let Pn
k=1 Î±kxk be the
element of M which is closest to y. Then by Corollary 14.13,
Ãƒ
y âˆ’
n
X
k=1
Î±kxk, xp
!
= 0
for each p = 1, 2, Â· Â· Â·, n. This yields the system of equations,
(y, xp) =
n
X
k=1
(xp, xk) Î±k, p = 1, 2, Â· Â· Â·, n
(14.17)

374
HILBERT SPACES
Also by Corollary 14.13,
||y||2 =
d2
z
}|
{
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯y âˆ’
n
X
k=1
Î±kxk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
+
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
k=1
Î±kxk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
and so, using 14.17,
||y||2
=
d2 +
X
j
ÃƒX
k
Î±k (xk, xj)
!
Î±j
=
d2 +
X
j
(y, xj) Î±j
(14.18)
â‰¡
d2 + yT
x Î±
(14.19)
in which
yT
x â‰¡((y, x1) , Â· Â· Â·, (y, xn)) , Î±T â‰¡(Î±1, Â· Â· Â·, Î±n) .
Then 14.17 and 14.18 imply the following system
Âµ G (x1, Â· Â· Â·, xn)
0
yT
x
1
Â¶ Âµ
Î±
d2
Â¶
=
Âµ
yx
||y||2
Â¶
By Cramerâ€™s rule,
d2
=
det
Âµ G (x1, Â· Â· Â·, xn)
yx
yT
x
||y||2
Â¶
det
Âµ G (x1, Â· Â· Â·, xn)
0
yT
x
1
Â¶
=
det
Âµ G (x1, Â· Â· Â·, xn)
yx
yT
x
||y||2
Â¶
det (G (x1, Â· Â· Â·, xn))
=
det (G (x1, Â· Â· Â·, xn, y))
det (G (x1, Â· Â· Â·, xn))
= G (x1, Â· Â· Â·, xn, y)
G (x1, Â· Â· Â·, xn)
and this proves the theorem.
14.3
The MÂ¨untz Theorem
Recall the polynomials are dense in C ([0, 1]) . This is a consequence of the Weier-
strass approximation theorem. Now consider ï¬nite linear combinations of the func-
tions, tpk where {p0, p1, p2, Â· Â· Â·} is a sequence of nonnegative real numbers, p0 â‰¡0.
The MÂ¨untz theorem says this set, S of ï¬nite linear combinations is dense in C ([0, 1])
exactly when Pâˆž
k=1
1
pk = âˆž. There are two versions of this theorem, one for density
of S in L2 (0, 1) and one for C ([0, 1]) . The presentation follows Cheney [14].

14.3.
THE M Â¨UNTZ THEOREM
375
Recall the Cauchy identity presented earlier, Theorem 4.46 on Page 76 which is
stated here for convenience.
Theorem 14.19 The following identity holds.
Y
i,j
(ai + bj)
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
1
a1+b1
Â· Â· Â·
1
a1+bn
...
...
1
an+b1
Â· Â· Â·
1
an+bn
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
=
Y
j<i
(ai âˆ’aj) (bi âˆ’bj) .
(14.20)
Lemma 14.20 Let m, p1, Â·Â·Â·, pn be distinct real numbers larger than âˆ’1/2. Thus the
functions, fm (x) â‰¡xm, fpj (x) â‰¡xpj are all in L2 (0, 1). Let M = span (fp1, Â· Â· Â·, fpn) .
Then the L2 distance, d between fm and M is
d =
1
âˆš2m + 1
n
Y
j=1
|m âˆ’pj|
m + pj + 1
Proof: By Theorem 14.18
d2 = G (fp1, Â· Â· Â·, fpn, fm)
G (fp1, Â· Â· Â·, fpn)
.
Â¡
fpi, fpj
Â¢
=
Z 1
0
xpixpjdx =
1
1 + pi + pj
Therefore,
d2 =
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
1
1+p1+p1
1
1+p1+p2
Â· Â· Â·
1
1+p1+pn
1
1+m+p1
1
1+p2+p1
1
1+p2+p2
Â· Â· Â·
1
1+p2+pn
1
1+m+p2
...
...
...
...
1
1+pn+p1
1
1+pn+p2
Â· Â· Â·
1
1+pn+pn
1
1+pn+m
1
1+m+p1
1
1+m+p2
Â· Â· Â·
1
1+m+pn
1
1+m+m
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
1
1+p1+p1
1
1+p1+p2
Â· Â· Â·
1
1+p1+pn
1
1+p2+p1
1
1+p2+p2
Â· Â· Â·
1
1+p2+pn
...
...
...
1
1+pn+p1
1
1+pn+p2
Â· Â· Â·
1
1+pn+pn
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Now from the Cauchy identity, letting ai = pi + 1
2 and bj = 1
2 + pj with pn+1 = m,
the numerator of the above equals
Q
j<iâ‰¤n+1 (pi âˆ’pj) (pi âˆ’pj)
Q
i,jâ‰¤n+1 (pi + pj + 1)
=
Qn
k=1 (m âˆ’pk)2 Q
j<iâ‰¤n (pi âˆ’pj)2
Qn
i=1 (m + pi + 1) Qn
j=1 (m + pj + 1) Q
i,jâ‰¤n (pi + pj + 1) (2m + 1)
=
Qn
k=1 (m âˆ’pk)2 Q
j<iâ‰¤n (pi âˆ’pj)2
Qn
i=1 (m + pi + 1)2 Q
i,jâ‰¤n (pi + pj + 1) (2m + 1)

376
HILBERT SPACES
while the denominator equals
Q
j<iâ‰¤n (pi âˆ’pj)2
Q
i,jâ‰¤n (pi + pj + 1)
Therefore,
d2
=
Âµ
Qn
k=1(mâˆ’pk)2 Q
j<iâ‰¤n(piâˆ’pj)2
Qn
i=1(m+pi+1)2 Q
i,jâ‰¤n(pi+pj+1)(2m+1)
Â¶
Â³ Q
j<iâ‰¤n(piâˆ’pj)2
Q
i,jâ‰¤n(pi+pj+1)
Â´
=
Qn
k=1 (m âˆ’pk)2
Qn
i=1 (m + pi + 1)2 (2m + 1)
which shows
d =
1
âˆš2m + 1
n
Y
k=1
|m âˆ’pk|
m + pk + 1.
and this proves the lemma.
The following lemma relates an inï¬nite sum to a product. First consider the
graph of ln (1 âˆ’x) for x âˆˆ
Â£
0, 1
2
Â¤
. Here is a rough sketch with two lines, y = âˆ’x
which lies above the graph of ln (1 âˆ’x) and y = âˆ’2x which lies below.
@
@
@
@
@
A
A
A
A
A
A
A
A
A
A
1
2
Lemma 14.21 Let an Ì¸= 1, an > 0, and limnâ†’âˆžan = 0. Then
âˆž
Y
k=1
(1 âˆ’an) â‰¡lim
nâ†’âˆž
n
Y
k=1
(1 âˆ’an) = 0
if and only if
âˆž
X
n=1
an = +âˆž.
Proof:Without loss of generality, you can assume an < 1/2 because the two
conditions are determined by the values of an for n large. By the above sketch the

14.3.
THE M Â¨UNTZ THEOREM
377
following is obtained.
ln
n
Y
k=1
(1 âˆ’ak) =
n
X
k=1
ln (1 âˆ’ak) âˆˆ
"
âˆ’2
n
X
k=1
ak, âˆ’
n
X
k=1
ak
#
.
Therefore,
eâˆ’2 Pn
k=1 ak â‰¤
n
Y
k=1
(1 âˆ’ak) â‰¤eâˆ’Pn
k=1 ak
The conclusion follows.
The following is MÂ¨untzâ€™s ï¬rst theorem.
Theorem 14.22 Let {pn} be a sequence of real numbers larger than âˆ’1/2 such that
limnâ†’âˆžpn = âˆž. Let S denote the set of ï¬nite linear combinations of the functions,
{xp1, xp2, Â· Â· Â·} . Then S is dense in L2 (0, 1) if and only if
âˆž
X
i=1
1
pi
= âˆž.
Proof: The polynomials are dense in L2 (0, 1) and so S is dense in L2 (0, 1) if
and only if for every Îµ > 0 there exists a function f from S such that for each
integer m â‰¥0,
Â³R 1
0 |f (x) âˆ’xm|2 dx
Â´1/2
< Îµ.
This happens if and only if for
all n large enough, the distance in L2 (0, 1) between the function, x â†’xm and
span (xp1, xp2, Â· Â· Â·, xpn) is less than Îµ. However, from Lemma 14.20 this distance
equals
1
âˆš2m + 1
n
Y
k=1
|m âˆ’pk|
m + pk + 1
=
1
âˆš2m + 1
n
Y
k=1
1 âˆ’
Âµ
1 âˆ’
|m âˆ’pk|
m + pk + 1
Â¶
Thus S is dense if and only if
âˆž
Y
k=1
Âµ
1 âˆ’
Âµ
1 âˆ’
|m âˆ’pk|
m + pk + 1
Â¶Â¶
= 0
which, by Lemma 14.21, happens if and only if
âˆž
X
k=1
Âµ
1 âˆ’
|m âˆ’pk|
m + pk + 1
Â¶
= +âˆž
But this sum equals
âˆž
X
k=1
Âµm + pk + 1 âˆ’|m âˆ’pk|
m + pk + 1
Â¶

378
HILBERT SPACES
which has the same convergence properties as P 1
pk by the limit comparison test.
This proves the theorem.
The following is MÂ¨untzâ€™s second theorem.
Theorem 14.23 Let S be ï¬nite linear combinations of {1, xp1, xp2, Â· Â· Â·} where pj â‰¥
1 and limnâ†’âˆžpn = âˆž. Then S is dense in C ([0, 1]) if and only if Pâˆž
k=1
1
pk = âˆž.
Proof: If S is dense in C ([0, 1]) then S must also be dense in L2 (0, 1) and so
by Theorem 14.22 Pâˆž
k=1
1
pk = âˆž.
Suppose then that Pâˆž
k=1
1
pk = âˆžso that by Theorem 14.22, S is dense in
L2 (0, 1) . The theorem will be proved if it is shown that for all m a nonnegative
integer,
max {|xm âˆ’f (x)| : x âˆˆ[0, 1]} < Îµ
for some f âˆˆS. This is true if m = 0 because 1 âˆˆS. Suppose then that m > 0. Let
Sâ€² denote ï¬nite linear combinations of the functions
Â©
xp1âˆ’1, xp2âˆ’1, Â· Â· Â·
Âª
.
These functions are also dense in L2 (0, 1) because P
1
pkâˆ’1 = âˆžby the limit com-
parison test. Then by Theorem 14.22 there exists f âˆˆSâ€² such that
ÂµZ 1
0
Â¯Â¯f (x) âˆ’mxmâˆ’1Â¯Â¯2 dx
Â¶1/2
< Îµ.
Thus F (x) â‰¡
R x
0 f (t) dt âˆˆS and
|F (x) âˆ’xm|
=
Â¯Â¯Â¯Â¯
Z x
0
Â¡
f (t) âˆ’mtmâˆ’1Â¢
dt
Â¯Â¯Â¯Â¯
â‰¤
Z x
0
Â¯Â¯f (t) âˆ’mtmâˆ’1Â¯Â¯ dt
â‰¤
ÂµZ 1
0
Â¯Â¯f (t) âˆ’mtmâˆ’1Â¯Â¯2 dt
Â¶1/2 ÂµZ 1
0
dx
Â¶1/2
<
Îµ
and this proves the theorem.
14.4
Orthonormal Sets
The concept of an orthonormal set of vectors is a generalization of the notion of the
standard basis vectors of Rn or Cn.
Deï¬nition 14.24 Let H be a Hilbert space. S âŠ†H is called an orthonormal set if
||x|| = 1 for all x âˆˆS and (x, y) = 0 if x, y âˆˆS and x Ì¸= y. For any set, D,
DâŠ¥â‰¡{x âˆˆH : (x, d) = 0 for all d âˆˆD} .
If S is a set, span (S) is the set of all ï¬nite linear combinations of vectors from S.

14.4.
ORTHONORMAL SETS
379
You should verify that DâŠ¥is always a closed subspace of H.
Theorem 14.25 In any separable Hilbert space, H, there exists a countable or-
thonormal set, S = {xi} such that the span of these vectors is dense in H. Further-
more, if span (S) is dense, then for x âˆˆH,
x =
âˆž
X
i=1
(x, xi) xi â‰¡lim
nâ†’âˆž
n
X
i=1
(x, xi) xi.
(14.21)
Proof:
Let F denote the collection of all orthonormal subsets of H.
F is
nonempty because {x} âˆˆF where ||x|| = 1. The set, F is a partially ordered set
with the order given by set inclusion. By the Hausdorï¬€maximal theorem, there
exists a maximal chain, C in F. Then let S â‰¡âˆªC. It follows S must be a maximal
orthonormal set of vectors. Why? It remains to verify that S is countable span (S)
is dense, and the condition, 14.21 holds. To see S is countable note that if x, y âˆˆS,
then
||x âˆ’y||2 = ||x||2 + ||y||2 âˆ’2 Re (x, y) = ||x||2 + ||y||2 = 2.
Therefore, the open sets, B
Â¡
x, 1
2
Â¢
for x âˆˆS are disjoint and cover S. Since H is
assumed to be separable, there exists a point from a countable dense set in each of
these disjoint balls showing there can only be countably many of the balls and that
consequently, S is countable as claimed.
It remains to verify 14.21 and that span (S) is dense. If span (S) is not dense,
then span (S) is a closed proper subspace of H and letting y /âˆˆspan (S),
z â‰¡
y âˆ’Py
||y âˆ’Py|| âˆˆspan (S)âŠ¥.
But then S âˆª{z} would be a larger orthonormal set of vectors contradicting the
maximality of S.
It remains to verify 14.21. Let S = {xi}âˆž
i=1 and consider the problem of choosing
the constants, ck in such a way as to minimize the expression
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯x âˆ’
n
X
k=1
ckxk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
=
||x||2 +
n
X
k=1
|ck|2 âˆ’
n
X
k=1
ck (x, xk) âˆ’
n
X
k=1
ck(x, xk).
This equals
||x||2 +
n
X
k=1
|ck âˆ’(x, xk)|2 âˆ’
n
X
k=1
|(x, xk)|2
and therefore, this minimum is achieved when ck = (x, xk) and equals
||x||2 âˆ’
n
X
k=1
|(x, xk)|2

380
HILBERT SPACES
Now since span (S) is dense, there exists n large enough that for some choice of
constants, ck,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯x âˆ’
n
X
k=1
ckxk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
< Îµ.
However, from what was just shown,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯x âˆ’
n
X
i=1
(x, xi) xi
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
â‰¤
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯x âˆ’
n
X
k=1
ckxk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
< Îµ
showing that limnâ†’âˆž
Pn
i=1 (x, xi) xi = x as claimed. This proves the theorem.
The proof of this theorem contains the following corollary.
Corollary 14.26 Let S be any orthonormal set of vectors and let
{x1, Â· Â· Â·, xn} âŠ†S.
Then if x âˆˆH
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯x âˆ’
n
X
k=1
ckxk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
â‰¥
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯x âˆ’
n
X
i=1
(x, xi) xi
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
for all choices of constants, ck. In addition to this, Besselâ€™s inequality
||x||2 â‰¥
n
X
k=1
|(x, xk)|2 .
If S is countable and span (S) is dense, then letting {xi}âˆž
i=1 = S, 14.21 follows.
14.5
Fourier Series, An Example
In this section consider the Hilbert space, L2 (0, 2Ï€) with the inner product,
(f, g) â‰¡
Z 2Ï€
0
fgdm.
This is a Hilbert space because of the theorem which states the Lp spaces are com-
plete, Theorem 12.10 on Page 319. An example of an orthonormal set of functions
in L2 (0, 2Ï€) is
Ï†n (x) â‰¡
1
âˆš
2Ï€ einx
for n an integer. Is it true that the span of these functions is dense in L2 (0, 2Ï€)?
Theorem 14.27 Let S = {Ï†n}nâˆˆZ. Then span (S) is dense in L2 (0, 2Ï€).

14.5.
FOURIER SERIES, AN EXAMPLE
381
Proof: By regularity of Lebesgue measure, it follows from Theorem 12.16 that
Cc (0, 2Ï€) is dense in L2 (0, 2Ï€) . Therefore, it suï¬ƒces to show that for g âˆˆCc (0, 2Ï€) ,
then for every Îµ > 0 there exists h âˆˆspan (S) such that ||g âˆ’h||L2(0,2Ï€) < Îµ.
Let T denote the points of C which are of the form eit for t âˆˆR. Let A denote
the algebra of functions consisting of polynomials in z and 1/z for z âˆˆT. Thus a
typical such function would be one of the form
m
X
k=âˆ’m
ckzk
for m chosen large enough.
This algebra separates the points of T because it
contains the function, p (z) = z. It annihilates no point of t because it contains
the constant function 1. Furthermore, it has the property that for f âˆˆA, f âˆˆA.
By the Stone Weierstrass approximation theorem, Theorem 7.16 on Page 165, A is
dense in C (T) . Now for g âˆˆCc (0, 2Ï€) , extend g to all of R to be 2Ï€ periodic. Then
letting G
Â¡
eitÂ¢
â‰¡g (t) , it follows G is well deï¬ned and continuous on T. Therefore,
there exists H âˆˆA such that for all t âˆˆR,
Â¯Â¯H
Â¡
eitÂ¢
âˆ’G
Â¡
eitÂ¢Â¯Â¯ < Îµ2/2Ï€.
Thus H
Â¡
eitÂ¢
is of the form
H
Â¡
eitÂ¢
=
m
X
k=âˆ’m
ck
Â¡
eitÂ¢k =
m
X
k=âˆ’m
ckeikt âˆˆspan (S) .
Let h (t) = Pm
k=âˆ’m ckeikt. Then
ÂµZ 2Ï€
0
|g âˆ’h|2 dx
Â¶1/2
â‰¤
ÂµZ 2Ï€
0
max {|g (t) âˆ’h (t)| : t âˆˆ[0, 2Ï€]} dx
Â¶1/2
=
ÂµZ 2Ï€
0
max
Â©Â¯Â¯G
Â¡
eitÂ¢
âˆ’H
Â¡
eitÂ¢Â¯Â¯ : t âˆˆ[0, 2Ï€]
Âª
dx
Â¶1/2
<
ÂµZ 2Ï€
0
Îµ2
2Ï€
Â¶1/2
= Îµ.
This proves the theorem.
Corollary 14.28 For f âˆˆL2 (0, 2Ï€) ,
lim
mâ†’âˆž
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯f âˆ’
m
X
k=âˆ’m
(f, Ï†k) Ï†k
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(0,2Ï€)
Proof: This follows from Theorem 14.25 on Page 379.

382
HILBERT SPACES
14.6
Compact Operators
14.6.1
Compact Operators In Hilbert Space
Deï¬nition 14.29 Let A âˆˆL (H, H) where H is a Hilbert space. Then |(Ax, y)| â‰¤
||A|| ||x|| ||y|| and so the map, x â†’(Ax, y) is continuous and linear. By the Riesz
representation theorem, there exists a unique element of H, denoted by Aâˆ—y such
that
(Ax, y) = (x, Aâˆ—y) .
It is clear y â†’Aâˆ—y is linear and continuous. Aâˆ—is called the adjoint of A. A is a
self adjoint operator if A = Aâˆ—. Thus for a self adjoint operator, (Ax, y) = (x, Ay)
for all x, y âˆˆH. A is a compact operator if whenever {xk} is a bounded sequence,
there exists a convergent subsequence of {Axk}. Equivalently, A maps bounded sets
to sets whose closures are compact.
The big result is called the Hilbert Schmidt theorem. It is a generalization to
arbitrary Hilbert spaces of standard ï¬nite dimensional results having to do with
diagonalizing a symmetric matrix. There is another statement and proof of this
theorem around Page 598.
Theorem 14.30 Let A be a compact self adjoint operator deï¬ned on a Hilbert
space, H. Then there exists a countable set of eigenvalues, {Î»i} and an orthonormal
set of eigenvectors, ui satisfying
Î»i is real, |Î»n| â‰¥|Î»n+1| , Aui = Î»iui,
(14.22)
and either
lim
nâ†’âˆžÎ»n = 0,
(14.23)
or for some n,
span (u1, Â· Â· Â·, un) = H.
(14.24)
In any case,
span ({ui}âˆž
i=1) is dense in A (H) .
(14.25)
and for all x âˆˆH,
Ax =
âˆž
X
k=1
Î»k (x, uk) uk.
(14.26)
This sequence of eigenvectors and eigenvalues also satisï¬es
|Î»n| = ||An|| ,
(14.27)
and
An : Hn â†’Hn.
(14.28)
where H â‰¡H1 and Hn â‰¡{u1, Â· Â· Â·, unâˆ’1}âŠ¥and An is the restriction of A to Hn.

14.6.
COMPACT OPERATORS
383
Proof:
If A = 0 then pick u âˆˆH with ||u|| = 1 and let Î»1 = 0.
Since
A (H) = 0 it follows the span of u is dense in A (H) and this proves the theorem in
this uninteresting case.
Assume from now on A Ì¸= 0. Let Î»1 be real and Î»2
1 â‰¡||A||2. From the deï¬nition
of ||A|| there exists xn, ||xn|| = 1, and ||Axn|| â†’||A|| = |Î»1|. Now it is clear that
A2 is also a compact self adjoint operator. Consider
Â¡Â¡
Î»2
1 âˆ’A2Â¢
xn, xn
Â¢
= Î»2
1 âˆ’||Axn||2 â†’0.
Since A is compact, there exists a subsequence of {xn} still denoted by {xn} such
that Axn converges to some element of H. Thus since Î»2
1 âˆ’A2 satisï¬es
Â¡Â¡
Î»2
1 âˆ’A2Â¢
y, y
Â¢
â‰¥0
in addition to being self adjoint, it follows x, y â†’
Â¡Â¡
Î»2
1 âˆ’A2Â¢
x, y
Â¢
satisï¬es all the
axioms for an inner product except for the one which says that (z, z) = 0 only if
z = 0. Therefore, the Cauchy Schwarz inequality may be used to write
Â¯Â¯Â¡Â¡
Î»2
1 âˆ’A2Â¢
xn, y
Â¢Â¯Â¯
â‰¤
Â¡Â¡
Î»2
1 âˆ’A2Â¢
y, y
Â¢1/2 Â¡Â¡
Î»2
1 âˆ’A2Â¢
xn, xn
Â¢1/2
â‰¤
en ||y|| .
where en â†’0 as n â†’âˆž. Therefore, taking the sup over all ||y|| â‰¤1,
lim
nâ†’âˆž
Â¯Â¯Â¯Â¯Â¡
Î»2
1 âˆ’A2Â¢
xn
Â¯Â¯Â¯Â¯ = 0.
Since A2xn converges, it follows since Î»1 Ì¸= 0 that {xn} is a Cauchy sequence
converging to x with ||x|| = 1. Therefore, A2xn â†’A2x and so
Â¯Â¯Â¯Â¯Â¡
Î»2
1 âˆ’A2Â¢
x
Â¯Â¯Â¯Â¯ = 0.
Now
(Î»1I âˆ’A) (Î»1I + A) x = (Î»1I + A) (Î»1I âˆ’A) x = 0.
If (Î»1I âˆ’A) x = 0, let u1 â‰¡x. If (Î»1I âˆ’A) x = y Ì¸= 0, let u1 â‰¡
y
||y||.
Suppose {u1, Â· Â· Â·, un} is such that Auk = Î»kuk and |Î»k| â‰¥|Î»k+1|, |Î»k| = ||Ak||
and Ak : Hk â†’Hk for k â‰¤n. If
span (u1, Â· Â· Â·, un) = H
this yields the conclusion of the theorem in the situation of 14.24. Therefore, assume
the span of these vectors is always a proper subspace of H. It is shown next that
An+1 : Hn+1 â†’Hn+1. Let
y âˆˆHn+1 â‰¡{u1, Â· Â· Â·, un}âŠ¥
Then for k â‰¤n
(Ay, uk) = (y, Auk) = Î»k (y, uk) = 0,

384
HILBERT SPACES
showing An+1 : Hn+1 â†’Hn+1 as claimed. There are two cases. Either Î»n = 0 or it
is not. In the case where Î»n = 0 it follows An = 0. Every element of H is the sum
of one in span (u1, Â· Â· Â·, un) and one in span (u1, Â· Â· Â·, un)âŠ¥. (note span (u1, Â· Â· Â·, un)
is a closed subspace.) Thus, if x âˆˆH, x = y + z where y âˆˆspan (u1, Â· Â· Â·, un) and
z âˆˆspan (u1, Â· Â· Â·, un)âŠ¥and Az = 0. Say y = Pn
j=1 cjuj. Then
Ax
=
Ay =
n
X
j=1
cjAuj
=
n
X
j=1
cjÎ»juj âˆˆspan (u1, Â· Â· Â·, un) .
The conclusion of the theorem holds in this case because the above equation holds
if with ci = (x, ui).
Now consider the case where Î»n Ì¸= 0. In this case repeat the above argument
used to ï¬nd un+1 and Î»n+1 for the operator, An+1. This yields un+1 âˆˆHn+1 â‰¡
{u1, Â· Â· Â·, un}âŠ¥such that
||un+1|| = 1, ||Aun+1|| = |Î»n+1| = ||An+1|| â‰¤||An|| = |Î»n|
and if it is ever the case that Î»n = 0, it follows from the above argument that the
conclusion of the theorem is obtained.
I claim limnâ†’âˆžÎ»n = 0. If this were not so, then for some Îµ > 0, 0 < Îµ =
limnâ†’âˆž|Î»n| but then
||Aun âˆ’Aum||2
=
||Î»nun âˆ’Î»mum||2
=
|Î»n|2 + |Î»m|2 â‰¥2Îµ2
and so there would not exist a convergent subsequence of {Auk}âˆž
k=1 contrary to the
assumption that A is compact. This veriï¬es the claim that limnâ†’âˆžÎ»n = 0.
It remains to verify that span ({ui}) is dense in A (H). If w âˆˆspan ({ui})âŠ¥then
w âˆˆHn for all n and so for all n,
||Aw|| â‰¤||An|| ||w|| â‰¤|Î»n| ||w|| .
Therefore, Aw = 0. Now every vector from H can be written as a sum of one from
span ({ui})âŠ¥= span ({ui})
âŠ¥
and one from span ({ui}). Therefore, if x âˆˆH, x = y + w where y âˆˆspan ({ui})
and w âˆˆspan ({ui})
âŠ¥. It follows Aw = 0. Also, since y âˆˆspan ({ui}), there exist
constants, ck and n such that
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯y âˆ’
n
X
k=1
ckuk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < Îµ.

14.6.
COMPACT OPERATORS
385
Therefore, from Corollary 14.26,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯y âˆ’
n
X
k=1
(y, uk) uk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯y âˆ’
n
X
k=1
(x, uk) uk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < Îµ.
Therefore,
||A|| Îµ
>
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯A
Ãƒ
y âˆ’
n
X
k=1
(x, uk) uk
!Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Ax âˆ’
n
X
k=1
(x, uk) Î»kuk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ .
Since Îµ is arbitrary, this shows span ({ui}) is dense in A (H) and also implies 14.26.
This proves the theorem.
Deï¬ne v âŠ—u âˆˆL (H, H) by
v âŠ—u (x) = (x, u) v,
then 14.26 is of the form
A =
âˆž
X
k=1
Î»kuk âŠ—uk
This is the content of the following corollary.
Corollary 14.31 The main conclusion of the above theorem can be written as
A =
âˆž
X
k=1
Î»kuk âŠ—uk
where the convergence of the partial sums takes place in the operator norm.
Proof: Using 14.26
Â¯Â¯Â¯Â¯Â¯
ÃƒÃƒ
A âˆ’
n
X
k=1
Î»kuk âŠ—uk
!
x, y
!Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
Ãƒ
Ax âˆ’
n
X
k=1
Î»k (x, uk) uk, y
!Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
Ãƒ âˆž
X
k=n
Î»k (x, uk) uk, y
!Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=n
Î»k (x, uk) (uk, y)
Â¯Â¯Â¯Â¯Â¯
â‰¤
|Î»n|
Ãƒ âˆž
X
k=n
|(x, uk)|2
!1/2 Ãƒ âˆž
X
k=n
|(y, uk)|2
!1/2
â‰¤
|Î»n| ||x|| ||y||

386
HILBERT SPACES
It follows
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Ãƒ
A âˆ’
n
X
k=1
Î»kuk âŠ—uk
!
(x)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ â‰¤|Î»n| ||x||
and this proves the corollary.
Corollary 14.32 Let A be a compact self adjoint operator deï¬ned on a separable
Hilbert space, H. Then there exists a countable set of eigenvalues, {Î»i} and an
orthonormal set of eigenvectors, vi satisfying
Avi = Î»ivi, ||vi|| = 1,
(14.29)
span ({vi}âˆž
i=1) is dense in H.
(14.30)
Furthermore, if Î»i Ì¸= 0, the space, VÎ»i â‰¡{x âˆˆH : Ax = Î»ix} is ï¬nite dimensional.
Proof: In the proof of the above theorem, let W â‰¡span ({ui})
âŠ¥. By Theorem
14.25, there is an orthonormal set of vectors, {wi}âˆž
i=1 whose span is dense in W.
As shown in the proof of the above theorem, Aw = 0 for all w âˆˆW. Let {vi}âˆž
i=1 =
{ui}âˆž
i=1 âˆª{wi}âˆž
i=1.
It remains to verify the space, VÎ»i, is ï¬nite dimensional.
First observe that
A : VÎ»i â†’VÎ»i. Since A is continuous, it follows that A : VÎ»i â†’VÎ»i. Thus A is a
compact self adjoint operator on VÎ»i and by Theorem 14.30, 14.24 holds because
the only eigenvalue is Î»i. This proves the corollary.
Note the last claim of this corollary holds independent of the separability of H.
This proves the corollary.
Suppose Î» /âˆˆ{Î»n} and Î» Ì¸= 0. Then the above formula for A, 14.26, yields an
interesting formula for (A âˆ’Î»I)âˆ’1. Note ï¬rst that since limnâ†’âˆžÎ»n = 0, it follows
that Î»2
n/ (Î»n âˆ’Î»)2 must be bounded, say by a positive constant, M.
Corollary 14.33 Let A be a compact self adjoint operator and let Î» /âˆˆ{Î»n}âˆž
n=1
and Î» Ì¸= 0 where the Î»n are the eigenvalues of A. Then
(A âˆ’Î»I)âˆ’1 x = âˆ’1
Î»x + 1
Î»
âˆž
X
k=1
Î»k
Î»k âˆ’Î» (x, uk) uk.
(14.31)
Proof: Let m < n. Then since the {uk} form an orthonormal set,
Â¯Â¯Â¯Â¯Â¯
n
X
k=m
Î»k
Î»k âˆ’Î» (x, uk) uk
Â¯Â¯Â¯Â¯Â¯
=
Ãƒ
n
X
k=m
Âµ
Î»k
Î»k âˆ’Î»
Â¶2
|(x, uk)|2
!1/2
(14.32)
â‰¤
M
Ãƒ
n
X
k=m
|(x, uk)|2
!1/2
.
But from Besselâ€™s inequality,
âˆž
X
k=1
|(x, uk)|2 â‰¤||x||2

14.6.
COMPACT OPERATORS
387
and so for m large enough, the ï¬rst term in 14.32 is smaller than Îµ. This shows
the inï¬nite series in 14.31 converges. It is now routine to verify that the formula in
14.31 is the inverse.
14.6.2
Nuclear Operators
Deï¬nition 14.34 A self adjoint operator A âˆˆL (H, H) for H a separable Hilbert
space is called a nuclear operator if for some complete orthonormal set, {ek} ,
âˆž
X
k=1
|(Aek, ek)| < âˆž
To begin with here is an interesting lemma.
Lemma 14.35 Suppose {An} is a sequence of compact operators in L (X, Y ) for
two Banach spaces, X and Y and suppose A âˆˆL (X, Y ) and
lim
nâ†’âˆž||A âˆ’An|| = 0.
Then A is also compact.
Proof: Let B be a bounded set in X such that ||b|| â‰¤C for all b âˆˆB. I need to
verify AB is totally bounded. Suppose then it is not. Then there exists Îµ > 0 and
a sequence, {Abi} where bi âˆˆB and
||Abi âˆ’Abj|| â‰¥Îµ
whenever i Ì¸= j. Then let n be large enough that
||A âˆ’An|| â‰¤
Îµ
4C .
Then
||Anbi âˆ’Anbj||
=
||Abi âˆ’Abj + (An âˆ’A) bi âˆ’(An âˆ’A) bj||
â‰¥
||Abi âˆ’Abj|| âˆ’||(An âˆ’A) bi|| âˆ’||(An âˆ’A) bj||
â‰¥
||Abi âˆ’Abj|| âˆ’Îµ
4C C âˆ’Îµ
4C C â‰¥Îµ
2,
a contradiction to An being compact. This proves the lemma.
Then one can prove the following lemma.
In this lemma, A â‰¥0 will mean
(Ax, x) â‰¥0.
Lemma 14.36 Let A â‰¥0 be a nuclear operator deï¬ned on a separable Hilbert
space, H. Then A is compact and also, whenever {ek} is a complete orthonormal
set,
A =
âˆž
X
j=1
âˆž
X
i=1
(Aei, ej) ei âŠ—ej.

388
HILBERT SPACES
Proof: First consider the formula. Since A is given to be continuous,
Ax = A
ï£«
ï£­
âˆž
X
j=1
(x, ej) ej
ï£¶
ï£¸=
âˆž
X
j=1
(x, ej) Aej,
the series converging because
x =
âˆž
X
j=1
(x, ej) ej
Then also since A is self adjoint,
âˆž
X
j=1
âˆž
X
i=1
(Aei, ej) ei âŠ—ej (x)
â‰¡
âˆž
X
j=1
âˆž
X
i=1
(Aei, ej) (x, ej) ei
=
âˆž
X
j=1
(x, ej)
âˆž
X
i=1
(Aei, ej) ei
=
âˆž
X
j=1
(x, ej)
âˆž
X
i=1
(Aej, ei) ei
=
âˆž
X
j=1
(x, ej) Aej
Next consider the claim that A is compact. Let CA â‰¡
Â³Pâˆž
j=1 |(Aej, ej)|
Â´1/2
.
Let An be deï¬ned by
An â‰¡
âˆž
X
j=1
n
X
i=1
(Aei, ej) (ei âŠ—ej) .
Then An has values in span (e1, Â· Â· Â·, en) and so it must be a compact operator
because bounded sets in a ï¬nite dimensional space must be precompact. Then
|(Ax âˆ’Anx, y)|
=
Â¯Â¯Â¯Â¯Â¯Â¯
âˆž
X
j=1
âˆž
X
i=n+1
(Aeiej) (y, ej) (ei, x)
Â¯Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯Â¯
âˆž
X
j=1
(y, ej)
âˆž
X
i=n+1
(Aeiej) (ei, x)
Â¯Â¯Â¯Â¯Â¯Â¯

14.6.
COMPACT OPERATORS
389
â‰¤
Â¯Â¯Â¯Â¯Â¯Â¯
âˆž
X
j=1
|(y, ej)| (Aej, ej)1/2
âˆž
X
i=n+1
(Aeiei)1/2 |(ei, x)|
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
ï£«
ï£­
âˆž
X
j=1
|(y, ej)|2
ï£¶
ï£¸
1/2 ï£«
ï£­
âˆž
X
j=1
|(Aej, ej)|
ï£¶
ï£¸
1/2
Â·
Ãƒ
âˆž
X
i=n+1
|(x, ei)|2
!1/2 Ãƒ
âˆž
X
i=n+1
|(Aeiei)|
!1/2
â‰¤
|y| |x| CA
Ãƒ
âˆž
X
i=n+1
|(Aei, ei)|
!1/2
and this shows that if n is suï¬ƒciently large,
|((A âˆ’An) x, y)| â‰¤Îµ |x| |y| .
Therefore,
lim
nâ†’âˆž||A âˆ’An|| = 0
and so A is the limit in operator norm of ï¬nite rank bounded linear operators, each
of which is compact. Therefore, A is also compact.
Deï¬nition 14.37 The trace of a nuclear operator A âˆˆL (H, H) such that A â‰¥0
is deï¬ned to equal
âˆž
X
k=1
(Aek, ek)
where {ek} is an orthonormal basis for the Hilbert space, H.
Theorem 14.38 Deï¬nition 14.37 is well deï¬ned and equals Pâˆž
j=1 Î»j where the Î»j
are the eigenvalues of A.
Proof: Suppose {uk} is some other orthonormal basis. Then
ek =
âˆž
X
j=1
uj (ek, uj)
By Lemma 14.36 A is compact and so
A =
âˆž
X
k=1
Î»kuk âŠ—uk

390
HILBERT SPACES
where the uk are the orthonormal eigenvectors of A which form a complete or-
thonormal set. Then
âˆž
X
k=1
(Aek, ek)
=
âˆž
X
k=1
ï£«
ï£­A
ï£«
ï£­
âˆž
X
j=1
uj (ek, uj)
ï£¶
ï£¸,
âˆž
X
j=1
uj (ek, uj)
ï£¶
ï£¸
=
âˆž
X
k=1
X
ij
(Auj, ui) (ek, uj) (ui, ek)
=
âˆž
X
k=1
âˆž
X
j=1
(Auj, uj) |(ek, uj)|2
=
âˆž
X
j=1
(Auj, uj)
âˆž
X
k=1
|(ek, uj)|2 =
âˆž
X
j=1
(Auj, uj) |uj|2
=
âˆž
X
j=1
(Auj, uj) =
âˆž
X
j=1
Î»j
and this proves the theorem.
This is just like it is for a matrix. Recall the trace of a matrix is the sum of the
eigenvalues.
It is also easy to see that in any separable Hilbert space, there exist nuclear
operators. Let Pâˆž
k=1 |Î»k| < âˆž. Then let {ek} be a complete orthonormal set of
vectors. Let
A â‰¡
âˆž
X
k=1
Î»kek âŠ—ek.
It is not too hard to verify this works.
Much more can be said about nuclear operators.
14.6.3
Hilbert Schmidt Operators
Deï¬nition 14.39 Let H and G be two separable Hilbert spaces and let T map H
to G be linear. Then T is called a Hilbert Schmidt operator if there exists some
orthonormal basis for H, {ej} such that
X
j
||Tej||2 < âˆž.
The collection of all such linear maps will be denoted by L2 (H, G) .
Theorem 14.40 L2 (H, G) âŠ†L (H, G) and L2 (H, G) is a separable Hilbert space
with norm given by
||T||L2 â‰¡
ÃƒX
k
||Tek||2
!1/2

14.6.
COMPACT OPERATORS
391
where {ek} is some orthonormal basis for H. Also L2 (H, G) âŠ†L (H, G) and
||T|| â‰¤||T||L2 .
(14.33)
All Hilbert Schmidt opearators are compact. Also for X âˆˆH and Y âˆˆG, X âŠ—Y âˆˆ
L2 (H, G) and
||X âŠ—Y ||L2 = ||X||H ||Y ||G
(14.34)
Proof: First consider the norm. I need to verify the norm does not depend on
the choice of orthonormal basis. Let {fk} be an orthonormal basis for G. Then for
{ek} an orthonormal basis for H,
X
k
||Tek||2
=
X
k
X
j
|(Tek, fj)|2 =
X
k
X
j
|(ek, T âˆ—fj)|2
=
X
j
X
k
|(ek, T âˆ—fj)|2 =
X
j
||T âˆ—fj||2 .
The same result would be obtained for any other orthonormal basis
Â©
eâ€²
j
Âª
and this
shows the norm is at least well deï¬ned. It is clear this does indeed satisfy the axioms
of a norm.
Next I want to show L2 (H, G) âŠ†L (H, G) and ||T|| â‰¤||T||L2. Pick an orthonor-
mal basis for H, {ek} and an orthonormal basis for G, {fk}. Then letting
x =
n
X
k=1
xkek,
Tx = T
Ãƒ n
X
k=1
xkek
!
=
n
X
k=1
xkT (ek)

392
HILBERT SPACES
where xk â‰¡(x, ek). Therefore using Minkowskiâ€™s inequality,
||Tx||
=
Ãƒ âˆž
X
k=1
|(Tx, fk)|2
!1/2
=
ï£«
ï£¬
ï£­
âˆž
X
k=1
Â¯Â¯Â¯Â¯Â¯Â¯
ï£«
ï£­
n
X
j=1
xjTej, fk
ï£¶
ï£¸
Â¯Â¯Â¯Â¯Â¯Â¯
2ï£¶
ï£·
ï£¸
1/2
=
ï£«
ï£¬
ï£­
âˆž
X
k=1
Â¯Â¯Â¯Â¯Â¯Â¯
n
X
j=1
(xjTej, ek)
Â¯Â¯Â¯Â¯Â¯Â¯
2ï£¶
ï£·
ï£¸
1/2
â‰¤
n
X
j=1
Ãƒ âˆž
X
k=1
|(xjTej, ek)|2
!1/2
â‰¤
X
j
|xj|
ÃƒX
k
|(Tej, ek)|2
!1/2
=
X
j
|xj| ||Tej|| â‰¤
ï£«
ï£­
n
X
j=1
|xj|2
ï£¶
ï£¸
1/2
||T||L2
=
||x|| ||T||L2
Therefore, since ï¬nite sums of the form Pn
k=1 xkek are dense in H, it follows T âˆˆ
L (H, G) and ||T|| â‰¤||T||L2 and this proves the above claims.
It only remains to verify L2 (H, G) is a separable Hilbert space. It is clear it is
an inner product space because you only have to pick an orthonormal basis, {ek}
and deï¬ne the inner product as
(S, T) â‰¡
X
k
(Sek, Tek) .
The only remaining issue is the completeness. Suppose then that {Tn} is a Cauchy
sequence in L2 (H, G) . Then from 14.33 {Tn} is a Cauchy sequence in L (H, G) and
so there exists a unique T such that limnâ†’âˆž||Tn âˆ’T|| = 0. Then it only remains
to verify T âˆˆL2 (H, G) . But by Fatouâ€™s lemma,
X
k
||Tek||2
â‰¤
lim inf
nâ†’âˆž
X
k
||Tnek||2
=
lim inf
nâ†’âˆž||Tn||2
L2 < âˆž.
All that remains is to verify L2 (H, G) is separable and these Hilbert Schmidt
operators are compact. I will show an orthonormal basis for L2 (H, G) is {fj âŠ—ek}

14.6.
COMPACT OPERATORS
393
where {fk} is an orthonormal basis for G and {ek} is an orthonormal basis for H.
Here, for f âˆˆG and e âˆˆH,
f âŠ—e (x) â‰¡(x, e) f.
I need to show fj âŠ—ek âˆˆL2 (H, G) and that it is an orthonormal basis for
L2 (H, G) as claimed.
X
k
||fj âŠ—ei (ek)||2 =
X
k
||fjÎ´ik||2 = ||fj||2 = 1 < âˆž
so each of these operators is in L2 (H, G). Next I show they are orthonormal.
(fj âŠ—ek, fs âŠ—er)
=
X
p
(fj âŠ—ek (ep) , fs âŠ—er (ep))
=
X
p
Î´rpÎ´kp (fj, fs) =
X
p
Î´rpÎ´kpÎ´js
If j = s and k = r this reduces to 1. Otherwise, this gives 0. Thus these operators
are orthonormal. Now let T âˆˆL2 (H, G). Consider
Tn â‰¡
n
X
i=1
n
X
j=1
(Tei, fj) fj âŠ—ei
Then
Tnek
=
n
X
i=1
n
X
j=1
(Tei, fj) (ek, ei) fj
=
n
X
j=1
(Tek, fj) fj
It follows
||Tnek|| â‰¤||Tek||
and
lim
nâ†’âˆžTnek = Tek.
Therefore, from the dominated convergence theorem,
lim
nâ†’âˆž||T âˆ’Tn||2
L2 â‰¡lim
nâ†’âˆž
X
k
||(T âˆ’Tn) ek||2 = 0.
Therefore, the linear combinations of the fj âŠ—ei are dense in L2 (H, G) and this
proves completeness.
This also shows L2 (H, G) is separable. From 14.33 it also shows that every
T âˆˆL2 (H, G) is the limit in the operator norm of a sequence of compact operators.
This follows because each of the fj âŠ—ei is easily seen to be a compact operator.

394
HILBERT SPACES
(This follows because each of the fj âŠ—ei is easily seen to be a compact operator
because if xm â†’x weakly, then
fj âŠ—ei (xm) = (xm, ei) fj â†’(x, ei) fj = fj âŠ—ei (x)
and since if {xm} is any bounded sequence, there exists a subsequence, {xnk} which
converges weakly and by the above, fj âŠ—ei (xnk) â†’fj âŠ—ei (x) showing bounded
sets are mapped to precompact sets.) Therefore, each T âˆˆL2 (H, G) must also be
a compact operator. Here is why.
Let B be a bounded set in which ||x|| < M for all x âˆˆB and consider TB. I
need to show TB is totally bounded. Let Îµ > 0 be given. Then let ||Tm âˆ’T|| <
Îµ
3M
where Tm is a compact operator like those described above and let {Tmxj}N
j=1 be
an Îµ/3 net for Tm (B) . Then
||Txj âˆ’Tmxj|| < Îµ
3
and so letting x âˆˆB, pick xj such that ||Tmx âˆ’Tmxj|| < Îµ/3. Then
||Tx âˆ’Txj||
â‰¤
||Tx âˆ’Tmx|| + ||Tmx âˆ’Tmxj|| + ||Tmxj âˆ’Txj||
<
Îµ
3 + Îµ
3 + Îµ
3 = Îµ
showing {Txj}N
j=1 is an Îµ net for TB.
Finally, consider 14.34. Let {ek} be an orthonormal basis for H and consider
the following computation which establishes which establishes this equation.
||Y âŠ—X||2
L2
â‰¡
âˆž
X
k=1
||Y âŠ—X (ek)||2
=
âˆž
X
k=1
||(ek, X) Y ||2
=
||Y ||2
G
âˆž
X
k=1
|(ek, X)|2
=
||Y ||2
G ||X||2
H < âˆž.
(14.35)
This proves the theorem.
14.7
Compact Operators In Banach Space
In general for A âˆˆL (X, Y ) the following deï¬nition holds.
Deï¬nition 14.41 Let A âˆˆL (X, Y ) . Then A is compact if whenever B âŠ†X is a
bounded set, AB is precompact. Equivalently, if {xn} is a bounded sequence in X,
then {Axn} has a subsequence which converges in Y.

14.7.
COMPACT OPERATORS IN BANACH SPACE
395
An important result is the following theorem about the adjoint of a compact
operator.
Theorem 14.42 Let A âˆˆL (X, Y ) be compact. Then the adjoint operator, Aâˆ—âˆˆ
L (Y â€², Xâ€²) is also compact.
Proof: Let {yâˆ—
n} be a bounded sequence in Y â€². Let B be the closure of the
unit ball in X. Then AB is precompact. Then it is clear that the functions {yâˆ—
n}
are equicontinuous and uniformly bounded on the compact set, A (B). By the As-
coli Arzela theorem, there is a subsequence
Â©
yâˆ—
nk
Âª
which converges uniformly to a
continuous function, f on A (B). Now deï¬ne g on AX by
g (Ax) = ||x|| f
Âµ
A
Âµ x
||x||
Â¶Â¶
, g (A0) = 0.
Thus for x1, x2 Ì¸= 0, and a, b scalars,
g (aAx1 + bAx2)
â‰¡
||ax1 + bx2|| f
ÂµA (ax1 + bx2)
||ax1 + bx2||
Â¶
â‰¡
lim
kâ†’âˆž||ax1 + bx2|| yâˆ—
nk
ÂµA (ax1 + bx2)
||ax1 + bx2||
Â¶
=
lim
kâ†’âˆžayâˆ—
nk (Ax1) + byâˆ—
nk (Ax2)
=
a lim
kâ†’âˆž||x1|| yâˆ—
nk
Âµ Ax1
||x1||
Â¶
+ b lim
kâ†’âˆž||x2|| yâˆ—
nk
Âµ Ax2
||x2||
Â¶
=
a ||x1|| f
Âµ Ax1
||x1||
Â¶
+ b ||x2|| f
Âµ Ax2
||x2||
Â¶
â‰¡
ag (Ax1) + bg (Ax2)
showing that g is linear on AX. Also
|g (Ax)| = lim
kâ†’âˆž
Â¯Â¯Â¯Â¯||x|| yâˆ—
nk
Âµ
A
Âµ x
||x||
Â¶Â¶Â¯Â¯Â¯Â¯ â‰¤C ||x||
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯A
Âµ x
||x||
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ = C ||Ax||
and so by the Hahn Banach theorem, there exists yâˆ—extending g to all of Y having
the same operator norm.
yâˆ—(Ax) = lim
kâ†’âˆž||x|| yâˆ—
nk
Âµ
A
Âµ x
||x||
Â¶Â¶
= lim
kâ†’âˆžyâˆ—
nk (Ax)
Thus Aâˆ—yâˆ—
nk (x) â†’Aâˆ—yâˆ—(x) for every x. In addition to this, for x âˆˆB,
Â¯Â¯Â¯Â¯Aâˆ—yâˆ—(x) âˆ’Aâˆ—yâˆ—
nk (x)
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯yâˆ—(Ax) âˆ’yâˆ—
nk (Ax)
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯g (Ax) âˆ’yâˆ—
nk (Ax)
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯||x|| f
Âµ
A
Âµ x
||x||
Â¶Â¶
âˆ’||x|| yâˆ—
nk
Âµ Ax
||x||
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯f
Âµ
A
Âµ x
||x||
Â¶Â¶
âˆ’yâˆ—
nk
Âµ Ax
||x||
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯

396
HILBERT SPACES
and this is uniformly small for large k due to the uniform convergence of yâˆ—
nk to f
on A (B). Therefore,
Â¯Â¯Â¯Â¯Aâˆ—yâˆ—âˆ’Aâˆ—yâˆ—
nk
Â¯Â¯Â¯Â¯ â†’0.
14.8
The Fredholm Alternative
Recall that if A is an n Ã— n matrix and if the only solution to the system, Ax = 0
is x = 0 then for any y âˆˆRn it follows that there exists a unique solution to the
system Ax = y. This holds because the ï¬rst condition implies A is one to one and
therefore, Aâˆ’1 exists. Of course things are much harder in a general Banach space.
Here is a simple example for a Hilbert space.
Example 14.43 Let L2 (N; Âµ) = H where Âµ is counting measure. Thus an element
of H is a sequence, a = {ai}âˆž
i=1 having the property that
||a||H â‰¡
Ãƒ âˆž
X
k=1
|ak|2
!1/2
< âˆž.
Deï¬ne A : H â†’H by
Aa â‰¡b â‰¡{0, a1, a2, Â· Â· Â·} .
Thus A slides the sequence to the right and puts a zero in the ï¬rst slot. Clearly A is
one to one and linear but it cannot be onto because it fails to yield e1 â‰¡{1, 0, 0, Â· Â· Â·}.
Notwithstanding the above example, there are theorems which are like the linear
algebra theorem mentioned above which hold in an arbitrary Banach spaces in the
case where the operator is compact. To begin with here is an interesting lemma.
Lemma 14.44 Suppose A âˆˆL (X, X) is compact for X
a Banach space. Then
(I âˆ’A) (X) is a closed subspace of X.
Proof: Suppose (I âˆ’A) xn â†’y. Let
Î±n â‰¡dist (xn, ker (I âˆ’A))
and let zn âˆˆker (I âˆ’A) be such that
Î±n â‰¤||xn âˆ’zn|| â‰¤
Âµ
1 + 1
n
Â¶
Î±n.
Thus (I âˆ’A) (xn âˆ’zn) â†’y because (I âˆ’A) zn = 0.
Case 1: {xn âˆ’zn} has a bounded subsequence.
If this is so, the compactness of A implies there exists a subsequence, still denoted
by n such that {A (xn âˆ’zn)}âˆž
n=1 is a Cauchy sequence. Since (I âˆ’A) (xn âˆ’zn) â†’y,
this implies {(xn âˆ’zn)} is also a Cauchy sequence converging to a point, x âˆˆX.
Then, taking the limit as n â†’âˆž, (I âˆ’A) x = y and so y âˆˆ(I âˆ’A) (X).
Case 2: limnâ†’âˆž||xn âˆ’zn|| = âˆž. I will show this case cannot occur.

14.8.
THE FREDHOLM ALTERNATIVE
397
In this case, let wn â‰¡
xnâˆ’zn
||xnâˆ’zn||.
Thus (I âˆ’A) wn â†’0 and wn is bounded.
Therefore, there exists a subsequence, still denoted by n such that {Awn} is a
Cauchy sequence. Now it follows
Awn âˆ’Awm + en âˆ’em = wn âˆ’wm
where ek â†’0 as k â†’âˆž. This implies {wn} is a Cauchy sequence which must
converge to some wâˆžâˆˆX. Therefore, (I âˆ’A) wâˆž= 0 and so wâˆžâˆˆker (I âˆ’A).
However, this is impossible because of the following argument. If z âˆˆker (I âˆ’A),
||wn âˆ’z||
=
1
||xn âˆ’zn|| ||xn âˆ’zn âˆ’||xn âˆ’zn|| z||
â‰¥
1
||xn âˆ’zn||Î±n â‰¥
Î±n
Â¡
1 + 1
n
Â¢
Î±n
=
n
n + 1.
Taking the limit, ||wâˆžâˆ’z|| â‰¥1. Since z âˆˆker (I âˆ’A) is arbitrary, this shows
dist (wâˆž, ker (I âˆ’A)) â‰¥1.
Since Case 2 does not occur, this proves the lemma.
Theorem 14.45 Let A âˆˆL (X, X) be a compact operator and let f âˆˆX. Then
there exists a solution, x, to
x âˆ’Ax = f
(14.36)
if and only if
xâˆ—(f) = 0
(14.37)
for all xâˆ—âˆˆker (I âˆ’Aâˆ—) .
Proof: Suppose x is a solution to 14.36 and let xâˆ—âˆˆker (I âˆ’Aâˆ—). Then
xâˆ—(f) = xâˆ—((I âˆ’A) (x)) = ((I âˆ’Aâˆ—) xâˆ—) (x) = 0.
Next suppose xâˆ—(f) = 0 for all xâˆ—âˆˆker (I âˆ’Aâˆ—) . I will show there exists x
solving 14.36. By Lemma 14.44, (I âˆ’A) (X) is a closed subspace of X. Is f âˆˆ
(I âˆ’A) (X)? If not, then by the Hahn Banach theorem, there exists xâˆ—âˆˆXâ€² such
that xâˆ—(f) Ì¸= 0 but xâˆ—((I âˆ’A) (x)) = 0 for all x âˆˆX. However last statement says
nothing more nor less than (I âˆ’Aâˆ—) xâˆ—= 0. This is a contradiction because for such
xâˆ—, it is given that xâˆ—(f) = 0. This proves the theorem.
The following corollary is called the Fredholm alternative.
Corollary 14.46 Let A âˆˆL (X, X) be a compact operator. Then there exists a
solution to the equation
x âˆ’Ax = f
(14.38)
for all f âˆˆX if and only if (I âˆ’Aâˆ—) is one to one on Xâ€².

398
HILBERT SPACES
Proof: Suppose (I âˆ’Aâˆ—) is one to one ï¬rst. Then if xâˆ—âˆ’Aâˆ—xâˆ—= 0 it follows
xâˆ—= 0 and so for any f âˆˆX, xâˆ—(f) = 0 for all xâˆ—âˆˆker (I âˆ’Aâˆ—) . By 14.45 there
exists a solution to (I âˆ’A) x = f.
Now suppose there exists a solution, x, to (I âˆ’A) x = f for every f âˆˆX. If
(I âˆ’Aâˆ—) xâˆ—= 0, then for every x âˆˆX,
(I âˆ’Aâˆ—) xâˆ—(x) = xâˆ—((I âˆ’A) (x)) = 0
Since (I âˆ’A) is onto, this shows xâˆ—= 0 and so (I âˆ’Aâˆ—) is one to one as claimed.
This proves the corollary.
The following is just an easier version of the above.
Corollary 14.47 In the case where X is a Hilbert space, the conclusions of Corol-
lary 14.46, Theorem 14.45, and Lemma 14.44 remain true if Hâ€² is replaced by H
and the adjoint is understood in the usual manner for Hilbert space. That is
(Ax, y)H = (x, Aâˆ—y)H

Representation Theorems
15.1
Radon Nikodym Theorem
This chapter is on various representation theorems. The ï¬rst theorem, the Radon
Nikodym Theorem, is a representation theorem for one measure in terms of an-
other. The approach given here is due to Von Neumann and depends on the Riesz
representation theorem for Hilbert space, Theorem 14.14 on Page 370.
Deï¬nition 15.1 Let Âµ and Î» be two measures deï¬ned on a Ïƒ-algebra, S, of subsets
of a set, â„¦.
Î» is absolutely continuous with respect to Âµ,written as Î» â‰ªÂµ, if
Î»(E) = 0 whenever Âµ(E) = 0.
It is not hard to think of examples which should be like this.
For example,
suppose one measure is volume and the other is mass. If the volume of something
is zero, it is reasonable to expect the mass of it should also be equal to zero. In
this case, there is a function called the density which is integrated over volume to
obtain mass. The Radon Nikodym theorem is an abstract version of this notion.
Essentially, it gives the existence of the density function.
Theorem 15.2 (Radon Nikodym) Let Î» and Âµ be ï¬nite measures deï¬ned on a Ïƒ-
algebra, S, of subsets of â„¦. Suppose Î» â‰ªÂµ. Then there exists a unique f âˆˆL1(â„¦, Âµ)
such that f(x) â‰¥0 and
Î»(E) =
Z
E
f dÂµ.
If it is not necessarily the case that Î» â‰ªÂµ, there are two measures, Î»âŠ¥and Î»|| such
that Î» = Î»âŠ¥+ Î»||, Î»|| â‰ªÂµ and there exists a set of Âµ measure zero, N such that for
all E measurable, Î»âŠ¥(E) = Î» (E âˆ©N) = Î»âŠ¥(E âˆ©N) . In this case the two mesures,
Î»âŠ¥and Î»|| are unique and the representation of Î» = Î»âŠ¥+ Î»|| is called the Lebesgue
decomposition of Î». The measure Î»|| is the absolutely continuous part of Î» and Î»âŠ¥
is called the singular part of Î».
Proof: Let Î› : L2(â„¦, Âµ + Î») â†’C be deï¬ned by
Î›g =
Z
â„¦
g dÎ».
399

400
REPRESENTATION THEOREMS
By Holderâ€™s inequality,
|Î›g| â‰¤
ÂµZ
â„¦
12dÎ»
Â¶1/2 ÂµZ
â„¦
|g|2 d (Î» + Âµ)
Â¶1/2
= Î» (â„¦)1/2 ||g||2
where ||g||2 is the L2 norm of g taken with respect to Âµ + Î». Therefore, since Î›
is bounded, it follows from Theorem 13.4 on Page 339 that Î› âˆˆ(L2(â„¦, Âµ + Î»))â€²,
the dual space L2(â„¦, Âµ + Î»). By the Riesz representation theorem in Hilbert space,
Theorem 14.14, there exists a unique h âˆˆL2(â„¦, Âµ + Î») with
Î›g =
Z
â„¦
g dÎ» =
Z
â„¦
hgd(Âµ + Î»).
(15.1)
The plan is to show h is real and nonnegative at least a.e. Therefore, consider the
set where Im h is positive.
E = {x âˆˆâ„¦: Im h(x) > 0} ,
Now let g = XE and use 15.1 to get
Î»(E) =
Z
E
(Re h + i Im h)d(Âµ + Î»).
(15.2)
Since the left side of 15.2 is real, this shows
0
=
Z
E
(Im h) d(Âµ + Î»)
â‰¥
Z
En
(Im h) d(Âµ + Î»)
â‰¥
1
n (Âµ + Î») (En)
where
En â‰¡
Â½
x : Im h (x) â‰¥1
n
Â¾
Thus (Âµ + Î») (En) = 0 and since E = âˆªâˆž
n=1En, it follows (Âµ + Î») (E) = 0. A similar
argument shows that for
E = {x âˆˆâ„¦: Im h (x) < 0},
(Âµ + Î»)(E) = 0. Thus there is no loss of generality in assuming h is real-valued.
The next task is to show h is nonnegative. This is done in the same manner as
above. Deï¬ne the set where it is negative and then show this set has measure zero.
Let E â‰¡{x : h(x) < 0} and let En â‰¡{x : h(x) < âˆ’1
n}. Then let g = XEn. Since
E = âˆªnEn, it follows that if (Âµ + Î») (E) > 0 then this is also true for (Âµ + Î») (En)
for all n large enough. Then from 15.2
Î»(En) =
Z
En
h d(Âµ + Î») â‰¤âˆ’(1/n) (Âµ + Î») (En) < 0,

15.1.
RADON NIKODYM THEOREM
401
a contradiction. Thus it can be assumed h â‰¥0.
At this point the argument splits into two cases.
Case Where Î» â‰ªÂµ.
In this case, h < 1. Let E = [h â‰¥1] and let g = XE. Then
Î»(E) =
Z
E
h d(Âµ + Î») â‰¥Âµ(E) + Î»(E).
Therefore Âµ(E) = 0. Since Î» â‰ªÂµ, it follows that Î»(E) = 0 also. Thus it can be
assumed
0 â‰¤h(x) < 1
for all x.
From 15.1, whenever g âˆˆL2(â„¦, Âµ + Î»),
Z
â„¦
g(1 âˆ’h)dÎ» =
Z
â„¦
hgdÂµ.
(15.3)
Now let E be a measurable set and deï¬ne
g(x) â‰¡
n
X
i=0
hi(x)XE(x)
in 15.3. This yields
Z
E
(1 âˆ’hn+1(x))dÎ» =
Z
E
n+1
X
i=1
hi(x)dÂµ.
(15.4)
Let f(x) = Pâˆž
i=1 hi(x) and use the Monotone Convergence theorem in 15.4 to let
n â†’âˆžand conclude
Î»(E) =
Z
E
f dÂµ.
f âˆˆL1(â„¦, Âµ) because Î» is ï¬nite.
The function, f is unique Âµ a.e. because, if g is another function which also
serves to represent Î», consider for each n âˆˆN the set,
En â‰¡
Â·
f âˆ’g > 1
n
Â¸
and conclude that
0 =
Z
En
(f âˆ’g) dÂµ â‰¥1
nÂµ (En) .
Therefore, Âµ (En) = 0. It follows that
Âµ ([f âˆ’g > 0]) â‰¤
âˆž
X
n=1
Âµ (En) = 0

402
REPRESENTATION THEOREMS
Similarly, the set where g is larger than f has measure zero.
This proves the
theorem.
Case where it is not necessarily true that Î» â‰ªÂµ.
In this case, let N = [h â‰¥1] and let g = XN. Then
Î»(N) =
Z
N
h d(Âµ + Î») â‰¥Âµ(N) + Î»(N).
and so Âµ (N) = 0 and so Âµ (E) = Âµ
Â¡
E âˆ©N CÂ¢
. Now deï¬ne a measure, Î»âŠ¥by
Î»âŠ¥(E) â‰¡Î» (E âˆ©N)
so
Î»âŠ¥(E âˆ©N) â‰¡Î» (E âˆ©N âˆ©N) = Î» (E âˆ©N) â‰¡Î»âŠ¥(E)
and let Î»|| â‰¡Î» âˆ’Î»âŠ¥. Thus,
Î»|| (E) = Î» (E) âˆ’Î»âŠ¥(E) â‰¡Î» (E) âˆ’Î» (E âˆ©N) = Î»
Â¡
E âˆ©N CÂ¢
.
Suppose now that Î»|| (E) > 0. It follows from the ï¬rst part of the proof that since
h < 1 on N C
0
<
Î»|| (E) = Î»
Â¡
E âˆ©N CÂ¢
=
Z
Eâˆ©N C h d(Âµ + Î»)
<
Âµ
Â¡
E âˆ©N CÂ¢
+ Î»
Â¡
E âˆ©N CÂ¢
= Âµ (E) + Î»|| (E)
which shows that Âµ (E) > 0. Thus if Âµ (E) = 0 it follows Î»|| (E) = 0 and so Î»|| â‰ªÂµ.
It only remains to verify the two measures Î»âŠ¥and Î»|| are unique. Suppose then
that Î½1 and Î½2 play the roles of Î»âŠ¥and Î»|| respectively. Let N1 play the role of N
in the deï¬nition of Î½1 and let g1 play the role of g for Î½2. I will show that g = g1 Âµ
a.e. Let Ek â‰¡[g1 âˆ’g > 1/k] for k âˆˆN. Then on observing that Î»âŠ¥âˆ’Î½1 = Î½2 âˆ’Î»||
0
=
(Î»âŠ¥âˆ’Î½1)
Â³
En âˆ©(N1 âˆªN)CÂ´
=
Z
Enâˆ©(N1âˆªN)C (g1 âˆ’g) dÂµ
â‰¥
1
k Âµ
Â³
Ek âˆ©(N1 âˆªN)CÂ´
= 1
k Âµ (Ek) .
and so Âµ (Ek) = 0. Therefore, Âµ ([g1 âˆ’g > 0]) = 0 because [g1 âˆ’g > 0] = âˆªâˆž
k=1Ek.
It follows g1 â‰¤g Âµ a.e. Similarly, g â‰¥g1 Âµ a.e. Therefore, Î½2 = Î»|| and so Î»âŠ¥= Î½1
also. This proves the theorem.
The f in the theorem for the absolutely continuous case is sometimes denoted
by dÎ»
dÂµ and is called the Radon Nikodym derivative.
The next corollary is a useful generalization to Ïƒ ï¬nite measure spaces.
Corollary 15.3 Suppose Î» â‰ªÂµ and there exist sets Sn âˆˆS with
Sn âˆ©Sm = âˆ…, âˆªâˆž
n=1Sn = â„¦,

15.1.
RADON NIKODYM THEOREM
403
and Î»(Sn), Âµ(Sn) < âˆž. Then there exists f â‰¥0, where f is Âµ measurable, and
Î»(E) =
Z
E
f dÂµ
for all E âˆˆS. The function f is Âµ + Î» a.e. unique.
Proof: Deï¬ne the Ïƒ algebra of subsets of Sn,
Sn â‰¡{E âˆ©Sn : E âˆˆS}.
Then both Î», and Âµ are ï¬nite measures on Sn, and Î» â‰ªÂµ. Thus, by Theorem 15.2,
there exists a nonnegative Sn measurable function fn,with Î»(E) =
R
E fndÂµ for all
E âˆˆSn. Deï¬ne f(x) = fn(x) for x âˆˆSn. Since the Sn are disjoint and their union
is all of â„¦, this deï¬nes f on all of â„¦. The function, f is measurable because
f âˆ’1((a, âˆž]) = âˆªâˆž
n=1f âˆ’1
n ((a, âˆž]) âˆˆS.
Also, for E âˆˆS,
Î»(E)
=
âˆž
X
n=1
Î»(E âˆ©Sn) =
âˆž
X
n=1
Z
XEâˆ©Sn(x)fn(x)dÂµ
=
âˆž
X
n=1
Z
XEâˆ©Sn(x)f(x)dÂµ
By the monotone convergence theorem
âˆž
X
n=1
Z
XEâˆ©Sn(x)f(x)dÂµ
=
lim
Nâ†’âˆž
N
X
n=1
Z
XEâˆ©Sn(x)f(x)dÂµ
=
lim
Nâ†’âˆž
Z
N
X
n=1
XEâˆ©Sn(x)f(x)dÂµ
=
Z
âˆž
X
n=1
XEâˆ©Sn(x)f(x)dÂµ =
Z
E
f dÂµ.
This proves the existence part of the corollary.
To see f is unique, suppose f1 and f2 both work and consider for n âˆˆN
Ek â‰¡
Â·
f1 âˆ’f2 > 1
k
Â¸
.
Then
0 = Î»(Ek âˆ©Sn) âˆ’Î»(Ek âˆ©Sn) =
Z
Ekâˆ©Sn
f1(x) âˆ’f2(x)dÂµ.
Hence Âµ(Ek âˆ©Sn) = 0 for all n so
Âµ(Ek) = lim
nâ†’âˆžÂµ(E âˆ©Sn) = 0.

404
REPRESENTATION THEOREMS
Hence Âµ([f1 âˆ’f2 > 0]) â‰¤Pâˆž
k=1 Âµ (Ek) = 0. Therefore, Î» ([f1 âˆ’f2 > 0]) = 0 also.
Similarly
(Âµ + Î») ([f1 âˆ’f2 < 0]) = 0.
This version of the Radon Nikodym theorem will suï¬ƒce for most applications,
but more general versions are available.
To see one of these, one can read the
treatment in Hewitt and Stromberg [26]. This involves the notion of decomposable
measure spaces, a generalization of Ïƒ ï¬nite.
Not surprisingly, there is a simple generalization of the Lebesgue decomposition
part of Theorem 15.2.
Corollary 15.4 Let (â„¦, S) be a set with a Ïƒ algebra of sets. Suppose Î» and Âµ are
two measures deï¬ned on the sets of S and suppose there exists a sequence of disjoint
sets of S, {â„¦i}âˆž
i=1 such that Î» (â„¦i) , Âµ (â„¦i) < âˆž. Then there is a set of Âµ measure
zero, N and measures Î»âŠ¥and Î»|| such that
Î»âŠ¥+ Î»|| = Î», Î»|| â‰ªÂµ, Î»âŠ¥(E) = Î» (E âˆ©N) = Î»âŠ¥(E âˆ©N) .
Proof: Let Si â‰¡{E âˆ©â„¦i : E âˆˆS} and for E âˆˆSi, let Î»i (E) = Î» (E) and
Âµi (E) = Âµ (E) . Then by Theorem 15.2 there exist unique measures Î»i
âŠ¥and Î»i
||
such that Î»i = Î»i
âŠ¥+ Î»i
||, a set of Âµi measure zero, Ni âˆˆSi such that for all E âˆˆSi,
Î»i
âŠ¥(E) = Î»i (E âˆ©Ni) and Î»i
|| â‰ªÂµi. Deï¬ne for E âˆˆS
Î»âŠ¥(E) â‰¡
X
i
Î»i
âŠ¥(E âˆ©â„¦i) , Î»|| (E) â‰¡
X
i
Î»i
|| (E âˆ©â„¦i) , N â‰¡âˆªiNi.
First observe that Î»âŠ¥and Î»|| are measures.
Î»âŠ¥
Â¡
âˆªâˆž
j=1Ej
Â¢
â‰¡
X
i
Î»i
âŠ¥
Â¡
âˆªâˆž
j=1Ej âˆ©â„¦i
Â¢
=
X
i
X
j
Î»i
âŠ¥(Ej âˆ©â„¦i)
=
X
j
X
i
Î»i
âŠ¥(Ej âˆ©â„¦i) =
X
j
X
i
Î» (Ej âˆ©â„¦i âˆ©Ni)
=
X
j
X
i
Î»i
âŠ¥(Ej âˆ©â„¦i) =
X
j
Î»âŠ¥(Ej) .
The argument for Î»|| is similar. Now
Âµ (N) =
X
i
Âµ (N âˆ©â„¦i) =
X
i
Âµi (Ni) = 0
and
Î»âŠ¥(E)
â‰¡
X
i
Î»i
âŠ¥(E âˆ©â„¦i) =
X
i
Î»i (E âˆ©â„¦i âˆ©Ni)
=
X
i
Î» (E âˆ©â„¦i âˆ©N) = Î» (E âˆ©N) .

15.2.
VECTOR MEASURES
405
Also if Âµ (E) = 0, then Âµi (E âˆ©â„¦i) = 0 and so Î»i
|| (E âˆ©â„¦i) = 0. Therefore,
Î»|| (E) =
X
i
Î»i
|| (E âˆ©â„¦i) = 0.
The decomposition is unique because of the uniqueness of the Î»i
|| and Î»i
âŠ¥and the
observation that some other decomposition must coincide with the given one on the
â„¦i.
15.2
Vector Measures
The next topic will use the Radon Nikodym theorem. It is the topic of vector and
complex measures. The main interest is in complex measures although a vector
measure can have values in any topological vector space. Whole books have been
written on this subject. See for example the book by Diestal and Uhl [16] titled
Vector measures.
Deï¬nition 15.5 Let (V, ||Â·||) be a normed linear space and let (â„¦, S) be a measure
space. A function Âµ : S â†’V is a vector measure if Âµ is countably additive. That
is, if {Ei}âˆž
i=1 is a sequence of disjoint sets of S,
Âµ(âˆªâˆž
i=1Ei) =
âˆž
X
i=1
Âµ(Ei).
Note that it makes sense to take ï¬nite sums because it is given that Âµ has
values in a vector space in which vectors can be summed. In the above, Âµ (Ei) is a
vector. It might be a point in Rn or in any other vector space. In many of the most
important applications, it is a vector in some sort of function space which may be
inï¬nite dimensional. The inï¬nite sum has the usual meaning. That is
âˆž
X
i=1
Âµ(Ei) = lim
nâ†’âˆž
n
X
i=1
Âµ(Ei)
where the limit takes place relative to the norm on V .
Deï¬nition 15.6 Let (â„¦, S) be a measure space and let Âµ be a vector measure deï¬ned
on S. A subset, Ï€(E), of S is called a partition of E if Ï€(E) consists of ï¬nitely
many disjoint sets of S and âˆªÏ€(E) = E. Let
|Âµ|(E) = sup{
X
F âˆˆÏ€(E)
||Âµ(F)|| : Ï€(E) is a partition of E}.
|Âµ| is called the total variation of Âµ.
The next theorem may seem a little surprising. It states that, if ï¬nite, the total
variation is a nonnegative measure.

406
REPRESENTATION THEOREMS
Theorem 15.7 If |Âµ|(â„¦) < âˆž, then |Âµ| is a measure on S.
Even if |Âµ| (â„¦) =
âˆž, |Âµ| (âˆªâˆž
i=1Ei) â‰¤Pâˆž
i=1 |Âµ| (Ei) . That is |Âµ| is subadditive and |Âµ| (A) â‰¤|Âµ| (B)
whenever A, B âˆˆS with A âŠ†B.
Proof: Consider the last claim. Let a < |Âµ| (A) and let Ï€ (A) be a partition of
A such that
a <
X
F âˆˆÏ€(A)
||Âµ (F)|| .
Then Ï€ (A) âˆª{B \ A} is a partition of B and
|Âµ| (B) â‰¥
X
F âˆˆÏ€(A)
||Âµ (F)|| + ||Âµ (B \ A)|| > a.
Since this is true for all such a, it follows |Âµ| (B) â‰¥|Âµ| (A) as claimed.
Let {Ej}âˆž
j=1 be a sequence of disjoint sets of S and let Eâˆž= âˆªâˆž
j=1Ej. Then
letting a < |Âµ| (Eâˆž) , it follows from the deï¬nition of total variation there exists a
partition of Eâˆž, Ï€(Eâˆž) = {A1, Â· Â· Â·, An} such that
a <
n
X
i=1
||Âµ(Ai)||.
Also,
Ai = âˆªâˆž
j=1Ai âˆ©Ej
and so by the triangle inequality, ||Âµ(Ai)|| â‰¤Pâˆž
j=1 ||Âµ(Ai âˆ©Ej)||. Therefore, by the
above, and either Fubiniâ€™s theorem or Lemma 8.21 on Page 184
a
<
n
X
i=1
â‰¥||Âµ(Ai)||
z
}|
{
âˆž
X
j=1
||Âµ(Ai âˆ©Ej)||
=
âˆž
X
j=1
n
X
i=1
||Âµ(Ai âˆ©Ej)||
â‰¤
âˆž
X
j=1
|Âµ|(Ej)
because {Ai âˆ©Ej}n
i=1 is a partition of Ej.
Since a is arbitrary, this shows
|Âµ|(âˆªâˆž
j=1Ej) â‰¤
âˆž
X
j=1
|Âµ|(Ej).
If the sets, Ej are not disjoint, let F1 = E1 and if Fn has been chosen, let Fn+1 â‰¡
En+1 \ âˆªn
i=1Ei. Thus the sets, Fi are disjoint and âˆªâˆž
i=1Fi = âˆªâˆž
i=1Ei. Therefore,
|Âµ|
Â¡
âˆªâˆž
j=1Ej
Â¢
= |Âµ|
Â¡
âˆªâˆž
j=1Fj
Â¢
â‰¤
âˆž
X
j=1
|Âµ| (Fj) â‰¤
âˆž
X
j=1
|Âµ| (Ej)

15.2.
VECTOR MEASURES
407
and proves |Âµ| is always subadditive as claimed regarless of whether |Âµ| (â„¦) < âˆž.
Now suppose |Âµ| (â„¦) < âˆžand let E1 and E2 be sets of S such that E1 âˆ©E2 = âˆ…
and let {Ai
1 Â· Â· Â· Ai
ni} = Ï€(Ei), a partition of Ei which is chosen such that
|Âµ| (Ei) âˆ’Îµ <
ni
X
j=1
||Âµ(Ai
j)|| i = 1, 2.
Such a partition exists because of the deï¬nition of the total variation. Consider the
sets which are contained in either of Ï€ (E1) or Ï€ (E2) , it follows this collection of
sets is a partition of E1 âˆªE2 denoted by Ï€(E1 âˆªE2). Then by the above inequality
and the deï¬nition of total variation,
|Âµ|(E1 âˆªE2) â‰¥
X
F âˆˆÏ€(E1âˆªE2)
||Âµ(F)|| > |Âµ| (E1) + |Âµ| (E2) âˆ’2Îµ,
which shows that since Îµ > 0 was arbitrary,
|Âµ|(E1 âˆªE2) â‰¥|Âµ|(E1) + |Âµ|(E2).
(15.5)
Then 15.5 implies that whenever the Ei are disjoint, |Âµ|(âˆªn
j=1Ej) â‰¥Pn
j=1 |Âµ|(Ej).
Therefore,
âˆž
X
j=1
|Âµ|(Ej) â‰¥|Âµ|(âˆªâˆž
j=1Ej) â‰¥|Âµ|(âˆªn
j=1Ej) â‰¥
n
X
j=1
|Âµ|(Ej).
Since n is arbitrary,
|Âµ|(âˆªâˆž
j=1Ej) =
âˆž
X
j=1
|Âµ|(Ej)
which shows that |Âµ| is a measure as claimed. This proves the theorem.
In the case that Âµ is a complex measure, it is always the case that |Âµ| (â„¦) < âˆž.
Theorem 15.8 Suppose Âµ is a complex measure on (â„¦, S) where S is a Ïƒ algebra
of subsets of â„¦. That is, whenever, {Ei} is a sequence of disjoint sets of S,
Âµ (âˆªâˆž
i=1Ei) =
âˆž
X
i=1
Âµ (Ei) .
Then |Âµ| (â„¦) < âˆž.
Proof: First here is a claim.
Claim: Suppose |Âµ| (E) = âˆž. Then there are subsets of E, A and B such that
E = A âˆªB, |Âµ (A)| , |Âµ (B)| > 1 and |Âµ| (B) = âˆž.
Proof of the claim: From the deï¬nition of |Âµ| , there exists a partition of
E, Ï€ (E) such that
X
F âˆˆÏ€(E)
|Âµ (F)| > 20 (1 + |Âµ (E)|) .
(15.6)

408
REPRESENTATION THEOREMS
Here 20 is just a nice sized number. No eï¬€ort is made to be delicate in this argument.
Also note that Âµ (E) âˆˆC because it is given that Âµ is a complex measure. Consider
the following picture consisting of two lines in the complex plane having slopes 1
and -1 which intersect at the origin, dividing the complex plane into four closed
sets, R1, R2, R3, and R4 as shown.
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡Â¡
@
@
@
@
@
@
@
@
@@
R1
R2
R3
R4
Let Ï€i consist of those sets, A of Ï€ (E) for which Âµ (A) âˆˆRi. Thus, some sets,
A of Ï€ (E) could be in two of the Ï€i if Âµ (A) is on one of the intersecting lines. This
is not important. The thing which is important is that if Âµ (A) âˆˆR1 or R3, then
âˆš
2
2 |Âµ (A)| â‰¤|Re (Âµ (A))| and if Âµ (A) âˆˆR2 or R4 then
âˆš
2
2 |Âµ (A)| â‰¤|Im (Âµ (A))| and
Re (z) has the same sign for z in R1 and R3 while Im (z) has the same sign for z in
R2 or R4. Then by 15.6, it follows that for some i,
X
F âˆˆÏ€i
|Âµ (F)| > 5 (1 + |Âµ (E)|) .
(15.7)
Suppose i equals 1 or 3. A similar argument using the imaginary part applies if i
equals 2 or 4. Then,
Â¯Â¯Â¯Â¯Â¯
X
F âˆˆÏ€i
Âµ (F)
Â¯Â¯Â¯Â¯Â¯
â‰¥
Â¯Â¯Â¯Â¯Â¯
X
F âˆˆÏ€i
Re (Âµ (F))
Â¯Â¯Â¯Â¯Â¯ =
X
F âˆˆÏ€i
|Re (Âµ (F))|
â‰¥
âˆš
2
2
X
F âˆˆÏ€i
|Âµ (F)| > 5
âˆš
2
2 (1 + |Âµ (E)|) .
Now letting C be the union of the sets in Ï€i,
|Âµ (C)| =
Â¯Â¯Â¯Â¯Â¯
X
F âˆˆÏ€i
Âµ (F)
Â¯Â¯Â¯Â¯Â¯ > 5
2 (1 + |Âµ (E)|) > 1.
(15.8)
Deï¬ne D â‰¡E \ C.

15.2.
VECTOR MEASURES
409
E
C
Then Âµ (C) + Âµ (E \ C) = Âµ (E) and so
5
2 (1 + |Âµ (E)|)
<
|Âµ (C)| = |Âµ (E) âˆ’Âµ (E \ C)|
=
|Âµ (E) âˆ’Âµ (D)| â‰¤|Âµ (E)| + |Âµ (D)|
and so
1 < 5
2 + 3
2 |Âµ (E)| < |Âµ (D)| .
Now since |Âµ| (E) = âˆž, it follows from Theorem 15.8 that âˆž= |Âµ| (E) â‰¤|Âµ| (C) +
|Âµ| (D) and so either |Âµ| (C) = âˆžor |Âµ| (D) = âˆž. If |Âµ| (C) = âˆž, let B = C and
A = D. Otherwise, let B = D and A = C. This proves the claim.
Now suppose |Âµ| (â„¦) = âˆž. Then from the claim, there exist A1 and B1 such that
|Âµ| (B1) = âˆž, |Âµ (B1)| , |Âµ (A1)| > 1, and A1 âˆªB1 = â„¦. Let B1 â‰¡â„¦\A play the same
role as â„¦and obtain A2, B2 âŠ†B1 such that |Âµ| (B2) = âˆž, |Âµ (B2)| , |Âµ (A2)| > 1,
and A2 âˆªB2 = B1. Continue in this way to obtain a sequence of disjoint sets, {Ai}
such that |Âµ (Ai)| > 1. Then since Âµ is a measure,
Âµ (âˆªâˆž
i=1Ai) =
âˆž
X
i=1
Âµ (Ai)
but this is impossible because limiâ†’âˆžÂµ (Ai) Ì¸= 0. This proves the theorem.
Theorem 15.9 Let (â„¦, S) be a measure space and let Î» : S â†’C be a complex
vector measure. Thus |Î»|(â„¦) < âˆž. Let Âµ : S â†’[0, Âµ(â„¦)] be a ï¬nite measure such
that Î» â‰ªÂµ. Then there exists a unique f âˆˆL1(â„¦) such that for all E âˆˆS,
Z
E
fdÂµ = Î»(E).
Proof: It is clear that Re Î» and Im Î» are real-valued vector measures on S.
Since |Î»|(â„¦) < âˆž, it follows easily that | Re Î»|(â„¦) and | Im Î»|(â„¦) < âˆž. This is clear
because
|Î» (E)| â‰¥|Re Î» (E)| , |Im Î» (E)| .

410
REPRESENTATION THEOREMS
Therefore, each of
| Re Î»| + Re Î»
2
, | Re Î»| âˆ’Re(Î»)
2
, | Im Î»| + Im Î»
2
, and | Im Î»| âˆ’Im(Î»)
2
are ï¬nite measures on S. It is also clear that each of these ï¬nite measures are abso-
lutely continuous with respect to Âµ and so there exist unique nonnegative functions
in L1(â„¦), f1, f2, g1, g2 such that for all E âˆˆS,
1
2(| Re Î»| + Re Î»)(E)
=
Z
E
f1dÂµ,
1
2(| Re Î»| âˆ’Re Î»)(E)
=
Z
E
f2dÂµ,
1
2(| Im Î»| + Im Î»)(E)
=
Z
E
g1dÂµ,
1
2(| Im Î»| âˆ’Im Î»)(E)
=
Z
E
g2dÂµ.
Now let f = f1 âˆ’f2 + i(g1 âˆ’g2).
The following corollary is about representing a vector measure in terms of its
total variation. It is like representing a complex number in the form reiÎ¸. The proof
requires the following lemma.
Lemma 15.10 Suppose (â„¦, S, Âµ) is a measure space and f is a function in L1(â„¦, Âµ)
with the property that
|
Z
E
f dÂµ| â‰¤Âµ(E)
for all E âˆˆS. Then |f| â‰¤1 a.e.
Proof of the lemma: Consider the following picture.

1
(0, 0)
.
p
B(p, r)
where B(p, r) âˆ©B(0, 1) = âˆ…. Let E = f âˆ’1(B(p, r)). In fact Âµ (E) = 0. If Âµ(E) Ì¸= 0
then
Â¯Â¯Â¯Â¯
1
Âµ(E)
Z
E
f dÂµ âˆ’p
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
1
Âµ(E)
Z
E
(f âˆ’p)dÂµ
Â¯Â¯Â¯Â¯
â‰¤
1
Âµ(E)
Z
E
|f âˆ’p|dÂµ < r
because on E, |f (x) âˆ’p| < r. Hence
|
1
Âµ(E)
Z
E
fdÂµ| > 1

15.2.
VECTOR MEASURES
411
because it is closer to p than r. (Refer to the picture.) However, this contradicts the
assumption of the lemma. It follows Âµ(E) = 0. Since the set of complex numbers,
z such that |z| > 1 is an open set, it equals the union of countably many balls,
{Bi}âˆž
i=1 . Therefore,
Âµ
Â¡
f âˆ’1({z âˆˆC : |z| > 1}
Â¢
=
Âµ
Â¡
âˆªâˆž
k=1f âˆ’1 (Bk)
Â¢
â‰¤
âˆž
X
k=1
Âµ
Â¡
f âˆ’1 (Bk)
Â¢
= 0.
Thus |f(x)| â‰¤1 a.e. as claimed. This proves the lemma.
Corollary 15.11 Let Î» be a complex vector measure with |Î»|(â„¦) < âˆž1 Then there
exists a unique f âˆˆL1(â„¦) such that Î»(E) =
R
E fd|Î»|. Furthermore, |f| = 1 for |Î»|
a.e. This is called the polar decomposition of Î».
Proof: First note that Î» â‰ª|Î»| and so such an L1 function exists and is unique.
It is required to show |f| = 1 a.e. If |Î»|(E) Ì¸= 0,
Â¯Â¯Â¯Â¯
Î»(E)
|Î»|(E)
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
1
|Î»|(E)
Z
E
f d|Î»|
Â¯Â¯Â¯Â¯ â‰¤1.
Therefore by Lemma 15.10, |f| â‰¤1, |Î»| a.e. Now let
En =
Â·
|f| â‰¤1 âˆ’1
n
Â¸
.
Let {F1, Â· Â· Â·, Fm} be a partition of En. Then
m
X
i=1
|Î» (Fi)|
=
m
X
i=1
Â¯Â¯Â¯Â¯
Z
Fi
fd |Î»|
Â¯Â¯Â¯Â¯ â‰¤
m
X
i=1
Z
Fi
|f| d |Î»|
â‰¤
m
X
i=1
Z
Fi
Âµ
1 âˆ’1
n
Â¶
d |Î»| =
m
X
i=1
Âµ
1 âˆ’1
n
Â¶
|Î»| (Fi)
=
|Î»| (En)
Âµ
1 âˆ’1
n
Â¶
.
Then taking the supremum over all partitions,
|Î»| (En) â‰¤
Âµ
1 âˆ’1
n
Â¶
|Î»| (En)
which shows |Î»| (En) = 0. Hence |Î»| ([|f| < 1]) = 0 because [|f| < 1] = âˆªâˆž
n=1En.This
proves Corollary 15.11.
1As proved above, the assumption that |Î»| (â„¦) < âˆžis redundant.

412
REPRESENTATION THEOREMS
Corollary 15.12 Suppose (â„¦, S) is a measure space and Âµ is a ï¬nite nonnegative
measure on S. Then for h âˆˆL1 (Âµ) , deï¬ne a complex measure, Î» by
Î» (E) â‰¡
Z
E
hdÂµ.
Then
|Î»| (E) =
Z
E
|h| dÂµ.
Furthermore, |h| = gh where gd |Î»| is the polar decomposition of Î»,
Î» (E) =
Z
E
gd |Î»|
Proof: From Corollary 15.11 there exists g such that |g| = 1, |Î»| a.e. and for
all E âˆˆS
Î» (E) =
Z
E
gd |Î»| =
Z
E
hdÂµ.
Let sn be a sequence of simple functions converging pointwise to g. Then from the
above,
Z
E
gsnd |Î»| =
Z
E
snhdÂµ.
Passing to the limit using the dominated convergence theorem,
Z
E
d |Î»| =
Z
E
ghdÂµ.
It follows gh â‰¥0 a.e. and |g| = 1. Therefore, |h| = |gh| = gh. It follows from the
above, that
|Î»| (E) =
Z
E
d |Î»| =
Z
E
ghdÂµ =
Z
E
d |Î»| =
Z
E
|h| dÂµ
and this proves the corollary.
15.3
Representation Theorems For The Dual Space
Of Lp
Recall the concept of the dual space of a Banach space in the Chapter on Banach
space starting on Page 337. The next topic deals with the dual space of Lp for p â‰¥1
in the case where the measure space is Ïƒ ï¬nite or ï¬nite. In what follows q = âˆžif
p = 1 and otherwise, 1
p + 1
q = 1.
Theorem 15.13 (Riesz representation theorem) Let p > 1 and let (â„¦, S, Âµ) be a
ï¬nite measure space. If Î› âˆˆ(Lp(â„¦))â€², then there exists a unique h âˆˆLq(â„¦) ( 1
p + 1
q =
1) such that
Î›f =
Z
â„¦
hfdÂµ.
This function satisï¬es ||h||q = ||Î›|| where ||Î›|| is the operator norm of Î›.

15.3.
REPRESENTATION THEOREMS FOR THE DUAL SPACE OF LP
413
Proof: (Uniqueness) If h1 and h2 both represent Î›, consider
f = |h1 âˆ’h2|qâˆ’2(h1 âˆ’h2),
where h denotes complex conjugation. By Holderâ€™s inequality, it is easy to see that
f âˆˆLp(â„¦). Thus
0 = Î›f âˆ’Î›f =
Z
h1|h1 âˆ’h2|qâˆ’2(h1 âˆ’h2) âˆ’h2|h1 âˆ’h2|qâˆ’2(h1 âˆ’h2)dÂµ
=
Z
|h1 âˆ’h2|qdÂµ.
Therefore h1 = h2 and this proves uniqueness.
Now let Î»(E) = Î›(XE). Since this is a ï¬nite measure space XE is an element
of Lp (â„¦) and so it makes sense to write Î› (XE). In fact Î» is a complex measure
having ï¬nite total variation. Let A1, Â· Â· Â·, An be a partition of â„¦.
|Î›XAi| = wi(Î›XAi) = Î›(wiXAi)
for some wi âˆˆC, |wi| = 1. Thus
n
X
i=1
|Î»(Ai)| =
n
X
i=1
|Î›(XAi)| = Î›(
n
X
i=1
wiXAi)
â‰¤||Î›||(
Z
|
n
X
i=1
wiXAi|pdÂµ)
1
p = ||Î›||(
Z
â„¦
dÂµ)
1
p = ||Î›||Âµ(â„¦)
1
p.
This is because if x âˆˆâ„¦, x is contained in exactly one of the Ai and so the absolute
value of the sum in the ï¬rst integral above is equal to 1. Therefore |Î»|(â„¦) < âˆž
because this was an arbitrary partition. Also, if {Ei}âˆž
i=1 is a sequence of disjoint
sets of S, let
Fn = âˆªn
i=1Ei, F = âˆªâˆž
i=1Ei.
Then by the Dominated Convergence theorem,
||XFn âˆ’XF ||p â†’0.
Therefore, by continuity of Î›,
Î»(F) = Î›(XF ) = lim
nâ†’âˆžÎ›(XFn) = lim
nâ†’âˆž
n
X
k=1
Î›(XEk) =
âˆž
X
k=1
Î»(Ek).
This shows Î» is a complex measure with |Î»| ï¬nite.
It is also clear from the deï¬nition of Î» that Î» â‰ªÂµ. Therefore, by the Radon
Nikodym theorem, there exists h âˆˆL1(â„¦) with
Î»(E) =
Z
E
hdÂµ = Î›(XE).

414
REPRESENTATION THEOREMS
Actually h âˆˆLq and satisï¬es the other conditions above. Let s = Pm
i=1 ciXEi be a
simple function. Then since Î› is linear,
Î›(s) =
m
X
i=1
ciÎ›(XEi) =
m
X
i=1
ci
Z
Ei
hdÂµ =
Z
hsdÂµ.
(15.9)
Claim: If f is uniformly bounded and measurable, then
Î› (f) =
Z
hfdÂµ.
Proof of claim: Since f is bounded and measurable, there exists a sequence of
simple functions, {sn} which converges to f pointwise and in Lp (â„¦). This follows
from Theorem 8.27 on Page 190 upon breaking f up into positive and negative parts
of real and complex parts. In fact this theorem gives uniform convergence. Then
Î› (f) = lim
nâ†’âˆžÎ› (sn) = lim
nâ†’âˆž
Z
hsndÂµ =
Z
hfdÂµ,
the ï¬rst equality holding because of continuity of Î›, the second following from 15.9
and the third holding by the dominated convergence theorem.
This is a very nice formula but it still has not been shown that h âˆˆLq (â„¦).
Let En = {x : |h(x)| â‰¤n}. Thus |hXEn| â‰¤n. Then
|hXEn|qâˆ’2(hXEn) âˆˆLp(â„¦).
By the claim, it follows that
||hXEn||q
q =
Z
h|hXEn|qâˆ’2(hXEn)dÂµ = Î›(|hXEn|qâˆ’2(hXEn))
â‰¤||Î›||
Â¯Â¯Â¯Â¯|hXEn|qâˆ’2(hXEn)
Â¯Â¯Â¯Â¯
p = ||Î›|| ||hXEn||
q
pq,
the last equality holding because q âˆ’1 = q/p and so
ÂµZ Â¯Â¯|hXEn|qâˆ’2(hXEn)
Â¯Â¯p dÂµ
Â¶1/p
=
ÂµZ Â³
|hXEn|q/pÂ´p
dÂµ
Â¶1/p
=
||hXEn||
q
pq
Therefore, since q âˆ’q
p = 1, it follows that
||hXEn||q â‰¤||Î›||.
Letting n â†’âˆž, the Monotone Convergence theorem implies
||h||q â‰¤||Î›||.
(15.10)

15.3.
REPRESENTATION THEOREMS FOR THE DUAL SPACE OF LP
415
Now that h has been shown to be in Lq(â„¦), it follows from 15.9 and the density
of the simple functions, Theorem 12.13 on Page 323, that
Î›f =
Z
hfdÂµ
for all f âˆˆLp(â„¦).
It only remains to verify the last claim.
||Î›|| = sup{
Z
hf : ||f||p â‰¤1} â‰¤||h||q â‰¤||Î›||
by 15.10, and Holderâ€™s inequality. This proves the theorem.
To represent elements of the dual space of L1(â„¦), another Banach space is
needed.
Deï¬nition 15.14 Let (â„¦, S, Âµ) be a measure space. Lâˆž(â„¦) is the vector space of
measurable functions such that for some M > 0, |f(x)| â‰¤M for all x outside of
some set of measure zero (|f(x)| â‰¤M a.e.). Deï¬ne f = g when f(x) = g(x) a.e.
and ||f||âˆžâ‰¡inf{M : |f(x)| â‰¤M a.e.}.
Theorem 15.15 Lâˆž(â„¦) is a Banach space.
Proof: It is clear that Lâˆž(â„¦) is a vector space. Is || ||âˆža norm?
Claim: If f âˆˆLâˆž(â„¦), then |f (x)| â‰¤||f||âˆža.e.
Proof of the claim:
Â©
x : |f (x)| â‰¥||f||âˆž+ nâˆ’1Âª
â‰¡En is a set of measure zero
according to the deï¬nition of ||f||âˆž. Furthermore, {x : |f (x)| > ||f||âˆž} = âˆªnEn
and so it is also a set of measure zero. This veriï¬es the claim.
Now if ||f||âˆž= 0 it follows that f (x) = 0 a.e. Also if f, g âˆˆLâˆž(â„¦),
|f (x) + g (x)| â‰¤|f (x)| + |g (x)| â‰¤||f||âˆž+ ||g||âˆž
a.e. and so ||f||âˆž+ ||g||âˆžserves as one of the constants, M in the deï¬nition of
||f + g||âˆž. Therefore,
||f + g||âˆžâ‰¤||f||âˆž+ ||g||âˆž.
Next let c be a number. Then |cf (x)| = |c| |f (x)| â‰¤|c| ||f||âˆžand so ||cf||âˆžâ‰¤
|c| ||f||âˆž. Therefore since c is arbitrary, ||f||âˆž= ||c (1/c) f||âˆžâ‰¤
Â¯Â¯ 1
c
Â¯Â¯ ||cf||âˆžwhich
implies |c| ||f||âˆžâ‰¤||cf||âˆž. Thus || ||âˆžis a norm as claimed.
To verify completeness, let {fn} be a Cauchy sequence in Lâˆž(â„¦) and use the
above claim to get the existence of a set of measure zero, Enm such that for all
x /âˆˆEnm,
|fn(x) âˆ’fm(x)| â‰¤||fn âˆ’fm||âˆž
Let E = âˆªn,mEnm. Thus Âµ(E) = 0 and for each x /âˆˆE, {fn(x)}âˆž
n=1 is a Cauchy
sequence in C. Let
f(x) =
Â½
0 if x âˆˆE
limnâ†’âˆžfn(x) if x /âˆˆE
= lim
nâ†’âˆžXEC(x)fn(x).

416
REPRESENTATION THEOREMS
Then f is clearly measurable because it is the limit of measurable functions. If
Fn = {x : |fn(x)| > ||fn||âˆž}
and F = âˆªâˆž
n=1Fn, it follows Âµ(F) = 0 and that for x /âˆˆF âˆªE,
|f(x)| â‰¤lim inf
nâ†’âˆž|fn(x)| â‰¤lim inf
nâ†’âˆž||fn||âˆž< âˆž
because {||fn||âˆž} is a Cauchy sequence. (|||fn||âˆžâˆ’||fm||âˆž| â‰¤||fn âˆ’fm||âˆžby the
triangle inequality.) Thus f âˆˆLâˆž(â„¦). Let n be large enough that whenever m > n,
||fm âˆ’fn||âˆž< Îµ.
Then, if x /âˆˆE,
|f(x) âˆ’fn(x)|
=
lim
mâ†’âˆž|fm(x) âˆ’fn(x)|
â‰¤
lim
mâ†’âˆžinf ||fm âˆ’fn||âˆž< Îµ.
Hence ||f âˆ’fn||âˆž< Îµ for all n large enough. This proves the theorem.
The next theorem is the Riesz representation theorem for
Â¡
L1 (â„¦)
Â¢â€².
Theorem 15.16 (Riesz representation theorem) Let (â„¦, S, Âµ) be a ï¬nite measure
space. If Î› âˆˆ(L1(â„¦))â€², then there exists a unique h âˆˆLâˆž(â„¦) such that
Î›(f) =
Z
â„¦
hf dÂµ
for all f âˆˆL1(â„¦). If h is the function in Lâˆž(â„¦) representing Î› âˆˆ(L1(â„¦))â€², then
||h||âˆž= ||Î›||.
Proof: Just as in the proof of Theorem 15.13, there exists a unique h âˆˆL1(â„¦)
such that for all simple functions, s,
Î›(s) =
Z
hs dÂµ.
(15.11)
To show h âˆˆLâˆž(â„¦), let Îµ > 0 be given and let
E = {x : |h(x)| â‰¥||Î›|| + Îµ}.
Let |k| = 1 and hk = |h|. Since the measure space is ï¬nite, k âˆˆL1(â„¦). As in
Theorem 15.13 let {sn} be a sequence of simple functions converging to k in L1(â„¦),
and pointwise. It follows from the construction in Theorem 8.27 on Page 190 that
it can be assumed |sn| â‰¤1. Therefore
Î›(kXE) = lim
nâ†’âˆžÎ›(snXE) = lim
nâ†’âˆž
Z
E
hsndÂµ =
Z
E
hkdÂµ

15.3.
REPRESENTATION THEOREMS FOR THE DUAL SPACE OF LP
417
where the last equality holds by the Dominated Convergence theorem. Therefore,
||Î›||Âµ(E)
â‰¥
|Î›(kXE)| = |
Z
â„¦
hkXEdÂµ| =
Z
E
|h|dÂµ
â‰¥
(||Î›|| + Îµ)Âµ(E).
It follows that Âµ(E) = 0. Since Îµ > 0 was arbitrary, ||Î›|| â‰¥||h||âˆž. It was shown
that h âˆˆLâˆž(â„¦), the density of the simple functions in L1 (â„¦) and 15.11 imply
Î›f =
Z
â„¦
hfdÂµ , ||Î›|| â‰¥||h||âˆž.
(15.12)
This proves the existence part of the theorem. To verify uniqueness, suppose h1
and h2 both represent Î› and let f âˆˆL1(â„¦) be such that |f| â‰¤1 and f(h1 âˆ’h2) =
|h1 âˆ’h2|. Then
0 = Î›f âˆ’Î›f =
Z
(h1 âˆ’h2)fdÂµ =
Z
|h1 âˆ’h2|dÂµ.
Thus h1 = h2. Finally,
||Î›|| = sup{|
Z
hfdÂµ| : ||f||1 â‰¤1} â‰¤||h||âˆžâ‰¤||Î›||
by 15.12.
Next these results are extended to the Ïƒ ï¬nite case.
Lemma 15.17 Let (â„¦, S, Âµ) be a measure space and suppose there exists a measur-
able function, r such that r (x) > 0 for all x, there exists M such that |r (x)| < M
for all x, and
R
rdÂµ < âˆž. Then for
Î› âˆˆ(Lp(â„¦, Âµ))â€², p â‰¥1,
there exists a unique h âˆˆLpâ€²(â„¦, Âµ), Lâˆž(â„¦, Âµ) if p = 1 such that
Î›f =
Z
hfdÂµ.
Also ||h|| = ||Î›||. (||h|| = ||h||pâ€² if p > 1, ||h||âˆžif p = 1). Here
1
p + 1
pâ€² = 1.
Proof: Deï¬ne a new measure eÂµ, according to the rule
eÂµ (E) â‰¡
Z
E
rdÂµ.
(15.13)
Thus eÂµ is a ï¬nite measure on S. Now deï¬ne a mapping, Î· : Lp(â„¦, Âµ) â†’Lp(â„¦, eÂµ) by
Î·f = râˆ’1
p f.

418
REPRESENTATION THEOREMS
Then
||Î·f||p
Lp(eÂµ) =
Z Â¯Â¯Â¯râˆ’1
p f
Â¯Â¯Â¯
p
rdÂµ = ||f||p
Lp(Âµ)
and so Î· is one to one and in fact preserves norms. I claim that also Î· is onto. To
see this, let g âˆˆLp(â„¦, eÂµ) and consider the function, r
1
p g. Then
Z Â¯Â¯Â¯r
1
p g
Â¯Â¯Â¯
p
dÂµ =
Z
|g|p rdÂµ =
Z
|g|p deÂµ < âˆž
Thus r
1
p g âˆˆLp (â„¦, Âµ) and Î·
Â³
r
1
p g
Â´
= g showing that Î· is onto as claimed. Thus
Î· is one to one, onto, and preserves norms. Consider the diagram below which is
descriptive of the situation in which Î·âˆ—must be one to one and onto.
h, Lpâ€² (eÂµ)
Lp (eÂµ)â€² , eÎ›
Î·âˆ—
â†’
Lp (Âµ)â€² , Î›
Lp (eÂµ)
Î·
â†
Lp (Âµ)
Then for Î› âˆˆLp (Âµ)â€² , there exists a unique eÎ› âˆˆLp (eÂµ)â€² such that Î·âˆ—eÎ› = Î›,
Â¯Â¯Â¯
Â¯Â¯Â¯eÎ›
Â¯Â¯Â¯
Â¯Â¯Â¯ =
||Î›|| . By the Riesz representation theorem for ï¬nite measure spaces, there exists
a unique h âˆˆLpâ€² (eÂµ) which represents eÎ› in the manner described in the Riesz
representation theorem. Thus ||h||Lpâ€²(eÂµ) =
Â¯Â¯Â¯
Â¯Â¯Â¯eÎ›
Â¯Â¯Â¯
Â¯Â¯Â¯ = ||Î›|| and for all f âˆˆLp (Âµ) ,
Î› (f)
=
Î·âˆ—eÎ› (f) â‰¡eÎ› (Î·f) =
Z
h (Î·f) deÂµ =
Z
rh
Â³
f âˆ’1
p f
Â´
dÂµ
=
Z
r
1
pâ€² hfdÂµ.
Now
Z Â¯Â¯Â¯r
1
pâ€² h
Â¯Â¯Â¯
pâ€²
dÂµ =
Z
|h|pâ€²
rdÂµ = ||h||pâ€²
Lpâ€²(eÂµ) < âˆž.
Thus
Â¯Â¯Â¯
Â¯Â¯Â¯r
1
pâ€² h
Â¯Â¯Â¯
Â¯Â¯Â¯
Lpâ€²(Âµ) = ||h||Lpâ€²(eÂµ) =
Â¯Â¯Â¯
Â¯Â¯Â¯eÎ›
Â¯Â¯Â¯
Â¯Â¯Â¯ = ||Î›|| and represents Î› in the appropriate
way. If p = 1, then 1/pâ€² â‰¡0. This proves the Lemma.
A situation in which the conditions of the lemma are satisï¬ed is the case where
the measure space is Ïƒ ï¬nite. In fact, you should show this is the only case in which
the conditions of the above lemma hold.
Theorem 15.18 (Riesz representation theorem) Let (â„¦, S, Âµ) be Ïƒ ï¬nite and let
Î› âˆˆ(Lp(â„¦, Âµ))â€², p â‰¥1.
Then there exists a unique h âˆˆLq(â„¦, Âµ), Lâˆž(â„¦, Âµ) if p = 1 such that
Î›f =
Z
hfdÂµ.

15.3.
REPRESENTATION THEOREMS FOR THE DUAL SPACE OF LP
419
Also ||h|| = ||Î›||. (||h|| = ||h||q if p > 1, ||h||âˆžif p = 1). Here
1
p + 1
q = 1.
Proof: Let {â„¦n} be a sequence of disjoint elements of S having the property
that
0 < Âµ(â„¦n) < âˆž, âˆªâˆž
n=1â„¦n = â„¦.
Deï¬ne
r(x) =
âˆž
X
n=1
1
n2 Xâ„¦n(x) Âµ(â„¦n)âˆ’1, eÂµ(E) =
Z
E
rdÂµ.
Thus
Z
â„¦
rdÂµ = eÂµ(â„¦) =
âˆž
X
n=1
1
n2 < âˆž
so eÂµ is a ï¬nite measure. The above lemma gives the existence part of the conclusion
of the theorem. Uniqueness is done as before.
With the Riesz representation theorem, it is easy to show that
Lp(â„¦), p > 1
is a reï¬‚exive Banach space. Recall Deï¬nition 13.32 on Page 353 for the deï¬nition.
Theorem 15.19 For (â„¦, S, Âµ) a Ïƒ ï¬nite measure space and p > 1, Lp(â„¦) is reï¬‚ex-
ive.
Proof: Let Î´r : (Lr(â„¦))â€² â†’Lrâ€²(â„¦) be deï¬ned for 1
r + 1
râ€² = 1 by
Z
(Î´rÎ›)g dÂµ = Î›g
for all g âˆˆLr(â„¦). From Theorem 15.18 Î´r is one to one, onto, continuous and linear.
By the open map theorem, Î´âˆ’1
r
is also one to one, onto, and continuous (Î´rÎ› equals
the representor of Î›). Thus Î´âˆ—
r is also one to one, onto, and continuous by Corollary
13.29. Now observe that J = Î´âˆ—
p â—¦Î´âˆ’1
q . To see this, let zâˆ—âˆˆ(Lq)â€², yâˆ—âˆˆ(Lp)â€²,
Î´âˆ—
p â—¦Î´âˆ’1
q (Î´qzâˆ—)(yâˆ—)
=
(Î´âˆ—
pzâˆ—)(yâˆ—)
=
zâˆ—(Î´pyâˆ—)
=
Z
(Î´qzâˆ—)(Î´pyâˆ—)dÂµ,
J(Î´qzâˆ—)(yâˆ—)
=
yâˆ—(Î´qzâˆ—)
=
Z
(Î´pyâˆ—)(Î´qzâˆ—)dÂµ.
Therefore Î´âˆ—
p â—¦Î´âˆ’1
q
= J on Î´q(Lq)â€² = Lp. But the two Î´ maps are onto and so J is
also onto.

420
REPRESENTATION THEOREMS
15.4
The Dual Space Of C (X)
Consider the dual space of C(X) where X is a compact Hausdorï¬€space. It will
turn out to be a space of measures. To show this, the following lemma will be
convenient.
Lemma 15.20 Suppose Î» is a mapping which is deï¬ned on the positive continuous
functions deï¬ned on X, some topological space which satisï¬es
Î» (af + bg) = aÎ» (f) + bÎ» (g)
(15.14)
whenever a, b â‰¥0 and f, g â‰¥0. Then there exists a unique extension of Î» to all of
C (X), Î› such that whenever f, g âˆˆC (X) and a, b âˆˆC, it follows
Î› (af + bg) = aÎ› (f) + bÎ› (g) .
Proof: Let C(X; R) be the real-valued functions in C(X) and deï¬ne
Î›R(f) = Î»f + âˆ’Î»f âˆ’
for f âˆˆC(X; R). Use the identity
(f1 + f2)+ + f âˆ’
1 + f âˆ’
2 = f +
1 + f +
2 + (f1 + f2)âˆ’
and 15.14 to write
Î»(f1 + f2)+ âˆ’Î»(f1 + f2)âˆ’= Î»f +
1 âˆ’Î»f âˆ’
1 + Î»f +
2 âˆ’Î»f âˆ’
2 ,
it follows that Î›R(f1 + f2) = Î›R(f1) + Î›R(f2). To show that Î›R is linear, it is
necessary to verify that Î›R(cf) = cÎ›R(f) for all c âˆˆR. But
(cf)Â± = cf Â±,
if c â‰¥0 while
(cf)+ = âˆ’c(f)âˆ’,
if c < 0 and
(cf)âˆ’= (âˆ’c)f +,
if c < 0. Thus, if c < 0,
Î›R(cf) = Î»(cf)+ âˆ’Î»(cf)âˆ’= Î»
Â¡
(âˆ’c) f âˆ’Â¢
âˆ’Î»
Â¡
(âˆ’c)f +Â¢
= âˆ’cÎ»(f âˆ’) + cÎ»(f +) = c(Î»(f +) âˆ’Î»(f âˆ’)) = cÎ›R (f) .
A similar formula holds more easily if c â‰¥0. Now let
Î›f = Î›R(Re f) + iÎ›R(Im f)

15.4.
THE DUAL SPACE OF C (X)
421
for arbitrary f âˆˆC(X). This is linear as desired. It is obvious that Î› (f + g) =
Î› (f) + Î› (g) from the fact that taking the real and imaginary parts are linear
operations. The only thing to check is whether you can factor out a complex scalar.
Î› ((a + ib) f) = Î› (af) + Î› (ibf)
â‰¡Î›R (a Re f) + iÎ›R (a Im f) + Î›R (âˆ’b Im f) + iÎ›R (b Re f)
because ibf = ib Re f âˆ’b Im f and so Re (ibf) = âˆ’b Im f and Im (ibf) = b Re f.
Therefore, the above equals
=
(a + ib) Î›R (Re f) + i (a + ib) Î›R (Im f)
=
(a + ib) (Î›R (Re f) + iÎ›R (Im f)) = (a + ib) Î›f
The extension is obviously unique. This proves the lemma.
Let L âˆˆC(X)â€².
Also denote by C+(X) the set of nonnegative continuous
functions deï¬ned on X. Deï¬ne for f âˆˆC+(X)
Î»(f) = sup{|Lg| : |g| â‰¤f}.
Note that Î»(f) < âˆžbecause |Lg| â‰¤||L|| ||g|| â‰¤||L|| ||f|| for |g| â‰¤f. Then the
following lemma is important.
Lemma 15.21 If c â‰¥0, Î»(cf) = cÎ»(f), f1 â‰¤f2 implies Î»f1 â‰¤Î»f2, and
Î»(f1 + f2) = Î»(f1) + Î»(f2).
Proof: The ï¬rst two assertions are easy to see so consider the third.
Let
|gj| â‰¤fj and let egj = eiÎ¸jgj where Î¸j is chosen such that eiÎ¸jLgj = |Lgj|. Thus
Legj = |Lgj|. Then
|eg1 + eg2| â‰¤f1 + f2.
Hence
|Lg1| + |Lg2| = Leg1 + Leg2 =
L(eg1 + eg2) = |L(eg1 + eg2)| â‰¤Î»(f1 + f2).
(15.15)
Choose g1 and g2 such that |Lgi| + Îµ > Î»(fi). Then 15.15 shows
Î»(f1) + Î»(f2) âˆ’2Îµ â‰¤Î»(f1 + f2).
Since Îµ > 0 is arbitrary, it follows that
Î»(f1) + Î»(f2) â‰¤Î»(f1 + f2).
(15.16)
Now let |g| â‰¤f1 + f2, |Lg| â‰¥Î»(f1 + f2) âˆ’Îµ. Let
hi (x) =
(
fi(x)g(x)
f1(x)+f2(x) if f1 (x) + f2 (x) > 0,
0 if f1 (x) + f2 (x) = 0.

422
REPRESENTATION THEOREMS
Then hi is continuous and h1(x) + h2(x) = g(x), |hi| â‰¤fi. Therefore,
âˆ’Îµ + Î»(f1 + f2)
â‰¤
|Lg| â‰¤|Lh1 + Lh2| â‰¤|Lh1| + |Lh2|
â‰¤
Î»(f1) + Î»(f2).
Since Îµ > 0 is arbitrary, this shows with 15.16 that
Î»(f1 + f2) â‰¤Î»(f1) + Î»(f2) â‰¤Î»(f1 + f2)
which proves the lemma.
Let Î› be deï¬ned in Lemma 15.20. Then Î› is linear by this lemma. Also, if
f â‰¥0,
Î›f = Î›Rf = Î» (f) â‰¥0.
Therefore, Î› is a positive linear functional on C(X) (= Cc(X) since X is compact).
By Theorem 9.21 on Page 221, there exists a unique Radon measure Âµ such that
Î›f =
Z
X
f dÂµ
for all f âˆˆC(X). Thus Î›(1) = Âµ(X). What follows is the Riesz representation
theorem for C(X)â€².
Theorem 15.22 Let L âˆˆ(C(X))â€². Then there exists a Radon measure Âµ and a
function Ïƒ âˆˆLâˆž(X, Âµ) such that
L(f) =
Z
X
f Ïƒ dÂµ.
Proof: Let f âˆˆC(X). Then there exists a unique Radon measure Âµ such that
|Lf| â‰¤Î›(|f|) =
Z
X
|f|dÂµ = ||f||1.
Since Âµ is a Radon measure, C(X) is dense in L1(X, Âµ).
Therefore L extends
uniquely to an element of (L1(X, Âµ))â€². By the Riesz representation theorem for L1,
there exists a unique Ïƒ âˆˆLâˆž(X, Âµ) such that
Lf =
Z
X
f Ïƒ dÂµ
for all f âˆˆC(X).
15.5
The Dual Space Of C0(X)
It is possible to give a simple generalization of the above theorem. For X a locally
compact Hausdorï¬€space, e
X denotes the one point compactiï¬cation of X. Thus,
e
X = X âˆª{âˆž} and the topology of e
X consists of the usual topology of X along

15.5.
THE DUAL SPACE OF C0(X)
423
with all complements of compact sets which are deï¬ned as the open sets containing
âˆž. Also C0 (X) will denote the space of continuous functions, f, deï¬ned on X
such that in the topology of e
X, limxâ†’âˆžf (x) = 0. For this space of functions,
||f||0 â‰¡sup {|f (x)| : x âˆˆX} is a norm which makes this into a Banach space.
Then the generalization is the following corollary.
Corollary 15.23 Let L âˆˆ(C0 (X))â€² where X is a locally compact Hausdorï¬€space.
Then there exists Ïƒ âˆˆLâˆž(X, Âµ) for Âµ a ï¬nite Radon measure such that for all
f âˆˆC0 (X),
L (f) =
Z
X
fÏƒdÂµ.
Proof: Let
eD â‰¡
n
f âˆˆC
Â³
e
X
Â´
: f (âˆž) = 0
o
.
Thus eD is a closed subspace of the Banach space C
Â³
e
X
Â´
. Let Î¸ : C0 (X) â†’eD be
deï¬ned by
Î¸f (x) =
Â½
f (x) if x âˆˆX,
0 if x = âˆž.
Then Î¸ is an isometry of C0 (X) and eD. (||Î¸u|| = ||u|| .)The following diagram is
obtained.
C0 (X)â€²
Î¸âˆ—
â†
Â³
eD
Â´â€²
iâˆ—
â†
C
Â³
e
X
Â´â€²
C0 (X)
â†’
Î¸
eD
â†’
i
C
Â³
e
X
Â´
By the Hahn Banach theorem, there exists L1 âˆˆC
Â³
e
X
Â´â€²
such that Î¸âˆ—iâˆ—L1 = L.
Now apply Theorem 15.22 to get the existence of a ï¬nite Radon measure, Âµ1, on e
X
and a function Ïƒ âˆˆLâˆžÂ³
e
X, Âµ1
Â´
, such that
L1g =
Z
e
X
gÏƒdÂµ1.
Letting the Ïƒ algebra of Âµ1 measurable sets be denoted by S1, deï¬ne
S â‰¡{E \ {âˆž} : E âˆˆS1}
and let Âµ be the restriction of Âµ1 to S. If f âˆˆC0 (X),
Lf = Î¸âˆ—iâˆ—L1f â‰¡L1iÎ¸f = L1Î¸f =
Z
e
X
Î¸fÏƒdÂµ1 =
Z
X
fÏƒdÂµ.
This proves the corollary.

424
REPRESENTATION THEOREMS
15.6
More Attractive Formulations
In this section, Corollary 15.23 will be reï¬ned and placed in an arguably more
attractive form.
The measures involved will always be complex Borel measures
deï¬ned on a Ïƒ algebra of subsets of X, a locally compact Hausdorï¬€space.
Deï¬nition 15.24 Let Î» be a complex measure.
Then
R
fdÎ» â‰¡
R
fhd |Î»| where
hd |Î»| is the polar decomposition of Î» described above. The complex measure, Î» is
called regular if |Î»| is regular.
The following lemma says that the diï¬€erence of regular complex measures is also
regular.
Lemma 15.25 Suppose Î»i, i = 1, 2 is a complex Borel measure with total variation
ï¬nite2 deï¬ned on X, a locally compact Hausdorf space. Then Î»1 âˆ’Î»2 is also a
regular measure on the Borel sets.
Proof:
Let E be a Borel set. That way it is in the Ïƒ algebras associated
with both Î»i. Then by regularity of Î»i, there exist K and V compact and open
respectively such that K âŠ†E âŠ†V and |Î»i| (V \ K) < Îµ/2. Therefore,
X
AâˆˆÏ€(V \K)
|(Î»1 âˆ’Î»2) (A)|
=
X
AâˆˆÏ€(V \K)
|Î»1 (A) âˆ’Î»2 (A)|
â‰¤
X
AâˆˆÏ€(V \K)
|Î»1 (A)| + |Î»2 (A)|
â‰¤
|Î»1| (V \ K) + |Î»2| (V \ K) < Îµ.
Therefore, |Î»1 âˆ’Î»2| (V \ K) â‰¤Îµ and this shows Î»1 âˆ’Î»2 is regular as claimed.
Theorem 15.26 Let L âˆˆC0 (X)â€² Then there exists a unique complex measure, Î»
with |Î»| regular and Borel, such that for all f âˆˆC0 (X) ,
L (f) =
Z
X
fdÎ».
Furthermore, ||L|| = |Î»| (X) .
Proof: By Corollary 15.23 there exists Ïƒ âˆˆLâˆž(X, Âµ) where Âµ is a Radon
measure such that for all f âˆˆC0 (X) ,
L (f) =
Z
X
fÏƒdÂµ.
Let a complex Borel measure, Î» be given by
Î» (E) â‰¡
Z
E
ÏƒdÂµ.
2Recall this is automatic for a complex measure.

15.7.
EXERCISES
425
This is a well deï¬ned complex measure because Âµ is a ï¬nite measure. By Corollary
15.12
|Î»| (E) =
Z
E
|Ïƒ| dÂµ
(15.17)
and Ïƒ = g |Ïƒ| where gd |Î»| is the polar decomposition for Î». Therefore, for f âˆˆ
C0 (X) ,
L (f) =
Z
X
fÏƒdÂµ =
Z
X
fg |Ïƒ| dÂµ =
Z
X
fgd |Î»| â‰¡
Z
X
fdÎ».
(15.18)
From 15.17 and the regularity of Âµ, it follows that |Î»| is also regular.
What of the claim about ||L||? By the regularity of |Î»| , it follows that C0 (X) (In
fact, Cc (X)) is dense in L1 (X, |Î»|). Since |Î»| is ï¬nite, g âˆˆL1 (X, |Î»|). Therefore,
there exists a sequence of functions in C0 (X) , {fn} such that fn â†’g in L1 (X, |Î»|).
Therefore, there exists a subsequence, still denoted by {fn} such that fn (x) â†’g (x)
|Î»| a.e. also. But since |g (x)| = 1 a.e. it follows that hn (x) â‰¡
fn(x)
|fn(x)|+ 1
n also
converges pointwise |Î»| a.e. Then from the dominated convergence theorem and
15.18
||L|| â‰¥lim
nâ†’âˆž
Z
X
hngd |Î»| = |Î»| (X) .
Also, if ||f||C0(X) â‰¤1, then
|L (f)| =
Â¯Â¯Â¯Â¯
Z
X
fgd |Î»|
Â¯Â¯Â¯Â¯ â‰¤
Z
X
|f| d |Î»| â‰¤|Î»| (X) ||f||C0(X)
and so ||L|| â‰¤|Î»| (X) . This proves everything but uniqueness.
Suppose Î» and Î»1 both work. Then for all f âˆˆC0 (X) ,
0 =
Z
X
fd (Î» âˆ’Î»1) =
Z
X
fhd |Î» âˆ’Î»1|
where hd |Î» âˆ’Î»1| is the polar decomposition for Î» âˆ’Î»1. By Lemma 15.25 Î» âˆ’Î»1 is
regular and so, as above, there exists {fn} such that |fn| â‰¤1 and fn â†’h pointwise.
Therefore,
R
X d |Î» âˆ’Î»1| = 0 so Î» = Î»1. This proves the theorem.
15.7
Exercises
1. Suppose Âµ is a vector measure having values in Rn or Cn. Can you show that
|Âµ| must be ï¬nite? Hint: You might deï¬ne for each ei, one of the standard ba-
sis vectors, the real or complex measure, Âµei given by Âµei (E) â‰¡eiÂ·Âµ (E) . Why
would this approach not yield anything for an inï¬nite dimensional normed lin-
ear space in place of Rn?
2. The Riesz representation theorem of the Lp spaces can be used to prove a
very interesting inequality. Let r, p, q âˆˆ(1, âˆž) satisfy
1
r = 1
p + 1
q âˆ’1.

426
REPRESENTATION THEOREMS
Then
1
q = 1 + 1
r âˆ’1
p > 1
r
and so r > q. Let Î¸ âˆˆ(0, 1) be chosen so that Î¸r = q. Then also we have
1
r =
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1/p+1/pâ€²=1
z }| {
1 âˆ’1
pâ€²
ï£¶
ï£·
ï£·
ï£·
ï£¸+ 1
q âˆ’1 = 1
q âˆ’1
pâ€²
and so
Î¸
q = 1
q âˆ’1
pâ€²
which implies pâ€² (1 âˆ’Î¸) = q. Now let f âˆˆLp (Rn) , g âˆˆLq (Rn) , f, g â‰¥0.
Justify the steps in the following argument using what was just shown that
Î¸r = q and pâ€² (1 âˆ’Î¸) = q. Let
h âˆˆLrâ€² (Rn) .
Âµ1
r + 1
râ€² = 1
Â¶
Z
f âˆ—g (x) |h (x)| dx =
Z Z
f (y) g (x âˆ’y) |h (x)| dxdy.
â‰¤
Z Z
|f (y)| |g (x âˆ’y)|Î¸ |g (x âˆ’y)|1âˆ’Î¸ |h (x)| dydx
â‰¤
Z ÂµZ Â³
|g (x âˆ’y)|1âˆ’Î¸ |h (x)|
Â´râ€²
dx
Â¶1/râ€²
Â·
ÂµZ Â³
|f (y)| |g (x âˆ’y)|Î¸Â´r
dx
Â¶1/r
dy
â‰¤
"Z ÂµZ Â³
|g (x âˆ’y)|1âˆ’Î¸ |h (x)|
Â´râ€²
dx
Â¶pâ€²/râ€²
dy
#1/pâ€²
Â·
"Z ÂµZ Â³
|f (y)| |g (x âˆ’y)|Î¸Â´r
dx
Â¶p/r
dy
#1/p
â‰¤
"Z ÂµZ Â³
|g (x âˆ’y)|1âˆ’Î¸ |h (x)|
Â´pâ€²
dy
Â¶râ€²/pâ€²
dx
#1/râ€²
Â·
"Z
|f (y)|p
ÂµZ
|g (x âˆ’y)|Î¸r dx
Â¶p/r
dy
#1/p

15.7.
EXERCISES
427
=
"Z
|h (x)|râ€² ÂµZ
|g (x âˆ’y)|(1âˆ’Î¸)pâ€²
dy
Â¶râ€²/pâ€²
dx
#1/râ€²
||g||q/r
q
||f||p
= ||g||q/r
q
||g||q/pâ€²
q
||f||p ||h||râ€² = ||g||q ||f||p ||h||râ€² .
(15.19)
Youngâ€™s inequality says that
||f âˆ—g||r â‰¤||g||q ||f||p .
(15.20)
Therefore ||f âˆ—g||r â‰¤||g||q ||f||p. How does this inequality follow from the
above computation? Does 15.19 continue to hold if r, p, q are only assumed to
be in [1, âˆž]? Explain. Does 15.20 hold even if r, p, and q are only assumed to
lie in [1, âˆž]?
3. Show that in a reï¬‚exive Banach space, weak and weak âˆ—convergence are the
same.
4. Suppose (â„¦, Âµ, S) is a ï¬nite measure space and that {fn} is a sequence of
functions which converge weakly to 0 in Lp (â„¦). Suppose also that fn (x) â†’0
a.e. Show that then fn â†’0 in Lpâˆ’Îµ (â„¦) for every p > Îµ > 0.
5. Give an example of a sequence of functions in Lâˆž(âˆ’Ï€, Ï€) which converges
weak âˆ—to zero but which does not converge pointwise a.e. to zero.

428
REPRESENTATION THEOREMS

Integrals And Derivatives
16.1
The Fundamental Theorem Of Calculus
The version of the fundamental theorem of calculus found in Calculus has already
been referred to frequently. It says that if f is a Riemann integrable function, the
function
x â†’
Z x
a
f (t) dt,
has a derivative at every point where f is continuous. It is natural to ask what occurs
for f in L1. It is an amazing fact that the same result is obtained asside from a set of
measure zero even though f, being only in L1 may fail to be continuous anywhere.
Proofs of this result are based on some form of the Vitali covering theorem presented
above. In what follows, the measure space is (Rn, S, m) where m is n-dimensional
Lebesgue measure although the same theorems can be proved for arbitrary Radon
measures [36]. To save notation, m is written in place of mn.
By Lemma 9.7 on Page 214 and the completeness of m, the Lebesgue measurable
sets are exactly those measurable in the sense of Caratheodory. Also, to save on
notation m is also the name of the outer measure deï¬ned on all of P(Rn) which is
determined by mn. Recall
B(p, r) = {x : |x âˆ’p| < r}.
(16.1)
Also deï¬ne the following.
If B = B(p, r), then bB = B(p, 5r).
(16.2)
The ï¬rst version of the Vitali covering theorem presented above will now be used
to establish the fundamental theorem of calculus. The space of locally integrable
functions is the most general one for which the maximal function deï¬ned below
makes sense.
Deï¬nition 16.1
f âˆˆL1
loc(Rn) means fXB(0,R) âˆˆL1(Rn) for all R > 0.
For
f âˆˆL1
loc(Rn), the Hardy Littlewood Maximal Function, Mf, is deï¬ned by
Mf(x) â‰¡sup
r>0
1
m(B(x, r))
Z
B(x,r)
|f(y)|dy.
429

430
INTEGRALS AND DERIVATIVES
Theorem 16.2
If f âˆˆL1(Rn), then for Î± > 0,
m([Mf > Î±]) â‰¤5n
Î± ||f||1.
(Here and elsewhere, [Mf > Î±] â‰¡{x âˆˆRn : Mf(x) > Î±} with other occurrences of
[ ] being deï¬ned similarly.)
Proof: Let S â‰¡[Mf > Î±]. For x âˆˆS, choose rx > 0 with
1
m(B(x, rx))
Z
B(x,rx)
|f| dm > Î±.
The rx are all bounded because
m(B(x, rx)) < 1
Î±
Z
B(x,rx)
|f| dm < 1
Î±||f||1.
By the Vitali covering theorem, there are disjoint balls B(xi, ri) such that
S âŠ†âˆªâˆž
i=1B(xi, 5ri)
and
1
m(B(xi, ri))
Z
B(xi,ri)
|f| dm > Î±.
Therefore
m(S)
â‰¤
âˆž
X
i=1
m(B(xi, 5ri)) = 5n
âˆž
X
i=1
m(B(xi, ri))
â‰¤
5n
Î±
âˆž
X
i=1
Z
B(xi,ri)
|f| dm
â‰¤
5n
Î±
Z
Rn |f| dm,
the last inequality being valid because the balls B(xi, ri) are disjoint. This proves
the theorem.
Note that at this point it is unknown whether S is measurable. This is why
m(S) and not m (S) is written.
The following is the fundamental theorem of calculus from elementary calculus.
Lemma 16.3 Suppose g is a continuous function. Then for all x,
lim
râ†’0
1
m(B(x, r))
Z
B(x,r)
g(y)dy = g(x).

16.1.
THE FUNDAMENTAL THEOREM OF CALCULUS
431
Proof: Note that
g (x) =
1
m(B(x, r))
Z
B(x,r)
g (x) dy
and so
Â¯Â¯Â¯Â¯Â¯g (x) âˆ’
1
m(B(x, r))
Z
B(x,r)
g(y)dy
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
1
m(B(x, r))
Z
B(x,r)
(g(y) âˆ’g (x)) dy
Â¯Â¯Â¯Â¯Â¯
â‰¤
1
m(B(x, r))
Z
B(x,r)
|g(y) âˆ’g (x)| dy.
Now by continuity of g at x, there exists r > 0 such that if |x âˆ’y| < r, |g (y) âˆ’g (x)| <
Îµ. For such r, the last expression is less than
1
m(B(x, r))
Z
B(x,r)
Îµdy < Îµ.
This proves the lemma.
Deï¬nition 16.4 Let f âˆˆL1 Â¡
Rk, m
Â¢
. A point, x âˆˆRk is said to be a Lebesgue
point if
lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm = 0.
Note that if x is a Lebesgue point, then
lim
râ†’0
1
m (B (x, r))
Z
B(x,r)
f (y) dm = f (x) .
and so the symmetric derivative exists at all Lebesgue points.
Theorem 16.5
(Fundamental Theorem of Calculus) Let f âˆˆL1(Rk). Then there
exists a set of measure 0, N, such that if x /âˆˆN, then
lim
râ†’0
1
m(B(x, r))
Z
B(x,r)
|f(y) âˆ’f(x)|dy = 0.
Proof: Let Î» > 0 and let Îµ > 0. By density of Cc
Â¡
RkÂ¢
in L1 Â¡
Rk, m
Â¢
there exists
g âˆˆCc
Â¡
RkÂ¢
such that ||g âˆ’f||L1(Rk) < Îµ. Now since g is continuous,
lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm
=
lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm
âˆ’lim
râ†’0
1
m (B (x, r))
Z
B(x,r)
|g (y) âˆ’g (x)| dm

432
INTEGRALS AND DERIVATIVES
=
lim sup
râ†’0
Ãƒ
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| âˆ’|g (y) âˆ’g (x)| dm
!
â‰¤
lim sup
râ†’0
Ãƒ
1
m (B (x, r))
Z
B(x,r)
||f (y) âˆ’f (x)| âˆ’|g (y) âˆ’g (x)|| dm
!
â‰¤
lim sup
râ†’0
Ãƒ
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’g (y) âˆ’(f (x) âˆ’g (x))| dm
!
â‰¤
lim sup
râ†’0
Ãƒ
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’g (y)| dm
!
+ |f (x) âˆ’g (x)|
â‰¤
M ([f âˆ’g]) (x) + |f (x) âˆ’g (x)| .
Therefore,
"
x : lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm > Î»
#
âŠ†
Â·
M ([f âˆ’g]) > Î»
2
Â¸
âˆª
Â·
|f âˆ’g| > Î»
2
Â¸
Now
Îµ
>
Z
|f âˆ’g| dm â‰¥
Z
[|fâˆ’g|> Î»
2 ]
|f âˆ’g| dm
â‰¥
Î»
2 m
ÂµÂ·
|f âˆ’g| > Î»
2
Â¸Â¶
This along with the weak estimate of Theorem 16.2 implies
m
Ãƒ"
x : lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm > Î»
#!
<
Âµ 2
Î»5k + 2
Î»
Â¶
||f âˆ’g||L1(Rk)
<
Âµ 2
Î»5k + 2
Î»
Â¶
Îµ.
Since Îµ > 0 is arbitrary, it follows
mn
Ãƒ"
x : lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm > Î»
#!
= 0.
Now let
N =
"
x : lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm > 0
#

16.1.
THE FUNDAMENTAL THEOREM OF CALCULUS
433
and
Nn =
"
x : lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm > 1
n
#
It was just shown that m (Nn) = 0. Also, N = âˆªâˆž
n=1Nn. Therefore, m (N) = 0 also.
It follows that for x /âˆˆN,
lim sup
râ†’0
1
m (B (x, r))
Z
B(x,r)
|f (y) âˆ’f (x)| dm = 0
and this proves a.e. point is a Lebesgue point.
Of course it is suï¬ƒcient to assume f is only in L1
loc
Â¡
RkÂ¢
.
Corollary 16.6 (Fundamental Theorem of Calculus) Let f âˆˆL1
loc(Rk). Then there
exists a set of measure 0, N, such that if x /âˆˆN, then
lim
râ†’0
1
m(B(x, r))
Z
B(x,r)
|f(y) âˆ’f(x)|dy = 0.
Proof: Consider B (0, n) where n is a positive integer. Then fn â‰¡fXB(0,n) âˆˆ
L1 Â¡
RkÂ¢
and so there exists a set of measure 0, Nn such that if x âˆˆB (0, n) \ Nn,
then
lim
râ†’0
1
m(B(x, r))
Z
B(x,r)
|fn(y) âˆ’fn(x)|dy
=
lim
râ†’0
1
m(B(x, r))
Z
B(x,r)
|f(y) âˆ’f(x)|dy = 0.
Let N = âˆªâˆž
n=1Nn. Then if x /âˆˆN, the above equation holds.
Corollary 16.7
If f âˆˆL1
loc(Rn), then
lim
râ†’0
1
m(B(x, r))
Z
B(x,r)
f(y)dy = f(x) a.e. x.
(16.3)
Proof:
Â¯Â¯Â¯Â¯Â¯
1
m(B(x, r))
Z
B(x,r)
f(y)dy âˆ’f(x)
Â¯Â¯Â¯Â¯Â¯
â‰¤
1
m(B(x, r))
Z
B(x,r)
|f(y) âˆ’f(x)| dy
and the last integral converges to 0 a.e. x.
Deï¬nition 16.8
For N the set of Theorem 16.5 or Corollary 16.6, N C is called
the Lebesgue set or the set of Lebesgue points.
The next corollary is a one dimensional version of what was just presented.

434
INTEGRALS AND DERIVATIVES
Corollary 16.9
Let f âˆˆL1(R) and let
F(x) =
Z x
âˆ’âˆž
f(t)dt.
Then for a.e. x, F â€²(x) = f(x).
Proof: For h > 0
1
h
Z x+h
x
|f(y) âˆ’f(x)|dy â‰¤2( 1
2h)
Z x+h
xâˆ’h
|f(y) âˆ’f(x)|dy
By Theorem 16.5, this converges to 0 a.e. Similarly
1
h
Z x
xâˆ’h
|f(y) âˆ’f(x)|dy
converges to 0 a.e. x.
Â¯Â¯Â¯Â¯
F(x + h) âˆ’F(x)
h
âˆ’f(x)
Â¯Â¯Â¯Â¯ â‰¤1
h
Z x+h
x
|f(y) âˆ’f(x)|dy
(16.4)
and
Â¯Â¯Â¯Â¯
F(x) âˆ’F(x âˆ’h)
h
âˆ’f(x)
Â¯Â¯Â¯Â¯ â‰¤1
h
Z x
xâˆ’h
|f(y) âˆ’f(x)|dy.
(16.5)
Now the expression on the right in 16.4 and 16.5 converges to zero for a.e.
x.
Therefore, by 16.4, for a.e. x the derivative from the right exists and equals f (x)
while from 16.5 the derivative from the left exists and equals f (x) a.e. It follows
lim
hâ†’0
F(x + h) âˆ’F(x)
h
= f(x) a.e. x
This proves the corollary.
16.2
Absolutely Continuous Functions
Deï¬nition 16.10 Let [a, b] be a closed and bounded interval and let f : [a, b] â†’R.
Then f is said to be absolutely continuous if for every Îµ > 0 there exists Î´ > 0 such
that if Pm
i=1 |yi âˆ’xi| < Î´, then Pm
i=1 |f (yi) âˆ’f (xi)| < Îµ.
Deï¬nition 16.11 A ï¬nite subset, P of [a, b] is called a partition of [x, y] âŠ†[a, b] if
P = {x0, x1, Â· Â· Â·, xn} where
x = x0 < x1 < Â· Â· Â·, < xn = y.
For f : [a, b] â†’R and P = {x0, x1, Â· Â· Â·, xn} deï¬ne
VP [x, y] â‰¡
n
X
i=1
|f (xi) âˆ’f (xiâˆ’1)| .

16.2.
ABSOLUTELY CONTINUOUS FUNCTIONS
435
Denoting by P [x, y] the set of all partitions of [x, y] deï¬ne
V [x, y] â‰¡
sup
P âˆˆP[x,y]
VP [x, y] .
For simplicity, V [a, x] will be denoted by V (x) . It is called the total variation of
the function, f.
There are some simple facts about the total variation of an absolutely continuous
function, f which are contained in the next lemma.
Lemma 16.12 Let f be an absolutely continuous function deï¬ned on [a, b] and
let V be its total variation function as described above. Then V is an increasing
bounded function. Also if
P and Q are two partitions of [x, y] with P âŠ†Q, then
VP [x, y] â‰¤VQ [x, y] and if [x, y] âŠ†[z, w] ,
V [x, y] â‰¤V [z, w]
(16.6)
If P = {x0, x1, Â· Â· Â·, xn} is a partition of [x, y] , then
V [x, y] =
n
X
i=1
V [xi, xiâˆ’1] .
(16.7)
Also if y > x,
V (y) âˆ’V (x) â‰¥|f (y) âˆ’f (x)|
(16.8)
and the function, x â†’V (x) âˆ’f (x) is increasing. The total variation function, V
is absolutely continuous.
Proof: The claim that V is increasing is obvious as is the next claim about
P âŠ†Q leading to VP [x, y] â‰¤VQ [x, y] . To verify this, simply add in one point
at a time and verify that from the triangle inequality, the sum involved gets no
smaller. The claim that V is increasing consistent with set inclusion of intervals is
also clearly true and follows directly from the deï¬nition.
Now let t < V [x, y] where P0 = {x0, x1, Â· Â· Â·, xn} is a partition of [x, y] . There
exists a partition, P of [x, y] such that t < VP [x, y] . Without loss of generality it
can be assumed that {x0, x1, Â· Â· Â·, xn} âŠ†P since if not, you can simply add in the
points of P0 and the resulting sum for the total variation will get no smaller. Let
Pi be those points of P which are contained in [xiâˆ’1, xi] . Then
t < Vp [x, y] =
n
X
i=1
VPi [xiâˆ’1, xi] â‰¤
n
X
i=1
V [xiâˆ’1, xi] .
Since t < V [x, y] is arbitrary,
V [x, y] â‰¤
n
X
i=1
V [xi, xiâˆ’1]
(16.9)

436
INTEGRALS AND DERIVATIVES
Note that 16.9 does not depend on f being absolutely continuous. Suppose now
that f is absolutely continuous. Let Î´ correspond to Îµ = 1. Then if [x, y] is an
interval of length no larger than Î´, the deï¬nition of absolute continuity implies
V [x, y] < 1.
Then from 16.9
V [a, nÎ´] â‰¤
n
X
i=1
V [a + (i âˆ’1) Î´, a + iÎ´] <
n
X
i=1
1 = n.
Thus V is bounded on [a, b]. Now let Pi be a partition of [xiâˆ’1, xi] such that
VPi [xiâˆ’1, xi] > V [xiâˆ’1, xi] âˆ’Îµ
n
Then letting P = âˆªPi,
âˆ’Îµ +
n
X
i=1
V [xiâˆ’1, xi] <
n
X
i=1
VPi [xiâˆ’1, xi] = VP [x, y] â‰¤V [x, y] .
Since Îµ is arbitrary, 16.7 follows from this and 16.9.
Now let x < y
V (y) âˆ’f (y) âˆ’(V (x) âˆ’f (x))
=
V (y) âˆ’V (x) âˆ’(f (y) âˆ’f (x))
â‰¥
V (y) âˆ’V (x) âˆ’|f (y) âˆ’f (x)| â‰¥0.
It only remains to verify that V is absolutely continuous.
Let Îµ > 0 be given and let Î´ correspond to Îµ/2 in the deï¬nition of absolute conti-
nuity applied to f. Suppose Pn
i=1 |yi âˆ’xi| < Î´ and consider Pn
i=1 |V (yi) âˆ’V (xi)|.
By 16.9 this last equals Pn
i=1 V [xi, yi] . Now let Pi be a partition of [xi, yi] such
that VPi [xi, yi] +
Îµ
2n > V [xi, yi] . Then by the deï¬nition of absolute continuity,
n
X
i=1
|V (yi) âˆ’V (xi)|
=
n
X
i=1
V [xi, yi]
â‰¤
n
X
i=1
VPi [xi, yi] + Î· < Îµ/2 + Îµ/2 = Îµ.
and shows V is absolutely continuous as claimed.
Lemma 16.13 Suppose f : [a, b] â†’R is absolutely continuous and increasing.
Then f â€² exists a.e., is in L1 ([a, b]) , and
f (x) = f (a) +
Z x
a
f â€² (t) dt.

16.2.
ABSOLUTELY CONTINUOUS FUNCTIONS
437
Proof: Deï¬ne L, a positive linear functional on C ([a, b]) by
Lg â‰¡
Z b
a
gdf
where this integral is the Riemann Stieltjes integral with respect to the integrating
function, f. By the Riesz representation theorem for positive linear functionals,
there exists a unique Radon measure, Âµ such that Lg =
R
gdÂµ. Now consider the
following picture for gn âˆˆC ([a, b]) in which gn equals 1 for x between x + 1/n and
y.
Â¥
Â¥
Â¥
Â¥
Â¥
Â¥
Â¥
Â¥
D
D
D
D
D
D
D
D
x
y + 1/n
x + 1/n
y
Then gn (t) â†’X(x,y] (t) pointwise. Therefore, by the dominated convergence
theorem,
Âµ ((x, y]) = lim
nâ†’âˆž
Z
gndÂµ.
However,
Âµ
f (y) âˆ’f
Âµ
x + 1
n
Â¶Â¶
â‰¤
Z
gndÂµ =
Z b
a
gndf â‰¤
Âµ
f
Âµ
y + 1
n
Â¶
âˆ’f (y)
Â¶
+
Âµ
f (y) âˆ’f
Âµ
x + 1
n
Â¶Â¶
+
Âµ
f
Âµ
x + 1
n
Â¶
âˆ’f (x)
Â¶
and so as n â†’âˆžthe continuity of f implies
Âµ ((x, y]) = f (y) âˆ’f (x) .
Similarly, Âµ (x, y) = f (y) âˆ’f (y) and Âµ ([x, y]) = f (y) âˆ’f (x) , the argument used
to establish this being very similar to the above. It follows in particular that
f (x) âˆ’f (a) =
Z
[a,x]
dÂµ.
Note that up till now, no referrence has been made to the absolute continuity of f.
Any increasing continuous function would be ï¬ne.

438
INTEGRALS AND DERIVATIVES
Now if E is a Borel set such that m (E) = 0, Then the outer regularity of m
implies there exists an open set, V containing E such that m (V ) < Î´ where Î´
corresponds to Îµ in the deï¬nition of absolute continuity of f. Then letting {Ik} be
the connected components of V it follows E âŠ†âˆªâˆž
k=1Ik with P
k m (Ik) = m (V ) < Î´.
Therefore, from absolute continuity of f, it follows that for Ik = (ak, bk) and each
n
Âµ (âˆªn
k=1Ik) =
n
X
k=1
Âµ (Ik) =
n
X
k=1
|f (bk) âˆ’f (ak)| < Îµ
and so letting n â†’âˆž,
Âµ (E) â‰¤Âµ (V ) =
âˆž
X
k=1
|f (bk) âˆ’f (ak)| â‰¤Îµ.
Since Îµ is arbitrary, it follows Âµ (E) = 0. Therefore, Âµ â‰ªm and so by the Radon
Nikodym theorem there exists a unique h âˆˆL1 ([a, b]) such that
Âµ (E) =
Z
E
hdm.
In particular,
Âµ ([a, x]) = f (x) âˆ’f (a) =
Z
[a,x]
hdm.
From the fundamental theorem of calculus f â€² (x) = h (x) at every Lebesgue point
of h. Therefore, writing in usual notation,
f (x) = f (a) +
Z x
a
f â€² (t) dt
as claimed. This proves the lemma.
With the above lemmas, the following is the main theorem about absolutely
continuous functions.
Theorem 16.14 Let f : [a, b] â†’R be absolutely continuous if and only if f â€² (x)
exists a.e., f â€² âˆˆL1 ([a, b]) and
f (x) = f (a) +
Z x
a
f â€² (t) dt.
Proof: Suppose ï¬rst that f is absolutely continuous. By Lemma 16.12 the total
variation function, V is absolutely continuous and f (x) = V (x) âˆ’(V (x) âˆ’f (x))
where both V and V âˆ’f are increasing and absolutely continuous. By Lemma 16.13
f (x) âˆ’f (a)
=
V (x) âˆ’V (a) âˆ’[(V (x) âˆ’f (x)) âˆ’(V (a) âˆ’f (a))]
=
Z x
a
V â€² (t) dt âˆ’
Z x
a
(V âˆ’f)â€² (t) dt.

16.3. DIFFERENTIATION OF MEASURES WITH RESPECT TO LEBESGUE MEASURE439
Now f â€² exists and is in L1 becasue f = V âˆ’(V âˆ’f) and V and V âˆ’f have derivatives
in L1. Therefore, (V âˆ’f)â€² = V â€² âˆ’f â€² and so the above reduces to
f (x) âˆ’f (a) =
Z x
a
f â€² (t) dt.
This proves one half of the theorem.
Now suppose f â€² âˆˆL1 and f (x) = f (a) +
R x
a f â€² (t) dt. It is necessary to verify
that f is absolutely continuous. But this follows easily from Lemma 8.49 on Page
203 which implies that a single function, f â€² is uniformly integrable. This lemma
implies that if P
i |yi âˆ’xi| is suï¬ƒciently small then
X
i
Â¯Â¯Â¯Â¯
Z yi
xi
f â€² (t) dt
Â¯Â¯Â¯Â¯ =
X
i
|f (yi) âˆ’f (xi)| < Îµ.
16.3
Diï¬€erentiation Of Measures With Respect To
Lebesgue Measure
Recall the Vitali covering theorem in Corollary 10.20 on Page 279.
Corollary 16.15 Let E âŠ†Rn and let F, be a collection of open balls of bounded
radii such that F covers E in the sense of Vitali. Then there exists a countable
collection of disjoint balls from F, {Bj}âˆž
j=1, such that m(E \ âˆªâˆž
j=1Bj) = 0.
Deï¬nition 16.16 Let Âµ be a Radon mesure deï¬ned on Rn. Then
dÂµ
dm (x) â‰¡lim
râ†’0
Âµ (B (x, r))
m (B (x, r))
whenever this limit exists.
It turns out this limit exists for m a.e. x. To verify this here is another deï¬nition.
Deï¬nition 16.17 Let f (r) be a function having values in [âˆ’âˆž, âˆž] . Then
lim sup
râ†’0+
f (r)
â‰¡
lim
râ†’0 (sup {f (t) : t âˆˆ[0, r]})
lim inf
râ†’0+ f (r)
â‰¡
lim
râ†’0 (inf {f (t) : t âˆˆ[0, r]})
This is well deï¬ned because the function r â†’inf {f (t) : t âˆˆ[0, r]} is increasing and
r â†’sup {f (t) : t âˆˆ[0, r]} is decreasing. Also note that limrâ†’0+ f (r) exists if and
only if
lim sup
râ†’0+
f (r) = lim inf
râ†’0+ f (r)
and if this happens
lim
râ†’0+ f (r) = lim inf
râ†’0+ f (r) = lim sup
râ†’0+
f (r) .

440
INTEGRALS AND DERIVATIVES
The claims made in the above deï¬nition follow immediately from the deï¬nition
of what is meant by a limit in [âˆ’âˆž, âˆž] and are left for the reader.
Theorem 16.18 Let Âµ be a Borel measure on Rn then
dÂµ
dm (x) exists in [âˆ’âˆž, âˆž]
m a.e.
Proof:Let p < q and let p, q be rational numbers. Deï¬ne
Npq (M)
â‰¡
Â½
x âˆˆRn such that lim sup
râ†’0+
Âµ (B (x, r))
m (B (x, r)) > q
> p > lim inf
râ†’0+
Âµ (B (x, r))
m (B (x, r))
Â¾
âˆ©B (0, M) ,
Npq
â‰¡
Â½
x âˆˆRn such that lim sup
râ†’0+
Âµ (B (x, r))
m (B (x, r)) > q
> p > lim inf
râ†’0+
Âµ (B (x, r))
m (B (x, r))
Â¾
,
N
â‰¡
Â½
x âˆˆRn such that lim sup
râ†’0+
Âµ (B (x, r))
m (B (x, r)) >
lim inf
râ†’0+
Âµ (B (x, r))
m (B (x, r))
Â¾
.
I will show m (Npq (M)) = 0. Use outer regularity to obtain an open set, V con-
taining Npq (M) such that
m (Npq (M)) + Îµ > m (V ) .
From the deï¬nition of Npq (M) , it follows that for each x âˆˆNpq (M) there exist
arbitrarily small r > 0 such that
Âµ (B (x, r))
m (B (x, r)) < p.
Only consider those r which are small enough to be contained in B (0, M) so that
the collection of such balls has bounded radii. This is a Vitali cover of Npq (M) and
so by Corollary 16.15 there exists a sequence of disjoint balls of this sort, {Bi}âˆž
i=1
such that
Âµ (Bi) < pm (Bi) , m (Npq (M) \ âˆªâˆž
i=1Bi) = 0.
(16.10)
Now for x âˆˆNpq (M) âˆ©(âˆªâˆž
i=1Bi) (most of Npq (M)), there exist arbitrarily small
balls, B (x, r) , such that B (x, r) is contained in some set of {Bi}âˆž
i=1 and
Âµ (B (x, r))
m (B (x, r)) > q.
This is a Vitali cover of Npq (M)âˆ©(âˆªâˆž
i=1Bi) and so there exists a sequence of disjoint
balls of this sort,
Â©
Bâ€²
j
Âªâˆž
j=1 such that
m
Â¡
(Npq (M) âˆ©(âˆªâˆž
i=1Bi)) \ âˆªâˆž
j=1Bâ€²
j
Â¢
= 0, Âµ
Â¡
Bâ€²
j
Â¢
> qm
Â¡
Bâ€²
j
Â¢
.
(16.11)

16.3. DIFFERENTIATION OF MEASURES WITH RESPECT TO LEBESGUE MEASURE441
It follows from 16.10 and 16.11 that
m (Npq (M)) â‰¤m ((Npq (M) âˆ©(âˆªâˆž
i=1Bi))) â‰¤m
Â¡
âˆªâˆž
j=1Bâ€²
j
Â¢
(16.12)
Therefore,
X
j
Âµ
Â¡
Bâ€²
j
Â¢
>
q
X
j
m
Â¡
Bâ€²
j
Â¢
â‰¥qm (Npq (M) âˆ©(âˆªiBi)) = qm (Npq (M))
â‰¥
pm (Npq (M)) â‰¥p (m (V ) âˆ’Îµ) â‰¥p
X
i
m (Bi) âˆ’pÎµ
â‰¥
X
i
Âµ (Bi) âˆ’pÎµ â‰¥
X
j
Âµ
Â¡
Bâ€²
j
Â¢
âˆ’pÎµ.
It follows
pÎµ â‰¥(q âˆ’p) m (Npq (M))
Since Îµ is arbitrary, m (Npq (M)) = 0. Now Npq âŠ†âˆªâˆž
M=1Npq (M) and so m (Npq) =
0. Now
N = âˆªp.qâˆˆQNpq
and since this is a countable union of sets of measure zero, m (N) = 0 also. This
proves the theorem.
From Theorem 15.8 on Page 407 it follows that if Âµ is a complex measure then
|Âµ| is a ï¬nite measure. This makes possible the following deï¬nition.
Deï¬nition 16.19 Let Âµ be a real measure. Deï¬ne the following measures. For E
a measurable set,
Âµ+ (E)
â‰¡
1
2 (|Âµ| + Âµ) (E) ,
Âµâˆ’(E)
â‰¡
1
2 (|Âµ| âˆ’Âµ) (E) .
These are measures thanks to Theorem 15.7 on Page 406 and Âµ+ âˆ’Âµâˆ’= Âµ. These
measures have values in [0, âˆž). They are called the positive and negative parts of Âµ
respectively. For Âµ a complex measure, deï¬ne Re Âµ and Im Âµ by
Re Âµ (E)
â‰¡
1
2
Â³
Âµ (E) + Âµ (E)
Â´
Im Âµ (E)
â‰¡
1
2i
Â³
Âµ (E) âˆ’Âµ (E)
Â´
Then Re Âµ and Im Âµ are both real measures. Thus for Âµ a complex measure,
Âµ
=
Re Âµ+ âˆ’Re Âµâˆ’+ i
Â¡
Im Âµ+ âˆ’Im Âµâˆ’Â¢
=
Î½1 âˆ’Î½1 + i (Î½3 âˆ’Î½4)
where each Î½i is a real measure having values in [0, âˆž).

442
INTEGRALS AND DERIVATIVES
Then there is an obvious corollary to Theorem 16.18.
Corollary 16.20 Let Âµ be a complex Borel measure on Rn. Then
dÂµ
dm (x) exists
a.e.
Proof: Letting Î½i be deï¬ned in Deï¬nition 16.19. By Theorem 16.18, for m a.e.
x, dÎ½i
dm (x) exists. This proves the corollary because Âµ is just a ï¬nite sum of these
Î½i.
Theorem 15.2 on Page 399, the Radon Nikodym theorem, implies that if you have
two ï¬nite measures, Âµ and Î», you can write Î» as the sum of a measure absolutely
continuous with respect to Âµ and one which is singular to Âµ in a unique way. The
next topic is related to this. It has to do with the diï¬€erentiation of a measure which
is singular with respect to Lebesgue measure.
Theorem 16.21 Let Âµ be a Radon measure on Rn and suppose there exists a Âµ
measurable set, N such that for all Borel sets, E, Âµ (E) = Âµ (E âˆ©N) where m (N) =
0. Then
dÂµ
dm (x) = 0 m a.e.
Proof: For k âˆˆN, let
Bk (M)
â‰¡
Â½
x âˆˆN C : lim sup
râ†’0+
Âµ (B (x, r))
m (B (x, r)) > 1
k
Â¾
âˆ©B (0,M) ,
Bk
â‰¡
Â½
x âˆˆN C : lim sup
râ†’0+
Âµ (B (x, r))
m (B (x, r)) > 1
k
Â¾
,
B
â‰¡
Â½
x âˆˆN C : lim sup
râ†’0+
Âµ (B (x, r))
m (B (x, r)) > 0
Â¾
.
Let Îµ > 0. Since Âµ is regular, there exists H, a compact set such that H âŠ†
N âˆ©B (0, M) and
Âµ (N âˆ©B (0, M) \ H) < Îµ.
B(0, M)
N âˆ©B(0, M)
H
Bi
Bk(M)

16.3. DIFFERENTIATION OF MEASURES WITH RESPECT TO LEBESGUE MEASURE443
For each x âˆˆBk (M) , there exist arbitrarily small r > 0 such that B (x, r) âŠ†
B (0, M) \ H and
Âµ (B (x, r))
m (B (x, r)) > 1
k .
(16.13)
Two such balls are illustrated in the above picture. This is a Vitali cover of Bk (M)
and so there exists a sequence of disjoint balls of this sort, {Bi}âˆž
i=1 such that
m (Bk (M) \ âˆªiBi) = 0. Therefore,
m (Bk (M))
â‰¤
m (Bk (M) âˆ©(âˆªiBi)) â‰¤
X
i
m (Bi) â‰¤k
X
i
Âµ (Bi)
=
k
X
i
Âµ (Bi âˆ©N) = k
X
i
Âµ (Bi âˆ©N âˆ©B (0, M))
â‰¤
kÂµ (N âˆ©B (0, M) \ H) < Îµk
Since Îµ was arbitrary, this shows m (Bk (M)) = 0.
Therefore,
m (Bk) â‰¤
âˆž
X
M=1
m (Bk (M)) = 0
and m (B) â‰¤P
k m (Bk) = 0. Since m (N) = 0, this proves the theorem.
It is easy to obtain a diï¬€erent version of the above theorem. This is done with
the aid of the following lemma.
Lemma 16.22 Suppose Âµ is a Borel measure on Rn having values in [0, âˆž). Then
there exists a Radon measure, Âµ1 such that Âµ1 = Âµ on all Borel sets.
Proof: By assumption, Âµ (Rn) < âˆžand so it is possible to deï¬ne a positive
linear functional, L on Cc (Rn) by
Lf â‰¡
Z
fdÂµ.
By the Riesz representation theorem for positive linear functionals of this sort, there
exists a unique Radon measure, Âµ1 such that for all f âˆˆCc (Rn) ,
Z
fdÂµ1 = Lf =
Z
fdÂµ.
Now let V be an open set and let Kk â‰¡
Â©
x âˆˆV : dist
Â¡
x, V CÂ¢
â‰¤1/k
Âª
âˆ©B (0,k).
Then {Kk} is an incresing sequence of compact sets whose union is V. Let Kk â‰ºfk
â‰ºV. Then fk (x) â†’XV (x) for every x. Therefore,
Âµ1 (V ) = lim
kâ†’âˆž
Z
fkdÂµ1 = lim
kâ†’âˆž
Z
fkdÂµ = Âµ (V )
and so Âµ = Âµ1 on open sets. Now if K is a compact set, let
Vk â‰¡{x âˆˆRn : dist (x, K) < 1/k} .

444
INTEGRALS AND DERIVATIVES
Then Vk is an open set and âˆ©kVk = K. Letting K â‰ºfk â‰ºVk, it follows that
fk (x) â†’XK (x) for all x âˆˆRn. Therefore, by the dominated convergence theorem
with a dominating function, XRn
Âµ1 (K) = lim
kâ†’âˆž
Z
fkdÂµ1 = lim
kâ†’âˆž
Z
fkdÂµ = Âµ (K)
and so Âµ and Âµ1 are equal on all compact sets. It follows Âµ = Âµ1 on all countable
unions of compact sets and countable intersections of open sets.
Now let E be a Borel set. By regularity of Âµ1, there exist sets, H and G such
that H is the countable union of an increasing sequence of compact sets, G is the
countable intersection of a decreasing sequence of open sets, H âŠ†E âŠ†G, and
Âµ1 (H) = Âµ1 (G) = Âµ1 (E) . Therefore,
Âµ1 (H) = Âµ (H) â‰¤Âµ (E) â‰¤Âµ (G) = Âµ1 (G) = Âµ1 (E) = Âµ1 (H) .
therefore, Âµ (E) = Âµ1 (E) and this proves the lemma.
Corollary 16.23 Suppose Âµ is a complex Borel measure deï¬ned on Rn for which
there exists a Âµ measurable set, N such that for all Borel sets, E, Âµ (E) = Âµ (E âˆ©N)
where m (N) = 0. Then
dÂµ
dm (x) = 0 m a.e.
Proof: Each of Re Âµ+, Re Âµâˆ’, Im Âµ+, and Im Âµâˆ’are real measures having values
in [0, âˆž) and so by Lemma 16.22 each is a Radon measure having the same property
that Âµ has in terms of being supported on a set of m measure zero. Therefore, for
Î½ equal to any of these,
dÎ½
dm (x) = 0 m a.e. This proves the corollary.
16.4
Exercises
1. Suppose A and B are sets of positive Lebesgue measure in Rn. Show that
A âˆ’B must contain B (c, Îµ) for some c âˆˆRn and Îµ > 0.
A âˆ’B â‰¡{a âˆ’b : a âˆˆA and b âˆˆB} .
Hint: First assume both sets are bounded. This creates no loss of generality.
Next there exist a0 âˆˆA, b0 âˆˆB and Î´ > 0 such that
Z
B(a0,Î´)
XA (t) dt > 3
4m (B (a0, Î´)) ,
Z
B(b0,Î´)
XB (t) dt > 3
4m (B (b0, Î´)) .
Now explain why this implies
m (A âˆ’a0 âˆ©B (0,Î´)) > 3
4m (B (0, Î´))
and
m (B âˆ’b0 âˆ©B (0,Î´)) > 3
4m (B (0, Î´)) .

16.4.
EXERCISES
445
Explain why
m ((A âˆ’a0) âˆ©(B âˆ’b0)) > 1
2m (B (0, Î´)) > 0.
Let
f (x) â‰¡
Z
XAâˆ’a0 (x + t) XBâˆ’b0 (t) dt.
Explain why f (0) > 0. Next explain why f is continuous and why f (x) > 0
for all x âˆˆB (0, Îµ) for some Îµ > 0. Thus if |x| < Îµ, there exists t such that
x + t âˆˆA âˆ’a0 and t âˆˆB âˆ’b0. Subtract these.
2. Show Mf is Borel measurable by verifying that [Mf > Î»] â‰¡EÎ» is actually
an open set. Hint: If x âˆˆEÎ» then for some r,
R
B(x,r) |f| dm > Î»m (B (x, r)) .
Then for Î´ a small enough positive number,
R
B(x,r) |f| dm > Î»m (B (x, r + 2Î´)) .
Now pick y âˆˆB (x, Î´) and argue that B (y, Î´ + r) âŠ‡B (x, r) . Therefore show
that,
Z
B(y,Î´+r)
|f| dm >
Z
B(x,r)
|f| dm > Î»B (x, r + 2Î´) â‰¥Î»m (B (y, r + Î´)) .
Thus B (x, Î´) âŠ†EÎ».
3. Consider the following nested sequence of compact sets, {Pn}.Let P1 = [0, 1],
P2 =
Â£
0, 1
3
Â¤
âˆª
Â£ 2
3, 1
Â¤
, etc. To go from Pn to Pn+1, delete the open interval
which is the middle third of each closed interval in Pn. Let P = âˆ©âˆž
n=1Pn.
By the ï¬nite intersection property of compact sets, P Ì¸= âˆ…. Show m(P) = 0.
If you feel ambitious also show there is a one to one onto mapping of [0, 1]
to P. The set P is called the Cantor set. Thus, although P has measure
zero, it has the same number of points in it as [0, 1] in the sense that there
is a one to one and onto mapping from one to the other. Hint: There are
various ways of doing this last part but the most enlightenment is obtained
by exploiting the topological properties of the Cantor set rather than some
silly representation in terms of sums of powers of two and three. All you need
to do is use the Schroder Bernstein theorem and show there is an onto map
from the Cantor set to [0, 1]. If you do this right and remember the theorems
about characterizations of compact metric spaces, Proposition 6.12 on Page
136, you may get a pretty good idea why every compact metric space is the
continuous image of the Cantor set.
4. Consider the sequence of functions deï¬ned in the following way. Let f1 (x) = x
on [0, 1]. To get from fn to fn+1, let fn+1 = fn on all intervals where fn is
constant.
If fn is nonconstant on [a, b], let fn+1(a) = fn(a), fn+1(b) =
fn(b), fn+1 is piecewise linear and equal to 1
2(fn(a) + fn(b)) on the middle
third of [a, b]. Sketch a few of these and you will see the pattern. The process
of modifying a nonconstant section of the graph of this function is illustrated
in the following picture.

446
INTEGRALS AND DERIVATIVES
Â¡
Â¡
Â¡




Show {fn} converges uniformly on [0, 1]. If f(x) = limnâ†’âˆžfn(x), show that
f(0) = 0, f(1) = 1, f is continuous, and f â€²(x) = 0 for all x /âˆˆP where P is
the Cantor set of Problem 3. This function is called the Cantor function.It is
a very important example to remember. Note it has derivative equal to zero
a.e. and yet it succeeds in climbing from 0 to 1. Explain why this interesting
function is not absolutely continuous although it is continuous. Hint: This
isnâ€™t too hard if you focus on getting a careful estimate on the diï¬€erence
between two successive functions in the list considering only a typical small
interval in which the change takes place. The above picture should be helpful.
5. A function, f : [a, b] â†’R is Lipschitz if |f (x) âˆ’f (y)| â‰¤K |x âˆ’y| . Show
that every Lipschitz function is absolutely continuous. Thus every Lipschitz
function is diï¬€erentiable a.e., f â€² âˆˆL1, and f (y) âˆ’f (x) =
R y
x f â€² (t) dt.
6. Suppose f, g are both absolutely continuous on [a, b] . Show the product of
these functions is also absolutely continuous. Explain why (fg)â€² = f â€²g + gâ€²f
and show the usual integration by parts formula
f (b) g (b) âˆ’f (a) g (a) âˆ’
Z b
a
fgâ€²dt =
Z b
a
f â€²gdt.
7. In Problem 4 f â€² failed to give the expected result for
R b
a f â€²dx 1 but at least
f â€² âˆˆL1. Suppose f â€² exists for f a continuous function deï¬ned on [a, b] . Does
it follow that f â€² is measurable? Can you conclude f â€² âˆˆL1 ([a, b])?
8. A sequence of sets, {Ei} containing the point x is said to shrink to x nicely
if there exists a sequence of positive numbers, {ri} and a positive constant, Î±
such that ri â†’0 and
m (Ei) â‰¥Î±m (B (x, ri)) , Ei âŠ†B (x, ri) .
Show the above theorems about diï¬€erentiation of measures with respect to
Lebesgue measure all have a version valid for Ei replacing B (x, r) .
9. Suppose F (x) =
R x
a f (t) dt. Using the concept of nicely shrinking sets in
Problem 8 show F â€² (x) = f (x) a.e.
10. A random variable, X is a measurable real valued function deï¬ned on a mea-
sure space, (â„¦, S, P) where P is just a measure with P (â„¦) = 1 called a
probability measure. The distribution function for X is the function, F (x) â‰¡
P ([X â‰¤x]) in words, F (x) is the probability that X has values no larger than
x. Show that F is a right continuous increasing function with the property
that limxâ†’âˆ’âˆžF (x) = 0 and limxâ†’âˆžF (x) = 1.
1In this example, you only know that fâ€² exists a.e.

16.4.
EXERCISES
447
11. Suppose F is an increasing right continuous function.
(a) Show that Lf â‰¡
R b
a fdF is a well deï¬ned positive linear functional on
Cc (R) where here [a, b] is a closed interval containing the support of
f âˆˆCc (R) .
(b) Using the Riesz representation theorem for positive linear functionals on
Cc (R) , let Âµ denote the Radon measure determined by L. Show that
Âµ ((a, b]) = F (b) âˆ’F (a) and Âµ ({b}) = F (b) âˆ’F (bâˆ’) where F (bâˆ’) â‰¡
limxâ†’bâˆ’F (x) .
(c) Review Corollary 15.4 on Page 404 at this point. Show that the condi-
tions of this corollary hold for Âµ and m. Consider ÂµâŠ¥+ Âµ||, the Lebesgue
decomposition of Âµ where Âµ|| â‰ªm and there exists a set of m measure
zero, N such that ÂµâŠ¥(E) = ÂµâŠ¥(E âˆ©N) . Show Âµ ((0, x]) = ÂµâŠ¥((0, x]) +
R x
0 h (t) dt for some h âˆˆL1 (m) . Using Theorem 16.21 show h (x) = F â€² (x)
m a.e. Explain why F (x) = F (0) + S (x) +
R x
0 F â€² (t) dt for some func-
tion, S (x) which is increasing but has Sâ€² (x) = 0 a.e. Note this shows
in particular that a right continuous increasing function has a derivative
a.e.
12. Suppose now that G is just an increasing function deï¬ned on R. Show that
Gâ€² (x) exists a.e. Hint: You can mimic the proof of Theorem 16.18. The Dini
derivates are deï¬ned as
D+G (x)
â‰¡
lim inf
hâ†’0+
G (x + h) âˆ’G (x)
h
,
D+G (x)
â‰¡
lim sup
hâ†’0+
G (x + h) âˆ’G (x)
h
Dâˆ’G (x)
â‰¡
lim inf
hâ†’0+
G (x) âˆ’G (x âˆ’h)
h
,
Dâˆ’G (x)
â‰¡
lim sup
hâ†’0+
G (x) âˆ’G (x âˆ’h)
h
.
When D+G (x) = D+G (x) the derivative from the right exists and when
Dâˆ’G (x) = Dâˆ’G (x) , then the derivative from the left exists. Let (a, b) be an
open interval and let
Npq â‰¡
Â©
x âˆˆ(a, b) : D+G (x) > q > p > D+G (x)
Âª
.
Let V âŠ†(a, b) be an open set containing Npq such that n (V ) < m (Npq) + Îµ.
Show using a Vitali covering theorem there is a disjoint sequence of intervals
contained in V , {(xi, xi + hi)}âˆž
i=1 such that
G (xi + hi) âˆ’G (xi)
hi
< p.

448
INTEGRALS AND DERIVATIVES
Next show there is a disjoint sequence of intervals
Â©Â¡
xâ€²
i, xâ€²
j + hâ€²
j
Â¢Âªâˆž
j=1 such
that each of these is contained in one of the former intervals and
G
Â¡
xâ€²
j + hâ€²
j
Â¢
âˆ’G
Â¡
xâ€²
j
Â¢
hâ€²
j
> q,
X
j
hâ€²
j â‰¥m (Npq) .
Then
qm (Npq)
â‰¤
q
X
j
hâ€²
j â‰¤
X
j
G
Â¡
xâ€²
j + hâ€²
j
Â¢
âˆ’G
Â¡
xâ€²
j
Â¢
â‰¤
X
i
G (xi + hi) âˆ’G (xi)
â‰¤
p
X
i
hi â‰¤pm (V ) â‰¤p (m (Npq) + Îµ) .
Since Îµ was arbitrary, this shows m (Npq) = 0. Taking a union of all Npq
for p, q rational, shows the derivative from the right exists a.e. Do a similar
argument to show the derivative from the left exists a.e. and then show the
derivative from the left equals the derivative from the right a.e. using a simlar
argument. Thus Gâ€² (x) exists on (a, b) a.e. and so it exists a.e. on R because
(a, b) was arbitrary.

Hausdorï¬€Measure
17.1
Deï¬nition Of Hausdorï¬€Measures
This chapter is on Hausdorï¬€measures. First I will discuss some outer measures. In
all that is done here, Î± (n) will be the volume of the ball in Rn which has radius 1.
Deï¬nition 17.1 For a set, E, denote by r (E) the number which is half the diam-
eter of E. Thus
r (E) â‰¡1
2 sup {|x âˆ’y| : x, y âˆˆE} â‰¡1
2 diam (E)
Let E âŠ†Rn.
Hs
Î´(E) â‰¡inf{
âˆž
X
j=1
Î²(s)(r (Cj))s : E âŠ†âˆªâˆž
j=1Cj, diam(Cj) â‰¤Î´}
Hs(E) â‰¡lim
Î´â†’0 Hs
Î´(E).
In the above deï¬nition, Î² (s) is an appropriate positive constant depending on
s. Later I will tell what this constant is but it is not important for now.
Lemma 17.2 Hs and Hs
Î´ are outer measures.
Proof: It is clear that Hs(âˆ…) = 0 and if A âŠ†B, then Hs(A) â‰¤Hs(B) with
similar assertions valid for Hs
Î´. Suppose E = âˆªâˆž
i=1Ei and Hs
Î´(Ei) < âˆžfor each i.
Let {Ci
j}âˆž
j=1 be a covering of Ei with
âˆž
X
j=1
Î²(s)(r(Ci
j))s âˆ’Îµ/2i < Hs
Î´(Ei)
449

450
HAUSDORFF MEASURE
and diam(Ci
j) â‰¤Î´. Then
Hs
Î´(E)
â‰¤
âˆž
X
i=1
âˆž
X
j=1
Î²(s)(r(Ci
j))s
â‰¤
âˆž
X
i=1
Hs
Î´(Ei) + Îµ/2i
â‰¤
Îµ +
âˆž
X
i=1
Hs
Î´(Ei).
It follows that since Îµ > 0 is arbitrary,
Hs
Î´(E) â‰¤
âˆž
X
i=1
Hs
Î´(Ei)
which shows Hs
Î´ is an outer measure. Now notice that Hs
Î´(E) is increasing as Î´ â†’0.
Picking a sequence Î´k decreasing to 0, the monotone convergence theorem implies
Hs(E) â‰¤
âˆž
X
i=1
Hs(Ei).
This proves the lemma.
The outer measure Hs is called s dimensional Hausdorï¬€measure when restricted
to the Ïƒ algebra of Hs measurable sets.
Next I will show the Ïƒ algebra of Hs measurable sets includes the Borel sets.
This is done by the following very interesting condition known as Caratheodoryâ€™s
criterion.
17.1.1
Properties Of Hausdorï¬€Measure
Deï¬nition 17.3 For two sets, A, B in a metric space, we deï¬ne
dist (A, B) â‰¡inf {d (x, y) : x âˆˆA, y âˆˆB} .
Theorem 17.4 Let Âµ be an outer measure on the subsets of (X, d), a metric space.
If
Âµ(A âˆªB) = Âµ(A) + Âµ(B)
whenever dist(A, B) > 0, then the Ïƒ algebra of measurable sets contains the Borel
sets.
Proof: It suï¬ƒces to show that closed sets are in S, the Ïƒ-algebra of measurable
sets, because then the open sets are also in S and consequently S contains the Borel
sets. Let K be closed and let S be a subset of â„¦. Is Âµ(S) â‰¥Âµ(S âˆ©K) + Âµ(S \ K)?
It suï¬ƒces to assume Âµ(S) < âˆž. Let
Kn â‰¡{x : dist(x, K) â‰¤1
n}

17.1.
DEFINITION OF HAUSDORFF MEASURES
451
By Lemma 6.7 on Page 135, x â†’dist (x, K) is continuous and so Kn is closed. By
the assumption of the theorem,
Âµ(S) â‰¥Âµ((S âˆ©K) âˆª(S \ Kn)) = Âµ(S âˆ©K) + Âµ(S \ Kn)
(17.1)
since S âˆ©K and S \ Kn are a positive distance apart. Now
Âµ(S \ Kn) â‰¤Âµ(S \ K) â‰¤Âµ(S \ Kn) + Âµ((Kn \ K) âˆ©S).
(17.2)
If limnâ†’âˆžÂµ((Kn \ K) âˆ©S) = 0 then the theorem will be proved because this limit
along with 17.2 implies limnâ†’âˆžÂµ (S \ Kn) = Âµ (S \ K) and then taking a limit in
17.1, Âµ(S) â‰¥Âµ(S âˆ©K) + Âµ(S \ K) as desired. Therefore, it suï¬ƒces to establish this
limit.
Since K is closed, a point, x /âˆˆK must be at a positive distance from K and so
Kn \ K = âˆªâˆž
k=nKk \ Kk+1.
Therefore
Âµ(S âˆ©(Kn \ K)) â‰¤
âˆž
X
k=n
Âµ(S âˆ©(Kk \ Kk+1)).
(17.3)
If
âˆž
X
k=1
Âµ(S âˆ©(Kk \ Kk+1)) < âˆž,
(17.4)
then Âµ(S âˆ©(Kn \ K)) â†’0 because it is dominated by the tail of a convergent series
so it suï¬ƒces to show 17.4.
M
X
k=1
Âµ(S âˆ©(Kk \ Kk+1)) =
X
k even, kâ‰¤M
Âµ(S âˆ©(Kk \ Kk+1)) +
X
k odd, kâ‰¤M
Âµ(S âˆ©(Kk \ Kk+1)).
(17.5)
By the construction, the distance between any pair of sets, S âˆ©(Kk \ Kk+1) for
diï¬€erent even values of k is positive and the distance between any pair of sets,
S âˆ©(Kk \ Kk+1) for diï¬€erent odd values of k is positive. Therefore,
X
k even, kâ‰¤M
Âµ(S âˆ©(Kk \ Kk+1)) +
X
k odd, kâ‰¤M
Âµ(S âˆ©(Kk \ Kk+1)) â‰¤
Âµ(
[
k even
S âˆ©(Kk \ Kk+1)) + Âµ(
[
k odd
S âˆ©(Kk \ Kk+1)) â‰¤2Âµ (S) < âˆž
and so for all M, PM
k=1 Âµ(S âˆ©(Kk \ Kk+1)) â‰¤2Âµ (S) showing 17.4 and proving the
theorem.
With the above theorem, the following theorem is easy to obtain. This property
is sometimes called Borel regularity.

452
HAUSDORFF MEASURE
Theorem 17.5 The Ïƒ algebra of Hs measurable sets contains the Borel sets and
Hs has the property that for all E âŠ†Rn, there exists a Borel set F âŠ‡E such that
Hs(F) = Hs(E).
Proof: Let dist(A, B) = 2Î´0 > 0. Is it the case that
Hs(A) + Hs(B) = Hs(A âˆªB)?
This is what is needed to use Caratheodoryâ€™s criterion.
Let {Cj}âˆž
j=1be a covering of A âˆªB such that diam(Cj) â‰¤Î´ < Î´0 for each j and
Hs
Î´(A âˆªB) + Îµ >
âˆž
X
j=1
Î²(s)(r (Cj))s.
Thus
Hs
Î´(A âˆªBË™) + Îµ >
X
jâˆˆJ1
Î²(s)(r (Cj))s +
X
jâˆˆJ2
Î²(s)(r (Cj))s
where
J1 = {j : Cj âˆ©A Ì¸= âˆ…}, J2 = {j : Cj âˆ©B Ì¸= âˆ…}.
Recall dist(A, B) = 2Î´0, J1 âˆ©J2 = âˆ…. It follows
Hs
Î´(A âˆªB) + Îµ > Hs
Î´(A) + Hs
Î´(B).
Letting Î´ â†’0, and noting Îµ > 0 was arbitrary, yields
Hs(A âˆªB) â‰¥Hs(A) + Hs(B).
Equality holds because Hs is an outer measure. By Caratheodoryâ€™s criterion, Hs is
a Borel measure.
To verify the second assertion, note ï¬rst there is no loss of generality in letting
Hs (E) < âˆž. Let
E âŠ†âˆªâˆž
j=1Cj, diam(Cj) < Î´,
and
Hs
Î´(E) + Î´ >
âˆž
X
j=1
Î²(s)(r (Cj))s.
Let
FÎ´ = âˆªâˆž
j=1Cj.
Thus FÎ´ âŠ‡E and
Hs
Î´(E)
â‰¤
Hs
Î´(FÎ´) â‰¤
âˆž
X
j=1
Î²(s)(r
Â¡
Cj
Â¢
)s
=
âˆž
X
j=1
Î²(s)(r (Cj))s < Î´ + Hs
Î´(E).

17.1.
DEFINITION OF HAUSDORFF MEASURES
453
Let Î´k â†’0 and let F = âˆ©âˆž
k=1FÎ´k. Then F âŠ‡E and
Hs
Î´k(E) â‰¤Hs
Î´k(F) â‰¤Hs
Î´k(FÎ´) â‰¤Î´k + Hs
Î´k(E).
Letting k â†’âˆž,
Hs(E) â‰¤Hs(F) â‰¤Hs(E)
and this proves the theorem.
A measure satisfying the conclusion of Theorem 17.5 is sometimes called a Borel
regular measure.
17.1.2
Hn And mn
Next I will compare Hn and mn. To do this, recall the following covering theorem
which is a summary of Corollaries 10.20 and 10.19 found on Page 279.
Theorem 17.6 Let E âŠ†Rn and let F, be a collection of balls of bounded radii
such that F covers E in the sense of Vitali. Then there exists a countable collection
of disjoint balls from F, {Bj}âˆž
j=1, such that mn(E \ âˆªâˆž
j=1Bj) = 0.
Lemma 17.7 There exists a constant, k such that Hn (E) â‰¤kmn (E) for all E
Borel. Also, if Q0 â‰¡[0, 1)n, the unit cube, then Hn ([0, 1)n) > 0.
Proof:
First let U be an open set and letting Î´ > 0, consider all balls, B
contained in U which have diameters less than Î´. This is a Vitali covering of U and
therefore by Theorem 17.6, there exists {Bi} , a sequence of disjoint balls of radii
less than Î´ contained in U such that âˆªâˆž
i=1Bi diï¬€ers from U by a set of Lebesgue
measure zero. Let Î± (n) be the Lebesgue measure of the unit ball in Rn. Then
Hn
Î´ (U)
â‰¤
âˆž
X
i=1
Î² (n) r (Bi)n = Î² (n)
Î± (n)
âˆž
X
i=1
Î± (n) r (Bi)n
=
Î² (n)
Î± (n)
âˆž
X
i=1
mn (Bi) = Î² (n)
Î± (n)mn (U) â‰¡kmn (U) .
Now letting E be Borel, it follows from the outer regularity of mn there exists
a decreasing sequence of open sets, {Vi} containing E such such that mn (Vi) â†’
mn (E) . Then from the above,
Hn
Î´ (E) â‰¤lim
iâ†’âˆžHn
Î´ (Vi) â‰¤lim
iâ†’âˆžkmn (Vi) = kmn (E) .
Since Î´ > 0 is arbitrary, it follows that also
Hn (E) â‰¤kmn (E) .
This proves the ï¬rst part of the lemma.
To verify the second part, note that it is obvious Hn
Î´ and Hn are translation
invariant because diameters of sets do not change when translated. Therefore, if

454
HAUSDORFF MEASURE
Hn ([0, 1)n) = 0, it follows Hn (Rn) = 0 because Rn is the countable union of
translates of Q0 â‰¡[0, 1)n. Since each Hn
Î´ is no larger than Hn, the same must hold
for Hn
Î´ . Therefore, there exists a sequence of sets, {Ci} each having diameter less
than Î´ such that
1 >
âˆž
X
i=1
Î² (n) r (Ci)n .
Now let Bi be a ball having radius equal to diam (Ci) = 2r (Ci) which contains Ci.
It follows
mn (Bi) = Î± (n) 2nr (Ci)n = Î± (n) 2n
Î² (n) Î² (n) r (Ci)n
which implies
1 >
âˆž
X
i=1
Î² (n) r (Ci)n =
âˆž
X
i=1
Î² (n)
Î± (n) 2n mn (Bi) = âˆž,
a contradiction. This proves the lemma.
Theorem 17.8 If Î² (n) â‰¡Î± (n) , then Hn = mn on all Lebesgue measurable sets.
Proof: First I will show Hn is a positive multiple of mn. Let
k = mn (Q0)
Hn (Q0)
I will show kHn (E) = mn (E). When this is done, it will follow that by adjusting
Î² (n) the multiple can be taken to be 1. I will only need to show that the right
value for Î² (n) is Î± (n). Recall Lemma 10.2 on Page 267 which is listed here for
convenience.
Lemma 17.9 Every open set in Rn is the countable disjoint union of half open
boxes of the form
n
Y
i=1
(ai, ai + 2âˆ’k]
where ai = l2âˆ’k for some integers, l, k. The sides of these boxes are of equal length.
One could also have half open boxes of the form
n
Y
i=1
[ai, ai + 2âˆ’k)
and the conclusion would be unchanged.
Let Q = Qn
i=1[ai, ai + 2âˆ’k) be one of the half open boxes just mentioned in the
above lemma. By translation invariance, of Hn and mn
Â¡
2kÂ¢n Hn (Q) = Hn (Q0) = 1
k mn (Q0) = 1
k
Â¡
2kÂ¢n mn (Q) .

17.1.
DEFINITION OF HAUSDORFF MEASURES
455
Therefore, kHn (Q) = mn (Q) . It follows from Lemma 10.2 on Page 267 stated
above that kHn (U) = mn (U) for all open sets.
It follows immediately, since
every compact set is the countable intersection of open sets that kHn = mn on
compact sets. Therefore, they are also equal on all closed sets because every closed
set is the countable union of compact sets. Now let F be an arbitrary Lebesgue
measurable set. I will show that F is Hn measurable and that kHn (F) = mn (F).
Let Fl = B (0, l) âˆ©F. Then there exists H a countable union of compact sets and
G a countable intersection of open sets such that
H âŠ†Fl âŠ†G
(17.6)
and
mn (G \ H) = kHn (G \ H) = 0.
(17.7)
To do this, let {Gi} be a decreasing sequence of bounded open sets containing Fl
and let {Hi} be an increasing sequence of compact sets contained in Fl such that
kHn (Gi \ Hi) = mn (Gi \ Hi) < 2âˆ’i
Then letting G = âˆ©iGi and H = âˆªiHi this establishes 17.6 and 17.7. Then by
completeness of Hn it follows Fl is Hn measurable and
kHn (Fl) = kHn (H) = mn (H) = mn (Fl) .
Now taking l â†’âˆž, it follows F is Hn measurable and kHn (F) = mn (F). There-
fore, adjusting Î² (n) it can be assumed the constant, k is 1.
It only remains to show that the proper determination of Î² (n) is Î± (n). By the
Vitali covering theorem, there exists a sequence of disjoint balls, {Bi} such that
B (0, 1) = (âˆªâˆž
i=1Bi) âˆªN where mn (N) = 0. Then Hn
Î´ (N) = 0 can be concluded
because Hn
Î´ â‰¤Hnand Hn (N) = 0. Therefore,
Hn
Î´ (B (0, 1))
=
Hn
Î´ (âˆªiBi) â‰¤
âˆž
X
i=1
Î² (n) r (Bi)n
=
Î² (n)
Î± (n)
âˆž
X
i=1
Î± (n) r (Bi)n = Î² (n)
Î± (n)
âˆž
X
i=1
mn (Bi)
=
Î² (n)
Î± (n)mn (âˆªiBi) = Î² (n)
Î± (n)mn (B (0, 1)) = Î² (n)
Î± (n)Hn (B (0, 1))
Taking the limit as Î´ â†’0,
Hn (B (0, 1)) â‰¤Î² (n)
Î± (n)Hn (B (0, 1))
and so Î± (n) â‰¤Î² (n) .

456
HAUSDORFF MEASURE
Also
Hn (B (0, 1))
â‰¥
Hn
Î´ (B (0, 1)) = Hn
Î´ (âˆªiBi) =
âˆž
X
i=1
Hn
Î´ (Bi)
â‰¥
âˆž
X
i=1
Î² (n) r (Bi)n = Î² (n)
Î± (n)
âˆž
X
i=1
Î± (n) r (Bi)n
=
Î² (n)
Î± (n)
âˆž
X
i=1
mn (Bi) = Î² (n)
Î± (n)mn (B (0, 1))
=
Î² (n)
Î± (n)Hn (B (0, 1))
which shows Î± (n) â‰¥Î² (n) and so the two are equal. This proves the theorem.
This gives another way to think of Lebesgue measure which is a particularly nice
way because it is coordinate free, depending only on the notion of distance.
For s < n, note that Hs is not a Radon measure because it will not generally be
ï¬nite on compact sets. For example, let n = 2 and consider H1(L) where L is a line
segment joining (0, 0) to (1, 0). Then H1(L) is no smaller than H1(L) when L is
considered a subset of R1, n = 1. Thus by what was just shown, H1(L) â‰¥1. Hence
H1([0, 1] Ã— [0, 1]) = âˆž. The situation is this: L is a one-dimensional object inside
R2 and H1 is giving a one-dimensional measure of this object. In fact, Hausdorï¬€
measures can make such heuristic remarks as these precise. Deï¬ne the Hausdorï¬€
dimension of a set, A, as
dim(A) = inf{s : Hs(A) = 0}
17.1.3
A Formula For Î± (n)
What is Î±(n)? Recall the gamma function which makes sense for all p > 0.
Î“ (p) â‰¡
Z âˆž
0
eâˆ’ttpâˆ’1dt.
Lemma 17.10 The following identities hold.
pÎ“(p) = Î“(p + 1),
Î“(p)Î“(q) =
ÂµZ 1
0
xpâˆ’1(1 âˆ’x)qâˆ’1dx
Â¶
Î“(p + q),
Î“
Âµ1
2
Â¶
= âˆšÏ€
Proof: Using integration by parts,
Î“ (p + 1)
=
Z âˆž
0
eâˆ’ttpdt = âˆ’eâˆ’ttp|âˆž
0 + p
Z âˆž
0
eâˆ’ttpâˆ’1dt
=
pÎ“ (p)

17.1.
DEFINITION OF HAUSDORFF MEASURES
457
Next
Î“ (p) Î“ (q)
=
Z âˆž
0
eâˆ’ttpâˆ’1dt
Z âˆž
0
eâˆ’ssqâˆ’1ds
=
Z âˆž
0
Z âˆž
0
eâˆ’(t+s)tpâˆ’1sqâˆ’1dtds
=
Z âˆž
0
Z âˆž
s
eâˆ’u (u âˆ’s)pâˆ’1 sqâˆ’1duds
=
Z âˆž
0
Z u
0
eâˆ’u (u âˆ’s)pâˆ’1 sqâˆ’1dsdu
=
Z âˆž
0
Z 1
0
eâˆ’u (u âˆ’ux)pâˆ’1 (ux)qâˆ’1 udxdu
=
Z âˆž
0
Z 1
0
eâˆ’uup+qâˆ’1 (1 âˆ’x)pâˆ’1 xqâˆ’1dxdu
=
Î“ (p + q)
ÂµZ 1
0
xpâˆ’1(1 âˆ’x)qâˆ’1dx
Â¶
.
It remains to ï¬nd Î“
Â¡ 1
2
Â¢
.
Î“
Âµ1
2
Â¶
=
Z âˆž
0
eâˆ’ttâˆ’1/2dt =
Z âˆž
0
eâˆ’u2 1
u2udu = 2
Z âˆž
0
eâˆ’u2du
Now
ÂµZ âˆž
0
eâˆ’x2dx
Â¶2
=
Z âˆž
0
eâˆ’x2dx
Z âˆž
0
eâˆ’y2dy =
Z âˆž
0
Z âˆž
0
eâˆ’(x2+y2)dxdy
=
Z âˆž
0
Z Ï€/2
0
eâˆ’r2rdÎ¸dr = 1
4Ï€
and so
Î“
Âµ1
2
Â¶
= 2
Z âˆž
0
eâˆ’u2du = âˆšÏ€
This proves the lemma.
Next let n be a positive integer.
Theorem 17.11 Î±(n) = Ï€n/2(Î“(n/2 + 1))âˆ’1 where Î“(s) is the gamma function
Î“(s) =
Z âˆž
0
eâˆ’ttsâˆ’1dt.
Proof: First let n = 1.
Î“(3
2) = 1
2Î“
Âµ1
2
Â¶
=
âˆšÏ€
2 .

458
HAUSDORFF MEASURE
Thus
Ï€1/2(Î“(1/2 + 1))âˆ’1 =
2
âˆšÏ€
âˆšÏ€ = 2 = Î± (1) .
and this shows the theorem is true if n = 1.
Assume the theorem is true for n and let Bn+1 be the unit ball in Rn+1. Then
by the result in Rn,
mn+1(Bn+1) =
Z 1
âˆ’1
Î±(n)(1 âˆ’x2
n+1)n/2dxn+1
= 2Î±(n)
Z 1
0
(1 âˆ’t2)n/2dt.
Doing an integration by parts and using Lemma 17.10
=
2Î±(n)n
Z 1
0
t2(1 âˆ’t2)(nâˆ’2)/2dt
=
2Î±(n)n1
2
Z 1
0
u1/2(1 âˆ’u)n/2âˆ’1du
=
nÎ±(n)
Z 1
0
u3/2âˆ’1(1 âˆ’u)n/2âˆ’1du
=
nÎ±(n)Î“(3/2)Î“(n/2)(Î“((n + 3)/2))âˆ’1
=
nÏ€n/2(Î“(n/2 + 1))âˆ’1(Î“((n + 3)/2))âˆ’1Î“(3/2)Î“(n/2)
=
nÏ€n/2(Î“(n/2)(n/2))âˆ’1(Î“((n + 1)/2 + 1))âˆ’1Î“(3/2)Î“(n/2)
=
2Ï€n/2Î“(3/2)(Î“((n + 1)/2 + 1))âˆ’1
=
Ï€(n+1)/2(Î“((n + 1)/2 + 1))âˆ’1.
This proves the theorem.
From now on, in the deï¬nition of Hausdorï¬€measure, it will always be the case
that Î² (s) = Î± (s) . As shown above, this is the right thing to have Î² (s) equal to if s
is a positive integer because this yields the important result that Hausdorï¬€measure
is the same as Lebesgue measure. Note the formula, Ï€s/2(Î“(s/2+1))âˆ’1 makes sense
for any s â‰¥0.
17.1.4
Hausdorï¬€Measure And Linear Transformations
Hausdorï¬€measure makes possible a uniï¬ed development of n dimensional area.
As in the case of Lebesgue measure, the ï¬rst step in this is to understand basic
considerations related to linear transformations. Recall that for L âˆˆL
Â¡
Rk, RlÂ¢
, Lâˆ—
is deï¬ned by
(Lu, v) = (u, Lâˆ—v) .
Also recall Theorem 4.59 on Page 87 which is stated here for convenience. This
theorem says you can write a linear transformation as the composition of two linear
transformations, one which preserves length and the other which distorts. The one

17.1.
DEFINITION OF HAUSDORFF MEASURES
459
which distorts is the one which will have a nontrivial interaction with Hausdorï¬€
measure while the one which preserves lengths does not change Hausdorï¬€measure.
These ideas are behind the following theorems and lemmas.
Theorem 17.12 Let F be an n Ã— m matrix where m â‰¥n. Then there exists an
m Ã— n matrix R and a n Ã— n matrix U such that
F = RU, U = U âˆ—,
all eigenvalues of U are non negative,
U 2 = F âˆ—F, Râˆ—R = I,
and |Rx| = |x|.
Lemma 17.13 Let R âˆˆL(Rn, Rm), n â‰¤m, and Râˆ—R = I. Then if A âŠ†Rn,
Hn(RA) = Hn(A).
In fact, if P : Rn â†’Rm satisï¬es |Px âˆ’Py| = |x âˆ’y| , then
Hn (PA) = Hn (A) .
Proof: Note that
|R(x âˆ’y)|2= (R (x âˆ’y) , R (x âˆ’y)) = (Râˆ—R (x âˆ’y) , x âˆ’y) = |x âˆ’y|2
Thus R preserves lengths.
Now let P be an arbitrary mapping which preserves lengths and let A be
bounded, P(A) âŠ†âˆªâˆž
j=1Cj, diam(Cj) â‰¤Î´, and
Hn
Î´ (PA) + Îµ >
âˆž
X
j=1
Î±(n)(r(Cj))n.
Since P preserves lengths, it follows P is one to one on P (Rn) and P âˆ’1 also preserves
lengths on P (Rn) . Replacing each Cj with Cj âˆ©(PA),
Hn
Î´ (PA) + Îµ
>
âˆž
X
j=1
Î±(n)r(Cj âˆ©(PA))n
=
âˆž
X
j=1
Î±(n)r
Â¡
P âˆ’1 (Cj âˆ©(PA))
Â¢n
â‰¥
Hn
Î´ (A).
Thus Hn
Î´ (PA) â‰¥Hn
Î´ (A).
Now let A âŠ†âˆªâˆž
j=1Cj, diam(Cj) â‰¤Î´, and
Hn
Î´ (A) + Îµ â‰¥
âˆž
X
j=1
Î±(n) (r (Cj))n

460
HAUSDORFF MEASURE
Then
Hn
Î´ (A) + Îµ
â‰¥
âˆž
X
j=1
Î±(n) (r (Cj))n
=
âˆž
X
j=1
Î±(n) (r (PCj))n
â‰¥
Hn
Î´ (PA).
Hence Hn
Î´ (PA) = Hn
Î´ (A).
Letting Î´ â†’0 yields the desired conclusion in the
case where A is bounded.
For the general case, let Ar = A âˆ©B (0, r).
Then
Hn(PAr) = Hn(Ar). Now let r â†’âˆž. This proves the lemma.
Lemma 17.14 Let F âˆˆL(Rn, Rm), n â‰¤m, and let F = RU where R and U are
described in Theorem 4.59 on Page 87. Then if A âŠ†Rn is Lebesgue measurable,
Hn(FA) = det(U)mn(A).
Proof: Using Theorem 10.28 on Page 282 and Theorem 17.8,
Hn(FA) = Hn(RUA)
= Hn(UA) = mn(UA) = det(U)mn(A).
Deï¬nition 17.15 Deï¬ne J to equal det(U). Thus
J = det((F âˆ—F)1/2) = (det(F âˆ—F))1/2.
17.2
The Area Formula
17.2.1
Preliminary Results
It was shown in Lemma 17.14 that
Hn(FA) = det(U)mn(A)
where F = RU with R preserving distances and U a symmetric matrix having
all positive eigenvalues.
The area formula gives a generalization of this simple
relationship to the case where F is replaced by a nonlinear mapping, h. It contains
as a special case the earlier change of variables formula. There are two parts to this
development. The ï¬rst part is to generalize Lemma 17.14 to the case of nonlinear
maps. When this is done, the area formula can be presented.
In this section, U will be an open set in Rn on which h is deï¬ned and A âŠ†U
will be a Lebesgue measurable set. Assume m â‰¥n and
h : U â†’Rm is continuous,
(17.8)

17.2.
THE AREA FORMULA
461
Dh (x) exists for all x âˆˆA,
(17.9)
Also assume that for every x âˆˆA, there exists Rx and Lx such that for all y, z âˆˆ
B (x, Rx) ,
|h (z) âˆ’h (y)| â‰¤Lx |x âˆ’y|
(17.10)
This last condition is weaker than saying h is Lipschitz. Instead, it is an assumption
that h is locally Lipshitz, the Lipschitz constant depending on the point considered.
An interesting case in which this would hold would be when h is diï¬€erentiable on
U and ||Dh (x)|| is uniformly bounded near each point x. Actually, it is the case
that 17.10 will suï¬ƒce to obtain 17.9 on all but a subset of measure zero of A but
this has not been shown yet. Also, the condition 17.8 is redundant because you
can simply replace U with the union of the sets B (x, Rx) for x âˆˆA. I think it
is easiest to retain this condition because diï¬€erentiability is deï¬ned for functions
whose domains are open sets. To make this more formal, here is a deï¬nition.
Deï¬nition 17.16 Let h be deï¬ned in some open set containing a set, A. Then h
is locally Lipschitz on A if for every x âˆˆA there exits Rx > 0 and a constant, Lx
such that whenever y, z âˆˆB (x, Rx) ,
|h (z) âˆ’h (y)| â‰¤Lx |z âˆ’y| .
Lemma 17.17 If T âŠ†A and mn (T) = 0, then Hn (h (T)) = 0.
Proof: Let
Tk â‰¡{x âˆˆT : ||Dh (x)|| < k} .
Thus T = âˆªkTk. I will show h (Tk) has Hn measure zero and then it will follow
that
h (T) = âˆªâˆž
k=1h (Tk)
must also have measure zero.
Let Îµ > 0 be given. By outer regularity, there exists an open set, V , containing
Tk which is contained in U such that mn (V ) <
Îµ
kn6n . For x âˆˆTk it follows from
diï¬€erentiability,
h (x + v) = h (x) + Dh (x) v + o (v)
and so whenever rx is small enough, B (x,5rx) âŠ†V and whenever |v| < 5rx, |o (v)| <
krx. Therefore, if |v| < 5rx,
Dh (x) v + o (v) âˆˆB (0, 5krx) + B (0,krx) âŠ†B (0, 6krx)
and so
h (B (x, 5rx)) âŠ†B (h (x) , 6krx).
Letting Î´ > 0 be given, the Vitali covering theorem implies there exists a sequence
of disjoint balls {Bi}, Bi = B (xi, rxi), which are contained in V such that the
sequence of enlarged balls,
n
bBi
o
, having the same center but 5 times the radius,
covers Tk and 6krxi < Î´. Then
Hn
Î´ (h (Tk)) â‰¤Hn
Î´
Â³
h
Â³
âˆªâˆž
i=1 bBi
Â´Â´

462
HAUSDORFF MEASURE
â‰¤
âˆž
X
i=1
Hn
Î´
Â³
h
Â³
bBi
Â´Â´
â‰¤
âˆž
X
i=1
Hn
Î´ (B (h (xi) , 6krxi))
â‰¤
âˆž
X
i=1
Î± (n) (6krxi)n = (6k)n
âˆž
X
i=1
Î± (n) rn
xi
=
(6k)n
âˆž
X
i=1
mn (B (xi, rxi))
â‰¤
(6k)n mn (V ) â‰¤(6k)n
Îµ
kn6n = Îµ.
Since Îµ > 0 is arbitrary, this shows Hn
Î´ (h (Tk)) = 0. Since Î´ is arbitrary, this implies
Hn (h (Tk)) = 0. Now
Hn (h (T)) = lim
kâ†’âˆžHn (h (Tk)) = 0.
This proves the lemma.
Lemma 17.18 If S is a Lebesgue measurable subset of A, then h (S) is Hn mea-
surable.
Proof: Let Sk = S âˆ©B (0, k) , k âˆˆN. By inner regularity of Lebesgue measure,
there exists a set, F, which is the countable union of compact sets and a set T with
mn (T) = 0 such that
F âˆªT = Sk.
Then h (F) âŠ†h (Sk) âŠ†h (F)âˆªh (T). By continuity of h, h (F) is a countable union
of compact sets and so it is Borel. By Lemma 17.17, Hn (h (T)) = 0 and so h (Sk)
is Hn measurable because of completeness of Hausdorï¬€measure, which comes from
Hn being obtained from an outer measure. Now h (S) = âˆªâˆž
k=1h (Sk) and so it is
also true that h (S) is Hn measurable. This proves the lemma.
The following lemma, depending on the Brouwer ï¬xed point theorem and found
in Rudin [45], will be important for the following arguments. The idea is that if a
continuous function mapping a ball in Rk to Rk doesnâ€™t move any point very much,
then the image of the ball must contain a slightly smaller ball.
Lemma 17.19 Let B = B (0, r), a ball in Rk and let F : B â†’Rk be continuous
and suppose for some Îµ < 1,
|F (v) âˆ’v| < Îµr
(17.11)
for all v âˆˆB. Then
F (B) âŠ‡B (0, r (1 âˆ’Îµ)) .
Proof: Suppose a âˆˆB (0, r (1 âˆ’Îµ)) \ F (B) .
I claim that a Ì¸= F (v) for all v âˆˆB. Here is why. By assumption, if F (v) = a,
then |v| = r and so
|F (v) âˆ’v| = |a âˆ’v| â‰¥|v| âˆ’|a| > r âˆ’r (1 âˆ’Îµ) = rÎµ,

17.2.
THE AREA FORMULA
463
a contradiction to 17.11.
Now letting G :B â†’B, be deï¬ned by
G (v) â‰¡r (a âˆ’F (v))
|a âˆ’F (v)| ,
it follows G is continuous. Then by the Brouwer ï¬xed point theorem, G (v) = v for
some v âˆˆB. Using the formula for G, it follows |v| = r. Taking the inner product
with v,
(G (v) , v)
=
|v|2 = r2 =
r
|a âˆ’F (v)| (a âˆ’F (v) , v)
=
r
|a âˆ’F (v)| (a âˆ’v + v âˆ’F (v) , v)
=
r
|a âˆ’F (v)| [(a âˆ’v, v) + (v âˆ’F (v) , v)]
=
r
|a âˆ’F (v)|
h
(a, v) âˆ’|v|2 + (v âˆ’F (v) , v)
i
â‰¤
r
|a âˆ’F (v)|
Â£
r2 (1 âˆ’Îµ) âˆ’r2+r2Îµ
Â¤
= 0,
a contradiction to |v| = r. Therefore, B (0, r (1 âˆ’Îµ)) \ F (B) = âˆ…and this proves
the lemma.
By Theorem 4.59 on Page 87, when Dh (x) exists,
Dh (x) = R (x) U (x)
where (U (x) u, v) = (U (x) v, u) , (U (x) u, u) â‰¥0 and Râˆ—R = I.
Lemma 17.20 In this situation, |Râˆ—u| â‰¤|u|.
Proof: First note that
(uâˆ’RRâˆ—u,RRâˆ—u)
=
(u,RRâˆ—u) âˆ’|RRâˆ—u|2
=
|Râˆ—u|2 âˆ’|Râˆ—u|2 = 0,
and so
|u|2
=
|uâˆ’RRâˆ—u+RRâˆ—u|2
=
|uâˆ’RRâˆ—u|2 + |RRâˆ—u|2
=
|uâˆ’RRâˆ—u|2 + |Râˆ—u|2.
This proves the lemma.
Lemma 17.21 If |Px âˆ’Py| â‰¤L |x âˆ’y| , then for E a set,
Hn (PE) â‰¤LnHn (E) .

464
HAUSDORFF MEASURE
Proof: Without loss of generality, assume Hn (E) < âˆž. Let Î´ > 0 and let
{Ci}âˆž
i=1 be a covering of E such that diam (Ci) â‰¤Î´ for each i and
âˆž
X
i=1
Î± (n) r (Ci)n â‰¤Hn
Î´ (E) + Îµ.
Then {PCi}âˆž
i=1 is a covering of PE such that diam (PCi) â‰¤LÎ´. Therefore,
Hn
LÎ´ (PE)
â‰¤
âˆž
X
i=1
Î± (n) r (PCi)n
â‰¤
Ln
âˆž
X
i=1
Î± (n) r (Ci)n â‰¤LnHn
Î´ (E) + LnÎµ
â‰¤
Hn (E) + Îµ.
Letting Î´ â†’0,
Hn (PE) â‰¤LnHn (E) + LnÎµ
and since Îµ > 0 is arbitrary, this proves the Lemma.
Then the following corollary follows from Lemma 17.20.
Corollary 17.22 Let T âŠ†Rm. Then
Hn (T) â‰¥Hn (RRâˆ—T) = Hn (Râˆ—T).
Deï¬nition 17.23 Let E be a Lebesgue measurable set. x âˆˆE is a point of density
if
lim
râ†’0
mn(E âˆ©B(x, r))
mn(B(x, r))
= 1.
Recall that from the fundamental theorem of calculus applied to XE almost
every point of E is a point of density.
Lemma 17.24 Let x âˆˆA be a point where U (x)âˆ’1 exists. Then if Îµ âˆˆ(0, 1) the
following hold for all r small enough.
h (B (x, r)) âŠ†h (x) + R (x) U (x) B (0, r (1 + Îµ)),
(17.12)
Hn (h (B (x,r))) â‰¤mn (U (x) B (0, r (1 + Îµ))).
(17.13)
Râˆ—(x) h (B (x, r)) âŠ‡Râˆ—(x) h (x) + U (x) B (0, r (1 âˆ’Îµ)),
(17.14)
Hn (h (B (x,r))) â‰¥mn (U (x) B (0, r (1 âˆ’Îµ))),
(17.15)
If x is also a point of density of A, then
lim
râ†’0
Hn (h (B (x, r) âˆ©A))
Hn (h (B (x, r)))
= 1.
(17.16)

17.2.
THE AREA FORMULA
465
Proof: Since Dh (x) exists,
h (x + v) = h (x) + Dh (x) v+o (|v|).
(17.17)
Consequently, when r is small enough, 17.12 holds.
Using the fact R (x) preserves all distances, and Theorem 17.8 which says Hn =
mn on the Borel sets of Rn implies,
Hn (h (B (x,r))) â‰¤Hn (R (x) U (x) B (0, r (1 + Îµ)))
= Hn (U (x) B (0, r (1 + Îµ))) = mn (U (x) B (0, r (1 + Îµ)))
which shows 17.13.
From 17.17,
Râˆ—(x) h (x + v) = Râˆ—(x) h (x) + U (x) (v+o (|v|)).
Thus, from the assumption that U (x)âˆ’1 exists and letting F (v) be given by
F (v) â‰¡U (x)âˆ’1 Râˆ—(x) h (x + v) âˆ’U (x)âˆ’1 Râˆ—(x) h (x)
(17.18)
It follows
F (v) âˆ’v = o (|v|)
and so Lemma 17.19 implies that for all r small enough,
F (B (0, r))
â‰¡
U (x)âˆ’1 Râˆ—(x) h (x+B (0,r)) âˆ’U (x)âˆ’1 Râˆ—(x) h (x)
âŠ‡
B (0, (1 âˆ’Îµ) r).
Therefore,
Râˆ—(x) h (B (x,r)) âŠ‡Râˆ—(x) h (x) + U (x) B (0, (1 âˆ’Îµ) r)
which proves 17.14. Therefore,
R (x) Râˆ—(x) h (B (x, r)) âŠ‡
R (x) Râˆ—(x) h (x) + R (x) U (x) B (0, r (1 âˆ’Îµ)).
From Lemma 17.22, this implies
Hn (h (B (x,r)))
â‰¥
Hn (Râˆ—(x) h (B (x, r)))
=
Hn (R (x) Râˆ—(x) h (B (x, r)))
â‰¥Hn (R (x) U (x) B (0, r (1 âˆ’Îµ)))
= Hn (U (x) B (0, r (1 âˆ’Îµ))) = mn (U (x) B (0, r (1 âˆ’Îµ)))
which shows 17.15.

466
HAUSDORFF MEASURE
Now suppose that x is also a point of density of A. Then whenever r is small
enough,
mn (A âˆ©B (x, r))
mn (B (x, r))
> 1 âˆ’Îµ.
Consequently, for such r,
1
=
mn (A âˆ©B (x, r))
mn (B (x, r))
+ mn (B (x,r) \ A)
mn (B (x, r))
>
1 âˆ’Îµ + mn (B (x,r) \ A)
Î± (n) rn
and so
mn (B (x,r) \ A) < ÎµÎ± (n) rn.
(17.19)
Also,
h (B (x, r) âˆ©A) âˆªh (B (x, r) \ A) = h (B (x, r))
and so
Hn (h (B (x, r) âˆ©A)) + Hn (h (B (x, r) \ A))
â‰¥
Hn (h (B (x, r)))
Then also letting r also be smaller than Rx mentioned in 17.10, it follows from
Lemmas 17.21, 17.18, and 17.19, 17.14 that
1
â‰¥
Hn (h (B (x, r) âˆ©A))
Hn (h (B (x, r)))
â‰¥
Hn (h (B (x, r))) âˆ’Hn (h (B (x,r) \ A))
Hn (h (B (x, r)))
â‰¥
1 âˆ’
Ln
xmn (B (x,r) \ A)
Hn (Râˆ—(x) h (B (x, r)))
â‰¥
1 âˆ’
Ln
xmn (B (x,r) \ A)
mn (U (x) B (0, r (1 âˆ’Îµ)))
â‰¥
1 âˆ’
Ln
xÎµÎ± (n) rn
det (U (x)) Î± (n) rn (1 âˆ’Îµ)n
=
1 âˆ’g (Îµ)
where limÎµâ†’0 g (Îµ) = 0. Since Îµ is arbitrary, this proves 17.16.
The next theorem is the generalization of Lemma 17.14 to nonlinear maps.
Theorem 17.25 Let h : U â†’Rm where U is an open set in Rn for n â‰¤m and
suppose h is locally Lipschitz at every point of a Lebesgue measurable subset, A of
U. Also suppose that for every x âˆˆA, Dh (x) exists. Then for x âˆˆA,
J (x) = lim
râ†’0
Hn (h (B (x, r)))
mn (B (x,r))
,
(17.20)
where J (x) â‰¡det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.

17.2.
THE AREA FORMULA
467
Proof:
Suppose ï¬rst that U (x)âˆ’1 exists. Using 17.15, 17.13 and the change
of variables formula for linear maps,
J (x) (1 âˆ’Îµ)n
=
mn (U (x) B (0,r (1 âˆ’Îµ)))
mn (B (x, r))
â‰¤Hn (h(B (x, r)))
mn (B (x, r))
â‰¤
mn (U (x) B (0,r (1 + Îµ)))
mn (B (x, r))
= J (x) (1 + Îµ)n
whenever r is small enough. It follows that since Îµ > 0 is arbitrary, 17.20 holds.
Now suppose U (x)âˆ’1 does not exist. The ï¬rst part shows that the conclusion
of the theorem holds when J (x) Ì¸= 0. I will apply this to a modiï¬ed function. Let
k : Rn â†’Rm Ã— Rn
be deï¬ned as
k (x) â‰¡
Âµ h (x)
Îµx
Â¶
.
Then
Dk (x)âˆ—Dk (x) = Dh (x)âˆ—Dh (x) + Îµ2In
and so
Jk (x)2
â‰¡
det
Â¡
Dh (x)âˆ—Dh (x) + Îµ2In
Â¢
=
det
Â¡
Qâˆ—DQ + Îµ2In
Â¢
where D is a diagonal matrix having the nonnegative eigenvalues of Dh (x)âˆ—Dh (x)
down the main diagonal. Thus, since one of these eigenvalues equals 0, letting Î»2
i
denote the ith eigenvalue, there exists a constant, C independent of Îµ such that
0 < Jk (x)2 =
n
Y
i=1
Â¡
Î»2
i + Îµ2Â¢
â‰¤C2Îµ2.
(17.21)
Therefore, what was just shown applies to k.
Let
T â‰¡
n
(h (w) , 0)T : w âˆˆB (x,r)
o
,
TÎµ
â‰¡
n
(h (w) , Îµw)T : w âˆˆB (x,r)
o
â‰¡
k (B (x,r)),
then
T = PTÎµ
where P is the projection map deï¬ned by
P
Âµ
x
y
Â¶
â‰¡
Âµ
x
0
Â¶
.

468
HAUSDORFF MEASURE
Since P decreases distances, it follows from Lemma 17.21
Hn (h (B (x,r)))
=
Hn (T) = Hn (PTÎµ)
â‰¤
Hn (TÎµ) = Hn (k (B (x,r))) .
It follows from 17.21 and the ï¬rst part of the proof applied to k that
CÎµ
â‰¥
Jk (x) = lim
râ†’0
Hn (k (B (x, r)))
mn (B (x,r))
â‰¥
lim sup
râ†’0
Hn (h (B (x, r)))
mn (B (x,r))
.
Since Îµ is arbitrary, this establishes 17.20 in the case where U (x)âˆ’1 does not exist
and completes the proof of the theorem.
Deï¬ne the following set for future reference.
S â‰¡{x âˆˆA : U (x)âˆ’1 does not exist}
(17.22)
17.2.2
The Area Formula
Assume h : A â†’Rm is one to one in addition to 17.8 - 17.10. Since h is one to one,
Lemma 17.18 implies one can deï¬ne a measure, Î½, on the Ïƒâˆ’algebra of Lebesgue
measurable sets as follows.
Î½ (E) â‰¡Hn (h (E âˆ©A)).
By Lemma 17.18, this is a measure and Î½ â‰ªm.
Therefore by the corollary
to the Radon Nikodym theorem, Corollary 15.3 on Page 402, there exists f âˆˆ
L1
loc (Rn) , f â‰¥0, f (x) = 0 if x /âˆˆA, and
Î½ (E) =
Z
E
fdm =
Z
Aâˆ©E
fdm.
What is f? I will show that f (x) = J (x) = det (U (x)) a.e. Deï¬ne
E â‰¡{x âˆˆA : x is not a point of density of A} âˆª
{x âˆˆA : x is not a Lebesgue point of f}.
Then E is a set of measure zero and if x âˆˆ(A \ E), Lemma 17.24 and Theorem
17.25 imply
f (x)
=
lim
râ†’0
1
mn (B (x,r))
Z
B(x,r)
f (y) dm
=
lim
râ†’0
Hn (h (B (x,r) âˆ©A))
mn (B (x,r))
=
lim
râ†’0
Hn (h (B (x,r) âˆ©A))
Hn (h (B (x,r)))
Hn (h (B (x,r)))
mn (B (x,r))
=
J (x).

17.2.
THE AREA FORMULA
469
Therefore, f (x) = J (x) a.e., whenever x âˆˆA \ E.
Now let F be a Borel set in Rm. Recall this implies F is Hn measurable. Then
Z
h(A)
XF (y) dHn
=
Z
XF âˆ©h(A) (y) dHn
=
Hn Â¡
h
Â¡
hâˆ’1 (F) âˆ©A
Â¢Â¢
=
Î½
Â¡
hâˆ’1 (F)
Â¢
=
Z
XAâˆ©hâˆ’1(F ) (x) J (x) dm
=
Z
A
XF (h (x)) J (x) dm.
(17.23)
Note there are no measurability questions in the above formula because hâˆ’1 (F) is
a Borel set due to the continuity of h. The Borel measurability of J (x) also follows
from the observation that h is continuous and therefore, the partial derivatives are
Borel measurable, being the limit of continuous functions.
Then J (x) is just a
continuous function of these partial derivatives. However, things are not so clear
if E is only assumed Hn measurable. Is there a similar formula for F only Hn
measurable?
First consider the case where E is only Hn measurable but
Hn (E âˆ©h (A)) = 0.
By Theorem 17.5 on Page 452, there exists a Borel set F âŠ‡E âˆ©h (A) such that
Hn (F) = Hn (E âˆ©h (A)) = 0.
Then from 17.23,
XAâˆ©hâˆ’1(F ) (x) J (x) = 0 a.e.
But
0 â‰¤XAâˆ©hâˆ’1(E) (x) J (x) â‰¤XAâˆ©hâˆ’1(F ) (x) J (x)
(17.24)
which shows the two functions in 17.24 are equal a.e. Therefore XAâˆ©hâˆ’1(E) (x) J (x)
is Lebesgue measurable and so from 17.23,
0 =
Z
XEâˆ©h(A) (y) dHn =
Z
XF âˆ©h(A) (y) dHn
=
Z
XAâˆ©hâˆ’1(F ) (x) J (x) dmn =
Z
XAâˆ©hâˆ’1(E) (x) J (x) dmn,
(17.25)
which shows 17.23 holds in this case where
Hn (E âˆ©h (A)) = 0.
Now let AR â‰¡A âˆ©B (0,R) where R is large enough that AR Ì¸= âˆ…and let E
be Hn measurable. By Theorem 17.5, there exists F âŠ‡E âˆ©h (AR) such that F is
Borel and
Hn (F \ (E âˆ©h (AR))) = 0.
(17.26)

470
HAUSDORFF MEASURE
Then
(E âˆ©h (AR)) âˆª(F \ (E âˆ©h (AR)) âˆ©h (AR)) = F âˆ©h (AR)
and so
XARâˆ©hâˆ’1(F )J = XARâˆ©hâˆ’1(E)J + XARâˆ©hâˆ’1(F \(Eâˆ©h(AR)))J
where from 17.26 and 17.25, the second function on the right of the equal sign is
Lebesgue measurable and equals zero a.e. Therefore, the ï¬rst function on the right
of the equal sign is also Lebesgue measurable and equals the function on the left
a.e. Thus,
Z
XEâˆ©h(AR) (y) dHn =
Z
XF âˆ©h(AR) (y) dHn
=
Z
XARâˆ©hâˆ’1(F ) (x) J (x) dmn =
Z
XARâˆ©hâˆ’1(E) (x) J (x) dmn.
(17.27)
Letting R â†’âˆžyields 17.27 with A replacing AR and the function
x â†’XARâˆ©hâˆ’1(E) (x) J (x)
is Lebesgue measurable. Writing this in a more familiar form yields
Z
h(A)
XE (y) dHn =
Z
A
XE (h (x)) J (x) dmn.
(17.28)
From this, it follows that if s is a nonnegative Hn measurable simple function, 17.28
continues to be valid with s in place of XE. Then approximating an arbitrary non-
negative Hn measurable function, g, by an increasing sequence of simple functions,
it follows that 17.28 holds with g in place of XE and there are no measurability
problems because x â†’g (h (x)) J (x) is Lebesgue measurable. This proves the area
formula.
Theorem 17.26 Let g : h (A) â†’[0, âˆž] be Hn measurable where h is a continuous
function and A is a Lebesgue measurable set which satisï¬es 17.8 - 17.10. That is,
U is an open set in Rn on which h is deï¬ned and A âŠ†U is a Lebesgue measurable
set, m â‰¥n, and
h : A â†’Rm is continuous,
(17.29)
Dh (x) exists for all x âˆˆA,
(17.30)
Also assume that for every x âˆˆA, there exists Rx and Lx such that for all y, z âˆˆ
B (x, Rx) ,
|h (z) âˆ’h (y)| â‰¤Lx |x âˆ’y|
(17.31)
Then
x â†’(g â—¦h) (x) J (x)
is Lebesgue measurable and
Z
h(A)
g (y) dHn =
Z
A
g (h (x)) J (x) dm
where J (x) = det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.

17.3.
THE AREA FORMULA ALTERNATE VERSION
471
17.3
The Area Formula Alternate Version
17.3.1
Preliminary Results
It was shown in Lemma 17.14 that
Hn(FA) = det(U)mn(A)
where F = RU with R preserving distances and U a symmetric matrix having
all positive eigenvalues.
The area formula gives a generalization of this simple
relationship to the case where F is replaced by a nonlinear mapping, h. It contains
as a special case the earlier change of variables formula. There are two parts to this
development. The ï¬rst part is to generalize Lemma 17.14 to the case of nonlinear
maps. When this is done, the area formula can be presented.
In this section, U will be an open set in Rn on which h is deï¬ned and A âŠ†U
will be a Lebesgue measurable set. Assume m â‰¥n and
h : U â†’Rm is continuous,
(17.32)
Dh (x) exists for all x âˆˆA,
(17.33)
Hn (h (U \ A)) = 0
(17.34)
These conditions are diï¬€erent than the ones considered earlier. Here no Lipschitz
assumption is needed on h. In this sense, these conditions are more general than
those considered earlier. However, they are not really more general because of 17.34
which says that A is essentially an open set. This was not necessary earlier. The area
formula which results from the above conditions is a generalization of the change
of variables formula given in Rudin [45] and the proof is essentially the same as the
proof given in this book with modiï¬cations to account for the Hausdorï¬€measure.
Lemma 17.27 If T âŠ†A and mn (T) = 0, then Hn (h (T)) = 0.
Proof: Let
Tk â‰¡{x âˆˆT : ||Dh (x)|| < k} .
Thus T = âˆªkTk. I will show h (Tk) has Hn measure zero and then it will follow
that
h (T) = âˆªâˆž
k=1h (Tk)
must also have measure zero.
Let Îµ > 0 be given. By outer regularity, there exists an open set, V , containing
Tk which is contained in U such that mn (V ) <
Îµ
kn6n . For x âˆˆTk it follows from
diï¬€erentiability,
h (x + v) = h (x) + Dh (x) v + o (v)
and so whenever rx is small enough, B (x,5rx) âŠ†V and whenever |v| < 5rx, |o (v)| <
krx. Therefore, if |v| < 5rx,
Dh (x) v + o (v) âˆˆB (0, 5krx) + B (0,krx) âŠ†B (0, 6krx)

472
HAUSDORFF MEASURE
and so
h (B (x, 5rx)) âŠ†B (h (x) , 6krx).
Letting Î´ > 0 be given, the Vitali covering theorem implies there exists a sequence
of disjoint balls {Bi}, Bi = B (xi, rxi), which are contained in V such that the
sequence of enlarged balls,
n
bBi
o
, having the same center but 5 times the radius,
covers Tk and 6krxi < Î´. Then
Hn
Î´ (h (Tk)) â‰¤Hn
Î´
Â³
h
Â³
âˆªâˆž
i=1 bBi
Â´Â´
â‰¤
âˆž
X
i=1
Hn
Î´
Â³
h
Â³
bBi
Â´Â´
â‰¤
âˆž
X
i=1
Hn
Î´ (B (h (xi) , 6krxi))
â‰¤
âˆž
X
i=1
Î± (n) (6krxi)n = (6k)n
âˆž
X
i=1
Î± (n) rn
xi
=
(6k)n
âˆž
X
i=1
mn (B (xi, rxi))
â‰¤
(6k)n mn (V ) â‰¤(6k)n
Îµ
kn6n = Îµ.
Since Îµ > 0 is arbitrary, this shows Hn
Î´ (h (Tk)) = 0. Since Î´ is arbitrary, this implies
Hn (h (Tk)) = 0. Now
Hn (h (T)) = lim
kâ†’âˆžHn (h (Tk)) = 0.
This proves the lemma.
Lemma 17.28 If S is a Lebesgue measurable subset of A, then h (S) is Hn mea-
surable.
Proof: Let Sk = S âˆ©B (0, k) , k âˆˆN. By inner regularity of Lebesgue measure,
there exists a set, F, which is the countable union of compact sets and a set T with
mn (T) = 0 such that
F âˆªT = Sk.
Then h (F) âŠ†h (Sk) âŠ†h (F)âˆªh (T). By continuity of h, h (F) is a countable union
of compact sets and so it is Borel. By Lemma 17.27, Hn (h (T)) = 0 and so h (Sk)
is Hn measurable because of completeness of Hausdorï¬€measure, which comes from
Hn being obtained from an outer measure. Now h (S) = âˆªâˆž
k=1h (Sk) and so it is
also true that h (S) is Hn measurable. This proves the lemma.
The following lemma, depending on the Brouwer ï¬xed point theorem and found
in Rudin [45], will be important for the following arguments. The idea is that if a
continuous function mapping a ball in Rk to Rk doesnâ€™t move any point very much,
then the image of the ball must contain a slightly smaller ball.

17.3.
THE AREA FORMULA ALTERNATE VERSION
473
Lemma 17.29 Let B = B (0, r), a ball in Rk and let F : B â†’Rk be continuous
and suppose for some Îµ < 1,
|F (v) âˆ’v| < Îµr
(17.35)
for all v âˆˆB. Then
F (B) âŠ‡B (0, r (1 âˆ’Îµ)) .
Proof: Suppose a âˆˆB (0, r (1 âˆ’Îµ)) \ F (B) .
I claim that a Ì¸= F (v) for all v âˆˆB. Here is why. By assumption, if F (v) = a,
then |v| = r and so
|F (v) âˆ’v| = |a âˆ’v| â‰¥|v| âˆ’|a| > r âˆ’r (1 âˆ’Îµ) = rÎµ,
a contradiction to 17.35.
Now letting G :B â†’B, be deï¬ned by
G (v) â‰¡r (a âˆ’F (v))
|a âˆ’F (v)| ,
it follows G is continuous. Then by the Brouwer ï¬xed point theorem, G (v) = v for
some v âˆˆB. Using the formula for G, it follows |v| = r. Taking the inner product
with v,
(G (v) , v)
=
|v|2 = r2 =
r
|a âˆ’F (v)| (a âˆ’F (v) , v)
=
r
|a âˆ’F (v)| (a âˆ’v + v âˆ’F (v) , v)
=
r
|a âˆ’F (v)| [(a âˆ’v, v) + (v âˆ’F (v) , v)]
=
r
|a âˆ’F (v)|
h
(a, v) âˆ’|v|2 + (v âˆ’F (v) , v)
i
â‰¤
r
|a âˆ’F (v)|
Â£
r2 (1 âˆ’Îµ) âˆ’r2+r2Îµ
Â¤
= 0,
a contradiction to |v| = r. Therefore, B (0, r (1 âˆ’Îµ)) \ F (B) = âˆ…and this proves
the lemma.
By Theorem 4.59 on Page 87, when Dh (x) exists,
Dh (x) = R (x) U (x)
where (U (x) u, v) = (U (x) v, u) , (U (x) u, u) â‰¥0 and Râˆ—R = I.
Lemma 17.30 In this situation, |Râˆ—u| â‰¤|u|.
Proof: First note that
(uâˆ’RRâˆ—u,RRâˆ—u)
=
(u,RRâˆ—u) âˆ’|RRâˆ—u|2
=
|Râˆ—u|2 âˆ’|Râˆ—u|2 = 0,

474
HAUSDORFF MEASURE
and so
|u|2
=
|uâˆ’RRâˆ—u+RRâˆ—u|2
=
|uâˆ’RRâˆ—u|2 + |RRâˆ—u|2
=
|uâˆ’RRâˆ—u|2 + |Râˆ—u|2.
This proves the lemma.
Lemma 17.31 If |Px âˆ’Py| â‰¤L |x âˆ’y| , then for E a set,
Hn (PE) â‰¤LnHn (E) .
Proof: Without loss of generality, assume Hn (E) < âˆž. Let Î´ > 0 and let
{Ci}âˆž
i=1 be a covering of E such that diam (Ci) â‰¤Î´ for each i and
âˆž
X
i=1
Î± (n) r (Ci)n â‰¤Hn
Î´ (E) + Îµ.
Then {PCi}âˆž
i=1 is a covering of PE such that diam (PCi) â‰¤LÎ´. Therefore,
Hn
LÎ´ (PE)
â‰¤
âˆž
X
i=1
Î± (n) r (PCi)n
â‰¤
Ln
âˆž
X
i=1
Î± (n) r (Ci)n â‰¤LnHn
Î´ (E) + LnÎµ
â‰¤
Hn (E) + Îµ.
Letting Î´ â†’0,
Hn (PE) â‰¤LnHn (E) + LnÎµ
and since Îµ > 0 is arbitrary, this proves the Lemma.
Then the following corollary follows from Lemma 17.30.
Corollary 17.32 Let T âŠ†Rm. Then
Hn (T) â‰¥Hn (RRâˆ—T) = Hn (Râˆ—T).
Deï¬nition 17.33 Let E be a Lebesgue measurable set. x âˆˆE is a point of density
if
lim
râ†’0
mn(E âˆ©B(x, r))
mn(B(x, r))
= 1.
Recall that from the fundamental theorem of calculus applied to XE almost
every point of E is a point of density.

17.3.
THE AREA FORMULA ALTERNATE VERSION
475
Lemma 17.34 Let x âˆˆA be a point where U (x)âˆ’1 exists. Then if Îµ âˆˆ(0, 1) the
following hold for all r small enough.
h (B (x, r)) âŠ†h (x) + R (x) U (x) B (0, r (1 + Îµ)),
(17.36)
Hn (h (B (x,r))) â‰¤mn (U (x) B (0, r (1 + Îµ))).
(17.37)
Râˆ—(x) h (B (x, r)) âŠ‡Râˆ—(x) h (x) + U (x) B (0, r (1 âˆ’Îµ)),
(17.38)
Hn (h (B (x,r))) â‰¥mn (U (x) B (0, r (1 âˆ’Îµ))),
(17.39)
If x is a point of A, then
lim
râ†’0
Hn (h (B (x, r) âˆ©A))
Hn (h (B (x, r)))
= 1.
(17.40)
Proof: Since Dh (x) exists,
h (x + v) = h (x) + Dh (x) v+o (|v|).
(17.41)
Consequently, when r is small enough, 17.36 holds.
Using the fact R (x) preserves all distances, and Theorem 17.8 which says Hn =
mn on the Borel sets of Rn,this implies,
Hn (h (B (x,r))) â‰¤Hn (R (x) U (x) B (0, r (1 + Îµ)))
= Hn (U (x) B (0, r (1 + Îµ))) = mn (U (x) B (0, r (1 + Îµ)))
which shows 17.37.
From 17.41,
Râˆ—(x) h (x + v) = Râˆ—(x) h (x) + U (x) (v+o (|v|)).
Thus, from the assumption that U (x)âˆ’1 exists and letting F (v) be given by
F (v) â‰¡U (x)âˆ’1 Râˆ—(x) h (x + v) âˆ’U (x)âˆ’1 Râˆ—(x) h (x)
(17.42)
Since h is continuous near A, it follows
F (v) âˆ’v = o (|v|)
and so Lemma 17.29 implies that for all r small enough,
F (B (0, r))
â‰¡
U (x)âˆ’1 Râˆ—(x) h (x+B (0,r)) âˆ’U (x)âˆ’1 Râˆ—(x) h (x)
âŠ‡
B (0, (1 âˆ’Îµ) r).
Therefore,
Râˆ—(x) h (B (x,r)) âŠ‡Râˆ—(x) h (x) + U (x) B (0, (1 âˆ’Îµ) r)

476
HAUSDORFF MEASURE
which proves 17.38. Therefore,
R (x) Râˆ—(x) h (B (x, r)) âŠ‡
R (x) Râˆ—(x) h (x) + R (x) U (x) B (0, r (1 âˆ’Îµ)).
From Lemma 17.32, this implies
Hn (h (B (x,r)))
â‰¥
Hn (Râˆ—(x) h (B (x, r)))
=
Hn (R (x) Râˆ—(x) h (B (x, r)))
â‰¥Hn (R (x) U (x) B (0, r (1 âˆ’Îµ)))
= Hn (U (x) B (0, r (1 âˆ’Îµ))) = mn (U (x) B (0, r (1 âˆ’Îµ)))
which shows 17.39.
Let x âˆˆA. Choosing r small enough that B (x, r) âŠ†U,
h (B (x, r) âˆ©A) âˆªh (B (x, r) \ A) = h (B (x, r))
and so
Hn (h (B (x, r) âˆ©A)) + Hn (h (B (x, r) \ A))
â‰¥
Hn (h (B (x, r)))
Now by assumption 17.34, Hn (h (B (x, r) \ A)) = 0 and so for all r small enough,
Hn (h (B (x, r) âˆ©A)) = Hn (h (B (x, r))) .
This establishes 17.40.
The next theorem is the generalization of Lemma 17.14 to nonlinear maps.
Theorem 17.35 Let h : U â†’Rm where U is an open set in Rn, n â‰¤m, h is
continuous on U, h is diï¬€erentiable on A âŠ†U, and Hn (U \ A) = 0. Then for
x âˆˆA,
J (x) = lim
râ†’0
Hn (h (B (x, r)))
mn (B (x,r))
,
(17.43)
where J (x) â‰¡det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.
Proof:
Suppose ï¬rst that U (x)âˆ’1 exists. Using 17.39, 17.37 and the change
of variables formula for linear maps,
J (x) (1 âˆ’Îµ)n
=
mn (U (x) B (0,r (1 âˆ’Îµ)))
mn (B (x, r))
â‰¤Hn (h(B (x, r)))
mn (B (x, r))
â‰¤
mn (U (x) B (0,r (1 + Îµ)))
mn (B (x, r))
= J (x) (1 + Îµ)n

17.3.
THE AREA FORMULA ALTERNATE VERSION
477
whenever r is small enough. It follows that since Îµ > 0 is arbitrary, 17.43 holds.
Now suppose U (x)âˆ’1 does not exist. The ï¬rst part shows that the conclusion
of the theorem holds when J (x) Ì¸= 0. I will apply this to a modiï¬ed function. Let
k : Rn â†’Rm Ã— Rn
be deï¬ned as
k (x) â‰¡
Âµ
h (x)
Îµx
Â¶
.
Then
Dk (x)âˆ—Dk (x) = Dh (x)âˆ—Dh (x) + Îµ2In
and so
Jk (x)2
â‰¡
det
Â¡
Dh (x)âˆ—Dh (x) + Îµ2In
Â¢
=
det
Â¡
Qâˆ—DQ + Îµ2In
Â¢
where D is a diagonal matrix having the nonnegative eigenvalues of Dh (x)âˆ—Dh (x)
down the main diagonal. Thus, since one of these eigenvalues equals 0, letting Î»2
i
denote the ith eigenvalue, there exists a constant, C independent of Îµ such that
0 < Jk (x)2 =
n
Y
i=1
Â¡
Î»2
i + Îµ2Â¢
â‰¤C2Îµ2.
(17.44)
Therefore, what was just shown applies to k.
Let
T â‰¡
n
(h (w) , 0)T : w âˆˆB (x,r)
o
,
TÎµ
â‰¡
n
(h (w) , Îµw)T : w âˆˆB (x,r)
o
â‰¡
k (B (x,r)),
then
T = PTÎµ
where P is the projection map deï¬ned by
P
Âµ
x
y
Â¶
â‰¡
Âµ
x
0
Â¶
.
Since P decreases distances, it follows from Lemma 17.31
Hn (h (B (x,r)))
=
Hn (T) = Hn (PTÎµ)
â‰¤
Hn (TÎµ) = Hn (k (B (x,r))) .

478
HAUSDORFF MEASURE
It follows from 17.44 and the ï¬rst part of the proof applied to k that
CÎµ
â‰¥
Jk (x) = lim
râ†’0
Hn (k (B (x, r)))
mn (B (x,r))
â‰¥
lim sup
râ†’0
Hn (h (B (x, r)))
mn (B (x,r))
.
Since Îµ is arbitrary, this establishes 17.43 in the case where U (x)âˆ’1 does not exist
and completes the proof of the theorem.
17.3.2
The Area Formula
Assume h : A â†’Rm is one to one in addition to 17.32 - 17.34. Since h is one to
one on A, Lemma 17.28 implies one can deï¬ne a measure, Î½, on the Ïƒâˆ’algebra of
Lebesgue measurable sets as follows.
Î½ (E) â‰¡Hn (h (E âˆ©A)).
By Lemma 17.28, this is a measure and Î½ â‰ªm.
Therefore by the corollary
to the Radon Nikodym theorem, Corollary 15.3 on Page 402, there exists f âˆˆ
L1
loc (Rn) , f â‰¥0, f (x) = 0 if x /âˆˆA, and
Î½ (E) =
Z
E
fdmn =
Z
Aâˆ©E
fdmn.
What is f? I will show that f (x) = J (x) = det (U (x)) a.e. Let x be a Lebesgue
point of f. Then by Lemma 17.34 and Theorem 17.35
f (x)
=
lim
râ†’0
1
mn (B (x,r))
Z
B(x,r)
f (y) dm
=
lim
râ†’0
Hn (h (B (x,r) âˆ©A))
mn (B (x,r))
=
lim
râ†’0
Hn (h (B (x,r) âˆ©A))
Hn (h (B (x,r)))
Hn (h (B (x,r)))
mn (B (x,r))
=
J (x).
Therefore, f (x) = J (x) a.e., whenever x is a Lebesgue point of f.
Now let F be a Borel set in Rm. Recall this implies F is Hn measurable. Then
Z
h(A)
XF (y) dHn
=
Z
XF âˆ©h(A) (y) dHn
=
Hn Â¡
h
Â¡
hâˆ’1 (F) âˆ©A
Â¢Â¢
=
Î½
Â¡
hâˆ’1 (F)
Â¢
=
Z
XAâˆ©hâˆ’1(F ) (x) J (x) dmn
=
Z
A
XF (h (x)) J (x) dmn.
(17.45)

17.3.
THE AREA FORMULA ALTERNATE VERSION
479
Note there are no measurability questions in the above formula because hâˆ’1 (F) is
a Borel set due to the continuity of h. The Borel measurability of J (x) also follows
from the observation that h is continuous and therefore, the partial derivatives are
Borel measurable, being the limit of continuous functions.
Then J (x) is just a
continuous function of these partial derivatives. However, things are not so clear
if E is only assumed Hn measurable. Is there a similar formula for F only Hn
measurable?
First consider the case where E is only Hn measurable but
Hn (E âˆ©h (A)) = 0.
By Theorem 17.5 on Page 452, there exists a Borel set F âŠ‡E âˆ©h (A) such that
Hn (F) = Hn (E âˆ©h (A)) = 0.
Then from 17.45,
XAâˆ©hâˆ’1(F ) (x) J (x) = 0 a.e.
But
0 â‰¤XAâˆ©hâˆ’1(E) (x) J (x) â‰¤XAâˆ©hâˆ’1(F ) (x) J (x)
(17.46)
which shows the two functions in 17.46 are equal a.e. Therefore XAâˆ©hâˆ’1(E) (x) J (x)
is Lebesgue measurable and so from 17.45,
0 =
Z
XEâˆ©h(A) (y) dHn =
Z
XF âˆ©h(A) (y) dHn
=
Z
XAâˆ©hâˆ’1(F ) (x) J (x) dmn =
Z
XAâˆ©hâˆ’1(E) (x) J (x) dmn,
(17.47)
which shows 17.45 holds in this case where
Hn (E âˆ©h (A)) = 0.
Now let AR â‰¡A âˆ©B (0,R) where R is large enough that AR Ì¸= âˆ…and let E
be Hn measurable. By Theorem 17.5, there exists F âŠ‡E âˆ©h (AR) such that F is
Borel and
Hn (F \ (E âˆ©h (AR))) = 0.
(17.48)
Then
(E âˆ©h (AR)) âˆª(F \ (E âˆ©h (AR)) âˆ©h (AR)) = F âˆ©h (AR)
and so
XARâˆ©hâˆ’1(F )J = XARâˆ©hâˆ’1(E)J + XARâˆ©hâˆ’1(F \(Eâˆ©h(AR)))J
where from 17.48 and 17.47, the second function on the right of the equal sign is
Lebesgue measurable and equals zero a.e. Therefore, the ï¬rst function on the right
of the equal sign is also Lebesgue measurable and equals the function on the left
a.e. Thus,
Z
XEâˆ©h(AR) (y) dHn =
Z
XF âˆ©h(AR) (y) dHn

480
HAUSDORFF MEASURE
=
Z
XARâˆ©hâˆ’1(F ) (x) J (x) dmn =
Z
XARâˆ©hâˆ’1(E) (x) J (x) dmn.
(17.49)
Letting R â†’âˆžyields 17.49 with A replacing AR and the function
x â†’XARâˆ©hâˆ’1(E) (x) J (x)
is Lebesgue measurable. Writing this in a more familiar form yields
Z
h(A)
XE (y) dHn =
Z
A
XE (h (x)) J (x) dmn.
(17.50)
From this, it follows that if s is a nonnegative Hn measurable simple function, 17.50
continues to be valid with s in place of XE. Then approximating an arbitrary non-
negative Hn measurable function, g, by an increasing sequence of simple functions,
it follows that 17.50 holds with g in place of XE and there are no measurability
problems because x â†’g (h (x)) J (x) is Lebesgue measurable. This proves the area
formula.
Theorem 17.36 Let g : h (A) â†’[0, âˆž] be Hn measurable where h is a continuous
function and A is a Lebesgue measurable set which satisï¬es 17.32 - 17.34. That
is, U is an open set in Rn on which h is deï¬ned and continuous and A âŠ†U is a
Lebesgue measurable set, m â‰¥n, and
h : U â†’Rm is continuous, h one to one on A,
(17.51)
Dh (x) exists for all x âˆˆA,
(17.52)
Hn (U \ A) = 0,
(17.53)
Then
x â†’(g â—¦h) (x) J (x)
is Lebesgue measurable and
Z
h(A)
g (y) dHn =
Z
A
g (h (x)) J (x) dm
where J (x) = det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.
17.4
The Divergence Theorem
As an important application of the area formula I will give a general version of the
divergence theorem. It will always be assumed n â‰¥2. Actually it is not necessary to
make this assumption but what results in the case where n = 1 is nothing more than
the fundamental theorem of calculus and the considerations necessary to draw this
conclusion seem unneccessarily tedious. You have to consider H0, zero dimensional
Hausdorï¬€measure. It is left as an exercise but I will not present it.
It will be convenient to have some lemmas and theorems in hand before beginning
the proof. First recall the Tietze extension theorem on Page 146. It is stated next
for convenience.

17.4.
THE DIVERGENCE THEOREM
481
Theorem 17.37 Let M be a closed nonempty subset of a metric space (X, d) and
let f : M â†’[a, b] be continuous at every point of M. Then there exists a function,
g continuous on all of X which coincides with f on M such that g (X) âŠ†[a, b] .
The next topic needed is the concept of an inï¬nitely diï¬€erentiable partition of
unity.
Deï¬nition 17.38 Let C be a set whose elements are subsets of Rn.1 Then C is
said to be locally ï¬nite if for every x âˆˆRn, there exists an open set, Ux containing
x such that Ux has nonempty intersection with only ï¬nitely many sets of C.
Lemma 17.39 Let C be a set whose elements are open subsets of Rn and suppose
âˆªC âŠ‡H, a closed set. Then there exists a countable list of open sets, {Ui}âˆž
i=1 such
that each Ui is bounded, each Ui is a subset of some set of C, and âˆªâˆž
i=1Ui âŠ‡H.
Proof: Let Wk â‰¡B (0, k) , W0 = Wâˆ’1 = âˆ…. For each x âˆˆH âˆ©Wk there exists
an open set, Ux such that Ux is a subset of some set of C and Ux âŠ†Wk+1 \ Wkâˆ’1.
Then since H âˆ©Wk is compact, there exist ï¬nitely many of these sets,
Â©
U k
i
Âªm(k)
i=1
whose union contains H âˆ©Wk. If H âˆ©Wk = âˆ…, let m (k) = 0 and there are no such
sets obtained.The desired countable list of open sets is âˆªâˆž
k=1
Â©
U k
i
Âªm(k)
i=1 . Each open
set in this list is bounded. Furthermore, if x âˆˆRn, then x âˆˆWk where k is the
ï¬rst positive integer with x âˆˆWk. Then Wk \Wkâˆ’1 is an open set containing x and
this open set can have nonempty intersection only with with a set of
Â©
U k
i
Âªm(k)
i=1 âˆª
Â©
U kâˆ’1
i
Âªm(kâˆ’1)
i=1
, a ï¬nite list of sets. Therefore, âˆªâˆž
k=1
Â©
U k
i
Âªm(k)
i=1
is locally ï¬nite.
The set, {Ui}âˆž
i=1 is said to be a locally ï¬nite cover of H. The following lemma
gives some important reasons why a locally ï¬nite list of sets is so signiï¬cant. First
of all consider the rational numbers, {ri}âˆž
i=1 each rational number is a closed set.
Q = {ri}âˆž
i=1 = âˆªâˆž
i=1{ri} Ì¸= âˆªâˆž
i=1 {ri} = R
The set of rational numbers is deï¬nitely not locally ï¬nite.
Lemma 17.40 Let C be locally ï¬nite. Then
âˆªC = âˆª
Â©
H : H âˆˆC
Âª
.
Next suppose the elements of C are open sets and that for each U âˆˆC, there exists a
diï¬€erentiable function, ÏˆU having spt (ÏˆU) âŠ†U. Then you can deï¬ne the following
ï¬nite sum for each x âˆˆRn
f (x) â‰¡
X
{ÏˆU (x) : x âˆˆU âˆˆC} .
Furthermore, f is also a diï¬€erentiable function2 and
Df (x) =
X
{DÏˆU (x) : x âˆˆU âˆˆC} .
1The deï¬nition applies with no change to a general topological space in place of Rn.
2If each ÏˆU were only continuous, one could conclude f is continuous. Here the main interest
is diï¬€erentiable.

482
HAUSDORFF MEASURE
Proof: Let p be a limit point of âˆªC and let W be an open set which intersects
only ï¬nitely many sets of C. Then p must be a limit point of one of these sets. It
follows p âˆˆâˆª
Â©
H : H âˆˆC
Âª
and so âˆªC âŠ†âˆª
Â©
H : H âˆˆC
Âª
. The inclusion in the other
direction is obvious.
Now consider the second assertion. Letting x âˆˆRn, there exists an open set, W
intersecting only ï¬nitely many open sets of C, U1, U2, Â· Â· Â·, Um. Then for all y âˆˆW,
f (y) =
m
X
i=1
ÏˆUi (y)
and so the desired result is obvious. It merely says that a ï¬nite sum of diï¬€erentiable
functions is diï¬€erentiable. Recall the following deï¬nition.
Deï¬nition 17.41 Let K be a closed subset of an open set, U. K â‰ºf â‰ºU if f is
continuous, has values in [0, 1] , equals 1 on K, and has compact support contained
in U.
Lemma 17.42 Let U be a bounded open set and let K be a closed subset of U. Then
there exist an open set, W, such that W âŠ†W âŠ†U and a function, f âˆˆCâˆž
c (U)
such that K â‰ºf â‰ºU.
Proof: The set, K is compact so is at a positive distance from U C. Let
W â‰¡
Â©
x : dist (x, K) < 3âˆ’1 dist
Â¡
K, U CÂ¢Âª
.
Also let
W1 â‰¡
Â©
x : dist (x, K) < 2âˆ’1 dist
Â¡
K, U CÂ¢Âª
Then it is clear
K âŠ†W âŠ†W âŠ†W1 âŠ†W1 âŠ†U
Now consider the function,
h (x) â‰¡
dist
Â¡
x, W C
1
Â¢
dist
Â¡
x, W C
1
Â¢
+ dist
Â¡
x, W
Â¢
Since W is compact it is at a positive distance from W C
1 and so h is a well deï¬ned
continuous function which has compact support contained in W 1, equals 1 on W,
and has values in [0, 1] . Now let Ï†k be a molliï¬er. Letting
kâˆ’1 < min
Â¡
dist
Â¡
K, W CÂ¢
, 2âˆ’1 dist
Â¡
W 1, U CÂ¢Â¢
,
it follows that for such k,the function, h âˆ—Ï†k âˆˆCâˆž
c (U) , has values in [0, 1] , and
equals 1 on K. Let f = h âˆ—Ï†k.
The above lemma is used repeatedly in the following.

17.4.
THE DIVERGENCE THEOREM
483
Lemma 17.43 Let K be a closed set and let {Vi}âˆž
i=1 be a locally ï¬nite list of
bounded open sets whose union contains K.
Then there exist functions, Ïˆi âˆˆ
Câˆž
c (Vi) such that for all x âˆˆK,
1 =
âˆž
X
i=1
Ïˆi (x)
and the function f (x) given by
f (x) =
âˆž
X
i=1
Ïˆi (x)
is in Câˆž(Rn) .
Proof: Let K1 = K \ âˆªâˆž
i=2Vi. Thus K1 is compact because K1 âŠ†V1. Let
K1 âŠ†W1 âŠ†W 1 âŠ†V1
Thus W1, V2, Â·Â·Â·, Vn covers K and W 1 âŠ†V1. Suppose W1, Â·Â·Â·, Wr have been deï¬ned
such that Wi âŠ†Vi for each i, and W1, Â· Â· Â·, Wr, Vr+1, Â· Â· Â·, Vn covers K. Then let
Kr+1 â‰¡K \ (
Â¡
âˆªâˆž
i=r+2Vi
Â¢
âˆª
Â¡
âˆªr
j=1Wj
Â¢
).
It follows Kr+1 is compact because Kr+1 âŠ†Vr+1. Let Wr+1 satisfy
Kr+1 âŠ†Wr+1 âŠ†W r+1 âŠ†Vr+1
Continuing this way deï¬nes a sequence of open sets, {Wi}âˆž
i=1 with the property
Wi âŠ†Vi, K âŠ†âˆªâˆž
i=1Wi.
Note {Wi}âˆž
i=1 is locally ï¬nite because the original list, {Vi}âˆž
i=1 was locally ï¬nite.
Now let Ui be open sets which satisfy
W i âŠ†Ui âŠ†U i âŠ†Vi.
Similarly, {Ui}âˆž
i=1 is locally ï¬nite.
Wi
Ui
Vi
Since the set, {Wi}âˆž
i=1 is locally ï¬nite, it follows âˆªâˆž
i=1Wi = âˆªâˆž
i=1Wi and so it
is possible to deï¬ne Ï†i and Î³, inï¬nitely diï¬€erentiable functions having compact
support such that
U i â‰ºÏ†i â‰ºVi, âˆªâˆž
i=1W i â‰ºÎ³ â‰ºâˆªâˆž
i=1Ui.

484
HAUSDORFF MEASURE
Now deï¬ne
Ïˆi(x) =
Â½ Î³(x)Ï†i(x)/ Pâˆž
j=1 Ï†j(x) if Pâˆž
j=1 Ï†j(x) Ì¸= 0,
0 if Pâˆž
j=1 Ï†j(x) = 0.
If x is such that Pâˆž
j=1 Ï†j(x) = 0, then x /âˆˆâˆªâˆž
i=1Ui because Ï†i equals one on Ui.
Consequently Î³ (y) = 0 for all y near x thanks to the fact that âˆªâˆž
i=1Ui is closed
and so Ïˆi(y) = 0 for all y near x. Hence Ïˆi is inï¬nitely diï¬€erentiable at such x. If
Pâˆž
j=1 Ï†j(x) Ì¸= 0, this situation persists near x because each Ï†j is continuous and so
Ïˆi is inï¬nitely diï¬€erentiable at such points also thanks to Lemma 17.40. Therefore
Ïˆi is inï¬nitely diï¬€erentiable. If x âˆˆK, then Î³ (x) = 1 and so Pâˆž
j=1 Ïˆj(x) = 1.
Clearly 0 â‰¤Ïˆi (x) â‰¤1 and spt(Ïˆj) âŠ†Vj. This proves the theorem.
The functions, {Ïˆi} are called a Câˆžpartition of unity.
The method of proof of this lemma easily implies the following useful corollary.
Corollary 17.44 If H is a compact subset of Vi for some Vi there exists a partition
of unity such that Ïˆi (x) = 1 for all x âˆˆH in addition to the conclusion of Lemma
39.6.
Proof: Keep Vi the same but replace Vj with f
Vj â‰¡Vj \ H. Now in the proof
above, applied to this modiï¬ed collection of open sets, if j Ì¸= i, Ï†j (x) = 0 whenever
x âˆˆH. Therefore, Ïˆi (x) = 1 on H.
Lemma 17.45 Let â„¦be a metric space with the closed balls compact and suppose
Âµ is a measure deï¬ned on the Borel sets of â„¦which is ï¬nite on compact sets.
Then there exists a unique Radon measure, Âµ which equals Âµ on the Borel sets. In
particular Âµ must be both inner and outer regular on all Borel sets.
Proof: Deï¬ne a positive linear functional, Î› (f) =
R
fdÂµ. Let Âµ be the Radon
measure which comes from the Riesz representation theorem for positive linear
functionals. Thus for all f continuous,
Z
fdÂµ =
Z
fdÂµ.
If V is an open set, let {fn} be a sequence of continuous functions which is increasing
and converges to XV pointwise. Then applying the monotone convergence theorem,
Z
XV dÂµ = Âµ (V ) =
Z
XV dÂµ = Âµ (V )
and so the two measures coincide on all open sets. Every compact set is a countable
intersection of open sets and so the two measures coincide on all compact sets. Now
let B (a, n) be a ball of radius n and let E be a Borel set contained in this ball.
Then by regularity of Âµ there exist sets F, G such that G is a countable intersection
of open sets and F is a countable union of compact sets such that F âŠ†E âŠ†G and
Âµ (G \ F) = 0. Now Âµ (G) = Âµ (G) and Âµ (F) = Âµ (F) . Thus
Âµ (G \ F) + Âµ (F)
=
Âµ (G)
=
Âµ (G) = Âµ (G \ F) + Âµ (F)

17.4.
THE DIVERGENCE THEOREM
485
and so Âµ (G \ F) = Âµ (G \ F) . Thus
Âµ (E) = Âµ (F) = Âµ (F) = Âµ (G) = Âµ (E) .
If E is an arbitrary Borel set, then
Âµ (E âˆ©B (a, n)) = Âµ (E âˆ©B (a, n))
and letting n â†’âˆž, this yields Âµ (E) = Âµ (E) .
One more lemma will be useful.
Lemma 17.46 Let V be a bounded open set and let X be the closed subspace of
C
Â¡
V
Â¢
, the space of continuous functions deï¬ned on V , which is given by the fol-
lowing.
X = {u âˆˆC
Â¡
V
Â¢
: u (x) = 0 on âˆ‚V }.
Then Câˆž
c (V ) is dense in X with respect to the norm given by
||u|| = max
Â©
|u (x)| : x âˆˆV
Âª
Proof: Let O âŠ†O âŠ†W âŠ†W âŠ†V be such that dist
Â¡
O, V CÂ¢
< Î· and let
ÏˆÎ´ (Â·) be a molliï¬er. Let u âˆˆX and consider XW u âˆ—ÏˆÎ´. Let Îµ > 0 be given and
let Î· be small enough that |u (x) | < Îµ/2 whenever x âˆˆV \ O. Then if Î´ is small
enough |XW u âˆ—ÏˆÎ´ (x) âˆ’u (x) | < Îµ for all x âˆˆO and XW u âˆ—ÏˆÎ´ is in Câˆž
c (V ). For
x âˆˆV \ O, |XW u âˆ—ÏˆÎ´ (x) | â‰¤Îµ/2 and so for such x,
|XW u âˆ—ÏˆÎ´ (x) âˆ’u (x) | â‰¤Îµ.
This proves the lemma since Îµ was arbitrary.
Deï¬nition 17.47 A bounded open set, U âŠ†Rn is said to have a Lipschitz boundary
and to lie on one side of its boundary if the following conditions hold. There exist
open boxes, Q1, Â· Â· Â·, QN ,
Qi =
n
Y
j=1
Â¡
ai
j, bi
j
Â¢
such that âˆ‚U â‰¡U \ U is contained in their union. Also, for each Qi, there exists k
and a Lipschitz function, gi such that U âˆ©Qi is of the form
ï£±
ï£²
ï£³x : (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn) âˆˆ
kâˆ’1
Y
j=1
Â¡
ai
j, bi
j
Â¢
Ã—
n
Y
j=k+1
Â¡
ai
j, bi
j
Â¢
and ai
k < xk < gi (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn)
ï£¼
ï£½
ï£¾(17.54)

486
HAUSDORFF MEASURE
or else of the form
ï£±
ï£²
ï£³x : (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn) âˆˆ
kâˆ’1
Y
j=1
Â¡
ai
j, bi
j
Â¢
Ã—
n
Y
j=k+1
Â¡
ai
j, bi
j
Â¢
and gi (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn) < xk < bi
j
ï£¼
ï£½
ï£¾. (17.55)
The function, gi has a derivative on Ai âŠ†Qkâˆ’1
j=1
Â¡
ai
j, bi
j
Â¢
Ã— Qn
j=k+1
Â¡
ai
j, bi
j
Â¢
where
mnâˆ’1
ï£«
ï£­
kâˆ’1
Y
j=1
Â¡
ai
j, bi
j
Â¢
Ã—
n
Y
j=k+1
Â¡
ai
j, bi
j
Â¢
\ Ai
ï£¶
ï£¸= 0.
Also, there exists an open set, Q0 such that Q0 âŠ†Q0 âŠ†U and U âŠ†Q0âˆªQ1âˆªÂ·Â·Â·âˆªQN.
Note that since there are only ï¬nitely many Qi and each gi is Lipschitz, it follows
from an application of Lemma 17.21 that Hnâˆ’1 (âˆ‚U) < âˆž. Also from Lemma 17.45
Hnâˆ’1 is inner and outer regular on âˆ‚U.
Lemma 17.48 Suppose U is a bounded open set as described above. Then there
exists a unique function in LâˆžÂ¡
âˆ‚U, Hnâˆ’1Â¢n , n (y) for y âˆˆâˆ‚U such that |n (y)| =
1, n is Hnâˆ’1 measurable, (meaning each component of n is Hnâˆ’1 measurable) and
for every w âˆˆRn satisfying |w| = 1, and for every f âˆˆC1
c (Rn) ,
lim
tâ†’0
Z
U
f (x + tw) âˆ’f (x)
t
dx =
Z
âˆ‚U
f (n Â· w) dHnâˆ’1
Proof: Let U âŠ†V âŠ†V âŠ†âˆªN
i=0Qi and let {Ïˆi}N
i=0 be a Câˆžpartition of unity
on V such that spt (Ïˆi) âŠ†Qi. Then for all t small enough and x âˆˆU,
f (x + tw) âˆ’f (x)
t
= 1
t
N
X
i=0
Ïˆif (x + tw) âˆ’Ïˆif (x) .
Thus using the dominated convergence theorem,
lim
tâ†’0
Z
U
f (x + tw) âˆ’f (x)
t
dx
=
lim
tâ†’0
Z
U
Ãƒ
1
t
N
X
i=0
Ïˆif (x + tw) âˆ’Ïˆif (x)
!
dx
=
Z
U
N
X
i=0
n
X
j=1
Dj (Ïˆif (x)) wjdx

17.4.
THE DIVERGENCE THEOREM
487
=
Z
U
n
X
j=1
Dj (Ïˆ0f (x)) wjdx +
N
X
i=1
Z
U
n
X
j=1
Dj (Ïˆif (x)) wjdx
(17.56)
Since spt (Ïˆ0) âŠ†Q0, it follows the ï¬rst term in the above equals zero. In the second
term, ï¬x i. Without loss of generality, suppose the k in the above deï¬nition equals
n and 17.54 holds. This just makes things a little easier to write. Thus gi is a
function of
(x1, Â· Â· Â·, xnâˆ’1) âˆˆ
nâˆ’1
Y
j=1
Â¡
ai
j, bi
j
Â¢
â‰¡Bi
Then
Z
U
n
X
j=1
Dj (Ïˆif (x)) wjdx
=
Z
Bi
Z gi(x1,Â·Â·Â·,xnâˆ’1)
ain
n
X
j=1
Dj (Ïˆif (x)) wjdxndx1 Â· Â· Â· dxnâˆ’1
=
Z
Bi
Z gi(x1,Â·Â·Â·,xnâˆ’1)
âˆ’âˆž
n
X
j=1
Dj (Ïˆif (x)) wjdxndx1 Â· Â· Â· dxnâˆ’1
Letting xn = y + gi (x1, Â· Â· Â·, xnâˆ’1) and changing the variable, this equals
=
Z
Bi
Z 0
âˆ’âˆž
n
X
j=1
Dj (Ïˆif (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1))) Â·
wjdydx1 Â· Â· Â· dxnâˆ’1
=
Z
Ai
Z 0
âˆ’âˆž
n
X
j=1
Dj (Ïˆif (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1))) Â·
wjdydx1 Â· Â· Â· dxnâˆ’1
=
Z
Ai
Z 0
âˆ’âˆž
nâˆ’1
X
j=1
âˆ‚
âˆ‚xj
(Ïˆif (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1))) wj âˆ’
Dn (Ïˆif) (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1)) Â·
gi,j (x1, Â· Â· Â·, xnâˆ’1) wjdydx1 Â· Â· Â· dxnâˆ’1
+
Z
Ai
Z 0
âˆ’âˆž
Dn (Ïˆif (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1))) Â·
(17.57)
wndydx1 Â· Â· Â· dxnâˆ’1
Consider the term
Z
Ai
Z 0
âˆ’âˆž
nâˆ’1
X
j=1
âˆ‚
âˆ‚xj
(Ïˆif (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1))) Â·
wjdydx1 Â· Â· Â· dxnâˆ’1.

488
HAUSDORFF MEASURE
This equals
Z
Bi
Z 0
âˆ’âˆž
nâˆ’1
X
j=1
âˆ‚
âˆ‚xj
(Ïˆif (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1))) Â·
wjdydx1 Â· Â· Â· dxnâˆ’1,
and now interchanging the order of integration and using the fact that spt (Ïˆi) âŠ†Qi,
it follows this term equals zero. (The reason this is valid is that
xj â†’Ïˆif (x1, Â· Â· Â·, xnâˆ’1, y + gi (x1, Â· Â· Â·, xnâˆ’1))
is the composition of Lipschitz functions and is therefore Lipschitz. Therefore, this
function is absolutely continuous and can be recovered by integrating its derivative.)
Then, changing the variable back to xn it follows 17.57 reduces to
=
Z
Ai
Z gi(x1,Â·Â·Â·,xnâˆ’1)
âˆ’âˆž
âˆ’Dn (Ïˆif) (x1, Â· Â· Â·, xnâˆ’1, xn) Â·
gi,j (x1, Â· Â· Â·, xnâˆ’1) wjdxndx1 Â· Â· Â· dxnâˆ’1
(17.58)
+
Z
Ai
Z gi(x1,Â·Â·Â·,xnâˆ’1)
âˆ’âˆž
Dn (Ïˆif (x1, Â· Â· Â·, xnâˆ’1, xn)) wndxndx1 Â· Â· Â· dxnâˆ’1
(17.59)
Doing the integrals, this reduces further to
Z
Ai
(Ïˆif) (x1, Â· Â· Â·, xnâˆ’1, xn) Ni (x1, Â· Â· Â·, xnâˆ’1, gi (x1, Â· Â· Â·, xnâˆ’1)) Â· wdmnâˆ’1 (17.60)
where Ni (x1, Â· Â· Â·, xnâˆ’1, gi (x1, Â· Â· Â·, xnâˆ’1)) is given by
(âˆ’gi,1 (x1, Â· Â· Â·, xnâˆ’1) , âˆ’gi,2 (x1, Â· Â· Â·, xnâˆ’1) , Â· Â· Â·, âˆ’gi,nâˆ’1 (x1, Â· Â· Â·, xnâˆ’1) , 1) . (17.61)
At this point I need a technical lemma which will allow the use of the area formula.
The part of the boundary of U which is contained in Qi is the image of the map,
hi (x1, Â· Â· Â·, xnâˆ’1) given by (x1, Â· Â· Â·, xnâˆ’1, gi (x1, Â· Â· Â·, xnâˆ’1)) for (x1, Â· Â· Â·, xnâˆ’1) âˆˆAi.
I need a formula for
det
Â¡
Dhi (x1, Â· Â· Â·, xnâˆ’1)âˆ—Dhi (x1, Â· Â· Â·, xnâˆ’1)
Â¢1/2 .
To avoid interupting the argument, I will state the lemma here and prove it later.
Lemma 17.49
det
Â¡
Dhi (x1, Â· Â· Â·, xnâˆ’1)âˆ—Dhi (x1, Â· Â· Â·, xnâˆ’1)
Â¢1/2
=
v
u
u
t1 +
nâˆ’1
X
jâˆ’1
gi,j (x1, Â· Â· Â·, xnâˆ’1)2 â‰¡Ji (x1, Â· Â· Â·, xnâˆ’1) .

17.4.
THE DIVERGENCE THEOREM
489
For
y = (x1, Â· Â· Â·, xnâˆ’1, gi (x1, Â· Â· Â·, xnâˆ’1)) âˆˆâˆ‚U âˆ©Qi
deï¬ne It follows if n is deï¬ned by
ni (y) =
1
Ji (x1, Â· Â· Â·, xnâˆ’1)Ni (y)
it follows from the description of Ji (x1, Â· Â· Â·, xnâˆ’1) given in the above lemma, that
ni is a unit vector. All components of ni are continuous functions of limits of con-
tinuous functions. Therefore, ni is Borel measurable and so it is Hnâˆ’1 measurable.
Now 17.60 reduces to
Z
Ai
(Ïˆif) (x1, Â· Â· Â·, xnâˆ’1, gi (x1, Â· Â· Â·, xnâˆ’1)) Ã—
ni (x1, Â· Â· Â·, xnâˆ’1, gi (x1, Â· Â· Â·, xnâˆ’1)) Â· wJi (x1, Â· Â· Â·, xnâˆ’1) dmnâˆ’1.
By the area formula this equals
Z
h(Ai)
Ïˆif (y) ni (y) Â· wdHnâˆ’1.
Now by Lemma 17.21 and the equality of mnâˆ’1 and Hnâˆ’1 on Rnâˆ’1, the above
integral equals
Z
âˆ‚Uâˆ©Qi
Ïˆif (y) ni (y) Â· wdHnâˆ’1 =
Z
âˆ‚U
Ïˆif (y) ni (y) Â· wdHnâˆ’1.
Returning to 17.56 similar arguments apply to the other terms and therefore,
lim
tâ†’0
Z
U
f (x + tw) âˆ’f (x)
t
dmn
=
N
X
i=1
Z
âˆ‚U
Ïˆif (y) ni (y) Â· wdHnâˆ’1
=
Z
âˆ‚U
f (y)
N
X
i=1
Ïˆi (y) ni (y) Â· wdHnâˆ’1
=
Z
âˆ‚U
f (y) n (y) Â· wdHnâˆ’1
(17.62)
Then let n (y) â‰¡PN
i=1 Ïˆi (y) ni (y) .
I need to show ï¬rst there is no other n which satisï¬es 17.62 and then I need
to show that |n (y)| = 1. Note that it is clear |n (y)| â‰¤1 because each ni is a
unit vector and this is just a convex combination of these.
Suppose then that
n1 âˆˆLâˆžÂ¡
âˆ‚U, Hnâˆ’1Â¢
also works in 17.62. Then for all f âˆˆC1
c (Rn) ,
Z
âˆ‚U
f (y) n (y) Â· wdHnâˆ’1 =
Z
âˆ‚U
f (y) n1 (y) Â· wdHnâˆ’1.

490
HAUSDORFF MEASURE
Suppose h âˆˆC (âˆ‚U) . Then by the Tietze extension theorem, there exists f âˆˆ
Cc (Rn) such that the restriction of f to âˆ‚U equals h. Now by Lemma 17.46 applied
to a bounded open set containing the support of f, there exists a sequence {fm} of
functions in C1
c (Rn) converging uniformly to f. Therefore,
Z
âˆ‚U
h (y) n (y) Â· wdHnâˆ’1
=
lim
mâ†’âˆž
Z
âˆ‚U
fm (y) n (y) Â· wdHnâˆ’1
=
lim
mâ†’âˆž
Z
âˆ‚U
fm (y) ni (y) Â· wdHnâˆ’1
=
Z
âˆ‚U
h (y) ni (y) Â· wdHnâˆ’1.
Now Hnâˆ’1 is a Radon measure on âˆ‚U and so the continuous functions on âˆ‚U
are dense in L1 Â¡
âˆ‚U, Hnâˆ’1Â¢
. It follows n Â· w = ni Â· w a.e.
Now let {wm}âˆž
m=1
be a countable dense subset of the unit sphere.
From what was just shown,
n Â· wm= ni Â· wm except for a set of measure zero, Nm. Letting N = âˆªmNm, it
follows that for y /âˆˆN, n (y) Â·wm= ni (y) Â· wm for all m. Since the set is dense, it
follows n (y) Â·w = ni (y) Â· w for all y /âˆˆN and for all w a unit vector. Therefore,
n (y) = ni (y) for all y /âˆˆN and this shows n is unique. In particular, although it
appears to depend on the partition of unity {Ïˆi} from its deï¬nition, this is not the
case.
It only remains to verify |n (y)| = 1 a.e. I will do this by showing how to compute
n. In particular, I will show that n = ni a.e. on âˆ‚U âˆ©Qi. Let W âŠ†W âŠ†Qi âˆ©âˆ‚U
where W is open in âˆ‚U. Let O be an open set such that O âˆ©âˆ‚U = W and O âŠ†Qi.
Using Corollary 17.44 there exists a Câˆžpartition of unity {Ïˆm} such that Ïˆi = 1
on O. Therefore, if m Ì¸= i, Ïˆm = 0 on O. Then if f âˆˆC1
c (O) ,
Z
W
fw Â· ndHnâˆ’1
=
Z
âˆ‚U
fw Â· ndHnâˆ’1 =
Z
U
âˆ‡f Â· wdmn
=
Z
U
âˆ‡(Ïˆif) Â· wdmn
which by the ï¬rst part of the argument given above equals
Z
W
Ïˆifni Â· wdHnâˆ’1 =
Z
W
fw Â· nidHnâˆ’1.
Thus for all f âˆˆC1
c (O) ,
Z
W
fw Â· ndHnâˆ’1 =
Z
W
fw Â· nidHnâˆ’1
(17.63)

17.4.
THE DIVERGENCE THEOREM
491
Since C1
c (O) is dense in Cc (O) , the above equation is also true for all f âˆˆCc (O).
Now letting h âˆˆCc (W) , the Tietze extension theorem implies there exists f1 âˆˆ
C
Â¡
O
Â¢
whose restriction to W equals h. Let f be deï¬ned by
f1 (x)
dist
Â¡
x, OCÂ¢
dist (x, spt (h)) + dist (x, OC) = f (x) .
Then f = h on W and so this has shown that for all h âˆˆCc (W) , 17.63 holds
for h in place of f. But as observed earlier, Hnâˆ’1 is outer and inner regular on
âˆ‚U and so Cc (W) is dense in L1 Â¡
W, Hnâˆ’1Â¢
which implies w Â· n (y) = w Â· ni (y)
for a.e. y. Considering a countable dense subset of the unit sphere as above, this
implies n (y) = ni (y) a.e. y. This proves |n (y)| = 1 a.e. and in fact n (y) can be
computed by using the formula for ni (y). This proves the lemma.
It remains to prove Lemma 17.49.
Proof of Lemma 17.49: Let h (x) = (x1, Â· Â· Â·, xnâˆ’1, g (x1, Â· Â· Â·, xnâˆ’1))T
Dh (x) =
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1
0
...
...
...
0
1
g,x1
Â· Â· Â·
g,xnâˆ’1
ï£¶
ï£·
ï£·
ï£·
ï£¸
Therefore,
J (x) =
Â¡
det
Â¡
Dh (x)âˆ—Dh (x)
Â¢Â¢1/2.
Therefore, J (x) is the square root of the determinant of the following nÃ—n matrix.
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1 + (g,x1)2
g,x1g,x2
Â· Â· Â·
g,x1g,xnâˆ’1
g,x2g,x1
1 + (g,x2)2
Â· Â· Â·
g,x2g,xnâˆ’1
...
...
...
g,xnâˆ’1g,x1
g,xnâˆ’1g,x2
Â· Â· Â·
1 + (g,xnâˆ’1)2
ï£¶
ï£·
ï£·
ï£·
ï£¸.
(17.64)
I need to show the determinant of the above matrix equals
1 +
nâˆ’1
X
i=1
(g,xi (x))2 .
This is implied by the following claim. To simplify the notation I will replace n âˆ’1
with n.
Claim: Let a1, Â· Â· Â·, an be real numbers and let A (a1, Â· Â· Â·, an) be the matrix
which has 1 + a2
i in the iith slot and aiaj in the ijth slot when i Ì¸= j. Then
det A = 1 +
n
X
i=1
a2
i.

492
HAUSDORFF MEASURE
Proof of the claim: The matrix, A (a1, Â· Â· Â·, an) is of the form
A (a1, Â· Â· Â·, an) =
ï£«
ï£¬
ï£¬
ï£¬
ï£­
1 + a2
1
a1a2
Â· Â· Â·
a1an
a1a2
1 + a2
2
a2an
...
...
...
a1an
a2an
Â· Â· Â·
1 + a2
n
ï£¶
ï£·
ï£·
ï£·
ï£¸
Now consider the product of a matrix and its transpose, BT B below.
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
1
0
Â· Â· Â·
0
a1
0
1
0
a2
...
...
...
0
1
an
âˆ’a1
âˆ’a2
Â· Â· Â·
âˆ’an
1
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
1
0
Â· Â· Â·
0
âˆ’a1
0
1
0
âˆ’a2
...
...
...
0
1
âˆ’an
a1
a2
Â· Â· Â·
an
1
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
(17.65)
This product equals a matrix of the form
Âµ A (a1, Â· Â· Â·, an)
0
0
1 + Pn
i=1 a2
i
Â¶
Therefore,
Â¡
1 + Pn
i=1 a2
i
Â¢
det (A (a1, Â· Â· Â·, an)) = det (B)2 = det
Â¡
BT Â¢2 . However,
using row operations,
det BT
=
det
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
1
0
Â· Â· Â·
0
a1
0
1
0
a2
...
...
...
0
1
an
0
0
Â· Â· Â·
0
1 + Pn
i=1 a2
i
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
=
1 +
n
X
i=1
a2
i
and therefore,
Ãƒ
1 +
n
X
i=1
a2
i
!
det (A (a1, Â· Â· Â·, an)) =
Ãƒ
1 +
n
X
i=1
a2
i
!2
which shows det (A (a1, Â· Â· Â·, an)) =
Â¡
1 + Pn
i=1 a2
i
Â¢
. This proves the claim.
Now the above lemma implies the divergence theorem.
Theorem 17.50 Let U be a bounded open set with a Lipschitz boundary which lies
on one side of its boundary. Then if f âˆˆC1
c (Rn) ,
Z
U
f,k (x) dmn =
Z
âˆ‚U
fnkdHnâˆ’1
(17.66)

17.4.
THE DIVERGENCE THEOREM
493
where n = (n1, Â· Â· Â·, nn) is the Hnâˆ’1 measurable unit vector of Lemma 17.48. Also,
if F is a vector ï¬eld such that each component is in C1
c (Rn) , then
Z
U
âˆ‡Â· F (x) dmn =
Z
âˆ‚U
F Â· ndHnâˆ’1.
(17.67)
Proof: To obtain 17.66 apply Lemma 17.48 to w = ek. Then to obtain 17.67
from this,
Z
U
âˆ‡Â· F (x) dmn
=
n
X
j=1
Z
U
Fj,jdmn =
n
X
j=1
Z
âˆ‚U
FjnjdHnâˆ’1
=
Z
âˆ‚U
n
X
j=1
FjnjdHnâˆ’1 =
Z
âˆ‚U
F Â· ndHnâˆ’1.
This proves the theorem.
What is the geometric signiï¬cance of the vector, n? Recall that in the part of
the boundary contained in Qi, this vector points in the same direction as the vector
Ni (x1, Â· Â· Â·, xnâˆ’1, gi (x1, Â· Â· Â·, xnâˆ’1))
given by
(âˆ’gi,1 (x1, Â· Â· Â·, xnâˆ’1) , âˆ’gi,2 (x1, Â· Â· Â·, xnâˆ’1) , Â· Â· Â·, âˆ’gi,nâˆ’1 (x1, Â· Â· Â·, xnâˆ’1) , 1) (17.68)
in the case where k = n. This vector is the gradient of the function,
xn âˆ’gi (x1, Â· Â· Â·, xnâˆ’1)
and so is perpendicular to the level surface given by
xn âˆ’gi (x1, Â· Â· Â·, xnâˆ’1) = 0
in the case where gi is C1. It also points away from U so the vector n is the unit
outer normal. The other cases work similarly.
The divergence theorem is valid in situations more general than for Lipschitz
boundaries. What you need is essentially the ability to say that the functions, gi
above can be diï¬€erentiated a.e. and more importantly that these functions can be
recovered by integrating their partial derivatives. In other words, you need absolute
continuity in each variable. Later in the chapter on weak derivatives, examples of
such functions which are more general than Lipschitz functions will be discussed.
However, the Lipschitz functions are pretty general and will suï¬ƒce for now.

494
HAUSDORFF MEASURE

Diï¬€erentiation With Respect
To General Radon Measures
This is a brief chapter on certain important topics on the diï¬€erentiation theory
for general Radon measures. For diï¬€erent proofs and some results which are not
discussed here, a good source is [20] which is where I ï¬rst read some of these things.
18.1
Besicovitch Covering Theorem
The fundamental theorem of calculus presented above for Lebesgue measures can
be generalized to arbitrary Radon measures. It turns out that the same approach
works if a diï¬€erent covering theorem is employed instead of the Vitali theorem. This
covering theorem is the Besicovitch covering theorem of this section. It is necessary
because for a general Radon measure Âµ, it is no longer the case that the measure
is translation invariant. This implies there is no way to estimate Âµ
Â³
bB
Â´
in terms of
Âµ (B) and thus the Vitali covering theorem is of no use. In the Besicovitch covering
theorem the balls in the covering are not enlarged as they are in the Vitali theorem.
In this theorem they can also be either open or closed or neither open nor closed.
The balls can also be taken with respect to any norm on Rn. The notation, B (x,r)
in the above argument will denote any set which satisï¬es
{y : ||y âˆ’x|| < r} âŠ†B (x, r) âŠ†{y : ||y âˆ’x|| < r}
and the norm, ||Â·|| is just some norm on Rn. The following picture is a distorted
picture of the situation described in the following lemma.
495

496
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
r
0
r y
r x
Lemma 18.1 Let 10 â‰¤rx â‰¤ry and suppose B (x, rx) and B (y, ry) both have
nonempty intersection with B (0, 1) but neither of these balls contains 0. Suppose
also that
||x âˆ’y|| â‰¥ry
so that neither ball contains both centers in its interior. Then
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
x
||x|| âˆ’
y
||y||
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¥4
5.
Proof: By hypothesis,
||x|| â‰¥rx â‰¥||x|| âˆ’1, ||y|| â‰¥ry â‰¥||y|| âˆ’1.
Then
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
x
||x|| âˆ’
y
||y||
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
x ||y|| âˆ’||x|| y
||x|| ||y||
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
x ||y|| âˆ’y ||y|| + y ||y|| âˆ’||x|| y
||x|| ||y||
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¥||x âˆ’y||
||x||
âˆ’|||y|| âˆ’||x|||
||x||
(18.1)
Now there are two cases.
First suppose ||y|| â‰¥||x|| . Then the above is larger than
â‰¥
ry
||x|| âˆ’||y||
||x|| + 1 â‰¥ry
||x|| âˆ’(ry + 1)
||x||
+ 1
=
1 âˆ’
1
||x|| â‰¥1 âˆ’1
rx
â‰¥1 âˆ’1
10 = 9
10.

18.1.
BESICOVITCH COVERING THEOREM
497
Next suppose ||x|| â‰¥||y|| . Then 18.1 is at least as large as
ry
||x|| âˆ’||x|| âˆ’||y||
||x||
=
ry
||x|| âˆ’1 + ||y||
||x||
â‰¥
2ry
||x|| âˆ’1 â‰¥
2ry
rx + 1 âˆ’1
â‰¥
2rx
rx + 1 âˆ’1 â‰¥
20
10 + 1 âˆ’1
=
. 818 18
This proves the lemma.
Lemma 18.2 There exists Ln depending on dimension, n, such that for {xk}m
k=1
distinct points on âˆ‚B (0, 1) , if m â‰¥Ln, then the distance between some pair of
points of {xk}m
k=1 is less than 4/5.
Proof:
Let {zj}Lnâˆ’1
j=1
be a 1/3 net on âˆ‚B (0, 1) . Then for m â‰¥Ln, if {xk}m
k=1
is a set of m distinct points on âˆ‚B (0, 1) , there must exist xi and xj for i Ì¸= j such
that both xi and xj are contained in some B (zk, 1/3) . This follows from the pigeon
hole principle. There are more xi than there are B (zk, 1/3) and so one of these
must have more than one xk in it. But then
||xi âˆ’xj|| â‰¤||xi âˆ’zk|| + ||zk âˆ’xj|| â‰¤2
3 < 4
5
This proves the lemma.
Corollary 18.3 Let B0 = B (0,1) and let Bj = B (xj, rj) for j = 1, Â· Â· Â·, K such
that rj â‰¥10, 0 /âˆˆBj for all j > 0, Bj âˆ©B0 Ì¸= âˆ…, and for all i Ì¸= j,
||xi âˆ’xj|| â‰¥max (ri, rj) .
That is, no Bj contains two centers in its interior. Then K â‰¤Ln, the constant of
the above lemma.
Proof: By Lemma 18.2, if K > Ln, there exist two of the centers, xi and xj
such that
Â¯Â¯Â¯
Â¯Â¯Â¯
xi
||xi|| âˆ’
xj
||xj||
Â¯Â¯Â¯
Â¯Â¯Â¯ < 4/5. By Lemma 18.1, ||xi âˆ’xj|| < max (ri, rj) contrary
to the assumptions of the corollary. Hence K â‰¤Ln as claimed.
Theorem 18.4 There exists a constant Nn, depending only on n with the following
property. If F is any collection of nonempty balls in Rn with
sup {diam (B) : B âˆˆF} < D < âˆž
and if A is the set of centers of the balls in F, then there exist subsets of F, G1, Â· Â· Â·,
GNn, such that each Gi is a countable collection of disjoint balls from F and
A âŠ†âˆªNn
i=1 {B : B âˆˆGi}.

498
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
Lemma 18.5 In the situation of Theorem 18.4, suppose the set of centers A is
bounded. Then there exists a sequence of balls from F, {Bj}J
j=1 where J â‰¤âˆžsuch
that
r (B1) â‰¥3
4 sup {r (B) : B âˆˆF}
(18.2)
and if
Am â‰¡A \ (âˆªm
i=1Bi) Ì¸= âˆ…,
(18.3)
then
r (Bm+1) â‰¥3
4 sup {r : B (a, r) âˆˆF, a âˆˆAm} .
(18.4)
Letting Bj = B (aj, rj) , this sequence satisï¬es
A âŠ†âˆªJ
i=1Bi, r (Bk) â‰¤4
3r (Bj) for j < k, {B (aj, rj/3)}J
j=1 are disjoint.
(18.5)
Proof: Pick B1 satisfying 18.2. If B1, Â· Â· Â·, Bm have been chosen, and Am is
given in 18.3, then if it equals âˆ…, it follows A âŠ†âˆªm
i=1Bi. Set J = m. If Am Ì¸= âˆ…,
pick Bm+1 to satisfy 18.4. This deï¬nes the desired sequence. It remains to verify
the claims in 18.5. Consider the second claim. Letting A0 â‰¡A, Ak âŠ†Ajâˆ’1 and so
sup {r : B (a, r) âˆˆF, a âˆˆAjâˆ’1} â‰¥rk.
Hence rj â‰¥(3/4) rk. This proves the second claim of 18.5.
Consider the third claim of 18.5. Suppose to the contrary that x âˆˆB (aj, rj/3)âˆ©
B (ai, ri/3) where i < j. Then
||ai âˆ’aj||
â‰¤
||ai âˆ’x|| + ||x âˆ’aj||
<
1
3 (ri + rj) â‰¤1
3
Âµ
ri + 4
3ri
Â¶
=
7
9ri < ri
contrary to the construction which requires aj /âˆˆB (ai, ri).
Finally consider the ï¬rst claim of 18.5. It is true if J < âˆž. This follows from
the construction. If J = âˆž, then since A is bounded and the balls, B (aj, rj/3) are
disjoint, it must be the case that limiâ†’âˆžri = 0. Suppose J = âˆžso that Am Ì¸= âˆ…
for all m. If a0 fails to be covered, then a0 âˆˆAk for all k. Let a0 âˆˆB (a0, r0) âˆˆF
for some ball B (a0, r0) . Then for i large enough, ri <
1
10r0 and so since a0 âˆˆAiâˆ’1,
3
4r0 â‰¤3
4 sup {r : B (a, r) âˆˆF, a âˆˆAiâˆ’1} â‰¤ri < 1
10r0,
a contradiction. This proves the lemma.
Lemma 18.6 There exists a constant Mn depending only on n such that for each
1 â‰¤k â‰¤J, Mn exceeds the number of sets Bj for j < k which have nonempty
intersection with Bk.

18.1.
BESICOVITCH COVERING THEOREM
499
Proof: These sets Bj which intersect Bk are of two types. Either they have
large radius, rj > 10rk, or they have small radius, rj â‰¤10rk. In this argument let
card (S) denote the number of elements in the set S. Deï¬ne for ï¬xed k,
I â‰¡{j : 1 â‰¤j < k, Bj âˆ©Bk Ì¸= âˆ…, rj â‰¤10rk},
K â‰¡{j : 1 â‰¤j < k, Bj âˆ©Bk Ì¸= âˆ…, rj > 10rk}.
Claim 1: B
Â¡
aj, rj
3
Â¢
âŠ†B (ak, 15rk) for j âˆˆI.
Proof: Let j âˆˆI. Then Bj âˆ©Bk Ì¸= âˆ…and rj â‰¤10rk. Now if
x âˆˆB
Â³
aj, rj
3
Â´
,
then since rj â‰¤10rk,
||x âˆ’ak||
â‰¤
||x âˆ’aj|| + ||aj âˆ’ak|| â‰¤rj
3 + rj + rk =
4
3rj + rk
â‰¤
4
3 (10rk) + rk = 43
3 rk < 15rk.
Therefore, B
Â¡
aj, rj
3
Â¢
âŠ†B (ak, 15rk).
Claim 2: card (I) â‰¤60n.
Proof: Recall r (Bk) â‰¤4
3r (Bj) . Then letting Î± (n) rn be the Lebesgue measure
of the n dimensional ball of radius r, (Note this Î± (n) depends on the norm used.)
Î± (n) 15nrn
k
â‰¡
mn (B (ak, 15rk)) â‰¥
X
jâˆˆI
mn
Â³
B
Â³
aj, rj
3
Â´Â´
=
X
jâˆˆI
Î± (n)
Â³rj
3
Â´n
â‰¥
X
jâˆˆI
Î± (n)
Â³rk
4
Â´n Âµ
since rk â‰¤4
3rj
Â¶
=
card (I) Î± (n)
Â³rk
4
Â´n
and so it follows card (I) â‰¤60n as claimed.
Claim 3: card (K) â‰¤Ln where Ln is the constant of Corollary 18.3.
Proof: Consider {Bj : j âˆˆK} and Bk. Let f (x) â‰¡râˆ’1
k
(x âˆ’xk) . Then f (Bk) =
B (0, 1) and
f (Bj) = râˆ’1
k B (xj âˆ’xk, rj) = B
Âµxj âˆ’xk
rk
, rj/rk
Â¶
.
Then rj/rk â‰¥10 because j âˆˆK. None of the balls, f (Bj) contain 0 but all these
balls intersect B (0, 1) and as just noted, each of these balls has radius â‰¥10 and
none of them contains two centers on its interior. By Corollary 18.3, it follows there
are no more than Ln of them. This proves the claim. A constant which will satisfy
the desired conditions is
Mn â‰¡Ln + 60n + 1.
This completes the proof of Lemma 18.6.

500
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
Next subdivide the balls {Bi}J
i=1 into Mn subsets G1, Â· Â· Â·, GMn each of which
consists of disjoint balls.
This is done in the following way.
Let B1 âˆˆG1.
If
B1, Â· Â· Â·, Bk have each been assigned to one of the sets G1, Â· Â· Â·, GMn, let Bk+1 âˆˆGr
where r is the smallest index having the property that Bk+1 does not intersect any
of the balls already in Gr. There must exist such an index r âˆˆ{1, Â· Â· Â·, Mn} because
otherwise Bk+1 âˆ©Bj Ì¸= âˆ…for at least Mn values of j < k + 1 contradicting Lemma
18.6. By Lemma 18.5
A âŠ†âˆªMn
i=1 {B : B âˆˆGi} = âˆªJ
j=1Bj.
This proves Theorem 18.4 in the case where A is bounded.
To complete the proof of this theorem, the restriction that A is bounded must
be removed. Deï¬ne
Al â‰¡A âˆ©{x âˆˆRn : 10 (l âˆ’1) D â‰¤||x|| < 10lD} , l = 1, 2, Â· Â· Â·
and
Fl = {B (a,r) : B (a,r) âˆˆF and a âˆˆAl}.
Then since D is an upper bound for all the diameters of these balls,
(âˆªFl) âˆ©(âˆªFm) = âˆ…
(18.6)
whenever m â‰¥l + 2. Therefore, applying what was just shown to the pair (Al, Fl),
there exist subsets of Fl, Gl
1 Â· Â· Â· Gl
Mn such that each Gl
i is a countable collection of
disjoint balls of Fl âŠ†F and
Al âŠ†âˆªMn
i=1
Â©
B : B âˆˆGl
i
Âª
.
Now let Gj â‰¡âˆªâˆž
l=1G2lâˆ’1
j
for 1 â‰¤j â‰¤Mn and for 1 â‰¤j â‰¤Mn, let Gj+Mn â‰¡âˆªâˆž
l=1G2l
j .
Thus, letting Nn â‰¡2Mn,
A = âˆªâˆž
l=1A2l âˆªâˆªâˆž
l=1A2lâˆ’1 âŠ†âˆªNn
j=1 {B : B âˆˆGj}
and by 18.6, each Gj is a countable set of disjoint balls of F.
This proves the
Besicovitch covering theorem.
18.2
Fundamental Theorem Of Calculus For Radon
Measures
In this section the Besicovitch covering theorem will be used to give a generalization
of the Lebesgue diï¬€erentiation theorem to general Radon measures. In what follows,
Âµ will be a Radon measure,
Z â‰¡{x âˆˆRn : Âµ (B (x,r)) = 0 for some r > 0},
Z
B(x,r)
âˆ’
fdÂµ â‰¡
Â½ 0 if x âˆˆZ,
1
Âµ(B(x,r))
R
B(x,r) fdÂµ if x /âˆˆZ,

18.2.
FUNDAMENTAL THEOREM OF CALCULUS FOR RADON MEASURES 501
and the maximal function Mf : Rn â†’[0, âˆž] is given by
Mf (x) â‰¡sup
râ‰¤1
Z
B(x,r)
âˆ’
|f| dÂµ.
Lemma 18.7 Z is measurable and Âµ (Z) = 0.
Proof: For each x âˆˆZ, there exists a ball B (x,r) with Âµ (B (x,r)) = 0. Let C
be the collection of these balls. Since Rn has a countable basis, a countable subset,
eC, of C also covers Z. Let
eC = {Bi}âˆž
i=1 .
Then letting Âµ denote the outer measure determined by Âµ,
Âµ (Z) â‰¤
âˆž
X
i=1
Âµ (Bi) =
âˆž
X
i=1
Âµ (Bi) = 0
Therefore, Z is measurable and has measure zero as claimed.
Theorem 18.8 Let Âµ be a Radon measure and let f âˆˆL1 (Rn, Âµ). Then
lim
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y) = 0
for Âµ a.e. x âˆˆRn.
Proof: First consider the following claim which is a weak type estimate of the
same sort used when diï¬€erentiating with respect to Lebesgue measure.
Claim 1:
Âµ ([Mf > Îµ]) â‰¤NnÎµâˆ’1 ||f||1
Proof: First note A âˆ©Z = âˆ…. For each x âˆˆA there exists a ball Bx = B (x,rx)
with rx â‰¤1 and
Âµ (Bx)âˆ’1
Z
B(x,rx)
|f| dÂµ > Îµ.
Let F be this collection of balls so that A is the set of centers of balls of F. By the
Besicovitch covering theorem,
A âŠ†âˆªNn
i=1 {B : B âˆˆGi}
where Gi is a collection of disjoint balls of F. Now for some i,
Âµ (A) /Nn â‰¤Âµ (âˆª{B : B âˆˆGi})
because if this is not so, then
Âµ (A) â‰¤
Nn
X
i=1
Âµ (âˆª{B : B âˆˆGi}) <
Nn
X
i=1
Âµ (A)
Nn
= Âµ (A),

502
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
a contradiction. Therefore for this i,
Âµ (A)
Nn
â‰¤
Âµ (âˆª{B : B âˆˆGi}) =
X
BâˆˆGi
Âµ (B) â‰¤
X
BâˆˆGi
Îµâˆ’1
Z
B
|f| dÂµ
â‰¤
Îµâˆ’1
Z
Rn |f| dÂµ = Îµâˆ’1 ||f||1 .
This shows Claim 1.
Claim 2: If g is any continuous function deï¬ned on Rn, then
lim
râ†’0
Z
B(x,r)
âˆ’
|g (y) âˆ’g (x)| dÂµ (y) = 0
and if x /âˆˆZ,
lim
râ†’0
1
Âµ (B (x,r))
Z
B(x,r)
g (y) dÂµ (y) = g (x).
(18.7)
Proof: If x âˆˆZ there is nothing to prove. If x /âˆˆZ, then since g is continuous
at x, whenever r is small enough,
Z
B(x,r)
âˆ’
|g (y) âˆ’g (x)| dÂµ (y)
=
1
Âµ (B (x,r))
Z
B(x,r)
|g (y) âˆ’g (x)| dÂµ (y)
â‰¤
1
Âµ (B (x,r))
Z
B(x,r)
Îµ dÂµ (y) = Îµ.
18.7 follows from the above and the triangle inequality. This proves the claim.
Now let g âˆˆCc (Rn) and x /âˆˆZ.
Then from the above observations about
continuous functions,
Âµ
Ãƒ"
x : lim sup
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y) > Îµ
#!
(18.8)
â‰¤
Âµ
Ãƒ"
x : lim sup
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’g (y)| dÂµ (y) > Îµ
2
#!
+Âµ
Â³h
x : |g (x) âˆ’f (x)| > Îµ
2
iÂ´
.
â‰¤Âµ
Â³h
M (f âˆ’g) > Îµ
2
iÂ´
+ Âµ
Â³h
|f âˆ’g| > Îµ
2
iÂ´
(18.9)
Now
Z
[|fâˆ’g|> Îµ
2]
|f âˆ’g| dÂµ â‰¥Îµ
2Âµ
Â³h
|f âˆ’g| > Îµ
2
iÂ´

18.2.
FUNDAMENTAL THEOREM OF CALCULUS FOR RADON MEASURES 503
and so from Claim 1 18.9 and hence 18.8 is dominated by
Âµ2
Îµ + Nn
Îµ
Â¶
||f âˆ’g||L1(Rn,Âµ) .
But by regularity of Radon measures, Cc (Rn) is dense in L1 (Rn, Âµ) and so since g
in the above is arbitrary, this shows 18.8 equals 0. Now
Âµ
Ãƒ"
x : lim sup
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y) > 0
#!
=
Âµ
Ãƒ
âˆªâˆž
m=1
Ãƒ"
x : lim sup
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y) > 1
m
#!!
â‰¤
âˆž
X
m=1
Âµ
Ãƒ"
x : lim sup
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y) > 1
m
#!
= 0.
By Lemma 18.7 the set Z is a set of measure zero and so if
x /âˆˆ
"
lim sup
râ†’0
Z
B(Â·,r)
âˆ’
|f (y) âˆ’f (Â·)| dÂµ (y) > 0
#
âˆªZ
the above has shown
0
â‰¤
lim inf
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y)
â‰¤
lim sup
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y) = 0
which proves the theorem.
The following corollary is the main result referred to as the Lebesgue Besicovitch
Diï¬€erentiation theorem.
Corollary 18.9 If f âˆˆL1
loc (Rn, Âµ),
lim
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y) = 0 Âµ a.e. x.
(18.10)
Proof: If f is replaced by fXB(0,k) then the conclusion 18.10 holds for all x /âˆˆFk
where Fk is a set of Âµ measure 0. Letting k = 1, 2, Â· Â· Â·, and F â‰¡âˆªâˆž
k=1Fk, it follows
that F is a set of measure zero and for any x /âˆˆF, and k âˆˆ{1, 2, Â· Â· Â·}, 18.10 holds
if f is replaced by fXB(0,k). Picking any such x, and letting k > |x| + 1, this shows
lim
râ†’0
Z
B(x,r)
âˆ’
|f (y) âˆ’f (x)| dÂµ (y)
= lim
râ†’0
Z
B(x,r)
âˆ’
Â¯Â¯fXB(0,k) (y) âˆ’fXB(0,k) (x)
Â¯Â¯ dÂµ (y) = 0.
This proves the corollary.

504
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
18.3
Slicing Measures
Let Âµ be a ï¬nite Radon measure. I will show here that a formula of the following
form holds.
Âµ (F) =
Z
F
dÂµ =
Z
Rn
Z
Rm XF (x, y) dÎ½x (y) dÎ± (x)
where Î± (E) = Âµ (E Ã— Rm). When this is done, the measures, Î½x, are called slicing
measures and this shows that an integral with respect to Âµ can be written as an
iterated integral in terms of the measure Î± and the slicing measures, Î½x. This is
like going backwards in the construction of product measure. One starts with a
measure, Âµ, deï¬ned on the Cartesian product and produces Î± and an inï¬nite family
of slicing measures from it whereas in the construction of product measure, one
starts with two measures and obtains a new measure on a Ïƒ algebra of subsets of
the Cartesian product of two spaces. First here are two technical lemmas.
Lemma 18.10 The space Cc (Rm) with the norm
||f|| â‰¡sup {|f (y)| : y âˆˆRm}
is separable.
Proof: Let Dl consist of all functions which are of the form
X
|Î±|â‰¤N
aÎ±yÎ± Â³
dist
Â³
y,B (0,l + 1)CÂ´Â´nÎ±
where aÎ± âˆˆQ, Î± is a multi-index, and nÎ± is a positive integer. Then Dl is countable,
separates the points of B (0,l) and annihilates no point of B (0,l). By the Stone
Weierstrass theorem Dl is dense in the space C
Â³
B (0,l)
Â´
and so âˆª{Dl : l âˆˆN} is a
countable dense subset of Cc (Rm).
From the regularity of Radon measures, the following lemma follows.
Lemma 18.11 If Âµ and Î½ are two Radon measures deï¬ned on Ïƒ algebras, SÂµ and
SÎ½, of subsets of Rn and if Âµ (V ) = Î½ (V ) for all V open, then Âµ = Î½ and SÂµ = SÎ½.
Proof: Every compact set is a countable intersection of open sets so the two
measures agree on every compact set. Hence it is routine that the two measures
agree on every GÎ´ and FÏƒ set. (Recall GÎ´ sets are countable intersections of open
sets and FÏƒ sets are countable unions of closed sets.) Now suppose E âˆˆSÎ½ is a
bounded set. Then by regularity of Î½ there exists G a GÎ´ set and F, an FÏƒ set
such that F âŠ†E âŠ†G and Î½ (G \ F) = 0. Then it is also true that Âµ (G \ F) = 0.
Hence E = F âˆª(E \ F) and E \ F is a subset of G \ F, a set of Âµ measure zero. By
completeness of Âµ, it follows E âˆˆSÂµ and
Âµ (E) = Âµ (F) = Î½ (F) = Î½ (E) .
If E âˆˆSÎ½ not necessarily bounded, let Em = E âˆ©B (0, m) and then Em âˆˆSÂµ and
Âµ (Em) = Î½ (Em) . Letting m â†’âˆž, E âˆˆSÂµ and Âµ (E) = Î½ (E) . Similarly, SÂµ âŠ†SÎ½
and the two measures are equal on SÂµ.
The main result in the section is the following theorem.

18.3.
SLICING MEASURES
505
Theorem 18.12 Let Âµ be a ï¬nite Radon measure on Rn+m deï¬ned on a Ïƒ algebra,
F. Then there exists a unique ï¬nite Radon measure, Î±, deï¬ned on a Ïƒ algebra, S,
of sets of Rn which satisï¬es
Î± (E) = Âµ (E Ã— Rm)
(18.11)
for all E Borel.
There also exists a Borel set of Î± measure zero, N, such that
for each x /âˆˆN, there exists a Radon probability measure Î½x such that if f is a
nonnegative Âµ measurable function or a Âµ measurable function in L1 (Âµ),
y â†’f (x, y) is Î½x measurable Î± a.e.
x â†’
Z
Rm f (x, y) dÎ½x (y) is Î± measurable
(18.12)
and
Z
Rn+m f (x, y) dÂµ =
Z
Rn
ÂµZ
Rm f (x, y) dÎ½x (y)
Â¶
dÎ± (x).
(18.13)
If bÎ½x is any other collection of Radon measures satisfying 18.12 and 18.13, then
bÎ½x = Î½x for Î± a.e. x.
Proof: First consider the uniqueness of Î±. Suppose Î±1 is another Radon measure
satisfying 18.11. Then in particular, Î±1 and Î± agree on open sets and so the two
measures are the same by Lemma 18.11.
To establish the existence of Î±, deï¬ne Î±0 on Borel sets by
Î±0 (E) = Âµ (E Ã— Rm).
Thus Î±0 is a ï¬nite Borel measure and so it is ï¬nite on compact sets. Lemma 11.3
on Page 11.3 implies the existence of the Radon measure Î± extending Î±0.
Next consider the uniqueness of Î½x. Suppose Î½x and bÎ½x satisfy all conclusions
of the theorem with exceptional sets denoted by N and b
N respectively.
Then,
enlarging N and b
N, one may also assume, using Lemma 18.7, that for x /âˆˆN âˆªb
N,
Î± (B (x,r)) > 0 whenever r > 0. Now let
A =
m
Y
i=1
(ai, bi]
where ai and bi are rational. Thus there are countably many such sets. Then from
the conclusion of the theorem, if x0 /âˆˆN âˆªb
N,
1
Î± (B (x0, r))
Z
B(x0,r)
Z
Rm XA (y) dÎ½x (y) dÎ±
=
1
Î± (B (x0, r))
Z
B(x0,r)
Z
Rm XA (y) dbÎ½x (y) dÎ±,

506
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
and by the Lebesgue Besicovitch Diï¬€erentiation theorem, there exists a set of Î±
measure zero, EA, such that if x0 /âˆˆEA âˆªN âˆªb
N, then the limit in the above exists
as r â†’0 and yields
Î½x0 (A) = bÎ½x0 (A).
Letting E denote the union of all the sets EA for A as described above, it follows
that E is a set of measure zero and if x0 /âˆˆE âˆªN âˆªb
N then Î½x0 (A) = bÎ½x0 (A) for
all such sets A. But every open set can be written as a disjoint union of sets of this
form and so for all such x0, Î½x0 (V ) = bÎ½x0 (V ) for all V open. By Lemma 18.11
this shows the two measures are equal and proves the uniqueness assertion for Î½x.
It remains to show the existence of the measures Î½x. This will be done with the aid
of the following lemma. The idea is to deï¬ne a positive linear functional which will
yield the desired measure, Î½x and this lemma will help in making this deï¬nition.
Lemma 18.13 There exists a set N of Î± measure 0, independent of f âˆˆCc (Rn+m)
such that if x /âˆˆN, Î± (B (x,r)) > 0 for all r > 0 and
lim
râ†’0
1
Î± (B (x,r))
Z
B(x,r)Ã—Rm fdÂµ = gf (x)
where gf is a Î± measurable function with the property that
Z
Rn gf (x) dÎ± =
Z
RnÃ—Rm fdÂµ.
Proof: Let f âˆˆCc (Rn+m) and let
Î·f (E) â‰¡
Z
EÃ—Rm fdÂµ.
Then Î·f is a ï¬nite measure deï¬ned on the Borel sets with Î·f â‰ªÎ±. By the Radon
Nikodym theorem, there exists a Borel measurable function egf such that for all
Borel E,
Î·f (E) â‰¡
Z
EÃ—Rm fdÂµ =
Z
E
egfdÎ±.
(18.14)
By the theory of diï¬€erentiation for Radon measures, there exists a set of Î± measure
zero, Nf such that if x /âˆˆNf, then Î± (B (x,r)) > 0 for all r > 0 and
lim
râ†’0
1
Î± (B (x,r))
Z
B(x,r)Ã—Rm fdÂµ = lim
râ†’0
Z
B(x,r)
âˆ’
egfdÎ± = egf (x).
Let D be a countable dense subset of Cc (Rn+m) and let
N â‰¡âˆª{Nf : f âˆˆD}.
Then if f âˆˆCc (Rn+m) is arbitrary, and x /âˆˆN, referring to 18.14, it follows there
exists g âˆˆD close enough to f such that for all r1, r2,
Â¯Â¯Â¯Â¯Â¯
1
Î± (B (x,r1))
Z
B(x,r1)Ã—Rm fdÂµ âˆ’
1
Î± (B (x,r2))
Z
B(x,r2)Ã—Rm fdÂµ
Â¯Â¯Â¯Â¯Â¯ <

18.3.
SLICING MEASURES
507
Îµ
2 +
Â¯Â¯Â¯Â¯Â¯
1
Î± (B (x,r1))
Z
B(x,r1)Ã—Rm gdÂµ âˆ’
1
Î± (B (x,r2))
Z
B(x,r2)Ã—Rm gdÂµ
Â¯Â¯Â¯Â¯Â¯
Therefore, taking ri small enough, the right side is less than Îµ. Since Îµ is arbitrary,
this shows the limit as r â†’0 exists. Deï¬ne this limit which exists for all f âˆˆ
Cc (Rn+m) and x /âˆˆN as gf (x). By the ï¬rst part of the argument, gf (x) = egf (x)
a.e. Thus, gf (x) is Î± measurable because it equals a Borel measurable function Î±
a.e. The ï¬nal formula follows from
Z
Rn gf (x) dÎ± =
Z
Rn egf (x) dÎ± â‰¡Î·f (Rn) â‰¡
Z
RnÃ—Rm fdÂµ.
This proves the lemma.
Continuing with the proof of the theorem, let x /âˆˆN and let f (z, y) â‰¡Ïˆ (z) Ï† (y)
where Ïˆ and Ï† are continuous functions with compact support in Rn and Rm re-
spectively. Suppose ï¬rst that Ïˆ (x) = 1. Then deï¬ne a positive linear functional
LxÏ† â‰¡lim
râ†’0
1
Î± (B (x,r))
Z
B(x,r)Ã—Rm Ïˆ (z) Ï† (y) dÂµ (z, y).
This functional may appear to depend on the choice of Ïˆ satisfying Ïˆ (x) = 1 but
this is not the case because all such Ïˆâ€²s used in the deï¬nition of Lx are continuous.
Let Î½x be the Radon measure representing Lx.
Thus replacing an arbitrary
Ïˆ âˆˆCc (Rn) with
Ïˆ
Ïˆ(x), in the case when Ïˆ (x) Ì¸= 0,
Ïˆ (x) Lx (Ï†)
=
Ïˆ (x)
Z
Rm Ï† (y) dÎ½x (y)
=
lim
râ†’0
Ïˆ (x)
Î± (B (x,r))
Z
B(x,r)Ã—Rm
Ïˆ
Ïˆ (x)Ï†dÂµ
=
lim
râ†’0
1
Î± (B (x,r))
Z
B(x,r)Ã—Rm ÏˆÏ†dÂµ
By Lemma 18.13,
Z
Rn
Z
Rm ÏˆÏ†dÎ½xdÎ± =
Z
Rn gÏˆÏ†dÎ± =
Z
RnÃ—Rm ÏˆÏ†dÂµ.
Letting Ïˆk, Ï†k increase to 1 pointwise, the monotone convergence theorem implies
Z
Rn Î½x (Rm) dÎ± =
Z
RnÃ—Rm dÂµ = Âµ (Rn Ã— Rm) < âˆž
(18.15)
showing that x â†’Î½x (Rm) is a function in L1 (Î±). In particular, this function is
ï¬nite Î± a.e. Summarizing, the above has shown that whenever Ïˆ âˆˆCc (Rn) and
Ï† âˆˆCc (Rm)
Z
Rn
Z
Rm ÏˆÏ†dÎ½xdÎ± =
Z
RnÃ—Rm ÏˆÏ†dÂµ.
(18.16)

508
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
Also Î½x is a ï¬nite measure Î± a.e. and Î½x and Î± are Radon measures.
Next it is shown that ÏˆÏ† can be replaced by XE where E is an arbitrary Âµ
measurable set. To do so, let
R1 â‰¡
n
Y
i=1
(ai, bi], R2 â‰¡
m
Y
i=1
(ci, di]
(18.17)
and let Ïˆk be a sequence of functions in Cc (Rn) which is bounded, piecewise linear
in each variable, and converging pointwise to XR1. Also let Ï†k be a similar sequence
converging pointwise to XR2. Then by the dominated convergence theorem,
Z
RnÃ—Rm XR1 (x) XR2 (y) dÂµ = lim
kâ†’âˆž
Z
RnÃ—Rm Ïˆk (x) Ï†k (y) dÂµ
= lim
kâ†’âˆž
Z
Rn Ïˆk (x)
ÂµZ
Rm Ï†k (y) dÎ½x
Â¶
dÎ±.
(18.18)
Since Î½x is ï¬nite Î± a.e., it follows that for Î± a.e. x,
lim
kâ†’âˆž
Z
Rm Ï†k (y) dÎ½x =
Z
Rm XR2 (y) dÎ½x.
Since the Ï†k are uniformly bounded, 18.15 implies the existence of a dominating
function for the integrand in 18.18. Therefore, one can take the limit inside the
integrals and obtain
Z
RnÃ—Rm XR1 (x) XR2 (y) dÂµ =
Z
Rn
Z
Rm XR1 (x) XR2 (y) dÎ½xdÎ±
Every open set, V in Rn+m is a countable disjoint union of such half open rectangles
and so the monotone convergence theorem implies for all V open in Rn+m,
Z
RnÃ—Rm XV dÂµ =
Z
Rn
Z
Rm XV dÎ½xdÎ±.
(18.19)
Since every compact set is the countable intersection of open sets, the above for-
mula holds for V replaced with K where K is compact. Then it follows from the
dominated convergence and monotone convergence theorems that whenever H is
either a GÎ´ (countable intersection of open sets) or a FÏƒ (countable union of closed
sets)
Z
RnÃ—Rm XHdÂµ =
Z
Rn
Z
Rm XHdÎ½xdÎ±.
Now let E be Âµ measurable. Using the regularity of Âµ there exists F, G such that
F is FÏƒ, G is GÎ´, Âµ (G \ F) = 0, and F âŠ†E âŠ†G. Also a routine application of the
dominated convergence theorem and 18.19 shows
Z
RnÃ—Rm X(G\F )dÂµ =
Z
Rn
Z
Rm X(G\F )dÎ½xdÎ±

18.4.
VITALI COVERINGS
509
and (G \ F)x â‰¡{y : (x, y) âˆˆG \ F} is Î½x measurable for Î± a.e. x, wherever Î½x is a
ï¬nite measure, and for Î± a.e. x, Î½x (G \ F)x = 0. Therefore, for Î± a.e. x, Ex is Î½x
measurable because Ex = Fx + Sx where Sx âŠ†(G \ F)x , a set of Î½x measure zero
and Fx is an FÏƒ set which is measurable because Î½x is a Radon measure coming as
it does from a positive linear functional. Therefore,
Z
RnÃ—Rm XEdÂµ
=
Z
RnÃ—Rm XF dÂµ =
Z
Rn
Z
Rm XF dÎ½xdÎ±
=
Z
Rn
Z
Rm XEdÎ½xdÎ±.
(18.20)
It follows from 18.20 that one can replace XE with an arbitrary nonnegative Âµ
measurable simple function, s. Letting f be a nonnegative Âµ measurable function,
it follows there is an increasing sequence of nonnegative simple functions converging
to f pointwise and so by the monotone convergence theorem,
Z
RnÃ—Rm fdÂµ =
Z
Rn
Z
Rm fdÎ½xdÎ±
where y â†’f (x, y) is Î½x measurable for Î± a.e. x and x â†’
R
Rm fdÎ½x is Î± measurable
so the iterated integral makes sense.
To see Î½x is a probability measure for a.e. x,
1
Î± (B (x, r))
Z
B(x,r)
Z
Rm dÎ½xdÎ±
=
1
Î± (B (x, r))Âµ (B (x, r) Ã— Rm) = 1
and so, using the fundamental theorem of calculus it follows that upon passing to
a limit as r â†’0, it follows that for Î± a.e. x
Î½x (Rm) =
Z
Rm dÎ½x = 1
Due to the regularity of the measures, all sets of measure zero may be taken to be
Borel. In the case of f âˆˆL1 (Âµ) , one applies the above to the positive and negative
parts of the real and imaginary parts. This proves the theorem.
18.4
Vitali Coverings
There is another covering theorem which may also be referred to as the Besicovitch
covering theorem. As before, the balls can be taken with respect to any norm on
Rn. At ï¬rst, the balls will be closed but this assumption will be removed.
Deï¬nition 18.14 A collection of balls, F covers a set, E in the sense of Vitali if
whenever x âˆˆE and Îµ > 0, there exists a ball B âˆˆF
whose center is x having
diameter less than Îµ.

510
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
I will give a proof of the following theorem.
Theorem 18.15 Let Âµ be a Radon measure on Rn and let E be a set with Âµ (E) <
âˆž. Where Âµ is the outer measure determined by Âµ. Suppose F is a collection of
closed balls which cover E in the sense of Vitali. Then there exists a sequence of
disjoint balls, {Bi} âŠ†F such that
Âµ
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
= 0.
Proof: Let Nn be the constant of the Besicovitch covering theorem. Choose
r > 0 such that
(1 âˆ’r)âˆ’1
Âµ
1 âˆ’
1
2Nn + 2
Â¶
â‰¡Î» < 1.
If Âµ (E) = 0, there is nothing to prove so assume Âµ (E) > 0. Let U1 be an open
set containing E with (1 âˆ’r) Âµ (U1) < Âµ (E) and 2Âµ (E) > Âµ (U1) , and let F1 be
those sets of F which are contained in U1 whose centers are in E. Thus F1 is also
a Vitali cover of E. Now by the Besicovitch covering theorem proved earlier, there
exist balls, B, of F1 such that
E âŠ†âˆªNn
i=1 {B : B âˆˆGi}
where Gi consists of a collection of disjoint balls of F1. Therefore,
Âµ (E) â‰¤
Nn
X
i=1
X
BâˆˆGi
Âµ (B)
and so, for some i â‰¤Nn,
(Nn + 1)
X
BâˆˆGi
Âµ (B) > Âµ (E) .
It follows there exists a ï¬nite set of balls of Gi, {B1, Â· Â· Â·, Bm1} such that
(Nn + 1)
m1
X
i=1
Âµ (Bi) > Âµ (E)
(18.21)
and so
(2Nn + 2)
m1
X
i=1
Âµ (Bi) > 2Âµ (E) > Âµ (U1) .
Since 2Âµ (E) â‰¥Âµ (U1) , 18.21 implies
Âµ (U1)
2N2 + 2 â‰¤2Âµ (E)
2N2 + 2 = Âµ (E)
N2 + 1 <
m1
X
i=1
Âµ (Bi) .
Also U1 was chosen such that (1 âˆ’r) Âµ (U1) < Âµ (E) , and so
Î»Âµ (E) â‰¥Î» (1 âˆ’r) Âµ (U1) =
Âµ
1 âˆ’
1
2Nn + 2
Â¶
Âµ (U1)

18.4.
VITALI COVERINGS
511
â‰¥Âµ (U1) âˆ’
m1
X
i=1
Âµ (Bi) = Âµ (U1) âˆ’Âµ
Â¡
âˆªm1
j=1Bj
Â¢
= Âµ
Â¡
U1 \ âˆªm1
j=1Bj
Â¢
â‰¥Âµ
Â¡
E \ âˆªm1
j=1Bj
Â¢
.
Since the balls are closed, you can consider the sets of F which have empty intersec-
tion with âˆªm1
j=1Bj and this new collection of sets will be a Vitali cover of E\âˆªm1
j=1Bj.
Letting this collection of balls play the role of F in the above argument and letting
E \ âˆªm1
j=1Bj play the role of E, repeat the above argument and obtain disjoint sets
of F,
{Bm1+1, Â· Â· Â·, Bm2} ,
such that
Î»Âµ
Â¡
E \ âˆªm1
j=1Bj
Â¢
> Âµ
Â¡Â¡
E \ âˆªm1
j=1Bj
Â¢
\ âˆªm2
j=m1+1Bj
Â¢
= Âµ
Â¡
E \ âˆªm2
j=1Bj
Â¢
,
and so
Î»2Âµ (E) > Âµ
Â¡
E \ âˆªm2
j=1Bj
Â¢
.
Continuing in this way, yields a sequence of disjoint balls {Bi} contained in F and
Âµ
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
â‰¤Âµ
Â¡
E \ âˆªmk
j=1Bj
Â¢
< Î»kÂµ (E )
for all k. Therefore, Âµ
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
= 0 and this proves the Theorem.
It is not necessary to assume Âµ (E) < âˆž.
Corollary 18.16 Let Âµ be a Radon measure on Rn. Letting Âµ be the outer measure
determined by Âµ, suppose F is a collection of closed balls which cover E in the sense
of Vitali. Then there exists a sequence of disjoint balls, {Bi} âŠ†F such that
Âµ
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
= 0.
Proof: Since Âµ is a Radon measure it is ï¬nite on compact sets. Therefore,
there are at most countably many numbers, {bi}âˆž
i=1 such that Âµ (âˆ‚B (0, bi)) > 0. It
follows there exists an increasing sequence of positive numbers, {ri}âˆž
i=1 such that
limiâ†’âˆžri = âˆžand Âµ (âˆ‚B (0, ri)) = 0. Now let
D1
â‰¡
{x : ||x|| < r1} , D2 â‰¡{x : r1 < ||x|| < r2} ,
Â· Â· Â·, Dm
â‰¡
{x : rmâˆ’1 < ||x|| < rm} , Â· Â· Â·.
Let Fm denote those closed balls of F which are contained in Dm. Then letting
Em denote E âˆ©Dm, Fm is a Vitali cover of Em, Âµ (Em) < âˆž, and so by Theorem
18.15, there exists a countable sequence of balls from Fm
Â©
Bm
j
Âªâˆž
j=1 , such that
Âµ
Â¡
Em \ âˆªâˆž
j=1Bm
j
Â¢
= 0. Then consider the countable collection of balls,
Â©
Bm
j
Âªâˆž
j,m=1 .
Âµ
Â¡
E \ âˆªâˆž
m=1 âˆªâˆž
j=1 Bm
j
Â¢
â‰¤
Âµ
Â¡
âˆªâˆž
j=1âˆ‚B (0, ri)
Â¢
+
+
âˆž
X
m=1
Âµ
Â¡
Em \ âˆªâˆž
j=1Bm
j
Â¢
=
0

512
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
This proves the corollary.
You donâ€™t need to assume the balls are closed. In fact, the balls can be open
closed or anything in between and the same conclusion can be drawn.
Corollary 18.17 Let Âµ be a Radon measure on Rn. Letting Âµ be the outer measure
determined by Âµ, suppose F is a collection of balls which cover E in the sense
of Vitali, open closed or neither. Then there exists a sequence of disjoint balls,
{Bi} âŠ†F such that
Âµ
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
= 0.
Proof: Let x âˆˆE. Thus x is the center of arbitrarily small balls from F. Since
Âµ is a Radon measure, at most countably many radii, r of these balls can have
the property that Âµ (âˆ‚B (0, r)) = 0. Let Fâ€² denote the closures of the balls of F,
B (x, r) with the property that Âµ (âˆ‚B (x, r)) = 0. Since for each x âˆˆE there are only
countably many exceptions, Fâ€² is still a Vitali cover of E. Therefore, by Corollary
18.16 there is a disjoint sequence of these balls of Fâ€²,
Â©
Bi
Âªâˆž
i=1 for which
Âµ
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
= 0
However, since their boundaries have Âµ measure zero, it follows
Âµ
Â¡
E \ âˆªâˆž
j=1Bj
Â¢
= 0.
This proves the corollary.
18.5
Diï¬€erentiation Of Radon Measures
This section is a generalization of earlier material in which a measure was diï¬€er-
entiated with respect to Lebesgue measure. Here an arbitrary Radon measure will
be diï¬€erentiated with respect to another arbitrary Radon measure. In this sec-
tion, B (x, r) will denote a ball with center x and radius r. Also, let Î» and Âµ be
Radon measures and as above, Z will denote a Âµ measure zero set oï¬€of which
Âµ (B (x, r)) > 0 for all r > 0.
Deï¬nition 18.18 For x /âˆˆZ, deï¬ne the upper and lower symmetric derivatives as
DÂµÎ» (x) â‰¡lim sup
râ†’0
Î» (B (x, r))
Âµ (B (x, r)), DÂµÎ» (x) â‰¡lim inf
râ†’0
Î» (B (x, r))
Âµ (B (x, r)).
respectively. Also deï¬ne
DÂµÎ» (x) â‰¡DÂµÎ» (x) = DÂµÎ» (x)
in the case when both the upper and lower derivatives are equal.

18.5.
DIFFERENTIATION OF RADON MEASURES
513
Lemma 18.19 Let Î» and Âµ be Radon measures.
If A is a bounded subset of
Â©
x /âˆˆZ : DÂµÎ» (x) â‰¥a
Âª
, then
Î» (A) â‰¥aÂµ (A)
and if A is a bounded subset of
Â©
x /âˆˆZ : DÂµÎ» (x) â‰¤a
Âª
, then
Î» (A) â‰¤aÂµ (A)
Proof: Suppose ï¬rst that A is a bounded subset of
Â©
x /âˆˆZ : DÂµÎ» (x) â‰¥a
Âª
, let
Îµ > 0, and let V be a bounded open set with V âŠ‡A and Î» (V ) âˆ’Îµ < Î» (A) , Âµ (V ) âˆ’
Îµ < Âµ (A) . Then if
x âˆˆA,
Î» (B (x, r))
Âµ (B (x, r)) > a âˆ’Îµ, B (x, r) âŠ†V,
for inï¬nitely many values of r which are arbitrarily small. Thus the collection of
such balls constitutes a Vitali cover for A. By Corollary 18.17 there is a disjoint
sequence of these balls {Bi} such that
Âµ (A \ âˆªâˆž
i=1Bi) = 0.
(18.22)
Therefore,
(a âˆ’Îµ)
âˆž
X
i=1
Âµ (Bi) <
âˆž
X
i=1
Î» (Bi) â‰¤Î» (V ) < Îµ + Î» (A)
and so
a
âˆž
X
i=1
Âµ (Bi)
â‰¤
Îµ + ÎµÂµ (V ) + Î» (A)
â‰¤
Îµ + Îµ (Âµ (A) + Îµ) + Î» (A)
(18.23)
Now
Âµ (A \ âˆªâˆž
i=1Bi) + Âµ (âˆªâˆž
i=1Bi) â‰¥Âµ (A)
and so by 18.22 and the fact the Bi are disjoint,
aÂµ (A)
â‰¤
aÂµ (âˆªâˆž
i=1Bi) = a
âˆž
X
i=1
Âµ (Bi)
â‰¤
Îµ + Îµ (Âµ (A) + Îµ) + Î» (A) .
(18.24)
Hence aÂµ (A) â‰¤Î» (A) since Îµ > 0 was arbitrary.
Now suppose A is a bounded subset of
Â©
x /âˆˆZ : DÂµÎ» (x) â‰¤a
Âª
and let V be a
bounded open set containing A with Âµ (V ) âˆ’Îµ < Âµ (A) . Then if x âˆˆA,
Î» (B (x, r))
Âµ (B (x, r)) < a + Îµ, B (x, r) âŠ†V

514
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
for values of r which are arbitrarily small. Therefore, by Corollary 18.17 again,
there exists a disjoint sequence of these balls, {Bi} satisfying this time,
Î» (A \ âˆªâˆž
i=1Bi) = 0.
Then by arguments similar to the above,
Î» (A) â‰¤
âˆž
X
i=1
Î» (Bi) < (a + Îµ) Âµ (V ) < (a + Îµ) (Âµ (A) + Îµ) .
Since Îµ was arbitrary, this proves the lemma.
Theorem 18.20 There exists a set of measure zero, N containing Z such that
for x /âˆˆN, DÂµÎ» (x) exists and also XN C (Â·) DÂµÎ» (Â·) is a Âµ measurable function.
Furthermore, DÂµÎ» (x) < âˆžÂµ a.e.
Proof: First I show DÂµÎ» (x) exists a.e. Let 0 â‰¤a < b < âˆžand let A be any
bounded subset of
N (a, b) â‰¡
Â©
x /âˆˆZ : DÂµÎ» (x) > b > a > DÂµÎ» (x)
Âª
.
By Lemma 18.19,
aÂµ (A) â‰¥Î» (A) â‰¥bÂµ (A)
and so Âµ (A) = 0 and A is Âµ measurable. It follows Âµ (N (a, b)) = 0 because
Âµ (N (a, b)) â‰¤
âˆž
X
m=1
Âµ (N (a, b) âˆ©B (0, m)) = 0.
Deï¬ne
N0 â‰¡
Â©
x /âˆˆZ : DÂµÎ» (x) > DÂµÎ» (x)
Âª
.
Thus Âµ (N0) = 0 because
N0 âŠ†âˆª{N (a, b) : 0 â‰¤a < b, and a, b âˆˆQ}
Therefore, N0 is also Âµ measurable and has Âµ measure zero. Letting N â‰¡N0 âˆªZ, it
follows DÂµÎ» (x) exists on N C. It remains to verify XN C (Â·) DÂµÎ» (Â·) is ï¬nite a.e. and
is Âµ measurable.
Let
I = {x : DÂµÎ» (x) = âˆž} .
Then by Lemma 18.19
Î» (I âˆ©B (0, m)) â‰¥aÂµ (I âˆ©B (0, m))
for all a and since Î» is ï¬nite on bounded sets, the above implies Âµ (I âˆ©B (0, m)) = 0
for each m which implies that I is Âµ measurable and has Âµ measure zero since
I = âˆªâˆž
m=1Im.

18.6.
THE RADON NIKODYM THEOREM FOR RADON MEASURES
515
Letting Î· be an arbitrary Radon measure, let r > 0, and suppose Î· (âˆ‚B (x, r)) =
0. (Since Î· is ï¬nite on every ball, there are only countably many r such that
Î· (âˆ‚B (x, r)) > 0.) and let V be an open set containing B (x, r). Then whenever
y is close enough to x, it follows that B (y, r) is also a subset of V. Since V is an
arbitrary open set containing B (x, r), it follows
Î· (B (x, r)) = Î·
Â³
B (x, r)
Â´
â‰¥lim sup
yâ†’x Î· (B (y, r))
and so y â†’Î· (B (y, r)) an upper semicontinuous real valued function of x, one
which satisï¬es
f (x) â‰¥lim sup
nâ†’âˆžf (xn)
whenever xn â†’x. Now it is routine to verify that a function f is upper semicon-
tinuous if and only if f âˆ’1 ([âˆ’âˆž, a)) is open for all a âˆˆR. Therefore, f âˆ’1 ([âˆ’âˆž, a))
is a Borel set for all a âˆˆR and so f is Borel measurable by Lemma 8.6. Now the
measurability of XNC (Â·) DÂµÎ» (Â·) follows from
XNC (x) DÂµÎ» (x) = lim
riâ†’0
Î» (B (x, ri))
Âµ (B (x, ri))XNC (x)
where ri is such that âˆ‚B (x, ri) has Âµ and Î» measure zero.
18.6
The Radon Nikodym Theorem For Radon Mea-
sures
The above theory can be used to give an alternate treatment of the Radon Nikodym
theorem which exhibits the Radon Nikodym derivative as a speciï¬c limit.
Theorem 18.21 Let Î» and Âµ be Radon measures and suppose Î» â‰ªÂµ. Then for all
E a Âµ measurable set,
Î» (E) =
Z
E
(DÂµÎ») dÂµ.
Proof:
Let t > 1 and let E be a Âµ measurable set which is bounded and a
subset of N C where N is the exceptional set of Âµ measure zero in Theorem 18.20
oï¬€of which Âµ (B (x,r)) > 0 for all r > 0 and DÂµÎ» (x) exists. Consider
Em â‰¡E âˆ©
Â©
x âˆˆN C : tm â‰¤DÂµÎ» (x) < tm+1Âª
for m âˆˆZ, the integers. First note that
E âˆ©
Â©
x âˆˆN C : DÂµÎ» (x) = 0
Âª
has Î» measure zero because by Lemma 18.19,
Î»
Â¡
E âˆ©
Â©
x âˆˆN C : DÂµÎ» (x) = 0
ÂªÂ¢
â‰¤aÂµ (E )

516
DIFFERENTIATION WITH RESPECT TO GENERAL RADON MEASURES
for all a > 0 and Âµ (E ) is ï¬nite due to the assumption that E is bounded and Âµ is
a Radon measure. Therefore, by Lemma 18.19,
Î» (E) =
X
mâˆˆZ
Î» (Em) â‰¤
X
mâˆˆZ
tm+1Âµ (Em) = t
X
mâˆˆZ
tmÂµ (Em)
â‰¤t
X
mâˆˆZ
Z
Em
DÂµÎ» (x) dÂµ = t
Z
E
DÂµÎ» (x) dÂµ.
Also by this same lemma,
Î» (E) =
X
mâˆˆZ
Î» (Em) â‰¥
X
mâˆˆZ
tmÂµ (Em) = tâˆ’1 X
mâˆˆZ
tm+1Âµ (Em)
â‰¥tâˆ’1 X
mâˆˆZ
Z
Em
DÂµÎ» (x) dÂµ = tâˆ’1
Z
E
DÂµÎ» (x) dÂµ.
Thus,
t
Z
E
DÂµÎ» (x) dÂµ â‰¥Î» (E) â‰¥tâˆ’1
Z
E
DÂµÎ» (x) dÂµ
and letting t â†’1, it follows
Î» (E) =
Z
E
DÂµÎ» (x) dÂµ.
(18.25)
Now if E is an arbitrary measurable set, contained in N C, this formula holds with
E replaced with E âˆ©B (0,k) . Letting k â†’âˆžand using the monotone convergence
theorem, the above formula holds for all E âŠ†N C. Since N is a set of Âµ measure
zero, it follows N is also a set of Î» measure zero due to the assumption of absolute
continuity. Therefore 18.25 continues to hold for arbitrary Âµ measurable sets, E.
This proves the theorem.

Fourier Transforms
19.1
An Algebra Of Special Functions
First recall the following deï¬nition of a polynomial.
Deï¬nition 19.1 Î± = (Î±1, Â· Â· Â·, Î±n) for Î±1 Â· Â· Â· Î±n positive integers is called a multi-
index. For Î± a multi-index, |Î±| â‰¡Î±1 + Â· Â· Â· + Î±n and if x âˆˆRn,
x = (x1, Â· Â· Â·, xn) ,
and f a function, deï¬ne
xÎ± â‰¡xÎ±1
1 xÎ±2
2 Â· Â· Â· xÎ±n
n .
A polynomial in n variables of degree m is a function of the form
p (x) =
X
|Î±|â‰¤m
aÎ±xÎ±.
Here Î± is a multi-index as just described and aÎ± âˆˆC. Also deï¬ne for Î± = (Î±1, Â·Â·Â·, Î±n)
a multi-index
DÎ±f (x) â‰¡
âˆ‚|Î±|f
âˆ‚xÎ±1
1 âˆ‚xÎ±2
2 Â· Â· Â· âˆ‚xÎ±n
n
.
Deï¬nition 19.2 Deï¬ne G1 to be the functions of the form p (x) eâˆ’a|x|2 where a > 0
and p (x) is a polynomial. Let G be all ï¬nite sums of functions in G1. Thus G is an
algebra of functions which has the property that if f âˆˆG then f âˆˆG.
It is always assumed, unless stated otherwise that the measure will be Lebesgue
measure.
Lemma 19.3 G is dense in C0 (Rn) with respect to the norm,
||f||âˆžâ‰¡sup {|f (x)| : x âˆˆRn}
517

518
FOURIER TRANSFORMS
Proof: By the Weierstrass approximation theorem, it suï¬ƒces to show G sep-
arates the points and annihilates no point. It was already observed in the above
deï¬nition that f âˆˆG whenever f âˆˆG. If y1 Ì¸= y2 suppose ï¬rst that |y1| Ì¸= |y2| .
Then in this case, you can let f (x) â‰¡eâˆ’|x|2 and f âˆˆG and f (y1) Ì¸= f (y2). If
|y1| = |y2| , then suppose y1k Ì¸= y2k. This must happen for some k because y1 Ì¸= y2.
Then let f (x) â‰¡xkeâˆ’|x|2.
Thus G separates points. Now eâˆ’|x|2 is never equal to
zero and so G annihilates no point of Rn. This proves the lemma.
These functions are clearly quite specialized. Therefore, the following theorem
is somewhat surprising.
Theorem 19.4 For each p â‰¥1, p < âˆž, G is dense in Lp (Rn).
Proof: Let f âˆˆLp (Rn) . Then there exists g âˆˆCc (Rn) such that ||f âˆ’g||p < Îµ.
Now let b > 0 be large enough that
Z
Rn
Â³
eâˆ’b|x|2Â´p
dx < Îµp.
Then x â†’g (x) eb|x|2 is in Cc (Rn) âŠ†C0 (Rn) . Therefore, from Lemma 19.3 there
exists Ïˆ âˆˆG such that
Â¯Â¯Â¯
Â¯Â¯Â¯geb|Â·|2 âˆ’Ïˆ
Â¯Â¯Â¯
Â¯Â¯Â¯
âˆž< 1
Therefore, letting Ï† (x) â‰¡eâˆ’b|x|2Ïˆ (x) it follows that Ï† âˆˆG and for all x âˆˆRn,
|g (x) âˆ’Ï† (x)| < eâˆ’b|x|2
Therefore,
ÂµZ
Rn |g (x) âˆ’Ï† (x)|p dx
Â¶1/p
â‰¤
ÂµZ
Rn
Â³
eâˆ’b|x|2Â´p
dx
Â¶1/p
< Îµ.
It follows
||f âˆ’Ï†||p â‰¤||f âˆ’g||p + ||g âˆ’Ï†||p < 2Îµ.
Since Îµ > 0 is arbitrary, this proves the theorem.
The following lemma is also interesting even if it is obvious.
Lemma 19.5 For Ïˆ âˆˆG , p a polynomial, and Î±, Î² multiindices, DÎ±Ïˆ âˆˆG and
pÏˆ âˆˆG. Also
sup{|xÎ²DÎ±Ïˆ(x)| : x âˆˆRn} < âˆž
19.2
Fourier Transforms Of Functions In G
Deï¬nition 19.6 For Ïˆ âˆˆG Deï¬ne the Fourier transform, F and the inverse
Fourier transform, F âˆ’1 by
FÏˆ(t) â‰¡(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xÏˆ(x)dx,

19.2.
FOURIER TRANSFORMS OF FUNCTIONS IN G
519
F âˆ’1Ïˆ(t) â‰¡(2Ï€)âˆ’n/2
Z
Rn eitÂ·xÏˆ(x)dx.
where t Â· x â‰¡Pn
i=1 tixi.Note there is no problem with this deï¬nition because Ïˆ is in
L1 (Rn) and therefore,
Â¯Â¯eitÂ·xÏˆ(x)
Â¯Â¯ â‰¤|Ïˆ(x)| ,
an integrable function.
One reason for using the functions, G is that it is very easy to compute the
Fourier transform of these functions. The ï¬rst thing to do is to verify F and F âˆ’1
map G to G and that F âˆ’1 â—¦F (Ïˆ) = Ïˆ.
Lemma 19.7 The following formulas are true
Z
R
eâˆ’c(x+it)2dx =
Z
R
eâˆ’c(xâˆ’it)2dx =
âˆšÏ€
âˆšc ,
(19.1)
Z
Rn eâˆ’c(x+it)Â·(x+it)dx =
Z
Rn eâˆ’c(xâˆ’it)Â·(xâˆ’it)dx =
ÂµâˆšÏ€
âˆšc
Â¶n
,
(19.2)
Z
R
eâˆ’ct2eâˆ’istdt =
Z
R
eâˆ’ct2eistdt = eâˆ’s2
4c
âˆšÏ€
âˆšc ,
(19.3)
Z
Rn eâˆ’c|t|2eâˆ’isÂ·tdt =
Z
Rn eâˆ’c|t|2eisÂ·tdt = eâˆ’|s|2
4c
ÂµâˆšÏ€
âˆšc
Â¶n
.
(19.4)
Proof: Consider the ï¬rst one. Simple manipulations yield
H (t) â‰¡
Z
R
eâˆ’c(x+it)2dx = ect2 Z
R
eâˆ’cx2 cos (2cxt) dx.
Now using the dominated convergence theorem to justify passing derivatives inside
the integral where necessary and using integration by parts,
Hâ€² (t)
=
2ctect2 Z
R
eâˆ’cx2 cos (2cxt) dx âˆ’ect2 Z
R
eâˆ’cx2 sin (2cxt) 2xcdx
=
2ctH (t) âˆ’ect22ct
Z
R
eâˆ’cx2 cos (2cxt) dx = 2ct (H (t) âˆ’H (t)) = 0
and so H (t) = H (0) =
R
R eâˆ’cx2dx â‰¡I. Thus
I2 =
Z
R2 eâˆ’c(x2+y2)dxdy =
Z âˆž
0
Z 2Ï€
0
eâˆ’cr2rdÎ¸dr = Ï€
c .
Therefore, I = âˆšÏ€/âˆšc. Since the sign of t is unimportant, this proves 19.1. This
also proves 19.2 after writing as iterated integrals.

520
FOURIER TRANSFORMS
Consider 19.3.
Z
R
eâˆ’ct2eistdt
=
Z
R
e
âˆ’c
Â³
t2âˆ’ist
c +( is
2c)
2Â´
eâˆ’s2
4c dt
=
eâˆ’s2
4c
Z
R
eâˆ’c(tâˆ’is
2c)
2
dt = eâˆ’s2
4c
âˆšÏ€
âˆšc .
Changing the variable t â†’âˆ’t gives the other part of 19.3.
Finally 19.4 follows from using iterated integrals.
With these formulas, it is easy to verify F, F âˆ’1 map G to G and F â—¦F âˆ’1 =
F âˆ’1 â—¦F = id.
Theorem 19.8 Each of F and F âˆ’1 map G to G.
Also F âˆ’1 â—¦F (Ïˆ) = Ïˆ and
F â—¦F âˆ’1 (Ïˆ) = Ïˆ.
Proof: The ï¬rst claim will be shown if it is shown that FÏˆ âˆˆG for Ïˆ (x) =
xÎ±eâˆ’b|x|2 because an arbitrary function of G is a ï¬nite sum of scalar multiples of
functions such as Ïˆ. Using Lemma 19.7,
FÏˆ (t)
â‰¡
Âµ 1
2Ï€
Â¶n/2 Z
Rn eâˆ’itÂ·xxÎ±eâˆ’b|x|2dx
=
Âµ 1
2Ï€
Â¶n/2
(i)âˆ’|Î±| DÎ±
t
ÂµZ
Rn eâˆ’itÂ·xeâˆ’b|x|2dx
Â¶
=
Âµ 1
2Ï€
Â¶n/2
(i)âˆ’|Î±| DÎ±
t
Âµ
eâˆ’|t|2
2b
ÂµâˆšÏ€
âˆš
b
Â¶nÂ¶
and this is clearly in G because it equals a polynomial times eâˆ’|t|2
2b . It remains
to verify the other assertion. As in the ï¬rst case, it suï¬ƒces to consider Ïˆ (x) =
xÎ±eâˆ’b|x|2. Using Lemma 19.7 and ordinary integration by parts on the iterated
integrals,
R
Rn eâˆ’c|t|2eisÂ·tdt = eâˆ’|s|2
2c
Â³ âˆšÏ€
âˆšc
Â´n
,
F âˆ’1 â—¦F (Ïˆ) (s)
â‰¡
Âµ 1
2Ï€
Â¶n/2 Z
Rn eisÂ·t
Âµ 1
2Ï€
Â¶n/2 Z
Rn eâˆ’itÂ·xxÎ±eâˆ’b|x|2dxdt
=
Âµ 1
2Ï€
Â¶n Z
Rn eisÂ·t (âˆ’i)âˆ’|Î±| DÎ±
t
ÂµZ
Rn eâˆ’itÂ·xeâˆ’b|x|2dxdt
Â¶
=
Âµ 1
2Ï€
Â¶n/2 Z
Rn eisÂ·t
Âµ 1
2Ï€
Â¶n/2
(âˆ’i)âˆ’|Î±| DÎ±
t
Âµ
eâˆ’|t|2
4b
ÂµâˆšÏ€
âˆš
b
Â¶nÂ¶
dt

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
521
=
Âµ 1
2Ï€
Â¶n ÂµâˆšÏ€
âˆš
b
Â¶n
(âˆ’i)âˆ’|Î±|
Z
Rn eisÂ·tDÎ±
t
Âµ
eâˆ’|t|2
4b
Â¶
dt
=
Âµ 1
2Ï€
Â¶n ÂµâˆšÏ€
âˆš
b
Â¶n
(âˆ’i)âˆ’|Î±| (âˆ’1)|Î±| sÎ± (i)|Î±|
Z
Rn eisÂ·teâˆ’|t|2
4b dt
=
Âµ 1
2Ï€
Â¶n ÂµâˆšÏ€
âˆš
b
Â¶n
sÎ±
Z
Rn eisÂ·teâˆ’|t|2
4b dt
=
Âµ 1
2Ï€
Â¶n ÂµâˆšÏ€
âˆš
b
Â¶n
sÎ±eâˆ’
|s|2
4(1/(4b))
Ãƒ
âˆšÏ€
p
1/ (4b)
!n
=
Âµ 1
2Ï€
Â¶n ÂµâˆšÏ€
âˆš
b
Â¶n
sÎ±eâˆ’b|s|2 Â³âˆšÏ€2
âˆš
b
Â´n
= sÎ±eâˆ’b|s|2 = Ïˆ (s) .
This little computation proves the theorem. The other case is entirely similar.
19.3
Fourier Transforms Of Just About Anything
Deï¬nition 19.9 Let Gâˆ—denote the vector space of linear functions deï¬ned on G
which have values in C. Thus T âˆˆGâˆ—means T : G â†’C and T is linear,
T (aÏˆ + bÏ†) = aT (Ïˆ) + bT (Ï†) for all a, b âˆˆC,
Ïˆ, Ï† âˆˆG
Let Ïˆ âˆˆG. Then deï¬ne TÏˆ âˆˆGâˆ—by
TÏˆ (Ï†) â‰¡
Z
Rn Ïˆ (x) Ï† (x) dx
Lemma 19.10 The following is obtained for all Ï†, Ïˆ âˆˆG.
TF Ïˆ (Ï†) = TÏˆ (FÏ†) , TF âˆ’1Ïˆ (Ï†) = TÏˆ
Â¡
F âˆ’1Ï†
Â¢
Also if Ïˆ âˆˆG and TÏˆ = 0, then Ïˆ = 0.
Proof:
TF Ïˆ (Ï†)
â‰¡
Z
Rn FÏˆ (t) Ï† (t) dt
=
Z
Rn
Âµ 1
2Ï€
Â¶n/2 Z
Rn eâˆ’itÂ·xÏˆ(x)dxÏ† (t) dt
=
Z
Rn Ïˆ(x)
Âµ 1
2Ï€
Â¶n/2 Z
Rn eâˆ’itÂ·xÏ† (t) dtdx
=
Z
Rn Ïˆ(x)FÏ† (x) dx â‰¡TÏˆ (FÏ†)
The other claim is similar.

522
FOURIER TRANSFORMS
Suppose now TÏˆ = 0. Then
Z
Rn ÏˆÏ†dx = 0
for all Ï† âˆˆG. Therefore, this is true for Ï† = Ïˆ and so Ïˆ = 0. This proves the lemma.
From now on regard G âŠ†Gâˆ—and for Ïˆ âˆˆG write Ïˆ (Ï†) instead of TÏˆ (Ï†) . It was
just shown that with this interpretation1,
FÏˆ (Ï†) = Ïˆ (F (Ï†)) , F âˆ’1Ïˆ (Ï†) = Ïˆ
Â¡
F âˆ’1Ï†
Â¢
.
This lemma suggests a way to deï¬ne the Fourier transform of something in Gâˆ—.
Deï¬nition 19.11 For T âˆˆGâˆ—, deï¬ne FT, F âˆ’1T âˆˆGâˆ—by
FT (Ï†) â‰¡T (FÏ†) , F âˆ’1T (Ï†) â‰¡T
Â¡
F âˆ’1Ï†
Â¢
Lemma 19.12 F and F âˆ’1 are both one to one, onto, and are inverses of each
other.
Proof: First note F and F âˆ’1 are both linear. This follows directly from the
deï¬nition. Suppose now FT = 0. Then FT (Ï†) = T (FÏ†) = 0 for all Ï† âˆˆG. But F
and F âˆ’1 map G onto G because if Ïˆ âˆˆG, then Ïˆ = F
Â¡
F âˆ’1 (Ïˆ)
Â¢
. Therefore, T = 0
and so F is one to one. Similarly F âˆ’1 is one to one. Now
F âˆ’1 (FT) (Ï†) â‰¡(FT)
Â¡
F âˆ’1Ï†
Â¢
â‰¡T
Â¡
F
Â¡
F âˆ’1 (Ï†)
Â¢Â¢
= TÏ†.
Therefore, F âˆ’1 â—¦F (T) = T. Similarly, F â—¦F âˆ’1 (T) = T. Thus both F and F âˆ’1 are
one to one and onto and are inverses of each other as suggested by the notation.
This proves the lemma.
Probably the most interesting things in Gâˆ—are functions of various kinds. The
following lemma has to do with this situation.
Lemma 19.13 If f âˆˆL1
loc (Rn) and
R
Rn fÏ†dx = 0 for all Ï† âˆˆCc (Rn), then f =
0 a.e.
Proof: First suppose f â‰¥0. Let
E â‰¡{x :f (x) â‰¥r}, ER â‰¡E âˆ©B (0,R).
Let Km be an increasing sequence of compact sets and let Vm be a decreasing
sequence of open sets satisfying
Km âŠ†ER âŠ†Vm, mn (Vm) â‰¤mn (Km) + 2âˆ’m, V1 âŠ†B (0,R) .
1This is not all that diï¬€erent from what was done with the derivative. Remember when you
consider the derivative of a function of one variable, in elementary courses you think of it as a
number but thinking of it as a linear transformation acting on R is better because this leads to
the concept of a derivative which generalizes to functions of many variables. So it is here. You
can think of Ïˆ âˆˆG as simply an element of G but it is better to think of it as an element of Gâˆ—as
just described.

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
523
Therefore,
mn (Vm \ Km) â‰¤2âˆ’m.
Let
Ï†m âˆˆCc (Vm) , Km â‰ºÏ†m â‰ºVm.
Then Ï†m (x) â†’XER (x) a.e. because the set where Ï†m (x) fails to converge to this
set is contained in the set of all x which are in inï¬nitely many of the sets Vm \ Km.
This set has measure zero because
âˆž
X
m=1
mn (Vm \ Km) < âˆž
and so, by the dominated convergence theorem,
0 = lim
mâ†’âˆž
Z
Rn fÏ†mdx = lim
mâ†’âˆž
Z
V1
fÏ†mdx =
Z
ER
fdx â‰¥rm (ER).
Thus, mn (ER) = 0 and therefore mn (E) = limRâ†’âˆžmn (ER) = 0. Since r > 0 is
arbitrary, it follows
mn ([f > 0]) = âˆªâˆž
k=1mn
Â¡Â£
f > kâˆ’1Â¤Â¢
= 0.
Now suppose f has values in R. Let E+ = [f â‰¥0] and Eâˆ’= [f < 0] . Thus
these are two measurable sets. As in the ï¬rst part, let Km and Vm be sequences
of compact and open sets such that Km âŠ†E+ âˆ©B (0, R) âŠ†Vm âŠ†B (0, R) and let
Km â‰ºÏ†m â‰ºVm with mn (Vm \ Km) < 2âˆ’m. Thus Ï†m âˆˆCc (Rn) and the sequence
converges pointwise to XE+âˆ©B(0,R). Then by the dominated convergence theorem,
if Ïˆ is any function in Cc (Rn)
0 =
Z
fÏ†mÏˆdmn â†’
Z
fÏˆXE+âˆ©B(0,R)dmn.
Hence, letting R â†’âˆž,
Z
fÏˆXE+dmn =
Z
f+Ïˆdmn = 0
Since Ïˆ is arbitrary, the ï¬rst part of the argument applies to f+ and implies f+ = 0.
Similarly fâˆ’= 0. Finally, if f is complcx valued, the assumptions mean
Z
Re (f) Ï†dmn = 0,
Z
Im (f) Ï†dmn = 0
for all Ï† âˆˆCc (Rn) and so both Re (f) , Im (f) equal zero a.e.
This proves the
lemma.
Corollary 19.14 Let f âˆˆL1 (Rn) and suppose
Z
Rn f (x) Ï† (x) dx = 0
for all Ï† âˆˆG. Then f = 0 a.e.

524
FOURIER TRANSFORMS
Proof: Let Ïˆ âˆˆCc (Rn) . Then by the Stone Weierstrass approximation theo-
rem, there exists a sequence of functions, {Ï†k} âŠ†G such that Ï†k â†’Ïˆ uniformly.
Then by the dominated convergence theorem,
Z
fÏˆdx = lim
kâ†’âˆž
Z
fÏ†kdx = 0.
By Lemma 19.13 f = 0.
The next theorem is the main result of this sort.
Theorem 19.15 Let f âˆˆLp (Rn) , p â‰¥1, or suppose f is measurable and has
polynomial growth,
|f (x)| â‰¤K
Â³
1 + |x|2Â´m
for some m âˆˆN. Then if
Z
fÏˆdx = 0
for all Ïˆ âˆˆG then it follows f = 0.
Proof: The case where f âˆˆL1 (Rn) was dealt with in Corollary 19.14. Suppose
f âˆˆLp (Rn) for p > 1. Then by Holderâ€™s inequality and the density of G in Lpâ€² (Rn) ,
it follows that
R
fgdx = 0 for all g âˆˆLpâ€² (Rn) . By the Riesz representation theorem,
f = 0.
It remains to consider the case where f has polynomial growth.
Thus x â†’
f (x) eâˆ’|x|2 âˆˆL1 (Rn) . Therefore, for all Ïˆ âˆˆG,
0 =
Z
f (x) eâˆ’|x|2Ïˆ (x) dx
because eâˆ’|x|2Ïˆ (x) âˆˆG. Therefore, by the ï¬rst part, f (x) eâˆ’|x|2 = 0 a.e.
The following theorem shows that you can consider most functions you are likely
to encounter as elements of Gâˆ—.
Theorem 19.16 Let f be a measurable function with polynomial growth,
|f (x)| â‰¤C
Â³
1 + |x|2Â´N
for some N,
or let f âˆˆLp (Rn) for some p âˆˆ[1, âˆž]. Then f âˆˆGâˆ—if
f (Ï†) â‰¡
Z
fÏ†dx.
Proof: Let f have polynomial growth ï¬rst. Then the above integral is clearly
well deï¬ned and so in this case, f âˆˆGâˆ—.
Next suppose f âˆˆLp (Rn) with âˆž> p â‰¥1. Then it is clear again that the
above integral is well deï¬ned because of the fact that Ï† is a sum of polynomials

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
525
times exponentials of the form eâˆ’c|x|2 and these are in Lpâ€² (Rn). Also Ï† â†’f (Ï†) is
clearly linear in both cases. This proves the theorem.
This has shown that for nearly any reasonable function, you can deï¬ne its Fourier
transform as described above. Also you should note that Gâˆ—includes C0 (Rn)â€² , the
space of complex measures whose total variation are Radon measures. It is especially
interesting when the Fourier transform yields another function of some sort.
19.3.1
Fourier Transforms Of Functions In L1 (Rn)
First suppose f âˆˆL1 (Rn) .
Theorem 19.17 Let f âˆˆL1 (Rn) . Then Ff (Ï†) =
R
Rn gÏ†dt where
g (t) =
Âµ 1
2Ï€
Â¶n/2 Z
Rn eâˆ’itÂ·xf (x) dx
and F âˆ’1f (Ï†) =
R
Rn gÏ†dt where g (t) =
Â¡ 1
2Ï€
Â¢n/2 R
Rn eitÂ·xf (x) dx. In short,
Ff(t) â‰¡(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xf(x)dx,
F âˆ’1f(t) â‰¡(2Ï€)âˆ’n/2
Z
Rn eitÂ·xf(x)dx.
Proof: From the deï¬nition and Fubiniâ€™s theorem,
Ff (Ï†)
â‰¡
Z
Rn f (t) FÏ† (t) dt =
Z
Rn f (t)
Âµ 1
2Ï€
Â¶n/2 Z
Rn eâˆ’itÂ·xÏ† (x) dxdt
=
Z
Rn
ÃƒÂµ 1
2Ï€
Â¶n/2 Z
Rn f (t) eâˆ’itÂ·xdt
!
Ï† (x) dx.
Since Ï† âˆˆG is arbitrary, it follows from Theorem 19.15 that Ff (x) is given by the
claimed formula. The case of F âˆ’1 is identical.
Here are interesting properties of these Fourier transforms of functions in L1.
Theorem 19.18 If f âˆˆL1 (Rn) and ||fk âˆ’f||1 â†’0, then Ffk and F âˆ’1fk converge
uniformly to Ff and F âˆ’1f respectively. If f âˆˆL1 (Rn), then F âˆ’1f and Ff are
both continuous and bounded. Also,
lim
|x|â†’âˆžF âˆ’1f(x) =
lim
|x|â†’âˆžFf(x) = 0.
(19.5)
Furthermore, for f âˆˆL1 (Rn) both Ff and F âˆ’1f are uniformly continuous.

526
FOURIER TRANSFORMS
Proof: The ï¬rst claim follows from the following inequality.
|Ffk (t) âˆ’Ff (t)|
â‰¤
(2Ï€)âˆ’n/2
Z
Rn
Â¯Â¯eâˆ’itÂ·xfk(x) âˆ’eâˆ’itÂ·xf(x)
Â¯Â¯ dx
=
(2Ï€)âˆ’n/2
Z
Rn |fk (x) âˆ’f (x)| dx
=
(2Ï€)âˆ’n/2 ||f âˆ’fk||1 .
which a similar argument holding for F âˆ’1.
Now consider the second claim of the theorem.
|Ff (t) âˆ’Ff (tâ€²)| â‰¤(2Ï€)âˆ’n/2
Z
Rn
Â¯Â¯Â¯eâˆ’itÂ·x âˆ’eâˆ’itâ€²Â·xÂ¯Â¯Â¯ |f(x)| dx
The integrand is bounded by 2 |f (x)|, a function in L1 (Rn) and converges to 0 as
tâ€² â†’t and so the dominated convergence theorem implies Ff is continuous. To see
Ff (t) is uniformly bounded,
|Ff (t)| â‰¤(2Ï€)âˆ’n/2
Z
Rn |f(x)| dx < âˆž.
A similar argument gives the same conclusions for F âˆ’1.
It remains to verify 19.5 and the claim that Ff and F âˆ’1f are uniformly contin-
uous.
|Ff (t)| â‰¤
Â¯Â¯Â¯Â¯(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xf(x)dx
Â¯Â¯Â¯Â¯
Now let Îµ > 0 be given and let g âˆˆCâˆž
c (Rn) such that (2Ï€)âˆ’n/2 ||g âˆ’f||1 < Îµ/2.
Then
|Ff (t)|
â‰¤
(2Ï€)âˆ’n/2
Z
Rn |f(x) âˆ’g (x)| dx
+
Â¯Â¯Â¯Â¯(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xg(x)dx
Â¯Â¯Â¯Â¯
â‰¤
Îµ/2 +
Â¯Â¯Â¯Â¯(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xg(x)dx
Â¯Â¯Â¯Â¯ .
Now integrating by parts, it follows that for ||t||âˆžâ‰¡max {|tj| : j = 1, Â· Â· Â·, n} > 0
|Ff (t)| â‰¤Îµ/2 + (2Ï€)âˆ’n/2
Â¯Â¯Â¯Â¯Â¯Â¯
1
||t||âˆž
Z
Rn
n
X
j=1
Â¯Â¯Â¯Â¯
âˆ‚g (x)
âˆ‚xj
Â¯Â¯Â¯Â¯ dx
Â¯Â¯Â¯Â¯Â¯Â¯
(19.6)
and this last expression converges to zero as ||t||âˆžâ†’âˆž. The reason for this is that
if tj Ì¸= 0, integration by parts with respect to xj gives
(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xg(x)dx = (2Ï€)âˆ’n/2
1
âˆ’itj
Z
Rn eâˆ’itÂ·x âˆ‚g (x)
âˆ‚xj
dx.

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
527
Therefore, choose the j for which ||t||âˆž= |tj| and the result of 19.6 holds. There-
fore, from 19.6, if ||t||âˆžis large enough, |Ff (t)| < Îµ. Similarly, lim||t||â†’âˆžF âˆ’1 (t) =
0. Consider the claim about uniform continuity. Let Îµ > 0 be given. Then there
exists R such that if ||t||âˆž> R, then |Ff (t)| < Îµ
2. Since Ff is continuous, it is
uniformly continuous on the compact set, [âˆ’R âˆ’1, R + 1]n. Therefore, there exists
Î´1 such that if ||t âˆ’tâ€²||âˆž< Î´1 for tâ€², t âˆˆ[âˆ’R âˆ’1, R + 1]n, then
|Ff (t) âˆ’Ff (tâ€²)| < Îµ/2.
(19.7)
Now let 0 < Î´ < min (Î´1, 1) and suppose ||t âˆ’tâ€²||âˆž< Î´. If both t, tâ€² are contained
in [âˆ’R, R]n, then 19.7 holds. If t âˆˆ[âˆ’R, R]n and tâ€² /âˆˆ[âˆ’R, R]n, then both are
contained in [âˆ’R âˆ’1, R + 1]n and so this veriï¬es 19.7 in this case. The other case
is that neither point is in [âˆ’R, R]n and in this case,
|Ff (t) âˆ’Ff (tâ€²)|
â‰¤
|Ff (t)| + |Ff (tâ€²)|
<
Îµ
2 + Îµ
2 = Îµ.
This proves the theorem.
There is a very interesting relation between the Fourier transform and convolu-
tions.
Theorem 19.19 Let f, g âˆˆL1(Rn). Then fâˆ—g âˆˆL1 and F(fâˆ—g) = (2Ï€)n/2 FfFg.
Proof: Consider
Z
Rn
Z
Rn |f (x âˆ’y) g (y)| dydx.
The function, (x, y) â†’|f (x âˆ’y) g (y)| is Lebesgue measurable and so by Fubiniâ€™s
theorem,
Z
Rn
Z
Rn |f (x âˆ’y) g (y)| dydx
=
Z
Rn
Z
Rn |f (x âˆ’y) g (y)| dxdy
=
||f||1 ||g||1 < âˆž.
It follows that for a.e. x,
R
Rn |f (x âˆ’y) g (y)| dy < âˆžand for each of these values
of x, it follows that
R
Rn f (x âˆ’y) g (y) dy exists and equals a function of x which is
in L1 (Rn) , f âˆ—g (x). Now
F(f âˆ—g) (t)
â‰¡
(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xf âˆ—g (x) dx
=
(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·x
Z
Rn f (x âˆ’y) g (y) dydx
=
(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·yg (y)
Z
Rn eâˆ’itÂ·(xâˆ’y)f (x âˆ’y) dxdy
=
(2Ï€)n/2 Ff (t) Fg (t) .
There are many other considerations involving Fourier transforms of functions
in L1 (Rn).

528
FOURIER TRANSFORMS
19.3.2
Fourier Transforms Of Functions In L2 (Rn)
Consider Ff and F âˆ’1f for f âˆˆL2(Rn). First note that the formula given for Ff
and F âˆ’1f when f âˆˆL1 (Rn) will not work for f âˆˆL2(Rn) unless f is also in L1(Rn).
Recall that a + ib = a âˆ’ib.
Theorem 19.20 For Ï† âˆˆG, ||FÏ†||2 = ||F âˆ’1Ï†||2 = ||Ï†||2.
Proof: First note that for Ïˆ âˆˆG,
F(Ïˆ) = F âˆ’1(Ïˆ) , F âˆ’1(Ïˆ) = F(Ïˆ).
(19.8)
This follows from the deï¬nition. For example,
FÏˆ (t)
=
(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xÏˆ (x) dx
=
(2Ï€)âˆ’n/2
Z
Rn eitÂ·xÏˆ (x) dx
Let Ï†, Ïˆ âˆˆG. It was shown above that
Z
Rn(FÏ†)Ïˆ(t)dt =
Z
Rn Ï†(FÏˆ)dx.
Similarly,
Z
Rn Ï†(F âˆ’1Ïˆ)dx =
Z
Rn(F âˆ’1Ï†)Ïˆdt.
(19.9)
Now, 19.8 - 19.9 imply
Z
Rn |Ï†|2dx
=
Z
Rn Ï†F âˆ’1(FÏ†)dx
=
Z
Rn Ï†F(FÏ†)dx
=
Z
Rn FÏ†(FÏ†)dx
=
Z
Rn |FÏ†|2dx.
Similarly
||Ï†||2 = ||F âˆ’1Ï†||2.
This proves the theorem.
Lemma 19.21 Let f âˆˆL2 (Rn) and let Ï†k â†’f in L2 (Rn) where Ï†k âˆˆG. (Such
a sequence exists because of density of G in L2 (Rn).) Then Ff and F âˆ’1f are both
in L2 (Rn) and the following limits take place in L2.
lim
kâ†’âˆžF (Ï†k) = F (f) , lim
kâ†’âˆžF âˆ’1 (Ï†k) = F âˆ’1 (f) .

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
529
Proof: Let Ïˆ âˆˆG be given. Then
Ff (Ïˆ)
â‰¡
f (FÏˆ) â‰¡
Z
Rn f (x) FÏˆ (x) dx
=
lim
kâ†’âˆž
Z
Rn Ï†k (x) FÏˆ (x) dx = lim
kâ†’âˆž
Z
Rn FÏ†k (x) Ïˆ (x) dx.
Also by Theorem 19.20 {FÏ†k}âˆž
k=1 is Cauchy in L2 (Rn) and so it converges to some
h âˆˆL2 (Rn). Therefore, from the above,
Ff (Ïˆ) =
Z
Rn h (x) Ïˆ (x)
which shows that F (f) âˆˆL2 (Rn) and h = F (f) . The case of F âˆ’1 is entirely
similar. This proves the lemma.
Since Ff and F âˆ’1f are in L2 (Rn) , this also proves the following theorem.
Theorem 19.22 If f âˆˆL2(Rn), Ff and F âˆ’1f are the unique elements of L2 (Rn)
such that for all Ï† âˆˆG,
Z
Rn Ff(x)Ï†(x)dx =
Z
Rn f(x)FÏ†(x)dx,
(19.10)
Z
Rn F âˆ’1f(x)Ï†(x)dx =
Z
Rn f(x)F âˆ’1Ï†(x)dx.
(19.11)
Theorem 19.23 (Plancherel)
||f||2 = ||Ff||2 = ||F âˆ’1f||2.
(19.12)
Proof: Use the density of G in L2 (Rn) to obtain a sequence, {Ï†k} converging
to f in L2 (Rn). Then by Lemma 19.21
||Ff||2 = lim
kâ†’âˆž||FÏ†k||2 = lim
kâ†’âˆž||Ï†k||2 = ||f||2 .
Similarly,
||f||2 = ||F âˆ’1f||2.
This proves the theorem.
The following corollary is a simple generalization of this. To prove this corollary,
use the following simple lemma which comes as a consequence of the Cauchy Schwarz
inequality.
Lemma 19.24 Suppose fk â†’f in L2 (Rn) and gk â†’g in L2 (Rn). Then
lim
kâ†’âˆž
Z
Rn fkgkdx =
Z
Rn fgdx

530
FOURIER TRANSFORMS
Proof:
Â¯Â¯Â¯Â¯
Z
Rn fkgkdx âˆ’
Z
Rn fgdx
Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯
Z
Rn fkgkdx âˆ’
Z
Rn fkgdx
Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯
Z
Rn fkgdx âˆ’
Z
Rn fgdx
Â¯Â¯Â¯Â¯
â‰¤||fk||2 ||g âˆ’gk||2 + ||g||2 ||fk âˆ’f||2 .
Now ||fk||2 is a Cauchy sequence and so it is bounded independent of k. Therefore,
the above expression is smaller than Îµ whenever k is large enough. This proves the
lemma.
Corollary 19.25 For f, g âˆˆL2(Rn),
Z
Rn fgdx =
Z
Rn Ff Fgdx =
Z
Rn F âˆ’1f F âˆ’1gdx.
Proof: First note the above formula is obvious if f, g âˆˆG. To see this, note
Z
Rn Ff Fgdx
=
Z
Rn Ff (x)
1
(2Ï€)n/2
Z
Rn eâˆ’ixÂ·tg (t) dtdx
=
Z
Rn
1
(2Ï€)n/2
Z
Rn eixÂ·tFf (x) dxg (t)dt
=
Z
Rn
Â¡
F âˆ’1 â—¦F
Â¢
f (t) g (t)dt
=
Z
Rn f (t) g (t)dt.
The formula with F âˆ’1 is exactly similar.
Now to verify the corollary, let Ï†k â†’f in L2 (Rn) and let Ïˆk â†’g in L2 (Rn).
Then by Lemma 19.21
Z
Rn Ff Fgdx
=
lim
kâ†’âˆž
Z
Rn FÏ†k FÏˆkdx
=
lim
kâ†’âˆž
Z
Rn Ï†kÏˆkdx
=
Z
Rn fgdx
A similar argument holds for F âˆ’1.This proves the corollary.
How does one compute Ff and F âˆ’1f ?
Theorem 19.26 For f âˆˆL2(Rn), let fr = fXEr where Er is a bounded measurable
set with Er â†‘Rn. Then the following limits hold in L2 (Rn) .
Ff = lim
râ†’âˆžFfr , F âˆ’1f = lim
râ†’âˆžF âˆ’1fr.

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
531
Proof: ||f âˆ’fr||2 â†’0 and so ||Ff âˆ’Ffr||2 â†’0 and ||F âˆ’1f âˆ’F âˆ’1fr||2 â†’0 by
Plancherelâ€™s Theorem. This proves the theorem.
What are Ffr and F âˆ’1fr? Let Ï† âˆˆG
Z
Rn FfrÏ†dx
=
Z
Rn frFÏ†dx
=
(2Ï€)âˆ’n
2
Z
Rn
Z
Rn fr(x)eâˆ’ixÂ·yÏ†(y)dydx
=
Z
Rn[(2Ï€)âˆ’n
2
Z
Rn fr(x)eâˆ’ixÂ·ydx]Ï†(y)dy.
Since this holds for all Ï† âˆˆG, a dense subset of L2(Rn), it follows that
Ffr(y) = (2Ï€)âˆ’n
2
Z
Rn fr(x)eâˆ’ixÂ·ydx.
Similarly
F âˆ’1fr(y) = (2Ï€)âˆ’n
2
Z
Rn fr(x)eixÂ·ydx.
This shows that to take the Fourier transform of a function in L2 (Rn), it suï¬ƒces
to take the limit as r â†’âˆžin L2 (Rn) of (2Ï€)âˆ’n
2 R
Rn fr(x)eâˆ’ixÂ·ydx.
A similar
procedure works for the inverse Fourier transform.
Note this reduces to the earlier deï¬nition in case f âˆˆL1 (Rn). Now consider the
convolution of a function in L2 with one in L1.
Theorem 19.27 Let h âˆˆL2 (Rn) and let f âˆˆL1 (Rn). Then h âˆ—f âˆˆL2 (Rn),
F âˆ’1 (h âˆ—f) = (2Ï€)n/2 F âˆ’1hF âˆ’1f,
F (h âˆ—f) = (2Ï€)n/2 FhFf,
and
||h âˆ—f||2 â‰¤||h||2 ||f||1 .
(19.13)
Proof: An application of Minkowskiâ€™s inequality yields
ÃƒZ
Rn
ÂµZ
Rn |h (x âˆ’y)| |f (y)| dy
Â¶2
dx
!1/2
â‰¤||f||1 ||h||2 .
(19.14)
Hence
R
|h (x âˆ’y)| |f (y)| dy < âˆža.e. x and
x â†’
Z
h (x âˆ’y) f (y) dy
is in L2 (Rn). Let Er â†‘Rn, m (Er) < âˆž. Thus,
hr â‰¡XErh âˆˆL2 (Rn) âˆ©L1 (Rn),

532
FOURIER TRANSFORMS
and letting Ï† âˆˆG,
Z
F (hr âˆ—f) (Ï†) dx
â‰¡
Z
(hr âˆ—f) (FÏ†) dx
=
(2Ï€)âˆ’n/2
Z Z Z
hr (x âˆ’y) f (y) eâˆ’ixÂ·tÏ† (t) dtdydx
=
(2Ï€)âˆ’n/2
Z Z ÂµZ
hr (x âˆ’y) eâˆ’i(xâˆ’y)Â·tdx
Â¶
f (y) eâˆ’iyÂ·tdyÏ† (t) dt
=
Z
(2Ï€)n/2 Fhr (t) Ff (t) Ï† (t) dt.
Since Ï† is arbitrary and G is dense in L2 (Rn),
F (hr âˆ—f) = (2Ï€)n/2 FhrFf.
Now by Minkowskiâ€™s Inequality, hr âˆ—f â†’h âˆ—f in L2 (Rn) and also it is clear that
hr â†’h in L2 (Rn) ; so, by Plancherelâ€™s theorem, you may take the limit in the above
and conclude
F (h âˆ—f) = (2Ï€)n/2 FhFf.
The assertion for F âˆ’1 is similar and 19.13 follows from 19.14.
19.3.3
The Schwartz Class
The problem with G is that it does not contain Câˆž
c (Rn). I have used it in presenting
the Fourier transform because the functions in G have a very speciï¬c form which
made some technical details work out easier than in any other approach I have
seen. The Schwartz class is a larger class of functions which does contain Câˆž
c (Rn)
and also has the same nice properties as G. The functions in the Schwartz class
are inï¬nitely diï¬€erentiable and they vanish very rapidly as |x| â†’âˆžalong with all
their partial derivatives. This is the description of these functions, not a speciï¬c
form involving polynomials times eâˆ’Î±|x|2. To describe this precisely requires some
notation.
Deï¬nition 19.28 f âˆˆS, the Schwartz class, if f âˆˆCâˆž(Rn) and for all positive
integers N,
ÏN(f) < âˆž
where
ÏN(f) = sup{(1 + |x|2)N|DÎ±f(x)| : x âˆˆRn , |Î±| â‰¤N}.
Thus f âˆˆS if and only if f âˆˆCâˆž(Rn) and
sup{|xÎ²DÎ±f(x)| : x âˆˆRn} < âˆž
(19.15)
for all multi indices Î± and Î².

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
533
Also note that if f âˆˆS, then p(f) âˆˆS for any polynomial, p with p(0) = 0 and
that
S âŠ†Lp(Rn) âˆ©Lâˆž(Rn)
for any p â‰¥1. To see this assertion about the p (f), it suï¬ƒces to consider the case
of the product of two elements of the Schwartz class. If f, g âˆˆS, then DÎ± (fg) is
a ï¬nite sum of derivatives of f times derivatives of g. Therefore, ÏN (fg) < âˆžfor
all N. You may wonder about examples of things in S. Clearly any function in
Câˆž
c (Rn) is in S. However there are other functions in S. For example eâˆ’|x|2 is in
S as you can verify for yourself and so is any function from G. Note also that the
density of Cc (Rn) in Lp (Rn) shows that S is dense in Lp (Rn) for every p.
Recall the Fourier transform of a function in L1 (Rn) is given by
Ff(t) â‰¡(2Ï€)âˆ’n/2
Z
Rn eâˆ’itÂ·xf(x)dx.
Therefore, this gives the Fourier transform for f âˆˆS. The nice property which S
has in common with G is that the Fourier transform and its inverse map S one to
one onto S. This means I could have presented the whole of the above theory as
well as what follows in terms of S and its algebraic dual, Sâˆ—rather than in terms
of G and Gâˆ—. However, it is more technical. Nevertheless, letting S play the role
of G in the above is convenient in certain applications because it is easier to reduce
to S than G. I will make use of this simple observation whenever it will simplify a
presentation. The fundamental result which makes it possible is the following.
Theorem 19.29 If f âˆˆS, then Ff and F âˆ’1f are also in S.
Proof: To begin with, let Î± = ej = (0, 0, Â· Â· Â·, 1, 0, Â· Â· Â·, 0), the 1 in the jth slot.
F âˆ’1f(t + hej) âˆ’F âˆ’1f(t)
h
= (2Ï€)âˆ’n/2
Z
Rn eitÂ·xf(x)(eihxj âˆ’1
h
)dx.
(19.16)
Consider the integrand in 19.16.
Â¯Â¯Â¯Â¯eitÂ·xf(x)(eihxj âˆ’1
h
)
Â¯Â¯Â¯Â¯
=
|f (x)|
Â¯Â¯Â¯Â¯(ei(h/2)xj âˆ’eâˆ’i(h/2)xj
h
)
Â¯Â¯Â¯Â¯
=
|f (x)|
Â¯Â¯Â¯Â¯
i sin ((h/2) xj)
(h/2)
Â¯Â¯Â¯Â¯
â‰¤
|f (x)| |xj|
and this is a function in L1(Rn) because f âˆˆS.
Therefore by the Dominated
Convergence Theorem,
âˆ‚F âˆ’1f(t)
âˆ‚tj
=
(2Ï€)âˆ’n/2
Z
Rn eitÂ·xixjf(x)dx
=
i(2Ï€)âˆ’n/2
Z
Rn eitÂ·xxejf(x)dx.

534
FOURIER TRANSFORMS
Now xejf(x) âˆˆS and so one can continue in this way and take derivatives indeï¬-
nitely. Thus F âˆ’1f âˆˆCâˆž(Rn) and from the above argument,
DÎ±F âˆ’1f(t) =(2Ï€)âˆ’n/2
Z
Rn eitÂ·x(ix)Î±f(x)dx.
To complete showing F âˆ’1f âˆˆS,
tÎ²DÎ±F âˆ’1f(t) =(2Ï€)âˆ’n/2
Z
Rn eitÂ·xtÎ²(ix)af(x)dx.
Integrate this integral by parts to get
tÎ²DÎ±F âˆ’1f(t) =(2Ï€)âˆ’n/2
Z
Rn i|Î²|eitÂ·xDÎ²((ix)af(x))dx.
(19.17)
Here is how this is done.
Z
R
eitjxjt
Î²j
j (ix)Î±f(x)dxj
=
eitjxj
itj
t
Î²j
j (ix)Î±f(x) |âˆž
âˆ’âˆž+
i
Z
R
eitjxjt
Î²jâˆ’1
j
Dej((ix)Î±f(x))dxj
where the boundary term vanishes because f âˆˆS. Returning to 19.17, use the fact
that |eia| = 1 to conclude
|tÎ²DÎ±F âˆ’1f(t)| â‰¤C
Z
Rn |DÎ²((ix)af(x))|dx < âˆž.
It follows F âˆ’1f âˆˆS. Similarly Ff âˆˆS whenever f âˆˆS.
Theorem 19.30 Let Ïˆ âˆˆS. Then (F â—¦F âˆ’1)(Ïˆ) = Ïˆ and (F âˆ’1 â—¦F)(Ïˆ) = Ïˆ
whenever Ïˆ âˆˆS. Also F and F âˆ’1 map S one to one and onto S.
Proof: The ï¬rst claim follows from the fact that F and F âˆ’1 are inverses of each
other which was established above. For the second, let Ïˆ âˆˆS. Then Ïˆ = F
Â¡
F âˆ’1Ïˆ
Â¢
.
Thus F maps S onto S. If FÏˆ = 0, then do F âˆ’1 to both sides to conclude Ïˆ = 0.
Thus F is one to one and onto. Similarly, F âˆ’1 is one to one and onto.
Note the above equations involving F and F âˆ’1 hold pointwise everywhere be-
cause FÏˆ and F âˆ’1Ïˆ are continuous.
19.3.4
Convolution
To begin with it is necessary to discuss the meaning of Ï†f where f âˆˆGâˆ—and Ï† âˆˆG.
What should it mean? First suppose f âˆˆLp (Rn) or measurable with polynomial
growth.
Then Ï†f also has these properties.
Hence, it should be the case that
Ï†f (Ïˆ) =
R
Rn Ï†fÏˆdx =
R
Rn f (Ï†Ïˆ) dx. This motivates the following deï¬nition.

19.3.
FOURIER TRANSFORMS OF JUST ABOUT ANYTHING
535
Deï¬nition 19.31 Let T âˆˆGâˆ—and let Ï† âˆˆG. Then Ï†T â‰¡TÏ† âˆˆGâˆ—will be deï¬ned
by
Ï†T (Ïˆ) â‰¡T (Ï†Ïˆ) .
The next topic is that of convolution. It was just shown that
F (f âˆ—Ï†) = (2Ï€)n/2 FÏ†Ff, F âˆ’1 (f âˆ—Ï†) = (2Ï€)n/2 F âˆ’1Ï†F âˆ’1f
whenever f âˆˆL2 (Rn) and Ï† âˆˆG so the same deï¬nition is retained in the general
case because it makes perfect sense and agrees with the earlier deï¬nition.
Deï¬nition 19.32 Let f âˆˆGâˆ—and let Ï† âˆˆG. Then deï¬ne the convolution of f with
an element of G as follows.
f âˆ—Ï† â‰¡(2Ï€)n/2 F âˆ’1 (FÏ†Ff) âˆˆGâˆ—
There is an obvious question. With this deï¬nition, is it true that F âˆ’1 (f âˆ—Ï†) =
(2Ï€)n/2 F âˆ’1Ï†F âˆ’1f as it was earlier?
Theorem 19.33 Let f âˆˆGâˆ—and let Ï† âˆˆG.
F (f âˆ—Ï†) = (2Ï€)n/2 FÏ†Ff,
(19.18)
F âˆ’1 (f âˆ—Ï†) = (2Ï€)n/2 F âˆ’1Ï†F âˆ’1f.
(19.19)
Proof: Note that 19.18 follows from Deï¬nition 19.32 and both assertions hold
for f âˆˆG. Consider 19.19. Here is a simple formula involving a pair of functions in
G.
Â¡
Ïˆ âˆ—F âˆ’1F âˆ’1Ï†
Â¢
(x)
=
ÂµZ Z Z
Ïˆ (x âˆ’y) eiyÂ·y1eiy1Â·zÏ† (z) dzdy1dy
Â¶
(2Ï€)n
=
ÂµZ Z Z
Ïˆ (x âˆ’y) eâˆ’iyÂ·Ëœy1eâˆ’iËœy1Â·zÏ† (z) dzdËœy1dy
Â¶
(2Ï€)n
=
(Ïˆ âˆ—FFÏ†) (x) .
Now for Ïˆ âˆˆG,
(2Ï€)n/2 F
Â¡
F âˆ’1Ï†F âˆ’1f
Â¢
(Ïˆ) â‰¡(2Ï€)n/2 Â¡
F âˆ’1Ï†F âˆ’1f
Â¢
(FÏˆ) â‰¡
(2Ï€)n/2 F âˆ’1f
Â¡
F âˆ’1Ï†FÏˆ
Â¢
â‰¡(2Ï€)n/2 f
Â¡
F âˆ’1 Â¡
F âˆ’1Ï†FÏˆ
Â¢Â¢
=
f
Â³
(2Ï€)n/2 F âˆ’1 Â¡Â¡
FF âˆ’1F âˆ’1Ï†
Â¢
(FÏˆ)
Â¢Â´
â‰¡
f
Â¡
Ïˆ âˆ—F âˆ’1F âˆ’1Ï†
Â¢
= f (Ïˆ âˆ—FFÏ†)
(19.20)

536
FOURIER TRANSFORMS
Also
(2Ï€)n/2 F âˆ’1 (FÏ†Ff) (Ïˆ) â‰¡(2Ï€)n/2 (FÏ†Ff)
Â¡
F âˆ’1Ïˆ
Â¢
â‰¡
(2Ï€)n/2 Ff
Â¡
FÏ†F âˆ’1Ïˆ
Â¢
â‰¡(2Ï€)n/2 f
Â¡
F
Â¡
FÏ†F âˆ’1Ïˆ
Â¢Â¢
=
= f
Â³
F
Â³
(2Ï€)n/2 Â¡
FÏ†F âˆ’1Ïˆ
Â¢Â´Â´
= f
Â³
F
Â³
(2Ï€)n/2 Â¡
F âˆ’1FFÏ†F âˆ’1Ïˆ
Â¢Â´Â´
= f
Â¡
F
Â¡
F âˆ’1 (FFÏ† âˆ—Ïˆ)
Â¢Â¢
f (FFÏ† âˆ—Ïˆ) = f (Ïˆ âˆ—FFÏ†) .
(19.21)
The last line follows from the following.
Z
FFÏ† (x âˆ’y) Ïˆ (y) dy
=
Z
FÏ† (x âˆ’y) FÏˆ (y) dy
=
Z
FÏˆ (x âˆ’y) FÏ† (y) dy
=
Z
Ïˆ (x âˆ’y) FFÏ† (y) dy.
From 19.21 and 19.20 , since Ïˆ was arbitrary,
(2Ï€)n/2 F
Â¡
F âˆ’1Ï†F âˆ’1f
Â¢
= (2Ï€)n/2 F âˆ’1 (FÏ†Ff) â‰¡f âˆ—Ï†
which shows 19.19.
19.4
Exercises
1. For f âˆˆL1 (Rn), show that if F âˆ’1f âˆˆL1 or Ff âˆˆL1, then f equals a
continuous bounded function a.e.
2. Suppose f, g âˆˆL1(R) and Ff = Fg. Show f = g a.e.
3. Show that if f âˆˆL1 (Rn) , then lim|x|â†’âˆžFf (x) = 0.
4. â†‘Suppose f âˆ—f = f or f âˆ—f = 0 and f âˆˆL1(R). Show f = 0.
5. For this problem deï¬ne
R âˆž
a f (t) dt â‰¡limrâ†’âˆž
R r
a f (t) dt. Note this coincides
with the Lebesgue integral when f âˆˆL1 (a, âˆž). Show
(a)
R âˆž
0
sin(u)
u
du = Ï€
2
(b) limrâ†’âˆž
R âˆž
Î´
sin(ru)
u
du = 0 whenever Î´ > 0.
(c) If f âˆˆL1 (R), then limrâ†’âˆž
R
R sin (ru) f (u) du = 0.
Hint: For the ï¬rst two, use
1
u =
R âˆž
0
eâˆ’utdt and apply Fubiniâ€™s theorem to
R R
0 sin u
R
R eâˆ’utdtdu. For the last part, ï¬rst establish it for f âˆˆCâˆž
c (R) and
then use the density of this set in L1 (R) to obtain the result. This is sometimes
called the Riemann Lebesgue lemma.

19.4.
EXERCISES
537
6. â†‘Suppose that g âˆˆL1 (R) and that at some x > 0, g is locally Holder contin-
uous from the right and from the left. This means
lim
râ†’0+ g (x + r) â‰¡g (x+)
exists,
lim
râ†’0+ g (x âˆ’r) â‰¡g (xâˆ’)
exists and there exist constants K, Î´ > 0 and r âˆˆ(0, 1] such that for |x âˆ’y| <
Î´,
|g (x+) âˆ’g (y)| < K |x âˆ’y|r
for y > x and
|g (xâˆ’) âˆ’g (y)| < K |x âˆ’y|r
for y < x. Show that under these conditions,
lim
râ†’âˆž
2
Ï€
Z âˆž
0
sin (ur)
u
Âµg (x âˆ’u) + g (x + u)
2
Â¶
du
= g (x+) + g (xâˆ’)
2
.
7. â†‘Let g âˆˆL1 (R) and suppose g is locally Holder continuous from the right
and from the left at x. Show that then
lim
Râ†’âˆž
1
2Ï€
Z R
âˆ’R
eixt
Z âˆž
âˆ’âˆž
eâˆ’ityg (y) dydt = g (x+) + g (xâˆ’)
2
.
This is very interesting. If g âˆˆL2 (R), this shows F âˆ’1 (Fg) (x) = g(x+)+g(xâˆ’)
2
,
the midpoint of the jump in g at the point, x.
In particular, if g âˆˆG,
F âˆ’1 (Fg) = g. Hint: Show the left side of the above equation reduces to
2
Ï€
Z âˆž
0
sin (ur)
u
Âµg (x âˆ’u) + g (x + u)
2
Â¶
du
and then use Problem 6 to obtain the result.
8. â†‘A measurable function g deï¬ned on (0, âˆž) has exponential growth if |g (t)| â‰¤
CeÎ·t for some Î·. For Re (s) > Î·, deï¬ne the Laplace Transform by
Lg (s) â‰¡
Z âˆž
0
eâˆ’sug (u) du.
Assume that g has exponential growth as above and is Holder continuous from
the right and from the left at t. Pick Î³ > Î·.
Show that
lim
Râ†’âˆž
1
2Ï€
Z R
âˆ’R
eÎ³teiytLg (Î³ + iy) dy = g (t+) + g (tâˆ’)
2
.

538
FOURIER TRANSFORMS
This formula is sometimes written in the form
1
2Ï€i
Z Î³+iâˆž
Î³âˆ’iâˆž
estLg (s) ds
and is called the complex inversion integral for Laplace transforms. It can be
used to ï¬nd inverse Laplace transforms. Hint:
1
2Ï€
Z R
âˆ’R
eÎ³teiytLg (Î³ + iy) dy =
1
2Ï€
Z R
âˆ’R
eÎ³teiyt
Z âˆž
0
eâˆ’(Î³+iy)ug (u) dudy.
Now use Fubiniâ€™s theorem and do the integral from âˆ’R to R to get this equal
to
eÎ³t
Ï€
Z âˆž
âˆ’âˆž
eâˆ’Î³ug (u) sin (R (t âˆ’u))
t âˆ’u
du
where g is the zero extension of g oï¬€[0, âˆž). Then this equals
eÎ³t
Ï€
Z âˆž
âˆ’âˆž
eâˆ’Î³(tâˆ’u)g (t âˆ’u) sin (Ru)
u
du
which equals
2eÎ³t
Ï€
Z âˆž
0
g (t âˆ’u) eâˆ’Î³(tâˆ’u) + g (t + u) eâˆ’Î³(t+u)
2
sin (Ru)
u
du
and then apply the result of Problem 6.
9. Suppose f âˆˆS. Show F(fxj)(t) = itjFf(t).
10. Let f âˆˆS and let k be a positive integer.
||f||k,2 â‰¡(||f||2
2 +
X
|Î±|â‰¤k
||DÎ±f||2
2)1/2.
One could also deï¬ne
|||f|||k,2 â‰¡(
Z
Rn |Ff(x)|2(1 + |x|2)kdx)1/2.
Show both || ||k,2 and ||| |||k,2 are norms on S and that they are equivalent.
These are Sobolev space norms. For which values of k does the second norm
make sense? How about the ï¬rst norm?
11. â†‘Deï¬ne Hk(Rn), k â‰¥0 by f âˆˆL2(Rn) such that
(
Z
|Ff(x)|2(1 + |x|2)kdx)
1
2 < âˆž,

19.4.
EXERCISES
539
|||f|||k,2 â‰¡(
Z
|Ff(x)|2(1 + |x|2)kdx)
1
2.
Show Hk(Rn) is a Banach space, and that if k is a positive integer, Hk(Rn)
={ f âˆˆL2(Rn) : there exists {uj} âŠ†G with ||uj âˆ’f||2 â†’0 and {uj} is a
Cauchy sequence in || ||k,2 of Problem 10}. This is one way to deï¬ne Sobolev
Spaces.
Hint: One way to do the second part of this is to deï¬ne a new
measure, Âµ by
Âµ (E) â‰¡
Z
E
Â³
1 + |x|2Â´k
dx.
Then show Âµ is a Radon measure and show there exists {gm} such that gm âˆˆG
and gm â†’Ff in L2(Âµ). Thus gm = Ffm, fm âˆˆG because F maps G onto G.
Then by Problem 10, {fm } is Cauchy in the norm || ||k,2.
12. â†‘If 2k > n, show that if f âˆˆHk(Rn), then f equals a bounded continuous
function a.e. Hint: Show that for k this large, Ff âˆˆL1(Rn), and then use
Problem 1. To do this, write
|Ff(x)| = |Ff(x)|(1 + |x|2)
k
2 (1 + |x|2)
âˆ’k
2 ,
So
Z
|Ff(x)|dx =
Z
|Ff(x)|(1 + |x|2)
k
2 (1 + |x|2)
âˆ’k
2 dx.
Use the Cauchy Schwarz inequality. This is an example of a Sobolev imbedding
Theorem.
13. Let u âˆˆG. Then Fu âˆˆG and so, in particular, it makes sense to form the
integral,
Z
R
Fu (xâ€², xn) dxn
where (xâ€², xn) = x âˆˆRn.
For u âˆˆG, deï¬ne Î³u (xâ€²) â‰¡u (xâ€², 0).
Find a
constant such that F (Î³u) (xâ€²) equals this constant times the above integral.
Hint: By the dominated convergence theorem
Z
R
Fu (xâ€², xn) dxn = lim
Îµâ†’0
Z
R
eâˆ’(Îµxn)2Fu (xâ€², xn) dxn.
Now use the deï¬nition of the Fourier transform and Fubiniâ€™s theorem as re-
quired in order to obtain the desired relationship.
14. Recall the Fourier series of a function in L2 (âˆ’Ï€, Ï€) converges to the func-
tion in L2 (âˆ’Ï€, Ï€).
Prove a similar theorem with L2 (âˆ’Ï€, Ï€) replaced by
L2 (âˆ’mÏ€, mÏ€) and the functions
n
(2Ï€)âˆ’(1/2) einxo
nâˆˆZ

540
FOURIER TRANSFORMS
used in the Fourier series replaced with
n
(2mÏ€)âˆ’(1/2) ei n
m xo
nâˆˆZ
Now suppose f is a function in L2 (R) satisfying Ff (t) = 0 if |t| > mÏ€. Show
that if this is so, then
f (x) = 1
Ï€
X
nâˆˆZ
f
Âµâˆ’n
m
Â¶ sin (Ï€ (mx + n))
mx + n
.
Here m is a positive integer. This is sometimes called the Shannon sampling
theorem.Hint: First note that since Ff âˆˆL2 and is zero oï¬€a ï¬nite interval,
it follows Ff âˆˆL1. Also
f (t) =
1
âˆš
2Ï€
Z mÏ€
âˆ’mÏ€
eitxFf (x) dx
and you can conclude from this that f has all derivatives and they are all
bounded. Thus f is a very nice function. You can replace Ff with its Fourier
series. Then consider carefully the Fourier coeï¬ƒcient of Ff. Argue it equals
f
Â¡ âˆ’n
m
Â¢
or at least an appropriate constant times this. When you get this the
rest will fall quickly into place if you use Ff is zero oï¬€[âˆ’mÏ€, mÏ€].

Fourier Analysis In Rn An
Introduction
The purpose of this chapter is to present some of the most important theorems
on Fourier analysis in Rn.
These theorems are the Marcinkiewicz interpolation
theorem, the Calderon Zygmund decomposition, and Mihlinâ€™s theorem. They are
all fundamental results whose proofs depend on the methods of real analysis.
20.1
The Marcinkiewicz Interpolation Theorem
Let (â„¦, Âµ, S) be a measure space.
Deï¬nition 20.1 Lp (â„¦) + L1 (â„¦) will denote the space of measurable functions, f,
such that f is the sum of a function in Lp (â„¦) and L1 (â„¦). Also, if T : Lp (â„¦) +
L1 (â„¦) â†’space of measurable functions, T is subadditive if
|T (f + g) (x)| â‰¤|Tf (x)| + |Tg (x)|.
T is of type (p, p) if there exists a constant independent of f âˆˆLp (â„¦) such that
||Tf||p â‰¤A âˆ¥fâˆ¥p, f âˆˆLp (â„¦).
T is weak type (p, p) if there exists a constant A independent of f such that
Âµ ([x : |Tf (x)| > Î±]) â‰¤
ÂµA
Î± ||f||p
Â¶p
, f âˆˆLp (â„¦).
The following lemma involves writing a function as a sum of a functions whose
values are small and one whose values are large.
Lemma 20.2 If p âˆˆ[1, r], then Lp (â„¦) âŠ†L1 (â„¦) + Lr (â„¦).
Proof: Let Î» > 0 and let f âˆˆLp (â„¦)
f1 (x) â‰¡
Â½
f (x) if |f (x)| â‰¤Î»
0 if |f (x)| > Î»
, f2 (x) â‰¡
Â½
f (x) if |f (x)| > Î»
0 if |f (x)| â‰¤Î»
.
541

542
FOURIER ANALYSIS IN RN AN INTRODUCTION
Thus f (x) = f1 (x) + f2 (x).
Z
|f1 (x)|r dÂµ =
Z
[|f|â‰¤Î»]
|f (x)|r dÂµ â‰¤Î»râˆ’p
Z
[|f|â‰¤Î»]
|f (x)|p dÂµ < âˆž.
Therefore, f1 âˆˆLr (â„¦).
Z
|f2 (x)| dÂµ =
Z
[|f|>Î»]
|f (x)| dÂµ â‰¤Âµ [|f| > Î»]1/pâ€² ÂµZ
|f|p dÂµ
Â¶1/p
< âˆž.
This proves the lemma since f = f1 + f2, f1 âˆˆLr and f2 âˆˆL1.
For f a function having nonnegative real values, Î± â†’Âµ ([f > Î±]) is called the
distribution function.
Lemma 20.3 Let Ï† (0) = 0, Ï† is strictly increasing, and C1. Let f : â„¦â†’[0, âˆž)
be measurable. Then
Z
â„¦
(Ï† â—¦f) dÂµ =
Z âˆž
0
Ï†â€² (Î±) Âµ [f > Î±] dÎ±.
(20.1)
Proof: First suppose
f =
m
X
i=1
aiXEi
where ai > 0 and the ai are all distinct nonzero values of f, the sets, Ei being
disjoint. Thus,
Z
â„¦
(Ï† â—¦f) dÂµ =
m
X
i=1
Ï† (ai) Âµ (Ei).
Suppose without loss of generality a1 < a2 < Â· Â· Â· < am. Observe
Î± â†’Âµ ([f > Î±])
is constant on the intervals [0, a1), [a1, a2), Â· Â· Â·. For example, on [ai, ai+1), this func-
tion has the value
m
X
j=i+1
Âµ (Ej).
The function equals zero on [am, âˆž). Therefore,
Î± â†’Ï†â€² (Î±) Âµ ([|f| > Î±])

20.1.
THE MARCINKIEWICZ INTERPOLATION THEOREM
543
is Lebesgue measurable and letting a0 = 0, the second integral in 20.1 equals
Z âˆž
0
Ï†â€² (Î±) Âµ ([f > Î±]) dÎ±
=
m
X
i=1
Z ai
aiâˆ’1
Ï†â€² (Î±) Âµ ([f > Î±]) dÎ±
=
m
X
i=1
m
X
j=i
Âµ (Ej)
Z ai
aiâˆ’1
Ï†â€² (Î±) dÎ±
=
m
X
j=1
j
X
i=1
Âµ (Ej) (Ï† (ai) âˆ’Ï† (aiâˆ’1))
=
m
X
j=1
Âµ (Ej) Ï† (aj) =
Z
â„¦
(Ï† â—¦f) dÂµ
and so this establishes 20.1 in the case when f is a nonnegative simple function.
Since every measurable nonnegative function may be written as the pointwise limit
of such simple functions, the desired result will follow by the Monotone convergence
theorem and the next claim.
Claim: If fn â†‘f, then for each Î± > 0,
Âµ ([f > Î±]) = lim
nâ†’âˆžÂµ ([fn > Î±]).
Proof of the claim: [fn > Î±] â†‘[f > Î±] because if f (x) > Î± then for large
enough n, fn (x) > Î± and so
Âµ ([fn > Î±]) â†‘Âµ ([f > Î±]).
This proves the lemma. (Note the importance of the strict inequality in [f > Î±] in
proving the claim.)
The next theorem is the main result in this section. It is called the Marcinkiewicz
interpolation theorem.
Theorem 20.4 Let (â„¦, Âµ, S) be a Ïƒ ï¬nite measure space, 1 < r < âˆž, and let
T : L1 (â„¦) + Lr (â„¦) â†’space of measurable functions
be subadditive, weak (r, r), and weak (1, 1).
Then T is of type (p, p) for every
p âˆˆ(1, r) and
||Tf||p â‰¤Ap ||f||p
where the constant Ap depends only on p and the constants in the deï¬nition of weak
(1, 1) and weak (r, r).
Proof: Let Î± > 0 and let f1 and f2 be deï¬ned as in Lemma 20.2,
f1 (x) â‰¡
Â½
f (x) if |f (x)| â‰¤Î±
0 if |f (x)| > Î±
, f2 (x) â‰¡
Â½
f (x) if |f (x)| > Î±
0 if |f (x)| â‰¤Î±
.

544
FOURIER ANALYSIS IN RN AN INTRODUCTION
Thus f = f1 + f2 where f1 âˆˆLr and f2 âˆˆL1. Since T is subadditive ,
[|Tf| > Î±] âŠ†[|Tf1| > Î±/2] âˆª[|Tf2| > Î±/2] .
Let p âˆˆ(1, r). By Lemma 20.3,
Z
|Tf|p dÂµ â‰¤p
Z âˆž
0
Î±pâˆ’1Âµ ([|Tf1| > Î±/2]) dÎ±+
+p
Z âˆž
0
Î±pâˆ’1Âµ ([|Tf2| > Î±/2]) dÎ±.
Therefore, since T is weak (1, 1) and weak (r, r),
Z
|Tf|p dÂµ â‰¤p
Z âˆž
0
Î±pâˆ’1
Âµ2Ar
Î±
||f1||r
Â¶r
dÎ± + p
Z âˆž
0
Î±pâˆ’1 2A1
Î±
||f2||1 dÎ±.
(20.2)
Therefore, the right side of 20.2 equals
p (2Ar)r
Z âˆž
0
Î±pâˆ’1âˆ’r
Z
â„¦
|f1|r dÂµdÎ± + 2A1p
Z âˆž
0
Î±pâˆ’2
Z
â„¦
|f2| dÂµdÎ± =
p (2Ar)r
Z
â„¦
Z âˆž
0
Î±pâˆ’1âˆ’r |f1|r dÎ±dÂµ + 2A1p
Z
â„¦
Z âˆž
0
Î±pâˆ’2 |f2| dÎ±dÂµ.
Now f1 (x) = 0 unless |f1 (x)| â‰¤Î± and f2 (x) = 0 unless |f2 (x)| > Î± so this equals
p (2Ar)r
Z
â„¦
|f (x)|r
Z âˆž
|f(x)|
Î±pâˆ’1âˆ’rdÎ±dÂµ + 2A1p
Z
â„¦
|f (x)|
Z |f(x)|
0
Î±pâˆ’2dÎ±dÂµ
which equals
2rAr
rp
r âˆ’p
Z
â„¦
|f (x)|p dÂµ + 2pA1
p âˆ’1
Z
â„¦
|f (x)|p dÂµ
â‰¤max
Âµ2rAr
rp
r âˆ’p , 2pA1
p âˆ’1
Â¶
||f||p
Lp(â„¦)
and this proves the theorem.
20.2
The Calderon Zygmund Decomposition
For a given nonnegative integrable function, Rn can be decomposed into a set where
the function is small and a set which is the union of disjoint cubes on which the
average of the function is under some control. The measure in this section will
always be Lebesgue measure on Rn. This theorem depends on the Lebesgue theory
of diï¬€erentiation.

20.2.
THE CALDERON ZYGMUND DECOMPOSITION
545
Theorem 20.5 Let f â‰¥0,
R
fdx < âˆž, and let Î± be a positive constant. Then
there exist sets F and â„¦such that
Rn = F âˆªâ„¦, F âˆ©â„¦= âˆ…
(20.3)
f (x) â‰¤Î± a.e. on F
(20.4)
â„¦= âˆªâˆž
k=1Qk where the interiors of the cubes are disjoint and for each cube, Qk,
Î± <
1
m (Qk)
Z
Qk
f (x) dx â‰¤2nÎ±.
(20.5)
Proof: Let S0 be a tiling of Rn into cubes having sides of length M where M
is chosen large enough that if Q is one of these cubes, then
1
m (Q)
Z
Q
fdm â‰¤Î±.
(20.6)
Suppose S0, Â· Â· Â·, Sm have been chosen. To get Sm+1, replace each cube of Sm by
the 2n cubes obtained by bisecting the sides. Then Sm+1 consists of exactly those
cubes of Sm for which 20.6 holds and let Tm+1 consist of the bisected cubes from
Sm for which 20.6 does not hold. Now deï¬ne
F â‰¡{x : x is contained in some cube from Sm for all m} ,
â„¦â‰¡Rn \ F = âˆªâˆž
m=1 âˆª{Q : Q âˆˆTm}
Note that the cubes from Tm have pair wise disjoint interiors and also the interiors
of cubes from Tm have empty intersections with the interiors of cubes of Tk if k Ì¸= m.
Let x be a point of â„¦and let x be in a cube of Tm such that m is the ï¬rst index
for which this happens. Let Q be the cube in Smâˆ’1 containing x and let Qâˆ—be the
cube in the bisection of Q which contains x. Therefore 20.6 does not hold for Qâˆ—.
Thus
Î± <
1
m (Qâˆ—)
Z
Qâˆ—fdx â‰¤m (Q)
m (Qâˆ—)
â‰¤Î±
z
}|
{
1
m (Q)
Z
Q
fdx â‰¤2nÎ±
which shows â„¦is the union of cubes having disjoint interiors for which 20.5 holds.
Now a.e. point of F is a Lebesgue point of f. Let x be such a point of F and
suppose x âˆˆQk for Qk âˆˆSk. Let dk â‰¡diameter of Qk. Thus dk â†’0.
1
m (Qk)
Z
Qk
|f (y) âˆ’f (x)| dy â‰¤
1
m (Qk)
Z
B(x,dk)
|f (y) âˆ’f (x)| dy
= m (B (x,dk))
m (Qk)
1
m (B (x,dk))
Z
B(x,dk)
|f (x) âˆ’f (y)| dy
â‰¤Kn
1
m (B (x,dk))
Z
B(x,dk)
|f (x) âˆ’f (y)| dy

546
FOURIER ANALYSIS IN RN AN INTRODUCTION
where Kn is a constant which depends on n and measures the ratio of the volume of
a ball with diamiter 2d and a cube with diameter d. The last expression converges
to 0 because x is a Lebesgue point. Hence
f (x) = lim
kâ†’âˆž
1
m (Qk)
Z
Qk
f (y) dy â‰¤Î±
and this shows f (x) â‰¤Î± a.e. on F. This proves the theorem.
20.3
Mihlinâ€™s Theorem
In this section, the Marcinkiewicz interpolation theorem and Calderon Zygmund
decomposition will be used to establish a remarkable theorem of Mihlin, a general-
ization of Plancherelâ€™s theorem to the Lp spaces. It is of fundamental importance
in the study of elliptic partial diï¬€erential equations and can also be used to give
proofs for the theory of singular integrals. Mihlinâ€™s theorem involves a conclusion
which is of the form
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ï†
Â¯Â¯Â¯Â¯
p â‰¤Ap ||Ï†||p
(20.7)
for p > 1 and Ï† âˆˆG. Thus F âˆ’1Ïâˆ—extends to a continuous linear map deï¬ned on Lp
because of the density of G. It is proved by showing various weak type estimates
and then applying the Marcinkiewicz Interpolation Theorem to get an estimate like
the above.
Recall that by Corollary 19.27, if f âˆˆL2 (Rn) and if Ï† âˆˆG, then f âˆ—Ï† âˆˆL2 (Rn)
and
F (f âˆ—Ï†) (x) = (2Ï€)n/2 FÏ† (x) Ff (x).
The next lemma is essentially a weak (1, 1) estimate. The inequality 20.7 is estab-
lished under the condition, 20.8 and then it is shown there exist conditions which
are easier to verify which imply condition 20.8. I think the approach used here is
due to Hormander [29] and is found in Berg and Lofstrom [8]. For many more ref-
erences and generalizations, you might look in Triebel [50]. A diï¬€erent proof based
on singular integrals is in Stein [49]. Functions, Ï which yield an inequality of the
sort in 20.7 are called Lp multipliers.
Lemma 20.6 Suppose Ï âˆˆLâˆž(Rn) âˆ©L2 (Rn) and suppose also there exists a con-
stant C1 such that
Z
|x|â‰¥2|y|
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x)
Â¯Â¯ dx â‰¤C1.
(20.8)
Then there exists a constant A depending only on C1, ||Ï||âˆž, and n such that
m
Â¡Â£
x :
Â¯Â¯F âˆ’1Ïâˆ—Ï† (x)
Â¯Â¯ > Î±
Â¤Â¢
â‰¤A
Î± ||Ï†||1
for all Ï† âˆˆG.

20.3.
MIHLINâ€™S THEOREM
547
Proof: Let Ï† âˆˆG and use the Calderon decomposition to write Rn = E âˆªâ„¦
where â„¦is a union of cubes, {Qi} with disjoint interiors such that
Î±m (Qi) â‰¤
Z
Qi
|Ï† (x)| dx â‰¤2nÎ±m (Qi) , |Ï† (x)| â‰¤Î± a.e. on E.
(20.9)
The proof is accomplished by writing Ï† as the sum of a good function and
a bad function and establishing a similar weak inequality for these two functions
separately. Then this information is used to obtain the desired conclusion.
g (x) =
Â½ Ï† (x) if x âˆˆE
1
m(Qi)
R
Qi Ï† (x) dx if x âˆˆQi âŠ†â„¦, g (x) + b (x) = Ï† (x).
(20.10)
ThusZ
Qi
b (x) dx
=
Z
Qi
(Ï† (x) âˆ’g (x)) dx =
Z
Qi
Ï† (x) dx âˆ’
Z
Qi
Ï† (x) dx = 0,(20.11)
b (x)
=
0 if x /âˆˆâ„¦.
(20.12)
Claim:
||g||2
2 â‰¤Î± (1 + 4n) ||Ï†||1 , ||g||1 â‰¤||Ï†||1.
(20.13)
Proof of claim:
||g||2
2 = ||g||2
L2(E) + ||g||2
L2(â„¦).
Thus
||g||2
L2(â„¦)
=
X
i
Z
Qi
|g (x)|2 dx
â‰¤
X
i
Z
Qi
Âµ
1
m (Qi)
Z
Qi
|Ï† (y)| dy
Â¶2
dx
â‰¤
X
i
Z
Qi
(2nÎ±)2 dx â‰¤4nÎ±2 X
i
m (Qi)
â‰¤
4nÎ±2 1
Î±
X
i
Z
Qi
|Ï† (x)| dx â‰¤4nÎ± ||Ï†||1.
||g||2
L2(E) =
Z
E
|Ï† (x)|2 dx â‰¤Î±
Z
E
|Ï† (x)| dx = Î± ||Ï†||1.
Now consider the second of the inequalities in 20.13.
||g||1
=
Z
E
|g (x)| dx +
Z
â„¦
|g (x)| dx
=
Z
E
|Ï† (x)| dx +
X
i
Z
Qi
|g| dx
â‰¤
Z
E
|Ï† (x)| dx +
X
i
Z
Qi
1
m (Qi)
Z
Qi
|Ï† (x)| dm (x) dm
=
Z
E
|Ï† (x)| dx +
X
i
Z
Qi
|Ï† (x)| dm (x) = ||Ï†||1

548
FOURIER ANALYSIS IN RN AN INTRODUCTION
This proves the claim. From the claim, it follows that b âˆˆL2 (Rn) âˆ©L1 (Rn) .
Because of 20.13, g âˆˆL1 (Rn) and so F âˆ’1Ï âˆ—g âˆˆL2 (Rn).
(Since Ï âˆˆL2,
it follows F âˆ’1Ï âˆˆL2 and so this convolution is indeed in L2.) By Plancherelâ€™s
theorem,
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—g
Â¯Â¯Â¯Â¯
2 =
Â¯Â¯Â¯Â¯F
Â¡
F âˆ’1Ï âˆ—g
Â¢Â¯Â¯Â¯Â¯
2.
By Corollary 19.27 on Page 531, the expression on the right equals
(2Ï€)n/2 ||ÏFg||2
and so
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—g
Â¯Â¯Â¯Â¯
2 = (2Ï€)n/2 ||ÏFg||2 â‰¤Cn ||Ï||âˆž||g||2.
From this and 20.13
m
Â¡Â£Â¯Â¯F âˆ’1Ï âˆ—g
Â¯Â¯ â‰¥Î±/2
Â¤Â¢
â‰¤Cn ||Ï||2
âˆž
Î±2
Î± (1 + 4n) ||Ï†||1 = CnÎ±âˆ’1 ||Ï†||1.
(20.14)
This is what is wanted so far as g is concerned. Next it is required to estimate
m
Â¡Â£Â¯Â¯F âˆ’1Ï âˆ—b
Â¯Â¯ â‰¥Î±/2
Â¤Â¢
.
If Q is one of the cubes whose union is â„¦, let Qâˆ—be the cube with the same
center as Q but whose sides are 2âˆšn times as long.
Qi
Qâˆ—
i
yi
r
Let
â„¦âˆ—â‰¡âˆªâˆž
i=1Qâˆ—
i
and let
Eâˆ—â‰¡Rn \ â„¦âˆ—.
Thus Eâˆ—âŠ†E. Let x âˆˆEâˆ—. Then because of 20.11,
Z
Qi
F âˆ’1Ï (x âˆ’y) b (y) dy
=
Z
Qi
Â£
F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x âˆ’yi)
Â¤
b (y) dy,
(20.15)
where yi is the center of Qi. Consequently if the sides of Qi have length 2t/âˆšn,
20.15 implies
Z
Eâˆ—
Â¯Â¯Â¯Â¯
Z
Qi
F âˆ’1Ï (x âˆ’y) b (y) dy
Â¯Â¯Â¯Â¯ dx â‰¤
(20.16)

20.3.
MIHLINâ€™S THEOREM
549
Z
Eâˆ—
Z
Qi
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x âˆ’yi)
Â¯Â¯ |b (y)| dydx
=
Z
Qi
Z
Eâˆ—
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x âˆ’yi)
Â¯Â¯ dx |b (y)| dy
(20.17)
â‰¤
Z
Qi
Z
|xâˆ’yi|â‰¥2t
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x âˆ’yi)
Â¯Â¯ dx |b (y)| dy
(20.18)
since if x âˆˆEâˆ—, then |x âˆ’yi| â‰¥2t. Now for y âˆˆQi,
|y âˆ’yi| â‰¤
ï£«
ï£­
n
X
j=1
Âµ t
âˆšn
Â¶2
ï£¶
ï£¸
1/2
= t.
From 20.8 and the change of variables u = x âˆ’yi 20.16 - 20.18 imply
Z
Eâˆ—
Â¯Â¯Â¯Â¯
Z
Qi
F âˆ’1Ï (x âˆ’y) b (y) dy
Â¯Â¯Â¯Â¯ dx â‰¤C1
Z
Qi
|b (y)| dy.
(20.19)
Now from 20.19, and the fact that b = 0 oï¬€â„¦,
Z
Eâˆ—
Â¯Â¯F âˆ’1Ï âˆ—b (x)
Â¯Â¯ dx
=
Z
Eâˆ—
Â¯Â¯Â¯Â¯
Z
Rn F âˆ’1Ï (x âˆ’y) b (y) dy
Â¯Â¯Â¯Â¯ dx
=
Z
Eâˆ—
Â¯Â¯Â¯Â¯Â¯
âˆž
X
i=1
Z
Qi
F âˆ’1Ï (x âˆ’y) b (y) dy
Â¯Â¯Â¯Â¯Â¯ dx
â‰¤
Z
Eâˆ—
âˆž
X
i=1
Â¯Â¯Â¯Â¯
Z
Qi
F âˆ’1Ï (x âˆ’y) b (y) dy
Â¯Â¯Â¯Â¯ dx
=
âˆž
X
i=1
Z
Eâˆ—
Â¯Â¯Â¯Â¯
Z
Qi
F âˆ’1Ï (x âˆ’y) b (y) dy
Â¯Â¯Â¯Â¯ dx
â‰¤
âˆž
X
i=1
C1
Z
Qi
|b (y)| dy = C1 ||b||1.
Thus, by 20.13,
Z
Eâˆ—
Â¯Â¯F âˆ’1Ï âˆ—b (x)
Â¯Â¯ dx
â‰¤
C1 ||b||1
â‰¤
C1 [||Ï†||1 + ||g||1]
â‰¤
C1 [||Ï†||1 + ||Ï†||1]
â‰¤
2C1 ||Ï†||1 .
Consequently,
m
Â³hÂ¯Â¯F âˆ’1Ï âˆ—b
Â¯Â¯ â‰¥Î±
2
i
âˆ©Eâˆ—Â´
â‰¤4C1
Î± ||Ï†||1 .

550
FOURIER ANALYSIS IN RN AN INTRODUCTION
From 20.10, 20.14, and 20.9,
m
Â£Â¯Â¯F âˆ’1Ï âˆ—Ï†
Â¯Â¯ > Î±
Â¤
â‰¤m
hÂ¯Â¯F âˆ’1Ï âˆ—g
Â¯Â¯ â‰¥Î±
2
i
+ m
hÂ¯Â¯F âˆ’1Ï âˆ—b
Â¯Â¯ â‰¥Î±
2
i
â‰¤Cn
Î± ||Ï†||1 + m
Â³hÂ¯Â¯F âˆ’1Ï âˆ—b
Â¯Â¯ â‰¥Î±
2
i
âˆ©Eâˆ—Â´
+ m (â„¦âˆ—)
â‰¤Cn
Î± ||Ï†||1 + 4C1
Î± ||Ï†||1 + Cnm (â„¦) â‰¤A
Î± ||Ï†||1
because
m (â„¦) â‰¤Î±âˆ’1 ||Ï†||1
by 20.9. This proves the lemma.
The next lemma extends this lemma by giving a weak (2, 2) estimate and a (2, 2)
estimate.
Lemma 20.7 Suppose Ï âˆˆLâˆž(Rn) âˆ©L2 (Rn) and suppose also that there exists a
constant C1 such that
Z
|x|>2|y|
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x)
Â¯Â¯ dx â‰¤C1.
(20.20)
Then F âˆ’1Ïâˆ—maps L1 (Rn) + L2 (Rn) to measurable functions and there exists a
constant A depending only on C1, n, ||Ï||âˆžsuch that
m
Â¡Â£Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯ > Î±
Â¤Â¢
â‰¤A||f||1
Î±
if f âˆˆL1 (Rn),
(20.21)
m
Â¡Â£Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯ > Î±
Â¤Â¢
â‰¤
Âµ
A||f||2
Î±
Â¶2
if f âˆˆL2 (Rn).
(20.22)
Thus, F âˆ’1Ïâˆ—is weak type (1, 1) and weak type (2, 2). Also
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯Â¯Â¯
2 â‰¤A ||f||2 if f âˆˆL2 (Rn).
(20.23)
Proof: By Plancherelâ€™s theorem F âˆ’1Ï is in L2 (Rn). If f âˆˆL1 (Rn), then by
Minkowskiâ€™s inequality,
F âˆ’1Ï âˆ—f âˆˆL2 (Rn) .
Now let g âˆˆL2 (Rn). By Holderâ€™s inequality,
Z Â¯Â¯F âˆ’1Ï (x âˆ’y)
Â¯Â¯ |g (y)| dy â‰¤
ÂµZ Â¯Â¯F âˆ’1Ï (x âˆ’y)
Â¯Â¯2 dy
Â¶1/2 ÂµZ
|g (y)|2 dy
Â¶1/2
< âˆž
and so the following is well deï¬ned a.e.
F âˆ’1Ï âˆ—g (x) â‰¡
Z
F âˆ’1Ï (x âˆ’y) g (y) dy

20.3.
MIHLINâ€™S THEOREM
551
also,
Â¯Â¯F âˆ’1Ï âˆ—g (x) âˆ’F âˆ’1Ï âˆ—g (xâ€²)
Â¯Â¯
â‰¤
Z Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (xâ€² âˆ’y)
Â¯Â¯ |g (y)| dy
â‰¤
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ’F âˆ’1Ïxâ€²âˆ’x
Â¯Â¯Â¯Â¯ ||g||l2
and by continuity of translation in L2 (Rn), this shows x â†’F âˆ’1Ï âˆ—g (x) is continu-
ous. Therefore, F âˆ’1Ïâˆ—maps L1 (Rn)+L2 (Rn) to the space of measurable functions.
(Continuous functions are measurable.) It is clear that F âˆ’1Ïâˆ—is subadditive.
If Ï† âˆˆG, Plancherelâ€™s theorem implies as before,
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ï†
Â¯Â¯Â¯Â¯
2 =
Â¯Â¯Â¯Â¯F
Â¡
F âˆ’1Ï âˆ—Ï†
Â¢Â¯Â¯Â¯Â¯
2 =
(2Ï€)n/2 ||ÏFÏ†||2 â‰¤(2Ï€)n/2 ||Ï||âˆž||Ï†||2 .
(20.24)
Now let f âˆˆL2 (Rn) and let Ï†k âˆˆG, with
||Ï†k âˆ’f||2 â†’0.
Then by Holderâ€™s inequality,
Z
F âˆ’1Ï (x âˆ’y) f (y) dy = lim
kâ†’âˆž
Z
F âˆ’1Ï (x âˆ’y) Ï†k (y) dy
and so by Fatouâ€™s lemma, Plancherelâ€™s theorem, and 20.24,
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯Â¯Â¯
2 =
ÃƒZ Â¯Â¯Â¯Â¯
Z
F âˆ’1Ï (x âˆ’y) f (y) dy
Â¯Â¯Â¯Â¯
2
dx
!1/2
â‰¤
â‰¤lim inf
kâ†’âˆž
ÃƒZ Â¯Â¯Â¯Â¯
Z
F âˆ’1Ï (x âˆ’y) Ï†k (y) dy
Â¯Â¯Â¯Â¯
2
dx
!1/2
= lim inf
kâ†’âˆž
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ï†k
Â¯Â¯Â¯Â¯
2
â‰¤||Ï||âˆž(2Ï€)n/2 lim inf
kâ†’âˆž||Ï†k||2 = ||Ï||âˆž(2Ï€)n/2 ||f||2 .
Thus, 20.23 holds with A = ||Ï||âˆž(2Ï€)n/2. Consequently,
A ||f||2 â‰¥
ÃƒZ
[|F âˆ’1Ïâˆ—f|>Î±]
Â¯Â¯F âˆ’1Ï âˆ—f (x)
Â¯Â¯2 dx
!1/2
â‰¥Î±m
Â¡Â£Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯ > Î±
Â¤Â¢1/2
and so 20.22 follows.
It remains to prove 20.21 which holds for all f âˆˆG
by Lemma 20.6.
Let
f âˆˆL1 (Rn) and let Ï†k â†’f in L1 (Rn) , Ï†k âˆˆG. Without loss of generality, assume
that both f and F âˆ’1Ï are Borel measurable. Therefore, by Minkowskiâ€™s inequality,
and Plancherelâ€™s theorem,
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ï†k âˆ’F âˆ’1Ï âˆ—f
Â¯Â¯Â¯Â¯
2

552
FOURIER ANALYSIS IN RN AN INTRODUCTION
â‰¤
ÃƒZ Â¯Â¯Â¯Â¯
Z
F âˆ’1Ï (x âˆ’y) (Ï†k (y) âˆ’f (y)) dy
Â¯Â¯Â¯Â¯
2
dx
!1/2
â‰¤
||Ï†k âˆ’f||1 ||Ï||2
which shows that F âˆ’1Ï âˆ—Ï†k converges to F âˆ’1Ï âˆ—f in L2 (Rn). Therefore, there
exists a subsequence such that the convergence is pointwise a.e. Then, denoting the
subsequence by k,
X[|F âˆ’1Ïâˆ—f|>Î±] (x) â‰¤lim inf
kâ†’âˆžX[|F âˆ’1Ïâˆ—Ï†k|>Î±] (x) a.e. x.
Thus by Lemma 20.6 and Fatouâ€™s lemma, there exists a constant, A, depending on
C1, n, and ||Ï||âˆžsuch that
m
Â¡Â£Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯ > Î±
Â¤Â¢
â‰¤
lim inf
kâ†’âˆžm
Â¡Â£Â¯Â¯F âˆ’1Ï âˆ—Ï†k
Â¯Â¯ > Î±
Â¤Â¢
â‰¤
lim inf
kâ†’âˆžA||Ï†k||1
Î±
= A||f||1
Î±
.
This shows 20.21 and proves the lemma.
Theorem 20.8 Let Ï âˆˆL2 (Rn) âˆ©Lâˆž(Rn) and suppose
Z
|x|â‰¥2|y|
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x)
Â¯Â¯ dx â‰¤C1.
Then for each p âˆˆ(1, âˆž), there exists a constant, Ap, depending only on
p, n, ||Ï||âˆž,
and C1 such that for all Ï† âˆˆG,
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ï†
Â¯Â¯Â¯Â¯
p â‰¤Ap ||Ï†||p .
Proof: From Lemma 20.7, F âˆ’1Ïâˆ—is weak (1, 1), weak (2, 2), and maps
L1 (Rn) + L2 (Rn)
to measurable functions. Therefore, by the Marcinkiewicz interpolation theorem,
there exists a constant Ap depending only on p, C1, n, and ||Ï||âˆžfor p âˆˆ(1, 2], such
that for f âˆˆLp (Rn), and p âˆˆ(1, 2],
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯Â¯Â¯
p â‰¤Ap ||f||p .
Thus the theorem is proved for these values of p. Now suppose p > 2. Then pâ€² < 2
where
1
p + 1
pâ€² = 1.

20.3.
MIHLINâ€™S THEOREM
553
By Plancherelâ€™s theorem and Theorem 19.33,
Z
F âˆ’1Ï âˆ—Ï† (x) Ïˆ (x) dx
=
(2Ï€)n/2
Z
Ï (x) FÏ† (x) FÏˆ (x) dx
=
Z
F
Â¡
F âˆ’1Ï âˆ—Ïˆ
Â¢
FÏ†dx
=
Z Â¡
F âˆ’1Ï âˆ—Ïˆ
Â¢
(Ï†) dx.
Thus by the case for p âˆˆ(1, 2) and Holderâ€™s inequality,
Â¯Â¯Â¯Â¯
Z
F âˆ’1Ï âˆ—Ï† (x) Ïˆ (x) dx
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Z Â¡
F âˆ’1Ï âˆ—Ïˆ
Â¢
(Ï†) dx
Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ïˆ
Â¯Â¯Â¯Â¯
pâ€² ||Ï†||p
â‰¤
Apâ€² ||Ïˆ||pâ€² ||Ï†||p .
Letting LÏˆ â‰¡
R
F âˆ’1Ï âˆ—Ï† (x) Ïˆ (x) dx, this shows L âˆˆLpâ€² (Rn)â€² and ||L||(Lpâ€²)
â€² â‰¤
Apâ€² ||Ï†||pwhich implies by the Riesz representation theorem that F âˆ’1Ïâˆ—Ï† represents
L and
||L||(Lpâ€²)
â€² =
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ï†
Â¯Â¯Â¯Â¯
Lp â‰¤Apâ€² ||Ï†||p
Since pâ€² = p/ (p âˆ’1), this proves the theorem.
It is possible to give veriï¬able conditions on Ï which imply 20.20. The condition
on Ï which is presented here is the existence of a constant, C0 such that
C0 â‰¥sup{|x||Î±| |DÎ±Ï (x)| : |Î±| â‰¤L, x âˆˆRn \ {0}}, L > n/2.
(20.25)
Ï âˆˆCL (Rn \ {0}) where L is an integer.
Here Î± is a multi-index and |Î±| = Pn
i=1 Î±i. The condition says roughly that Ï
is pretty smooth away from 0 and all the partial derivatives vanish pretty fast as
|x| â†’âˆž. Also recall the notation
xÎ± â‰¡xÎ±1
1 Â· Â· Â· xÎ±n
n
where Î± = (Î±1 Â· Â· Â· Î±n). For more general conditions, see [29].
Lemma 20.9 Let 20.25 hold and suppose Ïˆ âˆˆCâˆž
c (Rn \ {0}).
Then for each
Î±, |Î±| â‰¤L, there exists a constant C â‰¡C (Î±, n, Ïˆ) independent of k such that
sup
x âˆˆRn |x||Î±| Â¯Â¯DÎ± Â¡
Ï (x) Ïˆ
Â¡
2kx
Â¢Â¢Â¯Â¯ â‰¤CC0.
Proof:
|x||Î±| Â¯Â¯DÎ± Â¡
Ï (x) Ïˆ
Â¡
2kx
Â¢Â¢Â¯Â¯ â‰¤|x||Î±|
X
Î²+Î³=Î±
Â¯Â¯DÎ²Ï (x)
Â¯Â¯ 2k|Î³| Â¯Â¯DÎ³Ïˆ
Â¡
2kx
Â¢Â¯Â¯

554
FOURIER ANALYSIS IN RN AN INTRODUCTION
=
X
Î²+Î³=Î±
|x||Î²| Â¯Â¯DÎ²Ï (x)
Â¯Â¯ Â¯Â¯2kx
Â¯Â¯|Î³| Â¯Â¯DÎ³Ïˆ
Â¡
2kx
Â¢Â¯Â¯
â‰¤C0C (Î±, n)
X
|Î³|â‰¤|Î±|
sup{|z||Î³| |DÎ³Ïˆ (z)| : z âˆˆRn} = C0C (Î±, n, Ïˆ)
and this proves the lemma.
Lemma 20.10 There exists
Ï† âˆˆCâˆž
c
Â¡Â£
x :4âˆ’1 < |x| < 4
Â¤Â¢
, Ï† (x) â‰¥0,
and
âˆž
X
k=âˆ’âˆž
Ï†
Â¡
2kx
Â¢
= 1
for each x Ì¸= 0.
Proof: Let
Ïˆ â‰¥0, Ïˆ = 1 on
Â£
2âˆ’1 â‰¤|x| â‰¤2
Â¤
,
spt (Ïˆ) âŠ†
Â£
4âˆ’1 < |x| < 4
Â¤
.
Consider
g (x) =
âˆž
X
k=âˆ’âˆž
Ïˆ
Â¡
2kx
Â¢
.
Then for each x, only ï¬nitely many terms are not equal to 0. Also, g (x) > 0 for
all x Ì¸= 0. To verify this last claim, note that for some k an integer, |x| âˆˆ
Â£
2l, 2l+2Â¤
.
Therefore, choose k an integer such that 2k |x| âˆˆ
Â£
2âˆ’1, 2
Â¤
. For example, let k =
âˆ’l âˆ’1. This works because 2k |x| âˆˆ
Â£
2l2k, 2l+22kÂ¤
=
Â£
2lâˆ’lâˆ’1, 2l+2âˆ’lâˆ’1Â¤
=
Â£
2âˆ’1, 2
Â¤
.
Therefore, for this value of k, Ïˆ
Â¡
2kx
Â¢
= 1 so g (x) > 0.
Now notice that
g (2rx) =
âˆž
X
k=âˆ’âˆž
Ïˆ
Â¡
2k2rx
Â¢
=
âˆž
X
k=âˆ’âˆž
Ïˆ
Â¡
2kx
Â¢
= g (x).
Let Ï† (x) â‰¡Ïˆ (x) g (x)âˆ’1. Then
âˆž
X
k=âˆ’âˆž
Ï†
Â¡
2kx
Â¢
=
âˆž
X
k=âˆ’âˆž
Ïˆ
Â¡
2kx
Â¢
g (2kx) = g (x)âˆ’1
âˆž
X
k=âˆ’âˆž
Ïˆ
Â¡
2kx
Â¢
= 1
for each x Ì¸= 0. This proves the lemma.
Now deï¬ne
Ïm (x) â‰¡
m
X
k=âˆ’m
Ï (x) Ï†
Â¡
2kx
Â¢
, Î³k (x) â‰¡Ï (x) Ï†
Â¡
2kx
Â¢
.

20.3.
MIHLINâ€™S THEOREM
555
Let t > 0 and let |y| â‰¤t. Consider the problem of estimating
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Î³k (x âˆ’y) âˆ’F âˆ’1Î³k (x)
Â¯Â¯ dx.
(20.26)
In the following estimates, C (a, b, Â· Â· Â·, d) will denote a generic constant depending
only on the indicated objects, a, b, Â· Â· Â·, d. For the ï¬rst estimate, note that since
|y| â‰¤t, 20.26 is no larger than
2
Z
|x|â‰¥t
Â¯Â¯F âˆ’1Î³k (x)
Â¯Â¯ dx = 2
Z
|x|â‰¥t
Â¯Â¯F âˆ’1Î³k (x)
Â¯Â¯ |x|âˆ’L |x|L dx
â‰¤2
ÃƒZ
|x|â‰¥t
|x|âˆ’2L dx
!1/2 ÃƒZ
|x|â‰¥t
|x|2L Â¯Â¯F âˆ’1Î³k (x)
Â¯Â¯2 dx
!1/2
Using spherical coordinates and Plancherelâ€™s theorem,
â‰¤C (n, L) tn/2âˆ’L Â³R
|x|2L Â¯Â¯F âˆ’1Î³k (x)
Â¯Â¯2 dx
Â´1/2
â‰¤C (n, L) tn/2âˆ’L Â³R Pn
j=1 |xj|2L Â¯Â¯F âˆ’1Î³k (x)
Â¯Â¯2 dx
Â´1/2
â‰¤C (n, L) tn/2âˆ’L Â³Pn
j=1
R Â¯Â¯F âˆ’1DL
j Î³k (x)
Â¯Â¯2 dx
Â´1/2
= C (n, L) tn/2âˆ’L Â³Pn
j=1
R
Sk
Â¯Â¯DL
j Î³k (x)
Â¯Â¯2 dx
Â´1/2
(20.27)
where
Sk â‰¡
Â£
x :2âˆ’2âˆ’k < |x| < 22âˆ’kÂ¤
,
(20.28)
a set containing the support of Î³k. Now from the deï¬nition of Î³k,
Â¯Â¯DL
j Î³k (z)
Â¯Â¯ =
Â¯Â¯DL
j
Â¡
Ï (z) Ï†
Â¡
2kz
Â¢Â¢Â¯Â¯.
By Lemma 20.9, this is no larger than
C (L, n, Ï†) C0 |z|âˆ’L.
(20.29)
It follows, using polar coordinates, that the last expression in 20.27 is no larger than
C (n, L, Ï†, C0) tn/2âˆ’L
ÂµZ
Sk
|z|âˆ’2L dz
Â¶1/2
â‰¤C (n, L, Ï†, C0) tn/2âˆ’LÂ·
(20.30)
ÃƒZ 22âˆ’k
2âˆ’2âˆ’k Ïnâˆ’1âˆ’2LdÏ
!1/2
â‰¤C (n, L, Ï†, C0) tn/2âˆ’L2k(Lâˆ’n/2).
Now estimate 20.26 in another way. The support of Î³k is in Sk, a bounded set,
and so F âˆ’1Î³k is diï¬€erentiable. Therefore,
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Î³k (x âˆ’y) âˆ’F âˆ’1Î³k (x)
Â¯Â¯ dx =

556
FOURIER ANALYSIS IN RN AN INTRODUCTION
Z
|x|â‰¥2t
Â¯Â¯Â¯Â¯Â¯Â¯
Z 1
0
n
X
j=1
DjF âˆ’1Î³k (xâˆ’sy) yjds
Â¯Â¯Â¯Â¯Â¯Â¯
dx
â‰¤
t
Z
|x|â‰¥2t
Z 1
0
n
X
j=1
Â¯Â¯DjF âˆ’1Î³k (xâˆ’sy)
Â¯Â¯ dsdx
â‰¤
t
Z
n
X
j=1
Â¯Â¯DjF âˆ’1Î³k (x)
Â¯Â¯ dx
â‰¤
t
n
X
j=1
ÂµZ Â³
1 +
Â¯Â¯2âˆ’kx
Â¯Â¯2Â´âˆ’L
dx
Â¶1/2
Â·
ÂµZ Â³
1 +
Â¯Â¯2âˆ’kx
Â¯Â¯2Â´L Â¯Â¯DjF âˆ’1Î³k (x)
Â¯Â¯2 dx
Â¶1/2
â‰¤C (n, L) t2kn/2
n
X
j=1
ÂµZ Â³
1 +
Â¯Â¯2âˆ’kx
Â¯Â¯2Â´L Â¯Â¯DjF âˆ’1Î³k (x)
Â¯Â¯2 dx
Â¶1/2
.
(20.31)
Now consider the jth term in the last sum in 20.31.
R Â³
1 +
Â¯Â¯2âˆ’kx
Â¯Â¯2Â´L Â¯Â¯DjF âˆ’1Î³k (x)
Â¯Â¯2 dx â‰¤
C (n, L)
R P
|Î±|â‰¤L 2âˆ’2k|Î±|x2Î± Â¯Â¯DjF âˆ’1Î³k (x)
Â¯Â¯2 dx
= C (n, L) P
|Î±|â‰¤L 2âˆ’2k|Î±| R
x2Î± Â¯Â¯F âˆ’1 (Ï€jÎ³k) (x)
Â¯Â¯2 dx
(20.32)
where Ï€j (z) â‰¡zj. This last assertion follows from
Dj
Z
eâˆ’ixÂ·yÎ³k (y) dy =
Z
(âˆ’i) eâˆ’ixÂ·yyjÎ³k (y) dy.
Therefore, a similar computation and Plancherelâ€™s theorem implies 20.32 equals
= C (n, L)
X
|Î±|â‰¤L
2âˆ’2k|Î±|
Z Â¯Â¯F âˆ’1DÎ± (Ï€jÎ³k) (x)
Â¯Â¯2 dx
= C (n, L)
X
|Î±|â‰¤L
2âˆ’2k|Î±|
Z
Sk
|DÎ± (zjÎ³k (z))|2 dz
(20.33)
where Sk is given in 20.28. Now
|DÎ± (zjÎ³k (z))|
=
2âˆ’k Â¯Â¯DÎ± Â¡
Ï (z) zj2kÏ†
Â¡
2kz
Â¢Â¢Â¯Â¯
=
2âˆ’k Â¯Â¯DÎ± Â¡
Ï (z) Ïˆj
Â¡
2kz
Â¢Â¢Â¯Â¯

20.3.
MIHLINâ€™S THEOREM
557
where Ïˆj (z) â‰¡zjÏ† (z). By Lemma 20.9, this is dominated by
2âˆ’kC (Î±, n, Ï†, j, C0) |z|âˆ’|Î±| .
Therefore, 20.33 is dominated by
C (L, n, Ï†, j, C0)
X
|Î±|â‰¤L
2âˆ’2k|Î±|
Z
Sk
2âˆ’2k |z|âˆ’2|Î±| dz
â‰¤
C (L, n, Ï†, j, C0)
X
|Î±|â‰¤L
2âˆ’2k|Î±|2âˆ’2k Â¡
2âˆ’2âˆ’kÂ¢(âˆ’2|Î±|) Â¡
22âˆ’kÂ¢n
â‰¤
C (L, n, Ï†, j, C0)
X
|Î±|â‰¤L
2âˆ’knâˆ’2k
â‰¤C (L, n, Ï†, j, C0) 2âˆ’kn2âˆ’2k.
It follows that 20.31 is no larger than
C (L, n, Ï†, C0) t2kn/22âˆ’kn/22âˆ’k = C (L, n, Ï†, C0) t2âˆ’k.
(20.34)
It follows from 20.34 and 20.30 that if |y| â‰¤t,
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Î³k (x âˆ’y) âˆ’F âˆ’1Î³k (x)
Â¯Â¯ dx â‰¤
C (L, n, Ï†, C0) min
Â³
t2âˆ’k,
Â¡
2âˆ’kt
Â¢n/2âˆ’LÂ´
.
With this inequality, the next lemma which is the desired result can be obtained.
Lemma 20.11 There exists a constant depending only on the indicated objects,
C1 = C (L, n, Ï†, C0) such that when |y| â‰¤t,
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x)
Â¯Â¯ dx â‰¤C1
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Ïm (x âˆ’y) âˆ’F âˆ’1Ïm (x)
Â¯Â¯ dx â‰¤C1.
(20.35)
Proof: F âˆ’1Ï = limmâ†’âˆžF âˆ’1Ïm in L2 (Rn). Let mk â†’âˆžbe such that conver-
gence is pointwise a.e. Then if |y| â‰¤t, Fatouâ€™s lemma implies
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x)
Â¯Â¯ dx â‰¤
lim inf
lâ†’âˆž
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Ïml (x âˆ’y) âˆ’F âˆ’1Ïml (x)
Â¯Â¯ dx

558
FOURIER ANALYSIS IN RN AN INTRODUCTION
â‰¤lim inf
lâ†’âˆž
ml
X
k=âˆ’ml
Z
|x|â‰¥2t
Â¯Â¯F âˆ’1Î³k (x âˆ’y) âˆ’F âˆ’1Î³k (x)
Â¯Â¯ dx
â‰¤C (L, n, Ï†, C0)
âˆž
X
k=âˆ’âˆž
min
Â³
t2âˆ’k,
Â¡
2âˆ’kt
Â¢n/2âˆ’LÂ´
.
(20.36)
Now consider the sum in 20.36,
âˆž
X
k=âˆ’âˆž
min
Â³
t2âˆ’k,
Â¡
2âˆ’kt
Â¢n/2âˆ’LÂ´
.
(20.37)
t2j = min
Â³
t2j,
Â¡
2jt
Â¢n/2âˆ’LÂ´
exactly when t2j â‰¤1.
This occurs if and only if
j â‰¤âˆ’ln (t) / ln (2). Therefore 20.37 is no larger than
X
jâ‰¤âˆ’ln(t)/ ln(2)
2jt +
X
jâ‰¥âˆ’ln(t)/ ln(2)
Â¡
2jt
Â¢n/2âˆ’L .
Letting a = L âˆ’n/2, this equals
t
X
kâ‰¥ln(t)/ ln(2)
2âˆ’k + tâˆ’Î±
X
jâ‰¥âˆ’ln(t)/ ln(2)
Â¡
2âˆ’aÂ¢j
â‰¤
2t
Âµ1
2
Â¶ln(t)/ ln(2)
+ tâˆ’a
Âµ 1
2a
Â¶âˆ’ln(t)/ ln(2)
=
2t
Âµ1
2
Â¶log2(t)
+ tâˆ’a
Âµ 1
2a
Â¶âˆ’log2(t)
=
2 + 1 = 3.
Similarly, 20.35 holds. This proves the lemma.
Now it is possible to prove Mihlinâ€™s theorem.
Theorem 20.12 (Mihlinâ€™s theorem) Suppose Ï satisï¬es
C0 â‰¥sup{|x||Î±| |DÎ±Ï (x)| : |Î±| â‰¤L, x âˆˆRn \ {0}},
where L is an integer greater than n/2 and Ï âˆˆCL (Rn \ {0}). Then for every
p > 1, there exists a constant Ap depending only on p, C0, Ï†, n, and L, such that
for all Ïˆ âˆˆG,
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ïˆ
Â¯Â¯Â¯Â¯
p â‰¤Ap ||Ïˆ||p.
Proof: Since Ïm satisï¬es 20.35, and is obviously in L2 (Rn)âˆ©Lâˆž(Rn), Theorem
20.8 implies there exists a constant Ap depending only on p, n, ||Ïm||âˆž, and C1 such
that for all Ïˆ âˆˆG and p âˆˆ(1, âˆž),
Â¯Â¯Â¯Â¯F âˆ’1Ïm âˆ—Ïˆ
Â¯Â¯Â¯Â¯
p â‰¤Ap ||Ïˆ||p.

20.4.
SINGULAR INTEGRALS
559
Now ||Ïm||âˆžâ‰¤||Ï||âˆžbecause
|Ïm (x)| â‰¤|Ï (x)|
m
X
k=âˆ’m
Ï†
Â¡
2kx
Â¢
â‰¤|Ï (x)|.
(20.38)
Therefore, since C1 = C1 (L, n, Ï†, C0) and C0 â‰¥||Ï||âˆž,
Â¯Â¯Â¯Â¯F âˆ’1Ïm âˆ—Ïˆ
Â¯Â¯Â¯Â¯
p â‰¤Ap (L, n, Ï†, C0, p) ||Ïˆ||p .
In particular, Ap does not depend on m.
Now, by 20.38, the observation that
Ï âˆˆLâˆž(Rn), limmâ†’âˆžÏm (y) = Ï (y) and the dominated convergence theorem, it
follows that for Î¸ âˆˆG.
Â¯Â¯Â¡
F âˆ’1Ï âˆ—Ïˆ
Â¢
(Î¸)
Â¯Â¯ â‰¡
Â¯Â¯Â¯Â¯(2Ï€)n/2
Z
Ï (x) FÏˆ (x) F âˆ’1Î¸ (x) dx
Â¯Â¯Â¯Â¯
= lim
mâ†’âˆž
Â¯Â¯Â¡
F âˆ’1Ïm âˆ—Ïˆ
Â¢
(Î¸)
Â¯Â¯ â‰¤lim
mâ†’âˆžsup
Â¯Â¯Â¯Â¯F âˆ’1Ïm âˆ—Ïˆ
Â¯Â¯Â¯Â¯
p ||Î¸||pâ€²
â‰¤Ap (L, n, Ï†, C0, p) ||Ïˆ||p ||Î¸||pâ€² .
Hence F âˆ’1Ï âˆ—Ïˆ âˆˆLp (Rn) and
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ïˆ
Â¯Â¯Â¯Â¯
p â‰¤Ap ||Ïˆ||p. This proves the theorem.
20.4
Singular Integrals
If K âˆˆL1 (Rn) then when p > 1,
||K âˆ—f||p â‰¤||f||p .
It turns out that some meaning can be assigned to K âˆ—f for some functions K
which are not in L1. This involves assuming a certain form for K and exploiting
cancellation. The resulting theory of singular integrals is very useful. To illustrate,
an application will be given to the Helmholtz decomposition of vector ï¬elds in the
next section. Like Mihlinâ€™s theorem, the theory presented here rests on Theorem
20.8, restated here for convenience.
Theorem 20.13 Let Ï âˆˆL2 (Rn) âˆ©Lâˆž(Rn) and suppose
Z
|x|â‰¥2|y|
Â¯Â¯F âˆ’1Ï (x âˆ’y) âˆ’F âˆ’1Ï (x)
Â¯Â¯ dx â‰¤C1.
Then for each p âˆˆ(1, âˆž), there exists a constant, Ap, depending only on
p, n, ||Ï||âˆž,
and C1 such that for all Ï† âˆˆG,
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—Ï†
Â¯Â¯Â¯Â¯
p â‰¤Ap ||Ï†||p .

560
FOURIER ANALYSIS IN RN AN INTRODUCTION
Lemma 20.14 Suppose
K âˆˆL2 (Rn) , ||FK||âˆžâ‰¤B < âˆž,
(20.39)
and
Z
|x|>2|y|
|K (x âˆ’y) âˆ’K (x)| dx â‰¤B.
Then for all p > 1, there exists a constant, A (p, n, B), depending only on the
indicated quantities such that
||K âˆ—f||p â‰¤A (p, n, B) ||f||p
for all f âˆˆG.
Proof: Let FK = Ï so F âˆ’1Ï = K. Then from 20.39 Ï âˆˆL2 (Rn) âˆ©Lâˆž(Rn)
and K = F âˆ’1Ï. By Theorem 20.8 listed above,
||K âˆ—f||p =
Â¯Â¯Â¯Â¯F âˆ’1Ï âˆ—f
Â¯Â¯Â¯Â¯
p â‰¤A (p, n, B) ||f||p
for all f âˆˆG. This proves the lemma.
The next lemma provides a situation in which the above conditions hold.
Lemma 20.15 Suppose
|K (x)| â‰¤B |x|âˆ’n ,
(20.40)
Z
a<|x|<b
K (x) dx = 0,
(20.41)
Z
|x|>2|y|
|K (x âˆ’y) âˆ’K (x)| dx â‰¤B.
(20.42)
Deï¬ne
KÎµ (x) =
Â½
K (x) if |x| â‰¥Îµ,
0 if |x| < Îµ.
(20.43)
Then there exists a constant C (n) such that
Z
|x|>2|y|
|KÎµ (x âˆ’y) âˆ’KÎµ (x)| dx â‰¤C (n) B
(20.44)
and
||FKÎµ||âˆžâ‰¤C (n) B.
(20.45)
Proof: In the argument, C (n) will denote a generic constant depending only on
n. Consider 20.44 ï¬rst. The integral is broken up according to whether |x| , |x âˆ’y| >
Îµ.
|x|
> Îµ
> Îµ
< Îµ
< Îµ
|x âˆ’y|
> Îµ
< Îµ
< Îµ
> Îµ

20.4.
SINGULAR INTEGRALS
561
R
|x|â‰¥2|y| |KÎµ (x âˆ’y) âˆ’KÎµ (x)| dx =
R
|x|â‰¥2|y|,|xâˆ’y|>Îµ,|x|<Îµ
|KÎµ (x âˆ’y) âˆ’KÎµ (x)| dx+
+
R
|x|â‰¥2|y|,|xâˆ’y|<Îµ,|x|â‰¥Îµ
|KÎµ (x âˆ’y) âˆ’KÎµ (x)| dx+
R
|x|â‰¥2|y|,|xâˆ’y|>Îµ,|x|>Îµ
|KÎµ (x âˆ’y) âˆ’KÎµ (x)| dx+
+
R
|x|â‰¥2|y|,|xâˆ’y|<Îµ,|x|<Îµ
|KÎµ (x âˆ’y) âˆ’KÎµ (x)| dx.
(20.46)
Now consider the terms in the above expression. The last integral in 20.46 equals 0
from the deï¬nition of KÎµ. The third integral on the right is no larger than B by the
deï¬nition of KÎµ and 20.42. Consider the second integral on the right. This integral
is no larger than
Z
|x|â‰¥2|y|,|x|â‰¥Îµ,|xâˆ’y|<Îµ
B |x|âˆ’n dx.
Now |x| â‰¤|y| + Îµ â‰¤|x| /2 + Îµ and so |x| < 2Îµ. Thus this is no larger than
Z
Îµâ‰¤|x|â‰¤2Îµ
B |x|âˆ’n dx = B
Z
Snâˆ’1
Z 2Îµ
Îµ
Ïnâˆ’1 1
Ïn dÏdÏƒ â‰¤BC (n) ln 2 = C (n) B.
It remains to estimate the ï¬rst integral on the right in 20.46.
This integral is
bounded by
Z
|x|â‰¥2|y|,|xâˆ’y|>Îµ,|x|<Îµ
B |x âˆ’y|âˆ’n dx
In the integral above, |x| < Îµ and so |x âˆ’y|âˆ’|y| < Îµ. Therefore, |x âˆ’y| < Îµ+|y| <
Îµ + |x| /2 < Îµ + Îµ/2 = (3/2) Îµ. Hence Îµ â‰¤|x âˆ’y| â‰¤(3/2) |x âˆ’y|. Therefore, the
above integral is no larger than
Z (3/2)Îµ
Îµ
B |z|âˆ’n dz = B
Z
Snâˆ’1
Z (3/2)Îµ
Îµ
Ïâˆ’1dÏdÏƒ = BC (n) ln (3/2) .
This establishes 20.44.
Now it remains to show 20.45, a statement about the Fourier transforms of KÎµ.
Fix Îµ and let y Ì¸= 0 also be given.
KÎµR (y) â‰¡
Â½
KÎµ (y) if |y| < R,
0 if |y| â‰¥R
where R >
3Ï€
|y|. (The 3 here isnâ€™t important. It just needs to be larger than 1.)
Then
|FKÎµR (y)| â‰¤
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Z
0<|x|<3Ï€|y|âˆ’1
KÎµ (x) eâˆ’ixÂ·ydx
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
+
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx
Â¯Â¯Â¯Â¯Â¯Â¯Â¯

562
FOURIER ANALYSIS IN RN AN INTRODUCTION
= A + B.
(20.47)
Consider A. By 20.41
Z
Îµ<|x|<3Ï€|y|âˆ’1
KÎµ (x) dx = 0
and so
A =
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Z
Îµ<|x|<3Ï€|y|âˆ’1
KÎµ (x)
Â¡
eâˆ’ixÂ·y âˆ’1
Â¢
dx
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Now
Â¯Â¯eâˆ’ixÂ·y âˆ’1
Â¯Â¯ = |2 âˆ’2 cos (x Â· y)|1/2 â‰¤2 |x Â· y| â‰¤2 |x| |y|
so, using polar coordinates, this expression is no larger than
2B
Z
Îµ<|x|<3Ï€|y|âˆ’1
|x|âˆ’n |x| |y| dx â‰¤C (n) B |y|
Z 3Ï€/|y|
Îµ
dÏ â‰¤BC (n).
Next, consider B. This estimate is based on the trick which follows. Let
z â‰¡yÏ€/ |y|2
so that
|z| = Ï€/ |y| , z Â· y =Ï€.
Then
R
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx = 1
2
R
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx
âˆ’1
2
R
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’i(x+z)Â·ydx.
(20.48)
Here is why. Note in the second of these integrals,
âˆ’1
2
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’i(x+z)Â·ydx
=
âˆ’1
2
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·yeâˆ’izÂ·ydx
=
âˆ’1
2
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·yeâˆ’iÏ€dx
=
1
2
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx.

20.4.
SINGULAR INTEGRALS
563
Then changing the variables in 20.48,,
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx
=
1
2
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx
âˆ’1
2
Z
3Ï€|y|âˆ’1<|xâˆ’z|â‰¤R
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx.
Thus
R
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx =
1
2
R
|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx âˆ’1
2
R
|xâˆ’z|â‰¤R
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx
+ 1
2
R
|xâˆ’z|â‰¤3Ï€|y|âˆ’1
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx âˆ’1
2
R
|x|â‰¤3Ï€|y|âˆ’1
KÎµ (x) eâˆ’ixÂ·ydx.
(20.49)
Since |z| = Ï€/ |y|, it follows |z| =
Ï€
|y| < 3Ï€
|y| < R and so the following picture
describes the situation. In this picture, the radius of each ball equals either R or
3Ï€ |y|âˆ’1 and each integral above is taken over one of the two balls in the picture,
either the one centered at 0 or the one centered at z.
0
z
t
t
To begin with, consider the integrals which involve KÎµ (x âˆ’z).
R
|xâˆ’z|â‰¤R
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx
=
R
|x|â‰¤R
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx
âˆ’
R
|xâˆ’z|>R,|x|<R
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx
+
R
|xâˆ’z|<R,|x|>R
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx.
(20.50)

564
FOURIER ANALYSIS IN RN AN INTRODUCTION
Look at the picture. Similarly,
R
|xâˆ’z|â‰¤3Ï€|y|âˆ’1
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx
=
R
|x|â‰¤3Ï€|y|âˆ’1
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx
âˆ’
R
|xâˆ’z|>3Ï€|y|âˆ’1,|x|<3Ï€|y|âˆ’1
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx+
R
|xâˆ’z|<3Ï€|y|âˆ’1,|x|>3Ï€|y|âˆ’1
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx.
(20.51)
The last integral in 20.50 is taken over a set that is contained in
B (0,R + |z|) \ B (0,R)
illustrated in the following picture as the region between the small ball centered at
0 and the big ball which surrounds the two small balls
0
z
t
t
and so this integral is dominated by
B
Âµ
1
(R âˆ’|z|)n
Â¶
Î± (n) ((R + |z|)n âˆ’Rn),
an expression which converges to 0 as R â†’âˆž. Similarly, the second integral on
the right in 20.50 converges to zero as R â†’âˆž. Now consider the last two integrals
in 20.51. Letting 3Ï€ |y|âˆ’1 play the role of R and using |z| = Ï€/ |y|, these are each
dominated by an expression of the form
B
ï£«
ï£­
1
Â³
3Ï€ |y|âˆ’1 âˆ’|z|
Â´n
ï£¶
ï£¸Î± (n)
Â³Â³
3Ï€ |y|âˆ’1 + |z|
Â´n
âˆ’
Â³
3Ï€ |y|âˆ’1Â´nÂ´
=
B
ï£«
ï£­
1
Â³
3Ï€ |y|âˆ’1 âˆ’Ï€ |y|âˆ’1Â´n
ï£¶
ï£¸Î± (n) Â·
Â³Â³
3Ï€ |y|âˆ’1 + Ï€ |y|âˆ’1Â´n
âˆ’
Â³
3Ï€ |y|âˆ’1Â´nÂ´

20.4.
SINGULAR INTEGRALS
565
= Î± (n) B |y|n
(2Ï€)n
1
|y|n ((4Ï€)n âˆ’(3Ï€)n) = C (n) B.
Returning to 20.49, the terms involving x âˆ’y have now been estimated. Thus,
collecting the terms which have not yet been estimated along with those that have,
B =
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Z
3Ï€|y|âˆ’1<|x|â‰¤R
KÎµ (x) eâˆ’ixÂ·ydx
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤1
2
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Z
|x|<R
KÎµ (x) eâˆ’ixÂ·ydx âˆ’
Z
|x|<R
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx
+
Z
|x|<3Ï€|y|âˆ’1
KÎµ (x âˆ’z) eâˆ’ixÂ·ydx âˆ’
Z
|x|<3Ï€|y|âˆ’1
KÎµ (x) eâˆ’ixÂ·ydx
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
+C (n) B + g (R)
where g (R) â†’0 as R â†’âˆž. Using |z| = Ï€/ |y| again,
B â‰¤1
2
Z
3|z|<|x|<R
|KÎµ (x) âˆ’KÎµ (x âˆ’z)| dx + C (n) B + g (R).
But the integral in the above is dominated by C (n) B by 20.44 which was established
earlier. Therefore, from 20.47,
|FKÎµR| â‰¤C (n) B + g (R)
where g (R) â†’0.
Now KÎµR â†’KÎµ in L2 (Rn) because
||KÎµR âˆ’KÎµ||L2(Rn)
â‰¤
B
Z
|x|>R
1
|x|2n dx
=
B
Z
Snâˆ’1
Z âˆž
R
1
Ïn+1 dÏdÏƒ,
which converges to 0 as R â†’âˆžand so FKÎµR â†’FKÎµ in L2 (Rn) by Plancherelâ€™s
theorem.
Therefore, by taking a subsequence, still denoted by R, FKÎµR (y) â†’
FKÎµ (y) a.e. which shows
|FKÎµ (y)| â‰¤C (n) B a.e.
This proves the lemma.
Corollary 20.16 Suppose 20.40 - 20.42 hold. Then if g âˆˆC1
c (Rn), KÎµâˆ—g converges
uniformly and in Lp (Rn) as Îµ â†’0.

566
FOURIER ANALYSIS IN RN AN INTRODUCTION
Proof:
KÎµ âˆ—g (x) â‰¡
Z
KÎµ (y) g (x âˆ’y) dy.
Let 0 < Î· < Îµ. Then since g âˆˆC1
c (Rn) , there exists a constant, K such that
K |u âˆ’v| â‰¥|g (u) âˆ’g (v)| for all u, v âˆˆRn.
|KÎµ âˆ—g (x) âˆ’KÎ· âˆ—g (x)|
â‰¤
BK
Z
Î·<|y|<Îµ
1
|y|n |y| dy
=
BK
Z
Snâˆ’1
Z Îµ
Î·
dÏdÏƒ = Cn |Îµ âˆ’Î·| .
This proves the corollary.
Theorem 20.17 Suppose 20.40 - 20.42. Then for KÎµ given by 20.43 and p > 1,
there exists a constant A (p, n, B) such that for all f âˆˆLp (Rn),
||KÎµ âˆ—f||p â‰¤A (p, n, B) ||f||p .
(20.52)
Also, for each f âˆˆLp (Rn),
Tf â‰¡lim
Îµâ†’0 KÎµ âˆ—f
(20.53)
exists in Lp (Rn) and for all f âˆˆLp (Rn),
||Tf||p â‰¤A (p, n, B) ||f||p .
(20.54)
Thus T is a linear and continuous map deï¬ned on Lp (Rn) for each p > 1.
Proof: From 20.40 it follows KÎµ âˆˆLpâ€² (Rn) âˆ©L2 (Rn) where, as usual, 1/p +
1/pâ€² = 1. By continuity of translation in Lpâ€² (Rn), x â†’KÎµ âˆ—f (x) is a continuous
function.By Lemma 20.15, ||FKÎµ||âˆžâ‰¤C (n) B for all Îµ. Therefore, by Lemma
20.14,
||KÎµ âˆ—g||p â‰¤A (p, n, B) ||g||p
for all g âˆˆG. Now let f âˆˆLp (Rn) and gk â†’f in Lp (Rn) where gk âˆˆG. Then
|KÎµ âˆ—f (x) âˆ’KÎµ âˆ—gk (x)|
â‰¤
Z
|KÎµ (x âˆ’y)| |gk (y) âˆ’f (y)| dy
â‰¤
||KÎµ||pâ€² ||gk âˆ’f||p
which shows that KÎµ âˆ—gk (x) â†’KÎµ âˆ—f (x) pointwise and so by Fatouâ€™s lemma,
||KÎµ âˆ—f||p
â‰¤
lim inf
kâ†’âˆž||KÎµ âˆ—gk||p â‰¤lim inf
kâ†’âˆžA (p, n, B) ||gk||p
=
A (p, n, B) ||f||p .
This veriï¬es 20.52.
To verify 20.53, let Î´ > 0 be given and let
f âˆˆLp (Rn) , g âˆˆCâˆž
c (Rn) .

20.4.
SINGULAR INTEGRALS
567
||KÎµ âˆ—f âˆ’KÎ· âˆ—f||p
â‰¤
||KÎµ âˆ—(f âˆ’g)||p + ||KÎµ âˆ—g âˆ’KÎ· âˆ—g||p
+ ||KÎ· âˆ—(f âˆ’g)||p
â‰¤2A (p, n, B) ||f âˆ’g||p + ||KÎµ âˆ—g âˆ’KÎ· âˆ—g||p .
Choose g such that 2A (p, n, B) ||f âˆ’g||p â‰¤Î´/2. Then if Îµ, Î· are small enough,
Corollary 20.16 implies the last term is also less than Î´/2. Thus, limÎµâ†’0 KÎµ âˆ—f
exists in Lp (Rn). Let Tf be the element of Lp (Rn) to which it converges. Then
20.54 follows and T is obviously linear because
T (af + bg)
=
lim
Îµâ†’0 KÎµ âˆ—(af + bg) = lim
Îµâ†’0 (aKÎµ âˆ—f + bKÎµ âˆ—g)
=
aTf + bTg.
This proves the theorem.
When do conditions 20.40-20.42 hold? It turns out this happens for K given by
the following.
K (x) â‰¡â„¦(x)
|x|n ,
(20.55)
where
â„¦(Î»x) = â„¦(x) for all Î» > 0,
(20.56)
â„¦is Lipschitz on Snâˆ’1,
Z
Snâˆ’1 â„¦(x) dÏƒ = 0.
(20.57)
Theorem 20.18 For K given by 20.55 - 20.57, it follows there exists a constant
B such that
|K (x)| â‰¤B |x|âˆ’n,
(20.58)
Z
a<|x|<b
K (x) dx = 0,
(20.59)
Z
|x|>2|y|
|K (x âˆ’y) âˆ’K (x)| dx â‰¤B.
(20.60)
Consequently, the conclusions of Theorem 20.17 hold also.
Proof:
20.58 is obvious. To verify 20.59,
Z
a<|x|<b
K (x) dx
=
Z b
a
Z
Snâˆ’1
â„¦(Ïw)
Ïn
Ïnâˆ’1dÏƒdÏ
=
Z b
a
1
Ï
Z
Snâˆ’1 â„¦(w) dÏƒdÏ = 0.
It remains to show 20.60.
K (x âˆ’y) âˆ’K (x)
=
|x âˆ’y|âˆ’n
Âµ
â„¦
Âµ x âˆ’y
|x âˆ’y|
Â¶
âˆ’â„¦
Âµ x
|x|
Â¶Â¶
+â„¦(x)
Âµ
1
|x âˆ’y|n âˆ’
1
|x|n
Â¶
(20.61)

568
FOURIER ANALYSIS IN RN AN INTRODUCTION
where 20.56 was used to write â„¦
Â³
z
|z|
Â´
= â„¦(z). The ï¬rst group of terms in 20.61 is
dominated by
|x âˆ’y|âˆ’n Lip (â„¦)
Â¯Â¯Â¯Â¯
x âˆ’y
|x âˆ’y| âˆ’x
|x|
Â¯Â¯Â¯Â¯
and an estimate is required for |x| > 2 |y|. Since |x| > 2 |y|,
|x âˆ’y|âˆ’n â‰¤(|x| âˆ’|y|)âˆ’n â‰¤2n
|x|n .
Also
Â¯Â¯Â¯Â¯
x âˆ’y
|x âˆ’y| âˆ’x
|x|
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
(x âˆ’y) |x| âˆ’x |x âˆ’y|
|x| |x âˆ’y|
Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯
(x âˆ’y) |x| âˆ’x |x âˆ’y|
|x| (|x| âˆ’|y|)
Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯
(x âˆ’y) |x| âˆ’x |x âˆ’y|
|x| (|x| /2)
Â¯Â¯Â¯Â¯
=
2
|x|2 |x |x| âˆ’y |x| âˆ’x |x âˆ’y|| =
2
|x|2 |x (|x| âˆ’|x âˆ’y|) âˆ’y |x||
â‰¤
2
|x|2 |x| ||x| âˆ’|x âˆ’y|| + |y| |x| â‰¤
2
|x|2 (|x| |xâˆ’(x âˆ’y)| + |y| |x|)
â‰¤
4
|x|2 |x| |y| = 4|y|
|x|.
Therefore,
Z
|x|>2|y|
|x âˆ’y|âˆ’n
Â¯Â¯Â¯Â¯â„¦
Âµ x âˆ’y
|x âˆ’y|
Â¶
âˆ’â„¦
Âµ x
|x|
Â¶Â¯Â¯Â¯Â¯ dx
â‰¤4 (2n)
Z
|x|>2|y|
1
|x|n
|y|
|x|dx Lip (â„¦)
= C (n, Lip â„¦)
Z
|x|>2|y|
|y|
|x|n+1 dx
= C (n, Lip â„¦)
Z
|u|>2
1
|u|n+1 du.
(20.62)
It remains to consider the second group of terms in 20.61 when |x| > 2 |y|.
Â¯Â¯Â¯Â¯
1
|x âˆ’y|n âˆ’
1
|x|n
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
|x|n âˆ’|x âˆ’y|n
|x âˆ’y|n |x|n
Â¯Â¯Â¯Â¯
â‰¤
2n
|x|2n ||x|n âˆ’|x âˆ’y|n|
â‰¤
2n
|x|2n |y|
h
|x|nâˆ’1 + |x|nâˆ’2 |x âˆ’y| +
Â· Â· Â· + |x| |x âˆ’y|nâˆ’2 + |x âˆ’y|nâˆ’1i

20.5.
HELMHOLTZ DECOMPOSITIONS
569
â‰¤2n |y| C (n) |x|nâˆ’1
|x|2n
= C (n) 2n |y|
|x|n+1
.
Thus
Z
|x|>2|y|
Â¯Â¯Â¯Â¯â„¦(x)
Âµ
1
|x âˆ’y|n âˆ’
1
|x|n
Â¶Â¯Â¯Â¯Â¯ dx
â‰¤
C (n)
Z
|x|>2|y|
|y|
|x|n+1 dx
â‰¤C (n)
Z
|u|>2
1
|u|n+1 du.
(20.63)
From 20.62 and 20.63,
Z
|x|>2|y|
|K (x âˆ’y) âˆ’K (x)| dx â‰¤C (n, Lip â„¦).
This proves the theorem.
20.5
Helmholtz Decompositions
It turns out that every vector ï¬eld which has its components in Lp can be written
as a sum of a gradient and a vector ï¬eld which has zero divergence. This is a very
remarkable result, especially when applied to vector ï¬elds which are only in Lp.
Recall that for u a function of n variables, âˆ†u = Pn
i=1
âˆ‚2u
âˆ‚x2
i .
Deï¬nition 20.19 Deï¬ne
Î¦ (y) â‰¡
(
âˆ’1
a1 ln |y| , if n = 2,
1
(nâˆ’2)anâˆ’1 |y|2âˆ’n , if n > 2.
where ak denotes the area of the unit sphere, Sk.
Then it is routine to verify âˆ†Î¦ = 0 away from 0. In fact, if n > 2,
Î¦,ii (y) = Cn
"
1
|y|n âˆ’n
y2
i
|y|n+2
#
, Î¦,ij (y) = Cn
yiyj
|y|n+2 ,
(20.64)
while if n = 2,
Î¦,22 (y) = C2
y2
1 âˆ’y2
2
(y2
1 + y2
2)2 , Î¦,11 (y) = C2
y2
2 âˆ’y2
1
(y2
1 + y2
2)2 ,
Î¦,ij (y) = C2
y1y2
(y2
1 + y2
2)2 .
Also,
âˆ‡Î¦ (y) =
âˆ’y
anâˆ’1 |y|n .
(20.65)
In the above the subscripts following a comma denote partial derivatives.

570
FOURIER ANALYSIS IN RN AN INTRODUCTION
Lemma 20.20 For n â‰¥2
Î¦,ij (y) = â„¦ij (y)
|y|n
where
â„¦ij is Lipschitz continuous on Snâˆ’1,
(20.66)
â„¦ij (Î»y) = â„¦ij (y),
(20.67)
for all Î» > 0, and
Z
Snâˆ’1 â„¦ij (y) dÏƒ = 0.
(20.68)
Proof:
Proof: The case n = 2 is left to the reader. 20.66 and 20.67 are obvious from
the above descriptions. It remains to verify 20.68. If n â‰¥3 and i Ì¸= j, then this
formula is also clear from 20.64. Thus consider the case when n â‰¥3 and i = j. By
symmetry,
I â‰¡
Z
Snâˆ’1 1 âˆ’ny2
i dÏƒ =
Z
Snâˆ’1 1 âˆ’ny2
j dÏƒ.
Hence
nI
=
n
X
i=1
Z
Snâˆ’1 1 âˆ’ny2
i dÏƒ =
Z
Snâˆ’1
Ãƒ
n âˆ’n
X
i
y2
i
!
dÏƒ
=
Z
Snâˆ’1 (n âˆ’n) dÏƒ = 0.
This proves the lemma.
Let U be a bounded open set locally on one side of its boundary having Lipschitz
boundary so the divergence theorem holds and let B = B (0,R) where
B âŠ‡U âˆ’U â‰¡{x âˆ’y : x âˆˆU, y âˆˆU}
Let f âˆˆCâˆž
c (U) and deï¬ne for x âˆˆU,
u (x) â‰¡
Z
B
Î¦ (y) f (x âˆ’y) dy =
Z
U
Î¦ (x âˆ’y) f (y) dy.
Let h (y) = f (x âˆ’y) . Then since Î¦ is in L1 (B),
âˆ†u (x) =
Z
B
Î¦ (y) âˆ†f (x âˆ’y) dy =
Z
B
Î¦ (y) âˆ†h (y) dy
=
Z
B\B(0,Îµ)
âˆ‡Â· (âˆ‡h (y) Î¦ (y)) âˆ’âˆ‡Î¦ (y) Â· âˆ‡h (y) dy
+
Z
B(0,Îµ)
Î¦ (y) âˆ†h (y) dy.

20.5.
HELMHOLTZ DECOMPOSITIONS
571
The last term converges to 0 as Îµ â†’0 because Î¦ is in L1 and âˆ†h is bounded. Since
spt (h) âŠ†B, the divergence theorem implies
âˆ†u (x) = âˆ’
Z
âˆ‚B(0,Îµ)
Î¦ (y) âˆ‡h (y)Â·ndÏƒâˆ’
Z
B\B(0,Îµ)
âˆ‡Î¦ (y)Â·âˆ‡h (y) dy+e (Îµ) (20.69)
where here and below, e (Îµ) â†’0 as Îµ â†’0. The ï¬rst term in 20.69 converges to 0
as Îµ â†’0 because
Â¯Â¯Â¯Â¯Â¯
Z
âˆ‚B(0,Îµ)
Î¦ (y) âˆ‡h (y) Â· ndÏƒ
Â¯Â¯Â¯Â¯Â¯ â‰¤
Â½
Cnh
1
Îµnâˆ’2 Îµnâˆ’1 = CnhÎµ if n > 2
Ch (ln Îµ) Îµ if n = 2
and since âˆ†Î¦ (y) = 0,
âˆ‡Î¦ (y) Â· âˆ‡h (y) = âˆ‡Â· (âˆ‡Î¦ (y) h (y)).
Consequently
âˆ†u (x) = âˆ’
Z
B\B(0,Îµ)
âˆ‡Â· (âˆ‡Î¦ (y) h (y)) dy + e (Îµ).
Thus, by the divergence theorem, 20.65, and the deï¬nition of h above,
âˆ†u (x)
=
Z
âˆ‚B(0,Îµ)
f (x âˆ’y) âˆ‡Î¦ (y) Â· ndÏƒ + e (Îµ)
=
Z
âˆ‚B(0,Îµ)
f (x âˆ’y)
Âµ
âˆ’
y
anâˆ’1 |y|n
Â¶
Â·
Âµ
âˆ’y
|y|
Â¶
dÏƒ + e (Îµ)
=
âˆ’
ÃƒZ
âˆ‚B(0,Îµ)
f (x âˆ’y) dÏƒ (y)
!
1
anâˆ’1Îµnâˆ’1 + e (Îµ).
Letting Îµ â†’0,
âˆ’âˆ†u (x) = f (x).
This proves the following lemma.
Lemma 20.21 Let U be a bounded open set in Rn with Lipschitz boundary and let
B âŠ‡U âˆ’U where B = B (0,R). Let f âˆˆCâˆž
c (U). Then for x âˆˆU,
Z
B
Î¦ (y) f (x âˆ’y) dy =
Z
U
Î¦ (x âˆ’y) f (y) dy,
and it follows that if u is given by one of the above formulas, then for all x âˆˆU,
âˆ’âˆ†u (x) = f (x).
Theorem 20.22 Let f âˆˆLp (U). Then there exists u âˆˆLp (U) whose weak deriva-
tives are also in Lp (U) such that in the sense of weak derivatives,
âˆ’âˆ†u = f.

572
FOURIER ANALYSIS IN RN AN INTRODUCTION
It is given by
u (x) =
Z
B
Î¦ (y) ef (x âˆ’y) dy =
Z
U
Î¦ (x âˆ’y) f (y) dy
(20.70)
where ef denotes the zero extension of f oï¬€of U.
Proof: Let f âˆˆLp (U) and let fk âˆˆCâˆž
c (U) , ||fk âˆ’f||Lp(U) â†’0, and let uk be
given by 20.70 with fk in place of f. Then by Minkowskiâ€™s inequality,
||u âˆ’uk||Lp(U)
=
ÂµZ
U
ÂµZ
B
Î¦ (y)
Â¯Â¯Â¯ ef (x âˆ’y) âˆ’fk (x âˆ’y)
Â¯Â¯Â¯ dy
Â¶p
dx
Â¶1/p
â‰¤
ÃƒZ
B
|Î¦ (y)|
ÂµZ
U
Â¯Â¯Â¯ ef (x âˆ’y) âˆ’fk (x âˆ’y)
Â¯Â¯Â¯
p
dx
Â¶1/p
dy
!
â‰¤
Z
B
|Î¦ (y)| dy ||f âˆ’fk||Lp(U) = C (B) ||f âˆ’fk||Lp(U)
and so uk â†’u in Lp (U). Also
uk,i (x) =
Z
U
Î¦,i (x âˆ’y) fk (y) dy =
Z
B
fk (x âˆ’y) Î¦,i (y) dy.
Now let
wi â‰¡
Z
B
ef (x âˆ’y) Î¦,i (y) dy.
(20.71)
and since Î¦,i âˆˆL1 (B), it follows from Minkowskiâ€™s inequality that
||uk,i âˆ’wi||Lp(U)
â‰¤
ÂµZ
U
ÂµZ
B
Â¯Â¯Â¯fk (x âˆ’y) âˆ’ef (x âˆ’y)
Â¯Â¯Â¯ |Î¦,i (y)| dy
Â¶p
dx
Â¶1/p
â‰¤
Z
B
|Î¦,i (y)|
ÂµZ
U
Â¯Â¯Â¯fk (x âˆ’y) âˆ’ef (x âˆ’y)
Â¯Â¯Â¯
p
dx
Â¶1/p
dy
â‰¤
C (B) ||fk âˆ’f||Lp(U)
and so uk,i â†’wi in Lp (U).
Now let Ï† âˆˆCâˆž
c (U). Then
Z
U
wiÏ†dx = âˆ’lim
kâ†’âˆž
Z
U
ukÏ†,idx = âˆ’
Z
U
uÏ†,idx.
Thus u,i = wi âˆˆLp (Rn) and so if Ï† âˆˆCâˆž
c (U),
Z
U
fÏ†dx = lim
kâ†’âˆž
Z
U
fkÏ†dx = lim
kâ†’âˆž
Z
U
âˆ‡uk Â· âˆ‡Ï†dx =
Z
U
âˆ‡u Â· âˆ‡Ï†dx
and so âˆ’âˆ†u = f as claimed. This proves the theorem.

20.5.
HELMHOLTZ DECOMPOSITIONS
573
One could also ask whether the second weak partial derivatives of u are in
Lp (U). This is where the theory singular integrals is used. Recall from 20.70 and
20.71 along with the argument of the above lemma, that if u is given by 20.70, then
u,i is given by 20.71 which equals
Z
U
Î¦,i (x âˆ’y) f (y) dy.
Lemma 20.23 Let f âˆˆLp (U) and let
wi (x) â‰¡
Z
U
Î¦,i (x âˆ’y) f (y) dy.
Then wi,j âˆˆLp (U) for each j = 1 Â· Â· Â· n and the map f â†’wi,j is continuous and
linear on Lp (U).
Proof: First let f âˆˆCâˆž
c (U). For such f,
wi (x)
=
Z
U
Î¦,i (x âˆ’y) f (y) dy =
Z
Rn Î¦,i (x âˆ’y) f (y) dy
=
Z
Rn Î¦,i (y) f (x âˆ’y) dy =
Z
B
Î¦,i (y) f (x âˆ’y) dy
and
wi,j (x)
=
Z
B
Î¦,i (y) f,j (x âˆ’y) dy
=
Z
B\B(0,Îµ)
Î¦,i (y) f,j (x âˆ’y) dy +
Z
B(0,Îµ)
Î¦,i (y) f,j (x âˆ’y) dy.
The second term converges to 0 because f,j is bounded and by 20.65, Î¦,i âˆˆL1
loc.
Thus
wi,j (x)
=
Z
B\B(0,Îµ)
Î¦,i (y) f,j (x âˆ’y) dy + e (Îµ)
=
Z
B\B(0,Îµ)
âˆ’(Î¦,i (y) f (x âˆ’y)),j + Î¦,ij (y) f (x âˆ’y) dy + e (Îµ)
where e (Îµ) â†’0 as Îµ â†’0. Using the divergence theorem, this yields
wi,j (x) =
Z
âˆ‚B(0,Îµ)
Î¦,i (y) f (x âˆ’y) njdÏƒ +
Z
B\B(0,Îµ)
Î¦,ij (y) f (x âˆ’y) dy + e (Îµ).
Consider the ï¬rst term on the right. This term equals, after letting y = Îµz,
Îµnâˆ’1
Z
âˆ‚B(0,1)
Î¦,i (Îµz) f (xâˆ’Îµz) njdÏƒ
=
CnÎµnâˆ’1
Z
âˆ‚B(0,1)
Îµ1âˆ’nzizjf (xâˆ’Îµz) dÏƒ (z)
=
Cn
Z
âˆ‚B(0,1)
zizjf (xâˆ’Îµz) dÏƒ (z)

574
FOURIER ANALYSIS IN RN AN INTRODUCTION
and this converges to 0 if i Ì¸= j and it converges to
Cnf (x)
Z
âˆ‚B(0,1)
z2
i dÏƒ (z)
if i = j. Thus
wi,j (x) = CnÎ´ijf (x) +
Z
B\B(0,Îµ)
Î¦,ij (y) f (x âˆ’y) dy + e (Îµ).
Letting
Î¦Îµ
ij â‰¡
Â½
0 if |y| < Îµ,
Î¦,ij (y) if |y| â‰¥Îµ,
it follows
wi,j (x) = CnÎ´ijf (x) + Î¦Îµ
ij âˆ—ef (x) + e (Îµ) .
By the theory of singular integrals, there exists a continuous linear map, Kij âˆˆ
L (Lp (Rn) , Lp (Rn)) such that
Kijf â‰¡lim
Îµâ†’0 Î¦Îµ
ij âˆ—f.
Therefore, letting Îµ â†’0,
wi,j = CnÎ´ijf + Kij ef
whenever f âˆˆCâˆž
c (U).
Now let f âˆˆLp (U), let
||fk âˆ’f||Lp(U) â†’0,
where fk âˆˆCâˆž
c (U), and let
wk
i (x) =
Z
U
Î¦,i (x âˆ’y) fk (y) dy.
Then it follows as before that wk
i â†’wi in Lp (U) and
wk
i,j = CnÎ´ijfk + Kij efk.
Now let Ï† âˆˆCâˆž
c (U).
wi,j (Ï†)
â‰¡
âˆ’
Z
U
wiÏ†,jdx = âˆ’lim
kâ†’âˆž
Z
U
wk
i Ï†,jdx
=
lim
kâ†’âˆž
Z
U
wk
i,jÏ†dx = lim
kâ†’âˆž
Z
U
Â³
CnÎ´ij efk + Kij efk
Â´
Ï†dx
=
Z
U
Â³
CnÎ´ij ef + Kij ef
Â´
Ï†dx.
It follows
wi,j = CnÎ´ij ef + Kij ef
and this proves the lemma.

20.5.
HELMHOLTZ DECOMPOSITIONS
575
Corollary 20.24 In the situation of Theorem 20.22, all weak derivatives of u of
order 2 are in Lp (U) and also f â†’u,ij is a continuous map.
Proof:
u,i (x) =
Z
U
Î¦,i (x âˆ’y) f (y) dy
and so u,ij âˆˆLp (U) and f â†’u,ij is continuous by Lemma 20.23.
With this preparation, it is possible to consider the Helmholtz decomposition.
Let F âˆˆLp (U; Rn) and deï¬ne
Ï† (x) â‰¡
Z
U
âˆ‡Î¦ (x âˆ’y) Â· F (y) dy.
(20.72)
Then by Lemma 20.23,
Ï†,j = Cn eFj +
X
i
Kij eFi âˆˆLp (Rn)
and the mapping F â†’âˆ‡Ï† is continuous from Lp (U; Rn) to Lp (U; Rn).
Now suppose F âˆˆCâˆž
c (U; Rn). Then
Ï† (x)
=
Z
U
n
X
i=1
âˆ’âˆ‚
âˆ‚yi (Î¦ (x âˆ’y) Fi (y)) + Î¦ (x âˆ’y) âˆ‡Â· F (y) dy
=
Z
U
Î¦ (x âˆ’y) âˆ‡Â· F (y) dy
and so by Lemma 20.21,
âˆ‡Â· âˆ‡Ï† = âˆ†Ï† = âˆ’âˆ‡Â· F.
This continues to hold in the sense of weak derivatives if F is only in Lp (U; Rn)
because by Minkowskiâ€™s inequality and 20.72 the map F â†’Ï† is continuous. Also
note that for F âˆˆCâˆž
c (U; Rn),
Ï† (x) =
Z
B
Î¦ (y) âˆ‡Â· F (x âˆ’y) dy.
Next deï¬ne Ï€ : Lp (U; Rn) â†’Lp (U; Rn) by
Ï€F = âˆ’âˆ‡Ï†, Ï† (x) =
Z
U
âˆ‡Î¦ (x âˆ’y) Â· F (y) dy.
It was already shown that Ï€ is continuous, linear, and âˆ‡Â· Ï€F =âˆ‡Â· F. It is also true
that Ï€ is a projection. To see this, let F âˆˆCâˆž
c (U; Rn). Then for B large enough,
Ï€2F (x)
=
âˆ’âˆ‡
Z
B
Î¦ (z) âˆ‡Â· Ï€F (x âˆ’z) dz
=
âˆ’âˆ‡
Z
B
Î¦ (z) âˆ‡Â· âˆ‡
Z
B
Î¦ (w) âˆ‡Â· F (x âˆ’z âˆ’w) dwdz
=
âˆ’âˆ‡
Z
B
Î¦ (z) âˆ‡Â· F (x âˆ’z) dz = Ï€F (x).

576
FOURIER ANALYSIS IN RN AN INTRODUCTION
Since Ï€ is continuous and Câˆž
c (U; Rn) is dense in Lp (U; Rn), Ï€2F =Ï€F for all F âˆˆ
Lp (U; Rn). This proves the following theorem which is the Helmholtz decomposi-
tion.
Theorem 20.25 There exists a continuous projection
Ï€ : Lp (U; Rn) â†’Lp (U; Rn)
such that Ï€F is a gradient and
âˆ‡Â· (Fâˆ’Ï€F) = 0
in the sense of weak derivatives.
Note this theorem shows that any Lp vector ï¬eld is the sum of a gradient and a
part which is divergence free. F = Fâˆ’Ï€F+Ï€F.

The Bochner Integral
21.1
Strong And Weak Measurability
In this chapter (â„¦, S,Âµ) will be a Ïƒ ï¬nite measure space and X will be a Banach
space which contains the values of either a function or a measure. The Banach
space will be either a real or a complex Banach space but the ï¬eld of scalars does
not matter and so it is denoted by F with the understanding that F = C unless
otherwise stated. The theory presented here includes the case where X = Rn or
Cn but it does not include the situation where f could have values in a space like
[0, âˆž]. To begin with here is a deï¬nition.
Deï¬nition 21.1 A function, x : â„¦â†’X, for X a Banach space, is a simple
function if it is of the form
x (s) =
n
X
i=1
aiXBi (s)
where Bi âˆˆS and Âµ (Bi) < âˆžfor each i. A function x from â„¦to X is said to be
strongly measurable if there exists a sequence of simple functions {xn} converging
pointwise to x. The function x is said to be weakly measurable if, for each f âˆˆXâ€²,
f â—¦x
is a scalar valued measurable function.
Earlier, a function was measurable if inverse images of open sets were measur-
able. Something similar holds here. The diï¬€erence is that another condition needs
to hold.
Theorem 21.2 x is strongly measurable if and only if xâˆ’1 (U) is measurable for
all U open in X and x (â„¦) is separable.
Proof: Suppose ï¬rst xâˆ’1 (U) is measurable for all U open in X and x (â„¦)
is separable.
Let {an}âˆž
n=1 be the dense subset of x (â„¦).
It follows xâˆ’1 (B) is
measurable for all B Borel because
{B : xâˆ’1 (B) is measurable}
577

578
THE BOCHNER INTEGRAL
is a Ïƒ algebra containing the open sets. Let
U n
k â‰¡{z âˆˆX : ||z âˆ’ak|| â‰¤min{||z âˆ’al||n
l=1}}.
In words, U m
k is the set of points of X which are as close to ak as they are to any
of the al for l â‰¤n.
Bn
k â‰¡xâˆ’1 (U n
k ) , Dn
k â‰¡Bn
k \
Â¡
âˆªkâˆ’1
i=1 Bn
i
Â¢
, Dn
1 â‰¡Bn
1 ,
and
xn (s) â‰¡
n
X
k=1
akXDn
k (s).
Thus xn (s) is a closest approximation to x (s) from {ak}n
k=1 and so xn (s) â†’x (s)
because {an}âˆž
n=1 is dense in x (â„¦). Furthermore, xn is measurable because each Dn
k
is measurable.
Since (â„¦, S, Âµ) is Ïƒ ï¬nite, there exists â„¦n â†‘â„¦with Âµ (â„¦n) < âˆž. Let
yn (s) â‰¡Xâ„¦n (s) xn (s).
Then yn (s) â†’x (s) for each s because for any s, s âˆˆâ„¦n if n is large enough. Also
yn is a simple function because it equals 0 oï¬€a set of ï¬nite measure.
Now suppose that x is strongly measurable.
Then some sequence of simple
functions, {xn}, converges pointwise to x. Then xâˆ’1
n (W) is measurable for every
open set W because it is just a ï¬nite union of measurable sets. Thus, xâˆ’1
n (W) is
measurable for every Borel set W. This follows by considering
Â©
W : xâˆ’1
n (W) is measurable
Âª
and observing this is a Ïƒ algebra which contains the open sets. Since X is a metric
space, it follows that if U is an open set in X , there exists a sequence of open sets,
{Vn} which satisï¬es
V n âŠ†U, V n âŠ†Vn+1, U = âˆªâˆž
n=1Vn.
Then
xâˆ’1 (Vm) âŠ†
[
n<âˆž
\
kâ‰¥n
xâˆ’1
k
(Vm) âŠ†xâˆ’1 Â¡
V m
Â¢
.
This implies
xâˆ’1 (U) =
[
m<âˆž
xâˆ’1 (Vm)
âŠ†
[
m<âˆž
[
n<âˆž
\
kâ‰¥n
xâˆ’1
k
(Vm) âŠ†
[
m<âˆž
xâˆ’1 Â¡
V m
Â¢
âŠ†xâˆ’1 (U).
Since
xâˆ’1 (U) =
[
m<âˆž
[
n<âˆž
\
kâ‰¥n
xâˆ’1
k
(Vm),

21.1.
STRONG AND WEAK MEASURABILITY
579
it follows that xâˆ’1 (U) is measurable for every open U. It remains to show x (â„¦) is
separable. Let
D â‰¡all values of the simple functions xn
which converge to x pointwise. Then D is clearly countable and dense in D, a set
which contains x (â„¦).
Claim: x (â„¦) is separable.
Proof of claim: For n âˆˆN, let Bn â‰¡
Â©
B (d, r) : 0 < r < 1
n, r rational, d âˆˆD
Âª
.
Thus Bn is countable. Let z âˆˆD. Consider B
Â¡
z, 1
n
Â¢
. Then there exists d âˆˆD âˆ©
B
Â¡
z, 1
3n
Â¢
. Now pick r âˆˆQ âˆ©
Â¡ 1
3n, 1
n
Â¢
so that B (d, r) âˆˆBn. Now z âˆˆB (d, r) and so
this shows that x (â„¦) âŠ†D âŠ†âˆªBn for each n. Now let Bâ€²
n denote those sets of Bn
which have nonempty intersection with x (â„¦) . Say Bâ€²
n = {Bn
k }âˆž
n,k=1 . By the axiom
of choice, there exists xn
k âˆˆBn
k âˆ©x (â„¦) . Then if z âˆˆx (â„¦) , z is contained in some set
of Bâ€²
n which also contains a point of {xn
k}âˆž
n,k=1 . Therefore, z is at least as close as
2/n to some point of {xn
k}âˆž
n,k=1 which shows {xn
k}âˆž
n,k=1 is a countable dense subset
of x (â„¦) . Therefore x (â„¦) is separable. This proves the theorem.
The last part also shows that a subset of a separable metric space is also sepa-
rable. Therefore, the following simple corollary is obtained.
Corollary 21.3 If X is a separable Banach space then x is strongly measurable if
and only if xâˆ’1 (U) is measurable for all U open in X.
The next lemma is interesting for its own sake. Roughly it says that if a Banach
space is separable, then the unit ball in the dual space is weak âˆ—separable. This
will be used to prove Pettisâ€™s theorem, one of the major theorems in this subject
which relates weak measurability to strong measurability.
Lemma 21.4 If X is a separable Banach space with Bâ€² the closed unit ball in Xâ€²,
then there exists a sequence {fn}âˆž
n=1 â‰¡Dâ€² âŠ†Bâ€² with the property that for every
x âˆˆX,
||x|| = sup
fâˆˆDâ€² |f (x)|
Proof: Let {ak} be a countable dense set in X and consider the mapping
Ï†n : Bâ€² â†’Fn
given by
Ï†n (f) â‰¡(f (a1) , Â· Â· Â·, f (an)) .
Then Ï†n (Bâ€²) is contained in a compact subset of Fn because |f (ak)| â‰¤||ak|| .
Therefore, there exists a countable dense subset of Ï†n (Bâ€²) , {Ï†n (f n
k )}âˆž
k=1 . Let Dâ€²
n â‰¡
{f n
k }âˆž
k=1 . Let
Dâ€² â‰¡âˆªâˆž
k=1Dâ€²
k.
It remains to show this works. Letting x âˆˆX and Îµ > 0 be given, there exists am
such that ||am âˆ’x|| < Îµ. Then by the usual argument involving the Hahn Banach

580
THE BOCHNER INTEGRAL
theorem, there exists fx âˆˆBâ€² such that ||x|| = fx (x) . Letting n > m, let g âˆˆBâ€² be
one of the f n
k with {Ï†n (f n
k )}âˆž
k=1 a dense subset of Ï†n (Bâ€²) such that
|g (am) âˆ’fx (am)| < Îµ.
Then
||x||
=
|fx (x)| = |fx (am) + fx (x) âˆ’fx (am)|
â‰¤
|fx (am)| + Îµ â‰¤|g (am)| + 2Îµ â‰¤|g (x)| + 3Îµ
and so since Îµ > 0 is arbitrary,
||x|| â‰¤sup
gâˆˆDâ€² |g (x)| â‰¤||x||
and this proves the lemma.
The next theorem is one of the most important results in the subject. It is due
to Pettis and appeared in 1938.
Theorem 21.5 If x has values in a separable Banach space, X, and if x is weakly
measurable, then x is strongly measurable.
Proof:
It is necessary to show xâˆ’1 (U) is measurable whenever U is open.
Since every open set is a countable union of balls, it suï¬ƒces to show xâˆ’1 (B (a, r))
is measurable for any ball, B (a, r) . Since every open ball is the countable union of
closed balls, it suï¬ƒces to verify xâˆ’1 Â³
B (a, r)
Â´
is measurable. From Lemma 21.4
xâˆ’1 Â³
B (a, r)
Â´
=
{s : ||x (s) âˆ’a|| â‰¤r}
=
(
s : sup
fâˆˆDâ€² |f (x (s) âˆ’a)| â‰¤r
)
=
âˆ©fâˆˆDâ€² {s : |f (x (s) âˆ’a)| â‰¤r}
=
âˆ©fâˆˆDâ€² {s : |f (x (s)) âˆ’f (a)| â‰¤r}
=
âˆ©fâˆˆDâ€² (f â—¦x)âˆ’1 B (f (a) , r)
which equals a countable union of measurable sets because it is assumed that f â—¦x
is measurable for all f âˆˆXâ€². This proves the theorem.
The same method of proof yields the following interesting corollary.
Corollary 21.6 Let X be a separable Banach space and let B (X) denote the Ïƒ
algebra of Borel sets. Then B (X) = F where F is the smallest Ïƒ algebra of subsets
of X which has the property that every function, xâˆ—âˆˆXâ€² is F measurable.
Proof: First I need to show F contains open balls because then F will contain
the open sets, since every open set is a countable union of open balls, which will
imply F âŠ‡B (X). As noted above, it suï¬ƒces to verify F contains the closed balls

21.1.
STRONG AND WEAK MEASURABILITY
581
because every open ball is a countable union of closed balls.
Let Dâ€² be those
functionals in Bâ€² deï¬ned in Lemma 21.4. Then
{x : ||x âˆ’a|| â‰¤r}
=
Â½
x : sup
xâˆ—âˆˆDâ€² |xâˆ—(x âˆ’a)| â‰¤r
Â¾
=
âˆ©xâˆ—âˆˆDâ€² {x : |xâˆ—(x âˆ’a)| â‰¤r}
=
âˆ©xâˆ—âˆˆDâ€² {x : |xâˆ—(x) âˆ’xâˆ—(a)| â‰¤r}
=
âˆ©xâˆ—âˆˆDâ€²xâˆ—âˆ’1 Â³
B (xâˆ—(a) , r)
Â´
which is measurable because this is a countable intersection of measurable sets.
Thus F contains open sets so F âŠ‡B (X) .
To show the other direction for the inclusion, note that each xâˆ—is B (X) mea-
surable because xâˆ—âˆ’1 (open set) = open set. Therefore, B (X) is a Ïƒ algebra with
respect to which each xâˆ—is measurable and F is the smallest of these so B (X) âŠ‡F.
This proves the corollary.
It is important to verify the limit of strongly measurable functions is itself
strongly measurable.
This happens under very general conditions.
Suppose X
is any separable metric space and let Ï„ denote the open sets of X. Then it is routine
to see that
Ï„ has a countable basis, B.
(21.1)
Whenever U âˆˆB, there exists a sequence of open sets, {Vm}âˆž
m=1, such that
Â· Â· Â· Vm âŠ†V m âŠ†Vm+1 âŠ†Â· Â· Â· , U =
âˆž
[
m=1
Vm.
(21.2)
Theorem 21.7 Let fn and f be functions mapping â„¦to X where F is a Ïƒ algebra
of measurable sets of â„¦and (X, Ï„) is a topological space satisfying 21.1 - 21.2. Then
if fn is measurable, and f(Ï‰) = limnâ†’âˆžfn(Ï‰), it follows that f is also measurable.
(Pointwise limits of measurable functions are measurable.)
Proof: Let B be the countable basis of 21.1 and let U âˆˆB. Let {Vm} be the
sequence of 21.2. Since f is the pointwise limit of fn,
f âˆ’1(Vm) âŠ†{Ï‰ : fk(Ï‰) âˆˆVm for all k large enough} âŠ†f âˆ’1(Vm).
Therefore,
f âˆ’1(U) = âˆªâˆž
m=1f âˆ’1(Vm) âŠ†âˆªâˆž
m=1 âˆªâˆž
n=1 âˆ©âˆž
k=nf âˆ’1
k (Vm)
âŠ†âˆªâˆž
m=1f âˆ’1(Vm) = f âˆ’1(U).
It follows f âˆ’1(U) âˆˆF because it equals the expression in the middle which is
measurable. Now let W âˆˆÏ„. Since B is countable, W = âˆªâˆž
n=1Un for some sets
Un âˆˆB. Hence
f âˆ’1(W) = âˆªâˆž
n=1f âˆ’1(Un) âˆˆF.
This proves the theorem.

582
THE BOCHNER INTEGRAL
Corollary 21.8 x is strongly measurable if and only if x (â„¦) is separable and x is
weakly measurable.
Proof: Strong measurability clearly implies weak measurability. If xn (s) â†’
x (s) where xn is simple, then f (xn (s)) â†’f (x (s)) for all f âˆˆXâ€². Hence f â—¦x
is measurable by Theorem 21.7 because it is the limit of a sequence of measurable
functions. Let D denote the set of all values of xn. Then D is a separable set
containing x (â„¦). Thus D is a separable metric space. Therefore x (â„¦) is separable
also by the last part of the proof of Theorem 21.2.
Now suppose D is a countable dense subset of x (â„¦) and x is weakly measurable.
Let Z be the subset consisting of all ï¬nite linear combinations of D with the scalars
coming from the set of rational points of F. Thus, Z is countable. Letting Y = Z,
Y is a separable Banach space containing x (â„¦). If f âˆˆY â€², f can be extended to an
element of Xâ€² by the Hahn Banach theorem. Therefore, x is a weakly measurable
Y valued function. Now use Theorem 21.5 to conclude x is strongly measurable.
This proves the corollary.
Weakly measurable as deï¬ned above means s â†’xâˆ—(x (s)) is measurable for
every xâˆ—âˆˆXâ€². The next lemma ties this to the usual version of measurability in
which a function is measurable when inverse images of open sets are measurable.
Lemma 21.9 Let X be a Banach space and let x : (â„¦, F) â†’K âŠ†X where K is
weakly compact and Xâ€² is separable. Then x is weakly measurable if and only if
xâˆ’1 (U) âˆˆF whenever U is a weakly open set.
Proof: By Corollary 13.41 on Page 358, there exists a metric d, such that the
metric space topology with respect to d coincides with the weak topology. Since
K is compact, it follows that K is also separable. Hence it is completely separable
and so there exists a countable basis of open sets, B for the weak topology on K. It
follows that if U is any weakly open set, covered by basic sets of the form BA (x, r)
where A is a ï¬nite subset of Xâ€², there exists a countable collection of these sets of
the form BA (x, r) which covers U.
Suppose now that x is weakly measurable. To show xâˆ’1 (U) âˆˆF whenever U
is weakly open, it suï¬ƒces to verify xâˆ’1 (BA (z, r)) âˆˆF for any set, BA (z, r) . Let
A = {xâˆ—
1, Â· Â· Â·, xâˆ—
m} . Then
xâˆ’1 (BA (z, r))
=
{s âˆˆâ„¦: ÏA (x (s) âˆ’z) < r}
â‰¡
Â½
s âˆˆâ„¦: max
xâˆ—âˆˆA |xâˆ—(x (s) âˆ’z)| < r
Â¾
=
âˆªm
i=1 {s âˆˆâ„¦: |xâˆ—
i (x (s) âˆ’z)| < r}
=
âˆªm
i=1 {s âˆˆâ„¦: |xâˆ—
i (x (s)) âˆ’xâˆ—
i (z)| < r}
which is measurable because each xâˆ—
i â—¦x is given to be measurable.
Next suppose xâˆ’1 (U) âˆˆF whenever U is weakly open. Then in particular this
holds when U = Bxâˆ—(z, r) for arbitrary xâˆ—. Hence
{s âˆˆâ„¦: x (s) âˆˆBxâˆ—(z, r)} âˆˆF.

21.1.
STRONG AND WEAK MEASURABILITY
583
But this says the same as
{s âˆˆâ„¦: |xâˆ—(x (s)) âˆ’xâˆ—(z)| < r} âˆˆF
Since xâˆ—(z) can be a completely arbitrary element of F, it follows xâˆ—â—¦x is an F
valued measurable function. In other words, x is weakly measurable according to
the former deï¬nition. This proves the lemma.
One can also deï¬ne weak âˆ—measurability and prove a theorem just like the
Pettis theorem above. The next lemma is the analogue of Lemma 21.4.
Lemma 21.10 Let B be the closed unit ball in X. If Xâ€² is separable, there exists
a sequence {xm}âˆž
m=1 â‰¡D âŠ†B with the property that for all yâˆ—âˆˆXâ€²,
||yâˆ—|| = sup
xâˆˆD
|yâˆ—(x)| .
Proof:
Let
{xâˆ—
k}âˆž
k=1
be the dense subspace of Xâ€². Deï¬ne Ï†n : B â†’Fn by
Ï†n (x) â‰¡(xâˆ—
1 (x) , Â· Â· Â·, xâˆ—
n (x)).
Then |xâˆ—
k (x)| â‰¤||xâˆ—
k|| and so Ï†n (B) is contained in a compact subset of Fn.
Therefore, there exists a countable set, Dn âŠ†B such that Ï†n (Dn) is dense in
Ï†n (B) . Let
D â‰¡âˆªâˆž
n=1Dn.
It remains to verify this works. Let yâˆ—âˆˆXâ€². Then there exists y such that
|yâˆ—(y)| > ||yâˆ—|| âˆ’Îµ.
By density, there exists one of the xâˆ—
k from the countable dense subset of Xâ€² such
that also
|xâˆ—
k (y)| > ||yâˆ—|| âˆ’Îµ, ||xâˆ—
k âˆ’yâˆ—|| < Îµ.
Now xâˆ—
k (y) âˆˆÏ†k (B) and so there exists x âˆˆDk âŠ†D such that
|xâˆ—
k (x)| > ||yâˆ—|| âˆ’Îµ.
Then since ||xâˆ—
k âˆ’yâˆ—|| < Îµ, this implies
|yâˆ—(x)| â‰¥||yâˆ—|| âˆ’2Îµ.
Since Îµ > 0 is arbitrary,
||yâˆ—|| â‰¤sup
xâˆˆD
|yâˆ—(x)| â‰¤||yâˆ—||
and this proves the lemma.
The next theorem is another version of the Pettis theorem.
First here is a
deï¬nition.

584
THE BOCHNER INTEGRAL
Deï¬nition 21.11 A function y having values in Xâ€² is weak âˆ—measurable, when
for each x âˆˆX, y (Â·) (x) is a measurable scalar valued function.
Theorem 21.12 If Xâ€² is separable and y : â„¦â†’Xâ€² is weak âˆ—measurable, then y
is strongly measurable.
Proof:
It is necessary to show yâˆ’1 (B (aâˆ—, r)) is measurable. This will suï¬ƒce
because the separability of Xâ€² implies every open set is the countable union of such
balls of the form B (aâˆ—, r). It also suï¬ƒces to verify inverse images of closed balls
are measurable because every open ball is the countable union of closed balls. From
Lemma 21.10,
yâˆ’1 Â³
B (aâˆ—, r)
Â´
=
{s : ||y (s) âˆ’aâˆ—|| â‰¤r}
=
Â½
s : sup
xâˆˆD
|(y (s) âˆ’aâˆ—) (x)| â‰¤r
Â¾
=
Â½
s : sup
xâˆˆD
|y (s) (x) âˆ’aâˆ—(x)| â‰¤r
Â¾
=
âˆ©xâˆˆDy (Â·) (x)âˆ’1 Â³
B (aâˆ—(x) , r)
Â´
which is a countable intersection of measurable sets by hypothesis. This proves the
theorem.
The following are interesting consequences of the theory developed so far and
are of interest independent of the theory of integration of vector valued functions.
Theorem 21.13 If Xâ€² is separable, then so is X.
Proof:
Let D = {xm} âŠ†B, the unit ball of X, be the sequence promised
by Lemma 21.10. Let V be all ï¬nite linear combinations of elements of {xm} with
rational scalars. Thus V is a separable subspace of X. The claim is that V = X.
If not, there exists
x0 âˆˆX \ V .
But by the Hahn Banach theorem there exists xâˆ—
0 âˆˆXâ€² satisfying xâˆ—
0 (x0) Ì¸= 0, but
xâˆ—
0 (v) = 0 for every v âˆˆV . Hence
||xâˆ—
0|| = sup
xâˆˆD
|xâˆ—
0 (x)| = 0,
a contradiction. This proves the theorem.
Corollary 21.14 If X is reï¬‚exive, then X is separable if and only if Xâ€² is separa-
ble.
Proof: From the above theorem, if Xâ€² is separable, then so is X. Now suppose
X is separable with a dense subset equal to D. Then since X is reï¬‚exive, J (D) is
dense in Xâ€²â€² where J is the James map satisfying Jx (xâˆ—) â‰¡xâˆ—(x) . Then since Xâ€²â€²
is separable, it follows from the above theorem that Xâ€² is also separable.

21.2.
THE BOCHNER INTEGRAL
585
21.2
The Bochner Integral
21.2.1
Deï¬nition And Basic Properties
Deï¬nition 21.15 Let ak âˆˆX, a Banach space and let
x (s) =
n
X
k=1
akXEk (s)
(21.3)
where for each k, Ek is measurable and Âµ (Ek) < âˆž. Then deï¬ne
Z
â„¦
x (s) dÂµ â‰¡
n
X
k=1
akÂµ (Ek).
Proposition 21.16 Deï¬nition 21.15 is well deï¬ned.
Proof: It suï¬ƒces to verify that if
n
X
k=1
akXEk (s) = 0,
then
n
X
k=1
akÂµ (Ek) = 0.
Let f âˆˆXâ€². Then
f
Ãƒ n
X
k=1
akXEk (s)
!
=
n
X
k=1
f (ak) XEk (s) = 0
and, therefore,
0 =
Z
â„¦
Ãƒ n
X
k=1
f (ak) XEk (s)
!
dÂµ =
n
X
k=1
f (ak) Âµ (Ek) = f
Ãƒ n
X
k=1
akÂµ (Ek)
!
.
Since f âˆˆXâ€² is arbitrary, and Xâ€² separates the points of X, it follows that
n
X
k=1
akÂµ (Ek) = 0
as claimed. This proves the proposition.
It follows easily from this proposition that
R
â„¦dÂµ is well deï¬ned and linear on
simple functions.

586
THE BOCHNER INTEGRAL
Deï¬nition 21.17 A strongly measurable function x is Bochner integrable if there
exists a sequence of simple functions xn converging to x pointwise and satisfying
Z
â„¦
||xn (s) âˆ’xm (s)|| dÂµ â†’0 as m, n â†’âˆž.
(21.4)
If x is Bochner integrable, deï¬ne
Z
â„¦
x (s) dÂµ â‰¡lim
nâ†’âˆž
Z
â„¦
xn (s) dÂµ.
(21.5)
Theorem 21.18 The Bochner integral is well deï¬ned and if x is Bochner integrable
and f âˆˆXâ€²,
f
ÂµZ
â„¦
x (s) dÂµ
Â¶
=
Z
â„¦
f (x (s)) dÂµ
(21.6)
and
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
x (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤
Z
â„¦
||x (s)|| dÂµ.
(21.7)
Also, the Bochner integral is linear. That is, if a, b are scalars and x, y are two
Bochner integrable functions, then
Z
â„¦
(ax (s) + by (s)) dÂµ = a
Z
â„¦
x (s) dÂµ + b
Z
â„¦
y (s) dÂµ
(21.8)
Proof: First it is shown that the triangle inequality holds on simple functions
and that the limit in 21.5 exists. Thus, if x is given by 21.3 with the Ek disjoint,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
x (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z
â„¦
n
X
k=1
akXEk (s) dÂµ
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
k=1
akÂµ (Ek)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
â‰¤
n
X
k=1
||ak|| Âµ (Ek) =
Z
â„¦
n
X
k=1
||ak|| XEk (s) dÂµ =
Z
â„¦
||x (s)|| dÂµ
which shows the triangle inequality holds on simple functions. This implies
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
xn (s) dÂµ âˆ’
Z
â„¦
xm (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
(xn (s) âˆ’xm (s)) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
Z
â„¦
||xn (s) âˆ’xm (s)|| dÂµ
which veriï¬es the existence of the limit in 21.5. This completes the ï¬rst part of the
argument.

21.2.
THE BOCHNER INTEGRAL
587
Next it is shown the integral does not depend on the choice of the sequence
satisfying 21.4 so that the integral is well deï¬ned. Suppose yn, xn both satisfy 21.4
and converge to x pointwise. By Fatouâ€™s lemma,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
yndÂµ âˆ’
Z
â„¦
xmdÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤
Z
â„¦
||yn âˆ’x|| dÂµ +
Z
â„¦
||x âˆ’xm|| dÂµ
â‰¤lim inf
kâ†’âˆž
Z
â„¦
||yn âˆ’yk|| dÂµ + lim inf
kâ†’âˆž
Z
â„¦
||xk âˆ’xm||
â‰¤Îµ/2 + Îµ/2
if m and n are chosen large enough. Since Îµ is arbitrary, this shows the limit is the
same for both sequences and demonstrates the Bochner integral is well deï¬ned.
It remains to verify the triangle inequality on Bochner integral functions and
the claim about passing a continuous linear functional inside the integral. Let x be
Bochner integrable and let xn be a sequence which satisï¬es the conditions of the
deï¬nition. Deï¬ne
yn (s) â‰¡
Â½
xn (s) if ||xn (s)|| â‰¤2 ||x (s)||,
0 if ||xn (s)|| > 2 ||x (s)||.
(21.9)
If x (s) = 0 then yn (s) = 0 for all n. If ||x (s)|| > 0 then for all n large enough,
yn (s) = xn (s).
Thus, yn (s) â†’x (s) and
||yn (s)|| â‰¤2 ||x (s)||.
(21.10)
By Fatouâ€™s lemma,
Z
â„¦
||x|| dÂµ â‰¤lim inf
nâ†’âˆž
Z
â„¦
||xn|| dÂµ.
(21.11)
Also from 21.4 and the triangle inequality on simple functions,
Â©R
â„¦||xn|| dÂµ
Âªâˆž
n=1 is
a Cauchy sequence and so it must be bounded. Therefore, by 21.10, 21.11, and the
dominated convergence theorem,
0 =
lim
n,mâ†’âˆž
Z
â„¦
||yn âˆ’ym|| dÂµ
(21.12)
and it follows xn can be replaced with yn in Deï¬nition 21.17.
From Deï¬nition 21.15,
f
ÂµZ
â„¦
yndÂµ
Â¶
=
Z
â„¦
f (yn) dÂµ.
Thus,
f
ÂµZ
â„¦
xdÂµ
Â¶
= lim
nâ†’âˆžf
ÂµZ
â„¦
yndÂµ
Â¶
= lim
nâ†’âˆž
Z
â„¦
f (yn) dÂµ =
Z
â„¦
f (x) dÂµ,

588
THE BOCHNER INTEGRAL
the last equation holding from the dominated convergence theorem and 21.10 and
21.11. This shows 21.6. To verify 21.7,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
x (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ = lim
nâ†’âˆž
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
yn (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤lim
nâ†’âˆž
Z
â„¦
||yn (s)|| dÂµ =
Z
â„¦
||x (s)|| dÂµ
where the last equation follows from the dominated convergence theorem and 21.10,
21.11.
It remains to verify 21.8. Let f âˆˆXâ€². Then from 21.6
f
ÂµZ
â„¦
(ax (s) + by (s)) dÂµ
Â¶
=
Z
â„¦
(af (x (s)) + bf (y (s))) dÂµ
=
a
Z
â„¦
f (x (s)) dÂµ + b
Z
â„¦
f (y (s)) dÂµ
=
f
Âµ
a
Z
â„¦
x (s) dÂµ + b
Z
â„¦
y (s) dÂµ
Â¶
.
Since Xâ€² separates the points of X,it follows
Z
â„¦
(ax (s) + by (s)) dÂµ = a
Z
â„¦
x (s) dÂµ + b
Z
â„¦
y (s) dÂµ
and this proves 21.8. This proves the theorem.
Theorem 21.19 An X valued function, x, is Bochner integrable if and only if x
is strongly measurable and
Z
â„¦
||x (s)|| dÂµ < âˆž.
(21.13)
In this case there exists a sequence of simple functions {yn} satisfying 21.4, yn (s)
converging pointwise to x (s),
||yn (s)|| â‰¤2 ||x (s)||
(21.14)
and
lim
nâ†’âˆž
Z
â„¦
||x (s) âˆ’yn (s)|| dÂµ = 0.
(21.15)
Proof: Suppose x is strongly measurable and condition 21.13 holds. Since x is
strongly measurable, there exists a sequence of simple functions, {xn} converging
pointwise to x. As before, let
yn (s) =
Â½
xn (s) if ||xn (s)|| â‰¤2 ||x (s)||,
0 if ||xn (s)|| > 2 ||x (s)||.
(21.16)

21.2.
THE BOCHNER INTEGRAL
589
Then 21.14 holds for yn and yn (s) â†’x (s) . Also
0 =
lim
m,nâ†’âˆž
Z
â„¦
||yn (s) âˆ’ym (s)|| dÂµ
since otherwise, there would exist Îµ > 0 and NÎµ â†’âˆžas Îµ â†’0 and nÎµ, mÎµ > NÎµ
such that
Z
â„¦
||ynÎµ (s) âˆ’ymÎµ (s)|| dÂµ â‰¥Îµ.
But then taking a limit as Îµ â†’0 and using the dominated convergence theorem
and 21.14 and 21.13, this would imply 0 â‰¥Îµ. Therefore, x is Bochner integrable.
21.15 follows from the dominated convergence theorem and 21.14.
Now suppose x is Bochner integrable. Then it is strongly measurable and there
exists a sequence of simple functions {xn} such that xn (s) converges pointwise to
x and
lim
m,nâ†’âˆž
Z
â„¦
||xn (s) âˆ’xm (s)|| dÂµ = 0.
Therefore, as before, since
Â©R
â„¦xndÂµ
Âªâˆž
n=1 is a Cauchy sequence, it follows
Â½Z
â„¦
||xn|| dÂµ
Â¾âˆž
n=1
is also a Cauchy sequence because
Â¯Â¯Â¯Â¯
Z
â„¦
||xn|| dÂµ âˆ’
Z
â„¦
||xm|| dÂµ
Â¯Â¯Â¯Â¯
â‰¤
Z
â„¦
|||xn|| âˆ’||xm||| dÂµ
â‰¤
Z
â„¦
||xn âˆ’xm|| dÂµ.
Thus
Z
â„¦
||x|| dÂµ â‰¤lim inf
nâ†’âˆž
Z
â„¦
||xn|| dÂµ < âˆž
Using 21.16 it follows yn satisï¬es 21.14, converges pointwise to x and then from the
dominated convergence theorem 21.15 holds. This proves the theorem.
21.2.2
Taking A Closed Operator Out Of The Integral
Now let X and Y be separable Banach spaces and suppose A : D (A) âŠ†X â†’Y be
a closed operator. Recall this means that the graph of A,
G (A) â‰¡{(x, Ax) : x âˆˆD (A)}
is a closed subset of X Ã— Y with respect to the product topology obtained from the
norm
||(x, y)|| = max (||x|| , ||y||) .

590
THE BOCHNER INTEGRAL
Thus also G (A) is a separable Banach space with the above norm. You can also
consider D (A) as a separable Banach space having the norm
||x||D(A) â‰¡max (||x|| , ||Ax||)
(21.17)
which is isometric to G (A) with the mapping, Î¸x â‰¡(x, Ax) .
Lemma 21.20 A closed subspace of a reï¬‚exive Banach space is reï¬‚exive.
Proof: Consider the following diagram in which Y is a closed subspace of the
reï¬‚exive space, X.
Y â€²â€²
iâˆ—âˆ—1-1
â†’
Xâ€²â€²
Y â€²
iâˆ—onto
â†
Xâ€²
Y
iâ†’
X
This diagram follows from theorems on adjoints presented earlier.
Now let yâˆ—âˆ—âˆˆY â€²â€². Then iâˆ—âˆ—yâˆ—âˆ—= Jy because X is reï¬‚exive. I want to show
that y âˆˆY . If it is not in Y then there exists xâˆ—âˆˆXâ€² such that xâˆ—(y) Ì¸= 0 but
xâˆ—(Y ) = 0. Then iâˆ—xâˆ—= 0. Hence
0 = yâˆ—âˆ—(iâˆ—xâˆ—) = iâˆ—âˆ—yâˆ—âˆ—(xâˆ—) = J (y) (xâˆ—) = xâˆ—(y) Ì¸= 0,
a contradiction. Hence y âˆˆY . Since iâˆ—is onto, I want to show that for all xâˆ—âˆˆXâ€²,
iâˆ—xâˆ—(y) = yâˆ—âˆ—(iâˆ—xâˆ—)
because this will imply yâˆ—âˆ—= JY (y) where JY is the James map from Y to Y â€².
However, the above is equivalent to the following holding for all xâˆ—âˆˆXâ€².
iâˆ—xâˆ—(y) = JY (y) (iâˆ—xâˆ—) = iâˆ—âˆ—JY (y) (xâˆ—) = iâˆ—âˆ—yâˆ—âˆ—(xâˆ—)
Since iâˆ—âˆ—is onto, it follows JY (y) = yâˆ—âˆ—and this proves it.
Lemma 21.21 Suppose V and W are reï¬‚exive Banach spaces and that V is a
dense subset of W in the topology of W. Then iâˆ—W â€² is a dense subset of V â€² where
here i is the inclusion map of V into W.
Proof: First note that iâˆ—is one to one. If iâˆ—wâˆ—= 0 for wâˆ—âˆˆW â€², then this
means that for all v âˆˆV,
iâˆ—w (v) = wâˆ—(v) = 0
and since V is dense in W, this shows wâˆ—= 0.
Consider the following diagram
V â€²â€²
iâˆ—âˆ—
â†’
W â€²â€²
V â€²
iâˆ—
â†
W â€²
V
iâ†’
W

21.2.
THE BOCHNER INTEGRAL
591
in which i is the inclusion map. Next suppose iâˆ—W â€² is not dense in V â€². Then there
exists vâˆ—âˆ—âˆˆV â€²â€² such that vâˆ—âˆ—Ì¸= 0 but vâˆ—âˆ—(iâˆ—W â€²) = 0. It follows from V being
reï¬‚exive, that vâˆ—âˆ—= Jv0 where J is the James map from V to V â€²â€²for some v0 âˆˆV .
Thus for every wâˆ—W â€²,
0
=
vâˆ—âˆ—(iâˆ—wâˆ—) = iâˆ—âˆ—vâˆ—âˆ—(wâˆ—)
=
iâˆ—âˆ—Jv0 (wâˆ—) = Jv0 (iâˆ—wâˆ—)
=
iâˆ—wâˆ—(v0) = wâˆ—(v0)
and since W â€² separates the points of W, it follows v0 = 0 which contradicts vâˆ—âˆ—Ì¸= 0.
This proves the lemma.
Note that in the proof, only V reï¬‚exive was used.
This lemma implies an easy corollary.
Corollary 21.22 Let E and F be reï¬‚exive Banach spaces and let A be a closed
operator, A : D (A) âŠ†E â†’F. Suppose also that D (A) is dense in E. Then making
D (A) into a Banach space by using the above graph norm given in 21.17, it follows
that D (A) is a Banach space and iâˆ—Eâ€² is a dense subspace of D (A)â€² .
Proof: First note that E Ã— F is a reï¬‚exive Banach space and G (A) is a closed
subspace of E Ã— F so it is also a reï¬‚exive Banach space. Now D (A) is isometric to
G (A) and so it follows D (A) is a dense subspace of E which is reï¬‚exive. Therefore,
from Lemma 21.21 the conclusion follows.
With this preparation, here is another interesting theorem. This one is about
taking outside the integral a closed linear operator as opposed to a continuous linear
operator.
Theorem 21.23 Let X, Y be separable Banach spaces and let A : D (A) âŠ†X â†’Y
be a closed operator where D (A) is a dense subset of X. Suppose also that iâˆ—Xâ€² is
a dense subspace of D (A)â€² where D (A) is a Banach space having the graph norm
described in 21.17. Suppose that (â„¦, F, Âµ) is a Ïƒ ï¬nite measure space and x : â„¦â†’X
is strongly measurable and it happens that x (s) âˆˆD (A) for all s âˆˆâ„¦. Then x is
strongly measurable as a mapping into D (A). Also Ax is strongly measurable as a
map into Y and if
Z
â„¦
||x (s)|| dÂµ,
Z
â„¦
||Ax (s)|| dÂµ < âˆž,
(21.18)
then
Z
â„¦
x (s) dÂµ âˆˆD (A)
(21.19)
and
A
Z
â„¦
x (s) dÂµ =
Z
â„¦
Ax (s) dÂµ.
(21.20)
Proof: First of all, consider the assertion that x is strongly measurable into
D (A) . Letting f âˆˆD (A)â€² be given, there exists a sequence, {gn} âŠ†iâˆ—Xâ€² such that
gn â†’f in D (A)â€² . Therefore,
s â†’gn (x (s))

592
THE BOCHNER INTEGRAL
is measurable by assumption and
gn (x (s)) â†’f (x (s))
which shows that s â†’f (x (s)) is measurable. By the Pettis theorem, it follows
s â†’x (s)
is strongly measurable as a map into D (A).
It follows from Theorem 21.19 there exists a sequence of simple functions, {xn}
of the form
xn (s) =
mn
X
k=1
an
kXEn
k (s) , xn (s) âˆˆD (A) ,
which converges strongly and pointwise to x (s) in D (A). Thus
xn (s) â†’x (s) , Axn (s) â†’Ax (s) ,
which shows s â†’Ax (s) is stongly measurable in Y as claimed.
It remains to verify the assertions about the integral. 21.18 implies x is Bochner
integrable as a function having values in D (A) with the norm on D (A) described
above. Therefore, by Theorem 21.19 there exists a sequence of simple functions
{yn} having values in D (A) ,
lim
m,nâ†’âˆž
Z
â„¦
||yn âˆ’ym||D(A) dÂµ = 0,
yn (s) converging pointwise to x (s),
||yn (s)||D(A) â‰¤2 ||x (s)||D(A)
and
lim
nâ†’âˆž
Z
â„¦
||x (s) âˆ’yn (s)||D(A) ds = 0.
Therefore,
Z
â„¦
yn (s) dÂµ âˆˆD (A) ,
Z
â„¦
yn (s) dÂµ â†’
Z
â„¦
x (s) dÂµ in X,
and since yn is a simple function and A is linear,
A
Z
â„¦
yn (s) dÂµ =
Z
â„¦
Ayn (s) dÂµ â†’
Z
â„¦
Ax (s) dÂµ in Y.
It follows, since A is a closed operator, that
Z
â„¦
x (s) dÂµ âˆˆD (A)
and
A
Z
â„¦
x (s) dÂµ =
Z
â„¦
Ax (s) dÂµ.
This proves the theorem.
Here is another version of this theorem which has diï¬€erent hypotheses.

21.2.
THE BOCHNER INTEGRAL
593
Theorem 21.24 Let X and Y be separable Banach spaces and let A : D (A) âŠ†
X â†’Y be a closed operator. Also let (â„¦, F, Âµ) be a Ïƒ ï¬nite measure space and let
x : â„¦â†’X be Bochner integrable such that x (s) âˆˆD (A) for all s. Also suppose Ax
is Bochner integrable. Then
Z
AxdÂµ = A
Z
xdÂµ
and
R
xdÂµ âˆˆD (A).
Proof: Consider the graph of A,
G (A) â‰¡{(x, Ax) : x âˆˆD (A)} âŠ†X Ã— Y.
Then since A is closed, G (A) is a closed separable Banach space with the norm
||(x, y)|| â‰¡max (||x|| , ||y||) . Therefore, for gâˆ—âˆˆG (A)â€² , one can apply the Hahn Ba-
nach theorem and obtain (xâˆ—, yâˆ—) âˆˆ(X Ã— Y )â€² such that gâˆ—(x, Ax) = (xâˆ—(x) , yâˆ—(Ax)) .
Now it follows from the assumptions that s â†’(xâˆ—(x (s)) , yâˆ—(Ax (s))) is mea-
surable with values in G (A) . It is also separably valued because this is true of
G (A) . By the Pettis theorem, s â†’(x (s) , A (x (s))) must be strongly measurable.
Also
R
||x (s)|| + ||A (x (s))|| dÂµ < âˆžby assumption and so there exists a sequence
of simple functions having values in G (A) , {(xn (s) , Axn (s))} which converges to
(x (s) , A (s)) pointwise such that
R
||(xn, Axn) âˆ’(x, Ax)|| dÂµ â†’0 in G (A) . Now
for simple functions is it routine to verify that
Z
(xn, Axn) dÂµ
=
ÂµZ
xndÂµ,
Z
AxndÂµ
Â¶
=
ÂµZ
xndÂµ, A
Z
xndÂµ
Â¶
Also
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
xndÂµ âˆ’
Z
xdÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
Z
||xn âˆ’x|| dÂµ
â‰¤
Z
||(xn, Axn) âˆ’(x, Ax)|| dÂµ
which converges to 0. Also
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
AxndÂµ âˆ’
Z
AxdÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯A
Z
xndÂµ âˆ’
Z
AxdÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
Z
||Axn âˆ’Ax|| dÂµ
â‰¤
Z
||(xn, Axn) âˆ’(x, Ax)|| dÂµ
and this converges to 0. Therefore,
R
xndÂµ â†’
R
xdÂµ and A
R
xndÂµ â†’
R
AxdÂµ.
Since each
R
xndÂµ âˆˆD (A) , and A is
closed, this implies
R
xdÂµ âˆˆD (A) and
A
R
xdÂµ =
R
AxdÂµ. This proves the theorem.

594
THE BOCHNER INTEGRAL
21.3
Operator Valued Functions
Consider the case where A (s) âˆˆL (X, Y ) for X and Y separable Banach spaces.
With the operator norm L (X, Y ) is a Banach space and so if A is strongly mea-
surable, the Bochner integral can be deï¬ned as before. However, it is also possible
to deï¬ne the Bochner integral of such operator valued functions for more general
situations. In this section, (â„¦, F, Âµ) will be a Ïƒ ï¬nite measure space as usual.
Lemma 21.25 Let x âˆˆX and suppose A is strongly measurable. Then
s â†’A (s) x
is strongly measurable as a map into Y.
Proof: Since A is assumed to be strongly measurable, it is the pointwise limit
of simple functions of the form
An (s) â‰¡
mn
X
k=1
An
kXEn
k (s)
where An
k is in L (X, Y ). It follows An (s) x â†’A (s) x for each s and so, since s â†’
An (s) x is a simple Y valued function, s â†’A (s) x must be strongly measurable.
Deï¬nition 21.26 Suppose A (s) âˆˆL (X, Y ) for each s âˆˆâ„¦where X, Y are sepa-
rable Banach spaces. Suppose also that for each x âˆˆX,
s â†’A (s) x is strongly measurable
(21.21)
and there exists C such that for each x âˆˆX,
Z
â„¦
||A (s) x|| dÂµ < C ||x||
(21.22)
Then
R
â„¦A (s) dÂµ âˆˆL (X, Y ) is deï¬ned by the following formula.
ÂµZ
â„¦
A (s) dÂµ
Â¶
(x) â‰¡
Z
â„¦
A (s) xdÂµ
(21.23)
Lemma 21.27 The above deï¬nition is well deï¬ned. Furthermore, if 21.21 holds
then s â†’||A (s)|| is measurable and if 21.22 holds, then
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
A (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤
Z
â„¦
||A (s)|| dÂµ.
Proof: It is clear that in case s â†’A (s) x is measurable for all x âˆˆX there
exists a unique Î¨ âˆˆL (X, Y ) such that
Î¨ (x) =
Z
â„¦
A (s) xdÂµ.

21.3.
OPERATOR VALUED FUNCTIONS
595
This is because x â†’
R
â„¦A (s) xdÂµ is linear and continuous. Thus Î¨ =
R
â„¦A (s) dÂµ
and the deï¬nition is well deï¬ned.
Now consider the assertion about s â†’||A (s)||. Let Dâ€² âŠ†Bâ€² the closed unit ball
in Y â€² be such that Dâ€² is countable and
||y|| = sup
yâˆ—âˆˆDâ€² |yâˆ—(y)| .
Also let D be a countable dense subset of B, the unit ball of X. Then
{s : ||A (s)|| > Î±}
=
Â½
s : sup
xâˆˆD
||A (s) x|| > Î±
Â¾
=
âˆªxâˆˆD {s : ||A (s) x|| > Î±}
=
âˆªxâˆˆD (âˆªyâˆ—âˆˆDâ€² {|yâˆ—(A (s) x)| > Î±})
and this is measurable because s â†’A (s) x is strongly, hence weakly measurable.
Now suppose 21.22 holds. Then for all x,
Z
â„¦
||A (s) x|| dÂµ < C ||x|| .
It follows that for ||x|| â‰¤1,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
ÂµZ
â„¦
A (s) dÂµ
Â¶
(x)
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
A (s) xdÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
Z
â„¦
||A (s) x|| dÂµ
â‰¤
Z
â„¦
||A (s)|| dÂµ
and so
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
A (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤
Z
â„¦
||A (s)|| dÂµ.
This proves the lemma.
Now it is interesting to consider the case where A (s) âˆˆL (H, H) where s â†’
A (s) x is strongly measurable and A (s) is compact and self adjoint. Recall the
Kuratowski measurable selection theorem, Theorem 8.11 on Page 176 listed here
for convenience.
Theorem 21.28 Let E be a compact metric space and let (â„¦, F) be a measure
space. Suppose Ïˆ : E Ã— â„¦â†’R has the property that x â†’Ïˆ (x, Ï‰) is continuous
and Ï‰ â†’Ïˆ (x, Ï‰) is measurable. Then there exists a measurable function, f having
values in E such that
Ïˆ (f (Ï‰) , Ï‰) = sup
xâˆˆE
Ïˆ (x, Ï‰) .
Furthermore, Ï‰ â†’Ïˆ (f (Ï‰) , Ï‰) is measurable.

596
THE BOCHNER INTEGRAL
21.3.1
Review Of Hilbert Schmidt Theorem
Here I will give a proof of the Hilbert Schmidt theorem which will generalize to a
result about measurable operators. Recall the following.
Deï¬nition 21.29 Deï¬ne v âŠ—u âˆˆL (H, H) by
v âŠ—u (x) = (x, u) v.
A âˆˆL (H, H) is a compact operator if whenever {xk} is a bounded sequence, there
exists a convergent subsequence of {Axk}. Equivalently, A maps bounded sets to
sets whose closures are compact or to use other terminology, A maps bounded sets
to sets which are precompact.
Lemma 21.30 Let H be a separable Hilbert space and suppose A âˆˆL (H, H) is a
compact operator. Let B denote the closed unit ball in H. Then A is continuous as
a map from B with the weak topology into H with the strong topology. For u, v âˆˆH,
v âŠ—u : H â†’H is a compact operator. If A is self adjoint and compact, the function
x â†’(Ax, x)
is continuous on B with respect to the weak topology on B. The function,
x â†’(v âŠ—u (x) , x)
is continuous and the operator u âŠ—u is self adjoint.
Proof: Since H is separable, it follows from Corollary 13.41 on Page 358 that
B can be considered as a metric space.
Therefore, showing continuity reduces
to showing convergent sequences are taken to convergent sequences. Let xn â†’x
weakly in B. Suppose Axndoes not converge to Ax. Then there exists a subsequence,
still denoted by {xn} such that
||Axn âˆ’Ax|| â‰¥Îµ > 0
(21.24)
for all n. Then since A maps bounded sets to compact sets, there is a further sub-
sequence, still denoted by {xn} such that Axn converges to some y âˆˆH. Therefore,
(y, w)
=
lim
nâ†’âˆž(Axn, w) = lim
nâ†’âˆž(xn, Aâˆ—w)
=
(x, Aâˆ—w) = (Ax, w)
which shows Ax = y since w is arbitrary. However, this contradicts 21.24.
Next consider the claim about v âŠ—u. Letting {xn} be a bounded sequence,
v âŠ—u (xn) = (xn, u) v.
There exists a weakly convergent subsequence of {xn} say {xnk} converging weakly
to x âˆˆH. Therefore,
||v âŠ—u (xnk) âˆ’v âŠ—u (x)|| = ||(xnk, u) âˆ’(x, u)|| ||v||

21.3.
OPERATOR VALUED FUNCTIONS
597
which converges to 0. Thus v âŠ—u is compact as claimed. It takes bounded sets to
precompact sets.
To verify the assertion about x â†’(Ax, x), let xn â†’x weakly. Then
|(Axn, xn) âˆ’(Ax, x)|
â‰¤
|(Axn, xn) âˆ’(Ax, xn)| + |(Ax, xn) âˆ’(Ax, x)|
â‰¤
|(Axn, xn) âˆ’(Ax, xn)| + |(Axn, x) âˆ’(Ax, x)|
â‰¤
||Axn âˆ’Ax|| ||xn|| + ||Axn âˆ’Ax|| ||x|| â‰¤2 ||Axn âˆ’Ax||
which converges to 0.
|(v âŠ—u (xn) , xn) âˆ’(v âŠ—u (x) , x)|
=
|(xn, u) (v, xn) âˆ’(x, u) (v, x)|
and this converges to 0 by weak convergence. It follows from the deï¬nition that
u âŠ—u is self adjoint. This proves the lemma.
Observation 21.31 Note that if A is any self adjoint operator,
(Ax, x) = (x, Ax) = (Ax, x) .
so (Ax, x) is real valued.
Lemma 21.32 Let A âˆˆL (H, H) and suppose it is self adjoint and compact. Let
B denote the closed unit ball in H. Let e âˆˆB be such that
|(Ae, e)| = max
xâˆˆB |(Ax, x)| .
Then letting Î» = (Ae, e) , it follows Ae = Î»e. If Î» Ì¸= 0, then ||e|| = 1 and if Î» = 0,
it can be assumed e = 0 so it is still the case Ae = Î»e.
Proof: From the above observation, (Ax, x) is always real and since A is com-
pact, |(Ax, x)| achieves a maximum at e. It remains to verify e is an eigenvector.
Note that ||e|| = 1 whenever Î» Ì¸= 0 since otherwise |(Ae, e)| could be made larger
by replacing e with e/ ||e||.
Suppose Î» = (Ae, e) > 0. Then it is easy to verify that Î»I âˆ’A is a nonnegative
(((Î»I âˆ’A) x, x) â‰¥0 for all x.) and self adjoint operator. Therefore, the Cauchy
Schwarz inequality can be applied to write
((Î»I âˆ’A) e, x) â‰¤((Î»I âˆ’A) e, e)1/2 ((Î»I âˆ’A) x, x)1/2 = 0
Since this is true for all x it follows Ae = Î»e.
Next suppose Î» = (Ae, e) < 0. Then âˆ’Î» = (âˆ’Ae, e) and the previous result can
be applied to âˆ’A and âˆ’Î». Thus âˆ’Î»e = âˆ’Ae and so Ae = Î»e.
Finally consider the case where Î» = 0. Then 0 = (A0, 0) and so it suï¬ƒces to
take e = 0 as claimed. This proves the lemma.
With these lemmas here is a major theorem, the Hilbert Schmidt theorem.

598
THE BOCHNER INTEGRAL
Theorem 21.33 Let A âˆˆL (H, H) be a compact self adjoint operator on a Hilbert
space. Then there exist real numbers {Î»k}âˆž
k=1 and vectors {ek}âˆž
k=1 such that
||ek||
=
1 if Î»k Ì¸= 0,
||ek||
=
0 if Î»k = 0,
(ek, ej)H = 0 if k Ì¸= j,
Aek = Î»kek,
|Î»n| â‰¥|Î»n+1| for all n,
lim
nâ†’âˆžÎ»n = 0,
lim
nâ†’âˆž
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯A âˆ’
n
X
k=1
Î»k (ek âŠ—ek)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L(H,H)
= 0.
(21.25)
Proof: This is done by considering a sequence of compact self adjoint operators,
A, A1, A2, Â· Â· Â·. Here is how these are deï¬ned. Using Lemma 21.32 let e1, Î»1 be given
by that lemma such that
|(Ae1, e1)| = max
xâˆˆB |(Ax, x)| , Î»1 = (Ae1, e1) .
Then by that lemma, Ae1 = Î»1e1 and ||e1|| = 1 if Î»1 Ì¸= 0 while e1 = 0 if Î»1 = 0.
If An has been obtained, use Lemma 21.32 to obtain en+1 and Î»n+1 such that
|(Anen+1, en+1)| = max
xâˆˆB |(Anx, x)| , Î»n+1 = (Anen+1, en+1) .
By that lemma again, Anen+1 = Î»n+1en+1 and ||en+1|| = 1 if Î»n+1 Ì¸= 0 while
en+1 = 0 if Î»n+1 = 0. Then
An+1 â‰¡An âˆ’Î»n+1en+1 âŠ—en+1
Thus
An = A âˆ’
n
X
k=1
Î»kek âŠ—ek.
(21.26)
Claim 1: If k < n + 1 then (en+1, ek) = 0. Also Aek = Î»kek for all k.
Proof of claim: From the above,
Î»n+1en+1 = Anen+1 = Aen+1 âˆ’
n
X
k=1
Î»k (en+1, ek) ek.
If Î»n+1 = 0, then (en+1, ek) = 0 because en+1 = 0. If Î»n+1 Ì¸= 0, then from the
above and an induction hypothesis
Î»n+1 (en+1, ej)
=
(Aen+1, ej) âˆ’
n
X
k=1
Î»k (en+1, ek) (ek, ej)
=
(en+1, Aej) âˆ’
n
X
k=1
Î»k (en+1, ek) (ek, ej)
=
Î»j (en+1, ej) âˆ’Î»j (en+1, ej) = 0.

21.3.
OPERATOR VALUED FUNCTIONS
599
To verify the second part of this claim,
Î»n+1en+1 = Anen+1 = Aen+1 âˆ’
n
X
k=1
Î»kek (en+1, ek) = Aen+1
This proves the claim.
Claim 2: |Î»n| â‰¥|Î»n+1| .
Proof of claim: From 21.26 and the deï¬nition of An and ek âŠ—ek,
Î»n+1
=
(Anen+1, en+1)
=
(Anâˆ’1en+1, en+1) âˆ’Î»n |(en, en+1)|2
=
(Anâˆ’1en+1, en+1)
By the previous claim. Therefore,
|Î»n+1| = |(Anâˆ’1en+1, en+1)| â‰¤|(Anâˆ’1en, en)| = |Î»n|
by the deï¬nition of |Î»n|. (en makes |(Anâˆ’1x, x)| as large as possible, not necessarily
en+1.)
Claim 3:limnâ†’âˆžÎ»n = 0.
Proof of claim: If for some n, Î»n = 0, then Î»k = 0 for all k > n by claim 2.
Assume then that Î»k Ì¸= 0 for any k. Then if limkâ†’âˆž|Î»k| = Îµ > 0, contrary to the
claim, ||ek|| = 1 for all k and
||Aen âˆ’Aem||2
=
||Î»nen âˆ’Î»mem||2
=
Î»2
n + Î»2
m â‰¥2Îµ2
which shows there is no Cauchy subsequence of {Aen}âˆž
n=1 , which contradicts the
compactness of A. This proves the claim.
Claim 4: ||An|| â†’0
Proof of claim: Let x, y âˆˆB
|Î»n+1|
â‰¥
Â¯Â¯Â¯Â¯
Âµ
An
x + y
2
, x + y
2
Â¶Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
1
4 (Anx, x) + 1
4 (Any, y) + 1
2 (Anx, y)
Â¯Â¯Â¯Â¯
â‰¥
1
2 |(Anx, y)| âˆ’1
4 |(Anx, x) + (Any, y)|
â‰¥
1
2 |(Anx, y)| âˆ’1
4 (|(Anx, x)| + |(Any, y)|)
â‰¥
1
2 |(Anx, y)| âˆ’1
2 |Î»n+1|
and so
3 |Î»n+1| â‰¥|(Anx, y)| .
It follows ||An|| â‰¤3 |Î»n+1| . This proves the claim.
By 21.26 this proves 21.25 and completes the proof.

600
THE BOCHNER INTEGRAL
21.3.2
Measurable Compact Operators
Here the operators will be of the form A (s) where s âˆˆâ„¦and s â†’A (s) x is strongly
measurable and A (s) is a compact operator in L (H, H).
Theorem 21.34 Let A (s) âˆˆL (H, H) be a compact self adjoint operator and H is
a separable Hilbert space such that s â†’A (s) x is strongly measurable. Then there
exist real numbers {Î»k (s)}âˆž
k=1 and vectors {ek (s)}âˆž
k=1 such that
||ek (s)||
=
1 if Î»k Ì¸= 0,
||ek (s)||
=
0 if Î»k = 0,
(ek (s) , ej (s))H = 0 if k Ì¸= j,
A (s) ek (s) = Î»k (s) ek (s) ,
|Î»n (s)| â‰¥|Î»n+1 (s)| for all n,
lim
nâ†’âˆžÎ»n (s) = 0,
lim
nâ†’âˆž
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯A (s) âˆ’
n
X
k=1
Î»k (s) (ek (s) âŠ—ek (s))
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L(H,H)
= 0.
The function s â†’Î»j (s) is measurable and s â†’ej (s) is strongly measurable.
Proof: It is simply a repeat of the above proof of the Hilbert Schmidt theorem
except at every step when the ek and Î»k are deï¬ned, you use the Kuratowski mea-
surable selection theorem, Theorem 21.28 on Page 595 to obtain Î»k (s) is measurable
and that s â†’ek (s) is also measurable.
When you consider maxxâˆˆB |(An (s) x, x)| , let Ïˆ (x, s) = |(An (s) x, x)| . Then
Ïˆ is continuous in x by Lemma 21.30 on Page 596 and it is measurable in s by
assumption. Therefore, by the Kuratowski theorem, ek (s) is measurable in the sense
that inverse images of weakly open sets in B are measurable. However, by Lemma
21.9 on Page 582 this is the same as weakly measurable. Since H is separable, this
implies s â†’ek (s) is also strongly measurable. The measurability of Î»k and ek is
the only new thing here and so this completes the proof.
21.4
Fubiniâ€™s Theorem For Bochner Integrals
Now suppose (â„¦1, F, Âµ) and (â„¦2, S, Î») are two Ïƒ ï¬nite measure spaces.
Recall
the notion of product measure. There was a Ïƒ algebra, denoted by F Ã— S which
is the smallest Ïƒ algebra containing the elementary sets, (ï¬nite disjoint unions of
measurable rectangles) and a measure, denoted by Âµ Ã— Î» deï¬ned on this Ïƒ algebra
such that for E âˆˆF Ã— S,
s1 â†’Î» (Es1) , (Es1 â‰¡{s2 : (s1, s2) âˆˆE})

21.4.
FUBINIâ€™S THEOREM FOR BOCHNER INTEGRALS
601
is Âµ measurable and
s2 â†’Âµ (Es2) , (Es2 â‰¡{s1 : (s1, s2) âˆˆE})
is Î» measurable. In terms of nonnegative functions which are F Ã— S measurable,
s1
â†’
f (s1, s2) is Âµ measurable,
s2
â†’
f (s1, s2) is Î» measurable,
s1
â†’
Z
â„¦2
f (s1, s2) dÎ» is Âµ measurable,
s2
â†’
Z
â„¦1
f (s1, s2) dÂµ is Î» measurable,
and the conclusion of Fubiniâ€™s theorem holds.
Z
â„¦1Ã—â„¦2
fd (Âµ Ã— Î»)
=
Z
â„¦1
Z
â„¦2
f (s1, s2) dÎ»dÂµ
=
Z
â„¦2
Z
â„¦1
f (s1, s2) dÂµdÎ».
The following theorem is the version of Fubiniâ€™s theorem valid for Bochner integrable
functions.
Theorem 21.35 Let f : â„¦1 Ã— â„¦2 â†’X be strongly measurable with respect to Âµ Ã— Î»
and suppose
Z
â„¦1Ã—â„¦2
||f (s1, s2)|| d (Âµ Ã— Î») < âˆž.
(21.27)
Then there exist a set of Âµ measure zero, N and a set of Î» measure zero, M such
that the following formula holds with all integrals making sense.
Z
â„¦1Ã—â„¦2
f (s1, s2) d (Âµ Ã— Î»)
=
Z
â„¦1
Z
â„¦2
f (s1, s2) XN (s1) dÎ»dÂµ
=
Z
â„¦2
Z
â„¦1
f (s1, s2) XM (s2) dÂµdÎ».
Proof: First note that from 21.27 and the usual Fubini theorem for nonnegative
valued functions,
Z
â„¦1Ã—â„¦2
||f (s1, s2)|| d (Âµ Ã— Î») =
Z
â„¦1
Z
â„¦2
||f (s1, s2)|| dÎ»dÂµ
and so
Z
â„¦2
||f (s1, s2)|| dÎ» < âˆž
(21.28)
for Âµ a.e. s1. Say for all s1 /âˆˆN where Âµ (N) = 0.

602
THE BOCHNER INTEGRAL
Let Ï† âˆˆXâ€². Then Ï† â—¦f is F Ã— S measurable and
Z
â„¦1Ã—â„¦2
|Ï† â—¦f (s1, s2)| d (Âµ Ã— Î»)
â‰¤
Z
â„¦1Ã—â„¦2
||Ï†|| ||f (s1, s2)|| d (Âµ Ã— Î») < âˆž
and so from the usual Fubini theorem for complex valued functions,
Z
â„¦1Ã—â„¦2
Ï† â—¦f (s1, s2) d (Âµ Ã— Î») =
Z
â„¦1
Z
â„¦2
Ï† â—¦f (s1, s2) dÎ»dÂµ.
(21.29)
Now also if you ï¬x s2, it follows from the deï¬nition of strongly measurable and the
properties of product measure mentioned above that
s1 â†’f (s1, s2)
is strongly measurable. Also, by 21.28
Z
â„¦2
||f (s1, s2)|| dÎ» < âˆž
for s1 /âˆˆN.
Therefore, by Theorem 21.19 s2 â†’f (s1, s2) XN C (s1) is Bochner
integrable. By 21.29 and 21.6
Z
â„¦1Ã—â„¦2
Ï† â—¦f (s1, s2) d (Âµ Ã— Î»)
=
Z
â„¦1
Z
â„¦2
Ï† â—¦f (s1, s2) dÎ»dÂµ
=
Z
â„¦1
Z
â„¦2
Ï† (f (s1, s2) XN C (s1)) dÎ»dÂµ
=
Z
â„¦1
Ï†
ÂµZ
â„¦2
f (s1, s2) XN C (s1) dÎ»
Â¶
dÂµ.
(21.30)
Each iterated integral makes sense and
s1
â†’
Z
â„¦2
Ï† (f (s1, s2) XN C (s1)) dÎ»
=
Ï†
ÂµZ
â„¦2
f (s1, s2) XNC (s1) dÎ»
Â¶
(21.31)
is Âµ measurable because
(s1, s2)
â†’
Ï† (f (s1, s2) XNC (s1))
=
Ï† (f (s1, s2)) XN C (s1)

21.5.
THE SPACES LP (â„¦; X)
603
is product measurable. Now consider the function,
s1 â†’
Z
â„¦2
f (s1, s2) XN C (s1) dÎ».
(21.32)
I want to show this is also Bochner integrable with respect to Âµ so I can factor
out Ï† once again. Itâ€™s measurability follows from the Pettis theorem and the above
observation 21.31. Also,
Z
â„¦1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦2
f (s1, s2) XNC (s1) dÎ»
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ dÂµ
â‰¤
Z
â„¦1
Z
â„¦2
||f (s1, s2)|| dÎ»dÂµ
=
Z
â„¦1Ã—â„¦2
||f (s1, s2)|| d (Âµ Ã— Î») < âˆž.
Therefore, the function in 21.32 is indeed Bochner integrable and so in 21.30 the Ï†
can be taken outside the last integral. Thus,
Ï†
ÂµZ
â„¦1Ã—â„¦2
f (s1, s2) d (Âµ Ã— Î»)
Â¶
=
Z
â„¦1Ã—â„¦2
Ï† â—¦f (s1, s2) d (Âµ Ã— Î»)
=
Z
â„¦1
Z
â„¦2
Ï† â—¦f (s1, s2) dÎ»dÂµ
=
Z
â„¦1
Ï†
ÂµZ
â„¦2
f (s1, s2) XN C (s1) dÎ»
Â¶
dÂµ
=
Ï†
ÂµZ
â„¦1
Z
â„¦2
f (s1, s2) XN C (s1) dÎ»dÂµ
Â¶
.
Since Xâ€² separates the points,
Z
â„¦1Ã—â„¦2
f (s1, s2) d (Âµ Ã— Î») =
Z
â„¦1
Z
â„¦2
f (s1, s2) XN C (s1) dÎ»dÂµ.
The other formula follows from similar reasoning. This proves the theorem.
21.5
The Spaces Lp (â„¦; X)
Deï¬nition 21.36 x âˆˆLp (â„¦; X) for p âˆˆ[1, âˆž) if x is strongly measurable and
Z
â„¦
||x (s)||p dÂµ < âˆž
Also
||x||Lp(â„¦;X) â‰¡||x||p â‰¡
ÂµZ
â„¦
||x (s)||p dÂµ
Â¶1/p
.
(21.33)

604
THE BOCHNER INTEGRAL
As in the case of scalar valued functions, two functions in Lp (â„¦; X) are consid-
ered equal if they are equal a.e. With this convention, and using the same arguments
found in the presentation of scalar valued functions it is clear that Lp (â„¦; X) is a
normed linear space with the norm given by 21.33. In fact, Lp (â„¦; X) is a Banach
space. This is the main contribution of the next theorem.
Lemma 21.37 If xn is a Cauchy sequence in Lp (â„¦; X) satisfying
âˆž
X
n=1
||xn+1 âˆ’xn||p < âˆž,
then there exists x âˆˆLp (â„¦; X) such that xn (s) â†’x (s) a.e. and
||x âˆ’xn||p â†’0.
Proof: Let
gN (s) â‰¡
N
X
n=1
||xn+1 (s) âˆ’xn (s)||X
Then by the triangle inequality,
ÂµZ
â„¦
gN (s)p dÂµ
Â¶1/p
â‰¤
N
X
n=1
ÂµZ
â„¦
||xn+1 (s) âˆ’xn (s)||p dÂµ
Â¶1/p
â‰¤
âˆž
X
n=1
||xn+1 âˆ’xn||p < âˆž.
Let
g (s) = lim
Nâ†’âˆžgN (s) =
âˆž
X
n=1
||xn+1 (s) âˆ’xn (s)||X .
By the monotone convergence theorem,
ÂµZ
â„¦
g (s)p dÂµ
Â¶1/p
= lim
Nâ†’âˆž
ÂµZ
â„¦
gN (s)p dÂµ
Â¶1/p
< âˆž.
Therefore, there exists a set of measure 0, E, such that for s /âˆˆE, g (s) < âˆž. Hence,
for s /âˆˆE,
lim
Nâ†’âˆžxN+1 (s)
exists because
xN+1 (s) = xN+1 (s) âˆ’x1 (s) + x1 (s) =
N
X
n=1
(xn+1 (s) âˆ’xn (s)) + x1 (s).

21.5.
THE SPACES LP (â„¦; X)
605
Thus, if N > M, and s is a point where g (s) < âˆž,
||xN+1 (s) âˆ’xM+1 (s)||X
â‰¤
N
X
n=M+1
||xn+1 (s) âˆ’xn (s)||X
â‰¤
âˆž
X
n=M+1
||xn+1 (s) âˆ’xn (s)||X
which shows that {xN+1 (s)}âˆž
N=1 is a Cauchy sequence. Now let
x (s) â‰¡
Â½
limNâ†’âˆžxN (s) if s /âˆˆE,
0 if s âˆˆE.
By Theorem 21.2, xn (â„¦) is separable for each n. Therefore, x (â„¦) is also separable.
Also, if f âˆˆXâ€², then
f (x (s)) = lim
Nâ†’âˆžf (xN (s))
if s /âˆˆE and f (x (s)) = 0 if s âˆˆE. Therefore, f â—¦x is measurable because it is the
limit of the measurable functions,
f â—¦xNXEC.
Since x is weakly measurable and x (â„¦) is separable, Corollary 21.8 shows that x is
strongly measurable. By Fatouâ€™s lemma,
Z
â„¦
||x (s) âˆ’xN (s)||p dÂµ â‰¤lim inf
Mâ†’âˆž
Z
â„¦
||xM (s) âˆ’xN (s)||p dÂµ.
But if N and M are large enough with M > N,
ÂµZ
â„¦
||xM (s) âˆ’xN (s)||p dÂµ
Â¶1/p
â‰¤
M
X
n=N
||xn+1 âˆ’xn||p
â‰¤
âˆž
X
n=N
||xn+1 âˆ’xn||p < Îµ
and this shows, since Îµ is arbitrary, that
lim
Nâ†’âˆž
Z
â„¦
||x (s) âˆ’xN (s)||p dÂµ = 0.
It remains to show x âˆˆLp (â„¦; X). This follows from the above and the triangle
inequality. Thus, for N large enough,
ÂµZ
â„¦
||x (s)||p dÂµ
Â¶1/p

606
THE BOCHNER INTEGRAL
â‰¤
ÂµZ
â„¦
||xN (s)||p dÂµ
Â¶1/p
+
ÂµZ
â„¦
||x (s) âˆ’xN (s)||p dÂµ
Â¶1/p
â‰¤
ÂµZ
â„¦
||xN (s)||p dÂµ
Â¶1/p
+ Îµ < âˆž.
This proves the lemma.
Theorem 21.38 Lp (â„¦; X) is complete. Also every Cauchy sequence has a subse-
quence which converges pointwise.
Proof: If {xn} is Cauchy in Lp (â„¦; X), extract a subsequence {xnk} satisfying
Â¯Â¯Â¯Â¯xnk+1 âˆ’xnk
Â¯Â¯Â¯Â¯
p â‰¤2âˆ’k
and apply Lemma 21.37. The pointwise convergence of this subsequence was estab-
lished in the proof of this lemma. This proves the theorem because if a subsequence
of a Cauchy sequence converges, then the Cauchy sequence must also converge.
Observation 21.39 If the measure space is Lebesgue measure then you have conti-
nuity of translation in Lp (Rn; X) in the usual way. More generally, for Âµ a Radon
measure on â„¦a locally compact Hausdorï¬€space, Cc (â„¦; X) is dense in Lp (â„¦; X) .
Here Cc (â„¦; X) is the space of continuous X valued functions which have compact
support in â„¦. The proof of this little observation follows immediately from approx-
imating with simple functions and then applying the appropriate considerations to
the simple functions.
Clearly Fatouâ€™s lemma and the monotone convergence theorem make no sense
for functions with values in a Banach space but the dominated convergence theorem
holds in this setting.
Theorem 21.40 If x is strongly measurable and xn (s) â†’x (s) a.e. with
||xn (s)|| â‰¤g (s) a.e.
where g âˆˆL1 (â„¦), then x is Bochner integrable and
Z
â„¦
x (s) dÂµ = lim
nâ†’âˆž
Z
â„¦
xn (s) dÂµ.
Proof: ||xn (s) âˆ’x (s)|| â‰¤2g (s) a.e. so by the usual dominated convergence
theorem,
0 = lim
nâ†’âˆž
Z
â„¦
||xn (s) âˆ’x (s)|| dÂµ.
Also,
Z
â„¦
||xn (s) âˆ’xm (s)|| dÂµ

21.5.
THE SPACES LP (â„¦; X)
607
â‰¤
Z
â„¦
||xn (s) âˆ’x (s)|| dÂµ +
Z
â„¦
||xm (s) âˆ’x (s)|| dÂµ,
and so {xn} is a Cauchy sequence in L1 (â„¦; X). Therefore, by Theorem 21.38, there
exists y âˆˆL1 (â„¦; X) and a subsequence xnâ€² satisfying
xnâ€² (s) â†’y (s) a.e. and in L1 (â„¦; X).
But x (s) = limnâ€²â†’âˆžxnâ€² (s) a.e. and so x (s) = y (s) a.e. Hence
Z
â„¦
||x (s)|| dÂµ =
Z
â„¦
||y (s)|| dÂµ < âˆž
which shows that x is Bochner integrable. Finally, since the integral is linear,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
x (s) dÂµ âˆ’
Z
â„¦
xn (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
(x (s) âˆ’xn (s)) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
Z
â„¦
||xn (s) âˆ’x (s)|| dÂµ,
and this last integral converges to 0. This proves the theorem.
The following theorem is interesting.
Theorem 21.41 Let 1 â‰¤p < âˆžand let p < r â‰¤âˆž. Then Lr ([0, T] , X) is a Borel
subset of Lp ([0, T] ; X). Letting C ([0, T] ; X) denote the functions having values in
X which are continuous, C ([0, T] ; X) is also a Borel subset of Lp ([0, T] ; X) . Here
the measure is ordinary one dimensional Lebesgue measure on [0, T].
Proof: First consider the claim about Lr ([0, T] ; X). Let
BM â‰¡
n
x âˆˆLp ([0, T] ; X) : ||x||Lr([0,T ];X) â‰¤M
o
.
Then BM is a closed subset of Lp ([0, T] ; X) . Here is why. If {xn} is a sequence
of elements of BM and xn â†’x in Lp ([0, T] ; X) , then passing to a subsequence,
still denoted by xn, it can be assumed xn (s) â†’x (s) a.e. Hence Fatouâ€™s lemma can
be applied to conclude
Z T
0
||x (s)||r ds â‰¤lim inf
nâ†’âˆž
Z T
0
||xn (s)||r ds â‰¤M r < âˆž.
Now âˆªâˆž
M=1BM = Lr ([0, T] ; X) . Note this did not depend on the measure space
used. It would have been equally valid on any measure space.
Consider now C ([0, T] ; X) . The norm on this space is the usual norm, ||Â·||âˆž.
The argument above shows ||Â·||âˆžis a Borel measurable function on Lp ([0, T] ; X) .
This is because BM â‰¡{x âˆˆLp ([0, T] ; X) : ||x||âˆžâ‰¤M} is a closed, hence Borel sub-
set of Lp ([0, T] ; X). Now let Î¸ âˆˆL (Lp ([0, T] ; X) , Lp (R; X)) such that Î¸ (x (t)) =
x (t) for all t âˆˆ[0, T] and also Î¸ âˆˆL (C ([0, T] ; X) , BC (R; X)) where BC (R; X)
denotes the bounded continuous functions with a norm given by
||x|| â‰¡sup
tâˆˆR
||x (t)|| ,

608
THE BOCHNER INTEGRAL
and Î¸x has compact support.
For example, you could deï¬ne
ex (t) â‰¡
ï£±
ï£´
ï£´
ï£²
ï£´
ï£´
ï£³
x (t) if t âˆˆ[0, T]
x (2T âˆ’t) if t âˆˆ[T, 2T]
x (âˆ’t) if t âˆˆ[âˆ’T, 0]
0 if t /âˆˆ[âˆ’T, 2T]
and let Î¦ âˆˆCâˆž
c (âˆ’T, 2T) such that Î¦ (t) = 1 for t âˆˆ[0, T]. Then you could let
Î¸x (t) â‰¡Î¦ (t) ex (t) .
Then let {Ï†n} be a molliï¬er and deï¬ne
Ïˆnx (t) â‰¡Ï†n âˆ—Î¸x (t) .
It follows Ïˆnx is uniformly continuous because
||Ïˆnx (t) âˆ’Ïˆnx (tâ€²)||X
â‰¤
Z
R
|Ï†n (tâ€² âˆ’s) âˆ’Ï†n (t âˆ’s)| ||Î¸x (s)||X ds
â‰¤
C ||x||p
ÂµZ
R
|Ï†n (tâ€² âˆ’s) âˆ’Ï†n (t âˆ’s)|pâ€²
ds
Â¶1/pâ€²
Also for x âˆˆC ([0, T] ; X) , it follows from usual molliï¬er arguments that
||Ïˆnx âˆ’x||Lâˆž([0,T ];X) â†’0.
Here is why. For t âˆˆ[0, T] ,
||Ïˆnx (t) âˆ’x (t)||X
â‰¤
Z
R
Ï†n (s) ||Î¸x (t âˆ’s) âˆ’Î¸x (t)|| ds
â‰¤
CÎ¸
Z 1/n
âˆ’1/n
Ï†n (s) dsÎµ = CÎ¸Îµ
provided n is large enough due to the compact support and consequent uniform
continuity of Î¸x.
If ||Ïˆnx âˆ’x||Lâˆž([0,T ];X) â†’0, then {Ïˆnx} must be a Cauchy sequence in C ([0, T] ; X)
and this requires that x equals a continuous function a.e. Thus C ([0, T] ; X) con-
sists exactly of those functions, x of Lp ([0, T] ; X) such that ||Ïˆnx âˆ’x||âˆžâ†’0. It
follows
C ([0, T] ; X) =
âˆ©âˆž
n=1 âˆªâˆž
m=1 âˆ©âˆž
k=m
Â½
x âˆˆLp ([0, T] ; X) : ||Ïˆkx âˆ’x||âˆžâ‰¤1
n
Â¾
.
(21.34)
It only remains to show
S â‰¡{x âˆˆLp ([0, T] ; X) : ||Ïˆkx âˆ’x||âˆžâ‰¤Î±}

21.5.
THE SPACES LP (â„¦; X)
609
is a Borel set. Suppose then that xn âˆˆS and xn â†’x in Lp ([0, T] ; X). Then there
exists a subsequence, still denoted by n such that xn â†’x pointwise a.e. as well as
in Lp. There exists a set of measure 0 such that for all n, and t not in this set,
||Ïˆkxn (t) âˆ’xn (t)||
â‰¡
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z 1/k
âˆ’1/k
Ï†k (s) (Î¸xn (t âˆ’s)) ds âˆ’xn (t)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ â‰¤Î±
xn (t)
â†’
x (t) .
Then
||Ïˆkxn (t) âˆ’xn (t) âˆ’(Ïˆkx (t) âˆ’x (t))||
â‰¤
||xn (t) âˆ’x (t)||X +
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z 1/k
âˆ’1/k
Ï†k (s) (Î¸xn (t âˆ’s) âˆ’Î¸x (t âˆ’s)) ds
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
â‰¤
||xn (t) âˆ’x (t)||X + Ck,Î¸ ||xn âˆ’x||Lp(0,T ;X)
which converges to 0 as n â†’âˆž. It follows that for a.e. t,
||Ïˆkx (t) âˆ’x (t)|| â‰¤Î±.
Thus S is closed and so the set in 21.34 is a Borel set. This proves the theorem.
As in the scalar case, the following lemma holds in this more general context.
Lemma 21.42 Let (â„¦, Âµ) be a regular measure space where â„¦is a locally compact
Hausdorï¬€space. Then Cc (â„¦; X) the space of continuous functions having compact
support and values in X is dense in Lp (0, T; X) for all p âˆˆ[0, âˆž). For any Ïƒ ï¬nite
measure space, the simple functions are dense in Lp (0, T; X) .
Proof: First is it shown the simple functions are dense in Lp (0, T; X) . Let
f âˆˆLp (0, T; X) and let {xn} denote a sequence of simple functions which converge
to f pointwise which also have the property that
||xn (s)|| â‰¤2 ||f (s)||
Then
Z
â„¦
||xn (s) âˆ’f (s)||p dÂµ â†’0
from the dominated convergence theorem. Therefore, the simple functions are in-
deed dense in Lp (0, T; X) .
Next suppose (â„¦, Âµ) is a regular measure space. If x (s) â‰¡P
i aiXEi (s) is a
simple function, then by regularity, there exist compact sets, Ki and open sets, Vi
such that Ki âŠ†Ei âŠ†Vi and Âµ (Vi \ Ki)1/p < Îµ/ P
i ||ai|| . Let Ki â‰ºhi â‰ºVi. Then
consider
X
i
aihi âˆˆCc (â„¦) .

610
THE BOCHNER INTEGRAL
By the triangle inequality,
ÃƒZ
â„¦
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
X
i
aihi (s) âˆ’aiXEi (s)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
p
dÂµ
!1/p
â‰¤
X
i
ÂµZ
â„¦
||ai (hi (s) âˆ’XEi (s))||p dÂµ
Â¶1/p
â‰¤
X
i
ÂµZ
â„¦
||ai||p |hi (s) âˆ’XEi (s)|p dÂµ
Â¶1/p
â‰¤
X
i
||ai||
ÃƒZ
Vi\Ki
dÂµ
!1/p
â‰¤
X
i
||ai|| Âµ (Vi \ Ki)1/p < Îµ
Since Îµ is arbitrary, this and the ï¬rst part of the lemma shows Cc (â„¦; X) is dense
in Lp (â„¦; X) .
21.6
Measurable Representatives
In this section consider the special case where X = L1 (B, Î½) where (B, F,Î½) is a Ïƒ
ï¬nite measure space and x âˆˆL1 (â„¦; X). Thus for each s âˆˆâ„¦, x (s) âˆˆL1 (B, Î½). In
general, the map
(s, t) â†’x (s) (t)
will not be measurable, but one can obtain a measurable representative. This is
important because it allows the use of Fubiniâ€™s theorem on the measurable repre-
sentative.
By Theorem 21.19, there exists a sequence of simple functions, {xn}, of the form
xn (s) =
m
X
k=1
akXEk (s)
(21.35)
where ak âˆˆL1 (B, Î½) which satisfy the conditions of Deï¬nition 21.17 and
||xn âˆ’x||1 â†’0.
(21.36)
Because of the form of xn given in 21.35, if
xn (s, t) â‰¡xn (s) (t),
then xn is measurable.
Z
â„¦
Z
B
|xn (s, t) âˆ’xm (s, t)| dÎ½dÂµ â‰¤
Z
â„¦
Z
B
|xn (s, t) âˆ’x (s) (t)| dÎ½dÂµ

21.6.
MEASURABLE REPRESENTATIVES
611
+
Z
â„¦
Z
B
|xm (s, t) âˆ’x (s) (t)| dÎ½dÂµ.
(21.37)
It follows from 21.37 and 21.36 that {xn} is a Cauchy sequence in L1 (â„¦Ã— B).
Therefore, there exists y âˆˆL1 (â„¦Ã— B) and a subsequence of {xn}, still denoted by
{xn}, such that
lim
nâ†’âˆžxn (s, t) = y (s, t) a.e.
and
lim
nâ†’âˆž||xn âˆ’y||1 = 0.
It follows that
Z
â„¦
Z
B
|y (s, t) âˆ’x (s) (t)| dÎ½dÂµ
â‰¤
Z
â„¦
Z
B
|y (s, t) âˆ’xn (s, t)| dÎ½dÂµ
(21.38)
+
Z
â„¦
Z
B
|x (s) (t) âˆ’xn (s, t)| dÎ½dÂµ.
Since limnâ†’âˆž||xn âˆ’x||1 = 0, it follows from 21.38 that y = x in L1 (â„¦; X) . Thus,
for a.e. s,
y (s, Â·) = x (s) in X = L1 (B).
Now
R
â„¦x (s) dÂµ âˆˆX = L1 (B, Î½) so it makes sense to ask for
Â¡R
â„¦x (s) dÂµ
Â¢
(t), at
least a.e. To ï¬nd what this is, note
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
xn (s) dÂµ âˆ’
Z
â„¦
x (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
X
â‰¤
Z
â„¦
||xn (s) âˆ’x (s)||X dÂµ.
Therefore, since the right side converges to 0,
lim
nâ†’âˆž
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
â„¦
xn (s) dÂµ âˆ’
Z
â„¦
x (s) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
X
=
lim
nâ†’âˆž
Z
B
Â¯Â¯Â¯Â¯
ÂµZ
â„¦
xn (s) dÂµ
Â¶
(t) âˆ’
ÂµZ
â„¦
x (s) dÂµ
Â¶
(t)
Â¯Â¯Â¯Â¯ dÎ½ = 0.
But
ÂµZ
â„¦
xn (s) dÂµ
Â¶
(t) =
Z
â„¦
xn (s, t) dÂµ a.e. t.
Therefore
lim
nâ†’âˆž
Z
B
Â¯Â¯Â¯Â¯
Z
â„¦
xn (s, t) dÂµ âˆ’
ÂµZ
â„¦
x (s) dÂµ
Â¶
(t)
Â¯Â¯Â¯Â¯ dÎ½ = 0.
(21.39)
Also, since xn â†’y in L1 (â„¦Ã— B),
0 = lim
nâ†’âˆž
Z
B
Z
â„¦
|xn (s, t) âˆ’y (s, t)| dÂµdÎ½ â‰¥
lim
nâ†’âˆž
Z
B
Â¯Â¯Â¯Â¯
Z
â„¦
xn (s, t) dÂµ âˆ’
Z
â„¦
y (s, t) dÂµ
Â¯Â¯Â¯Â¯ dÎ½.
(21.40)

612
THE BOCHNER INTEGRAL
From 21.39 and 21.40
Z
â„¦
y (s, t) dÂµ =
ÂµZ
â„¦
x (s) dÂµ
Â¶
(t) a.e. t.
This proves the following theorem.
Theorem 21.43 Let X = L1 (B) where (B, F, Î½) is a Ïƒ ï¬nite measure space and
let x âˆˆL1 (â„¦; X). Then there exists a measurable representative, y âˆˆL1 (â„¦Ã— B),
such that
x (s) = y (s, Â·) a.e. s in â„¦,
and
Z
â„¦
y (s, t) dÂµ =
ÂµZ
â„¦
x (s) dÂµ
Â¶
(t) a.e. t.
21.7
Vector Measures
There is also a concept of vector measures.
Deï¬nition 21.44 Let (â„¦, S) be a set and a Ïƒ algebra of subsets of â„¦. A mapping
F : S â†’X
is said to be a vector measure if
F (âˆªâˆž
i=1Ei) =
âˆž
X
i=1
F (Ei)
whenever {Ei}âˆž
i=1 is a sequence of disjoint elements of S. For F a vector measure,
|F| (A) â‰¡sup{
X
F âˆˆÏ€(A)
||Âµ (F)|| : Ï€ (A) is a partition of A}.
This is the same deï¬nition that was given in the case where F would have values
in C, the only diï¬€erence being the fact that now F has values in a general Banach
space X as the vector space of values of the vector measure. Recall that a partition
of A is a ï¬nite set, {F1, Â· Â· Â·, Fm} âŠ†S such that âˆªm
i=1Fi = A. The same theorem
about |F| proved in the case of complex valued measures holds in this context with
the same proof. For completeness, it is included here.
Theorem 21.45 If |F| (â„¦) < âˆž, then |F| is a measure on S.
Proof: Let E1 and E2 be sets of S such that E1 âˆ©E2 = âˆ…and let {Ai
1 Â·Â·Â·Ai
ni} =
Ï€(Ei), a partition of Ei which is chosen such that
|F|(Ei) âˆ’Îµ <
ni
X
j=1
||F(Ai
j)|| i = 1, 2.

21.7.
VECTOR MEASURES
613
Consider the sets which are contained in either of Ï€ (E1) or Ï€ (E2) , it follows this
collection of sets is a partition of E1 âˆªE2 which is denoted here by Ï€(E1 âˆªE2).
Then by the above inequality and the deï¬nition of total variation,
|F|(E1 âˆªE2) â‰¥
X
F âˆˆÏ€(E1âˆªE2)
||F(F)|| > |F|(E1) + |F|(E2) âˆ’2Îµ,
which shows that since Îµ > 0 was arbitrary,
|F|(E1 âˆªE2) â‰¥|F|(E1) + |F|(E2).
(21.41)
Let {Ej}âˆž
j=1 be a sequence of disjoint sets of S and let Eâˆž= âˆªâˆž
j=1Ej. Then by the
deï¬nition of total variation there exists a partition of Eâˆž, Ï€(Eâˆž) = {A1, Â· Â· Â·, An}
such that
|F|(Eâˆž) âˆ’Îµ <
n
X
i=1
||F(Ai)||.
Also,
Ai = âˆªâˆž
j=1Ai âˆ©Ej
and so by the triangle inequality, ||F(Ai)|| â‰¤Pâˆž
j=1 ||F(Ai âˆ©Ej)||. Therefore, by
the above,
|F|(Eâˆž) âˆ’Îµ
<
n
X
i=1
â‰¥||F (Ai)||
z
}|
{
âˆž
X
j=1
||F(Ai âˆ©Ej)||
=
âˆž
X
j=1
n
X
i=1
||F(Ai âˆ©Ej)||
â‰¤
âˆž
X
j=1
|F|(Ej)
because {Ai âˆ©Ej}n
i=1 is a partition of Ej.
Since Îµ > 0 is arbitrary, this shows
|F|(âˆªâˆž
j=1Ej) â‰¤
âˆž
X
j=1
|F|(Ej).
Also, 21.41 implies that whenever the Ei are disjoint, |F|(âˆªn
j=1Ej) â‰¥Pn
j=1 |F|(Ej).
Therefore,
âˆž
X
j=1
|F|(Ej) â‰¥|F|(âˆªâˆž
j=1Ej) â‰¥|F|(âˆªn
j=1Ej) â‰¥
n
X
j=1
|F|(Ej).
Since n is arbitrary,
|F|(âˆªâˆž
j=1Ej) =
âˆž
X
j=1
|F|(Ej)
which shows that |F| is a measure as claimed. This proves the theorem.

614
THE BOCHNER INTEGRAL
Deï¬nition 21.46 A Banach space is said to have the Radon Nikodym property if
whenever
(â„¦, S, Âµ) is a ï¬nite measure space
F : S â†’X is a vector measure with |F| (â„¦) < âˆž
F â‰ªÂµ
then one may conclude there exists g âˆˆL1 (â„¦; X) such that
F (E) =
Z
E
g (s) dÂµ
for all E âˆˆS.
Some Banach spaces have the Radon Nikodym property and some donâ€™t. No
attempt is made to give a complete answer to the question of which Banach spaces
have this property but the next theorem gives examples of many spaces which do.
Theorem 21.47 Suppose Xâ€² is a separable dual space. Then Xâ€² has the Radon
Nikodym property.
Proof: Let F â‰ªÂµ and let |F| (â„¦) < âˆžfor F : S â†’Xâ€², a vector measure. Pick
x âˆˆX and consider the map
E â†’F (E) (x)
for E âˆˆS. This deï¬nes a complex measure which is absolutely continuous with
respect to |F|.
Therefore, by the Radon Nikodym theorem, there exists fx âˆˆ
L1 (â„¦, |F|) such that
F (E) (x) =
Z
E
fx (s) d |F|.
(21.42)
Claim: |fx (s)| â‰¤||x|| for |F| a.e. s.
Proof of claim: Consider the closed ball in F, B (0, ||x||) and let B â‰¡B (p, r)
be an open ball contained in its complement. Let f âˆ’1
x
(B) â‰¡E âˆˆS. I want to
argue that |F| (E) = 0 so suppose |F| (E) > 0. then
|F| (E) ||x|| â‰¥||F (E)|| ||x|| â‰¥|F (E) (x)|
and so from 21.42,
1
|F| (E)
Â¯Â¯Â¯Â¯
Z
E
fx (s) d |F|
Â¯Â¯Â¯Â¯ â‰¤||x|| .
(21.43)
But on E, |fx (s) âˆ’p| < r and so
Â¯Â¯Â¯Â¯
1
|F| (E)
Z
E
fx (s) d |F| âˆ’p
Â¯Â¯Â¯Â¯ < r
which contradicts 21.43 because B (p, r) was given to have empty intersection with
B (0, ||x||). Therefore, |F| (E) = 0 as hoped. Now F \ B (0, ||x||) can be covered by
countably many such balls and so |F|
Â³
F \ B (0, ||x||)
Â´
= 0.

21.7.
VECTOR MEASURES
615
Denote the exceptional set of measure zero by Nx. By Theorem 21.13, X is
separable. Letting D be a dense, countable subset of X, deï¬ne
N1 â‰¡âˆªxâˆˆDNx.
Thus
|F| (N1) = 0.
For any E âˆˆS, x, y âˆˆD, and a, b âˆˆF,
Z
E
fax+by (s) d |F| = F (E) (ax + by) = aF (E) (x) + bF (E) (y)
=
Z
E
(afx (s) + bfy (s)) d |F|.
(21.44)
Since 21.44 holds for all E âˆˆS, it follows
fax+by (s) = afx (s) + bfy (s)
for |F| a.e. s and x, y âˆˆD. Let ËœD consist of all ï¬nite linear combinations of the
form Pm
i=1 aixi where ai is a rational point of F and xi âˆˆD. If
m
X
i=1
aixi âˆˆËœD,
the above argument implies
fPm
i=1 aixi (s) =
m
X
i=1
aifxi (s) a.e.
Since ËœD is countable, there exists a set, N2, with
|F| (N2) = 0
such that for s /âˆˆN2,
fPm
i=1 aixi (s) =
m
X
i=1
aifxi (s)
(21.45)
whenever Pm
i=1 aixi âˆˆËœD. Let
N = N1 âˆªN2
and let
Ëœhx (s) â‰¡XNC (s) fx (s)
for all x âˆˆËœD. Now for x âˆˆX deï¬ne
hx (s) â‰¡lim
xâ€²â†’x{Ëœhxâ€² (s) : xâ€² âˆˆËœD}.

616
THE BOCHNER INTEGRAL
This is well deï¬ned because if xâ€² and yâ€² are elements of ËœD, the above claim and
21.45 imply
Â¯Â¯Â¯Ëœhxâ€² (s) âˆ’Ëœhyâ€² (s)
Â¯Â¯Â¯ =
Â¯Â¯Â¯Ëœh(xâ€²âˆ’yâ€²) (s)
Â¯Â¯Â¯ â‰¤||xâ€² âˆ’yâ€²||.
Using 21.45, the dominated convergence theorem may be applied to conclude that
for xn â†’x, with xn âˆˆËœD,
Z
E
hx (s) d |F| = lim
nâ†’âˆž
Z
E
Ëœhxn (s) d |F| = lim
nâ†’âˆžF (E) (xn) = F (E) (x).
(21.46)
It follows from the density of ËœD that for all x, y âˆˆX and a, b âˆˆF,
|hx (s)| â‰¤||x|| , hax+by (s) = ahx (s) + bhy (s),
(21.47)
for all s because if s âˆˆN, both sides of the equation in 21.47 equal 0.
Let Î¸ (s) be given by
Î¸ (s) (x) = hx (s).
By 21.47 it follows that Î¸ (s) âˆˆXâ€² for each s. Also
Î¸ (s) (x) = hx (s) âˆˆL1 (â„¦)
so Î¸ (Â·) is weak âˆ—measurable. Since Xâ€² is separable, Theorem 21.12 implies that Î¸
is strongly measurable. Furthermore, by 21.47,
||Î¸ (s)|| â‰¡sup
||x||â‰¤1
|Î¸ (s) (x)| â‰¤sup
||x||â‰¤1
|hx (s)| â‰¤1.
Therefore,
Z
â„¦
||Î¸ (s)|| d |F| < âˆž
so Î¸ âˆˆL1 (â„¦; Xâ€²). By 21.6, if E âˆˆS,
Z
E
hx (s) d |F| =
Z
E
Î¸ (s) (x) d |F| =
ÂµZ
E
Î¸ (s) d |F|
Â¶
(x).
(21.48)
From 21.46 and 21.48,
ÂµZ
E
Î¸ (s) d |F|
Â¶
(x) = F (E) (x)
for all x âˆˆX and therefore,
Z
E
Î¸ (s) d |F| = F (E).
Finally, since F â‰ªÂµ, |F| â‰ªÂµ also and so there exists k âˆˆL1 (â„¦) such that
|F| (E) =
Z
E
k (s) dÂµ

21.8.
THE RIESZ REPRESENTATION THEOREM
617
for all E âˆˆS, by the Radon Nikodym Theorem. It follows
F (E) =
Z
E
Î¸ (s) d |F| =
Z
E
Î¸ (s) k (s) dÂµ.
Letting g (s) = Î¸ (s) k (s), this has proved the theorem.
Corollary 21.48 Any separable reï¬‚exive Banach space has the Radon Nikodym
property.
It is not necessary to assume separability in the above corollary. For the proof
of a more general result, consult Vector Measures by Diestal and Uhl, [16].
21.8
The Riesz Representation Theorem
The Riesz representation theorem for the spaces Lp (â„¦; X) holds under certain con-
ditions. The proof follows the proofs given earlier for scalar valued functions.
Deï¬nition 21.49 If X and Y are two Banach spaces, X is isometric to Y if there
exists Î¸ âˆˆL (X, Y ) such that
||Î¸x||Y = ||x||X .
This will be written as X âˆ¼= Y . The map Î¸ is called an isometry.
The next theorem says that Lpâ€² (â„¦; Xâ€²) is always isometric to a subspace of
(Lp (â„¦; X))â€² for any Banach space, X.
Theorem 21.50 Let X be any Banach space and let (â„¦, S, Âµ) be a ï¬nite measure
space. Let p â‰¥1 and let 1/p + 1/pâ€² = 1.(If p = 1, pâ€² â‰¡âˆž.) Then Lpâ€² (â„¦; Xâ€²) is
isometric to a subspace of (Lp (â„¦; X))â€².
Also, for g âˆˆLpâ€² (â„¦; Xâ€²),
sup
||f||pâ‰¤1
Â¯Â¯Â¯Â¯
Z
â„¦
g (s) (f (s)) dÂµ
Â¯Â¯Â¯Â¯ = ||g||pâ€² .
Proof: First observe that for f âˆˆLp (â„¦; X) and g âˆˆLpâ€² (â„¦; Xâ€²),
s â†’g (s) (f (s))
is a function in L1 (â„¦).
(To obtain measurability, write f as a limit of simple
functions. Holderâ€™s inequality then yields the function is in L1 (â„¦).) Deï¬ne
Î¸ : Lpâ€² (â„¦; Xâ€²) â†’(Lp (â„¦; X))â€²
by
Î¸g (f) â‰¡
Z
â„¦
g (s) (f (s)) dÂµ.

618
THE BOCHNER INTEGRAL
Holderâ€™s inequality implies
||Î¸g|| â‰¤||g||pâ€²
(21.49)
and it is also clear that Î¸ is linear. Next it is required to show
||Î¸g|| = ||g||.
This will ï¬rst be veriï¬ed for simple functions. Let
g (s) =
m
X
i=1
ciXEi (s)
where ci âˆˆXâ€², the Ei are disjoint and
âˆªm
i=1Ei = â„¦.
Then ||g|| âˆˆLpâ€² (â„¦).
Let Îµ > 0 be given.
By the scalar Riesz representation
theorem, there exists h âˆˆLp (â„¦) such that ||h||p = 1 and
Z
â„¦
||g (s)||Xâ€² h (s) dÂµ â‰¥||g||Lpâ€²(â„¦;Xâ€²) âˆ’Îµ.
Now let di be chosen such that
ci (di) â‰¥||ci||Xâ€² âˆ’Îµ/ ||h||L1(â„¦)
and ||di||X â‰¤1. Let
f (s) â‰¡
m
X
i=1
dih (s) XEi (s).
Thus f âˆˆLp (â„¦; X) and ||f||Lp(â„¦;X) â‰¤1. This follows from
||f||p
p
=
Z
â„¦
m
X
i=1
||di||p
X |h (s)|p XEi (s) dÂµ
=
m
X
i=1
ÂµZ
Ei
|h (s)p| dÂµ
Â¶
||di||p
X â‰¤
Z
â„¦
|h|p dÂµ = 1.
Also
||Î¸g|| â‰¥|Î¸g (f)| =
Â¯Â¯Â¯Â¯
Z
â„¦
g (s) (f (s)) dÂµ
Â¯Â¯Â¯Â¯ â‰¥
Â¯Â¯Â¯Â¯Â¯
Z
â„¦
m
X
i=1
Â³
||ci||Xâ€² âˆ’Îµ/ ||h||L1(â„¦)
Â´
h (s) XEi (s) dÂµ
Â¯Â¯Â¯Â¯Â¯
â‰¥
Â¯Â¯Â¯Â¯
Z
â„¦
||g (s)||Xâ€² h (s) dÂµ
Â¯Â¯Â¯Â¯ âˆ’Îµ
Â¯Â¯Â¯Â¯
Z
â„¦
h (s) / ||h||L1(â„¦) dÂµ
Â¯Â¯Â¯Â¯
â‰¥||g||Lpâ€²(â„¦;Xâ€²) âˆ’2Îµ.

21.8.
THE RIESZ REPRESENTATION THEOREM
619
Since Îµ was arbitrary,
||Î¸g|| â‰¥||g||
(21.50)
and from 21.49 this shows equality holds in 21.50 whenever g is a simple function.
In general, let g âˆˆLpâ€² (â„¦; Xâ€²) and let gn be a sequence of simple functions
converging to g in Lpâ€² (â„¦; Xâ€²). Then
||Î¸g|| = lim
nâ†’âˆž||Î¸gn|| = lim
nâ†’âˆž||gn|| = ||g||.
This proves the theorem and shows Î¸ is the desired isometry.
Theorem 21.51 If X is a Banach space and Xâ€² has the Radon Nikodym property,
then if (â„¦, S, Âµ) is a ï¬nite measure space,
(Lp (â„¦; X))â€² âˆ¼= Lpâ€² (â„¦; Xâ€²)
and in fact the mapping Î¸ of Theorem 21.50 is onto.
Proof: Let l âˆˆ(Lp (â„¦; X))â€² and deï¬ne F (E) âˆˆXâ€² by
F (E) (x) â‰¡l (XE (Â·) x).
Lemma 21.52 F deï¬ned above is a vector measure with values in Xâ€² and |F| (â„¦) <
âˆž.
Proof of the lemma: Clearly F (E) is linear. Also
||F (E)|| = sup
||x||â‰¤1
||F (E) (x)||
â‰¤||l|| sup
||x||â‰¤1
||XE (Â·) x||Lp(â„¦;X) â‰¤||l|| Âµ (E)1/p.
Let {Ei}âˆž
i=1 be a sequence of disjoint elements of S and let E = âˆªn<âˆžEn.
Â¯Â¯Â¯Â¯Â¯F (E) (x) âˆ’
n
X
k=1
F (Ek) (x)
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯l (XE (Â·) x) âˆ’
n
X
i=1
l (XEi (Â·) x)
Â¯Â¯Â¯Â¯Â¯
(21.51)
â‰¤
||l||
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯XE (Â·) x âˆ’
n
X
i=1
XEi (Â·) x
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Lp(â„¦;X)
â‰¤
||l|| Âµ
Ãƒ [
k>n
Ek
!1/p
||x||.
Since Âµ (â„¦) < âˆž,
lim
nâ†’âˆžÂµ
Ãƒ [
k>n
Ek
!1/p
= 0

620
THE BOCHNER INTEGRAL
and so inequality 21.51 shows that
lim
nâ†’âˆž
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯F (E) âˆ’
n
X
k=1
F (Ek)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Xâ€²
= 0.
To show |F| (â„¦) < âˆž, let Îµ > 0 be given, let {H1, Â· Â· Â·, Hn} be a partition of â„¦,
and let ||xi|| â‰¤1 be chosen in such a way that
F (Hi) (xi) > ||F (Hi)|| âˆ’Îµ/n.
Thus
âˆ’Îµ +
n
X
i=1
||F (Hi)|| <
n
X
i=1
l (XHi (Â·) xi) â‰¤||l||
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
XHi (Â·) xi
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Lp(â„¦;X)
â‰¤||l||
ÃƒZ
â„¦
n
X
i=1
XHi (s) dÂµ
!1/p
= ||l|| Âµ (â„¦)1/p.
Since Îµ > 0 was arbitrary,
n
X
i=1
||F (Hi)|| < ||l|| Âµ (â„¦)1/p.
Since the partition was arbitrary, this shows |F| (â„¦) â‰¤||l|| Âµ (â„¦)1/p and this proves
the lemma.
Continuing with the proof of Theorem 21.51, note that
F â‰ªÂµ.
Since Xâ€² has the Radon Nikodym property, there exists g âˆˆL1 (â„¦; Xâ€²) such that
F (E) =
Z
E
g (s) dÂµ.
Also, from the deï¬nition of F (E) ,
l
Ãƒ n
X
i=1
xiXEi (Â·)
!
=
n
X
i=1
l (XEi (Â·) xi)
=
n
X
i=1
F (Ei) (xi) =
n
X
i=1
Z
Ei
g (s) (xi) dÂµ.
(21.52)
It follows from 21.52 that whenever h is a simple function,
l (h) =
Z
â„¦
g (s) (h (s)) dÂµ.
(21.53)

21.9.
EXERCISES
621
Let
Gn â‰¡{s : ||g (s)||Xâ€² â‰¤n}
and let
j : Lp (Gn; X) â†’Lp (â„¦; X)
be given by
jh (s) =
Â½
h (s) if s âˆˆGn,
0 if s /âˆˆGn.
Letting h be a simple function in Lp (Gn; X),
jâˆ—l (h) = l (jh) =
Z
Gn
g (s) (h (s)) dÂµ.
(21.54)
Since the simple functions are dense in Lp (Gn; X), and g âˆˆLpâ€² (Gn; Xâ€²), it follows
21.54 holds for all h âˆˆLp (Gn; X). By Theorem 21.50,
||g||Lpâ€²(Gn;Xâ€²) = ||jâˆ—l||(Lp(Gn;X))â€² â‰¤||l||(Lp(â„¦;X))â€² .
By the monotone convergence theorem,
||g||Lpâ€²(â„¦;Xâ€²) = lim
nâ†’âˆž||g||Lpâ€²(Gn;Xâ€²) â‰¤||l||(Lp(â„¦;X))â€² .
Therefore g âˆˆLpâ€² (â„¦; Xâ€²) and since simple functions are dense in Lp (â„¦; X), 21.53
holds for all h âˆˆLp (â„¦; X) . Thus l = Î¸g and the theorem is proved because, by
Theorem 21.50, ||l|| = ||g|| and the mapping Î¸ is onto because l was arbitrary.
Corollary 21.53 If Xâ€² is separable, then
(Lp (â„¦; X))â€² âˆ¼= Lpâ€² (â„¦; Xâ€²).
Corollary 21.54 If X is separable and reï¬‚exive, then
(Lp (â„¦; X))â€² âˆ¼= Lpâ€² (â„¦; Xâ€²).
Corollary 21.55 If X is separable and reï¬‚exive, then if p âˆˆ(1, âˆž) , then Lp (â„¦; X)
is reï¬‚exive.
Proof: This is just like the scalar valued case.
21.9
Exercises
1. Show L1 (R) is not reï¬‚exive. Hint: L1 (R) is separable. What about Lâˆž(R)?
2. If f âˆˆL1 (Rn; X) for X a Banach space, does the usual fundamental theorem
of calculus work?
That is, can you say limrâ†’0
1
m(B(x,r))
R
B(x,r) f (t) dm =
f (x) a.e.?
3. Does the Vitali convergence theorem hold for Bochner integrable functions?
If so, give a statement of the appropriate theorem and a proof.

622
THE BOCHNER INTEGRAL

Part III
Complex Analysis
623


The Complex Numbers
The reader is presumed familiar with the algebraic properties of complex numbers,
including the operation of conjugation. Here a short review of the distance in C is
presented.
The length of a complex number, referred to as the modulus of z and denoted
by |z| is given by
|z| â‰¡
Â¡
x2 + y2Â¢1/2 = (zz)1/2 ,
Then C is a metric space with the distance between two complex numbers, z and
w deï¬ned as
d (z, w) â‰¡|z âˆ’w| .
This metric on C is the same as the usual metric of R2. A sequence, zn â†’z if and
only if xn â†’x in R and yn â†’y in R where z = x + iy and zn = xn + iyn. For
example if zn =
n
n+1 + i 1
n, then zn â†’1 + 0i = 1.
Deï¬nition 22.1 A sequence of complex numbers, {zn} is a Cauchy sequence if for
every Îµ > 0 there exists N such that n, m > N implies |zn âˆ’zm| < Îµ.
This is the usual deï¬nition of Cauchy sequence. There are no new ideas here.
Proposition 22.2 The complex numbers with the norm just mentioned forms a
complete normed linear space.
Proof: Let {zn} be a Cauchy sequence of complex numbers with zn = xn +iyn.
Then {xn} and {yn} are Cauchy sequences of real numbers and so they converge
to real numbers, x and y respectively. Thus zn = xn + iyn â†’x + iy. C is a linear
space with the ï¬eld of scalars equal to C. It only remains to verify that | | satisï¬es
the axioms of a norm which are:
|z + w| â‰¤|z| + |w|
|z| â‰¥0 for all z
|z| = 0 if and only if z = 0
|Î±z| = |Î±| |z| .
625

626
THE COMPLEX NUMBERS
The only one of these axioms of a norm which is not completely obvious is the ï¬rst
one, the triangle inequality. Let z = x + iy and w = u + iv
|z + w|2
=
(z + w) (z + w) = |z|2 + |w|2 + 2 Re (zw)
â‰¤
|z|2 + |w|2 + 2 |(zw)| = (|z| + |w|)2
and this veriï¬es the triangle inequality.
Deï¬nition 22.3 An inï¬nite sum of complex numbers is deï¬ned as the limit of the
sequence of partial sums. Thus,
âˆž
X
k=1
ak â‰¡lim
nâ†’âˆž
n
X
k=1
ak.
Just as in the case of sums of real numbers, an inï¬nite sum converges if and
only if the sequence of partial sums is a Cauchy sequence.
From now on, when f is a function of a complex variable, it will be assumed that
f has values in X, a complex Banach space. Usually in complex analysis courses,
f has values in C but there are many important theorems which donâ€™t require this
so I will leave it fairly general for a while. Later the functions will have values in
C. If you are only interested in this case, think C whenever you see X.
Deï¬nition 22.4 A sequence of functions of a complex variable, {fn} converges
uniformly to a function, g for z âˆˆS if for every Îµ > 0 there exists NÎµ such that if
n > NÎµ, then
||fn (z) âˆ’g (z)|| < Îµ
for all z âˆˆS. The inï¬nite sum Pâˆž
k=1 fn converges uniformly on S if the partial
sums converge uniformly on S. Here ||Â·|| refers to the norm in X, the Banach space
in which f has its values.
The following proposition is also a routine application of the above deï¬nition.
Neither the deï¬nition nor this proposition say anything new.
Proposition 22.5 A sequence of functions, {fn} deï¬ned on a set S, converges
uniformly to some function, g if and only if for all Îµ > 0 there exists NÎµ such that
whenever m, n > NÎµ,
||fn âˆ’fm||âˆž< Îµ.
Here ||f||âˆžâ‰¡sup {||f (z)|| : z âˆˆS} .
Just as in the case of functions of a real variable, one of the important theorems
is the Weierstrass M test. Again, there is nothing new here. It is just a review of
earlier material.
Theorem 22.6 Let {fn} be a sequence of complex valued functions deï¬ned on S âŠ†
C. Suppose there exists Mn such that ||fn||âˆž< Mn and P Mn converges. Then
P fn converges uniformly on S.

22.1.
THE EXTENDED COMPLEX PLANE
627
Proof: Let z âˆˆS. Then letting m < n
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
k=1
fk (z) âˆ’
m
X
k=1
fk (z)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ â‰¤
n
X
k=m+1
||fk (z)|| â‰¤
âˆž
X
k=m+1
Mk < Îµ
whenever m is large enough. Therefore, the sequence of partial sums is uniformly
Cauchy on S and therefore, converges uniformly to Pâˆž
k=1 fk (z) on S.
22.1
The Extended Complex Plane
The set of complex numbers has already been considered along with the topology of
C which is nothing but the topology of R2. Thus, for zn = xn +iyn, zn â†’z â‰¡x+iy
if and only if xn â†’x and yn â†’y. The norm in C is given by
|x + iy| â‰¡((x + iy) (x âˆ’iy))1/2 =
Â¡
x2 + y2Â¢1/2
which is just the usual norm in R2 identifying (x, y) with x + iy. Therefore, C is
a complete metric space topologically like R2 and so the Heine Borel theorem that
compact sets are those which are closed and bounded is valid.
Thus, as far as
topology is concerned, there is nothing new about C.
The extended complex plane, denoted by bC , consists of the complex plane, C
along with another point not in C known as âˆž. For example, âˆžcould be any point
in R3. A sequence of complex numbers, zn, converges to âˆžif, whenever K is a
compact set in C, there exists a number, N such that for all n > N, zn /âˆˆK. Since
compact sets in C are closed and bounded, this is equivalent to saying that for all
R > 0, there exists N such that if n > N, then zn /âˆˆB (0, R) which is the same as
saying limnâ†’âˆž|zn| = âˆžwhere this last symbol has the same meaning as it does in
calculus.
A geometric way of understanding this in terms of more familiar objects involves
a concept known as the Riemann sphere.
Consider the unit sphere, S2 given by (z âˆ’1)2 + y2 + x2 = 1. Deï¬ne a map
from the complex plane to the surface of this sphere as follows.
Extend a line
from the point, p in the complex plane to the point (0, 0, 2) on the top of this
sphere and let Î¸ (p) denote the point of this sphere which the line intersects. Deï¬ne
Î¸ (âˆž) â‰¡(0, 0, 2).
s
s
s
(0, 0, 2)
(0, 0, 1)
s
@
@
@
@
@
@@
p
Î¸(p)
C

628
THE COMPLEX NUMBERS
Then Î¸âˆ’1 is sometimes called sterographic projection. The mapping Î¸ is clearly
continuous because it takes converging sequences, to converging sequences. Fur-
thermore, it is clear that Î¸âˆ’1 is also continuous. In terms of the extended complex
plane, bC, a sequence, zn converges to âˆžif and only if Î¸zn converges to (0, 0, 2) and
a sequence, zn converges to z âˆˆC if and only if Î¸ (zn) â†’Î¸ (z) .
In fact this makes it easy to deï¬ne a metric on bC.
Deï¬nition 22.7 Let z, w âˆˆbC including possibly w = âˆž. Then let d (x, w) â‰¡
|Î¸ (z) âˆ’Î¸ (w)| where this last distance is the usual distance measured in R3.
Theorem 22.8
Â³
bC, d
Â´
is a compact, hence complete metric space.
Proof: Suppose {zn} is a sequence in bC. This means {Î¸ (zn)} is a sequence in
S2 which is compact. Therefore, there exists a subsequence, {Î¸znk} and a point,
z âˆˆS2 such that Î¸znk â†’Î¸z in S2 which implies immediately that d (znk, z) â†’0.
A compact metric space must be complete.
22.2
Exercises
1. Prove the root test for series of complex numbers.
If ak âˆˆC and r â‰¡
lim supnâ†’âˆž|an|1/n then
âˆž
X
k=0
ak
ï£±
ï£²
ï£³
converges absolutely if r < 1
diverges if r > 1
test fails if r = 1.
2. Does limnâ†’âˆžn
Â¡ 2+i
3
Â¢n exist? Tell why and ï¬nd the limit if it does exist.
3. Let A0 = 0 and let An â‰¡Pn
k=1 ak if n > 0. Prove the partial summation
formula,
q
X
k=p
akbk = Aqbq âˆ’Apâˆ’1bp +
qâˆ’1
X
k=p
Ak (bk âˆ’bk+1) .
Now using this formula, suppose {bn} is a sequence of real numbers which
converges to 0 and is decreasing.
Determine those values of Ï‰ such that
|Ï‰| = 1 and Pâˆž
k=1 bkÏ‰k converges.
4. Let f : U âŠ†C â†’C be given by f (x + iy) = u (x, y) + iv (x, y) . Show f is
continuous on U if and only if u : U â†’R and v : U â†’R are both continuous.

Riemann Stieltjes Integrals
In the theory of functions of a complex variable, the most important results are those
involving contour integration. I will base this on the notion of Riemann Stieltjes
integrals as in [13], [39], and [27]. The Riemann Stieltjes integral is a generalization
of the usual Riemann integral and requires the concept of a function of bounded
variation.
Deï¬nition 23.1 Let Î³ : [a, b] â†’C be a function. Then Î³ is of bounded variation
if
sup
( n
X
i=1
|Î³ (ti) âˆ’Î³ (tiâˆ’1)| : a = t0 < Â· Â· Â· < tn = b
)
â‰¡V (Î³, [a, b]) < âˆž
where the sums are taken over all possible lists, {a = t0 < Â· Â· Â· < tn = b} .
The idea is that it makes sense to talk of the length of the curve Î³ ([a, b]) , deï¬ned
as V (Î³, [a, b]) . For this reason, in the case that Î³ is continuous, such an image of a
bounded variation function is called a rectiï¬able curve.
Deï¬nition 23.2 Let Î³ : [a, b] â†’C be of bounded variation and let f : [a, b] â†’X.
Letting P â‰¡{t0, Â· Â· Â·, tn} where a = t0 < t1 < Â· Â· Â· < tn = b, deï¬ne
||P|| â‰¡max {|tj âˆ’tjâˆ’1| : j = 1, Â· Â· Â·, n}
and the Riemann Steiltjes sum by
S (P) â‰¡
n
X
j=1
f (Î³ (Ï„ j)) (Î³ (tj) âˆ’Î³ (tjâˆ’1))
where Ï„ j âˆˆ[tjâˆ’1, tj] . (Note this notation is a little sloppy because it does not identify
the speciï¬c point, Ï„ j used. It is understood that this point is arbitrary.) Deï¬ne
R
Î³ fdÎ³ as the unique number which satisï¬es the following condition. For all Îµ > 0
there exists a Î´ > 0 such that if ||P|| â‰¤Î´, then
Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’S (P)
Â¯Â¯Â¯Â¯ < Îµ.
629

630
RIEMANN STIELTJES INTEGRALS
Sometimes this is written as
Z
Î³
fdÎ³ â‰¡
lim
||P||â†’0 S (P) .
The set of points in the curve, Î³ ([a, b]) will be denoted sometimes by Î³âˆ—.
Then Î³âˆ—is a set of points in C and as t moves from a to b, Î³ (t) moves from
Î³ (a) to Î³ (b) . Thus Î³âˆ—has a ï¬rst point and a last point. If Ï† : [c, d] â†’[a, b] is
a continuous nondecreasing function, then Î³ â—¦Ï† : [c, d] â†’C is also of bounded
variation and yields the same set of points in C with the same ï¬rst and last points.
Theorem 23.3 Let Ï† and Î³ be as just described. Then assuming that
Z
Î³
fdÎ³
exists, so does
Z
Î³â—¦Ï†
fd (Î³ â—¦Ï†)
and
Z
Î³
fdÎ³ =
Z
Î³â—¦Ï†
fd (Î³ â—¦Ï†) .
(23.1)
Proof: There exists Î´ > 0 such that if P is a partition of [a, b] such that ||P|| < Î´,
then
Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’S (P)
Â¯Â¯Â¯Â¯ < Îµ.
By continuity of Ï†, there exists Ïƒ > 0 such that if Q is a partition of [c, d] with
||Q|| < Ïƒ, Q = {s0, Â· Â· Â·, sn} , then |Ï† (sj) âˆ’Ï† (sjâˆ’1)| < Î´. Thus letting P denote the
points in [a, b] given by Ï† (sj) for sj âˆˆQ, it follows that ||P|| < Î´ and so
Â¯Â¯Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’
n
X
j=1
f (Î³ (Ï† (Ï„ j))) (Î³ (Ï† (sj)) âˆ’Î³ (Ï† (sjâˆ’1)))
Â¯Â¯Â¯Â¯Â¯Â¯
< Îµ
where Ï„ j âˆˆ[sjâˆ’1, sj] . Therefore, from the deï¬nition 23.1 holds and
Z
Î³â—¦Ï†
fd (Î³ â—¦Ï†)
exists.
This theorem shows that
R
Î³ fdÎ³ is independent of the particular Î³ used in its
computation to the extent that if Ï† is any nondecreasing function from another
interval, [c, d] , mapping to [a, b] , then the same value is obtained by replacing Î³
with Î³ â—¦Ï†.
The fundamental result in this subject is the following theorem.

631
Theorem 23.4 Let f : Î³âˆ—â†’X be continuous and let Î³ : [a, b] â†’C be continuous
and of bounded variation. Then
R
Î³ fdÎ³ exists. Also letting Î´m > 0 be such that
|t âˆ’s| < Î´m implies ||f (Î³ (t)) âˆ’f (Î³ (s))|| < 1
m,
Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’S (P)
Â¯Â¯Â¯Â¯ â‰¤2V (Î³, [a, b])
m
whenever ||P|| < Î´m.
Proof: The function, f â—¦Î³ , is uniformly continuous because it is deï¬ned on
a compact set. Therefore, there exists a decreasing sequence of positive numbers,
{Î´m} such that if |s âˆ’t| < Î´m, then
|f (Î³ (t)) âˆ’f (Î³ (s))| < 1
m.
Let
Fm â‰¡{S (P) : ||P|| < Î´m}.
Thus Fm is a closed set. (The symbol, S (P) in the above deï¬nition, means to
include all sums corresponding to P for any choice of Ï„ j.) It is shown that
diam (Fm) â‰¤2V (Î³, [a, b])
m
(23.2)
and then it will follow there exists a unique point, I âˆˆâˆ©âˆž
m=1Fm.
This is because
X is complete. It will then follow I =
R
Î³ f (t) dÎ³ (t) . To verify 23.2, it suï¬ƒces to
verify that whenever P and Q are partitions satisfying ||P|| < Î´m and ||Q|| < Î´m,
|S (P) âˆ’S (Q)| â‰¤2
mV (Î³, [a, b]) .
(23.3)
Suppose ||P|| < Î´m and Q âŠ‡P. Then also ||Q|| < Î´m. To begin with, suppose
that P â‰¡{t0, Â· Â· Â·, tp, Â· Â· Â·, tn} and Q â‰¡{t0, Â· Â· Â·, tpâˆ’1, tâˆ—, tp, Â· Â· Â·, tn} . Thus Q contains
only one more point than P. Letting S (Q) and S (P) be Riemann Steiltjes sums,
S (Q) â‰¡
pâˆ’1
X
j=1
f (Î³ (Ïƒj)) (Î³ (tj) âˆ’Î³ (tjâˆ’1)) + f (Î³ (Ïƒâˆ—)) (Î³ (tâˆ—) âˆ’Î³ (tpâˆ’1))
+f (Î³ (Ïƒâˆ—)) (Î³ (tp) âˆ’Î³ (tâˆ—)) +
n
X
j=p+1
f (Î³ (Ïƒj)) (Î³ (tj) âˆ’Î³ (tjâˆ’1)) ,
S (P) â‰¡
pâˆ’1
X
j=1
f (Î³ (Ï„ j)) (Î³ (tj) âˆ’Î³ (tjâˆ’1)) +
=f(Î³(Ï„ p))(Î³(tp)âˆ’Î³(tpâˆ’1))
z
}|
{
f (Î³ (Ï„ p)) (Î³ (tâˆ—) âˆ’Î³ (tpâˆ’1)) + f (Î³ (Ï„ p)) (Î³ (tp) âˆ’Î³ (tâˆ—))

632
RIEMANN STIELTJES INTEGRALS
+
n
X
j=p+1
f (Î³ (Ï„ j)) (Î³ (tj) âˆ’Î³ (tjâˆ’1)) .
Therefore,
|S (P) âˆ’S (Q)| â‰¤
pâˆ’1
X
j=1
1
m |Î³ (tj) âˆ’Î³ (tjâˆ’1)| + 1
m |Î³ (tâˆ—) âˆ’Î³ (tpâˆ’1)| +
1
m |Î³ (tp) âˆ’Î³ (tâˆ—)| +
n
X
j=p+1
1
m |Î³ (tj) âˆ’Î³ (tjâˆ’1)| â‰¤1
mV (Î³, [a, b]) .
(23.4)
Clearly the extreme inequalities would be valid in 23.4 if Q had more than one
extra point. You simply do the above trick more than one time. Let S (P) and
S (Q) be Riemann Steiltjes sums for which ||P|| and ||Q|| are less than Î´m and let
R â‰¡P âˆªQ. Then from what was just observed,
|S (P) âˆ’S (Q)| â‰¤|S (P) âˆ’S (R)| + |S (R) âˆ’S (Q)| â‰¤2
mV (Î³, [a, b]) .
and this shows 23.3 which proves 23.2. Therefore, there exists a unique complex
number, I âˆˆâˆ©âˆž
m=1Fm which satisï¬es the deï¬nition of
R
Î³ fdÎ³. This proves the
theorem.
The following theorem follows easily from the above deï¬nitions and theorem.
Theorem 23.5 Let f âˆˆC (Î³âˆ—) and let Î³ : [a, b] â†’C be of bounded variation and
continuous. Let
M â‰¥max {||f â—¦Î³ (t)|| : t âˆˆ[a, b]} .
(23.5)
Then
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤MV (Î³, [a, b]) .
(23.6)
Also if {fn} is a sequence of functions of C (Î³âˆ—) which is converging uniformly to
the function, f on Î³âˆ—, then
lim
nâ†’âˆž
Z
Î³
fndÎ³ =
Z
Î³
fdÎ³.
(23.7)
Proof: Let 23.5 hold. From the proof of the above theorem, when ||P|| < Î´m,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’S (P)
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤2
mV (Î³, [a, b])
and so
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤||S (P)|| + 2
mV (Î³, [a, b])

633
â‰¤
n
X
j=1
M |Î³ (tj) âˆ’Î³ (tjâˆ’1)| + 2
mV (Î³, [a, b])
â‰¤
MV (Î³, [a, b]) + 2
mV (Î³, [a, b]) .
This proves 23.6 since m is arbitrary. To verify 23.7 use the above inequality to
write
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’
Z
Î³
fndÎ³
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
(f âˆ’fn) dÎ³ (t)
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤max {||f â—¦Î³ (t) âˆ’fn â—¦Î³ (t)|| : t âˆˆ[a, b]} V (Î³, [a, b]) .
Since the convergence is assumed to be uniform, this proves 23.7.
It turns out to be much easier to evaluate such integrals in the case where Î³ is
also C1 ([a, b]) . The following theorem about approximation will be very useful but
ï¬rst here is an easy lemma.
Lemma 23.6 Let Î³ : [a, b] â†’C be in C1 ([a, b]) . Then V (Î³, [a, b]) < âˆžso Î³ is of
bounded variation.
Proof: This follows from the following
n
X
j=1
|Î³ (tj) âˆ’Î³ (tjâˆ’1)|
=
n
X
j=1
Â¯Â¯Â¯Â¯Â¯
Z tj
tjâˆ’1
Î³â€² (s) ds
Â¯Â¯Â¯Â¯Â¯
â‰¤
n
X
j=1
Z tj
tjâˆ’1
|Î³â€² (s)| ds
â‰¤
n
X
j=1
Z tj
tjâˆ’1
||Î³â€²||âˆžds
=
||Î³â€²||âˆž(b âˆ’a) .
Therefore it follows V (Î³, [a, b]) â‰¤||Î³â€²||âˆž(b âˆ’a) . Here ||Î³||âˆž= max {|Î³ (t)| : t âˆˆ[a, b]}.
Theorem 23.7 Let Î³ : [a, b] â†’C be continuous and of bounded variation. Let
â„¦be an open set containing Î³âˆ—and let f : â„¦Ã— K â†’X be continuous for K a
compact set in C, and let Îµ > 0 be given. Then there exists Î· : [a, b] â†’C such that
Î· (a) = Î³ (a) , Î³ (b) = Î· (b) , Î· âˆˆC1 ([a, b]) , and
||Î³ âˆ’Î·|| < Îµ,
(23.8)
Â¯Â¯Â¯Â¯
Z
Î³
f (Â·, z) dÎ³ âˆ’
Z
Î·
f (Â·, z) dÎ·
Â¯Â¯Â¯Â¯ < Îµ,
(23.9)
V (Î·, [a, b]) â‰¤V (Î³, [a, b]) ,
(23.10)
where ||Î³ âˆ’Î·|| â‰¡max {|Î³ (t) âˆ’Î· (t)| : t âˆˆ[a, b]} .

634
RIEMANN STIELTJES INTEGRALS
Proof: Extend Î³ to be deï¬ned on all R according to Î³ (t) = Î³ (a) if t < a and
Î³ (t) = Î³ (b) if t > b. Now deï¬ne
Î³h (t) â‰¡1
2h
Z t+
2h
(bâˆ’a) (tâˆ’a)
âˆ’2h+t+
2h
(bâˆ’a) (tâˆ’a)
Î³ (s) ds.
where the integral is deï¬ned in the obvious way. That is,
Z b
a
Î± (t) + iÎ² (t) dt â‰¡
Z b
a
Î± (t) dt + i
Z b
a
Î² (t) dt.
Therefore,
Î³h (b) = 1
2h
Z b+2h
b
Î³ (s) ds = Î³ (b) ,
Î³h (a) = 1
2h
Z a
aâˆ’2h
Î³ (s) ds = Î³ (a) .
Also, because of continuity of Î³ and the fundamental theorem of calculus,
Î³â€²
h (t) = 1
2h
Â½
Î³
Âµ
t +
2h
b âˆ’a (t âˆ’a)
Â¶ Âµ
1 +
2h
b âˆ’a
Â¶
âˆ’
Î³
Âµ
âˆ’2h + t +
2h
b âˆ’a (t âˆ’a)
Â¶ Âµ
1 +
2h
b âˆ’a
Â¶Â¾
and so Î³h âˆˆC1 ([a, b]) . The following lemma is signiï¬cant.
Lemma 23.8 V (Î³h, [a, b]) â‰¤V (Î³, [a, b]) .
Proof: Let a = t0 < t1 < Â· Â· Â· < tn = b. Then using the deï¬nition of Î³h and
changing the variables to make all integrals over [0, 2h] ,
n
X
j=1
|Î³h (tj) âˆ’Î³h (tjâˆ’1)| =
n
X
j=1
Â¯Â¯Â¯Â¯Â¯
1
2h
Z 2h
0
Â·
Î³
Âµ
s âˆ’2h + tj +
2h
b âˆ’a (tj âˆ’a)
Â¶
âˆ’
Î³
Âµ
s âˆ’2h + tjâˆ’1 +
2h
b âˆ’a (tjâˆ’1 âˆ’a)
Â¶Â¸Â¯Â¯Â¯Â¯
â‰¤1
2h
Z 2h
0
n
X
j=1
Â¯Â¯Â¯Â¯Î³
Âµ
s âˆ’2h + tj +
2h
b âˆ’a (tj âˆ’a)
Â¶
âˆ’
Î³
Âµ
s âˆ’2h + tjâˆ’1 +
2h
b âˆ’a (tjâˆ’1 âˆ’a)
Â¶Â¯Â¯Â¯Â¯ ds.

635
For a given s âˆˆ[0, 2h] , the points, s âˆ’2h + tj +
2h
bâˆ’a (tj âˆ’a) for j = 1, Â· Â· Â·, n form
an increasing list of points in the interval [a âˆ’2h, b + 2h] and so the integrand is
bounded above by V (Î³, [a âˆ’2h, b + 2h]) = V (Î³, [a, b]) . It follows
n
X
j=1
|Î³h (tj) âˆ’Î³h (tjâˆ’1)| â‰¤V (Î³, [a, b])
which proves the lemma.
With this lemma the proof of the theorem can be completed without too much
trouble. Let H be an open set containing Î³âˆ—such that H is a compact subset of â„¦.
Let 0 < Îµ < dist
Â¡
Î³âˆ—, HCÂ¢
. Then there exists Î´1 such that if h < Î´1, then for all t,
|Î³ (t) âˆ’Î³h (t)|
â‰¤
1
2h
Z t+
2h
(bâˆ’a) (tâˆ’a)
âˆ’2h+t+
2h
(bâˆ’a) (tâˆ’a)
|Î³ (s) âˆ’Î³ (t)| ds
<
1
2h
Z t+
2h
(bâˆ’a) (tâˆ’a)
âˆ’2h+t+
2h
(bâˆ’a) (tâˆ’a)
Îµds = Îµ
(23.11)
due to the uniform continuity of Î³. This proves 23.8.
From 23.2 and the above lemma, there exists Î´2 such that if ||P|| < Î´2, then for
all z âˆˆK,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
f (Â·, z) dÎ³ (t) âˆ’S (P)
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ < Îµ
3,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z
Î³h
f (Â·, z) dÎ³h (t) âˆ’Sh (P)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < Îµ
3
for all h. Here S (P) is a Riemann Steiltjes sum of the form
n
X
i=1
f (Î³ (Ï„ i) , z) (Î³ (ti) âˆ’Î³ (tiâˆ’1))
and Sh (P) is a similar Riemann Steiltjes sum taken with respect to Î³h instead of
Î³. Because of 23.11 Î³h (t) has values in H âŠ†â„¦. Therefore, ï¬x the partition, P, and
choose h small enough that in addition to this, the following inequality is valid for
all z âˆˆK.
|S (P) âˆ’Sh (P)| < Îµ
3
This is possible because of 23.11 and the uniform continuity of f on H Ã— K. It
follows
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z
Î³
f (Â·, z) dÎ³ (t) âˆ’
Z
Î³h
f (Â·, z) dÎ³h (t)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
f (Â·, z) dÎ³ (t) âˆ’S (P)
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ + ||S (P) âˆ’Sh (P)||
+
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Sh (P) âˆ’
Z
Î³h
f (Â·, z) dÎ³h (t)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < Îµ.

636
RIEMANN STIELTJES INTEGRALS
Formula 23.10 follows from the lemma. This proves the theorem.
Of course the same result is obtained without the explicit dependence of f on z.
This is a very useful theorem because if Î³ is C1 ([a, b]) , it is easy to calculate
R
Î³ fdÎ³ and the above theorem allows a reduction to the case where Î³ is C1. The
next theorem shows how easy it is to compute these integrals in the case where Î³ is
C1. First note that if f is continuous and Î³ âˆˆC1 ([a, b]) , then by Lemma 23.6 and
the fundamental existence theorem, Theorem 23.4,
R
Î³ fdÎ³ exists.
Theorem 23.9 If f : Î³âˆ—â†’X is continuous and Î³ : [a, b] â†’C is in C1 ([a, b]) ,
then
Z
Î³
fdÎ³ =
Z b
a
f (Î³ (t)) Î³â€² (t) dt.
(23.12)
Proof: Let P be a partition of [a, b], P = {t0, Â· Â· Â·, tn} and ||P|| is small enough
that whenever |t âˆ’s| < ||P|| ,
|f (Î³ (t)) âˆ’f (Î³ (s))| < Îµ
(23.13)
and
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’
n
X
j=1
f (Î³ (Ï„ j)) (Î³ (tj) âˆ’Î³ (tjâˆ’1))
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
< Îµ.
Now
n
X
j=1
f (Î³ (Ï„ j)) (Î³ (tj) âˆ’Î³ (tjâˆ’1)) =
Z b
a
n
X
j=1
f (Î³ (Ï„ j)) X[tjâˆ’1,tj] (s) Î³â€² (s) ds
where here
X[a,b] (s) â‰¡
Â½
1 if s âˆˆ[a, b]
0 if s /âˆˆ[a, b] .
Also,
Z b
a
f (Î³ (s)) Î³â€² (s) ds =
Z b
a
n
X
j=1
f (Î³ (s)) X[tjâˆ’1,tj] (s) Î³â€² (s) ds
and thanks to 23.13,
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
=Pn
j=1 f(Î³(Ï„ j))(Î³(tj)âˆ’Î³(tjâˆ’1))
z
}|
{
Z b
a
n
X
j=1
f (Î³ (Ï„ j)) X[tjâˆ’1,tj] (s) Î³â€² (s) ds âˆ’
=
R b
a f(Î³(s))Î³â€²(s)ds
z
}|
{
Z b
a
n
X
j=1
f (Î³ (s)) X[tjâˆ’1,tj] (s) Î³â€² (s) ds
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
n
X
j=1
Z tj
tjâˆ’1
||f (Î³ (Ï„ j)) âˆ’f (Î³ (s))|| |Î³â€² (s)| ds â‰¤||Î³â€²||âˆž
X
j
Îµ (tj âˆ’tjâˆ’1)
=
Îµ ||Î³â€²||âˆž(b âˆ’a) .

637
It follows that
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’
Z b
a
f (Î³ (s)) Î³â€² (s) ds
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
Z
Î³
fdÎ³ âˆ’
n
X
j=1
f (Î³ (Ï„ j)) (Î³ (tj) âˆ’Î³ (tjâˆ’1))
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
+
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
n
X
j=1
f (Î³ (Ï„ j)) (Î³ (tj) âˆ’Î³ (tjâˆ’1)) âˆ’
Z b
a
f (Î³ (s)) Î³â€² (s) ds
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤Îµ ||Î³â€²||âˆž(b âˆ’a) + Îµ.
Since Îµ is arbitrary, this veriï¬es 23.12.
Deï¬nition 23.10 Let â„¦be an open subset of C and let Î³ : [a, b] â†’â„¦be a contin-
uous function with bounded variation f : â„¦â†’X be a continuous function. Then
the following notation is more customary.
Z
Î³
f (z) dz â‰¡
Z
Î³
fdÎ³.
The expression,
R
Î³ f (z) dz, is called a contour integral and Î³ is referred to as the
contour. A function f : â„¦â†’X for â„¦an open set in C has a primitive if there
exists a function, F, the primitive, such that F â€² (z) = f (z) . Thus F is just an
antiderivative. Also if Î³k : [ak, bk] â†’C is continuous and of bounded variation, for
k = 1, Â· Â· Â·, m and Î³k (bk) = Î³k+1 (ak) , deï¬ne
Z
Pm
k=1 Î³k
f (z) dz â‰¡
m
X
k=1
Z
Î³k
f (z) dz.
(23.14)
In addition to this, for Î³ : [a, b] â†’C, deï¬ne âˆ’Î³ : [a, b] â†’C by âˆ’Î³ (t) â‰¡
Î³ (b + a âˆ’t) . Thus Î³ simply traces out the points of Î³âˆ—in the opposite order.
The following lemma is useful and follows quickly from Theorem 23.3.
Lemma 23.11 In the above deï¬nition, there exists a continuous bounded vari-
ation function, Î³ deï¬ned on some closed interval, [c, d] , such that Î³ ([c, d]) =
âˆªm
k=1Î³k ([ak, bk]) and Î³ (c) = Î³1 (a1) while Î³ (d) = Î³m (bm) . Furthermore,
Z
Î³
f (z) dz =
m
X
k=1
Z
Î³k
f (z) dz.
If Î³ : [a, b] â†’C is of bounded variation and continuous, then
Z
Î³
f (z) dz = âˆ’
Z
âˆ’Î³
f (z) dz.
Re stating Theorem 23.7 with the new notation in the above deï¬nition,

638
RIEMANN STIELTJES INTEGRALS
Theorem 23.12 Let K be a compact set in C and let f : â„¦Ã—K â†’X be continuous
for â„¦an open set in C. Also let Î³ : [a, b] â†’â„¦be continuous with bounded variation.
Then if r > 0 is given, there exists Î· : [a, b] â†’â„¦such that Î· (a) = Î³ (a) , Î· (b) =
Î³ (b) , Î· is C1 ([a, b]) , and
Â¯Â¯Â¯Â¯
Z
Î³
f (z, w) dz âˆ’
Z
Î·
f (z, w) dz
Â¯Â¯Â¯Â¯ < r, ||Î· âˆ’Î³|| < r.
It will be very important to consider which functions have primitives. It turns
out, it is not enough for f to be continuous in order to possess a primitive. This is
in stark contrast to the situation for functions of a real variable in which the funda-
mental theorem of calculus will deliver a primitive for any continuous function. The
reason for the interest in such functions is the following theorem and its corollary.
Theorem 23.13 Let Î³ : [a, b] â†’C be continuous and of bounded variation. Also
suppose F â€² (z) = f (z) for all z âˆˆâ„¦, an open set containing Î³âˆ—and f is continuous
on â„¦. Then
Z
Î³
f (z) dz = F (Î³ (b)) âˆ’F (Î³ (a)) .
Proof: By Theorem 23.12 there exists Î· âˆˆC1 ([a, b]) such that Î³ (a) = Î· (a) ,
and Î³ (b) = Î· (b) such that
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Î³
f (z) dz âˆ’
Z
Î·
f (z) dz
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ < Îµ.
Then since Î· is in C1 ([a, b]) ,
Z
Î·
f (z) dz
=
Z b
a
f (Î· (t)) Î·â€² (t) dt =
Z b
a
dF (Î· (t))
dt
dt
=
F (Î· (b)) âˆ’F (Î· (a)) = F (Î³ (b)) âˆ’F (Î³ (a)) .
Therefore,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯(F (Î³ (b)) âˆ’F (Î³ (a))) âˆ’
Z
Î³
f (z) dz
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ < Îµ
and since Îµ > 0 is arbitrary, this proves the theorem.
Corollary 23.14 If Î³ : [a, b] â†’C is continuous, has bounded variation, is a closed
curve, Î³ (a) = Î³ (b) , and Î³âˆ—âŠ†â„¦where â„¦is an open set on which F â€² (z) = f (z) ,
then
Z
Î³
f (z) dz = 0.

23.1.
EXERCISES
639
23.1
Exercises
1. Let Î³ : [a, b] â†’R be increasing. Show V (Î³, [a, b]) = Î³ (b) âˆ’Î³ (a) .
2. Suppose Î³ : [a, b] â†’C satisï¬es a Lipschitz condition, |Î³ (t) âˆ’Î³ (s)| â‰¤K |s âˆ’t| .
Show Î³ is of bounded variation and that V (Î³, [a, b]) â‰¤K |b âˆ’a| .
3. Î³ : [c0, cm] â†’C is piecewise smooth if there exist numbers, ck, k = 1, Â· Â·
Â·, m such that c0 < c1 < Â· Â· Â· < cmâˆ’1 < cm such that Î³ is continuous and
Î³ : [ck, ck+1] â†’C is C1. Show that such piecewise smooth functions are of
bounded variation and give an estimate for V (Î³, [c0, cm]) .
4. Let Î³ : [0, 2Ï€] â†’C be given by Î³ (t) = r (cos mt + i sin mt) for m an integer.
Find
R
Î³
dz
z .
5. Show that if Î³ : [a, b] â†’C then there exists an increasing function h : [0, 1] â†’
[a, b] such that Î³ â—¦h ([0, 1]) = Î³âˆ—.
6. Let Î³ : [a, b] â†’C be an arbitrary continuous curve having bounded variation
and let f, g have continuous derivatives on some open set containing Î³âˆ—. Prove
the usual integration by parts formula.
Z
Î³
fgâ€²dz = f (Î³ (b)) g (Î³ (b)) âˆ’f (Î³ (a)) g (Î³ (a)) âˆ’
Z
Î³
f â€²gdz.
7. Let f (z) â‰¡|z|âˆ’(1/2) eâˆ’i Î¸
2 where z = |z| eiÎ¸. This function is called the principle
branch of zâˆ’(1/2). Find
R
Î³ f (z) dz where Î³ is the semicircle in the upper half
plane which goes from (1, 0) to (âˆ’1, 0) in the counter clockwise direction. Next
do the integral in which Î³ goes in the clockwise direction along the semicircle
in the lower half plane.
8. Prove an open set, U is connected if and only if for every two points in U,
there exists a C1 curve having values in U which joins them.
9. Let P, Q be two partitions of [a, b] with P âŠ†Q. Each of these partitions can
be used to form an approximation to V (Î³, [a, b]) as described above. Recall
the total variation was the supremum of sums of a certain form determined by
a partition. How is the sum associated with P related to the sum associated
with Q? Explain.
10. Consider the curve,
Î³ (t) =
Â½
t + it2 sin
Â¡ 1
t
Â¢
if t âˆˆ(0, 1]
0 if t = 0
.
Is Î³ a continuous curve having bounded variation? What if the t2 is replaced
with t? Is the resulting curve continuous? Is it a bounded variation curve?
11. Suppose Î³ : [a, b] â†’R is given by Î³ (t) = t. What is
R
Î³ f (t) dÎ³? Explain.

640
RIEMANN STIELTJES INTEGRALS

Fundamentals Of Complex
Analysis
24.1
Analytic Functions
Deï¬nition 24.1 Let â„¦be an open set in C and let f : â„¦â†’X. Then f is analytic
on â„¦if for every z âˆˆâ„¦,
lim
hâ†’0
f (z + h) âˆ’f (z)
h
â‰¡f â€² (z)
exists and is a continuous function of z âˆˆâ„¦. Here h âˆˆC.
Note that if f is analytic, it must be the case that f is continuous. It is more
common to not include the requirement that f â€² is continuous but it is shown later
that the continuity of f â€² follows.
What are some examples of analytic functions? In the case where X = C, the
simplest example is any polynomial. Thus
p (z) â‰¡
n
X
k=0
akzk
is an analytic function and
pâ€² (z) =
n
X
k=1
akkzkâˆ’1.
More generally, power series are analytic. This will be shown soon but ï¬rst here is
an important deï¬nition and a convergence theorem called the root test.
Deï¬nition 24.2 Let {ak} be a sequence in X. Then Pâˆž
k=1 ak â‰¡limnâ†’âˆž
Pn
k=1 ak
whenever this limit exists. When the limit exists, the series is said to converge.
641

642
FUNDAMENTALS OF COMPLEX ANALYSIS
Theorem 24.3 Consider Pâˆž
k=1 ak and let Ï â‰¡lim supkâ†’âˆž||ak||1/k . Then if Ï < 1,
the series converges absolutely and if Ï > 1 the series diverges spectacularly in the
sense that limkâ†’âˆžak Ì¸= 0. If Ï = 1 the test fails. Also Pâˆž
k=1 ak (z âˆ’a)k converges
on some disk B (a, R) . It converges absolutely if |z âˆ’a| < R and uniformly on
B (a, r1) whenever r1 < R. The function f (z) = Pâˆž
k=1 ak (z âˆ’a)k is continuous on
B (a, R) .
Proof: Suppose Ï < 1. Then there exists r âˆˆ(Ï, 1) . Therefore, ||ak|| â‰¤rk for
all k large enough and so by a comparison test, P
k ||ak|| converges because the
partial sums are bounded above. Therefore, the partial sums of the original series
form a Cauchy sequence in X and so they also converge due to completeness of X.
Now suppose Ï > 1. Then letting Ï > r > 1, it follows ||ak||1/k â‰¥r inï¬nitely
often. Thus ||ak|| â‰¥rk inï¬nitely often. Thus there exists a subsequence for which
||ank|| converges to âˆž. Therefore, the series cannot converge.
Now consider Pâˆž
k=1 ak (z âˆ’a)k. This series converges absolutely if
lim sup
kâ†’âˆž
||ak||1/k |z âˆ’a| < 1
which is the same as saying |z âˆ’a| < 1/Ï where Ï â‰¡lim supkâ†’âˆž||ak||1/k. Let
R = 1/Ï.
Now suppose r1 < R. Consider |z âˆ’a| â‰¤r1. Then for such z,
||ak|| |z âˆ’a|k â‰¤||ak|| rk
1
and
lim sup
kâ†’âˆž
Â¡
||ak|| rk
1
Â¢1/k = lim sup
kâ†’âˆž
||ak||1/k r1 = r1
R < 1
so P
k ||ak|| rk
1 converges. By the Weierstrass M test, Pâˆž
k=1 ak (z âˆ’a)k converges
uniformly for |z âˆ’a| â‰¤r1. Therefore, f is continuous on B (a, R) as claimed because
it is the uniform limit of continuous functions, the partial sums of the inï¬nite series.
What if Ï = 0? In this case,
lim sup
kâ†’âˆž
||ak||1/k |z âˆ’a| = 0 Â· |z âˆ’a| = 0
and so R = âˆžand the series, P ||ak|| |z âˆ’a|k converges everywhere.
What if Ï = âˆž? Then in this case, the series converges only at z = a because if
z Ì¸= a,
lim sup
kâ†’âˆž
||ak||1/k |z âˆ’a| = âˆž.
Theorem 24.4 Let f (z) â‰¡Pâˆž
k=1 ak (z âˆ’a)k be given in Theorem 24.3 where R >
0. Then f is analytic on B (a, R) . So are all its derivatives.

24.1.
ANALYTIC FUNCTIONS
643
Proof: Consider g (z) = Pâˆž
k=2 akk (z âˆ’a)kâˆ’1 on B (a, R) where R = Ïâˆ’1 as
above. Let r1 < r < R. Then letting |z âˆ’a| < r1 and h < r âˆ’r1,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
f (z + h) âˆ’f (z)
h
âˆ’g (z)
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
âˆž
X
k=2
||ak||
Â¯Â¯Â¯Â¯Â¯
(z + h âˆ’a)k âˆ’(z âˆ’a)k
h
âˆ’k (z âˆ’a)kâˆ’1
Â¯Â¯Â¯Â¯Â¯
â‰¤
âˆž
X
k=2
||ak||
Â¯Â¯Â¯Â¯Â¯
1
h
Ãƒ k
X
i=0
Âµk
i
Â¶
(z âˆ’a)kâˆ’i hi âˆ’(z âˆ’a)k
!
âˆ’k (z âˆ’a)kâˆ’1
Â¯Â¯Â¯Â¯Â¯
=
âˆž
X
k=2
||ak||
Â¯Â¯Â¯Â¯Â¯
1
h
Ãƒ k
X
i=1
Âµk
i
Â¶
(z âˆ’a)kâˆ’i hi
!
âˆ’k (z âˆ’a)kâˆ’1
Â¯Â¯Â¯Â¯Â¯
â‰¤
âˆž
X
k=2
||ak||
Â¯Â¯Â¯Â¯Â¯
Ãƒ k
X
i=2
Âµk
i
Â¶
(z âˆ’a)kâˆ’i hiâˆ’1
!Â¯Â¯Â¯Â¯Â¯
â‰¤
|h|
âˆž
X
k=2
||ak||
Ãƒkâˆ’2
X
i=0
Âµ k
i + 2
Â¶
|z âˆ’a|kâˆ’2âˆ’i |h|i
!
=
|h|
âˆž
X
k=2
||ak||
Ãƒkâˆ’2
X
i=0
Âµk âˆ’2
i
Â¶
k (k âˆ’1)
(i + 2) (i + 1) |z âˆ’a|kâˆ’2âˆ’i |h|i
!
â‰¤
|h|
âˆž
X
k=2
||ak|| k (k âˆ’1)
2
Ãƒkâˆ’2
X
i=0
Âµk âˆ’2
i
Â¶
|z âˆ’a|kâˆ’2âˆ’i |h|i
!
=
|h|
âˆž
X
k=2
||ak|| k (k âˆ’1)
2
(|z âˆ’a| + |h|)kâˆ’2 < |h|
âˆž
X
k=2
||ak|| k (k âˆ’1)
2
rkâˆ’2.
Then
lim sup
kâ†’âˆž
Âµ
||ak|| k (k âˆ’1)
2
rkâˆ’2
Â¶1/k
= Ïr < 1
and so
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
f (z + h) âˆ’f (z)
h
âˆ’g (z)
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤C |h| .
therefore, g (z) = f â€² (z) . Now by Theorem 24.3 it also follows that f â€² is continuous.
Since r1 < R was arbitrary, this shows that f â€² (z) is given by the diï¬€erentiated
series above for |z âˆ’a| < R. Now a repeat of the argument shows all the derivatives
of f exist and are continuous on B (a, R).
24.1.1
Cauchy Riemann Equations
Next consider the very important Cauchy Riemann equations which give conditions
under which complex valued functions of a complex variable are analytic.

644
FUNDAMENTALS OF COMPLEX ANALYSIS
Theorem 24.5 Let â„¦be an open subset of C and let f : â„¦â†’C be a function,
such that for z = x + iy âˆˆâ„¦,
f (z) = u (x, y) + iv (x, y) .
Then f is analytic if and only if u, v are C1 (â„¦) and
âˆ‚u
âˆ‚x = âˆ‚v
âˆ‚y , âˆ‚u
âˆ‚y = âˆ’âˆ‚v
âˆ‚x.
Furthermore,
f â€² (z) = âˆ‚u
âˆ‚x (x, y) + iâˆ‚v
âˆ‚x (x, y) .
Proof: Suppose f is analytic ï¬rst. Then letting t âˆˆR,
f â€² (z) = lim
tâ†’0
f (z + t) âˆ’f (z)
t
=
lim
tâ†’0
Âµu (x + t, y) + iv (x + t, y)
t
âˆ’u (x, y) + iv (x, y)
t
Â¶
= âˆ‚u (x, y)
âˆ‚x
+ iâˆ‚v (x, y)
âˆ‚x
.
But also
f â€² (z) = lim
tâ†’0
f (z + it) âˆ’f (z)
it
=
lim
tâ†’0
Âµu (x, y + t) + iv (x, y + t)
it
âˆ’u (x, y) + iv (x, y)
it
Â¶
1
i
Âµâˆ‚u (x, y)
âˆ‚y
+ iâˆ‚v (x, y)
âˆ‚y
Â¶
= âˆ‚v (x, y)
âˆ‚y
âˆ’iâˆ‚u (x, y)
âˆ‚y
.
This veriï¬es the Cauchy Riemann equations. We are assuming that z â†’f â€² (z) is
continuous. Therefore, the partial derivatives of u and v are also continuous. To see
this, note that from the formulas for f â€² (z) given above, and letting z1 = x1 + iy1
Â¯Â¯Â¯Â¯
âˆ‚v (x, y)
âˆ‚y
âˆ’âˆ‚v (x1, y1)
âˆ‚y
Â¯Â¯Â¯Â¯ â‰¤|f â€² (z) âˆ’f â€² (z1)| ,
showing that (x, y) â†’âˆ‚v(x,y)
âˆ‚y
is continuous since (x1, y1) â†’(x, y) if and only if
z1 â†’z. The other cases are similar.
Now suppose the Cauchy Riemann equations hold and the functions, u and v
are C1 (â„¦) . Then letting h = h1 + ih2,
f (z + h) âˆ’f (z) = u (x + h1, y + h2)

24.1.
ANALYTIC FUNCTIONS
645
+iv (x + h1, y + h2) âˆ’(u (x, y) + iv (x, y))
We know u and v are both diï¬€erentiable and so
f (z + h) âˆ’f (z) = âˆ‚u
âˆ‚x (x, y) h1 + âˆ‚u
âˆ‚y (x, y) h2+
i
Âµâˆ‚v
âˆ‚x (x, y) h1 + âˆ‚v
âˆ‚y (x, y) h2
Â¶
+ o (h) .
Dividing by h and using the Cauchy Riemann equations,
f (z + h) âˆ’f (z)
h
=
âˆ‚u
âˆ‚x (x, y) h1 + i âˆ‚v
âˆ‚y (x, y) h2
h
+
i âˆ‚v
âˆ‚x (x, y) h1 + âˆ‚u
âˆ‚y (x, y) h2
h
+ o (h)
h
= âˆ‚u
âˆ‚x (x, y) h1 + ih2
h
+ iâˆ‚v
âˆ‚x (x, y) h1 + ih2
h
+ o (h)
h
Taking the limit as h â†’0,
f â€² (z) = âˆ‚u
âˆ‚x (x, y) + iâˆ‚v
âˆ‚x (x, y) .
It follows from this formula and the assumption that u, v are C1 (â„¦) that f â€² is
continuous.
It is routine to verify that all the usual rules of derivatives hold for analytic
functions. In particular, the product rule, the chain rule, and quotient rule.
24.1.2
An Important Example
An important example of an analytic function is ez â‰¡exp (z) â‰¡ex (cos y + i sin y)
where z = x + iy. You can verify that this function satisï¬es the Cauchy Riemann
equations and that all the partial derivatives are continuous. Also from the above
discussion, (ez)â€² = ex cos (y) + iex sin y = ez. Later I will show that ez is given by
the usual power series. An important property of this function is that it can be
used to parameterize the circle centered at z0 having radius r.
Lemma 24.6 Let Î³ denote the closed curve which is a circle of radius r centered
at z0. Then a parameterization this curve is Î³ (t) = z0 + reit where t âˆˆ[0, 2Ï€] .
Proof: |Î³ (t) âˆ’z0|2 =
Â¯Â¯reitreâˆ’itÂ¯Â¯ = r2. Also, you can see from the deï¬nition of
the sine and cosine that the point described in this way moves counter clockwise
over this circle.

646
FUNDAMENTALS OF COMPLEX ANALYSIS
24.2
Exercises
1. Verify all the usual rules of diï¬€erentiation including the product and chain
rules.
2. Suppose f and f â€² : U â†’C are analytic and f (z) = u (x, y) + iv (x, y) .
Verify uxx + uyy = 0 and vxx + vyy = 0. This partial diï¬€erential equation
satisï¬ed by the real and imaginary parts of an analytic function is called
Laplaceâ€™s equation. We say these functions satisfying Laplaceâ€™s equation are
harmonic functions. If u is a harmonic function deï¬ned on B (0, r) show that
v (x, y) â‰¡
R y
0 ux (x, t) dt âˆ’
R x
0 uy (t, 0) dt is such that u + iv is analytic.
3. Let f : U â†’C be analytic and f (z) = u (x, y) + iv (x, y) . Show u, v and uv
are all harmonic although it can happen that u2 is not. Recall that a function,
w is harmonic if wxx + wyy = 0.
4. Deï¬ne a function f (z) â‰¡z â‰¡x âˆ’iy where z = x + iy. Is f analytic?
5. If f (z) = u (x, y) + iv (x, y) and f is analytic, verify that
det
Âµ
ux
uy
vx
vy
Â¶
= |f â€² (z)|2 .
6. Show that if u (x, y) + iv (x, y) = f (z) is analytic, then âˆ‡u Â· âˆ‡v = 0. Recall
âˆ‡u (x, y) = âŸ¨ux (x, y) , uy (x, y)âŸ©.
7. Show that every polynomial is analytic.
8. If Î³ (t) = x (t)+iy (t) is a C1 curve having values in U, an open set of C, and if
f : U â†’C is analytic, we can consider f â—¦Î³, another C1 curve having values in
C. Also, Î³â€² (t) and (f â—¦Î³)â€² (t) are complex numbers so these can be considered
as vectors in R2 as follows. The complex number, x + iy corresponds to the
vector, âŸ¨x, yâŸ©. Suppose that Î³ and Î· are two such C1 curves having values in
U and that Î³ (t0) = Î· (s0) = z and suppose that f : U â†’C is analytic. Show
that the angle between (f â—¦Î³)â€² (t0) and (f â—¦Î·)â€² (s0) is the same as the angle
between Î³â€² (t0) and Î·â€² (s0) assuming that f â€² (z) Ì¸= 0. Thus analytic mappings
preserve angles at points where the derivative is nonzero.
Such mappings
are called isogonal. . Hint: To make this easy to show, ï¬rst observe that
âŸ¨x, yâŸ©Â· âŸ¨a, bâŸ©= 1
2 (zw + zw) where z = x + iy and w = a + ib.
9. Analytic functions are even better than what is described in Problem 8. In
addition to preserving angles, they also preserve orientation. To verify this
show that if z = x + iy and w = a + ib are two complex numbers, then
âŸ¨x, y, 0âŸ©and âŸ¨a, b, 0âŸ©are two vectors in R3. Recall that the cross product,
âŸ¨x, y, 0âŸ©Ã— âŸ¨a, b, 0âŸ©, yields a vector normal to the two given vectors such that
the triple, âŸ¨x, y, 0âŸ©, âŸ¨a, b, 0âŸ©, and âŸ¨x, y, 0âŸ©Ã— âŸ¨a, b, 0âŸ©satisï¬es the right hand rule

24.3.
CAUCHYâ€™S FORMULA FOR A DISK
647
and has magnitude equal to the product of the sine of the included angle
times the product of the two norms of the vectors. In this case, the cross
product either points in the direction of the positive z axis or in the direction
of the negative z axis. Thus, either the vectors âŸ¨x, y, 0âŸ©, âŸ¨a, b, 0âŸ©, k form a right
handed system or the vectors âŸ¨a, b, 0âŸ©, âŸ¨x, y, 0âŸ©, k form a right handed system.
These are the two possible orientations. Show that in the situation of Problem
8 the orientation of Î³â€² (t0) , Î·â€² (s0) , k is the same as the orientation of the
vectors (f â—¦Î³)â€² (t0) , (f â—¦Î·)â€² (s0) , k. Such mappings are called conformal. If f
is analytic and f â€² (z) Ì¸= 0, then we know from this problem and the above that
f is a conformal map. Hint: You can do this by verifying that (f â—¦Î³)â€² (t0) Ã—
(f â—¦Î·)â€² (s0) = |f â€² (Î³ (t0))|2 Î³â€² (t0) Ã— Î·â€² (s0). To make the veriï¬cation easier,
you might ï¬rst establish the following simple formula for the cross product
where here x + iy = z and a + ib = w.
(x, y, 0) Ã— (a, b, 0) = Re (ziw) k.
10. Write the Cauchy Riemann equations in terms of polar coordinates. Recall
the polar coordinates are given by
x = r cos Î¸, y = r sin Î¸.
This means, letting u (x, y) = u (r, Î¸) , v (x, y) = v (r, Î¸) , write the Cauchy Rie-
mann equations in terms of r and Î¸. You should eventually show the Cauchy
Riemann equations are equivalent to
âˆ‚u
âˆ‚r = 1
r
âˆ‚v
âˆ‚Î¸ ,
âˆ‚v
âˆ‚r = âˆ’1
r
âˆ‚u
âˆ‚Î¸
11. Show that a real valued analytic function must be constant.
24.3
Cauchyâ€™s Formula For A Disk
The Cauchy integral formula is the most important theorem in complex analysis.
It will be established for a disk in this chapter and later will be generalized to
much more general situations but the version given here will suï¬ƒce to prove many
interesting theorems needed in the later development of the theory. The following
are some advanced calculus results.
Lemma 24.7 Let f : [a, b] â†’C. Then f â€² (t) exists if and only if Re f â€² (t) and
Im f â€² (t) exist. Furthermore,
f â€² (t) = Re f â€² (t) + i Im f â€² (t) .
Proof: The if part of the equivalence is obvious.
Now suppose f â€² (t) exists. Let both t and t + h be contained in [a, b]
Â¯Â¯Â¯Â¯
Re f (t + h) âˆ’Re f (t)
h
âˆ’Re (f â€² (t))
Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯
f (t + h) âˆ’f (t)
h
âˆ’f â€² (t)
Â¯Â¯Â¯Â¯

648
FUNDAMENTALS OF COMPLEX ANALYSIS
and this converges to zero as h â†’0. Therefore, Re f â€² (t) = Re (f â€² (t)) . Similarly,
Im f â€² (t) = Im (f â€² (t)) .
Lemma 24.8 If g : [a, b] â†’C and g is continuous on [a, b] and diï¬€erentiable on
(a, b) with gâ€² (t) = 0, then g (t) is a constant.
Proof: From the above lemma, you can apply the mean value theorem to the
real and imaginary parts of g.
Applying the above lemma to the components yields the following lemma.
Lemma 24.9 If g : [a, b] â†’Cn = X and g is continuous on [a, b] and diï¬€erentiable
on (a, b) with gâ€² (t) = 0, then g (t) is a constant.
If you want to have X be a complex Banach space, the result is still true.
Lemma 24.10 If g : [a, b] â†’X and g is continuous on [a, b] and diï¬€erentiable on
(a, b) with gâ€² (t) = 0, then g (t) is a constant.
Proof: Let Î› âˆˆXâ€². Then Î›g : [a, b] â†’C . Therefore, from Lemma 24.8, for each
Î› âˆˆXâ€², Î›g (s) = Î›g (t) and since Xâ€² separates the points, it follows g (s) = g (t) so
g is constant.
Lemma 24.11 Let Ï† : [a, b] Ã— [c, d] â†’R be continuous and let
g (t) â‰¡
Z b
a
Ï† (s, t) ds.
(24.1)
Then g is continuous. If âˆ‚Ï†
âˆ‚t exists and is continuous on [a, b] Ã— [c, d] , then
gâ€² (t) =
Z b
a
âˆ‚Ï† (s, t)
âˆ‚t
ds.
(24.2)
Proof: The ï¬rst claim follows from the uniform continuity of Ï† on [a, b]Ã—[c, d] ,
which uniform continuity results from the set being compact. To establish 24.2, let
t and t + h be contained in [c, d] and form, using the mean value theorem,
g (t + h) âˆ’g (t)
h
=
1
h
Z b
a
[Ï† (s, t + h) âˆ’Ï† (s, t)] ds
=
1
h
Z b
a
âˆ‚Ï† (s, t + Î¸h)
âˆ‚t
hds
=
Z b
a
âˆ‚Ï† (s, t + Î¸h)
âˆ‚t
ds,
where Î¸ may depend on s but is some number between 0 and 1. Then by the uniform
continuity of âˆ‚Ï†
âˆ‚t , it follows that 24.2 holds.

24.3.
CAUCHYâ€™S FORMULA FOR A DISK
649
Corollary 24.12 Let Ï† : [a, b] Ã— [c, d] â†’C be continuous and let
g (t) â‰¡
Z b
a
Ï† (s, t) ds.
(24.3)
Then g is continuous. If âˆ‚Ï†
âˆ‚t exists and is continuous on [a, b] Ã— [c, d] , then
gâ€² (t) =
Z b
a
âˆ‚Ï† (s, t)
âˆ‚t
ds.
(24.4)
Proof: Apply Lemma 24.11 to the real and imaginary parts of Ï†.
Applying the above corollary to the components, you can also have the same
result for Ï† having values in Cn.
Corollary 24.13 Let Ï† : [a, b] Ã— [c, d] â†’Cn be continuous and let
g (t) â‰¡
Z b
a
Ï† (s, t) ds.
(24.5)
Then g is continuous. If âˆ‚Ï†
âˆ‚t exists and is continuous on [a, b] Ã— [c, d] , then
gâ€² (t) =
Z b
a
âˆ‚Ï† (s, t)
âˆ‚t
ds.
(24.6)
If you want to consider Ï† having values in X, a complex Banach space a similar
result holds.
Corollary 24.14 Let Ï† : [a, b] Ã— [c, d] â†’X be continuous and let
g (t) â‰¡
Z b
a
Ï† (s, t) ds.
(24.7)
Then g is continuous. If âˆ‚Ï†
âˆ‚t exists and is continuous on [a, b] Ã— [c, d] , then
gâ€² (t) =
Z b
a
âˆ‚Ï† (s, t)
âˆ‚t
ds.
(24.8)
Proof: Let Î› âˆˆXâ€². Then Î›Ï† : [a, b] Ã— [c, d] â†’C is continuous and âˆ‚Î›Ï†
âˆ‚t
exists
and is continuous on [a, b] Ã— [c, d] . Therefore, from 24.8,
Î› (gâ€² (t)) = (Î›g)â€² (t) =
Z b
a
âˆ‚Î›Ï† (s, t)
âˆ‚t
ds = Î›
Z b
a
âˆ‚Ï† (s, t)
âˆ‚t
ds
and since Xâ€² separates the points, it follows 24.8 holds.
The following is Cauchyâ€™s integral formula for a disk.

650
FUNDAMENTALS OF COMPLEX ANALYSIS
Theorem 24.15 Let f : â„¦â†’X be analytic on the open set, â„¦and let
B (z0, r) âŠ†â„¦.
Let Î³ (t) â‰¡z0 + reit for t âˆˆ[0, 2Ï€] . Then if z âˆˆB (z0, r) ,
f (z) =
1
2Ï€i
Z
Î³
f (w)
w âˆ’z dw.
(24.9)
Proof: Consider for Î± âˆˆ[0, 1] ,
g (Î±) â‰¡
Z 2Ï€
0
f
Â¡
z + Î±
Â¡
z0 + reit âˆ’z
Â¢Â¢
reit + z0 âˆ’z
rieitdt.
If Î± equals one, this reduces to the integral in 24.9. The idea is to show g is a
constant and that g (0) = f (z) 2Ï€i. First consider the claim about g (0) .
g (0)
=
ÂµZ 2Ï€
0
reit
reit + z0 âˆ’z dt
Â¶
if (z)
=
if (z)
ÂµZ 2Ï€
0
1
1 âˆ’zâˆ’z0
reit
dt
Â¶
=
if (z)
Z 2Ï€
0
âˆž
X
n=0
râˆ’neâˆ’int (z âˆ’z0)n dt
because
Â¯Â¯ zâˆ’z0
reit
Â¯Â¯ < 1. Since this sum converges uniformly you can interchange the
sum and the integral to obtain
g (0)
=
if (z)
âˆž
X
n=0
râˆ’n (z âˆ’z0)n
Z 2Ï€
0
eâˆ’intdt
=
2Ï€if (z)
because
R 2Ï€
0
eâˆ’intdt = 0 if n > 0.
Next consider the claim that g is constant. By Corollary 24.13, for Î± âˆˆ(0, 1) ,
gâ€² (Î±)
=
Z 2Ï€
0
f â€² Â¡
z + Î±
Â¡
z0 + reit âˆ’z
Â¢Â¢ Â¡
reit + z0 âˆ’z
Â¢
reit + z0 âˆ’z
rieitdt
=
Z 2Ï€
0
f â€² Â¡
z + Î±
Â¡
z0 + reit âˆ’z
Â¢Â¢
rieitdt
=
Z 2Ï€
0
d
dt
Âµ
f
Â¡
z + Î±
Â¡
z0 + reit âˆ’z
Â¢Â¢ 1
Î±
Â¶
dt
=
f
Â¡
z + Î±
Â¡
z0 + rei2Ï€ âˆ’z
Â¢Â¢ 1
Î± âˆ’f
Â¡
z + Î±
Â¡
z0 + re0 âˆ’z
Â¢Â¢ 1
Î± = 0.
Now g is continuous on [0, 1] and gâ€² (t) = 0 on (0, 1) so by Lemma 24.9, g equals a
constant. This constant can only be g (0) = 2Ï€if (z) . Thus,
g (1) =
Z
Î³
f (w)
w âˆ’z dw = g (0) = 2Ï€if (z) .

24.3.
CAUCHYâ€™S FORMULA FOR A DISK
651
This proves the theorem.
This is a very signiï¬cant theorem. A few applications are given next.
Theorem 24.16 Let f : â„¦â†’X be analytic where â„¦is an open set in C. Then f
has inï¬nitely many derivatives on â„¦. Furthermore, for all z âˆˆB (z0, r) ,
f (n) (z) = n!
2Ï€i
Z
Î³
f (w)
(w âˆ’z)n+1 dw
(24.10)
where Î³ (t) â‰¡z0 + reit, t âˆˆ[0, 2Ï€] for r small enough that B (z0, r) âŠ†â„¦.
Proof:
Let z âˆˆB (z0, r) âŠ†â„¦and let B (z0, r) âŠ†â„¦. Then, letting Î³ (t) â‰¡
z0 + reit, t âˆˆ[0, 2Ï€] , and h small enough,
f (z) =
1
2Ï€i
Z
Î³
f (w)
w âˆ’z dw, f (z + h) =
1
2Ï€i
Z
Î³
f (w)
w âˆ’z âˆ’hdw
Now
1
w âˆ’z âˆ’h âˆ’
1
w âˆ’z =
h
(âˆ’w + z + h) (âˆ’w + z)
and so
f (z + h) âˆ’f (z)
h
=
1
2Ï€hi
Z
Î³
hf (w)
(âˆ’w + z + h) (âˆ’w + z)dw
=
1
2Ï€i
Z
Î³
f (w)
(âˆ’w + z + h) (âˆ’w + z)dw.
Now for all h suï¬ƒciently small, there exists a constant C independent of such h
such that
Â¯Â¯Â¯Â¯
1
(âˆ’w + z + h) (âˆ’w + z) âˆ’
1
(âˆ’w + z) (âˆ’w + z)
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
h
(w âˆ’z âˆ’h) (w âˆ’z)2
Â¯Â¯Â¯Â¯Â¯ â‰¤C |h|
and so, the integrand converges uniformly as h â†’0 to
=
f (w)
(w âˆ’z)2
Therefore, the limit as h â†’0 may be taken inside the integral to obtain
f â€² (z) =
1
2Ï€i
Z
Î³
f (w)
(w âˆ’z)2 dw.
Continuing in this way, yields 24.10.
This is a very remarkable result. It shows the existence of one continuous deriva-
tive implies the existence of all derivatives, in contrast to the theory of functions of
a real variable. Actually, more than what is stated in the theorem was shown. The
above proof establishes the following corollary.

652
FUNDAMENTALS OF COMPLEX ANALYSIS
Corollary 24.17 Suppose f is continuous on âˆ‚B (z0, r) and suppose that for all
z âˆˆB (z0, r) ,
f (z) =
1
2Ï€i
Z
Î³
f (w)
w âˆ’z dw,
where Î³ (t) â‰¡z0 + reit, t âˆˆ[0, 2Ï€] . Then f is analytic on B (z0, r) and in fact has
inï¬nitely many derivatives on B (z0, r) .
Another application is the following lemma.
Lemma 24.18 Let Î³ (t) = z0 + reit, for t âˆˆ[0, 2Ï€], suppose fn â†’f uniformly on
B (z0, r), and suppose
fn (z) =
1
2Ï€i
Z
Î³
fn (w)
w âˆ’z dw
(24.11)
for z âˆˆB (z0, r) . Then
f (z) =
1
2Ï€i
Z
Î³
f (w)
w âˆ’z dw,
(24.12)
implying that f is analytic on B (z0, r) .
Proof: From 24.11 and the uniform convergence of fn to f on Î³ ([0, 2Ï€]) , the
integrals in 24.11 converge to
1
2Ï€i
Z
Î³
f (w)
w âˆ’z dw.
Therefore, the formula 24.12 follows.
Uniform convergence on a closed disk of the analytic functions implies the target
function is also analytic. This is amazing. Think of the Weierstrass approximation
theorem for polynomials. You can obtain a continuous nowhere diï¬€erentiable func-
tion as the uniform limit of polynomials.
The conclusions of the following proposition have all been obtained earlier in
Theorem 24.4 but they can be obtained more easily if you use the above theorem
and lemmas.
Proposition 24.19 Let {an} denote a sequence in X. Then there exists R âˆˆ[0, âˆž]
such that
âˆž
X
k=0
ak (z âˆ’z0)k
converges absolutely if |z âˆ’z0| < R, diverges if |z âˆ’z0| > R and converges uniformly
on B (z0, r) for all r < R. Furthermore, if R > 0, the function,
f (z) â‰¡
âˆž
X
k=0
ak (z âˆ’z0)k
is analytic on B (z0, R) .

24.3.
CAUCHYâ€™S FORMULA FOR A DISK
653
Proof: The assertions about absolute convergence are routine from the root test
if
R â‰¡
Âµ
lim sup
nâ†’âˆž|an|1/n
Â¶âˆ’1
with R = âˆžif the quantity in parenthesis equals zero. The root test can be used
to verify absolute convergence which then implies convergence by completeness of
X.
The assertion about uniform convergence follows from the Weierstrass M test
and Mn â‰¡|an| rn. ( Pâˆž
n=0 |an| rn < âˆžby the root test). It only remains to verify
the assertion about f (z) being analytic in the case where R > 0.
Let 0 < r < R and deï¬ne fn (z) â‰¡Pn
k=0 ak (z âˆ’z0)k . Then fn is a polynomial
and so it is analytic. Thus, by the Cauchy integral formula above,
fn (z) =
1
2Ï€i
Z
Î³
fn (w)
w âˆ’z dw
where Î³ (t) = z0 + reit, for t âˆˆ[0, 2Ï€] . By Lemma 24.18 and the ï¬rst part of this
proposition involving uniform convergence,
f (z) =
1
2Ï€i
Z
Î³
f (w)
w âˆ’z dw.
Therefore, f is analytic on B (z0, r) by Corollary 24.17. Since r < R is arbitrary,
this shows f is analytic on B (z0, R) .
This proposition shows that all functions having values in X which are given as
power series are analytic on their circle of convergence, the set of complex numbers,
z, such that |z âˆ’z0| < R. In fact, every analytic function can be realized as a power
series.
Theorem 24.20 If f : â„¦â†’X is analytic and if B (z0, r) âŠ†â„¦, then
f (z) =
âˆž
X
n=0
an (z âˆ’z0)n
(24.13)
for all |z âˆ’z0| < r. Furthermore,
an = f (n) (z0)
n!
.
(24.14)
Proof: Consider |z âˆ’z0| < r and let Î³ (t) = z0 + reit, t âˆˆ[0, 2Ï€] . Then for
w âˆˆÎ³ ([0, 2Ï€]) ,
Â¯Â¯Â¯Â¯
z âˆ’z0
w âˆ’z0
Â¯Â¯Â¯Â¯ < 1

654
FUNDAMENTALS OF COMPLEX ANALYSIS
and so, by the Cauchy integral formula,
f (z)
=
1
2Ï€i
Z
Î³
f (w)
w âˆ’z dw
=
1
2Ï€i
Z
Î³
f (w)
(w âˆ’z0)
Â³
1 âˆ’zâˆ’z0
wâˆ’z0
Â´dw
=
1
2Ï€i
Z
Î³
f (w)
(w âˆ’z0)
âˆž
X
n=0
Âµ z âˆ’z0
w âˆ’z0
Â¶n
dw.
Since the series converges uniformly, you can interchange the integral and the sum
to obtain
f (z)
=
âˆž
X
n=0
Ãƒ
1
2Ï€i
Z
Î³
f (w)
(w âˆ’z0)n+1
!
(z âˆ’z0)n
â‰¡
âˆž
X
n=0
an (z âˆ’z0)n
By Theorem 24.16, 24.14 holds.
Note that this also implies that if a function is analytic on an open set, then all
of its derivatives are also analytic. This follows from Theorem 24.4 which says that
a function given by a power series has all derivatives on the disk of convergence.
24.4
Exercises
1. Show that if |ek| â‰¤Îµ, then
Â¯Â¯Pâˆž
k=m ek
Â¡
rk âˆ’rk+1Â¢Â¯Â¯ < Îµ if 0 â‰¤r < 1. Hint:
Let |Î¸| = 1 and verify that
Î¸
âˆž
X
k=m
ek
Â¡
rk âˆ’rk+1Â¢
=
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=m
ek
Â¡
rk âˆ’rk+1Â¢
Â¯Â¯Â¯Â¯Â¯ =
âˆž
X
k=m
Re (Î¸ek)
Â¡
rk âˆ’rk+1Â¢
where âˆ’Îµ < Re (Î¸ek) < Îµ.
2. Abelâ€™s theorem says that if Pâˆž
n=0 an (z âˆ’a)n has radius of convergence equal
to 1 and if A = Pâˆž
n=0 an, then limrâ†’1âˆ’
Pâˆž
n=0 anrn = A. Hint:
Show
Pâˆž
k=0 akrk = Pâˆž
k=0 Ak
Â¡
rk âˆ’rk+1Â¢
where Ak denotes the kth partial sum
of P aj. Thus
âˆž
X
k=0
akrk =
âˆž
X
k=m+1
Ak
Â¡
rk âˆ’rk+1Â¢
+
m
X
k=0
Ak
Â¡
rk âˆ’rk+1Â¢
,
where |Ak âˆ’A| < Îµ for all k â‰¥m. In the ï¬rst sum, write Ak = A+ek and use
Problem 1. Use this theorem to verify that arctan (1) = Pâˆž
k=0 (âˆ’1)k
1
2k+1.

24.4.
EXERCISES
655
3. Find the integrals using the Cauchy integral formula.
(a)
R
Î³
sin z
zâˆ’i dz where Î³ (t) = 2eit : t âˆˆ[0, 2Ï€] .
(b)
R
Î³
1
zâˆ’adz where Î³ (t) = a + reit : t âˆˆ[0, 2Ï€]
(c)
R
Î³
cos z
z2 dz where Î³ (t) = eit : t âˆˆ[0, 2Ï€]
(d)
R
Î³
log(z)
zn dz where Î³ (t) = 1 + 1
2eit : t âˆˆ[0, 2Ï€] and n = 0, 1, 2. In this
problem, log (z) â‰¡ln |z| + i arg (z) where arg (z) âˆˆ(âˆ’Ï€, Ï€) and z =
|z| ei arg(z). Thus elog(z) = z and log (z)â€² = 1
z.
4. Let Î³ (t) = 4eit : t âˆˆ[0, 2Ï€] and ï¬nd
R
Î³
z2+4
z(z2+1)dz.
5. Suppose f (z) = Pâˆž
n=0 anzn for all |z| < R. Show that then
1
2Ï€
Z 2Ï€
0
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯2 dÎ¸ =
âˆž
X
n=0
|an|2 r2n
for all r âˆˆ[0, R). Hint: Let
fn (z) â‰¡
n
X
k=0
akzk,
show
1
2Ï€
Z 2Ï€
0
Â¯Â¯fn
Â¡
reiÎ¸Â¢Â¯Â¯2 dÎ¸ =
n
X
k=0
|ak|2 r2k
and then take limits as n â†’âˆžusing uniform convergence.
6. The Cauchy integral formula, marvelous as it is, can actually be improved
upon. The Cauchy integral formula involves representing f by the values of
f on the boundary of the disk, B (a, r) . It is possible to represent f by using
only the values of Re f on the boundary. This leads to the Schwarz formula .
Supply the details in the following outline.
Suppose f is analytic on |z| < R and
f (z) =
âˆž
X
n=0
anzn
(24.15)
with the series converging uniformly on |z| = R. Then letting |w| = R,
2u (w) = f (w) + f (w)
and so
2u (w) =
âˆž
X
k=0
akwk +
âˆž
X
k=0
ak (w)k .
(24.16)

656
FUNDAMENTALS OF COMPLEX ANALYSIS
Now letting Î³ (t) = Reit, t âˆˆ[0, 2Ï€]
Z
Î³
2u (w)
w
dw
=
(a0 + a0)
Z
Î³
1
wdw
=
2Ï€i (a0 + a0) .
Thus, multiplying 24.16 by wâˆ’1,
1
Ï€i
Z
Î³
u (w)
w
dw = a0 + a0.
Now multiply 24.16 by wâˆ’(n+1) and integrate again to obtain
an = 1
Ï€i
Z
Î³
u (w)
wn+1 dw.
Using these formulas for an in 24.15, we can interchange the sum and the
integral (Why can we do this?) to write the following for |z| < R.
f (z)
=
1
Ï€i
Z
Î³
1
z
âˆž
X
k=0
Â³ z
w
Â´k+1
u (w) dw âˆ’a0
=
1
Ï€i
Z
Î³
u (w)
w âˆ’z dw âˆ’a0,
which is the Schwarz formula. Now Re a0 =
1
2Ï€i
R
Î³
u(w)
w dw and a0 = Re a0 âˆ’
i Im a0. Therefore, we can also write the Schwarz formula as
f (z) =
1
2Ï€i
Z
Î³
u (w) (w + z)
(w âˆ’z) w
dw + i Im a0.
(24.17)
7. Take the real parts of the second form of the Schwarz formula to derive the
Poisson formula for a disk,
u
Â¡
reiÎ±Â¢
= 1
2Ï€
Z 2Ï€
0
u
Â¡
ReiÎ¸Â¢ Â¡
R2 âˆ’r2Â¢
R2 + r2 âˆ’2Rr cos (Î¸ âˆ’Î±)dÎ¸.
(24.18)
8. Suppose that u (w) is a given real continuous function deï¬ned on âˆ‚B (0, R)
and deï¬ne f (z) for |z| < R by 24.17. Show that f, so deï¬ned is analytic.
Explain why u given in 24.18 is harmonic. Show that
lim
râ†’Râˆ’u
Â¡
reiÎ±Â¢
= u
Â¡
ReiÎ±Â¢
.
Thus u is a harmonic function which approaches a given function on the
boundary and is therefore, a solution to the Dirichlet problem.

24.5.
ZEROS OF AN ANALYTIC FUNCTION
657
9. Suppose f (z) = Pâˆž
k=0 ak (z âˆ’z0)k for all |z âˆ’z0| < R. Show that f â€² (z) =
Pâˆž
k=0 akk (z âˆ’z0)kâˆ’1 for all |z âˆ’z0| < R. Hint: Let fn (z) be a partial sum
of f. Show that f â€²
n converges uniformly to some function, g on |z âˆ’z0| â‰¤r
for any r < R. Now use the Cauchy integral formula for a function and its
derivative to identify g with f â€².
10. Use Problem 9 to ï¬nd the exact value of Pâˆž
k=0 k2 Â¡ 1
3
Â¢k .
11. Prove the binomial formula,
(1 + z)Î± =
âˆž
X
n=0
ÂµÎ±
n
Â¶
zn
where
ÂµÎ±
n
Â¶
â‰¡Î± Â· Â· Â· (Î± âˆ’n + 1)
n!
.
Can this be used to give a proof of the binomial formula,
(a + b)n =
n
X
k=0
Âµn
k
Â¶
anâˆ’kbk?
Explain.
12. Suppose f is analytic on B (z0, r) and continuous on B (z0, r) and |f (z)| â‰¤M
on B (z0, r). Show that then
Â¯Â¯f (n) (a)
Â¯Â¯ â‰¤Mn!
rn .
24.5
Zeros Of An Analytic Function
In this section we give a very surprising property of analytic functions which is in
stark contrast to what takes place for functions of a real variable.
Deï¬nition 24.21 A region is a connected open set.
It turns out the zeros of an analytic function which is not constant on some
region cannot have a limit point. This is also a good time to deï¬ne the order of a
zero.
Deï¬nition 24.22 Suppose f is an analytic function deï¬ned near a point, Î± where
f (Î±) = 0. Thus Î± is a zero of the function, f. The zero is of order m if f (z) =
(z âˆ’Î±)m g (z) where g is an analytic function which is not equal to zero at Î±.
Theorem 24.23 Let â„¦be a connected open set (region) and let f : â„¦â†’X be
analytic. Then the following are equivalent.
1. f (z) = 0 for all z âˆˆâ„¦
2. There exists z0 âˆˆâ„¦such that f (n) (z0) = 0 for all n.

658
FUNDAMENTALS OF COMPLEX ANALYSIS
3. There exists z0 âˆˆâ„¦which is a limit point of the set,
Z â‰¡{z âˆˆâ„¦: f (z) = 0} .
Proof: It is clear the ï¬rst condition implies the second two. Suppose the third
holds. Then for z near z0
f (z) =
âˆž
X
n=k
f (n) (z0)
n!
(z âˆ’z0)n
where k â‰¥1 since z0 is a zero of f. Suppose k < âˆž. Then,
f (z) = (z âˆ’z0)k g (z)
where g (z0) Ì¸= 0. Letting zn â†’z0 where zn âˆˆZ, zn Ì¸= z0, it follows
0 = (zn âˆ’z0)k g (zn)
which implies g (zn) = 0. Then by continuity of g, we see that g (z0) = 0 also,
contrary to the choice of k. Therefore, k cannot be less than âˆžand so z0 is a point
satisfying the second condition.
Now suppose the second condition and let
S â‰¡
n
z âˆˆâ„¦: f (n) (z) = 0 for all n
o
.
It is clear that S is a closed set which by assumption is nonempty. However, this
set is also open. To see this, let z âˆˆS. Then for all w close enough to z,
f (w) =
âˆž
X
k=0
f (k) (z)
k!
(w âˆ’z)k = 0.
Thus f is identically equal to zero near z âˆˆS. Therefore, all points near z are
contained in S also, showing that S is an open set. Now â„¦= S âˆª(â„¦\ S) , the union
of two disjoint open sets, S being nonempty. It follows the other open set, â„¦\ S,
must be empty because â„¦is connected. Therefore, the ï¬rst condition is veriï¬ed.
This proves the theorem. (See the following diagram.)
1.)
â†™â†—
â†˜
2.)
â†âˆ’
3.)
Note how radically diï¬€erent this is from the theory of functions of a real variable.
Consider, for example the function
f (x) â‰¡
Â½
x2 sin
Â¡ 1
x
Â¢
if x Ì¸= 0
0 if x = 0

24.6.
LIOUVILLEâ€™S THEOREM
659
which has a derivative for all x âˆˆR and for which 0 is a limit point of the set, Z,
even though f is not identically equal to zero.
Here is a very important application called Eulerâ€™s formula. Recall that
ez â‰¡ex (cos (y) + i sin (y))
(24.19)
Is it also true that ez = Pâˆž
k=0
zk
k! ?
Theorem 24.24 (Eulerâ€™s Formula) Let z = x + iy. Then
ez =
âˆž
X
k=0
zk
k! .
Proof: It was already observed that ez given by 24.19 is analytic. So is exp (z) â‰¡
Pâˆž
k=0
zk
k! . In fact the power series converges for all z âˆˆC. Furthermore the two
functions, ez and exp (z) agree on the real line which is a set which contains a limit
point. Therefore, they agree for all values of z âˆˆC.
This formula shows the famous two identities,
eiÏ€ = âˆ’1 and e2Ï€i = 1.
24.6
Liouvilleâ€™s Theorem
The following theorem pertains to functions which are analytic on all of C, â€œentireâ€
functions.
Deï¬nition 24.25 A function, f : C â†’C or more generally, f : C â†’X is entire
means it is analytic on C.
Theorem 24.26 (Liouvilleâ€™s theorem) If f is a bounded entire function having
values in X, then f is a constant.
Proof: Since f is entire, pick any z âˆˆC and write
f â€² (z) =
1
2Ï€i
Z
Î³R
f (w)
(w âˆ’z)2 dw
where Î³R (t) = z + Reit for t âˆˆ[0, 2Ï€] . Therefore,
||f â€² (z)|| â‰¤C 1
R
where C is some constant depending on
the assumed bound on f. Since R is
arbitrary, let R â†’âˆžto obtain f â€² (z) = 0 for any z âˆˆC. It follows from this that f
is constant for if zj j = 1, 2 are two complex numbers, let h (t) = f (z1 + t (z2 âˆ’z1))
for t âˆˆ[0, 1] . Then hâ€² (t) = f â€² (z1 + t (z2 âˆ’z1)) (z2 âˆ’z1) = 0. By Lemmas 24.8 -
24.10 h is a constant on [0, 1] which implies f (z1) = f (z2) .

660
FUNDAMENTALS OF COMPLEX ANALYSIS
With Liouvilleâ€™s theorem it becomes possible to give an easy proof of the fun-
damental theorem of algebra. It is ironic that all the best proofs of this theorem
in algebra come from the subjects of analysis or topology. Out of all the proofs
that have been given of this very important theorem, the following one based on
Liouvilleâ€™s theorem is the easiest.
Theorem 24.27 (Fundamental theorem of Algebra) Let
p (z) = zn + anâˆ’1znâˆ’1 + Â· Â· Â· + a1z + a0
be a polynomial where n â‰¥1 and each coeï¬ƒcient is a complex number. Then there
exists z0 âˆˆC such that p (z0) = 0.
Proof: Suppose not. Then p (z)âˆ’1 is an entire function. Also
|p (z)| â‰¥|z|n âˆ’
Â³
|anâˆ’1| |z|nâˆ’1 + Â· Â· Â· + |a1| |z| + |a0|
Â´
and so lim|z|â†’âˆž|p (z)| = âˆžwhich implies lim|z|â†’âˆž
Â¯Â¯Â¯p (z)âˆ’1Â¯Â¯Â¯ = 0. It follows that,
since p (z)âˆ’1 is bounded for z in any bounded set, we must have that p (z)âˆ’1 is a
bounded entire function. But then it must be constant. However since p (z)âˆ’1 â†’0
as |z| â†’âˆž, this constant can only be 0. However,
1
p(z) is never equal to zero. This
proves the theorem.
24.7
The General Cauchy Integral Formula
24.7.1
The Cauchy Goursat Theorem
This section gives a fundamental theorem which is essential to the development
which follows and is closely related to the question of when a function has a
primitive. First of all, if you have two points in C, z1 and z2, you can consider
Î³ (t) â‰¡z1 + t (z2 âˆ’z1) for t âˆˆ[0, 1] to obtain a continuous bounded variation curve
from z1 to z2. More generally, if z1, Â· Â· Â·, zm are points in C you can obtain a contin-
uous bounded variation curve from z1 to zm which consists of ï¬rst going from z1 to
z2 and then from z2 to z3 and so on, till in the end one goes from zmâˆ’1 to zm. We
denote this piecewise linear curve as Î³ (z1, Â· Â· Â·, zm) . Now let T be a triangle with
vertices z1, z2 and z3 encountered in the counter clockwise direction as shown.
Â¡
Â¡
Â¡
Â¡
Â¡@
@
@
@
@
z1
z2
z3
Denote by
R
âˆ‚T f (z) dz, the expression,
R
Î³(z1,z2,z3,z1) f (z) dz. Consider the fol-

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
661
lowing picture.
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
-
@
@
@
@
@
@
@
@
@
Â¡
Â¡
Â¡
Âª
Â¡
Â¡
Â¡
Âª
-
T
T 1
1
T 1
2
T 1
3
T 1
4
@
@
@
I
@
@
@
I
Â¡
Â¡
Âª

-
@@
R
Â¡Â¡

@
@
I
@
@
@
@
@Â¡
Â¡
Â¡
Â¡
Â¡
z1
z2
z3
By Lemma 23.11
Z
âˆ‚T
f (z) dz =
4
X
k=1
Z
âˆ‚T 1
k
f (z) dz.
(24.20)
On the â€œinside linesâ€ the integrals cancel as claimed in Lemma 23.11 because there
are two integrals going in opposite directions for each of these inside lines.
Theorem 24.28 (Cauchy Goursat) Let f : â„¦â†’X have the property that f â€² (z)
exists for all z âˆˆâ„¦and let T be a triangle contained in â„¦. Then
Z
âˆ‚T
f (w) dw = 0.
Proof: Suppose not. Then
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
âˆ‚T
f (w) dw
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ = Î± Ì¸= 0.
From 24.20 it follows
Î± â‰¤
4
X
k=1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z
âˆ‚T 1
k
f (w) dw
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
and so for at least one of these T 1
k , denoted from now on as T1,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
âˆ‚T1
f (w) dw
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¥Î±
4 .
Now let T1 play the same role as T, subdivide as in the above picture, and obtain
T2 such that
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
âˆ‚T2
f (w) dw
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¥Î±
42 .
Continue in this way, obtaining a sequence of triangles,
Tk âŠ‡Tk+1, diam (Tk) â‰¤diam (T) 2âˆ’k,
and
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
âˆ‚Tk
f (w) dw
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¥Î±
4k .

662
FUNDAMENTALS OF COMPLEX ANALYSIS
Then let z âˆˆâˆ©âˆž
k=1Tk and note that by assumption, f â€² (z) exists. Therefore, for all
k large enough,
Z
âˆ‚Tk
f (w) dw =
Z
âˆ‚Tk
f (z) + f â€² (z) (w âˆ’z) + g (w) dw
where ||g (w)|| < Îµ |w âˆ’z| . Now observe that w â†’f (z) + f â€² (z) (w âˆ’z) has a
primitive, namely,
F (w) = f (z) w + f â€² (z) (w âˆ’z)2 /2.
Therefore, by Corollary 23.14.
Z
âˆ‚Tk
f (w) dw =
Z
âˆ‚Tk
g (w) dw.
From the deï¬nition, of the integral,
Î±
4k
â‰¤
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
âˆ‚Tk
g (w) dw
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤Îµ diam (Tk) (length of âˆ‚Tk)
â‰¤
Îµ2âˆ’k (length of T) diam (T) 2âˆ’k,
and so
Î± â‰¤Îµ (length of T) diam (T) .
Since Îµ is arbitrary, this shows Î± = 0, a contradiction. Thus
R
âˆ‚T f (w) dw = 0 as
claimed.
This fundamental result yields the following important theorem.
Theorem 24.29 (Morera1) Let â„¦be an open set and let f â€² (z) exist for all z âˆˆâ„¦.
Let D â‰¡B (z0, r) âŠ†â„¦. Then there exists Îµ > 0 such that f has a primitive on
B (z0, r + Îµ).
Proof: Choose Îµ > 0 small enough that B (z0, r + Îµ) âŠ†â„¦. Then for w âˆˆ
B (z0, r + Îµ) , deï¬ne
F (w) â‰¡
Z
Î³(z0,w)
f (u) du.
Then by the Cauchy Goursat theorem, and w âˆˆB (z0, r + Îµ) , it follows that for |h|
small enough,
F (w + h) âˆ’F (w)
h
= 1
h
Z
Î³(w,w+h)
f (u) du
= 1
h
Z 1
0
f (w + th) hdt =
Z 1
0
f (w + th) dt
which converges to f (w) due to the continuity of f at w. This proves the theorem.
The following is a slight generalization of the above theorem which is also referred
to as Moreraâ€™s theorem.
1Giancinto Morera 1856-1909. This theorem or one like it dates from around 1886

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
663
Corollary 24.30 Let â„¦be an open set and suppose that whenever
Î³ (z1, z2, z3, z1)
is a closed curve bounding a triangle T, which is contained in â„¦, and f is a contin-
uous function deï¬ned on â„¦, it follows that
Z
Î³(z1,z2,z3,z1)
f (z) dz = 0,
then f is analytic on â„¦.
Proof: As in the proof of Moreraâ€™s theorem, let B (z0, r) âŠ†â„¦and use the given
condition to construct a primitive, F for f on B (z0, r) . Then F is analytic and so
by Theorem 24.16, it follows that F and hence f have inï¬nitely many derivatives,
implying that f is analytic on B (z0, r) . Since z0 is arbitrary, this shows f is analytic
on â„¦.
24.7.2
A Redundant Assumption
Earlier in the deï¬nition of analytic, it was assumed the derivative is continuous.
This assumption is redundant.
Theorem 24.31 Let â„¦be an open set in C and suppose f : â„¦â†’X has the property
that f â€² (z) exists for each z âˆˆâ„¦. Then f is analytic on â„¦.
Proof: Let z0 âˆˆâ„¦and let B (z0, r) âŠ†â„¦. By Moreraâ€™s theorem f has a prim-
itive, F on B (z0, r) . It follows that F is analytic because it has a derivative, f,
and this derivative is continuous. Therefore, by Theorem 24.16 F has inï¬nitely
many derivatives on B (z0, r) implying that f also has inï¬nitely many derivatives
on B (z0, r) . Thus f is analytic as claimed.
It follows a function is analytic on an open set, â„¦if and only if f â€² (z) exists for
z âˆˆâ„¦. This is because it was just shown the derivative, if it exists, is automatically
continuous.
The same proof used to prove Theorem 24.29 implies the following corollary.
Corollary 24.32 Let â„¦be a convex open set and suppose that f â€² (z) exists for all
z âˆˆâ„¦. Then f has a primitive on â„¦.
Note that this implies that if â„¦is a convex open set on which f â€² (z) exists and
if Î³ : [a, b] â†’â„¦is a closed, continuous curve having bounded variation, then letting
F be a primitive of f Theorem 23.13 implies
Z
Î³
f (z) dz = F (Î³ (b)) âˆ’F (Î³ (a)) = 0.

664
FUNDAMENTALS OF COMPLEX ANALYSIS
Notice how diï¬€erent this is from the situation of a function of a real variable! It
is possible for a function of a real variable to have a derivative everywhere and yet
the derivative can be discontinuous. A simple example is the following.
f (x) â‰¡
Â½
x2 sin
Â¡ 1
x
Â¢
if x Ì¸= 0
0 if x = 0
.
Then f â€² (x) exists for all x âˆˆR. Indeed, if x Ì¸= 0, the derivative equals 2x sin 1
xâˆ’cos 1
x
which has no limit as x â†’0. However, from the deï¬nition of the derivative of a
function of one variable, f â€² (0) = 0.
24.7.3
Classiï¬cation Of Isolated Singularities
First some notation.
Deï¬nition 24.33 Let Bâ€² (a, r) â‰¡{z âˆˆC such that 0 < |z âˆ’a| < r}. Thus this is
the usual ball without the center. A function is said to have an isolated singularity
at the point a âˆˆC if f is analytic on Bâ€² (a, r) for some r > 0.
It turns out isolated singularities can be neatly classiï¬ed into three types, re-
movable singularities, poles, and essential singularities. The next theorem deals
with the case of a removable singularity.
Deï¬nition 24.34 An isolated singularity of f is said to be removable if there exists
an analytic function, g analytic at a and near a such that f = g at all points near
a.
Theorem 24.35 Let f : Bâ€² (a, r) â†’X be analytic. Thus f has an isolated singu-
larity at a. Suppose also that
lim
zâ†’a f (z) (z âˆ’a) = 0.
Then there exists a unique analytic function, g : B (a, r) â†’X such that g = f on
Bâ€² (a, r) . Thus the singularity at a is removable.
Proof: Let h (z) â‰¡(z âˆ’a)2 f (z) , h (a) â‰¡0. Then h is analytic on B (a, r)
because it is easy to see that hâ€² (a) = 0. It follows h is given by a power series,
h (z) =
âˆž
X
k=2
ak (z âˆ’a)k
where a0 = a1 = 0 because of the observation above that hâ€² (a) = h (a) = 0. It
follows that for |z âˆ’a| > 0
f (z) =
âˆž
X
k=2
ak (z âˆ’a)kâˆ’2 â‰¡g (z) .
This proves the theorem.
What of the other case where the singularity is not removable? This situation
is dealt with by the amazing Casorati Weierstrass theorem.

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
665
Theorem 24.36 (Casorati Weierstrass) Let a be an isolated singularity and sup-
pose for some r > 0, f (Bâ€² (a, r)) is not dense in C. Then either a is a removable
singularity or there exist ï¬nitely many b1, Â· Â· Â·, bM for some ï¬nite number, M such
that for z near a,
f (z) = g (z) +
M
X
k=1
bk
(z âˆ’a)k
(24.21)
where g (z) is analytic near a.
Proof: Suppose B (z0, Î´) has no points of f (Bâ€² (a, r)) . Such a ball must exist if
f (Bâ€² (a, r)) is not dense. Then for z âˆˆBâ€² (a, r) , |f (z) âˆ’z0| â‰¥Î´ > 0. It follows from
Theorem 24.35 that
1
f(z)âˆ’z0 has a removable singularity at a. Hence, there exists h
an analytic function such that for z near a,
h (z) =
1
f (z) âˆ’z0
.
(24.22)
There are two cases. First suppose h (a) = 0. Then Pâˆž
k=1 ak (z âˆ’a)k =
1
f(z)âˆ’z0
for z near a. If all the ak = 0, this would be a contradiction because then the left
side would equal zero for z near a but the right side could not equal zero. Therefore,
there is a ï¬rst m such that am Ì¸= 0. Hence there exists an analytic function, k (z)
which is not equal to zero in some ball, B (a, Îµ) such that
k (z) (z âˆ’a)m =
1
f (z) âˆ’z0
.
Hence, taking both sides to the âˆ’1 power,
f (z) âˆ’z0 =
1
(z âˆ’a)m
âˆž
X
k=0
bk (z âˆ’a)k
and so 24.21 holds.
The other case is that h (a) Ì¸= 0. In this case, raise both sides of 24.22 to the âˆ’1
power and obtain
f (z) âˆ’z0 = h (z)âˆ’1 ,
a function analytic near a. Therefore, the singularity is removable. This proves the
theorem.
This theorem is the basis for the following deï¬nition which classiï¬es isolated
singularities.
Deï¬nition 24.37 Let a be an isolated singularity of a complex valued function, f.
When 24.21 holds for z near a, then a is called a pole. The order of the pole in
24.21 is M. If for every r > 0, f (Bâ€² (a, r)) is dense in C then a is called an essential
singularity.
In terms of the above deï¬nition, isolated singularities are either removable, a
pole, or essential. There are no other possibilities.

666
FUNDAMENTALS OF COMPLEX ANALYSIS
Theorem 24.38 Suppose f : â„¦â†’C has an isolated singularity at a âˆˆâ„¦. Then a
is a pole if and only if
lim
zâ†’a d (f (z) , âˆž) = 0
in bC.
Proof: Suppose ï¬rst f has a pole at a. Then by deï¬nition, f (z) = g (z) +
PM
k=1
bk
(zâˆ’a)k for z near a where g is analytic. Then
|f (z)|
â‰¥
|bM|
|z âˆ’a|M âˆ’|g (z)| âˆ’
Mâˆ’1
X
k=1
|bk|
|z âˆ’a|k
=
1
|z âˆ’a|M
Ãƒ
|bM| âˆ’
Ãƒ
|g (z)| |z âˆ’a|M +
Mâˆ’1
X
k=1
|bk| |z âˆ’a|Mâˆ’k
!!
.
Now limzâ†’a
Â³
|g (z)| |z âˆ’a|M + PMâˆ’1
k=1 |bk| |z âˆ’a|Mâˆ’kÂ´
= 0 and so the above in-
equality proves limzâ†’a |f (z)| = âˆž. Referring to the diagram on Page 628, you see
this is the same as saying
lim
zâ†’a |Î¸f (z) âˆ’(0, 0, 2)| = lim
zâ†’a |Î¸f (z) âˆ’Î¸ (âˆž)| = lim
zâ†’a d (f (z) , âˆž) = 0
Conversely, suppose limzâ†’a d (f (z) , âˆž) = 0. Then from the diagram on Page
628, it follows limzâ†’a |f (z)| = âˆžand in particular, a cannot be either removable or
an essential singularity by the Casorati Weierstrass theorem, Theorem 24.36. The
only case remaining is that a is a pole. This proves the theorem.
Deï¬nition 24.39 Let f : â„¦â†’C where â„¦is an open subset of C. Then f is called
meromorphic if all singularities are isolated and are either poles or removable and
this set of singularities has no limit point. It is convenient to regard meromorphic
functions as having values in bC where if a is a pole, f (a) â‰¡âˆž. From now on, this
will be assumed when a meromorphic function is being considered.
The usefulness of the above convention about f (a) â‰¡âˆžat a pole is made clear
in the following theorem.
Theorem 24.40 Let â„¦be an open subset of C and let f : â„¦â†’bC be meromorphic.
Then f is continuous with respect to the metric, d on bC.
Proof: Let zn â†’z where z âˆˆâ„¦. Then if z is a pole, it follows from Theorem
24.38 that
d (f (zn) , âˆž) â‰¡d (f (zn) , f (z)) â†’0.
If z is not a pole, then f (zn) â†’f (z) in C which implies |Î¸ (f (zn)) âˆ’Î¸ (f (z))| =
d (f (zn) , f (z)) â†’0. Recall that Î¸ is continuous on C.

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
667
24.7.4
The Cauchy Integral Formula
This section presents the general version of the Cauchy integral formula valid for
arbitrary closed rectiï¬able curves. The key idea in this development is the notion
of the winding number. This is the number also called the index, deï¬ned in the
following theorem. This winding number, along with the earlier results, especially
Liouvilleâ€™s theorem, yields an extremely general Cauchy integral formula.
Deï¬nition 24.41 Let Î³ : [a, b] â†’C and suppose z /âˆˆÎ³âˆ—. The winding number,
n (Î³, z) is deï¬ned by
n (Î³, z) â‰¡
1
2Ï€i
Z
Î³
dw
w âˆ’z .
The main interest is in the case where Î³ is
closed curve.
However, the same
notation will be used for any such curve.
Theorem 24.42 Let Î³ : [a, b] â†’C be continuous and have bounded variation with
Î³ (a) = Î³ (b) . Also suppose that z /âˆˆÎ³âˆ—. Deï¬ne
n (Î³, z) â‰¡
1
2Ï€i
Z
Î³
dw
w âˆ’z .
(24.23)
Then n (Î³, Â·) is continuous and integer valued. Furthermore, there exists a sequence,
Î·k : [a, b] â†’C such that Î·k is C1 ([a, b]) ,
||Î·k âˆ’Î³|| < 1
k , Î·k (a) = Î·k (b) = Î³ (a) = Î³ (b) ,
and n (Î·k, z) = n (Î³, z) for all k large enough. Also n (Î³, Â·) is constant on every
connected component of C\Î³âˆ—and equals zero on the unbounded component of C\Î³âˆ—.
Proof: First consider the assertion about continuity.
|n (Î³, z) âˆ’n (Î³, z1)|
â‰¤
C
Â¯Â¯Â¯Â¯
Z
Î³
Âµ
1
w âˆ’z âˆ’
1
w âˆ’z1
Â¶
dw
Â¯Â¯Â¯Â¯
â‰¤
eC (Length of Î³) |z1 âˆ’z|
whenever z1 is close enough to z. This proves the continuity assertion. Note this
did not depend on Î³ being closed.
Next it is shown that for a closed curve the winding number equals an integer.
To do so, use Theorem 23.12 to obtain Î·k, a function in C1 ([a, b]) such that z /âˆˆ
Î·k ([a, b]) for all k large enough, Î·k (x) = Î³ (x) for x = a, b, and
Â¯Â¯Â¯Â¯Â¯
1
2Ï€i
Z
Î³
dw
w âˆ’z âˆ’
1
2Ï€i
Z
Î·k
dw
w âˆ’z
Â¯Â¯Â¯Â¯Â¯ < 1
k , ||Î·k âˆ’Î³|| < 1
k .
It is shown that each of
1
2Ï€i
R
Î·k
dw
wâˆ’z is an integer. To simplify the notation, write Î·
instead of Î·k.
Z
Î·
dw
w âˆ’z =
Z b
a
Î·â€² (s) ds
Î· (s) âˆ’z .

668
FUNDAMENTALS OF COMPLEX ANALYSIS
Deï¬ne
g (t) â‰¡
Z t
a
Î·â€² (s) ds
Î· (s) âˆ’z .
(24.24)
Then
Â³
eâˆ’g(t) (Î· (t) âˆ’z)
Â´â€²
=
eâˆ’g(t)Î·â€² (t) âˆ’eâˆ’g(t)gâ€² (t) (Î· (t) âˆ’z)
=
eâˆ’g(t)Î·â€² (t) âˆ’eâˆ’g(t)Î·â€² (t) = 0.
It follows that eâˆ’g(t) (Î· (t) âˆ’z) equals a constant. In particular, using the fact that
Î· (a) = Î· (b) ,
eâˆ’g(b) (Î· (b) âˆ’z) = eâˆ’g(a) (Î· (a) âˆ’z) = (Î· (a) âˆ’z) = (Î· (b) âˆ’z)
and so eâˆ’g(b) = 1. This happens if and only if âˆ’g (b) = 2mÏ€i for some integer m.
Therefore, 24.24 implies
2mÏ€i =
Z b
a
Î·â€² (s) ds
Î· (s) âˆ’z =
Z
Î·
dw
w âˆ’z .
Therefore,
1
2Ï€i
R
Î·k
dw
wâˆ’z is a sequence of integers converging to
1
2Ï€i
R
Î³
dw
wâˆ’z â‰¡n (Î³, z)
and so n (Î³, z) must also be an integer and n (Î·k, z) = n (Î³, z) for all k large enough.
Since n (Î³, Â·) is continuous and integer valued, it follows from Corollary 6.67 on
Page 155 that it must be constant on every connected component of C\Î³âˆ—. It is clear
that n (Î³, z) equals zero on the unbounded component because from the formula,
lim
zâ†’âˆž|n (Î³, z)| â‰¤lim
zâ†’âˆžV (Î³, [a, b])
Âµ
1
|z| âˆ’c
Â¶
where c â‰¥max {|w| : w âˆˆÎ³âˆ—} .This proves the theorem.
Corollary 24.43 Suppose Î³ : [a, b] â†’C is a continuous bounded variation curve
and n (Î³, z) is an integer where z /âˆˆÎ³âˆ—. Then Î³ (a) = Î³ (b) . Also z â†’n (Î³, z) for
z /âˆˆÎ³âˆ—is continuous.
Proof: Letting Î· be a C1 curve for which Î· (a) = Î³ (a) and Î· (b) = Î³ (b) and
which is close enough to Î³ that n (Î·, z) = n (Î³, z) , the argument is similar to the
above. Let
g (t) â‰¡
Z t
a
Î·â€² (s) ds
Î· (s) âˆ’z .
(24.25)
Then
Â³
eâˆ’g(t) (Î· (t) âˆ’z)
Â´â€²
=
eâˆ’g(t)Î·â€² (t) âˆ’eâˆ’g(t)gâ€² (t) (Î· (t) âˆ’z)
=
eâˆ’g(t)Î·â€² (t) âˆ’eâˆ’g(t)Î·â€² (t) = 0.
Hence
eâˆ’g(t) (Î· (t) âˆ’z) = c Ì¸= 0.
(24.26)

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
669
By assumption
g (b) =
Z
Î·
1
w âˆ’z dw = 2Ï€im
for some integer, m. Therefore, from 24.26
1 = e2Ï€mi = Î· (b) âˆ’z
c
.
Thus c = Î· (b) âˆ’z and letting t = a in 24.26,
1 = Î· (a) âˆ’z
Î· (b) âˆ’z
which shows Î· (a) = Î· (b) . This proves the corollary since the assertion about con-
tinuity was already observed.
It is a good idea to consider a simple case to get an idea of what the winding
number is measuring. To do so, consider Î³ : [a, b] â†’C such that Î³ is continuous,
closed and bounded variation. Suppose also that Î³ is one to one on (a, b) . Such a
curve is called a simple closed curve. It can be shown that such a simple closed curve
divides the plane into exactly two components, an â€œinsideâ€ bounded component and
an â€œoutsideâ€ unbounded component. This is called the Jordan Curve theorem or
the Jordan separation theorem. This is a diï¬ƒcult theorem which requires some
very hard topology such as homology theory or degree theory. It wonâ€™t be used
here beyond making reference to it. For now, it suï¬ƒces to simply assume that Î³
is such that this result holds. This will usually be obvious anyway. Also suppose
that it is possible to change the parameter to be in [0, 2Ï€] , in such a way that
Î³ (t) + Î»
Â¡
z + reit âˆ’Î³ (t)
Â¢
âˆ’z Ì¸= 0 for all t âˆˆ[0, 2Ï€] and Î» âˆˆ[0, 1] . (As t goes
from 0 to 2Ï€ the point Î³ (t) traces the curve Î³ ([0, 2Ï€]) in the counter clockwise
direction.) Suppose z âˆˆD, the inside of the simple closed curve and consider the
curve Î´ (t) = z+reit for t âˆˆ[0, 2Ï€] where r is chosen small enough that B (z, r) âŠ†D.
Then it happens that n (Î´, z) = n (Î³, z) .
Proposition 24.44 Under the above conditions,
n (Î´, z) = n (Î³, z)
and n (Î´, z) = 1.
Proof: By changing the parameter, assume that [a, b] = [0, 2Ï€] . From Theorem
24.42 it suï¬ƒces to assume also that Î³ is C1. Deï¬ne hÎ» (t) â‰¡Î³ (t)+Î»
Â¡
z + reit âˆ’Î³ (t)
Â¢
for Î» âˆˆ[0, 1] . (This function is called a homotopy of the curves Î³ and Î´.) Note that
for each Î» âˆˆ[0, 1] , t â†’hÎ» (t) is a closed C1 curve. Also,
1
2Ï€i
Z
hÎ»
1
w âˆ’z dw =
1
2Ï€i
Z 2Ï€
0
Î³â€² (t) + Î»
Â¡
rieit âˆ’Î³â€² (t)
Â¢
Î³ (t) + Î» (z + reit âˆ’Î³ (t)) âˆ’z dt.

670
FUNDAMENTALS OF COMPLEX ANALYSIS
This number is an integer and it is routine to verify that it is a continuous function
of Î». When Î» = 0 it equals n (Î³, z) and when Î» = 1 it equals n (Î´, z). Therefore,
n (Î´, z) = n (Î³, z) . It only remains to compute n (Î´, z) .
n (Î´, z) =
1
2Ï€i
Z 2Ï€
0
rieit
reit dt = 1.
This proves the proposition.
Now if Î³ was not one to one but caused the point, Î³ (t) to travel around Î³âˆ—twice,
you could modify the above argument to have the parameter interval, [0, 4Ï€] and
still ï¬nd n (Î´, z) = n (Î³, z) only this time, n (Î´, z) = 2. Thus the winding number
is just what its name suggests. It measures the number of times the curve winds
around the point. One might ask why bother with the winding number if this is
all it does. The reason is that the notion of counting the number of times a curve
winds around a point is rather vague. The winding number is precise. It is also the
natural thing to consider in the general Cauchy integral formula presented below.
Consider a situation typiï¬ed by the following picture in which â„¦is the open set
between the dotted curves and Î³j are closed rectiï¬able curves in â„¦.
-
Î³1
Î³2

Î³3

U
The following theorem is the general Cauchy integral formula.
Deï¬nition 24.45 Let {Î³k}n
k=1 be continuous oriented curves having bounded vari-
ation. Then this is called a cycle if whenever, z /âˆˆâˆªn
k=1Î³âˆ—
k, Pn
k=1 n (Î³k, z) is an
integer.
By Theorem 24.42 if each Î³k is a closed curve, then {Î³k}n
k=1 is a cycle.
Theorem 24.46 Let â„¦be an open subset of the plane and let f : â„¦â†’X be
analytic. If Î³k : [ak, bk] â†’â„¦, k = 1, Â· Â· Â·, m are continuous curves having bounded
variation such that for all z /âˆˆâˆªm
k=1Î³k ([ak, bk])
m
X
k=1
n (Î³k, z) equals an integer
and for all z /âˆˆâ„¦,
m
X
k=1
n (Î³k, z) = 0.

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
671
Then for all z âˆˆâ„¦\ âˆªm
k=1Î³k ([ak, bk]) ,
f (z)
m
X
k=1
n (Î³k, z) =
m
X
k=1
1
2Ï€i
Z
Î³k
f (w)
w âˆ’z dw.
Proof:
Let Ï† be deï¬ned on â„¦Ã— â„¦by
Ï† (z, w) â‰¡
Â½
f(w)âˆ’f(z)
wâˆ’z
if w Ì¸= z
f â€² (z) if w = z
.
Then Ï† is analytic as a function of both z and w and is continuous in â„¦Ã— â„¦. This
is easily seen using Theorem 24.35. Consider the case of w â†’Ï† (z, w) .
lim
wâ†’z (w âˆ’z) (Ï† (z, w) âˆ’Ï† (z, z)) = lim
wâ†’z
Âµf (w) âˆ’f (z)
w âˆ’z
âˆ’f â€² (z)
Â¶
= 0.
Thus w â†’Ï† (z, w) has a removable singularity at z. The case of z â†’Ï† (z, w) is
similar.
Deï¬ne
h (z) â‰¡
1
2Ï€i
m
X
k=1
Z
Î³k
Ï† (z, w) dw.
Is h is analytic on â„¦? To show this is the case, verify
Z
âˆ‚T
h (z) dz = 0
for every triangle, T, contained in â„¦and apply Corollary 24.30. To do this, use
Theorem 23.12 to obtain for each k, a sequence of functions, Î·kn âˆˆC1 ([ak, bk])
such that
Î·kn (x) = Î³k (x) for x âˆˆ{ak, bk}
and
Î·kn ([ak, bk]) âŠ†â„¦, ||Î·kn âˆ’Î³k|| < 1
n,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z
Î·kn
Ï† (z, w) dw âˆ’
Z
Î³k
Ï† (z, w) dw
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < 1
n,
(24.27)
for all z âˆˆT. Then applying Fubiniâ€™s theorem,
Z
âˆ‚T
Z
Î·kn
Ï† (z, w) dwdz =
Z
Î·kn
Z
âˆ‚T
Ï† (z, w) dzdw = 0
because Ï† is given to be analytic. By 24.27,
Z
âˆ‚T
Z
Î³k
Ï† (z, w) dwdz = lim
nâ†’âˆž
Z
âˆ‚T
Z
Î·kn
Ï† (z, w) dwdz = 0
and so h is analytic on â„¦as claimed.

672
FUNDAMENTALS OF COMPLEX ANALYSIS
Now let H denote the set,
H â‰¡
(
z âˆˆC\ âˆªm
k=1 Î³k ([ak, bk]) :
m
X
k=1
n (Î³k, z) = 0
)
.
H is an open set because z â†’Pm
k=1 n (Î³k, z) is integer valued by assumption and
continuous. Deï¬ne
g (z) â‰¡
(
h (z) if z âˆˆâ„¦
1
2Ï€i
Pm
k=1
R
Î³k
f(w)
wâˆ’z dw if z âˆˆH
.
(24.28)
Why is g (z) well deï¬ned? For z âˆˆâ„¦âˆ©H, z /âˆˆâˆªm
k=1Î³k ([ak, bk]) and so
g (z)
=
1
2Ï€i
m
X
k=1
Z
Î³k
Ï† (z, w) dw =
1
2Ï€i
m
X
k=1
Z
Î³k
f (w) âˆ’f (z)
w âˆ’z
dw
=
1
2Ï€i
m
X
k=1
Z
Î³k
f (w)
w âˆ’z dw âˆ’
1
2Ï€i
m
X
k=1
Z
Î³k
f (z)
w âˆ’z dw
=
1
2Ï€i
m
X
k=1
Z
Î³k
f (w)
w âˆ’z dw
because z âˆˆH. This shows g (z) is well deï¬ned. Also, g is analytic on â„¦because
it equals h there. It is routine to verify that g is analytic on H also because of
the second line of 24.28.
By assumption, â„¦C âŠ†H because it is assumed that
P
k n (Î³k, z) = 0 for z /âˆˆâ„¦and so â„¦âˆªH = C showing that g is an entire function.
Now note that Pm
k=1 n (Î³k, z) = 0 for all z contained in the unbounded compo-
nent of C\âˆªm
k=1 Î³k ([ak, bk]) which component contains B (0, r)C for r large enough.
It follows that for |z| > r, it must be the case that z âˆˆH and so for such z, the
bottom description of g (z) found in 24.28 is valid. Therefore, it follows
lim
|z|â†’âˆž||g (z)|| = 0
and so g is bounded and entire. By Liouvilleâ€™s theorem, g is a constant. Hence,
from the above equation, the constant can only equal zero.
For z âˆˆâ„¦\ âˆªm
k=1Î³k ([ak, bk]) ,
0 = h (z) =
1
2Ï€i
m
X
k=1
Z
Î³k
Ï† (z, w) dw =
1
2Ï€i
m
X
k=1
Z
Î³k
f (w) âˆ’f (z)
w âˆ’z
dw =
1
2Ï€i
m
X
k=1
Z
Î³k
f (w)
w âˆ’z dw âˆ’f (z)
m
X
k=1
n (Î³k, z) .
This proves the theorem.

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
673
Corollary 24.47 Let â„¦be an open set and let Î³k : [ak, bk] â†’â„¦, k = 1, Â· Â· Â·, m, be
closed, continuous and of bounded variation. Suppose also that
m
X
k=1
n (Î³k, z) = 0
for all z /âˆˆâ„¦. Then if f : â„¦â†’C is analytic,
m
X
k=1
Z
Î³k
f (w) dw = 0.
Proof: This follows from Theorem 24.46 as follows. Let
g (w) = f (w) (w âˆ’z)
where z âˆˆâ„¦\ âˆªm
k=1Î³k ([ak, bk]) . Then by this theorem,
0 = 0
m
X
k=1
n (Î³k, z) = g (z)
m
X
k=1
n (Î³k, z) =
m
X
k=1
1
2Ï€i
Z
Î³k
g (w)
w âˆ’z dw =
1
2Ï€i
m
X
k=1
Z
Î³k
f (w) dw.
Another simple corollary to the above theorem is Cauchyâ€™s theorem for a simply
connected region.
Deï¬nition 24.48 An open set, â„¦âŠ†C is a region if it is open and connected. A
region, â„¦is simply connected if bC \â„¦is connected where bC is the extended complex
plane. In the future, the term simply connected open set will be an open set which
is connected and bC \â„¦is connected .
Corollary 24.49 Let Î³ : [a, b] â†’â„¦be a continuous closed curve of bounded vari-
ation where â„¦is a simply connected region in C and let f : â„¦â†’X be analytic.
Then
Z
Î³
f (w) dw = 0.
Proof:
Let D denote the unbounded component of bC\Î³âˆ—. Thus âˆžâˆˆbC\Î³âˆ—.
Then the connected set, bC \ â„¦is contained in D since every point of bC \ â„¦must be
in some component of bC\Î³âˆ—and âˆžis contained in both bC\â„¦and D. Thus D must
be the component that contains bC \ â„¦. It follows that n (Î³, Â·) must be constant on
bC \ â„¦, its value being its value on D. However, for z âˆˆD,
n (Î³, z) =
1
2Ï€i
Z
Î³
1
w âˆ’z dw

674
FUNDAMENTALS OF COMPLEX ANALYSIS
and so lim|z|â†’âˆžn (Î³, z) = 0 showing n (Î³, z) = 0 on D. Therefore this veriï¬es the
hypothesis of Theorem 24.46. Let z âˆˆâ„¦âˆ©D and deï¬ne
g (w) â‰¡f (w) (w âˆ’z) .
Thus g is analytic on â„¦and by Theorem 24.46,
0 = n (z, Î³) g (z) =
1
2Ï€i
Z
Î³
g (w)
w âˆ’z dw =
1
2Ï€i
Z
Î³
f (w) dw.
This proves the corollary.
The following is a very signiï¬cant result which will be used later.
Corollary 24.50 Suppose â„¦is a simply connected open set and f : â„¦â†’X is
analytic. Then f has a primitive, F, on â„¦. Recall this means there exists F such
that F â€² (z) = f (z) for all z âˆˆâ„¦.
Proof: Pick a point, z0 âˆˆâ„¦and let V denote those points, z of â„¦for which
there exists a curve, Î³ : [a, b] â†’â„¦such that Î³ is continuous, of bounded variation,
Î³ (a) = z0, and Î³ (b) = z. Then it is easy to verify that V is both open and closed
in â„¦and therefore, V = â„¦because â„¦is connected. Denote by Î³z0,z such a curve
from z0 to z and deï¬ne
F (z) â‰¡
Z
Î³z0,z
f (w) dw.
Then F is well deï¬ned because if Î³j, j = 1, 2 are two such curves, it follows from
Corollary 24.49 that
Z
Î³1
f (w) dw +
Z
âˆ’Î³2
f (w) dw = 0,
implying that
Z
Î³1
f (w) dw =
Z
Î³2
f (w) dw.
Now this function, F is a primitive because, thanks to Corollary 24.49
(F (z + h) âˆ’F (z)) hâˆ’1
=
1
h
Z
Î³z,z+h
f (w) dw
=
1
h
Z 1
0
f (z + th) hdt
and so, taking the limit as h â†’0, F â€² (z) = f (z) .
24.7.5
An Example Of A Cycle
The next theorem deals with the existence of a cycle with nice properties. Basically,
you go around the compact subset of an open set with suitable contours while staying
in the open set. The method involves the following simple concept.

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
675
Deï¬nition 24.51 A tiling of R2 = C is the union of inï¬nitely many equally spaced
vertical and horizontal lines. You can think of the small squares which result as
tiles. To tile the plane or R2 = C means to consider such a union of horizontal and
vertical lines. It is like graph paper. See the picture below for a representation of
part of a tiling of C.
Theorem 24.52 Let K be a compact subset of an open set, â„¦. Then there exist
continuous, closed, bounded variation oriented curves {Î“j}m
j=1 for which Î“âˆ—
j âˆ©K = âˆ…
for each j, Î“âˆ—
j âŠ†â„¦, and for all p âˆˆK,
m
X
k=1
n (Î“k, p) = 1.
while for all z /âˆˆâ„¦
m
X
k=1
n (Î“k, z) = 0.
Proof: Let Î´ = dist
Â¡
K, â„¦CÂ¢
. Since K is compact, Î´ > 0. Now tile the plane
with squares, each of which has diameter less than Î´/2.
K
K
â„¦

676
FUNDAMENTALS OF COMPLEX ANALYSIS
Let S denote the set of all the closed squares in this tiling which have nonempty
intersection with K.Thus, all the squares of S are contained in â„¦. First suppose p is
a point of K which is in the interior of one of these squares in the tiling. Denote by
âˆ‚Sk the boundary of Sk one of the squares in S, oriented in the counter clockwise
direction and Sm denote the square of S which contains the point, p in its interior.
Let the edges of the square, Sj be
n
Î³j
k
o4
k=1.
Thus a short computation shows
n (âˆ‚Sm, p) = 1 but n (âˆ‚Sj, p) = 0 for all j Ì¸= m. The reason for this is that for
z in Sj, the values {z âˆ’p : z âˆˆSj} lie in an open square, Q which is located at a
positive distance from 0. Then bC \ Q is connected and 1/ (z âˆ’p) is analytic on Q.
It follows from Corollary 24.50 that this function has a primitive on Q and so
Z
âˆ‚Sj
1
z âˆ’pdz = 0.
Similarly, if z /âˆˆâ„¦, n (âˆ‚Sj, z) = 0. On the other hand, a direct computation will
verify that n (p, âˆ‚Sm) = 1. Thus 1 = P
j,k n
Â³
p, Î³j
k
Â´
= P
SjâˆˆS n (p, âˆ‚Sj) and if
z /âˆˆâ„¦, 0 = P
j,k n
Â³
z, Î³j
k
Â´
= P
SjâˆˆS n (z, âˆ‚Sj) .
If Î³jâˆ—
k
coincides with Î³lâˆ—
l , then the contour integrals taken over this edge are
taken in opposite directions and so the edge the two squares have in common can
be deleted without changing P
j,k n
Â³
z, Î³j
k
Â´
for any z not on any of the lines in the
tiling. For example, see the picture,
6
?
6


?
-
-
6

-
?
From the construction, if any of the Î³jâˆ—
k contains a point of K then this point is
on one of the four edges of Sj and at this point, there is at least one edge of some
Sl which also contains this point. As just discussed, this shared edge can be deleted
without changing P
i,j n
Â³
z, Î³j
k
Â´
. Delete the edges of the Sk which intersect K but
not the endpoints of these edges. That is, delete the open edges. When this is done,
delete all isolated points. Let the resulting oriented curves be denoted by {Î³k}m
k=1 .
Note that you might have Î³âˆ—
k = Î³âˆ—
l . The construction is illustrated in the following
picture.

24.7.
THE GENERAL CAUCHY INTEGRAL FORMULA
677
6
?
-

-
?
6
?
K
K
â„¦
Then as explained above, Pm
k=1 n (p, Î³k) = 1. It remains to prove the claim
about the closed curves.
Each orientation on an edge corresponds to a direction of motion over that
edge. Call such a motion over the edge a route. Initially, every vertex, (corner of
a square in S) has the property there are the same number of routes to and from
that vertex. When an open edge whose closure contains a point of K is deleted,
every vertex either remains unchanged as to the number of routes to and from that
vertex or it loses both a route away and a route to. Thus the property of having the
same number of routes to and from each vertex is preserved by deleting these open
edges.. The isolated points which result lose all routes to and from. It follows that
upon removing the isolated points you can begin at any of the remaining vertices
and follow the routes leading out from this and successive vertices according to
orientation and eventually return to that end. Otherwise, there would be a vertex
which would have only one route leading to it which does not happen. Now if you
have used all the routes out of this vertex, pick another vertex and do the same
process. Otherwise, pick an unused route out of the vertex and follow it to return.
Continue this way till all routes are used exactly once, resulting in closed oriented
curves, Î“k. Then
X
k
n (Î“k, p) =
X
j
n (Î³k, p) = 1.
In case p âˆˆK is on some line of the tiling, it is not on any of the Î“k because
Î“âˆ—
k âˆ©K = âˆ…and so the continuity of z â†’n (Î“k, z) yields the desired result in this
case also. This proves the lemma.

678
FUNDAMENTALS OF COMPLEX ANALYSIS
24.8
Exercises
1. If U is simply connected, f is analytic on U and f has no zeros in U, show
there exists an analytic function, F, deï¬ned on U such that eF = f.
2. Let f be deï¬ned and analytic near the point a âˆˆC. Show that then f (z) =
Pâˆž
k=0 bk (z âˆ’a)k whenever |z âˆ’a| < R where R is the distance between a and
the nearest point where f fails to have a derivative. The number R, is called
the radius of convergence and the power series is said to be expanded about
a.
3. Find the radius of convergence of the function
1
1+z2 expanded about a = 2.
Note there is nothing wrong with the function,
1
1+x2 when considered as a
function of a real variable, x for any value of x. However, if you insist on using
power series, you ï¬nd there is a limitation on the values of x for which the
power series converges due to the presence in the complex plane of a point, i,
where the function fails to have a derivative.
4. Suppose f is analytic on all of C and satisï¬es |f (z)| < A + B |z|1/2 . Show f
is constant.
5. What if you deï¬ned an open set, U to be simply connected if C\U is connected.
Would it amount to the same thing? Hint: Consider the outside of B (0, 1) .
6. Let Î³ (t) = eit : t âˆˆ[0, 2Ï€] . Find
R
Î³
1
zn dz for n = 1, 2, Â· Â· Â·.
7. Show i
R 2Ï€
0
(2 cos Î¸)2n dÎ¸ =
R
Î³
Â¡
z + 1
z
Â¢2n Â¡ 1
z
Â¢
dz where Î³ (t) = eit : t âˆˆ[0, 2Ï€] .
Then evaluate this integral using the binomial theorem and the previous prob-
lem.
8. Suppose that for some constants a, b Ì¸= 0, a, b âˆˆR, f (z + ib) = f (z) for all
z âˆˆC and f (z + a) = f (z) for all z âˆˆC. If f is analytic, show that f must
be constant. Can you generalize this? Hint: This uses Liouvilleâ€™s theorem.
9. Suppose f (z) = u (x, y) + iv (x, y) is analytic for z âˆˆU, an open set. Let
g (z) = uâˆ—(x, y) + ivâˆ—(x, y) where
Âµ
uâˆ—
vâˆ—
Â¶
= Q
Âµ
u
v
Â¶
where Q is a unitary matrix.
That is QQâˆ—= Qâˆ—Q = I. When will g be
analytic?
10. Suppose f is analytic on an open set, U, except for Î³âˆ—âŠ‚U where Î³ is a one
to one continuous function having bounded variation, but it is known that f
is continuous on Î³âˆ—. Show that in fact f is analytic on Î³âˆ—also. Hint: Pick a
point on Î³âˆ—, say Î³ (t0) and suppose for now that t0 âˆˆ(a, b) . Pick r > 0 such
that B = B (Î³ (t0) , r) âŠ†U. Then show there exists t1 < t0 and t2 > t0 such

24.8.
EXERCISES
679
that Î³ ([t1, t2]) âŠ†B and Î³ (ti) /âˆˆB. Thus Î³ ([t1, t2]) is a path across B going
through the center of B which divides B into two open sets, B1, and B2 along
with Î³âˆ—. Let the boundary of Bk consist of Î³ ([t1, t2]) and a circular arc, Ck.
Now letting z âˆˆBk, the line integral of f(w)
wâˆ’z over Î³âˆ—in two diï¬€erent directions
cancels. Therefore, if z âˆˆBk, you can argue that f (z) =
1
2Ï€i
R
C
f(w)
wâˆ’z dw. By
continuity, this continues to hold for z âˆˆÎ³ ((t1, t2)) . Therefore, f must be
analytic on Î³ ((t1, t1)) also. This shows that f must be analytic on Î³ ((a, b)) .
To get the endpoints, simply extend Î³ to have the same properties but deï¬ned
on [a âˆ’Îµ, b + Îµ] and repeat the above argument or else do this at the beginning
and note that you get [a, b] âŠ†(a âˆ’Îµ, b + Îµ) .
11. Let U be an open set contained in the upper half plane and suppose that
there are ï¬nitely many line segments on the x axis which are contained in
the boundary of U. Now suppose that f is deï¬ned, real, and continuous on
these line segments and is deï¬ned and analytic on U. Now let eU denote the
reï¬‚ection of U across the x axis. Show that it is possible to extend f to a
function, g deï¬ned on all of
W â‰¡eU âˆªU âˆª{the line segments mentioned earlier}
such that g is analytic in W. Hint: For z âˆˆeU, the reï¬‚ection of U across the
x axis, let g (z) â‰¡f (z). Show that g is analytic on eU âˆªU and continuous on
the line segments. Then use Problem 10 or Moreraâ€™s theorem to argue that
g is analytic on the line segments also. The result of this problem is know as
the Schwarz reï¬‚ection principle.
12. Show that rotations and translations of analytic functions yield analytic func-
tions and use this observation to generalize the Schwarz reï¬‚ection principle
to situations in which the line segments are part of a line which is not the x
axis. Thus, give a version which involves reï¬‚ection about an arbitrary line.

680
FUNDAMENTALS OF COMPLEX ANALYSIS

The Open Mapping Theorem
25.1
A Local Representation
The open mapping theorem, is an even more surprising result than the theorem
about the zeros of an analytic function.
The following proof of this important
theorem uses an interesting local representation of the analytic function.
Theorem 25.1 (Open mapping theorem) Let â„¦be a region in C and suppose f :
â„¦â†’C is analytic. Then f (â„¦) is either a point or a region. In the case where f (â„¦)
is a region, it follows that for each z0 âˆˆâ„¦, there exists an open set, V containing
z0 and m âˆˆN such that for all z âˆˆV,
f (z) = f (z0) + Ï† (z)m
(25.1)
where Ï† : V â†’B (0, Î´) is one to one, analytic and onto, Ï† (z0) = 0, Ï†â€² (z) Ì¸= 0 on
V and Ï†âˆ’1 analytic on B (0, Î´) . If f is one to one then m = 1 for each z0 and
f âˆ’1 : f (â„¦) â†’â„¦is analytic.
Proof: Suppose f (â„¦) is not a point. Then if z0 âˆˆâ„¦it follows there exists r > 0
such that f (z) Ì¸= f (z0) for all z âˆˆB (z0, r) \ {z0} . Otherwise, z0 would be a limit
point of the set,
{z âˆˆâ„¦: f (z) âˆ’f (z0) = 0}
which would imply from Theorem 24.23 that f (z) = f (z0) for all z âˆˆâ„¦. Therefore,
making r smaller if necessary and using the power series of f,
f (z) = f (z0) + (z âˆ’z0)m g (z) (
?=
Â³
(z âˆ’z0) g (z)1/mÂ´m
)
for all z âˆˆB (z0, r) , where g (z) Ì¸= 0 on B (z0, r) . As implied in the above formula,
one wonders if you can take the mth root of g (z) .
gâ€²
g is an analytic function on B (z0, r) and so by Corollary 24.32 it has a primitive
on B (z0, r) , h. Therefore by the product rule and the chain rule,
Â¡
geâˆ’hÂ¢â€² = 0 and
so there exists a constant, C = ea+ib such that on B (z0, r) ,
geâˆ’h = ea+ib.
681

682
THE OPEN MAPPING THEOREM
Therefore,
g (z) = eh(z)+a+ib
and so, modifying h by adding in the constant, a + ib, g (z) = eh(z) where hâ€² (z) =
gâ€²(z)
g(z) on B (z0, r) . Letting
Ï† (z) = (z âˆ’z0) e
h(z)
m
implies formula 25.1 is valid on B (z0, r) . Now
Ï†â€² (z0) = e
h(z0)
m
Ì¸= 0.
Shrinking r if necessary you can assume Ï†â€² (z) Ì¸= 0 on B (z0, r). Is there an open
set, V contained in B (z0, r) such that Ï† maps V onto B (0, Î´) for some Î´ > 0?
Let Ï† (z) = u (x, y) + iv (x, y) where z = x + iy. Consider the mapping
Âµ
x
y
Â¶
â†’
Âµ
u (x, y)
v (x, y)
Â¶
where u, v are C1 because Ï† is given to be analytic. The Jacobian of this map at
(x, y) âˆˆB (z0, r) is
Â¯Â¯Â¯Â¯
ux (x, y)
uy (x, y)
vx (x, y)
vy (x, y)
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
ux (x, y)
âˆ’vx (x, y)
vx (x, y)
ux (x, y)
Â¯Â¯Â¯Â¯
= ux (x, y)2 + vx (x, y)2 =
Â¯Â¯Ï†â€² (z)
Â¯Â¯2 Ì¸= 0.
This follows from a use of the Cauchy Riemann equations. Also
Âµ
u (x0, y0)
v (x0, y0)
Â¶
=
Âµ
0
0
Â¶
Therefore, by the inverse function theorem there exists an open set, V, containing
z0 and Î´ > 0 such that (u, v)T maps V one to one onto B (0, Î´) . Thus Ï† is one to
one onto B (0, Î´) as claimed. Applying the same argument to other points, z of V
and using the fact that Ï†â€² (z) Ì¸= 0 at these points, it follows Ï† maps open sets to
open sets. In other words, Ï†âˆ’1 is continuous.
It also follows that Ï†m maps V onto B (0, Î´m) . Therefore, the formula 25.1
implies that f maps the open set, V, containing z0 to an open set. This shows f (â„¦)
is an open set because z0 was arbitrary. It is connected because f is continuous and
â„¦is connected. Thus f (â„¦) is a region. It remains to verify that Ï†âˆ’1 is analytic on
B (0, Î´) . Since Ï†âˆ’1 is continuous,
lim
Ï†(z1)â†’Ï†(z)
Ï†âˆ’1 (Ï† (z1)) âˆ’Ï†âˆ’1 (Ï† (z))
Ï† (z1) âˆ’Ï† (z)
= lim
z1â†’z
z1 âˆ’z
Ï† (z1) âˆ’Ï† (z) =
1
Ï†â€² (z).
Therefore, Ï†âˆ’1 is analytic as claimed.

25.2.
BRANCHES OF THE LOGARITHM
683
It only remains to verify the assertion about the case where f is one to one. If
m > 1, then e
2Ï€i
m Ì¸= 1 and so for z1 âˆˆV,
e
2Ï€i
m Ï† (z1) Ì¸= Ï† (z1) .
(25.2)
But e
2Ï€i
m Ï† (z1) âˆˆB (0, Î´) and so there exists z2 Ì¸= z1(since Ï† is one to one) such that
Ï† (z2) = e
2Ï€i
m Ï† (z1) . But then
Ï† (z2)m =
Â³
e
2Ï€i
m Ï† (z1)
Â´m
= Ï† (z1)m
implying f (z2) = f (z1) contradicting the assumption that f is one to one. Thus
m = 1 and f â€² (z) = Ï†â€² (z) Ì¸= 0 on V. Since f maps open sets to open sets, it follows
that f âˆ’1 is continuous and so
Â¡
f âˆ’1Â¢â€² (f (z))
=
lim
f(z1)â†’f(z)
f âˆ’1 (f (z1)) âˆ’f âˆ’1 (f (z))
f (z1) âˆ’f (z)
=
lim
z1â†’z
z1 âˆ’z
f (z1) âˆ’f (z) =
1
f â€² (z).
This proves the theorem.
One does not have to look very far to ï¬nd that this sort of thing does not hold
for functions mapping R to R. Take for example, the function f (x) = x2. Then
f (R) is neither a point nor a region. In fact f (R) fails to be open.
Corollary 25.2 Suppose in the situation of Theorem 25.1 m > 1 for the local
representation of f given in this theorem.
Then there exists Î´ > 0 such that if
w âˆˆB (f (z0) , Î´) = f (V ) for V an open set containing z0, then f âˆ’1 (w) consists of
m distinct points in V. (f is m to one on V )
Proof: Let w âˆˆB (f (z0) , Î´) . Then w = f (bz) where bz âˆˆV. Thus f (bz) =
f (z0) + Ï† (bz)m . Consider the m distinct numbers,
n
e
2kÏ€i
m Ï† (bz)
om
k=1 . Then each of
these numbers is in B (0, Î´) and so since Ï† maps V one to one onto B (0, Î´) , there
are m distinct numbers in V , {zk}m
k=1 such that Ï† (zk) = e
2kÏ€i
m Ï† (bz). Then
f (zk)
=
f (z0) + Ï† (zk)m = f (z0) +
Â³
e
2kÏ€i
m Ï† (bz)
Â´m
=
f (z0) + e2kÏ€iÏ† (bz)m = f (z0) + Ï† (bz)m = f (bz) = w
This proves the corollary.
25.2
Branches Of The Logarithm
The argument used in to prove the next theorem was used in the proof of the open
mapping theorem.
It is a very important result and deserves to be stated as a
theorem.

684
THE OPEN MAPPING THEOREM
Theorem 25.3 Let â„¦be a simply connected region and suppose f : â„¦â†’C is
analytic and nonzero on â„¦. Then there exists an analytic function, g such that
eg(z) = f (z) for all z âˆˆâ„¦.
Proof: The function, f â€²/f is analytic on â„¦and so by Corollary 24.50 there is
a primitive for f â€²/f, denoted as g1. Then
Â¡
eâˆ’g1f
Â¢â€² = âˆ’f â€²
f eâˆ’g1f + eâˆ’g1f â€² = 0
and so since â„¦is connected, it follows eâˆ’g1f equals a constant, ea+ib. Therefore,
f (z) = eg1(z)+a+ib. Deï¬ne g (z) â‰¡g1 (z) + a + ib.
The function, g in the above theorem is called a branch of the logarithm of f
and is written as log (f (z)).
Deï¬nition 25.4 Let Ï be a ray starting at 0. Thus Ï is a straight line of inï¬nite
length extending in one direction with its initial point at 0.
A special case of the above theorem is the following.
Theorem 25.5 Let Ï be a ray starting at 0. Then there exists an analytic function,
L (z) deï¬ned on C \ Ï such that
eL(z) = z.
This function, L is called a branch of the logarithm. This branch of the logarithm
satisï¬es the usual formula for logarithms, L (zw) = L (z) + L (w) provided zw /âˆˆÏ.
Proof: C \ Ï is a simply connected region because its complement with respect
to bC is connected. Furthermore, the function, f (z) = z is not equal to zero on
C \ Ï. Therefore, by Theorem 25.3 there exists an analytic function L (z) such that
eL(z) = f (z) = z. Now consider the problem of ï¬nding a description of L (z). Each
z âˆˆC \ Ï can be written in a unique way in the form
z = |z| ei argÎ¸(z)
where argÎ¸ (z) is the angle in (Î¸, Î¸ + 2Ï€) associated with z. (You could of course
have considered this to be the angle in (Î¸ âˆ’2Ï€, Î¸) associated with z or in inï¬nitely
many other open intervals of length 2Ï€. The description of the log is not unique.)
Then letting L (z) = a + ib
z = |z| ei argÎ¸(z) = eL(z) = eaeib
and so you can let L (z) = ln |z| + i argÎ¸ (z) .
Does L (z) satisfy the usual properties of the logarithm? That is, for z, w âˆˆC\Ï,
is L (zw) = L (z)+L (w)? This follows from the usual rules of exponents. You know
ez+w = ezew. (You can verify this directly or you can reduce to the case where z, w
are real. If z is a ï¬xed real number, then the equation holds for all real w. Therefore,
it must also hold for all complex w because the real line contains a limit point. Now

25.3.
MAXIMUM MODULUS THEOREM
685
for this ï¬xed w, the equation holds for all z real. Therefore, by similar reasoning,
it holds for all complex z.)
Now suppose z, w âˆˆC \ Ï and zw /âˆˆÏ. Then
eL(zw) = zw, eL(z)+L(w) = eL(z)eL(w) = zw
and so L (zw) = L (z) + L (w) as claimed. This proves the theorem.
In the case where the ray is the negative real axis, it is called the principal
branch of the logarithm. Thus arg (z) is a number between âˆ’Ï€ and Ï€.
Deï¬nition 25.6 Let log denote the branch of the logarithm which corresponds to
the ray for Î¸ = Ï€. That is, the ray is the negative real axis. Sometimes this is called
the principal branch of the logarithm.
25.3
Maximum Modulus Theorem
Here is another very signiï¬cant theorem known as the maximum modulus theorem
which follows immediately from the open mapping theorem.
Theorem 25.7 (maximum modulus theorem) Let â„¦be a bounded region and let
f : â„¦â†’C be analytic and f : â„¦â†’C continuous. Then if z âˆˆâ„¦,
|f (z)| â‰¤max {|f (w)| : w âˆˆâˆ‚â„¦} .
(25.3)
If equality is achieved for any z âˆˆâ„¦, then f is a constant.
Proof: Suppose f is not a constant. Then f (â„¦) is a region and so if z âˆˆâ„¦,
there exists r > 0 such that B (f (z) , r) âŠ†f (â„¦) . It follows there exists z1 âˆˆâ„¦
with |f (z1)| > |f (z)| . Hence max
Â©
|f (w)| : w âˆˆâ„¦
Âª
is not achieved at any interior
point of â„¦. Therefore, the point at which the maximum is achieved must lie on the
boundary of â„¦and so
max {|f (w)| : w âˆˆâˆ‚â„¦} = max
Â©
|f (w)| : w âˆˆâ„¦
Âª
> |f (z)|
for all z âˆˆâ„¦or else f is a constant. This proves the theorem.
You can remove the assumption that â„¦is bounded and give a slightly diï¬€erent
version.
Theorem 25.8 Let f : â„¦â†’C be analytic on a region, â„¦and suppose B (a, r) âŠ†â„¦.
Then
|f (a)| â‰¤max
Â©Â¯Â¯f
Â¡
a + reiÎ¸Â¢Â¯Â¯ : Î¸ âˆˆ[0, 2Ï€]
Âª
.
Equality occurs for some r > 0 and a âˆˆâ„¦if and only if f is constant in â„¦hence
equality occurs for all such a, r.

686
THE OPEN MAPPING THEOREM
Proof: The claimed inequality holds by Theorem 25.7. Suppose equality in the
above is achieved for some B (a, r) âŠ†â„¦. Then by Theorem 25.7 f is equal to a
constant, w on B (a, r) . Therefore, the function, f (Â·) âˆ’w has a zero set which has
a limit point in â„¦and so by Theorem 24.23 f (z) = w for all z âˆˆâ„¦.
Conversely, if f is constant, then the equality in the above inequality is achieved
for all B (a, r) âŠ†â„¦.
Next is yet another version of the maximum modulus principle which is in Con-
way [13]. Let â„¦be an open set.
Deï¬nition 25.9 Deï¬ne âˆ‚âˆžâ„¦to equal âˆ‚â„¦in the case where â„¦is bounded and
âˆ‚â„¦âˆª{âˆž} in the case where â„¦is not bounded.
Deï¬nition 25.10 Let f be a complex valued function deï¬ned on a set S âŠ†C and
let a be a limit point of S.
lim sup
zâ†’a |f (z)| â‰¡lim
râ†’0 {sup |f (w)| : w âˆˆBâ€² (a, r) âˆ©S} .
The limit exists because {sup |f (w)| : w âˆˆBâ€² (a, r) âˆ©S} is decreasing in r. In case
a = âˆž,
lim sup
zâ†’âˆž|f (z)| â‰¡lim
râ†’âˆž{sup |f (w)| : |w| > r, w âˆˆS}
Note that if lim supzâ†’a |f (z)| â‰¤M and Î´ > 0, then there exists r > 0 such that
if z âˆˆBâ€² (a, r) âˆ©S, then |f (z)| < M + Î´. If a = âˆž, there exists r > 0 such that if
|z| > r and z âˆˆS, then |f (z)| < M + Î´.
Theorem 25.11 Let â„¦be an open set in C and let f : â„¦â†’C be analytic. Suppose
also that for every a âˆˆâˆ‚âˆžâ„¦,
lim sup
zâ†’a |f (z)| â‰¤M < âˆž.
Then in fact |f (z)| â‰¤M for all z âˆˆâ„¦.
Proof: Let Î´ > 0 and let H â‰¡{z âˆˆâ„¦: |f (z)| > M + Î´} . Suppose H Ì¸= âˆ….
Then H is an open subset of â„¦. I claim that H is actually bounded.
If â„¦is
bounded, there is nothing to show so assume â„¦is unbounded. Then the condition
involving the lim sup implies there exists r > 0 such that if |z| > r and z âˆˆâ„¦, then
|f (z)| â‰¤M + Î´/2. It follows H is contained in B (0, r) and so it is bounded. Now
consider the components of â„¦. One of these components contains points from H.
Let this component be denoted as V and let HV â‰¡H âˆ©V. Thus HV is a bounded
open subset of V. Let U be a component of HV . First suppose U âŠ†V . In this
case, it follows that on âˆ‚U, |f (z)| = M + Î´ and so by Theorem 25.7 |f (z)| â‰¤M + Î´
for all z âˆˆU contradicting the deï¬nition of H. Next suppose âˆ‚U contains a point
of âˆ‚V, a. Then in this case, a violates the condition on lim sup . Either way you
get a contradiction. Hence H = âˆ…as claimed. Since Î´ > 0 is arbitrary, this shows
|f (z)| â‰¤M.

25.4.
EXTENSIONS OF MAXIMUM MODULUS THEOREM
687
25.4
Extensions Of Maximum Modulus Theorem
25.4.1
PhragmË†en LindelÂ¨of Theorem
This theorem is an extension of Theorem 25.11. It uses a growth condition near the
extended boundary to conclude that f is bounded. I will present the version found
in Conway [13]. It seems to be more of a method than an actual theorem. There
are several versions of it.
Theorem 25.12 Let â„¦be a simply connected region in C and suppose f is ana-
lytic on â„¦. Also suppose there exists a function, Ï† which is nonzero and uniformly
bounded on â„¦. Let M be a positive number.
Now suppose âˆ‚âˆžâ„¦= A âˆªB such
that for every a âˆˆA, lim supzâ†’a |f (z)| â‰¤M and for every b âˆˆB, and Î· > 0,
lim supzâ†’b |f (z)| |Ï† (z)|Î· â‰¤M. Then |f (z)| â‰¤M for all z âˆˆâ„¦.
Proof: By Theorem 25.3 there exists log (Ï† (z)) analytic on â„¦. Now deï¬ne
g (z) â‰¡exp (Î· log (Ï† (z))) so that g (z) = Ï† (z)Î· . Now also
|g (z)| = |exp (Î· log (Ï† (z)))| = |exp (Î· ln |Ï† (z)|)| = |Ï† (z)|Î· .
Let m â‰¥|Ï† (z)| for all z âˆˆâ„¦. Deï¬ne F (z) â‰¡f (z) g (z) mâˆ’Î·. Thus F is analytic
and for b âˆˆB,
lim sup
zâ†’b
|F (z)| = lim sup
zâ†’b
|f (z)| |Ï† (z)|Î· mâˆ’Î· â‰¤Mmâˆ’Î·
while for a âˆˆA,
lim sup
zâ†’a |F (z)| â‰¤M.
Therefore, for Î± âˆˆâˆ‚âˆžâ„¦, lim supzâ†’Î± |F (z)| â‰¤max (M, MÎ·âˆ’Î·) and so by Theorem
25.11, |f (z)| â‰¤
Â³
mÎ·
|Ï†(z)|Î·
Â´
max (M, MÎ·âˆ’Î·) . Now let Î· â†’0 to obtain |f (z)| â‰¤M.
In applications, it is often the case that B = {âˆž}.
Now here is an interesting case of this theorem. It involves a particular form for
â„¦, in this case â„¦=
Â©
z âˆˆC : |arg (z)| <
Ï€
2a
Âª
where a â‰¥1
2.
â„¦
Then âˆ‚â„¦equals the two slanted lines. Also on â„¦you can deï¬ne a logarithm,
log (z) = ln |z| + i arg (z) where arg (z) is the angle associated with z between âˆ’Ï€

688
THE OPEN MAPPING THEOREM
and Ï€. Therefore, if c is a real number you can deï¬ne zc for such z in the usual way:
zc
â‰¡
exp (c log (z)) = exp (c [ln |z| + i arg (z)])
=
|z|c exp (ic arg (z)) = |z|c (cos (c arg (z)) + i sin (c arg (z))) .
If |c| < a, then |c arg (z)| < Ï€
2 and so cos (c arg (z)) > 0. Therefore, for such c,
|exp (âˆ’(zc))|
=
|exp (âˆ’|z|c (cos (c arg (z)) + i sin (c arg (z))))|
=
|exp (âˆ’|z|c (cos (c arg (z))))|
which is bounded since cos (c arg (z)) > 0.
Corollary 25.13 Let â„¦=
Â©
z âˆˆC : |arg (z)| <
Ï€
2a
Âª
where a â‰¥1
2 and suppose f is
analytic on â„¦and satisï¬es lim supzâ†’a |f (z)| â‰¤M on âˆ‚â„¦and suppose there are
positive constants, P, b where b < a and
|f (z)| â‰¤P exp
Â³
|z|bÂ´
for all |z| large enough. Then |f (z)| â‰¤M for all z âˆˆâ„¦.
Proof: Let b < c < a and let Ï† (z) â‰¡exp (âˆ’(zc)) . Then as discussed above,
Ï† (z) Ì¸= 0 on â„¦and |Ï† (z)| is bounded on â„¦. Now
|Ï† (z)|Î· = |exp (âˆ’|z|c Î· (cos (c arg (z))))|
lim sup
zâ†’âˆž|f (z)| |Ï† (z)|Î· â‰¤lim sup
zâ†’âˆž
P exp
Â³
|z|bÂ´
|exp (|z|c Î· (cos (c arg (z))))| = 0 â‰¤M
and so by Theorem 25.12 |f (z)| â‰¤M.
The following is another interesting case. This case is presented in Rudin [45]
Corollary 25.14 Let â„¦be the open set consisting of {z âˆˆC : a < Re z < b} and
suppose f is analytic on â„¦, continuous on â„¦, and bounded on â„¦. Suppose also that
f (z) â‰¤1 on the two lines Re z = a and Re z = b. Then |f (z)| â‰¤1 for all z âˆˆâ„¦.
Proof: This time let Ï† (z) =
1
1+zâˆ’a. Thus |Ï† (z)| â‰¤1 because Re (z âˆ’a) > 0 and
Ï† (z) Ì¸= 0 for all z âˆˆâ„¦. Also, lim supzâ†’âˆž|Ï† (z)|Î· = 0 for every Î· > 0. Therefore, if a
is a point of the sides of â„¦, lim supzâ†’a |f (z)| â‰¤1 while lim supzâ†’âˆž|f (z)| |Ï† (z)|Î· =
0 â‰¤1 and so by Theorem 25.12, |f (z)| â‰¤1 on â„¦.
This corollary yields an interesting conclusion.
Corollary 25.15 Let â„¦be the open set consisting of {z âˆˆC : a < Re z < b} and
suppose f is analytic on â„¦, continuous on â„¦, and bounded on â„¦. Deï¬ne
M (x) â‰¡sup {|f (z)| : Re z = x}
Then for x âˆˆ(a, b).
M (x) â‰¤M (a)
bâˆ’x
bâˆ’a M (b)
xâˆ’a
bâˆ’a .

25.4.
EXTENSIONS OF MAXIMUM MODULUS THEOREM
689
Proof: Let Îµ > 0 and deï¬ne
g (z) â‰¡(M (a) + Îµ)
bâˆ’z
bâˆ’a (M (b) + Îµ)
zâˆ’a
bâˆ’a
where for M > 0 and z âˆˆC, M z â‰¡exp (z ln (M)) . Thus g Ì¸= 0 and so f/g is
analytic on â„¦and continuous on â„¦. Also on the left side,
Â¯Â¯Â¯Â¯
f (a + iy)
g (a + iy)
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯Â¯
f (a + iy)
(M (a) + Îµ)
bâˆ’aâˆ’iy
bâˆ’a
Â¯Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯Â¯
f (a + iy)
(M (a) + Îµ)
bâˆ’a
bâˆ’a
Â¯Â¯Â¯Â¯Â¯ â‰¤1
while on the right side a similar computation shows
Â¯Â¯Â¯ f
g
Â¯Â¯Â¯ â‰¤1 also. Therefore, by
Corollary 25.14 |f/g| â‰¤1 on â„¦. Therefore, letting x + iy = z,
|f (z)| â‰¤
Â¯Â¯Â¯(M (a) + Îµ)
bâˆ’z
bâˆ’a (M (b) + Îµ)
zâˆ’a
bâˆ’a
Â¯Â¯Â¯ =
Â¯Â¯Â¯(M (a) + Îµ)
bâˆ’x
bâˆ’a (M (b) + Îµ)
xâˆ’a
bâˆ’a
Â¯Â¯Â¯
and so
M (x) â‰¤(M (a) + Îµ)
bâˆ’x
bâˆ’a (M (b) + Îµ)
xâˆ’a
bâˆ’a .
Since Îµ > 0 is arbitrary, it yields the conclusion of the corollary.
Another way of saying this is that x â†’ln (M (x)) is a convex function.
This corollary has an interesting application known as the Hadamard three cir-
cles theorem.
25.4.2
Hadamard Three Circles Theorem
Let 0 < R1 < R2 and suppose f is analytic on {z âˆˆC : R1 < |z| < R2} . Then letting
R1 < a < b < R2, note that g (z) â‰¡exp (z) maps the strip {z âˆˆC : ln a < Re z < b}
onto {z âˆˆC : a < |z| < b} and that in fact, g maps the line ln r + iy onto the circle
reiÎ¸. Now let M (x) be deï¬ned as above and m be deï¬ned by
m (r) â‰¡max
Î¸
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ .
Then for a < r < b, Corollary 25.15 implies
m (r)
=
sup
y
Â¯Â¯f
Â¡
eln r+iyÂ¢Â¯Â¯ = M (ln r) â‰¤M (ln a)
ln bâˆ’ln r
ln bâˆ’ln a M (ln b)
ln râˆ’ln a
ln bâˆ’ln a
=
m (a)ln(b/r)/ ln(b/a) m (b)ln(r/a)/ ln(b/a)
and so
m (r)ln(b/a) â‰¤m (a)ln(b/r) m (b)ln(r/a) .
Taking logarithms, this yields
ln
Âµ b
a
Â¶
ln (m (r)) â‰¤ln
Âµb
r
Â¶
ln (m (a)) + ln
Â³r
a
Â´
ln (m (b))
which says the same as r â†’ln (m (r)) is a convex function of ln r.
The next example, also in Rudin [45] is very dramatic. An unbelievably weak
assumption is made on the growth of the function and still you get a uniform bound
in the conclusion.

690
THE OPEN MAPPING THEOREM
Corollary 25.16 Let â„¦=
Â©
z âˆˆC : |Im (z)| < Ï€
2
Âª
. Suppose f is analytic on â„¦,
continuous on â„¦, and there exist constants, Î± < 1 and A < âˆžsuch that
|f (z)| â‰¤exp (A exp (Î± |x|)) for z = x + iy
and
Â¯Â¯Â¯f
Â³
x Â± iÏ€
2
Â´Â¯Â¯Â¯ â‰¤1
for all x âˆˆR. Then |f (z)| â‰¤1 on â„¦.
Proof: This time let Ï† (z) = [exp (A exp (Î²z)) exp (A exp (âˆ’Î²z))]âˆ’1 where Î± <
Î² < 1. Then Ï† (z) Ì¸= 0 on â„¦and for Î· > 0
|Ï† (z)|Î· =
1
|exp (Î·A exp (Î²z)) exp (Î·A exp (âˆ’Î²z))|
Now
exp (Î·A exp (Î²z)) exp (Î·A exp (âˆ’Î²z))
=
exp (Î·A (exp (Î²z) + exp (âˆ’Î²z)))
=
exp
Â£
Î·A
Â¡
cos (Î²y)
Â¡
eÎ²x + eâˆ’Î²xÂ¢
+ i sin (Î²y)
Â¡
eÎ²x âˆ’eâˆ’Î²xÂ¢Â¢Â¤
and so
|Ï† (z)|Î· =
1
exp [Î·A (cos (Î²y) (eÎ²x + eâˆ’Î²x))]
Now cos Î²y > 0 because Î² < 1 and |y| < Ï€
2 . Therefore,
lim sup
zâ†’âˆž|f (z)| |Ï† (z)|Î· â‰¤0 â‰¤1
and so by Theorem 25.12, |f (z)| â‰¤1.
25.4.3
Schwarzâ€™s Lemma
This interesting lemma comes from the maximum modulus theorem. It will be used
later as part of the proof of the Riemann mapping theorem.
Lemma 25.17 Suppose F : B (0, 1) â†’B (0, 1) , F is analytic, and F (0) = 0. Then
for all z âˆˆB (0, 1) ,
|F (z)| â‰¤|z| ,
(25.4)
and
|F â€² (0)| â‰¤1.
(25.5)
If equality holds in 25.5 then there exists Î» âˆˆC with |Î»| = 1 and
F (z) = Î»z.
(25.6)

25.4.
EXTENSIONS OF MAXIMUM MODULUS THEOREM
691
Proof:
First note that by assumption, F (z) /z has a removable singularity at
0 if its value at 0 is deï¬ned to be F â€² (0) . By the maximum modulus theorem, if
|z| < r < 1,
Â¯Â¯Â¯Â¯
F (z)
z
Â¯Â¯Â¯Â¯ â‰¤max
tâˆˆ[0,2Ï€]
Â¯Â¯F
Â¡
reitÂ¢Â¯Â¯
r
â‰¤1
r .
Then letting r â†’1,
Â¯Â¯Â¯Â¯
F (z)
z
Â¯Â¯Â¯Â¯ â‰¤1
this shows 25.4 and it also veriï¬es 25.5 on taking the limit as z â†’0. If equality
holds in 25.5, then |F (z) /z| achieves a maximum at an interior point so F (z) /z
equals a constant, Î» by the maximum modulus theorem. Since F (z) = Î»z, it follows
F â€² (0) = Î» and so |Î»| = 1.
Rudin [45] gives a memorable description of what this lemma says. It says that
if an analytic function maps the unit ball to itself, keeping 0 ï¬xed, then it must do
one of two things, either be a rotation or move all points closer to 0. (This second
part follows in case |F â€² (0)| < 1 because in this case, you must have |F (z)| Ì¸= |z|
and so by 25.4, |F (z)| < |z|)
25.4.4
One To One Analytic Maps On The Unit Ball
The transformation in the next lemma is of fundamental importance.
Lemma 25.18 Let Î± âˆˆB (0, 1) and deï¬ne
Ï†Î± (z) â‰¡z âˆ’Î±
1 âˆ’Î±z .
Then Ï†Î± : B (0, 1) â†’B (0, 1) , Ï†Î± : âˆ‚B (0, 1) â†’âˆ‚B (0, 1) , and is one to one and
onto. Also Ï†âˆ’Î± = Ï†âˆ’1
Î± . Also
Ï†â€²
Î± (0) = 1 âˆ’|Î±|2 , Ï†â€² (Î±) =
1
1 âˆ’|Î±|2 .
Proof: First of all, for |z| < 1/ |Î±| ,
Ï†Î± â—¦Ï†âˆ’Î± (z) â‰¡
Â³
z+Î±
1+Î±z
Â´
âˆ’Î±
1 âˆ’Î±
Â³
z+Î±
1+Î±z
Â´ = z
after a few computations. If I show that Ï†Î± maps B (0, 1) to B (0, 1) for all |Î±| < 1,
this will have shown that Ï†Î± is one to one and onto B (0, 1).
Consider
Â¯Â¯Ï†Î±
Â¡
eiÎ¸Â¢Â¯Â¯ . This yields
Â¯Â¯Â¯Â¯
eiÎ¸ âˆ’Î±
1 âˆ’Î±eiÎ¸
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
1 âˆ’Î±eâˆ’iÎ¸
1 âˆ’Î±eiÎ¸
Â¯Â¯Â¯Â¯ = 1

692
THE OPEN MAPPING THEOREM
where the ï¬rst equality is obtained by multiplying by
Â¯Â¯eâˆ’iÎ¸Â¯Â¯ = 1. Therefore, Ï†Î± maps
âˆ‚B (0, 1) one to one and onto âˆ‚B (0, 1) . Now notice that Ï†Î± is analytic on B (0, 1)
because the only singularity, a pole is at z = 1/Î±.
By the maximum modulus
theorem, it follows
|Ï†Î± (z)| < 1
whenever |z| < 1. The same is true of Ï†âˆ’Î±.
It only remains to verify the assertions about the derivatives. Long division
gives Ï†Î± (z) = (âˆ’Î±)âˆ’1 +
Â³
âˆ’Î±+(Î±)âˆ’1
1âˆ’Î±z
Â´
and so
Ï†â€²
Î± (z)
=
(âˆ’1) (1 âˆ’Î±z)âˆ’2 Â³
âˆ’Î± + (Î±)âˆ’1Â´
(âˆ’Î±)
=
Î± (1 âˆ’Î±z)âˆ’2 Â³
âˆ’Î± + (Î±)âˆ’1Â´
=
(1 âˆ’Î±z)âˆ’2 Â³
âˆ’|Î±|2 + 1
Â´
Hence the two formulas follow. This proves the lemma.
One reason these mappings are so important is the following theorem.
Theorem 25.19 Suppose f is an analytic function deï¬ned on B (0, 1) and f maps
B (0, 1) one to one and onto B (0, 1) . Then there exists Î¸ such that
f (z) = eiÎ¸Ï†Î± (z)
for some Î± âˆˆB (0, 1) .
Proof: Let f (Î±) = 0. Then h (z) â‰¡f â—¦Ï†âˆ’Î± (z) maps B (0, 1) one to one and
onto B (0, 1) and has the property that h (0) = 0. Therefore, by the Schwarz lemma,
|h (z)| â‰¤|z| .
but it is also the case that hâˆ’1 (0) = 0 and hâˆ’1 maps B (0, 1) to B (0, 1). Therefore,
the same inequality holds for hâˆ’1. Therefore,
|z| =
Â¯Â¯hâˆ’1 (h (z))
Â¯Â¯ â‰¤|h (z)|
and so |h (z)| = |z| . By the Schwarz lemma again, h (z) â‰¡f
Â¡
Ï†âˆ’Î± (z)
Â¢
= eiÎ¸z.
Letting z = Ï†Î±, you get f (z) = eiÎ¸Ï†Î± (z).
25.5
Exercises
1. Consider the function, g (z) = zâˆ’i
z+i. Show this is analytic on the upper half
plane, P+ and maps the upper half plane one to one and onto B (0, 1). Hint:
First show g maps the real axis to âˆ‚B (0, 1) . This is really easy because you
end up looking at a complex number divided by its conjugate. Thus |g (z)| = 1
for z on âˆ‚(P+) . Now show that lim supzâ†’âˆž|g (z)| = 1. Then apply a version
of the maximum modulus theorem. You might note that g (z) = 1+ âˆ’2i
z+i. This
will show |g (z)| â‰¤1. Next pick w âˆˆB (0, 1) and solve g (z) = w. You just
have to show there exists a unique solution and its imaginary part is positive.

25.5.
EXERCISES
693
2. Does there exist an entire function f which maps C onto the upper half plane?
3. Letting g be the function of Problem 1 show that
Â¡
gâˆ’1Â¢â€² (0) = 2. Also note
that gâˆ’1 (0) = i. Now suppose f is an analytic function deï¬ned on the upper
half plane which has the property that |f (z)| â‰¤1 and f (i) = Î² where |Î²| < 1.
Find an upper bound to |f â€² (i)| . Also ï¬nd all functions, f which satisfy the
condition, f (i) = Î², |f (z)| â‰¤1, and achieve this maximum value. Hint: You
could consider the function, h (z) â‰¡Ï†Î² â—¦f â—¦gâˆ’1 (z) and check the conditions
for the Schwarz lemma for this function, h.
4. This and the next two problems follow a presentation of an interesting topic
in Rudin [45]. Let Ï†Î± be given in Lemma 25.18. Suppose f is an analytic
function deï¬ned on B (0, 1) which satisï¬es |f (z)| â‰¤1. Suppose also there are
Î±, Î² âˆˆB (0, 1) and it is required f (Î±) = Î². If f is such a function, show
that |f â€² (Î±)| â‰¤1âˆ’|Î²|2
1âˆ’|Î±|2 . Hint: To show this consider g = Ï†Î² â—¦f â—¦Ï†âˆ’Î±. Show
g (0) = 0 and |g (z)| â‰¤1 on B (0, 1) . Now use Lemma 25.17.
5. In Problem 4 show there exists a function, f analytic on B (0, 1) such that
f (Î±) = Î², |f (z)| â‰¤0, and |f â€² (Î±)| = 1âˆ’|Î²|2
1âˆ’|Î±|2 . Hint: You do this by choosing
g in the above problem such that equality holds in Lemma 25.17. Thus you
need g (z) = Î»z where |Î»| = 1 and solve g = Ï†Î² â—¦f â—¦Ï†âˆ’Î± for f.
6. Suppose that f : B (0, 1) â†’B (0, 1) and that f is analytic, one to one, and
onto with f (Î±) = 0. Show there exists Î», |Î»| = 1 such that f (z) = Î»Ï†Î± (z) .
This gives a diï¬€erent way to look at Theorem 25.19. Hint: Let g = f âˆ’1.
Then gâ€² (0) f â€² (Î±) = 1. However, f (Î±) = 0 and g (0) = Î±. From Problem
4 with Î² = 0, you can conclude an inequality for |f â€² (Î±)| and another one
for |gâ€² (0)| . Then use the fact that the product of these two equals 1 which
comes from the chain rule to conclude that equality must take place. Now use
Problem 5 to obtain the form of f.
7. In Corollary 25.16 show that it is essential that Î± < 1. That is, show there
exists an example where the conclusion is not satisï¬ed with a slightly weaker
growth condition. Hint: Consider exp (exp (z)) .
8. Suppose {fn} is a sequence of functions which are analytic on â„¦, a bounded
region such that each fn is also continuous on â„¦. Suppose that {fn} converges
uniformly on âˆ‚â„¦. Show that then {fn} converges uniformly on â„¦and that the
function to which the sequence converges is analytic on â„¦and continuous on
â„¦.
9. Suppose â„¦is a bounded region and there exists a point z0 âˆˆâ„¦such that
|f (z0)| = min
Â©
|f (z)| : z âˆˆâ„¦
Âª
. Can you conclude f must equal a constant?
10. Suppose f is continuous on B (a, r) and analytic on B (a, r) and that f is not
constant. Suppose also |f (z)| = C Ì¸= 0 for all |z âˆ’a| = r. Show that there
exists Î± âˆˆB (a, r) such that f (Î±) = 0. Hint: If not, consider f/C and C/f.
Both would be analytic on B (a, r) and are equal to 1 on the boundary.

694
THE OPEN MAPPING THEOREM
11. Suppose f is analytic on B (0, 1) but for every a âˆˆâˆ‚B (0, 1) , limzâ†’a |f (z)| =
âˆž. Show there exists a sequence, {zn} âŠ†B (0, 1) such that limnâ†’âˆž|zn| = 1
and f (zn) = 0.
25.6
Counting Zeros
The above proof of the open mapping theorem relies on the very important inverse
function theorem from real analysis. There are other approaches to this important
theorem which do not rely on the big theorems from real analysis and are more
oriented toward the use of the Cauchy integral formula and specialized techniques
from complex analysis. One of these approaches is given next which involves the
notion of â€œcounting zerosâ€. The next theorem is the one about counting zeros. It
will also be used later in the proof of the Riemann mapping theorem.
Theorem 25.20 Let â„¦be an open set in C and let Î³ : [a, b] â†’â„¦be closed, con-
tinuous, bounded variation, and n (Î³, z) = 0 for all z /âˆˆâ„¦. Suppose also that f
is analytic on â„¦having zeros a1, Â· Â· Â·, am where the zeros are repeated according to
multiplicity, and suppose that none of these zeros are on Î³âˆ—. Then
1
2Ï€i
Z
Î³
f â€² (z)
f (z) dz =
m
X
k=1
n (Î³, ak) .
Proof: Let f (z) = Qm
j=1 (z âˆ’aj) g (z) where g (z) Ì¸= 0 on â„¦. Hence
f â€² (z)
f (z) =
m
X
j=1
1
z âˆ’aj
+ gâ€² (z)
g (z)
and so
1
2Ï€i
Z
Î³
f â€² (z)
f (z) dz =
m
X
j=1
n (Î³, aj) +
1
2Ï€i
Z
Î³
gâ€² (z)
g (z) dz.
But the function, z â†’gâ€²(z)
g(z) is analytic and so by Corollary 24.47, the last integral
in the above expression equals 0. Therefore, this proves the theorem.
The following picture is descriptive of the situation described in the next theo-
rem.
â„¦
f
q
Î³
a1
q
qa2
a3q
f(Î³([a, b]))
Î±q
Theorem 25.21 Let â„¦be a region, let Î³ : [a, b] â†’â„¦be closed continuous, and
bounded variation such that n (Î³, z) = 0 for all z /âˆˆâ„¦. Also suppose f : â„¦â†’C

25.6.
COUNTING ZEROS
695
is analytic and that Î± /âˆˆf (Î³âˆ—) . Then f â—¦Î³ : [a, b] â†’C is continuous, closed,
and bounded variation. Also suppose {a1, Â· Â· Â·, am} = f âˆ’1 (Î±) where these points are
counted according to their multiplicities as zeros of the function f âˆ’Î± Then
n (f â—¦Î³, Î±) =
m
X
k=1
n (Î³, ak) .
Proof: It is clear that f â—¦Î³ is continuous. It only remains to verify that it is of
bounded variation. Suppose ï¬rst that Î³âˆ—âŠ†B âŠ†B âŠ†â„¦where B is a ball. Then
|f (Î³ (t)) âˆ’f (Î³ (s))| =
Â¯Â¯Â¯Â¯
Z 1
0
f â€² (Î³ (s) + Î» (Î³ (t) âˆ’Î³ (s))) (Î³ (t) âˆ’Î³ (s)) dÎ»
Â¯Â¯Â¯Â¯
â‰¤
C |Î³ (t) âˆ’Î³ (s)|
where C â‰¥max
Â©
|f â€² (z)| : z âˆˆB
Âª
. Hence, in this case,
V (f â—¦Î³, [a, b]) â‰¤CV (Î³, [a, b]) .
Now let Îµ denote the distance between Î³âˆ—and C \ â„¦. Since Î³âˆ—is compact, Îµ > 0.
By uniform continuity there exists Î´ =
bâˆ’a
p
for p a positive integer such that if
|s âˆ’t| < Î´, then |Î³ (s) âˆ’Î³ (t)| < Îµ
2. Then
Î³ ([t, t + Î´]) âŠ†B
Â³
Î³ (t) , Îµ
2
Â´
âŠ†â„¦.
Let C â‰¥max
n
|f â€² (z)| : z âˆˆâˆªp
j=1B
Â¡
Î³ (tj) , Îµ
2
Â¢o
where tj â‰¡j
p (b âˆ’a) + a. Then from
what was just shown,
V (f â—¦Î³, [a, b])
â‰¤
pâˆ’1
X
j=0
V (f â—¦Î³, [tj, tj+1])
â‰¤
C
pâˆ’1
X
j=0
V (Î³, [tj, tj+1]) < âˆž
showing that f â—¦Î³ is bounded variation as claimed. Now from Theorem 24.42 there
exists Î· âˆˆC1 ([a, b]) such that
Î· (a) = Î³ (a) = Î³ (b) = Î· (b) , Î· ([a, b]) âŠ†â„¦,
and
n (Î·, ak) = n (Î³, ak) , n (f â—¦Î³, Î±) = n (f â—¦Î·, Î±)
(25.7)
for k = 1, Â· Â· Â·, m. Then
n (f â—¦Î³, Î±) = n (f â—¦Î·, Î±)

696
THE OPEN MAPPING THEOREM
=
1
2Ï€i
Z
fâ—¦Î·
dw
w âˆ’Î±
=
1
2Ï€i
Z b
a
f â€² (Î· (t))
f (Î· (t)) âˆ’Î±Î·â€² (t) dt
=
1
2Ï€i
Z
Î·
f â€² (z)
f (z) âˆ’Î±dz
=
m
X
k=1
n (Î·, ak)
By Theorem 25.20. By 25.7, this equals Pm
k=1 n (Î³, ak) which proves the theorem.
The next theorem is incredible and is very interesting for its own sake. The
following picture is descriptive of the situation of this theorem.
f
q
t a
t a1
t a2
t a3
t a4
B(a, Ïµ)
sz s Î±
B(Î±, Î´)
Theorem 25.22 Let f : B (a, R) â†’C be analytic and let
f (z) âˆ’Î± = (z âˆ’a)m g (z) , âˆž> m â‰¥1
where g (z) Ì¸= 0 in B (a, R) . (f (z) âˆ’Î± has a zero of order m at z = a.) Then there
exist Îµ, Î´ > 0 with the property that for each z satisfying 0 < |z âˆ’Î±| < Î´, there exist
points,
{a1, Â· Â· Â·, am} âŠ†B (a, Îµ) ,
such that
f âˆ’1 (z) âˆ©B (a, Îµ) = {a1, Â· Â· Â·, am}
and each ak is a zero of order 1 for the function f (Â·) âˆ’z.
Proof: By Theorem 24.23 f is not constant on B (a, R) because it has a zero
of order m. Therefore, using this theorem again, there exists Îµ > 0 such that
B (a, 2Îµ) âŠ†B (a, R) and there are no solutions to the equation f (z) âˆ’Î± = 0 for
z âˆˆB (a, 2Îµ) except a. Also assume Îµ is small enough that for 0 < |z âˆ’a| â‰¤2Îµ,
f â€² (z) Ì¸= 0. This can be done since otherwise, a would be a limit point of a sequence
of points, zn, having f â€² (zn) = 0 which would imply, by Theorem 24.23 that f â€² = 0
on B (a, R) , contradicting the assumption that f âˆ’Î± has a zero of order m and is
therefore not constant. Thus the situation is described by the following picture.

25.6.
COUNTING ZEROS
697
f âˆ’Î± Ì¸= 0
f â€² Ì¸= 0
2Îµ
s
Â¡
Â¡
Â¡
Â¡
Âª
Now pick Î³ (t) = a + Îµeit, t âˆˆ[0, 2Ï€] . Then Î± /âˆˆf (Î³âˆ—) so there exists Î´ > 0 with
B (Î±, Î´) âˆ©f (Î³âˆ—) = âˆ….
(25.8)
Therefore, B (Î±, Î´) is contained on one component of C \ f (Î³ ([0, 2Ï€])) . Therefore,
n (f â—¦Î³, Î±) = n (f â—¦Î³, z) for all z âˆˆB (Î±, Î´) . Now consider f restricted to B (a, 2Îµ) .
For z âˆˆB (Î±, Î´) , f âˆ’1 (z) must consist of a ï¬nite set of points because f â€² (w) Ì¸= 0
for all w in B (a, 2Îµ) \ {a} implying that the zeros of f (Â·) âˆ’z in B (a, 2Îµ) have no
limit point. Since B (a, 2Îµ) is compact, this means there are only ï¬nitely many. By
Theorem 25.21,
n (f â—¦Î³, z) =
p
X
k=1
n (Î³, ak)
(25.9)
where {a1, Â· Â· Â·, ap} = f âˆ’1 (z) . Each point, ak of f âˆ’1 (z) is either inside the circle
traced out by Î³, yielding n (Î³, ak) = 1, or it is outside this circle yielding n (Î³, ak) =
0 because of 25.8. It follows the sum in 25.9 reduces to the number of points of
f âˆ’1 (z) which are contained in B (a, Îµ) . Thus, letting those points in f âˆ’1 (z) which
are contained in B (a, Îµ) be denoted by {a1, Â· Â· Â·, ar}
n (f â—¦Î³, Î±) = n (f â—¦Î³, z) = r.
Also, by Theorem 25.20, m = n (f â—¦Î³, Î±) because a is a zero of f âˆ’Î± of order m.
Therefore, for z âˆˆB (Î±, Î´)
m = n (f â—¦Î³, Î±) = n (f â—¦Î³, z) = r
It is required to show r = m, the order of the zero of f âˆ’Î±. Therefore, r = m. Each
of these ak is a zero of order 1 of the function f (Â·) âˆ’z because f â€² (ak) Ì¸= 0. This
proves the theorem.
This is a very fascinating result partly because it implies that for values of f
near a value, Î±, at which f (Â·) âˆ’Î± has a zero of order m for m > 1, the inverse
image of these values includes at least m points, not just one. Thus the topological
properties of the inverse image changes radically. This theorem also shows that
f (B (a, Îµ)) âŠ‡B (Î±, Î´) .
Theorem 25.23 (open mapping theorem)
Let â„¦be a region and f : â„¦â†’C
be analytic. Then f (â„¦) is either a point or a region. If f is one to one, then
f âˆ’1 : f (â„¦) â†’â„¦is analytic.

698
THE OPEN MAPPING THEOREM
Proof: If f is not constant, then for every Î± âˆˆf (â„¦) , it follows from Theorem
24.23 that f (Â·) âˆ’Î± has a zero of order m < âˆžand so from Theorem 25.22 for each
a âˆˆâ„¦there exist Îµ, Î´ > 0 such that f (B (a, Îµ)) âŠ‡B (Î±, Î´) which clearly implies
that f maps open sets to open sets. Therefore, f (â„¦) is open, connected because f
is continuous. If f is one to one, Theorem 25.22 implies that for every Î± âˆˆf (â„¦)
the zero of f (Â·) âˆ’Î± is of order 1. Otherwise, that theorem implies that for z near
Î±, there are m points which f maps to z contradicting the assumption that f is one
to one. Therefore, f â€² (z) Ì¸= 0 and since f âˆ’1 is continuous, due to f being an open
map, it follows
Â¡
f âˆ’1Â¢â€² (f (z))
=
lim
f(z1)â†’f(z)
f âˆ’1 (f (z1)) âˆ’f âˆ’1 (f (z))
f (z1) âˆ’f (z)
=
lim
z1â†’z
z1 âˆ’z
f (z1) âˆ’f (z) =
1
f â€² (z).
This proves the theorem.
25.7
An Application To Linear Algebra
Gerschgorinâ€™s theorem gives a convenient way to estimate eigenvalues of a matrix
from easy to obtain information.
For A an n Ã— n matrix, denote by Ïƒ (A) the
collection of all eigenvalues of A.
Theorem 25.24 Let A be an n Ã— n matrix.
Consider the n Gerschgorin discs
deï¬ned as
Di â‰¡
ï£±
ï£²
ï£³Î» âˆˆC : |Î» âˆ’aii| â‰¤
X
jÌ¸=i
|aij|
ï£¼
ï£½
ï£¾.
Then every eigenvalue is contained in some Gerschgorin disc.
This theorem says to add up the absolute values of the entries of the ith row
which are oï¬€the main diagonal and form the disc centered at aii having this radius.
The union of these discs contains Ïƒ (A) .
Proof: Suppose Ax = Î»x where x Ì¸= 0. Then for A = (aij)
X
jÌ¸=i
aijxj = (Î» âˆ’aii) xi.
Therefore, if we pick k such that |xk| â‰¥|xj| for all xj, it follows that |xk| Ì¸= 0 since
|x| Ì¸= 0 and
|xk|
X
jÌ¸=k
|akj| â‰¥
X
jÌ¸=k
|akj| |xj| â‰¥|Î» âˆ’akk| |xk| .
Now dividing by |xk| we see that Î» is contained in the kth Gerschgorin disc.

25.7.
AN APPLICATION TO LINEAR ALGEBRA
699
More can be said using the theory about counting zeros. To begin with the
distance between two n Ã— n matrices, A = (aij) and B = (bij) as follows.
||A âˆ’B||2 â‰¡
X
ij
|aij âˆ’bij|2 .
Thus two matrices are close if and only if their corresponding entries are close.
Let A be an n Ã— n matrix. Recall the eigenvalues of A are given by the zeros
of the polynomial, pA (z) = det (zI âˆ’A) where I is the n Ã— n identity. Then small
changes in A will produce small changes in pA (z) and pâ€²
A (z) . Let Î³k denote a very
small closed circle which winds around zk, one of the eigenvalues of A, in the counter
clockwise direction so that n (Î³k, zk) = 1. This circle is to enclose only zk and is
to have no other eigenvalue on it. Then apply Theorem 25.20. According to this
theorem
1
2Ï€i
Z
Î³
pâ€²
A (z)
pA (z)dz
is always an integer equal to the multiplicity of zk as a root of pA (t) . Therefore,
small changes in A result in no change to the above contour integral because it
must be an integer and small changes in A result in small changes in the integral.
Therefore whenever every entry of the matrix B is close enough to the corresponding
entry of the matrix A, the two matrices have the same number of zeros inside Î³k
under the usual convention that zeros are to be counted according to multiplicity. By
making the radius of the small circle equal to Îµ where Îµ is less than the minimum
distance between any two distinct eigenvalues of A, this shows that if B is close
enough to A, every eigenvalue of B is closer than Îµ to some eigenvalue of A. The
next theorem is about continuous dependence of eigenvalues.
Theorem 25.25 If Î» is an eigenvalue of A, then if ||B âˆ’A|| is small enough, some
eigenvalue of B will be within Îµ of Î».
Consider the situation that A (t) is an n Ã— n matrix and that t â†’A (t) is
continuous for t âˆˆ[0, 1] .
Lemma 25.26 Let Î» (t) âˆˆÏƒ (A (t)) for t < 1 and let Î£t = âˆªsâ‰¥tÏƒ (A (s)) . Also let
Kt be the connected component of Î» (t) in Î£t. Then there exists Î· > 0 such that
Kt âˆ©Ïƒ (A (s)) Ì¸= âˆ…for all s âˆˆ[t, t + Î·] .
Proof: Denote by D (Î» (t) , Î´) the disc centered at Î» (t) having radius Î´ > 0,
with other occurrences of this notation being deï¬ned similarly. Thus
D (Î» (t) , Î´) â‰¡{z âˆˆC : |Î» (t) âˆ’z| â‰¤Î´} .
Suppose Î´ > 0 is small enough that Î» (t) is the only element of Ïƒ (A (t)) contained
in D (Î» (t) , Î´) and that pA(t) has no zeroes on the boundary of this disc. Then by
continuity, and the above discussion and theorem, there exists Î· > 0, t+Î· < 1, such
that for s âˆˆ[t, t + Î·] , pA(s) also has no zeroes on the boundary of this disc and that

700
THE OPEN MAPPING THEOREM
A (s) has the same number of eigenvalues, counted according to multiplicity, in the
disc as A (t) . Thus Ïƒ (A (s)) âˆ©D (Î» (t) , Î´) Ì¸= âˆ…for all s âˆˆ[t, t + Î·] . Now let
H =
[
sâˆˆ[t,t+Î·]
Ïƒ (A (s)) âˆ©D (Î» (t) , Î´) .
I will show H is connected. Suppose not. Then H = P âˆªQ where P, Q are separated
and Î» (t) âˆˆP. Let
s0 â‰¡inf {s : Î» (s) âˆˆQ for some Î» (s) âˆˆÏƒ (A (s))} .
There exists Î» (s0) âˆˆÏƒ (A (s0)) âˆ©D (Î» (t) , Î´) . If Î» (s0) /âˆˆQ, then from the above
discussion there are
Î» (s) âˆˆÏƒ (A (s)) âˆ©Q
for s > s0 arbitrarily close to Î» (s0) . Therefore, Î» (s0) âˆˆQ which shows that s0 > t
because Î» (t) is the only element of Ïƒ (A (t)) in D (Î» (t) , Î´) and Î» (t) âˆˆP. Now let
sn â†‘s0. Then Î» (sn) âˆˆP for any
Î» (sn) âˆˆÏƒ (A (sn)) âˆ©D (Î» (t) , Î´)
and from the above discussion, for some choice of sn â†’s0, Î» (sn) â†’Î» (s0) which
contradicts P and Q separated and nonempty. Since P is nonempty, this shows
Q = âˆ…. Therefore, H is connected as claimed. But Kt âŠ‡H and so Ktâˆ©Ïƒ (A (s)) Ì¸= âˆ…
for all s âˆˆ[t, t + Î·] . This proves the lemma.
The following is the necessary theorem.
Theorem 25.27 Suppose A (t) is an nÃ—n matrix and that t â†’A (t) is continuous
for t âˆˆ[0, 1] . Let Î» (0) âˆˆÏƒ (A (0)) and deï¬ne Î£ â‰¡âˆªtâˆˆ[0,1]Ïƒ (A (t)) . Let KÎ»(0) = K0
denote the connected component of Î» (0) in Î£. Then K0 âˆ©Ïƒ (A (t)) Ì¸= âˆ…for all
t âˆˆ[0, 1] .
Proof: Let S â‰¡{t âˆˆ[0, 1] : K0 âˆ©Ïƒ (A (s)) Ì¸= âˆ…for all s âˆˆ[0, t]} . Then 0 âˆˆS.
Let t0 = sup (S) . Say Ïƒ (A (t0)) = Î»1 (t0) , Â· Â· Â·, Î»r (t0) . I claim at least one of these
is a limit point of K0 and consequently must be in K0 which will show that S
has a last point. Why is this claim true? Let sn â†‘t0 so sn âˆˆS. Now let the discs,
D (Î»i (t0) , Î´) , i = 1, Â·Â·Â·, r be disjoint with pA(t0) having no zeroes on Î³i the boundary
of D (Î»i (t0) , Î´) . Then for n large enough it follows from Theorem 25.20 and the
discussion following it that Ïƒ (A (sn)) is contained in âˆªr
i=1D (Î»i (t0) , Î´). Therefore,
K0 âˆ©(Ïƒ (A (t0)) + D (0, Î´)) Ì¸= âˆ…for all Î´ small enough. This requires at least one of
the Î»i (t0) to be in K0. Therefore, t0 âˆˆS and S has a last point.
Now by Lemma 25.26, if t0 < 1, then K0âˆªKt would be a strictly larger connected
set containing Î» (0) . (The reason this would be strictly larger is that K0âˆ©Ïƒ (A (s)) =
âˆ…for some s âˆˆ(t, t + Î·) while Kt âˆ©Ïƒ (A (s)) Ì¸= âˆ…for all s âˆˆ[t, t + Î·].) Therefore,
t0 = 1 and this proves the theorem.
The following is an interesting corollary of the Gerschgorin theorem.

25.7.
AN APPLICATION TO LINEAR ALGEBRA
701
Corollary 25.28 Suppose one of the Gerschgorin discs, Di is disjoint from the
union of the others. Then Di contains an eigenvalue of A. Also, if there are n
disjoint Gerschgorin discs, then each one contains an eigenvalue of A.
Proof: Denote by A (t) the matrix
Â¡
at
ij
Â¢
where if i Ì¸= j, at
ij = taij and at
ii = aii.
Thus to get A (t) we multiply all non diagonal terms by t. Let t âˆˆ[0, 1] . Then
A (0) = diag (a11, Â· Â· Â·, ann) and A (1) = A. Furthermore, the map, t â†’A (t) is
continuous. Denote by Dt
j the Gerschgorin disc obtained from the jth row for the
matrix, A (t). Then it is clear that Dt
j âŠ†Dj the jth Gerschgorin disc for A. Then
aii is the eigenvalue for A (0) which is contained in the disc, consisting of the single
point aii which is contained in Di. Letting K be the connected component in Î£ for
Î£ deï¬ned in Theorem 25.27 which is determined by aii, it follows by Gerschgorinâ€™s
theorem that K âˆ©Ïƒ (A (t)) âŠ†âˆªn
j=1Dt
j âŠ†âˆªn
j=1Dj = Di âˆª(âˆªjÌ¸=iDj) and also, since
K is connected, there are no points of K in both Di and (âˆªjÌ¸=iDj) . Since at least
one point of K is in Di,(aii) it follows all of K must be contained in Di. Now by
Theorem 25.27 this shows there are points of K âˆ©Ïƒ (A) in Di. The last assertion
follows immediately.
Actually, this can be improved slightly. It involves the following lemma.
Lemma 25.29 In the situation of Theorem 25.27 suppose Î» (0) = K0 âˆ©Ïƒ (A (0))
and that Î» (0) is a simple root of the characteristic equation of A (0). Then for all
t âˆˆ[0, 1] ,
Ïƒ (A (t)) âˆ©K0 = Î» (t)
where Î» (t) is a simple root of the characteristic equation of A (t) .
Proof: Let S â‰¡
{t âˆˆ[0, 1] : K0 âˆ©Ïƒ (A (s)) = Î» (s) , a simple eigenvalue for all s âˆˆ[0, t]} .
Then 0 âˆˆS so it is nonempty. Let t0 = sup (S) and suppose Î»1 Ì¸= Î»2 are two
elements of Ïƒ (A (t0)) âˆ©K0. Then choosing Î· > 0 small enough, and letting Di be
disjoint discs containing Î»i respectively, similar arguments to those of Lemma 25.26
imply
Hi â‰¡âˆªsâˆˆ[t0âˆ’Î·,t0]Ïƒ (A (s)) âˆ©Di
is a connected and nonempty set for i = 1, 2 which would require that Hi âŠ†K0.
But then there would be two diï¬€erent eigenvalues of A (s) contained in K0, contrary
to the deï¬nition of t0. Therefore, there is at most one eigenvalue, Î» (t0) âˆˆK0 âˆ©
Ïƒ (A (t0)) . The possibility that it could be a repeated root of the characteristic
equation must be ruled out. Suppose then that Î» (t0) is a repeated root of the
characteristic equation. As before, choose a small disc, D centered at Î» (t0) and Î·
small enough that
H â‰¡âˆªsâˆˆ[t0âˆ’Î·,t0]Ïƒ (A (s)) âˆ©D
is a nonempty connected set containing either multiple eigenvalues of A (s) or else a
single repeated root to the characteristic equation of A (s) . But since H is connected
and contains Î» (t0) it must be contained in K0 which contradicts the condition for

702
THE OPEN MAPPING THEOREM
s âˆˆS for all these s âˆˆ[t0 âˆ’Î·, t0] . Therefore, t0 âˆˆS as hoped. If t0 < 1, there exists
a small disc centered at Î» (t0) and Î· > 0 such that for all s âˆˆ[t0, t0 + Î·] , A (s) has
only simple eigenvalues in D and the only eigenvalues of A (s) which could be in K0
are in D. (This last assertion follows from noting that Î» (t0) is the only eigenvalue
of A (t0) in K0 and so the others are at a positive distance from K0. For s close
enough to t0, the eigenvalues of A (s) are either close to these eigenvalues of A (t0)
at a positive distance from K0 or they are close to the eigenvalue, Î» (t0) in which
case it can be assumed they are in D.) But this shows that t0 is not really an upper
bound to S. Therefore, t0 = 1 and the lemma is proved.
With this lemma, the conclusion of the above corollary can be improved.
Corollary 25.30 Suppose one of the Gerschgorin discs, Di is disjoint from the
union of the others. Then Di contains exactly one eigenvalue of A and this eigen-
value is a simple root to the characteristic polynomial of A.
Proof: In the proof of Corollary 25.28, ï¬rst note that aii is a simple root of A (0)
since otherwise the ith Gerschgorin disc would not be disjoint from the others. Also,
K, the connected component determined by aii must be contained in Di because it
is connected and by Gerschgorinâ€™s theorem above, K âˆ©Ïƒ (A (t)) must be contained
in the union of the Gerschgorin discs. Since all the other eigenvalues of A (0) , the
ajj, are outside Di, it follows that K âˆ©Ïƒ (A (0)) = aii. Therefore, by Lemma 25.29,
K âˆ©Ïƒ (A (1)) = K âˆ©Ïƒ (A) consists of a single simple eigenvalue. This proves the
corollary.
Example 25.31 Consider the matrix,
ï£«
ï£­
5
1
0
1
1
1
0
1
0
ï£¶
ï£¸
The Gerschgorin discs are D (5, 1) , D (1, 2) , and D (0, 1) . Then D (5, 1) is dis-
joint from the other discs. Therefore, there should be an eigenvalue in D (5, 1) .
The actual eigenvalues are not easy to ï¬nd. They are the roots of the characteristic
equation, t3 âˆ’6t2 + 3t + 5 = 0. The numerical values of these are âˆ’. 669 66, 1. 423 1,
and 5. 246 55, verifying the predictions of Gerschgorinâ€™s theorem.
25.8
Exercises
1. Use Theorem 25.20 to give an alternate proof of the fundamental theorem
of algebra. Hint: Take a contour of the form Î³r = reit where t âˆˆ[0, 2Ï€] .
Consider
R
Î³r
pâ€²(z)
p(z) dz and consider the limit as r â†’âˆž.
2. Let M be an n Ã— n matrix. Recall that the eigenvalues of M are given by the
zeros of the polynomial, pM (z) = det (M âˆ’zI) where I is the n Ã— n identity.
Formulate a theorem which describes how the eigenvalues depend on small

25.8.
EXERCISES
703
changes in M. Hint: You could deï¬ne a norm on the space of n Ã— n matrices
as ||M|| â‰¡tr (MM âˆ—)1/2 where M âˆ—is the conjugate transpose of M. Thus
||M|| =
ï£«
ï£­X
j,k
|Mjk|2
ï£¶
ï£¸
1/2
.
Argue that small changes will produce small changes in pM (z) . Then apply
Theorem 25.20 using Î³k a very small circle surrounding zk, the kth eigenvalue.
3. Suppose that two analytic functions deï¬ned on a region are equal on some
set, S which contains a limit point. (Recall p is a limit point of S if every
open set which contains p, also contains inï¬nitely many points of S. ) Show
the two functions coincide. We deï¬ned ez â‰¡ex (cos y + i sin y) earlier and we
showed that ez, deï¬ned this way was analytic on C. Is there any other way
to deï¬ne ez on all of C such that the function coincides with ex on the real
axis?
4. You know various identities for real valued functions. For example cosh2 x âˆ’
sinh2 x = 1. If you deï¬ne cosh z â‰¡ez+eâˆ’z
2
and sinh z â‰¡ezâˆ’eâˆ’z
2
, does it follow
that
cosh2 z âˆ’sinh2 z = 1
for all z âˆˆC? What about
sin (z + w) = sin z cos w + cos z sin w?
Can you verify these sorts of identities just from your knowledge about what
happens for real arguments?
5. Was it necessary that U be a region in Theorem 24.23?
Would the same
conclusion hold if U were only assumed to be an open set? Why? What
about the open mapping theorem? Would it hold if U were not a region?
6. Let f : U â†’C be analytic and one to one. Show that f â€² (z) Ì¸= 0 for all z âˆˆU.
Does this hold for a function of a real variable?
7. We say a real valued function, u is subharmonic if uxx+uyy â‰¥0. Show that if u
is subharmonic on a bounded region, (open connected set) U, and continuous
on U and u â‰¤m on âˆ‚U, then u â‰¤m on U. Hint: If not, u achieves its
maximum at (x0, y0) âˆˆU. Let u (x0, y0) > m + Î´ where Î´ > 0. Now consider
uÎµ (x, y) = Îµx2 + u (x, y) where Îµ is small enough that 0 < Îµx2 < Î´ for all
(x, y) âˆˆU. Show that uÎµ also achieves its maximum at some point of U and
that therefore, uÎµxx + uÎµyy â‰¤0 at that point implying that uxx + uyy â‰¤âˆ’Îµ,
a contradiction.
8. If u is harmonic on some region, U, show that u coincides locally with the
real part of an analytic function and that therefore, u has inï¬nitely many

704
THE OPEN MAPPING THEOREM
derivatives on U. Hint:
Consider the case where 0 âˆˆU. You can always
reduce to this case by a suitable translation. Now let B (0, r) âŠ†U and use
the Schwarz formula to obtain an analytic function whose real part coincides
with u on âˆ‚B (0, r) . Then use Problem 7.
9. Show the solution to the Dirichlet problem of Problem 8 on Page 656 is unique.
You need to formulate this precisely and then prove uniqueness.

Residues
Deï¬nition 26.1 The residue of f at an isolated singularity Î± which is a pole,
written res (f, Î±) is the coeï¬ƒcient of (z âˆ’Î±)âˆ’1 where
f (z) = g (z) +
m
X
k=1
bk
(z âˆ’Î±)k .
Thus res (f, Î±) = b1 in the above.
At this point, recall Corollary 24.47 which is stated here for convenience.
Corollary 26.2 Let â„¦be an open set and let Î³k : [ak, bk] â†’â„¦, k = 1, Â· Â· Â·, m, be
closed, continuous and of bounded variation. Suppose also that
m
X
k=1
n (Î³k, z) = 0
for all z /âˆˆâ„¦. Then if f : â„¦â†’C is analytic,
m
X
k=1
Z
Î³k
f (w) dw = 0.
The following theorem is called the residue theorem. Note the resemblance to
Corollary 24.47.
Theorem 26.3 Let â„¦be an open set and let Î³k : [ak, bk] â†’â„¦, k = 1, Â· Â· Â·, m, be
closed, continuous and of bounded variation. Suppose also that
m
X
k=1
n (Î³k, z) = 0
for all z /âˆˆâ„¦. Then if f : â„¦â†’bC is meromorphic such that no Î³âˆ—
k contains any poles
of f,
1
2Ï€i
m
X
k=1
Z
Î³k
f (w) dw =
X
Î±âˆˆA
res (f, Î±)
m
X
k=1
n (Î³k, Î±)
(26.1)
705

706
RESIDUES
where here A denotes the set of poles of f in â„¦. The sum on the right is a ï¬nite
sum.
Proof: First note that there are at most ï¬nitely many Î± which are not in
the unbounded component of C \ âˆªm
k=1Î³k ([ak, bk]) . Thus there exists a ï¬nite set,
{Î±1, Â· Â· Â·, Î±N} âŠ†A such that these are the only possibilities for which Pn
k=1 n (Î³k, Î±)
might not equal zero. Therefore, 26.1 reduces to
1
2Ï€i
m
X
k=1
Z
Î³k
f (w) dw =
N
X
j=1
res (f, Î±j)
n
X
k=1
n (Î³k, Î±j)
and it is this last equation which is established. Near Î±j,
f (z) = gj (z) +
mj
X
r=1
bj
r
(z âˆ’Î±j)r â‰¡gj (z) + Qj (z) .
where gj is analytic at and near Î±j. Now deï¬ne
G (z) â‰¡f (z) âˆ’
N
X
j=1
Qj (z) .
It follows that G (z) has a removable singularity at each Î±j. Therefore, by Corollary
24.47,
0 =
m
X
k=1
Z
Î³k
G (z) dz =
m
X
k=1
Z
Î³k
f (z) dz âˆ’
N
X
j=1
m
X
k=1
Z
Î³k
Qj (z) dz.
Now
m
X
k=1
Z
Î³k
Qj (z) dz
=
m
X
k=1
Z
Î³k
Ãƒ
bj
1
(z âˆ’Î±j) +
mj
X
r=2
bj
r
(z âˆ’Î±j)r
!
dz
=
m
X
k=1
Z
Î³k
bj
1
(z âˆ’Î±j)dz â‰¡
m
X
k=1
n (Î³k, Î±j) res (f, Î±j) (2Ï€i) .
Therefore,
m
X
k=1
Z
Î³k
f (z) dz
=
N
X
j=1
m
X
k=1
Z
Î³k
Qj (z) dz
=
N
X
j=1
m
X
k=1
n (Î³k, Î±j) res (f, Î±j) (2Ï€i)
=
2Ï€i
N
X
j=1
res (f, Î±j)
m
X
k=1
n (Î³k, Î±j)
=
(2Ï€i)
X
Î±âˆˆA
res (f, Î±)
m
X
k=1
n (Î³k, Î±)

707
which proves the theorem.
The following is an important example. This example can also be done by real
variable methods and there are some who think that real variable methods are
always to be preferred to complex variable methods. However, I will use the above
theorem to work this example.
Example 26.4 Find limRâ†’âˆž
R R
âˆ’R
sin(x)
x
dx
Things are easier if you write it as
lim
Râ†’âˆž
1
i
ÃƒZ âˆ’Râˆ’1
âˆ’R
eix
x dx +
Z R
Râˆ’1
eix
x dx
!
.
This gives the same answer because cos (x) /x is odd. Consider the following contour
in which the orientation involves counterclockwise motion exactly once around.
âˆ’R
R
âˆ’Râˆ’1
Râˆ’1
Denote by Î³Râˆ’1 the little circle and Î³R the big one. Then on the inside of this
contour there are no singularities of eiz/z and it is contained in an open set with
the property that the winding number with respect to this contour about any point
not in the open set equals zero. By Theorem 24.22
1
i
ÃƒZ âˆ’Râˆ’1
âˆ’R
eix
x dx +
Z
Î³Râˆ’1
eiz
z dz +
Z R
Râˆ’1
eix
x dx +
Z
Î³R
eiz
z dz
!
= 0
(26.2)
Now
Â¯Â¯Â¯Â¯Â¯
Z
Î³R
eiz
z dz
Â¯Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
Z Ï€
0
eR(i cos Î¸âˆ’sin Î¸)idÎ¸
Â¯Â¯Â¯Â¯ â‰¤
Z Ï€
0
eâˆ’R sin Î¸dÎ¸
and this last integral converges to 0 by the dominated convergence theorem. Now
consider the other circle. By the dominated convergence theorem again,
Z
Î³Râˆ’1
eiz
z dz =
Z 0
Ï€
eRâˆ’1(i cos Î¸âˆ’sin Î¸)idÎ¸ â†’âˆ’iÏ€

708
RESIDUES
as R â†’âˆž. Then passing to the limit in 26.2,
lim
Râ†’âˆž
Z R
âˆ’R
sin (x)
x
dx
=
lim
Râ†’âˆž
1
i
ÃƒZ âˆ’Râˆ’1
âˆ’R
eix
x dx +
Z R
Râˆ’1
eix
x dx
!
=
lim
Râ†’âˆž
1
i
Ãƒ
âˆ’
Z
Î³Râˆ’1
eiz
z dz âˆ’
Z
Î³R
eiz
z dz
!
= âˆ’1
i (âˆ’iÏ€) = Ï€.
Example 26.5 Find limRâ†’âˆž
R R
âˆ’R eixt sin x
x dx. Note this is essentially ï¬nding the
inverse Fourier transform of the function, sin (x) /x.
This equals
lim
Râ†’âˆž
Z R
âˆ’R
(cos (xt) + i sin (xt)) sin (x)
x
dx
=
lim
Râ†’âˆž
Z R
âˆ’R
cos (xt) sin (x)
x
dx
=
lim
Râ†’âˆž
Z R
âˆ’R
cos (xt) sin (x)
x
dx
=
lim
Râ†’âˆž
1
2
Z R
âˆ’R
sin (x (t + 1)) + sin (x (1 âˆ’t))
x
dx
Let t Ì¸= 1, âˆ’1. Then changing variables yields
lim
Râ†’âˆž
Ãƒ
1
2
Z R(1+t)
âˆ’R(1+t)
sin (u)
u
du + 1
2
Z R(1âˆ’t)
âˆ’R(1âˆ’t)
sin (u)
u
du
!
.
In case |t| < 1 Example 26.4 implies this limit is Ï€. However, if t > 1 the limit
equals 0 and this is also the case if t < âˆ’1. Summarizing,
lim
Râ†’âˆž
Z R
âˆ’R
eixt sin x
x
dx =
Â½
Ï€ if |t| < 1
0 if |t| > 1
.
26.1
Roucheâ€™s Theorem And The Argument Prin-
ciple
26.1.1
Argument Principle
A simple closed curve is just one which is homeomorphic to the unit circle. The
Jordan Curve theorem states that every simple closed curve in the plane divides
the plane into exactly two connected components, one bounded and the other un-
bounded. This is a very hard theorem to prove. However, in most applications the

26.1.
ROUCHEâ€™S THEOREM AND THE ARGUMENT PRINCIPLE
709
conclusion is obvious. Nevertheless, to avoid using this big topological result and
to attain some extra generality, I will state the following theorem in terms of the
winding number to avoid using it. This theorem is called the argument principle.
First recall that f has a zero of order m at Î± if f (z) = g (z) (z âˆ’Î±)m where g is
an analytic function which is not equal to zero at Î±. This is equivalent to having
f (z) = Pâˆž
k=m ak (z âˆ’Î±)k for z near Î± where am Ì¸= 0. Also recall that f has a pole
of order m at Î± if for z near Î±, f (z) is of the form
f (z) = h (z) +
m
X
k=1
bk
(z âˆ’Î±)k
(26.3)
where bm Ì¸= 0 and h is a function analytic near Î±.
Theorem 26.6 (argument principle) Let f be meromorphic in â„¦. Also suppose Î³âˆ—
is a closed bounded variation curve containing none of the poles or zeros of f with
the property that for all z /âˆˆâ„¦, n (Î³, z) = 0 and for all z âˆˆâ„¦, n (Î³, z) either equals 0
or 1. Now let {p1, Â· Â· Â·, pm} and {z1, Â· Â· Â·, zn} be respectively the poles and zeros for
which the winding number of Î³ about these points equals 1. Let zk be a zero of order
rk and let pk be a pole of order lk. Then
1
2Ï€i
Z
Î³
f â€² (z)
f (z) dz =
n
X
k=1
rk âˆ’
m
X
k=1
lk
Proof: This theorem follows from computing the residues of f â€²/f. It has residues
at poles and zeros. I will do this now. First suppose f has a pole of order p at Î±.
Then f has the form given in 26.3. Therefore,
f â€² (z)
f (z)
=
hâ€² (z) âˆ’Pp
k=1
kbk
(zâˆ’Î±)k+1
h (z) + Pp
k=1
bk
(zâˆ’Î±)k
=
hâ€² (z) (z âˆ’Î±)p âˆ’Ppâˆ’1
k=1 kbk (z âˆ’Î±)âˆ’kâˆ’1+p âˆ’
pbp
(zâˆ’Î±)
h (z) (z âˆ’Î±)p + Ppâˆ’1
k=1 bk (z âˆ’Î±)pâˆ’k + bp
This is of the form
=
bp
s (z) + bp
r (z) âˆ’
pbp
(zâˆ’Î±)
bp
=
bp
s (z) + bp
Âµr (z)
bp
âˆ’
p
(z âˆ’Î±)
Â¶
where s (Î±) = r (Î±) = 0. From this, it is clear res (f â€²/f, Î±) = âˆ’p, the order of the
pole.
Next suppose f has a zero of order p at Î±. Then
f â€² (z)
f (z) =
Pâˆž
k=p akk (z âˆ’Î±)kâˆ’1
Pâˆž
k=p ak (z âˆ’Î±)k
=
Pâˆž
k=p akk (z âˆ’Î±)kâˆ’1âˆ’p
Pâˆž
k=p ak (z âˆ’Î±)kâˆ’p
and from this it is clear res (f â€²/f) = p, the order of the zero. The conclusion of this
theorem now follows from Theorem 26.3.

710
RESIDUES
One can also generalize the theorem to the case where there are many closed
curves involved. This is proved in the same way as the above.
Theorem 26.7 (argument principle) Let f be meromorphic in â„¦and let Î³k :
[ak, bk] â†’â„¦, k = 1, Â· Â· Â·, m, be closed, continuous and of bounded variation. Suppose
also that
m
X
k=1
n (Î³k, z) = 0
and for all z /âˆˆâ„¦and for z âˆˆâ„¦, Pm
k=1 n (Î³k, z) either equals 0 or 1. Now let
{p1, Â· Â· Â·, pm} and {z1, Â· Â· Â·, zn} be respectively the poles and zeros for which the above
sum of winding numbers equals 1. Let zk be a zero of order rk and let pk be a pole
of order lk. Then
1
2Ï€i
Z
Î³
f â€² (z)
f (z) dz =
n
X
k=1
rk âˆ’
m
X
k=1
lk
There is also a simple extension of this important principle which I found in
[27].
Theorem 26.8 (argument principle) Let f be meromorphic in â„¦. Also suppose Î³âˆ—
is a closed bounded variation curve with the property that for all z /âˆˆâ„¦, n (Î³, z) = 0
and for all z âˆˆâ„¦, n (Î³, z) either equals 0 or 1. Now let {p1, Â· Â· Â·, pm} and {z1, Â· Â· Â·, zn}
be respectively the poles and zeros for which the winding number of Î³ about these
points equals 1 listed according to multiplicity. Thus if there is a pole of order m
there will be this value repeated m times in the list for the poles. Also let g (z) be
an analytic function. Then
1
2Ï€i
Z
Î³
g (z) f â€² (z)
f (z) dz =
n
X
k=1
g (zk) âˆ’
m
X
k=1
g (pk)
Proof: This theorem follows from computing the residues of g (f â€²/f) . It has
residues at poles and zeros. I will do this now. First suppose f has a pole of order
m at Î±. Then f has the form given in 26.3. Therefore,
g (z) f â€² (z)
f (z)
=
g (z)
Â³
hâ€² (z) âˆ’Pm
k=1
kbk
(zâˆ’Î±)k+1
Â´
h (z) + Pm
k=1
bk
(zâˆ’Î±)k
=
g (z)
hâ€² (z) (z âˆ’Î±)m âˆ’Pmâˆ’1
k=1 kbk (z âˆ’Î±)âˆ’kâˆ’1+m âˆ’
mbm
(zâˆ’Î±)
h (z) (z âˆ’Î±)m + Pmâˆ’1
k=1 bk (z âˆ’Î±)mâˆ’k + bm
From this, it is clear res (g (f â€²/f) , Î±) = âˆ’mg (Î±) , where m is the order of the pole.
Thus Î± would have been listed m times in the list of poles. Hence the residue at
this point is equivalent to adding âˆ’g (Î±) m times.

26.1.
ROUCHEâ€™S THEOREM AND THE ARGUMENT PRINCIPLE
711
Next suppose f has a zero of order m at Î±. Then
g (z) f â€² (z)
f (z) = g (z)
Pâˆž
k=m akk (z âˆ’Î±)kâˆ’1
Pâˆž
k=m ak (z âˆ’Î±)k
= g (z)
Pâˆž
k=m akk (z âˆ’Î±)kâˆ’1âˆ’m
Pâˆž
k=m ak (z âˆ’Î±)kâˆ’m
and from this it is clear res (g (f â€²/f)) = g (Î±) m, where m is the order of the zero.
The conclusion of this theorem now follows from the residue theorem, Theorem
26.3.
The way people usually apply these theorems is to suppose Î³âˆ—is a simple closed
bounded variation curve, often a circle. Thus it has an inside and an outside, the
outside being the unbounded component of C\Î³âˆ—. The orientation of the curve is
such that you go around it once in the counterclockwise direction. Then letting rk
and lk be as described, the conclusion of the theorem follows. In applications, this
is likely the way it will be.
26.1.2
Roucheâ€™s Theorem
With the argument principle, it is possible to prove Roucheâ€™s theorem . In the
argument principle, denote by Zf the quantity Pm
k=1 rk and by Pf the quantity
Pn
k=1 lk. Thus Zf is the number of zeros of f counted according to the order of the
zero with a similar deï¬nition holding for Pf. Thus the conclusion of the argument
principle is.
1
2Ï€i
Z
Î³
f â€² (z)
f (z) dz = Zf âˆ’Pf
Roucheâ€™s theorem allows the comparison of Zh âˆ’Ph for h = f, g. It is a wonderful
and amazing result.
Theorem 26.9 (Roucheâ€™s theorem)Let f, g be meromorphic in an open set â„¦. Also
suppose Î³âˆ—is a closed bounded variation curve with the property that for all z /âˆˆ
â„¦, n (Î³, z) = 0, no zeros or poles are on Î³âˆ—, and for all z âˆˆâ„¦, n (Î³, z) either equals 0
or 1. Let Zf and Pf denote respectively the numbers of zeros and poles of f, which
have the property that the winding number equals 1, counted according to order, with
Zg and Pg being deï¬ned similarly. Also suppose that for z âˆˆÎ³âˆ—
|f (z) + g (z)| < |f (z)| + |g (z)| .
(26.4)
Then
Zf âˆ’Pf = Zg âˆ’Pg.
Proof: From the hypotheses,
Â¯Â¯Â¯Â¯1 + f (z)
g (z)
Â¯Â¯Â¯Â¯ < 1 +
Â¯Â¯Â¯Â¯
f (z)
g (z)
Â¯Â¯Â¯Â¯
which shows that for all z âˆˆÎ³âˆ—,
f (z)
g (z) âˆˆC \ [0, âˆž).

712
RESIDUES
Letting l denote a branch of the logarithm deï¬ned on C \ [0, âˆž), it follows that
l
Â³
f(z)
g(z)
Â´
is a primitive for the function,
(f/g)â€²
(f/g) = f â€²
f âˆ’gâ€²
g .
Therefore, by the argument principle,
0
=
1
2Ï€i
Z
Î³
(f/g)â€²
(f/g) dz =
1
2Ï€i
Z
Î³
Âµf â€²
f âˆ’gâ€²
g
Â¶
dz
=
Zf âˆ’Pf âˆ’(Zg âˆ’Pg) .
This proves the theorem.
Often another condition other than 26.4 is used.
Corollary 26.10 In the situation of Theorem 26.9 change 26.4 to the condition,
|f (z) âˆ’g (z)| < |f (z)|
for z âˆˆÎ³âˆ—. Then the conclusion is the same.
Proof: The new condition implies
Â¯Â¯Â¯1 âˆ’g
f (z)
Â¯Â¯Â¯ <
Â¯Â¯Â¯ g(z)
f(z)
Â¯Â¯Â¯ on Î³âˆ—. Therefore, g(z)
f(z) /âˆˆ
(âˆ’âˆž, 0] and so you can do the same argument with a branch of the logarithm.
26.1.3
A Diï¬€erent Formulation
In [47] I found this modiï¬cation for Roucheâ€™s theorem concerned with the counting
of zeros of analytic functions. This is a very useful form of Roucheâ€™s theorem because
it makes no mention of a contour.
Theorem 26.11 Let â„¦be a bounded open set and suppose f, g are continuous on â„¦
and analytic on â„¦. Also suppose |f (z)| < |g (z)| on âˆ‚â„¦. Then g and f + g have the
same number of zeros in â„¦provided each zero is counted according to multiplicity.
Proof: Let K =
Â©
z âˆˆâ„¦: |f (z)| â‰¥|g (z)|
Âª
. Then letting Î» âˆˆ[0, 1] , if z /âˆˆK,
then |f (z)| < |g (z)| and so
0 < |g (z)| âˆ’|f (z)| â‰¤|g (z)| âˆ’Î» |f (z)| â‰¤|g (z) + Î»f (z)|
which shows that all zeros of g + Î»f are contained in K which must be a compact
subset of â„¦due to the assumption that |f (z)| < |g (z)| on âˆ‚â„¦. By Theorem 24.52 on
Page 675 there exists a cycle, {Î³k}n
k=1 such that âˆªn
k=1Î³âˆ—
k âŠ†â„¦\K, Pn
k=1 n (Î³k, z) = 1
for every z âˆˆK and Pn
k=1 n (Î³k, z) = 0 for all z /âˆˆâ„¦. Then as above, it follows
from the residue theorem or more directly, Theorem 26.7,
n
X
k=1
1
2Ï€i
Z
Î³k
Î»f â€² (z) + gâ€² (z)
Î»f (z) + g (z) dz =
p
X
j=1
mj

26.2.
SINGULARITIES AND THE LAURENT SERIES
713
where mj is the order of the jth zero of Î»f + g in K, hence in â„¦. However,
Î» â†’
n
X
k=1
1
2Ï€i
Z
Î³k
Î»f â€² (z) + gâ€² (z)
Î»f (z) + g (z) dz
is integer valued and continuous so it gives the same value when Î» = 0 as when
Î» = 1. When Î» = 0 this gives the number of zeros of g in â„¦and when Î» = 1 it is
the number of zeros of f + g. This proves the theorem.
Here is another formulation of this theorem.
Corollary 26.12 Let â„¦be a bounded open set and suppose f, g are continuous on
â„¦and analytic on â„¦. Also suppose |f (z) âˆ’g (z)| < |g (z)| on âˆ‚â„¦. Then f and
g have the same number of zeros in â„¦provided each zero is counted according to
multiplicity.
Proof: You let f âˆ’g play the role of f in Theorem 26.11. Thus f âˆ’g + g = f
and g have the same number of zeros. Alternatively, you can give a proof of this
directly as follows.
Let K = {z âˆˆâ„¦: |f (z) âˆ’g (z)| â‰¥|g (z)|} . Then if g (z) + Î» (f (z) âˆ’g (z)) = 0
it follows
0
=
|g (z) + Î» (f (z) âˆ’g (z))| â‰¥|g (z)| âˆ’Î» |f (z) âˆ’g (z)|
â‰¥
|g (z)| âˆ’|f (z) âˆ’g (z)|
and so z âˆˆK. Thus all zeros of g (z) + Î» (f (z) âˆ’g (z)) are contained in K. By
Theorem 24.52 on Page 675 there exists a cycle, {Î³k}n
k=1 such that âˆªn
k=1Î³âˆ—
k âŠ†
â„¦\ K, Pn
k=1 n (Î³k, z) = 1 for every z âˆˆK and Pn
k=1 n (Î³k, z) = 0 for all z /âˆˆâ„¦.
Then by Theorem 26.7,
n
X
k=1
1
2Ï€i
Z
Î³k
Î» (f â€² (z) âˆ’gâ€² (z)) + gâ€² (z)
Î» (f (z) âˆ’g (z)) + g (z) dz =
p
X
j=1
mj
where mj is the order of the jth zero of Î» (f âˆ’g) + g in K, hence in â„¦. The left
side is continuous as a function of Î» and so the number of zeros of g corresponding
to Î» = 0 equals the number of zeros of f corresponding to Î» = 1. This proves the
corollary.
26.2
Singularities And The Laurent Series
26.2.1
What Is An Annulus?
In general, when you consider singularities, isolated or not, the fundamental tool
is the Laurent series.
This series is important for many other reasons also.
In
particular, it is fundamental to the spectral theory of various operators in functional
analysis and is one way to obtain relationships between algebraic and analytical

714
RESIDUES
conditions essential in various convergence theorems. A Laurent series lives on an
annulus. In all this f has values in X where X is a complex Banach space. If you
like, let X = C.
Deï¬nition 26.13 Deï¬ne ann (a, R1, R2) â‰¡{z : R1 < |z âˆ’a| < R2} .
Thus ann (a, 0, R) would denote the punctured ball, B (a, R) \ {0} and when
R1 > 0, the annulus looks like the following.
r a
The annulus is the stuï¬€between the two circles.
Here is an important lemma which is concerned with the situation described in
the following picture.
q a
qz
q a
qz
Lemma 26.14 Let Î³r (t) â‰¡a + reit for t âˆˆ[0, 2Ï€] and let |z âˆ’a| < r. Then
n (Î³r, z) = 1. If |z âˆ’a| > r, then n (Î³r, z) = 0.
Proof: For the ï¬rst claim, consider for t âˆˆ[0, 1] ,
f (t) â‰¡n (Î³r, a + t (z âˆ’a)) .
Then from properties of the winding number derived earlier, f (t) âˆˆZ, f is continu-
ous, and f (0) = 1. Therefore, f (t) = 1 for all t âˆˆ[0, 1] . This proves the ï¬rst claim
because f (1) = n (Î³r, z) .
For the second claim,
n (Î³r, z)
=
1
2Ï€i
Z
Î³r
1
w âˆ’z dw
=
1
2Ï€i
Z
Î³r
1
w âˆ’a âˆ’(z âˆ’a)dw
=
1
2Ï€i
âˆ’1
z âˆ’a
Z
Î³r
1
1 âˆ’
Â³
wâˆ’a
zâˆ’a
Â´dw
=
âˆ’1
2Ï€i (z âˆ’a)
Z
Î³r
âˆž
X
k=0
Âµw âˆ’a
z âˆ’a
Â¶k
dw.

26.2.
SINGULARITIES AND THE LAURENT SERIES
715
The series converges uniformly for w âˆˆÎ³r because
Â¯Â¯Â¯Â¯
w âˆ’a
z âˆ’a
Â¯Â¯Â¯Â¯ =
r
r + c
for some c > 0 due to the assumption that |z âˆ’a| > r. Therefore, the sum and the
integral can be interchanged to give
n (Î³r, z) =
âˆ’1
2Ï€i (z âˆ’a)
âˆž
X
k=0
Z
Î³r
Âµw âˆ’a
z âˆ’a
Â¶k
dw = 0
because w â†’
Â³
wâˆ’a
zâˆ’a
Â´k
has an antiderivative. This proves the lemma.
Now consider the following picture which pertains to the next lemma.
Î³r
r a
Lemma 26.15 Let g be analytic on ann (a, R1, R2) . Then if Î³r (t) â‰¡a + reit for
t âˆˆ[0, 2Ï€] and r âˆˆ(R1, R2) , then
R
Î³r g (z) dz is independent of r.
Proof: Let R1 < r1 < r2 < R2 and denote by âˆ’Î³r (t) the curve, âˆ’Î³r (t) â‰¡
a + rei(2Ï€âˆ’t) for t âˆˆ[0, 2Ï€] . Then if z âˆˆB (a, R1), Lemma 26.14 implies both
n
Â¡
Î³r2, z
Â¢
and n
Â¡
Î³r1, z
Â¢
= 1 and so
n
Â¡
âˆ’Î³r1, z
Â¢
+ n
Â¡
Î³r2, z
Â¢
= âˆ’1 + 1 = 0.
Also if z /âˆˆB (a, R2) , then Lemma 26.14 implies n
Â³
Î³rj, z
Â´
= 0 for j = 1, 2.
Therefore, whenever z /âˆˆann (a, R1, R2) , the sum of the winding numbers equals
zero. Therefore, by Theorem 24.46 applied to the function, f (w) = g (z) (w âˆ’z)
and z âˆˆann (a, R1, R2) \ âˆª2
j=1Î³rj ([0, 2Ï€]) ,
f (z)
Â¡
n
Â¡
Î³r2, z
Â¢
+ n
Â¡
âˆ’Î³r1, z
Â¢Â¢
= 0
Â¡
n
Â¡
Î³r2, z
Â¢
+ n
Â¡
âˆ’Î³r1, z
Â¢Â¢
=
1
2Ï€i
Z
Î³r2
g (w) (w âˆ’z)
w âˆ’z
dw âˆ’
1
2Ï€i
Z
Î³r1
g (w) (w âˆ’z)
w âˆ’z
dw
=
1
2Ï€i
Z
Î³r2
g (w) dw âˆ’
1
2Ï€i
Z
Î³r1
g (w) dw
which proves the desired result.

716
RESIDUES
26.2.2
The Laurent Series
The Laurent series is like a power series except it allows for negative exponents.
First here is a deï¬nition of what is meant by the convergence of such a series.
Deï¬nition 26.16 Pâˆž
n=âˆ’âˆžan (z âˆ’a)n converges if both the series,
âˆž
X
n=0
an (z âˆ’a)n and
âˆž
X
n=1
aâˆ’n (z âˆ’a)âˆ’n
converge. When this is the case, the symbol, Pâˆž
n=âˆ’âˆžan (z âˆ’a)n is deï¬ned as
âˆž
X
n=0
an (z âˆ’a)n +
âˆž
X
n=1
aâˆ’n (z âˆ’a)âˆ’n .
Lemma 26.17 Suppose
f (z) =
âˆž
X
n=âˆ’âˆž
an (z âˆ’a)n
for all |z âˆ’a| âˆˆ(R1, R2) . Then both Pâˆž
n=0 an (z âˆ’a)n and Pâˆž
n=1 aâˆ’n (z âˆ’a)âˆ’n
converge absolutely and uniformly on {z : r1 â‰¤|z âˆ’a| â‰¤r2} for any r1 < r2 satis-
fying R1 < r1 < r2 < R2.
Proof: Let R1 < |w âˆ’a| = r1 âˆ’Î´ < r1. Then Pâˆž
n=1 aâˆ’n (w âˆ’a)âˆ’n converges
and so
lim
nâ†’âˆž|aâˆ’n| |w âˆ’a|âˆ’n = lim
nâ†’âˆž|aâˆ’n| (r1 âˆ’Î´)âˆ’n = 0
which implies that for all n suï¬ƒciently large,
|aâˆ’n| (r1 âˆ’Î´)âˆ’n < 1.
Therefore,
âˆž
X
n=1
|aâˆ’n| |z âˆ’a|âˆ’n =
âˆž
X
n=1
|aâˆ’n| (r1 âˆ’Î´)âˆ’n (r1 âˆ’Î´)n |z âˆ’a|âˆ’n .
Now for |z âˆ’a| â‰¥r1,
|z âˆ’a|âˆ’n â‰¤1
rn
1
and so for all suï¬ƒciently large n
|aâˆ’n| |z âˆ’a|âˆ’n â‰¤(r1 âˆ’Î´)n
rn
1
.
Therefore, by the Weierstrass M test, the series, Pâˆž
n=1 aâˆ’n (z âˆ’a)âˆ’n converges
absolutely and uniformly on the set
{z âˆˆC : |z âˆ’a| â‰¥r1} .

26.2.
SINGULARITIES AND THE LAURENT SERIES
717
Similar reasoning shows the series, Pâˆž
n=0 an (z âˆ’a)n converges uniformly on the set
{z âˆˆC : |z âˆ’a| â‰¤r2} .
This proves the Lemma.
Theorem 26.18 Let f be analytic on ann (a, R1, R2) . Then there exist numbers,
an âˆˆC such that for all z âˆˆann (a, R1, R2) ,
f (z) =
âˆž
X
n=âˆ’âˆž
an (z âˆ’a)n ,
(26.5)
where the series converges absolutely and uniformly on ann (a, r1, r2) whenever R1 <
r1 < r2 < R2. Also
an =
1
2Ï€i
Z
Î³
f (w)
(w âˆ’a)n+1 dw
(26.6)
where Î³ (t) = a + reit, t âˆˆ[0, 2Ï€] for any r âˆˆ(R1, R2) . Furthermore the series is
unique in the sense that if 26.5 holds for z âˆˆann (a, R1, R2) , then an is given in
26.6.
Proof: Let R1 < r1 < r2 < R2 and deï¬ne Î³1 (t) â‰¡a + (r1 âˆ’Îµ) eit and Î³2 (t) â‰¡
a+(r2 + Îµ) eit for t âˆˆ[0, 2Ï€] and Îµ chosen small enough that R1 < r1 âˆ’Îµ < r2 +Îµ <
R2.
q a
zq
Î³1
Î³2
Then using Lemma 26.14, if z /âˆˆann (a, R1, R2) then
n (âˆ’Î³1, z) + n (Î³2, z) = 0
and if z âˆˆann (a, r1, r2) ,
n (âˆ’Î³1, z) + n (Î³2, z) = 1.

718
RESIDUES
Therefore, by Theorem 24.46, for z âˆˆann (a, r1, r2)
f (z)
=
1
2Ï€i
"Z
âˆ’Î³1
f (w)
w âˆ’z dw +
Z
Î³2
f (w)
w âˆ’z dw
#
=
1
2Ï€i
ï£®
ï£°
Z
Î³1
f (w)
(z âˆ’a)
h
1 âˆ’wâˆ’a
zâˆ’a
idw +
Z
Î³2
f (w)
(w âˆ’a)
h
1 âˆ’zâˆ’a
wâˆ’a
idw
ï£¹
ï£»
=
1
2Ï€i
Z
Î³2
f (w)
w âˆ’a
âˆž
X
n=0
Âµ z âˆ’a
w âˆ’a
Â¶n
dw+
1
2Ï€i
Z
Î³1
f (w)
(z âˆ’a)
âˆž
X
n=0
Âµw âˆ’a
z âˆ’a
Â¶n
dw.
(26.7)
From the formula 26.7, it follows that for z âˆˆann (a, r1, r2), the terms in the ï¬rst
sum are bounded by an expression of the form C
Â³
r2
r2+Îµ
Â´n
while those in the second
are bounded by one of the form C
Â³
r1âˆ’Îµ
r1
Â´n
and so by the Weierstrass M test, the
convergence is uniform and so the integrals and the sums in the above formula may
be interchanged and after renaming the variable of summation, this yields
f (z) =
âˆž
X
n=0
Ãƒ
1
2Ï€i
Z
Î³2
f (w)
(w âˆ’a)n+1 dw
!
(z âˆ’a)n +
âˆ’1
X
n=âˆ’âˆž
Ãƒ
1
2Ï€i
Z
Î³1
f (w)
(w âˆ’a)n+1
!
(z âˆ’a)n .
(26.8)
Therefore, by Lemma 26.15, for any r âˆˆ(R1, R2) ,
f (z) =
âˆž
X
n=0
Ãƒ
1
2Ï€i
Z
Î³r
f (w)
(w âˆ’a)n+1 dw
!
(z âˆ’a)n +
âˆ’1
X
n=âˆ’âˆž
Ãƒ
1
2Ï€i
Z
Î³r
f (w)
(w âˆ’a)n+1
!
(z âˆ’a)n .
(26.9)
and so
f (z) =
âˆž
X
n=âˆ’âˆž
Ãƒ
1
2Ï€i
Z
Î³r
f (w)
(w âˆ’a)n+1 dw
!
(z âˆ’a)n .
where r âˆˆ(R1, R2) is arbitrary. This proves the existence part of the theorem. It
remains to characterize an.
If f (z) = Pâˆž
n=âˆ’âˆžan (z âˆ’a)n on ann (a, R1, R2) let
fn (z) â‰¡
n
X
k=âˆ’n
ak (z âˆ’a)k .
(26.10)

26.2.
SINGULARITIES AND THE LAURENT SERIES
719
This function is analytic in ann (a, R1, R2) and so from the above argument,
fn (z) =
âˆž
X
k=âˆ’âˆž
Ãƒ
1
2Ï€i
Z
Î³r
fn (w)
(w âˆ’a)k+1 dw
!
(z âˆ’a)k .
(26.11)
Also if k > n or if k < âˆ’n,
Ãƒ
1
2Ï€i
Z
Î³r
fn (w)
(w âˆ’a)k+1 dw
!
= 0.
and so
fn (z) =
n
X
k=âˆ’n
Ãƒ
1
2Ï€i
Z
Î³r
fn (w)
(w âˆ’a)k+1 dw
!
(z âˆ’a)k
which implies from 26.10 that for each k âˆˆ[âˆ’n, n] ,
1
2Ï€i
Z
Î³r
fn (w)
(w âˆ’a)k+1 dw = ak
However, from the uniform convergence of the series,
âˆž
X
n=0
an (w âˆ’a)n
and
âˆž
X
n=1
aâˆ’n (w âˆ’a)âˆ’n
ensured by Lemma 26.17 which allows the interchange of sums and integrals, if
k âˆˆ[âˆ’n, n] ,
1
2Ï€i
Z
Î³r
f (w)
(w âˆ’a)k+1 dw
=
1
2Ï€i
Z
Î³r
Pâˆž
m=0 am (w âˆ’a)m + Pâˆž
m=1 aâˆ’m (w âˆ’a)âˆ’m
(w âˆ’a)k+1
dw
=
âˆž
X
m=0
am
1
2Ï€i
Z
Î³r
(w âˆ’a)mâˆ’(k+1) dw
+
âˆž
X
m=1
aâˆ’m
Z
Î³r
(w âˆ’a)âˆ’mâˆ’(k+1) dw
=
n
X
m=0
am
1
2Ï€i
Z
Î³r
(w âˆ’a)mâˆ’(k+1) dw
+
n
X
m=1
aâˆ’m
Z
Î³r
(w âˆ’a)âˆ’mâˆ’(k+1) dw
=
1
2Ï€i
Z
Î³r
fn (w)
(w âˆ’a)k+1 dw

720
RESIDUES
because if l > n or l < âˆ’n,
Z
Î³r
al (w âˆ’a)l
(w âˆ’a)k+1 dw = 0
for all k âˆˆ[âˆ’n, n] . Therefore,
ak =
1
2Ï€i
Z
Î³r
f (w)
(w âˆ’a)k+1 dw
and so this establishes uniqueness. This proves the theorem.
26.2.3
Contour Integrals And Evaluation Of Integrals
Here are some examples of hard integrals which can be evaluated by using residues.
This will be done by integrating over various closed curves having bounded variation.
Example 26.19 The ï¬rst example we consider is the following integral.
Z âˆž
âˆ’âˆž
1
1 + x4 dx
One could imagine evaluating this integral by the method of partial fractions
and it should work out by that method. However, we will consider the evaluation
of this integral by the method of residues instead. To do so, consider the following
picture.
x
y
Let Î³r (t) = reit, t âˆˆ[0, Ï€] and let Ïƒr (t) = t : t âˆˆ[âˆ’r, r] . Thus Î³r parameterizes
the top curve and Ïƒr parameterizes the straight line from âˆ’r to r along the x
axis. Denoting by Î“r the closed curve traced out by these two, we see from simple
estimates that
lim
râ†’âˆž
Z
Î³r
1
1 + z4 dz = 0.

26.2.
SINGULARITIES AND THE LAURENT SERIES
721
This follows from the following estimate.
Â¯Â¯Â¯Â¯Â¯
Z
Î³r
1
1 + z4 dz
Â¯Â¯Â¯Â¯Â¯ â‰¤
1
r4 âˆ’1Ï€r.
Therefore,
Z âˆž
âˆ’âˆž
1
1 + x4 dx = lim
râ†’âˆž
Z
Î“r
1
1 + z4 dz.
We compute
R
Î“r
1
1+z4 dz using the method of residues.
The only residues of the
integrand are located at points, z where 1 + z4 = 0. These points are
z
=
âˆ’1
2
âˆš
2 âˆ’1
2i
âˆš
2, z = 1
2
âˆš
2 âˆ’1
2i
âˆš
2,
z
=
1
2
âˆš
2 + 1
2i
âˆš
2, z = âˆ’1
2
âˆš
2 + 1
2i
âˆš
2
and it is only the last two which are found in the inside of Î“r. Therefore, we need
to calculate the residues at these points. Clearly this function has a pole of order
one at each of these points and so we may calculate the residue at Î± in this list by
evaluating
lim
zâ†’Î± (z âˆ’Î±)
1
1 + z4
Thus
Res
Âµ
f, 1
2
âˆš
2 + 1
2i
âˆš
2
Â¶
=
lim
zâ†’1
2
âˆš
2+ 1
2 i
âˆš
2
Âµ
z âˆ’
Âµ1
2
âˆš
2 + 1
2i
âˆš
2
Â¶Â¶
1
1 + z4
=
âˆ’1
8
âˆš
2 âˆ’1
8i
âˆš
2
Similarly we may ï¬nd the other residue in the same way
Res
Âµ
f, âˆ’1
2
âˆš
2 + 1
2i
âˆš
2
Â¶
=
lim
zâ†’âˆ’1
2
âˆš
2+ 1
2 i
âˆš
2
Âµ
z âˆ’
Âµ
âˆ’1
2
âˆš
2 + 1
2i
âˆš
2
Â¶Â¶
1
1 + z4
=
âˆ’1
8i
âˆš
2 + 1
8
âˆš
2.
Therefore,
Z
Î“r
1
1 + z4 dz
=
2Ï€i
Âµ
âˆ’1
8i
âˆš
2 + 1
8
âˆš
2 +
Âµ
âˆ’1
8
âˆš
2 âˆ’1
8i
âˆš
2
Â¶Â¶
=
1
2Ï€
âˆš
2.

722
RESIDUES
Thus, taking the limit we obtain 1
2Ï€
âˆš
2 =
R âˆž
âˆ’âˆž
1
1+x4 dx.
Obviously many diï¬€erent variations of this are possible. The main idea being
that the integral over the semicircle converges to zero as r â†’âˆž.
Sometimes we donâ€™t blow up the curves and take limits. Sometimes the problem
of interest reduces directly to a complex integral over a closed curve. Here is an
example of this.
Example 26.20 The integral is
Z Ï€
0
cos Î¸
2 + cos Î¸dÎ¸
This integrand is even and so it equals
1
2
Z Ï€
âˆ’Ï€
cos Î¸
2 + cos Î¸dÎ¸.
For z on the unit circle, z = eiÎ¸, z =
1
z and therefore, cos Î¸ = 1
2
Â¡
z + 1
z
Â¢
. Thus
dz = ieiÎ¸dÎ¸ and so dÎ¸ =
dz
iz . Note this is proceeding formally to get a complex
integral which reduces to the one of interest. It follows that a complex integral
which reduces to the one desired is
1
2i
Z
Î³
1
2
Â¡
z + 1
z
Â¢
2 + 1
2
Â¡
z + 1
z
Â¢ dz
z = 1
2i
Z
Î³
z2 + 1
z (4z + z2 + 1)dz
where Î³ is the unit circle. Now the integrand has poles of order 1 at those points
where z
Â¡
4z + z2 + 1
Â¢
= 0. These points are
0, âˆ’2 +
âˆš
3, âˆ’2 âˆ’
âˆš
3.
Only the ï¬rst two are inside the unit circle. It is also clear the function has simple
poles at these points. Therefore,
Res (f, 0) = lim
zâ†’0 z
Âµ
z2 + 1
z (4z + z2 + 1)
Â¶
= 1.
Res
Â³
f, âˆ’2 +
âˆš
3
Â´
=
lim
zâ†’âˆ’2+
âˆš
3
Â³
z âˆ’
Â³
âˆ’2 +
âˆš
3
Â´Â´
z2 + 1
z (4z + z2 + 1) = âˆ’2
3
âˆš
3.
It follows
Z Ï€
0
cos Î¸
2 + cos Î¸dÎ¸
=
1
2i
Z
Î³
z2 + 1
z (4z + z2 + 1)dz
=
1
2i2Ï€i
Âµ
1 âˆ’2
3
âˆš
3
Â¶
=
Ï€
Âµ
1 âˆ’2
3
âˆš
3
Â¶
.

26.2.
SINGULARITIES AND THE LAURENT SERIES
723
Other rational functions of the trig functions will work out by this method also.
Sometimes you have to be clever about which version of an analytic function
that reduces to a real function you should use. The following is such an example.
Example 26.21 The integral here is
Z âˆž
0
ln x
1 + x4 dx.
The same curve used in the integral involving sin x
x
earlier will create problems
with the log since the usual version of the log is not deï¬ned on the negative real
axis. This does not need to be of concern however. Simply use another branch of
the logarithm. Leave out the ray from 0 along the negative y axis and use Theorem
25.5 to deï¬ne L (z) on this set. Thus L (z) = ln |z|+i arg1 (z) where arg1 (z) will be
the angle, Î¸, between âˆ’Ï€
2 and 3Ï€
2 such that z = |z| eiÎ¸. Now the only singularities
contained in this curve are
1
2
âˆš
2 + 1
2i
âˆš
2, âˆ’1
2
âˆš
2 + 1
2i
âˆš
2
and the integrand, f has simple poles at these points. Thus using the same proce-
dure as in the other examples,
Res
Âµ
f, 1
2
âˆš
2 + 1
2i
âˆš
2
Â¶
=
1
32
âˆš
2Ï€ âˆ’1
32i
âˆš
2Ï€
and
Res
Âµ
f, âˆ’1
2
âˆš
2 + 1
2i
âˆš
2
Â¶
=
3
32
âˆš
2Ï€ + 3
32i
âˆš
2Ï€.
Consider the integral along the small semicircle of radius r. This reduces to
Z 0
Ï€
ln |r| + it
1 + (reit)4
Â¡
rieitÂ¢
dt
which clearly converges to zero as r â†’0 because r ln r â†’0. Therefore, taking the
limit as r â†’0,
Z
large semicircle
L (z)
1 + z4 dz + lim
râ†’0+
Z âˆ’r
âˆ’R
ln (âˆ’t) + iÏ€
1 + t4
dt+
lim
râ†’0+
Z R
r
ln t
1 + t4 dt = 2Ï€i
Âµ 3
32
âˆš
2Ï€ + 3
32i
âˆš
2Ï€ + 1
32
âˆš
2Ï€ âˆ’1
32i
âˆš
2Ï€
Â¶
.

724
RESIDUES
Observing that
R
large semicircle
L(z)
1+z4 dz â†’0 as R â†’âˆž,
e (R) + 2 lim
râ†’0+
Z R
r
ln t
1 + t4 dt + iÏ€
Z 0
âˆ’âˆž
1
1 + t4 dt =
Âµ
âˆ’1
8 + 1
4i
Â¶
Ï€2âˆš
2
where e (R) â†’0 as R â†’âˆž. From an earlier example this becomes
e (R) + 2 lim
râ†’0+
Z R
r
ln t
1 + t4 dt + iÏ€
Ãƒâˆš
2
4 Ï€
!
=
Âµ
âˆ’1
8 + 1
4i
Â¶
Ï€2âˆš
2.
Now letting r â†’0+ and R â†’âˆž,
2
Z âˆž
0
ln t
1 + t4 dt
=
Âµ
âˆ’1
8 + 1
4i
Â¶
Ï€2âˆš
2 âˆ’iÏ€
Ãƒâˆš
2
4 Ï€
!
=
âˆ’1
8
âˆš
2Ï€2,
and so
Z âˆž
0
ln t
1 + t4 dt = âˆ’1
16
âˆš
2Ï€2,
which is probably not the ï¬rst thing you would thing of. You might try to imagine
how this could be obtained using elementary techniques.
The next example illustrates the use of what is referred to as a branch cut. It
includes many examples.
Example 26.22 Mellin transformations are of the form
Z âˆž
0
f (x) xÎ± dx
x .
Sometimes it is possible to evaluate such a transform in terms of the constant, Î±.
Assume f is an analytic function except at isolated singularities, none of which
are on (0, âˆž) . Also assume that f has the growth conditions,
|f (z)| â‰¤C
|z|b , b > Î±
for all large |z| and assume that
|f (z)| â‰¤Câ€²
|z|b1 , b1 < Î±
for all |z| suï¬ƒciently small. It turns out there exists an explicit formula for this
Mellin transformation under these conditions. Consider the following contour.

26.2.
SINGULARITIES AND THE LAURENT SERIES
725

âˆ’R
-

In this contour the small semicircle in the center has radius Îµ which will converge
to 0. Denote by Î³R the large circular path which starts at the upper edge of the
slot and continues to the lower edge. Denote by Î³Îµ the small semicircular contour
and denote by Î³ÎµR+ the straight part of the contour from 0 to R which provides
the top edge of the slot. Finally denote by Î³ÎµRâˆ’the straight part of the contour
from R to 0 which provides the bottom edge of the slot. The interesting aspect of
this problem is the deï¬nition of f (z) zÎ±âˆ’1. Let
zÎ±âˆ’1 â‰¡e(ln|z|+i arg(z))(Î±âˆ’1) = e(Î±âˆ’1) log(z)
where arg (z) is the angle of z in (0, 2Ï€) . Thus you use a branch of the logarithm
which is deï¬ned on C\(0, âˆž) . Then it is routine to verify from the assumed estimates
that
lim
Râ†’âˆž
Z
Î³R
f (z) zÎ±âˆ’1dz = 0
and
lim
Îµâ†’0+
Z
Î³Îµ
f (z) zÎ±âˆ’1dz = 0.
Also, it is routine to verify
lim
Îµâ†’0+
Z
Î³ÎµR+
f (z) zÎ±âˆ’1dz =
Z R
0
f (x) xÎ±âˆ’1dx
and
lim
Îµâ†’0+
Z
Î³ÎµRâˆ’
f (z) zÎ±âˆ’1dz = âˆ’ei2Ï€(Î±âˆ’1)
Z R
0
f (x) xÎ±âˆ’1dx.

726
RESIDUES
Therefore, letting Î£R denote the sum of the residues of f (z) zÎ±âˆ’1 which are con-
tained in the disk of radius R except for the possible residue at 0,
e (R) +
Â³
1 âˆ’ei2Ï€(Î±âˆ’1)Â´ Z R
0
f (x) xÎ±âˆ’1dx = 2Ï€iÎ£R
where e (R) â†’0 as R â†’âˆž. Now letting R â†’âˆž,
lim
Râ†’âˆž
Z R
0
f (x) xÎ±âˆ’1dx =
2Ï€i
1 âˆ’ei2Ï€(Î±âˆ’1) Î£ = Ï€eâˆ’Ï€iÎ±
sin (Ï€Î±)Î£
where Î£ denotes the sum of all the residues of f (z) zÎ±âˆ’1 except for the residue at
0.
The next example is similar to the one on the Mellin transform. In fact it is
a Mellin transform but is worked out independently of the above to emphasize a
slightly more informal technique related to the contour.
Example 26.23
R âˆž
0
xpâˆ’1
1+x dx, p âˆˆ(0, 1) .
Since the exponent of x in the numerator is larger than âˆ’1. The integral does
converge. However, the techniques of real analysis donâ€™t tell us what it converges
to. The contour to be used is as follows: From (Îµ, 0) to (r, 0) along the x axis and
then from (r, 0) to (r, 0) counter clockwise along the circle of radius r, then from
(r, 0) to (Îµ, 0) along the x axis and from (Îµ, 0) to (Îµ, 0) , clockwise along the circle
of radius Îµ. You should draw a picture of this contour. The interesting thing about
this is that zpâˆ’1 cannot be deï¬ned all the way around 0. Therefore, use a branch of
zpâˆ’1 corresponding to the branch of the logarithm obtained by deleting the positive
x axis. Thus
zpâˆ’1 = e(ln|z|+iA(z))(pâˆ’1)
where z = |z| eiA(z) and A (z) âˆˆ(0, 2Ï€) . Along the integral which goes in the positive
direction on the x axis, let A (z) = 0 while on the one which goes in the negative
direction, take A (z) = 2Ï€. This is the appropriate choice obtained by replacing the
line from (Îµ, 0) to (r, 0) with two lines having a small gap joined by a circle of radius
Îµ and then taking a limit as the gap closes. You should verify that the two integrals
taken along the circles of radius Îµ and r converge to 0 as Îµ â†’0 and as r â†’âˆž.
Therefore, taking the limit,
Z âˆž
0
xpâˆ’1
1 + xdx +
Z 0
âˆž
xpâˆ’1
1 + x
Â³
e2Ï€i(pâˆ’1)Â´
dx = 2Ï€i Res (f, âˆ’1) .
Calculating the residue of the integrand at âˆ’1, and simplifying the above expression,
Â³
1 âˆ’e2Ï€i(pâˆ’1)Â´ Z âˆž
0
xpâˆ’1
1 + xdx = 2Ï€ie(pâˆ’1)iÏ€.
Upon simpliï¬cation
Z âˆž
0
xpâˆ’1
1 + xdx =
Ï€
sin pÏ€ .

26.2.
SINGULARITIES AND THE LAURENT SERIES
727
Example 26.24 The Fresnel integrals are
Z âˆž
0
cos
Â¡
x2Â¢
dx,
Z âˆž
0
sin
Â¡
x2Â¢
dx.
To evaluate these integrals consider f (z) = eiz2 on the curve which goes from
the origin to the point r on the x axis and from this point to the point r
Â³
1+i
âˆš
2
Â´
along a circle of radius r, and from there back to the origin as illustrated in the
following picture.
x
y
@
Â¡
Thus the curve to integrate over is shaped like a slice of pie. Denote by Î³r the
curved part. Since f is analytic,
0
=
Z
Î³r
eiz2dz +
Z r
0
eix2dx âˆ’
Z r
0
e
i
Â³
t
Â³
1+i
âˆš
2
Â´Â´2 Âµ1 + i
âˆš
2
Â¶
dt
=
Z
Î³r
eiz2dz +
Z r
0
eix2dx âˆ’
Z r
0
eâˆ’t2 Âµ1 + i
âˆš
2
Â¶
dt
=
Z
Î³r
eiz2dz +
Z r
0
eix2dx âˆ’
âˆšÏ€
2
Âµ1 + i
âˆš
2
Â¶
+ e (r)
where e (r) â†’0 as r â†’âˆž. Here we used the fact that
R âˆž
0
eâˆ’t2dt =
âˆšÏ€
2 . Now
consider the ï¬rst of these integrals.
Â¯Â¯Â¯Â¯Â¯
Z
Î³r
eiz2dz
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
Z
Ï€
4
0
ei(reit)
2
rieitdt
Â¯Â¯Â¯Â¯Â¯
â‰¤
r
Z
Ï€
4
0
eâˆ’r2 sin 2tdt
=
r
2
Z 1
0
eâˆ’r2u
âˆš
1 âˆ’u2 du
â‰¤r
2
Z râˆ’(3/2)
0
1
âˆš
1 âˆ’u2 du + r
2
ÂµZ 1
0
1
âˆš
1 âˆ’u2
Â¶
eâˆ’(r1/2)

728
RESIDUES
which converges to zero as r â†’âˆž. Therefore, taking the limit as r â†’âˆž,
âˆšÏ€
2
Âµ1 + i
âˆš
2
Â¶
=
Z âˆž
0
eix2dx
and so
Z âˆž
0
sin x2dx =
âˆšÏ€
2
âˆš
2 =
Z âˆž
0
cos x2dx.
The following example is one of the most interesting. By an auspicious choice
of the contour it is possible to obtain a very interesting formula for cot Ï€z known
as the Mittag- Leï¬„er expansion of cot Ï€z.
Example 26.25 Let Î³N be the contour which goes from âˆ’N âˆ’1
2 âˆ’Ni horizontally
to N + 1
2 âˆ’Ni and from there, vertically to N + 1
2 + Ni and then horizontally
to âˆ’N âˆ’1
2 + Ni
and ï¬nally vertically to âˆ’N âˆ’1
2 âˆ’Ni. Thus the contour is a
large rectangle and the direction of integration is in the counter clockwise direction.
Consider the following integral.
IN â‰¡
Z
Î³N
Ï€ cos Ï€z
sin Ï€z (Î±2 âˆ’z2)dz
where Î± âˆˆR is not an integer. This will be used to verify the formula of Mittag
Leï¬„er,
1
Î±2 +
âˆž
X
n=1
2
Î±2 âˆ’n2 = Ï€ cot Ï€Î±
Î±
.
(26.12)
You should verify that cot Ï€z is bounded on this contour and that therefore,
IN â†’0 as N â†’âˆž. Now you compute the residues of the integrand at Â±Î± and
at n where |n| < N + 1
2 for n an integer. These are the only singularities of the
integrand in this contour and therefore, you can evaluate IN by using these. It is
left as an exercise to calculate these residues and ï¬nd that the residue at Â±Î± is
âˆ’Ï€ cos Ï€Î±
2Î± sin Ï€Î±
while the residue at n is
1
Î±2 âˆ’n2 .
Therefore,
0 = lim
Nâ†’âˆžIN = lim
Nâ†’âˆž2Ï€i
"
N
X
n=âˆ’N
1
Î±2 âˆ’n2 âˆ’Ï€ cot Ï€Î±
Î±
#
which establishes the following formula of Mittag Leï¬„er.
lim
Nâ†’âˆž
N
X
n=âˆ’N
1
Î±2 âˆ’n2 = Ï€ cot Ï€Î±
Î±
.
Writing this in a slightly nicer form, yields 26.12.

26.3. THE SPECTRAL RADIUS OF A BOUNDED LINEAR TRANSFORMATION729
26.3
The Spectral Radius Of A Bounded Linear
Transformation
As a very important application of the theory of Laurent series, I will give a short
description of the spectral radius.
This is a fundamental result which must be
understood in order to prove convergence of various important numerical methods
such as the Gauss Seidel or Jacobi methods.
Deï¬nition 26.26 Let X be a complex Banach space and let A âˆˆL (X, X) . Then
r (A) â‰¡
n
Î» âˆˆC : (Î»I âˆ’A)âˆ’1 âˆˆL (X, X)
o
This is called the resolvent set. The spectrum of A, denoted by Ïƒ (A) is deï¬ned as
all the complex numbers which are not in the resolvent set. Thus
Ïƒ (A) â‰¡C \ r (A)
Lemma 26.27 Î» âˆˆr (A) if and only if Î»I âˆ’A is one to one and onto X. Also if
|Î»| > ||A|| , then Î» âˆˆÏƒ (A). If the Neumann series,
1
Î»
âˆž
X
k=0
ÂµA
Î»
Â¶k
converges, then
1
Î»
âˆž
X
k=0
ÂµA
Î»
Â¶k
= (Î»I âˆ’A)âˆ’1 .
Proof: Note that to be in r (A) , Î»I âˆ’A must be one to one and map X onto
X since otherwise, (Î»I âˆ’A)âˆ’1 /âˆˆL (X, X) .
By the open mapping theorem, if these two algebraic conditions hold, then
(Î»I âˆ’A)âˆ’1 is continuous and so this proves the ï¬rst part of the lemma.
Now
suppose |Î»| > ||A|| . Consider the Neumann series
1
Î»
âˆž
X
k=0
ÂµA
Î»
Â¶k
.
By the root test, Theorem 24.3 on Page 642 this series converges to an element
of L (X, X) denoted here by B. Now suppose the series converges. Letting Bn â‰¡
1
Î»
Pn
k=0
Â¡ A
Î»
Â¢k ,
(Î»I âˆ’A) Bn
=
Bn (Î»I âˆ’A) =
n
X
k=0
ÂµA
Î»
Â¶k
âˆ’
n
X
k=0
ÂµA
Î»
Â¶k+1
=
I âˆ’
ÂµA
Î»
Â¶n+1
â†’I

730
RESIDUES
as n â†’âˆžbecause the convergence of the series requires the nth term to converge
to 0. Therefore,
(Î»I âˆ’A) B = B (Î»I âˆ’A) = I
which shows Î»I âˆ’A is both one to one and onto and the Neumann series converges
to (Î»I âˆ’A)âˆ’1 . This proves the lemma.
This lemma also shows that Ïƒ (A) is bounded. In fact, Ïƒ (A) is closed.
Lemma 26.28 r (A) is open. In fact, if Î» âˆˆr (A) and |Âµ âˆ’Î»| <
Â¯Â¯Â¯
Â¯Â¯Â¯(Î»I âˆ’A)âˆ’1Â¯Â¯Â¯
Â¯Â¯Â¯
âˆ’1
,
then Âµ âˆˆr (A).
Proof: First note
(ÂµI âˆ’A)
=
Â³
I âˆ’(Î» âˆ’Âµ) (Î»I âˆ’A)âˆ’1Â´
(Î»I âˆ’A)
(26.13)
=
(Î»I âˆ’A)
Â³
I âˆ’(Î» âˆ’Âµ) (Î»I âˆ’A)âˆ’1Â´
(26.14)
Also from the assumption about |Î» âˆ’Âµ| ,
Â¯Â¯Â¯
Â¯Â¯Â¯(Î» âˆ’Âµ) (Î»I âˆ’A)âˆ’1Â¯Â¯Â¯
Â¯Â¯Â¯ â‰¤|Î» âˆ’Âµ|
Â¯Â¯Â¯
Â¯Â¯Â¯(Î»I âˆ’A)âˆ’1Â¯Â¯Â¯
Â¯Â¯Â¯ < 1
and so by the root test,
âˆž
X
k=0
Â³
(Î» âˆ’Âµ) (Î»I âˆ’A)âˆ’1Â´k
converges to an element of L (X, X) . As in Lemma 26.27,
âˆž
X
k=0
Â³
(Î» âˆ’Âµ) (Î»I âˆ’A)âˆ’1Â´k
=
Â³
I âˆ’(Î» âˆ’Âµ) (Î»I âˆ’A)âˆ’1Â´âˆ’1
.
Therefore, from 26.13,
(ÂµI âˆ’A)âˆ’1 = (Î»I âˆ’A)âˆ’1 Â³
I âˆ’(Î» âˆ’Âµ) (Î»I âˆ’A)âˆ’1Â´âˆ’1
.
This proves the lemma.
Corollary 26.29 Ïƒ (A) is a compact set.
Proof: Lemma 26.27 shows Ïƒ (A) is bounded and Lemma 26.28 shows it is
closed.
Deï¬nition 26.30 The spectral radius, denoted by Ï (A) is deï¬ned by
Ï (A) â‰¡max {|Î»| : Î» âˆˆÏƒ (A)} .
Since Ïƒ (A) is compact, this maximum exists. Note from Lemma 26.27, Ï (A) â‰¤
||A||.

26.4.
EXERCISES
731
There is a simple formula for the spectral radius.
Lemma 26.31 If |Î»| > Ï (A) , then the Neumann series,
1
Î»
âˆž
X
k=0
ÂµA
Î»
Â¶k
converges.
Proof: This follows directly from Theorem 26.18 on Page 717 and the obser-
vation above that 1
Î»
Pâˆž
k=0
Â¡ A
Î»
Â¢k = (Î»I âˆ’A)âˆ’1 for all |Î»| > ||A||. Thus the analytic
function, Î» â†’(Î»I âˆ’A)âˆ’1 has a Laurent expansion on |Î»| > Ï (A) by Theorem 26.18
and it must coincide with 1
Î»
Pâˆž
k=0
Â¡ A
Î»
Â¢k on |Î»| > ||A|| so the Laurent expansion of
Î» â†’(Î»I âˆ’A)âˆ’1 must equal 1
Î»
Pâˆž
k=0
Â¡ A
Î»
Â¢k on |Î»| > Ï (A) . This proves the lemma.
The theorem on the spectral radius follows. It is due to Gelfand.
Theorem 26.32 Ï (A) = limnâ†’âˆž||An||1/n.
Proof: If
|Î»| < lim sup
nâ†’âˆž||An||1/n
then by the root test, the Neumann series does not converge and so by Lemma
26.31 |Î»| â‰¤Ï (A) . Thus
Ï (A) â‰¥lim sup
nâ†’âˆž||An||1/n .
Now let p be a positive integer. Then Î» âˆˆÏƒ (A) implies Î»p âˆˆÏƒ (Ap) because
Î»pI âˆ’Ap
=
(Î»I âˆ’A)
Â¡
Î»pâˆ’1 + Î»pâˆ’2A + Â· Â· Â· + Apâˆ’1Â¢
=
Â¡
Î»pâˆ’1 + Î»pâˆ’2A + Â· Â· Â· + Apâˆ’1Â¢
(Î»I âˆ’A)
It follows from Lemma 26.27 applied to Apthat for Î» âˆˆÏƒ (A) , |Î»p| â‰¤||Ap|| and so
|Î»| â‰¤||Ap||1/p . Therefore, Ï (A) â‰¤||Ap||1/p and since p is arbitrary,
lim inf
pâ†’âˆž||Ap||1/p â‰¥Ï (A) â‰¥lim sup
nâ†’âˆž||An||1/n .
This proves the theorem.
26.4
Exercises
1. Example 26.19 found the integral of a rational function of a certain sort. The
technique used in this example typically works for rational functions of the
form
f(x)
g(x) where deg (g (x)) â‰¥deg f (x) + 2 provided the rational function
has no poles on the real axis.
State and prove a theorem based on these
observations.

732
RESIDUES
2. Fill in the missing details of Example 26.25 about IN â†’0. Note how important
it was that the contour was chosen just right for this to happen. Also verify
the claims about the residues.
3. Suppose f has a pole of order m at z = a. Deï¬ne g (z) by
g (z) = (z âˆ’a)m f (z) .
Show
Res (f, a) =
1
(m âˆ’1)!g(mâˆ’1) (a) .
Hint: Use the Laurent series.
4. Give a proof of Theorem 26.6. Hint: Let p be a pole. Show that near p, a
pole of order m,
f â€² (z)
f (z) =
âˆ’m + Pâˆž
k=1 bk (z âˆ’p)k
(z âˆ’p) + Pâˆž
k=2 ck (z âˆ’p)k
Show that Res (f, p) = âˆ’m. Carry out a similar procedure for the zeros.
5. Use Roucheâ€™s theorem to prove the fundamental theorem of algebra which
says that if p (z) = zn + anâˆ’1znâˆ’1 Â· Â· Â· +a1z + a0, then p has n zeros in C.
Hint: Let q (z) = âˆ’zn and let Î³ be a large circle, Î³ (t) = reit for r suï¬ƒciently
large.
6. Consider the two polynomials z5 +3z2 âˆ’1 and z5 +3z2. Show that on |z| = 1,
the conditions for Roucheâ€™s theorem hold. Now use Roucheâ€™s theorem to verify
that z5 + 3z2 âˆ’1 must have two zeros in |z| < 1.
7. Consider the polynomial, z11 + 7z5 + 3z2 âˆ’17. Use Roucheâ€™s theorem to ï¬nd
a bound on the zeros of this polynomial. In other words, ï¬nd r such that if z
is a zero of the polynomial, |z| < r. Try to make r fairly small if possible.
8. Verify that
R âˆž
0
eâˆ’t2dt =
âˆšÏ€
2 . Hint: Use polar coordinates.
9. Use the contour described in Example 26.19 to compute the exact values of
the following improper integrals.
(a)
R âˆž
âˆ’âˆž
x
(x2+4x+13)2 dx
(b)
R âˆž
0
x2
(x2+a2)2 dx
(c)
R âˆž
âˆ’âˆž
dx
(x2+a2)(x2+b2), a, b > 0
10. Evaluate the following improper integrals.
(a)
R âˆž
0
cos ax
(x2+b2)2 dx

26.4.
EXERCISES
733
(b)
R âˆž
0
x sin x
(x2+a2)2 dx
11. Find the Cauchy principle value of the integral
Z âˆž
âˆ’âˆž
sin x
(x2 + 1) (x âˆ’1)dx
deï¬ned as
lim
Îµâ†’0+
ÂµZ 1âˆ’Îµ
âˆ’âˆž
sin x
(x2 + 1) (x âˆ’1)dx +
Z âˆž
1+Îµ
sin x
(x2 + 1) (x âˆ’1)dx
Â¶
.
12. Find a formula for the integral
R âˆž
âˆ’âˆž
dx
(1+x2)n+1 where n is a nonnegative integer.
13. Find
R âˆž
âˆ’âˆž
sin2 x
x2 dx.
14. If m < n for m and n integers, show
Z âˆž
0
x2m
1 + x2n dx = Ï€
2n
1
sin
Â¡ 2m+1
2n Ï€
Â¢.
15. Find
R âˆž
âˆ’âˆž
1
(1+x4)2 dx.
16. Find
R âˆž
0
ln(x)
1+x2 dx = 0.
17. Suppose f has an isolated singularity at Î±. Show the singularity is essential
if and only if the principal part of the Laurent series of f has inï¬nitely many
terms. That is, show f (z) = Pâˆž
k=0 ak (z âˆ’Î±)k+Pâˆž
k=1
bk
(zâˆ’Î±)k where inï¬nitely
many of the bk are nonzero.
18. Suppose â„¦is a bounded open set and fn is analytic on â„¦and continuous on
â„¦. Suppose also that fn â†’f uniformly on â„¦and that f Ì¸= 0 on âˆ‚â„¦. Show
that for all n large enough, fn and f have the same number of zeros on â„¦
provided the zeros are counted according to multiplicity.

734
RESIDUES

Complex Mappings
27.1
Conformal Maps
If Î³ (t) = x (t) + iy (t) is a C1 curve having values in U, an open set of C, and
if f : U â†’C is analytic, consider f â—¦Î³, another C1 curve having values in C.
Also, Î³â€² (t) and (f â—¦Î³)â€² (t) are complex numbers so these can be considered as
vectors in R2 as follows. The complex number, x + iy corresponds to the vector,
(x, y) . Suppose that Î³ and Î· are two such C1 curves having values in U and that
Î³ (t0) = Î· (s0) = z and suppose that f : U â†’C is analytic. What can be said about
the angle between (f â—¦Î³)â€² (t0) and (f â—¦Î·)â€² (s0)? It turns out this angle is the same
as the angle between Î³â€² (t0) and Î·â€² (s0) assuming that f â€² (z) Ì¸= 0. To see this, note
(x, y) Â· (a, b) = 1
2 (zw + zw) where z = x + iy and w = a + ib. Therefore, letting Î¸
be the cosine between the two vectors, (f â—¦Î³)â€² (t0) and (f â—¦Î·)â€² (s0) , it follows from
calculus that
cos Î¸
=
(f â—¦Î³)â€² (t0) Â· (f â—¦Î·)â€² (s0)
Â¯Â¯(f â—¦Î·)â€² (s0)
Â¯Â¯ Â¯Â¯(f â—¦Î³)â€² (t0)
Â¯Â¯
=
1
2
f â€² (Î³ (t0)) Î³â€² (t0) f â€² (Î· (s0))Î·â€² (s0) + f â€² (Î³ (t0)) Î³â€² (t0)f â€² (Î· (s0)) Î·â€² (s0)
|f â€² (Î³ (t0))| |f â€² (Î· (s0))|
=
1
2
f â€² (z) f â€² (z)Î³â€² (t0) Î·â€² (s0) + f â€² (z)f â€² (z) Î³â€² (t0)Î·â€² (s0)
|f â€² (z)| |f â€² (z)|
=
1
2
Î³â€² (t0) Î·â€² (s0) + Î·â€² (s0) Î³â€² (t0)
1
which equals the angle between the vectors, Î³â€² (t0) and Î·â€² (t0) . Thus analytic map-
pings preserve angles at points where the derivative is nonzero. Such mappings are
called isogonal. .
Actually, they also preserve orientations. If z = x + iy and w = a + ib are two
complex numbers, then (x, y, 0) and (a, b, 0) are two vectors in R3. Recall that the
cross product, (x, y, 0) Ã— (a, b, 0) , yields a vector normal to the two given vectors
such that the triple, (x, y, 0) , (a, b, 0) , and (x, y, 0)Ã—(a, b, 0) satisï¬es the right hand
735

736
COMPLEX MAPPINGS
rule and has magnitude equal to the product of the sine of the included angle times
the product of the two norms of the vectors. In this case, the cross product will
produce a vector which is a multiple of k, the unit vector in the direction of the z
axis. In fact, you can verify by computing both sides that, letting z = x + iy and
w = a + ib,
(x, y, 0) Ã— (a, b, 0) = Re (ziw) k.
Therefore, in the above situation,
(f â—¦Î³)â€² (t0) Ã— (f â—¦Î·)â€² (s0)
=
Re
Â³
f â€² (Î³ (t0)) Î³â€² (t0) if â€² (Î· (s0))Î·â€² (s0)
Â´
k
=
|f â€² (z)|2 Re
Â³
Î³â€² (t0) iÎ·â€² (s0)
Â´
k
which shows that the orientation of Î³â€² (t0), Î·â€² (s0) is the same as the orientation of
(f â—¦Î³)â€² (t0) , (f â—¦Î·)â€² (s0). Mappings which preserve both orientation and angles are
called conformal mappings and this has shown that analytic functions are conformal
mappings if the derivative does not vanish.
27.2
Fractional Linear Transformations
27.2.1
Circles And Lines
These mappings map lines and circles to either lines or circles.
Deï¬nition 27.1 A fractional linear transformation is a function of the form
f (z) = az + b
cz + d
(27.1)
where ad âˆ’bc Ì¸= 0.
Note that if c = 0, this reduces to a linear transformation (a/d) z+(b/d) . Special
cases of these are deï¬ned as follows.
dilations: z â†’Î´z, Î´ Ì¸= 0, inversions: z â†’1
z ,
translations: z â†’z + Ï.
The next lemma is the key to understanding fractional linear transformations.
Lemma 27.2 The fractional linear transformation, 27.1 can be written as a ï¬nite
composition of dilations, inversions, and translations.
Proof: Let
S1 (z) = z + d
c , S2 (z) = 1
z , S3 (z) = (bc âˆ’ad)
c2
z

27.2.
FRACTIONAL LINEAR TRANSFORMATIONS
737
and
S4 (z) = z + a
c
in the case where c Ì¸= 0. Then f (z) given in 27.1 is of the form
f (z) = S4 â—¦S3 â—¦S2 â—¦S1.
Here is why.
S2 (S1 (z)) = S2
Âµ
z + d
c
Â¶
â‰¡
1
z + d
c
=
c
zc + d.
Now consider
S3
Âµ
c
zc + d
Â¶
â‰¡(bc âˆ’ad)
c2
Âµ
c
zc + d
Â¶
=
bc âˆ’ad
c (zc + d).
Finally, consider
S4
Âµ bc âˆ’ad
c (zc + d)
Â¶
â‰¡
bc âˆ’ad
c (zc + d) + a
c = b + az
zc + d.
In case that c = 0, f (z) = a
dz + b
d which is a translation composed with a dilation.
Because of the assumption that ad âˆ’bc Ì¸= 0, it follows that since c = 0, both a and
d Ì¸= 0. This proves the lemma.
This lemma implies the following corollary.
Corollary 27.3 Fractional linear transformations map circles and lines to circles
or lines.
Proof: It is obvious that dilations and translations map circles to circles and
lines to lines. What of inversions? If inversions have this property, the above lemma
implies a general fractional linear transformation has this property as well.
Note that all circles and lines may be put in the form
Î±
Â¡
x2 + y2Â¢
âˆ’2ax âˆ’2by = r2 âˆ’
Â¡
a2 + b2Â¢
where Î± = 1 gives a circle centered at (a, b) with radius r and Î± = 0 gives a line. In
terms of complex variables you may therefore consider all possible circles and lines
in the form
Î±zz + Î²z + Î²z + Î³ = 0,
(27.2)
To see this let Î² = Î²1 + iÎ²2 where Î²1 â‰¡âˆ’a and Î²2 â‰¡b. Note that even if Î± is not
0 or 1 the expression still corresponds to either a circle or a line because you can
divide by Î± if Î± Ì¸= 0. Now I verify that replacing z with 1
z results in an expression
of the form in 27.2. Thus, let w = 1
z where z satisï¬es 27.2. Then
Â¡
Î± + Î²w + Î²w + Î³ww
Â¢
= 1
zz
Â¡
Î±zz + Î²z + Î²z + Î³
Â¢
= 0

738
COMPLEX MAPPINGS
and so w also satisï¬es a relation like 27.2. One simply switches Î± with Î³ and Î²
with Î². Note the situation is slightly diï¬€erent than with dilations and translations.
In the case of an inversion, a circle becomes either a line or a circle and similarly, a
line becomes either a circle or a line. This proves the corollary.
The next example is quite important.
Example 27.4 Consider the fractional linear transformation, w = zâˆ’i
z+i.
First consider what this mapping does to the points of the form z = x + i0.
Substituting into the expression for w,
w = x âˆ’i
x + i = x2 âˆ’1 âˆ’2xi
x2 + 1
,
a point on the unit circle. Thus this transformation maps the real axis to the unit
circle.
The upper half plane is composed of points of the form x + iy where y > 0.
Substituting in to the transformation,
w = x + i (y âˆ’1)
x + i (y + 1),
which is seen to be a point on the interior of the unit disk because |y âˆ’1| < |y + 1|
which implies |x + i (y + 1)| > |x + i (y âˆ’1)|. Therefore, this transformation maps
the upper half plane to the interior of the unit disk.
One might wonder whether the mapping is one to one and onto. The mapping
is clearly one to one because it has an inverse, z = âˆ’i w+1
wâˆ’1 for all w in the interior
of the unit disk. Also, a short computation veriï¬es that z so deï¬ned is in the upper
half plane. Therefore, this transformation maps {z âˆˆC such that Im z > 0} one to
one and onto the unit disk {z âˆˆC such that |z| < 1} .
A fancy way to do part of this is to use Theorem 25.11. lim supzâ†’a
Â¯Â¯Â¯ zâˆ’i
z+i
Â¯Â¯Â¯ â‰¤1
whenever a is the real axis or âˆž. Therefore,
Â¯Â¯Â¯ zâˆ’i
z+i
Â¯Â¯Â¯ â‰¤1. This is a little shorter.
27.2.2
Three Points To Three Points
There is a simple procedure for determining fractional linear transformations which
map a given set of three points to another set of three points. The problem is as
follows: There are three distinct points in the extended complex plane, z1, z2, and
z3 and it is desired to ï¬nd a fractional linear transformation such that zi â†’wi
for i = 1, 2, 3 where here w1, w2, and w3 are three distinct points in the extended
complex plane. Then the procedure says that to ï¬nd the desired fractional linear
transformation solve the following equation for w.
w âˆ’w1
w âˆ’w3
Â· w2 âˆ’w3
w2 âˆ’w1
= z âˆ’z1
z âˆ’z3
Â· z2 âˆ’z3
z2 âˆ’z1

27.3.
RIEMANN MAPPING THEOREM
739
The result will be a fractional linear transformation with the desired properties.
If any of the points equals âˆž, then the quotient containing this point should be
adjusted.
Why should this procedure work? Here is a heuristic argument to indicate why
you would expect this to happen rather than a rigorous proof. The reader may
want to tighten the argument to give a proof. First suppose z = z1. Then the right
side equals zero and so the left side also must equal zero. However, this requires
w = w1. Next suppose z = z2. Then the right side equals 1. To get a 1 on the left,
you need w = w2. Finally suppose z = z3. Then the right side involves division by
0. To get the same bad behavior, on the left, you need w = w3.
Example 27.5 Let Im Î¾ > 0 and consider the fractional linear transformation
which takes Î¾ to 0, Î¾ to âˆžand 0 to Î¾/Î¾, .
The equation for w is
w âˆ’0
w âˆ’
Â¡
Î¾/Î¾
Â¢ = z âˆ’Î¾
z âˆ’0 Â· Î¾ âˆ’0
Î¾ âˆ’Î¾
After some computations,
w = z âˆ’Î¾
z âˆ’Î¾ .
Note that this has the property that xâˆ’Î¾
xâˆ’Î¾ is always a point on the unit circle because
it is a complex number divided by its conjugate. Therefore, this fractional linear
transformation maps the real line to the unit circle. It also takes the point, Î¾ to
0 and so it must map the upper half plane to the unit disk. You can verify the
mapping is onto as well.
Example 27.6 Let z1 = 0, z2 = 1, and z3 = 2 and let w1 = 0, w2 = i, and w3 = 2i.
Then the equation to solve is
w
w âˆ’2i Â· âˆ’i
i =
z
z âˆ’2 Â· âˆ’1
1
Solving this yields w = iz which clearly works.
27.3
Riemann Mapping Theorem
From the open mapping theorem analytic functions map regions to other regions or
else to single points. The Riemann mapping theorem states that for every simply
connected region, â„¦which is not equal to all of C there exists an analytic function,
f such that f (â„¦) = B (0, 1) and in addition to this, f is one to one. The proof
involves several ideas which have been developed up to now. The proof is based on
the following important theorem, a case of Montelâ€™s theorem. Before, beginning,
note that the Riemann mapping theorem is a classic example of a major existence

740
COMPLEX MAPPINGS
theorem. In mathematics there are two sorts of questions, those related to whether
something exists and those involving methods for ï¬nding it. The real questions are
often related to questions of existence. There is a long and involved history for
proofs of this theorem. The ï¬rst proofs were based on the Dirichlet principle and
turned out to be incorrect, thanks to Weierstrass who pointed out the errors. For
more on the history of this theorem, see Hille [27].
The following theorem is really wonderful. It is about the existence of a subse-
quence having certain salubrious properties. It is this wonderful result which will
give the existence of the mapping desired. The other parts of the argument are
technical details to set things up and use this theorem.
27.3.1
Montelâ€™s Theorem
Theorem 27.7 Let â„¦be an open set in C and let F denote a set of analytic
functions mapping â„¦to B (0, M) âŠ†C. Then there exists a sequence of functions
from F, {fn}âˆž
n=1 and an analytic function, f such that f (k)
n
converges uniformly to
f (k) on every compact subset of â„¦.
Proof: First note there exists a sequence of compact sets, Kn such that Kn âŠ†
int Kn+1 âŠ†â„¦for all n where here int K denotes the interior of the set K, the
union of all open sets contained in K and âˆªâˆž
n=1Kn = â„¦. In fact, you can verify
that B (0, n) âˆ©
Â©
z âˆˆâ„¦: dist
Â¡
z, â„¦CÂ¢
â‰¤1
n
Âª
works for Kn. Then there exist positive
numbers, Î´n such that if z âˆˆKn, then B (z, Î´n) âŠ†int Kn+1. Now denote by Fn
the set of restrictions of functions of F to Kn. Then let z âˆˆKn and let Î³ (t) â‰¡
z + Î´neit, t âˆˆ[0, 2Ï€] . It follows that for z1 âˆˆB (z, Î´n) , and f âˆˆF,
|f (z) âˆ’f (z1)|
=
Â¯Â¯Â¯Â¯
1
2Ï€i
Z
Î³
f (w)
Âµ
1
w âˆ’z âˆ’
1
w âˆ’z1
Â¶
dw
Â¯Â¯Â¯Â¯
â‰¤
1
2Ï€
Â¯Â¯Â¯Â¯
Z
Î³
f (w)
z âˆ’z1
(w âˆ’z) (w âˆ’z1)dw
Â¯Â¯Â¯Â¯
Letting |z1 âˆ’z| < Î´n
2 ,
|f (z) âˆ’f (z1)|
â‰¤
M
2Ï€ 2Ï€Î´n
|z âˆ’z1|
Î´2
n/2
â‰¤
2M |z âˆ’z1|
Î´n
.
It follows that Fn is equicontinuous and uniformly bounded so by the Arzela Ascoli
theorem there exists a sequence, {fnk}âˆž
k=1 âŠ†F which converges uniformly on Kn.
Let {f1k}âˆž
k=1 converge uniformly on K1. Then use the Arzela Ascoli theorem applied
to this sequence to get a subsequence, denoted by {f2k}âˆž
k=1 which also converges
uniformly on K2. Continue in this way to obtain {fnk}âˆž
k=1 which converges uni-
formly on K1, Â· Â· Â·, Kn. Now the sequence {fnn}âˆž
n=m is a subsequence of {fmk} âˆž
k=1
and so it converges uniformly on Km for all m. Denoting fnn by fn for short, this

27.3.
RIEMANN MAPPING THEOREM
741
is the sequence of functions promised by the theorem. It is clear {fn}âˆž
n=1 converges
uniformly on every compact subset of â„¦because every such set is contained in Km
for all m large enough. Let f (z) be the point to which fn (z) converges. Then f
is a continuous function deï¬ned on â„¦. Is f is analytic? Yes it is by Lemma 24.18.
Alternatively, you could let T âŠ†â„¦be a triangle. Then
Z
âˆ‚T
f (z) dz = lim
nâ†’âˆž
Z
âˆ‚T
fn (z) dz = 0.
Therefore, by Moreraâ€™s theorem, f is analytic.
As for the uniform convergence of the derivatives of f, recall Theorem 24.52
about the existence of a cycle.
Let K be a compact subset of int (Kn) and let
{Î³k}m
k=1 be closed oriented curves contained in
int (Kn) \ K
such that Pm
k=1 n (Î³k, z) = 1 for every z âˆˆK.
Also let Î· denote the distance
between âˆªjÎ³âˆ—
j and K. Then for z âˆˆK,
Â¯Â¯Â¯f (k) (z) âˆ’f (k)
n
(z)
Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯Â¯
k!
2Ï€i
m
X
j=1
Z
Î³j
f (w) âˆ’fn (w)
(w âˆ’z)k+1
dw
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
k!
2Ï€ ||fk âˆ’f||Kn
m
X
j=1
(length of Î³k)
1
Î·k+1 .
where here ||fk âˆ’f||Kn â‰¡sup {|fk (z) âˆ’f (z)| : z âˆˆKn} . Thus you get uniform
convergence of the derivatives.
Since the family, F satisï¬es the conclusion of Theorem 27.7 it is known as a
normal family of functions. More generally,
Deï¬nition 27.8 Let F denote a collection of functions which are analytic on â„¦, a
region. Then F is normal if every sequence contained in F has a subsequence which
converges uniformly on compact subsets of â„¦.
The following result is about a certain class of fractional linear transformations.
Recall Lemma 25.18 which is listed here for convenience.
Lemma 27.9 For Î± âˆˆB (0, 1) , let
Ï†Î± (z) â‰¡z âˆ’Î±
1 âˆ’Î±z .
Then Ï†Î± maps B (0, 1) one to one and onto B (0, 1), Ï†âˆ’1
Î±
= Ï†âˆ’Î±, and
Ï†â€²
Î± (Î±) =
1
1 âˆ’|Î±|2 .

742
COMPLEX MAPPINGS
The next lemma, known as Schwarzâ€™s lemma is interesting for its own sake but
will also be an important part of the proof of the Riemann mapping theorem. It
was stated and proved earlier but for convenience it is given again here.
Lemma 27.10 Suppose F : B (0, 1) â†’B (0, 1) , F is analytic, and F (0) = 0. Then
for all z âˆˆB (0, 1) ,
|F (z)| â‰¤|z| ,
(27.3)
and
|F â€² (0)| â‰¤1.
(27.4)
If equality holds in 27.4 then there exists Î» âˆˆC with |Î»| = 1 and
F (z) = Î»z.
(27.5)
Proof: First note that by assumption, F (z) /z has a removable singularity at
0 if its value at 0 is deï¬ned to be F â€² (0) . By the maximum modulus theorem, if
|z| < r < 1,
Â¯Â¯Â¯Â¯
F (z)
z
Â¯Â¯Â¯Â¯ â‰¤max
tâˆˆ[0,2Ï€]
Â¯Â¯F
Â¡
reitÂ¢Â¯Â¯
r
â‰¤1
r .
Then letting r â†’1,
Â¯Â¯Â¯Â¯
F (z)
z
Â¯Â¯Â¯Â¯ â‰¤1
this shows 27.3 and it also veriï¬es 27.4 on taking the limit as z â†’0. If equality
holds in 27.4, then |F (z) /z| achieves a maximum at an interior point so F (z) /z
equals a constant, Î» by the maximum modulus theorem. Since F (z) = Î»z, it follows
F â€² (0) = Î» and so |Î»| = 1. This proves the lemma.
Deï¬nition 27.11 A region, â„¦has the square root property if whenever f, 1
f : â„¦â†’
C are both analytic1, it follows there exists Ï† : â„¦â†’C such that Ï† is analytic and
f (z) = Ï†2 (z) .
The next theorem will turn out to be equivalent to the Riemann mapping the-
orem.
27.3.2
Regions With Square Root Property
Theorem 27.12 Let â„¦Ì¸= C for â„¦a region and suppose â„¦has the square root
property. Then for z0 âˆˆâ„¦there exists h : â„¦â†’B (0, 1) such that h is one to one,
onto, analytic, and h (z0) = 0.
Proof: Deï¬ne F to be the set of functions, f such that f : â„¦â†’B (0, 1) is one
to one and analytic. The ï¬rst task is to show F is nonempty. Then, using Montelâ€™s
theorem it will be shown there is a function in F, h, such that |hâ€² (z0)| â‰¥
Â¯Â¯Ïˆâ€² (z0)
Â¯Â¯
1This implies f has no zero on â„¦.

27.3.
RIEMANN MAPPING THEOREM
743
for all Ïˆ âˆˆF. When this has been done it will be shown that h is actually onto.
This will prove the theorem.
Claim 1: F is nonempty.
Proof of Claim 1: Since â„¦Ì¸= C it follows there exists Î¾ /âˆˆâ„¦. Then it follows
z âˆ’Î¾ and
1
zâˆ’Î¾ are both analytic on â„¦.
Since â„¦has the square root property,
there exists an analytic function, Ï† : â„¦â†’C such that Ï†2 (z) = z âˆ’Î¾ for all
z âˆˆâ„¦, Ï† (z) = âˆšz âˆ’Î¾. Since z âˆ’Î¾ is not constant, neither is Ï† and it follows
from the open mapping theorem that Ï† (â„¦) is a region. Note also that Ï† is one
to one because if Ï† (z1) = Ï† (z2) , then you can square both sides and conclude
z1 âˆ’Î¾ = z2 âˆ’Î¾ implying z1 = z2.
Now pick a âˆˆÏ† (â„¦) . Thus âˆšza âˆ’Î¾ = a. I claim there exists a positive lower
bound to
Â¯Â¯âˆšz âˆ’Î¾ + a
Â¯Â¯ for z âˆˆâ„¦. If not, there exists a sequence, {zn} âŠ†â„¦such
that
p
zn âˆ’Î¾ + a =
p
zn âˆ’Î¾ +
p
za âˆ’Î¾ â‰¡Îµn â†’0.
Then
p
zn âˆ’Î¾ =
Â³
Îµn âˆ’
p
za âˆ’Î¾
Â´
(27.6)
and squaring both sides,
zn âˆ’Î¾ = Îµ2
n + za âˆ’Î¾ âˆ’2Îµn
p
za âˆ’Î¾.
Consequently, (zn âˆ’za) = Îµ2
n âˆ’2Îµn
âˆšza âˆ’Î¾ which converges to 0. Taking the limit
in 27.6, it follows 2âˆšza âˆ’Î¾ = 0 and so Î¾ = za, a contradiction to Î¾ /âˆˆâ„¦. Choose
r > 0 such that for all z âˆˆâ„¦,
Â¯Â¯âˆšz âˆ’Î¾ + a
Â¯Â¯ > r > 0. Then consider
Ïˆ (z) â‰¡
r
âˆšz âˆ’Î¾ + a.
(27.7)
This is one to one, analytic, and maps â„¦into B (0, 1) (
Â¯Â¯âˆšz âˆ’Î¾ + a
Â¯Â¯ > r). Thus F
is not empty and this proves the claim.
Claim 2: Let z0 âˆˆâ„¦. There exists a ï¬nite positive real number, Î·, deï¬ned by
Î· â‰¡sup
Â©Â¯Â¯Ïˆâ€² (z0)
Â¯Â¯ : Ïˆ âˆˆF
Âª
(27.8)
and an analytic function, h âˆˆF such that |hâ€² (z0)| = Î·. Furthermore, h (z0) = 0.
Proof of Claim 2: First you show Î· < âˆž. Let Î³ (t) = z0 + reit for t âˆˆ[0, 2Ï€]
and r is small enough that B (z0, r) âŠ†â„¦. Then for Ïˆ âˆˆF, the Cauchy integral
formula for the derivative implies
Ïˆâ€² (z0) =
1
2Ï€i
Z
Î³
Ïˆ (w)
(w âˆ’z0)2 dw
and so
Â¯Â¯Ïˆâ€² (z0)
Â¯Â¯ â‰¤(1/2Ï€) 2Ï€r
Â¡
1/r2Â¢
= 1/r. Therefore, Î· < âˆžas desired. For Ïˆ
deï¬ned above in 27.7
Ïˆâ€² (z0) =
âˆ’rÏ†â€² (z0)
(Ï† (z0) + a)2 = âˆ’r (1/2)
Â¡âˆšz0 âˆ’Î¾
Â¢âˆ’1
(Ï† (z0) + a)2
Ì¸= 0.

744
COMPLEX MAPPINGS
Therefore, Î· > 0. It remains to verify the existence of the function, h.
By Theorem 27.7, there exists a sequence, {Ïˆn}, of functions in F and an
analytic function, h, such that
Â¯Â¯Ïˆâ€²
n (z0)
Â¯Â¯ â†’Î·
(27.9)
and
Ïˆn â†’h, Ïˆâ€²
n â†’hâ€²,
(27.10)
uniformly on all compact subsets of â„¦. It follows
|hâ€² (z0)| = lim
nâ†’âˆž
Â¯Â¯Ïˆâ€²
n (z0)
Â¯Â¯ = Î·
(27.11)
and for all z âˆˆâ„¦,
|h (z)| = lim
nâ†’âˆž|Ïˆn (z)| â‰¤1.
(27.12)
By 27.11, h is not a constant. Therefore, in fact, |h (z)| < 1 for all z âˆˆâ„¦in
27.12 by the open mapping theorem.
Next it must be shown that h is one to one in order to conclude h âˆˆF. Pick
z1 âˆˆâ„¦and suppose z2 is another point of â„¦. Since the zeros of h âˆ’h (z1) have no
limit point, there exists a circular contour bounding a circle which contains z2 but
not z1 such that Î³âˆ—contains no zeros of h âˆ’h (z1).
t
z1
?

6
Î³
t
z2
Using the theorem on counting zeros, Theorem 25.20, and the fact that Ïˆn is
one to one,
0
=
lim
nâ†’âˆž
1
2Ï€i
Z
Î³
Ïˆâ€²
n (w)
Ïˆn (w) âˆ’Ïˆn (z1)dw
=
1
2Ï€i
Z
Î³
hâ€² (w)
h (w) âˆ’h (z1)dw,
which shows that hâˆ’h (z1) has no zeros in B (z2, r) . In particular z2 is not a zero of
h âˆ’h (z1) . This shows that h is one to one since z2 Ì¸= z1 was arbitrary. Therefore,
h âˆˆF. It only remains to verify that h (z0) = 0.
If h (z0) Ì¸= 0,consider Ï†h(z0) â—¦h where Ï†Î± is the fractional linear transformation
deï¬ned in Lemma 27.9. By this lemma it follows Ï†h(z0) â—¦h âˆˆF. Now using the

27.3.
RIEMANN MAPPING THEOREM
745
chain rule,
Â¯Â¯Â¯Â¯
Â³
Ï†h(z0) â—¦h
Â´â€²
(z0)
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Ï†â€²
h(z0) (h (z0))
Â¯Â¯Â¯ |hâ€² (z0)|
=
Â¯Â¯Â¯Â¯Â¯
1
1 âˆ’|h (z0)|2
Â¯Â¯Â¯Â¯Â¯ |hâ€² (z0)|
=
Â¯Â¯Â¯Â¯Â¯
1
1 âˆ’|h (z0)|2
Â¯Â¯Â¯Â¯Â¯ Î· > Î·
Contradicting the deï¬nition of Î·. This proves Claim 2.
Claim 3: The function, h just obtained maps â„¦onto B (0, 1).
Proof of Claim 3: To show h is onto, use the fractional linear transformation
of Lemma 27.9. Suppose h is not onto. Then there exists Î± âˆˆB (0, 1)\h (â„¦) . Then
0 Ì¸= Ï†Î± â—¦h (z) for all z âˆˆâ„¦because
Ï†Î± â—¦h (z) = h (z) âˆ’Î±
1 âˆ’Î±h (z)
and it is assumed Î± /âˆˆh (â„¦) . Therefore, since â„¦has the square root property, you
can consider an analytic function z â†’
p
Ï†Î± â—¦h (z). This function is one to one
because both Ï†Î± and h are. Also, the values of this function are in B (0, 1) by
Lemma 27.9 so it is in F.
Now let
Ïˆ â‰¡Ï†âˆš
Ï†Î±â—¦h(z0) â—¦
p
Ï†Î± â—¦h.
(27.13)
Thus
Ïˆ (z0) = Ï†âˆš
Ï†Î±â—¦h(z0) â—¦
p
Ï†Î± â—¦h (z0) = 0
and Ïˆ is a one to one mapping of â„¦into B (0, 1) so Ïˆ is also in F. Therefore,
Â¯Â¯Ïˆâ€² (z0)
Â¯Â¯ â‰¤Î·,
Â¯Â¯Â¯Â¯
Â³p
Ï†Î± â—¦h
Â´â€²
(z0)
Â¯Â¯Â¯Â¯ â‰¤Î·.
(27.14)
Deï¬ne s (w) â‰¡w2. Then using Lemma 27.9, in particular, the description of Ï†âˆ’1
Î±
=
Ï†âˆ’Î±, you can solve 27.13 for h to obtain
h (z)
=
Ï†âˆ’Î± â—¦s â—¦Ï†âˆ’âˆš
Ï†Î±â—¦h(z0) â—¦Ïˆ
=
ï£«
ï£­
â‰¡F
z
}|
{
Ï†âˆ’Î± â—¦s â—¦Ï†âˆ’âˆš
Ï†Î±â—¦h(z0) â—¦Ïˆ
ï£¶
ï£¸(z)
=
(F â—¦Ïˆ) (z)
(27.15)
Now
F (0) = Ï†âˆ’Î± â—¦s â—¦Ï†âˆ’âˆš
Ï†Î±â—¦h(z0) (0) = Ï†âˆ’1
Î± (Ï†Î± â—¦h (z0)) = h (z0) = 0

746
COMPLEX MAPPINGS
and F maps B (0, 1) into B (0, 1). Also, F is not one to one because it maps B (0, 1)
to B (0, 1) and has s in its deï¬nition. Thus there exists z1 âˆˆB (0, 1) such that
Ï†âˆ’âˆš
Ï†Î±â—¦h(z0) (z1) = âˆ’1
2 and another point z2 âˆˆB (0, 1) such that Ï†âˆ’âˆš
Ï†Î±â—¦h(z0) (z2) =
1
2. However, thanks to s, F (z1) = F (z2).
Since F (0) = h (z0) = 0, you can apply the Schwarz lemma to F. Since F is
not one to one, it canâ€™t be true that F (z) = Î»z for |Î»| = 1 and so by the Schwarz
lemma it must be the case that |F â€² (0)| < 1. But this implies from 27.15 and 27.14
that
Î·
=
|hâ€² (z0)| = |F â€² (Ïˆ (z0))|
Â¯Â¯Ïˆâ€² (z0)
Â¯Â¯
=
|F â€² (0)|
Â¯Â¯Ïˆâ€² (z0)
Â¯Â¯ <
Â¯Â¯Ïˆâ€² (z0)
Â¯Â¯ â‰¤Î·,
a contradiction. This proves the theorem.
The following lemma yields the usual form of the Riemann mapping theorem.
Lemma 27.13 Let â„¦be a simply connected region with â„¦Ì¸= C. Then â„¦has the
square root property.
Proof: Let f and
1
f both be analytic on â„¦. Then f â€²
f is analytic on â„¦so by
Corollary 24.50, there exists eF, analytic on â„¦such that eF â€² =
f â€²
f
on â„¦. Then
Â³
feâˆ’e
F Â´â€²
= 0 and so f (z) = Ce e
F = ea+ibe e
F . Now let F = eF + a + ib. Then F is
still a primitive of f â€²/f and f (z) = eF (z). Now let Ï† (z) â‰¡e
1
2 F (z). Then Ï† is the
desired square root and so â„¦has the square root property.
Corollary 27.14 (Riemann mapping theorem) Let â„¦be a simply connected region
with â„¦Ì¸= C and let z0 âˆˆâ„¦. Then there exists a function, f : â„¦â†’B (0, 1) such
that f is one to one, analytic, and onto with f (z0) = 0. Furthermore, f âˆ’1 is also
analytic.
Proof: From Theorem 27.12 and Lemma 27.13 there exists a function, f : â„¦â†’
B (0, 1) which is one to one, onto, and analytic such that f (z0) = 0. The assertion
that f âˆ’1 is analytic follows from the open mapping theorem.
27.4
Analytic Continuation
27.4.1
Regular And Singular Points
Given a function which is analytic on some set, can you extend it to an analytic
function deï¬ned on a larger set? Sometimes you can do this. It was done in the
proof of the Cauchy integral formula. There are also reï¬‚ection theorems like those
discussed in the exercises starting with Problem 10 on Page 678. Here I will give a
systematic way of extending an analytic function to a larger set. I will emphasize
simply connected regions. The subject of analytic continuation is much larger than
the introduction given here. A good source for much more on this is found in Alfors

27.4.
ANALYTIC CONTINUATION
747
[2]. The approach given here is suggested by Rudin [45] and avoids many of the
standard technicalities.
Deï¬nition 27.15 Let f be analytic on B (a, r) and let Î² âˆˆâˆ‚B (a, r) . Then Î² is
called a regular point of f if there exists some Î´ > 0 and a function, g analytic on
B (Î², Î´) such that g = f on B (Î², Î´) âˆ©B (a, r) . Those points of âˆ‚B (a, r) which are
not regular are called singular.
r a
rÎ²
Theorem 27.16 Suppose f is analytic on B (a, r) and the power series
f (z) =
âˆž
X
k=0
ak (z âˆ’a)k
has radius of convergence r. Then there exists a singular point on âˆ‚B (a, r).
Proof: If not, then for every z âˆˆâˆ‚B (a, r) there exists Î´z > 0 and gz analytic
on B (z, Î´z) such that gz = f on B (z, Î´z) âˆ©B (a, r) . Since âˆ‚B (a, r) is compact,
there exist z1, Â·Â·Â·, zn, points in âˆ‚B (a, r) such that {B (zk, Î´zk)}n
k=1 covers âˆ‚B (a, r) .
Now deï¬ne
g (z) â‰¡
Â½
f (z) if z âˆˆB (a, r)
gzk (z) if z âˆˆB (zk, Î´zk)
Is this well deï¬ned? If z âˆˆB (zi, Î´zi) âˆ©B
Â¡
zj, Î´zj
Â¢
, is gzi (z) = gzj (z)? Consider the
following picture representing this situation.
You see that if z âˆˆB (zi, Î´zi) âˆ©B
Â¡
zj, Î´zj
Â¢
then I â‰¡B (zi, Î´zi) âˆ©B
Â¡
zj, Î´zj
Â¢
âˆ©
B (a, r) is a nonempty open set. Both gzi and gzj equal f on I. Therefore, they
must be equal on B (zi, Î´zi) âˆ©B
Â¡
zj, Î´zj
Â¢
because I has a limit point. Therefore,
g is well deï¬ned and analytic on an open set containing B (a, r). Since g agrees

748
COMPLEX MAPPINGS
with f on B (a, r) , the power series for g is the same as the power series for f and
converges on a ball which is larger than B (a, r) contrary to the assumption that the
radius of convergence of the above power series equals r. This proves the theorem.
27.4.2
Continuation Along A Curve
Next I will describe what is meant by continuation along a curve. The following
deï¬nition is standard and is found in Rudin [45].
Deï¬nition 27.17 A function element is an ordered pair, (f, D) where D is an open
ball and f is analytic on D. (f0, D0) and (f1, D1) are direct continuations of each
other if D1 âˆ©D0 Ì¸= âˆ…and f0 = f1 on D1 âˆ©D0. In this case I will write (f0, D0) âˆ¼
(f1, D1) . A chain is a ï¬nite sequence, of disks, {D0, Â· Â· Â·, Dn} such that Diâˆ’1 âˆ©Di Ì¸=
âˆ…. If (f0, D0) is a given function element and there exist function elements, (fi, Di)
such that {D0, Â· Â· Â·, Dn} is a chain and (fjâˆ’1, Djâˆ’1) âˆ¼(fj, Dj) then (fn, Dn) is
called the analytic continuation of (f0, D0) along the chain {D0, Â· Â· Â·, Dn}.
Now
suppose Î³ is an oriented curve with parameter interval [a, b] and there exists a chain,
{D0, Â· Â· Â·, Dn} such that Î³âˆ—âŠ†âˆªn
k=1Dk, Î³ (a) is the center of D0, Î³ (b) is the center
of Dn, and there is an increasing list of numbers in [a, b] , a = s0 < s1 Â· Â·Â· < sn = b
such that Î³ ([si, si+1]) âŠ†Di and (fn, Dn) is an analytic continuation of (f0, D0)
along the chain. Then (fn, Dn) is called an analytic continuation of (f0, D0) along
the curve Î³. (Î³ will always be a continuous curve. Nothing more is needed. )
In the above situation it does not follow that if Dn âˆ©D0 Ì¸= âˆ…, that fn = f0! How-
ever, there are some cases where this will happen. This is the monodromy theorem
which follows. This is as far as I will go on the subject of analytic continuation. For
more on this subject including a development of the concept of Riemann surfaces,
see Alfors [2].
Lemma 27.18 Suppose (f, B (0, r)) for r < 1 is a function element and (f, B (0, r))
can be analytically continued along every curve in B (0, 1) that starts at 0. Then
there exists an analytic function, g deï¬ned on B (0, 1) such that g = f on B (0, r) .
Proof: Let
R
=
sup{r1 â‰¥r such that there exists gr1
analytic on B (0, r1) which agrees with f on B (0, r) .}
Deï¬ne gR (z) â‰¡gr1 (z) where |z| < r1. This is well deï¬ned because if you use r1
and r2, both gr1 and gr2 agree with f on B (0, r), a set with a limit point and so
the two functions agree at every point in both B (0, r1) and B (0, r2). Thus gR is
analytic on B (0, R) . If R < 1, then by the assumption there are no singular points
on B (0, R) and so Theorem 27.16 implies the radius of convergence of the power
series for gR is larger than R contradicting the choice of R. Therefore, R = 1 and
this proves the lemma. Let g = gR.
The following theorem is the main result in this subject, the monodromy theo-
rem.

27.5.
THE PICARD THEOREMS
749
Theorem 27.19 Let â„¦be a simply connected proper subset of C and suppose
(f, B (a, r)) is a function element with B (a, r) âŠ†â„¦. Suppose also that this function
element can be analytically continued along every curve through a. Then there exists
G analytic on â„¦such that G agrees with f on B (a, r).
Proof: By the Riemann mapping theorem, there exists h : â„¦â†’B (0, 1) which
is analytic, one to one and onto such that f (a) = 0. Since h is an open map, there
exists Î´ > 0 such that
B (0, Î´) âŠ†h (B (a, r)) .
It follows f â—¦hâˆ’1 can be analytically continued along every curve through 0. By
Lemma 27.18 there exists g analytic on B (0, 1) which agrees with f â—¦hâˆ’1 on B (0, Î´).
Deï¬ne G (z) â‰¡g (h (z)) . For z = hâˆ’1 (w) , it follows G
Â¡
hâˆ’1 (w)
Â¢
= g (w) . If w âˆˆ
B (0, Î´) , then G
Â¡
hâˆ’1 (w)
Â¢
= f â—¦hâˆ’1 (w) and so G = f on hâˆ’1 (B (0, Î´)) , an open
set contained in B (a, r). Therefore, G = f on B (a, r) because hâˆ’1 (B (0, Î´)) has a
limit point. This proves the theorem.
Actually, you sometimes want to consider the case where â„¦= C. This requires
a small modiï¬cation to obtain from the above theorem.
Corollary 27.20 Suppose (f, B (a, r)) is a function element with B (a, r) âŠ†C.
Suppose also that this function element can be analytically continued along every
curve through a. Then there exists G analytic on C such that G agrees with f on
B (a, r).
Proof: Let â„¦1 â‰¡{z âˆˆC : a + it : t > a} and â„¦2 â‰¡{z âˆˆC : a âˆ’it : t > a} . Here
is a picture of â„¦1.
â„¦1
a
r
A picture of â„¦2 is similar except the line extends down from the boundary of
B (a, r).
Thus B (a, r) âŠ†â„¦i and â„¦i is simply connected and proper. By Theorem 27.19
there exist analytic functions, Gi analytic on â„¦i such that Gi = f on B (a, r). Thus
G1 = G2 on B (a, r) , a set with a limit point. Therefore, G1 = G2 on â„¦1 âˆ©â„¦2. Now
let G (z) = Gi (z) where z âˆˆâ„¦i. This is well deï¬ned and analytic on C. This proves
the corollary.
27.5
The Picard Theorems
The Picard theorem says that if f is an entire function and there are two complex
numbers not contained in f (C) , then f is constant. This is certainly one of the
most amazing things which could be imagined.
However, this is only the little

750
COMPLEX MAPPINGS
Picard theorem. The big Picard theorem is even more incredible. This one asserts
that to be non constant the entire function must take every value of C but two
inï¬nitely many times! I will begin with the little Picard theorem. The method of
proof I will use is the one found in Saks and Zygmund [47], Conway [13] and Hille
[27]. This is not the way Picard did it in 1879. That approach is very diï¬€erent and
is presented at the end of the material on elliptic functions. This approach is much
more recent dating it appears from around 1924.
Lemma 27.21 Let f be analytic on a region containing B (0, r) and suppose
|f â€² (0)| = b > 0, f (0) = 0,
and |f (z)| â‰¤M for all z âˆˆB (0, r). Then f (B (0, r)) âŠ‡B
Â³
0, r2b2
6M
Â´
.
Proof: By assumption,
f (z) =
âˆž
X
k=0
akzk, |z| â‰¤r.
(27.16)
Then by the Cauchy integral formula for the derivative,
ak =
1
2Ï€i
Z
âˆ‚B(0,r)
f (w)
wk+1 dw
where the integral is in the counter clockwise direction. Therefore,
|ak| â‰¤1
2Ï€
Z 2Ï€
0
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯
rk
dÎ¸ â‰¤M
rk .
In particular, br â‰¤M. Therefore, from 27.16
|f (z)|
â‰¥
b |z| âˆ’
âˆž
X
k=2
M
rk |z|k = b |z| âˆ’
M
Â³
|z|
r
Â´2
1 âˆ’|z|
r
=
b |z| âˆ’
M |z|2
r2 âˆ’r |z|
Suppose |z| = r2b
4M < r. Then this is no larger than
1
4b2r2
3M âˆ’br
M (4M âˆ’br) â‰¥1
4b2r2
3M âˆ’M
M (4M âˆ’M) = r2b2
6M .
Let |w| < r2b
4M . Then for |z| = r2b
4M and the above,
|w| = |(f (z) âˆ’w) âˆ’f (z)| < r2b
4M â‰¤|f (z)|
and so by Roucheâ€™s theorem, z â†’f (z)âˆ’w and z â†’f (z) have the same number of
zeros in B
Â³
0, r2b
4M
Â´
. But f has at least one zero in this ball and so this shows there
exists at least one z âˆˆB
Â³
0, r2b
4M
Â´
such that f (z) âˆ’w = 0. This proves the lemma.

27.5.
THE PICARD THEOREMS
751
27.5.1
Two Competing Lemmas
Lemma 27.21 is a really nice lemma but there is something even better, Blochâ€™s
lemma.
This lemma does not depend on the bound of f.
Like the above two
lemmas it is interesting for its own sake and in addition is the key to a fairly short
proof of Picardâ€™s theorem. It features the number
1
24. The best constant is not
currently known.
Lemma 27.22 Let f be analytic on an open set containing B (0, R) and suppose
|f â€² (0)| > 0. Then there exists a âˆˆB (0, R) such that
f (B (0, R)) âŠ‡B
Âµ
f (a) , |f â€² (0)| R
24
Â¶
.
Proof: Let K (Ï) â‰¡max {|f â€² (z)| : |z| = Ï} . For simplicity, let CÏ â‰¡{z : |z| = Ï}.
Claim: K is continuous from the left.
Proof of claim: Let zÏ âˆˆCÏ such that |f â€² (zÏ)| = K (Ï) . Then by the maximum
modulus theorem, if Î» âˆˆ(0, 1) ,
|f â€² (Î»zÏ)| â‰¤K (Î»Ï) â‰¤K (Ï) = |f â€² (zÏ)| .
Letting Î» â†’1 yields the claim.
Let Ï0 be the largest such that (R âˆ’Ï0) K (Ï0) = R |f â€² (0)| . (Note (R âˆ’0) K (0) =
R |f â€² (0)| .) Thus Ï0 < R because (R âˆ’R) K (R) = 0. Let |a| = Ï0 such that
|f â€² (a)| = K (Ï0). Thus
|f â€² (a)| (R âˆ’Ï0) = |f â€² (0)| R
(27.17)
Now let r = Râˆ’Ï0
2
. From 27.17,
|f â€² (a)| r = 1
2 |f â€² (0)| R, B (a, r) âŠ†B (0, Ï0 + r) âŠ†B (0, R) .
(27.18)
r
0
ra

752
COMPLEX MAPPINGS
Therefore, if z âˆˆB (a, r) , it follows from the maximum modulus theorem and
the deï¬nition of Ï0 that
|f â€² (z)|
â‰¤
K (Ï0 + r) <
R |f â€² (0)|
R âˆ’Ï0 âˆ’r = 2R |f â€² (0)|
R âˆ’Ï0
=
2R |f â€² (0)|
2r
= R |f â€² (0)|
r
(27.19)
Let g (z) = f (a + z) âˆ’f (a) where z âˆˆB (0, r) . Then |gâ€² (0)| = |f â€² (a)| > 0 and
for z âˆˆB (0, r),
|g (z)| â‰¤
Â¯Â¯Â¯Â¯Â¯
Z
Î³(a,z)
gâ€² (w) dw
Â¯Â¯Â¯Â¯Â¯ â‰¤|z âˆ’a| R |f â€² (0)|
r
= R |f â€² (0)| .
By Lemma 27.21 and 27.18,
g (B (0, r))
âŠ‡
B
Ãƒ
0, r2 |f â€² (a)|2
6R |f â€² (0)|
!
=
B
Ãƒ
0, r2 Â¡ 1
2r |f â€² (0)| R
Â¢2
6R |f â€² (0)|
!
= B
Âµ
0, |f â€² (0)| R
24
Â¶
Now g (B (0, r)) = f (B (a, r)) âˆ’f (a) and so this implies
f (B (0, R)) âŠ‡f (B (a, r)) âŠ‡B
Âµ
f (a) , |f â€² (0)| R
24
Â¶
.
This proves the lemma.
Here is a slightly more general version which allows the center of the open set
to be arbitrary.
Lemma 27.23 Let f be analytic on an open set containing B (z0, R) and suppose
|f â€² (z0)| > 0. Then there exists a âˆˆB (z0, R) such that
f (B (z0, R)) âŠ‡B
Âµ
f (a) , |f â€² (z0)| R
24
Â¶
.
Proof: You look at g (z) â‰¡f (z0 + z) âˆ’f (z0) for z âˆˆB (0, R) . Then gâ€² (0) =
f â€² (z0) and so by Lemma 27.22 there exists a1 âˆˆB (0, R) such that
g (B (0, R)) âŠ‡B
Âµ
g (a1) , |f â€² (z0)| R
24
Â¶
.
Now g (B (0, R)) = f (B (z0, R)) âˆ’f (z0) and g (a1) = f (a) âˆ’f (z0) for some a âˆˆ
B (z0, R) and so
f (B (z0, R)) âˆ’f (z0)
âŠ‡
B
Âµ
g (a1) , |f â€² (z0)| R
24
Â¶
=
B
Âµ
f (a) âˆ’f (z0) , |f â€² (z0)| R
24
Â¶

27.5.
THE PICARD THEOREMS
753
which implies
f (B (z0, R)) âŠ‡B
Âµ
f (a) , |f â€² (z0)| R
24
Â¶
as claimed. This proves the lemma.
No attempt was made to ï¬nd the best number to multiply by R |f â€² (z0)|. A
discussion of this is given in Conway [13]. See also [27]. Much larger numbers than
1/24 are available and there is a conjecture due to Alfors about the best value. The
conjecture is that 1/24 can be replaced with
Î“
Â¡ 1
3
Â¢
Î“
Â¡ 11
12
Â¢
Â¡
1 +
âˆš
3
Â¢1/2 Î“
Â¡ 1
4
Â¢ â‰ˆ. 471 86
You can see there is quite a gap between the constant for which this lemma is proved
above and what is thought to be the best constant.
Blochâ€™s lemma above gives the existence of a ball of a certain size inside the
image of a ball. By contrast the next lemma leads to conditions under which the
values of a function do not contain a ball of certain radius. It concerns analytic
functions which do not achieve the values 0 and 1.
Lemma 27.24 Let F denote the set of functions, f deï¬ned on â„¦, a simply con-
nected region which do not achieve the values 0 and 1. Then for each such function,
it is possible to deï¬ne a function analytic on â„¦, H (z) by the formula
H (z) â‰¡log
"r
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
#
.
There exists a constant C independent of f âˆˆF such that H (â„¦) does not contain
any ball of radius C.
Proof: Let f âˆˆF. Then since f does not take the value 0, there exists g1 a
primitive of f â€²/f. Thus
d
dz
Â¡
eâˆ’g1f
Â¢
= 0
so there exists a, b such that f (z) eâˆ’g1(z) = ea+bi. Letting g (z) = g1 (z) + a + ib, it
follows eg(z) = f (z). Let log (f (z)) = g (z). Then for n âˆˆZ, the integers,
log (f (z))
2Ï€i
, log (f (z))
2Ï€i
âˆ’1 Ì¸= n
because if equality held, then f (z) = 1 which does not happen. It follows log(f(z))
2Ï€i
and log(f(z))
2Ï€i
âˆ’1 are never equal to zero. Therefore, using the same reasoning, you
can deï¬ne a logarithm of these two quantities and therefore, a square root. Hence
there exists a function analytic on â„¦,
r
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1.
(27.20)

754
COMPLEX MAPPINGS
For n a positive integer, this function cannot equal âˆšn Â± âˆšn âˆ’1 because if it did,
then
Ãƒr
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
!
= âˆšn Â±
âˆš
n âˆ’1
(27.21)
and you could take reciprocals of both sides to obtain
Ãƒr
log (f (z))
2Ï€i
+
r
log (f (z))
2Ï€i
âˆ’1
!
= âˆšn âˆ“
âˆš
n âˆ’1.
(27.22)
Then adding 27.21 and 27.22
2
r
log (f (z))
2Ï€i
= 2âˆšn
which contradicts the above observation that log(f(z))
2Ï€i
is not equal to an integer.
Also, the function of 27.20 is never equal to zero. Therefore, you can deï¬ne the
logarithm of this function also. It follows
H (z) â‰¡log
Ãƒr
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
!
Ì¸= ln
Â¡âˆšn Â±
âˆš
n âˆ’1
Â¢
+ 2mÏ€i
where m is an arbitrary integer and n is a positive integer. Now
lim
nâ†’âˆžln
Â¡âˆšn +
âˆš
n âˆ’1
Â¢
= âˆž
and limnâ†’âˆžln
Â¡âˆšn âˆ’âˆšn âˆ’1
Â¢
= âˆ’âˆžand so C is covered by rectangles having
vertices at points ln
Â¡âˆšn Â± âˆšn âˆ’1
Â¢
+ 2mÏ€i as described above.
Each of these
rectangles has height equal to 2Ï€ and a short computation shows their widths are
bounded. Therefore, there exists C independent of f âˆˆF such that C is larger
than the diameter of all these rectangles. Hence H (â„¦) cannot contain any ball of
radius larger than C.
27.5.2
The Little Picard Theorem
Now here is the little Picard theorem. It is easy to prove from the above.
Theorem 27.25 If h is an entire function which omits two values then h is a
constant.
Proof: Suppose the two values omitted are a and b and that h is not constant.
Let f (z) = (h (z) âˆ’a) / (b âˆ’a). Then f omits the two values 0 and 1. Let H be
deï¬ned in Lemma 27.24. Then H (z) is clearly not of the form az+b because then it
would have values equal to the vertices ln
Â¡âˆšn Â± âˆšn âˆ’1
Â¢
+2mÏ€i or else be constant
neither of which happen if h is not constant. Therefore, by Liouvilleâ€™s theorem, Hâ€²
must be unbounded. Pick Î¾ such that |Hâ€² (Î¾)| > 24C where C is such that H (C)

27.5.
THE PICARD THEOREMS
755
contains no balls of radius larger than C. But by Lemma 27.23 H (B (Î¾, 1)) must
contain a ball of radius |Hâ€²(Î¾)|
24
> 24C
24
= C, a contradiction. This proves Picardâ€™s
theorem.
The following is another formulation of this theorem.
Corollary 27.26 If f is a meromophic function deï¬ned on C which omits three
distinct values, a, b, c, then f is a constant.
Proof: Let Ï† (z) â‰¡zâˆ’a
zâˆ’c
bâˆ’c
bâˆ’a. Then Ï† (c) = âˆž, Ï† (a) = 0, and Ï† (b) = 1. Now
consider the function, h = Ï† â—¦f. Then h misses the three points âˆž, 0, and 1. Since
h is meromorphic and does not have âˆžin its values, it must actually be analytic.
Thus h is an entire function which misses the two values 0 and 1. Therefore, h is
constant by Theorem 27.25.
27.5.3
Schottkyâ€™s Theorem
Lemma 27.27 Let f be analytic on an open set containing B (0, R) and suppose
that f does not take on either of the two values 0 or 1. Also suppose |f (0)| â‰¤Î².
Then letting Î¸ âˆˆ(0, 1) , it follows
|f (z)| â‰¤M (Î², Î¸)
for all z âˆˆB (0, Î¸R) , where M (Î², Î¸) is a function of only the two variables Î², Î¸.
(In particular, there is no dependence on R.)
Proof: Consider the function, H (z) used in Lemma 27.24 given by
H (z) â‰¡log
Ãƒr
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
!
.
(27.23)
You notice there are two explicit uses of logarithms. Consider ï¬rst the logarithm
inside the radicals. Choose this logarithm such that
log (f (0)) = ln |f (0)| + i arg (f (0)) , arg (f (0)) âˆˆ(âˆ’Ï€, Ï€].
(27.24)
You can do this because
elog(f(0)) = f (0) = eln|f(0)|eiÎ± = eln|f(0)|+iÎ±
and by replacing Î± with Î± + 2mÏ€ for a suitable integer, m it follows the above
equation still holds. Therefore, you can assume 27.24. Similar reasoning applies to
the logarithm on the outside of the parenthesis. It can be assumed H (0) equals
ln
Â¯Â¯Â¯Â¯Â¯
r
log (f (0))
2Ï€i
âˆ’
r
log (f (0))
2Ï€i
âˆ’1
Â¯Â¯Â¯Â¯Â¯ + i arg
Ãƒr
log (f (0))
2Ï€i
âˆ’
r
log (f (0))
2Ï€i
âˆ’1
!
(27.25)

756
COMPLEX MAPPINGS
where the imaginary part is no larger than Ï€ in absolute value.
Now if Î¾ âˆˆB (0, R) is a point where Hâ€² (Î¾) Ì¸= 0, then by Lemma 27.22
H (B (Î¾, R âˆ’|Î¾|)) âŠ‡B
Âµ
H (a) , |Hâ€² (Î¾)| (R âˆ’|Î¾|)
24
Â¶
where a is some point in B (Î¾, R âˆ’|Î¾|). But by Lemma 27.24 H (B (Î¾, R âˆ’|Î¾|))
contains no balls of radius C where C depended only on the maximum diameters of
those rectangles having vertices ln
Â¡âˆšn Â± âˆšn âˆ’1
Â¢
+ 2mÏ€i for n a positive integer
and m an integer. Therefore,
|Hâ€² (Î¾)| (R âˆ’|Î¾|)
24
< C
and consequently
|Hâ€² (Î¾)| <
24C
R âˆ’|Î¾|.
Even if Hâ€² (Î¾) = 0, this inequality still holds. Therefore, if z âˆˆB (0, R) and Î³ (0, z)
is the straight segment from 0 to z,
|H (z) âˆ’H (0)|
=
Â¯Â¯Â¯Â¯Â¯
Z
Î³(0,z)
Hâ€² (w) dw
Â¯Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
Z 1
0
Hâ€² (tz) zdt
Â¯Â¯Â¯Â¯
â‰¤
Z 1
0
|Hâ€² (tz) z| dt â‰¤
Z 1
0
24C
R âˆ’t |z| |z| dt
=
24C ln
Âµ
R
R âˆ’|z|
Â¶
.
Therefore, for z âˆˆâˆ‚B (0, Î¸R) ,
|H (z)| â‰¤|H (0)| + 24C ln
Âµ
1
1 âˆ’Î¸
Â¶
.
(27.26)
By the maximum modulus theorem, the above inequality holds for all |z| < Î¸R also.
Next I will use 27.23 to get an inequality for |f (z)| in terms of |H (z)|. From
27.23,
H (z) = log
Ãƒr
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
!
and so
2H (z)
=
log
Ãƒr
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
!2
âˆ’2H (z)
=
log
Ãƒr
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
!âˆ’2
=
log
Ãƒr
log (f (z))
2Ï€i
+
r
log (f (z))
2Ï€i
âˆ’1
!2

27.5.
THE PICARD THEOREMS
757
Therefore,
Ãƒr
log (f (z))
2Ï€i
+
r
log (f (z))
2Ï€i
âˆ’1
!2
+
Ãƒr
log (f (z))
2Ï€i
âˆ’
r
log (f (z))
2Ï€i
âˆ’1
!2
=
exp (2H (z)) + exp (âˆ’2H (z))
and
Âµlog (f (z))
Ï€i
âˆ’1
Â¶
= 1
2 (exp (2H (z)) + exp (âˆ’2H (z))) .
Thus
log (f (z)) = Ï€i + Ï€i
2 (exp (2H (z)) + exp (âˆ’2H (z)))
which shows
|f (z)|
=
Â¯Â¯Â¯Â¯exp
Â·Ï€i
2 (exp (2H (z)) + exp (âˆ’2H (z)))
Â¸Â¯Â¯Â¯Â¯
â‰¤
exp
Â¯Â¯Â¯Â¯
Ï€i
2 (exp (2H (z)) + exp (âˆ’2H (z)))
Â¯Â¯Â¯Â¯
â‰¤
exp
Â¯Â¯Â¯Ï€
2 (|exp (2H (z))| + |exp (âˆ’2H (z))|)
Â¯Â¯Â¯
â‰¤
exp
Â¯Â¯Â¯Ï€
2 (exp (2 |H (z)|) + exp (|âˆ’2H (z)|))
Â¯Â¯Â¯
=
exp (Ï€ exp 2 |H (z)|) .
Now from 27.26 this is dominated by
exp
Âµ
Ï€ exp 2
Âµ
|H (0)| + 24C ln
Âµ
1
1 âˆ’Î¸
Â¶Â¶Â¶
=
exp
Âµ
Ï€ exp (2 |H (0)|) exp
Âµ
48C ln
Âµ
1
1 âˆ’Î¸
Â¶Â¶Â¶
(27.27)
Consider exp (2 |H (0)|). I want to obtain an inequality for this which involves
Î². This is where I will use the convention about the logarithms discussed above.
From 27.25,
2 |H (0)| = 2
Â¯Â¯Â¯Â¯Â¯log
Ãƒr
log (f (0))
2Ï€i
âˆ’
r
log (f (0))
2Ï€i
âˆ’1
!Â¯Â¯Â¯Â¯Â¯

758
COMPLEX MAPPINGS
â‰¤
2
ï£«
ï£­
Ãƒ
ln
Â¯Â¯Â¯Â¯Â¯
r
log (f (0))
2Ï€i
âˆ’
r
log (f (0))
2Ï€i
âˆ’1
Â¯Â¯Â¯Â¯Â¯
!2
+ Ï€2
ï£¶
ï£¸
1/2
â‰¤
2
ï£«
ï£­
Â¯Â¯Â¯Â¯Â¯ln
ÃƒÂ¯Â¯Â¯Â¯Â¯
r
log (f (0))
2Ï€i
Â¯Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯Â¯
r
log (f (0))
2Ï€i
âˆ’1
Â¯Â¯Â¯Â¯Â¯
!Â¯Â¯Â¯Â¯Â¯
2
+ Ï€2
ï£¶
ï£¸
1/2
â‰¤
2
Â¯Â¯Â¯Â¯Â¯ln
ÃƒÂ¯Â¯Â¯Â¯Â¯
r
log (f (0))
2Ï€i
Â¯Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯Â¯
r
log (f (0))
2Ï€i
âˆ’1
Â¯Â¯Â¯Â¯Â¯
!Â¯Â¯Â¯Â¯Â¯ + 2Ï€
â‰¤
ln
Âµ
2
ÂµÂ¯Â¯Â¯Â¯
log (f (0))
2Ï€i
Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯
log (f (0))
2Ï€i
âˆ’1
Â¯Â¯Â¯Â¯
Â¶Â¶
+ 2Ï€
=
ln
ÂµÂµÂ¯Â¯Â¯Â¯
log (f (0))
Ï€i
Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯
log (f (0))
Ï€i
âˆ’2
Â¯Â¯Â¯Â¯
Â¶Â¶
+ 2Ï€
(27.28)
Consider
Â¯Â¯Â¯ log(f(0))
Ï€i
Â¯Â¯Â¯
log (f (0))
Ï€i
= âˆ’ln |f (0)|
Ï€
i + arg (f (0))
Ï€
and so
Â¯Â¯Â¯Â¯
log (f (0))
Ï€i
Â¯Â¯Â¯Â¯
=
ÃƒÂ¯Â¯Â¯Â¯
ln |f (0)|
Ï€
Â¯Â¯Â¯Â¯
2
+
Âµarg (f (0))
Ï€
Â¶2!1/2
â‰¤
ÃƒÂ¯Â¯Â¯Â¯
ln Î²
Ï€
Â¯Â¯Â¯Â¯
2
+
Â³Ï€
Ï€
Â´2
!1/2
=
ÃƒÂ¯Â¯Â¯Â¯
ln Î²
Ï€
Â¯Â¯Â¯Â¯
2
+ 1
!1/2
.
Similarly,
Â¯Â¯Â¯Â¯
log (f (0))
Ï€i
âˆ’2
Â¯Â¯Â¯Â¯
â‰¤
ÃƒÂ¯Â¯Â¯Â¯
ln Î²
Ï€
Â¯Â¯Â¯Â¯
2
+ (2 + 1)2
!1/2
=
ÃƒÂ¯Â¯Â¯Â¯
ln Î²
Ï€
Â¯Â¯Â¯Â¯
2
+ 9
!1/2
It follows from 27.28 that
2 |H (0)| â‰¤ln
ï£«
ï£­2
ÃƒÂ¯Â¯Â¯Â¯
ln Î²
Ï€
Â¯Â¯Â¯Â¯
2
+ 9
!1/2ï£¶
ï£¸+ 2Ï€.
Hence from 27.27
|f (z)| â‰¤

27.5.
THE PICARD THEOREMS
759
exp
ï£«
ï£­Ï€ exp
ï£«
ï£­ln
ï£«
ï£­2
ÃƒÂ¯Â¯Â¯Â¯
ln Î²
Ï€
Â¯Â¯Â¯Â¯
2
+ 9
!1/2ï£¶
ï£¸+ 2Ï€
ï£¶
ï£¸exp
Âµ
48C ln
Âµ
1
1 âˆ’Î¸
Â¶Â¶ï£¶
ï£¸
and so, letting M (Î², Î¸) be given by the above expression on the right, the lemma
is proved.
The following theorem will be referred to as Schottkyâ€™s theorem. It looks just
like the above lemma except it is only assumed that f is analytic on B (0, R) rather
than on an open set containing B (0, R). Also, the case of an arbitrary center is
included along with arbitrary points which are not attained as values of the function.
Theorem 27.28 Let f be analytic on B (z0, R) and suppose that f does not take
on either of the two distinct values a or b. Also suppose |f (z0)| â‰¤Î². Then letting
Î¸ âˆˆ(0, 1) , it follows
|f (z)| â‰¤M (a, b, Î², Î¸)
for all z âˆˆB (z0, Î¸R) , where M (a, b, Î², Î¸) is a function of only the variables Î², Î¸,a, b.
(In particular, there is no dependence on R.)
Proof: First you can reduce to the case where the two values are 0 and 1 by
considering
h (z) â‰¡f (z) âˆ’a
b âˆ’a
.
If there exists an estimate of the desired sort for h, then there exists such an estimate
for f. Of course here the function, M would depend on a and b. Therefore, there is
no loss of generality in assuming the points which are missed are 0 and 1.
Apply Lemma 27.27 to B (0, R1) for the function, g (z) â‰¡f (z0 + z) and R1 < R.
Then if Î² â‰¥|f (z0)| = |g (0)| , it follows |g (z)| = |f (z0 + z)| â‰¤M (Î², Î¸) for every
z âˆˆB (0, Î¸R1) . Now let Î¸ âˆˆ(0, 1) and choose R1 < R large enough that Î¸R = Î¸1R1
where Î¸1 âˆˆ(0, 1) . Then if |z âˆ’z0| < Î¸R, it follows
|f (z)| â‰¤M (Î², Î¸1) .
Now let R1 â†’R so Î¸1 â†’Î¸.
27.5.4
A Brief Review
First recall the deï¬nition of the metric on bC. For convenience it is listed here again.
Consider the unit sphere, S2 given by (z âˆ’1)2 +y2 +x2 = 1. Deï¬ne a map from the
complex plane to the surface of this sphere as follows. Extend a line from the point,
p in the complex plane to the point (0, 0, 2) on the top of this sphere and let Î¸ (p)
denote the point of this sphere which the line intersects. Deï¬ne Î¸ (âˆž) â‰¡(0, 0, 2).

760
COMPLEX MAPPINGS
s
s
s
(0, 0, 2)
(0, 0, 1)
s
@
@
@
@
@
@@
p
Î¸(p)
C
Then Î¸âˆ’1 is sometimes called sterographic projection. The mapping Î¸ is clearly
continuous because it takes converging sequences, to converging sequences. Fur-
thermore, it is clear that Î¸âˆ’1 is also continuous. In terms of the extended complex
plane, bC, a sequence, zn converges to âˆžif and only if Î¸zn converges to (0, 0, 2) and
a sequence, zn converges to z âˆˆC if and only if Î¸ (zn) â†’Î¸ (z) .
In fact this makes it easy to deï¬ne a metric on bC.
Deï¬nition 27.29 Let z, w âˆˆbC. Then let d (x, y) â‰¡|Î¸ (z) âˆ’Î¸ (w)| where this last
distance is the usual distance measured in R3.
Theorem 27.30
Â³
bC, d
Â´
is a compact, hence complete metric space.
Proof: Suppose {zn} is a sequence in bC. This means {Î¸ (zn)} is a sequence in
S2 which is compact. Therefore, there exists a subsequence, {Î¸znk} and a point,
z âˆˆS2 such that Î¸znk â†’Î¸z in S2 which implies immediately that d (znk, z) â†’0.
A compact metric space must be complete.
Also recall the interesting fact that meromorphic functions are continuous with
values in bC which is reviewed here for convenience. It came from the theory of
classiï¬cation of isolated singularities.
Theorem 27.31 Let â„¦be an open subset of C and let f : â„¦â†’bC be meromorphic.
Then f is continuous with respect to the metric, d on bC.
Proof: Let zn â†’z where z âˆˆâ„¦. Then if z is a pole, it follows from Theorem
24.38 that
d (f (zn) , âˆž) â‰¡d (f (zn) , f (z)) â†’0.
If z is not a pole, then f (zn) â†’f (z) in C which implies |Î¸ (f (zn)) âˆ’Î¸ (f (z))| =
d (f (zn) , f (z)) â†’0. Recall that Î¸ is continuous on C.
The fundamental result behind all the theory about to be presented is the Ascoli
Arzela theorem also listed here for convenience.
Deï¬nition 27.32 Let (X, d) be a complete metric space.
Then it is said to be
locally compact if B (x, r) is compact for each r > 0.
Thus if you have a locally compact metric space, then if {an} is a bounded
sequence, it must have a convergent subsequence.
Let K be a compact subset of Rn and consider the continuous functions which
have values in a locally compact metric space, (X, d) where d denotes the metric on
X. Denote this space as C (K, X) .

27.5.
THE PICARD THEOREMS
761
Deï¬nition 27.33 For f, g âˆˆC (K, X) , where K is a compact subset of Rn and X
is a locally compact complete metric space deï¬ne
ÏK (f, g) â‰¡sup {d (f (x) , g (x)) : x âˆˆK} .
The Ascoli Arzela theorem, Theorem 6.24 is a major result which tells which
subsets of C (K, X) are sequentially compact.
Deï¬nition 27.34 Let A âŠ†C (K, X) for K a compact subset of Rn. Then A is
said to be uniformly equicontinuous if for every Îµ > 0 there exists a Î´ > 0 such that
whenever x, y âˆˆK with |x âˆ’y| < Î´ and f âˆˆA,
d (f (x) , f (y)) < Îµ.
The set, A is said to be uniformly bounded if for some M < âˆž, and a âˆˆX,
f (x) âˆˆB (a, M)
for all f âˆˆA and x âˆˆK.
The Ascoli Arzela theorem follows.
Theorem 27.35 Suppose K is a nonempty compact subset of Rn and A âŠ†C (K, X) ,
is uniformly bounded and uniformly equicontinuous where X is a locally compact
complete metric space. Then if {fk} âŠ†A, there exists a function, f âˆˆC (K, X) and
a subsequence, fkl such that
lim
lâ†’âˆžÏK (fkl, f) = 0.
In the cases of interest here, X = bC with the metric deï¬ned above.
27.5.5
Montelâ€™s Theorem
The following lemma is another version of Montelâ€™s theorem. It is this which will
make possible a proof of the big Picard theorem.
Lemma 27.36 Let â„¦be a region and let F be a set of functions analytic on â„¦
none of which achieve the two distinct values, a and b. If {fn} âŠ†F then one of the
following hold: Either there exists a function, f analytic on â„¦and a subsequence,
{fnk} such that for any compact subset, K of â„¦,
lim
kâ†’âˆž||fnk âˆ’f||K,âˆž= 0.
(27.29)
or there exists a subsequence {fnk} such that for all compact subsets K,
lim
kâ†’âˆžÏK (fnk, âˆž) = 0.
(27.30)

762
COMPLEX MAPPINGS
Proof: Let B (z0, 2R) âŠ†â„¦. There are two cases to consider. The ï¬rst case is
that there exists a subsequence, nk such that {fnk (z0)} is bounded. The second
case is that limnâ†’âˆž|fnk (z0)| = âˆž.
Consider the ï¬rst case. By Theorem 27.28 {fnk (z)} is uniformly bounded on
B (z0, R) because by this theorem, and letting Î¸ = 1/2 applied to B (z0, 2R) , it fol-
lows |fnk (z)| â‰¤M
Â¡
a, b, 1
2, Î²
Â¢
where Î² is an upper bound to the numbers, |fnk (z0)|.
The Cauchy integral formula implies the existence of a uniform bound on the
Â©
f â€²
nk
Âª
which implies the functions are equicontinuous and uniformly bounded. Therefore,
by the Ascoli Arzela theorem there exists a further subsequence which converges
uniformly on B (z0, R) to a function, f analytic on B (z0, R). Thus denoting this
subsequence by {fnk} to save on notation,
lim
kâ†’âˆž||fnk âˆ’f||B(z0,R),âˆž= 0.
(27.31)
Consider the second case.
In this case, it follows {1/fn (z0)} is bounded on
B (z0, R) and so by the same argument just given {1/fn (z)} is uniformly bounded
on B (z0, R).
Therefore, a subsequence converges uniformly on B (z0, R). But
{1/fn (z)} converges to 0 and so this requires that {1/fn (z)} must converge uni-
formly to 0. Therefore,
lim
kâ†’âˆžÏB(z0,R) (fnk, âˆž) = 0.
(27.32)
Now let {Dk} denote a countable set of closed balls, Dk = B (zk, Rk) such that
B (zk, 2Rk) âŠ†â„¦and âˆªâˆž
k=1 int (Dk) = â„¦. Using a Cantor diagonal process, there
exists a subsequence, {fnk} of {fn} such that for each Dj, one of the above two
alternatives holds. That is, either
lim
kâ†’âˆž||fnk âˆ’gj||Dj,âˆž= 0
(27.33)
or,
lim
kâ†’âˆžÏDj (fnk, âˆž) .
(27.34)
Let A = {âˆªint (Dj) : 27.33 holds} , B = {âˆªint (Dj) : 27.34 holds} . Note that the
balls whose union is A cannot intersect any of the balls whose union is B. Therefore,
one of A or B must be empty since otherwise, â„¦would not be connected.
If K is any compact subset of â„¦, it follows K must be a subset of some ï¬nite
collection of the Dj. Therefore, one of the alternatives in the lemma must hold.
That the limit function, f must be analytic follows easily in the same way as the
proof in Theorem 27.7 on Page 740. You could also use Moreraâ€™s theorem. This
proves the lemma.
27.5.6
The Great Big Picard Theorem
The next theorem is the main result which the above lemmas lead to. It is the Big
Picard theorem, also called the Great Picard theorem.Recall Bâ€² (a, r) is the deleted
ball consisting of all the points of the ball except the center.

27.5.
THE PICARD THEOREMS
763
Theorem 27.37 Suppose f has an isolated essential singularity at 0. Then for
every R > 0, and Î² âˆˆC, f âˆ’1 (Î²)âˆ©Bâ€² (0, R) is an inï¬nite set except for one possible
exceptional Î².
Proof: Suppose this is not true. Then there exists R1 > 0 and two points, Î±
and Î² such that f âˆ’1 (Î²) âˆ©Bâ€² (0, R1) and f âˆ’1 (Î±) âˆ©Bâ€² (0, R1) are both ï¬nite sets.
Then shrinking R1 and calling the result R, there exists B (0, R) such that
f âˆ’1 (Î²) âˆ©Bâ€² (0, R) = âˆ…, f âˆ’1 (Î±) âˆ©Bâ€² (0, R) = âˆ….
Now let A0 denote the annulus
Â©
z âˆˆC : R
22 < |z| < 3R
22
Âª
and let An denote the
annulus
Â©
z âˆˆC :
R
22+n < |z| <
3R
22+n
Âª
. The reason for the 3 is to insure that An âˆ©
An+1 Ì¸= âˆ…. This follows from the observation that 3R/22+1+n > R/22+n. Now
deï¬ne a set of functions on A0 as follows:
fn (z) â‰¡f
Â³ z
2n
Â´
.
By the choice of R, this set of functions missed the two points Î± and Î². Therefore, by
Lemma 27.36 there exists a subsequence such that one of the two options presented
there holds.
First suppose limkâ†’âˆž||fnk âˆ’f||K,âˆž= 0 for all K a compact subset of A0 and
f is analytic on A0. In particular, this happens for Î³0 the circular contour having
radius R/2. Thus fnk must be bounded on this contour. But this says the same
thing as f (z/2nk) is bounded for |z| = R/2, this holding for each k = 1, 2, Â·Â·Â·. Thus
there exists a constant, M such that on each of a shrinking sequence of concentric
circles whose radii converge to 0, |f (z)| â‰¤M. By the maximum modulus theorem,
|f (z)| â‰¤M at every point between successive circles in this sequence. Therefore,
|f (z)| â‰¤M in Bâ€² (0, R) contradicting the Weierstrass Casorati theorem.
The other option which might hold from Lemma 27.36 is that limkâ†’âˆžÏK (fnk, âˆž) =
0 for all K compact subset of A0. Since f has an essential singularity at 0 the zeros
of f in B (0, R) are isolated. Therefore, for all k large enough, fnk has no zeros for
|z| < 3R/22. This is because the values of fnk are the values of f on Ank, a small
anulus which avoids all the zeros of f whenever k is large enough. Only consider k
this large. Then use the above argument on the analytic functions 1/fnk. By the as-
sumption that limkâ†’âˆžÏK (fnk, âˆž) = 0, it follows limkâ†’âˆž||1/fnk âˆ’0||K,âˆž= 0 and
so as above, there exists a shrinking sequence of concentric circles whose radii con-
verge to 0 and a constant, M such that for z on any of these circles, |1/f (z)| â‰¤M.
This implies that on some deleted ball, Bâ€² (0, r) where r â‰¤R, |f (z)| â‰¥1/M which
again violates the Weierstrass Casorati theorem. This proves the theorem.
As a simple corollary, here is what this remarkable theorem says about entire
functions.
Corollary 27.38 Suppose f is entire and nonconstant and not a polynomial. Then
f assumes every complex value inï¬nitely many times with the possible exception of
one.

764
COMPLEX MAPPINGS
Proof: Since f is entire, f (z) = Pâˆž
n=0 anzn. Deï¬ne for z Ì¸= 0,
g (z) â‰¡f
Âµ1
z
Â¶
=
âˆž
X
n=0
an
Âµ1
z
Â¶n
.
Thus 0 is an isolated essential singular point of g. By the big Picard theorem,
Theorem 27.37 it follows g takes every complex number but possibly one an inï¬nite
number of times. This proves the corollary.
Note the diï¬€erence between this and the little Picard theorem which says that
an entire function which is not constant must achieve every value but two.
27.6
Exercises
1. Prove that in Theorem 27.7 it suï¬ƒces to assume F is uniformly bounded on
each compact subset of â„¦.
2. Find conditions on a, b, c, d such that the fractional linear transformation,
az+b
cz+d maps the upper half plane onto the upper half plane.
3. Let D be a simply connected region which is a proper subset of C. Does there
exist an entire function, f which maps C onto D? Why or why not?
4. Verify the conclusion of Theorem 27.7 involving the higher order derivatives.
5. What if â„¦= C? Does there exist an analytic function, f mapping â„¦one to
one and onto B (0, 1)? Explain why or why not. Was â„¦Ì¸= C used in the proof
of the Riemann mapping theorem?
6. Verify that |Ï†Î± (z)| = 1 if |z| = 1. Apply the maximum modulus theorem to
conclude that |Ï†Î± (z)| â‰¤1 for all |z| < 1.
7. Suppose that |f (z)| â‰¤1 for |z| = 1 and f (Î±) = 0 for |Î±| < 1. Show that
|f (z)| â‰¤|Ï†Î± (z)| for all z âˆˆB (0, 1) . Hint: Consider f(z)(1âˆ’Î±z)
zâˆ’Î±
which has a
removable singularity at Î±. Show the modulus of this function is bounded by
1 on |z| = 1. Then apply the maximum modulus theorem.
8. Let U and V be open subsets of C and suppose u : U â†’R is harmonic while
h is an analytic map which takes V one to one onto U. Show that u â—¦h is
harmonic on V .
9. Show that for a harmonic function, u deï¬ned on B (0, R) , there exists an
analytic function, h = u + iv where
v (x, y) â‰¡
Z y
0
ux (x, t) dt âˆ’
Z x
0
uy (t, 0) dt.

27.6.
EXERCISES
765
10. Suppose â„¦is a simply connected region and u is a real valued function deï¬ned
on â„¦such that u is harmonic. Show there exists an analytic function, f such
that u = Re f. Show this is not true if â„¦is not a simply connected region.
Hint: You might use the Riemann mapping theorem and Problems 8 and
9.
For the second part it might be good to try something like u (x, y) =
ln
Â¡
x2 + y2Â¢
on the annulus 1 < |z| < 2.
11. Show that w = 1+z
1âˆ’z maps {z âˆˆC : Im z > 0 and |z| < 1} to the ï¬rst quadrant,
{z = x + iy : x, y > 0} .
12. Let f (z) = az+b
cz+d and let g (z) = a1z+b1
c1z+d1 . Show that f â—¦g (z) equals the quotient
of two expressions, the numerator being the top entry in the vector
Âµ
a
b
c
d
Â¶ Âµ
a1
b1
c1
d1
Â¶ Âµ
z
1
Â¶
and the denominator being the bottom entry. Show that if you deï¬ne
Ï†
ÂµÂµ
a
b
c
d
Â¶Â¶
â‰¡az + b
cz + d,
then Ï† (AB) = Ï† (A) â—¦Ï† (B) . Find an easy way to ï¬nd the inverse of f (z) =
az+b
cz+d and give a condition on the a, b, c, d which insures this function has an
inverse.
13. The modular group2 is the set of fractional linear transformations, az+b
cz+d such
that a, b, c, d are integers and ad âˆ’bc = 1. Using Problem 12 or brute force
show this modular group is really a group with the group operation being
composition. Also show the inverse of az+b
cz+d is
dzâˆ’b
âˆ’cz+a.
14. Let â„¦be a region and suppose f is analytic on â„¦and that the functions fn
are also analytic on â„¦and converge to f uniformly on compact subsets of â„¦.
Suppose f is one to one. Can it be concluded that for an arbitrary compact
set, K âŠ†â„¦that fn is one to one for all n large enough?
15. The Vitali theorem says that if â„¦is a region and {fn} is a uniformly bounded
sequence of functions which converges pointwise on a set, S âŠ†â„¦which has a
limit point in â„¦, then in fact, {fn} must converge uniformly on compact sub-
sets of â„¦to an analytic function. Prove this theorem. Hint: If the sequence
fails to converge, show you can get two diï¬€erent subsequences converging uni-
formly on compact sets to diï¬€erent functions. Then argue these two functions
coincide on S.
16. Does there exist a function analytic on B (0, 1) which maps B (0, 1)
onto
Bâ€² (0, 1) , the open unit ball in which 0 has been deleted?
2This is the terminology used in Rudinâ€™s book Real and Complex Analysis.

766
COMPLEX MAPPINGS

Approximation By Rational
Functions
28.1
Rungeâ€™s Theorem
Consider the function, 1
z = f (z) for z deï¬ned on â„¦â‰¡B (0, 1) \ {0} = Bâ€² (0, 1) .
Clearly f is analytic on â„¦. Suppose you could approximate f uniformly by poly-
nomials on ann
Â¡
0, 1
2, 3
4
Â¢
, a compact subset of â„¦. Then, there would exist a suit-
able polynomial p (z) , such that
Â¯Â¯Â¯ 1
2Ï€i
R
Î³ f (z) âˆ’p (z) dz
Â¯Â¯Â¯ <
1
10 where here Î³ is a
circle of radius
2
3. However, this is impossible because
1
2Ï€i
R
Î³ f (z) dz = 1 while
1
2Ï€i
R
Î³ p (z) dz = 0. This shows you canâ€™t expect to be able to uniformly approxi-
mate analytic functions on compact sets using polynomials. This is just horrible!
In real variables, you can approximate any continuous function on a compact
set with a polynomial. However, that is just the way it is. It turns out that the
ability to approximate an analytic function on â„¦with polynomials is dependent on
â„¦being simply connected.
All these theorems work for f having values in a complex Banach space. How-
ever, I will present them in the context of functions which have values in C. The
changes necessary to obtain the extra generality are very minor.
Deï¬nition 28.1 Approximation will be taken with respect to the following norm.
||f âˆ’g||K,âˆžâ‰¡sup {||f (z) âˆ’g (z)|| : z âˆˆK}
28.1.1
Approximation With Rational Functions
It turns out you can approximate analytic functions by rational functions, quotients
of polynomials. The resulting theorem is one of the most profound theorems in
complex analysis. The basic idea is simple. The Riemann sums for the Cauchy
integral formula are rational functions. The idea used to implement this observation
is that if you have a compact subset, K of an open set, â„¦there exists a cycle
composed of closed oriented curves
Â©
Î³j
Âªn
j=1 which are contained in â„¦\K such that
767

768
APPROXIMATION BY RATIONAL FUNCTIONS
for every z âˆˆK, Pn
k=1 n (Î³k, z) = 1. One more ingredient is needed and this is a
theorem which lets you keep the approximation but move the poles.
To begin with, consider the part about the cycle of closed oriented curves. Recall
Theorem 24.52 which is stated for convenience.
Theorem 28.2 Let K be a compact subset of an open set, â„¦. Then there exist
continuous, closed, bounded variation oriented curves
Â©
Î³j
Âªm
j=1 for which Î³âˆ—
j âˆ©K = âˆ…
for each j, Î³âˆ—
j âŠ†â„¦, and for all p âˆˆK,
m
X
k=1
n (p, Î³k) = 1.
and
m
X
k=1
n (z, Î³k) = 0
for all z /âˆˆâ„¦.
This theorem implies the following.
Theorem 28.3 Let K âŠ†â„¦where K is compact and â„¦is open. Then there exist
oriented closed curves, Î³k such that Î³âˆ—
k âˆ©K = âˆ…but Î³âˆ—
k âŠ†â„¦, such that for all z âˆˆK,
f (z) =
1
2Ï€i
p
X
k=1
Z
Î³k
f (w)
w âˆ’z dw.
(28.1)
Proof: This follows from Theorem 24.52 and the Cauchy integral formula. As
shown in the proof, you can assume the Î³k are linear mappings but this is not
important.
Next I will show how the Cauchy integral formula leads to approximation by
rational functions, quotients of polynomials.
Lemma 28.4 Let K be a compact subset of an open set, â„¦and let f be analytic
on â„¦. Then there exists a rational function, Q whose poles are not in K such that
||Q âˆ’f||K,âˆž< Îµ.
Proof: By Theorem 28.3 there are oriented curves, Î³k described there such that
for all z âˆˆK,
f (z) =
1
2Ï€i
p
X
k=1
Z
Î³k
f (w)
w âˆ’z dw.
(28.2)
Deï¬ning g (w, z) â‰¡
f(w)
wâˆ’z for (w, z) âˆˆâˆªp
k=1Î³âˆ—
k Ã— K, it follows since the distance
between K and âˆªkÎ³âˆ—
k is positive that g is uniformly continuous and so there exists
a Î´ > 0 such that if ||P|| < Î´, then for all z âˆˆK,
Â¯Â¯Â¯Â¯Â¯Â¯
f (z) âˆ’
1
2Ï€i
p
X
k=1
n
X
j=1
f (Î³k (Ï„ j)) (Î³k (ti) âˆ’Î³k (tiâˆ’1))
Î³k (Ï„ j) âˆ’z
Â¯Â¯Â¯Â¯Â¯Â¯
< Îµ
2.

28.1.
RUNGEâ€™S THEOREM
769
The complicated expression is obtained by replacing each integral in 28.2 with a
Riemann sum. Simplifying the appearance of this, it follows there exists a rational
function of the form
R (z) =
M
X
k=1
Ak
wk âˆ’z
where the wk are elements of components of C \ K and Ak are complex numbers or
in the case where f has values in X, these would be elements of X such that
||R âˆ’f||K,âˆž< Îµ
2.
This proves the lemma.
28.1.2
Moving The Poles And Keeping The Approximation
Lemma 28.4 is a nice lemma but needs reï¬ning. In this lemma, the Riemann sum
handed you the poles. It is much better if you can pick the poles. The following
theorem from advanced calculus, called Mertenâ€™s theorem, will be used
28.1.3
Mertenâ€™s Theorem.
Theorem 28.5 Suppose Pâˆž
i=r ai and Pâˆž
j=r bj both converge absolutely1. Then
Ãƒ âˆž
X
i=r
ai
! ï£«
ï£­
âˆž
X
j=r
bj
ï£¶
ï£¸=
âˆž
X
n=r
cn
where
cn =
n
X
k=r
akbnâˆ’k+r.
Proof: Let pnk = 1 if r â‰¤k â‰¤n and pnk = 0 if k > n. Then
cn =
âˆž
X
k=r
pnkakbnâˆ’k+r.
1Actually, it is only necessary to assume one of the series converges and the other converges
absolutely. This is known as Mertenâ€™s theorem and may be read in the 1974 book by Apostol
listed in the bibliography.

770
APPROXIMATION BY RATIONAL FUNCTIONS
Also,
âˆž
X
k=r
âˆž
X
n=r
pnk |ak| |bnâˆ’k+r|
=
âˆž
X
k=r
|ak|
âˆž
X
n=r
pnk |bnâˆ’k+r|
=
âˆž
X
k=r
|ak|
âˆž
X
n=k
|bnâˆ’k+r|
=
âˆž
X
k=r
|ak|
âˆž
X
n=k
Â¯Â¯bnâˆ’(kâˆ’r)
Â¯Â¯
=
âˆž
X
k=r
|ak|
âˆž
X
m=r
|bm| < âˆž.
Therefore,
âˆž
X
n=r
cn
=
âˆž
X
n=r
n
X
k=r
akbnâˆ’k+r =
âˆž
X
n=r
âˆž
X
k=r
pnkakbnâˆ’k+r
=
âˆž
X
k=r
ak
âˆž
X
n=r
pnkbnâˆ’k+r =
âˆž
X
k=r
ak
âˆž
X
n=k
bnâˆ’k+r
=
âˆž
X
k=r
ak
âˆž
X
m=r
bm
and this proves the theorem.
It follows that Pâˆž
n=r cn converges absolutely. Also, you can see by induction that
you can multiply any number of absolutely convergent series together and obtain a
series which is absolutely convergent. Next, here are some similar results related to
Mertenâ€™s theorem.
Lemma 28.6 Let Pâˆž
n=0 an (z) and Pâˆž
n=0 bn (z) be two convergent series for z âˆˆK
which satisfy the conditions of the Weierstrass M test. Thus there exist positive
constants, An and Bn such that |an (z)| â‰¤An, |bn (z)| â‰¤Bn for all z âˆˆK and
Pâˆž
n=0 An < âˆž, Pâˆž
n=0 Bn < âˆž. Then deï¬ning the Cauchy product,
cn (z) â‰¡
n
X
kâˆ’0
anâˆ’k (z) bk (z) ,
it follows Pâˆž
n=0 cn (z) also converges absolutely and uniformly on K because cn (z)
satisï¬es the conditions of the Weierstrass M test. Therefore,
âˆž
X
n=0
cn (z) =
Ãƒ âˆž
X
k=0
ak (z)
! Ãƒ âˆž
X
n=0
bn (z)
!
.
(28.3)
Proof:
|cn (z)| â‰¤
n
X
k=0
|anâˆ’k (z)| |bk (z)| â‰¤
n
X
k=0
Anâˆ’kBk.

28.1.
RUNGEâ€™S THEOREM
771
Also,
âˆž
X
n=0
n
X
k=0
Anâˆ’kBk
=
âˆž
X
k=0
âˆž
X
n=k
Anâˆ’kBk
=
âˆž
X
k=0
Bk
âˆž
X
n=0
An < âˆž.
The claim of 28.3 follows from Mertenâ€™s theorem. This proves the lemma.
Corollary 28.7 Let P be a polynomial and let Pâˆž
n=0 an (z) converge uniformly and
absolutely on K such that the an satisfy the conditions of the Weierstrass M test.
Then there exists a series for P (Pâˆž
n=0 an (z)) , Pâˆž
n=0 cn (z) , which also converges
absolutely and uniformly for z âˆˆK because cn (z) also satisï¬es the conditions of the
Weierstrass M test.
The following picture is descriptive of the following lemma. This lemma says
that if you have a rational function with one pole oï¬€a compact set, then you can
approximate on the compact set with another rational function which has a diï¬€erent
pole.
V
u
u
a
b
K
Lemma 28.8 Let R be a rational function which has a pole only at a âˆˆV, a
component of C \ K where K is a compact set. Suppose b âˆˆV. Then for Îµ > 0
given, there exists a rational function, Q, having a pole only at b such that
||R âˆ’Q||K,âˆž< Îµ.
(28.4)
If it happens that V is unbounded, then there exists a polynomial, P such that
||R âˆ’P||K,âˆž< Îµ.
(28.5)
Proof: Say that b âˆˆV satisï¬es P if for all Îµ > 0 there exists a rational function,
Qb, having a pole only at b such that
||R âˆ’Qb||K,âˆž< Îµ
Now deï¬ne a set,
S â‰¡{b âˆˆV : b satisï¬es P } .

772
APPROXIMATION BY RATIONAL FUNCTIONS
Observe that S Ì¸= âˆ…because a âˆˆS.
I claim S is open. Suppose b1 âˆˆS. Then there exists a Î´ > 0 such that
Â¯Â¯Â¯Â¯
b1 âˆ’b
z âˆ’b
Â¯Â¯Â¯Â¯ < 1
2
(28.6)
for all z âˆˆK whenever b âˆˆB (b1, Î´) . In fact, it suï¬ƒces to take |b âˆ’b1| < dist (b1, K) /4
because then
Â¯Â¯Â¯Â¯
b1 âˆ’b
z âˆ’b
Â¯Â¯Â¯Â¯
<
Â¯Â¯Â¯Â¯
dist (b1, K) /4
z âˆ’b
Â¯Â¯Â¯Â¯ â‰¤
dist (b1, K) /4
|z âˆ’b1| âˆ’|b1 âˆ’b|
â‰¤
dist (b1, K) /4
dist (b1, K) âˆ’dist (b1, K) /4 â‰¤1
3 < 1
2.
Since b1 satisï¬es P, there exists a rational function Qb1 with the desired prop-
erties. It is shown next that you can approximate Qb1 with Qb thus yielding an
approximation to R by the use of the triangle inequality,
||R âˆ’Qb1||K,âˆž+ ||Qb1 âˆ’Qb||K,âˆžâ‰¥||R âˆ’Qb||K,âˆž.
Since Qb1 has poles only at b1, it follows it is a sum of functions of the form
Î±n
(zâˆ’b1)n . Therefore, it suï¬ƒces to consider the terms of Qb1 or that Qb1 is of the
special form
Qb1 (z) =
1
(z âˆ’b1)n .
However,
1
(z âˆ’b1)n =
1
(z âˆ’b)n Â³
1 âˆ’b1âˆ’b
zâˆ’b
Â´n
Now from the choice of b1, the series
âˆž
X
k=0
Âµb1 âˆ’b
z âˆ’b
Â¶k
=
1
Â³
1 âˆ’b1âˆ’b
zâˆ’b
Â´
converges absolutely independent of the choice of z âˆˆK because
Â¯Â¯Â¯Â¯Â¯
Âµb1 âˆ’b
z âˆ’b
Â¶kÂ¯Â¯Â¯Â¯Â¯ < 1
2k .
By Corollary 28.7 the same is true of the series for
1
(1âˆ’b1âˆ’b
zâˆ’b )
n . Thus a suitable partial
sum can be made uniformly on K as close as desired to
1
(zâˆ’b1)n . This shows that b
satisï¬es P whenever b is close enough to b1 verifying that S is open.
Next it is shown S is closed in V. Let bn âˆˆS and suppose bn â†’b âˆˆV. Then
since bn âˆˆS, there exists a rational function, Qbn such that
||Qbn âˆ’R||K,âˆž< Îµ
2.

28.1.
RUNGEâ€™S THEOREM
773
Then for all n large enough,
1
2 dist (b, K) â‰¥|bn âˆ’b|
and so for all n large enough,
Â¯Â¯Â¯Â¯
b âˆ’bn
z âˆ’bn
Â¯Â¯Â¯Â¯ < 1
2,
for all z âˆˆK. Pick such a bn. As before, it suï¬ƒces to assume Qbn, is of the form
1
(zâˆ’bn)n . Then
Qbn (z) =
1
(z âˆ’bn)n =
1
(z âˆ’b)n Â³
1 âˆ’bnâˆ’b
zâˆ’b
Â´n
and because of the estimate, there exists M such that for all z âˆˆK
Â¯Â¯Â¯Â¯Â¯Â¯
1
Â³
1 âˆ’bnâˆ’b
zâˆ’b
Â´n âˆ’
M
X
k=0
ak
Âµbn âˆ’b
z âˆ’b
Â¶k
Â¯Â¯Â¯Â¯Â¯Â¯
< Îµ (dist (b, K))n
2
.
(28.7)
Therefore, for all z âˆˆK
Â¯Â¯Â¯Â¯Â¯Qbn (z) âˆ’
1
(z âˆ’b)n
M
X
k=0
ak
Âµbn âˆ’b
z âˆ’b
Â¶kÂ¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯Â¯
1
(z âˆ’b)n Â³
1 âˆ’bnâˆ’b
zâˆ’b
Â´n âˆ’
1
(z âˆ’b)n
M
X
k=0
ak
Âµbn âˆ’b
z âˆ’b
Â¶k
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
Îµ (dist (b, K))n
2
1
dist (b, K)n
=
Îµ
2
and so, letting Qb (z) =
1
(zâˆ’b)n
PM
k=0 ak
Â³
bnâˆ’b
zâˆ’b
Â´k
,
||R âˆ’Qb||K,âˆž
â‰¤
||R âˆ’Qbn||K,âˆž+ ||Qbn âˆ’Qb||K,âˆž
<
Îµ
2 + Îµ
2 = Îµ
showing that b âˆˆS. Since S is both open and closed in V it follows that, since
S Ì¸= âˆ…, S = V . Otherwise V would fail to be connected.
It remains to consider the case where V is unbounded. Pick b âˆˆV large enough
that
Â¯Â¯Â¯z
b
Â¯Â¯Â¯ < 1
2
(28.8)
for all z âˆˆK. From what was just shown, there exists a rational function, Qb having
a pole only at b such that ||Qb âˆ’R||K,âˆž< Îµ
2. It suï¬ƒces to assume that Qb is of the

774
APPROXIMATION BY RATIONAL FUNCTIONS
form
Qb (z)
=
p (z)
(z âˆ’b)n = p (z) (âˆ’1)n 1
bn
1
Â¡
1 âˆ’z
b
Â¢n
=
p (z) (âˆ’1)n 1
bn
Ãƒ âˆž
X
k=0
Â³z
b
Â´k
!n
Then by an application of Corollary 28.7 there exists a partial sum of the power
series for Qb which is uniformly close to Qb on K. Therefore, you can approximate
Qb and therefore also R uniformly on K by a polynomial consisting of a partial sum
of the above inï¬nite sum. This proves the theorem.
If f is a polynomial, then f has a pole at âˆž. This will be discussed more later.
28.1.4
Rungeâ€™s Theorem
Now what follows is the ï¬rst form of Rungeâ€™s theorem.
Theorem 28.9 Let K be a compact subset of an open set, â„¦and let {bj} be a
set which consists of one point from each component of bC \ K. Let f be analytic
on â„¦. Then for each Îµ > 0, there exists a rational function, Q whose poles are all
contained in the set, {bj} such that
||Q âˆ’f||K,âˆž< Îµ.
(28.9)
If bC \ K has only one component, then Q may be taken to be a polynomial.
Proof: By Lemma 28.4 there exists a rational function of the form
R (z) =
M
X
k=1
Ak
wk âˆ’z
where the wk are elements of components of C \ K and Ak are complex numbers
such that
||R âˆ’f||K,âˆž< Îµ
2.
Consider the rational function, Rk (z) â‰¡
Ak
wkâˆ’z where wk âˆˆVj, one of the com-
ponents of C \ K, the given point of Vj being bj. By Lemma 28.8, there exists
a function, Qk which is either a rational function having its only pole at bj or a
polynomial, depending on whether Vj is bounded such that
||Rk âˆ’Qk||K,âˆž<
Îµ
2M .
Letting Q (z) â‰¡PM
k=1 Qk (z) ,
||R âˆ’Q||K,âˆž< Îµ
2.

28.1.
RUNGEâ€™S THEOREM
775
It follows
||f âˆ’Q||K,âˆžâ‰¤||f âˆ’R||K,âˆž+ ||R âˆ’Q||K,âˆž< Îµ.
In the case of only one component of C \ K, this component is the unbounded
component and so you can take Q to be a polynomial. This proves the theorem.
The next version of Rungeâ€™s theorem concerns the case where the given points
are contained in bC \ â„¦for â„¦an open set rather than a compact set. Note that here
there could be uncountably many components of bC \ â„¦because the components are
no longer open sets. An easy example of this phenomenon in one dimension is where
â„¦= [0, 1] \ P for P the Cantor set. Then you can show that R \ â„¦has uncountably
many components. Nevertheless, Rungeâ€™s theorem will follow from Theorem 28.9
with the aid of the following interesting lemma.
Lemma 28.10 Let â„¦be an open set in C. Then there exists a sequence of compact
sets, {Kn} such that
â„¦= âˆªâˆž
k=1Kn, Â· Â· Â·, Kn âŠ†int Kn+1 Â· Â·Â·,
(28.10)
and for any K âŠ†â„¦,
K âŠ†Kn,
(28.11)
for all n suï¬ƒciently large, and every component of bC \ Kn contains a component of
bC \ â„¦.
Proof: Let
Vn â‰¡{z : |z| > n} âˆª
[
z /âˆˆâ„¦
B
Âµ
z, 1
n
Â¶
.
Thus {z : |z| > n} contains the point, âˆž. Now let
Kn â‰¡bC \ Vn = C \ Vn âŠ†â„¦.
You should verify that 28.10 and 28.11 hold. It remains to show that every compo-
nent of bC\Kn contains a component of bC\â„¦. Let D be a component of bC\Kn â‰¡Vn.
If âˆž/âˆˆD, then D contains no point of {z : |z| > n} because this set is connected
and D is a component.
(If it did contain a point of this set, it would have to
contain the whole set.) Therefore, D âŠ†S
z /âˆˆâ„¦
B
Â¡
z, 1
n
Â¢
and so D contains some point
of B
Â¡
z, 1
n
Â¢
for some z /âˆˆâ„¦. Therefore, since this ball is connected, it follows D must
contain the whole ball and consequently D contains some point of â„¦C. (The point
z at the center of the ball will do.) Since D contains z /âˆˆâ„¦, it must contain the
component, Hz, determined by this point. The reason for this is that
Hz âŠ†bC \ â„¦âŠ†bC \ Kn
and Hz is connected.
Therefore, Hz can only have points in one component of
bC \ Kn. Since it has a point in D, it must therefore, be totally contained in D. This
veriï¬es the desired condition in the case where âˆž/âˆˆD.

776
APPROXIMATION BY RATIONAL FUNCTIONS
Now suppose that âˆžâˆˆD. âˆž/âˆˆâ„¦because â„¦is given to be a set in C. Letting
Hâˆždenote the component of bC \ â„¦determined by âˆž, it follows both D and Hâˆž
contain âˆž. Therefore, the connected set, Hâˆžcannot have any points in another
component of bC \ Kn and it is a set which is contained in bC \ Kn so it must be
contained in D. This proves the lemma.
The following picture is a very simple example of the sort of thing considered
by Rungeâ€™s theorem. The picture is of a region which has a couple of holes.
sa1
sa2
â„¦
However, there could be many more holes than two. In fact, there could be
inï¬nitely many. Nor does it follow that the components of the complement of â„¦need
to have any interior points. Therefore, the picture is certainly not representative.
Theorem 28.11 (Runge) Let â„¦be an open set, and let A be a set which has one
point in each component of bC \ â„¦and let f be analytic on â„¦. Then there exists a
sequence of rational functions, {Rn} having poles only in A such that Rn converges
uniformly to f on compact subsets of â„¦.
Proof: Let Kn be the compact sets of Lemma 28.10 where each component of
bC\Kn contains a component of bC\â„¦. It follows each component of bC\Kn contains
a point of A. Therefore, by Theorem 28.9 there exists Rn a rational function with
poles only in A such that
||Rn âˆ’f||Kn,âˆž< 1
n.
It follows, since a given compact set, K is a subset of Kn for all n large enough,
that Rn â†’f uniformly on K. This proves the theorem.
Corollary 28.12 Let â„¦be simply connected and f analytic on â„¦. Then there exists
a sequence of polynomials, {pn} such that pn â†’f uniformly on compact sets of â„¦.
Proof: By deï¬nition of what is meant by simply connected, bC \ â„¦is connected
and so there are no bounded components of bC\â„¦. Therefore, in the proof of Theorem
28.11 when you use Theorem 28.9, you can always have Rn be a polynomial by
Lemma 28.8.
28.2
The Mittag-Leï¬„er Theorem
28.2.1
A Proof From Rungeâ€™s Theorem
This theorem is fairly easy to prove once you have Theorem 28.9.
Given a set of
complex numbers, does there exist a meromorphic function having its poles equal

28.2.
THE MITTAG-LEFFLER THEOREM
777
to this set of numbers? The Mittag-Leï¬„er theorem provides a very satisfactory
answer to this question. Actually, it says somewhat more. You can specify, not just
the location of the pole but also the kind of singularity the meromorphic function
is to have at that pole.
Theorem 28.13 Let P â‰¡{zk}âˆž
k=1 be a set of points in an open subset of C, â„¦.
Suppose also that P âŠ†â„¦âŠ†C. For each zk, denote by Sk (z) a function of the form
Sk (z) =
mk
X
j=1
ak
j
(z âˆ’zk)j .
Then there exists a meromorphic function, Q deï¬ned on â„¦such that the poles of
Q are the points, {zk}âˆž
k=1 and the singular part of the Laurent expansion of Q at
zk equals Sk (z) . In other words, for z near zk, Q (z) = gk (z) + Sk (z) for some
function, gk analytic near zk.
Proof: Let {Kn} denote the sequence of compact sets described in Lemma
28.10. Thus âˆªâˆž
n=1Kn = â„¦, Kn âŠ†int (Kn+1) âŠ†Kn+1 Â· Â·Â·, and the components of
bC\Kn contain the components of bC\â„¦. Renumbering if necessary, you can assume
each Kn Ì¸= âˆ…. Also let K0 = âˆ…. Let Pm â‰¡P âˆ©(Km \ Kmâˆ’1) and consider the
rational function, Rm deï¬ned by
Rm (z) â‰¡
X
zkâˆˆKm\Kmâˆ’1
Sk (z) .
Since each Km is compact, it follows Pm is ï¬nite and so the above really is a
rational function. Now for m > 1,this rational function is analytic on some open
set containing Kmâˆ’1. There exists a set of points, A one point in each component
of bC\â„¦. Consider bC\Kmâˆ’1. Each of its components contains a component of bC\â„¦
and so for each of these components of bC \ Kmâˆ’1, there exists a point of A which
is contained in it. Denote the resulting set of points by Aâ€². By Theorem 28.9 there
exists a rational function, Qm whose poles are all contained in the set, Aâ€² âŠ†â„¦C
such that
||Rm âˆ’Qm||Kmâˆ’1,âˆž< 1
2m .
The meromorphic function is
Q (z) â‰¡R1 (z) +
âˆž
X
k=2
(Rk (z) âˆ’Qk (z)) .
It remains to verify this function works. First consider K1. Then on K1, the above
sum converges uniformly. Furthermore, the terms of the sum are analytic in some
open set containing K1. Therefore, the inï¬nite sum is analytic on this open set and
so for z âˆˆK1 The function, f is the sum of a rational function, R1, having poles at

778
APPROXIMATION BY RATIONAL FUNCTIONS
P1 with the speciï¬ed singular terms and an analytic function. Therefore, Q works
on K1. Now consider Km for m > 1. Then
Q (z) = R1 (z) +
m+1
X
k=2
(Rk (z) âˆ’Qk (z)) +
âˆž
X
k=m+2
(Rk (z) âˆ’Qk (z)) .
As before, the inï¬nite sum converges uniformly on Km+1 and hence on some open
set, O containing Km.
Therefore, this inï¬nite sum equals a function which is
analytic on O. Also,
R1 (z) +
m+1
X
k=2
(Rk (z) âˆ’Qk (z))
is a rational function having poles at âˆªm
k=1Pk with the speciï¬ed singularities because
the poles of each Qk are not in â„¦. It follows this function is meromorphic because
it is analytic except for the points in P. It also has the property of retaining the
speciï¬ed singular behavior.
28.2.2
A Direct Proof Without Rungeâ€™s Theorem
There is a direct proof of this important theorem which is not dependent on Rungeâ€™s
theorem in the case where â„¦= C. I think it is arguably easier to understand and
the Mittag-Leï¬„er theorem is very important so I will give this proof here.
Theorem 28.14 Let P â‰¡{zk}âˆž
k=1 be a set of points in C which satisï¬es limnâ†’âˆž|zn| =
âˆž. For each zk, denote by Sk (z) a polynomial in
1
zâˆ’zk which is of the form
Sk (z) =
mk
X
j=1
ak
j
(z âˆ’zk)j .
Then there exists a meromorphic function, Q deï¬ned on C such that the poles of Q
are the points, {zk}âˆž
k=1 and the singular part of the Laurent expansion of Q at zk
equals Sk (z) . In other words, for z near zk,
Q (z) = gk (z) + Sk (z)
for some function, gk analytic in some open set containing zk.
Proof: First consider the case where none of the zk = 0. Letting
Kk â‰¡{z : |z| â‰¤|zk| /2} ,
there exists a power series for
1
zâˆ’zk which converges uniformly and absolutely on
this set. Here is why:
1
z âˆ’zk
=
Ãƒ
âˆ’1
1 âˆ’z
zk
!
1
zk
= âˆ’1
zk
âˆž
X
l=0
Âµ z
zk
Â¶l

28.2.
THE MITTAG-LEFFLER THEOREM
779
and the Weierstrass M test can be applied because
Â¯Â¯Â¯Â¯
z
zk
Â¯Â¯Â¯Â¯ < 1
2
on this set. Therefore, by Corollary 28.7, Sk (z) , being a polynomial in
1
zâˆ’zk , has
a power series which converges uniformly to Sk (z) on Kk. Therefore, there exists a
polynomial, Pk (z) such that
||Pk âˆ’Sk||B(0,|zk|/2),âˆž< 1
2k .
Let
Q (z) â‰¡
âˆž
X
k=1
(Sk (z) âˆ’Pk (z)) .
(28.12)
Consider z âˆˆKm and let N be large enough that if k > N, then |zk| > 2 |z|
Q (z) =
N
X
k=1
(Sk (z) âˆ’Pk (z)) +
âˆž
X
k=N+1
(Sk (z) âˆ’Pk (z)) .
On Km, the second sum converges uniformly to a function analytic on int (Km)
(interior of Km) while the ï¬rst is a rational function having poles at z1, Â· Â· Â·, zN.
Since any compact set is contained in Km for large enough m, this shows Q (z) is
meromorphic as claimed and has poles with the given singularities.
Now consider the case where the poles are at {zk}âˆž
k=0 with z0 = 0. Everything
is similar in this case. Let
Q (z) â‰¡S0 (z) +
âˆž
X
k=1
(Sk (z) âˆ’Pk (z)) .
The series converges uniformly on every compact set because of the assumption
that limnâ†’âˆž|zn| = âˆžwhich implies that any compact set is contained in Kk for
k large enough. Choose N such that z âˆˆint(KN) and zn /âˆˆKN for all n â‰¥N + 1.
Then
Q (z) = S0 (z) +
N
X
k=1
(Sk (z) âˆ’Pk (z)) +
âˆž
X
k=N+1
(Sk (z) âˆ’Pk (z)) .
The last sum is analytic on int(KN) because each function in the sum is analytic due
to the fact that none of its poles are in KN. Also, S0 (z)+PN
k=1 (Sk (z) âˆ’Pk (z)) is
a ï¬nite sum of rational functions so it is a rational function and Pk is a polynomial
so zm is a pole of this function with the correct singularity whenever zm âˆˆint (KN).

780
APPROXIMATION BY RATIONAL FUNCTIONS
28.2.3
Functions Meromorphic On bC
Sometimes it is useful to think of isolated singular points at âˆž.
Deï¬nition 28.15 Suppose f is analytic on {z âˆˆC : |z| > r} . Then f is said to
have a removable singularity at âˆžif the function, g (z) â‰¡f
Â¡ 1
z
Â¢
has a removable
singularity at 0. f is said to have a pole at âˆžif the function, g (z) = f
Â¡ 1
z
Â¢
has a
pole at 0. Then f is said to be meromorphic on bC if all its singularities are isolated
and either poles or removable.
So what is f like for these cases? First suppose f has a removable singularity
at âˆž. Then zg (z) converges to 0 as z â†’0. It follows g (z) must be analytic near
0 and so can be given as a power series. Thus f (z) is of the form f (z) = g
Â¡ 1
z
Â¢
=
Pâˆž
n=0 an
Â¡ 1
z
Â¢n . Next suppose f has a pole at âˆž. This means g (z) has a pole at 0 so
g (z) is of the form g (z) = Pm
k=1
bk
zk +h (z) where h (z) is analytic near 0. Thus in the
case of a pole at âˆž, f (z) is of the form f (z) = g
Â¡ 1
z
Â¢
= Pm
k=1 bkzk +Pâˆž
n=0 an
Â¡ 1
z
Â¢n.
It turns out that the functions which are meromorphic on bC are all rational
functions. To see this suppose f is meromorphic on bC and note that there exists
r > 0 such that f (z) is analytic for |z| > r. This is required if âˆžis to be isolated.
Therefore, there are only ï¬nitely many poles of f for |z| â‰¤r, {a1, Â· Â· Â·, am} , because
by assumption, these poles are isolated and this is a compact set. Let the singular
part of f at ak be denoted by Sk (z) . Then f (z) âˆ’Pm
k=1 Sk (z) is analytic on all of
C. Therefore, it is bounded on |z| â‰¤r. In one case, f has a removable singularity at
âˆž. In this case, f is bounded as z â†’âˆžand P
k Sk also converges to 0 as z â†’âˆž.
Therefore, by Liouvilleâ€™s theorem, f (z) âˆ’Pm
k=1 Sk (z) equals a constant and so
f âˆ’P
k Sk is a constant. Thus f is a rational function. In the other case that f has
a pole at âˆž, f (z)âˆ’Pm
k=1 Sk (z)âˆ’Pm
k=1 bkzk = Pâˆž
n=0 an
Â¡ 1
z
Â¢n âˆ’Pm
k=1 Sk (z) . Now
f (z) âˆ’Pm
k=1 Sk (z) âˆ’Pm
k=1 bkzk is analytic on C and so is bounded on |z| â‰¤r. But
now Pâˆž
n=0 an
Â¡ 1
z
Â¢n âˆ’Pm
k=1 Sk (z) converges to 0 as z â†’âˆžand so by Liouvilleâ€™s
theorem, f (z) âˆ’Pm
k=1 Sk (z) âˆ’Pm
k=1 bkzk must equal a constant and again, f (z)
equals a rational function.
28.2.4
A Great And Glorious Theorem About Simply Con-
nected Regions
Here is given a laundry list of properties which are equivalent to an open set being
simply connected. Recall Deï¬nition 24.48 on Page 673 which said that an open
set, â„¦is simply connected means bC \ â„¦is connected. Recall also that this is not
the same thing at all as saying C \ â„¦is connected. Consider the outside of a disk
for example. I will continue to use this deï¬nition for simply connected because it
is the most convenient one for complex analysis. However, there are many other
equivalent conditions. First here is an interesting lemma which is interesting for
its own sake. Recall n (p, Î³) means the winding number of Î³ about p. Now recall
Theorem 24.52 implies the following lemma in which BC is playing the role of â„¦in
Theorem 24.52.

28.2.
THE MITTAG-LEFFLER THEOREM
781
Lemma 28.16 Let K be a compact subset of BC, the complement of a closed set.
Then there exist continuous, closed, bounded variation oriented curves {Î“j}m
j=1 for
which Î“âˆ—
j âˆ©K = âˆ…for each j, Î“âˆ—
j âŠ†â„¦, and for all p âˆˆK,
m
X
k=1
n (Î“k, p) = 1.
while for all z âˆˆB
m
X
k=1
n (Î“k, z) = 0.
Deï¬nition 28.17 Let Î³ be a closed curve in an open set, â„¦, Î³ : [a, b] â†’â„¦. Then
Î³ is said to be homotopic to a point, p in â„¦if there exists a continuous function,
H : [0, 1]Ã—[a, b] â†’â„¦such that H (0, t) = p, H (Î±, a) = H (Î±, b) , and H (1, t) = Î³ (t) .
This function, H is called a homotopy.
Lemma 28.18 Suppose Î³ is a closed continuous bounded variation curve in an
open set, â„¦which is homotopic to a point. Then if a /âˆˆâ„¦, it follows n (a, Î³) = 0.
Proof: Let H be the homotopy described above. The problem with this is
that it is not known that H (Î±, Â·) is of bounded variation. There is no reason it
should be. Therefore, it might not make sense to take the integral which deï¬nes
the winding number. There are various ways around this. Extend H as follows.
H (Î±, t) = H (Î±, a) for t < a, H (Î±, t) = H (Î±, b) for t > b. Let Îµ > 0.
HÎµ (Î±, t) â‰¡1
2Îµ
Z t+
2Îµ
(bâˆ’a) (tâˆ’a)
âˆ’2Îµ+t+
2Îµ
(bâˆ’a) (tâˆ’a)
H (Î±, s) ds, HÎµ (0, t) = p.
Thus HÎµ (Î±, Â·) is a closed curve which has bounded variation and when Î± = 1, this
converges to Î³ uniformly on [a, b]. Therefore, for Îµ small enough, n (a, HÎµ (1, Â·)) =
n (a, Î³) because they are both integers and as Îµ â†’0, n (a, HÎµ (1, Â·)) â†’n (a, Î³) . Also,
HÎµ (Î±, t) â†’H (Î±, t) uniformly on [0, 1] Ã— [a, b] because of uniform continuity of H.
Therefore, for small enough Îµ, you can also assume HÎµ (Î±, t) âˆˆâ„¦for all Î±, t. Now
Î± â†’n (a, HÎµ (Î±, Â·)) is continuous. Hence it must be constant because the winding
number is integer valued. But
lim
Î±â†’0
1
2Ï€i
Z
HÎµ(Î±,Â·)
1
z âˆ’adz = 0
because the length of HÎµ (Î±, Â·) converges to 0 and the integrand is bounded because
a /âˆˆâ„¦. Therefore, the constant can only equal 0. This proves the lemma.
Now it is time for the great and glorious theorem on simply connected regions.
The following equivalence of properties is taken from Rudin [45]. There is a slightly
diï¬€erent list in Conway [13] and a shorter list in Ash [6].
Theorem 28.19 The following are equivalent for an open set, â„¦.

782
APPROXIMATION BY RATIONAL FUNCTIONS
1. â„¦is homeomorphic to the unit disk, B (0, 1) .
2. Every closed curve contained in â„¦is homotopic to a point in â„¦.
3. If z /âˆˆâ„¦, and if Î³ is a closed bounded variation continuous curve in â„¦, then
n (Î³, z) = 0.
4. â„¦is simply connected, (bC \ â„¦is connected and â„¦is connected. )
5. Every function analytic on â„¦can be uniformly approximated by polynomials
on compact subsets.
6. For every f analytic on â„¦and every closed continuous bounded variation
curve, Î³,
Z
Î³
f (z) dz = 0.
7. Every function analytic on â„¦has a primitive on â„¦.
8. If f, 1/f are both analytic on â„¦, then there exists an analytic, g on â„¦such
that f = exp (g) .
9. If f, 1/f are both analytic on â„¦, then there exists Ï† analytic on â„¦such that
f = Ï†2.
Proof: 1â‡’2. Assume 1 and let Î³ be a closed curve in â„¦. Let h be the homeo-
morphism, h : B (0, 1) â†’â„¦. Let H (Î±, t) = h
Â¡
Î±
Â¡
hâˆ’1Î³ (t)
Â¢Â¢
. This works.
2â‡’3 This is Lemma 28.18.
3â‡’4. Suppose 3 but 4 fails to hold. Then if bC \ â„¦is not connected, there exist
disjoint nonempty sets, A and B such that A âˆ©B = A âˆ©B = âˆ…. It follows each
of these sets must be closed because neither can have a limit point in â„¦nor in
the other. Also, one and only one of them contains âˆž. Let this set be B. Thus
A is a closed set which must also be bounded.
Otherwise, there would exist a
sequence of points in A, {an} such that limnâ†’âˆžan = âˆžwhich would contradict
the requirement that no limit points of A can be in B. Therefore, A is a compact
set contained in the open set, BC â‰¡{z âˆˆC : z /âˆˆB} . Pick p âˆˆA. By Lemma 28.16
there exist continuous bounded variation closed curves {Î“k}m
k=1 which are contained
in BC, do not intersect A and such that
1 =
m
X
k=1
n (p, Î“k)
However, if these curves do not intersect A and they also do not intersect B then
they must be all contained in â„¦. Since p /âˆˆâ„¦, it follows by 3 that for each k,
n (p, Î“k) = 0, a contradiction.
4â‡’5 This is Corollary 28.12 on Page 776.

28.2.
THE MITTAG-LEFFLER THEOREM
783
5â‡’6 Every polynomial has a primitive and so the integral over any closed
bounded variation curve of a polynomial equals 0. Let f be analytic on â„¦. Then let
{fn} be a sequence of polynomials converging uniformly to f on Î³âˆ—. Then
0 = lim
nâ†’âˆž
Z
Î³
fn (z) dz =
Z
Î³
f (z) dz.
6â‡’7 Pick z0 âˆˆâ„¦. Letting Î³ (z0, z) be a bounded variation continuous curve
joining z0 to z in â„¦, you deï¬ne a primitive for f as follows.
F (z) =
Z
Î³(z0,z)
f (w) dw.
This is well deï¬ned by 6 and is easily seen to be a primitive. You just write the
diï¬€erence quotient and take a limit using 6.
lim
wâ†’0
F (z + w) âˆ’F (z)
w
=
lim
wâ†’0
1
w
ÃƒZ
Î³(z0,z+w)
f (u) du âˆ’
Z
Î³(z0,z)
f (u) du
!
=
lim
wâ†’0
1
w
Z
Î³(z,z+w)
f (u) du
=
lim
wâ†’0
1
w
Z 1
0
f (z + tw) wdt = f (z) .
7â‡’8 Suppose then that f, 1/f are both analytic. Then f â€²/f is analytic and so
it has a primitive by 7. Let this primitive be g1. Then
Â¡
eâˆ’g1f
Â¢â€²
=
eâˆ’g1 (âˆ’gâ€²
1) f + eâˆ’g1f â€²
=
âˆ’eâˆ’g1
Âµf â€²
f
Â¶
f + eâˆ’g1f â€² = 0.
Therefore, since â„¦is connected, it follows eâˆ’g1f must equal a constant. (Why?)
Let the constant be ea+ibi. Then f (z) = eg1(z)ea+ib. Therefore, you let g (z) =
g1 (z) + a + ib.
8â‡’9 Suppose then that f, 1/f are both analytic on â„¦. Then by 8 f (z) = eg(z).
Let Ï† (z) â‰¡eg(z)/2.
9â‡’1 There are two cases.
First suppose â„¦= C.
This satisï¬es condition 9
because if f, 1/f are both analytic, then the same argument involved in 8â‡’9 gives
the existence of a square root. A homeomorphism is h (z) â‰¡
z
âˆš
1+|z|2 . It obviously
maps onto B (0, 1) and is continuous. To see it is 1 - 1 consider the case of z1
and z2 having diï¬€erent arguments. Then h (z1) Ì¸= h (z2) . If z2 = tz1 for a positive
t Ì¸= 1, then it is also clear h (z1) Ì¸= h (z2) . To show hâˆ’1 is continuous, note that if
you have an open set in C and a point in this open set, you can get a small open
set containing this point by allowing the modulus and the argument to lie in some
open interval. Reasoning this way, you can verify h maps open sets to open sets. In
the case where â„¦Ì¸= C, there exists a one to one analytic map which maps â„¦onto
B (0, 1) by the Riemann mapping theorem. This proves the theorem.

784
APPROXIMATION BY RATIONAL FUNCTIONS
28.3
Exercises
1. Let a âˆˆC.
Show there exists a sequence of polynomials, {pn} such that
pn (a) = 1 but pn (z) â†’0 for all z Ì¸= a.
2. Let l be a line in C. Show there exists a sequence of polynomials {pn} such
that pn (z) â†’1 on one side of this line and pn (z) â†’âˆ’1 on the other side of
the line. Hint: The complement of this line is simply connected.
3. Suppose â„¦is a simply connected region, f is analytic on â„¦, f Ì¸= 0 on â„¦, and
n âˆˆN. Show that there exists an analytic function, g such that g (z)n = f (z)
for all z âˆˆâ„¦. That is, you can take the nth root of f (z) . If â„¦is a region
which contains 0, is it possible to ï¬nd g (z) such that g is analytic on â„¦and
g (z)2 = z?
4. Suppose â„¦is a region (connected open set) and f is an analytic function
deï¬ned on â„¦such that f (z) Ì¸= 0 for any z âˆˆâ„¦. Suppose also that for every
positive integer, n there exists an analytic function, gn deï¬ned on â„¦such that
gn
n (z) = f (z) . Show that then it is possible to deï¬ne an analytic function, L
on f (â„¦) such that eL(f(z)) = f (z) for all z âˆˆâ„¦.
5. You know that Ï† (z) â‰¡zâˆ’i
z+i maps the upper half plane onto the unit ball. Its
inverse, Ïˆ (z) = i 1+z
1âˆ’z maps the unit ball onto the upper half plane. Also for z
in the upper half plane, you can deï¬ne a square root as follows. If z = |z| eiÎ¸
where Î¸ âˆˆ(0, Ï€) , let z1/2 â‰¡|z|1/2 eiÎ¸/2 so the square root maps the upper half
plane to the ï¬rst quadrant. Now consider
z â†’exp
Ãƒ
âˆ’i log
Â·
i
Âµ1 + z
1 âˆ’z
Â¶Â¸1/2!
.
(28.13)
Show this is an analytic function which maps the unit ball onto an annulus.
Is it possible to ï¬nd a one to one analytic map which does this?

Inï¬nite Products
The Mittag-Leï¬„er theorem gives existence of a meromorphic function which has
speciï¬ed singular part at various poles. It would be interesting to do something
similar to zeros of an analytic function. That is, given the order of the zero at
various points, does there exist an analytic function which has these points as zeros
with the speciï¬ed orders? You know that if you have the zeros of the polynomial,
you can factor it.
Can you do something similar with analytic functions which
are just limits of polynomials? These questions involve the concept of an inï¬nite
product.
Deï¬nition 29.1 Qâˆž
n=1 (1 + un) â‰¡limnâ†’âˆž
Qn
k=1 (1 + uk) whenever this limit ex-
ists. If un = un (z) for z âˆˆH, we say the inï¬nite product converges uniformly on
H if the partial products, Qn
k=1 (1 + uk (z)) converge uniformly on H.
The main theorem is the following.
Theorem 29.2 Let H âŠ†C and suppose that Pâˆž
n=1 |un (z)| converges uniformly on
H where un (z) bounded on H. Then
P (z) â‰¡
âˆž
Y
n=1
(1 + un (z))
converges uniformly on H. If (n1, n2, Â· Â· Â·) is any permutation of (1, 2, Â· Â· Â·) , then for
all z âˆˆH,
P (z) =
âˆž
Y
k=1
(1 + unk (z))
and P has a zero at z0 if and only if un (z0) = âˆ’1 for some n.
785

786
INFINITE PRODUCTS
Proof: First a simple estimate:
n
Y
k=m
(1 + |uk (z)|)
=
exp
Ãƒ
ln
Ãƒ
n
Y
k=m
(1 + |uk (z)|)
!!
= exp
Ãƒ
n
X
k=m
ln (1 + |uk (z)|)
!
â‰¤
exp
Ãƒ âˆž
X
k=m
|uk (z)|
!
< e
for all z âˆˆH provided m is large enough. Since Pâˆž
k=1 |uk (z)| converges uniformly
on H, |uk (z)| < 1
2 for all z âˆˆH provided k is large enough. Thus you can take
log (1 + uk (z)) . Pick N0 such that for n > m â‰¥N0,
|um (z)| < 1
2,
n
Y
k=m
(1 + |uk (z)|) < e.
(29.1)
Now having picked N0, the assumption the un are bounded on H implies there
exists a constant, C, independent of z âˆˆH such that for all z âˆˆH,
N0
Y
k=1
(1 + |uk (z)|) < C.
(29.2)
Let N0 < M < N. Then
Â¯Â¯Â¯Â¯Â¯
N
Y
k=1
(1 + uk (z)) âˆ’
M
Y
k=1
(1 + uk (z))
Â¯Â¯Â¯Â¯Â¯
â‰¤
N0
Y
k=1
(1 + |uk (z)|)
Â¯Â¯Â¯Â¯Â¯
N
Y
k=N0+1
(1 + uk (z)) âˆ’
M
Y
k=N0+1
(1 + uk (z))
Â¯Â¯Â¯Â¯Â¯
â‰¤
C
Â¯Â¯Â¯Â¯Â¯
N
Y
k=N0+1
(1 + uk (z)) âˆ’
M
Y
k=N0+1
(1 + uk (z))
Â¯Â¯Â¯Â¯Â¯
â‰¤
C
Ãƒ
M
Y
k=N0+1
(1 + |uk (z)|)
! Â¯Â¯Â¯Â¯Â¯
N
Y
k=M+1
(1 + uk (z)) âˆ’1
Â¯Â¯Â¯Â¯Â¯
â‰¤
Ce
Â¯Â¯Â¯Â¯Â¯
N
Y
k=M+1
(1 + |uk (z)|) âˆ’1
Â¯Â¯Â¯Â¯Â¯ .

787
Since 1 â‰¤QN
k=M+1 (1 + |uk (z)|) â‰¤e, it follows the term on the far right is domi-
nated by
Ce2
Â¯Â¯Â¯Â¯Â¯ln
Ãƒ
N
Y
k=M+1
(1 + |uk (z)|)
!
âˆ’ln 1
Â¯Â¯Â¯Â¯Â¯
â‰¤
Ce2
N
X
k=M+1
ln (1 + |uk (z)|)
â‰¤
Ce2
N
X
k=M+1
|uk (z)| < Îµ
uniformly in z âˆˆH provided M is large enough. This follows from the simple obser-
vation that if 1 < x < e, then xâˆ’1 â‰¤e (ln x âˆ’ln 1). Therefore, {Qm
k=1 (1 + uk (z))}âˆž
m=1
is uniformly Cauchy on H and therefore, converges uniformly on H. Let P (z) denote
the function it converges to.
What about the permutations? Let {n1, n2, Â· Â· Â·} be a permutation of the indices.
Let Îµ > 0 be given and let N0 be such that if n > N0,
Â¯Â¯Â¯Â¯Â¯
n
Y
k=1
(1 + uk (z)) âˆ’P (z)
Â¯Â¯Â¯Â¯Â¯ < Îµ
for all z âˆˆH. Let {1, 2, Â· Â· Â·, n} âŠ†
Â©
n1, n2, Â· Â· Â·, np(n)
Âª
where p (n) is an increasing
sequence. Then from 29.1 and 29.2,
Â¯Â¯Â¯Â¯Â¯Â¯
P (z) âˆ’
p(n)
Y
k=1
(1 + unk (z))
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯P (z) âˆ’
n
Y
k=1
(1 + uk (z))
Â¯Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯Â¯Â¯
n
Y
k=1
(1 + uk (z)) âˆ’
p(n)
Y
k=1
(1 + unk (z))
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
Îµ +
Â¯Â¯Â¯Â¯Â¯Â¯
n
Y
k=1
(1 + uk (z)) âˆ’
p(n)
Y
k=1
(1 + unk (z))
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
Îµ +
Â¯Â¯Â¯Â¯Â¯
n
Y
k=1
(1 + |uk (z)|)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯1 âˆ’
Y
nk>n
(1 + unk (z))
Â¯Â¯Â¯Â¯Â¯
â‰¤
Îµ +
Â¯Â¯Â¯Â¯Â¯
N0
Y
k=1
(1 + |uk (z)|)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
Y
k=N0+1
(1 + |uk (z)|)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯1 âˆ’
Y
nk>n
(1 + unk (z))
Â¯Â¯Â¯Â¯Â¯
â‰¤
Îµ + Ce
Â¯Â¯Â¯Â¯Â¯
Y
nk>n
(1 + |unk (z)|) âˆ’1
Â¯Â¯Â¯Â¯Â¯ â‰¤Îµ + Ce
Â¯Â¯Â¯Â¯Â¯Â¯
M(p(n))
Y
k=n+1
(1 + |unk (z)|) âˆ’1
Â¯Â¯Â¯Â¯Â¯Â¯

788
INFINITE PRODUCTS
where M (p (n)) is the largest index in the permuted list,
Â©
n1, n2, Â· Â· Â·, np(n)
Âª
. then
from 29.1, this last term is dominated by
Îµ + Ce2
Â¯Â¯Â¯Â¯Â¯Â¯
ln
ï£«
ï£­
M(p(n))
Y
k=n+1
(1 + |unk (z)|)
ï£¶
ï£¸âˆ’ln 1
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤
Îµ + Ce2
âˆž
X
k=n+1
ln (1 + |unk|) â‰¤Îµ + Ce2
âˆž
X
k=n+1
|unk| < 2Îµ
for all n large enough uniformly in z âˆˆH. Therefore,
Â¯Â¯Â¯P (z) âˆ’Qp(n)
k=1 (1 + unk (z))
Â¯Â¯Â¯ <
2Îµ whenever n is large enough. This proves the part about the permutation.
It remains to verify the assertion about the points, z0, where P (z0) = 0. Obvi-
ously, if un (z0) = âˆ’1, then P (z0) = 0. Suppose then that P (z0) = 0 and M > N0.
Then
Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0)) âˆ’
âˆž
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯1 âˆ’
âˆž
Y
k=M+1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
âˆž
Y
k=M+1
(1 + |uk (z0)|) âˆ’1
Â¯Â¯Â¯Â¯Â¯
â‰¤
e
Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ln
âˆž
Y
k=M+1
(1 + |uk (z0)|) âˆ’ln 1
Â¯Â¯Â¯Â¯Â¯
â‰¤
e
Ãƒ
âˆž
X
k=M+1
ln (1 + |uk (z)|)
! Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
â‰¤
e
âˆž
X
k=M+1
|uk (z)|
Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
â‰¤
1
2
Â¯Â¯Â¯Â¯Â¯
M
Y
k=1
(1 + uk (z0))
Â¯Â¯Â¯Â¯Â¯
whenever M is large enough. Therefore, for such M,
M
Y
k=1
(1 + uk (z0)) = 0
and so uk (z0) = âˆ’1 for some k â‰¤M. This proves the theorem.

29.1.
ANALYTIC FUNCTION WITH PRESCRIBED ZEROS
789
29.1
Analytic Function With Prescribed Zeros
Suppose you are given complex numbers, {zn} and you want to ï¬nd an analytic
function, f such that these numbers are the zeros of f. How can you do it? The
problem is easy if there are only ï¬nitely many of these zeros, {z1, z2, Â· Â· Â·, zm} . You
just write (z âˆ’z1) (z âˆ’z2) Â· Â· Â· (z âˆ’zm) . Now if none of the zk = 0 you could
also write it at Qm
k=1
Â³
1 âˆ’z
zk
Â´
and this might have a better chance of success in
the case of inï¬nitely many prescribed zeros. However, you would need to verify
something like Pâˆž
n=1
Â¯Â¯Â¯ z
zn
Â¯Â¯Â¯ < âˆžwhich might not be so. The way around this is to
adjust the product, making it Qâˆž
k=1
Â³
1 âˆ’z
zk
Â´
egk(z) where gk (z) is some analytic
function. Recall also that for |x| < 1, ln
Â³
(1 âˆ’x)âˆ’1Â´
= Pâˆž
n=1
xn
n . If you had x/xn
small and real, then 1 = (1 âˆ’x/xn) exp
Â³
ln
Â³
(1 âˆ’x/xn)âˆ’1Â´Â´
and Qâˆž
k=1 1 of course
converges but loses all the information about zeros. However, this is why it is not
too unreasonable to consider factors of the form
Âµ
1 âˆ’z
zk
Â¶
e
Ppk
k=1
Â³
z
zk
Â´k 1
k
where pk is suitably chosen.
First here are some estimates.
Lemma 29.3 For z âˆˆC,
|ez âˆ’1| â‰¤|z| e|z|,
(29.3)
and if |z| â‰¤1/2,
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=m
zk
k
Â¯Â¯Â¯Â¯Â¯ â‰¤1
m
|z|m
1 âˆ’|z| â‰¤2
m |z|m â‰¤1
m
1
2mâˆ’1 .
(29.4)
Proof: Consider 29.3.
|ez âˆ’1| =
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=1
zk
k!
Â¯Â¯Â¯Â¯Â¯ â‰¤
âˆž
X
k=1
|z|k
k! = e|z| âˆ’1 â‰¤|z| e|z|
the last inequality holding by the mean value theorem. Now consider 29.4.
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=m
zk
k
Â¯Â¯Â¯Â¯Â¯
â‰¤
âˆž
X
k=m
|z|k
k
â‰¤1
m
âˆž
X
k=m
|z|k
=
1
m
|z|m
1 âˆ’|z| â‰¤2
m |z|m â‰¤1
m
1
2mâˆ’1 .
This proves the lemma.
The functions, Ep in the next deï¬nition are called the elementary factors.

790
INFINITE PRODUCTS
Deï¬nition 29.4 Let E0 (z) â‰¡1 âˆ’z and for p â‰¥1,
Ep (z) â‰¡(1 âˆ’z) exp
Âµ
z + z2
2 + Â· Â· Â· + zp
p
Â¶
In terms of this new symbol, here is another estimate. A sharper inequality is
available in Rudin [45] but it is more diï¬ƒcult to obtain.
Corollary 29.5 For Ep deï¬ned above and |z| â‰¤1/2,
|Ep (z) âˆ’1| â‰¤3 |z|p+1 .
Proof:
From elementary calculus, ln (1 âˆ’x) = âˆ’Pâˆž
n=1
xn
n
for all |x| < 1.
Therefore, for |z| < 1,
log (1 âˆ’z) = âˆ’
âˆž
X
n=1
zn
n , log
Â³
(1 âˆ’z)âˆ’1Â´
=
âˆž
X
n=1
zn
n ,
because the function log (1 âˆ’z) and the analytic function, âˆ’Pâˆž
n=1
zn
n both are
equal to ln (1 âˆ’x) on the real line segment (âˆ’1, 1) , a set which has a limit point.
Therefore, using Lemma 29.3,
|Ep (z) âˆ’1|
=
Â¯Â¯Â¯Â¯(1 âˆ’z) exp
Âµ
z + z2
2 + Â· Â· Â· + zp
p
Â¶
âˆ’1
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯(1 âˆ’z) exp
Ãƒ
log
Â³
(1 âˆ’z)âˆ’1Â´
âˆ’
âˆž
X
n=p+1
zn
n
!
âˆ’1
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯exp
Ãƒ
âˆ’
âˆž
X
n=p+1
zn
n
!
âˆ’1
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯âˆ’
âˆž
X
n=p+1
zn
n
Â¯Â¯Â¯Â¯Â¯ e|âˆ’Pâˆž
n=p+1
zn
n |
â‰¤
1
p + 1 Â· 2 Â· e1/(p+1) |z|p+1 . â‰¤3 |z|p+1
This proves the corollary.
With this estimate, it is easy to prove the Weierstrass product formula.
Theorem 29.6 Let {zn} be a sequence of nonzero complex numbers which have no
limit point in C and let {pn} be a sequence of nonnegative integers such that
âˆž
X
n=1
Âµ R
|zn|
Â¶pn+1
< âˆž
(29.5)

29.1.
ANALYTIC FUNCTION WITH PRESCRIBED ZEROS
791
for all R âˆˆR. Then
P (z) â‰¡
âˆž
Y
n=1
Epn
Âµ z
zn
Â¶
is analytic on C and has a zero at each point, zn and at no others. If w occurs m
times in {zn} , then P has a zero of order m at w.
Proof: Since {zn} has no limit point, it follows limnâ†’âˆž|zn| = âˆž. Therefore,
if pn = n âˆ’1 the condition, 29.5 holds for this choice of pn. Now by Theorem 29.2,
the inï¬nite product in this theorem will converge uniformly on |z| â‰¤R if the same
is true of the sum,
âˆž
X
n=1
Â¯Â¯Â¯Â¯Epn
Âµ z
zn
Â¶
âˆ’1
Â¯Â¯Â¯Â¯ .
(29.6)
But by Corollary 29.5 the nth term of this sum satisï¬es
Â¯Â¯Â¯Â¯Epn
Âµ z
zn
Â¶
âˆ’1
Â¯Â¯Â¯Â¯ â‰¤3
Â¯Â¯Â¯Â¯
z
zn
Â¯Â¯Â¯Â¯
pn+1
.
Since |zn| â†’âˆž, there exists N such that for n > N, |zn| > 2R. Therefore, for
|z| < R and letting 0 < a = min {|zn| : n â‰¤N} ,
âˆž
X
n=1
Â¯Â¯Â¯Â¯Epn
Âµ z
zn
Â¶
âˆ’1
Â¯Â¯Â¯Â¯
â‰¤
3
N
X
n=1
Â¯Â¯Â¯Â¯
R
a
Â¯Â¯Â¯Â¯
pn+1
+3
âˆž
X
n=N
Âµ R
2R
Â¶pn+1
<
âˆž.
By the Weierstrass M test, the series in 29.6 converges uniformly for |z| < R and so
the same is true of the inï¬nite product. It follows from Lemma 24.18 on Page 652
that P (z) is analytic on |z| < R because it is a uniform limit of analytic functions.
Also by Theorem 29.2 the zeros of the analytic P (z) are exactly the points,
{zn} , listed according to multiplicity. That is, if zn is a zero of order m, then if it
is listed m times in the formula for P (z) , then it is a zero of order m for P. This
proves the theorem.
The following corollary is an easy consequence and includes the case where there
is a zero at 0.
Corollary 29.7 Let {zn} be a sequence of nonzero complex numbers which have
no limit point and let {pn} be a sequence of nonnegative integers such that
âˆž
X
n=1
Âµ r
|zn|
Â¶1+pn
< âˆž
(29.7)
for all r âˆˆR. Then
P (z) â‰¡zm
âˆž
Y
n=1
Epn
Âµ z
zn
Â¶

792
INFINITE PRODUCTS
is analytic â„¦and has a zero at each point, zn and at no others along with a zero of
order m at 0. If w occurs m times in {zn} , then P has a zero of order m at w.
The above theory can be generalized to include the case of an arbitrary open
set. First, here is a lemma.
Lemma 29.8 Let â„¦be an open set. Also let {zn} be a sequence of points in â„¦
which is bounded and which has no point repeated more than ï¬nitely many times
such that {zn} has no limit point in â„¦. Then there exist {wn} âŠ†âˆ‚â„¦such that
limnâ†’âˆž|zn âˆ’wn| = 0.
Proof: Since âˆ‚â„¦is closed, there exists wn âˆˆâˆ‚â„¦such that dist (zn, âˆ‚â„¦) =
|zn âˆ’wn| . Now if there is a subsequence, {znk} such that |znk âˆ’wnk| â‰¥Îµ for all k,
then {znk} must possess a limit point because it is a bounded inï¬nite set of points.
However, this limit point can only be in â„¦because {znk} is bounded away from âˆ‚â„¦.
This is a contradiction. Therefore, limnâ†’âˆž|zn âˆ’wn| = 0. This proves the lemma.
Corollary 29.9 Let {zn} be a sequence of complex numbers contained in â„¦, an
open subset of C which has no limit point in â„¦. Suppose each zn is repeated no more
than ï¬nitely many times. Then there exists a function f which is analytic on â„¦
whose zeros are exactly {zn} . If w âˆˆ{zn} and w is listed m times, then w is a zero
of order m of f.
Proof:
There is nothing to prove if {zn} is ï¬nite.
You just let f (z) =
Qm
j=1 (z âˆ’zj) where {zn} = {z1, Â· Â· Â·, zm}.
Pick w âˆˆâ„¦\ {zn}âˆž
n=1 and let h (z) â‰¡
1
zâˆ’w. Since w is not a limit point of {zn} ,
there exists r > 0 such that B (w, r) contains no points of {zn} . Let â„¦1 â‰¡â„¦\ {w}.
Now h is not constant and so h (â„¦1) is an open set by the open mapping theorem.
In fact, h maps each component of â„¦to a region. |zn âˆ’w| > r
for all zn and
so |h (zn)| < râˆ’1. Thus the sequence, {h (zn)} is a bounded sequence in the open
set h (â„¦1) . It has no limit point in h (â„¦1) because this is true of {zn} and â„¦1.
By Lemma 29.8 there exist wn âˆˆâˆ‚(h (â„¦1)) such that limnâ†’âˆž|wn âˆ’h (zn)| = 0.
Consider for z âˆˆâ„¦1
f (z) â‰¡
âˆž
Y
n=1
En
Âµh (zn) âˆ’wn
h (z) âˆ’wn
Â¶
.
(29.8)
Letting K be a compact subset of â„¦1, h (K) is a compact subset of h (â„¦1) and so if
z âˆˆK, then |h (z) âˆ’wn| is bounded below by a positive constant. Therefore, there
exists N large enough that for all z âˆˆK and n â‰¥N,
Â¯Â¯Â¯Â¯
h (zn) âˆ’wn
h (z) âˆ’wn
Â¯Â¯Â¯Â¯ < 1
2
and so by Corollary 29.5, for all z âˆˆK and n â‰¥N,
Â¯Â¯Â¯Â¯En
Âµh (zn) âˆ’wn
h (z) âˆ’wn
Â¶
âˆ’1
Â¯Â¯Â¯Â¯ â‰¤3
Âµ1
2
Â¶n
.
(29.9)

29.1.
ANALYTIC FUNCTION WITH PRESCRIBED ZEROS
793
Therefore,
âˆž
X
n=1
Â¯Â¯Â¯Â¯En
Âµh (zn) âˆ’wn
h (z) âˆ’wn
Â¶
âˆ’1
Â¯Â¯Â¯Â¯
converges uniformly for z âˆˆK. This implies Qâˆž
n=1 En
Â³
h(zn)âˆ’wn
h(z)âˆ’wn
Â´
also converges
uniformly for z âˆˆK by Theorem 29.2. Since K is arbitrary, this shows f deï¬ned
in 29.8 is analytic on â„¦1.
Also if zn is listed m times so it is a zero of multiplicity m and wn is the point
from âˆ‚(h (â„¦1)) closest to h (zn) , then there are m factors in 29.8 which are of the
form
En
Âµh (zn) âˆ’wn
h (z) âˆ’wn
Â¶
=
Âµ
1 âˆ’h (zn) âˆ’wn
h (z) âˆ’wn
Â¶
egn(z)
=
Âµh (z) âˆ’h (zn)
h (z) âˆ’wn
Â¶
egn(z)
=
zn âˆ’z
(z âˆ’w) (zn âˆ’w)
Âµ
1
h (z) âˆ’wn
Â¶
egn(z)
=
(z âˆ’zn) Gn (z)
(29.10)
where Gn is an analytic function which is not zero at and near zn. Therefore, f has
a zero of order m at zn. This proves the theorem except for the point, w which has
been left out of â„¦1. It is necessary to show f is analytic at this point also and right
now, f is not even deï¬ned at w.
The {wn} are bounded because {h (zn)} is bounded and limnâ†’âˆž|wn âˆ’h (zn)| =
0 which implies |wn âˆ’h (zn)| â‰¤C for some constant, C. Therefore, there exists
Î´ > 0 such that if z âˆˆBâ€² (w, Î´) , then for all n,
Â¯Â¯Â¯Â¯Â¯Â¯
h (zn) âˆ’w
Â³
1
zâˆ’w
Â´
âˆ’wn
Â¯Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
h (zn) âˆ’wn
h (z) âˆ’wn
Â¯Â¯Â¯Â¯ < 1
2.
Thus 29.9 holds for all z âˆˆBâ€² (w, Î´) and n so by Theorem 29.2, the inï¬nite product
in 29.8 converges uniformly on Bâ€² (w, Î´) . This implies f is bounded in Bâ€² (w, Î´) and
so w is a removable singularity and f can be extended to w such that the result is
analytic. It only remains to verify f (w) Ì¸= 0. After all, this would not do because
it would be another zero other than those in the given list. By 29.10, a partial
product is of the form
N
Y
n=1
Âµh (z) âˆ’h (zn)
h (z) âˆ’wn
Â¶
egn(z)
(29.11)
where
gn (z) â‰¡
Ãƒ
h (zn) âˆ’wn
h (z) âˆ’wn
+ 1
2
Âµh (zn) âˆ’wn
h (z) âˆ’wn
Â¶2
+ Â· Â· Â· + 1
n
Âµh (zn) âˆ’wn
h (z) âˆ’wn
Â¶n!

794
INFINITE PRODUCTS
Each of the quotients in the deï¬nition of gn (z) converges to 0 as z â†’w
and so
the partial product of 29.11 converges to 1 as z â†’w because
Â³
h(z)âˆ’h(zn)
h(z)âˆ’wn
Â´
â†’1 as
z â†’w.
If f (w) = 0, then if z is close enough to w, it follows |f (z)| < 1
2. Also, by the
uniform convergence on Bâ€² (w, Î´) , it follows that for some N, the partial product
up to N must also be less than 1/2 in absolute value for all z close enough to w
and as noted above, this does not occur because such partial products converge to
1 as z â†’w. Hence f (w) Ì¸= 0. This proves the corollary.
Recall the deï¬nition of a meromorphic function on Page 666. It was a function
which is analytic everywhere except at a countable set of isolated points at which
the function has a pole. It is clear that the quotient of two analytic functions yields
a meromorphic function but is this the only way it can happen?
Theorem 29.10 Suppose Q is a meromorphic function on an open set, â„¦. Then
there exist analytic functions on â„¦, f (z) and g (z) such that Q (z) = f (z) /g (z) for
all z not in the set of poles of Q.
Proof: Let Q have a pole of order m (z) at z. Then by Corollary 29.9 there
exists an analytic function, g which has a zero of order m (z) at every z âˆˆâ„¦. It
follows gQ has a removable singularity at the poles of Q. Therefore, there is an
analytic function, f such that f (z) = g (z) Q (z) . This proves the theorem.
Corollary 29.11 Suppose â„¦is a region and Q is a meromorphic function deï¬ned
on â„¦such that the set, {z âˆˆâ„¦: Q (z) = c} has a limit point in â„¦. Then Q (z) = c
for all z âˆˆâ„¦.
Proof: From Theorem 29.10 there are analytic functions, f, g such that Q = f
g .
Therefore, the zero set of the function, f (z) âˆ’cg (z) has a limit point in â„¦and so
f (z) âˆ’cg (z) = 0 for all z âˆˆâ„¦. This proves the corollary.
29.2
Factoring A Given Analytic Function
The next theorem is the Weierstrass factorization theorem which can be used to
factor a given analytic function f. If f has a zero of order m when z = 0, then you
could factor out a zm and from there consider the factorization of what remains
when you have factored out the zm. Therefore, the following is the main thing of
interest.
Theorem 29.12 Let f be analytic on C, f (0) Ì¸= 0, and let the zeros of f, be
{zk} ,listed according to order. (Thus if z is a zero of order m, it will be listed m
times in the list, {zk} .) Choosing nonnegative integers, pn such that for all r > 0,
âˆž
X
n=1
Âµ r
|zn|
Â¶pn+1
< âˆž,

29.2.
FACTORING A GIVEN ANALYTIC FUNCTION
795
There exists an entire function, g such that
f (z) = eg(z)
âˆž
Y
n=1
Epn
Âµ z
zn
Â¶
.
(29.12)
Note that eg(z) Ì¸= 0 for any z and this is the interesting thing about this function.
Proof: {zn} cannot have a limit point because if there were a limit point of this
sequence, it would follow from Theorem 24.23 that f (z) = 0 for all z, contradicting
the hypothesis that f (0) Ì¸= 0. Hence limnâ†’âˆž|zn| = âˆžand so
âˆž
X
n=1
Âµ r
|zn|
Â¶1+nâˆ’1
=
âˆž
X
n=1
Âµ r
|zn|
Â¶n
< âˆž
by the root test. Therefore, by Theorem 29.6
P (z) =
âˆž
Y
n=1
Epn
Âµ z
zn
Â¶
a function analytic on C by picking pn = n âˆ’1 or perhaps some other choice. (
pn = n âˆ’1 works but there might be another choice that would work.) Then f/P
has only removable singularities in C and no zeros thanks to Theorem 29.6. Thus,
letting h (z) = f (z) /P (z) , Corollary 24.50 implies that hâ€²/h has a primitive, eg.
Then
Â³
heâˆ’egÂ´â€²
= 0
and so
h (z) = ea+ibeeg(z)
for some constants, a, b. Therefore, letting g (z) = eg (z) + a + ib, h (z) = eg(z) and
thus 29.12 holds. This proves the theorem.
Corollary 29.13 Let f be analytic on C, f has a zero of order m at 0, and let the
other zeros of f be {zk} , listed according to order. (Thus if z is a zero of order l,
it will be listed l times in the list, {zk} .) Also let
âˆž
X
n=1
Âµ r
|zn|
Â¶1+pn
< âˆž
(29.13)
for any choice of r > 0. Then there exists an entire function, g such that
f (z) = zmeg(z)
âˆž
Y
n=1
Epn
Âµ z
zn
Â¶
.
(29.14)
Proof: Since f has a zero of order m at 0, it follows from Theorem 24.23 that
{zk} cannot have a limit point in C and so you can apply Theorem 29.12 to the
function, f (z) /zm which has a removable singularity at 0. This proves the corollary.

796
INFINITE PRODUCTS
29.2.1
Factoring Some Special Analytic Functions
Factoring a polynomial is in general a hard task. It is true it is easy to prove the
factors exist but ï¬nding them is another matter. Corollary 29.13 gives the existence
of factors of a certain form but it does not tell how to ï¬nd them. This should not
be surprising. You canâ€™t expect things to get easier when you go from polynomials
to analytic functions. Nevertheless, it is possible to factor some popular analytic
functions. These factorizations are based on the following Mitag-Leï¬„er expansions.
By an auspicious choice of the contour and the method of residues it is possible to
obtain a very interesting formula for cot Ï€z .
Example 29.14 Let Î³N be the contour which goes from âˆ’N âˆ’1
2 âˆ’Ni horizontally
to N + 1
2 âˆ’Ni and from there, vertically to N + 1
2 + Ni and then horizontally
to âˆ’N âˆ’1
2 + Ni
and ï¬nally vertically to âˆ’N âˆ’1
2 âˆ’Ni. Thus the contour is a
large rectangle and the direction of integration is in the counter clockwise direction.
Consider the integral
IN â‰¡
Z
Î³N
Ï€ cos Ï€z
sin Ï€z (Î±2 âˆ’z2)dz
where Î± âˆˆR is not an integer. This will be used to verify the formula of Mittag-
Leï¬„er,
1
Î± +
âˆž
X
n=1
2Î±
Î±2 âˆ’n2 = Ï€ cot Ï€Î±.
(29.15)
First you show that cot Ï€z is bounded on this contour. This is easy using the
formula for cot (z) = eiz+eâˆ’iz
eizâˆ’eâˆ’iz . Therefore, IN â†’0 as N â†’âˆžbecause the integrand
is of order 1/N 2 while the diameter of Î³N is of order N. Next you compute the
residues of the integrand at Â±Î± and at n where |n| < N + 1
2 for n an integer. These
are the only singularities of the integrand in this contour and therefore, using the
residue theorem, you can evaluate IN by using these.
You can calculate these
residues and ï¬nd that the residue at Â±Î± is
âˆ’Ï€ cos Ï€Î±
2Î± sin Ï€Î±
while the residue at n is
1
Î±2 âˆ’n2 .
Therefore
0 = lim
Nâ†’âˆžIN = lim
Nâ†’âˆž2Ï€i
"
N
X
n=âˆ’N
1
Î±2 âˆ’n2 âˆ’Ï€ cot Ï€Î±
Î±
#
which establishes the following formula of Mittag Leï¬„er.
lim
Nâ†’âˆž
N
X
n=âˆ’N
1
Î±2 âˆ’n2 = Ï€ cot Ï€Î±
Î±
.

29.2.
FACTORING A GIVEN ANALYTIC FUNCTION
797
Writing this in a slightly nicer form, you obtain 29.15.
This is a very interesting formula. This will be used to factor sin (Ï€z) . The
zeros of this function are at the integers. Therefore, considering 29.13 you can pick
pn = 1 in the Weierstrass factorization formula. Therefore, by Corollary 29.13 there
exists an analytic function g (z) such that
sin (Ï€z) = zeg(z)
âˆž
Y
n=1
Âµ
1 âˆ’z
zn
Â¶
ez/zn
(29.16)
where the zn are the nonzero integers. Remember you can permute the factors in
these products. Therefore, this can be written more conveniently as
sin (Ï€z) = zeg(z)
âˆž
Y
n=1
Âµ
1 âˆ’
Â³ z
n
Â´2Â¶
and it is necessary to ï¬nd g (z) . Diï¬€erentiating both sides of 29.16
Ï€ cos (Ï€z)
=
eg(z)
âˆž
Y
n=1
Âµ
1 âˆ’
Â³ z
n
Â´2Â¶
+ zgâ€² (z) eg(z)
âˆž
Y
n=1
Âµ
1 âˆ’
Â³ z
n
Â´2Â¶
+zeg(z)
âˆž
X
n=1
âˆ’
Âµ2z
n2
Â¶ Y
kÌ¸=n
Âµ
1 âˆ’
Â³z
k
Â´2Â¶
Now divide both sides by sin (Ï€z) to obtain
Ï€ cot (Ï€z)
=
1
z + gâ€² (z) âˆ’
âˆž
X
n=1
2z/n2
(1 âˆ’z2/n2)
=
1
z + gâ€² (z) +
âˆž
X
n=1
2z
z2 âˆ’n2 .
By 29.15, this yields gâ€² (z) = 0 for z not an integer and so g (z) = c, a constant. So
far this yields
sin (Ï€z) = zec
âˆž
Y
n=1
Âµ
1 âˆ’
Â³ z
n
Â´2Â¶
and it only remains to ï¬nd c. Divide both sides by Ï€z and take a limit as z â†’0.
Using the power series of sin (Ï€z) , this yields
1 = ec
Ï€
and so c = ln Ï€. Therefore,
sin (Ï€z) = zÏ€
âˆž
Y
n=1
Âµ
1 âˆ’
Â³ z
n
Â´2Â¶
.
(29.17)

798
INFINITE PRODUCTS
Example 29.15 Find an interesting formula for tan (Ï€z) .
This is easy to obtain from the formula for cot (Ï€z) .
cot
Âµ
Ï€
Âµ
z + 1
2
Â¶Â¶
= âˆ’tan Ï€z
for z real and therefore, this formula holds for z complex also. Therefore, for z + 1
2
not an integer
Ï€ cot
Âµ
Ï€
Âµ
z + 1
2
Â¶Â¶
=
2
2z + 1 +
âˆž
X
n=1
2z + 1
Â¡ 2z+1
2
Â¢2 âˆ’n2
29.3
The Existence Of An Analytic Function With
Given Values
The Weierstrass product formula, Theorem 29.6, along with the Mittag-Leï¬„er the-
orem, Theorem 28.13 can be used to obtain an analytic function which has given
values on a countable set of points, having no limit point. This is clearly an amazing
result and indicates how potent these theorems are. In fact, you can show that it
isnâ€™t just the values of the function which may be speciï¬ed at the points in this
countable set of points but the derivatives up to any ï¬nite order.
Theorem 29.16 Let P â‰¡{zk}âˆž
k=1 be a set of points in C,which has no limit point.
For each zk, consider
mk
X
j=0
ak
j (z âˆ’zk)j .
(29.18)
Then there exists an analytic function deï¬ned on C such that the Taylor series of
f at zk has the ï¬rst mk terms given by 29.18.1
Proof: By the Weierstrass product theorem, Theorem 29.6, there exists an
analytic function, f deï¬ned on all of â„¦such that f has a zero of order mk + 1 at
zk. Consider this zk Thus for z near zk,
f (z) =
âˆž
X
j=mk+1
cj (z âˆ’zk)j
where cmk+1 Ì¸= 0. You choose b1, b2, Â· Â· Â·, bmk+1 such that
f (z)
Ãƒmk+1
X
l=1
bl
(z âˆ’zk)k
!
=
mk
X
j=0
ak
j (z âˆ’zk)j +
âˆž
X
k=mk+1
ck
j (z âˆ’zk)j .
1This says you can specify the ï¬rst mk derivatives of the function at the point zk.

29.3.
THE EXISTENCE OF AN ANALYTIC FUNCTION WITH GIVEN VALUES799
Thus you need
mk+1
X
l=1
âˆž
X
j=mk+1
cjbl (z âˆ’zk)jâˆ’l =
mk
X
r=0
ak
r (z âˆ’zk)r + Higher order terms.
It follows you need to solve the following system of equations for b1, Â· Â· Â·, bmk+1.
cmk+1bmk+1 = ak
0
cmk+2bmk+1 + cmk+1bmk = ak
1
cmk+3bmk+1 + cmk+2bmk + cmk+1bmkâˆ’1 = ak
2
...
cmk+mk+1bmk+1 + cmk+mkbmk + Â· Â· Â· + cmk+1b1 = ak
mk
Since cmk+1 Ì¸= 0, it follows there exists a unique solution to the above system.
You ï¬rst solve for bmk+1 in the top. Then, having found it, you go to the next
and use cmk+1 Ì¸= 0 again to ï¬nd bmk and continue in this manner.
Let Sk (z)
be determined in this manner for each zk. By the Mittag-Leï¬„er theorem, there
exists a Meromorphic function, g such that g has exactly the singularities, Sk (z) .
Therefore, f (z) g (z) has removable singularities at each zk and for z near zk, the
ï¬rst mk terms of fg are as prescribed. This proves the theorem.
Corollary 29.17 Let P â‰¡{zk}âˆž
k=1 be a set of points in â„¦, an open set such that
P has no limit points in â„¦. For each zk, consider
mk
X
j=0
ak
j (z âˆ’zk)j .
(29.19)
Then there exists an analytic function deï¬ned on â„¦such that the Taylor series of
f at zk has the ï¬rst mk terms given by 29.19.
Proof: The proof is identical to the above except you use the versions of the
Mittag-Leï¬„er theorem and Weierstrass product which pertain to open sets.
Deï¬nition 29.18 Denote by H (â„¦) the analytic functions deï¬ned on â„¦, an open
subset of C. Then H (â„¦) is a commutative ring2 with the usual operations of addition
and multiplication. A set, I âŠ†H (â„¦) is called a ï¬nitely generated ideal of the ring
if I is of the form
( n
X
k=1
gkfk : fk âˆˆH (â„¦) for k = 1, 2, Â· Â· Â·, n
)
where g1, Â·Â·Â·, gn are given functions in H (â„¦). This ideal is also denoted as [g1, Â· Â· Â·, gn]
and is called the ideal generated by the functions, {g1, Â· Â· Â·, gn}.
Since there are
ï¬nitely many of these functions it is called a ï¬nitely generated ideal. A principal
ideal is one which is generated by a single function. An example of such a thing is
[1] = H (â„¦) .
2It is not a ï¬eld because you canâ€™t divide two analytic functions and get another one.

800
INFINITE PRODUCTS
Then there is the following interesting theorem.
Theorem 29.19 Every ï¬nitely generated ideal in H (â„¦) for â„¦a connected open set
(region) is a principal ideal.
Proof: Let I = [g1, Â· Â· Â·, gn] be a ï¬nitely generated ideal as described above.
Then if any of the functions has no zeros, this ideal would consist of H (â„¦) because
then gâˆ’1
i
âˆˆH (â„¦) and so 1 âˆˆI. It follows all the functions have zeros. If any of the
functions has a zero of inï¬nite order, then the function equals zero on â„¦because â„¦
is connected and can be deleted from the list. Similarly, if the zeros of any of these
functions have a limit point in â„¦, then the function equals zero and can be deleted
from the list. Thus, without loss of generality, all zeros are of ï¬nite order and there
are no limit points of the zeros in â„¦. Let m (gi, z) denote the order of the zero of
gi at z. If gi has no zero at z, then m (gi, z) = 0.
I claim that if no point of â„¦is a zero of all the gi, then the conclusion of the
theorem is true and in fact [g1, Â· Â· Â·, gn] = [1] = H (â„¦) . The claim is obvious if n = 1
because this assumption that no point is a zero of all the functions implies g Ì¸= 0
and so gâˆ’1 is analytic. Hence 1 âˆˆ[g1] . Suppose it is true for n âˆ’1 and consider
[g1, Â· Â· Â·, gn] where no point of â„¦is a zero of all the gi. Even though this may be true
of {g1, Â· Â· Â·, gn} , it may not be true of {g1, Â· Â· Â·, gnâˆ’1} . By Corollary 29.9 there exists
Ï†, a function analytic on â„¦such that m (Ï†, z) = min {m (gi, z) , i = 1, 2, Â· Â· Â·, n âˆ’1} .
Thus the functions {g1/Ï†, Â· Â· Â·, gnâˆ’1/Ï†} .are all analytic. Could they all equal zero
at some point, z? If so, pick i where m (Ï†, z) = m (gi, z) . Thus gi/Ï† is not equal to
zero at z after all and so these functions are analytic there is no point of â„¦which
is a zero of all of them. By induction, [g1/Ï†, Â· Â· Â·, gnâˆ’1/Ï†] = H (â„¦). (Also there are
no new zeros obtained in this way.)
Now this means there exist functions fi âˆˆH (â„¦) such that
n
X
i=1
fi
Âµgi
Ï†
Â¶
= 1
and so Ï† = Pn
i=1 figi. Therefore, [Ï†] âŠ†[g1, Â· Â· Â·, gnâˆ’1] . On the other hand, if
Pnâˆ’1
k=1 hkgk âˆˆ[g1, Â· Â· Â·, gnâˆ’1] you could deï¬ne h â‰¡Pnâˆ’1
k=1 hk (gk/Ï† ) , an analytic
function with the property that hÏ† = Pnâˆ’1
k=1 hkgk which shows [Ï†] = [g1, Â· Â· Â·, gnâˆ’1].
Therefore,
[g1, Â· Â· Â·, gn] = [Ï†, gn]
Now Ï† has no zeros in common with gn because the zeros of Ï† are contained in the
set of zeros for g1, Â· Â· Â·, gnâˆ’1. Now consider a zero, Î± of Ï†. It is not a zero of gn and
so near Î±, these functions have the form
Ï† (z) =
âˆž
X
k=m
ak (z âˆ’Î±)k , gn (z) =
âˆž
X
k=0
bk (z âˆ’Î±)k , b0 Ì¸= 0.
I want to determine coeï¬ƒcients for an analytic function, h such that
m (1 âˆ’hgn, Î±) â‰¥m (Ï†, Î±) .
(29.20)

29.3.
THE EXISTENCE OF AN ANALYTIC FUNCTION WITH GIVEN VALUES801
Let
h (z) =
âˆž
X
k=0
ck (z âˆ’Î±)k
and the ck must be determined. Using Mertenâ€™s theorem, the power series for 1âˆ’hgn
is of the form
1 âˆ’b0c0 âˆ’
âˆž
X
j=1
Ãƒ j
X
r=0
bjâˆ’rcr
!
(z âˆ’Î±)j .
First determine c0 such that 1 âˆ’c0b0 = 0. This is no problem because b0 Ì¸= 0. Next
you need to get the coeï¬ƒcients of (z âˆ’Î±) to equal zero. This requires
b1c0 + b0c1 = 0.
Again, there is no problem because b0 Ì¸= 0. In fact, c1 = (âˆ’b1c0/b0) . Next consider
the second order terms if m â‰¥2.
b2c0 + b1c1 + b0c2 = 0
Again there is no problem in solving, this time for c2 because b0 Ì¸= 0. Continuing this
way, you see that in every step, the ck which needs to be solved for is multiplied by
b0 Ì¸= 0. Therefore, by Corollary 29.9 there exists an analytic function, h satisfying
29.20. Therefore, (1 âˆ’hgn) /Ï† has a removable singularity at every zero of Ï† and
so may be considered an analytic function. Therefore,
1 = 1 âˆ’hgn
Ï†
Ï† + hgn âˆˆ[Ï†, gn] = [g1 Â· Â· Â· gn]
which shows [g1 Â· Â· Â· gn] = H (â„¦) = [1] . It follows the claim is established.
Now suppose {g1 Â· Â· Â· gn} are just elements of H (â„¦) . As explained above, it can
be assumed they all have zeros of ï¬nite order and the zeros have no limit point
in â„¦since if these occur, you can delete the function from the list. By Corollary
29.9 there exists Ï† âˆˆH (â„¦) such that m (Ï†, z) â‰¤min {m (gi, z) : i = 1, Â· Â· Â·, n} . Then
gk/Ï† has a removable singularity at each zero of gk and so can be regarded as an
analytic function. Also, as before, there is no point which is a zero of each gk/Ï† and
so by the ï¬rst part of this argument, [g1/Ï† Â· Â· Â· gn/Ï†] = H (â„¦) . As in the ï¬rst part
of the argument, this implies [g1 Â· Â· Â· gn] = [Ï†] which proves the theorem. [g1 Â· Â· Â· gn]
is a principal ideal as claimed.
The following corollary follows from the above theorem.
You donâ€™t need to
assume â„¦is connected.
Corollary 29.20 Every ï¬nitely generated ideal in H (â„¦) for â„¦an open set is a
principal ideal.
Proof: Let [g1, Â· Â· Â·, gn] be a ï¬nitely generated ideal in H (â„¦) . Let {Uk} be the
components of â„¦. Then applying the above to each component, there exists hk âˆˆ
H (Uk) such that restricting each gi to Uk, [g1, Â· Â· Â·, gn] = [hk] . Then let h (z) = hk (z)
for z âˆˆUk. This is an analytic function which works.

802
INFINITE PRODUCTS
29.4
Jensenâ€™s Formula
This interesting formula relates the zeros of an analytic function to an integral. The
proof given here follows Alfors, [2]. First, here is a technical lemma.
Lemma 29.21
Z Ï€
âˆ’Ï€
ln
Â¯Â¯1 âˆ’eiÎ¸Â¯Â¯ dÎ¸ = 0.
Proof: First note that the only problem with the integrand occurs when Î¸ = 0.
However, this is an integrable singularity so the integral will end up making sense.
Letting z = eiÎ¸, you could get the above integral as a limit as Îµ â†’0 of the following
contour integral where Î³Îµ is the contour shown in the following picture with the
radius of the big circle equal to 1 and the radius of the little circle equal to Îµ..
Z
Î³Îµ
ln |1 âˆ’z|
iz
dz.
s
1
s
On the indicated contour, 1âˆ’z lies in the half plane Re z > 0 and so log (1 âˆ’z) =
ln |1 âˆ’z| + i arg (1 âˆ’z). The above integral equals
Z
Î³Îµ
log (1 âˆ’z)
iz
dz âˆ’
Z
Î³Îµ
arg (1 âˆ’z)
z
dz
The ï¬rst of these integrals equals zero because the integrand has a removable sin-
gularity at 0. The second equals
i
Z âˆ’Î·Îµ
âˆ’Ï€
arg
Â¡
1 âˆ’eiÎ¸Â¢
dÎ¸ + i
Z Ï€
Î·Îµ
arg
Â¡
1 âˆ’eiÎ¸Â¢
dÎ¸
+Îµi
Z âˆ’Ï€
âˆ’Ï€
2 âˆ’Î»Îµ
Î¸dÎ¸ + Îµi
Z
Ï€
2 âˆ’Î»Îµ
Ï€
Î¸dÎ¸
where Î·Îµ, Î»Îµ â†’0 as Îµ â†’0. The last two terms converge to 0 as Îµ â†’0 while the
ï¬rst two add to zero. To see this, change the variable in the ï¬rst integral and then
recall that when you multiply complex numbers you add the arguments. Thus you
end up integrating arg (real valued function) which equals zero.
In this material on Jensenâ€™s equation, Îµ will denote a small positive number. Its
value is not important as long as it is positive. Therefore, it may change from place

29.4.
JENSENâ€™S FORMULA
803
to place. Now suppose f is analytic on B (0, r + Îµ) , and f has no zeros on B (0, r).
Then you can deï¬ne a branch of the logarithm which makes sense for complex
numbers near f (z) . Thus z â†’log (f (z)) is analytic on B (0, r + Îµ). Therefore, its
real part, u (x, y) â‰¡ln |f (x + iy)| must be harmonic. Consider the following lemma.
Lemma 29.22 Let u be harmonic on B (0, r + Îµ) . Then
u (0) = 1
2Ï€
Z Ï€
âˆ’Ï€
u
Â¡
reiÎ¸Â¢
dÎ¸.
Proof:
For a harmonic function, u deï¬ned on B (0, r + Îµ) , there exists an
analytic function, h = u + iv where
v (x, y) â‰¡
Z y
0
ux (x, t) dt âˆ’
Z x
0
uy (t, 0) dt.
By the Cauchy integral theorem,
h (0) =
1
2Ï€i
Z
Î³r
h (z)
z
dz = 1
2Ï€
Z Ï€
âˆ’Ï€
h
Â¡
reiÎ¸Â¢
dÎ¸.
Therefore, considering the real part of h,
u (0) = 1
2Ï€
Z Ï€
âˆ’Ï€
u
Â¡
reiÎ¸Â¢
dÎ¸.
This proves the lemma.
Now this shows the following corollary.
Corollary 29.23 Suppose f is analytic on B (0, r + Îµ) and has no zeros on B (0, r).
Then
ln |f (0)| = 1
2Ï€
Z Ï€
âˆ’Ï€
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯
(29.21)
What if f has some zeros on |z| = r but none on B (0, r)? It turns out 29.21
is still valid. Suppose the zeros are at
Â©
reiÎ¸kÂªm
k=1 , listed according to multiplicity.
Then let
g (z) =
f (z)
Qm
k=1 (z âˆ’reiÎ¸k).

804
INFINITE PRODUCTS
It follows g is analytic on B (0, r + Îµ) but has no zeros in B (0, r). Then 29.21 holds
for g in place of f. Thus
ln |f (0)| âˆ’
m
X
k=1
ln |r|
=
1
2Ï€
Z Ï€
âˆ’Ï€
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸ âˆ’1
2Ï€
Z Ï€
âˆ’Ï€
m
X
k=1
ln
Â¯Â¯reiÎ¸ âˆ’reiÎ¸kÂ¯Â¯ dÎ¸
=
1
2Ï€
Z Ï€
âˆ’Ï€
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸ âˆ’1
2Ï€
Z Ï€
âˆ’Ï€
m
X
k=1
ln
Â¯Â¯eiÎ¸ âˆ’eiÎ¸kÂ¯Â¯ dÎ¸ âˆ’
m
X
k=1
ln |r|
=
1
2Ï€
Z Ï€
âˆ’Ï€
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸ âˆ’1
2Ï€
Z Ï€
âˆ’Ï€
m
X
k=1
ln
Â¯Â¯eiÎ¸ âˆ’1
Â¯Â¯ dÎ¸ âˆ’
m
X
k=1
ln |r|
Therefore, 29.21 will continue to hold exactly when
1
2Ï€
R Ï€
âˆ’Ï€
Pm
k=1 ln
Â¯Â¯eiÎ¸ âˆ’1
Â¯Â¯ dÎ¸ = 0.
But this is the content of Lemma 29.21. This proves the following lemma.
Lemma 29.24 Suppose f is analytic on B (0, r + Îµ) and has no zeros on B (0, r) .
Then
ln |f (0)| = 1
2Ï€
Z Ï€
âˆ’Ï€
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯
(29.22)
With this preparation, it is now not too hard to prove Jensenâ€™s formula. Suppose
there are n zeros of f in B (0, r) , {ak}n
k=1, listed according to multiplicity, none equal
to zero. Let
F (z) â‰¡f (z)
n
Y
i=1
r2 âˆ’aiz
r (z âˆ’ai).
Then F is analytic on B (0, r + Îµ) and has no zeros in B (0, r) . The reason for this
is that f (z) / Qn
i=1 r (z âˆ’ai) has no zeros there and r2 âˆ’aiz cannot equal zero if
|z| < r because if this expression equals zero, then
|z| = r2
|ai| > r.
The other interesting thing about F (z) is that when z = reiÎ¸,
F
Â¡
reiÎ¸Â¢
=
f
Â¡
reiÎ¸Â¢
n
Y
i=1
r2 âˆ’aireiÎ¸
r (reiÎ¸ âˆ’ai)
=
f
Â¡
reiÎ¸Â¢
n
Y
i=1
r âˆ’aieiÎ¸
(reiÎ¸ âˆ’ai) = f
Â¡
reiÎ¸Â¢
eiÎ¸
n
Y
i=1
reâˆ’iÎ¸ âˆ’ai
reiÎ¸ âˆ’ai
so
Â¯Â¯F
Â¡
reiÎ¸Â¢Â¯Â¯ =
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯.

29.5.
BLASCHKE PRODUCTS
805
Theorem 29.25 Let f be analytic on B (0, r + Îµ) and suppose f (0) Ì¸= 0. If the
zeros of f in B (0, r) are {ak}n
k=1, listed according to multiplicity, then
ln |f (0)| = âˆ’
n
X
i=1
ln
Âµ r
|ai|
Â¶
+ 1
2Ï€
Z 2Ï€
0
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸.
Proof: From the above discussion and Lemma 29.24,
ln |F (0)| = 1
2Ï€
Z Ï€
âˆ’Ï€
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸
But F (0) = f (0) Qn
i=1
r
ai and so ln |F (0)| = ln |f (0)| + Pn
i=1 ln
Â¯Â¯Â¯ r
ai
Â¯Â¯Â¯ . Therefore,
ln |f (0)| = âˆ’
n
X
i=1
ln
Â¯Â¯Â¯Â¯
r
ai
Â¯Â¯Â¯Â¯ + 1
2Ï€
Z 2Ï€
0
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸
as claimed.
Written in terms of exponentials this is
|f (0)|
n
Y
k=1
Â¯Â¯Â¯Â¯
r
ak
Â¯Â¯Â¯Â¯ = exp
Âµ 1
2Ï€
Z 2Ï€
0
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸
Â¶
.
29.5
Blaschke Products
The Blaschke3 product is a way to produce a function which is bounded and analytic
on B (0, 1) which also has given zeros in B (0, 1) . The interesting thing here is
that there may be inï¬nitely many of these zeros. Thus, unlike the above case of
Jensenâ€™s inequality, the function is not analytic on B (0, 1). Recall for purposes of
comparison, Liouvilleâ€™s theorem which says bounded entire functions are constant.
The Blaschke product gives examples of bounded functions on B (0, 1) which are
deï¬nitely not constant.
Theorem 29.26 Let {Î±n} be a sequence of nonzero points in B (0, 1) with the
property that
âˆž
X
n=1
(1 âˆ’|Î±n|) < âˆž.
Then for k â‰¥0, an integer
B (z) â‰¡zk
âˆž
Y
k=1
Î±n âˆ’z
1 âˆ’Î±nz
|Î±n|
Î±n
is a bounded function which is analytic on B (0, 1) which has zeros only at 0 if k > 0
and at the Î±n.
3Wilhelm Blaschke, 1915

806
INFINITE PRODUCTS
Proof: From Theorem 29.2 the above product will converge uniformly on B (0, r)
for r < 1 to an analytic function if
âˆž
X
k=1
Â¯Â¯Â¯Â¯
Î±n âˆ’z
1 âˆ’Î±nz
|Î±n|
Î±n
âˆ’1
Â¯Â¯Â¯Â¯
converges uniformly on B (0, r) . But for |z| < r,
Â¯Â¯Â¯Â¯
Î±n âˆ’z
1 âˆ’Î±nz
|Î±n|
Î±n
âˆ’1
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Î±n âˆ’z
1 âˆ’Î±nz
|Î±n|
Î±n
âˆ’Î±n (1 âˆ’Î±nz)
Î±n (1 âˆ’Î±nz)
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
|Î±n| Î±n âˆ’|Î±n| z âˆ’Î±n + |Î±n|2 z
(1 âˆ’Î±nz) Î±n
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
|Î±n| Î±n âˆ’Î±n âˆ’|Î±n| z + |Î±n|2 z
(1 âˆ’Î±nz) Î±n
Â¯Â¯Â¯Â¯Â¯
=
||Î±n| âˆ’1|
Â¯Â¯Â¯Â¯
Î±n + z |Î±n|
(1 âˆ’Î±nz) Î±n
Â¯Â¯Â¯Â¯
=
||Î±n| âˆ’1|
Â¯Â¯Â¯Â¯
1 + z (|Î±n| /Î±n)
(1 âˆ’Î±nz)
Â¯Â¯Â¯Â¯
â‰¤
||Î±n| âˆ’1|
Â¯Â¯Â¯Â¯
1 + |z|
1 âˆ’|z|
Â¯Â¯Â¯Â¯ â‰¤||Î±n| âˆ’1|
Â¯Â¯Â¯Â¯
1 + r
1 âˆ’r
Â¯Â¯Â¯Â¯
and so the assumption on the sum gives uniform convergence of the product on
B (0, r) to an analytic function. Since r < 1 is arbitrary, this shows B (z) is analytic
on B (0, 1) and has the speciï¬ed zeros because the only place the factors equal zero
are at the Î±n or 0.
Now consider the factors in the product. The claim is that they are all no larger
in absolute value than 1.
This is very easy to see from the maximum modulus
theorem. Let |Î±| < 1 and Ï† (z) =
Î±âˆ’z
1âˆ’Î±z. Then Ï† is analytic near B (0, 1) because its
only pole is 1/Î±. Consider z = eiÎ¸. Then
Â¯Â¯Ï†
Â¡
eiÎ¸Â¢Â¯Â¯ =
Â¯Â¯Â¯Â¯
Î± âˆ’eiÎ¸
1 âˆ’Î±eiÎ¸
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
1 âˆ’Î±eâˆ’iÎ¸
1 âˆ’Î±eiÎ¸
Â¯Â¯Â¯Â¯ = 1.
Thus the modulus of Ï† (z) equals 1 on âˆ‚B (0, 1) . Therefore, by the maximum mod-
ulus theorem, |Ï† (z)| < 1 if |z| < 1. This proves the claim that the terms in the
product are no larger than 1 and shows the function determined by the Blaschke
product is bounded. This proves the theorem.
Note in the conditions for this theorem the one for the sum, Pâˆž
n=1 (1 âˆ’|Î±n|) <
âˆž. The Blaschke product gives an analytic function, whose absolute value is bounded
by 1 and which has the Î±n as zeros. What if you had a bounded function, analytic
on B (0, 1) which had zeros at {Î±k}? Could you conclude the condition on the sum?

29.5.
BLASCHKE PRODUCTS
807
The answer is yes. In fact, you can get by with less than the assumption that f is
bounded but this will not be presented here. See Rudin [45]. This theorem is an
exciting use of Jensenâ€™s equation.
Theorem 29.27 Suppose f is an analytic function on B (0, 1) , f (0) Ì¸= 0, and
|f (z)| â‰¤M for all z âˆˆB (0, 1) . Suppose also that the zeros of f are {Î±k}âˆž
k=1 ,
listed according to multiplicity. Then Pâˆž
k=1 (1 âˆ’|Î±k|) < âˆž.
Proof: If there are only ï¬nitely many zeros, there is nothing to prove so assume
there are inï¬nitely many. Also let the zeros be listed such that |Î±n| â‰¤|Î±n+1|Â·Â·Â· Let
n (r) denote the number of zeros in B (0, r) . By Jensenâ€™s formula,
ln |f (0)| +
n(r)
X
i=1
ln r âˆ’ln |Î±i| = 1
2Ï€
Z 2Ï€
0
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸ â‰¤ln (M) .
Therefore, by the mean value theorem,
n(r)
X
i=1
1
r (r âˆ’|Î±i|) â‰¤
n(r)
X
i=1
ln r âˆ’ln |Î±i| â‰¤ln (M) âˆ’ln |f (0)|
As r â†’1âˆ’, n (r) â†’âˆž, and so an application of Fatous lemma yields
âˆž
X
i=1
(1 âˆ’|Î±i|) â‰¤lim inf
râ†’1âˆ’
n(r)
X
i=1
1
r (r âˆ’|Î±i|) â‰¤ln (M) âˆ’ln |f (0)| .
This proves the theorem.
You donâ€™t need the assumption that f (0) Ì¸= 0.
Corollary 29.28 Suppose f is an analytic function on B (0, 1) and |f (z)| â‰¤M
for all z âˆˆB (0, 1) . Suppose also that the nonzero zeros4 of f are {Î±k}âˆž
k=1 , listed
according to multiplicity. Then Pâˆž
k=1 (1 âˆ’|Î±k|) < âˆž.
Proof:
Suppose f has a zero of order m at 0.
Then consider the analytic
function, g (z) â‰¡f (z) /zm which has the same zeros except for 0. The argument
goes the same way except here you use g instead of f and only consider r > r0 > 0.
4This is a fun thing to say: nonzero zeros.

808
INFINITE PRODUCTS
Thus from Jensenâ€™s equation,
ln |g (0)| +
n(r)
X
i=1
ln r âˆ’ln |Î±i|
=
1
2Ï€
Z 2Ï€
0
ln
Â¯Â¯g
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸
=
1
2Ï€
Z 2Ï€
0
ln
Â¯Â¯f
Â¡
reiÎ¸Â¢Â¯Â¯ dÎ¸ âˆ’1
2Ï€
Z 2Ï€
0
m ln (r)
â‰¤
M + 1
2Ï€
Z 2Ï€
0
m ln
Â¡
râˆ’1Â¢
â‰¤
M + m ln
Âµ 1
r0
Â¶
.
Now the rest of the argument is the same.
An interesting restatement yields the following amazing result.
Corollary 29.29 Suppose f is analytic and bounded on B (0, 1) having zeros {Î±n} .
Then if Pâˆž
k=1 (1 âˆ’|Î±n|) = âˆž, it follows f is identically equal to zero.
29.5.1
The MÂ¨untz-Szasz Theorem Again
Corollary 29.29 makes possible an easy proof of a remarkable theorem named above
which yields a wonderful generalization of the Weierstrass approximation theorem.
In what follows b > 0. The Weierstrass approximation theorem states that linear
combinations of 1, t, t2, t3, Â· Â· Â· (polynomials) are dense in C ([0, b]) . Let Î»1 < Î»2 <
Î»3 < Â· Â· Â· be an increasing list of positive real numbers. This theorem tells when
linear combinations of 1, tÎ»1, tÎ»2, Â· Â· Â· are dense in C ([0, b]). The proof which follows
is like the one given in Rudin [45]. There is a much longer one in Cheney [14] which
discusses more aspects of the subject. See also Page 377 where the version given in
Cheney is presented. This other approach is much more elementary and does not
depend in any way on the theory of functions of a complex variable. There are those
of us who automatically prefer real variable techniques. Nevertheless, this proof by
Rudin is a very nice and insightful application of the preceding material. Cheney
refers to the theorem as the second MÂ¨untz theorem. I guess Szasz must also have
been involved.
Theorem 29.30 Let Î»1 < Î»2 < Î»3 < Â· Â· Â· be an increasing list of positive real
numbers and let a > 0. If
âˆž
X
n=1
1
Î»n
= âˆž,
(29.23)
then linear combinations of 1, tÎ»1, tÎ»2, Â· Â· Â·
are dense in C ([0, b]).

29.5.
BLASCHKE PRODUCTS
809
Proof: Let X denote the closure of linear combinations of
Â©
1, tÎ»1, tÎ»2, Â· Â· Â·
Âª
in
C ([0, b]) . If X Ì¸= C ([0, b]) , then letting f âˆˆC ([0, b]) \ X, deï¬ne Î› âˆˆC ([0, b])â€² as
follows. First let Î›0 : X + Cf be given by Î›0 (g + Î±f) = Î± ||f||âˆž. Then
sup
||g+Î±f||â‰¤1
|Î›0 (g + Î±f)|
=
sup
||g+Î±f||â‰¤1
|Î±| ||f||âˆž
=
sup
||g/Î±+f||â‰¤
1
|Î±|
|Î±| ||f||âˆž
=
sup
||g+f||â‰¤
1
|Î±|
|Î±| ||f||âˆž
Now dist (f, X) > 0 because X is closed. Therefore, there exists a lower bound,
Î· > 0 to ||g + f|| for g âˆˆX. Therefore, the above is no larger than
sup
|Î±|â‰¤1
Î·
|Î±| ||f||âˆž=
Âµ1
Î·
Â¶
||f||âˆž
which shows that ||Î›0|| â‰¤
Â³
1
Î·
Â´
||f||âˆž. By the Hahn Banach theorem Î›0 can be
extended to Î› âˆˆC ([0, b])â€² which has the property that Î› (X) = 0 but Î› (f) =
||f|| Ì¸= 0. By the Weierstrass approximation theorem, Theorem 7.6 or one of its
cases, there exists a polynomial, p such that Î› (p) Ì¸= 0. Therefore, if it can be
shown that whenever Î› (X) = 0, it is the case that Î› (p) = 0 for all polynomials, it
must be the case that X is dense in C ([0, b]).
By the Riesz representation theorem the elements of C ([0, b])â€² are complex mea-
sures. Suppose then that for Âµ a complex measure it follows that for all tÎ»k,
Z
[0,b]
tÎ»kdÂµ = 0.
I want to show that then
Z
[0,b]
tkdÂµ = 0
for all positive integers. It suï¬ƒces to modify Âµ is necessary to have Âµ ({0}) = 0 since
this will not change any of the above integrals. Let Âµ1 (E) = Âµ (E âˆ©(0, b]) and use
Âµ1. I will continue using the symbol, Âµ.
For Re (z) > 0, deï¬ne
F (z) â‰¡
Z
[0,b]
tzdÂµ =
Z
(0,b]
tzdÂµ
The function tz = exp (z ln (t)) is analytic. I claim that F (z) is also analytic for
Re z > 0. Apply Moreaâ€™s theorem. Let T be a triangle in Re z > 0. Then
Z
âˆ‚T
F (z) dz =
Z
âˆ‚T
Z
(0,b]
e(z ln(t))Î¾d |Âµ| dz

810
INFINITE PRODUCTS
Now
R
âˆ‚T can be split into three integrals over intervals of R and so this integral is es-
sentially a Lebesgue integral taken with respect to Lebesgue measure. Furthermore,
e(z ln(t)) is a continuous function of the two variables and Î¾ is a function of only the
one variable, t. Thus the integrand is product measurable. The iterated integral is
also absolutely integrable because
Â¯Â¯e(z ln(t))Â¯Â¯ â‰¤ex ln t â‰¤ex ln b where x + iy = z and
x is given to be positive. Thus the integrand is actually bounded. Therefore, you
can apply Fubiniâ€™s theorem and write
Z
âˆ‚T
F (z) dz
=
Z
âˆ‚T
Z
(0,b]
e(z ln(t))Î¾d |Âµ| dz
=
Z
(0,b]
Î¾
Z
âˆ‚T
e(z ln(t))dzd |Âµ| = 0.
By Moreaâ€™s theorem, F is analytic on Re z > 0 which is given to have zeros at the
Î»k.
Now let Ï† (z) = 1+z
1âˆ’z. Then Ï† maps B (0, 1) one to one onto Re z > 0. To see this
let 0 < r < 1.
Ï†
Â¡
reiÎ¸Â¢
= 1 + reiÎ¸
1 âˆ’reiÎ¸ = 1 âˆ’r2 + i2r sin Î¸
1 + r2 âˆ’2r cos Î¸
and so Re Ï†
Â¡
reiÎ¸Â¢
> 0. Now the inverse of Ï† is Ï†âˆ’1 (z) = zâˆ’1
z+1. For Re z > 0,
Â¯Â¯Ï†âˆ’1 (z)
Â¯Â¯2 = z âˆ’1
z + 1 Â· z âˆ’1
z + 1 = |z|2 âˆ’2 Re z + 1
|z|2 + 2 Re z + 1
< 1.
Consider F â—¦Ï†, an analytic function deï¬ned on B (0, 1). This function is given to
have zeros at zn where Ï† (zn) = 1+zn
1âˆ’zn = Î»n. This reduces to zn = âˆ’1+Î»n
1+Î»n . Now
1 âˆ’|zn| â‰¥
c
1 + Î»n
for a positive constant, c. It is given that P
1
Î»n = âˆž. so it follows P (1 âˆ’|zn|) = âˆž
also. Therefore, by Corollary 29.29, F â—¦Ï† = 0. It follows F = 0 also. In particular,
F (k) for k a positive integer equals zero. This has shown that if Î› âˆˆC ([0, b])â€² and
Î› sends 1 and all the tÎ»n to 0, then Î› sends 1 and all tk for k a positive integer to
zero. As explained above, X is dense in C ((0, b]) .
The converse of this theorem is also true and is proved in Rudin [45].
29.6
Exercises
1. Suppose f is an entire function with f (0) = 1. Let
M (r) = max {|f (z)| : |z| = r} .
Use Jensenâ€™s equation to establish the following inequality.
M (2r) â‰¥2n(r)
where n (r) is the number of zeros of f in B (0, r).

29.6.
EXERCISES
811
2. The version of the Blaschke product presented above is that found in most
complex variable texts.
However, there is another one in [37].
Instead of
Î±nâˆ’z
1âˆ’Î±nz
|Î±n|
Î±n you use
Î±n âˆ’z
1
Î±n âˆ’z
Prove a version of Theorem 29.26 using this modiï¬cation.
3. The Weierstrass approximation theorem holds for polynomials of n variables
on any compact subset of Rn. Give a multidimensional version of the MÂ¨untz-
Szasz theorem which will generalize the Weierstrass approximation theorem
for n dimensions.
You might just pick a compact subset of Rn in which
all components are positive.
You have to do something like this because
otherwise, tÎ» might not be deï¬ned.
4. Show cos (Ï€z) = Qâˆž
k=1
Â³
1 âˆ’
4z2
(2kâˆ’1)2
Â´
.
5. Recall sin (Ï€z) = zÏ€ Qâˆž
n=1
Â³
1 âˆ’
Â¡ z
n
Â¢2Â´
. Use this to derive Wallis product,
Ï€
2 = Qâˆž
k=1
4k2
(2kâˆ’1)(2k+1).
6. The order of an entire function, f is deï¬ned as
inf
n
a â‰¥0 : |f (z)| â‰¤e|z|a for all large enough |z|
o
If no such a exists, the function is said to be of inï¬nite order. Show the order
of an entire function is also equal to lim suprâ†’âˆž
ln(ln(M(r)))
ln(r)
where M (r) â‰¡
max {|f (z)| : |z| = r}.
7. Suppose â„¦is a simply connected region and let f be meromorphic on â„¦.
Suppose also that the set, S â‰¡{z âˆˆâ„¦: f (z) = c} has a limit point in â„¦. Can
you conclude f (z) = c for all z âˆˆâ„¦?
8. This and the next collection of problems are dealing with the gamma function.
Show that
Â¯Â¯Â¯
Â³
1 + z
n
Â´
e
âˆ’z
n âˆ’1
Â¯Â¯Â¯ â‰¤C (z)
n2
and therefore,
âˆž
X
n=1
Â¯Â¯Â¯
Â³
1 + z
n
Â´
e
âˆ’z
n âˆ’1
Â¯Â¯Â¯ < âˆž
with the convergence uniform on compact sets.
9. â†‘Show Qâˆž
n=1
Â¡
1 + z
n
Â¢
e
âˆ’z
n converges to an analytic function on C which has
zeros only at the negative integers and that therefore,
âˆž
Y
n=1
Â³
1 + z
n
Â´âˆ’1
e
z
n

812
INFINITE PRODUCTS
is a meromorphic function (Analytic except for poles) having simple poles at
the negative integers.
10. â†‘Show there exists Î³ such that if
Î“ (z) â‰¡eâˆ’Î³z
z
âˆž
Y
n=1
Â³
1 + z
n
Â´âˆ’1
e
z
n ,
then Î“ (1) = 1. Thus Î“ is a meromorphic function having simple poles at the
negative integers. Hint: Qâˆž
n=1 (1 + n) eâˆ’1/n = c = eÎ³.
11. â†‘Now show that
Î³ = lim
nâ†’âˆž
" n
X
k=1
1
k âˆ’ln n
#
12. â†‘Justify the following argument leading to Gaussâ€™s formula
Î“ (z) = lim
nâ†’âˆž
Ãƒ n
Y
k=1
Âµ
k
k + z
Â¶
e
z
k
!
eâˆ’Î³z
z
=
lim
nâ†’âˆž
Âµ
n!
(1 + z) (2 + z) Â· Â· Â· (n + z)ez(
Pn
k=1
1
k)
Â¶ eâˆ’Î³z
z
=
lim
nâ†’âˆž
n!
(1 + z) (2 + z) Â· Â· Â· (n + z)ez(
Pn
k=1
1
k)eâˆ’z[
Pn
k=1
1
k âˆ’ln n]
=
lim
nâ†’âˆž
n!nz
(1 + z) (2 + z) Â· Â· Â· (n + z).
13. â†‘Verify from the Gauss formula above that Î“ (z + 1) = Î“ (z) z and that for n
a nonnegative integer, Î“ (n + 1) = n!.
14. â†‘The usual deï¬nition of the gamma function for positive x is
Î“1 (x) â‰¡
Z âˆž
0
eâˆ’ttxâˆ’1dt.
Show
Â¡
1 âˆ’t
n
Â¢n â‰¤eâˆ’t for t âˆˆ[0, n] . Then show
Z n
0
Âµ
1 âˆ’t
n
Â¶n
txâˆ’1dt =
n!nx
x (x + 1) Â· Â· Â· (x + n).
Use the ï¬rst part to conclude that
Î“1 (x) = lim
nâ†’âˆž
n!nx
x (x + 1) Â· Â· Â· (x + n) = Î“ (x) .
Hint: To show
Â¡
1 âˆ’t
n
Â¢n â‰¤eâˆ’t for t âˆˆ[0, n] , verify this is equivalent to
showing (1 âˆ’u)n â‰¤eâˆ’nu for u âˆˆ[0, 1].

29.6.
EXERCISES
813
15. â†‘Show Î“ (z) =
R âˆž
0
eâˆ’ttzâˆ’1dt. whenever Re z > 0. Hint: You have already
shown that this is true for positive real numbers.
Verify this formula for
Re z > 0 yields an analytic function.
16. â†‘Show Î“
Â¡ 1
2
Â¢
= âˆšÏ€. Then ï¬nd Î“
Â¡ 5
2
Â¢
.
17. Show that
R âˆž
âˆ’âˆže
âˆ’s2
2 ds =
âˆš
2Ï€. Hint: Denote this integral by I and observe
that I2 =
R
R2 eâˆ’(x2+y2)/2dxdy. Then change variables to polar coordinates,
x = r cos (Î¸), y = r sin Î¸.
18. â†‘Now that you know what the gamma function is, consider in the formula
for Î“ (Î± + 1) the following change of variables. t = Î± + Î±1/2s. Then in terms
of the new variable, s, the formula for Î“ (Î± + 1) is
eâˆ’Î±Î±Î±+ 1
2
Z âˆž
âˆ’âˆšÎ±
eâˆ’âˆšÎ±s
Âµ
1 +
s
âˆšÎ±
Â¶Î±
ds
= eâˆ’Î±Î±Î±+ 1
2
Z âˆž
âˆ’âˆšÎ±
e
Î±
h
ln
Â³
1+
s
âˆšÎ±
Â´
âˆ’
s
âˆšÎ±
i
ds
Show the integrand converges to eâˆ’s2
2 . Show that then
lim
Î±â†’âˆž
Î“ (Î± + 1)
eâˆ’Î±Î±Î±+(1/2) =
Z âˆž
âˆ’âˆž
e
âˆ’s2
2 ds =
âˆš
2Ï€.
Hint: You will need to obtain a dominating function for the integral so that
you can use the dominated convergence theorem. You might try considering
s âˆˆ(âˆ’âˆšÎ±, âˆšÎ±) ï¬rst and consider something like e1âˆ’(s2/4) on this interval.
Then look for another function for s > âˆšÎ±. This formula is known as Stirlingâ€™s
formula.
19. This and the next several problems develop the zeta function and give a
relation between the zeta and the gamma function. Deï¬ne for 0 < r < 2Ï€
Ir (z)
â‰¡
Z 2Ï€
0
e(zâˆ’1)(ln r+iÎ¸)
ereiÎ¸ âˆ’1
ireiÎ¸dÎ¸ +
Z âˆž
r
e(zâˆ’1)(ln t+2Ï€i)
et âˆ’1
dt (29.24)
+
Z r
âˆž
e(zâˆ’1) ln t
et âˆ’1 dt
Show that Ir is an entire function. The reason 0 < r < 2Ï€ is that this prevents
ereiÎ¸ âˆ’1 from equaling zero. The above is just a precise description of the
contour integral,
R
Î³
wzâˆ’1
ewâˆ’1dw where Î³ is the contour shown below.

814
INFINITE PRODUCTS
-


-
?
in which on the integrals along the real line, the argument is diï¬€erent in going
from r to âˆžthan it is in going from âˆžto r. Now I have not deï¬ned such
contour integrals over contours which have inï¬nite length and so have chosen
to simply write out explicitly what is involved. You have to work with these
integrals given above anyway but the contour integral just mentioned is the
motivation for them. Hint: You may want to use convergence theorems from
real analysis if it makes this more convenient but you might not have to.
20. â†‘In the context of Problem 19 deï¬ne for small Î´ > 0
IrÎ´ (z) â‰¡
Z
Î³r,Î´
wzâˆ’1
ew âˆ’1dw
where Î³rÎ´ is shown below.
-


-
?
2Î´
sÂ¡
Â¡
Â¡

r
x
Show that limÎ´â†’0 IrÎ´ (z) = Ir (z) . Hint:
Use the dominated convergence
theorem if it makes this go easier. This is not a hard problem if you use these
theorems but you can probably do it without them with more work.
21. â†‘In the context of Problem 20 show that for r1 < r, IrÎ´ (z) âˆ’Ir1Î´ (z) is a
contour integral,
Z
Î³r,r1,Î´
wzâˆ’1
ew âˆ’1dw
where the oriented contour is shown below.

29.6.
EXERCISES
815

-
?
-

6
Î³r,r1,Î´
In this contour integral, wzâˆ’1 denotes e(zâˆ’1) log(w) where log (w) = ln |w| +
i arg (w) for arg (w) âˆˆ(0, 2Ï€) . Explain why this integral equals zero. From
Problem 20 it follows that Ir = Ir1. Therefore, you can deï¬ne an entire func-
tion, I (z) â‰¡Ir (z) for all r positive but suï¬ƒciently small. Hint: Remember
the Cauchy integral formula for analytic functions deï¬ned on simply connected
regions. You could argue there is a simply connected region containing Î³r,r1,Î´.
22. â†‘In case Re z > 1, you can get an interesting formula for I (z) by taking the
limit as r â†’0. Recall that
Ir (z)
â‰¡
Z 2Ï€
0
e(zâˆ’1)(ln r+iÎ¸)
ereiÎ¸ âˆ’1
ireiÎ¸dÎ¸ +
Z âˆž
r
e(zâˆ’1)(ln t+2Ï€i)
et âˆ’1
dt (29.25)
+
Z r
âˆž
e(zâˆ’1) ln t
et âˆ’1 dt
and now it is desired to take a limit in the case where Re z > 1. Show the ï¬rst
integral above converges to 0 as r â†’0. Next argue the sum of the two last
integrals converges to
Â³
e(zâˆ’1)2Ï€i âˆ’1
Â´ Z âˆž
0
e(zâˆ’1) ln(t)
et âˆ’1
dt.
Thus
I (z) =
Â¡
ez2Ï€i âˆ’1
Â¢ Z âˆž
0
e(zâˆ’1) ln(t)
et âˆ’1
dt
(29.26)
when Re z > 1.
23. â†‘So what does all this have to do with the zeta function and the gamma
function? The zeta function is deï¬ned for Re z > 1 by
âˆž
X
n=1
1
nz â‰¡Î¶ (z) .
By Problem 15, whenever Re z > 0,
Î“ (z) =
Z âˆž
0
eâˆ’ttzâˆ’1dt.

816
INFINITE PRODUCTS
Change the variable and conclude
Î“ (z) 1
nz =
Z âˆž
0
eâˆ’nsszâˆ’1ds.
Therefore, for Re z > 1,
Î¶ (z) Î“ (z) =
âˆž
X
n=1
Z âˆž
0
eâˆ’nsszâˆ’1ds.
Now show that you can interchange the order of the sum and the integral.
This is possibly most easily done by using Fubiniâ€™s theorem.
Show that
Pâˆž
n=1
R âˆž
0
Â¯Â¯eâˆ’nsszâˆ’1Â¯Â¯ ds < âˆžand then use Fubiniâ€™s theorem.
I think you
could do it other ways though. It is possible to do it without any reference to
Lebesgue integration. Thus
Î¶ (z) Î“ (z)
=
Z âˆž
0
szâˆ’1
âˆž
X
n=1
eâˆ’nsds
=
Z âˆž
0
szâˆ’1eâˆ’s
1 âˆ’eâˆ’s ds =
Z âˆž
0
szâˆ’1
es âˆ’1ds
By 29.26,
I (z)
=
Â¡
ez2Ï€i âˆ’1
Â¢ Z âˆž
0
e(zâˆ’1) ln(t)
et âˆ’1
dt
=
Â¡
ez2Ï€i âˆ’1
Â¢
Î¶ (z) Î“ (z)
=
Â¡
e2Ï€iz âˆ’1
Â¢
Î¶ (z) Î“ (z)
whenever Re z > 1.
24. â†‘Now show there exists an entire function, h (z) such that
Î¶ (z) =
1
z âˆ’1 + h (z)
for Re z > 1. Conclude Î¶ (z) extends to a meromorphic function deï¬ned on
all of C which has a simple pole at z = 1, namely, the right side of the above
formula. Hint: Use Problem 10 to observe that Î“ (z) is never equal to zero
but has simple poles at every nonnegative integer. Then for Re z > 1,
Î¶ (z) â‰¡
I (z)
(e2Ï€iz âˆ’1) Î“ (z).
By 29.26 Î¶ has no poles for Re z > 1. The right side of the above equation is
deï¬ned for all z. There are no poles except possibly when z is a nonnegative
integer. However, these points are not poles either because of Problem 10
which states that Î“ has simple poles at these points thus cancelling the simple

29.6.
EXERCISES
817
zeros of
Â¡
e2Ï€iz âˆ’1
Â¢
. The only remaining possibility for a pole for Î¶ is at z = 1.
Show it has a simple pole at this point. You can use the formula for I (z)
I (z)
â‰¡
Z 2Ï€
0
e(zâˆ’1)(ln r+iÎ¸)
ereiÎ¸ âˆ’1
ireiÎ¸dÎ¸ +
Z âˆž
r
e(zâˆ’1)(ln t+2Ï€i)
et âˆ’1
dt (29.27)
+
Z r
âˆž
e(zâˆ’1) ln t
et âˆ’1 dt
Thus I (1) is given by
I (1) â‰¡
Z 2Ï€
0
1
ereiÎ¸ âˆ’1ireiÎ¸dÎ¸ +
Z âˆž
r
1
et âˆ’1dt +
Z r
âˆž
1
et âˆ’1dt
=
R
Î³r
dw
ewâˆ’1 where Î³r is the circle of radius r. This contour integral equals 2Ï€i
by the residue theorem. Therefore,
I (z)
(e2Ï€iz âˆ’1) Î“ (z) =
1
z âˆ’1 + h (z)
where h (z) is an entire function. People worry a lot about where the zeros of
Î¶ are located. In particular, the zeros for Re z âˆˆ(0, 1) are of special interest.
The Riemann hypothesis says they are all on the line Re z = 1/2. This is a
good problem for you to do next.
25. There is an important relation between prime numbers and the zeta function
due to Euler. Let {pn}âˆž
n=1 be the prime numbers. Then for Re z > 1,
âˆž
Y
n=1
1
1 âˆ’pâˆ’z
n
= Î¶ (z) .
To see this, consider a partial product.
N
Y
n=1
1
1 âˆ’pâˆ’z
n
=
N
Y
n=1
âˆž
X
jn=1
Âµ 1
pzn
Â¶jn
.
Let SN denote all positive integers which use only p1, Â· Â· Â·, pN in their prime
factorization. Then the above equals P
nâˆˆSN
1
nz . Letting N â†’âˆžand using
the fact that Re z > 1 so that the order in which you sum is not important (See
Theorem 30.1 or recall advanced calculus. ) you obtain the desired equation.
Show Pâˆž
n=1
1
pn = âˆž.

818
INFINITE PRODUCTS

Elliptic Functions
This chapter is to give a short introduction to elliptic functions. There is much
more available. There are books written on elliptic functions. What I am presenting
here follows Alfors [2] although the material is found in many books on complex
analysis. Hille, [27] has a much more extensive treatment than what I will attempt
here. There are also many references and historical notes available in the book by
Hille. Another good source for more having much the same emphasis as what is
presented here is in the book by Saks and Zygmund [47]. This is a very interesting
subject because it has considerable overlap with algebra.
Before beginning, recall that an absolutely convergent series can be summed in
any order and you always get the same answer. The easy way to see this is to think
of the series as a Lebesgue integral with respect to counting measure and apply
convergence theorems as needed.
The following theorem provides the necessary
results.
Theorem 30.1 Suppose Pâˆž
n=1 |an| < âˆžand let Î¸, Ï† : N â†’N be one to one and
onto mappings. Then Pâˆž
n=1 aÏ†(n) and Pâˆž
n=1 aÎ¸(n) both converge and the two sums
are equal.
Proof: By the monotone convergence theorem,
âˆž
X
n=1
|an| = lim
nâ†’âˆž
n
X
k=1
Â¯Â¯aÏ†(k)
Â¯Â¯ = lim
nâ†’âˆž
n
X
k=1
Â¯Â¯aÎ¸(k)
Â¯Â¯
but these last two equal Pâˆž
k=1
Â¯Â¯aÏ†(k)
Â¯Â¯ and Pâˆž
k=1
Â¯Â¯aÎ¸(k)
Â¯Â¯ respectively.
Therefore,
Pâˆž
k=1 aÎ¸(k) and Pâˆž
k=1 aÏ†(k) exist (n â†’aÎ¸(n) is in L1 with respect to counting
measure.)
It remains to show the two are equal.
There exists M such that if
n > M then
âˆž
X
k=n+1
Â¯Â¯aÎ¸(k)
Â¯Â¯ < Îµ,
âˆž
X
k=n+1
Â¯Â¯aÏ†(k)
Â¯Â¯ < Îµ
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=1
aÏ†(k) âˆ’
n
X
k=1
aÏ†(k)
Â¯Â¯Â¯Â¯Â¯ < Îµ,
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=1
aÎ¸(k) âˆ’
n
X
k=1
aÎ¸(k)
Â¯Â¯Â¯Â¯Â¯ < Îµ
819

820
ELLIPTIC FUNCTIONS
Pick such an n denoted by n1. Then pick n2 > n1 > M such that
{Î¸ (1) , Â· Â· Â·, Î¸ (n1)} âŠ†{Ï† (1) , Â· Â· Â·, Ï† (n2)} .
Then
n2
X
k=1
aÏ†(k) =
n1
X
k=1
aÎ¸(k) +
X
Ï†(k)/âˆˆ{Î¸(1),Â·Â·Â·,Î¸(n1)}
aÏ†(k).
Therefore,
Â¯Â¯Â¯Â¯Â¯
n2
X
k=1
aÏ†(k) âˆ’
n1
X
k=1
aÎ¸(k)
Â¯Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯Â¯Â¯
X
Ï†(k)/âˆˆ{Î¸(1),Â·Â·Â·,Î¸(n1)},kâ‰¤n2
aÏ†(k)
Â¯Â¯Â¯Â¯Â¯Â¯
Now all of these Ï† (k) in the last sum are contained in {Î¸ (n1 + 1) , Â· Â· Â·} and so the
last sum above is dominated by
â‰¤
âˆž
X
k=n1+1
Â¯Â¯aÎ¸(k)
Â¯Â¯ < Îµ.
Therefore,
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=1
aÏ†(k) âˆ’
âˆž
X
k=1
aÎ¸(k)
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=1
aÏ†(k) âˆ’
n2
X
k=1
aÏ†(k)
Â¯Â¯Â¯Â¯Â¯
+
Â¯Â¯Â¯Â¯Â¯
n2
X
k=1
aÏ†(k) âˆ’
n1
X
k=1
aÎ¸(k)
Â¯Â¯Â¯Â¯Â¯
+
Â¯Â¯Â¯Â¯Â¯
n1
X
k=1
aÎ¸(k) âˆ’
âˆž
X
k=1
aÎ¸(k)
Â¯Â¯Â¯Â¯Â¯
<
Îµ + Îµ + Îµ = 3Îµ
and since Îµ is arbitrary, it follows Pâˆž
k=1 aÏ†(k) = Pâˆž
k=1 aÎ¸(k) as claimed. This proves
the theorem.
30.1
Periodic Functions
Deï¬nition 30.2 A function deï¬ned on C is said to be periodic if there exists w
such that f (z + w) = f (z) for all z âˆˆC. Denote by M the set of all periods. Thus
if w1, w2 âˆˆM and a, b âˆˆZ, then aw1 + bw2 âˆˆM. For this reason M is called the
module of periods.1In all which follows it is assumed f is meromorphic.
Theorem 30.3 Let f be a meromorphic function and let M be the module of peri-
ods. Then if M has a limit point, then f equals a constant. If this does not happen
then either there exists w1 âˆˆM such that Zw1 = M or there exist w1, w2 âˆˆM such
that M = {aw1 + bw2 : a, b âˆˆZ} and w1/w2 is not real. Also if Ï„ = w2/w1,
|Ï„| â‰¥1, âˆ’1
2 â‰¤Re Ï„ â‰¤1
2.
1A module is like a vector space except instead of a ï¬eld of scalars, you have a ring of scalars.

30.1.
PERIODIC FUNCTIONS
821
Proof: Suppose f is meromorphic and M has a limit point, w0. By Theorem
29.10 on Page 794 there exist analytic functions, p, q such that f (z) = p(z)
q(z). Now
pick z0 such that z0 is not a pole of f. Then letting wn â†’w0 where {wn} âŠ†M,
f (z0 + wn) = f (z0) . Therefore, p (z0 + wn) = f (z0) q (z0 + wn) and so the analytic
function, p (z) âˆ’f (z0) q (z) has a zero set which has a limit point. Therefore, this
function is identically equal to zero because of Theorem 24.23 on Page 657. Thus
f equals a constant as claimed.
This has shown that if f is not constant, then M is discreet. Therefore, there
exists w1 âˆˆM such that |w1| = min {|w| : w âˆˆM}. Suppose ï¬rst that every element
of M is a real multiple of w1. Thus, if w âˆˆM, it follows there exists a real number,
x such that w = xw1. Then there exist positive integers, k, k + 1 such that k â‰¤x <
k +1. If x > k, then w âˆ’kw1 = (x âˆ’k) w1 is a period having smaller absolute value
than |w1| which would be a contradiction. Hence, x = k and so M = Zw1.
Now suppose there exists w2 âˆˆM which is not a real multiple of w1.
You
can let w2 be the element of M having this property which has smallest absolute
value. Now let w âˆˆM. Since w1 and w2 point in diï¬€erent directions, it follows
w = xw1 +yw2 for some real numbers, x, y. Let |m âˆ’x| â‰¤1
2 and |n âˆ’y| â‰¤1
2 where
m, n are integers. Therefore,
w = mw1 + nw2 + (x âˆ’m) w1 + (y âˆ’n) w2
and so
w âˆ’mw1 âˆ’nw2 = (x âˆ’m) w1 + (y âˆ’n) w2
(30.1)
Now since w2/w1 /âˆˆR,
|(x âˆ’m) w1 + (y âˆ’n) w2|
<
|(x âˆ’m) w1| + |(y âˆ’n) w2|
=
1
2 |w1| + 1
2 |w2| .
Therefore, from 30.1,
|w âˆ’mw1 âˆ’nw2|
=
|(x âˆ’m) w1 + (y âˆ’n) w2|
<
1
2 |w1| + 1
2 |w2| â‰¤|w2|
and so the period, w âˆ’mw1 âˆ’nw2 cannot be a non real multiple of w1 because w2
is the one which has smallest absolute value and this period has smaller absolute
value than w2. Therefore, the ratio w âˆ’mw1 âˆ’nw2/w1 must be a real number, x.
Thus
w âˆ’mw1 âˆ’nw2 = xw1
Since w1 has minimal absolute value of all periods, it follows |x| â‰¥1. Let k â‰¤x <
k + 1 for some integer, k. If x > k, then
w âˆ’mw1 âˆ’nw2 âˆ’kw1 = (x âˆ’k) w1
which would contradict the choice of w1 as being the period having minimal absolute
value because the expression on the left in the above is a period and it equals

822
ELLIPTIC FUNCTIONS
something which has absolute value less than |w1|. Therefore, x = k and w is an
integer linear combination of w1 and w2. It only remains to verify the claim about
Ï„.
From the construction, |w1| â‰¤|w2| and |w2| â‰¤|w1 âˆ’w2| , |w2| â‰¤|w1 + w2| .
Therefore,
|Ï„| â‰¥1, |Ï„| â‰¤|1 âˆ’Ï„| , |Ï„| â‰¤|1 + Ï„| .
The last two of these inequalities imply âˆ’1/2 â‰¤Re Ï„ â‰¤1/2.
This proves the theorem.
Deï¬nition 30.4 For f a meromorphic function which has the last of the above
alternatives holding in which M = {aw1 + bw2 : a, b âˆˆZ} , the function, f is called
elliptic. This is also called doubly periodic.
Theorem 30.5 Suppose f is an elliptic function which has no poles. Then f is
constant.
Proof: Since f has no poles it is analytic. Now consider the parallelograms
determined by the vertices, mw1 +nw2 for m, n âˆˆZ. By periodicity of f it must be
bounded because its values are identical on each of these parallelograms. Therefore,
it equals a constant by Liouvilleâ€™s theorem.
Deï¬nition 30.6 Deï¬ne Pa to be the parallelogram determined by the points
a + mw1 + nw2, a + (m + 1) w1 + nw2, a + mw1 + (n + 1) w2,
a + (m + 1) w1 + (n + 1) w2
Such Pa will be referred to as a period parallelogram. The sum of the orders of
the poles in a period parallelogram which contains no poles or zeros of f on its
boundary is called the order of the function. This is well deï¬ned because of the
periodic property of f.
Theorem 30.7 The sum of the residues of any elliptic function, f equals zero on
every Pa if a is chosen so that there are no poles on âˆ‚Pa.
Proof: Choose a such that there are no poles of f on the boundary of Pa. By
periodicity,
Z
âˆ‚Pa
f (z) dz = 0
because the integrals over opposite sides of the parallelogram cancel out because
the values of f are the same on these sides and the orientations are opposite. It
follows from the residue theorem that the sum of the residues in Pa equals 0.
Theorem 30.8 Let Pa be a period parallelogram for a nonconstant elliptic function,
f which has order equal to m. Then f assumes every value in f (Pa) exactly m
times.

30.1.
PERIODIC FUNCTIONS
823
Proof: Let c âˆˆf (Pa) and consider Paâ€² such that f âˆ’1 (c) âˆ©Paâ€² = f âˆ’1 (c) âˆ©Pa
and Paâ€² contains the same poles and zeros of f âˆ’c as Pa but Paâ€² has no zeros of
f (z) âˆ’c or poles of f on its boundary. Thus f â€² (z) / (f (z) âˆ’c) is also an elliptic
function and so Theorem 30.7 applies. Consider
1
2Ï€i
Z
âˆ‚Paâ€²
f â€² (z)
f (z) âˆ’cdz.
By the argument principle, this equals Nzâˆ’Np where Nz equals the number of zeros
of f (z)âˆ’c and Np equals the number of the poles of f (z). From Theorem 30.7 this
must equal zero because it is the sum of the residues of f â€²/ (f âˆ’c) and so Nz = Np.
Now Np equals the number of poles in Pa counted according to multiplicity.
There is an even better theorem than this one.
Theorem 30.9 Let f be a non constant elliptic function and suppose it has poles
p1, Â· Â· Â·, pm and zeros, z1, Â· Â· Â·, zm in PÎ±, listed according to multiplicity where âˆ‚PÎ±
contains no poles or zeros of f. Then Pm
k=1 zk âˆ’Pm
k=1 pk âˆˆM, the module of
periods.
Proof: You can assume âˆ‚Pa contains no poles or zeros of f because if it did,
then you could consider a slightly shifted period parallelogram, Paâ€² which contains
no new zeros and poles but which has all the old ones but no poles or zeros on its
boundary. By Theorem 26.8 on Page 710
1
2Ï€i
Z
âˆ‚Pa
z f â€² (z)
f (z) dz =
m
X
k=1
zk âˆ’
m
X
k=1
pk.
(30.2)
Denoting by Î³ (z, w) the straight oriented line segment from z to w,
Z
âˆ‚Pa
z f â€² (z)
f (z) dz
=
Z
Î³(a,a+w1)
z f â€² (z)
f (z) dz +
Z
Î³(a+w1+w2,a+w2)
z f â€² (z)
f (z) dz
+
Z
Î³(a+w1,a+w2+w1)
z f â€² (z)
f (z) dz +
Z
Î³(a+w2,a)
z f â€² (z)
f (z) dz
=
Z
Î³(a,a+w1)
(z âˆ’(z + w2)) f â€² (z)
f (z) dz
+
Z
Î³(a,a+w2)
(z âˆ’(z + w1)) f â€² (z)
f (z) dz
Now near these line segments f â€²(z)
f(z) is analytic and so there exists a primitive, gwi (z)
on Î³ (a, a + wi) by Corollary 24.32 on Page 663 which satisï¬es egwi(z) = f (z).
Therefore,
= âˆ’w2 (gw1 (a + w1) âˆ’gw1 (a)) âˆ’w1 (gw2 (a + w2) âˆ’gw2 (a)) .

824
ELLIPTIC FUNCTIONS
Now by periodicity of f it follows f (a + w1) = f (a) = f (a + w2) . Hence
gwi (a + w1) âˆ’gwi (a) = 2mÏ€i
for some integer, m because
egwi(a+wi) âˆ’egwi(a) = f (a + wi) âˆ’f (a) = 0.
Therefore, from 30.2, there exist integers, k, l such that
1
2Ï€i
Z
âˆ‚Pa
z f â€² (z)
f (z) dz
=
1
2Ï€i [âˆ’w2 (gw1 (a + w1) âˆ’gw1 (a)) âˆ’w1 (gw2 (a + w2) âˆ’gw2 (a))]
=
1
2Ï€i [âˆ’w2 (2kÏ€i) âˆ’w1 (2lÏ€i)]
=
âˆ’w2k âˆ’w1l âˆˆM.
From 30.2 it follows
m
X
k=1
zk âˆ’
m
X
k=1
pk âˆˆM.
This proves the theorem.
Hille says this relation is due to Liouville. There is also a simple corollary which
follows from the above theorem applied to the elliptic function, f (z) âˆ’c.
Corollary 30.10 Let f be a non constant elliptic function and suppose the func-
tion, f (z) âˆ’c has poles p1, Â· Â· Â·, pm and zeros, z1, Â· Â· Â·, zm on PÎ±, listed according to
multiplicity where âˆ‚PÎ± contains no poles or zeros of f (z) âˆ’c. Then Pm
k=1 zk âˆ’
Pm
k=1 pk âˆˆM, the module of periods.
30.1.1
The Unimodular Transformations
Deï¬nition 30.11 Suppose f is a nonconstant elliptic function and the module of
periods is of the form {aw1 + bw2} where a, b are integers and w1/w2 is not real.
Then by analogy with linear algebra, {w1, w2} is referred to as a basis. The uni-
modular transformations will refer to matrices of the form
Âµ
a
b
c
d
Â¶
where all entries are integers and
ad âˆ’bc = Â±1.
These linear transformations are also called the modular group.
The following is an interesting lemma which ties matrices with the fractional
linear transformations.

30.1.
PERIODIC FUNCTIONS
825
Lemma 30.12 Deï¬ne
Ï†
ÂµÂµ
a
b
c
d
Â¶Â¶
â‰¡az + b
cz + d.
Then
Ï† (AB) = Ï† (A) â—¦Ï† (B) ,
(30.3)
Ï† (A) (z) = z if and only if
A = cI
where I is the identity matrix and c Ì¸= 0. Also if f (z) = az+b
cz+d, then f âˆ’1 (z) exists
if and only if ad âˆ’cb Ì¸= 0. Furthermore it is easy to ï¬nd f âˆ’1.
Proof: The equation in 30.3 is just a simple computation. Now suppose Ï† (A) (z) =
z. Then letting A =
Âµ
a
b
c
d
Â¶
, this requires
az + b = z (cz + d)
and so az + b = cz2 + dz. Since this is to hold for all z it follows c = 0 = b and
a = d. The other direction is obvious.
Consider the claim about the existence of an inverse.
Let ad âˆ’cb Ì¸= 0 for
f (z) = az+b
cz+d. Then
f (z) = Ï†
ÂµÂµ
a
b
c
d
Â¶Â¶
It follows
Âµ a
b
c
d
Â¶âˆ’1
exists and equals
1
adâˆ’bc
Âµ
d
âˆ’b
âˆ’c
a
Â¶
. Therefore,
z
=
Ï† (I) (z) = Ï†
ÂµÂµ a
b
c
d
Â¶ Âµ
1
ad âˆ’bc
Âµ
d
âˆ’b
âˆ’c
a
Â¶Â¶Â¶
(z)
=
Ï†
ÂµÂµ
a
b
c
d
Â¶Â¶
â—¦Ï†
ÂµÂµ
1
ad âˆ’bc
Âµ
d
âˆ’b
âˆ’c
a
Â¶Â¶Â¶
(z)
=
f â—¦f âˆ’1 (z)
which shows f âˆ’1 exists and it is easy to ï¬nd.
Next suppose f âˆ’1 exists. I need to verify the condition ad âˆ’cb Ì¸= 0. If f âˆ’1
exists, then from the process used to ï¬nd it, you see that it must be a fractional
linear transformation. Letting A =
Âµ
a
b
c
d
Â¶
so Ï† (A) = f, it follows there exists
a matrix B such that
Ï† (BA) (z) = Ï† (B) â—¦Ï† (A) (z) = z.
However, it was shown that this implies BA is a nonzero multiple of I which requires
that Aâˆ’1 must exist. Hence the condition must hold.

826
ELLIPTIC FUNCTIONS
Theorem 30.13 If f is a nonconstant elliptic function with a basis {w1, w2} for
the module of periods, then {wâ€²
1, wâ€²
2} is another basis, if and only if there exists a
unimodular transformation,
Âµ
a
b
c
d
Â¶
= A such that
Âµ
wâ€²
1
wâ€²
2
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
w1
w2
Â¶
.
(30.4)
Proof: Since {w1, w2} is a basis, there exist integers, a, b, c, d such that 30.4
holds. It remains to show the transformation determined by the matrix is unimod-
ular. Taking conjugates,
Âµ
wâ€²
1
wâ€²
2
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
w1
w2
Â¶
.
Therefore,
Âµ wâ€²
1
wâ€²
1
wâ€²
2
wâ€²
2
Â¶
=
Âµ a
b
c
d
Â¶ Âµ w1
w1
w2
w2
Â¶
Now since {wâ€²
1, wâ€²
2} is also given to be a basis, there exits another matrix having
all integer entries,
Âµ
e
f
g
h
Â¶
such that
Âµ
w1
w2
Â¶
=
Âµ
e
f
g
h
Â¶ Âµ
wâ€²
1
wâ€²
2
Â¶
and
Âµ
w1
w2
Â¶
=
Âµ
e
f
g
h
Â¶ Âµ
wâ€²
1
wâ€²
2
Â¶
.
Therefore,
Âµ
wâ€²
1
wâ€²
1
wâ€²
2
wâ€²
2
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
e
f
g
h
Â¶ Âµ
wâ€²
1
wâ€²
1
wâ€²
2
wâ€²
2
Â¶
.
However, since wâ€²
1/wâ€²
2 is not real, it is routine to verify that
det
Âµ wâ€²
1
wâ€²
1
wâ€²
2
wâ€²
2
Â¶
Ì¸= 0.
Therefore,
Âµ
1
0
0
1
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
e
f
g
h
Â¶
and so det
Âµ
a
b
c
d
Â¶
det
Âµ
e
f
g
h
Â¶
= 1. But the two matrices have all integer
entries and so both determinants must equal either 1 or âˆ’1.
Next suppose
Âµ
wâ€²
1
wâ€²
2
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
w1
w2
Â¶
(30.5)

30.1.
PERIODIC FUNCTIONS
827
where
Âµ a
b
c
d
Â¶
is unimodular. I need to verify that {wâ€²
1, wâ€²
2} is a basis. If w âˆˆM,
there exist integers, m, n such that
w = mw1 + nw2 =
Â¡
m
n
Â¢ Âµ
w1
w2
Â¶
From 30.5
Â±
Âµ
d
âˆ’b
âˆ’c
a
Â¶ Âµ wâ€²
1
wâ€²
2
Â¶
=
Âµ w1
w2
Â¶
and so
w = Â±
Â¡
m
n
Â¢ Âµ
d
âˆ’b
âˆ’c
a
Â¶ Âµ wâ€²
1
wâ€²
2
Â¶
which is an integer linear combination of {wâ€²
1, wâ€²
2} . It only remains to verify that
wâ€²
1/wâ€²
2 is not real.
Claim: Let w1 and w2 be nonzero complex numbers. Then w2/w1 is not real
if and only if
w1w2 âˆ’w1w2 = det
Âµ
w1
w1
w2
w2
Â¶
Ì¸= 0
Proof of the claim: Let Î» = w2/w1. Then
w1w2 âˆ’w1w2 = Î»w1w1 âˆ’w1Î»w1 =
Â¡
Î» âˆ’Î»
Â¢
|w1|2
Thus the ratio is not real if and only if
Â¡
Î» âˆ’Î»
Â¢
Ì¸= 0 if and only if w1w2 âˆ’w1w2 Ì¸= 0.
Now to verify wâ€²
2/wâ€²
1 is not real,
det
Âµ
wâ€²
1
wâ€²
1
wâ€²
2
wâ€²
2
Â¶
=
det
ÂµÂµ
a
b
c
d
Â¶ Âµ
w1
w1
w2
w2
Â¶Â¶
=
Â± det
Âµ
w1
w1
w2
w2
Â¶
Ì¸= 0
This proves the theorem.
30.1.2
The Search For An Elliptic Function
By Theorem 30.5 and 30.7 if you want to ï¬nd a nonconstant elliptic function it must
fail to be analytic and also have either no terms in its Laurent expansion which are
of the form b1 (z âˆ’a)âˆ’1 or else these terms must cancel out. It is simplest to look
for a function which simply does not have them. Weierstrass looked for a function
of the form
â„˜(z) â‰¡1
z2 +
X
wÌ¸=0
Ãƒ
1
(z âˆ’w)2 âˆ’1
w2
!
(30.6)

828
ELLIPTIC FUNCTIONS
where w consists of all numbers of the form aw1 + bw2 for a, b integers. Sometimes
people write this as â„˜(z, w1, w2) to emphasize its dependence on the periods, w1
and w2 but I wonâ€™t do so. It is understood there exist these periods, which are
given. This is a reasonable thing to try. Suppose you formally diï¬€erentiate the
right side. Never mind whether this is justiï¬ed for now. This yields
â„˜â€² (z) = âˆ’2
z3 âˆ’
X
wÌ¸=0
âˆ’2
(z âˆ’w)3 =
X
w
âˆ’2
(z âˆ’w)3
which is clearly periodic having both periods w1 and w2. Therefore, â„˜(z + w1) âˆ’
â„˜(z) and â„˜(z + w2) âˆ’â„˜(z) are both constants, c1 and c2 respectively. The reason
for this is that since â„˜â€² is periodic with periods w1 and w2, it follows â„˜â€² (z + wi) âˆ’
â„˜â€² (z) = 0 as long as z is not a period. From 30.6 you can see right away that
â„˜(z) = â„˜(âˆ’z)
Indeed
â„˜(âˆ’z)
=
1
z2 +
X
wÌ¸=0
Ãƒ
1
(âˆ’z âˆ’w)2 âˆ’1
w2
!
=
1
z2 +
X
wÌ¸=0
Ãƒ
1
(âˆ’z + w)2 âˆ’1
w2
!
= â„˜(z) .
and so
c1
=
â„˜
Â³
âˆ’w1
2 + w1
Â´
âˆ’â„˜
Â³
âˆ’w1
2
Â´
=
â„˜
Â³w1
2
Â´
âˆ’â„˜
Â³
âˆ’w1
2
Â´
= 0
which shows the constant for â„˜(z + w1) âˆ’â„˜(z) must equal zero.
Similarly the
constant for â„˜(z + w2) âˆ’â„˜(z) also equals zero. Thus â„˜is periodic having the two
periods w1, w2.
Of course to justify this, you need to consider whether the series of 30.6 con-
verges. Consider the terms of the series.
Â¯Â¯Â¯Â¯Â¯
1
(z âˆ’w)2 âˆ’1
w2
Â¯Â¯Â¯Â¯Â¯ = |z|
Â¯Â¯Â¯Â¯Â¯
2w âˆ’z
(z âˆ’w)2 w2
Â¯Â¯Â¯Â¯Â¯
If |w| > 2 |z| , this can be estimated more. For such w,
Â¯Â¯Â¯Â¯Â¯
1
(z âˆ’w)2 âˆ’1
w2
Â¯Â¯Â¯Â¯Â¯
=
|z|
Â¯Â¯Â¯Â¯Â¯
2w âˆ’z
(z âˆ’w)2 w2
Â¯Â¯Â¯Â¯Â¯ â‰¤|z|
(5/2) |w|
|w|2 (|w| âˆ’|z|)2
â‰¤
|z|
(5/2) |w|
|w|2 ((1/2) |w|)2 = |z| 10
|w|3 .

30.1.
PERIODIC FUNCTIONS
829
It follows the series in 30.6 converges uniformly and absolutely on every compact
set, K provided P
wÌ¸=0
1
|w|3 converges. This question is considered next.
Claim: There exists a positive number, k such that for all pairs of integers,
m, n, not both equal to zero,
|mw1 + nw2|
|m| + |n|
â‰¥k > 0.
Proof of claim: If not, there exists mk and nk such that
lim
kâ†’âˆž
mk
|mk| + |nk|w1 +
nk
|mk| + |nk|w2 = 0
However,
Â³
mk
|mk|+|nk|,
nk
|mk|+|nk|
Â´
is a bounded sequence in R2 and so, taking a sub-
sequence, still denoted by k, you can have
Âµ
mk
|mk| + |nk|,
nk
|mk| + |nk|
Â¶
â†’(x, y) âˆˆR2
and so there are real numbers, x, y such that xw1 + yw2 = 0 contrary to the
assumption that w2/w1 is not equal to a real number. This proves the claim.
Now from the claim,
X
wÌ¸=0
1
|w|3
=
X
(m,n)Ì¸=(0,0)
1
|mw1 + nw2|3 â‰¤
X
(m,n)Ì¸=(0,0)
1
k3 (|m| + |n|)3
=
1
k3
âˆž
X
j=1
X
|m|+|n|=j
1
(|m| + |n|)3 = 1
k3
âˆž
X
j=1
4j
j3 < âˆž.
Now consider the series in 30.6. Letting z âˆˆB (0, R) ,
â„˜(z)
â‰¡
1
z2 +
X
wÌ¸=0,|w|â‰¤R
Ãƒ
1
(z âˆ’w)2 âˆ’1
w2
!
+
X
wÌ¸=0,|w|>R
Ãƒ
1
(z âˆ’w)2 âˆ’1
w2
!
and the last series converges uniformly on B (0, R) to an analytic function. Thus â„˜is
a meromorphic function and also the argument given above involving diï¬€erentiation
of the series termwise is valid. Thus â„˜is an elliptic function as claimed. This is
called the Weierstrass â„˜function. This has proved the following theorem.
Theorem 30.14 The function â„˜deï¬ned above is an example of an elliptic function.
On any compact set, â„˜equals a rational function added to a series which is uniformly
and absolutely convergent on the compact set.

830
ELLIPTIC FUNCTIONS
30.1.3
The Diï¬€erential Equation Satisï¬ed By â„˜
For z not a pole,
â„˜â€² (z) = âˆ’2
z3 âˆ’
X
wÌ¸=0
2
(z âˆ’w)3
Also since there are no poles of order 1 you can obtain a primitive for â„˜, âˆ’Î¶.2
To do so, recall
â„˜(z) â‰¡1
z2 +
X
wÌ¸=0
Ãƒ
1
(z âˆ’w)2 âˆ’1
w2
!
where for |z| < R this is the sum of a rational function with a uniformly convergent
series. Therefore, you can take the integral along any path, Î³ (0, z) from 0 to z
which misses the poles of â„˜. By the uniform convergence of the above integral, you
can interchange the sum with the integral and obtain
Î¶ (z) = 1
z +
X
wÌ¸=0
1
z âˆ’w + z
w2 + 1
w
(30.7)
This function is odd. Here is why.
Î¶ (âˆ’z) = 1
âˆ’z +
X
wÌ¸=0
1
âˆ’z âˆ’w âˆ’z
w2 + 1
w
while
âˆ’Î¶ (z)
=
1
âˆ’z +
X
wÌ¸=0
âˆ’1
z âˆ’w âˆ’z
w2 âˆ’1
w
=
1
âˆ’z +
X
wÌ¸=0
âˆ’1
z + w âˆ’z
w2 + 1
w.
Now consider 30.7. It will be used to ï¬nd the Laurent expansion about the origin
for Î¶ which will then be diï¬€erentiated to obtain the Laurent expansion for â„˜at the
origin. Since w Ì¸= 0 and the interest is for z near 0 so |z| < |w| ,
1
z âˆ’w + z
w2 + 1
w
=
z
w2 + 1
w âˆ’1
w
1
1 âˆ’z
w
=
z
w2 + 1
w âˆ’1
w
âˆž
X
k=0
Â³ z
w
Â´k
=
âˆ’1
w
âˆž
X
k=2
Â³ z
w
Â´k
2I donâ€™t know why it is traditional to refer to this antiderivative as âˆ’Î¶ rather than Î¶ but I
am following the convention.
I think it is to minimize the number of minus signs in the next
expression.

30.1.
PERIODIC FUNCTIONS
831
From 30.7
Î¶ (z)
=
1
z +
X
wÌ¸=0
Ãƒ
âˆ’
âˆž
X
k=2
zk
wk+1
!
=
1
z âˆ’
âˆž
X
k=2
X
wÌ¸=0
zk
wk+1 = 1
z âˆ’
âˆž
X
k=2
X
wÌ¸=0
z2kâˆ’1
w2k
because the sum over odd powers must be zero because for each w Ì¸= 0, there exists
âˆ’w Ì¸= 0 such that the two terms
z2k
w2k+1 and
z2k
(âˆ’w)2k+1 cancel each other. Hence
Î¶ (z) = 1
z âˆ’
âˆž
X
k=2
Gkz2kâˆ’1
where Gk = P
wÌ¸=0
1
w2k . Now with this,
âˆ’Î¶â€² (z)
=
â„˜(z) = 1
z2 +
âˆž
X
k=2
Gk (2k âˆ’1) z2kâˆ’2
=
1
z2 + 3G2z2 + 5G3z4 + Â· Â· Â·
Therefore,
â„˜â€² (z) = âˆ’2
z3 + 6G2z + 20G3z3 + Â· Â· Â·
â„˜â€² (z)2
=
4
z6 âˆ’24G2
z2
âˆ’80G3 + Â· Â· Â·
4â„˜(z)3
=
4
Âµ 1
z2 + 3G2z2 + 5G3z4 Â· Â·Â·
Â¶3
=
4
z6 + 36
z2 G2 + 60G3 + Â· Â· Â·
and ï¬nally
60G2â„˜(z) = 60G2
z2
+ 0 + Â· Â· Â·
where in the above, the positive powers of z are not listed explicitly. Therefore,
â„˜â€² (z)2 âˆ’4â„˜(z)3 + 60G2â„˜(z) + 140G3 =
âˆž
X
n=1
anzn
In deriving the equation it was assumed |z| < |w| for all w = aw1+bw2 where a, b are
integers not both zero. The left side of the above equation is periodic with respect
to w1 and w2 where w2/w1 is not a real number. The only possible poles of the
left side are at 0, w1, w2, and w1 +w2, the vertices of the parallelogram determined
by w1 and w2. This follows from the original formula for â„˜(z) . However, the above

832
ELLIPTIC FUNCTIONS
equation shows the left side has no pole at 0. Since the left side is periodic with
periods w1 and w2, it follows it has no pole at the other vertices of this parallelogram
either. Therefore, the left side is periodic and has no poles. Consequently, it equals
a constant by Theorem 30.5. But the right side of the above equation shows this
constant is 0 because this side equals zero when z = 0. Therefore, â„˜satisï¬es the
diï¬€erential equation,
â„˜â€² (z)2 âˆ’4â„˜(z)3 + 60G2â„˜(z) + 140G3 = 0.
It is traditional to deï¬ne 60G2 â‰¡g2 and 140G3 â‰¡g3. Then in terms of these new
quantities the diï¬€erential equation is
â„˜â€² (z)2 = 4â„˜(z)3 âˆ’g2â„˜(z) âˆ’g3.
Suppose e1, e2 and e3 are zeros of the polynomial 4w3 âˆ’g2w âˆ’g3 = 0. Then the
above equation can be written in the form
â„˜â€² (z)2 = 4 (â„˜(z) âˆ’e1) (â„˜(z) âˆ’e2) (â„˜(z) âˆ’e3) .
(30.8)
30.1.4
A Modular Function
The next task is to ï¬nd the ei in 30.8. First recall that â„˜is an even function. That
is â„˜(âˆ’z) = â„˜(z). This follows from 30.6 which is listed here for convenience.
â„˜(z) â‰¡1
z2 +
X
wÌ¸=0
Ãƒ
1
(z âˆ’w)2 âˆ’1
w2
!
(30.9)
Thus
â„˜(âˆ’z)
=
1
z2 +
X
wÌ¸=0
Ãƒ
1
(âˆ’z âˆ’w)2 âˆ’1
w2
!
=
1
z2 +
X
wÌ¸=0
Ãƒ
1
(âˆ’z + w)2 âˆ’1
w2
!
= â„˜(z) .
Therefore, â„˜(w1 âˆ’z) = â„˜(z âˆ’w1) = â„˜(z) and so âˆ’â„˜â€² (w1 âˆ’z) = â„˜â€² (z) . Letting
z = w1/2, it follows â„˜â€² (w1/2) = 0. Similarly, â„˜â€² (w2/2) = 0 and â„˜â€² ((w1 + w2) /2) =
0. Therefore, from 30.8
0 = 4 (â„˜(w1/2) âˆ’e1) (â„˜(w1/2) âˆ’e2) (â„˜(w1/2) âˆ’e3) .
It follows one of the ei must equal â„˜(w1/2) . Similarly, one of the ei must equal
â„˜(w2/2) and one must equal â„˜((w1 + w2) /2).
Lemma 30.15
The numbers, â„˜(w1/2) , â„˜(w2/2) , and â„˜((w1 + w2) /2) are dis-
tinct.

30.1.
PERIODIC FUNCTIONS
833
Proof: Choose Pa, a period parallelogram which contains the pole 0, and the
points w1/2, w2/2, and (w1 + w2) /2 but no other pole of â„˜(z) . Also âˆ‚P âˆ—
a does not
contain any zeros of the elliptic function, z â†’â„˜(z) âˆ’â„˜(w1/2). This can be done
by shifting P0 slightly because the poles are only at the points aw1 + bw2 for a, b
integers and the zeros of â„˜(z) âˆ’â„˜(w1/2) are discreet.
0
s
w1
w2s
s
s
w1 + w2


Â£
Â£
Â£
Â£
Â£
Â£
Â£Â£


Â£
Â£
Â£
Â£
Â£
Â£
Â£Â£
a s

Â£
Â£
Â£
Â£
Â£
Â£
Â£
Â£


Â£
Â£
Â£
Â£
Â£
Â£
Â£
Â£
If â„˜(w2/2) = â„˜(w1/2) , then â„˜(z)âˆ’â„˜(w1/2) has two zeros, w2/2 and w1/2 and
since the pole at 0 is of order 2, this is the order of â„˜(z) âˆ’â„˜(w1/2) on Pa hence by
Theorem 30.8 on Page 822 these are the only zeros of this function on Pa. It follows
by Corollary 30.10 on Page 824 which says the sum of the zeros minus the sum of
the poles is in M, w1
2 + w2
2 âˆˆM. Thus there exist integers, a, b such that
w1 + w2
2
= aw1 + bw2
which implies (2a âˆ’1) w1 + (2b âˆ’1) w2 = 0 contradicting w2/w1 not being real.
Similar reasoning applies to the other pairs of points in {w1/2, w2/2, (w1 + w2) /2} .
For example, consider (w1 + w2) /2 and choose Pa such that its boundary contains
no zeros of the elliptic function, z â†’â„˜(z) âˆ’â„˜((w1 + w2) /2) and Pa contains no
poles of â„˜on its interior other than 0. Then if â„˜(w2/2) = â„˜((w1 + w2) /2) , it
follows from Theorem 30.8 on Page 822 w2/2 and (w1 + w2) /2 are the only two
zeros of â„˜(z) âˆ’â„˜((w1 + w2) /2) on Pa and by Corollary 30.10 on Page 824
w1 + w1 + w2
2
= aw1 + bw2 âˆˆM
for some integers a, b which leads to the same contradiction as before about w1/w2
not being real. The other cases are similar. This proves the lemma.
Lemma 30.15 proves the ei are distinct. Number the ei such that
e1 = â„˜(w1/2) , e2 = â„˜(w2/2)
and
e3 = â„˜((w1 + w2) /2) .
To summarize, it has been shown that for complex numbers, w1 and w2 with
w2/w1 not real, an elliptic function, â„˜has been deï¬ned. Denote this function as

834
ELLIPTIC FUNCTIONS
â„˜(z) = â„˜(z, w1, w2) . This in turn determined numbers, ei as described above. Thus
these numbers depend on w1 and w2 and as described above,
e1 (w1, w2)
=
â„˜
Â³w1
2 , w1, w2
Â´
, e2 (w1, w2) = â„˜
Â³w2
2 , w1, w2
Â´
e3 (w1, w2)
=
â„˜
Âµw1 + w2
2
, w1, w2
Â¶
.
Therefore, using the formula for â„˜, 30.9,
â„˜(z) â‰¡1
z2 +
X
wÌ¸=0
Ãƒ
1
(z âˆ’w)2 âˆ’1
w2
!
you see that if the two periods w1 and w2 are replaced with tw1 and tw2 respectively,
then
ei (tw1, tw2) = tâˆ’2ei (w1, w2) .
Let Ï„ denote the complex number which equals the ratio, w2/w1 which was assumed
in all this to not be real. Then
ei (w1, w2) = wâˆ’2
1 ei (1, Ï„)
Now deï¬ne the function, Î» (Ï„)
Î» (Ï„) â‰¡e3 (1, Ï„) âˆ’e2 (1, Ï„)
e1 (1, Ï„) âˆ’e2 (1, Ï„)
Âµ
= e3 (w1, w2) âˆ’e2 (w1, w2)
e1 (w1, w2) âˆ’e2 (w1, w2)
Â¶
.
(30.10)
This function is meromorphic for Im Ï„ > 0 or for Im Ï„ < 0. However, since the
denominator is never equal to zero the function must actually be analytic on both
the upper half plane and the lower half plane. It never is equal to 0 because e3 Ì¸= e2
and it never equals 1 because e3 Ì¸= e1. This is stated as an observation.
Observation 30.16 The function, Î» (Ï„) is analytic for Ï„ in the upper half plane
and never assumes the values 0 and 1.
This is a very interesting function. Consider what happens when
Âµ
wâ€²
1
wâ€²
2
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
w1
w2
Â¶
and the matrix is unimodular. By Theorem 30.13 on Page 826 {wâ€²
1, wâ€²
2} is just an-
other basis for the same module of periods. Therefore, â„˜(z, w1, w2) = â„˜(z, wâ€²
1, wâ€²
2)
because both are deï¬ned as sums over the same values of w, just in diï¬€erent order
which does not matter because of the absolute convergence of the sums on compact
subsets of C. Since â„˜is unchanged, it follows â„˜â€² (z) is also unchanged and so the
numbers, ei are also the same. However, they might be permuted in which case
the function Î» (Ï„) deï¬ned above would change. What would it take for Î» (Ï„) to
not change? In other words, for which unimodular transformations will Î» be left

30.1.
PERIODIC FUNCTIONS
835
unchanged? This happens if and only if no permuting takes place for the ei. This
occurs if â„˜
Â¡ w1
2
Â¢
= â„˜
Â³
wâ€²
1
2
Â´
and â„˜
Â¡ w2
2
Â¢
= â„˜
Â³
wâ€²
2
2
Â´
. If
wâ€²
1
2 âˆ’w1
2 âˆˆM, wâ€²
2
2 âˆ’w2
2 âˆˆM
then â„˜
Â¡ w1
2
Â¢
= â„˜
Â³
wâ€²
1
2
Â´
and so e1 will be unchanged and similarly for e2 and e3.
This occurs exactly when
1
2 ((a âˆ’1) w1 + bw2) âˆˆM, 1
2 (cw1 + (d âˆ’1) w2) âˆˆM.
This happens if a and d are odd and if b and c are even. Of course the stylish way
to say this is
a â‰¡1 mod 2, d â‰¡1 mod 2, b â‰¡0 mod 2, c â‰¡0 mod 2.
(30.11)
This has shown that for unimodular transformations satisfying 30.11 Î» is unchanged.
Letting Ï„ be deï¬ned as above,
Ï„ â€² = wâ€²
2
wâ€²
1
â‰¡cw1 + dw2
aw1 + bw2
= c + dÏ„
a + bÏ„ .
Thus for unimodular transformations,
Âµ
a
b
c
d
Â¶
satisfying 30.11, or more suc-
cinctly,
Âµ
a
b
c
d
Â¶
âˆ¼
Âµ
1
0
0
1
Â¶
mod 2
(30.12)
it follows that
Î»
Âµc + dÏ„
a + bÏ„
Â¶
= Î» (Ï„) .
(30.13)
Furthermore, this is the only way this can happen.
Lemma 30.17 Î» (Ï„) = Î» (Ï„ â€²) if and only if
Ï„ â€² = aÏ„ + b
cÏ„ + d
where 30.12 holds.
Proof: It only remains to verify that if â„˜(wâ€²
1/2) = â„˜(w1/2) then it is necessary
that
wâ€²
1
2 âˆ’w1
2 âˆˆM
with a similar requirement for w2 and wâ€²
2. If wâ€²
1
2 âˆ’w1
2 /âˆˆM, then there exist integers,
m, n such that
âˆ’wâ€²
1
2
+ mw1 + nw2

836
ELLIPTIC FUNCTIONS
is in the interior of P0, the period parallelogram whose vertices are 0, w1, w1 + w2,
and w2. Therefore, it is possible to choose small a such that Pa contains the pole,
0, w1
2 , and âˆ’wâ€²
1
2
+ mw1 + nw2 but no other poles of â„˜and in addition, âˆ‚P âˆ—
a contains
no zeros of z â†’â„˜(z) âˆ’â„˜
Â¡ w1
2
Â¢
. Then the order of this elliptic function is 2. By
assumption, and the fact that â„˜is even,
â„˜
Âµâˆ’wâ€²
1
2
+ mw1 + nw2
Â¶
= â„˜
Âµâˆ’wâ€²
1
2
Â¶
= â„˜
Âµwâ€²
1
2
Â¶
= â„˜
Â³w1
2
Â´
.
It follows both âˆ’wâ€²
1
2
+ mw1 + nw2 and w1
2
are zeros of â„˜(z) âˆ’â„˜
Â¡ w1
2
Â¢
and so by
Theorem 30.8 on Page 822 these are the only two zeros of this function in Pa.
Therefore, from Corollary 30.10 on Page 824
w1
2 âˆ’wâ€²
1
2 + mw1 + nw2 âˆˆM
which shows w1
2 âˆ’wâ€²
1
2 âˆˆM. This completes the proof of the lemma.
Note the condition in the lemma is equivalent to the condition 30.13 because
you can relabel the coeï¬ƒcients. The message of either version is that the coeï¬ƒcient
of Ï„ in the numerator and denominator is odd while the constant in the numerator
and denominator is even.
Next,
Âµ
1
0
2
1
Â¶
âˆ¼
Âµ
1
0
0
1
Â¶
mod 2 and therefore,
Î»
Âµ2 + Ï„
1
Â¶
= Î» (Ï„ + 2) = Î» (Ï„) .
(30.14)
Thus Î» is periodic of period 2.
Thus Î» leaves invariant a certain subgroup of the unimodular group. According
to the next deï¬nition, Î» is an example of something called a modular function.
Deï¬nition 30.18 When an analytic or meromorphic function is invariant under
a group of linear transformations, it is called an automorphic function. A function
which is automorphic with respect to a subgroup of the modular group is called a
modular function or an elliptic modular function.
Now consider what happens for some other unimodular matrices which are not
congruent to the identity mod 2. This will yield other functional equations for Î»
in addition to the fact that Î» is periodic of period 2. As before, these functional
equations come about because â„˜is unchanged when you change the basis for M,
the module of periods. In particular, consider the unimodular matrices
Âµ 1
0
1
1
Â¶
,
Âµ 0
1
1
0
Â¶
.
(30.15)
Consider the ï¬rst of these. Thus
Âµ
wâ€²
1
wâ€²
2
Â¶
=
Âµ
w1
w1 + w2
Â¶

30.1.
PERIODIC FUNCTIONS
837
Hence Ï„ â€² = wâ€²
2/wâ€²
1 = (w1 + w2) /w1 = 1 + Ï„. Then from the deï¬nition of Î»,
Î» (Ï„ â€²)
=
Î» (1 + Ï„)
=
â„˜
Â³
wâ€²
1+wâ€²
2
2
Â´
âˆ’â„˜
Â³
wâ€²
2
2
Â´
â„˜
Â³
wâ€²
1
2
Â´
âˆ’â„˜
Â³
wâ€²
2
2
Â´
=
â„˜
Â¡ w1+w2+w1
2
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
â„˜
Â¡ w1
2
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
=
â„˜
Â¡ w2
2 + w1
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
â„˜
Â¡ w1
2
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
=
â„˜
Â¡ w2
2
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
â„˜
Â¡ w1
2
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
=
âˆ’â„˜
Â¡ w1+w2
2
Â¢
âˆ’â„˜
Â¡ w2
2
Â¢
â„˜
Â¡ w1
2
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
=
âˆ’
â„˜
Â¡ w1+w2
2
Â¢
âˆ’â„˜
Â¡ w2
2
Â¢
â„˜
Â¡ w1
2
Â¢
âˆ’â„˜
Â¡ w2
2
Â¢
+ â„˜
Â¡ w2
2
Â¢
âˆ’â„˜
Â¡ w1+w2
2
Â¢
=
âˆ’
Âµ
â„˜(
w1+w2
2
)âˆ’â„˜(
w2
2 )
â„˜(
w1
2 )âˆ’â„˜(
w2
2 )
Â¶
1 +
Âµ
â„˜(
w2
2 )âˆ’â„˜(
w1+w2
2
)
â„˜(
w1
2 )âˆ’â„˜(
w2
2 )
Â¶
=
Âµ
â„˜(
w1+w2
2
)âˆ’â„˜(
w2
2 )
â„˜(
w1
2 )âˆ’â„˜(
w2
2 )
Â¶
Âµ
â„˜(
w1+w2
2
)âˆ’â„˜(
w2
2 )
â„˜(
w1
2 )âˆ’â„˜(
w2
2 )
Â¶
âˆ’1
=
Î» (Ï„)
Î» (Ï„) âˆ’1.
(30.16)
Summarizing the important feature of the above,
Î» (1 + Ï„) =
Î» (Ï„)
Î» (Ï„) âˆ’1.
(30.17)

838
ELLIPTIC FUNCTIONS
Next consider the other unimodular matrix in 30.15. In this case wâ€²
1 = w2 and
wâ€²
2 = w1. Therefore, Ï„ â€² = wâ€²
2/wâ€²
1 = w1/w2 = 1/Ï„. Then
Î» (Ï„ â€²)
=
Î» (1/Ï„)
=
â„˜
Â³
wâ€²
1+wâ€²
2
2
Â´
âˆ’â„˜
Â³
wâ€²
2
2
Â´
â„˜
Â³
wâ€²
1
2
Â´
âˆ’â„˜
Â³
wâ€²
2
2
Â´
=
â„˜
Â¡ w1+w2
2
Â¢
âˆ’â„˜
Â¡ w1
2
Â¢
â„˜
Â¡ w2
2
Â¢
âˆ’â„˜
Â¡ w1
2
Â¢
=
e3 âˆ’e1
e2 âˆ’e1
= âˆ’e3 âˆ’e2 + e2 âˆ’e1
e1 âˆ’e2
=
âˆ’(Î» (Ï„) âˆ’1) = âˆ’Î» (Ï„) + 1.
(30.18)
You could try other unimodular matrices and attempt to ï¬nd other functional
equations if you like but this much will suï¬ƒce here.
30.1.5
A Formula For Î»
Recall the formula of Mittag-Leï¬„er for cot (Ï€Î±) given in 29.15. For convenience,
here it is.
1
Î± +
âˆž
X
n=1
2Î±
Î±2 âˆ’n2 = Ï€ cot Ï€Î±.
As explained in the derivation of this formula it can also be written as
âˆž
X
n=âˆ’âˆž
Î±
Î±2 âˆ’n2 = Ï€ cot Ï€Î±.
Diï¬€erentiating both sides yields
Ï€2 csc2 (Ï€Î±)
=
âˆž
X
n=âˆ’âˆž
Î±2 + n2
(Î±2 âˆ’n2)2
=
âˆž
X
n=âˆ’âˆž
(Î± + n)2 âˆ’2Î±n
(Î± + n)2 (Î± âˆ’n)2
=
âˆž
X
n=âˆ’âˆž
(Î± + n)2
(Î± + n)2 (Î± âˆ’n)2 âˆ’
=0
z
}|
{
âˆž
X
n=âˆ’âˆž
2Î±n
(Î±2 âˆ’n2)2
=
âˆž
X
n=âˆ’âˆž
1
(Î± âˆ’n)2 .
(30.19)
Now this formula can be used to obtain a formula for Î» (Ï„) . As pointed out
above, Î» depends only on the ratio w2/w1 and so it suï¬ƒces to take w1 = 1 and

30.1.
PERIODIC FUNCTIONS
839
w2 = Ï„. Thus
Î» (Ï„) = â„˜
Â¡ 1+Ï„
2
Â¢
âˆ’â„˜
Â¡ Ï„
2
Â¢
â„˜
Â¡ 1
2
Â¢
âˆ’â„˜
Â¡ Ï„
2
Â¢ .
(30.20)
From the original formula for â„˜,
â„˜
Âµ1 + Ï„
2
Â¶
âˆ’â„˜
Â³Ï„
2
Â´
=
1
Â¡ 1+Ï„
2
Â¢2 âˆ’
1
Â¡ Ï„
2
Â¢2 +
X
(k,m)Ì¸=(0,0)
1
Â¡
k âˆ’1
2 +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2 âˆ’
1
Â¡
k +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2
=
X
(k,m)âˆˆZ2
1
Â¡
k âˆ’1
2 +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2 âˆ’
1
Â¡
k +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2
=
X
(k,m)âˆˆZ2
1
Â¡
k âˆ’1
2 +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2 âˆ’
1
Â¡
k +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2
=
X
(k,m)âˆˆZ2
1
Â¡
k âˆ’1
2 +
Â¡
âˆ’m âˆ’1
2
Â¢
Ï„
Â¢2 âˆ’
1
Â¡
k +
Â¡
âˆ’m âˆ’1
2
Â¢
Ï„
Â¢2
=
X
(k,m)âˆˆZ2
1
Â¡ 1
2 +
Â¡
m + 1
2
Â¢
Ï„ âˆ’k
Â¢2 âˆ’
1
Â¡Â¡
m + 1
2
Â¢
Ï„ âˆ’k
Â¢2 .
(30.21)
Similarly,
â„˜
Âµ1
2
Â¶
âˆ’â„˜
Â³Ï„
2
Â´
=
1
Â¡ 1
2
Â¢2 âˆ’
1
Â¡ Ï„
2
Â¢2 +
X
(k,m)Ì¸=(0,0)
1
Â¡
k âˆ’1
2 + mÏ„
Â¢2 âˆ’
1
Â¡
k +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2
=
X
(k,m)âˆˆZ2
1
Â¡
k âˆ’1
2 + mÏ„
Â¢2 âˆ’
1
Â¡
k +
Â¡
m âˆ’1
2
Â¢
Ï„
Â¢2
=
X
(k,m)âˆˆZ2
1
Â¡
k âˆ’1
2 âˆ’mÏ„
Â¢2 âˆ’
1
Â¡
k +
Â¡
âˆ’m âˆ’1
2
Â¢
Ï„
Â¢2
=
X
(k,m)âˆˆZ2
1
Â¡ 1
2 + mÏ„ âˆ’k
Â¢2 âˆ’
1
Â¡Â¡
m + 1
2
Â¢
Ï„ âˆ’k
Â¢2 .
(30.22)
Now use 30.19 to sum these over k. This yields,
â„˜
Âµ1 + Ï„
2
Â¶
âˆ’â„˜
Â³Ï„
2
Â´
=
X
m
Ï€2
sin2 Â¡
Ï€
Â¡ 1
2 +
Â¡
m + 1
2
Â¢
Ï„
Â¢Â¢ âˆ’
Ï€2
sin2 Â¡
Ï€
Â¡
m + 1
2
Â¢
Ï„
Â¢
=
X
m
Ï€2
cos2 Â¡
Ï€
Â¡
m + 1
2
Â¢
Ï„
Â¢ âˆ’
Ï€2
sin2 Â¡
Ï€
Â¡
m + 1
2
Â¢
Ï„
Â¢

840
ELLIPTIC FUNCTIONS
and
â„˜
Âµ1
2
Â¶
âˆ’â„˜
Â³Ï„
2
Â´
=
X
m
Ï€2
sin2 Â¡
Ï€
Â¡ 1
2 + mÏ„
Â¢Â¢ âˆ’
Ï€2
sin2 Â¡
Ï€
Â¡
m + 1
2
Â¢
Ï„
Â¢
=
X
m
Ï€2
cos2 (Ï€mÏ„) âˆ’
Ï€2
sin2 Â¡
Ï€
Â¡
m + 1
2
Â¢
Ï„
Â¢.
The following interesting formula for Î» results.
Î» (Ï„) =
P
m
1
cos2(Ï€(m+ 1
2)Ï„) âˆ’
1
sin2(Ï€(m+ 1
2)Ï„)
P
m
1
cos2(Ï€mÏ„) âˆ’
1
sin2(Ï€(m+ 1
2)Ï„)
.
(30.23)
From this it is obvious Î» (âˆ’Ï„) = Î» (Ï„) . Therefore, from 30.18,
âˆ’Î» (Ï„) + 1 = Î»
Âµ1
Ï„
Â¶
= Î»
Âµâˆ’1
Ï„
Â¶
(30.24)
(It is good to recall that Î» has been deï¬ned for Ï„ /âˆˆR.)
30.1.6
Mapping Properties Of Î»
The two functional equations, 30.24 and 30.17 along with some other properties pre-
sented above are of fundamental importance. For convenience, they are summarized
here in the following lemma.
Lemma 30.19 The following functional equations hold for Î».
Î» (1 + Ï„) =
Î» (Ï„)
Î» (Ï„) âˆ’1, 1 = Î» (Ï„) + Î»
Âµâˆ’1
Ï„
Â¶
(30.25)
Î» (Ï„ + 2) = Î» (Ï„) ,
(30.26)
Î» (z) = Î» (w) if and only if there exists a unimodular matrix,
Âµ
a
b
c
d
Â¶
âˆ¼
Âµ
1
0
0
1
Â¶
mod 2
such that
w = az + b
cz + d
(30.27)
Consider the following picture.
â„¦
C
l2
l1
r
1
r
1
2

30.1.
PERIODIC FUNCTIONS
841
In this picture, l1 is the y axis and l2 is the line, x = 1 while C is the top half of
the circle centered at
Â¡ 1
2, 0
Â¢
which has radius 1/2. Note the above formula implies
Î» has real values on l1 which are between 0 and 1. This is because 30.23 implies
Î» (ib)
=
P
m
1
cos2(Ï€(m+ 1
2)ib) âˆ’
1
sin2(Ï€(m+ 1
2)ib)
P
m
1
cos2(Ï€mib) âˆ’
1
sin2(Ï€(m+ 1
2)ib)
=
P
m
1
cosh2(Ï€(m+ 1
2)b) +
1
sinh2(Ï€(m+ 1
2)b)
P
m
1
cosh2(Ï€mb) +
1
sinh2(Ï€(m+ 1
2)b)
âˆˆ(0, 1) .
(30.28)
This follows from the observation that
cos (ix) = cosh (x) , sin (ix) = i sinh (x) .
Thus it is clear from 30.28 that limbâ†’0+ Î» (ib) = 1.
Next I need to consider the behavior of Î» (Ï„) as Im (Ï„) â†’âˆž. From 30.23 listed
here for convenience,
Î» (Ï„) =
P
m
1
cos2(Ï€(m+ 1
2)Ï„) âˆ’
1
sin2(Ï€(m+ 1
2)Ï„)
P
m
1
cos2(Ï€mÏ„) âˆ’
1
sin2(Ï€(m+ 1
2)Ï„)
,
(30.29)
it follows
Î» (Ï„)
=
1
cos2(Ï€(âˆ’1
2)Ï„) âˆ’
1
sin2(Ï€(âˆ’1
2)Ï„) +
1
cos2(Ï€ 1
2 Ï„) âˆ’
1
sin2(Ï€ 1
2 Ï„) + A (Ï„)
1 + B (Ï„)
=
2
cos2(Ï€( 1
2)Ï„) âˆ’
2
sin2(Ï€( 1
2)Ï„) + A (Ï„)
1 + B (Ï„)
(30.30)
Where A (Ï„) , B (Ï„) â†’0 as Im (Ï„) â†’âˆž. I took out the m = 0 term involving
1/ cos2 (Ï€mÏ„) in the denominator and the m = âˆ’1 and m = 0 terms in the nu-
merator of 30.29. In fact, eâˆ’iÏ€(a+ib)A (a + ib) , eâˆ’iÏ€(a+ib)B (a + ib) converge to zero
uniformly in a as b â†’âˆž.
Lemma 30.20 For A, B deï¬ned in 30.30, eâˆ’iÏ€(a+ib)C (a + ib) â†’0 uniformly in a
for C = A, B.
Proof: From 30.23,
eâˆ’iÏ€Ï„A (Ï„) =
X
mÌ¸=0
mÌ¸=âˆ’1
eâˆ’iÏ€Ï„
cos2 Â¡
Ï€
Â¡
m + 1
2
Â¢
Ï„
Â¢ âˆ’
eâˆ’iÏ€Ï„
sin2 Â¡
Ï€
Â¡
m + 1
2
Â¢
Ï„
Â¢
Now let Ï„ = a + ib. Then letting Î±m = Ï€
Â¡
m + 1
2
Â¢
,
cos (Î±ma + iÎ±mb)
=
cos (Î±ma) cosh (Î±mb) âˆ’i sinh (Î±mb) sin (Î±ma)
sin (Î±ma + iÎ±mb)
=
sin (Î±ma) cosh (Î±mb) + i cos (Î±ma) sinh (Î±mb)

842
ELLIPTIC FUNCTIONS
Therefore,
Â¯Â¯cos2 (Î±ma + iÎ±mb)
Â¯Â¯
=
cos2 (Î±ma) cosh2 (Î±mb) + sinh2 (Î±mb) sin2 (Î±ma)
â‰¥
sinh2 (Î±mb) .
Similarly,
Â¯Â¯sin2 (Î±ma + iÎ±mb)
Â¯Â¯
=
sin2 (Î±ma) cosh2 (Î±mb) + cos2 (Î±ma) sinh2 (Î±mb)
â‰¥
sinh2 (Î±mb) .
It follows that for Ï„ = a + ib and b large
Â¯Â¯eâˆ’iÏ€Ï„A (Ï„)
Â¯Â¯
â‰¤
X
mÌ¸=0
mÌ¸=âˆ’1
2eÏ€b
sinh2 Â¡
Ï€
Â¡
m + 1
2
Â¢
b
Â¢
â‰¤
âˆž
X
m=1
2eÏ€b
sinh2 Â¡
Ï€
Â¡
m + 1
2
Â¢
b
Â¢ +
âˆ’2
X
m=âˆ’âˆž
2eÏ€b
sinh2 Â¡
Ï€
Â¡
m + 1
2
Â¢
b
Â¢
=
2
âˆž
X
m=1
2eÏ€b
sinh2 Â¡
Ï€
Â¡
m + 1
2
Â¢
b
Â¢ = 4
âˆž
X
m=1
eÏ€b
sinh2 Â¡
Ï€
Â¡
m + 1
2
Â¢
b
Â¢
Now a short computation shows
eÏ€b
sinh2(Ï€(m+1+ 1
2)b)
eÏ€b
sinh2(Ï€(m+ 1
2)b)
= sinh2 Â¡
Ï€
Â¡
m + 1
2
Â¢
b
Â¢
sinh2 Â¡
Ï€
Â¡
m + 3
2
Â¢
b
Â¢ â‰¤
1
e3Ï€b .
Therefore, for Ï„ = a + ib,
Â¯Â¯eâˆ’iÏ€Ï„A (Ï„)
Â¯Â¯
â‰¤
4
eÏ€b
sinh
Â¡ 3Ï€b
2
Â¢
âˆž
X
m=1
Âµ 1
e3Ï€b
Â¶m
â‰¤
4
eÏ€b
sinh
Â¡ 3Ï€b
2
Â¢
1/e3Ï€b
1 âˆ’(1/e3Ï€b)
which converges to zero as b â†’âˆž. Similar reasoning will establish the claim about
B (Ï„) . This proves the lemma.
Lemma 30.21 limbâ†’âˆžÎ» (a + ib) eâˆ’iÏ€(a+ib) = 16 uniformly in a âˆˆR.
Proof: From 30.30 and Lemma 30.20, this lemma will be proved if it is shown
lim
bâ†’âˆž
Ãƒ
2
cos2 Â¡
Ï€
Â¡ 1
2
Â¢
(a + ib)
Â¢ âˆ’
2
sin2 Â¡
Ï€
Â¡ 1
2
Â¢
(a + ib)
Â¢
!
eâˆ’iÏ€(a+ib) = 16

30.1.
PERIODIC FUNCTIONS
843
uniformly in a âˆˆR. Let Ï„ = a + ib to simplify the notation.
Then the above
expression equals
Ãƒ
8
Â¡
ei Ï€
2 Ï„ + eâˆ’i Ï€
2 Ï„Â¢2 +
8
Â¡
ei Ï€
2 Ï„ âˆ’eâˆ’i Ï€
2 Ï„Â¢2
!
eâˆ’iÏ€Ï„
=
Ãƒ
8eiÏ€Ï„
(eiÏ€Ï„ + 1)2 +
8eiÏ€Ï„
(eiÏ€Ï„ âˆ’1)2
!
eâˆ’iÏ€Ï„
=
8
(eiÏ€Ï„ + 1)2 +
8
(eiÏ€Ï„ âˆ’1)2
=
16 1 + e2Ï€iÏ„
(1 âˆ’e2Ï€iÏ„)2 .
Now
Â¯Â¯Â¯Â¯Â¯
1 + e2Ï€iÏ„
(1 âˆ’e2Ï€iÏ„)2 âˆ’1
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
1 + e2Ï€iÏ„
(1 âˆ’e2Ï€iÏ„)2 âˆ’
Â¡
1 âˆ’e2Ï€iÏ„Â¢2
(1 âˆ’e2Ï€iÏ„)2
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯3e2Ï€iÏ„ âˆ’e4Ï€iÏ„Â¯Â¯
(1 âˆ’eâˆ’2Ï€b)2
â‰¤3eâˆ’2Ï€b + eâˆ’4Ï€b
(1 âˆ’eâˆ’2Ï€b)2
and this estimate proves the lemma.
Corollary 30.22 limbâ†’âˆžÎ» (a + ib) = 0 uniformly in a âˆˆR. Also Î» (ib) for b > 0
is real and is between 0 and 1, Î» is real on the line, l2 and on the curve, C and
limbâ†’0+ Î» (1 + ib) = âˆ’âˆž.
Proof: From Lemma 30.21,
Â¯Â¯Â¯Î» (a + ib) eâˆ’iÏ€(a+ib) âˆ’16
Â¯Â¯Â¯ < 1
for all a provided b is large enough. Therefore, for such b,
|Î» (a + ib)| â‰¤17eâˆ’Ï€b.
30.28 proves the assertion about Î» (âˆ’bi) real.
By the ï¬rst part, limbâ†’âˆž|Î» (ib)| = 0. Now from 30.24
lim
bâ†’0+ Î» (ib) = lim
bâ†’0+
Âµ
1 âˆ’Î»
Âµâˆ’1
ib
Â¶Â¶
= lim
bâ†’0+
Âµ
1 âˆ’Î»
Âµ i
b
Â¶Â¶
= 1.
(30.31)
by Corollary 30.22.
Next consider the behavior of Î» on line l2 in the above picture. From 30.17 and
30.28,
Î» (1 + ib) =
Î» (ib)
Î» (ib) âˆ’1 < 0

844
ELLIPTIC FUNCTIONS
and so as b â†’0+ in the above, Î» (1 + ib) â†’âˆ’âˆž.
It is left as an exercise to show that the map Ï„ â†’1 âˆ’1
Ï„ maps l2 onto the curve,
C. Therefore, by 30.25, for Ï„ âˆˆl2,
Î»
Âµ
1 âˆ’1
Ï„
Â¶
=
Î»
Â¡ âˆ’1
Ï„
Â¢
Î»
Â¡ âˆ’1
Ï„
Â¢
âˆ’1
(30.32)
=
1 âˆ’Î» (Ï„)
(1 âˆ’Î» (Ï„)) âˆ’1 = Î» (Ï„) âˆ’1
Î» (Ï„)
âˆˆR
(30.33)
It follows Î» is real on the boundary of â„¦in the above picture. This proves the
corollary.
Now, following Alfors [2], cut oï¬€â„¦by considering the horizontal line segment,
z = a + ib0 where b0 is very large and positive and a âˆˆ[0, 1] . Also cut â„¦oï¬€
by the images of this horizontal line, under the transformations z =
1
Ï„ and z =
1âˆ’1
Ï„ . These are arcs of circles because the two transformations are fractional linear
transformations. It is left as an exercise for you to verify these arcs are situated as
shown in the following picture. The important thing to notice is that for b0 large the
points of these circles are close to the origin and (1, 0) respectively. The following
picture is a summary of what has been obtained so far on the mapping by Î».
:
z
-
?
6

real small positive
near 1 and real
C2
C1
large, real, negative
small, real, negative
z = a + ib0
â„¦
C
l2
l1
r
1
r
1
2
In the picture, the descriptions are of Î» acting on points of the indicated bound-
ary of â„¦. Consider the oriented contour which results from Î» (z) as z moves ï¬rst up
l2 as indicated, then along the line z = a + ib and then down l1 and then along C1
to C and along C till C2 and then along C2 to l2. As indicated in the picture, this
involves going from a large negative real number to a small negative real number
and then over a smooth curve which stays small to a real positive number and from
there to a real number near 1. Î» (z) stays fairly near 1 on C1 provided b0 is large
so that the circle, C1 has very small radius. Then along C, Î» (z) is real until it hits
C2. What about the behavior of Î» on C2? For z âˆˆC2, it follows from the deï¬nition
of C2 that z = 1 âˆ’1
Ï„ where Ï„ is on the line, a + ib0. Therefore, by Lemma 30.21,

30.1.
PERIODIC FUNCTIONS
845
30.17, and 30.24
Î» (z)
=
Î»
Âµ
1 âˆ’1
Ï„
Â¶
=
Î»
Â¡ âˆ’1
Ï„
Â¢
Î»
Â¡ âˆ’1
Ï„
Â¢
âˆ’1 =
Î»
Â¡ 1
Ï„
Â¢
Î»
Â¡ 1
Ï„
Â¢
âˆ’1
=
1 âˆ’Î» (Ï„)
(1 âˆ’Î» (Ï„)) âˆ’1 = Î» (Ï„) âˆ’1
Î» (Ï„)
= 1 âˆ’
1
Î» (Ï„)
which is approximately equal to
1 âˆ’
1
16eiÏ€(a+ib0) = 1 âˆ’eÏ€b0eâˆ’iaÏ€
16
.
These points are essentially on a large half circle in the upper half plane which has
radius approximately eÏ€b0
16 .
Now let w âˆˆC with Im (w) Ì¸= 0. Then for b0 large enough, the motion over the
boundary of the truncated region indicated in the above picture results in Î» tracing
out a large simple closed curve oriented in the counter clockwise direction which
includes w on its interior if Im (w) > 0 but which excludes w if Im (w) < 0.
Theorem 30.23 Let â„¦be the domain described above. Then Î» maps â„¦one to one
and onto the upper half plane of C, {z âˆˆC such that Im (z) > 0} . Also, the line
Î» (l1) = (0, 1) , Î» (l2) = (âˆ’âˆž, 0) , and Î» (C) = (1, âˆž).
Proof: Let Im (w) > 0 and denote by Î³ the oriented contour described above
and illustrated in the above picture. Then the winding number of Î» â—¦Î³ about w
equals 1. Thus
1
2Ï€i
Z
Î»â—¦Î³
1
z âˆ’wdz = 1.
But, splitting the contour integrals into l2,the top line, l1, C1, C, and C2 and chang-
ing variables on each of these, yields
1 =
1
2Ï€i
Z
Î³
Î»â€² (z)
Î» (z) âˆ’wdz
and by the theorem on counting zeros, Theorem 25.20 on Page 694, the function,
z â†’Î» (z) âˆ’w has exactly one zero inside the truncated â„¦. However, this shows
this function has exactly one zero inside â„¦because b0 was arbitrary as long as it
is suï¬ƒciently large. Since w was an arbitrary element of the upper half plane, this
veriï¬es the ï¬rst assertion of the theorem. The remaining claims follow from the
above description of Î», in particular the estimate for Î» on C2. This proves the
theorem.
Note also that the argument in the above proof shows that if Im (w) < 0, then
w is not in Î» (â„¦) . However, if you consider the reï¬‚ection of â„¦about the y axis,
then it will follow that Î» maps this set one to one onto the lower half plane. The
argument will make signiï¬cant use of Theorem 25.22 on Page 696 which is stated
here for convenience.

846
ELLIPTIC FUNCTIONS
Theorem 30.24 Let f : B (a, R) â†’C be analytic and let
f (z) âˆ’Î± = (z âˆ’a)m g (z) , âˆž> m â‰¥1
where g (z) Ì¸= 0 in B (a, R) . (f (z) âˆ’Î± has a zero of order m at z = a.) Then there
exist Îµ, Î´ > 0 with the property that for each z satisfying 0 < |z âˆ’Î±| < Î´, there exist
points,
{a1, Â· Â· Â·, am} âŠ†B (a, Îµ) ,
such that
f âˆ’1 (z) âˆ©B (a, Îµ) = {a1, Â· Â· Â·, am}
and each ak is a zero of order 1 for the function f (Â·) âˆ’z.
Corollary 30.25 Let â„¦be the region above. Consider the set of points, Q = â„¦âˆª
â„¦â€² \ {0, 1} described by the following picture.
â„¦â€²
r
âˆ’1
â„¦
C
l2
l1
r
1
r
1
2
Then Î» (Q) = C\ {0, 1} . Also Î»â€² (z) Ì¸= 0 for every z in âˆªâˆž
k=âˆ’âˆž(Q + 2k) â‰¡H.
Proof: By Theorem 30.23, this will be proved if it can be shown that Î» (â„¦â€²) =
{z âˆˆC : Im (z) < 0} . Consider Î»1 deï¬ned on â„¦â€² by
Î»1 (x + iy) â‰¡Î» (âˆ’x + iy).
Claim: Î»1 is analytic.
Proof of the claim: You just verify the Cauchy Riemann equations. Letting
Î» (x + iy) = u (x, y) + iv (x, y) ,
Î»1 (x + iy)
=
u (âˆ’x, y) âˆ’iv (âˆ’x, y)
â‰¡
u1 (x, y) + iv (x, y) .
Then u1x (x, y) = âˆ’ux (âˆ’x, y) and v1y (x, y) = âˆ’vy (âˆ’x, y) = âˆ’ux (âˆ’x, y) since
Î» is analytic.
Thus u1x = v1y.
Next, u1y (x, y) = uy (âˆ’x, y) and v1x (x, y) =
vx (âˆ’x, y) = âˆ’uy (âˆ’x, y) and so u1y = âˆ’vx.
Now recall that on l1, Î» takes real values. Therefore, Î»1 = Î» on l1, a set with
a limit point. It follows Î» = Î»1 on â„¦â€² âˆªâ„¦. By Theorem 30.23 Î» maps â„¦one to
one onto the upper half plane. Therefore, from the deï¬nition of Î»1 = Î», it follows
Î» maps â„¦â€² one to one onto the lower half plane as claimed. This has shown that Î»

30.1.
PERIODIC FUNCTIONS
847
is one to one on â„¦âˆªâ„¦â€². This also veriï¬es from Theorem 25.22 on Page 696 that
Î»â€² Ì¸= 0 on â„¦âˆªâ„¦â€².
Now consider the lines l2 and C. If Î»â€² (z) = 0 for z âˆˆl2, a contradiction can
be obtained. Pick such a point. If Î»â€² (z) = 0, then z is a zero of order m â‰¥2 of
the function, Î» âˆ’Î» (z) . Then by Theorem 25.22 there exist Î´, Îµ > 0 such that if
w âˆˆB (Î» (z) , Î´) , then Î»âˆ’1 (w) âˆ©B (z, Îµ) contains at least m points.
â„¦â€²
r
âˆ’1
â„¦
C
l2
l1
r
1
r
1
2
z1r
B(z, Îµ)
z
r
r
Î»(z1)
B(Î»(z), Î´)
Î»(z)
r
In particular, for z1 âˆˆâ„¦âˆ©B (z, Îµ) suï¬ƒciently close to z, Î» (z1) âˆˆB (Î» (z) , Î´)
and so the function Î» âˆ’Î» (z1) has at least two distinct zeros. These zeros must be
in B (z, Îµ) âˆ©â„¦because Î» (z1) has positive imaginary part and the points on l2 are
mapped by Î» to a real number while the points of B (z, Îµ) \ â„¦are mapped by Î» to
the lower half plane thanks to the relation, Î» (z + 2) = Î» (z) . This contradicts Î»
one to one on â„¦. Therefore, Î»â€² Ì¸= 0 on l2. Consider C. Points on C are of the form
1 âˆ’1
Ï„ where Ï„ âˆˆl2. Therefore, using 30.33,
Î»
Âµ
1 âˆ’1
Ï„
Â¶
= Î» (Ï„) âˆ’1
Î» (Ï„)
.
Taking the derivative of both sides,
Î»â€²
Âµ
1 âˆ’1
Ï„
Â¶ Âµ 1
Ï„ 2
Â¶
= Î»â€² (Ï„)
Î» (Ï„)2 Ì¸= 0.
Since Î» is periodic of period 2 it follows Î»â€² (z) Ì¸= 0 for all z âˆˆâˆªâˆž
k=âˆ’âˆž(Q + 2k) .
Lemma 30.26 If Im (Ï„) > 0 then there exists a unimodular
Âµ
a
b
c
d
Â¶
such that
c + dÏ„
a + bÏ„

848
ELLIPTIC FUNCTIONS
is contained in the interior of Q. In fact,
Â¯Â¯Â¯ c+dÏ„
a+bÏ„
Â¯Â¯Â¯ â‰¥1 and
âˆ’1/2 â‰¤Re
Âµc + dÏ„
a + bÏ„
Â¶
â‰¤1/2.
Proof: Letting a basis for the module of periods of â„˜be {1, Ï„} , it follows from
Theorem 30.3 on Page 820 that there exists a basis for the same module of periods,
{wâ€²
1, wâ€²
2} with the property that for Ï„ â€² = wâ€²
2/wâ€²
1
|Ï„ â€²| â‰¥1, âˆ’1
2 â‰¤Re Ï„ â€² â‰¤1
2.
Since this is a basis for the same module of periods, there exists a unimodular
matrix,
Âµ
a
b
c
d
Â¶
such that
Âµ
wâ€²
1
wâ€²
2
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
1
Ï„
Â¶
.
Hence,
Ï„ â€² = wâ€²
2
wâ€²
1
= c + dÏ„
a + bÏ„ .
Thus Ï„ â€² is in the interior of H. In fact, it is on the interior of â„¦â€² âˆªâ„¦â‰¡Q.
0
s
s
1
1/2
âˆ’1
âˆ’1/2
Ï„
â€² s
30.1.7
A Short Review And Summary
With this lemma, it is easy to extend Corollary 30.25. First, a simple observation
and review is a good idea. Recall that when you change the basis for the module
of periods, the Weierstrass â„˜function does not change and so the set of ei used in
deï¬ning Î» also do not change. Letting the new basis be {wâ€²
1, wâ€²
2} , it was shown
that
Âµ
wâ€²
1
wâ€²
2
Â¶
=
Âµ
a
b
c
d
Â¶ Âµ
w1
w2
Â¶

30.1.
PERIODIC FUNCTIONS
849
for some unimodular transformation,
Âµ a
b
c
d
Â¶
. Letting Ï„ = w2/w1 and Ï„ â€² =
wâ€²
2/wâ€²
1
Ï„ â€² = c + dÏ„
a + bÏ„ â‰¡Ï† (Ï„)
Now as discussed earlier
Î» (Ï„ â€²)
=
Î» (Ï† (Ï„)) â‰¡
â„˜
Â³
wâ€²
1+wâ€²
2
2
Â´
âˆ’â„˜
Â³
wâ€²
2
2
Â´
â„˜
Â³
wâ€²
1
2
Â´
âˆ’â„˜
Â³
wâ€²
2
2
Â´
=
â„˜
Â³
1+Ï„ â€²
2
Â´
âˆ’â„˜
Â³
Ï„ â€²
2
Â´
â„˜
Â¡ 1
2
Â¢
âˆ’â„˜
Â¡ Ï„ â€²
2
Â¢
These numbers in the above fraction must be the same as â„˜
Â¡ 1+Ï„
2
Â¢
, â„˜
Â¡ Ï„
2
Â¢
, and
â„˜
Â¡ 1
2
Â¢
but they might occur diï¬€erently. This is because â„˜does not change and these
numbers are the zeros of a polynomial having coeï¬ƒcients involving only numbers
and â„˜(z) . It could happen for example that â„˜
Â³
1+Ï„ â€²
2
Â´
= â„˜
Â¡ Ï„
2
Â¢
in which case this
would change the value of Î». In eï¬€ect, you can keep track of all possibilities by
simply permuting the ei in the formula for Î» (Ï„) given by e3âˆ’e2
e1âˆ’e2 . Thus consider the
following permutation table.
1
2
3
2
3
1
3
1
2
2
1
3
1
3
2
3
2
1
.
Corresponding to this list of 6 permutations, all possible formulas for Î» (Ï† (Ï„))
can be obtained as follows. Letting Ï„ â€² = Ï† (Ï„) where Ï† is a unimodular matrix
corresponding to a change of basis,
Î» (Ï„ â€²) = e3 âˆ’e2
e1 âˆ’e2
= Î» (Ï„)
(30.34)
Î» (Ï„ â€²) = e1 âˆ’e3
e2 âˆ’e3
= e3 âˆ’e2 + e2 âˆ’e1
e3 âˆ’e2
= 1 âˆ’
1
Î» (Ï„) = Î» (Ï„) âˆ’1
Î» (Ï„)
(30.35)
Î» (Ï„ â€²)
=
e2 âˆ’e1
e3 âˆ’e1
= âˆ’
Â·e3 âˆ’e2 âˆ’(e1 âˆ’e2)
e1 âˆ’e2
Â¸âˆ’1
=
âˆ’[Î» (Ï„) âˆ’1]âˆ’1 =
1
1 âˆ’Î» (Ï„)
(30.36)
Î» (Ï„ â€²)
=
e3 âˆ’e1
e2 âˆ’e1
= âˆ’
Â·e3 âˆ’e2 âˆ’(e1 âˆ’e2)
e1 âˆ’e2
Â¸
=
âˆ’[Î» (Ï„) âˆ’1] = 1 âˆ’Î» (Ï„)
(30.37)

850
ELLIPTIC FUNCTIONS
Î» (Ï„ â€²) = e2 âˆ’e3
e1 âˆ’e3
=
e3 âˆ’e2
e3 âˆ’e2 âˆ’(e1 âˆ’e2) =
1
1 âˆ’
1
Î»(Ï„)
=
Î» (Ï„)
Î» (Ï„) âˆ’1
(30.38)
Î» (Ï„ â€²) = e1 âˆ’e3
e3 âˆ’e2
=
1
Î» (Ï„)
(30.39)
Corollary 30.27 Î»â€² (Ï„) Ì¸= 0 for all Ï„ in the upper half plane, denoted by P+.
Proof: Let Ï„ âˆˆP+. By Lemma 30.26 there exists Ï† a unimodular transforma-
tion and Ï„ â€² in the interior of Q such that Ï„ â€² = Ï† (Ï„). Now from the deï¬nition of Î» in
terms of the ei, there is at worst a permutation of the ei and so it might be the case
that Î» (Ï† (Ï„)) Ì¸= Î» (Ï„) but it is the case that Î» (Ï† (Ï„)) = Î¾ (Î» (Ï„)) where Î¾â€² (z) Ì¸= 0.
Here Î¾ is one of the functions determined by 30.34 - 30.39. (Since Î» (Ï„) /âˆˆ{0, 1} ,
Î¾â€² (Î» (z)) Ì¸= 0. This follows from the above possibilities for Î¾ listed above in 30.34 -
30.39.) All the possibilities are Î¾ (z) =
z, z âˆ’1
z
,
1
1 âˆ’z , 1 âˆ’z,
z
z âˆ’1, 1
z
and these are the same as the possibilities for Î¾âˆ’1. Therefore, Î»â€² (Ï† (Ï„)) Ï†â€² (Ï„) =
Î¾â€² (Î» (Ï„)) Î»â€² (Ï„) and so Î»â€² (Ï„) Ì¸= 0 as claimed.
Now I will present a lemma which is of major signiï¬cance. It depends on the
remarkable mapping properties of the modular function and the monodromy theo-
rem from analytic continuation. A review of the monodromy theorem will be listed
here for convenience. First recall the deï¬nition of the concept of function elements
and analytic continuation.
Deï¬nition 30.28 A function element is an ordered pair, (f, D) where D is an open
ball and f is analytic on D. (f0, D0) and (f1, D1) are direct continuations of each
other if D1 âˆ©D0 Ì¸= âˆ…and f0 = f1 on D1 âˆ©D0. In this case I will write (f0, D0) âˆ¼
(f1, D1) . A chain is a ï¬nite sequence, of disks, {D0, Â· Â· Â·, Dn} such that Diâˆ’1 âˆ©Di Ì¸=
âˆ…. If (f0, D0) is a given function element and there exist function elements, (fi, Di)
such that {D0, Â· Â· Â·, Dn} is a chain and (fjâˆ’1, Djâˆ’1) âˆ¼(fj, Dj) then (fn, Dn) is
called the analytic continuation of (f0, D0) along the chain {D0, Â· Â· Â·, Dn}.
Now
suppose Î³ is an oriented curve with parameter interval [a, b] and there exists a chain,
{D0, Â· Â· Â·, Dn} such that Î³âˆ—âŠ†âˆªn
k=1Dk, Î³ (a) is the center of D0, Î³ (b) is the center
of Dn, and there is an increasing list of numbers in [a, b] , a = s0 < s1 Â· Â·Â· < sn = b
such that Î³ ([si, si+1]) âŠ†Di and (fn, Dn) is an analytic continuation of (f0, D0)
along the chain. Then (fn, Dn) is called an analytic continuation of (f0, D0) along
the curve Î³. (Î³ will always be a continuous curve. Nothing more is needed. )
Then the main theorem is the monodromy theorem listed next, Theorem 27.19
and its corollary on Page 749.
Theorem 30.29 Let â„¦be a simply connected subset of C and suppose (f, B (a, r))
is a function element with B (a, r) âŠ†â„¦. Suppose also that this function element can
be analytically continued along every curve through a. Then there exists G analytic
on â„¦such that G agrees with f on B (a, r).

30.1.
PERIODIC FUNCTIONS
851
Here is the lemma.
Lemma 30.30 Let Î» be the modular function deï¬ned on P+ the upper half plane.
Let V be a simply connected region in C and let f : V â†’C\ {0, 1} be analytic
and nonconstant. Then there exists an analytic function, g : V â†’P+ such that
Î» â—¦g = f.
Proof: Let a âˆˆV and choose r0 small enough that f (B (a, r0)) contains neither
0 nor 1. You need only let B (a, r0) âŠ†V . Now there exists a unique point in Q, Ï„ 0
such that Î» (Ï„ 0) = f (a).
By Corollary 30.25, Î»â€² (Ï„ 0) Ì¸= 0 and so by the open
mapping theorem, Theorem 25.22 on Page 696, There exists B (Ï„ 0, R0) âŠ†P+ such
that Î» is one to one on B (Ï„ 0, R0) and has a continuous inverse. Then picking r0
still smaller, it can be assumed f (B (a, r0)) âŠ†Î» (B (Ï„ 0, R0)). Thus there exists
a local inverse for Î», Î»âˆ’1
0
deï¬ned on f (B (a, r0)) having values in B (Ï„ 0, R0) âˆ©
Î»âˆ’1 (f (B (a, r0))). Then deï¬ning g0 â‰¡Î»âˆ’1
0
â—¦f, (g0, B (a, r0)) is a function element.
I need to show this can be continued along every curve starting at a in such a way
that each function in each function element has values in P+.
Let Î³ : [Î±, Î²] â†’V be a continuous curve starting at a, (Î³ (Î±) = a) and sup-
pose that if t < T there exists a nonnegative integer m and a function element
(gm, B (Î³ (t) , rm)) which is an analytic continuation of (g0, B (a, r0)) along Î³ where
gm (Î³ (t)) âˆˆP+ and each function in every function element for j â‰¤m has values
in P+. Thus for some small T > 0 this has been achieved.
Then consider f (Î³ (T)) âˆˆC\ {0, 1} . As in the ï¬rst part of the argument, there
exists a unique Ï„ T âˆˆQ such that Î» (Ï„ T ) = f (Î³ (T)) and for r small enough there is
an analytic local inverse, Î»âˆ’1
T
between f (B (Î³ (T) , r)) and Î»âˆ’1 (f (B (Î³ (T) , r))) âˆ©
B (Ï„ T , RT ) âŠ†P+ for some RT > 0. By the assumption that the analytic continua-
tion can be carried out for t < T, there exists {t0, Â· Â· Â·, tm = t} and function elements
(gj, B (Î³ (tj) , rj)) , j = 0, Â· Â· Â·, m as just described with gj (Î³ (tj)) âˆˆP+, Î» â—¦gj = f
on B (Î³ (tj) , rj) such that for t âˆˆ[tm, T] , Î³ (t) âˆˆB (Î³ (T) , r). Let
I = B (Î³ (tm) , rm) âˆ©B (Î³ (T) , r) .
Then since Î»âˆ’1
T
is a local inverse, it follows for all z âˆˆI
Î» (gm (z)) = f (z) = Î»
Â¡
Î»âˆ’1
T
â—¦f (z)
Â¢
Pick z0 âˆˆI . Then by Lemma 30.19 on Page 840 there exists a unimodular mapping
of the form
Ï† (z) = az + b
cz + d
where
Âµ
a
b
c
d
Â¶
âˆ¼
Âµ
1
0
0
1
Â¶
mod 2
such that
gm (z0) = Ï†
Â¡
Î»âˆ’1
T
â—¦f (z0)
Â¢
.

852
ELLIPTIC FUNCTIONS
Since both gm (z0) and Ï†
Â¡
Î»âˆ’1
T
â—¦f (z0)
Â¢
are in the upper half plane, it follows ad âˆ’
cb = 1 and Ï† maps the upper half plane to the upper half plane. Note the pole of
Ï† is real and all the sets being considered are contained in the upper half plane so
Ï† is analytic where it needs to be.
Claim: For all z âˆˆI,
gm (z) = Ï† â—¦Î»âˆ’1
T
â—¦f (z) .
(30.40)
Proof: For z = z0 the equation holds. Let
A =
Â©
z âˆˆI : gm (z) = Ï†
Â¡
Î»âˆ’1
T
â—¦f (z)
Â¢Âª
.
Thus z0 âˆˆI. If z âˆˆI and if w is close enough to z, then w âˆˆI also and so both
sides of 30.40 with w in place of z are in Î»âˆ’1
m (f (I)) . But by construction, Î» is one
to one on this set and since Î» is invariant with respect to Ï†,
Î» (gm (w)) = Î»
Â¡
Î»âˆ’1
T
â—¦f (w)
Â¢
= Î»
Â¡
Ï† â—¦Î»âˆ’1
T
â—¦f (w)
Â¢
and consequently, w âˆˆA. This shows A is open. But A is also closed in I because
the functions are continuous. Therefore, A = I and so 30.40 is obtained.
Letting f (z) âˆˆf (B (Î³ (T)) , r) ,
Î»
Â¡
Ï†
Â¡
Î»âˆ’1
T (f (z))
Â¢Â¢
= Î»
Â¡
Î»âˆ’1
T (f (z))
Â¢
= f (z)
and so Ï† â—¦Î»âˆ’1
T
is a local inverse for Î» on f (B (Î³ (T)) , r) . Let the new function
element be
ï£«
ï£¬
ï£­
gm+1
z
}|
{
Ï† â—¦Î»âˆ’1
T
â—¦f, B (Î³ (T) , r)
ï£¶
ï£·
ï£¸. This has shown the initial function element
can be continued along every curve through a.
By the monodromy theorem, there exists g analytic on V such that g has values
in P+ and g = g0 on B (a, r0) . By the construction, it also follows Î» â—¦g = f. This
last claim is easy to see because Î» â—¦g = f on B (a, r0) , a set with a limit point so
the equation holds for all z âˆˆV . This proves the lemma.
30.2
The Picard Theorem Again
Having done all this work on the modular function which is important for its own
sake, there is an easy proof of the Picard theorem. In fact, this is the way Picard
did it in 1879. I will state it slightly diï¬€erently since it is no trouble to do so, [27].
Theorem 30.31 Let f be meromorphic on C and suppose f misses three distinct
points, a, b, c. Then f is a constant function.
Proof: Let Ï† (z) â‰¡zâˆ’a
zâˆ’c
bâˆ’c
bâˆ’a. Then Ï† (c) = âˆž, Ï† (a) = 0, and Ï† (b) = 1. Now
consider the function, h = Ï† â—¦f. Then h misses the three points âˆž, 0, and 1. Since
h is meromorphic and does not have âˆžin its values, it must actually be analytic.

30.3.
EXERCISES
853
Thus h is an entire function which misses the two values 0 and 1. If h is not constant,
then by Lemma 30.30 there exists a function, g analytic on C which has values in
the upper half plane, P+ such that Î» â—¦g = h. However, g must be a constant
because there exists Ïˆ an analytic map on the upper half plane which maps the
upper half plane to B (0, 1) . You can use the Riemann mapping theorem or more
simply, Ïˆ (z) = zâˆ’i
z+i. Thus Ïˆ â—¦g equals a constant by Liouvilleâ€™s theorem. Hence
g is a constant and so h must also be a constant because Î» (g (z)) = h (z) . This
proves f is a constant also. This proves the theorem.
30.3
Exercises
1. Show the set of modular transformations is a group. Also show those modular
transformations which are congruent mod 2 to the identity as described above
is a subgroup.
2. Suppose f is an elliptic function with period module M. If {w1, w2} and
{wâ€²
1, wâ€²
2} are two bases, show that the resulting period parallelograms resulting
from the two bases have the same area.
3. Given a module of periods with basis {w1, w2} and letting a typical element
of this module be denoted by w as described above, consider the product
Ïƒ (z) â‰¡z
Y
wÌ¸=0
Â³
1 âˆ’z
w
Â´
e(z/w)+ 1
2 (z/w)2.
Show this product converges uniformly on compact sets, is an entire function,
and satisï¬es
Ïƒâ€² (z) /Ïƒ (z) = Î¶ (z)
where Î¶ (z) was deï¬ned above as a primitive of â„˜(z) and is given by
Î¶ (z) = 1
z +
X
wÌ¸=0
1
z âˆ’w + z
w2 + 1
w.
4. Show Î¶ (z + wi) = Î¶ (z) + Î·i where Î·i is a constant.
5. Let Pa be the parallelogram shown in the following picture.
0
s
w1
w2s
s


Â£
Â£
Â£
Â£
Â£
Â£
Â£
Â£


Â£
Â£
Â£
Â£
Â£
Â£
Â£Â£
a s

Â£
Â£
Â£
Â£
Â£
Â£
Â£
Â£


Â£
Â£
Â£
Â£
Â£
Â£
Â£
Â£

854
ELLIPTIC FUNCTIONS
Show that
1
2Ï€i
R
âˆ‚Pa Î¶ (z) dz = 1 where the contour is taken once around the
parallelogram in the counter clockwise direction. Next evaluate this contour
integral directly to obtain Legendreâ€™s relation,
Î·1w2 âˆ’Î·2w1 = 2Ï€i.
6. For Ïƒ deï¬ned in Problem 3, 4 explain the following steps. For j = 1, 2
Ïƒâ€² (z + wj)
Ïƒ (z + wj) = Î¶ (z + wj) = Î¶ (z) + Î·j = Ïƒâ€² (z)
Ïƒ (z) + Î·j
Therefore, there exists a constant, Cj such that
Ïƒ (z + wj) = CjÏƒ (z) eÎ·jz.
Next show Ïƒ is an odd function, (Ïƒ (âˆ’z) = âˆ’Ïƒ (z)) and then let z = âˆ’wj/2
to ï¬nd Cj = âˆ’e
Î·j wj
2
and so
Ïƒ (z + wj) = âˆ’Ïƒ (z) eÎ·j(z+
wj
2 ).
(30.41)
7. Show any even elliptic function, f with periods w1 and w2 for which 0 is
neither a pole nor a zero can be expressed in the form
f (0)
n
Y
k=1
â„˜(z) âˆ’â„˜(ak)
â„˜(z) âˆ’â„˜(bk)
where C is some constant. Here â„˜is the Weierstrass function which comes
from the two periods, w1 and w2. Hint: You might consider the above func-
tion in terms of the poles and zeros on a period parallelogram and recall that
an entire function which is elliptic is a constant.
8. Suppose f is any elliptic function with {w1, w2} a basis for the module of
periods.
Using Theorem 30.9 and 30.41 show that there exists constants
a1, Â· Â· Â·, an and b1, Â· Â· Â·, bn such that for some constant C,
f (z) = C
n
Y
k=1
Ïƒ (z âˆ’ak)
Ïƒ (z âˆ’bk) .
Hint: You might try something like this: By Theorem 30.9, it follows that if
{Î±k} are the zeros and {bk} the poles in an appropriate period parallelogram,
P Î±k âˆ’P bk equals a period. Replace Î±k with ak such that P ak âˆ’P bk = 0.
Then use 30.41 to show that the given formula for f is bi periodic. Anyway,
you try to arrange things such that the given formula has the same poles as
f. Remember an entire elliptic function equals a constant.
9. Show that the map Ï„ â†’1 âˆ’1
Ï„ maps l2 onto the curve, C in the above picture
on the mapping properties of Î».
10. Modify the proof of Theorem 30.23 to show that Î» (â„¦)âˆ©{z âˆˆC : Im (z) < 0} =
âˆ….

Part IV
Stochastic Processes, An
Introduction
855


Random Variables And Basic
Probability
Caution: This material on probability and stochastic processes may be half baked
in places. I have not yet rewritten it several times. This is not to say that nothing
else is half baked. However, the probability is higher here.
Recall Lemma 11.3 on Page 305 which is stated here for convenience.
Lemma 31.1 Let M be a metric space with the closed balls compact and suppose
Î» is a measure deï¬ned on the Borel sets of M which is ï¬nite on compact sets.
Then there exists a unique Radon measure, Î» which equals Î» on the Borel sets. In
particular Î» must be both inner and outer regular on all Borel sets.
Also recall from earlier the following fundamental result which is called the Borel
Cantelli lemma.
Lemma 31.2 Let (â„¦, F, Î») be a measure space and let {Ai} be a sequence of mea-
surable sets satisfying
âˆž
X
i=1
Î» (Ai) < âˆž.
Then letting S denote the set of Ï‰ âˆˆâ„¦which are in inï¬nitely many Ai, it follows
S is a measurable set and Î» (S) = 0.
Proof: S = âˆ©âˆž
k=1 âˆªâˆž
m=k Am. Therefore, S is measurable and also
Î» (S) â‰¤Î» (âˆªâˆž
m=kAm) â‰¤
âˆž
X
m=k
Î» (Ak)
and this converges to 0 as k â†’âˆžbecause of the convergence of the series. This
proves the lemma.
Deï¬nition 31.3 A probability space is a measure space, (â„¦, F, P) where P is a
measure satisfying P (â„¦) = 1. A random vector is a measurable function, X : â„¦â†’
Rp. This might also be called a random variable. Deï¬ne the following Ïƒ algebra.
HX â‰¡
Â©
Xâˆ’1 (E) : E is Borel in RpÂª
857

858
RANDOM VARIABLES AND BASIC PROBABILITY
Thus HX âŠ†F. This is also often written as Ïƒ (X). For E a Borel set in Rp deï¬ne
Î»X (E) â‰¡P
Â¡
Xâˆ’1 (E)
Â¢
.
This is called the distribution of the random variable, X. If
Z
â„¦
|X (Ï‰)| dP < âˆž
then deï¬ne
E (X) â‰¡
Z
â„¦
XdP
where the integral is deï¬ned in the obvious way componentwise.
Lemma 31.4 For X a random vector deï¬ned above, Î»X is inner and outer regular,
Borel, and its completion is a Radon measure and Î»X (Rp) = 1. Furthermore, if h
is any bounded Borel measurable function,
Z
â„¦
h (X (Ï‰)) dP =
Z
Rp h (x) dÎ»X.
Proof: The assertions about Î»X follow from Lemma 11.3 on Page 305 listed
above. It remains to verify the formula involving the integrals. Suppose ï¬rst
h (x) = cXE (x)
where E is a Borel set in Rp. Then the left side equals
Z
â„¦
cXE (X (Ï‰)) dP =
Z
[XâˆˆE]
cdP = cÎ»X (E)
The right side equals
Z
Rp cXE (x) dÎ»X = cÎ»X (E) .
Similarly, if h is any Borel simple function, the same result will hold. For an arbi-
trary bounded Borel function, h, there exists a sequence of Borel simple functions,
{sn} converging to h. Hence, by the dominated convergence theorem,
Z
â„¦
h (X (Ï‰)) dP = lim
nâ†’âˆž
Z
â„¦
sn (X (Ï‰)) dP = lim
nâ†’âˆž
Z
sn (x) dÎ»X =
Z
Rp h (x) dÎ»X.
This proves the lemma.
Obviously, h could also be vector valued and Borel measurable and the same
argument would work or else you could simply consider the component functions of
h.

859
Deï¬nition 31.5 A ï¬nite set of random vectors, {Xk}n
k=1 is independent if when-
ever Fk âˆˆHXk (Ïƒ (Xk)),
P (âˆ©n
k=1Fk) =
n
Y
k=1
P (Fk) .
More generally, if {Fi}iâˆˆI is any set of Ïƒ algebras, they are said to be independent
if whenever Aik âˆˆFik for k = 1, 2, Â· Â· Â·, m, then
P (âˆ©m
k=1Aik) =
m
Y
k=1
P (Aik) .
Lemma 31.6 If {Xk}r
k=1 are independent and if gk is a Borel measurable function,
then {gk (Xk)}n
k=1 is also independent. Furthermore, if the random variables have
values in R and they are all bounded, then
E
Ãƒ r
Y
i=1
Xi
!
=
r
Y
i=1
E (Xi) .
Proof: First consider the claim about {gk (Xk)}r
k=1. Letting O be an open set
in R,
(gk â—¦Xk)âˆ’1 (O) = Xâˆ’1
k
Â¡
gâˆ’1
k
(O)
Â¢
= Xâˆ’1
k
(Borel set) âˆˆHXk.
It follows (gk â—¦Xk)âˆ’1 (E) is in HXk whenever E is Borel. Thus Hgkâ—¦Xk âŠ†HXk and
this proves the ï¬rst part of the lemma.
Now let
Â©
si
n
Âªâˆž
n=1 be a bounded sequence of simple functions measurable in HXi
which converges to Xi uniformly. (Since Xi is bounded, such a sequence exists by
breaking Xi into positive and negative parts and using Theorem 8.27 on Page 190.)
Say
si
n (Ï‰) =
mn
X
k=1
cn,i
k XEn,i
k
(Ï‰)
where the Ek are disjoint elements of HXi and some might be empty. This is for
convenience in keeping the same index on the top of the sum. Then since all the
random variables are bounded, there is no problem about existence of any of the

860
RANDOM VARIABLES AND BASIC PROBABILITY
above. Then from the assumption that the Xi are independent,
E
Ãƒ r
Y
i=1
Xi
!
=
Z
â„¦
r
Y
i=1
Xi (Ï‰) dP = lim
nâ†’âˆž
Z
â„¦
r
Y
i=1
si
n (Ï‰) dP
=
lim
nâ†’âˆž
Z
â„¦
r
Y
i=1
mn
X
k=1
cn,i
k XEn,i
k
(Ï‰) dP
=
lim
nâ†’âˆž
Z
â„¦
X
k1,k2,Â·Â·Â·,kr
cn,1
k1 cn,2
k2 Â· Â· Â· cn,r
kr XEn,1
k1 XEn,2
k2 Â· Â· Â· XEn,r
kr dP
=
lim
nâ†’âˆž
X
k1,k2,Â·Â·Â·,kr
Z
â„¦
cn,1
k1 cn,2
k2 Â· Â· Â· cn,r
kr XEn,1
k1 XEn,2
k2 Â· Â· Â· XEn,r
kr dP
=
lim
nâ†’âˆž
X
k1,k2,Â·Â·Â·,kr
cn,1
k1 cn,2
k2 Â· Â· Â· cn,r
kr
r
Y
i=1
P
Â³
En,i
ki
Â´
=
lim
nâ†’âˆž
r
Y
i=1
Z
â„¦
si
n (Ï‰) dP =
r
Y
i=1
E (Xi) .
This proves the lemma.
31.1
The Characteristic Function
Deï¬nition 31.7 Let X be a random variable as above. The characteristic function
is
Ï†X (t) â‰¡E
Â¡
eitÂ·XÂ¢
â‰¡
Z
â„¦
eitÂ·X(Ï‰)dP =
Z
Rp eitÂ·xdÎ»X
the last equation holding by Lemma 31.4.
Recall the following fundamental lemma and deï¬nition, Lemma 19.12 on Page
522.
Deï¬nition 31.8 For T âˆˆGâˆ—, deï¬ne FT, F âˆ’1T âˆˆGâˆ—by
FT (Ï†) â‰¡T (FÏ†) , F âˆ’1T (Ï†) â‰¡T
Â¡
F âˆ’1Ï†
Â¢
Lemma 31.9 F and F âˆ’1 are both one to one, onto, and are inverses of each other.
The main result on characteristic functions is the following.
Theorem 31.10 Let X and Y be random vectors with values in Rp and suppose
E
Â¡
eitÂ·XÂ¢
= E
Â¡
eitÂ·YÂ¢
for all t âˆˆRp. Then Î»X = Î»Y.

31.2.
CONDITIONAL PROBABILITY
861
Proof: For Ïˆ âˆˆG, let Î»X (Ïˆ) â‰¡
R
Rp ÏˆdÎ»X and Î»Y (Ïˆ) â‰¡
R
Rp ÏˆdÎ»Y . Thus both
Î»X and Î»Y are in Gâˆ—. Then letting Ïˆ âˆˆG and using Fubiniâ€™s theorem,
Z
Rp
Z
Rp eitÂ·yÏˆ (t) dtdÎ»Y
=
Z
Rp
Z
Rp eitÂ·ydÎ»YÏˆ (t) dt
=
Z
Rp E
Â¡
eitÂ·YÂ¢
Ïˆ (t) dt
=
Z
Rp E
Â¡
eitÂ·XÂ¢
Ïˆ (t) dt
=
Z
Rp
Z
Rp eitÂ·xdÎ»XÏˆ (t) dt
=
Z
Rp
Z
Rp eitÂ·xÏˆ (t) dtdÎ»X.
Thus Î»Y
Â¡
F âˆ’1Ïˆ
Â¢
= Î»X
Â¡
F âˆ’1Ïˆ
Â¢
. Since Ïˆ âˆˆG is arbitrary and F âˆ’1 is onto, this
implies Î»X = Î»Y in Gâˆ—. But G is dense in C0 (Rp) and so Î»X = Î»Y as measures.
This proves the theorem.
31.2
Conditional Probability
Here I will consider the concept of conditional probability depending on the theory
of diï¬€erentiation of general Radon measures and leading to the Doob Dynkin lemma.
If X, Y are two random vectors deï¬ned on a probability space having values
in Rp1 and Rp2 respectively, and if E is a Borel set in the appropriate space, then
(X, Y) is a random vector with values in Rp1 Ã—Rp2 and Î»(X,Y) (E Ã— Rp2) = Î»X (E),
Î»(X,Y) (Rp1 Ã— E) = Î»Y (E). Thus, by Theorem 18.12 on Page 505, there exist
probability measures, denoted here by Î»X|y and Î»Y|x, such that whenever E is a
Borel set in Rp1 Ã— Rp2,
Z
Rp1Ã—Rp2
XEdÎ»(X,Y) =
Z
Rp1
Z
Rp2
XEdÎ»Y|xdÎ»X,
and
Z
Rp1Ã—Rp2
XEdÎ»(X,Y) =
Z
Rp2
Z
Rp1
XEdÎ»X|ydÎ»Y.
Deï¬nition 31.11 Let X and Y be two random vectors deï¬ned on a probability
space. The conditional probability measure of Y given X is the measure Î»Y|x in the
above. Similarly the conditional probability measure of X given Y is the measure
Î»X|y.
More generally, one can use the theory of slicing measures to consider any ï¬nite
list of random vectors, {Xi}, deï¬ned on a probability space with Xi âˆˆRpi, and
write the following for E a Borel set in Qn
i=1 Rpi.
Z
Rp1Ã—Â·Â·Â·Ã—Rpn
XEdÎ»(X1,Â·Â·Â·,Xn) =
Z
Rp1
Z
Rp2Ã—Â·Â·Â·Ã—Rpn
XEdÎ»(X2,Â·Â·Â·,Xn)|x1dÎ»X1

862
RANDOM VARIABLES AND BASIC PROBABILITY
=
Z
Rp1
Z
Rp2
Z
Rp3Ã—Â·Â·Â·Ã—Rpn
XEdÎ»(X3,Â·Â·Â·,Xn)|x1x2dÎ»X2|x1dÎ»X1
...
=
Z
Rp1
Â· Â· Â·
Z
Rpn
XEdÎ»Xn|x1x2Â·Â·Â·xnâˆ’1dÎ»Xnâˆ’1|x1Â·Â·Â·xnâˆ’2 Â· Â· Â· dÎ»X2|x1dÎ»X1.
(31.1)
Obviously, this could have been done in any order in the iterated integrals by
simply modifying the â€œgivenâ€ variables, those occurring after the symbol |, to be
those which have been integrated in an outer level of the iterated integral.
Deï¬nition 31.12 Let {X1, Â· Â· Â·, Xn} be random vectors deï¬ned on a probability
space having values in Fp1, Â·Â·Â·, Fpn respectively. The random vectors are independent
if for every E a Borel set in Fp1 Ã— Â· Â· Â· Ã— Fpn,
Z
Rp1Ã—Â·Â·Â·Ã—Rpn
XEdÎ»(X1,Â·Â·Â·,Xn)
=
Z
Rp1
Â· Â· Â·
Z
Rpn
XEdÎ»XndÎ»Xnâˆ’1 Â· Â· Â· dÎ»X2dÎ»X1
(31.2)
and the iterated integration may be taken in any order. If A is any set of random
vectors deï¬ned on a probability space, A is independent if any ï¬nite set of random
vectors from A is independent.
Thus, the random vectors are independent exactly when the dependence on the
givens in 31.1 can be dropped.
Does this amount to the same thing as discussed earlier?
These two ran-
dom vectors, X, Y were independent if whenever A âˆˆHX (Ïƒ (X)) and B âˆˆHY,
P (A âˆ©B) = P (A) P (B) . Suppose the above deï¬nition and A and B as described.
Let A = Xâˆ’1 (E) and B = Yâˆ’1 (F) . Then
P (A âˆ©B)
=
P ((X, Y) âˆˆE Ã— F)
=
Z
Rp1Ã—Rp2
XE (x) XF (y) dÎ»(X,Y)
=
Z
Rp1
Z
Rp2
XE (x) XF (y) dÎ»Y|xdÎ»X
=
Z
Rp1
Z
Rp2
XE (x) XF (y) dÎ»YdÎ»X
=
Î»X (E) Î»Y (F) = P (A) P (B)
Next suppose P (A âˆ©B) = P (A) P (B) where A âˆˆHX and B âˆˆHY, A = Xâˆ’1 (E)
and B = Yâˆ’1 (F) . Can it be asserted Î»X|y = Î»X? In this case, for all E Borel in

31.2.
CONDITIONAL PROBABILITY
863
Rp1 and F Borel in Rp2,
Z
Rp1
Z
Rp2
XE (x) XF (y) dÎ»YdÎ»X
=
P (A) P (B) = P (A âˆ©B)
=
Z
Rp1Ã—Rp2
XE (x) XF (y) dÎ»(X,Y)
=
Z
Rp1
Z
Rp2
XE (x) XF (y) dÎ»Y|xdÎ»X
and so, by uniqueness of the slicing measures, dÎ»Y|x = dÎ»Y. A similar argument
shows dÎ»X|y = dÎ»X. Thus this amounts to the same thing discussed earlier.
Proposition 31.13 Equations 31.2 and 31.1 hold with XE replaced by any non-
negative Borel measurable function and for any bounded continuous function.
Proof: The two equations hold for simple functions in place of XE and so an
application of the monotone convergence theorem applied to an increasing sequence
of simple functions converging pointwise to a given nonnegative Borel measurable
function yields the conclusion of the proposition in the case of the nonnegative
Borel function. For a bounded continuous function, one can apply the result just
established to the positive and negative parts of the real and imaginary parts of the
function.
Lemma 31.14 Let X1, Â·Â·Â·, Xn be random vectors with values in Rp1, Â·Â·Â·, Rpn respec-
tively and let g : Rp1 Ã— Â· Â· Â· Ã— Rpn â†’Rk be Borel measurable. Then g (X1, Â· Â· Â·, Xn)
is a random vector with values in Rk and if h : Rk â†’[0, âˆž), then
Z
Rk h (y) dÎ»g(X1,Â·Â·Â·,Xn) (y) =
Z
Rp1Ã—Â·Â·Â·Ã—Rpn
h (g (x1, Â· Â· Â·, xn)) dÎ»(X1,Â·Â·Â·,Xn).
(31.3)
If Xi is a random vector with values in Rpi, i = 1, 2, Â· Â· Â· and if gi : Rpi â†’Rki,
where gi is Borel measurable, then the random vectors gi (Xi) are also independent
whenever the Xi are independent.
Proof: First let E be a Borel set in Rk. From the deï¬nition,
Z
Rk XEdÎ»g(X1,Â·Â·Â·,Xn)
=
Z
Rp1Ã—Â·Â·Â·Ã—Rpn
Xgâˆ’1(E)dÎ»(X1,Â·Â·Â·,Xn)
=
Z
Rp1Ã—Â·Â·Â·Ã—Rpn
XE (g (x1, Â· Â· Â·, xn)) dÎ»(X1,Â·Â·Â·,Xn).
This proves 31.3 in the case when h is XE. To prove it in the general case, approx-
imate the nonnegative Borel measurable function with simple functions for which
the formula is true, and use the monotone convergence theorem.

864
RANDOM VARIABLES AND BASIC PROBABILITY
It remains to prove the last assertion that functions of independent random
vectors are also independent random vectors. Let E be a Borel set in Rk1 Ã—Â·Â·Â·Ã—Rkn.
Then for
Ï€i (x1, Â· Â· Â·, xn) â‰¡xi,
Z
Rk1Ã—Â·Â·Â·Ã—Rkn
XEdÎ»(g1(X1),Â·Â·Â·,gn(Xn))
â‰¡
Z
Rp1Ã—Â·Â·Â·Ã—Rpn
XE â—¦(g1 â—¦Ï€1, Â· Â· Â·, gn â—¦Ï€n) dÎ»(X1,Â·Â·Â·,Xn)
=
Z
Rp1
Â· Â· Â·
Z
Rpn
XE â—¦(g1 â—¦Ï€1, Â· Â· Â·, gn â—¦Ï€n) dÎ»Xn Â· Â· Â· dÎ»X1
=
Z
Rk1
Â· Â· Â·
Z
Rkn
XEdÎ»gn(Xn) Â· Â· Â· dÎ»g1(X1)
and this proves the last assertion.
Proposition 31.15 Let Î½1, Â· Â· Â·, Î½n be Radon probability measures deï¬ned on Rp.
Then there exists a probability space and independent random vectors {X1, Â· Â· Â·, Xn}
deï¬ned on this probability space such that Î»Xi = Î½i.
Proof: Let (â„¦, S, P) â‰¡((Rp)n , S1 Ã— Â· Â· Â· Ã— Sn, Î½1 Ã— Â· Â· Â· Ã— Î½n) where this is just
the product Ïƒ algebra and product measure which satisï¬es the following for mea-
surable rectangles.
(Î½1 Ã— Â· Â· Â· Ã— Î½n)
Ãƒ n
Y
i=1
Ei
!
=
n
Y
i=1
Î½i (Ei).
Now let Xi (x1, Â· Â· Â·, xi, Â· Â· Â·, xn) = xi. Then from the deï¬nition, if E is a Borel set
in Rp,
Î»Xi (E) â‰¡P {Xi âˆˆE}
= (Î½1 Ã— Â· Â· Â· Ã— Î½n) (Rp Ã— Â· Â· Â· Ã— E Ã— Â· Â· Â· Ã— Rp) = Î½i (E).
Let M consist of all Borel sets of (Rp)n such that
Z
Rp Â· Â· Â·
Z
Rp XE (x1, Â· Â· Â·, xn) dÎ»X1 Â· Â· Â· dÎ»Xn =
Z
(Rp)n XEdÎ»(X1,Â·Â·Â·,Xn).
From what was just shown and the deï¬nition of (Î½1 Ã— Â· Â· Â· Ã— Î½n) that M contains
all sets of the form Qn
i=1 Ei where each Ei âˆˆBorel sets of Rp.
Therefore, M
contains the algebra of all ï¬nite disjoint unions of such sets. It is also clear that
M is a monotone class and so by the theorem on monotone classes, M equals the
Borel sets. Therefore, the given random vectors are independent and this proves
the proposition.
The following Lemma was proved earlier in a diï¬€erent way.

31.2.
CONDITIONAL PROBABILITY
865
Lemma 31.16 If {Xi}n
i=1 are independent random variables having values in R,
E
Ãƒ n
Y
i=1
Xi
!
=
n
Y
i=1
E (Xi).
Proof: By Lemma 31.14 and denoting by P the product, Qn
i=1 Xi,
E
Ãƒ n
Y
i=1
Xi
!
=
Z
R
zdÎ»P (z) =
Z
RÃ—R
n
Y
i=1
xidÎ»(X1,Â·Â·Â·,Xn)
=
Z
R
Â· Â· Â·
Z
R
n
Y
i=1
xidÎ»X1 Â· Â· Â· dÎ»Xn =
n
Y
i=1
E (Xi).
There is a way to tell if random vectors are independent by using their charac-
teristic functions.
Proposition 31.17 If X1 and X2 are random vectors having values in Rp1 and
Rp2 respectively, then the random vectors are independent if and only if
E
Â¡
eiP Â¢
=
2
Y
j=1
E
Â¡
eitjÂ·XjÂ¢
where P â‰¡P2
j=1 tj Â· Xj for tj âˆˆRpj. More generally, if Xi is a random vector
having values in Rpi for i = 1, 2, Â· Â· Â·, n, and if P = Pn
j=1 tj Â· Xj, then the random
vectors are independent if and only if
E
Â¡
eiP Â¢
=
n
Y
j=1
E
Â¡
eitjÂ·XjÂ¢
.
The proof of this proposition will depend on the following lemma.
Lemma 31.18 Let Y be a random vector with values in Rp and let f be bounded
and measurable with respect to the Radon measure, Î»Y, and satisfy
Z
f (y) eitÂ·ydÎ»Y = 0
for all t âˆˆRp. Then f (y) = 0 for Î»Y a.e. y.
Proof: The proof is just like the proof of Theorem 31.10 on Page 860 applied
to the measure, f (y) dÎ»Y. Thus
R
E f (y) dÎ»Y = 0 for all E Borel. Hence f (y) = 0
a.e.
Proof of the proposition: If the Xj are independent, the formula follows
from Lemma 31.16 and Lemma 31.14.
Now suppose the formula holds. Then
Z
Rp2
Z
Rp1
eit1Â·x1eit2Â·x2dÎ»X1dÎ»X2 = E
Â¡
eiP Â¢

866
RANDOM VARIABLES AND BASIC PROBABILITY
=
Z
Rp2
Z
Rp1
eit1Â·x1eit2Â·x2dÎ»X1|x2dÎ»X2.
Now apply Lemma 31.18 to conclude that
Z
Rp1
eit1Â·x1dÎ»X1 =
Z
Rp1
eit1Â·x1dÎ»X1|x2
(31.4)
for Î»X2 a.e. x2, the exceptional set depending on t1. Therefore, taking the union of
all exceptional sets corresponding to t1 âˆˆQp1, it follows by continuity and the domi-
nated convergence theorem that 31.4 holds for all t1 whenever x2 is not an element of
this exceptional set of measure zero. Therefore, for such x2, Theorem 31.10 applies
and it follows Î»X1|x2 = Î»X1 for Î»X2 a.e. x2. Hence, if E is a Borel set in Rp1 Ã—Rp2,
R
Rp1+p2 XEdÎ»(X1,X2) =
R
Rp2
R
Rp1 XEdÎ»X1|x2dÎ»X2 =
R
Rp2
R
Rp1 XEdÎ»X1dÎ»X2. A re-
peat of the above argument will give the iterated integral in the reverse order or
else one could apply Fubiniâ€™s theorem to obtain this. The proposition also holds if 2
is replaced with n and the argument is a longer version of what was just presented.
This proves the proposition.
With this preparation, it is time to present the Doob Dynkin lemma.I am not
entirely sure what the Doob Dynkin lemma says actually. What follows is a gener-
alization of what is identiï¬ed as a special case of this lemma in [42]. I am not sure
I have the right generalization. However, it is a very interesting lemma regardless
of its name.
Lemma 31.19 Suppose X, Y1, Y2, Â·Â·Â·, Yk are random vectors, X having values in
Rn and Yj having values in Rpj and
X, Yj âˆˆL1 (â„¦) .
Suppose X is H(Y1,Â·Â·Â·,Yk) measurable. Thus
Â©
Xâˆ’1 (E) : E Borel
Âª
âŠ†
ï£±
ï£²
ï£³(Y1, Â· Â· Â·, Yk)âˆ’1 (F) : F is Borel in
k
Y
j=1
Rpj
ï£¼
ï£½
ï£¾
Then there exists a Borel function, g : Qk
j=1 Rpj â†’Rn such that
X = g (Y1, Y2, Â· Â· Â·, Yk) .
Proof: For the sake of brevity, denote by Y the vector (Y1, Â· Â· Â·, Yk) and by y
the vector (y1, Â· Â· Â·, yk) and let Qk
j=1 Rpj â‰¡RP . For E a Borel set of Rn,
Z
Yâˆ’1(E)
XdP
=
Z
RnÃ—RP XRnÃ—E (x, y) xdÎ»(X,Y)
=
Z
E
Z
Rn xdÎ»X|ydÎ»Y.
(31.5)
Consider the function
y â†’
Z
Rn xdÎ»X|y.

31.3.
THE MULTIVARIATE NORMAL DISTRIBUTION
867
Since dÎ»Y is a Radon measure having inner and outer regularity, it follows the
above function is equal to a Borel function for Î»Y a.e. y. This function will be
denoted by g. Then from 31.5
Z
Yâˆ’1(E)
XdP
=
Z
E
g (y) dÎ»Y =
Z
RP XE (y) g (y) dÎ»Y
=
Z
â„¦
XE (Y (Ï‰)) g (Y (Ï‰)) dP
=
Z
Yâˆ’1(E)
g (Y (Ï‰)) dP
and since Yâˆ’1 (E) is an arbitrary element of HY, this shows that since X is HY
measurable,
X = E (X|HY) = g (Y) .
This proves the lemma.
Note also that as part of this argument, it is shown that if the symbol,
E (X|y1, Â· Â· Â·, yk)
is deï¬ned as the function g in the above, then for a.e. Ï‰,
E
Â¡
X|H(Y1,Y2,Â·Â·Â·,Yk)
Â¢
(Ï‰) = E (X|Y1 (Ï‰) , Y2 (Ï‰) , Â· Â· Â·, Yk (Ï‰))
which is a fairly attractive formula.
31.3
The Multivariate Normal Distribution
Deï¬nition 31.20 A random vector, X, with values in Rp has a multivariate nor-
mal distribution written as X âˆ¼Np (m, Î£) if for all Borel E âŠ†Rp,
Î»X (E) =
Z
Rp XE (x)
1
(2Ï€)p/2 det (Î£)1/2 e
âˆ’1
2 (xâˆ’m)âˆ—Î£âˆ’1(xâˆ’m)dx
for Âµ a given vector and Î£ a given positive deï¬nite symmetric matrix.
Theorem 31.21 For X âˆ¼Np (m, Î£) , m = E (X) and
Î£ = E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
.
Proof: Let R be an orthogonal transformation such that
RÎ£Râˆ—= D = diag
Â¡
Ïƒ2
1, Â· Â· Â·, Ïƒ2
p
Â¢
.

868
RANDOM VARIABLES AND BASIC PROBABILITY
Changing the variable by x âˆ’m = Râˆ—y,
E (X)
â‰¡
Z
Rp xe
âˆ’1
2 (xâˆ’m)âˆ—Î£âˆ’1(xâˆ’m)dx
Ãƒ
1
(2Ï€)p/2 det (Î£)1/2
!
=
Z
Rp (Râˆ—y + m) eâˆ’1
2 yâˆ—Dâˆ’1ydy
Ãƒ
1
(2Ï€)p/2 Qp
i=1 Ïƒi
!
=
m
Z
Rp eâˆ’1
2 yâˆ—Dâˆ’1ydy
Ãƒ
1
(2Ï€)p/2 Qp
i=1 Ïƒi
!
= m
by Fubiniâ€™s theorem and the easy to establish formula
1
âˆš
2Ï€Ïƒ
Z
R
eâˆ’y2
2Ïƒ2 dy = 1.
Next let M â‰¡E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
. Thus, changing the variable as above by
x âˆ’m = Râˆ—y
M
=
Z
Rp (x âˆ’m) (x âˆ’m)âˆ—e
âˆ’1
2 (xâˆ’m)âˆ—Î£âˆ’1(xâˆ’m)dx
Ãƒ
1
(2Ï€)p/2 det (Î£)1/2
!
=
Râˆ—
Z
Rp yyâˆ—eâˆ’1
2 yâˆ—Dâˆ’1ydy
Ãƒ
1
(2Ï€)p/2 Qp
i=1 Ïƒi
!
R
Therefore,
(RMRâˆ—)ij =
Z
Rp yiyjeâˆ’1
2 yâˆ—Dâˆ’1ydy
Ãƒ
1
(2Ï€)p/2 Qp
i=1 Ïƒi
!
= 0,
so; RMRâˆ—is a diagonal matrix.
(RMRâˆ—)ii =
Z
Rp y2
i eâˆ’1
2 yâˆ—Dâˆ’1ydy
Ãƒ
1
(2Ï€)p/2 Qp
i=1 Ïƒi
!
.
Using Fubiniâ€™s theorem and the easy to establish equations,
1
âˆš
2Ï€Ïƒ
Z
R
eâˆ’y2
2Ïƒ2 dy = 1,
1
âˆš
2Ï€Ïƒ
Z
R
y2eâˆ’y2
2Ïƒ2 dy = Ïƒ2,
it follows (RMRâˆ—)ii = Ïƒ2
i . Hence RMRâˆ—= D and so M = Râˆ—DR = Î£. This
proves the theorem.
Theorem 31.22 Suppose X1 âˆ¼Np (m1, Î£1) , X2 âˆ¼Np (m2, Î£2) and the two ran-
dom vectors are independent. Then
X1 + X2 âˆ¼Np (m1 + m2, Î£1 + Î£2).
(31.6)

31.3.
THE MULTIVARIATE NORMAL DISTRIBUTION
869
Also, if X âˆ¼Np (m, Î£) then âˆ’X âˆ¼Np (âˆ’m, Î£) . Furthermore, if X âˆ¼Np (m, Î£)
then
E
Â¡
eitÂ·XÂ¢
= eitÂ·meâˆ’1
2 tâˆ—Î£t
(31.7)
Also if a is a constant and X âˆ¼Np (m, Î£) then aX âˆ¼Np
Â¡
am, a2Î£
Â¢
.
Proof: Consider E
Â¡
eitÂ·XÂ¢
for X âˆ¼Np (m, Î£).
E
Â¡
eitÂ·XÂ¢
â‰¡
1
(2Ï€)p/2 (det Î£)1/2
Z
Rp eitÂ·xeâˆ’1
2 (xâˆ’m)âˆ—Î£âˆ’1(xâˆ’m)dx.
Let R be an orthogonal transformation such that
RÎ£Râˆ—= D = diag
Â¡
Ïƒ2
1, Â· Â· Â·, Ïƒ2
p
Â¢
.
Then let R (x âˆ’m) = y. Then
E
Â¡
eitÂ·XÂ¢
=
1
(2Ï€)p/2 Qp
i=1 Ïƒi
Z
Rp eitÂ·(Râˆ—y+m)eâˆ’1
2 yâˆ—Dâˆ’1ydx.
Therefore
E
Â¡
eitÂ·XÂ¢
=
1
(2Ï€)p/2 Qp
i=1 Ïƒi
Z
Rp eisÂ·(y+Rm)eâˆ’1
2 yâˆ—Dâˆ’1ydx
where s =Rt. This equals
eitÂ·m
p
Y
i=1
ÂµZ
R
eisiyie
âˆ’
1
2Ïƒ2
i
y2
i dyi
Â¶
1
âˆš
2Ï€Ïƒi
= eitÂ·m
p
Y
i=1
ÂµZ
R
eisiÏƒiueâˆ’1
2 u2du
Â¶
1
âˆš
2Ï€
= eitÂ·m
p
Y
i=1
eâˆ’1
2 s2
i Ïƒ2
i
1
âˆš
2Ï€
Z
R
eâˆ’1
2 (uâˆ’isiÏƒi)2du
= eitÂ·meâˆ’1
2
Pp
i=1 s2
i Ïƒ2
i = eitÂ·meâˆ’1
2 tâˆ—Î£t
This proves 31.7.
Since X1 and X2 are independent, eitÂ·X1 and eitÂ·X2 are also independent. Hence
E
Â¡
eitÂ·X1+X2Â¢
= E
Â¡
eitÂ·X1Â¢
E
Â¡
eitÂ·X2Â¢
.
Thus,
E
Â¡
eitÂ·X1+X2Â¢
=
E
Â¡
eitÂ·X1Â¢
E
Â¡
eitÂ·X2Â¢
=
eitÂ·m1eâˆ’1
2 tâˆ—Î£1teitÂ·m2eâˆ’1
2 tâˆ—Î£2t
=
eitÂ·(m1+m2)eâˆ’1
2 tâˆ—(Î£1+Î£2)t

870
RANDOM VARIABLES AND BASIC PROBABILITY
which is the characteristic function of a random vector distributed as
Np (m1 + m2, Î£1 + Î£2).
Now it follows that X1 + X2 âˆ¼Np (m1 + m2, Î£1 + Î£2) by Theorem 31.10. This
proves 31.6.
The assertion about âˆ’X is also easy to see because
E
Â³
eitÂ·(âˆ’X)Â´
=
E
Â³
ei(âˆ’t)Â·XÂ´
=
1
(2Ï€)p/2 (det Î£)1/2
Z
Rp ei(âˆ’t)Â·xeâˆ’1
2 (xâˆ’m)âˆ—Î£âˆ’1(xâˆ’m)dx
=
1
(2Ï€)p/2 (det Î£)1/2
Z
Rp eitÂ·xeâˆ’1
2 (x+m)âˆ—Î£âˆ’1(x+m)dx
which is the characteristic function of a random variable which is N (âˆ’m, Î£) . The-
orem 31.10 again implies âˆ’X âˆ¼N (âˆ’m, Î£) . Finally consider the last claim. You
apply what is known about X with t replaced with at and then massage things.
This gives the characteristic function for aX is given by
E (exp (itÂ·aX)) = exp (itÂ·am) exp
Âµ
âˆ’1
2tâˆ—Î£a2t
Â¶
which is the characteristic function of a normal random vector having mean am
and covariance a2Î£. This proves the theorem.
Following [42] a random vector has a generalized normal distribution if its char-
acteristic function is given as
eitÂ·meâˆ’1
2 tâˆ—Î£t
(31.8)
where Î£ is symmetric and has nonnegative eigenvalues. For a random real valued
variable, m is scalar and so is Î£ so the characteristic function of such a generalized
normally distributed random variable is
eitÂµeâˆ’1
2 t2Ïƒ2
(31.9)
These generalized normal distributions do not require Î£ to be invertible, only that
the eigenvalues by nonnegative. In one dimension this would correspond the charac-
teristic function of a dirac measure having point mass 1 at Âµ. In higher dimensions,
it could be a mixture of such things with more familiar things. I wonâ€™t try very hard
to distinguish between generalized normal distributions and normal distributions in
which the covariance matrix has all positive eigenvalues.
Here are some other interesting results about normal distributions found in [42].
The next theorem has to do with the question whether a random vector is normally
distributed in the above generalized sense.
Theorem 31.23 Let X = (X1, Â· Â· Â·, Xp) where each Xi is a real valued random
variable. Then X is normally distributed in the above generalized sense if and only

31.3.
THE MULTIVARIATE NORMAL DISTRIBUTION
871
if every linear combination, Pp
j=1 aiXi is normally distributed. In this case the
mean of X is
m = (E (X1) , Â· Â· Â·, E (Xp))
and the covariance matrix for X is
Î£jk = E
Â¡
(Xj âˆ’mj) (Xk âˆ’mk)âˆ—Â¢
.
Proof: Suppose ï¬rst X is normally distributed. Then its characteristic function
is of the form
Ï†X (t) = E
Â¡
eitÂ·XÂ¢
= eitÂ·meâˆ’1
2 tâˆ—Î£t.
Then letting a = (a1, Â· Â· Â·, ap)
E
Â³
eit Pp
j=1 aiXiÂ´
= E
Â¡
eitaÂ·XÂ¢
= eitaÂ·meâˆ’1
2 aâˆ—Î£at2
which is the characteristic function of a normally distributed random variable with
mean a Â· m and variance Ïƒ2 = aâˆ—Î£a. This proves half of the theorem.
Next suppose Pp
j=1 ajXj = a Â· X is normally distributed with mean Âµ and
variance Ïƒ2 so that its characteristic function is given in 31.9. I will now relate Âµ and
Ïƒ2 to various quantities involving the Xj. Letting mj = E (Xj) , m = (m1, Â· Â· Â·, mp)âˆ—
Âµ
=
p
X
j=1
ajE (Xj) =
p
X
j=1
ajmj, Ïƒ2 = E
ï£«
ï£¬
ï£­
ï£«
ï£­
p
X
j=1
ajXj âˆ’
p
X
j=1
ajmj
ï£¶
ï£¸
2ï£¶
ï£·
ï£¸
=
E
ï£«
ï£¬
ï£­
ï£«
ï£­
p
X
j=1
aj (Xj âˆ’mj)
ï£¶
ï£¸
2ï£¶
ï£·
ï£¸=
X
j,k
ajakE ((Xj âˆ’mj) (Xk âˆ’mk))
It follows the mean of the normally distributed random variable, a Â· X is
Âµ =
X
j
ajmj = a Â· m
and its variance is
Ïƒ2 = aâˆ—E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
a
Therefore,
E
Â¡
eitaÂ·XÂ¢
= eitÂµeâˆ’1
2 t2Ïƒ2
= eitaÂ·meâˆ’1
2 t2aâˆ—E((Xâˆ’m)(Xâˆ’m)âˆ—)a.
Then letting s = ta this shows
E
Â¡
eisÂ·XÂ¢
=
eisÂ·meâˆ’1
2 sâˆ—E((Xâˆ’m)(Xâˆ’m)âˆ—)s
=
eisÂ·meâˆ’1
2 sâˆ—Î£s

872
RANDOM VARIABLES AND BASIC PROBABILITY
which is the characteristic function of a normally distributed random variable with
m given above and Î£ given by
Î£jk = E ((Xj âˆ’mj) (Xk âˆ’mk)) .
This proves the theorem.
Corollary 31.24 Let X = (X1, Â· Â· Â·, Xp) , Y = (Y1, Â· Â· Â·, Yp) where each Xi, Yi is a
real valued random variable. Suppose also that for every a âˆˆRp, a Â· X and a Â· Y
are both normally distributed with the same mean and variance. Then X and Y are
both multivariate normal random vectors with the same mean and variance.
Proof: In the Proof of Theorem 31.23 the proof implies that the characteristic
functions of a Â· X and a Â· Y are both of the form
eitmeâˆ’1
2 Ïƒ2t2.
Then as in the proof of that theorem, it must be the case that
m =
p
X
j=1
ajmj
where E (Xi) = mi = E (Yi) and
Ïƒ2
=
aâˆ—E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
a
=
aâˆ—E
Â¡
(Y âˆ’m) (Y âˆ’m)âˆ—Â¢
a
and this last equation must hold for every a. Therefore,
E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
= E
Â¡
(Y âˆ’m) (Y âˆ’m)âˆ—Â¢
â‰¡Î£
and so the characteristic function of both X and Y is eisÂ·meâˆ’1
2 sâˆ—Î£s as in the proof
of Theorem 31.23. This proves the corollary.
Theorem 31.25 Suppose X = (X1, Â· Â· Â·, Xp) is normally distributed with mean m
and covariance Î£. Then if X1 is uncorrelated with any of the Xi, meaning
E ((X1 âˆ’m1) (Xj âˆ’mj)) = 0 for j > 1,
then X1 and (X2, Â· Â· Â·, Xp) are both normally distributed and the two random vectors
are independent. Here mj â‰¡E (Xj) . More generally, if the covariance matrix is a
diagonal matrix, the random variables, {X1, Â· Â· Â·, Xp} are linearly independent.
Proof: From Theorem 31.21
Î£ = E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
.

31.3.
THE MULTIVARIATE NORMAL DISTRIBUTION
873
Then by assumption,
Î£ =
Âµ
Ïƒ2
1
0
0
Î£pâˆ’1
Â¶
.
(31.10)
I need to verify that if E âˆˆHX1 (Ïƒ (X1)) and F âˆˆH(X2,Â·Â·Â·,Xp) (Ïƒ (X2, Â· Â· Â·, Xp)),
then
P (E âˆ©F) = P (E) P (F) .
Let E = Xâˆ’1
1
(A) and
F = (X2, Â· Â· Â·, Xp)âˆ’1 (B)
where A and B are Borel sets in R and Rpâˆ’1 respectively. Thus I need to verify
that
P ([(X1, (X2, Â· Â· Â·, Xp)) âˆˆ(A, B)]) =
Âµ(X1,(X2,Â·Â·Â·,Xp)) (A Ã— B) = ÂµX1 (A) Âµ(X2,Â·Â·Â·,Xp) (B) .
(31.11)
Using 31.10, Fubiniâ€™s theorem, and deï¬nitions,
Âµ(X1,(X2,Â·Â·Â·,Xp)) (A Ã— B) =
Z
Rp XAÃ—B (x)
1
(2Ï€)p/2 det (Î£)1/2 e
âˆ’1
2 (xâˆ’m)âˆ—Î£âˆ’1(xâˆ’m)dx
=
Z
R
XA (x1)
Z
Rpâˆ’1 XB (X2, Â· Â· Â·, Xp) Â·
1
(2Ï€)(pâˆ’1)/2 âˆš
2Ï€ (Ïƒ2
1)1/2 det (Î£pâˆ’1)1/2 e
âˆ’(x1âˆ’m1)2
2Ïƒ2
1
Â·
e
âˆ’1
2 (xâ€²âˆ’mâ€²)
âˆ—Î£âˆ’1
pâˆ’1
Â³
x
â€²âˆ’mâ€²Â´
dxâ€²dx1
where xâ€² = (x2, Â· Â· Â·, xp) and mâ€² = (m2, Â· Â· Â·, mp) . Now this equals
Z
R
XA (x1)
1
p
2Ï€Ïƒ2
1
e
âˆ’(x1âˆ’m1)2
2Ïƒ2
1
Z
B
1
(2Ï€)(pâˆ’1)/2 det (Î£pâˆ’1)1/2 Â·
(31.12)
e
âˆ’1
2 (xâ€²âˆ’mâ€²)
âˆ—Î£âˆ’1
pâˆ’1
Â³
x
â€²âˆ’mâ€²Â´
dxâ€²dx.
(31.13)
In case B = Rpâˆ’1, the inside integral equals 1 and
Î»X1 (A)
=
Î»(X1,(X2,Â·Â·Â·,Xp))
Â¡
A Ã— Rpâˆ’1Â¢
=
Z
R
XA (x1)
1
p
2Ï€Ïƒ2
1
e
âˆ’(x1âˆ’m1)2
2Ïƒ2
1
dx1
which shows X1 is normally distributed as claimed. Similarly, letting A = R,
Î»(X2,Â·Â·Â·,Xp) (B)
=
Î»(X1,(X2,Â·Â·Â·,Xp)) (R Ã— B)
=
Z
B
1
(2Ï€)(pâˆ’1)/2 det (Î£pâˆ’1)1/2 e
âˆ’1
2 (xâ€²âˆ’mâ€²)
âˆ—Î£âˆ’1
pâˆ’1
Â³
x
â€²âˆ’mâ€²Â´
dxâ€²

874
RANDOM VARIABLES AND BASIC PROBABILITY
and (X2, Â· Â· Â·, Xp) is also normally distributed with mean mâ€² and covariance Î£pâˆ’1.
Now from 31.12, 31.11 follows. In case the covariance matrix is diagonal, the above
reasoning extends in an obvious way to prove the random variables, {X1, Â· Â· Â·, Xp}
are independent.
However, another way to prove this is to use Proposition 31.17 on Page 865 and
consider the characteristic function. Let E (Xj) = mj and
P =
p
X
j=1
tjXj.
Then since X is normally distributed and the covariance is a diagonal,
D â‰¡
ï£«
ï£¬
ï£­
Ïƒ2
1
0
...
0
Ïƒ2
p
ï£¶
ï£·
ï£¸
,
E
Â¡
eiP Â¢
=
E
Â³
eitÂ·(Xâˆ’m)Â´
= eitÂ·meâˆ’1
2 tâˆ—Î£t
=
exp
ï£«
ï£­
p
X
j=1
itjmj âˆ’1
2t2
jÏƒ2
j
ï£¶
ï£¸
(31.14)
=
p
Y
j=1
exp
Âµ
itjmj âˆ’1
2t2
jÏƒ2
j
Â¶
Also,
E
Â¡
eitjXjÂ¢
=
E
ï£«
ï£­exp
ï£«
ï£­itjXj +
X
kÌ¸=j
i0Xk
ï£¶
ï£¸
ï£¶
ï£¸
=
exp
Âµ
itjmj âˆ’1
2t2
jÏƒ2
j
Â¶
With 31.14, this shows
E
Â¡
eiP Â¢
=
p
Y
j=1
E
Â¡
eitjXjÂ¢
which shows by Proposition 31.17 that the random variables,
{X1, Â· Â· Â·, Xp}
are independent. This proves the theorem.

31.4.
THE CENTRAL LIMIT THEOREM
875
31.4
The Central Limit Theorem
The central limit theorem is one of the most marvelous theorems in mathematics.
It can be proved through the use of characteristic functions. Recall for x âˆˆRp,
||x||âˆžâ‰¡max {|xj| , j = 1, Â· Â· Â·, p} .
Also recall the deï¬nition of the distribution function for a random vector, X.
FX (x) â‰¡P (Xj â‰¤xj, j = 1, Â· Â· Â·, p) .
Deï¬nition 31.26 Let {Xn} be random vectors with values in Rp. Then {Î»Xn}âˆž
n=1
is called â€œtightâ€ if for all Îµ > 0 there exists a compact set, KÎµ such that
Î»Xn ([x /âˆˆKÎµ]) < Îµ
for all Î»Xn.
Lemma 31.27 If Xn, X are random vectors with values in Rpsuch that
lim
nâ†’âˆžÏ†Xn (t) = Ï†X (t)
for all t, then {Î»Xn}âˆž
n=1 is tight.
Proof: Let ej be the jth standard unit basis vector.
Â¯Â¯Â¯Â¯
1
u
Z u
âˆ’u
Â¡
1 âˆ’Ï†Xn (tej)
Â¢
dt
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
1
u
Z u
âˆ’u
Âµ
1 âˆ’
Z
Rp eitxjdÎ»Xn
Â¶
dt
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Z
Rp
1
u
Z u
âˆ’u
Â¡
1 âˆ’eitxjÂ¢
dtdÎ»Xn (x)
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯2
Z
Rp
Âµ
1 âˆ’sin (uxj)
uxj
Â¶
dÎ»Xn (x)
Â¯Â¯Â¯Â¯
â‰¥
2
Z
[|xj|â‰¥2
u]
Âµ
1 âˆ’
1
|uxj|
Â¶
dÎ»Xn (x)
â‰¥
2
Z
[|xj|â‰¥2
u]
Âµ
1 âˆ’
1
|u| (2/u)
Â¶
dÎ»Xn (x)
=
Z
[|xj|â‰¥2
u]
1dÎ»Xn (x)
=
Î»Xn
ÂµÂ·
x : |xj| â‰¥2
u
Â¸Â¶
.
If Îµ > 0 is given, there exists r > 0 such that if u â‰¤r,
1
u
Z u
âˆ’u
(1 âˆ’Ï†X (tej)) dt < Îµ/p

876
RANDOM VARIABLES AND BASIC PROBABILITY
for all j = 1, Â· Â· Â·, p and so, by the dominated convergence theorem, the same is true
with Ï†Xn in place of Ï†X provided n is large enough, say n â‰¥N (u). Thus, if u â‰¤r,
and n â‰¥N (u),
Î»Xn
ÂµÂ·
x : |xj| â‰¥2
u
Â¸Â¶
< Îµ/p
for all j âˆˆ{1, Â· Â· Â·, p}. It follows that for u â‰¤r and n â‰¥N (u) ,
Î»Xn
ÂµÂ·
x : ||x||âˆžâ‰¥2
u
Â¸Â¶
< Îµ.
This proves the lemma because there are only ï¬nitely many measures, Î»Xn for
n < N (u) and the compact set can be enlarged ï¬nitely many times to obtain a
single compact set, KÎµ such that for all n, Î»Xn ([x /âˆˆKÎµ]) < Îµ. This proves the
lemma.
Lemma 31.28 If Ï†Xn (t) â†’Ï†X (t) for all t, then whenever Ïˆ âˆˆS,
Î»Xn (Ïˆ) â‰¡
Z
Rp Ïˆ (y) dÎ»Xn (y) â†’
Z
Rp Ïˆ (y) dÎ»X (y) â‰¡Î»X (Ïˆ)
as n â†’âˆž.
Proof: Recall that if X is any random vector, its characteristic function is given
by
Ï†X (y) â‰¡
Z
Rp eiyÂ·xdÎ»X (x) .
Also remember the inverse Fourier transform. Letting Ïˆ âˆˆS, the Schwartz class,
F âˆ’1 (Î»X) (Ïˆ)
â‰¡
Î»X
Â¡
F âˆ’1Ïˆ
Â¢
â‰¡
Z
Rp F âˆ’1ÏˆdÎ»X
=
1
(2Ï€)p/2
Z
Rp
Z
Rp eiyÂ·xÏˆ (x) dxdÎ»X (y)
=
1
(2Ï€)p/2
Z
Rp Ïˆ (x)
Z
Rp eiyÂ·xdÎ»X (y) dx
=
1
(2Ï€)p/2
Z
Rp Ïˆ (x) Ï†X (x) dx
and so, considered as elements of Sâˆ—,
F âˆ’1 (Î»X) = Ï†X (Â·) (2Ï€)âˆ’(p/2) âˆˆLâˆž.
By the dominated convergence theorem
(2Ï€)p/2 F âˆ’1 (Î»Xn) (Ïˆ)
â‰¡
Z
Rp Ï†Xn (t) Ïˆ (t) dt
â†’
Z
Rp Ï†X (t) Ïˆ (t) dt
=
(2Ï€)p/2 F âˆ’1 (Î»X) (Ïˆ)

31.4.
THE CENTRAL LIMIT THEOREM
877
whenever Ïˆ âˆˆS. Thus
Î»Xn (Ïˆ)
=
FF âˆ’1Î»Xn (Ïˆ) â‰¡F âˆ’1Î»Xn (FÏˆ) â†’F âˆ’1Î»X (FÏˆ)
â‰¡
FF âˆ’1Î»X (Ïˆ) = Î»X (Ïˆ).
This proves the lemma.
Lemma 31.29 If Ï†Xn (t) â†’Ï†X (t) , then if Ïˆ is any bounded uniformly continuous
function,
lim
nâ†’âˆž
Z
Rp ÏˆdÎ»Xn =
Z
Rp ÏˆdÎ»X.
Proof: Let Îµ > 0 be given, let Ïˆ be a bounded function in Câˆž(Rp). Now let
Î· âˆˆCâˆž
c (Qr) where Qr â‰¡[âˆ’r, r]p satisfy the additional requirement that Î· = 1 on
Qr/2 and Î· (x) âˆˆ[0, 1] for all x. By Lemma 31.27 the set, {Î»Xn}âˆž
n=1 , is tight and
so if Îµ > 0 is given, there exists r suï¬ƒciently large such that for all n,
Z
[x/âˆˆQr/2]
|1 âˆ’Î·| |Ïˆ| dÎ»Xn < Îµ
3,
and
Z
[x/âˆˆQr/2]
|1 âˆ’Î·| |Ïˆ| dÎ»X < Îµ
3.
Thus,
Â¯Â¯Â¯Â¯
Z
Rp ÏˆdÎ»Xn âˆ’
Z
Rp ÏˆdÎ»X
Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯
Z
Rp ÏˆdÎ»Xn âˆ’
Z
Rp ÏˆÎ·dÎ»Xn
Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯
Z
Rp ÏˆÎ·dÎ»Xn âˆ’
Z
Rp ÏˆÎ·dÎ»X
Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯
Z
Rp ÏˆÎ·dÎ»X âˆ’
Z
Rp ÏˆdÎ»X
Â¯Â¯Â¯Â¯
â‰¤2Îµ
3 +
Â¯Â¯Â¯Â¯
Z
Rp ÏˆÎ·dÎ»Xn âˆ’
Z
Rp ÏˆÎ·dÎ»X
Â¯Â¯Â¯Â¯ < Îµ
whenever n is large enough by Lemma 31.28 because ÏˆÎ· âˆˆS. This establishes the
conclusion of the lemma in the case where Ïˆ is also inï¬nitely diï¬€erentiable. To
consider the general case, let Ïˆ only be uniformly continuous and let Ïˆk = Ïˆ âˆ—Ï†k
where Ï†k is a molliï¬er whose support is in (âˆ’(1/k) , (1/k))p. Then Ïˆk converges
uniformly to Ïˆ and so the desired conclusion follows for Ïˆ after a routine estimate.
Deï¬nition 31.30 Let Âµ be a Radon measure on Rp. A Borel set, A, is a Âµ conti-
nuity set if Âµ (âˆ‚A) = 0 where âˆ‚A â‰¡A \ interior (A).
The main result is the following continuity theorem. More can be said about
the equivalence of various criteria [9].
Theorem 31.31 If Ï†Xn (t) â†’Ï†X (t) then Î»Xn (A) â†’Î»X (A) whenever A is a Î»X
continuity set.

878
RANDOM VARIABLES AND BASIC PROBABILITY
Proof: First suppose K is a closed set and let
Ïˆk (x) â‰¡(1 âˆ’k dist (x,K))+.
Thus, since K is closed limkâ†’âˆžÏˆk (x) = XK (x). Choose k large enough that
Z
Rp ÏˆkdÎ»X â‰¤Î»X (K) + Îµ.
Then by Lemma 31.29, applied to the bounded uniformly continuous function Ïˆk,
lim sup
nâ†’âˆžÎ»Xn (K) â‰¤lim sup
nâ†’âˆž
Z
ÏˆkdÎ»Xn =
Z
ÏˆkdÎ»X â‰¤Î»X (K) + Îµ.
Since Îµ is arbitrary, this shows
lim sup
nâ†’âˆžÎ»Xn (K) â‰¤Î»X (K)
for all K closed.
Next suppose V is open and let
Ïˆk (x) = 1 âˆ’
Â³
1 âˆ’k dist
Â³
x, VCÂ´Â´+
.
Thus Ïˆk (x) âˆˆ[0, 1] , Ïˆk = 1 if dist
Â¡
x,V CÂ¢
â‰¥1/k, and Ïˆk = 0 on V C. Since V is
open, it follows
lim
kâ†’âˆžÏˆk (x) = XV (x).
Choose k large enough that
Z
ÏˆkdÎ»X â‰¥Î»X (V ) âˆ’Îµ.
Then by Lemma 31.29,
lim inf
nâ†’âˆžÎ»Xn (V ) â‰¥lim inf
nâ†’âˆž
Z
Ïˆk (x) dÎ»Xn =
=
Z
Ïˆk (x) dÎ»X â‰¥Î»X (V ) âˆ’Îµ
and since Îµ is arbitrary,
lim inf
nâ†’âˆžÎ»Xn (V ) â‰¥Î»X (V ).
Now let Î»X (âˆ‚A) = 0 for A a Borel set.
Î»X (interior (A))
â‰¤
lim inf
nâ†’âˆžÎ»Xn (interior (A)) â‰¤lim inf
nâ†’âˆžÎ»Xn (A) â‰¤
lim sup
nâ†’âˆžÎ»Xn (A)
â‰¤
lim sup
nâ†’âˆžÎ»Xn
Â¡
A
Â¢
â‰¤Î»X
Â¡
A
Â¢
.

31.4.
THE CENTRAL LIMIT THEOREM
879
But Î»X (interior (A)) = Î»X
Â¡
A
Â¢
by assumption and so limnâ†’âˆžÎ»Xn (A) = Î»X (A)
as claimed. This proves the theorem.
As an application of this theorem the following is a version of the central limit
theorem in the situation in which the limit distribution is multivariate normal. It
concerns a sequence of random vectors, {Xk}âˆž
k=1, which are identically distributed,
have ï¬nite mean m, and satisfy
sup
k
E
Â³
|Xk|2Â´
< âˆž.
(31.15)
Theorem 31.32 Let {Xk}âˆž
k=1 be random vectors satisfying 31.15, which are in-
dependent and identically distributed with mean m and positive deï¬nite covariance
Î£ â‰¡E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
. Let
Zn â‰¡
n
X
j=1
Xj âˆ’m
âˆšn
.
(31.16)
Then for Z âˆ¼Np (0, Î£) ,
lim
nâ†’âˆžFZn (x) = FZ (x)
(31.17)
for all x.
Proof: The characteristic function of Zn is given by
Ï†Zn (t) = E
Âµ
eitÂ· Pn
j=1
Xj âˆ’Âµ
âˆšn
Â¶
=
n
Y
j=1
E
Âµ
e
itÂ·
Â³ Xj âˆ’Âµ
âˆšn
Â´Â¶
.
By Taylorâ€™s theorem,
eix = 1 + ix âˆ’eiÎ¸xx2
2
for some Î¸ âˆˆ[0, 1] which depends on x. Denoting Xj as X, this implies
e
itÂ·
Â³
Xâˆ’Âµ
âˆšn
Â´
= 1 + itÂ·X âˆ’m
âˆšn
âˆ’eiÎ¸tÂ· Xâˆ’m
âˆšn (tÂ· (X âˆ’m))2
2n
where Î¸ depends on X and t and is in [0, 1]. The above equals
1 + itÂ·X âˆ’m
âˆšn
âˆ’(tÂ· (X âˆ’m))2
2n
+
Â³
1 âˆ’eiÎ¸tÂ· Xâˆ’m
âˆšn
Â´ (tÂ· (X âˆ’m))2
2n
.
Thus
Ï†Zn (t) =
n
Y
j=1
"
1 âˆ’E
Ãƒ
(tÂ· (X âˆ’m))2
2n
!

880
RANDOM VARIABLES AND BASIC PROBABILITY
+E
ÃƒÂ³
1 âˆ’eiÎ¸tÂ· Xâˆ’m
âˆšn
Â´ (tÂ· (X âˆ’m))2
2n
!#
=
n
Y
j=1
Â·
1 âˆ’1
2ntâˆ—Î£t+ 1
2nE
Â³Â³
1 âˆ’eiÎ¸tÂ· Xâˆ’m
âˆšn
Â´
(tÂ· (X âˆ’m))2Â´Â¸
.
(31.18)
(Note (tÂ· (X âˆ’m))2 = tâˆ—(X âˆ’m) (X âˆ’m)âˆ—t.) Now here is a simple inequality for
complex numbers whose moduli are no larger than one. I will give a proof of this
at the end. It follows easily by induction.
|z1 Â· Â· Â· zn âˆ’w1 Â· Â· Â· wn| â‰¤
n
X
k=1
|zk âˆ’wk|.
(31.19)
Also for each t, and all n large enough,
Â¯Â¯Â¯Â¯
1
2nE
Â³Â³
1 âˆ’eiÎ¸tÂ· Xâˆ’m
âˆšn
Â´
(tÂ· (X âˆ’m))2Â´Â¯Â¯Â¯Â¯ < 1.
Applying 31.19 to 31.18,
Ï†Zn (t) =
n
Y
j=1
Âµ
1 âˆ’1
2ntâˆ—Î£t
Â¶
+ en
where
|en|
â‰¤
n
X
j=1
Â¯Â¯Â¯Â¯
1
2nE
Â³Â³
1 âˆ’eiÎ¸tÂ· Xâˆ’m
âˆšn
Â´
(tÂ· (X âˆ’m))2Â´Â¯Â¯Â¯Â¯
=
1
2
Â¯Â¯Â¯E
Â³Â³
1 âˆ’eiÎ¸tÂ· Xâˆ’m
âˆšn
Â´
(tÂ· (X âˆ’m))2Â´Â¯Â¯Â¯
which converges to 0 as n â†’âˆžby the Dominated Convergence theorem. Therefore,
lim
nâ†’âˆž
Â¯Â¯Â¯Â¯Ï†Zn (t) âˆ’
Âµ
1 âˆ’tâˆ—Î£t
2n
Â¶nÂ¯Â¯Â¯Â¯ = 0
and so
lim
nâ†’âˆžÏ†Zn (t) = eâˆ’1
2 tâˆ—Î£t = Ï†Z (t)
where Z âˆ¼Np (0, Î£). Therefore, FZn (x) â†’FZ (x) for all x because Rx â‰¡Qp
k=1(âˆ’âˆž, xk]
is a set of Î»Z continuity due to the assumption that Î»Z â‰ªmp which is implied by
Z âˆ¼Np (0, Î£). This proves the theorem.
Here is the proof of the little inequality used above. The inequality is obviously
true if n = 1. Assume it is true for n. Then since all the numbers have absolute
value no larger than one,
Â¯Â¯Â¯Â¯Â¯
n+1
Y
i=1
zi âˆ’
n+1
Y
i=1
wi
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯
n+1
Y
i=1
zi âˆ’zn+1
n
Y
i=1
wi
Â¯Â¯Â¯Â¯Â¯
+
Â¯Â¯Â¯Â¯Â¯zn+1
n
Y
i=1
wi âˆ’
n+1
Y
i=1
wi
Â¯Â¯Â¯Â¯Â¯

31.5.
BROWNIAN MOTION
881
â‰¤
Â¯Â¯Â¯Â¯Â¯
n
Y
i=1
zi âˆ’
n
Y
i=1
wi
Â¯Â¯Â¯Â¯Â¯ + |zn+1 âˆ’wn+1|
â‰¤
n+1
X
k=1
|zk âˆ’wk|
by induction.
Suppose X is a random vector with covariance Î£ and mean m, and suppose also
that Î£âˆ’1 exists. Consider Î£âˆ’(1/2) (X âˆ’m) â‰¡Y. Then E (Y) = 0 and
E (YYâˆ—)
=
E
Â³
Î£âˆ’(1/2) (X âˆ’m) (Xâˆ—âˆ’Âµ) Î£âˆ’(1/2)Â´
=
Î£âˆ’(1/2)E ((X âˆ’m) (Xâˆ—âˆ’Âµ)) Î£âˆ’(1/2) = I.
Thus Y has zero mean and covariance I. This implies the following corollary to
Theorem 31.32.
Corollary 31.33 Let independent identically distributed random variables,
{Xj}âˆž
j=1
have mean m and positive deï¬nite covariance Î£ where Î£âˆ’1 exists. Then if
Zn â‰¡
n
X
j=1
Î£âˆ’(1/2) (Xj âˆ’Âµ)
âˆšn
,
it follows that for Z âˆ¼Np (0,I) ,
FZn (x) â†’FZ (x)
for all x.
31.5
Brownian Motion
Deï¬nition 31.34 A stochastic process is a set of random vectors, {Xt}tâ‰¥0.
Brownian motion is a special kind of stochastic process. I will construct it and
then summarize its properties.
First recall the Kolmogorov extension theorem listed next for convenience. In
this theorem, Mt was a metric space having closed balls compact and I was a totally
ordered index set. From now on Mt will equal Rn and the index set, I will be [0, âˆž).
Theorem 31.35 (Kolmogorov extension theorem) For each ï¬nite set
J = (t1, Â· Â· Â·, tn) âŠ†I,

882
RANDOM VARIABLES AND BASIC PROBABILITY
suppose there exists a Borel probability measure, Î½J = Î½t1Â·Â·Â·tn deï¬ned on the Borel
sets of Q
tâˆˆJ Mt such that if
(t1, Â· Â· Â·, tn) âŠ†(s1, Â· Â· Â·, sp) ,
then
Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn) = Î½s1Â·Â·Â·sp
Â¡
Gs1 Ã— Â· Â· Â· Ã— Gsp
Â¢
(31.20)
where if si = tj, then Gsi = Ftj and if si is not equal to any of the indices, tk,
then Gsi = M â€²
si. Then there exists a probability space, (â„¦, P, F) and measurable
functions, Xt : â„¦â†’Mt for each t âˆˆI such that for each (t1 Â· Â· Â· tn) âŠ†I,
Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn) = P ([Xt1 âˆˆFt1] âˆ©Â· Â· Â· âˆ©[Xtn âˆˆFtn]) .
(31.21)
Deï¬nition 31.36 For x, y âˆˆRn and t > 0 deï¬ne
p (t, x, y) â‰¡
1
(2Ï€t)n/2 exp
Ãƒ
âˆ’|y âˆ’x|2
2t
!
.
Then considered as a function of y this is a normal distribution with mean x and
covariance tI. In case t = 0 this is deï¬ned to be the measure Î´x which is deï¬ned by
Î´x (E) = 1 if x âˆˆE and 0 if x /âˆˆE.
Now deï¬ne for each increasing list (t1, t2, Â· Â· Â·, tk) , a measure deï¬ned as follows.
For F a Borel set in Rnk,
Î½t1t2Â·Â·Â·tk (F)
â‰¡
Z
F
p (t1, x, y1) p (t2 âˆ’t1, y1, y2)
Â· Â· Â·p (tk âˆ’tkâˆ’1, ykâˆ’1, yk) dy1dy2 Â· Â· Â· dyk.
(31.22)
Since
R
Rn p (s, x, y) dy = 1 whenever s â‰¥0, this shows the conditions of the Kol-
mogorov extension theorem are satisï¬ed for these measures and therefore there
exists a probability space, (â„¦, F, P) and measurable functions, Bt for each t â‰¥0
such that whenever the Fj are Borel sets,
Î½t1t2Â·Â·Â·tk (Ft1 Ã— Â· Â· Â· Ã— Ftk) = P ((Bt1, Â· Â· Â·, Btk) âˆˆFt1 Ã— Â· Â· Â· Ã— Ftk)
Lemma 31.37 Letting Z = (Bt1, Â· Â· Â·, Btk) âˆˆRnk it follows Z is normally dis-
tributed. Its mean is
Â¡
x
Â· Â· Â·
x
Â¢
âˆˆRnk
and its covariance is the nk Ã— nk matrix
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
t1In
t1In
t1In
Â· Â· Â·
t1In
t1In
t2In
t2In
Â· Â· Â·
t2In
t1In
t2In
...
...
...
...
...
...
t1In
t2In
Â· Â· Â·
Â· Â· Â·
tkIn
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
.

31.5.
BROWNIAN MOTION
883
Proof: To show this use Theorem 31.23. The components of Btj are indepen-
dent and normally distributed because Btj is distributed as y â†’p (tj, x, y) which
is deï¬ned above. The oï¬€diagonal terms of the correlation matrix are zero and so
by Theorem 31.25 the components are independent and all normally distributed.
Denote by Btjr the rth component of Btj. Thus the mean of Btjr is xr and the
variance of Btjr is tj. Also a Â· Btj is normally distributed with mean P arxr. To
verify Z is normally distributed, it suï¬ƒces to show that a Â· Z is normally distributed
for a = (a1, Â· Â· Â·, ak). Consider the case where k = 2. Then Z has values in R2n. I
will directly calculate the characteristic function for Z in this case and then note
that a similar pattern will hold for larger k.
E (exp(iu Â· Z))
=
Z Z
p (t1, x, y1) p (t2 âˆ’t1, y1, y2) eiu1Â·y1eiu2Â·y2dy2dy1
=
Z
p (t1, x, y1) eiu1Â·y1
Z
p (t2 âˆ’t1, y1, y2) eiu2Â·y2dy2dy1
=
Z
p (t1, x, y1) eiu1Â·y1
Âµ
exp
Âµ
iu2 Â· y1 +
Âµ
âˆ’1
2 (uâˆ—
2 (t2 âˆ’t1) Iu2)
Â¶Â¶Â¶
dy1
=
exp
Âµ
âˆ’1
2 (uâˆ—
2 (t2 âˆ’t1) Iu2)
Â¶ Z
p (t1, x, y1) eiu1Â·y1 (exp (iu2 Â· y1)) dy1
=
exp
Âµ
âˆ’1
2 (uâˆ—
2 (t2 âˆ’t1) Iu2)
Â¶ Z
p (t1, x, y1) ei(u1+u2)Â·y1dy1
=
exp
Âµ
âˆ’1
2 (uâˆ—
2 (t2 âˆ’t1) Iu2)
Â¶
exp
Âµ
âˆ’1
2 (u1 + u2)âˆ—t1I (u1 + u2)
Â¶
Â· exp (i (u1 + u2) Â· x)
=
exp
Âµ
âˆ’1
2
Â£
(uâˆ—
2 (t2 âˆ’t1) Iu2) + (u1 + u2)âˆ—t1I (u1 + u2)
Â¤Â¶
Â· exp (i (u1 + u2) Â· x) .
The expression (uâˆ—
2 (t2 âˆ’t1) Iu2) + (u1 + u2)âˆ—t1I (u1 + u2) equals
Â¡
u1
u2
Â¢ Âµ
t1I
t1I
t1I
t2I
Â¶ Âµ
u1
u2
Â¶
and the expression i (u1 + u2) Â· x equals
i
Â¡ u1
u2
Â¢
Â·
Â¡ x
x Â¢
and so in the case that k = 2, this shows Z is normally distributed with mean
Â¡
x
x
Â¢
and covariance
Âµ
t1I
t1I
t1I
t2I
Â¶
.
The pattern continues in this way. In general the mean is
Â¡
x
Â· Â· Â·
x
Â¢

884
RANDOM VARIABLES AND BASIC PROBABILITY
and the covariance is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
t1Ik
t1Ik
t1Ik
Â· Â· Â·
t1Ik
t1Ik
t2Ik
t2Ik
Â· Â· Â·
t2Ik
t1Ik
t2Ik
...
...
...
...
...
...
t1Ik
t2Ik
Â· Â· Â·
Â· Â· Â·
tkIk
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
This proves the lemma.
Continuing to follow [42],
E
Â³
|Bt âˆ’x|2Â´
=
n
X
r=1
E
Â³
(Btr âˆ’xr)2Â´
=
n
X
r=1
t = nt.
Then let s < t.
E
Â¡
(Bt âˆ’x)âˆ—(Bs âˆ’x)
Â¢
=
Z Z
p (s, x, y1) p (t âˆ’s, y1, y2) (y1 âˆ’x) Â· (y2 âˆ’x) dy1dy2
=
Z
p (s, x, y1) (y1 âˆ’x) Â·
Z
p (t âˆ’s, y1, y2) (y2 âˆ’x) dy2dy1
Consider the inner integral.
Z
p (t âˆ’s, y1, y2) (y2 âˆ’x) dy2
=
Z
p (t âˆ’s, y1, y2) ((y2 âˆ’y1) + (y1 âˆ’x)) dy2
=
Z
p (t âˆ’s, y1, y2) (y1 âˆ’x) dy2 = (y1 âˆ’x) .
Therefore,
E
Â¡
(Bt âˆ’x)âˆ—(Bs âˆ’x)
Â¢
=
Z
p (s, x, y1) |y1 âˆ’x|2 dy1
=
E
Â³
|Bs âˆ’x|2Â´
= ns
Now for t â‰¥s,
E
Â³
|Bt âˆ’Bs|2Â´
=
E
Â³
|Bt âˆ’x|2 + |Bs âˆ’x|2 âˆ’2 (Bt âˆ’x) Â· (Bs âˆ’x)
Â´
=
nt + ns âˆ’2ns = n (t âˆ’s) .
Lemma 31.38 Bt has independent increments. This means if t1 < t2 < Â· Â· Â· < tk,
the random variables,
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
are independent. In addition, these random variables are normally distributed.

31.5.
BROWNIAN MOTION
885
Proof: Bt1 is normal and so is each of the Btj. Also I claim that Btj âˆ’Btjâˆ’1
is normal with mean 0. I will show this next.
E
Â¡
exp
Â¡
iuÂ·
Â¡
Btj âˆ’Btjâˆ’1
Â¢Â¢Â¢
= E
Â¡
exp
Â¡
iu Â· Btj
Â¢
exp
Â¡
âˆ’iu Â· Btjâˆ’1
Â¢Â¢
=
Z Z
p (tjâˆ’1, x, y1) p (tj âˆ’tjâˆ’1, y1, y2) exp (âˆ’iu Â· y1) exp (iu Â· y2) dy2dy1
=
Z
p (tjâˆ’1, x, y1) exp (âˆ’iu Â· y1)
Z
p (tj âˆ’tjâˆ’1, y1, y2) exp (iu Â· y2) dy2dy1
=
Z
p (tjâˆ’1, x, y1) exp (âˆ’iu Â· y1) exp (iu Â· y1) exp
Âµ
âˆ’1
2 (tj âˆ’tjâˆ’1) |u|2
Â¶
dy1
=
exp
Âµ
âˆ’1
2 (tj âˆ’tjâˆ’1) |u|2
Â¶
.
(31.23)
Therefore, Btj âˆ’Btjâˆ’1 is normal with covariance (tj âˆ’tjâˆ’1) I and mean 0.
Next let Z =
Â¡
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
Â¢
. I need to verify Z is normally
distributed. Let u = (u1, Â· Â· Â·, uk) .
E (exp (iu Â· Z)) = E
Ãƒ
exp (iu1 Â· Bt1)
k
Y
r=2
exp
Â¡
iur Â·
Â¡
Btr âˆ’Btrâˆ’1
Â¢Â¢
!
=
Z
Rn Â· Â· Â·
Z
Rn p (t1, x, y1) p (t2 âˆ’t1, y1, y2) Â· Â· Â· p (tk âˆ’tkâˆ’1, ykâˆ’1, yk) Â·
exp (iu1 Â· y1)
k
Y
r=2
exp (iur Â· (yr âˆ’yrâˆ’1)) dykdykâˆ’1 Â· Â· Â· dy1.
The inside integral is
Z
p (tk âˆ’tkâˆ’1, ykâˆ’1, yk) exp (iuk Â· (yk âˆ’ykâˆ’1)) = exp
Âµ
âˆ’1
2 (tk âˆ’tkâˆ’1) |uk|2
Â¶
which has no y variables left so I can factor it out and then work on the next inside
integral which gives
exp
Âµ
âˆ’1
2 (tkâˆ’1 âˆ’tkâˆ’2) |ukâˆ’1|2
Â¶
which also can be factored out. Continuing this way eventually obtains
k
Y
j=1
exp
Âµ
âˆ’1
2 (tj âˆ’tjâˆ’1) |uk|2
Â¶ Z
p (t1, x, y1) exp (iu1 Â· y1) dy1
=
k
Y
j=1
exp
Âµ
âˆ’1
2 (tj âˆ’tjâˆ’1) |uk|2
Â¶
exp (iu1 Â· x) exp
Âµ
âˆ’1
2t1 |u1|2
Â¶
.

886
RANDOM VARIABLES AND BASIC PROBABILITY
Now let m = (x, 0, Â· Â· Â·, 0) and let Î£ be the matrix,
=
ï£«
ï£¬
ï£¬
ï£¬
ï£­
t1In
0
(t2 âˆ’t1) In
...
0
(tk âˆ’tkâˆ’1) In
ï£¶
ï£·
ï£·
ï£·
ï£¸
Then the above reduces to
exp (iu Â· m) exp
Âµ
âˆ’1
2uâˆ—Î£u
Â¶
which shows that Z is normally distributed with covariance Î£ and mean m. It also
shows that since the covariance matrix is diagonal, the component functions of Z
are independent. This proves the lemma.
Next I will consider an estimate for the Brownian motion. By 31.23 the charac-
teristic function for Bt âˆ’Bs and t > s is
E (exp (iuÂ· (Bt âˆ’Bs))) = exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶
It follows upon taking a partial derivative with respect to uj
E (i (Btj âˆ’Bsj) exp (iuÂ· (Bt âˆ’Bs)))
=
(âˆ’uj (t âˆ’s)) exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶
and then taking another partial derivative with respect to uj yields
E
Â³
âˆ’(Btj âˆ’Bsj)2 exp (iuÂ· (Bt âˆ’Bs))
Â´
=
(âˆ’(t âˆ’s) âˆ’uj (t âˆ’s)) exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶
+ (âˆ’uj (t âˆ’s))2 exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶
This looks pretty good. Lets take another derivative with respect to uj
E
Â³
âˆ’i (Btj âˆ’Bsj)3 exp (iuÂ· (Bt âˆ’Bs))
Â´
=
(âˆ’(t âˆ’s)) exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶
+ (âˆ’(t âˆ’s) âˆ’uj (t âˆ’s)) (âˆ’uj (t âˆ’s)) Â·
exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶
2uj (t âˆ’s)2 exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶
+ (âˆ’uj (t âˆ’s))3 exp
Âµ
âˆ’1
2 (t âˆ’s) |u|2
Â¶

31.5.
BROWNIAN MOTION
887
Finally take yet another derivative with respect to uj and then let u = 0.
E
Â³
(Btj âˆ’Bsj)4Â´
= (t âˆ’s)2 + 2 (t âˆ’s)2 = 3 (t âˆ’s)2 .
This shows
E
ï£«
ï£­
n
X
j=1
(Btj âˆ’Bsj)4
ï£¶
ï£¸= 3n (t âˆ’s)2 .
But also Pn
j=1 (Btj âˆ’Bsj)4 â‰¥(1/n) |Bt âˆ’Bs|2 and so
E
Â³
|Bt âˆ’Bs|4Â´
â‰¤3n2 (t âˆ’s)2 .
(31.24)
With more work, you can show the 3n2 can be replaced with n (n + 2) but it is the
inequality which is of interest here.
Before going further here is an interesting elementary lemma.
Lemma 31.39 Let D be a dense subset of an interval, I = [0, T] and suppose
X : D â†’Rn satisï¬es
|X (d) âˆ’X (dâ€²)| â‰¤C |d âˆ’dâ€²|Î³
for all dâ€², d âˆˆD. Then X extends uniquely to Y deï¬ned on [0, T] such that
|Y (t) âˆ’Y (tâ€²)| â‰¤C |t âˆ’tâ€²|Î³ .
Proof: Let t âˆˆI and let dk â†’t where dk âˆˆD. Then {X (dk)} is a Cauchy
sequence because |X (dk) âˆ’X (dm)| â‰¤C |dk âˆ’dm|Î³ . Therefore, X (dk) converges.
The thing it converges to will be called Y (t) . Note this is well deï¬ned, giving X (t)
if t âˆˆD. Also, if dk â†’t and dâ€²
k â†’t, then |X (dk) âˆ’X (dâ€²
k)| â‰¤C |dk âˆ’dâ€²
k|Î³ and so
X (dk) and X (dâ€²
k) converge to the same thing. Therefore, it makes sense to deï¬ne
Y (t) â‰¡limdâ†’t X (d). It only remains to verify the estimate. But letting |d âˆ’t| and
|dâ€² âˆ’tâ€²| be small enough,
|Y (t) âˆ’Y (tâ€²)|
=
|X (d) âˆ’X (dâ€²)|
â‰¤
C |dâ€² âˆ’d| + Îµ â‰¤C |t âˆ’tâ€²| + 2Îµ.
Since Îµ is arbitrary, this proves the existence part of the lemma. Uniqueness follows
from observing that Y (t) must equal limdâ†’t X (d). This proves the lemma.
The following is a very interesting theorem called the Kolmogorov Ë‡Centsov con-
tinuity theorem[33].
Theorem 31.40 Suppose Xt is a random vector for each t âˆˆ[0, âˆž). Suppose also
that for all T > 0 there exists a constant, C and positive numbers, Î±, Î² such that
E (|Xt âˆ’Xs|Î±) â‰¤C |t âˆ’s|1+Î²
(31.25)
Then there exist random vectors, Yt such that for a.e. Ï‰, t â†’Yt (Ï‰) is continuous
and P ([|Xt âˆ’Yt| > 0]) = 0.

888
RANDOM VARIABLES AND BASIC PROBABILITY
Proof: Let rm
j denote j
Â¡ T
2m
Â¢
where j âˆˆ{0, 1, Â· Â· Â·, 2m} . Also let Dm =
Â©
rm
j
Âª2m
j=1
and D = âˆªâˆž
m=1Dm. Consider the set,
[|Xt âˆ’Xs| > Î´]
for k = 1, 2, Â· Â· Â·. By 31.25,
P ([|Xt âˆ’Xs| > Î´]) Î´Î±
â‰¤
Z
[|Xtâˆ’Xs|>Î´]
|Xt âˆ’Xs|Î± dP
â‰¤
C |t âˆ’s|1+Î² .
(31.26)
Letting t = rk
j+1, s = rk
j ,and Î´ = 2âˆ’Î³k where
Î³ âˆˆ
Âµ
0, Î²
Î±
Â¶
,
this yields
P
Â³hÂ¯Â¯Â¯Xrk
j+1 âˆ’Xrk
j
Â¯Â¯Â¯ > 2âˆ’Î³kiÂ´
â‰¤C2Î±Î³k Â¡
T2âˆ’kÂ¢1+Î² .
There are 2k of these diï¬€erences and so letting
Ek =
hÂ¯Â¯Â¯Xrk
j+1 âˆ’Xrk
j
Â¯Â¯Â¯
Î±
> 2âˆ’Î³k for all j
i
it follows
P (Ek) â‰¤C2Î±Î³k Â¡
T2âˆ’kÂ¢1+Î² 2k = C2k(Î±Î³âˆ’Î²)T 1+Î².
Since Î³ < Î²/Î±,
âˆž
X
k=1
P (Ek) â‰¤CT 1+Î²
âˆž
X
k=1
2k(Î±Î³âˆ’Î²) < âˆž
and so by the Borel Cantelli lemma, Lemma 31.2, there exists a set of measure
zero, E, such that if Ï‰ /âˆˆE, then Ï‰ is in only ï¬nitely many Ek. In other words, for
Ï‰ /âˆˆE, there exists N (Ï‰) such that if k > N (Ï‰) , then for each j,
Â¯Â¯Â¯Xrk
j+1 (Ï‰) âˆ’Xrk
j (Ï‰)
Â¯Â¯Â¯ â‰¤2âˆ’Î³k.
(31.27)
Claim: If n â‰¥N (Ï‰) for Ï‰ /âˆˆE and if d, dâ€² âˆˆDm for m > n such that
|d âˆ’dâ€²| < T2âˆ’n, then
|Xdâ€² (Ï‰) âˆ’Xd (Ï‰)| â‰¤2
m
X
j=n+1
2âˆ’Î³j.
Proof of the claim: Suppose dâ€² < d. Suppose ï¬rst m = n + 1. Then d =
(k + 1) T2âˆ’(n+1) and dâ€² = kT2âˆ’(n+1). Then from 31.27
|Xdâ€² (Ï‰) âˆ’Xd (Ï‰)| â‰¤2âˆ’Î³(n+1) â‰¤2
n+1
X
j=n+1
2âˆ’Î³j.

31.5.
BROWNIAN MOTION
889
Suppose the claim is true for some m > n. Then let d, dâ€² âˆˆDm+1 with |d âˆ’dâ€²| <
T2âˆ’n. Let dâ€² â‰¤dâ€²
1 â‰¤d1 â‰¤d where d1, dâ€²
1 are in Dm and dâ€²
1 is the smallest element
of Dm which is at least as large as dâ€² and d1 is the largest element of Dm which is
no larger than d. Then |dâ€² âˆ’dâ€²
1| â‰¤T2âˆ’(m+1) and |d1 âˆ’d| â‰¤T2âˆ’(m+1) while all of
these are still in Dm+1 which contains Dm. Therefore, from 31.27 and induction,
|Xdâ€² (Ï‰) âˆ’Xd (Ï‰)|
â‰¤
Â¯Â¯Xdâ€² (Ï‰) âˆ’Xdâ€²
1 (Ï‰)
Â¯Â¯ +
Â¯Â¯Xdâ€²
1 (Ï‰) âˆ’Xd1 (Ï‰)
Â¯Â¯ + |Xd1 (Ï‰) âˆ’Xd (Ï‰)|
â‰¤
2 Ã— 2âˆ’Î³(m+1) + 2
m
X
j=n+1
2âˆ’Î³j = 2
m+1
X
j=n+1
2âˆ’Î³j
which proves the claim.
From this estimate, it follows that if d, dâ€² âˆˆD and |d âˆ’dâ€²| < T2âˆ’n where
n â‰¥N (Ï‰) , then d, dâ€² are both in some Dm where m > n and so
|Xdâ€² (Ï‰) âˆ’Xd (Ï‰)|
â‰¤
2
m
X
j=n+1
2âˆ’Î³j â‰¤2
âˆž
X
j=n+1
2âˆ’Î³j
=
2
1 âˆ’2âˆ’Î³
Â¡
2âˆ’Î³Â¢n+1 .
(31.28)
Now let d, dâ€² âˆˆD and suppose |d âˆ’dâ€²| < T2âˆ’N(Ï‰). Then let n â‰¥N (Ï‰) such that
T2âˆ’(n+1) â‰¤|d âˆ’dâ€²| < T2âˆ’n
Then from 31.28,
|Xdâ€² (Ï‰) âˆ’Xd (Ï‰)|
â‰¤
2
T Î³ (1 âˆ’2âˆ’Î³)
Â¡
T2âˆ’n+1Â¢Î³
â‰¤
2
T Î³ (1 âˆ’2âˆ’Î³) (|d âˆ’dâ€²|)Î³
which shows t â†’Xt (Ï‰) is Holder continuous on D.
By Lemma 31.39, one can deï¬ne Yt (Ï‰) to be the unique function which extends
d â†’Xd (Ï‰) oï¬€D for Ï‰ /âˆˆE and let Yt (Ï‰) = 0 if Ï‰ âˆˆE. Then Ï‰ â†’Yt (Ï‰) is
measurable because it is the pointwise limit of measurable functions. It remains to
verify the claim that Yt (Ï‰) = Xt (Ï‰) a.e.
X[|Ytâˆ’Xt|>Îµ] (Ï‰) â‰¤lim inf
dâ†’t X[|Xdâˆ’Xt|>Îµ] (Ï‰)
and so by Fatouâ€™s theorem
P ([|Yt âˆ’Xt| > Îµ])
=
Z
X[|Ytâˆ’Xt|>Îµ] (Ï‰) dP
â‰¤
Z
lim inf
dâ†’t X[|Xdâˆ’Xt|>Îµ] (Ï‰) dP
â‰¤
lim inf
dâ†’t
Z
X[|Xdâˆ’Xt|>Îµ] (Ï‰) dP
â‰¤
lim inf
dâ†’t
C
ÎµÎ± |d âˆ’t|1+Î² = 0.

890
RANDOM VARIABLES AND BASIC PROBABILITY
Therefore,
P ([|Yt âˆ’Xt| > 0])
=
P
Âµ
âˆªâˆž
k=1
Â·
|Yt âˆ’Xt| > 1
k
Â¸Â¶
â‰¤
âˆž
X
k=1
P
ÂµÂ·
|Yt âˆ’Xt| > 1
k
Â¸Â¶
= 0.
This proves the theorem.
Deï¬nition 31.41 Let Xt and Yt be random vectors for each t âˆˆ[0, âˆž). Then Yt
is said to be a version of Xt if there exists a set of measure zero, E such that for
Ï‰ /âˆˆE, Xt (Ï‰) = Yt (Ï‰) a.e. Ï‰ for all t âˆˆ[0, T).
In terms of this deï¬nition, the following corollary follows.
Corollary 31.42 Letting Bt be Brownian motion deï¬ned above, Bt has a Holder
continuous version.
Proof: This follows from Theorem 31.40 and 31.24.
An important observation related to this corollary is the product measurability
of Brownian motion.
Corollary 31.43 Let B be the Borel sets on [0, T] and let F be the Ïƒ algebra for
the underlying probability space. Then there exists a set of measure zero, N âˆˆF
such that (t, Ï‰) â†’XN (Ï‰) Bt (Ï‰) is B Ã— F measurable.
Proof: Let N be the set of measure zero oï¬€which t â†’Bt (Ï‰) is continuous.
Letting tm
k = 2âˆ’mTk consider for Ï‰ /âˆˆN
Bm
t (Ï‰) â‰¡
2m
X
k=1
Btm
k (Ï‰) X[tm
kâˆ’1,tm
k ) (t) .
Then this is a ï¬nite sum of B Ã— F measurable functions and so Bm is itself B Ã— F
measurable. Also, by continuity of t â†’Bt (Ï‰) , it follows that limmâ†’âˆžXN (Ï‰) Bm
t (Ï‰) =
XN (Ï‰) Bt (Ï‰) and this shows the result.
From now on, when Bt is referred to, it will mean XNBt so that (t, Ï‰) â†’Bt (Ï‰)
is product measurable and t â†’Bt (Ï‰) will also be continuous.
Summary of properties of Brownian motion
The above development has proved the following theorem on Brownian motion.
Theorem 31.44 There exists a probability space, (â„¦, F, P) and random vectors,
Bt for t âˆˆ[0, âˆž) which satisfy the following properties.
1. For Z = (Bt1, Â· Â· Â·, Btk) âˆˆRnk it follows Z is normally distributed. Its mean
is
Â¡
x
Â· Â· Â·
x
Â¢
âˆˆRnk

31.5.
BROWNIAN MOTION
891
2. Bt has independent increments. This means if t1 < t2 < Â· Â· Â· < tk, the random
variables,
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
are independent and normally distributed. Note this implies the kth compo-
nents must also be independent. Also Btj âˆ’Btjâˆ’1 is normal with covariance
(tj âˆ’tjâˆ’1) I and mean 0. In addition to this, the kth component of Bt is
normally distributed with density function
p (t, xk,y) â‰¡
1
(2Ï€t)1/2 exp
Ãƒ
âˆ’|y âˆ’xk|2
2t
!
This follows from the distribution of Bt which has a density function
p (t, x, y) â‰¡
1
(2Ï€t)n/2 exp
Ãƒ
âˆ’|y âˆ’x|2
2t
!
3. E
Â³
|Bt âˆ’Bs|4Â´
â‰¤3n2 (t âˆ’s)2 , For t > s,
E
Â³
|Bt âˆ’Bs|2Â´
=
n (t âˆ’s) , E
Â¡
(Bt âˆ’x)âˆ—(Bs âˆ’x)
Â¢
= ns
E (Bt âˆ’Bs)
=
0,
4. t â†’Bt (Ï‰) is Holder continuous and (t, Ï‰) â†’Bt (Ï‰) is B Ã— F measurable.

892
RANDOM VARIABLES AND BASIC PROBABILITY

Conditional Expectation And
Martingales
32.1
Conditional Expectation
Deï¬nition 32.1 Let (â„¦, M, P) be a probability space and let S âŠ†F be two Ïƒ
algebras contained in M. Let f be F measurable and in L1 (â„¦). Then E (f|S) ,
called the conditional expectation of f with respect to S is deï¬ned as follows:
E (f|S) is S measurable
For all E âˆˆS,
Z
E
E (f|S) dP =
Z
E
fdP
Lemma 32.2 The above is well deï¬ned. Also, if S âŠ†F then
E (X|S) = E (E (X|F) |S) .
(32.1)
If Z is bounded and measurable in F then
ZE (X|F) = E (ZX|F) .
(32.2)
Proof: Let a ï¬nite measure on S, Âµ be given by
Âµ (E) â‰¡
Z
E
fdP.
Then Âµ â‰ªP and so by the Radon Nikodym theorem, there exists a unique S
measurable function, E (f|S) such that
Z
E
fdP â‰¡Âµ (E) =
Z
E
E (f|S) dP
for all E âˆˆS.
893

894
CONDITIONAL EXPECTATION AND MARTINGALES
Let F âˆˆS. Then
Z
F
E (E (X|F) |S) dP
â‰¡
Z
F
E (X|F) dP
â‰¡
Z
F
XdP â‰¡
Z
F
E (X|S) dP
and so, by uniqueness, E (E (X|F) |S) = E (X|S). This shows 32.1.
To establish 32.2, note that if Z = XF where F âˆˆF,
Z
XF E (X|F) dP =
Z
XF XdP =
Z
E (XF X|F) dP
which shows 32.2 in the case where Z is the characteristic function of a set in F.
It follows this also holds for simple functions. Let {sn} be a sequence of simple
functions which converges uniformly to Z and let F âˆˆF. Then by what was just
shown,
Z
F
snE (X|F) dP =
Z
F
snXdP.
Then passing to the limit using the dominated convergence theorem, yields
Z
F
ZE (X|F) dP =
Z
F
ZXdP â‰¡
Z
F
E (ZX|F) dP.
Since this holds for every F âˆˆF, this shows 32.2.
The next major result is a generalization of Jensenâ€™s inequality whose proof
depends on the following lemma about convex functions.
Lemma 32.3 Let I be an open interval on R and let Ï† be a convex function deï¬ned
on I. Then there exists a sequence {(an, bn)} such that
Ï† (x) = sup {anx + bn, n = 1, Â· Â· Â·} .
Proof: Let x âˆˆI and let t > x. Then by convexity of Ï†,
Ï† (x + Î» (t âˆ’x)) âˆ’Ï† (x)
Î» (t âˆ’x)
â‰¤Ï† (x) (1 âˆ’Î») + Î»Ï† (t) âˆ’Ï† (x)
Î» (t âˆ’x)
= Ï† (t) âˆ’Ï† (x)
t âˆ’x
.
Therefore t â†’Ï†(t)âˆ’Ï†(x)
tâˆ’x
is increasing if t > x. If t < x
Ï† (x + Î» (t âˆ’x)) âˆ’Ï† (x)
Î» (t âˆ’x)
â‰¥Ï† (x) (1 âˆ’Î») + Î»Ï† (t) âˆ’Ï† (x)
Î» (t âˆ’x)
= Ï† (t) âˆ’Ï† (x)
t âˆ’x

32.1.
CONDITIONAL EXPECTATION
895
and so t â†’Ï†(t)âˆ’Ï†(x)
tâˆ’x
is increasing for t Ì¸= x. Let
ax â‰¡inf
Â½Ï† (t) âˆ’Ï† (x)
t âˆ’x
: t > x
Â¾
.
Then if t1 < x, and t > x,
Ï† (t1) âˆ’Ï† (x)
t1 âˆ’x
â‰¤ax â‰¤Ï† (t) âˆ’Ï† (x)
t âˆ’x
.
Thus for all t âˆˆI,
Ï† (t) â‰¥ax (t âˆ’x) + Ï† (x).
(32.3)
Pick t2 > x. Then for all t âˆˆ(x, t2)
ax â‰¤Ï† (t) âˆ’Ï† (x)
t âˆ’x
â‰¤Ï† (t2) âˆ’Ï† (x)
t2 âˆ’x
and so
ax (t âˆ’x) + Ï† (x) â‰¤Ï† (t) â‰¤
ÂµÏ† (t2) âˆ’Ï† (x)
t2 âˆ’x
Â¶
(t âˆ’x) + Ï† (x).
(32.4)
Pick t3 < x. Then for t3 < t < x
ax â‰¥Ï† (t) âˆ’Ï† (x)
t âˆ’x
â‰¥Ï† (t3) âˆ’Ï† (x)
t3 âˆ’x
and so
ax (t âˆ’x) + Ï† (x) â‰¤Ï† (t) â‰¤
ÂµÏ† (t3) âˆ’Ï† (x)
t3 âˆ’x
Â¶
(t âˆ’x) + Ï† (x).
(32.5)
32.4 and 32.5 imply Ï† is continuous. Let
Ïˆ (x) â‰¡sup {ar (x âˆ’r) + Ï† (r) : r âˆˆQ âˆ©I}.
Then Ïˆ is convex on I so Ïˆ is continuous. Also Ïˆ (r) â‰¥Ï† (r) so by 32.3,
Ïˆ (x) â‰¥Ï† (x) â‰¥sup {ar (x âˆ’r) + Ï† (r)} â‰¡Ïˆ (x).
Thus Ïˆ (x) = Ï† (x) and letting Q âˆ©I = {rn}, an = arn and bn = arnrn + Ï† (rn).
This proves the lemma.
Lemma 32.4 If X â‰¤Y, then E (X|S) â‰¤E (Y |S) a.e. Also
X â†’E (X|S)
is linear.

896
CONDITIONAL EXPECTATION AND MARTINGALES
Proof: Let A âˆˆS.
Z
A
E (X|S) dP â‰¡
Z
A
XdP
â‰¤
Z
A
Y dP â‰¡
Z
A
E (Y |S) dP.
Hence E (X|S) â‰¤E (Y |S) a.e. as claimed. It is obvious X â†’E (X|S) is linear.
Theorem 32.5 (Jensenâ€™s inequality)Let X (Ï‰) âˆˆI and let Ï† : I â†’R be convex.
Suppose
E (|X|) , E (|Ï† (X)|) < âˆž.
Then
Ï† (E (X|S)) â‰¤E (Ï† (X) |S).
Proof: Let Ï† (x) = sup {anx + bn}. Letting A âˆˆS,
1
P (A)
Z
A
E (X|S) dP =
1
P (A)
Z
A
XdP âˆˆI a.e.
whenever P (A) Ì¸= 0. Hence E (X|S) (Ï‰) âˆˆI a.e. and so it makes sense to consider
Ï† (E (X|S)). Now
anE (X|S) + bn = E (anX + bn|S) â‰¤E (Ï† (X) |S).
Thus
sup {anE (X|S) + bn}
= Ï† (E (X|S)) â‰¤E (Ï† (X) |S) a.e.
which proves the theorem.
32.2
Discrete Martingales
Deï¬nition 32.6 Let Sk be an increasing sequence of Ïƒ algebras which are subsets
of S and Xk be a sequence of real-valued random variables with E (|Xk|) < âˆžsuch
that Xk is Sk measurable. Then this sequence is called a martingale if
E (Xk+1|Sk) = Xk,
a submartingale if
E (Xk+1|Sk) â‰¥Xk,
and a supermartingale if
E (Xk+1|Sk) â‰¤Xk.
An upcrossing occurs when a sequence goes from a up to b. Thus it crosses the
interval, [a, b] in the up direction, hence upcrossing. More precisely,

32.2.
DISCRETE MARTINGALES
897
Deï¬nition 32.7 Let {xi}I
i=1 be any sequence of real numbers, I â‰¤âˆž.
Deï¬ne
an increasing sequence of integers {mk} as follows.
m1 is the ï¬rst integer â‰¥1
such that xm1 â‰¤a, m2 is the ï¬rst integer larger than m1 such that xm2 â‰¥b, m3
is the ï¬rst integer larger than m2 such that xm3 â‰¤a, etc. Then each sequence,
Â©
xm2kâˆ’1, Â· Â· Â·, xm2k
Âª
, is called an upcrossing of [a, b].
Proposition 32.8 Let {Xi}n
i=1 be a ï¬nite sequence of real random variables deï¬ned
on â„¦where (â„¦, S, P) is a probability space. Let U[a,b] (Ï‰) denote the number of
upcrossings of Xi (Ï‰) of the interval [a, b]. Then U[a,b] is a random variable.
Proof: Let X0 (Ï‰) â‰¡a+1, let Y0 (Ï‰) â‰¡0, and let Yk (Ï‰) remain 0 for k = 0, Â·Â·Â·, l
until Xl (Ï‰) â‰¤a. When this happens (if ever), Yl+1 (Ï‰) â‰¡1. Then let Yi (Ï‰) remain
1 for i = l + 1, Â· Â· Â·, r until Xr (Ï‰) â‰¥b when Yr+1 (Ï‰) â‰¡0. Let Yk (Ï‰) remain 0 for
k â‰¥r + 1 until Xk (Ï‰) â‰¤a when Yk (Ï‰) â‰¡1 and continue in this way. Thus the
upcrossings of Xi (Ï‰) are identiï¬ed as unbroken strings of ones for Yk with a zero
at each end, with the possible exception of the last string of ones which may be
missing the zero at the upper end and may or may not be an upcrossing.
Note also that Y0 is measurable because it is identically equal to 0 and that if
Yk is measurable, then Yk+1 is measurable because the only change in going from
k to k + 1 is a change from 0 to 1 or from 1 to 0 on a measurable set determined
by Xk. Now let
Zk (Ï‰) =
Â½
1 if Yk (Ï‰) = 1 and Yk+1 (Ï‰) = 0,
0 otherwise,
if k < n and
Zn (Ï‰) =
Â½
1 if Yn (Ï‰) = 1 and Xn (Ï‰) â‰¥b,
0 otherwise.
Thus Zk (Ï‰) = 1 exactly when an upcrossing has been completed and each Zi is a
random variable.
U[a,b] (Ï‰) =
n
X
k=1
Zk (Ï‰)
so U[a,b] is a random variable as claimed.
The following corollary collects some key observations found in the above con-
struction.
Corollary 32.9 U[a,b] (Ï‰) â‰¤the number of unbroken strings of ones in the se-
quence, {Yk (Ï‰)} there being at most one unbroken string of ones which produces no
upcrossing. Also
Yi (Ï‰) = Ïˆi
Â³
{Xj (Ï‰)}iâˆ’1
j=1
Â´
,
(32.6)
where Ïˆi is some function of the past values of Xj (Ï‰).
Lemma 32.10 Let Ï† be a convex and increasing function and suppose
{(Xn, Sn)}

898
CONDITIONAL EXPECTATION AND MARTINGALES
is a submartingale. Then if E (|Ï† (Xn)|) < âˆž, it follows
{(Ï† (Xn) , Sn)}
is also a submartingale.
Proof: It is given that E (Xn+1, Sn) â‰¥Xn and so
Ï† (Xn) â‰¤Ï† (E (Xn+1, Sn)) â‰¤E (Ï† (Xn+1) |Sn)
by Jensenâ€™s inequality.
The following is called the upcrossing lemma.
Lemma 32.11 (upcrossing lemma) Let {(Xi, Si)}n
i=1 be a submartingale and let
U[a,b] (Ï‰) be the number of upcrossings of [a, b]. Then
E
Â¡
U[a,b]
Â¢
â‰¤E (|Xn|) + |a|
b âˆ’a
.
Proof: Let Ï† (x) â‰¡a + (x âˆ’a)+ so that Ï† is an increasing convex function
always at least as large as a. By Lemma 32.10 it follows that {(Ï† (Xk) , Sk)} is also
a submartingale.
Ï† (Xk+r) âˆ’Ï† (Xk) =
k+r
X
i=k+1
Ï† (Xi) âˆ’Ï† (Xiâˆ’1)
=
k+r
X
i=k+1
(Ï† (Xi) âˆ’Ï† (Xiâˆ’1)) Yi +
k+r
X
i=k+1
(Ï† (Xi) âˆ’Ï† (Xiâˆ’1)) (1 âˆ’Yi).
Observe that Yi is Siâˆ’1 measurable from its construction in Proposition 32.8, Yi
depending only on Xj for j < i. Therefore, letting
Ai â‰¡{Ï‰ : Yi (Ï‰) = 0},
E
Ãƒ k+r
X
i=k+1
(Ï† (Xi) âˆ’Ï† (Xiâˆ’1)) (1 âˆ’Yi)
!
=
k+r
X
i=k+1
Z
â„¦
(Ï† (Xi) âˆ’Ï† (Xiâˆ’1)) (1 âˆ’Yi) dP
=
k+r
X
i=k+1
Z
Ai
(Ï† (Xi) âˆ’Ï† (Xiâˆ’1)) dP

32.2.
DISCRETE MARTINGALES
899
because if Yi = 1, (Ï† (Xi) âˆ’Ï† (Xiâˆ’1)) (1 âˆ’Yi) = 0. Continuing this chain of formu-
las, and using the fact that Ai is Siâˆ’1 measurable, it follows from the deï¬nition of
conditional expectation and the deï¬nition of a submartingale,
=
k+r
X
i=k+1
Z
Ai
E (Ï† (Xi) , Siâˆ’1) dP âˆ’
Z
Ai
Ï† (Xiâˆ’1) dP
â‰¥
k+r
X
i=k+1
Z
Ai
Ï† (Xiâˆ’1) dP âˆ’
Z
Ai
Ï† (Xiâˆ’1) dP = 0.
(32.7)
Now let the unbroken strings of ones for {Yi (Ï‰)} be
{k1, Â· Â· Â·, k1 + r1} , {k2, Â· Â· Â·, k2 + r2} , Â· Â· Â·, {km, Â· Â· Â·, km + rm}
(32.8)
where m = V (Ï‰) â‰¡the number of unbroken strings of ones in the sequence {Yi (Ï‰)}.
By Corollary 32.9 V (Ï‰) â‰¥U[a,b] (Ï‰).
Ï† (Xn (Ï‰)) âˆ’Ï† (X1 (Ï‰))
=
n
X
k=1
(Ï† (Xk (Ï‰)) âˆ’Ï† (Xkâˆ’1 (Ï‰))) Yk (Ï‰)
+
n
X
k=1
(Ï† (Xk (Ï‰)) âˆ’Ï† (Xkâˆ’1 (Ï‰))) (1 âˆ’Yk (Ï‰)).
The ï¬rst sum in the above reduces to summing over the unbroken strings of ones
because the terms in which Yi (Ï‰) = 0 contribute nothing. implies
Ï† (Xn (Ï‰)) âˆ’Ï† (X1 (Ï‰))
â‰¥U[a,b] (Ï‰) (b âˆ’a) + 0+
n
X
k=1
(Ï† (Xk (Ï‰)) âˆ’Ï† (Xkâˆ’1 (Ï‰))) (1 âˆ’Yk (Ï‰))
(32.9)
where the zero on the right side results from a string of ones which does not
produce an upcrossing.
It is here that it is important that Ï† (x) â‰¥a.
Such
a string begins with Ï† (Xk (Ï‰)) = a and results in an expression of the form
Ï† (Xk+m (Ï‰)) âˆ’Ï† (Xk (Ï‰)) â‰¥0 since Ï† (Xk+m (Ï‰)) â‰¥a. If Xk had not been re-
placed with Ï† (Xk) , it would have been possible for Ï† (Xk+m (Ï‰)) to be less than a
and the zero in the above could have been a negative number This would have been
inconvenient.
Next take the expected value of both sides in 32.9. Using 32.7, this results in
E (Ï† (Xn) âˆ’Ï† (X1))
â‰¥
(b âˆ’a) E
Â¡
U[a,b]
Â¢
+E
Ãƒ n
X
k=1
(Ï† (Xk) âˆ’Ï† (Xkâˆ’1)) (1 âˆ’Yk)
!
â‰¥
(b âˆ’a) E
Â¡
U[a,b]
Â¢

900
CONDITIONAL EXPECTATION AND MARTINGALES
and this proves the lemma.
The reason for this lemma is to prove the amazing submartingale convergence
theorem.
Theorem 32.12 (submartingale convergence theorem) Let
{(Xi, Si)}âˆž
i=1
be a submartingale with K â‰¡sup E (|Xn|) < âˆž.
Then there exists a random
variable, X, such that E (|X|) â‰¤K and
lim
nâ†’âˆžXn (Ï‰) = X (Ï‰) a.e.
Proof: Let a, b âˆˆQ and let a < b. Let U n
[a,b] (Ï‰) be the number of upcrossings
of {Xi (Ï‰)}n
i=1. Then let
U[a,b] (Ï‰) â‰¡lim
nâ†’âˆžU n
[a,b] (Ï‰) = number of upcrossings of {Xi} .
By the upcrossing lemma,
E
Â³
U n
[a,b]
Â´
â‰¤E (|Xn|) + |a|
b âˆ’a
â‰¤K + |a|
b âˆ’a
and so by the monotone convergence theorem,
E
Â¡
U[a,b]
Â¢
â‰¤K + |a|
b âˆ’a
< âˆž
which shows U[a,b] (Ï‰) is ï¬nite a.e., for all Ï‰ /âˆˆS[a,b] where P
Â¡
S[a,b]
Â¢
= 0. Deï¬ne
S â‰¡âˆª
Â©
S[a,b] : a, b âˆˆQ, a < b
Âª
.
Then P (S) = 0 and if Ï‰ /âˆˆS, {Xk}âˆž
k=1 has only ï¬nitely many upcrossings of every
interval having rational endpoints. Thus, for Ï‰ /âˆˆS,
lim sup
kâ†’âˆž
Xk (Ï‰)
=
lim inf
kâ†’âˆžXk (Ï‰)
=
lim
kâ†’âˆžXk (Ï‰) â‰¡Xâˆž(Ï‰) .
Letting Xâˆž(Ï‰) = 0 for Ï‰ âˆˆS, Fatouâ€™s lemma implies
Z
â„¦
|Xâˆž| dP =
Z
â„¦
lim inf
nâ†’âˆž|Xn| dP â‰¤lim inf
nâ†’âˆž
Z
â„¦
|Xn| dP â‰¤K
and so this proves the theorem.
Another very interesting result about submartingales is the Doob submartingale
estimate.

32.2.
DISCRETE MARTINGALES
901
Theorem 32.13 Let {(Xi, Si)}âˆž
i=1 be a submartingale. Then
P
Âµ
max
1â‰¤kâ‰¤n Xk â‰¥Î»
Â¶
â‰¤1
Î»
Z
â„¦
X+
n dP
Proof: Let
A1
â‰¡
[X1 â‰¥Î»] , A2 â‰¡[X2 â‰¥Î»] \ A1,
Â· Â· Â·, Ak
â‰¡
[Xk â‰¥Î»] \
Â¡
âˆªkâˆ’1
i=1 Ai
Â¢
Â· Â·Â·
Thus each Ak is Sk measurable, the Ak are disjoint, and their union equals [max1â‰¤kâ‰¤n Xk â‰¥Î»] .
Therefore from the deï¬nition of a submartingale and Jensenâ€™s inequality,
P
Âµ
max
1â‰¤kâ‰¤n Xk â‰¥Î»
Â¶
=
n
X
k=1
P (Ak) â‰¤1
Î»
n
X
k=1
Z
Ak
XkdP
â‰¤
1
Î»
n
X
k=1
Z
Ak
E (Xn|Sk) dP
â‰¤
1
Î»
n
X
k=1
Z
Ak
E (Xn|Sk)+ dP
â‰¤
1
Î»
n
X
k=1
Z
Ak
E
Â¡
X+
n |Sk
Â¢
dP
=
1
Î»
n
X
k=1
Z
Ak
X+
n dP = 1
Î»
Z
â„¦
X+
n dP.
This proves the theorem.

902
CONDITIONAL EXPECTATION AND MARTINGALES

Filtrations And Martingales
Deï¬nition 33.1 Let (â„¦, F, P) be a probability space. A ï¬ltration is an increasing
collection of Ïƒ algebras contained in F, one for each t âˆˆR, {Ft}tâˆˆR . Let f :
[0, âˆž)Ã—â„¦â†’R be B Ã— F measurable where B is the Ïƒ algebra of Borel sets. Then f
is said to be Ft adapted if for each t, f (t, Â·) is Ft measurable. A function is called
an adapted step function if it is of the form
f (t, Ï‰) =
âˆž
X
j=0
ej (Ï‰) X[tj,tj+1) (t)
where ej is Ftj measurable and âˆªâˆž
j=0[tj, tj+1) = R. Of course you can replace [0, âˆž)
in the above with [0, T] and this is the case of most interest. Another convention
followed will be to assume that (â„¦, Ft, P) is a complete measure space. Thus all sets
of measure zero from F are in Ft. If it is not complete, you simply replace it with
its completion. This goes for F as well.
The act of replacing the measure spaces with their completions is completely
harmless. The only important idea which needs consideration is that of indepen-
dence. Suppose the Ïƒ algebras, G and H are independent and you then consider
their completions. Will the new Ïƒ algebras also be independent?
Lemma 33.2 Suppose the Ïƒ algebras, G and H are independent and let Gâ€² and Hâ€²
be the Ïƒ algebras of the completions. Then Gâ€² and Hâ€² are also independent.
Proof: Let E âˆˆGâ€² and F âˆˆHâ€². Then there exists A âŠ‡E, B âŠ‡F such that
A âˆˆG and B âˆˆH and P (A) = P (E) , P (F) = P (B) . It follows that
P (E âˆ©F) = P (A âˆ©B) = P (A) P (B) = P (E) P (F) .
This proves the lemma.
This rather simple lemma shows there is no diï¬ƒculty in assuming that any
ï¬ltration contains the sets of measure zero. Next is an important lemma about
approximation with simple adapted functions. It is based on the proof outlined in
[33] which they say is from [38].
903

904
FILTRATIONS AND MARTINGALES
Lemma 33.3 Let Ft be a ï¬ltration as described above and suppose f is adapted,
B Ã— F measurable, and uniformly bounded. Then there exists a sequence of uni-
formly bounded adapted step functions, fn such that
lim
nâ†’âˆžP
ÃƒZ T
0
(f (t, Ï‰) âˆ’fn (t, Ï‰))2 dt > Îµ
!
= 0.
(33.1)
Also in this case, there is a subsequence, fnk
lim
kâ†’âˆž
Z
â„¦
Z T
0
(f (t, Ï‰) âˆ’fnk (t, Ï‰))2 dtdP = 0.
Proof: Extend f to equal 0 for t /âˆˆ[0, T] . Let tj = j2âˆ’n and let Ï†n (t) denote
the step function which equals j2âˆ’n on the interval [j2âˆ’n, (j + 1) 2âˆ’n). It follows
easily that if s â‰¥0, then Ï†n (t âˆ’s) + s âˆˆ[t âˆ’2âˆ’n, t). Now let
fh (t) â‰¡f âˆ—Ïˆh (t)
where Ïˆh (t) equals 1/h on [0, h] and zero elsewhere. Thus
fh (t) =
Z
f (t âˆ’s) Ïˆh (s) ds = 1
h
Z t
tâˆ’h
f (s) ds.
From now on, Ï‰ /âˆˆE where E is the exceptional set of measure zero on which
R âˆž
âˆ’âˆžf (t, Ï‰)2 dt = âˆž. Consider
Z T
0
Z 1
0
|f (Ï†n (t âˆ’s) + s, Ï‰) âˆ’f (t, Ï‰)|2 dsdt.
Z T
0
Z 1
0
|f (Ï†n (t âˆ’s) + s, Ï‰) âˆ’f (t, Ï‰)|2 dsdt â‰¤
3
ÃƒZ T
0
Z 1
0
|f (Ï†n (t âˆ’s) + s, Ï‰) âˆ’fh (Ï†n (t âˆ’s) + s, Ï‰)|2 dsdt
(33.2)
+
Z T
0
Z 1
0
|fh (Ï†n (t âˆ’s) + s, Ï‰) âˆ’fh (t, Ï‰)|2 dsdt
(33.3)
+
Z T
0
Z 1
0
|fh (t, Ï‰) âˆ’f (t, Ï‰)|2 dsdt
!
(33.4)
Consider the term in 33.2. There are disjoint intervals such that Ï†n (t âˆ’s) is con-
stant on these intervals. Therefore, the inside integral of this term must be of the
form
mn
X
k=1
Z
Ik
|f (ck + s, Ï‰) âˆ’fh (ck + s, Ï‰)|2 ds

905
where the intervals, Ik are disjoint, ck is of the form j2âˆ’n, and the union of these
intervals equals [0, 1]. Therefore, there are other disjoint intervals, Jk such that this
term equals
mn
X
k=1
Z
Jk
|f (s, Ï‰) âˆ’fh (s, Ï‰)|2 ds â‰¤
Z
R
|f (s, Ï‰) âˆ’fh (s, Ï‰)|2 ds
and this last converges to 0 by standard considerations as h â†’0. Of course the
necessary smallness of h will depend on Ï‰. To see this is so, use Jensenâ€™s inequality
to obtain the term of 33.2 is dominated by
Z T
0
Z
R
|f (s, Ï‰) âˆ’fh (s, Ï‰)|2 dsdt
=
T
Z
R
Â¯Â¯Â¯Â¯
Z
R
(f (s, Ï‰) âˆ’f (s âˆ’r, Ï‰)) Ïˆh (r) dr
Â¯Â¯Â¯Â¯
2
ds
â‰¤
T
Z
R
Z
R
|f (s, Ï‰) âˆ’f (s âˆ’r, Ï‰)|2 Ïˆh (r) drds
â‰¤
T
Z h
0
Ïˆh (r)
Z
R
|f (s, Ï‰) âˆ’f (s âˆ’r, Ï‰)|2 dsdr
â‰¤
T
Z h
0
Ïˆh (r) Îµdr
by continuity of translation in L2 provided h is small enough.
Therefore, this
converges to 0 as h â†’0.
Next consider the term of 33.4
Z T
0
Z 1
0
|fh (t, Ï‰) âˆ’f (t, Ï‰)|2 dsdt
=
Z 1
0
Z T
0
|fh (t, Ï‰) âˆ’f (t, Ï‰)|2 dtds
=
Z T
0
|fh (t, Ï‰) âˆ’f (t, Ï‰)|2 dt
=
Z T
0
Â¯Â¯Â¯Â¯
Z
(f (t âˆ’s, Ï‰) âˆ’f (t, Ï‰)) Ïˆh (s) ds
Â¯Â¯Â¯Â¯
2
dt
â‰¤
Z T
0
Z
(f (t âˆ’s, Ï‰) âˆ’f (t, Ï‰))2 Ïˆh (s) dsdt
â‰¤
Z h
0
Ïˆh (s)
Z
(f (t âˆ’s, Ï‰) âˆ’f (t, Ï‰))2 dtds
â‰¤
Z h
0
Ïˆh (s) Îµds = Îµ
whenever h is small enough due to continuity of translation in L2. Thus the terms
in 33.2 and 33.4 both converge to 0 as h â†’0.

906
FILTRATIONS AND MARTINGALES
Therefore, there exists small positive h such that
Z T
0
Z 1
0
|f (Ï†n (t âˆ’s) + s, Ï‰) âˆ’f (t, Ï‰)|2 dsdt
â‰¤
Îµ
2 + 3
Z T
0
Z 1
0
|fh (Ï†n (t âˆ’s) + s, Ï‰) âˆ’fh (t, Ï‰)|2 dsdt
Letting M be the uniform bound on f, and using the fact that |Ï†n (t âˆ’s) + s âˆ’t| <
2âˆ’n, it follows the above expression is dominated by
Îµ
2 + M
h 2âˆ’n < Îµ
provided n is chosen large enough. Therefore, this has shown
lim
nâ†’âˆž
Z T
0
Z 1
0
|f (Ï†n (t âˆ’s) + s, Ï‰) âˆ’f (t, Ï‰)|2 dsdt
=
lim
nâ†’âˆž
Z 1
0
Z T
0
|f (Ï†n (t âˆ’s) + s, Ï‰) âˆ’f (t, Ï‰)|2 dtds = 0.
Therefore, if Îµ > 0 is given, the above expression is less than Îµ provided n is large
enough, depending on Ï‰. However, this requires that for some sn âˆˆ[0, 1]
Z T
0
|f (Ï†n (t âˆ’sn) + sn, Ï‰) âˆ’f (t, Ï‰)|2 dt < Îµ.
I have now shown that for every Ï‰ /âˆˆE, the above expression holds for all n
suï¬ƒciently large. Therefore,
lim
nâ†’âˆžP
ÃƒZ T
0
|f (Ï†n (t âˆ’sn) + sn, Ï‰) âˆ’f (t, Ï‰)|2 dt â‰¥Îµ
!
= 0.
Let fn (t, Ï‰) = f (Ï†n (t âˆ’sn) + sn, Ï‰) . Then fn is clearly a bounded adapted step
function.
It only remains to verify the last claim. From 33.1 there exists a subsequence,
nk such that
P
ÃƒZ T
0
(fnk (t, Ï‰) âˆ’f (t, Ï‰))2 dt â‰¥2âˆ’k
!
â‰¤2âˆ’k
Then letting Ak =
h
Ï‰ :
R T
0 (fnk (t, Ï‰) âˆ’f (t, Ï‰))2 dt â‰¥2âˆ’ki
it follows from the Borel
Cantelli lemma that a.e. Ï‰ is in only ï¬nitely many of these Ak. Therefore, for each
Ï‰ oï¬€a set of measure zero E,
Z T
0
(fnk (t, Ï‰) âˆ’f (t, Ï‰))2 dt < 2âˆ’k

907
for all k large enough.
From the deï¬nition of these fnk given above, they are
uniformly bounded. Therefore, by the dominated convergence theorem,
lim
kâ†’âˆž
Z
â„¦
Z T
0
(fnk (t, Ï‰) âˆ’f (t, Ï‰))2 dtdP = 0.
This proves the theorem.
The following corollary is what is really desired. It removes the assumption that
f is uniformly bounded.
Corollary 33.4 Let Ft be a ï¬ltration as described above and suppose f is adapted
and B Ã— F measurable such that for a.e. Ï‰,
Z T
0
f (t, Ï‰)2 dt < âˆž.
(33.5)
Then there exists a sequence of uniformly bounded adapted step functions, Ï†n such
that
lim
nâ†’âˆžP
ÃƒZ T
0
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt > Îµ
!
= 0.
(33.6)
Thus
Ï†n (t, Ï‰) =
mnâˆ’1
X
j=0
en
j (Ï‰) X[tn
j ,tn
j+1) (t)
where tn
0 = 0 and en
j is Ftn
j measurable. Furthermore, if f is in L2 ([0, T] Ã— â„¦) ,
there exists a subsequence
Â©
Ï†nk
Âª
such that
lim
kâ†’âˆž
Z
â„¦
Z T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dtdP = 0
Proof: Let fM be given by the following for M âˆˆN
fM (t, Ï‰) =
ï£±
ï£²
ï£³
M if f (t, Ï‰) > M
f (t, Ï‰) if f (t, Ï‰) âˆˆ[âˆ’M, M]
âˆ’M if f (t, Ï‰) < âˆ’M
Then fM satisï¬es all the conditions of Lemma 33.3. Letting Îµ > 0 be given, it
follows there exists Ï†M a uniformly bounded adapted step function such that
P
ÃƒZ T
0
(fM (t, Ï‰) âˆ’Ï†M (t, Ï‰))2 dt > Î´
4
!
< Îµ.
Also for large enough M,
P
ÃƒZ T
0
(f (t, Ï‰) âˆ’fM (t, Ï‰))2 dt > Î´
4
!
< Îµ
(33.7)

908
FILTRATIONS AND MARTINGALES
This is because for E the set of measure zero such that 33.5 does not hold,
â„¦\ E = âˆªâˆž
M=1
"
Ï‰ :
Z T
0
(f (t, Ï‰) âˆ’fM (t, Ï‰))2 dt â‰¤Î´
2
#
Therefore, picking M large enough that 33.7 holds,
P
ÃƒZ T
0
(f (t, Ï‰) âˆ’Ï†M (t, Ï‰))2 dt > Î´
!
â‰¤
P
ÃƒZ T
0
2 (f (t, Ï‰) âˆ’fM (t, Ï‰))2 dt > Î´
2
!
+P
ÃƒZ T
0
2 (fM (t, Ï‰) âˆ’Ï†M (t, Ï‰))2 dt > Î´
2
!
<
Îµ + Îµ = 2Îµ.
Since Îµ is arbitrary, this proves the ï¬rst part of the corollary.
Next suppose f âˆˆL2 ([0, T] Ã— â„¦) . By 33.7 there exists a subsequence, {fMk}
such that
P
ÃƒZ T
0
(f (t, Ï‰) âˆ’fMk (t, Ï‰))2 dt > 2âˆ’k
!
< 2âˆ’k
and so by the Borel Canelli lemma there exists a set of measure zero E such that
for Ï‰ /âˆˆE and all k large enough,
Z T
0
(f (t, Ï‰) âˆ’fMk (t, Ï‰))2 dt â‰¤2âˆ’k.
Now by construction, |fMk| â‰¤|f| and so the dominated convergence theorem implies
lim
kâ†’âˆž
ÃƒZ
â„¦
Z T
0
(f (t, Ï‰) âˆ’fMk (t, Ï‰))2 dtdP
!1/2
= 0.
Therefore, there exists a subsequence, {Mk} such that
ÃƒZ
â„¦
Z T
0
(f (t, Ï‰) âˆ’fMk (t, Ï‰))2 dtdP
!1/2
< 2âˆ’(Â¯k+1).
Then by Lemma 33.3 there exists an adapted bounded step function, Ï†Mk such that
ÃƒZ
â„¦
Z T
0
Â¡
fMk (t, Ï‰) âˆ’Ï†Mk (t, Ï‰)
Â¢2 dtdP
!1/2
< 2âˆ’(Â¯k+1).
It follows
ÃƒZ
â„¦
Z T
0
Â¡
f (t, Ï‰) âˆ’Ï†Mk (t, Ï‰)
Â¢2 dtdP
!1/2
< 2âˆ’k.

909
This proves the corollary.
The following corollary states things a little diï¬€erently.
Corollary 33.5 Let Ft be a ï¬ltration as described above and suppose f is adapted
and B Ã— F measurable such that for a.e. Ï‰,
Z T
0
f (t, Ï‰)2 dt < âˆž.
Then there exists a sequence of uniformly bounded adapted step functions, Ï†n such
that
lim
nâ†’âˆžP
ÃƒZ T
0
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt â‰¤2âˆ’n
!
= 1.
Proof: By Corollary 33.4, there exists a sequence of bounded adapted step
functions, {Ï†n} such that
lim
nâ†’âˆžP
ÃƒZ T
0
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt > Îµ
!
= 0.
Therefore, selecting a sequence of Îµ as Îµ = 2âˆ’k, there exists a subsequence, Ï†nk
such that
P
ÃƒZ T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dt > 2âˆ’k
!
< 2âˆ’k.
From the Borel Cantelli lemma Ï‰ which is in inï¬nitely many of the sets
"
Ï‰ :
Z T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dt > 2âˆ’k
#
has measure zero. Therefore, for Ï‰ not in this set,
Z T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dt â‰¤2âˆ’k
for all k suï¬ƒciently large and so
lim
kâ†’âˆžP
ÃƒZ T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dt â‰¤2âˆ’k
!
= 1.
This proves the corollary.
Note that virtually no change in the argument would yield the above results
with the exponent p â‰¥1 replacing 2. I will use this fact whenever convenient.
Deï¬nition 33.6 Let {Bt} be one dimensional Brownian motion as described in
Theorem 31.44. Let Ft be the smallest Ïƒ algebra which is complete and contains all
sets of the form
(Bt1, Â· Â· Â·, Btk)âˆ’1 (F1 Ã— Â· Â· Â· Ã— Fk)

910
FILTRATIONS AND MARTINGALES
for all ï¬nite increasing sequences t1, Â· Â· Â·, tk such that 0 â‰¤t1 < t2 Â· Â·Â· < tk â‰¤t and Fj
Borel. Thus Ft is a ï¬ltration. Another way to say it is that Ft is the smallest Ïƒ al-
gebra contained in F which is complete and such that for every increasing sequence,
t1, Â· Â· Â·, tk such that 0 â‰¤t1 < t2 Â· Â·Â· < tk â‰¤t, it follows that (Bt1, Â· Â· Â·, Btk) : â„¦â†’Rn
is measurable with respect to Ft.
Recall Bt has independent increments. This is why the following lemma is so
signiï¬cant.
Lemma 33.7 Ft also equals the smallest Ïƒ algebra which is complete and contains
all sets of the form
Â¡
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
Â¢âˆ’1 (F1 Ã— Â· Â· Â· Ã— Fk) .
In other words, one can consider instead the independent increments when deï¬ning
Ft.
Proof: Fâ€²
t is the smallest Ïƒ algebra such that (Bt1, Â· Â· Â·, Btk) is measurable for
every increasing sequence, t1, Â·Â·Â·, tk such that 0 â‰¤t1 < t2Â·Â·Â· < tk â‰¤t. The 0 function
is clearly measurable because 0âˆ’1 (E) = â„¦if 0 âˆˆE and if 0 /âˆˆE, 0âˆ’1 (E) = âˆ….
Therefore, for every increasing sequence, as just described,
Â¡
0, âˆ’Bt1, Â· Â· Â·, âˆ’Btkâˆ’1
Â¢
is Ft measurable. Therefore,
Â¡
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
Â¢
is Fâ€²
t measurable.
Now suppose for all such increasing sequences,
Â¡
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
Â¢
is
Fâ€²
t measurable. Then in particular,
(0, Â· Â· Â·0, Bti, 0 Â· Â·Â·, 0)
must be Fâ€²
t measurable because Bti is. Therefore, adding in k of these, it follows
(Bt1, Â· Â· Â·, Btk) is Fâ€²
t measurable. In other words, a Ïƒ algebra is measurable for all
(Bt1, Bt2, Â· Â· Â·, Btk)
if and only if it is measurable for all sequences,
Â¡
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
Â¢
Taking the completion, this proves the lemma.
33.1
Continuous Martingales
Deï¬nition 33.8 Let (â„¦, M, P) be a probability space and let Mt be a ï¬ltration.
Then a stochastic process, Mt, t â‰¥0 is called a martingale if
Mt is Mt measurable for all t â‰¥0
Mt âˆˆL1 (â„¦) for all t â‰¥0
E (Ms|Mt) = Mt whenever s â‰¥t.

33.1.
CONTINUOUS MARTINGALES
911
Theorem 33.9 Brownian motion for S â‰¤t with respect to the ï¬ltration described
above is a martingale.
Proof: First, Bt is Ft measurable. It is necessary to verify Bt is in L1 (â„¦) . But
by Theorem 31.44
Z
â„¦
|Bt (Ï‰)| dP
â‰¤
Z
â„¦
|Bt (Ï‰)|2 dP
â‰¤
2
Z
â„¦
|Bt âˆ’B0|2 dP + 2
Z
â„¦
|B0|2
â‰¤
2n (t âˆ’s) + 2
Z
â„¦
|x|2 dP < âˆž.
Next it must be shown that E (Bs|Ft) = Bt whenever s â‰¥t. Let F âˆˆFt and let
s â‰¥t. Then
Z
F
E (Bs âˆ’Bt|Ft) dP
=
Z
(Bsâˆ’Bt) XF dP
=
Z
â„¦
(Bsâˆ’Bt) dP
Z
â„¦
XF dP = 0.
Hence
E (Bs|Ft)
=
E (Bs âˆ’Bt|Ft) + E (Bt|Ft)
=
0 + Bt
and this proves the theorem.
Lemma 33.10 Let Bt be real valued Brownian motion. Then B2
t âˆ’t is a martingale.
Proof: The idea is to exploit the fact the increments (Bs âˆ’Bt) for s > t are
independent of Ft. Thus you write things in terms of (Bs âˆ’Bt) . It is easy to see
that (Bs âˆ’Bt)2 âˆ’2B2
t +2BsBt = B2
s âˆ’B2
t . Therefore, using the fact that Brownian
motion is a martingale,
E
Â¡
B2
s âˆ’B2
t |Ft
Â¢
=
E
Â³
(Bs âˆ’Bt)2 âˆ’2B2
t + 2BsBt|Ft
Â´
=
E
Â³
(Bs âˆ’Bt)2 |Ft
Â´
+ E
Â¡
âˆ’2B2
t + 2BsBt|Ft
Â¢
=
E
Â³
(Bs âˆ’Bt)2 |Ft
Â´
âˆ’2B2
t + 2BtE (Bs|Ft)
=
E
Â³
(Bs âˆ’Bt)2 |Ft
Â´
âˆ’2B2
t + 2B2
t
=
E
Â³
(Bs âˆ’Bt)2 |Ft
Â´
Now for A âˆˆFt,
Z
A
E
Â³
(Bs âˆ’Bt)2 |Ft
Â´
dP â‰¡
Z
A
(Bs âˆ’Bt)2 dP

912
FILTRATIONS AND MARTINGALES
=
Z
XAdP
Z
(Bs âˆ’Bt)2 dP =
Z
A
(s âˆ’t) dP.
Since this holds for all A âˆˆFt, it follows E
Â³
(Bs âˆ’Bt)2 |Ft
Â´
= (s âˆ’t) and so
E
Â¡
B2
s âˆ’s|Ft
Â¢
=
E
Â¡
B2
s âˆ’B2
t |Ft
Â¢
+ B2
t âˆ’s
=
(s âˆ’t) + B2
t âˆ’s = B2
t âˆ’t.
Suppose Bt is one dimensional Brownian motion. Then the increments, Bs âˆ’Bt
for s > t are independent of Ft where Ft is the smallest complete Ïƒ algebra such
that (Bt1, Â· Â· Â·, Btk) is measurable for every sequence 0 â‰¤t1 < t2 < Â· Â· Â· < tk â‰¤t.
Consider the problem of ï¬nding E ((Bs âˆ’Bt)m) for various values of m. It was
shown earlier that for m = 1, the answer is 0 and for m = 2, the answer is s âˆ’t.
By independence,
E
Â¡
eiBsuÂ¢
= E
Â³
ei(Bsâˆ’Bt)uÂ´
E
Â¡
eiBtuÂ¢
.
Therefore, from the earlier observations about the characteristic function of normaly
distributed random variables and using the fact the mean of Bt is x and the variance
is t,
eiuxeâˆ’1
2 u2s
eiuxeâˆ’1
2 u2t = E
Â³
ei(Bsâˆ’Bt)uÂ´
and so
E
Â³
ei(Bsâˆ’Bt)uÂ´
= eâˆ’1
2 u2(sâˆ’t).
(33.8)
Therefore,
E
Â³
i (Bs âˆ’Bt) ei(Bsâˆ’Bt)uÂ´
= u (t âˆ’s) e
1
2 u2(tâˆ’s)
E
Â³
âˆ’(Bs âˆ’Bt)2 ei(Bsâˆ’Bt)uÂ´
=
e
1
2 u2(tâˆ’s)t âˆ’e
1
2 u2(tâˆ’s)s
+u2e
1
2 u2(tâˆ’s)t2 âˆ’2u2e
1
2 u2(tâˆ’s)ts
+u2e
1
2 u2(tâˆ’s)s2
(33.9)
E
Â³
âˆ’i (Bs âˆ’Bt)3 ei(Bsâˆ’Bt)uÂ´
=
3ue
1
2 u2(tâˆ’s)t2 âˆ’6ue
1
2 u2(tâˆ’s)ts
+3ue
1
2 u2(tâˆ’s)s2 + u3e
1
2 u2(tâˆ’s)t3
âˆ’3u3e
1
2 u2(tâˆ’s)t2s + 3u3e
1
2 u2(tâˆ’s)ts2
âˆ’u3e
1
2 u2(tâˆ’s)s3
(33.10)

33.1.
CONTINUOUS MARTINGALES
913
E
Â³
(Bs âˆ’Bt)4 ei(Bsâˆ’Bt)uÂ´
=
3e
1
2 u2(tâˆ’s)t2 + 6u2e
1
2 u2(tâˆ’s)t3
âˆ’18u2e
1
2 u2(tâˆ’s)t2s âˆ’6e
1
2 u2(tâˆ’s)ts
+18u2e
1
2 u2(tâˆ’s)ts2 + 3e
1
2 u2(tâˆ’s)s2
âˆ’6u2e
1
2 u2(tâˆ’s)s3 + u4e
1
2 u2(tâˆ’s)t4
âˆ’4u4e
1
2 u2(tâˆ’s)t3s + 6u4e
1
2 u2(tâˆ’s)t2s2
âˆ’4u4e
1
2 u2(tâˆ’s)ts3 + u4e
1
2 u2(tâˆ’s)s4
(33.11)
Now plug in u = 0 to get these expected values. Considering 33.9,
âˆ’E
Â³
(Bs âˆ’Bt)2Â´
= t âˆ’s
(33.12)
which was already noted. Next let u = 0 in 33.10 to obtain
âˆ’iE
Â³
(Bs âˆ’Bt)3Â´
= 0.
(33.13)
Finally, consider 33.11. This gives
E
Â³
(Bs âˆ’Bt)4Â´
=
3t2 âˆ’6ts + 3s2
=
3 (s âˆ’t)2 .
(33.14)
Clearly one could go on like this but this is enough for now. You might conjecture
that E ((Bs âˆ’Bt)m) = (m âˆ’1) (s âˆ’t)m/2 for m even and 0 for m odd. Lets simply
call it gm (s âˆ’t) for now.
Example 33.11 Find a martingale which involves B3
t .
It is the exploitation of the independence of the increments which is of signiï¬-
cance. The idea is to write B3
s in terms of Bt and powers of increments, (Bs âˆ’Bt) .
To aid in doing this, just write the Taylor series expansion of the function s3. Thus
s3 = t3 +
Â¡
3t2Â¢
(s âˆ’t) + 3t (s âˆ’t)2 + (s âˆ’t)3 .
It follows
B3
s = B3
t + 3B2
t (Bs âˆ’Bt) + 3Bt (Bs âˆ’Bt)2 + (Bs âˆ’Bt)3 .
Then for s > t,
E
Â¡
B3
s|Ft
Â¢
= E
Â³
B3
t + 3B2
t (Bs âˆ’Bt) + 3Bt (Bs âˆ’Bt)2 + (Bs âˆ’Bt)3 |Ft
Â´
=
B3
t + B2
t E (Bs âˆ’Bt|Ft) + 3BtE
Â³
(Bs âˆ’Bt)2 |Ft
Â´
+ E
Â³
(Bs âˆ’Bt)3 |Ft
Â´
=
B3
t + 3BtE
Â³
(Bs âˆ’Bt)2 |Ft
Â´
+ E
Â³
(Bs âˆ’Bt)3 |Ft
Â´
(33.15)

914
FILTRATIONS AND MARTINGALES
Consider E ((Bs âˆ’Bt)m |Ft) . If A âˆˆFt,then by independence,
Z
A
E ((Bs âˆ’Bt)m |Ft) dP
=
Z
A
(Bs âˆ’Bt)m dP
=
Z
XAdP
Z
(Bs âˆ’Bt)m dP
=
Z
A
gm (s âˆ’t) dP
which shows
gm (s âˆ’t) = E ((Bs âˆ’Bt)m |Ft) .
(33.16)
Then considering 33.15 in light of 33.12 and 33.13, this leads to
E
Â¡
B3
s|Ft
Â¢
= B3
t + 3 (s âˆ’t) Bt
It follows
E
Â¡
B3
s âˆ’3Bss|Ft
Â¢
=
B3
t + 3 (s âˆ’t) Bt âˆ’3sE (Bs|Ft)
=
B3
t + 3 (s âˆ’t) Bt âˆ’3sBt
=
B3
t âˆ’3tBt
This shows B3
t âˆ’3tBt is a martingale.
Of course you can keep going this way. Here is yet another example.
Lemma 33.12 B4
t âˆ’6tB2
t + 3t2 is a martingale.
Proof: The Taylor series for y4 âˆ’6ty2 +3t2 considered a function of y expanded
about x is
Â¡
x4 âˆ’6tx2 + 3t2Â¢
+
Â¡
âˆ’12tx + 4x3Â¢
(y âˆ’x)
+
Â¡
âˆ’6t + 6x2Â¢
(y âˆ’x)2 + 4x (y âˆ’x)3 + (y âˆ’x)4
and so B4
s âˆ’6sB2
s + 3s2 equals
Â¡
B4
t âˆ’6sB2
t + 3s2Â¢
+
Â¡
âˆ’12sBt + 4B3
t
Â¢
(Bs âˆ’Bt)
+
Â¡
âˆ’6s + 6B2
t
Â¢
(Bs âˆ’Bt)2 + 4Bt (Bs âˆ’Bt)3 + (Bs âˆ’Bt)4
Using 33.16 and taking conditional expectations using the formulas, 33.12 - 33.14,
E
Â¡
B4
s âˆ’6sB2
s + 3s2|Ft
Â¢
equals
Â¡
B4
t âˆ’6sB2
t + 3s2Â¢
+
Â¡
âˆ’6s + 6B2
t
Â¢
(s âˆ’t) + 3 (s âˆ’t)2
and this simpliï¬es to
B4
t âˆ’6B2
t t + 3t2
This proves the lemma.

33.2.
DOOBâ€™S MARTINGALE ESTIMATE
915
33.2
Doobâ€™s Martingale Estimate
The next big result is an important inequality involving martingales which is due
to Doob. First here is a simple lemma.
Lemma 33.13 Let {Mt} be a ï¬ltration and let {Mt} be a real valued martingale
for t âˆˆ[S, T] . Then for Î» > 0 and any p â‰¥1, if At is a Mt measurable subset of
[|Mt| â‰¥Î»] , then
P (At) â‰¤1
Î»p
Z
At
|MT |p dP.
Proof: From Jensenâ€™s inequality,
Î»pP (At)
â‰¤
Z
At
|Mt|p dP =
Z
At
|E (MT |Mt)|p dP
â‰¤
Z
At
E (|MT |p |Mt) dP =
Z
At
|MT |p dP
and this proves the lemma.
The next theorem is the main result.
Theorem 33.14 Let {Mt} be a ï¬ltration and let {Mt} be a real valued continuous1
martingale for t âˆˆ[S, T] . Then for all Î» > 0 and p â‰¥1,
P
Ãƒ"
sup
tâˆˆ[S,T ]
|Mt| â‰¥Î»
#!
â‰¤1
Î»p
Z
â„¦
|MT |p dP
Proof: Let S â‰¤tm
0 < tm
1 < Â· Â· Â· < tm
Nm = T where tm
j+1 âˆ’tm
j = (T âˆ’S) 2âˆ’m.
First consider m = 1.
At1
0 â‰¡
n
Ï‰ âˆˆâ„¦:
Â¯Â¯Â¯Mt1
0 (Ï‰)
Â¯Â¯Â¯ â‰¥Î»
o
, At1
1 â‰¡
n
Ï‰ âˆˆâ„¦:
Â¯Â¯Â¯Mt1
1 (Ï‰)
Â¯Â¯Â¯ â‰¥Î»
o
\ At1
0
At1
2 â‰¡
n
Ï‰ âˆˆâ„¦:
Â¯Â¯Â¯Mt1
2 (Ï‰)
Â¯Â¯Â¯ â‰¥Î»
o
\
Â³
At1
0 âˆªAt1
0
Â´
.
Do this type of construction for m = 2, 3, 4, Â· Â· Â· yielding disjoint sets,
n
Atm
j
o2m
j=0
whose union equals
âˆªtâˆˆDm [|Mt| â‰¥Î»]
1t â†’Mt (Ï‰) is continuous for a.e. Ï‰.

916
FILTRATIONS AND MARTINGALES
where Dm =
Â©
tm
j
Âª2m
j=0 . Thus Dm âŠ†Dm+1. Then also, D â‰¡âˆªâˆž
m=1Dm is dense and
countable. From Lemma 33.13,
P (âˆªtâˆˆDm [|Mt| â‰¥Î»])
=
2m
X
j=0
P
Â³
Atm
j
Â´
â‰¤
1
Î»p
2m
X
j=0
Z
Atm
j
|MT |p dP
â‰¤
1
Î»p
Z
â„¦
|MT |p dP.
Let m â†’âˆžin the above to obtain
P (âˆªtâˆˆD [|Mt| â‰¥Î»]) â‰¤1
Î»p
Z
â„¦
|MT |p dP.
(33.17)
From now on, assume that for a.e. Ï‰ âˆˆâ„¦, t â†’Mt (Ï‰) is continuous. Then with
this assumption, the following claim holds.
Claim:For Î» > Îµ > 0,
âˆªtâˆˆD [|Mt| â‰¥Î» âˆ’Îµ] âŠ‡
"
sup
tâˆˆ[S,T ]
|Mt| â‰¥Î»
#
Proof of the claim: Suppose Ï‰ âˆˆ
h
suptâˆˆ[S,T ] |Mt| â‰¥Î»
i
. Then there exists s
such that |Ms (Ï‰)| > Î» âˆ’Îµ. By continuity, this situation persists for all t near to s.
In particular, it is true for some t âˆˆD. This proves the claim.
Letting P â€² denote the outer measure determined by P it follows from the claim
and 33.17 that
P â€²
Ãƒ"
sup
tâˆˆ[S,T ]
|Mt| â‰¥Î»
#!
â‰¤
P (âˆªtâˆˆD [|Mt| â‰¥Î» âˆ’Îµ])
â‰¤
1
(Î» âˆ’Îµ)p
Z
â„¦
|MT |p dP.
Since Îµ is arbitrary, this shows
P â€²
Ãƒ"
sup
tâˆˆ[S,T ]
|Mt| â‰¥Î»
#!
â‰¤1
Î»p
Z
â„¦
|MT |p dP.
It would be interesting to consider whether
h
suptâˆˆ[S,T ] |Mt| â‰¥Î»
i
is measurable.
However, this follows from the continuity of t â†’Mt (Ï‰) which implies
"
sup
tâˆˆ[S,T ]
|Mt| â‰¥Î»
#
=
Â·
sup
tâˆˆD
|Mt| â‰¥Î»
Â¸
,
a measurable set due to countability of D. This proves the theorem.

The ItË†o Integral
In all this, Bt will be a martingale for the ï¬ltration, Ht and the increments, Bs âˆ’Bt
will be independent of Ht for s > t. I will deï¬ne the ItË†o integral on [0, T] where T
is arbitrary. In doing so, I will also deï¬ne it on [0, t] . First the integral is deï¬ned
on uniformly bounded adapted step functions. Let Ï† be such a function. Thus
Ï† (t, Ï‰) =
nâˆ’1
X
j=0
Ï†j (Ï‰) X[tj,tj+1) (t) .
(34.1)
Then for t âˆˆ[tk, tk+1),
Z t
0
Ï†dB (Ï‰) â‰¡
kâˆ’1
X
j=0
Ï†j (Ï‰)
Â¡
Btj+1 (Ï‰) âˆ’Btj (Ï‰)
Â¢
+ Ï†k (Ï‰) (Bt (Ï‰) âˆ’Btk (Ï‰)) . (34.2)
The veriï¬cation that this is well deï¬ned and linear is essentially the same as it is
in the context of the Riemann integral from calculus. To show linearity on such
step functions, you simply take a common reï¬nement and if s is one of the new
partition points in [ti, ti+1), you replace the term Ï†iX[ti,ti+1) (t) with the sum of the
two terms, Ï†iX[ti,s) (t) + Ï†iX[s,,ti+1) (t) .
Lemma 34.1 Let s > t and let Ï† be bounded and Ht measurable. Then
exp (Ï† (Bs âˆ’Bt)) exp
Âµ
âˆ’1
2Ï†2 (s âˆ’t)
Â¶
(34.3)
is a function in L1 (â„¦) .
Proof: The given function is dominated by
h (Ï‰) â‰¡exp (M |Bs âˆ’Bt|)
917

918
THE IT Ë†O INTEGRAL
where |Ï† (Ï‰)| < M. Then using the technique of the distribution function, Theorem
9.39 on Page 232,
Z
â„¦
hdP
=
Z âˆž
0
P (h > Î») dÎ»
=
Z âˆž
0
P (exp (M |Bs âˆ’Bt|) > Î») dÎ»
â‰¤
Z âˆž
0
P
Âµ
|Bs âˆ’Bt| > ln (Î»)
M
Â¶
dÎ»
=
Z âˆž
1
P
Âµ
|Bs âˆ’Bt| > ln (Î»)
M
Â¶
dÎ»
+
Z 1
0
P (|Bs âˆ’Bt| > nonpositive) dÎ»
=
1 +
2
p
2Ï€ (s âˆ’t)
Z âˆž
1
Z âˆž
ln(Î»)/M
eâˆ’
x2
2(sâˆ’t) dxdÎ»
=
1 + C
Z âˆž
0
Z eMx
1
eâˆ’
x2
2(sâˆ’t) dÎ»dx â‰¤1 + C
Z âˆž
0
eâˆ’
x2
2(sâˆ’t) eMxdx < âˆž.
This proves the lemma.
Lemma 34.2 Let Ï† be a uniformly bounded adapted step function on [0, T] . Let
Î¾ (t) â‰¡exp
ÂµZ t
0
Ï†dB âˆ’1
2
Z t
0
Ï†2dr
Â¶
Then Î¾ (t) is a continuous Ht martingale.
Proof: That Î¾ (t) is continuous follows from the fact Ï† is bounded and the
continuity of Bt. It remains to verify it is a martingale. Let Ï† be given by 34.1 and
suppose tj â‰¤t < s < tj+1. Then
E (Î¾ (s) |Ht) = E
ÂµÎ¾ (s)
Î¾ (t) Î¾ (t) |Ht
Â¶
= Î¾ (t) E
ÂµÎ¾ (s)
Î¾ (t) |Ht
Â¶
.
(34.4)
From the deï¬nition of the integral on step functions given above and using the
assumption on t and s just mentioned, it follows this equals
Î¾ (t) E
ï£«
ï£­exp
Â¡R s
0 Ï†dB âˆ’1
2
R s
0 Ï†2dr
Â¢
exp
Â³R t
0 Ï†dB âˆ’1
2
R t
0 Ï†2dr
Â´|Ht
ï£¶
ï£¸
=
Î¾ (t) E
Âµ
exp
Â¡
Ï†j (Bs âˆ’Bt)
Â¢
exp
Âµ
âˆ’1
2Ï†2
j (s âˆ’t)
Â¶
|Ht
Â¶
.

919
Letting A be Ht measurable, it follows from independence of the increment, Bsâˆ’Bt
and Ht that
Z
A
E
Âµ
exp
Â¡
Ï†j (Bs âˆ’Bt)
Â¢
exp
Âµ
âˆ’1
2Ï†2
j (s âˆ’t)
Â¶
|Ht
Â¶
dP
=
Z
â„¦
XA exp
Â¡
Ï†j (Bs âˆ’Bt)
Â¢
exp
Âµ
âˆ’1
2Ï†2
j (s âˆ’t)
Â¶
dP
=
Z
â„¦
XAdP
Z
â„¦
exp
Â¡
Ï†j (Bs âˆ’Bt)
Â¢
exp
Âµ
âˆ’1
2Ï†2
j (s âˆ’t)
Â¶
dP.
(34.5)
Since Ï†j is bounded and measurable in Htj, there exists a sequence of simple func-
tions, {Î±n} which converges to Ï†j uniformly. Say
Î±n (Ï‰) =
mn
X
i=1
ciXEi (Ï‰)
where each Ei âˆˆHt (In fact, Ei âˆˆHtj.). Then by the dominated convergence
theorem, or simply the boundedness of Ï†j and the uniform convergence of Î±n to Ï†j,
lim
nâ†’âˆž
Z
â„¦
exp (Î±n (Bs âˆ’Bt)) exp
Âµ
âˆ’1
2Î±2
n (s âˆ’t)
Â¶
dP
=
Z
â„¦
exp
Â¡
Ï†j (Bs âˆ’Bt)
Â¢
exp
Âµ
âˆ’1
2Ï†2
j (s âˆ’t)
Â¶
dP.
However, by independence of the increments again
Z
â„¦
exp (Î±n (Bs âˆ’Bt)) exp
Âµ
âˆ’1
2Î±2
n (s âˆ’t)
Â¶
dP
=
mn
X
i=1
Z
Ei
exp (ci (Bs âˆ’Bt)) exp
Âµ
âˆ’1
2c2
i (s âˆ’t)
Â¶
dP
=
mn
X
i=1
Z
Ei
dP
Z
â„¦
exp (ci (Bs âˆ’Bt)) exp
Âµ
âˆ’1
2c2
i (s âˆ’t)
Â¶
dP.
However,
Z
â„¦
exp (ci (Bs âˆ’Bt)) exp
Âµ
âˆ’1
2c2
i (s âˆ’t)
Â¶
dP
=
Z
R
1
p
2Ï€ (s âˆ’t)
eâˆ’
x2
2(sâˆ’t) ecixeâˆ’1
2 c2
i (sâˆ’t)dx = 1
which follows from completing the square in the exponents and recognizing the inte-
grand as a normal distribution. Therefore, 34.5 reduces to
R
A dP and so E
Â³
Î¾(s)
Î¾(t) |Ht
Â´
=
1 which shows from 34.4 that
E (Î¾ (s) |Ht) = Î¾ (t) .

920
THE IT Ë†O INTEGRAL
The next case is when s = tj+1 and t âˆˆ(tj, tj+1) . The argument goes the same
way. In this case,
E
ÂµÎ¾ (s)
Î¾ (t) |Ht
Â¶
=
E
Â¡
exp
Â¡
Ï†j
Â¡
Btj+1 âˆ’Btj
Â¢
âˆ’Ï†j
Â¡
Bt âˆ’Btj
Â¢Â¢
Â·
exp
Âµ
âˆ’1
2
Â¡
Ï†2
j (tj+1 âˆ’tj) âˆ’Ï†2
j (t âˆ’tj)
Â¢Â¶
|Ht
Â¶
= E
Âµ
exp
Â¡
Ï†j
Â¡
Btj+1 âˆ’Bt
Â¢Â¢
exp
Âµ
âˆ’1
2Ï†2
j (tj+1 âˆ’t)
Â¶
|Ht
Â¶
.
Now it is just a repeat of the above argument to show this is 1.
All other cases follow easily from this. For example, suppose tjâˆ’1 â‰¤t < tj <
tj+1 â‰¤s < tj+2. Then from the two cases considered above,
E (Î¾ (s) |Ht)
=
E
Â¡
E
Â¡
E
Â¡
Î¾ (s) |Htj+1
Â¢
|Htj
Â¢
|Ht
Â¢
=
E
Â¡
E
Â¡
Î¾ (tj+1) |Htj
Â¢
|Ht
Â¢
=
E (Î¾ (tj) |Ht) = Î¾ (t) .
Continuing in this way shows Î¾ (t) is a martingale. This proves the lemma.
Note also that this shows
E (Î¾ (T)) = E (Î¾ (T) |H0) = Î¾ (0) = 1.
Now from Doobâ€™s martingale estimate, Theorem 33.14,
P
Âµ
max
tâˆˆ[0,T ] Î¾ (t) â‰¥Î»
Â¶
â‰¤1
Î»E (Î¾ (T)) = 1
Î».
If Ï† were replaced by Î±Ï† and Î¾Î± were obtained by replacing Ï† with Î±Ï†, the same
estimate would follow. Thus
P
Âµ
max
t
ÂµZ t
0
Ï†dB âˆ’Î±
2
Z t
0
Ï†2ds
Â¶
> Î»
Â¶
=
P
Âµ
max
t
ÂµZ t
0
Î±Ï†dB âˆ’1
2
Z t
0
(Î±Ï†)2 ds
Â¶
> Î±Î»
Â¶
=
P
Âµ
max
t
Âµ
exp
ÂµZ t
0
Î±Ï†dB âˆ’1
2
Z t
0
(Î±Ï†)2 ds
Â¶Â¶
> eÎ±Î»
Â¶
=
P
Â³
max
t
(Î¾Î± (t)) > eÎ±Î»Â´
â‰¤
1
eÎ±Î» E (Î¾Î± (T)) = eâˆ’Î±Î»
(34.6)
Summarizing this gives the following very signiï¬cant inequality in which Î±, Î» are
two arbitrary positive constants independent of Ï†.
P
Âµ
max
t
ÂµZ t
0
Ï†dB âˆ’Î±
2
Z t
0
Ï†2ds
Â¶
> Î»
Â¶
â‰¤eâˆ’Î±Î».
(34.7)
Now recall how adapted functions can be approximated by adapted step func-
tions. This was proved in Corollary 33.4 which is stated here for convenience.

921
Corollary 34.3 Let Ft be a ï¬ltration and suppose f is adapted and B Ã— F mea-
surable such that for a.e. Ï‰,
Z T
0
f (t, Ï‰)2 dt < âˆž.
(34.8)
Then there exists a sequence of uniformly bounded adapted step functions, Ï†n such
that
lim
nâ†’âˆžP
ÃƒZ T
0
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt > Îµ
!
= 0.
(34.9)
Thus
Ï†n (t, Ï‰) =
mnâˆ’1
X
j=0
en
j (Ï‰) X[tn
j ,tn
j+1) (t)
where tn
0 = 0 and en
j is Ftn
j measurable. Furthermore, if f is in L2 ([0, T] Ã— â„¦) ,
there exists a subsequence
Â©
Ï†nk
Âª
such that
lim
kâ†’âˆž
Z
â„¦
Z T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dtdP = 0
From this corollary, the following fundamental lemma will make possible the
deï¬nition of the ItË†o integral. It pertains to the ï¬ltration, Ht with respect to which
Bt is a martingale and such that for s > t, Bs âˆ’Bt is independent of Ht.
Lemma 34.4 Suppose f is Ht adapted and B Ã— F measurable such that for a.e. Ï‰,
Z T
0
f (t, Ï‰)2 dt < âˆž.
(34.10)
Then there exists a sequence of bounded adapted step functions, {Ï†k} and a set of
measure zero, E, such that for Ï‰ /âˆˆE,
Z T
0
(f (t, Ï‰) âˆ’Ï†k (t, Ï‰))2 dt â‰¤2âˆ’k
for all k suï¬ƒciently large (depending on Ï‰ /âˆˆE). Also, for Ï‰ /âˆˆE, there exists
K (Ï‰) such that if k > l â‰¥K (Ï‰) , then
Z T
0
(Ï†k (s, Ï‰) âˆ’Ï†l (s, Ï‰))2 ds < 2âˆ’(kâˆ’2).
Proof: By Corollary 33.4 stated above, there exists a subsequence, of the {Ï†n}
mentioned in this corollary,
Â©
Ï†nk
Âª
such that
P
ÃƒZ T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dt > 2âˆ’k
!
< 2âˆ’k.

922
THE IT Ë†O INTEGRAL
Now let Ak â‰¡
h
Ï‰ :
R T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dt > 2âˆ’ki
. Then from the above,
âˆž
X
k=1
P (Ak) < âˆž
and so by the Borel Cantelli lemma, the set, E of points Ï‰ contained in inï¬nitely
many of the Ak has measure zero. Therefore, for Ï‰ /âˆˆE, there exists K (Ï‰) such
that for k > K (Ï‰) , Ï‰ /âˆˆAk and so
Z T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dt â‰¤2âˆ’k
Denote Ï†k = Ï†nk.
For Ï‰ /âˆˆE and l > k > K (Ï‰) described above, and t â‰¤T,
Z t
0
(Ï†k (s, Ï‰) âˆ’Ï†l (s, Ï‰))2 ds
â‰¤
2
Z t
0
(Ï†k (s, Ï‰) âˆ’f (s, Ï‰))2 ds
+2
Z t
0
(f (s, Ï‰) âˆ’Ï†l (s, Ï‰))2 ds
â‰¤
2kâˆ’1 + 2lâˆ’1 â‰¤2kâˆ’2.
This proves the lemma.
Now recall the fundamental estimate, 34.7,
P
Âµ
max
t
ÂµZ t
0
Ï†dB âˆ’Î±
2
Z t
0
Ï†2ds
Â¶
> Î»
Â¶
â‰¤eâˆ’Î±Î».
(34.11)
which was valid for bounded adapted step functions, Ï†. This lemma makes possible
the following theorem which is the basis for the deï¬nition of the ItË†o integral.
Theorem 34.5 Suppose f is Ht adapted and B Ã— F measurable such that for a.e.
Ï‰,
Z T
0
f (t, Ï‰)2 dt < âˆž,
and let {Ï†n} be a sequence of bounded adapted step functions such that oï¬€a set of
measure zero E,
Z T
0
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt â‰¤2âˆ’n
(34.12)
for all n suï¬ƒciently large, the existence of such a sequence being provided by Lemma
34.4; then there exists a set of measure zero E, such that if Ï‰ /âˆˆE, then
Â½Z t
0
Ï†ndB (Ï‰)
Â¾
is uniformly Cauchy for t âˆˆ[0, T]. Furthermore, if {Ïˆn} is another sequence of
bounded adapted step functions satisfying 34.12, then for Ï‰ oï¬€a set of measure
zero,
lim
nâ†’âˆž
Âµ
max
t
Â¯Â¯Â¯Â¯
Z t
0
Ï†ndB (Ï‰) âˆ’
Z t
0
ÏˆndB (Ï‰)
Â¯Â¯Â¯Â¯
Â¶
= 0.

923
Proof: By Lemma 34.4, for Ï‰ /âˆˆE the exceptional set of measure zero, there
exists N (Ï‰) such that if n > m â‰¥N (Ï‰) ,
Z T
0
(Ï†n (s, Ï‰) âˆ’Ï†m (s, Ï‰))2 ds < 2âˆ’(mâˆ’2)
In the estimate 34.11 let
eâˆ’Î±Î» = Î¸âˆ’m, Î± =
Âµ3
2
Â¶mâˆ’2
where Î¸ > 1. Hence Î» =
Â¡ 2
3
Â¢mâˆ’2 m ln Î¸. Thus for n > m â‰¥N (Ï‰) ,
P
Â³
max
t
Â³R t
0 (Ï†n âˆ’Ï†m) dB âˆ’1
2
Â¡ 3
2
Â¢mâˆ’2 R t
0 (Ï†n âˆ’Ï†m)2 ds
Â´
>
Â¡ 2
3
Â¢mâˆ’2 m ln Î¸
Â´
< Î¸âˆ’m
By the Borel Cantelli lemma again, there exists a set of measure zero E containng
the earlier exceptional set such that for Ï‰ /âˆˆE there exists N (Ï‰) large enough that
for n > m â‰¥N (Ï‰) ,
max
t
ÃƒZ t
0
(Ï†n âˆ’Ï†m) dB (Ï‰) âˆ’1
2
Âµ3
2
Â¶mâˆ’2 Z t
0
(Ï†n âˆ’Ï†m)2 ds
!
â‰¤
Âµ2
3
Â¶mâˆ’2
m ln Î¸
Z T
0
(Ï†n âˆ’Ï†m)2 ds < 2âˆ’(mâˆ’2).
Therefore for such Ï‰,
max
t
ÃƒZ t
0
(Ï†n âˆ’Ï†m) dB (Ï‰) âˆ’1
2
Âµ3
2
Â¶mâˆ’2
2âˆ’(mâˆ’2)
!
â‰¤
Âµ2
3
Â¶mâˆ’2
m ln Î¸
and switching Ï†n and Ï†m,
max
t
ÃƒZ t
0
(Ï†m âˆ’Ï†n) dB (Ï‰) âˆ’1
2
Âµ3
2
Â¶mâˆ’2
2âˆ’(mâˆ’2)
!
â‰¤
Âµ2
3
Â¶mâˆ’2
m ln Î¸.
Therefore,
max
t
ÃƒÂ¯Â¯Â¯Â¯
Z t
0
(Ï†m âˆ’Ï†n) dB (Ï‰)
Â¯Â¯Â¯Â¯ â‰¤
Âµ2
3
Â¶mâˆ’2
m ln Î¸ + 1
2
Âµ3
4
Â¶mâˆ’2!
.
It follows that for Ï‰ oï¬€a set of measure zero,
nR t
0 Ï†ndB (Ï‰)
o
is a Cauchy sequence.
Adjusting the above constants, there exists a constant, r < 1 and a positive con-
stant, C such that
max
t
ÂµÂ¯Â¯Â¯Â¯
Z t
0
(Ï†m âˆ’Ï†n) dB (Ï‰)
Â¯Â¯Â¯Â¯ â‰¤Crm
Â¶

924
THE IT Ë†O INTEGRAL
whenever n > m and m large enough.
If {Ïˆn} is another such sequence satisfying 34.12 then for n large enough,
Z T
0
(Ï†n (s, Ï‰) âˆ’Ïˆn (s, Ï‰))2 ds < 2âˆ’(nâˆ’2)
and so the same estimate yields, for all Ï‰ oï¬€a set of measure zero,
max
t
ÂµÂ¯Â¯Â¯Â¯
Z t
0
(Ïˆn âˆ’Ï†n) dB (Ï‰)
Â¯Â¯Â¯Â¯ â‰¤Crn
Â¶
which shows that for Ï‰ oï¬€a set of measure zero,
lim
nâ†’âˆž
Âµ
max
t
Â¯Â¯Â¯Â¯
Z t
0
Ï†ndB (Ï‰) âˆ’
Z t
0
ÏˆndB (Ï‰)
Â¯Â¯Â¯Â¯
Â¶
= 0.
This proves the theorem.
Note there is no loss of generality in starting the integral at 0. All the above
works with no change for integrals on the interval, [S, T] with no signiï¬cant change.
With this theorem the following deï¬nition and conclusion is well deï¬ned.
Deï¬nition 34.6 Suppose f is Ht adapted and B Ã— F measurable such that for
Ï‰ /âˆˆE a set of measure zero,
Z T
S
f (t, Ï‰)2 dt < âˆž.
Then there exists a sequence of adapted bounded step functions, {Ï†n} satisfying
Z T
S
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt â‰¤2âˆ’n
for Ï‰ /âˆˆE, a set of measure zero. Then for t âˆˆ[S, T] , the ItË†o integral is deï¬ned by
Z t
S
fdB (Ï‰) = lim
nâ†’âˆž
Z t
S
Ï†ndB (Ï‰) .
Furthermore, for these Ï‰, t â†’
R t
S fdB (Ï‰) is continuous because by Theorem 34.5
the convergence of
R t
S Ï†ndB (Ï‰) is uniform on [0, T].
Deï¬nition 34.7 Suppose f is Ht adapted and B Ã— F measurable such that for a.e.
Ï‰,
Z T
S
f (t, Ï‰)2 dt < âˆž.
I will denote such functions by saying they are in W (H) .

34.1.
PROPERTIES OF THE IT Ë†O INTEGRAL
925
34.1
Properties Of The ItË†o Integral
Theorem 34.8 Let f, g âˆˆW (H) and let 0 â‰¤S â‰¤U â‰¤T. Then the following hold.
Z T
S
fdB =
Z U
S
fdB +
Z T
U
fdB
(34.13)
Z T
S
(af + bg) dB = a
Z T
S
fdB + b
Z T
S
fdB
(34.14)
Z T
S
fdB is HT measurable.
(34.15)
E
ÃƒZ T
S
fdB
!
= 0
(34.16)
if for some sequence of adapted step functions, {Ï†n} ,
lim
nâ†’âˆžE
ÃƒZ T
S
Ï†ndB
!
= E
ÃƒZ T
S
fdB
!
.
Proof: This holds essentially because it holds for any Ï† a step function. For
example, if
Ï† (t, Ï‰) =
n
X
j=1
ej (Ï‰) X[tj,tj+1) (t) ,
Then without loss of generality it can be assumed U is one of the tj say tk. Therefore,
Z T
S
Ï†dB
=
kâˆ’1
X
j=1
ej (Ï‰)
Â¡
Btj+1 (Ï‰) âˆ’Btj (Ï‰)
Â¢
+
n
X
j=k
ej (Ï‰)
Â¡
Btj+1 (Ï‰) âˆ’Btj (Ï‰)
Â¢
=
Z U
S
Ï†dB +
Z T
U
Ï†dB
It follows 34.13 must hold in the limit. 34.14 is somewhat more obvious. Consider
34.16. Let Ï† be as above. Then recall that ej is Htj measurable and so
E
ï£«
ï£­
n
X
j=1
ej (Ï‰)
Â¡
Btj+1 (Ï‰) âˆ’Btj (Ï‰)
Â¢
ï£¶
ï£¸
=
n
X
j=1
E (ej) E
Â¡
Btj+1 âˆ’Btj
Â¢
=
n
X
j=1
E (ej) 0 = 0
What is used here is the independence of the increments, Bs âˆ’Bt to Ht.

926
THE IT Ë†O INTEGRAL
34.15 must also hold because if Ï† is as above,
R T
S Ï†dB is HT measurable and
R T
S fdB is a pointwise a.e. limit of these.
The next theorem is called the ItË†o isometry.
It pertains to the case where
f âˆˆL2 ([S, T] Ã— â„¦) . Thus
Z
â„¦
Z T
0
f (t, Ï‰)2 dtdP < âˆž
which says more than just
P
ÃƒZ T
0
f (t, Ï‰)2 dt < âˆž
!
= 1.
Recall Corollary 33.4 again.
Corollary 34.9 Let Ft be a ï¬ltration and suppose f is adapted and B Ã— F mea-
surable such that for a.e. Ï‰,
Z T
0
f (t, Ï‰)2 dt < âˆž.
(34.17)
Then there exists a sequence of uniformly bounded adapted step functions, Ï†n such
that
lim
nâ†’âˆžP
ÃƒZ T
0
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt > Îµ
!
= 0.
(34.18)
Thus
Ï†n (t, Ï‰) =
mnâˆ’1
X
j=0
en
j (Ï‰) X[tn
j ,tn
j+1) (t)
where tn
0 = 0 and en
j is Ftn
j measurable. Furthermore, if f is in L2 ([0, T] Ã— â„¦) ,
there exists a subsequence
Â©
Ï†nk
Âª
such that
lim
kâ†’âˆž
Z
â„¦
Z T
0
Â¡
f (t, Ï‰) âˆ’Ï†nk (t, Ï‰)
Â¢2 dtdP = 0
The following theorem is the ItË†o isometry.All of this is still in the context of the
ï¬ltration, Ht with respect to which Bt is a martingale and the increments, Bs âˆ’Bt
are independent of Ht whenever s > t.
Theorem 34.10 Let f be Ht adapted and in L2 ([S, T] Ã— â„¦) . Then
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
S
fdB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
= ||f||L2([0,T ]Ã—â„¦) .

34.1.
PROPERTIES OF THE IT Ë†O INTEGRAL
927
Proof: First let Ï† (t, Ï‰) = Pnâˆ’1
j=0 ej (Ï‰) X[tj,tj+1) (t) be a uniformly bounded
adapted step function. Then
Z T
S
Ï†dB =
nâˆ’1
X
j=0
ej
Â¡
Btj+1 âˆ’Btj
Â¢
.
Then
ÃƒZ T
S
Ï†dB
!2
=
X
i,j
ej
Â¡
Btj+1 âˆ’Btj
Â¢
ei
Â¡
Bti+1 âˆ’Bti
Â¢
.
Consider these terms. First consider one in which i Ì¸= j, say
eiej
Â¡
Bti+1 âˆ’Bti
Â¢ Â¡
Btj+1 âˆ’Btj
Â¢
.
By independence of the increments, it follows
Z
â„¦
eiej
Â¡
Bti+1 âˆ’Bti
Â¢ Â¡
Btj+1 âˆ’Btj
Â¢
dP
=
Z
â„¦
eiej
Â¡
Bti+1 âˆ’Bti
Â¢
dP
Z
â„¦
Â¡
Btj+1 âˆ’Btj
Â¢
dP = 0.
Therefore,
Z
â„¦
ÃƒZ T
S
Ï†dB
!2
dP
=
Z
â„¦
nâˆ’1
X
j=0
e2
j
Â¡
Btj+1 âˆ’Btj
Â¢2 dP
=
nâˆ’1
X
j=0
Z
â„¦
e2
j
Â¡
Btj+1 âˆ’Btj
Â¢2 dP
=
nâˆ’1
X
j=0
Z
â„¦
e2
jdP
Z
â„¦
Â¡
Btj+1 âˆ’Btj
Â¢2 dP
=
nâˆ’1
X
j=0
Z
â„¦
e2
jdP (tj+1 âˆ’tj) dP =
Z
â„¦
Z T
0
Ï†2dtdP.
This proves the ItË†o isometry on bounded adapted step functions.
By Corollary 33.4, there exists a sequence of adapted bounded step functions,
{Ï†n} which converges to f in L2 ([S, T] Ã— â„¦) such that also
Z T
S
fdB (Ï‰) = lim
nâ†’âˆž
Z T
S
Ï†ndB (Ï‰) a.e.
Therefore, from what was just shown
(Z T
S
Ï†ndB
)âˆž
n=1

928
THE IT Ë†O INTEGRAL
is a Cauchy sequence in L2 (â„¦) . Therefore, a subsequence of it converges a.e. How-
ever, this requires the thing to which it converges in L2 (â„¦) must be
R T
S fdB (Ï‰) .
Therefore,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
S
fdB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
=
lim
nâ†’âˆž
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
S
Ï†ndB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
=
lim
nâ†’âˆž||Ï†n||L2([S,T ]Ã—â„¦) = ||f||L2([S,T ]Ã—â„¦) .
This proves the theorem.
This theorem also gives another way to deï¬ne the ItË†o integral when
f âˆˆL2 ([S, T] Ã— â„¦)
in addition to being in W (H).
Lemma 34.11 If f âˆˆW (H) and is in L2 ([S, T] Ã— â„¦) , let {Ï†n} be any sequence
of bounded adapted step functions converging to f in L2 ([S, T] Ã— â„¦). Then
Z T
S
fdB = lim
nâ†’âˆž
Z T
S
Ï†ndB
in L2 (â„¦) .
Proof: This is immediate from the following.
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
S
fdB âˆ’
Z T
S
Ï†ndB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
=
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
S
(f âˆ’Ï†n) dB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
=
||f âˆ’Ï†n||L2([S,T ]Ã—â„¦)
which converges to 0.
Letting f âˆˆW (H) , one can consider the stochastic process
R t
S f (s, Ï‰) dB (Ï‰) .
From the construction of the ItË†o integral above, this is a continuous function of t for
a.e. Ï‰. It turns out that if f is also in L2 ([S, T] Ã— â„¦) , then this stochastic process
is also an Ht martingale.
Theorem 34.12 I (t, Ï‰) â‰¡
R t
S f (s, Ï‰) dB (Ï‰) is an Ht martingale if
f âˆˆL2 ([S, T] Ã— â„¦) .
Proof: Let
In (t, Ï‰) =
Z t
S
Ï†n (s, Ï‰) dB (Ï‰) .
where Ï†n is a bounded adapted step function such that
Z t
S
fdB = lim
nâ†’âˆž
Z t
S
Ï†ndB

34.1.
PROPERTIES OF THE IT Ë†O INTEGRAL
929
in L2 (â„¦) for each t âˆˆ[S, T] and for Ï‰ not in a suitable set of measure zero,
I (t, Ï‰) â‰¡
Z t
S
fdB (Ï‰) = lim
nâ†’âˆž
Z t
S
Ï†ndB (Ï‰)
(34.19)
uniformly for t âˆˆ[S, T] .
In fact, In (t, Ï‰) is a martingale. Let s > t. Then
E (In (s, Ï‰) |Ft) = E
ÂµZ t
S
Ï†ndB +
Z s
t
Ï†ndB|Ft
Â¶
.
Now
R t
S Ï†ndB is measurable in Ft and so this reduces to
Z t
S
Ï†ndB + E
ï£«
ï£­
X
tâ‰¤tn
j <tn
j+1â‰¤s
en
j
Â¡
Btj+1 âˆ’Btj
Â¢
|Ft
ï£¶
ï£¸.
By Lemma 32.2,
=
Z t
S
Ï†ndB + E
ï£«
ï£­E
ï£«
ï£­
X
tâ‰¤tn
j <tn
j+1â‰¤s
en
j
Â¡
Btj+1 âˆ’Btj
Â¢
|Ftj
ï£¶
ï£¸|Ft
ï£¶
ï£¸
=
Z t
S
Ï†ndB + E
ï£«
ï£­
X
tâ‰¤tn
j <tn
j+1â‰¤s
E
Â¡
en
j
Â¡
Btj+1 âˆ’Btj
Â¢
|Ftj
Â¢
|Ft
ï£¶
ï£¸
=
Z t
S
Ï†ndB + E
ï£«
ï£­
X
tâ‰¤tn
j <tn
j+1â‰¤s
en
j E
Â¡Â¡
Btj+1 âˆ’Btj
Â¢
|Ftj
Â¢
|Ft
ï£¶
ï£¸
=
Z t
S
Ï†ndB + E
ï£«
ï£­
X
tâ‰¤tn
j <tn
j+1â‰¤s
en
j Â· 0|Ft
ï£¶
ï£¸=
Z t
S
Ï†ndB = In (t, Ï‰) .
Thus In (t, Ï‰) is a martingale. Let s > t. Since In (r, Â·) â†’I (r, Â·) in L2 (â„¦) for
each r, Jensenâ€™s inequality implies
Z
â„¦
|E (In (s, Ï‰) |Ft) âˆ’E (I (s, Ï‰) |Ft)| dP
â‰¤
Z
â„¦
E (|In (s, Ï‰) âˆ’I (s, Ï‰)| |Ft) dP
=
Z
â„¦
|In (s, Ï‰) âˆ’I (s, Ï‰)| dP

930
THE IT Ë†O INTEGRAL
which converges to 0. It follows that for F âˆˆFt, and s > t,
Z
F
I (t, Ï‰) dP
=
lim
kâ†’âˆž
Z
F
In (t, Ï‰) dP
=
lim
kâ†’âˆž
Z
F
E (In (s, Ï‰) |Ft) dP
=
Z
F
E (I (s, Ï‰) |Ft) dP.
What about the measurability of I? This follows from the pointwise convergence
described in 34.19 the measurability of In and completness of the measure. This
proves the theorem.
Example 34.13 Find
R t
0 Bs (Ï‰) dB (Ï‰) assuming B0 (0) = 0.
Let Ï†n (s, Ï‰) = Pn
j=0 Btj (Ï‰) X[tj,tj+1) (s) where |tj+1 âˆ’tj| is constant in j and
equals t/n. Then Ï†n â†’Bs in L2 ([0, t] Ã— â„¦) and it is clear that Ï†n is adapted.
Therefore,
Z T
S
Ï†n (t, Ï‰) dB (Ï‰) â†’
Z T
S
Bt (Ï‰) dB (Ï‰)
in L2 (â„¦) . But by deï¬nition,
Z T
S
Ï†n (t, Ï‰) dB (Ï‰) =
n
X
j=0
Btj (Ï‰)
Â¡
Btj+1 (Ï‰) âˆ’Btj (Ï‰)
Â¢
and a little algebra shows this equals
n
X
j=0
1
2
Â³
B2
tj+1 âˆ’B2
tj
Â´
âˆ’
n
X
j=0
1
2
Â¡
Btj+1 âˆ’Btj
Â¢2
=
1
2Bt (Ï‰)2 âˆ’1
2
n
X
j=0
Â¡
Btj+1 âˆ’Btj
Â¢2 .
Now
Z
â„¦
Â¯Â¯Â¯Â¯Â¯Â¯
n
X
j=0
Â¡
Btj+1 âˆ’Btj
Â¢2 âˆ’t
Â¯Â¯Â¯Â¯Â¯Â¯
2
dP
=
Z
â„¦
X
i,j
Â¡
Btj+1 âˆ’Btj
Â¢2 Â¡
Bti+1 âˆ’Bti
Â¢2 âˆ’2t
X
j
Â¡
Btj+1 âˆ’Btj
Â¢2 + t2dP
=
X
i,j
(tj+1 âˆ’tj) (ti+1 âˆ’ti) âˆ’2t
X
j
(tj+1 âˆ’tj) + t2 = t2 âˆ’2t2 + t2 = 0
and so
Z
â„¦
Â¯Â¯Â¯Â¯Â¯Â¯
1
2Bt (Ï‰)2 âˆ’1
2
n
X
j=0
Â¡
Btj+1 âˆ’Btj
Â¢2 âˆ’
Âµ1
2Bt (Ï‰)2 âˆ’1
2t
Â¶Â¯Â¯Â¯Â¯Â¯Â¯
2
dP = 0

34.1.
PROPERTIES OF THE IT Ë†O INTEGRAL
931
which shows
Z T
S
Bt (Ï‰) dB (Ï‰) = 1
2Bt (Ï‰)2 âˆ’1
2t.
This is contrary to what any student would know; that from the symbols in-
volved,
Z T
S
Bt (Ï‰) dBt (Ï‰) = 1
2Bt (Ï‰)2 âˆ’1
2B0 (Ï‰)2 = 1
2Bt (Ï‰)2 .
Here you get the extra term, âˆ’1
2t.

932
THE IT Ë†O INTEGRAL

Stochastic Processes
35.1
An Important Filtration
Recall the theorem about Brownian motion which is listed here for convenience.
Theorem 35.1 There exists a probability space, (â„¦, F, P) and random vectors, Bt
for t âˆˆ[0, âˆž) which satisfy the following properties.
1. For Z = (Bt1, Â· Â· Â·, Btk) âˆˆRnk it follows Z is normally distributed. Its mean
is
Â¡ x
Â· Â· Â·
x Â¢
âˆˆRnk
2. Bt has independent increments. This means if t1 < t2 < Â· Â· Â· < tk, the random
variables,
Bt1, Bt2 âˆ’Bt1, Â· Â· Â·, Btk âˆ’Btkâˆ’1
are independent and normally distributed. Note this implies the kth compo-
nents must also be independent. Also Btj âˆ’Btjâˆ’1 is normal with covariance
(tj âˆ’tjâˆ’1) I and mean 0. In addition to this, the kth component of Bt is
normally distributed with density function
p (t, xk,y) â‰¡
1
(2Ï€t)1/2 exp
Ãƒ
âˆ’|y âˆ’xk|2
2t
!
This follows from the distribution of Bt which has a density function
p (t, x, y) â‰¡
1
(2Ï€t)n/2 exp
Ãƒ
âˆ’|y âˆ’x|2
2t
!
3. E
Â³
|Bt âˆ’Bs|4Â´
â‰¤3n2 (t âˆ’s)2 , For t > s,
E
Â³
|Bt âˆ’Bs|2Â´
=
n (t âˆ’s) ,
E
Â¡
(Bt âˆ’x)âˆ—(Bs âˆ’x)
Â¢
=
ns,
E (Bt âˆ’Bs)
=
0,
933

934
STOCHASTIC PROCESSES
4. t â†’Bt (Ï‰) is Holder continuous.
Observation 35.2 Let Bt be n dimensional Brownian motion as discussed above.
Then considering the kth component of Bt, Bkt, it follows Bkt is one dimensional
Brownian motion. Letting Ht denote the completion of the smallest Ïƒ algebra con-
taining
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)
for all B a Borel set in Rnk for all sequences, 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t, it follows
that for s > t, Bks âˆ’Bkt is independent of Ht . Also, from the fact discussed above
in Theorem 33.9 that Bt is a martingale, it follows the same is true of Bkt. Thus
all the above theory can be applied for this Ht and integrating with respect to one of
the components of n dimensional Brownian motion.
One other thing should be pointed out although it was mentioned above and
that is the distribution of Bs âˆ’Bt for s > t. The density for Bt as described above
is
1
(2Ï€t)n/2 exp
Ãƒ
âˆ’|y âˆ’x|2
2t
!
and so by Theorem 31.22 on Page 868
E
Â¡
eiuÂ·BtÂ¢
= eiuÂ·xeâˆ’1
2 uâˆ—tIu.
Recall also from the above that Bs âˆ’Bt is independent to Bt. Therefore,
E
Â¡
eiuÂ·BsÂ¢
=
E
Â³
eiuÂ·BteiuÂ·(Bsâˆ’Bt)Â´
=
E
Â¡
eiuÂ·BtÂ¢
E
Â³
eiuÂ·(Bsâˆ’Bt)Â´
and so
E
Â³
eiuÂ·(Bsâˆ’Bt)Â´
=
eiuÂ·xeâˆ’1
2 uâˆ—sIu
eiuÂ·xeâˆ’1
2 uâˆ—tIu
=
eâˆ’1
2 uâˆ—(sâˆ’t)Iu.
This implies the following lemma.
Lemma 35.3 Let Bt = (B1t, Â· Â· Â·, Bnt) be n dimensional Brownian motion. Then
for s > t, Bis âˆ’Bit and Bjs âˆ’Bjt are linearly independent if j Ì¸= i.
Proof: The covariance matrix of the distribution of Bs âˆ’Bt is (s âˆ’t) times the
identity and so the components of this vector are linearly independent.
Lemma 35.4 Letting Ht denote the completion of the smallest Ïƒ algebra containing
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)

35.1.
AN IMPORTANT FILTRATION
935
for all B a Borel set in Rnk for all sequences, 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t as deï¬ned
above, Ht is also equal to the completion of the smallest Ïƒ algebra containing
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)
for all B an open set in Rnk for all sequences, 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t. In addition
to this, Ht is equal to the completion of the smallest Ïƒ algebra containing
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)
for all B an open set in Rnk for all sequences, 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t such that
the sj are rational numbers.
Proof: The ï¬rst claim reducing to inverse images of open sets is not hard.
Deï¬ne Gt to be the smallest Ïƒ algebra such that (Bs1, Â· Â· Â·, Bsk)âˆ’1 (U) âˆˆGt for U
open and 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t. Now let
S(s1,Â·Â·Â·,sk) â‰¡
n
E Borel such that (Bs1, Â· Â· Â·, Bsk)âˆ’1 (E) âˆˆGt
o
Then S(s1,Â·Â·Â·,sk) contains the open sets and so it also contains the Borel sets because
it is a Ïƒ algebra. Hence Gt contains all sets of the form (Bs1, Â· Â· Â·, Bsk)âˆ’1 (E) for all E
Borel and 0 â‰¤s1 < s2 Â·Â·Â· < sk â‰¤t. It follows Gt is the smallest Ïƒ algebra containing
the sets of the form (Bs1, Â· Â· Â·, Bsk)âˆ’1 (B) for B Borel and so its completion equals
Ht.
The second claim is more interesting. In this claim, it suï¬ƒces to consider ï¬-
nite increasing sequences of rational numbers, rather than just ï¬nite increasing
sequences. Let 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t and let 0 â‰¤tn
1 < tn
2 Â· Â·Â· < tn
k â‰¤t be an
increasing sequence of rational numbers such that limnâ†’âˆžtn
k = sk. It has been
proven that oï¬€a set of measure zero, t â†’Bt (Ï‰) is continuous. To simplify the
presentation, I will assume without loss of generality that this set of measure zero
is empty. If not, you could simply delete it and consider a slightly modiï¬ed â„¦.
Another way to see this is not a loss of generality is that Ht is complete and so
contains all subsets of sets of measure zero. Let O be an open set and let
O = âˆªâˆž
m=1Om, Â· Â· Â·Om âŠ†Om âŠ†Om+1 Â· Â·Â·
Then by continuity of t â†’Bt (Ï‰) ,
(Bs1, Â· Â· Â·, Bsk)âˆ’1 Â¡
Om
Â¢
âŠ‡
âˆªâˆž
l=1 âˆ©pâ‰¥l
Â³
Btp
1, Â· Â· Â·, Btp
k
Â´âˆ’1
(Om)
âŠ‡
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (Om)
It follows upon taking the union over all m,
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (O)
=
âˆªm (Bs1, Â· Â· Â·, Bsk)âˆ’1 Â¡
Om
Â¢
âŠ‡
âˆªm âˆªl âˆ©pâ‰¥l
Â³
Btp
1, Â· Â· Â·, Btp
k
Â´âˆ’1
(Om)
âŠ‡
âˆªm (Bs1, Â· Â· Â·, Bsk)âˆ’1 (Om)
=
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (O)

936
STOCHASTIC PROCESSES
Thus
âˆªm âˆªl âˆ©pâ‰¥l
Â³
Btp
1, Â· Â· Â·, Btp
k
Â´âˆ’1
(Om) = (Bs1, Â· Â· Â·, Bsk)âˆ’1 (O)
and so the smallest Ïƒ algebra containing (Bs1, Â· Â· Â·, Bsk)âˆ’1 (B) for B open and 0 â‰¤
s1 < s2 Â· Â·Â· < sk â‰¤t an arbitrary sequence of numbers is the same as the smallest
Ïƒ algebra containing (Bs1, Â· Â· Â·, Bsk)âˆ’1 (B) for B open and 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t
an increasing sequence of rational numbers.
35.2
ItË†o Processes
Let B = (B1, Â· Â· Â·, Bn) be n dimensional Brownian motion and let Ht be the ï¬ltration
deï¬ned above. Thus Bk is a martingale with respect to Ht and the increments,
Bks âˆ’Bkt are independent of Ht whenever s > t. Let Xk for k = 1, 2, Â· Â· Â·, m be a
stochastic process satisfying for t âˆˆ[0, T] ,
Xkt âˆ’Xk0 =
Z t
0
uk (s, Ï‰) ds +
n
X
l=1
Z t
0
vkl (s, Ï‰) dBl.
(35.1)
Written in simpler form,
Xt âˆ’X0 =
Z t
0
u (s) ds +
Z t
0
V (s) dB
(35.2)
where V (s) is an m Ã— n matrix. For now, assume uk and vkl are all Ht adapted
uniformly bounded step functions.
Also assume g is a C2 function deï¬ned on R Ã— Rm for which all partial deriva-
tives are uniformly bounded and let
Â©
tr
j
Âªnr
j=0 be partitions of [0, T] such that for
âˆ†(r) â‰¡supj
Â©
tr
j+1 âˆ’tr
j
Âª
, limrâ†’âˆžâˆ†(r) = 0 and also all discontinuities of all the
step functions, vkl and uk are contained in
Â©
tr
j
Âªnr
j=0 . Then suppressing the super-
script on tr
j for the sake of simpler notation,
g (T, XT ) âˆ’g (0, X0) =
nrâˆ’1
X
j=0
g
Â¡
tj+1, Xtj+1
Â¢
âˆ’g
Â¡
tj, Xtj
Â¢
=
nrâˆ’1
X
j=0
âˆ‚g
âˆ‚t
Â¡
tj, Xtj
Â¢
âˆ†tj + D2g
Â¡
tj, Xtj
Â¢
âˆ†Xtj
+ 1
2
Âµâˆ‚2g
âˆ‚t2
Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢
âˆ†t2
j
(35.3)
+D2
Â¡
D2g
Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢ Â¡
âˆ†Xtj
Â¢Â¢
âˆ†Xtj
+ 2D2
Âµâˆ‚g
âˆ‚t
Â¶ Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢
âˆ†tjâˆ†Xtj
Â¶
.
(35.4)

35.2.
IT Ë†O PROCESSES
937
Now from 35.2 and the assumptions that all discontinuities of all step functions are
in the partition, it follows the matrix, V and the vector, u must be of the form
V (s, Ï‰) =
nrâˆ’1
X
j=0
V j (Ï‰) X[tj,tj+1) (s) , u (s, Ï‰) =
nrâˆ’1
X
j=0
uj (Ï‰) V[tj,tj+1) (s)
It follows from 35.2 that
âˆ†Xtj = ujâˆ†tj + V jâˆ†Btj
(35.5)
It follows from this that 35.3 - 35.4 can be written as
=
nrâˆ’1
X
j=0
âˆ‚g
âˆ‚t
Â¡
tj, Xtj
Â¢
âˆ†tj + D2g
Â¡
tj, Xtj
Â¢ Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢
(35.6)
+1
2
Âµâˆ‚2g
âˆ‚t2
Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢
âˆ†t2
j
(35.7)
+2D2
Âµâˆ‚g
âˆ‚t
Â¶ Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢
âˆ†tj
Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢
(35.8)
+D2
Â¡
D2g
Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢ Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢Â¢
Â·
(35.9)
Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢Â¢
.
(35.10)
Since âˆ†(r) â†’0 as r â†’âˆž, this simpliï¬es to an expression of the form
= e (r) +
nrâˆ’1
X
j=0
âˆ‚g
âˆ‚t
Â¡
tj, Xtj
Â¢
âˆ†tj + D2g
Â¡
tj, Xtj
Â¢ Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢
+1
2
Âµ
2D2
Âµâˆ‚g
âˆ‚t
Â¶ Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢
V jâˆ†tjâˆ†Btj
+
Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢T
H
Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢ Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢
(35.11)
where e (r) â†’0 as r â†’âˆžand H is the Hessian matrix of second partial derivatives
of g taken with respect to the x variables. The e (r) in the above is obtained by the
inclusion of all the terms which have a âˆ†t2
j in them. There are lots of other terms
which are of the form
nrâˆ’1
X
j=0
ajâˆ†tjâˆ†Bktj
where aj is bounded independent of r. In fact, all such terms can be included in

938
STOCHASTIC PROCESSES
e (r) oï¬€a set of measure zero. I will show this now.
Z
â„¦
Â¯Â¯Â¯Â¯Â¯Â¯
nrâˆ’1
X
j=0
ajâˆ†tjâˆ†Bktj
Â¯Â¯Â¯Â¯Â¯Â¯
dP
â‰¤
C
Z
â„¦
nrâˆ’1
X
j=0
âˆ†tj
Â¯Â¯âˆ†Bktj
Â¯Â¯ dP
â‰¤
C
nrâˆ’1
X
j=0
âˆ†tj
Z
â„¦
Â¯Â¯âˆ†Bktj
Â¯Â¯ dP
=
C
nrâˆ’1
X
j=0
âˆ†tj
ÂµZ
â„¦
Â¯Â¯âˆ†Bktj
Â¯Â¯2 dP
Â¶1/2
â‰¤
Câˆ†(r)1/2 T
which converges to 0. Therefore, there exists a set of measure zero oï¬€which terms
of this form converge to 0 as r â†’âˆžupon taking a further subsequence if necessary.
Therefore, the above expression simpliï¬es further and yields
g (T, XT ) âˆ’g (0, X0) =
e (r) +
nrâˆ’1
X
j=0
âˆ‚g
âˆ‚t
Â¡
tj, Xtj
Â¢
âˆ†tj + D2g
Â¡
tj, Xtj
Â¢ Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢
+
nrâˆ’1
X
j=0
1
2
Â³Â¡
V jâˆ†Btj
Â¢T H
Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢ Â¡
V jâˆ†Btj
Â¢Â´
(35.12)
where e (r) â†’0 oï¬€a set of measure zero. Consider the last term. This term is of
the form
nrâˆ’1
X
j=0
1
2
Â³Â¡
V jâˆ†Btj
Â¢T H
Â¡
tj, Xtj
Â¢ Â¡
V jâˆ†Btj
Â¢Â´
+
nrâˆ’1
X
j=0
1
2Â·
(35.13)
Â³Â¡
V jâˆ†Btj
Â¢T Â¡
H
Â¡
tj + Î¸âˆ†tj, Xtj + Î¸âˆ†Xtj
Â¢
âˆ’H
Â¡
tj, Xtj
Â¢Â¢ Â¡
V jâˆ†Btj
Â¢Â´
.
(35.14)
Now the term in 35.14 is of the form
nrâˆ’1
X
j=0
âˆ†BT
tjMrâˆ†Btj
where Mr â†’0 as r â†’âˆžand is uniformly bounded. It follows that for a.e. Ï‰, the
above expression converges to 0 and also
Â¯Â¯Â¯Â¯Â¯Â¯
nrâˆ’1
X
j=0
âˆ†BT
tjMrâˆ†Btj
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤C
nrâˆ’1
X
j=0
Â¯Â¯âˆ†Btj
Â¯Â¯2 .
(35.15)

35.2.
IT Ë†O PROCESSES
939
Now by independence of the increments,
Z
â„¦
ï£«
ï£­
nrâˆ’1
X
j=0
Â¯Â¯âˆ†Btj
Â¯Â¯2
ï£¶
ï£¸
2
dP =
Z
â„¦
X
i,j
Â¯Â¯âˆ†Btj
Â¯Â¯2 |âˆ†Bti|2 dP
=
X
iÌ¸=j
Z
â„¦
Â¯Â¯âˆ†Btj
Â¯Â¯2 dP
Z
â„¦
|âˆ†Bti|2 dP +
nrâˆ’1
X
i=1
Z
â„¦
Â¯Â¯âˆ†Btj
Â¯Â¯4 dP
â‰¤
X
i,j
(tj+1 âˆ’tj) (ti+1 âˆ’ti) +
nrâˆ’1
X
i=1
3n2 (tj+1 âˆ’tj)2
â‰¤
T 2 + 3n2âˆ†(r) T.
Thus
ï£±
ï£²
ï£³
Â¯Â¯Â¯Â¯Â¯Â¯
nrâˆ’1
X
j=0
âˆ†BT
tjMrâˆ†Btj
Â¯Â¯Â¯Â¯Â¯Â¯
ï£¼
ï£½
ï£¾
r
is uniformly integrable and so by the Vitali convergence theorem,
lim
râ†’âˆž
Z
â„¦
Â¯Â¯Â¯Â¯Â¯Â¯
nrâˆ’1
X
j=0
âˆ†BT
tjMrâˆ†Btj
Â¯Â¯Â¯Â¯Â¯Â¯
dP = 0.
Passing to a further subsequence, 35.12 is of the form
g (T, XT ) âˆ’g (0, X0) =
e (r) +
nrâˆ’1
X
j=0
âˆ‚g
âˆ‚t
Â¡
tj, Xtj
Â¢
âˆ†tj + D2g
Â¡
tj, Xtj
Â¢ Â¡
ujâˆ†tj + V jâˆ†Btj
Â¢
+
nrâˆ’1
X
j=0
1
2
Â³
âˆ†BT
tj
Â¡
V jÂ¢T H
Â¡
tj, Xtj
Â¢
V jâˆ†Btj
Â´
(35.16)
where for a.e. Ï‰, e (r) â†’0. It remains to consider the last term in the above as
r â†’âˆž. Denote by Aj the symmetric matrix
Â¡
V jÂ¢T H
Â¡
tj, Xtj
Â¢
V j
in the above. Note this is measurable in Htj.
Claim: Letting Aj =
Â¡
V jÂ¢T H
Â¡
tj, Xtj
Â¢
V j, there exists a subsequence, r â†’âˆž
and a set of measure zero such that for Ï‰ not in this set of measure zero,
nrâˆ’1
X
j=0
Â³
âˆ†BT
tjAjâˆ†Btj
Â´
âˆ’
nrâˆ’1
X
j=0
tr
Â¡
AjÂ¢
âˆ†tj â†’0.

940
STOCHASTIC PROCESSES
Proof of the claim:
Z
â„¦
ï£«
ï£­
nrâˆ’1
X
j=0
Â³
âˆ†BT
tjAjâˆ†Btj
Â´
âˆ’
nâˆ’1
X
j=0
tr
Â¡
AjÂ¢
âˆ†tj
ï£¶
ï£¸
2
dP
=
X
i,j
Z
â„¦
Â³
âˆ†BT
tjAjâˆ†Btj âˆ’tr
Â¡
AjÂ¢
âˆ†tj
Â´ Â¡
âˆ†BT
tiAiâˆ†Bti âˆ’tr
Â¡
AiÂ¢
âˆ†ti
Â¢
dP
(35.17)
Consider a term in which j > i. The integrand is of the form
âˆ†BT
tjAjâˆ†Btjâˆ†BT
tiAiâˆ†Bti âˆ’tr
Â¡
AiÂ¢
âˆ†tiâˆ†BT
tjAjâˆ†Btj
âˆ’tr
Â¡
AjÂ¢
âˆ†tjâˆ†BT
tiAiâˆ†Bti + tr
Â¡
AjÂ¢
âˆ†tjtr
Â¡
AiÂ¢
âˆ†ti
(35.18)
Consider the ï¬rst term.
Z
â„¦
âˆ†BT
tjAjâˆ†Btjâˆ†BT
tiAiâˆ†BtidP
=
Z
â„¦
ï£«
ï£­X
Î±,Î²
âˆ†BÎ±tjAj
Î±Î²âˆ†BÎ²tj
ï£¶
ï£¸
ÃƒX
Ïƒ,Ï„
âˆ†BÏƒtiAi
ÏƒÏ„âˆ†BÏ„ti
!
dP
=
X
Î±,Î²,Ïƒ,Ï„
Z
â„¦
âˆ†BÎ±tjAj
Î±Î²âˆ†BÎ²tjâˆ†BÏƒtiAi
ÏƒÏ„âˆ†BÏ„tidP
=
X
Î±,Î²,Ïƒ,Ï„
Z
â„¦
âˆ†BÎ±tjâˆ†BÎ²tjdP
Z
â„¦
âˆ†BÏƒtiAj
Î±Î²Ai
ÏƒÏ„âˆ†BÏ„tidP
Therefore, using independence of the components of n dimensional Brownian motion
which independence results from the covariance matrix for the joint distribution
being diagonal along with the independence of increments in time, this reduces to
=
X
Î±,Ïƒ,Ï„
Z
â„¦
âˆ†B2
Î±tjdP
Z
â„¦
Aj
Î±Î±âˆ†BÏƒtiAi
ÏƒÏ„âˆ†BÏ„tidP
=
X
Ïƒ,Ï„
(tj+1 âˆ’tj)
Z
â„¦
X
Î±
Aj
Î±Î±âˆ†BÏƒtiAi
ÏƒÏ„âˆ†BÏ„tidP
=
(tj+1 âˆ’tj)
Z
â„¦
tr
Â¡
AjÂ¢ X
Ïƒ,Ï„
âˆ†BÏƒtiAi
ÏƒÏ„âˆ†BÏ„tidP
=
Z
â„¦
âˆ†tjtr
Â¡
AjÂ¢
âˆ†BT
tiAiâˆ†BtidP
which shows that this term in the case where j > i cancels with the third term of
35.18. Now consider the second term of 35.18 again in the case where j > i. This

35.2.
IT Ë†O PROCESSES
941
yields
âˆ’
Z
â„¦
tr
Â¡
AiÂ¢
âˆ†tiâˆ†BT
tjAjâˆ†BtjdP
=
âˆ’
Z
â„¦
tr
Â¡
AiÂ¢
âˆ†ti
X
Î±,Î²
âˆ†BÎ±tjAj
Î±Î²âˆ†BÎ²tjdP
= âˆ’
X
Î±,Î²
Z
â„¦
âˆ†BÎ±tjâˆ†BÎ²tjdP
Z
â„¦
tr
Â¡
AiÂ¢
âˆ†tiAj
Î±Î²dP
=
âˆ’
X
Î±
Z
â„¦
âˆ†B2
Î±tjdP
Z
â„¦
tr
Â¡
AiÂ¢
âˆ†tiAj
Î±Î±dP
=
âˆ’
Z
â„¦
(âˆ†tj) tr
Â¡
AiÂ¢
âˆ†ti
X
Î±
Aj
Î±Î±dP
=
âˆ’
Z
â„¦
(âˆ†tj) tr
Â¡
AiÂ¢
âˆ†titr
Â¡
AjÂ¢
dP
and so this second term cancels with the last term of 35.18. It follows the only
terms to consider in 35.17 are those for which j = i. Thus 35.17 is of the form
X
i
Z
â„¦
Â³Â¡
âˆ†BT
tiAiâˆ†Bti
Â¢2 âˆ’2âˆ†BT
tiAiâˆ†Btitr
Â¡
AiÂ¢
âˆ†ti +
Â¡
tr
Â¡
AiÂ¢
âˆ†ti
Â¢2Â´
dP.
(35.19)
First consider the second term.
Z
â„¦
âˆ†BT
tiAiâˆ†Btitr
Â¡
AiÂ¢
âˆ†tidP
=
X
Î±,Î²
Z
â„¦
âˆ†BÎ±tiAi
Î±Î²âˆ†BÎ²titr
Â¡
AiÂ¢
âˆ†tidP
=
X
Î±,Î²
Z
â„¦
âˆ†BÎ±tiâˆ†BÎ²tidP
Z
â„¦
Ai
Î±Î²tr
Â¡
AiÂ¢
âˆ†tidP
=
X
Î±
Z
â„¦
âˆ†B2
Î±tidP
Z
â„¦
Ai
Î±Î±tr
Â¡
AiÂ¢
âˆ†tidP
=
âˆ†ti
Z
â„¦
ÃƒX
Î±
Ai
Î±Î±
!
tr
Â¡
AiÂ¢
âˆ†tidP
=
Z
â„¦
tr
Â¡
AiÂ¢2 âˆ†t2
i dP â‰¥0
It follows 35.17 is dominated above by
X
i
Z
â„¦
Â³Â¡
âˆ†BT
tiAiâˆ†Bti
Â¢2 +
Â¡
tr
Â¡
AiÂ¢
âˆ†ti
Â¢2Â´
dP

942
STOCHASTIC PROCESSES
Consider the ï¬rst term.
Z
â„¦
Â¡
âˆ†BT
tiAiâˆ†Bti
Â¢2 dP
=
Z
â„¦
ï£«
ï£­X
Î±,Î²
âˆ†BÎ±tiAi
Î±Î²âˆ†BÎ²ti
ï£¶
ï£¸
ÃƒX
Ïƒ,Ï„
âˆ†BÏƒtiAi
ÏƒÏ„âˆ†BÏ„ti
!
dP
=
X
Î±,Î²,Ïƒ,Ï„
Z
â„¦
âˆ†BÎ±tiAi
Î±Î²âˆ†BÎ²tiâˆ†BÏƒtiAi
ÏƒÏ„âˆ†BÏ„tidP
=
X
Î±,Î²,Ïƒ,Ï„
Z
â„¦
Ai
Î±Î²Ai
ÏƒÏ„dP
Z
â„¦
âˆ†BÎ±tiâˆ†BÎ²tiâˆ†BÏƒtiâˆ†BÏ„tidP.
(35.20)
There are two ways in which the term of this sum will not equal zero. One way is
for Î± = Î² and Ïƒ = Ï„. In this situation, the above is dominated by
X
Î±,Ïƒ
Z
â„¦
Ai
Î±Î±Ai
ÏƒÏƒdP
Z
â„¦
âˆ†B2
Î±tiâˆ†B2
ÏƒtidP
=
X
Î±Ì¸=Ïƒ
Z
â„¦
Ai
Î±Î±Ai
ÏƒÏƒdPâˆ†t2
i +
X
Î±
Z
â„¦
Â¡
Ai
Î±Î±
Â¢2 dP3 (âˆ†ti)2
â‰¤
X
Î±,Ïƒ
Z
â„¦
Ai
Î±Î±Ai
ÏƒÏƒdPâˆ†t2
i +
X
Î±
Z
â„¦
Â¡
Ai
Î±Î±
Â¢2 dP3 (âˆ†ti)2
=
Z
â„¦
tr
Â¡
AiÂ¢2 dPâˆ†t2
i + 3
Z
â„¦
X
Î±
Â¡
Ai
Î±Î±
Â¢2 dP (âˆ†ti)2
The other way in which the expression in 35.20 is not zero is for Î± = Ïƒ and Î² = Ï„.
If this happens, the expression is of the form
X
Î±,Î²
Z
â„¦
Ai
Î±Î²Ai
Î±Î²dP
Z
â„¦
âˆ†BÎ±tiâˆ†BÎ²tiâˆ†BÎ±tiâˆ†BÎ²tidP
=
X
Î±,Î²
Z
â„¦
Ai
Î±Î²Ai
Î±Î²dP
Z
â„¦
âˆ†B2
Î±tiâˆ†B2
Î²tidP
=
X
Î±Â±Î²
Z
â„¦
Ai
Î±Î²Ai
Î±Î²dP
Z
â„¦
âˆ†B2
Î±tidP
Z
â„¦
âˆ†B2
Î²tidP
+
X
Î±
Z
â„¦
Â¡
Ai
Î±Î±
Â¢2 dP3âˆ†t2
i
=
X
Î±Â±Î²
Z
â„¦
Ai
Î±Î²Ai
Î±Î²dPâˆ†t2
i +
X
Î±
Z
â„¦
Â¡
Ai
Î±Î±
Â¢2 dP3âˆ†t2
i .
Thus the expression in 35.20 is dominated by
C
nrâˆ’1
X
i=1
âˆ†t2
i

35.2.
IT Ë†O PROCESSES
943
which converges to 0 as r â†’âˆž. This proves the claim.
Now returning to 35.16 ï¬rst note that
lim
râ†’âˆž
nrâˆ’1
X
j=0
tr
Â¡
AjÂ¢
âˆ†tj =
Z T
0
tr
Â¡
V T H (t, Xt) V
Â¢
dt.
Therefore, there exists a subsequence, still denoted by r and a set of measure zero
oï¬€of which the last term of 35.16 converges to
1
2
Z T
0
tr
Â¡
V T H (t, Xt) V
Â¢
dt.
It follows that oï¬€a set of measure zero, you can pass to the limit in 35.16 and
conclude
g (T, XT ) âˆ’g (0, X0) =
Z T
0
Âµâˆ‚g
âˆ‚t (t, Xt) + D2g (t, Xt) u+1
2tr
Â¡
V T H (t, Xt) V
Â¢Â¶
dt
+
Z T
0
D2g (t, Xt) V dB
This lengthy computation has mostly proved the following lemma.
Lemma 35.5 Let Ht be the ï¬ltration deï¬ned above and let B be n dimensional
Brownian motion. Suppose Xt is a vector valued stochastic process for t âˆˆ[0, T]
deï¬ned by the following for a.e. Ï‰
Xt âˆ’X0 =
Z t
0
u (s, Â·) ds +
Z t
0
V (s, Â·) dB
where all entries of u and
V are Ht adapted uniformly bounded step functions.
Then if g is a C2 function such that all partial derivatives are uniformly bounded,
then for all t âˆˆ[0, T] ,
g (t, Xt) âˆ’g (0, X0) =
Z t
0
Âµâˆ‚g
âˆ‚t (s, Xs) + D2g (s, Xs) u+1
2tr
Â¡
V T H (s, Xs) V
Â¢Â¶
ds
+
Z t
0
D2g (s, Xs) V dB
Proof:
Let {tk} be the rational numbers in [0, T] . The above computation
shows that for each tk, there exists a set of measure zero, Ek such that if Ï‰ /âˆˆEk,
then
g (tk, Xtk) âˆ’g (0, X0) =

944
STOCHASTIC PROCESSES
Z tk
0
Âµâˆ‚g
âˆ‚t (s, Xs) + D2g (s, Xs) u+tr
Â¡
V T H (s, Xs) V
Â¢Â¶
ds
+
Z tk
0
D2g (s, Xs) V dB
Letting E = âˆªâˆž
k=1Ek, it follows E has measure zero and the above formula holds for
all tk. By continuity the above must hold for all t âˆˆ[0, T] . This proves the lemma.
Now let V (t, Ï‰) and u (t, Ï‰) will be B Ã— F measurable, both u and V are Ht
adapted, and the components of V and u satisfy
P
ÃƒZ T
0
v2
ijds < âˆž
!
= 1, P
ÃƒZ T
0
|uk| ds < âˆž
!
= 1.
(35.21)
Deï¬nition 35.6 Xt is called an ItË†o process if for, u, V described above and a
measurable function, X0 such that
Xt âˆ’X0 =
Z t
0
u (s, Ï‰) ds +
Z t
0
V (s, Ï‰) dB.
Lemma 35.5 shows that if g is a C2 function deï¬ned on R Ã— Rm which has all
the second partial derivatives uniformly bounded, then if u and V have components
which are uniformly bounded adapted step functions, then g (t, X) is also an ItË†o
process as described in that lemma. The next step is to remove the assumption
that u and V are step functions.
Lemma 35.7 Let Ht be the ï¬ltration deï¬ned above and let B be n dimensional
Brownian motion. Suppose Xt is a vector valued stochastic process for t âˆˆ[0, T]
deï¬ned by the following for a.e. Ï‰
Xt âˆ’X0 =
Z t
0
u (s, Â·) ds +
Z t
0
V (s, Â·) dB
(35.22)
where all entries of u and V are Ht adapted and satisfy 35.21. Then if g is a C2
function such that all second order partial derivatives are uniformly bounded, then
for all t âˆˆ[0, T] ,
g (t, Xt) âˆ’g (0, X0) =
Z t
0
Âµâˆ‚g
âˆ‚t (s, Xs) + D2g (s, Xs) u+1
2tr
Â¡
V T H (s, Xs) V
Â¢Â¶
ds
+
Z t
0
D2g (s, Xs) V dB
(35.23)
where H is the Hessian matrix of g whose ijth entry is
âˆ‚2g
âˆ‚xiâˆ‚xj
(s, Xs (Ï‰)) .

35.2.
IT Ë†O PROCESSES
945
Proof: From 35.21 there exist sequences,
Â©
ulÂªâˆž
l=1 and
Â©
V lÂªâˆž
l=1 such that the
entries of ul and V l are adapted step functions and in addition there is a set of
measure zero, E, such that if Ï‰ /âˆˆE, then the components of ul and V l satisfy
Z T
0
Â¯Â¯ul
k âˆ’uk
Â¯Â¯ dt < 2âˆ’l,
Z T
0
Â¯Â¯vl
kj âˆ’vkj
Â¯Â¯2 dt < 2âˆ’l
(35.24)
for all l large enough, depending on Ï‰ of course. Then from 35.22 deï¬ne
Xl
t âˆ’Xl
0 =
Z t
0
ul (s, Â·) ds +
Z t
0
V l (s, Â·) dB
and it follows that for Ï‰ /âˆˆE, and all t âˆˆ[0, T] ,
lim
lâ†’âˆžXl
t (Ï‰) = Xt (Ï‰) .
(35.25)
In addition to this, it follows from 35.24 it follows there is a subsequence such that
for Ï‰ /âˆˆE,
V l (t, Ï‰) â†’V (t, Ï‰) , ul (t, Ï‰) â†’u (t, Ï‰) a.e. t.
By Lemma 35.5 for a.e. Ï‰,
g
Â¡
t, Xl
t
Â¢
âˆ’g
Â¡
0, Xl
0
Â¢
=
Z t
0
Âµâˆ‚g
âˆ‚t
Â¡
s, Xl
s
Â¢
+ D2g
Â¡
s, Xl
s
Â¢
ul+1
2tr
Â¡
V lT H
Â¡
s, Xl
s
Â¢
V lÂ¢Â¶
ds
+
Z t
0
D2g
Â¡
s, Xl
s
Â¢
V ldB
(35.26)
for all t âˆˆ[0, T] . Now 35.24 implies for each Ï‰ /âˆˆE,
R T
0
Â¯Â¯Â¯Â¯V lÂ¯Â¯Â¯Â¯2 dt is uniformly
bounded independent of l. Consider the third term.
Z T
0
Â¯Â¯tr
Â¡
V lT H
Â¡
s, Xl
s
Â¢
V lÂ¢
âˆ’tr
Â¡
V T H (s, Xs) V
Â¢Â¯Â¯ dt
(35.27)
â‰¤
Z T
0
Â¯Â¯tr
Â¡
V lT H
Â¡
s, Xl
s
Â¢
V l âˆ’V T H
Â¡
s, Xl
s
Â¢
V
Â¢Â¯Â¯ dt
+
Z T
0
Â¯Â¯tr
Â¡
V T Â¡
H
Â¡
s, Xl
s
Â¢
âˆ’H (s, Xs)
Â¢
V
Â¢Â¯Â¯ dt
The second term in the above expression converges to 0 by the dominated conver-
gence theorem. It can be dominated by C
Â¯Â¯tr
Â¡
V T V
Â¢Â¯Â¯ , a function in L1 where here
C does not depend on l but on the uniform bound of the second derivatives of g.
Consider the ï¬rst term. The integrand is dominated by
Â¯Â¯tr
Â¡Â¡
V lT âˆ’V T Â¢
HV lÂ¢Â¯Â¯ +
Â¯Â¯tr
Â¡
V T H
Â¡
V l âˆ’V
Â¢Â¢Â¯Â¯

946
STOCHASTIC PROCESSES
The integral of both of these converges to 0. Consider the ï¬rst one.
Z T
0
Â¯Â¯tr
Â¡Â¡
V lT âˆ’V T Â¢
HV lÂ¢Â¯Â¯ dt
â‰¤
C
Z T
0
Â¯Â¯Â¯Â¯V l âˆ’V
Â¯Â¯Â¯Â¯ Â¯Â¯Â¯Â¯V lÂ¯Â¯Â¯Â¯ dt
â‰¤
Câ€²
Z T
0
Â¯Â¯Â¯Â¯V l âˆ’V
Â¯Â¯Â¯Â¯2 dt
which converges to 0 as l â†’âˆž. This shows that for each t âˆˆ[0, T] , one can pass
to the limit in the third term of 35.26 and eliminate the superscript, l. Passing to
the limit in the second term of 35.26 follows from 35.24 and the boundedness of
D2g
Â¡
s, Xl
s
Â¢
which results from the assumption that all the partial derivatives of g
are uniformly bounded. Passing to the limit in the ï¬rst term of 35.26 follows from
35.25. The last term involving dB is of the form
Z t
0
D2g
Â¡
s, XlÂ¢
V ldB =
X
j
Z t
0
Â¡
D2g
Â¡
s, XlÂ¢
V lÂ¢
ij dBj.
Then from the deï¬nition of the ItË†o integral given above, there is a subsequence still
denoted by l such that for a.e. Ï‰, the above converges uniformly in t to
X
j
Z t
0
(D2g (s, X) V )ij dBj
Thus for a dense subset of [0, T] , D, there exists an exceptional set of measure zero
such that 35.23 holds for all t âˆˆD. By continuity of the Ito integral, this continues
to hold for all t âˆˆ[0, T] . This proves the lemma.
It remains to remove the assumption that the partial derivatives of g are bounded.
This results in the following theorem which is the main result.
Theorem 35.8 Let Ht be the ï¬ltration deï¬ned above and let B be n dimensional
Brownian motion. Suppose Xt is a vector valued stochastic process for t âˆˆ[0, T]
deï¬ned by the following for a.e. Ï‰
Xt âˆ’X0 =
Z t
0
u (s, Â·) ds +
Z t
0
V (s, Â·) dB
(35.28)
where all entries of u and V are Ht adapted and satisfy 35.21. Then if g is a C2
function with values in Rp, it follows that for a.e. Ï‰ and for all t âˆˆ[0, T] ,
gk (t, Xt) âˆ’gk (0, X0) =
Z t
0
Âµâˆ‚gk
âˆ‚t (s, Xs) + D2gk (s, Xs) u+1
2tr
Â¡
V T Hk (s, Xs) V
Â¢Â¶
ds
+
Z t
0
D2gk (s, Xs) V dB
(35.29)

35.2.
IT Ë†O PROCESSES
947
where Hk is the Hessian matrix of gk whose ijth entry is
âˆ‚2gk
âˆ‚xiâˆ‚xj
(s, Xs (Ï‰)) .
Proof: There is no loss of generality in proving it only for the case where g has
values in R because you obtain the above formula by simply considering the kth
component of g. Assume then that g has values in R. Let ÏˆN âˆˆCâˆž
c (B (0,2N))
such that ÏˆN equals 1 on B (0, N) and ÏˆN has values in [0, 1] . Then let gN â‰¡gÏˆN.
Thus gN has uniformly bounded derivatives. By Lemma 35.7, there exists a set of
measure zero, EN such that for Ï‰ /âˆˆEN, and all t âˆˆ[0, T] ,
gN (t, Xt) âˆ’gN (0, X0) =
Z t
0
Âµâˆ‚gN
âˆ‚t (s, Xs) + D2gN (s, Xs) u+1
2tr
Â¡
V T HN (s, Xs) V
Â¢Â¶
ds
+
Z t
0
D2gN (s, Xs) V dB
(35.30)
Let E = âˆªâˆž
N=1EN. Then for Ï‰ /âˆˆE, the above formula holds for all N. By continuity
of X, it follows that for all N large enough, the values of X (t, Ï‰) are in B (0,N)
and so you can delete the subscript of N in the above. This proves the theorem.
How do people remember this? Letting Y (t, Ï‰) â‰¡g (t, X (t, Ï‰)) , 35.29 can be
considered formally as
dYk
=
Âµâˆ‚gk
âˆ‚t (t, Xt) + D2gk (t, Xt) u+1
2tr
Â¡
V T Hk (t, Xt) V
Â¢Â¶
dt
+D2gk (t, Xt) dB
and 35.28 can be written as
dXt = udt + V dB.
I think this is not too bad but one can write an easier to remember formula which
reduces to this one,
dYk = âˆ‚gk
âˆ‚t (t, Xt) dt + D2gk (t, Xt) dXt + 1
2dXT
t Hk (t, Xt) dXt
under the convention that dtdBk = 0, dt2 = 0, and, dBidBj = Î´ijdt.
Example 35.9 Let g (t, x) = x2 and let Xt = Bt where B0 = 0.
In this case,
Yt = B2
t
and so
dYt = 2BtdBt + 1
2 Â· 2dB2
t

948
STOCHASTIC PROCESSES
and so
B2
t âˆ’0
=
2
Z t
0
BdB +
Z t
0
dt
=
2
Z t
0
BdB + t.
This yields
Z t
0
BdB = 1
2
Â¡
B2
t âˆ’t
Â¢
which was encountered earlier.
Example 35.10 Let g (t, x) = x3 and Xt = Bt, Yt = X3
t where B0 = 0.
Then
dYt
=
3X2
t dXt + 1
26XtdX2
t
=
3X2
t dBt + 3Bt
Â¡
dB2
t
Â¢
=
3B2
t dBt + 3Btdt
and so
B3
t = 3
ÂµZ t
0
B2dB +
Z t
0
Bdt
Â¶
Example 35.11 Let Yt = tBt where Xt = Bt and where B0 = 0. Then
dYt
=
Btdt + tdBt + 1
20dB2
t
=
Btdt + tdBt
and so
Yt = tBt =
Z t
0
Bdt +
Z t
0
tdB
35.3
Some Representation Theorems
First recall the following important lemma, Lemma 35.4 on Page 934 which has to
do with the ï¬ltrations described above involving n dimensional Brownian motion.
The most important part of this lemma is that one can consider only the increasing
lists of rational numbers rather than all increasing lists of real numbers in deï¬ning
the ï¬ltration. Here is the lemma.
Lemma 35.12 Letting Ht denote the completion of the smallest Ïƒ algebra contain-
ing
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)

35.3.
SOME REPRESENTATION THEOREMS
949
for all B a Borel set in Rnk for all sequences, 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t as deï¬ned
above, Ht is also equal to the completion of the smallest Ïƒ algebra containing
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)
for all B an open set in Rnk for all sequences, 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t. In addition
to this, Ht is equal to the completion of the smallest Ïƒ algebra containing
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)
for all B an open set in Rnk for all sequences, 0 â‰¤s1 < s2 Â· Â·Â· < sk â‰¤t such that
the sj are rational numbers.
Also recall the Doob Dynkin theorem, Theorem 31.19 on Page 866 which is
listed here.
Lemma 35.13 Suppose X, Y1, Y2, Â·Â·Â·, Yk are random vectors, X having values in
Rn and Yj having values in Rpj and
X, Yj âˆˆL1 (â„¦) .
Suppose X is H(Y1,Â·Â·Â·,Yk) measurable. Thus
Â©
Xâˆ’1 (E) : E Borel
Âª
âŠ†
ï£±
ï£²
ï£³(Y1, Â· Â· Â·, Yk)âˆ’1 (F) : F is Borel in
k
Y
j=1
Rpj
ï£¼
ï£½
ï£¾
Then there exists a Borel function, g : Qk
j=1 Rpj â†’Rn such that
X = g (Y) .
Also recall the submartingale convergence theorem, Theorem 32.12 on Page 900
reviewed below.
Theorem 35.14 (submartingale convergence theorem) Let
{(Xi, Si)}âˆž
i=1
be a submartingale with K â‰¡sup E (|Xn|) < âˆž.
Then there exists a random
variable, X, such that E (|X|) â‰¤K and
lim
nâ†’âˆžXn (Ï‰) = X (Ï‰) a.e.
Also here is a generalization of the ItË†o isometry presented earlier.
Lemma 35.15 Let f be Ht adapted in the sense that every component is Ht adapted
and f âˆˆL2 (â„¦; Rn). Here Ht is the ï¬ltration deï¬ned in Lemma 35.12. Then
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
0
f (s)T dB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
= ||f||L2(â„¦Ã—[0,T ];Rn) .

950
STOCHASTIC PROCESSES
Proof: Let f an adapted bounded step function. Say
f (t) =
mâˆ’1
X
i=0
aiX[ti,ti+1) (t) .
Then
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
0
f (s)T dB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
L2(â„¦)
=
Z
â„¦
X
i,j
aT
i
Â¡
Bti+1 âˆ’Bti
Â¢
aT
j
Â¡
Btj+1 âˆ’Btj
Â¢
dP
For a mixed term in which i Ì¸= j, this integrates to 0 by independence of the
increments. Thus this reduces to
Z
â„¦
X
i
aT
i
Â¡
Bti+1 âˆ’Bti
Â¢
aT
i
Â¡
Bti+1 âˆ’Bti
Â¢
dP.
Next one uses the independence of the increments of diï¬€erent components of n
dimensional Brownian motion. Thus the above equals
X
i
Z
â„¦
X
r,s
air (âˆ†Btir) ais (âˆ†Btis) dP
=
X
i
Z
â„¦
X
r
a2
ir (âˆ†Btir)2 dP
=
X
i
Z
â„¦
X
r
a2
irdPâˆ†ti =
X
i
Z
â„¦
|ai|2 dPâˆ†ti
=
Z T
0
Z
â„¦
|f|2 dPdt.
This proves the lemma for step functions. Now for f as given, let {fk}âˆž
k=1 be a
sequence of step functions for which
Z T
0
f T dB = lim
kâ†’âˆž
Z T
0
f T
k dB a.e., ||fk âˆ’f||L2(â„¦Ã—[0,T ];Rn) â†’0.
Then by what was just shown,
nR T
0 f T
k dB
o
is Cauchy in L2 (â„¦) . Therefore, it
converges in L2 (â„¦) to some g âˆˆL2 (â„¦) . A subsequence converges to g pointwise
which shows g =
R T
0 f T dB. Therefore,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
0
f T dB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
=
lim
kâ†’âˆž
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
0
f T
k dB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
=
lim
kâ†’âˆž||fk||L2(â„¦Ã—[0,T ];Rn) = ||f||L2(â„¦Ã—[0,T ];Rn)

35.3.
SOME REPRESENTATION THEOREMS
951
and this proves this higher dimensional version of ItË†oâ€™s isometry.
Now with these lemmas and theorem, it is possible to prove a really interesting
lemma about density of certain kinds of functions in L2 (â„¦, HT , P) .
Lemma 35.16 Let Ht be the ï¬ltration alluded to in Lemma 35.12 deï¬ned in terms
of the n dimensional Brownian motion. Then random variables of the form
Ï† (Bt1, Â· Â· Â·, Btk)
where t1 < t2 Â· Â·Â· < tk is a ï¬nite increasing sequence of rational points in [0, T] and
Ï† âˆˆCâˆž
c
Â¡
RkÂ¢
are dense in L2 (â„¦, HT , P). Here the set of random variables includes
all such ï¬nite increasing lists of rational points of [0, T].
Proof: Let g âˆˆL2 (â„¦, HT , P) . Also let {tj}âˆž
j=1 be the rational points of [0, T] .
Now letting {s1, Â· Â· Â·, sn} = {t1, Â· Â· Â·, tn} such that s1 < s2 < Â· Â· Â· < sn, let Hn denote
the smallest Ïƒ algebra which contains
(Bs1, Â· Â· Â·, Bsn)âˆ’1 (U)
for all U an open subset of Rn. By Lemma 35.12 HT must be the completion of
the Ïƒ algebra, âˆªâˆž
n=1Hn and so g has a representative which is âˆªâˆž
n=1Hn measurable.
Therefore, without loss of generality, one can assume g is âˆªâˆž
n=1Hn measurable.
Now consider the martingale,
{E (gM|Hn)}âˆž
n=1
where
gM (Ï‰) â‰¡
ï£±
ï£²
ï£³
g (Ï‰) if g (Ï‰) âˆˆ[âˆ’M, M]
M if g (Ï‰) > M
âˆ’M if g (Ï‰) < âˆ’M
and M is chosen large enough that
||g âˆ’gM||L2(â„¦) < Îµ/4.
(35.31)
Now the terms of this martingale are uniformly bounded by M because
|E (gM|Hn)| â‰¤E (|gM| |Hn) â‰¤E (M|Hn) = M.
It follows the martingale is certainly bounded in L1 and so the martingale con-
vergence theorem stated above can be applied, and so there exists f measurable
in âˆªâˆž
n=1Hn such that E (gM|Hn) (Ï‰) â†’f (Ï‰) a.e. Also |f (Ï‰)| â‰¤M. Now letting
A âˆˆâˆªâˆž
n=1Hn, it follows from the dominated convergence theorem that
Z
A
fdP = lim
nâ†’âˆž
Z
A
E (gM|Hn) dP =
Z
A
gMdP
Since A is an arbitrary set in âˆªâˆž
n=1Hn, this shows f = gM. Also, the functions,
{E (gM|Hn)}âˆž
n=1 are uniformly bounded and so they are bounded in Lp (â„¦, âˆªâˆž
n=1Hn, P)

952
STOCHASTIC PROCESSES
for p > 2. Therefore, these functions are uniformly integrable and so by the Vitali
convergence theorem,
ÂµZ
â„¦
(gM âˆ’E (gM|Hn))2 dP
Â¶1/2
â†’0
as n â†’âˆž. It follows m can be chosen large enough that
||E (gM|Hm) âˆ’gM||L2(â„¦) < Îµ/4.
(35.32)
Now by the Doob Dynkin lemma listed above, there exists a Borel measurable,
h : Rnm â†’R such that
E (gM|Hm) = h (Bt1, Â· Â· Â·, Btm) a.e.
Of course h is not in Câˆž
c (Rnm) . Let Î»(Bt1,Â·Â·Â·,Btm) be the distribution of the random
vector (Bt1, Â· Â· Â·, Btm) . Thus Î»(Bt1,Â·Â·Â·,Btm) is a Radon measure and so there exists
Ï† âˆˆCc (Rnm) such that
ÂµZ
â„¦
|E (gM|Hm) âˆ’Ï† (Bt1, Â· Â· Â·, Btm)|2 dP
Â¶1/2
=
ÂµZ
â„¦
|h (Bt1, Â· Â· Â·, Btm) âˆ’Ï† (Bt1, Â· Â· Â·, Btm)|2 dP
Â¶1/2
=
ÂµZ
Rnm |h (x1, Â· Â· Â·, xm) âˆ’Ï† (x1, Â· Â· Â·, xm)|2 dÎ»(Bt1,Â·Â·Â·,Btm)
Â¶1/2
< Îµ/4.
By convolving with a molliï¬er, one can assume that Ï† âˆˆCâˆž
c (Rnm) also. It follows
from 35.31 and 35.32 that
||g âˆ’Ï† (Bt1, Â· Â· Â·, Btm)||L2
â‰¤
||g âˆ’gM||L2 + ||gM âˆ’E (gM|Hm)||L2
+ ||E (gM|Hm) âˆ’Ï† (Bt1, Â· Â· Â·, Btm)||L2
â‰¤
3
Â³Îµ
4
Â´
< Îµ
This proves the lemma.
In this lemma and the following theorems, HT continues to be the completion
of the smallest Ïƒ algebra which contains
(Bs1, Â· Â· Â·, Bsk)âˆ’1 (B)
for all increasing sequences, s1 < Â· Â· Â· < sk and B a Borel set of Rnk.
Lemma 35.17 Let h (t) be a deterministic step function of the form
h (t) =
mâˆ’1
X
i=0
aiX[ti,ti+1).

35.3.
SOME REPRESENTATION THEOREMS
953
Then for h of this form, linear combinations of functions of the form
exp
ÃƒZ T
0
hT dB âˆ’1
2
Z T
0
h Â· hdt
!
(35.33)
are dense in L2 (â„¦, HT , P) .
Proof: I will show in the process of the proof that functions of the form 35.33
are in L2 (â„¦, P). If the conclusion of the lemma is not true, there exists nonzero
g âˆˆL2 (â„¦, HT , P) such that
Z
â„¦
g (Ï‰) exp
ÃƒZ T
0
hT dB âˆ’1
2
Z T
0
h Â· hdt
!
dP
=
exp
Ãƒ
âˆ’1
2
Z T
0
h Â· hdt
! Z
â„¦
g (Ï‰) exp
ÃƒZ T
0
hT dB
!
dP = 0
for all such h. Letting h be given as above,
Z T
0
hT dB
=
mâˆ’1
X
i=0
aT
i
Â¡
Bti+1 âˆ’Bti
Â¢
(35.34)
=
m
X
i=1
aT
iâˆ’1Bti âˆ’
mâˆ’1
X
i=0
aT
i Bti
=
mâˆ’1
X
i=1
Â¡
aT
iâˆ’1 âˆ’aT
i
Â¢
Bti + aT
0 Bt0 + aT
nâˆ’1Btn.
(35.35)
Also 35.34 shows exp
Â³R T
0 hT dB
Â´
is in L2 (â„¦, P) . To see this recall the Bti+1 âˆ’Bti
are independent and the density of Bti+1 âˆ’Bti is
C (n, âˆ†ti) exp
Ãƒ
âˆ’1
2
|x|2
(ti+1 âˆ’ti)
!
so
Z
â„¦
Ãƒ
exp
ÃƒZ T
0
hT dB
!!2
dP =
Z
â„¦
exp
Ãƒ
2
Z T
0
hT dB
!
dP

954
STOCHASTIC PROCESSES
=
Z
â„¦
exp
Ãƒmâˆ’1
X
i=0
2aT
i
Â¡
Bti+1 âˆ’Bti
Â¢
!
dP
=
Z
â„¦
mâˆ’1
Y
i=0
exp
Â¡
2aT
i
Â¡
Bti+1 âˆ’Bti
Â¢Â¢
dP
=
mâˆ’1
Y
i=0
Z
â„¦
exp
Â¡
2aT
i
Â¡
Bti+1 âˆ’Bti
Â¢Â¢
dP
=
mâˆ’1
Y
i=0
Z
Rn C (n, âˆ†ti) exp
Â¡
2aT
i x
Â¢
exp
Ãƒ
âˆ’1
2
|x|2
âˆ†ti
!
dx < âˆž
Choosing the ai appropriately in 35.35, the formula in 35.35 is of the form
mâˆ’1
X
i=0
yT
i Bti
where yi is an arbitrary vector in Rn. It follows that for all choices of yj âˆˆRn,
Z
â„¦
g (Ï‰) exp
ï£«
ï£­
mâˆ’1
X
j=0
yT
j Btj (Ï‰)
ï£¶
ï£¸dP = 0.
Now the mapping
y = (y1, Â· Â· Â·, ym) â†’
Z
â„¦
g (Ï‰) exp
ï£«
ï£­
mâˆ’1
X
j=0
yT
j Btj (Ï‰)
ï£¶
ï£¸dP
is analytic on Cmn and equals zero on Rnm so from standard complex variable the-
ory, this analytic function must equal zero on Cnm, not just on Rnm. In particular,
for all y = (y1, Â· Â· Â·, ym) âˆˆRnm,
Z
â„¦
g (Ï‰) exp
ï£«
ï£­
mâˆ’1
X
j=0
iyT
j Btj (Ï‰)
ï£¶
ï£¸dP = 0.
(35.36)
Now pick Ï† âˆˆCâˆž
c (Rn) . Thus Ï† is in the Schwartz class and from the theory of
Fourier transforms,
Ï† (x) =
1
(2Ï€)mn/2
Z
Rmn eiyÂ·xFÏ† (y) dy.
In particular,
Ï†
Â¡
Bt0 (Ï‰) , Â· Â· Â·, Btmâˆ’1 (Ï‰)
Â¢
=
1
(2Ï€)mn/2
Z
Rmn exp
ï£«
ï£­
mâˆ’1
X
j=0
iyT
j Btj (Ï‰)
ï£¶
ï£¸FÏ† (y) dy.

35.3.
SOME REPRESENTATION THEOREMS
955
Therefore,
Z
â„¦
g (Ï‰) Ï†
Â¡
Bt0 (Ï‰) , Â· Â· Â·, Btmâˆ’1 (Ï‰)
Â¢
dP
=
1
(2Ï€)mn/2
Z
â„¦
g (Ï‰)
Z
Rmn exp
ï£«
ï£­
mâˆ’1
X
j=0
iyT
j Btj (Ï‰)
ï£¶
ï£¸FÏ† (y) dydP
=
1
(2Ï€)mn/2
Z
Rmn
Z
â„¦
g (Ï‰) exp
ï£«
ï£­
mâˆ’1
X
j=0
iyT
j Btj (Ï‰)
ï£¶
ï£¸dPFÏ† (y) dy
=
1
(2Ï€)mn/2
Z
Rmn 0FÏ† (y) dy = 0
which shows by Lemma 35.16 that g = 0 after all, contrary to assumption. This
proves the lemma.
Why such a funny lemma? It is because of the following computation which
depends on ItË†oâ€™s formula. First lets review ItË†oâ€™s formula. For
dXt = udt + V dB
where u is a vector and V a matrix, and Y = g (t, X) ,
dYk = âˆ‚gk
âˆ‚t (t, Xt) dt + D2gk (t, Xt) dXt + 1
2dXT
t Hk (t, Xt) dXt
where dtdBk = 0, dt2 = 0, and, dBidBj = Î´ijdt. In the above, Hk is the hessian
matrix of gk. Thus this reduces to
dYk
=
âˆ‚gk
âˆ‚t (t, Xt) dt + D2gk (t, Xt) (udt + V dB)
+1
2 (udt + V dB)T Hk (t, Xt) (udt + V dB)
=
Âµâˆ‚gk
âˆ‚t (t, Xt) + D2gk (t, Xt) u + 1
2tr
Â¡
V T HkV
Â¢Â¶
dt + D2gk (t, Xt) V dB
In the above case, referring to 35.33, let
X =
Z t
0
hT dB âˆ’1
2
Z t
0
h Â· hdt
and g (x) = ex so Y = eX. Then in this case, g is a scalar valued function of one
variable and so the above formula reduces to
dY
=
Âµ
âˆ’1
2eX |h|2 + 1
2eXtr
Â³
hhT Â´Â¶
dt + eXhT dB
=
Âµ
âˆ’1
2eX |h|2 + 1
2eX |h|2
Â¶
dt + eXhT dB
=
Y hT dB

956
STOCHASTIC PROCESSES
Hence
Y
=
Y0 +
Z t
0
Y hT dB
=
1 +
Z t
0
Y hT dB.
Now here is the interesting part of this formula.
E
ÂµZ t
0
Y hT dB
Â¶
= 0
because the integrand is an adapted step function and E
Â¡
Btj+1 âˆ’Btj
Â¢
= 0. There-
fore, letting F = Y,
F = E (F) +
Z T
0
f (t, Ï‰)T dB
(35.37)
It follows that for F âˆˆL2 (â„¦, HT , P) of the special form described in Lemma 35.17,
there exists an adapted function in L2 (â„¦; Rn), f such that 35.37 holds. Does such a
function f exist for all F âˆˆL2 (â„¦, HT , P)? The answer is yes and this is the content
of the next theorem which is called the ItË†o representation theorem.
Theorem 35.18 Let F âˆˆL2 (â„¦, HT , P) . Then there exists a unique Ht adapted
f âˆˆL2 (â„¦Ã— [0, T] ; Rn) such that
F = E (F) +
Z T
0
f (s, Ï‰)T dB.
Proof: By Lemma 35.17, functions of the form
exp
ÃƒZ T
0
hT dB âˆ’1
2
Z T
0
h Â· hdt
!
where h is a vector valued deterministic step function of the sort described in this
lemma, are dense in L2 (â„¦, HT , P). Given F âˆˆL2 (â„¦, HT , P) , {Gk}âˆž
k=1 be functions
in the subspace of linear combinations of the above functions which converge to F in
L2 (â„¦, HT , P). For each of these functions there exists fk an adapted step function
such that
Gk = E (Gk) +
Z T
0
fk (s, Ï‰)T dB.

35.3.
SOME REPRESENTATION THEOREMS
957
Then from the ItË†o isometry, and the observation that E (Gk âˆ’Gl)2 â†’0 as k, l â†’âˆž
by the above deï¬nition of Gk in which the Gk converge to F in L2 (â„¦) ,
0
=
lim
k,lâ†’âˆžE
Â³
(Gk âˆ’Gl)2Â´
=
lim
k,lâ†’âˆžE
ï£«
ï£­
Ãƒ
E (Gk) +
Z T
0
fk (s, Ï‰)T dBâˆ’
Ãƒ
E (Gl) +
Z T
0
fl (s, Ï‰)T dB
!!2ï£¶
ï£¸
=
lim
k,lâ†’âˆž
(
E (Gk âˆ’Gl)2 + 2E (Gk âˆ’Gl)
Z
â„¦
Z T
0
(fk âˆ’fl)T dBdP
+
Z
â„¦
ÃƒZ T
0
(fk âˆ’fl)T dB
!2
dP
ï£¼
ï£½
ï£¾
=
lim
k,lâ†’âˆž
ï£±
ï£²
ï£³E (Gk âˆ’Gl)2 +
Z
â„¦
ÃƒZ T
0
(fk âˆ’fl)T dB
!2
dP
ï£¼
ï£½
ï£¾
=
lim
k,lâ†’âˆž
Z
â„¦
ÃƒZ T
0
(fk âˆ’fl)T dB
!2
dP =
lim
k,lâ†’âˆž||fk âˆ’fl||L2(â„¦Ã—[0,T ];Rn)
(35.38)
Going from the third to the fourth equations, is justiï¬ed because
R
â„¦
R T
0 (fk âˆ’fl)T dBdP =
0 thanks to the independence of the integrals and the fact fk âˆ’fl is an adapted step
function.
This shows {fk}âˆž
k=1 is a Cauchy sequence in L2 (â„¦Ã— [0, T] ; Rn) . It follows there
exists a subsequence and f âˆˆL2 (â„¦Ã— [0, T] ; Rn) such that fk converges to f point-
wise and in L2 (â„¦Ã— [0, T] ; Rn) with f BÃ—HT measurable. Then by the ItË†o isometry
and the equation
Gk = E (Gk) +
Z T
0
fk (s, Ï‰)T dB
you can pass to the limit as k â†’âˆžand obtain
F = E (F) +
Z T
0
f (s, Ï‰)T dB
where f is adapted because of the pointwise convergence. Thus if N is the B Ã— HT
measurable set of m Ã— P measure zero, where convergence does not take place,
Z T
0
Z
â„¦
XN (t, Ï‰) dPdt = 0
and so for a.e. t,
R
â„¦XNdP = 0 and so fk (t, Ï‰) â†’f (t, Ï‰) for a.e. Ï‰ except for t in a
set of measure zero. Now each fk (t, Â·) is Ht measurable and since Ht is complete,
it follows f (t, Â·) is also Ht measurable. Now redeï¬ne f (t, Ï‰) â‰¡0 for all t in this
exceptional set of measure zero. Then the resulting f must be Ht adapted. This
proves the existence part of this theorem.

958
STOCHASTIC PROCESSES
It remains to consider the uniqueness. Suppose then that
F = E (F) +
Z T
0
f (t, Ï‰)T dB = E (F) +
Z T
0
f1 (t, Ï‰)T dB.
Then
Z T
0
f (t, Ï‰)T dB =
Z T
0
f1 (t, Ï‰)T dB
and so
Z T
0
Â³
f (t, Ï‰)T âˆ’f1 (t, Ï‰)T Â´
dB = 0
and by the ItË†o isometry,
0 =
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z T
0
Â³
f (t, Ï‰)T âˆ’f1 (t, Ï‰)T Â´
dB
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
L2(â„¦)
= ||f âˆ’f 1||L2(â„¦Ã—[0,T ];Rn)
which proves uniqueness. This proves the theorem.
With the above major result, here is another interesting representation theorem.
Recall that if you have an Ht adapted function, f and f âˆˆL2 (â„¦Ã— [0, T]) , then
R t
0 f T dB is a martingale. This was proved in Theorem 34.12 for the case of one
dimensional Brownian motion but it will end up being true for the general case
also. The next theorem is sort of a converse. It starts with an Ht martingale and
represents it as an ItË†o integral. In this theorem, Ht continues to be the ï¬ltration
determined by n dimensional Brownian motion.
Theorem 35.19 Let Mt be an Ht martingale and suppose Mt âˆˆL2 (â„¦) for all
t â‰¥0. Then there exists a unique stochastic process, g (s, Ï‰) such that g is Ht
adapted and in L2 (â„¦Ã— [0, t]) for each t > 0, and for all t â‰¥0,
Mt = E (M0) +
Z t
0
gT dB
Proof: First suppose f is an adapted function of the sort that g is. Then the
following claim is the ï¬rst step in the proof.
Claim: Let t1 < t2. Then
E
ÂµZ t2
t1
f T dB|Ht1
Â¶
= 0
Proof of claim: First consider the claim in the case that f is an adapted step
function of the form
f (t) =
nâˆ’1
X
i=0
aiX[ti,ti+1) (t)
Then
Z t2
t1
f T dB (Ï‰) =
nâˆ’1
X
i=0
aT
i (Ï‰)
Â¡
Bti+1 (Ï‰) âˆ’Bti (Ï‰)
Â¢
.

35.3.
SOME REPRESENTATION THEOREMS
959
Now letting A âˆˆHt1
Z
A
E
ÂµZ t2
t1
f T dB|Ht1
Â¶
dP
â‰¡
Z
A
Z t2
t1
f T dBdP =
Z
A
nâˆ’1
X
i=0
aT
i (Ï‰)
Â¡
Bti+1 (Ï‰) âˆ’Bti (Ï‰)
Â¢
dP
=
nâˆ’1
X
i=0
Z
â„¦
XA (Ï‰) aT
i (Ï‰)
Â¡
Bti+1 (Ï‰) âˆ’Bti (Ï‰)
Â¢
dP
=
nâˆ’1
X
i=0
Z
â„¦
XA (Ï‰) aT
i (Ï‰) dP
Z
â„¦
Â¡
Bti+1 (Ï‰) âˆ’Bti (Ï‰)
Â¢
dP = 0.
Since A is arbitrary, E
Â³R t2
t1 f T dB|Ht1
Â´
= 0. This proves the claim in the case that
f is an adapted step function. The general case follows from this in the usual way.
If f is not a step function, there is a sequence of adapted step functions, {fk} such
that
Z t2
t1
f T
k dB â†’
Z t2
t1
f T dB
in L2 (â„¦, P) and ||fk âˆ’f||L2(â„¦Ã—[t1,t2];Rn) â†’0. Then using the ItË†o isometry,
Z
â„¦
Âµ
E
ÂµZ t2
t1
f T
k dB|Ht1
Â¶
âˆ’E
ÂµZ t2
t1
f T dB|Ht1
Â¶Â¶2
dP
=
Z
â„¦
E
ÂµZ t2
t1
f T
k dB âˆ’
Z t2
t1
f TdB|Ht1
Â¶2
dP
=
Z
â„¦
ÂµZ t2
t1
f T
k dB âˆ’
Z t2
t1
f TdB
Â¶2
dP =
Z
â„¦
ÂµZ t2
t1
Â¡
f T
k âˆ’f TÂ¢
dB
Â¶2
dP
=
||fk âˆ’f||L2(â„¦Ã—[t1,t2];Rn) â†’0
Thus the desired conclusion holds in the general case as well.
Now to prove the theorem, it follows from Theorem 35.18 and the assumption
that Mt is a martingale that for t > 0 there exists f t âˆˆL2 (â„¦Ã— [0, T] ; Rn) such that
Mt
=
E (Mt) +
Z t
0
f t (s, Â·)T dB
=
E (M0) +
Z t
0
f t (s, Â·)T dB.
Now let t1 < t2. Then since Mt is a martingale,
Mt1 = E (Mt2|Ht1) = E
Âµ
E (M0) +
Z t2
0
f t2 (s, Â·)T dB|Ht1
Â¶

960
STOCHASTIC PROCESSES
= E (M0) + E
ÂµZ t1
0
f t2 (s, Â·)T dB+
Z t2
t1
f t2 (s, Â·)T dB|Ht1
Â¶
=
E (M0) + E
ÂµZ t1
0
f t2 (s, Â·)T dB|Ht1
Â¶
=
E (M0) +
Z t1
0
f t2 (s, Â·)T dB
because
R t1
0 f t2 (s, Â·)T dB is Ht1 measurable. Thus
Mt1 = E (M0) +
Z t1
0
f t2 (s, Â·)T dB = E (M0) +
Z t1
0
f t1 (s, Â·)T dB
and so
0 =
Z t1
0
f t1 (s, Â·)T dBâˆ’
Z t1
0
f t2 (s, Â·)T dB
and so by the ItË†o isometry,
Â¯Â¯Â¯Â¯f t1 âˆ’f t2Â¯Â¯Â¯Â¯
L2(â„¦Ã—[0,t1];Rn) = 0.
Letting N âˆˆN, it follows that
Mt = E (M0) +
Z t
0
f N (s, Â·)T dB
for all t â‰¤N. Let g = f N for t âˆˆ[0, N] . Then asside from a set of measure zero,
this is well deï¬ned and for all t â‰¥0
Mt = E (M0) +
Z t
0
g (s, Â·)T dB
This proves the theorem.
Surely this is an incredible theorem. Note it implies all the martingales which
are in L2 for each t must be continuous a.e. Also, any such martingale satisï¬es
M0 = E (M0) . Isnâ€™t that amazing?
35.4
Stochastic Diï¬€erential Equations
35.4.1
Gronwallâ€™s Inequality
The fundamental tool in estimating diï¬€erential equations is Gronwallâ€™s inequality.
It is a very elementary result but of enormous signiï¬cance. I will ï¬rst give a proof
of this important theorem. Also, I will write X (t) rather than Xt.

35.4.
STOCHASTIC DIFFERENTIAL EQUATIONS
961
Lemma 35.20 Let k â‰¥0 and suppose u (t) is a Lebesgue measurable function in
L1 ([0, T]) which satisï¬es
u (t) â‰¤u0 +
Z t
0
ku (s) ds.
Then
u (t) â‰¤u0ekt.
Proof: Let
f (t) = u0ekt âˆ’
Âµ
u0 +
Z t
0
ku (s) ds
Â¶
.
Then f (0) = 0 and
f â€² (t)
=
ku0ekt âˆ’ku (t)
â‰¥
ku0ekt âˆ’k
Âµ
u0 +
Z t
0
ku (s) ds
Â¶
=
kf (t)
and so f â€² (t) âˆ’kf (t) â‰¥0 and so
d
dt
Â¡
eâˆ’ktf (t)
Â¢
â‰¥0
which implies f (t) â‰¥0. Hence
u (t) â‰¤u0 +
Z t
0
ku (s) ds â‰¤u0ekt.
This proves Gronwallâ€™s inequality.
35.4.2
Review Of ItË†o Integrals And A Filtration
Next recall the deï¬nition of the ItË†o integral. The context is that Ht is a ï¬ltration,
Bt is a martingale for Ht, and if s > t, Bs âˆ’Bt is independent of Ht.
Deï¬nition 35.21 Suppose f is Ht adapted and B Ã— F measurable such that for
Ï‰ /âˆˆE a set of measure zero,
Z T
S
f (t, Ï‰)2 dt < âˆž.
Then there exists a sequence of adapted bounded step functions, {Ï†n} satisfying
Z T
S
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt â‰¤2âˆ’n

962
STOCHASTIC PROCESSES
for Ï‰ /âˆˆE, a set of measure zero. Then for t âˆˆ[S, T] , the ItË†o integral is deï¬ned by
Z t
S
fdB (Ï‰) = lim
nâ†’âˆž
Z t
S
Ï†ndB (Ï‰) .
Furthermore, for these Ï‰, t â†’
R t
S fdB (Ï‰) is continuous because by Theorem 34.5
the convergence of
R t
S Ï†ndB (Ï‰) is uniform on [0, T].
In what follows Bt will be m dimensional Brownian motion and the ï¬ltration
will be denoted by Ht where Ht is the completion of the smallest Ïƒ algebra which
contains
(Bt0, Â· Â· Â·, Btk)âˆ’1 (U)
whenever 0 â‰¤t0 < Â· Â· Â· < tk â‰¤t and U is a Borel set. Also, Z, a measurable Rn
valued function will be independent of Ht for all t > 0. Then HZ
t will denote the
completion of the smallest Ïƒ algebra which contains
Â¡
Z, Bt0, Â· Â· Â·, Btk
Â¢âˆ’1 (U)
whenever 0 â‰¤t0 < Â· Â· Â· < tk â‰¤t and U is a Borel set. Then the following lemma is
what is needed to consider certain ItË†o integrals.
Lemma 35.22 Bt is an HZ
t martingale and if s > t, the increments Bs âˆ’Bt are
independent of HZ
t .
Proof: Let A, Uk, V for k = 0, Â· Â· Â·, p be open sets and let s > t and
D =
Â¡
Z, Bt0, Â· Â· Â·, Btp
Â¢âˆ’1 (A Ã— U0 Ã— Â· Â· Â· Ã— Up) , E = (Bs âˆ’Bt)âˆ’1 (V ) .
I need to verify that P (D âˆ©E) = P (D) P (E) .
D âˆ©E = Zâˆ’1 (A) âˆ©âˆ©p
i=0Bâˆ’1
ti (Ui) âˆ©E
From independence of Z to Ht for all t > 0, and independence of the increments,
Bs âˆ’Bt to Ht,
P (D âˆ©E)
=
P
Â¡
Zâˆ’1 (A)
Â¢
P
Â¡
âˆ©p
i=0Bâˆ’1
ti (Ui) âˆ©E
Â¢
=
P
Â¡
Zâˆ’1 (A)
Â¢
P
Â¡
âˆ©p
i=0Bâˆ’1
ti (Ui)
Â¢
P (E)
=
P
Â¡
Zâˆ’1 (A) âˆ©âˆ©p
i=0Bâˆ’1
ti (Ui)
Â¢
P (E)
=
P (D) P (E) .
It follows that for all D an inverse image of an open set and E of the above form
where V is open, P (D âˆ©E) = P (D) P (E). It follows easily this holds for all D
and E inverse images of Borel sets. If D âˆˆHt and E = (Bs âˆ’Bt)âˆ’1 (V ) then there
exists D1 an inverse image of a Borel set such that D1 âŠ‡D and P (D1 \ D) = 0 so
P (D âˆ©E)
=
P (D1 âˆ©E)
=
P (D1) P (E) = P (D) P (E) .

35.4.
STOCHASTIC DIFFERENTIAL EQUATIONS
963
This veriï¬es the independence.
Now let A âˆˆHZ
t . Then from the above independence result,
Z
A
E
Â¡
Bs âˆ’Bt|HZ
t
Â¢
dP
=
Z
A
Bs âˆ’BtdP
=
Z
A
dP
Z
â„¦
Bs âˆ’BtdP = 0
and so
E
Â¡
Bs|HZ
t
Â¢
=
E
Â¡
Bs âˆ’Bt + Bt|HZ
t
Â¢
=
0 + E
Â¡
Bt|HZ
t
Â¢
= Bt.
This proves the lemma.
35.4.3
A Function Space
Lemma 35.23 Let C
Â¡
[0, T] ; L2 (â„¦)pÂ¢
denote the space of continuous functions
with values in L2 (â„¦)p and for each Î» â‰¥0, denote for X âˆˆC
Â¡
[0, T] ; L2 (â„¦)pÂ¢
||X||Î» â‰¡max
n
eâˆ’Î»t ||X (t)||L2(â„¦)p : t âˆˆ[0, T]
o
Then all these norms are equivalent and
Â¡
C
Â¡
[0, T] ; L2 (â„¦)pÂ¢
, ||Â·||Î»
Â¢
is a Banach
space. Suppose also that Gt is a ï¬ltration and that X (t) is Gt measurable. Then by
changing X (t) There exists a B Ã— F measurable function, Y such that for each
t, Y (t) is Gt measurable and for all t not in a Borel measurable set of mea-
sure zero, X (t) = Y (t) in L2 (â„¦)p .Furthermore, if VG denotes those functions
in C
Â¡
[0, T] ; L2 (â„¦)pÂ¢
which are Gt adapted, then VG is a closed subspace of
C
Â¡
[0, T] ; L2 (â„¦)pÂ¢
.
Proof: The assertion about the norms and the Banach space are all obvious.
The main message is about the measurability assertions. Let P â‰¡{t0, Â· Â· Â·, tn} be
a partition of [0, T] of the usual sort where 0 = t0 < t1 < Â· Â· Â· < tn = T. Then for
X âˆˆC
Â¡
[0, T] ; L2 (â„¦)pÂ¢
and Gt adapted, consider
XP (t) â‰¡
n
X
k=1
X (tkâˆ’1) X[tkâˆ’1,tk) (t) .
By the assumption of continuity of X, it follows ||X âˆ’XP ||Î» â†’0 as ||P|| â†’0
where ||P|| is the norm of the partition given by max {|ti+1 âˆ’ti|} . Picking Î» = 0
for convenience, it follows there exists a sequence of partitions, {Pn} such that
||X âˆ’XPn||0 < 2âˆ’n. Therefore, for each t âˆˆ[0, T] , XPn (t) (Ï‰) â†’X (t) (Ï‰) a.e. Ï‰.
It follows X (t) is Gt measurable.

964
STOCHASTIC PROCESSES
Now each XPn is B Ã— F measurable because it is a ï¬nite sum of such functions.
It follows {XPn} is a Cauchy sequence in L2 ([0, T] Ã— â„¦)p and so there exists Y
which is B Ã— F measurable and XPn converges to Y in L2 ([0, T] Ã— â„¦)p . Now
t â†’
Z
â„¦
|XPn âˆ’Y|2 dP
is measurable and so taking the limit as n â†’âˆž, it follows
t â†’
Z
â„¦
|X âˆ’Y|2 dP
is also measurable. Also
Z T
0
Z
â„¦
|X âˆ’Y|2 dPdt
â‰¤
2
ÃƒZ T
0
Z
â„¦
|X âˆ’XPn|2 dPdt +
Z T
0
Z
â„¦
|XPn âˆ’Y|2 dPdt
!
and both these integrals converge to 0 as n â†’âˆž. Therefore, there is a Borel set of
measure zero, N âŠ†[0, T] such that for t /âˆˆN,
Z
â„¦
|X (t) âˆ’Y (t)|2 dP = 0
and it follows that for such t,
X (t) = Y (t) in L2 (â„¦)p .
For t in the exceptional set, modify Y (t) by setting it equal to 0. Then Y is Gt
adapted.
It only remains to consider the last claim about VG. Suppose {Xn}âˆž
n=1 âŠ†VG and
||Xn âˆ’Y||Î» â†’0. I need to verify Y is Gt adapted. However, taking a subsequence,
still called n and letting Î» = 0 for convenience, it can be assumed
||Xn âˆ’Y||0 < 2âˆ’n
and so it follows for each t âˆˆ[0, T] , Xn (t) (Ï‰) â†’Y (t) (Ï‰) a.e. Ï‰. It follows since
(â„¦, Gt, P) is complete, Y (t) is Gt measurable for each t. This proves the lemma.
35.4.4
An Extension Of The ItË†o Integral
Now I will give a deï¬nition of the ItË†o integral on VG.
It is assumed here that
Gt is a ï¬ltration with the property that m dimensional Brownian motion, Bt is a
martingale for it and if s > t, Bs âˆ’Bt is independent of Gt so it makes sense to
speak of an ItË†o integral,
R t
0 XT dB given X is Gt adapted, B Ã— F measurable and in
L2 ([0, T] Ã— â„¦)m. Here is the deï¬nition.

35.4.
STOCHASTIC DIFFERENTIAL EQUATIONS
965
Deï¬nition 35.24 Let X âˆˆVG. Then
Z t
0
XT dB â‰¡
Z t
0
YT dB in L2 (â„¦)p
where Y is a Gt adapted function which is B Ã— F measurable and Y (t) = X (t) in
L2 (â„¦)p for a.e. t âˆˆ[0, T].
Lemma 35.25 The above deï¬nition is well deï¬ned.
Proof: Suppose both Y and Y1 work as described in the deï¬nition. Then
||Y âˆ’Y1||L2([0,T ]Ã—â„¦)p = 0
and so by the ItË†o isometry,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z t
0
Â¡
YT âˆ’YT
1
Â¢
dB
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
L2(â„¦)p = 0
which shows
R t
0 YT dB =
R t
0 YT
1 dB in L2 (â„¦)p. This proves the lemma.
For x âˆˆRp, b (t, x) âˆˆRm and Ïƒ (t, x) will be an p Ã— m matrix. It is assumed
that for given x, y âˆˆRp the following measurability and Lipschitz conditions hold.
t â†’b (t, x) , t â†’Ïƒ (t, x) are Lebesgue measurable,
(35.39)
|b (t, x) âˆ’b (t, y)| + |Ïƒ (t, x) âˆ’Ïƒ (t, y)| â‰¤K |x âˆ’y| ,
(35.40)
|b (t, x)| + |Ïƒ (t, x)| â‰¤C (1 + |x|) .
(35.41)
In the above, it suï¬ƒces to have the components of b and Ïƒ measurable. Also,the
norm refers to any convenient norm. This does not matter because all the norms
on a ï¬nite dimensional vector space are equivalent.
Deï¬nition 35.26 Let Gt be a ï¬ltration for which Bt is a martingale and such that
for s > t, Bs âˆ’Bt is independent of Gt. For X product measurable in B Ã— F and
Gt adapted deï¬ne
ÂµZ t
0
Ïƒ (s, X) dB
Â¶
k
â‰¡
Z t
0
(Ïƒ (s, X))k dB
where (Ïƒ (s, X))k refers to the kth row of the matrix, Ïƒ.
35.4.5
A Vector Valued Deterministic Integral
Lemma 35.27 Let X âˆˆC
Â¡
[0, T] ; L2 (â„¦)pÂ¢
and let b be given as above. Then
t â†’
Z
â„¦
b (t, X (t)) dP

966
STOCHASTIC PROCESSES
is Lebesgue measurable. It is also possible to deï¬ne an integral, having values in
L2 (â„¦)p according to the following formula in which [a, b] âŠ†[0, T].
ÃƒZ b
a
b (t, X (t)) dt, h
!
L2(â„¦)p
â‰¡
Z b
a
(b (t, X (t)) , h)L2(â„¦)p dt
The integral deï¬ned in this way satisï¬es all the usual algebraic properties for inte-
grals and
t â†’
Z t
a
b (s, X (s)) ds
is continuous as a function with values in L2 (â„¦)p. Also if X is Gt adapted for Gt a
ï¬ltration, then
Z b
a
b (s, X (s)) ds
is Gb measurable.
Proof: Let XPn (t) be the sequence of step functions converging to X (t) which
is described in Lemma 35.23. Then on [tj, tj+1),
Z
â„¦
b (t, XPn (t)) dP =
Z
â„¦
b (t, X (tj)) dP
where X (tj) âˆˆL2 (â„¦)p . It follows X (tj) is the pointwise limit of simple functions
of the form Pm
k=1 ckXEk (Ï‰) which also converge to X (tj) in L2 (â„¦)p. Thus for
t âˆˆ[tj, tj+1),
Z
â„¦
b
Ãƒ
t,
m
X
k=1
ckXEk (Ï‰)
!
dP =
m
X
k=1
Z
Ek
b (t, ck) dP,
a measurable function of t. Now let {Sn} be a sequence of these simple functions
converging to X (tj) in L2 (â„¦)p. Then
Â¯Â¯Â¯Â¯
Z
â„¦
b (t, X (tj)) dP âˆ’
Z
â„¦
b (t, Sn) dP
Â¯Â¯Â¯Â¯
â‰¤
Z
â„¦
K |Sn âˆ’X (tj)| dP
â‰¤
K ||Sn âˆ’X (tj)||L2(â„¦)p
and so
R
â„¦b (t, X (tj)) dP is a pointwise limit of Lebesgue measurable functions on
[tj, tj+1). It follows
R
â„¦b (t, XPn (t)) dP is Lebesgue measurable. Using a similar
argument to what was just done, this converges to
R
â„¦b (t, X (t)) dP, and so this
last integral is also Lebesgue measurable in t. By a repeat of the above arguments
or by simple specializing to b having real values, it follows
t â†’
Z
â„¦
|b (t, X (t))| dP

35.4.
STOCHASTIC DIFFERENTIAL EQUATIONS
967
is Lebesgue measurable. Also, using the properties of b and Holderâ€™s inequality, if
Xn â†’X in C
Â¡
[0, T] ; L2 (â„¦)pÂ¢
,
Â¯Â¯Â¯Â¯
Z
â„¦
|b (t, X (t))|2 dt âˆ’
Z
â„¦
|b (t, Xn (t))|2 dt
Â¯Â¯Â¯Â¯ â‰¤C ||X (t) âˆ’Xn (t)||2
L2(â„¦)p .
Therefore, exploiting the same sorts of arguments involving ï¬rst approximating by
step functions and then by simple functions, it follows t â†’
R
â„¦|b (t, X (t))|2 dt is
Lebesgue measurable.
Next consider the deï¬nition of the integral. From the ï¬rst part,
t â†’(b (t, X (t)) , h)L2(â„¦)p
is Lebesgue measurable and also
Â¯Â¯Â¯Â¯Â¯
Z b
a
(b (t, X (t)) , h)L2(â„¦)p dt
Â¯Â¯Â¯Â¯Â¯ â‰¤
Z b
a
||b (t, X (t))||2
L2(â„¦)p dt ||h||L2(â„¦)p .
Letting Î› (h) â‰¡
R b
a (b (t, X (t)) , h)L2(â„¦)p dt, it follows Î› is a continuous linear func-
tional on L2 (â„¦)p and so by the Riesz representation theorem, there exists a unique
element of L2 (â„¦)p denoted by
Z b
a
b (t, X (t)) dt
such that
ÃƒZ b
a
b (t, X (t)) dt, h
!
L2(â„¦)p
=
Z b
a
(b (t, X (t)) , h)L2(â„¦)p dt.
This completes the deï¬nition of the integral.
It is obvious the integral satisï¬es all the usual algebraic properties. Consider
the claim about continuity. Let s < t. Then
Â¯Â¯Â¯Â¯Â¯
ÂµZ s
a
b (r, X (r)) dr âˆ’
Z t
a
b (r, X (r)) dr, h
Â¶
L2(â„¦)p
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯
ÂµZ t
s
b (r, X (r)) , h
Â¶
L2(â„¦)p
Â¯Â¯Â¯Â¯Â¯ â‰¤
Z t
s
Â¯Â¯Â¯(b (r, X (r)) , h)L2(â„¦)p
Â¯Â¯Â¯ dr
â‰¤C
Z t
s
||b (r, X (r))||L2(â„¦)p dr ||h||L2(â„¦)p
â‰¤Câ€² (t âˆ’s)1/2 ||h||L2(â„¦)p .
It follows
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z s
a
b (r, X (r)) dr âˆ’
Z t
a
b (r, X (r)) dr
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
L2(â„¦)p â‰¤Câ€² |t âˆ’s|1/2 .

968
STOCHASTIC PROCESSES
The last assertion follows from approximating by step functions as in Lemma
35.23, noting the step functions are Gb measurable and then passing to a limit to
obtain the desired conclusion. This proves the lemma.
35.4.6
The Existence And Uniqueness Theorem
In the next lemma, the two integrals are as deï¬ned above.
Lemma 35.28 Let b and Ïƒ satisfy 35.39 - 35.41. Let Z be a random vector which
is either independent of Ht for all t > 0 or else is measurable with respect to Ht for
all t and suppose
Z
â„¦
|Z|2 dP < âˆž
Let Gt = HZ
t in the ï¬rst case and let Gt = Ht in the second. Then there exists a
unique solution, X âˆˆVG to the integral equation,
X (t) = Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB.
Proof: For X âˆˆVG, supplied with the norm ||Â·||Î» described above, let
Î¦X (t) â‰¡Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB
It follows from Corollary 31.43 on Page 890 and Lemmas 34.8 on Page 925 and
Lemma 35.27 that Î¦X is Gt adapted and B Ã— F measurable. The deterministic
integral is a continuous function of t with values in L2 (â„¦)p by Lemma 35.27. The
same is true of the ItË†o integral. To see this, let Y be adapted and product measur-
able and equal to X for a.e. t. Then by the ItË†o isometry and the above deï¬nition
of this integral of functions in VG,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z t
0
Ïƒ (r, X (r)) dBâˆ’
Z s
0
Ïƒ (r, X (r)) dB
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
2
L2(â„¦)p
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z t
0
Ïƒ (r, Y (r)) dBâˆ’
Z s
0
Ïƒ (r, Y (r)) dB
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
2
L2(â„¦)p
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z t
s
Ïƒ (r, Y (r)) dB
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
2
L2(â„¦)p =
Z t
s
Z
â„¦
|Ïƒ (r, Y (r))|2 dPdr
â‰¤
2C
Z t
s
Z
â„¦
Â³
1 + |Y (r)|2Â´
dPdr = 2C
Z t
s
Z
â„¦
Â³
1 + |X (r)|2Â´
dPdr
which converges to 0 as s â†’t. Thus Î¦ : VG â†’VG.
In fact, if Î» is large enough, Î¦ is a contraction mapping. I will show this next.
Let X, Y âˆˆVG and let X1, Y1 be corresponding measurable representatives as

35.4.
STOCHASTIC DIFFERENTIAL EQUATIONS
969
above. By the ItË†o isometry,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯eâˆ’Î»t
ÂµZ t
0
Ïƒ (s, X (s)) dBâˆ’
Z t
0
Ïƒ (s, Y (s)) dB
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
2
L2(â„¦)p
â‰¤
eâˆ’Î»t
Z t
0
Z
â„¦
|Ïƒ (s, X1 (s)) âˆ’Ïƒ (s, Y1 (s))|2 dPds
â‰¤
Keâˆ’Î»t
Z t
0
Z
â„¦
|X1 (s) âˆ’Y1 (s)|2 dPds
=
Keâˆ’Î»t
Z t
0
eÎ»s
Âµ
eâˆ’Î»s
Z
â„¦
|X (s) âˆ’Y (s)|2 dP
Â¶
ds
â‰¤
K
Z t
0
eÎ»(sâˆ’t)ds ||X âˆ’Y||Î» â‰¤K 1
Î» ||X âˆ’Y||Î» .
Thus if Î» is large enough, this term is a contraction. Similar but easier reasoning
applies to the deterministic integral in the deï¬nition of Î¦. Therefore, by the usual
contraction mapping theorem, Î¦ has a unique ï¬xed point in VG. This proves the
lemma.
Theorem 35.29 Let b and Ïƒ satisfy 35.39 - 35.41.
Let Z be a random vector
which is either independent of Ht for all t > 0 or else is measurable with respect to
Ht for all t and suppose
Z
â„¦
|Z|2 dP < âˆž
Let Gt = HZ
t in the ï¬rst case and let Gt = Ht in the second. Then there exists a
B Ã— F measurable function, Y âˆˆL2 ([0, T] Ã— â„¦)p and a set of measure zero, N such
that for Ï‰ /âˆˆN,
Y (t) (Ï‰) = Z +
Z t
0
b (s, Y (s) (Ï‰)) ds +
Z t
0
Ïƒ (s, Y (s)) dB (Ï‰)
for all t âˆˆ[0, T].
Proof: Let X be the solution of Lemma 35.28. Thus
X (t) = Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB.
Now let eY be B Ã— F measurable, adapted, in L2 ([0, T] Ã— â„¦)p , and eY (t) = X (t)
a.e. t. Letting h âˆˆL2 (â„¦)p , the deï¬nition of the ï¬rst integral in the above implies
Â¯Â¯Â¯Â¯Â¯
ÂµZ t
0
b (s, X (s)) ds âˆ’
Z t
0
b
Â³
s, eY (s) (Â·)
Â´
ds, h
Â¶
L2(â„¦)p
Â¯Â¯Â¯Â¯Â¯

970
STOCHASTIC PROCESSES
â‰¤
Z t
0
Â³
b (s, X (s)) âˆ’b
Â³
s, eY (s)
Â´
, h
Â´
L2(â„¦)p ds
â‰¤
K
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯X (s) âˆ’eY (s)
Â¯Â¯Â¯
Â¯Â¯Â¯
L2(â„¦)p ds ||h||L2(â„¦)p = 0
and so
Z t
0
b (s, X (s)) ds =
Z t
0
b
Â³
s, eY (s)
Â´
ds in L2 (â„¦)p .
It follows that in L2 (â„¦)p ,
X (t) = Z +
Z t
0
b
Â³
s, eY (s)
Â´
ds +
Z t
0
Ïƒ
Â³
s, eY (s)
Â´
dB
(35.42)
where now the ï¬rst integral on the right is the usual thing given by
Z t
0
b
Â³
s, eY (s)
Â´
ds (Ï‰) =
Z t
0
b
Â³
s, eY (s) (Ï‰)
Â´
ds
Also, for a.e. Ï‰, t â†’eY (t) (Ï‰) is a function in L2 (0, T) and from the theory of
the ItË†o integral,
R t
0 Ïƒ
Â³
s, eY (s)
Â´
dB is a continuous function of t for Ï‰ not in a set of
measure zero. Therefore, for Ï‰ oï¬€a set of measure zero, the right side of 35.42 is
continuous in t. It also delivers an adapted product measurable function, Y. Thus
for a.e. Ï‰, Y (t) (Ï‰) is a continuous function of t and
Y (t) = Z +
Z t
0
b
Â³
s, eY (s)
Â´
ds +
Z t
0
Ïƒ
Â³
s, eY (s)
Â´
dB
and so Y (t) = X (t) in L2 (â„¦)p for all t. Now this also shows Y (t) = eY (t) for a.e.
t. Hence by the ItË†o isometry, the right side of the above is unchanged in L2 (â„¦)p if eY
is replaced by Y. By the argument just given, the resulting right side is continuous
in t for a.e. Ï‰ and so there exists a set of measure zero such that for Ï‰ not in this
set,
Y (t) (Ï‰) = Z +
Z t
0
b (s, Y (s) (Ï‰)) ds +
Z t
0
Ïƒ (s, Y (s)) dB (Ï‰)
and both sides are continuous functions of t. This proves the theorem.
Note there were two cases given for the initial condition in the above theorem.
The second is not very interesting. If Z is H0 measurable, then since B0 = x, a
constant, it follows H0 = {âˆ…, â„¦} so Z is a constant. However, if Z is a constant,
then it satisï¬es the ï¬rst condition.
Not surprisingly, the solution to the above theorem is unique. This is stated as
the following corollary which is the main result.
Corollary 35.30 Let b and Ïƒ satisfy 35.39 - 35.41. Let Z be a random vector
which is independent of Ht for all t > 0 and suppose
Z
â„¦
|Z|2 dP < âˆž

35.4.
STOCHASTIC DIFFERENTIAL EQUATIONS
971
Then there exists a unique HZ
t adapted solution, X âˆˆL2 ([0, T] Ã— â„¦)n to the integral
equation,
X (t) = Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB a.e. Ï‰
(35.43)
in the sense that if eX is another solution, then there exists a set of measure zero,
N such that for Ï‰ /âˆˆN, eX (t) = X (t) for all t âˆˆ[0, T].
Proof: The existence part of this proof is already done. Let N denote the union
of the exceptional sets corresponding to X and eX . Then from 35.43 and the various
assumptions on b and Ïƒ,it follows that for Ï‰ /âˆˆN,
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
2
â‰¤
2K2T
Z t
0
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
2
ds
+2
Â¯Â¯Â¯Â¯
Z t
0
Â³
Ïƒ (s, X (s)) âˆ’Ïƒ
Â³
s, eX (s)
Â´Â´
dB
Â¯Â¯Â¯Â¯
2
.
Then by the ItË†o isometry, this implies
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n
â‰¤
2K2T
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n ds
+2
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯Ïƒ (s, X (s)) âˆ’Ïƒ
Â³
s, eX (s)
Â´Â¯Â¯Â¯
Â¯Â¯Â¯
2
ds
â‰¤
CT
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n ds
(35.44)
and by assumption both X and eX are in L2 ([0, T] Ã— â„¦)n so t â†’
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n
is in L1 ([0, T]). By Gronwallâ€™s inequality, eX (t) = X (t) in L2 (â„¦)n for all t. It fol-
lows there exists a set of measure zero, N1 such that for Ï‰ /âˆˆN1,
Z T
0
Â¯Â¯Â¯ eX (t) âˆ’X (t)
Â¯Â¯Â¯
2
dt = 0
But for Ï‰ /âˆˆN, the functions, eX and X are continuous and so if Ï‰ /âˆˆN1 âˆªN, eX (t) =
X (t) for all t. This proves the corollary.
Note that if diï¬€erent initial conditions had been given, say Z and Z1, the above
argument for uniqueness also gives a continuous dependence result with no eï¬€ort.
In fact, 35.44 then would take the form
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n â‰¤3 ||Z âˆ’Z1||2
L2(â„¦)n + CT
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n ds

972
STOCHASTIC PROCESSES
and Gronwallâ€™s inequality would then imply
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n â‰¤C ||Z âˆ’Z1||2
L2(â„¦)n
for some constant, C.
The equivalent form of the above integral equation,
X (t) = Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB
is
dX = b (t, X) dt + Ïƒ (t, X (t)) dB, X (0) = Z.
35.4.7
Some Simple Examples
Here are some examples of simple stochastic diï¬€erential equations which are solved
using the ItË†o formula.
Example 35.31 In this example, m = n = 1 and B is one dimensional Brownian
motion. The diï¬€erential equation is
dX = h (t) XdB, X (0) = 1
Obviously, one would want to do something like dX
X = h (t) dB. However, you
have to follow the rules. Let g (x) = ln (x) and Y = g (X) . Then by the ItË†o formula,
dY
=
1
X dX + 1
2
Âµ âˆ’1
X2
Â¶
dX2
=
1
X h (t) XdB âˆ’1
2
1
X2 h (t)2 X2dB2
=
h (t) dB âˆ’1
2h (t)2 dt
and also Y (0) = 0. Therefore, Y (t) = ln (X (t)) =
R t
0 h (s) dB âˆ’1
2
R t
0 h (t)2 dt and
so
X (t) = exp
ÂµZ t
0
h (s) dB âˆ’1
2
Z t
0
h (s)2 ds
Â¶
Note the extra term, âˆ’1
2
R t
0 h (s)2 ds.
Example 35.32 Let m = n = 1.
dX = f (t) Xdt + h (t) XdB, X (0) = 1.

35.4.
STOCHASTIC DIFFERENTIAL EQUATIONS
973
In this case it is a lot like the above example but it has an extra f (t) Xdt. This
suggests something useful might be obtained by letting Y = ln (X) as was done
earlier. Thus
dY
=
1
X (Xf (t) dt + h (t) XdB) + 1
2
Âµ âˆ’1
X2
Â¶
(f (t) dt + h (t) XdB)2
=
1
X (Xf (t) dt + h (t) XdB) + 1
2
Âµ âˆ’1
X2
Â¶
h (t)2 X2dB2
=
1
X
Âµ
Xf (t) dt âˆ’1
2Xh (t)2 dt + h (t) XdB
Â¶
=
Âµ
f (t) âˆ’1
2h (t)2
Â¶
dt + h (t) dB
and so ln (X) =
R t
0
Â³
f (s) âˆ’1
2h (s)2Â´
ds +
R t
0 h (s) dB and so
X (t) = exp
ÂµZ t
0
Âµ
f (s) âˆ’1
2h (s)2
Â¶
ds +
Z t
0
h (s) dB
Â¶
The next example is a model for stock prices. Learn this model and get rich.
Example 35.33 For P (t) the price of stock,
dP = ÂµPdt + ÏƒPdB
In this model, Âµ is called the drift and Ïƒ is called the volatility.
It is just a special case of the above model in which f (t) = Âµ and h (t) = Ïƒ.
Then from the above,
P (t) = exp
Âµ
tÂµ âˆ’1
2tÏƒ2 + ÏƒBt
Â¶
Example 35.34 This example is called the Brownian bridge.
dX = âˆ’X
1 âˆ’t + dB, X (0) = 0.
This is also a special case in which f (t) = 1/ (t âˆ’1) and h (t) = 1. Thus the
solution is
X (t)
=
exp
ÂµZ t
0
Âµ
1
t âˆ’1 âˆ’1
2
Â¶
ds + Bt
Â¶
=
exp
Âµ1
2
Z t
0
Âµt âˆ’3
t âˆ’1
Â¶
ds + Bt
Â¶
=
exp
Âµ1
2t
Âµt âˆ’3
t âˆ’1
Â¶
+ Bt
Â¶
Before doing another example I will give a simple lemma on integration by parts.
In this lemma B will denote m dimensional Brownian motion.

974
STOCHASTIC PROCESSES
Lemma 35.35 Let (t, Ï‰) â†’g (t, Ï‰) be an Gt adapted measurable function such that
P
ÂµZ t
0
|g (s, Ï‰)|2 ds < âˆž
Â¶
= 1
where Bt is a martingale with respect to the ï¬ltration Gt and the increments, Bsâˆ’Bt
for s > t are independent of Gt so that the ItË†o integral,
R t
0 gT dB is deï¬ned. Suppose
also that t â†’g (t, Ï‰) is C1 and B0 = 0. Then
Z t
0
gT (s, Ï‰) dB = gT (t, Ï‰) Bt (Ï‰) âˆ’
Z t
0
âˆ‚gT
âˆ‚t (s, Ï‰) B (s) ds a.e.
Proof: Let gn (t) â‰¡Pnâˆ’1
k=0 g (tk) X[tk,tk+1) (t) where tk = k (t/n) . Then by the
deï¬nition of the ItË†o integral,
Z t
0
gT dB
=
lim
nâ†’âˆž
Z t
0
gT
n dB = lim
nâ†’âˆž
nâˆ’1
X
k=0
g (tk)T Â¡
Btk+1 âˆ’Btk
Â¢
=
lim
nâ†’âˆž
Ãƒ n
X
k=1
g (tkâˆ’1)T Btk âˆ’
nâˆ’1
X
k=0
g (tk)T Btk
!
=
lim
nâ†’âˆž
"Â³
g (tnâˆ’1)T Bt
Â´
âˆ’
nâˆ’1
X
k=1
Â³
g (tk)T âˆ’g (tkâˆ’1)T Â´
Btk
#
=
g (t, Ï‰) Bt (Ï‰) âˆ’
Z t
0
âˆ‚gT
âˆ‚t (s, Ï‰) B (s, Ï‰) ds a.e. Ï‰.
Example 35.36 Linear systems of equations. Here B is m dimensional Brownian
motion. The equation of interest is
dX = (AX + h (t)) dt + KdB, X (0) = X0
where X0 is a random vector in Rm which is independent of Ht for all t â‰¥0 and
A, K are constant m Ã— m matrices. Then I will show
X (t) = eAt
Âµ
X0 +
Z t
0
Â¡
eâˆ’Ash (s) + eâˆ’AsAKB (s)
Â¢
ds + eâˆ’AtKB (t)
Â¶
Let Y (t) = eâˆ’AtX (t) . Then from the above,
dY
=
âˆ’Aeâˆ’AtX + eâˆ’AtIdX+1
2eâˆ’AtdXT 0dX
=
âˆ’Aeâˆ’AtX + eâˆ’AtI ((AX + h (t)) dt + KdB)
=
eâˆ’Ath (t) dt + eâˆ’AtKdB.
Hence using integration by parts,
eâˆ’AtX (t) âˆ’X0
=
Z t
0
eâˆ’Ash (s) ds +
Z t
0
eâˆ’AsKdB
=
Z t
0
eâˆ’Ash (s) ds + eâˆ’AtKB (t) + A
Z t
0
eâˆ’AsKB (s) ds

35.5.
A DIFFERENT PROOF OF EXISTENCE AND UNIQUENESS
975
and so
X (t)
=
eAt
Âµ
X0 +
Z t
0
eâˆ’Ash (s) ds + eâˆ’AtKB (t) + A
Z t
0
eâˆ’AsKB (s) ds
Â¶
=
eAt
Âµ
X0 +
Z t
0
Â¡
eâˆ’Ash (s) + eâˆ’AsAKB (s)
Â¢
ds + eâˆ’AtKB (t)
Â¶
.(35.45)
In this formula eâˆ’As is the matrix, M (t) which solves M â€² = AM, M (0) = I.
Note that formally diï¬€erentiating the above equation gives
Xâ€²
=
AeAt
Âµ
X0 +
Z t
0
Â¡
eâˆ’Ash (s) + eâˆ’AsAKB (s)
Â¢
ds + eâˆ’AtKB (t)
Â¶
+eAt
ÂµÂ¡
eâˆ’Ath (t) + eâˆ’AtAKB (t)
Â¢
âˆ’Aeâˆ’AtKB (t) + eâˆ’AtK dB
dt
Â¶
and so
Xâ€²
=
AX + h (t) + AKB (t) âˆ’AKB (t) + K dB
dt
=
AX + h (t) + K dB
dt .
Of course this is total nonsense because B is known to not be diï¬€erentiable. How-
ever, multiplying by dt gives
dX = (AX + h (t)) dt + KdB
and the formula 35.45 shows X (0) = X0. This was the original diï¬€erential equation.
Note that it was not necessary to assume very much about X0 to write 35.45.
35.5
A Diï¬€erent Proof Of Existence And Unique-
ness
The proof given here is much longer and uses Picard Iteration directly. However, it
requires much less background material so the over all presentation is shorter.
35.5.1
Gronwallâ€™s Inequality
The fundamental tool in estimating diï¬€erential equations is Gronwallâ€™s inequality.
It is a very elementary result but of enormous signiï¬cance. I will ï¬rst give a proof
of this important theorem. Also, I will write X (t) rather than Xt.
Lemma 35.37 Let k â‰¥0 and suppose u (t) is a Lebesgue measurable function in
L1 ([0, T]) which satisï¬es
u (t) â‰¤u0 +
Z t
0
ku (s) ds.

976
STOCHASTIC PROCESSES
Then
u (t) â‰¤u0ekt.
Proof: Let
f (t) = u0ekt âˆ’
Âµ
u0 +
Z t
0
ku (s) ds
Â¶
.
Then f (0) = 0 and
f â€² (t)
=
ku0ekt âˆ’ku (t)
â‰¥
ku0ekt âˆ’k
Âµ
u0 +
Z t
0
ku (s) ds
Â¶
=
kf (t)
and so f â€² (t) âˆ’kf (t) â‰¥0 and so
d
dt
Â¡
eâˆ’ktf (t)
Â¢
â‰¥0
which implies f (t) â‰¥0. Hence
u (t) â‰¤u0 +
Z t
0
ku (s) ds â‰¤u0ekt.
This proves Gronwallâ€™s inequality.
35.5.2
Review Of ItË†o Integrals
Next recall the deï¬nition of the ItË†o integral. The context is that Ht is a ï¬ltration,
Bt is a martingale for Ht, and if s > t, Bs âˆ’Bt is independent of Ht.
Deï¬nition 35.38 Suppose f is Ht adapted and B Ã— F measurable such that for
Ï‰ /âˆˆE a set of measure zero,
Z T
S
f (t, Ï‰)2 dt < âˆž.
Then there exists a sequence of adapted bounded step functions, {Ï†n} satisfying
Z T
S
(f (t, Ï‰) âˆ’Ï†n (t, Ï‰))2 dt â‰¤2âˆ’n
for Ï‰ /âˆˆE, a set of measure zero. Then for t âˆˆ[S, T] , the ItË†o integral is deï¬ned by
Z t
S
fdB (Ï‰) = lim
nâ†’âˆž
Z t
S
Ï†ndB (Ï‰) .
Furthermore, for these Ï‰, t â†’
R t
S fdB (Ï‰) is continuous because by Theorem 34.5
the convergence of
R t
S Ï†ndB (Ï‰) is uniform on [0, T].

35.5.
A DIFFERENT PROOF OF EXISTENCE AND UNIQUENESS
977
In what follows Bt will be m dimensional Brownian motion and the ï¬ltration
will be denoted by Ht where Ht is the completion of the smallest Ïƒ algebra which
contains
(Bt0, Â· Â· Â·, Btk)âˆ’1 (U)
whenever 0 â‰¤t0 < Â· Â· Â· < tk â‰¤t and U is a Borel set. Also, Z, a measurable Rn
valued function will be independent of Ht for all t > 0. Then HZ
t will denote the
completion of the smallest Ïƒ algebra which contains
Â¡
Z, Bt0, Â· Â· Â·, Btk
Â¢âˆ’1 (U)
whenever 0 â‰¤t0 < Â· Â· Â· < tk â‰¤t and U is a Borel set. Then the following lemma is
what is needed to consider certain ItË†o integrals.
Lemma 35.39 Bt is an HZ
t martingale and if s > t, the increments Bs âˆ’Bt are
independent of HZ
t .
Proof: Let A, Uk, V for k = 0, Â· Â· Â·, p be open sets and let s > t and
D =
Â¡
Z, Bt0, Â· Â· Â·, Btp
Â¢âˆ’1 (A Ã— U0 Ã— Â· Â· Â· Ã— Up) , E = (Bs âˆ’Bt)âˆ’1 (V ) .
I need to verify that P (D âˆ©E) = P (D) P (E) .
D âˆ©E = Zâˆ’1 (A) âˆ©âˆ©p
i=0Bâˆ’1
ti (Ui) âˆ©E
From independence of Z to Ht for all t > 0, and independence of the increments,
Bs âˆ’Bt to Ht,
P (D âˆ©E)
=
P
Â¡
Zâˆ’1 (A)
Â¢
P
Â¡
âˆ©p
i=0Bâˆ’1
ti (Ui) âˆ©E
Â¢
=
P
Â¡
Zâˆ’1 (A)
Â¢
P
Â¡
âˆ©p
i=0Bâˆ’1
ti (Ui)
Â¢
P (E)
=
P
Â¡
Zâˆ’1 (A) âˆ©âˆ©p
i=0Bâˆ’1
ti (Ui)
Â¢
P (E)
=
P (D) P (E) .
It follows that for all D an inverse image of an open set and E of the above form
where V is open, P (D âˆ©E) = P (D) P (E). It follows easily this holds for all D
and E inverse images of Borel sets. If D âˆˆHt and E = (Bs âˆ’Bt)âˆ’1 (V ) then there
exists D1 an inverse image of a Borel set such that D1 âŠ‡D and P (D1 \ D) = 0 so
P (D âˆ©E)
=
P (D1 âˆ©E)
=
P (D1) P (E) = P (D) P (E) .
This veriï¬es the independence.
Now let A âˆˆHZ
t . Then from the above independence result,
Z
A
E
Â¡
Bs âˆ’Bt|HZ
t
Â¢
dP
=
Z
A
Bs âˆ’BtdP
=
Z
A
dP
Z
â„¦
Bs âˆ’BtdP = 0

978
STOCHASTIC PROCESSES
and so
E
Â¡
Bs|HZ
t
Â¢
=
E
Â¡
Bs âˆ’Bt + Bt|HZ
t
Â¢
=
0 + E
Â¡
Bt|HZ
t
Â¢
= Bt.
This proves the lemma.
For x âˆˆRn, b (t, x) âˆˆRm and Ïƒ (t, x) will be an n Ã— m matrix. It is assumed
that for given x, y âˆˆRn the following measurability and Lipschitz conditions hold.
t â†’b (t, x) , t â†’Ïƒ (t, x) are Lebesgue measurable,
(35.46)
|b (t, x) âˆ’b (t, y)| + |Ïƒ (t, x) âˆ’Ïƒ (t, y)| â‰¤K |x âˆ’y| ,
(35.47)
|b (t, x)| + |Ïƒ (t, x)| â‰¤C (1 + |x|) .
(35.48)
In the above, it suï¬ƒces to have the components of b and Ïƒ measurable. Also,the
norm refers to any convenient norm. This does not matter because all the norms
on a ï¬nite dimensional vector space are equivalent.
Deï¬nition 35.40 Let Gt be a ï¬ltration for which Bt is a martingale and such that
for s > t, Bs âˆ’Bt is independent of Gt. For X product measurable in B Ã— F and
Gt adapted deï¬ne
ÂµZ t
0
Ïƒ (s, X) dB
Â¶
k
â‰¡
Z t
0
(Ïƒ (s, X))k dB
where (Ïƒ (s, X))k denotes the kth row of the matrix, Ïƒ.
35.5.3
The Existence And Uniqueness Theorem
Theorem 35.41 Let b and Ïƒ satisfy 35.46 - 35.48.
Let Z be a random vector
which is either independent of Ht for all t > 0 or else is measurable with respect to
Ht for all t and suppose
Z
â„¦
|Z|2 dP < âˆž
Let Gt = HZ
t in the ï¬rst case and let Gt = Ht in the second. Then there exists a
solution, X to the integral equation,
X (t) = Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB a.e. Ï‰
This solution satisï¬es X âˆˆL2 ([0, T] Ã— â„¦)n.
Proof: Let iterates be deï¬ned as follows.
X1 (t) â‰¡Z +
Z t
0
b (s, Z) ds +
Z t
0
Ïƒ (s, Z) dB

35.5.
A DIFFERENT PROOF OF EXISTENCE AND UNIQUENESS
979
The ItË†o integral on the right is well deï¬ned for all Ï‰ not in some set of measure
zero because Z is Gt adapted. Now also X1 is Gt adapted because both integrals in
the above yield Gt adapted functions of t by Theorem 34.8 on Page 925 and the ItË†o
integral yields B Ã— F measurable function by Corollary 31.43 on Page 890 and the
convention mentioned after this corollary. Then
X2 (t) â‰¡Z +
Z t
0
b
Â¡
s, X1 (s)
Â¢
ds +
Z t
0
Ïƒ
Â¡
s, X1 (s)
Â¢
dB.
Continue this way. Each iteration involves a set of measure zero. Take the union of
all these sets, N. Then for Ï‰ /âˆˆN
Xk+1 (t) â‰¡Z +
Z t
0
b
Â¡
s, Xk (s)
Â¢
ds +
Z t
0
Ïƒ
Â¡
s, Xk (s)
Â¢
dB
(35.49)
and each Xk is Gt adapted and B Ã— F measurable. Now
Z
â„¦
Â¯Â¯Xk+1 (t) âˆ’Xk (t)
Â¯Â¯2 dP
â‰¤
TK
Z
â„¦
Z t
0
Â¯Â¯Xk (s) âˆ’Xkâˆ’1 (s)
Â¯Â¯2 ds
+
Z
â„¦
Â¯Â¯Â¯Â¯
Z t
0
Ïƒ
Â¡
s, Xk (s)
Â¢
âˆ’Ïƒ
Â¡
s, Xkâˆ’1 (s)
Â¢
dB
Â¯Â¯Â¯Â¯
2
dP.
Using the ItË†o isometry,
â‰¤
TK
Z t
0
Z
â„¦
Â¯Â¯Xk (s) âˆ’Xkâˆ’1 (s)
Â¯Â¯2 dPds
+
Z
â„¦
Z t
0
Â¯Â¯Ïƒ
Â¡
s, Xk (s)
Â¢
âˆ’Ïƒ
Â¡
s, Xkâˆ’1 (s)
Â¢Â¯Â¯2 dsdP
â‰¤
TK
Z t
0
Z
â„¦
Â¯Â¯Xk (s) âˆ’Xkâˆ’1 (s)
Â¯Â¯2 dPds
+K
Z t
0
Z
â„¦
Â¯Â¯Xk (s) âˆ’Xkâˆ’1 (s)
Â¯Â¯2 dPds
â‰¤
CT
Z t
0
Z
â„¦
Â¯Â¯Xk (s) âˆ’Xkâˆ’1 (s)
Â¯Â¯2 dPds
where CT is a constant depending on T and K. Then iterating this inequality yields
Z
â„¦
Â¯Â¯Xk+1 (t) âˆ’Xk (t)
Â¯Â¯2 dP
â‰¤
Ck
T
Z t
0
Z t1
0
Â· Â· Â·
Z tkâˆ’1
0
Z
â„¦
Â¯Â¯X1 (tk) âˆ’Z
Â¯Â¯2 dPdtk Â· Â· Â· dt1.

980
STOCHASTIC PROCESSES
Now
Z
â„¦
Â¯Â¯X1 (tk) âˆ’Z
Â¯Â¯2 dP
â‰¤
CT
ÃƒZ T
0
Z
â„¦
Â³
1 + |Z|2Â´
dPdt
!
â‰¡CZ < âˆž.
Then it follows
ÂµZ
â„¦
Â¯Â¯Xk+1 (t) âˆ’Xk (t)
Â¯Â¯2 dP
Â¶1/2
â‰¤
Âµ
Ck
T CZ
Z t
0
Z t1
0
Â· Â· Â·
Z tkâˆ’1
0
dtk Â· Â· Â· dt1
Â¶1/2
â‰¤
Âµ
Ck
T CZ
tk
k!
Â¶1/2
â‰¤
Âµ
Ck
T CZ
T k
k!
Â¶1/2
.
Since Pâˆž
k=0
Â³
Ck
T CZ T k
k!
Â´1/2
< âˆž, it follows
Â©
XkÂª
converges in C
Â¡
[0, T] ; L2 (â„¦)nÂ¢
to a function, f
X. It follows
Â©
XkÂª
is also Cauchy in L2 ([0, T] Ã— â„¦)n . Therefore,
there exists X, B Ã— F measurable and in L2 ([0, T] Ã— â„¦) such that upon taking
a suitable subsequence still denoted by k,
Â©
XkÂª
converges to X pointwise and in
L2 ([0, T] Ã— â„¦)n. The function, t â†’
R
â„¦
Â¯Â¯Â¯X âˆ’XkÂ¯Â¯Â¯
2
dP is Lebesgue measurable and
t â†’
R
â„¦
Â¯Â¯Â¯Xâˆ’eX
Â¯Â¯Â¯
2
dP is the limit so it is also Lebesgue measurable. Also,
Z T
0
Z
â„¦
Â¯Â¯Â¯Xâˆ’eX
Â¯Â¯Â¯
2
dPdt â‰¤2
ÃƒZ T
0
Z
â„¦
Â¯Â¯Â¯X âˆ’XkÂ¯Â¯Â¯
2
dPdt +
Z T
0
Z
â„¦
Â¯Â¯Â¯Xkâˆ’eX
Â¯Â¯Â¯
2
dPdt
!
and both of these integrals converge to 0 as k â†’âˆž, the ï¬rst because of convergence
in L2 ([0, T] Ã— â„¦)n and the second because of the uniform convergence of Xk to eX.
Therefore, X (t) = eX (t) in L2 (â„¦)n for a.e. t. Changing X (t) on this exceptional
set by setting it equal to 0, it follows X is product measurable and adapted because
it either is identically 0 on a set of measure zero or X (t) = eX (t) and it is clear eX
is adapted.
Now recall 35.49. Consider the ItË†o integral. By the ItË†o isometry and the Lips-
chitz property of Ïƒ,
nR t
0 Ïƒ
Â¡
s, Xk (s)
Â¢
dB
o
converges to
R t
0 Ïƒ (s, X (s)) dB in L2 (â„¦)n
for each t. Using the Lipschitz property of b, and passing to the limit in 35.49 the
following equation must hold in L2 (â„¦)n.
eX (t) â‰¡Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB
(35.50)
For a.e. Ï‰, the right side of the above is a continuous function of t. This is true of
the ItË†o integral and it also follows for the deterministic integral because of the ob-
servation that for a.e. Ï‰, s â†’X (s) (Ï‰) is in L2 (0, T) . For Ï‰ not in this exceptional
set of measure zero, deï¬ne
Y (t) (Ï‰) â‰¡Z +
Z t
0
b (s, X (s) (Ï‰)) ds +
Z t
0
Ïƒ (s, X (s)) dB (Ï‰)
(35.51)

35.5.
A DIFFERENT PROOF OF EXISTENCE AND UNIQUENESS
981
Thus Y (t) is adapted by Theorem 34.8 on Page 925 and Y is product measurable.
Also it follows from 35.50 that Y (t) = eX (t) in L2 (â„¦)n and X (t) = eX (t) for a.e. t
so Y (t) = X (t) a.e. t. It follows that
Y (t) â‰¡Z +
Z t
0
b (s, Y (s)) ds +
Z t
0
Ïƒ (s, Y (s)) dB
(35.52)
holds in L2 (â„¦)n for each t and so equality is also true in L2 ([0, T] Ã— â„¦)n . As before,
the right side is a continuous function of t for Ï‰ oï¬€a set of measure zero. Oï¬€a set
of measure zero, t â†’Y (t) (Ï‰) is also continuous. This follows from the deï¬nition
of Y (t) in 35.51. Since both sides are product measurable, there exists a set of
measure zero, N such that for Ï‰ /âˆˆN,
Z T
0
Â¯Â¯Â¯Â¯Y (t) âˆ’
Âµ
Z +
Z t
0
b (s, Y (s)) ds +
Z t
0
Ïƒ (s, Y (s)) dB
Â¶Â¯Â¯Â¯Â¯
2
dt = 0
and the integrand is a continuous function. Therefore, 35.52 holds a.e. and both
sides are continuous for Ï‰ not in a suitable set of measure zero. This proves the
theorem.
Note there were two cases given for the initial condition in the above theorem.
The second is not very interesting. If Z is H0 measurable, then since B0 = x, a
constant, it follows H0 = {âˆ…, â„¦} so Z is a constant. However, if Z is a constant,
then it satisï¬es the ï¬rst condition.
Not surprisingly, the solution to the above theorem is unique. This is stated as
the following corollary which is the main result.
Corollary 35.42 Let b and Ïƒ satisfy 35.46 - 35.48. Let Z be a random vector
which is independent of Ht for all t > 0 and suppose
Z
â„¦
|Z|2 dP < âˆž
Then there exists a unique HZ
t adapted solution, X âˆˆL2 ([0, T] Ã— â„¦)n to the integral
equation,
X (t) = Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB a.e. Ï‰
(35.53)
in the sense that if eX is another solution, then there exists a set of measure zero,
N such that for Ï‰ /âˆˆN, eX (t) = X (t) for all t âˆˆ[0, T].
Proof: The existence part of this proof is already done. Let N denote the union
of the exceptional sets corresponding to X and eX . Then from 35.53 and the various
assumptions on b and Ïƒ,it follows that for Ï‰ /âˆˆN,
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
2
â‰¤
2K2T
Z t
0
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
2
ds
+2
Â¯Â¯Â¯Â¯
Z t
0
Â³
Ïƒ (s, X (s)) âˆ’Ïƒ
Â³
s, eX (s)
Â´Â´
dB
Â¯Â¯Â¯Â¯
2
.

982
STOCHASTIC PROCESSES
Then by the ItË†o isometry, this implies
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n
â‰¤
2K2T
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n ds
+2
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯Ïƒ (s, X (s)) âˆ’Ïƒ
Â³
s, eX (s)
Â´Â¯Â¯Â¯
Â¯Â¯Â¯
2
ds
â‰¤
CT
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n ds
(35.54)
and by assumption both X and eX are in L2 ([0, T] Ã— â„¦)n so t â†’
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n
is in L1 ([0, T]). By Gronwallâ€™s inequality, eX (t) = X (t) in L2 (â„¦)n for all t. It fol-
lows there exists a set of measure zero, N1 such that for Ï‰ /âˆˆN1,
Z T
0
Â¯Â¯Â¯ eX (t) âˆ’X (t)
Â¯Â¯Â¯
2
dt = 0
But for Ï‰ /âˆˆN, the functions, eX and X are continuous and so if Ï‰ /âˆˆN1 âˆªN, eX (t) =
X (t) for all t. This proves the corollary.
Note that if diï¬€erent initial conditions had been given, say Z and Z1, the above
argument for uniqueness also gives a continuous dependence result with no eï¬€ort.
In fact, 35.54 then would take the form
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n â‰¤3 ||Z âˆ’Z1||2
L2(â„¦)n + CT
Z t
0
Â¯Â¯Â¯
Â¯Â¯Â¯X (s) âˆ’eX (s)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n ds
and Gronwallâ€™s inequality would then imply
Â¯Â¯Â¯
Â¯Â¯Â¯X (t) âˆ’eX (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(â„¦)n â‰¤C ||Z âˆ’Z1||2
L2(â„¦)n
for some constant, C.
The equivalent form of the above integral equation,
X (t) = Z +
Z t
0
b (s, X (s)) ds +
Z t
0
Ïƒ (s, X (s)) dB
is
dX = b (t, X) dt + Ïƒ (t, X (t)) dB, X (0) = Z.
35.5.4
Some Simple Examples
Here are some examples of simple stochastic diï¬€erential equations which are solved
using the ItË†o formula.

35.5.
A DIFFERENT PROOF OF EXISTENCE AND UNIQUENESS
983
Example 35.43 In this example, m = n = 1 and B is one dimensional Brownian
motion. The diï¬€erential equation is
dX = h (t) XdB, X (0) = 1
Obviously, one would want to do something like dX
X = h (t) dB. However, you
have to follow the rules. Let g (x) = ln (x) and Y = g (X) . Then by the ItË†o formula,
dY
=
1
X dX + 1
2
Âµ âˆ’1
X2
Â¶
dX2
=
1
X h (t) XdB âˆ’1
2
1
X2 h (t)2 X2dB2
=
h (t) dB âˆ’1
2h (t)2 dt
and also Y (0) = 0. Therefore, Y (t) = ln (X (t)) =
R t
0 h (s) dB âˆ’1
2
R t
0 h (t)2 dt and
so
X (t) = exp
ÂµZ t
0
h (s) dB âˆ’1
2
Z t
0
h (s)2 ds
Â¶
Note the extra term, âˆ’1
2
R t
0 h (s)2 ds.
Example 35.44 Let m = n = 1.
dX = f (t) Xdt + h (t) XdB, X (0) = 1.
In this case it is a lot like the above example but it has an extra f (t) Xdt. This
suggests something useful might be obtained by letting Y = ln (X) as was done
earlier. Thus
dY
=
1
X (Xf (t) dt + h (t) XdB) + 1
2
Âµ âˆ’1
X2
Â¶
(f (t) dt + h (t) XdB)2
=
1
X (Xf (t) dt + h (t) XdB) + 1
2
Âµ âˆ’1
X2
Â¶
h (t)2 X2dB2
=
1
X
Âµ
Xf (t) dt âˆ’1
2Xh (t)2 dt + h (t) XdB
Â¶
=
Âµ
f (t) âˆ’1
2h (t)2
Â¶
dt + h (t) dB
and so ln (X) =
R t
0
Â³
f (s) âˆ’1
2h (s)2Â´
ds +
R t
0 h (s) dB and so
X (t) = exp
ÂµZ t
0
Âµ
f (s) âˆ’1
2h (s)2
Â¶
ds +
Z t
0
h (s) dB
Â¶
The next example is a model for stock prices. Learn this model and get rich.

984
STOCHASTIC PROCESSES
Example 35.45 For P (t) the price of stock,
dP = ÂµPdt + ÏƒPdB
In this model, Âµ is called the drift and Ïƒ is called the volatility.
It is just a special case of the above model in which f (t) = Âµ and h (t) = Ïƒ.
Then from the above,
P (t) = exp
Âµ
tÂµ âˆ’1
2tÏƒ2 + ÏƒBt
Â¶
Example 35.46 This example is called the Brownian bridge.
dX = âˆ’X
1 âˆ’t + dB, X (0) = 0.
This is also a special case in which f (t) = 1/ (t âˆ’1) and h (t) = 1. Thus the
solution is
X (t)
=
exp
ÂµZ t
0
Âµ
1
t âˆ’1 âˆ’1
2
Â¶
ds + Bt
Â¶
=
exp
Âµ1
2
Z t
0
Âµt âˆ’3
t âˆ’1
Â¶
ds + Bt
Â¶
=
exp
Âµ1
2t
Âµt âˆ’3
t âˆ’1
Â¶
+ Bt
Â¶
Before doing another example I will give a simple lemma on integration by parts.
In this lemma B will denote m dimensional Brownian motion.
Lemma 35.47 Let (t, Ï‰) â†’g (t, Ï‰) be an Gt adapted measurable function such that
P
ÂµZ t
0
|g (s, Ï‰)|2 ds < âˆž
Â¶
= 1
where Bt is a martingale with respect to the ï¬ltration Gt and the increments, Bsâˆ’Bt
for s > t are independent of Gt so that the ItË†o integral,
R t
0 gT dB is deï¬ned. Suppose
also that t â†’g (t, Ï‰) is C1 and B0 = 0. Then
Z t
0
gT (s, Ï‰) dB = gT (t, Ï‰) Bt (Ï‰) âˆ’
Z t
0
âˆ‚gT
âˆ‚t (s, Ï‰) B (s) ds a.e.

35.5.
A DIFFERENT PROOF OF EXISTENCE AND UNIQUENESS
985
Proof: Let gn (t) â‰¡Pnâˆ’1
k=0 g (tk) X[tk,tk+1) (t) where tk = k (t/n) . Then by the
deï¬nition of the ItË†o integral,
Z t
0
gT dB
=
lim
nâ†’âˆž
Z t
0
gT
n dB = lim
nâ†’âˆž
nâˆ’1
X
k=0
g (tk)T Â¡
Btk+1 âˆ’Btk
Â¢
=
lim
nâ†’âˆž
Ãƒ n
X
k=1
g (tkâˆ’1)T Btk âˆ’
nâˆ’1
X
k=0
g (tk)T Btk
!
=
lim
nâ†’âˆž
"Â³
g (tnâˆ’1)T Bt
Â´
âˆ’
nâˆ’1
X
k=1
Â³
g (tk)T âˆ’g (tkâˆ’1)T Â´
Btk
#
=
g (t, Ï‰) Bt (Ï‰) âˆ’
Z t
0
âˆ‚gT
âˆ‚t (s, Ï‰) B (s, Ï‰) ds a.e. Ï‰.
Example 35.48 Linear systems of equations. Here B is m dimensional Brownian
motion. The equation of interest is
dX = (AX + h (t)) dt + KdB, X (0) = X0
where X0 is a random vector in Rm which is independent of Ht for all t â‰¥0 and
A, K are constant m Ã— m matrices. Then I will show
X (t) = eAt
Âµ
X0 +
Z t
0
Â¡
eâˆ’Ash (s) + eâˆ’AsAKB (s)
Â¢
ds + eâˆ’AtKB (t)
Â¶
Let Y (t) = eâˆ’AtX (t) . Then from the above,
dY
=
âˆ’Aeâˆ’AtX + eâˆ’AtIdX+1
2eâˆ’AtdXT 0dX
=
âˆ’Aeâˆ’AtX + eâˆ’AtI ((AX + h (t)) dt + KdB)
=
eâˆ’Ath (t) dt + eâˆ’AtKdB.
Hence using integration by parts,
eâˆ’AtX (t) âˆ’X0
=
Z t
0
eâˆ’Ash (s) ds +
Z t
0
eâˆ’AsKdB
=
Z t
0
eâˆ’Ash (s) ds + eâˆ’AtKB (t) + A
Z t
0
eâˆ’AsKB (s) ds
and so
X (t)
=
eAt
Âµ
X0 +
Z t
0
eâˆ’Ash (s) ds + eâˆ’AtKB (t) + A
Z t
0
eâˆ’AsKB (s) ds
Â¶
=
eAt
Âµ
X0 +
Z t
0
Â¡
eâˆ’Ash (s) + eâˆ’AsAKB (s)
Â¢
ds + eâˆ’AtKB (t)
Â¶
.(35.55)

986
STOCHASTIC PROCESSES
In this formula eâˆ’As is the matrix, M (t) which solves M â€² = AM, M (0) = I.
Note that formally diï¬€erentiating the above equation gives
Xâ€²
=
AeAt
Âµ
X0 +
Z t
0
Â¡
eâˆ’Ash (s) + eâˆ’AsAKB (s)
Â¢
ds + eâˆ’AtKB (t)
Â¶
+eAt
ÂµÂ¡
eâˆ’Ath (t) + eâˆ’AtAKB (t)
Â¢
âˆ’Aeâˆ’AtKB (t) + eâˆ’AtK dB
dt
Â¶
and so
Xâ€²
=
AX + h (t) + AKB (t) âˆ’AKB (t) + K dB
dt
=
AX + h (t) + K dB
dt .
Of course this is total nonsense because B is known to not be diï¬€erentiable. How-
ever, multiplying by dt gives
dX = (AX + h (t)) dt + KdB
and the formula 35.55 shows X (0) = X0. This was the original diï¬€erential equation.
Note that it was not necessary to assume very much about X0 to write 35.55.

Probability In Inï¬nite
Dimensions
I am following the book by Da Prato and Zabczyk for much of this material. [15].
36.1
Expected Value Covariance And Correlation
Let (â„¦, F, P) be a probability space. First recall the notion of expected value for a
scalar valued random variable, X denoted by
E (X) â‰¡
Z
â„¦
X (Ï‰) dP =
Z
R
xdÎ»X
where Î»X is a Radon measure which satisï¬es
Î»X (G) â‰¡P (X (Ï‰) âˆˆG) .
To speak of the expected value, it is necessary that X âˆˆL1 (â„¦; R) . Now the variance
is deï¬ned as
E
Â³
(X âˆ’E (X))2Â´
â‰¡
Z
â„¦
(X (Ï‰) âˆ’E (X))2 dP
and it is necessary that X âˆˆL2 (â„¦; R) .
What about random vectors where X has values in Rp? In this case, the expected
value would be a vector in Rp given by
E (X) â‰¡
Z
â„¦
X (Ï‰) dP
and the thing which takes the place of the variance is the covariance. This is a
linear transformation mapping Rp to Rp just as the variance could be considered a
linear transformation mapping R to R. The covariance is deï¬ned as
E
Â¡
(Xâˆ’E (X)) (Xâˆ’E (X))âˆ—Â¢
987

988
PROBABILITY IN INFINITE DIMENSIONS
Written in terms of the tensor product, this is
E ((Xâˆ’E (X)) âŠ—(Xâˆ’E (X))) .
Recall the way this works.
u âŠ—v (w) â‰¡(w, v) u.
If there are two random vectors, X and Y, X having values in Rp and Y having
values in Rq, the correlation is the linear transformation deï¬ned by
E ((Xâˆ’E (X)) âŠ—(Yâˆ’E (Y)))
or in terms of matrices,
E
Â¡
(Xâˆ’E (X)) (Yâˆ’E (Y))âˆ—Â¢
This all makes sense provided X and Y are in L2 (â„¦; Rr) where r = p or q because
you can simply integrate the entries of the matrix which results when you write
(Xâˆ’E (X)) (Yâˆ’E (Y))âˆ—.
What does it all mean in the case where X âˆˆL2 (â„¦; H) and Y âˆˆL2 (â„¦; G) for
H, G separable Hilbert spaces? In this case there is no â€œmatrixâ€. This involves the
notion of a Hilbert Schmidt operator.
Deï¬nition 36.1 Let H and G be two separable Hilbert spaces and let T map H to
G be continuous and linear. Then T is called a Hilbert Schmidt operator if there
exists some orthonormal basis for H, {ej} such that
X
j
||Tej||2 < âˆž.
The collection of all such linear maps will be denoted by L2 (H, G) .
For convenience I have restated Theorem 14.40 on Page 14.40 here.
Theorem 36.2 L2 (H, G) âŠ†L (H, G) and L2 (H, G) is a separable Hilbert space
with norm given by
||T||L2 â‰¡
ÃƒX
k
||Tek||2
!1/2
where {ek} is some orthonormal basis for H. Also
||T|| â‰¤||T||L2 .
(36.1)
All Hilbert Schmidt opearators are compact. Also if X âˆˆH and Y âˆˆG, then
Y âŠ—X âˆˆL2 (H, G) ,
and
||Y âŠ—X||L2 = ||X||H ||Y ||G .
(36.2)

36.1.
EXPECTED VALUE COVARIANCE AND CORRELATION
989
Now if X âˆˆL1 (â„¦, H) ,
E (X) â‰¡
Z
â„¦
XdP.
There is no problem here. Next, consider the correlation.
Theorem 36.3 Suppose X âˆˆL2 (â„¦; H) and Y âˆˆL2 (â„¦; G) where H and G are
separable Hilbert spaces. Then (Y âˆ’E (Y )) âŠ—(X âˆ’E (X)) âˆˆL1 (â„¦; L2 (H, G)) and
the correlation is deï¬ned by
cor (Y, X)
â‰¡
E ((Y âˆ’E (Y )) âŠ—(X âˆ’E (X)))
âˆˆ
L2 (H, G)
while the covariance is deï¬ned by
cov (X, X)
â‰¡
E ((X âˆ’E (X)) âŠ—(X âˆ’E (X)))
âˆˆ
L2 (H, H) .
Proof: It suï¬ƒces to verify the claim about cor (Y, X). First consider the issue
of measurability. I need to verify that Ï‰ â†’(Y (Ï‰) âˆ’E (Y )) âŠ—(X (Ï‰) âˆ’E (X)) is
measurable. Since L2 (H, G) is a separable Hilbert space, it suï¬ƒces to use the Pettis
theorem and verify
Ï‰ â†’((Y (Ï‰) âˆ’E (Y )) âŠ—(X (Ï‰) âˆ’E (X)) , A)L2
is measurable for every A âˆˆL2 (H, G). Therefore, letting {ek} be an orthonormal
basis in H ,
((Y (Ï‰) âˆ’E (Y )) âŠ—(X (Ï‰) âˆ’E (X)) , A)L2
â‰¡
X
k
((Y (Ï‰) âˆ’E (Y )) âŠ—(X (Ï‰) âˆ’E (X)) (ek) , A (ek))
=
X
k
(ek, X (Ï‰) âˆ’E (X)) ((Y (Ï‰) âˆ’E (Y )) , A (ek)) .
Each term in this sum is measurable and so this shows measurability.
Finally, from Theorem 14.40,
Z
â„¦
||(Y (Ï‰) âˆ’E (Y )) âŠ—(X (Ï‰) âˆ’E (X))||L2 dP
â‰¤
Z
â„¦
||Y (Ï‰) âˆ’E (Y )|| ||X (Ï‰) âˆ’E (X)|| dP
â‰¤
||X âˆ’E (X)||L2(â„¦;H) ||Y âˆ’E (Y )||L2(â„¦;G) .
This proves the theorem.

990
PROBABILITY IN INFINITE DIMENSIONS
36.2
Independence
Recall that for X a random variable, Ïƒ (X) is the smallest Ïƒ algebra containing all
the sets of the form Xâˆ’1 (F) where F is Borel. Since such sets, Xâˆ’1 (F) for F Borel
form a Ïƒ algebra it follows Ïƒ (X) =
Â©
Xâˆ’1 (F) : F is Borel
Âª
.
Deï¬nition 36.4 Let (â„¦, F, P) be a probability space. A ï¬nite set of random vec-
tors, {Xk}n
k=1 is independent if whenever Fk âˆˆÏƒ (Xk) ,
P (âˆ©n
k=1Fk) =
n
Y
k=1
P (Fk) .
More generally, if {Fj}jâˆˆJ are Ïƒ algebras, they are said to be independent if when-
ever I âŠ†J is a ï¬nite set of indices and Ai âˆˆFi,
P (âˆ©iâˆˆIAi) =
Y
iâˆˆI
P (Ai) .
Recall the following lemma.
Lemma 36.5 If {Xk}r
k=1 are independent and if gk is a Borel measurable function,
then {gk (Xk)}n
k=1 is also independent. Furthermore, if the random variables have
values in R and they are all bounded, then
E
Ãƒ r
Y
i=1
Xi
!
=
r
Y
i=1
E (Xi) .
Proof: First consider the claim about {gk (Xk)}r
k=1. Letting O be an open set
in R,
(gk â—¦Xk)âˆ’1 (O) = Xâˆ’1
k
Â¡
gâˆ’1
k
(O)
Â¢
= Xâˆ’1
k
(Borel set) âˆˆÏƒ (Xk) .
It follows (gk â—¦Xk)âˆ’1 (E) is in Ïƒ (Xk) whenever E is Borel. Thus Ïƒ (gk â—¦Xk) âŠ†
Ïƒ (Xk) and this proves the ï¬rst part of the lemma.
Now let
Â©
si
n
Âªâˆž
n=1 be a bounded sequence of simple functions measurable in Ïƒ (Xi)
which converges to Xi uniformly. (Since Xi is bounded, such a sequence exists by
breaking Xi into positive and negative parts and using Theorem 8.27 on Page 190.)
Say
si
n (Ï‰) =
mn
X
k=1
cn,i
k XEn,i
k
(Ï‰)
where the Ek are disjoint elements of Ïƒ (Xi) and some might be empty. This is for
convenience in keeping the same index on the top of the sum. Then since all the
random variables are bounded, there is no problem about existence of any of the

36.2.
INDEPENDENCE
991
above. Then from the assumption that the Xi are independent,
E
Ãƒ r
Y
i=1
Xi
!
=
Z
â„¦
r
Y
i=1
Xi (Ï‰) dP = lim
nâ†’âˆž
Z
â„¦
r
Y
i=1
si
n (Ï‰) dP
=
lim
nâ†’âˆž
Z
â„¦
r
Y
i=1
mn
X
k=1
cn,i
k XEn,i
k
(Ï‰) dP
=
lim
nâ†’âˆž
Z
â„¦
X
k1,k2,Â·Â·Â·,kr
cn,1
k1 cn,2
k2 Â· Â· Â· cn,r
kr XEn,1
k1 XEn,2
k2 Â· Â· Â· XEn,r
kr dP
=
lim
nâ†’âˆž
X
k1,k2,Â·Â·Â·,kr
Z
â„¦
cn,1
k1 cn,2
k2 Â· Â· Â· cn,r
kr XEn,1
k1 XEn,2
k2 Â· Â· Â· XEn,r
kr dP
=
lim
nâ†’âˆž
X
k1,k2,Â·Â·Â·,kr
cn,1
k1 cn,2
k2 Â· Â· Â· cn,r
kr
r
Y
i=1
P
Â³
En,i
ki
Â´
=
lim
nâ†’âˆž
r
Y
i=1
Z
â„¦
si
n (Ï‰) dP =
r
Y
i=1
E (Xi) .
This proves the lemma.
Next consider the case where you have an independent set of Ïƒ algebras. First
here are some preliminary results.
Deï¬nition 36.6 Let â„¦be a set and let K be a collection of subsets of â„¦. Then K
is called a Ï€ system if âˆ…âˆˆK and whenever A, B âˆˆK, it follows A âˆ©B âˆˆK.
Obviously an example of a Ï€ system is the set of measurable rectangles. Note
how simple this deï¬nition is. It does not involve an algebra. Now recall the funda-
mental lemma on Ï€ systems, Lemma 9.72 on Page 257.
The following lemma is helpful when you try to verify such a set of Ïƒ algebras is
independent. It says you only need to check things on Ï€ systems contained in the
Ïƒ algebras.
Lemma 36.7 Suppose {Fi}iâˆˆI is a set of Ïƒ algebras contained in F where F
is
a Ïƒ algebra of sets of â„¦. Suppose that Ki âŠ†Fi is a Ï€ system and Fi = Ïƒ (Ki).
Suppose also that whenever J is a ï¬nite subset of I and Aj âˆˆKj for j âˆˆJ, it
follows
P (âˆ©jâˆˆJAj) =
Y
jâˆˆJ
P (Aj) .
Then {Fi}iâˆˆI is independent.
Proof: I need to verify that for all n âˆˆN, if {j1, j2, Â· Â· Â·, jn} âŠ†I and Ajk âŠ†Fjk,
then
P (âˆ©n
k=1Ajk) =
n
Y
k=1
P (Ajk) .

992
PROBABILITY IN INFINITE DIMENSIONS
Pick
Â¡
Aj1 Â· Â·Â·, Ajnâˆ’1
Â¢
âˆˆKj1 Ã— Â· Â· Â·, Kjnâˆ’1 and let
G(Aj1Â·Â·Â·,Ajnâˆ’1) â‰¡
(
Ajn âˆˆFjn : P (âˆ©n
k=1Ajk) =
n
Y
k=1
P (Ajk)
)
Then by hypothesis, Kjn âŠ†G(Aj1Â·Â·Â·,Ajnâˆ’1). If Ajn âˆˆG(Aj1Â·Â·Â·,Ajnâˆ’1),
nâˆ’1
Y
k=1
P (Ajk)
=
P
Â¡
âˆ©nâˆ’1
k=1Ajk
Â¢
=
P
Â¡Â¡
âˆ©nâˆ’1
k=1Ajk âˆ©AC
jn
Â¢
âˆª
Â¡
âˆ©nâˆ’1
k=1Ajk âˆ©Ajn
Â¢Â¢
=
P
Â¡
âˆ©nâˆ’1
k=1Ajk âˆ©AC
jn
Â¢
+ P
Â¡
âˆ©nâˆ’1
k=1Ajk âˆ©Ajn
Â¢
=
P
Â¡
âˆ©nâˆ’1
k=1Ajk âˆ©AC
jn
Â¢
+
n
Y
k=1
P (Ajk)
and so
P
Â¡
âˆ©nâˆ’1
k=1Ajk âˆ©AC
jn
Â¢
=
nâˆ’1
Y
k=1
P (Ajk) (1 âˆ’P (Ajn))
=
nâˆ’1
Y
k=1
P (Ajk) P
Â¡
AC
jn
Â¢
showing if Ajn âˆˆG(Aj1Â·Â·Â·,Ajnâˆ’1), then so is AC
jn. It is clear that G(Aj1Â·Â·Â·,Ajnâˆ’1) is
closed with respect to disjoint unions also. Therefore, by Lemma 9.72 G(Aj1Â·Â·Â·,Ajnâˆ’1) =
Fjn.
Next ï¬x Ajn âˆˆFjn and
Â¡
Aj1 Â· Â·Â·, Ajnâˆ’2
Â¢
âˆˆKj1 Ã— Â· Â· Â·, Kjnâˆ’2. Let
G(Aj1Â·Â·Â·,Ajnâˆ’2) â‰¡
(
Ajnâˆ’1 âˆˆFjnâˆ’1 : P (âˆ©n
k=1Ajk) =
n
Y
k=1
P (Ajk)
)
It was just shown G(Aj1Â·Â·Â·,Ajnâˆ’2) âŠ‡Kjnâˆ’1. Also by similar reasoning to the above, it
follows G(Aj1Â·Â·Â·,Ajnâˆ’2) satisï¬es the conditions needed to apply Lemma 9.72 on Page
257 and so whenever Ajn, Ajnâˆ’1 are in Fjn and Fjnâˆ’1 respectively and
Â¡
Aj1 Â· Â·Â·, Ajnâˆ’2
Â¢
âˆˆKj1 Ã— Â· Â· Â·, Kjnâˆ’2,
it follows P (âˆ©n
k=1Ajk) = Qn
k=1 P (Ajk) . Continue this way to obtain the desired
result. This proves the lemma.
What is a useful Ï€ system for B (E) where E is a Banach space?
Recall the fundamental lemma used to prove the Pettis theorem. It was proved
on Page 579 but here I want to show that in addition, the set Dâ€² can be taken as a
subset of a given dense subspace, M of Eâ€². Thus I will present next a generalization
of that important lemma. You might consider whether the following lemma can be
generalized even more.

36.2.
INDEPENDENCE
993
Lemma 36.8 If E is a separable Banach space with Bâ€² the closed unit ball in Eâ€²,
and if M is a dense subspace of Eâ€², then there exists a sequence {fn}âˆž
n=1 â‰¡Dâ€² âŠ†
Bâ€² âˆ©M with the property that for every x âˆˆE,
||x|| = sup
fâˆˆDâ€² |f (x)|
The set, Dâ€² also has the property that if f âˆˆDâ€² then âˆ’f âˆˆDâ€².
Proof: Let {an} â‰¡D be a dense subset of E. Deï¬ne a subset of Cn, Cn by
{(f (a1) , Â· Â· Â·, f (an)) : f âˆˆBâ€² âˆ©M}
Then Cn is a bounded subset of Cn and so it is separable. Note each f delivers a
point in Cn. Now let {f n
k }âˆž
k=1 âŠ†Bâ€² âˆ©M be such that the points
{(f n
k (a1) , Â· Â· Â·, f n
k (an))}âˆž
k=1
are dense in Cn. Then Dâ€² â‰¡âˆªâˆž
n=1 {f n
k }âˆž
k=1 .
It remains to verify Dâ€² works. Pick x âˆˆE. I need to show there exists f n
k such
that ||x|| < |f n
k (x)| + Îµ. By a standard exercise in the Hahn Banach theorem, there
exists f âˆˆBâ€² such that f (x) = ||x|| . Next choose an âˆˆD such that ||x âˆ’an||E <
Îµ/4. Since M is dense, there exists g âˆˆM âˆ©Bâ€² such that |g (an) âˆ’f (an)| < Îµ/4.
Finally, there exists f n
k âˆˆDâ€² such that |f n
k (an) âˆ’g (an)| < Îµ/4. Then
|||x|| âˆ’|f n
k (x)||
=
||f (x)| âˆ’|f n
k (x)||
â‰¤
||f (x)| âˆ’|f (an)|| + ||f (an)| âˆ’|g (an)||
+ ||g (an)| âˆ’|f n
k (an)|| + ||f n
k (an)| âˆ’|f n
k (x)||
<
Îµ
4 + Îµ
4 + Îµ
4 + Îµ
4 = Îµ.
It follows ||x|| < |f n
k (x)| + Îµ and this proves the lemma because for every f âˆˆDâ€²
you can simply include âˆ’f.
Lemma 36.9 Let E be a separable real Banach space. Sets of the form
{x âˆˆE : xâˆ—
i (x) â‰¤Î±i, i = 1, 2, Â· Â· Â·, m}
where xâˆ—
i âˆˆM, a dense subspace of Eâ€² and Î±i âˆˆ[âˆ’âˆž, âˆž) are a Ï€ system, and
denoting this Ï€ system by K, it follows Ïƒ (K) = B (E).
Proof: The sets described are obviously a Ï€ system.
I want to show Ïƒ (K)
contains the closed balls because then Ïƒ (K) contains the open balls and hence the
open sets and the result will follow. Let Dâ€² âŠ†Bâ€² âˆ©M be described in Lemma 36.8.

994
PROBABILITY IN INFINITE DIMENSIONS
Then
{x âˆˆE : ||x âˆ’a|| â‰¤r}
=
(
x âˆˆE : sup
fâˆˆDâ€² |f (x âˆ’a)| â‰¤r
)
=
(
x âˆˆE : sup
fâˆˆDâ€² |f (x) âˆ’f (a)| â‰¤r
)
=
âˆ©fâˆˆDâ€² {x âˆˆE : f (a) âˆ’r â‰¤f (x) â‰¤f (a) + r}
=
âˆ©fâˆˆDâ€² {x âˆˆE : f (x) â‰¤f (a) + r and (âˆ’f) (x) â‰¤r âˆ’f (a)}
which equals a countable intersection of sets of the given Ï€ system.
Therefore,
every closed ball is contained in Ïƒ (K). It follows easily that every open ball is also
contained in Ïƒ (K) because
B (a, r) = âˆªâˆž
n=1B
Âµ
a, r âˆ’1
n
Â¶
.
Since the Banach space is separable, it is completely separable and so every open
set is the countable union of balls.
This shows the open sets are in Ïƒ (K) and
so Ïƒ (K) âŠ‡B (E) . However, all the sets in the Ï€ system are closed hence Borel
because they are inverse images of closed sets. Therefore, Ïƒ (K) âŠ†B (E) and so
Ïƒ (K) = B (E). This proves the lemma.
Next suppose you have some random variables having values in a separable
Banach space, E, {Xi}iâˆˆI . How can you tell if they are independent? To show they
are independent, you need to verify that
P
Â¡
âˆ©n
k=1Xâˆ’1
ik (Fik)
Â¢
=
n
Y
k=1
P
Â¡
Xâˆ’1
ik (Fik)
Â¢
whenever the Fik are Borel sets in E. It is desirable to ï¬nd a way to do this easily.
Lemma 36.10 Let K be a Ï€ system of sets of E, a separable real Banach space
and let (â„¦, F, P) be a probability space and X : â„¦â†’E be a random variable. Then
Xâˆ’1 (Ïƒ (K)) = Ïƒ
Â¡
Xâˆ’1 (K)
Â¢
Proof: First note that Xâˆ’1 (Ïƒ (K)) is a Ïƒ algebra which contains Xâˆ’1 (K) and
so it contains Ïƒ
Â¡
Xâˆ’1 (K)
Â¢
. Now let
G â‰¡
Â©
A âˆˆÏƒ (K) : Xâˆ’1 (A) âˆˆÏƒ
Â¡
Xâˆ’1 (K)
Â¢Âª
Then G âŠ‡K. If A âˆˆG, then
Xâˆ’1 (A) âˆˆÏƒ
Â¡
Xâˆ’1 (K)
Â¢

36.2.
INDEPENDENCE
995
and so
Xâˆ’1 (A)C = Xâˆ’1 Â¡
ACÂ¢
âˆˆÏƒ
Â¡
Xâˆ’1 (K)
Â¢
because Ïƒ
Â¡
Xâˆ’1 (K)
Â¢
is a Ïƒ algebra. Hence AC âˆˆG. Finally suppose {Ai} is a
sequence of disjoint sets of G. Then
Xâˆ’1 (âˆªâˆž
i=1Ai) = âˆªâˆž
i=1Xâˆ’1 (Ai) âˆˆÏƒ
Â¡
Xâˆ’1 (K)
Â¢
again because Ïƒ
Â¡
Xâˆ’1 (K)
Â¢
is a Ïƒ algebra. It follows from Lemma 9.72 on Page 257
that G âŠ‡Ïƒ (K) and this shows that whenever A âˆˆÏƒ (K) , Xâˆ’1 (A) âˆˆÏƒ
Â¡
Xâˆ’1 (K)
Â¢
.
Thus Xâˆ’1 (Ïƒ (K)) âŠ†Ïƒ
Â¡
Xâˆ’1 (K)
Â¢
and this proves the lemma.
With this lemma, here is the desired result about independent random variables.
Essentially, you can reduce to the case of random vectors having values in Rn.
Theorem 36.11 The random variables, {Xi}iâˆˆI are independent if whenever
{i1, Â· Â· Â·, in} âŠ†I,
mi1, Â· Â· Â·, min are positive integers, and gmi1 , Â· Â· Â·, gmin are respectively in (M)mi1 , Â· Â·
Â·, (M)mn for M a dense subspace of Eâ€²,
n
gmij â—¦Xij
on
j=1 are independent random
vectors having values in Rmi1 , Â· Â· Â·, Rmin respectively.
Proof: Let K denote sets of the form
{x âˆˆE : xâˆ—
i (x) â‰¤Î±i, i = 1, 2, Â· Â· Â·m}
as described in Lemma 36.9. Then as proved in this lemma, Ïƒ (K) = B (E). Then
the random vectors are independent if whenever
{i1, Â· Â· Â·, in} âŠ†I
and Ai1, Â· Â· Â·, Ain sets of Ïƒ (Xi1) , Â· Â· Â·, Ïƒ (Xin) respectively,
P
Â¡
âˆ©n
j=1Aij
Â¢
=
n
Y
j=1
P
Â¡
Aij
Â¢
.
By Lemma 9.72 on Page 257 if Kij is a Ï€ system contained in Ïƒ
Â¡
Xij
Â¢
such that
Ïƒ
Â¡
Kij
Â¢
= Ïƒ
Â¡
Xij
Â¢
, then it suï¬ƒces to check only the case where the Aij is in Kij.
So what will serve for such a collection of Ï€ systems? Let
Kij â‰¡Xâˆ’1
ij (K) â‰¡
n
Xâˆ’1
ij (A) : A âˆˆK
o
.
This is clearly a Ï€ system contained in Ïƒ
Â¡
Xij
Â¢
and by Lemma 36.10
Ïƒ
Â¡
Kij
Â¢
= Ïƒ
Â³
Xâˆ’1
ij (K)
Â´
= Xâˆ’1
ij (Ïƒ (K)) â‰¡Ïƒ
Â¡
Xij
Â¢
.

996
PROBABILITY IN INFINITE DIMENSIONS
Thus it suï¬ƒces to show that whenever Bi1, Â· Â· Â·, Bin are sets of K,
P
Â³
âˆ©n
j=1Xâˆ’1
ij
Â¡
Bij
Â¢Â´
=
n
Y
j=1
P
Â³
Xâˆ’1
ij
Â¡
Bij
Â¢Â´
Let Bij =
n
x âˆˆE : gmij (x) âˆˆAij
o
where Aij = Qmj
j=1(âˆ’âˆž, Î±i] and gmj âˆˆM mj.
It follows
Xâˆ’1
ij
Â¡
Bij
Â¢
=
Â³
gmij â—¦Xij
Â´âˆ’1 Â¡
Aij
Â¢
.
Then by the assumption the random vectors gmij â—¦Xij are independent,
P
Â³
âˆ©n
j=1Xâˆ’1
ij
Â¡
Bij
Â¢Â´
=
P
Âµ
âˆ©n
j=1
Â³
gmij â—¦Xij
Â´âˆ’1 Â¡
Aij
Â¢Â¶
=
n
Y
j=1
P
ÂµÂ³
gmij â—¦Xij
Â´âˆ’1 Â¡
Aij
Â¢Â¶
=
n
Y
j=1
P
Â³
Xâˆ’1
ij
Â¡
Bij
Â¢Â´
and this proves the theorem.
Procedure 36.12 Suppose you have random vectors, {Xi}iâˆˆI having values in a
real separable Banach space, E. Then they are independent if the Rk valued random
vectors, {gâ—¦Xi}iâˆˆI,gâˆˆM k are independent for M a dense subspace of Eâ€². You check
whether these are independent to determine whether {Xi}iâˆˆI are independent.
The above assertion also goes the other way as you may want to show.
So how can you determine whether random vectors having values in Rn are
independent? Recall an earlier proposition which relates independence of random
vectors with characteristic functions. It is proved starting on Page 865.
Proposition 36.13 Let {Xk}n
k=1be random vectors such that Xk has values in
Rpk. Then the random vectors are independent if and only if
E
Â¡
eiP Â¢
=
n
Y
j=1
E
Â¡
eitjÂ·XjÂ¢
where P â‰¡Pn
j=1 tj Â· Xj for tj âˆˆRpj.
36.3
Conditional Expectation
Let (â„¦, F, P) be a probability space and let X âˆˆL1 (â„¦; R). Also let G âŠ†F where
G is also a Ïƒ algebra. Then the usual conditional expectation is deï¬ned by
Z
A
XdP =
Z
A
E (X|G) dP

36.3.
CONDITIONAL EXPECTATION
997
where E (X|G) is G measurable and A âˆˆG is arbitrary. Recall this is an application
of the Radon Nikodym theorem. Also recall E (X|G) is unique up to a set of measure
zero.
I want to do something like this here. Denote by L1 (â„¦; E, G) those functions in
L1 (â„¦; E) which are measurable with respect to G.
Theorem 36.14 Let E be a separable Banach space and let X âˆˆL1 (â„¦; E, F) where
X is measurable with respect to F. Then there exists a unique Z âˆˆL1 (â„¦; E, G) such
that for all A âˆˆG,
Z
A
XdP =
Z
A
ZdP
Denoting this Z as E (X|G) , it follows
||E (X|G)|| â‰¤E (||X|| |G) .
Proof: First consider uniqueness. Suppose Zâ€² is another in L1 (â„¦; E, G) which
works. Then let A â‰¡{Ï‰ : ||Z (Ï‰) âˆ’Zâ€² (Ï‰)|| > Î´} where Î´ > 0. Now let D = {ak}
be a countable dense subset of E and consider the balls B
Â¡
ak, 1
4 ||ak||
Â¢
â‰¡Bk for
which ||ak|| > Î´. Since each of these balls has radius larger than Î´/4 and the {ak}
are dense, it follows the union of these balls includes {x âˆˆE : ||x|| > Î´}.
Now let
Ak
â‰¡
{Ï‰ : ||Z (Ï‰) âˆ’Zâ€² (Ï‰)|| > Î´}
âˆ©
Â½
Ï‰ : ||Z (Ï‰) âˆ’Zâ€² (Ï‰) âˆ’ak|| < 1
2 ||ak||
Â¾
.
If P (A) > 0, then for some k, P (Ak) > 0 because the balls Bk cover the set
{x : ||x|| > Î´} . Then
1
2 ||ak|| P (Ak)
â‰¥
Z
Ak
||Zâ€² âˆ’Z + ak|| dP
â‰¥
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Ak
(Zâ€² âˆ’Z + ak) dP
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
Ak
akdP
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ = ||ak|| P (Ak)
which is a contradiction. Hence P (A) = 0 after all. It follows Zâ€² = Z a.e. because
Î´ > 0 is arbitrary. This establishes the uniqueness part of the theorem.
Next I will show Z exists. To do this recall Theorem 21.19 on Page 588 which
is stated below for convenience.
Theorem 36.15 An E valued function, X, is Bochner integrable if and only if X
is strongly measurable and
Z
â„¦
||X (Ï‰)|| dP < âˆž.
(36.3)

998
PROBABILITY IN INFINITE DIMENSIONS
In this case there exists a sequence of simple functions {Xn} satisfying
Z
â„¦
||Xn (Ï‰) âˆ’Xm (Ï‰)|| dP â†’0 as m, n â†’âˆž.
(36.4)
Xn (Ï‰) converging pointwise to X (Ï‰),
||Xn (Ï‰)|| â‰¤2 ||X (Ï‰)||
(36.5)
and
lim
nâ†’âˆž
Z
â„¦
||X (Ï‰) âˆ’Xn (Ï‰)|| dP = 0.
(36.6)
Now let {Xn} be the simple functions just deï¬ned and let
Xn (Ï‰) =
m
X
k=1
xkXFk (Ï‰)
where Fk âˆˆF, the Fk being disjoint. Then deï¬ne
Zn â‰¡
m
X
k=1
xkE (XFk|G) .
Thus, if A âˆˆG,
Z
A
ZndP
=
m
X
k=1
xk
Z
A
E (XFk|G) dP
=
m
X
k=1
xk
Z
A
XFkdP
=
m
X
k=1
xkP (Fk) =
Z
A
XndP
(36.7)
Then since E (XFk|G) â‰¥0,
E (||Zn||)
â‰¤
m
X
k=1
||xk||
Z
E (XFk|G) dP
=
m
X
k=1
||xk||
Z
XFkdP = E (||Xn||) .
Similarly,
E (||Zn âˆ’Zm||) â‰¤E (||Xn âˆ’Xm||)
and this last term converges to 0 as n, m â†’âˆžby the properties of the Xn. There-
fore, {Zn} is a Cauchy sequence in L1 (â„¦; E; G) . It follows it converges to Z in

36.3.
CONDITIONAL EXPECTATION
999
L1 (â„¦; E, G) . Then letting A âˆˆG, and using 36.7,
Z
A
ZdP
=
Z
XAZdP
=
lim
nâ†’âˆž
Z
XAZndP
=
lim
nâ†’âˆž
Z
A
ZndP
=
lim
nâ†’âˆž
Z
A
XndP
=
Z
A
XdP.
It remains to verify ||E (X|G)|| â‰¤E (||X|| |G) . This follows similar to the above.
Letting Zn and Z have the same meaning as above and A âˆˆG,
E (XA ||Zn||)
=
Z
A
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
m
X
k=1
xkE (XFk|G)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ dP
â‰¤
m
X
k=1
||xk||
Z
A
E (XFk|G) dP
=
m
X
k=1
||xk||
Z
A
XFkdP
=
Z
A
m
X
k=1
||xk|| XFkdP
=
E (XA ||Xn||) .
Therefore,
Z
A
||Z|| dP
=
Z
XA ||Z|| dP
=
lim
nâ†’âˆž
Z
XA ||Zn|| dP
â‰¤
lim
nâ†’âˆžE (XA ||Xn||)
=
Z
A
||X|| dP
Thus for all A âˆˆG,
Z
A
||E (X|G)|| dP â‰¤
Z
A
||X|| dP =
Z
A
E (||X|| |G) dP
which shows
||E (X|G)|| â‰¤E (||X|| |G)

1000
PROBABILITY IN INFINITE DIMENSIONS
as claimed. This proves the theorem.
In the case where E is reï¬‚exive, one could also use Corollary 21.48 on Page 617
to get the above result. You would deï¬ne a vector measure on G,
Î½ (F) â‰¡
Z
F
XdP
and then you would use the fact that reï¬‚exive separable Banach spaces have the
Radon Nikodym property to obtain Z âˆˆL1 (â„¦; E, G) such that
Î½ (F) =
Z
F
XdP =
Z
F
ZdP.
The function, Z whose existence and uniqueness is guaranteed by Theorem 36.15
is called E (X|G).
36.4
Probability Measures And Tightness
Here and in what remains, B (E) will denote the Borel sets of E where E is a topo-
logical space, usually at least a Banach space. Because of the fact that probability
measures are ï¬nite, you can use a simpler deï¬nition of what it means for a measure
to be regular. Recall that there were two ingredients, inner regularity which said
that the measure of a set is the supremum of the measures of compact subsets and
outer regularity which says that the measure of a set is the inï¬mum of the measures
of the open sets which contain the given set. Here the deï¬nition will be similar
but instead of using compact sets, closed sets are substituted. Thus the following
deï¬nition is a little diï¬€erent than the earlier one. I will show, however, that in many
interesting cases, this deï¬nition of regularity is actually the same as the earlier one.
Deï¬nition 36.16 A measure, Âµ deï¬ned on B (E) will be called inner regular if for
all F âˆˆB (E) ,
Âµ (F) = sup {Âµ (K) : K âŠ†F and K is closed}
A measure, Âµ deï¬ned on B (E) will be called outer regular if for all F âˆˆB (E) ,
Âµ (F) = inf {Âµ (V ) : V âŠ‡F and V is open}
When a measure is both inner and outer regular, it is called regular.
For probability measures, regularity tends to come free.
Lemma 36.17 Let Âµ be a ï¬nite measure deï¬ned on B (E) where E is a metric
space. Then Âµ is regular.
Proof: First note every open set is the countable union of closed sets and every
closed set is the countable intersection of open sets. Here is why. Let V be an open
set and let
Kk â‰¡
Â©
x âˆˆV : dist
Â¡
x, V CÂ¢
â‰¥1/k
Âª
.

36.4.
PROBABILITY MEASURES AND TIGHTNESS
1001
Then clearly the union of the Kk equals V. Next, for K closed let
Vk â‰¡{x âˆˆE : dist (x, K) < 1/k} .
Clearly the intersection of the Vk equals K. Therefore, letting V denote an open set
and K a closed set,
Âµ (V )
=
sup {Âµ (K) : K âŠ†V and K is closed}
Âµ (K)
=
inf {Âµ (V ) : V âŠ‡K and V is open} .
Also since V is open and K is closed,
Âµ (V )
=
inf {Âµ (U) : U âŠ‡V and V is open}
Âµ (K)
=
sup {Âµ (L) : L âŠ†K and L is closed}
In words, Âµ is regular on open and closed sets. Let
F â‰¡{F âˆˆB (E) such that Âµ is regular on F} .
Then F contains the open sets. I want to show F is a Ïƒ algebra and then it will
follow F = B (E).
First I will show F is closed with respect to complements. Let F âˆˆF. Then
since Âµ is ï¬nite and F is inner regular, there exists K âŠ†F such that Âµ (F \ K) < Îµ.
But KC \ F C = F \ K and so Âµ
Â¡
KC \ F CÂ¢
< Îµ showning that F C is outer regular.
I have just approximated the measure of F C with the measure of KC, an open set
containing F C. A similar argument works to show F C is inner regular. You start
with V âŠ‡F such that Âµ (V \ F) < Îµ, note F C \ V C = V \ F, and then conclude
Âµ
Â¡
F C \ V CÂ¢
< Îµ, thus approximating F C with the closed subset, V C.
Next I will show F is closed with respect to taking countable unions. Let {Fk}
be a sequence of sets in F. Then Âµ is inner regular on each of these so there exist
{Kk} such that Kk âŠ†Fk and Âµ (Fk \ Kk) < Îµ/2k+1. First choose m large enough
that
Âµ ((âˆªâˆž
k=1Fk) \ (âˆªm
k=1Fk)) < Îµ
2.
Then
Âµ ((âˆªm
k=1Fk) \ (âˆªm
k=1Kk)) â‰¤
m
X
k=1
Îµ
2k+1 < Îµ
2
and so
Âµ ((âˆªâˆž
k=1Fk) \ (âˆªm
k=1Kk))
â‰¤
Âµ ((âˆªâˆž
k=1Fk) \ (âˆªm
k=1Fk))
+Âµ ((âˆªm
k=1Fk) \ (âˆªm
k=1Kk))
<
Îµ
2 + Îµ
2 = Îµ

1002
PROBABILITY IN INFINITE DIMENSIONS
showing Âµ is inner regular on âˆªâˆž
k=1Fk. Since Âµ is outer regular on Fk, there exists
Vk such that Âµ (Vk \ Fk) < Îµ/2k. Then
Âµ ((âˆªâˆž
k=1Vk) \ (âˆªâˆž
k=1Fk))
â‰¤
âˆž
X
k=1
Âµ (Vk \ Fk)
<
âˆž
X
k=1
Îµ
2k = Îµ
and this shows Âµ is outer regular on âˆªâˆž
k=1Fk and this proves the lemma.
Lemma 36.18 Let Âµ be a ï¬nite measure on B (E) , the Borel sets of E, a separable
complete metric space. Then if C is a closed set,
Âµ (C) = sup {Âµ (K) : K âŠ†C and K is compact.}
Proof: Let {ak} be a countable dense subset of C. Thus âˆªâˆž
k=1B
Â¡
ak, 1
n
Â¢
âŠ‡C.
Therefore, there exists mn such that
Âµ
Ãƒ
C \ âˆªmn
k=1B
Âµ
ak, 1
n
Â¶!
â‰¡Âµ (C \ Cn) < Îµ
2n .
Now let K = C âˆ©(âˆ©âˆž
n=1Cn) . Then K is a subset of Cn for each n and so for each
Îµ > 0 there exists an Îµ net for K since Cn has a 1/n net, namely a1, Â· Â· Â·, amn. Since
K is closed, it is complete and so it is also compact. Now
Âµ (C \ K) = Âµ (âˆªâˆž
n=1 (C \ Cn)) <
âˆž
X
n=1
Îµ
2n = Îµ.
Thus Âµ (C) can be approximated by Âµ (K) for K a compact subset of C. This proves
the lemma.
This shows that for a ï¬nite measure on the Borel sets of a separable metric
space, the above deï¬nition of regular coincides with the earlier one.
Now here is a deï¬nition of what it means for a set of measures to be tight.
Deï¬nition 36.19 Let Î› be a set of probability measures deï¬ned on the Borel sets
of a topological space. Then Î› is â€œtightâ€ if for all Îµ > 0 there exists a compact set,
KÎµ such that
Âµ ([x /âˆˆKÎµ]) < Îµ
for all Âµ âˆˆÎ›.
Lemma 36.18 implies a single probability measure on the Borel sets of a separable
metric space is tight. The proof of that lemma generalizes slightly to give a simple
criterion for a set of measures to be tight.

36.4.
PROBABILITY MEASURES AND TIGHTNESS
1003
Lemma 36.20 Let E be a separable complete metric space and let Î› be a set of
Borel probability measures. Then Î› is tight if and only if for every Îµ > 0 and r > 0
there exists a ï¬nite collection of balls, {B (ai, r)}m
i=1 such that
Âµ
Â³
âˆªm
i=1B (ai, r)
Â´
> 1 âˆ’Îµ
for every Âµ âˆˆÎ›.
Proof: If Î› is tight, then there exists a compact set, KÎµ such that
Âµ (KÎµ) > 1 âˆ’Îµ
for all Âµ âˆˆÎ›. Then consider the open cover, {B (x, r) : x âˆˆKÎµ} . Finitely many of
these cover KÎµ and this yields the above condition.
Now suppose the above condition and let
Cn â‰¡âˆªmn
i=1B (an
i , 1/n)
satisfy Âµ (Cn) > 1 âˆ’Îµ/2n for all Âµ âˆˆÎ›. Then let KÎµ â‰¡âˆ©âˆž
n=1Cn. Then as in Lemma
36.18 Âµ (KÎµ) > 1 âˆ’Îµ for all Âµ âˆˆÎ›.
Prokhorovâ€™s theorem is an important result which also involves tightness. In
order to give a proof of this important theorem, it is necessary to consider some
simple results from topology which are interesting for their own sake.
Theorem 36.21 Let H be a compact metric space. Then there exists a compact
subset of [0, 1] , K and a continuous function, Î¸ which maps K onto H.
Proof: Without loss of generality, it can be assumed H is an inï¬nite set since
otherwise the conclusion is trivial. You could pick ï¬nitely many points of [0, 1] for
K.
Since H is compact, it is totally bounded. Therefore, there exists a 1 net for
H {hi}m1
i=1 . Letting H1
i â‰¡B (hi, 1), it follows H1
i is also a compact metric space
and so there exists a 1/2 net for each H1
i ,
Â©
hi
j
Âªmi
j=1 . Then taking the intersection
of B
Â¡
hi
j, 1
2
Â¢
with H1
i to obtain sets denoted by H2
j and continuing this way, one
can obtain compact subsets of H,
Â©
Hi
k
Âª
which satisï¬es: each Hi
j is contained in
some Hiâˆ’1
k
, each Hi
j is compact with diameter less than iâˆ’1, each Hi
j is the union
of sets of the form Hi+1
k
which are contained in it. Denoting by
Â©
Hi
j
Âªmi
j=1 those
sets corresponding to a superscript of i, it can also be assumed mi < mi+1. If
this is not so, simply add in another point to the iâˆ’1 net. Now let
Â©
Ii
j
Âªmi
j=1 be
disjoint closed intervals in [0, 1] each of length no longer than 2âˆ’mi which have the
property that Ii
j
is contained in Iiâˆ’1
k
for some k. Letting Ki â‰¡âˆªmi
j=1Ii
j, it follows
Ki is a sequence of nested compact sets. Let K = âˆ©âˆž
i=1Ki. Then each x âˆˆK is
the intersection of a unique sequence of these closed intervals,
Â©
Ik
jk
Âªâˆž
k=1. Deï¬ne
Î¸x â‰¡âˆ©âˆž
k=1Hk
jk. Since the diameters of the Hi
j converge to 0 as i â†’âˆž, this function
is well deï¬ned. It is continuous because if xn â†’x, then ultimately xn and x are

1004
PROBABILITY IN INFINITE DIMENSIONS
both in Ik
jk, the kth closed interval in the sequence whose intersection is x. Hence,
d (Î¸xn, Î¸x) â‰¤diameter(Hk
jk) â‰¤1/k. To see the map is onto, let h âˆˆH.
Then
from the construction, there exists a sequence
Â©
Hk
jk
Âªâˆž
k=1 of the above sets whose
intersection equals h. Then Î¸
Â¡
âˆ©âˆž
i=1Ik
jk
Â¢
= h. This proves the theorem.
Note Î¸ is maybe not one to one.
As an important corollary, it follows that the continuous functions deï¬ned on
any compact metric space is separable.
Corollary 36.22 Let H be a compact metric space and let C (H) denote the con-
tinuous functions deï¬ned on H with the usual norm,
||f||âˆžâ‰¡max {|f (x)| : x âˆˆH}
Then C (H) is separable.
Proof: The proof is by contradiction. Suppose C (H) is not separable. Let
Hk denote a maximal collection of functions of C (H) with the property that if
f, g âˆˆHk, then ||f âˆ’g||âˆžâ‰¥1/k. The existence of such a maximal collection of
functions is a consequence of a simple use of the Hausdorï¬€maximallity theorem.
Then âˆªâˆž
k=1Hk is dense. Therefore, it cannot be countable by the assumption that
C (H) is not separable. It follows that for some k, Hk is uncountable. Now by
Theorem 36.21 there exists a continuous function, Î¸ deï¬ned on a compact subset,
K of [0, 1] which maps K onto H. Now consider the functions deï¬ned on K
Gk â‰¡{f â—¦Î¸ : f âˆˆHk} .
Then Gk is an uncountable set of continuous functions deï¬ned on K with the prop-
erty that the distance between any two of them is at least as large as 1/k. This
contradicts separability of C (K) which follows from the Weierstrass approximation
theorem in which the separable countable set of functions is the restrictions of poly-
nomials that involve only rational coeï¬ƒcients. This proves the corollary. Now here
is Prokhorovâ€™s theorem.
Theorem 36.23 Let Î› = {Âµn}âˆž
n=1 be a sequence of probability measures deï¬ned
on B (E) where E is a separable Banach space. If Î› is tight then there exists a
probability measure, Î» and a subsequence of {Âµn}âˆž
n=1 , still denoted by {Âµn}âˆž
n=1
such that whenever Ï† is a continuous bounded complex valued function deï¬ned on
E,
lim
nâ†’âˆž
Z
Ï†dÂµn =
Z
Ï†dÎ».
Proof: By tightness, there exists an increasing sequence of compact sets, {Kn}
such that
Âµ (Kn) > 1 âˆ’1
n
for all Âµ âˆˆÎ›. Now letting Âµ âˆˆÎ› and Ï† âˆˆC (Kn) such that ||Ï†||âˆžâ‰¤1, it follows
Â¯Â¯Â¯Â¯
Z
Kn
Ï†dÂµ
Â¯Â¯Â¯Â¯ â‰¤Âµ (Kn) â‰¤1

36.4.
PROBABILITY MEASURES AND TIGHTNESS
1005
and so the restrictions of the measures of Î› to Kn are contained in the unit ball of
C (Kn)â€² . Recall from the Riesz representation theorem, the dual space of C (Kn)
is a space of complex Borel measures. Theorem 13.37 on Page 356 implies the unit
ball of C (Kn)â€² is weak âˆ—sequentially compact. This follows from the observation
that C (Kn) is separable which is proved in Corollary 36.22 and leads to the fact
that the unit ball in C (Kn)â€² is actually metrizable by Theorem 13.37 on Page 356.
Therefore, there exists a subsequence of Î›, {Âµ1k} such that their restrictions to K1
converge weak âˆ—to a measure, Î»1 âˆˆC (K1)â€². That is, for every Ï† âˆˆC (K1) ,
lim
kâ†’âˆž
Z
K1
Ï†dÂµ1k =
Z
K1
Ï†dÎ»1
By the same reasoning, there exists a further subsequence {Âµ2k} such that the
restrictions of these measures to K2 converge weak âˆ—to a measure Î»2 âˆˆC (K2)â€²
etc. Continuing this way,
Âµ11, Âµ12, Âµ13, Â· Â· Â· â†’Weak âˆ—in C (K1)â€²
Âµ21, Âµ22, Âµ23, Â· Â· Â· â†’Weak âˆ—in C (K2)â€²
Âµ31, Âµ32, Âµ33, Â· Â· Â· â†’Weak âˆ—in C (K3)â€²
...
Here the jth sequence is a subsequence of the (j âˆ’1)th. Let Î»n denote the measure
in C (Kn)â€² to which the sequence {Âµnk}âˆž
k=1 converges weakâˆ—. Let {Âµn} â‰¡{Âµnn} ,
the diagonal sequence. Thus this sequence is ultimately a subsequence of every one
of the above sequences and so Âµn converges weakâˆ—in C (Km)â€² to Î»m for each m.
Claim: For p > n, the restriction of Î»p to the Borel sets of Kn equals Î»n.
Proof of claim: Let H be a compact subset of Kn. Then there are sets, Vl open
in Kn which are decreasing and whose intersection equals H. This follows because
this is a metric space. Then let H â‰ºÏ†l â‰ºVl. It follows
Î»n (Vl)
â‰¥
Z
Kn
Ï†ldÎ»n = lim
kâ†’âˆž
Z
Kn
Ï†ldÂµk
=
lim
kâ†’âˆž
Z
Kp
Ï†ldÂµk =
Z
Kp
Ï†ldÎ»p â‰¥Î»p (H) .
Now considering the ends of this inequality, let l â†’âˆžand pass to the limit to
conclude
Î»n (H) â‰¥Î»p (H) .
Similarly,
Î»n (H)
â‰¤
Z
Kn
Ï†ldÎ»n = lim
kâ†’âˆž
Z
Kn
Ï†ldÂµk
=
lim
kâ†’âˆž
Z
Kp
Ï†ldÂµk =
Z
Kp
Ï†ldÎ»p â‰¤Î»p (Vl) .

1006
PROBABILITY IN INFINITE DIMENSIONS
Then passing to the limit as l â†’âˆž, it follows
Î»n (H) â‰¤Î»p (H) .
Thus the restriction of Î»p, Î»p|Kn to the compact sets of Kn equals Î»n. Then by
inner regularity it follows the two measures, Î»p|Kn, and Î»n are equal on all Borel
sets of Kn. Recall that for ï¬nite measures on separable metric spaces, regularity is
obtained for free.
It is fairly routine to exploit regularity of the measures to verify that Î»m (F) â‰¥
0 for all F a Borel subset of Km. (Whenever Ï† â‰¥0,
R
Km Ï†dÎ»m â‰¥0 because
R
Km Ï†dÂµk â‰¥0. Now you can approximate XF with a suitable nonnegative Ï† using
regularity of the measure.) Also, letting Ï† â‰¡1,
1 â‰¥Î»m (Km) â‰¥1 âˆ’1
m.
(36.8)
Deï¬ne for F a Borel set,
Î» (F) â‰¡lim
nâ†’âˆžÎ»n (F âˆ©Kn) .
The limit exists because the sequence on the right is increasing due to the above
observation that Î»n = Î»m on the Borel subsets of Km whenever n > m. Thus for
n > m
Î»n (F âˆ©Kn) â‰¥Î»n (F âˆ©Km) = Î»m (F âˆ©Km) .
Now let {Fk} be a sequence of disjoint Borel sets. Then
Î» (âˆªâˆž
k=1Fk)
â‰¡
lim
nâ†’âˆžÎ»n (âˆªâˆž
k=1Fk âˆ©Kn) = lim
nâ†’âˆžÎ»n (âˆªâˆž
k=1 (Fk âˆ©Kn))
=
lim
nâ†’âˆž
âˆž
X
k=1
Î»n (Fk âˆ©Kn) =
âˆž
X
k=1
Î» (Fk)
the last equation holding by the monotone convergence theorem.
It remains to verify
lim
kâ†’âˆž
Z
Ï†dÂµk =
Z
Ï†dÎ»
for every Ï† bounded and continuous. This is where tightness is used again. Suppose
||Ï†||âˆž< M. Then as noted above,
Î»n (Kn) = Î» (Kn)
because for p > n, Î»p (Kn) = Î»n (Kn) and so letting p â†’âˆž, the above is obtained.
Also, from 36.8,
Î»
Â¡
KC
n
Â¢
=
lim
pâ†’âˆžÎ»p
Â¡
KC
n âˆ©Kp
Â¢
â‰¤
lim sup
pâ†’âˆž(Î»p (Kp) âˆ’Î»p (Kn))
â‰¤
lim sup
pâ†’âˆž(Î»p (Kp) âˆ’Î»n (Kn))
â‰¤
lim sup
pâ†’âˆž
Âµ
1 âˆ’
Âµ
1 âˆ’1
n
Â¶Â¶
= 1
n

36.5.
A MAJOR EXISTENCE AND CONVERGENCE THEOREM
1007
Consequently,
Â¯Â¯Â¯Â¯
Z
Ï†dÂµk âˆ’
Z
Ï†dÎ»
Â¯Â¯Â¯Â¯ â‰¤
Â¯Â¯Â¯Â¯Â¯
Z
KC
n
Ï†dÂµk +
Z
Kn
Ï†dÂµk âˆ’
ÃƒZ
Kn
Ï†dÎ» +
Z
KC
n
Ï†dÎ»
!Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯
Z
Kn
Ï†dÂµk âˆ’
Z
Kn
Ï†dÎ»n
Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯Â¯
Z
KC
n
Ï†dÂµk âˆ’
Z
KC
n
Ï†dÎ»
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯
Z
Kn
Ï†dÂµk âˆ’
Z
Kn
Ï†dÎ»n
Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯Â¯
Z
KC
n
Ï†dÂµk
Â¯Â¯Â¯Â¯Â¯ +
Â¯Â¯Â¯Â¯Â¯
Z
KC
n
Ï†dÎ»
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯
Z
Kn
Ï†dÂµk âˆ’
Z
Kn
Ï†dÎ»n
Â¯Â¯Â¯Â¯ + M
n + M
n
First let n be so large that 2M/n < Îµ/2 and then pick k large enough that the
above expression is less than Îµ. This proves the theorem.
Deï¬nition 36.24 Let E be a Banach space and let Âµ and the sequence of probability
measures, {Âµn} deï¬ned on B (E) satisfy
lim
nâ†’âˆž
Z
Ï†dÂµn =
Z
Ï†dÂµ.
for every Ï† a bounded continuous function. Then Âµn is said to converge weakly to
Âµ.
36.5
A Major Existence And Convergence Theo-
rem
Here is an interesting lemma about weak convergence.
Lemma 36.25 Let Âµn converge weakly to Âµ and let U be an open set with Âµ (âˆ‚U) =
0. Then
lim
nâ†’âˆžÂµn (U) = Âµ (U) .
Proof: Let {Ïˆk} be a sequence of bounded continuous functions which decrease
to XU. Also let {Ï†k} be a sequence of bounded continuous functions which increase
to XU. For example, you could let
Ïˆk (x)
â‰¡
(1 âˆ’k dist (x, U))+ ,
Ï†k (x)
â‰¡
1 âˆ’
Â¡
1 âˆ’k dist
Â¡
x, U CÂ¢Â¢+ .
Let Îµ > 0 be given. Then since Âµ (âˆ‚U) = 0, the dominated convergence theorem
implies there exists Ïˆ = Ïˆk and Ï† = Ï†k such that
Îµ >
Z
ÏˆdÂµ âˆ’
Z
Ï†dÂµ

1008
PROBABILITY IN INFINITE DIMENSIONS
Next use the weak convergence to pick N large enough that if n â‰¥N,
Z
ÏˆdÂµn â‰¤
Z
ÏˆdÂµ + Îµ,
Z
Ï†dÂµn â‰¥
Z
Ï†dÂµ âˆ’Îµ.
Therefore, for n this large,
Âµ (U) , Âµn (U) âˆˆ
Â·Z
Ï†dÂµ âˆ’Îµ,
Z
ÏˆdÂµ + Îµ
Â¸
and so
|Âµ (U) âˆ’Âµn (U)| < 3Îµ.
since Îµ is arbitrary, this proves the lemma.
Deï¬nition 36.26 Let (â„¦, F, P) be a probability space and let X : â„¦â†’E be a
random variable where here E is some topological space. Then one can deï¬ne a
probability measure, Î»X on B (E) as follows:
Î»X (F) â‰¡P ([X âˆˆF])
More generally, if Âµ is a probability measure on B (E) , and X is a random variable
deï¬ned on a probability space, L (X) = Âµ means
Âµ (F) â‰¡P ([X âˆˆF]) .
The following amazing theorem is due to Skorokhod. It starts with a measure,
Âµ on B (E) and produces a random variable, X for which L (X) = Âµ. It also has
something to say about the convergence of a sequence of such random variables.
Theorem 36.27 Let E be a separable Banach space and let {Âµn} be a sequence
of Borel probability measures deï¬ned on B (E) such that Âµn converges weakly to Âµ
another probability measure on B (E). Then there exist random variables, Xn, X
deï¬ned on the probability space, ([0, 1), B ([0, 1)) , m) where m is one dimensional
Lebesgue measure such that
L (X) = Âµ, L (Xn) = Âµn,
(36.9)
each random variable, X, Xn is continuous oï¬€a set of measure zero, and
Xn (Ï‰) â†’X (Ï‰) m a.e.
Proof: Let {ak} be a countable dense subset of E.
Construction of sets in E
First I will describe a construction. Letting C âˆˆB (E) and r > 0,
Cr
1
â‰¡
C âˆ©B (a1, r) , Cr
2 â‰¡B (a2, r) âˆ©C \ Cr
1, Â· Â· Â·,
Cr
n
â‰¡
B (an, r) âˆ©C \
Â¡
âˆªnâˆ’1
k=1Cr
k
Â¢
.

36.5.
A MAJOR EXISTENCE AND CONVERGENCE THEOREM
1009
Thus the sets, Cr
k for k = 1, 2, Â· Â· Â· are disjoint Borel sets whose union is all of C.
Now let C = E, the whole Banach space. Also let {rk} be a decreasing sequence of
positive numbers which converges to 0. Let
Ak â‰¡Er1
k , k = 1, 2, Â· Â· Â·
Thus {Ak} is a sequence of Borel sets, Ak âŠ†B (ak, r1) , and the union of the Ak
equals E.
For (i1, Â· Â· Â·, im) âˆˆNm, suppose Ai1,Â·Â·Â·,im has been deï¬ned.
Then for
k âˆˆN,
Ai1,Â·Â·Â·,imk â‰¡(Ai1,Â·Â·Â·,im)rm+1
k
Thus Ai1,Â·Â·Â·,imk âŠ†B (ak, rm+1), is a Borel set, and
âˆªâˆž
k=1 Ai1,Â·Â·Â·,imk = Ai1,Â·Â·Â·,im.
(36.10)
Also note that Ai1,Â·Â·Â·,im could be empty. This is because Ai1,Â·Â·Â·,imk âŠ†B (ak, rm+1)
but Ai1,Â·Â·Â·,im âŠ†B (aim, rm) which might have empty intersection with B (ak, rm+1) .
However, applying 36.10 repeatedly,
E = âˆªi1 Â· Â· Â· âˆªimAi1,Â·Â·Â·,im
and also, the construction shows the Borel sets, Ai1,Â·Â·Â·,im are disjoint.
Construction of intervals depending on the measure
Next I will construct intervals, IÎ½
i1,Â·Â·Â·,in in [0, 1) corresponding to these Ai1,Â·Â·Â·,in.
In what follows, Î½ = Âµn or Âµ. These intervals will depend on the measure chosen
as indicated in the notation.
IÎ½
1 â‰¡[0, Î½ (A1)), Â· Â· Â·, IÎ½
j â‰¡
"jâˆ’1
X
k=1
Î½ (Ak) ,
j
X
k=1
Î½ (Ak)
!
for j = 1, 2, Â· Â· Â·. Note these are disjoint intervals whose union is [0, 1). Also note
m
Â¡
IÎ½
j
Â¢
= Î½ (Aj) .
The endpoints of these intervals as well as their lengths depend on the measures of
the sets Ak. Now supposing IÎ½
i1,Â·Â·Â·,im = [Î±, Î²) where Î² âˆ’Î± = Î½ (Ai1Â·Â·Â·,im) , deï¬ne
IÎ½
i1Â·Â·Â·,im,j â‰¡
"
Î± +
jâˆ’1
X
k=1
Î½ (Ai1Â·Â·Â·,im,k) , Î± +
j
X
k=1
Î½ (Ai1Â·Â·Â·,im,k)
!
Thus m
Â¡
IÎ½
i1Â·Â·Â·,im,j
Â¢
= Î½ (Ai1Â·Â·Â·,im,j) and
Î½ (Ai1Â·Â·Â·,im) =
âˆž
X
k=1
Î½ (Ai1Â·Â·Â·,im,k) =
âˆž
X
k=1
m
Â¡
IÎ½
i1Â·Â·Â·,im,k
Â¢
= Î² âˆ’Î±,
the intervals, IÎ½
i1Â·Â·Â·,im,j being disjoint and
IÎ½
i1Â·Â·Â·,im = âˆªâˆž
j=1IÎ½
i1Â·Â·Â·,im,j.

1010
PROBABILITY IN INFINITE DIMENSIONS
Choosing the sequence {rk} in an auspicious manner
There are at most countably many positive numbers, r such that for Î½ = Âµn
or Âµ, Î½ (âˆ‚B (ai, r)) > 0. This is because Î½ is a ï¬nite measure. Taking the count-
able union of these countable sets, there are only countably many r such that
Î½ (âˆ‚B (ai, r)) > 0 for some ai. Let the sequence avoid all these bad values of r.
Thus for
F â‰¡âˆªâˆž
m=1 âˆªâˆž
k=1 âˆ‚B (ak, rm)
and Î½ = Âµ or Âµn, Î½ (F) = 0.
Claim 1: âˆ‚Ai1,Â·Â·Â·,ik âŠ†F.
Proof of claim: Suppose C is a Borel set for which âˆ‚C âŠ†F. I need to show
âˆ‚Cri
k
âˆˆF. First consider k = 1. Then Cri
1
â‰¡B (a1, ri) âˆ©C. If x âˆˆâˆ‚Cri
1 , then
B (x, Î´) contains points of B (a1, ri) âˆ©C and points of B (a1, ri)C âˆªCC for every
Î´ > 0. First suppose x âˆˆB (a1, ri) . Then a small enough neighborhood of x has no
points of B (a1, ri)C and so every B (x, Î´) has points of C and points of CC so that
x âˆˆâˆ‚C âŠ†F by assumption. If x âˆˆâˆ‚Cri
1 , then it canâ€™t happen that ||x âˆ’a1|| > ri
because then there would be a neighborhood of x having no points of Cri
1 . The
only other case to consider is that ||x âˆ’ai|| = ri but this says x âˆˆF. Now assume
âˆ‚Cri
j âŠ†F for j â‰¤k âˆ’1 and consider âˆ‚Cri
k .
Cri
k
â‰¡
B (ak, ri) âˆ©C \ âˆªkâˆ’1
j=1Cri
j
=
B (ak, ri) âˆ©C âˆ©
Â³
âˆ©kâˆ’1
j=1
Â¡
Cri
j
Â¢CÂ´
(36.11)
Consider x âˆˆâˆ‚Cri
k . If x âˆˆint (B (ak, ri) âˆ©C) (int â‰¡interior) then a small enough
ball about x contains no points of (B (ak, ri) âˆ©C)C and so every ball about x must
contain points of
Â³
âˆ©kâˆ’1
j=1
Â¡
Cri
j
Â¢CÂ´C
= âˆªkâˆ’1
j=1Cri
j
Since there are only ï¬nitely many sets in the union, there exists s â‰¤k âˆ’1 such that
every ball about x contains points of Cri
s but from 36.11, every ball about x contains
points of (Cri
s )C which implies x âˆˆâˆ‚Cri
s âŠ†F by induction. It is not possible that
||x âˆ’ak|| > ri and yet have x in âˆ‚Cri
k . This follows from the description in 36.11.
If ||x âˆ’ak|| = ri then by deï¬nition, x âˆˆF. The only other case to consider is
that x /âˆˆint (B (ak, ri) âˆ©C) but x âˆˆB (ak, ri). From 36.11, every ball about x
contains points of C. However, since x âˆˆB (ak, ri) , a small enough ball is contained
in B (ak, ri) . Therefore, every ball about x must also contain points of CC since
otherwise, x âˆˆint (B (ak, ri) âˆ©C) . Thus x âˆˆâˆ‚C âŠ†F by assumption. Now apply
what was just shown to the case where C = E, the whole space.
In this case,
âˆ‚E âŠ†F because âˆ‚E = âˆ…. Then keep applying what was just shown to the Ai1,Â·Â·Â·,in.
This proves the claim.
From the claim, Î½ (int (Ai1,Â·Â·Â·,in)) = Î½ (Ai1,Â·Â·Â·,in) whenever Î½ = Âµ or Âµn.
Some functions on [0, 1)

36.5.
A MAJOR EXISTENCE AND CONVERGENCE THEOREM
1011
By the axiom of choice, there exists xi1,Â·Â·Â·,im âˆˆint (Ai1,Â·Â·Â·,im) whenever int (Ai1,Â·Â·Â·,im) Ì¸=
âˆ…. For Î½ = Âµn or Âµ, deï¬ne the following functions. For Ï‰ âˆˆIÎ½
i1,Â·Â·Â·,im
ZÎ½
m (Ï‰) â‰¡xi1,Â·Â·Â·,im.
This deï¬nes the functions, ZÂµn
m and ZÂµ
m. Note these functions have the same values
but on slightly diï¬€erent intervals. Here is an important claim.
Claim 2: For a.e. Ï‰ âˆˆ[0, 1), limnâ†’âˆžZÂµn
m (Ï‰) = ZÂµ
m (Ï‰) .
Proof of the claim: This follows from the weak convergence of Âµn to Âµ and
Lemma 36.25. This lemma implies Âµn (int (Ai1,Â·Â·Â·,im)) â†’Âµ (int (Ai1,Â·Â·Â·,im)) . Thus
by the construction described above, Âµn (Ai1,Â·Â·Â·,im) â†’Âµ (Ai1,Â·Â·Â·,im) because of claim
1 and the construction of F in which it is always a set of measure zero. It follows
that if Ï‰ âˆˆint
Â¡
IÂµ
i1,Â·Â·Â·,im
Â¢
, then for all n large enough, Ï‰ âˆˆint
Â¡
IÂµn
i1,Â·Â·Â·,im
Â¢
and so
ZÂµn
m (Ï‰) = ZÂµ
m (Ï‰) . Note this convergence is very far from being uniform.
Claim 3: For Î½ = Âµn or Âµ, {ZÎ½
m}âˆž
m=1 is uniformly Cauchy independent of n.
Proof of the claim: For Ï‰ âˆˆIÎ½
i1,Â·Â·Â·,im, then by the construction, Ï‰ âˆˆIÎ½
i1,Â·Â·Â·,im,im+1Â·Â·Â·,in
for some im+1 Â· Â·Â·, in. Therefore, ZÎ½
m (Ï‰) and ZÎ½
n (Ï‰) are both contained in Ai1,Â·Â·Â·,im
which is contained in B (aim, rm) . Since Ï‰ âˆˆ[0, 1) was arbitrary, and rm â†’0, it
follows these functions are uniformly Cauchy as claimed.
Let XÎ½ (Ï‰) = limmâ†’âˆžZÎ½
m (Ï‰). Since each ZÎ½
m is continuous oï¬€a set of measure
zero, it follows from the uniform convergence that XÎ½ is also continuous oï¬€a set of
measure zero.
Claim 4: For a.e. Ï‰,
lim
nâ†’âˆžXÂµn (Ï‰) = XÂµ (Ï‰) .
Proof of the claim: From Claim 3 and letting Îµ > 0 be given, there exists m
large enough that for all n,
||ZÂµn
m âˆ’XÂµn||âˆž< Îµ/3, ||ZÂµ
m âˆ’XÂµ||âˆž< Îµ/3.
Now pick Ï‰ âˆˆ[0, 1) such that Ï‰ is not equal to any of the end points of any of the
intervals,
Â©
IÎ½
i1,Â·Â·Â·,im
Âª
, a set of measure zero. Then by Claim 2, there exists N such
that if n â‰¥N, then
Â¯Â¯Â¯Â¯ZÂµn
m (Ï‰) âˆ’ZÂµ
m (Ï‰)
Â¯Â¯Â¯Â¯
E < Îµ/3. Therefore, for such n and this Ï‰,
||XÂµn (Ï‰) âˆ’XÂµ (Ï‰)||E
â‰¤
||XÂµn (Ï‰) âˆ’ZÂµn
m (Ï‰)||E + ||ZÂµn
m (Ï‰) âˆ’ZÂµ
m (Ï‰)||E
+ ||ZÂµ
m (Ï‰) âˆ’XÂµ (Ï‰)||
<
Îµ/3 + Îµ/3 + Îµ/3 = Îµ.
This proves the claim.
Showing L (XÎ½) = Î½.
This has mostly proved the theorem except for the claim that L (XÎ½) = Î½ for
Î½ = Âµn and Âµ. To do this, I will ï¬rst show m
Â³
(XÎ½)âˆ’1 (âˆ‚Ai1,Â·Â·Â·,im)
Â´
= 0. By the

1012
PROBABILITY IN INFINITE DIMENSIONS
construction, Î½ (âˆ‚Ai1,Â·Â·Â·,im) = 0. Let Îµ > 0 be given and let Î´ > 0 be small enough
that
HÎ´ â‰¡{x âˆˆE : dist (x, âˆ‚Ai1,Â·Â·Â·,im) â‰¤Î´}
is a set of measure less than Îµ/2.
Denote by Gk the sets of the form Ai1,Â·Â·Â·,ik
where (i1, Â· Â· Â·, ik) âˆˆNk. Recall also that corresponding to Ai1,Â·Â·Â·,ik is an interval,
IÎ½
i1,Â·Â·Â·,ik having length equal to Î½ (Ai1,Â·Â·Â·,ik) . Denote by Bk those sets of Gk which
have nonempty intersection with HÎ´ and let the corresponding intervals be denoted
by IÎ½
k. If Ï‰ /âˆˆâˆªIÎ½
k, then from the construction, ZÎ½
p (Ï‰) is at a distance of at least
Î´ from âˆ‚Ai1,Â·Â·Â·,im for all p â‰¥k and so, passing to the limit as p â†’âˆž, it follows
XÎ½ (Ï‰) /âˆˆâˆ‚Ai1,Â·Â·Â·,im. Therefore,
(XÎ½)âˆ’1 (âˆ‚Ai1,Â·Â·Â·,im) âŠ†âˆªIÎ½
k
Recall that Ai1,Â·Â·Â·,ik âŠ†B (aik, rk) and the rk â†’0. Therefore, if k is large enough,
Î½ (âˆªBk) < Îµ
because âˆªBk approximates HÎ´ closely (In fact, âˆ©âˆž
k=1 (âˆªBk) = HÎ´.). Therefore,
m
Â³
(XÎ½)âˆ’1 (âˆ‚Ai1,Â·Â·Â·,im)
Â´
â‰¤
m (âˆªIÎ½
k)
=
X
IÎ½
i1,Â·Â·Â·,ik âˆˆIÎ½
k
m
Â¡
IÎ½
i1,Â·Â·Â·,ik
Â¢
=
X
Ai1,Â·Â·Â·,ik âˆˆBk
Î½ (Ai1,Â·Â·Â·,ik)
=
Î½ (âˆªBk) < Îµ.
Since Îµ > 0 is arbitrary, this shows m
Â³
(XÎ½)âˆ’1 (âˆ‚Ai1,Â·Â·Â·,im)
Â´
= 0.
If Ï‰ âˆˆIÎ½
i1,Â·Â·Â·,im, then from the construction, ZÎ½
p (Ï‰) âˆˆint (Ai1,Â·Â·Â·,im) for all p â‰¥k.
Therefore, taking a limit, as p â†’âˆž,
XÎ½ (Ï‰) âˆˆint (Ai1,Â·Â·Â·,im) âˆªâˆ‚Ai1,Â·Â·Â·,im
and so
IÎ½
i1,Â·Â·Â·,im âŠ†(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im) âˆªâˆ‚Ai1,Â·Â·Â·,im)
but also, if XÎ½ (Ï‰) âˆˆint (Ai1,Â·Â·Â·,im) , then ZÎ½
p (Ï‰) âˆˆint (Ai1,Â·Â·Â·,im) for all p large
enough and so
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
âŠ†
IÎ½
i1,Â·Â·Â·,im
âŠ†
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im) âˆªâˆ‚Ai1,Â·Â·Â·,im)

36.5.
A MAJOR EXISTENCE AND CONVERGENCE THEOREM
1013
Therefore,
m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
Â´
â‰¤
m
Â¡
IÎ½
i1,Â·Â·Â·,im
Â¢
â‰¤
m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
Â´
+ m
Â³
(XÎ½)âˆ’1 (âˆ‚Ai1,Â·Â·Â·,im)
Â´
=
m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
Â´
which shows
m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
Â´
= m
Â¡
IÎ½
i1,Â·Â·Â·,im
Â¢
= Î½ (Ai1,Â·Â·Â·,im) .
(36.12)
Also
m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
Â´
â‰¤
m
Â³
(XÎ½)âˆ’1 (Ai1,Â·Â·Â·,im)
Â´
â‰¤
m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im) âˆªâˆ‚Ai1,Â·Â·Â·,im)
Â´
=
m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
Â´
Hence from 36.12,
Î½ (Ai1,Â·Â·Â·,im) = m
Â³
(XÎ½)âˆ’1 (int (Ai1,Â·Â·Â·,im))
Â´
= m
Â³
(XÎ½)âˆ’1 (Ai1,Â·Â·Â·,im)
Â´
(36.13)
Now let U be an open set in E. Then letting
Hk =
Â©
x âˆˆU : dist
Â¡
x, U CÂ¢
â‰¥rk
Âª
it follows
âˆªkHk = U.
Next consider the sets of Gk which have nonempty intersection with Hk, Hk. Then
Hk is covered by Hk and every set of Hk is contained in U, the sets of Hk also being
disjoint. Then from 36.13,
m
Â³
(XÎ½)âˆ’1 (âˆªHk)
Â´
=
X
AâˆˆHk
m
Â³
(XÎ½)âˆ’1 (A)
Â´
=
X
AâˆˆHk
Î½ (A) = Î½ (âˆªHk) .
Therefore, letting k â†’âˆžand passing to the limit in the above,
m
Â³
(XÎ½)âˆ’1 (U)
Â´
= Î½ (U) .
Since this holds for every open set, it is routine to verify using regularity that it
holds for every Borel set and so L (XÎ½) = Î½ as claimed. This proves the theorem.

1014
PROBABILITY IN INFINITE DIMENSIONS
36.6
Characteristic Functions
Recall the characteristic function for a random variable having values in Rn. I will
give a review of this to begin with. Then the concept will be generalized to random
variables (vectors) which have values in a real separable Banach space.
Deï¬nition 36.28 Let X be a random variable. The characteristic function is
Ï†X (t) â‰¡E
Â¡
eitÂ·XÂ¢
â‰¡
Z
â„¦
eitÂ·X(Ï‰)dP =
Z
Rp eitÂ·xdÎ»X
the last equation holding by Lemma 31.4 on Page 858.
Recall the following fundamental lemma and deï¬nition, Lemma 19.12 on Page
522.
Deï¬nition 36.29 For T âˆˆGâˆ—, deï¬ne FT, F âˆ’1T âˆˆGâˆ—by
FT (Ï†) â‰¡T (FÏ†) , F âˆ’1T (Ï†) â‰¡T
Â¡
F âˆ’1Ï†
Â¢
Lemma 36.30 F and F âˆ’1 are both one to one, onto, and are inverses of each
other.
The main result on characteristic functions is the following is in Theorem 31.10
on Page 860 which is stated here for convenience.
Theorem 36.31 Let X and Y be random vectors with values in Rp and suppose
E
Â¡
eitÂ·XÂ¢
= E
Â¡
eitÂ·YÂ¢
for all t âˆˆRp. Then Î»X = Î»Y.
I want to do something similar for random variables which have values in a
separable real Banach space, E instead of Rp.
Corollary 36.32 Let K be a Ï€ system of subsets of â„¦and suppose two probability
measures, Âµ and Î½ deï¬ned on Ïƒ (K) are equal on K. Then Âµ = Î½.
Proof: This follows from the Lemma 9.72 on Page 257. Let
G â‰¡{E âˆˆÏƒ (K) : Âµ (E) = Î½ (E)}
Then K âŠ†G, since Âµ and Î½ are both probability measures, it follows that if E âˆˆG,
then so is EC. Since these are measures, if {Ai} is a sequence of disjoint sets from
G then
Âµ (âˆªâˆž
i=1Ai) =
X
i
Âµ (Ai) =
X
i
Î½ (Ai) = Î½ (âˆªâˆž
i=1A)
and so from Lemma 9.72, G = Ïƒ (K) . This proves the corollary.
Next recall the following fundamental lemma used to prove Pettisâ€™ theorem. It
is proved on Page 579 but is stated here for convenience.

36.6.
CHARACTERISTIC FUNCTIONS
1015
Lemma 36.33 If E is a separable Banach space with Bâ€² the closed unit ball in Eâ€²,
then there exists a sequence {fn}âˆž
n=1 â‰¡Dâ€² âŠ†Bâ€² with the property that for every
x âˆˆE,
||x|| = sup
fâˆˆDâ€² |f (x)|
Deï¬nition 36.34 Let E be a separable real Banach space. A cylindrical set is one
which is of the form
{x âˆˆE : xâˆ—
i (x) âˆˆÎ“i, i = 1, 2, Â· Â· Â·, m}
where here xâˆ—
i âˆˆEâ€² and Î“i is a Borel set in R.
It is obvious that âˆ…is a cylindrical set and that the intersection of two cylindrical
sets is another cylindrical set. Thus the cylindrical sets form a Ï€ system. What is
the smallest Ïƒ algebra containing the cylindrical sets? Letting {fn}âˆž
n=1 = Dâ€² be the
sequence of Lemma 36.33 it follows that
{x âˆˆE : ||x âˆ’a|| â‰¤Î´}
=
(
x âˆˆE : sup
fâˆˆDâ€² |f (x âˆ’a)| â‰¤Î´
)
=
(
x âˆˆE : sup
fâˆˆDâ€² |f (x) âˆ’f (a)| â‰¤Î´
)
=
âˆ©âˆž
n=1
n
x âˆˆE : fn (x) âˆˆB (fn (a) , Î´)
o
which yields a countable intersection of cylindrical sets. It follows the smallest Ïƒ
algebra containing the cylindrical sets contains the closed balls and hence the open
balls and consequently the open sets and so it contains the Borel sets. However,
each cylindrical set is a Borel set and so in fact this Ïƒ algebra equals B (E).
From Corollary 36.32 it follows that two probability measures which are equal
on the cylindrical sets are equal on the Borel sets, B (E).
Deï¬nition 36.35 Let Âµ be a probability measure on a real separable Banach space,
E. Then for xâˆ—âˆˆEâ€²,
Ï†Âµ (xâˆ—) â‰¡
Z
E
eixâˆ—(x)dÂµ (x) .
Ï†Âµ is called the characteristic function for the measure Âµ.
Note this is a little diï¬€erent than earlier when the symbol Ï†X (t) was used and
X was a random variable. Here the focus is more on the measure than a random
variable, X such that L (X) = Âµ but it does not matter much because of Skorokhodâ€™s
theorem presented above. The fundamental result is the following theorem.

1016
PROBABILITY IN INFINITE DIMENSIONS
Theorem 36.36 Let Âµ and Î½ be two probability measures on B (E) where E is a
separable real Banach space. Suppose
Ï†Âµ (xâˆ—) = Ï†Î½ (xâˆ—)
for all xâˆ—âˆˆEâ€². Then Âµ = Î½.
Proof: Let xâˆ—
1, Â· Â· Â·, xâˆ—
n be in Eâ€² and deï¬ne for A a Borel set of Rn,
eÂµ (A)
â‰¡
Âµ ({x âˆˆE : (xâˆ—
1 (x) , Â· Â· Â·, xâˆ—
n (x)) âˆˆA}) ,
eÎ½ (A)
â‰¡
Î½ ({x âˆˆE : (xâˆ—
1 (x) , Â· Â· Â·, xâˆ—
n (x)) âˆˆA}) .
(36.14)
Note these sets in the parentheses are cylindrical sets. Letting Î» âˆˆRn, consider in
the deï¬nition of the characteristic function, Î»1xâˆ—
1 + Â· Â· Â· + Î»nxâˆ—
n âˆˆEâ€². Thus
Z
E
ei(Î»1xâˆ—
1(x)+Â·Â·Â·+Î»nxâˆ—
n(x))dÂµ =
Z
E
ei(Î»1xâˆ—
1(x)+Â·Â·Â·+Î»nxâˆ—
n(x))dÎ½
Now if F is a Borel measurable subset of Rn,
Z
Rn XF (y) deÂµ (y) = eÂµ (F)
â‰¡
Âµ ({x âˆˆE : (xâˆ—
1 (x) , Â· Â· Â·, xâˆ—
n (x)) âˆˆF})
=
Z
E
XF (xâˆ—
1 (x) , Â· Â· Â·, xâˆ—
n (x)) dÂµ
and using the usual approximations involving simple functions, it follows that for
any f bounded and Borel measurable,
Z
Rn f (y) deÂµ (y) =
Z
E
f ((xâˆ—
1 (x) , Â· Â· Â·, xâˆ—
n (x))) dÂµ (x) .
Similarly,
Z
Rn f (y) deÎ½ (y) =
Z
E
f ((xâˆ—
1 (x) , Â· Â· Â·, xâˆ—
n (x))) dÎ½ (x) ,
Therefore,
Z
Rn eiÎ»Â·ydeÂµ (y)
=
Z
E
ei(Î»1xâˆ—
1(x)+Â·Â·Â·+Î»nxâˆ—
n(x))dÂµ
=
Z
E
ei(Î»1xâˆ—
1(x)+Â·Â·Â·+Î»nxâˆ—
n(x))dÎ½
=
Z
Rn eiÎ»Â·ydeÎ½ (y)
which shows from Theorem 36.31 that eÎ½ = eÂµ on the Borel sets of Rn. However,
from the deï¬nition of these measures in 36.14 this says nothing more than Âµ = Î½

36.6.
CHARACTERISTIC FUNCTIONS
1017
on any cylindrical set. Hence by Corollary 36.32 this shows Âµ = Î½ on B (E) . This
proves the theorem.
Finally, I will consider the relation between the characteristic function and in-
dependence of random variables. Recall an earlier proposition which relates inde-
pendence of random vectors with characteristic functions. It is proved starting on
Page 865 in the case of two random variables and concludes with the observation
that the general case is entirely similar but more tedious to write down.
Proposition 36.37 Let {Xk}n
k=1be random vectors such that Xk has values in
Rpk. Then the random vectors are independent if and only if
E
Â¡
eiP Â¢
=
n
Y
j=1
E
Â¡
eitjÂ·XjÂ¢
where P â‰¡Pn
j=1 tj Â· Xj for tj âˆˆRpj.
It turns out there is a generalization of the above proposition to the case where
the random variables have values in a real separable Banach space. Before proving
this recall an earlier theorem which had to do with reducing to the case where the
random variables had values in Rn. It is restated here for convenience.
Theorem 36.38 The random variables, {Xi}iâˆˆI are independent if whenever
{i1, Â· Â· Â·, in} âŠ†I,
mi1, Â·Â·Â·, min are positive integers, and gmi1 , Â·Â·Â·, gmin are in (Eâ€²)mi1 , Â·Â·Â·, (Eâ€²)mn re-
spectively,
n
gmij â—¦Xij
on
j=1 are independent random vectors having values in Rmi1 , Â·Â·
Â·, Rmin respectively.
Now here is the theorem about independence and the characteristic functions.
Theorem 36.39 Let {Xk}n
k=1be random variables having values in E, a real sep-
arable Banach space. Then the random variables are independent if and only if
E
Â¡
eiP Â¢
=
n
Y
j=1
E
Â³
eitâˆ—
j (Xj)Â´
where P â‰¡Pn
j=1 tâˆ—
j (Xj) for tâˆ—
j âˆˆEâ€².
Proof: If the random variables are independent, then so are the random vari-
ables, tâˆ—
j (Xj) and so the equation follows.
The interesting case is when the equation holds. Can you draw the conclusion
the random variables are independent? By Theorem 36.38, it suï¬ƒces to show the
random variables {gmk â—¦Xk}n
k=1 are independent. This happens if whenever tmk âˆˆ
Rmk and
P =
n
X
k=1
tmk Â· (gmk â—¦Xk) ,

1018
PROBABILITY IN INFINITE DIMENSIONS
it follows
E
Â¡
eiP Â¢
=
n
Y
j=1
E
Â³
eitmk Â·(gmk â—¦Xk)Â´
.
(36.15)
Now consider one of these terms in the exponent on the right.
tmk Â· (gmk â—¦Xk) (Ï‰)
=
mk
X
j=1
tjxâˆ—
j (Xk (Ï‰))
=
yâˆ—
k (Xk (Ï‰))
where yâˆ—â‰¡Pmk
j=1 tjxâˆ—
j. Therefore, 36.15 reduces to
E
Â³
ei Pn
k=1 yâˆ—
k(Xk)Â´
=
n
Y
k=1
E
Â³
eiyâˆ—
k(Xk)Â´
which is assumed to hold. Therefore, the random variables are independent. This
proves the theorem.
There is an obvious corollary which is useful.
Corollary 36.40 Let {Xk}n
k=1be random variables having values in E, a real sep-
arable Banach space. Then the random variables are independent if and only if
E
Â¡
eiP Â¢
=
n
Y
j=1
E
Â³
eitâˆ—
j (Xj)Â´
where P â‰¡Pn
j=1 tâˆ—
j (Xj) for tâˆ—
j âˆˆM where M is a dense subset of Eâ€².
Proof: The easy direction follows from Theorem 36.39. Suppose then the above
equation holds for all tâˆ—
j âˆˆM. Then let tâˆ—
j âˆˆEâ€² and let
Â©
tâˆ—
nj
Âª
be a sequence in M
such that
lim
nâ†’âˆžtâˆ—
nj = tâˆ—
j in Eâ€²
Then deï¬ne
P â‰¡
n
X
j=1
tâˆ—
jXj, Pn â‰¡
n
X
j=1
tâˆ—
njXj.
It follows
E
Â¡
eiP Â¢
=
lim
nâ†’âˆžE
Â¡
eiPnÂ¢
=
lim
nâ†’âˆž
n
Y
j=1
E
Â³
eitâˆ—
nj(Xj)Â´
=
n
Y
j=1
E
Â³
eitâˆ—
j (Xj)Â´
and this proves the corollary.

36.7.
CONVOLUTION
1019
36.7
Convolution
Lemma 36.18 on Page 1002 makes possible a deï¬nition of convolution of two prob-
ability measures deï¬ned on B (E) where E is a separable Banach space as well as
some other interesting theorems which held earlier in the context of locally compact
spaces. I will ï¬rst show a little theorem about density of continuous functions in
Lp (E) and then deï¬ne the convolution of two ï¬nite measures. First here is a simple
technical lemma.
Lemma 36.41 Suppose K is a compact subset of U an open set in E a metric
space. Then there exists Î´ > 0 such that
dist (x, K) + dist
Â¡
x, U CÂ¢
â‰¥Î´ for all x âˆˆE.
Proof: For each x âˆˆK, there exists a ball, B (x, Î´x) such that B (x, 3Î´x) âŠ†U.
Finitely many of these balls cover K because K is compact, say {B (xi, Î´xi)}m
i=1.
Let
0 < Î´ < min (Î´xi : i = 1, 2, Â· Â· Â·, m) .
Now pick any x âˆˆK. Then x âˆˆB (xi, Î´xi) for some xi and so B (x, Î´) âŠ†B (xi, 2Î´xi) âŠ†
U. Therefore, for any x âˆˆK, dist
Â¡
x, U CÂ¢
â‰¥Î´. If x âˆˆB (xi, 2Î´xi) for some xi, it
follows dist
Â¡
x, U CÂ¢
â‰¥Î´ because then B (x, Î´) âŠ†B (xi, 3Î´xi) âŠ†U. If x /âˆˆB (xi, 2Î´xi)
for any of the xi, then x /âˆˆB (y, Î´) for any y âˆˆK because all these sets are contained
in some B (xi, 2Î´xi) . Consequently dist (x, K) â‰¥Î´. This proves the lemma.
From this lemma, there is an easy corollary.
Corollary 36.42 Suppose K is a compact subset of U, an open set in E a metric
space. Then there exists a uniformly continuous function f deï¬ned on all of E,
having values in [0, 1] such that f (x) = 0 if x /âˆˆU and f (x) = 1 if x âˆˆK.
Proof: Consider
f (x) â‰¡
dist
Â¡
x, U CÂ¢
dist (x, U C) + dist (x, K).
Then some algebra yields
|f (x) âˆ’f (xâ€²)| â‰¤
1
Î´
Â¡Â¯Â¯dist
Â¡
x, U CÂ¢
âˆ’dist
Â¡
xâ€², U CÂ¢Â¯Â¯ + |dist (x, K) âˆ’dist (xâ€², K)|
Â¢
where Î´ is the constant of Lemma 36.41. Now it is a general fact that
|dist (x, S) âˆ’dist (xâ€², S)| â‰¤d (x, xâ€²) .
Therefore,
|f (x) âˆ’f (xâ€²)| â‰¤2
Î´ d (x, xâ€²)
and this proves the corollary.

1020
PROBABILITY IN INFINITE DIMENSIONS
Now suppose Âµ is a ï¬nite measure deï¬ned on the Borel sets of a separable Banach
space, E. It was shown above that Âµ is inner and outer regular. Lemma 36.18 on
Page 1002 shows that Âµ is inner regular in the usual sense with respect to compact
sets. This makes possible the following theorem.
Theorem 36.43 Let Âµ be a ï¬nite measure on B (E) where E is a separable Banach
space and let f âˆˆLp (E; Âµ) . Then for any Îµ > 0, there exists a uniformly continuous,
bounded g deï¬ned on E such that
||f âˆ’g||Lp(E) < Îµ.
Proof: As usual in such situations, it suï¬ƒces to consider only f â‰¥0. Then
by Theorem 8.27 on Page 190 and an application of the monotone convergence
theorem, there exists a simple measurable function,
s (x) â‰¡
m
X
k=1
ckXAk (x)
such that ||f âˆ’s||Lp(E) < Îµ/2. Now by regularity of Âµ there exist compact sets,
Kk and open sets, Vk such that 2 Pm
k=1 |ck| Âµ (Vk \ K)1/p < Îµ/2 and by Corollary
36.42 there exist uniformly continuous functions gk having values in [0, 1] such that
gk = 1 on Kk and 0 on V C
k . Then consider
g (x) =
m
X
k=1
ckgk (x) .
This function is bounded and uniformly continuous. Furthermore,
||s âˆ’g||Lp(E)
â‰¤
ÃƒZ
E
Â¯Â¯Â¯Â¯Â¯
m
X
k=1
ckXAk (x) âˆ’
m
X
k=1
ckgk (x)
Â¯Â¯Â¯Â¯Â¯
p
dÂµ
!1/p
â‰¤
ÃƒZ
E
Ãƒ m
X
k=1
|ck| |XAk (x) âˆ’gk (x)|
!p!1/p
â‰¤
m
X
k=1
|ck|
ÂµZ
E
|XAk (x) âˆ’gk (x)|p dÂµ
Â¶1/p
â‰¤
m
X
k=1
|ck|
ÃƒZ
Vk\Kk
2pdÂµ
!1/p
=
2
m
X
k=1
|ck| Âµ (Vk \ K)1/p < Îµ/2.
Therefore,
||f âˆ’g||Lp â‰¤||f âˆ’s||Lp + ||s âˆ’g||Lp < Îµ/2 + Îµ/2.
This proves the theorem.

36.7.
CONVOLUTION
1021
Lemma 36.44 Let A âˆˆB (E) where Âµ is a ï¬nite measure on B (E) for E a sepa-
rable Banach space. Also let xi âˆˆE for i = 1, 2, Â· Â· Â·, m. Then for x âˆˆEm,
x â†’Âµ
Ãƒ
A +
m
X
i=1
xi
!
, x â†’Âµ
Ãƒ
A âˆ’
m
X
i=1
xi
!
are Borel measurable functions. Furthermore, the above functions are
B (E) Ã— Â· Â· Â· Ã— B (E)
measurable where the above denotes the product measurable sets as described in
Theorem 9.75 on Page 260.
Proof: First consider the case where A = U, an open set. Let
y âˆˆ
(
x âˆˆEm : Âµ
Ãƒ
U +
m
X
i=1
xi
!
> Î±
)
(36.16)
Then from Lemma 36.18 on Page 1002 there exists a compact set, K âŠ†U +Pm
i=1 yi
such that Âµ (K) > Î±. Then if yâ€² is close enough to y, it follows K âŠ†U + Pm
i=1 yâ€²
i
also. Therefore, for all yâ€² close enough to y,
Âµ
Ãƒ
U +
m
X
i=1
yâ€²
i
!
â‰¥Âµ (K) > Î±.
In other words the set described in 36.16 is an open set and so y â†’Âµ (U + Pm
i=1 yi)
is Borel measurable whenever U is an open set in E.
Deï¬ne a Ï€ system, K to consist of all open sets in E. Then deï¬ne G as
(
A âˆˆÏƒ (K) = B (E) : y â†’Âµ
Ãƒ
A +
m
X
i=1
yi
!
is Borel measurable
)
I just showed G âŠ‡K. Now suppose A âˆˆG. Then
Âµ
Ãƒ
AC +
m
X
i=1
yi
!
= Âµ (E) âˆ’Âµ
Ãƒ
A +
m
X
i=1
yi
!
and so AC âˆˆG whenever A âˆˆG. Next suppose {Ai} is a sequence of disjoint sets
of G. Then
Âµ
ï£«
ï£­(âˆªâˆž
i=1Ai) +
m
X
j=1
yj
ï£¶
ï£¸
=
Âµ
ï£«
ï£­âˆªâˆž
i=1
ï£«
ï£­Ai +
m
X
j=1
yj
ï£¶
ï£¸
ï£¶
ï£¸
=
âˆž
X
i=1
Âµ
ï£«
ï£­Ai +
m
X
j=1
yj
ï£¶
ï£¸

1022
PROBABILITY IN INFINITE DIMENSIONS
and so âˆªâˆž
i=1Ai âˆˆG because it is the sum of Borel measurable functions. By the
lemma on Ï€ systems, Lemma 9.72 on Page 257, it follows G = Ïƒ (K) = B (E) .
Similarly, x â†’Âµ
Â³
A âˆ’Pm
j=1 xj
Â´
is also Borel measurable whenever A âˆˆB (E).
Finally note that
B (E) Ã— Â· Â· Â· Ã— B (E)
contains the open sets of Em because the separability of E implies the existence of
a countable basis for the topology of Em consisting of sets of the form
m
Y
i=1
Ui
where the Ui come from a countable basis for E. Since every open set is the countable
union of sets like the above, each being a measurable box, the open sets are contained
in
B (E) Ã— Â· Â· Â· Ã— B (E)
which implies B (Em) âŠ†B (E) Ã— Â· Â· Â· Ã— B (E) also. This proves the lemma.
With this lemma, it is possible to deï¬ne the convolution of two ï¬nite measures.
Deï¬nition 36.45 Let Âµ and Î½ be two ï¬nite measures on B (E) , for E a separable
Banach space. Then deï¬ne a new measure, Âµ âˆ—Î½ on B (E) as follows
Âµ âˆ—Î½ (A) â‰¡
Z
E
Î½ (A âˆ’x) dÂµ (x) .
This is well deï¬ned because of Lemma 36.44 which says that x â†’Î½ (A âˆ’x) is Borel
measurable.
Here is an interesting theorem about convolutions. However, ï¬rst here is a little
lemma. The following picture is descriptive of the set described in the following
lemma.
A
@
@
@
@
@
@
@
@
@
@
@
@
@
@
@
@
@
E
E
SA
Lemma 36.46 For A a Borel set in E, a separable Banach space, deï¬ne
SA â‰¡{(x, y) âˆˆE Ã— E : x + y âˆˆA}
Then SA âˆˆB (E) Ã— B (E) , the Ïƒ algebra of product measurable sets, the smallest Ïƒ
algebra which contains all the sets of the form A Ã— B where A and B are Borel.

36.7.
CONVOLUTION
1023
Proof: Let K denote the open sets in E. Then K is a Ï€ system. Let
G â‰¡{A âˆˆÏƒ (K) = B (E) : SA âˆˆB (E) Ã— B (E)} .
Then K âŠ†G because if U âˆˆK then SU is an open set in E Ã— E and all open sets
are in B (E) Ã— B (E) because a countable basis for the topology of E Ã— E are sets
of the form B Ã— C where B and C come from a countable basis for E. Therefore,
K âŠ†G. Now let A âˆˆG. For (x, y) âˆˆE Ã— E, either x + y âˆˆA or x + y /âˆˆA. Hence
E Ã— E = SA âˆªSAC which shows that if A âˆˆG then so is AC. Finally if {Ai} is a
sequence of disjoint sets of G
Sâˆªâˆž
i=1Ai = âˆªâˆž
i=1SAi
and this shows that G is also closed with respect to countable unions of disjoint
sets. Therefore, by the lemma on Ï€ systems, Lemma 9.72 on Page 257 it follows
G = Ïƒ (K) = B (E) . This proves the lemma.
Theorem 36.47 Let Âµ, Î½, and Î» be ï¬nite measures on B (E) for E a separable
Banach space. Then
Âµ âˆ—Î½ = Î½ âˆ—Âµ
(36.17)
(Âµ âˆ—Î½) âˆ—Î» = Âµ âˆ—(Î½ âˆ—Î»)
(36.18)
If Âµ is the distribution for an E valued random variable, X and if Î½ is the distribution
for an E valued random variable, Y, and X and Y are independent, then Âµ âˆ—Î½ is
the distribution for the random variable, X + Y .
Proof: First consider 36.17. Letting A âˆˆB (E) , the following computation
holds from Fubiniâ€™s theorem and Lemma 36.46
Âµ âˆ—Î½ (A)
â‰¡
Z
E
Î½ (A âˆ’x) dÂµ (x) =
Z
E
Z
E
XSA (x, y) dÎ½ (y) dÂµ (x)
=
Z
E
Z
E
XSA (x, y) dÂµ (x) dÎ½ (y) = Î½ âˆ—Âµ (A) .
Next consider 36.18. Using 36.17 whenever convenient,
(Âµ âˆ—Î½) âˆ—Î» (A)
â‰¡
Z
E
(Âµ âˆ—Î½) (A âˆ’x) dÎ» (x)
=
Z
E
Z
E
Î½ (A âˆ’x âˆ’y) dÂµ (y) dÎ» (x)
while
Âµ âˆ—(Î½ âˆ—Î») (A)
â‰¡
Z
E
(Î½ âˆ—Î») (A âˆ’y) dÂµ (y)
=
Z
E
Z
E
Î½ (A âˆ’y âˆ’x) dÎ» (x) dÂµ (y)
=
Z
E
Z
E
Î½ (A âˆ’y âˆ’x) dÂµ (y) dÎ» (x) .

1024
PROBABILITY IN INFINITE DIMENSIONS
The necessary product measurability comes from Lemma 36.44.
Recall
(Âµ âˆ—Î½) (A) â‰¡
Z
E
Î½ (A âˆ’x) dÂµ (x) .
Therefore, if s is a simple function, s (x) = Pn
k=1 ckXAk (x) ,
Z
E
sd (Âµ âˆ—Î½)
=
n
X
k=1
ck
Z
E
Î½ (Ak âˆ’x) dÂµ (x)
=
Z
E
n
X
k=1
ckÎ½ (Ak âˆ’x) dÂµ (x)
=
Z
E
Z
E
s (x + y) dÎ½ (x) dÂµ (y)
Approximating with simple functions it follows that whenever f is bounded and
measurable or nonnegative and measurable,
Z
E
fd (Âµ âˆ—Î½) =
Z
E
Z
E
f (x + y) dÎ½ (y) dÂµ (x)
(36.19)
Therefore, letting Z = X + Y, and Î» the distribution of Z, it follows from indepen-
dence of X and Y that for tâˆ—âˆˆEâ€²,
Ï†Î» (tâˆ—) â‰¡E
Â³
eitâˆ—(Z)Â´
= E
Â³
eitâˆ—(X+Y )Â´
= E
Â³
eitâˆ—(X)Â´
E
Â³
eitâˆ—(Y )Â´
But also, it follows from 36.19
Ï†(Âµâˆ—Î½) (tâˆ—)
=
Z
E
eitâˆ—(z)d (Âµ âˆ—Î½) (z)
=
Z
E
Z
E
eitâˆ—(x+y)dÎ½ (y) dÂµ (x)
=
Z
E
Z
E
eitâˆ—(x)eitâˆ—(y)dÎ½ (y) dÂµ (x)
=
ÂµZ
E
eitâˆ—(y)dÎ½ (y)
Â¶ ÂµZ
E
eitâˆ—(x)dÂµ (x)
Â¶
=
E
Â³
eitâˆ—(X)Â´
E
Â³
eitâˆ—(Y )Â´
Since Ï†Î» (tâˆ—) = Ï†(Âµâˆ—Î½) (tâˆ—) , it follows Î» = Âµ âˆ—Î½. This proves the theorem.
Note the last part of this argument shows the characteristic function of a con-
volution equals the product of the characteristic functions.
36.8
The Multivariate Normal Distribution
Here I give a review of the main theorems and deï¬nitions about multivariate normal
random variables. Recall that for a random vector (variable), X having values in

36.8.
THE MULTIVARIATE NORMAL DISTRIBUTION
1025
Rp, Î»X is the law of X deï¬ned by
P ([X âˆˆE]) = Î»X (E)
for all E a Borel set in Rp. In diï¬€erent notaion, L (X) = Î»X. Then the following
deï¬nitions and theorems are proved and presented starting on Page 867
Deï¬nition 36.48 A random vector, X, with values in Rp has a multivariate nor-
mal distribution written as X âˆ¼Np (m, Î£) if for all Borel E âŠ†Rp,
Î»X (E) =
Z
Rp XE (x)
1
(2Ï€)p/2 det (Î£)1/2 e
âˆ’1
2 (xâˆ’m)âˆ—Î£âˆ’1(xâˆ’m)dx
for Âµ a given vector and Î£ a given positive deï¬nite symmetric matrix.
Theorem 36.49 For X âˆ¼Np (m, Î£) , m = E (X) and
Î£ = E
Â¡
(X âˆ’m) (X âˆ’m)âˆ—Â¢
.
Theorem 36.50 Suppose X1 âˆ¼Np (m1, Î£1) , X2 âˆ¼Np (m2, Î£2) and the two ran-
dom vectors are independent. Then
X1 + X2 âˆ¼Np (m1 + m2, Î£1 + Î£2).
(36.20)
Also, if X âˆ¼Np (m, Î£) then âˆ’X âˆ¼Np (âˆ’m, Î£) . Furthermore, if X âˆ¼Np (m, Î£)
then
E
Â¡
eitÂ·XÂ¢
= eitÂ·meâˆ’1
2 tâˆ—Î£t
(36.21)
Also if a is a constant and X âˆ¼Np (m, Î£) then aX âˆ¼Np
Â¡
am, a2Î£
Â¢
.
Following [42] a random vector has a generalized normal distribution if its char-
acteristic function is given as
eitÂ·meâˆ’1
2 tâˆ—Î£t
(36.22)
where Î£ is symmetric and has nonnegative eigenvalues. For a random real valued
variable, m is scalar and so is Î£ so the characteristic function of such a generalized
normally distributed random variable is
eitmeâˆ’1
2 t2Ïƒ2
(36.23)
These generalized normal distributions do not require Î£ to be invertible, only that
the eigenvalues by nonnegative. In one dimension this would correspond the charac-
teristic function of a dirac measure having point mass 1 at m. In higher dimensions,
it could be a mixture of such things with more familiar things. I will often not
bother to distinguish between generalized normal and normal distributions.
Here are some other interesting results about normal distributions found in [42].
The next theorem has to do with the question whether a random vector is normally
distributed in the above generalized sense. It is proved on Page 870.

1026
PROBABILITY IN INFINITE DIMENSIONS
Theorem 36.51 Let X = (X1, Â· Â· Â·, Xp) where each Xi is a real valued random
variable. Then X is normally distributed in the above generalized sense if and only
if every linear combination, Pp
j=1 aiXi is normally distributed. In this case the
mean of X is
m = (E (X1) , Â· Â· Â·, E (Xp))
and the covariance matrix for X is
Î£jk = E ((Xj âˆ’mj) (Xk âˆ’mk))
where mj = E (Xj).
Also proved there is the interesting corollary listed next.
Corollary 36.52 Let X = (X1, Â· Â· Â·, Xp) , Y = (Y1, Â· Â· Â·, Yp) where each Xi, Yi is a
real valued random variable. Suppose also that for every a âˆˆRp, a Â· X and a Â· Y
are both normally distributed with the same mean and variance. Then X and Y are
both multivariate normal random vectors with the same mean and variance.
Theorem 36.53 Suppose X = (X1, Â· Â· Â·, Xp) is normally distributed with mean m
and covariance Î£. Then if X1 is uncorrelated with any of the Xi,
E ((X1 âˆ’m1) (Xj âˆ’mj)) = 0 for j > 1
then X1 and (X2, Â· Â· Â·, Xp) are both normally distributed and the two random vectors
are independent. Here mj â‰¡E (Xj) .
Next I will consider the question of existence of independent random variables
having a given law.
Lemma 36.54 Let Âµ be a probability measure on B (E) , the Borel subsets of a
separable real Banach space. Then there exists a probability space (â„¦, F, P) and two
independent random variables, X, Y mapping â„¦to E such that L (X) = L (Y ) = Âµ.
Proof: First note that if A, B are Borel sets of E then A Ã— B is a Borel set in
E Ã— E where the norm on E Ã— E is given by
||(x, y)|| â‰¡max (||x|| , ||y||) .
This can be proved by letting A be open and considering
G â‰¡{B âˆˆB (E) : A Ã— B âˆˆB (A Ã— B)} .
Show G is a Ïƒ algebra and it contains the open sets. Therefore, this will show AÃ—B
is in B (A Ã— B) whenever A is open and B is Borel. Next repeat a similar argument
to show that this is true whenever either set is Borel. Since E is separable, it is
completely separable and so is E Ã— E. Thus every open set in E Ã— E is the union

36.8.
THE MULTIVARIATE NORMAL DISTRIBUTION
1027
of balls from a countable set. However, these balls are of the form B1 Ã— B2 where
Bi is a ball in E. Now let
K â‰¡{A Ã— B : A, B are Borel}
Then K âŠ†B (E Ã— E) as was just shown and also every open set from E Ã— E is in
Ïƒ (K). It follows Ïƒ (K) equals the Ïƒ algebra of product measurable sets, B (E)Ã—B (E)
and you can consider the product measure, ÂµÃ—Âµ. By Skorokhodâ€™s theorem, Theorem
36.27, there exists (X, Y ) a random variable with values in E Ã—E and a probability
space, (â„¦, F, P) such that L ((X, Y )) = Âµ Ã— Âµ. Then for A, B Borel sets in E
P (X âˆˆA, Y âˆˆB) = (Âµ Ã— Âµ) (A Ã— B) = Âµ (A) Âµ (B) .
Also, P (X âˆˆA) = P (X âˆˆA, Y âˆˆE) = Âµ (A) and similarly, P (Y âˆˆB) = Âµ (B)
showing L (X) = L (Y ) = Âµ and X, Y are independent.
Now here is an interesting theorem in [15].
Theorem 36.55 Suppose Î½ is a probability measure on the Borel sets of R and
suppose that Î¾ and Î¶ are independent random variables such that L (Î¾) = L (Î¶) = Î½
and whenever Î±2 + Î²2 = 1 it follows L (Î±Î¾ + Î²Î¶) = Î½. Then
L (Î¾) = N
Â¡
0, Ïƒ2Â¢
for some Ïƒ â‰¥0. Also if L (Î¾) = L (Î¶) = N
Â¡
0, Ïƒ2Â¢
where Î¾, Î¶ are independent, then
if Î±2 + Î²2 = 1, it follows L (Î±Î¾ + Î²Î¶) = N
Â¡
0, Ïƒ2Â¢
.
Proof: Let Î¾, Î¶ be independent random variables with L (Î¾) = L (Î¶) = Î½ and
whenever Î±2 + Î²2 = 1 it follows L (Î±Î¾ + Î²Î¶) = Î½.
By independence of Î¾ and Î¶,
Ï†Î½ (t)
â‰¡
Ï†Î±Î¾+Î±Î¶ (t)
=
E
Â³
eit(Î±Î¾+Î²Î¶)Â´
=
E
Â¡
eitÎ±Î¾Â¢
E
Â¡
eitÎ²Î¶Â¢
=
Ï†Î¾ (Î±t) Ï†Î¶ (Î²t)
â‰¡
Ï†Î½ (Î±t) Ï†Î½ (Î²t)
In simpler terms and suppressing the subscript,
Ï† (t) = Ï† (cos (Î¸) t) Ï† (sin (Î¸) t) .
(36.24)
Since Î½ is a probability measure, Ï† (0) = 1. Also, letting Î¸ = Ï€/4, this yields
Ï† (t) = Ï†
Ãƒâˆš
2
2 t
!2
(36.25)
and so if Ï† has real values, then Ï† (t) â‰¥0.

1028
PROBABILITY IN INFINITE DIMENSIONS
Next I will show Ï† is real. To do this, it follows from the deï¬nition of Ï†Î½,
Ï†Î½ (âˆ’t) â‰¡
Z
R
eâˆ’itxdÎ½ =
Z
R
eitxdÎ½ = Ï†Î½ (t).
Then letting Î¸ = Ï€,
Ï† (t) = Ï† (âˆ’t) Â· Ï† (0) = Ï† (âˆ’t) = Ï† (t)
showing Ï† has real values.
It is positive near 0 because Ï† (0) = 1 and Ï† is a
continuous function of t thanks to the dominated convergence theorem. However,
this and 36.25 implies it is positive everywhere. Here is why. If not, let tm be the
smallest positive value of t where Ï† (t) = 0. Then tm > 0 by continuity. Now from
36.25, an immediate contradiction results. Therefore, Ï† (t) > 0 for all t > 0. Similar
reasoning yields the same conclusion for t < 0.
Next note that Ï† (t) = Ï† (âˆ’t) also implies Ï† depends only on |t| because it takes
the same value for t as for âˆ’t. More simply, Ï† depends only on t2. Thus one can
deï¬ne a new function of the form Ï† (t) = f
Â¡
t2Â¢
and 36.24 implies the following for
Î± âˆˆ[0, 1] .
f
Â¡
t2Â¢
= f
Â¡
Î±2t2Â¢
f
Â¡Â¡
1 âˆ’Î±2Â¢
t2Â¢
.
Taking ln of both sides, one obtains the following for g
Â¡
t2Â¢
â‰¡ln f
Â¡
t2Â¢
.
ln f
Â¡
t2Â¢
= ln f
Â¡
Î±2t2Â¢
+ ln f
Â¡Â¡
1 âˆ’Î±2Â¢
t2Â¢
.
Now letting x = Î±2t2 and y =
Â¡
1 âˆ’Î±2Â¢
t2, it follows that for all x â‰¥0
ln f (x + y) = ln f (x) + ln f (y) .
Hence ln f (x) = kx and so ln f
Â¡
t2Â¢
= kt2 and so Ï† (t) = f
Â¡
t2Â¢
= ekt2for all t.
The constant, k must be nonpositive because Ï† (t) is bounded due to its deï¬nition.
Therefore, the characteristic function of Î½ is
Ï†Î½ (t) = eâˆ’1
2 t2Ïƒ2
for some Ïƒ â‰¥0. That is, Î½ is the law of a generalized normal random variable.
Note the other direction of the implication is obvious. If Î¾, Î¶ âˆ¼N (0, Ïƒ) and
they are independent, then if Î±2 + Î²2 = 1, it follows
Î±Î¾ + Î²Î¶ âˆ¼N
Â¡
0, Ïƒ2Â¢
because
E
Â³
eit(Î±Î¾+Î²Î¶)Â´
=
E
Â¡
eitÎ±Î¾Â¢
E
Â¡
eitÎ²Î¶Â¢
=
eâˆ’1
2 (Î±t)2Ïƒ2eâˆ’1
2 (Î²t)2Ïƒ2
=
eâˆ’1
2 t2Ïƒ2,
the characteristic function for a random variable which is N (0, Ïƒ). This proves the
theorem.
The next theorem is a useful gimick for showing certain random variables are
independent in the context of normal distributions.

36.8.
THE MULTIVARIATE NORMAL DISTRIBUTION
1029
Theorem 36.56 Let X and Y be random vectors having values in Rp and Rq
respectively. Suppose also that (X, Y) is multivariate normally distributed and
E
Â¡
(Xâˆ’E (X)) (Yâˆ’E (Y))âˆ—Â¢
= 0.
Then X and Y are independent random vectors.
Proof:
Let Z = (X, Y) , m = p + q. Then by hypothesis, the characteristic
function of Z is of the form
E
Â¡
eitÂ·ZÂ¢
= eitÂ·meâˆ’1
2 itâˆ—Î£t
where m = (mX, mY) = E (Z) = E (X, Y) and
Î£
=
Âµ E
Â¡
(Xâˆ’E (X)) (Xâˆ’E (X))âˆ—Â¢
0
0
E
Â¡
(Y âˆ’E (Y)) (Y âˆ’E (Y))âˆ—Â¢
Â¶
â‰¡
Âµ
Î£X
0
0
Î£Y
Â¶
.
Therefore, letting t = (u, v) where u âˆˆRp and v âˆˆRq
E
Â¡
eitÂ·ZÂ¢
=
E
Â³
ei(u,v)Â·(X,Y)Â´
= E
Â³
ei(uÂ·X+vÂ·Y)Â´
=
eiuÂ·mXeâˆ’1
2 uâˆ—Î£XueivÂ·mYeâˆ’1
2 vâˆ—Î£Yv
=
E
Â¡
eiuÂ·XÂ¢
E
Â¡
eivÂ·YÂ¢
.
(36.26)
Where the last equality needs to be justiï¬ed. When this is done it will follow from
Proposition 36.37 on Page 1017 which is proved on Page 996 that X and Y are
independent. Thus all that remains is to verify
E
Â¡
eiuÂ·XÂ¢
= eiuÂ·mXeâˆ’1
2 uâˆ—Î£Xu, E
Â¡
eivÂ·YÂ¢
= eivÂ·mYeâˆ’1
2 vâˆ—Î£Yv.
However, this follows from 36.26. To get the ï¬rst formula, let v = 0. To get the
second, let u = 0. This proves the Theorem.
Note that to verify the conclusion of this theorem, it suï¬ƒces to show
E (Xi âˆ’E (Xi) (Yj âˆ’E (Yj))) = 0.
Next are some technical lemmas. The ï¬rst is like an earlier result but will require
more work because it will not be assumed a certain function is bounded.
Lemma 36.57 Let (â„¦, F, P) be a probability space and let X : â„¦â†’E be a random
variable, where E is a real separable Banach space. Also let L (X) = Âµ, a probability
measure deï¬ned on B (E) , the Borel sets of E. Suppose h : E â†’R is continuous
and also suppose h â—¦X is in L1 (â„¦) . Then
Z
â„¦
(h â—¦X) dP =
Z
E
h (x) dÂµ.

1030
PROBABILITY IN INFINITE DIMENSIONS
Proof: Let {ai}âˆž
i=1 be a countable dense subset of R. Let Bn
i â‰¡B
Â¡
ai, 1
n
Â¢
âŠ†R
and deï¬ne Borel sets, An
i âŠ†E as follows:
An
1 = hâˆ’1 (Bn
1 ) , An
k+1 â‰¡hâˆ’1 Â¡
Bn
k+1
Â¢
\
Â¡
âˆªk
i=1An
i
Â¢
.
Thus {An
i }âˆž
i=1 are disjoint Borel sets, with h (An
i ) âŠ†Bn
i . Also let bn
i denote the
endpoint of B
Â¡
ai, 1
n
Â¢
which is closer to 0.
hn
i â‰¡
Â½ bn
i if hâˆ’1 (Bn
i ) Ì¸= âˆ…
0 if hâˆ’1 (Bn
i ) = âˆ…
Then deï¬ne
hn (x) â‰¡
âˆž
X
i=1
hn
i XAn
i (x)
Thus |hn (x)| â‰¤|h (x)| for all x âˆˆE and |hn (x) âˆ’h (x)| â‰¤1/n for all x âˆˆE. Then
hn â—¦X is in L1 (â„¦) and for all n,
|hn â—¦X (Ï‰)| â‰¤|h â—¦X (Ï‰)| .
Let
hn
k (x) â‰¡
k
X
i=1
hn
i XAn
i (x) .
Then from the construction in which the {An
i }âˆž
i=1 are disjoint,
|hn
k (X (Ï‰))| â‰¤|h (X (Ï‰))| , |hn
k (x)| â‰¤|h (x)|
and |hn
k (x)| is increasing in k.
Z
â„¦
|hn
k (X (Ï‰))| dP
=
Z
â„¦
k
X
i=1
|hn
i | XAn
i (X (Ï‰)) dP
=
Z
â„¦
k
X
i=1
|hn
i | XXâˆ’1(An
i ) (Ï‰) dP
=
k
X
i=1
|hn
i | P
Â¡
Xâˆ’1 (An
i )
Â¢
=
k
X
i=1
|hn
i | Âµ (An
i )
=
Z
E
|hn
k (x)| dÂµ.
By the monotone convergence theorem, and letting k â†’âˆž,
Z
â„¦
|hn (X (Ï‰))| dP =
Z
E
|hn (x)| dÂµ.

36.9.
GAUSSIAN MEASURES
1031
Now by the uniform convergence in the construction, you can let n â†’âˆžand obtain
Z
â„¦
|h (X (Ï‰))| dP =
Z
E
|h (x)| dÂµ.
Thus h âˆˆL1 (E, Âµ). It is obviously Borel measurable, being the limit of a sequence
of Borel measurable functions. Now similar reasoning to the above and using the
dominated convergence theorem when necessary yields
Z
â„¦
hn (X (Ï‰)) dP =
Z
E
hn (x) dÂµ
Now another application of the dominated convergence theorem yields
Z
â„¦
h (X (Ï‰)) dP =
Z
E
h (x) dÂµ.
This proves the lemma.
36.9
Gaussian Measures
36.9.1
Deï¬nitions And Basic Properties
First suppose X is a random vector having values in Rn and its distribution function
is N (m,Î£) where m is the mean and Î£ is the covariance. Then the characteristic
function of X or equivalently, the characteristic function of its distribution is
eitÂ·meâˆ’1
2 tâˆ—Î£t
What is the distribution of a Â· X where a âˆˆRn? In other words, if you take a
linear functional and do it to X to get a scalar valued random variable, what is the
distribution of this scalar valued random variable? Let Y = a Â· X. Then
E
Â¡
eitY Â¢
= E
Â¡
eitaÂ·XÂ¢
which from the above formula is
eiaÂ·mteâˆ’1
2 aâˆ—Î£at2
which is the characteristic function of a random variable whose distribution is
N (a Â· m, aâˆ—Î£a) . In other words, it is normally distributed having mean equal to
a Â· m and variance equal to aâˆ—Î£a. Obviously such a concept generalizes to a Banach
space in place of Rn and this motivates the following deï¬nition.
Deï¬nition 36.58 Let E be a real separable Banach space. A probability measure,
Âµ deï¬ned on B (E) is called a Gaussian measure if for every h âˆˆEâ€², the law of h
considered as a random variable deï¬ned on the probability space, (E, B (E) , Âµ) is
normal. That is, for A âŠ†R a Borel set,
Î»h (A) â‰¡Âµ
Â¡
hâˆ’1 (A)
Â¢

1032
PROBABILITY IN INFINITE DIMENSIONS
is given by
Z
A
1
âˆš
2Ï€Ïƒ eâˆ’
1
2Ïƒ2 (xâˆ’m)2dx
for some Ïƒ and m. A Gaussian measure is called symmetric if m is always equal
to 0.
Lemma 36.59 Let Âµ = L (X) where X is a random variable deï¬ned on a proba-
bility space, (â„¦, F, P) which has values in E, a Banach space. Suppose also that
for all Ï† âˆˆEâ€², Ï† â—¦X is normally distributed. Then Âµ is a Gaussian measure. Con-
versely, suppose Âµ is a Gaussian measure on B (E) and X is a random variable
having values in E such that L (X) = Âµ. Then for every h âˆˆEâ€², h â—¦X is normally
distributed.
Proof: First suppose Âµ is a Gaussian measure and X is a random variable such
that L (X) = Âµ. Then if F is a Borel set in R, and h âˆˆEâ€²
P
Â³
(h â—¦X)âˆ’1 (F)
Â´
=
P
Â¡
Xâˆ’1 Â¡
hâˆ’1 (F)
Â¢Â¢
=
Âµ
Â¡
hâˆ’1 (F)
Â¢
=
1
âˆš
2Ï€Ïƒ
Z
F
eâˆ’|xâˆ’m|2
2Ïƒ2
dx
for some m and Ïƒ2 showing that h â—¦X is normally distributed.
Next suppose h â—¦X is normally distributed whenever h âˆˆEâ€² and L (X) = Âµ.
Then letting F be a Borel set in R, I need to verify
Âµ
Â¡
hâˆ’1 (F)
Â¢
=
1
âˆš
2Ï€Ïƒ
Z
F
eâˆ’|xâˆ’m|2
2Ïƒ2
dx.
However, this is easy because
Âµ
Â¡
hâˆ’1 (F)
Â¢
=
P
Â¡
Xâˆ’1 Â¡
hâˆ’1 (F)
Â¢Â¢
=
P
Â³
(h â—¦X)âˆ’1 (F)
Â´
which is given to equal
1
âˆš
2Ï€Ïƒ
Z
F
eâˆ’|xâˆ’m|2
2Ïƒ2
dx
for some m and Ïƒ2. This proves the lemma.
Here is another important observation. Suppose X is as just described, a random
variable having values in E such that L (X) = Âµ and suppose h1, Â· Â· Â·, hn are each in
Eâ€². Then for scalars, t1, Â· Â· Â·, tn,
t1h1 â—¦X + Â· Â· Â· + tnhn â—¦X
=
(t1h1 + Â· Â· Â· + tnhn) â—¦X

36.10.
GAUSSIAN MEASURES FOR A SEPARABLE HILBERT SPACE
1033
and this last is assumed to be normally distributed because (t1h1 + Â· Â· Â· + tnhn) âˆˆ
Eâ€². Therefore, by Theorem 36.51
(h1 â—¦X, Â· Â· Â·, hn â—¦X)
is distributed as a multivariate normal.
Obviously there exist examples of Gaussian measures deï¬ned on E, a Banach
space. Here is why. Let Î¾ be a random variable deï¬ned on a probability space,
(â„¦, F, P) which is normally distributed with mean 0 and variance Ïƒ2. Then let
X (Ï‰) â‰¡Î¾ (Ï‰) e where e âˆˆE. Then let Âµ â‰¡L (X) . For A a Borel set of R and
h âˆˆEâ€²,
Âµ ([h (x) âˆˆA])
â‰¡
P ([X (Ï‰) âˆˆ[x : h (x) âˆˆA]])
=
P ([h â—¦X âˆˆA]) = P ([Î¾ (Ï‰) h (e) âˆˆA])
=
1
|h (e)| Ïƒ
âˆš
2Ï€
Z
A
e
âˆ’
1
2|h(e)|2Ïƒ2 x2
dx
because h (e) Î¾ is a random variable which has variance |h (e)|2 Ïƒ2 and mean 0. Thus
Âµ is indeed a Gaussian measure. Similarly, one can consider ï¬nite sums of the form
n
X
i=1
Î¾i (Ï‰) ei
where the Î¾i are independent normal random variables having mean 0 for conve-
nience. However, this is a rather trivial case. It is much more interesting to consider
the case of inï¬nite sums of random variables.
36.10
Gaussian Measures For A Separable Hilbert
Space
First recall the Kolmogorov extension theorem, Theorem 11.11 on Page 310 which
is stated here for convenience. In this theorem, I is an ordered index set, possibly
inï¬nite, even uncountable.
Theorem 36.60 (Kolmogorov extension theorem) For each ï¬nite set
J = (t1, Â· Â· Â·, tn) âŠ†I,
suppose there exists a Borel probability measure, Î½J = Î½t1Â·Â·Â·tn deï¬ned on the Borel
sets of Q
tâˆˆJ Mt where Mt is a locally compact metric space such that if
(t1, Â· Â· Â·, tn) âŠ†(s1, Â· Â· Â·, sp) ,
then
Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn) = Î½s1Â·Â·Â·sp
Â¡
Gs1 Ã— Â· Â· Â· Ã— Gsp
Â¢
(36.27)

1034
PROBABILITY IN INFINITE DIMENSIONS
where if si = tj, then Gsi = Ftj and if si is not equal to any of the indices, tk,
then Gsi = Msi. Then there exists a probability space, (â„¦, P, F) and measurable
functions, Xt : â„¦â†’Mt for each t âˆˆI such that for each (t1 Â· Â· Â· tn) âŠ†I,
Î½t1Â·Â·Â·tn (Ft1 Ã— Â· Â· Â· Ã— Ftn) = P ([Xt1 âˆˆFt1] âˆ©Â· Â· Â· âˆ©[Xtn âˆˆFtn]) .
(36.28)
Lemma 36.61 There exists a sequence, {Î¾k}âˆž
k=1 of random variables such that
L (Î¾k) = N (0, 1)
and {Î¾k}âˆž
k=1 is independent.
Proof: Let i1 < i2 Â· Â·Â· < in be positive integers and deï¬ne
Âµi1Â·Â·Â·in (F1 Ã— Â· Â· Â· Ã— Fn) â‰¡
1
Â¡âˆš
2Ï€
Â¢n
Z
F1Ã—Â·Â·Â·Ã—Fn
eâˆ’|x|2/2dx.
Then for the index set equal to N the measures satisfy the necessary consistency
condition for the Kolmogorov theorem above. Therefore, there exists a probability
space, (â„¦, P, F) and measurable functions, Î¾k : â„¦â†’R such that
P
Â¡Â£
Î¾i1 âˆˆFi1
Â¤
âˆ©
Â£
Î¾i2 âˆˆFi2
Â¤
Â· Â· Â· âˆ©
Â£
Î¾in âˆˆFin
Â¤Â¢
=
Âµi1Â·Â·Â·in (F1 Ã— Â· Â· Â· Ã— Fn)
=
P
Â¡Â£
Î¾i1 âˆˆFi1
Â¤Â¢
Â· Â· Â· P
Â¡Â£
Î¾in âˆˆFin
Â¤Â¢
which shows the random variables are independent as well as normal with mean 0
and variance 1. This proves the Lemma.
Now let H be a separable Hilbert space. Consider
âˆž
X
k=1
Î»kek âŠ—ek
where {ek} is a complete orthonormal set of vectors and
âˆž
X
k=1
Î»k < âˆž, Î»k â‰¥0.
Thus if A = Pâˆž
k=1 Î»kek âŠ—ek, it follows A is a nuclear operator and Aek = Î»kek.
Now deï¬ne for a âˆˆH,
X (Ï‰) â‰¡a +
âˆž
X
k=1
p
Î»kÎ¾k (Ï‰) ek
(36.29)
Claim: The series converges a.e. and in L2 (â„¦) .
Proof of claim: Let Xn (Ï‰) â‰¡a + Pn
k=1
âˆšÎ»kÎ¾k (Ï‰) ek. Then
Xn (Ï‰) = a +
n
X
k=1
p
Î»kÎ¾k (Ï‰) ek

36.10.
GAUSSIAN MEASURES FOR A SEPARABLE HILBERT SPACE
1035
â‰¡a + Yn (Ï‰) .
(36.30)
For n > m,
|Yn (Ï‰) âˆ’Ym (Ï‰)|2
H =
n
X
k=m
Î»kÎ¾k (Ï‰)2
(36.31)
and
Z
â„¦
âˆž
X
k=1
Î»kÎ¾k (Ï‰)2 dP =
âˆž
X
k=1
Î»k < âˆž
and so for a.e. Ï‰, 36.31 shows {Yn (Ï‰)} is a Cauchy sequence in H and therefore,
converges.
The series also converges in L2 (â„¦; H) because
Z
â„¦
ï£«
ï£­
n
X
k=m
p
Î»kÎ¾k (Ï‰) ek,
n
X
j=m
p
Î»jÎ¾j (Ï‰) ej
ï£¶
ï£¸dP
=
Z
â„¦
n
X
k=m
Î»k |Î¾k (Ï‰)|2 dP =
n
X
k=m
Î»k â‰¤
âˆž
X
k=m
Î»k
which by assumption converges to 0 as m â†’âˆž. Thus the partial sums form a
Cauchy sequence in L2 (â„¦; H) . This proves the claim.
Letting
(h, X (Ï‰))n â‰¡(h, a) +
n
X
k=1
p
Î»kÎ¾k (Ï‰) (h, ek)
it follows
(h, X (Ï‰))n â†’(h, X (Ï‰)) a.e.
and an application of the dominated convergence theorem, shows that since the Î¾k
are normal and independent, it follows from Theorem 36.50 and the description of
the characteristic function of a normally distributed random variable,
E
Â³
eit(h,X)Â´
=
lim
nâ†’âˆžE
Â³
eit(h,X)n
Â´
=
lim
nâ†’âˆžeit(h,a)eâˆ’t2 Pn
k=1 Î»k(h,ek)2
=
eit(h,a)eâˆ’t2 Pâˆž
k=1 Î»k(h,ek)2
and this is the characteristic function for a random variable with mean (h, a) and
variance Pâˆž
k=1 Î»k (h, ek)2 , this last series converging because
M
X
k=1
Î»k (h, ek)2 â‰¤C
âˆž
X
k=1
(h, ek)2 = C |h|2 .
Thus for every h âˆˆHâ€², h â—¦X is normally distributed. Therefore, Lemma 36.59
implies the following theorem.
Theorem 36.62 Let X (Ï‰) be given by 36.29 as described above.
Then letting
Âµ â‰¡L (X) , it follows Âµ is a Gaussian measure on the separable Hilbert space, H.

1036
PROBABILITY IN INFINITE DIMENSIONS
36.11
Abstract Wiener Spaces
This material follows [11], [30] and [25]. More can be found on this subject in these
references. Here H will be a separable Hilbert space.
Deï¬nition 36.63 Cylinder sets in H are of the form
{x âˆˆH : ((x, e1) , Â· Â· Â·, (x, en)) âˆˆF}
where F âˆˆB (Rn) , the Borel sets of Rn and {ek} are orthonormal. Denote this
collection of cylinder sets as C.
Lemma 36.64 Ïƒ (C) , the smallest Ïƒ algebra containing C, contains the Borel sets
of H, B (H).
Proof: It follows from the deï¬nition of these cylinder sets that if fi (x) â‰¡(x, ei) ,
so that fi âˆˆHâ€², then with respect to Ïƒ (C) , each fi is measurable. It follows that
every linear combination of the fi is also measurable with respect to Ïƒ (C). However,
this set of linear combinations is dense in Hâ€² and so the conclusion of the lemma
follows from Lemma 36.9 on Page 993. This proves the lemma.
Deï¬nition 36.65 Deï¬ne Î½ on the cylinder sets, C by the following rule. For {ek}
a complete orthonormal set in H,
Î½ ({x âˆˆH : ((x, e1) , Â· Â· Â·, (x, en)) âˆˆF})
â‰¡
1
(2Ï€)n/2
Z
F
eâˆ’|x|2/2dx.
Lemma 36.66 The above deï¬nition is well deï¬ned.
Proof: Let {fk} be another orthonormal set such that
{x âˆˆH : ((x, e1) , Â· Â· Â·, (x, en)) âˆˆF}
=
{x âˆˆH : ((x, f1) , Â· Â· Â·, (x, fn)) âˆˆG}
Then it needs to be the case that Î½ gives the same result for the two equal cylinder
sets. Let
L =
X
i
ei âŠ—fi.
Thus Lfi = ei and L maps H one to one and onto and preserves norms and
Lâˆ—=
X
i
fi âŠ—ei
and maps ei to fi and has the same properties of being one to one and onto H and
preserving norms.
Let
x âˆˆ{x âˆˆH : ((x, e1) , Â· Â· Â·, (x, en)) âˆˆF} â‰¡A.

36.11.
ABSTRACT WIENER SPACES
1037
Then by deï¬nition,
((x, e1) , Â· Â· Â·, (x, en)) âˆˆF
and so
((x, Lf1) , Â· Â· Â·, (x, Lfn)) âˆˆF
which implies
((Lâˆ—x, f1) , Â· Â· Â·, (Lâˆ—x, fn)) âˆˆF
Thus, since L, Lâˆ—are one to one and onto,
A
=
{x âˆˆH : ((x, e1) , Â· Â· Â·, (x, en)) âˆˆF}
=
{x âˆˆH : ((Lâˆ—x, f1) , Â· Â· Â·, (Lâˆ—x, fn)) âˆˆF}
=
{x âˆˆLH : ((Lâˆ—x, f1) , Â· Â· Â·, (Lâˆ—x, fn)) âˆˆF}
=
{Lâˆ—x âˆˆH : ((Lâˆ—x, f1) , Â· Â· Â·, (Lâˆ—x, fn)) âˆˆF}
=
{y âˆˆH : ((y, f1) , Â· Â· Â·, (y, fn)) âˆˆF}
=
{x âˆˆH : ((x, f1) , Â· Â· Â·, (x, fn)) âˆˆG}
If Î± âˆˆF, then there exists y âˆˆH such that
((y, f1) , Â· Â· Â·, (y, fn)) âˆˆF
and this y must be in the set,
{x âˆˆH : ((x, f1) , Â· Â· Â·, (x, fn)) âˆˆG}
which shows
((y, f1) , Â· Â· Â·, (y, fn)) âˆˆG.
Hence F âŠ†G. Similarly, G âŠ†F and Î½ is well deï¬ned. This proves the lemma.
It would be natural to try to extend Î½ to the Ïƒ algebra determined by C and
obtain a measure deï¬ned on this Ïƒ algebra. However, this is always impossible if
the Hilbert space, H is inï¬nite dimensional.
Proposition 36.67 Î½ cannot be extended to a measure deï¬ned on Ïƒ (C) whenever
H is inï¬nite dimensional.
Proof: Let {en} be a complete orthonormal set of vectors in H. Then ï¬rst note
that H is a cylinder set.
H = {x âˆˆH : (x, e1) âˆˆR}
and so
Î½ (H) =
1
âˆš
2Ï€
Z
R
eâˆ’x2/2dx = 1.
However, H is also equal to the countable union of the sets,
An â‰¡{x âˆˆH : ((x, e1)H , Â· Â· Â·, (x, ean)H) âˆˆB (0, n)}

1038
PROBABILITY IN INFINITE DIMENSIONS
where an â†’âˆž.
Î½ (An)
â‰¡
1
Â¡âˆš
2Ï€
Â¢an
Z
B(0,n)
eâˆ’|x|2/2dx
â‰¤
1
Â¡âˆš
2Ï€
Â¢an
Z n
âˆ’n
Â· Â· Â·
Z n
âˆ’n
eâˆ’|x|2/2dx1 Â· Â· Â· dxan
=
ÃƒR n
âˆ’n eâˆ’x2/2dx
âˆš
2Ï€
!an
Now pick an so large that the above is smaller than 1/2n+1. This can be done
because for no matter what choice of n,
R n
âˆ’n eâˆ’x2/2dx
âˆš
2Ï€
< 1.
Then
âˆž
X
n=1
Î½ (An) â‰¤
âˆž
X
n=1
1
2n+1 = 1
2.
This proves the proposition and shows something else must be done to get a measure
from Î½.
Deï¬nition 36.68 Let H be a separable Hilbert space and let ||Â·|| be a norm deï¬ned
on H which has the following property. Whenever {en} is an orthonormal sequence
of vectors in H and F ({en}) consists of the set of all orthogonal projections onto
the span of ï¬nitely many of the ek the following condition holds. For every Îµ > 0
there exists PÎµ âˆˆF ({en}) such that if P âˆˆF ({en}) and PPÎµ = 0, then
Î½ ({x âˆˆH : ||Px|| > Îµ}) < Îµ.
Then ||Â·|| is called Gross measurable.
The following lemma is a fundamental result about Gross measurable norms.
It is about the continuity of ||Â·|| . It is obvious that with respect to the topology
determined by ||Â·|| that x â†’||x|| is continuous. However, it would be interesting if
this were the case with respect to the topology determined by the norm on H, |Â·| .
This lemma shows this is the case and so the funny condition above implies x â†’||x||
is a continuous, hence Borel measurable function.
Lemma 36.69 Let ||Â·|| be Gross measurable. Then there exists c > 0 such that
||x|| â‰¤c |x|
for all x âˆˆH. Furthermore, the above deï¬nition is well deï¬ned.

36.11.
ABSTRACT WIENER SPACES
1039
Proof: First it is important to consider the question whether the above deï¬-
nition is well deï¬ned. To do this note that on PH, the two norms are equivalent
because PH is a ï¬nite dimensional space. Let G = {y âˆˆPH : ||y|| > Îµ} so G is an
open set in PH. Then
{x âˆˆH : ||Px|| > Îµ}
equals
{x âˆˆH : Px âˆˆG}
which equals a set of the form
{x âˆˆH : ((x, ei1)H , Â· Â· Â·, (x, eim)H) âˆˆGâ€²}
for Gâ€² an open set in Rm and so everything makes sense in the above deï¬nition.
Now it is necessary to verify ||Â·|| â‰¤c |Â·|. If it is not so, there exists e1 such that
||e1|| â‰¥1, |e1| = 1.
Suppose {ek}n
k=1 have been chosen such that each is a unit vector in H and ||ek|| â‰¥k.
Then considering span (e1, Â· Â· Â·, en)âŠ¥if for every x âˆˆspan (e1, Â· Â· Â·, en)âŠ¥, ||x|| â‰¤c |x| ,
then if z âˆˆH is arbitrary, z = x+y where y âˆˆspan (e1, Â· Â· Â·, en) and so since the two
norms are equivalent on a ï¬nite dimensional subspace, there exists câ€² corresponding
to span (e1, Â· Â· Â·, en) such that
||z||2
â‰¤
(||x|| + ||y||)2 â‰¤2 ||x||2 + 2 ||y||2
â‰¤
2c2 |x|2 + 2câ€² |y|2
â‰¤
Â¡
2c2 + 2câ€²2Â¢ Â³
|x|2 + |y|2Â´
=
Â¡
2c2 + 2câ€²2Â¢
|z|2
and the lemma is proved. Therefore it can be assumed, there exists
en+1 âˆˆspan (e1, Â· Â· Â·, en)âŠ¥
such that |en+1| = 1 and ||en+1|| â‰¥n + 1.
This constructs an orthonormal set of vectors, {ek} . Letting 0 < Îµ <
1
2, it
follows since ||Â·|| is measurable, there exists PÎµ âˆˆF ({en}) such that if PPÎµ = 0
where P âˆˆF ({en}) , then
Î½ ({x âˆˆH : ||Px|| > Îµ}) < Îµ.
Say PÎµ is the projection onto the span of ï¬nitely many of the ek, the last one being
eN. Then for n > N and Pn the projection onto en, it follows PÎµPn = 0 and from
the deï¬nition of Î½,
Îµ
>
Î½ ({x âˆˆH : ||Pnx|| > Îµ})
=
Î½ ({x âˆˆH : |(x, en)| ||en+1|| > Îµ})
=
Î½ ({x âˆˆH : |(x, en)| > Îµ/ ||en+1||})
â‰¥
Î½ ({x âˆˆH : |(x, en)| > Îµ/ (n + 1)})
>
1
âˆš
2Ï€
Z âˆž
Îµ/(n+1)
eâˆ’x2/2dx

1040
PROBABILITY IN INFINITE DIMENSIONS
which yields a contradiction for all n large enough. This proves the lemma.
What are examples of Gross measurable norms deï¬ned on a separable Hilbert
space, H? The following lemma gives an important example.
Lemma 36.70 Let H be a separable Hilbert space and let A âˆˆL2 (H, H) , a Hilbert
Schmidt operator. Thus A is a continuous linear operator with the property that for
any orthonormal set, {ek} ,
âˆž
X
k=1
|Aek|2 < âˆž.
Then deï¬ne ||Â·|| by
||x|| â‰¡|Ax|H .
Then if ||Â·|| is a norm, it is measurable1.
Proof: Let {ek} be an orthonormal sequence. Let Pn denote the orthogonal
projection onto span (e1, Â· Â· Â·, en) . Let Îµ > 0 be given. Since A is a Hilbert Schmidt
operator, there exists N such that
âˆž
X
k=N
|Aek|2 < Î±
where Î± is chosen very small. In fact, Î± is chosen such that Î± < Îµ2/r2 where r is
suï¬ƒciently large that
2
âˆš
2Ï€
Z âˆž
r
eâˆ’t2/2dt < Îµ.
(36.32)
Let P denote an orthogonal projection in F ({ek}) such that PPN = 0. Thus P is
the projection on to span (ei1, Â· Â· Â·, eim) where each ik > N. Then
Î½ ({x âˆˆH : ||Px|| > Îµ})
=
Î½ ({x âˆˆH : |APx| > Îµ})
Now Px = Pm
j=1
Â¡
x, eij
Â¢
eij and the above reduces to
Î½
ï£«
ï£­
ï£±
ï£²
ï£³x âˆˆH :
Â¯Â¯Â¯Â¯Â¯Â¯
m
X
j=1
Â¡
x, eij
Â¢
Aeij
Â¯Â¯Â¯Â¯Â¯Â¯
> Îµ
ï£¼
ï£½
ï£¾
ï£¶
ï£¸â‰¤
1If it is only a seminorm, it satisï¬es the same conditions.

36.11.
ABSTRACT WIENER SPACES
1041
Î½
ï£«
ï£¬
ï£­
ï£±
ï£´
ï£²
ï£´
ï£³
x âˆˆH :
ï£«
ï£­
m
X
j=1
Â¯Â¯Â¡
x, eij
Â¢Â¯Â¯2
ï£¶
ï£¸
1/2 ï£«
ï£­
m
X
j=1
Â¯Â¯Aeij
Â¯Â¯2
ï£¶
ï£¸
1/2
> Îµ
ï£¼
ï£´
ï£½
ï£´
ï£¾
ï£¶
ï£·
ï£¸
â‰¤
Î½
ï£«
ï£¬
ï£­
ï£±
ï£´
ï£²
ï£´
ï£³
x âˆˆH :
ï£«
ï£­
m
X
j=1
Â¯Â¯Â¡
x, eij
Â¢Â¯Â¯2
ï£¶
ï£¸
1/2
Î±1/2 > Îµ
ï£¼
ï£´
ï£½
ï£´
ï£¾
ï£¶
ï£·
ï£¸
=
Î½
ï£«
ï£¬
ï£­
ï£±
ï£´
ï£²
ï£´
ï£³
x âˆˆH :
ï£«
ï£­
m
X
j=1
Â¯Â¯Â¡
x, eij
Â¢Â¯Â¯2
ï£¶
ï£¸
1/2
>
Îµ
Î±1/2
ï£¼
ï£´
ï£½
ï£´
ï£¾
ï£¶
ï£·
ï£¸
=
Î½
ÂµÂ½
x âˆˆH : ((x, ei1) , Â· Â· Â·, (x, eim)) âˆˆB
Â³
0,
Îµ
Î±1/2
Â´CÂ¾Â¶
â‰¤
Î½
ÂµÂ½
x âˆˆH : max
Â©Â¯Â¯Â¡
x, eij
Â¢Â¯Â¯Âª
>
Îµ
âˆšmÎ±1/2
Â¾Â¶
This is no larger than
1
Â¡âˆš
2Ï€
Â¢m
Z
|t1|>
Îµ
âˆšmâˆšÎ±
Z
|t2|>
Îµ
âˆšmâˆšÎ±
Â· Â· Â·
Z
|tm|>
Îµ
âˆšmâˆšÎ±
eâˆ’|t|2/2dtm Â· Â· Â· dt1
=
ï£«
ï£­
2
R âˆž
Îµ/(
âˆšmÎ±1/2) eâˆ’t2/2dt
âˆš
2Ï€
ï£¶
ï£¸
m
which by Jensenâ€™s inequality is no larger than
2
R âˆž
Îµ/(
âˆšmÎ±1/2) eâˆ’mt2/2dt
âˆš
2Ï€
=
2
1
âˆšm
R âˆž
Îµ/(Î±1/2) eâˆ’t2/2dt
âˆš
2Ï€
â‰¤
2
R âˆž
Îµ/(Îµ/r) eâˆ’t2/2dt
âˆš
2Ï€
=
2
R âˆž
r
eâˆ’t2/2dt
âˆš
2Ï€
< Îµ
By 36.32. This proves the lemma.
Deï¬nition 36.71 A triple, (i, H, B) is called an abstract Wiener space if B is a
separable Banach space and H is a separable Hilbert space such that H is dense and
continuously embedded in B and the norm ||Â·|| on B is Gross measurable.
Next consider a weaker norm for H which comes from the inner product
(x, y)E â‰¡
âˆž
X
k=1
1
k2 (x, ek)H (y, ek)H .

1042
PROBABILITY IN INFINITE DIMENSIONS
Then let E be the completion of H with respect to this new norm. Thus {kek}
is a complete orthonormal basis for E. This follows from the density of H in E
along with the obvious observation that in the above inner product, {kek} is an
orthonormal set of vectors.
Lemma 36.72 There exists a countably additive Gaussian measure, Î» deï¬ned on
B (E). This measure is the law of the random variable,
X (Ï‰) â‰¡
âˆž
X
k=1
Î¾k (Ï‰) ek,
where {Î¾k} denotes a sequence of independent normally distributed random variables
having mean 0 and variance 1, the series converging pointwise a.e. in E. Also
k2 (X (Ï‰) , ek)E = Î¾k (Ï‰) a.e.
Proof: Observe that Pâˆž
k=1
1
k2 (kek)âŠ—(kek) is a nuclear operator on the Hilbert
space, E. Letting {Î¾k} be a sequence of independent random variables each normally
distributed with mean 0 and variance 1, it follows as in Theorem 36.62 that
X (Ï‰) â‰¡
âˆž
X
k=1
1
k Î¾k (Ï‰) kek =
âˆž
X
k=1
Î¾k (Ï‰) ek
(36.33)
is a random variable with values in E and L (X) is a Gaussian measure on B (E) ,
the series converging pointwise a.e.
in E.
Let Î» be the name of this Gaussian
measure and denote the probability space on which the Î¾k are deï¬ned as (â„¦, F, P).
Thus for F âˆˆB (E) ,
Î» (F) â‰¡P ({Ï‰ âˆˆâ„¦: X (Ï‰) âˆˆF})
Finally, denoting by XN, the partial sum,
XN (Ï‰) â‰¡
N
X
k=1
Î¾k (Ï‰) ek,
the deï¬nition of (Â·, Â·)E on H and a simple computation yields
Î¾k (Ï‰)
=
lim
Nâ†’âˆžk2 (XN (Ï‰) , ek)E
=
k2 (X (Ï‰) , ek)E .
(36.34)
One can pass to the limit because XN (Ï‰) converges to X (Ï‰) in E. This proves the
lemma.
Theorem 36.73 Let (i, H, B) be an abstract Wiener space. Then there exists a
Gaussian measure on the Borel sets of B.

36.11.
ABSTRACT WIENER SPACES
1043
Proof: Let E be deï¬ned above as the completion of H with respect to that
weaker norm. Then from Lemma 36.72 and X (Ï‰) given above in 36.33,
k2 (X (Ï‰) , ek)E = Î¾k (Ï‰) a.e. Ï‰.
Let {en} be a complete orthonormal set for H.
There exists an increasing
sequence of projections, {Qn} âŠ†F ({en}) such that Qnx â†’x in H for each x âˆˆ
H. Say Qn is the orthogonal projection onto span (e1, Â· Â· Â·, epn) . Then since ||Â·|| is
measurable, these can be chosen such that if Q is the orthogonal projection onto
span (e1, Â· Â· Â·, ek) for some k > pn then
Î½
Â¡Â©
x : ||Qx âˆ’Qnx|| > 2âˆ’nÂªÂ¢
< 2âˆ’n.
In particular,
Î½
Â¡Â©
x : ||Qnx âˆ’Qmx|| > 2âˆ’mÂªÂ¢
< 2âˆ’m
whenever n â‰¥m.
I would like to consider the inï¬nite series,
S (Ï‰) â‰¡
âˆž
X
k=1
k2 (X (Ï‰) , ek)E ek âˆˆB.
converging in B but of course this might make no sense because the series might
not converge. It was shown above that the series converges in E but it has not been
shown to converge in B.
Suppose the series did converge a.e. Then let f âˆˆBâ€² and consider the random
variable f â—¦S which maps â„¦to R. I would like to verify this is normally distributed.
First note that the following ï¬nite sum is weakly measurable and separably valued
so it is strongly measurable with values in B.
Spn (Ï‰) â‰¡
pn
X
k=1
k2 (X (Ï‰) , ek)E ek,
Since f âˆˆBâ€² which is a subset of Hâ€² due to the assumption that H is dense in B,
there exists a unique v âˆˆH such that f (x) = (x, v) for all x âˆˆH. Then from the
above sum,
f (Spn (Ï‰)) = (Spn (Ï‰) , v) =
pn
X
k=1
k2 (X (Ï‰) , ek)E (ek, v)
which by Lemma 36.72 equals
pn
X
k=1
(ek, v)H Î¾k (Ï‰)
a ï¬nite linear combination of the independent N (0, 1) random variables, Î¾k (Ï‰) .
Then it follows
Ï‰ â†’f (Spn (Ï‰))

1044
PROBABILITY IN INFINITE DIMENSIONS
is also normally distributed and has mean 0 and variance equal to
pn
X
k=1
(ek, v)2
H .
Then it seems reasonable to suppose
E
Â¡
eitfâ—¦SÂ¢
=
lim
nâ†’âˆžE
Â¡
eitfâ—¦SpnÂ¢
=
lim
nâ†’âˆžeâˆ’t2 Ppn
k=1(ek,v)2
H
=
eâˆ’t2 Pâˆž
k=1(ek,v)2
H
=
eâˆ’t2|v|2
H
(36.35)
the characteristic function of a random variable which is N
Â³
0, |v|2
H
Â´
. Thus at least
formally, this would imply for all f âˆˆBâ€², f â—¦S is normally distributed and so if
Âµ = L (S) , then by Lemma 36.59 it follows Âµ is a Gaussian measure.
What is missing to make the above a proof? First of all, there is the issue of the
sum. Next there is the problem of passing to the limit in the little argument above
in which the characteristic function is used.
First consider the the sum. Note that QnX (Ï‰) âˆˆH. Then for any n > pm,
P
Â¡Â©
Ï‰ âˆˆâ„¦: ||Sn (Ï‰) âˆ’Spm (Ï‰)|| > 2âˆ’mÂªÂ¢
=
P
ï£«
ï£­
ï£±
ï£²
ï£³Ï‰ âˆˆâ„¦:
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
n
X
k=pm+1
k2 (X (Ï‰) , ek)E ek
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
> 2âˆ’m
ï£¼
ï£½
ï£¾
ï£¶
ï£¸
=
P
ï£«
ï£­
ï£±
ï£²
ï£³Ï‰ âˆˆâ„¦:
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
n
X
k=pm+1
Î¾k (Ï‰) ek
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
> 2âˆ’m
ï£¼
ï£½
ï£¾
ï£¶
ï£¸
(36.36)
Let Q be the orthogonal projection onto span (e1, Â· Â· Â·, en) . Deï¬ne
F â‰¡
Â©
x âˆˆ(Q âˆ’Qm) H : ||x|| > 2âˆ’mÂª
Then continuing the chain of equalities ending with 36.36,
= P
ï£«
ï£­
ï£±
ï£²
ï£³Ï‰ âˆˆâ„¦:
n
X
k=pm+1
Î¾k (Ï‰) ek âˆˆF
ï£¼
ï£½
ï£¾
ï£¶
ï£¸
=
P
Â¡Â©
Ï‰ âˆˆâ„¦:
Â¡
Î¾n (Ï‰) , Â· Â· Â·, Î¾pm+1 (Ï‰)
Â¢
âˆˆF â€²ÂªÂ¢
=
Î½
Â¡Â©
x âˆˆH :
Â¡
(x, en)H , Â· Â· Â·, (x, epm+1)H
Â¢
âˆˆF â€²ÂªÂ¢
=
Î½ ({x âˆˆH : Q (x) âˆ’Qm (x) âˆˆF})
=
Î½
Â¡Â©
x âˆˆH : ||Q (x) âˆ’Qm (x)|| > 2âˆ’mÂªÂ¢
< 2âˆ’m.

36.11.
ABSTRACT WIENER SPACES
1045
This has shown that
P
Â¡Â©
Ï‰ âˆˆâ„¦: ||Sn (Ï‰) âˆ’Spm (Ï‰)|| > 2âˆ’mÂªÂ¢
< 2âˆ’m
(36.37)
for all n > pm. In particular, the above is true if n = pn for n > m.
If {Spn (Ï‰)} fails to converge, then Ï‰ must be contained in the set,
A â‰¡âˆ©âˆž
m=1 âˆªâˆž
n=m
Â©
Ï‰ âˆˆâ„¦: ||Spn (Ï‰) âˆ’Spm (Ï‰)|| > 2âˆ’mÂª
(36.38)
because if Ï‰ is in the complement of this set,
âˆªâˆž
m=1 âˆ©âˆž
n=m
Â©
Ï‰ âˆˆâ„¦: ||Spn (Ï‰) âˆ’Spm (Ï‰)|| â‰¤2âˆ’mÂª
,
it follows {Spn (Ï‰)}âˆž
n=1 is a Cauchy sequence and so it must converge. However, the
set in 36.38 is a set of measure 0 because of 36.37 and the observation that for all
m,
P (A)
â‰¤
âˆž
X
n=m
P
Â¡Â©
Ï‰ âˆˆâ„¦: ||Spn (Ï‰) âˆ’Spm (Ï‰)|| > 2âˆ’mÂªÂ¢
â‰¤
âˆž
X
n=m
1
2m
Thus the subsequence {Spn} of the sequence of partial sums of the above series
does converge pointwise in B and so the dominated convergence theorem also veriï¬es
that the computations involving the characteristic function in 36.35 are correct.
The random variable obtained as the limit of the partial sums, {Spn (Ï‰)} de-
scribed above is strongly measurable because each Spn (Ï‰) is strongly measurable
due to each of these being weakly measurable and separably valued.
Thus the
measure given as the law of S deï¬ned as
S (Ï‰) â‰¡lim
nâ†’âˆžSpn (Ï‰)
is deï¬ned on the Borel sets of B.This proves the theorem.
Also, there is an important observation from the proof which I will state as the
following corollary.
Corollary 36.74 Let (i, H, B) be an abstract Wiener space. Then there exists a
Gaussian measure on the Borel sets of B.
This Gaussian measure equals L (S)
where S (Ï‰) is the a.e. limit of a subsequence of the sequence of partial sums,
Spn (Ï‰) â‰¡
pn
X
k=1
Î¾k (Ï‰) ek
for {Î¾k} a sequence of independent random variables which are normal with mean
0 and variance 1 which are deï¬ned on a probability space, (â„¦, F, P). Furthermore,
for any k > pn,
P
Â¡Â©
Ï‰ âˆˆâ„¦: ||Sk (Ï‰) âˆ’Spn (Ï‰)|| > 2âˆ’nÂªÂ¢
< 2âˆ’n.

1046
PROBABILITY IN INFINITE DIMENSIONS
36.12
White Noise
In an abstract Wiener space as discussed above there is a Gaussian measure, Âµ
deï¬ned on the Borel sets of B. This measure is the law of a random variable having
values in B which is the limit of a subsequence of a sequence of partial sums. I will
show here that the sequence of partial sums also converges pointwise a.e.
First is a simple deï¬nition and lemma about random variables whose distribution
is symmetric.
Deï¬nition 36.75 Let X be a random variable deï¬ned on a probability space, (â„¦, F, P)
having values in a Banach space, E. Then it has a symmetric distribution if when-
ever A is a Borel set,
P ([X âˆˆA]) = P ([X âˆˆâˆ’A])
In terms of the distribution,
Î»X = Î»âˆ’X.
It is good to observe that if X, Y are independent random variables deï¬ned on a
probability space, (â„¦, F, P) such that each has symmetric distribution, then X +Y
also has symmetric distribution. Here is why. Let A be a Borel set in E. Then by
Theorem 36.47 on Page 1023,
Î»X+Y (A)
=
Z
E
Î»X (A âˆ’z) dÎ»Y (z)
=
Z
E
Î»âˆ’X (A âˆ’z) dÎ»âˆ’Y (z)
=
Î»âˆ’(X+Y ) (A)
By induction, it follows that if you have n independent random variables each having
symmetric distribution, then their sum has symmetric distribution.
Here is a simple lemma about random variables having symmetric distributions.
It will depend on Lemma 36.57 on Page 1029.
Lemma 36.76 Let X â‰¡(X1, Â· Â· Â·, Xn) and Y be random variables deï¬ned on a
probability space, (â„¦, F, P) such that Xi, i = 1, 2, Â·Â·Â·, n and Y have values in E a sep-
arable Banach space. Thus X has values in En. Suppose also that {X1, Â· Â· Â·, Xn, Y }
are independent and that Y has symmetric distribution.
Then if A âˆˆB (En) , it
follows
P
Ãƒ
[X âˆˆA] âˆ©
"Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
Xi + Y
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < r
#!
=
P
Ãƒ
[X âˆˆA] âˆ©
"Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
Xi âˆ’Y
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < r
#!
You can also change the inequalities in the obvious way, < to â‰¤, > to â‰¥.

36.12.
WHITE NOISE
1047
Proof: Denote by Î»X and Î»Y the distribution measures for X and Y respec-
tively. Since the random variables are independent, the distribution for the random
variable, (X, Y ) mapping into En+1 is Î»XÃ—Î»Y where this denotes product measure.
Since the Banach space is separable, the Borel sets are contained in the product
measurable sets. Then by symmetry of the distribution of Y
P
Ãƒ
[X âˆˆA] âˆ©
"Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
Xi + Y
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < r
#!
=
Z
EnÃ—E
XA (x) XB(0,r)
Ãƒ n
X
i=1
xi + y
!
d (Î»X Ã— Î»Y ) (x,y)
=
Z
E
Z
En XA (x) XB(0,r)
Ãƒ n
X
i=1
xi + y
!
dÎ»XdÎ»Y
=
Z
E
Z
En XA (x) XB(0,r)
Ãƒ n
X
i=1
xi + y
!
dÎ»XdÎ»âˆ’Y
=
Z
EnÃ—E
XA (x) XB(0,r)
Ãƒ n
X
i=1
xi + y
!
d (Î»X Ã— Î»âˆ’Y ) (x,y)
=
P
Ãƒ
[X âˆˆA] âˆ©
"Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
i=1
Xi + (âˆ’Y )
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < r
#!
This proves the lemma. Other cases are similar.
Now here is a really interesting lemma.
Lemma 36.77 Let E be a real separable Banach space. Assume Î¾1, Â· Â· Â·, Î¾N are
independent random variables having values in E, a separable Banach space which
have symmetric distributions. Also let Sk = Pk
i=1 Î¾i. Then for any r > 0,
P
ÂµÂ·
sup
kâ‰¤N
||Sk|| > r
Â¸Â¶
â‰¤2P ([||SN|| > r]) .
Proof: First of all,
P
ÂµÂ·
sup
kâ‰¤N
||Sk|| > r
Â¸Â¶
=
P
ÂµÂ·
sup
kâ‰¤N
||Sk|| > r and ||SN|| > r
Â¸Â¶
+P
ÂµÂ·
sup
kâ‰¤Nâˆ’1
||Sk|| > r and ||SN|| â‰¤r
Â¸Â¶
â‰¤
P ([||SN|| > r]) + P
ÂµÂ·
sup
kâ‰¤Nâˆ’1
||Sk|| > r and ||SN|| â‰¤r
Â¸Â¶
.
(36.39)
I need to estimate the second of these terms. Let
A1 â‰¡[||S1|| > r] , Â· Â· Â·, Ak â‰¡[||Sk|| > r, ||Sj|| â‰¤r for j < k] .

1048
PROBABILITY IN INFINITE DIMENSIONS
Thus Ak consists of those Ï‰ where ||Sk (Ï‰)|| > r for the ï¬rst time at k. Thus
Â·
sup
kâ‰¤Nâˆ’1
||Sk|| > r and ||SN|| â‰¤r
Â¸
= âˆªNâˆ’1
j=1 Aj âˆ©[||SN|| â‰¤r]
and the sets in the above union are disjoint. Consider Aj âˆ©[||SN|| â‰¤r] . For Ï‰ in
this set,
||Sj (Ï‰)|| > r, ||Si (Ï‰)|| â‰¤r if i < j.
Since ||SN (Ï‰)|| â‰¤r in this set, it follows
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
Sj (Ï‰) +
N
X
i=j+1
Î¾i (Ï‰)
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤r
and so from the symmetry of the distributions and Lemma 36.76 the following
computation is valid.
P (Aj âˆ©[||SN|| â‰¤r])
(36.40)
= P
ï£«
ï£­âˆ©jâˆ’1
i=1 [||Si|| â‰¤r] âˆ©[||Sj|| > r] âˆ©
ï£®
ï£°
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
Sj +
N
X
i=j+1
Î¾i
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤r
ï£¹
ï£»
ï£¶
ï£¸
(36.41)
Now âˆ©jâˆ’1
i=1 [||Si|| â‰¤r] âˆ©[||Sj|| > r] is of the form
Â£Â¡
Î¾1, Â· Â· Â·, Î¾j
Â¢
âˆˆA
Â¤
for some Borel set, A. Then letting Y = PN
i=j+1 Î¾i in Lemma 36.76 and Xi = Î¾i,
36.41 equals
P
ï£«
ï£­âˆ©jâˆ’1
i=1 [||Si|| â‰¤r] âˆ©[||Sj|| > r] âˆ©
ï£®
ï£°
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
Sj âˆ’
N
X
i=j+1
Î¾i
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
â‰¤r
ï£¹
ï£»
ï£¶
ï£¸
=
P
Â³
âˆ©jâˆ’1
i=1 [||Si|| â‰¤r] âˆ©[||Sj|| > r] âˆ©[||Sj âˆ’(SN âˆ’Sj)|| â‰¤r]
Â´
=
P
Â³
âˆ©jâˆ’1
i=1 [||Si|| â‰¤r] âˆ©[||Sj|| > r] âˆ©[||2Sj âˆ’SN|| â‰¤r]
Â´
Now since ||Sj (Ï‰)|| > r,
[||2Sj âˆ’SN|| â‰¤r]
âŠ†
[2 ||Sj|| âˆ’||SN|| â‰¤r]
âŠ†
[2r âˆ’||SN|| < r]
=
[||SN|| > r]
and so, referring to 36.40, this has shown
P (Aj âˆ©[||SN|| â‰¤r])

36.12.
WHITE NOISE
1049
=
P
Â³
âˆ©jâˆ’1
i=1 [||Si|| â‰¤r] âˆ©[||Sj|| > r] âˆ©[||2Sj (Ï‰) âˆ’SN (Ï‰)|| â‰¤r]
Â´
â‰¤
P
Â³
âˆ©jâˆ’1
i=1 [||Si|| â‰¤r] âˆ©[||Sj|| > r] âˆ©[||SN (Ï‰)|| > r]
Â´
=
P (Aj âˆ©[||SN (Ï‰)|| > r]) .
It follows that
P
ÂµÂ·
sup
kâ‰¤Nâˆ’1
||Sk|| > r and ||SN|| â‰¤r
Â¸Â¶
=
Nâˆ’1
X
i=1
P (Aj âˆ©[||SN|| â‰¤r])
â‰¤
Nâˆ’1
X
i=1
P (Aj âˆ©[||SN|| > r])
â‰¤
P ([||SN|| > r])
and using 36.39, this proves the lemma.
This interesting lemma will now be used to prove the following which concludes
a sequence of partial sums converges given a subsequence of the sequence of partial
sums converges.
Lemma 36.78 Let {Î¶k} be a sequence of random variables having values in a
separable real Banach space, E whose distributions are symmetric. Letting Sk â‰¡
Pk
i=1 Î¶i, suppose {Snk} converges a.e. Also suppose that for every m > nk,
P
Â¡Â£
||Sm âˆ’Snk||E > 2âˆ’kÂ¤Â¢
< 2âˆ’k.
(36.42)
Then in fact,
Sk (Ï‰) â†’S (Ï‰) a.e.Ï‰
(36.43)
Proof: Let nk â‰¤l â‰¤m. Then by Lemma 36.77
P
ÂµÂ·
sup
nk<lâ‰¤m
||Sl âˆ’Snk|| > 2âˆ’k
Â¸Â¶
â‰¤2P
Â¡Â£
||Sm âˆ’Snk|| > 2âˆ’kÂ¤Â¢
In using this lemma, you could renumber the Î¶i so that the sum
l
X
j=nk+1
Î¶j
corresponds to
lâˆ’nk
X
j=1
Î¾j
where Î¾j = Î¶j+nk. Then using 36.42,
P
ÂµÂ·
sup
nk<lâ‰¤m
||Sl âˆ’Snk|| > 2âˆ’k
Â¸Â¶
â‰¤2P
Â¡Â£
||Sm âˆ’Snk|| > 2âˆ’kÂ¤Â¢
< 2âˆ’(kâˆ’1)

1050
PROBABILITY IN INFINITE DIMENSIONS
If Sl (Ï‰) fails to converge then Ï‰ must be in inï¬nitely many of the sets,
Â·
sup
nk<l
||Sl âˆ’Snk|| > 2âˆ’k
Â¸
each of which has measure no more than 2âˆ’(kâˆ’1).
Thus Ï‰ must be in a set of
measure zero. This proves the lemma.
Now with this preparation, here is the theorem about white noise.
Theorem 36.79 Let (i, H, B) be an abstract Wiener space. Then there exists a
Gaussian measure on the Borel sets of B.
This Gaussian measure equals L (S)
where S (Ï‰) is the a.e. limit of the sequence of partial sums,
Sn (Ï‰) â‰¡
n
X
k=1
Î¾k (Ï‰) ek
for {Î¾k} a sequence of independent random variables which are normal with mean
0 and variance 1 which are deï¬ned on a probability space, (â„¦, F, P) and {ek} is a
complete orthonormal sequence in H.
Proof: By Corollary 36.74 there is a subsequence, {Spn} of these partial sums
which converge pointwise a.e. to S (Ï‰). However, this corollary also states that
P
Â¡Â©
Ï‰ âˆˆâ„¦: ||Sk (Ï‰) âˆ’Spn (Ï‰)|| > 2âˆ’nÂªÂ¢
< 2âˆ’n
whenever k > pn and so by Lemma 36.78 the original sequence of partial sums
also converges a.e. The reason this lemma applies is that Î¾k (Ï‰) ek has symmetric
distribution. This proves the corollary.
36.13
Existence Of Abstract Wiener Spaces
It turns out that if E is a separable Banach space, then it is the top third of an
abstract Wiener space. This is what will be shown in this section. Therefore, it
follows from the above that there exists a Gaussian measure on E which is the law
of an a.e. convergent series as discussed above. First here is a little lemma which
is interesting for its own sake.
Lemma 36.80 Let E be a separable Banach space. Then there exists an increasing
sequence of subspaces, {Fn} such that dim (Fn+1) âˆ’dim (Fn) â‰¤1 and equals 1 for
all n if the dimension of E is inï¬nite. Also âˆªâˆž
n=1Fn is dense in E.
Proof: Since E is separable, so is âˆ‚B (0, 1) , the boundary of the unit ball. Let
{wk}âˆž
k=1 be a countable dense subset of âˆ‚B (0, 1).
Let z1 = w1. Let F1 = Fz1. Suppose Fn has been obtained and equals span (z1, Â· Â· Â·, zn)
where {z1, Â· Â· Â·, zn} is independent, ||zk|| = 1, and if n Ì¸= m,
||zm âˆ’zn|| â‰¥1
2.

36.13.
EXISTENCE OF ABSTRACT WIENER SPACES
1051
Claim:
Fn is closed. Let
yk â‰¡
n
X
j=1
ck
j zj
(36.44)
be such that yk â†’y. I need to verify y âˆˆFn. Let ck =
Â¡
ck
1, Â· Â· Â·, ck
n
Â¢
. Suppose ï¬rst
{ck} is unbounded in Fn. Then taking a subsequence, still denoted by ck, it can be
assumed |ck| â†’âˆž. Therefore,
0 = lim
kâ†’âˆž
yk
|ck| = lim
kâ†’âˆž
n
X
j=1
ck
j
|ck|zj.
(36.45)
Then taking another subsequence it can also be assumed that
ck
|ck| â†’c, |c| = 1.
but then 36.45 implies
0 =
n
X
j=1
cjzj
and this is a contradiction since the zj are independent.
Thus it must be the case that {ck} is bounded in Fn. But now, taking a suitable
subsequence such that ck â†’c, it follows from 36.44 that
y â‰¡
n
X
j=1
cjzj
so y âˆˆFn. This shows Fn is closed and this proves the claim.
If Fn contains {wk} , let Fm = Fn for all m > n. Otherwise, pick w âˆˆ{wk} to
be the point of {wk} having the smallest subscript which is not contained in Fn.
Then w is at a positive distance, Î» from Fn because Fn is closed. Therefore, there
exists y âˆˆFn such that Î» â‰¤||y âˆ’w|| â‰¤2Î». Let zn+1 =
wâˆ’y
||wâˆ’y||. It follows
w = ||w âˆ’y|| zn+1 + y âˆˆspan (z1, Â· Â· Â·, zn+1) â‰¡Fn+1
Then if m < n + 1,
||zn+1 âˆ’zm||
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
w âˆ’y
||w âˆ’y|| âˆ’zm
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
w âˆ’y
||w âˆ’y|| âˆ’||w âˆ’y|| zm
||w âˆ’y||
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¥
1
2Î» ||w âˆ’y âˆ’||w âˆ’y|| zm||
â‰¥
Î»
2Î» = 1
2.

1052
PROBABILITY IN INFINITE DIMENSIONS
This has shown the existence of an increasing sequence of subspaces, {Fn} as de-
scribed above. It remains to show the union of these subspaces is dense. First note
that the union of these subspaces must contain the {wk} because if wm is miss-
ing, then it would contradict the construction at the mth step. That one should
have been chosen. However, {wk} is dense in âˆ‚B (0, 1). If x âˆˆE and x Ì¸= 0, then
x
||x|| âˆˆâˆ‚B (0, 1) then there exists
wm âˆˆ{wk} âŠ†âˆªâˆž
n=1Fn
such that
Â¯Â¯Â¯
Â¯Â¯Â¯wm âˆ’
x
||x||
Â¯Â¯Â¯
Â¯Â¯Â¯ <
Îµ
||x||. But then
||||x|| wm âˆ’x|| < Îµ
and so ||x|| wm is a point of âˆªâˆž
n=1Fn which is within Îµ of x. This proves âˆªâˆž
n=1Fn is
dense as desired. This proves the lemma.
Lemma 36.81 Let E be a separable Banach space. Then there exists a sequence
{en} of points of E such that whenever |Î²| â‰¤1 for Î² âˆˆFn,
n
X
k=1
Î²kek âˆˆB (0, 1)
the unit ball in E.
Proof: By Lemma 36.80, let {z1, Â· Â· Â·, zn} be a basis for Fn where âˆªâˆž
n=1Fn is
dense in E. Then let Î±1 be such that e1 â‰¡Î±1z1 âˆˆB (0, 1) . Thus |Î²1e1| âˆˆB (0, 1)
whenever |Î²1| â‰¤1. Suppose Î±i has been chosen for i = 1, 2, Â· Â· Â·, n such that for all
Î² âˆˆDn â‰¡{Î± âˆˆFn : |Î±| â‰¤1} , it follows
n
X
k=1
Î²kÎ±kzk âˆˆB (0, 1) .
Then
Cn â‰¡
( n
X
k=1
Î²kÎ±kzk : Î² âˆˆDn
)
is a compact subset of B (0, 1) and so it is at a positive distance from the complement
of B (0, 1) , Î´. Now let 0 < Î±n+1 < Î´/ ||zn+1|| . Then for Î² âˆˆDn+1,
n
X
k=1
Î²kÎ±kzk âˆˆCn
and so
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n+1
X
k=1
Î²kÎ±kzk âˆ’
n
X
k=1
Î²kÎ±kzk
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Î²n+1Î±n+1zn+1
Â¯Â¯Â¯Â¯
<
||Î±n+1zn+1|| < Î´

36.13.
EXISTENCE OF ABSTRACT WIENER SPACES
1053
which shows
n+1
X
k=1
Î²kÎ±kzk âˆˆB (0, 1) .
This proves the lemma. Let ek â‰¡Î±kzk.
Now the main result is the following. It says that any separable Banach space
is the upper third of some abstract Wiener space.
Theorem 36.82 Let E be a real separable Banach space with norm ||Â·||. Then there
exists a separable Hilbert space, H such that H is dense in E and the inclusion map
is continuous. Furthermore, if Î½ is the Gaussian measure deï¬ned earlier on the
cylinder sets of H, ||Â·|| is Gross measurable.
Proof: Let {ek} be the points of E described in Lemma 36.81. Then let H0
denote the subspace of all ï¬nite linear combinations of the {ek}. It follows H0 is
dense in E. Next decree that {ek} is an orthonormal basis for H0. Thus for
n
X
k=1
ckek,
n
X
j=1
djek âˆˆH0,
ï£«
ï£­
n
X
k=1
ckek,
n
X
j=1
djej
ï£¶
ï£¸
H0
â‰¡
n
X
k=1
ckdk
this being well deï¬ned because the {ek} are linearly independent. Let the norm on
H0 be denoted by |Â·|H0. Let H1 be the completion of H0 with respect to this norm.
I want to show that |Â·|H0 is stronger than ||Â·||. Suppose then that
Â¯Â¯Â¯Â¯Â¯
n
X
k=1
Î²kek
Â¯Â¯Â¯Â¯Â¯
H0
â‰¤1.
It follows then from the deï¬nition of |Â·|H0 that
Â¯Â¯Â¯Â¯Â¯
n
X
k=1
Î²kek
Â¯Â¯Â¯Â¯Â¯
2
H0
=
n
X
k=1
Î²2
k â‰¤1
and so from the construction of the ek, it follows that
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
n
X
k=1
Î²kek
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯ < 1
Stated more simply, this has just shown that if h âˆˆH0 then since
Â¯Â¯h/ |h|H0
Â¯Â¯
H0 â‰¤1,
it follows that
||h|| / |h|H0 < 1

1054
PROBABILITY IN INFINITE DIMENSIONS
and so
||h|| < |h|H0 .
It follows that the completion of H0 must lie in E because this shows that every
Cauchy sequence in H0 is a Cauchy sequence in E. Thus H1 embedds continuously
into E and is dense in E. Denote its norm by |Â·|H1.
Now consider the Hilbert Schmidt operator,
A =
âˆž
X
k=1
Î»kek âŠ—ek
where each Î»k > 0 and P
k Î»2
k < âˆž. This operator is clearly one to one. Let
H â‰¡AH1.
and for x âˆˆH, deï¬ne
|x|H â‰¡
Â¯Â¯Aâˆ’1x
Â¯Â¯
H1 .
Since each ek is in H it follows that H is dense in E. Note also that H âŠ†H1 because
A maps H1 to H1.
Ax â‰¡
âˆž
X
k=1
Î»k (x, ek) ek
and the series converges in H1 because
âˆž
X
k=1
Î»k |(x, ek)| â‰¤
Ãƒ âˆž
X
k=1
Î»2
k
!1/2 Ãƒ âˆž
X
k=1
|(x, ek)|2
!1/2
< âˆž.
Also H is a Hilbert space with inner product given by
(x, y)H â‰¡
Â¡
Aâˆ’1x, Aâˆ’1y
Â¢
H1 .
H is complete because if {xn} is a Cauchy sequence in H, this is the same as
Â©
Aâˆ’1xn
Âª
being a Cauchy sequence in H1 which implies Aâˆ’1xn â†’y for some
y âˆˆH1. Then it follows xn = A
Â¡
Aâˆ’1xn
Â¢
â†’Ay in H.
For x âˆˆH âŠ†H1,
||x|| â‰¤|x|H1 =
Â¯Â¯AAâˆ’1x
Â¯Â¯
H1 â‰¤||A||
Â¯Â¯Aâˆ’1x
Â¯Â¯
H1 â‰¡||A|| |x|H
and so the embedding of H into E is continuous. Why is ||Â·|| a measurable norm
on H? Note ï¬rst that for x âˆˆH âŠ†H1,
|Ax|H â‰¡
Â¯Â¯Aâˆ’1Ax
Â¯Â¯
H1 = |x|H1 â‰¥||x||E .
(36.46)
Therefore, if it can be shown A is a Hilbert Schmidt operator on H, the desired
measurability will follow from Lemma 36.70 on Page 1040.
Claim:
A is a Hilbert Schmidt operator on H.

36.14.
FERNIQUEâ€™S THEOREM
1055
Proof of the claim: From the deï¬nition of the inner product in H, it follows
an orthonormal basis for H is {Î»kek} . This is because
(Î»kek, Î»jej)H â‰¡
Â¡
Î»kAâˆ’1ek, Î»jAâˆ’1ej
Â¢
H1 = (ek, ej)H1 = Î´jk.
To show that A is Hilbert Schmidt, it suï¬ƒces to show that
X
k
|A (Î»kek)|2
H < âˆž
because this is the deï¬nition of an operator being Hilbert Schmidt. However, the
above equals
X
k
Â¯Â¯Aâˆ’1A (Î»kek)
Â¯Â¯2
H1 =
X
k
Î»2
k < âˆž.
This proves the claim.
Now consider 36.46. By Lemma 36.70, it follows the norm ||x||â€² â‰¡|Ax|H is Gross
measurable on H. Therefore, ||Â·||E is also Gross measurable because it is smaller.
This proves the theorem.
Using Theorem 36.73 and Theorem 36.82 this proves the following important
corollary.
Corollary 36.83 Let E be any real separable Banach space and let {Î¾k} be any
sequence of independent random variables such that L (Î¾k) = N (0, 1). Then there
exists a sequence, {ek} âŠ†E such that
X (Ï‰) â‰¡
âˆž
X
k=1
Î¾k (Ï‰) ek
converges a.e. and its law is a Gaussian measure deï¬ned on B (E).
36.14
Ferniqueâ€™s Theorem
The following is an interesting lemma.
Lemma 36.84 Suppose Âµ is a symmetric Gaussian measure on the real separable
Banach space, E. Then there exists a probability space, (â„¦, F, P) and independent
random variables, X and Y mapping â„¦to E such that L (X) = L (Y ) = Âµ. Also,
the two random variables,
1
âˆš
2 (X âˆ’Y ) ,
1
âˆš
2 (X + Y )
are independent and
L
Âµ 1
âˆš
2 (X âˆ’Y )
Â¶
= L
Âµ 1
âˆš
2 (X + Y )
Â¶
= Âµ.

1056
PROBABILITY IN INFINITE DIMENSIONS
Proof: Letting Xâ€² â‰¡
1
âˆš
2 (X + Y ) and Y â€² â‰¡
1
âˆš
2 (X âˆ’Y ) , it follows from Theo-
rem 36.38 on Page 1017, that Xâ€² and Y â€² are independent if whenever h1, Â·Â·Â·, hm âˆˆEâ€²
and g1, Â· Â· Â·, gk âˆˆEâ€², the two random vectors,
(h1 â—¦Xâ€², Â· Â· Â·, hm â—¦Xâ€²) and (g1 â—¦Y â€², Â· Â· Â·, gk â—¦Y â€²)
are linearly independent. Now consider linear combinations
m
X
j=1
tjhj â—¦Xâ€² +
k
X
i=1
sigi â—¦Y â€².
This equals
1
âˆš
2
m
X
j=1
tjhj (X) + 1
âˆš
2
m
X
j=1
tjhj (Y )
+ 1
âˆš
2
k
X
i=1
sigi (X) âˆ’1
âˆš
2
k
X
i=1
sigi (Y )
=
1
âˆš
2
ï£«
ï£­
m
X
j=1
tjhj +
k
X
i=1
sigi
ï£¶
ï£¸(X)
+ 1
âˆš
2
ï£«
ï£­
m
X
j=1
tjhj âˆ’
k
X
i=1
sigi
ï£¶
ï£¸(Y )
and this is the sum of two independent normally distributed random variables so it
is also normally distributed. Therefore, by Theorem 36.51
(h1 â—¦Xâ€², Â· Â· Â·, hm â—¦Xâ€², g1 â—¦Y â€², Â· Â· Â·, gk â—¦Y â€²)
is a random variable with multivariate normal distribution and by Theorem 36.56
the two random vectors
(h1 â—¦Xâ€², Â· Â· Â·, hm â—¦Xâ€²) and (g1 â—¦Y â€², Â· Â· Â·, gk â—¦Y â€²)
are linearly independent if
E ((hi â—¦Xâ€²) (gj â—¦Y â€²)) = 0
for all i, j. This is what I will show next.
E ((hi â—¦Xâ€²) (gj â—¦Y â€²))
=
1
4E ((hi (X) + hi (Y )) (gj (X) âˆ’gj (Y )))
=
1
4E (hi (X) gj (X)) âˆ’1
4E (hi (X) gj (Y ))
+1
4E (hi (Y ) gj (X)) âˆ’1
4E (hi (Y ) gj (Y ))
(36.47)

36.14.
FERNIQUEâ€™S THEOREM
1057
Now from the above observation after the deï¬nition of Gaussian measure hi (X) gj (X)
and hi (Y ) gj (Y ) are both in L1 because each term in each product is normally dis-
tributed. Therefore, by Lemma 36.57,
E (hi (X) gj (X))
=
Z
â„¦
hi (Y ) gj (Y ) dP
=
Z
E
hi (y) gj (y) dÂµ
=
Z
â„¦
hi (X) gj (X) dP
=
E (hi (Y ) gj (Y ))
and so 36.47 reduces to
1
4 (E (hi (Y ) gj (X) âˆ’hi (X) gj (Y ))) = 0
because hi (X) and gj (Y ) are independent due to the assumption that X and Y
are independent. Thus
E (hi (X) gj (Y )) = E (hi (X)) E (gj (Y )) = 0
due to the assumption that Âµ is symmetric which implies the mean of these ran-
dom variables equals 0. The other term works out similarly. This has proved the
independence of the random variables, Xâ€² and Y â€².
Next consider the claim they have the same law and it equals Âµ. To do this, I
will use Theorem 36.36 on Page 1016. Thus I need to show
E
Â³
eih(Xâ€²)Â´
= E
Â³
eih(Y â€²)Â´
= E
Â³
eih(X)Â´
(36.48)
for all h âˆˆEâ€². Pick such an h. Then h â—¦X is normally distributed and has mean 0.
Therefore, for some Ïƒ,
E
Â¡
eithâ—¦XÂ¢
= eâˆ’1
2 t2Ïƒ2.
Now since X and Y are independent,
E
Â³
eithâ—¦Xâ€²Â´
=
E
Âµ
e
ith
Â³
1
âˆš
2
Â´
(X+Y )
Â¶
=
E
Âµ
e
ith
Â³
1
âˆš
2
Â´
X
Â¶
E
Âµ
e
ith
Â³
1
âˆš
2
Â´
Y
Â¶
the product of two characteristic functions of two random variables,
1
âˆš
2X and
1
âˆš
2Y.
The variance of these two random variables which are normally distributed with
zero mean is 1
2Ïƒ2 and so
E
Â³
eithâ—¦Xâ€²Â´
= eâˆ’1
2( 1
2 Ïƒ2)eâˆ’1
2( 1
2 Ïƒ2) = eâˆ’1
2 Ïƒ2 = E
Â¡
eithâ—¦XÂ¢
.

1058
PROBABILITY IN INFINITE DIMENSIONS
Similar reasoning shows E
Â³
eithâ—¦Y â€²Â´
= E
Â¡
eithâ—¦Y Â¢
= E
Â¡
eithâ—¦XÂ¢
. Letting t = 1, this
yields 36.48. This proves the lemma.
With this preparation, here is an incredible theorem due to Fernique.
Theorem 36.85 Let Âµ be a symmetric Gaussian measure on B (E) where E is a
real separable Banach space. Then for Î» suï¬ƒciently small and positive,
Z
R
eÎ»||x||2dÂµ < âˆž.
More speciï¬cally, if Î» and r are chosen such that
ln
ï£«
ï£­Âµ ([x : ||x|| > r])
Âµ
Â³
B (0, r)
Â´
ï£¶
ï£¸+ 25Î»r2 < âˆ’1,
then
Z
R
eÎ»||x||2dÂµ â‰¤exp
Â¡
Î»r2Â¢
+
e2
e2 âˆ’1.
Proof: Let X, Y be independent random variables having values in E such that
L (X) = L (Y ) = Âµ. Then by Lemma 36.84
1
âˆš
2 (X âˆ’Y ) , 1
âˆš
2 (X + Y )
are also independent and have the same law. Now let 0 â‰¤s â‰¤t and use indepen-
dence of the above random variables along with the fact they have the same law as
X and Y to obtain
P (||X|| â‰¤s, ||Y || > t) = P (||X|| â‰¤s) P (||Y || > t)
=
P
ÂµÂ¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
âˆš
2 (X âˆ’Y )
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤s
Â¶
P
ÂµÂ¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
âˆš
2 (X + Y )
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ > t
Â¶
=
P
ÂµÂ¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
âˆš
2 (X âˆ’Y )
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ â‰¤s,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
âˆš
2 (X + Y )
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ > t
Â¶
â‰¤
P
Âµ 1
âˆš
2 |||X|| âˆ’||Y ||| â‰¤s,
1
âˆš
2 (||X|| + ||Y ||) > t
Â¶
.
Now consider the following picture in which the region, R represents the points,
(||X|| , ||Y ||) such that
1
âˆš
2 |||X|| âˆ’||Y ||| â‰¤s and
1
âˆš
2 (||X|| + ||Y ||) > t.

36.14.
FERNIQUEâ€™S THEOREM
1059
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
Â¡
r
r (?, tâˆ’s
âˆš
2 )
( tâˆ’s
âˆš
2 , ?)-
R
Therefore, continuing with the chain of inequalities above,
P (||X|| â‰¤s) P (||Y || > t)
â‰¤
P
Âµ
||X|| > t âˆ’s
âˆš
2 , ||Y || > t âˆ’s
âˆš
2
Â¶
=
P
Âµ
||X|| > t âˆ’s
âˆš
2
Â¶2
.
Since X, Y have the same law, this can be written as
P (||X|| > t) â‰¤
P
Â³
||X|| > tâˆ’s
âˆš
2
Â´2
P (||X|| â‰¤s)
.
Now deï¬ne a sequence as follows. t0 â‰¡r > 0 and tn+1 â‰¡r +
âˆš
2tn. Also, in the
above inequality, let s â‰¡r and then it follows
P (||X|| > tn+1)
â‰¤
P
Â³
||X|| > tn+1âˆ’r
âˆš
2
Â´2
P (||X|| â‰¤r)
=
P (||X|| > tn)2
P (||X|| â‰¤r) .
Let
Î±n (r) â‰¡P (||X|| > tn)
P (||X|| â‰¤r) .
Then it follows
Î±n+1 (r) â‰¤Î±n (r)2 , Î±0 (r) = P (||X|| > r)
P (||X|| â‰¤r).
Consequently, Î±n (r) â‰¤Î±0 (r)2n
and also
P (||X|| > tn)
=
Î±n (r) P (||X|| â‰¤r)
â‰¤
P (||X|| â‰¤r) Î±0 (r)2n
=
P (||X|| â‰¤r) eln(Î±0(r))2n.
(36.49)

1060
PROBABILITY IN INFINITE DIMENSIONS
Now using the distribution function technique and letting Î» > 0,
Z
E
eÎ»||x||2dÂµ
=
Z âˆž
0
Âµ
Â³h
eÎ»||x||2 > t
iÂ´
dt
=
1 +
Z âˆž
1
Âµ
Â³h
eÎ»||x||2 > t
iÂ´
dt
=
1 +
Z âˆž
1
P
Â³h
eÎ»||X||2 > t
iÂ´
dt.
(36.50)
From 36.49,
P
Â³h
exp
Â³
Î» ||X||2Â´
> exp
Â¡
Î»t2
n
Â¢iÂ´
â‰¤P ([||X|| â‰¤r]) eln(Î±0(r))2n.
Now split the above improper integral into intervals,
Â¡
exp
Â¡
Î»t2
n
Â¢
, exp
Â¡
Î»t2
n+1
Â¢Â¢
for
n = 0, 1, Â· Â· Â· and note that P
Â³h
eÎ»||X||2 > t
iÂ´
is decreasing in t. Then from 36.50,
Z
E
eÎ»||x||2dÂµ â‰¤exp
Â¡
Î»r2Â¢
+
âˆž
X
n=0
Z exp(Î»t2
n+1)
exp(Î»t2
n)
P
Â³h
eÎ»||X||2 > t
iÂ´
dt
â‰¤
exp
Â¡
Î»r2Â¢
+
âˆž
X
n=0
P
Â³h
eÎ»||X||2 > exp
Â¡
Î»t2
n
Â¢iÂ´ Â¡
exp
Â¡
Î»t2
n+1
Â¢
âˆ’exp
Â¡
Î»t2
n
Â¢Â¢
â‰¤
exp
Â¡
Î»r2Â¢
+
âˆž
X
n=0
P ([||X|| â‰¤r]) eln(Î±0(r))2n exp
Â¡
Î»t2
n+1
Â¢
â‰¤
exp
Â¡
Î»r2Â¢
+
âˆž
X
n=0
eln(Î±0(r))2n exp
Â¡
Î»t2
n+1
Â¢
.
It remains to estimate tn+1. From the description of the tn,
tn =
Ãƒ n
X
k=0
Â³âˆš
2
Â´k
!
r = r
Â¡âˆš
2
Â¢n+1 âˆ’1
âˆš
2 âˆ’1
â‰¤
âˆš
2
âˆš
2 âˆ’1r
Â³âˆš
2
Â´n
and so
tn+1 â‰¤5r
Â³âˆš
2
Â´n
Therefore,
Z
E
eÎ»||x||2dÂµ â‰¤exp
Â¡
Î»r2Â¢
+
âˆž
X
n=0
eln(Î±0(r))2n+Î»25r22n.
Now ï¬rst pick r large enough that ln (Î±0 (r)) < âˆ’2 and then let Î» be small enough
that 25Î»r2 < 1 or some such scheme and you obtain ln (Î±0 (r))+Î»25r2 < âˆ’1. Then

36.15.
REPRODUCING KERNELS
1061
for this choice of r and Î», or for any other choice which makes ln (Î±0 (r)) + Î»25r2 <
âˆ’1,
Z
E
eÎ»||x||2dÂµ
â‰¤
exp
Â¡
Î»r2Â¢
+
âˆž
X
n=0
eâˆ’2n
â‰¤
exp
Â¡
Î»r2Â¢
+
âˆž
X
n=0
eâˆ’2n
=
exp
Â¡
Î»r2Â¢
+
e2
e2 âˆ’1.
This proves the theorem.
Note this theorem implies all moments exist for Gaussian measures.
36.15
Reproducing Kernels
Suppose Âµ is a symmetric Gaussian measure on a real separable Banach space, E.
Recall this means that for Ï† âˆˆEâ€², L (Ï†) = N
Â¡
0, Ïƒ2Â¢
for some Ïƒ2. So what is Ïƒ2 in
terms of Ï†? By deï¬nition
Ïƒ2 = E
Â¡
Ï†2Â¢
=
Z
E
Ï† (x)2 dÂµ
(36.51)
and so Ï† âˆˆL2 (E) . Thus you can consider Eâ€² âŠ†L2 (E) . Let Eâ€² denote the closure
of Eâ€² in L2 (E). Then Eâ€² is a Hilbert space with inner product given by
(Ï†, Ïˆ) â‰¡
Z
E
Ï† (x) Ïˆ (x) dÂµ.
For Ï† âˆˆL2 (E) , denote by Râˆ’1Ï† the element of E given by the Bochner integral,
Râˆ’1Ï† â‰¡
Z
E
xÏ† (x) dÂµ.
(36.52)
It is necessary to verify this integral makes sense. By Ferniqueâ€™s theorem, Theorem
36.85,
Z
E
||x||2 dÂµ â‰¤C
Z
E
eÎ»||x||2dÂµ < âˆž
and so by the Cauchy Schwarz inequality,
Z
E
||xÏ† (x)|| dÂµ â‰¤
ÂµZ
E
||x||2 dÂµ
Â¶1/2 ÂµZ
E
|Ï† (x)|2 dÂµ
Â¶1/2
< âˆž.
Also in 36.52 the integrand is weakly measurable and is separably valued so the
Bochner integral makes sense as claimed and the integrand is in L1 (E; E).

1062
PROBABILITY IN INFINITE DIMENSIONS
The map, Râˆ’1 is clearly linear and it is also one to one on Eâ€² because if Râˆ’1Ï† =
0, then there exists a sequence {Ï†n} âŠ†Eâ€² converging to Ï† in L2 (E) . Therefore,
0 = Ï†n
ÂµZ
E
xÏ† (x) dÂµ
Â¶
=
Z
E
Ï†n (x) Ï† (x) dÂµ â†’
Z
E
Ï† (x)2 dÂµ
and so Ï† (x) = 0 a.e. x.
Now deï¬ne
H â‰¡
Â©
Râˆ’1Ï† : Ï† âˆˆEâ€²Âª
and let an inner product be given by
Â¡
Râˆ’1Ï†, Râˆ’1Ïˆ
Â¢
H â‰¡
Z
E
Ï† (x) Ïˆ (x) dÂµ.
Since Râˆ’1 is one to one, the inner product is well deï¬ned and the map, Râˆ’1 : Eâ€² â†’
H is one to one, onto, and preserves norms. Therefore, H is also a Hilbert space.
Now before making the next observation, note that by Ferniqueâ€™s theorem, The-
orem 36.85, there exists Î» > 0 such that
Z
E
||x||2 dÂµ = 1
Î»
Z
E
Î» ||x||2 dÂµ â‰¤1
Î»
Z
E
eÎ»||x||2dÂµ â‰¡CÂµ < âˆž.
This implies H embedds continuously into E because
Â¯Â¯Â¯Â¯Râˆ’1Ï†
Â¯Â¯Â¯Â¯
E
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z
E
xÏ† (x) dÂµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
E
â‰¤
Z
E
||x||E |Ï† (x)| dÂµ
â‰¤
ÂµZ
E
||x||2 dÂµ
Â¶1/2 ÂµZ
E
Ï† (x)2 dÂµ
Â¶1/2
=
CÂµ
ÂµZ
E
Ï† (x)2 dÂµ
Â¶1/2
â‰¡CÂµ
Â¯Â¯Â¯Â¯Râˆ’1Ï†
Â¯Â¯Â¯Â¯
H
Now it follows from all this that H is a Hilbert space which embedds continuously
into E and for Ï† âˆˆEâ€²,
||iâˆ—Ï†||Hâ€²
â‰¡
sup
|h|Hâ‰¤1,hâˆˆH
Ï† (h)
=
sup
|Râˆ’1Ïˆ|Hâ‰¤1,ÏˆâˆˆEâ€² Ï†
Â¡
Râˆ’1 (Ïˆ)
Â¢
=
sup
|Râˆ’1Ïˆ|Hâ‰¤1,ÏˆâˆˆEâ€² Ï†
ÂµZ
E
xÏˆ (x) dÂµ
Â¶
=
sup
||Ïˆ||L2(E)â‰¤1,ÏˆâˆˆEâ€²
Z
E
Ï† (x) Ïˆ (x) dÂµ
=
||Ï†||L2(E) = Ïƒ.
by 36.51.

36.15.
REPRODUCING KERNELS
1063
Finally, I claim that H must be dense in E. To see this, suppose it is not the
case. Then by a standard use of the Hahn Banch theorem, there would exist Ï† âˆˆEâ€²
such that Ï† (H) = 0 but Ï† Ì¸= 0. But then
0 = Ï†
Â¡
Râˆ’1Ï†
Â¢
â‰¡Ï†
ÂµZ
E
xÏ† (x) dÂµ
Â¶
=
Z
E
Ï† (x)2 dÂµ
which is a contradiction. In fact, this shows even more than H is dense in E. It
also shows that Râˆ’1 (E) â‰¡H0 âŠ†H is dense in E.
Deï¬nition 36.86 Let Âµ be a symmetric Gaussian measure on a real separable Ba-
nach space, E. Then a Hilbert space, H is said to be a reproducing kernel space for
Âµ if H âŠ†E with the inclusion map continuous, and for every Ï† âˆˆEâ€²,
L (Ï†) = N (0, |Ï†|H)
where
||iâˆ—Ï†||Hâ€² â‰¡
sup
||h||Hâ‰¤1,hâˆˆH
Ï† (h) = ||Ï†||L2(E)
Implicit in this deï¬nition are the inclusions,
H âŠ†E, Eâ€² âŠ†Hâ€² âŠ†L2 (E, Âµ)
where i is the inclusion map of H into E.
Now I need a technical lemma before proving the next theorem.
Lemma 36.87 Suppose A is a reï¬‚exive Banach space and A âŠ†B with the inclusion
map, i continuous. Also suppose M is a subset of Bâ€² which separates the points of
A. Then iâˆ—M is dense in Aâ€².
Proof: Suppose that iâˆ—M is not dense in Aâ€². Then there exists aâˆ—âˆˆAâ€²\
Â¡
iâˆ—M
Â¢
.
It follows from a standard construction using the Hahn Banach theorem there exists
aâˆ—âˆ—âˆˆAâ€²â€² such that aâˆ—âˆ—(aâˆ—) Ì¸= 0 but aâˆ—âˆ—(iâˆ—bâˆ—) = 0 for all bâˆ—âˆˆM. Since A is
reï¬‚exive, there exists a Ì¸= 0 such that a âˆˆA and Ja = aâˆ—âˆ—where J is the James
map from A to Aâˆ—âˆ—given by Ja (aâˆ—) â‰¡aâˆ—(a) . Then for all bâˆ—âˆˆM,
0 = aâˆ—âˆ—(iâˆ—bâˆ—) = Ja (iâˆ—bâˆ—) = iâˆ—bâˆ—(a) â‰¡bâˆ—(a) .
Since M separates the points, this implies that a = 0 contrary to a Ì¸= 0. This proves
the lemma.
The above discussion proves the existence part of the following theorem.
Theorem 36.88 If Âµ is a symmetric Gaussian measure on E, a real separable
Banach space, then there exists a unique reproducing kernel space, H satisfying the
above properties of Deï¬nition 36.86. Also it must be the case that H is dense in E
and that the inverse Riesz map, Râˆ’1 from Hâ€² to H is given by
Râˆ’1Ï† â‰¡
Z
E
xÏ† (x) dÂµ

1064
PROBABILITY IN INFINITE DIMENSIONS
Proof: For Ï† âˆˆL2 (E, Âµ) deï¬ne
Sâˆ’1Ï† â‰¡
Z
E
xÏ† (x) dÂµ.
The integrand is weakly measurable and separably valued and Ferniqueâ€™s theorem
implies
Z
E
||x||E |Ï† (x)| dÂµ â‰¤
ÂµZ
E
||x||2 dÂµ
Â¶1/2 ÂµZ
E
|Ï† (x)|2 dÂµ
Â¶1/2
< âˆž
so Sâˆ’1 is deï¬ned on all of L2 (E, Âµ).
Sâˆ’1 (Eâ€²) is dense in E because if not, there would exist Ï† âˆˆEâ€² such that Ï† Ì¸= 0
but Ï†
Â¡
Sâˆ’1 (Eâ€²)
Â¢
= 0 but then
0 = Ï†
Â¡
Sâˆ’1 (Ï†)
Â¢
= Ï†
ÂµZ
E
xÏ† (x) dÂµ
Â¶
=
Z
E
Ï† (x)2 dÂµ,
a contradiction to Ï† Ì¸= 0.
Now suppose H1 and H are two reproducing kernel spaces for Âµ.
Let Ï† âˆˆ
Hâ€²
1 âŠ†L2 (E, Âµ). Since the norm on Hâ€² equals the L2 (E) norm, it follows that for
Ï† âˆˆEâ€², Ïˆ âˆˆHâ€² and R the Riesz map from H to Hâ€²,
Ï†
Â¡
Râˆ’1 (Ïˆ)
Â¢
=
R
Â¡
Râˆ’1 (Ï†)
Â¢ Â¡
Râˆ’1Ïˆ
Â¢
=
Â¡
Râˆ’1Ï†, Râˆ’1Ïˆ
Â¢
H = (Ï†, Ïˆ)Hâ€²
=
Z
E
Ï† (x) Ïˆ (x) dÂµ = Ï†
Â¡
Sâˆ’1 (Ïˆ)
Â¢
.
Therefore, Râˆ’1 = Sâˆ’1 on Hâ€². A similar conclusion holds for H1.
By Lemma 36.87, Eâ€² must be dense in Hâ€²
1 and also dense in Hâ€². Thus Sâˆ’1 (Eâ€²)
is dense in both H and H1. Letting Ï† âˆˆHâ€²
1 there exists {Ï†n} a sequence in Eâ€²
which converges to Ï† in Hâ€²
1. Which implies Ï†n â†’Ï† in L2 (E, Âµ) because the norms
are the same. But then Ï†n is also a Cauchy sequence in Hâ€² which shows Ï† âˆˆHâ€².
Thus Hâ€²
1 âŠ†Hâ€² and similarly, Hâ€² âŠ†Hâ€²
1. It follows H = Sâˆ’1 (Hâ€²) = Sâˆ’1 (Hâ€²
1) = H1.
This proves the theorem.
Deï¬nition 36.89 For Âµ a symmetric Gaussian measure on E a real separable Ba-
nach space, denote by HÂµ the reproducing kernel Hilbert space described in Deï¬nition
36.86.
Here is an interesting formula. Letting E be a real separable Banach space and
Âµ a symmetric Gaussian measure on B (E) , with HÂµ the reproducing kernel space,
consider h, g âˆˆHÂµ. Then letting Ï†h, Ï†g âˆˆHâ€²
Âµ such that Râˆ’1Ï†h = h and Râˆ’1Ï†g = g,
(h, g)HÂµ â‰¡
Z
E
Ï†h (x) Ï†g (x) dÂµ.
(36.53)

36.15.
REPRODUCING KERNELS
1065
Also, for x âˆˆH,
(h, x)HÂµ =
Â¡
Râˆ’1Ï†h, x
Â¢
HÂµ â‰¡Ï†h (x) ,
a similar formula holding for g in place of h. Now using this in 36.53 yields the
following interesting formula.
(h, g)HÂµ â‰¡
Z
E
(h, x)HÂµ (g, x)HÂµ dÂµ.
Next consider the question of how to identify reproducing kernels and how to
tell whether a given probability measure is a Gaussian measure.
Before the next theorem is proved, recall the following two theorems proved on
Pages 1029 and 1027 respectively.
Theorem 36.90 Let X and Y be random vectors having values in Rp and Rq
respectively. Suppose also that (X, Y) is normally distributed and
E
Â¡
(X âˆ’E (X)) (Y âˆ’E (Y))âˆ—Â¢
= 0.
Then X and Y are independent random vectors.
Theorem 36.91 Suppose Î½ is a probability measure on the Borel sets of R and
suppose that Î¾ and Î¶ are independent random variables such that L (Î¾) = L (Î¶) = Î½
and whenever Î±2 + Î²2 = 1 it follows L (Î±Î¾ + Î²Î¶) = Î½. Then
L (Î¾) = N
Â¡
0, Ïƒ2Â¢
for some Ïƒ â‰¥0. Also if L (Î¾) = L (Î¶) = N
Â¡
0, Ïƒ2Â¢
where Î¾, Î¶ are independent, then
if Î±2 + Î²2 = 1, it follows L (Î±Î¾ + Î²Î¶) = N
Â¡
0, Ïƒ2Â¢
.
Also recall the following theorem and corollary proved on Page 870.
Theorem 36.92 Let X = (X1, Â· Â· Â·, Xp) where each Xi is a real valued random
variable. Then X is normally distributed in the above generalized sense if and only
if every linear combination, Pp
j=1 aiXi is normally distributed. In this case the
mean of X is
m = (E (X1) , Â· Â· Â·, E (Xp))
and the covariance matrix for X is
Î£jk = E ((Xj âˆ’mj) (Xk âˆ’mk))
where mj = E (Xj).
Corollary 36.93 Let X = (X1, Â· Â· Â·, Xp) , Y = (Y1, Â· Â· Â·, Yp) where each Xi, Yi is a
real valued random variable. Suppose also that for every a âˆˆRp, a Â· X and a Â· Y
are both normally distributed with the same mean and variance. Then X and Y are
both multivariate normal random vectors with the same mean and covariance.

1066
PROBABILITY IN INFINITE DIMENSIONS
Lemma 36.94 Let M âŠ†Eâ€², where E is a real separable Banach space, be such that
Ïƒ (M) = B (E) . Also suppose X, Y are two E valued random variables such that for
all n âˆˆN, and âƒ—Ï† âˆˆM n, L
Â³
âƒ—Ï† â—¦X
Â´
= L
Â³
âƒ—Ï† â—¦Y
Â´
. That is, for all F âˆˆB (Rn) ,
P
Â³h
âƒ—Ï† â—¦X âˆˆF
iÂ´
= P
Â³h
âƒ—Ï† â—¦Y âˆˆF
iÂ´
Then L (X) = L (Y ).
Proof: Deï¬ne F as the Ï€ system which consists of cylindrical sets of the form
(
x âˆˆE : âƒ—Ï† (x) âˆˆ
m
Y
i=1
Gi, Gi âˆˆB (R)
)
where âƒ—Ï† âˆˆM mfor some m âˆˆN. Thus Ïƒ (F) = Ïƒ (M) = B (E) and F is clearly a Ï€
system.
Now deï¬ne
G â‰¡{F âˆˆÏƒ (F) = B (E) : P ([X âˆˆF]) = P ([Y âˆˆF])} .
First suppose F âˆˆF. Then
F = âƒ—Ï†
âˆ’1
Ãƒ m
Y
i=1
Gi
!
where each Gi is in B (R). Thus
P ([X âˆˆF])
=
P
Ãƒ"
X âˆˆâƒ—Ï†
âˆ’1
Ãƒ m
Y
i=1
Gi
!#!
=
P
Ãƒ"
âƒ—Ï† (X) âˆˆ
Ãƒ m
Y
i=1
Gi
!#!
=
P
Ãƒ"
âƒ—Ï† (Y ) âˆˆ
Ãƒ m
Y
i=1
Gi
!#!
=
P ([Y âˆˆF])
and so F âŠ†G. If A âˆˆG then
P
Â¡Â£
X âˆˆACÂ¤Â¢
=
1 âˆ’P ([X âˆˆA])
=
1 âˆ’P ([Y âˆˆA]) = P
Â¡Â£
Y âˆˆACÂ¤Â¢
and so G is closed under complements. Next, if {Ai} is a sequence of disjoint sets

36.15.
REPRODUCING KERNELS
1067
of G,
P ([X âˆˆâˆªâˆž
i=1Ai])
=
P (âˆªâˆž
i=1 [X âˆˆAi])
=
âˆž
X
i=1
P ([X âˆˆAi])
=
âˆž
X
i=1
P ([Y âˆˆAi])
=
P ([Y âˆˆâˆªâˆž
i=1Ai]) .
It follows from the lemma about Ï€ systems, Lemma 9.72 on Page 257 that G = Ïƒ (F) =
B (E) and this says L (X) = L (Y ). This proves the lemma.
So when do the conditions of this lemma hold? It seems a fairly strong assump-
tion to have L
Â³
âƒ—Ï† â—¦X
Â´
= L
Â³
âƒ—Ï† â—¦Y
Â´
for all âƒ—Ï† âˆˆM n for any n âˆˆN. In the next
corollary, this condition will hold. This corollary says that if Ïƒ (M) = B (E) , then
in verifying a probability measure is Gaussian, you only need to consider Ï† âˆˆM
rather than all Ï† âˆˆEâ€².
Corollary 36.95 Suppose E is a real separable Banach space and Âµ is a probability
measure on B (E) . Suppose M is a subspace of Eâ€² with the property that Ïƒ (M)2=
B (E) such that each Ï† âˆˆM considered as a random variable on the probability
space, (E, B (E) , Âµ) is normally distributed with mean 0 and variance ||Ï†||2
L2(E) .
Then Âµ is a symmetric Gaussian measure.
Proof: Let X, Y be independent random variables having values in E such
that L (X) = L (Y ) = Âµ.
As indicated earlier, such a thing exists.
You apply
Skorokhodâ€™s theorem to the product measure Âµ Ã— Âµ to ï¬nd (X, Y ) having values in
E Ã— E such that L ((X, Y )) = Âµ Ã— Âµ.
I want to show that for all Ï† âˆˆEâ€², L (Ï†) = N
Â¡
0, Ïƒ2Â¢
for some Ïƒ. I know this is
true for Ï† âˆˆM. Therefore, by Theorem 36.91, if Ï† âˆˆM and Î±2 + Î²2 = 1, then
L (Ï† (Î±X + Î²Y )) = L (Ï† (X)) ,
and both random variables are normally distributed with 0 mean. Now take âƒ—Ï† âˆˆM n
and consider aÂ·âƒ—Ï† which is also in M because M is a subspace. Then from the above,
L
Â³
a Â· âƒ—Ï† (Î±X + Î²Y )
Â´
= L
Â³
a Â·
Â³
Î±âƒ—Ï† (X) + Î²âƒ—Ï† (Y )
Â´Â´
= L
Â³
a Â· âƒ—Ï† (X)
Â´
.
and the random variables, a Â· âƒ—Ï† (X) and a Â·
Â³
Î±âƒ—Ï† (X) + Î²âƒ—Ï† (Y )
Â´
are both normally
distributed with 0 mean and have the same distribution. Then by Corollary 36.93
L
Â³
âƒ—Ï† (X)
Â´
=
L
Â³
Î±âƒ—Ï† (X) + Î²âƒ—Ï† (Y )
Â´
=
L
Â³
âƒ—Ï† (Î±X + Î²Y )
Â´
2Recall this means the smallest Ïƒ algebra such that each function in M is measurable.

1068
PROBABILITY IN INFINITE DIMENSIONS
and both are equal to a multvariate normal distribution. Now applying Lemma
36.94, it follows
L (X) = L (Î±X + Î²Y ) = Âµ
(36.54)
whenever Î±2 + Î²2 = 1.
I want to verify L (Ï†) = N
Â³
0, ||Ï†||2
L2(E)
Â´
for all Ï† âˆˆEâ€². I have just shown that
whenever X, Y are independent with L (X) = L (Y ) = Âµ, then if Î±2 + Î²2 = 1, it
follows 36.54 holds. Now take an arbitrary Ï† âˆˆEâ€². It follows
L (Ï† (X)) = L (Ï† (Î±X + Î²Y )) = L (Î±Ï† (X) + Î²Ï† (Y ))
(36.55)
whenever X, Y are independent having L (X) = L (Y ) = Âµ and Î±2 + Î²2 = 1. This
is a good time to state Theorem 36.91 again. Here it is:
Theorem 36.96 Suppose Î½ is a probability measure on the Borel sets of R and
suppose that Î¾ and Î¶ are independent random variables such that L (Î¾) = L (Î¶) = Î½
and whenever Î±2 + Î²2 = 1 it follows L (Î±Î¾ + Î²Î¶) = Î½. Then
L (Î¾) = N
Â¡
0, Ïƒ2Â¢
for some Ïƒ â‰¥0. Also if L (Î¾) = L (Î¶) = N
Â¡
0, Ïƒ2Â¢
where Î¾, Î¶ are independent, then
if Î±2 + Î²2 = 1, it follows L (Î±Î¾ + Î²Î¶) = N
Â¡
0, Ïƒ2Â¢
.
Fixing Ï† âˆˆEâ€², deï¬ne Î½ (F) â‰¡Âµ ([Ï† (X) âˆˆF]) = Âµ ([Ï† (Y ) âˆˆF]) so Î½ is a proba-
bility measure on the Borel sets of R and L (Ï† â—¦X) = L (Ï† â—¦X) = Î½. Furthermore,
from 36.55 Î½ = L (Î±Ï† (X) + Î²Ï† (Y )) whenever Î±2 + Î²2 = 1 and Ï† â—¦X and Ï† â—¦Y are
independent. Therefore by Theorem 36.91 L (Ï† â—¦X) = N
Â¡
0, Ïƒ2Â¢
. In other words,
letting (â„¦, F, P) be the probability space on which X is deï¬ned,
Z
E
eitÏ†(x)dÂµ =
Z
â„¦
eitÏ†(X(Ï‰))dP = eâˆ’1
2 Ïƒ2t2
which shows L (Ï†) = N
Â¡
0, Ïƒ2Â¢
because the characteristic function of the random
variable, Ï† equals the characteristic function of one which has law equal to N
Â¡
0, Ïƒ2Â¢
.
This proves the corollary.
In the above corollary, you could say Âµ was Gaussian by verifying it worked as
it should with regard to Ï† âˆˆM where M was a suitable subset of Eâ€². In this next
theorem, this result will be combined with one which also gives a way to identify
the reproducing kernel space.
Theorem 36.97 Suppose E is a real separable Banach space and Âµ is a probability
measure on B (E) . Suppose M is a subspace of Eâ€² with the property that Ïƒ (M) =
B (E) such that each Ï† âˆˆM considered as a random variable on the probability space,
(E, B (E) , Âµ) is normally distributed with mean 0 and variance ||Ï†||2
L2(E) . Then Âµ
is a symmetric Gaussian measure. Next also assume M separates the points of E
and that H is a Hilbert space continuously embedded in E with the property that for
every Ï† âˆˆM,
||iâˆ—Ï†||Hâ€² = ||Ï†||L2(E) .

36.15.
REPRODUCING KERNELS
1069
Then it follows
||iâˆ—Ï†||Hâ€² = ||Ï†||L2(E)
for all Ï† âˆˆEâ€² and H is the reproducing kernel space for Âµ.
Proof: By Corollary 36.95 it follows Âµ is a Gaussian measure. It remains to
verify the assertion that H is the reproducing kernel space. To do this I will ï¬rst
show M = Eâ€² where the closure is taken in L2 (E; Âµ) . If this is not so, then there
exists Ï† âˆˆEâ€² \ M. Then there exists Ï†0 âˆˆM such that Ï† âˆ’Ï†0 Ì¸= 0 is orthogonal
to M, the orthogonality being in L2 (E). Furthermore, there exists a sequence,
{Ï†0n} âŠ†M such that Ï†0n â†’Ï†0 in L2 (E).
From the ï¬rst part, whenever Ïˆ âˆˆEâ€², L (Ïˆ) = N
Â³
0, ||Ï†||2
L2(E)
Â´
.(This is what
it means for Âµ to be Gaussian.) Let {Ïˆ1, Â· Â· Â·, Ïˆm} âŠ†M. Then an arbitrary linear
combination of these Ïˆj and Ï† âˆ’Ï†0n is another function in Eâ€² and so its law is
normal with zero mean. It follows from Theorem 36.92 that
(Ï† âˆ’Ï†0n, Ïˆ1, Â· Â· Â·, Ïˆm)
(36.56)
is a multivariate normal random vector having values in Rm+1. Now the random
vector,
(Ï† âˆ’Ï†0, Ïˆ1, Â· Â· Â·, Ïˆm)
(36.57)
is the limit in L2 (E) as n â†’âˆžof the random vectors in 36.56 and so the means
and covariances of the vectors in 36.56 converge. Thus the vector in 36.57 is also a
multivariate normal random vector. By Theorem 36.90 it follows the two random
vectors, Ï† âˆ’Ï†0 and (Ïˆ1, Â· Â· Â·, Ïˆm) are independent. Now it is easy to see that
Ïƒ (M) = âˆªF âŠ†M,F ï¬niteÏƒ (F) .
Therefore, Ïƒ (Ï† âˆ’Ï†0) and Ïƒ (M) = B (E) are independent. This implies Ï†âˆ’Ï†0 = 0.
Here is why. Since Ï†âˆ’Ï†0 is the limit in L2 (E) of continuous functions, and since Âµ
is regular by Lemma 36.17 on Page 1000 it can be assumed by changing Ï† âˆ’Ï†0 on
a set of measure zero that Ï† âˆ’Ï†0 is Borel measurable. Now here is an interesting
lemma.
Lemma 36.98 Suppose G and F are two Ïƒ algebras on a probability space, (â„¦, S, P)
and suppose they are independent and that G âŠ†F. Then if A âˆˆG it follows either
P (A) = 0 or P (A) = 1.
Proof of the lemma: Let A âˆˆG. Then
Z
â„¦
XA (Ï‰) dP
=
Z
â„¦
XA (Ï‰)2 dP
=
ÂµZ
â„¦
XAdP
Â¶ ÂµZ
â„¦
XAdP
Â¶
and so P (A) = P (A)2 . This proves the lemma.

1070
PROBABILITY IN INFINITE DIMENSIONS
Now continuing with the proof of Theorem 36.97, Ïƒ (Ï† âˆ’Ï†0) âŠ†B (E) and the
two are independent so every set in Ïƒ (Ï† âˆ’Ï†0) has measure either 0 or 1. Thus
Âµ ([|Ï† âˆ’Ï†0| > Î±])
always equals either 0 or 1.
However, t â†’Âµ
Â³h
|Ï† âˆ’Ï†0|2 > t
iÂ´
is a decreasing
function and so if t is large enough this function equals 0 since otherwise it always
equals 1 and
Z âˆž
0
Âµ
Â³h
|Ï† âˆ’Ï†0|2 > t
iÂ´
dt = âˆž
contrary to Ï† âˆ’Ï†0 being in L2. Therefore, there exists M such that
Âµ ([x âˆˆE : |Ï† (x) âˆ’Ï†0 (x)| â‰¤M]) = 1
This is impossible if the distribution of Ï† âˆ’Ï†0 is normal having positive variance
which is the case if Ï† âˆ’Ï†0 Ì¸= 0 in L2 (E). Therefore, Ï† = Ï†0 which shows that
M = Eâ€² in L2 (E) as claimed.
With this, it is time to show ||iâˆ—Ï†||Hâ€² = ||Ï†||L2(E) whenever Ï† âˆˆEâ€² given this
holds for Ï† âˆˆM. It is here that the assumption that M separates the points of E
is used for the ï¬rst time. Thus, assume
||iâˆ—Ï†||Hâ€² = ||Ï†||L2(E)
(36.58)
for all Ï† âˆˆM.
Let f âˆˆEâ€². Then iâˆ—f âˆˆHâ€². By Lemma 36.87 there exists a
sequence, {Ï†n} âŠ†M such that iâˆ—Ï†n â†’iâˆ—f in Hâ€². Hence by 36.58 it is also the case
that Ï†n â†’f in L2 (E). Let Ï†, Ïˆ âˆˆM. Then by 36.58 it is routine to verify
(iâˆ—Ï†, iâˆ—Ïˆ)Hâ€² =
Z
E
Ï† (x) Ïˆ (x) dÂµ.
Also recall that by Ferniqueâ€™s theorem and f âˆˆEâ€²
Z
E
||x|| |f (x)| dÂµ â‰¤||f||
Z
E
||x||2 dÂµ < âˆž
Therefore, letting Ï† âˆˆM,
Ï†
ÂµZ
E
xf (x) dÂµ
Â¶
=
Z
E
Ï† (x) f (x) dÂµ
=
lim
nâ†’âˆž
Z
Ï† (x) Ï†n (x) dÂµ
=
lim
nâ†’âˆž(iâˆ—Ï†, iâˆ—Ï†n)Hâ€² = (iâˆ—Ï†, iâˆ—f)Hâ€²
=
Ï†
Â¡
Râˆ’1 (iâˆ—f)
Â¢
where Râˆ’1 is the inverse of the Riesz map, R from H to Hâ€² which is deï¬ned by
Rx (y) = (x, y)H .

36.16.
REPRODUCING KERNELS AND WHITE NOISE
1071
Now here is where M separates the points is used. The above equation shows
since Ï† is arbitrary that
Z
E
xf (x) dÂµ = Râˆ’1 (iâˆ—f)
for any f âˆˆEâ€². This also shows that for all f, g âˆˆEâ€²
(iâˆ—f, iâˆ—g)Hâ€² =
Z
E
f (x) g (x) dÂµ
because
(iâˆ—f, iâˆ—g)Hâ€²
=
Â¡
Râˆ’1 (iâˆ—f) , Râˆ’1 (iâˆ—g)
Â¢
H
=
iâˆ—f
Â¡
Râˆ’1 (iâˆ—g)
Â¢
= f
ÂµZ
E
xg (x) dÂµ
Â¶
=
Z
E
f (x) g (x) dÂµ.
Therefore, letting f âˆˆEâ€², and noting that by Lemma 36.87 iâˆ—Eâ€² is dense in Hâ€²
||iâˆ—f||Hâ€²
â‰¡
sup
||h||Hâ‰¤1
f (h) =
sup
||Ïˆ||Hâ€²â‰¤1
f
Â¡
Râˆ’1Ïˆ
Â¢
=
sup
||iâˆ—Ïˆ||Hâ€²â‰¤1,ÏˆâˆˆEâ€² f
Â¡
Râˆ’1iâˆ—Ïˆ
Â¢
=
sup
||Ïˆ||L2(E)â‰¤1,ÏˆâˆˆEâ€²
Z
E
f (x) Ïˆ (x) dÂµ = ||f||L2(E)
and this proves the theorem. Since H has the properties of the reproducing kernel
space, it equals HÂµ.
36.16
Reproducing Kernels And White Noise
Consider the case where E is a real separable Banach space and Âµ is a symmetric
Gaussian measure on the Borel sets of E. Then as discussed in Theorem 36.88 there
exists a unique reproducing kernel space, HÂµ such that HÂµ is a dense subset of
E, Eâ€² is a dense subset of Hâ€²
Âµ, and the norm on Hâ€²
Âµ is the same as the norm in
L2 (E, Âµ) , HÂµ being a closed subspace of L2 (E, Âµ). Thus
HÂµ âŠ†E, Eâ€² âŠ†Hâ€²
Âµ âŠ†L2 (E, Âµ) .
Also recall H0
Âµ â‰¡Râˆ’1 (Eâ€²) where R is the Riesz map from HÂµ to Hâ€²
Âµ satisfying
Rx (y) â‰¡(x, y)HÂµ .
Then the theorem about white noise to be proved here is the following.

1072
PROBABILITY IN INFINITE DIMENSIONS
Theorem 36.99 Let E be a real separable Banach space and let Âµ be a Gaussian
measure deï¬ned on the Borel sets of E and let HÂµ be the reproducing kernel space for
E. Suppose also that there exists an orthonormal complete basis for HÂµ, {en} âŠ†H0
Âµ
such that for Ï†n âˆˆEâ€² deï¬ned by en = Râˆ’1Ï†n, span ({Ï†n}) is also dense in Eâ€². Then
if
Â©
Î¾j
Âª
is a sequence of independent random variables having mean 0 and variance
1, which are deï¬ned on a probability space, (â„¦, F, P) it follows
X (Ï‰) â‰¡
âˆž
X
i=1
Î¾i (Ï‰) ei
(36.59)
converges in E a.e. and L (X) = Âµ.
Proof: Let Ï†i = R (ei) where R is the Riesz map from HÂµ to Hâ€²
Âµ. Then it
follows Ï†i is normally distributed with mean 0 and variance Ïƒ2. What is Ïƒ2? By
deï¬nition, and the properties of the reproducing kernel space,
Ïƒ2
=
Z
E
Ï†2
i (x) dÂµ â‰¡(Ï†i, Ï†i)Hâ€²Âµ
=
Â¡
Râˆ’1Ï†i, Râˆ’1Ï†i
Â¢
HÂµ = (ei, ei)HÂµ = 1.
I claim that it is also the case that {Ï†i} are independent. First note that if Î±i âˆˆR,
then Pp
i=1 Î±iÏ†ni âˆˆEâ€² and so is also normally distributed. Hence by Theorem 31.23
on Page 870,
Â³
Ï†n1, Â· Â· Â·, Ï†np
Â´
is multivariate normal. Now
E
Â³
Ï†njÏ†nk
Â´
â‰¡
Z
E
Ï†nj (x) Ï†nk (x) dÂµ
=
Â³
Ï†nj, Ï†nk
Â´
Hâ€²Âµ
=
Â¡
enj, enk
Â¢
HÂµ = Î´jk
and so the covariance matrix is a diagonal. It follows from Theorem 31.25 on Page
872 that
n
Ï†nj
op
j=1 is independent. This establishes the claim and shows that a
special case of the theorem involves the consideration of
âˆž
X
k=1
Ï†k (x) ek.
(36.60)
Here the probability space is E and the measure is Âµ. Now this special case is easier
to work with and the plan is to consider this special case ï¬rst, showing that the
above sum in 36.60 converges to x for a.e. x âˆˆE and then extending to the general
case. The advantage of considering this special case ï¬rst is that you have a candidate
for the function to which the series converges which has known distribution.
Let S (x) â‰¡x and let SN (x) â‰¡PN
n=1 Ï†n (x) en. First of all, observe that
(E, B (E) , Âµ) is a probability space and S maps E to E and L (S) = Âµ.
Thus
S has known distribution and it is reasonable to try and get SN (x) to converge to
S (x).

36.16.
REPRODUCING KERNELS AND WHITE NOISE
1073
Let
L (SN) â‰¡ÂµN, L (S âˆ’SN) â‰¡ÂµâŠ¥
N.
First note that SN and SM âˆ’SN for M > N are independent random variables by
the ï¬rst part of this argument. Letting Ï† âˆˆspan ({Ï†n})
Ï†
Ãƒ N
X
k=1
Ï†n (x) en
!
=
N
X
k=1
Ï†n (x) Ï† (en)
and this series converges for each x âˆˆE as N â†’âˆžbecause Ï†k (en) = (ek, en)HÂµ =
Î´kn which implies that if n is suï¬ƒciently large Ï† (en) = 0 so the above sequence of
partial sums is eventually constant.
Therefore, letting Ï† âˆˆspan ({Ï†n}) ,
E (exp (iÏ† (S âˆ’SN))) E (exp (iÏ† (SN)))
=
lim
Mâ†’âˆžE (exp (iÏ† (SM âˆ’SN))) E (exp (iÏ† (SN)))
=
lim
Mâ†’âˆžE (exp (iÏ† (SM âˆ’SN)) exp (iÏ† (SN)))
=
E (exp (iÏ† (S âˆ’SN)) exp (iÏ† (SN)))
Now span ({Ï†n}) is dense in Eâ€² by assumption and so it follows from Corollary 36.40
on Page 1018 that S âˆ’SN and SN are independent random variables.
It follows from Theorem 36.47 on Page 1023 that
Âµ = ÂµN âˆ—ÂµâŠ¥
N
(36.61)
because S = SN + (S âˆ’SN) and the two random variables, SN and S âˆ’SN were
just shown to be independent.
Next I will show the measures
Â©
ÂµâŠ¥
N
Âª
are tight. This will set things up for an
application of Prokhorovâ€™s theorem. Let Îµ > 0 be given. Since Âµ is a ï¬nite measure
and E is separable, it follows from Lemmas 36.17 and 36.18 there exists a compact
set, K âŠ†E such that
Âµ (K) â‰¥1 âˆ’Îµ.
By 36.61,
1 âˆ’Îµ â‰¤Âµ (K) =
Z
E
ÂµâŠ¥
N (K âˆ’x) dÂµN (x)
and so there exists xN âˆˆE such that ÂµâŠ¥
N (K âˆ’xN) â‰¥1âˆ’Îµ. However, each Ï†k has a
symmetric distribution since they are each normally distributed with mean 0. Also,
S has a symmetric distribution and so it follows so does S âˆ’SN. Thus
ÂµâŠ¥
N (âˆ’K + xN) = ÂµâŠ¥
N (K âˆ’xN) â‰¥1 âˆ’Îµ.
Now note
(âˆ’K + xN) âˆ©(K âˆ’xN) âŠ†K âˆ’K
2

1074
PROBABILITY IN INFINITE DIMENSIONS
because if x âˆˆ(âˆ’K + xN) âˆ©(K âˆ’xN) , then x = âˆ’k1 + xN = k2 âˆ’xN and so
2x = k2 âˆ’k1 âˆˆK âˆ’K.
Therefore,
ÂµâŠ¥
N
ÂµK âˆ’K
2
Â¶
â‰¥ÂµâŠ¥
N ((âˆ’K + xN) âˆ©(K âˆ’xN)) â‰¥1 âˆ’2Îµ.
This follows easily because
ÂµâŠ¥
N
Â³
(âˆ’K + xN)C âˆª(K âˆ’xN)CÂ´
â‰¤
ÂµâŠ¥
N
Â³
(âˆ’K + xN)CÂ´
+ ÂµâŠ¥
N
Â³
(K âˆ’xN)CÂ´
â‰¤2Îµ.
Now note that Kâˆ’K
2
is a compact set because if f : EÃ—E â†’E is given by f (x, y) =
xâˆ’y
2
then f is continuous and so it maps the compact subset of E Ã— E, K Ã— K to
the compact set Kâˆ’K
2
. Since this set is not dependent on N this shows
Â©
ÂµâŠ¥
N
Âª
is
tight.
By Prokhorovâ€™s theorem, Theorem 36.23 on Page 1004 every subsequence of
Â©
ÂµâŠ¥
N
Âª
has a subsequence which converges weakly. I will show they all converge
weakly to the measure Î´0 deï¬ned by Î´0 (F) = 1 if 0 âˆˆF and Î´0 (F) = 0 if 0 /âˆˆ
F. From this it will follow that ÂµâŠ¥
N must converge weakly to Î´0. When this is
established, it will lead to the desired conclusion.
Let Ï† âˆˆspan ({Ï†n}) and let
Â©
ÂµâŠ¥
k
Âª
denote a weakly convergent subsequence of
Â©
ÂµâŠ¥
N
Âª
. Say this converges weakly to Î½. Then recall that since Ï† âˆˆspan ({Ï†n}) ,
lim
kâ†’âˆžÏ† (S (x) âˆ’Sk (x)) = 0
and so letting Y : E â†’E be given by Y (x) â‰¡0,
1
=
E (exp (iÏ† (Y ))) = lim
kâ†’âˆžE (exp (iÏ† (S âˆ’Sk)))
â‰¡
lim
kâ†’âˆž
Z
E
exp (iÏ† (x)) dÂµâŠ¥
k (x) =
Z
E
exp (iÏ† (x)) dÎ½.
By density of span ({Ï†n}) in Eâ€², it follows that
1 = E (exp (iÏ† (Y ))) =
Z
E
exp (iÏ† (x)) dÎ½
for all Ï† âˆˆEâ€². If Î» = L (Y ) , then for all Ï† âˆˆEâ€²,
Z
E
exp (iÏ† (x)) dÎ» = E (exp (iÏ† (Y ))) =
Z
E
exp (iÏ† (x)) dÎ½
By Theorem 36.36 it follows Î» = Î½ and so Î½ = L (Y ) where Y (x) â‰¡0. As discussed
above, this has shown that
Â©
ÂµâŠ¥
N
Âª
converges weakly to Î½ where Î½ = L (Y ). Also,

36.16.
REPRODUCING KERNELS AND WHITE NOISE
1075
Î½ = Î´0 because by Theorem 36.36 the two measures, Î½ and Î´0, have the same
characteristic functions.
Now consider B (0, Îµ)C âŠ†E. Î´0
Â³
âˆ‚
Â³
B (0, Îµ)CÂ´Â´
= 0 and so it follows by Lemma
36.25 on Page 1007 that
lim
Nâ†’âˆžÂµâŠ¥
N
Â³
B (0, Îµ)CÂ´
= Î´0
Â³
B (0, Îµ)CÂ´
= 0.
Therefore,
0
=
lim
Nâ†’âˆžÂµâŠ¥
N
Â³
B (0, Îµ)CÂ´
=
lim
Nâ†’âˆžÂµ
Â³h
S âˆ’SN âˆˆB (0, Îµ)CiÂ´
=
lim
Nâ†’âˆžÂµ ([||S âˆ’SN||E â‰¥Îµ]) .
Which shows SN converges in probability to S. In particular, there exists a subse-
quence nk such that for all m > nk,
Âµ
Â¡Â£
||S âˆ’Snk|| > 2âˆ’kÂ¤Â¢
< 2âˆ’k
Âµ
Â¡Â£
||Sm âˆ’Snk|| > 2âˆ’kÂ¤Â¢
< 2âˆ’k
(36.62)
Then {Snk} converges pointwise a.e. to S. Now it follows from Lemma 36.78 on
Page 1049 it follows that since the distributions of the Ï†k are symmetric that {Sn}
converges pointwise a.e. to S. Letting Ï† âˆˆEâ€²,
Ï† (Sn (x)) =
n
X
k=1
Ï†k (x) Ï† (ek)
which is a normally distributed random variable having mean 0 and variance Pn
k=1 Ï† (ek)2 .
Therefore,
E (exp (itÏ† (Sn))) = eâˆ’1
2 t2 Pn
k=1 Ï†(ek)2
and so, passing to the limit, yields
E (exp (itÏ† (S))) = eâˆ’1
2 t2 Pâˆž
k=1 Ï†(ek)2
the series in the last term converging because it equals
âˆž
X
k=1
Â¡
Râˆ’1Ï†, ek
Â¢2 =
Â¯Â¯Râˆ’1Ï†
Â¯Â¯2
HÂµ = |Ï†|2
Hâ€²Âµ = ||Ï†||2
L2(E,Âµ) .
Thus Ï† (S) is normally distributed with mean 0 and variance ||Ï†||2
L2(E).
Hence
L (S) = Âµ because if Î½ = L (S) , the above has just shown, for Ïˆ âˆˆEâ€²,
Ï†Î½ (Ïˆ) = eâˆ’1
2 ||Ïˆ||2
L2(E)

1076
PROBABILITY IN INFINITE DIMENSIONS
while
Ï†Âµ (Ïˆ) â‰¡
Z
E
eiÏˆ(x)dÂµ = eâˆ’1
2 ||Ïˆ||2
L2(E)
due to the observation that since Âµ is Gaussian, each Ïˆ âˆˆEâ€² is normal with mean 0
and variance equal to ||Ïˆ||2
L2(E). Since the two measures have the same characteristic
functions, they are equal by Theorem 36.36.
It only remains to consider the general case described in 36.59. Consider the
sum,
Xn (Ï‰) â‰¡
n
X
i=1
Î¾i (Ï‰) ei.
Letting Î½nm = L (Xn âˆ’Xm) for m < n, I would like to show that Î½nm = L (Sn âˆ’Sm)
deï¬ned above in terms of the sums involving the Ï†k. The reason for this is that if
these are the same, then
Âµ
Â¡Â£
||Sm âˆ’Snk|| > 2âˆ’kÂ¤Â¢
= P
Â¡
||Xm âˆ’Xnk|| > 2âˆ’kÂ¢
< 2âˆ’k
(36.63)
and the pointwise a.e. convergence of {Xn} will follow as above using Lemma 36.78
on Page 1049 and then the same characteristic function argument will show X (Ï‰)
deï¬ned in 36.59 has L (X) = Âµ. But the Î¾i are given to be independent and normally
distributed with mean 0 and variance 1 so
E (exp (iÏ† (Xn âˆ’Xm))) = eâˆ’1
2
Pn
k=m+1 Ï†(ek)2
which is the same as the result of
E (exp (iÏ† (Sn âˆ’Sm)))
and this implies the desired result. Thus 36.63 implies {Xnk}âˆž
k=1 converges point-
wise a.e. and then Lemma 36.78 on Page 1049 applies again to conclude {Xn}
converges pointwise a.e. That L (X) = Âµ follows as before from a characteristic
function argument. This proves the theorem.

Part V
Sobolev Spaces
1077


Weak Derivatives
37.1
Weak âˆ—Convergence
A very important sort of convergence in applications of functional analysis is the
concept of weak or weak âˆ—convergence. It is important because it allows you to
assert the existence of a convergent subsequence of a given bounded sequence. The
only problem is the convergence is very weak so it does not tell you as much as
you would like. Nevertheless, it is a very useful concept. The big theorems in the
subject are the Eberlein Smulian theorem and the Banach Alaoglu theorem about
the weak or weak âˆ—compactness of the closed unit balls in either a Banach space
or its dual space. These theorems are proved in Yosida [52]. Here I will present a
special case which turns out to be by far the most important in applications and it
is not hard to get from the Riesz representation theorem for Lp. First I deï¬ne weak
and weak âˆ—convergence.
Deï¬nition 37.1 Let Xâ€² be the dual of a Banach space X and let {xâˆ—
n} be a sequence
of elements of Xâ€². Then xâˆ—
n converges weak âˆ—to xâˆ—if and only if for all x âˆˆX,
lim
nâ†’âˆžxâˆ—
n (x) = xâˆ—(x) .
A sequence in X, {xn} converges weakly to x âˆˆX if and only if for all xâˆ—âˆˆXâ€²
lim
nâ†’âˆžxâˆ—(xn) = xâˆ—(x) .
The main result is contained in the following lemma.
Lemma 37.2 Let Xâ€² be the dual of a Banach space, X and suppose X is separa-
ble. Then if {xâˆ—
n} is a bounded sequence in Xâ€², there exists a weak âˆ—convergent
subsequence.
Proof: Let D be a dense countable set in X. Then the sequence, {xâˆ—
n (x)} is
bounded for all x and in particular for all x âˆˆD. Use the Cantor diagonal process to
obtain a subsequence, still denoted by n such that xâˆ—
n (d) converges for each d âˆˆD.
1079

1080
WEAK DERIVATIVES
Now let x âˆˆX be completely arbitrary. In fact {xâˆ—
n (x)} is a Cauchy sequence. Let
Îµ > 0 be given and pick d âˆˆD such that for all n
|xâˆ—
n (x) âˆ’xâˆ—
n (d)| < Îµ
3.
This is possible because D is dense. By the ï¬rst part of the proof, there exists NÎµ
such that for all m, n > NÎµ,
|xâˆ—
n (d) âˆ’xâˆ—
m (d)| < Îµ
3.
Then for such m, n,
|xâˆ—
n (x) âˆ’xâˆ—
m (x)|
â‰¤
|xâˆ—
n (x) âˆ’xâˆ—
n (d)| + |xâˆ—
n (d) âˆ’xâˆ—
m (d)|
+ |xâˆ—
m (d) âˆ’xâˆ—
m (x)|
<
Îµ
3 + Îµ
3 + Îµ
3 = Îµ.
Since Îµ is arbitrary, this shows {xâˆ—
n (x)} is a Cauchy sequence for all x âˆˆX.
Now deï¬ne f (x) â‰¡limnâ†’âˆžxâˆ—
n (x). Since each xâˆ—
n is linear, it follows f is also
linear. In addition to this,
|f (x)| = lim
nâ†’âˆž|xâˆ—
n (x)| â‰¤K ||x||
where K is some constant which is larger than all the norms of the xâˆ—
n. Such a
constant exists because the sequence, {xâˆ—
n} was bounded. This proves the lemma.
The lemma implies the following important theorem.
Theorem 37.3 Let â„¦be a measurable subset of Rn and let {fk} be a bounded
sequence in Lp (â„¦) where 1 < p â‰¤âˆž.
Then there exists a weak âˆ—convergent
subsequence.
Proof: Since Lpâ€² (â„¦) is separable, this follows from the Riesz representation
theorem.
Note that from the Riesz representation theorem, it follows that if p < âˆž, then
the sequence converges weakly.
37.2
Test Functions And Weak Derivatives
In elementary courses in mathematics, functions are often thought of as things
which have a formula associated with them and it is the formula which receives
the most attention. For example, in beginning calculus courses the derivative of a
function is deï¬ned as the limit of a diï¬€erence quotient. You start with one function
which tends to be identiï¬ed with a formula and, by taking a limit, you get another
formula for the derivative. A jump in abstraction occurs as soon as you encounter
the derivative of a function of n variables where the derivative is deï¬ned as a certain
linear transformation which is determined not by a formula but by what it does to
vectors. When this is understood, it reduces to the usual idea in one dimension. The

37.2.
TEST FUNCTIONS AND WEAK DERIVATIVES
1081
idea of weak partial derivatives goes further in the direction of deï¬ning something
in terms of what it does rather than by a formula, and extra generality is obtained
when it is used.
In particular, it is possible to diï¬€erentiate almost anything if
the notion of what is meant by the derivative is suï¬ƒciently weak. This has the
advantage of allowing the consideration of the weak partial derivative of a function
without having to agonize over the important question of existence but it has the
disadvantage of not being able to say much about the derivative. Nevertheless, it
is the idea of weak partial derivatives which makes it possible to use functional
analytic techniques in the study of partial diï¬€erential equations and it is shown in
this chapter that the concept of weak derivative is useful for unifying the discussion
of some very important theorems. Certain things which shold be true are.
Let â„¦âŠ†Rn. A distribution on â„¦is deï¬ned to be a linear functional on Câˆž
c (â„¦),
called the space of test functions. The space of all such linear functionals will be
denoted by Dâˆ—(â„¦). Actually, more is sometimes done here. One imposes a topology
on Câˆž
c (â„¦) making it into a topological vector space, and when this has been done,
Dâ€² (â„¦) is deï¬ned as the dual space of this topological vector space. To see this,
consult the book by Yosida [52] or the book by Rudin [46].
Example:
The space L1
loc (â„¦) may be considered as a subset of Dâˆ—(â„¦) as
follows.
f (Ï†) â‰¡
Z
â„¦
f (x) Ï† (x) dx
for all Ï† âˆˆCâˆž
c (â„¦).
Recall that f âˆˆL1
loc (â„¦) if fXK âˆˆL1 (â„¦) whenever K is
compact.
Example: Î´x âˆˆDâˆ—(â„¦) where Î´x (Ï†) â‰¡Ï† (x).
It will be observed from the above two examples and a little thought that Dâˆ—(â„¦)
is truly enormous. The derivative of a distribution will be deï¬ned in such a way that
it agrees with the usual notion of a derivative on those distributions which are also
continuously diï¬€erentiable functions. With this in mind, let f be the restriction to
â„¦of a smooth function deï¬ned on Rn. Then Dxif makes sense and for Ï† âˆˆCâˆž
c (â„¦)
Dxif (Ï†) â‰¡
Z
â„¦
Dxif (x) Ï† (x) dx = âˆ’
Z
â„¦
fDxiÏ†dx = âˆ’f (DxiÏ†).
This motivates the following deï¬nition.
Deï¬nition 37.4 For T âˆˆDâˆ—(â„¦)
DxiT (Ï†) â‰¡âˆ’T (DxiÏ†).
Of course one can continue taking derivatives indeï¬nitely. Thus,
DxixjT â‰¡Dxi
Â¡
DxjT
Â¢
and it is clear that all mixed partial derivatives are equal because this holds for
the functions in Câˆž
c (â„¦).
In this weak sense, the derivative of almost anything
exists, even functions that may be discontinuous everywhere. However the notion
of â€œderivativeâ€ is very weak, hence the name, â€œweak derivativesâ€.

1082
WEAK DERIVATIVES
Example: Let â„¦= R and let
H (x) â‰¡
Â½
1 if x â‰¥0,
0 if x < 0.
Then
DH (Ï†) = âˆ’
Z
H (x) Ï†â€² (x) dx = Ï† (0) = Î´0(Ï†).
Note that in this example, DH is not a function.
What happens when Df is a function?
Theorem 37.5 Let â„¦= (a, b) and suppose that f and Df are both in L1 (a, b).
Then f is equal to a continuous function a.e., still denoted by f and
f (x) = f (a) +
Z x
a
Df (t) dt.
In proving Theorem 37.5 the following lemma is useful.
Lemma 37.6 Let T âˆˆDâˆ—(a, b) and suppose DT = 0. Then there exists a constant
C such that
T (Ï†) =
Z b
a
CÏ†dx.
Proof: T (DÏ†) = 0 for all Ï† âˆˆCâˆž
c (a, b) from the deï¬nition of DT = 0. Let
Ï†0 âˆˆCâˆž
c (a, b) ,
Z b
a
Ï†0 (x) dx = 1,
and let
ÏˆÏ† (x) =
Z x
a
[Ï† (t) âˆ’
ÃƒZ b
a
Ï† (y) dy
!
Ï†0 (t)]dt
for Ï† âˆˆCâˆž
c (a, b). Thus ÏˆÏ† âˆˆCâˆž
c (a, b) and
DÏˆÏ† = Ï† âˆ’
ÃƒZ b
a
Ï† (y) dy
!
Ï†0.
Therefore,
Ï† = DÏˆÏ† +
ÃƒZ b
a
Ï† (y) dy
!
Ï†0
and so
T (Ï†) = T(DÏˆÏ†) +
ÃƒZ b
a
Ï† (y) dy
!
T(Ï†0) =
Z b
a
T (Ï†0) Ï† (y) dy.
Let C = TÏ†0. This proves the lemma.

37.2.
TEST FUNCTIONS AND WEAK DERIVATIVES
1083
Proof of Theorem 37.5 Since f and Df are both in L1 (a, b),
Df (Ï†) âˆ’
Z b
a
Df (x) Ï† (x) dx = 0.
Consider
f (Â·) âˆ’
Z (Â·)
a
Df (t) dt
and let Ï† âˆˆCâˆž
c (a, b).
D
Ãƒ
f (Â·) âˆ’
Z (Â·)
a
Df (t) dt
!
(Ï†)
â‰¡âˆ’
Z b
a
f (x) Ï†â€² (x) dx +
Z b
a
ÂµZ x
a
Df (t) dt
Â¶
Ï†â€² (x) dx
=
Df (Ï†) +
Z b
a
Z b
t
Df (t) Ï†â€² (x) dxdt
=
Df (Ï†) âˆ’
Z b
a
Df (t) Ï† (t) dt = 0.
By Lemma 37.6, there exists a constant, C, such that
Ãƒ
f (Â·) âˆ’
Z (Â·)
a
Df (t) dt
!
(Ï†) =
Z b
a
CÏ† (x) dx
for all Ï† âˆˆCâˆž
c (a, b). Thus
Z b
a
{
Âµ
f (x) âˆ’
Z x
a
Df (t) dt
Â¶
âˆ’C}Ï† (x) dx = 0
for all Ï† âˆˆCâˆž
c (a, b). It follows from Lemma 37.9 in the next section that
f (x) âˆ’
Z x
a
Df (t) dt âˆ’C = 0 a.e. x.
Thus let f (a) = C and write
f (x) = f (a) +
Z x
a
Df (t) dt.
This proves Theorem 37.5.
Theorem 37.5 says that
f (x) = f (a) +
Z x
a
Df (t) dt

1084
WEAK DERIVATIVES
whenever it makes sense to write
R x
a Df (t) dt, if Df is interpreted as a weak deriva-
tive. Somehow, this is the way it ought to be. It follows from the fundamental
theorem of calculus that f â€² (x) exists for a.e. x where the derivative is taken in the
sense of a limit of diï¬€erence quotients and f â€² (x) = Df (x). This raises an inter-
esting question. Suppose f is continuous on [a, b] and f â€² (x) exists in the classical
sense for a.e. x. Does it follow that
f (x) = f (a) +
Z x
a
f â€² (t) dt?
The answer is no. To see an example, consider Problem 4 on Page 445 which gives
an example of a function which is continuous on [0, 1], has a zero derivative for
a.e. x but climbs from 0 to 1 on [0, 1]. Thus this function is not recovered from
integrating its classical derivative.
In summary, if the notion of weak derivative is used, one can at least give
meaning to the derivative of almost anything, the mixed partial derivatives are
always equal, and, in one dimension, one can recover the function from integrating
its derivative. None of these claims are true for the classical derivative. Thus weak
derivatives are convenient and rule out pathologies.
37.3
Weak Derivatives In Lp
loc
Deï¬nition 37.7 Let U be an open set in Rn.f âˆˆLp
loc (U) if fXK âˆˆLp whenever
K is a compact subset of U.
Deï¬nition 37.8 For Î± = (k1, Â· Â· Â·, kn) where the ki are nonnegative integers, deï¬ne
|Î±| â‰¡
n
X
i=1
|kxi|, DÎ±f (x) â‰¡
âˆ‚|Î±|f (x)
âˆ‚xk1
1 âˆ‚xk2
2 Â· Â· Â· âˆ‚xkn
n
.
Also deï¬ne Ï†k to be a molliï¬er if spt (Ï†k) âŠ†B
Â¡
0, 1
k
Â¢
, Ï†k â‰¥0,
R
Ï†kdx = 1, and
Ï†k âˆˆCâˆž
c
Â¡
B
Â¡
0, 1
k
Â¢Â¢
. In the case a Greek letter like Î´ or Îµ is used as a subscript,
it will mean spt (Ï†Î´) âŠ†B (0, Î´) , Ï†Î´ â‰¥0,
R
Ï†Î´dx = 1, and Ï†Î´ âˆˆCâˆž
c (B (0, Î´)) . You
can always get a molliï¬er by letting Ï† â‰¥0, Ï† âˆˆCâˆž
c (B (0, 1)) ,
R
Ï†dx = 1,and then
deï¬ning Ï†k (x) â‰¡knÏ† (kx) or in the case of a Greek subscript, Ï†Î´ (x) =
1
Î´n Ï†
Â¡ x
Î´
Â¢
.
Consider the case where u and DÎ±u for |Î±| = 1 are each in Lp
loc (Rn). The next
lemma is the one alluded to in the proof of Theorem 37.5.
Lemma 37.9 Suppose f âˆˆL1
loc (U) and suppose
Z
fÏ†dx = 0
for all Ï† âˆˆCâˆž
c (U). Then f (x) = 0 a.e.
x.

37.3.
WEAK DERIVATIVES IN LP
LOC
1085
Proof: Without loss of generality f is real valued. Let
E â‰¡{x : f (x) > Îµ}
and let
Em â‰¡E âˆ©B(0, m).
Is m (Em) = 0? If not, there exists an open set, V , and a compact set K satisfying
K âŠ†Em âŠ†V âŠ†B (0, m) , m (V \ K) < 4âˆ’1m (Em) ,
Z
V \K
|f| dx < Îµ4âˆ’1m (Em) .
Let H and W be open sets satisfying
K âŠ†H âŠ†H âŠ†W âŠ†W âŠ†V
and let
H â‰ºg â‰ºW
where the symbol, â‰º, in the above implies spt (g) âŠ†W, g has all values in [0, 1] ,
and g (x) = 1 on H. Then let Ï†Î´ be a molliï¬er and let h â‰¡gâˆ—Ï†Î´ for Î´ small enough
that
K â‰ºh â‰ºV.
Thus
0
=
Z
fhdx =
Z
K
fdx +
Z
V \K
fhdx
â‰¥
Îµm (K) âˆ’Îµ4âˆ’1m (Em)
â‰¥
Îµ
Â¡
m (Em) âˆ’4âˆ’1m (Em)
Â¢
âˆ’Îµ4âˆ’1m (Em)
â‰¥
2âˆ’1Îµm(Em).
Therefore, m (Em) = 0, a contradiction. Thus
m (E) â‰¤
âˆž
X
m=1
m (Em) = 0
and so, since Îµ > 0 is arbitrary,
m ({x : f (x) > 0}) = 0.
Similarly m ({x : f (x) < 0}) = 0. This proves the lemma.
This lemma allows the following deï¬nition.
Deï¬nition 37.10 Let U be an open subset of Rn and let u âˆˆL1
loc (U) . Then DÎ±u âˆˆ
L1
loc (U) if there exists a function g âˆˆL1
loc (U), necessarily unique by Lemma 37.9,
such that for all Ï† âˆˆCâˆž
c (U),
Z
U
gÏ†dx = DÎ±u (Ï†) â‰¡
Z
U
(âˆ’1)|Î±| u (DÎ±Ï†) dx.
Then DÎ±u is deï¬ned to equal g when this occurs.

1086
WEAK DERIVATIVES
Lemma 37.11 Let u âˆˆL1
loc (Rn) and suppose u,i âˆˆL1
loc (Rn), where the subscript
on the u following the comma denotes the ith weak partial derivative. Then if Ï†Îµ is
a molliï¬er and uÎµ â‰¡u âˆ—Ï†Îµ, it follows uÎµ,i â‰¡u,i âˆ—Ï†Îµ.
Proof: If Ïˆ âˆˆCâˆž
c (Rn), then
Z
u (x âˆ’y) Ïˆ,i (x) dx
=
Z
u (z) Ïˆ,i (z + y) dz
=
âˆ’
Z
u,i (z) Ïˆ (z + y) dz
=
âˆ’
Z
u,i (x âˆ’y) Ïˆ (x) dx.
Therefore,
uÎµ,i (Ïˆ)
=
âˆ’
Z
uÎµÏˆ,i = âˆ’
Z Z
u (x âˆ’y) Ï†Îµ (y) Ïˆ,i (x) d ydx
=
âˆ’
Z Z
u (x âˆ’y) Ïˆ,i (x) Ï†Îµ (y) dxdy
=
Z Z
u,i (x âˆ’y) Ïˆ (x) Ï†Îµ (y) dxdy
=
Z
u,i âˆ—Ï†Îµ (x) Ïˆ (x) dx.
The technical questions about product measurability in the use of Fubiniâ€™s theorem
may be resolved by picking a Borel measurable representative for u. This proves
the lemma.
What about the product rule? Does it have some form in the context of weak
derivatives?
Lemma 37.12 Let U be an open set, Ïˆ âˆˆCâˆž(U) and suppose u, u,i âˆˆLp
loc (U).
Then (uÏˆ),i and uÏˆ are in Lp
loc (U) and
(uÏˆ),i = u,iÏˆ + uÏˆ,i.
Proof: Let Ï† âˆˆCâˆž
c (U) then
(uÏˆ),i (Ï†)
â‰¡
âˆ’
Z
U
uÏˆÏ†,idx
=
âˆ’
Z
U
u[(ÏˆÏ†),i âˆ’Ï†Ïˆ,i]dx
=
Z
U
Â¡
u,iÏˆÏ† + uÏˆ,iÏ†
Â¢
dx
=
Z
U
Â¡
u,iÏˆ + uÏˆ,i
Â¢
Ï†dx
This proves the lemma.

37.4.
MORREYâ€™S INEQUALITY
1087
Recall the notation for the gradient of a function.
âˆ‡u (x) â‰¡(u,1 (x) Â· Â· Â· u,n (x))T
thus
Du (x) v =âˆ‡u (x) Â· v.
37.4
Morreyâ€™s Inequality
The following inequality will be called Morreyâ€™s inequality. It relates an expression
which is given pointwise to an integral of the pth power of the derivative.
Lemma 37.13 Let u âˆˆC1 (Rn) and p > n.
Then there exists a constant, C,
depending only on n such that for any x, y âˆˆRn,
|u (x) âˆ’u (y)|
â‰¤C
ÃƒZ
B(x,2|xâˆ’y|)
|âˆ‡u (z) |pdz
!1/p Â³
| x âˆ’y|(1âˆ’n/p)Â´
.
(37.1)
Proof:
In the argument C will be a generic constant which depends on n.
Consider the following picture.
x
U
r W
r
V
y
This is a picture of two balls of radius r in Rn, U and V having centers at x and
y respectively, which intersect in the set, W. The center of U is on the boundary
of V and the center of V is on the boundary of U as shown in the picture. There
exists a constant, C, independent of r depending only on n such that
m (W)
m (U) = m (W)
m (V ) = C.
You could compute this constant if you desired but it is not important here.
Deï¬ne the average of a function over a set, E âŠ†Rn as follows.
Z
âˆ’
E
fdx â‰¡
1
m (E)
Z
E
fdx.

1088
WEAK DERIVATIVES
Then
|u (x) âˆ’u (y)|
=
Z
âˆ’
W
|u (x) âˆ’u (y)| dz
â‰¤
Z
âˆ’
W
|u (x) âˆ’u (z)| dz +
Z
âˆ’
W
|u (z) âˆ’u (y)| dz
=
C
m (U)
Â·Z
W
|u (x) âˆ’u (z)| dz +
Z
W
|u (z) âˆ’u (y)| dz
Â¸
â‰¤
C
Â·Z
âˆ’
U
|u (x) âˆ’u (z)| dz +
Z
âˆ’
V
|u (y) âˆ’u (z)| dz
Â¸
Now consider these two terms. Using spherical coordinates and letting U0 denote
the ball of the same radius as U but with center at 0,
Z
âˆ’
U
|u (x) âˆ’u (z)| dz
=
1
m (U0)
Z
U0
|u (x) âˆ’u (z + x)| dz
=
1
m (U0)
Z r
0
Ïnâˆ’1
Z
Snâˆ’1 |u (x) âˆ’u (Ïw + x)| dÏƒ (w) dÏ
â‰¤
1
m (U0)
Z r
0
Ïnâˆ’1
Z
Snâˆ’1
Z Ï
0
|âˆ‡u (x + tw) Â· w| dtdÏƒdÏ
â‰¤
1
m (U0)
Z r
0
Ïnâˆ’1
Z
Snâˆ’1
Z Ï
0
|âˆ‡u (x + tw)| dtdÏƒdÏ
â‰¤
C 1
r
Z r
0
Z
Snâˆ’1
Z r
0
|âˆ‡u (x + tw)| dtdÏƒdÏ
=
C 1
r
Z r
0
Z
Snâˆ’1
Z r
0
|âˆ‡u (x + tw)|
tnâˆ’1
tnâˆ’1dtdÏƒdÏ
=
C
Z
Snâˆ’1
Z r
0
|âˆ‡u (x + tw)|
tnâˆ’1
tnâˆ’1dtdÏƒ
=
C
Z
U0
|âˆ‡u (x + z)|
|z|nâˆ’1
dz
â‰¤
C
ÂµZ
U0
|âˆ‡u (x + z)|p dz
Â¶1/p ÂµZ
U
|z|pâ€²âˆ’npâ€²Â¶1/pâ€²
=
C
ÂµZ
U
|âˆ‡u (z)|p dz
Â¶1/p ÂµZ
Snâˆ’1
Z r
0
Ïpâ€²âˆ’npâ€²Ïnâˆ’1dÏdÏƒ
Â¶(pâˆ’1)/p
=
C
ÂµZ
U
|âˆ‡u (z)|p dz
Â¶1/p ÃƒZ
Snâˆ’1
Z r
0
1
Ï
nâˆ’1
pâˆ’1 dÏdÏƒ
!(pâˆ’1)/p

37.4.
MORREYâ€™S INEQUALITY
1089
=
C
Âµ p âˆ’1
p âˆ’n
Â¶(pâˆ’1)/p ÂµZ
U
|âˆ‡u (z)|p dz
Â¶1/p
r1âˆ’n
p
=
C
Âµ p âˆ’1
p âˆ’n
Â¶(pâˆ’1)/p ÂµZ
U
|âˆ‡u (z)|p dz
Â¶1/p
|x âˆ’y|1âˆ’n
p
Similarly,
Z
âˆ’
V
|u (y) âˆ’u (z)| dz â‰¤C
Âµ p âˆ’1
p âˆ’n
Â¶(pâˆ’1)/p ÂµZ
V
|âˆ‡u (z)|p dz
Â¶1/p
|x âˆ’y|1âˆ’n
p
Therefore,
|u (x) âˆ’u (y)| â‰¤C
Âµ p âˆ’1
p âˆ’n
Â¶(pâˆ’1)/p ÃƒZ
B(x,2|xâˆ’y|)
|âˆ‡u (z)|p dz
!1/p
|x âˆ’y|1âˆ’n
p
because B (x, 2 |x âˆ’y|) âŠ‡V âˆªU. This proves the lemma.
The following corollary is also interesting
Corollary 37.14 Suppose u âˆˆC1 (Rn) . Then
|u (y) âˆ’u (x) âˆ’âˆ‡u (x) Â· (y âˆ’x)|
â‰¤C
Ãƒ
1
m (B (x, 2 |x âˆ’y|))
Z
B(x,2|xâˆ’y|)
|âˆ‡u (z) âˆ’âˆ‡u (x) |pdz
!1/p
| x âˆ’y|. (37.2)
Proof: This follows easily from letting g (y) â‰¡u (y) âˆ’u (x) âˆ’âˆ‡u (x) Â· (y âˆ’x) .
Then g âˆˆC1 (Rn), g (x) = 0, and âˆ‡g (z) = âˆ‡u (z) âˆ’âˆ‡u (x) . From Lemma 37.13,
|u (y) âˆ’u (x) âˆ’âˆ‡u (x) Â· (y âˆ’x)|
=
|g (y)| = |g (y) âˆ’g (x)|
â‰¤
C
ÃƒZ
B(x,2|xâˆ’y|)
|âˆ‡u (z) âˆ’âˆ‡u (x) |pdz
!1/p
|x âˆ’y|1âˆ’n
p
=
C
Ãƒ
1
m (B (x, 2 |x âˆ’y|))
Z
B(x,2|xâˆ’y|)
|âˆ‡u (z) âˆ’âˆ‡u (x) |pdz
!1/p
| x âˆ’y|.
This proves the corollary.
It may be interesting at this point to recall the deï¬nition of diï¬€erentiability
on Page 115. If you knew the above inequality held for âˆ‡u having components in
L1
loc (Rn) , then at Lebesgue points of âˆ‡u, the above would imply Du (x) exists.
This is exactly the approach taken below.

1090
WEAK DERIVATIVES
37.5
Rademacherâ€™s Theorem
The inequality of Corollary 37.14 can be extended to the case where u and u,i are
in Lp
loc (Rn) for p > n. This leads to an elegant proof of the diï¬€erentiability a.e. of
a Lipschitz continuous function as well as a more general theorem.
Theorem 37.15 Suppose u and all its weak partial derivatives, u,i are in Lp
loc (Rn).
Then there exists a set of measure zero, E such that if x, y /âˆˆE then inequalities
37.2 and 37.1 are both valid. Furthermore, u equals a continuous function a.e.
Proof: Let u âˆˆLp
loc (Rn) and Ïˆk âˆˆCâˆž
c (Rn) , Ïˆk â‰¥0, and Ïˆk (z) = 1 for all
z âˆˆB (0, k). Then it is routine to verify that
uÏˆk, (uÏˆk),i âˆˆLp(Rn).
Here is why:
(uÏˆk),i (Ï†)
â‰¡
âˆ’
Z
Rn uÏˆkÏ†,idx
=
âˆ’
Z
Rn uÏˆkÏ†,idx âˆ’
Z
Rn uÏˆk,iÏ†dx +
Z
Rn uÏˆk,iÏ†dx
=
âˆ’
Z
Rn u (ÏˆkÏ†),i dx +
Z
Rn uÏˆk,iÏ†dx
=
Z
Rn
Â¡
u,iÏˆk + uÏˆk,i
Â¢
Ï†dx
which shows
(uÏˆk),i = u,iÏˆk + uÏˆk,i
as expected.
Let Ï†Îµ be a molliï¬er and consider
(uÏˆk)Îµ â‰¡uÏˆk âˆ—Ï†Îµ.
By Lemma 37.11 on Page 1086,
(uÏˆk)Îµ,i = (uÏˆk),i âˆ—Ï†Îµ.
Therefore
(uÏˆk)Îµ,i â†’(uÏˆk),i in Lp (Rn)
(37.3)
and
(uÏˆk)Îµ â†’uÏˆk in Lp (Rn)
(37.4)
as Îµ â†’0. By 37.4, there exists a subsequence Îµ â†’0 such that for |z| < k and for
each i = 1, 2, Â· Â· Â·, n
(uÏˆk)Îµ,i (z) â†’(uÏˆk),i (z) = u,i (z) a.e.

37.5.
RADEMACHERâ€™S THEOREM
1091
(uÏˆk)Îµ (z) â†’uÏˆk (z) = u (z) a.e.
(37.5)
Denoting the exceptional set by Ek, let
x, y /âˆˆâˆªâˆž
k=1Ek â‰¡E
and let k be so large that
B (0,k) âŠ‡B (x,2|x âˆ’y|).
Then by 37.1 and for x, y /âˆˆE,
|(uÏˆk)Îµ (x) âˆ’(uÏˆk)Îµ (y)|
â‰¤C
ÃƒZ
B(x,2|yâˆ’x|)
|âˆ‡(uÏˆk)Îµ|pdz
!1/p
|x âˆ’y|(1âˆ’n/p)
where C depends only on n. Similarly, by 37.2,
|(uÏˆk)Îµ (x) âˆ’(uÏˆk)Îµ (y) âˆ’âˆ‡(uÏˆk)Îµ (x) Â· (y âˆ’x)| â‰¤
C
Ãƒ
1
m (B (x, 2 |x âˆ’y|))
Z
B(x,2|xâˆ’y|)
|âˆ‡(uÏˆk)Îµ (z) âˆ’âˆ‡(uÏˆk)Îµ (x) |pdz
!1/p
| x âˆ’y|.
Now by 37.5 and 37.3 passing to the limit as Îµ â†’0 yields
|u (x) âˆ’u (y)| â‰¤C
ÃƒZ
B(x,2|yâˆ’x|)
|âˆ‡u|pdz
!1/p
|x âˆ’y|(1âˆ’n/p)
(37.6)
and
|u (y) âˆ’u (x) âˆ’âˆ‡u (x) Â· (y âˆ’x)|
â‰¤C
Ãƒ
1
m (B (x, 2 |x âˆ’y|))
Z
B(x,2|xâˆ’y|)
|âˆ‡u (z) âˆ’âˆ‡u (x) |pdz
!1/p
| x âˆ’y|. (37.7)
Redeï¬ning u on the set of mesure zero, E yields 37.6 for all x, y. This proves the
theorem.
Corollary 37.16 Let u, u,i âˆˆLp
loc (Rn) for i = 1, Â· Â· Â·, n and p > n.
Then the
representative of u described in Theorem 37.15 is diï¬€erentiable a.e.
Proof: From Theorem 37.15
|u (y) âˆ’u (x) âˆ’âˆ‡u (x) Â· (y âˆ’x)|
â‰¤C
Ãƒ
1
m (B (x, 2 |x âˆ’y|))
Z
B(x,2|xâˆ’y|)
|âˆ‡u (z) âˆ’âˆ‡u (x) |pdz
!1/p
| x âˆ’y|. (37.8)

1092
WEAK DERIVATIVES
and at every Lebesgue point, x of âˆ‡u
lim
yâ†’x
Ãƒ
1
m (B (x, 2 |x âˆ’y|))
Z
B(x,2|xâˆ’y|)
|âˆ‡u (z) âˆ’âˆ‡u (x) |pdz
!1/p
= 0
and so at each of these points,
lim
yâ†’x
|u (y) âˆ’u (x) âˆ’âˆ‡u (x) Â· (y âˆ’x)|
|x âˆ’y|
= 0
which says that u is diï¬€erentiable at x and Du (x) (v) = âˆ‡u (x)Â·(v) . See Page 115.
This proves the corollary.
Deï¬nition 37.17 Now suppose u is Lipschitz on Rn,
|u (x) âˆ’u (y)| â‰¤K |x âˆ’y|
for some constant K. Deï¬ne Lip (u) as the smallest value of K that works in this
inequality.
The following corollary is known as Rademacherâ€™s theorem. It states that every
Lipschitz function is diï¬€erentiable a.e.
Corollary 37.18 If u is Lipschitz continuous then u is diï¬€erentiable a.e.
and
||u,i||âˆžâ‰¤Lip (u).
Proof: This is done by showing that Lipschitz continuous functions have weak
derivatives in Lâˆž(Rn) and then using the previous results. Let
Dh
eiu (x) â‰¡hâˆ’1 [u (x + hei) âˆ’u (x)].
Then Dh
eiu is bounded in Lâˆž(Rn) and
||Dh
eiu||âˆžâ‰¤Lip (u).
It follows that Dh
eiu is contained in a ball in Lâˆž(Rn), the dual space of L1 (Rn).
By Theorem 37.3 on Page 1080, there is a subsequence h â†’0 such that
Dh
eiu â‡€w, ||w||âˆžâ‰¤Lip (u)
where the convergence takes place in the weak âˆ—topology of Lâˆž(Rn). Let Ï† âˆˆ
Câˆž
c (Rn). Then
Z
wÏ†dx = lim
hâ†’0
Z
Dh
eiuÏ†dx
= lim
hâ†’0
Z
u (x) (Ï† (x âˆ’hei) âˆ’Ï† (x))
h
dx
= âˆ’
Z
u (x) Ï†,i (x) dx.
Thus w = u,i and u,i âˆˆLâˆž(Rn) for each i. Hence u, u,i âˆˆLp
loc (Rn) for all p > n
and so u is diï¬€erentiable a.e. by Corollary 37.16. This proves the corollary.

37.6.
CHANGE OF VARIABLES FORMULA LIPSCHITZ MAPS
1093
37.6
Change Of Variables Formula Lipschitz Maps
With Rademacherâ€™s theorem, one can give a general change of variables formula
involving Lipschitz maps.
Deï¬nition 37.19 Let E be a Lebesgue measurable set.x âˆˆE is a point of density
if
lim
râ†’0
m(E âˆ©B(x, r))
m(B(x, r))
= 1.
You see that if x were an interior point of E, then this limit will equal 1.
However, it is sometimes the case that the limit equals 1 even when x is not an
interior point. In fact, these points of density make sense even for sets that have
empty interior.
Lemma 37.20 Let E be a Lebesgue measurable set.
Then there exists a set of
measure zero, N, such that if x âˆˆE \ N, then x is a point of density of E.
Proof: Consider the function, f (x) = XE (x).
This function is in L1
loc (Rn).
Let N C denote the Lebesgue points of f. Then for x âˆˆE \ N,
1
=
XE (x) = lim
râ†’0
1
mn (B (x, r))
Z
B(x,r)
XE (y) dmn
=
lim
râ†’0
mn (B (x, r) âˆ©E)
mn (B (x, r))
.
In this section, â„¦will be a Lebesgue measurable set in Rn and h : â„¦â†’Rn will
be Lipschitz. Recall the following deï¬nition and theorems. See Page 10.17 for the
proofs and more discussion.
Deï¬nition 37.21 Let F
be a collection of balls that cover a set, E, which have
the property that if x âˆˆE and Îµ > 0, then there exists B âˆˆF, diameter of B < Îµ
and x âˆˆB. Such a collection covers E in the sense of Vitali.
Theorem 37.22 Let E âŠ†Rn and suppose mn(E) < âˆžwhere mn is the outer
measure determined by mn, n dimensional Lebesgue measure, and let F, be a col-
lection of closed balls of bounded radii such that F covers E in the sense of Vitali.
Then there exists a countable collection of disjoint balls from F, {Bj}âˆž
j=1, such that
mn(E \ âˆªâˆž
j=1Bj) = 0.
Now this theorem implies a simple lemma which is what will be used.
Lemma 37.23 Let V be an open set in Rr, mr (V ) < âˆž.
Then there exists a
sequence of disjoint open balls {Bi} having radii less than Î´ and a set of measure
0, T, such that
V = (âˆªâˆž
i=1Bi) âˆªT.

1094
WEAK DERIVATIVES
As in the proof of the change of variables theorem given earlier, the ï¬rst step
is to show that h maps Lebesgue measurable sets to Lebesgue measurable sets. In
showing this the key result is the next lemma which states that h maps sets of
measure zero to sets of measure zero.
Lemma 37.24 If mn (T) = 0 then mn (h (T)) = 0.
Proof: Let V be an open set containing T whose measure is less than Îµ. Now
using the Vitali covering theorem, there exists a sequence of disjoint balls {Bi},
Bi = B (xi, ri) which are contained in V such that the sequence of enlarged balls,
n
bBi
o
, having the same center but 5 times the radius, covers T. Then
mn (h (T)) â‰¤mn
Â³
h
Â³
âˆªâˆž
i=1 bBi
Â´Â´
â‰¤
âˆž
X
i=1
mn
Â³
h
Â³
bBi
Â´Â´
â‰¤
âˆž
X
i=1
Î± (n) (Lip (h))n 5nrn
i = 5n (Lip (h))n
âˆž
X
i=1
mn (Bi)
â‰¤
(Lip (h))n 5nmn (V ) â‰¤Îµ (Lip (h))n 5n.
Since Îµ is arbitrary, this proves the lemma.
With the conclusion of this lemma, the next lemma is fairly easy to obtain.
Lemma 37.25 If A is Lebesgue measurable, then h (A) is mn measurable. Fur-
thermore,
mn (h (A)) â‰¤(Lip (h))n mn (A).
(37.9)
Proof: Let Ak = A âˆ©B (0, k) , k âˆˆN. Let V âŠ‡Ak and let mn (V ) < âˆž. By
Lemma 37.23, there is a sequence of disjoint balls {Bi} and a set of measure 0, T,
such that
V = âˆªâˆž
i=1Bi âˆªT, Bi = B(xi, ri).
By Lemma 37.24,
mn (h (Ak)) â‰¤mn (h (V ))
â‰¤mn (h (âˆªâˆž
i=1Bi)) + mn (h (T)) = mn (h (âˆªâˆž
i=1Bi))
â‰¤
âˆž
X
i=1
mn (h (Bi)) â‰¤
âˆž
X
i=1
mn (B (h (xi) , Lip (h) ri))
â‰¤
âˆž
X
i=1
Î± (n) (Lip (h) ri)n = Lip (h)n
âˆž
X
i=1
mn (Bi) = Lip (h)n mn (V ).
Therefore,
mn (h (Ak)) â‰¤Lip (h)n mn (V ).

37.6.
CHANGE OF VARIABLES FORMULA LIPSCHITZ MAPS
1095
Since V is an arbitrary open set containing Ak, it follows from regularity of Lebesgue
measure that
mn (h (Ak)) â‰¤Lip (h)n mn (Ak).
(37.10)
Now let k â†’âˆžto obtain 37.9. This proves the formula. It remains to show h (A)
is measurable.
By inner regularity of Lebesgue measure, there exists a set, F, which is the
countable union of compact sets and a set T with mn (T) = 0 such that
F âˆªT = Ak.
Then h (F) âŠ†h (Ak) âŠ†h (F) âˆªh (T). By continuity of h, h (F) is a countable
union of compact sets and so it is Borel. By 37.10 with T in place of Ak,
mn (h (T)) = 0
and so h (T) is mn measurable. Therefore, h (Ak) is mn measurable because mn
is a complete measure and this exhibits h (Ak) between two mn measurable sets
whose diï¬€erence has measure 0. Now
h (A) = âˆªâˆž
k=1h (Ak)
so h (A) is also mn measurable and this proves the lemma.
The following lemma, depending on the Brouwer ï¬xed point theorem and found
in Rudin [45], will be important for the following arguments. A slightly more precise
version was presented earlier on Page 462 but this version given below will suï¬ƒce
in this context. The idea is that if a continuous function mapping a ball in Rk to
Rk doesnâ€™t move any point very much, then the image of the ball must contain a
slightly smaller ball.
Lemma 37.26 Let B = B (0, r), a ball in Rk and let F : B â†’Rk be continuous
and suppose for some Îµ < 1,
|F (v) âˆ’v| < Îµr
for all v âˆˆB. Then
F
Â¡
B
Â¢
âŠ‡B (0, r (1 âˆ’Îµ)).
Proof: Suppose a âˆˆB (0, r (1 âˆ’Îµ)) \ F
Â¡
B
Â¢
and let
G (v) â‰¡r (a âˆ’F (v))
|a âˆ’F (v)| .

1096
WEAK DERIVATIVES
Then by the Brouwer ï¬xed point theorem, G (v) = v for some v âˆˆB. Using the
formula for G, it follows |v| = r. Taking the inner product with v,
(G (v) , v)
=
|v|2 = r2 =
r
|a âˆ’F (v)| (a âˆ’F (v) , v)
=
r
|a âˆ’F (v)| (a âˆ’v + v âˆ’F (v) , v)
=
r
|a âˆ’F (v)| [(a âˆ’v, v) + (v âˆ’F (v) , v)]
=
r
|a âˆ’F (v)|
h
(a, v) âˆ’|v|2 + (v âˆ’F (v) , v)
i
â‰¤
r
|a âˆ’F (v)|
Â£
r2 (1 âˆ’Îµ) âˆ’r2+r2Îµ
Â¤
= 0,
a contradiction. Therefore, B (0, r (1 âˆ’Îµ)) \ F
Â¡
B
Â¢
= âˆ…and this proves the lemma.
Now let â„¦be a Lebesgue measurable set and suppose h : Rn â†’Rn is Lipschitz
continuous and one to one on â„¦. Let
N â‰¡{x âˆˆâ„¦: Dh (x) does not exist}
(37.11)
S â‰¡
n
x âˆˆâ„¦\ N : Dh (x)âˆ’1 does not exist
o
(37.12)
Lemma 37.27 Let x âˆˆâ„¦\ (S âˆªN). Then if Îµ âˆˆ(0, 1) the following hold for all r
small enough.
mn
Â³
h
Â³
B (x,r)
Â´Â´
â‰¥mn (Dh (x) B (0, r (1 âˆ’Îµ))),
(37.13)
h (B (x, r)) âŠ†h (x) + Dh (x) B (0, r (1 + Îµ)),
(37.14)
mn
Â³
h
Â³
B (x,r)
Â´Â´
â‰¤mn (Dh (x) B (0, r (1 + Îµ)))
(37.15)
If x âˆˆâ„¦\ (S âˆªN) is also a point of density of â„¦, then
lim
râ†’0
mn (h (B (x, r) âˆ©â„¦))
mn (h (B (x, r)))
= 1.
(37.16)
If x âˆˆâ„¦\ N, then
|det Dh (x)| = lim
râ†’0
mn (h (B (x, r)))
mn (B (x,r))
a.e.
(37.17)
Proof: Since Dh (x)âˆ’1 exists,
h (x + v)
=
h (x) + Dh (x) v+o (|v|)
(37.18)
=
h (x) + Dh (x)
ï£«
ï£¬
ï£¬
ï£­v+
=o(|v|)
z
}|
{
Dh (x)âˆ’1 o (|v|)
ï£¶
ï£·
ï£·
ï£¸
(37.19)

37.6.
CHANGE OF VARIABLES FORMULA LIPSCHITZ MAPS
1097
Consequently, when r is small enough, 37.14 holds. Therefore, 37.15 holds. From
37.19, and the assumption that Dh (x)âˆ’1 exists,
Dh (x)âˆ’1 h (x + v) âˆ’Dh (x)âˆ’1 h (x) âˆ’v =o(|v|).
(37.20)
Letting
F (v) = Dh (x)âˆ’1 h (x + v) âˆ’Dh (x)âˆ’1 h (x),
apply Lemma 37.26 in 37.20 to conclude that for r small enough, whenever |v| < r,
Dh (x)âˆ’1 h (x + v) âˆ’Dh (x)âˆ’1 h (x) âŠ‡B (0, (1 âˆ’Îµ) r).
Therefore,
h
Â³
B (x,r)
Â´
âŠ‡h (x) + Dh (x) B (0, (1 âˆ’Îµ) r)
which implies
mn
Â³
h
Â³
B (x,r)
Â´Â´
â‰¥mn (Dh (x) B (0, r (1 âˆ’Îµ)))
which shows 37.13.
Now suppose that x is a point of density of â„¦as well as being a point where
Dh (x)âˆ’1 and Dh (x) exist. Then whenever r is small enough,
1 âˆ’Îµ < mn (h (B (x, r) âˆ©â„¦))
mn (h (B (x, r)))
â‰¤1
and so
1 âˆ’Îµ
<
mn
Â¡
h
Â¡
B (x, r) âˆ©â„¦CÂ¢Â¢
mn (h (B (x, r)))
+ mn (h (B (x, r) âˆ©â„¦))
mn (h (B (x, r)))
â‰¤
mn
Â¡
h
Â¡
B (x, r) âˆ©â„¦CÂ¢Â¢
mn (h (B (x, r)))
+ 1.
which implies
mn (B (x,r) \ â„¦) < ÎµÎ± (n) rn.
(37.21)
Then for such r,
1 â‰¥mn (h (B (x, r) âˆ©â„¦))
mn (h (B (x, r)))
â‰¥mn (h (B (x, r))) âˆ’mn (h (B (x,r) \ â„¦))
mn (h (B (x, r)))
.
From Lemma 37.25, 37.21, and 37.13, this is no larger than
1 âˆ’
Lip (h)n ÎµÎ± (n) rn
mn (Dh (x) B (0, r (1 âˆ’Îµ))).

1098
WEAK DERIVATIVES
By the theorem on the change of variables for a linear map, this expression equals
1 âˆ’
Lip (h)n ÎµÎ± (n) rn
|det (Dh (x))| rnÎ± (n) (1 âˆ’Îµ)n â‰¡1 âˆ’g (Îµ)
where limÎµâ†’0g (Îµ) = 0. Then for all r small enough,
1 â‰¥mn (h (B (x, r) âˆ©â„¦))
mn (h (B (x, r)))
â‰¥1 âˆ’g (Îµ)
which shows 37.16 since Îµ is arbitrary. It remains to verify 37.17.
In case x âˆˆS, for small |v| ,
h (x + v) = h (x) + Dh (x) v+o (|v|)
where |o (|v|)| < Îµ |v| . Therefore, for small enough r,
h (B (x, r)) âˆ’h (x) âŠ†K + B (0, rÎµ)
where K is a compact subset of an nâˆ’1 dimensional subspace contained in Dh (x) (Rn)
which has diameter no more than 2 ||Dh (x)|| r. By Lemma 10.33 on Page 285,
mn (h (B (x, r)))
=
mn (h (B (x, r)) âˆ’h (x))
â‰¤
2nÎµr (2 ||Dh (x)|| r + rÎµ)nâˆ’1
and so, in this case, letting r be small enough,
mn (h (B (x, r)))
mn (B (x,r))
â‰¤2nÎµr (2 ||Dh (x)|| r + rÎµ)nâˆ’1
Î± (n) rn
â‰¤CÎµ.
Since Îµ is arbitrary, the limit as r â†’0 of this quotient equals 0.
If x /âˆˆS, use 37.13 - 37.15 along with the change of variables formula for linear
maps. This proves the Lemma.
Since h is one to one, there exists a measure, Âµ, deï¬ned by
Âµ (E) â‰¡mn (h (E))
on the Lebesgue measurable subsets of â„¦. By Lemma 37.25 Âµ â‰ªmn and so by the
Radon Nikodym theorem, there exists a nonnegative function, J (x) in L1
loc (Rn)
such that whenever E is Lebesgue measurable,
Âµ (E) = mn (h (E âˆ©â„¦)) =
Z
Eâˆ©â„¦
J (x) dmn.
(37.22)
Extend J to equal zero oï¬€â„¦.
Lemma 37.28 The function, J (x) equals |det Dh (x)| a.e.

37.6.
CHANGE OF VARIABLES FORMULA LIPSCHITZ MAPS
1099
Proof: Deï¬ne
Q â‰¡{x âˆˆâ„¦: x is not a point of density of â„¦} âˆªNâˆª
{x âˆˆâ„¦: x is not a Lebesgue point of J}.
Then Q is a set of measure zero and if x /âˆˆQ, then by 37.17, and 37.16,
|det Dh (x)|
=
lim
râ†’0
mn (h (B (x, r)))
mn (B (x, r))
=
lim
râ†’0
mn (h (B (x, r)))
mn (h (B (x, r) âˆ©â„¦))
mn (h (B (x, r) âˆ©â„¦))
mn (B (x, r))
=
lim
râ†’0
1
mn (B (x, r))
Z
B(x,r)âˆ©â„¦
J (y) dmn
=
lim
râ†’0
1
mn (B (x, r))
Z
B(x,r)
J (y) dmn = J (x) .
the last equality because J was extended to be zero oï¬€â„¦. This proves the lemma.
Here is the change of variables formula for Lipschitz mappings. It is a special
case of the area formula.
Theorem 37.29 Let â„¦be a Lebesgue measurable set, let f â‰¥0 be Lebesgue mea-
surable. Then for h a Lipschitz mapping deï¬ned on Rn which is one to one on
â„¦,
Z
h(â„¦)
f (y) dmn =
Z
â„¦
f (h (x)) |det Dh (x)| dmn.
(37.23)
Proof: Let F be a Borel set. It follows that hâˆ’1 (F) is a Lebesgue measurable
set. Therefore, by 37.22,
mn
Â¡
h
Â¡
hâˆ’1 (F) âˆ©â„¦
Â¢Â¢
(37.24)
=
Z
h(â„¦)
XF (y) dmn =
Z
â„¦
Xhâˆ’1(F ) (x) J (x) dmn
=
Z
â„¦
XF (h (x)) J (x) dmn.
What if F is only Lebesgue measurable? Note there are no measurability problems
with the above expression because x â†’XF (h (x)) is Borel measurable due to the
assumption that h is continuous while J is given to be Lebesgue measurable. How-
ever, if F is Lebesgue measurable, not necessarily Borel measurable, then it is no
longer clear that x â†’XF (h (x)) is measurable. In fact this is not always even true.
However, x â†’XF (h (x)) J (x) is measurable and 37.24 holds.
Let F be Lebesgue measurable. Then by inner regularity, F = H âˆªN where N
has measure zero, H is the countable union of compact sets so it is a Borel set, and

1100
WEAK DERIVATIVES
H âˆ©N = âˆ…. Therefore, letting N â€² denote a Borel set of measure zero which contains
N,
b (x) â‰¡XH (h (x)) J (x) â‰¤XF (h (x)) J (x)
=
XH (h (x)) J (x) + XN (h (x)) J (x)
â‰¤
XH (h (x)) J (x) + XNâ€² (h (x)) J (x) â‰¡u (x)
Now since N â€² is Borel,
Z
â„¦
(u (x) âˆ’b (x)) dmn =
Z
â„¦
XN â€² (h (x)) J (x) dmn
= mn
Â¡
h
Â¡
hâˆ’1 (N â€²) âˆ©â„¦
Â¢Â¢
= mn (N â€² âˆ©h (â„¦)) = 0
and this shows XH (h (x)) J (x) = XF (h (x)) J (x) except on a set of measure zero.
By completeness of Lebesgue measure, it follows x â†’XF (h (x)) J (x) is Lebesgue
measurable and also since h maps sets of measure zero to sets of measure zero,
Z
â„¦
XF (h (x)) J (x) dmn
=
Z
â„¦
XH (h (x)) J (x) dmn
=
Z
h(â„¦)
XH (y) dmn
=
Z
h(â„¦)
XF (y) dmn.
It follows that if s is any nonnegative Lebesgue measurable simple function,
Z
â„¦
s (h (x)) J (x) dmn =
Z
h(â„¦)
s (y) dmn
(37.25)
and now, if f â‰¥0 is Lebesgue measurable, let sk be an increasing sequence of
Lebesgue measurable simple functions converging pointwise to f. Then since 37.25
holds for sk, the monotone convergence theorem applies and yields 37.23.
This
proves the theorem.
It turns out that a Lipschitz function deï¬ned on some subset of Rn always has a
Lipschitz extension to all of Rn. The next theorem gives a proof of this. For more
on this sort of theorem see Federer [22]. He gives a better but harder theorem than
what follows.
Theorem 37.30 If h : â„¦â†’Rm is Lipschitz, then there exists h : Rn â†’Rm which
extends h and is also Lipschitz.
Proof: It suï¬ƒces to assume m = 1 because if this is shown, it may be applied
to the components of h to get the desired result. Suppose
|h (x) âˆ’h (y)| â‰¤K |x âˆ’y|.
(37.26)

37.6.
CHANGE OF VARIABLES FORMULA LIPSCHITZ MAPS
1101
Deï¬ne
h (x) â‰¡inf{h (w) + K |x âˆ’w| : w âˆˆâ„¦}.
(37.27)
If x âˆˆâ„¦, then for all w âˆˆâ„¦,
h (w) + K |x âˆ’w| â‰¥h (x)
by 37.26. This shows h (x) â‰¤h (x). But also you could take w = x in 37.27 which
yields h (x) â‰¤h (x). Therefore h (x) = h (x) if x âˆˆâ„¦.
Now suppose x, y âˆˆRn and consider
Â¯Â¯h (x) âˆ’h (y)
Â¯Â¯. Without loss of gener-
ality assume h (x) â‰¥h (y) . (If not, repeat the following argument with x and y
interchanged.) Pick w âˆˆâ„¦such that
h (w) + K |y âˆ’w| âˆ’Îµ < h (y).
Then
Â¯Â¯h (x) âˆ’h (y)
Â¯Â¯ = h (x) âˆ’h (y) â‰¤h (w) + K |x âˆ’w| âˆ’
[h (w) + K |y âˆ’w| âˆ’Îµ] â‰¤K |x âˆ’y| + Îµ.
Since Îµ is arbitrary,
Â¯Â¯h (x) âˆ’h (y)
Â¯Â¯ â‰¤K |x âˆ’y|
and this proves the theorem.
This yields a simple corollary to Theorem 37.29.
Corollary 37.31 Let h : â„¦â†’Rn be Lipschitz continuous and one to one where â„¦
is a Lebesgue measurable set. Then if f â‰¥0 is Lebesgue measurable,
Z
h(â„¦)
f (y) dmn =
Z
â„¦
f (h (x))
Â¯Â¯det Dh (x)
Â¯Â¯ dmn.
(37.28)
where h denotes a Lipschitz extension of h.

1102
WEAK DERIVATIVES

The Area And Coarea
Formulas
38.1
The Area Formula Again
Recall the area formula presented earlier. For convenience, here it is.
Theorem 38.1 Let g : h (A) â†’[0, âˆž] be Hn measurable where h is a continuous
function and A is a Lebesgue measurable set which satisï¬es 17.8 - 17.10. That is,
U is an open set in Rn on which h is deï¬ned and A âŠ†U is a Lebesgue measurable
set, m â‰¥n, and
h : U â†’Rm is continuous,
(38.1)
Dh (x) exists for all x âˆˆA,
(38.2)
Also assume that for every x âˆˆA, there exists rx and Lx such that for all y, z âˆˆ
B (x, rx) ,
|h (z) âˆ’h (y)| â‰¤Lx |x âˆ’y|
(38.3)
Then
x â†’(g â—¦h) (x) J (x)
is Lebesgue measurable and
Z
h(A)
g (y) dHn =
Z
A
g (h (x)) J (x) dm
where J (x) = det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.
Obviously, one can obtain improved versions of this important theorem by using
Rademacherâ€™s theorem and condition 38.3. As mentioned earlier, a function which
satisï¬es 38.3 is called locally Lipschitz at x. Here is a simple lemma which is in the
spirit of similar lemmas presented in the chapter on Hausdorï¬€measures.
Lemma 38.2 Let U be an open set in Rn and let h : U â†’Rm where m â‰¥n.
Let A âŠ†U and let h be locally Lipschitz at every point of A. Then if N âŠ†A has
Lebesgue measure zero, it follows that Hn (h (N)) = 0.
1103

1104
THE AREA AND COAREA FORMULAS
Proof: Let Nk be deï¬ned as
Nk â‰¡{x âˆˆN : for some Rx > 0, |h (z) âˆ’h (y)| â‰¤k |z âˆ’y| for all y, z âˆˆB (x,Rx)}
Thus Nk â†‘N. Let Îµ > 0 be given and let U âŠ‡Vk âŠ‡N be open and mn (Vk) <
Îµ
5nkn .
Now ï¬x Î´ > 0. For x âˆˆNk let B (x, 5rx) âŠ†Vk such that rx < min
Â¡ Î´
5k, Rx
Â¢
. By
the Vitali covering theorem, there exists a disjoint sequence of these balls, {Bi}âˆž
i=1
such that
n
c
Bi
oâˆž
i=1 , the corresponding sequence of balls having the same centers
but ï¬ve times the radius covers Nk. Then diam
Â³
c
Bi
Â´
< 2Î´/k. Hence
n
h
Â³
c
Bi
Â´oâˆž
i=1
covers h (Nk) and diam
Â³
h
Â³
c
Bi
Â´Â´
< 2Î´. It follows
Hn
2Î´ (h (Nk))
â‰¤
âˆž
X
i=1
Î± (n) r
Â³
h
Â³
c
Bi
Â´Â´n
â‰¤
âˆž
X
i=1
Î± (n) kn5nr (Bi)n
=
5nkn
âˆž
X
i=1
mn (Bi) â‰¤5nknmn (Vk) < Îµ
Since Î´ was arbitrary, this shows Hn (h (Nk)) â‰¤Îµ. Since k was arbitrary, this
shows Hn (h (N)) = limkâ†’âˆžHn (h (Nk)) â‰¤Îµ. Since Îµ is arbitrary, this shows
Hn (h (N)) = 0. This proves the lemma.
Now with this lemma, here is one of many possible generalizations of the area
formula.
Theorem 38.3 Let U be an open set in Rn and h : U â†’Rm. Let h be locally
Lipschitz and one to one on A, a Lebesgue measurable subset of U and let g :
h (A) â†’R be a nonnegative Hn measurable function. Then
x â†’(g â—¦h) (x) J (x)
is Lebesgue measurable and
Z
h(A)
g (y) dHn =
Z
A
g (h (x)) J (x) dmn
where J (x) = det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.
Proof:
For x âˆˆA, there exists a ball, Bx on which h is Lipschitz.
By
Rademacherâ€™s theorem, h is diï¬€erentiable a.e. on Bx. There is a countable cover
of A consisting of such balls on which h is Lipschitz. Therefore, h is diï¬€erentiable
on A0 âŠ†A where mn (A \ A0) = 0. Then by the earlier area formula,
Z
h(A0)
g (y) dHn =
Z
A0
g (h (x)) J (x) dmn

38.1.
THE AREA FORMULA AGAIN
1105
By Lemma 38.2
Z
h(A)
g (y) dHn
=
Z
h(A0)
g (y) dHn
=
Z
A0
g (h (x)) J (x) dmn =
Z
A
g (h (x)) J (x) dmn
This proves the theorem.
Note how a special case of this occurs when h is one to one and C1. Of course
this yields the earlier change of variables formula as a still more special case.
In addition to this, recall the divergence theorem, Theorem 17.50 on Page 492.
This theorem was stated for bounded open sets which have a Lipschitz boundary.
This deï¬nition of Lipschitz boundary involved an assumption that certain Lips-
chitz mappings had a derivative a.e. Rademacherâ€™s theorem makes this assumption
redundant. Therefore, the statement of Theorem 17.50 remains valid with the fol-
lowing deï¬nition of a Lipschitz boundary.
Deï¬nition 38.4 A bounded open set, U âŠ†Rn is said to have a Lipschitz boundary
and to lie on one side of its boundary if the following conditions hold. There exist
open boxes, Q1, Â· Â· Â·, QN ,
Qi =
n
Y
j=1
Â¡
ai
j, bi
j
Â¢
such that âˆ‚U â‰¡U \ U is contained in their union. Also, for each Qi, there exists k
and a Lipschitz function, gi such that U âˆ©Qi is of the form
ï£±
ï£²
ï£³x : (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn) âˆˆ
kâˆ’1
Y
j=1
Â¡
ai
j, bi
j
Â¢
Ã—
n
Y
j=k+1
Â¡
ai
j, bi
j
Â¢
and ai
k < xk < gi (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn)
ï£¼
ï£½
ï£¾
(38.4)
or else of the form
ï£±
ï£²
ï£³x : (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn) âˆˆ
kâˆ’1
Y
j=1
Â¡
ai
j, bi
j
Â¢
Ã—
n
Y
j=k+1
Â¡
ai
j, bi
j
Â¢
and gi (x1, Â· Â· Â·, xkâˆ’1, xk+1, Â· Â· Â·, xn) < xk < bi
j
ï£¼
ï£½
ï£¾.
(38.5)
Also, there exists an open set, Q0 such that Q0 âŠ†Q0 âŠ†U and U âŠ†Q0âˆªQ1âˆªÂ·Â·Â·âˆªQN.

1106
THE AREA AND COAREA FORMULAS
38.2
Mappings That Are Not One To One
Next I will consider the case where h is not necessarily one to one.
Recall the
major theorem presented earlier on which the proof of the area formula depended,
Theorem 17.25 on Page 466. Here it is.
Theorem 38.5 Let h : U â†’Rm where U is an open set in Rn for n â‰¤m and
suppose h is locally Lipschitz at every point of a Lebesgue measurable subset, A of
U. Also suppose that for every x âˆˆA, Dh (x) exists. Then for x âˆˆA,
J (x) = lim
râ†’0
Hn (h (B (x, r)))
mn (B (x,r))
,
(38.6)
where J (x) â‰¡det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.
The next lemma is a version of Sardâ€™s lemma.
Lemma 38.6 Let h : U â†’Rm where U is an open set in Rn for n â‰¤m and
suppose h is locally Lipschitz at every point of a Lebesgue measurable subset, A of
U. Let
N â‰¡{x âˆˆA : Dh (x) does not exist}
(38.7)
and let
S â‰¡{x âˆˆA0 â‰¡A \ N : J (x) = 0}
(38.8)
Then Hn (h (S âˆªN)) = 0.
Proof: By Rademacherâ€™s theorem, N has measure 0. Therefore, Hn (h (N)) = 0
by Lemma 38.2.
It remains to show Hn (h (S)) = 0. Let Sk = B (0, k)âˆ©S for k a positive integer
large enough that Sk Ì¸= âˆ…. By Theorem 17.25 on Page 466 stated above, if x âˆˆSk,
there exists rx such that 5rx < min (Rx, 1) and if r â‰¤5rx,
Hn (h (B (x, r)))
mn (B (x,r))
<
Îµ
5nkn , B (x, r) âŠ†B (0,k) âˆ©U
(38.9)
Then by the Vitali covering theorem, there exists a sequence of disjoint balls of this
sort, {Bi}âˆž
i=1 such that the balls having 5 times the radius but the same center,
n
c
Bi
oâˆž
i=1 cover Sk. Then
n
h
Â³
c
Bi
Â´oâˆž
i=1 covers h (Sk) . Then from 38.9
Hn (h (Sk))
â‰¤
âˆž
X
i=1
Hn Â³
h
Â³
c
Bi
Â´Â´
â‰¤
âˆž
X
i=1
5nHn (h (Bi))
â‰¤
âˆž
X
i=1
5n
Îµ
5nkn mn (Bi) â‰¤Îµ
kn mn (B (0, k)) = ÎµÎ± (n)
Since Îµ > 0 is arbitrary, it follows Hn (h (Sk)) = 0 and now letting k â†’0, it follows
Hn (h (S)) = 0. This proves the lemma.
The following very technical lemma provides the necessary theory to generalize
to functions which are not one to one.

38.2.
MAPPINGS THAT ARE NOT ONE TO ONE
1107
Lemma 38.7 Let h : U â†’Rm where U is an open set in Rn for n â‰¤m and
suppose h is locally Lipschitz at every point of a Lebesgue measurable subset, A of
U. Let
N â‰¡{x âˆˆA : Dh (x) does not exist}
and let
S â‰¡{x âˆˆA0 â‰¡A \ N : J (x) = 0}
Let B = A \ (S âˆªN) . Then there exist measurable disjoint sets, {Ei}âˆž
i=1 such that
A = âˆªâˆž
i=1Ei and h is one to one on Ei. Furthermore, hâˆ’1 is Lipschitz on h (Ei) .
Proof:
Let C be a dense countable subset of B and let F be a countable
dense subset of the invertible elements of L (Rn, Rn). For i a positive integer and
T âˆˆF, c âˆˆC
E (c, T, i) â‰¡
Â½
b âˆˆB
Âµ
c, 1
i
Â¶
âˆ©B : (a) , (b) both hold
Â¾
where (a) , (b) are given by
2
3 |Tv| â‰¤|U (b) v| for all v
(a)
|h (a) âˆ’h (b) âˆ’Dh (b) (a âˆ’b)| â‰¤1
2 |T (a âˆ’b)| .
(b)
for all a âˆˆB
Â¡
b, 2
i
Â¢
.
a
2
i
6
1
i Â¡
Â¡
Âª
b r
c
r
First I will show these sets, E (c, T, i) cover B and that they are measurable
sets. To begin with consider the measurability question. Inequality (a) is the same
as saying
2
3 |Tv| â‰¤|Dh (b) v| for all v
which is the same as saying
2
3 |v| â‰¤
Â¯Â¯Dh (b) T âˆ’1v
Â¯Â¯ for all v.

1108
THE AREA AND COAREA FORMULAS
Let {vi} denote a dense countable subset of Rn. Letting
Si â‰¡
Â½
b : 2
3 |vi| â‰¤
Â¯Â¯Dh (b) T âˆ’1vi
Â¯Â¯
Â¾
it follows easily that Si is measurable because the component functions of the matrix
of Dh (b) are limits of diï¬€erence quotients of continuous functions so they are Borel
measurable. (Note that if B were Borel, then Si would also be Borel.) Now by
continuity,
âˆªâˆž
i=1Si =
Â½
b : 2
3 |v| â‰¤
Â¯Â¯Dh (b) T âˆ’1v
Â¯Â¯ for all v
Â¾
and so this set is measurable also. Inequality (b) also determines a measurable set
by similar reasoning. It is the same as saying that for all |v| < 2/i,
|h (b + v) âˆ’h (b) âˆ’Dh (b) (v)| â‰¤1
2 |T (v)|
Use {vi} a countable dense subset of B (0,2/i) in a similar fashion to (a) .
Next I need to show these sets cover B. Let x âˆˆB. Then pick ci âˆˆB
Â¡
x, 1
i
Â¢
and
Ti âˆˆB
Â¡
U (x) , 1
i
Â¢
. I need to show that x âˆˆE (ci, Ti, i) for i large enough. For i
large enough,
Â¯Â¯Â¯
Â¯Â¯Â¯TiU (x)âˆ’1Â¯Â¯Â¯
Â¯Â¯Â¯ < 3
2. Therefore, for such i
Â¯Â¯Â¯TiU (x)âˆ’1 (v)
Â¯Â¯Â¯ < 3
2 |v|
for all v and so
|Tiw| < 3
2 |U (x) w|
for all w. Next consider (b). An equivalent norm is v â†’|U (x) v| and so, for i large
enough,
|h (a) âˆ’h (x) âˆ’Dh (x) (a âˆ’x)| â‰¤1
8 |U (x) (a âˆ’x)|
(38.10)
whenever |a âˆ’x| < 2/i. Now also, for i large enough,
Â¯Â¯Â¯Â¯U (x) T âˆ’1
i
Â¯Â¯Â¯Â¯ < 4 and so for
all w,
Â¯Â¯U (x) T âˆ’1
i
w
Â¯Â¯ < 4 |w|
which implies
|U (x) v| < 4 |Tiv| .
Applying this in 38.10 yields
|h (a) âˆ’h (x) âˆ’Dh (x) (a âˆ’x)| â‰¤1
2 |Ti (a âˆ’x)|
with implies x âˆˆE (ci, Ti, i) .

38.2.
MAPPINGS THAT ARE NOT ONE TO ONE
1109
Next I need to show h is one to one on E (c, T, i) . Suppose b1, b2 âˆˆE (c, T, i) .
From (b) and (a) ,
|T (b2 âˆ’b1)|
â‰¤
3
2 |U (b1) (b2 âˆ’b1)| = 3
2 |Dh (b1) (b2âˆ’b1)|
â‰¤
3
2
1
2 |T (b2 âˆ’b1)|
which is a contradiction unless b2 = b1.
There are clearly countably many E (c, T, i) . Denote them as {Fi}âˆž
i=1 . Then let
E1 = F1 and if E1, Â· Â· Â·, Em have been chosen, let
Em+1 = Fm+1 \ âˆªm
i=1Ei.
Thus the Ei are disjoint measurable sets whose union is B and h is one to one on
each Ei.
Now consider one of the Ei. This is a subset of some E (c, T, i) . Let a, b âˆˆEi.
Then using (a) and (b) ,
|T (a âˆ’b)|
â‰¤
3
2 |U (b) (a âˆ’b)|
=
3
2 |Dh (b) (a âˆ’b)|
â‰¤
3
2 |h (a) âˆ’h (b)| + 3
4 |T (a âˆ’b)| .
Hence
1
4 |T (a âˆ’b)| â‰¤3
2 |h (a) âˆ’h (b)|
Since v â†’|Tv| is an equivalent norm, there exists some r > 0 such that |Tv| â‰¥r |v|
for all v. Therefore,
|a âˆ’b| â‰¤6
r |h (a) âˆ’h (b)| .
In other words,
Â¯Â¯hâˆ’1 (h (a)) âˆ’hâˆ’1 (h (b))
Â¯Â¯ = |a âˆ’b| â‰¤6
r |h (a) âˆ’h (b)| .
which completes the proof.
With these lemmas, here is the main theorem which is a generalization of The-
orem 38.3. First remember that from Lemma 17.18 on Page 462 a locally Lipschitz
function maps Lebesgue measurable sets to Hausdorï¬€measurable sets.
Theorem 38.8 Let U be an open set in Rn and h : U â†’Rm. Let h be locally
Lipschitz on A, a Lebesgue measurable subset of U and let g : h (A) â†’R be a
nonnegative Hn measurable function. Also let
# (y) â‰¡Number of elements of hâˆ’1 (y)

1110
THE AREA AND COAREA FORMULAS
Then # is Hn measurable,
x â†’(g â—¦h) (x) J (x)
is Lebesgue measurable, and
Z
h(A)
# (y) g (y) dHn =
Z
A
g (h (x)) J (x) dmn
where J (x) = det (U (x)) = det
Â¡
Dh (x)âˆ—Dh (x)
Â¢1/2.
Proof: Let B = A \ (S âˆªN) where S is the set of points where J (x) = 0 and
N is the set of points, x of A where Dh (x) does not exist. Also from Lemma 38.7
there exists {Ei}âˆž
i=1, a sequence of disjoint measurable sets whose union equals B
such that h is one to one on each Ei. Then from Theorem 38.3
Z
A
g (h (x)) J (x) dmn
=
Z
B
g (h (x)) J (x) dmn =
âˆž
X
i=1
Z
Ei
g (h (x)) J (x) dmn
=
âˆž
X
i=1
Z
h(Ei)
g (y) dHn =
Z
h(B)
Ãƒ âˆž
X
i=1
Xh(Ei) (y)
!
g (y) dHn.
(38.11)
Now # (y) =
Â¡Pâˆž
i=1 Xh(Ei) (y)
Â¢
on h (B) and # diï¬€ers from this Hn measurable
function only on h (S âˆªN) , which by Lemma 38.6 is a set of Hn measure zero.
Therefore, # is Hn measurable and the last term of 38.11 equals
Z
h(A)
Ãƒ âˆž
X
i=1
Xh(Ei) (y)
!
g (y) dHn =
Z
h(A)
# (y) g (y) dHn.
This proves the theorem.
38.3
The Coarea Formula
The coarea formula involves a function, h which maps a subset of Rn to Rm where
m â‰¤n instead of m â‰¥n as in the area formula. The symbol, Lip (h) will denote
the Lipschitz constant for h.
It is possible to obtain the coarea formula as a computation involving the area
formula and some simple linear algebra and this is the approach taken here. To
begin with, here is the necessary linear algebra.
Theorem 38.9 Let A be an mÃ—n matrix and let B be an nÃ—m matrix for m â‰¤n.
Then
pBA (t) = tnâˆ’mpAB (t) ,
so the eigenvalues of BA and AB are the same including multiplicities except that
BA has n âˆ’m extra zero eigenvalues.

38.3.
THE COAREA FORMULA
1111
Proof: Use block multiplication to write
Âµ
AB
0
B
0
Â¶ Âµ
I
A
0
I
Â¶
=
Âµ
AB
ABA
B
BA
Â¶
Âµ
I
A
0
I
Â¶ Âµ
0
0
B
BA
Â¶
=
Âµ
AB
ABA
B
BA
Â¶
.
Therefore,
Âµ
I
A
0
I
Â¶âˆ’1 Âµ
AB
0
B
0
Â¶ Âµ
I
A
0
I
Â¶
=
Âµ
0
0
B
BA
Â¶
It follows that
Âµ
0
0
B
BA
Â¶
and
Âµ
AB
0
B
0
Â¶
have the same characteristic polyno-
mials because the two matrices are simlar. Thus
det
Âµ
tI âˆ’AB
0
âˆ’B
tI
Â¶
= det
Âµ
tI
0
âˆ’B
tI âˆ’BA
Â¶
and so noting that BA is an n Ã— n matrix and AB is an m Ã— m matrix,
tm det (tI âˆ’BA) = tn det (tI âˆ’AB)
and so det (tI âˆ’BA) = pBA (t) = tnâˆ’m det (tI âˆ’AB) = tnâˆ’mpAB (t) . This proves
the theorem.
The following corollary is what will be used to prove the coarea formula.
Corollary 38.10 Let A be an m Ã— n matrix. Then
det (I + AAâˆ—) = det (I + Aâˆ—A) .
Proof: Assume m â‰¤n. From Theorem 38.9 AAâˆ—and Aâˆ—A have the eigenval-
ues, Î»1, Â· Â· .Î»m, necessarily nonnegative, with the same multiplicities and some zero
eigenvalues which have diï¬€ering multiplicities. The eigenvalues, Î»1, Â· Â· .Î»m are the
zeros of pAAâˆ—(t) . Thus there is an orthogonal transformation, P such that
Aâˆ—A = P
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
Î»1
...
0
Î»m
0
0
...
0
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
P âˆ—.
Therefore,
I + Aâˆ—A = P
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
Î»1 + 1
...
0
Î»m + 1
1
0
...
1
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
P âˆ—

1112
THE AREA AND COAREA FORMULAS
and so
det (I + Aâˆ—A) = det
ï£«
ï£¬
ï£­
Î»1 + 1
0
...
0
Î»m + 1
ï£¶
ï£·
ï£¸= det (I + AAâˆ—) .
This proves the corollary.
The other main ingredient is the following version of the chain rule.
Theorem 38.11 Let h and g be locally Lipschitz mappings from Rn to Rn with
h (g (x)) = x on A, a Lebesgue measurable set. Then for a.e. x âˆˆA, Dg (h (x)),
Dh (x), and D (h â—¦g) (x) all exist and
I = D (g â—¦h) (x) = Dg (h (x)) Dh (x).
The proof of this theorem is based on the following lemma.
Lemma 38.12 If h : Rn â†’Rn is locally Lipschitz, then if h (x) = 0 for all x âˆˆ
A, then det (Dh (x)) = 0 a.e.
Proof: By the case of the Area formula which involves mappings which are not
one to one, 0 =
R
{0} # (y) dy =
R
A |det (Dh (x))| dx and so det (Dh (x)) = 0 a.e.
Proof of the theorem: On A, g (h (x)) âˆ’x = 0 and so by the lemma, there
exists a set of measure zero, N1 such that if x /âˆˆN1, D (g â—¦h) (x) âˆ’I = 0. Let M
be the set of measure zero of points in h (Rn) where g fails to be diï¬€erentiable and
let N2 â‰¡g (M) âˆ©A, also a set of measure zero because locally Lipschitz maps take
sets of measure zero to sets of measure zero. Finally let N3 be the set of points
where h fails to be diï¬€erentiable. Then if x /âˆˆN1 âˆªN2 âˆªN3, the chain rule implies
I = D (g â—¦h) (x) = Dg (h (x)) Dh (x). This proves the theorem.
Lemma 38.13 Let h : Rp â†’Rm be Lipschitz continuous and Î´ > 0.
Then if
A âŠ†Rp is either open or compact,
y â†’Hs
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
is Borel measurable.
Proof: Suppose ï¬rst that A is compact and suppose for Î´ > 0,
Hs
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
< t
Then there exist sets Si, satisfying
diam (Si) < Î´, A âˆ©hâˆ’1 (y) âŠ†âˆªâˆž
i=1Si,
and
âˆž
X
i=1
Î± (s) (r (Si))s < t.

38.3.
THE COAREA FORMULA
1113
I claim these sets can be taken to be open sets. Choose Î» > 1 but close enough to
1 that
âˆž
X
i=1
Î± (s) (Î»r (Si))s < t
Replace Si with Si + B (0, Î·i) where Î·i is small enough that
diam (Si) + 2Î·i < Î» diam (Si) .
Then
diam (Si + B (0, Î·i)) â‰¤Î» diam (Si)
and so r (Si + B (0, Î·i)) â‰¤Î»r (Si) . Thus
âˆž
X
i=1
Î± (s) r (Si + B (0, Î·i))s < t.
Hence you could replace Si with Si + B (0, Î·i) and so one can assume the sets Si
are open.
Claim: If z is close enough to y, then A âˆ©hâˆ’1 (z) âŠ†âˆªâˆž
i=1Si.
Proof: If not, then there exists a sequence {zk} such that
zk â†’y,
and
xk âˆˆ(A âˆ©hâˆ’1 (zk)) \ âˆªâˆž
i=1Si.
By compactness of A, there exists a subsequence still denoted by k such that
zk â†’y, xk â†’x âˆˆA \ âˆªâˆž
i=1Si.
Hence
h (x) = lim
kâ†’âˆžh (xk) = lim
kâ†’âˆžzk = y.
But x /âˆˆâˆªâˆž
i=1Si contrary to the assumption that A âˆ©hâˆ’1 (y) âŠ†âˆªâˆž
i=1Si.
It follows from this claim that whenever z is close enough to y,
Hs
Î´
Â¡
A âˆ©hâˆ’1 (z)
Â¢
< t.
This shows
Â©
z âˆˆRp : Hs
Î´
Â¡
A âˆ©hâˆ’1 (z)
Â¢
< t
Âª
is an open set and so y â†’Hs
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
is Borel measurable whenever A is
compact. Now let V be an open set and let
Ak â†‘V, Ak compact.
Then
Hs
Î´
Â¡
V âˆ©hâˆ’1 (y)
Â¢
= lim
kâ†’âˆžHs
Î´
Â¡
Ak âˆ©hâˆ’1 (y)
Â¢
so y â†’Hs
Î´
Â¡
V âˆ©hâˆ’1 (y)
Â¢
is Borel measurable for all V open. This proves the lemma.

1114
THE AREA AND COAREA FORMULAS
Lemma 38.14 Let h : Rp â†’Rm be Lipschitz continuous. Suppose A is either open
or compact in Rp. Then y â†’Hs Â¡
A âˆ©hâˆ’1 (y)
Â¢
is also Borel measurable and
Z
Rm Hs Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy â‰¤2m (Lip (h))m Î± (s) Î± (m)
Î± (s + m) Hs+m (A)
In particular, if s = n âˆ’m and p = n
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy â‰¤2m (Lip (h))m Î± (n âˆ’m) Î± (m)
Î± (n)
mn (A)
Proof: From Lemma 38.13 y â†’Hs
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
is Borel measurable for each
Î´ > 0. Without loss of generality, Hs+m (A) < âˆž. Now let Bi be closed sets with
diam (Bi) < Î´, A âŠ†âˆªâˆž
i=1Bi, and
Hs+m
Î´
(A) + Îµ >
âˆž
X
i=1
Î± (s + m) r (Bi)s+m .
Note each Bi is compact so y â†’Hs
Î´
Â¡
Bi âˆ©hâˆ’1 (y)
Â¢
is Borel measurable. Thus
Z
Rm Hs
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy
â‰¤
Z
Rm
X
i
Hs
Î´
Â¡
Bi âˆ©hâˆ’1 (y)
Â¢
dy
=
X
i
Z
Rm Hs
Î´
Â¡
Bi âˆ©hâˆ’1 (y)
Â¢
dy
â‰¤
X
i
Z
h(Bi)
Hs
Î´ (Bi) dy
=
X
i
mm (h (Bi)) Hs
Î´ (Bi)
â‰¤
X
i
(Lip (h))m 2mÎ± (m) r (Bi)m Î± (s) r (Bi)s
=
(Lip (h))m Î± (m) Î± (s)
Î± (m + s) 2m X
i
Î± (s + m) r (Bi)m+s
â‰¤
(Lip (h))m Î± (m) Î± (s)
Î± (m + s) 2mHs+m (A)
Taking a limit as Î´ â†’0 this proves the lemma.
Next I will show that whenever A is Lebesgue measurable,
y â†’Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
is mm measurable and the above estimate holds.

38.3.
THE COAREA FORMULA
1115
Lemma 38.15 Let A be a Lebesgue measurable subset of Rn and let h : Rn â†’Rm
be Lipschitz. Then
y â†’Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
is Lebesgue measurable. Furthermore, for all A Lebesgue measurable,
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy â‰¤2m (Lip (h))m Î± (n âˆ’m) Î± (m)
Î± (n)
mn (A)
Proof: Let A be a bounded Lebesgue measurable set in Rn. Then by inner and
outer regularity of Lebesgue measure there exists an increasing sequence of compact
sets, {Kk} contained in A and a decreasing sequence of open sets, {Vk} containing
A such that mn (Vk \ Kk) < 2âˆ’k. Thus mn (V1) â‰¤mn (A) + 1. By Lemma 38.14
Z
Rm Hnâˆ’m
Î´
Â¡
V1 âˆ©hâˆ’1 (y)
Â¢
dy < 2m (Lip (h))m Î± (n âˆ’m) Î± (m)
Î± (n)
(mn (A) + 1) .
Then
Hnâˆ’m
Î´
Â¡
Kk âˆ©hâˆ’1 (y)
Â¢
â‰¤Hnâˆ’m
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
â‰¤Hnâˆ’m
Î´
Â¡
Vk âˆ©hâˆ’1 (y)
Â¢
(38.12)
By Lemma 38.14
=
Z
Rm
Â¡
Hnâˆ’m
Î´
Â¡
Vk âˆ©hâˆ’1 (y)
Â¢
âˆ’Hnâˆ’m
Î´
Â¡
Kk âˆ©hâˆ’1 (y)
Â¢Â¢
dy
=
Z
Rm Hnâˆ’m
Î´
Â¡
(Vk âˆ’Kk) âˆ©hâˆ’1 (y)
Â¢
dy
â‰¤
2m (Lip (h))m Î± (n âˆ’m) Î± (m)
Î± (n)
mn (Vk \ Kk)
<
2m (Lip (h))m Î± (n âˆ’m) Î± (m)
Î± (n)
2âˆ’k
Let the Borel measurable functions, g and f be deï¬ned by
g (y) â‰¡lim
kâ†’âˆžHnâˆ’m
Î´
Â¡
Vk âˆ©hâˆ’1 (y)
Â¢
, f (y) â‰¡lim
kâ†’âˆžHnâˆ’m
Î´
Â¡
Kk âˆ©hâˆ’1 (y)
Â¢
It follows from the dominated convergence theorem and 38.12 that
f (y) â‰¤Hnâˆ’m
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
â‰¤g (y)
and
Z
Rm (g (y) âˆ’f (y)) dy = 0.
By completness of mm, this establishes y â†’Hnâˆ’m
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
is Lebesgue mea-
surable. Then by Lemma 38.14 again,
Z
Rm Hnâˆ’m
Î´
Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy â‰¤2m (Lip (h))m Î± (n âˆ’m) Î± (m)
Î± (n)
mn (A) .

1116
THE AREA AND COAREA FORMULAS
Letting Î´ â†’0 and using the monotone convergence theorem yields the desired
inequality for Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
.
The case where A is not bounded can be handled by considering Ar = Aâˆ©B (0, r)
and letting r â†’âˆž. This proves the lemma.
By fussing with the isodiametric inequality one can remove the factor of 2m in
the above inequalities obtaining much more attractive formulas. This is done in
[20]. See also [36] which follows [20] and [22]. This last reference probably has the
most complete treatment of these topics.
With these lemmas, it is now possible to give a proof of the coarea formula.
Deï¬ne Î› (n, m) as all possible ordered lists of m numbers taken from {1, 2, Â· Â· Â·, n} .
Lemma 38.16 Let A be a measurable set in Rn and let h : Rn â†’Rm be a Lipschitz
map where m â‰¤n which is diï¬€erentiable at every point of A and for which
Jh (x) â‰¡det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2 Ì¸= 0.
Then the following formula holds along with all measurability assertions needed for
it to make sense.
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy =
Z
A
Jh (x) dx
(38.13)
Proof: For x âˆˆRn, and i âˆˆÎ› (n, m), with i = (i1, Â· Â· Â·, im), deï¬ne xi â‰¡(xi1,
Â· Â· Â·, xim), and Ï€ix â‰¡xi. Also for i âˆˆÎ› (n, m), let ic âˆˆÎ› (n, n âˆ’m) consist of
the remaining indices taken in order.
For h : Rn â†’Rm where m â‰¤n, deï¬ne
Jh (x) â‰¡det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2. For each i âˆˆÎ› (n, m), deï¬ne
hi (x) â‰¡
Âµ
h (x)
xic
Â¶
.
By Lemma 38.7, there exist disjoint measurable sets
Â©
F i
j
Âªâˆž
j=1 such that hi is one
to one on F i
j,
Â¡
hiÂ¢âˆ’1 is Lipschitz on hi Â¡
F i
j
Â¢
, and
âˆªâˆž
j=1F i
j =
Â©
x âˆˆA : det
Â¡
Dhi (x)
Â¢
Ì¸= 0
Âª
.
For x âˆˆA, det (Dxih (x)) Ì¸= 0 for some i âˆˆÎ› (n, m).
But det (Dxih (x)) =
det
Â¡
Dhi (x)
Â¢
and so x âˆˆF i
j for some i and j. Hence
âˆªi,jF i
j = A.
Now let
Â©
Ei
j
Âª
be measurable sets such that Ei
j âŠ†F i
k for some k, the sets are
disjoint, and their union coincides with âˆªi,jF i
j. Then
Z
A
Jh (x) dx =
X
i âˆˆÎ›(n,m)
âˆž
X
j=1
Z
Ei
jâˆ©A
det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2 dx.
(38.14)

38.3.
THE COAREA FORMULA
1117
Let g : Rn â†’Rn be a Lipschitz extension of
Â¡
hiÂ¢âˆ’1 so g â—¦hi (x) = x for all x âˆˆ
Ei
j. First, using Theorem 38.11, and the fact that Lipschitz mappings take sets of
measure zero to sets of measure zero, replace Ei
j with a measurable set, eEi
j âŠ†Ei
j
such that Ei
j \ eEi
j has measure zero and
Dhi (g (y)) Dg (y) = I
on hi Â³
eEi
j
Â´
. Changing the variables using the area formula, the expression in 38.14
equals
Z
A
Jh (x) dx =
X
i âˆˆÎ›(n,m)
âˆž
X
j=1
Z
hi( e
Ei
jâˆ©A)
det
Â¡
Dh (g (y)) Dh (g (y))âˆ—Â¢1/2 Â¯Â¯det Dhi (g (y))
Â¯Â¯âˆ’1 dy.
(38.15)
Note the integrands are all Borel measurable functions because they are continu-
ous functions of the entries of matrices which entries come from taking limits of
diï¬€erence quotients of continuous functions. Thus,
Z
e
Ei
jâˆ©A
det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2 dx =
Z
Rn Xhi( e
Ei
jâˆ©A) (y) det
Â¡
Dh (g (y)) Dh (g (y))âˆ—Â¢1/2 Â¯Â¯det Dhi (g (y))
Â¯Â¯âˆ’1 dy
=
Z
Rm
Z
Ï€ic(hâˆ’1(y1)âˆ©e
Ei
jâˆ©A)
det
Â¡
Dh (g (y)) Dh (g (y))âˆ—Â¢1/2 |det Dhxi (g (y))|âˆ’1 dy2dy1
(38.16)
where y1 = h (x) and y2 = xic. Thus
y2 = Ï€icg (y) = Ï€icg
Â¡
hi (x)
Â¢
= xic.
(38.17)
Now consider the inner integral in 38.16 in which y1 is ï¬xed. The integrand
equals
det
Â·Â¡
Dxih (g (y))
Dxich (g (y))
Â¢ Âµ
Dxih (g (y))âˆ—
Dxic h (g (y))âˆ—
Â¶Â¸1/2
|det Dhxi (g (y))|âˆ’1 .
(38.18)
I want to massage the above expression slightly.
Since y1 is ï¬xed, and y1 =
h (Ï€ig (y) , Ï€icg (y)) = h (g (y)), it follows from 38.17 that
0
=
Dxih (g (y)) Dy2Ï€ig (y) + Dxic h (g (y)) Dy2Ï€icg (y)
=
Dxih (g (y)) Dy2Ï€ig (y) + Dxic h (g (y)).

1118
THE AREA AND COAREA FORMULAS
Letting A â‰¡Dxih (g (y)) and B â‰¡Dy2Ï€ig (y) and using the above formula, 38.18
is of the form
det
Â·Â¡
A
âˆ’AB
Â¢ Âµ
Aâˆ—
âˆ’Bâˆ—Aâˆ—
Â¶Â¸1/2
|det A|âˆ’1
=
det [Aâˆ—A + ABBâˆ—Aâˆ—]1/2 |det A|âˆ’1
=
det [Aâˆ—(I + BBâˆ—) A]1/2 |det A|âˆ’1
=
det (I + BBâˆ—)1/2,
which, by Corollary 38.10, equals det (I + Bâˆ—B)1/2. (Note the size of the identity
changes in these two expressions, the ï¬rst being an m Ã— m matrix and the second
being a n âˆ’m Ã— n âˆ’m matrix.)
By 38.17 Ï€icg (y) = y2 and so,
det (I + Bâˆ—B)1/2 = det
Â·Â¡
Bâˆ—
I
Â¢ Âµ
B
I
Â¶Â¸1/2
= det
Â·Â¡ Dy2Ï€ig (y)âˆ—
Dy2Ï€icg (y)âˆ—Â¢ Âµ
Dy2Ï€ig (y)
Dy2Ï€icg (y)
Â¶Â¸1/2
= det
Â¡
Dy2g (y)âˆ—Dy2g (y)
Â¢1/2.
Therefore, 38.16 reduces to
Z
e
Ei
jâˆ©A
det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2 dx =
Z
Rm
Z
Ï€ic(hâˆ’1(y1)âˆ©e
Ei
jâˆ©A)
det
Â¡
Dy2g (y)âˆ—Dy2g (y)
Â¢1/2 dy2dy1.
(38.19)
By the area formula applied to the inside integral, this integral equals
Hnâˆ’m Â³
hâˆ’1 (y1) âˆ©eEi
j âˆ©A
Â´
and so
Z
e
Ei
jâˆ©A
det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2 dx
=
Z
Rm Hnâˆ’m Â³
hâˆ’1 (y1) âˆ©eEi
j âˆ©A
Â´
dy1.
Using Lemma 38.15, along with the inner regularity of Lebesgue measure, eEi
j
can be replaced with Ei
j. Therefore, summing the terms over all i and j,
Z
A
det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2 dx =
Z
Rm Hnâˆ’m Â¡
hâˆ’1 (y) âˆ©A
Â¢
dy.
This proves the lemma.
Now the following is the Coarea formula.

38.3.
THE COAREA FORMULA
1119
Corollary 38.17 Let A be a measurable set in Rn and let h : Rn â†’Rm be a
Lipschitz map where m â‰¤n. Then the following formula holds along with all mea-
surability assertions needed for it to make sense.
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy =
Z
A
Jh (x) dx
(38.20)
where Jh (x) â‰¡det
Â¡
Dh (x) Dh (x)âˆ—Â¢1/2 .
Proof: By Lemma 38.15 again, this formula is true for all measurable A âŠ†
Rn \ S. It remains to verify the formula for all measurable sets, A, whether or not
they intersect S.
Consider the case where
A âŠ†S â‰¡{x : J (Dh (x)) = 0}.
Let A be compact so that by Lemma 38.14, y â†’Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
is Borel. For
Îµ > 0, deï¬ne k, p : Rn Ã— Rm â†’Rm by
k (x, y) â‰¡h (x) + Îµy, p (x, y) â‰¡y.
Then
Dk (x, y) = (Dh (x) , ÎµI) = (UR, ÎµI)
where the dependence of U and R on x has been suppressed. Thus
Jk2 = det (UR, ÎµI)
Âµ
Râˆ—U
ÎµI
Â¶
= det
Â¡
U 2 + Îµ2I
Â¢
= det
Â¡
Qâˆ—DQQâˆ—DQ + Îµ2I
Â¢
= det
Â¡
D2 + Îµ2I
Â¢
=
m
Y
i=1
Â¡
Î»2
i + Îµ2Â¢
âˆˆ[Îµ2m, C2Îµ2]
(38.21)
since one of the Î»i equals 0. All the eigenvalues must be bounded independent of
x, since ||Dh (x)|| is bounded independent of x due to the assumption that h is
Lipschitz. Since Jk Ì¸= 0, the ï¬rst part of the argument implies
ÎµCmn+m
Â³
A Ã— B (0,1)
Â´
â‰¥
Z
AÃ—B(0,1)
|Jk| dmn+m
=
Z
Rm Hn Â³
kâˆ’1 (y) âˆ©A Ã— B (0,1)
Â´
dy
Which by Lemma 38.14,
â‰¥Cnm
Z
Rm
Z
Rm Hnâˆ’m Â³
kâˆ’1 (y) âˆ©pâˆ’1 (w) âˆ©A Ã— B (0,1)
Â´
dwdy
(38.22)
where Cnm =
Î±(n)
Î±(nâˆ’m)Î±(m).

1120
THE AREA AND COAREA FORMULAS
Claim:
Hnâˆ’m Â³
kâˆ’1 (y) âˆ©pâˆ’1 (w) âˆ©A Ã— B (0,1)
Â´
â‰¥XB(0,1) (w) Hnâˆ’m Â¡
hâˆ’1 (y âˆ’Îµw) âˆ©A
Â¢
.
Proof of the claim: If w /âˆˆB (0,1), there is nothing to prove so assume w âˆˆ
B (0,1). For such w,
(x, w1) âˆˆkâˆ’1 (y) âˆ©pâˆ’1 (w) âˆ©A Ã— B (0,1)
if and only if h (x) + Îµw1 = y, w1 = w, and x âˆˆA, if and only if
(x, w1) âˆˆhâˆ’1 (y âˆ’Îµw) âˆ©A Ã— {w}.
Therefore for w âˆˆB (0,1),
Hnâˆ’m Â³
kâˆ’1 (y) âˆ©pâˆ’1 (w) âˆ©A Ã— B (0,1)
Â´
â‰¥Hnâˆ’m Â¡
hâˆ’1 (y âˆ’Îµw) âˆ©A Ã— {w}
Â¢
= Hnâˆ’m Â¡
hâˆ’1 (y âˆ’Îµw) âˆ©A
Â¢
.
(Actually equality holds in the claim.) From the claim, 38.22 is at least as large as
Cnm
Z
Rm
Z
B(0,1)
Hnâˆ’m Â¡
hâˆ’1 (y âˆ’Îµw) âˆ©A
Â¢
dwdy
(38.23)
= Cnm
Z
B(0,1)
Z
Rm Hnâˆ’m Â¡
hâˆ’1 (y âˆ’Îµw) âˆ©A
Â¢
dydw
=
Î± (n)
Î± (n âˆ’m)
Z
Rm Hnâˆ’m Â¡
hâˆ’1 (y) âˆ©A
Â¢
dy.
(38.24)
The use of Fubiniâ€™s theorem is justiï¬ed because the integrand is Borel measurable.
Now by 38.24, it follows since Îµ > 0 is arbitrary,
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy = 0 =
Z
A
Jh (x) dx.
Since this holds for arbitrary compact sets in S, it follows from Lemma 38.15 and
inner regularity of Lebesgue measure that the equation holds for all measurable
subsets of S. This completes the proof of the coarea formula.There is a simple
corollary to this theorem in the case of locally Lipschitz maps.
Corollary 38.18 Let h : Rn â†’Rm where m â‰¤n and h is locally Lipschitz. Then
the Coarea formula, 38.13, holds for h.
Proof: The assumption that h is locally Lipschitz implies that for each r > 0 it
follows h is Lipschitz on B (0, r) . To see this, cover the compact set, B (0, r) with
ï¬nitely many balls on which h is Lipschitz.

38.4.
A NONLINEAR FUBINIâ€™S THEOREM
1121
Let A âŠ†B (0,r) and let hr be Lipschitz with
h (x) = hr (x)
for x âˆˆB (0,r + 1) . Then
Z
A
J (Dh (x)) dx =
Z
A
J(Dhr (x))dx =
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1
r
(y)
Â¢
dy
=
Z
hr(A)
Hnâˆ’m Â¡
A âˆ©hâˆ’1
r
(y)
Â¢
dy =
Z
h(A)
Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy
=
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy
Now for arbitrary measurable A the above shows for k = 1, 2, Â· Â· Â·
Z
Aâˆ©B(0,k)
J (Dh (x)) dx =
Z
Rm Hnâˆ’m Â¡
A âˆ©B (0,k) âˆ©hâˆ’1 (y)
Â¢
dy.
Use the monotone convergence theorem to obtain 38.13.
From the deï¬nition of Hausdorï¬€measure it follows H0 (E) equals the number
of elements in E. Thus, if n = m, the Coarea formula implies
Z
A
J (Dh (x)) dx =
Z
h(A)
H0 Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy =
Z
h(A)
# (y) dy
This gives a version of Sardâ€™s theorem by letting S = A.
38.4
A Nonlinear Fubiniâ€™s Theorem
Coarea formula holds for h : Rn â†’Rm, n â‰¥m
if whenever A is a Lebesgue
measurable subset of Rn,the following formula is valid.
Z
Rm Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy =
Z
A
Jh (x) dx
(38.25)
Note this is the same as
Z
A
J(Dh (x))dx =
Z
h(A)
Hnâˆ’m Â¡
A âˆ©hâˆ’1 (y)
Â¢
dy
because if y /âˆˆh (A) , then hâˆ’1 (y) = âˆ…. Now let
s (x) =
p
X
i=1
ciXEi (x)

1122
THE AREA AND COAREA FORMULAS
where Ei is measurable and ci â‰¥0. Then
Z
Rn s (x) J ((Dh (x))) dx
=
p
X
i=1
ci
Z
Ei
J (Dh (x)) dx
=
p
X
i=1
ci
Z
h(Ei)
Hnâˆ’m Â¡
Ei âˆ©hâˆ’1(y)
Â¢
dy
=
Z
h(Rn)
p
X
i=1
ciHnâˆ’m Â¡
Ei âˆ©hâˆ’1(y)
Â¢
dy
=
Z
h(Rn)
"Z
hâˆ’1(y)
s dHnâˆ’m
#
dy
=
Z
h(Rn)
"Z
hâˆ’1(y)
s dHnâˆ’m
#
dy.
(38.26)
Theorem 38.19 Let g â‰¥0 be Lebesgue measurable and let
h : Rn â†’Rm, n â‰¥m
satisfy the Coarea formula. For example, it could be locally Lipschitz. Then
Z
Rn g (x) J ((Dh (x))) dx =
Z
h(Rn)
"Z
hâˆ’1(y)
g dHnâˆ’m
#
dy.
Proof: Let si â†‘g where si is a simple function satisfying 38.26. Then let i â†’âˆž
and use the monotone convergence theorem to replace si with g. This proves the
change of variables formula.
Note that this formula is a nonlinear version of Fubiniâ€™s theorem. The â€œn âˆ’
m dimensional surfaceâ€, hâˆ’1 (y), plays the role of Rnâˆ’m and Hnâˆ’m is like n âˆ’
m dimensional Lebesgue measure. The term, J ((Dh (x))), corrects for the error
occurring because of the lack of ï¬‚atness of hâˆ’1 (y).

Integration On Manifolds
You can do integration on various manifolds by using the Hausdorï¬€measure of an
appropriate dimension. However, it is possible to discuss this through the use of
the Riesz representation theorem and some of the machinery for accomplishing this
is interesting for its own sake so I will present this alternate point of view.
39.1
Partitions Of Unity
This material has already been mostly discussed starting on Page 481. However,
that was a long time ago and it seems like it might be good to go over it again and
so, for the sake of convenience, here it is again.
Deï¬nition 39.1 Let C be a set whose elements are subsets of Rn.1 Then C is said
to be locally ï¬nite if for every x âˆˆRn, there exists an open set, Ux containing x
such that Ux has nonempty intersection with only ï¬nitely many sets of C.
Lemma 39.2 Let C be a set whose elements are open subsets of Rn and suppose
âˆªC âŠ‡H, a closed set. Then there exists a countable list of open sets, {Ui}âˆž
i=1 such
that each Ui is bounded, each Ui is a subset of some set of C, and âˆªâˆž
i=1Ui âŠ‡H.
Proof: Let Wk â‰¡B (0, k) , W0 = Wâˆ’1 = âˆ…. For each x âˆˆH âˆ©Wk there exists
an open set, Ux such that Ux is a subset of some set of C and Ux âŠ†Wk+1 \ Wkâˆ’1.
Then since H âˆ©Wk is compact, there exist ï¬nitely many of these sets,
Â©
U k
i
Âªm(k)
i=1
whose union contains H âˆ©Wk. If H âˆ©Wk = âˆ…, let m (k) = 0 and there are no such
sets obtained.The desired countable list of open sets is âˆªâˆž
k=1
Â©
U k
i
Âªm(k)
i=1 . Each open
set in this list is bounded. Furthermore, if x âˆˆRn, then x âˆˆWk where k is the
ï¬rst positive integer with x âˆˆWk. Then Wk \Wkâˆ’1 is an open set containing x and
this open set can have nonempty intersection only with with a set of
Â©
U k
i
Âªm(k)
i=1 âˆª
Â©
U kâˆ’1
i
Âªm(kâˆ’1)
i=1
, a ï¬nite list of sets. Therefore, âˆªâˆž
k=1
Â©
U k
i
Âªm(k)
i=1
is locally ï¬nite.
The set, {Ui}âˆž
i=1 is said to be a locally ï¬nite cover of H. The following lemma
gives some important reasons why a locally ï¬nite list of sets is so signiï¬cant. First
1The deï¬nition applies with no change to a general topological space in place of Rn.
1123

1124
INTEGRATION ON MANIFOLDS
of all consider the rational numbers, {ri}âˆž
i=1 each rational number is a closed set.
Q = {ri}âˆž
i=1 = âˆªâˆž
i=1{ri} Ì¸= âˆªâˆž
i=1 {ri} = R
The set of rational numbers is deï¬nitely not locally ï¬nite.
Lemma 39.3 Let C be locally ï¬nite. Then
âˆªC = âˆª
Â©
H : H âˆˆC
Âª
.
Next suppose the elements of C are open sets and that for each U âˆˆC, there exists a
diï¬€erentiable function, ÏˆU having spt (ÏˆU) âŠ†U. Then you can deï¬ne the following
ï¬nite sum for each x âˆˆRn
f (x) â‰¡
X
{ÏˆU (x) : x âˆˆU âˆˆC} .
Furthermore, f is also a diï¬€erentiable function2 and
Df (x) =
X
{DÏˆU (x) : x âˆˆU âˆˆC} .
Proof: Let p be a limit point of âˆªC and let W be an open set which intersects
only ï¬nitely many sets of C. Then p must be a limit point of one of these sets. It
follows p âˆˆâˆª
Â©
H : H âˆˆC
Âª
and so âˆªC âŠ†âˆª
Â©
H : H âˆˆC
Âª
. The inclusion in the other
direction is obvious.
Now consider the second assertion. Letting x âˆˆRn, there exists an open set, W
intersecting only ï¬nitely many open sets of C, U1, U2, Â· Â· Â·, Um. Then for all y âˆˆW,
f (y) =
m
X
i=1
ÏˆUi (y)
and so the desired result is obvious. It merely says that a ï¬nite sum of diï¬€erentiable
functions is diï¬€erentiable. Recall the following deï¬nition.
Deï¬nition 39.4 Let K be a closed subset of an open set, U. K â‰ºf â‰ºU if f is
continuous, has values in [0, 1] , equals 1 on K, and has compact support contained
in U.
Lemma 39.5 Let U be a bounded open set and let K be a closed subset of U. Then
there exist an open set, W, such that W âŠ†W âŠ†U and a function, f âˆˆCâˆž
c (U)
such that K â‰ºf â‰ºU.
Proof: The set, K is compact so is at a positive distance from U C. Let
W â‰¡
Â©
x : dist (x, K) < 3âˆ’1 dist
Â¡
K, U CÂ¢Âª
.
2If each ÏˆU were only continuous, one could conclude f is continuous. Here the main interest
is diï¬€erentiable.

39.1.
PARTITIONS OF UNITY
1125
Also let
W1 â‰¡
Â©
x : dist (x, K) < 2âˆ’1 dist
Â¡
K, U CÂ¢Âª
Then it is clear
K âŠ†W âŠ†W âŠ†W1 âŠ†W1 âŠ†U
Now consider the function,
h (x) â‰¡
dist
Â¡
x, W C
1
Â¢
dist
Â¡
x, W C
1
Â¢
+ dist
Â¡
x, W
Â¢
Since W is compact it is at a positive distance from W C
1 and so h is a well deï¬ned
continuous function which has compact support contained in W 1, equals 1 on W,
and has values in [0, 1] . Now let Ï†k be a molliï¬er. Letting
kâˆ’1 < min
Â¡
dist
Â¡
K, W CÂ¢
, 2âˆ’1 dist
Â¡
W 1, U CÂ¢Â¢
,
it follows that for such k,the function, h âˆ—Ï†k âˆˆCâˆž
c (U) , has values in [0, 1] , and
equals 1 on K. Let f = h âˆ—Ï†k.
The above lemma is used repeatedly in the following.
Lemma 39.6 Let K be a closed set and let {Vi}âˆž
i=1 be a locally ï¬nite list of bounded
open sets whose union contains K. Then there exist functions, Ïˆi âˆˆCâˆž
c (Vi) such
that for all x âˆˆK,
1 =
âˆž
X
i=1
Ïˆi (x)
and the function f (x) given by
f (x) =
âˆž
X
i=1
Ïˆi (x)
is in Câˆž(Rn) .
Proof: Let K1 = K \ âˆªâˆž
i=2Vi. Thus K1 is compact because K1 âŠ†V1. Let
K1 âŠ†W1 âŠ†W 1 âŠ†V1
Thus W1, V2, Â·Â·Â·, Vn covers K and W 1 âŠ†V1. Suppose W1, Â·Â·Â·, Wr have been deï¬ned
such that Wi âŠ†Vi for each i, and W1, Â· Â· Â·, Wr, Vr+1, Â· Â· Â·, Vn covers K. Then let
Kr+1 â‰¡K \ (
Â¡
âˆªâˆž
i=r+2Vi
Â¢
âˆª
Â¡
âˆªr
j=1Wj
Â¢
).
It follows Kr+1 is compact because Kr+1 âŠ†Vr+1. Let Wr+1 satisfy
Kr+1 âŠ†Wr+1 âŠ†W r+1 âŠ†Vr+1
Continuing this way deï¬nes a sequence of open sets, {Wi}âˆž
i=1 with the property
Wi âŠ†Vi, K âŠ†âˆªâˆž
i=1Wi.

1126
INTEGRATION ON MANIFOLDS
Note {Wi}âˆž
i=1 is locally ï¬nite because the original list, {Vi}âˆž
i=1 was locally ï¬nite.
Now let Ui be open sets which satisfy
W i âŠ†Ui âŠ†U i âŠ†Vi.
Similarly, {Ui}âˆž
i=1 is locally ï¬nite.
Wi
Ui
Vi
Since the set, {Wi}âˆž
i=1 is locally ï¬nite, it follows âˆªâˆž
i=1Wi = âˆªâˆž
i=1Wi and so it
is possible to deï¬ne Ï†i and Î³, inï¬nitely diï¬€erentiable functions having compact
support such that
U i â‰ºÏ†i â‰ºVi, âˆªâˆž
i=1W i â‰ºÎ³ â‰ºâˆªâˆž
i=1Ui.
Now deï¬ne
Ïˆi(x) =
Â½ Î³(x)Ï†i(x)/ Pâˆž
j=1 Ï†j(x) if Pâˆž
j=1 Ï†j(x) Ì¸= 0,
0 if Pâˆž
j=1 Ï†j(x) = 0.
If x is such that Pâˆž
j=1 Ï†j(x) = 0, then x /âˆˆâˆªâˆž
i=1Ui because Ï†i equals one on Ui.
Consequently Î³ (y) = 0 for all y near x thanks to the fact that âˆªâˆž
i=1Ui is closed
and so Ïˆi(y) = 0 for all y near x. Hence Ïˆi is inï¬nitely diï¬€erentiable at such x. If
Pâˆž
j=1 Ï†j(x) Ì¸= 0, this situation persists near x because each Ï†j is continuous and so
Ïˆi is inï¬nitely diï¬€erentiable at such points also thanks to Lemma 39.3. Therefore
Ïˆi is inï¬nitely diï¬€erentiable. If x âˆˆK, then Î³ (x) = 1 and so Pâˆž
j=1 Ïˆj(x) = 1.
Clearly 0 â‰¤Ïˆi (x) â‰¤1 and spt(Ïˆj) âŠ†Vj. This proves the theorem.
The method of proof of this lemma easily implies the following useful corollary.
Corollary 39.7 If H is a compact subset of Vi for some Vi there exists a partition
of unity such that Ïˆi (x) = 1 for all x âˆˆH in addition to the conclusion of Lemma
39.6.
Proof: Keep Vi the same but replace Vj with f
Vj â‰¡Vj \ H. Now in the proof
above, applied to this modiï¬ed collection of open sets, if j Ì¸= i, Ï†j (x) = 0 whenever
x âˆˆH. Therefore, Ïˆi (x) = 1 on H.
Theorem 39.8 Let H be any closed set and let C be any open cover of H. Then
there exist functions {Ïˆi}âˆž
i=1 such that spt (Ïˆi) is contained in some set of C and Ïˆi
is inï¬nitely diï¬€erentiable having values in [0, 1] such that on H, Pâˆž
i=1 Ïˆi (x) = 1.
Furthermore, the function, f (x) â‰¡Pâˆž
i=1 Ïˆi (x) is inï¬nitely diï¬€erentiable on Rn.
Also, spt (Ïˆi) âŠ†Ui where Ui is a bounded open set with the property that {Ui}âˆž
i=1
is locally ï¬nite and each Ui is contained in some set of C.

39.2.
INTEGRATION ON MANIFOLDS
1127
Proof: By Lemma 39.2 there exists an open cover of H composed of bounded
open sets, Ui such that each Ui is a subset of some set of C and the collection,
{Ui}âˆž
i=1 is locally ï¬nite.
Then the result follows from Lemma 39.6 and Lemma
39.3.
Corollary 39.9 Let H be any closed set and let {Vi}m
i=1 be a ï¬nite open cover of
H. Then there exist functions {Ï†i}m
i=1 such that spt (Ï†i) âŠ†Vi and Ï†i is inï¬nitely
diï¬€erentiable having values in [0, 1] such that on H, Pm
i=1 Ï†i (x) = 1.
Proof: By Theorem 39.8 there exists a set of functions, {Ïˆi}âˆž
i=1 having the
properties listed in this theorem relative to the open covering, {Vi}m
i=1 . Let Ï†1 (x)
equal the sum of all Ïˆj (x) such that spt
Â¡
Ïˆj
Â¢
âŠ†V1. Next let Ï†2 (x) equal the sum
of all Ïˆj (x) which have not already been included and for which spt
Â¡
Ïˆj
Â¢
âŠ†V2.
Continue in this manner. Since the open sets, {Ui}âˆž
i=1 mentioned in Theorem 39.8
are locally ï¬nite, it follows from Lemma 39.3 that each Ï†i is inï¬nitely diï¬€erentiable
having support in Vi. This proves the corollary.
39.2
Integration On Manifolds
Manifolds are things which locally appear to be Rn for some n. The extent to
which they have such a local appearance varies according to various analytical
characteristics which the manifold possesses.
Deï¬nition 39.10 Let U âŠ†Rn be an open set and let h : U â†’Rm. Then for
r âˆˆ[0, 1), h âˆˆCk,r (U) for k a nonnegative integer means that DÎ±h exists for all
|Î±| â‰¤k and each DÎ±h is Holder continuous with exponent r. That is
|DÎ±h (x) âˆ’DÎ±h (y)| â‰¤K |x âˆ’y|r .
Also h âˆˆCk,r Â¡
U
Â¢
if it is the restriction of a function of Ck,r (Rn) to U.
Deï¬nition 39.11 Let Î“ be a closed subset of Rp where p â‰¥n. Suppose Î“ = âˆªâˆž
i=1Î“i
where Î“i = Î“âˆ©Wi for Wi a bounded open set. Suppose also {Wi}âˆž
i=1 is locally ï¬nite.
This means every bounded open set intersects only ï¬nitely many. Also suppose there
are open bounded sets, Ui having Lipschitz boundaries and functions hi : Ui â†’Î“i
which are one to one, onto, and in Cm,1 (Ui) . Suppose also there exist functions,
gi : Wi â†’Ui such that gi is Cm,1 (Wi) , and gi â—¦hi = id on Ui while hi â—¦gi = id on
Î“i. The collection of sets, Î“j and mappings, gj,
Â©Â¡
Î“j, gj
Â¢Âª
is called an atlas and
an individual entry in the atlas is called a chart. Thus
Â¡
Î“j, gj
Â¢
is a chart. Then Î“
as just described is called a Cm,1 manifold. The number, m is just a nonnegative
integer. When m = 0 this would be called a Lipschitz manifold, the least smooth of
the manifolds discussed here.
For example, take p = n + 1 and let
hi (u) = (u1, Â· Â· Â·, ui, Ï†i (u) , ui+1, Â· Â· Â·, un)T

1128
INTEGRATION ON MANIFOLDS
for u = (u1, Â· Â· Â·, ui, ui+1, Â· Â· Â·, un)T âˆˆUi for Ï†i âˆˆCm,1 (Ui) and gi : Ui Ã— R â†’Ui
given by
gi (u1, Â· Â· Â·, ui, y, ui+1, Â· Â· Â·, un) â‰¡u
for i = 1, 2, Â· Â· Â·, p. Then for u âˆˆUi, the deï¬nition gives
gi â—¦hi (u) = gi (u1, Â· Â· Â·, ui, Ï†i (u) , ui+1, Â· Â· Â·, un) = u
and for Î“i â‰¡hi (Ui) and (u1, Â· Â· Â·, ui, Ï†i (u) , ui+1, Â· Â· Â·, un)T âˆˆÎ“i,
hi â—¦gi (u1, Â· Â· Â·, ui, Ï†i (u) , ui+1, Â· Â· Â·, un)
=
hi (u) = (u1, Â· Â· Â·, ui, Ï†i (u) , ui+1, Â· Â· Â·, un)T .
This example can be used to describe the boundary of a bounded open set and since
Ï†i âˆˆCm,1 (Ui) , such an open set is said to have a Cm,1 boundary. Note also that
in this example, Ui could be taken to be Rn or if Ui is given, both hi and and gi
can be taken as restrictions of functions deï¬ned on all of Rn and Rp respectively.
The symbol, I will refer to an increasing list of n indices taken from {1, Â· Â· Â·, p} .
Denote by Î› (p, n) the set of all such increasing lists of n indices.
Let
Ji (u) â‰¡
ï£®
ï£°
X
IâˆˆÎ›(p,n)
Ãƒ
âˆ‚
Â¡
xi1 Â· Â· Â· xinÂ¢
âˆ‚(u1 Â· Â· Â· un)
!2ï£¹
ï£»
1/2
where here the sum is taken over all possible increasing lists of n indices, I, from
{1, Â· Â· Â·, p} and x = hiu. Thus there are
Â¡p
n
Â¢
terms in the sum. In this formula,
âˆ‚(xi1Â·Â·Â·xin)
âˆ‚(u1Â·Â·Â·un)
is deï¬ned to be the determinant of the following matrix.
ï£«
ï£¬
ï£¬
ï£­
âˆ‚xi1
âˆ‚u1
Â· Â· Â·
âˆ‚xi1
âˆ‚un
...
...
âˆ‚xin
âˆ‚u1
Â· Â· Â·
âˆ‚xin
âˆ‚un
ï£¶
ï£·
ï£·
ï£¸.
Note that if p = n there is only one term in the sum, the absolute value of the
determinant of Dx (u). Deï¬ne a positive linear functional, Î› on Cc (Î“) as follows:
First let {Ïˆi} be a Câˆžpartition of unity subordinate to the open sets, {Wi} . Thus
Ïˆi âˆˆCâˆž
c (Wi) and P
i Ïˆi (x) = 1 for all x âˆˆÎ“. Then
Î›f â‰¡
âˆž
X
i=1
Z
giÎ“i
fÏˆi (hi (u)) Ji (u) du.
(39.1)
Is this well deï¬ned?
Lemma 39.12 The functional deï¬ned in 39.1 does not depend on the choice of
atlas or the partition of unity.

39.2.
INTEGRATION ON MANIFOLDS
1129
Proof: In 39.1, let {Ïˆi} be a Câˆžpartition of unity which is associated with
the atlas (Î“i, gi) and let {Î·i} be a Câˆžpartition of unity associated in the same
manner with the atlas (Î“â€²
i, gâ€²
i). In the following argument, the local ï¬niteness of
the Î“i implies that all sums are ï¬nite. Using the change of variables formula with
u =
Â¡
gi â—¦hâ€²
j
Â¢
v
âˆž
X
i=1
Z
giÎ“i
Ïˆif (hi (u)) Ji (u) du =
(39.2)
âˆž
X
i=1
âˆž
X
j=1
Z
giÎ“i
Î·jÏˆif (hi (u)) Ji (u) du =
âˆž
X
i=1
âˆž
X
j=1
Z
gâ€²
j(Î“iâˆ©Î“â€²
j)
Â·
Î·j
Â¡
hâ€²
j (v)
Â¢
Ïˆi
Â¡
hâ€²
j (v)
Â¢
f
Â¡
hâ€²
j (v)
Â¢
Ji (u)
Â¯Â¯Â¯Â¯Â¯
âˆ‚
Â¡
u1 Â· Â· Â· unÂ¢
âˆ‚(v1 Â· Â· Â· vn)
Â¯Â¯Â¯Â¯Â¯ dv
=
âˆž
X
i=1
âˆž
X
j=1
Z
gâ€²
j(Î“iâˆ©Î“â€²
j)
Î·j
Â¡
hâ€²
j (v)
Â¢
Ïˆi
Â¡
hâ€²
j (v)
Â¢
f
Â¡
hâ€²
j (v)
Â¢
Jj (v) dv.
(39.3)
Thus
the deï¬nition of Î›f using (Î“i, gi) â‰¡
âˆž
X
i=1
Z
giÎ“i
Ïˆif (hi (u)) Ji (u) du =
âˆž
X
i=1
âˆž
X
j=1
Z
gâ€²
j(Î“iâˆ©Î“â€²
j)
Î·j
Â¡
hâ€²
j (v)
Â¢
Ïˆi
Â¡
hâ€²
j (v)
Â¢
f
Â¡
hâ€²
j (v)
Â¢
Jj (v) dv
=
âˆž
X
j=1
Z
gâ€²
j(Î“â€²
j)
Î·j
Â¡
hâ€²
j (v)
Â¢
f
Â¡
hâ€²
j (v)
Â¢
Jj (v) dv
the deï¬nition of Î›f using (Vi, gâ€²
i) .
This proves the lemma.
This lemma and the Riesz representation theorem for positive linear functionals
implies the part of the following theorem which says the functional is well deï¬ned.
Theorem 39.13 Let Î“ be a Cm,1 manifold.
Then there exists a unique Radon
measure, Âµ, deï¬ned on Î“ such that whenever f is a continuous function having
compact support which is deï¬ned on Î“ and (Î“i, gi) denotes an atlas and {Ïˆi} a
partition of unity subordinate to this atlas,
Î›f =
Z
Î“
fdÂµ =
âˆž
X
i=1
Z
giÎ“i
Ïˆif (hi (u)) Ji (u) du.
(39.4)
Also, a subset, A, of Î“ is Âµ measurable if and only if for all r, gr (Î“r âˆ©A) is Î½r
measurable where Î½r is the measure deï¬ned by
Î½r (gr (Î“r âˆ©A)) â‰¡
Z
gr(Î“râˆ©A)
Jr (u) du

1130
INTEGRATION ON MANIFOLDS
Proof: To begin, here is a claim.
Claim : A set, S âŠ†Î“i, has Âµ measure zero if and only if giS has measure zero
in giÎ“i with respect to the measure, Î½i.
Proof of the claim: Let Îµ > 0 be given. By outer regularity, there exists a
set, V âŠ†Î“i, open3 in Î“ such that Âµ (V ) < Îµ and S âŠ†V âŠ†Î“i. Then giV is open in
Rn and contains giS. Letting h â‰ºgiV and h1 (x) â‰¡h (gi (x)) for x âˆˆÎ“i it follows
h1 â‰ºV . By Corollary 39.7 on Page 1126 there exists a partition of unity such that
spt (h1) âŠ†{x âˆˆRp : Ïˆi (x) = 1}. Thus Ïˆjh1 (hj (u)) = 0 unless j = i when this
reduces to h1 (hi (u)). It follows
Îµ
â‰¥
Âµ (V ) â‰¥
Z
V
h1dÂµ =
Z
Î“
h1dÂµ
=
âˆž
X
j=1
Z
gjÎ“j
Ïˆjh1 (hj (u)) Jj (u) du
=
Z
giÎ“i
h1 (hi (u)) Ji (u) du =
Z
giÎ“i
h (u) Ji (u) du
=
Z
giV
h (u) Ji (u) du
Now this holds for all h â‰ºgiV and so
Z
giV
Ji (u) du â‰¤Îµ.
Since Îµ is arbitrary, this shows giV has measure no more than Îµ with respect to the
measure, Î½i. Since Îµ is arbitrary, giS has measure zero.
Consider the converse. Suppose giS has Î½i measure zero. Then there exists an
open set, O âŠ†giÎ“i such that O âŠ‡giS and
Z
O
Ji (u) du < Îµ.
Thus hi (O) is open in Î“ and contains S. Let h â‰ºhi (O) be such that
Z
Î“
hdÂµ + Îµ > Âµ (hi (O)) â‰¥Âµ (S)
(39.5)
As in the ï¬rst part, Corollary 39.7 on Page 1126 implies there exists a partition of
unity such that h (x) = 0 oï¬€the set,
{x âˆˆRp : Ïˆi (x) = 1}
3This means V is the intersection of an open set with Î“. Equivalently, it means that V is an
open set in the traditional way regarding Î“ as a metric space with the metric it inherits from Rm.

39.2.
INTEGRATION ON MANIFOLDS
1131
and so as in this part of the argument,
Z
Î“
hdÂµ
â‰¡
âˆž
X
j=1
Z
gjUj
Ïˆjh (hj (u)) Jj (u) du
=
Z
giÎ“i
h (hi (u)) Ji (u) du
=
Z
Oâˆ©giÎ“i
h (hi (u)) Ji (u) du
â‰¤
Z
O
Ji (u) du < Îµ
(39.6)
and so from 39.5 and 39.6 Âµ (S) â‰¤2Îµ. Since Îµ is arbitrary, this proves the claim.
For the last part of the theorem, it suï¬ƒces to let A âŠ†Î“r because otherwise, the
above argument would apply to A âˆ©Î“r. Thus let A âŠ†Î“r be Âµ measurable. By
the regularity of the measure, there exists an FÏƒ set, F and a GÎ´ set, G such that
Î“r âŠ‡G âŠ‡A âŠ‡F and Âµ (G \ F) = 0.(Recall a GÎ´ set is a countable intersection
of open sets and an FÏƒ set is a countable union of closed sets.) Then since Î“r is
compact, it follows each of the closed sets whose union equals F is a compact set.
Thus if F = âˆªâˆž
k=1Fk, gr (Fk) is also a compact set and so gr (F) = âˆªâˆž
k=1gr (Fk) is
a Borel set. Similarly, gr (G) is also a Borel set. Now by the claim,
Z
gr(G\F )
Jr (u) du = 0.
Since gr is one to one,
grG \ grF = gr (G \ F)
and so
gr (F) âŠ†gr (A) âŠ†gr (G)
where gr (G)\gr (F) has measure zero. By completeness of the measure, Î½r, gr (A)
is measurable. It follows that if A âŠ†Î“ is Âµ measurable, then gr (Î“r âˆ©A) is Î½r
measurable for all r. The converse is entirely similar. This proves the theorem.
Corollary 39.14 Let f âˆˆL1 (Î“; Âµ) and suppose f (x) = 0 for all x /âˆˆÎ“r where
(Î“r, gr) is a chart. Then
Z
Î“
fdÂµ =
Z
Î“r
fdÂµ =
Z
grÎ“r
f (hr (u)) Jr (u) du.
(39.7)
Furthermore, if {(Î“i, gi)} is an atlas and {Ïˆi} is a partition of unity as described
earlier, then for any f âˆˆL1 (Î“, Âµ),
Z
Î“
fdÂµ =
âˆž
X
r=1
Z
grÎ“r
Ïˆrf (hr (u)) Jr (u) du.
(39.8)

1132
INTEGRATION ON MANIFOLDS
Proof: Let f âˆˆL1 (Î“, Âµ) with f = 0 oï¬€Î“r. Without loss of generality assume
f â‰¥0 because if the formulas can be established for this case, the same formulas are
obtained for an arbitrary complex valued function by splitting it up into positive
and negative parts of the real and imaginary parts in the usual way.
Also, let
K âŠ†Î“r a compact set. Since Âµ is a Radon measure there exists a sequence of
continuous functions, {fk} , fk âˆˆCc (Î“r), which converges to f in L1 (Î“, Âµ) and for
Âµ a.e. x. Take the partition of unity, {Ïˆi} to be such that
K âŠ†{x : Ïˆr (x) = 1} .
Therefore, the sequence {fk (hr (Â·))} is a Cauchy sequence in the sense that
lim
k,lâ†’âˆž
Z
gr(K)
|fk (hr (u)) âˆ’fl (hr (u))| Jr (u) du = 0
It follows there exists g such that
Z
gr(K)
|fk (hr (u)) âˆ’g (u)| Jr (u) du â†’0,
and
g âˆˆL1 (grK; Î½r) .
By the pointwise convergence and the claim used in the proof of Theorem 39.13,
g (u) = f (hr (u))
for Âµ a.e. hr (u) âˆˆK. Therefore,
Z
K
fdÂµ
=
lim
kâ†’âˆž
Z
K
fkdÂµ = lim
kâ†’âˆž
Z
gr(K)
fk (hr (u)) Jr (u) du
=
Z
gr(K)
g (u) Jr (u) du =
Z
gr(K)
f (hr (u)) Jr (u) du.
(39.9)
Now let Â· Â· Â·Kj âŠ†Kj+1 Â· Â·Â· and âˆªâˆž
j=1Kj = Î“r where Kj is compact for all j. Replace
K in 39.9 with Kj and take a limit as j â†’âˆž.
By the monotone convergence
theorem,
Z
Î“r
fdÂµ =
Z
gr(Î“r)
f (hr (u)) Jr (u) du.
This establishes 39.7.
To establish 39.8, let f âˆˆL1 (Î“, Âµ) and let {(Î“i, gi)} be an atlas and {Ïˆi} be a
partition of unity. Then fÏˆi âˆˆL1 (Î“, Âµ) and is zero oï¬€Î“i. Therefore, from what
was just shown,
Z
Î“
fdÂµ
=
âˆž
X
i=1
Z
Î“i
fÏˆidÂµ
=
âˆž
X
r=1
Z
gr(Î“r)
Ïˆrf (hr (u)) Jr (u) du

39.3.
COMPARISON WITH HN
1133
39.3
Comparison With Hn
The above gives a measure on a manifold, Î“. I will now show that the measure
obtained is nothing more than Hn, the n dimensional Hausdorï¬€measure. Recall
Î› (p, n) was the set of all increasing lists of n indices taken from {1, 2, Â· Â· Â·, p}
Recall
Ji (u) â‰¡
ï£®
ï£°
X
IâˆˆÎ›(p,n)
Ãƒ
âˆ‚
Â¡
xi1 Â· Â· Â· xinÂ¢
âˆ‚(u1 Â· Â· Â· un)
!2ï£¹
ï£»
1/2
where here the sum is taken over all possible increasing lists of n indices, I, from
{1, Â· Â· Â·, p} and x = hiu and the functional was given as
Î›f â‰¡
âˆž
X
i=1
Z
giÎ“i
fÏˆi (hi (u)) Ji (u) du
(39.10)
where the {Ïˆi}âˆž
i=1 was a partition of unity subordinate to the open sets, {Wi}âˆž
i=1
as described above. I will show
Ji (u) = det
Â¡
Dh (u)âˆ—Dh (u)
Â¢1/2
and then use the area formula. The key result is really a special case of the Binet
Cauchy theorem and this special case is presented in the next lemma.
Lemma 39.15 Let A = (aij) be a real pÃ—n matrix in which p â‰¥n. For I âˆˆÎ› (p, n)
denote by AI the n Ã— n matrix obtained by deleting from A all rows except for those
corresponding to an element of I. Then
X
IâˆˆÎ›(p,n)
det (AI)2 = det (Aâˆ—A)
Proof: For (j1, Â· Â· Â·, jn) âˆˆÎ› (p, n) , deï¬ne Î¸ (jk) â‰¡k. Then let for {k1, Â· Â· Â·, kn} =
{j1, Â· Â· Â·, jn} deï¬ne
sgn (k1, Â· Â· Â·, kn) â‰¡sgn (Î¸ (k1) , Â· Â· Â·, Î¸ (kn)) .
Then from the deï¬nition of the determinant and matrix multiplication,
det (Aâˆ—A)
=
X
i1,Â·Â·Â·,in
sgn (i1, Â· Â· Â·, in)
p
X
k1=1
ak1i1ak11
p
X
k2=1
ak2i2ak22
Â· Â· Â·
p
X
kn=1
akninaknn
=
X
JâˆˆÎ›(p,n)
X
{k1,Â·Â·Â·,kn}=J
X
i1,Â·Â·Â·,in
sgn (i1, Â· Â· Â·, in) ak1i1ak11ak2i2ak22 Â· Â· Â· akninaknn

1134
INTEGRATION ON MANIFOLDS
=
X
JâˆˆÎ›(p,n)
X
{k1,Â·Â·Â·,kn}=J
X
i1,Â·Â·Â·,in
sgn (i1, Â· Â· Â·, in) ak1i1ak2i2 Â· Â· Â· aknin Â· ak11ak22 Â· Â· Â· aknn
=
X
JâˆˆÎ›(p,n)
X
{k1,Â·Â·Â·,kn}=J
sgn (k1, Â· Â· Â·, kn) det (AJ) ak11ak22 Â· Â· Â· aknn
=
X
JâˆˆÎ›(p,n)
det (AJ) det (AJ)
and this proves the lemma.
It follows from this lemma that
Ji (u) = det
Â¡
Dh (u)âˆ—Dh (u)
Â¢1/2 .
From 39.10 and the area formula, the functional equals
Î›f
â‰¡
âˆž
X
i=1
Z
giÎ“i
fÏˆi (hi (u)) Ji (u) du
=
âˆž
X
i=1
Z
Î“i
fÏˆi (y) dHn =
Z
Î“
f (y) dHn.
Now Hn is a Borel measure deï¬ned on Î“ which is ï¬nite on all compact subsets of Î“.
This ï¬niteness follows from the above formula. If K is a compact subset of Î“, then
there exists an open set, W whose closure is compact and a continuous function
with compact support, f such that K â‰ºf â‰ºW. Then Hn (K) â‰¤
R
Î“ f (y) dHn < âˆž
because of the above formula.
Lemma 39.16 Âµ = Hn on every Âµ measurable set.
Proof: The Riesz representation theorem shows that
Z
Î“
fdÂµ =
Z
Î“
fdHn
for every continuous function having compact support. Therefore, since every open
set is the countable union of compact sets, it follows Âµ = Hn on all open sets. Since
compact sets can be obtained as the countable intersection of open sets, these two
measures are also equal on all compact sets. It follows they are also equal on all
countable unions of compact sets. Suppose now that E is a Âµ measurable set of ï¬nite
measure. Then there exist sets, F, G such that G is the countable intersection of
open sets each of which has ï¬nite measure and F is the countable union of compact
sets such that Âµ (G \ F) = 0 and F âŠ†E âŠ†G. Thus Hn (G \ F) = 0,
Hn (G) = Âµ (G) = Âµ (F) = Hn (F)
By completeness of Hn it follows E is Hn measurable and Hn (E) = Âµ (E) . If
E is not of ï¬nite measure, consider Er â‰¡E âˆ©B (0, r) . This is contained in the
compact set Î“ âˆ©B (0, r) and so Âµ (Er) if ï¬nite. Thus from what was just shown,
Hn (Er) = Âµ (Er) and so, taking r â†’âˆžHn (E) = Âµ (E) .
This shows you can simply use Hn for the measure on Î“.

Basic Theory Of Sobolev
Spaces
Deï¬nition 40.1 Let U be an open set of Rn. Deï¬ne Xm,p (U) as the set of all
functions in Lp (U) whose weak partial derivatives up to order m are also in Lp (U)
where 1 â‰¤p. The norm1 in this space is given by
||u||m,p â‰¡
ï£«
ï£­
Z
U
X
|Î±|â‰¤m
|DÎ±u|p dx
ï£¶
ï£¸
1/p
.
where Î± = (Î±1, Â· Â· Â·, Î±n) âˆˆNn and |Î±| â‰¡P Î±i. Here D0u â‰¡u. CâˆžÂ¡
U
Â¢
is deï¬ned
to be the set of functions which are restrictions to U of a function in Câˆž
c (Rn).
Thus CâˆžÂ¡
U
Â¢
âŠ†W m,p (U) . The Sobolev space, W m,p (U) is deï¬ned to be the clo-
sure of CâˆžÂ¡
U
Â¢
in Xm,p (U) with respect to the above norm. Denote this norm by
||u||W m,p(U), ||u||Xm,p(U) , or ||u||m,p,U when it is important to identify the open set,
U.
Also the following notation will be used pretty consistently.
Deï¬nition 40.2 Let u be a function deï¬ned on U. Deï¬ne
eu (x) â‰¡
Â½
u (x) if x âˆˆU
0 if x /âˆˆU
.
Theorem 40.3 Both Xm,p (U) and W m,p (U) are separable reï¬‚exive Banach spaces
provided p > 1.
Proof: Deï¬ne Î› : Xm,p (U) â†’Lp (U)w where w equals the number of multi
indices, Î±, such that |Î±| â‰¤m as follows. Letting {Î±i}w
i=1 be the set of all multi
indices with Î±1 = 0,
Î› (u) â‰¡(DÎ±1u, DÎ±2u, Â· Â· Â·, DÎ±wu) = (u, DÎ±2u, Â· Â· Â·, DÎ±wu) .
1You could also let the norm be given by ||u||m,p
â‰¡
P
|Î±|â‰¤m ||DÎ±u||p or ||u||m,p
â‰¡
max
n
||DÎ±u||p : |Î±| â‰¤m
o
because all norms are equivalent on Rp where p is the number of multi
indices no larger than m. This is used whenever convenient.
1135

1136
BASIC THEORY OF SOBOLEV SPACES
Then Î› is one to one because one of the multi indices is 0. Also Î› (Xm,p (U))
is a closed subspace of Lp (U)w . To see this, suppose (uk, DÎ±2uk, Â· Â· Â·, DÎ±wuk) â†’
(f1, f2, Â· Â· Â·, fw) in Lp (U)w . Then uk â†’f1 in Lp (U) and DÎ±juk â†’fj in Lp (U) .
Therefore, letting Ï† âˆˆCâˆž
c (U) and letting k â†’âˆž,
R
U (DÎ±juk) Ï†dx
= (âˆ’1)|Î±| R
U ukDÎ±jÏ†dx
â†’(âˆ’1)|Î±| R
U f1DÎ±jÏ†dx
â‰¡DÎ±j (f1) (Ï†)
â†“
R
U fjÏ†dx
It follows DÎ±j (f1) = fj and so Î› (Xm,p (U)) is closed as claimed. This is clearly
also a subspace of Lp (U)w and so it follows that Î› (Xm,p (U)) is a reï¬‚exive Banach
space. This is because Lp (U)w, being the product of reï¬‚exive Banach spaces, is
reï¬‚exive and any closed subspace of a reï¬‚exive Banach space is reï¬‚exive.
Now
Î› is an isometry of Xm,p (U) and Î› (Xm,p (U)) which shows that Xm,p (U) is a
reï¬‚exive Banach space.
Finally, W m,p (U) is a closed subspace of the reï¬‚exive
Banach space, Xm,p (U) and so it is also reï¬‚exive. To see Xm,p (U) is separable,
note that Lp (U)w is separable because it is the ï¬nite product of the separable hence
completely separable metric space, Lp (U) and Î› (Xm,p (U)) is a subset of Lp (U)w .
Therefore, Î› (Xm,p (U)) is separable and since Î› is an isometry, it follows Xm,p (U)
is separable also. Now W m,p (U) must also be separable because it is a subset of
Xm,p (U) .
The following theorem is obvious but is worth noting because it says that if a
function has a weak derivative in Lp (U) on a large open set, U then the restriction
of this weak derivative is also the weak derivative for any smaller open set.
Theorem 40.4 Suppose U is an open set and U0 âŠ†U is another open set. Suppose
also DÎ±u âˆˆLp (U) . Then for all Ïˆ âˆˆCâˆž
c (U0) ,
Z
U0
(DÎ±u) Ïˆdx = (âˆ’1)|Î±|
Z
U0
u (DÎ±Ïˆ) .
The following theorem is a fundamental approximation result for functions in
Xm,p (U) .
Theorem 40.5 Let U be an open set and let U0 be an open subset of U with the
property that dist
Â¡
U0, U CÂ¢
> 0. Then if u âˆˆXm,p (U) and eu denotes the zero
extention of u oï¬€U,
lim
lâ†’âˆž||eu âˆ—Ï†l âˆ’u||Xm,p(U0) = 0.
Proof: Always assume l is large enough that 1/l < dist
Â¡
U0, U CÂ¢
. Thus for
x âˆˆU0,
eu âˆ—Ï†l (x) =
Z
B(0, 1
l )
u (x âˆ’y) Ï†l (y) dy.
(40.1)

1137
The theorem is proved if it can be shown that DÎ± (eu âˆ—Ï†l) â†’DÎ±u in Lp (U0) . Let
Ïˆ âˆˆCâˆž
c (U0)
DÎ± (eu âˆ—Ï†l) (Ïˆ)
â‰¡
(âˆ’1)|Î±|
Z
U0
(eu âˆ—Ï†l) (DÎ±Ïˆ) dx
=
(âˆ’1)|Î±|
Z
U0
Z
eu (y) Ï†l (x âˆ’y) (DÎ±Ïˆ) (x) dydx
=
(âˆ’1)|Î±|
Z
U
u (y)
Z
U0
Ï†l (x âˆ’y) (DÎ±Ïˆ) (x) dxdy.
Also,
Â³
g
DÎ±u âˆ—Ï†l
Â´
(Ïˆ)
â‰¡
Z
U0
ÂµZ
g
DÎ±u (y) Ï†l (x âˆ’y) dy
Â¶
Ïˆ (x) dx
=
Z
U0
ÂµZ
U
DÎ±u (y) Ï†l (x âˆ’y) dy
Â¶
Ïˆ (x) dx
=
Z
U0
ÂµZ
U
u (y) (DÎ±Ï†l) (x âˆ’y) dy
Â¶
Ïˆ (x) dx
=
Z
U
u (y)
Z
U0
(DÎ±Ï†l) (x âˆ’y) Ïˆ (x) dxdy
=
(âˆ’1)|Î±|
Z
U
u (y)
Z
U0
Ï†l (x âˆ’y) (DÎ±Ïˆ) (x) dxdy.
It follows that DÎ± (eu âˆ—Ï†l) =
Â³
g
DÎ±u âˆ—Ï†l
Â´
as weak derivatives deï¬ned on Câˆž
c (U0) .
Therefore,
||DÎ± (eu âˆ—Ï†l) âˆ’DÎ±u||Lp(U0)
=
Â¯Â¯Â¯
Â¯Â¯Â¯ g
DÎ±u âˆ—Ï†l âˆ’DÎ±u
Â¯Â¯Â¯
Â¯Â¯Â¯
Lp(U0)
â‰¤
Â¯Â¯Â¯
Â¯Â¯Â¯ g
DÎ±u âˆ—Ï†l âˆ’g
DÎ±u
Â¯Â¯Â¯
Â¯Â¯Â¯
Lp(Rn) â†’0.
This proves the theorem.
As part of the proof of the theorem, the following corollary was established.
Corollary 40.6 Let U0 and U be as in the above theorem. Then for all l large
enough and Ï†l a molliï¬er,
DÎ± (eu âˆ—Ï†l) =
Â³
g
DÎ±u âˆ—Ï†l
Â´
(40.2)
as distributions on Câˆž
c (U0) .
Deï¬nition 40.7 Let U be an open set. Câˆž(U) denotes the set of functions which
are deï¬ned and inï¬nitely diï¬€erentiable on U.

1138
BASIC THEORY OF SOBOLEV SPACES
Note that f (x) =
1
x is a function in Câˆž(0, 1) . However, it is not equal to
the restriction to (0, 1) of some function which is in Câˆž
c (R) . This illustrates the
distinction between Câˆž(U) and CâˆžÂ¡
U
Â¢
. The set, CâˆžÂ¡
U
Â¢
is a subset of Câˆž(U) .
The following theorem is known as the Meyer Serrin theorem.
Theorem 40.8 (Meyer Serrin) Let U be an open subset of Rn. Then if Î´ > 0 and
u âˆˆXm,p (U) , there exists J âˆˆCâˆž(U) such that ||J âˆ’u||m,p,U < Î´.
Proof: Let Â·Â·Â·Uk âŠ†Uk âŠ†Uk+1Â·Â·Â· be a sequence of open subsets of U whose union
equals U such that Uk is compact for all k. Also let Uâˆ’3 = Uâˆ’2 = Uâˆ’1 = U0 = âˆ….
Now deï¬ne Vk â‰¡Uk+1 \ Ukâˆ’1. Thus {Vk}âˆž
k=1 is an open cover of U. Note the open
cover is locally ï¬nite and therefore, there exists a partition of unity subordinate to
this open cover, {Î·k}âˆž
k=1 such that each spt (Î·k) âˆˆCc (Vk) . Let Ïˆm denote the sum
of all the Î·k which are non zero at some point of Vm. Thus
spt (Ïˆm) âŠ†Um+2 \ Umâˆ’2, Ïˆm âˆˆCâˆž
c (U) ,
âˆž
X
m=1
Ïˆm (x) = 1
(40.3)
for all x âˆˆU, and Ïˆmu âˆˆW m,p (Um+2) .
Now let Ï†l be a molliï¬er and consider
J â‰¡
âˆž
X
m=0
uÏˆm âˆ—Ï†lm
(40.4)
where lm is chosen large enough that the following two conditions hold:
spt
Â¡
uÏˆm âˆ—Ï†lm
Â¢
âŠ†Um+3 \ Umâˆ’3,
(40.5)
Â¯Â¯Â¯Â¯(uÏˆm) âˆ—Ï†lm âˆ’uÏˆm
Â¯Â¯Â¯Â¯
m,p,Um+3 =
Â¯Â¯Â¯Â¯(uÏˆm) âˆ—Ï†lm âˆ’uÏˆm
Â¯Â¯Â¯Â¯
m,p,U <
Î´
2m+5 ,
(40.6)
where 40.6 is obtained from Theorem 40.5. Because of 40.3 only ï¬nitely many terms
of the series in 40.4 are nonzero and therefore, J âˆˆCâˆž(U) . Now let N > 10, some
large value.
||J âˆ’u||m,p,UNâˆ’3
=
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
N
X
k=0
Â¡
uÏˆk âˆ—Ï†lk âˆ’uÏˆk
Â¢
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
m,p,UNâˆ’3
â‰¤
N
X
k=0
Â¯Â¯Â¯Â¯uÏˆk âˆ—Ï†lk âˆ’uÏˆk
Â¯Â¯Â¯Â¯
m,p,UNâˆ’3
â‰¤
N
X
k=0
Î´
2m+5 < Î´.
Now apply the monotone convergence theorem to conclude that ||J âˆ’u||m,p,U â‰¤Î´.
This proves the theorem.

1139
Note that J = 0 on âˆ‚U. Later on, you will see that this is pathological.
In the study of partial diï¬€erential equations it is the space W m,p (U) which is
of the most use, not the space Xm,p (U) . This is because of the density of CâˆžÂ¡
U
Â¢
.
Nevertheless, for reasonable open sets, U, the two spaces coincide.
Deï¬nition 40.9 An open set, U âŠ†Rn is said to satisfy the segment condition if
for all z âˆˆU, there exists an open set Uz containing z and a vector a such that
U âˆ©U z + ta âŠ†U
for all t âˆˆ(0, 1) .
u
z
U z
U
U z
T U + ta
You can imagine open sets which do not satisfy the segment condition.
For
example, a pair of circles which are tangent at their boundaries. The condition in
the above deï¬nition breaks down at their point of tangency.
Here is a simple lemma which will be used in the proof of the following theorem.
Lemma 40.10 If u âˆˆW m,p (U) and Ïˆ âˆˆCâˆž
c (Rn) , then uÏˆ âˆˆW m,p (U) .
Proof: Let |Î±| â‰¤m and let Ï† âˆˆCâˆž
c (U) . Then
(Dxi (uÏˆ)) (Ï†)
â‰¡
âˆ’
Z
U
uÏˆÏ†,xidx
=
âˆ’
Z
U
u
Â³
(ÏˆÏ†),xi âˆ’Ï†Ïˆ,xi
Â´
dx
=
(Dxiu) (ÏˆÏ†) +
Z
U
uÏˆ,xiÏ†dx
=
Z
U
Â¡
ÏˆDxiu + uÏˆ,xi
Â¢
Ï†dx
Therefore, Dxi (uÏˆ) = ÏˆDxiu + uÏˆ,xi âˆˆLp (U) . In other words, the product rule
holds.
Now considering the terms in the last expression, you can do the same
argument with each of these as long as they all have derivatives in Lp (U) . Therefore,
continuing this process the lemma is proved.

1140
BASIC THEORY OF SOBOLEV SPACES
Theorem 40.11 Let U be an open set and suppose there exists a locally ï¬nite
covering2 of U which is of the form {Ui}âˆž
i=1 such that each Ui is a bounded open set
which satisï¬es the conditions of Deï¬nition 40.9. Thus there exist vectors, ai such
that for all t âˆˆ(0, 1) ,
Ui âˆ©U + tai âŠ†U.
Then CâˆžÂ¡
U
Â¢
is dense in Xm,p (U) and so W m,p (U) = Xm,p (U) .
Proof: Let {Ïˆi}âˆž
i=1 be a partition of unity subordinate to the given open cover
with Ïˆi âˆˆCâˆž
c (Ui) and let u âˆˆXm,p (U) . Thus
u =
âˆž
X
k=1
Ïˆku.
Consider Uk for some k. Let ak be the special vector associated with Uk such that
tak + U âˆ©Uk âŠ†U
(40.7)
for all t âˆˆ(0, 1) and consider only t small enough that
spt (Ïˆk) âˆ’tak âŠ†Uk
(40.8)
Pick l (t) > 1/t which is also large enough that
tak + U âˆ©Uk + B
Âµ
0,
1
l (t)
Â¶
âŠ†U, spt (Ïˆk) + B
Âµ
0,
1
l (tk)
Â¶
âˆ’tak âŠ†Uk.
(40.9)
This can be done because tak +U âˆ©Uk is a compact subset of U and so has positive
distance to U C and spt (Ïˆk)âˆ’tak is a compact subset of Uk having positive distance
to U C
k . Let tk be such a value for t and for Ï†l a molliï¬er, deï¬ne
vtk (x) â‰¡
Z
Rn eu (x + tkak âˆ’y) Ïˆk (x + tkak âˆ’y) Ï†l(tk) (y) dy
(40.10)
where as usual, eu is the zero extention of u oï¬€U. For vtk (x) Ì¸= 0, it is necessary
that x + tkak âˆ’y âˆˆspt (Ïˆk) for some y âˆˆB
Â³
0,
1
l(tk)
Â´
. Therefore, using 40.9, for
vtk (x) Ì¸= 0, it is necessary that
x âˆˆy âˆ’tkak + U âˆ©spt (Ïˆk) âŠ†B
Âµ
0,
1
l (tk)
Â¶
+ spt (Ïˆk) âˆ’tkak
âŠ†B
Âµ
0,
1
l (tk)
Â¶
+ spt (Ïˆk) âˆ’tkak âŠ†Uk
2This is never a problem in Rn. In fact, every open covering has a locally ï¬nite subcovering in
Rn or more generally in any metric space due to Stoneâ€™s theorem. These are issues best left to
you in case you are interested. I am usually interested in bounded sets, U, and for these, there is
a ï¬nite covering.

1141
showing that vtk has compact support in Uk. Now change variables in 40.10 to
obtain
vtk (x) â‰¡
Z
Rn eu (y) Ïˆk (y) Ï†l(tk) (x + tkak âˆ’y) dy.
(40.11)
For x âˆˆU âˆ©Uk, the above equals zero unless
y âˆ’tkak âˆ’x âˆˆB
Âµ
0,
1
l (tk)
Â¶
which implies by 40.9 that
y âˆˆtkak + U âˆ©Uk + B
Âµ
0,
1
l (tk)
Â¶
âŠ†U
Therefore, for such x âˆˆU âˆ©Uk,40.11 reduces to
vtk (x)
=
Z
Rn u (y) Ïˆk (y) Ï†l(tk) (x + tkak âˆ’y) dy
=
Z
U
u (y) Ïˆk (y) Ï†l(tk) (x + tkak âˆ’y) dy.
It follows that for |Î±| â‰¤m, and x âˆˆU âˆ©Uk
DÎ±vtk (x)
=
Z
U
u (y) Ïˆk (y) DÎ±Ï†l(tk) (x + tkak âˆ’y) dy
=
Z
U
DÎ± (uÏˆk) (y) Ï†l(tk) (x + tkak âˆ’y) dy
=
Z
Rn
^
DÎ± (uÏˆk) (y) Ï†l(tk) (x + tkak âˆ’y) dy
=
Z
Rn
^
DÎ± (uÏˆk) (x + tkak âˆ’y) Ï†l(tk) (y) dy.
(40.12)
Actually, this formula holds for all x âˆˆU. If x âˆˆU but x /âˆˆUk, then the left
side of the above formula equals zero because, as noted above, spt (vtk) âŠ†Uk. The
integrand of the right side equals zero unless
x âˆˆB
Âµ
0,
1
l (tk)
Â¶
+ spt (Ïˆk) âˆ’tkak âŠ†Uk
by 40.9 and here x /âˆˆUk.
Next an estimate is obtained for ||DÎ±vtk âˆ’DÎ± (uÏˆk)||Lp(U) . By 40.12,
||DÎ±vtk âˆ’DÎ± (uÏˆk)||Lp(U)
â‰¤
ÂµZ
U
ÂµZ
Rn
Â¯Â¯Â¯
^
DÎ± (uÏˆk) (x + tkak âˆ’y) âˆ’
^
DÎ± (uÏˆk) (x)
Â¯Â¯Â¯ Ï†l(tk) (y) dy
Â¶p
dx
Â¶1/p
â‰¤
Z
Rn Ï†l(tk) (y)
ÂµZ
U
Â¯Â¯Â¯
^
DÎ± (uÏˆk) (x + tkak âˆ’y) âˆ’
^
DÎ± (uÏˆk) (x)
Â¯Â¯Â¯
p
dx
Â¶1/p
dy
â‰¤
Îµ
2k

1142
BASIC THEORY OF SOBOLEV SPACES
whenever tk is taken small enough. Pick tk this small and let wk â‰¡vtk. Thus
||DÎ±wk âˆ’DÎ± (uÏˆk)||Lp(U) â‰¤Îµ
2k
and wk âˆˆCâˆž
c (Rn) . Now let
J (x) â‰¡
âˆž
X
k=1
wk.
Since the Uk are locally ï¬nite and spt (wk) âŠ†Uk for each k, it follows DÎ±J =
Pâˆž
k=0 DÎ±wk and the sum is always ï¬nite. Similarly,
DÎ±
âˆž
X
k=1
(Ïˆku) =
âˆž
X
k=1
DÎ± (Ïˆku)
and the sum is always ï¬nite. Therefore,
||DÎ±J âˆ’DÎ±u||Lp(U)
=
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
âˆž
X
k=1
DÎ±wk âˆ’DÎ± (Ïˆku)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Lp(U)
â‰¤
âˆž
X
k=1
||DÎ±wk âˆ’DÎ± (Ïˆku)||Lp(U) â‰¤
âˆž
X
k=1
Îµ
2k = Îµ.
By choosing tk small enough, such an inequality can be obtained for
Â¯Â¯Â¯Â¯DÎ²J âˆ’DÎ²u
Â¯Â¯Â¯Â¯
Lp(U)
for each multi index, Î² such that |Î²| â‰¤m. Therefore, there exists J âˆˆCâˆž
c (Rn)
such that
||J âˆ’u||W m,p(U) â‰¤ÎµK
where K equals the number of multi indices no larger than m. Since Îµ is arbitrary,
this proves the theorem.
Corollary 40.12 Let U be an open set which has the segment property.
Then
W m,p (U) = Xm,p (U) .
Proof: Start with an open covering of U whose sets satisfy the segment condition
and obtain a locally ï¬nite reï¬nement consisting of bounded sets which are of the
sort in the above theorem.
Now consider a situation where h : U â†’V where U and V are two open sets
in Rn and DÎ±h exists and is continuous and bounded if |Î±| < m âˆ’1 and DÎ±h is
Lipschitz if |Î±| = m âˆ’1.
Deï¬nition 40.13 Whenever h : U â†’V, deï¬ne hâˆ—mapping the functions which
are deï¬ned on V to the functions which are deï¬ned on U as follows.
hâˆ—f (x) â‰¡f (h (x)) .
h : U â†’V is bilipschitz if h is one to one, onto and Lipschitz and hâˆ’1 is also one
to one, onto and Lipschitz.

1143
Theorem 40.14 Let h : U â†’V be one to one and onto where U and V are two
open sets. Also suppose that DÎ±h and DÎ± Â¡
hâˆ’1Â¢
exist and are Lipschitz continuous
if |Î±| â‰¤m âˆ’1 for m a positive integer. Then
hâˆ—: W m,p (V ) â†’W m,p (U)
is continuous, linear, one to one, and has an inverse with the same properties, the
inverse being
Â¡
hâˆ’1Â¢âˆ—.
Proof: It is clear that hâˆ—is linear. It is required to show it is one to one and
continuous. First suppose hâˆ—f = 0. Then
0 =
Z
V
|f (h (x))|p dx
and so f (h (x)) = 0 for a.e. x âˆˆU. Since h is Lipschitz, it takes sets of measure
zero to sets of measure zero. Therefore, f (y) = 0 a.e. This shows hâˆ—is one to one.
By the Meyer Serrin theorem, Theorem 40.8, it suï¬ƒces to verify that hâˆ—is
continuous on functions in Câˆž(V ) . Let f be such a function. Then using the chain
rule and product rule, (hâˆ—f),i (x) = f,k (h (x)) hk,i (x) ,
(hâˆ—f),ij (x)
=
(f,k (h (x)) hk,i (x)),j
=
f,kl (h (x)) hl,j (x) hk,i (x) + f,k (h (x)) hk,ij (x)
etc. In general, for |Î±| â‰¤m âˆ’1, succsessive applications of the product rule and
chain rule yield that DÎ± (hâˆ—f) (x) has the form
DÎ± (hâˆ—f) (x) =
X
|Î²|â‰¤|Î±|
hâˆ—Â¡
DÎ²f
Â¢
(x) gÎ² (x)
where gÎ² is a bounded Lipschitz function with Lipschitz constant dependent on h
and its derivatives. It only remains to take one more derivative of the functions,
DÎ±f for |Î±| = m âˆ’1.
This can be done again but this time you have to use
Rademacherâ€™s theorem which assures you that the derivative of a Lipschitz function
exists a.e. in order to take the partial derivative of the gÎ² (x) . When this is done,
the above formula remains valid for all |Î±| â‰¤m. Therefore, using the change of
variables formula for multiple integrals, Corollary 37.31 on Page 1101,
Z
U
|DÎ± (hâˆ—f) (x)|p dx
â‰¤
Cm,p,h
X
|Î²|â‰¤m
Z
U
Â¯Â¯hâˆ—Â¡
DÎ²f
Â¢
(x)
Â¯Â¯p dx
=
Cm,p,h
X
|Î²|â‰¤m
Z
U
Â¯Â¯Â¡
DÎ²f
Â¢
(h (x))
Â¯Â¯p dx
=
Cm,p,h
X
|Î²|â‰¤m
Z
V
Â¯Â¯Â¡
DÎ²f
Â¢
(y)
Â¯Â¯p Â¯Â¯det Dhâˆ’1 (y)
Â¯Â¯ dy
â‰¤
Cm,p,h,hâˆ’1 ||f||m,p,V
This shows hâˆ—is continuous on Câˆž(V ) âˆ©W m,p (U) and since this set is dense,
this proves hâˆ—is continuous. The same argument applies to
Â¡
hâˆ’1Â¢âˆ—and now the
deï¬nitions of hâˆ—and
Â¡
hâˆ’1Â¢âˆ—show these are inverses.

1144
BASIC THEORY OF SOBOLEV SPACES
40.1
Embedding Theorems For W m,p (Rn)
Recall Theorem 37.15 which is listed here for convenience.
Theorem 40.15 Suppose u, u,i âˆˆLp
loc (Rn) for i = 1, Â· Â· Â·, n and p > n. Then u has
a representative, still denoted by u, such that for all x, y âˆˆRn,
|u (x) âˆ’u (y)| â‰¤C
ÃƒZ
B(x,2|yâˆ’x|)
|âˆ‡u|pdz
!1/p
|x âˆ’y|(1âˆ’n/p).
(40.13)
This amazing result shows that every u âˆˆW m,p (Rn) has a representative which
is continuous provided p > n.
Using the above inequality, one can give an important embedding theorem.
Deï¬nition 40.16 Let X, Y be two Banach spaces and let f : X â†’Y be a function.
Then f is a compact map if whenever S is a bounded set in X, it follows that f (S)
is precompact in Y .
Theorem 40.17 Let U be a bounded open set and for u a function deï¬ned on Rn,
let rUu (x) â‰¡u (x) for x âˆˆU. Then if p > n, rU : W 1,p (Rn) â†’C
Â¡
U
Â¢
is continuous
and compact.
Proof: First suppose uk â†’0 in W 1,p (Rn) . Then if rUuk does not converge
to 0, it follows there exists a sequence, still denoted by k and Îµ > 0 such that
uk â†’0 in W 1,p (Rn) but ||rUuk||âˆžâ‰¥Îµ. Selecting a further subsequence which is
still denoted by k, you can also assume uk (x) â†’0 a.e. Pick such an x0 âˆˆU where
this convergence takes place. Then from 40.13, for all x âˆˆU,
|uk (x)| â‰¤|uk (x0)| + C ||uk||1,p,Rn diam (U)
showing that uk converges uniformly to 0 on U contrary to ||rUuk||âˆžâ‰¥Îµ. Therefore,
rU is continuous as claimed.
Next let S be a bounded subset of W 1,p (Rn) with ||u||1,p < M for all u âˆˆS.
Then for u âˆˆS
rpmn ([|u| > r] âˆ©U) â‰¤
Z
[|u|>r]âˆ©U
|u|p dmn â‰¤M p
and so
mn ([|u| > r] âˆ©U) â‰¤M p
rp .
Now choosing r large enough, M p/rp < mn (U) and so, for such r, there exists
xu âˆˆU such that |u (xu)| â‰¤r. Therefore from 40.13, whenever x âˆˆU,
|u (x)|
â‰¤
|u (xu)| + CM diam (U)1âˆ’n/p
â‰¤
r + CM diam (U)1âˆ’n/p

40.1.
EMBEDDING THEOREMS FOR W M,P Â¡
RNÂ¢
1145
showing that {rUu : u âˆˆS} is uniformly bounded.
But also, for x, y âˆˆU,40.13
implies
|u (x) âˆ’u (y)| â‰¤CM |x âˆ’y|1âˆ’n
p
showing that {rUu : u âˆˆS} is equicontinuous. By the Ascoli Arzela theorem, it
follows rU (S) is precompact and so rU is compact.
Deï¬nition 40.18 Let Î± âˆˆ(0, 1] and K a compact subset of Rn
CÎ± (K) â‰¡{f âˆˆC (K) : ÏÎ± (f) + ||f|| â‰¡||f||Î± < âˆž}
where
||f|| â‰¡||f||âˆžâ‰¡sup{|f (x)| : x âˆˆK}
and
ÏÎ± (f) â‰¡sup
Â½|f (x) âˆ’f (y)|
|x âˆ’y|Î±
: x, y âˆˆK, x Ì¸= y
Â¾
.
Then (CÎ± (K) , ||Â·||Î±) is a complete normed linear space called a Holder space.
The veriï¬cation that this is a complete normed linear space is routine and is left
for you. More generally, one considers the following class of Holder spaces.
Deï¬nition 40.19 Let K be a compact subset of Rn and let Î» âˆˆ(0, 1]. Cm,Î» (K)
denotes the set of functions, u which are restrictions of functions deï¬ned on Rn to
Ksuch that for |Î±| â‰¤m,
DÎ±u âˆˆC (K)
and if |Î±| = m,
DÎ±u âˆˆCÎ» (K) .
Thus C0,Î» (K) = CÎ» (K) . The norm of a function in Cm,Î» (K) is given by
||u||m,Î» â‰¡sup
|Î±|=m
ÏÎ» (DÎ±u) +
X
|Î±|â‰¤m
||DÎ±u||âˆž.
Lemma 40.20 Let m be a positive integer, K a compact subset of Rn, and let
0 < Î² < Î» â‰¤1. Then the identity map from Cm,Î» (K) into Cm,Î² (K) is compact.
Proof: First note that the containment is obvious because for any function, f,
if
ÏÎ» (f) â‰¡sup
(
|f (x) âˆ’f (y)|
|x âˆ’y|Î»
: x, y âˆˆK, x Ì¸= y
)
< âˆž,
Then
ÏÎ² (f)
â‰¡
sup
(
|f (x) âˆ’f (y)|
|x âˆ’y|Î²
: x, y âˆˆK, x Ì¸= y
)
=
sup
(
|f (x) âˆ’f (y)|
|x âˆ’y|Î»
|x âˆ’y|Î»âˆ’Î² : x, y âˆˆK, x Ì¸= y
)
â‰¤
sup
(
|f (x) âˆ’f (y)|
|x âˆ’y|Î»
diam (K)Î»âˆ’Î² : x, y âˆˆK, x Ì¸= y
)
< âˆž.

1146
BASIC THEORY OF SOBOLEV SPACES
Suppose the identity map, id, is not compact. Then there exists Îµ > 0 and a
sequence, {fk}âˆž
k=1 âŠ†Cm,Î» (K) such that ||fk||m,Î» < M for all k but ||fk âˆ’fl||Î² â‰¥Îµ
whenever k Ì¸= l. By the Ascoli Arzela theorem, there exists a subsequence of this,
still denoted by fk such that P
|Î±|â‰¤m ||DÎ± (fl âˆ’fk)||âˆž< Î´ where Î´ satisï¬es
0 < Î´ < min
ÂµÎµ
2,
Â³Îµ
8
Â´ Â³ Îµ
8M
Â´Î²/(Î»âˆ’Î²)Â¶
.
(40.14)
Therefore, sup|Î±|=m ÏÎ² (DÎ± (fk âˆ’fl)) â‰¥Îµâˆ’Î´ for all k Ì¸= l. It follows that there exist
pairs of points and a multi index, Î± with |Î±| = m, {xkl, ykl, Î±} such that
Îµ âˆ’Î´
2
< |(DÎ±fk âˆ’DÎ±fl) (xkl) âˆ’((DÎ±fk âˆ’DÎ±fl) (ykl))|
|xkl âˆ’ykl|Î²
â‰¤2M |xkl âˆ’ykl|Î»âˆ’Î²
(40.15)
and so considering the ends of the above inequality,
ÂµÎµ âˆ’Î´
4M
Â¶1/(Î»âˆ’Î²)
< |xkl âˆ’ykl| .
Now also, since P
|Î±|â‰¤m ||DÎ± (fl âˆ’fk)||âˆž< Î´, it follows from the ï¬rst inequality in
40.15 that
Îµ âˆ’Î´
2
<
2Î´
Â¡ Îµâˆ’Î´
4M
Â¢Î²/(Î»âˆ’Î²) .
Since Î´ < Îµ/2, this implies
Îµ
4 <
2Î´
Â¡ Îµ
8M
Â¢Î²/(Î»âˆ’Î²)
and so
Â³Îµ
8
Â´ Â³ Îµ
8M
Â´Î²/(Î»âˆ’Î²)
< Î´
contrary to 40.14. This proves the lemma.
Corollary 40.21 Let p > n, U and rU be as in Theorem 40.17 and let m be a
nonnegative integer. Then rU : W m+1,p (Rn) â†’Cm,Î» Â¡
U
Â¢
is continuous as a map
into Cm,Î» Â¡
U
Â¢
for all Î» âˆˆ[0, 1 âˆ’n
p ] and rU is compact if Î» < 1 âˆ’n
p .
Proof: Suppose uk â†’0 in W m+1,p (Rn) . Then from 40.13, if Î» â‰¤1 âˆ’n
p and
|Î±| = m
ÏÎ» (DÎ±uk) â‰¤C ||DÎ±uk||1,p diam (U)1âˆ’n
p âˆ’Î» .
Therefore, ÏÎ» (DÎ±uk) â†’0. From Theorem 40.17 it follows that for |Î±| â‰¤m,
||DÎ±uk||âˆžâ†’0
and so ||uk||m,Î» â†’0. This proves the claim about continuity. The claim about
compactness for Î» < 1 âˆ’n
p follows from Lemma 40.20 and this.
(Bounded in W m,p (Rn)
rU
â†’Bounded in Cm,1âˆ’n
p Â¡
U
Â¢ id
â†’Compact in Cm,Î» Â¡
U
Â¢
.)
It is just as important to consider the case where p < n. To do this case the
following lemma due to Gagliardo [23] will be of interest. See also [1].

40.1.
EMBEDDING THEOREMS FOR W M,P Â¡
RNÂ¢
1147
Lemma 40.22 Suppose n â‰¥2 and wj does not depend on the jth component of x,
xj. Then
Z
Rn
n
Y
j=1
|wj (x)| dmn â‰¤
n
Y
i=1
ÂµZ
Rnâˆ’1 |wj (x)|nâˆ’1 dmnâˆ’1
Â¶1/(nâˆ’1)
.
In this inequality, assume all the functions are continuous so there can be no mea-
surability questions.
Proof: First note that for n = 2 the inequality reduces to the statement
Z Z
|w1 (x2)| |w2 (x1)| dx1dx2 â‰¤
Z
|w1 (x2)| dx2
Z
|w2 (x1)| dx1
which is obviously true. Suppose then that the inequality is valid for some n. Using
Fubiniâ€™s theorem, Holderâ€™s inequality, and the induction hypothesis,
Z
Rn+1
n+1
Y
j=1
|wj (x)| dmn+1
=
Z
R
Z
Rn |wn+1 (x)|
n
Y
j=1
|wj (x)| dmndxn+1
=
Z
Rn |wn+1 (x)|
Z
R
n
Y
j=1
|wj (x)| dxn+1dmn
=
Z
Rn |wn+1 (x)|
ï£«
ï£­
n
Y
j=1
Z
R
|wj (x)|n dxn+1
ï£¶
ï£¸
1/n
dmn
=
Z
Rn |wn+1 (x)|
n
Y
j=1
ÂµZ
R
|wj (x)|n dxn+1
Â¶1/n
dmn
â‰¤
ÂµZ
Rn |wn+1 (x)|n dmn
Â¶1/n
Â·
ï£«
ï£¬
ï£­
Z
Rn
ï£«
ï£­
n
Y
j=1
ÂµZ
R
|wj (x)|n dxn+1
Â¶1/n
ï£¶
ï£¸
n/(nâˆ’1)
dmn
ï£¶
ï£·
ï£¸
(nâˆ’1)/n
=
ÂµZ
Rn |wn+1 (x)|n dmn
Â¶1/n
Â·
ï£«
ï£­
Z
Rn
n
Y
j=1
ÂµZ
R
|wj (x)|n dxn+1
Â¶1/(nâˆ’1)
dmn
ï£¶
ï£¸
(nâˆ’1)/n

1148
BASIC THEORY OF SOBOLEV SPACES
â‰¤
ÂµZ
Rn |wn+1 (x)|n dmn
Â¶1/n
Â·
ï£«
ï£­
n
Y
j=1
ÂµZ
Rnâˆ’1
ÂµZ
R
|wj (x)|n dxn+1
Â¶
dmnâˆ’1
Â¶1/(nâˆ’1)
ï£¶
ï£¸
(nâˆ’1)/n
=
ÂµZ
Rn |wn+1 (x)|n dmn
Â¶1/n
n
Y
j=1
ÂµZ
Rn |wj (x)|n dmn
Â¶1/n
=
n+1
Y
j=1
ÂµZ
Rn |wj (x)|n dmn
Â¶1/n
This proves the lemma.
Lemma 40.23 If Ï† âˆˆCâˆž
c (Rn) and n â‰¥1, then
||Ï†||n/(nâˆ’1) â‰¤
1
nâˆšn
n
X
j=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚Ï†
âˆ‚xj
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
.
Proof:
The case where n = 1 is obvious if n/ (n âˆ’1) is interpreted as âˆž.
Assume then that n > 1 and note that for ai â‰¥0,
n
n
Y
i=1
ai â‰¤
ï£«
ï£­
n
X
j=1
ai
ï£¶
ï£¸
n
In fact, the term on the left is one of many terms of the expression on the right.
Therefore, taking nth roots
n
Y
i=1
a1/n
i
â‰¤
1
nâˆšn
n
X
j=1
ai.
Then observe that for each j = 1, 2, Â· Â· Â·, n,
|Ï† (x)| â‰¤
Z âˆž
âˆ’âˆž
Â¯Â¯Ï†,j (x)
Â¯Â¯ dxj
so
||Ï†||n/(nâˆ’1)
n/(nâˆ’1) â‰¡
Z
Rn |Ï† (x)|n/(nâˆ’1) dmn
â‰¤
Z
Rn
n
Y
j=1
ÂµZ âˆž
âˆ’âˆž
Â¯Â¯Ï†,j (x)
Â¯Â¯ dxj
Â¶1/(nâˆ’1)
dmn
and from Lemma 40.22 this is dominated by
â‰¤
n
Y
j=1
ÂµZ
Rn
Â¯Â¯Ï†,j (x)
Â¯Â¯ dmn
Â¶1/(nâˆ’1)
.

40.1.
EMBEDDING THEOREMS FOR W M,P Â¡
RNÂ¢
1149
Hence Qn
i=1 a1/n
i
â‰¤
1
nâˆšn
Pn
j=1 ai
||Ï†||n/(nâˆ’1)
â‰¤
n
Y
j=1
ÂµZ
Rn
Â¯Â¯Ï†,j (x)
Â¯Â¯ dmn
Â¶1/n
â‰¤
1
nâˆšn
n
X
j=1
Z
Rn
Â¯Â¯Ï†,j (x)
Â¯Â¯ dmn
=
1
nâˆšn
n
X
j=1
Â¯Â¯Â¯Â¯Ï†,i
Â¯Â¯Â¯Â¯
1
and this proves the lemma.
The above lemma is due to Gagliardo and Nirenberg.
With this lemma, it is possible to prove a major embedding theorem which
follows.
Theorem 40.24 Let 1 â‰¤p < n and 1
q = 1
p âˆ’1
n. Then if f âˆˆW 1,p (Rn) ,
||f||q â‰¤
1
nâˆšn
(n âˆ’1) p
n âˆ’p
||f||1,p,Rn .
Proof:
From the deï¬nition of W 1,p (Rn) , C1
c (Rn) is dense in W 1,p.
Here
C1
c (Rn) is the space of continuous functions having continuous derivatives which
have compact support. The desired inequality will be established for such Ï† and
then the density of this set in W 1,p (Rn) will be exploited to obtain the inequality
for all f âˆˆW 1,p (Rn). First note that the case where p = 1 follows immediately
from the above lemma and so it is only necessary to consider the case where p > 1.
Let Ï† âˆˆC1
c (Rn) and consider |Ï†|r where r > 1. Then a short computation shows
|Ï†|r âˆˆC1
c (Rn) and
Â¯Â¯Â¯|Ï†|r
,i
Â¯Â¯Â¯ = r |Ï†|râˆ’1 Â¯Â¯Ï†,i
Â¯Â¯ .
Therefore, from Lemma 40.23,
ÂµZ
|Ï†|
rn
nâˆ’1 dmn
Â¶(nâˆ’1)/n
â‰¤
r
nâˆšn
n
X
i=1
Z
|Ï†|râˆ’1 Â¯Â¯Ï†,i
Â¯Â¯ dmn
â‰¤
r
nâˆšn
n
X
i=1
ÂµZ Â¯Â¯Ï†,i
Â¯Â¯p
Â¶1/p ÂµZ Â³
|Ï†|râˆ’1Â´p/(pâˆ’1)
dmn
Â¶(pâˆ’1)/p
.
Now choose r such that
(r âˆ’1) p
p âˆ’1
=
rn
n âˆ’1.

1150
BASIC THEORY OF SOBOLEV SPACES
That is, let r = p(nâˆ’1)
nâˆ’p
> 1 and so
rn
nâˆ’1 =
np
nâˆ’p. Then this reduces to
ÂµZ
|Ï†|
np
nâˆ’p dmn
Â¶(nâˆ’1)/n
â‰¤
r
nâˆšn
n
X
i=1
ÂµZ Â¯Â¯Ï†,i
Â¯Â¯p
Â¶1/p ÂµZ
|Ï†|
np
nâˆ’p dmn
Â¶(pâˆ’1)/p
.
Also, nâˆ’1
n
âˆ’pâˆ’1
p
= nâˆ’p
np and so, dividing both sides by the last term yields
ÂµZ
|Ï†|
np
nâˆ’p dmn
Â¶ nâˆ’p
np
â‰¤
r
nâˆšn
n
X
i=1
ÂµZ Â¯Â¯Ï†,i
Â¯Â¯p
Â¶1/p
â‰¤
r
nâˆšn ||Ï†||1,p,Rn .
Letting q =
np
nâˆ’p, it follows 1
q = nâˆ’p
np = 1
p âˆ’1
n and
||Ï†||q â‰¤
r
nâˆšn ||Ï†||1,p,Rn .
Now let f âˆˆW m,p (Rn) and let ||Ï†k âˆ’f||1,p,Rn â†’0 as k â†’âˆž. Taking another
subsequence, if necessary, you can also assume Ï†k (x) â†’f (x) a.e. Therefore, by
Fatouâ€™s lemma,
||f||q
â‰¤
lim inf
kâ†’âˆž
ÂµZ
Rn |Ï†k (x)|q dmn
Â¶1/q
â‰¤
lim inf
kâ†’âˆž
r
nâˆšn ||Ï†k||1,p,Rn = ||f||1,p,Rn .
This proves the theorem.
Corollary 40.25 Suppose mp < n. Then W m,p (Rn) âŠ†Lq (Rn) where q =
np
nâˆ’mp
and the identity map, id : W m,p (Rn) â†’Lq (Rn) is continuous.
Proof: This is true if m = 1 according to Theorem 40.24. Suppose it is true for
m âˆ’1 where m > 1. If u âˆˆW m,p (Rn) and |Î±| â‰¤1, then DÎ±u âˆˆW mâˆ’1,p (Rn) so by
induction, for all such Î±,
DÎ±u âˆˆL
np
nâˆ’(mâˆ’1)p (Rn) .
Thus u âˆˆW 1,q1 (Rn) where
q1 =
np
n âˆ’(m âˆ’1) p
By Theorem 40.24, it follows that u âˆˆLq (Rn) where
1
q = n âˆ’(m âˆ’1) p
np
âˆ’1
n = n âˆ’mp
np
.
This proves the corollary.
There is another similar corollary of the same sort which is interesting and useful.

40.1.
EMBEDDING THEOREMS FOR W M,P Â¡
RNÂ¢
1151
Corollary 40.26 Suppose m â‰¥1 and j is a nonnegative integer satisfying jp < n.
Then
W m+j,p (Rn) âŠ†W m,q (Rn)
for
q â‰¡
np
n âˆ’jp
(40.16)
and the identity map is continuous.
Proof: If |Î±| â‰¤m, then DÎ±u âˆˆW j,p (Rn) and so by Corollary 40.25, DÎ±u âˆˆ
Lq (Rn) where q is given above. This means u âˆˆW m,q (Rn).
The above corollaries imply yet another interesting corollary which involves em-
beddings in the Holder spaces.
Corollary 40.27 Suppose jp < n < (j + 1) p and let m be a positive integer. Let
U be any bounded open set in Rn. Then letting rU denote the restriction to U,
rU : W m+j,p (Rn) â†’Cmâˆ’1,Î» Â¡
U
Â¢
is continuous for every Î» â‰¤Î»0 â‰¡(j + 1) âˆ’n
p and
if Î» < (j + 1) âˆ’n
p , then rU is compact.
Proof: From Corollary 40.26 W m+j,p (Rn) âŠ†W m,q (Rn) where q is given by
40.16. Therefore,
np
n âˆ’jp > n
and so by Corollary 40.21, W m,q (Rn) âŠ†Cmâˆ’1,Î» Â¡
U
Â¢
for all Î» satisfying
0 < Î» < 1 âˆ’(n âˆ’jp) n
np
= p (j + 1) âˆ’n
p
= (j + 1) âˆ’n
p .
The assertion about compactness follows from the compactness of the embedding
of Cmâˆ’1,Î»0 Â¡
U
Â¢
into Cmâˆ’1,Î» Â¡
U
Â¢
for Î» < Î»0. See Lemma 40.20.
There are other embeddings of this sort available. You should see Adams [1] for a
more complete listing of these. Next are some theorems about compact embeddings.
This requires some consideration of which subsets of Lp (U) are compact. The main
theorem is the following. See [1].
Theorem 40.28 Let K be a bounded subset of Lp (U) and suppose that for all
Îµ > 0, there exist a Î´ > 0 such that if |h| < Î´, then
Z
Rn |eu (x + h) âˆ’eu (x)|p dx < Îµp
(40.17)
Suppose also that for each Îµ > 0 there exists an open set, G âŠ†U such that G is
compact and for all u âˆˆK,
Z
U\G
|u (x)|p dx < Îµp
(40.18)
Then K is precompact in Lp (Rn).

1152
BASIC THEORY OF SOBOLEV SPACES
Proof: To save fussing ï¬rst consider the case where U = Rn so that eu = u.
Suppose the two conditions hold and let Ï†k be a molliï¬er of the form Ï†k (x) =
knÏ† (kx) where spt (Ï†) âŠ†B (0, 1) . Consider
Kk â‰¡{u âˆ—Ï†k : u âˆˆK} .
and verify the conditions for the Ascoli Arzela theorem for these functions deï¬ned
on G. Say ||u||p â‰¤M for all u âˆˆK.
First of all, for u âˆˆK and x âˆˆRn,
|u âˆ—Ï†k (x)|p
â‰¤
ÂµZ
|u (x âˆ’y) Ï†k (y)| dy
Â¶p
=
ÂµZ
|u (y) Ï†k (x âˆ’y)| dy
Â¶p
â‰¤
Z
|u (y)|p Ï†k (x âˆ’y) dy
â‰¤
Âµ
sup
zâˆˆRn Ï†k (z)
Â¶ Z
|u (y)| dy â‰¤M
Âµ
sup
zâˆˆRn Ï†k (z)
Â¶
showing the functions in Kk are uniformly bounded.
Next suppose x, x1 âˆˆKk and consider
|u âˆ—Ï†k (x) âˆ’u âˆ—Ï†k (x1)|
â‰¤
Z
|u (x âˆ’y) âˆ’u (x1âˆ’y)| Ï†k (y) dy
â‰¤
ÂµZ
|u (x âˆ’y) âˆ’u (x1âˆ’y)|p dy
Â¶1/p ÂµZ
Ï†k (y)q dy
Â¶q
which by assumption 40.17 is small independent of the choice of u whenever |x âˆ’x1|
is small enough.
Note that k is ï¬xed in the above.
Therefore, the set, Kk is
precompact in C
Â¡
G
Â¢
thanks to the Ascoli Arzela theorem. Next consider how well
u âˆˆK is approximated by u âˆ—Ï†k in Lp (Rn) . By Minkowskiâ€™s inequality,
ÂµZ
|u (x) âˆ’u âˆ—Ï†k (x)|p dx
Â¶1/p
â‰¤
ÂµZ ÂµZ
|u (x) âˆ’u (x âˆ’y)| Ï†k (y) dy
Â¶p
dx
Â¶1/p
â‰¤
Z
B(0, 1
k)
Ï†k (y)
ÂµZ
|u (x) âˆ’u (x âˆ’y)|p dx
Â¶1/p
dy.
Now let Î· > 0 be given. From 40.17 there exists k large enough that for all u âˆˆK,
Z
B(0, 1
k)
Ï†k (y)
ÂµZ
|u (x) âˆ’u (x âˆ’y)|p dx
Â¶1/p
dy â‰¤
Z
B(0, 1
k)
Ï†k (y) Î· dy = Î·.

40.1.
EMBEDDING THEOREMS FOR W M,P Â¡
RNÂ¢
1153
Now let Îµ > 0 be given and let Î´ and G correspond to Îµ as given in the hypotheses
and let 1/k < Î´ and also k is large enough that for all u âˆˆK,
||u âˆ’u âˆ—Ï†k||p < Îµ
as in the above inequality. By the Ascoli Arzela theorem there exists an
Ãƒ
Îµ
m
Â¡
G + B (0, 1)
Â¢
!1/p
net for Kk in C
Â¡
G
Â¢
. That is, there exist {ui}m
i=1 âŠ†K such that for any u âˆˆK,
||u âˆ—Ï†k âˆ’uj âˆ—Ï†k||âˆž<
Ãƒ
Îµ
m
Â¡
G + B (0, 1)
Â¢
!1/p
for some j. Letting u âˆˆK be given, let uj âˆˆ{ui}m
i=1 âŠ†K be such that the above
inequality holds. Then
||u âˆ’uj||p
â‰¤
||u âˆ’u âˆ—Ï†k||p + ||u âˆ—Ï†k âˆ’uj âˆ—Ï†k||p + ||uj âˆ—Ï†k âˆ’uj||p
<
2Îµ + ||u âˆ—Ï†k âˆ’uj âˆ—Ï†k||p
â‰¤
2Îµ +
ÃƒZ
G+B(0,1)
|u âˆ—Ï†k âˆ’uj âˆ—Ï†k|p dx
!1/p
+
ÃƒZ
Rn\(G+B(0,1))
|u âˆ—Ï†k âˆ’uj âˆ—Ï†k|p dx
!1/p
â‰¤
2Îµ + Îµ1/p
+
ÃƒZ
Rn\(G+B(0,1))
ÂµZ
|u (x âˆ’y) âˆ’uj (x âˆ’y)| Ï†k (y) dy
Â¶p
dx
!1/p
â‰¤
2Îµ + Îµ1/p
+
Z
Ï†k (y)
ÃƒZ
Rn\(G+B(0,1))
(|u (x âˆ’y)| + |uj (x âˆ’y)|)p dx
!1/p
dy
â‰¤
2Îµ + Îµ1/p +
Z
Ï†k (y)
ÃƒZ
Rn\G
(|u (x)| + |uj (x)|)p dx
!1/p
dy
â‰¤
2Îµ + Îµ1/p + 2pâˆ’1
Z
Ï†k (y)
ÃƒZ
Rn\G
(|u (x)|p + |uj (x)|p) dx
!1/p
dy
â‰¤
2Îµ + Îµ1/p + 2pâˆ’121/pÎµ

1154
BASIC THEORY OF SOBOLEV SPACES
and since Îµ > 0 is arbitrary, this shows that K is totally bounded and is therefore
precompact.
Now for an arbitrary open set, U and K given in the hypotheses of the theorem,
let eK â‰¡{eu : u âˆˆK} and observe that eK is precompact in Lp (Rn) . But this is the
same as saying that K is precompact in Lp (U) . This proves the theorem.
Actually the converse of the above theorem is also true [1] but this will not be
needed so I have left it as an exercise for anyone interested.
Lemma 40.29 Let u âˆˆW 1,1 (U) for U an open set and let Ï† âˆˆCâˆž
c (U) . Then
there exists a constant,
C
Â³
Ï†, ||u||1,1,U
Â´
,
depending only on the indicated quantities such that whenever v âˆˆRn with |v| <
dist
Â¡
spt (Ï†) , U CÂ¢
, it follows that
Z
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯ dx â‰¤C
Â³
Ï†, ||u||1,1,U
Â´
|v| .
Proof: First suppose u âˆˆCâˆžÂ¡
U
Â¢
. Then for any x âˆˆspt (Ï†) âˆª(spt (Ï†) âˆ’v) â‰¡
Gv, the chain rule implies
|Ï†u (x + v) âˆ’Ï†u (x)|
â‰¤
Z 1
0
n
X
i=1
Â¯Â¯Â¯(Ï†u),i (x + tv) vi
Â¯Â¯Â¯ dt
â‰¤
Z 1
0
n
X
i=1
Â¯Â¯Â¡
Ï†,iu + u,iÏ†
Â¢
(x + tv)
Â¯Â¯ dt |v| .
Therefore, for such u,
Z
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯ dx
=
Z
Gv
|Ï†u (x + v) âˆ’Ï†u (x)| dx
â‰¤
Z
Gv
Z 1
0
n
X
i=1
Â¯Â¯Â¡
Ï†,iu + u,iÏ†
Â¢
(x + tv)
Â¯Â¯ dtdx |v|
â‰¤
Z 1
0
Z
Gv
n
X
i=1
Â¯Â¯Â¡
Ï†,iu + u,iÏ†
Â¢
(x + tv)
Â¯Â¯ dxdt |v|
â‰¤
C
Â³
Ï†, ||u||1,1,U
Â´
|v|

40.1.
EMBEDDING THEOREMS FOR W M,P Â¡
RNÂ¢
1155
where C is a continuous function of ||u||1,1,U. Now for general u âˆˆW 1,1 (U) , let
uk â†’u in W 1,1 (U) where uk âˆˆCâˆžÂ¡
U
Â¢
. Then for |v| < dist
Â¡
spt (Ï†) , U CÂ¢
,
Z
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯ dx
=
Z
Gv
|Ï†u (x + v) âˆ’Ï†u (x)| dx
=
lim
kâ†’âˆž
Z
Gv
|Ï†uk (x + v) âˆ’Ï†uk (x)| dx
â‰¤
lim
kâ†’âˆžC
Â³
Ï†, ||uk||1,1,U
Â´
|v|
=
C
Â³
Ï†, ||u||1,1,U
Â´
|v| .
This proves the lemma.
Lemma 40.30 Let U be a bounded open set and deï¬ne for p > 1
S â‰¡
n
u âˆˆW 1,1 (U) âˆ©Lp (U) : ||u||1,1,U + ||u||Lp(U) â‰¤M
o
(40.19)
and let Ï† âˆˆCâˆž
c (U) and
S1 â‰¡{uÏ† : u âˆˆS} .
(40.20)
Then S1 is precompact in Lq (U) where 1 â‰¤q < p.
Proof: This depends on Theorem 40.28. The second condition is satisï¬ed by
taking G â‰¡spt (Ï†). Thus, for w âˆˆS1,
Z
U\G
|w (x)|q dx = 0 < Îµp.
It remains to satisfy the ï¬rst condition. It is necessary to verify there exists Î´ > 0
such that if |v| < Î´, then
Z
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯
q
dx < Îµp.
(40.21)
Let spt (Ï†) âˆª(spt (Ï†) âˆ’v) â‰¡Gv. Now if h is any measurable function, and if
Î¸ âˆˆ(0, 1) is chosen small enough that Î¸q < 1,
Z
Gv
|h|q dx
=
Z
Gv
|h|Î¸q |h|(1âˆ’Î¸)q dx
â‰¤
ÂµZ
Gv
|h| dx
Â¶Î¸q ÂµZ
Gv
Â³
|h|(1âˆ’Î¸)qÂ´
1
1âˆ’Î¸q Â¶1âˆ’Î¸q
=
ÂµZ
Gv
|h| dx
Â¶Î¸q ÂµZ
Gv
|h|
(1âˆ’Î¸)q
1âˆ’Î¸q
Â¶1âˆ’Î¸q
.
(40.22)

1156
BASIC THEORY OF SOBOLEV SPACES
Now let Î¸ also be small enough that there exists r > 1 such that
r(1 âˆ’Î¸) q
1 âˆ’Î¸q
= p
and use Holderâ€™s inequality in the last factor of the right side of 40.22. Then 40.22
is dominated by
ÂµZ
Gv
|h| dx
Â¶Î¸q ÂµZ
Gv
|h|p
Â¶ 1âˆ’Î¸q
r
ÂµZ
Gv
1dx
Â¶1/râ€²
=
C
Â³
||h||Lp(Gv) , mn (Gv)
Â´ ÂµZ
Gv
|h| dx
Â¶Î¸q
.
Therefore, for u âˆˆS,
Z
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯
q
dx =
Z
Gv
|Ï†u (x + v) âˆ’Ï†u (x)|q dx
â‰¤C
Â³
||Ï†u (Â·+v) âˆ’Ï†u (Â·)||Lp(Gv) , mn (Gv)
Â´ ÂµZ
Gv
|Ï†u (x + v) âˆ’Ï†u (x)| dx
Â¶Î¸q
â‰¤C
Â³
2 ||Ï†u (Â·)||Lp(U) , mn (U)
Â´ ÂµZ
Gv
|Ï†u (x + v) âˆ’Ï†u (x)| dx
Â¶Î¸q
â‰¤
C (Ï†, M, mn (U))
ÂµZ
Gv
|Ï†u (x + v) âˆ’Ï†u (x)| dx
Â¶Î¸q
=
C (Ï†, M, mn (U))
ÂµZ
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯ dx
Â¶Î¸q
.
(40.23)
Now by Lemma 40.29,
Z
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯ dx â‰¤C
Â³
Ï†, ||u||1,1,U
Â´
|v|
(40.24)
and so from 40.23 and 40.24, and adjusting the constants
Z
Rn
Â¯Â¯Â¯f
Ï†u (x + v) âˆ’f
Ï†u (x)
Â¯Â¯Â¯
q
dx
â‰¤
C (Ï†, M, mn (U))
Â³
C
Â³
Ï†, ||u||1,1,U
Â´
|v|
Â´Î¸q
=
C (Ï†, M, mn (U)) |v|Î¸q
which veriï¬es 40.21 whenever |v| is suï¬ƒciently small. This proves the lemma be-
cause the conditions of Theorem 40.28 are satisï¬ed.
Theorem 40.31 Let U be a bounded open set and deï¬ne for p > 1
S â‰¡
n
u âˆˆW 1,1 (U) âˆ©Lp (U) : ||u||1,1,U + ||u||Lp(U) â‰¤M
o
(40.25)
Then S is precompact in Lq (U) where 1 â‰¤q < p.

40.2.
AN EXTENSION THEOREM
1157
Proof: If suï¬ƒces to show that every sequence, {uk}âˆž
k=1 âŠ†S has a subsequence
which converges in Lq (U) . Let {Km}âˆž
m=1 denote a sequence of compact subsets
of U with the property that Km âŠ†Km+1 for all m and âˆªâˆž
m=1Km = U. Now let
Ï†m âˆˆCâˆž
c (U) such that Ï†m (x) âˆˆ[0, 1] and Ï†m (x) = 1 for all x âˆˆKm. Let
Sm â‰¡{Ï†mu : u âˆˆS}.
By Lemma 40.30 there exists a subsequence of {uk}âˆž
k=1 ,
denoted here by {u1,k}âˆž
k=1 such that {Ï†1u1,k}âˆž
k=1 converges in Lq (U) . Now S2 is
also precompact in Lq (U) and so there exists a subsequence of {u1,k}âˆž
k=1 , denoted
by {u2,k}âˆž
k=1 such that {Ï†2u2,k}âˆž
k=1 converges in L2 (U) . Thus it is also the case that
{Ï†1u2,k}âˆž
k=1 converges in Lq (U) . Continue taking subsequences in this manner such
that for all l â‰¤m, {Ï†lum,k}âˆž
k=1 converges in Lq (U). Let {wm}âˆž
m=1 = {um,m}âˆž
m=1 so
that {wk}âˆž
k=m is a subsequence of {um,k}âˆž
k=1 . Then it follows for all k, {Ï†kwm}âˆž
m=1
must converge in Lq (U) . For u âˆˆS,
||u âˆ’Ï†ku||q
Lq(U)
=
Z
U
|u|q (1 âˆ’Ï†k)q dx
â‰¤
ÂµZ
U
|u|p dx
Â¶q/p ÂµZ
U
(1 âˆ’Ï†k)qr dx
Â¶1/r
â‰¤
M
ÂµZ
U
(1 âˆ’Ï†k)qr dx
Â¶1/r
where q/p + 1/r = 1. Now Ï†l (x) â†’XU (x) and so the integrand in the last integral
converges to 0 by the dominated convergence theorem. Therefore, k may be chosen
large enough that for all u âˆˆS,
||u âˆ’Ï†ku||q
Lq(U) â‰¤
Â³Îµ
3
Â´q
.
Fix such a value of k. Then
||wq âˆ’wp||Lq(U) â‰¤
||wq âˆ’Ï†kwq||Lq(U) + ||Ï†kwq âˆ’Ï†kwp||Lq(U) + ||wp âˆ’Ï†kwp||Lq(U)
â‰¤2Îµ
3 + ||Ï†kwq âˆ’Ï†kwp||Lq(U) .
But {Ï†kwm}âˆž
m=1 converges in Lq (U) and so the last term in the above is less than
Îµ/3 whenever p, q are large enough. Thus {wm}âˆž
m=1 is a Cauchy sequence and must
therefore converge in Lq (U). This proves the theorem.
40.2
An Extension Theorem
Deï¬nition 40.32 An open subset, U, of Rn has a Lipschitz boundary if it satisï¬es
the following conditions.
For each p âˆˆâˆ‚U â‰¡U \ U, there exists an open set,
Q, containing p, an open interval (a, b), a bounded open box B âŠ†Rnâˆ’1, and an
orthogonal transformation R such that
RQ = B Ã— (a, b),
(40.26)

1158
BASIC THEORY OF SOBOLEV SPACES
R (Q âˆ©U) = {y âˆˆRn : by âˆˆB, a < yn < g (by)}
(40.27)
where g is Lipschitz continuous on B, a < min
Â©
g (x) : x âˆˆB
Âª
, and
by â‰¡(y1, Â· Â· Â·, ynâˆ’1).
Letting W = Q âˆ©U the following picture describes the situation.




ZZZZZ
ZZZZZ




x
W
Q
-
R
R(W)
a
b
R(Q)
y
The following lemma is important.
Lemma 40.33 If U is an open subset of Rn which has a Lipschitz boundary, then
it satisï¬es the segment condition and so Xm,p (U) = W m,p (U) .
Proof: For x âˆˆâˆ‚U, simply look at a single open set, Qx described in the above
which contains x. Then consider an open set whose intersection with U is of the
form RT ({y :by âˆˆB, g (by) âˆ’Îµ < yn < g (by)}) and a vector of the form ÎµRT (âˆ’en)
where Îµ is chosen smaller than min
Â©
g (x) : x âˆˆB
Âª
âˆ’a. There is nothing to prove
for points of U.
One way to extend many of the above theorems to more general open sets than
Rn is through the use of an appropriate extension theorem. In this section, a fairly
general one will be presented.
Lemma 40.34 Let B Ã— (a, b) be as described in Deï¬nition 40.32 and let
V âˆ’â‰¡{(by, yn) : yn < g (by)} , V + â‰¡{(by, yn) : yn > g (by)},
for g a Lipschitz function of the sort described in this deï¬nition. Suppose u+ and
uâˆ’are Lipschitz functions deï¬ned on V + and V âˆ’respectively and suppose that
u+ (by, g (by)) = uâˆ’(by, g (by)) for all by âˆˆB. Let
u (by, yn) â‰¡
Â½
u+ (by, yn) if (by, yn) âˆˆV +
uâˆ’(by, yn) if (by, yn) âˆˆV âˆ’
and suppose spt (u) âŠ†B Ã— (a, b). Then extending u to be 0 oï¬€of B Ã— (a, b), u is
continuous and the weak partial derivatives, u,i, are all in Lâˆž(Rn) âˆ©Lp (Rn) for
all p > 1 and u,i = (u+),i on V + and u,i = (uâˆ’),i on V âˆ’.

40.2.
AN EXTENSION THEOREM
1159
Proof: Consider the following picture which is descriptive of the situation.
a
b
Â¡
Â¡
Â¡Â¡ spt(u)
B
Note ï¬rst that u is Lipschitz continuous. To see this, consider |u (y1) âˆ’u (y2)|
where
Â¡byi, yi
n
Â¢
= yi. There are various cases to consider depending on whether
yi
n is above g (byi) . Suppose y1
n < g (by1) and y2
n > g (by2) . Then letting K â‰¥
max (Lip (u+) , Lip (uâˆ’)) ,
Â¯Â¯u
Â¡by1, y1
n
Â¢
âˆ’u
Â¡by2, y2
n
Â¢Â¯Â¯
â‰¤
Â¯Â¯u
Â¡by1, y1
n
Â¢
âˆ’u
Â¡by2, y1
n
Â¢Â¯Â¯ +
Â¯Â¯u
Â¡by2, y1
n
Â¢
âˆ’u (by2, g (by2))
Â¯Â¯
+
Â¯Â¯u (by2, g (by2)) âˆ’u
Â¡by2, y2
n
Â¢Â¯Â¯
â‰¤
K |by1 âˆ’by2| + K
Â£
g (by2) âˆ’y1
n + y2
n âˆ’g (by2)
Â¤
=
K
Â¡
|by1 âˆ’by2| +
Â¯Â¯y1
n âˆ’y2
n
Â¯Â¯Â¢
â‰¤Kâˆšn |y1 âˆ’y2|
The other cases are similar. Thus u is a Lipschitz continuous function which has
compact support. By Corollary 37.18 on Page 1092 it follows that u,i âˆˆLâˆž(Rn) âˆ©
Lp (Rn) for all p > 1. It remains to verify u,i = (u+),i on V + and u,i = (uâˆ’),i on
V âˆ’. The last claim is obvious from the deï¬nition of weak derivatives.
Lemma 40.35 In the situation of Lemma 40.34 let u âˆˆC1 Â³
V âˆ’
Â´
âˆ©C1
c (B Ã— (a, b))3
and deï¬ne
w (by, yn) â‰¡
ï£±
ï£²
ï£³
u (by, yn) if by âˆˆB and yn â‰¤g (by) ,
u (by, 2g (by) âˆ’yn) , if by âˆˆB and yn > g (by)
0 if by /âˆˆB.
Then w âˆˆW 1,p (Rn) and there exists a constant, C depending only on Lip (g) and
dimension such that
||w||W 1,p(Rn) â‰¤C ||u||W 1,p(V âˆ’) .
Denote w by E0u. Thus E0 (u) (y) = u (y) for all y âˆˆV âˆ’but E0u = w is deï¬ned
on all of Rn. Also, E0 is a linear mapping.
Proof: As in the previous lemma, w is Lipschitz continuous and has compact
support so it is clear w âˆˆW 1,p (Rn) . The main task is to ï¬ne w,i for by âˆˆB and
3This means that spt (u) âŠ†B Ã— (a, b) and u âˆˆC1 Â³
V âˆ’
Â´
.

1160
BASIC THEORY OF SOBOLEV SPACES
yn > g (by) and then to extract an estimate of the right sort. Denote by U the set
of points of Rn with the property that (by, yn) âˆˆU if and only if by /âˆˆB or by âˆˆB
and yn > g (by) . Then letting Ï† âˆˆCâˆž
c (U) , suppose ï¬rst that i < n. Then
Z
U
w (by, yn) Ï†,i (y) dy
â‰¡lim
hâ†’0
Z
U
Ï† (y) u
Â¡by âˆ’henâˆ’1
i
, 2g
Â¡by âˆ’henâˆ’1
i
Â¢
âˆ’yn
Â¢
âˆ’u (by, 2g (by) âˆ’yn)
h
dy
(40.28)
=
lim
hâ†’0
Â½âˆ’1
h
Z
U
Ï† (y)
Â£
D1u (by, 2g (by) âˆ’yn)
Â¡
henâˆ’1
i
Â¢
+2D2u (by, 2g (by) âˆ’yn)
Â¡
g
Â¡by âˆ’henâˆ’1
i
Â¢
âˆ’g (by)
Â¢Â¤
dy
+ âˆ’1
h
Z
U
Ï† (y)
Â£
o
Â¡
g
Â¡by âˆ’henâˆ’1
i
Â¢
âˆ’g (by)
Â¢
+ o (h)
Â¤
dy
Â¾
where enâˆ’1
i
is the unit vector in Rnâˆ’1 having all zeros except for a 1 in the ith
position. Now by Rademacherâ€™s theorem, Dg (by) exists for a.e. by and so except for
a set of measure zero, the expression, g
Â¡by âˆ’henâˆ’1
i
Â¢
âˆ’g (by) is o (h) and also for by
not in the exceptional set,
g
Â¡by âˆ’henâˆ’1
i
Â¢
âˆ’g (by) = âˆ’hDg (by) enâˆ’1
i
+ o (h) .
Therefore, since the integrand in 40.28 has compact support and because of the
Lipschitz continuity of all the functions, the dominated convergence theorem may
be applied to obtain
Z
U
w (by, yn) Ï†,i (y) dy =
Z
U
Ï† (y)
Â£
âˆ’D1u (by, 2g (by) âˆ’yn)
Â¡
enâˆ’1
i
Â¢
+ 2D2u (by, 2g (by) âˆ’yn)
Â¡
Dg (by) enâˆ’1
i
Â¢Â¤
dy
=
Z
U
Ï† (y)
Â·
âˆ’âˆ‚u
âˆ‚yi
(by, 2g (by) âˆ’yn) + 2 âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn) âˆ‚g (by)
âˆ‚yi
Â¸
dy
and so
w,i (y) = âˆ‚u
âˆ‚yi
(by, 2g (by) âˆ’yn) âˆ’2 âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn) âˆ‚g (by)
âˆ‚yi
(40.29)

40.2.
AN EXTENSION THEOREM
1161
whenever i < n which is what you would expect from a formal application of the
chain rule. Next suppose i = n.
Z
U
w (by, yn) Ï†,n (y) dy
=
lim
hâ†’0
Z
U
u (by, 2g (by) âˆ’(yn âˆ’h)) âˆ’u (by, 2g (by) âˆ’yn)
h
Ï† (y) dy
=
lim
hâ†’0
Z
U
D2u (by, 2g (by) âˆ’yn) h + o (h)
h
Ï† (y) dy
=
Z
U
âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn) Ï† (y) dy
showing that
w,n (y) = âˆ’âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn)
(40.30)
which is also expected.
From the deï¬nnition, for y âˆˆRn \ U â‰¡{(by, yn) : yn â‰¤g (by)} it follows w,i = u,i
and on U, w,i is given by 40.29 and 40.30. Consider ||w,i||p
Lp(U) for i < n. From
40.29
||w,i||p
Lp(U) =
Z
U
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yi
(by, 2g (by) âˆ’yn) âˆ’2 âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn) âˆ‚g (by)
âˆ‚yi
Â¯Â¯Â¯Â¯
p
dy

1162
BASIC THEORY OF SOBOLEV SPACES
â‰¤
2pâˆ’1
Z
U
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yi
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
+2p
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
Lip (g)p dy
â‰¤
4p (1 + Lip (g)p)
Z
U
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yi
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
+
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
dy
=
4p (1 + Lip (g)p)
Z
B
Z âˆž
g(by)
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yi
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
+
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
dyndby
=
4p (1 + Lip (g)p)
Z
B
Z g(by)
âˆ’âˆž
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yi
(by, zn)
Â¯Â¯Â¯Â¯
p
+
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yn
(by, zn)
Â¯Â¯Â¯Â¯
p
dzndby
=
4p (1 + Lip (g)p)
Z
B
Z g(by)
a
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yi
(by, zn)
Â¯Â¯Â¯Â¯
p
+
Â¯Â¯Â¯Â¯
âˆ‚u
âˆ‚yn
(by, zn)
Â¯Â¯Â¯Â¯
p
dzndby
â‰¤
4p (1 + Lip (g)p) ||u||p
1,p,V âˆ’
Now by similar reasoning,
||w,n||p
Lp(U)
=
Z
U
Â¯Â¯Â¯Â¯
âˆ’âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
dy
=
Z
B
Z âˆž
g(by)
Â¯Â¯Â¯Â¯
âˆ’âˆ‚u
âˆ‚yn
(by, 2g (by) âˆ’yn)
Â¯Â¯Â¯Â¯
p
dyndby
=
Z
B
Z g(by)
a
Â¯Â¯Â¯Â¯
âˆ’âˆ‚u
âˆ‚yn
(by, zn)
Â¯Â¯Â¯Â¯
p
dzndby = ||u,n||p
1,p,V âˆ’.
It follows
||w||p
1,p,Rn
=
||w||p
1,p,U + ||u||p
1,p,V âˆ’
â‰¤
4pn (1 + Lip (g)p) ||u||p
1,p,V âˆ’+ ||u||p
1,p,V âˆ’
and so
||w||p
1,p,Rn â‰¤4pn (2 + Lip (g)p) ||u||p
1,p,V âˆ’
which implies
||w||1,p,Rn â‰¤4n1/p (2 + Lip (g)p)1/p ||u||1,p,V âˆ’

40.2.
AN EXTENSION THEOREM
1163
It is obvious that E0 is a linear mapping. This proves the theorem.
Now recall Deï¬nition 40.32, listed here for convenience.
Deï¬nition 40.36 An open subset, U, of Rn has a Lipschitz boundary if it satisï¬es
the following conditions.
For each p âˆˆâˆ‚U â‰¡U \ U, there exists an open set,
Q, containing p, an open interval (a, b), a bounded open box B âŠ†Rnâˆ’1, and an
orthogonal transformation R such that
RQ = B Ã— (a, b),
(40.31)
R (Q âˆ©U) = {y âˆˆRn : by âˆˆB, a < yn < g (by)}
(40.32)
where g is Lipschitz continuous on B, a < min
Â©
g (x) : x âˆˆB
Âª
, and
by â‰¡(y1, Â· Â· Â·, ynâˆ’1).
Letting W = Q âˆ©U the following picture describes the situation.




ZZZZZ
ZZZZZ




x
W
Q
-
R
R(W)
a
b
R(Q)
y
Lemma 40.37 In the situation of Deï¬nition 40.32 let u âˆˆC1 Â¡
U
Â¢
âˆ©C1
c (Q) and
deï¬ne
Eu â‰¡Râˆ—E0
Â¡
RT Â¢âˆ—u.
where
Â¡
RT Â¢âˆ—maps W 1,p (U âˆ©Q) to W 1,p (R (W)) . Then E is linear and satisï¬es
||Eu||W 1,p(Rn) â‰¤C ||u||W 1,p(Qâˆ©U) , Eu (x) = u (x) for x âˆˆQ âˆ©U.
where C depends only on the dimension and Lip (g) .
Proof: This follows from Theorem 40.14 and Lemma 40.35.
The following theorem is a general extension theorem for Sobolev spaces.
Theorem 40.38 Let U be a bounded open set which has Lipschitz boundary. Then
for each p â‰¥1, there exists E âˆˆL
Â¡
W 1,p (U) , W 1,p (Rn)
Â¢
such that Eu (x) = u (x)
a.e. x âˆˆU.
Proof: Let âˆ‚U âŠ†âˆªp
i=1Qi Where the Qi are as described in Deï¬nition 40.36.
Also let Ri be the orthogonal trasformation and gi the Lipschitz functions associated
with Qi as in this deï¬nition. Now let Q0 âŠ†Q0 âŠ†U be such that U âŠ†âˆªp
i=0Qi, and

1164
BASIC THEORY OF SOBOLEV SPACES
let Ïˆi âˆˆCâˆž
c (Qi) with Ïˆi (x) âˆˆ[0, 1] and Pp
i=0 Ïˆi (x) = 1 on U. For u âˆˆCâˆžÂ¡
U
Â¢
,
let E0 (Ïˆ0u) â‰¡Ïˆ0u on Q0 and 0 oï¬€Q0. Thus
Â¯Â¯Â¯Â¯E0 (Ïˆ0u)
Â¯Â¯Â¯Â¯
1,p,Rn = ||Ïˆ0u||1,p,U .
For i â‰¥1, let
Ei (Ïˆiu) â‰¡Râˆ—
i E0
Â¡
RT Â¢âˆ—(Ïˆiu) .
Thus, by Lemma 40.37
Â¯Â¯Â¯Â¯E1 (Ïˆiu)
Â¯Â¯Â¯Â¯
1,p,Rn â‰¤C ||Ïˆiu||1,p,Qiâˆ©U
where the constant depends on Lip (gi) but is independent of u âˆˆCâˆžÂ¡
U
Â¢
. Now
deï¬ne E as follows.
Eu â‰¡
p
X
i=0
Ei (Ïˆiu) .
Thus for u âˆˆCâˆžÂ¡
U
Â¢
, it follows Eu (x) = u (x) for all x âˆˆU. Also,
||Eu||1,p,Rn
â‰¤
p
X
i=0
Â¯Â¯Â¯Â¯Ei (Ïˆiu)
Â¯Â¯Â¯Â¯ â‰¤
p
X
i=0
Ci ||Ïˆiu||1,p,Qiâˆ©U
=
p
X
i=0
Ci ||Ïˆiu||1,p,U â‰¤
p
X
i=0
Ci ||u||1,p,U
â‰¤
(p + 1)
p
X
i=0
Ci ||u||1,p,U â‰¡C ||u||1,p,U .
(40.33)
where C depends on the Ïˆi and the gi but is independent of u âˆˆCâˆžÂ¡
U
Â¢
. Therefore,
by density of CâˆžÂ¡
U
Â¢
in W 1,p (U) , E has a unique continuous extension to W 1,p (U)
still denoted by E satisfying the inequality determined by the ends of 40.33. It
remains to verify that Eu (x) = u (x) a.e. for x âˆˆU.
Let uk â†’u in W 1,p (U) where uk âˆˆCâˆžÂ¡
U
Â¢
. Therefore, by 40.33, Euk â†’Eu
in W 1,p (Rn) . Since Euk (x) = uk (x) for each k,
||u âˆ’Eu||Lp(U)
=
lim
kâ†’âˆž||uk âˆ’Euk||Lp(U)
=
lim
kâ†’âˆž||Euk âˆ’Euk||Lp(U) = 0
which shows u (x) = Eu (x) for a.e. x âˆˆU as claimed. This proves the theorem.
Deï¬nition 40.39 Let U be an open set. Then W m,p
0
(U) is the closure of the set,
Câˆž
c (U) in W m,p (U) .
Corollary 40.40 Let U be a bounded open set which has Lipschitz boundary and
let W be an open set containing U.
Then for each p â‰¥1, there exists EW âˆˆ
L
Â³
W 1,p (U) , W 1,p
0
(W)
Â´
such that EW u (x) = u (x) a.e. x âˆˆU.

40.3.
GENERAL EMBEDDING THEOREMS
1165
Proof: Let Ïˆ âˆˆCâˆž
c (W) and Ïˆ = 1 on U. Then let EW u â‰¡ÏˆEu where E is
the extension operator of Theorem 40.38.
Extension operators of the above sort exist for many open sets, U, not just for
bounded ones. In particular, the above discussion would apply to an open set, U,
not necessarily bounded, if you relax the condition that the Qi must be bounded
but require the existence of a ï¬nite partition of unity {Ïˆi}p
i=1 having the property
that Ïˆi and Ïˆi,j are uniformly bounded for all i, j. The proof would be identical
to the above. My main interest is in bounded open sets so the above theorem will
suï¬ƒce. Such an extension operator will be referred to as a (1, p) extension operator.
40.3
General Embedding Theorems
With the extension theorem it is possible to give a useful theory of embeddings.
Theorem 40.41 Let 1 â‰¤p < n and
1
q =
1
p âˆ’1
n and let U be any open set for
which there exists a (1, p) extension operator. Then if u âˆˆW 1,p (U) , there exists a
constant independent of u such that
||u||Lq(U) â‰¤C ||u||1,p,U .
If U is bounded and r < q, then id : W 1,p (U) â†’Lr (U) is also compact.
Proof: Let E be the (1, p) extension operator. Then by Theorem 40.24 on Page
1149
||u||Lq(U)
â‰¤
||Eu||Lq(Rn) â‰¤
1
nâˆšn
(n âˆ’1) p
(n âˆ’p) ||Eu||1,p,Rn
â‰¤
C ||u||1,p,U .
It remains to prove the assertion about compactness. If S âŠ†W 1,p (U) is bounded
then
sup
uâˆˆS
n
||u||1,1,U + ||u||Lq(U)
o
< âˆž
and so by Theorem 40.31 on Page 1156, it follows S is precompact in Lr (U) .This
proves the theorem.
Corollary 40.42 Suppose mp < n and U is an open set satisfying the segment con-
dition which has a (1, p) extension operator for all p. Then id âˆˆL (W m,p (U) , Lq (U))
where q =
np
nâˆ’mp.
Proof: This is true if m = 1 according to Theorem 40.41. Suppose it is true for
m âˆ’1 where m > 1. If u âˆˆW m,p (U) and |Î±| â‰¤1, then DÎ±u âˆˆW mâˆ’1,p (U) so by
induction, for all such Î±,
DÎ±u âˆˆL
np
nâˆ’(mâˆ’1)p (U) .

1166
BASIC THEORY OF SOBOLEV SPACES
Thus, since U has the segment condition, u âˆˆW 1,q1 (U) where
q1 =
np
n âˆ’(m âˆ’1) p
By Theorem 40.41, it follows u âˆˆLq (Rn) where
1
q = n âˆ’(m âˆ’1) p
np
âˆ’1
n = n âˆ’mp
np
.
This proves the corollary.
There is another similar corollary of the same sort which is interesting and useful.
Corollary 40.43 Suppose m â‰¥1 and j is a nonnegative integer satisfying jp < n.
Also suppose U has a (1, p) extension operator for all p â‰¥1 and satisï¬es the segment
condition. Then
id âˆˆL
Â¡
W m+j,p (U) , W m,q (U)
Â¢
where
q â‰¡
np
n âˆ’jp.
(40.34)
If, in addition to the above, U is bounded and 1 â‰¤r < q, then
id âˆˆL
Â¡
W m+j,p (U) , W m,r (U)
Â¢
and is compact.
Proof: If |Î±| â‰¤m, then DÎ±u âˆˆW j,p (U) and so by Corollary 40.42, DÎ±u âˆˆ
Lq (U) where q is given above.
Since U has the segment property, this means
u âˆˆW m,q (U). It remains to verify the assertion about compactness of id.
Let S be bounded in W m+j,p (U) . Then S is bounded in W m,q (U) by the
ï¬rst part. Now let {uk}âˆž
k=1 be any sequence in S. The corollary will be proved
if it is shown that any such sequence has a convergent subsequence in W m,r (U).
Let {Î±1, Î±2, Â· Â· Â·, Î±h} denote the indices satisfying |Î±| â‰¤m. Then for each of these
indices, Î±,
sup
uâˆˆS
n
||DÎ±u||1,1,U + ||DÎ±u||Lq(U)
o
< âˆž
and so for each such Î±, satisfying |Î±| â‰¤m, it follows from Lemma 40.30 on Page 1155
that {DÎ±u : u âˆˆS} is precompact in Lr (U) . Therefore, there exists a subsequence,
still denoted by uk such that DÎ±1uk converges in Lr (U) . Applying the same lemma,
there exists a subsequence of this subsequence such that both DÎ±1uk and DÎ±2uk
converge in Lr (U) . Continue taking subsequences until you obtain a subsequence,
{uk}âˆž
k=1 for which {DÎ±uk}âˆž
k=1 converges in Lr (U) for all |Î±| â‰¤m. But this must
be a convergent subsequence in W m,r (U) and this proves the corollary.
Theorem 40.44 Let U be a bounded open set having a (1, p) extension operator
and let p > n. Then id : W 1,p (U) â†’C
Â¡
U
Â¢
is continuous and compact.

40.3.
GENERAL EMBEDDING THEOREMS
1167
Proof: Theorem 40.17 on Page 40.17 implies rU : W 1,p (Rn) â†’C
Â¡
U
Â¢
is con-
tinuous and compact. Thus
||u||âˆž,U = ||Eu||âˆž,U â‰¤C ||Eu||1,p,Rn â‰¤C ||u||1,p,U .
This proves continuity.
If S is a bounded set in W 1,p (U) , then deï¬ne S1 â‰¡
{Eu : u âˆˆS} . Then S1 is a bounded set in W 1,p (Rn) and so by Theorem 40.17
the set of restrictions to U, is precompact. However, the restrictions to U are just
the functions of S. Therefore, id is compact as well as continuous.
Corollary 40.45 Let p > n, let U be a bounded open set having a (1, p) extension
operator which also satisï¬es the segment condition, and let m be a nonnegative
integer. Then id : W m+1,p (U) â†’Cm,Î» Â¡
U
Â¢
is continuous for all Î» âˆˆ[0, 1 âˆ’n
p ] and
id is compact if Î» < 1 âˆ’n
p .
Proof: Let uk â†’0 in W m+1,p (U) . Then it follows that for each |Î±| â‰¤m,
DÎ±uk â†’0 in W 1,p (U) . Therefore,
E (DÎ±uk) â†’0 in W 1,p (Rn) .
Then from Morreyâ€™s inequality, 40.13 on Page 1144, if Î» â‰¤1 âˆ’n
p and |Î±| = m
ÏÎ» (E (DÎ±uk)) â‰¤C ||E (DÎ±uk)||1,p,Rn diam (U)1âˆ’n
p âˆ’Î» .
Therefore, ÏÎ» (E (DÎ±uk)) = ÏÎ» (DÎ±uk) â†’0. From Theorem 40.44 it follows that
for |Î±| â‰¤m, ||DÎ±uk||âˆžâ†’0 and so ||uk||m,Î» â†’0. This proves the claim about
continuity. The claim about compactness for Î» < 1 âˆ’n
p follows from Lemma 40.20
on Page 1145 and this.
(Bounded in W m,p (U)
id
â†’Bounded in Cm,1âˆ’n
p Â¡
U
Â¢
id
â†’
Compact in Cm,Î» Â¡
U
Â¢
.)
Theorem 40.46 Suppose jp < n < (j + 1) p and let m be a positive integer. Let
U be any bounded open set in Rn which has a (1, p) extension operator for each
p â‰¥1 and the segment property. Then id âˆˆL
Â¡
W m+j,p (U) , Cmâˆ’1,Î» Â¡
U
Â¢Â¢
for every
Î» â‰¤Î»0 â‰¡(j + 1) âˆ’n
p and if Î» < (j + 1) âˆ’n
p , id is compact.
Proof: From Corollary 40.43 W m+j,p (U) âŠ†W m,q (U) where q is given by 40.34.
Therefore,
np
n âˆ’jp > n
and so by Corollary 40.45, W m,q (U) âŠ†Cmâˆ’1,Î» Â¡
U
Â¢
for all Î» satisfying
0 < Î» < 1 âˆ’(n âˆ’jp) n
np
= p (j + 1) âˆ’n
p
= (j + 1) âˆ’n
p .
The assertion about compactness follows from the compactness of the embedding
of Cmâˆ’1,Î»0 Â¡
U
Â¢
into Cmâˆ’1,Î» Â¡
U
Â¢
for Î» < Î»0, Lemma 40.20 on Page 1145.

1168
BASIC THEORY OF SOBOLEV SPACES
40.4
More Extension Theorems
The theorem about the existence of a (1, p) extension is all that is needed to obtain
general embedding theorems for Sobolev spaces. However, a more general theory
is needed in order to tie the theory of Sobolev spaces presented thus far to a very
appealing description using Fourier transforms.
First the problem of extending
W k,p (H) to W k,p (Rn) is considered for Hâˆ’a half space
Hâˆ’â‰¡{y âˆˆRn : yn < 0} .
(40.35)
I am following Adams [1].
Lemma 40.47 Let Hâˆ’be a half space as in 40.35. Let H+ be the half space in
which yn < 0 is replaced with yn > 0. Also let (yâ€², yn) = y
u (yâ€², yn) â‰¡
Â½
u+ (yâ€², yn) if y âˆˆH+
uâˆ’(yâ€², yn) if y âˆˆHâˆ’
,
suppose u+ âˆˆCâˆžÂ³
H+
Â´
and uâˆ’âˆˆCâˆžÂ³
Hâˆ’
Â´
, and that for l â‰¤k âˆ’1,
Dlenu+ (yâ€², 0) = Dlenuâˆ’(yâ€², 0) .
Then u âˆˆW k,p (Rn). Furthermore,
DÎ±u (yâ€², yn) â‰¡
Â½
DÎ±u+ (yâ€², yn) if y âˆˆH+
DÎ±uâˆ’(yâ€², yn) if y âˆˆHâˆ’
Proof: Consider the following for Ï† âˆˆCâˆž
c (Rn) and |Î±| â‰¤k.
(âˆ’1)|Î±|
ÂµZ
Rnâˆ’1
Z âˆž
0
u+DÎ±Ï†dyndyâ€² +
Z
Rnâˆ’1
Z 0
âˆ’âˆž
uâˆ’DÎ±Ï†dyndyâ€²
Â¶
.
Integrating by parts, this yields
(âˆ’1)|Î±| (âˆ’1)|Î²|
ÂµZ
Rnâˆ’1
Z âˆž
0
DÎ²u+DÎ±nenÏ†dyndyâ€²
+
Z
Rnâˆ’1
Z 0
âˆ’âˆž
DÎ²uâˆ’DÎ±nenÏ†dyndyâ€²
Â¶
where Î² â‰¡(Î±1, Î±2, Â· Â· Â·Î±nâˆ’1, 0) . Do integration by parts on the inside integral and
by assumption, the boundary terms will cancel and the whole thing reduces to
(âˆ’1)|Î±| (âˆ’1)|Î²| (âˆ’1)Î±n
ÂµZ
Rnâˆ’1
Z âˆž
0
DÎ±u+Ï†dyndyâ€²
+
Z
Rnâˆ’1
Z 0
âˆ’âˆž
DÎ±uâˆ’Ï†dyndyâ€²
Â¶
=
ÂµZ
Rnâˆ’1
Z âˆž
0
DÎ±u+Ï†dyndyâ€² +
Z
Rnâˆ’1
Z 0
âˆ’âˆž
DÎ±uâˆ’Ï†dyndyâ€²
Â¶
which proves the lemma.

40.4.
MORE EXTENSION THEOREMS
1169
Lemma 40.48 Let Hâˆ’be the half space in 40.35 and let u âˆˆCâˆžÂ³
Hâˆ’
Â´
. Then
there exists a mapping,
E : CâˆžÂ³
Hâˆ’
Â´
â†’W k,p (Rn)
and a constant, C which is independent of u âˆˆCâˆžÂ³
Hâˆ’
Â´
such that E is linear and
for all l â‰¤k,
||Eu||l,p,Rn â‰¤C ||u||l,p,Hâˆ’.
(40.36)
Proof: Deï¬ne
Eu (xâ€², xn) â‰¡
Â½ u (xâ€², xn) if xn < 0
Pk
j=1 Î»ju (xâ€², âˆ’jxn) if xn â‰¥0
where the Î»j are chosen in such a way that for l â‰¤k âˆ’1,
Dlenu (xâ€², 0) âˆ’Dlen
ï£«
ï£­
k
X
j=1
Î»ju
ï£¶
ï£¸(xâ€², 0) = 0
so that Lemma 40.47 may be applied. Do there exist such Î»j? It is necessary to
have the following hold for each r = 0, 1, Â· Â· Â·, k âˆ’1.
k
X
j=1
(âˆ’j)r Î»jDrenu (xâ€², 0) = Drenu (xâ€², 0) .
This is satisï¬ed if
k
X
j=1
(âˆ’j)r Î»j = 1
for r = 0, 1, Â· Â· Â·, k âˆ’1. This is a system of k equations for the k variables, the Î»j.
The matrix of coeï¬ƒcients is of the form
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­
1
1
1
Â· Â· Â·
1
âˆ’1
âˆ’2
âˆ’3
Â· Â· Â·
âˆ’k
1
4
9
Â· Â· Â·
k2
...
...
...
...
(âˆ’1)k
(âˆ’2)k
(âˆ’3)k
Â· Â· Â·
(âˆ’k)k
ï£¶
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸
This matrix has an inverse because its determinant is nonzero.
Now from Lemma 40.47, it follows from the above description of E that for
|Î±| â‰¤k,
DÎ± (Eu) (xâ€², xn) â‰¡
Â½ DÎ±u (xâ€², xn) if xn < 0
Pk
j=1 Î»j (âˆ’j)Î±n (DÎ±u) (xâ€², âˆ’jxn) if xn â‰¥0
It follows that E is linear and there exists a constant, C independent of u such that
40.36 holds. This proves the lemma.

1170
BASIC THEORY OF SOBOLEV SPACES
Corollary 40.49 Let Hâˆ’be the half space of 40.35. There exists E with the prop-
erty that E : W l,p (Hâˆ’) â†’W l,p (Rn) and is linear and continuous for each l â‰¤k.
Proof: This immediate from the density of Câˆž
c
Â³
Hâˆ’
Â´
in W k,p Â³
Hâˆ’
Â´
and
Lemma 40.48.
There is nothing sacred about a half space or this particular half space. It is
clear that everything works as well for a half space of the form
Hâˆ’
k â‰¡{x : xk < 0} .
Thus the half space featured in the above discussion is Hâˆ’
n .
Corollary 40.50 Let {k1, Â· Â· Â·, kr} âŠ†{1, Â· Â· Â·, n} where the ki are distinct and let
Hâˆ’
k1Â·Â·Â·kr â‰¡Hâˆ’
k1 âˆ©Hâˆ’
k2 âˆ©Â· Â· Â· âˆ©Hâˆ’
kr.
(40.37)
Then there exists E : W k,p Â¡
Hâˆ’
k1Â·Â·Â·kr
Â¢
â†’W k,p (Rn) such that E is linear and con-
tinuous.
Proof: Follow the above argument with minor modiï¬cations to ï¬rst extend
from Hâˆ’
k1Â·Â·Â·kr to Hâˆ’
k1Â·Â·Â·krâˆ’1 and then from from Hâˆ’
k1Â·Â·Â·krâˆ’1 to Hâˆ’
k1Â·Â·Â·krâˆ’2 etc.
This easily implies the ability to extend oï¬€bounded open sets which near their
boundaries look locally like an intersection of half spaces.
Theorem 40.51 Let U be a bounded open set and suppose U0, U1, Â·Â·Â·, Um are open
sets with the property that U âŠ†âˆªm
k=0Uk, U0 âŠ†U, and âˆ‚U âŠ†âˆªm
k=1Uk. Suppose also
there exist one to one and onto functions, hk : Rn â†’Rn, hk (Uk âˆ©U) = Wk where
Wk equals the intersection of a bounded open set with a ï¬nite intersection of half
spaces, Hâˆ’
k1Â·Â·Â·kr, as in 40.37 such that hk (âˆ‚U âˆ©Uk) âŠ†âˆ‚Hâˆ’
k1Â·Â·Â·kr. Suppose also that
for all |Î±| â‰¤k âˆ’1,
DÎ±hk and DÎ±hâˆ’1
k
exist and are Lipschitz continuous. Then there letting W be an open set which con-
tains U, there exists E : W k,p (U) â†’W k,p (W) such that E is a linear continuous
map from W l,p (U) to W l,p (W) for each l â‰¤k.
Proof: Let Ïˆj âˆˆCâˆž
c (Uj), Ïˆj (x) âˆˆ[0, 1] for all x âˆˆRn, and Pm
j=0 Ïˆj (x) = 1
on U. This is a Câˆžpartition of unity on U. By Theorem 40.14
Â¡
hâˆ’1
j
Â¢âˆ—uÏˆj âˆˆ
W k,p (Wj) . By the assumption that hj (âˆ‚U âˆ©Uj) âŠ†âˆ‚Hâˆ’
k1Â·Â·Â·kr, the zero extension of
Â¡
hâˆ’1
j
Â¢âˆ—uÏˆj to the rest of Hâˆ’
k1Â·Â·Â·kr results in an element of W k,p Â¡
Hâˆ’
k1Â·Â·Â·kr
Â¢
. Apply
Corollary 40.50 to conclude there exists Ej : W k,p Â¡
Hâˆ’
k1Â·Â·Â·kr
Â¢
â†’W k,p (Rn) which is
continuous and linear. Abusing notation slightly, by using
Â¡
hâˆ’1
j
Â¢âˆ—uÏˆj as the above
zero extension, it follows Ej
Â³Â¡
hâˆ’1
j
Â¢âˆ—uÏˆj
Â´
âˆˆW k,p (Rn) . Now let Î· be a function in
Câˆž
c (h (W)) such that Î· (y) = 1 on h
Â¡
U
Â¢
. Then Deï¬ne
Eu â‰¡
m
X
j=0
hâˆ—
jÎ·Ej
Â³Â¡
hâˆ’1
j
Â¢âˆ—Â¡
uÏˆj
Â¢Â´
.

40.4.
MORE EXTENSION THEOREMS
1171
Clearly Eu (x) = u (x) if x âˆˆU. It is also clear that E is linear. It only remains
to verify E is continuous.
In what follows, Cj will denote a constant which is
independent of u which may change from line to line. By Theorem 40.14,
||Eu||k,p,W
â‰¤
m
X
j=0
Â¯Â¯Â¯
Â¯Â¯Â¯hâˆ—
jÎ·Ej
Â³Â¡
hâˆ’1
j
Â¢âˆ—Â¡
uÏˆj
Â¢Â´Â¯Â¯Â¯
Â¯Â¯Â¯
k,p,W
â‰¤
m
X
j=0
Cj
Â¯Â¯Â¯
Â¯Â¯Â¯Î·Ej
Â³Â¡
hâˆ’1
j
Â¢âˆ—Â¡
uÏˆj
Â¢Â´Â¯Â¯Â¯
Â¯Â¯Â¯
k,p,h(W )
=
m
X
j=0
Cj
Â¯Â¯Â¯
Â¯Â¯Â¯Î·Ej
Â³Â¡
hâˆ’1
j
Â¢âˆ—Â¡
uÏˆj
Â¢Â´Â¯Â¯Â¯
Â¯Â¯Â¯
k,p,Rn
â‰¤
m
X
j=0
Cj
Â¯Â¯Â¯
Â¯Â¯Â¯Ej
Â³Â¡
hâˆ’1
j
Â¢âˆ—Â¡
uÏˆj
Â¢Â´Â¯Â¯Â¯
Â¯Â¯Â¯
k,p,Rn
â‰¤
m
X
j=0
Cj
Â¯Â¯Â¯
Â¯Â¯Â¯
Â¡
hâˆ’1
j
Â¢âˆ—Â¡
uÏˆj
Â¢Â¯Â¯Â¯
Â¯Â¯Â¯
k,p,hj(Uâˆ©Uj)
â‰¤
m
X
j=0
Cj
Â¯Â¯Â¯Â¯uÏˆj
Â¯Â¯Â¯Â¯
k,p,Uâˆ©Uk
â‰¤
m
X
j=0
Cj ||u||k,p,Uâˆ©Uk â‰¤
ï£«
ï£­
m
X
j=0
Cj
ï£¶
ï£¸||u||k,p,U .
Similarly E : W l,p (U) â†’W l,p (U) for l â‰¤k. This proves the theorem.
Deï¬nition 40.52 When E is a linear continuous map from W l,p (U) to W l,p (Rn)
for each l â‰¤k. it is called a strong (k, p) extension map.
There is also a very easy sort of extension theorem for the space, W m,p
0
(U) which
does not require any assumptions on the boundary of U other than mn (âˆ‚U) = 0.
First here is the deï¬nition of W m,p
0
(U) .
Deï¬nition 40.53 Denote by W m,p
0
(U) the closure of Câˆž
c (U) in W m,p (U) .
Theorem 40.54 For u âˆˆW m,p
0
(U) , deï¬ne
Eu (x) â‰¡
Â½ u (x) if x âˆˆU
0 if x /âˆˆU
Then E is a strong (k, p) extension map.
Proof: Letting l â‰¤m, it is clear that for |Î±| â‰¤l,
DÎ±Eu =
Â½
DÎ±u for x âˆˆU
0 for x /âˆˆU
.

1172
BASIC THEORY OF SOBOLEV SPACES
This follows because, since mn (âˆ‚U) = 0 it suï¬ƒces to consider Ï† âˆˆCâˆž
c (U) and
Ï† âˆˆCâˆž
c
Â³
U
CÂ´
. Therefore, ||Eu||l,p,Rn = ||u||l,p,U.
There are many other extension theorems and if you are interested in pursuing
this further, consult Adams [1]. One of the most famous which is discussed in this
reference is due to Calderon and depends on the theory of singular integrals.

Sobolev Spaces Based On L2
41.1
Fourier Transform Techniques
Much insight can be obtained easily through the use of Fourier transform methods.
This technique will be developed in this chapter. When this is done, it is necessary
to use Sobolev spaces of the form W k,2 (U) , those Sobolev spaces which are based
on L2 (U) . It is true there are generalizations which use Fourier transform methods
in the context of Lp but the spaces so considered are called Bessel potential spaces.
They are not really Sobolev spaces.
Furthermore, it is Mihlinâ€™s theorem rather
than the Plancherel theorem which is the main tool of the analysis. This is a hard
theorem.
It is convenient to consider the Schwartz class of functions,S. These are func-
tions which have inï¬nitely many derivatives and vanish quickly together with their
derivatives as |x| â†’âˆž. In particular, Câˆž
c (Rn) is contained in S which is not true of
the functions, G used earlier in deï¬ning the Fourier transforms which are a suspace
of S. Recall the following deï¬nition.
Deï¬nition 41.1 f âˆˆS, the Schwartz class, if f âˆˆCâˆž(Rn) and for all positive
integers N,
ÏN(f) < âˆž
where
ÏN(f) = sup{(1 + |x|2)N|DÎ±f(x)| : x âˆˆRn , |Î±| â‰¤N}.
Thus f âˆˆS if and only if f âˆˆCâˆž(Rn) and
sup{|xÎ²DÎ±f(x)| : x âˆˆRn} < âˆž
(41.1)
for all multi indices Î± and Î².
Thus all partial derivatives of a function in S are in Lp (Rn) for all p â‰¥1.
Therefore, for f âˆˆS, the Fourier and inverse Fourier transforms are given in the
usual way,
Ff (t) =
Âµ 1
2Ï€
Â¶n/2 Z
Rn f (x) eâˆ’itÂ·xdx, F âˆ’1f (t) =
Âµ 1
2Ï€
Â¶n/2 Z
Rn f (x) eitÂ·xdx.
1173

1174
SOBOLEV SPACES BASED ON L2
Also recall that the Fourier transform and its inverse are one to one and onto maps
from S to S.
To tie the Fourier transform technique in with what has been done so far, it is
necessary to make the following assumption on the set, U. This assumption is made
so that it is possible to consider elements of W k,2 (U) as restrictions of elements of
W k,2 (Rn) .
Assumption 41.2 Assume U satisï¬es the segment condition and that for any m of
interest, there exists E âˆˆL (W m,p (U) , W m,p (Rn)) such that for each k â‰¤m, E âˆˆ
L
Â¡
W k,p (U) , W k,p (Rn)
Â¢
. That is, there exists a stong (m, p) extension operator.
Lemma 41.3
The Schwartz class, S, is dense in W m,p (Rn) .
Proof: The set, Rn satisï¬es the segment condition and so Câˆž
c (Rn) is dense in
W m,p (Rn) . However, Câˆž
c (Rn) âŠ†S. This proves the lemma.
Recall now Plancherelâ€™s theorem which states that ||f||0,2,Rn = ||Ff||0,2,Rn when-
ever f âˆˆL2 (Rn) . Also it is routine to verify from the deï¬nition of the Fourier
transform that for u âˆˆS,
Fâˆ‚ku = ixkFu.
From this it follows that
||DÎ±u||0,2,Rn = ||xÎ±Fu||0,2,Rn .
Here xÎ± denotes the function x â†’xÎ±. Therefore,
||u||m,2,Rn =
ï£«
ï£­
Z
Rn
X
|Î±|â‰¤m
x2Î±1
1
Â· Â· Â· x2Î±n
n
|Fu (x)|2 dx
ï£¶
ï£¸
1/2
.
Also, it is not hard to verify that
X
|Î±|â‰¤m
x2Î±1
1
Â· Â· Â· x2Î±n
n
â‰¤
ï£«
ï£­1 +
n
X
j=1
x2
j
ï£¶
ï£¸
m
â‰¤C (n, m)
X
|Î±|â‰¤m
x2Î±1
1
Â· Â· Â· x2Î±n
n
where C (n, m) is the largest of the multinomial coeï¬ƒcients obtained in the expan-
sion,
ï£«
ï£­1 +
n
X
j=1
x2
j
ï£¶
ï£¸
m
.
Therefore, for all u âˆˆS,
||u||m,2,Rn â‰¤
ÂµZ
Rn
Â³
1 + |x|2Â´m
|Fu (x)|2 dx
Â¶1/2
â‰¤C (n, m) ||u||m,2,Rn .
(41.2)
This motivates the following deï¬nition.

41.1.
FOURIER TRANSFORM TECHNIQUES
1175
Deï¬nition 41.4 Let Hm (Rn) â‰¡
(
u âˆˆL2 (Rn) : ||u||Hm(Rn) â‰¡
ÂµZ
Rn
Â³
1 + |x|2Â´m
|Fu (x)|2 dx
Â¶1/2
< âˆž
)
.
(41.3)
Lemma 41.5 S is dense in Hm (Rn) and Hm (Rn) = W 2,m (Rn). Furthermore,
the norms are equivalent.
Proof: First it is shown that S is dense in Hm (Rn) . Let u âˆˆHm (Rn) . Let
Âµ (E) â‰¡
R
E
Â³
1 + |x|2Â´m
dx. Thus Âµ is a regular measure and u âˆˆHm (Rn) just
means that Fu âˆˆL2 (Âµ) , the space of functions which are in L2 (Rn) with respect
to this measure, Âµ. Therefore, from the regularity of the measure, Âµ, there exists
uk âˆˆCc (Rn) such that
||uk âˆ’Fu||L2(Âµ) â†’0.
Now let ÏˆÎµ be a molliï¬er and pick Îµk small enough that
Â¯Â¯Â¯Â¯uk âˆ—ÏˆÎµk âˆ’uk
Â¯Â¯Â¯Â¯
L2(Âµ) < 1
2k .
Then uk âˆ—ÏˆÎµk âˆˆCâˆž
c (Rn) âŠ†S. Therefore, there exists wk âˆˆG such that Fwk =
uk âˆ—ÏˆÎµk. It follows
||Fwk âˆ’Fu||L2(Âµ) â‰¤||Fwk âˆ’uk||L2(Âµ) + ||uk âˆ’Fu||L2(Âµ)
and these last two terms converge to 0 as k â†’âˆž. Therefore, wk â†’u in Hm (Rn)
and this proves the ï¬rst part of this lemma.
Now let u âˆˆHm (Rn) . By what was just shown, there exists a sequence, uk â†’u
in Hm (Rn) where uk âˆˆS. It follows from 41.2 that
||uk âˆ’ul||Hm â‰¥||uk âˆ’ul||m,2,Rn
and so {uk} is a Cauchy sequence in W m,2 (Rn) . Therefore, there exists w âˆˆ
W m,2 (Rn) such that
||uk âˆ’w||m,2,Rn â†’0.
But this implies
0 = lim
kâ†’âˆž||uk âˆ’w||0,2,Rn = lim
kâ†’âˆž||uk âˆ’u||0,2,Rn
showing u = w which veriï¬es Hm (Rn) âŠ†W 2,m (Rn) . The opposite inclusion is
proved the same way, using density of S and the fact that the norms in both spaces
are larger than the norms in L2 (Rn). The equivalence of the norms follows from
the density of S and the equivalence of the norms on S. This proves the lemma.
The conclusion of this lemma with the density of S and 41.2 implies you can
use either norm, ||u||Hm(Rn) or ||u||m,2,Rn when working with these Sobolev spaces.
What of open sets satisfying Assumption 41.2? How does W m,2 (U) relate to
the Fourier transform?

1176
SOBOLEV SPACES BASED ON L2
Deï¬nition 41.6 Let U be an open set in Rn. Then
Hm (U) â‰¡{u : u = v|U for some v âˆˆHm (Rn)}
(41.4)
Here the notation, v|U means v restricted to U. Deï¬ne the norm in this space by
||u||Hm(U) â‰¡inf
n
||v||Hm(Rn) : v|U = u
o
.
(41.5)
Lemma 41.7 Hm (U) is a Banach space.
Proof: First it is necessary to verify that the given norm really is a norm.
Suppose then that u = 0. Is ||u||Hm(U) = 0? Of course it is. Just take v â‰¡0.
Then v|U = u and ||v||Hm = 0. Next suppose ||u||Hm(U) = 0. Does it follow that
u = 0? Letting Îµ > 0 be given, there exists v âˆˆHm (Rn) such that v|U = u and
||v||Hm(Rn) < Îµ. Therefore,
||u||0,U â‰¤||v||0,Rn â‰¤||v||Hm(U) < Îµ.
Since Îµ > 0 is arbitrary, it follows u = 0 a.e. Next suppose ui âˆˆHm (U) for i = 1, 2.
There exists vi âˆˆHm (Rn) such that
||vi||Hm(Rn) < ||ui||Hm(U) + Îµ.
Therefore,
||u1 + u2||Hm(U)
â‰¤
||v1 + v2||Hm(Rn) â‰¤||v1||Hm(Rn) + ||v2||Hm(Rn)
â‰¤
||u1||Hm(U) + ||u2||Hm(U) + 2Îµ
and since Îµ > 0 is arbitrary, this shows the triangle inequality.
The interesting question is the one about completeness. Suppose then {uk} is
a Cauchy sequence in Hm (U) . There exists Nk such that if k, l â‰¥Nk, it follows
||uk âˆ’ul||Hm(U) <
1
2k and the numbers, Nk can be taken to be strictly increasing in
k. Thus for l â‰¥Nk, ||ul âˆ’uNk||Hm(U) < 1/2l. Therefore, there exists wl âˆˆHm (Rn)
such that
wl|U = ul âˆ’uNk, ||wl||Hm(Rn) < 1
2l .
Also let vNk|U = uNk with vNk âˆˆHm (Rn) and
||vNk||Hm(Rn) < ||uNk||Hm(U) + 1
2k .
Now for l > Nk, deï¬ne vl by vl âˆ’vNk = wNk so that ||vl âˆ’vNk||Hm(Rn) < 1/2k. In
particular,
Â¯Â¯Â¯Â¯vNk+1 âˆ’vNk
Â¯Â¯Â¯Â¯
Hm(Rn) < 1/2k
which shows that {vNk}âˆž
k=1 is a Cauchy sequence. Consequently it must converge
to v âˆˆHm (Rn) . Let u = v|U. Then
||u âˆ’uNk||Hm(U) â‰¤||v âˆ’vNk||Hm(Rn)

41.1.
FOURIER TRANSFORM TECHNIQUES
1177
which shows the subsequence, {uNk}k converges to u. Since {uk} is a Cauchy se-
quence, it follows it too must converge to u. This proves the lemma.
The main result is next.
Theorem 41.8 Suppose U satisï¬es Assumption 41.2. Then for m a nonnegative
integer, Hm (U) = W m,2 (U) and the two norms are equivalent.
Proof: Let u âˆˆHm (U) . Then there exists v âˆˆHm (Rn) such that v|U = u.
Hence v âˆˆW k,2 (Rn) and so all its weak derivatives up to order m are in L2 (Rn) .
Therefore, the restrictions of these weak derivitves are in L2 (U) . Since U satisï¬es
the segment condition, it follows u âˆˆW m,2 (U) which shows Hm (U) âŠ†W m,2 (U) .
Next take u âˆˆW m,2 (U) . Then Eu âˆˆW m,2 (Rn) = Hm (Rn) and this shows
u âˆˆHm (U) . This has shown the two spaces are the same. It remains to verify their
norms are equivalent. Let u âˆˆHm (U) and let v|U = u where v âˆˆHm (Rn) and
||u||Hm(U) + Îµ > ||v||Hm(Rn) .
Then recalling that ||Â·||Hm(Rn) and ||Â·||m,2,Rn are equivalent norms for Hm (Rn) ,
there exists a constant, C such that
||u||Hm(U) + Îµ > ||v||Hm(Rn) â‰¥C ||v||m,2,Rn â‰¥C ||u||m,2,U
Now consider the two Banach spaces,
Â³
Hm (U) , ||Â·||Hm(U)
Â´
,
Â³
W m,2 (U) , ||Â·||m,2,U
Â´
.
The above inequality shows since Îµ > 0 is arbitrary that id :
Â³
Hm (U) , ||Â·||Hm(U)
Â´
â†’
Â³
W m,2 (U) , ||Â·||m,2,U
Â´
is continuous. By the open mapping theorem, it follows id
is continuous in the other direction. Thus there exists a constant, K such that
||u||Hm(U) â‰¤K ||u||k,2,U . Hence the two norms are equivalent as claimed.
Specializing Corollary 40.43 and Theorem 40.46 starting on Page 1166 to the case
of p = 2 while also assuming more on U yields the following embedding theorems.
Theorem 41.9 Suppose m â‰¥0 and j is a nonnegative integer satisfying 2j <
n.
Also suppose U is an open set which satisï¬es Assumption 41.2.
Then id âˆˆ
L
Â¡
Hm+j (U) , W m,q (U)
Â¢
where
q â‰¡
2n
n âˆ’2j .
(41.6)
If, in addition to the above, U is bounded and 1 â‰¤r < q, then
id âˆˆL
Â¡
Hm+j (U) , W m,r (U)
Â¢
and is compact.
Theorem 41.10 Suppose for j a nonnegative integer, 2j < n < 2 (j + 1) and let m
be a positive integer. Let U be any bounded open set in Rn which satisï¬es Assump-
tion 41.2. Then id âˆˆL
Â¡
Hm+j (U) , Cmâˆ’1,Î» Â¡
U
Â¢Â¢
for every Î» â‰¤Î»0 â‰¡(j + 1) âˆ’n
2
and if Î» < (j + 1) âˆ’n
2 , id is compact.

1178
SOBOLEV SPACES BASED ON L2
41.2
Fractional Order Spaces
What has been gained by all this? The main thing is that Hm+s (U) makes sense
for any s âˆˆ(0, 1) and m an integer. You simply replace m with m + s in the above
for s âˆˆ(0, 1). This gives what is meant by Hm+s (Rn)
Deï¬nition 41.11 For m an integer and s âˆˆ(0, 1) , let Hm+s (Rn) â‰¡
(
u âˆˆL2 (Rn) : ||u||Hm+s(Rn) â‰¡
ÂµZ
Rn
Â³
1 + |x|2Â´m+s
|Fu (x)|2 dx
Â¶1/2
< âˆž
)
.
(41.7)
You could also simply refer to Ht (Rn) where t is a real number replacing the m + s
in the above formula with t but I want to emphasize the notion that t = m+s where
m is a nonnegative integer. Therefore, I will often write m + s. Let U be an open
set in Rn. Then
Hm+s (U) â‰¡
Â©
u : u = v|U for some v âˆˆHm+s (Rn)
Âª
.
(41.8)
Deï¬ne the norm in this space by
||u||Hm+s(U) â‰¡inf
n
||v||Hm+s(Rn) : v|U = u
o
.
(41.9)
Lemma 41.12 Hm+s (U) is a Banach space.
Proof: Just repeat the proof of Lemma 41.7.
The theorem about density of S also remains true in Hm+s (Rn) . Just repeat
the proof of that part of Lemma 41.5 replacing the integer, m, with the symbol,
m + s.
Lemma 41.13 S is dense in Hm+s (Rn).
In fact, more can be said.
Corollary 41.14 Let U be an open set and let S|U denote the restrictions of func-
tions of S to U. Then S|U is dense in Ht (U) .
Proof: Let u âˆˆHt (U) and let v âˆˆHt (Rn) such that v|U = u a.e. Then since
S is dense in Ht (Rn) , there exists w âˆˆS such that
||w âˆ’v||Ht(Rn) < Îµ.
It follows that
||u âˆ’w||Ht(U)
â‰¤
||u âˆ’v||Ht(U) + ||v âˆ’w||Ht(U)
â‰¤
0 + ||v âˆ’w||Ht(Rn) < Îµ.
These fractional order spaces are important when trying to understand the trace
on the boundary.
The Fourier transform description also makes it very easy to
establish interesting inequalities such as interpolation inequalities.

41.2.
FRACTIONAL ORDER SPACES
1179
Lemma 41.15 Let 0 â‰¤r < s < t. Then if u âˆˆHt (Rn) ,
||u||Hs(Rn) â‰¤||u||Î¸
Hr(Rn) ||u||1âˆ’Î¸
Ht(Rn)
where Î¸ is a positve number such that Î¸r + (1 âˆ’Î¸) t = s.
Proof: This follows from Holderâ€™s inequality applied to the measure Âµ given by
Âµ (E) =
Z
E
|Fu|2 dx
Thus
Z Â³
1 + |x|2Â´s
|Fu|2 dx
=
Z Â³
1 + |x|2Â´rÎ¸ Â³
1 + |x|2Â´(1âˆ’Î¸)t
|Fu|2 dx
â‰¤
ÂµZ Â³
1 + |x|2Â´r
|Fu|2 dx
Â¶Î¸ ÂµZ Â³
1 + |x|2Â´(1âˆ’Î¸)t
|Fu|2 dx
Â¶1âˆ’Î¸
=
||u||2Î¸
Hr(Rn) ||u||2(1âˆ’Î¸)
Ht(Rn) .
Taking square roots yields the desired inequality.
Corollary 41.16 Let U be an open set satisfying Assumption 41.2 and let p < q
where p, q are two nonnegative integers. Also let t âˆˆ(p, q) . Then exists a constant,
C independent of u âˆˆHq (U) such that for all u âˆˆHq (U) ,
||u||Ht(U) â‰¤C ||u||Î¸
Hp(U) ||u||1âˆ’Î¸
Hq(U)
where Î¸ is such that t = Î¸p + (1 âˆ’Î¸) q.
Proof: Let E âˆˆL (Hq (U) , Hq (Rn)) such that for all positive integers, l less
than or equal to q, E âˆˆL
Â¡
Hl (U) , Hl (Rn)
Â¢
. Then Eu|U = u and Eu âˆˆHt (Rn) .
Therefore, by Lemma 41.15,
||u||Ht(U)
â‰¤
||Eu||Ht(Rn) â‰¤||Eu||Î¸
Hp(Rn) ||Eu||1âˆ’Î¸
Hq(Rn)
â‰¤
C ||u||Î¸
Hp(U) ||u||1âˆ’Î¸
Hq(U) .
Now recall the very important Theorem 40.14 on Page 1143 which is listed here
for convenience.
Theorem 41.17 Let h : U â†’V be one to one and onto where U and V are two
open sets. Also suppose that DÎ±h and DÎ± Â¡
hâˆ’1Â¢
exist and are Lipschitz continuous
if |Î±| â‰¤m âˆ’1 for m a positive integer. Then
hâˆ—: W m,p (V ) â†’W m,p (U)
is continuous, linear, one to one, and has an inverse with the same properties, the
inverse being
Â¡
hâˆ’1Â¢âˆ—.

1180
SOBOLEV SPACES BASED ON L2
Is there something like this for the fractional order spaces? Yes there is. How-
ever, in order to prove it, it is convenient to use an equivalent norm for Hm+s (Rn)
which does not depend explicitly on the Fourier transform. The following theorem
is similar to one in [28]. It describes the norm in Hm+s (Rn) in terms which are
free of the Fourier transform. This is also called an intrinsic norm [1].
Theorem 41.18 Let s âˆˆ(0, 1) and let m be a nonnegative integer. Then an equiv-
alent norm for Hm+s (Rn) is
|||u|||2
m+s â‰¡||u||2
m,2,Rn +
X
|Î±|=m
Z Z
|DÎ±u (x) âˆ’DÎ±u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy.
Also if |Î²| â‰¤m, there are constants, m (s) and M (s) such that
m (s)
Z
|Fu (z)|2 Â¯Â¯zÎ²Â¯Â¯2 |z|2s dz â‰¤
Z Z Â¯Â¯DÎ²u (x) âˆ’DÎ²u (y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy
â‰¤M (s)
Z
|Fu (z)|2 Â¯Â¯zÎ²Â¯Â¯2 |z|2s dz
(41.10)
Proof: Let u âˆˆS which is dense in Hm+s (Rn). The Fourier transform of the
function, y â†’DÎ±u (x + y) âˆ’DÎ±u (y) equals
Â¡
eixÂ·z âˆ’1
Â¢
FDÎ±u (z) .
Now by Fubiniâ€™s theorem and Plancherelâ€™s theorem along with the above, taking
|Î±| = m,
Z Z
|DÎ±u (x) âˆ’DÎ±u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
=
Z Z
|DÎ±u (y + t) âˆ’DÎ±u (y)|2 |t|âˆ’nâˆ’2s dtdy
=
Z
|t|âˆ’nâˆ’2s
Z
|DÎ±u (y + t) âˆ’DÎ±u (y)|2 dydt
=
Z
|t|âˆ’nâˆ’2s
Z Â¯Â¯Â¡
eitÂ·z âˆ’1
Â¢
FDÎ±u (z)
Â¯Â¯2 dzdt
=
Z
|FDÎ±u (z)|2
ÂµZ
|t|âˆ’nâˆ’2s Â¯Â¯Â¡
eitÂ·z âˆ’1
Â¢Â¯Â¯2 dt
Â¶
dz.
(41.11)
Consider the inside integral, the one taken with respect to t.
G (z) â‰¡
ÂµZ
|t|âˆ’nâˆ’2s Â¯Â¯Â¡
eitÂ·z âˆ’1
Â¢Â¯Â¯2 dt
Â¶
.
The essential thing to notice about this function of z is that it is a positive real
number whenever z Ì¸= 0. This is because for small |t| , the integrand is dominated
by C |t|âˆ’n+2(1âˆ’s) . Changing to polar coordinates, you see that
Z
[|t|â‰¤1]
|t|âˆ’nâˆ’2s Â¯Â¯Â¡
eitÂ·z âˆ’1
Â¢Â¯Â¯2 dt < âˆž

41.2.
FRACTIONAL ORDER SPACES
1181
Next, for |t| > 1, the integrand is bounded by 4 |t|âˆ’nâˆ’2s , and changing to polar
coordinates shows
Z
[|t|>1]
|t|âˆ’nâˆ’2s Â¯Â¯Â¡
eitÂ·z âˆ’1
Â¢Â¯Â¯2 dt â‰¤4
Z
[|t|>1]
|t|âˆ’nâˆ’2s dt < âˆž.
Now for Î± > 0,
G (Î±z)
=
Z
|t|âˆ’nâˆ’2s Â¯Â¯Â¡
eitÂ·Î±z âˆ’1
Â¢Â¯Â¯2 dt
=
Z
|t|âˆ’nâˆ’2s Â¯Â¯Â¡
eiÎ±tÂ·z âˆ’1
Â¢Â¯Â¯2 dt
=
Z Â¯Â¯Â¯ r
Î±
Â¯Â¯Â¯
âˆ’nâˆ’2s Â¯Â¯Â¡
eirÂ·z âˆ’1
Â¢Â¯Â¯2 1
Î±n dr
=
Î±2s
Z
|r|âˆ’nâˆ’2s Â¯Â¯Â¡
eirÂ·z âˆ’1
Â¢Â¯Â¯2 dr = Î±2sG (z) .
Also G is continuous and strictly positive. Letting
0 < m (s) = min {G (w) : |w| = 1}
and
M (s) = max {G (w) : |w| = 1} ,
it follows from this, and letting Î± = |z| , w â‰¡z/ |z| , that
G (z) âˆˆ
Â³
m (s) |z|2s , M (s) |z|2sÂ´
.
More can be said but this will suï¬ƒce. Also observe that for s âˆˆ(0, 1) and b > 0,
(1 + b)s â‰¤1 + bs, 21âˆ’s (1 + b)s â‰¥1 + bs.
In what follows, C (s) will denote a constant which depends on the indicated quan-
tities which may be diï¬€erent on diï¬€erent lines of the argument. Then from 41.11,
Z Z
|DÎ±u (x) âˆ’DÎ±u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
â‰¤
M (s)
Z
|FDÎ±u (z)|2 |z|2s dz
=
M (s)
Z
|Fu (z)|2 |zÎ±|2 |z|2s dz.
No referrence was made to |Î±| = m and so this establishes the top half of 41.10.
Therefore,
|||u|||2
m+s
â‰¡
||u||2
m,2,Rn +
X
|Î±|=m
Z Z
|DÎ±u (x) âˆ’DÎ±u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
â‰¤
C
Z Â³
1 + |z|2Â´m
|Fu (z)|2 dz + M (s)
Z
|Fu (z)|2 X
|Î±|=m
|zÎ±|2 |z|2s dz

1182
SOBOLEV SPACES BASED ON L2
Recall that
X
|Î±|â‰¤m
z2Î±1
1
Â· Â· Â· z2Î±n
n
â‰¤
ï£«
ï£­1 +
n
X
j=1
z2
j
ï£¶
ï£¸
m
â‰¤C (n, m)
X
|Î±|â‰¤m
z2Î±1
1
Â· Â· Â· z2Î±n
n
.
(41.12)
Therefore, where C (n, m) is the largest of the multinomial coeï¬ƒcients obtained in
the expansion,
ï£«
ï£­1 +
n
X
j=1
z2
j
ï£¶
ï£¸
m
.
Therefore,
|||u|||2
m+s
â‰¤
C
Z Â³
1 + |z|2Â´m
|Fu (z)|2 dz + M (s)
Z
|Fu (z)|2 X
|Î±|=m
|zÎ±|2 |z|2s dz
â‰¤
C
Z Â³
1 + |z|2Â´m+s
|Fu (z)|2 dz + M (s)
Z
|Fu (z)|2 Â³
1 + |z|2Â´m
|z|2s dz
â‰¤
C
Z Â³
1 + |z|2Â´m+s
|Fu (z)|2 dz = C ||u||Hm+s(Rn) .
It remains to show the other inequality. From 41.11,
Z Z
|DÎ±u (x) âˆ’DÎ±u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
â‰¥
m (s)
Z
|FDÎ±u (z)|2 |z|2s dz
=
m (s)
Z
|Fu (z)|2 |zÎ±|2 |z|2s dz.
No reference was made to |Î±| = m and so this establishes the bottom half of 41.10.
Therefore, from 41.12,
|||u|||2
m+s
â‰¥
C
Z Â³
1 + |z|2Â´m
|Fu (z)|2 dz + m (s)
Z
|Fu (z)|2 X
|Î±|=m
|zÎ±|2 |z|2s dz
â‰¥
C
Z Â³
1 + |z|2Â´m
|Fu (z)|2 dz + C
Z
|Fu (z)|2 Â³
1 + |z|2Â´m
|z|2s dz
=
C
Z Â³
1 + |z|2Â´m Â³
1 + |z|2sÂ´
|Fu (z)|2 dz
â‰¥
C
Z Â³
1 + |z|2Â´m Â³
1 + |z|2Â´s
|Fu (z)|2 dz
=
C
Z Â³
1 + |z|2Â´m+s
|Fu (z)|2 dz = ||u||Hm+s(Rn) .

41.2.
FRACTIONAL ORDER SPACES
1183
This proves the theorem.
With the above intrinsic norm, it becomes possible to prove the following version
of Theorem 41.17.
Lemma 41.19 Let h : Rn â†’Rn be one to one and onto. Also suppose that DÎ±h
and DÎ± Â¡
hâˆ’1Â¢
exist and are Lipschitz continuous if |Î±| â‰¤m for m a positive integer.
Then
hâˆ—: Hm+s (Rn) â†’Hm+s (Rn)
is continuous, linear, one to one, and has an inverse with the same properties, the
inverse being
Â¡
hâˆ’1Â¢âˆ—.
Proof: Let u âˆˆS. From Theorem 41.17 and the equivalence of the norms in
W m,2 (Rn) and Hm (Rn) ,
||hâˆ—u||2
Hm(Rn) +
R R P
|Î±|=m |DÎ±hâˆ—u (x) âˆ’DÎ±hâˆ—u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
â‰¤C ||u||2
Hm(Rn) +
R R P
|Î±|=m |DÎ±hâˆ—u (x) âˆ’DÎ±hâˆ—u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
= C ||u||2
Hm(Rn) +
R R P
|Î±|=m
Â¯Â¯Â¯
P
|Î²(Î±)|â‰¤m hâˆ—Â¡
DÎ²(Î±)u
Â¢
gÎ²(Î±) (x)
âˆ’hâˆ—Â¡
DÎ²(Î±)u
Â¢
gÎ²(Î±) (y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy
â‰¤C ||u||2
Hm(Rn) + C
R R P
|Î±|=m
P
|Î²(Î±)|â‰¤m
Â¯Â¯hâˆ—Â¡
DÎ²(Î±)u
Â¢
gÎ²(Î±) (x)
âˆ’hâˆ—Â¡
DÎ²(Î±)u
Â¢
gÎ²(Î±) (y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy
(41.13)
A single term in the last sum corresponding to a given Î± is then of the form,
Z Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
gÎ² (x) âˆ’hâˆ—Â¡
DÎ²u
Â¢
gÎ² (y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy
(41.14)
â‰¤
Â·Z Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(x) gÎ² (x) âˆ’hâˆ—Â¡
DÎ²u
Â¢
(y) gÎ² (x)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy +
Z Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(y) gÎ² (x) âˆ’hâˆ—Â¡
DÎ²u
Â¢
(y) gÎ² (y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy
Â¸
â‰¤
Â·
C (h)
Z Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(x) âˆ’hâˆ—Â¡
DÎ²u
Â¢
(y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy +
Z Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(y)
Â¯Â¯2 |gÎ² (x) âˆ’gÎ² (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
Â¸
.
Changing variables, and then using the names of the old variables to simplify the
notation,
â‰¤
Â·
C
Â¡
h, hâˆ’1Â¢ Z Z Â¯Â¯Â¡
DÎ²u
Â¢
(x) âˆ’
Â¡
DÎ²u
Â¢
(y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy +

1184
SOBOLEV SPACES BASED ON L2
Z Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(y)
Â¯Â¯2 |gÎ² (x) âˆ’gÎ² (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
Â¸
.
By 41.10,
â‰¤
C (h)
Z
|F (u) (z)|2 Â¯Â¯zÎ²Â¯Â¯2 |z|2s dz
+
Z Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(y)
Â¯Â¯2 |gÎ² (x) âˆ’gÎ² (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy.
In the second term, let t = x âˆ’y. Then this term is of the form
Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(y)
Â¯Â¯2 Z
|gÎ² (y + t) âˆ’gÎ² (y)|2 |t|âˆ’nâˆ’2s dtdy
(41.15)
â‰¤
C
Z Â¯Â¯hâˆ—Â¡
DÎ²u
Â¢
(y)
Â¯Â¯2 dy â‰¤C ||u||2
Hm(Rn) .
(41.16)
because the inside integral equals a constant which depends on the Lipschitz con-
stants and bounds of the function, gÎ² and these things depend only on h. The
reason this integral is ï¬nite is that for |t| â‰¤1,
|gÎ² (y + t) âˆ’gÎ² (y)|2 |t|âˆ’nâˆ’2s â‰¤K |t|2 |t|âˆ’nâˆ’2s
and using polar coordinates, you see
Z
[|t|â‰¤1]
|gÎ² (y + t) âˆ’gÎ² (y)|2 |t|âˆ’nâˆ’2s dt < âˆž.
Now for |t| > 1, the integrand in 41.15 is dominated by 4 |t|âˆ’nâˆ’2s and using polar
coordinates, this yields
Z
[|t|>1]
|gÎ² (y + t) âˆ’gÎ² (y)|2 |t|âˆ’nâˆ’2s dt â‰¤4
Z
[|t|>1]
|t|âˆ’nâˆ’2s dt < âˆž.
It follows 41.14 is dominated by an expression of the form
C (h)
Z
|F (u) (z)|2 Â¯Â¯zÎ²Â¯Â¯2 |z|2s dz + C ||u||2
Hm(Rn)
and so the sum in 41.13 is dominated by
C (m, h)
Z
|F (u) (z)|2 |z|2s X
|Î²|â‰¤m
Â¯Â¯zÎ²Â¯Â¯2 dz + C ||u||2
Hm(Rn)
â‰¤
C (m, h)
Z
|F (u) (z)|2 Â³
1 + |z|2Â´s Â³
1 + |z|2Â´m
dz + C ||u||2
Hm(Rn)
â‰¤
C ||u||2
Hm+s(Rn) .
This proves the theorem because the assertion about hâˆ’1 is obvious. Just replace
h with hâˆ’1 in the above argument.
Next consider the case where U is an open set.

41.2.
FRACTIONAL ORDER SPACES
1185
Lemma 41.20 Let h (U) âŠ†V where U and V are open subsets of Rn and sup-
pose that h, hâˆ’1 : Rn â†’Rn are both functions in Cm,1 (Rn) . Recall this means
DÎ±h and DÎ±hâˆ’1 exist and are Lipschitz continuous for all |Î±| â‰¤m. Then hâˆ—âˆˆ
L (Hm+s (V ) , Hm+s (U)).
Proof: Let u âˆˆHm+s (V ) and let v âˆˆHm+s (Rn) such that v|V = u. Then
from the above, hâˆ—v âˆˆHm+s (Rn) and so hâˆ—u âˆˆHm+s (U) because hâˆ—u = hâˆ—v|U.
Then by Lemma 41.19,
||hâˆ—u||Hm+s(U) â‰¤||hâˆ—v||Hm+s(Rn) â‰¤C ||v||Hm+s(Rn)
Since this is true for all v âˆˆHm+s (Rn) , it follows that
||hâˆ—u||Hm+s(U) â‰¤C ||u||Hm+s(V ) .
With harder work, you donâ€™t need to have h, hâˆ’1 deï¬ned on all of Rn but I
donâ€™t feel like including the details so this lemma will suï¬ƒce.
Another interesting application of the intrinsic norm is the following.
Lemma 41.21 Let Ï† âˆˆCm,1 (Rn) and suppose spt (Ï†) is compact.
Then there
exists a constant, CÏ† such that whenever u âˆˆHm+s (Rn) ,
||Ï†u||Hm+s(Rn) â‰¤CÏ† ||u||Hm+s(Rn) .
Proof: It is a routine exercise in the product rule to verify that ||Ï†u||Hm(Rn) â‰¤
CÏ† ||u||Hm(Rn) . It only remains to consider the term involving the integral. A typical
term is
Z Z
|DÎ±Ï†u (x) âˆ’DÎ±Ï†u (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy.
This is a ï¬nite sum of terms of the form
Z Z Â¯Â¯DÎ³Ï† (x) DÎ²u (x) âˆ’DÎ³Ï† (y) DÎ²u (y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy
where |Î³| and |Î²| â‰¤m.
â‰¤
2
Z Z
|DÎ³Ï† (x)|2 Â¯Â¯DÎ²u (x) âˆ’DÎ²u (y)
Â¯Â¯2 |x âˆ’y|âˆ’nâˆ’2s dxdy
+2
Z Z Â¯Â¯DÎ²u (y)
Â¯Â¯2 |DÎ³Ï† (x) âˆ’DÎ³Ï† (y)|2 |x âˆ’y|âˆ’nâˆ’2s dxdy

1186
SOBOLEV SPACES BASED ON L2
By 41.10 and the Lipschitz continuity of all the derivatives of Ï†, this is dominated
by
CM (s)
Z
|Fu (z)|2 Â¯Â¯zÎ²Â¯Â¯2 |z|2s dz
+K
Z Z Â¯Â¯DÎ²u (y)
Â¯Â¯2 |x âˆ’y|2 |x âˆ’y|âˆ’nâˆ’2s dxdy
=
CM (s)
Z
|Fu (z)|2 Â¯Â¯zÎ²Â¯Â¯2 |z|2s dz
+K
Z Â¯Â¯DÎ²u (y)
Â¯Â¯2 Z
|t|âˆ’n+2(1âˆ’s) dtdy
â‰¤
C (s)
ÂµZ
|Fu (z)|2 Â¯Â¯zÎ²Â¯Â¯2 |z|2s dz + K
Z Â¯Â¯DÎ²u (y)
Â¯Â¯2 dy
Â¶
â‰¤
C (s)
Z Â³
1 + |y|2Â´m+s
|Fu (y)|2 dy.
Since there are only ï¬nitely many such terms, this proves the lemma.
Corollary 41.22 Let t = m + s for s âˆˆ[0, 1) and let U, V be open sets.
Let
Ï† âˆˆCm,1
c
(V ). This means spt (Ï†) âŠ†V and Ï† âˆˆCm,1 (Rn) . Then if u âˆˆHt (U) it
follows that uÏ† âˆˆHt (U âˆ©V ) and ||uÏ†||Ht(Uâˆ©V ) â‰¤CÏ† ||u||Ht(U) .
Proof: Let v|U = u a.e. where v âˆˆHt (Rn) . Then by Lemma 41.21, Ï†v âˆˆ
Ht (Rn) and Ï†v|Uâˆ©V = Ï†u a.e. Therefore, Ï†u âˆˆHt (U âˆ©V ) and
||Ï†u||Ht(Uâˆ©V ) â‰¤||Ï†v||Ht(Rn) â‰¤CÏ† ||v||Ht(Rn) .
Taking the inï¬mum for all such v whose restrictions equal u, this yields
||Ï†u||Ht(Uâˆ©V ) â‰¤CÏ† ||u||Ht(U) .
This proves the corollary.
41.3
Embedding Theorems
The Fourier transform description of Sobolev spaces makes possible fairly easy
proofs of various embedding theorems.
Deï¬nition 41.23 Let Cm
b (Rn) denote the functions which are m times continu-
ously diï¬€erentiable and for which
sup
|Î±|â‰¤m
sup
xâˆˆRn |DÎ±u (x)| â‰¡||u||Cm
b (Rn) < âˆž.
For U an open set, Cm Â¡
U
Â¢
denotes the functions which are restrictions of Cm
b (Rn)
to U.

41.3.
EMBEDDING THEOREMS
1187
It is clear this is a Banach space, the proof being a simple exercise in the use
of the fundamental theorem of calculus along with standard results about uniform
convergence.
Lemma 41.24 Let u âˆˆS and let n
2 + m < t. Then there exists C independent of
u such that
||u||Cm
b (Rn) â‰¤C ||u||Ht(Rn) .
Proof: Using the fact that the Fourier transform maps S to S and the deï¬nition
of the Fourier transform,
|DÎ±u (x)|
â‰¤
C ||FDÎ±u||L1(Rn)
=
C
Z
|xÎ±| |Fu (x)| dx
â‰¤
C
Z Â³
1 + |x|2Â´|Î±|/2
|Fu (x)| dx
â‰¤
C
Z Â³
1 + |x|2Â´m/2 Â³
1 + |x|2Â´âˆ’t/2 Â³
1 + |x|2Â´t/2
|Fu (x)| dx
â‰¤
C
ÂµZ Â³
1 + |x|2Â´mâˆ’t
dx
Â¶1/2 ÂµZ Â³
1 + |x|2Â´t
|Fu (x)|t
Â¶1/2
â‰¤
C ||u||Ht(Rn)
because for the given values of t and m the ï¬rst integral is ï¬nite. This follows from
a use of polar coordinates. Taking sup over all x âˆˆRn and |Î±| â‰¤m, this proves the
lemma.
Corollary 41.25 Let u âˆˆHt (Rn) where t > m + n
2 . Then u is a.e. equal to a
function of Cm
b (Rn) still denoted by u. Furthermore, there exists a constant, C
independent of u such that
||u||Cm
b (Rn) â‰¤C ||u||Ht(Rn) .
Proof: This follows from the above lemma. Let {uk} be a sequence of functions
of S which converges to u in Ht and a.e. Then by the inequality of the above
lemma, this sequence is also Cauchy in Cm
b (Rn) and taking the limit,
||u||Cm
b (Rn) = lim
kâ†’âˆž||uk||Cm
b (Rn) â‰¤C lim
kâ†’âˆž||uk||Ht(Rn) = C ||u||Ht(Rn) .
What about open sets, U?
Corollary 41.26 Let t > m + n
2 and let U be an open set with u âˆˆHt (U) . Then
u is a.e. equal to a function of Cm Â¡
U
Â¢
still denoted by u. Furthermore, there exists
a constant, C independent of u such that
||u||Cm(U) â‰¤C ||u||Ht(U) .

1188
SOBOLEV SPACES BASED ON L2
Proof: Let u âˆˆHt (U) and let v âˆˆHt (Rn) such that v|U = u. Then
||u||Cm(U) â‰¤||v||Cm
b (Rn) â‰¤C ||v||Ht(Rn) .
Now taking the inf for all such v yields
||u||Cm(U) â‰¤C ||u||Ht(U) .
41.4
The Trace On The Boundary Of A Half Space
It is important to consider the restriction of functions in a Sobolev space onto a
smaller dimensional set such as the boundary of an open set.
Deï¬nition 41.27 For u âˆˆS, deï¬ne Î³u a function deï¬ned on Rnâˆ’1 by Î³u (xâ€²) â‰¡
u (xâ€², 0) where xâ€² âˆˆRnâˆ’1 is deï¬ned by x = (xâ€², xn).
The following elementary lemma featuring trig. substitutions is the basis for the
proof of some of the arguments which follow.
Lemma 41.28 Consider the integral,
Z
R
Â¡
a2 + x2Â¢âˆ’t dx.
for a > 0 and t > 1/2. Then this integral is of the form Ctaâˆ’2t+1 where Ct is some
constant which depends on t.
Proof: Letting x = a tan Î¸,
Z
R
Â¡
a2 + x2Â¢âˆ’t dx = aâˆ’2t+1
Z Ï€/2
âˆ’Ï€/2
cos2tâˆ’2 (Î¸) dÎ¸
and since t > 1/2 the last integral is ï¬nite. This yields the desired conclusion and
proves the lemma.
Lemma 41.29 Let u âˆˆS. Then there exists a constant, Cn, depending on n but
independent of u âˆˆS such that
FÎ³u (xâ€²) = Cn
Z
R
Fu (xâ€², xn) dxn.
Proof: Using the dominated convergence theorem,
Z
R
Fu (xâ€², xn) dxn â‰¡lim
Îµâ†’0
Z
R
eâˆ’(Îµxn)2Fu (xâ€², xn) dxn

41.4.
THE TRACE ON THE BOUNDARY OF A HALF SPACE
1189
â‰¡
lim
Îµâ†’0
Z
R
eâˆ’(Îµxn)2 Âµ 1
2Ï€
Â¶n/2 Z
Rn eâˆ’i(xâ€²Â·yâ€²+xnyn)u (yâ€², yn) dyâ€²dyndxn
=
lim
Îµâ†’0
Âµ 1
2Ï€
Â¶n/2 Z
Rn u (yâ€², yn) eâˆ’ixâ€²Â·yâ€² Z
R
eâˆ’(Îµxn)2eâˆ’ixnyndxndyâ€²dyn.
Now âˆ’(Îµxn)2 âˆ’ixnyn = âˆ’Îµ2 Â¡
xn + iyn
2
Â¢2 âˆ’Îµ2 y2
n
4 and so the above reduces to an
expression of the form
lim
Îµâ†’0 Kn
Z
R
1
Îµeâˆ’Îµ2 y2
n
4
Z
Rnâˆ’1 u (yâ€², yn) eâˆ’ixâ€²Â·yâ€²dyâ€²dyn
=
Kn
Z
Rn u (yâ€², 0) eâˆ’ixâ€²Â·yâ€²dyâ€²
=
KnFÎ³u (xâ€²)
and this proves the lemma with Cn â‰¡Kâˆ’1
n .
Earlier Ht (Rn) was deï¬ned and then for U an open subset of Rn, Ht (U) was
deï¬ned to be the space of restrictions of functions of Ht (Rn) to U and a norm
was given which made Ht (U) into a Banach space. The next task is to consider
Rnâˆ’1Ã—{0} , a smaller dimensional subspace of Rn and examine the functions deï¬ned
on this set, denoted by Rnâˆ’1 for short which are restrictions of functions in Ht (Rn) .
You note this is somewhat diï¬€erent because heuristically, the dimension of the
domain of the function is changing. An open set in Rn is considered an n dimensional
thing but Rnâˆ’1 is only nâˆ’1 dimensional. I realize this is vague because the standard
deï¬nition of dimension requires a vector space and an open set is not a vector space.
However, think in terms of fatness. An open set is fat in n directions whereas Rnâˆ’1
is only fat in n âˆ’1 directions. Therefore, something interesting is likely to happen.
Let S denote the Schwartz class of functions on Rn and Sâ€² the Schwartz class of
functions on Rnâˆ’1. Also, yâ€² âˆˆRnâˆ’1 while y âˆˆRn. Let u âˆˆS. Then from Lemma
41.29 and s > 0,
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´s
|FÎ³u (yâ€²)|2 dyâ€²
=
Cn
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´s Â¯Â¯Â¯Â¯
Z
R
Fu (yâ€², yn) dyn
Â¯Â¯Â¯Â¯
2
dyâ€²
= Cn
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´s Â¯Â¯Â¯Â¯
Z
R
Fu (yâ€², yn)
Â³
1 + |y|2Â´t/2 Â³
1 + |y|2Â´âˆ’t/2
dyn
Â¯Â¯Â¯Â¯
2
dyâ€²
Then by the Cauchy Schwarz inequality,
â‰¤Cn
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´s Z
R
|Fu (yâ€², yn)|2 Â³
1 + |y|2Â´t
dyn
Z
R
Â³
1 + |y|2Â´âˆ’t
dyndyâ€².
(41.17)
Consider
Z
R
Â³
1 + |y|2Â´âˆ’t
dyn =
Z
R
Â³
1 + |yâ€²|2 + y2
n
Â´âˆ’t
dyn

1190
SOBOLEV SPACES BASED ON L2
by Lemma 41.28 and taking a =
Â³
1 + |yâ€²|2Â´1/2
, this equals
Ct
ÂµÂ³
1 + |yâ€²|2Â´1/2Â¶âˆ’2t+1
= Ct
Â³
1 + |yâ€²|2Â´(âˆ’2t+1)/2
.
Now using this in 41.17,
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´s
|FÎ³u (yâ€²)|2 dyâ€²
â‰¤
Cn,t
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´s Z
R
|Fu (yâ€², yn)|2 Â³
1 + |y|2Â´t
dyn Â·
Â³
1 + |yâ€²|2Â´(âˆ’2t+1)/2
dyâ€²
=
Cn,t
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´s+(âˆ’2t+1)/2 Z
R
|Fu (yâ€², yn)|2 Â³
1 + |y|2Â´t
dyndyâ€².
What is the correct choice of t so that the above reduces to ||u||2
Ht(Rn)? It is clearly
the one for which
s + (âˆ’2t + 1) /2 = 0
which occurs when t = s + 1
2. Then for this choice of t, the following inequality is
obtained for any u âˆˆS.
||Î³u||Htâˆ’1/2(Rnâˆ’1) â‰¤Cn,t ||u||Ht(Rn) .
(41.18)
This has proved part of the following theorem.
Theorem 41.30 For each t > 1/2 there exists a unique mapping
Î³ âˆˆL
Â³
Ht (Rn) , Htâˆ’1/2 Â¡
Rnâˆ’1Â¢Â´
which has the property that for u âˆˆS, Î³u (xâ€²) = u (xâ€², 0) . In addition to this, Î³ is
onto. In fact, there exists a continuous map, Î¶ âˆˆL
Â¡
Htâˆ’1/2 Â¡
Rnâˆ’1Â¢
, Ht (Rn)
Â¢
such
that Î³ â—¦Î¶ = id.
Proof: It only remains to verify that Î³ is onto and that the continuous map, Î¶
exists. Now deï¬ne
Ï† (y) â‰¡Ï† (yâ€², yn) â‰¡
Â³
1 + |yâ€²|2Â´tâˆ’1/2
Â³
1 + |y|2Â´t
.
Then for u âˆˆSâ€², let
Î¶u (x) â‰¡CF âˆ’1 (Ï†Fu) (x) =
C
Z
Rn eiyÂ·x
Â³
1 + |yâ€²|2Â´tâˆ’1/2
Â³
1 + |y|2Â´t
Fu (yâ€²) dy
(41.19)

41.4.
THE TRACE ON THE BOUNDARY OF A HALF SPACE
1191
Here the inside Fourier transform is taken with respect to Rnâˆ’1 because u is only
deï¬ned on Rnâˆ’1 and C will be chosen in such a way that Î³ â—¦Î¶ = id. First the
existence of C such that Î³ â—¦Î¶ = id will be shown. Since u âˆˆSâ€² it follows
y â†’
Â³
1 + |yâ€²|2Â´tâˆ’1/2
Â³
1 + |y|2Â´t
Fu (yâ€²)
is in S. Hence the inverse Fourier transform of this function is also in S and so
for u âˆˆSâ€², it follows Î¶u âˆˆS. Therefore, to check Î³ â—¦Î¶ = id it suï¬ƒces to plug in
xn = 0. From Lemma 41.28 this yields
Î³ (Î¶u) (xâ€², 0)
=
C
Z
Rn eiyâ€²Â·xâ€²
Â³
1 + |yâ€²|2Â´tâˆ’1/2
Â³
1 + |y|2Â´t
Fu (yâ€²) dy
=
C
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´tâˆ’1/2
eiyâ€²Â·xâ€²Fu (yâ€²)
Z
R
1
Â³
1 + |y|2Â´t dyndyâ€²
=
CCt
Z
Rnâˆ’1
Â³
1 + |yâ€²|2Â´tâˆ’1/2
eiyâ€²Â·xâ€²Fu (yâ€²)
Â³
1 + |yâ€²|2Â´ âˆ’2t+1
2
dyâ€²
=
CCt
Z
Rnâˆ’1 eiyâ€²Â·xâ€²Fu (yâ€²) dyâ€² = CCt (2Ï€)n/2 F âˆ’1 (Fu) (xâ€²)
and so the correct value of C is
Â³
Ct (2Ï€)n/2Â´âˆ’1
to obtain Î³ â—¦Î¶ = id. It only remains
to verify that Î¶ is continuous. From 41.19, and Lemma 41.28,
||Î¶u||2
Ht(Rn)
=
Z
Rn
Â³
1 + |x|2Â´t
|FÎ¶u (x)|2 dx
=
C2
Z
Rn
Â³
1 + |x|2Â´t Â¯Â¯F
Â¡
F âˆ’1 (Ï†Fu) (x)
Â¢Â¯Â¯2 dx
=
C2
Z
Rn
Â³
1 + |x|2Â´t
|Ï† (x) Fu (xâ€²)|2 dx
=
C2
Z
Rn
Â³
1 + |x|2Â´t
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Â³
1 + |xâ€²|2Â´tâˆ’1/2
Â³
1 + |x|2Â´t
Fu (xâ€²)
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
2
dx
=
C2
Z
Rn
Â³
1 + |x|2Â´âˆ’t Â¯Â¯Â¯Â¯
Â³
1 + |xâ€²|2Â´tâˆ’1/2
Fu (xâ€²)
Â¯Â¯Â¯Â¯
2
dx
=
C2
Z
Rnâˆ’1
Â³
1 + |xâ€²|2Â´2tâˆ’1
|Fu (xâ€²)|2
Z
R
Â³
1 + |x|2Â´âˆ’t
dxndxâ€²

1192
SOBOLEV SPACES BASED ON L2
=
C2Ct
Z
Rnâˆ’1
Â³
1 + |xâ€²|2Â´2tâˆ’1
|Fu (xâ€²)|2 Â³
1 + |yâ€²|2Â´ âˆ’2t+1
2
dxâ€²
=
C2Ct
Z
Rnâˆ’1
Â³
1 + |xâ€²|2Â´tâˆ’1/2
|Fu (xâ€²)|2 dxâ€² = C2Ct ||u||2
Htâˆ’1/2(Rnâˆ’1) .
This proves the theorem because S is dense in Rn.
Actually, the assertion that Î³u (xâ€²) = u (xâ€², 0) holds for more functions, u than
just u âˆˆS. I will make no eï¬€ort to obtain the most general description of such
functions but the following is a useful lemma which will be needed when the trace
on the boundary of an open set is considered.
Lemma 41.31 Suppose u is continuous and u âˆˆH1 (Rn) . Then there exists a set
of m1 measure zero, N such that if xn /âˆˆN, then for every Ï† âˆˆL2 Â¡
Rnâˆ’1Â¢
(Î³u, Ï†)H +
Z xn
0
(u,n (Â·, t) , Ï†)H dt = (u (Â·, xn) , Ï†)H
where here
(f, g)H â‰¡
Z
Rnâˆ’1 fgdxâ€²,
just the inner product in L2 Â¡
Rnâˆ’1Â¢
. Furthermore,
u (Â·, 0) = Î³u a.e. xâ€².
Proof: Let {uk} be a sequence of functions from S which converges to u in
H1 (Rn) and let {Ï†k} denote a countable dense subset of L2 Â¡
Rnâˆ’1Â¢
. Then
Â¡
Î³uk, Ï†j
Â¢
H +
Z xn
0
Â¡
uk,n (Â·, t) , Ï†j
Â¢
H dt =
Â¡
uk (Â·, xn) , Ï†j
Â¢
H .
(41.20)
Now
ÂµZ âˆž
0
Â¯Â¯Â¯
Â¡
uk (Â·, xn) , Ï†j
Â¢
H âˆ’
Â¡
u (Â·, xn) , Ï†j
Â¢
H
Â¯Â¯Â¯
2
dxn
Â¶1/2
=
ÂµZ âˆž
0
Â¯Â¯Â¯
Â¡
uk (Â·, xn) âˆ’u (Â·, xn) , Ï†j
Â¢
H
Â¯Â¯Â¯
2
dxn
Â¶1/2
â‰¤
ÂµZ âˆž
0
|uk (Â·, xn) âˆ’u (Â·, xn)|2
H
Â¯Â¯Ï†j
Â¯Â¯2
H dxn
Â¶1/2
=
Â¯Â¯Ï†j
Â¯Â¯2
H
ÂµZ âˆž
0
|uk (Â·, xn) âˆ’u (Â·, xn)|2
H dxn
Â¶1/2
=
Â¯Â¯Ï†j
Â¯Â¯2
H
ÂµZ âˆž
0
Z
Rnâˆ’1 |uk (xâ€², xn) âˆ’u (xâ€², xn)|2 dxâ€²dxn
Â¶1/2
which converges to zero. Therefore, there exists a set of measure zero, Nj and a
subsequence, still denoted by k such that if xn /âˆˆNj, then
Â¡
uk (Â·, xn) , Ï†j
Â¢
H â†’
Â¡
u (Â·, xn) , Ï†j
Â¢
H .

41.4.
THE TRACE ON THE BOUNDARY OF A HALF SPACE
1193
Now by Theorem 41.30, Î³uk â†’Î³u in H = L2 Â¡
Rnâˆ’1Â¢
. It only remains to consider
the term of 41.20 which involves an integral.
Â¯Â¯Â¯Â¯
Z xn
0
Â¡
uk,n (Â·, t) , Ï†j
Â¢
H dt âˆ’
Z xn
0
Â¡
u,n (Â·, t) , Ï†j
Â¢
H dt
Â¯Â¯Â¯Â¯
â‰¤
Z xn
0
Â¯Â¯Â¯
Â¡
uk,n (Â·, t) âˆ’u,n (Â·, t) , Ï†j
Â¢
H
Â¯Â¯Â¯ dt
â‰¤
Z xn
0
|uk,n (Â·, t) âˆ’u,n (Â·, t)|H
Â¯Â¯Ï†j
Â¯Â¯
H dt
â‰¤
ÂµZ xn
0
|uk,n (Â·, t) âˆ’u,n (Â·, t)|2
H dt
Â¶1/2 ÂµZ xn
0
Â¯Â¯Ï†j
Â¯Â¯2
H dt
Â¶1/2
=
x1/2
n
Â¯Â¯Ï†j
Â¯Â¯
H
ÂµZ xn
0
Z
Rnâˆ’1 |uk,n (xâ€², t) âˆ’u,n (xâ€², t)|2 dxâ€²
Â¶1/2
dt
and this converges to zero as k â†’âˆž. Therefore, using a diagonal sequence ar-
gument, there exists a subsequence, still denoted by k and a set of measure zero,
N â‰¡âˆªâˆž
j=1Nj such that for xâ€² /âˆˆN, you can pass to the limit in 41.20 and obtain
that for all Ï†j,
Â¡
Î³u, Ï†j
Â¢
H +
Z xn
0
Â¡
u,n (Â·, t) , Ï†j
Â¢
H dt =
Â¡
u (Â·, xn) , Ï†j
Â¢
H .
By density of
Â©
Ï†j
Âª
, this equality holds for all Ï† âˆˆL2 Â¡
Rnâˆ’1Â¢
. In particular, the
equality holds for every Ï† âˆˆCc
Â¡
Rnâˆ’1Â¢
. Since u is uniformly continuous on the
compact set, spt (Ï†)Ã—[0, 1] , there exists a sequence, (xn)k â†’0 such that the above
equality holds for xn replaced with (xn)k and Ï† in place of Ï†j. Now taking k â†’âˆž,
this uniform continuity implies
(Î³u, Ï†)H = (u (Â·, 0) , Ï†)H
This implies since Cc
Â¡
Rnâˆ’1Â¢
is dense in L2 Â¡
Rnâˆ’1Â¢
that Î³u = u (Â·, 0) a.e. and this
proves the lemma.
Lemma 41.32 Suppose U is an open subset of Rnof the form
U â‰¡{u âˆˆRn : uâ€² âˆˆU â€² and 0 < un < Ï† (uâ€²)}
where U â€² is an open subset of Rnâˆ’1 and
Ï† (uâ€²) is a positive function such that
Ï† (uâ€²) â‰¤âˆžand
inf {Ï† (uâ€²) : uâ€² âˆˆU â€²} = Î´ > 0
Suppose v âˆˆHt (Rn) such that v = 0 a.e. on U. Then Î³v = 0 mnâˆ’1 a.e. point of
U â€². Also, if v âˆˆHt (Rn) and Ï† âˆˆCâˆž
c (Rn) , then Î³vÎ³Ï† = Î³ (Ï†v) .
Proof: First consider the second claim. Let v âˆˆHt (Rn) and let vk â†’v in
Ht (Rn) where vk âˆˆS. Then from Lemma 41.21 and Theorem 41.30
||Î³ (Ï†v) âˆ’Î³Ï†Î³v||Htâˆ’1/2(Rnâˆ’1) = lim
kâ†’âˆž||Î³ (Ï†vk) âˆ’Î³Ï†Î³vk||Htâˆ’1/2(Rnâˆ’1) = 0

1194
SOBOLEV SPACES BASED ON L2
because each term in the sequence equals zero due to the observation that for vk âˆˆS
and Ï† âˆˆCâˆž
c (U) , Î³ (Ï†vk) = Î³vkÎ³Ï†.
Now suppose v = 0 a.e. on U. Deï¬ne for 0 < r < Î´, vr (x) â‰¡v (xâ€², xn + r) .
Claim: If u âˆˆHt (Rn) , then
lim
râ†’0 ||vr âˆ’v||Ht(Rn) = 0.
Proof of claim: First of all, let v âˆˆS. Then v âˆˆHm (Rn) for all m and so by
Lemma 41.15,
||vr âˆ’v||Ht(Rn) â‰¤||vr âˆ’v||Î¸
Hm(Rn) ||vr âˆ’v||1âˆ’Î¸
Hm+1(Rn)
where t âˆˆ[m, m + 1] . It follows from continuity of translation in Lp (Rn) that
lim
râ†’0 ||vr âˆ’v||Î¸
Hm(Rn) ||vr âˆ’v||1âˆ’Î¸
Hm+1(Rn) = 0
and so the claim is proved if v âˆˆS. Now suppose u âˆˆHt (Rn) is arbitrary. By
density of S in Ht (Rn) , there exists v âˆˆS such that
||u âˆ’v||Ht(Rn) < Îµ/3.
Therefore,
||ur âˆ’u||Ht(Rn)
â‰¤
||ur âˆ’vr||Ht(Rn) + ||vr âˆ’v||Ht(Rn) + ||v âˆ’u||Ht(Rn)
=
2Îµ/3 + ||vr âˆ’v||Ht(Rn) .
Now using what was just shown, it follows that for r small enough, ||ur âˆ’u||Ht(Rn) <
Îµ and this proves the claim.
Now suppose v âˆˆHt (Rn) . By the claim,
||vr âˆ’v||Ht(Rn) â†’0
and so by continuity of Î³,
Î³vr â†’Î³v in Htâˆ’1/2 Â¡
Rnâˆ’1Â¢
.
(41.21)
Note vr = 0 a.e. on
Ur â‰¡{u âˆˆRn : uâ€² âˆˆU â€² and âˆ’r < un < Ï† (uâ€²) âˆ’r}
Let Ï† âˆˆCâˆž
c (Ur) and consider Ï†vr. Then it follows Ï†vr = 0 a.e. on Rn. Let
w â‰¡0. Then w âˆˆS and so Î³w = 0 = Î³ (Ï†vr) = Î³Ï†Î³vr in Htâˆ’1/2 Â¡
Rnâˆ’1Â¢
. It
follows that for mnâˆ’1 a.e. xâ€² âˆˆ[Ï† Ì¸= 0] âˆ©Rnâˆ’1, Î³vr (xâ€²) = 0. Now let U â€² = âˆªâˆž
k=1Kk
where the Kk are compact sets such that Kk âŠ†Kk+1 and let Ï†k âˆˆCâˆž
c (U) such
that Ï†k has values in [0, 1] and Ï†k (xâ€²) = 1 if xâ€² âˆˆKk. Then from what was just
shown, Î³vr = 0 for a.e. point of Kk. Therefore, Î³vr = 0 for mnâˆ’1 a.e. point in U â€².
Therefore, since each Î³vr = 0, it follows from 41.21 that Î³v = 0 also. This proves
the lemma.

41.5.
SOBOLEV SPACES ON MANIFOLDS
1195
Theorem 41.33 Let t > 1/2 and let U be of the form
{u âˆˆRn : uâ€² âˆˆU â€² and 0 < un < Ï† (uâ€²)}
where U â€² is an open subset of Rnâˆ’1 and
Ï† (uâ€²) is a positive function such that
Ï† (uâ€²) â‰¤âˆžand
inf {Ï† (uâ€²) : uâ€² âˆˆU â€²} = Î´ > 0.
Then there exists a unique
Î³ âˆˆL
Â³
Ht (U) , Htâˆ’1/2 (U â€²)
Â´
which has the property that if u = v|U where v is continuous and also a function of
H1 (Rn) , then Î³u (xâ€²) = u (xâ€², 0) for a.e. xâ€² âˆˆU â€².
Proof:
Let u âˆˆHt (U) . Then u = v|U for some v âˆˆHt (Rn) . Deï¬ne
Î³u â‰¡Î³v|U â€²
Is this well deï¬ned? The answer is yes because if vi|U = u a.e., then Î³ (v1 âˆ’v2) = 0
a.e. on U â€² which implies Î³v1 = Î³v2 a.e. and so the two diï¬€erent versions of Î³u
diï¬€er only on a set of measure zero.
If u = v|U where v is continuous and also a function of H1 (Rn) , then for a.e.
xâ€² âˆˆRnâˆ’1, it follows from Lemma 41.31 on Page 1192 that Î³v (xâ€²) = v (xâ€², 0) .
Hence, it follows that for a.e. xâ€² âˆˆU â€², Î³u (xâ€²) â‰¡u (xâ€², 0).
In particular, Î³ is determined by Î³u (xâ€²) = u (xâ€², 0) on S|U and the density of
S|U and continuity of Î³ shows Î³ is unique.
It only remains to show Î³ is continuous. Let u âˆˆHt (U) . Thus there exists
v âˆˆHt (Rn) such that u = v|U. Then
||Î³u||Htâˆ’1/2(U â€²) â‰¤||Î³v||Htâˆ’1/2(Rnâˆ’1) â‰¤C ||v||Ht(Rn)
for C independent of v. Then taking the inf for all such v âˆˆHt (Rn) which are
equal to u a.e. on U, it follows
||Î³u||Htâˆ’1/2(U â€²) â‰¤C ||v||Ht(Rn)
and this proves Î³ is continuous.
41.5
Sobolev Spaces On Manifolds
41.5.1
General Theory
The type of manifold, Î“ for which Sobolev spaces will be deï¬ned on is:
Deï¬nition 41.34
1. Î“ is a closed subset of Rp where p â‰¥n.
2. Î“ = âˆªâˆž
i=1Î“i where Î“i = Î“ âˆ©Wi for Wi a bounded open set.

1196
SOBOLEV SPACES BASED ON L2
3. {Wi}âˆž
i=1 is locally ï¬nite.
4. There are open bounded sets, Ui and functions hi : Ui â†’Î“i which are one to
one, onto, and in Cm,1 (Ui) . There exists a constant, C, such that C â‰¥Lip hr
for all r.
5. There exist functions, gi : Wi â†’Ui such that gi is Cm,1 (Wi) , and giâ—¦hi = id
on Ui while hi â—¦gi = id on Î“i.
This will be referred to as a Cm,1 manifold.
Lemma 41.35 Let gi, hi, Ui, Wi, and Î“i be as deï¬ned above. Then
gi â—¦hk : Uk âˆ©hâˆ’1
k
(Î“i) â†’Ui âˆ©hâˆ’1
i
(Î“k)
is Cm,1. Furthermore, the inverse of this map is gk â—¦hi.
Proof: First it is well to show it does indeed map the given open sets. Let
x âˆˆUkâˆ©hâˆ’1
k
(Î“i) . Then hk (x) âˆˆÎ“kâˆ©Î“i and so gi (hk (x)) âˆˆUi because hk (x) âˆˆÎ“i.
Now since hk (x) âˆˆÎ“k, gi (hk (x)) âˆˆhâˆ’1
i
(Î“k) also and this proves the mappings do
what they should in terms of mapping the two open sets. That giâ—¦hk is Cm,1 follows
immediately from the chain rule and the assumptions that the functions gi and hk
are Cm,1. The claim about the inverse follows immediately from the deï¬nitions of
the functions.
Let {Ïˆi}âˆž
i=1 be a partition of unity subordinate to the open cover {Wi} satisfying
Ïˆi âˆˆCâˆž
c (Wi) . Then the following deï¬nition provides a norm for Hm+s (Î“) .
Deï¬nition 41.36 Let s âˆˆ(0, 1) and m is a nonnegative integer. Also let Âµ denote
the surface measure for Î“ deï¬ned in the last section. A Âµ measurable function, u
is in Hm+s (Î“) if whenever {Wi, Ïˆi, Î“i, Ui, hi, gi}âˆž
i=1 is described above, hâˆ—
i (uÏˆi) âˆˆ
Hm+s (Ui) and
||u||Hm+s(Î“) â‰¡
Ãƒ âˆž
X
i=1
||hâˆ—
i (uÏˆi)||2
Hm+s(Ui)
!1/2
< âˆž.
Are there functions which are in Hm+s (Î“)? The answer is yes. Just take the
restriction to Î“ of any function, u âˆˆCâˆž
c (Rm) . Then each hâˆ—
i (uÏˆi) âˆˆHm+s (Ui)
and the sum is ï¬nite because spt u has nonempty intersection with only ï¬nitely
many Wi.
It is not at all obvious this norm is well deï¬ned. What if
Â©
W â€²
i, Ïˆâ€²
i, Î“â€²
i, Ui, hâ€²
i, gâ€²
i
Âªâˆž
i=1
is as described above? Would the two norms be equivalent? If they arenâ€™t, then
this is not a good way to deï¬ne Hm+s (Î“) because it would depend on the choice of
partition of unity and functions, hi and choice of the open sets, Ui. To begin with
pick a particular choice for {Wi, Ïˆi, Î“i, Ui, hi, gi}âˆž
i=1 .
Lemma 41.37 Hm+s (Î“) as just described, is a Banach space.

41.5.
SOBOLEV SPACES ON MANIFOLDS
1197
Proof: Let {uj}âˆž
j=1 be a Cauchy sequence in Hm+s (Î“) . Then {hâˆ—
i (ujÏˆi)}âˆž
j=1
is a Cauchy sequence in Hm+s (Ui) for each i. Therefore, for each i, there exists
wi âˆˆHm+s (Ui) such that
lim
jâ†’âˆžhâˆ—
i (ujÏˆi) = wi in Hm+s (Ui) .
(41.22)
It is required to show there exists u âˆˆHm+s (Î“) such that wi = hâˆ—
i (uÏˆi) for each i.
Now from Corollary 39.14 it follows easily by approximating with simple func-
tions that for ever nonnegative Âµ measurable function, f,
Z
Î“
fdÂµ =
âˆž
X
r=1
Z
grÎ“r
Ïˆrf (hr (u)) Jr (u) du.
Therefore,
Z
Î“
|uj âˆ’uk|2 dÂµ
=
âˆž
X
r=1
Z
grÎ“r
Ïˆr |uj âˆ’uk|2 (hr (u)) Jr (u) du
â‰¤
C
âˆž
X
r=1
Z
grÎ“r
Ïˆr |uj âˆ’uk|2 (hr (u)) du
=
C
âˆž
X
r=1
||hâˆ—
r (Ïˆr |uj âˆ’uk|)||2
0,2,Ur
â‰¤
C ||uj âˆ’uk||Hm+s(Î“)
and it follows there exists u âˆˆL2 (Î“) such that
||uj âˆ’u||0,2,Î“ â†’0.
and a subsequence, still denoted by uj such that uj (x) â†’u (x) for Âµ a.e. x âˆˆÎ“. It
is required to show that u âˆˆHm+s (Î“) such that wi = hâˆ—
i (uÏˆi) for each i. First of
all, u is measurable because it is the limit of measurable functions. The pointwise
convergence just established and the fact that sets of measure zero on Î“i correspond
to sets of measure zero on Ui which was discussed in the claim found in the proof
of Theorem 39.13 on Page 1129 shows that
hâˆ—
i (ujÏˆi) (x) â†’hâˆ—
i (uÏˆi) (x)
a.e. x. Therefore,
hâˆ—
i (uÏˆi) = wi
and this shows that hâˆ—
i (uÏˆi) âˆˆHm+s (Ui) . It remains to verify that u âˆˆHm+s (Î“) .
This follows from Fatouâ€™s lemma. From 41.22,
||hâˆ—
i (ujÏˆi)||2
Hm+s(Ui) â†’||hâˆ—
i (uÏˆi)||2
Hm+s(Ui)

1198
SOBOLEV SPACES BASED ON L2
and so
âˆž
X
i=1
||hâˆ—
i (uÏˆi)||2
Hm+s(Ui)
â‰¤
lim inf
jâ†’âˆž
âˆž
X
i=1
||hâˆ—
i (ujÏˆi)||2
Hm+s(Ui)
=
lim inf
jâ†’âˆž||uj||2
Hm+s(Î“) < âˆž.
This proves the lemma.
In fact any two such norms are equivalent. This follows from the open map-
ping theorem. Suppose ||Â·||1 and ||Â·||2 are two such norms and consider the norm
||Â·||3 â‰¡max (||Â·||1 , ||Â·||2) . Then (Hm+s (Î“) , ||Â·||3) is also a Banach space and the
identity map from this Banach space to (Hm+s (Î“) , ||Â·||i) for i = 1, 2 is continuous.
Therefore, by the open mapping theorem, there exist constants, C, Câ€² such that for
all u âˆˆHm+s (Î“) ,
||u||1 â‰¤||u||3 â‰¤C ||u||2 â‰¤C ||u||3 â‰¤CCâ€² ||u||1
Therefore,
||u||1 â‰¤C ||u||2 , ||u||2 â‰¤Câ€² ||u||1 .
This proves the following theorem.
Theorem 41.38 Let Î“ be described above. Deï¬ning Ht (Î“) as in Deï¬nition 41.36,
any two norms like those given in this deï¬nition are equivalent.
Suppose (Î“, Wi, Ui, Î“i, hi, gi) are as deï¬ned above where hi, gi are Cm,1 func-
tions. Take W, an open set in Rp and deï¬ne Î“â€² â‰¡W âˆ©Î“. Then letting
W â€²
i â‰¡W âˆ©Wi, Î“â€²
i â‰¡W â€²
i âˆ©Î“,
and
U â€²
i â‰¡gi (Î“â€²
i) = hâˆ’1
i
(W â€²
i âˆ©Î“) ,
it follows that U â€²
i is an open set because hi is continuous and (Î“â€², W â€²
i, U â€²
i, Î“â€²
i, hâ€²
i, gâ€²
i)
is also a Cm,1 manifold if you deï¬ne hâ€²
i to be the restriction of hi to U â€²
i and gâ€²
i to
be the restriction of gi to W â€²
i.
As a case of this, consider a Cm,1 manifold, Î“ where (Î“, Wi, Ui, Î“i, hi, gi) are as
described in Deï¬nition 41.34 and the submanifold consisting of Î“i. The next lemma
shows there is a simple way to deï¬ne a norm on Ht (Î“i) which does not depend on
dragging in a partition of unity.
Lemma 41.39 Suppose Î“ is a Cm,1 manifold and (Î“, Wi, Ui, Î“i, hi, gi) are as de-
scribed in Deï¬nition 41.34. Then for t âˆˆ[m, m + s), it follows that if u âˆˆHt (Î“) ,
then u âˆˆHt (Î“k) and the restriction map is continuous. Also an equivalent norm
for Ht (Î“k) is given by
|||u|||t â‰¡||hâˆ—
ku||Ht(Uk) .

41.5.
SOBOLEV SPACES ON MANIFOLDS
1199
Proof: Let u âˆˆHt (Î“) and let (Î“k, W â€²
i, U â€²
i, Î“â€²
i, hâ€²
i, gâ€²
i) be the sets and functions
which deï¬ne what is meant by Î“k being a Cm,1 manifold as described in Deï¬nition
41.34. Also let (Î“, Wi, Ui, Î“i, hi, gi) be pertain to Î“ in the same way and let
Â©
Ï†j
Âª
be a Câˆžpartition of unity for the {Wj}. Since the {W â€²
i} are locally ï¬nite, only
ï¬nitely many can intersect Î“k, say {W â€²
1, Â· Â· Â·, W â€²
s} . Also only ï¬nitely many of the Wi
can intersect Î“k, say {W1, Â· Â· Â·, Wq} . Then letting
Â©
Ïˆâ€²
i
Âª
be a Câˆžpartition of unity
subordinate to the {W â€²
i} .
âˆž
X
i=1
Â¯Â¯Â¯Â¯hâ€²âˆ—
i
Â¡
uÏˆâ€²
i
Â¢Â¯Â¯Â¯Â¯
Ht(U â€²
i)
=
s
X
i=1
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
hâ€²âˆ—
i
ï£«
ï£­
q
X
j=1
Ï†juÏˆâ€²
i
ï£¶
ï£¸
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
Ht(U â€²
i)
â‰¤
s
X
i=1
q
X
j=1
Â¯Â¯Â¯Â¯hâ€²âˆ—
i Ï†juÏˆâ€²
i
Â¯Â¯Â¯Â¯
Ht(U â€²
i)
=
q
X
j=1
s
X
i=1
Â¯Â¯Â¯Â¯hâ€²âˆ—
i Ï†juÏˆâ€²
i
Â¯Â¯Â¯Â¯
Ht(U â€²
i)
=
q
X
j=1
s
X
i=1
Â¯Â¯Â¯Â¯(gj â—¦hâ€²
i)âˆ—hâˆ—
jÏ†juÏˆâ€²
i
Â¯Â¯Â¯Â¯
Ht(U â€²
i) .
By Lemma 41.20 on page 1185, there exists a single constant, C such that the above
is dominated by
C
q
X
j=1
s
X
i=1
Â¯Â¯Â¯Â¯hâˆ—
jÏ†juÏˆâ€²
i
Â¯Â¯Â¯Â¯
Ht(Uj) .
Now by Corollary 41.22 on Page 1186, this is no larger than
C
q
X
j=1
s
X
i=1
CÏˆâ€²
i
Â¯Â¯Â¯Â¯hâˆ—
jÏ†ju
Â¯Â¯Â¯Â¯
Ht(Uj)
â‰¤
C
q
X
j=1
s
X
i=1
Â¯Â¯Â¯Â¯hâˆ—
jÏ†ju
Â¯Â¯Â¯Â¯
Ht(Uj)
â‰¤
C
q
X
j=1
Â¯Â¯Â¯Â¯hâˆ—
jÏ†ju
Â¯Â¯Â¯Â¯
Ht(Uj) < âˆž.
This shows that u restricted to Î“k is in Ht (Î“k). It also shows that the restriction
map of Ht (Î“) to Ht (Î“k) is continuous.
Now consider the norm |||Â·|||t . For u âˆˆHt (Î“k) , let (Î“k, W â€²
i, U â€²
i, Î“â€²
i, hâ€²
i, gâ€²
i) be
sets and functions which deï¬ne an atlas for Î“k. Since the {W â€²
i} are locally ï¬nite,
only ï¬nitely many can have nonempty intersection with Î“k, say {W1, Â· Â· Â·, Ws} . Thus
i â‰¤s for some ï¬nite s. The problem is to compare |||Â·|||t with ||Â·||Ht(Î“k) . As above,

1200
SOBOLEV SPACES BASED ON L2
let
Â©
Ïˆâ€²
i
Âª
denote a Câˆžpartition of unity subordinate to the
Â©
W â€²
j
Âª
. Then
|||u|||t
â‰¡
||hâˆ—
ku||Ht(Uk) =
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
hâˆ—
k
s
X
j=1
Ïˆâ€²
ju
Â¯Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯Â¯
Ht(Uk)
â‰¤
s
X
j=1
Â¯Â¯Â¯Â¯hâˆ—
k
Â¡
Ïˆâ€²
ju
Â¢Â¯Â¯Â¯Â¯
Ht(Uk)
=
s
X
j=1
Â¯Â¯Â¯
Â¯Â¯Â¯
Â¡
gâ€²
j â—¦hk
Â¢âˆ—hâ€²âˆ—
j
Â¡
Ïˆâ€²
ju
Â¢Â¯Â¯Â¯
Â¯Â¯Â¯
Ht(Uk)
â‰¤
C
s
X
j=1
Â¯Â¯Â¯Â¯hâ€²âˆ—
j
Â¡
Ïˆâ€²
ju
Â¢Â¯Â¯Â¯Â¯
Ht(U â€²
j) .
â‰¤
C
ï£«
ï£­
s
X
j=1
Â¯Â¯Â¯Â¯hâ€²âˆ—
j
Â¡
Ïˆâ€²
ju
Â¢Â¯Â¯Â¯Â¯2
Ht(U â€²
j)
ï£¶
ï£¸
1/2
= ||u||Ht(Î“k) .
where Lemma 41.20 on page 1185 was used in the last step. Now also, from Lemma
41.20 on page 1185
||u||Ht(Î“k)
=
ï£«
ï£­
s
X
j=1
Â¯Â¯Â¯Â¯hâ€²âˆ—
j
Â¡
Ïˆâ€²
ju
Â¢Â¯Â¯Â¯Â¯2
Ht(U â€²
j)
ï£¶
ï£¸
1/2
=
ï£«
ï£­
s
X
j=1
Â¯Â¯Â¯
Â¯Â¯Â¯
Â¡
gk â—¦hâ€²
j
Â¢âˆ—hâˆ—
k
Â¡
Ïˆâ€²
ju
Â¢Â¯Â¯Â¯
Â¯Â¯Â¯
2
Ht(U â€²
j)
ï£¶
ï£¸
1/2
â‰¤
C
ï£«
ï£­
s
X
j=1
Â¯Â¯Â¯Â¯hâˆ—
k
Â¡
Ïˆâ€²
ju
Â¢Â¯Â¯Â¯Â¯2
Ht(Uk)
ï£¶
ï£¸
1/2
â‰¤
C
ï£«
ï£­
s
X
j=1
||hâˆ—
ku||2
Ht(Uk)
ï£¶
ï£¸
1/2
= Cs ||hâˆ—
ku||Ht(Uk) = |||u|||t .
This proves the lemma.
41.5.2
The Trace On The Boundary
Deï¬nition 41.40 A bounded open subset, â„¦, of Rn has a Cm,1boundary if it sat-
isï¬es the following conditions. For each p âˆˆÎ“ â‰¡â„¦\â„¦, there exists an open set, W,
containing p, an open interval (0, b), a bounded open box U â€² âŠ†Rnâˆ’1, and an aï¬ƒne
orthogonal transformation, RW consisting of a distance preserving linear transfor-
mation followed by a translation such that
RW W = U â€² Ã— (0, b),
(41.23)

41.5.
SOBOLEV SPACES ON MANIFOLDS
1201
RW (W âˆ©â„¦) = {u âˆˆRn : uâ€² âˆˆU â€², 0 < un < Ï†W (uâ€²)} â‰¡UW
(41.24)
where Ï†W âˆˆCm,1 Â¡
U â€²Â¢
meaning Ï†W is the restriction to U â€² of a function, still
denoted by Ï†W which is in Cm,1 Â¡
Rnâˆ’1Â¢
and
inf {Ï†W (uâ€²) : uâ€² âˆˆU â€²} > 0
The following picture depicts the situation.




ZZZZZ
ZZZZZ




-
R
W
â„¦T W
RW (â„¦T W)
0
b
uâ€² âˆˆU â€²
For the situation described in the above deï¬nition, let hW : U â€² â†’Î“ âˆ©W be
deï¬ned by
hW (uâ€²) â‰¡Râˆ’1
W (uâ€², Ï†W (uâ€²)) , gW (x) â‰¡(RW x)â€² , HW (u) â‰¡Râˆ’1
W (uâ€², Ï†W (uâ€²) âˆ’un) .
where xâ€² â‰¡(x1, Â· Â· Â·, xnâˆ’1) for x = (x1, Â· Â· Â·, xn). Thus gW â—¦hW = id on U â€² and
hW â—¦gW = id on Î“âˆ©W. Also note that HW is deï¬ned on all of Rn is Cm,1, and has
an inverse with the same properties. To see this, let GW (u) = (uâ€², Ï†W (uâ€²) âˆ’un) .
Then HW = Râˆ’1
W â—¦GW and Gâˆ’1
W = (uâ€², Ï†W (uâ€²) âˆ’un) and so Hâˆ’1
W = Gâˆ’1
W â—¦RW .
Note also that as indicated in the picture,
RW (W âˆ©â„¦) = {u âˆˆRn : uâ€² âˆˆU â€² and 0 < un < Ï†W (uâ€²)} .
Since Î“ = âˆ‚â„¦is compact, there exist ï¬nitely many of these open sets, W, denoted
by {Wi}q
i=1 such that Î“ âŠ†âˆªq
i=1Wi. Let the corresponding sets, U â€² be denoted by U â€²
i
and let the functions, Ï† be denoted by Ï†i. Also let hi = hWi etc. Now let {Ïˆi}q
i=1
be a Câˆžpartition of unity subordinate to the {Wi}q
i=1. If u âˆˆHt (â„¦) , then by
Corollary 41.22 on Page 1186 it follows that uÏˆi âˆˆHt (Wi âˆ©â„¦) . Now
Hi : Ui â‰¡{u âˆˆRn : uâ€² âˆˆU â€²
i, 0 < un < Ï†i (uâ€²)} â†’Wi âˆ©â„¦
and Hi and its inverse are deï¬ned on Rn and are in Cm,1 (Rn) . Therefore, by
Lemma 41.20 on Page 1185,
Hâˆ—
i âˆˆL
Â¡
Ht (Wi âˆ©â„¦) , Ht (Ui)
Â¢
.
Now it is possible to deï¬ne the trace on Î“ â‰¡âˆ‚â„¦. For u âˆˆHt (â„¦) ,
Î³u â‰¡
q
X
i=1
gâˆ—
i (Î³Hâˆ—
i (uÏˆi)) .
(41.25)
I must show it satisï¬es what it should. Recall the deï¬nition of what it means for a
function to be in Htâˆ’1/2 (Î“) where t = m + s.

1202
SOBOLEV SPACES BASED ON L2
Deï¬nition 41.41 Let s âˆˆ(0, 1) and m is a nonnegative integer. Also let Âµ denote
the surface measure for Î“. A Âµ measurable function, u is in Hm+s (Î“) if whenever
{Wi, Ïˆi, Î“i, Ui, hi, gi}âˆž
i=1 is described above, hâˆ—
i (uÏˆi) âˆˆHm+s (Ui) and
||u||Hm+s(Î“) â‰¡
Ãƒ âˆž
X
i=1
||hâˆ—
i (uÏˆi)||2
Hm+s(Ui)
!1/2
< âˆž.
Recall that all these norms which are obtained from various partitions of unity
and functions, hi and gi are equivalent. Here there are only ï¬nitely many Wi so
the sum is a ï¬nite sum. The theorem is the following.
Theorem 41.42 Let â„¦be a bounded open set having Cm,1 boundary as discussed
above in Deï¬nition 41.40. Then for t â‰¤m + 1, there exists a unique
Î³ âˆˆL
Â³
Ht (â„¦) , Htâˆ’1/2 (Î“)
Â´
which has the property that for Âµ the measure on the boundary,
Î³u (x) = u (x) for Âµ a.e. x âˆˆÎ“whenever u âˆˆS|â„¦.
(41.26)
Proof: First consider the claim that Î³ âˆˆL
Â¡
Ht (â„¦) , Htâˆ’1/2 (Î“)
Â¢
. This involves
ï¬rst showing that for u âˆˆHt (â„¦) , Î³u âˆˆHtâˆ’1/2 (Î“) . To do this, use the above
deï¬nition.
hâˆ—
j
Â¡
Ïˆj (Î³u)
Â¢
=
q
X
i=1
hâˆ—
j
Â¡
Ïˆjgâˆ—
i (Î³Hâˆ—
i (uÏˆi))
Â¢
=
q
X
i=1
Â¡
hâˆ—
jÏˆj
Â¢ Â¡
hâˆ—
j (gâˆ—
i (Î³Hâˆ—
i (uÏˆi)))
Â¢
=
q
X
i=1
Â¡
hâˆ—
jÏˆj
Â¢
(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi))
(41.27)
First note that
Î³Hâˆ—
i (uÏˆi) âˆˆHtâˆ’1/2 (U â€²
i)
Now gi â—¦hj and its inverse, gj â—¦hi are both functions in Cm,1 Â¡
Rnâˆ’1Â¢
and
gi â—¦hj : U â€²
j â†’U â€²
i.
Therefore, by Lemma 41.20 on Page 1185,
(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi)) âˆˆHtâˆ’1/2 Â¡
U â€²
j
Â¢
and
Â¯Â¯Â¯Â¯(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi))
Â¯Â¯Â¯Â¯
Htâˆ’1/2(U â€²
j) â‰¤Cij ||Î³Hâˆ—
i (uÏˆi)||Htâˆ’1/2(U â€²
i) .

41.5.
SOBOLEV SPACES ON MANIFOLDS
1203
Also hâˆ—
jÏˆj âˆˆCm,1 Â¡
U â€²
j
Â¢
and has compact support in U â€²
j and so by Corollary 41.22
on Page 1186
Â¡
hâˆ—
jÏˆj
Â¢
(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi)) âˆˆHtâˆ’1/2 Â¡
U â€²
j
Â¢
and
Â¯Â¯Â¯Â¯Â¡
hâˆ—
jÏˆj
Â¢
(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi))
Â¯Â¯Â¯Â¯
Htâˆ’1/2(U â€²
j)
â‰¤
Cij
Â¯Â¯Â¯Â¯(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi))
Â¯Â¯Â¯Â¯
Htâˆ’1/2(U â€²
j)
(41.28)
â‰¤
Cij ||Î³Hâˆ—
i (uÏˆi)||Htâˆ’1/2(U â€²
i) .
(41.29)
This shows Î³u âˆˆHtâˆ’1/2 (Î“) because each hâˆ—
j
Â¡
Ïˆj (Î³u)
Â¢
âˆˆHtâˆ’1/2 Â¡
U â€²
j
Â¢
. Also
from 41.29 and 41.27
||Î³u||2
Htâˆ’1/2(Î“) â‰¤
q
X
j=1
Â¯Â¯Â¯Â¯hâˆ—
j
Â¡
Ïˆj (Î³u)
Â¢Â¯Â¯Â¯Â¯2
Htâˆ’1/2(U â€²
j)
=
q
X
j=1
Â¯Â¯Â¯Â¯hâˆ—
j
Â¡
Ïˆj (Î³u)
Â¢Â¯Â¯Â¯Â¯2
Htâˆ’1/2(U â€²
j)
=
q
X
j=1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
q
X
i=1
Â¡
hâˆ—
jÏˆj
Â¢
(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi))
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
2
Htâˆ’1/2(U â€²
j)
â‰¤
Cq
q
X
j=1
q
X
i=1
Â¯Â¯Â¯Â¯Â¡
hâˆ—
jÏˆj
Â¢
(gi â—¦hj)âˆ—(Î³Hâˆ—
i (uÏˆi))
Â¯Â¯Â¯Â¯2
Htâˆ’1/2(U â€²
j)
â‰¤
Cq
q
X
j=1
q
X
i=1
Cij ||(Î³Hâˆ—
i (uÏˆi))||2
Htâˆ’1/2(U â€²
i)
â‰¤
Cq
q
X
i=1
||(Î³Hâˆ—
i (uÏˆi))||2
Htâˆ’1/2(U â€²
i)
â‰¤
Cq
q
X
i=1
||Hâˆ—
i (uÏˆi)||2
Ht(Ri(Wiâˆ©â„¦))
â‰¤
Cq
q
X
i=1
||uÏˆi||2
Ht(Wiâˆ©â„¦) â‰¤Cq ||u||2
Ht(â„¦) .
Does Î³ satisfy 41.26? Let x âˆˆÎ“ and u âˆˆS|â„¦. Let
Ix â‰¡{i âˆˆ{1, 2, Â· Â· Â·, q} : x = hi (uâ€²
i) for some uâ€²
i âˆˆU â€²
i} .

1204
SOBOLEV SPACES BASED ON L2
Then
Î³u (x)
=
X
iâˆˆIx
(Î³Hâˆ—
i (uÏˆi)) (gi (x))
=
X
iâˆˆIx
(Î³Hâˆ—
i (uÏˆi)) (gi (hi (uâ€²
i)))
=
X
iâˆˆIx
(Î³Hâˆ—
i (uÏˆi)) (uâ€²
i) .
Now because Hi is Lipschitz continuous and uÏˆ âˆˆS, it follows that Hâˆ—
i (uÏˆi) âˆˆ
H1 (Rn) and is continuous and so by Theorem 41.33 on Page 1195 for a.e. uâ€²
i,
=
X
iâˆˆIx
Hâˆ—
i (uÏˆi) (uâ€²
i, 0)
=
X
iâˆˆIx
hâˆ—
i (uÏˆi) (uâ€²
i)
=
X
iâˆˆIx
(uÏˆi) (hi (uâ€²
i)) = u (x) for Âµ a.e.x.
(41.30)
This veriï¬es 41.26 and completes the proof of the theorem.

Weak Solutions
42.1
The Lax Milgram Theorem
The Lax Milgram theorem is a fundamental result which is useful for obtaining
weak solutions to many types of partial diï¬€erential equations. It is really a general
theorem in functional analysis.
Deï¬nition 42.1 Let A âˆˆL (V, V â€²) where V is a Hilbert space. Then A is said to
be coercive if
A (v) (v) â‰¥Î´ ||v||2
for some Î´ > 0.
Theorem 42.2 (Lax Milgram) Let A âˆˆL (V, V â€²) be coercive. Then A maps one to
one and onto.
Proof: The proof that A is onto involves showing A (V ) is both dense and
closed.
Consider ï¬rst the claim that A (V ) is closed. Let Axn â†’yâˆ—âˆˆV â€². Then
Î´ ||xn âˆ’xm||2
V â‰¤||Axn âˆ’Axm||V â€² ||xn âˆ’xm||V .
Therefore, {xn} is a Cauchy sequence in V. It follows xn â†’x âˆˆV and since A is
continuous, Axn â†’Ax. This shows A (V ) is closed.
Now let R : V â†’V â€² denote the Riesz map deï¬ned by Rx (y) = (y, x) . Recall
that the Riesz map is one to one, onto, and preserves norms. Therefore, Râˆ’1 (A (V ))
is a closed subspace of V. If there Râˆ’1 (A (V )) Ì¸= V, then
Â¡
Râˆ’1 (A (V ))
Â¢âŠ¥Ì¸= {0} .
Let x âˆˆ
Â¡
Râˆ’1 (A (V ))
Â¢âŠ¥and x Ì¸= 0. Then in particular,
0 =
Â¡
x, Râˆ’1Ax
Â¢
= R
Â¡
Râˆ’1 (A (x))
Â¢
(x) = A (x) (x) â‰¥Î´ ||x||2
V ,
a contradiction to x Ì¸= 0. Therefore, Râˆ’1 (A (V )) = V and so A (V ) = R (V ) = V â€².
Since A (V ) is both closed and dense, A (V ) = V â€². This shows A is onto.
If Ax = Ay, then 0 = A (x âˆ’y) (x âˆ’y) â‰¥Î´ ||x âˆ’y||2
V , and this shows A is one
to one. This proves the theorem.
1205

1206
WEAK SOLUTIONS
Here is a simple example which illustrates the use of the above theorem. In the
example the repeated index summation convention is being used. That is, you sum
over the repeated indices.
Example 42.3 Let U be an open subset of Rn and let V be a closed subspace of
H1 (U) . Let Î±ij âˆˆLâˆž(U) for i, j = 1, 2, Â· Â· Â·, n. Now deï¬ne A : V â†’V â€² by
A (u) (v) â‰¡
Z
U
Â¡
Î±ij (x) u,i (x) v,j (x) + u (x) v (x)
Â¢
dx.
Suppose also that
Î±ijvivj â‰¥Î´ |v|2
whenever v âˆˆRn. Then A maps V to V â€² one to one and onto.
Here is why. It is obvious that A is in L (V, V â€²) . It only remains to verify that
it is coercive.
A (u) (u)
â‰¡
Z
U
Â¡
Î±ij (x) u,i (x) u,j (x) + u (x) u (x)
Â¢
dx
â‰¥
Z
U
Î´ |âˆ‡u (x)|2 + |u (x)|2 dx
â‰¥
Î´ ||u||2
H1(U)
This proves coercivity and veriï¬es the claim.
What has been obtained in the above example?
This depends on how you
choose V. In Example 42.3 suppose U is a bounded open set with C0,1 boundary
and V = H1
0 (U) where
H1
0 (U) â‰¡
Â©
u âˆˆH1 (U) : Î³u = 0
Âª
.
Also suppose f âˆˆL2 (U) . Then you can consider F âˆˆV â€² by deï¬ning
F (v) â‰¡
Z
U
f (x) v (x) dx.
According to the Lax Milgram theorem and the veriï¬cation of its conditions in
Example 42.3, there exists a unique solution to the problem of ï¬nding u âˆˆH1
0 (U)
such that for all v âˆˆH1
0 (U) ,
Z
U
Â¡
Î±ij (x) u,i (x) v,j (x) + u (x) v (x)
Â¢
dx =
Z
U
f (x) v (x) dx
(42.1)
In particular, this holds for all v âˆˆCâˆž
c (U) . Thus for all such v,
Z
U
Â³
âˆ’
Â¡
Î±ij (x) u,i (x)
Â¢
,j + u (x) âˆ’f (x)
Â´
v (x) dx = 0.
Therefore, in terms of weak derivatives,
âˆ’
Â¡
Î±iju,i
Â¢
,j + u = f

42.1.
THE LAX MILGRAM THEOREM
1207
and since u âˆˆH1
0 (U) , it must be the case that Î³u = 0 on âˆ‚U. This is why the
solution to 42.1 is referred to as a weak solution to the boundary value problem
âˆ’
Â¡
Î±ij (x) u,i (x)
Â¢
,j + u (x) = f (x) , u = 0 on âˆ‚U.
Of course you then begin to ask the important question whether u really has two
derivatives.
It is not immediately clear that just because âˆ’
Â¡
Î±ij (x) u,i (x)
Â¢
,j âˆˆ
L2 (U) it follows that the second derivatives of u exist. Actually this will often be
true and is discussed somewhat in the next section.
Next suppose you choose V = H1 (U) and let g âˆˆH1/2 (âˆ‚U). Deï¬ne F âˆˆV â€² by
F (v) â‰¡
Z
U
f (x) v (x) dx +
Z
âˆ‚U
g (x) Î³v (x) dÂµ.
Everything works the same way and you get the existence of a unique u âˆˆH1 (U)
such that for all v âˆˆH1 (U) ,
Z
U
Â¡
Î±ij (x) u,i (x) v,j (x) + u (x) v (x)
Â¢
dx =
Z
U
f (x) v (x) dx +
Z
âˆ‚U
g (x) Î³v (x) dÂµ
(42.2)
is satisï¬ed. It you pretend u has all second order derivatives in L2 (U) and apply
the divergence theorem, you ï¬nd that you have obtained a weak solution to
âˆ’
Â¡
Î±iju,i
Â¢
,j + u = f, Î±iju,inj = g on âˆ‚U
where nj is the jth component of n, the unit outer normal. Therefore, u is a weak
solution to the above boundary value problem.
The conclusion is that the Lax Milgram theorem gives a way to obtain existence
and uniqueness of weak solutions to various boundary value problems. The following
theorem is often very useful in establishing coercivity. To prove this theorem, here
is a deï¬nition.
Deï¬nition 42.4 Let U be an open set and Î´ > 0. Then
UÎ´ â‰¡
Â©
x âˆˆU : dist
Â¡
x,U CÂ¢
> Î´
Âª
.
Theorem 42.5 Let U be a connected bounded open set having C0,1 boundary such
that for some sequence, Î·k â†“0,
U = âˆªâˆž
k=1UÎ·k
(42.3)
and UÎ·k is a connected open set. Suppose Î“ âŠ†âˆ‚U has positive surface measure and
that
V â‰¡
Â©
u âˆˆH1 (U) : Î³u = 0 a.e. on Î“
Âª
.
Then the norm |||Â·||| given by
|||u||| â‰¡
ÂµZ
U
|âˆ‡u|2 dx
Â¶1/2
is equivalent to the usual norm on V.

1208
WEAK SOLUTIONS
Proof: First it is necessary to verify this is actually a norm. It clearly satisï¬es
all the usual axioms of a norm except for the condition that |||u||| = 0 if and only
if u = 0. Suppose then that |||u||| = 0. Let Î´0 = Î·k for one of those Î·k mentioned
above and deï¬ne
uÎ´ (x) â‰¡
Z
B(0,Î´)
u (x âˆ’y) Ï†Î´ (y) dy
where Ï†Î´ is a molliï¬er having support in B (0, Î´) . Then changing the variables, it
follows that for x âˆˆUÎ´0
uÎ´ (x) =
Z
B(x,Î´)
u (t) Ï†Î´ (x âˆ’t) dt =
Z
U
u (t) Ï†Î´ (x âˆ’t) dt
and so uÎ´ âˆˆCâˆž(UÎ´0) and
âˆ‡uÎ´ (x) =
Z
U
u (t) âˆ‡Ï†Î´ (x âˆ’t) dt =
Z
B(0,Î´)
âˆ‡u (x âˆ’y) Ï†Î´ (y) dy = 0.
Therefore, uÎ´ equals a constant on UÎ´0 because UÎ´0 is a connected open set and
uÎ´ is a smooth function deï¬ned on this set which has its gradient equal to 0. By
Minkowskiâ€™s inequality,
ÃƒZ
UÎ´0
|u (x) âˆ’uÎ´ (x)|2 dx
!1/2
â‰¤
Z
B(0,Î´)
Ï†Î´ (y)
ÃƒZ
UÎ´0
|u (x) âˆ’u (x âˆ’y)|2 dx
!1/2
dy
and this converges to 0 as Î´ â†’0 by continuity of translation in L2. It follows
there exists a sequence of constants, cÎ´ â‰¡uÎ´ (x) such that {cÎ´} converges to u in
L2 (UÎ´0) . Consequently, a subsequence, still denoted by uÎ´, converges to u a.e. By
Eggoroï¬€â€™s theorem there exists a set, Nk having measure no more than 3âˆ’kmn (UÎ´0)
such that uÎ´ converges to u uniformly on N C
k . Thus u is constant on N C
k . Now
P
k mn (Nk) â‰¤
1
2mn (UÎ´0) and so there exists x0 âˆˆUÎ´0 \ âˆªâˆž
k=1Nk. Therefore, if
x /âˆˆNk it follows u (x) = u (x0) and so, if u (x) Ì¸= u (x0) it must be the case that
x âˆˆâˆ©âˆž
k=1Nk, a set of measure zero. This shows that u equals a constant a.e. on
UÎ´0 = UÎ·k. Since k is arbitrary, 42.3 shows u is a.e. equal to a constant on U.
Therefore, u equals the restriction of a function of S to U and so Î³u equals this
constant in L2 (âˆ‚â„¦) . Since the surface measure of Î“ is positive, the constant must
equal zero. Therefore, |||Â·||| is a norm.
It remains to verify that it is equivalent to the usual norm.
It is clear that
|||u||| â‰¤||u||1,2 . What about the other direction? Suppose it is not true that for
some constant, K, ||u||1,2 â‰¤K |||u||| . Then for every k âˆˆN, there exists uk âˆˆV
such that
||uk||1,2 > k |||uk||| .
Replacing uk with uk/ ||uk||1,2 , it can be assumed that ||uk||1,2 = 1 for all k.
Therefore, using the compactness of the embedding of H1 (U) into L2 (U) , there

42.1.
THE LAX MILGRAM THEOREM
1209
exists a subsequence, still denoted by uk such that
uk
â†’
u weakly in V,
(42.4)
uk
â†’
u strongly in L2 (U) ,
(42.5)
|||uk|||
â†’
0,
(42.6)
uk
â†’
u weakly in (V, |||Â·|||) .
(42.7)
From 42.6 and 42.7, it follows u = 0. Therefore, |uk|L2(U) â†’0. This with 42.6
contradicts the fact that ||uk||1,2 = 1 and this proves the equivalence of the two
norms.
The proof of the above theorem yields the following interesting corollary.
Corollary 42.6 Let U be a connected open set with the property that for some
sequence, Î·k â†“0,
U = âˆªâˆž
k=1UÎ·k
for UÎ·k a connected open set and suppose u âˆˆW 1,p (U) and âˆ‡u = 0 a.e. Then u
equals a constant a.e.
Example 42.7 Let U be a bounded open connected subset of Rn and let V be a
closed subspace of H1 (U) deï¬ned by
V â‰¡
Â©
u âˆˆH1 (U) : Î³u = 0 on Î“
Âª
where the surface measure of Î“ is positive.
Let Î±ij âˆˆLâˆž(U) for i, j = 1, 2, Â· Â· Â·, n and deï¬ne A : V â†’V â€² by
A (u) (v) â‰¡
Z
U
Î±ij (x) u,i (x) v,j (x) dx.
for
Î±ijvivj â‰¥Î´ |v|2
whenever v âˆˆRn. Then A maps V to V â€² one to one and onto.
This follows from Theorem 42.5 using the equivalent norm deï¬ned there. Deï¬ne
F âˆˆV â€² by
Z
U
f (x) v (x) dx +
Z
âˆ‚U\Î“
g (x) Î³v (x) dx
for f âˆˆL2 (U) and g âˆˆH1/2 (âˆ‚U) . Then the equation,
Au = F in V â€²
which is equivalent to u âˆˆV and for all v âˆˆV,
Z
U
Î±ij (x) u,i (x) v,j (x) dx =
Z
U
f (x) v (x) dx +
Z
âˆ‚U\Î“
g (x) Î³v (x) dÂµ
is a weak solution for the boundary value problem,
âˆ’
Â¡
Î±iju,i
Â¢
,j = f in U, Î±iju,inj = g on âˆ‚U \ Î“, u = 0 on Î“
as you can verify by using the divergence theorem formally.

1210
WEAK SOLUTIONS

Kornâ€™s Inequality
A fundamental inequality used in elasticity to obtain coercivity and then apply the
Lax Milgram theorem or some other theorem is Kornâ€™s inequality. The proof given
here of this fundamental result follows [41] and [19].
43.1
A Fundamental Inequality
The proof of Kornâ€™s inequality depends on a fundamental inequality involving neg-
ative Sobolev space norms. The theorem to be proved is the following.
Theorem 43.1 Let f âˆˆL2 (â„¦) where â„¦is a bounded Lipschitz domain. Then there
exist constants, C1 and C2 such that
C1 ||f||0,2,â„¦â‰¤
Ãƒ
||f||âˆ’1,2,â„¦+
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
!
â‰¤C2 ||f||0,2,â„¦,
where here ||Â·||0,2,â„¦represents the L2 norm and ||Â·||âˆ’1,2,â„¦represents the norm in
the dual space of H1
0 (â„¦) , denoted by Hâˆ’1 (â„¦) .
Similar conventions will apply for any domain in place of â„¦. The proof of this
theorem will proceed through the use of several lemmas.
Lemma 43.2 Let U âˆ’denote the set,
{(x,xn) âˆˆRn : xn < g (x)}
where g : Rnâˆ’1 â†’R is Lipschitz and denote by U + the set
{(x,xn) âˆˆRn : xn > g (x)} .
Let f âˆˆL2 (U âˆ’) and extend f to all of Rn in the following way.
f (x,xn) â‰¡âˆ’3f (x,2g (x) âˆ’xn) + 4f (x, 3g (x) âˆ’2xn) .
1211

1212
KORNâ€™S INEQUALITY
Then there is a constant, Cg, depending on g such that
||f||âˆ’1,2,Rn +
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn
â‰¤Cg
Ãƒ
||f||âˆ’1,2,U âˆ’+
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Uâˆ’
!
.
Proof: Let Ï† âˆˆCâˆž
c (Rn) . Then,
Z
Rn f âˆ‚Ï†
âˆ‚xn
dx =
Z
U +
âˆ‚Ï†
âˆ‚xn
[âˆ’3f (x,2g (x) âˆ’xn) + 4f (x, 3g (x) âˆ’2xn)] dx
+
Z
U âˆ’f âˆ‚Ï†
âˆ‚xn
dx.
(43.1)
Consider the ï¬rst integral on the right in 43.1.
Changing the variables, letting
yn = 2g (x) âˆ’xn in the ï¬rst term of the integrand and 3g (x) âˆ’2xn in the next, it
equals
âˆ’3
Z
U âˆ’
âˆ‚Ï†
âˆ‚xn
(x,2g (x) âˆ’yn) f (x,yn) dyndx
+2
Z
U âˆ’
âˆ‚Ï†
âˆ‚xn
Âµ
x,3
2g (x) âˆ’yn
2
Â¶
f (x,yn) dyndx.
For (x,yn) âˆˆU âˆ’, and deï¬ning
Ïˆ (x,yn) â‰¡Ï† (x,yn) + 3Ï† (x,2g (x) âˆ’yn) âˆ’4Ï†
Âµ
x,3
2g (x) âˆ’yn
2
Â¶
,
it follows Ïˆ = 0 when yn = g (x) and so
Z
Rn f âˆ‚Ï†
âˆ‚xn
dx =
Z
U âˆ’
âˆ‚Ïˆ
âˆ‚yn
f (x,yn) dxdyn.
Now from the deï¬nition of Ïˆ given above,
||Ïˆ||1,2,U âˆ’â‰¤Cg ||Ï†||1,2,U âˆ’â‰¤Cg ||Ï†||1,2,Rn
and so
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xn
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn â‰¡
sup
Â½Z
Rn f âˆ‚Ï†
âˆ‚xn
dx : Ï† âˆˆCâˆž
c (Rn) , ||Ï†||1,2,Rn â‰¤1
Â¾
â‰¤
sup
Â½Â¯Â¯Â¯Â¯
Z
U âˆ’f âˆ‚Ïˆ
âˆ‚xn
dxdyn
Â¯Â¯Â¯Â¯ : Ïˆ âˆˆH1
0
Â¡
U âˆ’Â¢
, ||Ïˆ||1,2,U âˆ’â‰¤Cg
Â¾
= Cg
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xn
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,U âˆ’
(43.2)

43.1.
A FUNDAMENTAL INEQUALITY
1213
It remains to establish a similar inequality for the case where the derivatives are
taken with respect to xi for i < n. Let Ï† âˆˆCâˆž
c (Rn) . Then
Z
Rn f âˆ‚Ï†
âˆ‚xi
dx =
Z
U âˆ’f âˆ‚Ï†
âˆ‚xi
dx
Z
U +
âˆ‚Ï†
âˆ‚xi
[âˆ’3f (x,g (x) âˆ’xn) + 4f (x, 3g (x) âˆ’2xn)] dx.
Changing the variables as before, this last integral equals
âˆ’3
Z
U âˆ’DiÏ† (x,2g (x) âˆ’yn) f (x,yn) dyndx
+ 2
Z
U âˆ’DiÏ†
Âµ
x,3
2g (x) âˆ’yn
2
Â¶
f (x,yn) dyndx.
(43.3)
Now let
Ïˆ1 (x,yn) â‰¡Ï† (x,2g (x) âˆ’yn) , Ïˆ2 (x,yn) â‰¡Ï†
Âµ
x,3
2g (x) âˆ’yn
2
Â¶
.
Then
âˆ‚Ïˆ1
âˆ‚xi
= DiÏ† (x,2g (x) âˆ’yn) + DnÏ† (x,2g (x) âˆ’yn) 2Dig (x) ,
âˆ‚Ïˆ2
âˆ‚xi
= DiÏ†
Âµ
x,3
2g (x) âˆ’yn
2
Â¶
+ DnÏ†
Âµ
x,3
2g (x) âˆ’yn
2
Â¶ 3
2Dig (x) .
Also
âˆ‚Ïˆ1
âˆ‚yn
(x,yn) = âˆ’DnÏ† (x,2g (x) âˆ’yn) ,
âˆ‚Ïˆ2
âˆ‚yn
(x,yn) =
Âµâˆ’1
2
Â¶
DnÏ†
Âµ
x,3
2g (x) âˆ’yn
2
Â¶
.
Therefore,
âˆ‚Ïˆ1
âˆ‚xi
(x,yn) = DiÏ† (x,2g (x) âˆ’yn) âˆ’2âˆ‚Ïˆ1
âˆ‚yn
(x,yn) Dig (x) ,
âˆ‚Ïˆ2
âˆ‚xi
(x,yn) = DiÏ†
Âµ
x,3
2g (x) âˆ’yn
2
Â¶
âˆ’3âˆ‚Ïˆ2
âˆ‚yn
(x,yn) Dig (x) .
Using this in 43.3, the integrals in this expression equal
âˆ’3
Z
U âˆ’
Â·âˆ‚Ïˆ1
âˆ‚xi
(x,yn) + 2âˆ‚Ïˆ1
âˆ‚yn
(x,yn) Dig (x)
Â¸
f (x,yn) dyndx+
2
Z
U âˆ’
Â·âˆ‚Ïˆ2
âˆ‚xi
(x,yn) + 3âˆ‚Ïˆ2
âˆ‚yn
(x,yn) Dig (x)
Â¸
f (x,yn) dyndx

1214
KORNâ€™S INEQUALITY
=
Z
U âˆ’
Â·
âˆ’3âˆ‚Ïˆ1 (x,y)
âˆ‚xi
+ 2âˆ‚Ïˆ2 (x,yn)
âˆ‚xi
Â¸
f (x,yn) dyndx.
Therefore,
Z
Rn
âˆ‚Ï†
âˆ‚xi
fdx =
Z
U âˆ’
Â· âˆ‚Ï†
âˆ‚xi
âˆ’3âˆ‚Ïˆ1
âˆ‚xi
+ 2âˆ‚Ïˆ2
âˆ‚xi
Â¸
fdxdyn
and also
Ï† (x,g (x)) âˆ’3Ïˆ1 (x,g (x)) + 2Ïˆ2 (x,g (x)) =
Ï† (x,g (x)) âˆ’3Ï† (x,g (x)) + 2Ï† (x,g (x)) = 0
and so Ï†âˆ’3Ïˆ1 +2Ïˆ2 âˆˆH1
0 (U âˆ’) . It also follows from the deï¬nition of the functions,
Ïˆi and the assumption that g is Lipschitz, that
||Ïˆi||1,2,U âˆ’â‰¤Cg ||Ï†||1,2,U âˆ’â‰¤Cg ||Ï†||1,2,Rn .
(43.4)
Therefore,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn
â‰¡sup
Â½Â¯Â¯Â¯Â¯
Z
Rn f âˆ‚Ï†
âˆ‚xi
dx
Â¯Â¯Â¯Â¯ : ||Ï†||1,2,Rn â‰¤1
Â¾
= sup
Â½Â¯Â¯Â¯Â¯
Z
U âˆ’f
Â· âˆ‚Ï†
âˆ‚xi
âˆ’3âˆ‚Ïˆ1
âˆ‚xi
+ 2âˆ‚Ïˆ2
âˆ‚xi
Â¸
dx
Â¯Â¯Â¯Â¯ : ||Ï†||1,2,Rn â‰¤1
Â¾
â‰¤Cg
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,U âˆ’
where Cg is a constant which depends on g. This inequality along with 43.2 yields
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn
â‰¤Cg
Ãƒ
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,U âˆ’
!
.
The inequality,
||f||âˆ’1,2,Rn â‰¤Cg ||f||âˆ’1,2,U âˆ’
follows from 43.4 and the equation,
Z
Rn fÏ†dx =
Z
U âˆ’fÏ†dx âˆ’3
Z
U âˆ’f (x,yn) Ïˆ1 (x,yn) dxdyn
+2
Z
U âˆ’f (x,yn) Ïˆ2 (x,yn) dxdyn
which results in the same way as before by changing variables using the deï¬nition
of f oï¬€U âˆ’. This proves the lemma.
The next lemma is a simple application of Fourier transforms.
Lemma 43.3 If f âˆˆL2 (Rn) , then the following formula holds.
Cn ||f||0,2,Rn =
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn
+ ||f||âˆ’1,2,Rn

43.1.
A FUNDAMENTAL INEQUALITY
1215
Proof: For Ï† âˆˆCâˆž
c (Rn)
||Ï†||1,2,Rn â‰¡
ÂµZ
Rn
Â³
1 + |t|2Â´
|FÏ†|2 dt
Â¶1/2
is an equivalent norm to the usual Sobolev space norm for H1
0 (Rn) and is used in
the following argument which depends on Plancherelâ€™s theorem and the fact that
F
Â³
âˆ‚Ï†
âˆ‚xi
Â´
= tiF (Ï†) .
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn
â‰¡sup
Â½Â¯Â¯Â¯Â¯
Z
Rn
âˆ‚Ï†
âˆ‚xi
fdx
Â¯Â¯Â¯Â¯ : ||Ï†||1,2 â‰¤1
Â¾
= Cn sup
Â½Â¯Â¯Â¯Â¯
Z
Rn ti (FÏ†) (Ff)dt
Â¯Â¯Â¯Â¯ : ||Ï†||1,2 â‰¤1
Â¾
= Cn sup
ï£±
ï£´
ï£²
ï£´
ï£³
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Z
Rn
ti (FÏ†)
Â³
1 + |t|2Â´1/2
Â³
1 + |t|2Â´1/2
(Ff)dt
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
: ||Ï†||1,2 â‰¤1
ï£¼
ï£´
ï£½
ï£´
ï£¾
= Cn
ï£«
ï£­
Z
|Ff|2 t2
i
Â³
1 + |t|2Â´dt
ï£¶
ï£¸
1/2
(43.5)
Also,
||f||âˆ’1,2 â‰¡sup
Â½Â¯Â¯Â¯Â¯
Z
Rn Ï†fdx
Â¯Â¯Â¯Â¯ : ||Ï†||1,2 â‰¤1
Â¾
= Cn sup
Â½Â¯Â¯Â¯Â¯
Z
Rn (FÏ†)
Â¡
Ff
Â¢
dx
Â¯Â¯Â¯Â¯ : ||Ï†||1,2 â‰¤1
Â¾
= Cn sup
ï£±
ï£´
ï£²
ï£´
ï£³
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
Z
Rn
FÏ†
Â³
1 + |t|2Â´1/2
Â³
1 + |t|2Â´1/2
(Ff)dt
Â¯Â¯Â¯Â¯Â¯Â¯Â¯
: ||Ï†||1,2 â‰¤1
ï£¼
ï£´
ï£½
ï£´
ï£¾
= Cn
ï£«
ï£­
Z
Rn
|Ff|2
Â³
1 + |t|2Â´dt
ï£¶
ï£¸
1/2
This along with 43.5 yields the conclusion of the lemma because
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
2
âˆ’1,2
+ ||f||2
âˆ’1,2 = Cn
Z
Rn |Ff|2 dx = Cn ||f||2
0,2 .
Now consider Theorem 43.1. First note that by Lemma 43.2 and U âˆ’deï¬ned
there, Lemma 43.3 implies that for f extended as in Lemma 43.2,
||f||0,2,U âˆ’â‰¤||f||0,2,Rn = Cn
Ãƒ
||f||âˆ’1,2,Rn +
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn
!

1216
KORNâ€™S INEQUALITY
â‰¤Cgn
Ãƒ
||f||âˆ’1,2,U âˆ’+
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,U âˆ’
!
.
(43.6)
Let â„¦be a bounded open set having Lipschitz boundary which lies locally on
one side of
its boundary. Let {Qi}p
i=0 be cubes of the sort used in the proof of
the divergence theorem such that Q0 âŠ†â„¦and the other cubes cover the boundary
of â„¦. Let {Ïˆi} be a Câˆžpartition of unity with spt (Ïˆi) âŠ†Qi and let f âˆˆL2 (â„¦) .
Then for Ï† âˆˆCâˆž
c (â„¦) and Ïˆ one of these functions in the partition of unity,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚(fÏˆ)
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
â‰¤
sup
||Ï†||1,2â‰¤1
Â¯Â¯Â¯Â¯
Z
â„¦
f âˆ‚
âˆ‚xi
(ÏˆÏ†) dx
Â¯Â¯Â¯Â¯ +
sup
||Ï†||1,2â‰¤1
Â¯Â¯Â¯Â¯
Z
â„¦
fÏ† âˆ‚Ïˆ
âˆ‚xi
dx
Â¯Â¯Â¯Â¯
Now if ||Ï†||1,2 â‰¤1, then for a suitable constant, CÏˆ,
||ÏˆÏ†||1,2 â‰¤CÏˆ ||Ï†||1,2 â‰¤CÏˆ,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Ï† âˆ‚Ïˆ
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1,2
â‰¤CÏˆ.
Therefore,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚(fÏˆ)
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
â‰¤
sup
||Î·||1,2â‰¤CÏˆ
Â¯Â¯Â¯Â¯
Z
â„¦
f âˆ‚Î·
âˆ‚xi
dx
Â¯Â¯Â¯Â¯ +
sup
||Î·||1,2â‰¤CÏˆ
Â¯Â¯Â¯Â¯
Z
â„¦
fÎ·dx
Â¯Â¯Â¯Â¯
â‰¤CÏˆ
ÃƒÂ¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
+ ||f||âˆ’1,2,â„¦
!
.
(43.7)
Now using 43.7 and 43.6
Â¯Â¯Â¯Â¯fÏˆj
Â¯Â¯Â¯Â¯
0,2,â„¦â‰¤Cg
ï£«
ï£­Â¯Â¯Â¯Â¯fÏˆj
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦+
n
X
i=1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
âˆ‚
Â¡
fÏˆj
Â¢
âˆ‚xi
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
ï£¶
ï£¸
â‰¤CÏˆjCg
Ãƒ
||f||âˆ’1,2,â„¦+
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
!
.
Therefore, letting C = Pp
j=1 CÏˆjCg,
||f||0,2,â„¦â‰¤
p
X
j=1
Â¯Â¯Â¯Â¯fÏˆj
Â¯Â¯Â¯Â¯
0,2,â„¦â‰¤C
Ãƒ
||f||âˆ’1,2,â„¦+
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
!
.
(43.8)
This proves the hard half of the inequality of Theorem 43.1.
To complete the proof, let f denote the zero extension of f oï¬€â„¦. Then
||f||âˆ’1,2,â„¦+
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
â‰¤
Â¯Â¯Â¯Â¯f
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn +
n
X
i=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚f
âˆ‚xi
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,Rn
â‰¤Cn
Â¯Â¯Â¯Â¯f
Â¯Â¯Â¯Â¯
0,2,Rn = Cn ||f||0,2,â„¦.
This along with 43.8 proves Theorem 43.1.

43.2.
KORNâ€™S INEQUALITY
1217
43.2
Kornâ€™s Inequality
The inequality in this section is known as Kornâ€™s second inequality. It is also known
as coercivity of strains. For u a vector valued function in Rn, deï¬ne
Îµij (u) â‰¡1
2 (ui,j + uj,i)
This is known as the strain or small strain. Kornâ€™s inequality says that the norm
given by,
|||u||| â‰¡
ï£«
ï£­
n
X
i=1
||ui||2
0,2,â„¦+
n
X
i=1
n
X
j=1
||Îµij (u)||2
0,2,â„¦
ï£¶
ï£¸
1/2
(43.9)
is equivalent to the norm,
||u|| â‰¡
ï£«
ï£­
n
X
i=1
||ui||2
0,2,â„¦+
n
X
i=1
n
X
j=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚ui
âˆ‚xj
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
2
0,2,â„¦
ï£¶
ï£¸
1/2
(43.10)
It is very signiï¬cant because it is the strain as just deï¬ned which occurs in many of
the physical models proposed in continuum mechanics. The inequality is far from
obvious because the strains only involve certain combinations of partial derivatives.
Theorem 43.4 (Kornâ€™s second inequality) Let â„¦be any domain for which the con-
clusion of Theorem 43.1 holds. Then the two norms in 43.9 and 43.10 are equivalent.
Proof: Let u be such that ui âˆˆH1 (â„¦) for each i = 1, Â· Â· Â·, n. Note that
âˆ‚2ui
âˆ‚xj, âˆ‚xk
=
âˆ‚
âˆ‚xj
(Îµik (u)) +
âˆ‚
âˆ‚xk
(Îµij (u)) âˆ’âˆ‚
âˆ‚xi
(Îµjk (u)) .
Therefore, by Theorem 43.1,
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚ui
âˆ‚xj
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
0,2,â„¦
â‰¤C
"Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚ui
âˆ‚xj
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
+
n
X
k=1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚2ui
âˆ‚xj, âˆ‚xk
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
#
â‰¤C
"Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚ui
âˆ‚xj
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
+
X
r,s,p
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚Îµrs (u)
âˆ‚xp
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
#
â‰¤C
"Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚ui
âˆ‚xj
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
+
X
r,s
||Îµrs (u)||0,2,â„¦
#
.
But also by this theorem,
||ui||âˆ’1,2,â„¦+
X
p
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚ui
âˆ‚xp
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ’1,2,â„¦
â‰¤C ||ui||0,2,â„¦

1218
KORNâ€™S INEQUALITY
and so
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚ui
âˆ‚xj
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
0,2,â„¦
â‰¤C
"
||ui||0,2,â„¦+
X
r,s
||Îµrs (u)||0,2,â„¦
#
This proves the theorem.
Note that â„¦did not need to be bounded. It suï¬ƒces to be able to conclude
the result of Theorem 43.1 which would hold whenever the boundary of â„¦can be
covered with ï¬nitely many boxes of the sort to which Lemma 43.2 can be applied.

Elliptic Regularity And
Nirenberg Diï¬€erences
44.1
The Case Of A Half Space
Regularity theorems are concerned with obtaining more regularity given a weak
solution. This extra regularity is essential in order to obtain error estimates for
various problems. In this section a regularity is given for weak solutions to various
elliptic boundary value problems. To save on notation, I will use the repeated index
summation convention. Thus you sum over repeated indices. Consider the following
picture.
R
Rnâˆ’1
U
V
Â¡
Â¡
Â¡
Â¡
Âª
Î“
U1
Here V is an open set,
U â‰¡{y âˆˆV : yn < 0} , Î“ â‰¡{y âˆˆV : yn = 0}
and U1 is an open set as shown for which U1 âŠ†V âˆ©U. Assume also that V is
bounded. Suppose
f âˆˆL2 (U) ,
Î±rs âˆˆC0,1 Â¡
U
Â¢
,
(44.1)
1219

1220
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
Î±rs (y) vrvs â‰¥Î´ |v|2 , Î´ > 0.
(44.2)
The following technical lemma gives the essential ideas.
Lemma 44.1 Suppose
w
âˆˆ
H1 (U) ,
(44.3)
Î±rs
âˆˆ
C0,1 Â¡
U
Â¢
,
(44.4)
hs
âˆˆ
H1 (U) ,
(44.5)
f
âˆˆ
L2 (U) .
(44.6)
and
Z
U
Î±rs (y) âˆ‚w
âˆ‚yr
âˆ‚z
âˆ‚ys dy +
Z
U
hs (y) âˆ‚z
âˆ‚ys dy =
Z
U
fzdy
(44.7)
for all z âˆˆH1 (U) having the property that spt (z) âŠ†V. Then w âˆˆH2 (U1) and for
some constant C, independent of f, w, and g, the following estimate holds.
||w||2
H2(U1) â‰¤C
Ãƒ
||w||2
H1(U) + ||f||2
L2(U) +
X
s
||hs||2
H1(U)
!
.
(44.8)
Proof: Deï¬ne for small real h,
Dh
kl (y) â‰¡1
h (l (y + hek) âˆ’l (y)) .
Let U1 âŠ†U1 âŠ†W âŠ†W âŠ†V and let Î· âˆˆCâˆž
c (W) with Î· (y) âˆˆ[0, 1] , and Î· = 1 on
U1 as shown in the following picture.
R
Rnâˆ’1
U
V
Â¡
Â¡
Â¡
Â¡
Âª
Î“
U1
W
For h small (3h < dist
Â¡
W, V CÂ¢
), let
z (y) â‰¡1
h
Â½
Î·2 (yâˆ’hek)
Â·w (y) âˆ’w (y âˆ’hek)
h
Â¸

44.1.
THE CASE OF A HALF SPACE
1221
âˆ’Î·2 (y)
Â·w (y + hek) âˆ’w (y)
h
Â¸Â¾
(44.9)
â‰¡
âˆ’Dâˆ’h
k
Â¡
Î·2Dh
kw
Â¢
,
(44.10)
where here k < n. Thus z can be used in equation 44.7. Begin by estimating the
left side of 44.7.
Z
U
Î±rs (y) âˆ‚w
âˆ‚yr
âˆ‚z
âˆ‚ys dy
=
1
h
Z
U
Î±rs (y + hek) âˆ‚w
âˆ‚yr (y + hek) âˆ‚
Â¡
Î·2Dh
kw
Â¢
âˆ‚ys
dy
âˆ’1
h
Z
U
Î±rs (y) âˆ‚w
âˆ‚yr
âˆ‚
Â¡
Î·2Dh
kw
Â¢
âˆ‚ys
dy
=
Z
U
Î±rs (y + hek) âˆ‚
Â¡
Dh
kw
Â¢
âˆ‚yr
âˆ‚
Â¡
Î·2Dh
kw
Â¢
âˆ‚ys
dy+
1
h
Z
U
(Î±rs (y + hek) âˆ’Î±rs (y)) âˆ‚w
âˆ‚yr
âˆ‚
Â¡
Î·2Dh
kw
Â¢
âˆ‚ys
dy
(44.11)
Now
âˆ‚
Â¡
Î·2Dh
kw
Â¢
âˆ‚ys
= 2Î· âˆ‚Î·
âˆ‚ys Dh
kw + Î·2 âˆ‚
Â¡
Dh
kw
Â¢
âˆ‚ys
.
(44.12)
therefore,
=
Z
U
Î·2Î±rs (y + hek) âˆ‚
Â¡
Dh
kw
Â¢
âˆ‚yr
âˆ‚
Â¡
Dh
kw
Â¢
âˆ‚ys
dy
+
(Z
W âˆ©U
Î±rs (y + hek) âˆ‚
Â¡
Dh
kw
Â¢
âˆ‚yr
2Î· âˆ‚Î·
âˆ‚ys Dh
kwdy
+ 1
h
Z
W âˆ©U
(Î±rs (y + hek) âˆ’Î±rs (y)) âˆ‚w
âˆ‚yr
âˆ‚
Â¡
Î·2Dh
kw
Â¢
âˆ‚ys
dy
)
â‰¡A. + {B.} .
(44.13)
Now consider these two terms. From 44.2,
A. â‰¥Î´
Z
U
Î·2 Â¯Â¯âˆ‡Dh
kw
Â¯Â¯2 dy.
(44.14)
Using the Lipschitz continuity of Î±rs and 44.12,
B. â‰¤C (Î·, Lip (Î±) , Î±)
nÂ¯Â¯Â¯Â¯Dh
kw
Â¯Â¯Â¯Â¯
L2(W âˆ©U)
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯
L2(W âˆ©U;Rn) +
||Î·âˆ‡w||L2(W âˆ©U;Rn)
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯
L2(W âˆ©U;Rn)
+ ||Î·âˆ‡w||L2(W âˆ©U;Rn)
Â¯Â¯Â¯Â¯Dh
kw
Â¯Â¯Â¯Â¯
L2(W âˆ©U)
o
.
(44.15)

1222
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
â‰¤C (Î·, Lip (Î±) , Î±) CÎµ
Â³Â¯Â¯Â¯Â¯Dh
kw
Â¯Â¯Â¯Â¯2
L2(W âˆ©U) + ||Î·âˆ‡w||2
L2(W âˆ©U;Rn)
Â´
+
ÎµC (Î·, Lip (Î±) , Î±)
Â³Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(W âˆ©U;Rn) +
Â¯Â¯Â¯Â¯Dh
kw
Â¯Â¯Â¯Â¯2
L2(W âˆ©U)
Â´
.
(44.16)
Now
Â¯Â¯Â¯Â¯Dh
kw
Â¯Â¯Â¯Â¯
L2(W ) â‰¤||âˆ‡w||2
L2(U;Rn) .
(44.17)
To see this, observe that if w is smooth, then
ÃƒZ
W
Â¯Â¯Â¯Â¯
w (y + hek) âˆ’w (y)
h
Â¯Â¯Â¯Â¯
2
dy
!1/2
â‰¤
ï£«
ï£­
Z
W
Â¯Â¯Â¯Â¯Â¯
1
h
Z h
0
âˆ‡w (y + tek) Â· ekdt
Â¯Â¯Â¯Â¯Â¯
2
dy
ï£¶
ï£¸
1/2
â‰¤
ÃƒZ h
0
ÂµZ
W
|âˆ‡w (y + tek) Â· ek|2 dy
Â¶1/2 dt
h
!
â‰¤||âˆ‡w||L2(U;Rn)
so by density of such functions in H1 (U) , 44.17 holds. Therefore, changing Îµ, yields
B. â‰¤CÎµ (Î·, Lip (Î±) , Î±) ||âˆ‡w||2
L2(U;Rn) + Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(W âˆ©U;Rn) .
(44.18)
With 44.14 and 44.18 established, consider the other terms of 44.7.
Â¯Â¯Â¯Â¯
Z
U
fzdy
Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯
Z
U
f
Â¡
âˆ’Dâˆ’h
k Î·2Dh
kw
Â¢
dy
Â¯Â¯Â¯Â¯
â‰¤
ÂµZ
U
|f|2 dy
Â¶1/2 ÂµZ
U
Â¯Â¯Dâˆ’h
k
Â¡
Î·2Dh
kw
Â¢Â¯Â¯2 dy
Â¶1/2
â‰¤
||f||L2(U)
Â¯Â¯Â¯Â¯âˆ‡
Â¡
Î·2Dh
kw
Â¢Â¯Â¯Â¯Â¯
L2(U;Rn)
â‰¤
||f||L2(U)
Â³Â¯Â¯Â¯Â¯2Î·âˆ‡Î·Dh
kw
Â¯Â¯Â¯Â¯
L2(U;Rn) +
Â¯Â¯Â¯Â¯Î·2âˆ‡Dh
kw
Â¯Â¯Â¯Â¯
L2(U;Rn)
Â´
â‰¤
C ||f||L2(U) ||âˆ‡w||L2(U;Rn) + ||f||L2(U)
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯
L2(U;Rn)
â‰¤
CÎµ
Â³
||f||2
L2(U) + ||âˆ‡w||2
L2(U;Rn)
Â´
+ Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn)(44.19)

44.1.
THE CASE OF A HALF SPACE
1223
Â¯Â¯Â¯Â¯
Z
U
hs (y) âˆ‚z
âˆ‚ys dy
Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯
Z
U
hs (y) âˆ‚
Â¡
âˆ’Dâˆ’h
k
Â¡
Î·2Dh
kw
Â¢Â¢
âˆ‚ys
dy
Â¯Â¯Â¯Â¯Â¯
â‰¤
Â¯Â¯Â¯Â¯Â¯
Z
U
Dh
khs (y) âˆ‚
Â¡Â¡
Î·2Dh
kw
Â¢Â¢
âˆ‚ys
Â¯Â¯Â¯Â¯Â¯
â‰¤
Z
U
Â¯Â¯Â¯Â¯Dh
khs2Î· âˆ‚Î·
âˆ‚ys Dh
kw
Â¯Â¯Â¯Â¯ dy +
Z
U
Â¯Â¯Â¯Â¯Â¯
Â¡
Î·Dh
khs
Â¢
Ãƒ
Î· âˆ‚
Â¡
Dh
kw
Â¢
âˆ‚ys
!Â¯Â¯Â¯Â¯Â¯ dy
â‰¤
C
X
s
||hs||H1(U)
Â³
||w||H1(U) +
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯
L2(U;Rn)
Â´
â‰¤
CÎµ
X
s
||hs||2
H1(U) + ||w||2
H1(U) + Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn) .
(44.20)
The following inequalities in 44.14,44.18, 44.19and 44.20 are summarized here.
A. â‰¥Î´
Z
U
Î·2 Â¯Â¯âˆ‡Dh
kw
Â¯Â¯2 dy,
B. â‰¤CÎµ (Î·, Lip (Î±) , Î±) ||âˆ‡w||2
L2(U;Rn) + Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(W âˆ©U;Rn) ,
Â¯Â¯Â¯Â¯
Z
U
fzdy
Â¯Â¯Â¯Â¯ â‰¤CÎµ
Â³
||f||2
L2(U) + ||âˆ‡w||2
L2(U;Rn)
Â´
+ Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn)
Â¯Â¯Â¯Â¯
Z
U
hs (y) âˆ‚z
âˆ‚ys dy
Â¯Â¯Â¯Â¯
â‰¤
CÎµ
X
s
||hs||2
H1(U)
+ ||w||2
H1(U) + Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn) .
Therefore,
Î´
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn)
â‰¤
CÎµ (Î·, Lip (Î±) , Î±) ||âˆ‡w||2
L2(U;Rn) + Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn)
+CÎµ
X
s
||hs||2
H1(U) + ||w||2
H1(U) + Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn)
+CÎµ
Â³
||f||2
L2(U) + ||âˆ‡w||2
L2(U;Rn)
Â´
+ Îµ
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn) .
Letting Îµ be small enough and adjusting constants yields
Â¯Â¯Â¯Â¯âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U1;Rn) â‰¤
Â¯Â¯Â¯Â¯Î·âˆ‡Dh
kw
Â¯Â¯Â¯Â¯2
L2(U;Rn) â‰¤

1224
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
C
Ãƒ
||w||2
H1(U) + ||f||2
L2(U) + CÎµ
X
s
||hs||2
H1(U)
!
where the constant, C, depends on Î·, Lip (Î±) , Î±, Î´. Since this holds for all h small
enough, it follows
âˆ‚w
âˆ‚yk âˆˆH1 (U1) and
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯âˆ‡âˆ‚w
âˆ‚yk
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
2
L2(U1;Rn)
â‰¤
C
Ãƒ
||w||2
H1(U) + ||f||2
L2(U) + CÎµ
X
s
||hs||2
H1(U)
!
(44.21)
for each k < n. It remains to estimate
Â¯Â¯Â¯
Â¯Â¯Â¯ âˆ‚2w
âˆ‚y2n
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(U1) . To do this return to 44.7
which must hold for all z âˆˆCâˆž
c (U1) . Therefore, using 44.7 it follows that for all
z âˆˆCâˆž
c (U1) ,
Z
U
Î±rs (y) âˆ‚w
âˆ‚yr
âˆ‚z
âˆ‚ys dy = âˆ’
Z
U
âˆ‚hs
âˆ‚ys zdy +
Z
U
fzdy.
Now from the Lipschitz assumption on Î±rs, it follows
F
â‰¡
X
r,sâ‰¤nâˆ’1
âˆ‚
âˆ‚ys
Âµ
Î±rs âˆ‚w
âˆ‚yr
Â¶
+
X
sâ‰¤nâˆ’1
âˆ‚
âˆ‚ys
Âµ
Î±ns âˆ‚w
âˆ‚yn
Â¶
âˆ’
X
s
âˆ‚hs
âˆ‚ys + f
âˆˆ
L2 (U1)
and
||F||L2(U1) â‰¤C
Ãƒ
||w||2
H1(U) + ||f||2
L2(U) + CÎµ
X
s
||hs||2
H1(U)
!
.
(44.22)
Therefore, from density of Câˆž
c (U1) in L2 (U1) ,
âˆ’âˆ‚
âˆ‚yn
Âµ
Î±nn (y) âˆ‚w
âˆ‚yn
Â¶
= F, no sum on n
and so
âˆ’âˆ‚Î±nn
âˆ‚yn
âˆ‚w
âˆ‚yn âˆ’Î±nn
âˆ‚2w
âˆ‚(yn)2 = F
By 44.2 Î±nn (y) â‰¥Î´ and so it follows from 44.22 that there exists a constant,C
depending on Î´ such that
Â¯Â¯Â¯Â¯Â¯
âˆ‚2w
âˆ‚(yn)2
Â¯Â¯Â¯Â¯Â¯
L2(U1)
â‰¤C
Â³
|F|L2(U1) + ||w||H1(U)
Â´

44.1.
THE CASE OF A HALF SPACE
1225
which with 44.21 and 44.22 implies the existence of a constant, C depending on Î´
such that
||w||2
H2(U1) â‰¤C
Ãƒ
||w||2
H1(U) + ||f||2
L2(U) + CÎµ
X
s
||hs||2
H1(U)
!
,
proving the lemma.
What if more regularity is known for f , hs, Î±rs and w? Could more be said
about the regularity of the solution? The answer is yes and is the content of the
next corollary.
First here is some notation.
For Î± a multi-index with |Î±| = k âˆ’1, Î± =
(Î±1, Â· Â· Â·, Î±n) deï¬ne
Dh
Î±l (y) â‰¡
n
Y
k=1
Â¡
Dh
k
Â¢Î±k l (y) .
Also, for Î± and Ï„ multi indices, Ï„ < Î± means Ï„ i < Î±i for each i.
Corollary 44.2 Suppose in the context of Lemma 44.1 the following for k â‰¥1.
w
âˆˆ
Hk (U) ,
Î±rs
âˆˆ
Ckâˆ’1,1 Â¡
U
Â¢
,
hs
âˆˆ
Hk (U) ,
f
âˆˆ
Hkâˆ’1 (U) ,
and
Z
U
Î±rs (y) âˆ‚w
âˆ‚yr
âˆ‚z
âˆ‚ys dy +
Z
U
hs (y) âˆ‚z
âˆ‚ys dy =
Z
U
fzdy
(44.23)
for all z âˆˆH1 (U) or H1
0 (U) such that spt (z) âŠ†V. Then there exists C independent
of w such that
||w||Hk+1(U1) â‰¤C
Ãƒ
||f||Hkâˆ’1(U) +
X
s
||hs||Hk(U) + ||w||Hk(U)
!
.
(44.24)
Proof: The proof involves the following claim which is proved using the conclu-
sion of Lemma 44.1 on Page 1220.
Claim : If Î± = (Î±â€², 0) where |Î±â€²| â‰¤k âˆ’1, then there exists a constant indepen-
dent of w such that
||DÎ±w||H2(U1) â‰¤C
Ãƒ
||f||Hkâˆ’1(U) +
X
s
||hs||Hk(U) + ||w||Hk(U)
!
.
(44.25)
Proof of claim: First note that if |Î±| = 0, then 44.25 follows from Lemma 44.1
on Page 1220. Now suppose the conclusion of the claim holds for all |Î±| â‰¤j âˆ’1
where j < k.
Let |Î±| = j and Î± = (Î±â€², 0) . Then for z âˆˆH1 (U) having compact
support in V, it follows that for h small enough,
Dâˆ’h
Î± z âˆˆH1 (U) , spt
Â¡
Dh
Î±z
Â¢
âŠ†V.

1226
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
Therefore, you can replace z in 44.23 with Dâˆ’h
Î± z. Now note that you can apply the
following manipulation.
Z
U
p (y) Dâˆ’h
Î± z (y) dy =
Z
U
Dh
Î±p (y) z (y) dy
and obtain
Z
U
Âµ
Dh
Î±
Âµ
Î±rs âˆ‚w
âˆ‚yr
Â¶ âˆ‚z
âˆ‚ys + Dh
Î± (hs) âˆ‚z
âˆ‚ys
Â¶
dy =
Z
U
Â¡Â¡
Dh
Î±f
Â¢
z
Â¢
dy.
(44.26)
Letting h â†’0, this gives
Z
U
Âµ
DÎ±
Âµ
Î±rs âˆ‚w
âˆ‚yr
Â¶ âˆ‚z
âˆ‚ys + DÎ± (hs) âˆ‚z
âˆ‚ys
Â¶
dy =
Z
U
((DÎ±f) z) dy.
Now
DÎ±
Âµ
Î±rs âˆ‚w
âˆ‚yr
Â¶
= Î±rs âˆ‚(DÎ±w)
âˆ‚yr
+
X
Ï„<Î±
C (Ï„) DÎ±âˆ’Ï„ (Î±rs) âˆ‚(DÏ„w)
âˆ‚yr
where C (Ï„) is some coeï¬ƒcient. Therefore, from 44.26,
Z
U
Î±rs âˆ‚(DÎ±w)
âˆ‚yr
âˆ‚z
âˆ‚ys dy +
Z
U
ÃƒX
Ï„<Î±
C (Ï„) DÎ±âˆ’Ï„ (Î±rs) âˆ‚(DÏ„w)
âˆ‚yr
+ DÎ± (hs)
!
âˆ‚z
âˆ‚ys dy
=
Z
U
(DÎ±f) zdy.
(44.27)
Let bU1 be as indicated in the following picture
R
Rnâˆ’1
U
V
U1
bU1
Now apply the induction hypothesis to bU1 in order to write
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
âˆ‚(DÏ„w)
âˆ‚yr
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
H1( bU1)
â‰¤||DÏ„w||H2( bU1)

44.1.
THE CASE OF A HALF SPACE
1227
â‰¤C
Ãƒ
||f||Hkâˆ’1(U) +
X
s
||hs||Hk(U) + ||w||Hk(U)
!
.
Since Î±rs âˆˆCkâˆ’1,1 Â¡
U
Â¢
, it follows that each term from the sum in 44.27 satisï¬es
an inequality of the form
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯C (Ï„) DÎ±âˆ’Ï„ (Î±rs) âˆ‚(DÏ„w)
âˆ‚yr
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
H1( bU1)
â‰¤
C
Ãƒ
||f||Hkâˆ’1(U) +
X
s
||hs||Hk(U) + ||w||Hk(U)
!
and consequently,
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
X
Ï„<Î±
C (Ï„) DÎ±âˆ’Ï„ (Î±rs) âˆ‚(DÏ„w)
âˆ‚yr
+ DÎ± (hs)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
H1( bU1)
â‰¤
C
Ãƒ
||f||Hkâˆ’1(U) +
X
s
||hs||Hk(U) + ||w||Hk(U)
!
.
(44.28)
Now consider 44.27. The equation remains true if you replace U with bU1 and require
that spt (z) âŠ†bU1. Therefore, by Lemma 44.1 on Page 1220 there exists a constant,
C independent of w such that
||DÎ±w||H2(U1) â‰¤C
Â³
||DÎ±f||L2( bU1) + ||DÎ±w||H1( bU1) +
+
X
s
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
X
Ï„<Î±
C (Ï„) DÎ±âˆ’Ï„ (Î±rs) âˆ‚(DÏ„w)
âˆ‚yr
+ DÎ± (hs)
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
H1( bU1)
ï£¶
ï£¸
and by 44.28, this implies
||DÎ±w||H2(U1) â‰¤C
Ãƒ
||f||Hkâˆ’1(U) + ||w||Hk(U) +
X
s
||hs||Hk(U)
!
which proves the Claim.
To establish 44.24 it only remains to verify that if |Î±| â‰¤k + 1, then
||DÎ±w||L2(U1) â‰¤C
Ãƒ
||f||Hkâˆ’1(U) + ||w||Hk(U) +
X
s
||hs||Hk(U)
!
.
(44.29)
If |Î±| < k + 1, there is nothing to show because it is given that w âˆˆHk (U) .
Therefore, assume |Î±| = k + 1. If Î±n equals 0 the conclusion follows from the claim

1228
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
because in this case, you can subtract 1 from a pair of positive Î±i and obtain a new
multi index, Î² such that |Î²| = k âˆ’1 and Î²n = 0 and then from the claim,
||DÎ±w||L2(U1) â‰¤
Â¯Â¯Â¯Â¯DÎ²w
Â¯Â¯Â¯Â¯
H2(U1) â‰¤C
Ãƒ
||f||Hkâˆ’1(U) + ||w||Hk(U) +
X
s
||hs||Hk(U)
!
.
If Î±n = 1, then subtract 1 from some positive Î±i and consider
Î² = (Î±1, Â· Â· Â·, Î±i âˆ’1, Î±i+1, Â· Â· Â·, Î±nâˆ’1, 0)
Then from the claim,
||DÎ±w||L2(U1) â‰¤
Â¯Â¯Â¯Â¯DÎ²w
Â¯Â¯Â¯Â¯
H2(U1) â‰¤C
Ãƒ
||f||Hkâˆ’1(U) + ||w||Hk(U) +
X
s
||hs||Hk(U)
!
.
Suppose 44.29 holds for Î±n â‰¤j âˆ’1 where j âˆ’1 â‰¥1 and consider Î± for which
|Î±| = k + 1 and Î±n = j. Let
Î² â‰¡(Î±1, Â· Â· Â·, Î±nâˆ’1, Î±n âˆ’2) .
Thus DÎ± = DÎ²D2
n. Restricting 44.23 to z âˆˆCâˆž
c (U1) and using the density of this
set of functions in L2 (U1) , it follows that
âˆ’âˆ‚
âˆ‚ys
Âµ
Î±rs (y) âˆ‚w
âˆ‚yr
Â¶
âˆ’âˆ‚hs
âˆ‚ys = f.
Therefore, from the product rule,
âˆ‚Î±rs
âˆ‚ys
âˆ‚w
âˆ‚yr + Î±rs
âˆ‚2w
âˆ‚ysâˆ‚yr + âˆ‚hs
âˆ‚ys = âˆ’f
and so
Î±nnD2
nw
=
âˆ’
ï£«
ï£­âˆ‚Î±rs
âˆ‚ys
âˆ‚w
âˆ‚yr +
X
râ‰¤nâˆ’1
X
sâ‰¤nâˆ’1
Î±rs
âˆ‚2w
âˆ‚ysâˆ‚yr +
X
s
Î±ns
âˆ‚2w
âˆ‚ysâˆ‚yn +
X
r
Î±rn
âˆ‚2w
âˆ‚ynâˆ‚yr + âˆ‚hs
âˆ‚ys + f
!
.
As noted earlier, the condition, 44.2 implies Î±nn (y) â‰¥Î´ > 0 and so
D2
nw
=
âˆ’1
Î±nn
ï£«
ï£­âˆ‚Î±rs
âˆ‚ys
âˆ‚w
âˆ‚yr +
X
râ‰¤nâˆ’1
X
sâ‰¤nâˆ’1
Î±rs
âˆ‚2w
âˆ‚ysâˆ‚yr +
X
s
Î±ns
âˆ‚2w
âˆ‚ysâˆ‚yn +
X
r
Î±rn
âˆ‚2w
âˆ‚ynâˆ‚yr + âˆ‚hs
âˆ‚ys + f
!
.

44.2.
THE CASE OF BOUNDED OPEN SETS
1229
It follows from DÎ± = DÎ²D2
n that
DÎ±w
=
DÎ²
ï£®
ï£°âˆ’1
Î±nn
ï£«
ï£­âˆ‚Î±rs
âˆ‚ys
âˆ‚w
âˆ‚yr +
X
râ‰¤nâˆ’1
X
sâ‰¤nâˆ’1
Î±rs
âˆ‚2w
âˆ‚ysâˆ‚yr +
X
s
Î±ns
âˆ‚2w
âˆ‚ysâˆ‚yn +
X
r
Î±rn
âˆ‚2w
âˆ‚ynâˆ‚yr + âˆ‚hs
âˆ‚ys + f
!#
.
Now you note that terms like DÎ² Â³
âˆ‚2w
âˆ‚ysâˆ‚yn
Â´
have Î±n = j âˆ’1 and so, from the
induction hypothesis along with the assumptions on the given functions,
||DÎ±w||L2(U1) â‰¤C
Ãƒ
||f||Hkâˆ’1(U) + ||w||Hk(U) +
X
s
||hs||Hk(U)
!
.
This proves the corollary.
44.2
The Case Of Bounded Open Sets
The main interest in all this is in the application to bounded open sets. Recall the
following deï¬nition.
Deï¬nition 44.3 A bounded open subset, â„¦, of Rn has a Cm,1boundary if it satis-
ï¬es the following conditions. For each p âˆˆÎ“ â‰¡â„¦\ â„¦, there exists an open set, W,
containing p, an open interval (0, b), a bounded open box U â€² âŠ†Rnâˆ’1, and an aï¬ƒne
orthogonal transformation, RW consisting of a distance preserving linear transfor-
mation followed by a translation such that
RW W = U â€² Ã— (0, b),
(44.30)
RW (W âˆ©â„¦) = {u âˆˆRn : uâ€² âˆˆU â€², 0 < un < Ï†W (uâ€²)}
(44.31)
where Ï†W âˆˆCm,1 Â¡
U â€²Â¢
meaning Ï†W is the restriction to U â€² of a function, still
denoted by Ï†W which is in Cm,1 Â¡
Rnâˆ’1Â¢
and
inf {Ï†W (uâ€²) : uâ€² âˆˆU â€²} > 0
The following picture depicts the situation.




ZZZZZ
ZZZZZ




-
RW
W
â„¦T W
RW (â„¦T W)
0
b
uâ€² âˆˆU â€²

1230
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
For the situation described in the above deï¬nition, let hW : U â€² â†’Î“ âˆ©W be
deï¬ned by
hW (uâ€²) â‰¡Râˆ’1
W (uâ€², Ï†W (uâ€²)) , gW (x) â‰¡(RW x)â€² , HW (u) â‰¡Râˆ’1
W (uâ€², Ï†W (uâ€²) âˆ’un) .
where xâ€² â‰¡(x1, Â· Â· Â·, xnâˆ’1) for x = (x1, Â· Â· Â·, xn). Thus gW â—¦hW = id on U â€² and
hW â—¦gW = id on Î“âˆ©W. Also note that HW is deï¬ned on all of Rn is Cm,1, and has
an inverse with the same properties. To see this, let GW (u) = (uâ€², Ï†W (uâ€²) âˆ’un) .
Then HW = Râˆ’1
W â—¦GW and Gâˆ’1
W = (uâ€², Ï†W (uâ€²) âˆ’un) and so Hâˆ’1
W = Gâˆ’1
W â—¦RW .
Note also that as indicated in the picture,
RW (W âˆ©â„¦) = {u âˆˆRn : uâ€² âˆˆU â€² and 0 < un < Ï†W (uâ€²)} .
Since Î“ = âˆ‚â„¦is compact, there exist ï¬nitely many of these open sets, W, denoted
by {Wi}q
i=1 such that Î“ âŠ†âˆªq
i=1Wi. Let the corresponding sets, U â€² be denoted by U â€²
i
and let the functions, Ï† be denoted by Ï†i. Also let hi = hWi, GWi = Gi etc. Now
let
Î¦i : GiRi (â„¦âˆ©W) â‰¡Vi â†’â„¦âˆ©Wi
be deï¬ned by
Î¦i (y) â‰¡Râˆ’1
i
â—¦Gâˆ’1
i
(y) .
Thus Î¦i, Î¦âˆ’1
i
âˆˆCm,1 (Rn). The following picture might be helpful.




ZZZZZ
ZZZZZ




@
@
@
@
@
R
Ri
Wi
â„¦T Wi
spt(Ïˆi)




Ri(â„¦T Wi)
Â¡
Â¡
Âª
0
b
uâ€² âˆˆU â€²
Â¢
Â¢
Â¢
Â¢
Â¢
Â¢
Â¢
Gi
0
Rnâˆ’1
y
Î¦âˆ’1
i (spt(Ïˆi))




+
Vi
Î¦âˆ’1
i (â„¦T Wi)
@
@
@
R
Ui

44.2.
THE CASE OF BOUNDED OPEN SETS
1231
Therefore, by Lemma 41.20 on Page 1185, it follows that for t âˆˆ[m, m + 1),
Î¦âˆ—
i âˆˆL
Â¡
Ht (Wi âˆ©â„¦) , Ht (Vi)
Â¢
.
Assume
aij (x) vivj â‰¥Î´ |v|2 .
(44.32)
Lemma 44.4 Let W be one of the sets described in the above deï¬nition and let
m â‰¥1. Let W1 âŠ†W1 âŠ†W where W1 is an open set. Suppose also that
u
âˆˆ
H1 (â„¦) ,
Î±rs
âˆˆ
C0,1 Â¡
â„¦
Â¢
,
f
âˆˆ
L2 (â„¦) ,
hk
âˆˆ
H1 (â„¦) ,
and that for all v âˆˆH1 (â„¦âˆ©W) such that spt (v) âŠ†â„¦âˆ©W,
Z
â„¦
aij (x) u,i (x) v,j (x) dx +
Z
â„¦
hk (x) v,k (x) dx =
Z
â„¦
f (x) v (x) dx.
(44.33)
Then there exists a constant, C, independent of f, u, and g such that
||u||2
H2(â„¦âˆ©W1) â‰¤C
Ãƒ
||f||2
L2(â„¦) + ||u||2
H1(â„¦) +
X
k
||hk||2
H1(â„¦)
!
.
(44.34)
Proof: Let
E â‰¡
Â©
v âˆˆH1 (â„¦âˆ©W) : spt (v) âŠ†W
Âª
u restricted to W âˆ©â„¦is in H1 (â„¦âˆ©W) and
Z
â„¦âˆ©W
aij (x) u,iv,jdx +
Z
â„¦
hk (x) v,k (x) dx =
Z
â„¦
f (x) v (x) dx for all v âˆˆE.
(44.35)
Now let Î¦i (y) = x. For this particular W, denote Î¦i more simply by Î¦, Ui â‰¡
Î¦i (â„¦âˆ©Wi) by U, and Vi by V. Denoting the coordinates of V by y, and letting
u (x) â‰¡w (y) and v (x) â‰¡z (y) , it follows that in terms of the new coordinates,
44.35 takes the form
Z
U
aij (Î¦ (y)) âˆ‚w
âˆ‚yr
âˆ‚yr
âˆ‚xi
âˆ‚z
âˆ‚ys
âˆ‚ys
âˆ‚xj |det DÎ¦ (y)| dy
+
Z
U
hk (Î¦ (y)) âˆ‚z
âˆ‚yl
âˆ‚yl
âˆ‚xk |det DÎ¦ (y)| dx
=
Z
U
f (Î¦ (y)) z (y) |det DÎ¦ (y)| dy
Let
Î±rs (y) â‰¡aij (Î¦ (y)) âˆ‚yr
âˆ‚xi
âˆ‚ys
âˆ‚xj |det DÎ¦ (y)| ,
(44.36)

1232
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
ehl (y) â‰¡hk (Î¦ (y)) âˆ‚yl
âˆ‚xk |det DÎ¦ (y)| ,
(44.37)
and
ef (y) â‰¡Î¦âˆ—f |det DÎ¦| (y) â‰¡f (Î¦ (y)) |det DÎ¦ (y)| .
(44.38)
Now the function on the right in 44.36 is in C0,1 Â¡
U
Â¢
. This is because of the
assumption that m â‰¥1 in the statement of the lemma. This function is therefore a
ï¬nite product of bounded functions in C0,1 Â¡
U
Â¢
.
The function ehl deï¬ned in 44.37 is in H1 (U) and
Â¯Â¯Â¯
Â¯Â¯Â¯ ehl
Â¯Â¯Â¯
Â¯Â¯Â¯
H1(U) â‰¤C
X
k
||hk||H1(â„¦âˆ©W )
again because m â‰¥1.
Finally, the right side of 44.38 is a function in L2 (U) by Lemma 41.20 on Page
1185 and the observation that |det DÎ¦ (Â·)| âˆˆC0,1 Â¡
U
Â¢
which follows from the as-
sumption of the lemma that m â‰¥1 so Î¦ âˆˆC1,1 (Rn). Also
Â¯Â¯Â¯
Â¯Â¯Â¯ ef
Â¯Â¯Â¯
Â¯Â¯Â¯
L2(U) â‰¤C ||f||L2(â„¦âˆ©W ) .
Therefore, 44.35 is of the form
Z
U
Î±rs (y) w,rz,sdy +
Z
U
ehlz,ldy =
Z
U
efzdy,
(44.39)
for all z in H1 (U) having support in V.
Claim: There exists r > 0 independent of y âˆˆU such that for all y âˆˆU,
Î±rs (y) vrvs â‰¥r |v|2 .
Proof of the claim: If this is not so, there exist vectors, vn, |vn| = 1, and
yn âˆˆU such that Î±rs (yn) vn
r vn
s â‰¤1
n. Taking a subsequence, there exists y âˆˆU and
|v| = 1 such that Î±rs (y) vrvs = 0 contradicting 44.32.
Therefore, by Lemma 44.1, there exists a constant, C, independent of f, g, and
w such that
||w||2
H2(Î¦âˆ’1(W1âˆ©â„¦)) â‰¤C
ÃƒÂ¯Â¯Â¯
Â¯Â¯Â¯ ef
Â¯Â¯Â¯
Â¯Â¯Â¯
2
L2(U) + ||w||2
H1(U) +
X
l
Â¯Â¯Â¯
Â¯Â¯Â¯ ehl
Â¯Â¯Â¯
Â¯Â¯Â¯
2
H1(U)
!
.
Therefore,
||u||2
H2(W1âˆ©â„¦)
â‰¤
C
Ãƒ
||f||2
L2(W âˆ©â„¦) + ||w||2
H1(W âˆ©â„¦) +
X
k
||hk||2
H1(W âˆ©â„¦)
!
â‰¤
C
Ãƒ
||f||2
L2(â„¦) + ||w||2
H1(â„¦) +
X
k
||hk||2
H1(â„¦)
!
.
which proves the lemma.
With this lemma here is the main result.

44.2.
THE CASE OF BOUNDED OPEN SETS
1233
Theorem 44.5 Let â„¦be a bounded open set with C1,1 boundary as in Deï¬nition
44.3, let f âˆˆL2 (â„¦) , hk âˆˆH1 (â„¦), and suppose that for all x âˆˆâ„¦,
aij (x) vivj â‰¥Î´ |v|2 .
Suppose also that u âˆˆH1 (â„¦) and
Z
â„¦
aij (x) u,i (x) v,j (x) dx +
Z
â„¦
hk (x) v,k (x) dx =
Z
â„¦
f (x) v (x) dx
for all v âˆˆH1 (â„¦) . Then u âˆˆH2 (â„¦) and for some C independent of f, g, and u,
||u||2
H2(â„¦) â‰¤C
Ãƒ
||f||2
L2(â„¦) + ||u||2
H1(â„¦) +
X
k
||hk||2
H1(â„¦)
!
.
Proof: Let the Wi for i = 1, Â· Â· Â·, l be as described in Deï¬nition 44.3. Thus
âˆ‚â„¦âŠ†âˆªl
j=1Wj. Then let C1 â‰¡âˆ‚â„¦\ âˆªl
i=2Wi, a closed subset of W1. Let D1 be an
open set satisfying
C1 âŠ†D1 âŠ†D1 âŠ†W1.
Then D1, W2, Â·Â·Â·, Wl cover âˆ‚â„¦. Let C2 = âˆ‚â„¦\
Â¡
D1 âˆª
Â¡
âˆªl
i=3Wi
Â¢Â¢
. Then C2 is a closed
subset of W2. Choose an open set, D2 such that
C2 âŠ†D2 âŠ†D2 âŠ†W2.
Thus D1, D2, W3 Â· Â·Â·, Wl covers âˆ‚â„¦. Continue in this way to get Di âŠ†Wi, and
âˆ‚â„¦âŠ†âˆªl
i=1Di, and Di is an open set. Now let
D0 â‰¡â„¦\ âˆªl
i=1Di.
Also, let Di âŠ†Vi âŠ†Vi âŠ†Wi. Therefore, D0, V1, Â· Â· Â·, Vl covers â„¦. Then the same
estimation process used above yields
||u||H2(D0) â‰¤C
Ãƒ
||f||2
L2(â„¦) + ||u||2
H1(â„¦) +
X
k
||hk||2
H1(â„¦)
!
.
From Lemma 44.4
||u||H2(Viâˆ©â„¦) â‰¤C
Ãƒ
||f||2
L2(â„¦) + ||u||2
H1(â„¦) +
X
k
||hk||2
H1(â„¦)
!
also. This proves the theorem since
||u||H2(â„¦) â‰¤
l
X
i=1
||u||H2(Viâˆ©â„¦) + ||u||H2(D0) .
What about the Dirichlet problem? The same diï¬€erencing procedure as above
yields the following.

1234
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
Theorem 44.6 Let â„¦be a bounded open set with C1,1 boundary as in Deï¬nition
44.3, let f âˆˆL2 (â„¦) , hk âˆˆH1 (â„¦), and suppose that for all x âˆˆâ„¦,
aij (x) vivj â‰¥Î´ |v|2 .
Suppose also that u âˆˆH1
0 (â„¦) and
Z
â„¦
aij (x) u,i (x) v,j (x) dx +
Z
â„¦
hk (x) v,k (x) dx =
Z
â„¦
f (x) v (x) dx
for all v âˆˆH1
0 (â„¦) . Then u âˆˆH2 (â„¦) and for some C independent of f, g, and u,
||u||2
H2(â„¦) â‰¤C
Ãƒ
||f||2
L2(â„¦) + ||u||2
H1(â„¦) +
X
k
||hk||2
H1(â„¦)
!
.
What about higher regularity?
Lemma 44.7 Let W be one of the sets described in Deï¬nition 44.3 and let m â‰¥k.
Let W1 âŠ†W1 âŠ†W where W1 is an open set. Suppose also that
u
âˆˆ
Hk (â„¦) ,
Î±rs
âˆˆ
Ckâˆ’1,1 Â¡
â„¦
Â¢
,
f
âˆˆ
Hkâˆ’1 (â„¦) ,
hs
âˆˆ
Hk (â„¦) ,
and that for all v âˆˆH1 (â„¦âˆ©W) such that spt (v) âŠ†â„¦âˆ©W,
Z
â„¦
aij (x) u,i (x) v,j (x) dx +
Z
â„¦
hs (x) v,s (x) dx =
Z
â„¦
f (x) v (x) dx.
(44.40)
Then there exists a constant, C, independent of f, u, and g such that
||u||2
Hk+1(â„¦âˆ©W1) â‰¤C
Ãƒ
||f||2
Hkâˆ’1(â„¦) + ||u||2
Hk(â„¦) +
X
s
||hs||2
Hk(â„¦)
!
.
(44.41)
Proof: Let
E â‰¡
Â©
v âˆˆHk (â„¦âˆ©W) : spt (v) âŠ†W
Âª
u restricted to W âˆ©â„¦is in Hk (â„¦âˆ©W) and
Z
â„¦âˆ©W
aij (x) u,iv,jdx +
Z
â„¦
hs (x) v,s (x) dx
=
Z
â„¦
f (x) v (x) dx for all v âˆˆE.
(44.42)
Now let Î¦i (y) = x. For this particular W, denote Î¦i more simply by Î¦, Ui â‰¡
Î¦i (â„¦âˆ©Wi) by U, and Vi by V. Denoting the coordinates of V by y, and letting

44.2.
THE CASE OF BOUNDED OPEN SETS
1235
u (x) â‰¡w (y) and v (x) â‰¡z (y) , it follows that in terms of the new coordinates,
44.35 takes the form
Z
U
aij (Î¦ (y)) âˆ‚w
âˆ‚yr
âˆ‚yr
âˆ‚xi
âˆ‚z
âˆ‚ys
âˆ‚ys
âˆ‚xj |det DÎ¦ (y)| dy
+
Z
U
hk (Î¦ (y)) âˆ‚z
âˆ‚yl
âˆ‚yl
âˆ‚xk |det DÎ¦ (y)| dx
=
Z
U
f (Î¦ (y)) z (y) |det DÎ¦ (y)| dy
Let
Î±rs (y) â‰¡aij (Î¦ (y)) âˆ‚yr
âˆ‚xi
âˆ‚ys
âˆ‚xj |det DÎ¦ (y)| ,
(44.43)
ehl (y) â‰¡hk (Î¦ (y)) âˆ‚yl
âˆ‚xk |det DÎ¦ (y)| ,
(44.44)
and
ef (y) â‰¡Î¦âˆ—f |det DÎ¦| (y) â‰¡f (Î¦ (y)) |det DÎ¦ (y)| .
(44.45)
Now the function on the right in 44.43 is in Ck,1 Â¡
U
Â¢
. This is because of the
assumption that m â‰¥k in the statement of the lemma. This function is therefore a
ï¬nite product of bounded functions in Ck,1 Â¡
U
Â¢
.
The function ehl deï¬ned in 44.44 is in Hk (U) and
Â¯Â¯Â¯
Â¯Â¯Â¯ ehl
Â¯Â¯Â¯
Â¯Â¯Â¯
Hk(U) â‰¤C
X
s
||hs||Hk(â„¦âˆ©W )
again because m â‰¥k.
Finally, the right side of 44.45 is a function in Hkâˆ’1 (U) by Lemma 41.20 on
Page 1185 and the observation that |det DÎ¦ (Â·)| âˆˆCkâˆ’1,1 Â¡
U
Â¢
which follows from
the assumption of the lemma that m â‰¥k so Î¦ âˆˆCkâˆ’1,1 (Rn). Also
Â¯Â¯Â¯
Â¯Â¯Â¯ ef
Â¯Â¯Â¯
Â¯Â¯Â¯
Hkâˆ’1(U) â‰¤C ||f||Hkâˆ’1(â„¦âˆ©W ) .
Therefore, 44.42 is of the form
Z
U
Î±rs (y) w,rz,sdy +
Z
U
ehlz,ldy =
Z
U
efzdy,
(44.46)
for all z in H1 (U) having support in V.
Claim: There exists r > 0 independent of y âˆˆU such that for all y âˆˆU,
Î±rs (y) vrvs â‰¥r |v|2 .
Proof of the claim: If this is not so, there exist vectors, vn, |vn| = 1, and
yn âˆˆU such that Î±rs (yn) vn
r vn
s â‰¤1
n. Taking a subsequence, there exists y âˆˆU and
|v| = 1 such that Î±rs (y) vrvs = 0 contradicting 44.32.

1236
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES
Therefore, by Corollary 44.2, there exists a constant, C, independent of f, g, and
w such that
||w||2
Hk+1(Î¦âˆ’1(W1âˆ©â„¦)) â‰¤C
ÃƒÂ¯Â¯Â¯
Â¯Â¯Â¯ ef
Â¯Â¯Â¯
Â¯Â¯Â¯
2
Hkâˆ’1(U) + ||w||2
Hk(U) +
X
l
Â¯Â¯Â¯
Â¯Â¯Â¯ ehl
Â¯Â¯Â¯
Â¯Â¯Â¯
2
Hk(U)
!
.
Therefore,
||u||2
Hk+1(W1âˆ©â„¦)
â‰¤
C
Ãƒ
||f||2
Hkâˆ’1(W âˆ©â„¦) + ||w||2
Hk(W âˆ©â„¦) +
X
s
||hs||2
Hk(W âˆ©â„¦)
!
â‰¤
C
Ãƒ
||f||2
Hkâˆ’1(â„¦) + ||w||2
Hk(â„¦) +
X
s
||hs||2
Hk(â„¦)
!
.
which proves the lemma.
Now here is a theorem which generalizes the one above in the case where more
regularity is known.
Theorem 44.8 Let â„¦be a bounded open set with Ck,1 boundary as in Deï¬nition
44.3, let f âˆˆHkâˆ’1 (â„¦) , hs âˆˆHk (â„¦), and suppose that for all x âˆˆâ„¦,
aij (x) vivj â‰¥Î´ |v|2 .
Suppose also that u âˆˆHk (â„¦) and
Z
â„¦
aij (x) u,i (x) v,j (x) dx +
Z
â„¦
hk (x) v,k (x) dx =
Z
â„¦
f (x) v (x) dx
for all v âˆˆHk (â„¦) . Then u âˆˆHk+1 (â„¦) and for some C independent of f, g, and u,
||u||2
Hk+1(â„¦) â‰¤C
Ãƒ
||f||2
Hkâˆ’1(â„¦) + ||u||2
Hk(â„¦) +
X
s
||hs||2
Hk(â„¦)
!
.
Proof: Let the Wi for i = 1, Â· Â· Â·, l be as described in Deï¬nition 44.3. Thus
âˆ‚â„¦âŠ†âˆªl
j=1Wj. Then let C1 â‰¡âˆ‚â„¦\ âˆªl
i=2Wi, a closed subset of W1. Let D1 be an
open set satisfying
C1 âŠ†D1 âŠ†D1 âŠ†W1.
Then D1, W2, Â·Â·Â·, Wl cover âˆ‚â„¦. Let C2 = âˆ‚â„¦\
Â¡
D1 âˆª
Â¡
âˆªl
i=3Wi
Â¢Â¢
. Then C2 is a closed
subset of W2. Choose an open set, D2 such that
C2 âŠ†D2 âŠ†D2 âŠ†W2.
Thus D1, D2, W3 Â· Â·Â·, Wl covers âˆ‚â„¦. Continue in this way to get Di âŠ†Wi, and
âˆ‚â„¦âŠ†âˆªl
i=1Di, and Di is an open set. Now let
D0 â‰¡â„¦\ âˆªl
i=1Di.

44.2.
THE CASE OF BOUNDED OPEN SETS
1237
Also, let Di âŠ†Vi âŠ†Vi âŠ†Wi. Therefore, D0, V1, Â· Â· Â·, Vl covers â„¦. Then the same
estimation process used above yields
||u||Hk+1(D0) â‰¤C
Ãƒ
||f||2
Hkâˆ’1(â„¦) + ||u||2
Hk(â„¦) +
X
k
||hk||2
Hk(â„¦)
!
.
From Lemma 44.7
||u||Hk+1(Viâˆ©â„¦) â‰¤C
Ãƒ
||f||2
Hkâˆ’1(â„¦) + ||u||2
Hk(â„¦) +
X
k
||hk||2
Hk(â„¦)
!
also. This proves the theorem since
||u||Hk+1(â„¦) â‰¤
l
X
i=1
||u||Hk+1(Viâˆ©â„¦) + ||u||Hk+1(D0) .

1238
ELLIPTIC REGULARITY AND NIRENBERG DIFFERENCES

Interpolation In Banach
Space
45.1
An Assortment Of Important Theorems
45.1.1
Weak Vector Valued Derivatives
In this section, several signiï¬cant theorems are presented. Unless indicated other-
wise, the measure will be Lebesgue measure. First here is a lemma.
Lemma 45.1 Suppose g âˆˆL1 ([a, b] ; X) where X is a Banach space.
Then if
R b
a g (t) Ï† (t) dt = 0 for all Ï† âˆˆCâˆž
c (a, b) , then g (t) = 0 a.e.
Proof: Let E be a measurable subset of (a, b) and let K âŠ†E âŠ†V âŠ†(a, b)
where K is compact, V is open and m (V \ K) < Îµ. Let K â‰ºh â‰ºV as in the proof
of the Riesz representation theorem for positive linear functionals. Enlarging K
slightly and convolving with a molliï¬er, it can be assumed h âˆˆCâˆž
c (a, b) . Then
Â¯Â¯Â¯Â¯Â¯
Z b
a
XE (t) g (t) dt
Â¯Â¯Â¯Â¯Â¯
=
Â¯Â¯Â¯Â¯Â¯
Z b
a
(XE (t) âˆ’h (t)) g (t) dt
Â¯Â¯Â¯Â¯Â¯
â‰¤
Z b
a
|XE (t) âˆ’h (t)| ||g (t)|| dt
â‰¤
Z
V \K
||g (t)|| dt.
Now let Kn âŠ†E âŠ†Vn with m (Vn \ Kn) < 2âˆ’n. Then from the above,
Â¯Â¯Â¯Â¯Â¯
Z b
a
XE (t) g (t) dt
Â¯Â¯Â¯Â¯Â¯ â‰¤
Z b
a
XVn\Kn (t) ||g (t)|| dt
and the integrand of the last integral converges to 0 a.e.
as n â†’âˆžbecause
P
n m (Vn \ Kn) < âˆž. By the dominated convergence theorem, this last integral
1239

1240
INTERPOLATION IN BANACH SPACE
converges to 0. Therefore, whenever E âŠ†(a, b) ,
Z b
a
XE (t) g (t) dt = 0.
Since the endpoints have measure zero, it also follows that for any measurable E,
the above equation holds.
Now g âˆˆL1 ([a, b] ; X) and so it is measurable. Therefore, g ([a, b]) is separable.
Let D be a countable dense subset and let E denote the set of linear combinations of
the form P
i aidi where ai is a rational point of F and di âˆˆD. Thus E is countable.
Denote by Y the closure of E in X. Thus Y
is a separable closed subspace of X
which contains all the values of g.
Now let Sn â‰¡gâˆ’1 (B (yn, ||yn|| /2)) where E = {yn}âˆž
n=1 . Therefore, âˆªnSn =
gâˆ’1 (X \ {0}) . This follows because if x âˆˆY and x Ì¸= 0, then in B
Â³
x, ||x||
4
Â´
there
is a point of E, yn. Therefore, ||yn|| > 3
4 ||x|| and so ||yn||
2
> 3||x||
8
> ||x||
4
so x âˆˆ
B (yn, ||yn|| /2) . It follows that if each Sn has measure zero, then g (t) = 0 for a.e.
t. Suppose then that for some n, the set, Sn has positive mesure. Then from what
was shown above,
||yn||
=
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
m (Sn)
Z
Sn
g (t) dt âˆ’yn
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ =
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
m (Sn)
Z
Sn
g (t) âˆ’yndt
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
â‰¤
1
m (Sn)
Z
Sn
||g (t) âˆ’yn|| dt â‰¤
1
m (Sn)
Z
Sn
||yn|| /2dt = ||yn|| /2
and so yn = 0 which implies Sn = âˆ…, a contradiction to m (Sn) > 0. This contradic-
tion shows each Sn has measure zero and so as just explained, g (t) = 0 a.e.
Deï¬nition 45.2 For f âˆˆL1 (a, b; X) , deï¬ne an extension, f deï¬ned on
[2a âˆ’b, 2b âˆ’a] = [a âˆ’(b âˆ’a) , b + (b âˆ’a)]
as follows.
f (t) â‰¡
ï£±
ï£²
ï£³
f (t) if t âˆˆ[a, b]
f (2a âˆ’t) if t âˆˆ[2a âˆ’b, a]
f (2b âˆ’t) if t âˆˆ[b, 2b âˆ’a]
Deï¬nition 45.3 Also if f âˆˆLp (a, b; X) and h > 0, deï¬ne for t âˆˆ[a, b] , fh (t) â‰¡
f (t âˆ’h) for all h < b âˆ’a. Thus the map f â†’fh is continuous and linear on
Lp (a, b; X) . It is continuous because
Z b
a
||fh (t)||p dt
=
Z a+h
a
||f (2a âˆ’t + h)||p dt +
Z bâˆ’h
a
||f (t)||p dt
=
Z a+h
a
||f (t)||p dt +
Z bâˆ’h
a
||f (t)||p dt â‰¤2 ||f||p
p .
The following lemma is on continuity of translation in Lp (a, b; X) .

45.1.
AN ASSORTMENT OF IMPORTANT THEOREMS
1241
Lemma 45.4 Let f be as deï¬ned in Deï¬nition 45.2. Then for f âˆˆLp (a, b; X) for
p âˆˆ[1, âˆž),
lim
Î´â†’0
Z b
a
Â¯Â¯Â¯Â¯f (t âˆ’Î´) âˆ’f (t)
Â¯Â¯Â¯Â¯p
X dt = 0.
Proof:
Regarding the measure space as (a, b) with Lebesgue measure, by
Lemma 21.42 there exists g âˆˆCc (a, b; X) such that ||f âˆ’g||p < Îµ. Here the norm
is the norm in Lp (a, b; X) . Therefore,
||fh âˆ’f||p
â‰¤
||fh âˆ’gh||p + ||gh âˆ’g||p + ||g âˆ’f||p
â‰¤
Â³
21/p + 1
Â´
||f âˆ’g||p + ||gh âˆ’g||p
<
Â³
21/p + 1
Â´
Îµ + Îµ
whenever h is suï¬ƒciently small. This is because of the uniform continuity of g.
Therefore, since Îµ > 0 is arbitrary, this proves the lemma.
Deï¬nition 45.5 Let f âˆˆL1 (a, b; X) . Then the distributional derivative in the
sense of X valued distributions is given by
f â€² (Ï†) â‰¡âˆ’
Z b
a
f (t) Ï†â€² (t) dt
Then f â€² âˆˆL1 (a, b; X) if there exists h âˆˆL1 (a, b; X) such that for all Ï† âˆˆCâˆž
c (a, b) ,
f â€² (Ï†) =
Z b
a
h (t) Ï† (t) dt.
Then f â€² is deï¬ned to equal h. Here f and f â€² are considered as vector valued distri-
butions in the same way as was done for scalar valued functions.
Lemma 45.6 The above deï¬nition is well deï¬ned.
Proof: Suppose both h and g work in the deï¬nition. Then for all Ï† âˆˆCâˆž
c (a, b) ,
Z b
a
(h (t) âˆ’g (t)) Ï† (t) dt = 0.
Therefore, by Lemma 45.1, h (t) âˆ’g (t) = 0 a.e.
The other thing to notice about this is the following lemma. It follows immedi-
ately from the deï¬nition.
Lemma 45.7 Suppose f, f â€² âˆˆL1 (a, b; X) . Then if [c, d] âŠ†[a, b], it follows that
Â¡
f|[c,d]
Â¢â€² = f â€²|[c,d]. This notation means the restriction to [c, d] .

1242
INTERPOLATION IN BANACH SPACE
Recall that in the case of scalar valued functions, if you had both f and its
weak derivative, f â€² in L1 (a, b) , then you were able to conclude that f is almost
everywhere equal to a continuous function, still denoted by f and
f (t) = f (a) +
Z t
a
f â€² (s) ds.
In particular, you can deï¬ne f (a) to be the initial value of this continuous function.
It turns out that an identical theorem holds in this case.
To begin with here
is the same sort of lemma which was used earlier for the case of scalar valued
functions. It says that if f â€² = 0 where the derivative is taken in the sense of X
valued distributions, then f equals a constant.
Lemma 45.8 Suppose f âˆˆL1 (a, b; X) and for all Ï† âˆˆCâˆž
c (a, b) ,
Z b
a
f (t) Ï†â€² (t) dt = 0.
Then there exists a constant, a âˆˆX such that f (t) = a a.e.
Proof: Let Ï†0 âˆˆCâˆž
c (a, b) ,
R b
a Ï†0 (x) dx = 1 and deï¬ne for Ï† âˆˆCâˆž
c (a, b)
ÏˆÏ† (x) â‰¡
Z x
a
[Ï† (t) âˆ’
ÃƒZ b
a
Ï† (y) dy
!
Ï†0 (t)]dt
Then ÏˆÏ† âˆˆCâˆž
c (a, b) and Ïˆâ€²
Ï† = Ï† âˆ’
Â³R b
a Ï† (y) dy
Â´
Ï†0. Then
Z b
a
f (t) (Ï† (t)) dt
=
Z b
a
f (t)
Ãƒ
Ïˆâ€²
Ï† (t) +
ÃƒZ b
a
Ï† (y) dy
!
Ï†0 (t)
!
dt
=
Z b
a
f (t) Ïˆâ€²
Ï† (t) dt +
ÃƒZ b
a
Ï† (y) dy
! Z b
a
f (t) Ï†0 (t) dt
=
ÃƒZ b
a
ÃƒZ b
a
f (t) Ï†0 (t) dt
!
Ï† (y) dy
!
.
It follows that for all Ï† âˆˆCâˆž
c (a, b) ,
Z b
a
Ãƒ
f (t) âˆ’
ÃƒZ b
a
f (t) Ï†0 (t) dt
!!
Ï† (t) dt
and so by Lemma 45.1,
f (t) âˆ’
ÃƒZ b
a
f (t) Ï†0 (t) dt
!
= 0 a.e.
This proves the lemma.

45.1.
AN ASSORTMENT OF IMPORTANT THEOREMS
1243
Theorem 45.9 Suppose f, f â€² both are in L1 (a, b; X) where the derivative is taken
in the sense of X valued distributions.
Then there exists a unique point of X,
denoted by f (a) such that the following formula holds a.e. t.
f (t) = f (a) +
Z t
a
f â€² (s) ds
Proof:
Z b
a
Âµ
f (t) âˆ’
Z t
a
f â€² (s) ds
Â¶
Ï†â€² (t) dt =
Z b
a
f (t) Ï†â€² (t) dt âˆ’
Z b
a
Z t
a
f â€² (s) Ï†â€² (t) dsdt.
Now consider
R b
a
R t
a f â€² (s) Ï†â€² (t) dsdt. Let Î› âˆˆXâ€². Then it is routine from approxi-
mating f â€² with simple functions to verify
Î›
ÃƒZ b
a
Z t
a
f â€² (s) Ï†â€² (t) dsdt
!
=
Z b
a
Z t
a
Î› (f â€² (s)) Ï†â€² (t) dsdt.
Now the ordinary Fubini theorem can be applied to obtain
=
Z b
a
Z b
s
Î› (f â€² (s)) Ï†â€² (t) dtds
=
Î›
ÃƒZ b
a
Z b
s
f â€² (s) Ï†â€² (t) dtds
!
.
Since Xâ€² separates the points of X, it follows
Z b
a
Z t
a
f â€² (s) Ï†â€² (t) dsdt =
Z b
a
Z b
s
f â€² (s) Ï†â€² (t) dtds.
Therefore,
Z b
a
Âµ
f (t) âˆ’
Z t
a
f â€² (s) ds
Â¶
Ï†â€² (t) dt
=
Z b
a
f (t) Ï†â€² (t) dt âˆ’
Z b
a
Z b
s
f â€² (s) Ï†â€² (t) dtds
=
Z b
a
f (t) Ï†â€² (t) dt âˆ’
Z b
a
f â€² (s)
Z b
s
Ï†â€² (t) dtds
=
Z b
a
f (t) Ï†â€² (t) dt +
Z b
a
f â€² (s) Ï† (s) ds = 0.
Therefore, by Lemma 45.8, there exists a constant, denoted as f (a) such that
f (t) âˆ’
Z t
a
f â€² (s) ds = f (a)
and this proves the theorem.
The integration by parts formula is also important.

1244
INTERPOLATION IN BANACH SPACE
Corollary 45.10 Suppose f, f â€² âˆˆL1 (a, b; X) and suppose Ï† âˆˆC1 ([a, b]) . Then
the following integration by parts formula holds.
Z b
a
f (t) Ï†â€² (t) dt = f (b) Ï† (b) âˆ’f (a) Ï† (a) âˆ’
Z b
a
f â€² (t) Ï† (t) dt.
Proof: From Theorem 45.9
Z b
a
f (t) Ï†â€² (t) dt
=
Z b
a
Âµ
f (a) +
Z t
a
f â€² (s) ds
Â¶
Ï†â€² (t) dt
=
f (a) (Ï† (b) âˆ’Ï† (a)) +
Z b
a
Z t
a
f â€² (s) dsÏ†â€² (t) dt
=
f (a) (Ï† (b) âˆ’Ï† (a)) +
Z b
a
f â€² (s)
Z b
s
Ï†â€² (t) dtds
=
f (a) (Ï† (b) âˆ’Ï† (a)) +
Z b
a
f â€² (s) (Ï† (b) âˆ’Ï† (s)) ds
=
f (a) (Ï† (b) âˆ’Ï† (a)) âˆ’
Z b
a
f â€² (s) Ï† (s) ds + (f (b) âˆ’f (a)) Ï† (b)
=
f (b) Ï† (b) âˆ’f (a) Ï† (a) âˆ’
Z b
a
f â€² (s) Ï† (s) ds.
The interchange in order of integration is justiï¬ed as in the proof of Theorem 45.9.
With this integration by parts formula, the following interesting lemma is ob-
tained. This lemma shows why it was appropriate to deï¬ne f as in Deï¬nition 45.2.
Lemma 45.11 Let f be given in Deï¬nition 45.2 and suppose f, f â€² âˆˆL1 (a, b; X) .
Then f, f
â€² âˆˆL1 (2a âˆ’b, 2b âˆ’a; X) also and
f
â€² (t) â‰¡
ï£±
ï£²
ï£³
f â€² (t) if t âˆˆ[a, b]
âˆ’f (2a âˆ’t) if t âˆˆ[2a âˆ’b, a]
âˆ’f (2b âˆ’t) if t âˆˆ[b, 2b âˆ’a]
(45.1)
Proof: It is clear from the deï¬nition of f that f âˆˆL1 (2a âˆ’b, 2b âˆ’a; X) and
that in fact
Â¯Â¯Â¯Â¯f
Â¯Â¯Â¯Â¯
L1(2aâˆ’b,2bâˆ’a;X) â‰¤3 ||f||L1(a,b;X) .
(45.2)

45.1.
AN ASSORTMENT OF IMPORTANT THEOREMS
1245
Let Ï† âˆˆCâˆž
c (2a âˆ’b, 2b âˆ’a) . Then from the integration by parts formula,
Z 2bâˆ’a
2aâˆ’b
f (t) Ï†â€² (t) dt
=
Z b
a
f (t) Ï†â€² (t) dt +
Z 2bâˆ’a
b
f (2b âˆ’t) Ï†â€² (t) dt +
Z a
2aâˆ’b
f (2a âˆ’t) Ï†â€² (t) dt
=
Z b
a
f (t) Ï†â€² (t) dt +
Z b
a
f (u) Ï†â€² (2b âˆ’u) du +
Z b
a
f (u) Ï†â€² (2a âˆ’u) du
=
f (b) Ï† (b) âˆ’f (a) Ï† (a) âˆ’
Z b
a
f â€² (t) Ï† (t) dt âˆ’f (b) Ï† (b) + f (a) Ï† (2b âˆ’a)
+
Z b
a
f â€² (u) Ï† (2b âˆ’u) du âˆ’f (b) Ï† (2a âˆ’b)
+f (a) Ï† (a) +
Z b
a
f â€² (u) Ï† (2a âˆ’u) du
=
âˆ’
Z b
a
f â€² (t) Ï† (t) dt +
Z b
a
f â€² (u) Ï† (2b âˆ’u) du +
Z b
a
f â€² (u) Ï† (2a âˆ’u) du
=
âˆ’
Z b
a
f â€² (t) Ï† (t) dt âˆ’
Z 2bâˆ’a
b
âˆ’f â€² (2b âˆ’t) Ï† (t) dt âˆ’
Z a
2aâˆ’b
âˆ’f â€² (2a âˆ’t) Ï† (t) dt
=
âˆ’
Z 2bâˆ’a
2aâˆ’b
f
â€² (t) Ï† (t) dt
where f
â€² (t) is given in 45.1. This proves the lemma.
Deï¬nition 45.12 Let V be a Banach space and let H be a Hilbert space. (Typically
H = L2 (â„¦)) Suppose V âŠ†H is dense in H meaning that the closure in H of V
gives H. Then it is often the case that H is identiï¬ed with its dual space, and then
because of the density of V in H, it is possible to write
V âŠ†H = Hâ€² âŠ†V â€²
When this is done, H is called a pivot space. Another notation which is often used
is âŸ¨f, gâŸ©to denote f (g) for f âˆˆV â€² and g âˆˆV. This may also be written as âŸ¨f, gâŸ©V â€²,V
The next theorem is an example of a trace theorem.
In this theorem, f âˆˆ
Lp (0, T; V ) while f â€² âˆˆLp (0, T; V â€²) . It makes no sense to consider the initial values
of f in V because it is not even continuous with values in V . However, because of
the derivative of f it will turn out that f is continuous with values in a larger space
and so it makes sense to consider initial values of f in this other space. This other
space is called a trace space.
Theorem 45.13 Let V and H be a Banach space and Hilbert space as described
in Deï¬nition 45.12. Suppose f âˆˆLp (0, T; V ) and f â€² âˆˆLpâ€² (0, T; V â€²) . Then f is

1246
INTERPOLATION IN BANACH SPACE
a.e. equal to a continuous function mapping [0, T] to H. Furthermore, there exists
f (0) âˆˆH such that
1
2 |f (t)|2
H âˆ’1
2 |f (0)|2
H =
Z t
0
âŸ¨f â€² (s) , f (s)âŸ©ds,
(45.3)
and for all t âˆˆ[0, T] ,
Z t
0
f â€² (s) ds âˆˆH,
(45.4)
and for a.e. t âˆˆ[0, T] ,
f (t) = f (0) +
Z t
0
f â€² (s) ds in H,
(45.5)
Here f â€² is being taken in the sense of V â€² valued distributions and 1
p + 1
pâ€² = 1 and
p â‰¥2.
Proof: Let Î¨ âˆˆCâˆž
c (âˆ’T, 2T) satisfy Î¨ (t) = 1 if t âˆˆ[âˆ’T/2, 3T/2] and Î¨ (t) â‰¥0.
For t âˆˆR, deï¬ne
bf (t) â‰¡
Â½
f (t) Î¨ (t) if t âˆˆ[âˆ’T, 2T]
0 if t /âˆˆ[âˆ’T, 2T]
and
fn (t) â‰¡
Z 1/n
âˆ’1/n
bf (t âˆ’s) Ï†n (s) ds
(45.6)
where Ï†n is a molliï¬er having support in (âˆ’1/n, 1/n) . Then by Minkowskiâ€™s in-
equality
Â¯Â¯Â¯
Â¯Â¯Â¯fn âˆ’bf
Â¯Â¯Â¯
Â¯Â¯Â¯
Lp(R;V ) =
ÃƒZ
R
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
bf (t) âˆ’
Z 1/n
âˆ’1/n
bf (t âˆ’s) Ï†n (s) ds
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
p
V
dt
!1/p
=
ÃƒZ
R
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
Z 1/n
âˆ’1/n
Â³
bf (t) âˆ’bf (t âˆ’s)
Â´
Ï†n (s) ds
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
p
V
dt
!1/p
â‰¤
ÃƒZ
R
ÃƒZ 1/n
âˆ’1/n
Â¯Â¯Â¯
Â¯Â¯Â¯ bf (t) âˆ’bf (t âˆ’s)
Â¯Â¯Â¯
Â¯Â¯Â¯
V Ï†n (s) ds
!p
dt
!1/p
â‰¤
Z 1/n
âˆ’1/n
Ï†n (s)
ÂµZ
R
Â¯Â¯Â¯
Â¯Â¯Â¯ bf (t) âˆ’bf (t âˆ’s)
Â¯Â¯Â¯
Â¯Â¯Â¯
p
V dt
Â¶1/p
ds
â‰¤
Z 1/n
âˆ’1/n
Ï†n (s) Îµds = Îµ
provided n is large enough.
This follows from Lemma 45.4 about continuity of
translation. Since Îµ > 0 is arbitrary, it follows fn â†’bf in Lp (R; V ) . Similarly,

45.1.
AN ASSORTMENT OF IMPORTANT THEOREMS
1247
fn â†’f in L2 (R; H). This follows because p â‰¥2 and the norm in V and norm in
H are related by |x|H â‰¤C ||x||V for some constant, C. Now
bf (t) =
ï£±
ï£´
ï£´
ï£²
ï£´
ï£´
ï£³
Î¨ (t) f (t) if t âˆˆ[0, T] ,
Î¨ (t) f (2T âˆ’t) if t âˆˆ[T, 2T] ,
Î¨ (t) f (âˆ’t) if t âˆˆ[0, T] ,
0 if t /âˆˆ[âˆ’T, 2T] .
An easy modiï¬cation of the argument of Lemma 45.11 yields
bf â€² (t) =
ï£±
ï£´
ï£´
ï£²
ï£´
ï£´
ï£³
Î¨â€² (t) f (t) + Î¨ (y) f â€² (t) if t âˆˆ[0, T] ,
Î¨â€² (t) f (2T âˆ’t) âˆ’Î¨ (t) f â€² (2T âˆ’t) if t âˆˆ[T, 2T] ,
Î¨â€² (t) f (âˆ’t) âˆ’Î¨ (t) f â€² (âˆ’t) if t âˆˆ[âˆ’T, 0] ,
0 if t /âˆˆ[âˆ’T, 2T] .
.
Recall
fn (t)
=
Z 1/n
âˆ’1/n
bf (t âˆ’s) Ï†n (s) ds =
Z
R
bf (t âˆ’s) Ï†n (s) ds
=
Z
R
bf (s) Ï†n (t âˆ’s) ds.
Therefore,
f â€²
n (t)
=
Z
R
bf (s) Ï†â€²
n (t âˆ’s) ds =
Z 2T + 1
n
âˆ’T âˆ’1
n
bf (s) Ï†â€²
n (t âˆ’s) ds
=
Z 2T + 1
n
âˆ’T âˆ’1
n
bf â€² (s) Ï†n (t âˆ’s) ds =
Z
R
bf â€² (s) Ï†n (t âˆ’s) ds
=
Z
R
bf â€² (t âˆ’s) Ï†n (s) ds =
Z 1/n
âˆ’1/n
bf â€² (t âˆ’s) Ï†n (s) ds
and it follows from the ï¬rst line above that f â€²
n is continuous with values in V for all
t âˆˆR. Also note that both f â€²
n and fn equal zero if t /âˆˆ[âˆ’T, 2T] whenever n is large
enough. Exactly similar reasoning to the above shows that f â€²
n â†’bf â€² in Lpâ€² (R; V â€²) .
Now let Ï† âˆˆCâˆž
c (0, T) .
Z
R
|fn (t)|2
H Ï†â€² (t) dt
=
Z
R
(fn (t) , fn (t))H Ï†â€² (t) dt
(45.7)
= âˆ’
Z
R
2 (f â€²
n (t) , fn (t)) Ï† (t) dt
=
âˆ’
Z
R
2 âŸ¨f â€²
n (t) , fn (t)âŸ©Ï† (t) dt
Now
Â¯Â¯Â¯Â¯
Z
R
âŸ¨f â€²
n (t) , fn (t)âŸ©Ï† (t) dt âˆ’
Z
R
âŸ¨f â€² (t) , f (t)âŸ©Ï† (t) dt
Â¯Â¯Â¯Â¯
â‰¤
Z
R
(|âŸ¨f â€²
n (t) âˆ’f â€² (t) , fn (t)âŸ©| + |âŸ¨f â€² (t) , fn (t) âˆ’f (t)âŸ©|) Ï† (t) dt.

1248
INTERPOLATION IN BANACH SPACE
From the ï¬rst part of this proof which showed that fn â†’bf in Lp (R; V ) and f â€²
n â†’bf â€²
in Lpâ€² (R; V â€²) , an application of Holderâ€™s inequality shows the above converges to 0
as n â†’âˆž. Therefore, passing to the limit as n â†’âˆžin the 45.8,
Z
R
Â¯Â¯Â¯ bf (t)
Â¯Â¯Â¯
2
H Ï†â€² (t) dt = âˆ’
Z
R
2
D
bf â€² (t) , bf (t)
E
Ï† (t) dt
which shows t â†’
Â¯Â¯Â¯ bf (t)
Â¯Â¯Â¯
2
H equals a continuous function a.e. and it also has a weak
derivative equal to 2
D
bf â€², bf
E
.
It remains to verify that bf is continuous on [0, T] . Of course bf = f on this
interval. Let N be large enough that fn (âˆ’T) = 0 for all n > N. Then for m, n > N
and t âˆˆ[âˆ’T, 2T]
|fn (t) âˆ’fm (t)|2
H
=
2
Z t
âˆ’T
(f â€²
n (s) âˆ’f â€²
m (s) , fn (s) âˆ’fm (s)) ds
=
2
Z t
âˆ’T
âŸ¨f â€²
n (s) âˆ’f â€²
m (s) , fn (s) âˆ’fm (s)âŸ©V â€²,V ds
â‰¤
2
Z
R
||f â€²
n (s) âˆ’f â€²
m (s)||V â€² ||fn (s) âˆ’fm (s)||V ds
â‰¤
2 ||fn âˆ’fm||Lpâ€²(R;V â€²) ||fn âˆ’fm||Lp(R;V )
which shows from the above that {fn} is uniformly Cauchy on [âˆ’T, 2T] with values
in H. Therefore, there exists g a continuous function deï¬ned on [âˆ’T, 2T] having
values in H such that
lim
nâ†’âˆžmax {|fn (t) âˆ’g (t)|H ; t âˆˆ[âˆ’T, 2T]} = 0.
However, g = bf a.e. because fn converges to f in Lp (0, T; V ) . Therefore, taking a
subsequence, the convergence is a.e. It follows from the fact that V âŠ†H = Hâ€² âŠ†V â€²
and Theorem 45.9 there exists f (0) âˆˆV â€² such that for a.e. t,
f (t) = f (0) +
Z t
0
f â€² (s) ds in V â€²
Now g = f a.e. and g is continuous with values in H hence continuous with values
in V â€²and so
g (t) = f (0) +
Z t
0
f â€² (s) ds in V â€²
for all t. Since g is continuous with values in H it is continuous with values in V â€².
Taking the limit as t â†“0 in the above, g (a) = limtâ†’0+ g (t) = f (0) , showing that
f (0) âˆˆH. Therefore, for a.e. t,
f (t) = f (0) +
Z t
0
f â€² (s) ds in H,
Z t
0
f â€² (s) ds âˆˆH.

45.1.
AN ASSORTMENT OF IMPORTANT THEOREMS
1249
This proves the theorem.
Note that if f âˆˆLp (0, T; V ) and f â€² âˆˆLpâ€² (0, T; V â€²) , then you can consider the
initial value of f and it will be in H. What if you start with something in H? Is
it an initial condition for a function f âˆˆLp (0, T; V ) such that f â€² âˆˆLpâ€² (0, T; V â€²)?
This is worth thinking about. If it is not so, what is the space of initial values?
How can you give this space a norm? What are its properties? It turns out that if
V is a closed subspace of the Sobolev space, W 1,p (â„¦) which contains W 1,p
0
(â„¦) for
p â‰¥2 and H = L2 (â„¦) the answer to the above question is yes. Not surprisingly,
there are many generalizations of the above ideas.
45.1.2
Some Imbedding Theorems
The next theorem is very useful in getting estimates in partial diï¬€erential equations.
It is called Erlingâ€™s lemma.
Deï¬nition 45.14 Let E, W be Banach spaces such that E âŠ†Wand the injection
map from E into W is continuous. The injection map is said to be compact if every
bounded set in E has compact closure in W. In other words, if a sequence is bounded
in E it has a convergent subsequence converging in W. This is also referred to by
saying that bounded sets in E are precompact in W.
Theorem 45.15 Let E âŠ†W âŠ†X where the injection map is continuous from W
to X and compact from E to W. Then for every Îµ > 0 there exists a constant, CÎµ
such that for all u âˆˆE,
||u||W â‰¤Îµ ||u||E + CÎµ ||u||X
Proof: Suppose not. Then there exists Îµ > 0 and for each n âˆˆN, un such that
||un||W > Îµ ||un||E + n ||un||X
Now let vn = un/ ||un||E . Therefore, ||vn||E = 1 and
||vn||W > Îµ + n ||vn||X
It follows there exists a subsequence, still denoted by vn such that vn converges to
v in W. However, the above inequality shows that ||vn||X â†’0. Therefore, v = 0.
But then the above inequality would imply that ||vn|| > Îµ and passing to the limit
yields 0 > Îµ, a contradiction.
Deï¬nition 45.16 Deï¬ne C ([a, b] ; X) the space of functions continuous at every
point of [a, b] having values in X.
You should verify that this is a Banach space with norm
||u||âˆž,X = max
Â©
||unk (t) âˆ’u (t)||X : t âˆˆ[a, b]
Âª
.
The following theorem is an inï¬nite dimensional version of the Ascoli Arzela
theorem.

1250
INTERPOLATION IN BANACH SPACE
Theorem 45.17 Let q > 1 and let E âŠ†W âŠ†X where the injection map is con-
tinuous from W to X and compact from E to W. Let S be deï¬ned by
n
u such that ||u (t)||E + ||uâ€²||Lq([a,b];X) â‰¤R for all t âˆˆ[a, b]
o
.
Then S âŠ†C ([a, b] ; W) and if {un} âŠ†S, there exists a subsequence, {unk} which
converges to a function u âˆˆC ([a, b] ; W) in the following way.
lim
kâ†’âˆž||unk âˆ’u||âˆž,W = 0.
Proof: First consider the issue of S being a subset of C ([a, b] ; W) . By Theorem
45.9 on Page 1243 the following holds in X for u âˆˆS.
u (t) âˆ’u (s) =
Z t
s
uâ€² (r) dr.
Thus S âŠ†C ([a, b] ; X) . Let Îµ > 0 be given. Then by Theorem 45.15 there exists a
constant, CÎµ such that for all u âˆˆW
||u||W â‰¤Îµ
4R ||u||E + CÎµ ||u||X .
Therefore, for all u âˆˆS,
||u (t) âˆ’u (s)||W
â‰¤
Îµ
6R ||u (t) âˆ’u (s)||E + CÎµ ||u (t) âˆ’u (s)||X
â‰¤
Îµ
3 + CÎµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z t
s
uâ€² (r) dr
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
X
â‰¤
Îµ
3 + CÎµ
Z t
s
||uâ€² (r)||X dr â‰¤Îµ
3 + CÎµR |t âˆ’s|1/q . (45.8)
Since Îµ is arbitrary, it follows u âˆˆC ([a, b] ; W).
Let D = Q âˆ©[a, b] so D is a countable dense subset of [a, b]. Let D = {tn}âˆž
n=1.
By compactness of the embedding of E into W, there exists a subsequence u(n,1)
such that as n â†’âˆž, u(n,1) (t1) converges to a point in W. Now take a subsequence
of this, called (n, 2) such that as n â†’âˆž, u(n,2) (t2) converges to a point in W.
It follows that u(n,2) (t1) also converges to a point of W. Continue this way. Now
consider the diagonal sequence, uk â‰¡u(k,k) This sequence is a subsequence of u(n,l)
whenever k > l. Therefore, uk (tj) converges for all tj âˆˆD.
Claim: Let {uk} be as just deï¬ned, converging at every point of [a, b] . Then
{uk} converges at every point of [a, b].
Proof of claim: Let Îµ > 0 be given. Let t âˆˆ[a, b] . Pick tm âˆˆD âˆ©[a, b] such
that in 45.8 CÎµR |t âˆ’tm| < Îµ/3. Then there exists N such that if l, n > N, then
||ul (tm) âˆ’un (tm)||X < Îµ/3. It follows that for l, n > N,
||ul (t) âˆ’un (t)||X
â‰¤
||ul (t) âˆ’ul (tm)|| + ||ul (tm) âˆ’un (tm)||
+ ||un (tm) âˆ’un (t)||
â‰¤
2Îµ
3 + Îµ
3 + 2Îµ
3 < 2Îµ

45.1.
AN ASSORTMENT OF IMPORTANT THEOREMS
1251
Since Îµ was arbitrary, this shows {uk (t)}âˆž
k=1 is a Cauchy sequence. Since W is
complete, this shows this sequence converges.
Now for t âˆˆ[a, b] , it was just shown that if Îµ > 0 there exists Nt such that if
n, m > Nt, then
||un (t) âˆ’um (t)|| < Îµ
3.
Now let s Ì¸= t. Then
||un (s) âˆ’um (s)|| â‰¤||un (s) âˆ’un (t)|| + ||un (t) âˆ’um (t)|| + ||um (t) âˆ’um (s)||
From 45.8
||un (s) âˆ’um (s)|| â‰¤2
Â³Îµ
3 + CÎµR |t âˆ’s|1/qÂ´
+ ||un (t) âˆ’um (t)||
and so it follows that if Î´ is suï¬ƒciently small and s âˆˆB (t, Î´) , then when n, m > Nt
||un (s) âˆ’um (s)|| < Îµ.
Since [a, b] is compact, there are ï¬nitely many of these balls, {B (ti, Î´)}p
i=1 , such
that for s âˆˆB (ti, Î´) and n, m > Nti, the above inequality holds.
Let N >
max
Â©
Nt1, Â· Â· Â·, Ntp
Âª
. Then if m, n > N and s âˆˆ[a, b] is arbitrary, it follows the
above inequality must hold. Therefore, this has shown the following claim.
Claim: Let Îµ > 0 be given. Then there exists N such that if m, n > N, then
||un âˆ’um||âˆž,W < Îµ.
Now let u (t) = limkâ†’âˆžuk (t) .
||u (t) âˆ’u (s)||W â‰¤||u (t) âˆ’un (t)||W + ||un (t) âˆ’un (s)||W + ||un (s) âˆ’u (s)||W
(45.9)
Let N be in the above claim and ï¬x n > N. Then
||u (t) âˆ’un (t)||W = lim
mâ†’âˆž||um (t) âˆ’un (t)||W â‰¤Îµ
and similarly, ||un (s) âˆ’u (s)||W â‰¤Îµ. Then if |t âˆ’s| is small enough, 45.8 shows the
middle term in 45.9 is also smaller than Îµ. Therefore, if |t âˆ’s| is small enough,
||u (t) âˆ’u (s)||W < 3Îµ.
Thus u is continuous. Finally, let N be as in the above claim. Then letting m, n >
N, it follows that for all t âˆˆ[a, b] ,
||um (t) âˆ’un (t)|| < Îµ.
Therefore, letting m â†’âˆž, it follows that for all t âˆˆ[a, b] ,
||u (t) âˆ’un (t)|| â‰¤Îµ.
and so ||u âˆ’un||âˆž,W â‰¤Îµ. Since Îµ is arbitrary, this proves the theorem.
The next theorem is another such imbedding theorem. It is often used in partial
diï¬€erential equations.

1252
INTERPOLATION IN BANACH SPACE
Theorem 45.18 Let E âŠ†W âŠ†X where the injection map is continuous from W
to X and compact from E to W. Let p â‰¥1, let q > 1, and deï¬ne
S â‰¡{u âˆˆLp ([a, b] ; E) : uâ€² âˆˆLq ([a, b] ; X)
and ||u||Lp([a,b];E) + ||uâ€²||Lq([a,b];X) â‰¤R}.
Then S is precompact in Lp ([a, b] ; W). This means that if {un}âˆž
n=1 âŠ†S, it has a
subsequence {unk} which converges in Lp ([a, b] ; W) .
Proof: By Proposition 6.12 on Page 136 it suï¬ƒces to show S has an Î· net in
Lp ([a, b] ; W) for each Î· > 0.
If not, there exists Î· > 0 and a sequence {un} âŠ†S, such that
||un âˆ’um|| â‰¥Î·
(45.10)
for all n Ì¸= m and the norm refers to Lp ([a, b] ; W). Let
a = t0 < t1 < Â· Â· Â· < tn = b, tk âˆ’tkâˆ’1 = T/k.
Now deï¬ne
un (t) â‰¡
k
X
i=1
uniX[tiâˆ’1,ti) (t) , uni â‰¡
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
un (s) ds.
The idea is to show that un approximates un well and then to argue that a subse-
quence of the {un} is a Cauchy sequence yielding a contradiction to 45.10.
Therefore,
un (t) âˆ’un (t) =
k
X
i=1
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
(un (t) âˆ’un (s)) dsX[tiâˆ’1,ti) (t) .
It follows from Jensenâ€™s inequality that
||un (t) âˆ’un (t)||p
W
=
k
X
i=1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
(un (t) âˆ’un (s)) ds
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
p
W
X[tiâˆ’1,ti) (t)
â‰¤
k
X
i=1
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
||un (t) âˆ’un (s)||p
W dsX[tiâˆ’1,ti) (t)
and so
Z b
a
||(un (t) âˆ’un (s))||p
W ds
â‰¤
Z b
a
k
X
i=1
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
||un (t) âˆ’un (s)||p
W dsX[tiâˆ’1,ti) (t) dt
=
k
X
i=1
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
Z ti
tiâˆ’1
||un (t) âˆ’un (s)||p
W dsdt.
(45.11)

45.1.
AN ASSORTMENT OF IMPORTANT THEOREMS
1253
From Theorems 45.15 and 45.9, if Îµ > 0, there exists CÎµ such that
||un (t) âˆ’un (s)||p
W â‰¤Îµ ||un (t) âˆ’un (s)||p
E + CÎµ ||un (t) âˆ’un (s)||p
X
â‰¤
2pâˆ’1Îµ (||un (t)||p + ||un (s)||p) + CÎµ
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z t
s
uâ€²
n (r) dr
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
p
X
â‰¤
2pâˆ’1Îµ (||un (t)||p + ||un (s)||p) + CÎµ
ÂµZ t
s
||uâ€²
n (r)||X dr
Â¶p
â‰¤
2pâˆ’1Îµ (||un (t)||p + ||un (s)||p)
+CÎµ
ÃƒÂµZ t
s
||uâ€²
n (r)||q
X dr
Â¶1/q
|t âˆ’s|1/qâ€²
!p
=
2pâˆ’1Îµ (||un (t)||p + ||un (s)||p) + CÎµRp/q |t âˆ’s|p/qâ€²
.
This is substituted in to 45.11 to obtain
Z b
a
||(un (t) âˆ’un (s))||p
W ds â‰¤
k
X
i=1
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
Z ti
tiâˆ’1
Â¡
2pâˆ’1Îµ (||un (t)||p + ||un (s)||p)
+CÎµRp/q |t âˆ’s|p/qâ€²Â´
dsdt
=
k
X
i=1
2pÎµ
Z ti
tiâˆ’1
||un (t)||p
W + CÎµRp/q
1
ti âˆ’tiâˆ’1
Z ti
tiâˆ’1
Z ti
tiâˆ’1
|t âˆ’s|p/qâ€²
dsdt
=
2pÎµ
Z b
a
||un (t)||p dt + CÎµRp/q
k
X
i=1
1
(ti âˆ’tiâˆ’1) (ti âˆ’tiâˆ’1)p/qâ€² Z ti
tiâˆ’1
Z ti
tiâˆ’1
dsdt
=
2pÎµ
Z b
a
||un (t)||p dt + CÎµRp/q
k
X
i=1
1
(ti âˆ’tiâˆ’1) (ti âˆ’tiâˆ’1)p/qâ€²
(ti âˆ’tiâˆ’1)2
â‰¤
2pÎµRp + CÎµRp/q
k
X
i=1
(ti âˆ’tiâˆ’1)1+p/qâ€²
= 2pÎµRp + CÎµRp/qk
ÂµT
k
Â¶1+p/qâ€²
.
Taking Îµ so small that 2pÎµRp < Î·p/8p and then choosing k suï¬ƒciently large, it
follows
||un âˆ’un||Lp([a,b];W ) < Î·
4.
Now use compactness of the embedding of E into W to obtain a subsequence
such that {un} is Cauchy in Lp (a, b; W) and use this to contradict 45.10. Suppose
un (t) = Pk
i=1 un
i X[tiâˆ’1,ti) (t) . Thus
||un (t)||E =
k
X
i=1
||un
i ||E X[tiâˆ’1,ti) (t)

1254
INTERPOLATION IN BANACH SPACE
and so
R â‰¥
Z b
a
||un (t)||p
E dt = T
k
k
X
i=1
||un
i ||p
E
Therefore, the {un
i } are all bounded.
It follows that after taking subsequences
k times there exists a subsequence {unk} such that unk is a Cauchy sequence in
Lp (a, b; W) . You simply get a subsequence such that unk
i
is a Cauchy sequence in
W for each i. Then denoting this subsequence by n,
||un âˆ’um||Lp(a,b;W )
â‰¤
||un âˆ’un||Lp(a,b;W )
+ ||un âˆ’um||Lp(a,b;W ) + ||um âˆ’um||Lp(a,b;W )
â‰¤
Î·
4 + ||un âˆ’um||Lp(a,b;W ) + Î·
4 < Î·
provided m, n are large enough, contradicting 45.10. This proves the theorem.
45.2
The K Method
This considers the problem of interpolating Banach spaces. The idea is to build
a Banach space between two others in a systematic way, thus constructing a new
Banach space from old ones. The ï¬rst method of deï¬ning intermediate Banach
spaces is called the K method. For more on this topic as well as the other topics on
interpolation see [8] which is what I am following. See also [50]. There is far more
on these subjects in these books than what I am presenting here! My goal is to
present only enough to give an introduction to the topic and to use it in presenting
more theory of Sobolev spaces.
In what follows a topological vector space is a vector space in which vector
addition and scalar multiplication are continuous.
That is Â· : F Ã— X â†’X is
continuous and + : X Ã— X â†’X is also continuous.
A common example of a topological vector space is the dual space, Xâ€² of a
Banach space, X with the weak âˆ—topology. For S âŠ†X a ï¬nite set, deï¬ne
BS (xâˆ—, r) â‰¡{yâˆ—âˆˆXâ€² : |yâˆ—(x) âˆ’xâˆ—(x)| < r for all x âˆˆS}
Then the BS (xâˆ—, r) for S a ï¬nite subset of X and r > 0 form a basis for the topology
on Xâ€² called the weak âˆ—topology. You can check that the vector space operations
are continuous.
Deï¬nition 45.19 Let A0 and A1 be two Banach spaces with norms ||Â·||0 and ||Â·||1
respectively, also written as ||Â·||A0 and ||Â·||A1 and let X be a topological vector space
such that Ai âŠ†X for i = 1, 2, and the identity map from Ai to X is continuous.
For each t > 0, deï¬ne a norm on A0 + A1 by
K (t, a) â‰¡||a||t â‰¡inf {||a0||0 + t ||a1||1 : a0 + a1 = a}.
This is short for K (t, a, A0, A1) . Thus K (t, a, A1, A0) will mean
K (t, a, A1, A0) â‰¡inf
Â©
||a1||A1 + t ||a0||A0 : a0 + a1 = a
Âª

45.2.
THE K METHOD
1255
but the default is K (t, a, A0, A1) if K (t, a) is written.
The following lemma is an interesting exercise.
Lemma 45.20 (A0 + A1, K (t, Â·)) is a Banach space and all the norms, K (t, Â·) are
equivalent.
Proof: First, why is K (t, Â·) a norm? It is clear that K (t, a) â‰¥0 and that if
a = 0 then K (t, a) = 0. Is this the only way this can happen? Suppose K (t, a) = 0.
Then there exist a0n âˆˆA0 and a1n âˆˆA1 such that ||a0n||0 â†’0, ||a1n||1 â†’0, and
a = a0n + a1n. Since the embedding of Ai into X is continuous and since X is a
topological vector space1, it follows
a = a0n + a1n â†’0
and so a = 0.
Let Î± be a nonzero scalar. Then
K (t, Î±a)
=
inf {||a0||0 + t ||a1||1 : a0 + a1 = Î±a}
=
inf
n
|Î±|
Â¯Â¯Â¯
Â¯Â¯Â¯a0
Î±
Â¯Â¯Â¯
Â¯Â¯Â¯
0 + t |Î±|
Â¯Â¯Â¯
Â¯Â¯Â¯a1
Î±
Â¯Â¯Â¯
Â¯Â¯Â¯
1 : a0
Î± + a1
Î± = a
o
=
|Î±| inf
nÂ¯Â¯Â¯
Â¯Â¯Â¯a0
Î±
Â¯Â¯Â¯
Â¯Â¯Â¯
0 + t
Â¯Â¯Â¯
Â¯Â¯Â¯a1
Î±
Â¯Â¯Â¯
Â¯Â¯Â¯
1 : a0
Î± + a1
Î± = a
o
=
|Î±| inf {||a0||0 + t ||a1||1 : a0 + a1 = a} = |Î±| K (t, a) .
It remains to verify the triangle inequality. Let Îµ > 0 be given. Then there exist
a0, a1, b0, and b1 in A0, A1, A0, and A1 respectively such that a0+a1 = a, b0+b1 = b
and
Îµ + K (t, a) + K (t, b)
>
||a0||0 + t ||a1||1 + ||b0||0 + t ||b1||1
â‰¥
||a0 + b0||0 + t ||b1 + a1||1 â‰¥K (t, a + b) .
This has shown that K (t, Â·) is at least a norm. Are all these norms equivalent?
If 0 < s < t then it is clear that K (t, a) â‰¥K (s, a) . To show there exists a constant,
C such that CK (s, a) â‰¥K (t, a) for all a,
t
sK (s, a)
â‰¡
t
s inf {||a0||0 + s ||a1||1 : a0 + a1 = a}
=
inf
Â½ t
s ||a0||0 + s t
s ||a1||1 : a0 + a1 = a
Â¾
=
inf
Â½ t
s ||a0||0 + t ||a1||1 : a0 + a1 = a
Â¾
â‰¥
inf {||a0||0 + t ||a1||1 : a0 + a1 = a} = K (t, a) .
Therefore, the two norms are equivalent as hoped.
1Vector addition is continuous is the property which is used here.

1256
INTERPOLATION IN BANACH SPACE
Finally, it is required to verify that (A0 + A1, K (t, Â·)) is a Banach space. Since
all these norms are equivalent, it suï¬ƒces to only consider the norm, K (1, Â·). Let
{a0n + a1n}âˆž
n=1 be a Cauchy sequence in A0 + A1. Then for m, n large enough,
K (1, a0n + a1n âˆ’(a0m + a1m)) < Îµ.
It follows there exist xn âˆˆA0 and yn âˆˆA1 such that xn + yn = 0 for every n and
whenever m, n are large enough,
||a0n + xn âˆ’(a0m + xm)||0 + ||a1n + yn âˆ’(a1m + ym)||1 < Îµ
Hence {a1n + yn} is a Cauchy sequence in A1 and {a0n + xn} is a Cauchy sequence
in A0. Let
a0n + xn
â†’
a0 âˆˆA0
a1n + yn
â†’
a1 âˆˆA1.
Then
K (1, a0n + a1n âˆ’(a0 + a1))
=
K (1, a0n + xn + a1n + yn âˆ’(a0 + a1))
â‰¤
||a0n + xn âˆ’a0||0 + ||a1n + yn âˆ’a1||1
which converges to 0. Thus A0 + A1 is a Banach space as claimed.
With this, there exists a method for constructing a Banach space which lies
between A0 âˆ©A1 and A0 + A1.
Deï¬nition 45.21 Let 1 â‰¤q < âˆž, 0 < Î¸ < 1.
Deï¬ne (A0, A1)Î¸,q to be those
elements of A0 + A1, a, such that
||a||Î¸,q â‰¡
Â·Z âˆž
0
Â¡
tâˆ’Î¸K (t, a, A0, A1)
Â¢q dt
t
Â¸1/q
< âˆž.
Theorem 45.22 (A0, A1)Î¸,q is a normed linear space satisfying
A0 âˆ©A1 âŠ†(A0, A1)Î¸,q âŠ†A0 + A1,
(45.12)
with the inclusion maps continuous, and
Â³
(A0, A1)Î¸,q , ||Â·||Î¸,q
Â´
is a Banach space.
(45.13)
If a âˆˆA0 âˆ©A1, then
||a||Î¸,q â‰¤
Âµ
1
qÎ¸ (1 âˆ’Î¸)
Â¶1/q
||a||Î¸
1 ||a||1âˆ’Î¸
0
.
(45.14)
If A0 âŠ†A1 with ||Â·||0 â‰¥||Â·||1, then
A0 âˆ©A1 = A0 âŠ†(A0, A1)Î¸,q âŠ†A1 = A0 + A1.

45.2.
THE K METHOD
1257
Also, if bounded sets in A0 have compact closures in A1 then the same is true if A1
is replaced with (A0, A1)Î¸,q. Finally, if
T âˆˆL (A0, B0) , T âˆˆL (A1, B1),
(45.15)
and T is a linear map from A0 + A1 to B0 + B1 where the Ai and Bi are Banach
spaces with the properties described above, then it follows
T âˆˆL
Â³
(A0, A1)Î¸,q , (B0, B1)Î¸,q
Â´
(45.16)
and if M is its norm, and M0 and M1 are the norms of T as a map in L (A0, B0)
and L (A1, B1) respectively, then
M â‰¤M 1âˆ’Î¸
0
M Î¸
1 .
(45.17)
Proof: Suppose ï¬rst a âˆˆA0 âˆ©A1. Then
||a||q
Î¸,q
â‰¡
Z r
0
Â¡
tâˆ’Î¸K (t, a)
Â¢q dt
t +
Z âˆž
r
Â¡
tâˆ’Î¸K (t, a)
Â¢q dt
t
(45.18)
â‰¤
Z r
0
Â¡
tâˆ’Î¸ ||a||1 t
Â¢q dt
t +
Z âˆž
r
Â¡
tâˆ’Î¸ ||a||0
Â¢q dt
t
=
||a||q
1
Z r
0
tq(1âˆ’Î¸)âˆ’1dt + ||a||q
0
Z âˆž
r
tâˆ’1âˆ’Î¸qdt
=
||a||q
1
rqâˆ’qÎ¸
q âˆ’qÎ¸ + ||a||q
0
râˆ’Î¸q
Î¸q
< âˆž
(45.19)
Which shows the ï¬rst inclusion of 45.12. The above holds for all r > 0 and in
particular for the value of r which minimizes the expression on the right in 45.19,
r = ||a||0 / ||a||1. Therefore, doing some calculus,
||a||q
Î¸,q â‰¤
1
Î¸q (1 + Î¸) ||a||q(1âˆ’Î¸)
0
||a||qÎ¸
1
which shows 45.14. This also veriï¬es that the inclusion map is continuous in 45.12.
Now consider the second inclusion in 45.12. The inclusion is obvious because
(A0, A1)Î¸,q is given to be a subset of A0+A1. It remains to verify the inclusion map is
continuous. Therefore, suppose an â†’0 in (A0, A1)Î¸,q. Since an â†’0 in (A0, A1)Î¸,q ,
it follows the function, t â†’tâˆ’Î¸K (t, an) converges to zero in Lq (0, âˆž) with respect
to the measure, dt/t. Therefore, taking another subsequence, still denoted as an, you
can assume this function converges to 0 a.e. Pick such a t where this convergence
takes place. Then K (t, an) â†’0 as n â†’âˆžand so an â†’0 in A0 + A1. this shows
that if an â†’0 in (A0, A1)Î¸,q , then there exists a subsequence {ank} such that
ank â†’0 in A0 + A1. It follows that if an â†’0 in (A0, A1)Î¸,q , then an â†’0 in
A0 + A1. This proves the continuity of the embedding.
What about 45.13? Suppose {an} is a Cauchy sequence in (A0, A1)Î¸,q. Then
there exists a âˆˆA0 + A1 such that an â†’a in A0 + A1 because A0 + A1 is a Banach

1258
INTERPOLATION IN BANACH SPACE
space. Thus, K (t, an) â†’K (t, a) for all t > 0. Therefore, by Fatouâ€™s lemma,
ÂµZ âˆž
0
Â¡
tâˆ’Î¸K (t, a)
Â¢q dt
t
Â¶1/q
â‰¤
lim inf
nâ†’âˆž
ÂµZ âˆž
0
Â¡
tâˆ’Î¸K (t, an)
Â¢q dt
t
Â¶1/q
â‰¤
max
n
||an||Î¸,q : n âˆˆN
o
< âˆž
and so a âˆˆ(A0, A1)Î¸,q. Now
||a âˆ’an||Î¸,q â‰¤lim inf
mâ†’âˆž
ÂµZ âˆž
0
Â¡
tâˆ’Î¸K (t, an âˆ’am)
Â¢q dt
t
Â¶1/q
< Îµ
whenever n is large enough. Thus (A0, A1)Î¸,q is complete as claimed.
Next suppose A0 âŠ†A1 and the inclusion map is compact. In this case, A0âˆ©A1 =
A0 and so it has been shown above that A0 âŠ†(A0, A1)Î¸,q. It remains to show that
every bounded subset, S, contained in A0 has an Î· net in (A0, A1)Î¸,q. Recall the
inequality, 45.14
||a||Î¸,q
â‰¤
Âµ
1
qÎ¸ (1 âˆ’Î¸)
Â¶1/q
||a||Î¸
1 ||a||1âˆ’Î¸
0
=
C
Îµ ||a||Î¸
1 Îµ ||a||1âˆ’Î¸
0
.
Now this implies
||a||Î¸,q â‰¤
ÂµC
Îµ
Â¶1/Î¸
Î¸ ||a||1 + Îµ1/(1âˆ’Î¸) (1 âˆ’Î¸) ||a||0
By compactness of the embedding of A0 into A1, it follows there exists an Îµ(1+Î¸)/Î¸
net for S in A1, {a1, Â· Â· Â·, ap} . Then for a âˆˆS, there exists k such that ||a âˆ’ak||1 <
Îµ(1+Î¸)/Î¸. It follows
||a âˆ’ak||Î¸,q
â‰¤
ÂµC
Îµ
Â¶1/Î¸
Î¸ ||a âˆ’ak||1 + Îµ1/(1âˆ’Î¸) (1 âˆ’Î¸) ||a âˆ’ak||0
â‰¤
ÂµC
Îµ
Â¶1/Î¸
Î¸Îµ(1+Î¸)/Î¸ + Îµ1/(1âˆ’Î¸) (1 âˆ’Î¸) 2M
=
C1/Î¸Î¸Îµ + Îµ1/(1âˆ’Î¸) (1 âˆ’Î¸) 2M
where M is large enough that ||a||0 â‰¤M for all a âˆˆS. Since Îµ is arbitrary, this
shows the existence of a Î· net and proves the compactness of the embedding into
(A0, A1)Î¸,q .
It remains to verify the assertions 45.15-45.17. Let T âˆˆL (A0, B0) , T âˆˆL (A1, B1)
with T a linear map from A0 + A1 to B0 + B1. Let a âˆˆ(A0, A1)Î¸,q âŠ†A0 + A1 and
consider Ta âˆˆB0 + B1.
Denote by K (t, Â·) the norm described above for both
A0 + A1 and B0 + B1 since this will cause no confusion. Then
||Ta||Î¸,q â‰¡
ÂµZ âˆž
0
Â¡
tâˆ’Î¸K (t, Ta)
Â¢q dt
t
Â¶1/q
.
(45.20)

45.3.
THE J METHOD
1259
Now let a0 + a1 = a and so Ta0 + Ta1 = Ta
K (t, Ta)
â‰¤
||Ta0||0 + t ||Ta1||1 â‰¤M0 ||a0||0 + M1t ||a1||1
â‰¤
M0
Âµ
||a0||0 + t
ÂµM1
M0
Â¶
||a1||1
Â¶
and so, taking inf for all a0 + a1 = a, yields
K (t, Ta) â‰¤M0K
Âµ
t
ÂµM1
M0
Â¶
, a
Â¶
It follows from 45.20 that
||Ta||Î¸,q
â‰¡
ÂµZ âˆž
0
Â¡
tâˆ’Î¸K (t, Ta)
Â¢q dt
t
Â¶1/q
â‰¤
ÂµZ âˆž
0
Âµ
tâˆ’Î¸M0K
Âµ
t
ÂµM1
M0
Â¶
, a
Â¶Â¶q dt
t
Â¶1/q
=
M0
ÂµZ âˆž
0
Âµ
tâˆ’Î¸K
Âµ
t
ÂµM1
M0
Â¶
, a
Â¶Â¶q dt
t
Â¶1/q
=
M0
ÃƒZ âˆž
0
ÃƒÂµM0
M1
s
Â¶âˆ’Î¸
K (s, a)
!q
ds
s
!1/q
=
M Î¸
1 M (1âˆ’Î¸)
0
ÂµZ âˆž
0
Â¡
sâˆ’Î¸K (s, a)
Â¢q ds
s
Â¶1/q
= M Î¸
1 M (1âˆ’Î¸)
0
||a||Î¸,q .
This shows T âˆˆL
Â³
(A0, A1)Î¸,q , (B0, B1)Î¸,q
Â´
and if M is the norm of T, M â‰¤
M 1âˆ’Î¸
0
M Î¸
1 as claimed. This proves the theorem.
45.3
The J Method
There is another method known as the J method.
Deï¬nition 45.23 For A0 and A1 Banach spaces as described above, and a âˆˆA0 âˆ©
A1,
J (t, a) â‰¡max
Â¡
||a||A0 , t ||a||A1
Â¢
.
(45.21)
this is short for J (t, a, A0, A1). Thus
J (t, a, A1, A0) â‰¡max
Â¡
||a||A1 , t ||a||A0
Â¢
but unless indicated otherwise, A0 will come ï¬rst. Now for Î¸ âˆˆ(0, 1) and q â‰¥1,
deï¬ne a space, (A0, A1)Î¸,q,J as follows. The space, (A0, A1)Î¸,q,J will consist of those
elements, a, of A0 + A1 which can be written in the form
a =
Z âˆž
0
u (t) dt
t â‰¡lim
Îµâ†’0+
Z 1
Îµ
u (t) dt
t + lim
râ†’âˆž
Z r
1
u (t) dt
t
(45.22)

1260
INTERPOLATION IN BANACH SPACE
the limits taking place in A0 + A1 with the norm
K (1, a) â‰¡
inf
a=a0+a1
Â¡
||a0||A0 + ||a1||A1
Â¢
,
where u (t) is strongly measurable with values in A0 âˆ©A1 and bounded on every
compact subset of (0, âˆž) such that
ÂµZ âˆž
0
Â¡
tâˆ’Î¸J (t, u (t) , A0, A1)
Â¢q dt
t
Â¶1/q
< âˆž.
(45.23)
For such a âˆˆA0 + A1, deï¬ne
||a||Î¸,q,J â‰¡inf
u
(ÂµZ âˆž
0
Â¡
tâˆ’Î¸J (t, u (t) , A0, A1)
Â¢q dt
t
Â¶1/q)
(45.24)
where the inï¬mum is taken over all u satisfying 45.22 and 45.23.
Note that a norm on A0 Ã— A1 would be
||(a0, a1)|| â‰¡max
Â¡
||a0||A0 , t ||a1||A1
Â¢
and so J (t, Â·) is the restriction of this norm to the subspace of A0 Ã— A1 deï¬ned
by {(a, a) : a âˆˆA0 âˆ©A1}. Also for each t > 0 J (t, Â·) is a norm on A0 âˆ©A1 and
furthermore, any two of these norms are equivalent. In fact, it is easy to see that
for 0 < t < s, t
sJ (s, a) â‰¤J (t, a) â‰¤J (s, a) .
The following lemma is signiï¬cant and follows immediately from the above def-
inition.
Lemma 45.24 Suppose a âˆˆ(A0, A1)Î¸,q,J and a =
R âˆž
0
u (t) dt
t where u is described
above. Then letting r > 1,
ur (t) â‰¡
Â½
u (t) if t âˆˆ
Â¡ 1
r, r
Â¢
0 otherwise
.
it follows that
Z âˆž
0
ur (t) dt
t âˆˆA0 âˆ©A1.
Proof: The integral equals
R r
1/r u (t) dt
t .
R r
1/r
1
t dt = 2 ln r < âˆž. Now ur is mea-
surable in A0 âˆ©A1 and bounded. Therefore, there exists a sequence of measurable
simple functions, {sn} having values in A0 âˆ©A1 which converges pointwise and uni-
formly to ur. It can also be assumed J (r, sn (t)) â‰¤J (r, ur (t)) for all t âˆˆ[1/r, r].
Therefore,
lim
n,mâ†’âˆž
Z r
1/r
J (r, sm âˆ’sn) dt
t = 0.
It follows from the deï¬nition of the Bochner integral that
lim
nâ†’âˆž
Z r
1/r
sn
dt
t =
Z r
1/r
ur
dt
t âˆˆA0 âˆ©A1.

45.3.
THE J METHOD
1261
This proves the lemma.
The remarkable thing is that the two spaces, (A0, A1)Î¸,q and (A0, A1)Î¸,q,J co-
incide and have equivalent norms. The following important lemma, called the fun-
damental lemma of interpolation theory in [8] is used to prove this. This lemma is
really incredible.
Lemma 45.25 Suppose for a âˆˆA0+A1, limtâ†’0+ K (t, a) = 0 and limtâ†’âˆž
K(t,a)
t
=
0. Then for any Îµ > 0, there is a representation,
a =
âˆž
X
i=âˆ’âˆž
ui =
lim
n,mâ†’âˆž
n
X
i=âˆ’m
ui, ui âˆˆA0 âˆ©A1,
(45.25)
the convergences taking place in A0 + A1, such that
J
Â¡
2i, ui
Â¢
â‰¤3 (1 + Îµ) K
Â¡
2i, a
Â¢
.
(45.26)
Proof: For each i, there exist a0,i âˆˆA0 and a1,i âˆˆA1 such that
a = a0,i + a1,i,
and
(1 + Îµ) K
Â¡
2i, a
Â¢
â‰¥||a0,i||A0 + 2i ||a1,i||A1 .
(45.27)
This follows directly from the deï¬nition of K (t, a) . From the assumed limit condi-
tions on K (t, a) ,
lim
iâ†’âˆž||a1,i||A1 = 0,
lim
iâ†’âˆ’âˆž||a0,i||A0 = 0.
(45.28)
Then let ui â‰¡a0,i âˆ’a0,iâˆ’1 = a1,iâˆ’1 âˆ’a1,i. The reason these are equal is a =
a0,i + a1,i = a0,iâˆ’1 + a1,iâˆ’1. Then
n
X
i=âˆ’m
ui = a0,n âˆ’a0,âˆ’(m+1) = a1,âˆ’(m+1) âˆ’a1,n.
It follows a âˆ’Pn
i=âˆ’m ui = a âˆ’
Â¡
a0,n âˆ’a0,âˆ’(m+1)
Â¢
= a0,âˆ’(m+1) + a1,n, and both
terms converge to zero as m and n converge to âˆžby 45.28. Therefore,
K
Ãƒ
1, a âˆ’
n
X
i=âˆ’m
ui
!
â‰¤
Â¯Â¯Â¯Â¯a0,âˆ’(m+1)
Â¯Â¯Â¯Â¯ + ||a1,n||
and so this shows a = Pâˆž
i=âˆ’âˆžui which is one of the claims of the lemma. Also
J
Â¡
2i, ui
Â¢
â‰¡max
Â¡
||ui||A0 , 2i ||ui||A1
Â¢
â‰¤||ui||A0 + 2i ||ui||A1
â‰¤||a0,i||A0 + 2i ||a1,i||A1 +
â‰¤2
Â³
||a0,iâˆ’1||A0+2iâˆ’1||a1,iâˆ’1||A1
Â´
z
}|
{
||a0,iâˆ’1||A0 + 2i ||a1,iâˆ’1||A1
â‰¤(1 + Îµ) K
Â¡
2i, a
Â¢
+ 2 (1 + Îµ) K
Â¡
2iâˆ’1, a
Â¢
â‰¤3 (1 + Îµ) K
Â¡
2i, a
Â¢
because t â†’K (t, a) is nondecreasing. This proves the lemma.

1262
INTERPOLATION IN BANACH SPACE
Lemma 45.26 If a âˆˆA0 âˆ©A1, then K (t, a) â‰¤min
Â¡
1, t
s
Â¢
J (s, a) .
Proof: If s â‰¥t, then min
Â¡
1, t
s
Â¢
= t
s and so
min
Âµ
1, t
s
Â¶
J (s, a)
=
t
s max
Â¡
||a||A0 , s ||a||A1
Â¢
â‰¥
Âµ t
s
Â¶
s ||a||A1
=
t ||a||A1 â‰¥K (t, a) .
Now in case s < t, then min
Â¡
1, t
s
Â¢
= 1 and so
min
Âµ
1, t
s
Â¶
J (s, a)
=
max
Â¡
||a||A0 , s ||a||A1
Â¢
â‰¥||a||A0
â‰¥
K (t, a) .
This proves the lemma.
Theorem 45.27 Let A0, A1, K and J be as described above. Then for all q â‰¥1
and Î¸ âˆˆ(0, 1) ,
(A0, A1)Î¸,q = (A0, A1)Î¸,q,J
and furthermore, the norms are equivalent.
Proof: Begin with a âˆˆ(A0, A1)Î¸,q . Thus
||a||q
Î¸,q =
Z âˆž
0
Â¡
tâˆ’Î¸K (t, a)
Â¢q dt
t < âˆž
(45.29)
and it is necessary to produce u (t) as described above,
a =
Z âˆž
0
u (t) dt
t where
Z âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢q dt
t < âˆž.
From 45.29, limtâ†’0+ K (t, a) = 0 since t â†’K (t, a) is nondecreasing and so if its
limit is positive, the integrand would have a non integrable singularity like tâˆ’Î¸qâˆ’1.
Next consider what happens to K(t,a)
t
as t â†’âˆž.
Claim: t â†’K(t,a)
t
is decreasing.
Proof of the claim: Choose a0 âˆˆA0 and a1 âˆˆA1 such that a0 + a1 = a and
K (t, a) + Îµt > ||a0||A0 + t ||a1||A1
let s > t. Then
K (t, a) + tÎµ
t
â‰¥||a0||A0 + t ||a1||A1
t
â‰¥||a0||A0 + s ||a1||A1
s
â‰¥K (s, a)
s
.
Since Îµ is arbitrary, this proves the claim.

45.3.
THE J METHOD
1263
Let r â‰¡limtâ†’âˆž
K(t,a)
t
. Is r = 0? Suppose to the contrary that r > 0. Then the
integrand of 45.29, is at least as large as
tâˆ’Î¸qK (t, a)qâˆ’1 K (t, a)
t
â‰¥tâˆ’Î¸qK (t, a)qâˆ’1 r
â‰¥tâˆ’Î¸q (tr)qâˆ’1 r â‰¥rqtq(1âˆ’Î¸)âˆ’1
whose integral is inï¬nite. Therefore, r = 0.
Lemma 45.25, implies there exist ui âˆˆA0 âˆ©A1 such that a = Pâˆž
i=âˆ’âˆžui, the
convergence taking place in A0 + A1with the inequality of that Lemma holding,
J
Â¡
2i, ui
Â¢
â‰¤3 (1 + Îµ) K
Â¡
2i, a
Â¢
.
For i an integer and t âˆˆ[2iâˆ’1, 2i), let
u (t) â‰¡ui/ ln 2.
Then
a =
âˆž
X
i=âˆ’âˆž
ui =
Z âˆž
0
u (t) dt
t .
(45.30)
Now
||a||q
Î¸,q,J
â‰¤
Z âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢q dt
t
=
âˆž
X
i=âˆ’âˆž
Z 2i
2iâˆ’1
Â³
tâˆ’Î¸J
Â³
t, ui
ln 2
Â´Â´q dt
t
â‰¤
Âµ 1
ln 2
Â¶q
âˆž
X
i=âˆ’âˆž
Z 2i
2iâˆ’1
Â¡
tâˆ’Î¸J
Â¡
2i, ui
Â¢Â¢q dt
t
â‰¤
Âµ 1
ln 2
Â¶q
âˆž
X
i=âˆ’âˆž
Z 2i
2iâˆ’1
Â¡
tâˆ’Î¸3 (1 + Îµ) K
Â¡
2i, a
Â¢Â¢q dt
t
Using the above claim,
K(2i,a)
2i
â‰¤
K(2iâˆ’1,a)
2iâˆ’1
and so K
Â¡
2i, a
Â¢
â‰¤2K
Â¡
2iâˆ’1, a
Â¢
. There-
fore, the above is no larger than
â‰¤
2
Âµ 1
ln 2
Â¶q
âˆž
X
i=âˆ’âˆž
Z 2i
2iâˆ’1
Â¡
tâˆ’Î¸3 (1 + Îµ) K
Â¡
2iâˆ’1, a
Â¢Â¢q dt
t
â‰¤
2
Âµ 1
ln 2
Â¶q
âˆž
X
i=âˆ’âˆž
Z 2i
2iâˆ’1
Â¡
tâˆ’Î¸3 (1 + Îµ) K (t, a)
Â¢q dt
t
=
2
Âµ3 (1 + Îµ)
ln 2
Â¶q Z âˆž
0
Â¡
tâˆ’Î¸K (t, a)
Â¢q dt
t â‰¡2
Âµ3 (1 + Îµ)
ln 2
Â¶q
||a||q
Î¸,q .(45.31)

1264
INTERPOLATION IN BANACH SPACE
This has shown that if a âˆˆ(A0, A1)Î¸,q , then by 45.30 and 45.31, a âˆˆ(A0, A1)Î¸,q,J
and
||a||q
Î¸,q,J â‰¤2
Âµ3 (1 + Îµ)
ln 2
Â¶q
||a||q
Î¸,q .
(45.32)
It remains to prove the other inclusion and norm inequality, both of which are
much easier to obtain. Thus, let a âˆˆ(A0, A1)Î¸,q,J with
a =
Z âˆž
0
u (t) dt
t
(45.33)
where u is a strongly measurable function having values in A0 âˆ©A1 and for which
Z âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢q dt < âˆž.
(45.34)
K (t, a) = K
Âµ
t,
Z âˆž
0
u (s) ds
s
Â¶
â‰¤
Z âˆž
0
K (t, u (s)) ds
s .
Now by 45.26, this is dominated by an expression of the form
â‰¤
Z âˆž
0
min
Âµ
1, t
s
Â¶
J (s, u (s)) ds
s =
Z âˆž
0
min
Âµ
1, 1
s
Â¶
J (ts, u (ts)) ds
s
where the equation follows from a change of variable. From Minkowskiâ€™s inequality,
||a||Î¸,q
â‰¡
ÂµZ âˆž
0
Â¡
tâˆ’Î¸K (t, a)
Â¢q dt
t
Â¶1/q
â‰¤
ÂµZ âˆž
0
Âµ
tâˆ’Î¸
Z âˆž
0
min
Âµ
1, 1
s
Â¶
J (ts, u (ts)) ds
s
Â¶q dt
t
Â¶1/q
â‰¤
Z âˆž
0
ÂµZ âˆž
0
Âµ
tâˆ’Î¸ min
Âµ
1, 1
s
Â¶
J (ts, u (ts))
Â¶q dt
t
Â¶1/q ds
s .
Now change the variable in the inside integral to obtain, letting t = Ï„s,
â‰¤
Z âˆž
0
min
Âµ
1, 1
s
Â¶ ÂµZ âˆž
0
Â¡
tâˆ’Î¸J (ts, u (ts))
Â¢q dt
t
Â¶1/q ds
s
=
Z âˆž
0
min
Âµ
1, 1
s
Â¶
sÎ¸ ds
s
ÂµZ âˆž
0
Â¡
Ï„ âˆ’Î¸J (Ï„, u (Ï„))
Â¢q dÏ„
Ï„
Â¶1/q
=
Âµ
1
(1 âˆ’Î¸) Î¸
Â¶ ÂµZ âˆž
0
Â¡
Ï„ âˆ’Î¸J (Ï„, u (Ï„))
Â¢q dÏ„
Ï„
Â¶1/q
.
This has shown that
||a||Î¸,q â‰¤
Âµ
1
(1 âˆ’Î¸) Î¸
Â¶ ÂµZ âˆž
0
Â¡
Ï„ âˆ’Î¸J (Ï„, u (Ï„))
Â¢q dÏ„
Ï„
Â¶1/q
< âˆž

45.4.
DUALITY AND INTERPOLATION
1265
for all u satisfying 45.33 and 45.34. Therefore, taking the inï¬mum it follows a âˆˆ
(A0, A1)Î¸,q and
||a||Î¸,q â‰¤
Âµ
1
(1 âˆ’Î¸) Î¸
Â¶
||a||Î¸,q,J .
This proves the theorem.
45.4
Duality And Interpolation
In this section it will be assumed that A0 âˆ©A1 is dense in Ai for i = 0, 1. This is
done so that Aâ€²
i âŠ†(A0 âˆ©A1)â€² and the inclusion map is continuous. Thus it makes
sense to add something in Aâ€²
0 to something in Aâ€²
1.
What is the dual space of (A0, A1)Î¸,q? The answer is based on the following
lemma, [8]. Remember that
J (t, a) = max
Â¡
||a||A0 , t ||a||A1
Â¢
and this is a norm on A0 âˆ©A1 and
K (t, a) = inf
Â©
||a0||A0 + t ||a1||A1 : a = a0 + a1
Âª
.
As mentioned above, Aâ€²
0 + Aâ€²
1 âŠ†(A0 âˆ©A1)â€². In fact these two are equal. This is
the ï¬rst part of the following lemma.
Lemma 45.28 Suppose A0 âˆ©A1 is dense in Ai, i = 0, 1. Then
Aâ€²
0 + Aâ€²
1 = (A0 âˆ©A1)â€² ,
(45.35)
and for aâ€² âˆˆAâ€²
0 + Aâ€²
1 = (A0 âˆ©A1)â€² ,
K (t, aâ€²) =
sup
aâˆˆA0âˆ©A1
|aâ€² (a)|
J (tâˆ’1, a).
(45.36)
Thus K (t, Â·) is an equivalent norm to the usual operator norm on (A0 âˆ©A1)â€² taken
with respect to J
Â¡
tâˆ’1, Â·
Â¢
. If, in addition to this, Ai is reï¬‚exive, then for aâ€² âˆˆAâ€²
0âˆ©Aâ€²
1,
and a âˆˆA0 âˆ©A1,
J (t, aâ€²) K
Â¡
tâˆ’1, a
Â¢
â‰¥|aâ€² (a)| .
(45.37)
Proof: First consider the claim that Aâ€²
0 + Aâ€²
1 = (A0 âˆ©A1)â€². As noted above, âŠ†
is clear. Deï¬ne a norm on A0 Ã— A1 as follows.
||(a0, a1)||A0Ã—A1 â‰¡max
Â¡
||a0||A0 , tâˆ’1 ||a1||A1
Â¢
.
(45.38)
Let aâ€² âˆˆ(A0 âˆ©A1)â€². Let
E â‰¡{(a, a) : a âˆˆA0 âˆ©A1}

1266
INTERPOLATION IN BANACH SPACE
with the norm J
Â¡
tâˆ’1, a
Â¢
â‰¡max
Â¡
||a||A0 , tâˆ’1 ||a||A1
Â¢
. Now deï¬ne Î» on E, the sub-
space of A0 Ã— A1 by
Î» ((a, a)) â‰¡aâ€² (a) .
Thus Î» is a continuous linear map on E and in fact,
|Î» ((a, a))| = |aâ€² (a)| â‰¤||aâ€²|| J
Â¡
tâˆ’1, a
Â¢
.
By the Hahn Banach theorem there exists an extension of Î» to all of A0 Ã— A1. This
extension is of the form (aâ€²
0, aâ€²
1) âˆˆAâ€²
0 Ã— Aâ€²
1. Thus
(aâ€²
0, aâ€²
1) ((a, a)) = aâ€²
0 (a) + aâ€²
1 (a) = aâ€² (a)
and therefore, aâ€²
0 + aâ€²
1 = aâ€² provided aâ€²
0 + aâ€²
1 is continuous. But
|(aâ€²
0 + aâ€²
1) (a)|
=
|aâ€²
0 (a) + aâ€²
1 (a)| â‰¤|aâ€²
0 (a)| + |aâ€²
1 (a)|
â‰¤
||aâ€²
0|| ||a||A0 + ||aâ€²
1|| ||a||A1
â‰¤
||aâ€²
0|| ||a||A0 + t ||aâ€²
1|| tâˆ’1 ||a||A1
â‰¤
(||aâ€²
0|| + t ||aâ€²
1||) J
Â¡
tâˆ’1, a
Â¢
which shows that aâ€²
0 + aâ€²
1 is continuous and in fact
||aâ€²
0 + aâ€²
1||(A0âˆ©A1)â€² â‰¤(||aâ€²
0|| + t ||aâ€²
1||) .
This proves the ï¬rst part of the lemma.
Claim: With this deï¬nition of the norm in 45.38, the operator norm of (aâ€²
0, aâ€²
1) âˆˆ
(A0 Ã— A1)â€² = Aâ€²
0 Ã— Aâ€²
1 is
||(aâ€²
0, aâ€²
1)||(A0Ã—A1)â€² = ||aâ€²
0||Aâ€²
0 + t ||aâ€²
1||Aâ€²
1 .
(45.39)
Proof of the claim: |(aâ€²
0, aâ€²
1) (a0, a1)| â‰¤||aâ€²
0|| ||a0|| + ||aâ€²
1|| ||a1|| . Now suppose
that ||a0|| = max
Â¡
||a0|| , tâˆ’1 ||a1||
Â¢
. Then this is no larger than
(||aâ€²
0|| + t ||aâ€²
1||) ||a0|| = (||aâ€²
0|| + t ||aâ€²
1||) max
Â¡
||a0|| , tâˆ’1 ||a1||
Â¢
.
The other case is that tâˆ’1 ||a1|| = max
Â¡
||a0|| , tâˆ’1 ||a1||
Â¢
. In this case,
|(aâ€²
0, aâ€²
1) (a0, a1)|
â‰¤
||aâ€²
0|| ||a0|| + ||aâ€²
1|| ||a1||
â‰¤
||aâ€²
0|| tâˆ’1 ||a1|| + ||aâ€²
1|| ||a1||
=
(||aâ€²
0|| + t ||aâ€²
1||) tâˆ’1 ||a1||
=
(||aâ€²
0|| + t ||aâ€²
1||) max
Â¡
||a0|| , tâˆ’1 ||a1||
Â¢
.
This shows ||(aâ€²
0, aâ€²
1)||(A0Ã—A1)â€² â‰¤(||aâ€²
0|| + t ||aâ€²
1||) . Is equality achieved?
Let a0n
and a1n be points of A0 and A1 respectively such that ||a0n|| , ||a1n|| â‰¤1 and
limnâ†’âˆžaâ€²
i (ain) = ||aâ€²
i|| . Then
(aâ€²
0, aâ€²
1) (a0n, ta1n) â†’||aâ€²
0|| + t ||aâ€²
1||

45.4.
DUALITY AND INTERPOLATION
1267
and also, ||(a0n, ta1n)||A0Ã—A1 = max
Â¡
||a0n|| , tâˆ’1t ||a1n||A1
Â¢
â‰¤1. Therefore, equality
is indeed achieved and this proves the claim.
Consider 45.36. Take aâ€² âˆˆAâ€²
0 + Aâ€²
1 = (A0 âˆ©A1)â€² and let
E â‰¡{(a, a) âˆˆA0 Ã— A1 : a âˆˆA0 âˆ©A1} .
Now deï¬ne a linear map, Î» on E as before.
Î» ((a, a)) â‰¡aâ€² (a) .
If aâ€² = eaâ€²
0 + eaâ€²
1,
|Î» ((a, a))|
â‰¤
||eaâ€²
0||Aâ€²
0 ||a||A0 + ||eaâ€²
1||Aâ€²
1 ||a||A1
=
||eaâ€²
0||Aâ€²
0 ||a||A0 + t ||eaâ€²
1||Aâ€²
1 tâˆ’1 ||a||A1
â‰¤
(||eaâ€²
0|| + t ||eaâ€²
1||) ||(a, a)||A0Ã—A1
so Î» is continuous on the subspace, E of A0 Ã— A1 and
||Î»||Eâ€² â‰¤||eaâ€²
0|| + t ||eaâ€²
1|| .
(45.40)
By the Hahn Banach theorem, there exists an extension of Î» deï¬ned on all of A0Ã—A1
with the same norm. Thus, from 45.39, there exists (aâ€²
0, aâ€²
1) âˆˆ(A0 Ã— A1)â€² which is
an extension of Î» such that
||(aâ€²
0, aâ€²
1)||(A0Ã—A1)â€² = ||aâ€²
0||Aâ€²
0 + t ||aâ€²
1||Aâ€²
1 = ||Î»||Eâ€²
and for all a âˆˆA0 âˆ©A1,
aâ€²
0 (a) + aâ€²
1 (a) = Î» ((a, a)) = aâ€² (a) .
It follows that aâ€²
0 + aâ€²
1 = aâ€² in (A0 âˆ©A1)â€². Therefore, from 45.40,
||Î»||Eâ€²
â‰¤
inf
Â©
||eaâ€²
0||A0 + t ||eaâ€²
1||A1 : aâ€² = eaâ€²
0 + eaâ€²
1
Âª
â‰¡K (t, aâ€²)
(45.41)
â‰¤
||aâ€²
0||Aâ€²
0 + t ||aâ€²
1||Aâ€²
1 = ||Î»||Eâ€² â‰¡
sup
aâˆˆA0âˆ©A1
|aâ€² (a)|
J (tâˆ’1, a)
(45.42)
because on E, J
Â¡
tâˆ’1, a
Â¢
= ||(a, a)||A0Ã—A1 which proves 45.36.
To obtain 45.37 in the case that Ai is reï¬‚exive, apply 45.36 to the case where
Aâ€²â€²
i plays the role of Ai in 45.36. Thus, for aâ€²â€² âˆˆAâ€²â€²
0 + Aâ€²â€²
1,
K (t, aâ€²â€²) =
sup
aâ€²âˆˆAâ€²
0âˆ©Aâ€²
1
|aâ€²â€² (aâ€²)|
J (tâˆ’1, aâ€²).
Now aâ€²â€² = aâ€²â€²
1 + aâ€²â€²
0 = Î·1a1 + Î·0a0 where Î·i is the map from Ai to Aâ€²â€²
i which is onto
and preserves norms, given by Î·a (aâ€²) â‰¡aâ€² (a) . Therefore, letting a1 + a0 = a
K (t, a)
=
K (t, aâ€²â€²) =
sup
aâ€²âˆˆAâ€²
0âˆ©Aâ€²
1
|aâ€²â€² (aâ€²)|
J (tâˆ’1, aâ€²)
=
sup
aâ€²âˆˆAâ€²
0âˆ©Aâ€²
1
|(Î·1a1 + Î·0a0) (aâ€²)|
J (tâˆ’1, aâ€²)
=
sup
aâ€²âˆˆAâ€²
0âˆ©Aâ€²
1
|(aâ€² (a1 + a0))|
J (tâˆ’1, aâ€²)

1268
INTERPOLATION IN BANACH SPACE
and so
K (t, a) =
sup
aâ€²âˆˆAâ€²
0âˆ©Aâ€²
1
|aâ€² (a)|
J (tâˆ’1, aâ€²)
Changing t â†’tâˆ’1,
K
Â¡
tâˆ’1, a
Â¢
J (t, aâ€²) â‰¥|aâ€² (a)| .
which proves the lemma.
Consider (A0, A1)â€²
Î¸,q .
Deï¬nition 45.29 Let q â‰¥1. Then Î»Î¸,q will denote the sequences, {Î±i}âˆž
i=âˆ’âˆžsuch
that
âˆž
X
i=âˆ’âˆž
Â¡
|Î±i| 2âˆ’iÎ¸Â¢q < âˆž.
For Î± âˆˆÎ»Î¸,q,
||Î±||Î»Î¸,q â‰¡
Ãƒ
âˆž
X
i=âˆ’âˆž
Â¡
|Î±i| 2âˆ’iÎ¸Â¢q
!1/q
.
Thus Î± âˆˆÎ»Î¸,q means
Â©
Î±i2âˆ’iÎ¸Âª
âˆˆlq.
Lemma 45.30 Let f (t) â‰¥0, and let f (t) = Î±i for t âˆˆ[2i, 2i+1) where Î± âˆˆÎ»Î¸,q.
Then there exists a constant, C, such that
Â¯Â¯Â¯Â¯tâˆ’Î¸f
Â¯Â¯Â¯Â¯
Lq(0,âˆž; dt
t ) â‰¤C ||Î±||Î»Î¸,q .
(45.43)
Also, if whenever Î± âˆˆÎ»Î¸,q, and Î±i â‰¥0 for all i,
X
i
f
Â¡
2iÂ¢
2âˆ’iÎ±i â‰¤C ||Î±||Î»Î¸,q ,
(45.44)
then
Â¯Â¯Â¯
Â¯Â¯Â¯
Â©
f
Â¡
2iÂ¢Âªâˆž
i=âˆ’âˆž
Â¯Â¯Â¯
Â¯Â¯Â¯
Î»1âˆ’Î¸,qâ€² â‰¤C.
(45.45)
Proof: Consider 45.43.
Z âˆž
0
Â¡
tâˆ’Î¸f (t)
Â¢q dt
t =
X
i
Z 2i+1
2i
tâˆ’Î¸qÎ±q
i
dt
t
â‰¤
X
i
Z 2i+1
2i
Â¡
2âˆ’iÎ¸Î±i
Â¢q dt
t = ln 2
X
i
Â¡
2âˆ’iÎ¸Î±i
Â¢q = ln 2 ||Î±||q
Î»Î¸,q .
45.45 is next. By 45.44, whenever Î± âˆˆÎ»Î¸,q,
Â¯Â¯Â¯Â¯Â¯
X
i
Â³
f
Â¡
2iÂ¢
2âˆ’(1âˆ’Î¸)iÂ´
2âˆ’Î¸iÎ±i
Â¯Â¯Â¯Â¯Â¯ â‰¤C
Â¯Â¯Â¯Â¯Â©
2âˆ’Î¸i |Î±i|
ÂªÂ¯Â¯Â¯Â¯
lq .

45.4.
DUALITY AND INTERPOLATION
1269
It follows from the Riesz representation theorem that
Â©
f
Â¡
2iÂ¢
2âˆ’(1âˆ’Î¸)iÂª
is in lqâ€² and
Â¯Â¯Â¯
Â¯Â¯Â¯
n
f
Â¡
2iÂ¢
2âˆ’(1âˆ’Î¸)ioÂ¯Â¯Â¯
Â¯Â¯Â¯
lqâ€² =
Â¯Â¯Â¯Â¯Â©
f
Â¡
2iÂ¢ÂªÂ¯Â¯Â¯Â¯
Î»1âˆ’Î¸,qâ€² â‰¤C.
This proves the lemma.
The dual space of (A0, A1)Î¸,q,J is discussed next.
Lemma 45.31 Let Î¸ âˆˆ(0, 1) and let q â‰¥1. Then,
(A0, A1)â€²
Î¸,q,J âŠ†(Aâ€²
1, Aâ€²
0)1âˆ’Î¸,qâ€²
and the inclusion map is continuous.
Proof: Let aâ€² âˆˆ(A0, A1)â€²
Î¸,q,J . Now
A0 âˆ©A1 âŠ†(A0, A1)Î¸,q,J
and if
a âˆˆ(A0, A1)Î¸,q,J ,
then a has a representation of the form
a =
Z âˆž
0
u (t) dt
t
where
Z âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢q dt
t < âˆž
where
J (t, u (t)) = max
Â¡
||u (t)||A0 , t ||u (t)||A1
Â¢
for u (t) âˆˆA0 âˆ©A1. Now let
ur (t) â‰¡
Â½
u (t) if t âˆˆ
Â¡ 1
r, r
Â¢
0 otherwise
.
Then
R âˆž
0
Â¡
tâˆ’Î¸J (t, ur (t))
Â¢q dt
t < âˆžand
ar â‰¡
Z âˆž
0
ur (t) dt
t âˆˆA0 âˆ©A1
by Lemma 45.24. Also
||a âˆ’ar||q
Î¸,q,J â‰¤
Z
1
r
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢q dt
t +
Z âˆž
r
Â¡
tâˆ’Î¸J (t, u (t))
Â¢q dt
t

1270
INTERPOLATION IN BANACH SPACE
which is small whenever r is large enough thanks to the dominated convergence
theorem. Therefore, A0 âˆ©A1 is dense in (A0, A1)Î¸,q,J and so
(A0, A1)â€²
Î¸,q,J âŠ†(A0 âˆ©A1)â€² = Aâ€²
0 + Aâ€²
1,
the equality following from Lemma 45.28.
It follows aâ€² âˆˆAâ€²
0 + Aâ€²
1 and so, by Lemma 45.28, there exists bi âˆˆA0 âˆ©A1 such
that
K
Â¡
2âˆ’i, aâ€², Aâ€²
0, Aâ€²
1
Â¢
âˆ’Îµ min
Â¡
1, 2âˆ’iÂ¢
â‰¤
aâ€² (bi)
J (2i, bi, A0, A1).
Now let Î± âˆˆÎ»Î¸,q with Î±i â‰¥0 for all i and let
aâˆžâ‰¡
X
i
J
Â¡
2i, bi, A0, A1
Â¢âˆ’1 biÎ±i.
(45.46)
Consider ï¬rst whether aâˆžmakes sense before proceeding further.
aâˆžâ‰¡
X
i
bi2iÎ¸
max
Â¡
||bi||A0 , 2i ||bi||A1
Â¢2âˆ’iÎ¸Î±i.
Now
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
bi2iÎ¸
max
Â¡
||bi||A0 , 2i ||bi||A1
Â¢
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
A0+A1
â‰¤
Â½ 2iÎ¸ if i < 0
2âˆ’i(1âˆ’Î¸) if i â‰¥0 .
(45.47)
This is fairly routine to verify. Consider the case where i â‰¥0. Then
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
bi2iÎ¸
max
Â¡
||bi||A0 , 2i ||bi||A1
Â¢
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
A0+A1
â‰¤
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
bi2iÎ¸
2i ||bi||A1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
A0+A1
â‰¤2âˆ’i(1âˆ’Î¸)
because ||bi||A1 â‰¥||bi||A0+A1. Therefore,
M
X
i=0
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
bi2iÎ¸
max
Â¡
||bi||A0 , 2i ||bi||A1
Â¢2âˆ’iÎ¸Î±i
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
A0+A1
â‰¤
M
X
i=0
2âˆ’i(1âˆ’Î¸)2âˆ’iÎ¸Î±i â‰¤
Ãƒ âˆž
X
i=0
2âˆ’i(1âˆ’Î¸)qâ€²
!1/qâ€² Ãƒ âˆž
X
i=0
2âˆ’iqÎ¸Î±q
i
!1/q
< âˆž
and similarly,
0
X
i=âˆ’âˆž
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
bi2iÎ¸
max
Â¡
||bi||A0 , 2i ||bi||A1
Â¢2âˆ’iÎ¸Î±i
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
A0+A1
converges. Therefore, aâˆžmakes sense in A0 + A1 and also from 45.47, we see that
(
||bi||A0+A1 2iÎ¸
J (2i, bi)
)
âˆˆÎ»(1âˆ’Î¸)qâ€²

45.4.
DUALITY AND INTERPOLATION
1271
Now let
u (t) â‰¡
Î±ibi
J (2i, bi) ln 2 on [2iâˆ’1, 2i).
Then
Z âˆž
0
u (t) dt
t
=
X
i
Z 2i
2iâˆ’1
Î±ibi
J (2i, bi) ln 2
dt
t
=
X
i
Î±ibi
J (2i, bi) = aâˆž.
Also
Z âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢q dt
t â‰¤
X
i
Z 2i
2iâˆ’1
Â³
2(1âˆ’i)Î¸J
Â¡
2i, u
Â¡
2iâˆ’1Â¢Â¢Â´ dt
t
â‰¤
X
i
h
2âˆ’(iâˆ’1)Î¸J
Â¡
2i, u
Â¡
2iâˆ’1Â¢Â¢iq
ln 2
=
X
i
"
2âˆ’(iâˆ’1)Î¸ J
Â¡
2i, bi
Â¢
Î±i
J (2i, bi) ln 2
#q
ln 2
= C
X
i
Â¡
2âˆ’iÎ¸ |Î±i|
Â¢q < âˆž
(45.48)
and so ||aâˆž||Î¸,q,J < âˆž. Now for aâ€² as above, aâ€² âˆˆ(A0, A1)â€²
Î¸,q,J âŠ†(A0 + A1)â€² , and
so since the sum for aâˆžconverges in A0 + A1, we have
aâ€² (aâˆž) =
X
i
J
Â¡
2i, bi
Â¢âˆ’1 Î±iaâ€² (bi) .
Therefore,
aâ€² (aâˆž)
â‰¥
X
i
Â£
K
Â¡
2âˆ’i, aâ€²Â¢
âˆ’Îµ min
Â¡
1, 2âˆ’iÂ¢Â¤
Î±i
=
X
i
K
Â¡
2âˆ’i, aâ€²Â¢
Î±i âˆ’
X
i
Îµ min
Â¡
1, 2âˆ’iÂ¢
Î±i
=
X
i
K
Â¡
2âˆ’i, aâ€²Â¢
Î±i âˆ’O (Îµ)
(45.49)

1272
INTERPOLATION IN BANACH SPACE
The reason for this is that Î± âˆˆÎ»Î¸,q so
Â©
Î±i2âˆ’iÎ¸Âª
âˆˆlq. Therefore,
X
i
Îµ min
Â¡
1, 2âˆ’iÂ¢
Î±i
=
Îµ
( âˆž
X
i=0
2âˆ’iÎ±i +
âˆ’1
X
i=âˆ’âˆž
Î±i
)
=
Îµ
( âˆž
X
i=0
2âˆ’iÎ¸2(Î¸âˆ’1)iÎ±i +
âˆ’1
X
i=âˆ’âˆž
Î±i2âˆ’iÎ¸2iÎ¸
)
â‰¤
Îµ
ï£±
ï£²
ï£³
ÃƒX
i
Â¯Â¯Î±i2âˆ’iÎ¸Â¯Â¯q
!1/q Ãƒ âˆž
X
i=0
Â³
2(Î¸âˆ’1)iÂ´qâ€²!1/qâ€²
+
ÃƒX
i
Â¯Â¯Î±i2âˆ’iÎ¸Â¯Â¯q
!1/q Ãƒ âˆž
X
i=0
Â¡
2Î¸iÂ¢qâ€²!1/qâ€²ï£¼
ï£½
ï£¾
<
CÎµ.
Also
|aâ€² (aâˆž)| â‰¤||aâ€²||(A0,A1)â€²
Î¸,q,J ||aâˆž||(A0,A1)Î¸,q,J .
Now from the deï¬nition of K,
K
Â¡
2âˆ’i, aâ€², Aâ€²
0, Aâ€²
1
Â¢
= 2âˆ’iK
Â¡
2i, aâ€², Aâ€²
1, Aâ€²
0
Â¢
and so from 45.49
X
i
2âˆ’iK
Â¡
2i, aâ€², Aâ€²
1, Aâ€²
0
Â¢
Î±i âˆ’O (Îµ)
â‰¤
aâ€² (aâˆž)
â‰¤
||aâ€²||(A0,A1)â€²
Î¸,q,J CÎ¸ ||Î±||Î»Î¸,q .
Since Îµ is arbitrary, it follows that whenever, Î± âˆˆÎ»Î¸,q, Î±i â‰¥0,
X
i
2âˆ’iK
Â¡
2i, aâ€², Aâ€²
1, Aâ€²
0
Â¢
Î±i â‰¤||aâ€²||(A0,A1)â€²
Î¸,q,J CÎ¸ ||Î±||Î»Î¸,q .
By Lemma 45.30,
Â©
K
Â¡
2i, aâ€², Aâ€²
1, Aâ€²
0
Â¢Âª
âˆˆÎ»1âˆ’Î¸,qâ€² and
Â¯Â¯Â¯Â¯Â©
K
Â¡
2i, aâ€², Aâ€²
1, Aâ€²
0
Â¢ÂªÂ¯Â¯Â¯Â¯
Î»1âˆ’Î¸,qâ€² â‰¤||aâ€²||(A0,A1)â€²
Î¸,q,J CÎ¸.

45.4.
DUALITY AND INTERPOLATION
1273
Therefore,
Âµ 1
ln 2
Z âˆž
0
Â³
K (t, aâ€², Aâ€²
1, Aâ€²
0) tâˆ’(1âˆ’Î¸)Â´qâ€² dt
t
Â¶1/qâ€²
=
ÃƒX
i
1
ln 2
Z 2i+1
2i
Â³
K (t, aâ€², Aâ€²
1, Aâ€²
0) tâˆ’(1âˆ’Î¸)Â´qâ€² dt
t
!1/qâ€²
â‰¤
ÃƒX
i
Â³
2âˆ’i(1âˆ’Î¸)K
Â¡
2i, aâ€², Aâ€²
1, Aâ€²
0
Â¢Â´qâ€²!1/qâ€²
â‰¤
||aâ€²||(A0,A1)â€²
Î¸,q,J CÎ¸.
Thus
||aâ€²||(Aâ€²
1,Aâ€²
0)1âˆ’Î¸,qâ€²
â‰¡
Â¯Â¯Â¯
Â¯Â¯Â¯tâˆ’(1âˆ’Î¸)K (t, aâ€², Aâ€²
1, Aâ€²
0)
Â¯Â¯Â¯
Â¯Â¯Â¯
Lqâ€²(0,âˆž, dt
t )
â‰¤
C ||aâ€²||(A0,A1)â€²
Î¸,q,J
which shows that (A0, A1)â€²
Î¸,q,J âŠ†(Aâ€²
1, Aâ€²
0)1âˆ’Î¸,qâ€² with the inclusion map continuous.
This proves the lemma.
Lemma 45.32 If Ai is reï¬‚exive for i = 0, 1 and if A0 âˆ©A1 is dense in Ai, then
(Aâ€²
1, Aâ€²
0)1âˆ’Î¸,qâ€²,J âŠ†(A0, A1)â€²
Î¸,q
and the inclusion map is continuous.
Proof: Let aâ€² âˆˆ(Aâ€²
1, Aâ€²
0)1âˆ’Î¸,qâ€²,J . Thus, there exists uâˆ—bounded on compact
subsets of (0, âˆž) and measurable with values in A0 âˆ©A1 and
aâ€² =
Z âˆž
0
uâˆ—(t) dt
t ,
(45.50)
Z âˆž
0
Â³
tâˆ’(1âˆ’Î¸)J (t, uâˆ—(t))
Â´qâ€² dt
t < âˆž.
Then
aâ€² =
âˆž
X
i=âˆ’âˆž
Z 2i+1
2i
uâˆ—(t) dt
t â‰¡
âˆž
X
i=âˆ’âˆž
aâ€²
i
where aâ€²
i âˆˆAâ€²
1 âˆ©Aâ€²
0, the convergence taking place in Aâ€²
1 + Aâ€²
0. Now let a âˆˆA0 âˆ©A1.

1274
INTERPOLATION IN BANACH SPACE
From Lemma 45.28
|aâ€² (a)|
â‰¤
âˆž
X
i=âˆ’âˆž
|aâ€²
i (a)|
â‰¤
âˆž
X
i=âˆ’âˆž
J
Â¡
2âˆ’i, aâ€²
i, Aâ€²
0, Aâ€²
1
Â¢
K
Â¡
2i, a, A0, A1
Â¢
=
âˆž
X
i=âˆ’âˆž
2âˆ’iJ
Â¡
2i, aâ€²
i, Aâ€²
1, Aâ€²
0
Â¢
K
Â¡
2i, a, A0, A1
Â¢
â‰¤
ÃƒX
i
Â³
2âˆ’(1âˆ’Î¸)iJ
Â¡
2i, aâ€²
i, Aâ€²
1, Aâ€²
0
Â¢Â´qâ€²!1/qâ€²
Â·
ÃƒX
i
Â¡
2âˆ’Î¸iK
Â¡
2i, a, A0, A1
Â¢Â¢q
!1/q
â‰¤
C
Â·Z âˆž
0
Â³
tâˆ’(1âˆ’Î¸)J (t, uâˆ—(t) , Aâ€²
1, Aâ€²
0)
Â´qâ€² dt
t
Â¸1/qâ€²
Â·
Â·Z âˆž
0
Â¡
tâˆ’Î¸K (t, a, A0, A1)
Â¢q dt
t
Â¸1/q
.
In going from the sums to the integrals, express the ï¬rst sum as a sum of integrals
on [2i, 2i+1) and the second sum as a sum of integrals on (2iâˆ’1, 2i].
Taking the inï¬mum over all uâˆ—representing aâ€²,
|aâ€² (a)| â‰¤C ||aâ€²||(Aâ€²
1,Aâ€²
0)1âˆ’Î¸,qâ€²,J ||a||Î¸,q .
It follows aâ€² âˆˆ(A0, A1)â€²
Î¸,q and ||aâ€²||(A0,A1)â€²
Î¸,q â‰¤C ||aâ€²||(Aâ€²
1,Aâ€²
0)1âˆ’Î¸,qâ€²,J which proves
the lemma.
With these two lemmas the main result follows.
Theorem 45.33 Suppose A0 âˆ©A1 is dense in Ai and Ai is reï¬‚exive. Then
(Aâ€²
1, Aâ€²
0)1âˆ’Î¸,qâ€² = (A0, A1)â€²
Î¸,q
and the norms are equivalent.
Proof: By Theorem 45.27, and the last two lemmas,
(A0, A1)â€²
Î¸,q
=
(A0, A1)â€²
Î¸,q,J âŠ†(Aâ€²
1, Aâ€²
0)1âˆ’Î¸,qâ€²
=
(Aâ€²
1, Aâ€²
0)1âˆ’Î¸,qâ€²,J âŠ†(A0, A1)â€²
Î¸,q .
This proves the theorem.

Trace Spaces
46.1
Deï¬nition And Basic Theory Of Trace Spaces
As in the case of interpolation spaces, suppose A0 and A1 are two Banach spaces
which are continuously embedded in some topological vector space, X.
Deï¬nition 46.1 Deï¬ne a norm on A0 + A1 as follows.
||a||A0+A1 â‰¡inf
Â©
||a0||A0 + ||a1||A1 : a0 + a1 = a
Âª
(46.1)
Lemma 46.2 A0 + A1 with the norm just described is a Banach space.
Proof: This was already explained in the treatment of the K method of inter-
polation. It is just K (1, a) .
Deï¬nition 46.3 Take f â€² in the sense of distributions for any
f âˆˆL1
loc (0, âˆž; A0 + A1)
as follows.
f â€² (Ï†) â‰¡
Z âˆž
0
âˆ’f (t) Ï†â€² (t) dt
whenever Ï† âˆˆCâˆž
c (0, âˆž) . Deï¬ne a Banach space, W (A0, A1, p, Î¸) = W where
p â‰¥1, Î¸ âˆˆ(0, 1). Let
||f||W â‰¡max
Â³Â¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) ,
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1)
Â´
(46.2)
and let W consist of f âˆˆL1
loc (0, âˆž; A0 + A1) such that ||f||W < âˆž.
Note that to be in W, f (t) âˆˆA0 and f â€² (t) âˆˆA1.
Lemma 46.4 If f âˆˆW, then
Trace (f) â‰¡f (0) â‰¡lim
tâ†’0 f (t)
exists in A0 + A1. Also Z â‰¡{f âˆˆW : f (0) = 0} is a closed subspace of W.
1275

1276
TRACE SPACES
Proof: Let 0 < s < t. Let Î½ + 1
p = Î¸. Then
Z âˆž
0
||Ï„ Î½g (Ï„)||p dÏ„ =
Z âˆž
0
Â¯Â¯Â¯Â¯Ï„ Î¸g (Ï„)
Â¯Â¯Â¯Â¯p dÏ„
Ï„
so that tÎ½f â€² âˆˆLp (0, âˆž; A1) , the measure in this case being usual Lebesgue measure.
Then
f (t) âˆ’f (s) =
Z t
s
f â€² (Ï„) dÏ„ =
Z t
s
Ï„ Î½f â€² (Ï„) Ï„ âˆ’Î½dÏ„.
For 1
p + 1
pâ€² = 1, Î½pâ€² =
Â³
Î¸ âˆ’1
p
Â´
pâ€² < 1 because Î¸ < 1 = 1
pâ€² + 1
p. Therefore,
||f (t) âˆ’f (s)||A0+A1
â‰¤
Z t
s
||f â€² (Ï„)||A0+A1 dÏ„
(46.3)
â‰¤
Z t
s
||f â€² (Ï„)||A1 dÏ„ =
Z t
s
||Ï„ Î½f â€² (Ï„)||A1 Ï„ âˆ’Î½dÏ„
â‰¤
ÂµZ t
s
||Ï„ Î½f â€² (Ï„)||p
A1 dÏ„
Â¶1/p ÂµZ t
s
Ï„ âˆ’Î½pâ€²dÏ„
Â¶1/pâ€²
â‰¤
||f||W
Ãƒ
t1âˆ’Î½pâ€²
1 âˆ’Î½pâ€² âˆ’s1âˆ’Î½pâ€²
1 âˆ’Î½pâ€²
!
(46.4)
â‰¤
||f||W
t1âˆ’Î½pâ€²
1 âˆ’Î½pâ€² .
which converges to 0 as t â†’0. This shows that limtâ†’0+ f (t) exists in A0 + A1.
Clearly Z is a subspace. Let fn â†’f in W and suppose fn âˆˆZ. Then since
f âˆˆW, 46.4 implies f is continuous. Using 46.4 and replacing f with fn âˆ’fm and
then taking a limit as s â†’0,
||fn (t) âˆ’fm (t)||A0+A1 â‰¤||fn âˆ’fm||W CÎ½t1âˆ’Î½pâ€²
Taking a subsequence, it can be assumed fn (t) converges to f (t) a.e.
But the
above inequality shows that fn (t) is a Cauchy sequence in C ([0, Î²] ; A0 + A1) for
all Î² < âˆž. Therefore, fn (t) â†’f (t) for all t. Also,
||fn (t)||A0+A1 â‰¤CÎ½ ||fn||W t1âˆ’Î½pâ€² â‰¤Kt1âˆ’Î½pâ€²
for some K depending on max {||fn|| : n â‰¥1} and so
||f (t)||A0+A1 â‰¤Kt1âˆ’Î½pâ€²
which implies f (0) = 0. Thus Z is closed.
Deï¬nition 46.5 Let W be a Banach space and let Z be a closed subspace. Then
the quotient space, denoted by W/Z consists of the set of equivalence classes [x]

46.1.
DEFINITION AND BASIC THEORY OF TRACE SPACES
1277
where the equivalence relation is deï¬ned by x âˆ½y means x âˆ’y âˆˆZ. Then W/Z is
a vector space if the operations are deï¬ned by Î± [x] â‰¡[Î±x] and [x] + [y] â‰¡[x + y]
and these vector space operations are well deï¬ned. The norm on the quotient space
is deï¬ned as ||[x]|| â‰¡inf {||x + z|| : z âˆˆZ} .
The veriï¬cation of the algebraic claims made in the above deï¬nition is left to
the reader. It is routine. What is not as routine is the following lemma. However,
it is similar to some topics in the presentation of the K method of interpolation.
Lemma 46.6 Let W be a Banach space and let Z be a closed subspace of W. Then
W/Z with the norm described above is a Banach space.
Proof: That W/Z is a vector space is left to the reader. Why is ||Â·|| a norm?
Suppose Î± Ì¸= 0. Then
||Î± [x]||
=
||[Î±x]|| â‰¡inf {||Î±x + z|| : z âˆˆZ}
=
inf {||Î±x + Î±z|| : z âˆˆZ}
=
|Î±| inf {||x + z|| : z âˆˆZ} = |Î±| ||[x]|| .
Now let ||[x]|| â‰¥||x + z1|| âˆ’Îµ and let ||[y]|| â‰¥||y + z2|| âˆ’Îµ where zi âˆˆZ. Then
||[x] + [y]||
â‰¡
||[x + y]|| â‰¤||x + y + z1 + z2||
â‰¤
||x + z1|| + ||y + z2|| â‰¤||[x]|| + ||[y]|| + 2Îµ.
Since Îµ is arbitrary, this shows the triangle inequality. Clearly, ||[x]|| â‰¥0. It remains
to show that the only way ||[x]|| = 0 is for x âˆˆZ. Suppose then that ||[x]|| = 0.
This means there exist zn âˆˆZ such that ||x + zn|| â†’0. Therefore, âˆ’x is a limit of
a sequence of points of Z and since Z is closed, this requires âˆ’x âˆˆZ. Hence x âˆˆZ
also because Z is a subspace. This shows ||Â·|| is a norm on W/Z. It remains to
verify that W/Z is a Banach space.
Suppose {[xn]} is a Cauchy sequence in W/Z and suppose ||[xn] âˆ’[xn+1]|| <
1
2n+1 . Let xâ€²
1 = x1. If xâ€²
n has been chosen let xâ€²
n+1 = xn+1 + zn+1 where zn+1 âˆˆZ
be such that
Â¯Â¯Â¯Â¯xâ€²
n+1 âˆ’xâ€²
n
Â¯Â¯Â¯Â¯
â‰¤
||[xn+1 âˆ’xn]|| +
1
2(n+1)
=
||[xn+1] âˆ’[xn]|| +
1
2(n+1) < 1
2n .
It follows {xâ€²
n} is a Cauchy sequence in W and so it must converge to some x âˆˆW.
Now
||[x] âˆ’[xn]|| = ||[x âˆ’xn]|| = ||[x âˆ’xâ€²
n]|| â‰¤||x âˆ’xâ€²
n||
which converges to 0.
Now if {[xn]} is just a Cauchy sequence, there exists a
subsequence satisfying
Â¯Â¯Â¯Â¯[xnk] âˆ’
Â£
xnk+1
Â¤Â¯Â¯Â¯Â¯ <
1
2k+1 and so from the ï¬rst part, the
subsequence converges to some [x] âˆˆW/Z and so the original Cauchy sequence also
converges. therefore, W/Z is a Banach space as claimed.

1278
TRACE SPACES
Deï¬nition 46.7 Deï¬ne T (A0, A1, p, Î¸) = T, to consist of
Â½
a âˆˆA0 + A1 : a = lim
tâ†’0+ f (t) for some f âˆˆW (A0, A1, p, Î¸)
Â¾
,
the limit taking place in A0+A1. Let Î³f be deï¬ned for f âˆˆW by Î³f â‰¡limtâ†’0+ f (t) .
Thus T = Î³ (W) . As above Z â‰¡{f âˆˆW : Î³f = 0} = ker (Î³) .
Lemma 46.8 T is a Banach space with norm given by
||a||T â‰¡inf {||f||W : f (0) = a} .
(46.5)
Proof: Deï¬ne a mapping, Ïˆ : W/Z â†’T by
Ïˆ ([f]) â‰¡Î³f.
Then Ïˆ is one to one and onto. Also
||[f]|| â‰¡inf {||f + g|| : g âˆˆZ} = inf {||h||W : Î³h = Î³f} = ||Î³ (f)||T .
Therefore, the Banach space, W/Z and T are isometric and so T must be a Banach
space since W/Z is.
The following is an important interpolation inequality.
Theorem 46.9 If a âˆˆT, then
||a||T = inf
nÂ¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯1âˆ’Î¸
Lp(0,âˆž, dt
t ;A0)
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯Î¸
Lp(0,âˆž, dt
t ;A1)
o
(46.6)
where the inï¬mum is taken over all f âˆˆW such that a = f (0) . Also, if a âˆˆA0âˆ©A1,
then a âˆˆT and
||a||T â‰¤K ||a||1âˆ’Î¸
A1 ||a||Î¸
A0
(46.7)
for some constant K. Also
A0 âˆ©A1 âŠ†T (A0, A1, p, Î¸) âŠ†A0 + A1
(46.8)
and the inclusion maps are continuous.
Proof: First suppose f (0) = a where f âˆˆW. Then letting fÎ» (t) â‰¡f (Î»t) , it
follows that fÎ» (0) = a also and so
||a||T
â‰¤
max
Â³Â¯Â¯Â¯Â¯tÎ¸fÎ»
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) ,
Â¯Â¯Â¯Â¯tÎ¸ (fÎ»)â€²Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1)
Â´
=
max
Â³
Î»âˆ’Î¸ Â¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) , Î»1âˆ’Î¸ Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1)
Â´
â‰¡
max
Â³
Î»âˆ’Î¸R, Î»1âˆ’Î¸S
Â´
.
Now choose Î» = R/S to obtain
||a||T â‰¤R1âˆ’Î¸SÎ¸ =
Â¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯1âˆ’Î¸
Lp(0,âˆž, dt
t ;A0)
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯Î¸
Lp(0,âˆž, dt
t ;A1) .

46.1.
DEFINITION AND BASIC THEORY OF TRACE SPACES
1279
Thus
||a||T â‰¤inf
nÂ¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯1âˆ’Î¸
Lp(0,âˆž, dt
t ;A0)
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯Î¸
Lp(0,âˆž, dt
t ;A1)
o
.
Next choose f âˆˆW such that f (0) = a and ||f||W â‰ˆ||a||T . More precisely, pick
f âˆˆW such that f (0) = a and ||a||T > âˆ’Îµ + ||f||W . Also let
R â‰¡
Â¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) , S â‰¡
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1) .
Then as before,
Â¯Â¯Â¯Â¯tÎ¸fÎ»
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) = Î»âˆ’Î¸R,
Â¯Â¯Â¯Â¯tÎ¸ (fÎ»)â€²Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1) = Î»1âˆ’Î¸S.
(46.9)
so that ||f||W = max (R, S) . Then, changing the variables, letting Î» = R/S,
Â¯Â¯Â¯Â¯tÎ¸fÎ»
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) =
Â¯Â¯Â¯Â¯tÎ¸ (fÎ»)â€²Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1) = R1âˆ’Î¸SÎ¸
(46.10)
Since fÎ» (0) = a, fÎ» âˆˆW, and it is always the case that for positive R, S, R1âˆ’Î¸SÎ¸ â‰¤
max (R, S) , this shows that
||a||T
â‰¤
max
Â³Â¯Â¯Â¯Â¯tÎ¸fÎ»
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) ,
Â¯Â¯Â¯Â¯tÎ¸ (fÎ»)â€²Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1)
Â´
=
R1âˆ’Î¸SÎ¸ â‰¤max (R, S) = ||f||W < ||a||T + Îµ,
the ï¬rst inequality holding because ||a||T is the inï¬mum of such things on the right.
This shows 46.6.
It remains to verify 46.7.
To do this, let Ïˆ âˆˆCâˆž([0, âˆž)) , with Ïˆ (0) = 1
and Ïˆ (t) = 0 for all t > 1. Then consider the special f âˆˆW which is given by
f (t) â‰¡aÏˆ (t) where a âˆˆA0 âˆ©A1. Thus f âˆˆW and f (0) = a so a âˆˆT (A0, A1, p, Î¸) .
From the ï¬rst part, there exists a constant, K such that
||a||T
â‰¤
Â¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯1âˆ’Î¸
Lp(0,âˆž, dt
t ;A0)
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯Î¸
Lp(0,âˆž, dt
t ;A1)
â‰¤
K ||a||1âˆ’Î¸
A0 ||a||Î¸
A1
This shows 46.7 and the ï¬rst inclusion in 46.8. From the inequality just obtained,
||a||T
â‰¤
K
Â¡
(1 âˆ’Î¸) ||a||A0 + Î¸ ||a||A1
Â¢
â‰¤
K ||a||A0âˆ©A1 .
This shows the ï¬rst inclusion map of 46.8 is continuous.
Now take a âˆˆT. Let f âˆˆW
be such that a = f (0) and
||a||T + Îµ > ||f||W â‰¥||a||T .
By 46.4,
||a âˆ’f (t)||A0+A1 â‰¤CÎ½t1âˆ’Î½pâ€² ||f||W

1280
TRACE SPACES
where 1
p + Î½ = Î¸, and so
||a||A0+A1 â‰¤||f (t)||A0+A1 + CÎ½t1âˆ’Î½pâ€² ||f||W .
Now ||f (t)||A0+A1 â‰¤||f (t)||A0 .
||a||A0+A1
â‰¤
tÎ½ ||f (t)||A0+A1 tâˆ’Î½ + CÎ½t1âˆ’Î½pâ€² ||f||W
â‰¤
tÎ½ ||f (t)||A0 tâˆ’Î½ + CÎ½t1âˆ’Î½pâ€² ||f||W
Therefore, recalling that Î½pâ€² < 1, and integrating both sides from 0 to 1,
||a||A0+A1 â‰¤CÎ½ ||f||W â‰¤CÎ½ (||a||T + Îµ) .
To see this,
Z 1
0
tÎ½ ||f (t)||A0 tâˆ’Î½dt
â‰¤
ÂµZ 1
0
Â¡
tÎ½ ||f (t)||A0
Â¢p dt
Â¶1/p ÂµZ 1
0
tâˆ’Î½pâ€²dt
Â¶1/pâ€²
â‰¤
C ||f||W .
Since Îµ > 0 is arbitrary, this veriï¬es the second inclusion and continuity of the
inclusion map completing the proof of the theorem.
The interpolation inequality, 46.7 is very signiï¬cant. The next result concerns
bounded linear transformations.
Theorem 46.10 Now suppose A0, A1 and B0, B1 are pairs of Banach spaces such
that Ai embeds continuously into a topological vector space, X and Bi embeds con-
tinuously into a topological vector space, Y. Suppose also that L âˆˆL (A0, B0) and
L âˆˆL (A1, B1) where the operator norm of L in these spaces is Ki, i = 0, 1. Then
L âˆˆL (A0 + A1, B0 + B1)
(46.11)
with
||La||B0+B1 â‰¤max (K0, K1) ||a||A0+A1
(46.12)
and
L âˆˆL (T (A0, A1, p, Î¸) , T (B0, B1, p, Î¸))
(46.13)
and for K the operator norm,
K â‰¤K1âˆ’Î¸
0
KÎ¸
1.
(46.14)
Proof: To verify 46.11, let a âˆˆA0 +A1 and pick a0 âˆˆA0 and a1 âˆˆA1 such that
||a||A0+A1 + Îµ > ||a0||A0 + ||a1||A1 .
Then
||L (a)||B0+B1 = ||La0 + La1||B0+B1 â‰¤||La0||B0 + ||La1||B1

46.2.
EQUIVALENCE OF TRACE AND INTERPOLATION SPACES
1281
â‰¤K0 ||a0||A0 + K1 ||a1||A1 â‰¤max (K0, K1)
Â¡
||a||A0+A1 + Îµ
Â¢
.
This establishes 46.12. Now consider the other assertions.
Let a âˆˆT (A0, A1, p, Î¸) and pick f âˆˆW (A0, A1, p, Î¸) such that Î³f = a and
||a||T (A0,A1,p,Î¸) + Îµ >
Â¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯1âˆ’Î¸
Lp(0,âˆž, dt
t ,A0)
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯Î¸
Lp(0,âˆž, dt
t ,A1) .
Then consider Lf. Since L is continuous on A0 + A1,
Lf (0) = La
and Lf âˆˆW (B0, B1, p, Î¸) . Therefore, by Theorem 46.9,
||La||T (B0,B1,p,Î¸)
â‰¤
Â¯Â¯Â¯Â¯tÎ¸Lf
Â¯Â¯Â¯Â¯1âˆ’Î¸
Lp(0,âˆž, dt
t ,A0)
Â¯Â¯Â¯Â¯tÎ¸Lf â€²Â¯Â¯Â¯Â¯Î¸
Lp(0,âˆž, dt
t ,A1)
â‰¤
K1âˆ’Î¸
0
KÎ¸
1
Â¯Â¯Â¯Â¯tÎ¸f
Â¯Â¯Â¯Â¯1âˆ’Î¸
Lp(0,âˆž, dt
t ,A0)
Â¯Â¯Â¯Â¯tÎ¸f â€²Â¯Â¯Â¯Â¯Î¸
Lp(0,âˆž, dt
t ,A1)
â‰¤
K1âˆ’Î¸
0
KÎ¸
1
Â³
||a||T (A0,A1,p,Î¸) + Îµ
Â´
.
and since Îµ > 0 is arbitrary, this proves the theorem.
46.2
Equivalence Of Trace And Interpolation Spaces
Trace spaces are equivalent to interpolation spaces. In showing this, a more general
sort of trace space than that presented earlier will be used.
Deï¬nition 46.11 Deï¬ne for m a positive integer, V m = V m (A0, A1, p, Î¸) to be
the set of functions, u such that
t â†’tÎ¸u (t) âˆˆLp
Âµ
0, âˆž, dt
t ; A0
Â¶
(46.15)
and
t â†’tÎ¸+mâˆ’1u(m) (t) âˆˆLp
Âµ
0, âˆž, dt
t ; A1
Â¶
.
(46.16)
V m is a Banach space with the norm
||u||V m â‰¡max
ÂµÂ¯Â¯Â¯Â¯tÎ¸u (t)
Â¯Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A0) ,
Â¯Â¯Â¯
Â¯Â¯Â¯tÎ¸+mâˆ’1u(m) (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
Lp(0,âˆž, dt
t ;A1)
Â¶
.
Thus V m equals W in the case when m = 1. More generally, as in [8] diï¬€erent
exponents are used for the two Lp spaces, p0 in place of p for the space corresponding
to A0 and p1 in place of p for the space corresponding to A1.
Deï¬nition 46.12 Denote by T m (A0, A1, p, Î¸) the set of all a âˆˆA0 + A1 such that
for some u âˆˆV m,
a = lim
tâ†’0+ u (t) â‰¡trace (u) ,
(46.17)
the limit holding in A0 + A1. For the norm
||a||T m â‰¡inf {||u||V m : trace (u) = a} .
(46.18)

1282
TRACE SPACES
The case when m = 1 was discussed in Section 46.1. Note it is not known at
this point whether limtâ†’0+ u (t) even exists for every u âˆˆV m. Of course, if m = 1
this was shown earlier but it has not been shown for m > 1. The following theorem
is absolutely amazing. Note the lack of dependence on m of the right side!
Theorem 46.13 The following hold.
T m (A0, A1, p, Î¸) = (A0, A1)Î¸,p,J = (A0, A1)Î¸,p .
(46.19)
Proof: It is enough to show the ï¬rst equality because of Theorem 45.27 which
identiï¬es (A0, A1)Î¸,p,J and (A0, A1)Î¸,p. Let a âˆˆT m. Then there exists u âˆˆV m such
that
a = lim
tâ†’0+ u (t) in A0 + A1.
The ï¬rst task is to modify this u (t) to get a better one which is more usable in
order to show a âˆˆ(A0, A1)Î¸,p,J. Remember, it is required to ï¬nd w (t) âˆˆA0 âˆ©A1
for all t âˆˆ(0, âˆž) and a =
R âˆž
0
w (t) dt
t , a representation which is not known at this
time. To get such a thing, let
Ï† âˆˆCâˆž
c (0, âˆž) , spt (Ï†) âŠ†[Î±, Î²]
(46.20)
with Ï† â‰¥0 and
Z âˆž
0
Ï† (t) dt
t = 1.
(46.21)
Then deï¬ne
eu (t) â‰¡
Z âˆž
0
Ï†
Âµ t
Ï„
Â¶
u (Ï„) dÏ„
Ï„ =
Z âˆž
0
Ï† (s) u
Âµ t
s
Â¶ ds
s .
(46.22)
Claim: limtâ†’0+ eu (t) = a and limtâ†’âˆžeu(k) (t) = 0 in A0 + A1 for all k â‰¤m.
Proof of the claim: From 46.22 and 46.21 it follows that for ||Â·|| referring to
||Â·||A0+A1 ,
||eu (t) âˆ’a||
â‰¤
Z âˆž
0
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯u
Âµ t
s
Â¶
âˆ’a
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯ Ï† (s) ds
s
=
Z âˆž
0
||u (Ï„) âˆ’a|| Ï†
Âµ t
Ï„
Â¶ dÏ„
Ï„
=
Z t/Î±
t/Î²
||u (Ï„) âˆ’a|| Ï†
Âµ t
Ï„
Â¶ dÏ„
Ï„
â‰¤
Z t/Î±
t/Î²
ÎµÏ†
Âµ t
Ï„
Â¶ dÏ„
Ï„ = Îµ
Z Î²
Î±
Ï† (s) ds
s = Îµ
whenever t is small enough due to the convergence of u (t) to a in A0 + A1.
Now consider what occurs when t â†’âˆž. For ||Â·|| referring to the norm in A0,
eu(k) (t) =
Z âˆž
0
Ï†(k)
Âµ t
Ï„
Â¶ 1
Ï„ k u (Ï„) dÏ„
Ï„

46.2.
EQUIVALENCE OF TRACE AND INTERPOLATION SPACES
1283
and so
Â¯Â¯Â¯
Â¯Â¯Â¯eu(k) (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
A0
â‰¤Ck
Z t/Î±
t/Î²
||u (Ï„)||A0
dÏ„
Ï„
â‰¤C
ÃƒZ t/Î±
t/Î²
dÏ„
Ï„
!1/pâ€² ÃƒZ t/Î±
t/Î²
||u (Ï„)||p
A0
dÏ„
Ï„
!1/p
.
Now
Â³
Î²
t
Â´Î¸
Ï„ Î¸ â‰¥1 for Ï„ â‰¥t/Î² and so the above expression
â‰¤C
Âµ
ln Î²
Î±
Â¶1/pâ€² ÂµÎ²
t
Â¶Î¸ ÃƒZ âˆž
t/Î²
Â¡
Ï„ Î¸ ||u (Ï„)||A0
Â¢p dÏ„
Ï„
!1/p
and so limtâ†’âˆž
Â¯Â¯Â¯Â¯eu(k) (t)
Â¯Â¯Â¯Â¯
A0 = 0 and therefore, this also holds in A0 + A1. This
proves the claim.
Thus eu has the same properties as u in terms of having a as its trace. eu is used
to build the desired w, representing a as an integral. Deï¬ne
v (t) â‰¡(âˆ’1)m tm
(m âˆ’1)! eu(m) (t) =
(âˆ’1)m
(m âˆ’1)!
Z âˆž
0
tm
Ï„ m Ï†(m)
Âµ t
Ï„
Â¶
u (Ï„) dÏ„
Ï„
=
(âˆ’1)m
(m âˆ’1)!
Z âˆž
0
smÏ†(m) (s) u
Âµ t
s
Â¶ ds
s .
(46.23)
Then from the claim, and integration by parts in the last step,
Z âˆž
0
v
Âµ1
t
Â¶ dt
t =
Z âˆž
0
v (t) dt
t =
(âˆ’1)m
(m âˆ’1)!
Z âˆž
0
tmâˆ’1eu(m) (t) dt = a.
(46.24)
Thus v
Â¡ 1
t
Â¢
represents a in the way desired for (A0, A1)Î¸,p,J if it is also true that
v
Â¡ 1
t
Â¢
âˆˆA0 âˆ©A1 and t â†’tâˆ’Î¸v
Â¡ 1
t
Â¢
is in Lp Â¡
0, âˆž, dt
t ; A0
Â¢
and t â†’t1âˆ’Î¸v
Â¡ 1
t
Â¢
is in
Lp Â¡
0, âˆž, dt
t ; A1
Â¢
. First consider whether v (t) âˆˆA0 âˆ©A1. v (t) âˆˆA0 for each t from
46.23 and the assumption that u âˆˆLp Â¡
0, âˆž, dt
t ; A0
Â¢
. To verify v (t) âˆˆA1, integrate
by parts in 46.23 to obtain
v (t) =
(âˆ’1)m
(m âˆ’1)!
Z âˆž
0
Ï†(m) (s)
Âµ
smâˆ’1u
Âµ t
s
Â¶Â¶
ds
(46.25)
=
1
(m âˆ’1)!
Z âˆž
0
Ï† (s) dm
dsm
Âµ
smâˆ’1u
Âµ t
s
Â¶Â¶
ds
=
(âˆ’1)m
(m âˆ’1)!
Z âˆž
0
Ï† (s)
tm
sm+1 u(m)
Âµ t
s
Â¶
ds âˆˆA1

1284
TRACE SPACES
The last step may look very mysterious. If so, consider the case where m = 2.
Ï† (s)
Âµ
su
Âµ t
s
Â¶Â¶â€²â€²
=
Ï† (s)
Âµ
âˆ’t
suâ€²
Âµ t
s
Â¶
+ u
Âµ t
s
Â¶Â¶â€²
=
Ï† (s)
ÂµÂµ
âˆ’t
s
Â¶
uâ€²â€²
Âµ t
s
Â¶ Âµ
âˆ’t
s2
Â¶
+ t
s2 uâ€²
Âµ t
s
Â¶
âˆ’t
s2 uâ€²
Âµ t
s
Â¶Â¶
=
Ï† (s) t2
s3 uâ€²â€²
Âµ t
s
Â¶
.
You can see the same pattern will take place for other values of m.
Now
||a||Î¸,p,J â‰¤
ÂµZ âˆž
0
Âµ
tâˆ’Î¸J
Âµ
t, v
Âµ1
t
Â¶Â¶Â¶p dt
t
Â¶1/p
â‰¤Cp
(Z âˆž
0
"Ãƒ
tâˆ’Î¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯v
Âµ1
t
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!
+
Ãƒ
t1âˆ’Î¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯v
Âµ1
t
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A1
!#p
dt
t
)1/p
â‰¤Cp
ï£±
ï£²
ï£³
ÃƒZ âˆž
0
Ãƒ
tâˆ’Î¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯v
Âµ1
t
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!p
dt
t
!1/p
+
ÃƒZ âˆž
0
Ãƒ
t1âˆ’Î¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯v
Âµ1
t
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A1
!p
dt
t
!1/pï£¼
ï£½
ï£¾.
(46.26)
The ï¬rst term equals
ÃƒZ âˆž
0
Ãƒ
tâˆ’Î¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯v
Âµ1
t
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!p
dt
t
!1/p
=
ÂµZ âˆž
0
Â¡
tÎ¸ ||v (t)||A0
Â¢p dt
t
Â¶1/p
=
ÃƒZ âˆž
0
Ãƒ
tÎ¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z âˆž
0
smÏ†(m) (s) u
Âµ t
s
Â¶ ds
s
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!p
dt
t
!1/p
â‰¤
Z âˆž
0
ÃƒZ âˆž
0
Ãƒ
tÎ¸sm Â¯Â¯Â¯Ï†(m) (s)
Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯u
Âµ t
s
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!p
dt
t
!1/p
ds
s
â‰¤
Z âˆž
0
sm Â¯Â¯Â¯Ï†(m) (s)
Â¯Â¯Â¯
ÃƒZ âˆž
0
Ãƒ
tÎ¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯u
Âµ t
s
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!p
dt
t
!1/p
ds
s

46.2.
EQUIVALENCE OF TRACE AND INTERPOLATION SPACES
1285
=
Z âˆž
0
sÎ¸+m Â¯Â¯Â¯Ï†(m) (s)
Â¯Â¯Â¯ ds
s
ÂµZ âˆž
0
Â¡
Ï„ Î¸ ||u (Ï„)||A0
Â¢p dÏ„
Ï„
Â¶1/p
= C
ÂµZ âˆž
0
Â¡
Ï„ Î¸ ||u (Ï„)||A0
Â¢p dÏ„
Ï„
Â¶1/p
.
(46.27)
The second term equals
ÃƒZ âˆž
0
Ãƒ
t1âˆ’Î¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯v
Âµ1
t
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A1
!p
dt
t
!1/p
=
ÂµZ âˆž
0
Â¡
tÎ¸âˆ’1 ||v (t)||A1
Â¢p dt
t
Â¶1/p
=
ÃƒZ âˆž
0
Ãƒ
tÎ¸âˆ’1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
1
(m âˆ’1)!
Z âˆž
0
Ï† (s) tm
sm u(m)
Âµ t
s
Â¶ ds
s
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A1
!p
dt
t
!1/p
â‰¤
Z âˆž
0
ÃƒZ âˆž
0
ÃƒÂµtÎ¸+mâˆ’1
sm
Â¶
|Ï† (s)|
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯u(m)
Âµ t
s
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A1
!p
dt
t
!1/p
ds
s
â‰¤
Z âˆž
0
|Ï† (s)|
sm
ÃƒZ âˆž
0
Ãƒ
tÎ¸+mâˆ’1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯u(m)
Âµ t
s
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A1
!p
dt
t
!1/p
ds
s
=
Z âˆž
0
|Ï† (s)|
sm
sÎ¸+mâˆ’1
ÂµZ âˆž
0
Âµ
Ï„ Î¸+mâˆ’1 Â¯Â¯Â¯
Â¯Â¯Â¯u(m) (Ï„)
Â¯Â¯Â¯
Â¯Â¯Â¯
A1
Â¶p dÏ„
Ï„
Â¶1/p ds
s
= C
ÂµZ âˆž
0
Âµ
Ï„ Î¸+mâˆ’1 Â¯Â¯Â¯
Â¯Â¯Â¯u(m) (Ï„)
Â¯Â¯Â¯
Â¯Â¯Â¯
A1
Â¶p dÏ„
Ï„
Â¶1/p
.
(46.28)
Now from the estimates on the two terms in 46.26 found in 46.27 and 46.28, and
the simple estimate,
2 max (Î±, Î²) â‰¥Î± + Î²,
it follows
||a||Î¸,p,J
(46.29)
â‰¤
C max
ÃƒÂµZ âˆž
0
Â¡
Ï„ Î¸ ||u (Ï„)||A0
Â¢p dÏ„
Ï„
Â¶1/p
(46.30)
,
ÂµZ âˆž
0
Âµ
Ï„ Î¸+mâˆ’1 Â¯Â¯Â¯
Â¯Â¯Â¯u(m) (Ï„)
Â¯Â¯Â¯
Â¯Â¯Â¯
A1
Â¶p dÏ„
Ï„
Â¶1/p!
(46.31)
which shows that after taking the inï¬mum over all u whose trace is a, it follows
a âˆˆ(A0, A1)Î¸,p,J .
||a||Î¸,p,J â‰¤C ||a||T m
(46.32)
Thus T m (A0, A1, Î¸, p) âŠ†(A0, A1)Î¸,p,J .

1286
TRACE SPACES
Is (A0, A1)Î¸,p,J âŠ†T m (A0, A1, Î¸, p)? Let a âˆˆ(A0, A1)Î¸,p,J . There exists u having
values in A0 âˆ©A1 and such that
a =
Z âˆž
0
u (t) dt
t =
Z âˆž
0
u
Âµ1
t
Â¶ dt
t ,
in A0 + A1 such that
Z âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢p dt < âˆž, where J (t, a) = max
Â¡
||a||A0 , t ||a||A1
Â¢
.
Then let
w (t) â‰¡
Z âˆž
t
Âµ
1 âˆ’t
Ï„
Â¶mâˆ’1
u
Âµ1
Ï„
Â¶ dÏ„
Ï„ =
(46.33)
Z 1/t
0
(1 âˆ’st)mâˆ’1 u (s) ds
s =
Z 1
0
(1 âˆ’Ï„)mâˆ’1 u
Â³Ï„
t
Â´ dÏ„
Ï„ .
(46.34)
It is routine to verify from 46.33 that
w(m) (t) = (m âˆ’1)! (âˆ’1)m u
Â¡ 1
t
Â¢
tm .
(46.35)
For example, consider the case where m = 2.
ÂµZ âˆž
t
Âµ
1 âˆ’t
Ï„
Â¶
u
Âµ1
Ï„
Â¶ dÏ„
Ï„
Â¶â€²â€²
=
Âµ
0 +
Z âˆž
t
Âµ
âˆ’1
Ï„
Â¶
u
Âµ1
Ï„
Â¶ dÏ„
Ï„
Â¶â€²
=
1
t2 u
Âµ1
t
Â¶
.
Also from 46.33, it follows that trace (w) = a. It remains to verify w âˆˆV m.
From 46.35,
ÂµZ âˆž
0
Âµ
tÎ¸+mâˆ’1 Â¯Â¯Â¯
Â¯Â¯Â¯w(m) (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
A1
Â¶p dt
t
Â¶1/p
=
Cm
ÃƒZ âˆž
0
Ãƒ
tÎ¸âˆ’1
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯u
Âµ1
t
Â¶Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A1
!p
dt
t
!1/p
= Cm
ÂµZ âˆž
0
Â¡
t1âˆ’Î¸ ||u (t)||A1
Â¢p dt
t
Â¶1/p
â‰¤Cm
ÂµZ âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢p dt
t
Â¶1/p
< âˆž.
(46.36)
It remains to consider
Â¡R âˆž
0
Â¡
tÎ¸ ||w (t)||A0
Â¢p dt
t
Â¢1/p . From 46.34,
ÂµZ âˆž
0
Â¡
tÎ¸ ||w (t)||A0
Â¢p dt
t
Â¶1/p
=
ÃƒZ âˆž
0
Ãƒ
tÎ¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z 1
0
(1 âˆ’Ï„)mâˆ’1 u
Â³Ï„
t
Â´ dÏ„
Ï„
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!p
dt
t
!1/p

46.2.
EQUIVALENCE OF TRACE AND INTERPOLATION SPACES
1287
=
ÃƒZ âˆž
0
Ãƒ
tâˆ’Î¸
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
Z 1
0
(1 âˆ’Ï„)mâˆ’1 u (Ï„t) dÏ„
Ï„
Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯
A0
!p
dt
t
!1/p
â‰¤
Z 1
0
ÂµZ âˆž
0
Â³
tâˆ’Î¸ (1 âˆ’Ï„)mâˆ’1 ||u (Ï„t)||A0
Â´p dt
t
Â¶1/p dÏ„
Ï„
=
Z 1
0
Ï„ Î¸ (1 âˆ’Ï„)mâˆ’1
ÂµZ âˆž
0
Â¡
sâˆ’Î¸ ||u (s)||A0
Â¢p ds
s
Â¶1/p dÏ„
Ï„
=
ÂµZ 1
0
Ï„ Î¸âˆ’1 (1 âˆ’Ï„)mâˆ’1 dÏ„
Â¶ ÂµZ âˆž
0
Â¡
sâˆ’Î¸ ||u (s)||A0
Â¢p ds
s
Â¶1/p
â‰¤C
ÂµZ âˆž
0
Â¡
sâˆ’Î¸ ||u (s)||A0
Â¢p ds
s
Â¶1/p
â‰¤C
ÂµZ âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢p dt
Â¶1/p
< âˆž.
(46.37)
It follows that
||w||V m â‰¡
max
ÃƒÂµZ âˆž
0
Â¡
tÎ¸ ||w (t)||A0
Â¢p dt
t
Â¶1/p
,
ÂµZ âˆž
0
Âµ
tÎ¸+mâˆ’1 Â¯Â¯Â¯
Â¯Â¯Â¯w(m) (t)
Â¯Â¯Â¯
Â¯Â¯Â¯
A1
Â¶p dt
t
Â¶1/p!
â‰¤C
ÂµZ âˆž
0
Â¡
tâˆ’Î¸J (t, u (t))
Â¢p dt
Â¶1/p
< âˆž
which shows that a âˆˆT m (A0, A1, Î¸, p) . Taking the inï¬mum,
||a||T m â‰¤C ||a||Î¸,p,J .
This together with 46.32 proves the theorem.
By Theorem 46.13 and Theorem 45.33, we obtain the following important corol-
lary describing the dual space of a trace space.
Corollary 46.14 Let A0 âˆ©A1 be dense in Ai for i = 0, 1 and suppose that Ai is
reï¬‚exive for i = 0, 1. Then for âˆž> p â‰¥1,
T m (A0, A1, Î¸, p)â€² = T m (Aâ€²
1, Aâ€²
0, 1 âˆ’Î¸, pâ€²)

1288
TRACE SPACES

Traces Of Sobolev Spaces
And Fractional Order Spaces
47.1
Traces Of Sobolev Spaces On The Boundary
Of A Half Space
In this section we consider the trace of W m,p Â¡
Rn
+
Â¢
onto a Sobolev space of functions
deï¬ned on Rnâˆ’1. This latter Sobolev space will be deï¬ned in terms of the following
theory in such a way that the trace map is continuous. We already know the trace
map is continuous as a map from W m,p Â¡
Rn
+
Â¢
to W mâˆ’1,p Â¡
Rnâˆ’1Â¢
but we can do
much better than this using the above theory.
Deï¬nition 47.1 Let Î¸ âˆˆ(0, 1) and let â„¦be an open subset of Rm. We deï¬ne
W Î¸,p (â„¦) â‰¡T
Â¡
W 1,p (â„¦) , Lp (â„¦) , p, 1 âˆ’Î¸
Â¢
.
Thus, from the above general theory, W 1,p (â„¦) ,â†’W Î¸,p (â„¦) ,â†’Lp (â„¦) = Lp (â„¦)+
W 1,p (â„¦) . Now we consider the trace map for Sobolev space.
Lemma 47.2 Let Ï† âˆˆCâˆžÂ¡
Rn
+
Â¢
. Then Î³Ï† (xâ€²) â‰¡Ï† (xâ€², 0) . Then Î³ : CâˆžÂ¡
Rn
+
Â¢
â†’
Lp Â¡
Rnâˆ’1Â¢
is continuous as a map from W 1,p Â¡
Rn
+
Â¢
to Lp Â¡
Rnâˆ’1Â¢
.
Proof: We know
Ï† (xâ€², xn) = Î³Ï† (xâ€²) +
Z xn
0
âˆ‚Ï† (xâ€², t)
âˆ‚t
dt
1289

1290
TRACES OF SOBOLEV SPACES AND FRACTIONAL ORDER SPACES
Then by Jensenâ€™s inequality,
Z
Rnâˆ’1 |Î³Ï† (xâ€²)|p dxâ€²
=
Z 1
0
Z
Rnâˆ’1 |Î³Ï† (xâ€²)|p dxâ€²dxn
â‰¤
C
Z 1
0
Z
Rnâˆ’1 |Ï† (xâ€², xn)|p dxâ€²dxn
+C
Z 1
0
Z
Rnâˆ’1
Â¯Â¯Â¯Â¯
Z xn
0
âˆ‚Ï† (xâ€², t)
âˆ‚t
dt
Â¯Â¯Â¯Â¯
p
dxâ€²dxn
â‰¤
C ||Ï†||p
0,p,Rnâˆ’1 + C
Z 1
0
xpâˆ’1
n
Z
Rnâˆ’1
Z xn
0
Â¯Â¯Â¯Â¯
âˆ‚Ï† (xâ€², t)
âˆ‚t
Â¯Â¯Â¯Â¯
p
dtdxâ€²dxn
â‰¤
C ||Ï†||p
0,p,Rnâˆ’1 + C
Z 1
0
xpâˆ’1
n
Z
Rnâˆ’1
Z âˆž
0
Â¯Â¯Â¯Â¯
âˆ‚Ï† (xâ€², t)
âˆ‚t
Â¯Â¯Â¯Â¯
p
dtdxâ€²dxn
â‰¤
C ||Ï†||p
0,p,Rnâˆ’1 + C
p
Z
Rnâˆ’1
Z âˆž
0
Â¯Â¯Â¯Â¯
âˆ‚Ï† (xâ€², t)
âˆ‚t
Â¯Â¯Â¯Â¯
p
dtdxâ€²
â‰¤
C ||Ï†||p
1,p,Rn
+
This proves the lemma.
Deï¬nition 47.3 We deï¬ne the trace, Î³ : W 1,p Â¡
Rn
+
Â¢
â†’Lp Â¡
Rnâˆ’1Â¢
as follows.
Î³Ï† (xâ€²) â‰¡Ï† (xâ€², 0) whenever Ï† âˆˆCâˆžÂ¡
Rn
+
Â¢
. For u âˆˆW 1,p Â¡
Rn
+
Â¢
, we deï¬ne Î³u â‰¡
limkâ†’âˆžÎ³Ï†k in Lp Â¡
Rnâˆ’1Â¢
where Ï†k â†’u in W 1,p Â¡
Rn
+
Â¢
. Then the above lemma
shows this is well deï¬ned.
Also from this lemma we obtain a constant, C such that
||Ï†||0,p,Rnâˆ’1 â‰¤C ||Ï†||1,p,Rn
+
and we see the same constant holds for all u âˆˆW 1,p Â¡
Rn
+
Â¢
. Now we will assert more
than this. From the deï¬nition of the norm in the trace space, if f âˆˆCâˆžÂ¡
Rn
+
Â¢
, and
we let Î¸ = 1 âˆ’1
p, then
||Î³f||1âˆ’1
p ,p,Rnâˆ’1
â‰¤
max
ÃƒÂµZ âˆž
0
Â³
t1/p ||f (t)||1,p,Rnâˆ’1
Â´p dt
t
Â¶1/p
,
ÂµZ âˆž
0
Â³
t1/p ||f â€² (t)||0,p,Rnâˆ’1
Â´p dt
t
Â¶1/p!
â‰¤
C ||f||1,p,Rn
+ .
Thus, if f âˆˆW 1,p Â¡
Rn
+
Â¢
, we may deï¬ne Î³f âˆˆW 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
according to the rule,
Î³f = lim
kâ†’âˆžÎ³Ï†k,

47.1. TRACES OF SOBOLEV SPACES ON THE BOUNDARY OF A HALF SPACE1291
where Ï†k â†’f in W 1,p Â¡
Rn
+
Â¢
and Ï†k âˆˆCâˆžÂ¡
Rn
+
Â¢
. This shows the continuity part of
the following lemma.
Lemma 47.4 The trace map, Î³, is a continuous map from W 1,p Â¡
Rn
+
Â¢
onto
W 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
.
Furthermore, for f âˆˆW 1,p Â¡
Rn
+
Â¢
,
Î³f = f (0) = lim
tâ†’0+ f (t)
the limit taking place in Lp Â¡
Rnâˆ’1Â¢
.
Proof: It remains to verify Î³ is onto along with the displayed equation. But
by deï¬nition, things in W 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
are of the form limtâ†’0+ f (t) where f âˆˆ
Lp Â¡
0, âˆž; W 1,p Â¡
Rnâˆ’1Â¢Â¢
, and f â€² âˆˆLp Â¡
0, âˆž; Lp Â¡
Rnâˆ’1Â¢Â¢
, the limit taking place in
W 1,p Â¡
Rnâˆ’1Â¢
+ Lp Â¡
Rnâˆ’1Â¢
= Lp Â¡
Rnâˆ’1Â¢
,
and
ÂµZ âˆž
0
||f (t)||p
1,p,Rnâˆ’1 dt
Â¶1/p
+
ÂµZ âˆž
0
||f â€² (t)||p
0,p dt
Â¶1/p
< âˆž.
Then taking a measurable representative, we see f âˆˆW 1,p Â¡
Rn
+
Â¢
and f,xn = f â€².
Also, as an equation in Lp Â¡
Rnâˆ’1Â¢
, the following holds for all t > 0.
f (Â·, t) = f (0) +
Z t
0
f,xn (Â·, s) ds
But we also have that for a.e. xâ€²,the following equation holds for a.e. t > 0.
f (xâ€², t) = Î³f (xâ€²) +
Z t
0
f,xn (xâ€², s) ds,
(47.1)
showing that
Î³f = f (0) âˆˆW 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
â‰¡T
Âµ
W 1,p (â„¦) , Lp (â„¦) , p, 1
p
Â¶
.
To see that 47.1 holds, we approximate f with a sequence from CâˆžÂ¡
Rn
+
Â¢
and
ï¬nally obtain an equation of the form
Z
Rnâˆ’1
Z âˆž
0
Â·
f (xâ€², t) âˆ’Î³f (xâ€²) âˆ’
Z t
0
f,xn (xâ€², s) ds
Â¸
Ïˆ (xâ€², t) dtdxâ€² = 0,
which holds for all Ïˆ âˆˆCâˆž
c
Â¡
Rn
+
Â¢
. This proves the lemma.
Thus we lose 1
p derivatives when we take the trace of a function in W 1,p Â¡
Rn
+
Â¢
.

1292
TRACES OF SOBOLEV SPACES AND FRACTIONAL ORDER SPACES
47.2
A Right Inverse For The Trace For A Half
Space
It is also important to show there is a continuous linear function,
R : W 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
â†’W 1,p Â¡
Rn
+
Â¢
which has the property that Î³ (Rg) = g. We will deï¬ne this function as follows.
Rg (xâ€², xn) â‰¡
Z
Rnâˆ’1 g (yâ€²) Ï†
Âµxâ€² âˆ’yâ€²
xn
Â¶
1
xnâˆ’1
n
dyâ€²
(47.2)
where Ï† is a molliï¬er having support in B (0, 1) . Then we have the following lemma.
Lemma 47.5 Let R be deï¬ned in 47.2. Then Rg âˆˆW 1,p Â¡
Rn
+
Â¢
and is a continuous
linear map from W 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
to W 1,p Â¡
Rn
+
Â¢
with the property that Î³Rg = g.
Proof: Let f âˆˆW 1,p Â¡
Rn
+
Â¢
be such that Î³f = g. Let Ïˆ (xn) â‰¡(1 âˆ’xn)+ and
assume f is Borel measurable by taking a Borel measurable representative. Then
for a.e. xâ€² we have the following formula holding for a.e. xn.
Rg (xâ€², xn)
=
Z
Rnâˆ’1
"
Ïˆ (xn) f (yâ€², Ïˆ (xn)) âˆ’
Z Ïˆ(xn)
0
(Ïˆf),n (yâ€², t) dt
#
Ï†
Âµxâ€² âˆ’yâ€²
xn
Â¶
x1âˆ’n
n
dyâ€².
Using the repeated index summation convention to save space, we obtain that in
terms of weak derivatives,
Rg,n (xâ€², xn)
=
Z
Rnâˆ’1
"
Ïˆ (xn) f (yâ€², Ïˆ (xn)) âˆ’
Z Ïˆ(xn)
0
(Ïˆf),n (yâ€², t) dt
#
Â·
Â·
Ï†,k
Âµxâ€² âˆ’yâ€²
xn
Â¶ Âµyk âˆ’xk
xnn
Â¶
+ Ï†
Âµxâ€² âˆ’yâ€²
xn
Â¶ (1 âˆ’n)
xnn
Â¸
dyâ€²
=
Z
Rnâˆ’1
"
Ïˆ (xn) f (xâ€² âˆ’xnzâ€², Ïˆ (xn)) âˆ’
Z Ïˆ(xn)
0
(Ïˆf),n (xâ€² âˆ’xnzâ€², t) dt
#
Â·
Â·
Ï†,k (zâ€²)
Âµyk âˆ’xk
xnn
Â¶
zk + Ï† (zâ€²) (1 âˆ’n)
xnn
Â¸
xn
ndzâ€²
and so
|Rg,n (xâ€², xn)|
â‰¤
C (Ï†)
Â¯Â¯Â¯Â¯Â¯
Z
B(0,1)
[Ïˆ (xn) f (xâ€² âˆ’xnzâ€², Ïˆ (xn))
âˆ’
Z Ïˆ(xn)
0
(Ïˆf),n (xâ€² âˆ’xnzâ€², t) dt
#Â¯Â¯Â¯Â¯Â¯

47.2.
A RIGHT INVERSE FOR THE TRACE FOR A HALF SPACE
1293
â‰¤
C (Ï†)
xnâˆ’1
n
(Z
B(0,xn)
|Ïˆ (xn) f (xâ€² + yâ€², Ïˆ (xn))| dyâ€²
+
Z
B(0,xn)
Z Ïˆ(xn)
0
Â¯Â¯Â¯(Ïˆf),n (xâ€² + yâ€², t)
Â¯Â¯Â¯ dtdyâ€²
)
Therefore,
ÂµZ âˆž
0
Z
Rnâˆ’1 |Rg,n (xâ€², xn)|p dxâ€²dxn
Â¶1/p
â‰¤
C (Ï†)
ÃƒZ âˆž
0
Z
Rnâˆ’1
Ãƒ
1
xnâˆ’1
n
Z
B(0,xn)
|Ïˆ (xn) f (xâ€² + yâ€², Ïˆ (xn))| dyâ€²
!p
dxâ€²dxn
!1/p
+C (Ï†)
ÃƒZ âˆž
0
Z
Rnâˆ’1
Ãƒ
1
xnâˆ’1
n
Z
B(0,xn)
Z Ïˆ(xn)
0
Â¯Â¯Â¯(Ïˆf),n (xâ€² + yâ€², t)
Â¯Â¯Â¯ dtdyâ€²
!p
dxâ€²dxn
!1/p
(47.3)
Consider the ï¬rst term on the right. We change variables, letting yâ€² = zâ€²xn. Then
this term becomes
C (Ï†)
ÃƒZ 1
0
Z
Rnâˆ’1
ÃƒZ
B(0,1)
|Ïˆ (xn) f (xâ€² + xnzâ€², Ïˆ (xn))| dzâ€²
!p
dxâ€²dxn
!1/p
â‰¤C (Ï†)
Z
B(0,1)
ÂµZ 1
0
Z
Rnâˆ’1 |Ïˆ (xn) f (xâ€² + xnzâ€², Ïˆ (xn))|p dxâ€²dxn
Â¶1/p
dzâ€²
Now we change variables, letting t = Ïˆ (xn) . This yields
= C (Ï†)
Z
B(0,1)
ÂµZ 1
0
Z
Rnâˆ’1 |tf (xâ€² + xnzâ€², t)|p dxâ€²dt
Â¶1/p
dzâ€² â‰¤C (Ï†) ||f||0,p,Rn
+ .
(47.4)
Now we consider the second term on the right in 47.3. Using the same arguments
which were used on the ï¬rst term involving Minkowskiâ€™s inequality and changing
the variables, we obtain the second term
â‰¤
C (Ï†)
Z
B(0,1)
Z 1
0
ÂµZ 1
0
Z
Rnâˆ’1
Â¯Â¯Â¯(Ïˆf),n (xâ€² + xnzâ€², t)
Â¯Â¯Â¯
p
dxâ€²dxn
Â¶1/p
dtdyâ€²
â‰¤
C (Ï†) ||f||1,p,Rn
+ .
(47.5)
It is somewhat easier to verify that
||Rg,j||0,p,Rn
+ â‰¤C (Ï†) ||f||1,p,Rn
+ .
Therefore, we have shown that whenever Î³f = f (0) = g,
||Rg||1,p,Rn
+ â‰¤C (Ï†) ||f||1,p,Rn
+ .

1294
TRACES OF SOBOLEV SPACES AND FRACTIONAL ORDER SPACES
Taking the inï¬mum over all such f and using the deï¬nition of the norm in
W 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
,
it follows
||Rg||1,p,Rn
+ â‰¤C (Ï†) ||g||1âˆ’1
p ,p,Rnâˆ’1,
showing that this map, R, is continuous as claimed. It is obvious that
lim
xnâ†’0 Rg (xn) = g,
the convergence taking place in Lp Â¡
Rnâˆ’1Â¢
because of general results about convo-
lution with molliï¬ers. This proves the lemma.
47.3
Fractional Order Sobolev Spaces
Deï¬nition 47.6 Let m be a nonnegative integer and let s = m+Ïƒ where Ïƒ âˆˆ(0, 1) .
Then W s,p (â„¦) will consist of those elements of W m,p (â„¦) for which DÎ±u âˆˆW Ïƒ,p (â„¦)
for all |Î±| = m. The norm is given by the following.
||u||s,p,â„¦â‰¡
ï£«
ï£­||u||p
m,p,â„¦+
X
|Î±|=m
||DÎ±u||p
Ïƒ,p,â„¦
ï£¶
ï£¸
1/p
.
Corollary 47.7 The space, W s,p (â„¦) is a reï¬‚exive Banach space whenever p > 1.
Proof: We know from the theory of interpolation spaces that W Ïƒ,p (â„¦) is reï¬‚ex-
ive. This is because it is an iterpolation space for the two reï¬‚exive spaces, Lp (â„¦)
and W 1,p (â„¦) . Now the formula for the norm of an element in W s,p (â„¦) shows this
space is isometric to a closed subspace of W m,p (â„¦) Ã— W Ïƒ,p (â„¦)k for suitable k.
Therefore, W s,p (â„¦) is also reï¬‚exive.
Theorem 47.8 The trace map, Î³ : W m,p Â¡
Rn
+
Â¢
â†’W mâˆ’1
p ,p Â¡
Rnâˆ’1Â¢
is continuous.
Proof: Let f âˆˆS. We let Ïƒ = 1 âˆ’1
p so that m âˆ’
Â³
1
p
Â´
= m âˆ’1 + Ïƒ. Then from
the deï¬nition,
||Î³f||mâˆ’1
p ,p,Rnâˆ’1 =
ï£«
ï£­||Î³f||p
mâˆ’1,p,Rnâˆ’1 +
X
|Î±|=mâˆ’1
||DÎ±Î³f||p
1âˆ’1
p ,p,Rnâˆ’1
ï£¶
ï£¸
1/p
and from Lemma 47.4, and the fact that the trace is continuous as a map from
W m,p Â¡
Rn
+
Â¢
to W mâˆ’1,p Â¡
Rnâˆ’1Â¢
,
||Î³f||mâˆ’1
p ,p,Rnâˆ’1 â‰¤
Â³
C1 ||f||p
m,p,Rn
+ + C2 ||f||m,p,Rn+
Â´1/p
â‰¤C ||f||m,p,Rn+ .
This proves the theorem.
With the deï¬nition of W s,p (â„¦) for s not an integer, we can generalize an earlier
theorem.

47.3.
FRACTIONAL ORDER SOBOLEV SPACES
1295
Theorem 47.9 Let h : U â†’V where U and V are two open sets and suppose h is
bilipschitz and that DÎ±h and DÎ±hâˆ’1 exist and are Lipschitz continuous if |Î±| â‰¤m
where m = 0, 1, Â· Â· Â·.and s = m + Ïƒ where Ïƒ âˆˆ(0, 1) . Then
hâˆ—: W s,p (V ) â†’W s,p (U)
is continuous, linear, one to one, and has an inverse with the same properties, the
inverse being
Â¡
hâˆ’1Â¢âˆ—.
Proof: In case m = 0, the conclusion of the theorem is immediate from the
general theory of trace spaces. Therefore, we can assume m â‰¥1. We know from the
deï¬nition that
||hâˆ—u||m+Ïƒ,p,U â‰¡
ï£®
ï£°||hâˆ—u||p
m,p,U +
X
|Î±|=m
||DÎ± (hâˆ—u)||p
Ïƒ,p,U
ï£¹
ï£»
1/p
Now consider the case when m = 1. Then it is routine to verify that
Djhâˆ—u (x) = u,k (h (x)) hk,j (x) .
Let Lk : W 1,p (V ) â†’W 1,p (U) be deï¬ned by
Lkv = hâˆ—(v) hk,j.
Then Lk is continuous as a map from W 1,p (V ) to W 1,p (U) and as a map from
Lp (V ) to Lp (U) and therefore, it follows that Lk is continuous as a map from
W Ïƒ,p (V ) to W Ïƒ,p (U) . Therefore,
||Lk (v)||Ïƒ,p,U â‰¤Ck ||v||Ïƒ,p,U
and so
||Dj (hâˆ—u)||Ïƒ,p,U
â‰¤
X
k
||Lk (u,k)||Ïƒ,p,U
â‰¤
X
k
Ck ||Dku||Ïƒ,p,V
â‰¤
C
ÃƒX
k
||Dku||p
Ïƒ,p,V
!1/p
.
Therefore, it follows that
||hâˆ—u||1+Ïƒ,p,U
â‰¤
ï£®
ï£°||hâˆ—u||p
1,p,U +
X
j
Cp X
k
||Dku||p
Ïƒ,p,V
ï£¹
ï£»
1/p
â‰¤
C
"
||u||p
1,p,V +
X
k
||Dku||p
Ïƒ,p,V
#1/p
= C ||u||1+Ïƒ,p,V .

1296
TRACES OF SOBOLEV SPACES AND FRACTIONAL ORDER SPACES
The general case is similar. We simply have a more complicated continuous linear
operator in place of Lk.
Now we prove an important interpolation inequality for Sobolev spaces.
Theorem 47.10 Let â„¦be an open set in Rn and let f âˆˆW m+1,p (â„¦) and Ïƒ âˆˆ
(0, 1) . Then for some constant, C, independent of f,
||f||m+Ïƒ,p,â„¦â‰¤C ||f||1âˆ’Ïƒ
m+1,p,â„¦||f||Ïƒ
m,p,â„¦.
Also, if L âˆˆL (W m,p (â„¦) , W m,p (â„¦)) for all m = 0, 1, Â· Â· Â·, and L â—¦DÎ± = DÎ± â—¦L on
CâˆžÂ¡
â„¦
Â¢
, then L âˆˆL (W m+Ïƒ,p (â„¦) , W m+Ïƒ,p (â„¦)) for any m = 0, 1, Â· Â· Â·.
Proof: Recall from above, W 1âˆ’Î¸,p (â„¦) â‰¡T
Â¡
W 1,p (â„¦) , Lp (â„¦) , p, Î¸
Â¢
. Therefore,
from Theorem 46.9, if f âˆˆW 1,p (â„¦) ,
||f||1âˆ’Î¸,p,â„¦â‰¤K ||f||Î¸
1,p,â„¦||f||1âˆ’Î¸
0,p,â„¦
Therefore,
||f||m+Ïƒ,p,â„¦
â‰¤
ï£«
ï£­||f||p
m,p,â„¦+
X
|Î±|=m
K
Â³
||DÎ±f||1âˆ’Ïƒ
1,p,â„¦||DÎ±f||Ïƒ
0,p,â„¦
Â´p
ï£¶
ï£¸
1/p
â‰¤
C
h
||f||p
m,p,â„¦+
Â³
||f||1âˆ’Ïƒ
m+1,p,â„¦||f||Ïƒ
m,p,â„¦
Â´pi1/p
â‰¤
C
hÂ³
||f||1âˆ’Ïƒ
m+1,p,â„¦||f||Ïƒ
m,p,â„¦
Â´p
+
Â³
||f||1âˆ’Ïƒ
m+1,p,â„¦||f||Ïƒ
m,p,â„¦
Â´pi1/p
â‰¤
C ||f||1âˆ’Ïƒ
m+1,p,â„¦||f||Ïƒ
m,p,â„¦.
This proves the ï¬rst part. Now we consider the second. Let Ï† âˆˆCâˆžÂ¡
â„¦
Â¢
||LÏ†||m+Ïƒ,p,â„¦=
ï£«
ï£­||LÏ†||p
m,p,â„¦+
X
|Î±|=m
||DÎ±LÏ†||p
Ïƒ,p,â„¦
ï£¶
ï£¸
1/p
=
ï£«
ï£­||LÏ†||p
m,p,â„¦+
X
|Î±|=m
||LDÎ±Ï†||p
T (W 1,p,Lp,p,1âˆ’Ïƒ)
ï£¶
ï£¸
1/p
=
ï£«
ï£­||LÏ†||p
m,p,â„¦+
X
|Î±|=m
h
inf
Â³Â¯Â¯Â¯Â¯t1âˆ’ÏƒLfÎ±
Â¯Â¯Â¯Â¯Ïƒ
1
Â¯Â¯Â¯Â¯t1âˆ’ÏƒLf â€²
Î±
Â¯Â¯Â¯Â¯1âˆ’Ïƒ
2
Â´ip
ï£¶
ï£¸
1/p
(47.6)
where
inf
Â³Â¯Â¯Â¯Â¯t1âˆ’ÏƒLfÎ±
Â¯Â¯Â¯Â¯Ïƒ
1
Â¯Â¯Â¯Â¯t1âˆ’ÏƒLf â€²
Î±
Â¯Â¯Â¯Â¯1âˆ’Ïƒ
2
Â´
=
inf
Â³Â¯Â¯Â¯Â¯t1âˆ’ÏƒLfÎ±
Â¯Â¯Â¯Â¯Ïƒ
Lp(0,âˆž; dt
t ;W 1,p(â„¦))
Â¯Â¯Â¯Â¯t1âˆ’ÏƒLf â€²
Î±
Â¯Â¯Â¯Â¯1âˆ’Ïƒ
Lp(0,âˆž; dt
t ;Lp(â„¦))
Â´
,

47.3.
FRACTIONAL ORDER SOBOLEV SPACES
1297
fÎ± (0) â‰¡limtâ†’0 fÎ± (t) = DÎ±Ï† in W 1,p (â„¦) + Lp (â„¦) , and the inï¬mum is taken over
all such functions. Therefore, from 47.6, and letting ||L||1 denote the operator norm
of L in W 1,p (â„¦) and ||L||2 denote the operator norm of L in Lp (â„¦) ,
||LÏ†||m+Ïƒ,p,â„¦
â‰¤
ï£«
ï£­||LÏ†||p
m,p,â„¦+
X
|Î±|=m
h
inf
Â³
||L||Ïƒ
1 ||L||1âˆ’Ïƒ
2
Â¯Â¯Â¯Â¯t1âˆ’ÏƒfÎ±
Â¯Â¯Â¯Â¯Ïƒ
1
Â¯Â¯Â¯Â¯t1âˆ’Ïƒf â€²
Î±
Â¯Â¯Â¯Â¯1âˆ’Ïƒ
2
Â´ip
ï£¶
ï£¸
1/p
â‰¤
ï£«
ï£­||LÏ†||p
m,p,â„¦+
Â³
||L||Ïƒ
1 ||L||1âˆ’Ïƒ
2
Â´p X
|Î±|=m
h
inf
Â³Â¯Â¯Â¯Â¯t1âˆ’ÏƒfÎ±
Â¯Â¯Â¯Â¯Ïƒ
1
Â¯Â¯Â¯Â¯t1âˆ’Ïƒf â€²
Î±
Â¯Â¯Â¯Â¯1âˆ’Ïƒ
2
Â´ip
ï£¶
ï£¸
1/p
â‰¤
C
ï£«
ï£­||Ï†||p
m,p,â„¦+
X
|Î±|=m
h
||DÎ±Ï†||Ïƒ,p,â„¦
ip
ï£¶
ï£¸
1/p
= C ||Ï†||m+Ïƒ,p,â„¦.
Since CâˆžÂ¡
â„¦
Â¢
is dense in all the Sobolev spaces, this inequality establishes the
desired result.
Deï¬nition 47.11 We deï¬ne for s â‰¥0, W âˆ’s,pâ€² (Rn) to be the dual space of
W s,p (Rn) .
Here 1
p + 1
pâ€² = 1.
Note that in the case of m = 0 this is consistent with the Riesz representation
theorem for the Lp spaces.

1298
TRACES OF SOBOLEV SPACES AND FRACTIONAL ORDER SPACES

Sobolev Spaces On Manifolds
48.1
Basic Deï¬nitions
We will be considering the following situation. We have a set, Î“ âŠ†Rm where m > n,
mappings, hi : Ui â†’Î“i = Î“ âˆ©Wi for Wi an open set in Rmwith Î“ âŠ†âˆªl
i=1Wi and
Ui is an open subset of Rn. We assume hi is of the form
hi (x) = Hi (x, 0)
(48.1)
where for some open set, Oi, Hi : Ui Ã— Oi â†’Wi is bilipschitz having bilipschitz
inverse such that for G = Hi or Hâˆ’1
i , DÎ±G is Lipschitz for |Î±| â‰¤k.
For example, we could let m = n + 1 and let
Hi (x,y) =
Âµ
x
Ï† (x) + y
Â¶
where Ï† is a Lipschitz function having DÎ±Ï† Lipschitz for all |Î±| â‰¤k. This is an
example of the sort of thing just described, letting x âˆˆUi âŠ†Rn and Oi = R,
becuase it is obvious the inverse of Hi is given by
Hâˆ’1
i
(x, y) =
Âµ
x
y âˆ’Ï† (x)
Â¶
.
We will also let {Ïˆi}l
i=1 be a partition of unity subordinate to the open cover {Wi}
satisfying Ïˆi âˆˆCâˆž
c (Wi) . Then we give the following deï¬nition.
Deï¬nition 48.1 We say u âˆˆW s,p (Î“) if whenever {Wi, Ïˆi, Î“i, Ui, hi, Hi}l
i=1 is
described above, hâˆ—
i (uÏˆi) âˆˆW s,p (Ui) . We deï¬ne the norm as
||u||s,p,Î“ â‰¡
l
X
i=1
||hâˆ—
i (uÏˆi)||s,p,Ui
It is not at all obvious this norm is well deï¬ned. What if
{W â€²
i, Ï†i, Î“i, Vi, gi, Gi}r
i=1
is as described above. Would the two norms be equivalent? To begin with we show
the following lemma which involves a particular choice for {Wi, Ïˆi, Î“i, Ui, hi, Hi}l
i=1 .
1299

1300
SOBOLEV SPACES ON MANIFOLDS
Lemma 48.2 W s,p (Î“) as just described, is a reï¬‚exive Banach space.
Proof: Let L : W s,p (Î“) â†’Ql
i=1 W s,p (Ui) be deï¬ned by (Lu)i â‰¡hâˆ—
i (uÏˆi) .
Let {uj}âˆž
j=1 be a Cauchy sequence in W s,p (Î“) . Then {hâˆ—
i (ujÏˆi)}âˆž
j=1 is a Cauchy
sequence in W s,p (Ui) for each i. Therefore, for each i, there exists wi âˆˆW s,p (Ui)
such that
lim
jâ†’âˆžhâˆ—
i (ujÏˆi) = wi in W s,p (Ui) .
But also, we may take a subsequence such that
(
l
X
i=1
hâˆ—
i (ujÏˆi) (x)
)âˆž
j=1
= {uj (h (x))}âˆž
j=1
converges for a.e. x. Since h maps sets of measure zero to sets of n dimensional
Hausdorï¬€measure zero, it follows that for a.e. y âˆˆÎ“,
uj (y) â†’u (y) a.e.
Therefore, wi (x) = hâˆ—
i (uÏˆi) (x) a.e. and this shows hâˆ—
i (uÏˆi) âˆˆW s,p (Ui) . Thus
u âˆˆW s,p (Î“) and this shows completness. It is clear ||Â·||s,p,Î“ is a norm. Thus L is
an isometry of W s,p (Î“) and a closed subspace of Ql
i=1 W s,p (Ui) so this proves the
lemma since by Corollary 47.7, W s,p (Ui) is reï¬‚exive.
We now show that any two such norms are equivalent.
Suppose
Â©
W â€²
j, Ï†j, Î“j, Vj, gj, Gj
Âªr
j=1and {Wi, Ïˆi, Î“i, Ui, hi, Hi}l
i=1 both satisfy
the conditions described above. Let ||Â·||1
s,p,Î“ denote the norm deï¬ned by
||u||1
s,p,Î“ â‰¡
r
X
j=1
Â¯Â¯Â¯Â¯gâˆ—
j
Â¡
uÏ†j
Â¢Â¯Â¯Â¯Â¯
s,p,Vj
â‰¤
r
X
j=1
Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯gâˆ—
j
Ãƒ
l
X
i=1
uÏ†jÏˆi
!Â¯Â¯Â¯Â¯Â¯
Â¯Â¯Â¯Â¯Â¯
s,p,Vj
â‰¤
X
j,i
Â¯Â¯Â¯Â¯gâˆ—
j
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,Vj
=
X
j,i
Â¯Â¯Â¯Â¯gâˆ—
j
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,gâˆ’1
j (Wiâˆ©W â€²
j)
(48.2)
Now we may deï¬ne a new norm ||u||1,g
s,p,Î“ by the formula 48.2. This norm is deter-
mined by
Â©
W â€²
j âˆ©Wi, ÏˆiÏ†j, Î“j âˆ©Î“i, Vj, gi,j, Gi,j
Âª
where gi,j = gj. Thus the identity map is continuous from
Â³
W s,p (Î“) , ||Â·||1,g
s,p,Î“
Â´
to
Â³
W s,p (Î“) , ||Â·||1
s,p,Î“
Â´
. It follows the two norms, ||Â·||1,g
s,p,Î“ and ||Â·||1
s,p,Î“ , are equivalent
by the open mapping theorem. In a similar way, the norms, ||Â·||2,h
s,p,Î“ and ||Â·||2
s,p,Î“
are equivalent where
||u||2
s,p,Î“ â‰¡
l
X
j=1
||hâˆ—
i (uÏˆi)||s,p,Ui

48.2.
THE TRACE ON THE BOUNDARY OF AN OPEN SET
1301
and
||u||2,h
s,p,Î“ â‰¡
X
j,i
Â¯Â¯Â¯Â¯hâˆ—
i
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,Ui . =
X
j,i
Â¯Â¯Â¯Â¯hâˆ—
i
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,hâˆ’1
i (Wiâˆ©W â€²
j)
But from the assumptions on h and g, in particular the assumption that these
are restrictions of functions which are deï¬ned on open subsets of Rm which have
Lipschitz derivatives up to order k along with their inverses, we know from Theorem
47.9, there exist constants Ci, independent of u such that
Â¯Â¯Â¯Â¯hâˆ—
i
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,hâˆ’1
i (Wiâˆ©W â€²
j) â‰¤C1
Â¯Â¯Â¯Â¯gâˆ—
j
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,gâˆ’1
j (Wiâˆ©W â€²
j)
and
Â¯Â¯Â¯Â¯gâˆ—
j
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,gâˆ’1
j (Wiâˆ©W â€²
j) â‰¤C2
Â¯Â¯Â¯Â¯hâˆ—
i
Â¡
uÏ†jÏˆi
Â¢Â¯Â¯Â¯Â¯
s,p,hâˆ’1
i (Wiâˆ©W â€²
j) .
Therefore, the two norms, ||Â·||1,g
s,p,Î“ and ||Â·||2,h
s,p,Î“ are equivalent. It follows that the
norms, ||Â·||2
s,p,Î“ and ||Â·||1
s,p,Î“ are equivalent. This proves the following theorem.
Theorem 48.3 Let Î“ be described above.
Then we may deï¬ne W s,p (Î“) as in
Deï¬nition 41.36 and any two norms like those given in this deï¬nition are equivalent.
48.2
The Trace On The Boundary Of An Open Set
Next we generalize earlier theorems about the loss of 1
p derivatives on the boundary.
Deï¬nition 48.4 We deï¬ne
Rnâˆ’1
k
â‰¡{x âˆˆRn : xk = 0} , bxk â‰¡(x1, Â· Â· Â·, xkâˆ’1, 0, xk+1, Â· Â· Â·, xn) .
We will say an open set, â„¦is Cm,1 if there exist open sets, Wi, i = 0, 1, Â· Â· Â·, l such
that
â„¦= âˆªl
i=0Wi
with W0 âŠ†â„¦, open sets Ui âŠ†Rnâˆ’1
k
for some k, and open intervals, (ai, bi) containing
0 such that for i â‰¥1,
âˆ‚â„¦âˆ©Wi = {bxk + Ï†i (bxk) ek : bxk âˆˆUi} ,
â„¦âˆ©Wi = {bxk + (Ï†i (bxk) + xk) ek : (bxk, xk) âˆˆUi Ã— (0, bi)} ,
where Ï†i is Lipschitz with partial derivatives up to order m also Lipschitz. Note
that it makes no diï¬€erence whether we use (0, bi) or (ai, 0) in the last part of this
deï¬nition since we can go from one to the other by a simple change if the Ï†i.
Assume â„¦âˆˆCmâˆ’1,1. Then, if we deï¬ne
hi (bxk) = bxk + Ï†i (bxk) ek, Hi (x) â‰¡bxk + (Ï†i (bxk) + xk) ek,

1302
SOBOLEV SPACES ON MANIFOLDS
and let Ïˆi âˆˆCâˆž
c (Wi) with Pl
i=0 Ïˆi (x) = 1 on â„¦, we see that
{Wi, Ïˆi, âˆ‚â„¦âˆ©Wi, Ui, hi, Hi}l
i=1
satisï¬es all the conditions for deï¬ning W s,p (âˆ‚â„¦) for s â‰¤m. Let u âˆˆCâˆžÂ¡
â„¦
Â¢
and
let hi be as just described. Using Theorem 47.8, and Theorem 40.14,
||Î³u||mâˆ’1
p ,p,âˆ‚â„¦=
l
X
i=1
||hâˆ—
i (ÏˆiÎ³u)||mâˆ’1
p ,p,Ui
=
l
X
i=1
||hâˆ—
i (ÏˆiÎ³u)||mâˆ’1
p ,p,Rnâˆ’1
k
â‰¤C
l
X
i=1
||Hâˆ—
i (Ïˆiu)||m,p,Rn
+
â‰¤C
l
X
i=1
||Hâˆ—
i (Ïˆiu)||m,p,UiÃ—(0,bi) â‰¤C
l
X
i=1
||(Ïˆiu)||m,p,Wiâˆ©â„¦
â‰¤C
l
X
i=1
||(Ïˆiu)||m,p,â„¦â‰¤C
l
X
i=1
||u||m,p,â„¦â‰¤Cl ||u||m,p,â„¦.
Now we use the density of CâˆžÂ¡
â„¦
Â¢
in W m,p (â„¦) to see that Î³ extends to a continuous
linear map deï¬ned on W m,p (â„¦) still called Î³ such that for all u âˆˆW m,p (â„¦) ,
||Î³u||mâˆ’1
p ,p,âˆ‚â„¦â‰¤Cl ||u||m,p,â„¦.
(48.3)
In addition to this, in the case where m = 1, we may use Lemma 47.5 to obtain a
continuous linear map, R, from W 1âˆ’1
p ,p (âˆ‚â„¦) to W 1,p (â„¦) which has the property
that Î³Rg = g for every g âˆˆW 1âˆ’1
p ,p (âˆ‚â„¦) . Letting g âˆˆW 1âˆ’1
p ,p (âˆ‚â„¦) ,
g =
l
X
i=1
Ïˆig.
Then also,
hâˆ—
i (Ïˆig) âˆˆW 1âˆ’1
p ,p Â¡
Rnâˆ’1Â¢
and so from Lemma 47.5, we can extend this to W 1,p Â¡
Rn
+
Â¢
, Rhâˆ—
i (Ïˆig) . We may also
assume that Rhâˆ—
i (Ïˆig) âˆˆW 1,p (Ui Ã— (0, bi)) . We can accomplish this by multiplying
by a suitable cut oï¬€function in the deï¬nition of R or else adjusting the function, Ïˆ
occuring in the proof of this lemma so that it vanishes oï¬€(0, bi) . Then our extension
is
Rg =
l
X
i=1
Â¡
Hâˆ’1
i
Â¢âˆ—Rhâˆ—
i (Ïˆig) .

48.2.
THE TRACE ON THE BOUNDARY OF AN OPEN SET
1303
This works because
Î³Rg
â‰¡
l
X
i=1
Î³
Â¡
Hâˆ’1
i
Â¢âˆ—Rhâˆ—
i (Ïˆig)
=
l
X
i=1
Â¡
Hâˆ’1
i
Â¢âˆ—Î³Rhâˆ—
i (Ïˆig)
=
l
X
i=1
Â¡
Hâˆ’1
i
Â¢âˆ—hâˆ—
i (Ïˆig) = g.
This proves the following theorem about the trace.
Theorem 48.5 Let â„¦âˆˆCm,1. Then there exists a constant, C independent of
u âˆˆW m,p (â„¦) and a continuous linear map, Î³ : W m,p (â„¦) â†’W mâˆ’1
p ,p (âˆ‚â„¦) such that
48.3 holds. This map satisï¬es Î³u (x) = u (x) for all u âˆˆCâˆžÂ¡
â„¦
Â¢
. In the case where
m = 1, we obtain also the existence of a continuous linear map, R : W 1âˆ’1
p ,p (âˆ‚â„¦) â†’
W 1,p (â„¦) which has the property that Î³Rg = g for all g âˆˆW 1âˆ’1
p ,p (âˆ‚â„¦).

1304
SOBOLEV SPACES ON MANIFOLDS

The Hausdorï¬€Maximal
Theorem
The purpose of this appendix is to prove the equivalence between the axiom of
choice, the Hausdorï¬€maximal theorem, and the well-ordering principle. The Haus-
dorï¬€maximal theorem and the well-ordering principle are very useful but a little
hard to believe; so, it may be surprising that they are equivalent to the axiom of
choice. First it is shown that the axiom of choice implies the Hausdorï¬€maximal
theorem, a remarkable theorem about partially ordered sets.
A nonempty set is partially ordered if there exists a partial order, â‰º, satisfying
x â‰ºx
and
if x â‰ºy and y â‰ºz then x â‰ºz.
An example of a partially ordered set is the set of all subsets of a given set and
â‰ºâ‰¡âŠ†. Note that two elements in a partially ordered sets may not be related. In
other words, just because x, y are in the partially ordered set, it does not follow
that either x â‰ºy or y â‰ºx. A subset of a partially ordered set, C, is called a chain
if x, y âˆˆC implies that either x â‰ºy or y â‰ºx. If either x â‰ºy or y â‰ºx then x and
y are described as being comparable. A chain is also called a totally ordered set. C
is a maximal chain if whenever eC is a chain containing C, it follows the two chains
are equal. In other words C is a maximal chain if there is no strictly larger chain.
Lemma A.1 Let F be a nonempty partially ordered set with partial order â‰º. Then
assuming the axiom of choice, there exists a maximal chain in F.
Proof: Let X be the set of all chains from F. For C âˆˆX, let
SC = {x âˆˆF such that Câˆª{x} is a chain strictly larger than C}.
If SC = âˆ…for any C, then C is maximal. Thus, assume SC Ì¸= âˆ…for all C âˆˆX. Let
f(C) âˆˆSC. (This is where the axiom of choice is being used.) Let
g(C) = C âˆª{f(C)}.
1305

1306
THE HAUSDORFF MAXIMAL THEOREM
Thus g(C) âŠ‹C and g(C) \ C ={f(C)} = {a single element of F}. A subset T of X
is called a tower if
âˆ…âˆˆT ,
C âˆˆT implies g(C) âˆˆT ,
and if S âŠ†T is totally ordered with respect to set inclusion, then
âˆªS âˆˆT .
Here S is a chain with respect to set inclusion whose elements are chains.
Note that X is a tower. Let T0 be the intersection of all towers. Thus, T0 is a
tower, the smallest tower. Are any two sets in T0 comparable in the sense of set
inclusion so that T0 is actually a chain? Let C0 be a set of T0 which is comparable
to every set of T0. Such sets exist, âˆ…being an example. Let
B â‰¡{D âˆˆT0 : D âŠ‹C0 and f (C0) /âˆˆD} .
The picture represents sets of B. As illustrated in the picture, D is a set of B when
D is larger than C0 but fails to be comparable to g (C0). Thus there would be more
than one chain ascending from C0 if B Ì¸= âˆ…, rather like a tree growing upward in
more than one direction from a fork in the trunk. It will be shown this canâ€™t take
place for any such C0 by showing B = âˆ….
C0
D
f(C0)
Â·
This will be accomplished by showing eT0 â‰¡T0 \ B is a tower. Since T0 is the
smallest tower, this will require that eT0 = T0 and so B = âˆ….
Claim: eT0 is a tower and so B = âˆ….
Proof of the claim: It is clear that âˆ…âˆˆeT0 because for âˆ…to be contained in B
it would be required to properly contain C0 which is not possible. Suppose D âˆˆeT0.
The plan is to verify g (D) âˆˆeT0.
Case 1: f (D) âˆˆC0. If D âŠ†C0, then since both D and {f (D)} are contained in
C0, it follows g (D) âŠ†C0 and so g (D) /âˆˆB. On the other hand, if D âŠ‹C0, then since
D âˆˆeT0, f (C0) âˆˆD and so g (D) also contains f (C0) implying g (D) /âˆˆB. These are
the only two cases to consider because C0 is comparable to every set of T0.
Case 2: f (D) /âˆˆC0. If D âŠŠC0 it canâ€™t be the case that f (D) /âˆˆC0 because if
this were so, g (D ) would not compare to C0.
D
C0
f(C0)
Â·
f(D)
Â·
Hence if f (D) /âˆˆC0, then D âŠ‡C0. If D = C0, then f (D) = f (C0) âˆˆg (D) so

1307
g (D) /âˆˆB. Therefore, assume D âŠ‹C0. Then, since D is in eT0, f (C0) âˆˆD and so
f (C0) âˆˆg (D). Therefore, g (D) âˆˆeT0.
Now suppose S is a totally ordered subset of eT0 with respect to set inclusion.
Then if every element of S is contained in C0, so is âˆªS and so âˆªS âˆˆeT0. If, on
the other hand, some chain from S, C, contains C0 properly, then since C /âˆˆB,
f (C0) âˆˆC âŠ†âˆªS showing that âˆªS /âˆˆB also. This has proved eT0 is a tower and
since T0 is the smallest tower, it follows eT0 = T0. This has shown roughly that no
splitting into more than one ascending chain can occur at any C0 which is comparable
to every set of T0. Next it is shown that every element of T0 has the property that
it is comparable to all other elements of T0. This is done by showing that these
elements which possess this property form a tower.
Deï¬ne T1 to be the set of all elements of T0 which are comparable to every
element of T0. (Recall the elements of T0 are chains from the original partial order.)
Claim: T1 is a tower.
Proof of the claim: It is clear that âˆ…âˆˆT1 because âˆ…is a subset of every set.
Suppose C0 âˆˆT1. It is necessary to verify that g (C0) âˆˆT1. Let D âˆˆT0 (Thus D âŠ†C0
or else D âŠ‹C0.)and consider g (C0) â‰¡C0 âˆª{f (C0)}. If D âŠ†C0, then D âŠ†g (C0)
so g (C0) is comparable to D. If D âŠ‹C0, then D âŠ‡g (C0) by what was just shown
(B = âˆ…). Hence g (C0) is comparable to D. Since D was arbitrary, it follows g (C0)
is comparable to every set of T0. Now suppose S is a chain of elements of T1 and
let D be an element of T0. If every element in the chain, S is contained in D, then
âˆªS is also contained in D. On the other hand, if some set, C, from S contains D
properly, then âˆªS also contains D. Thus âˆªS âˆˆT 1 since it is comparable to every
D âˆˆT0.
This shows T1 is a tower and proves therefore, that T0 = T1. Thus every set of
T0 compares with every other set of T0 showing T0 is a chain in addition to being a
tower.
Now âˆªT0, g (âˆªT0) âˆˆT0. Hence, because g (âˆªT0) is an element of T0, and T0 is a
chain of these, it follows g (âˆªT0) âŠ†âˆªT0. Thus
âˆªT0 âŠ‡g (âˆªT0) âŠ‹âˆªT0,
a contradiction. Hence there must exist a maximal chain after all. This proves the
lemma.
If X is a nonempty set,â‰¤is an order on X if
x â‰¤x,
and if x, y âˆˆX, then
either x â‰¤y or y â‰¤x
and
if x â‰¤y and y â‰¤z then x â‰¤z.
â‰¤is a well order and say that (X, â‰¤) is a well-ordered set if every nonempty subset
of X has a smallest element. More precisely, if S Ì¸= âˆ…and S âŠ†X then there exists
an x âˆˆS such that x â‰¤y for all y âˆˆS. A familiar example of a well-ordered set is
the natural numbers.

1308
THE HAUSDORFF MAXIMAL THEOREM
Lemma A.2 The Hausdorï¬€maximal principle implies every nonempty set can be
well-ordered.
Proof: Let X be a nonempty set and let a âˆˆX. Then {a} is a well-ordered
subset of X. Let
F = {S âŠ†X : there exists a well order for S}.
Thus F Ì¸= âˆ…. For S1, S2 âˆˆF, deï¬ne S1 â‰ºS2 if S1 âŠ†S2 and there exists a well
order for S2, â‰¤2 such that
(S2, â‰¤2) is well-ordered
and if
y âˆˆS2 \ S1 then x â‰¤2 y for all x âˆˆS1,
and if â‰¤1is the well order of S1 then the two orders are consistent on S1. Then
observe that â‰ºis a partial order on F. By the Hausdorï¬€maximal principle, let C
be a maximal chain in F and let
Xâˆžâ‰¡âˆªC.
Deï¬ne an order, â‰¤, on Xâˆžas follows. If x, y are elements of Xâˆž, pick S âˆˆC such
that x, y are both in S. Then if â‰¤S is the order on S, let x â‰¤y if and only if x â‰¤S y.
This deï¬nition is well deï¬ned because of the deï¬nition of the order, â‰º. Now let U
be any nonempty subset of Xâˆž. Then S âˆ©U Ì¸= âˆ…for some S âˆˆC. Because of the
deï¬nition of â‰¤, if y âˆˆS2 \S1, Si âˆˆC, then x â‰¤y for all x âˆˆS1. Thus, if y âˆˆXâˆž\S
then x â‰¤y for all x âˆˆS and so the smallest element of S âˆ©U exists and is the
smallest element in U. Therefore Xâˆžis well-ordered. Now suppose there exists
z âˆˆX \ Xâˆž. Deï¬ne the following order, â‰¤1, on Xâˆžâˆª{z}.
x â‰¤1 y if and only if x â‰¤y whenever x, y âˆˆXâˆž
x â‰¤1 z whenever x âˆˆXâˆž.
Then let
eC = {S âˆˆC or Xâˆžâˆª{z}}.
Then eC is a strictly larger chain than C contradicting maximality of C. Thus X \
Xâˆž= âˆ…and this shows X is well-ordered by â‰¤. This proves the lemma.
With these two lemmas the main result follows.
Theorem A.3 The following are equivalent.
The axiom of choice
The Hausdorï¬€maximal principle
The well-ordering principle.

A.1.
EXERCISES
1309
Proof: It only remains to prove that the well-ordering principle implies the
axiom of choice. Let I be a nonempty set and let Xi be a nonempty set for each
i âˆˆI. Let X = âˆª{Xi : i âˆˆI} and well order X. Let f (i) be the smallest element
of Xi. Then
f âˆˆ
Y
iâˆˆI
Xi.
A.1
Exercises
1. Zornâ€™s lemma states that in a nonempty partially ordered set, if every chain
has an upper bound, there exists a maximal element, x in the partially ordered
set. x is maximal, means that if x â‰ºy, it follows y = x. Show Zornâ€™s lemma
is equivalent to the Hausdorï¬€maximal theorem.
2. Let X be a vector space. Y âŠ†X is a Hamel basis if every element of X can be
written in a unique way as a ï¬nite linear combination of elements in Y . Show
that every vector space has a Hamel basis and that if Y, Y1 are two Hamel
bases of X, then there exists a one to one and onto map from Y to Y1.
3. â†‘Using the Baire category theorem of the chapter on Banach spaces show
that any Hamel basis of a Banach space is either ï¬nite or uncountable.
4. â†‘Consider the vector space of all polynomials deï¬ned on [0, 1]. Does there
exist a norm, ||Â·|| deï¬ned on these polynomials such that with this norm, the
vector space of polynomials becomes a Banach space (complete normed vector
space)?

1310
THE HAUSDORFF MAXIMAL THEOREM

Bibliography
[1] Adams R. Sobolev Spaces, Academic Press, New York, San Francisco, London,
1975.
[2] Alfors, Lars Complex Analysis, McGraw Hill 1966.
[3] Apostol, T. M., Mathematical Analysis,
Addison Wesley Publishing Co.,
1969.
[4] Apostol, T. M., Calculus second edition, Wiley, 1967.
[5] Apostol, T. M., Mathematical Analysis,
Addison Wesley Publishing Co.,
1974.
[6] Ash, Robert, Complex Variables, Academic Press, 1971.
[7] Baker, Roger, Linear Algebra, Rinton Press 2001.
[8] Bergh J. and LÂ¨ofstrÂ¨om J. Interpolation Spaces, Springer Verlag 1976.
[9] Billingsley P., Probability and Measure, Wiley, 1995.
[10] Bledsoe W.W., Am. Math. Monthly vol. 77, PP. 180-182 1970.
[11] Bogachev Vladimir I. Gaussian Measures American Mathematical Society
Mathematical Surveys and Monographs, volume 62 1998.
[12] Bruckner A. , Bruckner J., and Thomson B., Real Analysis
Prentice
Hall 1997.
[13] Conway J. B. Functions of one Complex variable Second edition, Springer
Verlag 1978.
[14] Cheney, E. W., Introduction To Approximation Theory, McGraw Hill 1966.
[15] Da Prato, G. and Zabczyk J., Stochastic Equations in Inï¬nite Dimensions,
Cambridge 1992.
[16] Diestal J. and Uhl J.,
Vector Measures, American Math. Society, Provi-
dence, R.I., 1977.
1311

1312
BIBLIOGRAPHY
[17] Dontchev A.L. The Graves theorem Revisited, Journal of Convex Analysis,
Vol. 3, 1996, No.1, 45-53.
[18] Dunford N. and Schwartz J.T. Linear Operators, Interscience Publishers,
a division of John Wiley and Sons, New York, part 1 1958, part 2 1963, part 3
1971.
[19]
Duvaut, G. and Lions, J. L.,
Inequalities in Mechanics and Physics,
Springer-Verlag, Berlin, 1976.
[20] Evans L.C. and Gariepy, Measure Theory and Fine Properties of Functions,
CRC Press, 1992.
[21] Evans L.C. Partial Diï¬€erential Equations, Berkeley Mathematics Lecture
Notes. 1993.
[22] Federer H., Geometric Measure Theory, Springer-Verlag, New York, 1969.
[23] Gagliardo, E., Properieta di alcune classi di funzioni in piu variabili, Ricerche
Mat. 7 (1958), 102-137.
[24] Grisvard, P. Elliptic problems in nonsmooth domains, Pittman 1985.
[25] Gross L. Abstract Wiener Spaces, Proc. ï¬fth Berkeley Sym. Math. Stat. Prob.
1965.
[26] Hewitt E. and Stromberg K. Real and Abstract Analysis, Springer-Verlag,
New York, 1965.
[27] Hille Einar, Analytic Function Theory, Ginn and Company 1962.
[28] HÂ¨ormander, Lars Linear Partial Diï¬€errential Operators, Springer Verlag,
1976.
[29] HÂ¨ormander L. Estimates for translation invariant operators in Lp spaces,
Acta Math. 104 1960, 93-139.
[30] Hui-Hsiung Kuo Gaussian Measures in Banach Spaces Lecture notes in
Mathematics Springer number 463 1975.
[31] John, Fritz, Partial Diï¬€erential Equations, Fourth edition, Springer Verlag,
1982.
[32] Jones F., Lebesgue Integration on Euclidean Space, Jones and Bartlett 1993.
[33] Karatzas and Shreve, Brownian Motion and Stochastic Calculus, Springer
Verlag, 1991.
[34] Kuratowski K. and Ryll-Nardzewski C. A general theorem on selectors,
Bull. Acad. Pol. Sc., 13, 397-403.
[35] Kuttler K.L. Basic Analysis. Rinton Press. November 2001.

BIBLIOGRAPHY
1313
[36] Kuttler K.L., Modern Analysis CRC Press 1998.
[37] Levinson, N. and Redheï¬€er, R. Complex Variables, Holden Day, Inc. 1970
[38] Liptser, R.S. Nd Shiryaev, A. N. Statistics of Random Processes. Vol I
General theory. Springer Verlag, New York 1977.
[39] Markushevich, A.I., Theory of Functions of a Complex Variable, Prentice
Hall, 1965.
[40] McShane E. J. Integration, Princeton University Press, Princeton, N.J. 1944.
[41] NeË‡cas J. and HlavÂ´aË‡cek, Mathematical Theory of Elasic and Elasto-Plastic
Bodies: An introduction, Elsevier, 1981.
[42] Ã˜ksendal Bernt Stochastic Diï¬€erential Equations, Springer 2003.
[43] Ray W.O. Real Analysis, Prentice-Hall, 1988.
[44] Rudin, W., Principles of mathematical analysis, McGraw Hill third edition
1976
[45] Rudin W. Real and Complex Analysis, third edition, McGraw-Hill, 1987.
[46] Rudin W. Functional Analysis, second edition, McGraw-Hill, 1991.
[47] Saks and Zygmund, Analytic functions, 1952. (This book is available on the
web. http://www.geocities.com/alex stef/mylist.html#FuncAn)
[48] Smart D.R. Fixed point theorems Cambridge University Press, 1974.
[49] Stein E. Singular Integrals and Diï¬€erentiability Properties of Functions.
Princeton University Press, Princeton, N. J., 1970.
[50] Triebel H. Interpolation Theory, Function Spaces and Diï¬€erential Operators,
North Holland, Amsterdam, 1978.
[51] Varga R. S. Functional Analysis and Approximation Theory in Numerical
Analysis, SIAM 1984.
[52] Yosida K. Functional Analysis, Springer-Verlag, New York, 1978.

Index
C1 functions, 118
Câˆž
c , 328
Cm
c , 328
FÏƒ sets, 172
GÎ´, 339
GÎ´ sets, 172
L1
loc, 429
Lp
compactness, 333
Lp multipliers, 546
Lp (â„¦; X), 603
Lâˆž, 335
Lp
loc, 1084
Ï€ systems, 257
Ïƒ algebra, 171
(1,p) extension operator, 1165
Abelâ€™s formula, 80
Abelâ€™s theorem, 654
absolutely continuous, 434
adapted, 903
adapted step function, 903
adjugate, 71
Alexander subbasis theorem, 306
algebra, 161
algebra of sets, 245
analytic continuation, 748, 850
Analytic functions, 641
approximate identity, 329
area formula, 470, 480, 1104
at most countable, 22
atlas, 1127
automorphic function, 836
axiom of choice, 17, 21
axiom of extension, 17
axiom of speciï¬cation, 17
axiom of unions, 17
Banach Alaoglu theorem, 355
Banach space, 319
Banach Steinhaus theorem, 341
basis of module of periods, 824
Besicovitch covering theorem, 495, 510
Besselâ€™s inequality, 380
Big Picard theorem, 763
Binet Cauchy theorem, 1133
Blaschke products, 805
Blochâ€™s lemma, 751
block matrix, 77
Bochner integrable, 586
Borel Cantelli lemma, 183
Borel measure, 215
Borel regular, 453
Borel regularity, 451
Borel sets, 171
bounded continuous linear functions,
339
bounded variation, 629
box topology, 307
branch of the logarithm, 684
Brouwer ï¬xed point theorem, 294, 369
Brownian motion, 890
Calderon Zygmund decomposition, 545
Cantor diagonalization procedure, 144
Cantor function, 446
Cantor set, 445
Caratheodory, 209
Caratheodory extension theorem, 303
Caratheodoryâ€™s criterion, 450
Caratheodoryâ€™s procedure, 210
Cartesian coordinates, 53
1314

INDEX
1315
Casorati Weierstrass theorem, 664
Cauchy
general Cauchy integral formula,
670
integral formula for disk, 649
Cauchy Riemann equations, 643
Cauchy Schwarz inequality, 92, 365
Cauchy sequence, 112
Cauchy sequence, 104
Cayley Hamilton theorem, 75
central limit theorem, 879
chain rule, 116
change of variables, 1122
change of variables general case, 290
characteristic function, 180, 1015
characteristic polynomial, 74
chart, 1127
closed graph theorem, 345
closed set, 94, 148
closure of a set, 149
Coarea formula, 1118
coarea formula, 1116
cofactor, 68
compact, 135
compact injection map, 1249
compact set, 150
complement, 94
complete measure space, 210
completion of measure space, 253
conditional expectation, 893
conformal maps, 647, 736
connected, 152
connected components, 153
continuity set, 877
continuous function, 93, 149
convergence in measure, 183
convex
set, 366
convex
functions, 333
convolution, 329, 535
convolution of measures, 1022
Coordinates, 51
correlation, 988
countable, 22
counting zeros, 694
covariance, 987
Cramerâ€™s rule, 71
cycle, 670
cylinder sets, 1036
cylindrical set, 1015
Darboux, 48
Darboux integral, 48
derivatives, 115
determinant, 63
product, 67
transpose, 65
diï¬€erentiation
Radon measures, 512
dilations, 736
Dini derivates, 447
distribution, 858, 1081
distribution function, 232, 446, 542
distributional derivative, 1241
divergence theorem, 492
dominated convergence theorem, 202,
606
Doob Dynkin lemma, 866
Doob estimate, 900
Doobâ€™s martingale estimate, 915
doubly periodic, 822
dual space, 350
duality maps, 363
Eberlein Smulian theorem, 359
Egoroï¬€theorem, 180
eigenvalues, 74, 699, 702
elementary factors, 789
elementary set, 313
elementary sets, 248
elliptic, 822
entire, 659
epsilon net, 136, 141
equality of mixed partial derivatives,
125
equivalence class, 24
equivalence relation, 23
Erlingâ€™s lemma, 1249
essential singularity, 665

1316
INDEX
Eulerâ€™s theorem, 817
exchange theorem, 56
exponential growth, 537
extended complex plane, 627
extension theorem, 1163
Fatouâ€™s lemma, 196
ï¬ltration, 903
ï¬nite intersection property, 140, 151
ï¬nite measure space, 172
Fourier series
uniform convergence, 362
Fourier transform L1, 525
fractional linear transformations, 736,
741
mapping three points, 738
Frechet derivative, 115
Fredholm alternative, 397
Fresnel integrals, 727
Fubiniâ€™s theorem, 243, 252, 261
Bochner integrable functions, 601
function, 20
uniformly continuous, 25
function element, 748, 850
functional equations, 840
fundamental theorem of algebra, 660
fundamental theorem of calculus, 47,
431, 433
general Radon measures, 503
Gamma function, 334, 457
gamma function, 811
gauge function, 347
Gaussâ€™s formula, 812
Gaussian measure, 1031
Gerschgorinâ€™s theorem, 698
Gram determinant, 373
Gram matrix, 373
Gramm Schmidt process, 82
great Picard theorem, 762
Hadamard three circles theorem, 689
Hahn Banach theorem, 348
Hardy Littlewood maximal function,
429
Hardyâ€™s inequality, 334
harmonic functions, 646
Haursdorï¬€measures, 449
Hausdorï¬€and Lebesgue measure, 456,
458
Hausdorï¬€dimension, 456
Hausdorï¬€maximal principle, 24, 271,
306, 347
Hausdorï¬€maximal theorem, 1305
Hausdorï¬€measure
translation invariant, 453
Hausdorï¬€measure and nonlinear maps,
466, 476
Hausdorï¬€measures, 449
Hausdorï¬€metric, 167
Hausdorï¬€space, 148
Heine Borel, 25
Heine Borel theorem, 138
Hermitian, 85
Hilbert Schmidt operator, 988
Hilbert Schmidt operators, 390, 988
Hilbert Schmidt theorem, 382, 597
Hilbert space, 365
Holderâ€™s inequality, 315
homotopic to a point, 781
Hormander condition, 546
implicit function theorem, 125, 128,
129
independent random vectors, 859, 990
indicator function, 180
inï¬nite products, 785
inner product space, 365
inner regular, 1000
inner regular measure, 215
interior point, 94
inverse function theorem, 129, 130
inverses and determinants, 70
inversions, 736
isogonal, 646, 735
isolated singularity, 664
isometric, 617
Ito isometry, 926
Ito representation theorem, 956
James map, 352

INDEX
1317
Jensenâ€™s formula, 802
Jensens inequality, 333, 896
Kolmogorov extension theorem, 310
Lagrange multipliers, 130, 132
Laplace expansion, 68
Laplace transform, 538
Laurent series, 716
law, 1025
Lebesgue
set, 433
Lebesgue decomposition, 399
Lebesgue measure, 267
Lebesgue point, 431
limit of a function, 98
limit point, 148
limit points, 98
linear combination, 55, 66
linearly dependent, 55
linearly independent, 55
Liouville theorem, 659
Lipschitz, 26, 97, 107
Lipschitz boundary, 485, 1105
Lipschitz manifold, 1127
Lipschitz maps
extension, 1100
little Picard theorem, 852
locally compact , 150
locally ï¬nite, 481, 1123
locally Lipschitz, 461
Lusinâ€™s theorem, 333
manifold, 1127
manifolds
radon measure, 1129
surface measure, 1129
Marcinkiewicz interpolation, 543
martingale, 896, 910
matrix
left inverse, 71
lower triangular, 71
non defective, 85
normal, 85
right inverse, 71
upper triangular, 71
maximal function
general Radon measures, 501
maximum modulus theorem, 685
mean value theorem
for integrals, 49
measurable, 209
Borel, 174
measurable function, 174
pointwise limits, 174
measurable functions
Borel, 182
combinations, 180
measurable rectangle, 248, 313
measurable representative, 612
measurable sets, 172, 210
measure space, 172
Mellin transformations, 724
meromorphic, 666
Mertenâ€™s theorem, 769
Meyer Serrin theorem, 1138
Mihlinâ€™s theorem, 558
Minkowski functional, 362
Minkowskiâ€™s inequality, 321
minor, 68
Mittag Leï¬„er, 728, 796
mixed partial derivatives, 123
modular function, 834, 836
modular group, 765, 824
module of periods, 820
molliï¬er, 329
monotone class, 247
monotone convergence theorem, 192
Montelâ€™s theorem, 739, 761
Morreyâ€™s inequality, 1087
multi-index, 97, 123, 157, 517
multipliers, 546
Muntzâ€™s ï¬rst theorem, 377
Muntzâ€™s second theorem, 378
Neumann series, 729
nonlinear Fubiniâ€™s theorem, 1122
normal, 867, 1025
normal family of functions, 741
normal topological space, 149
nowhere diï¬€erentiable functions, 360

1318
INDEX
nuclear operator, 387
one point compactiï¬cation, 150, 218
open cover, 150
open mapping theorem, 342, 681
open set, 94
open sets, 147
operator norm, 112, 339
order, 811
order of a pole, 665
order of a zero, 657
order of an elliptic function, 822
orthonormal set, 378
outer measure, 183, 209
outer regular, 1000
outer regular measure, 215
partial derivative, 118
partial order, 24, 346
partially ordered set, 1305
partition, 33
partition of unity, 220, 482, 1125
period parallelogram, 822
Pettis theorem, 580
Phragmen Lindelof theorem, 687
pi systems, 257
pivot space, 1245
Plancherel theorem, 529
point of density, 464, 474, 1093
pointwise limits of measurable func-
tions, 581
polar decomposition, 411
pole, 665
polynomial, 157, 517
positive and negative parts of a mea-
sure, 441
positive linear functional, 221
power series
analytic functions, 653
power set, 17
precompact, 150, 167, 1249
primitive, 637
principal branch of logarithm, 685
principal ideal, 800
probability space, 857
product measure, 251
product rule, 1086
product topology, 150
projection in Hilbert space, 368
Prokhorovâ€™s theorem, 1004
properties of integral
properties, 45
quotient space, 1276
Rademacherâ€™s theorem, 1090, 1092
Radon Nikodym derivative, 402
Radon Nikodym property, 614
Radon Nikodym Theorem
Ïƒ ï¬nite measures, 402
ï¬nite measures, 399
Radon Nikodym theorem
Radon Measures, 515
random variable, 446, 857
random vector, 857
independent, 862
rank of a matrix, 72
real Schur form, 83
reï¬‚exive Banach Space, 353
reï¬‚exive Banach space, 419
region, 657
regular measure, 215
regular topological space, 148
removable singularity, 664
reproducing kernel space, 1063
residue, 705
resolvent set, 729
Riemann criterion, 37
Riemann integrable, 36
Riemann integral, 36
Riemann sphere, 627
Riemann Stieltjes integral, 36
Riesz map, 371
Riesz representation theorem, 619
C0 (X), 423
Hilbert space, 370
locally compact Hausdorï¬€space,
221
Riesz Representation theorem
C (X), 422

INDEX
1319
Riesz representation theorem Lp
ï¬nite measures, 412
Riesz representation theorem Lp
Ïƒ ï¬nite case, 418
Riesz representation theorem for L1
ï¬nite measures, 416
right polar decomposition, 87
Roucheâ€™s theorem, 711
Rungeâ€™s theorem, 774
Sardâ€™s lemma, 287
scalars, 53, 93
Schottkyâ€™s theorem, 759
Schroder Bernstein theorem, 21
Schwartz class, 1173
Schwarz formula, 655
Schwarz reï¬‚ection principle, 679
Schwarzâ€™s lemma, 742
self adjoint, 85
separability of C(H), 1004
separated, 152
separation theorem, 363
sequential compactness, 25
sequential weak* compactness, 357
sequentially compact set, 110
sets, 17
Shannon sampling theorem, 540
simple function, 187, 577
simple functions, 175
Skorokhodâ€™s theorem, 1008
Sobolev Space
embedding theorem, 539
equivalent norms, 538
Sobolev space, 1135
Sobolev spaces, 539
span, 55, 66
spectral radius, 730
stereographic projection, 628, 760
Stirlingâ€™s formula, 813
stochastic process, 881
strict convexity, 363
strongly measurable, 577
subbasis, 306
submartingale, 896
submartingale convergence theorem, 900
subspace, 55
supermartingale, 896
support of a function, 219
Tietze extension theorem, 146
tight, 875, 1002
topological space, 147
total variation, 405, 435
totally bounded set, 136
totally ordered set, 1305
trace, 389
translation invariant, 269
translations, 736
trivial, 55
Tychonoï¬€theorem, 307
uniform boundedness theorem, 341
uniform convergence, 626
uniform convexity, 363
uniformly bounded, 141, 761
uniformly continuous, 25
uniformly equicontinuous, 141, 761
uniformly integrable, 203, 335
unimodular transformations, 824
upcrossing, 896
upper and lower sums, 34
Urysohnâ€™s lemma, 216
variational inequality, 368
vector measures, 405, 612
Vector valued distributions, 1241
version, 890
Vitali convergence theorem, 204, 334
Vitali cover, 510
Vitali covering theorem, 272, 275, 276,
278, 1093
Vitali coverings, 276, 278, 1093
Vitali theorem, 765
volume of unit ball, 457
weak * convergence, 1079
weak convergence, 364
weak convergence of measures, 1007
weak derivative, 1081
weak topology, 354
weakâˆ—measurable, 584

1320
INDEX
weak* topology, 354
weakly measurable, 577
Weierstrass
Stone Weierstrass theorem, 162
Weierstrass M test, 626
Weierstrass P function, 829
well ordered sets, 1307
winding number, 667
Wronskian, 80
Youngâ€™s inequality, 315, 427
zeta function, 813

