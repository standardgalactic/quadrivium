

The Design of
High Performance Mechatronics

R
S
	



mechatronics
academy
brainport




www.


The Design of
High Performance
Mechatronics
High-Tech Functionality by
Multidisciplinary System Integration
3rd revised edition
Robert Munnig Schmidt
Georg Schitter
Adrian Rankers
Jan van Eijk
Delft University Press

¬© 2020 The authors and IOS Press. All rights reserved.
ISBN 978-1-64368-050-7 (print)
ISBN 978-1-64368-051-4 (online)
doi: 10.3233/STAL9781643680514
3rd revised edition, 2020
Published by IOS Press under the imprint Delft University Press
IOS Press BV
Nieuwe Hemweg 6b
1013 BG Amsterdam
The Netherlands
tel: +31-20-688 3355
fax: +31-20-687 0019
email: info@iospress.nl
www.iospress.nl
LEGAL NOTICE
The publisher is not responsible for the use which might be made of the
following information.

Contents
Preface
xxi
Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxi
Comments to the Third Edition . . . . . . . . . . . . . . . . . . . xxiii
Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . xxiii
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xxv
1
Mechatronics in the Dutch High-Tech Industry
1
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
Historical Background . . . . . . . . . . . . . . . . . . . . . . . . .
2
1.1.1
Video Long-Play Disk (VLP) . . . . . . . . . . . . . . . . .
3
1.1.1.1
Signal Encoding and Read-Out Principle . . .
4
1.1.1.2
Compact Disc and Digital Optical Recording .
6
1.1.2
Silicon Repeater . . . . . . . . . . . . . . . . . . . . . . . .
9
1.1.2.1
IC Manufacturing Process . . . . . . . . . . . .
10
1.1.2.2
Highly Accurate Waferstage . . . . . . . . . . .
13
1.1.3
Impact of Mechatronics . . . . . . . . . . . . . . . . . . . .
16
1.2
DeÔ¨Ånition and International Positioning . . . . . . . . . . . . .
17
1.2.1
DiÔ¨Äerent Views on Mechatronics . . . . . . . . . . . . . .
18
1.2.1.1
Main Targeted Application . . . . . . . . . . . .
19
1.2.1.2
Focus on Precision-Controlled Motion . . . . .
21
1.3
Systems Engineering and Design . . . . . . . . . . . . . . . . . .
22
1.3.1
Systems Engineering Methodology
. . . . . . . . . . . .
22
1.3.1.1
Product Creation Process . . . . . . . . . . . . .
27
1.3.1.2
Requirement Budgeting . . . . . . . . . . . . . .
29
1.3.1.3
Roadmapping . . . . . . . . . . . . . . . . . . . .
30
1.3.2
Design Methodology . . . . . . . . . . . . . . . . . . . . . .
32
1.3.2.1
Concurrent Engineering
. . . . . . . . . . . . .
33
1.3.2.2
Modular Design and Platforms . . . . . . . . .
35
1.3.2.3
Agile and Scrum . . . . . . . . . . . . . . . . . .
37
v

vi
Contents
2
Applied Physics in Mechatronic Systems
39
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39
2.1
Mechanics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
40
2.1.1
Coordinate Systems . . . . . . . . . . . . . . . . . . . . . .
40
2.1.1.1
Cartesian Coordinate System . . . . . . . . . .
41
2.1.1.2
Generalised Coordinate System . . . . . . . . .
41
2.1.1.3
Modal Coordinate System
. . . . . . . . . . . .
42
2.1.2
Force and Motion . . . . . . . . . . . . . . . . . . . . . . . .
43
2.1.2.1
Galilei and Newton‚Äôs Laws of Motion
. . . . .
44
2.1.2.2
Hooke‚Äôs Law of Elasticity . . . . . . . . . . . . .
46
2.1.2.3
Lagrange Equations of Motion
. . . . . . . . .
48
2.2
Electricity and Magnetism . . . . . . . . . . . . . . . . . . . . . .
50
2.2.1
Electric Field . . . . . . . . . . . . . . . . . . . . . . . . . .
50
2.2.1.1
Potential DiÔ¨Äerence and Capacitance . . . . .
52
2.2.1.2
Electric Current in Conductive Material . . .
54
2.2.2
Magnetism and the Maxwell Equations
. . . . . . . . .
55
2.2.3
Electric Sources and Elements . . . . . . . . . . . . . . .
60
2.2.3.1
Voltage Source . . . . . . . . . . . . . . . . . . . .
60
2.2.3.2
Summary on Voltage and Current . . . . . . .
62
2.2.3.3
Electric Power . . . . . . . . . . . . . . . . . . . .
62
2.2.3.4
Ohm‚Äôs Law . . . . . . . . . . . . . . . . . . . . . .
63
2.2.3.5
Practical Values and Summary . . . . . . . . .
65
2.3
Signal Theory and Wave Propagation . . . . . . . . . . . . . . .
66
2.3.1
The Concept of Frequency . . . . . . . . . . . . . . . . . .
66
2.3.1.1
Random Signals or Noise . . . . . . . . . . . . .
70
2.3.1.2
Power of Alternating Signals
. . . . . . . . . .
70
2.3.2
Use of Complex Numbers
. . . . . . . . . . . . . . . . . .
72
2.3.2.1
Dynamic Impedance and Ohm‚Äôs Law
. . . . .
73
2.3.2.2
Power in Dynamic Impedance . . . . . . . . . .
73
2.3.2.3
Capacitive Impedance . . . . . . . . . . . . . . .
75
2.3.2.4
Inductive Impedance
. . . . . . . . . . . . . . .
78
2.3.3
Energy Propagation in Waves . . . . . . . . . . . . . . . .
80
2.3.3.1
Mechanical Waves . . . . . . . . . . . . . . . . .
82
2.3.3.2
Wave Equation
. . . . . . . . . . . . . . . . . . .
83
2.3.3.3
Electromagnetic Waves . . . . . . . . . . . . . .
87
2.3.3.4
ReÔ¨Çection of Waves . . . . . . . . . . . . . . . . .
88
2.3.3.5
Standing Waves . . . . . . . . . . . . . . . . . . .
90
2.3.4
Fourier Decomposition of Alternating Signals . . . . . .
93
2.3.4.1
Fourier in the frequency-domain . . . . . . . .
95
2.3.4.2
Triangle Waveform . . . . . . . . . . . . . . . . .
95

Contents
vii
2.3.4.3
Sawtooth Waveform . . . . . . . . . . . . . . . .
97
2.3.4.4
Square Waveform . . . . . . . . . . . . . . . . . .
98
2.3.4.5
Non-Continuous Alternating Signals
. . . . .
99
2.4
Dynamic System Analysis and Modelling . . . . . . . . . . . . . 105
2.4.0.1
Laplace-Transform . . . . . . . . . . . . . . . . . 105
2.4.0.2
Poles and Zeros . . . . . . . . . . . . . . . . . . . 106
2.4.0.3
Order of a Dynamic System . . . . . . . . . . . 107
2.4.1
Dynamic Responses in the time-domain . . . . . . . . . 108
2.4.1.1
Step Response . . . . . . . . . . . . . . . . . . . . 109
2.4.1.2
Impulse Response
. . . . . . . . . . . . . . . . . 110
2.4.1.3
Impulse Response and Pole Location . . . . . . 112
2.4.2
Dynamic Responses in the frequency-domain . . . . . . 113
2.4.2.1
Frequency or Fourier-Domain Responses . . . 113
2.4.2.2
Domain Notation of Dynamic Functions
. . . 114
2.4.2.3
Frequency Response Plots . . . . . . . . . . . . 115
2.4.2.4
Bode Plot . . . . . . . . . . . . . . . . . . . . . . . 116
2.4.2.5
Nyquist Plot . . . . . . . . . . . . . . . . . . . . . 120
2.4.2.6
Limitation to LTI Systems . . . . . . . . . . . . 122
3
Dynamics of Motion Systems
125
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
3.1
StiÔ¨Äness . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126
3.1.1
Importance of StiÔ¨Äness for Precision
. . . . . . . . . . . 127
3.1.2
Active StiÔ¨Äness . . . . . . . . . . . . . . . . . . . . . . . . . 130
3.2
Mass-Spring Systems with Damping . . . . . . . . . . . . . . . . 134
3.2.1
Dynamic Compliance . . . . . . . . . . . . . . . . . . . . . 134
3.2.1.1
Compliance of a Spring . . . . . . . . . . . . . . 135
3.2.1.2
Compliance of a Damper . . . . . . . . . . . . . 136
3.2.1.3
Compliance of a Body . . . . . . . . . . . . . . . 136
3.2.1.4
Dynamic StiÔ¨Äness
. . . . . . . . . . . . . . . . . 137
3.2.1.5
Lumping the Dynamic Elements . . . . . . . . 137
3.2.2
Transfer Function of Compliance . . . . . . . . . . . . . . 141
3.2.2.1
Damped Mass-Spring System. . . . . . . . . . . 142
3.2.2.2
Magnitude . . . . . . . . . . . . . . . . . . . . . . 144
3.2.2.3
Phase . . . . . . . . . . . . . . . . . . . . . . . . . 144
3.2.2.4
Bode Plot . . . . . . . . . . . . . . . . . . . . . . . 146
3.2.3
EÔ¨Äects of Damping . . . . . . . . . . . . . . . . . . . . . . . 147
3.2.3.1
Damped Resonance and Aperiodic Damping . 148
3.2.3.2
Poles and Critical Damping
. . . . . . . . . . . 149
3.2.3.3
Quality-Factor Q and Energy in Resonance
. 155

viii
Contents
3.2.4
Transmissibility . . . . . . . . . . . . . . . . . . . . . . . . 160
3.2.5
Fourth-Order Dynamic System . . . . . . . . . . . . . . . 164
3.2.5.1
Analytical Description . . . . . . . . . . . . . . . 165
3.2.5.2
Multiplicative Expression
. . . . . . . . . . . . 166
3.2.5.3
EÔ¨Äect of DiÔ¨Äerent Mass Ratios . . . . . . . . . 167
3.3
Modal Decomposition
. . . . . . . . . . . . . . . . . . . . . . . . . 172
3.3.1
Eigenmodes of Two-Body Mass-Spring System . . . . . 173
3.3.2
Theory of Modal Decomposition
. . . . . . . . . . . . . . 179
3.3.2.1
Multi Degree of Freedom Equation of Motion 180
3.3.2.2
Eigenvalues and Eigenvectors . . . . . . . . . . 180
3.3.2.3
Modal Coordinates . . . . . . . . . . . . . . . . . 182
3.3.2.4
Resulting Transfer Function . . . . . . . . . . . 183
3.3.3
Graphical Representation of Mode-Shapes . . . . . . . . 185
3.3.3.1
Traditional Representation
. . . . . . . . . . . 185
3.3.3.2
Lever Representation . . . . . . . . . . . . . . . 186
3.3.3.3
General System . . . . . . . . . . . . . . . . . . . 188
3.3.3.4
User-DeÔ¨Åned Physical DOF
. . . . . . . . . . . 190
3.3.4
Physical Meaning of Modal Parameters . . . . . . . . . . 193
3.3.4.1
Two-Body Mass-Spring System . . . . . . . . . 194
3.3.4.2
Planar Flexibly Guided System . . . . . . . . . 198
3.3.5
A Pragmatic View on Sensitivity Analysis . . . . . . . . 201
3.3.5.1
Example of Two Body Mass-Spring System
. 203
3.3.5.2
Example of Slightly Damped Resonance
. . . 205
3.3.6
Suspension and Rigid-Body Modes . . . . . . . . . . . . . 207
3.3.6.1
Quasi Rigid-Body Suspension mode . . . . . . 210
3.4
Mechanical Frequency Response . . . . . . . . . . . . . . . . . . 211
3.4.1
Multiple eigenmodes
. . . . . . . . . . . . . . . . . . . . . 211
3.4.2
Characteristic Frequency Responses
. . . . . . . . . . . 213
3.4.2.1
Frequency Response Type I . . . . . . . . . . . 217
3.4.2.2
Frequency Response Type II . . . . . . . . . . . 218
3.4.2.3
Frequency Response Type III . . . . . . . . . . 220
3.4.2.4
Frequency Response Type IV . . . . . . . . . . 221
3.4.3
Example Systems with Type I/II/IV Response . . . . . . 223
3.4.3.1
Planar Moving Body on Compliant Spring . . 223
3.4.3.2
H-drive Waferstage . . . . . . . . . . . . . . . . . 229
3.5
Summary on Dynamics . . . . . . . . . . . . . . . . . . . . . . . . 231

Contents
ix
4
Motion Control
233
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233
4.1
A Walk around the Control Loop
. . . . . . . . . . . . . . . . . . 235
4.1.1
Poles and Zeros in Motion Control . . . . . . . . . . . . . 237
4.1.2
Overview Feedforward Control . . . . . . . . . . . . . . . 238
4.1.2.1
Summary of Feedforward Control
. . . . . . . 239
4.1.3
Overview Feedback Control . . . . . . . . . . . . . . . . . 241
4.1.3.1
Summary of Feedback Control
. . . . . . . . . 243
4.2
Feedforward Control . . . . . . . . . . . . . . . . . . . . . . . . . . 244
4.2.1
Model-Based Feedforward Control . . . . . . . . . . . . . 245
4.2.2
Input-Shaping
. . . . . . . . . . . . . . . . . . . . . . . . . 248
4.2.3
Adaptive Feedforward Control . . . . . . . . . . . . . . . 250
4.2.4
Trajectory ProÔ¨Åle Generation . . . . . . . . . . . . . . . . 251
4.3
Feedback Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253
4.3.1
Sensitivity to Input Signals . . . . . . . . . . . . . . . . . 253
4.3.1.1
Sensitivity Functions . . . . . . . . . . . . . . . 254
4.3.1.2
Real Feedback Error Sensitivity
. . . . . . . . 258
4.3.2
Stability and Robustness in Feedback Control . . . . . 259
4.3.2.1
Stability margins . . . . . . . . . . . . . . . . . . 260
4.4
PID Feedback Control . . . . . . . . . . . . . . . . . . . . . . . . . 265
4.4.1
PID-Control of a Compact-Disc Player
. . . . . . . . . . 267
4.4.1.1
Relevant Sensitivity Functions . . . . . . . . . 269
4.4.1.2
Proportional Feedback
. . . . . . . . . . . . . . 270
4.4.1.3
Proportional-DiÔ¨Äerential Feedback . . . . . . . 273
4.4.1.4
Limiting the DiÔ¨Äerentiating Action
. . . . . . 275
4.4.1.5
Adding I-Control . . . . . . . . . . . . . . . . . . 279
4.4.2
PID-Control of a Spring Supported Mass . . . . . . . . . 281
4.4.2.1
P-Control . . . . . . . . . . . . . . . . . . . . . . . 283
4.4.2.2
D-Control . . . . . . . . . . . . . . . . . . . . . . . 284
4.4.2.3
I-Control . . . . . . . . . . . . . . . . . . . . . . . 285
4.4.2.4
Sensitivity Function Graphs . . . . . . . . . . . 288
4.4.3
Limitations and Side EÔ¨Äects of PID-Feedback Control 290
4.4.3.1
Increased Sensitivity, the Waterbed EÔ¨Äect . . 290
4.4.3.2
Integrator Wind-Up and Delays . . . . . . . . . 291
4.4.4
PID-Control of a Fourth-Order Dynamic System . . . . 297
4.4.4.1
Controlling a Type III Dynamic System . . . . 298
4.4.4.2
Passive Damping . . . . . . . . . . . . . . . . . . 299
4.4.4.3
Shifting the Phase . . . . . . . . . . . . . . . . . 301
4.4.5
PID-Control of a Piezoelectric Actuator . . . . . . . . . . 304
4.4.5.1
Creating a Fourth-Order System . . . . . . . . 305

x
Contents
4.4.6
PID-Control of a Magnetic Bearing . . . . . . . . . . . . 306
4.4.6.1
Frequency Response . . . . . . . . . . . . . . . . 306
4.4.6.2
Positive StiÔ¨Äness by P-Control
. . . . . . . . . 308
4.4.6.3
D-Control and Pole Placement . . . . . . . . . . 308
4.4.6.4
I-control for Reduced Sensitivity . . . . . . . . 311
4.4.7
Optimisation by Loop-Shaping Design . . . . . . . . . . 313
4.4.7.1
Optimal Value of Alpha . . . . . . . . . . . . . . 314
4.4.7.2
Additional Low-Pass Filtering . . . . . . . . . . 315
4.4.7.3
Notching Filters . . . . . . . . . . . . . . . . . . . 316
4.4.7.4
Peaking and Shelving Filters . . . . . . . . . . 318
4.4.8
Design Steps for PID-control
. . . . . . . . . . . . . . . . 319
4.5
Digital Signal Processing - The Z-Domain
. . . . . . . . . . . . 320
4.5.1
Continuous Time versus Discrete Time . . . . . . . . . . 320
4.5.2
Sampling of Continuous Signals . . . . . . . . . . . . . . 323
4.5.3
Digital Number Representation
. . . . . . . . . . . . . . 324
4.5.3.1
Fixed Point Arithmetic
. . . . . . . . . . . . . . 324
4.5.3.2
Floating Point Arithmetic
. . . . . . . . . . . . 325
4.5.4
Digital Filter Theory . . . . . . . . . . . . . . . . . . . . . 326
4.5.4.1
Z-Transform and DiÔ¨Äerence Equations . . . . 326
4.5.5
Finite Impulse Response (FIR) Filter . . . . . . . . . . . 328
4.5.6
InÔ¨Ånite Impulse Response (IIR) Filter
. . . . . . . . . . 331
4.5.7
Converting Continuous to Discrete-Time Filters . . . . 334
4.6
State-Space Feedback Control . . . . . . . . . . . . . . . . . . . . 335
4.6.1
State-Space in Relation to Motion Control . . . . . . . . 336
4.6.1.1
Mechanical Dynamic System in State-Space . 338
4.6.1.2
PID-Control Feedback in State-Space . . . . . 342
4.6.2
State Feedback . . . . . . . . . . . . . . . . . . . . . . . . . 344
4.6.2.1
System IdentiÔ¨Åcation . . . . . . . . . . . . . . . 346
4.6.2.2
State Estimation . . . . . . . . . . . . . . . . . . 347
4.6.2.3
Additional Remarks on State-Space Control . 349
4.7
Conclusion on Motion Control . . . . . . . . . . . . . . . . . . . . 350
5
Electromechanic Actuators
353
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
5.1
Electromagnetics . . . . . . . . . . . . . . . . . . . . . . . . . . . . 356
5.1.1
Hopkinson‚Äôs Law . . . . . . . . . . . . . . . . . . . . . . . . 360
5.1.1.1
Practical Aspects of Hopkinson‚Äôs Law . . . . . 362
5.1.1.2
Magnetic Energy . . . . . . . . . . . . . . . . . . 362
5.1.2
Ferromagnetic Materials . . . . . . . . . . . . . . . . . . . 364
5.1.2.1
Coil with Ferromagnetic Yoke . . . . . . . . . . 365

Contents
xi
5.1.2.2
Magnetisation Curve
. . . . . . . . . . . . . . . 366
5.1.2.3
Permanent Magnets . . . . . . . . . . . . . . . . 367
5.1.3
Creating a Magnetic Field in an Air-Gap . . . . . . . . . 371
5.1.3.1
Optimal Use of Permanent Magnet Material
375
5.1.3.2
Flat Magnets Reduce Fringing Flux . . . . . . 376
5.1.3.3
Low Cost Loudspeaker Magnet . . . . . . . . . 377
5.2
Lorentz Actuator . . . . . . . . . . . . . . . . . . . . . . . . . . . . 378
5.2.1
Lorentz Force . . . . . . . . . . . . . . . . . . . . . . . . . . 378
5.2.1.1
Force from Flux-Linkage . . . . . . . . . . . . . 381
5.2.2
The Lorentz actuator as a Generator . . . . . . . . . . . 382
5.2.3
Improving the Force of a Lorentz Actuator . . . . . . . . 384
5.2.3.1
The Moving-Coil Loudspeaker Actuator . . . . 385
5.2.4
Position Dependency of the Lorentz Force . . . . . . . . 386
5.2.4.1
Over-Hung and Under-Hung Coil . . . . . . . . 386
5.2.5
Electronic Commutation . . . . . . . . . . . . . . . . . . . 388
5.2.5.1
Three-Phase Electronic Control . . . . . . . . . 390
5.2.6
Figures of Merit of a Lorentz Actuator . . . . . . . . . . 392
5.3
Variable Reluctance Actuation . . . . . . . . . . . . . . . . . . . . 395
5.3.1
Reluctance Force in Lorentz Actuator . . . . . . . . . . . 395
5.3.1.1
Eddy-Current Ring . . . . . . . . . . . . . . . . . 396
5.3.1.2
Ironless Stator
. . . . . . . . . . . . . . . . . . . 397
5.3.2
Analytical Derivation of Reluctance Force . . . . . . . . 398
5.3.3
Variable Reluctance Actuator. . . . . . . . . . . . . . . . . 402
5.3.3.1
Electromagnetic Relay . . . . . . . . . . . . . . . 404
5.3.3.2
Magnetic Attraction Force . . . . . . . . . . . . 405
5.3.4
Permanent Magnet Biased Reluctance Actuator . . . . 407
5.3.4.1
Double Variable Reluctance Actuator . . . . . 407
5.3.4.2
Constant Common Flux . . . . . . . . . . . . . . 409
5.3.4.3
Combining two Sources of Magnetic Flux . . . 410
5.3.4.4
Hybrid Force Calculation . . . . . . . . . . . . . 413
5.3.4.5
Magnetic Bearings . . . . . . . . . . . . . . . . . 415
5.3.5
Active Linearisation of the Reluctance Force . . . . . . 416
5.4
Application of Electromagnetic Actuators . . . . . . . . . . . . . 418
5.4.1
Electrical Interface Properties . . . . . . . . . . . . . . . 418
5.4.1.1
Dynamic EÔ¨Äects of Self-Inductance
. . . . . . 418
5.4.1.2
Limitation of the ‚ÄúJerk‚Äù . . . . . . . . . . . . . . 421
5.4.1.3
Electromagnetic Damping . . . . . . . . . . . . 422
5.4.2
Comparison of three Electromagnetic Actuators . . . . 425
5.4.2.1
Force-Constants . . . . . . . . . . . . . . . . . . . 426
5.4.2.2
Figures of Merit Including Mass . . . . . . . . 428

xii
Contents
5.4.2.3
StiÔ¨Äness
. . . . . . . . . . . . . . . . . . . . . . . 429
5.4.2.4
Repeatability and Predictability
. . . . . . . . 429
5.4.2.5
Dynamic EÔ¨Äects on the Control Loop
. . . . . 430
5.5
Piezoelectric Actuators
. . . . . . . . . . . . . . . . . . . . . . . . 431
5.5.1
Piezoelectricity . . . . . . . . . . . . . . . . . . . . . . . . . 431
5.5.1.1
Poling . . . . . . . . . . . . . . . . . . . . . . . . . 432
5.5.1.2
Tapping the Bound Charge by Electrodes . . . 434
5.5.2
Transducer Models
. . . . . . . . . . . . . . . . . . . . . . 435
5.5.3
Nonlinearity of Piezoelectric Actuators . . . . . . . . . . 438
5.5.3.1
Creep . . . . . . . . . . . . . . . . . . . . . . . . . 438
5.5.3.2
Hysteresis . . . . . . . . . . . . . . . . . . . . . . 439
5.5.3.3
Aging . . . . . . . . . . . . . . . . . . . . . . . . . 441
5.5.4
Mechanical Considerations
. . . . . . . . . . . . . . . . . 441
5.5.4.1
Piezoelectric Actuator StiÔ¨Äness . . . . . . . . . 442
5.5.4.2
Actuator Types . . . . . . . . . . . . . . . . . . . 442
5.5.4.3
Long Range Actuation by Friction . . . . . . . 445
5.5.4.4
Actuator Integration . . . . . . . . . . . . . . . . 446
5.5.4.5
Mechanical AmpliÔ¨Åcation . . . . . . . . . . . . . 447
5.5.4.6
Multiple Motion Directions by Stacking . . . . 448
5.5.5
Electrical Considerations
. . . . . . . . . . . . . . . . . . 450
5.5.5.1
Charge vs. Voltage Control . . . . . . . . . . . . 450
5.5.5.2
Self-Sensing Actuation . . . . . . . . . . . . . . 451
5.6
Choosing the right Actuator Type . . . . . . . . . . . . . . . . . . 454
6
Analogue Electronics in Mechatronic Systems
457
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 457
6.1
Passive Linear Electronics . . . . . . . . . . . . . . . . . . . . . . 459
6.1.1
Network Theory and Laws . . . . . . . . . . . . . . . . . . 459
6.1.1.1
Voltage Source . . . . . . . . . . . . . . . . . . . . 459
6.1.1.2
Current Source . . . . . . . . . . . . . . . . . . . 460
6.1.1.3
Theorem of Norton and Thevenin . . . . . . . . 462
6.1.1.4
KirchhoÔ¨Ä‚Äôs Laws
. . . . . . . . . . . . . . . . . . 463
6.1.1.5
Impedances in Series or Parallel . . . . . . . . 463
6.1.1.6
Voltage Divider . . . . . . . . . . . . . . . . . . . 464
6.1.1.7
Maximum Power of a Real Voltage Source . . 466
6.1.2
Impedances in Electronic Circuits . . . . . . . . . . . . . 468
6.1.2.1
Resistors . . . . . . . . . . . . . . . . . . . . . . . 468
6.1.2.2
Capacitors . . . . . . . . . . . . . . . . . . . . . . 470
6.1.2.3
Inductors . . . . . . . . . . . . . . . . . . . . . . . 472
6.1.3
Passive Filters . . . . . . . . . . . . . . . . . . . . . . . . . 474

Contents
xiii
6.1.3.1
Passive First-Order RC-Filters . . . . . . . . . 474
6.1.3.2
Passive Higher-Order RC-Filters . . . . . . . . 477
6.1.3.3
Passive LCR-Filters . . . . . . . . . . . . . . . . 479
6.1.4
Mechanical-Electrical Dynamic Analogy . . . . . . . . . 485
6.2
Semiconductors and Active Electronics . . . . . . . . . . . . . . 489
6.2.1
Basic Discrete Semiconductors . . . . . . . . . . . . . . . 490
6.2.1.1
Semiconductor Diode
. . . . . . . . . . . . . . . 493
6.2.1.2
Bipolar Transistors
. . . . . . . . . . . . . . . . 496
6.2.1.3
MOSFET . . . . . . . . . . . . . . . . . . . . . . . 499
6.2.1.4
Other Discrete Semiconductors . . . . . . . . . 501
6.2.2
Single Transistor Linear AmpliÔ¨Åers . . . . . . . . . . . . 504
6.2.2.1
Emitter Follower . . . . . . . . . . . . . . . . . . 504
6.2.2.2
Voltage AmpliÔ¨Åer . . . . . . . . . . . . . . . . . . 507
6.2.2.3
DiÔ¨Äerential AmpliÔ¨Åer . . . . . . . . . . . . . . . 509
6.2.3
Operational AmpliÔ¨Åer . . . . . . . . . . . . . . . . . . . . . 512
6.2.3.1
Basic Operational AmpliÔ¨Åer Design . . . . . . 512
6.2.3.2
Operational AmpliÔ¨Åer with Feedback . . . . . 514
6.2.4
Linear AmpliÔ¨Åers with Operational AmpliÔ¨Åers . . . . . 515
6.2.4.1
Design Rules . . . . . . . . . . . . . . . . . . . . . 516
6.2.4.2
Non-Inverting AmpliÔ¨Åer
. . . . . . . . . . . . . 516
6.2.4.3
Inverting AmpliÔ¨Åer . . . . . . . . . . . . . . . . . 518
6.2.4.4
Adding and Subtracting Signals
. . . . . . . . 519
6.2.4.5
Transimpedance AmpliÔ¨Åer . . . . . . . . . . . . 522
6.2.4.6
Transconductance AmpliÔ¨Åer . . . . . . . . . . . 523
6.2.5
Active Electronic Filters . . . . . . . . . . . . . . . . . . . 527
6.2.5.1
Integrator and First-Order Low-Pass . . . . . 527
6.2.5.2
DiÔ¨Äerentiator and First-Order High-Pass . . . 529
6.2.6
Analogue PID-Controller . . . . . . . . . . . . . . . . . . . 531
6.2.6.1
PID Transfer Function . . . . . . . . . . . . . . 532
6.2.6.2
PID Control Gains . . . . . . . . . . . . . . . . . 534
6.2.6.3
High-Speed PID-Control . . . . . . . . . . . . . 535
6.2.7
Higher-order Electronic Filters . . . . . . . . . . . . . . . 535
6.2.7.1
Second-Order Low-Pass Filter . . . . . . . . . . 537
6.2.7.2
DiÔ¨Äerent Types of Active Filters
. . . . . . . . 538
6.2.8
Ideal and Real Operational AmpliÔ¨Åers . . . . . . . . . . 539
6.2.8.1
Open-Loop Voltage Gain
. . . . . . . . . . . . . 541
6.2.8.2
Dynamic Limitations
. . . . . . . . . . . . . . . 541
6.2.8.3
Input Related Limitations . . . . . . . . . . . . 546
6.2.8.4
Power Supply and Output Limitations
. . . . 549
6.2.9
Closing Remarks on Low-Power Electronics . . . . . . . 550

xiv
Contents
6.3
Power AmpliÔ¨Åers for Motion Control . . . . . . . . . . . . . . . . 552
6.3.1
Required Properties for Actuator Drive . . . . . . . . . . 553
6.3.1.1
Power Delivery Capability . . . . . . . . . . . . 554
6.3.1.2
Dynamic Properties . . . . . . . . . . . . . . . . 554
6.3.1.3
Linearity, Freedom of Distortion . . . . . . . . 555
6.3.1.4
Voltage or Current Drive . . . . . . . . . . . . . 555
6.3.1.5
EÔ¨Éciency . . . . . . . . . . . . . . . . . . . . . . . 556
6.3.1.6
Four-Quadrant Operation
. . . . . . . . . . . . 557
6.3.1.7
Preferred Power AmpliÔ¨Åer Principle . . . . . . 557
6.3.2
Switched-Mode Power AmpliÔ¨Åers . . . . . . . . . . . . . . 560
6.3.2.1
Power MOSFET, a Fast High-Power Switch . 561
6.3.2.2
Switching Sequence Generation . . . . . . . . . 564
6.3.2.3
Voltage Drive AmpliÔ¨Åer . . . . . . . . . . . . . . 566
6.3.2.4
Energy Flow in the Power Output Stage
. . . 570
6.3.2.5
Intermediate Conclusions and Other Issues . 574
6.3.2.6
Driving the Power MOSFETs . . . . . . . . . . 575
6.3.2.7
Charge Pumping . . . . . . . . . . . . . . . . . . 577
6.3.2.8
H-Bridge ConÔ¨Åguration . . . . . . . . . . . . . . 578
6.3.2.9
Output Filter
. . . . . . . . . . . . . . . . . . . . 580
6.3.3
Resonant-Mode Power AmpliÔ¨Åers
. . . . . . . . . . . . . 581
6.3.3.1
Switching Sequence of the Output Stage . . . 582
6.3.3.2
Lossless Current Sensing . . . . . . . . . . . . . 586
6.3.4
Three-Phase AmpliÔ¨Åers . . . . . . . . . . . . . . . . . . . . 587
6.3.4.1
Concept of Three-Phase AmpliÔ¨Åer
. . . . . . . 588
6.3.4.2
Three-Phase Switching Power Stages . . . . . 589
6.3.5
Some Last Remarks on Power Electronics . . . . . . . . 590
7
Optics in Mechatronic Systems
593
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 593
7.1
Properties of Light and Light Sources . . . . . . . . . . . . . . . 595
7.1.1
Light Generation by Thermal Radiation . . . . . . . . . 596
7.1.2
Photons by Electron Energy State Variation . . . . . . . 597
7.1.2.1
Light Emitting Diodes . . . . . . . . . . . . . . . 599
7.1.2.2
Laser as an Ideal Light Source . . . . . . . . . 600
7.1.3
Useful Power from a Light Source . . . . . . . . . . . . . 604
7.1.3.1
Radiant Emittance and Irradiance . . . . . . . 605
7.1.3.2
Radiance . . . . . . . . . . . . . . . . . . . . . . . 605
7.1.3.3
Etendue . . . . . . . . . . . . . . . . . . . . . . . . 608
7.2
ReÔ¨Çection and Refraction . . . . . . . . . . . . . . . . . . . . . . . 609
7.2.1
ReÔ¨Çection and Refraction according to the Least Time 610

Contents
xv
7.2.1.1
Partial ReÔ¨Çection and Refraction . . . . . . . . 613
7.2.2
Concept of Wavefront . . . . . . . . . . . . . . . . . . . . . 614
7.2.2.1
A Wavefront is Not Real . . . . . . . . . . . . . . 615
7.3
Geometric Optics . . . . . . . . . . . . . . . . . . . . . . . . . . . . 617
7.3.1
Imaging with Refractive Lens Elements . . . . . . . . . 617
7.3.1.1
Sign Conventions . . . . . . . . . . . . . . . . . . 619
7.3.1.2
Real Lens Elements . . . . . . . . . . . . . . . . 620
7.3.1.3
MagniÔ¨Åcation . . . . . . . . . . . . . . . . . . . . 623
7.3.2
Aberrations . . . . . . . . . . . . . . . . . . . . . . . . . . . 625
7.3.2.1
Spherical Aberration
. . . . . . . . . . . . . . . 625
7.3.2.2
Astigmatism . . . . . . . . . . . . . . . . . . . . . 627
7.3.2.3
Coma
. . . . . . . . . . . . . . . . . . . . . . . . . 629
7.3.2.4
Geometric and Chromatic Aberrations
. . . . 629
7.3.3
Combining Multiple Optical Elements . . . . . . . . . . 631
7.3.3.1
Combining Two Positive Lenses . . . . . . . . . 632
7.3.4
Aperture Stop and Pupil . . . . . . . . . . . . . . . . . . . 635
7.3.5
Telecentricity . . . . . . . . . . . . . . . . . . . . . . . . . . 636
7.3.5.1
Pupil, Aperture and Lens Dimensions . . . . . 638
7.3.5.2
Practical Applications and Constraints . . . . 638
7.4
Physical Optics
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 640
7.4.1
Polarisation . . . . . . . . . . . . . . . . . . . . . . . . . . . 640
7.4.1.1
Birefringence . . . . . . . . . . . . . . . . . . . . 642
7.4.2
Interference . . . . . . . . . . . . . . . . . . . . . . . . . . . 644
7.4.2.1
Fabry-Perot Interferometer
. . . . . . . . . . . 646
7.4.3
DiÔ¨Äraction . . . . . . . . . . . . . . . . . . . . . . . . . . . . 648
7.4.3.1
Amplitude gratings
. . . . . . . . . . . . . . . . 649
7.4.3.2
Phase Gratings . . . . . . . . . . . . . . . . . . . 651
7.4.3.3
Direction of the Incoming Light . . . . . . . . . 658
7.4.4
Imaging Quality based on DiÔ¨Äraction . . . . . . . . . . . 658
7.4.4.1
Numerical Aperture and f-Number . . . . . . . 662
7.4.4.2
Depth of Focus
. . . . . . . . . . . . . . . . . . . 665
7.5
Adaptive Optics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 668
7.5.1
Thermal EÔ¨Äects in Optical Imaging Systems . . . . . . 668
7.5.2
Correcting the Wavefront
. . . . . . . . . . . . . . . . . . 670
7.5.2.1
Zernike Polynomials . . . . . . . . . . . . . . . . 671
7.5.2.2
Correcting Zernikes by Adaptive Optics . . . . 675
7.5.3
Adaptive Optics Principle of Operation . . . . . . . . . . 676
7.5.3.1
Active Mirrors . . . . . . . . . . . . . . . . . . . . 678

xvi
Contents
8
Measurement in Mechatronic Systems
683
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 683
8.0.1
Measurement Systems . . . . . . . . . . . . . . . . . . . . 684
8.0.2
Errors in Measurement Systems, Uncertainty . . . . . 685
8.0.2.1
Uncertainty in Traceable Measurements . . . 687
8.0.3
Functional Model of a Measurement System Element
689
8.1
Dynamic Error Budgeting
. . . . . . . . . . . . . . . . . . . . . . 691
8.1.1
Error Statistics in Repeated Measurements . . . . . . . 691
8.1.2
The Normal Distribution . . . . . . . . . . . . . . . . . . . 692
8.1.3
Combining DiÔ¨Äerent Error Sources . . . . . . . . . . . . 694
8.1.4
Power Spectral Density and Cumulative Power . . . . . 695
8.1.5
Do not use the Cumulative Amplitude Spectrum!
. . . 698
8.1.6
Variations in Dynamic Error Budgeting . . . . . . . . . 698
8.1.7
Sources of Noise and Disturbances . . . . . . . . . . . . . 699
8.1.7.1
Mechanical Noise . . . . . . . . . . . . . . . . . . 699
8.1.7.2
Electronic Noise . . . . . . . . . . . . . . . . . . . 700
8.2
Sensor Signal Sensitivity . . . . . . . . . . . . . . . . . . . . . . . 703
8.2.1
Sensing Element . . . . . . . . . . . . . . . . . . . . . . . . 704
8.2.2
Converting an Impedance into an Electric Signal
. . . 705
8.2.2.1
Wheatstone Bridge . . . . . . . . . . . . . . . . . 706
8.2.3
Electronic Interconnection of Sensitive Signals . . . . . 712
8.2.3.1
Magnetic Disturbances . . . . . . . . . . . . . . 712
8.2.3.2
Capacitive Disturbances
. . . . . . . . . . . . . 714
8.2.3.3
Ground Loops . . . . . . . . . . . . . . . . . . . . 716
8.3
Signal Conditioning
. . . . . . . . . . . . . . . . . . . . . . . . . . 718
8.3.1
Instrumentation AmpliÔ¨Åer . . . . . . . . . . . . . . . . . . 718
8.3.2
Filtering and Modulation
. . . . . . . . . . . . . . . . . . 721
8.3.2.1
AM with Square Wave Carrier
. . . . . . . . . 722
8.3.2.2
AM with Sinusoidal Carrier . . . . . . . . . . . 723
8.4
Signal Processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . 726
8.4.1
Schmitt Trigger
. . . . . . . . . . . . . . . . . . . . . . . . 726
8.4.2
Digital Representation of Measurement Data . . . . . . 727
8.4.2.1
Gray Code . . . . . . . . . . . . . . . . . . . . . . 728
8.4.2.2
Sampling of Analogue Values . . . . . . . . . . 730
8.4.2.3
Nyquist-Shannon Theorem . . . . . . . . . . . . 731
8.4.2.4
Filtering to Prevent Aliasing . . . . . . . . . . . 734
8.4.3
Analogue-to-Digital Converters . . . . . . . . . . . . . . . 735
8.4.3.1
Dual-Slope ADC
. . . . . . . . . . . . . . . . . . 735
8.4.3.2
Successive-Approximation ADC . . . . . . . . . 737
8.4.3.3
Sigma-Delta ADC
. . . . . . . . . . . . . . . . . 740

Contents
xvii
8.4.3.4
ADC Latency in a Feedback Loop . . . . . . . . 743
8.4.4
Connecting the Less Sensitive Elements . . . . . . . . . 744
8.4.4.1
Characteristic Impedance
. . . . . . . . . . . . 744
8.4.4.2
Non-Galvanic Connection . . . . . . . . . . . . . 747
8.5
Short-Range Motion Sensors . . . . . . . . . . . . . . . . . . . . . 748
8.5.1
Optical Sensors . . . . . . . . . . . . . . . . . . . . . . . . . 748
8.5.1.1
Position Sensitive Detectors . . . . . . . . . . . 749
8.5.1.2
Optical DeÔ¨Çectometer . . . . . . . . . . . . . . . 752
8.5.2
Capacitive Position Sensors . . . . . . . . . . . . . . . . . 754
8.5.2.1
Linearising by DiÔ¨Äerential Measurement . . . 755
8.5.2.2
Accuracy Limits and Improvements . . . . . . 756
8.5.2.3
Sensing to Conductive Moving Plate . . . . . . 759
8.5.3
Inductive Position Sensors . . . . . . . . . . . . . . . . . . 760
8.5.3.1
Linear Variable DiÔ¨Äerential Transformer . . . 762
8.5.3.2
Eddy-Current Sensors . . . . . . . . . . . . . . . 764
8.5.4
Pneumatic Proximity Sensor or Air-Gage
. . . . . . . . 765
8.6
Measurement of Mechanical Dynamics . . . . . . . . . . . . . . 766
8.6.1
Measurement of Force and Strain . . . . . . . . . . . . . 766
8.6.1.1
Strain Gages . . . . . . . . . . . . . . . . . . . . . 766
8.6.1.2
Fibre Bragg Grating Strain Measurement . . 769
8.6.2
Velocity Measurement
. . . . . . . . . . . . . . . . . . . . 771
8.6.2.1
Geophone . . . . . . . . . . . . . . . . . . . . . . . 772
8.6.3
Accelerometers . . . . . . . . . . . . . . . . . . . . . . . . . 776
8.6.3.1
Closed-Loop Feedback Accelerometer . . . . . 776
8.6.3.2
Piezoelectric Accelerometer
. . . . . . . . . . . 778
8.6.3.3
MEMS Accelerometer . . . . . . . . . . . . . . . 787
8.7
Optical Long-Range Incremental Position Sensors . . . . . . . 789
8.7.1
Linear Optical Encoders . . . . . . . . . . . . . . . . . . . 790
8.7.1.1
Interpolation . . . . . . . . . . . . . . . . . . . . . 794
8.7.1.2
Vernier Resolution Enhancement . . . . . . . . 796
8.7.1.3
Interferometric Optical Encoder
. . . . . . . . 798
8.7.1.4
Concluding Remarks on Linear Encoders . . . 803
8.7.2
Laser Interferometer Measurement Systems . . . . . . 804
8.7.2.1
Homodyne Distance Interferometry . . . . . . 805
8.7.2.2
Heterodyne Distance Interferometry . . . . . . 812
8.7.2.3
Measurement Uncertainty . . . . . . . . . . . . 821
8.7.2.4
ConÔ¨Ågurations
. . . . . . . . . . . . . . . . . . . 828
8.7.2.5
Multi-Axis Laser Interferometers . . . . . . . . 833
8.7.3
Mechanical Aspects . . . . . . . . . . . . . . . . . . . . . . 834
8.7.3.1
Abbe Error . . . . . . . . . . . . . . . . . . . . . . 835

xviii
Contents
9
Precision Positioning in Wafer Scanners
839
Introduction
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 839
9.1
The Waferscanner . . . . . . . . . . . . . . . . . . . . . . . . . . . . 841
9.1.1
Requirements on Precision
. . . . . . . . . . . . . . . . . 843
9.2
Dynamic Architecture . . . . . . . . . . . . . . . . . . . . . . . . . 847
9.2.1
Balance Masses
. . . . . . . . . . . . . . . . . . . . . . . . 848
9.2.2
Vibration Isolation . . . . . . . . . . . . . . . . . . . . . . . 850
9.2.2.1
Eigendynamics of the Sensitive Parts . . . . . 853
9.3
Zero-StiÔ¨Äness Stage Actuation . . . . . . . . . . . . . . . . . . . . 857
9.3.1
Waferstage Actuation Concept
. . . . . . . . . . . . . . . 858
9.3.1.1
Waferstepper Long-Range Lorentz Actuator . 858
9.3.1.2
Multi-Axis Positioning . . . . . . . . . . . . . . . 861
9.3.1.3
Long- and Short-Stroke Actuation . . . . . . . 862
9.3.2
Full Magnetic Levitation . . . . . . . . . . . . . . . . . . . 865
9.3.3
Acceleration Limits of Reticle Stage . . . . . . . . . . . . 866
9.4
Position Measurement . . . . . . . . . . . . . . . . . . . . . . . . . 868
9.4.1
Alignment Sensor . . . . . . . . . . . . . . . . . . . . . . . 870
9.4.2
Keeping the Wafer in Focus . . . . . . . . . . . . . . . . . 872
9.4.3
Dual-Stage Measurement and Exposure . . . . . . . . . 875
9.4.4
Long-Range Incremental Measurement System . . . . 876
9.4.4.1
Real-Time Metrology Loop . . . . . . . . . . . . 877
9.5
Motion Control
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 880
9.5.1
Feedforward and Feedback Control . . . . . . . . . . . . 881
9.5.1.1
Thermal, The Final Frontier . . . . . . . . . . . 883
9.5.2
The Mass Dilemma . . . . . . . . . . . . . . . . . . . . . . 884
9.6
Future Developments in IC Lithography . . . . . . . . . . . . . 885
9.7
Main Design Rules for Precision . . . . . . . . . . . . . . . . . . . 886
Appendix
889
References and Recommended Reading . . . . . . . . . . . . . . . . . 889
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 890
Nomenclature and Abbreviations . . . . . . . . . . . . . . . . . . . . . 899
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 909

blank
left
intentionally
page
This

blank
left
intentionally
page
This

Preface
Motivation to the First Edition
A world without mechatronics is almost as unthinkable as a world with-
out electric light. After its origin around the second world war the name
mechatronics has become known for all kind of mechanical systems where
mechanics and electronics are combined to achieve a certain function. The
complexity of mechatronic systems ranges from a simple set of electronic
controlled relay-switches to highly integrated precision motion systems.
This proliferation of mechatronics has been described in many books, which
each have been written with a diÔ¨Äerent scope in mind depending on the
speciÔ¨Åc technological anchor point of the author(s) within this wide multi-
disciplinary Ô¨Åeld of engineering.
This book distinguishes itself from other books in several ways. First of all
it is a combination of a reference book for engineers working in the high-
tech industry and a university textbook, due to the mixed industrial and
academic background of the authors. The industry oriented part is based
on extensive experience in designing the most sophisticated motion systems
presently available, the stages of wafer scanners, which are used in the
semiconductor industry. The academic part is based on advanced research
on precision motion systems, including ultra precision metrology equipment
with fast Scanning-Probe Microscopy and optical measurement systems
with sub-nanometre accuracy. The high-tech industrial background focuses
on high-precision positioning at very high velocity and acceleration levels.
With this focus, the book does not include examples from other important
application areas like robotics, machining centres and vehicle mechatronics,
though the theory is also applicable to those areas of mechatronics.
The presented material is aimed at obtaining maximum understanding of
all dynamic aspects of a motion system, which is the reason for the term
‚ÄúHigh Performance‚Äù in the title.
xxi

xxii
Preface
Another, more teaching related reason for writing this book is based on the
observation that most students at the university are rather well trained
in applying mathematical rules for solving purely mathematical problems,
while they often have more diÔ¨Éculties in the application of these mathemat-
ics in the modelling of real designs. The industrial need for well educated
engineers with both theoretical and practical skills, combined with a healthy
critical attitude to the outcome of computer simulations, became a guiding
motive for writing this book. The capability to swiftly switch between model
and reality is one of the most important skills of a real multidisciplinary
designer. This capability helps to quickly predict the approximate system
behaviour in the concept phase of a design, where intuition and small calcu-
lations on the backside of an envelope are often more valuable than computer
based detailed calculations by means of sophisticated modelling software.
It is certainly true that these software tools are indispensable for further
detailing and optimisation in the later phase of a design project but more
attention is needed for basic engineering expert-knowledge to cover the
concept-design phase where the most important design decisions are taken.
In view of these main motivations to write this book, it was also decided to
focus uniquely on the hardware part of mechatronic systems. This means
that the important Ô¨Åeld of embedded software is not presented even though
software often serves as the actual implementation platform for modern con-
trol systems. The reason for this exclusion is the intended focus of this book
on the prime functionality of a mechatronic system, without the interfaces
to other systems and human operators. The logical sequence algorithm of
the controller, together with the sampling delay, is more important for this
prime functionality than the way how this algorithm is described in C-code.
When writing a book on mechatronics, the broad range of contributing disci-
plines forces a limitation in the depth to which the theory on each of these
disciplines can be treated. Where necessary for the explanation of certain
eÔ¨Äects the presented material goes deeper, but other subjects are treated in
such a way that an overall understanding is obtained without specialised in
depth knowledge of all details.
Like the work of a mechatronic engineer as system designer in a team of
specialists, this book is aimed to be a binding factor to the related spe-
cialised books, rather than one that makes these other sources of knowledge
redundant.
It is our sincere wish that this book serves its purpose.
Robert Munnig Schmidt, Georg Schitter, Adrian Rankers and Jan van Eijk

Preface
xxiii
Comments to the Third Edition
As of the second edition from 2014 several users of this book have made
comments, which again rapidly Ô¨Ålled the errata pages.
Also the many courses given by the authors at universities or with training
sessions for industrial engineers triggered attention to subjects that could
be explained better or more adapted to the present level of knowledge.
Most changes have been made in Chapter 4 on motion control, where the
focus in feedback control is shifted from pursuing a target bandwidth to a
targeted low sensitivity for disturbances in combination with high-accuracy
feedforward control using a solid trajectory planning, which is more in line
with industrial practice. For this reason the PID guidelines are replaced by
design steps that also include optimisation with loopshaping.
The presentation of ‚Äúpoles and zeros‚Äù and the diÔ¨Äerent kinds of impedances
is moved to the physics chapter as it is applied in diÔ¨Äerent chapters. The
physics chapter is the ‚Äúmust study Ô¨Årst‚Äù chapter prior to studying any of the
other chapters, as most of the used terms are introduced there.
Another change is the addition of a dB scale next to the absolute magnitude
scale in the Bode plots of the motion control chapter, because it has often
been mentioned that the use of dB is as common in the control community
as it is in the electronics community.
The redeÔ¨Ånition of the SI base units in May 2019 required slight changes in
some numbers and it further appeared useful to mention the units with the
equations to avoid confusion.
Due to the addition of several subjects also some pruning of ‚Äúancient‚Äù tech-
nology has been done. Especially the large part on linear power ampliÔ¨Åers
is reduced to the bare minimum, because at present almost all power ampli-
Ô¨Åers apply switched-mode technology.
Finally the ‚ÄúMain Design Rules for Precision‚Äù section, which was omitted
from the second edition returns at the end of Chapter 9 after a complaint of
an enthusiastic reader who worked with both the Ô¨Årst and second edition
and said he really used them.
Contributions and Acknowledgements
Besides much material from our own experience, this book also includes
material created by many other people.
Several university staÔ¨Ämembers and students have contributed to and re-
viewed the material. Some are cited in the text but even then it is impossible
to mention all without forgetting some names. For this reason only the most

xxiv
Preface
important contributors who are not cited separately are mentioned here.
The Ô¨Årst is Ton de Boer, the MSc student who had the near impossible task
to write the rough material that started this book as lecture notes by follow-
ing the lectures on Mechatronic System Design. Johan Vogel and Oscar vd
Ven, also from the Mechatronic System Design group at Delft University
of Technology reviewed the Ô¨Årst versions and helped with the physics and
electromechanics chapters, while Markus Thier from the Automation and
Control Institute at Vienna University of Technology helped with the new
section in the second edition on digital motion control.
For the third edition the comments from several colleagues from the research
groups ‚ÄúControl Systems Technology‚Äù and ‚ÄúElectromechanics and Power
Electronics‚Äù of Eindhoven University of Technology were very helpful.
Our partners from industry deserve gratitude for their support, Ô¨Ånancially,
in equipment or advice, by permission to use company illustrations or by
reviewing the material. The three most important to mention are the Dutch
high-tech company ASML and the metrology companies Heidenhain from
Germany and Agilent Technologies from the United States.
We further thank all other companies and individuals who kindly gave per-
mission to use their illustrations. Where appropriate these are separately
mentioned at the related Ô¨Ågures or cited in the bibliography.
It is true to say that this textbook is based on the knowledge of many others
as laid down in books, patents and journal articles. Several are cited in the
text but most are not, because their knowledge entered the public domain
very long ago. Still it are these giants on whose shoulders we all stand1
and who deserve our gratitude. In that respect it is worthwhile to mention
the increasing value of Wikipedia. Besides the possibility to quickly Ô¨Ånd
certain physical and mathematical terms or derivations, it also provided
information about small trivia like the date of birth or the full name of a
famous scientist from the past.
Errata
For the third edition a new dedicated website domain is created.
While the rmsmechatronics errata site (errata.rmsmechatronics.nl) will
remain for some time with the errata in the Ô¨Årst and second edition, all
errata will be published on the new website:
high-performance-mechatronics.nl
1Cited with a slight variation to the words of Bernard de Chartres ‚âà1115.

Preface
xxv
Summary
This book is intended for Bsc level students as an introduction to mecha-
tronics, for Msc-level students who want to extend their knowledge on all
aspects of advanced mechatronics and for engineers in the high-tech indus-
try who want to learn more about adjacent specialisations. To accommodate
this broad approach and deÔ¨Åne the application environment, the Ô¨Årst and
last chapter describe the waferscanners of ASML as these complex systems
are symbolic for the high level of advancement that modern mechatronic
systems have achieved.
The nine chapters are summarised as follows:
The introduction in Chapter 1 gives the context of Mechatronics in the
Dutch High-Tech Industry with the historical background, some general
observations on the international diÔ¨Äerences in approach towards mecha-
tronics and the close link with ‚ÄúSystems Engineering‚Äù. Subjects include the
development of the optical Video Long Play (VLP) disk and the wafer stepper
at Philips Research Laboratories. These developments have strongly deter-
mined the dominant position of high-precision mechatronic system design
in the Netherlands and are exemplary for the speciÔ¨Åc photon-physics ori-
ented approach in this country, quite diÔ¨Äerent from the machining oriented
approach in most other countries. The overview on systems engineering and
design introduces some functional design and development methodologies
that have proved to be crucial for the success of the high-tech industry. These
methods are based on industrial practice where complex multidisciplinary
designs have to be realised. Systems Engineering is a Ô¨Åeld closely related
to mechatronics and the corresponding principles are used in structuring
the design of a mechatronic system.
Chapter 2 on the Applied Physics in Mechatronic Systems is the Ô¨Årst
of a series of chapters on the theory behind controlled motion systems. After
an introduction to some relevant items from the mechanical domain, like
coordinate systems and the physical laws on force and motion, the chapter
introduces the core physics of electricity and magnetism as applied in mecha-
tronic positioning systems. This is followed by a section on signal theory and
wave propagation. This chapter explains why the properties of mechatronics
are so often described in frequency responses next to the real-world time-
domain related responses. The chapter also introduces the mathematical
background of diÔ¨Äerent graphical representations of frequency responses,
which are used in several chapters of this book. For reasons of historic
consciousness with most physical units the scientists who borrowed their
name to the units are mentioned with the period they lived in.

xxvi
Preface
The core of a mechatronic system is the mechanical structure that represents
the real hardware. In most cases the dynamic properties of this structure
determine the ultimately achievable control performance. Expert knowledge
of this Ô¨Åeld is a prerequisite for a mechatronic designer. For that reason
Chapter 3 deals with these Dynamics of Motion Systems and mainly
concentrates on the vibrational properties of standard mechanical elements
consisting of a multitude of springs, bodies and dampers. It includes a more
in depth treatise of modal decomposition, a method to describe the dynamic
response to external forces by means of individual vibration modes, which
allow to optimise the structural dynamics for controlled motion.
The important Ô¨Åeld of Motion Control in Chapter 4 is directly related
to the mechanical dynamics. This chapter introduces both feedforward
control for following a known trajectory and feedback control to cope with
unknown disturbances and unstable systems. The presented treatise of the
working principle and tuning of the still widely used PID controllers gives
the required background knowledge to achieve a good controller design.
The practice of loop-shaping for optimising a PID feedback controller is
introduced and the design steps to an optimal PID-controller are clearly pre-
sented. Also an introduction is given in state-space control with direct pole
placement as this method plays an increasing role in the design of mecha-
tronic systems where computer simulations and optimisation algorithms
have largely replaced experimental design. A strong emphasis is given
to the physical aspects of control. It is shown that feedback control adds
virtual elements from the mechanical domain to the system, like springs
and dampers together with new elements like an integrator and observer.
Chapter 5 on Electromechanic Actuators focuses on linear actuators
rather than standard rotating motors for several reasons. First of all many
books exist describing the application of these standard motors, while sec-
ondly in most cases they require transmissions. Finally they are aimed to be
used in oÔ¨Ä-the-shelf design solutions with limited performance speciÔ¨Åcations
which is not the scope of this book on high-performance mechatronics. This
chapter presents both electromagnetic actuators and piezoelectric actuators
as the latter are increasingly applied in precision mechatronic systems. This
chapter will help in the selection process of actuation systems and creates
a knowledge base for further study on the subject. Also the relation with
power-ampliÔ¨Åer constraints, which are presented in the following chapter,
is made clear.
Chapter 6 on Analogue Electronics in Mechatronic Systems presents
the applied electronics for measurement and power conversion and starts

Preface
xxvii
at a very basic level with passive components, because most mechanical
engineers have hardly any knowledge about electronics. The introduction
of the active components leads to their application in the basic design of
the operational ampliÔ¨Åer, the most universal and widely used analogue
electronic building block. The last section in this large chapter gives an
overview of the basic design of power ampliÔ¨Åers, which act as the energy
supplying interface between the controller and the actuators.
Chapter 7 on Optics in Mechatronic Systems gives an introduction to the
important Ô¨Åeld of optics from the perspective of a mechatronic designer. The
application of optics has become a main driver of mechatronic advancement
in the past decades. Firstly it is an application area where mechatronics
are used to control and correct optical properties of imaging systems and
other instrumentation. Secondly, optics are used to determine distances and
dimensions in a plurality of sensors, which enables the designer to create
measurement systems with extreme precision. Starting with basic physics
on optics with sources and the duality of light, an overview of geometrical and
physical optics is presented including limiting factors for the performance of
imaging systems. The chapter concludes with an introduction on adaptive
optics.
Chapter 8 on Measurement in Mechatronic Systems presents the basic
principles of sensors for force and dynamic position measurement based
on several physical principles including strain-, inductive-, capacitive- and
optical sensors. The theory in this chapter will enable the Ô¨Årst selection
of suitable sensors when designing a mechatronic system. Laser interfer-
ometry and encoders will also be presented as these are most frequently
applied in high precision mechatronic systems. Even though metrology in
general will be shortly touched, the chapter concentrates on measurement
for control. For this reason also the principle of dynamic error budgeting
is included, a statistical method to determine the total error in a dynamic
precision system from contributions of diÔ¨Äerent error sources.
As closure of the book Chapter 9 on Precision Positioning in Wafer
Scanners presents the mechatronic design in the exposure machines of
ASML, where all theory is applied to its most extreme level. This chapter
includes the basic design of positioning stages, the need for and active
control of vibration isolation, and the motion control approach to achieve a
position accuracy of less them a nanometre at speeds of more than 1 m/s
and accelerations of more than 30 m/s2. Even though the presented material
reÔ¨Çects the situation of several years ago it is still relevant for present day
engineers as the design principles as described in this book are still applied.

blank
left
intentionally
page
This

Chapter 1
Mechatronics in the
Dutch High-Tech Industry
Robert Munnig Schmidt
Introduction
This chapter positions this book in the context of the important global
position of the Dutch high-tech industry. This industry has become a main
economic growth driver with the multinational company ‚ÄúRoyal Philips‚Äù as
the most prominent original source of technical innovation. Based on their
widely diverse market scope with both consumer and industrial products,
Philips gave birth to several high-tech spin-oÔ¨Äcompanies among which
ASML would become the global market leader in exposure equipment for
semiconductor manufacturing. The Ô¨Årst part of this chapter will pay tribute
to the achievements within the research and development departments of
‚ÄúPhilips Gloeilampen Fabrieken‚Äù, as the company was named at that time.
After this short historical overview, the second section will position the Ô¨Åeld
of mechatronics on an international scale, where precision machining and
manufacturing appear to be the main application Ô¨Åelds. The last section
deals with systems engineering as a design and development framework for
the highly complex mechatronic systems that are applied in the high-tech
industry. It will also give a general overview on the related development
processes.
1

2
Chapter 1. Mechatronics in the Dutch High-Tech Industry
1.1
Historical Background
High performance mechatronics originated in the Netherlands in the seven-
ties of the past century at Philips Research Laboratories near Eindhoven. Al-
though already world famous at the time, this laboratory was humbly called
the ‚ÄúNatLab‚Äù, a name based on the original Dutch name ‚ÄúNatuurkundig
Laboratorium‚Äù. The research activities were characterised by multidisci-
plinary teamwork on subjects with an estimated large application potential.
Even though frequently this potential was far from proven and might take
a very long time to reach reality, research people with vision and ambition
got the opportunity to work on their dream.
The multidisciplinary character of the research subjects was especially ev-
ident in the Optical Research Group where in those early days a unique
combination of people worked together in close harmony on the optical Video
Long Play Disk (VLP) and the Silicon Repeater. These people were not
consciously aware of the fact that they were pioneering in a new Ô¨Åeld of
expertise. A Ô¨Åeld that later would be known under the name ‚Äúmechatronics‚Äù.
Figure 1.1: The Philips ‚ÄúNat Lab‚Äù research laboratories in Eindhoven around the
time when the real breakthrough in mechatronics took place.
(source: Philips [22])

1.1. Historical Background
3
1.1.1
Video Long-Play Disk (VLP)
In those days, only the gramophone record player and cassette recorder were
known for music playback and home registration, while for video only the
video cassette recorder (VCR) existed. Even though pre-recorded videotapes
would eventually become very popular, the general opinion was at that
time that magnetic tape would always be too expensive for the consumer
market, due to the large number of parts and expensive material in one
tape-cassette. There were already several people in the world with the idea
that a gramophone record for video would fundamentally solve that problem,
because moulding a gramophone record is not costly at all. Unfortunately,
the registration of video images in analogue technology would have required
a bandwidth of more than 4 MHz for normal Television signals and that is
more than a hundred times higher than required for the reproduction of
sound with a maximum frequency of 20 kHz in two-channel stereo. Based
on the fact that at that period in time even this 20 kHz was quite diÔ¨Écult to
achieve with a contact stylus with diamond tip, including the unavoidable
contamination of the grooves, it was not considered possible to register video
in a comparable way! The essential breakthrough in thinking was based
on the observation at Philips that a non-contact method could be designed
with optics to read-out the information from the disk. It was concluded that
light would be the most suitable medium for that purpose, because of its
ability to resolve extremely small details. With the then newly developed
Figure 1.2: The VLP Optical disk player had a contact-less optical read-out principle
with light from a Helium-Neon laser, which was focused on the track of
the disk.
(source: Philips [84])

4
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Figure 1.3: The signal on a VLP disk is coded in pits on a spiral wound track with
a variable length and frequency at a Ô¨Åxed width and mutual distance.
The frequency of the pits determined the video signal and the length of
the pits determined the audio signal.
laser as a light source and the application of precision optics, a far higher
density of information could be registered than would ever be possible by
mechanical means. This beneÔ¨Åt of contact-less read-out of a rotating disk
becomes clear when examining the registration of high-end audio with a
22 kHz signal on a gramophone record, which rotates with 33 rounds per
minute. If the signal is located on the inner groove of the disk at a diameter
of 130 mm, one period of this signal would correspond to a track-length
on the disk of approximately 10 Œºm. This means that the tip radius of
the diamond stylus can not be made much smaller than this same order of
magnitude, because otherwise the surface wear at the small contact area
would limit the lifetime of the disk. The tip radius eÔ¨Äectively limits the
detection of a shorter wavelength. Even with the most reÔ¨Åned methods,
as are presently applied in the recently revived gramophone players, the
maximum frequency that can be registered on a gramophone record is
limited to about 40 kHz. In contrast to this mechanical solution, suitable
optics and a Helium Neon Laser source with a wavelength of 633 nanometre
are able to detect details on a rotating disk with just less than a micrometre.
Compared with the 10 Œºm of the mechanical record player, this value is
less than one hundredth of the surface area per detail, which proved to be
suÔ¨Écient for the registration of an hour of video information on a disk with
the size of a normal gramophone record, as shown in Figure 1.2.
1.1.1.1
Signal Encoding and Read-Out Principle
For reason of eÔ¨Éciency, it was decided to directly write the analogue video
signal on the disk as a series of pits, tiny stripes with a variable frequency
and length. While the frequency contained the video information, the sound
was registered in the length of the pits as shown in Figure 1.3.
The pits were written in a spiral-wound track with a width of 0,4 Œºm at a
mutual distance of 1,6 Œºm on a transparent disk with the same size as an

1.1. Historical Background
5
Opcal sensor
Laser
Semi-transparent 
mirror
Lens
Protecng layer
!
"!
Out of focus scratch
Figure 1.4: The basic optical read-out principle of an optical disk by focusing a
laser beam on the track, which is embedded in the optical disk and
measuring the reÔ¨Çected intensity with an optical sensor. A scratch on
the surface of the protecting layer is not detected because it is not in
focus.
ordinary gramophone record, a diameter of 3o cm. The rotating speed would
be a factor ten higher however, with up to 30 revolutions per second, in order
to be able to handle the high frequency. Also diÔ¨Äerent to the gramophone
record was the location of the track, which no longer was embedded in a
groove, but was hidden inside the disk and detected by means of a small
spot of light through the transparent covering layer, as shown in Figure 1.4.
This protective layer appeared to be essential.
Some of the competitors, like RCA, still tried to read the information written
in a groove on the surface with the help of a stylus. In this case the stylus
was only used to follow the track, while the high frequency signal was
detected with a local capacitive sensor on the tip of the stylus. With this
splitting of functions, following and detecting, they did succeed in getting
the mechanical system operational and it has even been some time on the
market with well protected disks in cassettes to prevent contamination.
This product was in itself a signiÔ¨Åcant achievement for that time but when
compared with the contact-less optical read-out system of Philips it could
not survive. Especially the lack of sensitivity for surface scratches appeared
to be one of the big advantages of optical detection. The scratches are not
detected because they are not in the focal point of the detecting optical
system.
A problem with this principle was however the fact that no mechanical means
were available to follow the track and this created the need to look for ways to
actively control the position of the optical pick-up unit, which was designed
to read the information on the disk. It was the solution to this problem,

6
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Opcal 
pick-up unit
Opcal disk
Magnec 
system
Loudspeaker
coils
Controller
Drive
Measurement
Posion
Posion error
Figure 1.5: The active position control of the optical pickup-unit by measuring the
position from information in the reÔ¨Çected light and reducing position
errors by means of moving coil actuators.
which determined the crucial breakthrough of precision mechatronics in the
Netherlands. From the signal of a special segmented photo-diode with some
additional optics, the relative position of the optical pick-up unit to the track
could be measured and with tiny linear moving-coil motors, similar to the
ones that are used in loudspeakers, it became possible to keep the pick-up
unit right on track by means of a real fast position control system, as shown
in Figure 1.5. This so called servo-system was capable to reduce errors due
to vibrations and deviations from an ideal spiral track. Today this reduction
is achieved even in the cheapest CD-players with special digital processors
in one IC, which perform all the control tasks, but at that period in time
this control system could only be realised with operational ampliÔ¨Åers and
RC-networks, while several adjustable resistors were applied to tune the
controller.
1.1.1.2
Compact Disc and Digital Optical Recording
The VLP was the Ô¨Årst product introduced with this newly developed optical
data registration principle. However, in spite of the cooperation with MCA
for the movie software, the introduction under the name of ‚ÄúLaservision‚Äù
was not really successful. This was mainly caused by the lower than envis-
aged cost of the video cassette, while the VCR-player had the possibility of
recording video signals directly from television. The still missing possibility
of recording optical disks on a consumer product appeared to be the most
important drawback of the Laservision disk. This problem would be solved
some time later after the successful introduction of the Compact Disc player

1.1. Historical Background
7
Figure 1.6: The CD 303 was the Ô¨Årst real high-end CD player of Philips. The
complete optical read-out mechanism with the rotating motor for the
CD and the rotary arm, which carried the optical pick-up unit, was
built into a separate drawer, which would enable to load the disk from
the front. This innovation would not have been easily possible with a
normal gramophone record player.
for audio of which one of the Ô¨Årst commercial products is shown in Figure 1.6.
With many successful and less successful successors like CD-Interactive,
CDROM, CDRAM, DVD, Superaudio CD and Blu-Ray disk, optical recording
really has made a major impact in the entertainment industry. With the CD
three major developments were united, the digitisation of analogue signals,
the optical disk principle of the VLP and the invention of the semiconductor
laser, which enabled a far smaller design of the optical system. As an exam-
ple of the miniaturisation that resulted over time from these developments,
the complete mechanism of a CD-player and the optical pick-up unit from
a Blu-ray player are shown in Figure 1.7. The applied design principles
with the long-stroke, short-stroke splitting of precision and motion range
will also be addressed in the last chapter of this book on the more recent
developments in waferscanners, which was initially developed in the same
Natlab research group as shown in the next section.

8
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Figure 1.7: The optical pick-up unit in the CD-mechanism on top of this picture
is carried by a simple and inexpensive linear moving stage, which is
driven with a rotating motor and a screw-nut/gearwheel transmission.
This long-stroke linear drive roughly positions the pick-up unit to within
the capture range of the precision track-following servo-system with
the moving-coil motors of the pick-up unit. This basic long-stroke,
short-stroke positioning concept is reÔ¨Åned in later developments like
the Blu-ray disk of which an example optical pick-up unit is shown at
the bottom of the picture above the scale. This unit is designed to be
compatible with all previous CD and DVD related formats. For that
reason three diÔ¨Äerent laser sources are integrated in one unit, working
at three diÔ¨Äerent wavelengths while all light is optically combined to
one spot by means of several semi-reÔ¨Çecting cubes and lenses.

1.1. Historical Background
9
Figure 1.8: The OM 200 was the Ô¨Årst integrated circuit made by Philips in 1965.
The size was 0.75√ó0.75 mm2 and it integrated three transistors and
two resistors.
(source: Philips [91])
1.1.2
Silicon Repeater
For a long time Philips has produced its own semiconductors To support this
activity, several research groups within the Natlab were active in the global
battle to decrease the size of the details in semiconductor-based Integrated
Circuits (ICs). The Ô¨Årst commercial integrated circuit of Philips is shown
in Figure 1.8 with only a very small number of components. Gradually
the number of components increased dramatically with sometimes millions
of transistors, resistors and capacitors, which all have to be realised on
a single silicon substrate. These electronic elements are connected by a
multitude of diÔ¨Äerent layers with wiring on top of the active elements, the
light coloured regions in Figure 1.8. The technical support and design group
within the Natlab supported these developments with in-house designed
and manufactured precision equipment like the ‚ÄúOpticograph‚Äù, which could
write a mask for an IC by means of a scanning focused light beam. Among
these machines, the Silicon Repeater, of which two generations are shown
in Figure 1.9, was designed for exposing the pattern of an integrated circuit
directly on the silicon wafer. The Ô¨Årst generation (Mark 1) was designed
together with the engineering department of Philips Semiconductors in
Nijmegen, while Silicon Repeater Mark 2 was purely made inside the Natlab.

10
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Figure 1.9: The Silicon Repeaters Mark 1 and Mark 2 were the Ô¨Årst wafersteppers
of Philips and achieved an imaging resolution in the micrometre range.
They were designed as laboratory tools to enable advanced research on
IC production technology.
(source: Philips [16])
1.1.2.1
IC Manufacturing Process
In order to realise the active electronic components in the IC and the related
connection wiring, it is necessary to work the silicon material by means of
etching, oxidising or changing the properties locally by diÔ¨Äerent chemical
elements. The related process is called lithography, which name is based on
the ancient Greek words ‚ÄúŒªŒπœëoœÇ‚Äù = stone and ‚ÄúŒ≥œÅŒ±œïŒµŒπŒΩ‚Äù = writing.
The Ô¨Årst step in this process is to ‚Äúprint‚Äù the desired pattern by exposing a
light-sensitive resist layer on the semiconductor material with an intensity
pattern of light. This exposure is done by means of an optical system, which
images the mask (also called a reticle) on the resist. Subsequently, after the
development of the resist, the semiconductor material can be chemically
treated on the spots where the resist received the highest intensity, as shown
in Figure 1.10. It is essential to note that the same step has to be repeated up
to approximately thirty times, where each diÔ¨Äerent layer has to be deÔ¨Åned
in one exposure cycle, while all exposed layers have to be positioned with
a high accuracy relative to the previously deÔ¨Åned layers. In Figure 1.11 a
schematic overview of this IC manufacturing process is shown.

1.1. Historical Background
11
UV light
Recle
Si wafer
Resist
Si oxide
1:  Expose resist
2: Develop resist
3: Etch Oxide
4: Remove resist
Figure 1.10: The lithographic process is a local chemical treatment of the silicon
substrate. The treated areas are determined by a resist layer, contain-
ing a pattern, which is previously imaged from the pattern on a mask
by an optical exposure system.
 
 
 
 
 
 
 
Repeated cycles
Completed
     wafer
Etching and ion 

    Removing 
the photoresist 
#
Packaging
Slicing
Polishing

$
%
Photoresist 
$
Exposure
Developing
 and baking
Figure 1.11: IC production Ô¨Çow starting with a grown mono-crystalline silicon ingot
cut into thin slices (wafers), which undergo a multitude of chemical
treatments. The details of the integrated circuit are determined by
the optical exposure system at step 5.

12
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Light source+ light shaping
&'
()*,$/
'/
0//$
Figure 1.12: Schematic drawing of the main components of a waferstepper. The
mask is imaged on the wafer with a demagnifying lens. Only small
areas can be exposed in one exposure, because of the high opening
angle, which is required for the high resolution as will be explained in
Section 7.4.4. This requires the wafer to be exposed in steps by means
of a waferstage.
The smaller the dimensions of the active elements in an IC the lower is its
energy consumption and the higher is its performance. Together with the
continuous increase in productivity of the manufacturing process for cost
reduction by integrating more elements on a surface area, these factors are
the most important economic drivers in the semiconductor industry. The
dimensions of the details in IC‚Äôs are mainly determined by the exposure
system. Though all other process steps also need to be capable of realising
a high level of reÔ¨Ånement, the exposure step is the only one that deals with
the detailing of the circuits. For this reason the exposure step has been of
overriding importance for the developments in the semiconductor industry.
Initially the exposure was done by direct illumination through a mask,
which was closely positioned above the wafer, like shown in Figure 1.10.
This shadow mask exposure principle is however limited in resolution by
the laws of diÔ¨Äraction and suÔ¨Äers from vulnerability of the previous layers
for damage by touching the surface of the mask. To solve that issue, the
waferstepper and the waferscanner were invented.

1.1. Historical Background
13
The main components of a waferstepper are shown in Figure 1.12. The
optical projection system is located in the centre. Like a slide projector, which
projects light through a transparency and a lens to the wall, a waferstepper
projects light through a reticle and lens on a silicon wafer. The only diÔ¨Äerence
is the demagniÔ¨Åcation of the image on the silicon wafer, which is related
to the required high resolution. To realise a high resolution, the opening
angle of the lens needs to be very high as will be explained in Chapter 7 on
optics. For this reason the image has to be very close to the lens and light
should come from all directions. Exposing the entire wafer in one step would
require a lens with a very large diameter, which would be too expensive to
manufacture. It was concluded that only a small area could be exposed in
one exposure at the same time. This means that the wafer has to be exposed
in steps while it should be positioned very accurately between the diÔ¨Äerent
exposures by means of a mechanism, the waferstage. This stepping motion
has to be done extremely fast to keep the productivity on an acceptable level.
For that reason the speed of this highly accurate movement became one of
the key aspects driving the perfection of mechatronics in these machines.
1.1.2.2
Highly Accurate Waferstage
From a mechatronic perspective, the waferstage is the most important and
challenging part of a waferstepper. The required positioning accuracy of the
wafer in the Silicon Repeater was in the same order of magnitude as the
accuracy of the previously described Video Long-play Disk with an error
of signiÔ¨Åcantly less than a micrometre. Instead of following a fast moving
track, the wafer in a waferstepper has to be positioned in steps followed by
a perfect stand-still during exposure. In the Ô¨Årst machines of its kind this
standing-still had to be realised with a position repeatability of better than
0.1 Œºm on a wafer. At that time the wafer had a diameter of only 5 inch (‚âà12
cm) and with this motion range the waferstage had to perform with a better
accuracy than one over a million.
The Ô¨Årst waferstages were driven by hydraulic linear motors as schematically
shown in Figure 1.13. Precision hydraulics was a known technology Ô¨Åeld
of expertise within Philips, originating from the design of high precision
machining tools, which were needed in the laboratory to manufacture for
instance optical parts. Hydraulic cylinders and servo-valves were a proven
technology for high precision positioning under several strict conditions.
Friction in the guidings was eliminated by using hydrostatic bearings and
the temperature of the hydraulic oil was actively controlled with a maximum
deviation of ‚âà100 mK in order to reduce the inÔ¨Çuence of temperature on

14
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Figure 1.13: The Ô¨Årst waferstages had hydraulic linear motors to achieve the re-
quired stiÔ¨Äness, speed and accuracy. (source: commercial leaÔ¨Çet
Philips)
the position measurement by the laser interferometers. Another important
innovation at that time was the applied H-drive conÔ¨Åguration, where the
actuation forces all act in the same plane through the centre of mass of the
moving exposure chuck. With this waferstage a repeatability of 0.1 Œºm was
realised by using special valves, which control the diÔ¨Äerential pressure over
the hydraulic motors without any backlash by internal friction. In spite of
the good performance, hydraulic drives with the necessary high pressure
pumps and oil leaking sealings were not the most ideal mechanical parts to
be applied in a clean room of an IC factory. One incident with a bursting
high pressure tube on a prototype in the laboratory made everyone aware
of the problems related to oil. For that reason an electric alternative was
perceived to be a far better solution. In parallel to the work on hydraulics,
research was done on alternative electric designs. One was driven with
rotating servo-motors and a friction-wheel transmission while the other was
based on large range screwspindles with a piezoactuator for the precision
positioning.
The prototypes that were built with this principle showed problems with
dynamics, backlash and friction, due to the required transmission from
rotation to linear motion and eventually it was concluded that a direct-drive
linear motor would provide a real 1:1 replacement of the hydraulic drive.

1.1. Historical Background
15
Figure 1.14: With electric linear motors the waferstage became ‚Äúcleanroom-
friendly‚Äù.
The design of this direct-drive waferstage was based on the research on the
Video Long-Play Disk with its magnetically suspended optical pick-up unit.
It was recognised that those same principles could also be applied to larger
positioning systems, notwithstanding the intuitive drawback of the large
mass and it was decided to adapt the direct control principle of the VLP
pick-up unit.
The following interesting observation can be made about this important
step.
The frame of thought of precision engineering has always been Ô¨Årmly based
on the understanding that accuracy and stiÔ¨Äness are closely related. Un-
fortunately this fully correct thinking was too often translated into using
a high stiÔ¨Äness for the guiding and drive of all moving parts by motors
and mechanisms. With the optical pick-up unit of the VLP this approach
would be utterly useless as the required stiÔ¨Äness would need to relate to the
position of the optical pickup-unit and the track in order to achieve accuracy
and a stiÔ¨Ämechanical connection to the track on the rotating disk is not
possible.
Instead the optical pick-up unit had to be ‚Äúvirtually‚Äù connected to the track.
This was achieved by exerting electromagnetic forces that work opposite and
proportional to the diÔ¨Äerence between the actual and the desired position,

16
Chapter 1. Mechatronics in the Dutch High-Tech Industry
thus creating an active stiÔ¨Äconnection between the moving part and the
track.
This more abstract understanding that an accurate position can be realised
with active feedback-control stiÔ¨Äness instead of mechanical stiÔ¨Äness
appeared not easily acceptable for people who were not familiar with more
advanced high speed motion control principles. As a consequence the early
breakthroughs in mechatronics have been realised by a multidisciplinary
team where the physicists and electronic engineers introduced the new
methods, which were adapted by more modern mechanical engineers.
By means of the application of the principles from the VLP research in
the so much larger system of the Silicon Repeater waferstage, a superior
electric alternative for the hydraulic motors could be designed, which took
away one of the largest obstacles for customer acceptance of the Ô¨Årst Philips
wafersteppers.
For this reason this electrical linear motor driven waferstage, as shown
in Figure 1.14 and the cover of this book, can be seen as symbolic for the
success of the mechatronic discipline in the Netherlands.
1.1.3
Impact of Mechatronics
The two described subjects of research in their mutual mechatronic relation
within the same research group have each resulted in technological develop-
ments with impact reaching far beyond the borders of the Netherlands.
A world without optical registration of data, movies and music has become al-
most unimaginable and with the Philips daughter ASML, the Philips wafer-
stepper has become a major enabler for the overwhelming developments in
the electronic industry and the related societal eÔ¨Äects in communication
and media.
The waferstepper and its successor, the waferscanner will be further pre-
sented in Chapter 9 at the end of the book where all the theory on mecha-
tronics is combined in the design of one of the most demanding machines
that are presently on the market.
It is interesting to note that at the moment of writing the third edition of
this book in 2019 the role of optical recording has been largely taken over by
solid state Ô¨Çash-memory, a technology that would never have reached the
present impressive level of data storage capability without the continuous
developments on advanced waferscanners at ASML.

1.2. DeÔ¨Ånition and International Positioning
17
1.2
DeÔ¨Ånition and International Positioning
Mechatronic system design is a discipline across mechanical and electrical
engineering, which combines classical mechanical disciplines of static and
dynamic mechanics, thermodynamics, metrology and tribology with disci-
plines like electronics, software and optics. This combination is certainly
more than just the sum of these diÔ¨Äerent disciplines. First and foremost,
mechatronics should be considered to represent technology integration
to achieve optimal system functionality. In fact a complete mecha-
tronic product can only achieve its desired functionality through a process
of systematic integration of all inherent disciplines, right through from the
conceptual phase. Mechatronics opens up enormous technological possi-
bilities, as already evidenced in the previous section by the appearance of
sophisticated products like waferscanners and compact disc players. These
products would never have been realised by only a traditional single disci-
plinary approach.
Mechatronics is a real multidisciplinary Ô¨Åeld of expertise, a fundamental
way of realising a certain speciÔ¨Åc function where in most cases controlled
motion determines the performance. Being a design discipline, mechatron-
ics focuses on integration and synthesis rather than analysis, though the
latter is indispensable for a good understanding. Like shown in a humorist
way in Figure 1.15, mechatronics aims to give a more optimal functionality
by balancing all available technologies than would be feasible by only relying
on one specialisation.
Mechanical
Electronic / Electrical
Pneumac
Hydraulic
Chemical
Acouscal
Thermal
Opcal
Soware
Figure 1.15: Essentially mono disciplinary solutions to a problem. They might
work, but is the solution optimal?

18
Chapter 1. Mechatronics in the Dutch High-Tech Industry
1.2.1
DiÔ¨Äerent Views on Mechatronics
Many deÔ¨Ånitions exist for the Ô¨Åeld of mechatronics. The Ô¨Årst example Ô¨Ånds
its origin in Japan where the term mechatronics was Ô¨Årst oÔ¨Écially deposited:
The planned application and eÔ¨Écient integration of
‚Ä¢ mechanical and electronic technology
‚Ä¢ in a multi-disciplinary and integrated approach of
‚Ä¢ product and process design
to optimise production.
This clearly is more focused on production rather than product development
although it is both targeting application and integration.
From Europe comes the following deÔ¨Ånition, which is closer to our under-
standing:
A synergistic combination of
‚Ä¢ precision mechanical engineering
‚Ä¢ electronic control
‚Ä¢ systems thinking
in the design of products and processes.
This deÔ¨Ånition is however very wide and covers about every engineering
subject ranging from controlling chemical processes to airplanes. The rela-
tion with precision engineering is clear but precision is a relative concept.
Presently modern industries are all working towards the maximum of their
technological capabilities
It is probably true to say that these deÔ¨Ånitions in fact deÔ¨Åne mechatronics to
be the modern version of mechanical engineering. Mechanical engineering
has in its history always integrated new emerging technologies, like for
instance thermodynamics and electrical power sources.
While the term ‚Äúmechatronics‚Äù originated in the seventies of the last cen-
tury, it clearly appears to have become an integrated part of the present
mechanical engineering discipline.

1.2. DeÔ¨Ånition and International Positioning
19
1.2.1.1
Main Targeted Application
The above deÔ¨Ånitions and the international developments in the Ô¨Åeld show
some interesting observations regarding the regional diÔ¨Äerences in approach
on mechatronics. The understanding of these diÔ¨Äerences is important to be
able to eÔ¨Äectively cooperate with people from diÔ¨Äerent regions and industrial
Ô¨Åelds.
First of all the term Precision Engineering originally was used for precision
manufacturing and machining.
Research and improvements in that Ô¨Åeld concentrated on primary processes
like turning, milling, grinding and polishing combined with extensive di-
mensional and geometric metrology to check and optimise the machining
process.
When electronics and fast motion-control principles were introduced, this
machining background has clearly resulted in the Ô¨Årst mentioned Japanese
deÔ¨Ånition of mechatronics.
It is clear that this deÔ¨Ånition is related to the machining orientation of
mechatronics in Japan where the new technology was applied to reduce
Ô¨Çaws in the not active-feedback controlled machines of that time.
A clear example of later added correction means is the use of piezoelectric
actuators to reduce positioning errors in machine tools, where most of the
linear movement is done by means of rotating motors combined with preci-
sion screw spindles.
Without changing the basic concept for the long-stroke spindle positioning
system, the piezoelectric actuator was given its own feedback control system,
which had to reduce errors that originated from the screw-spindle actuator,
the machining process and external disturbances.
This approach is still an often practised way to achieve precision in ma-
chining tools with some clear beneÔ¨Åts as the disturbing cutting forces are
absorbed for a large part by the inherently stiÔ¨Äconstruction of the piezoelec-
tric actuator even before the feedback-control needs to reduce the related
position errors.
Meanwhile, in the essentially electronics and photon-physics oriented in-
dustry on consumer electronics and IC lithography exposure equipment, a
diÔ¨Äerent approach was followed.
In the previous section it was shown how the development of contact-less
optical recording had forced people in Ô¨Ånding ways to manipulate photons
in following a fast moving track.
As photons are essentially without any mass or disturbing forces, it became

20
Chapter 1. Mechatronics in the Dutch High-Tech Industry
preferred to avoid all contact with the ‚Äúdirty‚Äù interfering vibrating environ-
ment and only control the system in respect to the track on the optical disk,
which had to be read out.
This design concept resulted in a moving-coil actuated system with zero-
stiÔ¨Äness to the surroundings and an electronic control system with inherent
high virtual stiÔ¨Äness to the track on the optical disk.
The resulting precision was impressive for that time (< 0.1 Œºm).
It had only one drawback, which was related to the limited movement range
of a moving-coil actuator. This was eventually solved by adding a non critical
long-stroke mover, the described screw spindle in the later CD players, which
only had to transport the stationary part of the moving-coil actuators to
keep the precision actuator in its optimal working range. The demands
on the long-stroke actuator were so moderate that the cost of the total
system became much lower than would be the case when using piezoelectric
actuators on precision spindles, as would have been the common approach
in the machining industry.
The signatures of these two diÔ¨Äerent applications are still very visible in
the present mechatronic playground. In the USA, where the competition
in the development and manufacturing of consumer electronic products is
almost completely vanished, the machining industry determines largely
the mechatronic research and development. Only in the last several years
fast-tool servo systems with reduced mounting stiÔ¨Äness and high bandwidth
for increased precision are introduced, speciÔ¨Åcally for the manufacturing of
high quality optical parts [86].
In Japan a mixture of both approaches is practised, as in that country both
precision machining and consumer electronics are developed. Nevertheless
the more conservative machining approach is frequently observed.
Europe is in this respect interesting in its own way. The largest part of
Europe followed along the lines of the developments in the USA and focused
on precision machining and related mechatronics instead of consumer prod-
ucts related technology.
The Netherlands however went almost completely into the other direction.
First of all because there is hardly any machining industry left, while sec-
ondly several world class companies in the high-tech industry apply precision
mechatronics in professional printing, electron-optic and x-ray imaging and
in optical lithographic equipment. The corresponding photon-physics ori-
ented mechatronic approach has been instrumental in the success of these
industries and for that reason it is unavoidable that this photon-physics
oriented Dutch School of Mechatronics resonates in this book.

1.2. DeÔ¨Ånition and International Positioning
21
1.2.1.2
Focus on Precision-Controlled Motion
In view of the aforementioned considerations it was decided to use the Eu-
ropean deÔ¨Ånition of mechatronics and focus the contents of this book on
controlled motion systems with emphasis on the precision engineering and
positioning principles as applied in the Dutch high-tech industry.
A mechatronic system within this focus area generally consists of the follow-
ing main components:
‚Ä¢ A movable mechanical construction.
‚Ä¢ An electrically controllable drive to move the mechanism in its degrees
of freedom, the actuator.
‚Ä¢ An ampliÔ¨Åer to convert the electrical power to the power needed by
the actuator as function of the control output.
‚Ä¢ A measurement system to monitor the movement, the sensor.
‚Ä¢ A control part, which controls the system, the software.
Figure 1.16 shows these elements in an overview. The arrows indicate the
Ô¨Çow of information and energy, most of which takes place in the electrical
domain. This connecting function of electricity within mechatronics is also
one of the connecting elements in this book.
Controller
Posion
setpoint
Measured posion
Error
+
-

Mechanism
Energy
Informaon
Control electronics +soware
Hardware
Electrical
Power
Heatloss
Feedforward
Actuator
Mechanical
Power
Sensor
Ampli%er
6on
Figure 1.16: A mechatronic motion system consists of several elements, which are
all required for the total functionality. The left side (yellow) only deals
with information. Although fully analogue electronic realisations are
still used, presently this function is mostly implemented in software
with digital electronics. At the hardware side (blue) both information
and energy is manipulated to achieve the Ô¨Ånal goal.

22
Chapter 1. Mechatronics in the Dutch High-Tech Industry
1.3
Systems Engineering and Design
Mechatronic design is very much related to the Ô¨Åeld of systems engineer-
ing. In this section the basic principles of systems engineering and design
are introduced, because they are widely used in the high-tech industry
and present a useful framework for the multidisciplinary design of any
mechatronic system.
1.3.1
Systems Engineering Methodology
Systems engineering originated around World War 2 as a discipline to cope
with the continuous increase in complexity of machines. Before that time,
machines like airplanes, cars and ships were so fundamentally simple from
a concept point of view that almost without any exception several people
could understand the full functionality of the total system. With the in-
troduction of electronics, software and all kind of safety, diagnostics and
other surrounding information-oriented technologies in these machines, it
became a hazard or even impossible for one person to comprehend the whole
system in all its details. This development forced the industry to divide
the capabilities in design between generalists with a global overview of the
functionality of a system and specialists with an in depth knowledge of a
certain bounded discipline. This is visualised in Figure 1.17.
In view of the multidisciplinary character of mechatronics, a mechatronic
Specialist
Specialist
Specialist
Specialist
Specialist
Specialist
Specialist
Specialist
Generalist
Generalist
Breadth of
knowledge
Depth of
knowledge
Figure 1.17: Both specialists and generalists are required to design a complex
system.
(Courtesy of G. Muller, Gaudi site)

1.3. Systems Engineering and Design
23
designer is rather a generalist than a specialist and he or she needs to
keep a complete overview of a complicated system in order to be able to
act as the lead-designer of a development team. That need for a complete
overview has become more and more a real issue as the capability to act as
a real generalist with suÔ¨Écient knowledge to eÔ¨Äectively communicate with
specialists in a multitude of disciplines is something one can hardly learn
from books, but Ô¨Årst and for all by experience.
Based on this trend, a continuous eÔ¨Äort is taking place to Ô¨Ånd methods that
help to keep the problems under control, which are inherent to this increas-
ing complexity. In the following sections some basic methods are described
that are widely accepted as suitable tools for a successful completion of a
complex system design.
DeÔ¨Ånitions and V-Model
As mentioned in the previous part, a consequence of the increased complex-
ity of systems was the rise of specialists, people who knew a lot but only
about a part of the system. With as example a car, one specialist knew all
about the engine, one was specialised in the steering, one in the brakes,
one in the suspension, and later even one for the electronics and software.
One might think that it would be a perfect solution if these specialists just
communicated with each other and by virtue of some overlap would come
with an optimally designed car. Like with the mousetrap example of Fig-
ure 1.15 this does not work in real life, unfortunately. Some people are more
dominant than others and these often force a design in the direction of their
hobby (read: specialism), which is not necessarily the optimal direction.
Of course there are positive exceptions, but in many large companies and
especially in situations where safety is an issue, methods had to be devel-
oped that would make the designs less depending on individuals, in order
to achieve continuity in technological quality and performance. It was Ô¨Årst
in the professional, military and aerospace industry, where the concept of
Systems Engineering was set forth. This concept is based on a large set of
clear deÔ¨Ånitions and a visualised model, the V-model of systems engineering.
The following deÔ¨Ånitions originate with a few small adaptations from the In-
ternational Council of Systems Engineering (INCOSE1) and the Gaudi web-
site2, which provides systems architecture information and is maintained
by Gerrit Muller, professor in Systems Engineering from the Buskerud
University college.
1www.incose.org
2www.gaudisite.nl

24
Chapter 1. Mechatronics in the Dutch High-Tech Industry
System: An interacting combination of elements to accomplish a
deÔ¨Åned objective. These include hardware, software, Ô¨Årmware,
people, information, techniques, facilities, services, and
other support elements.
Systems Engineering: An interdisciplinary methodology to
enable the realisation of successful systems.
Systems Engineer: An engineer trained and experienced in
the Ô¨Åeld of systems engineering.
Systems Engineering Processes: A logical, systematic set of
process steps selectively used to accomplish systems engi-
neering tasks.
Product Creation/Generation Process (PCP/PGP): A logical,
systematic set of process steps to create/generate a product
or system.
System Architecture: The arrangement of elements and sub-
systems and the allocation of functions to them in order to
meet the speciÔ¨Åed requirements.
System Design: The activity where it is determined how the
system will be realised.
User- or Functional Requirements: The list of functionali-
ties that the customer/user would like to have in the system.
System SpeciÔ¨Åcations or SpeciÔ¨Åed Requirements: The list
of unambiguously measurable functionalities that are
planned to be realised in the system.
System Performance: The list of unambiguously measurable
functionalities that are realised after completion of the sys-
tem.
System Property: All wanted and unwanted functionalities of
a system.
Especially the terms ‚ÄúspeciÔ¨Åcation‚Äù and ‚Äúrequirement‚Äù are in practice used
with diÔ¨Äerent meanings ranging from vague terms to clearly deÔ¨Åned values
and one should be aware what is meant in each situation. The often used
term ‚ÄúRequirement‚Äù without a preÔ¨Åx is a mixture of the user- and speciÔ¨Åed
requirement and should be restricted to the initial phase of a project. Mis-
understandings can lead to wrong and costly design decisions. It is an area
where a critical attitude regarding what is really required and what is a

1.3. Systems Engineering and Design
25
Funconal requirements
Realised funcons
Detailed design
Timeline
System design
Subsystem design
Feedback loops
Figure 1.18: The V-model of systems engineering divides the design process of a
complex system both in time and in levels of complexity, in order to
organise the eÔ¨Äort over specialists and generalists.
‚Äúnice to have option‚Äù can determine the success of the project.
It is further important to note that these deÔ¨Ånitions position the Ô¨Åeld of
systems engineering as a methodology and approach to organise the de-
sign of a complex system. This means that the systems engineer role in
organising the process is not the same as the role of a system designer, who
concentrates more on the question how to make it happen. In principle and
even preferably these roles are united in one person.
The V-model of systems engineering as shown in Figure 1.18 was introduced
in the design process to visualise this way of working. The value of the model
is found in the methodology of dividing responsibilities and tasks of both
specialists and generalists over the complexity of the system. By working
with layers with increasing detail per layer, the design of a complex system
becomes manageable. Going down on the left leg of the V the following order
of events is followed:
‚Ä¢ In the ‚ÄúSystem design‚Äù top-layer the user requirements are trans-
lated into speciÔ¨Åed requirements of the total product and into user
requirements for the subsystems.
‚Ä¢ In the ‚ÄúSubsystem design‚Äù layer these subsystem user requirements
are translated into subsystem speciÔ¨Åed requirements and into user
requirements for the detailed elements.

26
Chapter 1. Mechatronics in the Dutch High-Tech Industry
‚Ä¢ In the ‚ÄúDetailed design‚Äù layer the user requirements for the detailed el-
ements are translated into drawings, software code and realised parts
with a veriÔ¨Åed performance, which can be assembled into functional
subsystems.
It is important to note that the user requirements of the lower layers are in
most cases already well deÔ¨Åned and measurable. The process to translate
these into speciÔ¨Åed requirements is mostly related to boundary conditions
that have to be respected and other detailed speciÔ¨Åcations, which are more
important for the subsystem itself than for the total system. One can think
of the use of speciÔ¨Åc tools for calibration and tuning of the subsystem in
production. After the realisation of the parts the right leg is followed upward
again to integrate these into a full functional system:
‚Ä¢ In the ‚ÄúSubsystem design‚Äù layer the engineers integrate the diÔ¨Äer-
ent parts into a working subsystem, which is tested separately in
order to verify that the performance of the subsystems meets their
speciÔ¨Åcations.
‚Ä¢ In the ‚ÄúSystem design‚Äù layer the diÔ¨Äerent subsystems are integrated
into a whole system and its performance is tested and veriÔ¨Åed.
In very complex systems the subsystem layer itself often consists of diÔ¨Äerent
layers, each with its own requirements and realised functionality. Many
levels of detailing are possible and applied in practice with even nested
V-paths to formalise the feedback from intermediate results to adapted
requirements.
The work in each layer has a diÔ¨Äerent character. The deeper one goes
towards the bottom of the V-model, the more detailed and concrete the work
will be. But also within one layer the work is diÔ¨Äerent between the left and
the right leg, due to the fact that deÔ¨Ånition and realisation require diÔ¨Äerent
skills. For this reason, often the people in the team are changed during
the project. This is not preferable from a learning perspective, because
experience with results of the realisation phase will improve the decisions
taken in the deÔ¨Ånition phase of a next project. Nevertheless, the work in
the left leg is in practice done primarily by innovator and creator types of
designers, while the right leg is realised by more completer and Ô¨Ånisher types.
In any case, frequent feedback is necessary within a project to overcome
non compliances with the speciÔ¨Åed requirements, which show up in the
veriÔ¨Åcation stage. Communication is also necessary between projects where
experience from the past is used for continuous improvement over time.

1.3. Systems Engineering and Design
27
These feedback loops over diÔ¨Äerent people need continuous attention as they
do not happen automatically.
The subsystem layer is the place where many mechatronic systems are
designed, like positioning stages and actively controlled optical imaging
systems. In the following section the work in these layers is described in the
context of a regular development according to the product creation process.
1.3.1.1
Product Creation Process
Figure 1.19 shows the time division of the product creation process, which is
commonly used in industry. The phases 0, 1 and 2 correspond to the left leg
of the V-model while the phases 3, 4 and 5 correspond to the right leg. From
practical experience it is known that many mistakes are made during the
feasibility and deÔ¨Ånition phase, when not suÔ¨Écient time and eÔ¨Äort is given
Requirements
Design
Veri%caon
Engineering
Core informaon
in dra
50%
Most informaon
available in
concept
heavier change control
Legend:
Speci%caon
preparing or updang work
full under development
0.
Feasibility
1.
De%nion
2.
System
design
3.
Engineering
4.
Integraon
& test
5.
Field
monitoring
Timeline
Yearly Cost of project
Financial Impact per decision
‚Ç¨
Figure 1.19: This standard time line of a product creation process is closely related
to the V-model and is more directly suitable for planning purposes.
The lower graph shows the yearly cost related to the eÔ¨Äect of decisions
on the Ô¨Ånancial results of the project and emphasises the need to
especially control the Ô¨Årst phases.
(Courtesy of G. Muller, Gaudi site)

28
Chapter 1. Mechatronics in the Dutch High-Tech Industry
boom-up
top-down
Key drivers
(customer, business)
Roadmap
(posioning and trends in me)
Compeon
(posioning in the market)
Ideal reference design
Prototyping, simulaon
(learning vehicle)
Bo'om-up
(technological opportunies)
Exisng systems
Operaonal drivers
(logiscs, producon, et cetera)
#%&equirements
Connued
Product Creaon
Process
Feedback
Regulaons
Figure 1.20: SpeciÔ¨Åed requirements are derived from a diverse set of input infor-
mation sources. The quality of the speciÔ¨Åed requirements determines
to a large extent the successful end result. (Courtesy of G. Muller,
Gaudi site)
to determine all factors that are at stake. In this early phase the decisions
with often the largest impact on the success of a project are made at the
lowest relative cost. This relation is schematically shown in the lower graph
of the Ô¨Ågure. Especially in this phase the systems engineer needs to have a
good overview on market demands and technological possibilities. In most
cases he closely cooperates with a product manager who takes care of mar-
keting issues and represents the end user of the product. This combination
of often only two people is to a large extent responsible for the success or
failure of a product. One might say that a badly started product creation
process can hardly be repaired while of course a good start can still end up
in a mess due to bad execution. This duo of systems engineer and product
manager has to deal with the often contradictory requirements from the
external market regarding timing, product margins and functionality. They
will deÔ¨Åne the Ô¨Ånal set of speciÔ¨Åed requirements in a process as shown in
Figure 1.20 while these speciÔ¨Åed requirements are used as input for the
development activities.
An important challenge in the act of specifying requirements is to avoid
over-speciÔ¨Åcation. A systems engineer can easily add all kind of unsur-
passable boundary conditions and take precautions for all imaginable risks
in functionality without suÔ¨Écient awareness of the incurring cost when
not-suÔ¨Éciently critical designers just use these requirements and create an
overkill in functionality. It is important to also create ‚Äúroom to move‚Äù for

1.3. Systems Engineering and Design
29
the designer by explicitly mentioning less-critical requirements.
After agreement on the speciÔ¨Åed requirements the systems engineer and
product manager also have to keep these speciÔ¨Åed requirements closely
under change control. After the integration and test of the product, this
team is often also responsible for dealing with the market response on the
product.
At all levels in the V-model, a trade-oÔ¨Ähas to be made between speciÔ¨Åed
requirements of subsystems, which have an eÔ¨Äect on the same speciÔ¨Åed
requirement of the total system. In the next section the related process of
requirement budgeting will be explained a bit more in detail.
1.3.1.2
Requirement Budgeting
In Figure 1.21 an accuracy budget of a positioning system is shown as an
example, indicating how the top-down user requirements are divided over
the diÔ¨Äerent layers of subsystems with their corresponding sources of errors.
It is clear that a systems engineer who has to deÔ¨Åne these user requirements
needs to have a thorough insight in all subsystems that contribute to the
overall end result in order to give the largest error budget to the most critical
Overall
60 Œºm
Sensors
40 Œºm
Actuaon
40 Œºm
Other
20 Œºm
Drive
20 Œºm
Guiding
30 Œºm
Other
20 Œºm
Bearings
18 Œºm
Tolerances
20 Œºm
Stability
10 Œºm
Other
10 Œºm
Grooves
10 Œºm
Balls
15 Œºm
Figure 1.21: Even a simpliÔ¨Åed accuracy budget of a positioning system with many
independent error sources already shows the choices that have to be
made in close cooperation with the design teams, who have to realise
the targeted budget.

30
Chapter 1. Mechatronics in the Dutch High-Tech Industry
subsystem. The shown calculation is only valid if the errors are random
stochastic and independent in which case one can take the square root from
the sum of squares of all contributing errors as will be further explained in
Chapter 8 on measurement.
The systems engineer also has to decide which part of the budget is al-
lowed to the smaller frequently occurring random error sources. This is
noted in the item ‚ÄúOther‚Äù in the Ô¨Ågure. This process of budgeting of user
requirements is only one half of the total activity as the top-down process
to divide the requirements is followed by a bottom-up process to determine
the corresponding speciÔ¨Åed requirements. The designers involved in this
process will often face contradictory or conÔ¨Çicting user requirements and
as a result the speciÔ¨Åed requirements are determined in negotiation with
the systems engineer with as goal a minimal eÔ¨Äect on the original targeted
full-system speciÔ¨Åed requirements. In this way the expertise of the respon-
sible subsystem designers is used to create a balanced requirement budget
without over-speciÔ¨Åcation.
1.3.1.3
Roadmapping
Figure 1.22 shows in a graphical way that the process of developing prod-
ucts takes place in a continuous Ô¨Çow of changing external inÔ¨Çuences, the
increasing demands of the market together with the also increasing techno-
logical developments. In most cases these external inÔ¨Çuences can hardly
be inÔ¨Çuenced by the design team. A good example is the development of
the Personal Computer. Initially the combination of IBM, Intel and Mi-
crosoft could determine their market approach without the need to take the
competition into account. Inevitably however, at some moment in time, the
competition like Apple and the Unix based Linux community had arisen
forcing the seemingly monopolistic PC league to listen to their customers.
Products
Market demands
Technological developments
Figure 1.22: The natural Ô¨Çow of product development.

1.3. Systems Engineering and Design
31
Product ranges
A
B
H
E
Innovaon Drivers             
Maximum speed (km/hr)
Fuel consumpon (km/l)
Acceleraon (0-100 km/hr in sec.)
Technologies                       
Diesel
Improved turbo (A)
Diesel
Improved turbo (B)
Hybrid
Hybrid technology
Electrical
All electrical
Planned acvies               
Enhanced Turbo development
Development hybrid technology
Development electrical drive in H and E
 = First shipment on a car
Improved inlet pressure turbo type A and B
Hybrid
All electrical
9
2011
2007
2008
2009
2010
130
n.a
180
9
10
150
10
10
Development Roadmap /Q/
150
13
10
8
160
10
 = Required start date 
Figure 1.23: A basic roadmap, drawn in 2007 as university lecture example, indi-
cating the diÔ¨Äerent engine-drive principles that were expected to be
developed by the car industry.
As a consequence of this competitive environment, marketing research is
needed to get a good feeling of the market dynamics and base the design
decisions on reliable estimates of future customer needs and technological
opportunities. These are key tasks of the marketing people in close coopera-
tion with their technological counterparts. For several practical reasons,
developing products can never be as continuous as the market would like. To
keep the cost down and the quality high, the diversity in parts and products
has to be limited. For this reason products are generally developed in prod-
uct families, also called platforms, which will stay in production as long as
possible. As a consequence, when the time needed for the development itself
is taken into consideration, the initial decisions on speciÔ¨Åed requirements
need to remain valid for a long time. One of the tools to systematically
support these long term decisions is the process of road mapping. This is a
strategic process, which should be done at regular intervals to act as a basis
for investments in new technologies and developments. Figure 1.23 shows a
typical example of such a roadmap just for illustration of the principle. It is
a highly simpliÔ¨Åed roadmap dealing with the engine drive-train of a car.

32
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Of course there is a large freedom in methods of road mapping and the shown
example is just one of the many possibilities to draw a suitable roadmap
for the planning of future development activities. The roadmap consists of
several layers where, like in the V-model, the upper layer deals with the
total overview of all product introductions and the lower layer with the
actual detailed plans on subsystem level. The deÔ¨Ånition of these roadmaps
is real teamwork where people from marketing, development, manufactur-
ing and other sectors all need to give their input. An additional beneÔ¨Åt of
this process is the resulting commitment of all involved people to realise
what has been agreed upon. It is in this way also clearly communicated
and understood that some developments need more time than others, like
the electrical drive in the example for which the time is mainly related to
developments on the applied batteries. A full roadmap of a product line can
consist of many diÔ¨Äerent roadmaps, which are all interrelated. A suitable
method is again based on the V-model with an overall roadmap on system
level and more detailed roadmaps on subsystem level.
1.3.2
Design Methodology
As noted in the previous part a (system) designer has to deal with several
contradictory demands:
‚Ä¢ Shorten the development time in order to get the product earlier in
the market (more proÔ¨Åt!).
‚Ä¢ Stimulate the market with a continuous Ô¨Çow of new products (increased
market share!).
‚Ä¢ Enhance product performance by adding functionality (more cost!).
‚Ä¢ Reduce product cost to increase margins (more proÔ¨Åt!).
Those items need to be balanced as they can not be achieved simultaneously
in a simple way. A good example of this balancing is the observed phe-
nomenon that, without additional measures, a reduction of the development
time will almost by deÔ¨Ånition increase the total cost of the development
process in an exponential way, while the gain in proÔ¨Åt for an earlier intro-
duction not always justiÔ¨Åes such increased cost. Especially in the high-tech
electronics industry, however, an earlier introduction can be very valuable.
A good example of the Ô¨Årst three bullets is the dramatic diversiÔ¨Åcation in
mobile phones and PDAs, being often an impulse buy where the choice is

1.3. Systems Engineering and Design
33
highly determined by emotion. As a consequence of this emotive value, an
old design is often obsolete within a few months. This problem is far less the
case for large domestic appliances, like washing machines, which mainly
have to be reliable with a very long lifetime without any surprises to the
user. Several methods were introduced in the product development process,
because of these contradictory demands, of which the following two will be
presented in the last part of this chapter:
‚Ä¢ Concurrent Engineering.
‚Ä¢ Modular design with platforms.
‚Ä¢ Agile Systems Engineering
1.3.2.1
Concurrent Engineering
The drive for total quality in the second half of the last century has forced
development activities to become a more and more rigidly planned process.
Total quality means that not only the products are expected to function
exactly like they are promised to do, but also the process to create and
produce them needs to be fully determined. One item that was high on the
priority list at that time was the reliability of the development timing and
the reduction of scrap due to unplanned repairs. This process resulted in a
strict planning with milestones and go/no-go decisions in order not to start
with a next step until all questions of the previous step were answered. This
approach had several advantages:
‚Ä¢ The planning became continuously more solid towards the end of the
process.
‚Ä¢ High investments could be postponed until really needed.
‚Ä¢ Surprises were avoided by testing prototypes in the period that long-
lead items were ordered.
‚Ä¢ Manufacturing could better prepare itself.
‚Ä¢ Development personnel could make the product and service documen-
tation during the order and delivery phase of the parts.
The process to allocate all activities essentially in series over time often
resulted in a development lead time of more than three years for an average
consumer product. To partly solve this problem, the process of concurrent

34
Chapter 1. Mechatronics in the Dutch High-Tech Industry
Planning
Start
Product de%nion
Concept design
Detailed design
Long-lead item order and delivery
Integraon and test
Producon
Planning
Start
Product de%nion
Concept design
Detailed design
Long-lead item order and delivery
Integraon and test
Producon
Concurrent (parallel) Engineering
2012
2013
Non Concurrent (serial) Engineering
2014
2015
2016
2016
2012
2013
2014
2015
Figure 1.24: Concurrent engineering results in shorter lead times by working in
parallel on diÔ¨Äerent phases of the project. It requires a high discipline
in communication and change control.
engineering was introduced as shown in Figure 1.24. Under pressure of
market needs, people started to make use of the fact that in each phase of
the development process some elements will take more time than others to
be Ô¨Ånished. It might be useful to treat these long-lead items as oÔ¨Ä-the-shelf
parts, which have to be used just as they are. This approach means that
the long-lead items should be designed Ô¨Årst and the other parts have to
adapt to the interfaces chosen for these long-lead items. In this way a hier-
archy of parts is created, which enables the designers to start earlier with
the next step in the process. An important condition to make this method
work is the use of agreed interfaces. From the computer industry several
well established interface standards are known like PCI, USB, HDMI and
(serial-) ATA to name just a few and these have helped this industry to
become as successful as it is now. For the design of mechatronic systems
the situation is less easy due to the low Ô¨Çexibility of the hardware parts
but even in that Ô¨Åeld standard interfaces are quite common with as best
example the standardisation in connective parts like bolts and nuts.
In spite of the reduction of the development time, this more parallel concur-
rent engineering approach also has some drawbacks, which need attention:
‚Ä¢ Very costly repairs in case of forgotten or overlooked interface require-
ments.

1.3. Systems Engineering and Design
35
Wafer stage
Illuminator
Recle stage
Projecon opcs
Recle handler
Wafer handler
Figure 1.25: The main modules in a waferscanner, built on the ‚ÄúTwinscan‚Äù platform
of ASML. All modules are individually upgradable giving the platform
a virtually inÔ¨Ånite lifetime in a market that demands a continuous
increase in performance.
(Courtesy of ASML)
‚Ä¢ Less time available for documenting.
‚Ä¢ Less gradual planning of development resources.
In the industries where concurrent engineering became the ‚Äúde facto‚Äù stan-
dard of operation like in semiconductor manufacturing equipment, several
methods are used to avoid these mentioned problems. First of all a formal
and intensive communication network is created, focused on exact interface
deÔ¨Ånitions. SpeciÔ¨Åed requirements are only adjusted in a disciplinary pro-
cess according to the rules of systems engineering. Secondly it appeared to
be of crucial importance to work with a modular design, which is based on a
technology platform with a lifetime of more than one product introduction.
1.3.2.2
Modular Design and Platforms
The Ô¨Årst example of a modular design around platforms is seen in the previ-
ously mentioned computer industry. A basic desktop PC consisted around

36
Chapter 1. Mechatronics in the Dutch High-Tech Industry
the time of writing of the Ô¨Årst edition of this book of several clearly distin-
guishable modules, like the power supply, motherboard, memory, processor,
hard disk, monitor, keyboard and several other smaller items. All of these
modules are in principle interchangeable for other similar modules within a
platform, where a platform is deÔ¨Åned as a certain combination of processor
and related hardware. The designers of the platform determine the inter-
faces that communicate with the peripheral electronic modules. This way
of working has enabled many electronic companies to deliver parts with
diÔ¨Äerent levels of functionality and cost. Another example of a modular
design is found in the mobile phone industry. By exchanging panels and
windows on a standard electronic circuit, a large variety of products can be
produced without changes in the basic functionality and reliability of the
new design. While the power supply and display are controlled with embed-
ded software (Ô¨Årmware), much Ô¨Çexibility is available in showing or hiding
functions depending on the market position of the speciÔ¨Åc product. Most
functions, sometimes including the camera, are integrated and depending
on the execution they are switched on or oÔ¨Äin the Ô¨Årmware or just covered
by the shell. The total cost of such a design is often even lower when some
hardware in the product is not used, than would be the case if a special
hardware version without that speciÔ¨Åc function has to be developed. This is
mainly due to the lower logistic cost related to the reduced diversity.
The last example of a modular design is the ASML waferscanner as shown
in Figure 1.25. The ‚ÄúTwinscan‚Äù platform with a dual waferstage became
the leading technology in this industry. In retrospect many reasons for this
success can be mentioned like the team spirit, commitment and drive of the
people, the partnership with Carl Zeiss and the strong mechatronic roots in
Philips. Nevertheless the modular design approach proved to be one of the
key elements of success for the following reasons:
‚Ä¢ All modules can be developed by diÔ¨Äerent suppliers at their own home
base.
‚Ä¢ All modules can individually be tested to their full speciÔ¨Åcations on
test rigs without the presence of the other modules.
‚Ä¢ All modules can be mounted and dismounted from the machine without
aÔ¨Äecting the other modules.
‚Ä¢ Duration of the installation times at the customer site is signiÔ¨Åcantly
reduced in respect to non-modular machines.
‚Ä¢ Upgrading is possible even at the customer site by exchanging modules,
which makes most machines last almost forever.

1.3. Systems Engineering and Design
37
‚Ä¢ Testing and servicing is relatively easy because all important modules
can be dismounted.
1.3.2.3
Agile and Scrum
Within software development a further extension of concurrent and modular
design, with terms like Agile and Scrum, is increasingly practised to improve
the speed and quality of development cycles.
Agile refers to the mindset targeting at increasing the agility of an organi-
sation in dealing with changing user requirements. It is especially useful in
case the customer is not yet certain about its requirements. The approach
focuses on solutions that enable experiments to achieve a more solid set
of requirements. One of the methods for achieving this is working with
the Scrum framework. With Scrum short feedback loops are created that
include the customer by providing intermediate results on a regular base.
The development process is split in iterations of 1-4 week (mostly 2) periods
called Sprints during which a speciÔ¨Åc functionality or module is designed,
integrated and tested by all members of a team, working together in one
room for eÔ¨Écient communication in one concentrated eÔ¨Äort. Changes based
on feedback by the customer are applied in the next scrum cycle until the
design is stable.
Due to the limited time required for integration and testing this approach
is better suitable with software than with hardware. Still it is worthwhile
to adapt certain elements of this method to also improve the development
process of hardware. The following list are just a few examples that can be
applied for this purpose. As so often most methods are not really new but
too often they are rejected by management as a waste of time and money,
forgetting that without intermediate checks by customers hardly any Ô¨Årst
product was perfect:
‚Ä¢ Realise and test critical functions concurrently by ‚Äúshoestring‚Äù ap-
proach, using breadboards and simpliÔ¨Åed purely functional setups.
‚Ä¢ Use fast prototyping methods like 3D printing, soft moulds etc.
‚Ä¢ Use standard of the shelf parts and complete subsystems where possi-
ble and accept higher cost of goods for Ô¨Årst versions.
‚Ä¢ Build Ô¨Årst ‚ÄúMinimum Viable Product‚Äù A.S.A.P. so one can get early
feedback from end users.

blank
left
intentionally
page
This

Chapter 2
Applied Physics in
Mechatronic Systems
Robert Munnig Schmidt
Introduction
The performance of a mechatronic system is related to its ability to generate
and control a certain movement of a mechanical structure. In general this
means that forces need to be applied to keep the structure on track while
compensating other, external forces. In case of constant external forces,
there is no real diÔ¨Éculty to control these but in reality external forces are
never really constant nor are the movements that need to be controlled.
These forces and movements change in both periodic and stochastic ways
and this means that the performance must be analysed by looking at the
response of the system to periodic signals of diÔ¨Äerent frequencies, observed
in both the mechanical and electric domain.
This chapter begins with the basic mechanics of Newton, Hooke and La-
grange describing the interaction of forces with mechanical objects. It
continues with the principles of electricity, magnetism, signal theory and
waves including the important Fourier decomposition of a signal into sepa-
rate sinusoidal signals. The chapter concludes with some frequently applied
dynamic analysis methods with graphical representations of frequency and
time responses including the important Laplace- and Fourier-transform
methodology, which is frequently applied in this book.
39

40
Chapter 2. Applied Physics in Mechatronic Systems
2.1
Mechanics
The mechanical structure is the core of a mechatronic system and in spite
of many decades of excellent designs, optimising the mechanical structure
in strength, stiÔ¨Äness, mass and endurance, the mechanical properties ul-
timately limit the performance of any mechatronic system. This section
provides a short overview of the most relevant laws of mechanics, covering
multi-dimensional coordinate systems, Newton‚Äôs laws of motion, Hooke‚Äôs
law of elasticity and the Lagrange equations of motion.
2.1.1
Coordinate Systems
Mechatronic systems are designed to realise precise relative motions of
objects. For that reason it is extremely important that the relative position
between the objects is always perfectly known. In principle it is well possible
to determine those relative motions by dedicated relative distance measuring
sensors and apply position control with actuators working in the same
direction. With less complicated systems this approach is suÔ¨Écient to
achieve a well performing system. Some more complicated systems like
a waferscanner, however, consist of several motion systems on diÔ¨Äerent
locations, which have to be operated in perfect synchronisation. In that case
it is necessary to use a reliable frame of reference where all motions are
referred to. Such a frame of reference is the applied coordinate system.
x
y
z
y - coordinate
z - coordinate
x - coordinate

*[\]*&$\$/^
Figure 2.1: a: The 3-dimensional Cartesian coordinate system determines the
position of an object in space relative to a deÔ¨Åned orthogonal set of axes.
b: The generalised coordinate system of Lagrange describes motions
according to degrees of freedom like with this example of a system,
which rotates around a centre shaft.

2.1. Mechanics
41
2.1.1.1
Cartesian Coordinate System
The Greek mathematician Euclid of Alexandria (‚àº300BC) was the Ô¨Årst to
deÔ¨Åne the shape of objects in a multi-dimensional (2,3) so called Euclid-
ian space in a comprehensive way. The Euclidian geometry described the
mathematics on plane Ô¨Ågures with for example the relation between the
angles of a triangle. Euclid also proved some proportionality relations for
three dimensional objects and his work was reÔ¨Åned over the years by many
scientists. These mathematical methods however all relate to the described
objects themselves, irrespective of their position in space. To enable a more
mathematical solid description of relative positions and shapes of objects,
the French philosopher and mathematician Ren√© Descartes (1596 ‚Äì 1650),
whose Latin name was ‚ÄúRenatus Cartesius‚Äù, introduced the Cartesian coor-
dinate system with two or three orthogonal axes (x, y, z). The orthogonality of
the axes allows a straightforward decomposition of the position of an object
in the three-dimensional space by means of a vector with three elements,
existing of the three values of each coordinate direction. This vectorial
representation is essential in examining mechatronic systems by means of
numerical calculations with computers. The numerical mathematics with
vectors and matrices is called Linear Algebra and since the introduction of
ever more powerful computers these mathematics have become the standard
method to describe dynamic systems based on either the polynomial expres-
sion of the equations of motion or the outcome of Ô¨Ånite element analysis.
In spite of its usefulness, the Cartesian coordinate system has some limita-
tions of which the most important is the lack of rotations, which is solved by
Lagrange.
2.1.1.2
Generalised Coordinate System
The Italian born French mathematician and astronomer Joseph Louis La-
grange (1736 ‚Äì 1813) introduced a diÔ¨Äerent coordinate system, which he
named the generalised coordinate system.
He introduced the term degree of freedom (DOF) for the principal motion
directions that an object can have inside the coordinate system. The degrees
of freedom only include those motion directions that are not constrained by
mounts, guides and bearings (hence the word ‚Äúfreedom‚Äù).
Even though the linear directions mostly comply with the Cartesian coor-
dinates this is not strictly required as long as the relation between both
coordinate systems is clear. The most important diÔ¨Äerence is however the
addition of rotation axes.

42
Chapter 2. Applied Physics in Mechatronic Systems
Unfortunately the term ‚Äúdegrees of freedom‚Äù has gained a meaningful exis-
tence in many other Ô¨Åelds outside mechanics. In principle any independent
physical parameter is formally deÔ¨Åned as a degree of freedom, which means
that an active controlled mechatronic system contains many more degrees
of freedom than only those of the applied mechanical structure.
In this book the general expression is applied when it is obvious what is
meant, as these are mostly related to directions and physical dimensions.
When it is necessary to distinguish the meaning from other degrees of
freedom, the preÔ¨Åx "physical" is added.
Many examples in this book are shown in only one degree of freedom per
moving object1 according to this principle, because it simpliÔ¨Åes the example.
One should however be very careful when applying this limitation to non-
constrained motions in high-performance mechatronic systems. At elevated
frequencies all theoretical constraints will in practice cause resonances due
to the Ô¨Ånite stiÔ¨Äness of the connection and for that reason a more strict
approach of a system in all six degrees of freedom per moving object entails
less risk in errors.
Often the generalised coordinate system is expressed with the term qi (with
i = 1,2,3,...,n), which notation unfortunately also is used for the modal coor-
dinate system, which is introduced in the next section and frequently used
in mechanical dynamics. In most practical situations an expanded Carte-
sian coordinate system is applied with six degrees of freedom per moving
object, consisting of three orthogonal linear translations x, y, z and three
rotations around these linear translation axes, often noted as Rx,Ry,Rz. The
chosen directions are mostly aligned with the main directions in the system,
related to motion or functionality. In view of this practical consideration
this book uses either x for movements in a single direction, x, y, z,Rx,Ry,Rz
for the expanded Cartesian coordinate system or qi (with i = 1,2,3,...,m) for
a general number of coordinate directions.
2.1.1.3
Modal Coordinate System
A third coordinate system is the modal coordinate system, which will be
introduced in Chapter 3 on dynamics. It is based on the fact that mechanical
structures will vibrate in diÔ¨Äerent characteristic eigenmodes, each with a
diÔ¨Äerent eigenfrequency and mode-shape, after excitation by an external
1It is important to note that each moving object can have up till six degrees of freedom.
This means that a complex system with a non-rigid sructure will have an inÔ¨Ånite amount of
physical degrees of freedom.

2.1. Mechanics
43
force. When observing the total vibration at one location over its degrees of
freedom, the found values consist of a combination of contributions by the
diÔ¨Äerent eigenmodes. It is often necessary to investigate each eigenmode sep-
arately, for which reason the modal degree of freedom qi (with i = 1,2,3,...,n)
is introduced, which enables to describe the decoupled response of each
eigenmode to an external force. More details will be presented later when
the necessary background knowledge on dynamics has been thoroughly
explained.
2.1.2
Force and Motion
The main property of a mechanical structure is the way how it reacts to the
presence of forces that are exerted on the system. The science of mechanics
studies this behaviour in two somewhat artiÔ¨Åcially separated Ô¨Åelds named
statics and dynamics.
‚ÄúStatics‚Äù deals with the stress levels (force per unit of surface) that are
present in the mechanical system when (quasi-)static forces are exerted on
it. It analyses the linear and non-linear strain eÔ¨Äects that are caused by
elastic and plastic deformation under these stress levels.
‚ÄúDynamics‚Äù deals with the behaviour of the mechanical system under chang-
ing forces, while often the eÔ¨Äects are linearised and limited to strain levels
well below any irreversible plastic deformation.
Mechatronic systems are controlled by variable forces and the applied me-
chanical structure should not surpass any irreversible deformation limit
under normal operating conditions. For this reason mechatronic systems
are mostly modelled with linearised dynamic models as will be presented in
the next chapter.
However, one should be aware that another non-destructive source of non-
linearity is found in a third important Ô¨Åeld of mechanics, called kinematics.
This Ô¨Åeld describes the relative movement of mechanisms consisting of
levers, springs and hinges. The relation between angles and positions is
often non-linear in such a mechanism, because of the changing angles,
and controlling these with actuators often requires special precautions to
overcome the inherent non-linearities by linearisation in a small area around
the actual position and adapting the optimal settings of the controller to
each position. The main Ô¨Åeld of application of kinematics in mechatronic
systems is in robots, which is a specialised Ô¨Åeld not treated separately in
this book. Nevertheless, the methods in this book are fully applicable after
linearising the dynamics around a working point.

44
Chapter 2. Applied Physics in Mechatronic Systems
2.1.2.1
Galilei and Newton‚Äôs Laws of Motion
The Italian scientist Galileo Galilei (1564 ‚Äì 1642) postulated several revo-
lutionary ideas on physical phenomena that were contrary to the normal
views at that time. Especially the statement that the earth rotated around
the sun caused him much personal trouble. This statement was based on his
observations on gravity where he also concluded that the gravitational accel-
eration of an object is independent of the mass of the object. The conclusion
that the earth rotated around the sun at constant speed also included that
the natural state of an object is not to return to zero speed as was commonly
thought, based on the observation on earth that no object moves unless
moved by a certain action. His opposite out-of-the-box thinking proved to be
a crucial step towards modern science. In spite of all eÔ¨Äorts by the religious
leaders to deny these important statements, his theory was adapted and
reÔ¨Åned by other scientists and it was the English scientist Sir Isaac Newton
(1643 ‚Äì 1727) who postulated (in Latin!) the following three laws based on
this new theoretical framework and his own study of gravity:
1. Corpus omne perseverare in statu suo quiescendi vel movendi unifor-
miter in directum, nisi quatenus a viribus impressis cogitur statum
illum mutare. An object will keep its momentum and direction as long
as no external force is exerted on it, which would change its state.
2. Mutationem motis proportionalem esse vi motrici impress√¶, et Ô¨Åeri
secundum lineam rectam qua vis illa imprimitur. The change of mo-
mentum of an object is proportional to the exerted force and follows a
straight line in the direction of the exerted force.
3. Actioni contrariam semper et √¶qualem esse reactionem: sive corporum
duorum actiones in se mutuo semper esse √¶quales et in partes contrarias
dirigi. When one object exerts a force on another subject the second
subject exerts the same force in the opposite direction to the Ô¨Årst object.
Newton‚Äôs First Law on Inertia
The Ô¨Årst law is a more strict formulation of the Ô¨Ånding of Galilei and presents
the force as a phenomenon that would inÔ¨Çuence momentum, the velocity
times the mass of a moving object. It is interesting to note that even today
no one knows the real meaning of ‚Äúforce‚Äù other than by its manifestation in
acceleration or deformation of an object. In fact Newton‚Äôs second law gives a
deÔ¨Ånition of force as a proportionality factor to acceleration for which reason
the unit of force has been given the name ‚Äúnewton‚Äù [N].

2.1. Mechanics
45
Newton‚Äôs Second Law on Acceleration
Written in a vectorial mathematical form to deÔ¨Åne the direction for each
degree of freedom, the second law gives the force2 as derivative of momentum
over time (p = Mv):
F(t) = dp
dt = dMv
dt
= M dv
dt = Ma
[N].
(2.1)
where M equals the mass-matrix and a equals the acceleration.
As an example the vectorial version of Newton‚Äôs second law is expanded for
a 6-DOF system of a single rigid body:
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
Fx
Fy
Fz
Tx
Ty
Tz
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
=
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
m1
0
0
0
0
0
0
m2
0
0
0
0
0
0
m3
0
0
0
0
0
0
Ix
0
0
0
0
0
0
Iy
0
0
0
0
0
0
Iz
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
¬®x
¬®y
¬®z
¬®Rx
¬®Ry
¬®Rz
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
,
(2.2)
where Tx,y,z equals the torque and Ix,y,z equals the moment of inertia around
the x, y, z-axes.
In this simple system m1 = m2 = m3 but with more complex stacked mechan-
ical constructions the moving mass in one direction can be very diÔ¨Äerent
from the moving mass in another direction. Generally a mechanical system
can be modelled as a lumped collection of many objects, each with their own
six degrees of freedom causing the mass matrix to grow into an n√ón matrix
where n equals the number of degrees of freedom for the total system.
This all underlines the value of computers when modelling complex systems.
For the basic understanding of dynamic phenomena as treated in this book,
it is fortunately often not necessary to analyse the system in all dimensions.
Even though the vectorial notation allows to retain the limited complexity of
equations of motions for movements in one coordinate direction qi = x, this
book uses scalar terms when describing these simple systems, because in
that case the vectors and matrices would all have only one non-zero element.
Newton‚Äôs Third Law on Action and Reaction
Newton‚Äôs third law is possibly the most important for precision mechatronic
systems as it is too often forgotten or neglected during the design phase. As
2Even though it is not formally correct, the force and torque are noted in this book with
the vectorial or scalar symbols F or F, respectively T or T, written in capitals, to distinguish
them from the temporal frequency f and time t.

46
Chapter 2. Applied Physics in Mechatronic Systems
will be presented in the following chapters, precision is mainly impaired by
disturbance forces acting on the system. These disturbances are often caused
by the reaction forces from actuators. These forces act on the supporting
frame and the large mass of these frames makes the designer think that the
resulting motion by the reaction forces on the frame will be small. These
frames, however, are never inÔ¨Ånitely rigid and will show resonances at
often not well correctable frequencies. For this reason it is true to state the
following:
The dynamic analysis of the eÔ¨Äects of reaction forces is equally
important in the design of a precision mechatronic system as
the controlled actuation forces to the precisely positioned object
itself.
For that reason the force in all drawings in this book is noted with a double
arrow indicating that it always acts between two objects. The direction (sign)
of the force at the point of insertion is consistent with the corresponding
coordinate system as indicated by one or more arrows, depending on the
number of degrees of freedom that are presented.
2.1.2.2
Hooke‚Äôs Law of Elasticity
The second manifestation of force is in the deformation of an object by an
exerted force and it was the English scientist Robert Hooke (1635 ‚Äì 1703),
who deÔ¨Åned the relation for elasticity of an object. It equals the incremental
change in the amount of force (dF) that an elastic element would produce in
reaction to an incremental deformation (dq). When the incremental defor-
mation is pointing in a direction, the corresponding incremental force acts
in the opposite direction. In vectorial notation according to the generalised
coordinate system Hooke‚Äôs law is written as:
dF = ‚àíK(q)dq
[N].
(2.3)
where the stiÔ¨Äness matrix K(q) consists of elasticity terms for all generalised
coordinates that correspond to the stiÔ¨Äness or spring constant ki of the elastic
elements acting in the generalised coordinate direction qi. With small
deformations the stiÔ¨Äness matrix is mostly independent of the deformation.
In that case Hooke‚Äôs law becomes linear and can be written in the following
vectorial notation in generalised coordinates and the corresponding simple
scalar equation for a system that acts on a force in one single direction along

2.1. Mechanics
47
the x-coordinate axis:
F = ‚àíKq
and
F = ‚àíkx
[N].
(2.4)
where q respectively x are equal to the displacement relative to the zero-force
position.
The stiÔ¨Äness matrix is more complicated than the mass matrix M as it
has non-diagonal terms. The Ô¨Årst reason for these additional terms is that
a spring is connected at two sides, acting in that case on two degrees of
freedom for each generalised coordinate direction. With for example the
spring from the following Ô¨Ågure with two equal but opposite external forces
acting on two connections in line with coordinate qi = x the terms of the
K matrix can be derived by the following reasoning:
F
F
x
x
1
1
2
2
‚Ä¢ A positive displacement of x1 causes a negative spring force, which
has to be balanced by a positive value of the external force F1 and a
negative value of force F2.
‚Ä¢ A positive displacement of x2 causes a positive spring force, which has
to be balanced by a negative value of the force F1 and a positive value
of the force F2.
This leads to Hooke‚Äôs law with a stiÔ¨Äness matrix block describing one spring
in one direction:
F = ‚àíKq
‚áí

F1
F2
	
=

k
‚àík
‚àík
k
	
x1
x2
	
[N].
(2.5)
The K matrix for a system with multiple degrees of freedom becomes rapidly
more complicated, resulting in non-diagonal terms that are dependent on
the force that acts on the system. For example, without a force acting in
the length direction of a spring, the stiÔ¨Äness at its two connection points
in a transversal direction, orthogonal to its length, will be zero. When a
pulling force is exerted on the spring, the resulting positive stress in the
spring will cause a positive transversal stiÔ¨Äness at the connection points.
This is well known from the transversal stiÔ¨Äness of a guitar snare upon
stretching. In an opposite way pushing forces acting on for instance a rod
will cause a negative transversal stiÔ¨Äness, corresponding to the unstable

48
Chapter 2. Applied Physics in Mechatronic Systems
toppling of an inverted pendulum under gravity forces. These relations
are described by the geometric stiÔ¨Äness matrix which can be derived from
the force balance or the virtual work for inÔ¨Ånitesimal displacements at the
connection points. With Ô¨Ånite element modelling software these relations
enable the calculation of the stiÔ¨Äness matrices for any point of a mechanical
system with any speciÔ¨Åc load case, allowing linearisation around the actual
working point.
The negative sign in Equation (2.3) indicates the fact that the force is
directed in the opposite direction of the deformation. When combining
Hooke‚Äôs law with Newton‚Äôs third law, stating that the forces of interaction
between two bodies are equal, opposite and collinear, an equal force F = Kx
must be applied in the direction of the deformation to the elastic element.
This second equation without a minus sign is also often called Hooke‚Äôs law,
which can cause confusion when it is not clearly deÔ¨Åned which force is meant,
the action or the reaction. For this reason it would be preferred to call this
second version of Hooke‚Äôs law the ‚ÄúHooke ‚Äì Newton‚Äù law even though these
two eminent scientists would probably not have liked to be named in one
term, in view of their not too well personal relation.
2.1.2.3
Lagrange Equations of Motion
The Lagrange equations of motion are introduced by the same Joseph Louis
Lagrange who introduced the generalised coordinate system for the dynamic
analysis of mechanical systems. The related mathematical analysis method
is also called Lagrange Mechanics and is created to simplify calculations
of complex systems. Instead of deriving the equations of motion by means
of strictly applying the classical mechanics laws of Newton with forces and
accelerations, it uses energy as the variable element, which is a scalar,
thereby reducing the complexity of the calculations.
The Ô¨Årst deÔ¨Åned item is the Lagrange function L, also called ‚ÄúLagrangian‚Äù,
which gives the diÔ¨Äerence between the kinetic energy Ek and the potential
energy Ep:
L = Ek ‚àíEp
[J].
(2.6)
The Lagrange equation is given in vectorial notation for all generalised
degrees of freedom by:
d
dt

‚àÇL
‚àÇÀôq

‚àí‚àÇL
‚àÇq + ‚àÇD
‚àÇÀôq = 0,
(2.7)
where q equals the position and Àôq equals the velocity in generalised coordi-
nates. The term with D is related to the dissipated energy by damping. In

2.1. Mechanics
49
m
k
x
Staonary reference
Figure 2.2: Simple lumped mass-spring system, constrained in only one degree of
freedom.
conservative systems, where no energy is dissipated, the last term equals
zero.
This equation enables to determine equations of motion as can be shown with
the simple example of Figure 2.2, showing a single DOF lumped element
model where a body with mass m is connected to the stationary reference
by means of a spring with stiÔ¨Äness k.
Starting with the Lagrangian for the single Degree of Freedom q1 = x:
L = Ek ‚àíEp = 1
2 m Àôx2 ‚àí1
2 kx2
[J].
(2.8)
With only one generalised DOF q1 = x the derivatives in the Lagrange
equation are as follows:
‚àÇL
‚àÇÀôq1
= m Àôx
‚áí
d
dt

 ‚àÇL
‚àÇÀôq1

= m ¬®x
and
‚àÇL
‚àÇq1
= ‚àíkx.
(2.9)
The system is conservative as there is no damping nor energy added to it by
external forces, so using above derivatives Equation (2.7) results in:
d
dt

 ‚àÇL
‚àÇÀôq1

‚àí‚àÇL
‚àÇq1
= m ¬®x+ kx = 0.
(2.10)
This is the standard equation of motion for an undamped single body mass-
spring system with one DOF without an external force acting on it.
With this simple example the beneÔ¨Åt of the Lagrange equations is not
really obvious as these equations can even more simply be derived from
Newton‚Äôs laws. With more complex systems, however, the Newtonian method
becomes quickly very cumbersome and prone to errors, especially with the
signs. When such complicated systems need to be studied analytically it
is preferable to use the Lagrange equations even though non-conservative
systems require the additional damping term. The examples in this book
are never really complex and often non-conservative with external forces
and internal damping for which reason the Newtonian method is used.

50
Chapter 2. Applied Physics in Mechatronic Systems
2.2
Electricity and Magnetism
The phenomenon of electricity is fundamentally based on the electric charge
composition of atoms. Atoms have a core, consisting of neutrons and protons,
with a positive charge determined by the number of protons, while neutrons
are not charged. Around the core a ‚Äúcloud‚Äù of electrons with a negative
charge neutralises the charge of the core in a stable situation where the
number of electrons equals the number of protons.
The unit of the amount of charge is [C] (coulomb), named after the French
physicist Charles-Augustin de Coulomb (1756 ‚Äì 1806), because of his work
on electricity and magnetism. As is true for many deÔ¨Ånitions in electricity,
the value of one coulomb has been determined much later than when the
initial deÔ¨Ånitions were made. Electrons and protons were not known when
the Ô¨Årst electric experiments were carried out. The charge of one electron or
proton is called elementary charge and since the 2019 redeÔ¨Ånition of the SI
base units the elementary charge is equal to exactly 1.602176634¬∑10‚àí19 C .
2.2.1
Electric Field
Charged particles like electrons and protons have as property that they
either attract each other, when their charge has an opposite sign, or repel
each other, when their charge has the same sign. For example an atom with
a lower number of electrons than its proton count will attract electrons until
its charge is neutralised again. The related electrostatic force is the driver
behind all important electric phenomena. The magnitude and direction of
this force is represented by the electric Ô¨Åeld E. Mathematically the electric
Ô¨Åeld at a distance r in the direction of unit vector ÀÜr, with its origin in the
centre of a single charged particle with charge q, is represented by the
following equation:
E(r) =
1
4œÄr2
q
Œµ ÀÜr
V/m

.
(2.11)
The term Œµ is the electric permittivity. In vacuum the value is a constant
called Œµ0, which has a direct relation with the magnetic permeability of
vacuum, Œº0 = 4œÄ ¬∑ 107 Vs/Am and the speed of light c0 = 299 792 458 m/s in
vacuum:
Œµ0Œº0 = 1
c2
‚áí
Œµ0 =
1
c2Œº0
‚âà8.85418781762039¬∑10‚àí12
As/Vm

. (2.12)
From the 4œÄr2 term in the denominator it can be concluded that the magni-
tude of the electric Ô¨Åeld is related to the surface of a surrounding sphere

2.2. Electricity and Magnetism
51
+
_
+
_
Figure 2.3: Charges have an electric Ô¨Åeld, which is directed away from the positive
charge and towards a negative charge. The electric Ô¨Åeld is graphically
represented by Ô¨Åeld lines. The density of the Ô¨Åeld lines determines
the force acting on other particles in the vicinity and the arrows of the
Ô¨Åeld lines give the direction of the force in case of a positive inserted
charge. The combined Ô¨Åeld of two opposite charges results in curved
lines, which start at the positive charge and end at the negative charge.
at distance r. This can be visualised by means of Ô¨Åeld lines as shown in
Figure 2.3. The Ô¨Åeld lines represent the direction of the electric Ô¨Åeld as
arrows and their density is proportional to the magnitude of the Ô¨Åeld. This
also means that the Ô¨Åeld is constant orthogonal to the Ô¨Åeld lines. By the
deÔ¨Ånition of unit vector ÀÜr, the direction is outward for a positive charge and
inward for a negative charge. Though the drawing is two-dimensional, in
reality the space around the charge is three-dimensional, which corresponds
to the decrease in the electric Ô¨Åeld and the corresponding density of the
Ô¨Åeld lines to the distance squared. In the lower drawing of the Ô¨Ågure the
eÔ¨Äect on the course of the Ô¨Åeld lines of two opposite charges is shown. The
connecting curved Ô¨Åeld lines are the result of the superposition principle of
electrostatic Ô¨Åelds, which means that Ô¨Åelds can be simply added together.
As a consequence, the resulting Ô¨Åeld over the equidistant plane from both
charges is zero along the plane and the Ô¨Åeld lines will cross this plane per-
pendicular, leading to the shown curved lines from one charge to the other.
The magnitude and direction of the force that is acting on a charged particle
with charge qx, inserted in a Ô¨Åeld E(r) originating from several other charged

52
Chapter 2. Applied Physics in Mechatronic Systems
r2
r1
V1
V2
Potenal di`erence
(V1 - V2)
+
q
qx
Figure 2.4: Two points at a diÔ¨Äerent distance from a charge q have a diÔ¨Äerence
in potential. When q is positive, the potential V1 is higher than the
potential V2, which means V1 ‚àíV2 is positive. A charge qx moving from
r1 to r2 will get either a increased positive potential energy when qx < 0
or a decreased negative potential energy when qx > 0.
particles, can be calculated quite straightforward as follows:
F(r) = qxE(r)
[N].
(2.13)
This force F will be directed in the direction of the Ô¨Åeld in case of a positive
inserted charge and in the opposite direction in case of a negative inserted
charge. This direction corresponds to the known phenomenon that negative
charges are attracted in the direction of a positive charge.
2.2.1.1
Potential DiÔ¨Äerence and Capacitance
The vectorial nature of the electric Ô¨Åeld and the related force is very useful
when determining physical eÔ¨Äects in for instance electron microscopes,
where charged particles have to be controlled in velocity. In electric systems,
where electrons are guided in conductive material like resistors, wires
and other elements, it is more easy to work with the scalar magnitude of
the related potential energy of a charged particle, inserted in an electric
Ô¨Åeld. What happens can best be explained when looking at two points in
the electric Ô¨Åeld at a diÔ¨Äerent distance from the Ô¨Årst charge as shown in
Figure 2.4. The potential energy is determined in the same way as with
gravitation. When a particle with charge qx moves from location r1 to r2,
the work exerted to move the particle will change its potential energy. A
movement against the force of the Ô¨Åeld will increase the potential energy,
while a movement in the same direction as the force by the Ô¨Åeld decreases
the potential energy. The energy (E) is given in the unit joule [J] named after
the English physicist James Prescott Joule (1818 ‚Äì 1889) for his important
exploratory work on energy. The change in potential energy of a charged

2.2. Electricity and Magnetism
53
particle is given by:
ŒîEp = ‚àí
r2

r1
F ¬∑ dl = ‚àíqx
r2

r1
E¬∑ dl
[J].
(2.14)
The negative sign is a direct consequence of the previous reasoning that a
movement in the same direction as the force decreases the potential energy.
This means that the potential energy of a particle with a negative value of
qx will increase with the distance to a positive charge q, as it is attracted
by charge q. This reasoning corresponds to the potential energy of a mass
under the attracting gravity force on earth. From this diÔ¨Äerence in potential
energy between location r1 and r2, the potential diÔ¨Äerence can be deÔ¨Åned,
equal for both negative and positive values of qx in order to get a number
that is independent of the charge of the particle that is inserted in the Ô¨Åeld.
This done by dividing the previous equation by qx, resulting in:
ŒîV = ŒîEp
qx
= ‚àí
r2

r1
E¬∑ dl
[V].
(2.15)
This potential diÔ¨Äerence ŒîV equals the electric potential between r1 and
r2 and gives the electrostatic potential energy per unit of electric charge
between these points.
The potential V reduces the vector Ô¨Åeld E to a scalar Ô¨Åeld without losing
information. A more regular name for the potential diÔ¨Äerence is the term
voltage (V)3 as it is directly related to the unit volt [V], which is named after
the Italian physicist Count Alessandro Guiseppe Antonio Anastasia Volta
(1745 ‚Äì 1827), because of his work on the Ô¨Årst electric batteries.
As with all forms of potential energy, this potential V is a relative quantity
as it only gives a potential diÔ¨Äerence. An absolute value can be obtained by
deÔ¨Åning the potential at a certain point to be zero. In electronics this point
is the common ground. In electrostatics often a point at inÔ¨Ånite distance
is used. This will give the following ‚Äúabsolute‚Äù potential at a distance r1
around a charge q using Equation (2.11):
V (r1) = ‚àí
r1

‚àû
E¬∑ dl = ‚àí
r1

‚àû
1
4œÄr2
q
Œµ0
ÀÜr ¬∑ dl =
q
4œÄŒµ0r1
[V].
(2.16)
3In formal notation the voltage as scalar variable should be written with lower case letters.
Due to the fact that the variable v is used for velocity and that voltage and velocity are closely
linked in actuators it is decided for this book to write the variable for voltage in capitals. To
keep formulas in a readable form also the other variables in electricity like the current I, the
capacitance C and the self-inductance L are written in capitals.

54
Chapter 2. Applied Physics in Mechatronic Systems
The capacitance C of an object is deÔ¨Åned as the relation between the charge
and the absolute potential of the object. It has been given the derived
unit farad [F], which is equal to
C/V
 The capacitance is directly given by
Equation (2.16) for a round sphere in vacuum with radius r1, resulting in:
C = q
V = 4œÄŒµ0r1
[= F].
(2.17)
With Equation (2.16) the absolute potential energy of a charge qx inserted
in the Ô¨Åeld around charge q is equal to:
Ep (r) = ‚àíqx
r

‚àû
E¬∑ dl = qx
q
4œÄŒµ0r1
[J].
(2.18)
These are positive numbers with a positive inserted charge qx, when the E
Ô¨Åeld is created by a positive charge, as this Ô¨Åeld is directed outwards.
The expressions in this section give the relation between the potential energy
change of a moving charge in an electric Ô¨Åeld. This is important for electrical
systems as moving charges represent a current and the changing energy
represents electric power.
2.2.1.2
Electric Current in Conductive Material
Conductive materials are characterised by the presence of so called free
charges that can move freely throughout the material. In solid materials,
like metals it are the negatively charged electrons that can move, while in
gaseous substances it can also be positively charged ions. For most mecha-
tronic systems the electrons are the main charge carriers.
The freedom to move is proportional to the electric conductivity œÉr in
S/m
,
where the unit Siemens [S] is named after the German Engineer Ernst Wer-
net von Siemens (1816 ‚Äì 1892 for his achievements in electrical engineering.
More regularly used is the inverse of conductivity, the electric resistivity
(œÅr) = in [Œ©m], where the unit ohm [Œ©] is named after the German physicist
Georg Simon Ohm (1789 ‚Äì 1854) for his research on resistivity of materials.
A material can be an insulator with a very high resistivity value like glass
with œÅr ‚âà1010 Œ©m and even higher with plastics that might have a resis-
tivity of œÅr ‚âà1020 Œ©m. If the resistivity is very low, the material becomes a
conductor like Copper with œÅr = 1.68¬∑10‚àí8 Œ©m. Semiconductor materials are
a special category having an electric resistivity in between a conductor and
an insulator. Unique for these materials is the possibility to change their
resistivity over a large range from fully isolating until highly conducting,
either permanently by physical/chemical modiÔ¨Åcation or dynamically in an

2.2. Electricity and Magnetism
55
electronic circuit.
When an external electric Ô¨Åeld is exerted on the material the free charges
will move, causing an electric current I in the material with a value equal to
the Ô¨Çow of charge C per unit of time through a surface. An electric current
is expressed in the SI-unit amp√®re [A], which is equal to
C/s
 and has been
named after the French physicist and mathematician Andr√©-Marie Amp√®re
(1775 ‚Äì 1836), because of the high value of his research on electromagnetism.
Inside a material the current is spread over the material in a direction and
value determined by the electric Ô¨Åeld and the local conductivity/resistivity of
the material, which can all be non-homogeneous. For this reason a vectorial
description of the relation between the current density J and its cause, the
electrical Ô¨Åeld E is uesed:
J = œÉrE
or
J = E
œÅr
A/m2
.
(2.19)
When the variables in this equation are integrated over an entire object
with two terminals, like a resistor, the electric Ô¨Åeld results in the potential
diÔ¨Äerence V in [V] over the terminals. The resistivity results in the resis-
tance R in [Œ©] between the terminals and the current density will result in
the current I in [A] through the element, giving the well known Ohm‚Äôs law:
V = IR
[V]
‚áí
I = V
R
[A].
(2.20)
This will be further elaborated on electricity in electronic elements after the
introduction of the Maxwell equations, which link electricity to magnetism.
2.2.2
Magnetism and the Maxwell Equations
Next to electricity also electromagnetic forces play a large role in mechatronic
systems. Electro magnetics is the physics area describing the phenomena
that are associated with electric and magnetic Ô¨Åelds and their interaction.
The previous presentation on electric charges is just a Ô¨Årst step into the
physics laws that describe these interactions. These basic laws are called
the ‚ÄúMaxwell equations‚Äù and will be shortly presented to a suÔ¨Écient level to
be able to apply them in the design of electromagnetic actuators as will be
presented in Chapter 5. The Scottish physicist and mathematician James
Clerk Maxwell (1831 ‚Äì 1879) formulated his equations partially based on
the work of other scientists, but the laws got his name because of the way he
combined them. The Maxwell equations are a set of four equations, with the
status of physical laws, stating the relationships between the electric and
magnetic Ô¨Åelds and their sources being charge density and current density.

56
Chapter 2. Applied Physics in Mechatronic Systems
Table 2.1 deÔ¨Ånes the variables that play a role in these laws. For a complete
overview also the electrical variables are included. Like the previously
deÔ¨Åned electric Ô¨Åeld E, the electrical current density J is a vector Ô¨Åeld
representing the movement of free, or unbound charges in space. The
electric permittivity Œµ0 has also been previously deÔ¨Åned and the electric
charge density œÅq represents the amount of unbound charge in a volume.
The magnetic Ô¨Åeld B is a vector Ô¨Åeld with unit tesla [T], named after the
Serbian-American engineer and physicist Nikola Tesla (1856 ‚Äì 1943). Like
with the electric Ô¨Åeld, it is graphically represented by the density and
direction of magnetic Ô¨Çux lines. In the design of electromagnetic actuators,
the magnitude of the magnetic Ô¨Åeld in the direction of interest is called
the Ô¨Çux density B [T]. It directly relates to the quantitative nature of the
magnetic Ô¨Çux Œ¶, with unit weber [Wb], named after the German physicist
Wilhelm Eduard Weber (1804 ‚Äì 1891), which is calculated by integrating the
magnetic Ô¨Åeld over a surface perpendicular to the direction of interest. The
magnetising Ô¨Åeld H and its related magnitude, the magnetic Ô¨Åeld strength
H have been given the unit henry [H], named after the American physicist
Joseph Henry (1797 ‚Äì 1878).
The magnetising Ô¨Åeld H drives the magnetic Ô¨Åeld B with a factor equal to
the magnetic permeability Œº. Likewise the scalar magnetic Ô¨Åeld strength H
drives the magnetic Ô¨Çux density B:
B = ŒºH and B = ŒºH
[T],
(2.21)
Table 2.1: Physical variables in electromagnetism.
Physical quantity
Symbol
SI unit
Electric Ô¨Åeld
E
V/m

Electric current density
J
A/m2
Electric charge
q
[C]
Electric permittivity in vacuum
Œµ0
As/Vm

Electric charge density
œÅq
C/m3
Magnetic Ô¨Åeld
B

T = Vs/m2
Magnetic Ô¨Çux density
B
[T]
Magnetic Ô¨Çux
Œ¶
[Wb = Vs]
Magnetic permeability
Œº
Vs/Am

Magnetising Ô¨Åeld
H
A/m

Magnetic Ô¨Åeld strength
H
A/m


2.2. Electricity and Magnetism
57
ÀÜn
S
L
dS
dl
ÀÜn
S
dS
ÀÜn
S
L
dS
dl
Figure 2.5: DeÔ¨Ånitions of the vectors ÀÜn and dl, surface S and closed loop L, which
are used for the Maxwell equations. The left drawing shows surface S,
S, which encloses a volume and is used with both Gauss‚Äôs laws. The
right drawing shows the closed loop L with its enclosed surface S and
is used with Faraday‚Äôs and Amp√®re‚Äôs law.
The word permeability stems from the verb ‚Äúto permeate‚Äù. The permeability
in vacuum is called Œº0. It has an exact value equal to Œº0 = 4œÄ¬∑10‚àí7 Vs/Am
and is a reference for the permeability of other materials.
The Maxwell equations can be written either in the integral or diÔ¨Äerential
form. The integral form is more easy for explaining the meaning and will
be used to derive the equations in Chapter 5. The diÔ¨Äerential form is better
suited for mathematical modelling. In order to keep this diÔ¨Äerential form
more easy to write down, the mathematical terms divergence (div) and
rotation (rot) are used. These are respectively the dot (div) and cross (rot)
product between the diÔ¨Äerential vector nabla (‚àá) and the vector of interest.
In the three dimensional space ‚àáequals:
‚àá=
 ‚àÇ
‚àÇx, ‚àÇ
‚àÇy, ‚àÇ
‚àÇz

.
(2.22)
With the previously deÔ¨Åned variables and using the deÔ¨Ånitions of Figure 2.5,
the Ô¨Årst Maxwell equation is written as follows:
‚Ä¢ Gauss‚Äôs law (electric):

S
(E¬∑ ÀÜn) dS = qenc
Œµ0
[Vm],
(2.23)
divE = ‚àá¬∑E = œÅ
Œµ0
.
(2.24)
This Ô¨Årst law was originally postulated by the German mathematician and
scientist Johann Carl Friedrich Gauss (1777 ‚Äì 1855). It states that the
surface-integral of the electrical Ô¨Åeld over any closed three dimensional
surface S, like for instance a sphere, equals the charge qenc enclosed within
the closed surface, divided by the electric permittivity (Œµ0). It is directly
related to Equation (2.11). With electromagnetic actuators this law is not

58
Chapter 2. Applied Physics in Mechatronic Systems
used, because in that case all electrical charges (electrons) are bound to
a conducting material, where the number of negative electrons is always
identical to the number of photons, which means that the total charge is zero.
Nevertheless this law is mentioned for completeness and also to demonstrate
the diÔ¨Äerence between electric Ô¨Åelds and magnetic Ô¨Åelds as given in the
second Maxwell equation:
‚Ä¢ Gauss‚Äôs law (magnetic):

S
(B¬∑ ÀÜn) dS = 0
[Tm2],
(2.25)
divB = ‚àá¬∑ B = 0.
(2.26)
This second law of Gauss states that the surface-integral of the magnetic
Ô¨Åeld over a closed surface S is always zero. With any closed surface, the
magnetic Ô¨Çux entering the volume within the closed surface is equal to the
magnetic Ô¨Çux that exits the enclosed volume. When represented by Ô¨Çux
lines this can only be true when all Ô¨Çux lines form a closed loop. Gauss‚Äôs law
on magnetic Ô¨Åelds is based on the observation that magnets always act as
dipoles, a north and south pole where the Ô¨Çux Ô¨Çows internally from south-
to north pole and externally back from north- to south pole. This is the main
diÔ¨Äerence with Gauss‚Äôs law on electric Ô¨Åelds, where electrical charges can
exist without a monopole counterpart and the result of the integration can
be non-zero.
Understanding of Gauss‚Äôs law on magnetic Ô¨Åelds is necessary for calculating
the Ô¨Çux in magnetic circuits. The third Maxwell equation gives the
relation between a change in the magnetic Ô¨Åeld and the resulting induced
electrical potential diÔ¨Äerence in a wire that surrounds that Ô¨Åeld.
‚Ä¢ Faraday‚Äôs law:

L
E¬∑ dl = ‚àíd
dt

S
(B¬∑ ÀÜn) dS
[V],
(2.27)
rotE = ‚àá√óE = ‚àí‚àÇ
‚àÇt B.
(2.28)
This law was originally postulated by the English chemist and physicist
Michael Faraday (1791 ‚Äì 1867). It states that the line-integral of the electri-
cal Ô¨Åeld over a closed loop L equals the change of the Ô¨Çux over time through
the open surface S bounded by the loop L, while the minus sign indicates
that the direction of the electric Ô¨Åeld is opposite to the vector dl. Faraday‚Äôs

2.2. Electricity and Magnetism
59
law is the foundation under the theory that describes the creation of electric-
ity by magnetism. It also gives values to Lenz‚Äôs law, which is a qualitative
law named after the physicist Emil Lenz (1804 ‚Äì 1865). Lenz‚Äôs law states
that a change of magnetic Ô¨Åeld will induce a current in a closed wire that
opposes the source of the current change in the wire.
When assuming a conductive wire around loop L with two ends close together,
called electrodes, a source of potential diÔ¨Äerence, called the electromotive
force Fe, is created along the wire by a changing magnetic Ô¨Åeld enclosed
by that wire. It drives the opposite charges in diÔ¨Äerent directions to the
electrodes of the coil, creating a potential diÔ¨Äerence over the electrodes. The
conversion from mechanical into electric energy also implies the opposite
eÔ¨Äect. By driving a current through an electric wire within a magnetic Ô¨Åeld
this wire will experience a force, the Lorentz force, which will be introduced
in Chapter 5.
The fourth Maxwell equation gives the principle of the creation of a
magnetic Ô¨Åeld by an electric current.
‚Ä¢ Amp√®re‚Äôs law:

L
B¬∑ dl = Œº0Ienc +Œµ0Œº0
d
dt

S
(E¬∑ ÀÜn) dS
[Tm],
(2.29)
rotB = ‚àá√ó B = Œº0J +Œµ0Œº0
‚àÇ
‚àÇt E.
(2.30)
This law, originally postulated by Amp√®re, states that the line-integral of
the magnetic Ô¨Åeld over a closed loop L, is equal to the sum of two terms.
The Ô¨Årst term represents the current Ienc that is enclosed by the loop and
the second term represents the change of the electric Ô¨Åeld over the surface
that is enclosed by the loop. This second term is in reality not relevant for
electromagnetic actuators, again due to the bound character of the charges
as mentioned with Gauss‚Äôs law on electric Ô¨Åelds. Without the second term,
this law describes the relation between a current through a wire and its
magnetic Ô¨Åeld.
When dividing the reduced form by Œº0 and using Equation (2.21) for the
relation between B and H the magnetomotive force Fm is obtained, as a
magnetic equivalent for the electromotive force:

L
B¬∑ dl = Œº0Ienc ‚áíFm =

L
B
Œº0
¬∑ dl =

L
H ¬∑ dl = Ienc
[A].
(2.31)
The unit [A] reÔ¨Çects the direct relation with the current that creates the
magnetomotive force and it is used with simpliÔ¨Åed modelling of magnetic
circuits by means of Hopkinson‚Äôs law, which will be introduced in Chapter 5.

60
Chapter 2. Applied Physics in Mechatronic Systems
2.2.3
Electric Sources and Elements
All previously presented material was still on a generic level to explain the
basic models that are used in science and engineering for electricity and
magnetism. For mechatronic systems it is necessary to apply these Ô¨Åndings
to the discrete elements that are used in real hardware. For magnetism
this is done extensively in Chapter 5 on electromechanic actuators but for
electrical circuits it is necessary to complete the theory a bit more with
sources of electricity and resistances as it is applied in most of the following
chapters.
2.2.3.1
Voltage Source
By actively separating charges, a source of potential diÔ¨Äerence is created,
which is called a voltage source. A voltage source has two interface points
with the outside world, called electrodes or terminals, of which the positive
electrode has a more positive potential than the negative electrode. The
voltage source can supply a continuous Ô¨Çow of electrons, running from
the negative electrode towards the positive electrode through an external
conductive load. This electron Ô¨Çow is represented in electric circuits by a
positive current, Ô¨Çowing from the positive electrode to the negative electrode
in the opposite direction of the negatively charged electrons.
To achieve the separating action between the negatively charged electrons
and the stationary positively charged protons, a voltage source can be imag-
ined to possess an internal electric Ô¨Åeld, which is directed from the negative
to the positive electrode. Like explained in the previous section with Fara-
day‚Äôs law, this Ô¨Åeld drives the electrons away from the positive electrode
towards the negative electrode. The resulting surplus of electrons at the
negative electrode with the corresponding lack of electrons at the positive
electrode results in a charge diÔ¨Äerence and corresponding electric Ô¨Åeld be-
tween the electrodes at the outside of the voltage source. This external
electric Ô¨Åeld is equal to the internal ‚Äúdriving‚Äù Ô¨Åeld, however it is pointing in
the opposite direction.
Electromotive Force
These opposite directions between the external and internal Ô¨Åeld can be
confusing, when using the deÔ¨Ånition of potential diÔ¨Äerence as the nega-
tive integral of an electric Ô¨Åeld over a certain distance. This is still valid

2.2. Electricity and Magnetism
61
for the external Ô¨Åeld outside the voltage source, with a positive potential
diÔ¨Äerence between the positive electrode and the negative electrode. For
the internal Ô¨Åeld this same potential diÔ¨Äerence should be calculated by
taking the positive integral of the internal Ô¨Åeld. To avoid the confusion,
this positive integral of the internal Ô¨Åeld in a voltage source was given the
name ‚Äúelectromotive force‚Äù because it really acts as a force that moves the
electrons.
When Ei is this internal electric Ô¨Åeld, with e1 and e2 as the electrode locations
and dl as the inner path between the electrodes, the following value for the
electromotive force of a voltage source is found:
Fe =
e2

e1
Ei ¬∑ dl
[V].
(2.32)
It is easy to see the relation with Faraday‚Äôs law where a voltage over a wire
loop is created by a changing magnetic Ô¨Åeld inside that loop.
It is less straightforward to imagine the internal electromotive force-Ô¨Åeld
with the other well-known method to generate electricity based on chemical
processes in batteries, because in that case the potential diÔ¨Äerence is the
result of the diÔ¨Äerence in chemical potential of the applied elements. Espe-
cially with a battery it is more easy to just use the chemical electromotive
force as a given entity, which causes the observed potential diÔ¨Äerence over
the electrodes.
The value of this electromotive force is equal to the potential diÔ¨Äerence of the
external Ô¨Åeld when no load is applied. In that case, due to the equilibrium
between the electromotive force and the external potential diÔ¨Äerence, no
further separation of charge can take place. This means that no current will
Ô¨Çow inside the voltage source, when it is not connected to a load. As soon
as an electrically conducting load is connected to the voltage source, the
potential diÔ¨Äerence will drive electrons from the negative electrode through
the load to the positive electrode. The number of electrons Ô¨Çowing through
the load will be replenished by a Ô¨Çow of ‚Äúnew‚Äù electrons, driven by the elec-
tromotive force, because of the required balance between the electromotive
force and the potential diÔ¨Äerence. This process of continuous electron Ô¨Çow
is equivalent to a continuous Ô¨Çow of positive current, inside the source from
the negative electrode to the positive electrode and through the load from
the positive to the negative electrode.
This reasoning is valid for an ‚Äúideal‚Äù voltage source. In reality a voltage
source will also show some internal imperfections, which cause the voltage
at the electrodes to be diÔ¨Äerent from the electromotive force, depending on

62
Chapter 2. Applied Physics in Mechatronic Systems
the current level. This phenomenon will be presented further in Chapter 6
on electronics. In that chapter also the current source will be introduced,
which drives an electric current through a load with a magnitude that is in-
dependent of the load. It has an inÔ¨Ånite capability to adapt the electromotive
force to any load, such that the current remains constant.
2.2.3.2
Summary on Voltage and Current
The following summarises the most important relations:
‚Ä¢ An electric current is a physical representation of a positive entity. The
real current in most electric circuits is the movement of the electrons
in the opposite direction of the current due to their negative charge.
‚Ä¢ The electric Ô¨Åeld inside a source or a load is pointed in the direction of
the positive current.
‚Ä¢ A voltage source is based on a sustained electric Ô¨Åeld, represented
by its electromotive force, which drives the electrons to the negative
electrode.
‚Ä¢ The voltage source creates an external electric Ô¨Åeld, represented by its
potential diÔ¨Äerence, which is directed from the positive to the negative
electrode, so opposite to the internal electric Ô¨Åeld in the source. the
external potential diÔ¨Äerence drives a current through an electric load
from the positive to the negative electrode.
‚Ä¢ The electromotive force from the source is equal to the potential diÔ¨Äer-
ence of the external electric Ô¨Åeld and this potential diÔ¨Äerence is mostly
just called ‚Äúvoltage‚Äù.
2.2.3.3
Electric Power
When a charge moves through an electric Ô¨Åeld, its potential energy Ep
changes as it moves to a location with a diÔ¨Äerent electric potential V. When
observing an electric system charges move continuously through the system
according to the electric Ô¨Åeld placed over the charges. The delivered energy
of an electric source is equal to the increased potential energy by the elec-
tromotive force. The physical property ‚Äúpower‚Äù (P) of a system is equal to
the derivative over time of the energy and has been given the unit watt [W],
named after the Scottish mechanical engineer James Watt (1736 ‚Äì 1819) to

2.2. Electricity and Magnetism
63
honour his essential contributions to the steam engine, which was the Ô¨Årst
widely used source of mechanical power. For an electric source the power
is calculated by taking the diÔ¨Äerence of the Potential energy of the total
charge Ô¨Çowing into the source and the potential energy of the equal total
charge Ô¨Çowing out of the source.
With this deÔ¨Ånition the power can be expressed as follows when a total
charge qt Ô¨Çows through the source:
P = dEp
dt = dEp,out
dt
‚àí
dEp,in
dt
= dqtVout
dt
‚àídqtVin
dt
= ŒîV dqt
dt
[W].
(2.33)
With the current deÔ¨Åned as I = dqt/dt [A] this gives the familiar expression
for electric power:
P = V ¬∑ I
[W].
(2.34)
The signs of the variables are very important in order not to confuse with
what power is calculated. It was shown that an electron as being a negative
charge moves towards a decreasing negative potential while a positive charge
on its turn would experience a force in the direction of a decreasing positive
potential. This means that the electric potential energy of an electron
moving inside an electric element decreases due to this movement and the
corresponding power becomes available in another form, for instance the
dissipated heat in a resistor or in mechanical work in an electric engine. For
the source it is just the opposite as the internal electromotive force drives
the electrons to a higher potential. Fortunately, for most situations the
classical model of a positive electric current with a positive power delivered
when the current Ô¨Çows out of the positive electrode (same direction) is
perfectly suitable. Only when really working with electrons, like in electron
microscopes, one should remain aware of the sign and direction diÔ¨Äerence.
In this book the positive direction of a current is deÔ¨Åned by the pointing
direction of a single arrow while the positive direction of the potential
diÔ¨Äerence is given by a + and ‚àísign adjacent to a double arrow to indicate
the relative potential diÔ¨Äerence.
It should also be noted that the units after the equations will further in this
book most often be omitted when it is obvious what is meant.
2.2.3.4
Ohm‚Äôs Law
Figure 2.6 shows a basic electric circuit. It consists of a voltage source and a
resistive load R with unit ohm [Œ©] connected between the electrodes, causing
a current to Ô¨Çow through the circuit. In the next section the load will be

64
Chapter 2. Applied Physics in Mechatronic Systems
Voltage
source
Resistance R
+
_
Current  I
V
+
_
Figure 2.6: Basic electric circuit consisting of a voltage source and a resistive load.
The current is proportional to the voltage and inversely proportional
to the resistance, following Ohm‚Äôs law. The notation of the potential
diÔ¨Äerence is given with a double tip arrow where the signs are noted to
deÔ¨Åne the direction from + to ‚àí.
extended to a complex load, but originally Georg Simon Ohm based his
well-known law on the research he did using the electric batteries of Volta.
With the constant, not time dependant, voltage of batteries the current in
the circuit is only dependent on the resistivity in the electric circuit. For
this reason Ohm‚Äôs law gives the relation between the current I, voltage V
and resistance R of this electric system:
V = IR
[V]
‚áí
I = V
R
[A].
(2.35)
With this clear relation the electric power delivered by the source, and
dissipated as heat in the resistance, is as follows:
P = IV = I2R = V 2
R
[W].
(2.36)
This squared, non-linear relation is a typical characteristic of power and
energy. The following example underlines the importance to be aware of this
phenomenon in mechatronic systems: An increase of the force of an actuator
requires an increase of the current. This increase results in a squared
increase of the power dissipated in the series resistance of the actuator. A
conÔ¨Åguration that was just safe from a thermal point of view, can become
suddenly overheated, when only a seemingly limited increase of the current
is applied.

2.2. Electricity and Magnetism
65
2.2.3.5
Practical Values and Summary
Practical values of voltage show a very wide range:
‚Ä¢ MV : The level of a lightning stroke.
‚Ä¢ kV : The level used in power distribution.
‚Ä¢ V
: Mains supply, power supply of electronics, digital electronics.
‚Ä¢ mV : Small signals in measurement sensors.
‚Ä¢ ŒºV : Extremely small signals, ‚Äúburied‚Äù in noise and interference.
‚Ä¢ nV : Unmeasurable.
In practice the term nV is only found in expressions like nV/

Hz, which
relates to the density of noise in a certain frequency band.
Practical values of current show a similar range:
‚Ä¢ kA : Power distribution.
‚Ä¢ A
: Mains, household equipment, actuator input current.
‚Ä¢ mA : Small signals, power supply of low power electronic circuits.
‚Ä¢ ŒºA : Small signals, sensors.
‚Ä¢ nA : Extremely small signals, ‚Äúburied‚Äù in noise and interference.
‚Ä¢ pA : Hardly measurable, Scanning Tunnelling Microscope (STM) probe.
In table 2.2 the most relevant deÔ¨Ånitions are summarised.
Table 2.2: SI units for electricity.
Physical quantity
SI unit
Variable
Relation
Charge
coulomb [C]
C
Current
amp√®re [A]
I
A =C/s
Potential diÔ¨Äerence
volt [V]
V
V =J/C = Nm/As
Resistance
ohm [Œ©]
R
Œ© = V/A
Power
watt [W]
P
W = VA

66
Chapter 2. Applied Physics in Mechatronic Systems
2.3
Signal Theory and Wave Propagation
Electric voltages and currents are generally not constant over time. The
variability of these voltages or currents contain information about their
origin, for which reason they are called electric signals.
In physics a signal represents any value with a variability over time and/or
space, the temporal or spatial variability. An example of temporal variability
is sound, which changes over time in amplitude and tonal character. In
mechanical engineering a position dependent force is an example of spatial
variability. In optics, spatial variability represents the diÔ¨Äerence in inten-
sity of light as function of the location on a surface. In a mathematical sense
both spatial (f (x)) and temporal (f (t)) variability can be treated the same
way, when x is exchanged with t or vice versa in the relevant formulas.
Electric signals in mechatronic systems are always temporal even though
the signal can be derived both from temporal and spatial physics phenomena.
The latter are translated into the time-domain by for instance a scanning
movement with a constant velocity and measuring with a clear time refer-
ence. For this reason, the following part of this chapter will mainly deal with
temporal varying signals while in Chapter 7 on optics the spatial variability
will mainly be used.
2.3.1
The Concept of Frequency
The variation of an electric signal over time can be seen as a combination of
three types of behaviour:
‚Ä¢ Constant, unidirectional, called DC from Direct Current.
‚Ä¢ Periodically alternating, bidirectional, called AC from Alternating
Current.
‚Ä¢ Random, stochastic, called noise.
The DC value of an electric signal equals the average value of the current over
time. For an alternating signal the term temporal frequency is deÔ¨Åned as
the number of occurrences of a certain event per unit of time. Consequently
one can deÔ¨Åne the time period related to this frequency as the time that
passes between regular events. In SI units the frequency with variable-
symbol (f ) is expressed in the unit Hertz [Hz] named after the German
physicist Heinrich Hertz (1857 ‚Äì 1894). The time period of one cycle, with

2.3. Signal Theory and Wave Propagation
67
A
t
A cos(t)
A sin(t)
x
y 
t = 0
Figure 2.7: Polar representation of a harmonic function with a continuous changing
angle over time (œï = œât).
variable-symbol (T) in seconds [s] is inversely proportional to f , giving:
T = 1
f
[s].
(2.37)
In physics and engineering the term angular frequency with variable-symbol
(œâ) is often used. This frequency is directly related to the mathematical
description of harmonic oscillations, deÔ¨Åned by the sine or cosine of an angle
changing with a constant angular speed œâ, each with a peak value xp and
yp equal to the amplitude A, as shown in Figure 2.7:
x(t) = xp cos(œât) = Acos(œât)
and
y(t) = yp sin(œât) = Asin(œât).
(2.38)
When these harmonic sine and cosine functions are presented in a graph,
this results in a graphic wave shape as shown in Figure 2.8. Though this
is not a real physical wave, the term ‚Äúwaveform‚Äù is often also used for this
graphic representation of an alternating signal because of its shape. When
œâ is constant, the horizontal axis is also a time line where 2œÄ equals the
period T. This means that the angular frequency is directly related to the
temporal frequency, because one period T equals a full circle being an angle
(œï) of 2œÄ radians:
œâ = 2œÄf
[rad/s].
(2.39)
It is important to never forget the 2œÄ diÔ¨Äerence as this is one of the traps
even experienced designers encounter. In this book both herz and radians
will be used. The [Hz] units are applied with the practical examples and
several graphical representations, where the relation with periodicity and
multiplicity of events is more clear. It is often more related to the real world

68
Chapter 2. Applied Physics in Mechatronic Systems
0

2

3
2
2
5
2
3
7
2
4
z 1
z 0.8
z 0.6
z 0.4
z 0.2
0
0.2
0.4
0.6
0.8
1
 
 
Sine
Cosine
 ()
x,y 
y() 
x() 
Amplitude
x
y
p
p
Figure 2.8: Graphical representation of the harmonic function of Figure 2.7 at an
amplitude A = xp = yp = 1.
and human understanding. The
rad/s
 unit is mostly used for mathematical
analysis and the relation with physical eÔ¨Äects.
When two signals with the same frequency like the sine and cosine of Fig-
ure 2.8 are compared, than the sine is shifted with an angle œï = œÄ/2 in respect
to the cosine. This time relationship is called phase and is one of the most
important parameters in a controlled motion system because a negative
phase shift represents time delay, which can cause instability when applying
negative feedback. For practical reasons this phase shift is expressed in
degrees (‚ó¶), because of the small numbers involved. A 30¬∞phase shift can
have a large impact while it is less than œÄ/4. Though the degree is not an
oÔ¨Écial SI unit, it is widely accepted to be used in this context.
A simple thought experiment can be done on position, velocity and accelera-
tion with a body that vibrates in the x direction with a sinusoidal movement
x(t) = xp sin(œât) = xp sin(2œÄf t) with a peak amplitude equal to xp = 1. The blue
line in Figure 2.9 shows that the position at œÄ/2 is stationary. This means
that the velocity is zero, corresponding to the green line drawn at the cosine
function. Also when observing for instance the steepest down slope of the
position at œÄ it shows that then the velocity is maximum negative, which is
logical. This reasoning can be repeated at any position in the graph. For
the relation between velocity and acceleration the same reasoning results
in the red line drawn as ‚àí1 times the sine function.
In fact by just looking at the graph, it is visually veriÔ¨Åed that the mathe-
matics are correct. After all, when the position x(t) can be described as:
x(t) = xp sin(œât)
[m],
(2.40)
then the velocity v(t) equals the derivative of position over time:
v(t) = dx(t)
dt
= Àôx(t) = vp cos(œât) = xpœâcos(œât)
‚áí
vp = xpœâ
[m/s]. (2.41)

2.3. Signal Theory and Wave Propagation
69
0

2

3
2
2
5
2
3
7
2
4
z 1
z 0.8
z 0.6
z 0.4
z 0.2
0
0.2
0.4
0.6
0.8
1
 
6
Velocity

 
Figure 2.9: Two periods of the position, velocity and acceleration of a body with
a sinusoidal alternating movement: x(œât) = xp sin(œât) with xp = 1 and
œâ = 1.
And the acceleration a(t) equals the derivative of velocity over time:
a(t) = dv(t)
dt
= d2x
dt2 = ¬®x(t) = ‚àíap sin(œât) = ‚àíxpœâ2 sin(œât)
m/s2
‚áí
ap = xpœâ2.
(2.42)
The visual representation is however not fully representative for the real
situation, because it only gives the right answer on the amplitude of velocity
and acceleration for a speciÔ¨Åc frequency when œâ = 2œÄf = 1. These amplitudes
at another frequency can be found by straightforward reasoning, as a higher
frequency means a faster change. For a constant position amplitude, the
amplitude of the velocity increases proportional with the frequency and the
amplitude of the acceleration with the frequency squared.
As a second step, the phase relationship between these three parameters is
important. The graph is just a time sample of an endless continuous signal
and it could be concluded that velocity either advances on position with a
phase of œï = œÄ/2 [rad] ‚âú90‚ó¶or lags with a phase of œï = 3œÄ/2 [rad] ‚âú270‚ó¶. The
second option is however not logical as the position of an object is the result
of and thus comes after the velocity. In mathematics this is noted in the
following way:
x(t1) = x(t0)+
t1

t0
v(t)dt
[m].
(2.43)
Where x(t0) is the starting position at t0 and x(t1) is the position at t1. This
same relation can be written between the velocity and the acceleration,
resulting in a œï = œÄ/2 [rad] ‚âú90‚ó¶phase delay of the velocity in respect to the
acceleration. In combination this means that the acceleration advances on
the position with œï = œÄ [rad] ‚âú180‚ó¶.

70
Chapter 2. Applied Physics in Mechatronic Systems
2.3.1.1
Random Signals or Noise
The third kind of signals next to DC and AC is noise. Noise is a real random
non-deterministic signal, which means that the signal value at any time
of observation can have any value within a certain range. The range is de-
scribed by means of a statistical distribution, which indicates the probability
that the value is within that range. In Section 2.3.4 it will be explained how
random signals in the time-domain are composed of an inÔ¨Ånite amount of
frequencies in the frequency-domain. Also the distribution of these frequen-
cies, called a frequency spectrum, can only be described in statistical terms.
Noise is sometimes named with a colour term to indicate their frequency
spectrum like white noise with an equal presence of all frequencies over the
entire frequency spectrum or pink noise when the low frequency components
are more stronger present than the high frequency components
High performance mechatronic systems exist by virtue of predictable and
well controlled dynamics of the motion systems and to that respect random
signals are by deÔ¨Ånition a part of the possible disturbances, which impair
the functionality. The only thing one can do is avoid or suppress the eÔ¨Äects
of noise but it can never be cancelled as that would require knowledge of
future values and then the signal would no longer be random. The reduction
of noise has always been an important area of research by determining the
mechanisms behind the noise in order to improve the predictability and at
least Ô¨Ålter out the systematic eÔ¨Äects, which occur at regular intervals.
Noise and its statistical analysis is examined more in depth in Section 8.1
on Dynamic Error Budgeting where it will be explained how to deal with
random disturbances in precision measurement and positioning systems.
2.3.1.2
Power of Alternating Signals
Sometimes electronic signals are represented by their power value, being
the squared momentary value. This notation is for instance useful, when
determining the impact on accuracy of diÔ¨Äerent random disturbance signals
on a system. In case of a voltage signal, this power value would be equal to
the power dissipated in a 1 Œ© resistor, as in that case the current would be
equal to the voltage. In an alternating signal the power also varies over time.
With a purely resistive load, the power is always positive, with Ps ‚àùsin2(œât).
Although the power can be negative, when the current and the voltage have
a diÔ¨Äerent sign.
When examining the power of a signal, as deÔ¨Åned by the squared momentary
value, often the average power over time Ps is taken as a representative

2.3. Signal Theory and Wave Propagation
71
number, which is equal to the following expression for any time variable
signal function f (t):
Ps = 1
T
T

0
‚å©f (t)‚å™2 dt
[W].
(2.44)
In the example of a voltage signal over a 1 Œ© resistor this average power
level would be equal to the power dissipated in the resistor by a DC voltage
with a value of:
V(rms) =




 1
T
T

0
‚å©f (t)‚å™2 dt
[V].
(2.45)
The term ‚Äúrms‚Äù refers to Root Mean Square (RMS), named from the action
of taking the root of the mean value of the squared function. The RMS
value is a well-known term in electrical engineering to characterise the
‚Äúuseful‚Äù value of the mains energy supply with a sinusoidal alternating
voltage V = Vp sin(œât) by comparing it with an equivalent DC voltage that
would cause the same power in a resistive load.
The equivalent DC voltage becomes:
V(rms) =




 1
T
T

0
(Vp sin(œât))2 dt = Vp




 1
T
T

0
sin2(œât)dt
= Vp




 1
T
T

0
1‚àícos(2œât)
2
dt = Vp

1
T
 t
2 ‚àísin(2œât)
4œâ
T
0
[V].
(2.46)
By deÔ¨Ånition the RMS value has to be calculated over inÔ¨Ånity to converge.
Fortunately with repetitive periodically alternating signals, the value is
equal to the integration over n times the full period of the signal, where n
is an integer. This means that the double frequency sine term will average
to zero and the Ô¨Ånal result becomes:
V(rms) = Vp

1
T
 t
2
T
0
= Vp

T
2T = Vp

2
[V].
(2.47)
The 230 V AC mains supply in the Netherlands is the RMS value of the
voltage so the peak value (=amplitude) equals Vp =

2¬∑230 = 325 V.
Like with the voltage, the RMS value of a sinusoidal current with a peak
value Ip will equal Irms = Ip/

2. The average power of the combined alter-
nating voltage and current will then be equal to P = V(rms)I(rms) = 0.5¬∑VpIp.

72
Chapter 2. Applied Physics in Mechatronic Systems
2.3.2
Use of Complex Numbers
The dynamic behaviour of mechatronic systems is generally described in
response functions for signals that act on the system.
These functions are derived both in the time-domain, called equations of mo-
tion, and the frequency-domain, called frequency response functions (FRF),
an expression often reduced to just the frequency response.
The frequency response functions describe the amplitude and phase of the
output of the system in relation to the input as function of the frequency.
It uses the mathematics of complex numbers because of its possibility to
relate the phase to an angle in a polar plot as shown in Figure 2.10.
The complex number Z = a+ jb is represented in the complex plane as a vector
with coordinates [a b]. Instead of the vector notation also the exponential
relation is used to describe the complex number Z(œï) by using Euler‚Äôs formula
named after the Swiss mathematician and physicist Leonhard Euler (1707 ‚Äì
1783):.
Z(œï) = A(cosœï+ jsinœï) = Ae jœï.
(2.48)
The identity between the vectorial and exponential expression can be proven
by using the Taylor expansion for both expressions, giving identical results.
The exponential function is used in the mathematical derivation of several
important transforms but for more understanding of the phenomena the
sinusoidal and graphical representation are more easy to understand.
A
Re
Im
( )

Z
cos
 sin
j


Figure 2.10: Polar representation of complex number Z(œï) = A(cosœï+ jsinœï) = Ae jœï
where the phase shift is equivalent to the angle œï.

2.3. Signal Theory and Wave Propagation
73
2.3.2.1
Dynamic Impedance and Ohm‚Äôs Law
To incorporate dynamic, time and frequency dependent, behaviour of elec-
tronic components, Figure 2.11 shows Ohm‚Äôs law in a more generic repre-
sentation, where all impedances and signals can be time and frequency
dependent. In the frequency-domain, the variation of the impedance over
frequency automatically leads to a phase shift between the load current and
the voltage. For this reason the load is said to have an impedance Z(t, f ),
which is either a function of time or of frequency, depending on in which
domain the properties are presented. In the frequency-domain this dynamic
impedance is presented as a complex number like Z(œâ) = R + jœâL.
In its generic form Ohm‚Äôs law is written as follows:
V(œâ) = I(œâ)Z(œâ)
[V]
‚áí
I(œâ) = V(œâ)
Z(œâ)
[A].
(2.49)
2.3.2.2
Power in Dynamic Impedance
Also the relation for power becomes less trivial as a phase shift between
current and voltage has impact on the related power. Without a phase shift,
the power was shown previously to average out over time to P = Pp/2, where
the peak power equals Pp = VpIp. In case of a œÄ/2 phase shift, where the
current advances over the voltage, the power will be equal to:
P = I(œâ)V(œâ) = Ip sin(œât‚àíœÄ/2)Vp sin(œât) = Pp sin(œât‚àíœÄ/2)sin(œât) =
= Pp cos(œât)sin(œât) = Pp
1
2 sin(2œât)
[W].
(2.50)
Impedance Z()
+
_
Current  I()
Voltage
source
V ()
+
_
Figure 2.11: Generic representation of Ohm‚Äôs law. All variables can be frequency-
dependent. The resistor becomes a dynamic impedance, represented
in the frequency-domain by a complex number, which indicates a phase
shift between current and voltage.

74
Chapter 2. Applied Physics in Mechatronic Systems
0
1
2
z,
z{8
z{6
z{4
z{2
0
{2
{4
{6
{8
1
 
 
Sine
Power
Period
0
1
2
z,
z{8
z{6
z{4
z{2
0
{2
{4
{6
{8
1
 
 
Sine
Cosine
Power
Period
Figure 2.12: Graphical representation of power as the multiplication of two sinu-
soidal functions. At the left side the functions are in phase, resulting in
an average power of P = 0.5. At the right side the functions have œÄ/2 rad
phase diÔ¨Äerence, resulting in an average power over time of zero. The
momentary power is alternating positive and negative. It represents
the energy storage and recuperation in the reactive impedance.
This is a sinusoidal function with an average value of zero (P = 0).
The conclusion that can be drawn from this reasoning is that only the in-
phase components of the current and voltage contribute to the average power
into the load, which is for instance the case with a resistor. The derived
relation between power and phase for 0 rad and œÄ/2 rad phase diÔ¨Äerence is
illustrated in Figure 2.12.
When the phase diÔ¨Äerence is shifted gradually from 0 to œÄ/2 rad, the average
power shifts gradually from P = 0.5¬∑ Pp W to P = 0 W.
Average Power and Momentary Power
It is important to note from the Ô¨Ågure that, although the average power is
zero, the momentary value of the power is not zero. At half of the time the
power is positive, while in the other half the power is negative.
This phenomenon of temporary energy storage occurs in many reactive
impedances.
In mechanics the mass of the body and the stiÔ¨Äness of a spring are reactive
impedances that store kinetic or potential energy, while the capacitor and
inductor are reactive impedances in an electronic system.

2.3. Signal Theory and Wave Propagation
75
2.3.2.3
Capacitive Impedance
In the previous section it was shown that the complex impedance Z can have
aspects of diÔ¨Äerent properties, a ‚Äúreal‚Äù, frequency independent, part, corre-
sponding to the resistance, and an imaginary part. When the imaginary part
has a positive sign, the impedance becomes inductive with self-induction as
parameter4 with an increasing value for the impedance as function of the
signal frequency. When the imaginary term has a positive sign, which is
identical to the j term in the denominator, the impedance becomes capacitive
with capacitance as parameter with a decreasing value for the impedance
as function of the signal frequency.
In electric circuits a capacitive impedance is characterised by the symbol
C and due to its relation with the previously deÔ¨Åned capacitance as noted
in Equation (2.17) its value has the unit farad [F], which was named af-
ter Faraday. Any combination of insulated electrodes will show a certain
amount of capacitance, because it can store energy in the electrical Ô¨Åeld
between the electrodes, as shown in Figure 2.13. In Section 2.2.1 the relation
between an electric Ô¨Åeld, its potential diÔ¨Äerence, charge and capacitance
was explained. Capacitance was deÔ¨Åned as the amount of charge stored
at an electrode as function of its absolute potential. Capacitance between
two electrodes is increased when the electrodes are positioned close to each
other. By applying a voltage between the electrodes its potential diÔ¨Äerence
will force electrons to move from one electrode to the other. This causes a
charge diÔ¨Äerence with a proportional electric Ô¨Åeld between the electrodes.
When the electrodes are Ô¨Çat plates positioned parallel like in Figure 2.13
this Ô¨Åeld will be approximately homogeneous with parallel Ô¨Åeld lines and
its Ô¨Åeld strength is only determined by the charge diÔ¨Äerence. The potential
diÔ¨Äerence between the plates, which caused the charge diÔ¨Äerence, equals
the integral of the electric Ô¨Åeld over the distance between the two electrodes.
The larger the distance, the higher this potential diÔ¨Äerence will need to be
for the same charge diÔ¨Äerence and electric Ô¨Åeld. One can also say that a
larger distance corresponds to a reduced charge diÔ¨Äerence at the plates for
a given voltage, which means that the capacitance is inversely proportional
to the distance of the plates.
A further factor that determines the capacitance is the polarisability of
the material, when its molecular structure consists of electric dipoles. By
directing themselves along the electric Ô¨Åeld, with the positive side directed
4In this chapter on physics the properties are described in their physics sense. Elements
that show an almost ideal capacitive or inductive impedance are called capacitors and inductors
and these will be introduced in Chapter 6

76
Chapter 2. Applied Physics in Mechatronic Systems
d
I
V
+
_
A
E
+
+
+
+
+
+
+
+
_
_
_
_
_
_
_
_
_
_
_
_
_
_
_
_
_
q
q
_

Figure 2.13: Basic principle of a capacitive impedance.
towards the negative electrode, these dipoles counteract the electric Ô¨Åeld
and as a consequence they increase the amount of charge diÔ¨Äerence between
the plates that is required to sustain the electric Ô¨Åeld at a given potential
diÔ¨Äerence. This means that the capacitance is increased by inserting this
material between the plates without changing the distance.
This phenomenon is in some way comparable with magnetism, where the
Weiss domains of a material with a high relative permeability Œºr direct to
the magnetising Ô¨Åeld H, reducing that Ô¨Åeld relative to the magnetic Ô¨Åeld
B = ŒºoŒºrH5. The electric property, which corresponds to Œº, is the previously
introduced electric permittivity (Œµ = Œµ0Œµr)
As/Vm
. When the material be-
tween the electrodes is diÔ¨Äerent from vacuum, the total permittivity equals
Œµ0Œµr with the relative permittivity or dielectric constant Œµr ranging from ‚âà1
for air to < 100 for most solid materials and even higher for some ceramics
and certain special polymers. From a physics point of view it is important
to note that no charge is stored in a capacitor as a whole, but only at its
electrodes. Charge in capacitance means storage of energy by moving a
charge q from one electrode to the other. As a result a positive charge q+
is present at the positive electrode with an equal negative charge q‚àíat
the negative electrode, because of the charge displacement. Based on the
previous reasoning the capacitance C is deÔ¨Åned as the ratio between the
moved charge q and the potential diÔ¨Äerence V:
C = q
V = Œµ0ŒµrA
d
[F].
(2.51)
In Section 2.2.1 the capacitance of a single electrode was similarly deÔ¨Åned
5This is somewhat confusing because of the diÔ¨Äerent deÔ¨Ånitions, as the Weiss domains help
to increase the magnetic Ô¨Åeld B relative to the magnetising Ô¨Åeld H. It becomes comparable
when the magnetic Ô¨Åeld is taken as the source of the magnetising Ô¨Åeld. As mentioned in
Section 5.1, the cause and eÔ¨Äect between both Ô¨Åelds is a philosophical discussion as they simply
co-exist.

2.3. Signal Theory and Wave Propagation
77
on Page 53 as the ratio between its stored charge q and its absolute potential
V (C = q/V). With a combination of two electrodes each electrode would have
a capacitance and when not combined, the Ô¨Årst electrode with the positive
charge q+ would have a positive absolute potential V + = q+/C1, while the
other electrode with q‚àíwould have a negative absolute potential V ‚àí= q‚àí/C2.
For the combination of these electrodes in a capacitor one would expect a
potential diÔ¨Äerence between tho equal electrodes (C1 = C2) of V +‚àíV ‚àí= 2V,
while in reality the potential diÔ¨Äerence over a capacitor is only half of this
value for the same charge on the electrodes.
This implies that the capacitance of two combined electrodes equals twice the
capacitance of each of the electrodes. This double value can be understood
from the following reasoning. A higher capacitance implies that a lower
potential diÔ¨Äerence, hence less energy, is required for charging. The energy
needed to move a charge from inÔ¨Ånity to each of the electrodes separately
equals the integral of the absolute potential at the electrodes times the
charge. Two electrodes with an opposite charge in the same environment
will attract each other. When the electrodes are brought together this
mutual attraction causes a return of exactly half the energy that was used
for charging the electrodes. The deÔ¨Ånition of the capacitance of a capacitor
by Equation (2.51) relates only to the displaced charge q instead of the
accumulated charge diÔ¨Äerence 2q. This is for good reasons, because the use
of a capacitor is based on the way how it deals with current. The charge q
equals the integral of the current between the electrodes of the capacitor
over time and because of this time relationship it is interesting to see how
a capacitor behaves, when it is supplied with a changing (alternating, AC)
voltage.
The moved charge between the electrodes is proportional to the potential
diÔ¨Äerence according to Equation (2.51) and the current is equal to the
movement rate of the charge so it is allowed to say:
I(t) = dq
dt = C dV(t)
dt
[A].
(2.52)
With this equation the voltage over a capacitive impedance can be calculated
at any time t1 when the starting voltage V0 at t0 and the current is given:
V(t) = V0 + 1
C
t1

0
I(t)dt
[V].
(2.53)
The energy stored in a capacitive impedance is calculated by taking the
integral of the power PC needed to achieve the voltage over the time from

78
Chapter 2. Applied Physics in Mechatronic Systems
t0, where the voltage is zero, to t1, where the voltage is V1, and using
Equation (2.52):
EC =
t1

t0
PC(t)dt =
t1

t0
V(t)I(t)dt =
t1

t0
V(t)C dV
dt dt
(2.54)
= C
V1

0
V(t)dV = 1
2CV 2
1
[J].
(2.55)
When supplied from an AC source, the average power over time is zero
because of this phase relationship, as was shown in the previous section
with Figure 2.12. The power used to charge the capacitor alternates with an
equal period with a negative power where the capacitor is discharged and
the energy is returned to the source, which makes it a reactive impedance.
2.3.2.4
Inductive Impedance
Self-inductance with symbol L is a property of a current carrying wire,
related to the energy that is stored in its surrounding magnetic Ô¨Åeld. As
presented with Amp√®re‚Äôs law from the Maxwell equations in Section 2.2.2
this magnetic Ô¨Åeld is proportional to the current through the wire. Especially
when the wire is wound in a coil, as shown in Figure 2.14, it shows a
signiÔ¨Åcant amount of self-inductance. The self-inductance has been given
the unit henry [H], named after the American physicist Joseph Henry (1797 ‚Äì
1878), who approximately at the same time as Faraday, determined the
relation between the induced voltage over a coil as function of a change of
enclosed Ô¨Çux.
I
w

+
_
L
d
d
I
V
L t

Figure 2.14: A current in a coil running from the plus to minus electrode will create
a magnetic Ô¨Åeld in the direction as shown according to Amp√®re‚Äôs law.
An increase of current over time creates an increase of magnetic Ô¨Çux
over time, which will cause an electromotive force over the wire in the
direction of the round arrows causing an external voltage VL.

2.3. Signal Theory and Wave Propagation
79
The self-inductance is deÔ¨Åned as the ratio between the total Ô¨Çux Œ¶w,t of all
windings summed, and the current in a coil:
L =
Œ¶w,t
I
[H].
(2.56)
The total Ô¨Çux Œ¶w,t is equal to nŒ¶w, because a coil consists of n windings,
and each winding encloses the same Ô¨Çux Œ¶w. The logic behind this relation
of the self-inductance is based on Faraday‚Äôs law, stating that the induced
Electric Ô¨Åeld Ef in a winding is equivalent to a change in Ô¨Çux over the closed
surface inside the winding. This creates a proportional electromotive force
over the winding. When each of the windings in a coil gets the same change
of Ô¨Çux, the total coil would show an induced electromotive force, equal to
the sum of the electromotive force of each individual winding as they are
placed in series. The electromotive force within the coil is directed from the
negative to the positive electrode, because of the minus sign in Faraday‚Äôs
law, as explained in Section 2.2.2, which means that the direction of the
voltage is opposite to the current direction. With the electrodes deÔ¨Åned as
in Figure 2.14, the induced voltage VL at the electrodes of the inductor is
equal to this electromotive force and works opposite to the external source
that caused the current change6. This means that:
VL(t) = Fe = n dŒ¶w
dt
= dŒ¶w,t
dt
[V].
(2.57)
With the deÔ¨Åned relation of L, the total current induced Ô¨Çux equals Œ¶w,t = LI,
resulting in:
VL(t) = L dI
dt
[V].
(2.58)
Similar to the stored energy in a capacitive impedance, the stored magnetic
energy EL in the magnetic Ô¨Åeld of an inductive impedance can be calculated
by integrating the power over the time from t0, where the current is zero
until t1, where the current equals I1 for a certain value of L:
EL =
t1

t0
PL(t)dt =
t1

t0
I(t)L dI
dt dt = L
I1

0
I(t)dI = 1
2 LI2
1
[J].
(2.59)
Like with the capacitive impedance the average power over an inductor is
zero, when supplied from an AC source, as was illustrated in Figure 2.12. In
every period, the energy supplied by the source to the magnetic Ô¨Åeld in the
inductor in the positive power cycle is returned to the source in the negative
power cycle, which makes it a reactive impedance.
6When checking the directions with Faraday‚Äôs equation one should realise that the direction
of the Ô¨Çux in Figure 2.14 is negative to the normal vector ÀÜn from Figure 2.5, while the round
arrows point in the positive dl direction, which means that the minus sign is cancelled.

80
Chapter 2. Applied Physics in Mechatronic Systems
2.3.3
Energy Propagation in Waves
The phenomenon of energy transport by means of a travelling wave is di-
rectly related to periodically alternating signals. Wave motion phenomena
are well-known from real life by the waves of the sea, distortions of the
otherwise Ô¨Çat surface that are caused by the wind blowing over the surface
of the water, by boats, animals and in extreme cases even by an earthquake.
The sea otters of Figure 2.15 act as a disturbance source of which the energy
is spread over the water by means of its distorted surface. This initiation
by a disturbance and spreading of the disturbance over the space by a dis-
tortion of the medium, physical Ô¨Åeld or even material transport has always
been an essential aspect of wave motion. Quantum mechanics has extended
this view even further by replacing waves by particles like photons that are
spread from their source. In that sense even the expanding universe with
fast moving stars, planets and other material acts as a wave, originating
at the big bang and spreading energy by material transport. Still for the
common understanding of mechatronic systems the classical wave model is
suÔ¨Éciently useful to be introduced in this chapter.
Wave motion is described by a wave function, which can be continuous, in-
termittent, a one-oÔ¨ÄeÔ¨Äect like the big bang, or a random function with an
average value of zero for each element in the chain. In a Ô¨Årst approxima-
tion the wave function remains unchanged in shape (f (x,t) = f (x¬± vt)) when
Figure 2.15: These two playing sea otters in Monterey disturb the water surface,
creating circularly spreading waves over the surface of the sea, which
interfere with the waves that originate from other disturbance sources.

2.3. Signal Theory and Wave Propagation
81
spreading, although the amplitude can change by damping or spreading over
more dimensions, while even the shape can alter due to the properties of the
medium. For the modelling in this section mainly a continuous harmonic
sine-wave function is taken as example because all other wave functions
can be decomposed into sinusoidal harmonic functions by means of Fourier
decomposition, which will be introduced in Section 2.3.4.
The energy in a travelling wave is transferred to another place by a consec-
utive process called propagation at a velocity, which is called propagation
velocity or phase velocity vp [m/s], a spatial vector with a magnitude, called
propagation speed cp [m/s]. When observing a continuous sinusoidal wave
motion on a stationary position, the observed value, like displacement or
pressure, will appear to vary with a certain temporal frequency f [Hz]
with period T [s], which is determined by the source of the wave. With
a certain propagation speed cp, the temporal frequency f will also corre-
spond to a spatial variation of the observed value along the propagation
direction at a stationary moment in time. This spatial frequency is called
the wavenumber ŒΩ [1/m], and equals the number of periods of the wave per
metre. Its inverse, the spatial period length called wavelength Œª [m] is more
common. Similar to temporal frequencies also spatial frequencies can be
represented in radians, related to the phase in a sinusoidal wave function.
It is advised in that case to only use the vectorial form, the angular wave
vector k [rad/m], because it also includes the propagation direction, which is
required when determining the interaction of diÔ¨Äerent waves in space from
diÔ¨Äerent sources. The use of the term ‚Äúphase velocity‚Äù for the propagation
velocity is based on the relation between the angular temporal frequency
œâ and the angular wave vector. Often the phase velocity depends on the
wavelength, a phenomenon called dispersion, which causes a distortion of
a non-sinusoidal wave function by a time shift between the diÔ¨Äerent wave-
lengths that comprise the function according to its Fourier decomposition.
The relation between the above deÔ¨Åned terms is given by the following :
Œª = 1
ŒΩ = 2œÄ
k = cpT = cp
f
[m],
vp = œâ
k = 2œÄf
2œÄŒΩ
[m/s].
(2.60)
In the following sections two essentially diÔ¨Äerent types of waves will be
presented, the real and observable mechanical waves, which are based
on movements of material, and the physical-model based electromagnetic
waves. The energy in a wave spreads over space and this means that at
any point in a wave one can only express the energy as a density term,
which is often called intensity giving the energy per surface area orthogonal
to the propagation direction. With electromagnetic waves generally the

82
Chapter 2. Applied Physics in Mechatronic Systems
term irradiance is used rather than intensity because in radiology the term
intensity or radiant intensity is also used as the radiated power per unit of
solid angle, originating at the source of the wave. The term irradiance will
be frequently used in the Chapters 7 and 8 on optics and measurement.
2.3.3.1
Mechanical Waves
The propagation speed value of a mechanical wave is mostly determined by
the density and elasticity of the medium. The wave propagation through an
elastic material can be qualitatively explained with the help of a simpliÔ¨Åed
lumped element model, consisting of a chain of springs and bodies as shown
in Figure 2.16. It is unsupported, Ô¨Çoating without external forces, contains
no damping parts and is driven by a continuous sinusoidal force. In the
Ô¨Ågure two diÔ¨Äerent kinds of waves are shown in a snapshot of the wave over
one wavelength: a longitudinal wave in the direction of the propagation
direction and a transversal wave, perpendicular to the propagation direction.
In a three dimensional situation, the periodically alternating movement of
a transversal wave can be in any direction orthogonal to the propagation
direction.
To explain the principle of energy transfer, the longitudinal wave is taken as
example, while the same reasoning can be followed for the transversal wave.
When a movement of mass m1 is introduced in the propagation direction of
the chain, this will Ô¨Årst cause a compression of the elastic coupling k1. The
resulting compression force is transferred to mass m2, which accelerates
resulting in its own movement and causing in its turn a compression of k2.
This process is repeated over the total chain until the original movement
reaches mn. With this mechanism the kinetic energy from mass m1 is
converted into potential energy in k1, which in its turn is transferred into
kinetic energy of m2 and so on until the last mass is moving. This all under
the assumption that no energy is lost. This phenomenon of transfer of energy
in an elastic body is important in mechatronic systems because driving
forces are also transported through the body as a wave and as a consequence
will experience a delay between the actuator and the sensor when they are
located separately. The propagation speed cp is determined by the density
œÅm and the elasticity of the medium, expressed by the Young‚Äôs modulus Y
for a wave running in one direction in a solid rod and the bulk modulus B
for a wave running in a volume and equals:
1-D: cp =

Y
œÅm
,
3-D: cp =

B
œÅm
[m/s].
(2.61)

2.3. Signal Theory and Wave Propagation
83
m1
m2
mn
k2
k1
kn-1
Transversal wave
Longitudinal wave
mn-1
m1
m2
mn
mn-1
kn-1
k2
k1
Figure 2.16: Lumped element model of one wavelength of a mechanical wave. Trans-
fer of energy by waves in a mechanical object can be either longitudinal
or transversal.
The 3-D version of this equation is valid for gases and Ô¨Çuids and to a lesser
extend for solid objects where it can be used only as approximation. The
shape of a solid object plays a role while also the speed for transversal
and longitudinal waves is diÔ¨Äerent. As an example with steel, B ‚âà160¬∑109
Pa and œÅm ‚âà8 ¬∑ 103 kg/m3 resulting in a calculated propagation speed of
approximately 4500 m/s. In reality the propagation speed in stainless steel
varies between 3500 m/s for transversal waves and 5500 m/s for longitudinal
waves. With for instance half a metre of steel this gives a delay of about one
tenth of a millisecond, resulting in a phase delay of almost thirty-Ô¨Åve
degrees at one kHz, which can be signiÔ¨Åcant from a control point of view!
2.3.3.2
Wave Equation
The previous section showed that the periodicity of continuous waves occurs
both in time and position, while the propagation velocity gives a direct
link between these two. A second connecting phenomenon is the always
present relation between two variables that each can perfectly describe
the wave. For mechanical waves these are the displacement and the force
and for an acoustic wave it is the displacement and the pressure. These
direct relations are fully based on the mutual dynamic interaction where
the force/pressure causes the acceleration, which results in a displacement
while the displacement causes the force/pressure. This all means that it
is suÔ¨Écient to choose one parameter for the mathematics that describe a
mechanical wave. For longitudinal acoustic waves it is usually the sound
pressure while for mechanical waves in structures usually the displacement
is taken.
The wave equation for a mechanical wave can be derived with the parameters
as deÔ¨Åned in Figure 2.17, which relate two consecutive positions in time of a

84
Chapter 2. Applied Physics in Mechatronic Systems
F (t)
F(t)
dx
'
       Undisturbed
A
A
'
x
t  



d
dx
'
        Disturbed
t   dt

A'
A
F (t   dt)
F(t   dt)
'


Figure 2.17: A longitudinal wave in an inÔ¨Ånite solid rod indicating the parameters
that are used to derive the wave equation. A segment is shown on two
consecutive moments in time, the Ô¨Årst at the start of being disturbed
and the second after the disturbance has had its eÔ¨Äect on the motion.
segment in a solid rod that experiences a longitudinal wave: the undisturbed
position without strain and the disturbed position with strain and wave
motion Œæ(x) for the surface A of the segment and wave motion Œæ‚Ä≤(x) for the
surface A‚Ä≤. These positions and motions relate as:
dx+

Œæ‚Ä≤(x)‚àíŒæ(x)

= dx+ dŒæ(x).
(2.62)
When applying regular mechanics laws for the strain Œµ, the stress œÉ and the
Force relation of the Hooke-Newton law with the Young‚Äôs modulus Y, the
following relations are obtained:
Œµ = ‚àÇŒæ
‚àÇx,
œÉ = F
A ,
œÉ = Y Œµ
‚áí
F = Y A ‚àÇŒæ
‚àÇx,
‚àÇF
‚àÇx = Y A ‚àÇ2Œæ
‚àÇx2 .
(2.63)
As a next step the inertial dynamic eÔ¨Äects are calculated over the segment
having mass dm = œÅ dV = œÅA dx with density œÅ and cross-section A:
F‚Ä≤ ‚àíF = dF = ‚àÇF
‚àÇx dx = ma = m‚àÇ2Œæ
‚àÇt2 = œÅA dx‚àÇ2Œæ
‚àÇt2
‚áí
‚àÇF
‚àÇx = œÅA ‚àÇ2Œæ
‚àÇt2 . (2.64)
When combining Equation (2.63) with Equation (2.64), the wave equation
is obtained, giving the relation of the wave motion Œæ with the position along
the x-axis and the time t:
Y A ‚àÇ2Œæ
‚àÇx2 = ‚àÇF
‚àÇx = œÅA ‚àÇ2Œæ
‚àÇt2
‚áí
‚àÇ2Œæ
‚àÇt2 = Y
œÅ
‚àÇ2Œæ
‚àÇx2 .
(2.65)
As a last step the wave function Œæ = f (x,t) = f (x¬± cpt) is applied to relate the
wave equation to c2
p and also prove Equation (2.61).

2.3. Signal Theory and Wave Propagation
85
When deÔ¨Åning u = x¬± cpt, then ‚àÇu/‚àÇx = 1 and ‚àÇu/‚àÇt = cp, which means that:
‚àÇŒæ
‚àÇx = ‚àÇŒæ
‚àÇu
‚àÇu
‚àÇx = ‚àÇŒæ
‚àÇu
and:
‚àÇŒæ
‚àÇt = ‚àÇŒæ
‚àÇu
‚àÇu
‚àÇt = ¬±cp
‚àÇŒæ
‚àÇu .
(2.66)
With these expressions the double partial derivatives are equal to:
‚àÇ2Œæ
‚àÇx2 = ‚àÇ
‚àÇx

 ‚àÇŒæ
‚àÇx

= ‚àÇ
‚àÇu

 ‚àÇŒæ
‚àÇu

= ‚àÇ2Œæ
‚àÇu2 ,
and over time:
‚àÇ2Œæ
‚àÇt2 = ‚àÇ
‚àÇt

‚àÇŒæ
‚àÇt

= ¬±cp
‚àÇ
‚àÇt
‚àÇŒæ
‚àÇu = c2
p
‚àÇ2Œæ
‚àÇu2 ,
giving:
‚àÇ2Œæ
‚àÇt2 = c2
p
‚àÇ2Œæ
‚àÇx2 .
(2.67)
With a three dimensional longitudinal sound wave, the wave equation
for the sound pressure ps is expressed as follows as function of the propa-
gation speed of sound cp, which equals approximately 340 m/s under atmo-
spheric conditions:
‚àá2ps = 1
c2p
‚àÇps
‚àÇt2
‚áí
‚àÇ2ps
‚àÇt2 = c2
p

‚àÇ2ps
‚àÇx2 + ‚àÇ2ps
‚àÇy2 + ‚àÇ2ps
‚àÇz2

.
(2.68)
This directly gives the relation for the sound pressure over time and position
at any position in space in Cartesian coordinates (x, y, z). At a short distance
from the sound source, the waves are propagated over a three dimensional
spherical surface, but at a larger distance from the source the wave equation
can be approximated in a single generalised coordinate qi in the propagation
direction (i) at the point of observation:
‚àÇ2ps
‚àÇt2 = c2
p
‚àÇ2ps
‚àÇq2
i
.
(2.69)
Figure 2.18 gives a graphic representation of such a single-dimensional
longitudinal sound wave7 over one wavelength for two consecutive moments
in time. By examining the diÔ¨Äerences between the two situations the in-
phase relation between pressure and velocity becomes clear, while also the
wave equation is veriÔ¨Åed8. Further it clearly shows that energy is transferred
to the right without a corresponding average motion of air particles, because
of the fact that the air moves to the right at the highest pressure (high
7The sound pressure is in reality a small pressure variation of the average air pressure.
The indicated density variations as shown in the background of Figure 2.18.a: are highly
exaggerated. Negative sound pressure is in reality a slightly lower density of the air. An
amplitude of 100kPa (1 bar) would be 194dB, while 120 dB is the pain limit!
8When examining the same phenomena with the transversal wave from Figure 2.16 it
is important to note that the maximum stress and velocity values for the transversal wave
are present at the beginning, mid and end position in the Ô¨Ågure, which is diÔ¨Äerent from the
location of the maximum stress and velocity in the drawn longitudinal wave.

86
Chapter 2. Applied Physics in Mechatronic Systems
2
2
2
s
s
p
2
2





p
p
c
t
qi
s
Sound pressure 
6$|q )
t0
t1
ma
ma
mb
mb
s
1
0
(
)
p t
t
t

	

i
t0
t1
p
sp

qi
2
s
2


p
t
a:
b:
*
1
0
(
)
t
t
	
pc
Figure 2.18: a: Single dimensional spatial visualisation of a longitudinal sound
wave on two consecutive moments in time where air is approximated
as blocks connected by springs. By comparing the wave motion of ma
in the highest density (= total pressure) area, with the wave motion
of mb, having the lowest density, it is clear that the pressure and the
velocity are in phase.
b: The sound pressure ps at the consecutive moments, t0 (solid) and t1
(dashed) as function of the position qi along the propagation direction.
c: The wave equation can be veriÔ¨Åed from the partial derivative of the
pressure over time (red) and position (black). The maximum value
occurs in the areas between ma and mb. These maximum values
correspond to a zero value for both second derivatives (dashed). The
magnitudes diÔ¨Äer in reality with the squared value of the propagation
speed (‚âà3402 for sound), which has been reduced to 3 for the drawing.
potential energy) and to the left at the lowest pressure.
A similar expression describes a transversal mechanical wave, giving
the local periodically alternating excursion u as function of the generalised
coordinate qi and time:
‚àÇ2u
‚àÇt2 = c2
p
‚àÇ2u
‚àÇq2
i
.
(2.70)
This diÔ¨Äerential equation can be solved for a sinusoidal periodic variation
of the excursion. The solution results in the following more recognisable
expression for the excursion, giving the value of u(qi,t) on time t at the
generalised coordinate qi along the path of propagation:
u(qi,t) = up sin

œât+ œâqi
cp

= up sinœâ

t+ qi
Œª

= up sin2œÄf

t+ qi
Œª

.
(2.71)
The simultaneous periodicity over position and time is evident.

2.3. Signal Theory and Wave Propagation
87
2.3.3.3
Electromagnetic Waves
A special type of waves is the electromagnetic wave, because it does not use
material for its propagation. It is a transversal wave where the transversal
movement direction is called the polarisation direction. Electromagnetic
waves as a physical model were Ô¨Årst postulated by James C. Maxwell (1831 ‚Äì
1879) to describe phenomena like radio transmission and light. At Ô¨Årst,
people who were accustomed to the mechanical wave theory thought that
electromagnetic waves should also have a carrier to propagate the energy.
For this reason they assumed an unknown medium called ‚ÄúAether‚Äù as a wave
carrier. Present theory however states that electromagnetic energy is trans-
ferred by the interaction of electromagnetic Ô¨Åelds, while quantum mechanics
even describes it as the spreading of separate units of energy (quanta), which
were Ô¨Årst postulated by Max K.E.L. Planck (1858 ‚Äì 1947). The relating the-
ory of Quantum Electrodynamics on the interaction of photons and electrons
has been described by Richard P. Feynman (1918 ‚Äì 1988) [32]. He gives a
calculation model for electromagnetic phenomena by means of probability
statistics. Though it is in itself very interesting, especially to become aware
of the futility to search for answers why nature does the weird things it
does, reading it is not necessary to be able to work with electromagnetic
phenomena at the scale used in mechatronic systems. The wave theory is
mostly suÔ¨Écient for this purpose. Nevertheless the method will be shortly
referenced in the optics chapter, when presenting diÔ¨Äraction on gratings.
Figure 2.19 shows the transversal wave model of an electromagnetic wave
as a combination of two orthogonal periodic Ô¨Åelds, a magnetic (B) and an
Magnec %eld
Electric %eld
B
E
x
Figure 2.19: Electromagnetic waves consist of a coupled periodically alternating
electric and magnetic Ô¨Åeld, which propagate as function of time and
position. In vacuum the magnitude of the velocity is equal to the speed
of light c0 = 1/Œº0Œµ0, which is exactly 299,792,458 m/s.

88
Chapter 2. Applied Physics in Mechatronic Systems
Figure 2.20: Electromagnetic waves are observed over a vast spectrum of frequen-
cies, ranging from radio waves to gamma rays. The spectrum of visible
light covers only a very small part.
electric (E) Ô¨Åeld. This model is used in Chapter 7 on optics to describe
phenomena like interference and diÔ¨Äraction. Electromagnetic waves cover
a very wide spectrum as shown in Figure 2.20. It starts with the Gamma
radiation or Gamma rays at one extreme of the spectrum and radio waves at
the other. The important area of visible light is found around a wavelength
of 600 nm. Electromagnetic waves propagate with the speed of light which
equals in vacuum exactly c0 = 299,792,458 m/s. This enormous speed results
in an extreme unmeasurable temporal frequency of ‚âà5¬∑1014 Hz for visible
light.
2.3.3.4
ReÔ¨Çection of Waves
A rope is an example of a mechanical chain consisting of an inÔ¨Ånite number
of interconnected masses and springs. Figure 2.21 shows a situation where
a man generates a transversal wave by inserting a sequence of an upward
and equal downward movement in a rope. The rope is not connected to
anything at its end point and the eÔ¨Äects of gravity are neglected. When the
wave arrives at the end of the rope, the momentum can not be transferred
further to a next neighbouring part of the rope. This zero force boundary
condition at the end point results in a continuation of the upward movement
of the end of the rope. This lasts until the originally driving force from the

2.3. Signal Theory and Wave Propagation
89
1
2
3
4
5
Sequence
Figure 2.21: A man holds a rope with a loose end and inserts one full wave by an
upwards movement followed by an equal downward movement. After
the reÔ¨Çection of the wave at the loose end the wave proceeds with the
same sign meaning that the downward half precedes the upward half
of the wave. This is caused by the zero force boundary condition at
the end point, which makes the end point Ô¨Årst move to the extreme
upward excursion after which it will lower again, sending the upward
momentum back Ô¨Årst. The eÔ¨Äect of gravity is neglected.
preceding part of the rope starts to slow down the upward movement of
the end while transferring the momentum back into the rope. The end will
then go down past the centre line creating the lower half of the wave. This
eÔ¨Äect is called reÔ¨Çection and the resulting backwards moving wave has the
same sign as the original half wave, because it Ô¨Årst starts with an upward
movement, originating from the extreme upward motion of the end, followed
by a downward movement.
Another situation occurs when the end of the rope is connected to a rigid sta-
tionary object like a wall and is shown in Figure 2.22. This zero movement
boundary condition causes the force at the connection point to increase until
all kinetic energy in the wave is converted into potential energy in the local
elasticity of the rope. That potential energy is inserted back in the rope
such that its movement gains a maximum momentum passing the centre
line until it is slowed down again at the downward side where its energy will
be transferred in the backward direction. The reÔ¨Çection in this situation
leads to a sign inversion because of the force in the downward direction

90
Chapter 2. Applied Physics in Mechatronic Systems
1
2
3
4
5
Sequence
Figure 2.22: The reÔ¨Çection of a transversal wave at a rigidly connected end results
in a sign inversion of the reÔ¨Çected wave due to the zero movement
boundary condition. In this situation the force at the connection point
will not only stop the transversal wave but reÔ¨Çect it in the downward
direction.
exerted by the rigid wall connection. As a result the downward movement
now precedes the upward movement after the reÔ¨Çection.9.
It is useful to mention here that the demonstrated sign inversion with the
rope is also observed with the reÔ¨Çection of electromagnetic waves when
going from a low density to a high density medium like when reÔ¨Çecting on a
mirror as will be referred to in Section 7.2.2.1.
One might wonder whether conditions exist where no reÔ¨Çections occur. This
indeed is the case when the connection behaves as if it was a continuation of
the rope, absorbing all energy that arrives at this connection. In a mechani-
cal system this can be achieved by a suitable damping element, dissipating
the energy into heat, while in electricity this is equally achieved when
connecting a signal cable with a resistor value equal to the characteristic
impedance of the cable as described in Section 8.4.4.
2.3.3.5
Standing Waves
Travelling waves transport the energy that is inserted at the source but
due to reÔ¨Çections another kind of wave can occur, the standing wave, which
vibrates by collecting energy from the source over an extended period of
9For a longitudinal wave like soundwaves the sign inversion eÔ¨Äect upon reÔ¨Çection is just
opposite and at Ô¨Årst glance more logical as can be explained from reasoning. While with a
transversal wave a positive (upward) movement is bounced back downwards when reÔ¨Çecting on
a stationary object, a positive impulse (high pressure) in a longitudinal soundwave will bounce
back from a wall as a positive impulse in the direction where it came from. In fact it are the
moving (vibrating) particles in a mechanical wave that are reÔ¨Çected. With a transversal wave
the particles vibrate orthogonal to its propagation direction, while in the longitudinal wave
the particles vibrate in the same direction as its propagation.

2.3. Signal Theory and Wave Propagation
91
An node
Node
Node
d
Node
An-node
An-node
Node
Node
Figure 2.23: A standing wave occurs with a sinusoidal excitation when the reÔ¨Çected
wave is in phase with the excited wave. This occurs at a frequency
equal to f = nvp/2d with n = 1,2,3,..... The situation for n = 2 is shown
at the upper example and for n = 1 at the lower example.
time. This is explained with the example of the man with the rope for the
situation when the rope is connected at two sides to a wall. This is shown in
Figure 2.23 where a once inserted wave can reÔ¨Çect several times assuming
no energy is lost. When the man inserts a sinusoidal movement in the
rope, with such a timing that the twice reÔ¨Çected wave arrives in phase with
the exerted wave, the magnitude of both waves will add. The connection
points at both walls each induce a sign inversion at reÔ¨Çection resulting in
no phase inversion after one round of two reÔ¨Çections. The condition for
a synchronous movement, where the reÔ¨Çected wave is in phase with the
excitation, is fulÔ¨Ålled when a phase shift of a multiple of 360¬∞is obtained by
the travelling time of the wave over the total path from the source via both
walls back to the source. This is accomplished when the wave travels over a
total path of at least one wavelength Œª. The minimal distance between both
walls is then equal to Œª/2, because the wave travels twice this distance. But
the condition is also met with a distance of d = Œª because a path of two times
Œª gives a 720¬∞phase shift, which is equal to 0 or 360‚ó¶. This can be written in
the following generic way, when using the relation between frequency and
wavelength of Equation (2.60):
f = cp
Œª ,
d = nŒª
2
=‚áí
f = ncp
2d ,
n = 1,2,3,.... .
(2.72)
The velocity at the point of insertion will also be in phase with the force by
the man because of the in-phase reÔ¨Çection at these frequencies, achieving a
continuous energy transfer to the rope and consequently the motion ampli-
tude will increase. This eÔ¨Äect is called a resonance as will be also presented
in Chapter 3 on dynamics.

92
Chapter 2. Applied Physics in Mechatronic Systems
Nodes and Anti-Nodes
In Figure 2.23 Ô¨Åxed positions are shown in the rope where the amplitude
is zero and those positions are called a node while the locations where the
motion amplitude is maximum are called an anti-node. Related to the nodes
and anti-nodes two important eÔ¨Äects are important to mention.
The Ô¨Årst eÔ¨Äect relates to the storage location of the energy. With travel-
ling waves it was shown that the energy is continuously divided in elastic
potential energy and in kinetic energy, while they move together with an
equal phase. With standing waves the kinetic energy is always concentrated
around the anti-node as there the maximum speed occurs while the poten-
tial energy is spread over the rope with a transversal wave or concentrated
in the nodes for a longitudinal sound wave where the maximum periodic
pressure change occurs. Next to this diÔ¨Äerent stationary location also the
time relation is no longer in-phase. The maximum kinetic energy occurs
when the movement in the node is maximum going through the neutral
position (the centre line for the rope) where the force in the rope and the
potential energy is zero. The maximum potential energy is present when
the vibrating rope reaches its maximum excursion with zero speed and a
maximum force in the rope. A second eÔ¨Äect is related to the combination
of the actuator characteristics with the insertion location of the excitation
stimulus. When the actuator delivers a force, which is independent of the
movement, it has a low stiÔ¨Äness. With a low stiÔ¨Äness actuator this force
must be applied in the direction of the velocity at the maximum speed in
order to maximise the delivered power, because power is equal to the dot
product of force and velocity P = F ¬∑v. Muscles in a man have a limited
stiÔ¨Äness and deliver their maximum force with only a moderate inÔ¨Çuence
of the motion amplitude. This means that the man in Figure 2.23 has to
insert his force close to an anti-node to be maximum eÔ¨Äective as shown
in the Ô¨Ågure. This same eÔ¨Äect is used in any musical snare-instrument
where the musician exerts periodic forces by his nails or plectrum in an
anti-node on the snare to create the sound. Depending on the position of
exertion on the snare a diÔ¨Äerent tonal balance is achieved because with
each higher harmonic frequency another place on the snare will correspond
to an anti-node.
Most electromagnetic actuators have such a low stiÔ¨Äness characteristic but
piezoelectric actuators are quite diÔ¨Äerent as these have a high stiÔ¨Äness,
generating a periodically alternating motion that is almost independent
of the force. In that case the maximum power is delivered when actuating
close to a node where the force is maximum.

2.3. Signal Theory and Wave Propagation
93
2.3.4
Fourier Decomposition of Alternating Signals
In real mechatronic systems a sinusoidal movement at one single frequency
generally only occurs at resonance. Real active positioning systems are
continuously excited with periodically alternating signals at many diÔ¨Äerent
frequencies, which occur simultaneously without any correlation. Fortu-
nately the French mathematician Jean Baptiste Joseph Fourier (1768 ‚Äì
1830) postulated that any periodically alternating function can be seen
as a combination of diÔ¨Äerent harmonic functions with a clear frequency,
amplitude and phase relation. This postulation is true under the condi-
tion that the function contains no discontinuities as these would lead to a
non-converging series. These conditions are always met in reality, because
of the natural source of the periodic events of interest in a mechatronic
system. The method is called the Fourier decomposition or Fourier series,
because it decomposes a periodically alternating function into its single
harmonic components by means of a series expansion based on the following
trigonometric identity:
sin(œâ1t)sin(œâ2t) = ‚àícos(œâ1t+œâ2t)+cos(œâ1t‚àíœâ2t)
2
.
(2.73)
When œâ1 = œâ2 the Ô¨Årst term in the numerator becomes a standard cosine
function averaging to zero over time and the second term in the numerator
becomes equal to one resulting in a non-zero (0.5) total average of the
function. In case œâ1 and œâ2 are not equal both terms in the numerator would
become simple cosine functions both averaging to zero over time. Based on
this sharp diÔ¨Äerence between the two situations, the average value over
time of the multiplication of an arbitrary periodically alternating function
with a sinusoidal function of a certain frequency would be zero, unless
the arbitrary periodically alternating function would contain a frequency
component equal to, and in phase with, the sinusoidal function. With
this mathematical conclusion the Fourier decomposition of a periodically
alternating function is calculated as follows. In principle the analysis is
based on the understanding that Equation (2.73) deals with continuous
harmonic functions over time (or space in case of spatial signals). When
a signal is perfectly periodic and its function does not change over time
than it is allowed to analyse only one period as being representative for
all other periods. First the analysis will be done on such nonexisting ideal
signals while Section 2.3.4.5 will present the analysis of more real time-
or place-variable signals. The fact that only one full period is analysed
allows the angle œë to be used as the variable instead of time in the function
while the interval of one period T is represented as an angle from ‚àíœÄ to œÄ.

94
Chapter 2. Applied Physics in Mechatronic Systems
This normalises the analysis to a more generic form independent of the
period or frequency. When F(œë) represents the Fourier decomposition of the
periodically alternating function f (œë) then:
F(œë) = a0 +
‚àû

n=1
[an cos(nœë)+ bn sin(nœë)],
(2.74)
where n is an integer n ‚â•1. The Fourier coeÔ¨Écients an and bn are the
amplitudes of the corresponding sine and cosine terms and are calculated
over the mentioned interval by the following relations:
a0 = 1
2œÄ
œÄ

‚àíœÄ
f (œë)dœë.
(2.75)
This Ô¨Årst coeÔ¨Écient represents the average value and is zero for a periodically
alternating signal without a DC oÔ¨Äset. The other terms are determined
according to the trigonometric identity of Equation (2.73):
an = 1
œÄ
œÄ

‚àíœÄ
f (œë)cos(nœë)dœë,
(2.76)
and:
bn = 1
œÄ
œÄ

‚àíœÄ
f (œë)sin(nœë)dœë.
(2.77)
An alternative notation can be found by applying Euler‚Äôs formula when
understanding that an represents the real part in the function and bn the
imaginary part.
F(œë) =
‚àû

n=‚àí‚àû
cne jnœë,
(2.78)
with the Fourier coeÔ¨Écients cn equal to:
cn = 1
2œÄ
œÄ

‚àíœÄ
f (œë)e jnœë.
(2.79)
The Fourier coeÔ¨Écients an, bn and cn have the following relation:
an = cn + c‚àín
for n = 0,1,2,......,
bn = j(cn ‚àíc‚àín)
for n = 1,2,......,
cn = 0.5(an ‚àíjbn)
for n > 0,
cn = 0.5(a0)
for n = 0,
cn = 0.5(a‚àín + jb‚àín)
for n < 0.
While this complex notation is useful in mathematical analysis the sine and
cosine expressions are more suitable for graphical purposes.

2.3. Signal Theory and Wave Propagation
95
2.3.4.1
Fourier in the frequency-domain
When analysing a periodically alternating function in the time-domain,
the angle œë of the generic Fourier decomposition of Equation (2.74) can
be replaced by œâ0t, where œâ0 represents the fundamental frequency of
the periodically alternating function. With this replacement the Fourier
decomposition of a temporal periodically alternating function can be written
as:
F(t) = a0 +
‚àû

n=1
[an cos(nœâ0t)+ bn sin(nœâ0t)],
(2.80)
where the sine and cosine terms deÔ¨Åne the phase relation between the
diÔ¨Äerent components. In this equation the frequency terms nœâ0 are all an
integer multitude of the fundamental frequency œâ0. This interrelation is
called harmonic because in music a waveform that consists of only harmoni-
cally related frequencies does sound like a harmonic (not out of tune) note.
The fundamental frequency equals the Ô¨Årst harmonic and the frequencies
corresponding to n = (1,3,5,...) are called odd harmonics and the frequencies
corresponding to n = (2,4,6,...) are called even harmonics10.
The a0 Fourier coeÔ¨Écient is not an harmonic as it is not an alternating AC
but a constant DC value.
To illustrate this basic theory on Fourier decomposition of a periodic signal,
the following three waveforms are taken as example, the triangle, sawtooth
and square waveform.
2.3.4.2
Triangle Waveform
The triangle waveform is shown in Figure 2.24 in the generic form as function
of œë. It is clear that a0 is zero as the waveform has an average value over time
of zero. Also the fundamental frequency is most probably a cosine function
as it is like the cosine an even function. The other Fourier coeÔ¨Écients can
be calculated from the mathematical expression that describes the triangle
waveform as function of the angle œë:
f (œë) = 1+ 2
œÄœë
for ‚àíœÄ < œë ‚â§0,
(2.81)
f (œë) = 1‚àí2
œÄœë
for
0 < œë < œÄ.
10The terms ‚Äúodd‚Äù and ‚Äúeven‚Äù should not be confused with odd and even functions in
mathematics that deal with symmetry relations of functions. A function is called even when
the graphic representation in the x‚àíy plane is unchanged when mirrored around the y axis.
The graphic representation of odd functions remain unchanged when rotated 180¬∞around the
origin. For example cosx is an even function while sinx is an odd function.

96
Chapter 2. Applied Physics in Mechatronic Systems
Angle
Magnitude
z 
z 
2
0

2

z 1
z 1
2
0
1
2
1
$/
¬Ä,
¬Ä[
¬Ä¬Å
#/
0
1
2
[
4
¬Å
6
0
0.1
0.2
0.[
0.4
0.¬Å
0.6
0.7
0.8
0.9
Amplitude
n
¬Ä
Figure 2.24: Triangle waveform, approximated by the sum of the Ô¨Årst three non-
zero harmonic terms of the corresponding Fourier series, already
comes close to the ideal waveform. The harmonic spectrum shows a
rapidly decaying amplitude for n > 1.
When calculating the Fourier coeÔ¨Écients of this function in time notation
(œë = œât), the following inÔ¨Ånite series of frequencies is found:
F(t) = 8
œÄ2

cos(œât)+ 1
32 cos(3œât)+....+ 1
n2 cos(nœât)

n = 1,3,5,7,..... .
(2.82)
The waveform graph in Figure 2.24 shows the Ô¨Årst three harmonic terms
with a non-zero Fourier coeÔ¨Écient. The Ô¨Årst observation is that all three
waveforms have a maximum value at œë = 0, which means that by summing
them up, the top pushes up to sharpen the tip. It is also well recognisable
that between for instance œë = œÄ/4 and œÄ/2 the combination of the second and
third non-zero term leads to a Ô¨Çattening of the curved slope of the Ô¨Årst
harmonic in that region.
Equation (2.82) also makes clear that only odd harmonics are present with
a magnitude as indicated in the harmonic spectrum at the right graph of
Figure 2.24. Note that the horizontal axis of this spectral graph is divided
in the harmonic terms, which means that the magnitude generally consist
of a combination of the sine and cosine terms for each value of n, equaling
xp =

a2n + b2n with n = 1,2,3,.... In this case only the cosine terms are present
so bn = 0.
The higher order terms are rapidly becoming negligible, because of the
quadratic term in the numerator of the amplitude coeÔ¨Écients. The image
in the Ô¨Ågure consists of only the Ô¨Årst three non-zero terms from the Fourier

2.3. Signal Theory and Wave Propagation
97
series and the sum already looks like a triangle. Nevertheless due to the
sharp edges an inÔ¨Ånite amount of harmonics would be needed to create an
ideal triangle waveform.
2.3.4.3
Sawtooth Waveform
The sawtooth waveform is shown in Figure 2.25. While it might look like
another kind of triangle it is not that simple. A theoretical ideal sawtooth
waveform has an inÔ¨Ånitely steep slope around œë = 0, which represents a
discontinuity. As a consequence many terms are required to approximate a
sawtooth waveform to an acceptable level of accuracy. Like with the triangle
a0 is zero but in this case the fundamental frequency of the range is a
sine function as the sawtooth is an odd function, just like the sine. The
mathematical relation that describes the sawtooth waveform as function of
the angle œë is as follows.
f (œë) = ‚àí1+ 1
œÄœë
for ‚àíœÄ < œë < 0,
(2.83)
f (œë) = 1‚àí1
œÄœë
for
0 < œë < œÄ,
f (œë) = 0
for
œë = 0.
Angle
z 
z 
2
0

2

z 1
z 1
2
0
1
2
1
$/
¬Ä,
¬Ä¬Ç
¬Ä[
¬Ä)
¬Ä¬Å
¬Ä¬É
#/
Amplitude
0
1
2
[
)
¬Å
¬É
0
0.1
0.2
0.[
0.)
0.¬Å
0.¬É
0.7
Magnitude
n
¬Ä
Figure 2.25: Sawtooth waveform, approximated by the sum of the Ô¨Årst six harmonic
terms of the corresponding Fourier series, is still hardly recognisable
as a real sawtooth. The harmonic spectrum shows only a slow decay
of the amplitudes.

98
Chapter 2. Applied Physics in Mechatronic Systems
Calculating the Fourier coeÔ¨Écients of this function in time notation (œë = œât),
gives the following inÔ¨Ånite series of frequencies:
F(t) = 2
œÄ

sin(œât)+ 1
2 sin(2œât)+....+ 1
n sin(nœât)

n = 1,2,3,4,..... .
(2.84)
This means that both odd and even harmonics are present. Furthermore,
as clearly indicated in the harmonic spectrum of Figure 2.25, the successive
harmonics only decrease proportional with n, which underlines that many
terms are required to create a reliable sawtooth. This is due to the above
mentioned fact that the inÔ¨Ånitely steep ramp has to be created by summation
of only Ô¨Ånitely steep sine wave slopes. The image in the Ô¨Ågure consists of
only six terms and though faintly the sawtooth shape can be recognised, it
is still far from a real sharp sawtooth waveform.
2.3.4.4
Square Waveform
The third example is the square waveform as shown in Figure 2.26. In
this case two discontinuities are present in the signal, which also means
that more terms are required to approximate the waveform with sinusoidal
functions. Like with both previous waveforms a0 is zero and like with the
sawtooth also the fundamental frequency of the range is a sine function as
Angle
Magnitude
z 
z 
2
0

2

z 1
z 1
2
0
1
2
1
$/
¬Ä,
¬Ä[
¬Ä¬Å
¬Ä¬Ñ
¬Ä¬Ö
#/
0
1
2
[
4
¬Å
¬É
¬Ñ
8
¬Ö
10
0
0.1
0.2
0.[
0.4
0.¬Å
0.¬É
0.¬Ñ
0.8
0.¬Ö
1
1.1
1.2
1.[
Amplitude
n
¬Ä
Figure 2.26: Square waveform, approximated by the sum of the Ô¨Årst Ô¨Åve non-zero
harmonic terms of the corresponding Fourier series starts to look like
a real square. The harmonic spectrum however shows quite some high
amplitude components at higher n numbers.

2.3. Signal Theory and Wave Propagation
99
it is an odd function. The mathematical relation that describes the square
wave as function of the angle œë is as follows.
f (œë) = ‚àí1
for ‚àíœÄ < œë < 0,
(2.85)
f (œë) = 1
for
0 < œë < œÄ,
f (œë) = 0
for
œë = ‚àíœÄ , 0 , œÄ.
Calculating the Fourier coeÔ¨Écients of this function in time notation (œë = œât)
gives the following inÔ¨Ånite series of frequencies:
F(t) = 4
œÄ

sin(œât)+ 1
3 sin(3œât)+....+ 1
n sin(nœât)

n = 1,3,5,7,..... .
(2.86)
This means that like with the triangle waveform only odd harmonics are
present. Furthermore, like with the sawtooth waveform, the amplitude
coeÔ¨Écients of the successive harmonics only decrease proportional with n,
which underlines that also in this case many terms are required to realise
a reliable square wave for the same reason as an ideal theoretical square
waveform has discontinuities, which can only be approximated. The fact
that the summed Ô¨Årst Ô¨Åve non-zero terms of the Fourier series already looks
more like a real square waveform than the previous example is due to the
missing even harmonics leading to a higher frequency of the last terms that
were included in this approximation.
Based on these three examples the following observation can be made.
A periodically alternating signal that is symmetrical around an axis in the y
direction at œÄ/2¬± nœÄ will create only odd harmonics. The even harmonics all
represent an asymmetry around these axes as can be seen with the sawtooth
waveform.
This is especially important with spatial frequencies in optics where in
principle only odd harmonics are present.
2.3.4.5
Non-Continuous Alternating Signals
The application of Fourier decomposition on a periodically alternating signal
showed that it is possible to regard the signal as a linear summation of
separate harmonically related frequencies with diÔ¨Äerent amplitude values,
determined by the Fourier coeÔ¨Écients. The process of calculating these
Fourier coeÔ¨Écients was performed by integration over one period only as be-
ing representative for the entire continuous function. In reality signals often
look more like the graph of Figure 2.27 showing a random signal, which was

100
Chapter 2. Applied Physics in Mechatronic Systems
A
B
C
D
Time
Magnitude
Figure 2.27: Graphical representation of a random waveform in the time-domain.
registered over a short period of time.11 With these real unknown signals it
is impossible to determine the periodicity to capture and analyse one period,
which is representative for the entire signal over time. For this reason the
signal is analysed over a chosen limited time span with no relation to the
signal periodicity. When only such a limited time span is observed one
can more easily recognise areas with a low frequency like in area A ‚Äì B of
Figure 2.27 and with a high frequency like the area C ‚Äì D. This observation
indicates that it might be possible to approximate such a random signal by
a limited amount of frequencies when analysing only a limited time span.
In analysing signals by means of Fourier decomposition such a time span
is called a Fourier window, in most publications abbreviated to just the
‚Äúwindow‚Äù.
Even though this window can be seen as a measurement sample, in practice
the measurement of the magnitude inside the window is done by means of
discrete sampling as it is calculated with a computer. To avoid confusion the
term ‚Äúwindow‚Äù is used for the entire period and ‚Äúsample‚Äù for any discrete
measurement inside the window.
The analysis of the sampled signal over a Fourier window is done mathe-
matically by applying a Fourier-transform method where the function in
the time-domain is translated into frequency-domain solutions and which
will be presented further in Section 2.4. Figure 2.28 shows an example that
is created with the above mentioned Fourier decomposition methodology.
The random signal is decomposed in 30 frequencies of which the amplitude
is shown as function of the frequency in a frequency spectrum graph. A
11While time dependent signals are taken as example, the presented results in this section
are equally applicable for space dependent signals.

2.3. Signal Theory and Wave Propagation
101
0
0.005
0.01
0.015
0.02
0.025
0.03
0.035
z{)
z{[
z{¬Ç
z{,
0
0.1
0.2
0.3
{)
Time
Magnitude
$/
#/
0
10
20
30
0
0.02
{{)
0.06
0.08
0.1
0.12
Amplitude
n
Frequency Spectrum
Figure 2.28: A random waveform approximated by the sum of several harmonic
terms of the corresponding Fourier series. It shows that even a random
signal observed over a limited time span can be reliably represented
by a combination of sinusoidal waveforms. In the frequency-domain
the harmonic spectrum is called a frequency spectrum.
real random signal would show a continuous spectrum with all frequencies
present but when examining the signal over a short Fourier window only
a discrete selection of frequencies is shown. The Fourier window in this
example is deÔ¨Åned by a time span of 37 ms. Note that with any window the
distinguished harmonic frequencies all are equal to n times the inverse of the
window length with integer n = 1,2,3.... In this example the Ô¨Årst harmonic
equals ‚âà27 Hz, corresponding to the 37 ms window time span. Likewise the
second harmonic equals ‚âà54 Hz and so on. When comparing the assembled
graph from the 30 harmonics with the original signal, especially the peak
values appear to be slightly diÔ¨Äerent and more harmonics would be needed
to re-compose a perfect signal function like the original. In reality we are
often not interested in extremely high frequencies. For example in many
larger mechatronic systems the frequency spectrum of 0 ‚Äì 810 Hz of this
example would be suÔ¨Écient for the dynamic analysis.
A frequency analysis with a higher resolution of frequencies of for instance
1 Hz over a 1 kHz frequency range would require a 1 s window with 1000
harmonic frequency terms. These terms would all need to be calculated
with a Discrete Fourier-transform (DFT) algorithm, which integrates each
of the 2000 sine/cosine multiplications over the window to determine all
Fourier coeÔ¨Écients. It is clear that a lot of computation power is necessary
to do this calculation when a high frequency resolution is needed, especially

102
Chapter 2. Applied Physics in Mechatronic Systems
0
0.1
0.2
0.3
0.4
0.5
z,
z{¬Å
0
0.5
1
Time [s]
Output [V]
1.2
1.3
1.4
1.5
1.6
z,
z{¬Å
0
0.5
1
Time [s]
2.6
2.7
2.8
2.9
3
z,
z{¬Å
0
0.5
1
Time [s]
0
1
2
3
4
5
6
7
8
9
10
z,
z{¬Å
0
0.5
1
Time [s]
Output [V]
a  = 0.16                                                                 a  = -0.14                                                                   a  = 0.02
0
0
0
Figure 2.29: The eÔ¨Äect of a Fourier window on the Fourier coeÔ¨Écient can be signiÔ¨Å-
cant. Depending on the Fourier window in relation to the periodicity,
the same square wave signal will give diÔ¨Äerent non-zero values for a0
while it should be zero. By applying a windowing function the outer
parts at the start and the end of the Fourier window get a lower weight
to the total calculation result, thereby reducing the side eÔ¨Äects of the
window truncation.
when real-time information of fast changing signals to be obtained without
delays. To achieve a faster calculation method often a more eÔ¨Écient algo-
rithm is used, called Fast Fourier-transform (FFT). This algorithm uses the
symmetry of the sine and cosine functions to achieve a signiÔ¨Åcant increase
of eÔ¨Éciency with large numbers of sampled data. The mathematical details
go beyond the scope of this book but the method has become the standard for
signal analysis as applied in instruments like a Spectrum Analyser. Next
to the digital FFT operation, using sampled data from within the Fourier
window, spectrum analysers can also be based on analogue mixing of the
unknown signal with a known frequency where an analogue multiplication
is realised by a non-linear electronic element. This method is used in very
high frequency analysers.
One problem however remains in the Fourier decomposition over a limited
time span, which is illustrated in the upper three graphs of Figure 2.29.
The truncation of the signal to the limited Fourier window results in val-
ues of the Fourier coeÔ¨Écient a0 that are not equal to the real DC value
of the signal. In the example of the Ô¨Ågure the window length is related
to the signal period. As a result sometimes more of the positive value is

2.3. Signal Theory and Wave Propagation
103
integrated, sometimes more of the negative value, resulting in a non-zero
value for a0 while a pure periodically alternating square wave would have
zero DC. Mathematically this is caused by the condition that the window is
representative for a continuous signal from ‚àí‚àû< t < ‚àûas mentioned at the
beginning of Section 2.3.4. In fact it assumes that the window is repeated
in an inÔ¨Ånite number. This means that the signal is assumed to have a
discontinuity when the starting value of the window is diÔ¨Äerent from the
end value and this discontinuity will be interpreted as an impulse with a
wide frequency spectrum including the found DC error. This also means
that this error can be avoided by sampling over a window that is equal to
n times the signal period with integer n = 1,2,3...., but this is not possible
when examining unknown signals that are variable over time in periodicity
and amplitude. In that case a longer window will reduce the error although
often the time variability of signals is more important to track in dynamic
analysis, for which reason other methods were introduced to reduce the
errors when applying a relatively short Fourier window.
The main idea of all methods is by introducing a window function, a time
related magnitude function which is multiplied with the measured signal
as function of the time in the Fourier window. The window function is
determined such that after multiplication the resulting value at the begin-
ning and the end of the window becomes equal to zero, thereby avoiding
discontinuities when mathematically connecting an inÔ¨Ånite number of win-
dows. Inside the window it is a symmetric function with its maximum in
the middle. Mostly these window functions are smooth and bell-shaped of
which one example is shown in the lower graph of Figure 2.29 but also less
smooth shapes are used.
Like with anything in nature also this solution has its drawbacks. The
application of window functions results in spectral leaking with side-lobes,
frequencies around the analysed signal frequency that are visible in the
spectral analysis but not present in the original signal. Another adverse
eÔ¨Äect of windowing is visible on the frequency resolution of the spectral anal-
ysis. A signal with for example a sinusoidal frequency of 1 kHz should be
represented in the frequency spectrum as a sharp needle with a value equal
its amplitude, like in the Ô¨Ågures shown before with the triangle, square and
sawtooth waveform. The window function however causes a widening of the
peak. Furthermore also the spectral response to noise is inÔ¨Çuenced by the
window function. For all of these reasons many diÔ¨Äerent shape functions
are deÔ¨Åned, often given names after persons, like ‚ÄúHanning‚Äù, ‚ÄúGauss‚Äù and
‚ÄúBartlett‚Äù. Every function has its own beneÔ¨Åts and drawbacks depending
on the aspect that is most important for the analysis. Figure 2.30 shows as

104
Chapter 2. Applied Physics in Mechatronic Systems
Figure 2.30: The window functions of Bartlett, Gauss and Hanning illustrate the
diÔ¨Äerences that occur when applying windowed Fourier decomposition
in analysing the frequency spectrum of signals. The shown spectral
response is normalised around 0 Hz centre frequency when using
discrete Fourier-transform (DFT) where the ‚Äúbins‚Äù correspond to the
frequencies sampled by the DFT inside the window. When observing
periodically alternating signals this spectrum is visible around the
frequency peaks corresponding to the diÔ¨Äerent signal frequencies.
(source MATLAB code: Bob K. Wikipedia)
example the normalised spectral response of the three mentioned window
functions with its centre at 0 Hz. When analysing a single frequency signal
this spectrum is visible around the signal frequency. The frequency leaking
is clearly visible when observing the highest side-lobe around the centre
frequency with values ranging from -26 dB with a Bartlett window function
and -45 dB with a Gauss window function. On the other hand the Gauss
window function gives higher values of the side-lobes at frequencies further
away from the centre frequency.
For a mechatronic designer it is necessary and suÔ¨Écient to be aware of
these diÔ¨Äerences when using spectrum analysers. If real detailed analysis
is needed, specialised documentation must be consulted to be sure about
the measurement results.

2.4. Dynamic System Analysis and Modelling
105
2.4
Dynamic System Analysis and Modelling
In the previous section signals are introduced in terms of changing val-
ues of system parameters in time, space and frequency. As a next step
it is necessary to link this knowledge to the analysis of the dynamic re-
sponse of mechatronic systems to applied forces and movements in both
mathematical models and experimental veriÔ¨Åcation and test. This analysis
implies the introduction of the term stimulus as being a speciÔ¨Åc signal,
created with the purpose of stimulating a reaction from a dynamic system.
In mechatronic systems the stimuli are either created by actuators or by
external disturbances like environmental vibrations. The experimental
investigation of the dynamic properties of a mechanical system is always
done by applying external forces on diÔ¨Äerent locations of the system fol-
lowed by a simultaneous measurement of the response of the system to
these stimuli. The frequency content of these stimuli can be quite diÔ¨Äerent.
Depending on their origin, several typical responses to standardised stimuli
are distinguished that are related to either time-domain with equations
of motion or frequency-domain analysis with frequency responses. These
two domains are mathematically connected by the previously introduced
Fourier-transform. Its extended version, the Laplace-transform, deÔ¨Ånes an
intermediate domain, the Laplace-domain with equations, called transfer
functions, which are used to model the dynamic responses of a mechatronic
system based on a mathematical model of the system.
For that reason Ô¨Årst the Laplace-transform is explained, including the use
of poles and zeros in the analysis of dynamic systems.
2.4.0.1
Laplace-Transform
The Laplace-transform is a mathematical method that was created by the
French astronomer and mathematician Pierre-Simon, Marquis de Laplace
(1749 ‚Äì 1827). While being introduced by Laplace for his research in probabil-
ity theory, this transform has gained ample use in the analytical description
of linear dynamic systems as it enables to solve diÔ¨Äerential equations of
motion, which describe the position of an object in the time-domain, by
solutions in the frequency-domain in the form of a transfer function with
the Laplace operator s = œÉ+ jœâ. It is reduced to the Fourier-transform by
omitting the real term œÉ, which was introduced in the previous section and
gives frequency response functions as shown in several chapters in this
book.

106
Chapter 2. Applied Physics in Mechatronic Systems
The Laplace operator s = œÉ+ jœâ is a complex number that can graphically
be represented in a two dimensional plot called the Laplace-plane with the
value of œÉ on the horizontal real axis and jœâ on the vertical; imaginary axis.
In case f (t) is a function of the time variable t, then the Laplace-transformed
function F(s) = L {f (t)} is described as a function of the Laplace operator s in
the following way:
F(s) = L {f (t)} =
‚àû

0‚àí
e‚àíst f (t)dt,
(2.87)
where 0‚àíindicates the integration starts just below zero. The minus sign
will further be shown only when relevant.
A complete treatise on all aspects of this transform falls beyond the scope
of this book. A large set of transformations can be derived but for solving
diÔ¨Äerential equations with sine and cosine functions as solutions, which is
the case for dynamic motion systems, the transformations of diÔ¨Äerentiating
and integrating operations over time are the most important.
The Laplace-transform converts a diÔ¨Äerential of a variable x(t) over time
into the following function:
Fd(s) = L
 dx(t)
dt

= sx(s)‚àíx(0).
(2.88)
In practice the initial value x(0) of x(t) at t = 0 is neglected for the dynamic
analysis of mechatronic systems as the frequency response functions, which
are derived by means of the Laplace-transform are based on the continuous
presence of the input signal of the system.
The Laplace-transform applied to an integration action gives the following
function:
Fi(s) = L
‚éß
‚é™
‚é®
‚é™
‚é©
t‚Ä≤

0
x(t)dt
‚é´
‚é™
‚é¨
‚é™
‚é≠
= x(s)
s .
(2.89)
2.4.0.2
Poles and Zeros
The Laplace-plane is used when examining the stability of a dynamic system,
determined by the location of the poles and zeros of the dynamic transfer
function of the system after transforming its equations of motion. A transfer
function is generally a function with polynomial terms of s in the numerator
and/or the denominator. A zero is deÔ¨Åned as the value of s in the transfer

2.4. Dynamic System Analysis and Modelling
107
function at which the numerator equals zero, thereby reducing the total
transfer function to zero. A pole is just the opposite as it is deÔ¨Åned as the
value of s at which the denominator of the transfer function equals zero. In
that case the total transfer function becomes inÔ¨Ånite. As an example, the
previously shown Laplace-transform of a diÔ¨Äerentiating action shows a
zero at s = œÉ+jœâ = 0 at the origin of the Laplace-plane, while an integrating
action shows a pole at the origin of the Laplace-plane, indicating an inÔ¨Ånite
value.
Real Physical System Poles and Zeros
Real physical systems can exist without any zeros, so without s in the
numerator of their transfer function. It means that in that case there are no
values of s where the transfer function becomes really equal to zero. On the
other hand real physical systems always have poles as they determine the
limitations of the system to follow fast signals. From the fact that the jœâ
part of s increases with increasing frequency, s values in the denominator
indicate a general attenuation of the transfer function at higher frequencies.
This seems counter-intuitive as at the poles the denominator becomes equal
to zero but for other values of s the denominator grows bigger. As will be
shown in the next section the poles determine a local peak in a further
declining slope.
In fact real physical systems always have more poles than zeros, because of
the fact that no real physical system can respond to an inÔ¨Ånite frequency.
A system where the number of zeros does not exceed the number of poles
is called a proper system. Real systems with more poles than zeros are
therefore called strictly proper and one should be aware that every real
(not modelled) subsystem of a complete mechatronic system will always be
a strictly proper system with more poles than zeros. Subsystems can be
ampliÔ¨Åers, actuators and controllers but in principle every distinguishable
component like resistors, capacitors, screws and bolts to the level of atoms
can be seen as a subsystem, each with more poles than zeros. One can
conclude that any mechatronic system has inÔ¨Ånitely more poles than zeros
although most of these poles are related to extremely high frequencies (atom
scale!) and these can be neglected in the analysis of a mechatronic system.
2.4.0.3
Order of a Dynamic System
In many chapters in this book the order of the system in used to characterise
its dynamics. in mechatronic motion systems the origin of this term is found

108
Chapter 2. Applied Physics in Mechatronic Systems
in the order of the power of the position x in the equation of motion, while
the number is also equal to three other deÔ¨Ånitions that are all interrelated:
1. The number of energy containers like mass, spring, capacitor and
inductor.
2. The number of state variables or states.
3. The number of poles.
The number of energy containers connects to the equation of motion by
Lagrange, as explained in Section 2.1.2.3, and is used frequently in the
dynamics and electronics chapter where a mass-spring system and a Ô¨Ålter
with a capacitor and inductor both represent a second order system.
The number of states is used in the motion control chapter with State-Space
Design. For a mechanical object the position and velocity are the states
and these states are directly related to the number of energy containers
as position represents potential energy while velocity represents kinetic
energy. Finally the number of poles is directly linked to the order of the
equation of motion through the Laplace transform.
A Ô¨Årst order system has only one real pole. A second order system had two
complex conjugate poles and higher order systems have a combination of
real and complex conjugate poles.
2.4.1
Dynamic Responses in the time-domain
The time-domain is the domain of real life and for that reason it is quite
straightforward to imagine and visualise dynamic motion patterns of an
object. The step response is the best known response of a system to a stimulus
as it represents the transient behaviour between two diÔ¨Äerent equilibrium
states upon an instantaneous change of the input conditions. One can
think of examples like a car when a passenger enters it (change of load)
or when it drives onto a sudden rise of the road surface (change of course).
The response will always show a delayed movement, often with a decaying
periodic character, after the stimulus has occurred. This delayed response
of the mechanical elements in a mechatronic system is important as it
inÔ¨Çuences and even determines the ultimate performance.
The second time-domain related response is the impulse response. It is
less easy to imagine as the step response, because it ideally consists of an
inÔ¨Ånitely short stimulus with an inÔ¨Ånitely high magnitude. One can think
of hitting an object with a hammer and indeed this is a known method

2.4. Dynamic System Analysis and Modelling
109
for practical experiments, called modal analysis to determine the dynamic
behaviour of mechanical structures.
2.4.1.1
Step Response
Figure 2.31 shows a typical response of a dynamic system to a sudden change
of force (step) from value 0 to 1. The dynamic system in this case is a damped
mass spring system like will be presented in full detail in Chapter 3. This
response, if considered upside down, corresponds to the described response
when a passenger takes his place in a car.
The Laplace- and Fourier-transform of a step function with size x are as
follows:
F(s) =
‚àû

0
xe‚àíst f (t)dt = ‚àíxe‚àíst
s
''''
‚àû
0
= 0‚àí‚àíx
s = x
s
=‚áíF(œâ) = x
jœâ.
(2.90)
This shows that a step function consists of a continuous spectrum of sinu-
soidal frequencies equal with an amplitude that is inversely proportional to
the frequency.
One can consider the step function as a special case of a square waveform
with a fundamental frequency of 0 Hz Starting with the Fourier series of a
square waveform according to Equation (2.86), the limit of œâ ‚Üí0 results in
a continuous spectrum of frequencies starting at 0 Hz. A step function is
a suitable stimulus for a passive mechanical system to investigate the
occurrence of the lowest natural frequencies where the system resonates
z¬Ç
0
¬Ç
4
6
8
10
0
0.5
1
1.5
 t
x               F
Figure 2.31: Typical response of a damped mass spring system to a force on the
mass that changes from 0 to 1 at t = 0. The vertical axis is normalised
to 1 at t = ‚àû.

110
Chapter 2. Applied Physics in Mechatronic Systems
upon excitation, because of its limited frequency spectrum. It is further
important to note that the step response is less applicable as stimulus in
an actively controlled dynamic system with actuators, because with most
controllers the inÔ¨Ånite slope in the stimulus will force the actuator into
saturation and cause other non-linear eÔ¨Äects, which are not present un-
der normal conditions. Although a step is a one time event, one can as
alternative approximate the step by a low frequency square wave. This
limits of course the spectrum to the corresponding harmonic frequencies
but depending on the frequency range of interest this can help in doing
multiple measurements to reduce the impact of random noise, which will
be averaged out.
2.4.1.2
Impulse Response
An impulse function is can be seen as a special combination of two steps,
one up and one down immediately after each other as shown in Figure 2.32.
The ideal impulse is called a dirac-function F(t) = Œ¥(t) and lasts for an in-
Ô¨Ånitely short time with an inÔ¨Ånitely high magnitude with a multiplied value
of one. The response on such a stimulus of the same dynamic system as
was used with the step response is shown in Figure 2.33. This impulse
response looks quite similar to the corresponding step response although
it starts at x = 0 and stabilises on x = 0 again. The main reason why this
stimulus is so important and widely used is the fact that in the frequency-
domain it contains all frequencies at equal amplitude as shown by using
the Laplace-transform on a dirac function Œ¥(t) with value one, where in this
case the integration starts just below zero and may end just above it:
F(s) =
‚àû

0‚àí
Œ¥(t)e‚àíst f (t)dt =
0+

0‚àí
Œ¥(t)e‚àíst f (t)dt = 1,
(2.91)
which is equal for all frequencies.
l
h
t
Step 1
Step 2
Figure 2.32: An impulse function as a combination of two steps. In an ideal impulse
l = 0 and h = ‚àû, while the surface deÔ¨Åned by l and h equals one.

2.4. Dynamic System Analysis and Modelling
111
z¬Ç
0
¬Ç
4
6
8
10
z{¬Ç
0
{¬Ç
{)
{¬É
{¬Ü
1
x               F
 t
Figure 2.33: Typical response of a damped mass spring system on a force impulse
at t = 0. The vertical axis is normalised to 1 just after the impulse.
Measuring the response to an impulse and performing a FFT analysis of
this response immediately shows all resonances of a dynamic system.
Unfortunately it is not possible to create an ideal impulse function in reality,
due to limitations at high frequencies of the physical embodiment.
This means that the length becomes longer than zero and the peak value pro-
portionally lower than inÔ¨Ånite while simultaneously the edges are rounded
oÔ¨Ä. To a certain extent one can compensate the corresponding lack of high
frequencies by convolution12 of the measured response with the real spec-
trum of the stimulus but at higher frequencies the noise will limit the
reliability of the result.
As mentioned in the introduction, the impulse response is often used for
modal analysis of a mechanical structure like a building, a bridge or a sup-
porting structure in a mechatronic machine.
The impulse is applied by means of a standardised ‚Äúhammer‚Äù. The hammer
is provided with a rubber tip to avoid damage by the ‚ÄùinÔ¨Ånite‚Äú force and as
a consequence, the impulse will be rounded oÔ¨Äwith a lower amplitude of
the high frequencies.
By measuring the exerted impulse itself directly on the hammer, the devia-
tion of the ideal impulse can be taken into account.
One important drawback of this stimulus is that all the energy is inserted
in the system in a very short time with a high force. Inevitably this will
give erroneous information in case of non-linear systems. Likewise with the
step response, for this reason also a real impulse is less suitable as stimulus
for active controlled dynamic systems.
12Convolution is a mathematical method to deÔ¨Åne the cross-correlation between diÔ¨Äerent
functions.

112
Chapter 2. Applied Physics in Mechatronic Systems
2.4.1.3
Impulse Response and Pole Location
Figure 2.34 gives an overview of modelled impulse responses of a dynamic
system for diÔ¨Äerent locations of the poles in the Laplace-plane13.
The location on the real axis corresponds to non-oscillating gradually chang-
ing responses, either to a stable position for poles in the left-half-plane or
to inÔ¨Ånity for poles in the right-half-plane.
The imaginary part of the pole determines the oscillatory behaviour in rela-
tion to the real part.
The magnitude of the imaginary part (jœâ) determines the oscillation fre-
quency and the ratio between the imaginary part and the real part deter-
mines the damping ratio.
Real Axis
Imaginary Axis
-4
-3
-2
-1
0
1
2
3
4
-6
-4
-2
0
2
4
6
8
10
Figure 2.34: The impulse response of a dynamic system as function of the pole
locations in the Laplace-plane. In the left-half-plane the response
returns asymptotically to a zero deviation value while in the right-half-
plane the response grows exponentially to inÔ¨Ånity. For simplicity only
the positive imaginary axis is shown but any pole with an imaginary
part also has a conjugate complex counterpart mirrored around the
real axis.
13The logic behind these responses will be explained in more detail in Section 3.2.3.2.

2.4. Dynamic System Analysis and Modelling
113
2.4.2
Dynamic Responses in the frequency-domain
Even though real life events only happen in the time-domain it has become
customary for the analysis of mechatronic systems to use frequency-domain
related methods for good reasons. First of all the huge Ô¨Åeld of electronics
and sensors, dealing with Ô¨Ålters and noise spectra, is strongly focused
on frequency-domain related representations. Secondly the application of
Ô¨Ålters in the tuning of a motion controller is far more easy than time-domain
related methods which require convolution operators. Still one should
always be aware of the fact that frequencies are a mathematical concept
and the mathematical transformations that bring the dynamic behaviour of
mechatronic systems in the frequency-domain are only valid under strict
circumstances. The system must be linear and time invariant (LTI). It all
starts with the mathematical transforms by Fourier and Laplace followed
by an introduction in ‚Äúpoles and zeros‚Äù, terms that are used throughout this
book in relation to stability.
2.4.2.1
Frequency or Fourier-Domain Responses
To obtain the frequency response of a dynamic system from a transfer
function in the Laplace-domain only the positive imaginary set of all possible
complex s values is taken for the analysis, thereby reducing the Laplace-
transform to the Fourier-transform. This is allowed because a polynomial
in s is equally applicable for a subset of all values of s. The real part of s
does not represent a frequency dependent value and negative frequencies
are meaningless in real systems.
Even though the real number œÉ is not used when determining the frequency
response function of a dynamic system, the poles and zeros are most
important when controlling the stability of a mechatronic system.
For that reason the analytical equations for the dynamic behaviour of sys-
tems in this book always start with the Laplace-transform with the full
variable s = œÉ+ jœâ.
The resulting transfer functions after the Laplace-transform can directly be
used in mathematical modelling software to derive the graphical frequency
response functions.
For the analytical equations in the frequency-domain only the positive imag-
inary set of the s variable is used.
In that case Equations (2.88) and (2.89) reduce to the Fourier transform F
and give the frequency response functions of a diÔ¨Äerentiating and integrat-

114
Chapter 2. Applied Physics in Mechatronic Systems
ing action over time:
Fd(œâ) = F
 dx(t)
dt

= jœâx(œâ)
and
(2.92)
Fi(œâ) = F
‚éß
‚é™
‚é®
‚é™
‚é©
t‚Ä≤

0
x(t)dt
‚é´
‚é™
‚é¨
‚é™
‚é≠
= x(œâ)
jœâ = ‚àíj x(œâ)
œâ .
(2.93)
These transformations indicate two important eÔ¨Äects of diÔ¨Äerentiation and
integration on the frequency response. The Ô¨Årst eÔ¨Äect of diÔ¨Äerentiation over
time is a proportional increase of the magnitude of the frequency response
with increasing frequency, as indicated in Figure 2.35.a:, caused by the
multiplication with œâ and the zero at s = œÉ + jœâ = 0. The second eÔ¨Äect of
diÔ¨Äerentiation over time is a positive phase shift of 90¬∞, corresponding to
the positive imaginary term j in the transfer function. This fully complies
with the reasoning about position, velocity and acceleration of a sinusoidal
movement, which was presented in Section 2.3.1. Following the same line of
logic, the integration of a variable over time gives a proportional decrease
of the magnitude of the frequency response with increasing frequency, as
indicated in Figure 2.35.b:, because of the division by œâ, corresponding to a
pole at s = œÉ+ jœâ = 0 combined with a phase shift of ‚àí90¬∞corresponding to
the negative imaginary term ‚àíj in the transfer function.
2.4.2.2
Domain Notation of Dynamic Functions
It is important to note that equations from the frequency-domain should not
be confused with equations from the time-domain. When it is necessary to
clearly distinguish the diÔ¨Äerent domains, the notation of a function like f (t),
with the variable t between round brackets, strictly refers to the equations
of motion in the time-domain. The notations with the variable ‚Äús‚Äù refer
to the transfer functions in the Laplace-domain, while ‚Äúœâ‚Äù14 for the radial
frequency or ‚Äúf ‚Äù for the temporal frequency all strictly refer to the frequency-
domain. The addition of the distinguishing variable terms t, s, œâ or f will
in many cases be only done once in every equation at a term before or after
the equal sign, or fully omitted when obvious, in order to avoid too many
brackets in the equations. This limited notation is allowed and suÔ¨Écient as
an equation is only valid when the entire equation is deÔ¨Åned in the same
domain.
14Often the frequency response function is written as a function of (jœâ) as it is derived from
the transfer function in the Laplace-domain by taking only the jœâ part of s. For reasons of
simplicity and the fact that j is a constant, only (œâ) is used as variable.

2.4. Dynamic System Analysis and Modelling
115
Figure 2.35: A graphical plot of the Laplace-plane with the magnitude of a diÔ¨Äeren-
tiation and an integration clearly shows the zero and pole location at
œâ = œÉ = 0. The logarithmic magnitude scale creates the same shape for
the zero as the pole, giving rise for the term anti-resonance for the zero.
The frequency response is derived from a subset of s consisting only of
its positive imaginary part, leading to the Fourier transform. It equals
the intersection of the total plot with a plane enclosed by the posi-
tive imaginary (frequency) axis and the normal on the Laplace-plane
through its origin.
2.4.2.3
Frequency Response Plots
Frequency-domain related stimuli avoid the extremely high forces that are
related to the ‚Äúsingle event stimuli‚Äù of the time-domain analysis methods,
because they apply a more or less permanent continuous spectrum of fre-
quencies with suÔ¨Éciently reduced amplitudes. These signals enable longer
measurements without errors due to overload. Sinusoidal periodically al-
ternating signals are quite easy to create in electronics. For that reason
in most cases the stimuli consist of a sinusoidal periodically alternating
signal with a known amplitude and a gradually increasing frequency. This
frequency sweep method allows very precise measurements including the
eÔ¨Äects of nonlinearity as these appear as higher-frequency harmonics in
the spectrum. One should, however, be careful in setting the sweep-time
when measuring large mechanical systems with resonances due to the time
needed for these resonances to gain suÔ¨Écient energy and become visible in
the measured frequency spectrum. Fortunately modern algorithms allow
compensation of these eÔ¨Äects to a wide extent, limited by the noise and
sampling errors in the measurement. With a given measurement system
one can improve the accuracy by lower scanning speeds, and/or by repeated
measurements as both methods reduce the eÔ¨Äect of noise by averaging.

116
Chapter 2. Applied Physics in Mechatronic Systems
As alternative to the frequency sweep a wide-band signal can be applied
like white noise of which the power spectral density (PSD = signal value
squared divided by the frequency range) is constant. In practice ideal white
noise does not exist and also due to high frequency limitations in the device
under test pink noise with a PSD inverse proportional to the frequency is
more suitable as stimulus for mechanical systems.
Another example of a more wideband frequency spectrum excitation ap-
plies a stimulus that consists of a synthesis of diÔ¨Äerent frequencies called
multi-sines. This computer based method allows to create any spectrum of
signals, with correlated phase and frequency, random phase relations or any
other combination. Frequency areas of no interest can be avoided, diÔ¨Äerent
amplitudes can be chosen for diÔ¨Äerent frequency areas to avoid overload
or non-linear behaviour and the frequency spectrum can be reÔ¨Åned in the
areas of most interest. As the signals are fully deterministic, all phase and
amplitude relations in the stimulus are known and it becomes fully straight-
forward to determine the dynamic system response. Two representations
are frequently used to display the response of a dynamic system to these
frequency-domain related stimuli:
‚Ä¢ The Bode plot to show the magnitude and phase response upon a con-
tinuous frequency stimulus in two graphs as function of the frequency,
one for the magnitude and one for the phase.
‚Ä¢ The Nyquist plot to show the magnitude and phase response on a
continuous frequency stimulus in one graph as function of the fre-
quency.
2.4.2.4
Bode Plot
The Bode plot, named after the American engineer Hendrik Wade Bode (1905 ‚Äì
1982), visualises the frequency response of the output of a dynamic system to
a sinusoidal periodically alternating input stimulus and is originally known
from analogue electronic signal analysis. Figure 2.36 shows an example
of a Bode plot of a fourth order coupled mass spring system, which will be
introduced in Chapter 3.
A Bode plot shows two graphs on top of each other, which both share the
same horizontal axis with the frequency as parameter. The upper graph
is the magnitude Bode plot, showing the ratio between the magnitude of
the response and the magnitude of the stimulus on the vertical axis. In
the second graph, the vertical axis shows the phase shift of the response
relative to the phase of the stimulus.

2.4. Dynamic System Analysis and Modelling
117
A Bode plot further has the following characteristics:
‚Ä¢ The frequency and the amplitude scales are logarithmic to base 10.
‚Ä¢ The frequency scale can be either in rad/s or in Hz.
‚Ä¢ The magnitude scale depends on the units of the stimulus and the
response, which can be diÔ¨Äerent. For instance the stimulus can be a
force [N] while the response can be a position [m].
‚Ä¢ The phase scale can be either in radians or degrees. In practice always
the scale in degrees is used because it enables an easier number
reÔ¨Ånement than with radians, while several degrees phase shift can
already be important in a control system.
‚Ä¢ The Bode plot gives information about the response of the system on
an excitation by a constant stimulus at all frequencies in the displayed
frequency range. One should be aware when measuring Bode plots
that several time-domain related phenomena, like resonances, need
time to collect energy. This requires a suÔ¨Éciently long stimulus time
to develop a correct magnitude at resonance.
The double logarithmic scales of magnitude and frequency are applied,
because most frequency responses are either proportional or inversely pro-
portional to the frequency f or œâ to the power n, where n is an integer.
With double logarithmic scales the function logœân = nlogœâ becomes a straight
line for all values of n, because one scale shows logœân and the other logœâ.
The resulting line will have an upward slope when n is positive and a down-
ward slope when n is negative. It is common to indicate the order of the
slope in terms of n. For example a transfer function f (œâ) = 1/œâ2, which means
that n = ‚àí2, results in a line with a slope of ‚àí2 in the Bode plot.
In Section 2.4.0.1, where the Laplace-transform was introduced, a +1 slope
was shown to be representative for a diÔ¨Äerentiating action with a correspond-
ing phase shift of +90¬∞and a ‚àí1 slope is representative for an integrating
action with a corresponding phase shift of ‚àí90‚ó¶.
This direct link between phase and slope might lead to the conclusion that
the phase plot gives redundant information. In simple minimum phase
linear systems it is indeed true that the relation between the phase and am-
plitude slope is unambiguously determined. However, often in real systems
this relation is more complicated and with non-minimum phase systems the
phase shift can show a more negative value than would be expected from
the magnitude-slope values in the magnitude Bode plot.

118
Chapter 2. Applied Physics in Mechatronic Systems
10
z,{
10
z¬Ü
10
z¬É
10
z)
10
z¬Ç
Magnitude [m/N]  (abs)
10
1
10
¬Ç
10
3
10
)
z,¬Ü{
z,[¬Å
z¬Ö{
z)¬Å
0
Phase [deg]
Frequency  (Hz)
Magnitude [m/N]   [dB]
){
¬Ü{
,¬Ç{
,¬É{
¬Ç{{
¬Ç
Figure 2.36: Example Bode plot of a motion system. The upper graph gives the
magnitude of the position response divided by the magnitude of the
force stimulus. The lower graph gives the phase relation between
the position response and the force stimulus. Starting at the low
frequency side Ô¨Årst the response is frequency independent but at 15
Hz a damped resonance determines the start of a negative slope where
the magnitude decreases as function of the frequency. Around 3 kHz a
typical resonance and anti resonance indicate the eÔ¨Äect of a decoupling
mass as will be explained in Chapter 3.
The corresponding behaviour is characterised for instance by an initial
reaction movement in the opposite direction of the excitation force and an
example of such a system will be shown in Section 3.4.3 about non-collocated
sensors and actuators, where the force is exerted at another location than
the movement is measured.
These phenomena occur in reality, especially with digital signal processing
as this always adds some delay, giving suÔ¨Écient reason to not leave the
phase plot out in the analysis of the open-loop response of modern feedback
controlled mechatronic systems.
For stability and robustness analysis the open-loop phase plot is often even
more important than the amplitude. This is the main reason that the
Nyquist plot has been developed.
Nevertheless, due to its clear relation with the standard applied integration
and diÔ¨Äerentiation operations in motion control systems, the Bode plot is a
frequently used graphical representation both in practice and in this book.

2.4. Dynamic System Analysis and Modelling
119
Table 2.3: The relation between the order of the slope of a Bode plot and the magni-
tude ratio in decibel, amplitude ratio and power ratio, for a frequency
diÔ¨Äerence of a factor two or ten.
Slope
Per octave (f1 = 2f2)
Per decade (f1 = 10f2)
dB
Amplitude
Power
dB
Amplitude
Power
‚àí2
‚àí12
0.25
0.0625
‚àí40
10‚àí2
10‚àí4
‚àí1
‚àí6
0.5
0.25
‚àí20
0.1
10‚àí2
0
0
1
1
0
1
1
1
+6
2
4
+20
10
102
2
+12
4
16
+40
102
104
Absolute Magnitude or Decibel
Instead of using absolute numbers with the magnitude scale often the scale
is divided in decibels.
The unit ‚ÄúBel‚Äù was Ô¨Årst introduced by the American engineer Alexander
Graham Bell (1847 ‚Äì 1922) to characterise the electrical power loss over a
telegraph cable.
The resulting numbers were found to be impractically low with signiÔ¨Åcant
values behind the dot. For instance a factor two would be equal to log2 =
0.6 Bel and for that reason it became customary to use the term ‚Äúdeci-Bel‚Äù
instead and add a factor 10 to the logarithm of the power ratio giving:
10log P1
P2
[dB].
(2.94)
Signal levels are proportional to the square root of power.
It is known from mathematics that logxy = ylogx and this means that the
logarithm to the base 10 of the ratio between two power levels is twice the
logarithm of the ratio between either voltage or current.
To give the same value in dB the calculation of for instance a voltage signal
ratio in dB has to be equal to:
20log V1
V2
[dB].
(2.95)
In terms of decibel, the -1,-2,+1,+2 etc term for the slope in the Bode plot
becomes equal to a certain number of dB per frequency ratio as shown in
Table 2.3. The values are given both for a decade, representing a factor ten
between the frequencies, and for an octave with a factor two diÔ¨Äerence, as
commonly used in sound systems and music. The dB is frequently used
for the magnitude scale of Bode plots, because it avoids the ‚Äúpower of ten‚Äù

120
Chapter 2. Applied Physics in Mechatronic Systems
term with large numbers. Sometimes it is more practical to use the absolute
number when analysing the dynamic properties of mechatronic systems as
it avoids the need to calculate factors from dBs.
In control terminology the 0 dB level is often used to indicate the frequency
where the magnitude of the open-loop frequency response of a feedback
controlled system becomes equal to one. In case one prefers absolute values,
like with the dynamics of a mechanical system as presented in Chapter 3, it
is named the unity-gain cross-over frequency.
With the Bode plots in this book the horizontal scale is in Hz and the
magnitude scale is absolute with the exception of the motion control and
electronics chapter where both notations are used at diÔ¨Äerent sides of the
magnitude plot.
2.4.2.5
Nyquist Plot
The Nyquist plot, named after the Swedish electrical engineer Harry Nyquist
(1889 ‚Äì 1976), is a two-dimensional vector plot showing the magnitude and
phase of a transfer function as a complex number according to Section 2.3.2.
The Nyquist plot is often used for the stability and robustness analysis of
feedback controlled systems as will be presented in depth in Chapter 4 on
motion control.
The magnitude M is represented by the length of the vector starting in the
origin, while the phase angle (œï) is represented by the angle of the vector
relative to the positive horizontal axis.
The sign of this angle is positive when moving against the direction of the
clock.
The use of the Nyquist plot for stability analysis is based on the Nyquist
stability theorem that states that a closed-loop transfer function will not
have poles in the right half of the Laplace-plane, when the Nyquist plot of
the open-loop transfer function does not show a total clockwise encircling of
the -1 point on the real axis.
Most Nyquist plots show a negative phase angle in the direction of the clock,
because most dynamic systems have a response with a phase delay.
When the diÔ¨Äerent vectors for all frequencies are connected, a curved line is
obtained with the frequency as parameter along the line.
A typical Nyquist plot of the open-loop response of a simple feedback con-
trolled system is shown in Figure 2.37.
The blue line represents the response as function of increasing frequency in

2.4. Dynamic System Analysis and Modelling
121
z¬Å
z)
z[
z¬Ç
z,
0
z[
z¬Ç
z,
0
,
¬Ç
&*z¬Ç¬Å
¬ã$*z¬Ç[¬Ñ
^¬å|¬Ä¬ç¬á*¬Ç¬Ñ¬Å
0 dB
,{
6 dB
)
¬Ç
Real Axis
Imaginary Axis
(-)
,
,¬Ç¬Å
,¬É
¬Ç
[¬Ç
M
Figure 2.37: The Nyquist plot is often used to predict the stability of a system
with negative feedback control before the feedback loop is closed. This
example shows such an open-loop transfer function of a position con-
trolled object. The blue line connects the polar vector points (black
arrow M) deÔ¨Åned by the phase angle relative to the positive real axis
and the magnitude as length of the vector for diÔ¨Äerent frequencies. It
starts at low frequencies following the blue arrow to the origin. The
phase angle of this example is negative.
the direction of the origin. In principle all dynamic systems are incapable
of responding to extremely high frequencies. As a consequence all Nyquist
plots of dynamic systems end in the origin.
The distance of the blue line to the dotted circles determine how strongly
the negative feedback system will show a higher response level than one
near the unity-gain crossover frequency after closing the loop.
In the shown example the blue line touches the circle of 2 dB/ factor1.25,
which means that with the same amplitude of the stimulus after closing the
loop, the system will show approximately a 25 % larger amplitude of the
response near its open-loop unity-gain cross-over frequency than at lower
frequencies.
Instead of these dotted circles of which the centre shifts to the left at lower
Q factors also another set of circles is often applied, all centred around -1
and representing the maximum sensitivity for disturbances of the closed
loop system. This all will be further explained in Chapter 4.

122
Chapter 2. Applied Physics in Mechatronic Systems
Even though the Bode plot and the Nyquist plot both contain the same
information there are two important aspects that make them both useful:
‚Ä¢ A Bode plot is useful both in open-loop and closed-loop analysis of a
dynamic system but it is less straightforward to determine the stability
in complex systems with many resonances.
‚Ä¢ A Nyquist plot is ideal to determine stability in complex systems but
it is meaningless in analysing closed-loop systems.
Unfortunately the last statement is often not fully understood by students.
Furthermore, the use of the Nyquist plot is also not made easier by the er-
ratic practise of certain modelling software packages to display the Nyquist
plot with both the negative and positive frequencies in their default setting.
As stated before, negative frequencies are meaningless in reality and the
resulting double lines and spirals can be quite confusing.
2.4.2.6
Limitation to LTI Systems
The Laplace- and Fourier transform and all their related mathematical
analysis methods and plots can in principle only be used with diÔ¨Äerential
equations of motion of Linear Time-Invariant (LTI) mechatronic systems.
LTI systems are deÔ¨Åned as having a linear scalable relation between input
and output while the eÔ¨Äect of diÔ¨Äerent inputs of the system can be super-
imposed and the dynamic response of the system to the same input signal
does not change over time.
Real systems are always Non-Linear Time-Variable ‚ÄúNLTV‚Äù with some
amount of non-linearity and change of dynamic behaviour over time for in-
stance by thermal inÔ¨Çuence on diÔ¨Äerent properties of the applied materials.
Nevertheless it is in most cases allowed to describe such systems with the
Laplace- and Fourier-transform by linearising their dynamics around a
certain working point and assuming suÔ¨Éciently constant properties.// Most
examples in this book apply this linearisation, while deviations from the
ideal situation can mostly be covered by suÔ¨Écient margin in the design of the
controller. In extreme situations it is possible to apply diÔ¨Äerent controller
settings for each diÔ¨Äerent situation.

blank
left
intentionally
page
This

blank
left
intentionally
page
This

Chapter 3
Dynamics of Motion
Systems
Adrian Rankers, Jan van Eijk, Robert Munnig Schmidt
Introduction
The dynamic properties of all elements in a mechatronic system each have
their own impact on the system performance regarding speed and precision.
It is true to say that the mechanical part is often the most determining factor
for the Ô¨Ånal performance of the total mechatronic system. For this reason it
is more than anything else of paramount importance to fully understand
the physical properties that are linked with items like mutually connected
springs, bodies and dampers.
The chapter starts with the relation between the stiÔ¨Äness of a mechani-
cal construction and its inherent relative position accuracy under external
loads. This will illustrate the relation between the accuracy and the natural
resonance frequency of the mechanism while numerical examples will create
a feeling on the order of magnitude of the parameters. It also includes an
example of an active feedback controlled positioning system as used in a
CD-player, in order to link the feedback principle with stiÔ¨Äness, as a short
introduction towards Chapter 4 on motion control.
This introduction is followed by a more theoretical analysis of the compli-
ance of a mechanical system to a force, the motion of a lumped damped
125

126
Chapter 3. Dynamics of Motion Systems
mass-spring system1 to an external periodic force. Closely related is the
reaction of a dynamic system to a movement of the support which is called
transmissibility. Ample use will be made of Bode plots and a simpliÔ¨Åed
graphical way to visualise the compliance of each element to further clarify
its impact on the overall frequency response.
For good reasons, the dynamic properties presented in this chapter are
initially limited to movements in only one degree of freedom, mostly using
the x coordinate direction, with linearised properties of the elements. The
basic understanding of the related physics is essential before the more math-
ematical analysis of multi dimensional structures can be presented. It gives
a solid ground for Section 3.3 on modal decomposition, which is the basis for
the analysis of complex structures with multiple degrees of freedom. This
last section starts with a Ô¨Årst step towards ‚Äúnon-rigid body dynamics‚Äù by
means of a two-body mass-spring system, followed by the introduction of nat-
ural modes of vibration, generally called dynamic eigenmodes, and the way
how the location of the measurement and actuation inÔ¨Çuences the observed
dynamic transfer function of the mechanical structure in a mechatronic
system. This section also includes a more thorough multi degree of freedom
treatise of the eigenmode analysis of mechanical structures with graphical
methods to visualise the dynamic properties for better understanding.
With the obtained knowledge on dynamic eigenmodes Section 3.4 completes
this chapter with the introduction of typical frequency responses of mechan-
ical structures, of which the full understanding is required when designing
controlled motion systems.
3.1
StiÔ¨Äness
Most people have a rather good qualitative feeling about what is stiÔ¨Äand
what is not, but it becomes diÔ¨Äerent when it is necessary to work with
quantitative data based on SI units. In general the term spring constant is
associated with the spring as a separate element representing its resistance
against deformation. In order to get a feeling for the order of magnitude of
the stiÔ¨Äness values of springs in practical mechanical systems it is useful
to take some real objects as example and estimate how much they would
deform under a known load. Take for instance a spring board in a swimming
1The term ‚Äúmass-spring‚Äù or ‚Äúmass-spring-damper‚Äù system is a regularly used term although
a spring and damper are objects, while the mass is a property of a body. To avoid confusion,
the regular naming is used for the complete system, while the element is named a body or
object with mass m.

3.1. StiÔ¨Äness
127
pool. Assume that the mass of the swimmer is 75 kg, exerting 750 N of force
and the board moves 10 cm. This corresponds to a stiÔ¨Äness value of the
board of 7.5¬∑103 N/m. This is a low value for stiÔ¨Äness, matching the Ô¨Çexible
character of a spring board. As a second example exercised in the class-room
a load of 1000 kg from 15 students is standing on a strong table. This would
represent a force of approximately 104 N while the table deÔ¨Çected less than
10 mm resulting in a stiÔ¨Äness of about 106 N/m, which is already a much
higher value than with the spring board. An example of a very high stiÔ¨Äness
is a steel rod with a length of 200 mm at 10 mm diameter, which has a
stiÔ¨Äness of ‚âà108 N/m.
With these and other examples it can be concluded that practical stiÔ¨Äness
values of mechanical structures span a range of more than six orders of
magnitude from approximately 103 to 109 N/m.
3.1.1
Importance of StiÔ¨Äness for Precision
To achieve a certain level of accuracy, the stiÔ¨Äness of a system is a very im-
portant property. A system with a high stiÔ¨Äness will deform less in response
to an applied force and in most cases that is a beneÔ¨Åt for a precision system.
An example of a system, where an increased higher stiÔ¨Äness directly results
in a better system performance, is the turning lathe, which is very schemat-
ically shown in Figure 3.1. Depending on the stiÔ¨Äness of the support, the
tip of the cutting tool will move away from the intended position due to
the cutting forces. The force and the corresponding movement is seldom
constant and accurately known so it will limit the possibility to manufacture
precise parts. The typical stiÔ¨Äness of a turning lathe is about 107 ‚àí108 N/m.
When a maximum deviation of 1 Œºm is speciÔ¨Åed, the change in the cutting
force is not allowed to be larger than 10 N.
Another example where high precision is required is the inspection micro-
scope shown in Figure 3.2. In this example the desired maximum mea-
surement error is 10 nm. This implies that the maximum deviation xmax
from the ideal position between the microscope and the measured object
has to remain smaller than that value. This requirement directly results in
a minimum value for the stiÔ¨Äness between the object and the microscope,
because of the inÔ¨Çuence of vibrations of the table top where the microscope
is placed. The following assumptions are chosen for this example.
The upper part of the microscope has a mass of 5 kg and it is used in a labo-
ratory, where the measured vibrations on the table top show acceleration
levels up to 0.01 m/s2. These accelerations have to be followed by the mass of
the upper part of the microscope, requiring a certain force Fb(t) to transmit

128
Chapter 3. Dynamics of Motion Systems
Rotang workpiece
Cu¬éng tool
F
m
k
Lathe
dx
x
Figure 3.1: Schematic view of a turning lathe. The force that is exerted by the
rotating work piece on the cutting tool will deform the spring with
stiÔ¨Äness k resulting in a displacement dx away from the intended
position of the tool tip.
the acceleration to that part. This force will cause a deformation of the
connection stiÔ¨Äness k that must remain smaller than the maximum (peak)
error of xe,p = 10 nm. The required stiÔ¨Äness (k) to achieve this maximum
position error under these circumstances can be calculated using Hooke‚Äôs
law and the second law of Newton:
k ‚â•Fb(t)
xe,p(t) =
m d2x
dt2
xe,p
= 5¬∑0.01
10¬∑10‚àí9 = 5¬∑106 N/m.
(3.1)
For harmonic, sinusoidal vibrations this value is directly related to the un-
damped natural frequency œâ0, as determined from the equations of motion
according to the following reasoning. A system that consists of a body and a
spring will resonate in its undamped natural frequency, when the forces in-
side the system are in balance and the motion is sustained without external
forces. This means that the force Fs(t), resulting from the deformation of
the spring, is always in equilibrium with the force Fb(t), which corresponds
to the acceleration of the body:
Fb(t)+ Fs(t) = m d2x
dt2 + kx = 0,
=‚áím d2x
dt2 = ‚àíkx.
(3.2)
The sign can be checked by the reasoning that a deformation of the spring
in the positive x direction causes a force and a corresponding acceleration
in the opposite direction of the deformation. It is known that in resonance
the body follows a sinusoidal harmonic movement x(t) = xp sin(œâ0t), with xp

3.1. StiÔ¨Äness
129
Vibraons
k
m
Table top
Support frame
Microscope
head
Object
xe
xf
x
Figure 3.2: Schematic view of an inspection microscope. Vibrations in the table top
act on the entire instrument. The microscope head will not be able to
perfectly follow the accelerations, because of the mass and the limited
stiÔ¨Äness, causing an alignment error xe with the object.
being the peak amplitude.
With this information the following equation can be formulated:
‚àímxpœâ2
0 sin(œâ0t) = ‚àíkxp sin(œâ0t).
(3.3)
From which follows:
œâ0 =

k
m
[rad/s].
(3.4)
From the calculated value of the required stiÔ¨Äness in Equation (3.1), the
related undamped natural frequency of the system can be derived:
œâ0 ‚â•

5¬∑106
5
= 1000 [rad/s], corresponding to:
f0 ‚â•1
2œÄ1000 = 160 [Hz].
(3.5)
From Equation (3.1) it can also be concluded that a larger mass of the
upper part of the microscope requires a proportionally increased stiÔ¨Äness,
to achieve the same accuracy. This would mean that the undamped natural
frequency is kept constant. It appears that this frequency is directly related
to the performance with respect to the suppression of external vibration
disturbances. To show this in mathematical form, the behaviour of the upper
part is observed. The microscope head has to follow the sinusoidal harmonic
motion of the table top vibrations with position x(t) and acceleration ¬®x(t)

130
Chapter 3. Dynamics of Motion Systems
equal to:
x(t) = xf,p sin(œât)
[m]
=‚áí
¬®x(t) = ‚àíxf,pœâ2 sin(œât)
m/s2
,
(3.6)
where xf,p equals the peak amplitude of the table top vibrations. The ampli-
tude of the force Fb,p acting on the measurement head in order to follow the
vibrations is determined by the second law of Newton:
Fb(t) = m ¬®x(t)
=‚áí
Fb,p = mxf,pœâ2
[N].
(3.7)
The resulting maximum (peak) deformation of the connecting spring equals:
xe,p =
Fb,p
k
=
mxf,pœâ2
k
[m].
(3.8)
With equation (3.4), k/m can be replaced by œâ2
0, resulting in the following
expression:
xe,p = xf,p
œâ2
œâ2
0
‚áí
xe,p
xf,p
= œâ2
œâ2
0
.
(3.9)
The minimal value of œâ0 to achieve a certain precision becomes:
œâ0 ‚â•œâ

xf,p
xe,p
[rad/s]
and
f0 ‚â•f

xf,p
xe,p
[Hz].
(3.10)
This means that the minimum undamped natural frequency is proportional
to the frequency of excitation and to the square root of the ratio between the
excitation amplitude and the allowable error. In the next section this same
relation is shown in the performance of a feedback controlled positioning
system deÔ¨Åned by the maximum tracking frequency, called bandwidth œâc
and the position deviation Œ¥. It will show that these values are related to
this undamped natural frequency in passive systems and it is a preview to
Chapter 4 on motion control. With the microscope example one can imagine
that at frequencies above this high frequency bandwidth the vibration of
the support frame will fully add to the measurement error, because the
microscope head no longer is able to track this vibration.
3.1.2
Active StiÔ¨Äness
In Chapter 1 the development of the optical disk has been mentioned as
an important driver for mechatronics. It required an actively controlled,
contact-less positioning of the optical pick-up unit. This example is very

3.1. StiÔ¨Äness
131
appropriate to link precision to the active motion control of Chapter 4. The
basic speciÔ¨Åcations of such an optical disc system can be derived from the
requirements. In Figure 3.3 a schematic view is shown. For this example
only the radial tracking deviation (Œ¥r) will be investigated, while the same
reasoning can be followed to determine the required stiÔ¨Äness for the focal
tracking deviation (Œ¥f) and the other movement directions including the
rotations. For faultless reading of the data, the radial tracking deviation
of the optical pick-up unit has to be smaller than 0.2 Œºm and the focus
deviation needs to be smaller than 1 Œºm. The disturbances acting on the
system are the eccentricity of the optical disk causing a periodic motion of
200 Œºm in the radial direction at a frequency of 10 Hz and shocks causing
sinusoidal vibrations of 200 Œºm in all directions with the main frequency
component at 25 Hz. As a Ô¨Årst step, the control system is approximated as
if the optical pick-up unit would be connected to the track by a spring with a
certain radial stiÔ¨Äness kr. Similar to the previous example of the microscope,
the required stiÔ¨Äness value of kr is calculated from the accelerations that
have to be followed. The largest disturbing forces are taken as basis for the
calculations. In this case these are the forces caused by the shocks, because
they have the highest frequency, which for the same displacement amplitude
as for the eccentricity leads to larger accelerations and related forces on the
optical disk system.
The movements caused by the shocks are characterised by sinusoidal vibra-
tions, therefore the maximum (peak) acceleration of these movements is
Opcal disk
Opcal
Pick-up
Unit
Radial tracking
Focus
fk
rk
r
f
m
Figure 3.3: Schematic view of an optical disk system with an active ‚Äúvirtual‚Äù spring,
created by the position control system, which connects the pick-up
unit in six orthogonal coordinate directions (translations and rotations)
to the track. From these directions two translation stiÔ¨Äness values
are shown, the radial stiÔ¨Äness kr and the focal stiÔ¨Äness kf, which in
combination with the mass of the pick-up unit determine the tracking
deviations Œ¥r and Œ¥f under the impact of eccentricity and unÔ¨Çatness of
the disk and external vibrations.

132
Chapter 3. Dynamics of Motion Systems
described by:
¬®xp = xpœâ2 = xp(2œÄf )2 = 200¬∑10‚àí6(2¬∑œÄ¬∑25)2 ‚âà5
m/s2
.
(3.11)
When the mass of the pick-up unit is 10‚àí2 kg, the peak amplitude Fb,p of the
force that corresponds to the acceleration equals 0.05 N. With this value
and the allowable maximum deviation Œ¥r of 0,2 Œºm, the minimum radial
stiÔ¨Äness kr can be calculated:
kr ‚â•
Fb,p
Œ¥r
=
0.05
0.2¬∑10‚àí6 = 2.5¬∑105
N/m

.
(3.12)
This would result in an undamped natural frequency of:
f0 = œâ0
2œÄ = 1
2œÄ

k
m = 1
2œÄ

2.5¬∑105
0.01
‚âà800
[Hz].
(3.13)
When checking this frequency with equation (3.10), the same result is ob-
tained:
f0 ‚â•f

xp
Œ¥r
= 25

200¬∑10‚àí6
0.2¬∑10‚àí6 ‚âà800
[Hz].
(3.14)
In a real optical disk player it is not possible to directly connect the disk
and the lens unit by a spring, which means that the necessary connection
stiÔ¨Äness has to be created by something else. For the CD-player this is
achieved by the proportional part of a negative-feedback controller, which
creates a proportional counteracting force by means of a Lorentz actuator.
This actuator, of which the principle will be explained in Chapter 5, is widely
used in mechatronic systems as it generates a proportional force to its input
current. Figure 3.4 shows the four steps that are taken to achieve such a
proportional negative-feedback controller:
1. The measurement system converts the deviation from the set point
into a measurement value, Œ¥m = GmŒ¥r, which is subtracted from the
reference, which equals zero in this example (r = 0), resulting in a
control error value: ec = ‚àíŒ¥m.
2. The proportional feedback controller converts this control error into
a proportional control value as a setpoint for the power ampliÔ¨Åer:
up = Gcec = ‚àíGcŒ¥m.
3. The power ampliÔ¨Åer generates a current to the actuator, proportional
to the setpoint from the controller: Io = Gpup.

3.1. StiÔ¨Äness
133
m
k

x
r
r
Power ampli%er
Actuator
      G 

Measurement
I     G u

a
o
F
G I

oI
pu
o            p   p
m           m    r
	
Controller
m
Moving 
body
2
F
x
ms

a
a r
r = 0
u    G  

p           c 


c 
c 
e
e
r
Figure 3.4: Virtual spring created by negative feedback of a deviation Œ¥r of the
position from a set point x0 to a force acting on a body in a servo system.
The equivalent spring stiÔ¨Äness following Hooke‚Äôs law is equal to the
total series gain of the negative feedback loop.
4. The actuator exerts a force to the moving body proportional to the
current from the ampliÔ¨Åer: Fa = GaIo.
These steps are applied in series so multiplying all gain factors gives the
relation between the actuator force and the radial deviation:
Fa = GtŒ¥r = ‚àí

GmGaGpGc

Œ¥r
[N].
(3.15)
The minus sign of the negative feedback causes the force to be opposite to the
direction of the deviation, just like a passive spring opposes a deformation
according to Hooke‚Äôs law. The equivalent radial spring stiÔ¨Äness kr equals:
kr = ‚àíFa
Œ¥r
= ‚àíGt = GmGaGpGc
N/m

.
(3.16)
From this reasoning it can be concluded that a proportional negative-
feedback position controller with a constant gain Gt will create a virtual
spring, acting on the positioned body, which behaves like a mechanical
spring in a passive mass-spring system. The stiÔ¨Äness of this active con-
trolled spring is called the servo-stiÔ¨Äness with a value equal to Gt. In this
case with only proportional gain Gt is equal to the proportional gain factor
kp of the controller as this factor is generally written. Like Gt also kp has as
unit
N/m
, because the feedback controller including ampliÔ¨Åer and actuator
converts a position error into a force.
As will be shown in the following sections, a simple dynamic system with
a body and a spring needs damping to return to a stable position after
excitation by a stimulus, which is equally true for an active system with
only a virtual spring. A virtual damper by diÔ¨Äerentiation will be introduced
for this purpose in Chapter 4 on motion control.

134
Chapter 3. Dynamics of Motion Systems
3.2
Mass-Spring Systems with Damping
The mechanics in positioning systems can be dynamically modelled as a
combination of lumped dynamic elements, bodies, springs and dampers,
because all material has mass, all structures have stiÔ¨Äness and motion
energy will always ultimately be dissipated into heat. These somewhat
trivial statements, however, have large implications as the performance
of any positioning system is dominated by the dynamic behaviour of the
applied mechanical system. Two important aspects are considered in the
following, the dynamic compliance, also sometimes called ‚Äúadmittance‚Äù of
a mechanical system, describing its dynamic response to forces acting on
it by actuators and disturbances and the transmissibility, describing the
response to movements of the supportive structure.
3.2.1
Dynamic Compliance
As working example for the introduction of the concept of dynamic compli-
ance the single mass-spring system with damping of Figure 3.5 is used. It
consists of a lumped body, spring and damper, which each have a diÔ¨Äerent
response to periodic forces. This response is called the dynamic compliance
because it gives a value to the ability of the element to ‚Äúcomply‚Äù, which
means ‚Äúto move along with‚Äù changing force values over time. The dynamic
compliance is noted with the variable C. The preÔ¨Åx ‚Äúdynamic‚Äù is added
because the compliance appears to be frequency dependent for two of the
three elements. In view of the fact that all analyses of mechatronic systems
are dynamic by deÔ¨Ånition, the preÔ¨Åx ‚Äúdynamic‚Äù will not be mentioned when
it is obvious that it is a time- and frequency dependent variable.
The compliance of the three basic elements is summarised as follows:
‚Ä¢ The Ô¨Årst element, the spring, complies with a force by a proportional
displacement. Its compliance is equal to the inverse of its stiÔ¨Äness k.
Cs = 1/k.
‚Ä¢ The second element, the damper, complies with a force by a propor-
tional velocity. Its compliance is proportional to the inverse of its
damping coeÔ¨Écient c. Cd ‚àù1/c.
‚Ä¢ The third element, the body, complies with a force by a proportional
acceleration according to Newton‚Äôs second law. Its compliance is
proportional to the inverse of its mass m. Cm ‚àù1/m.

3.2. Mass-Spring Systems with Damping
135
m
k
Staonary reference
c
x
Fa
Figure 3.5: A lumped-element damped mass-spring system with an external force
stimulus delivered by an actuator. The movement x by the actuator
force Fa is determined by the combined compliance of the body, the
spring and the damper.
In the following sections Ô¨Årst the compliance of each dynamic element is
determined in the time, Laplace and frequency-domain (frequency response).
These expressions are then combined to get the compliance of the total
system.
The graphical representation of the compliance will create a basic feeling
for the physics that determine these dynamics. On this base the equations
of motion are derived in Section 3.2.2, which will show the real response of
these damped mass-spring systems to periodic forces around their natural
frequency.
3.2.1.1
Compliance of a Spring
The compliance of a spring (Cs(t)) can be derived from the force acting on a
spring, resulting in a simple mathematical expression:
Fs(t) = kx
=‚áí
Cs(t) = x
Fs
= 1
k
[m/N].
(3.17)
Note that the sign is positive, as the displacement is in the same direction
as the externally applied force according to the Hooke ‚Äì Newton law.
The compliance of a spring is a constant factor, so it is independent of time
and frequency. This means that an amplitude Bode plot would show a
straight horizontal line with magnitude Cs. This is called the stiÔ¨Äness-line,
or spring-line.
In the phase-plot the stiÔ¨Äness-line shows a phase of 0‚ó¶, because the compli-
ance equation of the spring does not contain any (s) term in case one would
apply the Laplace-transform on this constant.

136
Chapter 3. Dynamics of Motion Systems
3.2.1.2
Compliance of a Damper
Elongation of damper with a certain velocity requires a proportional force.
The mathematical expression for its compliance in the time-domain is de-
rived as follows starting with the force:
Fd(t) = c dx
dt
[N].
(3.18)
The Laplace-transform results in the following relation:
Fd(s) = csx
=‚áí
Fd(œâ) = jcœâx
[N].
(3.19)
Taking only the complex frequency term of s = œÉ+ jœâ, this transformation
results in the following frequency response function for the compliance of
the damper as function of the radial frequency (œâ):
Cd(œâ) = x
Fd
=
1
jcœâ
[m/N].
(3.20)
For the magnitude, the absolute value of the compliance is taken, which
means that the compliance of a damper is inversely proportional to the
frequency. In a magnitude Bode plot this would show up as a straight line
with a down slope of ‚àí1, called the damper-line. This slope also matches the
outcome of the following reasoning. The force of a damper is proportional to
the velocity. With a harmonic movement x = Asinœât the related diÔ¨Äerentia-
tion of the position introduces the additional œâ term in the amplitude. This
means that with an increase of the frequency the velocity increases if the
position amplitude is kept constant. This also means that a proportional
higher force is needed at higher frequencies to move the damper. Special
attention should also be given to the j term in the denominator, which
means to say that the compliance of the damper has an imaginary value
and as a consequence the damper-line in the phase plot shows a phase shift
of ‚àí90‚ó¶.
3.2.1.3
Compliance of a Body
A body reacts on a force according to Newton‚Äôs second law. Its compliance
can be expressed in the following mathematical form in the time-domain:
Fb(t) = m d2x
dt2
[N].
(3.21)
After Laplace-transform this equation equals as follows:
Fb(s) = ms2x
=‚áí
Fb(œâ) = ‚àímœâ2x.
(3.22)

3.2. Mass-Spring Systems with Damping
137
With the positive imaginary terms of s = œÉ + jœâ this gives the following
frequency response function for the compliance of a body as function of the
radial frequency (œâ):
Cb(œâ) = x
Fb
= ‚àí
1
mœâ2
[m/N].
(3.23)
The compliance of a body appears to be proportional to the inverse of the
frequency squared. In the amplitude Bode plot this is represented by a
straight line with a slope of ‚àí2. This line should have been called the Body
line but, like with the naming of the mass-spring system this line is called the
mass-line. Like with the damper this ‚àí2 slope can be veriÔ¨Åed by reasoning
because with a harmonic movement x = Asinœât acceleration introduces a
term œâ2 in the amplitude of the acceleration, due to the double derivative
over time. The minus sign is the result of j2 = ‚àí1 in the denominator, which
means that the phase plot of the mass-line shows a phase shift of ‚àí180‚ó¶.
3.2.1.4
Dynamic StiÔ¨Äness
The compliance values of the damper and body appeared to be variable in
time and frequency for which reason their compliance is really a dynamic
compliance. In that respect the inverse of the (dynamic) compliance of any
element can be seen as the inverse of their resistance to motion. For a
spring the compliance was shown to be equal to the inverse of the frequency
independent spring constant, its stiÔ¨Äness. The inverse of the dynamic
compliance of a body and a damper can be called their dynamic stiÔ¨Äness
and equals:
km(œâ) = Fb
x = ‚àímœâ2
[N/m]
for the body and
(3.24)
kd(œâ) = Fd
x = jcœâ
[N/m]
for the damper.
(3.25)
In Table 3.1 these relations are listed together as a reference.
3.2.1.5
Lumping the Dynamic Elements
In the mass-spring system with damping from Figure 3.5 the applied force
is distributed over the three lumped elements while these share the same
position x referenced to the position x0, where the system is at rest when
F = 0. This is shown schematically in Figure 3.6. At Ô¨Årst sight it is to be
expected that at any frequency the total dynamic compliance Ct = x/F can
never exceed the level of the dynamic compliance of each of the elements.

138
Chapter 3. Dynamics of Motion Systems
Table 3.1: Overview of the dynamic properties of body, spring and damper in the
frequency-domain. The SI units are omitted for reasons of simpliÔ¨Åcation
of the overview.
Item
Spring
Damper
Body
Variable
k
c
m
External force
Fs(œâ) = kx
Fd(œâ) = jcœâx
Fb(œâ) = ‚àímœâ2x
(dynamic)
StiÔ¨Äness
ks(œâ) = Fs
x = k
kd(œâ) = Fd
x (œâ) = jcœâ
km(œâ) = Fb
x (œâ) = ‚àímœâ2
(dynamic)
Compliance
Cs(œâ) = x
Fs
= 1
k
Cd(œâ) = x
Fd
(œâ) =
1
jcœâ
Cm(œâ) = x
Fb
(œâ) = ‚àí
1
mœâ2
Magnitude,
Phase angle
1
k , 0¬∞
1
cœâ , ‚àí90¬∞
1
mœâ2 , ‚àí180¬∞
Although this assumption is not fully correct, as will be shown later, it is a
useful starting point to get an idea of the relations.
With this assumption the following can be stated:
Ft = Fs + Fd + Fb = x

 1
Cs
+ 1
Cd
+ 1
Cb

= x
Ct
[N].
(3.26)
F
jc x


F
m
x



 	


Total force
Body
Spring
Damper
2
( )
b
b
x
C
( )
d
d
x
C
s
s
x
F
kx
C


( )
t
t
x
F
C
 
x
Figure 3.6: In a mass-spring-damper system the force is divided over the three
elements according to the inverse of their compliance while sharing the
same position.

3.2. Mass-Spring Systems with Damping
139
F
m
F
c
F
k
Log |x/F|
Log ¬ê
S`li
Mali (2)
Damprli (1)
S`li
Damprli 


180
	

Mali 
1
s
s
x
C


2
1
b
b
x
C



1
d
d
x
C



Pha 


90
	



0
180
	

0
¬ê0
0
2
0
1
1
 
 
k
k
m
m





Figure 3.7: The response of body, damper and spring, each represented as separate
elements by a straight line in a Bode plot with amplitude and phase. The
red dashed line shows the combined compliance plot. The undamped
natural frequency œâ0 where the response will roll-oÔ¨Äis found at the
intersection of the spring and mass magnitude lines.
Which means that the total compliance equals:
Ct = x
Ft
=
1
1
Cs
+ 1
Cd
+ 1
Cb
[m/N].
(3.27)
This corresponds to the statement that at any frequency the element with
the least compliance determines the total compliance.
To illustrate the individual eÔ¨Äect on the Bode plot of each element, each
response is drawn separately in the amplitude and phase part of a Bode plot
as shown in Figure 3.7. In this plot the frequency is noted in the angular
frequency (œâ), because of the clear relationship with the mathematical
expression for the compliance terms for each element.
The magnitude of the compliance of the combined mass-spring-damper
system can now be derived by taking the lowest value of the individual
elements depending on the frequency region. At low frequencies, the spring
determines the response of the system with the horizontal stiÔ¨Äness-line at
a compliance magnitude-level of 1/k. At high frequencies the behaviour is
fully determined by the body, according to its mass-line with a magnitude
level of 1/mœâ2. The roll-oÔ¨Äfrequency is found at the intersection of these
lines at the undamped natural frequency œâ0. This can be concluded from
the following reasoning.

140
Chapter 3. Dynamics of Motion Systems
a: No damping
Log |x/F|
Log ¬ê
¬ê0
Phase
180
	

0
b: Low damping
180
	

0
Log |x/F|
Log ¬ê
¬ê0
Phase
c: High damping
180
	

0
Log |x/F|
Log ¬ê
¬ê0
Phase
d: Extreme damping; first order system
180
	

0
Log |x/F|
Log ¬ê
¬ê0
Phase
¬ê1
¬ê1
¬ê2
Figure 3.8: The Bode plots of the response of a mass-spring system with diÔ¨Äerent
levels of damping shows the eÔ¨Äect on the resonance at the undamped
natural frequency œâ0. At extreme levels of damping the second-order
system equals a combination of two Ô¨Årst-order systems.
At intersection both magnitudes are equal, so:
1
k =
1
mœâ2
=‚áí
œâ2 = k
m
=‚áí
œâ =

k
m = œâ0
[rad/s].
(3.28)
In the roll-oÔ¨Äfrequency range the damper determines the behaviour of the
system. Depending on the level of the magnitude (1/cœâ) of its corresponding
damper-line, the phase shows a gradual combination of the phase shift of
the diÔ¨Äerent elements.
To get an initial idea about the eÔ¨Äects of diÔ¨Äerent levels of damping four
examples are shown in Figure 3.8. Bode plot 3.8.a shows the response
of mass-spring system without damping. This is the situation where the
assumption on the upper limitation of the compliance is no longer true. At
the undamped natural frequency œâ0 the amplitude of the system increases
by absorbing energy and loading it in alternating potential energy (spring) or
kinetic energy (mass), resulting in an inÔ¨Ånite compliance. At this frequency
the phase jumps from 0¬∞to ‚àí180¬∞without gradual transition. In the next
section this eÔ¨Äect will be better explained with the equations of motion.

3.2. Mass-Spring Systems with Damping
141
As soon as a small damper is added, as shown in Bode plot 3.8.b, the peak
in the compliance at œâ0 is suppressed by the damper, which extracts energy
from the dynamic system. The original inÔ¨Ånite response is now only lowered
to a Ô¨Ånite value, because the damping is still moderate. When a damper
with a higher damping coeÔ¨Écient is applied, as shown in Bode plot 3.8.c,
the damping-line shifts further down in the amplitude plot. If the damping
is high enough, such that the damping-line is below the intersection of
the spring- and mass-line, the amplitude at the resonance frequency is
determined purely by the damping and the resonance peak will not occur.
This situation corresponds to a series of two Ô¨Årst-order low-pass systems,
the Ô¨Årst starting at a roll-oÔ¨Äfrequency œâ1 < œâ0 and the second starting
at a roll-oÔ¨Äfrequency œâ2 > œâ0. If the damping is even further increased,
the mass-spring system is ‚Äúover-‚Äùdamped as shown in Bode plot 3.8.d. The
damper-line in the amplitude plot shifts almost completely below the mass-
line. In this situation the dynamic response can be approximated by a
Ô¨Årst-order system with a roll-oÔ¨Äfrequency of œâ1. Above this frequency the
damper dominates the system behaviour over the mass while œâ2 becomes a
very high frequency where the magnitude of the response is negligible.
3.2.2
Transfer Function of Compliance
In this section on dynamics the modelled frequency response of a Linear
Time-Invariant (LTI) damped mass-spring system will often be described in
the form of a frequency dependent transfer function (TF) with the Laplace
operator s = œÉ+ jœâ as variable.
As explained in Chapter 2 transfer functions from the Laplace-domain are
used to determine the frequency response function (FRF) of the dynamic
system by using only the positive imaginary terms of the Laplace operator
œÉ = jœâ. The transfer functions in the Laplace-domain are derived from
the linear equations of motion describing the reaction of a body to a force
in position, velocity and acceleration. In the following section Ô¨Årst the
compliance behaviour will be derived, as was schematically presented in the
previous section. Although the angular frequency œâ [rad/s] is used in the
mathematics of the frequency response functions, the temporal frequency
f [Hz] will be shown in the graphical representations, because of its clear
relation with the engineering Ô¨Åeld of use.
For a mechatronic designer it is important to recognise and be able to work
with this ‚Äúdual‚Äù expression in the frequency-domain with a 2œÄ diÔ¨Äerence.

142
Chapter 3. Dynamics of Motion Systems
3.2.2.1
Damped Mass-Spring System.
To mathematically model the compliance of a generic mass-spring system
with a damper, the same basic conÔ¨Åguration is used with a lumped body,
spring and damper as shown in Figure 3.9 in a free-body diagram to show
the forces acting on the body. The system compliance equals the movement
(x) of the body relative to the position x0, where the system is at rest, in
response to a force Fa, exerted by an actuator between the body and the
stationary reference. The body is guided with freedom to move in only one
direction by a linear guiding system, represented by the rollers. In the
x direction, where the force is acting, the spring with stiÔ¨Äness k and the
damper with damping coeÔ¨Écient c inÔ¨Çuence the motion of the body with
mass m by their respective compliances as described before.
The mathematical analysis begins by taking the balance of forces acting on
the body to derive the equation of motion in the time-domain. The actuator
force Fa is exerted in the positive x-direction. A movement of the body in
the positive x-direction will stretch the spring causing a pulling force on the
body directed in the negative x-direction. The same is true for a velocity
in the positive x-direction, also causing a force in the negative x-direction
by the damper. Finally the acceleration, which itself is caused by the sum
of these external forces according to Newton‚Äôs second law, will react with
a force opposite to the direction of the acceleration according to Newton‚Äôs
third law. This all is written as follows in the time-domain:
Fa(t)+ Fb(t)+ Fd(t)+ Fs(t) = Fa ‚àím d2x
dt2 ‚àíc dx
dt ‚àíkx = 0.
(3.29)
This can also be written as the force balance between the external force and
the resulting reaction forces:
m d2x
dt2 + c dx
dt + kx = Fa(t).
(3.30)
Using the Laplace-transform this diÔ¨Äerential equation can be written in
the Laplace-domain as:

ms2x+ csx+ kx

= x

ms2 + cs+ k

= Fa(s).
(3.31)
From this equation the following transfer function for the total compliance
Ct(s) can be derived:
Ct(s) = x
Fa
=
1
ms2 + cs+ k
(3.32)
=
1
k
m
k s2 + cs
k +1
[m/N].
(3.33)

3.2. Mass-Spring Systems with Damping
143
k
Staonary reference
c
x
2
m
2
d
d
F
x
m t

Fd
Fs
Fa
Figure 3.9: Free-body diagram of a lumped-element damped mass-spring system
with an external force stimulus. The total force acting on the body is
the summation of the external force working in the positive x-direction
and the forces by the spring, damper and mass of the body, all acting in
the negative x-direction.
To qualify this expression, three entities are used, the spring compliance
Cs, the undamped natural frequency œâ0 and the damping ratio Œ∂.
Of these three the damping ratio is a new term. It is a dimensionless number
as it gives the ratio between the actual damping coeÔ¨Écient c with unit
kg/s

and the critical damping coeÔ¨Écient c0 deÔ¨Åned by the level of damping at
which the step response will just not show overshoot, as will be shown in
Figure 3.15 in the next section.
This is the situation when this second-order mass-spring system just be-
haves like a combination of two equal Ô¨Årst-order systems.
It will be shown later that this critical damping coeÔ¨Écient c0 equals 2

km kg/s.
To summarise the derived variables:
œâ0 =

k
m
[rad/s],
Œ∂ =
c
2

km
=
c
2mœâ0
,
Cs = 1
k
[m/N].
(3.34)
Using these terms in Equation (3.33) gives the following transfer function:
Ct(s) = x
Fa
=
Cs
s2
œâ2
0
+2Œ∂ s
œâ0
+1
[m/N].
(3.35)

144
Chapter 3. Dynamics of Motion Systems
3.2.2.2
Magnitude
To determine the magnitude of the signal, the Laplace operator s is substi-
tuted by only its positive imaginary term jœâ to give the frequency response
as function of the radial frequency (œâ):
Ct(œâ) = x
Fa
=
Cs
j2œâ2
œâ2
0
+ j2Œ∂ œâ
œâ0
+1
=
Cs
1‚àíœâ2
œâ2
0
( )* +
Real
+ j2Œ∂ œâ
œâ0
( )* +
Imaginary
[m/N].
(3.36)
The magnitude is the absolute value of the vector, being the square root of
the sum of the squared vales of the real part and the imaginary part, as
shown in the Nyquist plot of Figure 3.10. This means that the magnitude is
determined by the following equation:
|Ct|(œâ) =
''''
x
Fa
'''' =
Cs




,
1‚àíœâ2
œâ2
0
-2
+

2Œ∂ œâ
œâ0
2
[m/N].
(3.37)
The Ô¨Årst conclusion that can be drawn is that without damping (Œ∂ = 0) the
response becomes inÔ¨Ånite at œâ = œâ0. This is the reason that the undamped
natural frequency f0 = œâ0/2œÄ is also called undamped resonance frequency
of the mass-spring system as the system ‚Äúresonates‚Äù when the periodic
frequency of the stimulus force equals f0. In presence of damping the
maximum response value at f0 relative to Cs has been deÔ¨Åned as the quality
factor Q:
Q =
|Ct|f0
Cs
= 1
2Œ∂.
(3.38)
This factor Q is related to the ability of a resonator to sustain its vibration
over an extended duration of time.
3.2.2.3
Phase
At Page 114 of Chapter 2 it was shown that a time derivative, which in
the Laplace-domain is equivalent to an additional s term in the numerator
of the transfer function, will cause a phase shift of +90‚ó¶in the frequency
response, while an integration over time introduces a phase shift of ‚àí90‚ó¶
in the frequency response. In line with this Ô¨Ånding any polynomial in s
in the numerator of a transfer function will cause a positive phase shift

3.2. Mass-Spring Systems with Damping
145
t
x
C
F

Real axis
Imaginary axis
O
Phase angle  (  )
Figure 3.10: Polar (Nyquist) representation of the response of a damped mass-
spring system at one frequency. According to trigonometry the magni-
tude equals the square root of the summed squared values of the real
and imaginary parts. The phase angle equals the arctangent of the
ratio between imaginary and real part.
(phase lead) in the frequency response, while in the denominator this same
polynomial would cause an equal but negative phase shift (phase lag). In
combination, the total phase shift of a frequency response equals the phase
shift of the numerator minus the phase shift of the denominator.
The numerator and denominator generally consist of both real and imaginary
terms and in that case the phase angle œï of both numerator and denominator
is determined by the arctangent of the ratio of their respective imaginary
and real terms:
Phase = œï = arctan

Imaginary
Real

‚ó¶
.
(3.39)
For phase angles larger than ‚àí90‚ó¶where the real term becomes negative
the phase equals 180¬∞plus the calculated (negative!) arctangent value. A
negative value for both terms results in a total phase angle of 180¬∞plus the
above calculated (positive!) arctangent value while a positive value for the
real term and negative value for the imaginary term gives a phase angle of
360¬∞plus the calculated (negative!) arctangent value.
For this example of a damped mass-spring system the numerator of Equa-
tion (3.35) is constant without imaginary part. As a consequence the phase
angle of the numerator is zero and the phase angle is only determined by the
denominator with a negative sign added to the calculation of Equation (3.39).
This all is summarised in the following calculation of the phase angle, which
results in negative values for the phase angle in two quadrants (0 ‚Äì ‚àí180‚ó¶),
because the imaginary term is always positive and only the real term has
two signs, positive at a frequency below œâ0 and negative at a frequency

146
Chapter 3. Dynamics of Motion Systems
above œâ0:
œïtot = œïnum‚àíœïden = arctan

 0
Ct

‚àíarctan
‚éõ
‚éú‚éú‚éú‚éú‚éù
2Œ∂ œâ
œâ0
1‚àíœâ2
œâ2
0
‚éû
‚éü‚éü‚éü‚éü‚é†
= ‚àíarctan
‚éõ
‚éú‚éú‚éú‚éú‚éù
2Œ∂ œâ
œâ0
1‚àíœâ2
œâ2
0
‚éû
‚éü‚éü‚éü‚éü‚é†
‚ó¶
.
(3.40)
At œâ = 0 the angle is zero while at œâ = œâ0 the phase is -90¬∞ . At higher
frequencies the phase will be more negative and will reach -180¬∞at œâ = ‚àû.
3.2.2.4
Bode Plot
To show the amplitude and the phase of this transfer graphically, an example
damped mass-spring system is deÔ¨Åned, which will be used throughout most
of this section. The spring has a spring constant k = 1¬∑104 N/m and the body
has a mass m = 0.025 kg, giving an undamped natural frequency of:
f0 = 1
2œÄ

k
m = 1
2œÄ

1¬∑104
0.025 = 100
[Hz].
(3.41)
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
Compliance [m/N]
¬ä{{{¬Å¬í¬ä,{{
¬ä{{¬Å¬í¬ä,{
¬ä{¬Ç¬Å¬í¬ä¬Ç
¬ä{¬Å¬í¬ä,
¬ä,¬í¬ä{¬Å
¬ä¬Ç¬í¬ä{¬Ç¬Å
10
1
10
¬Ç
10
[
z,¬Ü{
z¬Ö{
0
Phase [deg]
Frequency [Hz]
f0
Figure 3.11: Bode plot of the compliance of a damped mass-spring system with
k = 1¬∑104 N/m and m = 0.025 kg, giving an undamped natural frequency
f0 of 100 Hz, at diÔ¨Äerent values for Œ∂ and Q.

3.2. Mass-Spring Systems with Damping
147
With suitable mathematical modelling software2, Equation (3.35) gives
the Bode plot of Figure 3.11. Clearly the same shape of the plot is shown
as derived by the graphical method of the previous section. Below f0 the
graph starts with the horizontal stiÔ¨Äness-line, corresponding to a value of
Cs = 1/k = 1¬∑10‚àí4 [m/N]. Above f0 the graph follows the mass-line 1/

m(2œÄf )2
with a slope of ‚àí2. The compliance is calculated for diÔ¨Äerent levels of
damping. The maximum value of the peak at Œ∂ = 0.25 is not at f0, but at a
lower frequency, which will be explained in the following section. It is also
shown that Equation (3.38) is correct. For instance the resonance peak for
Œ∂ = 0.005 has a magnitude of a factor hundred above the magnitude of the
stiÔ¨Äness-line, corresponding to Q = 100
3.2.3
EÔ¨Äects of Damping
The amount of damping in a mass-spring system has large eÔ¨Äects on its
dynamic behaviour. The prime eÔ¨Äect was already shown in the previous
section where damping determined the maximum value of the frequency
response around the resonance frequency. Based on the derived equations
this section will Ô¨Årst present the damped resonance frequency, which is
the observation that with damping the maximum response to an external
force, called forced response, occurs at a lower frequency than œâ0. It will be
shown that at a certain level of the damping ratio (Œ∂ = 0.5

2) no longer a
resonance will occur when driving the system with an external force and
for that reason this damping level is called aperiodic damping.
The second eÔ¨Äect that will be described is the dynamic behaviour of the
system when it is freely oscillating after an impulse or step stimulus, called
free response. It will be shown that this oscillating frequency with damping
is also lower than œâ0 but not as low as the above deÔ¨Åned damped resonance
frequency that occurs with a continuous stimulus. While the word reso-
nance refers to ‚Äúforced at a stimulus frequency‚Äù, free response oscillation is
more related to the word ‚Äúnatural‚Äù for which reason the free oscillation fre-
quency with damping is called damped natural frequency. The free response
behaviour is strongly related to the poles of the transfer function, which
will be treated also in more depth. This will lead to the Ô¨Ånding that the
second-order system will reduce to a series of two simple Ô¨Årst-order systems
at a damping level of Œ∂ = 1, conÔ¨Årming the observations from Figure 3.8.
This damping level is called critical damping because the stepresponse does
2Several software programs are available for this purpose. Most Ô¨Ågures in this book are
created with MATLAB.

148
Chapter 3. Dynamics of Motion Systems
not show overshoot anymore at this level.
The last important eÔ¨Äect of damping is related to energy. At resonance the
mass-spring system will collect energy, because the periodic force is mainly
in phase with the periodic velocity. On the other hand damping dissipates
this energy again and it is the energy balance between the inserted power
and the dissipated power that determines the maximum value of the trans-
fer function at resonance. The previously deÔ¨Åned quality Factor Q for this
maximum value is therefore also related to this energy balance.
3.2.3.1
Damped Resonance and Aperiodic Damping
At low values of Œ∂ the maximum value of the forced response is approximately
equal to the magnitude at œâ0, which was found with Equation (3.38):
|Ct|max
Cs
‚âà
|Ct|œâ0
Cs
‚âà1
2Œ∂.
(3.42)
At higher levels of Œ∂ the maximum will not occur at œâ0 but at a lower fre-
quency, the ‚Äúdamped resonance frequency‚Äù œâd,r, which can be determined
by Ô¨Ånding the minimum value of the denominator of Equation (3.37). This
is done by taking the derivative of the denominator over œâ, which should
be equal to zero for œâd,r at this minimum. With the found value of œâd,r the
magnitude can then be calculated.
The part below the square root in the denominator (= den2) is Ô¨Årst expanded:
den2 =
,
1‚àíœâ2
œâ2
0
-2
+

2Œ∂ œâ
œâ0
2
= 1+

4Œ∂2 ‚àí2
 œâ2
œâ2
0
+ œâ4
œâ4
0
.
(3.43)
The derivative over œâ equals zero at the minimum:
d

den2
dœâ
= 2

4Œ∂2 ‚àí2

œâ2
0
œâd,r + 4
œâ4
0
œâ3
d,r = 0.
(3.44)
This equation has two solutions. The Ô¨Årst solution corresponds to a maxi-
mum response at œâd,r = 0, which is equal to Cs and this is the only maximum
for higher values of Œ∂. For low values of Œ∂ the second solution gives a maxi-
mum response at a frequency œâd,r between zero and œâ0, depending on the
level of damping:
4
œâ4
0
œâ2
d,r = 4‚àí8Œ∂2
œâ2
0
=‚áíœâ2
d,r = œâ2
0

1‚àí2Œ∂2
=‚áíœâd,r = œâ0

1‚àí2Œ∂2
. (3.45)

3.2. Mass-Spring Systems with Damping
149
1
2

$¬ìC ]
 
0
20
40
60
80
100
120
140
160
180
200
Frequency  [Hz]
= 0.7
= 0.25
= 0.3
= 0.35
= 0.4
= 0.45
= 0.5
= 0.55
= 0.6
= 0.65
= 0.2











s
d,r
d,r
2
f



Figure 3.12: An increasing amount of damping will decrease the frequency where
the maximum magnitude of the frequency response occurs. This is
best viewed on a linear scale.
Together with Equation (3.37) this equation will give the following maximum
value of the frequency response at œâ = œâd,r:
|Ct|max
Cs
=
1

1‚àí1+2Œ∂22 +4Œ∂2 
1‚àí2Œ∂2 =
1
2Œ∂
4
1‚àíŒ∂2 .
(3.46)
At a value of Œ∂ = 0.5 the maximum response equals 1.15 times the stiÔ¨Äness-
line compliance so there is still a very small amount of resonance present
but at a damping ratio of Œ∂ ‚â•0.5

2 the maximum response is equal to the
stiÔ¨Äness-line compliance due to the Ô¨Årst solution œâd,r = 0 with a magnitude
of one. This means that at Œ∂ ‚â•0.5

2 no resonance occurs anymore as shown
in Figure 3.12.
With the previous reasoning it can also be conÔ¨Årmed that with levels of Œ∂
below 0.5 the peak level of the frequency response can be approximated as
mentioned in Equation (3.42).
3.2.3.2
Poles and Critical Damping
The deÔ¨Ånition of Œ∂ is based on the analysis of the poles of the compliance
transfer function. As presented in Chapter 2, poles are those values of
s that result in a zero value of the denominator of the transfer function,
corresponding to an inÔ¨Ånite value of the transfer function itself. This is the
most easily understood at the situation of an undamped mass-spring system,
using Equation (3.32) with c = 0, where at s = ¬±jk/m = ¬±jœâ0 the magnitude of
the compliance becomes inÔ¨Ånite. The poles of a second-order system appear
as complex conjugate terms and in the undamped situation the poles are

150
Chapter 3. Dynamics of Motion Systems
Figure 3.13: The three dimensional view of the compliance transfer function of
the damped mass-spring system of Figure 3.11 shows clearly the lo-
cation of the poles where the function goes to inÔ¨Ånity. The frequency
response of the total compliance is equal to the intersection of this
plot with the plane deÔ¨Åned by the positive imaginary (œâ) axis and
the normal through the origin of the Laplace plane. Note that in this
representation only the vertical axis is logarithmic and the imaginary
scale is œâ instead of f .
purely located on the imaginary axis, symmetrical around the real axis.
The situation for a damped situation is shown graphically in three dimen-
sions in Figure 3.13 for the full complex Laplace plane as deÔ¨Åned in Chap-
ter 2. It clearly indicates that the poles are always present, even though the
frequency response does not go to inÔ¨Ånity at any frequency. This means that
the full Laplace operator s = œÉ+ jœâ must be used to examine the poles, so
including the real part œÉ, to determine the pole location. The denominator
(dc(s)) of the compliance transfer function is a second-order diÔ¨Äerential equa-
tion with variable s. To determine the poles this equation can be written in
a more generalised form as a multiplication of two terms:
dc(s) = (s‚àíp1)(s‚àíp2).
(3.47)
where p1 and p2 are the two poles. Generally these poles are complex
numbers and come as two conjugate complex terms, written as:
p1 = ‚àíœÉ+ jœâd,n and
p2 = ‚àíœÉ‚àíjœâd,n.
(3.48)

3.2. Mass-Spring Systems with Damping
151
where œÉ is the real part of the pole and the imaginary part contains œâd,n,
the damped natural frequency, the frequency at which the system would
like to freely oscillate after a one time step or impulse stimulus when no
external forces are further exerted on the system. When these expressions
are combined in the generalised description of the denominator, it becomes:
dc(s) = (s+œÉ‚àíjœâd,n)(s+œÉ+ jœâd,n) = (s+œÉ)2 +œâ2
d,n.
(3.49)
As a next step, equation (3.33) is written in a diÔ¨Äerent form, in order to come
to a denominator notation, which can be compared with this pole notation.
Ct(s) = x
Fa
=
1
k
m
k s2 + cs
k +1
[m/N].
(3.50)
Introducing the undamped natural frequency œâ0 =
4
k/m and the spring
compliance Cs results in:
Ct(s) = x
Fa
=
Cs
s2
œâ2
0
+ cs
k +1
[m/N].
(3.51)
Multiplication of both the numerator and the denominator of the equation
with œâ2
0 gives:
Ct(s) = x
Fa
=
Csœâ2
0
s2 +
csœâ2
0
k
+œâ2
0
M/N

.
(3.52)
For the pole locations only the denominator part is relevant:
dc(s) = s2 +
csœâ2
0
k
+œâ2
0.
(3.53)
To determine the pole values, the mid term is changed by replacing one factor
œâ0 by
4
k/m and using the deÔ¨Åned value for the damping ratio, Œ∂ =
c
2

km
:
dc(s) = s2 +
cs
5
k
mœâ0
k
+œâ2
0 = s2 + csœâ0

km
+œâ2
0 = s2 +2Œ∂œâ0s+œâ2
0.
(3.54)
When the middle and the last term of this equation are compared with the
corresponding terms in the expanded version of equation (3.49):
dc(s) = (s+œÉ)2 +œâ2
d,n = s2 +2œÉs+œÉ2 +œâ2
d,n.
(3.55)

152
Chapter 3. Dynamics of Motion Systems
Re
Im
= 1
< 1
< 1
> 1
> 1
Figure 3.14: Pole locations of a damped mass-spring system in the complex plane.
Depending on the damping ratio the poles are either real numbers,
which represent an overly damped system consisting of two Ô¨Årst-order
systems, or complex conjugate numbers with less damping. The mag-
nitude of the real part relative to the imaginary part determines the
amount of damping in the system.
then the following equations are obtained, relating the real and imaginary
value of the pole to œâ0 :
œÉ = Œ∂œâ0
and
œâ2
0 = œÉ2 +œâ2
d,n.
(3.56)
The second relation of this equation is a circle equation, which can be written
as follows to obtain the imaginary term œâd,n of the pole:
œâd,n =

œâ2
0 ‚àíœÉ2 = œâ0



1‚àíœÉ2
œâ2
0
.
(3.57)
With Equation (3.56) for the relation of œÉ and the deÔ¨Ånition of Œ∂ this results
in:
œâd,n = œâ0

1‚àí
c2
4km = œâ0

1‚àíŒ∂2.
(3.58)
In the situation where Œ∂ becomes equal to one, the poles become two equal
real negative poles. The value of c where this situation occurs (c = 2

km)
is called the critical damping coeÔ¨Écient with Œ∂ = 1 as the related critical
damping ratio. Figure 3.14 shows graphically the eÔ¨Äect of the damping on
the pole locations in the complex plane for a damped mass-spring system,
corresponding to the circle relation of the pole terms in Equation (3.56). The
fact that damping corresponds to a dominant negative real term will be used

3.2. Mass-Spring Systems with Damping
153
0
0.005
0.01
0.015
0.02
0.025
0.03
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6 x 10
z)
Time [s]
Displacement  [m]
 = 0.2
 = 0.4
 = 0.6
 = 0.8
 = 1
 = 1.2
Figure 3.15: Position response of a mass-spring system in the time-domain with
k = 1¬∑104 N/m and m = 0.025 kg to a step force of 1 N with diÔ¨Äerent
levels of damping.
also in Chapter 4 on motion control where it is shown that a stable system
requires the poles to be located in the left half of the complex plane. With
the presentation of state-space feedback control in that chapter it will also
be shown that these poles correspond to the eigenvalues of an eigendynamics
matrix A, which contains the terms of the transfer function in a vector-
matrix notation. From the above equations it follows that increasing the
damping will shift the damped natural frequency œâd,n below the undamped
natural frequency œâ0, until the damped natural frequency becomes equal to
zero at Œ∂ = 1. This is diÔ¨Äerent from the damped resonance frequency œâd,r,
which becomes aperiodic at Œ∂ = 0.5

2, because of the phase between the
stimulus and velocity at resonance, which does not play a role with free
oscillations. This property is explained further in Section 3.2.3.3. As a direct
consequence of the two Ô¨Årst-order systems at Œ∂ ‚â•1 there is no overshoot at a
step response, as can be seen in Figure 3.15.
From Second-Order to Two First-Order Systems
The situation with two real poles at Œ∂ ‚â•1 implies that the second-order
transfer function of the dynamic system is reduced to a combination of two
Ô¨Årst-order systems. This can be seen by taking Equation 3.47 as denominator
in a transfer function:
TF(s) = Num
dc(s) =
Num
(s‚àíp1)(s‚àíp2) =
Num
p1p2

 s
p1
‚àí1

 s
p2
‚àí1
.
(3.59)

154
Chapter 3. Dynamics of Motion Systems
 
 
 
 
 
Figure 3.16: The response of a Ô¨Årst-order system in a three dimensional view of the
Laplace plane shows a typical single-pole low-pass Ô¨Ålter characteristic
in the frequency response. The two combined Ô¨Årst-order systems,
which correspond to the two real poles of the damped mass-spring
system of Figure 3.11 with Œ∂ > 1, show a similar frequency response.
By deÔ¨Åning the positive time constants œÑ1 = ‚àí1/p1 and œÑ2 = ‚àí1/p2, changing
the numerator into Num‚Ä≤ = Num/p1p2 and taking only the positive imaginary
terms of s = œÉ+ jœâ, the transfer- and frequency response functions are written
as follows:
TF(s) =
Num
p1p2(œÑ1s+1)(œÑ2s+1) =
Num‚Ä≤
(œÑ1s+1)(œÑ2s+1)
and
(3.60)
FRF(œâ) =
Num‚Ä≤
(jœâœÑ1 +1)(jœâœÑ2 +1).
(3.61)
The two denominator terms jœâœÑn +1, with n = 1,2, are well known from con-
trol and Ô¨Ålter theory as a Ô¨Årst-order low-pass Ô¨Ålter responses with a corner
frequency of œân = 1/œÑn, equal to the real values œÉn of each of the poles. This
is true because the œâœÑ-term becomes larger than one above this frequency,
thereby increasing the value of the denominator and decreasing the value
of FRF(œâ) with increasing frequency. When Œ∂ = 1 both time constants of the
Ô¨Årst-order responses are equal. When the damping is increased beyond that
level, the roll-oÔ¨Äfrequencies of the two Ô¨Årst-order systems become separated
as was shown in Figure 3.8. The lower roll-oÔ¨Äfrequency corresponds to
the pole that shifts towards the origin on the real axis of the complex plane
(œâc = œÉ) and the higher roll-oÔ¨Äfrequency corresponds to the pole that shifts
away from the origin. Figure 3.16 illustrates this in a three dimensional
view of the full Laplace plane.

3.2. Mass-Spring Systems with Damping
155
3.2.3.3
Quality-Factor Q and Energy in Resonance
In electrical engineering the quality-factor Q is frequently used as a mea-
sure for resonance, determined by the maximum value of the peak in the
resonant system, relative to the crossing point of the low-frequency and high
frequency asymptotes in the frequency response plot. These asymptotes are
equivalent to the spring- and mass-line in a mechanical system. Electrical
engineering is a typical frequency-domain oriented discipline and also the
factor Q belongs to that domain, because of the emphasis on the behaviour at
resonance with low levels of damping. Resonance is often positively valued
in electronics for tuning selective bandpass Ô¨Ålters, stabilising clocks and
other useful functions. For this reason Q = 1 is deÔ¨Åned as the minimum level
where just no resonance occurs anymore. In mechanical engineering, with
its typical time-domain orientation, the damping ratio Œ∂ is more common
to use, because of its time response relation and also because resonance is
often seen as a negative eÔ¨Äect. When possible, a well behaved step response
is aimed for, which is the case at Œ∂ = 1 as was demonstrated in the previous
section. In fact both terms can be used together depending on the situation.
In case of a resonator, a high Q value is preferred, while a controlled, well
damped mechanical system demands for a high Œ∂. Fortunately it was shown
on Page 144 that there is a very simple and straightforward relation between
Q and Œ∂:
Q =

km
c
= 1
2Œ∂.
(3.62)
The direct relation of Q with the resonance peak in the Bode plot was shown
in Figure 3.11. In the example of a damped mass-spring system with spring
constant k of 1¬∑104 N/m and a body with a mass m of 0.025 kg, this means
that an excitation force amplitude of 1 N will result in a 0.1 mm motion
amplitude at the stiÔ¨Äness-line, a 1 mm peak amplitude at œâ0, when Q = 10,
and a 10 mm peak amplitude at œâ0, when Q = 100.
Energy Storage
The relation of Q and Œ∂ with the energy in the system is essential for the
time variable ‚Äúdynamic‚Äù nature of a mechatronic system where at resonance
the energy from the actuator is stored periodically in kinetic energy (mass)
and potential energy (spring). When the supply of energy is interrupted,
the resonance will gradually decrease, because a part of the energy is lost in
every cycle due to unavoidable damping eÔ¨Äects in the material like hysteresis,

156
Chapter 3. Dynamics of Motion Systems
air friction, and so on. The mechanism causing this gradual loss of energy
is based on the fact that the damping force and velocity are in phase and
opposite to each other. This means that power is dissipated by the damper
at a rate, equal to the scalar multiplication of force times the velocity:
P(t) = Fd
dx
dt = ‚àíc dx
dt
dx
dt = ‚àíc

 dx
dt
2
= ‚àícv2
[W].
(3.63)
This energy is dissipated into heat.
The exact relation of Q with energy is determined by looking at the ratio
between the stored energy and the dissipated or lost energy per cycle in a
mass-spring system that is freely moving with a damped decaying oscillation
after an impulse or step stimulus. At the damped natural frequency œâd,n
the stored energy Es is equal to the maximum (peak) kinetic energy Ek,p of
the body at its maximum speed vp, when the spring is just unloaded at the
middle position of the oscillation:
Es = Ek,p = 1
2 mv2
p
[J].
(3.64)
The lost energy per cycle E‚Ñìat the damped natural frequency œâd,n is calcu-
lated by using Equation (3.63) with the sinusoidal velocity v = vm sinœâd,nt
and integrating the power over a time equal to the period T, which results
in the following:
E‚Ñì(t) = c
T

0
v2
p sin2 œâd,ntdt = 1
2 cv2
pT = 1
2 cv2
p
2œÄ
œâd,n
[J].
(3.65)
With low levels of damping œâd,n ‚âàœâ0 =
4
k/m and using above equations the
energy ratio (Re) equals:
Re = Es
E‚Ñì
=
1
2 mv2
p
1
2 cv2p
2œÄ
œâd,n
= mœâd,n
2œÄc
‚âà

km
2œÄc .
(3.66)
The following conclusion is valid because Q = 1/2Œ∂ =

km/c:
Q = 2œÄRe = 2œÄ
Energy Stored
Energy Lost per cycle,
(3.67)
where the ‚ÄúEnergy Stored‚Äù equals the energy that is present in the system at
the beginning of the cycle concerned and this value decreases continuously
as a consequence of the dissipated energy in the damping per cycle in the
free moving situation.

3.2. Mass-Spring Systems with Damping
157
0 t
2Q
e

	
Figure 3.17: The damped free response of a mass-spring system.
This gradually reduction of the lost energy per cycle indicates an exponen-
tial function and indeed the envelope of the amplitude over time of a free
oscillating system is described by the following equation:
A(t) = A0e‚àíŒ∂œâ0t = A0e‚àí
œâ0
2Q t.
(3.68)
which is illustrated in Figure 3.17.
Behaviour around the Natural Frequency
As a thought experiment, at t = 0, a mass-spring system without damping is
excited at its undamped natural frequency by means of a sinusoidal force
with a constant amplitude. As of t = 0 a continuous increase of the move-
ment amplitude will be observed, depending on the amplitude of the force
in relation to the mass of the body. This eÔ¨Äect is fully comparable with a
proportional linear acceleration of a body in response to a constant force.
It was mentioned before that the energy is continuously exchanged between
potential energy in the spring and kinetic energy in the body at the un-
damped natural frequency of a mass-spring system. The captured amount
of energy in the system is growing constantly, because of the ongoing excita-
tion, until ultimately an inÔ¨Ånite amplitude of motion is obtained.
In practice the excitation frequency is hardly ever completely constant. Fur-
ther always some damping is present due to hysteresis and friction. Finally
springs with an inÔ¨Ånite linear strain do not exist either. This all means that
this inÔ¨Ånite gain will never occur in reality. In this respect it is important
to iterate the following statement from Chapter 2:
A Bode plot is a stationary representation, based on the presence
of a continuous stimulus at all frequencies.

158
Chapter 3. Dynamics of Motion Systems
10
z[
10
z¬Ç
10
z,
10
0
10
1
Velocity response [m/Ns]
 = 0.005  Q = 100
 = 0.05    Q = 10
¬ä{¬Ç¬Å¬í¬ä¬Ç
 = 0.5      Q = 1
 = 1         Q = 0.5
¬ä¬Ç¬í¬ä{¬Ç¬Å
10
1
10
¬Ç
10
[
z¬Ö{
0
Phase [deg]
Frequency [Hz]
Figure 3.18: Bode plot of the response of the velocity of a damped mass-spring
system with k = 1¬∑104 and m = 0.025 kg to a force with diÔ¨Äerent values
for Œ∂ and Q. It clearly shows that the force is in phase with the velocity
at the undamped natural frequency, achieving the maximum eÔ¨Éciency
in energy transfer.
This means that the resonating system needs time to collect energy, similar
but opposite to the decay eÔ¨Äect as shown in Figure 3.17. When the excitation
time is too short the resonance might not be observed and wrong conclusions
on the system dynamics will be made.
This relation with energy is also clear, when observing the phase behaviour.
At the undamped natural frequency the phase between force and position is
‚àí90‚ó¶, while also the velocity has a ‚àí90¬∞phase diÔ¨Äerence with the position in
case of sinusoidal movements. This means that the force is in phase with the
velocity at the undamped natural frequency œâ0, thus acting in the direction
of the movement and maximising the work. This leads to the conclusion
that in a vibrating system the maximum eÔ¨Éciency in energy transfer from
the force of an actuator to a physical movement is realised at the undamped
natural frequency.
It also explains the diÔ¨Äerence between the damped natural frequency œâd,n
and the damped resonance frequency œâd,r as in the latter case the energy
transfer eÔ¨Éciency is lower than it would be at œâ0 and as a consequence the
magnitude of the response is lower due to the phase diÔ¨Äerence of the force

3.2. Mass-Spring Systems with Damping
159
75                                       
100                                      125
10
0
10
1
10
2
10
3
10
4
&$|$¬á
 
 
^¬å[Hz]
Q = 100
Q = 10
Q = 1
75
100
125
1000
2000
3000
4000
5000
6000
7000
8000
9000
10000
&$|¬á
^¬å [Hz]
Figure 3.19: Relative energy level as function of frequency at various levels of Q
in a small band around the undamped natural frequency of 100 Hz.
The narrow peak at high levels of Q is especially prominent, when the
phenomenon is presented on a linear scale.
with the velocity. A free vibrating object resonates on the internal energy
that it obtained at an earlier excitation so it can only resonate at the damped
natural frequency œâd,n.
In Figure 3.18 the transfer eÔ¨Éciency dependency on the frequency is shown
in the Bode plot of the velocity response of the example mass-spring system
with spring constant k of 1¬∑104 N/m and a body with a mass m of 0.025 kg to
an external force. This velocity response is found simply by diÔ¨Äerentiation
over time of the time-domain equation of motion related to the position. In
the Laplace-domain this diÔ¨Äerentiation is equal to the multiplication of the
system compliance Ct(s) with s:
v
Fa
(s) = sx(s)
Fa
= sCt(s) =
sCs
s2
œâ2
0
+2Œ∂ s
œâ0
+1
[m/Ns].
(3.69)
The peak level at for instance Q = 100 can be checked by taking the earlier
found motion amplitude of 10 mm and multiply that value with œâ to get
the maximum velocity. At 100 Hz = 628 rad/s this results in a maximum
velocity of 6.28m/s, which corresponds to the level of the modelled peak in
the Bode plot.

160
Chapter 3. Dynamics of Motion Systems
As a closure of this part on damping and energy it is illustrative to draw a
plot of the velocity squared over a small area around the undamped natural
frequency. Such a plot gives the relative energy levels at diÔ¨Äerent values
of Q, because the stored kinetic energy equals E = 0.5mv2. In Figure 3.19
the relative energy level is shown of the discussed system with f0 = 100 Hz.
The energy at Q = 1 is taken as reference level and it clearly shows that the
maximum energy stored in the system is proportional to the Q level squared,
corresponding to the amplitude of the velocity squared. While it is shown
both with logarithmic and linear vertical scales this graphic representa-
tion emphasises the very narrow frequency range, which determines the
bandwidth and frequency stability of the resonator at high Q levels. This
property is used to its full potential in timing devices like Quartz oscillators,
which exhibit Q factors up to a value of 107 with corresponding energy peak
levels of 1014. These extreme energy levels explain the insensitivity for
external disturbance forces of such resonators, making them suitable for
highly accurate clocks and watches.
3.2.4
Transmissibility
The term ‚Äútransmissibility‚Äù refers to the capability of a system, to transmit
motion from one area to another, both inside a body as well as between
connected bodies. It is related to the elastic wave propagation, which was
presented in Chapter 2 and is relevant in controlled motion systems, where
the path between actuator and sensor always incorporates several Ô¨Çexible
elements and bodies with often only limited damping. This property of
coupled bodies and springs will be further presented in the next section,
m
xm
k
xs
#$/
c
Storyr/rc
x
Body
Figure 3.20: The transmissibility of a dynamic system reÔ¨Çects the sensitivity for ex-
ternal movements of the supporting frame to a body that is connected
to that frame by a spring and a damper.

3.2. Mass-Spring Systems with Damping
161
but Ô¨Årst the eÔ¨Äect is examined of a motion which is transmitted from a
vibrating supporting frame through the spring and the damper to a single
body. As application example one can think of the inspection microscope
on a vibrating table of the Ô¨Årst part of this chapter or a precision machine
on a vibrating Ô¨Çoor. When the sensitive system would be connected to the
supporting frame by means of compliant springs, the vibrations from the
frame would be attenuated. This vibration isolation principle is frequently
applied in vibration-sensitive machines and instruments.
To calculate the transfer of movements from the supporting frame (xs) to the
body with mass (m), the simple model of Figure 3.20 is used. The distance
xs‚àíxm between the supporting frame and the body is a constant value in the
stationary situation without excitation by movements of the frame. This
constant distance has no inÔ¨Çuence on the force equations as only the relative
displacements will create forces. For that reason a constant value of zero is
chosen for the distance when deriving the equations of motion.
The sum of all forces acting on the body by the spring, the damper and
the acceleration should be zero while the force in the spring and damper is
deÔ¨Åned by the diÔ¨Äerence in position and velocity between the supporting
frame and the body. A positive movement of xs will induce a force in the
positive x-direction of the spring and damper while the acceleration gives
a reaction force in the opposite direction. With these statements the force
equation is written in the time-domain as follows:
Ft(t) = Fb + Fd + Fs = ‚àím d2xm
dt2 + c d(xs ‚àíxm)
dt
+ k(xs ‚àíxm) = 0.
(3.70)
Shifting the terms gives the acceleration of the body by the movement of
the supporting frame.
m d2xm
dt2
= c d(xs ‚àíxm)
dt
+ k(xs ‚àíxm).
(3.71)
After the Laplace-transform this equation is written as follows:
ms2xm = cs(xs ‚àíxm)+ k(xs ‚àíxm) = xs(cs+ k)‚àíxm(cs+ k).
(3.72)
When shifting the terms the following expression is found:
xm(ms2 + cs+ k) = xs(cs+ k).
(3.73)
which can be written into the following transfer of xs to xm:
xm(s)
xs(s) =
cs+ k
ms2 + cs+ k =
cs
k +1
m
k s2 + cs
k +1
.
(3.74)

162
Chapter 3. Dynamics of Motion Systems
After introduction of the variables œâ0 =
4
k/m and Œ∂ = c/(2

km) this results
in the following transfer function as function of (s) and frequency response
function as function of the radial frequency (œâ):
xm(s)
xs(s) =
2Œ∂ s
œâ0
+1
s2
œâ2
0
+2Œ∂ s
œâ0
+1
,
(3.75)
xm
xs
(œâ) =
2jŒ∂ œâ
œâ0
+1
‚àíœâ2
œâ2
0
+2jŒ∂ œâ
œâ0
+1
.
(3.76)
These transmissibility functions show several diÔ¨Äerences, when compared
with the corresponding functions of the earlier presented compliance. First
of all the equation is dimensionless because it represents the eÔ¨Äect of one
displacement on another displacement. Furthermore there is no compliance
term anymore related to the spring, and at œâ ‚â™œâ0 the numerator equals
the denominator.
This means that the transmissibility at very low frequencies always starts
at a value of one. The last diÔ¨Äerence with the compliance transfer function
is the presence of an additional diÔ¨Äerentiating s term in the numerator,
which is related to the damper. This term increases the transmissibility
proportional with the frequency depending on the damping ratio (Œ∂). Without
this term the transmissibility at higher frequencies would be determined
only by the denominator with a s2 term causing a ‚àí2 slope in the magnitude
Bode plot of the transmissibility. For a sensitive instrument, which would
be placed on the body, this would be beneÔ¨Åcial as it reduces the transmission
of vibration of higher frequencies to the sensitive instrument. The related
s term of the damper in the numerator however decreases this beneÔ¨Åcial
eÔ¨Äect and this can be understood from the fact that a stronger damper gives
a stronger connection between the supporting frame and the body.
These eÔ¨Äects are all shown in the Bode plot of Figure 3.21 where a system
is modelled with an undamped natural frequency of f0 = 1 Hz with diÔ¨Äerent
damping settings. Even when the damper is not very strong (the red line
with Q = 10) a rather normal resonance is shown at f0, with the ‚àí2 slope
starting above the undamped natural frequency. For higher frequencies,
however, the transmissibility is already increased with about a factor ten at
hundred Hertz, when compared to the situation with Q = 100 (the blue line).
Higher levels of damping ultimately result in a Ô¨Årst-order system, as can be
seen in the phase plot with a 90¬∞phase shift for Q = 1.

3.2. Mass-Spring Systems with Damping
163
10

10

10

10

10
0
10

10

Transmissibility (abs)
 = 0.005  Q = 100
 = 0.05    Q = 10
 = 0.25    Q = 2
 = 0.5      Q = 1
10
z,
10
0
10
1
10
2
10
3
z,¬Ü{
z¬Ö{
0
Phase [deg]
Frequency [Hz]
Figure 3.21: Bode plot of the transmissibility of a damped mass-spring system in
response to external vibrations from the supporting frame with an
undamped natural frequency f0 of 1 Hz. It clearly shows the negative
eÔ¨Äect on the reduction of the higher frequencies.
A vibration isolation system with low damping is often used in laboratory
equipment, when the undamped natural frequency is suÔ¨Éciently low to
not disturb the measurements. In case of an industrial application, this
is often not suÔ¨Écient. Especially with optical systems, which often suÔ¨Äer
from badly damped resonances in the 100 Hz range, additional measures
are necessary. In Chapter 9 on waferscanners a method will be shown to
solve the problem of the increased transmissibility caused by the damper by
means of active-controlled inertia-based damping, which does not contribute
negatively to the transmissibility at higher frequencies.

164
Chapter 3. Dynamics of Motion Systems
3.2.5
Fourth-Order Dynamic System
The mechanics in real precision positioning systems are far more complex
than the second-order single mass-spring-damper conÔ¨Ågurations, which
were presented in the previous sections. Precision mechatronic systems
generally have to be modelled in multiple degrees of freedom. Further-
more, realistic systems are generally non-rigid and behave dynamically
as a lumped multitude of bodies and springs. It is very important for a
mechatronic designer to be able to qualify and quantify the eÔ¨Äects of these
dynamics. First of all, elastically coupled bodies heavily inÔ¨Çuence the pos-
sibility to create a stable controlled motion system, due to their related
resonances. Secondly, due to practical constraints, the measurement po-
sition in an active positioning system is hardly ever located at the same
place as the actuator nor at the point of interest. To describe the transfer
functions for such situations all equations are generally written in a multi-
ple physical DOF vector and matrix notation, where also cross couplings
between the diÔ¨Äerent directions can be taken into account. As a stepping
stone for the important dynamic analysis tool of modal decomposition, which
is introduced in the next section, Ô¨Årst a simple example is shown with a
fourth-order system with two bodies that still allows to apply an analyt-
ical approach with equations of motion in only one coordinate direction,
describing the movement of the bodies and their dynamic interaction.
Modelling Without Damping
Mechanical structures can be modelled as a combination of solid bodies
connected with springs and dampers. Generally the passive damping of
these connections is quite limited and only determined by hysteresis prop-
m1
x1
k
m2
x2
Staonary reference
x
Fa
Figure 3.22: Mass-spring system with two bodies with mass m1 and m2 connected
by a spring with stiÔ¨Äness k. An actuator force Fa excites the Ô¨Årst body
and the resulting motion is measured at both bodies.

3.2. Mass-Spring Systems with Damping
165
erties of the material or friction in the guiding. For this reason, in the
following sections the behaviour of the dynamic system will be examined
without damping in order to avoid long equations. The example, as shown
in Figure 3.22, is a conÔ¨Åguration where two bodies are coupled by a spring.
The actuation force Fa is applied to the Ô¨Årst body with its mass m1 coupled to
the second body with mass m2 by the spring with stiÔ¨Äness k. This example
is representative for a more realistic dynamic model of the optical pick-up
unit of the CD player, where the actuator can be seen as a body with mass
m1 and the lens as a body with mass m2.
3.2.5.1
Analytical Description
As a Ô¨Årst step towards the analytical description of the fourth-order system
dynamics, the balance of forces acting on both bodies is determined along
the same reasoning as with the equations of motion of the single-body mass-
spring system. For the Ô¨Årst body the force balance according to the second
law of Newton equals in the time-domain:
Fa ‚àím1
d2x1
dt2 ‚àík(x1 ‚àíx2) = 0.
(3.77)
Note that the force from the spring acts on both bodies in the opposite
direction and the external force only works on the Ô¨Årst body.
For the second body the force balance according to the second law of Newton
equals in the time-domain:
‚àím2
d2x2
dt2 + k(x1 ‚àíx2) = 0
‚àí‚Üí
m2
d2x2
dt2 ‚àík(x1 ‚àíx2) = 0.
(3.78)
After Laplace-transform Equation (3.77) and (3.78) are written as follows:
Fa ‚àím1s2x1(s)‚àík(x1 ‚àíx2) = 0,
(3.79)
m2s2x2(s)‚àík(x1 ‚àíx2) = 0.
(3.80)
From these two equations the following transfer functions in the Laplace-
domain between x1 respectively x2 and F can be derived by Ô¨Årst using
Equation (3.80) to write x2 as function of x1 and use that result to solve
Equation (3.79):
x1
Fa
(s) =
m2s2 + k
m1m2s4 + k(m1 + m2)s2 ,
(3.81)
x2
Fa
(s) =
k
m1m2s4 + k(m1 + m2)s2 .
(3.82)

166
Chapter 3. Dynamics of Motion Systems
With these equations some qualitative conclusions can be derived by looking
at diÔ¨Äerent areas of the frequency spectrum. At very small values of s, the
m2s2 term in the numerator of x1/F can be neglected with respect to k and
m1m2s4 can be neglected with respect to k(m1 + m2)s2 in the denominator
of both transfer functions. When these less signiÔ¨Åcant terms are neglected
the transfer functions for both bodies approximate the following equation:

 x1
Fa
(s)

s‚Üí0
‚âà

 x2
Fa
(s)

s‚Üí0
‚âà
1
s2(m1 + m2).
(3.83)
This is a standard mass-line with slope of ‚àí2 in the Bode plot corresponding
to a mass, equal to the sum of m1 and m2 which seem to move together as
one rigid body.
At high frequencies, so at high values of s, the m2s2 term in the numerator of
x1/F is much larger than k, and m1m2s4 dominates over k(m1 + m2)s2 in the
denominator of both transfer functions. By neglecting the less signiÔ¨Åcant
terms the transfer functions are approximated as follows:

 x1
Fa
(s)

s‚Üí‚àû
‚âà
1
m1s2 ,

 x2
Fa
(s)

s‚Üí‚àû
‚âà
k
m1m2s4 .
(3.84)
This means that at these high frequencies the Ô¨Årst body will respond accord-
ing to the mass-line of only its own mass, while the second body will respond
with a slope of ‚àí4 proportional to the mass of both bodies. This steep slope
corresponds to the inability of the second body to follow the movement of
the Ô¨Årst body. This is called the decoupling of the second body.
3.2.5.2
Multiplicative Expression
The derived transfer functions are written in a polynomial form, which
is common in control engineering practice. To investigate the response
at the intermediate frequency range in an analytical way, it is better to
write the equations in a diÔ¨Äerent form. It is possible to re-arrange Equa-
tion (3.81) and (3.82) to obtain a form where a multiplication of factors is
used. By splitting the denominator, the multiplicative expression for the
transfer function in the Laplace-domain of the Ô¨Årst body consists of three
terms and equals:
x1
Fa
(s) =
1
(m1 + m2)s2 √ó(m2s2 + k)√ó
1
mcs2 + k ,
(3.85)
with the combined mass term mc equal to:
mc =
m1m2
m1 + m2
.

3.2. Mass-Spring Systems with Damping
167
In this transfer function one can recognise the Ô¨Årst term as being the compli-
ance of the free moving bodies together. For small values of s, corresponding
to a low excitation frequency, the two other terms, when combined, are
equal to one and the system reacts as one free moving body as concluded
in the previous section. The second term (m2s2 + k) has a constant value
equal to the stiÔ¨Äness k at low frequencies. At high frequencies this factor
increases with the square of the frequency, a +2 slope. At a frequency œâa
where s = jœâ = ¬±j
4
k/m2 this term becomes zero. These values for s are two
complex conjugate zeros of the transfer function and the dynamic response
will be equal to zero at œâa. This phenomenon is called an anti-resonance,
although it is no real resonance, as it does not store energy. The third term is
similar to the transfer function of a single mass-spring system. Apparently
there are three frequencies with a dynamic eÔ¨Äect. At two frequencies the
frequency response goes to inÔ¨Ånity. These undamped natural frequencies
correspond to the poles of the system and are called the eigenfrequencies
f0,i:
f0,1 = 0
[Hz],
f0,2 = 1
2œÄ

k
mc
[Hz].
(3.86)
The frequency where the numerator of Equation (3.85) equals zero cor-
responds to the zeros of this transfer function and represented the ‚Äôanti-
resonance‚Äô.
fa = 1
2œÄ

k
m2
[Hz]
(3.87)
In this case the frequency of the anti-resonance corresponds to the eigenfre-
quency of body m2 for the situation when m1 would be Ô¨Åxed to the stationary
reference. In a similar way as with the Ô¨Årst body one can write the transfer
function in the Laplace-domain for the second body:
x2
Fa
(s) =
1
(m1 + m2)s2 √ó
k
mcs2 + k
[m/N].
(3.88)
This equation has the same two poles but no zeros, which determines the
main diÔ¨Äerence in the corresponding frequency response.
3.2.5.3
EÔ¨Äect of DiÔ¨Äerent Mass Ratios
In the previous part several dynamic eÔ¨Äects were mathematically described,
which occur with two coupled masses. The vertical shift of the ‚àí2 slope to a
higher level from low to high frequencies was shown due to the decoupling of

168
Chapter 3. Dynamics of Motion Systems
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
a: Body 1
Compliance [m/N]
 
 
 
z,¬Ü{
z¬Ö{
0 
Phase [deg]
101
10¬Ç
10[
Frequency [Hz]
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
*¬Ç
 
 
 
z[¬É{
z¬Ç¬Ñ{
z,¬Ü{
101
10¬Ç
10[
Frequency [Hz]
¬Ç
¬Ç
)
x11
f0,2
fa
f0,2
¬Ç
Figure 3.23: Bode plot of the response of a dual mass-spring system with m1 =
2.5¬∑10‚àí3 kg, m2 = 25¬∑10‚àí3 kg and k = 1¬∑104 N/m. The values result in
an undamped natural frequency of 333 Hz and an ‚Äôanti-resonance‚Äô of
100 Hz for the Ô¨Årst body. After the ‚Äúdecoupling‚Äù of the second body
the initial compliance slope of ‚àí2 of the Ô¨Årst body continues with the
same slope but at higher level, corresponding to the ratio between m1
and m1 + m2 (=11). At the second body only the resonance is visible
and its initial compliance slope of ‚àí2 becomes ‚àí4 above the resonance,
indicating the inability of the second body to follow the movement of
the Ô¨Årst body.
the second mass while the multiplicative notation showed three frequencies
with either a resonance or an anti-resonance. To illustrate these Ô¨Åndings,
the Bode plots of x1/F and x2/F are shown for three situations:
‚Ä¢ m1 < m2: This is for instance the situation of a body with a large mass
(m2), actuated by a less heavy actuator (m1), which is connected by
means of a Ô¨Çexible mount.
‚Ä¢ m1 = m2: This is the case when the mass of an actuator is equal to

3.2. Mass-Spring Systems with Damping
169
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
a: Body 1
Compliance [m/N]
 
 
 
z,¬Ü{
z¬Ö{
0 
Phase [deg]
101
10¬Ç
10[
Frequency [Hz]
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
*¬Ç
 
 
 
z[¬É{
z¬Ç¬Ñ{
z,¬Ü{
101
10¬Ç
10[
Frequency [Hz]
f0,2
fa
f0,2
)
¬Ç
¬Ç
¬Ç
¬ï¬Ç
Figure 3.24: Bode plot of the response of a dual mass-spring system with bodies
having an equal mass m1 = m2 = 25¬∑10‚àí3 kg and k = 1¬∑104 N/m. These
values result in an undamped natural frequency of 141 Hz where
both bodies move in the opposite direction with equal amplitude. The
‚Äôanti-resonance‚Äô measured at the Ô¨Årst body is not changed compared
with Figure 3.23.
the mass of the positioned object, for instance when the active mass is
optimised relative to the total moving mass of a positioning system.
‚Ä¢ m1 > m2, This is representative for the situation, where a large mass
(m1) is positioned with elastically connected smaller masses (m2),
which cause parasitic resonances.
Based on the fact that the normalised mass factor mc is always smaller than
m2, the ‚Äôanti-resonance‚Äô of the Ô¨Årst body will occur at a lower frequency than
the resonance at the second eigenfrequency.
Depending on the ratio between m1 and m2, the relation between these
frequencies will be diÔ¨Äerent, as shown in Figure 3.23, 3.24 and 3.25.

170
Chapter 3. Dynamics of Motion Systems
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
a: Body 1
Compliance [m/N]
 
 
 
z,¬Ü{
z¬Ö{
0 
Phase [deg]
101
10¬Ç
10[
Frequency [Hz]
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
*¬Ç
 
 
z[¬É{
z¬Ç¬Ñ{
z,¬Ü{
101
10¬Ç
10[
Frequency [Hz]
f0,2
fa
f0,2
¬Ç
¬Ç
¬Ç
)
x1.1
Figure 3.25: Bode plot of the response of a dual mass-spring system with the mass
of body one being ten times larger than the mass of body two. For this
example m1 = 0.25 kg, m2 = 25¬∑10‚àí3 kg and k = 1¬∑104 N/m, resulting
in an undamped natural frequency of 105 Hz, very close to the ‚Äôanti-
resonance‚Äô. Note that the overall compliance is decreased due to the
increase of the total mass.
At f = fa the frequency response of x1/F shows an anti-resonance according
to the zeros in the transfer function and all force is directly transferred to
the second body. This is a special situation as one would expect a visible
resonance at the second body at its ‚Äúown‚Äù undamped natural frequency with
the entire spring. This thinking model is however wrong as on the graph of
x2/F no resonance is shown. This can be explained by the fact that at this
frequency the amplitude x1 of the Ô¨Årst body equals zero and no power is
transferred by the force to the second body, which would be necessary to
increase the amplitude. The amplitude of the movement of the second body
is such that the corresponding strain of the spring creates a force, which
just compensates the external force acting on the Ô¨Årst body. This amplitude
is equal to the position on the undisturbed line of the Bode plot and even no

3.2. Mass-Spring Systems with Damping
171
reaction is observed in the response of the second body, because at fa the
amplitude of x2/F equals the compliance of spring k (Cs = 1/k). This can be
checked in Figure 3.23.b where the magnitude of the frequency response of
the second body at fa = 100 Hz equals 10‚àí4, which is equal to the compliance
of the connecting spring.
At f = f0,2 both bodies will resonate while the movement of the Ô¨Årst body
is 180¬∞out of phase with respect to the movement of the second body as
they move in opposite directions. When f > f0,2 the slope of the Bode plot
of the Ô¨Årst body will continue at ‚àí2, but at a higher level than found by
extrapolating the slope at f ‚â™fa. This is caused by the decoupling of the
second body, which no longer joins the movement of the Ô¨Årst body. As a
consequence the slope of the response of the second body becomes twice as
steep (‚àí2) as the slope of the Ô¨Årst body. The compliance of the Ô¨Årst body
is increased proportional to the ratio of the diÔ¨Äerence in mass, which for a
ratio of one to eleven means that the compliance of the Ô¨Årst body becomes a
factor eleven larger than was shown in Figure 3.23.a.
For the situation where m1 = m2 = m then f0,2 = 1/2œÄ
4
2k/m =

2¬∑ fa. In the
Bode plot of this situation it is shown that at f0,2 both bodies move in counter
phase with the same amplitude. As then the middle of the spring does not
move, both bodies resonate each with only one half of the spring. This double
stiÔ¨Äness is the reason for the

2 ratio between f0,2 and fa. For the situation
where m1 is much larger than m2, f0,2 will be approximately equal to fa.
Overall the second body will not have a large inÔ¨Çuence on the movement
of the Ô¨Årst body anymore. Only at the undamped natural frequency it will
show up as a characteristic combination of a zero and a pole.

172
Chapter 3. Dynamics of Motion Systems
3.3
Modal Decomposition
Upon excitation with a force a real mechanical structure will vibrate at
many diÔ¨Äerent frequencies, while the frequency content diÔ¨Äers upon the
location of the excitation. This eÔ¨Äect is used in musical instruments where
for instance the sound of a snare depends on the place where it is striked
by a guitar player. The theory of modal decomposition aims to split the
total vibration pattern of a mechanical structure in separate resonating
sub-patterns, called eigenmodes. As the German/Dutch word ‚Äúeigen=own‚Äù
implies, eigenmodes are inherent properties of the structure and with modal
decomposition they can each be separately investigated on their eÔ¨Äect on
the total structure, thereby enabling to take measures against the impact
of some of the most annoying eigenmodes. Associated with eigenmodes, the
mode-shape describes the motion of the system by means of a multidimen-
sional continuous shape-function, which is discretised into an eigenvector,
with motion magnitude terms for all modelled bodies in the system.
The analytical approach in the previous section to derive the equations of
motion for the dynamics of a two-body mass spring system was useful to get
an initial grip on the generic frequency response of a mechanical structure.
When analysing more complex structures, modelled as a combination of mul-
tiple mass-spring systems, this analytical description has to be expanded to
multiple degrees of freedom, using a vector-matrix notation to calculate the
results. As a Ô¨Årst example, the transfer functions from Equation (3.81) and
Equation (3.82) are split into two eigenmodes in Section 3.3.1 with each a
scalable modal mass and a modal stiÔ¨Äness, which together determine the
undamped natural frequency of each eigenmode, called the eigenfrequency as
was presented in Equation (3.86). In Section 3.3.2 this is further expanded
to more complex structures by an eigenvalue decomposition, followed by a
graphical representation method, which helps in the interpretation of this
theory in practical situations. Finally the section closes with the deriva-
tion of the total frequency response by modal superposition of the diÔ¨Äerent
eigenmodes.
The eigenfrequencies of the diÔ¨Äerent eigenmodes can be measured by ex-
citing the mechanical structure with an impulse force, applied for instance
by a testing hammer, after which the system will freely vibrate until the
internal damping has reduced these vibrations. The ability to detect the
eigenfrequencies with vibration sensors makes this modal analysis method
very useful when designing controllers for mechatronic systems as long as
the observed phenomena are well understood.

3.3. Modal Decomposition
173
3.3.1
Eigenmodes of Two-Body Mass-Spring System
The two-body mass-spring system from Figure 3.26 has a Ô¨Årst eigenfre-
quency f0,1 of 0 Hz and the corresponding eigenmode has a mode-shape,
which is represented by the joint motion of the two bodies. The eigenmode
of the other eigenfrequency f0,2 has a mode-shape, which is deÔ¨Åned by the
movement of both bodies in opposite directions, with an amplitude ratio,
which depends on the mass ratio. From a physical point of view this can
be understood from the fact that the joint centre of mass of the two bodies
must remain stationary in absence of external forces acting on the system.
One can imagine the movements of these eigenmodes as stable oscillations
without external forces to keep them going. When this system is Ô¨Çoating
in outer space any constant movement of the two bodies together will al-
ways continue at the absence of external forces and the same is true for
a once excited resonance without damping in the second eigenmode. It is
this straightforward imagination possibility, which underlines the value
of this model in practice. This is even more so because these eigenmodes
m1
k
m2
Sta onary reference
m1
m2
Sta onary reference
a: Eigenmode 1
b: Eigenmode 2
x

x

x

x

k
Fa
Fa
x
x
1
1
2
2
Figure 3.26: The two eigenmodes with the corresponding mode-shapes of a dual
mass-spring system and a connecting spring. The Ô¨Årst eigenmode is
the linear uniform motion in one direction at the Ô¨Årst ‚Äúeigenfrequency‚Äù
f0,1 = 0 Hz. The second eigenmode is the elastic movement of the two
bodies opposite to each other at the second eigenfrequency f0,2 with
a motion magnitude ratio inversely proportional to the mass ratio of
the two bodies, here drawn as if both bodies have an equal mass. The
drawn eigenmode direction is only one of the possible directions as
the movement is periodically reciprocating.

174
Chapter 3. Dynamics of Motion Systems
are independent as long as the system behaves linear. Under that condition
their individual response to a stimulus can be simply added to give the
response of the total system. In practical designs this linearisation is often
allowed because of the small deformations involved in precision mechatronic
equipment. In the following analysis two transfer functions are derived,
which can be added to illustrate this superposition principle. The choices
made might look awkward but it will be shown later that these choices are
allowed to be made.
The analytical conversion starts with Equation (3.85) for the position of the
Ô¨Årst body in the Laplace-domain:
x1
Fa
(s) =
1
(m1 + m2)s2
m2s2 + k
mcs2 + k
[m/N].
(3.89)
To convert this into two added terms with s2 in the denominator, a standard
fraction decomposition is applied starting by adding and subtracting mcs2
from the numerator of the last term:
x1
Fa
(s) =
1
(m1 + m2)s2
(mcs2 + k)+(m2 ‚àímc)s2
mcs2 + k
=
1
(m1 + m2)s2

1+ s2 m2 ‚àímc
mcs2 + k

=

 x1
Fa

1
+

 x1
Fa

2
=
1
(m1 + m2)s2 +
m2‚àímc
m1+m2
mcs2 + k
[m/N].
(3.90)
This shows that the total transfer function now consists of the summation
of the transfer functions of two eigenmodes.
When replacing mc by m1m2/(m1 + m2) in the numerator, the total transfer
function can be formulated as follows:
x1
Fa
(s) =

 x1
Fa

1
+

 x1
Fa

2
=
1
(m1 + m2)s2 +
m2
2
(m1+m2)2
mcs2 + k
[m/N].
(3.91)
When comparing this result with Equation (3.89) it can be concluded that
the Ô¨Årst term is unchanged. This corresponds to the fact that for low frequen-
cies this eigenmode dominates the transfer function. At higher frequencies
the double zeros from the second numerator term of Equation (3.89) have
disappeared while the two poles of the second eigenmode remain with a
proportionality factor in the numerator, determined by the mass values of
the two bodies. This corresponds to the Ô¨Ånding some pages further on that
the anti-resonance determined by the double zeros is only the result of the
summation of two equal response magnitude with an opposite phase. This
means that the anti-resonance is not an ‚Äúenergy container‚Äù like a resonance.

3.3. Modal Decomposition
175
A further conclusion is that the contributions of both eigenmodes are deter-
mined as if driven with the same actuator force Fa. This is important to be
aware of as one could think that the force is divided over both modes.
Equation (3.91) can be written slightly diÔ¨Äerent by introducing Mi as the
modal mass and Ki as the modal stiÔ¨Äness for the eigenmode (i):
x1
Fa
=

 x1
Fa

1
+

 x1
Fa

2
=
1
M1s2 +K1
+
m2
2
(m1+m2)2
M2s2 +K2
[m/N].
(3.92)
The modal mass values are equal to:
M1 = m1 + m2
and
M2 = mc
[kg].
(3.93)
The value for the modal stiÔ¨Äness of the Ô¨Årst eigenmode equals zero as there
is no spring connecting the system to the stationary reference (K1 = 0). The
modal stiÔ¨Äness K2 for the second eigenmode follows by comparing Equa-
tion (3.91) with Equation (3.92) and is directly related to the eigenfrequency
and the chosen modal mass:
œâ2
0,2 = k
mc
= K2
M2
rad/s

.
(3.94)
In principle we could have chosen diÔ¨Äerent values for the modal mass of
both eigenmodes as long as the modal stiÔ¨Äness and the constant terms in
the numerator of the respective terms are scaled accordingly. This freedom
of scaling automatically implies that the relation between modal mass
and the real mass of the bodies is purely proportional and, as will
be explained in Section 3.3.2, it is important to be aware of this diÔ¨Äerence.
The same fraction decomposition of Equation (3.88) results in the analytical
transfer functions for the two eigenmode contributions to the movement of
the second body, where the modal mass and stiÔ¨Äness values of the resulting
terms need to be equal to the terms for the Ô¨Årst body. These required equal
values result in diÔ¨Äerent numerator values in the transfer function.
x2
Fa
(s) =
1
(m1 + m2)s2
k
mcs2 + k
=
1
(m1 + m2)s2

mcs2 + k

‚àímcs2
mcs2 + k
=
1
(m1 + m2)s2 +
‚àí
m1m2
(m1+m2)2
mcs2 + k
=

 x2
Fa

1
+

 x2
Fa

2
=
1
M1s2 +K1
+
‚àí
m1m2
(m1+m2)2
M2s2 +K2
[m/N].
(3.95)
The contribution of the Ô¨Årst eigenmode to the response of the second body
appears to be equal to the contribution of this eigenmode to the response of

176
Chapter 3. Dynamics of Motion Systems
the Ô¨Årst body. This is caused by the fact that this Ô¨Årst eigenmode describes
the motion of both bodies together as if they were one rigid body3.
The diÔ¨Äerence in dynamic behaviour between the two bodies is found in
the contribution of the second eigenmode to the movement of the bodies.
The Ô¨Årst diÔ¨Äerence is the -1 sign in the numerator with the second body
and both diÔ¨Äerences can be explained from the fact that both masses move
in opposite directions in the second eigenmode. The relative amplitude is
equal to:
x1
x2
=
m2
2
m1m2
= m2
m1
.
(3.96)
This inverse proportionality to the ratio between the masses of the two bod-
ies is directly explainable with Newton‚Äôs third law, dictating that the spring
force is equal for both bodies. The fact that the eigenmode is a free moving
vibration eigenmode without external forces implies that the accelerations
and the resulting velocity and position values should be inverse proportional
to the mass of the bodies. The sign inversion of the second eigenmode with
the second body creates a 180¬∞phase diÔ¨Äerence and a subtraction from the
movement by the Ô¨Årst eigenmode where both eigenmodes act in the same
direction for the total movement of the Ô¨Årst body. For reasons of consistency
it is however better to call it an addition with a minus sign as the modelling
principle is the addition of eigenmodes. For this reason the minus sign is
retained in the numerator.
The response of the system to a force acting at a degree of freedom of the
system (x1 in this example) is determined by the real mass and stiÔ¨Äness
values that are perceived at the point of insertion of the force. These
values are called the eÔ¨Äective modal mass Meff.i,k and eÔ¨Äective modal stiÔ¨Ä-
ness Keff.i,k for eigenmode i as if these were real mass and stiÔ¨Äness values
perceived on physical DOF k. These eÔ¨Äective values can be derived by reduc-
ing Equations (3.92) and (3.95) to equations with a numerator value equal
to one.
x1
Fa
=

 x1
Fa

1
+

 x1
Fa

2
=
1
M1s2 +K1
+
m2
2
(m1+m2)2
M2s2 +K2
=
1
Meff.1,1s2 +Keff.1,1
+
1
Meff.2,1s2 +Keff.2,1
[m/N].
(3.97)
With the introduced values for the modal stiÔ¨Äness of the example, the
eÔ¨Äective modal values for the Ô¨Årst eigenmode are equal to the modal values:
3It will be shown in Section 3.3.2 that this rigid-body mode only exists when the modal
stiÔ¨Äness of the eigenmode approximates zero, like in this example.

3.3. Modal Decomposition
177
m   m
Eigenmode 2
x

x

k
 Eigenmode 2 equivalent (m ¬á%|¬á
x

2k
Symmetry axis
2k
     2m
x

2
Fa
Fa
Fa
x
x
=
1
m   m
=
1
m   m
=
2
m   m
=
2
4k
Figure 3.27: The eÔ¨Äective mass and stiÔ¨Äness of the second eigenmode can be rea-
soned from the fact that there is a stationary point on the spring where
both masses move opposite to each other. In case of two equal mass
values they move with the same amplitude as if driven by a mechanism.
The symmetry allows a mirroring of the second body with its related
spring value and mass. After combining, the eÔ¨Äective modal mass
equals Meff.2,1 = m1 + m2 = 2m. Special attention is needed for the
connecting air spring, which is a factor four larger in the equivalent
simple mass-spring system.
Meff.1,1 = M1 = m1 + m2
[kg].
and
Keff.1,1 = K1 = 0
N/m

.
(3.98)
For the second eigenmode the relation between the parameters of the
lumped model, the modal parameters and the eÔ¨Äective modal parameters
in DOF x1 are given by:
Meff.2,1 = M2
(m1 + m2)2
m2
2
= mc
(m1 + m2)2
m2
2
= (m1 + m2) m1
m2
[kg]
(3.99)
Keff.2,1 = K2
(m1 + m2)2
m2
2
= k (m1 + m2)2
m2
2
N/m

.
(3.100)
These equations show that the eÔ¨Äective stiÔ¨Äness and mass values can be
signiÔ¨Åcantly larger than the real mass values of the bodies, depending on
the mass ratio. In the case of equal mass values (m1 = m2 = m), the eÔ¨Äective

178
Chapter 3. Dynamics of Motion Systems
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10

a: Body 1
Compliance [m/N]
10
1
10
2
10
[
0
Phase [deg]
Frequency [Hz]
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
b: Body 2
Eigenmode 1
Eigenmode 2
Total system
10
1
10
2
10
[
z[¬É{
z,¬Ü{
0
Frequency [Hz]
z[¬É{
z,¬Ü{
,$$,¬Ü{`
high mass     low spring-line
low mass      high springline
fa
o
f0,2
f0,2
Figure 3.28: Bode plot of the response of the same dual mass-spring system of
Figure 3.23 with m1 = 2.5¬∑10‚àí3 kg, m2 = 25¬∑10‚àí3 kg and k = 1¬∑104 N/m,
resulting from the combination of the two eigenmode responses.
Whereas the contribution of mode 1 is identical for body 1 and 2,
the contribution of mode 2 to the Bode plot of body 1 and 2 is com-
pletely diÔ¨Äerent. The anti-resonance, visible at body 1, emerges from
the interaction of the two modes with identical amplitude but opposite
sign while for body 2 the signs are equal at the intersection of the
frequency response of the two modes and the contributions simply add
up.
value of the modal stiÔ¨Äness equals Keff.2,1 = 4k while the eÔ¨Äective modal
mass equals Meff.2,1 = 2m, as is graphically represented in Figure 3.27. This
means that the eigenfrequency is determined by a double mass value with
a four times higher stiÔ¨Äness value. This is indeed the same frequency value
as determined in Equation (3.94) where the full stiÔ¨Äness k works on mc,
which is equal to half the mass m for the case of equal mass values. The
response of the second body to this non-collocated force, hence not acting
on the second body but on the Ô¨Årst body, can be directly derived from the

3.3. Modal Decomposition
179
same eigenmodes with diÔ¨Äerent coeÔ¨Écients in the numerator to account
for the diÔ¨Äerence in magnitude of motion. The Ô¨Årst eigenmode is a real
rigid-body eigenmode so the magnitude in motion of both bodies is equal.
For the second eigenmode the same force in the spring acts on both bodies
resulting in acceleration levels that are inverse proportional to their mass
with a response of the second body that is diÔ¨Äerent corresponding to the
mass ratio:
x2
Fa
=

 x2
Fa

1
+

 x2
Fa

2
=
1
M1s2 +K1
+
‚àí1
m1m2
(m1+m2)2
M2s2 +K2
=
1
Meff.1,1s2 +Keff.1,1
+
‚àím1
m2
Meff.2,1s2 +Keff.2,1
[m/N].
(3.101)
As a result of this diÔ¨Äerent formulation of the transfer functions as a combi-
nation of eigenmodes, the Bode plot of the frequency response function of a
complex system can relatively simply be derived by adding the contributions
of the separate eigenmodes, considering both magnitude and phase. This is
graphically shown in the combined Bode plots of Figure 3.28 for the identical
system as was modelled in Figure 3.23 where m2 = 10m1 = 25 ¬∑ 10‚àí3. The
anti-resonance in the frequency response of the Ô¨Årst body at frequency fa
appears to be the result of the equal amplitude of both eigenmodes with
180¬∞phase diÔ¨Äerence, and thus the two contributions will add to zero. This
makes again clear that the term ‚Äúanti-resonance‚Äù is a poorly chosen term
as it is only the result of two equal signals in counter phase. Similarly the
transfer function x2/F of the second body is equal to the sum of the two sepa-
rate eigenmodes. In this case the anti-resonance does not occur, because of
the phase inversion by the -1 term in the denominator of the second eigen-
mode. At higher frequencies beyond f2 the phase of the second eigenmode
is further shifted with 180¬∞to -360‚ó¶, while both eigenmodes follow an equal
mass-line. The combined magnitude decreases more rapidly, leading to the
‚àí4 slope for high frequencies with the corresponding ‚àí360¬∞phase relation,
because both components have approximately the same magnitude and an
opposing phase.
3.3.2
Theory of Modal Decomposition
Modal decomposition was presented in the previous sections in a visualising
and describing way to get a basic feeling for the frequency and phase response
of a mechanical structure to periodic forces. This ‚Äúfeel‚Äù for the behaviour
is necessary to be able to perform a sanity check on the results of the
usually applied mathematical modelling. The most frequently observed

180
Chapter 3. Dynamics of Motion Systems
problem is the representation of the phase in the generated Bode plots,
when using simulation software. By not being able to mathematically
distinguish 360¬∞from 0¬∞or any multiple of 360¬∞, the phase plots are often
contradicting, showing for instance a +180¬∞ jump in the graph where it
should be a -180¬∞jump, especially when no damping is applied for reasons of
simplicity. This might lead to erroneous conclusions, giving the mechatronic
designer the idea that the system can have stable feedback at elevated
frequencies where the modelling software shows a phase that is less negative
than in reality. Under the condition that one is suÔ¨Éciently aware of these
anomalies, the mathematics will prove to be an extremely powerful tool for
the analysis of real complex systems with a multitude of combined bodies
and springs, up till the level of Ô¨Ånite-element analysis where a solid body is
modelled as an almost inÔ¨Ånite number of interconnected bodies.
3.3.2.1
Multi Degree of Freedom Equation of Motion
The general time-domain related equation of motion with multiple degrees
of freedom of a linear mechanical system without damping is written as
follows in a matrix/vectorial notation similar to the single physical DOF
Equation (3.30):
M ¬®x(t)+Kx(t) = F(t).
(3.102)
in which M and K stand for the symmetric (semi-) positive deÔ¨Ånite mass and
stiÔ¨Äness matrix as deÔ¨Åned in Chapter 2, x and ¬®x represent the displacement
and acceleration vectors according to the chosen physical coordinate system,
and F denotes the vector of externally applied forces4.
In the Laplace-domain Equation (3.102) is written as:
Ms2x(s)+Kx(s) = F(s).
(3.103)
3.3.2.2
Eigenvalues and Eigenvectors
Generally the system of equations is coupled by non-diagonal terms in the
stiÔ¨Äness matrix (static coupling) and those in the mass matrix (dynamic
coupling). This means that the total force related to each displacement
and acceleration is determined by multiple terms in the matrices. These
non-diagonal terms can be eliminated by using a transformation based on
4Like in all chapters in this book the force is noted with the mathematical symbol F written
in capitals, even though it is only a vector, to distinguish it from the temporal frequency f .

3.3. Modal Decomposition
181
the eigenvectors œÜi. An eigenvector œÜi is a special case of a deformation
shape x for which, at the corresponding eigenfrequency œâ0,i, the inertia
and stiÔ¨Äness forces are in equilibrium at all points of the system. Under
free vibration conditions without damping, a once excited vibration with
this deformation shape at this eigenfrequency would sustain without an
external force. In the absence of an external force F and by taking only the
positive imaginary terms of s = œÉ+ jœâ, Equation (3.103) is reduced to the
following equation in the frequency-domain:
Kx(œâ)‚àíœâ2Mx(œâ) = 0.
(3.104)
This set of coupled equations can be decoupled by using a transformation
based on the non-trivial solutions (the eigenvectors œÜi) of the following
eigenvalue problem:
6
K ‚àíœâ2
0,iM
7
œÜi = 0.
(3.105)
In principle this eigenvalue problem could be solved, starting by taking
det
6
K ‚àíœâ2
0,iM
7
= 0, but this would lead to extremely large numbers (œâ2
0,i),
where small rounding errors in the computation cause large errors in the
solutions, especially with large matrices. Instead other dedicated numer-
ical solving methods are applied, which go beyond the scope of this book,
resulting in the eigenfrequencies œâ2
0,1, œâ2
0,2, ... œâ2
0,n and the corresponding
eigenvectors or mode-shape vectors œÜ1, œÜ2, ... œÜn.
The eigenvectors have the following orthogonality properties, or can always
be chosen such that:
œÜ‚ä∫
i MœÜj = 0
(i Ã∏= j).
(3.106)
For i = j the result of the multiplication according to Equation (3.106) yields
a non-zero result, which is normally indicated as modal mass Mi:
œÜ‚ä∫
i MœÜi = Mi.
(3.107)
Several scaling methods are used, all based on Equation (3.107), because only
the direction but not the length of an eigenvector is deÔ¨Åned. Basically there
are two options, one can either specify a certain scaling for the mode-shape
vector and calculate the resulting modal mass Mi from Equation (3.107), or
one can choose a value for the modal mass Mi and scale the mode-shape
vector œÜi such that Equation (3.107) is satisÔ¨Åed.
The following three scaling methods are often used :
‚Ä¢
''œÜi
'' = 1: Each eigenvector œÜi is scaled such that its length is equal to
one. The modal mass Mi is then calculated from Equation (3.107).

182
Chapter 3. Dynamics of Motion Systems
‚Ä¢ max

œÜi

= 1: Each eigenvector œÜi is scaled such that its largest ele-
ment is equal to one. The modal mass Mi is then calculated from
Equation (3.107).
‚Ä¢ Mi = 1: The modal mass Mi is set equal to one. The scaling of the
eigenvector œÜi follows from Equation (3.107).
The orthogonality properties also apply to the stiÔ¨Äness matrix K. From
Equations (3.105), (3.106) and (3.107) one can Ô¨Ånd that:
œÜ‚ä∫
i KœÜj = 0
(i Ã∏= j),
(3.108)
œÜ‚ä∫
i KœÜi = œâ2
0,iMi = Ki.
(3.109)
where Ki equals the modal stiÔ¨Äness for eigenmode i.
3.3.2.3
Modal Coordinates
Any displacement vector x for the dynamic system can be written as a linear
combination of the eigenvectors, because the n eigenvectors œÜi form a base in
the n-dimensional space. Let qi(t) be the motion of the decoupled eigenmode
i at the location of the modal mass and stiÔ¨Äness, then the resulting total
displacement vector x will be5:
x(t) = q1(t)œÜ1 + q2(t)œÜ2 +...qn(t)œÜn
[m].
(3.110)
The process that transformed the coupled equations of motion into decoupled
eigenmodes has also created a new coordinate system as was introduced
in Chapter 2 and which is called the modal coordinate system in which the
term qi is called the ‚Äúmodal coordinate‚Äù or modal degree of freedom at the
location of the modal mass and stiÔ¨Äness. This connection to the location
of the modal mass and stiÔ¨Äness also implies that the chosen scaling of the
eigenvector determines the scaling of the modal coordinate, such that the
multiplication of the eigenvector with the modal coordinate is independent
of the scaling.
For one individual physical DOF xk, Equation (3.110) is reduced to:
xk(t) = q1(t)œÜ1,k + q2(t)œÜ2,k +...qn(t)œÜn,k
[m].
(3.111)
with œÜi,k being the element of the mode-shape vector œÜi that corresponds to
the physical DOF xk.
5In this section the domain determinators (t), (s), (œâ) or (f ) are often mentioned several
times in the equation to distinguish dynamic variables from constants

3.3. Modal Decomposition
183
The physical interpretation of Equations (3.110) and (3.111) is that any
motion of the system at any time can be regarded as a combination of
contributions of the various modes. One can combine the eigenvectors in
a matrix Œ¶ and the coeÔ¨Écients q1, q2 ... qn in a vector q(t), which leads to a
more compact notation of Equation (3.110):
x(t) = Œ¶q(t)
[m],
(3.112)
with: Œ¶ =

œÜ1 œÜ2 ... œÜn
 and q(t) =
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
q1(t)
...
qi(t)
...
qn(t)
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
.
Substitution of Equation (3.112) in the original Equation (3.102) and pre-
multiplication with Œ¶‚ä∫results in:
Œ¶‚ä∫MŒ¶ ¬®q(t)+Œ¶‚ä∫KŒ¶q(t) = Œ¶‚ä∫F(t).
(3.113)
Using Equations (3.106), (3.107), (3.108) and (3.109) Ô¨Ånally leads to a set of
uncoupled equations of motion that describe the contribution of each mode:
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
M1
...
Mi
...
Mn
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
¬®q1(t)
...
¬®qi(t)
...
¬®qn(t)
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
+
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
K1
...
Ki
...
Kn
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
q1(t)
...
qi(t)
...
qn(t)
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
=
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
œÜT
1 F(t)
...
œÜT
i F(t)
...
œÜT
nF(t)
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
, (3.114)
with Mi = œÜ‚ä∫
i MœÜi and Ki = œÜ‚ä∫
i KœÜi.
For the ith modal DOF qi(t) the equation of motion equals:
Mi ¬®qi(t)+Kiqi(t) = œÜT
i F(t).
(3.115)
which is a simple second-order diÔ¨Äerential equation similar to that of a single-
mass spring system. Using basic formulae that are derived for a single-mass
spring system, one is now able to analyse the time and frequency response
of all individual modes. Having done that, the total motion of the system
can be obtained by summing the contributions of all modes.
3.3.2.4
Resulting Transfer Function
Characterisation of the dynamics of a mechanical system in terms of fre-
quency response behaviour plays a major role in the stability analysis of the

184
Chapter 3. Dynamics of Motion Systems
 
Fk
+ 
+ 
+
+ 
+ 
+ 
 
 
Figure 3.29: Block diagram representation of transfer function x‚Ñì/Fk with modal
decomposition.
control loop of a mechatronic device. In such an analysis one is typically
interested in the transfer function x‚Ñì/Fk, between a (measured) displacement
of DOF x‚Ñìand an actuator force Fk, acting on a physical DOF xk, which
might be diÔ¨Äerent from the displacement physical DOF x‚Ñì. Applying the
principle of modal decomposition, any transfer function can be derived by
Ô¨Årst calculating the behaviour of the individual modes, and then summing
all modal contributions.
The contribution of one single eigenmode i to the transfer function x‚Ñì/Fk(s)
can be derived by Ô¨Årst considering the response of the modal DOF qi(t) to
a force vector F with only one non-zero component Fk. In that case Equa-
tion (3.115) is reduced to:
Mi ¬®qi(t)+Kiqi(t) = œÜi,kFk(t).
(3.116)
After a Laplace-transformation and some rearrangement, this equation
yields:
qi(s) = Fk(s)
œÜi,k
Mis2 +Ki
.
(3.117)
Once the modal response qi is known, the response of the displacement x‚Ñìis
found by a simple pre-multiplication with œÜi,‚Ñì(see Equation (3.111)), which
Ô¨Ånally leads to the following expression for the contribution of eigenmode i

3.3. Modal Decomposition
185
to the transfer function x‚Ñì/Fk :

 x‚Ñì
Fk

i
(s) =
œÜi,kœÜi,‚Ñì
Mis2 +Ki
[m/N].
(3.118)
The overall transfer function (x‚Ñì/Fk)(s) can be found by summation of the
individual modal contributions, which all have the same structure :
x‚Ñì
Fk
(s) =
n
i=1

 x‚Ñì
Fk

i
=
n
i=1
œÜi,kœÜi,‚Ñì
Mis2 +Ki
[m/N].
(3.119)
It is interesting to note that modal decomposition results in a block dia-
gram description of the mechanics with a parallel structure, as shown in
Figure 3.29. This is diÔ¨Äerent from the usual approach of control engineers
who usually think in terms of transfer functions that are placed in series
and consequently are multiplied with each other. This observation directly
relates to the equations on Page 174 where the multiplicative terms of a
transfer function are converted into additive terms.
3.3.3
Graphical Representation of Mode-Shapes
Equation (3.115) is often represented by a single-mass spring system on
which a force F‚Ä≤(t) = œÜ‚ä∫
i F(t) acts, because of the equivalence with the diÔ¨Äer-
ential equation of a single-mass spring system. This equivalent force F‚Ä≤(t) is
sometimes referred to as the modal force [23]. However, this representation
implies an important loss of information because it neglects all information
about the mode-shape vector. In this section a graphical representation
of modal data will be shown, which is very useful in understanding the
concept of modal decomposition and modal superposition. This graphical
representation of the decoupled ‚Äúmodal‚Äù equation enables the user to ap-
ply the concept of ‚Äúmodal description‚Äù in a more intuitive way. Items such
as the eÔ¨Äective modal mass at a driving point, sensitivity analysis, or the
application of a compensating force in order not to excite a mode, can more
easily be explained.
3.3.3.1
Traditional Representation
First, the graphical approach will be illustrated using an example of a
lumped-mass model, consisting of three masses with intermediate Ô¨Çexibility
as shown in Figure 3.30. For this system, the three mode-shapes are depicted
in the traditional graphical representation, which is found in many textbooks.
In this representation, the degrees of freedom are located at Ô¨Åxed positions

186
Chapter 3. Dynamics of Motion Systems
x
x
x3
1
2
m1
m2 
m3
k1
k2
k3
eigenmode 1
x1
x2
x3
eigenmode 2
 
x1
x2
x3
x1
x2
x3 
eigenmode 3
Figure 3.30: A lumped mass-spring model of three bodies and springs with the
traditional graphical representation of the mode-shapes that belong
to the three eigenmodes of this 6th-order system. The length and
direction of arrow 1,2,3 indicate the magnitude and the phase (sign)
of the mode-shapes of body 1,2,3 in the degree of freedom x(1,2,3). The
connecting lines visualise the mode-shape. The Ô¨Årst eigenmode is
the vibrating movement of the Ô¨Årst three bodies on k3 with only little
deformation of k1 and k2. In the second eigenmode m2 and m3 move
opposite to m1 and with the third eigenmode the middle body moves
opposite to the outer bodies.
and the mode-shape vibration magnitude and phase are indicated by the
length and direction of an arrow.
3.3.3.2
Lever Representation
Alternatively, considering that for each eigenmode the mode-shape vec-
tor deÔ¨Ånes a constant relation or transmission ratio between the various
physical DOF, one could also represent a mode-shape by a lever as shown
in Figure 3.31. Per individual eigenmode i, each degree of freedom xk is
indicated on the lever at a position with respect to the point of rotation
that corresponds to the amplitude and sign of that physical DOF in the
mode-shape vector (= œÜi,k). Systems with no, very little, or proportional,
damping exhibit real mode-shape vectors, and thus the various physical
DOF reach their maximum values at the same moment of the cycle. Con-
sequently, the respective physical DOF can only be in phase or in opposite
phase. All physical DOF on the same side of the rotation point have identical
phases, whereas physical DOF on opposite sides have an opposite phase.
The modal DOF qi(t) can either be interpreted as the angle of the modal

3.3. Modal Decomposition
187
1
a. 
b. 
	i,1 
	i,2 
	i,3
	i,1 
	i,2 
	i,3 
x3
x2
x1
qi
qi
x3
x2
x1
Figure 3.31: New graphical representation of eigenmode i for three degrees of
freedom x(1,2,3). Two equivalent representations can be used. The Ô¨Årst
is shown at the left (a:) with qi as the angle of the lever and at the
right (b:) qi equals the displacement of the lever at a distance "1".
lever (Figure 3.31.a) or as a displacement at a distance "1" from the pivot
point (Figure 3.31.b). In both cases the correct relation between the physical
and modal domain exists. According to Equation (3.111), any physical DOF
xk can be expressed in terms of the modal DOF qi(t) as :
xk(t) =
n
i=1
qi(t)œÜi,k =
n
i=1
xk,i(t)
[m].
(3.120)
Thus the contribution of one single modal DOF qi(t) to the physical DOF
xk(t) is represented by :
xk,i(t) = qi(t)œÜi,k
[m].
(3.121)
In view of the more convenient graphical representation of modal mass
and stiÔ¨Äness, the representation shown in Figure 3.31,b: will be used in all
following sections.
Application of this new approach to the example system leads to the graph-
ical representation shown in Figure 3.32. In the case of a lumped mass
model, as in the previous example, it is possible to indicate at each physical
DOF on the modal lever the corresponding physical mass, as shown at the
left side of Figure 3.33. The resulting mass moment of inertia Ii of the ith
modal lever is then equal to:
Ii =
n
k=1
mkœÜ2
i,k

kgm2
.
(3.122)
This is identical to the modal mass Mi found on the basis of equation (3.107),
because in this example the mass matrix M is a diagonal matrix of physical
masses mk and consequently the expression for the modal mass Mi yields:
Mi = œÜT
i MœÜi =
n
k=1
mkœÜ2
i,k
[kg].
(3.123)

188
Chapter 3. Dynamics of Motion Systems
eigenmode 1
eigenmode 2
eigenmode 3
m1
m2
m3
k1
k2
k3
x1
x2
x3
x3
x2
x1 q1
x1
q2
q3
x1
x3
x3
x2
x2
Figure 3.32: A lumped mass-spring model of three bodies and springs with the new
graphical representation of the mode-shapes that belong to the three
eigenmodes of this 6th-order system.
Due to the diÔ¨Äerence in units, the modal mass Mi could be interpreted as
the resulting mass moment of inertia of the modal lever, or alternatively as
a mass located at a distance of 1 m from the pivot point and this location
corresponds to the position of the modal DOF qi(t) on the modal lever.
The transition from physical masses to modal masses is illustrated in Fig-
ure 3.33 for the second eigenmode of the example system. The modal stiÔ¨Äness
K2 is simply calculated via the relation between natural frequency, mass,
and stiÔ¨Äness:
Ki = œâ2
0,iMi
N/m

.
(3.124)
3.3.3.3
General System
As a starting point, the concept of the ‚Äúmodal lever‚Äù representation has
been introduced in the previous section for a lumped mass model. However,
this is not a premise for its application, and it was only used to facilitate
the link between the modal mass Mi and the physical mass values of the
conÔ¨Åguration. According to Equation (3.115) the motion of the ith modal
co-ordinate qi(t) is governed by:
Mi ¬®qi(t)+Kiqi(t) = œÜT
i F(t).
Here, the modal lever concept will be extended by considering also the eÔ¨Äect
of excitation forces that act on the physical DOF. Interpreting qi and ¬®qi
as the displacement and acceleration at a distance "1" from the rotation

3.3. Modal Decomposition
189
1
	2,3 
x3
x2
x1
q2
	2,2 
	2,1 
m1
m3
m2
x3 q2
x2
x1
Figure 3.33: Graphical representation of the second eigenmode with at the left
the lumped masses and at the right the equivalent modal mass and
stiÔ¨Äness.
point of the lever and locating the modal mass Mi and modal stiÔ¨Äness Ki at
that position, one sees that the equation of motion is represented, provided
that each component Fk of the force vector F is placed at the corresponding
physical DOF on the lever as shown in Figure 3.34.
The scalar product œÜi,kFk of each force component with the corresponding
element of the mode-shape vector can thus be seen as a moment (force times
distance) that acts on the modal lever i or as an equivalent modal force that
acts at the location of qi on the lever. On the basis of this graphical repre-
sentation it is not so diÔ¨Écult to understand the contribution of eigenmode
i to the total transfer function x‚Ñì/Fk(s). According to Equation (3.118) this
 
x 
qi
       
xk 
                                                
xm
1 
	i, 
	i,k 
	i,m 
Fk 
Figure 3.34: Graphical representation of eigenmode i, including the proper location
of the actuator force component Fk that acts on physical DOF xk.

190
Chapter 3. Dynamics of Motion Systems
contribution equals:

 x‚Ñì
Fk

i
(s) =
œÜi,kœÜi,‚Ñì
Mis2 +Ki
[m/N].
Hence, the force Fk must be multiplied by the distance œÜi,k in order to Ô¨Ånd
the equivalent excitation force at the location of qi on the lever, whereas the
resulting modal displacement qi must be multiplied by the distance œÜi,‚Ñìin
order to obtain the displacement of the physical DOF x‚Ñì.
3.3.3.4
User-DeÔ¨Åned Physical DOF
Often, one is not directly interested in the response of one single physical
DOF, but rather in some linear combination of physical DOF. One can think
of the relative displacement between a tool and a work-piece or the relative
displacement between the focus spot of a compact disc module and the track
on the disk, which involves all components of the optical path of the laser
light. This linear combination of physical DOF, which will be called the
‚ÄúUser-DeÔ¨Åned physical DOF‚Äù or ‚ÄúUser DOF‚Äù xu(t), can be written as6:
xu(t) = b1x1(t)+ b2x2(t)+...+ bnxn(t) = bTx(t)
[m].
(3.125)
Similar to a normal physical DOF such a user DOF can be indicated on
the modal lever, as illustrated in Figure 3.35 for a user DOF xu = x3 ‚àí
x2
qi   x3 
xu = x3- x2
	i,u 
Figure 3.35: Graphical representation of eigenmode i including user DOF xu =
x3 ‚àíx2.
6In the case of a one-dimensional model, the deÔ¨Ånition of user DOF is straightforward,
and normally does not cause any trouble. However, if applied to two- or three-dimensional
structures, special attention must be paid to ensure integrity of the user DOF formula.

3.3. Modal Decomposition
191
x2. The location of this user DOF xu(t) with respect to the pivot point
of modal lever i is deÔ¨Åned by œÜi,u, using the same transformation rule
from Equation (3.125) as the user DOF itself, found after substitution of
Equation (3.110) in Equation (3.125):
xu(t) = bTx(t) = bT 
œÜiqi(t) =

bTœÜiqi(t) =

œÜi,uqi(t)
[m],
(3.126)
œÜi,u = bTœÜi.
(3.127)
The dimension of an eigenmode vector found in a numerical analysis is
equal to the number of physical DOF of the simulation model, which can
contain several hundreds or thousands of physical DOF. In an experimental
modal analysis, the dimension can theoretically even be inÔ¨Ånite, because
each point on a structure displays a diÔ¨Äerent behaviour. Still, from a control-
application point of view, only three user DOF are really important (all other
DOF are only important for a better understanding of the nature of a mode).
These three user DOF deÔ¨Åne:
‚Ä¢ The actuation DOF xa, where an eigenmode is excited by the actuator
force.
‚Ä¢ The sensed output xs, the displacement that is measured by the posi-
tion sensor.
‚Ä¢ The performance output, xp, the actual displacement that determines
the accuracy of the system.
These user DOF are closely related to three common control terms that are
deÔ¨Åned in the next chapter, the control force u, the sensed value y and the
real output value of the system x.
To illustrate these user DOF, the schematic representation of a feedback-
controlled positioning system according to the left drawing of Figure 3.36
will be used, which is related to the accuracy of a turning lathe as presented
in Figure 3.1 at the beginning of this chapter. The actual task of this system
is to move a payload with respect to a tool that is mounted to the machine
frame. Consequently, the performance of the machine (indicated by xp) is
determined by the relative motion of these two components. However, direct
measurement of the distance between the tool and the payload is not possible
and therefore the control action is based on the measured distance (indicated
by xs) between a sensor on the frame and the slide on which the payload is
mounted. The slide is driven by an actuator, which transforms the output
of the controller into a force on the slide and a reaction force on the stator.
It is evident that for the excitation of an eigenmode only the result of these

192
Chapter 3. Dynamics of Motion Systems
 
xs
xp
Machine frame
   Stator 
  Slide 
Payload
xa
 
  Sensor 
  Tool 
x
F 
 
 
 
1 
xs
x
p
	i,s
	i,a
qi
	i,p 
a
Fa
x
x
Physical model                                                                          Graphical model
Figure 3.36: Physical and graphical model of a feedback controlled positioning
system, indicating the three most important user DOF.
two forces is relevant. On the basis of either the graphical representation
of Figure 3.34 or the mathematical formulation of Equation (3.116) it is
evident that the resulting excitation level of an eigenmode is determined by
the relative motion xa of the slide with respect to the stator. Therefore, as
long as one is not interested in the details of an eigenmode the dynamics of
an eigenmode can completely be described by only three user DOF as shown
at the right graph of Figure 3.36:
‚Ä¢ xs, equal to xslide ‚àíxsensor.
‚Ä¢ xp, equal to xpayload ‚àíxtool.
‚Ä¢ xa, equal to xslide ‚àíxstator.
which can easily be constructed from the contributions of the physical DOF
as already illustrated in Figure 3.35.
Basically, the three values œÜi,s, œÜi,p and œÜi,a plus the modal mass, stiÔ¨Äness
and damping are suÔ¨Écient to describe the contribution of eigenmode i to the
dynamics of the controlled positioning system, both in terms of frequency
response and time response.

3.3. Modal Decomposition
193
3.3.4
Physical Meaning of Modal Parameters
As mentioned in the beginning of Section 3.3.2, the mathematical approach
of the scaling procedure of mode-shapes and modal parameters sometimes
obscures the physical meaning of modal mass and modal stiÔ¨Äness. This
mystiÔ¨Åcation is clearly emphasised by the fact that the value of each of
these quantities depends on the scaling procedure that is applied to the
mode-shape vector. As shown in Section 3.3.1 there is a link to the ‚Äúreal
world‚Äù i.e. the real mass [kg] and stiÔ¨Äness [N/m] of the system one is dealing
with. This link to the real world was found via the eÔ¨Äective modal mass and
eÔ¨Äective modal stiÔ¨Äness of an eigenmode as it is perceived at a certain point
and direction (= physical DOF) of the mechanical structure. These quanti-
ties are unique for the location where the force is applied, do not depend
on the scaling procedure, and have physical meaning and physical units.
Independent of the way in which the mode-shape vectors are normalised,
one can always Ô¨Ånd an equivalent representation based on the eÔ¨Äective
modal mass and stiÔ¨Äness as perceived in a certain DOF like the user DOF
xa where the actuator is acting, as shown in Figure 3.37.
The eÔ¨Äective modal parameters of eigenmode i in physical DOF xa can be
derived from the modal parameters via the following equation, which is
based on energy equivalence:
Meff.i,a = Mi
œÜ2
i,a
[m].
and
Keff.i,a = Ki
œÜ2
i,a
N/m

.
(3.128)
 
xs
qi       xa                                                       xp  
1 
	i,s 
	i,a 
	i,p
xs 
qi       xa                                                       xp  
1 
	i,s 
	i,a
	i,p 
 
Fa 
Fa
x
Figure 3.37: Transformation of modal parameters into eÔ¨Äective modal values in
user DOF (xa) where the actuator is acting. At this position the values
have a real physical meaning.

194
Chapter 3. Dynamics of Motion Systems
These eÔ¨Äective modal parameters can be used very eÔ¨Äectively in understand-
ing topics such as the sensitivity analysis of the following Section 3.3.5, or
in constructing the frequency response xs/Fa of a complex system from the
knowledge of modal contributions.
The eÔ¨Äective values will be further explained by two examples, a two-body
mass spring system and a planar moving system with a Ô¨Çexible guiding.
3.3.4.1
Two-Body Mass-Spring System
The two-body mass-spring system of Figure 3.38 is diÔ¨Äerent from the pre-
viously presented free Ô¨Çoating example of Figure 3.22 because of its stiÔ¨Ä
connection to the stationary reference. From the following analysis it will
become clear that the rigid-body mode with an eÔ¨Äective modal mass equal
to the total mass of the two bodies no longer exists.
The analysis starts with deriving the eigenvalues of this system without
external forces:
M ¬®x(t)+Kx(t) =

m1 0
0 m2
	
¬∑

¬®x1(t)
¬®x2(t)
	
+

k1 + k2 ‚àík2
‚àík2
k2
	
¬∑

x1
x2
	
= 0.
(3.129)
The eigenvalue analysis of this system by appropriate mathematical compu-
tational tools using the values of the parameters from Figure 3.38, leads to
the modal results given in Table 3.2 and which are graphically represented
in Figure 3.39. In the case of this lumped-element system, the modal masses
M1 and M2 can be derived from the corresponding mode-shape vectors and
the physical masses m1 and m2:
M1 = œÜT
1 MœÜ1 = m1œÜ2
1,1 + m2œÜ2
1,2 = 100¬∑0.672 +10¬∑0.742 = 50.8 kg,
M2 = œïT
2 MœÜ2 = m1œÜ2
2,1 + m2œÜ2
2,2 = 100¬∑(‚àí0.11)2 +10¬∑0.992 = 11.1 kg.
whereas the modal stiÔ¨Äness values follow from Ki = œâ2
i Mi.
From these
results, the eÔ¨Äective modal parameters for each eigenmode perceived at
each individual physical DOF7, can be derived.
For Mode 1:
Meff.1,1 = 50.8
0.672 = 112 kg,
Keff.1,1 = 0.46¬∑107
0.672
= 1.02¬∑107 N/m,
Meff.1,2 = 50.8
0.742 = 92.8 kg,
Keff.1,2 = 0.46¬∑107
0.742
= 0.84¬∑107 N/m.
7These are the eÔ¨Äective values when actuating with a force on these physical DOF. It does
not represent the non-collocated motion of each physical DOF when actuating on another
physical DOF as will be shown later.

3.3. Modal Decomposition
195
x
 
x2
 
107 N/m 
107 N/m 
10 kg
 
100 kg
 
Body 1
Body 2
m
1
k
m
2
1k
2
1
Figure 3.38: Two-body mass-spring system.
For Mode 2:
Meff.2,1 =
11.1
(‚àí0.11)2 = 928 kg,
Keff.2,1 = 1.23¬∑107
(‚àí0.11)2 = 1.02¬∑109 N/m,
Meff.2,2 = 11.1
0.992 = 11.2 kg,
Keff.2,2 = 1.23¬∑107
0.992
= 1.25¬∑107 N/m.
When looking at these values a Ô¨Årst observation can be made on the eÔ¨Äective
modal mass Meff.1,1 of the Ô¨Årst eigenmode at the movement of the Ô¨Årst body
x1, which is slightly higher than the combined mass of both bodies. This
is the Ô¨Årst diÔ¨Äerence with the situation of the free Ô¨Çoating bodies from
the earlier example where Meff.1,1 was equal to the combined mass. This
diÔ¨Äerence is caused by the increased perceived mass of the second body due
to the larger movement of that second body at the eigenfrequency of the Ô¨Årst
eigenmode. With the free Ô¨Çoating system the related eigenfrequency was
0 Hz so the accelerations and forces at that frequency are also zero and the
connecting spring is not deforming, truly acting as a rigid body. With the
Table 3.2: Modal results corresponding to the two-body mass-spring system of
Figure 3.38. The scaling of the eigenvectors is based on
''œÜi
'' = 1.
Mode 1
Mode 2
Eigenfrequency [Hz]
f0,1 = 47.8
f0,2 = 168
Eigenvector [-]
œÜT
1 = [0.67 0.74]
œÜT
2 = [‚àí0.11 0.99]
Modal mass [kg]
M1 = 50.8
M2 = 11.1
Modal stiÔ¨Äness [N/m]
K1 = 0.46¬∑107
K2 = 1.23¬∑107

196
Chapter 3. Dynamics of Motion Systems
q1       x2   x1 
1 = 50.8 kg 
1 = 0.46  107 
1 
0.67 
0.74 
mode 1 
q1   x2                                           
x1 
2= 11.1 kg 
2 = 1.23  107 N/m 
1 
0.11 
0.99 
mode 2 
.
.
N/m
x
x
Figure 3.39: Graphical representation of eigenmodes and modal parameters of the
two-body mass-spring system.
stiÔ¨Äconnection to the stationary reference, the eigenfrequency and acceler-
ations are much diÔ¨Äerent than zero causing the connecting spring between
the bodies to deform, resulting in a higher magnitude of the movement of
the second body at the Ô¨Årst eigenmode. The magnitude ratio is equal to
the ratio between the eigenvector values for the movements of the second
body (0.74) and the Ô¨Årst body (0.67). This higher magnitude for the second
body also implies higher accelerations and forces causing the higher than
proportional contribution to the eÔ¨Äective modal mass at the Ô¨Årst body.
With the second eigenmode this eÔ¨Äect is even larger. From the earlier ex-
ample it was already shown that this eigenmode is characterised by an
opposite movement of the bodies, where the body with the largest mass
moves the least, corresponding to an eigenvector value of -0.11 relative to
the eigenvector value for the second body (0.99). As a result, the eÔ¨Äective
modal mass and stiÔ¨Äness at the Ô¨Årst body are extremely large, which means
that the compliance related to this second eigenmode is small. This also
complies with the Ô¨Åndings of the earlier example where Equation (3.99)
would result in a similar extreme high eÔ¨Äective modal mass value of the
second eigenmode to the movement of the Ô¨Årst body.
As an alternative to Figure 3.39, which is based on the modal mass and stiÔ¨Ä-
ness for a given choice of scaling, one can for example also use the eÔ¨Äective
modal parameters in the physical DOF x1 in the graphical representation.
This is shown in Figure 3.40.
Based on this representation it is quite straightforward to construct the
individual modal contributions to the frequency response function x1/F1(f ) of

3.3. Modal Decomposition
197
q1       x2   x1 
 112 kg 
1 
0.67 
0.74 
mode 1 
q1   x2                                           
x1 
    928 kg 
eff.2,1
      = 1.02  10
9
 
N/m
1 
0.11 
0.99 
mode 2 
.
eff.1,1
     = 1.02 10
7
 
N/m
.
eff.1,1
eff.2,1= 
= 
x
x
Figure 3.40: Alternative graphical representation of eigenmodes of the two-body
mass-spring system based on the eÔ¨Äective modal mass and stiÔ¨Äness
in physical DOF x1.
the example system and to derive the overall response from those separate
responses, as shown at the left side of Figure 3.41.
Concentrating on the modal contributions Ô¨Årst, one can observe that indeed
the low-frequency part of each modal contribution (x1/F1)i corresponds to
the inverse of the calculated eÔ¨Äective modal stiÔ¨Äness at physical DOF x1:

 x1
F1

1,f ‚Üí0
=
1
Keff.1,1
‚âà1¬∑10‚àí7 m/N,

 x1
F1

2,f ‚Üí0
=
1
Keff.2,1
‚âà1¬∑10‚àí9 m/N.
whereas the high-frequency contribution is deÔ¨Åned by the eÔ¨Äective modal
mass. In the Ô¨Ånal Bode plot of Figure 3.41.a one can observe the same
interference of the two modal contributions in the frequency range of the
second natural frequency, leading to a combination of an anti-resonance
(two zeros) and a resonance (two poles) as was shown in Figure 3.28 of the
earlier example. To construct the frequency response of the non-collocated
second body location x2 on a force acting on x1, the transfer functions of
the eigenmodes only need to be corrected for the ratio of the eigenvector
values, leading to Figure 3.41.b. Also this result is fully comparable with
the earlier example with a -4 slope above the second eigenfrequency caused
by the decoupling of the second body.

198
Chapter 3. Dynamics of Motion Systems
 
 
 
10
z,{
10
z¬Ö
10
z¬Ü
10
z¬Ñ
10
z¬É
10
z¬Å
a: Body 1
Compliance [m/N]
10
1
10
2
10
3
z[¬É{
z,¬Ü{
0
Phase [deg]
Frequency [Hz]
 
 
 
10
z,{
10
z¬Ö
10
z¬Ü
10
z¬Ñ
10
z¬É
10
z¬Å
b: Body 2
 
 
Eigenmode 1
Eigenmode 2
Total system
10
1
10
2
10
3
z[¬Ñ{
z,¬Ü{
0
Frequency [Hz]
Figure 3.41: Bode plot showing the frequency response of the two modal contri-
butions to the position of the Ô¨Årst body (x1/F1) and the second body
(x2/F1).
3.3.4.2
Planar Flexibly Guided System
With the second example it is shown that the eÔ¨Äective modal mass and
stiÔ¨Äness, referenced to a certain point on the dynamic structure, can often
be directly derived by straightforward reasoning. The planar actuator with
guiding system Ô¨Çexibility as shown in Figure 3.42 is a physical model for
a moving body supported by an airbearing with a limited stiÔ¨Äness. The
Ô¨Çexibility of the bearing is modelled by two parallel linear springs with stiÔ¨Ä-
ness k connected to the stationary reference by means of a sliding support,
which can move over a stationary reference in the x direction. The system
has three physical DOF, a translational physical DOF x in the direction of
movement, a translational physical DOF y perpendicular to the reference
and a rotational DOF Rz around the orthogonal axis z through the centre

3.3. Modal Decomposition
199
of mass Z, located symmetrically between the two supports. Therefore the
physical DOF of this system are completely decoupled if only small rotations
are considered. The eigenmodes consist of a rigid-body movement in the
x direction, a pure vertical eigenmode, and a pure rotational eigenmode
around the centre of mass. The schematic representation of these three
eigenmodes and the corresponding x motion of the points Z, O, A, and B,
plus the y motion of point Z, are indicated in Figure 3.43. The eÔ¨Äective
modal mass and stiÔ¨Äness values of eigenmodes 1 and 3 are referenced to xB.
For eigenmode 2 the eÔ¨Äective modal mass and stiÔ¨Äness is referenced to yZ,
because this eigenmode displays zero displacement in the x direction.
The eÔ¨Äective modal mass of eigenmode 1 in xB is equal to the total mass m,
because this mass m moves over a straight line when one applies a force
in point B in the x direction. The response of eigenmode 3 to the same
actuation force in B is diÔ¨Äerent, because the body rotates around Z giving
a motion amplitude, which depends on the distance from Z. The resulting
eÔ¨Äective modal mass Meff,3,xB depends on the mass moment of inertia J and
the distance from Z to B. As already mentioned, for eigenmode 2 the eÔ¨Äective
modal parameters have been calculated with respect to yZ. Following the
same reasoning as was done for Meff,1,xB, one Ô¨Ånds that the eÔ¨Äective modal
mass referenced to yZ is equal to the total mass m. Calculating the eÔ¨Äective
modal mass and stiÔ¨Äness of eigenmode 2 referenced to xB leads to inÔ¨Ånite
values, because the x motion of point B is equal to zero, leading to division
by (zero)2 when calculating the values. This is in correspondence to the
fact that eigenmode 2 cannot be excited by a force in point B acting in the x
direction.
2 b 
m = mass
J  = mass moment of inera at Z
 
 
              
x 
y 
 
Z
k
k
m, J 
0.5 a 
0.5 a 
B 
A 
O 
Rz
2 a 
Figure 3.42: Two dimensional model of a planar moving object with guiding system
Ô¨Çexibility.

200
Chapter 3. Dynamics of Motion Systems
 mode 2
  yZ
 
 
k 
x 
k
y 
B 
A 
O 
Z 
= J/a
 = 2kb/a 
 mode 3 
xB              xA
 
 
k 
x 
k 
y 
B 
A 
O 
Z 
 
 
xB = xA = xO = xZ
                  yZ 
 mode 1
x 
k 
y 
B 
A 
O 
k 
Z 
2 a 
Rz
Rz
Rz
0.5 a 
0.5 a 
2 b 
2
2
 = 2k
 = 0
 = m
= m
e`,1,x
2
xB = xA = xO = xZ
        
xO = xZ = yZ
B
B
e`,1,x
e`,2,yZ
e`,2,yZ
B
e`,3,x
B
e`,3,x
Figure 3.43: The three eigenmodes of the planar moving object with guiding system
Ô¨Çexibility as introduced in Figure 3.42.

3.3. Modal Decomposition
201
3.3.5
A Pragmatic View on Sensitivity Analysis
Sometimes it is required to change the dynamic properties of a system, for
example to avoid a resonance or to add more damping. In such a situation
it is useful to know how to modify the system so as to bring about the
desired change. Sensitivity analysis, which has become a standard selling
feature in modern experimental and numerical modal analysis tools, helps
to determine the rate of change of each natural frequency with each of the
system parameters. It typically provides answers to questions such as:
‚Ä¢ Where should one reduce mass in order to achieve the most signiÔ¨Åcant
gain in natural frequency?
‚Ä¢ Between which two points of a structure should one add extra stiÔ¨Äness
to increase the natural frequency?
The technique furthermore gives an indication of the amount of frequency
shift that can be obtained.
In an attempt to de-mystify the mathematics of this approach [72,93,94],
which is normally based on a form of perturbation technique, one comes
to the conclusion that common sense and a sound understanding of the
concept of eÔ¨Äective modal mass and stiÔ¨Äness is the key to a pragmatic view
on sensitivity analysis. Starting point in this non-mathematical approach
is again the modal lever representation of an eigenmode as shown in Fig-
ure 3.44. Assuming that one is asked to increase the natural frequency
of this eigenmode by attaching a linear spring between any two DOF (for
simplicity only three physical DOF are indicated on the lever) it does not
take an expensive modelling tool to conclude that the relative motion be-
tween xA and xB is the largest of all possible combinations. As a consequence
xA 
qi
xC 
xB
k

x
x  -
A xB
Figure 3.44: Graphical representation of an eigenmode with three physical DOF xA,
xB and xC with an additional stiÔ¨Äness Œîk connected between physical
DOF xA and xB.

202
Chapter 3. Dynamics of Motion Systems
the eÔ¨Äectiveness of an additional spring k between these two DOF is the
highest, because it gives the maximum contribution to the potential energy
when rotating the lever. In the Ô¨Ågure this additional spring between the
two physical DOF xA and xB is modelled as a spring between an additional
point xA ‚àíxB on the lever and the stationary reference, which is equivalent
in respect to the potential energy. Very much in line with this concept is the
idea of considering the kinetic and potential energy distribution of a system
over its inertias and connecting Ô¨Çexibilities. For every modal deformation
pattern, the relative contribution of the various components and connectors
to the modal kinetic and potential energy can be calculated. If one has to
increase the frequency of an eigenmode, one should focus on stiÔ¨Äening those
components or connections with the highest contribution to the modal po-
tential energy. On the other hand, components that contribute signiÔ¨Åcantly
to the modal kinetic energy are serious candidates for mass reduction. A
Ô¨Årst-order approximation of the new natural frequency of eigenmode i can
be derived by considering the eÔ¨Äective modal mass and stiÔ¨Äness of that
eigenmode in the relevant DOF. In the case of an extra mass Œîm in DOF xk,
the eÔ¨Äective modal mass Meff,i in that DOF is required, whereas in the case
of an additional spring Œîk between two DOF xk and x‚Ñìone has to compare
the contribution of Œîk to the eÔ¨Äective modal stiÔ¨Äness Keff,i in the user DOF
(xk ‚àíx‚Ñì). With an additional mass8 the new natural frequency of eigenmode
i will approximately be equal to:
f0,new,i ‚âà1
2œÄ

Keff,i
Meff,i +Œîm ‚âà1
2œÄ

Keff,i
Meff,i

Meff,i
Meff,i +Œîm
‚âàf0,old,i

Meff,i
Meff,i +Œîm
[Hz].
(3.130)
And with an additional stiÔ¨Äness Œîk the eigenfrequency will change as fol-
lows:
f0,new,i ‚âà1
2œÄ

Keff,i +Œîk
Meff,i
‚âà1
2œÄ

Keff,i
Meff,i

Keff,i +Œîk
Keff,i
(3.131)
‚âàf0,old,i

Keff,i +Œîk
Keff,i
[Hz].
(3.132)
These equations are derived on the basis of the assumption that the modes
do not change as a result of the applied structural modiÔ¨Åcation. In general,
this assumption is not true, but as long as the modiÔ¨Åcations remain small
compared to the corresponding eÔ¨Äective modal parameter the predicted
8In case of a mass reduction Œîm will be a negative number.

3.3. Modal Decomposition
203
natural frequencies will be accurately enough for engineering purposes.
Even if relatively large structural modiÔ¨Åcations are involved, in which case
the approach will not predict the modiÔ¨Åed eigenfrequencies reliably, it is
still very useful to rank various proposed design modiÔ¨Åcations.
With two examples this method will be further clariÔ¨Åed.
3.3.5.1
Example of Two Body Mass-Spring System
The simple example of a two-mass spring system (Figure 3.45), which was
already discussed in Section 3.3.4.1 will be used to illustrate the approach.
First, the frequency shift due to an extra mass at physical DOF x2 will be
investigated, then the inÔ¨Çuence of an additional spring between x2 and x1
will be shown.
Additional mass at x2
In order to analyse the eÔ¨Äect of an extra mass at x2, the eÔ¨Äective modal
mass at that DOF needs to be known for both modes. Recalling the results
from Section 3.3.4.1:
Eigenmode 1 : Meff.1,2 = 92.8 kg,
Eigenmode 2 : Meff.2,2 = 11.2 kg.
With these values one can estimate the new natural frequencies on the
basis of Equation (3.130) and compare the results to the exact results of an
eigenvalue analysis of the modiÔ¨Åed system:
 
x1 
x2 
107 N/m 
107 N/m 
10 kg
 
100 kg
 
Body 1
Body 2
Figure 3.45: Two-body mass-spring system with the modal parameters according
to a scaling of
''œÜi = 1
''.

204
Chapter 3. Dynamics of Motion Systems
q1       x2   x1 
0.07 
1 
0.67 
0.74 
 Mode 1 
 
x2-x1  
q1   x2                                           x1 
1 
0.11 
0.99 
 Mode 2 
  x2-x1 
1.1 
1 = 50.8 kg 
1 = 0.46  107 
2= 11.1 kg 
2 = 1.23  107 N/m 
x
N/m
Figure 3.46: Graphical representation of modes and modal parameters of two-body
mass-spring system.
Additional mass Œîm = 1 kg added to m2
f0,1 = 47.8
4
92.8/93.8 = 47.5 Hz (exact result: 47.5 Hz),
f0,2 = 167.7
4
11.2/12.2 = 160.7 Hz (exact result: 160.7 Hz).
Additional mass Œîm = 10 kg added to m2
f0,1 = 47.8
4
92.8/102.8 = 45.4 Hz (exact result: 45.2 Hz).
f0,2 = 167.7
4
11.2/21.2 = 121.9 Hz (exact result: 125.2 Hz).
Additional stiÔ¨Äness between x1 and x2
To estimate the inÔ¨Çuence of an additional stiÔ¨Äness between two physical
DOF x1 and x2, one needs to calculate the eÔ¨Äective modal stiÔ¨Äness that
corresponds to the relative motion between these physical DOF. As already
explained in Section 3.3.3.4, the concept of modal levers can be extended
to any linear combination of physical DOF. Therefore, one can extend the
graphical representation of the two modes with the relative motion x2 ‚àíx1,
as indicated in Figure 3.46.
From this graphical representation it is now very easy to derive the eÔ¨Äective
modal stiÔ¨Äness at the newly deÔ¨Åned user DOF. This is done in precisely the

3.3. Modal Decomposition
205
same way as for any ordinary physical DOF:
Eigenmode 1 :Keff.1,(2‚àí1) = 0.46¬∑107/0.072 = 93.9¬∑107 N/m,
Eigenmode 2 :Keff.2,(2‚àí1) = 1.23¬∑107/1.12 = 1.0¬∑107 N/m.
On the basis of these values and Equation (3.131) the eÔ¨Äect of additional
stiÔ¨Äness between x2 and x1 will be estimated and compared to the exact
results:
Additional stiÔ¨Äness Œîk = 107 N/m added between x2 and x1
f0,1 = 47.8
4
94.9/93.9 = 48.1 Hz (exact result: 47.9 Hz),
f0,2 = 167.7
4
2/1 = 237.2 Hz (exact result: 236.6 Hz).
Additional stiÔ¨Äness Œîk = 108 N/m added between x2 and x1
f0,1 = 47.8
4
103.9/93.9 = 50.3 Hz (exact result: 48 Hz),
f0,2 = 167.7
4
11/1 = 556.2 Hz (exact result: 553.9 Hz).
As can be seen from this example, the very pragmatic approach to sensitivity
analysis without too much emphasis on the mathematical treatment yields
acceptable Ô¨Årst-order approximations of the new natural frequencies after
a modiÔ¨Åcation. As it is only an approximation and not a complete new
eigenvalue analysis, the results are better for small changes as compared to
the eÔ¨Äective modal parameters. Yet, even if the modiÔ¨Åcations are signiÔ¨Åcant,
the approach provides a quick scan of the eÔ¨Äect in terms of frequency shift
that can be expected from a certain design modiÔ¨Åcation.
3.3.5.2
Example of Slightly Damped Resonance
In a high precision machine a very slightly damped resonance was found
around 150 Hz, which resulted in a serious limitation of its performance. A
further improvement in terms of additional stiÔ¨Äness or reduced mass was
not possible, so the addition of a damper between two well-chosen points
of the machine was considered. Having done experimental modal analysis
to identify the corresponding mode-shape, it was clear where to locate the
damper. The main question was how much eÔ¨Äect, in terms of maximum
relative damping after addition of the damper, was to be expected. Us-
ing the results of the experimental modal analysis, the maximum eÔ¨Äect
of the damper can easily be estimated although in reality the eÔ¨Äect will
be less because the addition of the damper will also have an inÔ¨Çuence on

206
Chapter 3. Dynamics of Motion Systems
0.003 
q                            x2-x1     x2                                           
x1      
 = 8.8*105 N/m 
     = 1 kg 
1 
0.009 
0.012 
c = 3000 Ns/m 
x
Figure 3.47: Modal data of 150 Hz eigenmode for the estimation of the eÔ¨Äect of a
damper between DOF x2 and x1.
the mode-shape. Next to the damper properties, the only data required for
this purpose is the modal mass and stiÔ¨Äness, plus the modal displacements
of the two points (x2 and x1) between which the damper will be added as
indicated in Figure 3.47.
The relative damping of the eigenmode as a result of the additional damper
c can be approximated on the basis of the eÔ¨Äective modal properties in
the user-deÔ¨Åned DOF (x2 ‚àíx1), which corresponds to the relative displace-
ment between the damper connection points. The eÔ¨Äective modal mass and
stiÔ¨Äness in the user DOF (x2 ‚àíx1) are equal to:
Meff = 1/(0.012)2 = 6944 kg,
Keff = 8.8¬∑105/(0.012)2 = 6.1¬∑109 N/m.
Using these values, the resulting relative modal damping ratio Œ∂ can be
found:
Œ∂ =
c
2
4
KeffMeff
=
3000
2

6944¬∑6.1¬∑109 = 1.5¬∑10‚àí3.
Often such low values of damping are expressed in percentages (in this
case 0.15 %) indicating the almost negligible values that are often found
in practical constructions. The damping values for a construction in which
no special damping measures have been taken range between 0.1 ‚Äì 2 %
(500 > Q > 25). The main reason for this disappointing low value in this
example is the huge eÔ¨Äective mass and stiÔ¨Äness that is present at the user
DOF (x2 ‚àíx1) where the damper is connected to the system.

3.3. Modal Decomposition
207
3.3.6
Suspension and Rigid-Body Modes
The fact that the automotive and aeronautic industries have played a domi-
nant role in the development of the concept of modal analysis is also reÔ¨Çected
in some of the terminology that is being used in modal studies.
A rocket or an aeroplane in Ô¨Çight will possess rigid-body modes, which are
entirely determined by the mass properties as no stiÔ¨Äness connection is
present to any reference like the earth and in which there is absolutely
no deformation of the structure at its eigenfrequency of 0 Hz. All other
eigenmodes are then non-rigid or Ô¨Çexible, which seems to be a clear distinc-
tion. However, this terminology is also used when considering the lowest
natural frequencies of a machine or product that are related to the Ô¨Çexibility
of the suspension system. In such a situation the term ‚Äúrigid-body mode‚Äù
misleadingly suggests that the structure exhibits no internal deformation
at the eigenfrequency of the suspension, which is an erroneous assump-
tion for a precision machine. A better term for such an eigenmode would
be suspension mode, because it expresses the main characteristics of the
eigenmode without the misleading suggestion that the machine behaves as
a rigid body. To illustrate the importance of the internal deformation a very
simpliÔ¨Åed physical model of a precision machine will be considered. This is
graphically represented in Figure 3.48.
The machine basically consists of a very heavy granite machine frame to
which an optical unit is rigidly connected (combined mass equals m2). The
optical unit takes images of a specimen, which is mounted on a manipulator
(mass m1) with a certain internal Ô¨Çexibility with respect to the granite
machine frame. For a proper operation of the machine, the internal de-
formation Œµ = x2 ‚àíx1 needs to be minimised. Typically, such a machine is
designed for a high internal stiÔ¨Äness and it is furthermore supported on low
stiÔ¨Äness springs in order to prevent external vibrations from entering the
machine, thereby reducing its accuracy. Assuming that the eigenfrequency
œâ0,1 of the suspension mode œÜ1 is signiÔ¨Åcantly lower than that of the internal
eigenmode, one can approximate the eigenfrequency of the suspension mode
by considering the motion of the entire machine as one rigid body on the
stiÔ¨Äness of the suspension system. This approach evidently leads to a correct
estimate of the suspension frequency, but one should keep in mind that
there is always a small amount of internal deformation in case of a non-zero
suspension stiÔ¨Äness k2,0. This can be demonstrated quite straightforwardly
by considering the unforced equations of motion of the system:

m1 0
0 m2
	
¬®x1
¬®x2
	
+

k1,2
‚àík1,2
‚àík1,2 k2,0 + k1,2
	
x1
x2
	
= 0.
(3.133)

208
Chapter 3. Dynamics of Motion Systems
 
 
x2
m2   (machine frame) 
k2,0 
  
           
m1
x1 
k1,2 
Opcal Unit 
 Opcal Unit 
(manipulator)
Figure 3.48: SimpliÔ¨Åed physical model of a precision machine.
or, written as an eigenvalue problem:

‚àíœâ2m1 + k1,2
‚àík1,2
‚àík1,2
‚àíœâ2m2 + k2,0 + k1,2
	
x1
x2
	
= 0.
(3.134)
Both modes must satisfy Equation (3.134). Assuming that the suspension
mode with œâ0,1 is free of internal deformation, the modal displacement of x1
and x2 would be identical (and consequently œÜT
1 = |1,1|)9. Substituting this
vector in the left-hand side of Equation (3.134) leads to:

‚àíœâ2
0,1m1 + k1,2
‚àík1,2
‚àík1,2
‚àíœâ2
0,1m2 + k2,0 + k1,2
	 
1
1
	
=

‚àíœâ2
0,1m1
‚àíœâ2
0,1m2 + k2,0
	
= 0. (3.135)
This equation can only be satisÔ¨Åed if the suspension stiÔ¨Äness k2,0 and the
eigenfrequency œâ0,1 of the suspension mode are both equal to zero. In other
words, if the suspension stiÔ¨Äness is unequal to zero, the eigenfrequency
of the suspension mode will be non-zero, and there will be internal defor-
mation. The amount of internal deformation that is associated with the
suspension mode can be found straightforward by assuming that the suspen-
sion mode vector is equal to œÜ‚ä∫
1 = |(1+Œµr),1|, with Œµr = œµ/x2 representing the
relative internal deformation referenced to the motion of x2. Substitution
in Equation (3.134) results in:

‚àíœâ2
1m1 + k1,2
‚àík1,2
‚àík1,2
‚àíœâ2
0,1m2 + k2,0 + k1,2
	 
1+Œµr
1
	
=

‚àíœâ2
0,1m1 + k1,2Œµr
‚àíœâ2
0,1m2 + k2,0 ‚àík1,2Œµr
	
= 0.
(3.136)
9Only the direction, but not the length, of the mode-shape vector is uniquely deÔ¨Åned,
therefore a convenient choice has been made (see also Section 3.3.2).

3.3. Modal Decomposition
209
The internal deformation associated with the suspension mode can now be
found from the Ô¨Årst part of Equation (3.136) and amounts to :
Œµ = Œµrx2 = œâ2
0,1
m1
k1,2
x2 =
œâ2
0,1
œâ2
0,int
x2 [m],with: œâ0,int =

k1,2
m1
rad/s

.
(3.137)
œâ0,int represents the eigenfrequency of the manipulator eigenmode where
the machine frame is approximated as being clamped or inÔ¨Ånitely heavy.
Equation (3.137) implies that the internal deformation associated with the
suspension mode depends on the ratio of the eigenfrequencies of suspension
mode and relevant internal eigenmodes. The larger the natural frequency
of the internal mode compared to the suspension mode, the smaller the
internal deformation.
The equation also conÔ¨Årms the previous made statement that the internal
deformation associated with the suspension mode can only be zero when
the eigenfrequency of that mode equals zero.
It is worthwhile mentioning that Equation (3.137) can also be derived in a
more intuitive way in line with the relation between stiÔ¨Äness and precision
as presented in Section 3.1.1.
The internal deformation can be considered as a quasi-static deformation
due to the acceleration forces imposed on the manipulator during a vibration
of the entire machine at the suspension frequency œâ0,1. During such a
vibration an acceleration force needs to be transferred from the base frame
to the manipulator in order to make the manipulator follow the motion x2
of the base frame.
As explained there, the resulting internal deformation is found from this
force Fb to accelerate the body of the manipulator and the internal stiÔ¨Äness
k1,2:
Œµ = Fb
k1,2
[m],
and
Fb = m1 ¬®x2 = m1œâ2
0,1x2
[N],
‚áí
(3.138)
Œµ =
m1œâ2
0,1
k1,2
x2 =
œâ2
0,1
œâ2
0,int
x2
[m].
(3.139)
As one can see, this engineering approach yields the same results as found
in Equation (3.137).
As an example of a situation in which the internal deformation associated
with the suspension mode is of signiÔ¨Åcant importance, one could consider a
high-precision machine, such as an electron microscope that is excited by
Ô¨Çoor vibrations, such that it vibrates on its suspension with an amplitude
of 10Œºm at a frequency of 3 Hz.

210
Chapter 3. Dynamics of Motion Systems
Assuming that the internal frequency of the manipulator is equal to 150 Hz,
the internal deformation of the machine can be calculated from Equa-
tion (3.137):
Œµ =
32
1502 10¬∑10‚àí6 = 4¬∑10‚àí9
[m].
This 4 nm might seem to be negligibly small, but not in high-precision
applications, such as waferscanners or electron microscopes, in which one
is aiming at resolutions in the sub-nanometre range.
3.3.6.1
Quasi Rigid-Body Suspension mode
Figure 3.49 shows a special conÔ¨Åguration where the suspended dynamic
system consists of two bodies connected by a spring, suspended by two other
springs. This conÔ¨Åguration is special, because it can have a suspension
mode with a non-zero Hz eigenfrequency without internal deformation of
the suspended system with equal terms in the eigenvector œÜi.
Using Equation (3.105) with œÜi =
6
1,1
7‚ä∫
the following expression is obtained:
,
k1 + k2
‚àík2
‚àík2
k2 + k3
	
‚àíœâ2
0,i

m1 0
0 m2
	-
1
1
	
= 0,
=‚áí

k1 + k2 ‚àíœâ2
0,im1
‚àík2
‚àík2
k2 + k3 ‚àíœâ2
0,im2
	
1
1
	
= 0,
=‚áí

k1 ‚àíœâ2
0,im1
k3 ‚àíœâ2
0,im2
	
= 0.
(3.140)
This means that the suspended dynamic system of two bodies behaves like
a rigid body at œâ0,i when the following condition is met:
œâ2
0,i = k1
m1
= k3
m2
rad/s

=‚áí
k1m2 = m1k3.
(3.141)
In real systems such conditions are never perfectly met, for which reason
real rigid-body modes are only related to the 6 degrees of freedom of a free
Ô¨Çoating object with 0 Hz eigenfrequency.
m
m
k1
1
k2
k3
2
Figure 3.49: Two-body mass-spring system with three springs.

3.4. Mechanical Frequency Response
211
3.4
Mechanical Frequency Response
3.4.1
Multiple eigenmodes
Real mechanical structures as applied in mechatronic positioning systems
consist of many parts, integrated into a complex system, exhibiting an in-
Ô¨Ånite number of eigenmodes. The observed resonances correspond to the
multi-dimensional deformations of the body itself, like shown for instance
in Figure 3.50. In such cases Ô¨Ånite element modelling of the mechanical
system dynamics with software like ANSYS is necessary to determine the
eigenfrequencies and mode-shapes of each eigenmode before manufactur-
ing and determine whether the design in good enough thus that it can be
released. Such an analyis could result in a set of Bode plots like shown
in Figure 3.51, which give the modelled frequency response between the
six Cartesian actuation forces and the six Cartesian motion directions of
a mechanical system. The phase plots are not shown but when necessary
they can also be determined. After manufacturing, the practical veriÔ¨Åca-
tion of the Ô¨Årst prototype is done with a method called experimental modal
Figure 3.50: One of several mode-shapes of a non-rigid body as calculated by means
of Finite Element Modelling software, which divides the total volume
in smaller elements, indicated by the shown mesh-lines, and calculates
for each element the local stress and strain levels. By combining the
strain of all elements the eigenvector terms of this eigenmode are
calculated for all crossing points of the mesh lines. The red lines
indicate the undeformed shape. The shown deformation is exaggerated
for reasons of visualisation.

212
Chapter 3. Dynamics of Motion Systems
analysis [30]. In this method the response to a dynamic stimulus is mea-
sured at diÔ¨Äerent locations on the subject by means of accelerometers or
other vibration-sensitive sensors. The force-stimulus often consists of an
impulse, delivered by a hammer which is provided with an integrated force
sensor to measure the applied force. As explained in Chapter 2, an impulse
signal contains a wide range of frequencies. The diÔ¨Äerent responses are
compared with each other and with the frequency spectrum of the stimulus
by means of a correlation algorithm, that derives the related mode-shapes,
eigenfrequencies and modal mass/stiÔ¨Äness. Presently enhanced correlation
methods even enable to derive mode-shapes without a separate stimulus, by
just using the random external vibrations, that are often present in actual
systems.
When the mechanics are approved with these methods, the actuators and
sensors can be mounted and the frequency response from actuator and
Fx
Fy
Tz
Fz
Tx
Ty
x
y
z
Frequency (Hz)
z
R
y
R
x
R
Response movement magnitude
Input forces and torques
Figure 3.51: The magnitude Bode plots of the dynamic frequency response of a
mechanical system, when actuated and sensed in six Cartesian coor-
dinate directions, will always show many resonating eigenmodes.
(Adapted with permission from Hans Butler [20])

3.4. Mechanical Frequency Response
213
sensor can be measured and compared with the modelled graph of Fig-
ure 3.51. These measured graphs always show diÔ¨Äerences, preferably small
but quite often larger, especially at higher frequencies, which might require
additional measures when these apparently non-modelled eigenmodes inÔ¨Çu-
ence the phase behaviour in the frequency range of interest. In order to be
able to better interpret the resulting graphs in the following sections four
characteristic frequency responses will be presented.
3.4.2
Characteristic Frequency Responses
The theory of modal decomposition is based on the idea that the total dy-
namic behaviour of a mechanical system can be described as a linear combi-
nation of the dynamic behaviour of all separate eigenmodes. This means
that the total frequency response of a dynamic system can be derived by the
addition of the frequency responses from the separate eigenmodes with a
weighing factor that is related to the relative magnitude of these responses.
In the following the eÔ¨Äect of this addition is described for an elementary
example of a system with two eigenmodes, a rigid-body mode and a non-
rigid body mode, where the force is exerted on another physical DOF than
the measurement location. A simple example of this elementary system is
the two-body mass-spring system without a connection to the stationary
reference, which was introduced at the beginning of Section 3.3. Another
Figure 3.52: System with one rigid body mode and one non-rigid, compressible
eigenmode. Actuation is located at xa while the measurement takes
place at diÔ¨Äerent locations xs along the object, thereby determining Œ±.

214
Chapter 3. Dynamics of Motion Systems
10
0
10
2
10
4
         
Mag.
10
0
10
2
10
4
         
Mag.
101
102
103
z[¬É{
0
-180
Frequency [Hz]
Phase
10
0
10
2
10
4
         
Mag.

ms + k
       2
 1
ms
       2





A
A
A
B
Figure 3.53: Contribution of rigid-body motion and modal dynamics to the ampli-
tude and phase of the transfer function xs/Fa for various values of Œ±.
version of such a system is a free-Ô¨Çoating body, exhibiting a compression
mode as shown in Figure 3.52.
The Ô¨Årst eigenmode is a pure rigid-body mode, where the eÔ¨Äective modal
mass at the actuation point equals the mass m of the moving body. The
second eigenmode can be derived by modelling the system as a standard
two-body mass-spring system10, using Equation (3.119) with i = 2. When
added, these two eigenmodes give the total transfer function in the Laplace-
domain between the measured sensor position xs and the actuator force Fa:
xs
Fa
=
1
ms2 +
œÜ2,sœÜ2,a
M2s2 +K2
=
1
ms2 +
œÜ2,sœÜ2,a
M2

s2 +œâ2
0,2

[m/N].
(3.142)
The transfer function and the exact interaction between the two parts in
Equation (3.142) depends on the values of the various parameters. It appears
10The additional eigenmode is assumed to have a small amount of modal damping. However,
for reasons of clarity, this damping term is not included in the equations while in the modelling a
value of Q = 25 is assumed, creating non-inÔ¨Ånite peaks and realistic (smooth) phase transitions.

3.4. Mechanical Frequency Response
215
         
         
         
         
         
         
10
0
10
2
10
4
Mag.
z[¬É{
0
-180
Frequency [Hz]
Phase


101
102
10[
101
102
10[
10
-2
10
0
10
2
10
4
Mag.
z[¬É{
0
-180
Phase
10
-2
10
0
10
2
10
4
Mag.
z[¬É{
0
-180
Phase
10
-2



Frequency [Hz]
I
II
III
IV
Figure 3.54: Bode plots of the combined frequency response function xs/Fa(f ) for
various values of Œ±, showing four characteristic magnitude and phase
responses.
that six diÔ¨Äerent combinations can be distinguished, which lead to four
diÔ¨Äerent interaction patterns in the Ô¨Ånal frequency response. To derive
these six combinations, Equation (3.142) is reduced to its essentials by
introducing the variable Œ±, which relates the high-frequency contribution of
the eigenmode to that of the rigid-body motion:
Œ± =
œÜ2,sœÜ2,a
M2
1
m
=
œÜ2,sœÜ2,a
M2
m.
(3.143)
Which simpliÔ¨Åes Equation (3.142) to:
xs
Fa
=
1
ms2 +
Œ±
m

s2 +œâ2
0,2
 =
1
ms2 +
Œ±
ms2 + k
[m/N],
(3.144)
with k = mœâ2
0,2.
This equation will be the basis for the discussion of the various patterns

216
Chapter 3. Dynamics of Motion Systems
that can be observed in frequency responses. It is important to note that
Equation (3.144) is not a special case but a general description of the dynamic
behaviour of a mechanical structure that contains a resonance. Investigating
Equation (3.144) and considering the general shape of the two contributions
in a Bode plot as shown in Figure 3.53 reveals that, apart from the precise
location of the natural frequency œâ0,2 of the second eigenmode, three diÔ¨Äerent
types of intersection pattern can be found in the amplitude plot.
Depending on the absolute values of Œ±, one can observe :
‚Ä¢ |Œ±| < 1 : two intersections.
‚Ä¢ |Œ±| = 1 : one intersection and asymptotic approach at high frequencies.
‚Ä¢ |Œ±| > 1 : one intersection.
The Ô¨Ånal interaction between the rigid-body motion and the additional mode
will not only depend on |Œ±| but also on the sign of Œ±11, which determines the
phase relation between the two contributions. This doubles the number of
possible combinations to six.
Basically, it is fairly easy to construct the general shape of the overall
frequency response from the magnitude and phase of the two contributing
eigenmodes. Interesting points are the interaction of the two eigenmodes at
the frequency that corresponds to an intersection in the amplitude plot. At
this frequency the magnitudes are equal, so it depends on the phase of the
two contributions whether they cancel each other, thus leading to a pair of
zeros, or just add up.
This approach can be used to interpret and understand the Bode plots
of the resulting frequency response functions of each of the six distinct
combinations as shown in Figure 3.54.
When analysing these Bode plots four diÔ¨Äerent types of frequency response
can be found (Figure 3.55), which can be characterised as:
Each of these four types will be looked at in more detail. In this discussion
the following convention will be used:
‚Ä¢ f0 : frequency corresponding to the resonance (or pole pair).
‚Ä¢ fa : frequency corresponding to the anti-resonance (or zero pair).
11A positive value of Œ± implies that for the mode under consideration the motion of the point
at which the force is applied (more precisely : the relative motion of the points between which
the servo force is applied) has the same sign as the motion of the measuring point (again, more
precisely : the relative motion of the points between which the position is measured).

3.4. Mechanical Frequency Response
217
Type I
-2 slope/zero pair/pole pair/-2 slope
(Œ± > 0)
Type II
-2 slope/pole pair/zero pair/-2 slope
(‚àí1 < Œ± < 0)
Type III
-2 slope/pole pair/-4 slope
(Œ± = ‚àí1)
Type IV
-2 slope/pole pair/-2 slope
(Œ± < ‚àí1)

0
-1
I
II
III
IV
Figure 3.55: The four types of response as function of Œ±.
Special attention will be paid to the Nyquist plot in addition to the Bode
plot, because it is very useful for explaining the eÔ¨Äect of the dynamics on
the control performance as will be explained in Chapter 4 on motion control.
3.4.2.1
Frequency Response Type I
It is interesting to see that, apart from the exact location of the zero pair,
one always Ô¨Ånds the same ‚Äú-2 slope/zero pair/pole pair/-2 slope‚Äù type of
overall frequency response when Œ± has a positive value. The location of the
pole pair is not inÔ¨Çuenced by any intersections, it is simply determined by
the eigenfrequency of the eigenmode. Furthermore, the Ô¨Årst intersection
(indicated by A in Figure 3.53 always leads to a zero pair due to the phase
relation of 180¬∞ , whereas at the frequency of the second intersection (if
present at all) the amplitudes are simply summed, because the phase of
the two contributions is identical. As a result of this, any positive value
of Œ± leads to an overall frequency response, which can be characterised as
‚Äú-2slope/zero pair/pole pair/-2 slope‚Äù. Figure 3.56 shows the Bode plot and
the Nyquist plot of this type of frequency response.
The Bode plot is characterised by:
‚Ä¢ A -2 slope below fa, followed by a horizontal asymptote between fa
and f0, and again a -2 slope at high frequencies. Per deÔ¨Ånition (see
Equation (3.144), the level of the high-frequency asymptote exceeds
the low-frequency one by a factor of (1+ Œ±). On the other hand, one
can deduce from the horizontal asymptote between fa and f0 that the
high-frequency asymptote exceeds the low-frequency one by a factor
f0/f a
2, this factor must be identical to (1+Œ±).

218
Chapter 3. Dynamics of Motion Systems
10
1
10
2
10
3
10
z¬Ç
10
0
10
2
10
4
         
Magnitude
Bode plot
f
f
10
1
10
2
10
3
z[¬É{
z,¬Ü{
0
frequency [Hz]
Phase
z¬Å{{{
0
¬Å{{{
z¬É{{{
z){{{
z¬Ç{{{
0
2000
4000
¬É{{{
Real
Imaginary
Nyquist plot
z,{{{
z¬Å{{
0
¬Å{{
1000
z,{{{
z¬Å{{
0
¬Å{{
1000
Real
Imaginary
ZOOMED
0
a
Figure 3.56: Bode and Nyquist plots of the frequency response of a Type I system
with ‚Äú-2 slope/zero pair/pole pair/-2 slope‚Äù behaviour.
‚Ä¢ A phase lead between the frequency of the zero/pole combination.
In the Nyquist representation, one sees that the zero/pole pair combination
leads to a huge, approximately circular, excursion, which lies to the right of
the original rigid-body curve when travelling from low to high frequencies.
3.4.2.2
Frequency Response Type II
The combination ‚Äú-2 slope/pole pair/zero pair/-2 slope‚Äù is only found for
‚àí1 < Œ± < 0. The pole pair location is again determined by the presence of
the modal eigenfrequency, whereas the zero pair emerges because at the
second intersection (indicated by B in Figure 3.53) the amplitudes of the
two eigenmode responses are equal but the phases are opposite. At the Ô¨Årst
intersection (point A in Figure 3.53 no cancellation of contributions takes
place because of the nearly equal phase. The Bode and Nyquist plots of this

3.4. Mechanical Frequency Response
219
10
10
10
3
10
z¬Ç
10
0
10
¬Ç
10
4
         
Magnitude
f
f
10
1
10
¬Ç
10
3
z[¬É{
z,¬Ü{
0
frequency [Hz]
Phase
z¬Ç{{{
0
¬Ç{{{
z,{{{
z¬Ç{{{
0
1000
¬Ç{{{
Real
Imaginary
Nyquist plot
Real
Imaginary
ZOOMED
0
a
1000
z,{{{
z¬Ç
z,
0
1
¬Ç
z¬Ç
z,
0
1
¬Ç
Bode plot
¬Ç
Figure 3.57: Bode and Nyquist plots of the frequency response of a Type II system
with ‚Äú-2 slope/pole pair/zero pair/-2 slope‚Äù behaviour.
mechanical frequency response are shown in Figure 3.57.
Typical characteristics in the Bode plot are:
‚Ä¢ A high-frequency mass line (-2 asymptote), which is always lower
than the low-frequency one, whereas between frequencies f0 and fa
the behaviour is characterised by a -4 asymptote. The level of the
high-frequency asymptote diÔ¨Äers a factor (1 + Œ±) from the low-level
asymptote, which is identical to the ratio
f0/f a
2.
‚Ä¢ A 180¬∞phase lag between the frequencies of the pole pair/zero pair
combination.
In contrast to the previous frequency response, the circular excursion in
the Nyquist plot now lies to the left of the original rigid-body curve when
travelling from low to high frequencies, and it is not a closed circle. More
importantly, when zooming in, it is shown that the -1 point on the real axis
is passed at the right hand side at the last transition of unity gain towards

220
Chapter 3. Dynamics of Motion Systems
10
10
10
3
10
z¬Ç
10
0
10
¬Ç
10
4
         
Magnitude
f
10
1
10
¬Ç
10
3
z[¬É{
z,¬Ü{
0
frequency [Hz]
Phase
z¬Ç{{{
0
¬Ç{{{
z,{{{
z¬Ç{{{
0
1000
¬Ç{{{
Real
Imaginary
Nyquist plot
Real
Imaginary
ZOOMED
0
1000
z,{{{
z¬Ç
z,
0
1
¬Ç
z¬Ç
z,
0
1
¬Ç
Bode plot
Figure 3.58: Bode and Nyquist plots of the frequency response of a Type III system
with ‚Äú-2 slope/pole pair/-4 slope‚Äù behaviour.
zero gain. As will be shown in Chapter 4, this type of dynamic behaviour
can be very de-stabilising for the control loop.
3.4.2.3
Frequency Response Type III
The combination ‚Äú-2 slope/pole pair/-4 slope" is only found for Œ± = ‚àí1. This is
for instance the case when in a two-body mass-spring system the position is
measured at body 2 while actuating at body 1, as presented in Section 3.3.1
and Section 3.3.4.1. With those examples the cause for the -4 slope at high
frequencies was only qualitatively described. To really derive this slope one
needs to return to Equation (3.144) and re-arrange it slightly for Œ± = ‚àí1:
xs
Fa
=
1
ms2 +
‚àí1
ms2 + mœâ2
0,i
=

ms2 + mœâ2
0,i

‚àíms2
ms2

ms2 + mœâ2
0,i
 =
œâ2
0,i
ms4 + ms2œâ2
0,i
[m/N].
(3.145)

3.4. Mechanical Frequency Response
221
This result shows that the high-frequency asymptote is indeed a -4 slope.
The phase undergoes a shift from -180¬∞to -360¬∞at the eigenfrequency, which
corresponds to the -4 slope. Figure 3.58 shows the Bode and Nyquist plots
of this type of frequency response. Apart from the high-frequency behaviour
(phase approaches -360¬∞), the Nyquist plot looks very similar to the previous
frequency response of Figure 3.57, showing a huge excursion on the left-
hand side.
The high-frequency asymptote is actually characterised by a -3 slope for
frequencies above f0/2Œ∂, because of the presence of relative modal damping.
With Œ∂ = 1% this crossover frequency equals 50¬∑ f0, which explains the slight
increase of the phase plot in the investigated frequency range.
3.4.2.4
Frequency Response Type IV
The last combination, ‚Äú-2 slope/pole pair/-2 slope" is found for Œ± < ‚àí1. The
location of the pole pair is again determined by the modal eigenfrequency.
Only one intersection of the two curves is found in Figure 3.53 (point A)
but no cancelling of contributions takes place due to the correspondence in
phase. The Bode and Nyquist representations of this mechanical frequency
response are shown in Figure 3.59.
Typical characteristics in the Bode plot are:
‚Ä¢ A -2 asymptote both in the low-frequency and the high-frequency
range. The high-frequency asymptote diÔ¨Äers by a factor |1+Œ±| from
the low-frequency asymptote, which for Œ± < ‚àí1 leads to 0 < |1+Œ±| < ‚àû.
Consequently, the high-frequency asymptote can be lower or higher
than the low-frequency asymptote, depending on the value of Œ±.
‚Ä¢ The phase undergoes a shift from -180 to -360 at the resonance fre-
quency without a corresponding asymptote slope change. This indi-
cates the non-minimum phase characteristic of this situation.
Similar to the previous frequency response, the circular excursion in the
Nyquist diagram lies to the left of the original rigid-body curve when trav-
elling from low to high frequencies, it is not closed and the point (0,0) is
approached with a phase of -360¬∞.
This is a typical example of a non-minimum phase system where the phase
lag between position and force is larger than would be expected from the
slope in the magnitude Bode plot. In Chapter 4 it will be shown that non-
minimum phase behaviour is characterised by one or more zeros in the right

222
Chapter 3. Dynamics of Motion Systems
10
10
10
3
10
z¬Ç
10
0
10
¬Ç
10
4
         
Magnitude
f
10
1
10
¬Ç
10
3
z[¬É{
z,¬Ü{
0
frequency [Hz]
Phase
z,{{{{
0
10000
z¬Å{{{
z,{{{{
0
¬Å{{{
10000
Real
Imaginary
Real
Imaginary
ZOOMED
0
¬Å{{{
z¬Å{{{
z¬Ç
z,
0
1
¬Ç
z¬Ç
z,
0
1
¬Ç
Nyquist plot
Bode plot
Figure 3.59: Bode and Nyquist plots of the frequency response of a Type IV system
with ‚Äú-2 slope/pole pair/-2 slope‚Äù behaviour.
half of the Laplace plane. The presence of this positive real zero can be
proven by taking Equation (3.144) and re-arranging it slightly:
xs
Fa
=
1
ms2 +
Œ±
ms2 +œâ2
0,i
=
ms2 + mœâ2
0,i +Œ±ms2
ms2

ms2 + mœâ2
0,i
 =
(1+Œ±)s2 +œâ2
0,i
ms4 + ms2œâ2
0,i
[m/N].
(3.146)
The zeros of this transfer function are deÔ¨Åned by the numerator of this
equation:
(1+Œ±)s2 +œâ2
0,i
(3.147)
which, for Œ± < ‚àí1, leads to the two real zeros z1,2(s) deÔ¨Åned in the following
expression:
z1,2(s) = ¬±
œâ0,i
|1+Œ±|
(3.148)
One of these zeros is indeed located on the positive real axis in the Laplace
plane, which corresponds to the non-minimum phase behaviour.

3.4. Mechanical Frequency Response
223
3.4.3
Example Systems with Type I/II/IV Response
As closure of this chapter and as transition to the next chapter on motion
control two examples with two motion directions are presented to show
that placement of the sensor can create both a Type I, Type II or Type IV
response. As mentioned before, non-collocated positions of sensors and
actuators cause signiÔ¨Åcant diÔ¨Äerences in the frequency response from the
actuator to the sensor. These diÔ¨Äerences will change the observability and
controllability of a dynamic system, referring to the possibility to measure
and excite the diÔ¨Äerent dynamic eigenmodes of the mechanical structure
when applied in an active controlled motion system [79,80].
The Ô¨Årst example is a planar moving body on a compliant spring and the
second example is the electrical H-drive waferstage from Figure 1.14 in
Chapter 1, which is also shown on the front page of this book.
3.4.3.1
Planar Moving Body on Compliant Spring
Figure 3.60 shows a two-dimensional system, consisting of a rigid body,
which is connected to the stationary reference by means of a mass-less ideal
y
x
a: First eigenmode
b: Second eigenmode
Staonary reference
Staonary reference

< 0.5 
&
Fa
Fa
x
x
Figure 3.60: The mode-shapes of the two main, in plane, eigenmodes of a body that
is connected to the stationary reference by means of a leaf-spring. The
Ô¨Årst mode-shape is characterised by a swinging movement around
a rotation centre just below the centre of the leaf spring and the
second mode-shape is a reciprocating rotation around a point just
above the centre of mass. Depending on the location of actuation
(F) and sensing (x), the observed dynamic behaviour of the system is
diÔ¨Äerent, primarily related to the second eigenmode.

224
Chapter 3. Dynamics of Motion Systems
leaf-spring with only two eigenmodes of interest. The Ô¨Årst eigenmode has
a mode-shape, which is characterised by a ‚Äúswinging‚Äù movement around a
rotation centre located on the leaf spring slightly below the centre of the
spring, depending on the dimensions of the body. The second eigenmode
has a mode-shape, which is characterised by a rotation around a point just
above the centre of mass of the body. The method to combine the response
of the two eigenmodes of this single body is identical to the method of the
combined eigenmodes of the previously described two body mass-spring
system, because in both cases the mode-shapes of the diÔ¨Äerent eigenmodes
are independent. This means, that they can be linearly combined to give the
resulting overall behaviour, as long as the coordinate system of all mode-
shapes is identical. This does not necessarily mean that the results are
identical and it will be shown that with diÔ¨Äerent locations of actuator and
sensor the frequency response becomes diÔ¨Äerent.
A periodic force stimulus F with frequency f is exerted on the top side of the
body. To illustrate the diÔ¨Äerence in perceived behaviour, the measurement
of the movement is done at diÔ¨Äerent positions varying from the bottom side
to the topside of the body. For the calculation of the eigenfrequencies and the
Bode plot, some exemplary values are chosen for the diÔ¨Äerent parameters.
The eÔ¨Äective modal mass at the top of the body Meff.1,t of the Ô¨Årst eigenmode
is mainly dominated by the mass (m) of the body with a value of 0.05 kg,
because there is little rotation. The corresponding eÔ¨Äective modal stiÔ¨Äness
Keff.1,t of the Ô¨Årst eigenmode is the bending stiÔ¨Äness of the leaf spring and
equals approximately 5¬∑103 N/m. These values result in an eigenfrequency
of f0,1 ‚âà50 Hz of the Ô¨Årst eigenmode. The eigenfrequency of the second
eigenmode is mainly determined by the moment of inertia around the centre
of mass in combination with the rotation stiÔ¨Äness of the leaf-spring at the
centre of mass. As only the resulting eÔ¨Äect in the x direction is important,
these values can be transformed into the equivalent eÔ¨Äective modal mass
and stiÔ¨Äness of the second eigenmode, located at the top corner, where the
excitation force is applied. When the eÔ¨Äective modal mass is calculated at the
corner of the square, a value is found of approximately Meff.2,t ‚âà0.033 kg. It is
not without logic, that the eÔ¨Äective modal stiÔ¨Äness of the second eigenmode
is signiÔ¨Åcantly higher than the bending stiÔ¨Äness of the leaf-spring for the
Ô¨Årst eigenmode. With the given data the eÔ¨Äective modal stiÔ¨Äness at the
point of exertion of the force equals approximately Keff.2,t ‚âà3¬∑104 N/m, which
results in an eigenfrequency of approximately f0,2 ‚âà150 Hz of the second
eigenmode.
When the position measurement is done collocated at the exact application
point of the force, also called driving point measurement, the modelled

3.4. Mechanical Frequency Response
225
behaviour is shown in the Bode plot of Figure 3.61.a., indicating a Type I
behaviour. The two complex conjugate zeros at the anti-resonance frequency
can be found by combining the two transfer functions of the eigenmodes:
xtop
Fa
(s) =
1
Meff.1,ts2 +Keff.1,t
+
1
Meff.2,ts2 +Keff.2,t
=
=
1
Meff.1,t

s2 +œâ2
0,1
 +
1
Meff.2,t

s2 +œâ2
0,2

=
1
Meff.1,t

s2 +œâ2
0,2

+
1
Meff.2,t

s2 +œâ2
0,1


s2 +œâ2
0,1

s2 +œâ2
0,2

[m/N].
(3.149)
To determine the zeros, the values of s have to be found where the numerator
equals zero, using the values for this example:
1
Meff.1,t

s2 +œâ2
0,2

+
1
Meff.2,t

s2 +œâ2
0,1

= 0
‚áí
s2 = ‚àí
œâ2
0,2
Meff.1,t
+
œâ2
0,1
Meff.2,t
1
Meff.1,t
+
1
Meff.2,t
= ‚àí
‚éõ
‚éú‚éú‚éú‚éù
œâ2
0,2
1+
Meff.1,t
Meff.2,t
+
œâ2
0,1
1+
Meff.2,t
Meff.1,t
‚éû
‚éü‚éü‚éü‚é†
s = ¬±j






œâ2
0,2
1+
Meff.1,t
Meff.2,t
+
œâ2
0,1
1+
Meff.2,t
Meff.1,t
= ¬±j





(2œÄ¬∑150)2
1+ 0.05
0.033
+ (2œÄ¬∑50)2
1+ 0.033
0.05
‚âà¬±j ¬∑640.
(3.150)
These are two complex conjugate values corresponding to a frequency of
f ‚âà640/2œÄ ‚âà100 Hz, the frequency fa where the anti-resonance occurs as
shown in Figure 3.61.a.
A Type IV behaviour is observed when the measurement takes place non-
collocated at the extreme lower side of the body. The resulting response
is shown in Figure 3.61.b. For the Ô¨Årst eigenmode the magnitude of the
response is reduced with approximately a factor two, when compared with
the measurement on top of the body, because the measurement takes place
closer to the rotation centre of the swinging movement. The largest and
most relevant diÔ¨Äerence is however found in the second eigenmode, as the
magnitude is equal, but the sign of the phase is inverted in respect to the
movement at the top. For this reason the response by the second eigenmode
must be multiplied with -1 and the addition becomes a subtraction. As a
consequence the phase of both eigenmodes has become equal to -180¬∞at the
frequency where they have an equal amplitude, resulting in a higher total

226
Chapter 3. Dynamics of Motion Systems
 
 
 
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
Compliance [m/N]
 
 
10
1
10
¬Ç
10
[
0
Phase [deg]
Frequency [Hz]
 
 
 
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
 
 
Eigenmode 1
¬ô$¬Ç
Total system
10
1
10
¬Ç
10
[
z[¬É{
z,¬Ü{
0
Frequency [Hz]
z[¬É{
z,¬Ü{
,$$,¬Ü{`
o
f0,2
fa
f0,2
f0,1
f0,1
90 Hz
100 Hz
*"$|"¬ã¬á*'$|"¬ã¬á
Figure 3.61: Bode plot of the response of the two eigenmodes of Figure 3.60. The left
graph (a:) shows the measured behaviour when sensing at the same
location as the force, while the right graph (b:) shows the measured
response when sensing at the bottom of the body. In that situation the
‚Äôanti-resonance‚Äô has disappeared but both resonances remain present.
magnitude instead of the anti-resonance that was observed at the collocated
measurement location. At higher frequencies above the second eigenfre-
quency the slope of this combined response equals ‚àí2 with -360¬∞phase, due
to the sign inversion. This corresponds with the non-minimum phase be-
haviour, which should also be reÔ¨Çected by positive real zero terms in the
transfer function. With this location of the sensor, indeed two real conjugate
zeros are created as can be concluded when writing the same combination
as with Equation(3.149) with a minus instead of a plus sign for the second
term in the numerator. As said, the contribution of the Ô¨Årst eigenmode at
this location is approximately 0.5√ó the value at the top, due to the closer
distance to the rotation point. This all12 results in the following transfer
12Note that the eÔ¨Äective modal values are equal to the situation when measured at the top,
because the actuation, where the eÔ¨Äective modal values are ‚Äúfelt‚Äù, is still located at the top.

3.4. Mechanical Frequency Response
227
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
-0.5
0
0.5
1
2.5
2
2.5 x 10z)
Time (sec)
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
0
1
2
3
4
5
6x 10z)
Magnitude
*]$|¬á





*¬ö$|'¬á
Figure 3.62: Stepresponse to a force in the positive direction of the two separate
eigenmodes of the dynamic system introduced in Figure 3.60. The
non-minimum phase behaviour with non-collocated sensing at the
bottom is characterised by the initial movement opposite to the force.
function for the measurement position at the bottom of the body:
xbottom
Fa
(s) ‚âà
0.5¬∑
1
Meff.1,t

s2 +œâ2
0,2

‚àí
1
Meff.2,t

s2 +œâ2
0,1


s2 +œâ2
0,1

s2 +œâ2
0,2

[m/N].
(3.151)
Following the same procedure as with Equation (3.150), two real zeros are
found, s ‚âà¬±540, corresponding to a frequency f = 540/2œÄ ‚âà90 Hz, the fre-
quency where the magnitude of the contributions of both eigenmodes are
equal as shown in Figure 3.61.b. This means that the transfer function
contains a positive real zero and as a result the system is non-minimum
phase. In the time-domain a non-minimum phase system is especially
recognisable by the initial reaction to a step stimulus. A soon as a force
is applied to the system at the indicated position on top of the body, the
body will start to accelerate according to the eÔ¨Äective modal mass values of
both eigenmodes. The eÔ¨Äect on position of the second eigenmode will ini-
tially be larger because of the lower eÔ¨Äective modal mass. When measuring
collocated, the contributions of both eigenmodes are observed as working
initially in the same direction but measuring non-collocated at the bottom
gives an initial movement in the opposite direction of the force by the second
eigenmode, which is illustrated in Figure 3.62 for the stepresponse of this
system. These two extreme positions are chosen to highlight the occurring
phenomena, while in a real system the sensor position will be chosen some-
where between these extremes. Still the same phenomena occur at these
Only the measurement is changed.

228
Chapter 3. Dynamics of Motion Systems
intermediate positions to a level depending on the distance to these extreme
positions. The closer to the top, the more the sensor signal will correspond
to the signal of a collocated sensor while a short distance to the bottom will
show a non-minimum phase behaviour. A special situation occurs when the
measurement sensor is located in the middle as then the movement in the
x direction due to the second eigenmode is not measured anymore. This
means that this eigenmode has become unobservable by the sensor. When
this conÔ¨Åguration is applied in a closed-loop feedback system, the dynamic
eÔ¨Äects of the second eigenmode will not interfere with stability, which is a
positive eÔ¨Äect. Unfortunately this does not mean that this eigenmode is not
excited. Unknown disturbing forces acting on the system could contain fre-
quencies around the eigenfrequency of this un-observed eigenmode. These
forces could be caused by noise from the actuator or by vibrations from
outside, which are transmitted through the support structure. For these
reasons it is always necessary to prevent these unknown forces as much as
possible, for instance by means of vibration isolation. It is also necessary
to make sure that the actuator is not capable of exciting an un-observed
eigenmode by following the same reasoning as above for the position of the
actuator. As long as the position where the force is applied is also in line
with the centre of rotation of the second eigenmode, this mode will not be
excited by the actuator. This optimal position from the point of view of
avoiding the excitation of resonances in eigenmodes comes at the price of
a reduced controllability of the system. Even if the controller would have
information about this eigenmode it would not be able to control it, because
it is missing an actuator at the right location. This can be solved with a
separate actuator, only intended to control this eigenmode, but more often
very strict measures are taken to prevent any other source of interference.
This is one of the many important attention points, when designing complex
mechatronic systems with extreme precision.
The found phenomena can be summarised in three important conclusions
applicable to controlled motion systems:
‚Ä¢ The observability and controllability of eigenmodes depends on the
location of the position sensor and actuator.
‚Ä¢ For most eigenmodes a location can be found where the sensor is not
able to observe or the actuator is not able to excite the eigenmode.
‚Ä¢ An uncontrolled and unobserved eigenmode can still be excited by
external disturbing forces. This can impair the functionality of the sys-
tem while the controller is not able to improve its dynamic behaviour.

3.4. Mechanical Frequency Response
229
3.4.3.2
H-drive Waferstage
Figure 3.63 shows a drawing and physical model of the waferstage for a
lithographic stepper as was introduced in Chapter 1. It features a H-drive
conÔ¨Åguration where the actuation forces are all working in one plane through
the centre of mass of the moving body, thereby avoiding cross-coupling of
the planar forces to torques that cause tumbling modes of the wafer chuck.
For this example only the two y-actuators and y-sensors are considered with
the x-position of the moving mass in the middle, as indicated in Figure 3.63.
These y-sensors and actuators work on two eigenmodes, the rigid-body
translation in the y-direction (1) and the spring loaded rotation mode Rz
(2)around the centre of mass (COM). When driving with only one of the two
yi-actuators (i =1 or 2), the eÔ¨Äective modal mass for the translation mode
would be Meff.1,i = 20 kg, while the eÔ¨Äective modal mass for the rotation
mode would be Meff.2,i = 10 kg, when neglecting the moment of inertia of
the wafer chuck, which is allowed in this example when compared with the
2√ó5 = 10 kg of the actuator mass values. With the given eÔ¨Äective modal
rotational stiÔ¨Äness of Keff.2,i = 1¬∑105 N/m, the eigenfrequency equals 16 Hz.
For the translational eigenmode the measurements at Sy1 and Sy2 are both
equal to the actuator motion. The rotation mode, however, gives a factor 10
F1
F2
Sy2
Sy1
x
y
COM
z
Rz
Ay1
Ay2
Ax
5 kg
5 kg
10 kg
m
m
 
5
2
m
m
 
0
5
2
wafer chuck
Figure 3.63: The planar moving H-drive waferstage moves in three Cartesian coor-
dinate directions x, y and Rz. The measurement of the motion at Sy1
and Sy2 is a combination of the rotation movement around the centre
of mass COM and the translation movement in the y-direction. The
sliding bearings of the y-actuators have no translational stiÔ¨Äness but
they do have a rotation stiÔ¨Äness giving an eÔ¨Äective modal stiÔ¨Äness at
the actuators equal to Keff.2,i = 1¬∑105 N/m.

230
Chapter 3. Dynamics of Motion Systems
 
 
 
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
Compliance [m/N]
10
0
10
1
10
2
z[¬É{
z,¬Ü{
0
Phase [deg]
Frequency [Hz]
 
 
 
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
 
 
Eigenmode 1
Eigenmode 2
Total system
10
0
10
1
10
2
z[¬É{
z,¬Ü{
0
Frequency [Hz]
Equal side   (Type I)                                                        Opposite side  (Type II)
Figure 3.64: Bode plot of the response of the two eigenmodes of the H-drive wafer-
stage. The left graph shows the measured behaviour when sensing at
the same side as the actuator (Ay1 ‚ÜíSy1 or Ay2 ‚ÜíSy2), while the right
graph shows the measured response when sensing at the opposite side
of the actuator (Ay1 ‚ÜíSy2 or Ay2 ‚ÜíSy1).
lower value of the sensed motion than the motion of the actuator because of
the diÔ¨Äerence in distance from the centre of mass, while the sensor opposite
to the centre of mass shows a sign inversion related to the opposite motion
direction. With the factor 2 lower eÔ¨Äective modal mass for the rotation this
implies Œ± = 0.2 or Œ± = ‚àí0.2, depending on the sensor position. With these
data the Bode plots of Figure 3.64 show the frequency responses of both
eigenmodes and the combined response at two sensor positions, the Ô¨Årst
with the sensor position at the same side of the centre of mass and the
second with the sensor position at opposite sides of the centre of mass. Note
that due to the symmetry these responses are equal for actuator Ay1 and
actuator Ay2 when also interchanging the sensors for each plot. The plots
clearly show a Type I response for the sensor at the same side and a type II
response for a sensor at the opposite side.
To control each eigenmode separately, generally the sensor signals are
combined by means of a Gain Scheduling matrix into measurement values
that are valid for the centre of mass. With those results the translation
mode can be controlled without a visible resonance at 16 Hz as this is only
present in the rotation mode.

3.5. Summary on Dynamics
231
3.5
Summary on Dynamics
In this chapter some important lessons have been learned, which are sum-
marised as follows:
‚Ä¢ StiÔ¨Äness, whether it is created mechanically or by means of a control
system, is determinative for precision.
‚Ä¢ Every mechanical structure can be modelled as a combination of bodies,
springs and dampers, either as separate bodies or as Ô¨Ånite elements
within a body.
‚Ä¢ Phase is a prominent factor regarding the possibility to control the
motion of a mechanical system.
‚Ä¢ The quality factor Q and damping ratio Œ∂ are inverse proportional.
Each have their practical value.
‚Ä¢ A damper placed in parallel with a lumped mass-spring system limits
the magnitude of the resonance at the natural frequency. However it
also increases the transmissibility at frequencies above the natural
frequency.
‚Ä¢ The dynamic behaviour of a complex system and its response to a
stimulus can be derived and understood by viewing it as a superposi-
tion of contributions of its eigenmodes, each with its own mode-shape,
eigenfrequency, modal parameters and damping.
‚Ä¢ The position of the actuator and the sensor determine the observability
and controllability of the diÔ¨Äerent eigenmodes, which is characterised
by four typical frequency responses.
‚Ä¢ A precision design requires a careful lay-out of all elements, consider-
ing the eigenmodes.
‚Ä¢ Modal analysis is a powerful and widely applied tool to investigate the
dynamics of a mechanical structure.
Finally it can be concluded, that these insights help in designing actively
controlled dynamic motion systems with optimally located actuators and
sensors, which reduce the sensitivity for modal dynamic problems. With
this conclusion this chapter closes to continue the book in the next chapters
with the active elements of a mechatronic system.

blank
left
intentionally
page
This

Chapter 4
Motion Control
Georg Schitter, Robert Munnig Schmidt
Introduction
Motion Control is the discipline within mechatronics that connects all hard-
ware elements by means of electronic signal processing in order to reliably
and eÔ¨Äectively control the position, velocity and acceleration of a moving
object to a required level of precision.
Position control is the main topic for the high performance mechatronic
systems presented in this book. Even in situations where the object needs
to move over a predetermined trajectory with diÔ¨Äerent velocities it is the
position which is continuously monitored, while the controller steers the
motion of the system by changing and compensating its dynamics in order
to keep the real position as close as possible to the ‚Äúmoving‚Äù target position
at any moment in time. Therefore only control methods related to position
control are presented in this chapter.
For good reasons the analysis of the system dynamics and optimal tuning of
a motion controller is predominantly done in the Laplace- and frequency-
domain even though the real system works in the time-domain. To better
understand this choice it is important to be aware of the fact that the gener-
ally contradicting requirements on performance vs stability in a feedback
controlled system are especially diÔ¨Écult to deal with in fast positioning sys-
tems due to constraints in system dynamics by limited stiÔ¨Äness structures
in combination with high mass elements. To optimise a controller on these
aspects in the time-domain is not easy, to put it mildly, as mathematics with
233

234
Chapter 4. Motion Control
convolution operators have to be used, which is less intuitive. On the other
hand by working in the frequency-domain a controller can be designed by
simply adding Ô¨Ålters to the uncontrolled frequency response of the system
such that both performance and stability criteria are met in balance. The
only drawback of frequency-domain analysis is that formally it is only valid
for linear, time invariant (LTI) systems that also are not limited in range of
the control parameters. Fortunately most practical precision motion control
systems are suÔ¨Éciently linear and when necessary also a non-linear motion
system can be linearised around a chosen operating point. Furthermore
limitations of the hardware can be accounted for by dedicated measures.
However, recent developments in time-domain oriented control oÔ¨Äer cer-
tain beneÔ¨Åts, especially with digitally sampled signals in the discrete-time-
domain, that should not be overlooked when designing the complete control
system. For this reason this chapter is divided in the following sections.
‚Ä¢ First a global overview of the control system is presented in the Laplace-
domain as an introduction to feedforward and feedback control using
transfer functions with the Laplace operator s.
‚Ä¢ Then feedforward control will be further presented with items like
input-shaping and path-planning.
‚Ä¢ The third section deals with feedback control in a general sense, intro-
ducing important performance criteria and stability margins.
‚Ä¢ The fourth and longest section presents PID-control, the still most
widely used method of feedback control for motion systems. It is shown
with diÔ¨Äerent examples, ranging from simple rigid-body systems to
more complicated systems with resonating eigenmodes and magnetic
bearings.
‚Ä¢ The Ô¨Åfth section gives a short overview of the implementation of digital
signal processing, which is used when designing feedback controllers
in the discrete-time-domain.
‚Ä¢ The last section introduces the state-space representation, which is a
mathematical method to describe higher order systems and is often
used in computer based feedback controllers.

4.1. A Walk around the Control Loop
235
4.1
A Walk around the Control Loop
Figure 4.1 shows a basic control loop of a positioning system where the
control part consists of a feedforward path and a feedback path. It is fully
comparable with Figure 1.16 from the introduction with some additions
to make it complete. Firstly the A/D and D/A converters are shown that
translate analog signals into time-discrete digital signals and vice versa,
as these are almost always used in motion controllers for industrial use.
Secondly the impact locations of several disturbances are shown, which
play a large role in determining what requirements the controller needs to
fulÔ¨Ål. It should be noted that in principle control systems can consist only
of a feedforward or feedback path, but for the highest performance where
possible a combination is applied as each principle has its own advantages
and disadvantages. The core of the control system is the plant, which is a
control engineering term for the physical system that needs to be controlled.
In the mechanics oriented community the plant is deÔ¨Åned as the mechanical
structure, while the sensor, ampliÔ¨Åer and actuator are considered as part
of the controller. On the other hand, the control community often sees the
Plant 
sensor
A/D
D/A
Feedback
Pre-%lter
Feedforward
Guidance
signal 
-
Input 
disturbance
Output disturbance
Process
disturbance
Sensor disturbance
Output
Energy
Informaon
x
r
u
v
y
e
rf
ym
Figure 4.1: Block diagram of a motion control system, including feedforward and
feedback control. The plant consists of the power ampliÔ¨Åer, actuator
and the mechanical dynamics. The diagram clearly shows the diÔ¨Äerent
places where interfering disturbances impact the system. The indicated
variables are commonly used symbols in control engineering: r in [m]
is the reference signal, rf in [m] is the Ô¨Åltered reference signal, e in [m]
is the error signal, u in [N] is the control force that should be applied,
v in [N] is the real force that is applied, x in [m] is the plant output
motion, y in [m] is the measured output motion and ym in [m] is the
measurement value of the measured output motion.

236
Chapter 4. Motion Control
Process 
disturbance
Ampli%er
Actuator
v
Mechanical 
structure
x
Figure 4.2: The energy converting part of a mechatronic system consists of the
ampliÔ¨Åer, the actuator and the mechanical structure. Sometimes also
the sensor is included with the related electronics. The elements that
transfer energy interact with each other in two directions. For instance
the ampliÔ¨Åer determines the input of the actuator, while the actuator
determines a dynamic ‚Äúload‚Äù, which inÔ¨Çuences the behaviour of the
ampliÔ¨Åer. The same goes for the actuator and the mechanical structure.
plant as the hardware part, including all electronics and actuators. This
diÔ¨Äerence in approach can be quite confusing as mechatronics is a combina-
tion of both mechanics and control (with a lot more).
One good reason to combine the ampliÔ¨Åer, actuator and mechanics is that
they all deal with energy conversion in close interaction, as shown in Fig-
ure 4.2. Each of these elements has its own inherent dynamic properties.
They interact in both directions in such a way that each element not only
determines the input of the next element but also inÔ¨Çuences the previous
element by its dynamic load. This dynamic interaction is addressed in the
other chapters of this book and for that reason the ampliÔ¨Åer, actuator and
sensor are assumed having a gain of one, which makes both deÔ¨Ånitions
identical. In real systems one should take the real properties into account.
As shown in Figure 4.1, the functional blocks that determine the plant with
the related disturbances are represented in red and the functional blocks
forming the control-system are represented in yellow. It is necessary to
clearly distinguish the domain of each functional block, because everything
that is located at the left side from the D/A and A/D-converters, including
the converters themselves, only concerns information, consisting of dis-
crete data. The blocks that are shown in red at the right side represent real
hardware, physical systems or sub-systems where energy conversion in
the analogue domain determines the behaviour. The Ô¨Çow of energy mutu-
ally links all hardware elements and full understanding of these links is
required when designing high-performance mechatronic systems.
Before explaining the two kinds of control in more detail it is Ô¨Årst necessary
to repeat and extend the role of poles and zeros for motion control.

4.1. A Walk around the Control Loop
237
4.1.1
Poles and Zeros in Motion Control
Poles and zeros were introduced in Section 2.4.1.3 of the physics chapter
as those values of the Laplace operator s that cause either the numerator
(zero) or the denominator (pole) of a transfer function to become equal to
zero. With poles and zeros the following generalised transfer function can
be derived for any system, where pn represent the poles and zm represent
the zeros:
G(s) = (s‚àíz1)(s‚àíz2)(s‚àíz3)(s‚àíz4)(s‚àíz5)....(s‚àízm)
(s‚àíp1)(s‚àíp2)(s‚àíp3)(s‚àíp4)(s‚àíp5)....(s‚àípn),
(4.1)
while m and n are integers with m < n.
The number of poles was shown to be an indicator of the order of the dynamic
system, corresponding to the number of states (position and velocity) and the
number of energy containers (mass, spring, capacitance, inductance). It was
also shown that poles in the right half Laplace-plane indicate an instable
system, while poles and zeros with equal values in a dynamic system cancel
each other out. Furthermore a single left-half plane (negative) real pole
gives a phase-lag of 90¬∞and a ‚àí1 slope in the Bode plot, while a zero gives
a phase-lead of 90¬∞and a +1 slope in the Bode plot. Finally it was shown
that all real systems are strictly proper with more poles than zeros and this
means that also the controller will behave as a strictly proper system.
Even though zeros can not create instability, the term unstable zeros is
given to zeros in the right half of the Laplace-plane with a positive real
term. This naming is related to two important phenomena. First of all,
inverting an unstable zero to achieve perfect feedforward control will result
in an unstable pole, as will be explained in the next section. Secondly, a
zero with a positive real term indicates non-minimum phase behaviour of
the system with a larger negative phase shift than would be expected from
the slope of the amplitude Bode plot. It also shows a counter intuitive step
response, because the initial motion is directed opposite to the direction of
the force. This was presented in Section 3.4.3 of the previous chapter on
dynamics, wher it was caused by the non-collocated sensor in respect to
the actuator. In reality all mechatronic feedback systems have not perfectly
collocated sensors and as a consequence they may show some level of non-
minimum phase behaviour. Fortunately the eÔ¨Äect is mostly so small that
it can be neglected but when the ultimate performance of a mechatronic
system needs to be achieved it is necessary to take also these unstable zeros
under consideration.

238
Chapter 4. Motion Control
4.1.2
Overview Feedforward Control
Figure 4.3 shows the typical basic conÔ¨Åguration for feedforward control,
which is also called open-loop control as it is equal to a situation where
the measured output is not connected to the input for feedback (opened
feedback loop). When feedforward control is the only applied control method,
so without feedback, an important forst condition is that the plant has to be
stable by itself (open-loop stable).
This example has only one input and one output variable, which is in control
terms a Single Input Single Output (SISO) system1.
The reference or guidance signal r [m] is applied to the controller, which
has a reference transfer function Cff(s) in
N/m
. The output u in [N] of the
controller is connected to the input of the motion system, which has a transfer
function G(s) in [m/N] giving the output x in [m]. In this conÔ¨Åguration the
feedforward controller acts as a Ô¨Ålter, which modiÔ¨Åes the reference signal
in such a way, that the motion of the controlled mechatronic system follows
the reference signal.
If one would like to achieve perfect control, which means that there is no
diÔ¨Äerence between the reference position and the actual position of the
system, the combined transfer function Gt,ff(s) from r to x has to be equal to
one, hence show identity:
Gt,ff(s) = x
r = Cff(s)G(s) = 1
=‚áí
Cff(s) = G(s)‚àí1.
(4.2)
Plant 
G(s)
Feedforward
Cff (s)
x
r
u
Input disturbance
v
Figure 4.3: Block diagram of a feedforward-controlled motion system with one input
and output (SISO). The transfer functions Cff(s) of the feedforward
controller and G(s) of the plant are frequency dependent, which is
denoted by the Laplace operator s.
1It is important to note that in mechanical engineering a SISO positioning system is also
called a single degree of freedom system, relating to a speciÔ¨Åc direction in an orthogonal three
dimensional spatial coordinate system. Unfortunately the term ‚Äúdegree of freedom‚Äù can lead
to confusion in position control of mechanical systems, because in control terms, feedforward
and feedback are considered as two degrees of freedom even though it relates to one direction.
For that reason the term is further avoided in this chapter.

4.1. A Walk around the Control Loop
239
If the transfer function is a constant value the feedforward controller even-
tually would only represent a gain, which scales the reference signal.
A good example of such a situation is the application of acceleration feedfor-
ward to the motion of a rigid body with mass m driven with a force from the
controller as signal v. In that case the plant and the feedforward controller
would be equal to:
G(s) = a
v = ¬®x
v = 1
m
m/Ns2 = 1/kg

and
Cff(s) = m
[kg].
(4.3)
In reality positioning systems include dynamics, time dependent behaviour
which results in a non-constant transfer function.
In that case also the dynamics of the positioning system will need to be
inverted, which results in pole-zero cancellation between the controller poles
and system zeros as well as controller zeros and system poles.
4.1.2.1
Summary of Feedforward Control
Feedforward control is a very useful and preferred Ô¨Årst step in the control of
a complex dynamic motion system as it provides the following advantages:
‚Ä¢ Less Feedback Required: The better the feedforward part is per-
forming the smaller the feedback error will need to be to correct further
errors. This is the most important reason that feedforward control
is always applied to the maximum accuracy possible in fast high preci-
sion motion systems.
‚Ä¢ No sensor required: No sensor information is fed back to the system,
which means that a sensor can be left out, thus reducing the cost of
pure feedforward controlled systems.
‚Ä¢ Predictable movement: If the reference signal (trajectory) is known
in advance, the phase-lag and time delay in the system can be predicted
and therefore compensated.
‚Ä¢ No introduction of instability: The poles of the controlled system
are not changed by feedforward control. Therefore no instability can be
introduced under the condition that the feedforward controller itself
is stable.
‚Ä¢ No feeding back of sensor noise: In precision motion systems,
positioning noise is a critical point that always has to be considered
in the control design. The lack of a sensor avoids insertion of the
measurement noise in the system.

240
Chapter 4. Motion Control
The design of a feedforward controller can be more complicated as not always
all plant dynamics can easily be inverted. For example a system with a low-
pass characteristic, a property of all positioning systems as these are limited
by the mass-line, would require a feedforward controller with high-pass
characteristics, having a very high gain at high frequencies. High frequency
gain of real systems is limited by nature, which means that feedforward
control of motion systems is applicable for a certain frequency range only. A
second problem is that an unstable system cannot be stabilised with open-
loop control by cancelling the unstable pole of the system.
This and some more results in the following drawbacks and limitations of
feedforward control:
‚Ä¢ Limitation to inverted low-pass minimum-phase characteris-
tic: It is not possible nor wise to create a controller with a very high
gain at very high frequencies. Inverting unstable zeros from a non-
minimum phase system would create an unstable controller.
‚Ä¢ The plant has to be stable: Unstable systems cannot be controlled
with pure feedforward control. The smallest disturbance or noise,
which is always present, would cause the system to become unstable
even if an unstable pole would be cancelled by a corresponding zero.
‚Ä¢ No compensation of model uncertainties: Variations in the sys-
tem dynamics, such as shifting of the resonance frequency or variation
of the damping, are not monitored and therefore not accounted for in
feedforward control.
‚Ä¢ Can only compensate for known disturbances: Disturbances of
the motion system can only be compensated, if they can be measured.
Even with additional measurement these disturbances can only be
compensated to a certain limit, because for perfection the inÔ¨Çuence
of the control should be at least as immediate at the systems output
as the disturbance. This implies an inÔ¨Ånitely fast reaction, which is
practically impossible.

4.1. A Walk around the Control Loop
241
4.1.3
Overview Feedback Control
In feedback control the actual status of the motion system is monitored by a
sensor and the controller generates a control action based on the diÔ¨Äerence
between the desired motion (reference signal) and the actual system status
(sensor signal).
The block diagram of Figure 4.4 shows a single-input single-output (SISO)
feedback loop for a motion system without the A/D and D/A converters. The
output x in [m]2 is the total motion of the plant on all its parts and details,
while y is the measured motion with a measured value ym measured on a
selected location in the plant3. This measured value is compared with
(= subtracted from) rf, which is the reference r after Ô¨Åltering. The result of
this comparison is used as input for the feedback controller.
Feedback control is also called closed-loop control, because the sensor signal
is fed back in a closed-loop to the input of the system.
The transfer function from any input to the output of any functional element
in a feedback controlled system can be derived as follows for an example
where the response to the Ô¨Åltered reference input rf to the output y is
calculated by eliminating the error signal e:
e = rf ‚àíym = rf ‚àíM(s)y,
y = G(s)Cfb(s)e = G(s)Cfb(s)rf ‚àíM(s)G(s)Cfb(s)y
=‚áí
T(s) = y
rf
=
G(s)Cfb(s)
1+ M(s)G(s)Cfb(s).
(4.4)
When applying this method on the response to the other inputs and eliminat-
ing the signal after that input instead of e (so v for the process disturbance,
y for the output disturbance and ym for the sensor disturbance) one can
easily check that the following general statement is true:
The transfer function of any input to any output in a closed-loop
feedback controlled dynamic system is equal to the forward path
from the input to the output divided by one plus the transfer
function of the total feedback loop.
Including the input Ô¨Ålter the total transfer function of the closed-loop feed-
back system from the reference signal r to the output y as shown in Figure 4.4
2For improved readability the units of these control variables are no longer mentioned
unless its omission could cause confusion.
3It is important to be aware of the fact that it is hardly ever possible in a real system to
measure exactly at the point of interest. In practice a representative location is to be chosen
where the deviations between the real and measured value are small or can be compensated
by means of model-based calculations.

242
Chapter 4. Motion Control
Plant 
G(s)
Feedback 
Cfb(s)
Pre-Filter
F(s)
_
e
u
r
y
Measurement 
M(s) 
rf
Input disturbance
Output disturbance
Process 
disturbance
x
Sensor disturbance
v
ym
Figure 4.4: Block diagram of a SISO feedback controlled motion system. Each func-
tional part has its own, mostly frequency dependent transfer function.
is given by:
T(s) = y
r =
G(s)Cfb(s)F(s)
1+ M(s)G(s)Cfb(s).
(4.5)
In control design one has the freedom to choose F(s) and particularly Cfb(s)
such that the total transfer function fulÔ¨Åls the desired speciÔ¨Åcations. It will
be shown in detail that the dynamics of the controlled system can be directly
modiÔ¨Åed by closing the feedback loop. Feedback control allows to directly
place the system poles at values that are more useful for the operation of the
motion system than their natural locations. This enables a faster response
of the system with adequate damping and also enables unstable plants to
be stabilised. This capability is in clear contrast to feedforward control,
where only pole-zero cancellation can be applied for compensation of the
plant dynamics by multiplying its input with the inverse transfer function.
However, it is important to note that the input Ô¨Ålter does not contribute to
this important aspect of feedback, so it is an open-loop control Ô¨Ålter for the
feedback loop. It is mainly used to prevent unwanted signals from entering
the system. These can be signals that drive the system into its ‚Äúincapability‚Äù
region where the system can no longer perform as required due to limitations
in the hardware. It can also contain Ô¨Ålters that compensate certain less
favourable eÔ¨Äects of the feedback loop itself. The importance of dealing with
such limitations in the input Ô¨Ålter are addressed further on in this chapter,
especially in Section 4.2.4 regarding path-planning to cope with limitations
in the hardware and Section 4.4.3.1 regarding the waterbed eÔ¨Äect, showing
that decreasing errors by feedback at one frequency range correspond to
increasing errors at another frequency range.

4.1. A Walk around the Control Loop
243
4.1.3.1
Summary of Feedback Control
Feedback is an addition to feedforward control with the following beneÔ¨Åts:
‚Ä¢ Stabilisation of unstable systems: Not all motion systems are in-
herently stable, some of them are marginally stable, some even unsta-
ble, like an inverted pendulum or a magnetic bearing. As feedback
control enables to determine the place of the closed-loop poles of the
controlled system, unstable poles can be stabilised.
‚Ä¢ Reduction of the eÔ¨Äect of disturbances: Disturbances of the con-
trolled motion system are observed in the sensor signal, and therefore
the feedback controller can compensate for them.
‚Ä¢ Handling of uncertainties: Feedback controlled systems can also
be designed for robustness, which means that the stability and perfor-
mance requirements are guaranteed even for parameter variations of
the controlled mechatronic system.
As already shown, also some pitfalls have to be dealt with:
‚Ä¢ A sensor is required: The feedback loop is closed, based on infor-
mation from a sensor. Therefore feedback control only can be as good
as the quality of the sensor signal allows. In precision positioning
systems accurate sensors are required with high resolution and fast
response, which are very costly. The measurement and sensing system
often takes a substantial part of the total systems budget.
‚Ä¢ Limited reaction speed: A feedback controller only reacts on diÔ¨Äer-
ences between the reference signal and the measured system status,
which means that the error has to occur Ô¨Årst before the controller can
correct for it.
‚Ä¢ Feedback of noise: By closing the loop, the positioning noise of the
motion system as well as sensor noise are also fed back, which has to
be considered at the system and control design.
‚Ä¢ Can introduce instability: Just as feedback control can stabilise
an unstable system, it can also destabilise a stable plant by creating
poles in the right half of the Laplace-plane.
‚Ä¢ Can increase errors: With higher order systems feedback will re-
duce errors in the frequency band where the loop-gain is larger than
one and increase errors just outside that band.

244
Chapter 4. Motion Control
4.2
Feedforward Control
For systems that are open-loop stable it is possible to apply feedforward
control to improve the system performance when following a predeÔ¨Åned
trajectory like a reference signal or a repeating scanning motion. In high
precision mechatronic systems with high productivity optimal tuning of
feedforward control is an important step in avoiding large feedback errors
during the predeÔ¨Åned motion trajectory and consequently long settle times
after the end of the motion. A feedforward controller basically consists of
a Ô¨Ålter, which is placed in series with the plant in order to compensate its
dynamics. The better the dynamic properties of the applied hardware are
known by means of a correct mathematical model, the better one can design
an optimal feedforward Ô¨Ålter to a certain performance criterion.
Feedback
controller
z
x
y
Photo detector
Data 
¬å
]
Piezoelectric
tube scanner
Sample
z
y
x
x
y
z
¬õ
Laser
S$
u(t)
d(t)
Figure 4.5: An overview of the main components of an Atomic Force Microscope
(AFM). The measured sample is mounted on a piezoelectric tube scanner,
which moves the sample fast along the AFM cantilever. The sharp tip
on the cantilever follows the surface and the bending of the cantilever
is kept constant by moving the object in the z-direction with feedback
control. This control action is a measure of the surface topology of the
sample.
(Courtesy of Stefan Kuiper)

4.2. Feedforward Control
245
4.2.1
Model-Based Feedforward Control
In the following an example of a model-based feedforward controller is
introduced. It is used in a scanning unit for an atomic force microscope
with a piezoelectric actuator as shown in Figure 4.5. This unit is applied
in the research of Stefan Kuiper [57] at the laboratory of Systems and
Control at Delft University of Technology as a precision positioning stage
with nanometre resolution at a small range of movement. The measured
frequency-response of this scanning unit is shown in Figure 4.6.
A mathematical model of a second-order mass-spring system with a force
input is Ô¨Åtted to this measured response. The Ô¨Årst eigenmode shows a
weakly damped resonance at the eigenfrequency of 10 kHz. The following
data are obtained by this system identiÔ¨Åcation exercise. The undamped
natural angular frequency of the Ô¨Årst eigenmode4 œâ0 = 2œÄf0 = 6.28¬∑104rad/s.
The other parameters Œ∂f and Cf are the Ô¨Åtted damping ratio and compliance.
With these data Equation (3.35) of the previous chapter gives the transfer
Magnitude (abs)
10
3
10
4
z¬Ç¬Ñ{
z,¬Ü{
z¬Ö{
0
Frequency [Hz]
Phase [deg]
measured data
%'
10
z,{
10
z¬Ü
10
z¬É
10
z)
z¬Ç{{
z,¬É{
z,¬Ç{
z¬Ü{
Magnitude [dB]
Figure 4.6: Bode plot of a piezoelectric-actuator based scanning unit for nanometre-
resolution positioning. It shows the measured response (solid line) and
the second-order model, which is Ô¨Åtted for the low-frequency system
behaviour including the resonance peak, corresponding to the natural
frequency of the Ô¨Årst mode-shape (dashed line).
4The notation œâ0.1 and f0.1 are noted simply as œâ0 and f0.

246
Chapter 4. Motion Control
function of this scanning unit:
G(s) =
Cf
s2
œâ2
0
+2Œ∂f
s
œâ0
+1
=
Cfœâ2
0
s2 +2Œ∂fœâ0s+œâ2
0
[m/N].
(4.6)
When positioning at a high scanning frequency, the resonance at the Ô¨Årst
mode-shape of this scanning unit causes oscillations, which adversely aÔ¨Äect
the tracking accuracy. In order to solve this unfavourable behaviour, a
feedforward controller is designed [75] that compensates the dynamics of
this scanner by Ô¨Årst inverting the transfer function of the plant, without
changing the static gain of the positioning system. This means that the
transfer function of the controller ideally would become equal to:
Cff(s) =
s2 +2Œ∂fœâ0s+œâ2
0
œâ2
0
.
(4.7)
This controller has a pair of zeros, corresponding to an anti-resonance
at the eigenfrequency of the Ô¨Årst eigenmode of the scanner, with equal
damping. Unfortunately these zeros also imply an increasing magnitude of
the transfer function controller at higher frequencies with a +2 slope in the
Bode plot. Such a behaviour is physically impossible so the controller needs
to be modiÔ¨Åed in such a way that it becomes realisable. In this case it is
decided to create a resulting overall transfer function of the controller and
the plant that acts like a well damped mass-spring system with the same
natural frequency as the plant and an additional reduction of the excitation
of higher frequency eigenmodes. In order to realise this controller Ô¨Årst two
poles have to be added, placed at the same frequency as the resonance but
with a higher damping ratio. Typically a damping ratio between aperiodic
and critical (0.7 < Œ∂ < 1) is applied to avoid oscillations. For Œ∂ = 1 this results
in the following transfer function:
Cff(s) =
s2 +2Œ∂fœâ0s+œâ2
0
s2 +2¬∑1¬∑œâ0s+œâ2
0
.
(4.8)
This feedforward controller is basically a notch Ô¨Ålter, because of the notch
shape of the anti-resonance in the Bode plot.
In order to create an additional attenuation of higher frequency resonances
due to Ô¨Çexible-body mode-shapes, another Ô¨Årst-order pole is added at the
Ô¨Årst eigenfrequency, which gives the transfer function of the complete 3rd-
order feedforward controller:
Cff(s) =
s2 +2Œ∂fœâ0s+œâ2
0
(s+œâ0)

s2 +2œâ0s+œâ2
0
.
(4.9)

4.2. Feedforward Control
247
Magnitude (abs)
10
3
10
4
z¬Ç¬Ñ{
z,¬Ü{
z¬Ö{
0
Frequency [Hz]
Phase [deg]
%'
%

10z,{
10z¬Ü
10z¬É
10z)
z¬Ç{{
z,¬É{
z,¬Ç{
z¬Ü{
Magnitude [dB]
Figure 4.7: Bode plot of the feedforward-controlled scanning unit. It shows both the
Ô¨Åtted dynamic model of the scanning unit without control (solid line),
the notch Ô¨Ålter by the 3rd-order feedforward controller (dashed line)
and the resulting compensated dynamics of the combined scanning unit
and controller (dashed-dotted line).
When this controller is connected in series with the scanning unit, the anti-
resonance of the controller and the resonance of the piezo-scanner cancel
each other out. This pole-zero cancellation is the only manipulation on poles
that can be achieved with feedforward control and results in this example
in a well damped third-order transfer function:
Gt,ff(s)=G(s)Cff(s)
(4.10)
=
Cf
((((((((
(s2 +2Œ∂fœâ0s+œâ2
0)
((((((((
(s2 +2Œ∂fœâ0s+œâ2
0)
(s+œâ0)

s2 +2œâ0s+œâ2
0

(4.11)
=
Cf
(s+œâ0)

s2 +2œâ0s+œâ2
0

[m/N].
(4.12)
The Bode plot of the resulting dynamics is shown in Figure 4.7. It demon-
strates the compensation of the resonance at the Ô¨Årst eigenmode of the
scanner. The controlled system has low-pass characteristics, rolling oÔ¨Äat
the scanner‚Äôs Ô¨Årst natural frequency. The beneÔ¨Åcial eÔ¨Äect of such a feedfor-
ward controller on the performance of this scanner is shown in Figure 4.8.
By observing the diÔ¨Äerence between the performance of the open-loop con-
trolled and uncontrolled scanning unit in a triangular scanning motion

248
Chapter 4. Motion Control
0.0
0.5
1.0
1.5
2.0
2.5
3.0
-4
-2
0
2
4
(¬ì¬ú¬ù
"¬ì¬ù
-4
-2
0
2
4
Figure 4.8: Laser-Vibrometer measured scanning motion of the piezoelectric-
actuator driven positioning system in response to a triangular scanning
signal at 1000 lines per second. Without control (upper graph) oscilla-
tions of the scanning unit are clearly observed at the sharp transitions
in the scanning signal. With pole-zero cancellation based open-loop
control (lower graph) these oscillations are suppressed and the tracking
accuracy is improved.
at 1000 lines per second, it is clear that the scanner oscillations are sup-
pressed and also the tracking of the triangular scanning signal is improved
signiÔ¨Åcantly.
4.2.2
Input-Shaping
Another often applied control method is input-shaping. Instead of apply-
ing a Ô¨Ålter in the frequency-domain, with this method the reference signal
is modiÔ¨Åed in the time-domain. As an example of this method, another
piezoelectric-actuator driven scanning unit for nanometre-resolution posi-
tioning is used [77]. In this case the system dynamics of the positioning
system are dominated by a resonance frequency occurring at 22 kHz. When
applying a step signal (in simulation) to the scanning unit, it would start
to oscillate at its natural frequency where the oscillations would fade away
after the step according to the damping of this resonance. In a Ô¨Årst approxi-
mation, the scanner can be assumed to behave like a linear system, which
means that a reduction of the input step stimulus by a factor of two would
result in a reduction of the amplitude of the response by the same factor
two.

4.2. Feedforward Control
249
Scan signal (norm.)
Scan signal (norm.)
6|¬á
6|¬á
1
0.5
0
-0.5
-1
1
0.5
0
-0.5
-1
1
0.5
0
-0.5
-1
1
0.5
0
-0.5
-1
Time [ms]
Time [ms]
0                          0.3                         0.6  
0                          0.3                         0.6  
0                          0.3                         0.6  
0                          0.3                         0.6  
Figure 4.9: Input-shaping control of the triangular scanning signal in a scanning-
probe microscope at 3900 lines per second. The shaping of the input
signal by cutting the top of the triangular signal signiÔ¨Åcantly reduces
oscillations of the moving part. The left column shows the input signals
without (top) and with (bottom) input-shaping while the middle column
shows the resulting motion proÔ¨Åles of the scanner. The pictures on the
right show a set of AFM data of a parallel grating, which has a pitch
of 233 nm. The distortion and reduction of distortion of the grating
structure is clearly visible.
When two of these steps are applied with only half the height of the full
step, the same steady-state response would be obtained as with the full step
stimulus after all oscillations are damped out. If one of these half-height
steps is delayed by half the period of the scanner‚Äôs resonance frequency, the
oscillations caused by each individual step are 180 out of phase and cancel
each other out. This splitting of the reference signal into two (equal) signals
and delaying one of them by half the period of the system‚Äôs resonance is
a typical example of input-shaping. This method clearly is very diÔ¨Äerent
from pole-zero cancellation as it is time-domain instead of frequency-domain
based Ô¨Åltering. In the frequency-domain these sampled adaptations to the
input create a frequency spectrum with a multiple of notch Ô¨Ålters at the
harmonics of the frequency where these adaptations are applied. This
eÔ¨Äect is related to real sampling that will be explained in Chapter 8 on
measuring. With the previous example of the feedforward controller with
pole-zero cancellation it was shown that a triangular scanning signal to
the scanning unit ‚Äútriggers‚Äù oscillations after each change of slope of the
triangular signal. These are caused by the discontinuity in the derivative

250
Chapter 4. Motion Control
and the corresponding higher harmonics of the triangle waveform as pre-
sented by Fourier analysis in Chapter 2. Applying input-shaping to this
triangular scanning signal results in the introduction of a plateau instead
of the sharp peak, where the width of the plateau corresponds to half the
period of the scanner‚Äôs resonance as can be seen in Figure 4.9. When at a
positive slope the scanning signal reaches the plateau and stops raising,
the scanner starts to oscillate at its natural frequency, so with a sinusoidal
motion. After half the period of this oscillation, the scanner is arrived at the
same position as where the oscillation started, but it is moving with almost
the same speed in the opposite direction, due to the low damping. When at
that moment the scanning signal is changed into a negative slope, a smooth
transition is realised, without further exciting the scanner‚Äôs resonance, and
the actual motion follows the desired triangular scanning motion.
4.2.3
Adaptive Feedforward Control
It is important to emphasise that both examples of feedforward control, the
model-based pole-zero cancellation and the input-shaping, only work reliably
as long as the dynamic properties of the total plant are known and remain
constant. These dynamics include the transfer functions of all physical
elements of the system, including mechanics, actuators and ampliÔ¨Åers. In
reality often external inÔ¨Çuences have an impact on these dynamic properties,
leading to an increasing deviation between the parameters in the model
and the reality. This deviation can be partly solved by adaptive feedforward
control, adapting the feedforward signal by measuring the real behaviour of
the system. This method requires a sensor to obtain information about the
response of the system and for that reason it is often applied in combination
with feedback. An example of real-time adaptive feedforward, where the
mass of a moving body is estimated, is described by Hans Butler [19] from
ASML. It includes snap feedforward, the second derivative over time of the
acceleration, resulting in this example into an additional error reduction of
a factor two. For repetitive processes, the required feedforward signal can
be derived from the previous cycles. This version of adaptive feedforward
control is called Iterative Learning Control(ILC). By measuring the output
of a motion system over the known trajectory and comparing the measured
behaviour with the intended behaviour, information is gathered about the
amount of error in the model and the direction of the necessary correction.
Much experience is gained in the laboratory of Control Systems Technology
at Eindhoven University of Technology where the research group of Tom
Oomen applied the principle on several high precision machines ( [12],

4.2. Feedforward Control
251
[69]). Another example is the application in a fast tool servo for turning
irregular optical surfaces as described by Stephen Ludwick a.o [62] and
Marten Byl a.o. [21] both from the laboratory of Precision Motion Control
at MIT.
4.2.4
Trajectory ProÔ¨Åle Generation
The previous sections presented diÔ¨Äerent methods to cope with or even
make use of certain dynamic properties of the plant. One generic element in
feedforward control is the need to address the limitations and dynamics of a
mechatronic system, whether deÔ¨Åned by mechanical strength, stiÔ¨Äness and
mass of the diÔ¨Äerent parts, the ability to apply a certain force or the time
needed to perform a certain task. And indeed, like with human beings, it is
also generally unwise to demand actions from a machine that it can‚Äôt fulÔ¨Åll5.
In the following chapters the limitations of the actuators and electronics
in a controlled motion system are presented. With most high performance
designs these appear related to limitations in the derivatives over time of
the position:
‚Ä¢ dx/dt = Velocity.
‚Ä¢ d2x/dt2 = Acceleration.
‚Ä¢ d3x/dt3 = Jerk.
‚Ä¢ d4x/dt4 = Snap.
‚Ä¢ Plus the higher derivatives like Crackle, Pop etc.
Of these at least the levels of Jerk and preferably also Snap should be limited
in order to keep the controller ‚Äúin control‚Äù. The standard method to cope
with these limitations involves shaping the input of a mechatronic motion
system by means of trajectory proÔ¨Åle generation or path-planning.
Figure 4.10 shows a fourth-order trajectory proÔ¨Åle of a displacement, which
means that all derivatives including the fourth derivative, the snap, are
deÔ¨Åned in the path-planning.
A third-order trajectory would show a square proÔ¨Åle for the jerk indicating
an inÔ¨Ånite Snap and the rounding of the acceleration would be gone.
A second order trajectory would show a square acceleration proÔ¨Åle with
inÔ¨Ånite Jerk and sharp edges on the velocity.
5This statement is true for any mechatronic system, with or without feedback control of the
plant. Although this part is presented here as feedforward control it is applied to the guidance
signal from Figure 4.1 hence equally applied to the reference of the feedback part.

252
Chapter 4. Motion Control
0
0.05
0.1
0.15
0.2
0.25
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Posion
Time [s]
[m]
0
0.05
0.1
0.15
0.2
0.25
0
0.5
1
1.5
2
2.5
3
Velocity
Time [s]
[m/s]
0
0.05
0.1
0.15
0.2
0.25
-60
-40
-20
0
20
40
60
Acceleraon
Time [s]
[m/s  ]
0
0.05
0.1
0.15
0.2
0.25
-4000
-3000
-2000
-1000
0
1000
2000
3000
4000
Jerk
Time [s]
[m/s  ]
2
3
Figure 4.10: 4th-order trajectory proÔ¨Åle of a displacement shows even a deÔ¨Åned
slope of the Jerk over time, representing a constant maximum Snap
level.
Courtesy of Rik van der Burg.
First-order trajectories with inÔ¨Ånite acceleration and constant velocity steps
are the worst of all. In practice a Ô¨Årst order trajectory is never applied in
a precision system as it guarantees trouble by overshoot, long settle times
and may even cause damage.
Second order and third order trajectories are used in less critical applications
with low requirements on high frequency behaviour.
In principle one could argue that none of these proÔ¨Åles looks ‚Äúnatural‚Äù,
because the motion of real physical systems will never show an inÔ¨Ånite
value for any order of diÔ¨Äerentiation. Ideally for a perfect feedforward signal
one should generate an indeÔ¨Ånite-order trajectory, which would result in an
indeÔ¨Ånite number of calculations. Fortunately the remaining errors due to
the higher order derivatives are quickly decreasing while the application of
an additional low-pass Ô¨Ålter can soften the sharp edges. Indeed low-pass
Ô¨Åltering is often applied in lower-order trajectory proÔ¨Åles.

4.3. Feedback Control
253
4.3
Feedback Control
In the previous section on feedforward control it was shown how this method
can improve the performance of an open-loop stable system with known
properties and circumstances. Striving for a maximum of predictability
of the dynamic behaviour of a mechatronic system is an important part
of the design, because of the beneÔ¨Åts of feedforward control. In spite of
these eÔ¨Äorts, even with the most sophisticated models and by suppressing
and compensating external disturbances to the best level possible, almost
always some remaining errors need to be corrected by feedback control.
Furthermore motion systems with inherent instability, like a magnetic
bearing, with poles in the right-half-plane or free Ô¨Çoating objects like the
optical pick-up unit of a CD player require feedback control for stabilisation.
Feedback control is more complex and critical to design than feedforward
control due to the inherent risk of instability. For that reason it receives
generally more attention in scientiÔ¨Åc papers and books on control. Over the
last decades several methods have been thoroughly investigated to optimise
a feedback controller according to certain optimisation criteria. In most
cases these innovations were driven by the new possibilities of fast computer
systems. These enabled ‚Äúreal-time‚Äù modelling and control of higher-order
non-linear systems with properties that are situational dependent and
change over time.
4.3.1
Sensitivity to Input Signals
The behaviour of a feedback control loop is determined by its reaction to
diÔ¨Äerent inputs that act on the system. Without any inputs the system
would stay in an equilibrium state, assuming that the system is stable.
Generally a feedback controlled motion system is to perform a certain pre-
determined motion task deÔ¨Åned by the reference input r, while reducing the
eÔ¨Äects of other inputs like external vibrations and noise from the electronics.
All these input signals, whether desired or undesired, are treated by the
feedback loop as disturbances and it is the sensitivity of the desired output
signal to all input signals that determine the performance of the feedback
controller.

254
Chapter 4. Motion Control
Plant 
G(s)
Feedback 
Cfb(s)
Pre-Filter
F(s)
_
Process disturbance 
d
Output disturbance
n
e
u
v
x
r
y
rf
Measurement 
M(s) = 1 
Sensor disturbance
Plant 
G(s)
Feedback 
Cfb(s)
Pre-Filter
F(s)
_
Process disturbance 
d
Output disturbance
n
e
u
v
x
r
y
rf
ym
ym
y

Figure 4.11: Full and simpliÔ¨Åed representation of a feedback loop in order to de-
termine the inÔ¨Çuence of the reference signal and the most important
disturbance sources on real motion output of the plant x, the feedback
controller output u and the measured motion output y. The reference
and feedback control input are in the same position domain as the real
and measured motion outputs of the system. The process disturbance
in [N] includes all force related disturbances from within the plant.
The output disturbance in [m] represents all position related distur-
bances that change the measured position. ym is the measurement
value as determined by the sensor for the measured output of the
system. The sensor disturbance in [m] represents the measurement
error. ym = y when the measurement system is set at unity gain and
the sensor disturbance is included in the output disturbance.
4.3.1.1
Sensitivity Functions
Several standard sensitivity functions have been deÔ¨Åned to quantify the
performance of feedback-controlled dynamic systems. They are derived from
a simpliÔ¨Åed version of the generic feedback loop as shown in the second block
diagram of Figure 4.11. The Ô¨Årst simpliÔ¨Åcation is made by approximating
the measurement system to have a unity-gain transfer function. This means
that for this thinking model the reference and the input of the controller
work in the same position domain as the output of the system. For further
simpliÔ¨Åcation the sensor disturbance in the measurement system is included

4.3. Feedback Control
255
in the output disturbance n, thereby deÔ¨Åning the output of the system y as
the measured output. The process disturbance can be anything occurring
between the output of the feedback controller and the output of the plant.
For reason of further simpliÔ¨Åcation it is inserted in the model between the
plant and the controller6. With this simpliÔ¨Åed model, the transfer functions
of the diÔ¨Äerent inputs of the system to three relevant output variables in
the loop are written down in a set of equations. The input variables include
the reference and the two remaining sources of disturbances. The Ô¨Årst
output variable is x for the output of the plant, being a subset of the system-
states, which will be introduced in Section 4.6. The second and third output
variables are y for the output of the total system and u for the output of the
controller. In these transfer functions for simplicity the Laplace operator (s)
is omitted and C = Cfb:
x= GCF
1+GC r +
G
1+GC d ‚àí
GC
1+GC n
(4.13)
y= GCF
1+GC r +
G
1+GC d +
1
1+GC n
(4.14)
u=
CF
1+GC r ‚àí
GC
1+GC d ‚àí
C
1+GC n.
(4.15)
It should be noted that these transfer functions are written in a purely single
dimensional notation with scalar values. When more degrees of freedom are
controlled the diÔ¨Äerent upper-case letters become matrices and the lower-
case letters become vectors. With multiplication of matrices the successive
order is important and the shown order is valid for the deÔ¨Åned feedback loop
from Figure 4.11. When for instance disturbance d is neglected, the vector
notation would be x = Gv and v = Ce, which gives x = GCe. Although these
transfer functions consist of a combination of nine transfer functions, one
for each input-output combination, some of them are the same. When these
doubles are omitted, six diÔ¨Äerent transfer functions remain as shown in
Table 4.1. These functions are also called the gang of six, a term introduced
by the Swedish control scientist Karl Johan √Östr√∂m from Lund University [3],
because this set of transfer functions gives an interesting insight in how the
feedback controlled system reacts to the diÔ¨Äerent system inputs.
The transfer functions of the Ô¨Årst column shows the inÔ¨Çuence of the reference
signal on the output of the plant and on the output of the feedback controller.
The Ô¨Årst transfer function of the second column gives the inÔ¨Çuence of the
6These simpliÔ¨Åcations are allowed as any real disturbance can be mathematically converted
into either an output disturbance or process disturbance by using the model of the plant and
the measurement system, while the real gain of the measurement system represents only a
scaling factor for the output.

256
Chapter 4. Motion Control
Table 4.1: Gang of six.
x
r = y
r = GCF
1+GC
‚àíx
n = ‚àíu
d =
GC
1+GC
x
d = y
d =
G
1+GC
u
r =
CF
1+GC
u
n =
C
1+GC
y
n =
1
1+GC
output disturbance on the output of the plant, while both transfer functions
in the second column give the inÔ¨Çuence of the two disturbances on the output
of the controller. The Ô¨Årst transfer function in the third column shows how
the output of the plant reacts to the process disturbance. The second transfer
function of the third column gives the inÔ¨Çuence of the output disturbance on
the output of the total system. In case no input Ô¨Ålter is applied F is equal
to one and the Ô¨Årst column becomes equal to the second column, reducing
the gang of six to the gang of four as shown in Table 4.2. This short set
of equations also corresponds to the situation without a reference like the
pure error feedback system of the CD-player. From these four, three are
most widely used although their relative importance for precision motion
systems is changed over the years due to the increased possibility to achieve
an almost perfect level of feedforward control by means of fast computers.
The most important transfer function is just named the Sensitivity Function
S(s), ‚ÄúSensitivity‚Äù in short, corresponding to the second transfer function of
the second column of the gang of four. It represents the sensitivity of the
output to a disturbance on the output. With motion systems it is generally
a displacement, for instance caused by external vibrations.
It is closely followed in importance by the Process Sensitivity Function
GS(s), ‚ÄúProcess Sensitivity‚Äù in short, equal to the Ô¨Årst transfer function
in the second column of the gang of four. It has the unit [m/N], because it
represents the sensitivity of the output to disturbances inside and before
the plant. With motion systems this generally relates to disturbing forces.
Finally the Complementary Sensitivity function T(s), in short also called
‚ÄúComplementary Sensitivity‚Äù or closed-Loop response completes the set. It
Table 4.2: Gang of four.
x
r = y
r = ‚àíx
n = ‚àíu
d =
GC
1+GC
x
d = y
d =
G
1+GC
u
r = u
n =
C
1+GC
y
n =
1
1+GC

4.3. Feedback Control
257
corresponds to the Ô¨Årst transfer function of the Ô¨Årst column of the gang of
four. It is dimensionless, because it represents the ability of the system to
follow a given reference position signal.
With electronic ampliÔ¨Åers as presented in Section 6.2.3.2 of Chapter 6 the
Complementary Sensitivity is the leading criterion for feedback control.
For motion systems it is less important, because by using model-based
feedforward control for handling known inputs, feedback should only be
applied for correction of unknown factors caused by disturbing inputs and
for creating stability in systems with inherent instability. For that reason
the most relevant motion system performance criteria are the Sensitivity
S(s) and the Process Sensitivity GS(s).
The Sensitivity can be written as follows in full Laplace notation:
S(s) = y
n =
1
1+G(s)Cfb(s)
[‚àí].
(4.16)
The Process Sensitivity equals in full Laplace notation:
GS(s) = x
d = y
d =
G(s)
1+G(s)Cfb(s)
[m/N].
(4.17)
Written in full Laplace notation the Complementary Sensitivity equals:
T(s) = x
r = y
r = ‚àíx
n =
G(s)Cfb(s)
1+G(s)Cfb(s)
[‚àí].
(4.18)
The name ‚Äùcomplementary‚Äù in T(s) is based on the fact that T(s) and S(s)
add to unity, (T(s)+ S(s) = 1).
A common factor in all three sensitivity functions is the Feedback-loop
Transfer Function L(s) = G(s)Cfb(s) with the Feedback-loop response7L(œâ) or
L(f ) as its frequency-domain counterpart of which the magnitude is called
the loop-gain. It represents the full path from error to measured output
so it excludes the -1 step. It is very clear that the higher its magnitude
the better the performance of the feedback controller will be in respect to
7Important Notice: The feedback-loop response is often called the open-loop response.
Generally the open-loop response of a system is the response of the output of the system to
an input without applying feedback. For a motion system that follows a reference input
it includes the feedforward part and preÔ¨Ålter while it excludes the measurement path. The
feedback-loop response is also an (so not the) open-loop response as it is the response of the
measured value of the output to a signal on the input of the controller before closing the loop
so excluding the -1 subtraction point. This means that both terms are only equal when
both the input Ô¨Ålter and the measurement are equal to unity and feedforward control is not
applied. As the term ‚Äúopen-loop response‚Äù is often used in practice not only with feedforward
control but also for the feedback-loop one should be aware of this diÔ¨Äerence in terminology.

258
Chapter 4. Motion Control
the sensitivity functions. With a given transfer function G(s) of the plant
it might be concluded that tuning a feedback controller would be easy as
a perfect feedback controller could be made by simply increasing the gain
of the elements in the loop that determine Cfb(s). Unfortunately in the
following section criteria for necessary stability have to be presented, which
in practice limit the maximum achievable level of the loop-gain. Using a
number of examples it will also be shown that these limitations determine a
frequency range where the error is increased by feedback control. But Ô¨Årst
an important other remark must be made, because one disturbance eÔ¨Äect is
not reduced by a high loop-gain. With feedback of a measurement signal
the quality of the sensor determines the minimal achievable error. An error
in the measurement directly converts into a position error of the system as
explained in the following on real feedback error sensitivity.
4.3.1.2
Real Feedback Error Sensitivity
The three sensitivity functions were deÔ¨Åned as the impact of any of the
inputs to the measured output y. In reality we would be more interested in
errors at the real position x and even though these cannot be measured, it is
worthwhile to investigate the real feedback error sensitivity, when the error
is the diÔ¨Äerence between the reference r and x. By using Equation (4.13)
with F = 1 and applying a statistical addition assuming the inputs are
uncorrelated the following sensitivities are obtained.
e2
real = (r ‚àíx)2 =

(r ‚àíx)
r
r
2
+

(r ‚àíx)
d
d
2
+

(r ‚àíx)
n
n
2
=

r ‚àí
GC
1+GC r
2
+

G
1+GC d
2
+

GC
1+GC n
2
=

1
1+GC r
2
‚àí

G
1+GC d
2
+

GC
1+GC n
2
=‚áí
ereal = r ‚àíx =

(S(s)r)2 +(GS(s)d)2 +(T(s)n)2
[m].
(4.19)
This clearly points out that a high control gain C(s) only reduces errors
related to the reference and the process disturbance but not the errors
included in n that originate in the measurement system, because T(s) will
approach unity with a high control gain. It emphasises the need for a reliable
sensor, which gives the required information without additional errors.

4.3. Feedback Control
259
4.3.2
Stability and Robustness in Feedback Control
The inverted pendulum is one of the most used examples of an unstable
passive mechanical system where the successful application of feedback for
stabilisation is used. Also a magnetic bearing is a typical device that cannot
be used without feedback. These systems are characterised by a negative
stiÔ¨Äness. The further it deviates from its unstable equilibrium position the
stronger the force is that moves it away from that position. To illustrate the
eÔ¨Äect in the Laplace-domain the transfer function can be derived from the
general compliance transfer function of a standard mass spring system.
The compliance without damping was shown to be equal to:
Ct(s) = x
F =
1
ms2 + k
[m/N].
(4.20)
The poles of this transfer function are determined by the value of s = œÉ+ jœâ
where the denominator becomes equal to zero:
ms2 + k = 0
=‚áí
s2
0 = ‚àík
m
=‚áí
s0 = ¬±

‚àík
m.
(4.21)
A spring with a negative stiÔ¨Äness implies that the stiÔ¨Äness has a negative
value (k = ‚àíkn) and as a consequence the term under the square root is
positive, which means that the two poles of this transfer function are both
real with a value of ¬±
4
kn/m. One of these values is positive, which means
that the location of this pole is on the real axis in the right-half of the
Laplace-plane, indicating an instable pole. The corresponding instability
manifests itself by a motion with increasing acceleration away from the
unstable equilibrium position.
With feedback control such an unstable system can be stabilised by shifting
the positive pole from the right to the left-half of the Laplace-plane. This
eÔ¨Äect can be explained with the example of Chapter 3 where proportional
negative feedback is shown to create a spring with a positive stiÔ¨Äness for
the positioning of an optical pick-up unit of a CD player. Another example is
the application of negative feedback to a mechanical system with a negative
stiÔ¨Äness like a magnetic bearing, which will be presented in Section 4.4.6.
The resulting positive stiÔ¨Äness of the feedback control action can compensate
the negative stiÔ¨Äness of the plant when the total loop-gain is suÔ¨Éciently
high. The resulting positive stiÔ¨Äness creates a normal mass-spring system
with two conjugate complex poles on the imaginary axis when the positive
stiÔ¨Äness by the feedback is even higher than the negative stiÔ¨Äness of the
mechanical system. This transformation implies that the unstable pole
on the right-half of the Laplace-plane is shifted towards the left-half of

260
Chapter 4. Motion Control
the Laplace-plane by the negative feedback. The addition of damping by
diÔ¨Äerentiating the feedback signal, as will be explained later, will move
the poles even further to the left and such a feedback controlled magnetic
bearing will behave just like any other well-controlled positioning system.
4.3.2.1
Stability margins
To achieve suÔ¨Écient robustness against instability in closed-loop feedback
control of a motion system several margins are deÔ¨Åned that are applied in
the analysis of the transfer function of the feedback loop.
When not keeping these margins in mind, feedback can induce instability in
a normally stable system as can be explained with the simple example of the
CD player from Chapter 3. It was demonstrated that a negative proportional
feedback loop creates a virtual system acting as a mechanical spring driving
the moving part towards the neutral position. By only reversing the sign
(= 180‚ó¶phase) of this feedback loop, it is clear that a negative stiÔ¨Äness is
be created driving the moving mass with increasing force away from the
neutral position, a typical property of instability.
A system that has exactly 180¬∞phase-lag at the unity-gain cross-over fre-
quency is called marginally stable, like for example the CD player with only
P-control. In this situation the smallest additional time-delay or phase-lag
would make the closed-loop system unstable. For this reason the condi-
tion for robustness of closed-loop stability is that the total phase-lag of the
total feedback-loop, consisting of the feedback controller in series with
the mechatronic system, must be less than 180¬∞in the frequency region of
the unity-gain cross-over frequency. To determine the stability one can also
analyse the poles of the closed-loop system, where the stability condition is
the same as for any linear system. For asymptotic stability all system poles
have to have a strictly negative real part, which means that they have to be
located in the left-half of the Laplace-plane.
The Nyquist plot of the feedback loop, like the example shown in Figure 4.12,
is most appropriate to analyse the robustness on stability of a feedback
system. As explained in Chapter 2 it is an analysis tool that shows the
frequency response of the feedback loop8 combining magnitude and phase
in one plot. Like mentioned its use is based on the Nyquist Stability Theorem,
stating that a closed-loop transfer function will not have poles in the right
half of the Laplace-plane, when the Nyquist plot of the feedback-loop transfer
8The emphasis on closed-loop and feedback-loop is based on experience with students who
have problems in imagining the presented tools in relation to this diÔ¨Äerence.

4.3. Feedback Control
261
z¬Å
z)
z[
z¬Ç
z,
0
z[
z¬Ç
z,
0
,
¬Ç
,{
¬É
)
¬Ç
&¬ï
¬ã$¬ï
6
$
T(s)¬ä,
{
T(s)¬ä,¬Ç¬Å
T(s)¬ä,¬É
T(s)
¬ä¬Ç
T(s)¬ä[¬Ç
¬à$
¬ã$
/¬å
,
z¬Å
z)
z[
z¬Ç
z,
0
&¬ï
¬ã$
/¬å


$
]#
¬É
S(s)max=2
Figure 4.12: Nyquist plot of the feedback-loop response of a stable feedback con-
trolled motion system. Stability is guaranteed as the ‚àí1 point is kept
at the left-hand side of the feedback-loop response-line upon passing
with increasing frequency, even though the phase-lag is more than
180¬∞at low frequencies. In this example the phase margin of ‚âà40¬∞and
gain margin of ‚âà2 result in a maximum magnitude Q of the corre-
sponding Complementary Sensitivity of ‚âà3dB as can be estimated by
the smallest dashed circle that just is touched by the response-line. As
not all possible circles are drawn it would be a circle between the 2dB
and 4dB circle. The right graph shows another circle with a diameter
of 0.5, centred around the -1 point. This circle relates to the maximum
value of the Sensitivity at the frequency where the response plot just
touches the circle.
function does not show a net clockwise encircling of the -1 point on the real
axis when following the graph with increasing frequency 9.Generally it is
remembered as keeping the -1 point at the left hand side when following
the graph with increasing frequency. The stability analysis with a Nyquist
plot is done by examining the distance and direction of the plotted response
graph of the feedback-loop relative to the location of the ‚àí1 point. In this
Ô¨Ågure two graphs are shown, designed for a diÔ¨Äerent purpose. The Ô¨Årst
graph from the left shows margin circles related to the capability of the
closed-loop feedback controlled system to follow a reference according to
the Complementary Sensitivity. The second graph shows a margin circle
related to the capability of the closed-loop feedback controlled system to
suppress disturbances according to the sensitivity function.
9This -1 point on the real axis is generally referred to as simply ‚Äúthe -1 point‚Äù in stability
analysis.

262
Chapter 4. Motion Control
Three values are shown in Figure 4.12 related to the robustness of the
closed-loop feedback system, the stability based gain margin and phase
margin and the Sensitivity S(s) based modulus margin or vector margin.
The gain margin determines by which factor the feedback loop-gain addi-
tionally can increase before the closed-loop system goes unstable. It
is deÔ¨Åned by the distance between the loop-gain L(s) and unity-gain
at the frequency where the phase-lag of L(s) becomes more negative
than ‚àí180‚ó¶10 The gain margin can have values between one and inÔ¨Å-
nite. With Ô¨Årst- and second-order transfer functions where the phase
does never become more negative than ‚àí180¬∞the gain can be increased
theoretically to inÔ¨Ånite, corresponding to an inÔ¨Ånite gain margin.
The phase margin determines how much additional phase-lag at the
unity-gain cross-over frequency is acceptable before the closed-loop
system becomes unstable. It is deÔ¨Åned by the diÔ¨Äerence between the
actual phase-lag of L(s) and -180¬∞at the unity-gain cross-over frequency.
The modulus- or vector margin is deÔ¨Åned by the closest distance in a
Nyquist plot between the graph and the ‚àí1 point. It determines the
highest level of the Sensitivity S(s) in the frequency range where the
error is increased by feedback.
As mentioned, the Nyquist Stability Theorem tells us that a closed-loop
system is stable when the Nyquist plot of the feedback loop is kept at the left
hand side with increasing frequency. The robustness margins determine
how much the properties of the system are allowed to change before the
system becomes unstable. However, this is not the only aspect that is
inÔ¨Çuenced as there is no sharp transition between stable and unstable.
With smaller margins the system will behave more nervous, less damped.
When all margins are ‚Äúconsumed‚Äù the system is marginally stable. It will
be shown in the examples in this book that higher margins correspond to a
higher level of damping. For that reason circles are added to the Nyquist
plot that enable the control designer to determine the closed loop response
from the feedback-loop response when tuning the system. For systems that
need to follow a reference, circles are shown in the Ô¨Årst graph from the left
10In the example of Figure 4.12 it is the point where -180¬∞is approached from below, so
where the gain is less than one. In this example one can also deÔ¨Åne another gain margin for
the lowest value of the controller gain where the other point crossing -180¬∞(now from above
at a gain of -4) approaches -1. Generally the Ô¨Årst version is meant but in conditionally stable
systems like the one of the example of Figure 4.12 the second one is equally important.

4.3. Feedback Control
263
that determine the magnitude of the response at the frequencies where it
crosses these circles. A smaller circle corresponds to a higher magnitude of
the closed-loop Complementary Sensitivity response.
At the frequency where the plot just touches the smallest circle the value is
equal to the peak level Q of the resonance caused by the servo-stiÔ¨Äness by the
feedback controller with the moving mass, as was explained in Chapter 3.
These circles do not have their centre at the ‚àí1 point on the real axis but on
a shifting point to higher negative real numbers for a lower magnitude.
These circles are derived from the magnitude |T(s)| of the Complementary
Sensitivity in the Nyquist plot for a certain magnitude level T:
|T(s)| =
|GC|
|1+GC| =
4
Re2 +Im2
4
(1+Re)2 +Im2 = T.
(4.22)
With a bit of algebra this results in:

Re+
T2
T2 ‚àí1
2
+Im2 =

T
T2 ‚àí1
2
.
(4.23)
This equation represents a circle with its centre on the real axis at a distance
D from the origin and with a radius r:
D = ‚àí
T2
T2 ‚àí1
and
r =
T
T2 ‚àí1.
(4.24)
The Sensitivity is the most important performance criterion for systems
that have to be optimised for disturbance rejection. In that case it is more
useful to draw a circle around -1 on the real axis. Often a radius 0.5 is
chosen, corresponding to a maximum Sensitivity of two (6dB), which means
that the disturbance signal is maximally ampliÔ¨Åed by a factor of two at the
frequency where the Nyquist plot just touches this circle.
This circle is explained as follows: The Sensitivity equals S(s) = 1/(1+GC).
This function reaches its maximum when the absolute value (or modulus)
of the denominator is minimum. For a maximum value of s(s) ‚â§2 (6dB) this
means that |1+GC| should be ‚â•0.5, which is the case when 1+GC remains
outside a circle with a radius of 0.5 around the origin. This is equivalent for
the situation where GC remains outside a circle with a radius of 0.5 around
-1. The margin related to this circle is called modulus margin because of the
absolute value of the distance to the -1 point.

264
Chapter 4. Motion Control
Phase and Gain Margin in the Bode Plot
The Nyquist plot has one signiÔ¨Åcant disadvantage as it does not show directly
the frequency along the plot. For that reason many designers prefer to use
the Bode plot.
Fortunately it is also possible to indicate the phase and gain margin in the
Bode Plot as is shown in Figure 4.13. By following the vertical line at the
frequency where the magnitude crosses the 0dB level the phase margin is
equal to the distance of the phase plot to -180¬∞.
Likewise the gain margin is found by following the vertical line at the
frequency where the phase crosses the -180¬∞phase.
In many not too complicated cases these two margins are suÔ¨Écient to tune
a feedback motion controller as will be shown with the Ô¨Årst example of the
next section on the CD-player.
In more complicated control systems it remains useful to also use the Nyquist
plot as it also gives the Modulus Margin. Its further value will be shown in
several examples of the following section.
10
z2
10
z1
10
0
10
1
10
2
Magnitude (abs)
10
2
10
3
10
4
-90
Phase [deg]
Frequency [Hz]
z40
20
40
Magnitude [dB]
10
1
-135
-180
-225
z20
0
Phase Margin
Gain Margin
Figure 4.13: The gain and phase margin in the Bode Plot.

4.4. PID Feedback Control
265
4.4
PID Feedback Control
The classical PID-control principle, where PID stands for a proportional-
integral-diÔ¨Äerential Ô¨Ålter characteristic of the feedback loop, is the dominant
method for designing motion controllers in industry. This is mainly due
to its relatively straightforward mode of operation by modifying frequency
responses with Ô¨Ålters and gain factors. Generally PID-control results in a
suÔ¨Écient performance, while non-linearity can be dealt with by linearis-
ing the system around its working point. When necessary the controller
parameters are adapted for each working point or area of working points.
An example of such adaptation by gain-scheduling will be presented in Sec-
tion 9.5 in the last chapter of this book about waferscanners. Knowledge
about the diÔ¨Äerent properties of PID-control has shown to be crucial for the
practical design of high performance mechatronic systems. For this reason
PID-control is presented in full depth in this section.
A systematic method to determine the parameter settings of a practical PID-
controller is introduced by means of a series of basic examples. The models
are limited to second- and fourth-order dynamic systems and give suÔ¨Écient
insight in the principle of PID-control to be able to apply the method on real,
higher order systems.
The examples are presented in the following successive order, determined
by the dynamic structure of the system:
1. PID-control of the optical pick-up unit of a CD player as presented
in Chapter 3 as example of a non-supported, zero-support-stiÔ¨Äness,
second-order mass-based system. Its dynamic behaviour is charac-
terised by a -2 slope. While it was already shown how a virtual spring
can be created by proportional position feedback it will be shown how
damping is created by a diÔ¨Äerentiating action and how low-frequency
gain can be increased by means of I-control.
2. I-Control is further explained with the control of a moving body sup-
ported by a compliant spring, like a leaf spring or membrane. Without
feedback control it shows a clear resonance and a Ô¨Çat spring-line re-
sponse at frequencies below the resonance. The necessity to achieve a
zero steady state error in a deÔ¨Çected state of the spring as well as in
the neutral position drives the need for I-Control.
3. The presence of the waterbed eÔ¨Äect which shows that feedback not only
reduces errors but also increases them outside the control bandwidth
and potential problem of Integrator wind-up are addressed separately.

266
Chapter 4. Motion Control
4. A fourth-order system is used to model a more realistic system where
the plant is not acting as one rigid body. It shows a compliant mutual
connection between two parts of the plant, introducing a non-rigid
eigenmode where the sensor cannot follow the actuator above the
eigenfrequency of this mode. Often such an internal actuator mode
has a high-Q resonance and it is shown how one can deal with it.
5. The dynamics of a piezoelectric actuator is characterised by its high
actuator stiÔ¨Äness. It is an extreme version of the mass-spring system
of the second example with a spring-line response that stays Ô¨Çat to
high frequencies, requiring an even more aggressive application of
I-control, like I2-Control.
6. The Ô¨Ånal example is a system with negative stiÔ¨Äness, like a magnetic
bearing. It combines the characteristics of a stiÔ¨Ästructure like the
piezoelectric actuator but with an inverse phase. PID-Control is shown
to be able to stabilise and control the system.
After the presentation of these application cases the method is reÔ¨Åned in a
section on loop-shaping design and summarized in an overview of design
rules that can be followed to design a robust and performing feedback
controller.

4.4. PID Feedback Control
267
4.4.1
PID-Control of a Compact-Disc Player
In Section 3.1.2 of the previous chapter active feedback control of the optical
pick-up unit for a compact disk player was presented. It fulÔ¨Ålled the control
task to limit the maximum position error with respect to the track of the CD.
This topic is a typical example of a mass-based second order system with a
zero-stiÔ¨Äness connection to the stationary world. The presented example
targeted the radial position error Œ¥r as the most sensitive value in respect
to shocks leading to a 25 Hz vibration of the frame of the CD-drive and it
was shown how a feedback control system can be used to create a virtual
stiÔ¨Äconnection between the radial track position xr and the position xs of
the measured radial position of the optical pickup unit. This is visualised
by a mechanical spring, as indicated in Figure 4.14. The required reduction
of the non-controlled error of the radial position of 200 Œºm at 25 Hz with a
factor 103 to 0.2 Œºm error was achieved in the following steps:
‚Ä¢ First the necessary radial stiÔ¨Äness kr of the connection was calculated
by considering the force that needs to be transmitted through the
connection stiÔ¨Äness and the allowable elongation. With a maximum
allowable elongation/deviation of 0.2 Œºm, a vibration of 200 Œºm at
25 Hz and a mass of m = 1¬∑10‚àí2 kg the minimum required stiÔ¨Äness
was calculated to be 2.5¬∑105 N/m.
‚Ä¢ The combination of the mass and stiÔ¨Äness resulted in a corresponding
undamped natural frequency f0 = 800 Hz.
‚Ä¢ The stiÔ¨Äness was created by a feedback circuit in which a measured
relative displacement was transformed into a counteracting propor-
tional force from the actuator, which makes the controller act like a
spring.
Optical disk
Optical
Pick-up
Unit
Radial tracking
rk
r
m
xr
xs
x
Figure 4.14: The optical disk pick-up unit of a CD player is connected to the track
by means of a ‚Äúvirtual‚Äù spring, created by the position control system.

268
Chapter 4. Motion Control
Plant 
G(s)
Feedback 
Cfb(s)
Measurement 
M(s) 
r
y

u
Output
disturbance
r = 0
e
	

Power ampli%er
Actuator
      G 

Measurement
I     G u

a
o
F
G I

oI
pu
o            p   p
m           m    r
	
Controller
m
Moving 
body
2
F
x
ms

a
a r
r = 0
u    G  

p           c 


c 
c 
e
e
s
m

y
 m
xr
xs
xr
Figure 4.15: CD player modelled as a mass-spring system with a virtual spring,
created by closed-loop feedback control. The plant consists of the
power ampliÔ¨Åer, actuator and moving body. In combination with the
controller the total system can be described by the simple feedback
loop as shown at the second diagram below. The output disturbance,
consisting of the radial movement xr of the track due to shock induced
vibrations, directly contributes to the output y = xs ‚àíxr = Œ¥r of the
plant.
‚Ä¢ The spring stiÔ¨Äness was equal to the total gain Gt of the feedback
controller, consisting of the combination of the gain of the measurement
system, the controller, the power ampliÔ¨Åer and the actuator, as shown
schematically at the left side of Figure 4.15.
‚Ä¢ The total control gain was called the proportional gain factor kp, be-
cause the gain factors of all elements in the controller were constant
factors.
It was further explained that a combination of only a spring and a mass
require a damper to avoid inÔ¨Ånite ampliÔ¨Åcation of the resonance at its
natural frequency. In the following this case will be further expanded from
a feedback control perspective while a virtual damper will be added.
At the lower half of Figure 4.15 the equivalent feedback loop for the position
control mechanism is shown. It is a simpliÔ¨Åed version of Figure 4.11 without
a reference signal and pre-Ô¨Ålter. The plant consists of the ampliÔ¨Åer, the

4.4. PID Feedback Control
269
actuator and the mechanical moving body. Its input is the control force
u which is the force that the controller calculates. In the following, the
actuator and ampliÔ¨Åer are assumed to be ideal with a gain of one, which
means that the control force is equal to the real force acting on the moving
body11.
The output of the (already perturbed) motion system is the radial tracking
position error Œ¥r between the position xs and the radial centre of the track
xr. In the equivalent feedback loop this radial position error is transformed
into the control error e by the position measurement.
For this example case aimed at only showing basic solutions the gains of
the ampliÔ¨Åer, actuator and measurement sensor are all assumed to be
frequency independent constant factors with a value of one. This means
that the transfer function G(s) of the plant is equal to the compliance of
the optical pickup unit. The unit is modelled as a single body with mass
m and its corresponding compliance transfer function Cb(s) and frequency
response function is described as was explained in the previous chapter:
G(s) = Cb(s) = x
F =
1
ms2
=‚áí
G(œâ) = ‚àí
1
mœâ2 = ‚àí
1
0.01œâ2
[m/N]. (4.25)
The frequency response of this mass based system shows the typical mass
line with ‚àí2 slope in the Bode plot and a phase-lag of 180¬∞over the entire
spectrum. The magnitude of the compliance shows a gain of one at a unity-
gain cross-over frequency œâc = 10 rad/s, which is equal to fc ‚âà1,6 Hz as shown
in the lower (blue) mass-line of Figure 4.16.
4.4.1.1
Relevant Sensitivity Functions
In the CD player it is important that the optical pickup unit follows the track
as good as possible. One way to describe this is by the relation between xr
as input and xs as output, which can be deduced by the ratio between the
transfer function of the forward path from input to output divided by one
plus the feedback loop transfer function:
xs
xr
=
G(s)Cfb(s)M(s)
1+G(s)Cfb(s)M(s).
(4.26)
11The diÔ¨Äerence between the deÔ¨Åned ‚Äúcontrol force‚Äù and the real force by the actuator is often
a source of confusion due to the diÔ¨Äerent deÔ¨Ånitions of a plant (see footnote on page 236). In
principle a perfect ampliÔ¨Åer/actuator combination should translate the control force unaltered
into the real force. In real systems there is always a diÔ¨Äerence, which can be only in gain but
also in frequency response and non linearity. These deviations, if known and invertible, can be
compensated in the controller like done with feedforward control. It is one of the reasons why
some people limit the plant to the mechanics.

270
Chapter 4. Motion Control
One will directly recognise that this equals the Complementary Sensitivity
T(s) or closed-loop response of the radial position xs of the optical pickup
unit to the radial position xr of the track, acting as the reference.
In the following it will be made clear that it is better to look at the error e
as the measured diÔ¨Äerence between both positions:
e
xr
=
M(s)
1+G(s)Cfb(s)M(s).
(4.27)
Which is equal to the Sensitivity S(s) when M(s) = 1.
4.4.1.2
Proportional Feedback
As a next step in analysing and expanding the feedback controller for the
CD player the previously shown servo-stiÔ¨Äness created by feedback will be
described in the common terms of control engineering. This stiÔ¨Äness was
required to reduce the error due to the shock induced vibrations at 25 Hz
by a suÔ¨Éciently small Sensitivity S(s). As will be shown in the following
the added loop-gain to create this stiÔ¨Äness results in a unity-gain cross-over
frequency and feedback bandwidth of the Complementary Sensitivity of
800 Hz, equal to the natural frequency that was determined by the moving
10
z¬É
10
z)
10
z¬Ç
1
10
¬Ç
Magnitude (abs)
Plant response, mass line
^!6z
10
0
10
1
10
¬Ç
10
3
10
)
z,¬Ü{
z¬Ö{
0
Phase [deg]
Frequency [Hz]
¬Ç
¬Ç
f  mass line
c
f  P-control
c
,¬É
¬Ü{{
z,¬Ç{
z¬Ü{
z){
){
0
Magnitude [dB]
k¬ä¬Ç¬Å,{
.
p
¬Å
¬Ü{
10
)
¬Ç¬Å
10
3
Figure 4.16: Feedback-loop Bode plot of the CD-player lens with a mass of 10‚àí2 kg.
P-control with a gain kp = 2.5¬∑105 N/m proportionally shifts the total
frequency response of the combined system upwards, such that the
loop-gain at 25 Hz becomes equal to the required level of 103, while as
a result the unity-gain cross-over frequency shifts from 1.6 to 800 Hz.

4.4. PID Feedback Control
271
mass and the servo-stiÔ¨Äness.
It was shown in Chapter 3 that the gain Gt of the feedback controller has to
be equal to the required radial stiÔ¨Äness kr = 2.5¬∑105 N/m. In more general
control notation the control gain is written as Cfb(s). For only proportional,
frequency independent, feedback control the value of Cfb is equal to the
inverse of the gain of the plant at the resulting feedback-loop unity-gain cross-
over frequency œâc, fc, which after closing the loop is equal to the undamped
resonance frequency œâ0, f0, which is caused by the servo stiÔ¨Äness ks(= Cfb =
kr) and the mass.
œâ0 = œâc = 2œÄfc =

ks
m =

Cfb
m
‚áí
Cfb = mœâ2
c
N/m

.
G(œâc) =
1
mœâ2c
[m/N]
‚áí
Cfb =
1
Cm(œâc)
N/m

.
(4.28)
The standard term for the proportional gain of the feedback controller in-
cluding ampliÔ¨Åer and sensor is kp. It has the same unit as stiÔ¨Äness
N/m
,
because the controller converts a position error into a counteracting force12.
With these deÔ¨Ånitions the proportional control part Cp of the position con-
troller Cfb(s) is written in correct control terms as:
Cp = kp = mœâ2
c
N/m

.
(4.29)
As explained on page 257, the feedback-loop transfer function is deÔ¨Åned as
the transfer function of the system when followed from the error e to the
measured output Œ¥m at the subtraction point of the controller so excluding
the -1 inversion. With this deÔ¨Ånition the feedback-loop transfer function
Lp(s) in the Laplace-domain and the frequency response Lp(œâ) are equal to:
Lp(s) = G(s)Cp = Cm(s)Cp = kp
ms2
=‚áí
Lp(œâ) = ‚àí2.5¬∑105
0.01œâ2 .
(4.30)
The constant gain factor of kp in the numerator of Equation (4.30) im-
plies that P-control shifts the mass-line of the lens-system upwards in the
Bode plot. As a consequence this shift in magnitude also results in a shift
of the unity-gain cross-over frequency fc from 1.6 to 800 Hz, as shown in
Figure 4.16.
It important to be aware of this increased unity-gain cross-over frequency
as it requires suÔ¨Écient stability margin levels around that frequency, which
may well be compromised by dynamic issues.
12In this book the unit is only mentioned with kp when it has a value.

272
Chapter 4. Motion Control
The following insight is fundamental in this respect:
A lower sensitivity for disturbances leads to a higher unity-gain
cross-over frequency than the frequencies where these distur-
bances occur. Dynamic problems that occur at higher frequencies
limit the achievable unity-gain cross-over frequency due to their
impact on the stability margins.
When the feedback loop with only P-control is closed, the transfer function
and frequency response of the Complementary Sensitivity and Sensitivity
can be derived as follows:
Tp(s) =
Lp(s)
1+ Lp(s) =
1
m
kp
s2 +1
=‚áí
Tp(œâ)
1
1‚àí

 œâ
œâc
2 .
Sp(s) =
1
1+ Lp(s) =
1
1+ kp
ms2
=‚áí
Sp(œâ)
1
1‚àí
œâc
œâ
2 .
(4.31)
with the corresponding Bode plots as shown in Figure 4.17.
When the -2-slope feedback-loop response and the sensitivity functions are
compared starting at the lowest frequencies, the Ô¨Årst diÔ¨Äerence is found
in the frequency range below the unity-gain cross-over frequency of the
feedback-loop. The Complementary Sensitivity of the system shows a gain
which approaches a value of one, corresponding to a spring-line, while its
phase shift has become zero degrees. The Sensitivity starts at very low
levels, with a value of ‚àí103 at 25 Hz, rising with a +2-slope. At the feedback-
loop unity-gain cross-over frequency of 800 Hz a sharp resonance peak is
observed in both sensitivity functions with a 180 degrees step in the phase.
Above 800 Hz frequency the original ‚àí2 slope of the feedback-loop mass-line
response is followed for the Complementary Sensitivity while the sensitivity
approaches a value of one.
When comparing the Bode plot of the Complementary Sensitivity with the
passive dynamic systems presented in the previous chapter, it is further
fully reconÔ¨Årmed that proportional feedback control creates a spring action.
The resonance in the Sensitivity causes the tracking error to be increased
instead of decreased over a signiÔ¨Åcant frequency range starting just below
600 Hz.
At this point it is also clear that the Complementary Sensitivity is not very
useful for this motion-control problem as it does not give any information
about the eÔ¨Äect of the 25 Hz disturbance.
The resonance peak is of course not acceptable for the closed-loop operated

4.4. PID Feedback Control
273
system and in control engineering terms this eÔ¨Äect is represented by the
location of the poles of the system in the Laplace-plane. The closed-loop poles
are a conjugate complex pair on the imaginary axis as shown by the values
of s where the denominator of the transfer function Tp(s) in Equation (4.32)
is equal to zero:
den

Tp(s)

= m
kp
s2 +1 = 0
=‚áí
s =

‚àíkp
m = ¬±jœâc.
(4.32)
This means that the system is marginally stable as the phase-lag of the
feedback-loop transfer function at the unity-gain cross-over frequency is 180‚ó¶.
In order to achieve an acceptable control performance, some damping and
phase-lead around the unity-gain cross-over frequency needs to be added.
4.4.1.3
Proportional-DiÔ¨Äerential Feedback
In order to add damping to the positioning system of the lens, a force com-
ponent must be created that is proportional to the velocity. This force can
10
z[
10
z¬Ç
10
-1
10
0
10
1
Magnitude (abs)
10
¬Ç
10
[
10
4
z,¬Ü{
0
180
Phase [deg]
Frequency [Hz]
¬û¬Ç
¬Ç
z¬É{
z){
0
¬Ç{
¬Ç{
Magnitude [dB]
Feedback loop 
T(s) = x /x 
 S(s)
r
s
10
1
S(s)= 10[
¬Ç¬Å
¬Ü{{

Figure 4.17: Bode plot of the Feedback-loop response, Sensitivity S(s) and Comple-
mentary Sensitivity T(s) = xs/xr of the feedback controlled CD-player
lens with P-control at a gain of kp = 2.5¬∑105 N/m. The resulting sensi-
tivity at 25 Hz equals ‚àí103. The undamped resonance at the natural
frequency of 800 Hz in the Sensitivity clearly indicates a property of
higher order feedback that it also increases the error over a certain
frequency range.

274
Chapter 4. Motion Control
be created by a signal that corresponds to the derivative of the position
error over time. With this derivative signal the feedback controller transfer
function Cfb(s) becomes equal to the Proportional DiÔ¨Äerential control or
PD-control transfer function Cpd(s):
Cfb(s) = Cpd(s) = kp + kds
N/m

.
(4.33)
This PD-control transfer function is also often written in a diÔ¨Äerent form as
a multiplication of terms, which better reÔ¨Çects the realisation as a series of
Ô¨Ålters:
Cpd(s) = kp(1+ kd
kp
s) = kp(1+œÑds)
N/m

.
(4.34)
In this second notation, œÑd represents the time constant of a Ô¨Årst-order
diÔ¨Äerentiator, which shows an increasing magnitude of the frequency re-
sponse with a +1 slope. As was explained in Section 2.4.2.1 of Chapter 2 a
pure diÔ¨Äerentiation results in a positive phase shift or phase-lead of 90¬∞.
For frequencies below œâd = 2œÄfd = 1/œÑd the derivative term œÑd(s) is smaller
than one and the feedback controller behaves like a P-control system with
a constant gain and a phase of 0¬∞. For frequencies that are higher than fd
the derivative term will dominate and the controller shows diÔ¨Äerentiating
behaviour with a +1 slope magnitude increase and a phase approaching 90¬∞.
The magnitude rise and phase-lead at fd equal 3dB and 45¬∞respectively, be-
cause this transition from proportional to diÔ¨Äerential is gradual. Depending
on the targeted phase margin fd can be placed anywhere near the unity-gain
cross-over frequency of the feedback-loop transfer function L(s). However,
this choice has some consequences that need to be considered.
‚Ä¢ The unity-gain cross-over frequency will shift to a higher frequency
due to the increase in gain at higher frequencies by the diÔ¨Äerentiating
action.
‚Ä¢ A lower value of fd will shift the unity-gain cross-over frequency even
more with more phase margin at this higher unity-gain cross-over
frequency.
‚Ä¢ However, resonances by mechanical eigenmodes at these higher fre-
quencies will generally not allow such a high unity-gain cross-over
frequency.
‚Ä¢ Finally it physically is not possible, nor preferable to diÔ¨Äerentiate the
signal up till very high frequencies.

4.4. PID Feedback Control
275
10
z[
10
z¬Ç
10
-1
10
0
10
1
Magnitude (abs)
10
¬Ç
10
[
10
4
z,¬Ü{
Phase [deg]
Frequency [Hz]
¬û¬Ç
¬Ç
z¬É{
z){
0
¬Ç{
¬Ç{
Magnitude [dB]
10
1
S(s)= 10[
¬Ç¬Å
,¬Å{{
PD-Control 
P-Control 
,[¬Å
-90
T     (s) 
 S      (s)
pdt
pdt
¬Ç
-1
Figure 4.18: Bode plot of the response of the feedback controlled CD player lens
with PD control starting at fd ‚âà450 Hz without limitation of the
diÔ¨Äerentiating action at high frequencies. The unity-gain cross-over
frequency is almost doubled to fc ‚âà1.5 kHz, the phase margin is ‚âà70¬∞.
The resulting closed-loop response has a ‚àí1 slope at high frequencies.
The eÔ¨Äect on the unity-gain cross-over frequency and phase margin on the
motion controller of the CD player lens is shown with its consequences in the
modelled graphs in Figure 4.18. The P-control slope of -2 has been pushed
up to a -1 slope, which increases the gain of any resonating mechanical
eigenmodes at higher frequencies. It is clear from this example that the
diÔ¨Äerentiating action should be limited to the frequency range around the
unity-gain cross-over frequency of the complete control system includ-
ing the diÔ¨Äerentiating action. In the following this limitation and the
related optimal choices will be further addressed.
4.4.1.4
Limiting the DiÔ¨Äerentiating Action
By starting the diÔ¨Äerentiating action below the unity-gain cross-over fre-
quency and limiting the diÔ¨Äerentiating action at higher frequencies, suÔ¨É-
ciently above the unity-gain cross-over frequency the beneÔ¨Åcial phase-lead
will be concentrated around the unity-gain cross-over frequency.
This tamed PD-control results in a characteristic behaviour around the
cross-over frequency, which is sometimes also called lead-lag compensation
because the diÔ¨Äerentiation introduces a zero, which gives a phase-lead, and

276
Chapter 4. Motion Control
10
0
10
1
Magnitude (abs)
10
5
10
2
10
3
10
4
0
45
90
Phase [deg]
Frequency [Hz]
3.2
3.2
0
20
Magnitude [dB]
+1
1
1
2
2
f

 t
c

f
t
t

c
c
1
2
f




f
1
1
2
2



c
d
d
f
d
Figure 4.19: Bode plot of limited or tamed D-control with kp = 1. The diÔ¨Äerentiating
action starts at fd and is terminated at ft. With fd = 0.1ft = 1/Œ±fc ‚âà
0.32fc, a phase-lead of approximately 55¬∞at fc ‚âà1.5 kHz is obtained in
the controller. Due to the +1-slope the gain at fc is a factor 3 higher
than at frequencies below fd.
the taming is done by adding a pole, which gives a phase-lag, compensating
the lead of the diÔ¨Äerentiator zero. This compensator does not really induce a
lag, because the phase of the combined controller becomes zero and the gain
becomes proportional after the taming of the diÔ¨Äerentiation. An important
optimisation choice is the ratio between the start- and taming frequency of
the diÔ¨Äerentiator. For this reason often the mutual frequency ratio between
fd, fc and ft is called Œ±. A larger value of Œ± will result in more phase-lead at
the unity-gain cross-over frequency but also more gain at higher frequencies
with the risk of problems due to resonating eigenmodes of the mechanics. A
phase-lead (= phase margin!) of 45-50¬∞at the unity-gain cross-over frequency
is generally considered as a safe value for a robust feedback controller, giving
a maximum Q-level in the complementary sensitivity of ‚âà3dB as was shown
in Section 4.3.2.1.
A value of Œ± =

10 ‚âà3,2, which is a factor 10 between fd and ft, gives
such a phase margin for a unity-gain cross-over frequency equal Œ± times
the starting frequency of the diÔ¨Äerentiating action. This is shown in Fig-
ure 4.19 for a tamed D-control action on the unity-gain cross-over frequency
of fc = œâc/2œÄ =‚âà1500 Hz as was found in Figure 4.18 and which proves to be
the optimal choice for the CD player.
It results in fd = œâd/2œÄ = fc/Œ± ‚âà450 Hz for the starting frequency of the diÔ¨Äer-

4.4. PID Feedback Control
277
10
z[
10
z¬Ç
10
-1
10
0
10
1
Magnitude (abs)
10
¬Ç
10
[
10
4
Phase [deg]
Frequency [Hz]
¬û¬Ç
z¬É{
z){
0
¬Ç{
¬Ç{
Magnitude [dB]
10
1
S(s)= 10[
¬Ç¬Å
,¬Å{{
PD-Control 
T     (s) 
 S      (s)
Tamed PD-Control 
¬Ç
z180
,[¬Å
-90
pdt
pdt
Figure 4.20: Feedback-loop and closed-loop response Bode plot of the feedback con-
trolled CD-player lens for both PD-Control and tamed PD-Control with
fd = 0.32fc = 0.1ft. It shows the higher loop-gain at higher frequencies
due to the necessary phase compensation at the unity-gain cross-over
frequency.
entiator and ft = œât/2œÄ ‚âà4.5 kHz for the terminating frequency.
When using the same notation as with Equation (4.34) the tamed PD-
controller is written in de multiplicative form as follows:
Cpdt(s) = kp
1+œÑds
1+œÑts
N/m

.
(4.35)
where the denominator term represents a typical Ô¨Årst-order low-pass Ô¨Ålter.
With this expression for the controller the total feedback-loop transfer func-
tion of this tamed PD-controller combined with the CD player plant of the
system is equal to:
Lpdt(s) = G(s)Cpdt(s) = kp
ms2
1+œÑds
1+œÑts = kp
ms2
1+ 1
œâd
s
1+ 1
œât
s
.
(4.36)
From this equation it is clear that above œât = 2œÄft = 1/œÑt the low-pass Ô¨Ålter
kicks in and the diÔ¨Äerentiator is ‚Äútamed‚Äù.
The Bode plot of the resulting response is shown in Figure 4.20 both in

278
Chapter 4. Motion Control
10
z2
10
z1
10
0
10
1
Magnitude (abs)
10
2
10
3
10
4
z180
z90
Phase [deg]
Frequency [Hz]
z40
z20
0
40
20
Magnitude [dB]
z135
10
Figure 4.21: A lower starting frequency of the diÔ¨Äerentiator of a tamed PD-
controller will increase the unity-gain cross-over frequency while de-
creasing the frequency where the maximum phase-lead occurs.
open- and closed-loop, for comparison together with the response with PD-
control without taming. The Ô¨Årst observation on these Bode plots is that the
maximum phase-lead occurs exactly at the unity-gain cross-over frequency
of the total feedback loop. When the starting frequency would be chosen
at a lower frequency the maximum phase-lead would also be at a lower
frequency while the unity-gain cross-over frequency would be slightly higher
as is illustrated in Figure 4.21, which shows a slightly enlarged section
of the tamed PD-control plot of Figure 4.20. The red plot is equal to the
situation when the D-control action is shifted to lower frequencies.
The second observation on the Bode plots of Figure 4.20 is that the increased
unity-gain cross-over frequency of the feedback-loop frequency response has
become the roll-oÔ¨Äfrequency (f0 = fc) in the frequency response of the closed-
loop system.
The third observation is that the closed-loop frequency responses of both
sensitivity functions Tpdt(s) and Spdt(s) show a nicely damped behaviour at
the roll-oÔ¨Äfrequency with a ‚àí2 slope at higher frequencies.
The caveat to the chosen parameters is the necessary condition that res-
onances of mechanical eigenmodes at higher frequencies are not causing
troubles with stability, due to the increased unity-gain cross-over frequency.
This will be addressed in the following section.

4.4. PID Feedback Control
279
4.4.1.5
Adding I-Control
Adding D-action to the P-controlled CD player resulted in a very acceptable
level of phase margin, but it came at a sacriÔ¨Åce. At high frequencies the level
of the resonances and noise is ampliÔ¨Åed with a factor 10 (20 dB!) and this
demands a very well designed mechanical structure and perfect electronics.
For this reason one will frequently be forced to further reduce the gain
at higher frequencies and Ô¨Ånd other ways to increase the gain at lower
frequencies.
When no improvements in the hardware are possible one is tempted to
reduce kp, however without other measures that would lead to an increased
sensitivity to the disturbances. It is also possible to optimise the tuning
by reducing Œ±, placing fd and ft closer around the unity-gain cross-over
frequency fc. This allows to achieve a slightly better error reduction at low
10
z1
10
0
10
1
10
2
10
3
Magnitude (abs)
10
2
10
3
10
4
z180
-135
-90
Phase [deg]
Frequency [Hz]
z20
0
Magnitude [dB]
10
1
103
25
1500
20
40
60
-1 D-control
tamed
   -2 
Shift fc
Reduce 
kp
-3 I-control
-2
#ed PID-control
 
PD + I =PID-control
80
10
4
150
z270
PD-control
P-control
Figure 4.22: The addition of an integrating action below 150 Hz increases the
gain at 25 Hz with a factor 6, which allows to reduce both kp and the
starting and taming frequencies of the diÔ¨Äerent control actions of the
PID-controller. The values can be graphically derived by shifting the
plot to the left until it matches the required gain of 1¬∑103 @ 25 Hz.

280
Chapter 4. Motion Control
frequencies at the expense of a reduced closed-loop damping ratio as will be
shown in Section 4.4.7.1. This can be done when the system is suÔ¨Éciently
free from disturbances around fc and no changes in the dynamic properties
are expected. Further it is possible to use Ô¨Ålters to cope with the problems at
high frequencies, comparable with the methods used in feedforward control
like pole-zero cancellation. But Ô¨Årst and foremost it is the addition of the
third part of PID-control, the I-control action, which is used to increase the
loop-gain at lower frequencies.
As was explained with Equation (2.89) in Chapter 2 the frequency response
of an integrating operation shows a -1‚Äòslope with 90¬∞phase lag in the Bode
plot. After adding the integrating action to the controller the expression
for a tamed PID controller, where the taming action is implemented as a
low-pass Ô¨Ålter on the entire controller, is equal to:
Cpidt(s) =

kp + kds+ ki
s

1
1+œÑts
N/m

.
(4.37)
From this equation it is clear that the I-control action will increase the gain
below the frequency where it exceeds the other terms in the controller. This
frequency is easier detemined by writing Equation (4.37) in the multiplica-
tive form:
Cpidt(s) = kp
1+œÑds
1+œÑts

1+ ki
kps

= kp
1+œÑds
1+œÑts

1+ 1
œÑis

N/m

.
(4.38)
By adding the I-control action to the PD-controller of the CD player it is
possible to increase the low-frequency gain with a Ô¨Årst-order slope below
a frequency œâi = 2œÄfi = 1/œÑi at an equal distance of Œ± = 3,2 to the starting
frequency at 450 Hz of the diÔ¨Äerentiating action, which equals approximately
150 Hz in this example. As result the gain at 25 Hz is increased with a factor
150/25=6. This would allow to reduce the unity-gain cross-over frequency
and avoid problems due to higher frequency resonating eigenmodes.
A Ô¨Årst indication of the new control parameters can most easily be obtained
by shifting the plot of the full feedback loop frequency response, including
the I action, to the left as shown in Figure 4.22. In practice this graphical
optimisation is done by means of suitable modelling software in combination
with measurements on the real system.
In the next section I-control will be further examined for a system with a
spring that supports the moving body and as consequence drives the position
to where the spring force becomes equal to zero. To compensate this spring
force the controller needs to apply a position dependent continuous force by
the actuator.

4.4. PID Feedback Control
281
4.4.2
PID-Control of a Spring Supported Mass
The previous example of the CD-player introduced P-control and D-control
to create a virtual spring and damper on a plant, consisting of a rigid body
without a physical connection to any other solid object. Finally also the I-
control action was introduced to increase the gain and reduce the sensitivity
for disturbances at lower frequencies. This situation is typical for high-
performance mechatronic systems designed with a low friction support like
airbearings, which are chosen to reduce the connection to other vibrating
objects in the sliding direction. However, cost target, dimensional issues
or speciÔ¨Åc beneÔ¨Åts often drive the design to the use of compliant elements,
like a leaf spring or a membrane. Even when the stiÔ¨Äness of such elements
is kept reasonably low it always adds an additional drawback next to the
transmission of vibrations. It requires a constant force to keep the moving
body at a position other than the neutral position of the spring.
With only a PD controller this static force F is only generated through
the existence of a static position error Œµ, since in the static situation the
derivative action is zero and hence the force is simply F = KpŒµ [N].
To solve this issue, the integration action that was introduced in the previous
section can be added.
Unfortunately, this integrator action has no equivalent in the mechanical
domain but one can see it as a super-spring that pushes back with increasing
force until the error is zero.
The mathematical notation of a PID-controller without taming of the D-
m
x
k
0.25 kg
N
100 m
Driven body
10
z¬Ü
10
z¬É
10
z)
10
z¬Ç
10
0
Magnitude (abs)
10
z¬Ç
10
0
10
¬Ç
10
)
z,¬Ü{
z¬Ö{
0
Phase [deg]
Frequency  [Hz]
c
F
Ns
0.1 
m
z){
z¬Ü{
0
,¬Ç{
,¬É{
Magnitude [dB]
Figure 4.23: A slightly damped mass-spring system with Q = 50 and the Bode plot
of its frequency response function x/F, which is used as example to
illustrate PID-control with some real data.

282
Chapter 4. Motion Control
action is expressed with the following relation between the input error e and
the output u of the controller in the time, Laplace and frequency-domain:
u(t)=kpe(t)+ ki
t

0
e(œÑ)dœÑ+ kd
de(t)
dt
[N],
(4.39)
u(s)=e(s)

kp + ki
s + kds

[N]
=‚áí
Cpid(s)= u(s)
e(s) = kp + ki
s + kds
N/m

,
(4.40)
Cpid(œâ)= u(œâ)
e(œâ) = kp + ki
jœâ + jœâkd
N/m

.
(4.41)
From the frequency response function of Equation (4.41) it is clear that the
integrating action introduces a 90¬∞phase-lag due to the term ‚àíj and the
diÔ¨Äerentiating action a 90¬∞phase-lead, due to the term j.
In the following a PID-controller is designed for a simple, slightly damped
mass-spring system. This is done in a comparable way as in the previous
example of the PID-control of a CD-player. In this case, however, the body
is connected to the stationary reference with a very compliant spring with
a spring-constant k = 100 N/m in order to show the diÔ¨Äerence with a pure
inertial mass situation like with the CD player. The mass m of the body
equals 0.25 kg and very little passive damping is present in the system
c = 0.1 ‚ÜíQ =

km/c = 50. Such a low damping level is representative for
the internal damping in realistic situations where parts are mounted with
screws or glue. With these values and choosing the gain of ampliÔ¨Åer, actuator
and sensor equal to one13, the transfer function and frequency response of
the plant becomes as follows:
G(s) =
1
ms2 + cs+ k
=‚áí
G(œâ) =
1
‚àímœâ2 + jœâc + k
(4.42)
=
1
‚àí0.25œâ2 +0.1jœâ+100
[m/N]. (4.43)
At low frequencies the spring-line 1/k = 0.01 deÔ¨Ånes the frequency response
with an almost constant magnitude. At œâ0 =
4
k/m = 20 rad/s, which is ap-
proximately equal to 3.2 Hz, the system has a resonance with a peak rising
to a factor Q = 50 above the spring line response. At œâ ‚â´œâ0 the frequency
response is dominated by the mass-line (-1/mœâ2) with a ‚àí2 slope and a phase-
lag of -180‚ó¶.
13In case one chooses the plant to be the mechanics only the resulting equation would be the
same. In that case the gain of ampliÔ¨Åer, actuator and sensor would be part of the control gain.

4.4. PID Feedback Control
283
For this system the PID feedback controller will be designed with the fol-
lowing control objectives:
‚Ä¢ The feedback controlled system must have zero steady-state error in
response to the reference signal.
‚Ä¢ The loop-gain below 1 Hz must be more than 104 in order to achieve a
suÔ¨Éciently low sensitivity for disturbances.
‚Ä¢ The Complementary Sensitivity is not allowed to deviate more than
‚âà30% (3 dB) from one over a frequency range of 10 ‚Äì 100 Hz. This
requires suÔ¨Écient damping of the feedback controlled system with no
or little oscillations.
‚Ä¢ The feedback controlled system has to be asymptotically stable, which
means that all the poles are located in the left-half of the Laplace-
plane..
The desired upper limit of the frequency range of 100 Hz corresponds to
an unity-gain cross-over frequency of 100 Hz of the feedback loop. This is
equivalent to œâc = 628 rad/s, which is at a higher frequency than the reso-
nance frequency of the mass-spring oscillator. In that region the frequency
response of the plant is dominated by the mass-line -(1/mœâ2). For this fre-
quency the magnitude of the frequency response of the plant G(œâ) ‚âà1¬∑10‚àí5.
4.4.2.1
P-Control
The total gain of any feedback controller is always equal to the inverse
value of the gain of the plant at the unity-gain cross-over frequency, which
in this case is chosen at 100 Hz. This value of the total controller gain
kc = 1/G(œâ) = 1 ¬∑ 105 N/m will create unity-gain at a frequency of 628 rad/s
(100 Hz). When only a proportional controller would be suÔ¨Écient, this
controller would need to have an equal proportional gain of 105 N/m. For
stability reasons the total phase-lag of the feedback-loop has to be smaller
than 180¬∞at the unity-gain cross-over frequency. As shown in the previous
section on the CD-player a pure P-control gain would result in a marginally
stable system, which shows in closed-loop a sharp resonance peak at the
unity-gain cross-over frequency with a sharply changing phase shift from
0¬∞to ‚àí180‚ó¶. To add stability and robustness to the feedback controlled system,
a diÔ¨Äerentiating action (D-control) is added, which generates a phase-lead
around the unity-gain cross-over region, thereby adding damping to the

284
Chapter 4. Motion Control
oscillatory system.
To add suÔ¨Écient phase-lead (and damping) the diÔ¨Äerentiating action (D-
control) should start at 0.33œâc. This means that above this frequency the
system will approximate rather a ‚àí1 slope than the original ‚àí2 slope of the
mass-line. As in this case the target bandwidth fc = 100 Hz already includes
the eÔ¨Äect of D-control on the total gain kp needs to be a factor three smaller
than the total required gain at 100 Hz.
This means that the proportional gain for this example system should be
equal to:
kp = 0.33kc = 3.3¬∑104
N/m

.
(4.44)
4.4.2.2
D-Control
The diÔ¨Äerentiating action (D-control) is used to add phase-lead and damping
to the system around the unity-gain cross-over frequency œâc. In order to
achieve suÔ¨Écient phase margin the diÔ¨Äerentiating term of the PD-controller
(kp+skd) should start to dominate at œâc/3. Rewriting Equation (4.41) without
the integrator (ki = 0) gives the following frequency response of the PD-
controller:
Cpd(œâ) = kp

1+ jœâ kd
kp

= kp (1+ jœâœÑd)
N/m

.
(4.45)
With the diÔ¨Äerentiating time constant œÑd as was deÔ¨Åned in Section 4.4.1.3
on Page 274.
From this notation it is clear that the frequency above which the diÔ¨Äeren-
tiator starts to dominate is equal to the value of œâ, where the frequency
term in Equation (4.45) becomes larger than one. This occurs at a frequency
equal to:
œâd = 1
œÑd
= kp
kd
= œâc
3
rad/s

.
(4.46)
This means that the diÔ¨Äerentiator gain and time constant for this example
system should be equal to:
kd = 3¬∑ kp
œâc
= 3¬∑3.3¬∑104
628
‚âà160
N/m

and
œÑd = 3
œâc
‚âà5¬∑10‚àí3
[s]. (4.47)
The diÔ¨Äerentiating action is ‚Äútamed‚Äù, which was introduced before as a
limitation of the action to only the frequency area around the unity-gain
cross-over frequency of 100 Hz, in order to provide a steeper roll-oÔ¨Äof
the controller at high frequencies and to limit the control eÔ¨Äort at those

4.4. PID Feedback Control
285
frequencies. It was shown that a good starting value of the frequency above
which the diÔ¨Äerentiation is terminated would be a factor of 3.3 above the
unity-gain cross-over frequency. To create this limitation, a pole is added in
the controller at a frequency of œât = 3.3¬∑œâc ‚âà2000 rad/s. This is done by means
of a Ô¨Årst-order low-pass Ô¨Ålter with a time constant equal to: œÑt = 1/œât = 5¬∑10‚àí4.
As a result the total frequency response of the PD-controller can be derived
from Equation (4.45), multiplied with the Ô¨Årst-order low-pass Ô¨Ålter with
time constant œÑt = 1/œât. With the previously found values of kp,œÑd and œÑt this
gives the following result:
Cpd(œâ) = kp
1+ jœâœÑd
1+ jœâœÑt
= 3.3¬∑104 1+ jœâ¬∑5¬∑10‚àí3
1+ jœâ¬∑5¬∑10‚àí4
N/m

.
(4.48)
4.4.2.3
I-Control
An integrating action is added to the system in order to increase the loop-
gain at low frequencies and achieve a zero steady-state error in response to
the reference signal as well as in response to disturbances. In the frequency-
domain, integration equals the addition of a jœâ term in the denominator of
the transfer function and as a consequence it adds 90¬∞of phase-lag to the
system. In order to not aÔ¨Äect the beneÔ¨Åcial phase-lead of the D-control too
much the integrating action should be applied below a frequency equal to
one third of the starting frequency of the diÔ¨Äerentiator, which corresponds
approximately to one tenth of the unity-gain cross-over frequency. This
means for this case that the integrator should stop at œâi ‚âà0.1¬∑œâc ‚âà60 rad/s.
At this angular frequency the term ki/jœâ from Equation (4.41) has to become
equal and at higher frequencies eventually smaller than kp.
Therefore, with this example system, the integral gain should equal:
ki = kp ¬∑60 ‚âà1.8¬∑106
N/m

.
(4.49)
These controller gains for kp, kd, and ki result in the Bode plot of the fre-
quency response of the controller shown in Figure 4.24. The integrating
action up to 10 Hz and the diÔ¨Äerentiating action from 33 Hz until 330 Hz
with the corresponding phase behaviour are clearly visible.
Figure 4.25 shows the Bode and Nyquist plot of the open PID-control loop,
consisting of the PID-controller in series with the mass-spring system, as
deÔ¨Åned in Equation 4.42. At low frequencies the integrating action is provid-
ing a ‚àí1 slope for a high gain at -90¬∞phase. Already before the resonance a
small eÔ¨Äect of the diÔ¨Äerentiator is visible in the phase, rising slightly above
-90¬∞before going sharply down to approximately -240¬∞by the resonance.

286
Chapter 4. Motion Control
10
4
10
5
10
6
Magnitude (abs)
10
z,
10
0
10
1
10
2
10
3
10
4
z¬Ö{
z)¬Å
0
45
¬Ö{
Phase [deg]
Frequency [Hz]
P-control
I-control
D-control
Tamed-D (=P)
-1
+1
fi
fd
fc
ft
80
120
100
Magnitude [dB]
Figure 4.24: Bode plot of the PID-controller for the mass-spring system example.
From left to right Ô¨Årst the ‚àí1 slope of the I-control line is followed until
it intersects with the horizontal P-control line at fi = 10 Hz. At the
intersection of the P-control line with the +1 slope of the D-control line
at fd = 33 Hz, the magnitude increases again until the intersection
at ft = 330 Hz with a second horizontal line, located a factor 10 above
the P-control line, determined by the ratio of the diÔ¨Äerentiating and
‚Äútaming‚Äù frequency where the controller transfer function becomes
proportional again. At the unity-gain cross-over frequency fc = 100 Hz
this controller has the required gain of 1 ¬∑ 105 with a phase-lead of
around 55‚ó¶, giving an equal phase margin for robustness.
At 100 Hz the gain of the feedback-loop is equal to one as required. Beyond
the eigenfrequency of the uncontrolled mass-spring system at ‚âà3.3 Hz the
system shows a ‚àí2 slope after the resonance peak, which is reduced to
a ‚àí1 slope by the diÔ¨Äerentiating action around the unity gain cross-over
frequency.
The Nyquist plot shows more clearly the eÔ¨Äect of the resonance on the phase
and magnitude by means of the elliptical shape in the full chart. After
zooming in around -1 the Nyquist plot further indicates a special situation,
which is called conditional stability and relates to the presence of more
than two integrators in a loop. A conditionally stable system requires not
only a maximum value of the gain according to the gain margin but also a
minimum value of the gain. The example system has three integrators of

4.4. PID Feedback Control
287
10
z¬Ç
10
0
10
¬Ç
10
4
Magnitude (abs)
10
z,
10
0
10
1
10
¬Ç
10
3
10
4
z¬Ç¬Ñ{
z¬Ç¬Ç¬Å
z,¬Ü{
z,[¬Å
z¬Ö{
z)¬Å
Phase [deg]
Frequency [Hz]
¬Ç
¬Ç
-1
-1
¬Å¬Å
z¬É
z¬Å
z)
z[
z¬Ç
z,
0
1
x 10
4
z)
z[
z¬Ç
z,
0
1
¬Ç
3
4 x 10
4
Real Axis
Imaginary Axis
z¬Ç¬Å
z¬Ç{
z,¬Å
z,{
z¬Å
0
¬Å
z¬É
z)
z¬Ç
0
¬Ç
4
¬É
¬Ü
Real Axis
Imaginary Axis
Zoom on -1
z){
0
40
¬Ü{
Magnitude [dB]
-3
Figure 4.25: Bode and Nyquist plot of the feedback-loop frequency response of the
total system with the PID controller in series with the mass-spring
system. Even though the eigendynamics of the mechanical system
show a clear resonance at around 3 Hz the phase-lag at the 100 Hz
unity-gain cross-over frequency remains well below 180‚ó¶. The Nyquist
plot starts with inÔ¨Ånite gain at 0Hz and -90¬∞phase, followed by the
elliptical shape, representing the resonance with a phase exceeding
-180¬∞. The zoomed Nyquist plot shows clearly that the -1 point on the
real axis is kept at the left-hand side but it also indicates conditional
stability.
which two are related to the mass and one to the controller. As can be seen
in both plots, a reduction of kp with more than a factor 10 will result in a
unity-gain-cross-over frequency in the area where the phase is more nega-
tive than -180¬∞. In the Nyquist plot a gain reduction would be equivalent
to a shift of the -1 point to the left and at a certain reduced gain level the
-1 point will be passed at the left-hand side, indicating instability.

288
Chapter 4. Motion Control
The gain margin at the high frequency side of this ideal system is inÔ¨Ånite,
because the phase never returns below -180¬∞at higher frequencies.
The phase margin of this system is about 55‚ó¶, being the distance between
180¬∞phase-lag and the phase-lag of the system (‚âà125¬∞) at the unity-gain
cross-over frequency of 100 Hz.
4.4.2.4
Sensitivity Function Graphs
Figure 4.26 shows the Bode plot of the closed-loop system with the Sensitiv-
ity and Complementary Sensitivity, including phase plot. The phase plot is
generally not meaningful anymore in the closed-loop frequency response as
it does not give any further information on stability. For precision systems
that have to move synchronously, like with the wafer scanner of Chapter 9,
the phase of the Complementary Sensitivity gives information on the time
delay of the movement and in that case it is still important information.
In this case the Complementary Sensitivity just shows the standard shape
z¬É
10
z)
10
z¬Ç
10
0
Magnitude (abs)
]
#
¬Ç
+1
¬û¬Ç
10
z,
10
0
10
1
10
¬Ç
10
3
10
)
z¬Ö{
z)¬Å
0
Phase [deg]
Frequency [Hz]
Magnitude (dB)
0
){
-80
,¬Ç{
z,[¬Å
z,¬Ü{
10
+3
Figure 4.26: Magnitude Bode plot of the closed-loop PID feedback controlled mass-
spring system. Both the Complementary Sensitivity T(f ), represent-
ing the capability to follow the reference as the Sensitivity function
S(f ), representing the disturbance-rejection capability, are shown as
function of the frequency. The original resonance has disappeared
and is turned into a strong rejection of disturbances at that frequency.
The phase plot of the Complementary Sensitivity is only relevant for
timing purposes in reference following action.

4.4. PID Feedback Control
289
of an equivalent well damped mass-spring system with a natural frequency
at 100 Hz. At low frequencies the closed-loop gain is equal to one, which
means that the system follows the reference signal with only a very small
error. Beyond the control bandwidth the feedback controlled system rolls oÔ¨Ä
to higher frequencies with a ‚àí2 slope. The fact that the feedback controlled
system is well damped can be observed by the low peak value above unity
in the Complementary Sensitivity at 100 Hz.
As mentioned with the previous example of the CD player, the roll oÔ¨Äbeyond
the control bandwidth with a ‚àí2 slope is due to the fact that the diÔ¨Äerentiat-
ing action is ‚Äútamed‚Äù. Without the taming, only a damped transmissibility
behaviour would be realised, with a ‚àí1 slope attenuation and an inÔ¨Ånitely
high control gain at high frequencies. For this reason it is emphasised again
that this additional pole to stop the diÔ¨Äerentiator is important.
The Sensitivity S(f ) shows a high attenuation and a +1 slope at low frequen-
cies. This corresponds to a good disturbance-rejection due to the integrator,
which acts up to 10 Hz. At the natural frequency of the mass-spring system
a sharp dip is observed in S(f ) with a steeper slope at higher frequencies.
This is due to the high gain caused by the resonance. It is very valuable
to be aware of this eÔ¨Äect as this high gain can help to suppress external
disturbances at the resonance frequency of the mechanical system. This
eÔ¨Äect is very much counter-intuitive and can very eÔ¨Äectively be applied
when a system suÔ¨Äers from a continuous disturbance at a Ô¨Åxed frequency.
Examples can be found with non-ideally rotating systems like a CD-player
with tracks that exhibit eccentricity and high speed spindles of machining
centres on which unbalance forces act.

290
Chapter 4. Motion Control
4.4.3
Limitations and Side EÔ¨Äects of PID-Feedback Con-
trol
Two important issues deserve attention when designing PID-controllers.
The Ô¨Årst is the fact that the feedback principle not only reduces errors but
also increases them just outside the control bandwidth, as was mentioned
in the summary in Section 4.1.3.1 and clearly illustrated by the example of
Figure 4.44.
The second issue is related to the I-control action, which not only increases
the gain at low frequencies but also increases the time that the system needs
to recover from an accumulated error.
4.4.3.1
Increased Sensitivity, the Waterbed EÔ¨Äect
When observing the graphs of the Sensitivity functions S(s) of the previous
examples in more detail it is clear that S(s) is larger than one above the
unity-gain cross-over frequency and only asymptotically settling to a value
of one at higher frequencies. Unfortunately, this magniÔ¨Åcation of the error
by the feedback controller over a large frequency band cannot be avoided
in a mechatronic positioning system with a dynamic order larger than one.
There is even a clear relation, named waterbed eÔ¨Äect between the magnitude
of the disturbance rejection and the disturbance magniÔ¨Åcation. The term
0
100
200
300
400
500
600
700
800
900
1000
0
0.5
1
1.5
2
Magnitude (abs)
Frequency [Hz]
Figure 4.27: The Sensitivity S(f ) of the PID-feedback controlled mass-spring sys-
tem plotted on a linear scale. This representation clearly shows the
increased sensitivity of this actively controlled system at frequencies
above the bandwidth of 100 Hz. When the shaded area below the mag-
nitude of one is increased for better rejection of low frequencies, the
shaded area above a magnitude of one also increases. This waterbed
eÔ¨Äect is inherent to motion control feedback systems with a higher
order than one and can not be avoided.

4.4. PID Feedback Control
291
‚Äòwaterbed eÔ¨Äect‚Äô visualises the property of any higher-order feedback control
system that an increase in disturbance-rejection at low frequencies, due
to diÔ¨Äerent controller settings, automatically causes an increase of the
Sensitivity at frequencies above the bandwidth. This relation is quantiÔ¨Åed
by the Bode Sensitivity Integral which equals:
‚àû

0
ln|S(œâ)|dœâ = 0.
(4.50)
under the condition that the feedback-loop transfer function L(s) of the
dynamic system has at least two more poles than zeros and all poles are
located in the left half of the Laplace-plane. This condition is always true
with stable feedback-controlled positioning systems.
The reason why the waterbed eÔ¨Äect is not so clearly visible in a normal
Bode plot is due to its logarithmic scales. Figure 4.27 shows the magnitude
of S(s) of the mass-spring system from Section 4.4.2 with tamed PD-control
on a double linear scale. With this representation the frequency range
above the unity-gain cross-over frequency at 100 Hz with an increased
Sensitivity appears to be much larger than the frequency range below 100 Hz,
while in a normal Bode plot this diÔ¨Äerence is not as pronounced. Also the
magnitude is relatively reduced with double logarithmic scales. In the
linear representation the beneÔ¨Åt of feedback seems to have vanished but
linear scales are also not representative for the real value of feedback in
the low-frequency area. A reduction of a factor 100 or a factor 1000 of the
disturbances at low frequencies can not be distinguished on a linear scale.
Fortunately, in most motion control systems the disturbances occur more in
the low-frequency area because of the large mass levels involved. This means
that in practice the beneÔ¨Åcial eÔ¨Äect of feedback in the low-frequency region
by far outweighs the disturbance ampliÔ¨Åcation at higher frequencies due
to the waterbed eÔ¨Äect. It is also for this reason that logarithmic scales are
preferred as long as the mechatronic designer is aware of the negative eÔ¨Äect
on disturbance rejection just above the unity-gain cross-over frequency for
those cases that signiÔ¨Åcant disturbances are also present in that frequency
region.
4.4.3.2
Integrator Wind-Up and Delays
The method to design motion controllers in the frequency-domain by apply-
ing the Laplace transform has one drawback in that it assumes a linear
system without any limitations. The real system will have its boundaries

292
Chapter 4. Motion Control
related to soft or hard range limitations and other non-linearities. Fur-
thermore it also does not address timing issues other than the phase-lag at
higher frequencies.
When observing responses in the time-domain several eÔ¨Äects are noticed
that are related to delays in recovering from certain events. Mostly they are
related to non-linearities, system limitations and sudden movements.
The three control actions of a PID-controller deal diÔ¨Äerently with these
events. The P-control action is time independent and will only be propor-
tionally inÔ¨Çuenced by a non-constant gain. The diÔ¨Äerentiator suÔ¨Äers from
a non-constant variation of the derivative so it will show eÔ¨Äects in the
time-domain when the signal is noisy or otherwise not well diÔ¨Äerentiable.
Generally these eÔ¨Äects are suÔ¨Éciently covered by a good noise-free design,
while the robustness margins cover smaller deviations.
However, it is the integrator that causes the largest reactions in the time-
domain. Two examples of this integrator wind-up eÔ¨Äect are presented here.
One on the reaction to sudden movements of the system and one on the
reaction when system limitations are surpassed.
Settle Time Rise due to Integrator Error Accumulation
The main reason for the large and delayed integrator action to disturbing
events is that it integrates/accumulates the error of the past. This accu-
mulated value is not immediately gone when the past event that caused
the error is over. Whatever the cause of the error of the past, surpassing
a system limitation or a not perfect feedforward control action dur-
ing acceleration, the integrator will have a certain value, which has to be
‚Äúreleased‚Äù and this takes time. A Ô¨Årst example of this eÔ¨Äect is shown in
Figure 4.28. It is a purely modelled response of a simple rigid-body motion
system controlled by a standard PID controller. It shows a typical 2nd-order
acceleration proÔ¨Åle as described in Section 4.2.4 for a step from one place to
another. The velocity and position are not drawn but only the position error
between the target trajectory and the real position over time is shown. When
observing the diÔ¨Äerence in the second graph between PD-control (light gray)
and PID-control (black), it is clear that the I-control action gives a delayed
eÔ¨Äect on the error. At the end of the target trajectory it takes much more
time, called settle time, before the position error is equally small as was the
case with only PD-control. In order to solve this eÔ¨Äect it is very eÔ¨Äective to
apply feedforward in an as much as possible accurate way. This is shown in
the third graph with a feedforward signal that is only 95% accurate. Already
with this rather inaccurate setting the detrimental delay of the integrator

4.4. PID Feedback Control
293
 
 
 
 
PD-control
PID-control
PID-control with 95% Feedforward
t
t
s
s
t
t
t
Acceleron setpoint
Pon error
x,a
Figure 4.28: Modelled stepresponse of a positioning system with diÔ¨Äerent con-
trollers. With only PD-control the error is large. With I-control the
errors is decreased but the settle time is also increased. Feedforward
control can solve this problem.
Note that the graph shown no values as it only serves to illustrate the
eÔ¨Äects in a qualitative manner.
is reduced, while a better feedforward controller can reduce the settle time
even further. When applying accurate feedforward the integrator can serve
to reduce random, unknown errors at low-frequencies, as it was meant for.
I-control Reaction on System Limitations
When taking a detailed look again at the block diagram of the motion control
system as was shown in the beginning of this chapter with Figure 4.1 it is
possible to identify some potential sources of non-linearities and system
limitations.
On the side of the plant any physical system has its limitations, such as
the maximum measurement range of the sensor, the voltage and current
range of an ampliÔ¨Åer by clipping, which limits the allowable jerk, the slew-
rate limitations of the ampliÔ¨Åer, which limit the allowable snap, and the
limitation of the actuation range of actuators by saturation. Further to
be mentioned are non-linearities like backlash, friction, and non-linear
stiÔ¨Äness in the mechanical components or creep and hysteresis as they
occur for instance in the piezoelectric transducers, which are presented in
Section 5.5 in the next chapter.
While the limitations due to the control system can easily be accounted for
by choosing the right components, limitations that are present in the plant
are a frequent source of errors and can even cause damage to a system when

294
Chapter 4. Motion Control
Limit
&$
¬å
160
1.8e6
3.3e4
100
0.1
1/0.25

/
6
¬ô
\
¬ã
$
d
dt
dt

dt

dt

6

6
\
/
#$
/
Mass

^
Figure 4.29: MATLAB-Simulink model of the PID-controlled mass-spring system
with saturation of the actuation force. The model for the controller
shows the PID-control action as the addition of three separate actions
according to Equation. 4.42, while the model of the mass spring system
consists of triangles representing the mass that converts the force to an
acceleration (1/0.25) and two integrators that convert the acceleration
to velocity and position. The feedback loops of velocity and position
represent the damper and the spring.
being overlooked. One reason for such errors in practice is that standard
modelling software packages, such as Matlab and Simulink, are allowing
extremely large control action, error inputs, and system states, which may
not have any relation with capabilities of the real system. The limitations
(saturation) of actuators and sensors have to be taken into account and must
be integrated in the Simulink-models by adding appropriate function blocks,
like shown in Figure 4.29, in order to keep the model close to the actual
physical system. This means, that a practical insight in the limitations of
sensors, ampliÔ¨Åers and actuators is necessary to prevent costly mistakes in
modelling mechatronic systems.
As an example to visualise the eÔ¨Äect of system limitations on the integrator,
Figure 4.30 shows the behaviour of the PID-controlled mass-spring from the
previous section (see Equation 4.42) in case of saturation of the actuation
force. The reference signal is a trapezoidal signal with a fundamental
frequency of 5 Hz and a peak-to-peak amplitude of 0.2 m (dotted black line
in the Ô¨Årst panel of the Ô¨Ågure). For the unconstrained system the actuation
force can reach ‚âà1600 N (blue solid line), while the control eÔ¨Äort for the
constrained system is limited in the simulation to 1000 N (yellow dashed
line) and 300 N (red solid line), respectively. While the control action exceeds
the actuation force limit the system does not react to changes in the control
action as the maximum actuation force is already applied (and with this
the maximum amount of energy that can be supplied to the system per

4.4. PID Feedback Control
295
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
-0.2
0
0.2
6
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
-1000
0
1000
/
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
-0.1
0
0.1
¬ô
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
-1000
0
1000
¬ã
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
-2000
0
2000
\
Figure 4.30: Behaviour of a mass positioning system under PID-control with vary-
ing limitation of the maximum actuation force: unconstrained (thick
blue line), limited to 1000 N (thin yellow line) and limited to 300 N
(red line). The Ô¨Årst plot shows the controlled position of the mass in
response to a trapezoidal reference signal (black dotted line). The
second plot shows the actuation force. The third plot denotes the er-
ror signal, which with a scaling factor also equals the P-action. The
fourth and Ô¨Åfth panel show the I-action and D-action. In the uncon-
strained situation the maximum actuation force (black line in second
plot) equals about 1600 N. When the actuator system saturates at
1000 N the eÔ¨Äect on the error signal (plot 3) is still limited. However,
a saturation level of 300 N leads to a signiÔ¨Åcant increase of the error
signal and a signiÔ¨Åcant degradation of the system performance.
unit of time). This means that due to this saturation the linear control
system becomes non-linear and the system does no longer react to the PID-
controller.
For the case where the actuation force is limited to 1000 N, the saturation
level is reached only for a very short moment (dashed yellow line) when the
reference signal changes and the D-control action contributes signiÔ¨Åcantly to

296
Chapter 4. Motion Control
the controller output14. As this saturation is limiting the control action only
very little, the increase of the control error is also very small and the system
remains in saturation only slightly longer for the time that the unsaturated
force would exceed this value of 1000 N. When the system re-enters the
linear regime, the PID-controller easily can compensate for this slightly
larger error during saturation.
However, for the case where the actuation force is limited to 300 N the
energy per time unit that can be put into the system for control is much
lower than the PID-controller would demand for the given reference signal.
The mismatch between the linear system and the actual system is too
large and leads to a larger control error and a signiÔ¨Åcant degradation of
the system performance. The main problem here is that the I-gain of the
controller continues to accumulate the error during the entire time that the
system is in saturation, which takes signiÔ¨Åcantly longer and consequently
results in much larger accumulation of the I-action as would be the case
for the unconstrained system. This eÔ¨Äect is called integrator windup. This
longer integrated and larger error cannot easily be compensated when the
system re-enters the linear regime, as the I-action only starts to decrease
once the error changes its sign like when the system is moving in the
opposite direction. This results in strong oscillations of the system and
even may lead to a special kind of instability, called limit-cycling as the too
large accumulation of integral action can lead to a bang-bang action where
the control signal is just switching between the positive and the negative
saturation of the actuation force.
Anti Wind-Up
Even when all measures including accurate feedforward control and a good
trajectory planning are implemented, incidents will happen and it remains
necessary to add anti-windup control, to suppress unwanted reactions from
the PID-controller. One frequently used method is to reduce the integrator
gain ki or even set it to zero (‚Äòshorting‚Äô15) until the system is in its linear
range again, determined by a chosen maximum error or control force.
14This is one of the reasons why for practical systems one should use smooth reference
signals rather than steps and impulse-like signals and add feedforward control. This again is
fully in line with the statements on trajectory proÔ¨Åle generation in Section 4.2.4.
15In the past, when fast position controllers were made by means of analogue electronics,
this was literally done by shorting the capacitor that contained the integrator signal.

4.4. PID Feedback Control
297
4.4.4
PID-Control of a Fourth-Order Dynamic System
In Section 3.4.2 of the previous chapter four diÔ¨Äerent characteristic me-
chanical frequency responses were derived for a fourth-order system by
combining one rigid-body eigenmode with one Ô¨Çexible eigenmode. These
are shown in Figure 4.31. All responses start with the typical -2 slope of
the rigid-body eigenmode, while the diÔ¨Äerences in the combined responses
are characterised by the successive order of poles and zeros.
A Type I dynamic system shows two zeros followed by two poles, resulting
in a positive phase shift between the related frequencies. Generally such a
system will not create large complications in feedback because of its positive
phase shift. However, the other three types all show a negative phase shift.
A Type II dynamic system with two poles followed by two zeros will cause
problems when the unity-gain cross-over frequency is close to the frequen-
cies that correspond to the poles and zeros. In that case the negative phase
shift will cause a passing of the -1 point at the right hand side in the Nyquist
plot. At higher frequencies the phase returns to -180¬∞, thereby enabling to
achieve a unity-gain cross-over frequency above the resonating area, under
the condition that there are no other resonances around that frequency. A
Type III dynamic system with only two additional poles gives a phase that
remains at -360¬∞, while a Type IV system even shows non-minimum phase
         
         
         
         
10
0
10
2
10
4
Mag.
z[¬É{
0
-180
Frequency [Hz]
Phase
101
102
10[
101
102
10[
10
-2
Frequency [Hz]
I
II
III
IV
10
0
10
2
10
4
Mag.
z[¬É{
0
-180
Phase
10
-2
-2
-2
-2
-2
-2
-2
-2
-4
Figure 4.31: The four characteristic frequency responses that result from the combi-
nation of two eigenmodes, a rigid body mode and a Ô¨Çexible eigenmode.

298
Chapter 4. Motion Control
behaviour with more negative phase than would correspond to the -2 slope
above the resonance frequency. Non-minimum phase behaviour should
generally be avoided or reduced to the lowest level possible as it limits the
possibility of pole-zero cancellation in feedforward control (unstable zeros
become unstable poles) and reduces stability in feedback.
As an example of PID-control of a fourth-order system the PID-control
of a Type III dynamic system is presented in the following. The method
shown will introduce an additional low-pass Ô¨Ålter and is also applicable for
a Type II system when the targeted unity-gain cross-over frequency is below
the frequency that corresponds to the poles.
4.4.4.1
Controlling a Type III Dynamic System
At the presentation of D-control it was demonstrated that the D-action
should be terminated (tamed) above a frequency of approximately three
times the cross-over frequency. Next to the fact that diÔ¨Äerentiation until
inÔ¨Ånite frequencies is impossible anyway, this measure would be beneÔ¨Åcial
in case of eigenfrequencies of the system at higher frequency levels. In
general it is indeed a good starting point, when designing the feedback
controller, to keep the magnitude of the frequency response at these higher
eigenfrequencies below one, thus ensuring stability.
In the following, this requirement will be examined in more detail and it will
m1
x1
k
m2
x2
k
N
100 m
1
2
Nm
5
2.5 10

measurement
Sensor
Driven body
0.25 kg
0.025 kg
F
Figure 4.32: A 4th-order system is created when the sensor is connected to the
driven body with a compliant mounting. The mass of the sensor is not
able to follow the driven bodu at higher frequencies (it ‚Äúdecouples‚Äù),
characterised by the second eigenmode, at which the two bodies vibrate
in opposite directions by the elastic coupling of k2 (The dampers are
not shown).

4.4. PID Feedback Control
299
be shown that it is possible to alleviate this requirement to some extent by
manipulating the phase. For the example, the same mass-spring system of
Section 4.4.2 is used, but now the position sensor is more real. It is not mass-
less, nor co-located directly on the primary body, but it consists of a separate
body with a mass of 25¬∑10‚àí3 kg and a mounting stiÔ¨Äness of 2.5¬∑105 N/m, as
shown in Figure 4.32. As explained in Section 3.2.5 of Chapter 3 on the
dynamics of multiple coupled bodies the conÔ¨Åguration appeared to result in
a second eigenmode with an eigenfrequency of ‚âà500 Hz. A Q of ‚âà20 is used
in the modelling, because in practice such systems often show some level of
damping.
Figure 4.33 shows both the Bode plot and the Nyquist plot of this dynamic
system when combined with the PID controller that was determined in
Section 4.4.2. When comparing this Ô¨Ågure with Figure 4.25 the eÔ¨Äect of
the additional eigenmode is clearly shown. The Nyquist plot is especially
useful in this situation as it shows in clear detail, what happens around the
‚àí1 point on the real axis with respect to closed-loop stability in this more
complex dynamic feedback system. The phase at 500 Hz due to the second
eigenmode changes from almost ‚àí150¬∞, the mass-line combined with the
D-control action, to below ‚àí180¬∞. This phase shift occurs in the frequency
range where the magnitude becomes larger than one due to the resonance
peak of the second eigenmode and as a consequence instability will occur.
The Nyquist plot clearly indicates that the ‚àí1 point on the real axis is kept
at the right-hand side when passing, indicating instability. Only when the
magnitude of the second eigenmode is kept below one by a reduction of the
loop gain this instability condition would not occur, but then the resulting
bandwidth of the controlled system would be reduced to below ‚âà20 Hz,
which is not very high for a high-performance mechatronic system.
4.4.4.2
Passive Damping
Before reducing the resonance peak by Ô¨Ålters it seems logical to Ô¨Årst consider
adding damping to the decoupling spring k2. Unfortunately generally this
spring is not compliant on purpose but the result of a not inÔ¨Ånite stiÔ¨Ä
mounting. Adding damping to a stiÔ¨Ästructure is not trivial due to the
generally low internal damping of the applied materials. This might entice
the designer to reduce the stiÔ¨Äness and add softer material with higher
internal damping, like with rubber mounts. Unfortunately, this would shift
the resonance of the second eigenmode to lower frequencies, which also
shifts the phase-lag, which is already higher below the eigenfrequency due
to the damping, to lower frequencies.

300
Chapter 4. Motion Control
 
 
 
 
 
 
10
z¬Ç
10
0
10
¬Ç
10
4
10
6
Magnitude (abs)
10
z,
10
0
10
1
10
¬Ç
10
3
10
4
z[¬É{
z¬Ç¬Ñ{
z,¬Ü{
z¬Ö{
0
Phase [deg]
Frequency [Hz]
Real Axis
Imaginary Axis
z)
z¬Ç
0
¬Ç
4
z¬Ç
z,
0
1
¬Ç
3
4
5
Q=1.6
Q¬ä[¬Ç
z){
0
40
,¬Ç{
¬Ü{
Magnitude [dB]
Figure 4.33: Bode and Nyquist plot of the feedback-loop transfer function L(s) of the
PID-controlled mass-spring system that was presented in Section 4.4.2
when the sensor is mounted on a body that decouples dynamically at
500Hz with Q ‚âà20. Due to the additional resonance the graph in the
Nyquist plot keeps the ‚àí1 point on the real axis at the right-hand side
with increasing frequency and as a consequence this feedback loop is
unstable. It will only be stable when the amplitude of the resonance
is kept below one in order to keep the -1 point at the left-hand side.
An alternative method to add damping to a mechanical structure is the use
of a tuned-mass damper, basically just a small mass that is connected to
the structure by a spring and a damper. One example of such a system,
will be presented in Chapter 9 for reducing vibration in frames but also for

4.4. PID Feedback Control
301
active feedback controlled stages this principle is very useful. It is described
in detail in the phd thesis ‚ÄúRobust Mass Damper Design for Bandwidth
Increase of Motion Stages [92] by Kees Verbaan from Eindhoven University
of Technology.
4.4.4.3
Shifting the Phase
Another method, more related to active control, is based on the understand-
ing that the problem occurs because the phase is almost ‚àí180‚ó¶. When the
phase-lag would be larger, a high magnitude above one would no longer give
a problem as long as the ‚àí1 point on the real axis is passed at the left-hand
side. For the given example this can simply be arranged by inserting a
simple low-pass Ô¨Ålter in the loop at a frequency around the eigenfrequency
of the decoupling mass. Combined with the Ô¨Årst-order low-pass Ô¨Ålter used
for the ‚Äútaming‚Äù of the diÔ¨Äerentiator, this second low-pass Ô¨Ålter forms a
second-order low-pass Ô¨Ålter. This combination can also be replaced by a less
damped second-order low-pass Ô¨Ålter in order to limit the phase shift at the
unity-gain cross-over frequency. But this is a detail, which can be adapted
when a further optimisation of the system is required.
For the understanding of the principle it is useful to treat them Ô¨Årst as
two separate Ô¨Ålters. Figure 4.34 shows the eÔ¨Äect of the additional low-pass
Ô¨Ålter on the feedback-loop transfer function of the example PID-controlled
mass-spring system. Next to the situation without the additional low-pass
Ô¨Ålter, also the feedback-loop response of the system with a low-pass Ô¨Ålter
at 350 or 650 Hz is shown. The Bode plot clearly demonstrates that such a
Ô¨Ålter has only a limited negative eÔ¨Äect on the phase margin at the cross-over
frequency of 100 Hz, while the phase at the resonance has deÔ¨Ånitively come
below ‚àí180‚ó¶. In this more complex PID-control situation the Nyquist plot is
an indispensable tool as it more clearly shows the eÔ¨Äects regarding stability.
With the additional Ô¨Årst-order low-pass Ô¨Ålter, stability is achieved as the
‚àí1 point on the real axis of the Nyquist plot is passed at the left-hand side,
while without a low-pass Ô¨Ålter the system would be unstable. An optimal
situation is created when the Ô¨Ålter frequency is at 350 Hz resulting in a
symmetrical left-hand passage of the Q = 1.6 circle, indicating an equal mag-
nitude of the closed-loop response for the two frequencies that are closest
to the circle. It results in a maximum amplitude rise of 60 % both at the
cross-over frequency and at the second eigenmode. This optimum is con-
Ô¨Årmed in the Complementary Sensitivity T(s) and Sensitivity S(s) Bode plot
of Figure 4.35.
A clear beneÔ¨Åt of this method is the eÔ¨Äective suppression by the feedback of

302
Chapter 4. Motion Control
 
 
 
10
z,
10
0
10
1
Magnitude (abs)
 
 
¬ö(6%
(6%¬É¬Å{¬Ä¬ç
(6%[¬Å{¬Ä¬ç
10
1
10
2
10
[
z¬Å¬Å{
z[¬É{
z,¬Ü{
0
Phase [deg]
^¬å¬ì¬Ä¬ç¬ù
z)
z¬Ç
0
2
)
z¬Ç
z,
0
1
2
[
)
¬Å
&¬ï
¬ã$¬ï
Q¬ä,¬É
Q¬ä[¬Ç
6
#
magnitude

,¬Ü{
o
z¬Ç{
0
20
Magnitude [dB]
Figure 4.34: Inserting an additional low-pass Ô¨Ålter in a PID-controlled mass po-
sitioning system will only slightly decrease the phase margin, but
changes the phase at the decoupling mass resonance to below ‚àí180‚ó¶.
The Nyquist plot shows more clearly the beneÔ¨Åcial eÔ¨Äect. When Ô¨Åltered
at 350 Hz the Q = 1.6 circle is just touched.
the inÔ¨Çuence due to the resonance of a second eigenmode with an amplitude
larger than one. The original Q value from the uncontrolled system is re-
duced from more than twenty to less than a factor two by tamed PID-control
with an additional Ô¨Årst-order low-pass Ô¨Ålter. Another advantage of the
additional low-pass Ô¨Ålter is the ‚àí3 slope of the Complementary Sensitiv-
ity T(s) at higher frequencies, which means that the resonances of higher
eigenmodes and the high-frequency sensor noise will be less excited.

4.4. PID Feedback Control
303
10
2
10
3
10
z,
10
0
10
1
Magnitude (abs)
Frequency [Hz]
 
 
10
z,
10
0
10
1
Magnitude (abs)
 
 
(6%¬É¬Å{¬Ä¬ç
(6%[¬Å{¬Ä¬ç
#S(s)
]T(s)
-3
-2
z¬Ç{
0
20
Magnitude [dB]
z¬Ç{
0
20
Magnitude [dB]
Figure 4.35: The closed-loop Bode plot of the sensitivity functions of the PID-
controlled mass positioning system with the sensor on a decoupling
mass show the eÔ¨Äect of the low-pass Ô¨Ålter frequency on the magnitude
of these functions at the cross-over frequency and the eigenfrequency
of the decoupling mass. At 350 Hz these magnitudes are equally bal-
anced. This optimal setting is also conÔ¨Årmed by the Sensitivity plot
at the lower side.

304
Chapter 4. Motion Control
4.4.5
PID-Control of a Piezoelectric Actuator
In Section 4.2.1 on model-based feedforward control the piezoelectric actua-
tor was used in a scanner. As indicated and will be shown more in detail
in Section 5.5 on piezoelectric actuators these actuators always present a
signiÔ¨Åcant stiÔ¨Äness between the moving parts. For that reason position
control of a piezo-actuated motion system by means of feedback is to some
extent comparable with the control of the second-order system with a mass
supported by a compliant spring of Section 4.4.2, although with a much
lower compliance and much higher eigenfrequency.
As shown in Figure 4.36 with the measured frequency response of the
scanner unit example from the feedforward section the spring-line is Ô¨Çat,
frequency independent up till 10 kHz. This implies also hardly any phase-
lag and at Ô¨Årst glance one would conclude that controlling such a system
is an easy job. One could think of just notching the peak away by pole-
zero cancellation, followed by a simple P-control action to lift the springline
above unity gain and all seems well. One could even consider to take an
even higher loop-gain, which would lead to a higher unity-gain cross-over
frequency. However, in most cases, including this case, many additional
resonances above the Ô¨Årst resonance cause irregularities in amplitude and
phase. This precludes a unity-gain cross-over frequency above the Ô¨Årst
Magnitude [abs]
10
3
10
4
z¬Ç¬Ñ{
z,¬Ü{
z¬Ö{
0
Frequency [Hz]
Phase [deg]
10
z,{
10
z¬Ü
10
z¬É
10
z)
z¬Ç{{
z,¬É{
z,¬Ç{
z¬Ü{
Magnitude [dB]
Figure 4.36: Bode plot of the measured data of the piezoelectric-actuator based
scanning unit of Figure 4.6. It shows a Ô¨Çat frequency response till
high frequencies, which limits the loop-gain at low frequencies.

4.4. PID Feedback Control
305
Magnitude [abs]
10
3
10
4
z)¬Å{
z[¬É{
z¬Ç¬Ñ{
-180
Frequency [Hz]
Phase [deg]
10z¬Ç
10 0
10 ¬Ç
10 -4
z){
0
40
-80
Magnitude [dB]
Figure 4.37: Bode-plot of the frequency response of the piezoelectric scanner with
PI2-control. P-control has increased the loop-gain over the entire fre-
quency band and I2-Control has increased the gain at low frequencies.
resonance so it is not possible to apply the same method as was used with
the second-order supported mass system. In fact in literature only solutions
are known where the unity gain cross-over frequency is placed below the
resonance frequency. In that case a new issue is encountered as the gain is
constant due to the spring-line. One would assume that by virtue of the zero
phase only P-Control with a value of kp ‚âà5¬∑10‚àí7 N/m would be suÔ¨Écient but
then the loop-gain would be equal to one from approximately 0 ‚Äì 5 kHz,
which would not give any reduction of the Sensitivity S(s).
4.4.5.1
Creating a Fourth-Order System
As counter-intuitive as it might seem, instead of pursuing the PID-control
method of the second-order mass-spring system it is better to mimic the
fourth-order system of the previous case by adding two integrators as shown
in Figure 4.37. With this response taken as the starting point the tamed D-
control action with additional low-pass Ô¨Ålter of the ‚Äúoptimal‚Äù PID-Controller
of the previous section can be added to create suÔ¨Écient damping and turn
the phase at the resonance beyond 180 degrees. This will result in a feedback
controlled system with low sensitivity for disturbances.
One might even consider to add a third integrator but that would further
increase the risk of integrator wind-up, as was explained in Section 4.4.3.2.

306
Chapter 4. Motion Control
Anti-wind-up measures are really necessary because a piezoelectric actuator
is strictly limited in motion range to only a few micrometers. Furthermore
the integrators work below relatively high frequencies, which in this case
means that integrator wind-up will happen very quickly in case of reaching
a limit. The more integrators the system has, the more dramatic the eÔ¨Äect
will be.
4.4.6
PID-Control of a Magnetic Bearing
In the previous examples the moving object was connected by either a spring
with zero-stiÔ¨Äness or a positive stiÔ¨Äness. Mechatronic systems often use
electromagnetic actuators with permanent magnets and these elements
have a nasty side eÔ¨Äect in that they attract ferromagnetic objects with a force
that increases when the distance to the magnet decreases, thereby showing a
negative stiÔ¨Äness. In most cases the mechatronic designer limits those forces
by a suitable material choice but there are examples of actuators where
this negative stiÔ¨Äness cannot be avoided as will be presented in Chapter 5
and these actuators require a control action to compensate it. A frequently
used example of such a mechatronic system are magnetic bearings as will
be presented in Section 5.3.4.5 and controlling such system is the topic of
this section.
4.4.6.1
Frequency Response
Due to the negative stiÔ¨Äness the moving shaft of a magnetic bearing will
stick to the magnetic stator and as consequence it can only work with
active feedback control which keeps the shaft away from the stator. To
m
k = - k
Staonary reference
x
Fa
n
Figure 4.38: A mass spring system with a negative stiÔ¨Äness, used as dynamic model
for a magnetic bearing.

4.4. PID Feedback Control
307
10
z¬Ñ
10
z¬É
10
z¬Å
10
z)
10
z[
Magnitude (abs)
10
0
10
1
10
2
10
[
z,¬Ü{
z¬Ö{
0
Phase [deg]
Frequency  [Hz]
-2
¬ö$$

0f
z,){
z120
z100
z¬É{
z¬Ü{
Magnitude [dB]
Figure 4.39: The Bode plot of the frequency response of a magnetic bearing shows
a frequency response without resonance and with a constant phase of
‚àí180¬∞due to the negative stiÔ¨Äness value.
illustrate how this control is achieved, Figure 4.39 shows the Bode plot16
of the frequency response of a single axis dynamic system, consisting of
an actuator with a gain equal to one and a (negative!) stiÔ¨Äness k = ‚àíkn =
‚àí104 N/m, a moving mass m = 0.1 kg and a position sensor also with a gain
of one:
Ct(s) = x
F =
1
ms2 + k =
1
ms2 ‚àíkn
=
1
0.1s2 ‚àí104
[m/N]
(4.51)
Ct(œâ) =
1
‚àí0.1œâ2 ‚àí104 = ‚àí
1
0.1œâ2 +104
[m/N].
(4.52)
The magnitude of the frequency response looks like a well damped mass-
spring system but the phase plot is fully diÔ¨Äerent as it shows ‚àí180¬∞phase
over the entire frequency band, caused by the negative stiÔ¨Äness value. This
negative sign implies that the position is always in the opposite direction of
the force.
With increasing frequency the compliance of the mass-line will take over
the total compliance from the negative spring-line at their intersection
16The magnitude plot is not as one would expect by intuition as the clear instability at steady
state with a maximum error only limited by the position of the stator would suggest a high
gain at 0 Hz. This is another example of the fact that the frequency-domain is a mathematical
model and in this case it can only be measured when the shaft is kept at the zero-force magnetic
centre by a magical actuator.

308
Chapter 4. Motion Control
frequency17 f0:
f0 = 1
2œÄœâ0 = 1
2œÄ

kn
mm
= 1
2œÄ

104
0.1 ‚âà50
[Hz].
(4.53)
The phase remains constant over the entire frequency band because the
mass-line also has a phase of ‚àí180‚ó¶. Next to the negative sign a second ob-
served diÔ¨Äerence with a regular mass-spring system is the lack of resonance.
This is caused by the fact that the denominator does not become zero at any
value of œâ and this corresponds with the location of both poles at opposite
sides of the real axis at a value of ¬±
4
‚àík/m = ¬±
4
kn/m = ¬±

105 ‚âà¬±320. With
this information the design of a PID-controller can be realised according to
the same steps made in the previous part of this section. Still some things
will show to be quite diÔ¨Äerent because of the negative stiÔ¨Äness.
4.4.6.2
Positive StiÔ¨Äness by P-Control
First P-control is applied in a magnitude that is at least larger than the
absolute value of the negative stiÔ¨Äness (kp > kn). In mechanical terms this
means that after closing the negative feedback loop the positive stiÔ¨Äness
by the P-control action will be larger than the negative stiÔ¨Äness of the
actuator. For reasons of robustness against variations in the negative
stiÔ¨Äness the positive control stiÔ¨Äness kp should be chosen at least as large
as the maximum value of the negative stiÔ¨Äness that can occur.
While in most cases a magnetic bearing is based on variable reluctance
actuation (Section 5.3) in practice the negative stiÔ¨Äness can vary more than
a factor two over the total motion range of the bearing. For this reason in
practice kp is often chosen to be at least a factor two larger than the average
negative stiÔ¨Äness from the calculations. This choice results in a total positive
stiÔ¨Äness that is mostly larger than the magnitude of the negative stiÔ¨Äness.
4.4.6.3
D-Control and Pole Placement
The eÔ¨Äect of the D-control action on the poles is illustrated in Figure 4.40
with a so called root-locus plot, which displays the location of the poles
with increasing proportional and diÔ¨Äerential gain settings. Starting with
both poles on the real axis it shows that with only P-control and suÔ¨Écient
17 f0 is not named ‚Äùnatural-‚Äú or ‚Äùeigenfrequency‚Äú because no resonance occurs and no
eigenmode is observed.

4.4. PID Feedback Control
309
Real Axis
Imaginary Axis
Increase kp
Increase kp
Increase kp
Increase kp
Increase kd
Increase kd
 k  < kn
p
 k  < kn
p
 k = kn
p
 k  > kn
p
 k  > kn
p
Stable damped 
system
Stable damped 
system
100
200
300
0
-100
-200
-300
100
200
300
0
-100
-200
-300
-400
400
k = 1
p
nk
m
nk
m
k = 1
p
-
Figure 4.40: Root-locus plot of the diÔ¨Äerent pole locations of an instable magnetic
bearing system consisting of a mass m = 0.1 kg with a negative stiÔ¨Äness
k = ‚àíkn = ‚àí104 N/m, while applying negative feedback with increasing
proportional and diÔ¨Äerential gain. Without control (kp = 1 and kd = 0),
the poles of the mechanical system are located at ¬±320 on the real axis.
With control, increasing gains cause the poles to shift to the left-half
of the Laplace-plane in three steps. First P-control with an increasing
value of kp is added until at kp = kn the system has obtained zero-
stiÔ¨Äness with poles at the origin. In the second step a further increase
of kp will create the necessary control stiÔ¨Äness to the reference and
with for instance kp = 2.3kn = 2.3 ¬∑ 104 N/m an undamped system is
created with two conjugate complex poles at ¬±360 on the imaginary
axis. In the third step D-control is added to create damping by shifting
the poles over a circle to the left. Note that the circle is shown as an
ellipse because of the diÔ¨Äerence in scales.
gain (kp > kn), the closed-loop response would become identical to a regu-
lar undamped mass-spring system. The equivalent natural frequency of
this system would correspond to the unity-gain cross-over frequency fc of
the combined negative-stiÔ¨Äness actuator with the P-control gain kp at a
frequency equal to or slightly larger (square root of stiÔ¨Äness!) than f0.
The second step is the addition of tamed D-control to prevent the ampliÔ¨Åca-
tion of high-frequency disturbances.
D-control will shift the poles to the left over a circle, which has been deÔ¨Åned
for a damped mass-spring system in Equation (3.56) of Chapter 3. As a fur-
ther consequence the D-control action will increase the unity-gain cross-over

310
Chapter 4. Motion Control
 
 
 
 
 
 
10
z)
10
z¬Ç
10
0
10
¬Ç
Magnitude (abs)
10
z,
10
0
10
1
10
¬Ç
10
3
10
)
z¬Ç¬Ñ{
z,¬Ü{
z¬Ö{
0
Phase [deg]
Frequency [Hz]
Open-loop
Closed-loop
PD - control
PID - control
0f
cf
z){
z¬Ü{
0
){
Magnitude [dB]
Figure 4.41: The feedback-loop and closed-loop Complementary Sensitivity
Bode plot of the magnetic bearing with negative stiÔ¨Äness with PD-
control (dashed lines) and PID-control (solid lines). The Complemen-
tary Sensitivity frequency response shows a magnitude larger than
one (Q = 2), which stretches over a wide frequency range until fc. With
PD-control starting at 0 Hz and with PID-control starting around
20 Hz.
frequency and as a result the feedback-loop unity-gain cross-over frequency
will become larger than the intersection frequency f0 of the mass- and the
spring-line of the magnetic bearing.
This eÔ¨Äect leads to an important conclusion on magnetic bearings that the
negative stiÔ¨Äness of a magnetic bearing in combination with the supported
mass sets a lower limit to the bandwidth that has to be realised in the
closed-loop system. When other dynamic problems like resonating mode-
shapes and phase-delays in the electronics prevent the realisation of such a
high bandwidth the magnetic bearing cannot be made stable.
This conclusion is in principle true for any system that is unstable in open-
loop, like an inverted pendulum or a rocket. In practice further optimisation
of the tuning parameters for a magnetic bearing is often required to balance
the inÔ¨Çuence of the negative stiÔ¨Äness, its maximum force capability and the
mechanical dynamics of the system. Also in this case I-control can be very
useful.

4.4. PID Feedback Control
311
Real Axis
Imaginary Axis
z¬Ç5
z¬Ç
z,5
z,
z{5
{
z,
z{8
z{6
z{4
z{¬Ç
{
{¬Ç
{4
{6
{8
,
Q¬ä¬Ç
Q¬ä,{
¬Ç{¬Ä¬ç
,{{¬Ä¬ç
PID-control
PD-control
Q¬ä,¬É
Figure 4.42: The Nyquist plot of the feedback-loop frequency response of the mag-
netic bearing with PD- and PID-control explaining the magnitude of
the closed-loop Complementary Sensitivity frequency responses by
the position relative to the Q-circles.
4.4.6.4
I-control for Reduced Sensitivity
With I-control the rather limited feedback-loop gain below œâi = 0.1œâc can
be increased, resulting in a decreased Sensitivity S(s) at these frequencies.
Figure 4.41 shows the feedback-loop and closed-loop frequency response of
the combined PD- and PID-controller with the plant with negative stiÔ¨Äness.
In this case kp = 2.3¬∑104 N/m, which is 2.3 times the value of the negative
stiÔ¨Äness. In feedback this value adds to the negative stiÔ¨Äness to a total value
of kt = 1.3¬∑104 N/m and the poles of the closed-loop system have an imaginary
value of ¬±
4
kt/m = ¬±

1.3¬∑105 ‚âà¬±360, as shown in Figure 4.40. The D-control
action goes from 30 Hz until taming at 300 Hz giving a unity-gain cross-
over frequency of 100 Hz. I-control works below 10 Hz. The closed-loop
bandwidth is 100 Hz and the resonance peak is less damped (Q = 2) than
with the previous system with a positive stiÔ¨Äness value as the phase-lead is
only around 30‚ó¶. With PD-control this eÔ¨Äect is even more prominent as it
stretches until 0 Hz. This eÔ¨Äect is fully caused by the ‚àí180¬∞of the negative
stiÔ¨Äness and can be better analysed with the Nyquist plot of Figure 4.42.
With PD-control the magnitude starts at kp/kn = 2.3 and runs around the
Q = 2 circle. Over the frequency band ranging from 0 Hz until just more
than 100 Hz the graph remains between the Q = 1.6 and the Q = 2 circle,
which means that in closed-loop the magnitude will be around 1.8 in that

312
Chapter 4. Motion Control
frequency range, which is observed in the Bode plot. With PID-control the
graph runs just inside the Q = 2 circle from 20 Hz to 100 Hz, which results
in the observed magnitude of the closed-loop frequency response in that
frequency range in the Bode plot, while the closed-loop response below 20 Hz
approaches a value of one because of the high loop gain due to the integrator.
A reduction of the proportional gain below the example value kp = 2.5¬∑104 N/m
will cause the graph on the Nyquist plot to approach the ‚àí1 point on the
real axis, resulting in a higher Q over a wider range of frequencies until
at-half the presently chosen value (kp = 1.15¬∑104 N/m ), the system will start
to resonate at 20 Hz. Optimal tuning of such a magnetic bearing is clearly
not trivial as the optimisation depends on many parameters, like the ex-
pected frequency spectrum of the disturbances and the frequency range
of operation. It is especially important to notice here that the closed-loop
system is only stable when kp is suÔ¨Éciently high. Halving kp would cause
the feedback-loop response of the Nyquist plot to cross unity gain at the -1
point on the horizontal axis, indicating marginal stability. With an even
lower proportional gain value the -1 pint would be passed at the right-hand
side, indicating instability of the closed-loop system.
Like the example of the mass-spring system of Section 4.4.2, also this feed-
back system of a magnetic bearing is conditionally stable and generally such
systems are very diÔ¨Écult to tune, especially in this case where the plant is
unstable. Without closing the loop it is impossible to measure the frequency
response of the plant and it is also not possible to use the classical method to
start a newly designed feedback system by starting with a low proportional
gain and increasing the gain gradually until instability occurs. Such a
method cannot be used with conditionally stable systems like a magnetic
bearing with PID-control. The only practical solution is to start tuning
without the I-control action and measure the system after an initial stable
situation is reached. Based on those measurements the control parameters
can be optimised and the I-control action can be added.

4.4. PID Feedback Control
313
4.4.7
Optimisation by Loop-Shaping Design
All examples shown were reduced-order simpliÔ¨Åed versions of a real mecha-
tronic system and for that reason the derived guidelines should only be seen
as a good starting point for further optimisation. When reÔ¨Åning the tuning
of more complex systems several tricks can be used. These include adapting
the frequency ration Œ±, the addition of Ô¨Ålters to reduce the resonance peaks
by notching, equivalent to pole-zero cancellation in feedforward control and
Ô¨Ålters to shift the phase and amplitude to more favourable values. This
optimisation of the tuning of a feedback loop to adapt the real measured
system responses in Bode and Nyquist plots is called loop-shaping design.
With loop-shaping design the total frequency range of interest is divided in
three bands as also indicated in Figure 4.43:
1. The loop-gain at low frequencies should be maximised in order to
achieve a low sensitivity to disturbances.
2. The loop-gain at high frequencies should be minimised to reduce the
Open-loop Gain                                                                    Closed loop
High gain
   (I-control)
&`
slope 
Peak disturbance
%
Bandwidth
S(s)
T(s)
Low frequency
      region
Cross-over
    region
High frequency
      region
Stability
Frequency [Hz]
Frequency [Hz]
-40
-20
0
20
10
2
10
3
10
4
z,¬Ü{
z¬Ö{
z¬Ç¬Ñ{
-60
¬Ü{
1
G(s)
C(s) 
-
e
u
r
y
L(s)
L(s)
{¬Ñ
0.1
10
1
10
2
10
3
10
4
10
1
Magnitude (dB)
Phase [deg]
Magnitude (abs)
Magnitude (dB)
0
5
-3
-5
-10
-15
-20
Unity-gain - 0dB
cross-over frequency
       Low gain
|%	¬á
I-control
Figure 4.43: With loop-shaping design, the Bode-plot of the feedback loop response
is used to optimise in more detail the magnitude and phase for sup-
pression of the disturbances with suÔ¨Écient stability margins in the
cross-over frequency region.

314
Chapter 4. Motion Control
impact of noise and high frequency resonances.
3. The unity-gain cross-over region should be designed with optimal
stability and robustness by means of suÔ¨Écient stability margin.
These three diÔ¨Äerent targets are not very compatible as the Ô¨Årst requires a
steep rise of gain with decreasing frequency with corresponding phase-lag.
Also the second requires a steep slope with phase-lag while the crossover
area requires less phase-lag. In the following diÔ¨Äerent methods are described
to further optimise the PID-feedback loop.
4.4.7.1
Optimal Value of Alpha
The design of the diÔ¨Äerent PID-controllers used the factor Œ± ‚âà3.2 between
the frequencies fi, fd, fc and ft. This is based on the experience that a phase
margin of ‚âà45¬∞is a good value in practice, although it also determines a
frequency ratio of a factor 30 with consequences of a relatively high gain at
higher frequencies.To investigate this seemingly ideal ratio several studies
are done to investigate the sensitivity of the feedback controller for varia-
tions in this ratio.
One such result is shown in Figure 4.44, which was done by Ernst Csencsics
from the Christian Doppler Laboratory for Precision Engineering for Auto-
mated In-Line Metrology at the Automation and Control Institute (ACIN),
TUWien [24]. The factor between the frequencies was given the variable
Œ±. The targeted plant is a fast steering mirror, which is supported by a
compliant spring, giving a similar frequency response and PID-controller as
the system from Section 4.4.2, in this case with a resonance frequency of the
Ô¨Årst eigenmode at 30 Hz and a unity-gain cross-over frequency of 400 Hz.
The value Œ± was varied in three values, 2, 3 and 4.5.
It clearly shows that an increase of Œ± above 3 decreases the loop-gain at lower
frequencies signiÔ¨Åcantly with a corresponding increase of the sensitivity
while the eÔ¨Äect on the peaking of the complementary sensitivity at 400Hz
is hardly improved. A decrease of Œ± below 3 gives a signiÔ¨Åcant rise of the
loop-gain with corresponding decrease of the Sensitivity. However, the peak-
ing at 400 Hz of both the Complementary Sensitivity and the Sensitivity
is signiÔ¨Åcantly increased. The conclusion in the article is that the factor
Œ± = 3 is indeed a good initial value for a conservative and robust controller
for applications where production tolerances need to be allowed for reduced
cost. With more advanced applications where each system is individually
tuned, like with the waferscanners of Chapter 9, it is often allowed to reduce
the stability margins in favour of a better performance.

4.4. PID Feedback Control
315
10
0
10
1
10
2
10
3
10
4
z40
z20
0
20
40
60
80
]
B
d
[ e
d
u
tin
g
a
M

 = 2

 = 3

 = 4.5
10
0
10
1
10
2
10
3
10
4
z250
z200
z150
z100
z50
0
Frequency [Hz]
]¬∞[ e
s
a
h
P
fc
10
0
10
1
10
2
10
3
10
4
z50
z40
z30
z20
z10
0
10
Magnitude [dB]

 = 2

 = 3

 = 4.5
10
0
10
1
10
2
10
3
10
4
z80
z60
z40
z20
0
Frequency [Hz]
 

 = 2

 = 3

 = 4.5
(c) Senvity S(s)
(b) Complementary sensitivity T(s)
10
0
10
1
10
2
10
3
z30
z20
z10
0
10
Frequency [Hz]
Magnitude [dB]

 = 2

 = 3

 = 4.5
(a) Feedback loop L(s)
Real system
Modelled
]
B
d
[ e
d
u
tin
g
a
M
Figure 4.44: The eÔ¨Äect of a variation in the inter-frequency factor Œ± of a PID con-
troller for a fast steering mirror device while the unity-gain cross-over
frequency is kept constant. It clearly shows the eÔ¨Äect of Œ± on both the
Sensitivity and Complementary Sensitivity.
Source: Ernst Csencsics.
4.4.7.2
Additional Low-Pass Filtering
The described PID-control frequency response of Section 4.4.4 with a com-
bination of the three basic PID-control gains and a second-order low-pass
Ô¨Ålter for taming the D-control action and shifting the phase at the Ô¨Årst
resonance is shown in Figure 4.45. In practice this conÔ¨Åguration has be-
come a standard in low-stiÔ¨Äness mass-positioning feedback systems with
force actuation by Lorentz actuators. It has proven to be near optimal with
respect to robustness against system variations and tolerances.
When observing this graph without knowing how it was generated one
should conclude that it starts with an integrator pole, followed by two zeros
and Ô¨Ånished by two poles. The two poles are deÔ¨Åned as a second-order sys-
tem which could have two complex conjugate poles, while the two zeros were
deÔ¨Åned by the two Ô¨Årst-order Ô¨Ålter, one of the termination of the integrator

316
Chapter 4. Motion Control
 
 
 
 
 
 
10
4
10
5
10
6
Magnitude (abs)
10
z,
10
0
10
1
10
2
10
3
10
4
z¬Ö{
z)¬Å
0
45
¬Ö{
Phase [deg]
Frequency [Hz]
P-control
-1
+1
-1
Noise 
'
Phase
$
           
D-control
I-control
80
100
120
Magnitude [dB]
P-control
Figure 4.45: The PID-control frequency response with additional phase shifting low-
pass Ô¨Ålter can be seen as an optimal motion controller of a mechanical
system.
and one for the start of the diÔ¨Äerentiator. By combining these into one
second-order Ô¨Ålter and optimising the response by adapting the damping by
moving the two poles from the real axis into two complex-conjugate poles
the control designer has another setting to Ô¨Ånd the most optimal tuning for
a certain situation.
4.4.7.3
Notching Filters
When the mechanics cannot be further improved and tuning of all regu-
lar PID-Control settings is insuÔ¨Écient for the performance, often control
engineers apply a notching Ô¨Ålter, also called simply a ‚Äúnotch‚Äù, to suppress
the peaks in the frequency response due to resonating eigenmodes. It is
a typical method for the frequency range above the unity-gain cross-over
frequency.
One way to design such a Ô¨Ålter is to use an exact inverse of the resonance,
which causes pole-zero cancellation. Figure 4.46 shows the eÔ¨Äect of this
method on magnitude and phase at the Ô¨Çexible eigenmode. One drawback
of this method is that this compensation requires an almost perfect tuning
of the frequency of the Ô¨Ålter to the resonance as otherwise one would get a
closely spaced combination of two poles and two zeros. This is particularly
prominent with a high Q resonance where depending on the relative position
of the poles and zeros the phase may either jump down or up. In series
production it would lead to the need for individually tuning every controller

4.4. PID Feedback Control
317
10
z,
10
0
10
1
Magnitude [abs]
 
¬öz¬ç|¬í¬ü,{¬á
6z¬ç|¬í¬ü¬Ç¬á
6z¬ç|¬í¬ü{¬Å¬á
Phase [deg]
^¬å¬ì¬Ä¬ç¬ù
 
 
 
10
1
10
¬Ç
10
3
z[¬É{
z,¬Ü0
0
z¬Å
z)
z[
z¬Ç
z,
0
1
¬Ç
3
)
¬Å
z,
0
1
¬Ç
3
)
¬Å
Real Axis
¬ã$¬ï
z¬Ç{
0
¬Ç{
Magnitude [dB]
Figure 4.46: With notching by pole-zero cancellation the almost undamped reso-
nance can be replaced by a well damped resonance under the condition
that the frequency tuning is perfect. A high damping reduces the
phase-lead of the diÔ¨Äerentiator.
to cope with the spread in the system dynamics due to production tolerances.
Furthermore a lowering of the resulting Q-factor (more damping) corre-
sponds to an increased phase-lag at lower frequencies, thereby reducing
the phase-lead of the diÔ¨Äerentiator. This all means that the notch should
not be chosen too sharp. With digital Ô¨Ålters like the biquad Ô¨Ålters, which
will be presented in Section 4.5.6, it is possible to create notches where
the depth and width can be set independently. This allows to apply the
peak reduction over a somewhat larger frequency band and increases the
tolerance for changes in the eigenfrequency of the resonance although the
phase eÔ¨Äects at lower frequencies will be larger. It all underlines that one
should be careful when applying this compensation.

318
Chapter 4. Motion Control
4.4.7.4
Peaking and Shelving Filters
When optimising the Sensitivity S(s) in the frequency range below the unity-
gain cross-over frequency it is not illogical to consider the opposite approach
from a notching Ô¨Ålter by adding a peaking Ô¨Ålter as shown in Figure 4.47.
Indeed, adding such a Ô¨Ålter in the loop will create a peak in the loop-gain and
as a consequence a valley in the Sensitivity, as was clearly demonstrated
in Figure 4.26 for the spring supported mass. This is especially useful
for situations where disturbances occur at well deÔ¨Åned frequencies, like
50 or 100 Hz for vibrations caused by mains driven machines. Unfortunately
also peaking Ô¨Ålters aÔ¨Äect the phase margin in the cross-over area, increasing
the Sensitivity at higher frequencies due to the waterbed eÔ¨Äect. The smaller
the frequency band of the peaking Ô¨Ålter, the smaller this drawback will be
but then also the risk of erratic tuning is larger. This means that like with
the notching Ô¨Ålter, also using a peaking Ô¨Ålter should be done with care.
Shelving Ô¨Ålters are characterised by a constant magnitude above and below
a cross-over frequency range with diÔ¨Äerent levels as shown in Figure 4.47.
They can easily be made with digital Biquad Ô¨Ålters and can be used to
compensate the eÔ¨Äect of Type-I or Type-II dynamic systems. The Type-I
version with a zero pair ‚Äì pole pair combination shows a positive gain
step with a positive phase jump. When such a response is present in the
high loop-gain frequency area it would not be problematic but at a certain
maximum achievable unity-gain cross-over frequency it implies a lower loop-
gain at lower frequencies, thereby increasing the Sensitivity. By using a
shelving Ô¨Ålter the step in gain can be compensated. For the Type-II version
with a pole pair ‚Äì zero pair combination with a negative gain step and
negative phase jump it can cancel both poles and zeros, thereby reducing
the eÔ¨Äect on stability of the negative phase jump.
-5.00
0.00
5.00
10.00
15.00
20.00
25.00
10
100
1000
10000
100000
Magnitude [dB]
Frequency [Hz]
6!$%
#$%
Figure 4.47: With peaking- and Shelving Ô¨Ålters it is possible to change the gain over
selected frequency bands to compensate unwanted eÔ¨Äects or enhance
wanted eÔ¨Äects.

4.4. PID Feedback Control
319
4.4.8
Design Steps for PID-control
The examples shown in this main section on PID control showed a design
approach to determine the diÔ¨Äerent variables. This can be summarised as
a list of PID Design Steps:
1. P-Control (kp): When tuning a PID controller for a mass-based motion
system one should always start with requirements on the allowable
maximum level of the two most important Sensitivity functions, the
Sensitivy S(s) for displacement disturbances and the Process Sensi-
tivity G(s) for disturbing forces, at the frequencies where the most
signiÔ¨Åcant disturbances occur. These maximum sensitivity levels lead
to a corresponding minimum level of the loop-gain. The proportional
feedback loop-response with -2 slope should match or surpass these
minimum loop-gain levels at any frequency. The initial unity-gain-
crossover frequency fc,1 of the feedback loop is equal to the frequency
where this proportional feedback loop crosses the 0dB-line. The pro-
portional gain (kp) of the feedback controller, including actuation and
sensing should be chosen equal to the inverse of the gain of the me-
chanics part of the plant at this initial unity-gain cross-over frequency.
2. D-Control (kd): The diÔ¨Äerentiating action should start at a frequency
fd approximately equal to 0.6 times the found value for fc,1 and be
terminated at a frequency equal to ten times the starting frequency
(ft = 10fd). As a result of the D-control action the unity gain cross-
over frequency will shift to a higher frequency at fc,2 ‚âà3fd, which is
approximately 1.8 times the initial unity-gain cross-over frequency.
3. I-Control (kd): The integrating action should be applied below a
frequency fi equal to one third of the starting frequency of the diÔ¨Äer-
entiator, which corresponds approximately to one tenth of the higher
unity-gain cross-over frequency (fi = 0.33fd ‚âà0.1fc,2).
4. Optimise 1: By checking the resulting feedback loop frequency re-
sponse including integrator against the required levels for the sensitiv-
ity functions, the control designer can determine whether it is possible
to shift the plot of the feedback loop to the left by reducing both kp and
the diÔ¨Äerent frequencies (fi, fd, fc,2 and ft) to suitable Ô¨Åtting values.
5. Optimise 2: Loop-shaping by varying Œ± and adding Ô¨Ålters, like notch-
ing, peaking and shelving Ô¨Ålters, allow further Ô¨Ånetuning of the system
depending on the necessary level of robustness and sensitivity reduc-
tion.

320
Chapter 4. Motion Control
4.5
Digital Signal Processing - The Z-Domain
The PID-controllers presented in the previous sections were analysed in
continuous-time, where all signals change continuously over time without
intervals or steps. Most modern controllers operate with digital proces-
sors in the discrete-time-domain, also called the Z-domain, which allows
to create Ô¨Ålters by combining scaled sampled data at Ô¨Åxed intervals. In
many situations it is suÔ¨Écient to design the system by creating the control
Ô¨Ålters in continuous-time frequency responses and use a corresponding
transformation that translates the Ô¨Ålters into their discrete-time counter-
parts. In the transition to a digital and discrete time implementation the
phase lag introduced by delay and latency of the sampling, calculation and
communication process needs to be considered. Fortunately these computer
programs generally are capable of generating the equivalent frequency re-
sponse functions, which makes it easy to tune the controller by means of
loop-shaping. This is mostly OK when the sample frequency is very high
(>>‚âà10 times) in respect to the bandwidth of the controlled system. In some
cases, however, more insight in the impact of discretisation on the controller
is necessary for which this section gives an introduction.
4.5.1
Continuous Time versus Discrete Time
In the frequency-domain a position controller acts as a Ô¨Ålter, which attenu-
ates or ampliÔ¨Åes the system response and shapes the phase response of the
system in certain frequency areas. In principle these Ô¨Ålters, all representing
a diÔ¨Äerential equation or a transfer function with poles and zeros, can be
implemented in analogue electronics or as a digital Ô¨Ålter that runs on a
digital real-time hardware computing platform.
The implementation of a Ô¨Ålter in analogue electronics, basically operational
ampliÔ¨Åer circuits, allows the realisation of very high bandwidth frequen-
cies at low costs18. However, analogue electronic controllers have three
important disadvantages. Firstly, its properties can be less consistent over
time and also sensitive to changing environmental conditions such as tem-
perature. This can result in DC drift or oÔ¨Äset as well as changing Ô¨Ålter
parameters. Secondly, each Ô¨Ålter parameter has to be adjusted in hardware
by selecting discrete passive components, which cannot be adapted easily
during operation of the mechatronic system. Finally the noise of the Ô¨Ålter
18An in depth presentation of the operational ampliÔ¨Åer and several other electronics related
terms in this section can be found in Chapter 6.

4.5. Digital Signal Processing - The Z-Domain
321
ADC
|H(j)|

|H(j)|

DAC
Digital-
Processor
A
S
P(s)
An¬ã$ing
An$
Figure 4.48: Overview of a digital implementation of a feedback controller, empha-
sising the analogue-to-digital and digital-to-analogue converters with
their required analogue Ô¨Ålters.
and its propagation has to be considered in the design process.
As mentioned, modern control systems often are implemented digitally
because digital implementations have several advantages over the imple-
mentation of analogue Ô¨Ålters, such as absence of drift, easy reconÔ¨Åguration
‚Äúon the Ô¨Çy‚Äù, and the possibility of direct data logging for troubleshooting.
Digital control also allows easy tuning of the controller parameters, like the
PID gains and enables more complex algorithms such as adaptive control,
real-time optimisation, nonlinear control, and learning control methods to
mention just a few.
In Figure 4.1 two elements were introduced that are typical for a digital
control system, the analogue-to-digital converter (ADC) and the digital-
to-analogue converter (DAC), which together transfer the signals between
the analogue and the digital domain. With digital control, the feedback
and feedforward control actions are implemented on a processor, such as
a digital signal processor (DSP), a PowerPC or a Ô¨Åeld programmable gate
array (FPGA). As interfaces between the continuous real world and the
digital control world, both the DAC and the ADC are used with analogue
low-pass Ô¨Ålters as shown in Figure 4.48. The analogue sensor signals are
sampled in time with the sampling rate Ts, typically using a zero-order-hold
(ZOH) element, which keeps the sampled signal at a constant value between
each sampling moment, necessary for the process to assign a digital number
to the sample value. This quantisation is done with the resolution of the
ADC, which denotes a loss of information. ADCs are presented in more
detail in Section 8.4.3 of Chapter 8 and it is shown there that an analogue
anti-aliasing low-pass Ô¨Ålter is needed at the input of the ADC to limit the
frequency range at the input to less than half the sampling frequency, accord-
ing to the Nyquist-Shannon sampling theorem. If the sampling frequency is

322
Chapter 4. Motion Control
S0
S1
S2
S3
S4
S5
S6
S7
S8
S9
Vi
Vh
T
Hold
(%
¬ã
Figure 4.49: The anti-imaging Ô¨Ålter used with a DAC reduces the sharp transitions
at each sampling moment. The low-pass characteristic of this Ô¨Ålter
causes an additional phase shift relative to the ideal signal.
just twice the highest frequency, the signal has to be recorded for an inÔ¨Ånite
long time, in order to correctly reconstruct it. So for a practical digital
control system this theoretical limit is not very useful and also the realised
controller would be quite sensitive to small parameter uncertainties, as
they can occur due to quantisation eÔ¨Äects at the implementation of digital
Ô¨Ålters. To avoid aliasing it is suÔ¨Écient to choose the sampling rate to about
5 to 10 times the control bandwidth (=unity-gain cross-over frequency) of
the feedback or feedforward controlled system. For the phase margin it
is often necessary to go even higher as the theoretical minimum latency
by sampling is equal to half the sampling period. For 10 times the control
bandwidth this means 18¬∞less phase margin at the unity-gain cross-over
frequency. Additional Ô¨Ålters decrease the phase margin even further so for
good controllability a higher factor is often necessary.
A DAC needs a Ô¨Ålter at its analogue output, because the digital data are
provided at Ô¨Åxed intervals after which they are kept constant between each
sampling moment by means of a zero-order hold element. The sharp edges
of the resulting stepwise changing analogue signal would cause problems
in the ampliÔ¨Åer and actuator for which reason a low-pass Ô¨Ålter is used to
‚Äúsmoothen‚Äù these edges and Ô¨Ålter out the ‚Äúimage‚Äù of the sampling DAC, the
reconstruction- or anti-imaging Ô¨Ålter. This Ô¨Ålter causes an additional phase-
lag, which should be taken into account in the control stability analysis.
With a special Ô¨Ålter type, called an acausal Ô¨Ålter, which bases its output on
future inputs, this phase-lag can be reduced as long as these future inputs
are predictable. This could for instance be the case with a feedforward
controller for following a pre-determined trajectory. A nice example of the
implementation of feedforward signal prediction to create an acausal Ô¨Ålter
in a discrete-time controller is given by Hans Butler from ASML [18]. It
presents the situation where disturbance forces are measured by a separate

4.5. Digital Signal Processing - The Z-Domain
323
sensor, which are used as a feedforward signal to the position controller.
Normally a discrete-time controller will introduce some delay before the
signal of the separate sensor has reached the actuator but the publication
describes three methods to estimate the signal two samples ahead. The
Ô¨Årst two methods, polynomial extrapolation of past data and sinusoidal
extrapolation on a set of chosen frequencies can both be implemented as FIR
Ô¨Ålters. The third method utilises frequency sampling Ô¨Ålters with digital
zeros, which are not each other‚Äôs conjugates.
The selection of the resolution of ADCs and DACs determines the resolution
and achievable precision of the controlled motion system, while the choice
of the sampling time determines the maximum frequency that the Ô¨Ålter can
correctly handle.
4.5.2
Sampling of Continuous Signals
Sampling generates discrete-time signals, which are represented by x[n] =
x(nTs), where Ts denotes the sampling period, fs = 1/Ts is the corresponding
sampling frequency and n is a running index. After the analogue-to-digital
conversion, the sampled signals x(t) are present as numbers at deÔ¨Åned time
intervals Ts, denoting Dirac-impulses Œ¥(t ‚àínTs) with a height that corre-
sponds to the signal value at equidistant points in time (see Figure 4.50):
Œ¥s(t) =
+‚àû

n=‚àí‚àû
Œ¥(t‚àínTs).
(4.54)
For this reason it is also very important that the timing of the ADC is
precise, as an uncertainty in the sampling, also known as jitter, can have
quite disadvantageous eÔ¨Äects on the realised controlled motion system, but
this is typically not a severe problem in digital control nowadays. Assuming
Ts
t
¬å
2Ts
3Ts
.......
Figure 4.50: Sampling of a continuous signal in the time-domain.

324
Chapter 4. Motion Control
that the timing is perfect, the discrete signals are processed further at these
time intervals.
4.5.3
Digital Number Representation
Computers work with binary logic. The elementary digits of a binary number
are called bits, with only two values, zero and one. A binary number consists
of a summation of the value of n bits, with n being an integer > 0. In the
mathematical sense, the value of bit k, where 0 ‚â§k < n, is equal to 2k. The
bit with k = 0 is called the Least SigniÔ¨Åcant Bit (LSB) and the bit with
k = n‚àí1 represents the Most SigniÔ¨Åcant Bit (MSB). For the implementation
of digital algorithms on digital computing platforms two representation
forms of digital numbers exist, Ô¨Çoating point or Ô¨Åxed point.
4.5.3.1
Fixed Point Arithmetic
Fixed point arithmetic has been favored in the past, because of the less com-
plex DSP processor structure with reduced cost and lower computational
eÔ¨Äort, suitable for small, low power embedded systems. A main drawback is,
that the code developer must pay attention to truncation, overÔ¨Çow, under-
Ô¨Çow and round-oÔ¨Äerrors that occur during mathematical operations. When
implementing algorithms in Ô¨Åxed point arithmetic, the achievable accuracy
must always be taken into account. If needed, software subroutines can be
used to emulate Ô¨Çoating point calculations in a Ô¨Åxed point processor, but this
reduces the speed of the system compared to a Ô¨Åxed point implementation.
Fixed point numbers are equally spaced over the whole range, separated by
the gap which is denoted by the least signiÔ¨Åcant bit. The two‚Äôs complement
is the most used format for representing positive and negative numbers. For
representing a Ô¨Åxed point fractional number in two‚Äôs complement notation,
the so called Qm.n19 format is often used, see the upper example in Fig-
ure 4.51. m denotes the number of integer bits and n denotes the number
of fractional bits. m + n +1 = N bits are necessary to store a signed Qm.n
number. The decimal range is given by ‚àí2m ‚â§x ‚â§2m ‚àí2‚àín. If the binary
representation is given, the decimal value can be calculated to:
x = 1
2n
,
‚àí2N‚àí1bN‚àí1 +
N‚àí2

i=0
2ibi
-
,
(4.55)
where b indicates the bit position, starting with b0 from the right in Fig-
ure 4.51.
19The introduced deÔ¨Ånition is inspired by Texas Instruments.

4.5. Digital Signal Processing - The Z-Domain
325
31 30 29 28 27 26 25 24 23 22 21 20 19 18 17 16 15 14 13 12 11 10
9
8
7
6
5
4
3
2
1
0
MSB
LSB
MSB
LSB
Exponent (E)
(8bits)

|
¬á
(23bits)
Sign
(1bit)
0 1 1 0 1 0 1 1
Sign 
Integer bits
^
MSB
LSB
Fixed point
^$
Figure 4.51: Example of a Qm.n Ô¨Åxed point number representation and a single
precision Ô¨Çoating point number [82].
4.5.3.2
Floating Point Arithmetic
Floating point arithmetic has a higher dynamic range than Ô¨Åxed point arith-
metic, given by the largest and smallest number that can be represented,
having a higher precision due to the smaller gaps between adjacent numbers,
less quantisation noise, and it is easier to handle in terms of programming.
A Ô¨Çoating point number is represented by a multiplication of a mantissa M
with a base b to the power of the exponent q:
x = ‚àí1iMbq.
(4.56)
The ‚àí1i prefactor, with i being an integer 0 or 1, deÔ¨Ånes a positive or negative
number. Due to this notation, very small and very large numbers can be
represented with a small gap between adjacent numbers. The gap increases
with the value of the number, starting with very small gaps between small
values. A common used standard for representing Ô¨Çoating point numbers
is ANSI/IEEE Std. 754-1985. This standard deÔ¨Ånes basic formats, single-
precision (32 bit wide format) and double precision (64 bit wide format).
In the following, the single precision format with a base of 2 is chosen as an
example. The decimal value can be calculated by:
x = ‚àí1iM2E‚àí127.
(4.57)
The term E in the exponent is stored as a value with an oÔ¨Äset by adding
127 in order to get only positive numbers, ranging from 0 ‚â§E < 256 with 8
bits20. The decimal value is normalised, meaning that only one nonzero
digit is noted at the left of the decimal point. The storage register is divided
into three groups, as shown in Figure 4.51. 1 bit represents the sign, the
exponent term E is represented by 8 bits and the mantissa is stored in 23
bits.
20The other method using a 2th complement notation for negative numbers would reduce
the computation speed.

326
Chapter 4. Motion Control
4.5.4
Digital Filter Theory
Digital Ô¨Ålter theory is an extended Ô¨Åeld of engineering with dedicated math-
ematics. Its functionality is based on the addition of the values of samples,
taken at diÔ¨Äerent earlier sampling periods from the input signal each with
a certain magnitude ratio. Also the output sample values of the Ô¨Ålter can
be included, which creates a sampled feedback loop. As a simple example to
imagine the Ô¨Ålter eÔ¨Äect one can think of a Ô¨Ålter that outputs at each sampling
moment the summed values of the last 10 input samples at equal magnitude
of 1. For a frequency signiÔ¨Åcantly lower than the sampling frequency, these
samples will all have approximately the same value, which means that the
output value of the Ô¨Ålter will equal approximately 10√ó the value of each
sample. At a frequency higher than 0.2√ó the sampling frequency, however,
the 10 samples will have an average value equal to approximately zero and
the result of the addition at the output of the Ô¨Ålter will also be approximately
zero. From this reasoning one can conclude that such a system acts like a
low-pass Ô¨Ålter.
It will be shown that a comparable transform method like the Laplace-
transform for continuous-time systems is available for discrete-time-domain
analysis, the Z-transform. With the Z-transform the behaviour of a digital
Ô¨Ålter can be described in the frequency-domain and it also allows stability
analysis in a feedback control system. By means of diÔ¨Äerence equations,
instead of diÔ¨Äerential equations, basic Ô¨Ålter structures will be explained
in the following sections. Two generally applied digital Ô¨Ålter implementa-
tions are presented, the Finite Impulse Response (FIR) and InÔ¨Ånite Impulse
Response (IIR) Ô¨Ålters.
4.5.4.1
Z-Transform and DiÔ¨Äerence Equations
Network structures, comprised of basic elements such as adders, multipliers,
time-delays and loops are commonly used to describe and realise digital
Ô¨Ålters. They can be speciÔ¨Åed in the form of diÔ¨Äerence equations with the
input x[n] and the output y[n] of the system:
y[n]+
N

k=1
ak y[n‚àík] =
M

k=0
bkx[n‚àík],
(4.58)
where M equals the number of previous consecutive input samples and N
equals the number of output samples taken under consideration. For a
given input signal, the output can be calculated by successive solving the
diÔ¨Äerence equations, starting with a point in time n0 and known initial

4.5. Digital Signal Processing - The Z-Domain
327






z

]
$¬°
c¬ç
Figure 4.52: The Z-transform is the discrete counterpart of the Laplace-transform
for the continuous-time-domain.
values. Similar to the approach of applying the Laplace-transform on a
set of diÔ¨Äerential equations to convert them to algebraic equations, the
Z-transform is used for discrete-time systems, simplifying the calculation
of a set of diÔ¨Äerence equations (Figure 4.52). The Z-transform is based
on the deÔ¨Ånition of the Fourier-transform for time discrete signals. The
Fourier-transform is written as:
X

e jŒ∏
= F {x[n]} =
‚àû

n=‚àí‚àû
x[n]e‚àíjŒ∏n,
(4.59)
where Œ∏ denotes the discrete frequency, which corresponds to the continuous
time-domain by Œ∏ = œâTs with the sampling frequency Ts. The existence of
the Fourier-Transform is given by the absolute summability of x[n] and this
signiÔ¨Åcantly limits the area of application. To relax this requirement, the
Z-transform is introduced with the complex variable z = re jŒ∏ = r(cosŒ∏ + jsinŒ∏)
and r ‚â•0 as the magnitude of z:
X

e jŒ∏
= Z {x[n]} =
‚àû

n=‚àí‚àû
x[n]z‚àín.
(4.60)
By using the bilateral Z-transform negative and positive time shifts N0 of a
discrete-time signal x[n] can be expressed as:
x[n‚àíN0] ‚áê‚áíz‚àíN0 X(z).
(4.61)
By inserting Equation (4.61) into Equation (4.58) and suppressing initial
values (y[‚àí1] = 0 etc.), the z-transfer function H(z) of Equation (4.58) can be
written to:
Y (z)
,
1+
N

k=1
akz‚àík
-
= X(z)
M

k=0
bkz‚àík ‚áíH(z) = Y (z)
X(z) =
8M
k=0 bkz‚àík
1+8N
k=1 akz‚àík . (4.62)
The zeros and poles of H(z) are given by the numerator and denominator

328
Chapter 4. Motion Control
s-plane
z-plane
Re(s)
Im(s)
Re(z)
Im(z)
j /Ts
sTs
z = e
-j /Ts
Figure 4.53: Corresponding points and areas in s- and z-plane.
respectively, their location can be plotted in the complex z-plane. Similar to
continuous-time-domain transfer functions the location of the poles of the
discrete-time system is crucial for stability analysis. Stability of a discrete-
time system is best shown by comparing with a continuous-time system and
using the relation z = esTs. A stable continuous-time system has its poles
located in the left half of the s-plane, as shown at the left side of Figure 4.53.
When converting the s-plane into the z-plane, the imaginary axes of the
s-plane transform into a unit circle in the z-plane, as shown in at the right
side of Figure 4.53. The left half of the s-plane is projected into the inside of
the unit circle in the z-plane while the right half of the s-plane corresponds
to the outside of the unit circle. As a result, a stable discrete-time system
has its poles located inside of the unit circle. Figure 4.54 shows various
impulse responses that can be assigned to diÔ¨Äerent points in the z-plane.
The discrete frequency Œ∏ is changed along circular paths while the amplitude
of the signal is attenuated inside and growing outside of the unit circle.
Along the positive real axes (‚Ñú{z}>0 and ‚Ñë{z} = 0), pure exponentials can be
observed, in the negative ‚Ñú{z} direction, exponentially enveloped sinusoids
with the frequency fs/2 appear.
4.5.5
Finite Impulse Response (FIR) Filter
The causal FIR Ô¨Ålter has an impulse response of Ô¨Ånite length, because it
only combines a limited number of previous samples, and it can be described
as diÔ¨Äerence equation and z transfer function:
y[n] =
M

k=0
bkx[n‚àík]
Z
‚àí‚Üí
H(z) =
M

n=0
bkz‚àín,
(4.63)

4.5. Digital Signal Processing - The Z-Domain
329
Real Axis
Imaginary Axis
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
1.2
fnyquist
= Ts
=0
=
=  /4

=  /2

=3 /4

Figure 4.54: Pole map with related time-domain impulse responses, clearly indi-
cating the discretised values of the sampled output signal.
where M equals the number of previous consecutive input samples taken
under consideration.
Assuming a causal system, where the output is strictly determined by inputs
from the past, all poles of Equation (4.63) are localised in the centre of the z-
plane. Thus, FIR Ô¨Ålters are stable for all possible coeÔ¨Écients bk. Figure 4.55
represents the structure of a FIR Ô¨Ålter realisation, called transversal Ô¨Ålter
structure and it directly relates to the simple example at the beginning of
section 4.5.4. This structure only contains feedforward paths that guarantee
stability. The frequency response of the Ô¨Ålter is speciÔ¨Åed by the chosen Ô¨Ålter
polynomial, which is typically large compared to a Ô¨Ålter realisation with
rational functions (as incorporated in IIR Ô¨Ålters, see next section) and makes
high computational eÔ¨Äort necessary.
FIR Ô¨Ålters are often used when an exact linear phase response, denoting
a constant time delay for all frequency components, of the Ô¨Ålter is desired.
FIR Ô¨Ålters with linear phase design result in Ô¨Ålter implementations with
symmetric or antisymmetric Ô¨Ålter coeÔ¨Écients. For example, for an even
Ô¨Ålter order M and symmetric coeÔ¨Écients (h[n] = h[M ‚àín]), the transversal
Ô¨Ålter structure from Figure 4.56 can be taken, resulting in:
H(z) = b0

1+ z‚àíM
+ b1

z‚àí1 + z‚àíM+1
+¬∑¬∑¬∑+ bM/2z‚àíM/2.
(4.64)

330
Chapter 4. Motion Control
+
+
+
0
1
2
y
Figure 4.55: Transversal Ô¨Ålter structure of a FIR Ô¨Ålter. The z‚àí1-terms each rep-
resent a sampling period which means that b0 is the gain of the last
sample, b1 is the gain of the previous sample etcetera. At each sam-
pling moment all samples shift to the right.
This optimised Ô¨Ålter structure is advantageous in terms of memory storage
for Ô¨Ålter coeÔ¨Écients. When implementing digital Ô¨Ålter structures, one may
be confronted with coeÔ¨Écient quantisation due to the Ô¨Åxed bit length of
hardware registers. Therefore, coeÔ¨Écients must be truncated or rounded.
Especially higher-order Ô¨Ålter structures are very sensitive to deviations in
their Ô¨Ålter coeÔ¨Écients.
Filter quantisation has the following impact:
‚Ä¢ Quantisation causes a deviation in the frequency response of the Ô¨Ålter.
For FIR Ô¨Ålters the quantisation only strikes the location of the zeros.
A general rule is, the smaller the spacing between zeros, the higher is
the deviation in the frequency response.
‚Ä¢ After mathematical operations, partial results can exceed the bit-width
of the register where they are stored, leading to overÔ¨Çow. If the num-
ber of negative and positive overÔ¨Çows is equal, the Ô¨Ånal result is not
inÔ¨Çuenced. A better method is to scale numbers before mathematical
operation are applied or to apply saturation on partial results.
‚Ä¢ The stop band attenuation and hence the SNR of the Ô¨Ålter becomes
lower. The resulting attenuation rate must be compared to the desired
Ô¨Ålter speciÔ¨Åcation.

4.5. Digital Signal Processing - The Z-Domain
331
0
+
+
+
+
1
+
+
/2
y
/2-1
M
M
Figure 4.56: Optimised FIR Ô¨Ålter structure with symmetric Ô¨Ålter coeÔ¨Écients.
Linear phase Ô¨Ålters retain their phase characteristic after Ô¨Ålter quantisation
due to their symmetry in Ô¨Ålter coeÔ¨Écients. To lessen the sensitivity on
Ô¨Ålter coeÔ¨Écient quantisation, higher-order Ô¨Ålters are broken down into
smaller Second-Order-Structures (SOS), which are connected in series, see
Figure 4.57. The resulting transfer function is then:
H(z) = b0
N
9
i=0

1+ bi1z‚àí1 + bi2z‚àí2
.
(4.65)
4.5.6
InÔ¨Ånite Impulse Response (IIR) Filter
Compared to the FIR Ô¨Ålters, the length of the impulse response of IIR Ô¨Ålters
is inÔ¨Ånite, because it also includes samples from the output, thereby creating
sampled feedback. It is described by:
y[n] =
M

k=0
bkx[n‚àík]‚àí
N

k=1
ak y[n‚àík].
(4.66)
11
y
+
+
+
+
+
+
12
21
22
n1
n2
Figure 4.57: Higher-order FIR Ô¨Ålter realisation with cascaded SOS Ô¨Ålter structures.

332
Chapter 4. Motion Control
+
+
+
+
+
+
1
2
2
1
0
y
+
+
+
+
0
1
2
1
2
y
+
(a:)
(b:)
M
M
N
N
Figure 4.58: (a:) IIR structure in DF-1 realisation and (b:) IIR structure in DF-2
realisation.
where M equals the number of previous consecutive input samples and N
equals the number of output samples taken under consideration.
The corresponding Z-transform is given in Equation (4.62). A feedforward
path, speciÔ¨Åed by x[n‚àík], and a feedback path, speciÔ¨Åed by y[n‚àík], can be
identiÔ¨Åed. Two possible realisations of the diÔ¨Äerence equation are given in
Figure 4.58, namely Direct-Form 1 (DF-1) and Direct-Form 2 (DF-2). The
DF-2 IIR realisation swaps the feedforward and feedback path compared
to DF-1, so that only half the amount of registers are necessary for imple-
mentation. Compared to FIR Ô¨Ålters, IIR Ô¨Ålters can better approximate the
frequency behaviour of an analogue Ô¨Ålter. However, the recursive (feedback)
structure can lead to instability and makes the Ô¨Ålter quite sensitive to co-
eÔ¨Écient quantisation. Also in this case, SOS structures are popular when
implementing higher-order structures in hardware. An example in DF-2
realisation is given in Figure 4.59. Several SOS structures can be connected
+
+
+
+
1
2
0
1
2
y
Figure 4.59: IIR SOS structure in DF-2 realisation

4.5. Digital Signal Processing - The Z-Domain
333
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
-160
-140
-120
-100
-80
-60
-40
-20
0
Normalised Frequency [    rad/sample]
Magnitude [dB]
^$6|\^,&¬ç¬á
^¬ï6|\^,&¬ç¬á
^¬ï|##&¬ç¬á

Figure 4.60: Example of an 6-order analogue Butterworth Ô¨Ålter that is translated
into its digital equivalent, showing diÔ¨Äerent hardware implementa-
tions.
in series, H(z) = gs
:n
i=1 Bi(z), or in parallel, H(z) = gp +8n
i=1 Bi(z), where Bi
is represented by:
Bi(z) = b0 + b1z‚àí1 + b2z‚àí2
1+ a1z‚àí1 + a2z‚àí2 .
(4.67)
This Ô¨Ålter structure is called a biquad, because of the quadratic order of z in
both numerator and denominator. Stability of the total higher-order Ô¨Ålter
can be proven by investigating the stability of each single SOS biquad-Ô¨Ålter
that it comprises. A commonly used method to extract SOS structures from
the total Ô¨Ålter is to combine of zeros and poles that are close to each other in
order to compensate the signal gain of the poles by close-by zeros. Contrary
to serial biquads, which are the most common applied, parallel biquads are
more sensitive to coeÔ¨Écient quantisation, because each biquad has to have
zero gain when the magnitude of the total Ô¨Ålter transfer function has to be
zero.
CoeÔ¨Écient quantisation plays an important role in the IIR Ô¨Ålter. Poles
of an IIR Ô¨Ålter in a Ô¨Çoating point implementation, which are localised
inside the unit circle may migrate outside of the unit circle, when their
coeÔ¨Écients are converted into a Ô¨Åxed point number. Also when looking at
the frequency response, signiÔ¨Åcant diÔ¨Äerences between a Ô¨Çoating point and
a Ô¨Åxed point implementation can be recognised. Figure 4.60 shows that a
Ô¨Åxed point implementation with SOS modules overlaps with a Ô¨Çoating point
implementation, while the Ô¨Åxed point implementation diÔ¨Äers in the higher
frequency range.

334
Chapter 4. Motion Control
4.5.7
Converting Continuous to Discrete-Time Filters
One approach commonly used for designing a digital Ô¨Ålter H(z) is to design
a continuous-time Ô¨Ålter H(s) and to transform it into its discrete-time repre-
sentation for implementing it on a digital real-time hardware platform. For
that purpose a bilinear transformation, the so called Tustin‚Äôs method can
be used, which maps the entire imaginary axis onto the unit circle of the
z-plane 21:
s = 2
Ts
z ‚àí1
z +1.
(4.68)
Inserting s = jœâ and z = e jŒ∏ into Equation (4.68) yields the relation between
the analogue frequency œâ and the discrete frequency Œ∏:
œâ = 2
TS
tan

Œ∏
2

.
(4.69)
The discrete Ô¨Ålter can now be derived by:
H(z) = H(s)|s= 2
Ts
z‚àí1
z+1 = H

 2
Ts
z ‚àí1
z +1

.
(4.70)
From Equation (4.69) can be seen, that Œ∏ increases from 0 to œÄ as œâ increases
from 0 to +‚àû, which causes deviations in the Ô¨Ålter response between the
continuous Ô¨Ålter H(s) and the discrete Ô¨Ålter H(z) at higher frequencies. This
is known as the warping problem, which can be counteracted by pre-warping
the critical frequencies of H(s).
The pre-warping can be used such that the digital Ô¨Ålter H(z) matches H(s)
in amplitude and phase at a predeÔ¨Åned frequency œâ0, by substituting the
following transformation in the transfer function of the continuous Ô¨Ålter:
s =
œâ0
tan(œâ0Ts/2)
z ‚àí1
z +1,
(4.71)
which is a modiÔ¨Åcation of Tustin‚Äôs method to obtain H(z). For choosing œâ0
as a very low frequency, this transformation becomes the standard Tustin‚Äôs
method of Equation 4.68, which means that the standard transformation
matches the Ô¨Ålter response at DC.
For discretisation of a feedback controller the cross-over frequency may be a
potential choice for the prewarping frequency œâ0. For the implementation
of a Ô¨Ålter for feedforward control that frequency may correspond to a sys-
tem eigenfrequency or the tracking bandwidth, to ensure that the system
frequency response is mapped correctly in that frequency region.
21In contrast, the standard z-Transformation z = esTs maps the whole imaginary axis to a
2œÄ periodic circular axis.

4.6. State-Space Feedback Control
335
4.6
State-Space Feedback Control
Generally a rigid body needs to be positioned in six physical degrees of free-
dom(DOF), necessitating six actuators and six sensors. In control system
terms such a positioning system is called a Multiple Input Multiple Output
system (MIMO) and complications can occur due to the mutual interference
or cross-coupling between each physical DOF. When a sensor is aligned with
an actuator in each of the six unique DOF directions and the static coupling
between the directions is low, the system is reduced to a combination of six
independent SISO subsystems. Even when the sensors and actuators are
not aligned, a SISO approach can often be achieved by means of decoupling
matrices under the condition of a suÔ¨Éciently deterministic behaviour. An
example of this principle will be presented in Chapter 9 with the control of a
wafer stage. In situations, when there are strong (non-linear) cross-coupling
terms between the several inputs and outputs, which can not be compen-
sated in a straightforward deterministic way, this approach is not suÔ¨Écient
especially when higher frequency eigenmodes also create cross-coupling
terms.
The state-space representation is used in control practice as a method to
implement discrete-time controllers. The method is highly eÔ¨Écient because
it breaks down an nth-order diÔ¨Äerential equation into n Ô¨Årst-order diÔ¨Äeren-
tial equations, which are written in a matrix notation. With the state-space
model, every successive control action can be calculated by straightforward
vector-matrix operations.
The state-space model has three diÔ¨Äerent variables, the inputs u, the out-
puts y and the state-variables x, which describe the momentary state of
the system. Generally these variables are written as vectors because they
contain a number of elements. The state-variable vector deÔ¨Ånes a space
of which the axes are the state-variable elements in the vector. This has
given the name state-space to this modelling method. The total number of
state-variables, mostly just called ‚Äústates‚Äù, is equal to the number of orders
of the diÔ¨Äerential equation describing the system.
The standard state-space notation is given by the following two equations:
Àôx=Ax+ Bu
(4.72)
y=Cx+ Du.
(4.73)
These equations show how the state-variable x of a dynamic system and the
system output y evolve over time as a function of the matrices A,B,C,D, the
input u and the initial conditions x0 of the state vector x. The matrices are

336
Chapter 4. Motion Control
B
C
A
x
x
y
u
D
dt

Figure 4.61: Graphical representation of a standard multi dimensional state-space
system. The feedback section with matrix A represents the eigendy-
namics of the system. The input section of the system consists for
instance of the actuators with gain matrix B and the output section
of the system consists for instance of the sensors with gain matrix C.
The section with matrix D represents the direct feed-through of the
input to the output and is for instance caused by the cross-coupling
from the actuator current to the sensor signal.
the eigendynamics matrix A, the input matrix B, the output or measurement
matrix C and a feed-through transfer gain matrix D.
Figure 4.61 shows the structure of this standard state-space model in a
graphical way. Like described at the Ô¨Ågure, the diÔ¨Äerent elements of these
matrices all represent a certain physical property or function.
4.6.1
State-Space in Relation to Motion Control
State-space motion control uses a state-space model of the full mathematical
description of the plant, including actuators and sensors. The controller ac-
tions are applied to the input(s) of the state-space model, while the output(s)
of the state-space are fed back to the input of the controller. To illustrate
what this means, a few examples will be shown, which were introduced
before.
Chapter 3 presented a damped mass-spring system as a second-order system
and when combined with one or more spring-coupled bodies, it became a
higher-order system adding two orders for each coupled mass-spring system.
In general the order n of a dynamic system is equal to the number of energy
containers in the system, like a spring (E = 0.5kx2), a body (E = 0.5m Àôx2), a
capacitor (E = 0.5CV 2) and an inductor (E = 0.5LI2). A damper and a resistor
do not store energy, they only dissipate it into heat. When the state-space
model is used for controlling the plant, the order of the diÔ¨Äerential equa-

4.6. State-Space Feedback Control
337
tions describing the plant does not only include the mechanics but also the
dynamics of the applied sensors, ampliÔ¨Åers and actuators. A Ô¨Årst-order
Ô¨Ålter at the sensor introduces an additional state and the dynamics of the
actuator also create corresponding states.
First the diÔ¨Äerent matrices will be examined from the viewpoint of motion
control:
‚Ä¢ The eigendynamics matrix A includes the parameters that describe
the dynamics of the uncontrolled system, including the dynamics of the
power ampliÔ¨Åer, the actuator, the mechanical system and the sensor.
Its dimension is square (n√ó n).
‚Ä¢ The input matrix B contains the simple gains or scaling factors of the
actuator or power ampliÔ¨Åer, but not their dynamics as these have to
be included in matrix A, as stated above. The number of columns of
the input matrix is equal to the number of inputs (i) and the number
of rows equals the number of states n.
‚Ä¢ The output matrix C contains the simple gains or scaling factors of
the measurement system, but also without the dynamic part as that
also has to be included in matrix A, as stated above. The number of
columns of the output matrix is equal to the number of states (n) and
the number of rows equals the number of outputs o.
‚Ä¢ The feed-through matrix D is often not present in a mechatronic sys-
tem, but can for instance be caused by actuator-sensor cross-talk, like
when using electromagnetic actuators and an Eddy-current sensor. Its
dimension depends on the number of inputs and outputs with i columns
and o rows.
These matrices and the states in the state-space model are illustrated with
two examples, a damped mass-spring system, with and without a classical
PID-controller.

338
Chapter 4. Motion Control
4.6.1.1
Mechanical Dynamic System in State-Space
State-Space control of mechatronic systems requires the representation
of the states of a mechanical dynamic system. First a simple single-DOF
damped mass-spring system with position x of the body is described in
state-space, followed by the derivation of the state-space model of a multi-
dimensional mechanical system with vibrating eigenmodes.
Single-DOF Dynamic System
The state x and its derivative Àôx of a simple single-DOF damped mass-spring
system with position x of the body are equal to:
x =

x1
x2
	
=

x
Àôx
	
Àôx =

Àôx1
Àôx2
	
=

Àôx
¬®x
	
.
(4.74)
With this example the input u would be the force with a scalar value u = F.
The output y is equal to the position x, so it is also a scalar. The input matrix
B in this case is the conversion from force to acceleration with a mass factor,
the eigendynamics matrix A contains the damper and spring, both scaled
by the mass, and the feedthrough matrix D equals zero. This is shown in
the following transformation of the equations of motion of a single-body
mass-spring system, which was used in Chapter 3 to derive the frequency
response of the system.
F = m ¬®x+ c Àôx+ kx
=‚áí
¬®x = ‚àík
m x‚àíc
m Àôx+ F
m.
(4.75)
u
F

1x
x

2x
x
 
2x
x



1
c
m
	
k
m
	
1
m
y
x

dt

dt

A
B
C
Figure 4.62: Graphical representation of the scalar, single input and output (SISO),
state-space representation of a mass-spring system with damping.
The loops of the damper (velocity) and the spring (position) are shown
separately.

4.6. State-Space Feedback Control
339
This equation of motion is equal for the acceleration when expanding the
following state-space matrix notion :
Àôx = Ax+ Bu
=‚áí

Àôx
¬®x
	
=
‚é°
‚é£
0
1
‚àík
m
‚àíc
m
‚é§
‚é¶

x
Àôx
	
+
‚é°
‚é£
0
1
m
‚é§
‚é¶F
y = Cx+ Du = [1 0]

x
Àôx
	
+[ 0 ]u = x.
(4.76)
By expanding the state space equations the equations of motion of even
more elaborate systems can be obtained and the transfer function can be
derived by applying the Laplace-transform.
The state-space representation of this mass-spring system is shown in a
graphical way in Figure 4.62 where x1 = x is the position, x2 = Àôx is the velocity
and Àôx2 = ¬®x is the acceleration of the system. The feedback loops with the
stiÔ¨Äness and damping terms will show to be very illustrative when the
combination of a mass-spring system with feedback control is introduced in
the next section.
Another important aspect of the state-space model is the fact that the poles
of the transfer function are equal to the eigenvalues of the A matrix. These
eigenvalues are those values of Œª at which the determinant det(ŒªI ‚àíA)
equals zero, with I being the unity matrix with the same dimension as A.
In this case the general accepted term Œª for the eigenvalue can be replaced
by the Laplace operator s because the solutions (the poles) belong to the
Laplace-domain.
det
‚éõ
‚éù

s
0
0
s
	
‚àí
‚é°
‚é£
0
1
‚àík
m
‚àíc
m
‚é§
‚é¶
‚éû
‚é†=
''''''
s
‚àí1
k
m
c
m + s
''''''
= 0
(4.77)
When expanded, this gives the following characteristic polynomial in s:
s
 c
m + s

+ k
m = s2 + cs
m + k
m = 0
‚áí
ms2 + cs+ k = 0.
(4.78)
The poles are equal to the eigenvalue solutions of s of this polynomial:
p1,2 = ‚àíœÉ¬± jœâd = ‚àíc
2m ¬± j

k
m ‚àíc2
4m2 .
(4.79)
With œâ0 =
4
k/m these values of the poles become equal to the values that
were found in Section 3.2.3.2 where the critical damping of a mass-spring
system was derived:
p1,2 = ‚àíœÉ¬± jœâd = ‚àí
c
5
k
m
2

km
¬± j

k
m

1‚àí
c2
4km = ‚àícœâ0
2

km
¬± jœâ0

1‚àí
c2
4km. (4.80)

340
Chapter 4. Motion Control
This means that by changing the terms in the A matrix, the eigenvalues
can be adapted such that the poles become located at a diÔ¨Äerent position
in the Laplace-plane. This is exactly what happens with feedback control
and the state-space model oÔ¨Äers a very straightforward method to achieve
an optimal pole location, as will be shown with the introduction of state
feedback in Section 4.6.2.
Multi-DOF Modal Representation in State Space
In many cases, time-domain simulations of a manipulator, including its
servo controller, cannot be done with the modelling tools used for the anal-
ysis of the mechanical system. As a result, the dynamic properties of the
mechanical system need to be transferred to some other modelling tool,
which is capable of adding the control system. Generally, this transfer is
based on the modes and modal parameters of the mechanical system. As-
suming that no (animated) visualisation of the entire system is required,
only the mode-shape data of the following physical DOF are relevant:
‚Ä¢ Actuation DOF, where forces (driving forces, disturbing forces) are
applied or motion (Ô¨Çoor vibration) is prescribed.
‚Ä¢ Point of Interest DOF, which describes the real position at the point
of interest and which are often only measured indirectly.
‚Ä¢ Sensor DOF, which are used in the feedback loop (servo position) or
which are controlled (distance between tool and payload) or which need
to be monitored (e.g. frame motion).
Assuming that the number of relevant DOF is equal to r, and the number of
transferred modes is equal to m, the dynamic properties can be characterised
by m sets of modal parameters Mi, Ki and mode-shape vectors œÜi of length
r. Damping can be added in the form of modal damping with Œ∂i as the
modal damping ratio (typical values are in the order of 1 %). To derive the
modal state representation, Equations (3.112) and (3.114) on Page 183 of
the previous chapter must be adapted to the state-space notation, which is
done as follows. Considering the modal DOF qi and modal velocity Àôqi as
the states of the system, the modal state representation can be derived in
which forces u = Fi can be applied at all included physical DOF xi, and the
response of all physical DOF xi can be monitored. For the A and B matrix

4.6. State-Space Feedback Control
341
the following relations are obtained:
Àôx = Ax+ Bu
=‚áí
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
Àôq1
...
Àôqm
...
¬®q1
...
¬®qm
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
=
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
0
...
1
...
...
...
0
...
1
...
...
...
...
...
...
...
‚àíœâ2
0,1
...‚àí2Œ∂1œâ0,1
...
...
...
‚àíœâ2
0,m
...
‚àí2Œ∂mœâ0,m
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
q1
...
qm
...
Àôq1
...
Àôqm
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
+
+
‚é°
‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é¢‚é£
0
...
0
...
...
...
M ‚àí1
1 œÜ1,1
...
M ‚àí1
1 œÜ1,r
...
M ‚àí1
m œÜ1,1
...
M ‚àí1
m œÜm,r
‚é§
‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
F1
...
Fr
‚é§
‚é•‚é•‚é¶,
(4.81)
and for the C matrix (D = 0) :
y = Cx+ Du
=‚áí
‚é°
‚é¢‚é¢‚é£
x1
...
xr
‚é§
‚é•‚é•‚é¶=
‚é°
‚é¢‚é¢‚é£
œÜ1,1
...
œÜm,1
...
œÜ1,r
...
œÜm,r
‚é§
‚é•‚é•‚é¶
‚é°
‚é¢‚é¢‚é£
q1
...
qm
‚é§
‚é•‚é•‚é¶+0
‚é°
‚é¢‚é¢‚é£
F1
...
Fr
‚é§
‚é•‚é•‚é¶.
(4.82)
These relations make clear that the A matrix contains the eigenfrequencies
squared and damping ratio which is fully comparable with Equation (4.77)
after exchanging Œ∂i by Œ∂i =
ci
2Miœâ0,i . The B matrix contains the modal mass
terms in the direction of DOF xi, while the C matrix equals the matrix
of eigenvectors to derive the motion in DOF xi from the modal degrees of
freedom.

342
Chapter 4. Motion Control
4.6.1.2
PID-Control Feedback in State-Space
To demonstrate the state-space approach with active feedback, the imple-
mentation in a PID-control setting is presented for a second-order mass-
spring system.
A graphical state-space representation of the second-order mass-spring
system under PID-feedback control is shown in Figure 4.63.
With this representation it is possible to trace the diÔ¨Äerent feedback loops,
which work on the system separately. The two internal loops of the uncon-
trolled mass-spring system determine its dynamics with the spring and
damper action. The three feedback control loops are added to these two
internal feedback loops.
The blue dash-dotted P-control feedback loop over kp runs parallel with
2x
x



kp
kd
r
	
u
F

1x
x

2x
x
 
1
c
m
	
k
m
	
1
m
y
x

A
B
C
dt

d
dt
dt

dt

e    r - x

ki
P - control
I - control
D - control
Figure 4.63: Graphical state-space representation of SISO PID-control, applied to
a damped mass-spring system. A feedback path, consisting of three
terms, calculates the output of the controller u from the error e after
diÔ¨Äerentiating and integrating. This representation shows that the
blue dash-dotted loop over kp has the same function as the internal
loop by the stiÔ¨Äness k and the red dash-dotted loop via kd has the same
function as the damping coeÔ¨Écient c as the series of an integral and a
diÔ¨Äerential term cancel each other out in the loop. The I-control action
has no corresponding equivalent inside the uncontrolled system and
is introduced to reduce the steady-state error. Note that the reference
is inserted between the output y and the controller.

4.6. State-Space Feedback Control
343
the internal stiÔ¨Äness loop with element ‚àík/m. In combination with the
input element 1/m by B, the value of kp is added to k. The P-control gain
therefore corresponds to a modiÔ¨Åcation of the stiÔ¨Äness of the system, just
as presented in the example of the CD player. The similar relation exists
for the diÔ¨Äerential gain kd, which corresponds to the damping coeÔ¨Écient c
in the mechanical system. The red dash-dotted loop over the diÔ¨Äerentiator
block (d/dt) converts the measured position into a velocity, which serves as
the input to kd. In the D-control feedback loop this calculated velocity is
equal to the real velocity Àôx. In summary, kp and kd are used to change the
stiÔ¨Äness and damping of the system.
A special word of attention has to be given to the reference input and the I-
control loop with the additional integrator. In this PID-control example, the
reference is indicated at the same position as where it was located with the
analytical approach of the previous section on PID-control. With state-space
control this location is more free to choose. In theory the reference signal
can be inserted at any place in the control part because it is an externally
deÔ¨Ånable signal. Often the reference is inserted at the output of the feedback
controller. This is the same place where feedforward control is inserted, as
was indicated at the beginning of this chapter in Figure 4.1.
The integration of the error introduces a third feedback loop. There is
no equivalent element to the integrator in the uncontrolled second-order
mass-spring system. In closed-loop, the action of the integrator results
in a reduction of the steady-state error to zero and due to this eÔ¨Äect it is
sometimes called a super-spring with an inÔ¨Ånite DC-stiÔ¨Äness.
Regarding the placement of the poles it is clear that the feedback gains
directly determine the pole locations as kp + k determine the undamped nat-
ural frequency with two poles on the imaginary axis while kd +c shifts these
poles over a circle back to the real axis. The fact that kp and kd are added to
the terms in the A matrix indicates that another A matrix is obtained with
diÔ¨Äerent eigenvalues and this eÔ¨Äect is further used with full state feedback.

344
Chapter 4. Motion Control
4.6.2
State Feedback
Even though PID-controllers still determine the mainstream of practical
position control systems, it is useful to shortly introduce the more fundamen-
tal mathematical methodology, which enables to design control algorithms
for complex systems with a higher number of inputs and outputs as well as
system states. It is also a useful method when various positioning systems
suÔ¨Äer from cross-couplings. This fundamental approach starts with the
assumption that the best controller can be designed when the full model,
including the dynamics and all states is known. By applying proportional
feedback on the individual states, state feedback is realised. First this prin-
ciple will be better explained and in the following sections it will be shown,
how by means of system identiÔ¨Åcation the state-space matrices can be de-
termined and how state estimators are used to approach the ideal situation
of all states being known as if they all are measured. Even in the case that
direct measurement is not possible it will be shown that the states can be
reconstructed (estimated) from a limited set of measured states.
The standard state-space notation of a dynamic system was shown in Equa-
tion (4.72) and (4.73), which are repeated here:
Àôx=Ax+ Bu
y=Cx+ Du.
In most systems the direct feed-through D is not present or very small and as
simpliÔ¨Åcation D is further assumed to be equal to zero for this explanation
of state feedback. As explained, in state feedback it is assumed to have full
information of the state vector x. This means that all states of the system
are directly measured or calculated from a limited set of measurements.
The feedback-loop is closed with a feedback matrix K, with n columns and i
rows. The resulting output of the feedback controller equals u = ‚àíKx. When
the reference is not taken into account, as that only adds an additional
setpoint term to u without changing the closed-loop system dynamics, the
state-space notation of the resulting dynamic system becomes:
Àôx=Ax+ B(‚àíKx) = (A‚àíBK)x
(4.83)
y=Cx.
(4.84)
As a result a new system is created, looking the same as the open-loop
system, but with a new eigendynamics matrix A‚Ä≤ = A‚àíBK. So to achieve
the desired performance of the closed-loop controlled system under state
feedback, the desired pole locations have to be deÔ¨Åned for stable operation

4.6. State-Space Feedback Control
345
a2
a1
k1
k2
y
u
1x
2
2x
	
x
dt

dt


dt

k3
A
B
C
K
e
	
r
Feedforward
I - control loop
Figure 4.64: State feedback on a SISO positioning system. The position x1 and
velocity x2 are both measured. The derivative of the velocity, Àôx2 equals
the acceleration and is in this case not measured nor required for full
state feedback as this second-order system is fully described by two
states. By applying proportional feedback for the position and the
velocity, the poles can be placed at the appropriate locations in the
Laplace-plane. The I-control loop is additional to reduce steady-state
errors.
and the required feedback matrix K needs to be calculated. A state-space
system is stable if the eigenvalues of the A matrix have all a negative real
part, directly corresponding to the poles of the system‚Äôs transfer function. In
a closed-loop controlled system this means that all eigenvalues of A‚Ä≤ = A‚àíBK
need to have a negative real part and suÔ¨Écient damping for the imaginary
(oscillatory) part in order to achieve a good control performance.
Figure 4.64 shows a graphic representation of a state feedback controller on
a one dimensional (SISO) mass-spring positioning system, where the two
states, the position and velocity, are measured and where the integral of
the position is calculated. It is shown that the individual parameters k#
of the feedback vector correspond to the individual parameters a# of the
system‚Äôs eigendynamics matrix. This is very similar to the case presented
before for the PID-controller of the second-order mass-spring system. This
means that state feedback is equal to a set of P-control terms for a system
where all states are directly measured, and the individual P-control gains
correspond to the parameters of the feedback matrix K.

346
Chapter 4. Motion Control
In state-space control the integral action is a special case as one might say
that this creates another state by the controller itself without any direct
link to a similar state in the system. This state is not needed for controlling
the system dynamics as two states are in principle suÔ¨Écient for a second-
order system. As was previously explained, the I-control action is added
to a feedback control system in order to reduce the steady-state errors by
means of an increase of the loop-gain at low frequencies. For this reason
it is customary in state-space control to introduce the I-control action as a
separate negative feedback loop from the system output y to the input after
comparing with the reference r. The integration will only reduce errors in
the low-frequency area so high-frequency components of the reference signal
will not be controlled and even attenuated by the I-control action (1/œâ). This
eÔ¨Äect is solved by adding the high-frequency part of the reference to the
feedforward input of the system. In that case the state-feedback loops will
control this part of the frequency spectrum.
Side note: A critical designer of this control system also could say here:
‚ÄúWhy should I use two sensors. One position sensor is enough as I can
apply D-control to derive the velocity‚Äù. While this statement is fully correct,
one must not forget that it is always necessary to deal with sensor noise.
If the position sensor is noisy, the derivative action would amplify this
noise especially at high frequencies and this noise would be inserted in
the feedback loop. For higher-order systems with for instance multiple
springs and bodies, where only the position of the last body is measured,
even multiple derivatives of the sensor signal would be needed to apply full
state feedback and this would amplify the noise even more. This is another
example of the often economic trade-oÔ¨Äa mechatronic designer needs to
make.
4.6.2.1
System IdentiÔ¨Åcation
Good knowledge of the dynamics of the plant is crucial for a successful
controller design. Particularly for the design of model-based controllers a
mathematical model of the uncontrolled system dynamics is required but
also for the tuning of classical controllers, such as a PID-controller, knowl-
edge of the transfer function of the plant is necessary. These models can be
obtained via physical modelling based on Ô¨Årst principles, as described in
several chapters in this book for the mechanical structure, the ampliÔ¨Åers
and the actuators. An alternative to this physical modelling is to obtain
a mathematical model by Ô¨Åtting a mathematical transfer function to the
measured frequency response of the dynamic system via the System Identi-

4.6. State-Space Feedback Control
347
Ô¨Åcation methodology [59].
With System IdentiÔ¨Åcation the model of the plant, including the sensors
and actuators, is obtained by Ô¨Åtting the parameters of the diÔ¨Äerential equa-
tion to a measured set of input and output data. When the structure of
the expected model is known, only the model parameter values are identi-
Ô¨Åed, which is called grey-box system identiÔ¨Åcation. If also the structure of
the system is unknown, this is called black-box system identiÔ¨Åcation and
the identiÔ¨Åcation algorithm then also has to estimate the model-order and
structure. The system identiÔ¨Åcation directly gives the state-space form or
the transfer function of the system, but is always limited to the minimal
realisation of the system, which means that from the system dynamics of
the plant only those eigenmodes are considered that can be observed as
well as controlled. This is in general not a problem when no other forces act
on the system that excite the un-observed and un-controlled modes and it
can even be desired as it avoids excitations of these modes by noise in the
control loop. Nevertheless it is important to be aware of this fact because
the un-observable or un-controllable eigenmodes might very well be a main
cause for problems in a complex mechatronic system consisting of many
actuated subsystems.
System identiÔ¨Åcation is a strongly developing Ô¨Åeld of control engineering
and the created fast algorithms even allow the application in real-time for
certain situations, thereby enabling real-time adaptations of the controller.
This highly specialised Ô¨Åeld falls beyond the scope of this book but a mecha-
tronic designer needs to be well aware of the growing potential for solving
complex mechatronic control problems.
4.6.2.2
State Estimation
In the previous section it was shown how a suitable controller can be realised,
if all states are measured. It is however not always possible to measure
all positions, velocities and related derivatives in a mechatronic system,
while precision sensors are also quite expensive. As mentioned before, using
the derivative of the position signal in order to obtain the velocity signal,
like in a D-control feedback system, is possible but may be too sensitive to
noise. One way to get the full information of the state vector is to build a
real-time state estimator, which is based on the model of the plant includ-
ing the eigendynamics. Such an estimator is also called an observer while
it observes the behaviour of a system by comparing it with the modelled
behaviour and correcting its model parameters on this comparison in a
process called innovation. Such an observer also allows a trade-oÔ¨Äbetween

348
Chapter 4. Motion Control
B
C
A
K
-
B
C
A
Real 
system
Real-me 
model
-
L
x
x
y
u
obs
x
obs
x
o
y
u
Model-based controller
e
r
dt

dt

Figure 4.65: Model-based controller with an observer to estimate not measured
states in a state feedback control system. The real-time feedback
path is determined by the feedback matrix K based on estimated state
values from within the model. The model is updated by the diÔ¨Äerence
between the observer output yo and the real system output y via the
matrix L.
the bandwidth (speed) of the estimation and the noise performance. An
observer with an optimal trade-oÔ¨Äbetween these two important properties
is called a Kalman-Ô¨Ålter, named after the Hungarian mathematician and
electronic engineer Rudolph Emil K√°lm√°n.
Figure 4.65 shows the conÔ¨Åguration of a state observer in combination with
state-feedback control of the observed system. The blocks in the dashed
box represent the real mechatronic system. The blocks in the dotted box
represent the mathematical model, which is implemented on a computer to
simulate the behaviour of the mechatronic system in real-time. When both
systems receive the same input signal u, and both systems are identical,
which means that a perfect model is available, both outputs y and yo should
be the same. However, in reality always modelling errors will occur while
also the mechatronic system can be disturbed by external forces that are
not taken into account and causing position and velocity errors. To compen-
sate for these deviations the observer-gain matrix L is introduced, which
determines the innovation process by feedback of the prediction error to
the observer, given by the diÔ¨Äerence between the output of the model and
the output of the real system (e = yo ‚àíy). L has to be designed such that the
closed-loop system for the observer part is stable. This is the case if the

4.6. State-Space Feedback Control
349
feedback loop of the observer, determined by A, L and C, only has poles in
the left-half of the Laplace-plane.
The choice of L inÔ¨Çuences the location of these poles, and determines the
speed at which the state observer follows changes in the actual states of
the physical system. When a fast response is chosen, the observed state
vector will quickly follow changes in the system but will also respond more
to noise, originating for instance from the sensor. A slow response of the
state observer introduces some ‚Äúsmoothing‚Äù or masking of fast disturbing
signals, for instance when the measurement is corrupted by sensor noise.
Like with the name of an optimal observer, the observer gain, which is
providing the optimal trade-oÔ¨Äbetween speed and noise performance for a
known co-variance of the sensor noise, is called the Kalman-gain.
4.6.2.3
Additional Remarks on State-Space Control
The analytical modelling of dynamic systems with transfer functions gets
most attention in this book because it is more intuitively connected with
the physical behaviour of a mechatronic system. Nevertheless the state-
space approach has several advantages over the analytical transfer function
approach especially with more complex systems. The matrix calculations
enable to directly create a MIMO controller where all cross-coupling between
diÔ¨Äerent channels is taken into account [81]. This second advantage entails
also a disadvantage as it becomes more diÔ¨Écult to distinguish problems
that are caused by malfunctioning of one element in the complex system.
This argument has long hampered the application of MIMO controllers in
practical mechatronic systems.
Furthermore the state-space model allows to more easily include any initial
conditions and additional disturbances that act on the same system states.
The observer based controller has another potential advantage. While
the standard implementation of an observer runs on all measurements in
discrete-time at the same sampling rate as the controller, it is also possible
to decouple these sampling rates. The time behaviour of the L matrix can
be chosen in relation to the level of Ô¨Ådelity of the model to reality. When the
model is almost ideal, the estimation error e will show very little deviations
and when these deviations are slow, L can be reduced to correct the model
only occasionally. This introduces the possibility to decouple the timing of
the measurement path from the timing of the feedback loop.
One can think of several situations where measurements can only be done
at certain long intervals. One example occurs when an object has to be
placed at another location for the measurement because of environmental

350
Chapter 4. Motion Control
constraints. Another example is the situation where the process needs to be
terminated for a precise measurement because the process induces an excess
of noise and disturbances. In those cases, the observer provides information
to the feedback loop prior to the real measured value, so running rather as a
simulation of the dynamics, thus preventing instability by the phase-lag of
the slow measurement signal. As long as the measurement delay is known
and the model is suÔ¨Éciently accurate, this method can be really eÔ¨Äective
as it deÔ¨Ånes a process of frequent re-calibration of the real-time dynamic
model at regular intervals. One might also say that at regular intervals
the real feedback loop is temporarily broken and the observer will act as a
simulator or as an adaptive feedforward controller between these intervals, .
When the model is not perfect, a combination of real time local approximate
measurements with observer based correction at longer intervals might
still give the required result. The system would behave like a ship sailing
over the ocean in ancient times, where the captain as controller determines
his direction by real-time feedback corrections, which are based on the
observation of the wind and the ocean waves, while he corrects his model by
infrequently ‚Äùshooting a star‚Äú with his sextant.
4.7
Conclusion on Motion Control
Motion control is essential for Precision Mechatronic Systems and consists
of two complementary elements:
‚Ä¢ Extremely accurate Feedforward Control is required when the
motion system must execute a user deÔ¨Åned motion to within maximum
user deÔ¨Åned position error limits. The forces required for this task
are known upfront and can generally not be generated by feedback
control only given the limited allowable position error and physical
limitations on achievable loop-gain of feedback control.
‚Ä¢ High Performance Feedback Control is required when the motion
system must be able to follow an unknown motion of a target, stabilise
an otherwise instable system and reduce the impact of disturbing
forces and vibrations, such that the position error remains below a
maximum user deÔ¨Åned level. Due to the fact that a feedback controller
can become unstable, suÔ¨Écient robustness must be guaranteed.
There is a conÔ¨Çicting relation between stability and performance.

blank
left
intentionally
page
This

blank
left
intentionally
page
This

Chapter 5
Electromechanic
Actuators
Robert Munnig Schmidt, Georg Schitter
Introduction
The dynamic properties of a mechatronic system are not only determined by
its mechanical structure. The incorporated subsystems such as ampliÔ¨Åers,
actuators and sensors have their own impact on the full system dynamic
performance. Especially a thorough understanding of the interface between
the mechanical and electrical engineering domains is required in order to
design a well balanced system. This interface is covered in this chapter on
electromechanics.
It concentrates on direct drive actuators with linear motion as these are the
elements of choice in high-precision mechatronic systems. Rotating electric
motors with diÔ¨Äerent transmissions, as used in many less advanced systems,
are suÔ¨Éciently described in many other books.
The chapter starts after some history with the creation of magnetism by
means of electric current. Section 5.2 the behaviour of linear actuators like
moving-coil Lorentz actuators and the stronger but non-linear reluctance
actuators will be presented together with the optimal combination of both
principles in the hybrid actuator. These basic conÔ¨Ågurations are suÔ¨Éciently
representative for the design of most electromagnetic actuators. With the
derived approximating equations, reasonable estimations can be made of
353

354
Chapter 5. Electromechanic Actuators
forces in concept designs.
Also attention is given to the electrical properties, which are important
for the integration in mechatronic systems. Especially the aspects related
to the power ampliÔ¨Åer are given attention as this electronic system has
to deliver the current to the actuator. An electromagnetic actuator is a
special type of electric machine. The term actuator is reserved for those
devices that directly convert electrical energy into a movement over just a
limited linear or rotational range. Electromagnetic actuators still determine
the main-stream actuation principle in precision mechatronic systems, but
piezoelectric actuators are increasingly important especially in applications
that need very large forces with small corrective movements, like in machin-
ing tools. But also in very small systems piezoelectric actuators are used
to advantage, because they can create displacements at very high frequen-
cies. For this reason, Section 5.5 presents an introduction on piezoelectric
actuators.
History of Electric Machines
The Ô¨Årst experiments regarding electricity by the American statesman and
scientist Benjamin Franklin (1706 ‚Äì 1790) occurred already around the
year 1750. In spite of these early investigations the Ô¨Årst real application,
the creation of artiÔ¨Åcial light, only emerged in the second half of the 19th
century. Also in this period the Ô¨Årst electric motors were created based on
the experiments on electromagnetic forces by the Danish physicist Hans
Christian Oersted (1777 ‚Äì 1851). An example of such an early electric
motor is the one shown in Figure 5.1 designed by Edison around 1898 for
use in a cooling fan. Thomas Alva Edison (1847 ‚Äì 1931) was an American
inventor and scientist but above all he was a successful businessman who
did everything he could to increase interest for the use of electricity. Next
to his well-known contributions to the application of incandescent light, he
also made other electric appliances like the electric fan of which the electric
motor is shown here.
For a long time the rotating electric motor determined all electrical driven
motion in the world. These motors worked according to a variety of principles
ranging from asynchronous induction to synchronous permanent magnet
types with mechanical commutation, which enabled them to run at speeds
in the order of several thousands revolutions per minute. The application
of gearboxes made it possible to convert their usually high rotation speed
into a slower and more controlled motion. Next to a rotating motion also
linear motion was possible with crown wheel and screw spindle mechanisms.

355
Figure 5.1: Rotating electric motor designed by Thomas Alva Edison to drive a
cooling fan. The motor contained no permanent magnets while the
magnetic Ô¨Çux was only created by current. A commutator with sliding
contacts allowed it to be used with direct current electric power, which
was Edison‚Äôs preferred source of electrical energy.
(Courtesy of John Jenkins, www.sparkmuseum.com)
In the course of the 20th century already high levels of linear precision
in the order of ten to hundred micrometres could be achieved with the
use of pre stressed (ball-screw) mechanisms. These were mainly used in
machining tools, but people started to look for alternatives that did not suÔ¨Äer
from the inherent backlash, friction and play of these mechanical drives,
which limited the use with active position control systems. As discussed in
the introduction of this book this has resulted in two diÔ¨Äerent directions.
The Ô¨Årst originated in the machine tool industry. The newly discovered
piezoelectric properties of certain materials were added to the large screw
spindle based motion system as short stroke actuators for correcting the
position errors. The second direction was based on positioning of systems
without strong external forces and relied mainly on electromagnetic energy
conversion principles.

356
Chapter 5. Electromechanic Actuators
5.1
Electromagnetics
The Maxwell equations in their diÔ¨Äerential vectorial notation as introduced
in Chapter 2 are applied in many Ô¨Ånite element modelling software pack-
ages. The resulting calculations reach near perfection, depending on the
reÔ¨Ånement of the chosen grid, the exactness of the shape of the magnetic
parts and the aÔ¨Äordable amount of computing time.
For a mechatronic system designer however, it is often necessary to quickly
obtain a Ô¨Årst estimation of the properties of an electromagnetic system,
before entering into detailed analysis with dedicated software. It is often
also necessary to be able to recognise artifacts that are created by the
modelling software when the boundary conditions are badly chosen.
For that reason in the following sections the vectorial notations are often
approximated by scalar equations dealing with magnitude only, assuming
the direction of the Ô¨Åelds and currents is known. This assumption is only
valid when the directional correlation between all parameters are either
parallel or orthogonal.
This Ô¨Årst order approximation is often allowed in initial actuator designs,
because of their orthogonal design. When necessary an angular factor
(sine/cosine) can be introduced as a second order correction.
The steps toward usable equations start with the basic relation between
electricity and magnetism derived from Amp√®re‚Äôs law without the term for
the unbound charges, because only currents in conductors are considered:

L
B¬∑ dl = Œº0I
[Tm].
(5.1)
When the loop is a circle with radius x around a conductor with a current I
as shown in Figure 5.2, the magnetic Ô¨Åeld B has a constant Ô¨Çux density B
over the circle and directed along the circle.
This means that the left integral term becomes equal to 2œÄxB. As a result
the Ô¨Çux density becomes equal to:
B(x) = Œº0I
2œÄx
[T].
(5.2)
This equation is valid under the condition that the surrounding material
is vacuum, for which Amp√®re‚Äôs law was postulated. In words this equation
tells us that the magnetic Ô¨Çux density is proportional to the current in the
wire and the magnetic permeability in vacuum and inversely proportional to
the distance. This dependence of the magnetic permeability automatically

5.1. Electromagnetics
357
x
I
+
_
B
Figure 5.2: The magnetic Ô¨Åeld, generated by a current through a wire is directed
clockwise, when looking in the direction of the current. The magnitude
of the magnetic Ô¨Åeld decreases proportional with the distance to the
wire.
results in a change of the Ô¨Çux density when the permeability would be
diÔ¨Äerent.
More directly related to the electric current is the magnetising Ô¨Åeld H with
its scalar magnitude, the magnetic Ô¨Åeld strength H:
H(x) = B(x)
Œº0
=
I
2œÄx
[H].
(5.3)
This means that the magnetic Ô¨Åeld strength is only determined by the
current and the distance to the wire. For this reason the vector Ô¨Åeld H,
corresponding to the magnetic Ô¨Åeld strength H was named ‚Äú magnetising
Ô¨Åeld‚Äù in order to indicate an electric current as the source of the magnetic
Ô¨Åeld B1.
In practical electromagnetic systems wires are wound in coils with a certain
number of windings n. As can be seen in Figure 5.3 the magnetic Ô¨Åelds
created by a multiple of electrical wires running in parallel, add vectorial,
because of the superposition principle of magnetic Ô¨Åelds. As a result, by
winding the wire in a coil, as shown in Figure 5.4, the total Ô¨Åeld generated by
the current increases per added winding. After integration of the magnetic
1The real answer to the philosophical question of ‚Äúwhat comes Ô¨Årst‚Äù or ‚Äúwhat causes what‚Äù,
the H or the B Ô¨Åeld, is beyond the needs of this chapter as both Ô¨Åelds are equally present and
can be used where appropriate.

358
Chapter 5. Electromechanic Actuators
Figure 5.3: Three currents running in parallel wires, directed towards the observer,
each generate a magnetic Ô¨Åeld that is represented by the dashed Ô¨Åeld
lines. These Ô¨Åelds add vectorial, according to the superposition principle
of magnetic Ô¨Åelds, resulting in a larger total Ô¨Åeld that is represented
by the solid red Ô¨Åeld lines. It shows the straightening of the resulting
Ô¨Åeld lines at some distance parallel to the orientation of the wires.
Ô¨Åeld of all windings using Equation (5.2) over the cross section Ac inside a
coil with a winding height hc, the following expression for the average Ô¨Çux
density Bw [T], the average magnetic Ô¨Åeld strength Hw [H] and the total
Ô¨Çux Œ¶w [Wb] inside the coil would be obtained, when the coil is surrounded
by air or vacuum:
Bw,av = Œ∫Œº0nI
hc
=‚áí
Hw,av = Bw,av
Œº0
= Œ∫ nI
hc
,
Œ¶w = BwAc = Œ∫Œº0nI
hc
Ac. (5.4)
with Œ∫ < 1 as a ‚Äúcoupling factor‚Äù between the windings, taking into account
that the magnetic Ô¨Åeld is not really homogeneous and the eÔ¨Äects of the edges
of the coil are fully neglected. Only an inÔ¨Ånite coil with the current evenly
spread over the surface will give Œ∫ = 1, but with small coils the coupling
factor Œ∫ ‚âà0.3 ‚Äì 0.7, depending on the height to diameter ratio of the coil.
In spite of this rough approximation Equation (5.4) is useful in a qualitative
manner, as it shows the impact of the height of the coil on the magnetic
properties.
The reduction of the magnetic Ô¨Åeld as function of the winding height hc,
under further equal conditions regarding current and number of windings,
is caused by the reduced addition of the separate Ô¨Çux levels of each winding
at an increased mutual distance. The diameter is not present in the equation
as its inÔ¨Çuence is included in Œ∫.
With an inÔ¨Ånite coil it can be reasoned that the contributions of the diÔ¨Äerent
windings are equal at an equidistant position of the windings in the middle

5.1. Electromagnetics
359
I
B
Northpole
Southpole
V
+
 i
 c
A
A

_
n windings
 c
i
h  
o

w

$
Force
External
Reluctance 
N
S

$^¬ï
Internal
Reluctance 
Figure 5.4: The magnetic Ô¨Åeld from a current carrying coil consists of the vectorial
addition of the magnetic Ô¨Åelds of all windings contributions. This
results in an approximately uniform Ô¨Åeld inside the coil, which is shared
by all windings. The equivalent Hopkinson circuit model is shown at
the right.
of the coil. Closer to one side the contribution of that side is proportionally
increased, while the contribution of the other side is decreased.
In approximation this means that the Ô¨Çux density is constant over the
diameter of the coil.
The direction of the magnetic Ô¨Çux, relative to the current direction, directly
follows from the deÔ¨Ånitions for the Maxwell equations from Figure 2.5 in
Chapter 2. Following the direction of the current, the magnetic Ô¨Çux rotates
clockwise around the wire as was shown in Figure 5.2. For a coil with
multiple windings this means that the direction of the Ô¨Çux inside the coil
corresponds to the current Ô¨Çowing around it in the clockwise direction.
The place where the Ô¨Çux leaves the magnet is deÔ¨Åned as the ‚ÄúNorth pole‚Äù
and the other side as the ‚ÄúSouth pole‚Äù. Even though this seems to correspond
to their counterparts of the magnetic Ô¨Åeld of the planet Earth, the poles of
the earth are reversed as the deÔ¨Ånition of North pole in a magnet was made
to tell which side of a compass needle points towards the North pole of the
planet Earth.
This deÔ¨Ånition has caused the reversal, because opposite poles attract each
other.

360
Chapter 5. Electromechanic Actuators
5.1.1
Hopkinson‚Äôs Law
The calculation of real magnetic Ô¨Åelds is in practice a calculation intensive
procedure, because of the 3-dimensional spread of magnetic Ô¨Åelds, the im-
possibility to create magnetic insulation, the highly non-linear behaviour
of ferromagnetic materials, which will be introduced later, and the inÔ¨Ånite
space that has to be considered. Even Ô¨Ånite element models that strictly
apply the Maxwell Equations are often limited to 2-dimensional calculations,
which are expanded to quasi 3-D results because of rotational symmetry in
the system. Real 3-D modelling software is only used in extreme cases. For
this reason a simpliÔ¨Åed analytic model of magnetic circuits is widely used
for an approximate analysis of its magnetic properties.
Similar and possibly inspired by Ohm‚Äôs law in electronics, the British physi-
cist and electrical engineer John Hopkinson (1849 ‚Äì 1898) stated that a
magnetic system can be approximated by means of an comparable circuit
model, consisting of a source of magnetism that, together with a magnetic
load, determines the magnetic ‚Äúcurrent‚Äù, being the Ô¨Çux Œ¶.
It was shown in the previous section that an electric current acts as a source
of magnetism. In Hopkinson‚Äôs law of magnetics this source is equal to the
magnetomotive force, which was deÔ¨Åned by Amp√®re‚Äôs law:
Fm =

L
H ¬∑ dl = Ienc = nI
[A],
(5.5)
where L equals the loop around all windings from inside to outside the coil
and n equals the number of windings.
For the magnetic resistance the term Reluctance (R) is introduced because
of the English word ‚Äúreluctant‚Äù in relation to the unwillingness of a material
to be permeated by a magnetic Ô¨Åeld. The magnetic reluctance is deÔ¨Åned by
means of the following relation:
R = ‚ÑìŒ¶
ŒºA
A/Vs

,
(5.6)
where ‚ÑìŒ¶ equals the length of the path the magnetic Ô¨Çux has to follow and
A equals the cross section of the path. This is logical, when considering
that the reluctance R represents the amount of eÔ¨Äort needed to introduce
a magnetic Ô¨Çux in a certain material. A larger surface and higher values
of the permeability will reduce this eÔ¨Äort while a longer path length will
increase it.
With these deÔ¨Ånitions, Hopkinson‚Äôs law of magnetics, similar to its electric
counterpart, Ohm‚Äôs law, is formulated as follows:
Œ¶ = Fm
R = nIŒºA
‚ÑìŒ¶
[Wb].
(5.7)

5.1. Electromagnetics
361
Generally neither the cross section A, the path ‚ÑìŒ¶ nor Œº is constant over the
entire system, so in practice the reluctance is calculated as the summation
of the reluctances of each region with diÔ¨Äerent properties along the path
of the Ô¨Çux, because these reluctance contributions are connected in series.
Like with resistors in series, where the current Ô¨Çows through all resistors,
the magnetic Ô¨Çux Ô¨Çows through all elements along the path of the Ô¨Çux and
this means that each reluctance element adds to the total reluctance.
To check this law the induced magnetic Ô¨Åeld by a current in the coil from
Figure 5.4 in vacuum is determined, using Hopkinson‚Äôs law of magnetics.
This results in a Ô¨Çux density Bw inside the windings of the coil of:
Bw = Œ¶w
Ac
= Fm
AcR =
nI
AcR
[T].
(5.8)
The reluctance can be modelled to consist of the part Ri with length ‚Ñìi inside
the coil and the part Ro with length ‚Ñìo outside the coil:
R = Ri +Ro =
‚Ñìi
AiŒº0
+
‚Ñìo
AoŒº0
A/Vs

,
(5.9)
where Ai and Ao equal the cross sections of the Ô¨Çux path inside and outside
of the coil. The Ô¨Årst term of the reluctance inside the coil can be determined
quite straightforward, because of the constant cross section Ai = Ac and the
height of the coil (‚Ñìi = hc). The second term of the reluctance outside the
coil is more complicated, as the length ‚Ñìo for each Ô¨Çux line will be diÔ¨Äerent
ranging from hc at the exit of the coil to inÔ¨Ånite. On the other hand the cross
section Ao is also inÔ¨Ånite, as it consists of all space outside the coil. As an
approximation the reluctance of the outside part can be taken into account
by the same factor Œ∫ that was used in the previous section. This means that
the total reluctance equals the reluctance of the inner part divided by Œ∫:
R =
‚Ñìi
Œ∫AcŒº0
A/Vs

.
(5.10)
The average Ô¨Çux density and related Ô¨Åeld strength in the coil are then equal
to:
Bw,av = Œ∫Œº0nI
‚Ñìi
= Œ∫Œº0nI
hc
[T]
=‚áí
Hw,av = Œ∫ nI
‚Ñìi
= Œ∫ nI
hc
A/m

,
(5.11)
which is equal to the previously found relations.
Further it also shows clearly the relation between the magnetomotive force
Fm = nI and the average magnetic Ô¨Åeld strength Hw,av.
Hw,av ‚âàŒ∫Fm
‚Ñìi
A/m

=‚áí
Fm ‚âàHw,av‚Ñìi
Œ∫
[A].
(5.12)

362
Chapter 5. Electromechanic Actuators
5.1.1.1
Practical Aspects of Hopkinson‚Äôs Law
Generally Hopkinson‚Äôs law is less suitable for calculating magnetic Ô¨Åelds
where the reluctance is determined by large volumes of air, like in this
calculation for an air coil. The inÔ¨Çuence of Œ∫ reduces the accuracy to less
than an order of magnitude in that case, but with practical magnetic systems
with small air gaps and magnetically conducting ferromagnetic materials,
the method gives better results as will be shown in Section 5.1.2.1. In those
cases the magnetic Ô¨Åeld strength can be determined over the total magnetic
Ô¨Çux loop with length ‚Ñìy, the Ô¨Åeld is approximately homogeneous (Hw,av = Hw)
and the coupling factor can be approximated as Œ∫ ‚âà1, giving:
Hw ‚âàFm
‚Ñìy
A/m

=‚áí
Fm ‚âàHw‚Ñìy
[A].
(5.13)
Similar to electrical circuits the total magnetomotive force over a loop will
equal zero according to KirchhoÔ¨Ä‚Äôs laws that will be introduced in Sec-
tion 6.1.1.4. This means that this magnetomotive force and the correspond-
ing Ô¨Åeld strength H will divide over the reluctances with the maximum
value over the highest reluctance.
Finally it is very important to be aware of a potential danger in the use
of the terms in Hopkinson‚Äôs law, because the similarity with the electrical
terms could easily lead to the conclusion that the magnetic Ô¨Çux times the
magnetomotive force would be equal to power and this is not the case. When
checking the units, FmŒ¶ ‚Üí[A¬∑V¬∑s] = [W¬∑s] = [J], which is energy and not
power. A stationary magnetic Ô¨Åeld contains a constant amount of stored
energy, which means that Ô¨Çux can not be a Ô¨Çow of power like in the moving
electrons in electricity.
5.1.1.2
Magnetic Energy
A magnetic Ô¨Åeld contains the energy that was used to create this Ô¨Åeld.
Inserting electric current in a coil will induce a voltage over the coil by the
increasing magnetic Ô¨Åeld according to Faraday‚Äôs law. This combination of
voltage and current implies insertion of electric power, which integrated over
the time to reach a certain current level represents an amount of energy that
is stored in the magnetic system. The magnetic Ô¨Åeld strength H in
A/m
 is
proportional to the electric current and a change of the Ô¨Çux density ŒîB in [T]
is proportional to the induced voltage, which means that the energy density
in
J/m3 at a certain position in the magnetic Ô¨Åeld can be calculated by
integrating the local magnetic Ô¨Åeld strength Hxyz over the local Ô¨Çux density

5.1. Electromagnetics
363
level Bxyz. When also integrating this energy density value over the total
volume Vt of the magnetic system around the current carrying coil, the total
magnetic energy of the system is obtained:
Em =
VŒ¶
;
0
Bxyz

0
H dB dV
[J].
(5.14)
With H = B/Œº0, the speciÔ¨Åc energy per unit of volume can be written as
function of the local magnetic Ô¨Çux density, of the local magnetic Ô¨Åeld strength
or of their multiplication:
Em
Vt
=
Bxyx

0
B
Œº0
dB = 1
2
B2
xyz
Œº0
‚âú1
2 H2
xyzŒº0 ‚âú1
2 HxyzBxyz
J/m3
.
(5.15)
To calculate the total energy in a magnetic system, this value can be inte-
grated over the total volume of the system VŒ¶ = AŒ¶‚Ñìy, where AŒ¶ equals the
cross section of the system orthogonal to the Ô¨Çux and ‚Ñìy equals the total
length of the Ô¨Çux path. With Hopkinson‚Äôs law the following relations can be
applied to Equation (5.14):
VŒ¶
;
0
dV =
‚Ñìy

0
AŒ¶

0
d‚ÑìdA,
‚Ñìy

0
Hw d‚Ñì= Fm = Œ¶R,
AŒ¶

0
Bxyz

0
dA dB =
Œ¶w

0
dŒ¶.
Resulting in the total energy:
Em =
VŒ¶
;
0
Bxyz

0
H dB dV =
Œ¶w

0
Fm dŒ¶ =
Œ¶w

0
Œ¶R dŒ¶ = 1
2Œ¶2
wR ‚âú1
2
F 2
R
[J].
(5.16)
Even though this equation is derived for a magnetic system with only a
current carrying coil it is also an often allowable approximation for more ex-
tended magnetic systems with ferromagnetic materials as will be presented
in the next section. These materials show a relatively small reluctance
value, which means that they also have a very low level of the magnetic Ô¨Åeld
strength H and a correspondingly low magnetic energy (Em ‚àùBH).

364
Chapter 5. Electromechanic Actuators
5.1.2
Ferromagnetic Materials
One method to increase the magnetic Ô¨Çux, without increasing the current, is
the use of a material with a higher permeability. Materials other than
vacuum have a relative permeability Œºr in respect to the permeability
in vacuum, because Œº0 is the reference. This value equals around 1 for
non-ferromagnetic materials like air, glass, many metals and plastics but
with ferromagnetic materials Œºr can reach values of about 100 for iron
and nickel to as large as 100,000 for materials like Superpermalloy. Most
non-ferromagnetic materials show some very limited eÔ¨Äects and are called
paramagnetic if they show a Œºr of just above 1 or diamagnetic if they show a
Œºr of just smaller than 1. The latter have the ‚Äústrange‚Äù property of being
repelled by a magnetic Ô¨Åeld. A famous example is the levitated living frog
shown in Figure 5.5. It was demonstrated by the Dutch/Russian Nobel prize
winner Andre Konstantinovitsj Geim (1965) at the High Field Magnetic
laboratory of the Radboud University in Nijmegen, the Netherlands [36].
The frog is stably Ô¨Çoating inside a very strong magnetic Ô¨Åeld of about 20T,
because of the very small diamagnetic properties of water, which is the main
constituent of a frog. The Œºr values of diamagnetic materials are extremely
small. For this reason they are still of little practical use in electro magnetic
systems and will therefore not be further presented in this chapter. On the
other hand real ferromagnetic materials are frequently used for creating
strong magnetic Ô¨Åelds.
Figure 5.5: A living frog Ô¨Çoating inside a coil with 20 T magnetic Ô¨Çux density, which
was demonstrated by Nobel prize winner Andre Geim. The diamagnetic
properties of the water in the frog stabilises its position inside the coil.
(Courtesy of Radboud University Nijmegen)

5.1. Electromagnetics
365
5.1.2.1
Coil with Ferromagnetic Yoke
When a yoke of ferromagnetic material is added to a coil, the Ô¨Çux and Ô¨Çux
density will increase signiÔ¨Åcantly as the ferromagnetic material determines
a low reluctance path for the Ô¨Çux, both inside and outside the coil, as shown
in Figure 5.6. By using Hopkinson‚Äôs law of magnetics the Ô¨Çux in the yoke
can be calculated.
The magnetomotive force of the current equals:
Fm = nI
[A].
(5.17)
With a suÔ¨Éciently high value of Œºr the reluctance is mainly determined by
the path through the material with the high permeability. This is mostly
the case with the usual ferromagnetic materials in mechatronic systems.
With this condition the reluctance becomes:
R =
‚Ñìy
Œº0ŒºrAy
A/Vs

,
(5.18)
with ‚Ñìy and Ay being respectively the length and the cross section of the Ô¨Çux
path inside the yoke. Note that in spite of the two dimensional case these
values are approximated one dimensional where Ac is assumed orthogonal
to the Ô¨Çux and ‚Ñìc is the average path length.
The Ô¨Çux Œ¶y in the yoke is equal to the Ô¨Çux Œ¶w in the coil:
Œ¶y = Œ¶w = Fm
R = AyŒº0ŒºrnI
‚Ñìy
[Wb].
(5.19)
 y
A
I
V
+
_
n windings
I
V
+
_
y

ferromagnec yoke
Figure 5.6: Magnetic Ô¨Çux generated by a current carrying coil wound around a
ferromagnetic yoke is much larger than without the yoke, because of
the high magnetic permeability of the ferromagnetic material.

366
Chapter 5. Electromechanic Actuators
The corresponding Ô¨Çux density and magnetic Ô¨Åeld strength inside the coil
equal:
Bw =
Œ¶y
Ay
= Œº0ŒºrnI
‚Ñìy
[T]
=‚áí
Hw = Bw
Œº0Œºr
= nI
‚Ñìy
A/Vs

.
(5.20)
5.1.2.2
Magnetisation Curve
From the previous equations it can be concluded that an increase of the
relative permeability Œºr of the material of the yoke results in a proportional
increase of the Ô¨Çux and the Ô¨Çux density. In ferromagnetic materials the
relative permeability Œºr is not constant but reduces at higher levels of Ô¨Çux
density. This is visualised in the magnetisation curve, a graphical repre-
sentation of the Ô¨Çux density Bw as function of the Ô¨Åeld strength Hw. The
horizontal axis is also proportional with the magnetomotive force and the
current in the magnetising coils, because the Ô¨Åeld strength is independent
of the permeability.
In Figure 5.7 the magnetisation curve of a ferromagnetic material in the
conÔ¨Åguration of Figure 5.6 is compared with the situation without a ferro-
magnetic yoke.
The current is increased from zero starting at the origin. This current causes
a proportional magnetising Ô¨Åeld with a magnitude equal to the magnetic
Ô¨Åeld strength Hw. This also corresponds to an increasing magnetic Ô¨Åeld of
which the magnitude, the Ô¨Çux density, depends on the level of the relative
magnetic permeability of the material.
Above a certain value of the Ô¨Çux density, the material becomes saturated.
This is caused by small magnetic areas in the materials micro-structure,
which are responsible for the relative permeability and have to direct them-
selves to the magnetic Ô¨Åeld. These areas are called Weiss domains after
the French Physicist Pierre-Ernest Weiss (1865 ‚Äì 1940), who discovered the
magnetic orientation of these elementary ‚Äúbuilding blocks‚Äù. A Weiss domain
has a typical size of 10‚àí6 to 10‚àí8 m and contains approximately 106 to 109
atoms. The orientation to the external magnetic Ô¨Åeld takes place inside
the Weiss domain and can be imagined as an elastic eÔ¨Äect. Initially the
domains only partly orient themselves but with higher levels of magnetisa-
tion they gradually become completely oriented. As soon as this happens,
the beneÔ¨Åcial eÔ¨Äect to the magnetic Ô¨Åeld is reduced. When the current is
increased beyond this level the Ô¨Çux density increases further proportional
to Œº0 only so parallel to the line corresponding to the situation without a
ferromagnetic yoke.

5.1. Electromagnetics
367
w( )
H
I
Saturaon
w
0
w
B
H
 

w
0
r
w
B
H
  

Saturaon
w
B
In vacuum or air
With ferromagnec core
Figure 5.7: Relation between the Ô¨Çux density Bw and the magnetic Ô¨Åeld strength
Hw inside a current carrying coil, with and without a ferromagnetic
yoke. An increase in the current will result in an increase of the Ô¨Çux
density at a rate determined by the magnetic permeability, because Hw
is proportional to the current in the coil. With a ferromagnetic yoke,
the initially strong eÔ¨Äect of Œºr will reduce above a certain level of the
Ô¨Çux density, due to saturation. At even higher levels the curve will
asymptotically continue parallel to the line with Œº0 only.
5.1.2.3
Permanent Magnets
All ferromagnetic materials show a certain amount of hysteresis. This means
that after applying and removing a magnetic Ô¨Åeld, the material will retain
a remanent magnetic property. Like the saturation eÔ¨Äect, this is caused in
the material itself, where the Weiss domains need some energy to change
their magnetic orientation. This can be imagined as a friction eÔ¨Äect limiting
the possibility for the Weiss domains to change its orientation. For many
applications this hysteresis is a drawback, as it causes energy loss, due to
the need to supply the energy to change the orientation of the Weiss do-
mains. On the other hand however, this special property can help creating
magnetic Ô¨Åelds, without electrical energy. This is the case in permanent
magnets, which are utilised in most electromagnetic actuators for precision
mechatronics.
A permanent magnet is a ferromagnetic material with a high hysteresis as
shown in Figure 5.8 for the same magnetic conÔ¨Åguration of Figure 5.6.
To illustrate the hysteresis eÔ¨Äect, a not yet magnetised material is used
at the start of the cycle. In that case the magnetisation by a coil with
an increasing current will begin at the origin of the graph and ends until
saturation is achieved, like in the previous example. This initial curve on
the graph follows the virgin curve of the material, because of the not yet

368
Chapter 5. Electromechanic Actuators
w( )
H
I
w
B
c
H
	
rB
Virgin
curve
Figure 5.8: Hysteresis of a permanent magnet. After the Ô¨Årst magnetisation cycle
the material will retain some magnetic energy, resulting in a magnetic
Ô¨Åeld that is present, even when the magnetizing Ô¨Åeld caused by the cur-
rent is zero. The corresponding Ô¨Çux density Br is called the remanent
Ô¨Çux density and the negative Ô¨Åeld strength that would be required to
cancel the magnetic Ô¨Åeld due to the hysteresis, is called the coercive
Ô¨Åeld strength Hc.
magnetised material. When, after saturation, the current is reduced back
to zero, the magnetic Ô¨Åeld strength will by deÔ¨Ånition also be zero. The
magnetic Ô¨Çux density, however, remains positive until a current is applied
in the opposite, negative direction, because of the hysteresis. When this
negative current is increased, the Ô¨Çux density will follow the upper line of
the graph according to the arrows, until the material is saturated in the
opposite magnetisation direction. When the current is reversed again, the
Ô¨Çux density will follow the lower line until saturation is reached in the other
magnetisation direction again. The virgin curve will only be followed once.
For a permanent magnet only the upper left (or lower right) quadrant of
the magnetisation curve is used. Without an external magnetising Ô¨Åeld,
the Ô¨Çux density of a magnetised permanent magnet will be equal to the
remanent Ô¨Çux density Br. The Ô¨Åeld strength of the internal magnetising
Ô¨Åeld is equal to the external Ô¨Åeld strength that would be necessary to cancel
the magnetic Ô¨Åeld. The corresponding magnitude of this Ô¨Åeld strength is
called the coercive Ô¨Åeld strength Hc.
In search for ever stronger magnets, material science has delivered a wealth
of combinations of several, sometimes quite exotic, permanent magnetic
materials with very diÔ¨Äerent characteristics. Examples of the demagneti-
sation graph of three diÔ¨Äerent permanent magnet materials are shown in
Figure 5.9.
One of the graphs belongs to a magnet material that has been rather popular

5.1. Electromagnetics
369
m
B
c,f
H
	
r,f
0.35  T
B
!
m
H
m
0
m
B
H
 

r,a
1.2  T
B
!
c,a
H
	
Stabilized 
NdFeB
r,n
1.4  T
B
!
AlNiCo
Ferrites
D
Figure 5.9: Demagnetisation graph of three diÔ¨Äerent kinds of permanent magnets.
The Alnico material exhibits a curved graph with a very high remanent
Ô¨Çux density, but needs stabilisation. Magnetic material based on Fer-
rite (iron oxides) and the modern very strong material NeFeB have a
demagnetisation line parallel to Bm = Œº0Hm and retain their magnetic
properties also with occasional strong demagnetisation Ô¨Åelds to a level
of Hc.
in the past. It was an alloy of cobalt, nickel and aluminium with some other
additives, carrying trade names like Alnico and Ticonal. They showed a
large remanent Ô¨Çux density but also a curved graph. This is caused by the
Weiss domains, which already start to re-orient themselves to the negative
magnetic Ô¨Åeld, giving a relative permeability Œºr > 1. This re-orientation
of the Weiss domains becomes permanent, because of the high hysteresis
in this material, with as a result a reduced remanent Ô¨Çux density. This
property is not preferred when these materials are used in electromagnetic
actuators, which work with current carrying coils. An unintended demag-
netisation by the magnetic Ô¨Åeld of the actuator coil can rather easily lead to
a permanent demagnetisation, resulting in a less strong actuator. In the
Ô¨Ågure this is shown with the dashed line starting at point D. As soon as the
magnet is demagnetised until point D, its Ô¨Çux density will follow the dashed
line, when the external demagnetising Ô¨Åeld is reduced again. As a conse-
quence these types of magnets need to be brought to this level on purpose,
when external demagnetising Ô¨Åelds are expected. This stabilising action
is especially necessary with actuators as used in mechatronic positioning
systems, and it reduces the potential of these materials to a large extent.
It also requires that the magnets are magnetised after mounting in the

370
Chapter 5. Electromechanic Actuators
B
S            N
I
V
+
_
S                 N
Figure 5.10: A piece of permanent magnet material with a relative permeability of
Œºr = 1 creates an external magnetic Ô¨Åeld comparable with the Ô¨Åeld of
a current carrying coil in air with the same dimensions of which the
number of windings times the current equals: nI = Hc‚Ñìm.
magnetic circuit, because the high reluctance without a closing magnetic
circuit is equivalent to the presence of a high external demagnetising Ô¨Åeld.
For this reason, ideal permanent magnet materials would need to contain
Weiss domains, which orient themselves only at magnetic Ô¨Åelds with a
higher magnitude than those that are present in the magnetic circuit they
are applied in. Fortunately these materials exist, with examples like the
frequently used ferrites with iron oxides as base component and the more ad-
vanced composites of samarium-cobalt and neodymium-iron-boron (NdFeB).
In these materials the turning of the Weiss domains starts at a Ô¨Åeld strength
larger than Hc, which means that their relative permeability is equal to one
at a Ô¨Åeld strength below Hc. As a consequence, the demagnetisation curve
runs parallel to Bm = Œº0Hm.
These magnets behave like an air coil, as shown in Figure 5.10, without
the need to supply electric energy, because the relative permeability of
these materials is equal to one (Œºr = 1). From the fact that an external
Ô¨Åeld strength Hc is required to compensate the internal Ô¨Åeld strength, the
following relation can be written for the equivalent magnetomotive force of
an ideal permanent magnet:
Fm = Hc‚Ñìm = Br‚Ñìm
Œº0
[A].
(5.21)
In this equation the length ‚Ñìm of the permanent magnet is equal to the length
‚Ñìi of the Ô¨Çux path inside the equivalent coil as noted in Equation (5.13).

5.1. Electromagnetics
371
To illustrate the strength of permanent magnets it is interesting to add some
numbers to this equation. For example a permanent magnet with a Br of 1
T and a length of 10 mm is equivalent to a coil with a magnetomotive force
of Fm = 8¬∑103 A, which is 80 A in 100 windings. This clearly underlines the
value of permanent magnets as this current would require a lot of electrical
power to generate this magnetic Ô¨Åeld by a coil with the same dimensions.
Thermal Behaviour and Curie Temperature
The most important drawback of a permanent magnet, when applied in reli-
able and predictable mechatronic systems, is the temperature dependency of
its demagnetisation graph. This behaviour is caused by the Weiss domains,
which lose their hysteresis at higher temperatures. The eÔ¨Äect is directly
related to the Curie temperature Tc, named after the French physicist and
Nobel prize winner Pierre Curie (1859 ‚Äì 1906), for his investigations on mag-
netism and piezoelectricity. Above the Curie temperature all Weiss domains
become completely disoriented and the magnetic properties are lost. While
some permanent magnet materials, like the expensive SmCo alloy, have a
rather high Curie temperature with ‚âà700 ‚ó¶C, more aÔ¨Äordable modern ma-
terials like NdFeB alloy have a relatively low Curie temperature of around
300 ‚ó¶C, which limits their use to temperatures below approximately 100 ‚ó¶C.
Even at lower temperatures the magnetic properties of NdFeB alloy decrease
with a factor of around 1¬∑10‚àí3 per ‚ó¶C. Fortunately at these moderate levels
the demagnetisation is still reversible and by measuring the temperature,
the eÔ¨Äect on the magnetism can be compensated.
5.1.3
Creating a Magnetic Field in an Air-Gap
In the previous section, the method to create a permanent magnet was
explained, starting with a continuous yoke of high-hysteresis ferromagnetic
material, which was inserted in a coil, like shown in Figure 5.6. After mag-
netising that yoke, the obtained permanent magnet material would still
be rather useless as the magnetic Ô¨Åeld would remain inside the yoke with
a value Br of the Ô¨Çux density. When the permanent magnet is to be used
to create a magnetic Ô¨Åeld in an air-gap, it is necessary to create an empty
space, an air-gap inside the magnet, which the magnetic Ô¨Çux has to cross.
This can be imagined by cutting the yoke open and aligning it to a straight
magnet. The Ô¨Çux generated inside the permanent magnet will exit at the
cutting edges, the pole pieces to Ô¨Ånd a return path through the open space

372
Chapter 5. Electromechanic Actuators
Ferromagnec (iron) core/yoke
lg
Ferromagnec yoke
S            N
Ag
Am
y
g
m

 y
A
r   m

B
0
Figure 5.11: Magnetic Ô¨Åeld in the air-gap caused by a permanent magnet when
neglecting Ô¨Çux loss. The reluctance of the magnetic Ô¨Çux path is the
series connection of the reluctance of the permanent magnet, the
air-gap and the ferromagnetic yoke.
as shown in Figure 5.10.
It is obvious that this external return path for the Ô¨Çux represents a consider-
able reluctance and as a consequence the Ô¨Çux will be lower than was the case
when the magnet was still enclosed in the continuous yoke. This means that
a de-magnetising Ô¨Åeld in the opposite direction is created by the external
path that forces the Ô¨Çux density down, according to the demagnetisation
graph.
This is easier understood by using Hopkinson‚Äôs law of magnetic Ô¨Åelds again,
where the magnetomotive force of the permanent magnet creates a Ô¨Çux,
proportional to the sum of the internal and external reluctance. When the
external reluctance is zero, like when enclosed in the continuous yoke, the
Ô¨Çux is maximum at Br and only determined by the internal reluctance. As
soon as the magnet is opened with two pole pieces, the external reluctance
reduces the Ô¨Çux as mentioned before.
This all implies that by balancing the reluctance of the external Ô¨Çux path
with the internal reluctance of the permanent magnet an optimal use of the
permanent magnet material can be achieved with a suitable Ô¨Çux density
outside the permanent magnet.
As an example to create an idea about the principle, the magnetic Ô¨Åeld in
an air-gap will be calculated in a roughly approximating way to be able to
use it in a Lorentz actuator.
This standard conÔ¨Åguration to create a magnetic Ô¨Åeld in an air-gap consists
of a permanent magnet and a ferromagnetic yoke, which is used to concen-
trate the magnetic Ô¨Åeld to the air-gap as schematically shown in Figure 5.11.

5.1. Electromagnetics
373
The equivalent magnetomotive force of the permanent magnet is used to
calculate the Ô¨Çux in the circuit:
Œ¶m = F
Rt
= Br‚Ñìm
Œº0Rt
[Wb].
(5.22)
In this conÔ¨Åguration the magnetic reluctance of the complete magnetic path
equals the addition of a series of three reluctances, the internal reluctance
of the permanent magnet itself, the reluctance of the ferromagnetic yoke
and the reluctance of the air-gap.
Rt = Rm +Ry +Rg =
‚Ñìm
AmŒº0
+
‚Ñìy
AyŒº0Œºr
+
‚Ñìg
AgŒº0
A/Vs

.
(5.23)
By combining this with Equation (5.22) the following expression for the
magnetic Ô¨Çux of the permanent magnet is obtained:
Œ¶m =
BrAm
1+
Am‚Ñìy
Ay‚ÑìmŒºr
+ Am‚Ñìg
Ag‚Ñìm
[Wb].
(5.24)
In many practical situations Œºr ‚â´Am‚Ñìy/Ay‚Ñìm, which means that the equation
can be reduced to:
Œ¶m =
BrAm
1+ Am‚Ñìg
Ag‚Ñìm
[Wb].
(5.25)
The Ô¨Çux in the air-gap equals only a part of the total Ô¨Çux of the magnet. The
other part is the leakage Ô¨Çux or fringing Ô¨Çux, which follows a path outside
the useful area of the air-gap. This fringing Ô¨Çux with its corresponding
eÔ¨Éciency factor Œª is caused by the fact that all materials conduct magnetism,
even vacuum and air. Magnetic insulation is not possible and this means
that the magnetic Ô¨Åeld will seek the lowest energy situation by using all
space available. The magnitude of this eÔ¨Äect is shown in Figure 5.12 where
in the example conÔ¨Åguration a magnet with a Br of 1 T creates a Ô¨Çux density
in the air-gap of only around 0.3 T and the eÔ¨Éciency factor Œª appears to be
approximately 0.45 as can be checked by counting the Ô¨Åeld lines.
For this reason in this roughly approximating calculation the following
relation for the Ô¨Çux Œ¶g in the air-gap is allowed:
Œ¶g = BgAg = ŒªŒ¶m = ŒªBmAm
[Wb].
(5.26)
In practice the value for Œª will be between 0.25 and 0.75 depending on the
conÔ¨Åguration. Next to the shown example with Œª ‚âà0.45 two examples with a

374
Chapter 5. Electromechanic Actuators
N
S
Air
gap
 - 
Figure 5.12: Fringing Ô¨Çux reduces the useful Ô¨Çux in the air-gap. With FEM mod-
elling software this is clearly made visible in a comparable conÔ¨Ågu-
ration, as used in Figure 5.11. By counting the Ô¨Çux lines inside and
outside the gap the eÔ¨Éciency factor Œª appears to be about 0.45. More
than half of the total Ô¨Çux is lost.
(Courtesy of Ron van Ostayen)
lower and higher eÔ¨Éciency factor will be shown as soon as the mathematical
analysis is Ô¨Ånished.
When Equation (5.25) is combined with Equation (5.26) the magnetic Ô¨Çux
density in the air-gap can be calculated:
Bg =
Œ¶g
Ag
= ŒªŒ¶M
Ag
= Am
Ag
ŒªBr
1+ Am‚Ñìg
Ag‚Ñìm
=
ŒªBr
Ag
Am
+
‚Ñìg
‚Ñìm
[T].
(5.27)
This relation reads as follows by Ô¨Årst noting that the Ô¨Çux density in the air-
gap is proportional to the maximum Ô¨Çux density of the permanent magnet.
The Ô¨Çux density in the air-gap is reduced by the eÔ¨Éciency factor Œª and
further determined by the ratio between the length and cross section of the
magnet and the air-gap. The longer the air-gap with respect to the magnet,
the less Ô¨Çux density will be achieved and a larger surface of the air-gap in
respect to the magnet will also give a lower Ô¨Çux density. In the situation that
the cross sections of the magnet and air-gap are equal, like in the example,
this equation reduces to:
Bg =
ŒªBr
1+
‚Ñìg
‚Ñìm
[T].
(5.28)
In the example ‚Ñìm = 3‚Ñìg and with Br = 1 the resulting Ô¨Çux density inside the
air-gap would be equal to approximately 0.3 Tesla. More than one decimal
is not signiÔ¨Åcant in this very approximating calculation.

5.1. Electromagnetics
375
5.1.3.1
Optimal Use of Permanent Magnet Material
In Figure 5.13 it is shown that a permanent magnet with a straight demag-
netisation graph is most eÔ¨Éciently used when the external Ô¨Åeld strength
equals Hc/2 and the Ô¨Çux density equals Br/2. This is based on the magnetic
energy per unit of volume as derived in Section 5.1.1.2 which equals:
Em
V = 1
2
B2
Œº0
= 1
2 HB
J/V

.
(5.29)
Integrated over the volume of the permanent magnet Vpm, this maximum
energy level equals 0.125BrHcVpm.
When designing a magnetic circuit with permanent magnets for low cost
applications it is necessary to use the magnet material as close as possible
to this optimal working point in order to limit the necessary permanent
magnet volume. The discovery of the relatively aÔ¨Äordable Neodymium based
magnets created the possibility to realise very strong magnetic Ô¨Åelds in
less optimal designs from a magnet material usage point of view. These
conÔ¨Ågurations are applied in extreme-high performance positioning systems,
where the cost of the magnets is less dominant in respect to the overall cost.
In the following part the more optimal conÔ¨Ågurations will be presented, as
they are a good starting point for gaining further knowledge.
0.125B H = energy per volume
m
B
c
H
	
m
H
rB
12
c
H
	
12
rB
r
c
Figure 5.13: The magnetic energy per unit of magnet volume of a permanent mag-
net with a straight demagnetisation graph is maximum 0.125BrHc at
half the value of Br and Hc. When the magnetic circuit is dimensioned
such that the permanent magnet is utilised at its maximum magnetic
energy, the volume and cost of the magnetic material is minimised.

376
Chapter 5. Electromechanic Actuators
5.1.3.2
Flat Magnets Reduce Fringing Flux
In order to reduce the fringing Ô¨Çux and optimise the use of expensive magnet
materials it is often preferred to use a diÔ¨Äerent conÔ¨Åguration than the one
shown in Figure 5.11 by choosing the cross section of the magnets large
in respect to their length. It also appears to be useful to not include a
ferromagnetic part between the magnet and the air-gap as the ferromagnetic
part would determine a low reluctance path to the sides of the air-gap even
for the Ô¨Çux coming from the inner part of the magnet. This is shown in
Figure 5.14, where at the right side the eÔ¨Äect of ferromagnetic pole pieces
is shown and at the left side the optimal conÔ¨Åguration with permanent
magnets directly adjacent to the air-gap. In this conÔ¨Åguration the path
length though air is often equal to the path length through the magnets
and the Ô¨Çux density in the air-gap using Equation (5.28) becomes:
Bg = ŒªBr
2
[T].
(5.30)
When applying magnets with a Br of 1 T this second example shows a
Ô¨Çux density in the air-gap of approximately 0.4 T. The Ô¨Çux density in the
permanent magnet can be determined by using Equation (5.26) with a
eÔ¨Éciency factor Œª = 0.75, as found by counting the magnetic Ô¨Åeld lines. This
N
S
N
S
N
S
N
S
p
a
g ri
A
p
a
g
 - 
ri
A
 - 
Figure 5.14: With Ô¨Çat permanent magnets, directly interfacing the air-gap, the
fringing Ô¨Çux is kept at a minimum. Often ferromagnetic pole pieces
are suggested to spread the magnetic Ô¨Åeld more uniform, however,
as shown in the right Ô¨Ågure, this pole piece signiÔ¨Åcantly increases
the fringing Ô¨Çux, due to the low reluctance path to the edges of the
magnet. Even with a smaller air-gap the eÔ¨Éciency factor Œª reduces
from approximately 0.75 to 0.6 as can be checked by counting the Ô¨Çux
lines.
(Courtesy of Ron van Ostayen)

5.1. Electromagnetics
377
calculation results in a Ô¨Çux density of the magnet Bm of approximately Br/2,
because Am = Ag, which means that the permanent magnet is used at its
optimal energy point.
5.1.3.3
Low Cost Loudspeaker Magnet
When a very high Ô¨Çux density has to be created in a relatively small air-gap,
it is possible to concentrate the Ô¨Çux by using ferromagnetic pole pieces with
a smaller surface at the air-gap than at the surface of the magnet. Even
though this creates an increased loss it is often used with very inexpensive
magnets like the ferrites, which are usually applied in loudspeakers. The
eÔ¨Äect on the Ô¨Çux is shown in Figure 5.15.
With Equation (5.27) this concentrating eÔ¨Äect can be calculated, although
due to the high amount of fringing Ô¨Çux (Œª < 0.3), the magnet needs to be con-
siderably larger than would be the case with the Ô¨Çat magnets of Figure 5.14.
Still in this example an inexpensive magnet with a Br of 0.4 T creates a Ô¨Çux
density in the air-gap of approximately 0.7 T, which is fully acceptable when
low cost is the primary speciÔ¨Åcation and size is no issue.
In the next section the magnetic Ô¨Åeld in the air-gap is used to create a
Lorentz actuator by inserting a current conducting wire in the magnetic
Ô¨Åeld.
N
S
N
S
Air gap
 - 
Figure 5.15: Concentration of Ô¨Çux by ferromagnetic pole pieces. This rotation sym-
metric structure with a large but inexpensive magnet, as commonly
applied in loudspeakers, creates a strong magnetic Ô¨Åeld directed in
the radial direction in the air-gap. A large part of the magnetic Ô¨Çux is
however lost outside the air-gap.
(Courtesy of Ron van Ostayen)

378
Chapter 5. Electromechanic Actuators
5.2
Lorentz Actuator
Lorentz actuators are predominantly applied in high precision positioning
systems because of their inherent low mechanical stiÔ¨Äness between the
stationary and the moving part. Also the linear relation between current
and force combined with the favourable dynamic properties are important
factors. The low stiÔ¨Äness reduces the amount of external motion that is
transferred from the support structure through the actuator to the moving
part (transmissibility!). These movements can be caused by vibrations
of surrounding machines but also by the reaction forces of the actuator
itself, exciting resonances in the support structure. As will be shown later,
Lorentz actuators have also some drawbacks like the relatively modest force-
constant, which limits the maximum acceleration levels and the achievable
range of motion or ‚Äústroke‚Äù. As the name implies, the Lorentz actuator is
based on the Lorentz force only.
5.2.1
Lorentz Force
The Dutch physicist and Nobel prize winner Hendrik Antoon Lorentz (1853 ‚Äì
1928) formulated the Lorentz force as a completion to the Maxwell equations.
The law of Faraday describes the eÔ¨Äect of a changing magnetic Ô¨Åeld on
electrical charges hence generating electricity from kinetic energy. Based
on energy conservation laws creating electrical energy from motion is fully
complementary to creating motion energy from electrical energy so the laws
of Lorentz and Faraday are strongly related.
In vectorial notation the formulation of Lorentz describes the force on a
moving charged particle as:
F = q(E+v√ó B)
[N].
(5.31)
with v [m/s] equals the instantaneous velocity of the particle. The Ô¨Årst
part of the Equation qE is the electrostatic force and the second part is the
electromagnetic force. This second term is used in electromagnetic actuators.
Next to the force on a moving particle it equally represents the force on a
current Ô¨Çowing through a wire with length ‚Ñìw [m], inserted in the magnetic
Ô¨Åeld. With current deÔ¨Åned as the amount of charge passing through the
cross section of a wire over time, the total amount of charge that moves in
a wire over time equals the current times the length of the wire, qv = ‚ÑìwI.
With this relation the electromagnetic Lorentz force is equal to:
F = ‚ÑìwI √ó B
[N].
(5.32)

5.2. Lorentz Actuator
379
I
B
F
Figure 5.16: Determining the direction of the Lorentz force with the corkscrew rule.
When the corkscrew is rotated right handed, from the direction of
the positive current to the direction of the magnetic Ô¨Åeld (arrow), the
movement of the point of the corkscrew determines the direction of
the force.
For the magnetic force on a wire at an angle Œ∏ relative to the direction of a
magnetic Ô¨Åeld with Ô¨Çux density B, carrying a current I, this relation leads
to the scalar notation of the Lorentz force of electromagnetic actuators of
which the magnitude is given by:
F = BI‚Ñìw sinŒ∏
[N].
(5.33)
The direction of this force is orthogonal to the plane that is determined by
the direction of the magnetic Ô¨Åeld and the current, due to the ‚Äúcross product‚Äù
in the vectorial Lorentz equation. This rule can be remembered as the right
hand or corkscrew rule, which states that the positive force direction is
found when rotating a corkscrew from the positive current direction onto
the direction of the magnetic Ô¨Åeld as shown in Figure 5.16. Of course for a
real mechanical engineer any normal right turning screw will also suit the
purpose, but the corkscrew is more easy to remember.
In most practical cases the Lorentz force must be maximised, which means
that sinŒ∏ is kept as much as possible equal to one. Under this condition the
simpliÔ¨Åed equation becomes equal to:
F = BI‚Ñìw
[N].
(5.34)
And with multiple windings the Lorentz force becomes:
F = BIn‚Ñìw = BI‚Ñìw,t
[N].
(5.35)
where ‚Ñìw,t equals the total length of the wire inserted in the magnetic Ô¨Åeld.
When divided by the current I this equation gives the force to current ratio,
also called the force-constant k, of the actuator.
F
I = k = B‚Ñìw,t
N/A

.
(5.36)

380
Chapter 5. Electromechanic Actuators
Permanent Magnets
Flat wound coil
Magnec Field
Detail A
A
Ferromagnec yoke
F
F
Figure 5.17: Basic Ô¨Çat type Lorentz actuator. The Force F is proportional to the
current and the amount of winding length ‚Ñìof the wire in the coil
inserted in the magnetic Ô¨Åeld B. This is not a very eÔ¨Écient conÔ¨Ågura-
tion, because of the large amount of coil outside the air-gap. Detail
A shows the forces acting on a wire segment at the centre of the coil,
clearly indicating the ineÔ¨Éciency.
This clearly shows that with the force only depends on the current, the total
wire length and the magnetic Ô¨Çux density. The actuator ideally has zero
stiÔ¨Äness, because there is no direct relation with the position. This is the
main reason why a Lorentz actuator is preferred in precision positioning
systems as it reduces the transmission of vibrations from the stationary
part to the moving part. In reality some stiÔ¨Äness is always present at higher
current levels due to non-linearity and position dependency of the B‚Ñìvalue
as will be shown further on.
Figure 5.17 shows a basic Ô¨Çat type Lorentz actuator conÔ¨Åguration for il-
lustrating the principle only as it is not the best design possible. It uses
the Ô¨Çat high eÔ¨Éciency permanent magnet conÔ¨Åguration as described in the
previous section and the coil is Ô¨Çat wound and inserted partly in the mag-
netic air-gap. The force of this actuator can in principle be calculated using
Equation (5.35). The permanent magnet Ô¨Çux is directed perpendicular to
the current. When the curvature of the wires is neglected, the force equals
approximately BI‚Ñìw,t, where ‚Ñìw,t is the part of the total length of the wire
inside the air-gap. The inner windings contribute little to the force, because
of the curvature. This is shown in Detail A, which indicates the spread force
contributions along a wire segment at the centre. Only the component of
the force pointing to the right contributes to the total force.

5.2. Lorentz Actuator
381
5.2.1.1
Force from Flux-Linkage
A drawback of calculating the force with the simpliÔ¨Åed equation F = BIn‚Ñìw =
BI‚Ñìw,t is however that it too often leads to mistakes, especially with complex
structures of many coils and magnets. To illustrate this on a simple example,
an non-functional actuator is shown in Figure 5.18. The purpose of this
concept was to increase the stroke by extending the iron parts and move the
magnets and the coil together. Unfortunately no force is observed, because
the force acts between the coil with the current and the permanent magnet
Ô¨Çux. As a consequence, no force acts to the iron when the coil and the
magnets are mechanically connected.
To avoid such conceptual errors, it is preferable to work with another more
generally suitable relation, based on the change of Ô¨Çux within the windings
as function of the movement of the coil relative to the magnetic Ô¨Åeld. It uses
the concept of Ô¨Çux-linkage which represents the total amount of magnetic
Ô¨Çux that is captured inside the coil of an actuator. The derivative of the Ô¨Çux-
linkage over displacement proves to be the most accurate way to calculate
the force as can be seen from the following reasoning:
When one side of a closed winding is inserted in a magnetic Ô¨Åeld, as shown
in Figure 5.19, and it moves with a value dx relative to the permanent
magnetic system in the direction of the force, the Ô¨Çux Œ¶w inside the winding
will change according to the Ô¨Çux density and the length ‚Ñìw of the inserted
part of the winding:
dŒ¶w = B‚Ñìw dx
=‚áí
dŒ¶w
dx = B‚Ñìw
Wb/m

.
(5.37)
Using Equation (5.35), the Lorentz force and the force-constant for multiple
Permanent Magnets
Flat wound coil
Magnec Field
Ferromagnec yoke
F=0
Figure 5.18: Non operating actuator with mechanically connected magnets and
coils. The force is created between the magnetic Ô¨Çux and the current
and not between the magnet-coil combination and the iron part of the
system.

382
Chapter 5. Electromechanic Actuators
lF
I
Supply
x
dx
Figure 5.19: The Lorentz force on a current carrying coil is maximum when a
movement of the coil gives a maximum change of the Ô¨Çux-linkage.
Orthogonality leads to a maximum force.
windings can now also be written as:
F = nIB‚Ñìw = nI dŒ¶w
dx
[N]
and
F
I = k = nI dŒ¶w
dx
N/A

.
(5.38)
Using this equation it is obvious that the actuator of Figure 5.18 is not
working, because with that conÔ¨Åguration there is no change of the Ô¨Çux
through the coil as function of the displacement (dŒ¶w/dx = 0). In the following
sections on the Lorentz actuator the simple relation F = BIn‚Ñìw = BI‚Ñìw,t is
still used in this book to illustrate certain properties but with the reluctance
actuator of the next section only the Ô¨Çux-linkage method will be used. It
will then also be shown that Equation (5.38) can be derived directly from
the law of conservation of energy.
5.2.2
The Lorentz actuator as a Generator
A Lorentz actuator will not only deliver a force when supplied with a current
but it will also generate electrical power from motion based on Faraday‚Äôs
law:

L
E¬∑ dl = ‚àíd
dt

S
(B¬∑ ÀÜn) d
Wb/s

..
(5.39)
Which can be written in a simpliÔ¨Åed form for the induced voltage Vm for a
coil with n windings in a permanent magnetic Ô¨Åeld:
Vm = n dŒ¶w
dt
[V].
(5.40)
This voltage is known under diÔ¨Äerent names, counter EMF, back EMF or
motor voltage.

5.2. Lorentz Actuator
383
The terms ‚Äúcounter‚Äù and ‚Äúback‚Äù refer to the eÔ¨Äect of this voltage as it opposes
the voltage that is used to drive the actuator. This phenomenon is best
understood with a standard rotating electric DC-motor as for instance used
with the windscreen wiper in a car.
When at stand still the motor is switched on to the 12 V battery voltage a
high current will Ô¨Çow, only determined by the resistance of the coil. Due
to the high torque that is caused by the high starting current the motor
will quickly accelerate. When speeding up the counter EMF will increase
and as it opposes the 12 V battery voltage the current will reduce until the
velocity has reached ta level where the counter EMF is equal to the battery
voltage. This equilibrium velocity is almost constant and only dependent on
the friction and the battery voltage. It is true to say that the counter EMF
acts like a sensor in a velocity feedback loop.
The similarity with Equation (5.38) on the Lorentz force by Ô¨Çux linkage is
clear:
Vm = n dŒ¶w
dt
= n dŒ¶w
dx
dx
dt = k dx
dt = kvm
[V],
(5.41)
with vm being the motion velocity.
This link between force generation and electricity generation with equal
k-value can also be derived with the law of conservation of energy.
When a Lorentz actuator is driven with electrical current, the electrical
power it receives is equal to the voltage over the actuator times the current.
Assuming a static situation the current and voltage will be in phase and
the voltage on the terminals Vt will be equal to:
Vt = IRm +Vm
[V],
(5.42)
with Rm being the resistance of the motor wires.
When multiplied with the current this gives two terms, the well known
Pl = I2Rm term, which represents the dissipated energy and Pe = IVm which
is the electrical power that can only be converted into mechanical power Pe,
according to the law of conservation of energy:
Pe = IVm = Ike‚àímvm,
Pm = Fvm = km‚àíeIvm
Pe == Pm,
=‚áí
ke‚àím = km‚àíe = k
(QED).
(5.43)
This reversal of energy Ô¨Çow is less important in precision motion systems
with relatively small motion ranges than it is in transport systems, but it is
still something to keep in mind when considering the eÔ¨Äect of a Lorentz ac-
tuator in combination with diÔ¨Äerent kinds of ampliÔ¨Åers as will be presented
in Section 5.4.1.3 further on in this chapter.

384
Chapter 5. Electromechanic Actuators
5.2.3
Improving the Force of a Lorentz Actuator
In the previous section it was demonstrated that the windings of the Lorentz
actuator of Figure 5.17 are not very well utilised. While the resistive power
loss of an actuator (Pl = I2R) is directly proportional with the length of the
windings, the actuator should be designed with a maximum coverage of
the coil by magnetic Ô¨Çux density and a maximum contribution of the force
of each part of the windings in the right direction. A Ô¨Årst improvement
Permanent Magnets
Coil 
Useless windings
Ferromagnec yoke
]$
holder
Circular coil
Race track coil
F
Figure 5.20: Flat type Lorentz actuator with improved force-constant. By increas-
ing the width and adding two additional magnets like shown in the
upper drawing, the force is doubled at the same power loss in the
windings. There is also no need for a return path for the magnetic
Ô¨Åeld from the top to the bottom. The connecting holder can be made
of any material. Using an oval shape of the coil like a ‚Äúrace track‚Äù, as
shown in the lower drawing without a connecting holder, will improve
the force to power ratio even more. At the right the top part is omitted
to show the shape of the coil. (Courtesy of Sven Hol)

5.2. Lorentz Actuator
385
can be achieved by using both sides of the coil. At Ô¨Årst sight it might be
useful, to extend the permanent magnet, in order to cover the entire coil.
Unfortunately however all forces would direct to the centre of the coil and
cancel each other out. This corresponds to the fact that in that situation
dŒ¶w/dx = 0. This problem can be solved by reversing the magnetic Ô¨Åeld of
the right side of the coil where the current runs in the opposite direction of
the current in the left side. By adding two permanent magnets, magnetised
in the opposite direction of the Ô¨Årst set of magnets and widening the magnet
system, as shown in the upper drawing in Figure 5.20, the coil is almost
completely used. As a result the useful force is doubled in respect to the
Ô¨Årst example, with the same power loss in the coil. Also the return path of
the magnetic Ô¨Åeld is much shorter, which cancels the need for ferromagnetic
material in the connecting structure between the two opposing magnet
sections.
A further improvement can be achieved by changing the coil into an oval
shape as shown in the lower drawing in Figure 5.20. This is known as a race
track coil and this conÔ¨Åguration has become the ‚Äúde facto‚Äù standard in Ô¨Çat
Lorentz actuators for fast and high precision positioning systems, because
of the optimal use of the windings and the short path length of the magnetic
Ô¨Åeld that does not require a low reluctance path from top to bottom.
5.2.3.1
The Moving-Coil Loudspeaker Actuator
The most widely applied version of the Lorentz actuator is the moving-coil
loudspeaker actuator, also called a voice coil actuator, because it is applied
A
A
A - A 
Permanent Magnets
Coil 
Ferromagnec yoke
F
Figure 5.21: moving-coil loudspeaker motor with permanent magnets directly ad-
jacent to the air-gap. In the middle position the coil is fully inserted
in the magnetic Ô¨Åeld giving a maximum force-constant.

386
Chapter 5. Electromechanic Actuators
in all loudspeakers with an electromagnetic actuator. This type of actuator
is based on a fully rotation symmetric conÔ¨Åguration with a round coil, which
is inserted in a magnetic Ô¨Åeld pointing radially towards the centre of the
structure, like shown in Figure 5.15. Even though the magnetic Ô¨Åeld in the
air-gap is three dimensional the orientation is orthogonal to the current of
the windings. For this reason the approximating scalar expression for the
force can be used also in this example. A version with permanent magnets
directly adjacent to the air-gap with the coil is shown in Figure 5.21. In this
conÔ¨Åguration the coil is completely surrounded by the permanent magnet,
resulting in a maximum eÔ¨Éciency.
5.2.4
Position Dependency of the Lorentz Force
A Lorentz actuator, like the moving-coil loudspeaker type, shows a force-
constant (force to current ratio F/I), which is dependent on the position of
the coil in the air-gap. This eÔ¨Äect is shown in the red line of the graph
in Figure 5.22 and is caused by the fact that oÔ¨Äthe centre, the coil is
not completely surrounded by the same magnitude of the magnetic Ô¨Çux.
When used in a closed loop positioning system this implies a change in
the control loop ampliÔ¨Åcation (gain) and a non-linear positive or negative
stiÔ¨Äness depending on the current level and the position relative to the
centre position x0.
This can be explained as follows. Assume the coil carries a current with a
direction that corresponds to a force in the positive x direction. When the
coil is pushed by an external force Fx in the negative x direction from outside
into the air-gap, at Ô¨Årst the force needed to move the coil increases. This is
due to the increased part of the height hc,g of the coil inside the air-gap and
continues until at x0 the maximum force is reached.
As a consequence, this trajectory showed a positive stiÔ¨Äness, dF/dx ‚â•0.
When the coil is moved further in the negative x direction the force decreases
again, which corresponds to a negative stiÔ¨Äness, dF/dx ‚â§0.
5.2.4.1
Over-Hung and Under-Hung Coil
In order to reduce the position dependency of the force-constant of a Lorentz
actuator, in practice the height hg of the air-gap is chosen diÔ¨Äerent from the
height hc of the coil.
When the coil height exceeds, hangs over, the height of the gap, this conÔ¨Ågu-
ration is called an over-hung Lorentz actuator.

5.2. Lorentz Actuator
387
g
c
h
h
	
c
g
 (u) 
 (o)
h
h
x
x
0x
a: under-hung (u) 
b: over-hung (o) 
F/I(x)
hc,g(x)
x
c
g
 (u) 
 (o)
h
h
c,g
h
ch
gh
Figure 5.22: A Lorentz actuator has a limited stroke, determined by the dimensions
of the air-gap and the coil. When the coil is only partly inserted with
an eÔ¨Äective height hc,g inserted in the air-gap, the force-constant (F/I)
is reduced. By choosing diÔ¨Äerent values for the height hc of the coil
and the height hg of the air-gap, the force-constant can be made more
stable over a certain range of x. The gradual decrease of the magnetic
Ô¨Åeld (fringing Ô¨Çux) at the edges of the air-gap softens the transitions
and creates a small force even when the coil is outside the air-gap.
Its advantage is the optimal use of most of the permanent magnetic Ô¨Çux
while also the position dependency is more evenly smoothed‚Äôout.
The drawback of an over-hung actuator is the large number of coil windings
not utilised eÔ¨Äectively. In the situation, where the coil is the moving part,
this means that the moving mass is larger than without an over-hung
situation. It is a typical choice for loudspeakers where the cost of the
magnet outweighs the value of a high eÔ¨Éciency of the loudspeaker. The
amount of overhang is chosen depending on the allowed non-linearity related
distortion. For non- critical applications like loudspeakers for cars, ‚ÄúPublic-
address‚Äù in stadiums and ampliÔ¨Åcation of instruments in pop-music, little or
no overhang is applied, giving a maximum eÔ¨Éciency at elevated distortion
levels. For high-end sound reproduction, often a large over hang is chosen
to reduce distortion at a sacriÔ¨Åce on eÔ¨Éciency. This is the reason why

388
Chapter 5. Electromechanic Actuators
ampliÔ¨Åers for high-end home equipment needs to have a relatively high
output power capability.
The conÔ¨Åguration where the height of the air-gap exceeds the height of the
coil is called an under-hung Lorentz actuator. The beneÔ¨Åts and drawbacks
are just reversed. It makes best use of the coil with a resulting reduced
mass but at a relative high cost of the permanent magnetic part. The
position dependency of the force-constant is better than in the over-hung
conÔ¨Åguration, when the coil is still completely inside the air-gap, but it
worsens more rapidly as soon as the coil reaches the outer range of the
air-gap, due to its small size. An under-hung Lorentz actuator is chosen
mainly in loudspeakers, when a long stroke is not needed and low moving
mass and distortion is the primary goal. This is especially the case for mid-
to high-frequency loudspeakers, the squawkers and tweeters.
5.2.5
Electronic Commutation
The only method to increase the motion range of a Lorentz actuator where
the force-constant is really constant is achieved by combining several coils
and magnets into an electronically commutated actuator.
The principle is shown in Figure 5.23. A set of an even number of alternately
magnetised permanent magnets creates an alternating Ô¨Åeld in the air-gap.
The coil is divided in three equal separate sections, named R, S and T. In
Figure 5.22 it was shown that the force-constant B‚Ñìof each coil segment is
dependent on the position. By choosing an optimal pitch of the coil segments
relative to the pitch of the permanent magnets, the force-constant of each
coil segment becomes an almost ideal sinusoidal function of their spatial
phase œï. When the coil segments have a pitch dc equal to four third of the
pitch dm of the permanent magnets (3dc = 4dm), the spatial phase œï for each
coil as function of the position x in [m] is equal to:
œïR = 360 x0 + x
2dm
,
œïS = 360 x0 + x
2dm
‚àí120,
œïT = 360 x0 + x
2dm
‚àí240,
[¬∞], (5.44)
where x0 is one of the positions where the force-constant of the R-coil just
crosses the zero level. Note that the spatial periodicity of the permanent
magnetic Ô¨Åeld equals 2dm.
This electromagnetic conÔ¨Åguration is called a three-phase actuator. The
relation between the sinusoidal force-constant values is completely com-
parable to three-phase power distribution networks where three temporal
sinusoidal voltages with a phase diÔ¨Äerence of 120¬∞are used to transport
electrical energy.

5.2. Lorentz Actuator
389
R
S
T
m
4 d
cd
F
.
x
z,
z{5
{
{5
,
,5
2
R
S
T
Displacement x¬ä¬¢#  
F=kI  [N]
n ¬Ç){
.
n ,¬Ç{
.
n [¬É{
.
n ¬Ç){
.
n ,¬Ç{
.
n [¬É{
.
¬Ç){
.
Figure 5.23: The motion range of a Lorentz actuator where the force-constant
is hardly inÔ¨Çuenced by the position can be extended by electronic
commutation, using more coils and magnets. Each coil segment has
a force-constant that changes sinusoidal as function of the position
with a 120¬∞spatial phase diÔ¨Äerence with the other coil segments. By
changing the direction of the current at the zero force positions of each
coil (dashed), an almost constant force-constant of the total actuator
is obtained. The values are modelled for a current per coil of 1 A and
a value of (B‚Ñì)max = 1.
Note: The length of the actuator and the signal graph have a diÔ¨Äerent
x scale!
One reason to use this method is the fact that the three sinusoidal functions
add to zero at any position in the period, as can be proven by applying
trigonometry on the following function with the angle in degrees.
sin(œï)+sin

œï‚àí120

+sin

œï‚àí240

=
sin(œï)+sin(œï)cos(120)‚àísin(120)cos(œï)+
+sin(œï)cos(240)‚àísin(240)cos(œï) = 0,
(5.45)
where œï is the temporal phase (‚àùtime) for AC signals or spatial phase
(‚àùposition) for motion systems.

390
Chapter 5. Electromechanic Actuators
With power distribution this means that the average voltage of three wires
carrying these voltages is zero at any time. This prevents electromagnetic
radiation from the power lines. Another important value is the possibility
to directly drive rotating AC inductance motors for traction and machining
centres. In mechatronic positioning systems it appears to be also very useful
in long range linear motors. When all coil segments in the conÔ¨Åguration of
Figure 5.23 would get the same DC current, the resulting force would be
zero. This might seem useless, but when the current of each coil is reversed
at the exact position where the force in that segment is zero, the forces of all
three segments add to an almost constant value of two times the maximum
value of BI‚Ñìper coil section, with a variation as indicated in the Ô¨Ågure.
In rotating DC motors this current commutation process is mostly done by
means of mechanical sliding contacts, although presently this commutation
is increasingly achieved electronically in order to avoid sparking at the
commutation points and wear of the sliding contacts.
The application of electronic commutation can also help solving the problem
of the not perfect continuous force by exchanging the hard-switching by a
more continuous current change.
5.2.5.1
Three-Phase Electronic Control
By using a special three-phase ampliÔ¨Åer, which will be presented in Sec-
tion 6.3 of Chapter 6, the current to each coil segment can be controlled in
such a way that the magnitude changes with the same sinusoidal function
of the position as the force-constant. The resulting force then becomes equal
to the multiplication of the amplitude ÀÜI of the current, the amplitude of the
force-constant (B‚Ñì)max and the sine function squared. Figure 5.24 shows
the signals and forces for the same current and (B‚Ñì)max-value as was used
with the hard-switched example of Figure 5.23. For each phase the squared
sinusoidal spatial periodicity produces a force periodicity at twice the spatial
frequency of the original sinusoidal function.
F = (BI‚Ñì)max sin2 œï = (BI‚Ñì)max(0.5‚àí0.5cos(2œï)) =
= Fav ‚àíFav cos(2œï)
[N],
(5.46)
where Fav equals both the average force level and the amplitude of the
superimposed sinusoidal force level.
Figure 5.24 shows that also these three resulting sinusoidal periodic force
functions are 120 degrees separated. It can be proven with trigonometric
identities that such three phase forces add at any point to a constant force

5.2. Lorentz Actuator
391
z,
z{8
z{6
z{4
z{2
{
{2
{4
{6
{8
,
I
I
I
{
{2
{4
{6
{8
,
I   k
I   k
I   k
k=B[N\A]
I [A]
F=kI [N]
,2
,4
,6
,8
R
k
k
k
S
S
R
S
T
R
R
S
S
T
T
I   k  +
R
R
I   k  +
S
S
I   k
T
T
Displacement x¬ä¬¢#  
n¬Ç){

n,¬Ç{

n[¬É{

n ¬Ç){

n ,¬Ç{

n [¬É{

n ¬Ç){

.
.
.
.
.
.
Figure 5.24: Three-phase commutation with a sinusoidal control of the currents
in each coil segment (IR, IS, IT) in phase with their spatial sinusoidal
force-constant B‚Ñì= k values (kR,kS,kT) results in a force per segment
with a spatial frequency that is double the original spatial frequency
of the coils. The resulting total force of the three coil segments is the
sum of the values of the force in each segment and is independent of
the position.
of three times the average Force value per phase:
F = (Fav + Fav sinœï)+(Fav + Fav sin(œï+120))+(Fav + Fav sin(œï+240)) =
= 3Fav + Fav((1+cos120+cos240)sinœï+(sin120+sin240)cosœï) =
= Fav(3+(1‚àí0.5‚àí0.5)sinœï+(0.86‚àí0.86)cosœï) = 3Fav
[N].
(5.47)
For the example with 1 A current and a maximum (B‚Ñì)max value of one, the
resulting average force per phase would equal 0.5 so the combination of
three phases would give a constant force at a level of 3¬∑0.5 = 1.5 N. Even
though this force level is slightly below the level with the hard-switching
commutation of Figure 5.23, the average current is less (0.5

2) than with
hard switching, leading to less power dissipation in the wires. Combined
with the constant force and the absence of fast transients in the currents
and forces that might introduce electromagnetic interference and excite
uncontrollable eigenmodes in the mechanism, this driving method is clearly
preferred above hard switching.

392
Chapter 5. Electromechanic Actuators
5.2.6
Figures of Merit of a Lorentz Actuator
With electromotors for driving long range motion systems like trains and
rotating machines the Steepness S of the motor is widely used as Ô¨Ågure
of merit to compare diÔ¨Äerent motors on power eÔ¨Éciency. It is deÔ¨Åned as
the ratio between the squared value of the actuator force Fa and the power
dissipation Pl at that force. The squared relation in the force is chosen based
on the fact that the power dissipation is also proportional to the current
squared, which gives a clear relation of the steepness with the force-constant
k. With Pl = IR and Fa = kI the steepness equals:
S = F2
a
Pl
= k2I2
RI2 = k2
R
6
N2/W
7
=
N¬∑s/m

(5.48)
Even though this Ô¨Ågure of merit is often used, it is less useful for fast
mechatronic positioning systems, because it does not address acceleration.
For that reason at Philips Electronics another, closely related, Ô¨Ågure of merit
that includes the mass m was introduced with the development of actuators
for the CD drive like presented in Chapter 1 to compare all possible design
options. To arrive at a constant force-constant [N/A] over a stroke of about
one millimetre both under-hung and over-hung conÔ¨Ågurations were tried.
Also designs using the coil as mover and designs with moving magnets were
made. When actuating in only one or two directions the remaining degrees
of freedom must be restrained by guiding elements. Both sliding elements
and Ô¨Çexible designs are possible. Similarly one could use translation or
rotation as primary kinematic solution for the motion. Looking at all these
options, which have all been tried, it became clear that decision making was
not easy and a new criterion was needed.
The basic function of an actuator in a mechatronic positioning system is
to generate a certain acceleration of the optical element. Driving with an
increased current results in more acceleration but the penalty is a higher
dissipation. The Ô¨Ånal Ô¨Ågure of Merit was called: ‚ÄúG‚Äôs per square root of
watt‚Äôs‚Äù. How many G‚Äôs one would get per watt of power. The higher the
Ô¨Ågure the better.
If the Ô¨Ågure of merit is called Qm the relation is:
Qm =
G

watt
(5.49)
Although a bit unconventional, unscientiÔ¨Åc and at least not according to SI
units this number proved to be quite suitable and has been in use for about
10 years. When analysing the Ô¨Ågure, using the actuator design aspects, the

5.2. Lorentz Actuator
393
reason becomes clear. As a Ô¨Årst step, the Ô¨Ågure of merit is written as follows
according to SI rules:
Qm =
a

Pl
=
Fa
m

Pl
=
Fa
m

Pl
N/kgW0.5
,
(5.50)
with a as acceleration, Fa as the actuator force and Pl as the powerloss by
dissipation.
The relation with the steepness S and is clear as:
Qm =
Fa
m

Pl
=

S
m =
k

Rm
N/kgW0.5
,
(5.51)
which immediately shows the improvement relative to the steepness by
the additional mass and it makes clear that a small mass is favourable.
Furthermore a large force-constant has more eÔ¨Äect than a low resistance,
which is remarkable.
It is interesting to see how this Ô¨Ågure of merit can be translated into a
relation between diÔ¨Äerent parameters that determine a Lorentz actuator.
As a Ô¨Årst step F can be eliminated, using the simple Lorentz actuator
formula F = BI‚Ñìw,t with ‚Ñìw,t being the total length of the wires inside the
magnetic Ô¨Åeld of the permanent magnet.
Qm = BI‚Ñìw,t
m
4
Pl
N/kgW0.5
.
(5.52)
The second step is related to geometric aspects. When the part of the length
of each winding in the air-gap (active part) is called ‚Ñìw,a and the length
of the part of each winding outside the air-gap (passive part) ‚Ñìw,p and the
number of windings is n, it is allowed to say:
Qm = BIn‚Ñìw,a
m
4
Pl
N/kgW0.5
.
(5.53)
Next the dissipation can be eliminated by using Pl = I2R. Upon substi-
tution it is shown that the current is present both in the nominator and
denominator so it cancels out:
Qm = Bn‚Ñìw,a
m

R
N/kgW0.5
.
(5.54)
The resistance R is the total resistance, including the active part and the
passive part of each winding. With n windings of a resistivity œÅr and a cross
section per wire Aw, the resistance of the coil becomes:
R = nœÅr

‚Ñìw,a +‚Ñìw,p

Aw
[Œ©].
(5.55)

394
Chapter 5. Electromechanic Actuators
With Œ≥ being the Ô¨Åll factor of the windings and Ac,w the cross section of the
coil windings (bchc), the cross section per wire becomes:
Aw =
Œ≥Ac,w
n

m2
.
(5.56)
With this value the resistance equals:
R = n2œÅr

‚Ñìw,a +‚Ñìw,p

Œ≥Ac,w
[Œ©].
(5.57)
The active part of the volume of the coil within the magnetic Ô¨Åeld Vc,a
is equal to Ac,w‚Ñìw,a. When substituted together with Equation (5.57) in
Equation (5.54), this leads with a bit algebra to the following expression for
the Ô¨Ågure of merit:
Qm = B
m

Œ≥Vc,a
œÅr

‚Ñìw,a

‚Ñìw,a +‚Ñìw,p

N/kgW0.5
.
(5.58)
It is demonstrated that the actuator Ô¨Ågure, ‚ÄúG‚Äôs per square root of watt‚Äôs‚Äù has
been changed into clear understandable and far more logical engineering
choices. By maximising B,Œ≥,Vc,a and minimising m,œÅr and ‚Ñìw,p relative to
‚Ñìw,a, it became possible to realise an optimal design at such a low price that
this part of the CD player changed from a costly part as in the Ô¨Årst CD
players to the mass produced cheap commodity it is today.

5.3. Variable Reluctance Actuation
395
5.3
Variable Reluctance Actuation
The force of an electromagnetic actuator is not always linearly related to the
current like in an ideal Lorentz actuator. In general, at increased current
levels, the force will change more disproportional due to diÔ¨Äerent causes.
First of all the magnetic Ô¨Åeld of the coil adds to the magnetic Ô¨Åeld of the
permanent magnets. As a result the iron parts in the magnetic assembly
can get saturated, with as a consequence an increased reluctance with a
corresponding reduction of the magnetic Ô¨Çux by the permanent magnet.
This means that at higher current levels the force will be smaller than
expected from the linear relation F = BI‚Ñìw. An other source of non-linearity
is the direct interaction of the iron part and the coil. The coil will act as
an electromagnet, attracting the iron in a direction that is independent
of the direction of the current. This attractive force is called the variable
reluctance force, because it is related to the change of reluctance when the
coil approaches the iron, and its magnitude is proportional to the current
squared. The variable reluctance force is most often just called the reluc-
tance force. It is frequently used to create actuators as will be presented
later in this chapter but its large non-linearity is a drawback when applied
in a precision positioning system. As a Ô¨Årst step in the treatise of the reluc-
tance force, it will be examined as an unwanted eÔ¨Äect in a Lorentz actuator
with possible means to reduce it. After this analysis, the analytical force
equations of electromagnetic actuators of any type will be derived from the
law of conservation of energy. It will be followed by a presentation of the
variable reluctance actuator and the permanent magnet biased reluctance
actuator.
5.3.1
Reluctance Force in Lorentz Actuator
In precision positioning systems, the Lorentz actuator is chosen mainly in
situations where no transmissibility due to motor stiÔ¨Äness is allowed. As
was demonstrated, Lorentz actuators are not completely free of stiÔ¨Äness.
The Ô¨Årst cause for residual stiÔ¨Äness is based on the relation between force
and position and was discussed in the previous section. It represented a
non-linear stiÔ¨Äness, which can be kept at a low level by limitation of the
movement at the centre or by using electrical commutation. In case of a
short stroke actuator, the reluctance force can cause another stiÔ¨Äness fac-
tor. Figure 5.25 shows the induced Ô¨Çux by the current in the coil with an
actuator where the coil is located slightly outside the optimal position in
the middle of the air-gap. The permanent magnets are not shown, because

396
Chapter 5. Electromechanic Actuators
y
e
e
d
d
I
t

 

Ferromagnec yoke
Coil
Flux from the coil
Ring
y

y
e
f
d
d
I
t



E
Ring
F
Figure 5.25: The reluctance force in a Lorentz actuator is a force that acts indepen-
dent of the permanent magnet Ô¨Çux. It is caused by the attraction of
the iron part by the magnetic Ô¨Åeld of the coil and it is always directed
to the position with the least reluctance (unidirectional arrow). For
high frequencies this force can be reduced by a conductive ring, which
counteracts the change of the magnetic Ô¨Çux in the iron part, as shown
at the right.
the reluctance force is only determined by the ferromagnetic part.
It is clear that the reluctance of the Ô¨Çux caused by the current in the coil
is minimal when the coil is located completely inside the ferromagnetic
part. The reluctance force is related to a maximum in the magnetic Ô¨Çux as
function of the position. This means that the reluctance force on the coil is
always in the direction of the ferromagnetic part.
One way of reducing this reluctance force would be to extend the ferromag-
netic part to the right to beyond the magnets but that would increase the
mass and requires the coil holder to be longer.
5.3.1.1
Eddy-Current Ring
A second method of reducing the reluctance force is by using a conductive
ring, connected to the ferromagnetic part as shown in Figure 5.25. The
eÔ¨Äectiveness of this method is based on the variability of the Ô¨Çux from the
coil. The change of the Ô¨Çux Œ¶y inside the ring, by the current in the coil,
induces an inner Electric Ô¨Åeld Ef over the ring according to Faraday‚Äôs law.
This electric Ô¨Åeld causes the electrons to move, because the ring is closed,
resulting in a current Ie in the ring in the direction of the electric Ô¨Åeld, as

5.3. Variable Reluctance Actuation
397
explained in Chapter 2 on electricity. This current is also called an eddy-
current, because in principle it is induced in any conductive material inserted
in a changing magnetic Ô¨Åeld and it behaves like circular running currents
inside the material like the ‚Äúeddy‚Äù currents or swirl in a fast Ô¨Çowing river.
In its turn, this induced eddy-current in the ring causes a magnetic Ô¨Åeld Œ¶e
according to Amp√®re‚Äôs law in the opposite direction of the magnetic Ô¨Çux of
the coil. This means that the change of the magnetic Ô¨Çux of the coil inside
the ring is suppressed. The total Ô¨Çux inside the ring equals the integral
of the change of the Ô¨Çux over time. As the change of Ô¨Çux increases with
frequency, the reducing eÔ¨Äect of the ring on the Ô¨Çux, and correspondingly
also on the reluctance force, is most eÔ¨Äective at higher frequencies and it
is completely absent at steady state currents. This method is frequently
applied in loudspeakers, because of the limitation to higher frequencies. For
precision mechatronic systems it is however not suitable, as those require a
reliable operation, also with non-varying, steady state forces.
5.3.1.2
Ironless Stator
For those more critical applications where the linear performance is far
more important than the cost of permanent magnet material, one can decide
to entirely leave the ferromagnetic part away. Figure 5.26 shows such a con-
Ô¨Åguration, where the magnets are connected by means of non-ferromagnetic
material. A second ring of magnets has been added to compensate for the
higher reluctance of the magnetic system. The increase of the reluctance
Non-ferromagnec material
Figure 5.26: Lorentz actuator without a ferromagnetic part to cancel the reluctance
force. The return path of the permanent magnet Ô¨Çux goes only through
air.

398
Chapter 5. Electromechanic Actuators
for the permanent magnet Ô¨Çux at the outside is in the same order of magni-
tude as the reluctance of the air gap with the coil, because the longer path
length of the returning Ô¨Çux is approximately compensated by the larger
cross-section of all space around the stator. Next to the larger amount of
permanent magnet material also the presence of strong magnetic Ô¨Åelds
outside the actuator is a drawback as it can create parasitic forces to other
ferromagnetic parts in the surrounding, like bolts and screws.
This conÔ¨Åguration is used in combination with a magnetic gravity compen-
sator in a lithography wafer stage, which will be presented in Chapter 9 on
waferscanners.
5.3.2
Analytical Derivation of Reluctance Force
As will be explained with the Reluctance actuator in the next section, Equa-
tion (5.38) is not valid under all circumstances as it is limited to the situation
where dŒ¶w/dx only depends on the permanent magnet and not on the current.
This means that it is necessary to use a diÔ¨Äerent approach to determine the
total force that acts on an electromagnetic actuator including the reluctance
force. A suitable method is based on the law of conservation of energy in a
closed system. In an electromagnetic actuator, electrical energy is converted
in three diÔ¨Äerent kinds of energy:
1. Useful mechanical energy (work).
2. Stored magnetic energy.
3. Heat loss.
In Figure 5.27 the electrical equivalent circuit diagram of an electromagnetic
actuator is shown, with a current source as the electric power input, a
magnetic potential energy storage, represented by the self-inductance L in
[H], a resistive element R in [Œ©], which represents the dissipative thermal
power output and the motor voltage Vm in [V], which is related to the velocity.
The self-inductance was introduced as a type of dynamic property of an
impedance in Section 2.3.2.4 of Chapter 2. It was shown that the relation
between the voltage and the current in a self-inductance is equal to:
VL = L dI
dt
[V].
(5.59)
It is to be expected that the self-inductance is determined by the dimensions
and magnetic properties of the coil. In terms of number of windings and

5.3. Variable Reluctance Actuation
399
I
R
L
Vm
Va
VL
VR
+
_
+
_
+
_
I
w

w
f
d
d
     
t


E
+
_
L
2
d
d
I
V
L t
n
L

 
Inductor L with n windings
+
_
Figure 5.27: Electrical equivalent circuit diagram of an electromagnetic actuator.
The resistor R represents the resistivity of the windings and induced
eddy-current losses, the inductor L represents the stored magnetic
energy in the self-inductance and the voltage source Vm is the induced
voltage by the velocity.
reluctance, this relation can be derived with Hopkinson‚Äôs law of magnetics
and is written as follows:
L =
Œ¶w,t
I
= nŒ¶w
I
= n nI
IR = n2
R
[H].
(5.60)
The implicit consequences of the self-inductance of a coil in the dynamic
domain will be presented further in Section 5.4.1. In the present section it
will be used to calculate the reluctance force in a Ô¨Åve step approach based
on the law of conservation of energy.
Step 1: Power input
Using the equivalent circuit diagram of Figure 5.27, at any moment in time
the electrical power is equal to:
Pin(t) = Va(t)I(t)
[W].
(5.61)
For simpliÔ¨Åcation the time dependency term (t) is omitted in the further
derived equations.
The total voltage Va consists of three parts determined by the diÔ¨Äerent
elements of the equivalent circuit diagram:
Va = VR +VL +Vm
[V].
(5.62)

400
Chapter 5. Electromechanic Actuators
The voltage over the resistor equals:
VR = IR
[V].
(5.63)
The induced voltage over the self-inductance due to the change of the current
equals:
VL = L dI
dt
[V].
(5.64)
The motion voltage is the induced voltage due to the change of the Ô¨Çux by
the movement only. In fact the change of the Ô¨Çux Œ¶w consists of two parts.
One part is related to a change in the current in the coil and matches with
the self-inductance. The other part is related to a change in the position:
Vm = n‚àÇŒ¶w
‚àÇx
dx
dt
[V].
(5.65)
so that:
Pin = I2R + IL dI
dt + nI ‚àÇŒ¶w
‚àÇx
dx
dt
[W].
(5.66)
Step 2: Energy storage
Energy can be stored in only one element, the self-inductance. The stored
magnetic energy as function of time of an inductive impedance as derived
in Section 6.1.2.3 of Chapter 2 is equal to:
EL(t) = 1
2 L(x(t))I(t)2
[J],
(5.67)
when the self-inductance is variable as function of the position x(t) and the
current I(t).
The total power Ô¨Çowing into this storage element at any moment in time
equals the time derivative of this energy:
Pstorage = d
dt (EL)
= IL dI
dt + 1
2 I2 dL(x(t))
dt
[W].
(5.68)
Step 3: Power output
Power can exit the system in only two ways: useful as mechanical power or
useless as dissipated heat.
Pout = Pdiss + Pmech
[W].
(5.69)
The dissipated heat equals:
Pdiss = I2R
[W].
(5.70)

5.3. Variable Reluctance Actuation
401
The mechanical power is determined in the next step.
Step 4: Power balance
The total power balance is equal to:
Pstorage = Pin ‚àíPout
=‚áí

IL dI
dt + 1
2 I2 dL(x(t))
dt

=

I2R + IL dI
dt + nI ‚àÇŒ¶w
‚àÇx
dx
dt

‚àí
<
I2R + Pmech
=
.
(5.71)
After some elimination of terms, the mechanical output power equals:
Pmech = nI ‚àÇŒ¶w
‚àÇx
dx
dt ‚àí1
2 I2 dL(x(t))
dt
[W].
(5.72)
Step 5: Force
Mechanical power is delivered when a force is exerted during motion:
Pmech = Fv = F dx
dt
[W].
(5.73)
or
F = Pmech
dt
dx
= nI ‚àÇŒ¶w
‚àÇx ‚àí1
2 I2 dL(x)
dx
[N].
(5.74)
In this equation the Ô¨Årst term is the linear relation of the force to the current.
The second term is the non-linear, squared relation of the force to the current
and is caused by the magnetic energy that is stored in the self-inductance.
In the Lorentz actuator of Section 5.3.1.2 Œ¶w is mainly determined by the
permanent magnet and the self-inductance is independent of the position
because there is no surrounding ferromagnetic material that can inÔ¨Çuence
the reluctance of the magnetic Ô¨Åeld from the coil. In that conÔ¨Åguration
the second term is zero and the general equation reduces to the previously
derived Equation (5.38), which relates the force to de derivative of the Ô¨Çux
linkage.
F = nI dŒ¶w
dx
[N].
(5.75)
In the following it will be shown that for a reluctance actuator without any
permanent magnets the situation is quite diÔ¨Äerent, because in that case the
second term becomes exactly half of the Ô¨Årst term, which means that half
the useful electrical energy (excluding resistive losses) is used to ‚Äúcharge‚Äù
the coil with magnetic energy and only the other half is used for mechanical
energy.

402
Chapter 5. Electromechanic Actuators
5.3.3
Variable Reluctance Actuator.
An example of an actuator working only on the reluctance force is the
(variable) reluctance actuator as shown in Figure 5.28 in two versions, the
C-core version with two legs and the E-core version with three legs. The
beneÔ¨Åt of the E-core version is the possibility to create a fully rotationally
symmetric conÔ¨Åguration with the coil hidden in the cup.
I
w

I
x
dx
g

y,s

w

 g
A
 g
A
y,m

mover
stator
n
C-core  
 
 
 
 
 
 
 
 
 
E-core
 g
 g
0.5A
 g
A
0.5A
F
F
Figure 5.28: The variable reluctance actuator only works by the principle of the
reluctance force. The mover is attracted (minus sign) to the stator
with a force ‚àíF proportional to the current squared and inversely
proportional to the distance squared. Two versions are shown in the
drawing on top, the C-core at the left and the E-core at the right. A
rotation symmetric version of the E-core coil section is shown in the
picture at the bottom. The circularly wound coil (in black) is embedded
in an iron shell.

5.3. Variable Reluctance Actuation
403
The principle is most widely applied in a standard electromagnet, consisting
of a current-carrying coil around a ferromagnetic yoke. This electromagnet
attracts other pieces of ferromagnetic material and many people know it
from the James Bond movie ‚ÄúYou only live twice‚Äù where a helicopter with
a powerful magnet pulls-up2 a car with bad guys and drops it in the sea,
including its unfortunate passengers.
To calculate the force, Equation (5.74) is used on the C-core version, where
the relative movement of the mover to the stator equals dx:
F = nI ‚àÇŒ¶w
‚àÇx ‚àí1
2 I2 dL(x)
dx
[N].
(5.76)
In this case, without a permanent magnet, ‚àÇŒ¶w/‚àÇx is only determined by the
current and directly related to the self-inductance, which in its turn is only
a function of the position:
‚àÇŒ¶w
‚àÇx = d
dx
LI
n
Wb/m

.
(5.77)
Now these two equations combine to:
F = I2 dL(x)
dx
‚àí1
2 I2 dL(x)
dx
= 1
2 I2 dL(x)
dx
[N].
(5.78)
The self-inductance is determined by the series reluctance of the two ferro-
magnetic parts, the stator and the mover, with a total length ‚Ñìy = ‚Ñìy,s +‚Ñìy,m
and the two air-gaps with a total length of 2‚Ñìg, because the magnetic Ô¨Çux
has to cross the air-gap twice.
L = Œ¶t
I =
n2
Rc +Rg
=
n2
‚Ñìy
AyŒº0Œºr
+ 2‚Ñìg
AgŒº0
[H].
(5.79)
With Œºr ‚â´1 and relative large values of ‚Ñìg, this can be approximated3 into:
L ‚âàn2 AgŒº0
2‚Ñìg
[H].
(5.80)
With this value for the self-inductance, Equation (5.78) with x = ‚Ñìg gives
after a bit of algebra:
F ‚âà‚àí

 nI
‚Ñìg
2 Œº0Ag
4
[N].
(5.81)
2The author challenges the reader, after examining this chapter, to determine whether
this movie-scene is realistic, taking into account the required force, the electric power, the
reluctance of the car and magnetic saturation of the iron roof.
3Later it will be shown that this approximation can cause large errors with high levels of
Ô¨Çux density and small values of ‚Ñìg!

404
Chapter 5. Electromechanic Actuators
The minus sign indicates that the force on the mover is directed in the
negative x direction. This corresponds to the known ‚Äúpulling‚Äù direction of
an electromagnet. It is also clear from this equation that the reluctance
actuator is extremely non-linear. First of all the force only works in one
direction and the force-constant increases with higher currents. But also the
dependence on a movement in the x direction is high and non-linear, which
implies a signiÔ¨Åcant stiÔ¨Äness. At a certain current level the magnitude of
the force decreases when the displacement increases. This means, that the
actuator has a negative non-linear stiÔ¨Äness. When saturation eÔ¨Äects are
neglected, an inÔ¨Ånitely small gap could create an inÔ¨Ånite force. In reality
the Ô¨Çux density is limited to the saturation of the applied ferromagnetic
material, which corresponds for ferromagnetic (soft) iron to a value in the
order of 2 T (Note the James Bond example!). The resulting force can then
be calculated with the equations of the next section.
5.3.3.1
Electromagnetic Relay
Figure 5.29 shows a physical model of an electric relay, which uses the
squared force relation of the reluctance force to switch electrical currents. It
consists of a reluctance actuator of which the mover is elastically connected
to the stator via a hinge. The elastic hinge is pre-stressed, keeping the
mover in the ‚Äúopen‚Äù position. An increasing current in the coil will give a
reluctance force that above a certain current level will equal the pre-stress
force. As a result the mover will start moving towards the stator, thereby
decreasing the air-gap, giving an increased force and fully closing the mover.
This non-linear avalanche eÔ¨Äect results in a fast, strong and reliable closure
of the electrical contacts that are mounted between the mover and stator.
I
Elasc hinge
Figure 5.29: An electromagnetic relay is a bistable system, in which the non-
linearity of the reluctance force is used to create a reliable contact.

5.3. Variable Reluctance Actuation
405
5.3.3.2
Magnetic Attraction Force
The magnetic Ô¨Çux density Bg in an air-gap between a magnetic source and a
ferromagnetic part can be related to the attraction force between these two
parts. This analysis could be done by diÔ¨Äerentiating the magnetic energy
over the change of distance, using Equation (5.16) and the deÔ¨Åned values in
Figure 5.30:
ŒîE = ‚àíFŒîx
‚áí
F = ‚àídEm
dx
= ‚àíd
dx
1
2Œ¶2
wR = ‚àí1
2Œ¶2
w
dR
dx
[N].
(5.82)
The minus sign indicates that the force is directed to the minus x-direction
while the magnetic energy increases by a displacement of the mover in the
positive x-direction. This diÔ¨Äerentiation gives the force in the system at a
certain position when the Ô¨Çux is calculated before with Hopkinson‚Äôs law.
As an alternative, the derived force equation for the reluctance actuator
from Section 5.3.3 allows to directly relate the force to the Ô¨Çux density.
The resulting relation between Ô¨Çux density and force is equally valid for
the magnetic Ô¨Åeld created by another source, like a permanent magnet.
This can be reasoned with the help of Figure 5.30. In the situation that
the permanent magnets at the right side of the Ô¨Ågure cause the same Ô¨Çux
density as the current in the left side of the Ô¨Ågure, the movers will experience
exactly the same magnetic Ô¨Çux, which means that the related force should
also be the same. The derivation of this relation starts with the relation
between the magnetic Ô¨Çux density in the air-gap and the magnetomotive
I
x
dx
g

y,s

w

 g
A
 g
A
y,m

mover
stator
F
dx
g

y,s

w

 g        m
A =A
y,m

F
N
N
S
S
m

 g        m
A =A
Figure 5.30: The attraction force between two parts of a magnetic system consisting
of a magnetic source and a piece of ferromagnetic material is propor-
tional to the squared value of the Ô¨Çux density that crosses the interface
between the ferromagnetic mover and the magnetic stator (dashed
horizontal line), independent of the source type of the magnetic Ô¨Çux.

406
Chapter 5. Electromechanic Actuators
force, using Hopkinson‚Äôs law:
Bg = Œ¶w
Ag
= Fm
RAg
=
nI
RAg
[T].
(5.83)
With the reluctance actuator the reluctance can be approximated by the
reluctance in the two air gaps:
R ‚âà2‚Ñìg
Œº0Ag
A/Vs

.
(5.84)
This gives with Equation (5.83):
Bg ‚âànIŒº0
2‚Ñìg
‚áíFm = nI ‚âà2Bg‚Ñìg
Œº0
[T].
(5.85)
This can be combined with Equation (5.81):
F ‚âà‚àí

 nI
‚Ñìg
2 Œº0Ag
4
‚âà‚àí

2Bg‚Ñìg
Œº0‚Ñìg
2 Œº0Ag
4
‚âà‚àí
B2
gAg
Œº0
[N].
(5.86)
The total gap surface is 2Ag so a magnetic Ô¨Çux density B causes an equivalent
virtual pulling ‚Äúpressure‚Äù Pm of:
Pm ‚âà
F
2Ag
‚âà‚àí
B2
g
2Œº0
[Pa].
(5.87)
This means for example that a magnetic Ô¨Çux density of 1 T creates a pulling
force per unit of surface (negative pressure) of:
P1T ‚âà‚àí
1
8œÄ¬∑10‚àí7 ‚âà‚àí0.4¬∑106 Pa.
This equals a negative pressure of 4 times vacuum, which is the reason why
permanent magnets are often used for a contact-less pre-load of air-bearings.
Forces between Permanent Magnets
The above calculations are not valid when the mover also contains a mag-
netic source, because the mutual interaction between the two sources is
neglected when only considering reluctance variations. As example one can
think of the interaction between two separate permanent magnets without
ferromagnetic material, which will attract or expel each other, depending
on their orientation. With the constant reluctance of the surrounding air
this force can only be explained from the Lorentz force, when imagining
the magnets as current carrying coils. Each coil will perceive a Lorentz
force by the magnetic Ô¨Åeld from the other coil. Analytic calculations would
rapidly become very complex due to the 3-dimensional problem and accurate
calculations of the force can only be obtained by Ô¨Ånite element numerical
methods using the Maxwell equations.

5.3. Variable Reluctance Actuation
407
5.3.4
Permanent Magnet Biased Reluctance Actuator
It is valuable to investigate how a reluctance actuator can be made suitable
for controlled positioning systems in order to beneÔ¨Åt from the high force-to-
current ratio in conÔ¨Ågurations where a very small air-gap is allowed. The
Ô¨Årst problem to solve is the unidirectional force.
5.3.4.1
Double Variable Reluctance Actuator
The limitation by the unidirectional force can either be solved by providing
a passive force in the other direction by means of a spring or by combining
two reluctance actuators into one actuator, like shown in Figure 5.31.
This conÔ¨Åguration proves to be a very interesting system as will follow
from the calculations. First of all the force on the central mover equals
the diÔ¨Äerence of the forces of each actuator. In the previous example of
the single reluctance actuator the positive x direction was deÔ¨Åned from the
stator upwards to the mover resulting in a minus sign for the force. In this
example the positive x direction is deÔ¨Åned in the right direction as shown
in the picture. This means that the force, acting on the mover by the left
actuator half (F1), has a negative sign and the force by the right actuator
half (F2) has a positive sign. Using Equation (5.81) twice, for each half of
C2
C1
I1
x
I2
dx
g,2

g,1

F
F1
F2
Figure 5.31: A double reluctance actuator with a central mover shows a linear
current to force relationship in the middle position. This is caused by
the balancing of the force of the two non-linear actuators.

408
Chapter 5. Electromechanic Actuators
the actuator, the total force becomes:
F = F2‚àíF1 =

 nI2
‚Ñìg,2
2 Œº0Ag
4
‚àí

 nI1
‚Ñìg,1
2 Œº0Ag
4
= n2Œº0Ag
4
,
I2
2
‚Ñì2
g,2
‚àí
I2
1
‚Ñì2
g,1
-
[N]. (5.88)
This shows as a Ô¨Årst conclusion that in the mid position, where ‚Ñìg,1 = ‚Ñìg,2,
the force is zero when the currents are equal. As a next step it is interesting
to see what happens if the currents in both halves are modulated, while
keeping the sum of the currents constant. This means that current I1
becomes Ia ‚àíŒîI and current I2 becomes Ia + ŒîI, while Ia is the average
current.
The calculations start with Equation (5.88), with the mover in the mid
position, ‚Ñìg,1 = ‚Ñìg,2 = ‚Ñìg.
F = n2Œº0Ag
4
,
I2
2 ‚àíI2
1
‚Ñì2g
-
[N].
(5.89)
With I1 = Ia ‚àíŒîI and I2 = Ia +ŒîI the force becomes:
F = n2Œº0Ag
4
,
(Ia +ŒîI)2 ‚àí(Ia ‚àíŒîI)2
‚Ñì2g
-
= n2Œº0Ag
4
,
4IaŒîI
‚Ñì2g
-
[N].
(5.90)
With this result, the force to current ratio or force-constant k of this actuator
for the current change ŒîI can be written as:
k = F
ŒîI = Ian2AgŒº0
‚Ñì2g
N/A

.
(5.91)
This means that the force-constant is depending on the level of the current
that is common for both halves. It gives the possibility to control the diÔ¨Äer-
ential gain by this common current level! The second conclusion is that the
force is linearly related to the diÔ¨Äerential current at the same mid-position!
This means that this actuator can be used in a linear control system with
a separately controllable gain. Unfortunately this is only the case at the
mid position. At other positions the actuator half with the smallest gap will
dominate the other half, and the linearity gradually disappears. Still for
small displacements with a high force this conÔ¨Åguration can be useful.
Another drawback of this conÔ¨Åguration is the negative stiÔ¨Äness, which de-
pends on the common current. This eÔ¨Äect can be explained from the fact
that at any position away from the mid-position the mover will mainly be
attracted to the position where it is closest to the stator. This makes this
actuator less suitable for situations, where a direct coupling between stator
and mover is undesired like in a vibration isolation system. In principle this
negative stiÔ¨Äness can be compensated with the positive stiÔ¨Äness of a me-
chanical spring, but in practice it is diÔ¨Écult to achieve a reliable reduction
of more than a factor 10 due to tolerances.

5.3. Variable Reluctance Actuation
409
5.3.4.2
Constant Common Flux
With the reluctance actuator it was shown that by combining two reluctance
actuators the actuator can be linearised by providing it with a common
current for both halves. This principle has as drawback that a DC current
will contribute to the power losses in the actuator and also the negative
stiÔ¨Äness is quite large. It is a logical step to replace the Ô¨Çux created by this
common mode current by the Ô¨Çux of a permanent magnet and thus combine
the best of both worlds: the high force of the reluctance actuator with the
linearity of the permanent magnet actuator.
To create such a permanent magnet biased or hybrid reluctance actuator
it is necessary to carefully consider the working principle of the double
reluctance actuator as explained previously. The force was shown to be
equal to the multiplication of the Ô¨Çux related to the common current and
the Ô¨Çux related to the diÔ¨Äerential current because of the squared relation
between force and current. This means that a perfectly linear very strong
actuator can only be obtained when the constant Ô¨Çux is really constant,
independent of the position of the mover. Further it is preferred that the
permanent magnet does not introduce a signiÔ¨Åcant additional reluctance to
the Ô¨Çux from the current in the coil as this will decrease the force-constant.
In the following section it is shown how this can be achieved.
C2
C1
I1
C2
C1
I1
I2
I2
dx
dx
F
F
Figure 5.32: The Ô¨Çux in the double reluctance actuator can be changed by inverting
the current direction in one of the coils. This inversion has no inÔ¨Çuence
on the forces, because of the squared relation in the reluctance force.
Nevertheless the Ô¨Çux path is completely changed. This creates the
possibility to change the material properties of the mover without
impacting the reluctance force.

410
Chapter 5. Electromechanic Actuators
5.3.4.3
Combining two Sources of Magnetic Flux
The Ô¨Årst step is to be aware that the double reluctance actuator of Figure 5.31
works independent of the current direction in the coils due to the squared
relation between current and force. Though it has no impact on the force, the
Ô¨Çux is diÔ¨Äerent if the current in one coil is reversed as shown in Figure 5.32.
If the Ô¨Çux in both coils is in the same direction (upwards or downwards) the
Ô¨Çux of both coils has to Ô¨Çow back vertically through the mover. When the
current in one of the coils is reversed, as shown in the right picture, the Ô¨Çux
of both coils share the same path, which only crosses the gap. The vertical
path in the mover is avoided, which means that the middle part of the mover
can be replaced by another non-ferromagnetic element like a permanent
magnet. This conÔ¨Åguration creates a strong actuator as described by Lu
and Trumper from the Precision Motion Control Laboratory at MIT for use
in a fast tool servo for an optical machining centre [60], [61]. This is shown
in Figure 5.33 where the Ô¨Çux of the permanent magnet perfectly combines
with the induced Ô¨Çux of the current without adding additional reluctance
to the latter. In the right picture a simpliÔ¨Åed version is shown where one
side of the mover is connected to the stator by means of an elastic hinge,
which enables rotation in combination with a low reluctance path for the
permanent magnet Ô¨Çux. This elastic hinge can be used to partly compensate
the still not completely avoidable inherent negative stiÔ¨Äness of the actuator
as will be explained later.
C2
C1
I1
PM
I2
C2
C1
PM
I2
Elasc hinge
I1
x
x
dx
dx
N
S
N
S
F
F
Figure 5.33: By inserting a permanent magnet in the mover of the double reluctance
actuator, an additional Ô¨Çux is created, replacing the Ô¨Çux that was
generated by the average current of the original double reluctance
actuator. This replacement strongly reduces the power consumption
of the actuator.

5.3. Variable Reluctance Actuation
411
Figure 5.34: The permanent magnet Ô¨Çux division in a hybrid actuator depends on
the position of the mover.
It is clear that the permanent magnet creates an unstable situation because
the magnetic circuit has its lowest reluctance at one of the two positions
as shown schematically in Figure 5.34. With the mover in the middle
position the Ô¨Çux is equally divided over the two half‚Äôs of the actuator and the
attraction force in both air-gaps cancel each other out. As soon as the mover
moves in one of the two directions the Ô¨Çux will increase in that half and
decrease in the other, which will cause the negative stiÔ¨Äness. Figure 5.35 is
used to calculate the Ô¨Çux of the permanent magnet. While the reluctance
for each gap is proportional to their length x, the total reluctance of both
gaps combined is calculated by taking the reluctance of both gaps in parallel
according to the following relation.
1
R = 1
R1
+ 1
R2
Vs/A

.
(5.92)
With dx the displacement of the mover, ‚Ñìg,1 = ‚Ñìg + dx and ‚Ñìg,2 = ‚Ñìg ‚àídx being
the length of both gaps, Ag the cross section of the gaps perpendicular to
the Ô¨Çux and the ferromagnetic material having an inÔ¨Ånite Œºr, the following
equation is obtained:
R =
1
Œº0Ag

1
‚Ñìg + dx +
1
‚Ñìg ‚àídx
 =
‚Ñì2
g ‚àí(dx)2
2Œº0Ag‚Ñìg
A/Vs

.
(5.93)
Around the mid position with dx ‚â™‚Ñìg, this reluctance is approximately con-
stant but at the outer positions this causes the total reluctance to decrease.
This leads to a higher Ô¨Çux and stronger negative stiÔ¨Äness, however to a
lesser extent than with the double reluctance actuator from the previous
section. This is caused by the fact that the reluctance of the permanent
magnet Ô¨Åeld is dominated by the permanent magnet material itself, which
limits the Ô¨Çux density to below Br. Remember that a modern permanent

412
Chapter 5. Electromechanic Actuators
Coil 1
Coil 2
Flux increase
Flux decrease
I2
n
n
I1
x
Ag
N
dx
g,2

g,1

S
F
Figure 5.35: The Ô¨Çux in a hybrid actuator is a combination of the Ô¨Çux of the per-
manent magnet and the Ô¨Çux of the coils. In one air-gap the Ô¨Çux of
the coils has the same direction as the Ô¨Çux of the permanent magnet,
increasing the total magnetic Ô¨Åeld, while at the other air-gap it is
just opposite. This results in a strong net force in the direction of the
strongest magnetic Ô¨Åeld.
magnet acts like an air coil with a very large current. With the reluctance
actuator a small gap will lead to a steep increase of Ô¨Çux density, which
would only be limited by the saturation. It can more easily be compensated
by a positive spring, which in this conÔ¨Åguration is determined by the elastic
hinge, because of this lower and more linear negative stiÔ¨Äness of the hybrid
actuator. In Figure 5.35 the eÔ¨Äect of a current through the coils is shown.
The Ô¨Çux from each coil will follow the path of lowest reluctance, according
to the yellow arrows, showing that it will not pass the permanent magnet
but go round in the ferromagnetic part. As mentioned the winding direction
of the coils is such that their Ô¨Çuxes positively add together.
Depending on the current direction, the combination of the Ô¨Çux of the coils
with the Ô¨Çux of the permanent magnets results in a lower Ô¨Çux density in one
air-gap and a higher Ô¨Çux density in the other air-gap, causing an attracting
force in the direction of the increased Ô¨Çux density. As this happens in two
directions, the force is depending on the current direction and the eÔ¨Äect is
linearised according to the same reasoning as with Equation (5.91) for the
double reluctance actuator.

5.3. Variable Reluctance Actuation
413
5.3.4.4
Hybrid Force Calculation
In order to approximate the magnitude of the force, Ô¨Årst Equation (5.74),
the general equation of electromagnetic actuators is applied.
F = nI dŒ¶w
dx ‚àí1
2 I2 dL(x)
dx
[N].
(5.94)
The self-inductance of the coils is hardly inÔ¨Çuenced by the position of the
mover because the reluctance of the coils consists of the reluctance of the
two air-gaps in series.
R = R1 +R2
A/Vs

.
(5.95)
When one gap gets smaller the other gets bigger so the second term can be
neglected and the known relation from the Lorentz actuator is used:
F = nI dŒ¶w
dx
[N].
(5.96)
In this equation it is necessary to replace n by 2n because the Ô¨Çux of the
windings of both coils are added together as they are working in the same
direction. The Ô¨Çux through the windings Œ¶w consists of the Ô¨Çux of the per-
manent magnet and the Ô¨Çux caused by the current through the coils. Under
condition of a non-saturated iron part, as mentioned in Equation (5.95), the
Ô¨Çux caused by the current is determined by the reluctance of the air-gaps
in series. The total reluctance of these gaps is equal to:
R =
‚Ñìg,1 +‚Ñìg,2
Œº0Ag
A/Vs

.
(5.97)
This is a constant because the sum of both gap lengths is constant. This
means dŒ¶w/ dx is only determined by the permanent magnet Ô¨Çux. The
force can be approximated by taking the two extreme positions when the
mover is just hitting the stator. In both situations the iron determines a
low reluctance path for the permanent magnet, which means that the Ô¨Çux
density Bm of the permanent magnet will approach Br. So by changing the
position from one side to the other the average Ô¨Çux changes approximately
from zero to BrAm. This gives:
dŒ¶w
dx =
BmAm
‚Ñìg,1 +‚Ñìg,2
‚âà
BrAm
‚Ñìg,1 +‚Ñìg,2
Wb/m

.
(5.98)
With the two equal coils (2nI) this results in an estimated force-constant4 k
of:
k = F
I ‚âà2n dŒ¶w
dx ‚âà2n
BrAm
‚Ñìg,1 +‚Ñìg,2
N/A

.
(5.99)
4Here the current (I) represents the variable current to control the force in a position
controller. It is comparable with the ŒîI from Equation (5.91)

414
Chapter 5. Electromechanic Actuators
Like all actuators, also the hybrid actuator has a position dependency of the
force, not only related to the mentioned negative stiÔ¨Äness, but also due to
the position dependent force-constant. In the hybrid actuator this second
eÔ¨Äect is caused by the changing total reluctance of the permanent magnet
circuit as function of the position. As discussed earlier, the reluctance for
the permanent magnet at the mid position equals the reluctance of the
two air-gaps in parallel. In the outer positions one of the air-gaps is very
small, resulting in a lower total reluctance. This means that the Ô¨Çux of the
permanent magnet increases at the outer positions, giving a higher value
of dŒ¶w/dx than in the mid position.
It is clear that these calculations are very approximative due to the complex
nature of the system, with potential saturation of the iron part and the
approximation of the permanent magnet Ô¨Çux in the extreme positions.
To check this approximation, the force in the mid position can be calculated
in another way, by means of Equation (5.87) with the cross section of the
air-gaps and an estimation of the Ô¨Çux of the permanent magnet.
Like with the double reluctance actuator two counteracting forces are com-
bined. The force in air-gap 1 works in the negative x direction and the force
in air-gap 2 in the positive x direction. The Ô¨Çux density in the air-gaps (Bg)
equals the combination of the Ô¨Çux density by the permanent magnet (Bg,m)
and the Ô¨Çux density caused by the coil (Bg,c). With the current direction as
deÔ¨Åned in Figure 5.35 the total Ô¨Çux density in air-gap 1 equals Bg,m +Bg,c
and in air-gap 2 it equals Bg,m ‚àíBg,c and the following equation is obtained:
F = F2 ‚àíF1 = Ag
2Œº0
(Bg,m ‚àíBg,c)2 ‚àíAg
2Œº0
(Bg,m +Bg,c)2
= ‚àí2AgBg,mBg,c
Œº0
[N].
(5.100)
The minus term is due to the fact that a positive current in the shown
direction results in a force on the mover to the left, which is the negative x
direction.
In case the air-gap cross section is large with respect to the length of the
air-gap, the leakage Ô¨Çux will be moderate (Œª > 0.80). With a well designed
system, the Ô¨Çux density of the magnet is chosen to be Br/2 and the Ô¨Çux is
divided over two halves, which means that a Ô¨Çux density in each gap is
equal to:
Bg,m = 0.8¬∑Br
2
Am
2Ag
[T].
(5.101)

5.3. Variable Reluctance Actuation
415
When the reluctance of the air-gaps is large in comparison with the reluc-
tance of the ferromagnetic parts, the Ô¨Çux induced by the current equals
(two coils with n windings!):
Bg,c = Œ¶w
Ag
= 2nI
AgR =
2nIŒº0
‚Ñìg,1 +‚Ñìg,2
[T].
(5.102)
Combining these equations for Bg,m and Bg,c with Equation (5.100) gives the
following force-constant k of the hybrid actuator:
k = F
I = 0.8n
BrAm
‚Ñìg,1 +‚Ñìg,2
N/A

.
(5.103)
When this result is compared with Equation (5.99) it clearly shows more
than a factor two decrease of the force in the mid position, which is caused
by the reluctance of the air-gaps for the permanent magnet Ô¨Çux and the
choice to use as little as possible magnet material (Bm = Br/2). In practical
designs often a larger magnet is chosen, which brings the force to a higher
value and reduces the position dependency of the force-constant because
the Ô¨Çux density will be more constant closer to Br.
It can also be concluded that with increasing complexity of the magnetic
circuit the need for more exact calculations using FEM computer simulations
is more strong. Nevertheless the presented calculations provide a good sense
for the order of magnitude the real forces in a practical actuator.
5.3.4.5
Magnetic Bearings
A nice application example of a hybrid actuator is its use in a magnetic
bearing. Figure 5.36 shows a fully integrated magnetic bearing, which
supports a fast-rotating shaft in Ô¨Åve directions, three orthogonal linear
directions and two rotations. Only the rotation around the central axis is
left free. This compact magnetic bearing and drive system is designed by
Maarten Kimman [55], from the Mechatronic System Design laboratory at
Delft University of Technology for a high speed micro-milling centre, which
has to operate at speeds above 300.000 rpm [56], [14]. Also in this system
the permanent magnets create a bias Ô¨Çux, which is modulated by the coils.
By tracing the Ô¨Çux of the diÔ¨Äerent coil sections as indicated with the red
arrows and combine these with the Ô¨Çux from the permanent magnet as
indicated with the blue arrows it can be imagined how all forces are created.
It is worthwhile to notice that also in this case the permanent magnets do
not increase the reluctance of the Ô¨Çux from the coils. Still the conÔ¨Åguration
is essentially diÔ¨Äerent from the example in the previous section as it uses

416
Chapter 5. Electromechanic Actuators
Axial bearing air gaps
Axial bearing coils
Radial bearing air gaps
Radial bearing coils
Figure 5.36: Five degrees of freedom homo-polar magnetic bearing. Only the left-
side air gap and windings of the axial bearings and the lower-side
air gap and windings of the radial bearings at the cross-section are
indicated. The Ô¨Çux by the current in the radial bearing coils (red
arrows) is guided via a diÔ¨Äerent route than the Ô¨Çux from the perma-
nent magnets (blue arrows). In the air-gaps they combine to higher
or lower values depending on the current direction, thereby enabling
a change in the force in diÔ¨Äerent directions. Modulation of the Ô¨Çux
around the axial bearing coils (green arrows) creates the axial bearing
function by a diÔ¨Äerence in Ô¨Çux above and below the axial bearing air
gaps. (Courtesy of Maarten Kimman)
the low reluctance path in the third dimension for the Ô¨Çux induced by the
current in the coils. This is just another illustration of the large amount
of conÔ¨Ågurations possible in electromagnetic actuators. This example of a
magnetic bearing is called homo-polar because the permanent magnet Ô¨Çux
Ô¨Çows in the axial direction through the rotating shaft, which means that
the Ô¨Çux in the shaft does not change due to the rotation. As a consequence
of this conÔ¨Åguration, power consuming eddy-currents are prevented that
would otherwise be induced by the changing Ô¨Çux in the rotating shaft.
5.3.5
Active Linearisation of the Reluctance Force
An important property of a magnetic bearing is its inherent negative stiÔ¨Ä-
ness. The shaft needs to rotate freely, which means that this stiÔ¨Äness can
not be compensated by a mechanical spring like the elastic hinge of the
previously presented linear hybrid actuator. In Chapter 4 it is shown how
negative feedback control enables to stabilise the position of the shaft inside

5.3. Variable Reluctance Actuation
417
the magnetic bearing by providing a virtual spring with positive stiÔ¨Äness
and damping. This active control of magnetic bearings has enabled their
use in critical applications that do not allow mechanical contact and re-
quire strict control of deviations from the ideal position of the shaft at often
extremely high rotation speeds.
In other applications it is not always possible to create a double variable
reluctance actuator. As example one can think of an actuator that has to
carry a heavy object for instance by means of a robot. It would require
an asymmetrical actuator like the ones shown in Figure 5.28 positioned
up-side down, where the mover is connected to the heavy object. Such an
actuator has to deliver the constant force of gravity and in that case the high
force-constant of a reluctance actuator can be very beneÔ¨Åcial to keep the
consumed power to acceptable levels. Research has been done at diÔ¨Äerent
universities to cope with the related problem of non-linearity and negative
stiÔ¨Äness of which the research at Eindhoven University of Technology by
Andelko Katalenic from the Control Systems laboratory and Jeroen de
Boeij from the electromechanics and Power Electronics laboratory is well
documented [54], utilising a compensator that includes the compensation of
hysteresis.
A further step in linearisation is by using feedback on the measured Ô¨Çux
density in the actuator as described by Katalenic in his PhD thesis [53].
The idea is based on Equation (5.86), which is repeated here:
F ‚âà‚àí
B2
gAg
Œº0
[N].
(5.104)
A suitable feedback controller that keeps the magnetic Ô¨Çux density equal to
a calculated setpoint will keep the force also constant, thereby avoiding the
stiÔ¨Äness related to the Ô¨Çux. The setpoint calculation only needs to include
the squared function but that is well possible with the fast computing means
of today. Measurement of the Ô¨Çux can be done with coils for varying (AC) Ô¨Çux
levels and with a Hall sensor for DC. A Hall sensor measures a magnetic Ô¨Åeld
by the Lorentz force exerted on a current and is explained with Figure 6.80 in
Section 6.3.3.2 for sensing high currents in power ampliÔ¨Åers. This solution
is however not simple to implement because of the impossibility to keep
magnetic Ô¨Åelds localised at the point of measurement. Still it is to be
expected that reluctance actuators will gradually be used in applications
that hitherto were served uniquely by Lorentz actuators.

418
Chapter 5. Electromechanic Actuators
5.4
Application of Electromagnetic Actuators
The application of the three presented electromagnetic actuators in mecha-
tronic systems is determined by their properties in relation to the other
parts of the system. This section will Ô¨Årst present the electrical interface
with the ampliÔ¨Åer followed by a comparison of the three types with some
realistic data to illustrate their diÔ¨Äerent characteristics.
5.4.1
Electrical Interface Properties
In mechatronic positioning systems the actuator is always used in combi-
nation with an ampliÔ¨Åer. This ampliÔ¨Åer has also its limitations as will be
presented in Chapter 6. The impedance of the actuator strongly inÔ¨Çuences
the total transfer function and stability of the ampliÔ¨Åer-actuator combina-
tion and also the ampliÔ¨Åer output characteristics strongly inÔ¨Çuence the
behaviour of the actuator. In this section these eÔ¨Äects will be elaborated.
First the dynamic eÔ¨Äect of the self-inductance will be investigated in the
frequency-domain, when the ampliÔ¨Åer can be approximated as an ideal
current source. This means that the behaviour of the actuator does not
inÔ¨Çuence the current of the ampliÔ¨Åer. It will be shown that these dynamic
properties will only depend on the dimensions of the coil and not on the
number of windings and the wire thickness. Directly related to the self-
inductance is the ability of the actuator to change the acceleration rapidly.
This is represented by the jerk, which is the derivative of acceleration over
time. As a last step the ampliÔ¨Åer will be modelled in a more realistic way,
where the behaviour of the actuator inÔ¨Çuences the current. It will become
clear that the actuator shows damping properties, when the ampliÔ¨Åer is not
an ideal current source.
5.4.1.1
Dynamic EÔ¨Äects of Self-Inductance
In Figure 5.27 it was shown that an electromagnetic actuator can be repre-
sented in the electrical domain as a series of a resistance, a self-inductance
and a voltage source. When the actuator is supplied by a current, the voltage
over the actuator will be equal to:
Va = Vm + IR + L dI
dt
[V].
(5.105)

5.4. Application of Electromagnetic Actuators
419
b
h
b
h
d
Figure 5.37: Two diÔ¨Äerent coil conÔ¨Ågurations with their basic dimensions shown
as an example of the wide amount of possibilities. Next to these
rotation symmetrical shapes, also square, race-track and even three
dimensional shapes are used.
In order to get an idea of real values, the resistance from the windings is
calculated with the following relation:
R = œÅr
n‚Ñìw
Aw
[Œ©].
(5.106)
with
œÅr = resistivity of the wiring material
[Œ©m],
‚Ñìw = average length per winding.
[m],
n = number of windings,
Aw = cross section of the wire
[m2].
When designing a coil of a certain size, it mostly starts with the dimensions,
giving the average length of each winding (‚Ñìw = œÄd) and its cross section
(Ac,w = bh) as shown for two typical coil conÔ¨Ågurations in Figure 5.37.
Ac,w relates to Aw in the following manner:
Aw =
Œ≥Ac,w
n

m2
.
(5.107)
With Œ≥ being the Ô¨Åll factor, which reduces the useful volume of the coil due
to round windings and the insulation. Practical values for Œ≥ range between
approximately 0.5 for thin round wires to 0.9 for Ô¨Çat wires. With these
factors the resistance becomes:
R = œÅrn2‚Ñìw
Œ≥Ac,w
[Œ©].
(5.108)
Assuming Œ≥ and œÅr are constant for a given coil size, the resistance is pro-
portional to the number of windings squared.

420
Chapter 5. Electromechanic Actuators
To estimate the eÔ¨Äect of the self-inductance, Equation (5.105) is used in the
mechanical stationary situation, which means that Vm = 0
Va(t) = IR + L dI
dt
[V].
(5.109)
After applying the Laplace-transform to bring the equation to the frequency-
domain the following relation is found:
Va(s) = I(R + sL)
=‚áí
Va(œâ) = IR

1+ jœâL
R

[V].
(5.110)
To give a value to the ability to change the force rapidly, the electrical
time-constant œÑe is introduced, deÔ¨Åned as:
œÑe = 1
œâ0
= L
R
[s].
(5.111)
With Equation (5.110) the impedance Z becomes:
Z(œâ) = Va
I = R(1+ jœâœÑe)
[Œ©].
(5.112)
This makes clear that above œâ0 = 1/œÑe, the impedance, and consequently
also the voltage, necessary to drive a current to the actuator, increases
proportional with a slope of +1 as function of the frequency. This entails
a heavy requirement for the ampliÔ¨Åer, which has to deliver both a high
voltage to cope with the self-inductance and a high current to deliver the
force at elevated frequencies. For this reason it is important to keep œÑe
as low as possible. When the resistance R is replaced by Equation (5.108)
and Equation (5.60) is used to replace the self-inductance L by n2/R, the
following relation for the electrical time-constant is obtained:
œÑe =
Œ≥Ac,w
RœÅr‚Ñìw
[s].
(5.113)
This shows that œÑe can only be tuned by the outer dimensions of the coil, the
resistivity and the reluctance.
Eddy Current Ring
In Section 5.3.1.1 it was explained that a copper ring can be used in a
loudspeaker type moving-coil Lorentz actuator to reduce the contribution of
the iron yoke to the self-inductance and reluctance force. Ideally this ring
would reduce the self-inductance to the level of a magnetic system without
an iron yoke but that would only be the case if all magnetic Ô¨Çux by the coil

5.4. Application of Electromagnetic Actuators
421
would Ô¨Çow through the ring and when the resistance of the ring would be
zero (superconductive material). This is unfortunately not the case and for
that reason only a part of the self-inductance is cancelled, depending on
the position of the coil, the dimensions and the material of the yoke and
the frequency. It was already mentioned that the ring is not eÔ¨Äective at
DC currents and increases its eÔ¨Äectivity at higher frequencies. As a result
the real impedance of a coil with such a copper ring is approximately half
the impedance of a self-inductance, for which reason it is described as a
"semi-inductance" by Knud Thorborg a.o. of Tymphany/Scanspeak at the
occasion of the 122nd convention of the Audio Engineering Society [85]
with an approximate +0.5 slope and -45¬∞phase between current and voltage
instead of the -20 dB/decade with -90¬∞phase between current and voltage
with a normal self inductance. This alleviates the problem on controlling
the current as will be explained in the next chapter.
5.4.1.2
Limitation of the ‚ÄúJerk‚Äù
In high speed precision controlled positioning systems, the voltage, required
to change the current in the self-inductance of the actuator, needs to be
actively limited in order to stay within the maximum voltage range of the
power ampliÔ¨Åer. When exceeding this range, the ampliÔ¨Åer does not reliably
transmit the control information to the actuator. This in fact means that
the system is (temporarily) out of control. In most actuators the current
is proportional to the force and as a consequence it is proportional to the
acceleration of the driven mass. This means that by limiting the change of
current, the change of acceleration, the ‚Äújerk‚Äù is limited. As was explained
in Section 4.2.4 on trajectory control, high speed precision controlled posi-
tioning systems need to deÔ¨Åne and limit both position, speed, acceleration
and jerk, because of this hardware limitation. Nowadays even the derivative
of the jerk over time, called snap, is often limited.
In case of fast moving reciprocating systems like waferscanners it is clear
that a limitation of the jerk automatically limits the maximum attainable
acceleration as being the integral of the jerk over time. It is also for this
reason that a Lorentz actuator is often the preferred choice in these systems
as it possesses the lowest value of œÑe from all actuator types, especially when
the ferromagnetic part is completely omitted, like the example shown in
Figure 5.26. It is however also true that a more eÔ¨Écient actuator based
on the reluctance or hybrid principle would needs less current and this
could compensate for the higher voltage, necessary to realise the high dI/dt
through the self-inductance. This is another area for optimisation.

422
Chapter 5. Electromechanic Actuators
5.4.1.3
Electromagnetic Damping
In the previous modelling of the behaviour of an electromagnetic actuator
it was always assumed that the current was given. In practice the current
is supplied by a power ampliÔ¨Åer. In the following chapter on electronics it
will be explained that a power ampliÔ¨Åer is not capable to deliver a current
that is fully independent of the load. It will be shown that the output of
the ampliÔ¨Åer possesses a certain source impedance, which inÔ¨Çuences the
behaviour of the connected actuator at its output terminals. As a result
all electromagnetic actuators show a certain amount of damping, when
connected to a power ampliÔ¨Åer. This damping is caused by the motion
voltage Vm, which is induced in the coil, due to the change of Ô¨Çux related
to the movement. This voltage in its turn will cause a current through the
circuit, which is further determined by the series of the impedance of the
actuator and the source impedance of the ampliÔ¨Åer, as shown in Figure 5.38.
In the following the eÔ¨Äect of this current will be explained by means of the
Lorentz actuator, because of its constant permanent magnet Ô¨Çux, which
simpliÔ¨Åes the example. In principle the eÔ¨Äect of the two voltage sources can
be combined linearly and the total current in the circuit is equal to the sum
of the currents caused by both voltage sources.
It = Is ‚àíIm =
Vs
Rs + Ra + jœâL ‚àí
Vm
Rs + Ra + jœâL =
Vs ‚àíVm
Rs + Ra + jœâL
[A]. (5.114)
This means that it is allowed to analyse the behaviour of an actuator for each
voltage source separately, while the other source is replaced by a conducting
=
+
It
L
Vm
Ra
Rs
Vs
Ampli%er
(source)
Actuator
(load)
+
_
+
_
Is
+
_
Ra
Rs
L
Vs
Ampli%er
(source)
Actuator
(load)
Vm
+
_
Im
L
Ra
Rs
Ampli%er
(source)
Actuator
(load)
Figure 5.38: Electrical circuit of an ampliÔ¨Åer with a resistive output impedance Rs,
which acts as a source for an electromagnetic actuator, represented
by its electrical equivalent. The total current in the circuit It is the
combination of the current Is, caused by the ampliÔ¨Åer and the current
Im, caused by the motion voltage Vm, It = Is ‚àíIm. The damping is
caused by Im only.

5.4. Application of Electromagnetic Actuators
423
w,t
m
a
B
v
I
R


d
d
x
v
t



2
w,t
d
a
B
v
F
R


d
F
Figure 5.39: A Lorentz actuator shows a velocity dependent damping force when the
two terminals of the coil are connected by means of a low impedance
circuit (Rs = 0). Following Faraday‚Äôs law, the induced electric Ô¨Åeld by
the movement-related Ô¨Çux-change creates a current Im in the direction
as shown, due to the minus sign. This current generates a Lorentz
Force Fd, which is directed in the opposite direction of the movement
according to the corkscrew rule.
wire.
The current caused by the ampliÔ¨Åer voltage creates the force that was
described in the previous sections. The current caused by the motion voltage
is the new factor. It creates the damping eÔ¨Äect by the resulting force in the
actuator, counteracting the velocity. The related damping coeÔ¨Écient c can
be derived as follows for a Lorentz actuator.
Using Figure 5.39 for the directions, it starts with the motion voltage:
Vm = (B‚Ñìw,t)v
[V],
(5.115)
with ‚Ñìw,t being the total length of the windings inside the magnetic Ô¨Åeld.
The current will be:
Im =
Vm
Rs + Ra + jœâL = (B‚Ñìw,t)v
Rs + Ra
[A].
(5.116)
As the current will Ô¨Çow in the same magnetic Ô¨Åeld, a Lorentz force will
occur:
Fd = (B‚Ñìw,t)Im
[N].
(5.117)
Filling in
(B‚Ñìw,t)v
Rs + Ra + jœâL for Im gives:
Fd =
(B‚Ñìw,t)2v
Rs + Ra + jœâL
[N].
(5.118)

424
Chapter 5. Electromechanic Actuators
So the resulting damping coeÔ¨Écient c caused by the motion-induced voltage
and current in the coil is equal to:
c = Fd
v =
(B‚Ñìw,t)2
Rs + Ra + jœâL
Ns/m

.
(5.119)
The conclusion of this equation is that the damping is proportional to the
B‚Ñì-factor squared and inversely proportional to the total impedance of the
current loop. The B‚Ñì-factor is also related to the force-constant, which means
that one should not reduce this B‚Ñì-factor when less damping is needed as it
will equally reduce the eÔ¨Éciency of the actuator. For that reason it is better
to control the damping by adapting the resistive value of the current loop.
With a given actuator this can only be accomplished by adapting the source
impedance Rs of the actuator, which is equal to the output impedance of the
preceding power ampliÔ¨Åer.
In loudspeaker systems it is necessary to create damping, in order to sup-
press the resonance of the loudspeaker cone with the stiÔ¨Äness of its support
and the air cabinet. For that reason power ampliÔ¨Åers in audio systems are
designed to have a low output impedance.
For precision mechatronic systems, however, it is in most cases required
to avoid the motion-induced damping as much as possible, because of the
increased transmissibility of external vibrations through the electromag-
netic damper. For that reason in most mechatronic systems the output
impedance of the ampliÔ¨Åer is designed as high as possible. This means that
the ampliÔ¨Åer should act like a current source with a current level that is
ideally fully independent of the load. As an additional beneÔ¨Åcial eÔ¨Äect the
self-inductance will have less inÔ¨Çuence on the current at higher frequencies
with a corresponding reduced impact on the dynamic performance of the
system. However, due to the fact that a high self-inductance also decreases
the maximum allowable jerk it remains important to keep the electrical
time-constant œÑe = L/R of the actuator as low as possible.

5.4. Application of Electromagnetic Actuators
425
5.4.2
Comparison of three Electromagnetic Actuators
To illustrate the diÔ¨Äerent properties of the three discussed actuator types,
an example with practical values will be presented to close oÔ¨Äthis section
on electromagnetic actuators.
Several parameters have to be determined, of which the most important
are:
‚Ä¢ Force-constant in relation to the power dissipation.
‚Ä¢ Figures of Merit including the moving mass.
‚Ä¢ StiÔ¨Äness.
‚Ä¢ Repeatability and predictability.
‚Ä¢ Dynamic eÔ¨Äects on the control loop.
As a Ô¨Årst step the main force properties of the Lorentz, reluctance and
hybrid actuator will be compared by means of a small calculation example,
all with the same electrical input power.
A coil is chosen with a Ô¨Åxed conÔ¨Åguration and total cross section of the
windings as shown in Figure 5.40.
The overall coil dimensions deÔ¨Åne the power dissipation for a certain current
density in the coil independent of the number of windings, because the
current is inversely proportional to n, while the resistance is proportional to
n2 and the power dissipation Pl = I2R ‚àùn2/n2 = 1. It was already shown in
Equation (5.113) that the number of windings has also no inÔ¨Çuence on the
dynamic properties of the actuator, expressed in the electrical time-constant.
This means that the voltage and current capacity of the power ampliÔ¨Åer is
the only item that should be taken into account in order to determine the
number of windings. More windings imply a higher voltage and a lower
current. In motion systems with very high power also the maximum wire
dc=30 mm
hc=15 mm
bc=3,3 mm
Figure 5.40: Dimensions of the coil, used for the comparison of the three diÔ¨Äerent
actuator types.

426
Chapter 5. Electromechanic Actuators
thickness of the supply wires is a possible constraint, but for this comparison
study this aspect is not taken into consideration.
The example coil has an average length per winding ‚Ñìw of œÄ¬∑30 ‚âà100 mm
and a cross section Ac of 50 mm2. With 100 windings, each winding has a
maximum cross section of 0.5¬∑10‚àí6 m2. However, due to the round shape and
insulation the Ô¨Ålling eÔ¨Éciency is lower. A Ô¨Ålling eÔ¨Éciency of 0.7 is realistic,
giving a cross section of the wire of Ac,w = 0.35¬∑10‚àí6 m2. The length ‚Ñìis 10
metres and with the resistivity of copper, œÅr = 1.68¬∑10‚àí8 Œ©m the resistance
R is equal to:
R = œÅr‚Ñì
Ac,w
= 1.68¬∑10‚àí8 ¬∑10
0.35¬∑10‚àí6
‚âà0.5 Œ©.
One amp√®re of current will then give half a watt of Power. With this coil
the performance of the three diÔ¨Äerent actuators will be evaluated.
5.4.2.1
Force-Constants
Lorentz Actuator
With the Lorentz actuator, the diameter of the chosen coil limits the diameter
of the yoke. This also limits the capability of this yoke to transfer a high
amount of magnetic Ô¨Çux. For this reason the chosen coil dimensions are
more wide than long. In order to avoid saturation of the yoke, the Ô¨Çux
density should remain below 2 T. With this value the surface of the air-gap
times the Ô¨Çux density in the air-gap should be lower than the maximum Ô¨Çux
density times the surface of the yoke. With a small calculation this means
that the uniform magnetic Ô¨Åeld in the air-gap can be maximum 0.9 T. The
height of the air-gap is equal to the coil and in the mid position F = BI‚Ñìt
results in a force-constant of k ‚âà9 N/A. In reality this value will be somewhat
(‚âà15 % lower because of fringing Ô¨Çux resulting in a realistic force-constant
in the mid position of k ‚âà7.5 N/A.
Reluctance Actuator
When the same coil is applied in a reluctance actuator Equation (5.81) can
be used to calculate the force:
F = ‚àí

 nI
‚Ñìg
2 Œº0Ag
4
N.
If the length of the air-gap equals ‚Ñìg = 10‚àí3 m, which is quite large, and
Ag = 6¬∑10‚àí4 m2, then the resulting force-constant would amount up to only

5.4. Application of Electromagnetic Actuators
427
k ‚âà3.7 N/A, which is not yet impressive. However, when the air-gap is reduced
to 0.3 mm, the force-constant becomes k ‚âà37 N/A and with a 0.1 mm gap
k ‚âà370 N/A.
Unfortunately, at full closure of the gap the iron will saturate with a Ô¨Çux
density of around 2 T. With Equation (5.86) the maximum attainable force
Fm can be calculated, which results in:
Fm = ‚àí
B2
gAg
Œº0
= ‚àí4¬∑6¬∑10‚àí4
4œÄ¬∑10‚àí7 ‚âà2000 N.
This clearly shows the high potential of a reluctance actuator but it is
necessary to admit that a large error is made due to the approximation on
the permeability of the iron (Œºr = ‚àû). This is far too optimistic when the
Ô¨Çux density approaches saturation. By using Hopkinson‚Äôs law of magnetics,
the minimum permeability to realise this value can be determined with the
stated Ô¨Çux density of 2 T, using the length ‚Ñìy of the Ô¨Çux path through the
ferromagnetic part and assuming a fully closed airgap ‚Ñìg = 0:
B = Œ¶
Ag
=
nI
AgR = Œº0ŒºrnI
‚Ñìy
= 2 T.
With the known values for this example, nI = 100 and ‚Ñìy ‚âà0.1 m, the required
minimum relative permeability becomes:
Œºr ‚â•2‚Ñìy
Œº0nI ‚âà1.6¬∑103 Vs/Am
This high value is not realistic with normal ferromagnetic materials. A
value for Œºr of 500 is more normal, giving a maximum Ô¨Çux density of about
0.7 T, with a corresponding force-constant of k ‚âà230 N/A. Even with this
limitation the reluctance actuator still is capable to deliver a signiÔ¨Åcantly
larger force-constant than the Lorentz actuator for the same coil resistance.
Hybrid Actuator
To calculate the force of the hybrid actuator Equation (5.103) is used:
F ‚âà0.8nI
BrAm
‚Ñìg,1 +‚Ñìg,2
[N].
The same key dimensions as with the other actuators are chosen:
Am = Ag = 6¬∑10‚àí4 m2 (Ô¨Åts inside the coil),
Br = 1.2 T,
n = 50 (The coil is split in two to keep the power identical),
‚Ñìg,1 +‚Ñìg,2 = 1¬∑10‚àí3 m (same stroke as reluctance).

428
Chapter 5. Electromechanic Actuators
These values result in a linear! force-constant of k ‚âà30 N/A, which clearly
shows the combined performance of ‚Äúthe best of both worlds‚Äù, a moderately
high force-constant with a linear force to current relation over a moderate
motion range at a moderate power dissipation level.
5.4.2.2
Figures of Merit Including Mass
In Figure 5.41 the three actuators have been scaled to the same coil size
and at Ô¨Årst sight it might be concluded that the Lorentz actuator is at an
advantage when the coil would be the moving part. However, this is hardly
ever the case in a precision motion system as there the magnet is used as
motion part. The main reason for this choice is due to the stiÔ¨Äness of the
wires that transport the current to the coil, which should be avoided for the
reason of a minimum transmissibility of external vibrations. Furthermore,
due to the lower force to power ratio, more current is needed for the same
force, which implies a higher power loss. In high power precision systems,
the resulting heat has to be taken away, sometimes even by water cooling,
before it radiates to other sensitive parts. The necessary cables and hoses
and cooling plates considerably increase the stiÔ¨Äness of the interconnect to
the coil section and further necessitate to take the permanent magnet part
as mover.
In fact the Lorentz actuator has the largest moving mass of all, when looking
only to the force related to the power. Furthermore, when considering that
the variable reluctance- and hybrid actuator both have the possibility to add
more coil windings, it is clear that these actuators will yield the highest
 
L
m
" 


Hybrid
low
high
moderate
L
m
" 


Lorentz
high
low
high (yoke)
L
m
" 


Reluctance
low
high
moderate
Figure 5.41: DiÔ¨Äerence in reluctance, self-inductance and mass of the three actua-
tor types scaled to the same coil dimensions.

5.4. Application of Electromagnetic Actuators
429
Ô¨Ågure of merit when looking at the diÔ¨Äerent terms in Equation (5.51), which
is repeated here:
Qm =
Fa
m

Pl
=

S
m =
k

Rm
N/kgW0.5
.
The combination of the highest force-constant with the lowest moving mass
means that both reluctance force based are preferred from a high force to
power ratio point of view in applications where the dynamic properties and
linearity are less important.
5.4.2.3
StiÔ¨Äness
When a low stiÔ¨Äness is required the Lorentz actuator has absolutely the
best performance, achieving almost zero stiÔ¨Äness when the coil is optimally
centred in the [permanent magnetic Ô¨Åeld. The (negative!) stiÔ¨Äness of a
reluctance actuator becomes quickly very high when the air gap is small.
The hybrid actuator is slightly better due to the high reluctance of the
permanent magnet but even with a compensating stiÔ¨Ähinge it is hardly
possible to approach the low stiÔ¨Äness of a Lorentz actuator.
This reduces the application of the reluctance and hybrid actuator to appli-
cations where transferred vibrations are less a problem.
5.4.2.4
Repeatability and Predictability
The repeatability and predictability of an actuator relate to their controlla-
bility.
As was presented in the previous chapter on motion control, it is necessary
for high speed and high accuracy applications that the feedforward control
action achieves almost perfect accuracy. This requires that the controller
always knows the properties of the actuator, which in most cases is achieved
by means of calibration.
After the calibration the properties should change as little as possible and
in that respect a Lorentz actuator is more easy to control due to its low
sensitivity of the force-constant for displacements. Both the reluctyance
actuator and the hybrid actuator need separate sensors to tell the controller
about the relative position of the mover to the stator, in order to correct the
settings for this position. It is clear that these relative position sensors need
to be very accurate and stable themselves.
Still the Lorentz actuator also has one property that needs to be monitored
for the ultimate of repeatability and that is the temperature of the perma-

430
Chapter 5. Electromechanic Actuators
nent magnet(s). Especially the strong magnets based on NdFeB technology
are very temperature sensitive.
5.4.2.5
Dynamic EÔ¨Äects on the Control Loop
The last important criterion to compare the three electromagnetic actuator
types is their ability to change the force rapidly and faithfully execute the
necessary control actions. This is reÔ¨Çected in both electrical and mechanical
limitations.
The electrical limitations are presented before and mostly due to the self-
inductance and the related necessary limitation of the jerk in the trajectory
planning of the motion system. For the same three actuators with the exam-
ple coil as shown in Figure 5.41, the self-inductance is purely determined
by the reluctance of the magnetic Ô¨Çux path by the coil. The higher the
reluctance, the lower the self-inductance.
When following the black arrows in the Ô¨Ågure, indicating the path of the
magnetic Ô¨Çux by the coil, it is clear that the reluctance is quite high for the
Lorentz actuator because it includes a large air path. This would even be
better when no ferromagnetic elements are applied, which is in principle
possible as was shown in Figure 5.25. The reluctance of the Lorentz actuator
is in any case considerably smaller than with the reluctance and hybrid
actuator, because of their much smaller air-gap and the required presence
of ferromagnetic material for their functioning.
For this reason, a Lorentz actuator is better suited for high speed precision
actuation with fast changing currents, while the other actuators can be ap-
plied where high forces in a semi static situation are required. On the other
hand the higher force-constant of the reluctance and hybrid actuator partly
compensates the negative aspect of the higher self-inductance, because of
the lower required current. A detailed FEM analysis should determine the
real optimum for each situation as a smaller airgap inÔ¨Çuences the dynamic
properties of the hybrid and reluctance actuator in a clearly similar way.
The mechanical limitations are all related to the resonance frequency that
occurs due to the limited achievable stiÔ¨Äness of the connection between the
actuator and the actuated mechanism in combination with their masses. In
that respect the Lorentz actuator seems less attractive, because the mover
consists of several parts that are partly glued (the permanent magnets).
Nevertheless all actuators have suÔ¨Écient possibilities for a reasonably stiÔ¨Ä
connection and in practice the available space in the construction and other
resonating eigenmodes often pose more severe issues for the control engineer.

5.5. Piezoelectric Actuators
431
5.5
Piezoelectric Actuators
5.5.1
Piezoelectricity
The word ‚Äúpiezo‚Äù is derived from the Greek word ‚ÄúœÄŒπœµŒ∂o‚Äù, which means
‚Äúto press‚Äù. The piezoelectric eÔ¨Äect was Ô¨Årst observed by the Pierre Curie
together with his brother Paul-Jacques Curie (1856 ‚Äì 1941) who also was
a physicist. They discovered that under compression a quartz crystal is
generating an electric potential, which is called the direct piezoelectric eÔ¨Äect.
It later has been discovered that this eÔ¨Äect also is reversible, which is called
the converse piezoelectric eÔ¨Äect or inverse piezoelectric eÔ¨Äect: when an electric
Ô¨Åeld is applied to the piezoelectric material by applying a voltage to the
electrodes at its surface, the material expands or contracts depending on
the direction of the electric Ô¨Åeld.
Besides quartz, several other materials are found to show a piezoelectric
behaviour:
‚Ä¢ Some natural crystals like Rochelle salt.
‚Ä¢ Some natural tissue such as bones and wood.
‚Ä¢ Synthetic piezoelectric ceramics such as Lead Zirconate Titanate (PZT)
and Lead Lanthanum Zirconate Titanate (PLZT).
‚Ä¢ Synthetic polymers such as Polyvinylidene Fluoride (PVDF).
The reason for the piezoelectric behaviour is an asymmetry in the molecular
structure of the piezoelectric material, often crystalline, which creates an
electric charge dipole, represented by an electric Ô¨Åeld over the molecule
with a corresponding potential diÔ¨Äerence between the poles. This charge
asymmetry is called polarisation and is caused by large atoms located inside
the molecular structure formed by these and other atoms. In principle
many materials have this dipole structure and these are for instance used
to increase the capacitance of a capacitor as will be described in the next
chapter. With piezoelectric materials this dipole structure is sensitive for
strain, meaning that the electric Ô¨Åeld between the poles can be changed due
to a charge displacement by external forces. Figure 5.42 shows as example
a Lead oxide (PbO3) PZT crystalline structure where a certain amount of
Titanium (Ti) and Zirconium (Zr) atoms are located according to a Perovskite
structure. At elevated temperatures the distance between the atoms is
large enough to accommodate the Ti/Zr atoms. In that case the material
is isotropic without piezoelectric properties. When cooling down below the

432
Chapter 5. Electromechanic Actuators
Pb (+)
O (-)
Ti,Zr (+)
+
-
Above the Curie temperature                       Below the Curie temperature
Figure 5.42: The piezoelectric eÔ¨Äect in PZT material is caused by an asymmetry
in the molecular structure of the material where large atoms like
Titanium or Zirconium are ‚Äúfrozen‚Äù into the structure when cooling
down from above the Curie temperature, thereby creating a dipole, a
charge asymmetry in the molecule.
Curie temperature the shrinking structure is deformed into a tetragonal
ferroelectric structure where the Ti/Zr atoms are ‚Äúpushed‚Äù aside with a
simultaneous displacement of the oxygen atoms. The oxygen atoms are
negative charged in the chemical bonding process as they received electrons
from the other atoms which become positive charged. The position change
of the Ti/Zr atoms relative to the other atoms implies a charge displacement
which creates the dipole in the molecule.
5.5.1.1
Poling
Similar to a permanent magnet material, piezoelectric material with the
same polarisation direction is grouped in Weiss domains.
In a multi-
crystalline material these domains are normally randomly oriented and the
piezoelectric eÔ¨Äect is not observed on a macroscopic level. To utilise the
piezoelectric properties on the macroscopic scale, the Weiss domains have
to be aligned. In some materials like quartz this happens naturally, but
like in PZT a poling process is necessary for this alignment, as is shown
in Figure 5.43. During poling a strong electric Ô¨Åeld (>2 kV/mm) is applied
to the piezoelectric material while its temperature gets elevated close to
the Curie temperature, which enables the Weiss domains to align to the
external electric Ô¨Åeld. When cooling down the main orientation is main-
tained also without an external electric Ô¨Åeld and the material has obtained
a remanent polarisation. After poling, the piezoelectric properties are also

5.5. Piezoelectric Actuators
433
-
+
-
+
-
+
-
-
-
+
-
+
-
+
-
+
-
+
-
+
-
+
-
+
-
+
-
+
-
+
-
+
/$\$$$
¬ô¬ï%E
Figure 5.43: Without poling the Weiss domains are not aligned. During poling a
strong external electric Ô¨Åeld is applied at an elevated temperature.
After cooling down the material is ‚Äúfrozen‚Äù into a state where the
piezoelectric eÔ¨Äect is present on the macroscopic scale as the Weiss
domains stay almost perfectly aligned.
observed on the macroscopic scale. An external mechanical stress or electric
Ô¨Åeld can disturb the macroscopic balance of the piezoelectric material with
observable eÔ¨Äects on the outside of the material. In Figure 5.44 on the
left the direct piezoelectric eÔ¨Äect is shown, where an external force on the
piezoelectric material generates a voltage at the electrodes of the transducer.
The right side of the Ô¨Ågure illustrates the converse piezoelectric eÔ¨Äect where
an external voltage, generating an electric Ô¨Åeld across the piezoelectric
material, causes the piezoelectric material to expand or contract, depending
on the direction of the voltage.
polarizaon
V
F
d0 + d
d0
0
0 + 
V



\¬ç`]¬ç`
6
polarizaon
+
0 + 
x

Figure 5.44: Schematic of the piezoelectric eÔ¨Äect. Under compression a voltage can
be measured at the electrodes (direct piezoelectric eÔ¨Äect). When apply-
ing a voltage to the electrodes, depending on the sign, the piezoelectric
material expands or contracts (converse piezoelectric eÔ¨Äect).

434
Chapter 5. Electromechanic Actuators
5.5.1.2
Tapping the Bound Charge by Electrodes
Piezoelectric material is non-conductive which means that the electrons
inside the material are bound to the atoms they belong to. This also implies
that the total charge displacement by strain over the piezoelectric material
is not the eÔ¨Äect of a Ô¨Çow of electrons but only of the cumulation of small
charge displacements in each molecule inside the material. It is better
imaginable when thinking of a large series of small potential diÔ¨Äerences,
adding to a large potential diÔ¨Äerence. Unfortunately the non-conductive
property of the material would prevent a current to Ô¨Çow as this requires free
electrons. For that reason electrodes of a conducting material are applied
on two sides of the piezoelectric material, thereby creating a capacitor of
which the intermediate dielectric material does not only serve to increase
the capacitance as will be explained in the next chapter but also actively
contributes to the charge on the plates. The addition of the electrodes cre-
ates a piezoelectric transducer which can measure strain and create forces.
When not connected, the potential at these plates will be equal to the poten-
tial of their environment which is equal to the potential of the piezoelectric
material at that location. This is illustrated in Figure 5.45.a. As a con-
sequence a potential diÔ¨Äerence is present between the electrodes and as
these are made from conductive material a current will Ô¨Çow as soon as
the electrodes are connected (Figure 5.45.b). This current creates a charge
diÔ¨Äerence over the electrodes with a corresponding potential diÔ¨Äerence be-
tween the electrodes, which is directed opposite to the potential diÔ¨Äerence
that is created by the bound charges in the piezoelectric material, hence
reducing the total potential diÔ¨Äerence over the piezoelectric transducer.
During this process the current will reduce proportional to the resulting
decrease in potential diÔ¨Äerence by the charge displacement over the elec-
trodes until a charge equilibrium is reached over the piezoelectric transducer
(Figure 5.45.c) and the current no longer Ô¨Çows. When applying a static force
on the transducer, the corresponding charge displacement by the bound
charges will change the internal potential diÔ¨Äerence in the piezoelectric
material in the transducer which forces a current to Ô¨Çow between the con-
nected electrodes until the resulting potential diÔ¨Äerence is cancelled by the
charge in the electrodes. Even without an intentional connection between
the electrodes in reality always some ‚Äúleaking‚Äù current will occur due to
humidity, surface contamination or other means of charge transport which
means that in steady state no potential diÔ¨Äerence between electrodes can
be observed. This leads to an important conclusion that a piezoelectric
transducer cannot measure static forces, a property which will be further

5.5. Piezoelectric Actuators
435
$
¬ô
¬ô
6¬§"
+      +      +      +      +      +      +      +      +      +
_      _      _      _      _      _      _      _      _      _
6
¬ï/
6`
+      +      +      +      +      +      +      +      +      +
_      _      _      _      _      _      _      _      _      _
+      +      +      +      +      +      +      +      +      +
_      _      _      _      _      _      _      _      _      _
I
e (-)
*¬ö*/*$¬å
_      _      _      _      _      _      _      _      _      _
+      +      +      +      +      +      +      +      +      +
6
¬ï/
+      +      +      
_      _      _
Figure 5.45: The current from a piezoelectric transducer is generated at the con-
ducting electrodes. When connecting the electrodes a current starts
Ô¨Çowing until the total charge transport creates an electric Ô¨Åeld with
an opposite potential diÔ¨Äerence which cancels the potential diÔ¨Äerence
by the bound charges in the piezoelectric material.
elaborated on Page 781 of Chapter 8. Fortunately the use of a piezoelectric
transducer as an actuator is not limited to higher frequencies by this leakage
current as the external electrical supply can easily supply this current.
5.5.2
Transducer Models
Piezoelectricity is the combination of the electric and mechanical behav-
ior of the material, which is given by the equation for the spatial electric
displacement D:
D = ŒµE
C/m2
,
(5.120)
with permittivity Œµ, and the electric Ô¨Åeld E,
The Hooke ‚Äì Newton law, which was deÔ¨Åned in Chapter 2, relates the
deformation of an elastic element with stiÔ¨Äness k to the external force (F =
Kx). This law is also applicable to the relation between the dimensionless
strain S and the externally applied stress T in
N/m2 in a material with its
speciÔ¨Åc compliance CE as the inverse of the multi dimensional elasticity5
modulus Em in
N/m2:
T = EmS
N/m2
=‚áí
S = T
E = CET.
(5.121)
Combining these for all directions of the material into two coupled equations,
according to the IEEE standard on piezoelectricity, the constitutive equations
5This multidimensional matrix includes the poisson ratio, shear eÔ¨Äects and compression
so it is more than only the Young‚Äôs modulus.

436
Chapter 5. Electromechanic Actuators
are obtained for a piezoelectric transducer in strain-charge format.
The constitutive equation for the converse piezoelectric eÔ¨Äect where an
electric Ô¨Åeld results in strain in the material equals:
S = CET +dTE.
(5.122)
The constitutive equation for the direct piezoelectric eÔ¨Äect, where a deforma-
tion results in a voltage corresponding to a charge displacement, is written
as follows:
D = dT +ŒµTE
C/m2
.
(5.123)
The variables in these equations are listed as follows with the corresponding
units and dimensions:
S in [-] 6√ó1 strain vector.
T in [Pa] 6√ó1 stress vector.
E in
V/m

3√ó1 electric Ô¨Åeld vector.
D in
C/m2
3√ó1 electric displacement vector.
and the following constants:
CE in
6
m2/N
7
6√ó6 speciÔ¨Åc compliance matrix at constant electric Ô¨Åeld.
d in [m/V] or
C/N

3√ó6 piezoelectric coeÔ¨Écient matrix.
ŒµT in
F/m

3√ó3 dielectric coeÔ¨Écient matrix at constant stress.
In data sheets of piezoelectric actuators the terms of the piezoelectric coeÔ¨É-
cient matrix are given with the notation di j, where i indicates the direction
of the electric displacement or Ô¨Åeld and j indicates the direction of the
mechanical strain or stress according to the designated directions shown in
Figure 5.46. The coeÔ¨Écient d33 indicates that the strain and electric Ô¨Åeld
are parallel to the poling direction and this coeÔ¨Écient is referred to as the
piezoelectric gain for stack actuators, while d31 indicates that the strain
is orthogonal to the poling direction with the electric Ô¨Åeld parallel to the
poling direction, giving the piezoelectric gain for instance for tube actuators.
The constitutive equations describe the physical behaviour of a piezoelectric
transducer. For a better understanding of how this material works as a
macroscopic actuator, such as a piezoelectric stack-actuator, these equations
can be converted from the stress and electric Ô¨Åeld strength into a format

5.5. Piezoelectric Actuators
437
Poling 

1, x
3, z
2, y
6
5
4
Figure 5.46: The piezoelectric coordinates related to the poling direction.
that used the external force F in [N] and applied voltage V in [V], and from
strain and electric displacement into displacement Œî‚Ñìin [m] and change of
charge Œîq in [C]. For simplicity and also because it is close to most practical
applications for piezoelectric actuators, a homogenous material, electric
Ô¨Åeld and stress is assumed, as well as their respective alignment with the
polarisation and strain. Under these conditions, this conversion gives the
following set of simple scalar multiplications according to the geometry of
the actuator with cross section A and thickness ‚Ñì0, resulting in:
F=T ¬∑ A
[N],
V=E ¬∑‚Ñì0
[V],
Œî‚Ñì=S ¬∑‚Ñì0
[m],
Œîq=D ¬∑ A
[C].
The material equations for the stiÔ¨Äness kpz in
N/m
 and capacitance C in [F]
are as follows:
kpz = AY E
‚Ñì0
and
C = ŒµT ¬∑ A
‚Ñì0
,
(5.124)
where Y E equals the Young‚Äôs modulus of the piezoelectric material at a
constant electric Ô¨Åeld.
When using these results in the constitutive equations, the following simple
relation is obtained for a stack actuator between the force F(t), the elongation
Œî‚Ñì(t), the change of charge Œîq(t) and the potential diÔ¨Äerence V(t), written
in matrix form:

Œî‚Ñì(t)
Œîq(t)
	
=

k‚àí1
pz d33
d33 C
	
F(t)
V(t)
	
.
(5.125)
From this equation it can be concluded that an external voltage, applied
to the piezoelectric actuator, charges the capacitance of the piezoelectric

438
Chapter 5. Electromechanic Actuators
transducer with a charge Œîq while simultaneously causing a displacement
Œî‚Ñìcorresponding to the converse piezoelectric eÔ¨Äect. An external force
on the piezoelectric actuator is manifested by a displacement Œî‚Ñìinversely
proportional to the high but Ô¨Ånite stiÔ¨Äness of the piezoelectric material and
it generates a charge Œîq as well, the direct piezoelectric eÔ¨Äect. These prop-
erties of piezoelectric materials enable these electro-mechanical actuators
to be used for both actuation as well as sensing applications.
The transducer model, which is given in this section, describes a linear math-
ematical model of the interplay between the electrical and the mechanical
domain. Although this model is very important to describe piezoelectric ac-
tuators, for analysis as well as system design, it does not cover the non-linear
properties of piezoelectric materials, which are discussed in the following
section.
5.5.3
Nonlinearity of Piezoelectric Actuators
Although piezoelectric actuators have no moving parts where friction and
backlash can occur, which might otherwise compromise the precision of the
actuator such as in a DC-motor with a gear box, these actuators show other
non-linear behavior such as creep and hysteresis.
5.5.3.1
Creep
A piezoelectric material shows creep after changes of the applied voltage.
This eÔ¨Äect is observed as a slow drift, caused by the eÔ¨Äect of the actuation
voltage on the remanent polarisation of the piezoelectric material. This
creep eÔ¨Äect is logarithmic as function of time according to the following
equation:
Œî‚Ñì(t) = Œî‚Ñì(t=0.1) ¬∑

1+Œ≥¬∑log10

 t
0.1

[m],
(5.126)
where Œî‚Ñì(t=0.1) is the displacement 0.1 seconds after application of the change
in the actuation voltage when the fast dynamic transients have settled and
Œ≥ is the creep constant, which typically is in the order of 1 ‚Äì 2 %.
After a few hours, the displacement due to creep can be as large as 10 % of the
total displacement, which may lead to signiÔ¨Åcant positioning errors in open
loop operated positioning systems that are based on piezoelectric actuation.
If the coeÔ¨Écients connected to piezoelectric creep are known well enough, it
can be compensated (or at least signiÔ¨Åcantly reduced) in an open loop manner
without the use of position sensors. Even with this compensation already

5.5. Piezoelectric Actuators
439
Strain gauge signal [V]
$¬ì¬ù
8
6
4
2
0
-2
-4
-6
-8
-10
25
0
75
150
50
125
100
Figure 5.47: Measured hysteresis loops of a piezoelectric stack actuator for various
amplitudes of the input signal over a 150 V range. The strain gauge
signal is proportional to the measured elongation of the actuator.
a small uncertainty in these parameters may accumulate in a positioning
error, which is not acceptable in precision positioning applications that need
a long term stability in the order of nanometres or even less. A position
sensor in combination with the piezoelectric actuator can be an alternative
solution while a very small integrating action will fully compensate the
positioning error due to the slow creep of the piezoelectric material.
5.5.3.2
Hysteresis
Like ferromagnetic materials also piezoelectric materials show hysteresis,
which is in this case manifested by a diÔ¨Äerence between the motion path
for a raising actuation voltage as compared to a declining actuation voltage
This hysteresis can be as large as 15 % of the desired elongation of the
piezoelectric actuator. A demonstration of various hysteresis loops is shown
in Figure 5.47, where a triangular actuation voltage with its amplitude de-
creasing over time has been applied to a piezoelectric stack actuator, while
the elongation of the actuator has been measured by a strain gage sensor.
The hysteresis is mainly related to the dielectric properties of the material
which couples the charge to the input voltage over the piezoelectric trans-
ducer by the capacitance, the C-term in Equation (5.125). In principle it is

440
Chapter 5. Electromechanic Actuators
the charge that creates the deformation, which means that an improvement
can be made by avoiding the transfer from voltage to charge and directly
control the input current to reach a required charge Œîq, proportional to the
required deformation. This means that the charge needs to be measured
and feedback controlled, which is done by measuring the current into the
transducer and integrating it over time. With this direct control of the
charge, the dielectric value with its intrinsic hysteresis will not inÔ¨Çuence
the deformation anymore.
In Chapter 8 a similar approach will be presented to measure acceleration by
a piezoelectric transducer using the direct piezoelectric eÔ¨Äect. The applied
charge ampliÔ¨Åer measures the charge displacement by keeping the voltage
over the sensor at zero volts and integrating the current between the elec-
trodes that is generated by the acceleration force as shown in Figure 5.45.b.
For voltage controlled piezoelectric actuators, the hysteresis can be mod-
elled by so-called ‚Äúhysteresis operators‚Äù, such as a Preisach model, and these
models enable to compensate the hysteresis in a feedforward control manner.
However, just as in the case of creep, several parameters of the hysteresis
model have to be known perfectly, including the actuation history, in order
to achieve a precise compensation of the hysteresis.
For applications where accuracy is not as important as precise positioning
in a repetitive fashion, such as the scanning motion in an Atomic Force
Microscope, hysteresis is not much of a problem and calibration and pre-
shaping of the driving voltage allows to compensate for most of the hysteresis.
In these applications the repeatability of the position (precision) can easily
be made better than 1 nm if only the rising or the falling voltage branch is
used, even though the diÔ¨Äerence between these two branches may well be
in the order of a micrometre.
Another way to compensate for piezoelectric hysteresis is feedback control,
just in the same way as described for the compensation of creep.
Power dissipation
A material with hysteresis will absorb energy when the hysteresis loop
is rounded. A piezoelectric actuator is no exception to this rule and the
hysteresis will cause a loss of power when driving the actuator with an AC
signal, depending on the magnitude and frequency of the actuation. This
dissipated power can become signiÔ¨Åcant when the actuator is consistently
cycled over its maximum excursion range at very high frequencies (‚â´1 kHz),
heating up the actuator and creating potential damage when the Curie tem-
perature is approached. A useful publication on this subject is from Uchino

5.5. Piezoelectric Actuators
441
and Hirose [87] who describe diÔ¨Äerent models to determine this dissipation.
Fortunately the heating problem does not represent an unsurmountable
issue in most mechatronic positioning systems. One should just be aware of
this property in case the application has to deal with very high frequencies,
possibly requiring additional measures for cooling of the actuators.
5.5.3.3
Aging
Another eÔ¨Äect that occurs in piezoelectric material is aging, where due
to de-poling the piezoelectric gain reduces over time. This phenomenon
happens on the scale of several months or years. When the piezoelectric
material is used as an actuator, the material gets re-polarised whenever a
high Ô¨Åeld gets applied, which means close to the maximum drive voltage. In
this case material aging can be neglected. When the piezoelectric material
is used as a sensor or for the generation of charge, where no external voltage
is applied, reduction of the piezoelectric gain due to aging may have to be
considered.
5.5.4
Mechanical Considerations
In contrast to Lorentz actuators, which have zero stiÔ¨Äness properties, most
piezoelectric actuators have a high stiÔ¨Äness due to the fact that they are
made of ceramic materials. The mechanical properties of the piezoelectric
actuator have to be taken into account when designing a mechatronic posi-
tioning system.
The high stiÔ¨Äness properties of piezoelectric actuators enable to realise very
fast positioning systems with high actuation forces in the range of several kN
and very high resonance frequencies f0, which is next to the sub-nanometre
resolution of piezoelectric actuators one of the main advantages to use these
types of actuators. One disadvantage of these actuators, which also is linked
to the property of high stiÔ¨Äness, is the limited actuation range. As a rule of
thumb a piezoelectric ceramic can expand by about 0.1 % of its total length
at the maximum applied voltage.
Another possible disadvantage of the high stiÔ¨Äness can be the high transmis-
sion of vibrations from the support. This makes this actuator less suitable
for applications like the optical pick-up unit of a CD player or stages in a
wafer scanner where disturbances from the vibrating environment have to
be avoided. piezoelectric actuators are best applied when these vibrations
from the surrounding environment can be suÔ¨Éciently reduced by additional

442
Chapter 5. Electromechanic Actuators
methods. Other application areas include systems that are so small and inte-
grated that local deformations due to accelerations by the overall movement
of the total system can be neglected.
5.5.4.1
Piezoelectric Actuator StiÔ¨Äness
In the data sheet of each actuator some typical parameters are speciÔ¨Åed.
Next to the geometric properties and maximum actuation voltage, important
parameters for the mechanical design are the blocking force Fmax and the
displacement range for the unloaded and unrestrained actuator Œî‚Ñì0. Often
also the actuator stiÔ¨Äness is given, denoting the small signal stiÔ¨Äness kpz,
relating to the other parameters via
Fmax ‚âàkpz ¬∑Œî‚Ñì0
[N].
(5.127)
The blocking force Fmax denotes the force that a piezoelectric actuator gen-
erates when it is conÔ¨Åned on both sides by an inÔ¨Ånite stiÔ¨Äsupport. This
means that the entire force generated by the converse piezoelectric eÔ¨Äect
presses against the clamping support structure as no elongation of the piezo-
electric transducer occurs. When the piezoelectric actuator is not conÔ¨Åned
or restrained, the force generated by the actuator is available for elongation
of the piezoelectric transducer, which means that the actuation force is
in balance with the intrinsic spring stiÔ¨Äness of the piezoelectric actuator,
resulting in a displacement Œî‚Ñì0 as shown in Figure 5.44.
The given value of kpz is only valid for small signal conditions. For larger
signal amplitudes, another term is superimposed on kpz, which is linked to
polarisation eÔ¨Äects of the material, where the large signal stiÔ¨Äness can be up
to a factor of two smaller than the small signal stiÔ¨Äness. Furthermore the
output impedance of the power ampliÔ¨Åer driving the piezoelectric actuator
has an inÔ¨Çuence on the actuator stiÔ¨Äness, as the charge that is built up in
the material due to external forces, if not drained out of the piezoelectric
material, generates a counter-force. This is the reason why a piezoelectric
actuator with open electrodes appears stiÔ¨Äer than a piezoelectric actuator
with shortened electrodes.
5.5.4.2
Actuator Types
Many diÔ¨Äerent types and shapes of piezoelectric actuators exist, such as
piezoelectric bending transducers, tubes, cones and plates, shear-actuators
and stack-actuators. While these all represent a single element it is also

5.5. Piezoelectric Actuators
443
possible to create an actuator by a combination of diÔ¨Äerent kinds of piezo-
electric elements that act by means of friction on rigid counter surface.
Three examples are presented in some more detail because they are repre-
sentative for all piezoelectric actuator types: the piezoelectric tube actuator,
stacking of identical piezoelectric elements and piezoelectric drive by fric-
tion.
Piezoelectric Tube Actuator
The Ô¨Årst type is a Piezoelectric tube actuator [8], which enables positioning
in all three linear spatial directions by means of only one single element with
multiple electrodes on its barrel as shown in Figure 5.48. The lateral motion
in the x‚àíand y‚àídirections is generated by elongating the piezoelectric
material at one electrode of the tube while contracting it at the electrode on
the opposite side of the tube where the same signal gets applied but with a
reversed sign of the actuation voltage. This causes a bending of the tube in
x‚àíor y‚àídirection where the displacement Œîx amounts to
Œîx = 2

2¬∑ d31 ¬∑‚Ñì2 ¬∑V
œÄ¬∑ Di ¬∑ d
[m],
(5.128)
y
y
y
x
x
z
z
Figure 5.48: A tube-scanner consists of one tubular piezoelectric transducer with
diÔ¨Äerent electrodes at the inside and outside. DiÔ¨Äerent electrode
conÔ¨Ågurations can be used depending on the application. The x‚àíand
y‚àíactuators of the examples on the right each consist of two oppositely
working active areas at each side of the tube. The z‚àíactuator is a
uniform linear expanding transducer.

444
Chapter 5. Electromechanic Actuators
with the tube geometry of length ‚Ñì, wall thickness d, and inner diameter
Di, and actuation voltage V
Actuation in z‚àídirection is done by applying a voltage on all electrodes
on the entire circumference causing a uniform elongation with a vertical
displacement Œîz of
Œîz = d31 ¬∑‚Ñì¬∑ V
d
[m].
(5.129)
Piezoelectric tubes are very popular for 3D-positioning applications with
high precision and resolution, because of their simple design, low cost and
low capacitance, which makes the design of the power ampliÔ¨Åer to drive
the actuator easier. A disadvantage of tube actuators is, however, that the
x‚àíy‚àímotion is deÔ¨Åning a spherical segment that causes a cross-coupling
also into the vertical z‚àídirection, which can be a compromising factor when
very precise positioning is required.
Stacking Identical Piezoelectric Elements
piezoelectric stack actuators are multi-layer actuators, typically build from
sheets of d33 piezoelectric material. The individual about 50Œºm-thick sheets
have electrodes on both sides to apply the actuation voltage and are stacked
and glued together to form a longer actuator. This stacking of multiple
layers allows to generate larger strokes with smaller actuation voltages, in
the order of 150 V, as the strength of the electric Ô¨Åeld is given by the voltage
divided by the layer thickness.
Without stacking of the piezoelectric layers, the actuation voltage for the
same actuator length would be in the order of several kV, which is more
diÔ¨Écult to achieve with standard electronics and also poses a larger safety
risk.
As the poling and actuation direction is in the stacking direction, the number
of layers n chosen will deÔ¨Åne the unloaded length ‚Ñì0 and the positioning
range of the stack-actuator.
‚Ñì0 eventually is n times the unloaded and
unactuated thickness of the individual layer h plus the thickness of the
electrodes, glue lines and potentially a layer of unactuated ceramic material
at both ends of the stack-actuator for isolation. With the actuation voltage
V the actuator displacement Œî‚Ñìamounts to:
Œî‚Ñì= n¬∑ h¬∑ d33 ¬∑ V
h
[m].
(5.130)

5.5. Piezoelectric Actuators
445
5.5.4.3
Long Range Actuation by Friction
In Figure 5.49 an example is shown of a long range actuator where a combi-
nation of transversal and longitudinal moving piezoelectric elements are
used to drive a mover that consists of a rigid bar. The piezoelectric elements
are clamped between the mover and the stator, which locks the mover at a
Ô¨Åxed position by friction.
Two modes of operation are possible.
In the Ô¨Årst mode only the transversal moving elements are used and small
displacements can be realised with very high precision.
When the short motion range is not suÔ¨Écient, a stepping action is executed
in which the position of the mover is kept stationary while the transversal
Mover
Transversal actuator
Transversal actuator
Longitudinal actuator
Longitudinal actuator
a: Actuator at rest.
b: Small movements by transversal actuator.
    
c: Stepping to incron range:
    First the uneven pairs.
c: Than the even pairs.
Stator
Stator
Figure 5.49: A long range motion with a piezo stepper using a combination of
transversal and longitudinal moving actuators that are clamped on a
solid mover.

446
Chapter 5. Electromechanic Actuators
actuators are sequentially placed at the other extreme position. For this
relocation both the transversal and longitudinal actuators are used.
Several other conÔ¨Ågurations are possible of which the most known is the
‚Äúultrasonic focusing drive‚Äù of photographic cameras. Many executions exist
with diÔ¨Äerent names. One option is to use a single piezoelectric element,
comparable with the tube actuator, that drives the focusing mechanism like
swiping a page with a Ô¨Ånger at very high speed and accuracy.
5.5.4.4
Actuator Integration
An appropriate integration of the piezoelectric actuator in the mechanical
structure of the mechatronic system allows to prevent failure of the actuator
as well as to reduce or amplify the positioning range for actuation
Pre-loading the actuators by an external compressive force enables the
prevention of fatal tensional loading forces. Most piezoelectric actuators
are very stiÔ¨Äbut also very brittle because of their ceramic nature, with the
exception of actuators made of piezoelectric polymer. Furthermore in case
of stack-actuators, the individual piezoelectric sheets are glued together
generating a potential weakness at the bond-line. This means that although
piezoelectric material can withstand very high compressive forces, they
should not be loaded in tension, torsion, or shear if not explicitly speciÔ¨Åed
for this purpose.
For applications where the piezoelectric actuator has to position a mass
in both directions with pushing and pulling, it must be assured that the
acceleration at pulling does not generate too large tension forces. To prevent
accidental damage by these tensional forces, piezoelectric actuators are
often pre-loaded with springs. This can either be done with a simple helical
spring, which works in parallel with the piezoelectric actuator. A better
alternative are Ô¨Çexure springs, which at the same time also conÔ¨Åne the
piezoelectric motion to the direction of actuation and suppress parasitic
rocking and torsional motion of the actuator. In both cases the stiÔ¨Äness kf
of the pre-loading (Ô¨Çexure) spring increases the stiÔ¨Äness of the total system
ktot to
ktot = kpz + kf
N/m

.
(5.131)
While the loading mass has no inÔ¨Çuence on the (static) positioning range of
the piezoelectric actuator, the loading spring reduces the maximum actua-
tion range as the actuation force now has to work against the piezoelectric
stiÔ¨Äness as well as the loading spring. So a loading spring, as stiÔ¨Äas the

5.5. Piezoelectric Actuators
447
piezoelectric transducer itself (kf = kpz), will reduce the actuation range in
half. What may be desirable in some cases is to have a constant pre-loading
force, which is not a function of the position but ensures that a constant pre-
loading force of the actuator is present. This can be achieved by an elongated
spring with a low stiÔ¨Äness. Without pre-loading, piezoelectric actuators can
de-laminate when being contracted too quickly, where the high tensile forces
can cause micro-cracks or even total fracture of the piezoelectric material.
5.5.4.5
Mechanical AmpliÔ¨Åcation
Mechanical ampliÔ¨Åcation by means of leverage enables a larger positioning
range than the maximum stroke of the actuator would allow. Figure 5.50
shows a ampliÔ¨Åcation scheme based on parallel Ô¨Çexures, which allows to
amplify the extension of the piezoelectric actuator stack Œî‚Ñìto the desired
displacement Œîx with the ratio r of the total lever length b to the position a
at the Ô¨Çexure where the piezoelectric actuator is attached.
r = b
a
and
Œîx = rŒî‚Ñì= b
aŒî‚Ñì
[m].
(5.132)
The mechanical ampliÔ¨Åcation r causes a reduction of the eÔ¨Äective stiÔ¨Äness
ktot on the load side as well as the resonance frequency fres, further deter-
mined by the total positioned mass and the eÔ¨Äective system stiÔ¨Äness, to a
value given by the following equations:
ktot = kpz
r2
N/m

and
fres = f0
r
[Hz].
(5.133)
a
x0 + x
b
0 + 


x
Figure 5.50: AmpliÔ¨Åcation of the elongation of a piezoelectric actuator by a parallel
Ô¨Çexure mechanism with ampliÔ¨Åcation factor r = b/a.

448
Chapter 5. Electromechanic Actuators
5.5.4.6
Multiple Motion Directions by Stacking
Except for piezoelectric tubes, piezoelectric actuators are unidirectional ac-
tuators. When positioning in more than one direction is required, individual
actuators can be be combined by means of mechanical design, including
Ô¨Çexure mechanisms and stacking of multiple actuators. Figure 5.51 shows
three diÔ¨Äerent implementations of a three degree of freedom piezoelectric
scanner, based on the stacking of three separate actuators [76]. The typical
Tripod-scanner                                        Serial scanner
Figure 5.51: DiÔ¨Äerent designs of piezoelectric scanners, positioning systems for
translation in all three spatial directions. The three degrees of freedom
are each determined by separate piezoelectric actuators. The high-
speed scanner of the picture is able to avoid tensional stresses in the
x‚àíand y‚àídirection by actuating from two sides.

5.5. Piezoelectric Actuators
449
positioning range of these scanners can vary from a few hundred nanometres
up to about 150 micrometres, depending on the length of the applied stack.
The Ô¨Årst design on top shows a tripod-scanner where three stack-actuators
are glued together orthogonally, forming a tripod. The advantage of this
design is its simplicity and the fact that at all three directions are imple-
mented in parallel. A disadvantage of the tripod design is, similar to the
piezoelectric tube, that this design also shows a cross-coupling, called scan-
ner bow, between the x‚àíand y‚àídirection into the z‚àídirection, which is
caused by the fact that for each actuator the mounting point of the two other
respective actuators act as pivoting points.
Two designs that do not suÔ¨Äer from scanner bow are the serial scanner on the
right side of the Ô¨Ågure and the Ô¨Çexure scanner on the bottom. In the serial
scanner the individual actuation directions are implemented in a serial way,
stacked on top of each other. This means that the x‚àíactuator moves the
y‚àíand the z‚àíactuator, the y‚àíactuator moves the z‚àíactuator, and only the
z‚àíactuator is moving only the object of interest, shown in the schematic
by the small sample disc on top of the z‚àíactuator. The disadvantage of
the serial design is that the speed performance for the lower positioning
directions is signiÔ¨Åcantly less than for the ones that are stacked on top, due
to the much larger mass that has to be moved.
This diÔ¨Äerence in performance for the diÔ¨Äerent positioning axes is avoided
by implementing the actuation for the various directions in parallel. This is
achieved in the high speed Ô¨Çexure-scanner for a scanning probe microscope
(SPM) as shown at the bottom of the picture.
This design shows a parallel implementation of the x‚àíand y‚àídirections by
combining the individual stack actuators that work in a push-pull conÔ¨Ågu-
ration by means of a Ô¨Çexure mechanism, resulting in the same performance
and resonance frequencies for the x‚àíand y‚àídirections. The z‚àíactuator is
located on top of the Ô¨Çexure structure and is implemented in a serial way.
In the particular application of the SPM, the highest positioning bandwidth
is required in the z‚àídirection and therefore the total mass moved by the
z‚àíactuator has been minimised.

450
Chapter 5. Electromechanic Actuators
5.5.5
Electrical Considerations
As explained in the section on piezoelectricity, poling of the piezoelectric
material is achieved by aligning the Weiss domains with the application
of a strong external electric Ô¨Åeld as shown in Figure 5.43. Actuation of
the piezoelectric material is done by applying an electric Ô¨Åeld according
to the constitutive equations. As can be seen from the hysteresis loop
in Figure 5.47 only positive actuation voltages are applied. Piezoelectric
material is able to accept weak electric Ô¨Åelds in the opposite direction to
about 10 % of the maximum Ô¨Åeld strength in the positive actuation direction.
A stronger electric Ô¨Åeld in the opposite direction can cause de-polarisation
of the material and the remanent macroscopic polarisation in the material
due the poling process would be lost. For that reason piezoelectric materials,
which are not speciÔ¨Åed for symmetric actuation voltages, should only be
driven with positive voltages in order to avoid de-polarisation of the material.
5.5.5.1
Charge vs. Voltage Control
As shortly mentioned before when presenting hysteresis, there are two
methods to control a piezoelectric actuator. One way is to control the ap-
plied voltage and the second is to control the charge that is applied to the
piezoelectric actuator. Both have their advantages and disadvantages.
In case of charge control the hysteresis is avoided as the elongation of the
actuator is a linear function of the applied charge. To control the charge, the
piezoelectric actuator needs to be driven by a charge source. This means that
the current is measured and integrated in the ampliÔ¨Åer and actively con-
trolled to the demanded value by means of feedback. With this method the
voltage at the output of the ampliÔ¨Åer is not observed nor controlled, which
means that the ampliÔ¨Åer has an inÔ¨Ånite output impedance. A consequence
of this inÔ¨Ånite impedance is that charge, generated in the piezoelectric actu-
ator due to external forces, is not removed from the actuator so it will add
to the charge that was supplied by the ampliÔ¨Åer. This results in a higher
stiÔ¨Äness of the actuator in combination with the ampliÔ¨Åer, as mentioned
also in the previous section for an open connection. This increased stiÔ¨Äness
gives a higher resonance frequency of the positioning system. The disadvan-
tage of charge control is, however, that it is not DC-stable, showing more
drift, and in general has more low frequency positioning noise than voltage
control as the charge control involves integrated current-feedback operation
of the ampliÔ¨Åer. In voltage controlled piezoelectric actuators the design of
the power ampliÔ¨Åer is simpler, a better noise performance can be achieved,

5.5. Piezoelectric Actuators
451
and the system shows less drift. The design of the power ampliÔ¨Åer, which in
this case has a low output impedance, and the better noise performance may
give an advantage involving the system costs. A disadvantage of a voltage
controlled piezoelectric actuator, however, is certainly the hysteresis, which
in this case may have to be compensated by other means.
Another interesting design aspect in voltage controlled piezoelectric actua-
tors is that the output impedance of the power ampliÔ¨Åer forms together with
the capacitance of the piezoelectric actuator a Ô¨Årst-order low-pass Ô¨Ålter. On
the one hand this means that a potential bandwidth limitation may have
to be considered in the system design, on the other hand this also gives a
design freedom as adding a resistor in series with the piezoelectric trans-
ducer not only limits the maximum current, protecting the power ampliÔ¨Åer
and the actuator, but it also allows to shape the frequency response and
introduce a roll-oÔ¨Äbefore the resonance frequency of the actuator, which
may be desirable particular in some open-loop positioning applications.
5.5.5.2
Self-Sensing Actuation
The transducer properties of piezoelectric material, as given by the con-
stitutive equations and Equation 5.125, allows its simultaneous use as an
actuator and a sensor as proven by Stefan Kuiper [57,58] during his research
at the laboratory of Systems and Control at Delft University of Technology.
Figure 5.52 shows the electric equivalent diagram of piezoelectric transducer,
in this case the x‚àídirection of the tube scanner depicted in Figure 5.48, which
is integrated in a capacitive bridge circuit. The ratio of the capacitances in
both vertical branches of the capacitive bridge is equal (C1/C2 = Cpz/Cs). If the
piezoelectric transducer is considered for a moment only as a capacitor Cpz,
this implies that the charge distribution in the bridge circuit is in balance
and no diÔ¨Äerential voltage Vm is measured across the bridge.
The piezoelectric transducer is in reality not a pure capacitor, because a force
acting on the piezoelectric transducer will generate an additional charge
Œîq = di jF(t), according to Equation (5.125). This changes the voltage across
the piezoelectric transducer and leads to a charge imbalance in the bridge
circuit, which can be observed by the measurement voltage Vm across the
bridge. This means that external and reaction forces, as they occur at the
load mass of the piezoelectric transducer, can be observed at the capaci-
tive bridge circuit and eventually can be used for force feedback operation
by feeding back the measurement voltage Vm to the power ampliÔ¨Åer via a
feedback controller, as shown in Figure 5.53. This feedback is based on
the self-sensing capability of the piezoelectric transducer and allows for

452
Chapter 5. Electromechanic Actuators
+
-
Cpz
C1
C2
Cs
Vpz
Piezoelectric
transducer
Vs
Vr
Vi
+
+
+
+
-
-
-
-
m         s         r
V
V
V

	
i j
( )
q
d F t

Figure 5.52: Electrical model of a piezoelectric actuator and capacitive bridge cir-
cuit to measure the charge, generated by external forces on the actua-
tor.
(Courtesy of Stefan Kuiper)
+
-
-
+
ui(t)
Gm(s)
ud(t)
A
Gx(s)
Gs(s)
1
1+ r
us(t)
ur(t)

um(t)
x(t)
C(s)
LMS
Figure 5.53: Schematic of the feedback control for active damping of the piezoelec-
tric actuator via self-sensing actuation. The gain Œ≥ and the LMS-block
form an adaptive balancing circuit to cancel gain variations due to
the piezoelectric hysteresis, but have no direct eÔ¨Äect on the active
damping.
(Courtesy of Stefan Kuiper)
active damping of the resonances without the use of an explicit position
sensor to measure the piezoelectric elongation, which is a very cost eÔ¨Écient
implementation to improve the system performance.
A demonstration of active damping to reduce the resonance peak of the
piezoelectric tube-actuator is shown in the Bode plot of Figure 5.54. The red
solid line shows a measured frequency response Gx(s) of the piezoelectric

5.5. Piezoelectric Actuators
453
Magnde (abs)
Phase [deg]
Frequency [Hz]
102
103
104
102
103
104
-180
-90
0
Modelled undamped
Measured undamped
Modelled damped
Measured damped
10-1
10-2
100
Figure 5.54: Bode plot of the measured and modelled frequency response of both
the undamped and the actively damped piezoelectric tube-actuator.
(Courtesy of Stefan Kuiper)
tube without active damping. The blue line shows the frequency response of
the second-order model, which has been Ô¨Åtted to the measured data. Based
on the Ô¨Åtted model a feedback controller C(s) has been designed to dampen
the resonance peak of the tube scanner, resulting in the simulated frequency
response of the controlled model as given by the black line in Figure 5.54.
The green line of the measured frequency response of the transfer Gx(s) with
active damping via the self-sensing actuation circuit conÔ¨Årms the reduction
of the resonance peak by almost a factor ten, as predicted in the simulation.

454
Chapter 5. Electromechanic Actuators
5.6
Choosing the right Actuator Type
With the diÔ¨Äerent presented actuators it seems that a wide choice is available
for any situation. However, in reality each of the presented actuators has
such unique properties that their use is limited to certain applications.
A suitable method to organise the decision process for each application is
to Ô¨Årst cancel the options that cannot work. For instance for long motion
range actuation with high precision only electronically commutated linear
electromagnetic actuators or stepping piezoelectric actuators can be used.
Electromagnetic actuators for the long range are typically used when high
speed and large driving forces under feedback control are needed without
risk of wear. The piezoelectric stepper is typically used for lower speed
applications with less force to avoid slipping and wear of the mover.
For systems that merely rely on feedforward control with or without regular
calibration the actuator position must be deÔ¨Åned, which requires a deÔ¨Åned
stiÔ¨Äness around a stable position. This limits the possibilities to piezoelectric
actuators or spring loaded electromagnetic actuators.
For short to ultrashort ranges in feedback control the other actuators are
applicable. From these, the non-commutated Lorentz actuator has the
largest applicable motion range of up to several millimetres, depending
on the allowable reduction of the force-constant. The balanced reluctance
and hybrid actuators are applicable in motion ranges below one millimetre,
while the piezoelectric actuator can only be used in ranges below ‚âà100 Œºm.
The next step in the decision with short range actuators is the kind of
disturbances the system needs to encounter.
With disturbing forces that act on the Process Sensitivity, like those that
occur on the cutter in machining centres, a stiÔ¨Äactuator is extremely useful.
For that reason often piezoelectric actuators are used.
With disturbing motions that act on the Sensitivity, like with vibrations,
stiÔ¨Äness needs to be avoided and then the Lorentz actuator is often the best
choise.
Finally the hybrid and balanced reluctance actuator show beneÔ¨Åts in eÔ¨É-
ciency (Figure of Merit) relative to Lorentz Actuators for situations where a
moderate actuator stiÔ¨Äness is still allowed.

blank
left
intentionally
page
This

blank
left
intentionally
page
This

Chapter 6
Analogue Electronics in
Mechatronic Systems
Robert Munnig Schmidt
Introduction
Analogue electronic circuits are indispensable in the realisation of a mecha-
tronic system. Both measurement and actuation need control of electric
signals and knowledge about the important behavioural aspects of elec-
tronics is necessary to be able to design a balanced mechatronic system.
This chapter will present low power electronics as applied in measuring,
Ô¨Åltering and control and the power electronics that are used for driving
electromechanic actuators. Generally electronic circuit technology is divided
in two diÔ¨Äerent application domains, digital and analogue. This distinction
has developed over the years into two completely separated Ô¨Åelds. Digital
electronics consist of electronic switches, which are designed to perform
logical functions with binary numbers having only two states, ‚ÄúoÔ¨Ä‚Äù and
‚Äúon‚Äù. These logical devices range from simple ‚ÄúAND‚Äù and ‚ÄúOR‚Äù operands to
fully programmable digital signal processors and micro controllers. It is
however important to recognise that all electronic switches show analogue
behaviour, because of this binary simpliÔ¨Åcation. More so, it is the analogue
behaviour that determines the maximum frequency and switching speed
of these devices. For this reason modern high speed electronic circuits like
processors can only be designed with a clear knowledge of the analogue prop-
457

458
Chapter 6. Analogue Electronics in Mechatronic Systems
Controller
Posion
setpoint
Measured posion
Error
+
-
¬•
Mechanism
Energy
Informaon
Control electronics + soware
Hardware
Electrical
Power
Heat loss
Feedforward
Actuator
Mechanical
Power
Sensor
Ampli%er
D  A
D  A
Electronics
Figure 6.1: Main locations of electronics in a mechatronic system.
erties. Figure 6.1 shows the diÔ¨Äerent areas in a mechatronic system where
electronics determine the functionality, the translation of the control action
into currents for the actuator and the translation of physical properties into
measurement values. With the focus on these mainly analogue processes
within a mechatronic system, analogue electronics determine the behaviour
of a dynamic system by ampliÔ¨Åcation and Ô¨Åltering of signals. Another factor
that justiÔ¨Åes the focus on analogue electronics in this book is the lack of
suÔ¨Écient understanding of electronics by many mechatronic designers with
a non-electronic background. In spite of the large proliferation of electronics
in our society, working with electronic circuits often appears to be a mental
stumbling block for mechanical engineers, due to the more abstract and less
visual character of electronics.
This chapter consists of three sections. Section 6.1 introduces signal ma-
nipulation by passive Ô¨Åltering without ampliÔ¨Åcation. The use of sources
and impedances is explained and a comparison is made between the dynam-
ics of an electronic circuit and mechanical system to show the similarity,
in order to enlarge the mutual inter-domain understanding. Section 6.2
consists of the important non-linear and active building blocks of an elec-
tronic circuit, followed by the design of low-power ampliÔ¨Åers, both for small
signal ampliÔ¨Åcation and active Ô¨Åltering. Section 6.3 presents both linear
and switched-mode power ampliÔ¨Åers. As is true for most of the chapters in
this book, this entire Ô¨Åeld of expertise is large enough to Ô¨Åll many books
without overlap, so necessary limitations are applied with a focus on basic
understanding, rather than in depth analysis. Nevertheless the material
as presented is suÔ¨Éciently suitable for the basic design of electronics in
mechatronic systems of average complexity.

6.1. Passive Linear Electronics
459
6.1
Passive Linear Electronics
Analogue electronics consist of active and passive components. Their dif-
ference is whether energy is added to the signal or not. An ampliÔ¨Åer is a
typical example of an active component, while a resistor is a typical pas-
sive component. Most passive components show a mainly linear relation
between current and voltage. This behaviour is maintained as long as the
components are applied within their speciÔ¨Åed operating conditions. While
these components have often a very low residual non-linearity in the order
of several parts per million, non-linear components like semiconductors
are often very non linear, ranging from only conducting in one direction,
like a diode, to exponential behaviour like a transistor. The latter needs
special measures to make its behaviour more linear. It is important to
Ô¨Årst understand passive linear circuits, before presenting the complexity of
non-linear and active electronics. It will show that even with only passive
components, several useful functions can be realised. This section starts as
a basis with some considerations on electric networks.
6.1.1
Network Theory and Laws
Electric networks consist of a combination of electric sources and diÔ¨Äerent
passive components. The behaviour of the complete network is deÔ¨Åned by
several laws. This section describes these laws, starting with the abstract
deÔ¨Ånition of the voltage and current source, as they are used as the signal
input for the passive circuits, which are presented next.
6.1.1.1
Voltage Source
In Chapter 2 the voltage source was introduced. An ideal voltage source has
an internal electromotive force Fe, which is equal to the external voltage,
even if a current is delivered to the load. As an example from real life, the
mains power supply socket at home in most countries in Europe behaves
almost like an ideal voltage source of approximately 230 V alternating cur-
rent (AC) with a frequency of 50 Hz. This voltage remains almost constant
even when more lighting or stronger appliances are switched on. The word
‚Äúalmost‚Äù refers to the fact that ‚Äúideal‚Äù does not exist in the real world. Just
imagine a voltage source of any arbitrary voltage that could deliver less
than 1 mA or more than 1 GA without any eÔ¨Äect on its voltage. This would
require the source to have the capability of delivering inÔ¨Ånite power and

460
Chapter 6. Analogue Electronics in Mechatronic Systems
+
_
+
_
+
_
Figure 6.2: The diÔ¨Äerent symbols of a voltage source, which are used in schematic
diagrams of electronic circuits, show the sign of the voltage by means
of a plus and minus. Sometimes the minus is left away. The most right
version of these symbols is used in this book, as it clearly emphasises
the zero source impedance of an ideal voltage source.
that is unfortunately impossible. Nevertheless the example of the mains
supply is a very close approximation of an ideal voltage source as long as
the currents are kept within reasonable limits. In a real voltage source,
the external voltage is not fully equal to the electromotive force, due to an
internal series impedance, originating from its physical properties. One
can think of the internal wiring, the size of chemical electrodes and storage
components and aspects related to the chemical separation of charge. This
series impedance shows an internal electric Ô¨Åeld, opposite to the electro-
motive force, just like inside an external load. This Ô¨Åeld depends on the
current and results in a change of the voltage diÔ¨Äerence over the electrodes
of the source. In case of a resistive impedance, the voltage will be lower
at an increased delivered current. An ideal voltage source would have no
internal series impedance and a voltage source can be approximated
as a conducting wire when the inÔ¨Çuence of another electric source
in the circuit has to be examined. This was shown in Chapter 5 about
the interaction between an actuator and an ampliÔ¨Åer, where the current
from the two voltage sources could be derived separately by short-circuiting
the other voltage source.
For this reason the version of the symbol, which is located at the right in
Figure 6.2, is used in this book when drawing a schematic diagram of an
electronic circuit.
6.1.1.2
Current Source
Most electronic circuits can be modelled with a voltage source, but some-
times it is more practical to work with the other extreme source of electricity,
the current source. An ideal current source delivers a positive or negative
current, which is independent of the impedance of the conductive load and
as a consequence the current is independent of the voltage. This function-
ality is less easy to understand from reasoning, when using the model of
an internal electrical Ô¨Åeld. Instead one might use the thinking model of

6.1. Passive Linear Electronics
461
Figure 6.3: The diÔ¨Äerent symbols of a current source show the direction of the
current by means of an arrow. The most right version of these symbols
is used in this book because of the clear semantics of the ‚Äúblocking‚Äù line,
representing the inÔ¨Ånite internal impedance.
an active controlled voltage source, which adapts its electromotive force
actively to the load in order to keep the current at the same level. It will
be shown later that a current source is generally created by applying cur-
rent feedback on a voltage source. When a current source is applied in a
circuit, another external voltage source, like the movement induced voltage
of an actuator, will not inÔ¨Çuence the current anymore. This implies that an
ideal current source acts like an open wire for the current that is induced
by other electric sources. In other words, a current source has an inÔ¨Ånite
output impedance. It is indeed true that the basic model of a current source
is a voltage source with an inÔ¨Ånite electromotive force and an inÔ¨Ånite se-
ries resistance. This very artiÔ¨Åcial model is the reason for the preferred
symbol as shown at the right side of Figure 6.3, as a current source can
be replaced by an open connection when the inÔ¨Çuence of another
electric source in the circuit has to be examined. It is also obvious
that an ideal current source can not exist either. An ideal current source
would imply for example that a continuous lightning Ô¨Çash over an inÔ¨Ånite
distance could be created. Nevertheless an almost ideal current source
can be created that operates over a limited voltage range and it is a very
important element in mechatronic systems in two ways. First of all, several
sensors in measurement systems behave like a current source when the
voltage is kept within a certain range. But even more important is the
need for a current source when supplying an actuator with electrical power.
In Chapter 5 it was shown that a low impedance of the source results in
damping and unwanted transmissibility of external vibrations through the
actuator. With the application of a current-drive power ampliÔ¨Åer, which will
be presented in Section 6.3, that eÔ¨Äect can be prevented.

462
Chapter 6. Analogue Electronics in Mechatronic Systems
6.1.1.3
Theorem of Norton and Thevenin
A real electric source can be modelled in two ways. The Ô¨Årst consists of
a voltage source in series with a Ô¨Ånite impedance and is postulated by
the French telegraph engineer Leon Charles Thevenin (1857-1926). The
second method of a current source with that same impedance in parallel
was postulated by the American electrotechnical engineer Edward Lawry
Norton (1898-1983). Both versions are shown in Figure 6.4.
The Thevenin model is again the most straightforward to imagine. An
external current Il through a load Zl will cause a voltage drop over the
internal series impedance Zs, resulting in a lower voltage over the electrodes
of the source. The Norton model can be explained by deÔ¨Åning the current
IN to be equal to the maximum current Il,max that can be delivered by the
source in the Thevenin model. This maximum current occurs when the
electrodes are short-circuited and equals with Ohm‚Äôs law:
IN = Il,max = VTh
Zs
[A].
(6.1)
With this value, the voltage at the electrodes of both systems would be equal
to VTh, when no load is connected to the electrodes. As soon as a load Zl
starts to pull a current Il, the voltage at the electrodes of the Thevenin
model will drop with ZsIl, due to the series impedance Zs. With the Norton
model, the same current Il will reduce the current through the parallel
impedance Zs, giving the same voltage drop over the electrodes.
Zs
+
_
_
Vo
_
Vo
VTh
IN
+
+
Zs
Zl
Zl
Il
Il
Figure 6.4: Equivalent representation of real electric sources. The Thevenin model
at the left consists of a voltage source with a series impedance. The
Norton model at the right consists of a current source with a parallel
impedance with the same value Zs as with the Thevenin model. The
relation between VTh and IN follows from Ohm‚Äôs law: VTh = INZs.

6.1. Passive Linear Electronics
463
+
_
V1
Z2
V3
Z3
I2
V2
node
+
+
_
I1
I3
_
Z1
+
_
loop
Figure 6.5: The laws of KirchhoÔ¨Ä. The currents at a node in a circuit add to zero
(I1+I2+I3 = 0). Also the voltages over a closed-loop add to zero (V1+V2+
V3 = 0). As long as the voltage and current directions are well deÔ¨Åned,
these laws help to calculate voltages and currents in complex electrical
networks.
6.1.1.4
KirchhoÔ¨Ä‚Äôs Laws
Besides Ohm‚Äôs law, as described in Chapter 2, two other important laws
regarding electronic circuits need to be mentioned. They were named after
Gustav Robert KirchhoÔ¨Ä(1824-1887), the German physicist who postulated
them. KirchhoÔ¨Ä‚Äôs laws are related to the currents and voltages in a network
of electronic impedances. The Ô¨Årst of KirchhoÔ¨Ä‚Äôs laws deals with the currents
at a connecting point in a network and is based on the understanding that
charge can not be stored at a connection point.

Inode = 0
[A].
(6.2)
The second of KirchhoÔ¨Ä‚Äôs laws states that the sum of voltages over any
closed-loop in an electronic circuit can only equal zero.

Vloop = 0
[V].
(6.3)
This is shown as an example in Figure 6.5.
6.1.1.5
Impedances in Series or Parallel
With the presented laws the currents and voltages in several electric circuits
can be calculated. One example is the situation where diÔ¨Äerent impedances
are combined in series or parallel as shown in Figure 6.6. In the situation
with two impedances in series, the current is shared and the impedance of
the combination becomes:
Zserial = Vt
It
= V1 +V2
It
= ItZ1 + ItZ2
It
= Z1 + Z2
[Œ©].
(6.4)

464
Chapter 6. Analogue Electronics in Mechatronic Systems
Z1
Z2
Zs

V1
V2
Vt
Z1
Z2
Zp

It
I2
I1
It
It
It
Vt
Vt
serial 
parallel
Vt
Figure 6.6: Impedances in series simply add to the total impedance, as they share
the same current, while the total voltage equals the sum of the voltage
over each impedance. Parallel impedances share the same voltage,
while the currents are divided over the impedances.
With two parallel impedances, the voltage is shared and the impedance of
the combination becomes:
Zparallel = Vt
It
=
Vt
I1 + I2
=
Vt
Vt
Z1
+ Vt
Z2
=
1
1
Z1
+ 1
Z2
[Œ©].
(6.5)
6.1.1.6
Voltage Divider
Figure 6.7 shows a voltage divider, consisting of two impedances.
To calculate the output voltage, Ô¨Årst the total current I from the source Vin
into the series circuit Z1 + Z2 is calculated and multiplied with Z2 to get the
voltage over Z2.
I =
Vi
Z1 + Z2
[A],
Vo = IZ2 =
Z2Vi
Z1 + Z2
[V].
(6.6)
The relation between the output voltage Vo and the input voltage Vi equals:
Vo
Vi
=
Z2
Z1 + Z2
(6.7)

6.1. Passive Linear Electronics
465
I
I
+
Vi
R1
R2
Vo
I
+
I
a: Voltage divider                        b: Thevenin equivalent             c: Potenometer
_
Th
V
Vi
Z1
Z2
+
_
+
_
Vo
Vo
+
_
+
_
ZTh
_
Figure 6.7: A voltage divider consists of two serial impedances and is based on
the principle of the shared current. The voltage Vi gives a current I
determined by the sum of both impedances, while the output voltage
Vo is determined by the current and Z2 only. A special version of the
voltage divider is the potentiometer, which can vary the ratio between
its resistive impedances R1 and R2 to control the output voltage by a
slider.
The equivalent circuit according to Thevenin is shown in the middle drawing
of Figure 6.7.
The Thevenin voltage equals:
VTh = Vin
Z2
Z1 + Z2
[V].
(6.8)
To Ô¨Ånd the Thevenin impedance a special insight is used, stating that this
impedance is equal to the impedance of all paths inside the electric circuit
as observed from the outside. To determine that impedance a voltage source
can be replaced by a conducting wire and a current source can be replaced
by an open wire. In the situation of the voltage divider this means that ZTh
is equal to Z1 and Z2 in parallel as the impedance of the voltage source is
zero:
ZTh =
1
1
Z1
+ 1
Z2
[Œ©].
(6.9)
With these values also the Norton equivalent of the voltage divider can be
modelled according to Figure 6.4.
A special execution of a voltage divider is the potentiometer as shown at the
right drawing of Figure 6.7. A potentiometer consists of a resistor from the
input to ground with a conductive slider, which contacts the resistor on a
location that is determined by an external rotating or translating element.
The potentiometer creates a variable voltage at the output as function of
the position of the slider.

466
Chapter 6. Analogue Electronics in Mechatronic Systems
6.1.1.7
Maximum Power of a Real Voltage Source
A real voltage source consists of an ideal voltage source with an internal
source impedance. It is interesting to investigate the maximum power the
source can deliver, because it is to be expected that the internal impedance
will limit this power. In Chapter 2 it was explained that only resistive
impedances dissipate power, which means that only the resistor value of
the source impedance needs to be taken to calculate the internal power loss,
dissipated when a current is delivered to an electric load. This external
load is for this simpliÔ¨Åed example approximated by a simple resistor and
in that case the combined circuit behaves like a resistive voltage divider as
shown at the right circuit diagram of Figure 6.8.
The output power in the load resistor equals the resistor value of the load
times the current squared:
Po = I2
oRo
[W],
Io =
Vi
Ro + Ri
[A].
=‚áí
Po = V 2
i
Ro
(Ro + Ri)2 =
V 2
i Ro
R2o +2RoRi + R2
i
=
V 2
i
Ro +2Ri +
R2
i
Ro
[W].
(6.10)
This expression goes to zero for Ro = 0, which corresponds to the fact that
then the output voltage is zero, and when Ro = ‚àûbecause then the output
current is zero. The output shows a maximum when Ro = Ri, which can
be proven by Ô¨Ånding the value of Ro that equals to a zero value of the
diÔ¨Äerentiation of the denominator of Equation (6.10) to Ro:
d
,
Ro +2Ri +
R2
i
Ro
-
dRo
= ‚àí
R2
i
R2o
+1.
(6.11)
which is zero for Ro ¬± Ri corresponding to a maximum for the output power.
At the left side of the Ô¨Ågure this useful output power is shown graphically
together with the graph of the power delivered by the internal ideal voltage
source (Ps = ViIo), the power loss in the internal resistor (Pi = I2
oRi) and the
eÔ¨Éciency being the output power divided by the source power. This graph
shows that the source will deliver the maximum power with a very small
value of the load resistance but most of this power is dissipated internally
into heat. This is a phenomenon one can observe when short-circuiting a
battery with sometimes hazardous eÔ¨Äects when this is done with a Lithium
based battery! It is also shown that the maximum useful output power
equals only 25 % of the maximum power the source can deliver.

6.1. Passive Linear Electronics
467
0
2
4
6
8
10
1
0.8
0.6
0.4
0.2
0
Normalised power
¬ô¬¶
+
Vi
Ri
Ro
Vo
+
_
Ri
Ro
&
# P
Output power P
¬ãP
¬ô¬¶
i
o
Real
$
&
load
I
I
o
o
s
Figure 6.8: The maximum power from a real voltage source is 25 % of the intrinsic
power capability of the source and this maximum occurs when the
external resistive load is equal to the resistive value of the source
impedance. The eÔ¨Éciency is then only 50 %.
The above reasoning should not be misunderstood. For a given real source
the maximum power is obtained when the connected load impedance equals
the internal impedance of the source. The eÔ¨Éciency is then however only
50 % and for a higher eÔ¨Éciency the load impedance needs to be signiÔ¨Åcantly
smaller than the source impedance. This means that from an eÔ¨Éciency point
of view it is better to not use a power supply at its theoretical maximum
power capability. With for example a battery it implies that the total energy
should be drained over an extended period of time, which is mostly the case.
When the battery is loaded at is maximum output power the output voltage
would be half and then half the energy would be wasted in heat inside the
battery. An example where the maximum transfer of power is aimed for is
in transport of signals over a long cable, terminated with its characteristic
impedance, a term that will be explained in more detail in Chapter 8. With
a cable of for instance a characteristic impedance of 50 Œ©, the source before
the cable and the load after the cable should both have an impedance of the
same 50 Œ© and in that case the maximum signal power is transferred that
the source could deliver. This maximum power level guarantees a maximum
signal to noise ratio.

468
Chapter 6. Analogue Electronics in Mechatronic Systems
6.1.2
Impedances in Electronic Circuits
The complex impedance Z can have aspects of three diÔ¨Äerent properties, a
frequency independent part, corresponding to a resistor, a part where the
impedance decreases with the frequency, the capacitor and a part where
the impedance increases with the frequency, the inductor. Figure 6.9 shows
the symbols of these elements as used in an electronic circuit diagram.
Mostly the elements are indicated as separate items and as a consequence
it looks like they are physically separable. This is not always the case.
In Chapter 5 the electrical equivalent of an electromagnetic actuator was
presented, consisting of a voltage source, an inductor and a resistor. These
elements all were a property of the same element, the coil, so by deÔ¨Ånition
they are not separable. In electronic circuits mostly the elements are indeed
treated as separate functional building blocks and for most less-critical
applications this is quite suÔ¨Écient.
6.1.2.1
Resistors
The simplest passive element is the resistor (R in ohm (Œ©))with a frequency
independent impedance, because of its non-complex, real character. The
relation between voltage and current is according to Ohm‚Äôs law and as a
consequence of the real impedance, the voltage and current have a propor-
tional relation without time dependency so they are always in phase. For
that reason, the power dissipated in a resistor equals the scalar product of
the momentary voltage and the current value.
Pl = IV
[W].
(6.12)
To get an idea about the variety of resistors, Figure 6.10 shows an overview
of several types of resistors that are used in practical electronic circuits.
Resistors exist in an enormous range of resistance values from less than
1 Œ© to more than 1 GŒ©. This range is available in almost the same size,
which makes them suitable in almost any application. Resistors are realised
with diÔ¨Äerent technologies, ranging from winding a metal wire with a high
resistivity (wire-wound resistor) to the application of a thin carbon- or
metal layer on a non-conductive ceramic round-or-rectangular body. In the
latter case, the correct resistance value is obtained by trimming part of the
resistive layer away with a laser. These carbon or metal Ô¨Ålm resistors are for
instance recognisable in the Ô¨Ågure by the colour code rings, which indicate
the value. Over the years, the electronic industry has made their best eÔ¨Äort
to achieve almost ideal properties of all electronic elements. Nevertheless

6.1. Passive Linear Electronics
469
Resistor (R)
Capacitor (C)
Inductor (L)
+
Figure 6.9: Symbols of the passive elements or ‚Äúbuilding blocks‚Äù in an electronic
circuit. The two symbols for a resistor are equivalent. The left symbol
of the capacitor is a normal capacitor, where the right symbol is a po-
larised electrolytic capacitor. This type needs a unidirectional potential
diÔ¨Äerence to retain the high capacitance and avoid current leakage.
The two symbols of the inductor are also equivalent.
always some parasitic characteristics are present, unwanted properties
that need to be considered in critical applications. A resistor always has
some additional series or parallel capacitance and self-inductance, while
requirements on these properties diÔ¨Äer per design. Next to the parasitic
eÔ¨Äects the maximum dissipated power and the allowable temperature have
given a boost to the enormous diversity in resistors. High power resistors
are mainly wire wound, because of the insensitivity of the metal to high
temperatures. These high power resistors are recognisable by their size, the
often visible winding structure and the possible mounting to a heat sink,
like shown with the green, the white and gold resistors on the photograph.
Figure 6.10: An overview of diÔ¨Äerent resistors.

470
Chapter 6. Analogue Electronics in Mechatronic Systems
As a consequence of the windings, wire wound resistors show a relatively
high parasitic self-inductance, which makes them less suitable for high-
frequency applications. With small high-frequency signals, the Surface
Mount Devices (SMDs) are preferred as they can directly be mounted on
a printed circuit board (PCB) without lead wires, which otherwise could
introduce some self-inductance. SMD components are most frequently used
in low power modern electronics and recognisable in the Ô¨Ågure as the little
white and blue blocks in the middle. Although resistors have also some
parasitic capacitance, depending on the size and the type, that capacitance
is only important when really high frequencies are used like in precision
measurement systems where often low-frequency signals are modulated
with a high-frequency signal.
6.1.2.2
Capacitors
In Section 2.3.2.3 of Chapter 2 on electricity, the capacitive impedance was
introduced. Capacitors are electronic components of which the impedance
is mainly capacitive with an impedance proportional to the inverse of the
frequency:
Z(œâ) = 1
œâC
[Œ©].
(6.13)
The capacitance value of a practical capacitor covers an extremely wide
range from several Farad to smaller than one pico Farad. Initially large
capacitors were very diÔ¨Écult to obtain. Just think of a metal plate of 1 m2 at
a distance of 100 Œºm in air. This results in a capacitance of only ‚âà1¬∑10‚àí7 F.
For this reason most practical capacitor values are given in either pF (10‚àí12),
nF (10‚àí9) or ŒºF (10‚àí6).
Figure 6.11 shows a small sample of the large variety of available capacitors.
The largest capacitance values are achieved with electrolytic capacitors
ranging from a few hundred nF to around 10.000 ŒºF, the blue and green
ones and the aluminium tube with the nut. Electrolytic capacitors consist
of two thin foils with a large surface of mostly aluminium, covered with
an insulating oxide layer that acts as a high permittivity layer between
the conductive foils. These foils are wound with a thin porous layer in be-
tween, which is soaked with an electrolyte that is conductive and keeps the
oxide layer in good order at the occasion of a damaged part in the oxide-
layer. This self-healing eÔ¨Äect improves their initially low reliability, but
after some time the capacitance will inevitably reduce as a side eÔ¨Äect of the
renewed oxidation. The thin oxide layer with a high relative permeability is

6.1. Passive Linear Electronics
471
Figure 6.11: An overview of diÔ¨Äerent capacitors.
the cause for the initially high capacitance and for that reason electrolytic
capacitors are mostly applied in power supplies to store energy. Recent de-
velopments on a variation on electrolytic capacitors with an electrochemical
double layer, have increased the maximum capacitance to over one Farad.
Although their maximum voltage per cell is limited, the high energy den-
sity of these super-capacitors makes them applicable in applications where
energy should be stored and regained over a large multitude of cycles, in
situations where batteries suÔ¨Äer from a limited lifetime and reliability, like
in satellites. Other smaller capacitors are made by winding thin foils of
conductive material with intermediate non-conductive foils of a synthetic
material with favourable dielectric properties, (the other round capacitors
in the Ô¨Ågure). Their capacitance ranges from around 100 pF to 100 ŒºF. The
smallest capacitor values are realised with single- or multilayer ceramic
bodies with a metal layer as plate material. They can range between 1 pF
at voltages over 1 kV to 100 ŒºF at low voltages below 10V.
Parasitic Properties of Capacitors
When designing electronic circuits one should be aware of the diÔ¨Äerent
parasitic properties of each applied component. Especially with capacitors a
wrongly chosen type of capacitor can inÔ¨Çuence the performance of the total
system in a negative way.
The electrolytic and foil capacitors both suÔ¨Äer from a parasitic resistance

472
Chapter 6. Analogue Electronics in Mechatronic Systems
and some self-inductance, because of the long windings with thin foil. The
parasitic resistance is represented by its equivalent series resistance (ESR),
which limits the minimum impedance at high frequencies and induces a
loss of power. For high-frequency applications, the ceramic capacitor is pre-
ferred as it shows the least parasitic inductance and resistance and it is also
available in an SMD shape. The properties of ceramic capacitors, however,
depend strongly on the applied dielectric. A three character coding system is
used that speciÔ¨Åes the applicable temperature range and temperature
sensitivity in two classes, Class 1 for high stability and Class 2 for high
capacitance. Unfortunately two standards exist, one from IEC and one from
EIA, which can be found on internet. In practice only a limited subset of
dielectrics are used for regular capacitors. For higher capacitance values
most often X5R or X7R is used, which have a temperature range from -55
till 85‚ó¶C resp 125 ‚ó¶C at ¬±15% temperature sensitivity. For high stability
applications C0G/NP0 is used with a temperature sensitivity of 0¬±30¬∑10‚àí6
per ‚ó¶C at a lower dielectric constant, which limits their use to the lower
range of the capacitance value up till approximately 33 nF.
More important even for mechatronic purposes are the piezoelectric prop-
erties of the ceramics. Vibrations on the electronic circuit cause proportional
voltages over the capacitors, which are inserted in the electronic circuit
as disturbances. This is especially harmful when the capacitors are used
in the measurement path of a feedback controlled system. Unfortunately
this sensitivity is in general not speciÔ¨Åed so one should check this on a
working circuit. If the circuit appears to be sensitive for vibrations it is
easy to determine the sensitive capacitor(s) by ‚Äúhitting‚Äù it with some non
conductive stick. In case piezoelectricity must me completely avoided, only
Class 1 material like NPO/COG should be used as this is not piezoelectric.
6.1.2.3
Inductors
In Section 2.3.2.4 of Chapter 2 on electricity, also the inductive impedance
was introduced. Inductors, often just named ‚Äúcoils‚Äù are electronic compo-
nents of which the impedance is mainly inductive:
Z(œâ) = jœâL
[Œ©].
(6.14)
In reality, inductors are all made by winding wires around a core as can be
seen in Figure 6.12. This core can consist of a material with a high relative
permeability to achieve a high self-inductance or a low permeability for
reason of linearity. For very high frequencies even a core can be omitted

6.1. Passive Linear Electronics
473
Figure 6.12: An overview of diÔ¨Äerent inductors and ferromagnetic cores.
and only a section with a spiral track on a printed circuit board can suit the
purpose. With some numbers in a real coil with n = 100 windings, a core
diameter (A) of 10*10 mm, a core length (l) of 100 mm and a Œºr of 100, the
following value of the self-inductance is obtained:
L = n2
‚Ñú= n2Œº0ŒºrA
l
= 104 ¬∑4œÄ¬∑10‚àí7 ¬∑100¬∑10‚àí4
0.1
= 1.25¬∑10‚àí3 H.
(6.15)
For this reason the values of inductors are often given in mH or ŒºH.
Parasitic Properties of Inductors
Practical inductors suÔ¨Äer also from many diÔ¨Äerent parasitic properties. The
intimately wound windings show a signiÔ¨Åcant parasitic capacitance and
resistance. When high currents are involved and a large self-inductance
is required, the size of the inductor will be large. Also the core gives many
problems. First of all the relative permeability is depending on the mo-
mentary Ô¨Çux density and limited by saturation. This means in practice
that the self-inductance is reduced at larger current levels. Secondly the
changing Ô¨Çux inside the core will induce eddy-currents within the core when
the core is made from conductive material like iron. This phenomenon was
explained in Chapter 5 with the eddy-current ring in a Lorentz actuator.
The eddy-currents in the core of an inductor will reduce the eÔ¨Äective self-
inductance and will result in dissipated energy, because the eddy-currents
run in a resistive material. The eddy-currents can be limited by using a
non-conductive core material. An ideal group of materials in that respect
are the ferrites, sintered material consisting of insulated, partly oxidised
iron particles. Also a plastic compound of Iron particles with a thin oxide

474
Chapter 6. Analogue Electronics in Mechatronic Systems
layer can be used. For low frequencies the eddy-current losses can be suÔ¨É-
ciently limited by laminating the ferromagnetic iron core in thin sheets. The
lamination should be in the direction of the Ô¨Çux to have the maximum eÔ¨Äect,
because the eddy-currents are running perpendicular to the Ô¨Çux lines.
Another loss in the core is caused by the magnetic hysteresis. Contrary to
permanent magnet materials, the ferromagnetic core of an inductor should
ideally show no hysteresis. It is interesting to know that ferrites both can
be designed to have a high hysteresis to create a permanent magnet, like
mentioned in Chapter 5 as for having an extremely low hysteresis for in-
ductor cores, all at acceptable cost levels. For laminated cores an alloy of
iron with 2 ‚Äì 5 % of silicon is a well-known material with a low hysteresis
and is widely used in power transformers, rotating electrical machines and
electromagnetic actuators.
6.1.3
Passive Filters
Electronic Ô¨Ålters are frequently applied in mechatronic systems for selecting
frequency areas of interest in the signal, the pass-band, or for rejecting fre-
quency areas that introduce noise and other disturbances, the attenuation-
band. Filters are also applied for correcting phase properties in feedback
systems while a controller itself is also in principle nothing more than a
complex Ô¨Ålter. The Ô¨Åeld of electronic Ô¨Ålters is very large and consists of
passive Ô¨Ålters with only resistors, capacitors and inductors and active Ô¨Ålters
with ampliÔ¨Åers. Passive Ô¨Ålters are mainly used in those situations where
it is not possible to use an ampliÔ¨Åer. This is for instance the case between
a power ampliÔ¨Åer and an actuator, like with the switched-mode power am-
pliÔ¨Åers of Section 6.3. But also with sensors at remote places and/or high
temperatures passive Ô¨Ålters can be useful.
6.1.3.1
Passive First-Order RC-Filters
The most basic Ô¨Ålter conÔ¨Åguration is the RC-Ô¨Ålter, which is derived from the
voltage divider of Figure 6.7, where one of the impedances is a frequency
dependent component, like for instance a capacitor. The Ô¨Årst Ô¨Ålter to explain
this principle is a Ô¨Årst-order low-pass Ô¨Ålter, which can be used for instance
to reject noise above the cut-oÔ¨Äfrequency or corner-frequency œâ0 of the Ô¨Ålter.
This Ô¨Ålter consists of a capacitor and a resistor as shown in Figure 6.13.
As the impedance of the capacitor decreases with increasing frequency it can
be reasoned that this Ô¨Ålter reduces the amplitude of the higher frequencies

6.1. Passive Linear Electronics
475
+
_
Vi
Z1=R
Vo
+
_
2
1
Z
j C


z¬Å{
z){
z[{
z¬Ç{
z,{
{
Magnitude [dB]
,{
{
,{
,
,{
¬Ç
,{
[
,{
)
z¬Ö{
z)¬Å
{
Phase [deg]
Frequency  [Hz]
Magnitude (abs)
,{
,
,{
¬Ç
,
Figure 6.13: An RC low-pass Ô¨Ålter network and the Bode plot of its frequency re-
sponse with R = 15 kŒ© and C = 0.1 ŒºF, giving a time constant œÑ = 1.5 ms.
The increasing impedance Z2 of the capacitor reduces the magni-
tude of the output signal at frequencies above the corner-frequency
f0 = œâ0/2œÄ ‚âà100 Hz, where the magnitude of Z2 becomes larger than
Z1.
above the frequency, where the impedance of the capacitor becomes smaller
than the impedance of the resistor. To derive the frequency response F(œâ)
of this Ô¨Ålter Equation (6.7) of the voltage divider is used:
F(œâ) = Vo
V i =
Z2
Z1 + Z2
.
(6.7)
With Z1 = R, Z2 = 1/jœâC, the frequency response equals:
F(œâ) = Vo
Vi
=
1
jœâC
R +
1
jœâC
=
1
jœâRC +1.
(6.16)
At this point, the time constant œÑ = RC also called the RC-time can be
introduced. RC is inversely proportional to the frequency œâ, because Equa-
tion (6.16) is dimensionless, so it has the unit of time. It is also known from
control theory that the time constant œÑ deÔ¨Ånes the step response of a system
starting at zero:
V = Vst

1‚àíe‚àít
œÑ

[V].
(6.17)
With the time constant œÑ, Equation (6.16) becomes:
F(œâ) =
1
jœâœÑ+1.
(6.18)

476
Chapter 6. Analogue Electronics in Mechatronic Systems
+
_
Vi
Z2=R
Vo
+
_
1
1
Z
j C


z¬Å{
z){
z[{
z¬Ç{
z,{
{
Magnitude [dB]
,{
{
,{
,
,{
¬Ç
,{
[
,{
)
{
)¬Å
¬Ö{
Phase [deg]
Frequency  [Hz]
Magnitude (abs)
,{
,
,{
¬Ç
,
Figure 6.14: An RC high-pass Ô¨Ålter network and the Bode plot of its frequency re-
sponse with R = 15 kŒ© and C = 0.1 ŒºF, giving a time constant œÑ = 1.5 ms.
The increasing impedance Z2 of the capacitor reduces the magni-
tude of the output signal at frequencies below the corner-frequency
f0 = œâ0/2œÄ ‚âà100 Hz, where the magnitude of Z2 becomes larger than
Z1.
To determine the amplitude at the corner-frequency œâ0 = 1/œÑ, the absolute
value of the frequency response is calculated by taking the root of the sum
of the squared real and imaginary term of the numerator and denominator:
|F(œâ0)| =

12
12 +12 =
5
1
2 = 0.707...(in dB: -3 dB).
The Bode plot of this Ô¨Ålter is shown in Figure 6.13 for an example with
R = 15 kŒ© and C = 0.1 ŒºF. This gives a time constant of œÑ = 1.5 ms and a
corresponding corner-frequency of œâ0 = 1/œÑ ‚âà660 rad/s and f0 = œâ0/2œÄ ‚âà100 Hz.
The ‚àí1 slope of the magnitude with -20 dB per decade is as expected with a
Ô¨Årst-order system.
It is important to note that the characteristics of a passive Ô¨Ålter are inÔ¨Çu-
enced by the load after the Ô¨Ålter. When for example the Ô¨Ålter of Figure 6.13
would be loaded with a resistive load, equal to Z1, two eÔ¨Äects would be ob-
served. Firstly the gain of this Ô¨Ålter in the pass-band would have a value of
0.5, because the load and Z1 would act like a frequency independent voltage
divider. Secondly the cross-over frequency would be a factor 2 higher. Both
eÔ¨Äects can be calculated by Ô¨Årst determining the equivalent Thevenin source
voltage and impedance of Z1, combined with the load and then combine that
system with the capacitor.

6.1. Passive Linear Electronics
477
To prevent this eÔ¨Äect, these Ô¨Ålters are commonly combined with buÔ¨Äer am-
pliÔ¨Åers with a very high input impedance and low output (source) impedance.
These will be presented later.
The second Ô¨Ålter of this kind is the high-pass Ô¨Ålter, as used for instance to
reject the DC value of a signal. Its basic design consists also on a capacitor
and a resistor, but their location is exchanged as shown in Figure 6.14. It
is clear that at low frequencies the high impedance of the capacitor will
prevent low-frequency current to Ô¨Çow into the output resistor.
Also with the high-pass Ô¨Ålter Equation (6.7) is used to derive the frequency
response F(œâ):
F(œâ) = Vo
Vi
=
Z2
Z1 + Z2
.
(6.19)
With Z1 = 1/jœâC, Z2 = R and œÑ = RC the frequency response becomes:
F(œâ) = Vo
Vi
=
R
1
jœâC + R
=
jœâRC
jœâRC +1 =
jœâœÑ
jœâœÑ+1.
(6.20)
The diÔ¨Äerence with the low-pass Ô¨Ålter is the jœâ term in the numerator, corre-
sponding to the diÔ¨Äerentiating Laplace operator s, which gives +1 slope with
90¬∞phase lead and a 0 dB corner-frequency at œâ0 = 1/œÑ. This term, combined
with the frequency response of the low-pass Ô¨Ålter, results in the Bode plot of
Figure 6.14 for the same values of the resistor and the capacitor.
Also with this Ô¨Ålter a loading impedance over V0 will inÔ¨Çuence its character-
istics. Even though the high-frequency pass-band gain will not be changed,
the load impedance comes parallel to Z2 resulting in an increase of the
cross-over frequency with more attenuation at lower frequencies.
6.1.3.2
Passive Higher-Order RC-Filters
Often the attenuation of unwanted frequencies is required to be stronger
than what is obtained with simple Ô¨Årst-order Ô¨Ålters. To create Ô¨Ålters with a
higher attenuation, a higher order Ô¨Ålter needs to be applied. In principle
this can be done by cascading several Ô¨Årst-order Ô¨Ålters. Figure 6.15 shows a
third order conÔ¨Åguration with a special measure to prevent mutual interfer-
ence between the three Ô¨Ålter sections. Normally the simple combination of
identical passive Ô¨Ålter sections introduces several problems, because each
Ô¨Ålter section would determine a load for the preceding section. To reduce
these eÔ¨Äects, the value for the resistor of each following segment can be
chosen for instance a factor 10 higher than the resistor value in the preced-
ing section, as shown in the Ô¨Ågure. This helps reducing the problem, but

478
Chapter 6. Analogue Electronics in Mechatronic Systems
+
_
Vi
Vo
+
_
Z1=R1
2
1
1
Z
j C


4
2
1
Z
j C


6
3
1
Z
j C


Z3=R2
Z5=R3
3
2
1
1
2
3
10
100
10
100
               
R
R
R
C
C
C








Figure 6.15: Creating a third order low-pass Ô¨Ålter by cascading three Ô¨Årst-order
Ô¨Ålters is possible with minimal mutual load. It is however better
to introduce buÔ¨Äer ampliÔ¨Åers, as the output impedance of the Ô¨Ålter
becomes very high.
it means that the eÔ¨Äective output impedance of the combined Ô¨Ålter would
become very high. For that reason it is preferred to insert intermediate
buÔ¨Äer ampliÔ¨Åers with a gain of one, like shown in Figure 6.16. How these
ampliÔ¨Åers are made will be presented later in this chapter. For the expla-
nation of the principle, it is suÔ¨Écient to accept that these ampliÔ¨Åers allow
to combine the separate sections without mutual inÔ¨Çuence, because they
oÔ¨Äer a very high input impedance with a very low output impedance. In
that case the combined frequency response becomes a simple multiplication
of the frequency responses of the separate Ô¨Ålters:
F(œâ) =
1
(jœâœÑ1 +1)(jœâœÑ2 +1)(jœâœÑ3 +1).
(6.21)
For an RC-time œÑ1 = œÑ2 = œÑ3 = 0.01 s, the result is shown in the Bode plot of
Figure 6.16. The Ô¨Ågure clearly shows that the slope in the attenuation band
is increased, but the transition to the pass-band is far from ideal. At the
corner-frequency f0 = œâ0/2œÄ ‚âà100 Hz, the attenuation is already 9 dB and
the pass band bandwidth at -3 dB is at ‚âà0.5√ó the corner-frequency, with a
very gradual transition to a slope of ‚àí3.
As will be presented in the Section 6.2.5 on active Ô¨Ålters, this trade-oÔ¨Ä
between the properties in the attenuation-band and the pass-band can be
optimised by the application of positive feedback, which is equal to increasing
the imaginary term of the poles of the transfer function in the Laplace-
domain. When combining only Ô¨Årst-order Ô¨Ålters all poles are located on the
real axis, which implies a very high damping of the higher order Ô¨Ålter. By
relocating the poles, the gain at the cross-over frequency can be increased
while keeping an acceptable steep slope in the attenuation band. It is
worthwhile to add to this statement that it is not possible to create an ideal
Ô¨Ålter with an inÔ¨Ånitely steep slope, without phase and magnitude eÔ¨Äects in

6.1. Passive Linear Electronics
479
+
_
Vi
Vo
+
_
G=1
Z1=R
Z3=R
Z5=R
G=1
G=1
2
1
Z
j C


4
1
Z
j C


6
1
Z
j C


z¬Ü{
z¬É{
z){
z¬Ç{
{
Magnitude [dB]
,{
1
,{
¬Ç
,{
3
z¬Ç¬Ñ{
z,¬Ü{
z¬Ö{
{
Phase [deg]
Frequency  [Hz]
Magnitude (abs)
,{
-1
,{
¬Ç
,{
-3
,{
)
1
Figure 6.16: Cascading three Ô¨Årst-order low-pass Ô¨Ålters with intermediate buÔ¨Äer
ampliÔ¨Åers results in a very gradual transition between the pass band
below the corner-frequency and the attenuation band above f0. At the
corner-frequency the attenuation is already 9 dB. The Bode plot is
drawn with R = 15 kŒ© and C = 0.1 ŒºF, corresponding to f0 ‚âà100 Hz.
the pass band and it will be shown that these electronic dynamics have a
close relationship in behaviour with mechanical dynamics.
6.1.3.3
Passive LCR-Filters
When it is not possible to use ampliÔ¨Åers, higher order Ô¨Ålters can also be
created by applying the other complex impedance, the inductor in an LCR-
Ô¨Ålter. When the resistor in the previous Ô¨Ålters is replaced by an inductor,
the Ô¨Ålter eÔ¨Äect will be enlarged, because the impedance of the inductor
increases as function of the frequency.
Parallel Resonant LCR-Filters
In Figure 6.17 this second-order Ô¨Åltering eÔ¨Äect is shown for a low-pass Ô¨Ålter
conÔ¨Åguration, where the capacitor and inductor have a value of respectively
100 ŒºF and 25 mH.

480
Chapter 6. Analogue Electronics in Mechatronic Systems
The same approach as with the Ô¨Årst-order Ô¨Ålters is used to derive the
frequency response:
F(œâ) = Vo
Vi
=
Z2
Z1 + Z2
.
(6.22)
With Z1 = jœâL, Z2 = 1/jœâC the frequency response becomes:
F(œâ) = Vo
Vi
=
1
jœâC
jœâL +
1
jœâC
=
1
j2œâ2LC +1 =
1
‚àíœâ2LC +1.
(6.23)
The corner-frequency of this Ô¨Ålter is deÔ¨Åned by:
œâ0 = 2œÄf0 =
1

LC
rad/s

.
(6.24)
For the example of Figure 6.17 with a capacitor of 100 ŒºF and an inductor
of 25 mH, the corner-frequency becomes œâ0 =

4¬∑105 = 630 rad/s and f0 =
œâ0/2œÄ = 100 Hz.
With the deÔ¨Åned value of œâ0 the frequency response is written as:
F(œâ) =
1
‚àíœâ2
œâ2
0
+1
.
(6.25)
Similar to the mechanical mass-spring system in Chapter 3, this frequency
response shows a resonance with inÔ¨Ånite amplitude at œâ = œâ0, while the
corner-frequency of the Ô¨Ålter is equal to the undamped natural frequency
of the electronic resonator. In the mechanical situation, the height of this
resonance is tuned by adding a damper. In electronic Ô¨Ålters a resistor can
act as a damping element as it dissipates energy. This resistive damping
can be applied in two diÔ¨Äerent ways. The Ô¨Årst possibility is to apply the
resistor at the output of the Ô¨Ålter as a load. In that case the resistor will
absorb more energy, when its value is low. The other possibility is to apply
the resistor in series with the source, and in that case the resistor will take
more energy when the resistance is high. This interesting contradictory
eÔ¨Äect will become more clear when the two conÔ¨Ågurations are modelled.
The Ô¨Årst conÔ¨Åguration is the previously shown LC low-pass Ô¨Ålter with a
damping load resistor at the output, as shown in Figure 6.18. This conÔ¨Ågu-
ration is also called a parallel-resonant Ô¨Ålter, because from the point of view
of the impedances, the voltage source is a short-circuit. This means that all
impedances are essentially connected in parallel.
Again the same approach can be taken as with the previous Ô¨Ålters to derive

6.1. Passive Linear Electronics
481
+
_
Vi
Vo
+
_
2
1
Z
j C


1
Z
j L


z){
z¬Ç{
{
¬Ç{
){
¬É{
Magnitude (abs)
,{
1
,{
¬Ç
,{
3
z,¬Ü{
z,[¬Å
z¬Ö{
z)¬Å
{
Phase [deg]
Frequency  [Hz]
Magnitude [dB]
,{
3
,{
¬Ç
,{
1
1
,{
-1
,{
¬Ç
Figure 6.17: A second-order LC low-pass Ô¨Ålter network and the Bode plot of its
frequency response with C = 100 ŒºF and L = 25 mH, giving a corner-
frequency f0=100 Hz. The magnitude at the corner-frequency becomes
inÔ¨Ånite, because of the lack of damping.
the frequency response, but in this case the impedance to ground consists
of two parallel impedances Z2 and Z3. The parallel conÔ¨Åguration is noted
with symbol (‚à•):
F(œâ) = Vo
Vi
= Z2 ‚à•Z3
.
Z1 + Z2 ‚à•Z3 =
1
Z1
Z2 ‚à•Z3
+1
=
1
Z1

 1
Z2
+ 1
Z3

+1
(6.26)
With Z1 = sL, Z2 = 1/sC, Z3 = R, the frequency response becomes:
F(œâ) = Vo
Vi
=
1
jœâL

jœâC + 1
R

+1
=
1
‚àíœâ2LC + jœâ L
R +1
.
(6.27)
The same relation for the corner-frequency œâ0 =
1/LC is used and the
quality factor Q equals1:
Q = R

C
L .
(6.28)
With these terms the frequency response equals:
F(œâ) =
1
‚àíœâ2
œâ2
0
+ j
Q
œâ
œâ0
+1
.
(6.29)
1In electronics almost uniquely the quality factor Q = 1/(2Œ∂) is used to characterise the
damping of a resonating circuit.

482
Chapter 6. Analogue Electronics in Mechatronic Systems
+
_
Vi
Vo
+
_
2
1
Z
j C


1
Z
j L


Z3
R
z){
z[{
z¬Ç{
z,{
{
,{
Magnitude (abs)
,{
,
,{
¬Ç
,{
[
z,¬Ü{
z,[¬Å
z¬Ö{
z)¬Å
0
Phase [deg]
Frequency  [Hz]
Magnitude [dB]
,{
,
,{
¬Ç
1
Figure 6.18: A second-order damped LC low-pass Ô¨Ålter network and the Bode plot
of its frequency response with 100 ŒºF, L = 25 mH and R = 16 Œ©. These
values result in a corner-frequency f0 = 100 Hz and a damping with
Q = 1, Œ∂ = 0.5. A lower value of the resistor corresponds to an increased
level of damping.
This represents a well controlled dynamic performance, when the damping
ratio is chosen somewhere between 0.5 and 1. The resulting frequency
response is Ô¨Çat in the pass-band and shows an almost constant slope in the
attenuation-band. The Bode plot of this function has a clear resemblance
with the compliance presentation in Chapter 3 of a mechanical damped
mass-spring system. This mechanical versus electrical dynamic analogy
will be shortly summarised a bit later in this chapter after completion of
the presentation on the passive Ô¨Ålters.
The parallel resonant conÔ¨Åguration can also be used in a high-pass Ô¨Ålter,
by exchanging the location of the capacitor and the inductor, like shown in
Figure 6.19.
Again the same approach is applied to derive the frequency response:
F(œâ) = Vo
Vi
=
Z2 ‚à•Z3
Z1 + Z2 ‚à•Z3
=
1
Z1
Z2 ‚à•Z3
+1
=
1
Z1

 1
Z2
+ 1
Z3

+1
.
(6.30)
With Z1 = 1/sC, Z2 = sL, Z3 = R, the frequency response becomes:
F(œâ) = Vo
Vi
=
1
1
jœâC

1
jœâL + 1
R

+1
=
‚àíœâ2LC
‚àíœâ2LC + jœâ L
R +1
.
(6.31)
Also the same relation for the corner-frequency œâ0 = 1/

LC and quality factor

6.1. Passive Linear Electronics
483
+
_
Vi
Z3
R
+
_
Vo
1
1
Z
j C


2
Z
j L


Magnitude (abs)
10
1
10
2
10
3
0
45
90
135
180
Phase (deg)
Frequency  (Hz)
Magnitude (dB)
z){
z[{
z¬Ç{
z,{
0
10
10
-1
10
-2
1
Figure 6.19: A second-order damped LC high-pass Ô¨Ålter network and the Bode plot
of its frequency response with 100 ŒºF, L = 25 mH and R = 16 Œ©. These
values result in a corner-frequency f0 = 100 Hz and a damping with
Q = 1, Œ∂ = 0.5. A lower value of the resistor corresponds to an increased
level of damping.
Q = R
4
C/L is used and the frequency response equals:
F(œâ) =
‚àíœâ2
œâ2
0
‚àíœâ2
œâ2
0
+ j
Q
œâ
œâ0
+1
.
(6.32)
Like with the Ô¨Årst-order Ô¨Ålters, the only diÔ¨Äerence with the low-pass version
is the numerator, where in this case the frequency terms are squared,
corresponding to s2. This results in a 180¬∞phase shift (the minus term).
The resulting Bode plot is in a dynamic sense completely comparable to the
low-pass version with the same component values.
Series-Resonant LCR-Filters
When a series resistor is applied to create the damping, the series-resonant
circuit of Figure 6.20 is obtained.
The Ô¨Årst observation in this conÔ¨Åguration is that simultaneously a second-
order low-pass and a high-pass Ô¨Ålter2 is obtained. All impedances are in
series so they share the same current and the voltages add together to V0.
2The voltage over the resistor behaves like a Ô¨Årst-order band-pass Ô¨Ålter around the corner-
frequency but it is left to the reader to examine this further.

484
Chapter 6. Analogue Electronics in Mechatronic Systems
Vi
Vo,HP
Z1=R
Vo,LP
+
_
+
_
+
_
3
1
Z
j C


2
Z
j L


Vo,t
Figure 6.20: A second-order damped LC low-pass and high-pass Ô¨Ålter network in
series conÔ¨Åguration. A higher value of the resistor corresponds to an
increased level of damping. The voltage over the series inductance
and capacitor shows an anti-resonance.
With these Ô¨Åndings, the low-pass Ô¨Ålter frequency response in the frequency-
domain becomes:
FLP(œâ) = Vo,LP
Vi
=
Z3
Z1 + Z2 + Z3
=
1
jœâC
R +
1
jœâC + jœâL
=
1
‚àíœâ2LC + jœâRC +1. (6.33)
Likewise the frequency response of the high-pass Ô¨Ålter function is:
FHP(œâ) = Vo,HP
Vi
=
Z2
Z1 + Z2 + Z3
=
jœâL
R +
1
jœâC + jœâL
=
‚àíœâ2LC
‚àíœâ2LC + jœâRC +1. (6.34)
When comparing these equations with Equation (6.27) and Equation (6.31),
the diÔ¨Äerence in the damping term RC versus L/R in the previous Ô¨Ålters is
clear. The quality factor for the series resonant Ô¨Ålter can be determined by
replacing the term in the parallel Ô¨Ålter by the following steps.
The parallel quality factor equals
Q = R

C
L = R
L

CL.
(6.35)
When exchanging L/R by RC the quality factor for the series resonant Ô¨Ålter
becomes:
Q =
1
RC

CL = 1
R

L
C .
(6.36)

6.1. Passive Linear Electronics
485
When these terms are applied, together with the unchanged œâ0 = 1/

LC
the same equations in the frequency-domain are obtained as previously
determined in Equation (6.29) and Equation (6.32).
It is interesting to observe the voltage Vo,t over the series of capacitor and
inductor.
FHP(œâ) = Vo,t
Vi
= Vo,LP +Vo,HP
Vi
=
‚àíœâ2LC +1
‚àíœâ2LC + jœâRC +1.
(6.37)
This equals zero at œâ0 = 1/

LC as long as the resistor R is not equal to zero.
This frequency response is a typical passive notch Ô¨Ålter with a double zero in
the corresponding transfer function, when expanding the positive imaginary
terms of the Laplace operator s, which were used to determine the frequency
response, with the full set of s = œÉ+ jœâ.
6.1.4
Mechanical-Electrical Dynamic Analogy
The previous presentation of passive second-order Ô¨Ålters with an inductor,
a capacitor and a resistor is so much similar to the presentation of the
dynamics of a damped mass spring system that one wonders how these
elements from electronics can be linked to their counterpart in the body,
spring and damper of a mechanical dynamic system. Indeed this connection
is possible and even more than one analogy can be deÔ¨Åned of which one
is presented here. In this equivalent dynamic system analogy, a parallel
L-C-R-Ô¨Ålter, driven by a periodically changing current source, is compared
with the velocity response of a damped mass spring system driven by a
periodically changing force, acting between the reference plane and the
mass as shown in Figure 6.21. In this comparison Ô¨Årst the current I is
assumed to correspond to the force F. The logic of this assumption is based
on the fact that at a connecting node of a mechanical system all forces
add to zero, like in an electrical node all currents add to zero according
to KirchhoÔ¨Ä‚Äôs law. Also in a series conÔ¨Åguration of mechanical elements
the Force is shared, while in a series conÔ¨Åguration of electric elements the
current is shared. The next assumption is that the voltage V corresponds to
the relative velocity v. This assumption is based on power as voltage times
current and velocity times force both are equal to power. As a next step
the impedances can be compared. Ohm‚Äôs law in electricity can be replaced
by a mechanical counterpart: Àôx = FZm, where Zm equals the mechanical
impedance. Like with electric impedances the three mechanical elements
have their own typical impedance. The most straightforward is the damper
with ZD = 1/c, corresponding to the resistor ZR = R. The frequency depen-

486
Chapter 6. Analogue Electronics in Mechatronic Systems
dent impedance of a Capacitor ZC = 1/jœâC corresponds to the mechanical
impedance of the body ZB = 1/jœâm. As the last of the elements, the spring
corresponds to the inductor, not only because of their almost equivalent sym-
bols but also by their behaviour. The mechanical impedance of the spring
equals ZS = jœâ/k corresponding to the impedance of the inductor, ZI = jœâL.
These impedances show that the capacitance (C) corresponds to the mass
(m), the self-inductance (L) with the compliance of the spring (Cs = 1/k) and
the Resistor (R) with the inverse of the damping coeÔ¨Écient (c) of the damper.
To check this all in combination, the behaviour of the electrical circuit is
Ô¨Årst determined. According to Ohm‚Äôs law the output voltage of the circuit
equals:
Vo = I (Z1 ‚à•Z2 ‚à•Z3)
[V].
(6.38)
From this follows:
Vo
I (œâ) =
1
1
Z1
+ 1
Z2
+ 1
Z3
=
1
1
jœâL + jœâC + 1
R
=
jœâL
‚àíœâ2LC + jœâ L
R +1
[Œ©]. (6.39)
As a next step, the values for œâ0 and the damping ratio Œ∂ for both the electrical
parallel resonant Ô¨Ålter and the mechanical conÔ¨Åguration are determined by
Vo
I
Z3
+
_
m
k
c
F
2
1
Z
j C


1
Z
j L


B
C
B
1
1
x
V
Z
Z
F
j m
I
j C


#


#



                    Body 
 Capacitor
D
D
1
x
V
Z
R
F
c
I
#


#


        Damper 
 Resistor
S
L
S
x
j
V
Z
Z
j L
F
k
I


#


#



             Spring 
 Inductor
m
e
x
V
Z
Z
F
I

#


x
x
Figure 6.21: The analogy between a mechanical and electronic dynamic system,
where voltage corresponds to velocity and current with force.

6.1. Passive Linear Electronics
487
10
z¬Ç
10
z,
10
0
10
1
10
¬Ç
Magnitude Zm , Ze
 = 0.005  Q = 100   R = 1/c = 60
 = 0.05    Q = 10      R = 1/c = 6
 = 0.5      Q = 1        R = 1/c = 0.6
10
¬Ç
10
3
10
4
z¬Ö{
0
Phase [deg]
Frequency [Hz]
Figure 6.22: Bode plot of the equivalent electrical impedance Ze = V/I and the
mechanical impedance Zm = Àôx/F for 1/k = L = 10‚àí4 and m = C =
2.5 ¬∑ 10‚àí4. Below the corner-frequency of 1 kHz the line follows the
spring/inductor line with a +1 slope and 90¬∞phase lead. At the corner-
frequency the impedance is real, which means that the level is only de-
termined by the dissipative element, the resistor or the damper. Above
1 kHz the line follows a ‚àí1 slope, according to the mass/capacitance.
mutually interchanging the mentioned terms:
œâ0 =
1

LC
‚áî

k
m
rad/s
 and Œ∂ = 1
2Q = 1
2R

L
C ‚áî
c
2

km
.
(6.40)
With these terms, Equation (6.39) gives the following frequency responses
for both the electrical and mechanical conÔ¨Åguration:
Vo
I (œâ) =
jœâL
‚àíœâ2
œâ2
0
+2jŒ∂ œâ
œâ0
+1
[Œ©]
and
Àôx
F (œâ) =
jœâ 1
k
‚àíœâ2
œâ2
0
+2jŒ∂ œâ
œâ0
+1
[m/Ns]. (6.41)
As an illustration, a Bode plot of the impedance of both systems is shown in
Figure 6.22 with some values for the example. In the electrical domain the
plot shows a resonance at the corner-frequency f0 = œâ0/2œÄ = 1000 Hz, with a
resistive maximum depending on the resistor value. An application of such

488
Chapter 6. Analogue Electronics in Mechatronic Systems
a circuit can be in a Ô¨Ålter to reject a small frequency area, a band-reject
Ô¨Ålter, when the voltage divider of Figure 6.7 is used and Z1 is replaced
by this circuit. When Z2 is replaced by the circuit a band-pass Ô¨Ålter will
result, which attenuates all frequencies outside of the corner-frequency of
the circuit. The equivalent frequency response of the mechanical impedance
corresponds to the velocity response of Equation (3.69) from in Chapter 3.
The +1 slope with a 90¬∞phase lead below the corner-frequency corresponds
to the spring impedance in the mechanical system and the impedance of the
inductor in the electronic circuit. The ‚àí1 slope with a 90¬∞phase lag above
the corner-frequency corresponds to the mass impedance in the mechanical
system and the impedance of the capacitor in the electronic circuit.
In Table 6.1 these Ô¨Åndings are summarised.
Table 6.1: Electrical and mechanical analogy.
Mechanical
Electrical
Force (F)
Electric current (I)
Speed (v)
Electric voltage (V)
Mass (m)
Capacitance (C)
Compliance (1/k)
Self-inductance (L)
Damping coeÔ¨Écient (c)
Conductivity (1/R)
Energy (E = 0.5¬∑ mv2)
Energy (E = 0.5¬∑CV 2)
Power (P = Fv)
Power (P = IV)

6.2. Semiconductors and Active Electronics
489
6.2
Semiconductors and Active Electronics
Next to linear passive components, electronic circuits consist of diÔ¨Äerent
non-linear and active electronic building blocks. At the beginning of the
age of electronics, the Ô¨Årst of these elements were based on the interaction
between free electrons and charged metal elements in vacuum tubes. The
discovery of the semiconductor diode eÔ¨Äect in 1897 by the German physicist
Karl Ferdinand Braun (1850 ‚Äì 1918) started a cycle, which would change
the face of the world. The next signiÔ¨Åcant event was the patenting in 1930
of a Ô¨Åeld eÔ¨Äect transistor by the American physicist Julius Edgar Lilienfeld
(1882 ‚Äì 1963) who based his invention on a theoretical analysis without
practical veriÔ¨Åcation. A real working transistor was created more than
15 years later at Bell labs [5] in 1947 by the American physicists William
Bradford Shockley (1910 ‚Äì 1989), John Bardeen (1908 ‚Äì 1991) and Walter
Houser Brattain (1902 ‚Äì 1987) who won the Nobel prize for this important
achievement. The real breakthrough in electronics came after the indepen-
dent invention in 1958 of the integrated circuit by Jack Kilby (1923 ‚Äì 2005),
an American physicist, working at Texas Instruments, and by the American
physicist Robert Noyce (1927 ‚Äì 1990), co-founder of Fairchild Semiconduc-
tor [68].
With these inventions the vacuum tubes became rapidly obsolete for pro-
fessional applications. Presently the entire electronic Ô¨Åeld is divided in
discrete components, with individual functional elements and the integrated
Figure 6.23: Integrated circuits with passive components on a surface mounted
printed circuit board.

490
Chapter 6. Analogue Electronics in Mechatronic Systems
circuits (ICs), which contain a multitude of diÔ¨Äerent elements integrated
on one single piece of silicon, called a ‚Äúchip‚Äù. These chips are packaged in
mostly plastic housings with terminals, like shown in Figure 6.23. In the
last few decades many versions of semiconductor-based discrete components
have been created, ranging from the semiconductor diode and the bipolar
junction transistor (BJT) to special functional parts, like avalanche and
zener diodes, the diac and triac, the Ô¨Åeld eÔ¨Äect transistor (FET), the Metal
Oxide Semiconductor FET (MOSFET) and many more.
Integrated circuits are also diversiÔ¨Åed over many diÔ¨Äerent applications,
with a clear distinction between analogue and digital ICs. The best example
of an analogue IC is the operational ampliÔ¨Åer because of its applicability in
a wide variation of electronic functions. Digital ICs are used for logical oper-
ations, digital processing and computer memory. In the past decades, their
complexity has grown tremendously and presently they sometimes contain
hundred million transistors or more, all connected by a huge network of
integrated wiring. It would be impossible to give a complete overview of all
elements and diversity of electronics in the context of this book. For that
reason only the three most common examples of the discrete components
are explained more in depth, the silicon diode, which is a basic passive
non-linear element, the silicon bipolar transistor, and active element used
mainly to create amplifying electronics and the MOSFET used mainly in
digital electronics and in switched-mode power ampliÔ¨Åers.
6.2.1
Basic Discrete Semiconductors
The electronic circuit symbols for a diode and a bipolar junction transistor
are shown in Figure 6.24. A diode allows an electric current to Ô¨Çow only in
one direction. It can be seen as an electronic version of a check valve. Like
a check valve, which needs a pressure to open, also electric diodes do not
display a perfect on-oÔ¨Ädirectionality but have a more complex non-linear
Diode
Bipolar transistor
Figure 6.24: Two diÔ¨Äerent symbols of a diode and a bipolar NPN (left) and PNP
transistor. The arrows point towards the current conducting direction.

6.2. Semiconductors and Active Electronics
491
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
Si
P
P
B
B
N doped silicon
P doped silicon
Free electron
Hole
Figure 6.25: N- and P-material, created in a silicon crystal structure, where one
of the atoms is exchanged by Phosphor, to create N-material with
one free electron or by Boron, to create P-material with one missing
electron, a hole.
electrical characteristic. In principle a diode is a passive semiconductor as
it does not add energy.
The bipolar junction transistor, mostly just named bipolar transistor, is a real
active component, which can be used to amplify signals by converting energy
from a power supply into a signal with more power. Next to ampliÔ¨Åcation a
transistor can also be used as an electrically controlled switch. In this section
Ô¨Årst the working principle of a bipolar diode and transistor are explained
based on the physics behind semiconductors in order to understand their
main properties.
Semiconductor Physics
Semiconductors are chemically situated in the middle of the periodic system,
which means that they can attain the ‚Äòideal‚Äô state either by receiving n
electrons, or by giving away the same number of electrons. Examples of
semiconductor materials are silicon and germanium. The most widely used
material is silicon, because of its excellent electronic properties, combined
with its ample availability as the main constituent of sand.
Pure silicon has exactly 4 electrons per atom in its outer shell. silicon would
need to either receive 4 additional electrons or give these 4 electrons away
in order to reach the ‚Äúsemi ideal‚Äù state. In the bulk material the 4 electrons
of each atom are shared with their neighbours to achieve a true chemical
bond. For this reason these electrons are Ô¨Årmly bound in the material
structure. This immobility of the electrons means that pure silicon behaves
like an insulator. In order to achieve a semi-conducting state, it is necessary

492
Chapter 6. Analogue Electronics in Mechatronic Systems
to exchange some of the silicon atoms by near neighbours in the periodic
system that either have three electrons in their outer shell, like Boron (B),
or Ô¨Åve electrons, like Phosphor (P). This exchange of atoms is called ‚Äòdoping‚Äô
and the resulting structure is shown in Figure 6.25.
Depending on the doping material, the doped silicon shows a diÔ¨Äerent
behaviour. In case of doping with phosphor atoms, additional not-bound,
free electrons are made available. For that reason the silicon becomes an
N-material. When the doping is done with boron, so called holes are created,
missing electron places. These electrons and holes are called charge carriers,
as the doping in the material composition creates the possibility for the semi-
conductor to conduct current by means of these carriers. This conductivity
is caused by the mobility of the free electrons and the holes. The mobility
of the electrons is easy to understand, as they are not rigidly connected to
an atom core, while the mobility of the holes is a bit strange and can be
explained as follows. The presence of the hole disturbs the energy states in
the material in such a way that the normally bound electrons of the adjacent
silicon atoms tend to jump onto that hole, when an internal electric Ô¨Åeld
drives it in that direction. As a result this electron leaves an empty place,
a new hole, where the electron came from. This new hole can be seen as a
displacement of the original hole in the opposite direction of the ‚Äújumped‚Äù
electron. For this reason, charge transport by holes takes place in the same
direction as the current. Note that due to this mechanism, also the charge
transport by holes is in fact achieved by electrons. The diÔ¨Äerence is that the
charge transport by the holes in the P-material is done by normally bound
electrons from the silicon, while the charge transport by the electrons in the
N-material is done by the free electrons, coming from the doping atoms.
Before entering the next section, where N- and P-material will be combined
to create a diode, it is important to add some additional remarks:
‚Ä¢ Although the P-material has free holes and the N-material free elec-
trons, those materials are not charged as they originate from a not
charged doping atom added to the silicon crystal. This is fully identical
to an uncharged metal, which contains many free electrons.
‚Ä¢ The concentration of the doping elements is very low. This concen-
tration varies between approximately 10‚àí6 and 10‚àí8 depending on the
purpose.
‚Ä¢ The speed of the conduction in P-material is lower than the speed of
conduction in N-material, due to the indirect conduction mode of holes.
This diÔ¨Äerence is observed in high-frequency applications.

6.2. Semiconductors and Active Electronics
493
6.2.1.1
Semiconductor Diode
When N- and P-material are brought into electrical contact, the electrons of
the N-material and the holes of the P-material will diÔ¨Äuse into each other
and the electrons will Ô¨Åll the holes at the interface area. As a result an
intermediate layer is created, the PN-junction, without free electrons and
holes. This process is called the recombination of the electrons and the
holes and this layer is called the depletion layer, as shown in Figure 6.26.
This layer behaves like an insulator due to the lack of free movable charge
carriers.
The P-material becomes negatively charged and the N-material becomes
positively charged, because the P-material loses positively charged holes
and the N-material loses negatively charged electrons, thus creating an elec-
tromotive force, which can be detected by its external potential diÔ¨Äerence.
In Figure 6.27 it is shown what happens, if an external voltage source is
applied between the combined N- and P-material. At the left the external
voltage is in the same direction as the electromotive force, caused by the
recombination of the charge carriers. The external source adds electrons
to the P-material and takes electrons from the N-material. This results
in even less free charge carriers, and because of this enlarged depletion
layer no current can continue to Ô¨Çow. The thickness of the depletion layer
becomes proportional to the external voltage and the internal electromotive
force, which corresponds to this large depletion layer, is in equilibrium with
the externally applied voltage.
At the situation of the right of Figure 6.27, the external voltage is applied in
P
N
P
N
+
+ +
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+ +
+
+
+
+
+
+
+
+
+
+
Figure 6.26: Combining N- and P-material creates a depletion layer, because elec-
trons of the N-material recombine with the holes of the P-material.
As a result, the N-material becomes positively charged and the P-
material becomes negatively charged, according to the large plus and
minus sign. This results in a measurable potential diÔ¨Äerence between
both materials. The shown small plus and minus signs represent the
remaining free moving charges.

494
Chapter 6. Analogue Electronics in Mechatronic Systems
P
N
+
+
+
+
+
+
+
+
P
N
+
+
+ +
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
+
Figure 6.27: A semiconductor diode conducts current in one direction, when the
external voltage is directed opposite to the internal electromotive force
and blocks it in the other direction. In the conductive mode both the
electrons and the holes contribute to the current.
a direction opposite to the electromotive force of the recombined depletion
layer. In that situation electrons are added to the N-material and taken
from the P-material, compensating the eÔ¨Äect of the recombination. As a
result the depletion layer disappears and a conductive path is created where
both the holes and the free electrons contribute to the current.
It is obvious that these eÔ¨Äects don‚Äôt happen instantaneous without any
transition phenomena between conducting and blocking. This is illustrated
in Figure 6.28, which shows the real characteristics of a typical silicon
semiconductor diode. In the conductive direction it is to be expected that
the internal electromotive force of the depletion layer determines a certain
threshold level, which the external voltage has to surpass in order to make
the diode conducting. Furthermore, due to non-ideal material properties,
always some leakage current is present in the blocking direction. This
leakage current also reduces the external voltage, which can be measured
at the terminals of a not connected diode, to a level below the electromotive
force caused by the depletion layer. For a silicon based diode the thresh-
old voltage Vth is around 0.6 ‚Äì 0.7 V in practical situations. This value is
strongly temperature dependent, because it is determined by the mobility
of the charge carriers, which cause the depletion layer. This mobility is
increased at elevated temperatures. Another side eÔ¨Äect is caused by the
fact that the depletion layer is a non-charged (insulating) layer between two
parallel plates, which acts like a parasitic capacitor. The need to charge
this capacitor determines the current needed to change the diode from the
conductive state into the blocking state and vice versa, when the current is

6.2. Semiconductors and Active Electronics
495
0.3
-0.2
0
0.2 0.4 0.6 0.8
-0.2 -0.1
0
0.1 0.2
10
5 10	
	 
0
10
5 10	

9
1 10	

9
1.5 10	

9
2 10	

3
2 10	
	 
0
3
2 10	

3
4 10	

3
6 10	

3
8 10	

d    [V]
V
Id [A]
Id [A]
d    [V]
V
Ideal
Real
Figure 6.28: Real versus ideal characteristics of a silicon diode. A threshold voltage
Vth of approximately 0.6 V is present in the conductive direction at
moderate current levels above the mA range, as shown at the left.
At extremely low current levels in the nA range also some leakage
current occurs with a voltage in the reverse direction.
reversed. This is an important characteristic, because diodes are frequently
used to rectify alternating currents into direct currents in power supplies
and high-frequency signal demodulators.
Figure 6.29 shows an example of the most frequently used rectiÔ¨Åer circuit,
the bridge-rectiÔ¨Åer, which consists of 4 diodes and a storage capacitor. As
can be seen in the drawing both the positive and the negative voltage from
the input results in a unidirectional positive voltage at the output with
an average value3 of 2/œÄ times the peak voltage as can be calculated by
integration of the absolute value of a sine over one period. The large storage
capacitor will Ô¨Çatten the pulsating voltage into a DC voltage with a ripple,
which depends on the current in the load and the capacitance value of the
storage capacitor. This can be Ô¨Åltered further with a passive low-pass Ô¨Ålter,
as was presented in the previous part.
In the previous chapter the electric transformer was presented. One of
the conclusions was that a high-frequency AC voltage is necessary to be
able to reduce the size. The rectiÔ¨Åcation of a high-frequency AC voltage
requires very fast switching diodes in order to reduce the power dissipation,
related to the continuous charging and discharging of the intrinsic parasitic
capacitor from the depletion layer. This dissipation is caused by the unavoid-
able parasitic source resistance in the circuit, which causes the power loss.
Another application of fast diodes is in the switched-mode and resonant
ampliÔ¨Åers, which will be presented in the section on power ampliÔ¨Åers.
3The average value of a rectiÔ¨Åed sinewave (‚âà0.637) diÔ¨Äers ‚âà10% of its RMS value (‚âà0.707).

496
Chapter 6. Analogue Electronics in Mechatronic Systems
Vo
+
_
Vi
+
_
+
_
Vi
Vo
+
_
Vo
+
_
Vi
+
_
posive cycle 
negave cycle 
storage capacitor 
output voltage ripple 
with capacitor
without capacitor
+
C
R
R
R
Figure 6.29: Diode bridge rectiÔ¨Åer for AC voltage. Both the Ô¨Çow of current at
the positive and the negative cycle of the input voltage result in a
unidirectional current in the load, because of the diode conÔ¨Åguration.
By adding a storage capacitor a DC voltage is obtained with only a
limited AC ripple. The capacitor is charged in the positive slope of the
rectiÔ¨Åed input signal and discharged by the load in the negative slope.
6.2.1.2
Bipolar Transistors
A bipolar transistor is a combination of three layers of successive N- and
P-material. Depending on the order of the layers with N- and P-material
between the emitter and the collector, the transistor is an NPN or a PNP
type. To explain the working principle, a simpliÔ¨Åed thinking model of an
NPN transistor is shown in Figure 6.30. When a positive voltage is applied
between the collector and the emitter, the interface between the collector
and the base will be non-conductive and the interface between the base and
the emitter is in the conductive mode. The net result is that the transistor
is not conducting as the layers are connected in series.
As soon as a positive current is applied between the base and the emitter,
electrons start to move from the emitter to the base in the conductive
direction of the base-emitter PN-junction. The base is extremely thin and the
high voltage at the collector determines a strong electric Ô¨Åeld, accelerating
the electrons that move from the emitter towards the base to Ô¨Åll the holes

6.2. Semiconductors and Active Electronics
497
P
N
N
Collector
Base
Emi'er
+
+
+
+
+
+
P
N
N
Ic
Ib
Ie
+
+
+
+
+
+
+
+
+
Figure 6.30: Combining N-, P- and N-material gives an NPN transistor. Without
base current Ib the transistor is not conducting. A base current in
the conductive direction of the base-emitter junction causes a large
number of electrons to pass the collector-base barrier, resulting in a
collector current, which is larger than the base current.
that were created by the base current. Not all of them recombine with holes
in the base, because of the accelerated state of these hot electrons, but the
majority breaks through the barrier between the base and the collector. In
this way an electron Ô¨Çow is generated from emitter to collector, equivalent
to a current Ô¨Çow from collector to emitter. This current is larger than the
current in the base that caused it. Increasing the current on the base (Ib)
will trigger more emitter electrons, which break through the collector-base
junction. With this principle it is explained that a transistor acts as a
current ampliÔ¨Åer, with a current gain Œ≤, also called hfe, between the collector
and base current:
Œ≤ = hfe = Ic
Ib
.
(6.42)
The example was given for an NPN transistor, where the electrons play the
main role. For that reason in that conÔ¨Åguration the electrons are called the
majority carriers and the holes are the minority carriers as they only play a
role in the base current.
With a PNP transistor it is just the other way around. The holes are the
majority carriers and all currents run in the opposite direction of the NPN
example as shown in Figure 6.31. Both types of transistors are never fully
identical, aside of the current direction, because of the diÔ¨Äerent character
of the majority carriers, free electrons or holes. It is easier to achieve a

498
Chapter 6. Analogue Electronics in Mechatronic Systems
N: Emi'er
N: Collector
P: Base
Ib
Ic
Vc-e
P: Emi'er
P: Collector
N: Base
Vc-e
Ib
Ic
Figure 6.31: Current directions in an NPN and PNP transistor.
high Œ≤ with an NPN than with a PNP transistor and holes are slower than
electrons. Still this choice enables the electronic designer to apply these
diÔ¨Äerent transistors in almost symmetrical circuits, which control both pos-
itive and negative currents.
Another important issue is related to the fact that a transistor is a better
current ampliÔ¨Åer than a voltage ampliÔ¨Åer. The current in the collector is
not much inÔ¨Çuenced by the voltage between the collector and the emitter,
because a larger voltage increases the collector-base barrier while simulta-
neously also the electrical Ô¨Åeld strength over the barrier is increased, which
drives approximately the same number of electrons over this larger barrier.
This means that the collector behaves like a current source.
IC, Collector Current (mA) @ V    = -5 V
, DC Current Gain
hfe
z¬Ç{
‚àí0.2
300
200
100
70
50
30
z,{
TJ = ,¬Ç5¬∞C
z,{
z¬Å{
z¬Ç{
z,{{
z¬Å{
z¬Ç{{
¬Ç¬Å¬∞C
z¬Å¬Å¬∞C
z{¬Å
CE
Figure 6.32: The current gain of the BC447 general purpose PNP transistor clearly
indicates the high level of non-linearity and temperature sensitivity
of a bipolar transistor.

6.2. Semiconductors and Active Electronics
499
The non-linear conductivity of a diode is equally observed with the transistor.
When raising the base-emitter voltage from zero, Ô¨Årst no current will Ô¨Çow
through the collector until the threshold voltage of the base-emitter junction
is reached while at higher voltage levels only a small rise will result in a
large increase of the collector current. Also the current gain is very non-
linear with a strong temperature sensitivity as shown in Figure 6.32. This
extreme non-linearity and thermal sensitivity is an important property of
all semiconductors, which has to be addressed in the design of an ampliÔ¨Åer.
6.2.1.3
MOSFET
The name MOSFET means Metal Oxide Semiconductor Field EÔ¨Äect Tran-
sistor. It is a transistor, which operates because of a externally controllable
electric Ô¨Åeld, while it uses a metal oxide to insulate the input where the
controlling signal is applied. The electrodes of a MOSFET have diÔ¨Äerent
names than with a bipolar transistor. The input electrode is called the Gate
electrode and is equivalent in function to the base in a bipolar transistor.
The Drain electrode is equivalent in function to the collector as it drains
the electrons in an N-channel MOSFET, which is the most common version
and the Source electrode is equivalent in function to the emitter as it is the
source of the electrons in an N-channel MOSFET. in order to distinguish it
from a voltage or current source, the Source, Gate and Drain of a MOSFET
will be written as a name starting with a capital.
MOSFETs are the most common semiconductors in integrated logic circuits,
like microprocessors and memory, because of their speed, size and possibility
to work with very low power supply voltage levels. The speed is high in
especially N-channel MOSFETs, because the current Ô¨Çow takes place by ma-
jority carriers only, which are electrons in this type of device. As mentioned
before, charge transport by electrons is signiÔ¨Åcantly faster than the indirect
charge transport by holes. Next to the small signal type MOSFETs, also
high power versions have been developed, consisting of millions of separate
small MOSFETs connected in parallel. They are applied in high power
switching applications and will be further presented in Section 6.3.
The structure of one type of N-channel MOSFET, the horizontal enhancement-
mode type is shown in Figure 6.33. Many diÔ¨Äerent types of MOSFETs exist,
the depletion-mode MOSFETs are normally conducting, but the normally
non-conducting enhancement-mode version is most frequently used. The
horizontal type is the most easy to use for explaining the working principle,
while the vertical type is used to create power MOSFETs.
The substrate of a horizontal N-channel enhancement-mode MOSFET con-

500
Chapter 6. Analogue Electronics in Mechatronic Systems
Source
Contact
Field
Oxide
Gate
Oxide
Gate

¬ç
Drain
Contact
n-Drain
p-Substrate
Channel
n-Source
VGS
VT
0
0
ID
G
S
D
Channel, 
Substrate
ID
VGS
Gate
O`
+
+
+
++
+
+
+
+
+
+
+
+
+
N
N
P
P
Gate
Channel
Source
Drain
+
+
+
+
+
+
+
+
+
+
P
N
N
P
+
+
+
+
On
Figure 6.33: A MOSFET operates by an electric Ô¨Åeld. With an N-channel MOSFET
the channel is located in the substrate, made of P-type silicon, between
the Drain D and the Source S, both made of N-type silicon. In an
enhancement-mode MOSFET the channel is normally not conducting,
but when a positive voltage is applied between the insulated Gate
and the Source the corresponding electric Ô¨Åeld will drive away the
holes from the P-type channel and attract electrons from the Source,
which as a result will Ô¨Çow towards the Drain. The relation between
the Gate to Source voltage and the Drain current is less steep than
with a bipolar transistor and the behaviour is more like a variable
resistor.
(Courtesy of International RectiÔ¨Åer)
sists of P-doped silicon. The Drain and the Source are made of N-doped
silicon, separated by the substrate. The area in the substrate between
the Drain and the Source is called the channel. Unlike with the bipolar
transistor, the depletion layer between the P-and N-material plays no other
role than to insulate the Drain from the substrate when the voltage on the
Drain is positive relative to the substrate. Normally the junction between
the Source and the substrate is in the conductive direction during operation
and for that reason they are mostly internally connected.
The real functionality takes place in the channel area around the Gate. The
Gate is made of a conductive material like metal and is electrically insulated
from the substrate, the channel and the Source by a metal-oxide layer. This
gave the name ‚ÄúMOS‚Äù to the device, although often the metal of the Gate
is replaced by high doped poly-crystalline silicon and the oxide by silicon
oxide, because of the better compatibility with the silicon manufacturing

6.2. Semiconductors and Active Electronics
501
process. This makes however no diÔ¨Äerence for the working principle.
The oxide layer between the Gate and the channel is very thin and when
a positive voltage is applied to the Gate, relative to the Source, the holes
in the channel are pushed away due to the electric Ô¨Åeld by the Gate volt-
age, while the electrons are attracted. As a result, a large number of free
electrons become available in the channel. EÔ¨Äectively the original P-doped
substrate becomes a virtual N-material (hence the name ‚ÄúN-channel‚Äù), with
equal properties as the material of the Drain and the Source. This way, the
channel becomes a conductive path between the Drain and the Source, with
a width that is determined by the voltage level on the Gate. The resistance
of the channel depends on the width and with this principle a MOSFET
behaves like a controllable resistor.
The depletion mode MOSFET works in the opposite way. In that case the
channel is in principle conducting by a diÔ¨Äerent doping, and with N-material
of the channel a negative voltage on the Gate will repel the electrons, cre-
ating a depleted area with an increased resistance. It will not further be
treated, because this type of MOSFET is not used in ampliÔ¨Åers for mecha-
tronic systems.
In spite of the quite simple functionality of MOSFETs, bipolar transistors
are still more often used in analogue ampliÔ¨Åers and for that reason Ô¨Årst
ampliÔ¨Åers with bipolar transistors will be presented. Power MOSFETs play
an important role in switched-mode ampliÔ¨Åers, because of their excellent
switching performance. These ampliÔ¨Åers will be introduced in Section 6.3
on power ampliÔ¨Åers.
6.2.1.4
Other Discrete Semiconductors
Several other non-linear discrete semiconductors are developed over the
years, each for a speciÔ¨Åc use in electronic circuits. Insight in their working
principle is not as relevant for a mechatronic designer as understanding
of the basic diode, transistor and MOSFET. For this reason the four most
frequently applied types are only shortly summarised:
‚Ä¢ Zener diode
‚Ä¢ Diac
‚Ä¢ Thyristor
‚Ä¢ Triac

502
Chapter 6. Analogue Electronics in Mechatronic Systems
Zener Diode
The zener diode is used as voltage reference in power supplies and ampli-
Ô¨Åers. The voltage over its terminals is almost independent of the supplied
current level. The working principle of a zener diode is based on the generic
property of diodes that they can only sustain a certain maximum voltage
in the blocking direction, the breakdown voltage. Above that voltage, the
high electric Ô¨Åeld over the PN-junction will force electrons to cross the nor-
mally non-conducting PN-junction, in spite of the absence of holes. The
high electric Ô¨Åeld accelerates these electrons and as a result they release
more electrons from their bound state near the atoms by collision. This
self-ampliÔ¨Åcation eÔ¨Äect is called avalanche breakdown and a high current
will Ô¨Çow. With the voltage over the terminals this current causes a high
power dissipation, which would destroy the diode unless the current is lim-
ited by external means. The breakdown phenomenon was discovered by
the American Physicist Clarence Melvin Zener (1905 ‚Äì 1993) and it was
found that by adapting the doting level of the diode P-N material a sec-
ond eÔ¨Äect appears to be present, the tunnelling eÔ¨Äect. Tunneling is the
ability of a charged particle to cross an energy barrier with less than the
normally required energy. When one imagines the barrier as a mountain
the path that the electron Ô¨Ånds can be imagined as a tunnel, hence its
name. This phenomenon is based on Heisenbergs uncertainty principle [40]
from quantum mechanics of which the theory is outside the scope of this
book. More important is its eÔ¨Äect on the temperature sensitivity of a zener
diode. When the current through the zener diode is limited by a resistor or
a current source, the diode will not become overheated and the voltage is
quite constant. Below ‚âà5 V, where the tunnelling eÔ¨Äect is dominant, the
voltage has a negative temperature coeÔ¨Écient, while at voltages above ‚âà6 V
the avalanche eÔ¨Äect is dominant with a positive temperature coeÔ¨Écient of
the voltage. A zener diode with a zener voltage around 5.6 V has almost no
sensitivity for temperature.
Diac, Thyristor and Triac
The diac, thyristor, and triac are very much related as they are generally
applied together in control circuits for AC mains voltages, best known from
the light dimmers at home. A diac is an electronic switch that closes as soon
as a certain trigger voltage is reached over its terminals. One might think
that it is a kind of zener diode but there are two distinct diÔ¨Äerences. First
of all the diac is symmetrical so it works equal with currents and voltages

6.2. Semiconductors and Active Electronics
503
Zener diode
Diac                       Thyristor                  Triac
0
3
2 10	
	 
0
3
2 10	

3
4 10	

3
6 10	

3
8 10	

Id [A]
d    [V]
V
3
4 10	

3
6 10	

1
z
V
d
V
Id
gate
gate
+
_
Figure 6.34: The zener diode, diac, thyristor and triac are all very non-linear elec-
tronic devices. The graph shows the Vd to Id characteristic of a zener
diode. When driven in the normal forward conducting direction, the
zener diode behaves like a normal diode with ‚âà0.6 V voltage drop over
the terminals. In the reverse direction the diode conducts the current
with an almost constant zener voltage Vz.
in both directions. The second diÔ¨Äerence is the behaviour at breakdown.
With a diac the voltage will drop as soon as the trigger voltage is reached,
thereby limiting its power dissipation.
The thyristor acts as a switchable diode. It is made from 4 layers of semicon-
ductor material (P-N-P-N), which creates two intertwined bipolar transistors.
Without a current in the gate the device does not conduct current but after
triggering it with a short current in the gate the device will conduct which
is sustained, even without further supply of gate current. The thyristor can
only be turned oÔ¨Äby reversing the current through the device. This can
only be done by reversing the voltage over the device. The thyristor only
conducts current in one direction. To enable conduction in two directions
two opposite thyristors are combined in the triac.
In mechatronic systems these triggered components are hardly used, for
which reason they are only mentioned for completeness of the overview.

504
Chapter 6. Analogue Electronics in Mechatronic Systems
6.2.2
Single Transistor Linear AmpliÔ¨Åers
With both bipolar transistor types, several electronic functional building
blocks can be realised. Many years ago all analogue electronics consisted of
a combination of these conÔ¨Ågurations, which were only built with discrete
components. Presently most analogue electronics are realised with ICs
called Operational AmpliÔ¨Åers. In order to better understand the working
principle of these integrated ampliÔ¨Åers, Ô¨Årst the basic building blocks are
explained in this section.
A common item in these systems is the linearisation of the essentially non-
linear characteristics by the application of a suitable bias voltage over the
base-emitter junction to bring the transistor in a more linear working range.
6.2.2.1
Emitter Follower
The Ô¨Årst circuit is the emitter follower from Figure 6.35. It is also called
a common collector conÔ¨Åguration as the collector is directly connected to
the common power supply. The principle of the emitter follower is based on
the current-ampliÔ¨Åcation of the applied NPN transistor. It can for instance
be used as the buÔ¨Äer ampliÔ¨Åer in the cascaded passive Ô¨Årst-order Ô¨Ålter of
Figure 6.16 to match a high impedance input with a low impedance output.
In principle its operation is quite straightforward. The collector is connected
to a positive voltage with in this example a value of +15 V. The emitter
is connected to a more negative voltage via an emitter resistor. For the
negative voltage a value of ‚àí15 V is chosen to be able to amplify alternating
signals. The input voltage is applied on the base. When this input voltage
has a value in between the positive and negative supply voltage, the base
emitter junction is in the conductive mode. This means that the base-
emitter junction is biased, bringing the transistor in a certain working
range. Like with a silicon diode, the conducting base-emitter junction has a
threshold voltage Vb‚àíe,th of ‚âà0.6 V. For that reason, the emitter voltage will
be approximately 0.6 V more negative than the input voltage.
The diÔ¨Äerence between the emitter voltage and the negative supply voltage
determines the emitter current Ie through the emitter resistor.
Ie =
Ve ‚àíV ‚àí
sup
Re
= Vi ‚àí0.6+15
Re
[A].
(6.43)
This current is equal to the sum of the collector current and the base current:
Ie = Ib + Ic = Ic

 1
Œ≤ +1

[A].
(6.44)

6.2. Semiconductors and Active Electronics
505
+
_
Re
iV
e
c
I
I
!
e
i
0.6
V
V

	
+
_
bI
sup
15 V
V 	  	
sup
15 V
V   
o
V
+
_
+
Re
Rload
iV
iV
o
V
o
0
I 
o
0
I 
th
0.6  V
V !
clip
V
_
sup
15 V
V 	  	
15 V
sup
V   
5 V
	
5 V

0 V
a: no load                                     b: with load                                           c: signals
e
c
I
I
!
+
_
b-e,th
V
0.6 V
Figure 6.35: The NPN transistor emitter follower is a current ampliÔ¨Åer used to
achieve a low output impedance. The emitter voltage follows the
input voltage, which is applied to the base with a diÔ¨Äerence of ‚âà0.6 V.
When a load is connected, the positive output current is delivered by
increasing the emitter current of the transistor. The negative output
current comes from the emitter resistor Re by a reduction of the emitter
current of the transistor. Ultimately the emitter current is zero and
the maximum negative voltage is reached, showing a phenomenon
called ‚Äúclipping‚Äù at a level that is determined by the load in relation
to the emitter resistor and the negative power supply voltage.
For high values of Œ≤, the collector current becomes almost equal to the emit-
ter current and for this section the base current will further be neglected.
The current in the emitter resistor is necessary to be able to deliver both
positive and negative currents to a load, as shown in Figure 6.35.b, and is
called the idle current. When the input voltage at the base is an alternating
sinusoidal signal, like shown in Figure 6.35.c, then the emitter voltage
follows the input voltage with a constant diÔ¨Äerence of ‚âà0.6 V. The external
load will pull either a positive current or a negative current from the node
between the emitter and the emitter resistor. The positive current is deliv-
ered by the transistor, on top of the current Ô¨Çowing into the emitter resistor.
The negative current is delivered by the resistor by reducing the current
from the transistor. This can be done until the emitter current is zero. The
transistor is not capable of delivering a negative current and as a result the
ampliÔ¨Åer will show a clipping eÔ¨Äect at a maximum negative level that can
be calculated from the voltage divider determined by Re and Rload with the
negative supply voltage:
Vclip = V ‚àí
sup
Rload
Re + Rload
[V].
(6.45)

506
Chapter 6. Analogue Electronics in Mechatronic Systems
o
V
+
_
+
Rload
iV
o
0
I 
o
0
I 
_
sup
15 V
V 	  	
sup
15 V
V   
+
_
bias
1.2 V
V
!
i
o
bias
V
V
V

  with  
5 V
	
5 V

0 V
o
bias
V
V
  without  
Figure 6.36: A symmetric push-pull emitter follower. The positive current is de-
livered by the NPN transistor and the negative current by the PNP
transistor. A separate bias voltage is added to bring the transistors
in a more linear working range at the transition between a positive
and a negative current, which would otherwise cause cross-over dis-
tortion due to the threshold voltage of the base-emitter junction of the
transistors.
This single transistor emitter follower is only suitable in situations, where
no large output currents are required. This limitation is both due to the men-
tioned clipping at the negative cycle and also because of the heat dissipation
in the emitter resistor and transistor by the idle current, even when no signal
is ampliÔ¨Åed. This single-ended Class A conÔ¨Åguration is especially ineÔ¨Écient
with high power ampliÔ¨Åers. For that reason a more symmetrical solution is
often applied where the positive current is delivered by an NPN transistor,
combined by a PNP transistor for the negative current. This conÔ¨Åguration
is shown in Figure 6.36. The input voltage is applied simultaneously to
the base of both transistors. In the positive cycle of the signal the NPN
transistor operates almost identical as in the single-ended conÔ¨Åguration,
but it only delivers current to the load, not into an emitter resistor. In the
negative cycle the PNP transistor takes over the task to deliver the output
current. This so called Push-Pull class B conÔ¨Åguration has one problem
that is caused by the threshold voltage of the base emitter junction of ‚âà0.6 V
per transistor. This gives a strong non-linearity at the transition between
the positive and negative current, called cross-over distortion. Feedback
can not solve that non-linearity, because the gain becomes almost zero at
0 V input. It is necessary to reduce the cross-over distortion by applying a
separate bias voltage between the base electrodes of both transistors. The

6.2. Semiconductors and Active Electronics
507
tuning of this bias voltage is quite critical, due to the large temperature
dependency of the threshold voltage of the base-emitter junction. In most
cases a certain limited idle current is set running through both transistors
and the bias voltage is temperature compensated to add robustness.
This conÔ¨Åguration is called Push Pull class AB.
6.2.2.2
Voltage AmpliÔ¨Åer
Based on the Ô¨Åndings with the emitter follower, two other conÔ¨Ågurations
are shown in Figure 6.37, the variable current source and the voltage ampli-
Ô¨Åer. Both circuits belong to the same type and are called collector follower
or common emitter conÔ¨Ågurations, because the output is taken from the
collector and the emitter is either directly or almost directly connected to
the common ground.
Like with the example of the emitter follower, the NPN transistor is used as
the representative example. For the PNP transistor only the signs of the
voltages and currents need to be reversed to get the same results.
Rc
Re
Vi
Vsup
Vi
+
_
+
_
+
_
+
_
+
_
+
_
+
_
Vo
Io
i
0.6
V 	
i
0.6
V 	
a: variable current source                                                     b: voltage ampli%er
Re
Rload
+
_
b-e,th
V
0.6 V
eI
cI
Io
Io
Rload
Figure 6.37: Two conÔ¨Ågurations where the load is applied to the collector.
a: With the variable current source, the collector current is only
determined by the input voltage and the emitter resistor. It has a very
high output impedance.
b: A voltage ampliÔ¨Åer is created from a variable current source, by
inserting a resistor between the positive power supply and the collector.
The voltage over the resistor is proportional to the current and the
resistor value. With a high value for Rc, voltage ampliÔ¨Åcation is
obtained at the collector output.

508
Chapter 6. Analogue Electronics in Mechatronic Systems
The circuit of Figure 6.37.a. acts as a variable current source with a negative
current and works as follows: An input voltage is applied to the base with a
suÔ¨Éciently large value to bring the base-emitter junction in the conducting
state. As long as the voltage of the collector is kept at any value more
positive than the voltage at the base, the emitter current is only determined
by the input voltage and the emitter resistance, which is fully identical to
the situation as described with the emitter follower. With a high value of
the current-ampliÔ¨Åcation ratio Œ≤, the base current can be neglected and the
collector current becomes equal to the emitter current. As a consequence
of this reasoning, the collector current is not dependent on the collector
voltage as long as this voltage remains more positive than the base voltage.
This property corresponds to the deÔ¨Åned behaviour of a current source. and
this current source behaviour will prove to be very useful in the design of a
diÔ¨Äerential ampliÔ¨Åer in the next section. In this Ô¨Årst example it is used to
create a single transistor voltage ampliÔ¨Åer by including a collector resistor
between the collector and the positive supply rail, as shown in Figure 6.37.b.
The current in the collector determines the voltage over the resistor resulting
in an output collector voltage Vo equal to:
Vo = Vsup ‚àíIcRc = Vsup ‚àíIeRc = Vsup ‚àí(Vi ‚àíVth)Rc
Re
[V].
(6.46)
For the AC part of the input signal the constant values of Vth and Vsup
don‚Äôt matter, which means that this conÔ¨Åguration gives an AC voltage
ampliÔ¨Åcation of:
Ga = Vo
Vi
= ‚àíRc
Re
.
(6.47)
With an ideal transistor this gain is independent of the values of the resistors.
The minus term means that the sign of the signal is inverted. Although this
looks equal to a 180¬∞phase shift this eÔ¨Äect is not related to a phase delay
but only with a sign reversal.
Like all components that were presented, also the transistor is not ideal.
Its current-ampliÔ¨Åcation ratio is not inÔ¨Ånite nor constant and the character-
istics are non-linear because of the base-emitter junction, as was shown for
a diode in Figure 6.28. Furthermore, like the diode, also the transistor has
its dynamic limitations, which will be dealt with after the section about the
operational ampliÔ¨Åer.
Finally, the emitter voltage does not follow the base voltage perfectly, but it
shows a certain output resistance Rs,e with a value of approximately:
Rs,e = 0.025
IC
[Œ©].
(6.48)

6.2. Semiconductors and Active Electronics
509
while this value is also temperature dependent.
The ampliÔ¨Åcation ratio of Equation (6.47) can not be made inÔ¨Ånite by choos-
ing Re equal to zero, because of this Ô¨Ånite emitter impedance. In that case
the internal emitter output resistance Rs,e determines the maximum ampli-
Ô¨Åcation. With for instance a idle current of 1 mA, this output resistance is 25
Œ© and with a supply voltage of 20 V and a 10 kŒ© collector resistance, keeping
the collector voltage at about 10 V, a gain of 400 is achieved. This number
is reduced by the not-inÔ¨Ånite current-ampliÔ¨Åcation ratio and this ampliÔ¨Åer
is very non-linear, because of the non-linear base-emitter threshold voltage
to current ratio. In fact a larger emitter resistor linearises the ampliÔ¨Åer
at the expense of a reduced gain. This can be seen as a kind of current
feedback. The emitter resistor ‚Äúmeasures‚Äù the current and feeds it back to
the emitter while the transistor as ‚Äúcontroller‚Äù measures the base-emitter
voltage which is the diÔ¨Äerence between the base and emitter voltage and
controls the emitter current based on that measurement. In the past a lot of
attention of electronic circuit designers was spent in optimising the settings
of these single transistor ampliÔ¨Åers in order to achieve both linearity and
ampliÔ¨Åcation with as little as possible costly transistors.
6.2.2.3
DiÔ¨Äerential AmpliÔ¨Åer
As the last conÔ¨Åguration, before integrating them all in an operational
ampliÔ¨Åer, the diÔ¨Äerential ampliÔ¨Åer is presented in Figure 6.38. In essence
this conÔ¨Åguration consists of two single transistor voltage ampliÔ¨Åers that
are connected via their emitters. It was explained that a voltage ampliÔ¨Åer
consists of a variable current source that creates a voltage over the collector
resistor. This current is determined by the emitter resistor and the diÔ¨Äerence
between the emitter voltage and the negative supply voltage. With the
diÔ¨Äerential ampliÔ¨Åer however, the collector current is not only determined
by this diÔ¨Äerence but also by the diÔ¨Äerence between both base voltages.
To explain the functionality, the collector resistor values of both transistors
are assumed identical, Rc,1 = Rc,2 = Rc. Also both emitter resistors are
assumed identical, Re,1 = Re,2 = Re, while a third emitter resistor Rc,e is
added, which carries the current of both transistors.
The input signals Vi,1 and Vi,2 are modelled to consist of a common part and
a diÔ¨Äerential part.
Vi,1 = Vi,c +Vi,d
and
Vi,2 = Vi,c ‚àíVi,d
[V].
(6.49)
The common part of the signal is called the common-mode signal and this
part results in an equal emitter current value Ie,1 = Ie,2 for both transistors at

510
Chapter 6. Analogue Electronics in Mechatronic Systems
i,2
V
+
_
Re,2
sup
V 
+
_
Re,1
i,1
V
sup
V 	
di`erenal pair                                     long tailed pair
Rc,2
Rc,1
T3
T1
T2
+
_
sup
V 
+
_
sup
V 	
Rcs
Rc,2
Rc,1
T1
T2
Re,c
+
_
o,2
V
o,1
V
i,2
V
i,1
V
o,2
V
o,1
V
c,set
V
Figure 6.38: The diÔ¨Äerential ampliÔ¨Åer consists of a pair of equal transistors with
the emitters connected either directly or via a pair of emitter resistors.
a: The diÔ¨Äerential ampliÔ¨Åcation is determined by the collector re-
sistances and the total resistance between the emitters while the
common-mode ampliÔ¨Åcation is determined by the collector resistors
and the total resistance from the emitters to the negative supply volt-
age.
b: With the high impedance current source T3, the common-mode
ampliÔ¨Åcation is minimised.
a value of half of the total current It. This total current is determined by total
resistance to the negative supply voltage Re,t = Re,c +Re,1 ‚à•Re,2 = Re,c +0.5Re,
because both emitter voltages are equal.
The part of the current in both transistors that is caused by the common-
mode input signal can than be calculated as:
Ie,1 = Ie,2 = 0.5Ie,t = 0.5
Vi,c ‚àí0.6
Re,c +0.5Re
[A].
(6.50)
In this equation the threshold voltage Vth ‚âà0.6 V has been taken into account.
The output voltage that is caused by the common-mode part of the input
voltage is equal for both collectors, because of the equal collector resistances:
Vo,1 = Vo,2 = 0.5Rc
Vi,c ‚àí0.6
Re,c +0.5Re
[V].
(6.51)

6.2. Semiconductors and Active Electronics
511
The ampliÔ¨Åcation of the diÔ¨Äerential part, the diÔ¨Äerential-mode signal, is only
determined by the collector resistors and the series value of the resistors
Re,1 and Re,2. This is true, because for a diÔ¨Äerential signal the voltage at
the connection point between both equal resistors does not change when
one input voltage gets a positive dVi, while the other input gets an equal
negative dVi. As a result, the common-mode current through Re,c will be
divided diÔ¨Äerently over both transistors in a ratio depending on the value of
Re,1 = Re,2 = Re. The current diÔ¨Äerence will then be:
dIe,1 = ‚àídIe,2 = Vi,1 ‚àíVi,2
2Re
= dVi
Re
[I].
(6.52)
A positive diÔ¨Äerence between Vi,1 and Vi,2 gives a corresponding higher
current in T1 and a decreased current in T2. As a consequence, with the
equal collector resistances, the part of the output voltage, caused by the
diÔ¨Äerential-mode part of the input voltage, becomes diÔ¨Äerential:
‚àíVo,1 = Vo,2 = Rc
dVi
Re
[V].
(6.53)
With these relations it is possible to optimise the ampliÔ¨Åer for a certain
application. Generally the goal is to realise an ideal diÔ¨Äerential ampliÔ¨Åer
without any common-mode ampliÔ¨Åcation. This is for instance useful in
measurement systems, to avoid errors due to common-mode interference
signals. This means that the value of Re,c needs to be maximised and
the value for Re needs to be minimised. This ultimately results in the
conÔ¨Åguration of Figure 6.38.b, where the common emitter resistor is replaced
by a third transistor in the current source mode, with a Ô¨Åxed input voltage
Vc,set, which determines the common current through Rcs. This conÔ¨Åguration
is called a long tailed pair because of the additional current source in the
tail of the diÔ¨Äerential ampliÔ¨Åer. In this example the two emitter resistors
are omitted, in order to increase the gain to the maximum value possible.
When linearity is needed they can be added also in this conÔ¨Åguration like
previously explained with the single transistor voltage ampliÔ¨Åer.
This diÔ¨Äerential ampliÔ¨Åer conÔ¨Åguration gives two output voltages, which
can either be used directly by choosing one of the outputs, but mostly it is
used integrated in an operational ampliÔ¨Åer.

512
Chapter 6. Analogue Electronics in Mechatronic Systems
6.2.3
Operational AmpliÔ¨Åer
The operational ampliÔ¨Åer is possibly the most important and successful
example of an analogue IC. It is frequently used in measurement and sensor
systems, power ampliÔ¨Åers and many other applications, both in consumer
and professional equipment. Its success is largely based on its versatility,
ease of use and reliable results. While it is an ampliÔ¨Åer with a very high
gain, it is always used with feedback and because of that situation, it in-
volves the same dynamic issues on stability that are known from any other
feedback system. For that reason it is presented here quite thoroughly as
in mechatronic systems all performance issues are related to dynamics and
stability.
6.2.3.1
Basic Operational AmpliÔ¨Åer Design
A basic operational ampliÔ¨Åer, often just named Op-Amp, consists of three
functional stages as shown4 in Figure 6.40.
The Ô¨Årst stage, the diÔ¨Äerential input stage, is designed as a long tailed pair
with current source T3, which keeps the sum of the currents through T1 and
T2 constant. This conÔ¨Åguration maximises the ratio between the diÔ¨Äerential-
mode gain and the common-mode gain, the common-mode rejection ratio
(CMRR).
The second stage, the gain stage around T4, T5 and T6, is a combination of
a diÔ¨Äerential pair and a voltage ampliÔ¨Åer. Without the resistors between
the emitters, it creates a high diÔ¨Äerential gain with low linearity, which is
 
 
 
 
 
OPA627
OPA627
`"
‚ÄìIn
+In
‚ÄìV
NC
+V

`"
S
S
1
2
3
4
8
7
6
5
#¬ã]!$
"
\¬ã6!$
+
‚Äì
Figure 6.39: The symbol, pinning and housing of an operational ampliÔ¨Åer.
(Courtesy of Texas Instruments)
4To avoid confusion the voltage source for the power supply, input and output voltage is
not drawn in the Ô¨Ågure but all mentioned values are noted in respect to the reference, which
in general is ground or 0V from the power supply. This is quite common in electronic circuits.

6.2. Semiconductors and Active Electronics
513
Vi+
Vi-
Vsup
+
Vsup
-
Vo
T1
T2
T3
T4
T5
T6
T7
T8
Di`erenal ampli%caon                   Voltage gain                                      Current gain
Figure 6.40: Basic Operational ampliÔ¨Åer with bipolar transistors, diodes and re-
sistors. Three functional stages can be distinguished, a Ô¨Årst stage
that ampliÔ¨Åes only the diÔ¨Äerential input voltage, a second stage with
a maximum voltage gain and a third stage with a maximum current
gain.
not a big issue5 as an operational ampliÔ¨Åer is uniquely used with feedback.
With this gain the voltage diÔ¨Äerence from the Ô¨Årst stage is multiplied.
The last stage, the power output stage, has to be able to deliver the required
current to the load. This is accomplished by a symmetrical power output
stage in Class AB push-pull conÔ¨Åguration. The necessary bias voltage is
realised by the two diodes between the bases of T7 and T8 and solve the
problem at the crossover between a positive and negative output current
while they keep the transistors in just a conductive mode around a few mA
of idle current.
5Neglecting the non-linearity is only allowed in non-critical situations. In reality, one
should design any component in a control-loop as linear as possible in order to avoid residual
errors.

514
Chapter 6. Analogue Electronics in Mechatronic Systems
6.2.3.2
Operational AmpliÔ¨Åer with Feedback
An operational ampliÔ¨Åer is always used with negative or positive feedback.
The application of negative feedback in an electronic circuit is invented in
1927 by the American electrical engineer Harold Stephen Black (1898 ‚Äì
1983) [11] and this invention has proven to be a critical development for
achieving linearity in non-linear systems, like electronic circuits. Negative
feedback is always applied in electronic circuits when a linear, predictable
and accurate behaviour is required. The opposite eÔ¨Äect is achieved with
positive feedback in order to create special highly non-linear functions like
the Schmitt trigger, which will be used in Section 6.3 to design a pulse-width
modulator for a switched-mode ampliÔ¨Åer. When the term feedback is used
in a linear system it generally means negative feedback, but in the section
on active Ô¨Ålters it is shown that a moderate amount of positive feedback can
be applied to create a certain useful frequency response of a linear system.
For a non-inverting ampliÔ¨Åer, the application of negative feedback results
in the representation as shown6 in Figure 6.41. The circuit is drawn such
that the classic feedback control loop is recognisable, characterised by a set
point, an output and a subtracting element, which compares the set point
with the value fed back from the output. For an operational ampliÔ¨Åer with
an open-loop voltage gain Ga,o, the closed-loop ampliÔ¨Åer gain (Ga,c) equals
the complementary sensitivity function of the ampliÔ¨Åer T(s), which was
introduced in Chapter 4 on motion control, and is given by:
T(s) = Ga,c = Vo
Vi
=
Ga,o
1+Ga,oGa,f
=
1
1
Ga,o
+Ga,f
.
(6.54)
Where the feedback gain Ga,f over the ampliÔ¨Åer is given by the voltage
divider:
Ga,f =
R1
R1 + R2
.
(6.55)
In an ideal operational ampliÔ¨Åer Ga,o is inÔ¨Ånite. This results in a closed-loop
ampliÔ¨Åer gain of:
Ga,c = R1 + R2
R1
.
(6.56)
This means that the ampliÔ¨Åcation is only depending on the ratio of the
resistors R1 and R2. It also means that the diÔ¨Äerence in input voltages
6The power supply is omitted for simplicity in all further circuit diagrams with operational
ampliÔ¨Åers. Unless otherwise mentioned a symmetrical power supply with an equal positive
and negative supply voltage of suÔ¨Écient magnitude is assumed to be present.

6.2. Semiconductors and Active Electronics
515
+
Vo
Vi
Ga,o
R2
R1
+

Ga,f
Input
Output
+
_
+
_
_
_
Figure 6.41: Operational ampliÔ¨Åer is used with feedback.
becomes zero at inÔ¨Ånite Ga,o. In other words: ‚ÄúThe output will do anything
to make the voltage at the minus terminal, the feedback point, equal to the
voltage on the plus terminal, the reference point‚Äù.
This understanding is used in most basic designs of electronic circuits, like
those presented in the following section with diÔ¨Äerent ampliÔ¨Åer and Ô¨Ålter
combinations based on ideal operational ampliÔ¨Åers.
6.2.4
Linear AmpliÔ¨Åers with Operational AmpliÔ¨Åers
In this section several basic operational ampliÔ¨Åer conÔ¨Ågurations will be
presented using ideal operational ampliÔ¨Åer characteristics:
‚Ä¢ The internal gain is inÔ¨Ånite (Noted as G(‚àû)).
‚Ä¢ The input current is zero with an inÔ¨Ånite input impedance.
‚Ä¢ The output current is unlimited, with a zero output impedance.
‚Ä¢ The common-mode ampliÔ¨Åcation is zero.
‚Ä¢ No dynamic-, oÔ¨Äset-, power supply- or other limitations and deviations
are present.
Even though in reality all these statements are not true, in many less
critical applications general operational ampliÔ¨Åers behave suÔ¨Éciently ideal
to justify the use of the conÔ¨Ågurations in this section.

516
Chapter 6. Analogue Electronics in Mechatronic Systems
6.2.4.1
Design Rules
The following rules for designing linear circuits with operational ampliÔ¨Åers
directly follow from the above mentioned understanding of the working
principle of a feedback controlled operational ampliÔ¨Åer and is used through-
out all electronic circuits in this book, even when non-ideal ampliÔ¨Åers are
considered:
1. When negative feedback is applied, the output does whatever it can to
keep the negative input equal to the positive input (V + = V ‚àí).
2. The current in the circuit is not inÔ¨Çuenced by the input currents as
these are zero.
These rules are applied in the following steps to determine the function of
most operational ampliÔ¨Åer circuits:
1. Check if negative feedback is present.
2. Calculate the voltage on the positive input as this voltage is in most
cases not determined by the output voltage.
3. Calculate the voltage at the output by applying rule 1 and 2.
The last step implies that the output should generate the same voltage at
the negative input via the feedback path as was calculated for the positive
input in step 2.
6.2.4.2
Non-Inverting AmpliÔ¨Åer
The non-inverting ampliÔ¨Åer conÔ¨Åguration is equal to the previously pre-
sented operational ampliÔ¨Åer with feedback of Figure 6.41. It is drawn in
its simpliÔ¨Åed form in Figure 6.42 with a special version in the second pic-
ture, which is the unity-gain non-inverting ampliÔ¨Åer or buÔ¨Äer ampliÔ¨Åer,
which was introduced in the previous part about passive Ô¨Ålters to reduce
the mutual interaction of the diÔ¨Äerent Ô¨Ålter sections.
Although the closed-loop gain is already determined previously, the validity
of the rules and steps is veriÔ¨Åed by applying them also in this conÔ¨Åguration.
First it is checked that indeed negative feedback is applied, which is true
via the voltage divider by R1 and R2.
Then rule one is applied and the ampliÔ¨Åer will do whatever it can to make

6.2. Semiconductors and Active Electronics
517
Vo
Vi
R2
R1
+
+
G ()
+
_
_
_
I1
I2
+
Vo
Vi
+
+
_
_
_
G ()
Figure 6.42: The non-inverting ampliÔ¨Åer has a gain larger than one, determined by
the voltage divider in the feedback path. When the output is directly
connected to the minus input, giving a feedback gain of one, the unity-
gain buÔ¨Äer ampliÔ¨Åer is obtained.
voltage V ‚àíat the negative input equal to the voltage at the positive input,
V + = Vi.
With these conditions the current I1 in R1 should be:
I1 = Vi
R1
[A].
(6.57)
The current I2 in R2 is equal to I1 because of rule two, the input current of
the ampliÔ¨Åer is zero. This means that the output voltage as function of the
input voltage becomes equal to:
Vo
Vi
= Ga = I1
Vi
(R1 + R2) = R1 + R2
R1
.
(6.58)
This equation is equal to the previously obtained Equation (6.56) and the
rules are veriÔ¨Åed.
When the resistors in the feedback path are chosen such that R1 = ‚àûand
R2 = 0, the gain Ga becomes equal to one. As a result, this conÔ¨Åguration acts
as a unity-gain buÔ¨Äer ampliÔ¨Åer. A very important property of a non-inverting
ampliÔ¨Åer is the high input resistance of the circuit, which is only determined
by the common-mode input resistance of the operational ampliÔ¨Åer at the +
input multiplied by the open-loop gain of the ampliÔ¨Åer as the negative input
is made to follow the positive input. This open-loop value of this resistance
is already high and with feedback it is almost inÔ¨Ånite even with a real
operational ampliÔ¨Åer. The diÔ¨Äerential input impedance does not play a role

518
Chapter 6. Analogue Electronics in Mechatronic Systems
as the voltage on the ‚àíinput is equal to the voltage on the + input. This
conÔ¨Åguration is especially useful when very weak sensor signals with a low
voltage and high source impedance need to be ampliÔ¨Åed.
On the other hand, the output resistance of this ampliÔ¨Åer is very low, because
of the ideal operational ampliÔ¨Åer characteristics. Even if there was a small
output resistance, the feedback will reduce the internal output resistance
by the total loop gain, according to the sensitivity function of the feedback
system.
6.2.4.3
Inverting AmpliÔ¨Åer
The inverting ampliÔ¨Åer is shown in Figure 6.43. The ampliÔ¨Åcation is calcu-
lated as follows.
According to the rules Ô¨Årst the presence of negative feedback is checked,
which is true via R2. Then the positive input voltage is zero as it is connected
to ground.
With rule one the output will take care that V + = V ‚àí= 0 and with this infor-
mation the current I1 through R1 can be calculated by applying Ohm‚Äôs law:
I1 = Vi ‚àíV ‚àí
R1
= Vi
R1
[A].
(6.59)
I2 relates to the output voltage as follows:
I2 = V ‚àí‚àíVo
R2
= ‚àíVo
R2
[A].
(6.60)
The current I2 through R2 is equal to I1, because of rule two, resulting in
the following closed-loop gain of the circuit:
I1 = I2 = Vi
R1
= ‚àíVo
R2
[A].
=‚áí
Ga = Vo
Vi
= ‚àíR2
R1
.
(6.61)
G ()
R2
+
R1
Vo
Vi
I1
I2
+
+
_
_
_
Figure 6.43: In an inverting ampliÔ¨Åer the output has a diÔ¨Äerent sign as the input.

6.2. Semiconductors and Active Electronics
519
The minus sign indicates that the output signal is both ampliÔ¨Åed and in-
verted, as it has a diÔ¨Äerent sign than the input signal. Contrary to the
non-inverting ampliÔ¨Åer, the closed-loop feedback gain can also be lower than
one by choosing R2 < R1.
The main drawback of the inverting ampliÔ¨Åer is its relatively low input
resistance, which equals R1. For that reason this conÔ¨Åguration is applied in
those situations, where the low input resistance gives no problems and the
inverted functionality is needed. It is also useful, when signals have to be
added or subtracted.
6.2.4.4
Adding and Subtracting Signals
A very powerful application of operational ampliÔ¨Åers is based on their capa-
bility to add and subtract signals in a conÔ¨Åguration, as shown in Figure 6.44.
The calculation of the ampliÔ¨Åcation is as follows. Again the rules are applied.
There is negative feedback and the positive input voltage is zero and equal
to the negative input voltage, V + = V ‚àí= 0.
No current can Ô¨Çow into the ampliÔ¨Åer inputs, because of rule two, and the
currents through the resistors relate according to KirchhoÔ¨Ä‚Äôs Ô¨Årst law:
I1 + I2 + I3 ‚àíI4 = 0
=‚áí
I1 + I2 + I3 = I4
[A].
(6.62)
G ()
R4
+
R1
R2
Vo
Vi,1
R3
I1
I4
I2
I3
Vi,2
Vi,3
+
+
+
+
_
_
_
_
_
Figure 6.44: Adding signals is achieved by adding the currents of diÔ¨Äerent inputs
at the negative input, which acts like a virtual ground.
When R1 = R2 = R3 = R the output signal is equal to the inverted sum
of all input signals, ampliÔ¨Åed with a factor R4/R.

520
Chapter 6. Analogue Electronics in Mechatronic Systems
G ()
R2
+
R1
R1
R2
Vo
Vi,2
Vi,1
I1
I2
+
+
+
_
_
_
_
Inverng 
Non 
inverng 
Figure 6.45: Subtracting signals is achieved by combining a non-inverting and an
inverting conÔ¨Åguration and using both the positive and negative input
of an operational ampliÔ¨Åer.
With Ohm‚Äôs law these currents are calculated from the diÔ¨Äerent voltage and
resistor values:
Vi,1
R1
+ Vi,2
R2
+ Vi,3
R3
= ‚àíVo
R4
[A].
(6.63)
This results in the following output voltage:
Vo = Ga,1Vi,1 +Ga,2Vi,2 +Ga,3Vi,3 = ‚àíR4
R1
Vi,1 ‚àíR4
R2
Vi,2 ‚àíR4
R3
Vi,3
[V]. (6.64)
In the inverting and the adding conÔ¨Åguration, the negative input acts like a
virtual ground, because the output keeps the negative input at the same
level as the grounded positive input. This is the reason that the signal at
one input terminal is not inÔ¨Çuenced by the signal at another input terminal.
This is especially useful, when signals are combined from sources that are
so sensitive that other voltages on its output can cause interference by non-
linearity.
This is diÔ¨Äerent from the non-inverting ampliÔ¨Åer.
When signals need to be subtracted, the circuit as shown in Figure 6.45 can
be used. It is a combination of a non-inverting and an inverting ampliÔ¨Åer
conÔ¨Åguration within one operational ampliÔ¨Åer. The standard rules are
applied also for this calculation of the ampliÔ¨Åcation.
As the Ô¨Årst step it is checked that negative feedback is applied via R2.
The next step is to calculate the voltage at the positive input and directly
apply rule one:
V ‚àí= V + = Vi,2

R2
R1 + R2

[V].
(6.65)

6.2. Semiconductors and Active Electronics
521
Using rule two, the relation between the output voltage Vo, the Ô¨Årst input
voltage Vi,1 and V ‚àícan be determined by using Ohm‚Äôs law and KirchhoÔ¨Ä‚Äôs
Ô¨Årst law:
I1 ‚àíI2 = Vi,1 ‚àíV ‚àí
R1
‚àíV ‚àí‚àíVo
R2
= 0 A.
(6.66)
Note the minus sign in I2, which is caused by the deÔ¨Åned direction of the
arrow for I2 in Figure 6.45.
With a little bit of algebra, this equation gives the relation for V ‚àí:
V ‚àí= Vo
R1
R1 + R2
+Vi,1
R2
R1 + R2
[V].
(6.67)
When replacing V‚àíby the result of Equation (6.65), the following relation
between the three voltages is obtained:
Vi,2

R2
R1 + R2

= Vo
R1
R1 + R2
+Vi,1
R2
R1 + R2
=‚áí
R1V0 = R2

V1,2 ‚àíVi,1

. (6.68)
Resulting in:
Vo = R2
R1

Vi,2 ‚àíVi,1

[V].
(6.69)
It is important to be aware that the values of the resistors R1 and R2 of
the voltage divider after Vi,2 have the same values as the resistors in the
feedback circuit, because of the diÔ¨Äerence in ampliÔ¨Åcation between a non-
inverting and an inverting ampliÔ¨Åer conÔ¨Åguration. Sometimes the mistake
is made to leave the resistors at the positive input away for simpliÔ¨Åcation.
This results in a higher gain for the non-inverted input signal, relative
to the inverted input signal, with a correspondingly high common-mode
ampliÔ¨Åcation. In the ideal situation this common-mode ampliÔ¨Åcation is zero
when all resistances have an equal value.
A disadvantage of this subtracting conÔ¨Åguration with a single operational
ampliÔ¨Åer is the diÔ¨Äerence in loading of the two input signals. The positive
input has an input impedance equal to R1 + R2, while the negative input
has an input impedance of R1 only. Further the current I1 is determined
by both Vi(1) and Vi(2), which means that Vi(2) inÔ¨Çuences the current from
Vi(1). This can cause problems when the source of Vi(1) has a voltage depen-
dent impedance. This has to be solved in critical situations, for instance
by inserting a separate unity-gain buÔ¨Äer ampliÔ¨Åer between the source and
the inverting input. In Chapter 8 the instrumentation ampliÔ¨Åer will be
introduced, a diÔ¨Äerential ampliÔ¨Åer designed with two special buÔ¨Äer ampli-
Ô¨Åers, one for each input, solving this issue in the most elegant way while
maximising the common mode rejection ratio.

522
Chapter 6. Analogue Electronics in Mechatronic Systems
6.2.4.5
Transimpedance AmpliÔ¨Åer
Several sensors that are applied in measurement systems give a current
signal as function of the measurement parameter. The output impedance
of these sensors is very high with a current source characteristic and the
measurement current often needs to be converted into a voltage. Such a
converter is called a current-to-voltage (I to V) converter, also named a
current controlled voltage source or transimpedance ampliÔ¨Åer.
In its simplest form a current to voltage converter is just a load resistor to
ground as shown in the left drawing of Figure 6.46. The voltage over the
resistor equals Vo = I1R according to Ohm‚Äôs law.
This simple conÔ¨Åguration has two drawbacks. First of all there is no energy
ampliÔ¨Åcation of the often very weak current signal and secondly the result-
ing voltage is also present over the input current source. When this current
source is not ideal with a non-inÔ¨Ånite output impedance, the voltage will
inÔ¨Çuence the current.
To solve these problems, an operational ampliÔ¨Åer can be used for the con-
version as shown at the right drawing in Figure 6.46. The conÔ¨Åguration is
similar to the inverting ampliÔ¨Åer but the input resistance is left away. This
G ()
R
+
Vo
I1
I2
+
_
_
R
I1
Vo
+
_
  Passive I to VI to V converter with V = 0
+
V = 0
i
Vo
+
_
_
Za
Ii
¬ã$¬ä%
i
Figure 6.46: A current-to-voltage converter creates an output voltage that is con-
trolled by the input current. A load resistor to ground acts like a
passive I to V converter. With an operational ampliÔ¨Åer one can create
a converter, called transimpedance ampliÔ¨Åer, that both adds energy to
the signal and avoids a voltage over the input current source.

6.2. Semiconductors and Active Electronics
523
can be done because the impedance of the current source is in most cases
much larger than the input resistor from a normal inverting ampliÔ¨Åer and
as they are connected in series the smaller value can be omitted.
Following the rules of an operational ampliÔ¨Åer, the output of the ampliÔ¨Åer
will get a value such that the minus input voltage will become equal to the
plus input voltage, being equal to 0 V ground level. With a zero current
into the input of the operational ampliÔ¨Åer the output voltage needs to be
such that it creates a current I2 in the feedback resistor equal to the input
current I1.
The main diÔ¨Äerences with the simple resistor are clear. The virtual ground-
ing of the input current at the minus input keeps the voltage over the input
current source at zero volt so even with a less perfect current source there
is no problem. Furthermore the ampliÔ¨Åer adds energy to the signal. Only
the sign is inverted and a positive current will result in a negative output
voltage Vo = ‚àíI1R.
This active conÔ¨Åguration acts like an impedance, which the current has
to pass through (trans) from the input to the output. For this reason this
ampliÔ¨Åer has got its name ‚Äútransimpedance ampliÔ¨Åer‚Äù.
6.2.4.6
Transconductance AmpliÔ¨Åer
In Chapter 5 it was explained that electromagnetic actuators require a
controlled current in order to control the force. This means that a converter
is needed to change the control voltage into a current, independent of the
voltage over the actuator. Such a converter is called a voltage-to-current (V
to I) converter, also named a voltage-controlled current source or transcon-
ductance ampliÔ¨Åer. The name transconductance is based on its inverted
property when compared with the transimpedance ampliÔ¨Åer, where the
term ‚Äúconductance‚Äù is the inverse of ‚Äúimpedance‚Äù. Although in theory it is
possible to create such a converter with a high ohmic series resistor between
the voltage source and the load, such a resistor would reduce the energy of
the signal and for that reason a series resistor is not a realistic option when
controlling actuators. A transconductance ampliÔ¨Åer can be created by intro-
ducing current measurement in the feedback loop of an operational ampliÔ¨Åer
as shown in Figure 6.47. It shows two conÔ¨Ågurations, non-inverting and
inverting, where a small measurement resistor Rcs is connected in series
with the load, which is connected to the output terminals of the ampliÔ¨Åer.
The inverting version is explained in more detail because the mathematics
are more easy and suÔ¨Écient for understanding of the principle. The current
Io creates a current sensing voltage Vcs over this resistor equal to Vcs = IoRcs.

524
Chapter 6. Analogue Electronics in Mechatronic Systems
R1
Vi
Io
+
Load
cs
 o
 
V
I R
_
G ()
+
_
Rcs
R2
Io
Za
Vi
R1
+
_
+
Vi
Ri
Vo
+
_
_
Za
Io
Input voltage controlled current source = transconductance ampli%er
Vo
+
+
+
_
_
cs
Inv$
Non-inv$
=
Figure 6.47: A transconductance ampliÔ¨Åer creates an output current that is con-
trolled by the input voltage. This current source output characteristic
can be realised by measuring the output current with a small resistor
value and using that signal in the feedback loop of the operational am-
pliÔ¨Åer. Both a non-inverting and inverting conÔ¨Åguration are possible.
This voltage is fed back to the negative input of the ampliÔ¨Åer. The ampliÔ¨Åer
obeys to design rule one and does whatever it can to keep the negative input
voltage equal to the positive input voltage, which is zero because of the
inverting conÔ¨Åguration. As a consequence of this design the operational
ampliÔ¨Åer will keep the current sensing voltage Vcs over Rcs at a level of:
Vcs = ‚àíVi

 R2
R1

[V].
(6.70)
To realise this voltage, the ampliÔ¨Åer needs to supply an output current
through the actuator and Rcs at a value of:
Io = Vcs
Rcs
= ‚àíVi

R2
R1Rcs

[A].
(6.71)
This means that the current through the load is only determined by the input
voltage and the resistance values. This simple converter has one drawback
in the fact that the load itself is not grounded at one of its terminals. This
means that the load is Ô¨Çoating and the voltage at the load terminals is
determined by both the current and the voltage over the current sensing
resistor, which acts as a common-mode voltage for both terminals of the
load.

6.2. Semiconductors and Active Electronics
525
Ground Referenced Load
It is often preferred that the load is grounded at one terminal. Reasons
can be found in a reduced level of interference by internally grounded
interference suppression capacitors in the actuator or other practical reasons
like the possibility to combine diÔ¨Äerent actuators on one ground connection.
The conÔ¨Ågurations of Figure 6.48 serve this purpose by exchanging the
position of the load and the current sensing resistor. With this reversal the
current sensing resistor is Ô¨Çoating, which slightly complicates the possibility
to control the current. It is no longer possible to determine the current from
the voltage at one terminal of the current sensing resistor as this voltage
is determined by both the input and the load voltage. Instead the voltage
diÔ¨Äerence over the current sensing resistor should be taken as measure
for the current. The shown circuit utilises positive feedback of the output
voltage Vo over the load to the input of OP1 to keep the current constant.
This is explained with the inverting version by calculating the voltage V1 at
the output of OP1 from the voltages at the inputs of OP1 which should be
equal according to design rule one.
V ‚àí= V + = Vo
R3
R3 + R4
[V].
(6.72)
V1 = Vi ‚àíIi(R1 + R2) = Vi ‚àíVi ‚àíV ‚àí
R1
(R1 + R2)
= Vi ‚àí(Vi ‚àíV ‚àí) R1 + R2
R1
[V].
(6.73)
R3
Vi
Io
+
_
G ()
+
_
R4
G ()
+
_
Io
Load
Za
Rcs
R1
R2
OP1
OP2
oV
V1
+
_
_
+
Ii
Ii
R1
R3
Vi
¬ö$¬ã$
+
_
cs
 o
 cs
V
I R

+
_
Figure 6.48: A transconductance ampliÔ¨Åer with a grounded load requires a Ô¨Çoating
measurement resistor with a positive feedback compensation of the
voltage over the load. Both a non-inverting and an inverting conÔ¨Ågu-
ration are possible.

526
Chapter 6. Analogue Electronics in Mechatronic Systems
The resistor values are chosen such that R1/(R1 + R2) = R3/(R3 + R4). Com-
bining Equations (6.72) and (6.73) results in:
V1 = Vi ‚àí

Vi ‚àíVo
R3
R3 + R4
 R1 + R2
R1
= Vi

1‚àíR1 + R2
R1

+Vo
= Vo ‚àíR2
R1
Vi
[V].
(6.74)
This means that the voltage diÔ¨Äerence Vcs = V1‚àíVo over Rcs is now only deter-
mined by the input voltage to a ratio determined by R1 and R2, independent
of the load. As a direct consequence also the current Io is independent of
the load, which deÔ¨Ånes a current source as can be veriÔ¨Åed by determining
the current:
Io = Vcs
Rcs
= V1 ‚àíVo
Rcs
= ‚àí
R2
R1Rcs
Vi
[A].
(6.75)
which is equal to Equation (6.71).
Several remarks should be made to this conÔ¨Åguration. First it is important
that indeed R1/(R1 +R2) = R3/(R3 +R4). A deviation from this rule will cause
some remaining inÔ¨Çuence of the voltage over the load. Secondly the electrical
dynamic properties of both the ampliÔ¨Åer and the load will impact the stability.
The use of positive feedback also includes an increased risk of instability,
which can be checked by imagining the system without a load, so with an
open connection. In that case the voltage gain of the converter will become
inÔ¨Ånite as the positive feedback will always try to raise V1 above Vo while
no current can Ô¨Çow through Rcs, allowing such voltage diÔ¨Äerence.
Further it should be noted that this conÔ¨Åguration can easily be changed into
a non-inverting ampliÔ¨Åer with equal gain by grounding R1 and applying
the input voltage to R3. By not grounding any resistor and applying two
separate input signals to R1 and R3 the design acts like a subtracting
voltage-to-current converter, comparable with the subtracting ampliÔ¨Åer
from Section 6.2.4.4. It is left to the reader to check this by mathematics,
using the design rules for an operational ampliÔ¨Åer.
The transconductance ampliÔ¨Åer is a very important element in a mechatronic
positioning system as it used in Section 6.3 on power ampliÔ¨Åers for supplying
an actuator with a deÔ¨Åned current, a process called current-drive.

6.2. Semiconductors and Active Electronics
527
6.2.5
Active Electronic Filters
The presented ampliÔ¨Åer conÔ¨Ågurations all used pure resistors to determine
their closed-loop frequency response. In principle these resistors can be
exchanged by complex impedances, in order to achieve a frequency dependent
behaviour. Similar with passive Ô¨Ålters, this could be done with capacitors
and inductors, but the active nature of operational ampliÔ¨Åers creates the
possibility, to avoid the large and expensive inductors and create Ô¨Ålters of
any kind and order with only capacitors and resistors. Also this Ô¨Åeld is
extremely wide and requires a strict selection for this book. The examples
chosen include simple Ô¨Årst-order Ô¨Ålters, an analogue PID controller and
active second-order Ô¨Ålters, as these are fully representative for the most
frequently used conÔ¨Ågurations in mechatronic systems.
6.2.5.1
Integrator and First-Order Low-Pass
For most of the Ô¨Ålters, the inverting ampliÔ¨Åer of Figure 6.43 is used as a
starting point. The integrator and the related Ô¨Årst-order low-pass Ô¨Ålter are
both shown in Figure 6.49, because they diÔ¨Äer with only one resistor.
Ohm‚Äôs law is also valid for complex impedances, which means that the
transfer function of an inverting ampliÔ¨Åer according to Equation (6.61) can
be written as follows:
Ga(s) = ‚àíZ2
Z1
.
(6.76)
When adding a capacitor to one of these impedances, this transfer function
becomes frequency dependent. If for instance R2 is inÔ¨Ånite and a capacitor is
placed parallel to it, the inverting ampliÔ¨Åer becomes an inverting integrator
with its transfer function and frequency response:
GI(s) = ‚àíZ2
Z1
= ‚àí
1
sR1C ,
GI(œâ) = ‚àí
1
jœâR1C .
(6.77)
In order to compensate the minus sign, a second inverting ampliÔ¨Åer has
been added. This avoids the confusion of the phase of the integrator with
the 180¬∞phase of the inversion7. This results in the following frequency
response of the integrator without inversion:
GI(œâ) =
1
jœâR1C .
(6.78)
7This additional inversion is often not necessary in complex Ô¨Ålters with a multitude of
inverting Ô¨Ålter and ampliÔ¨Åcation steps. In those situations eventually one additional inverter
can be added if the resulting signal is still inverted.

528
Chapter 6. Analogue Electronics in Mechatronic Systems
Z2
Z1
G ()
+
R1 (15k)
Vo
Vi
C (0.1F)
+
+
_
_
_
G ()
+
_
R (10 k)
R (10 k)
R2  ( or15k)
z){
z¬Ç{
{
¬Ç{
){
Magnitude [dB]
 
 
,{
{
,{
1
,{
¬Ç
,{
3
,{
)
z¬Ö{
z)¬Å
{
Phase [deg]
Frequency  [Hz]
Low pass
Integrator
Magnitude (abs)
,{
-1
,{
¬Ç
,{
¬Ç
,{
1
1
Figure 6.49: A capacitor in the feedback path of an inverting ampliÔ¨Åer creates
an integrator, when the resistance of R2 is inÔ¨Ånite. A Ô¨Ånite value
of R2 creates a Ô¨Årst-order low-pass Ô¨Ålter. The Bode plot shows both
frequency responses using the indicated values of the passive elements.
The second inverter with a gain of ‚àí1 corrects the inversion by the
Ô¨Årst inverter.
In the Bode plot this non-inverting integrator gives a line with a slope of -
1, which intersects the 0 dB level at the unity gain cross-over frequency
œâ0 = 2œÄf0 = 1/R1C and a continuous phase of ‚àí90¬∞over the entire frequency
band.
When the resistor R2 over C becomes smaller than inÔ¨Ånite, it will limit
the ampliÔ¨Åcation at low frequencies and as a result a Ô¨Årst-order low-pass
Ô¨Ålter is created. The frequency response is determined by calculating Z2 as
the impedances of R2 and C in parallel and including the gain of ‚àí1 by the

6.2. Semiconductors and Active Electronics
529
second inverter:
F(œâ) = Vo
Vi
= Z2
Z1
=
1
R1

 1
R2
+ jœâC
 = R2
R1
1
(1+ jœâR2C).
(6.79)
This represents a Ô¨Årst-order Ô¨Ålter with an RC-time constant œÑ = R2C and
a gain of R2/R1 in the pass band below the corner-frequency œâ0 = 2œÄf0 = 1/œÑ.
At f0 the gain is ‚àí3 dB and at higher frequencies the slope is ‚àí1, equal to
the integrator. This is shown in the Bode plot for the indicated values of the
passive elements, resulting in a pass band gain of one and f0 = 100 Hz.
Note that the unity-gain cross-over frequency œâ0 for the integrator and the
corner-frequency œâ0 for the low-pass Ô¨Ålter are equal in the Bode plot of
Figure 6.49 because R1 and R2 are chosen to be equal for this example in
order to Ô¨Åt into the same Bode Plot and enable comparing of the results.
Generally, even in normal inverting and non-inverting ampliÔ¨Åers, a small
capacitor is almost always placed parallel to the feedback resistor over an
operational ampliÔ¨Åer. This is done for two reasons. First of all, it is never
really useful in mechatronic systems, to amplify high frequencies above
the range of interest, as at these frequencies many undesired dynamic
eigenmodes are present in the mechanics. The second reason is related to
the non-ideal properties of any electronic ampliÔ¨Åer regarding its dynamic
performance. More details will be presented after this section on Ô¨Ålters,
but it is already useful to recognise that a capacitor in the feedback path
determines a diÔ¨Äerentiating action within the loop. This diÔ¨Äerentiation
introduces a phase lead, which improves stability of the closed-loop system.
This diÔ¨Äerentiating action of the capacitor is the result of the fact that the
current in a capacitor advances on the voltage and it is even better explained
with the following example, the diÔ¨Äerentiator.
6.2.5.2
DiÔ¨Äerentiator and First-Order High-Pass
The diÔ¨Äerentiator and the almost identical Ô¨Årst-order high-pass Ô¨Ålter are
created with the same inverting ampliÔ¨Åer conÔ¨Åguration, but in this case a
capacitor is placed in the forward path as shown in Figure 6.50.
When the value of R1 is zero, a pure diÔ¨Äerentiator is created. When the
gain of ‚àí1 of the second inverter stage is included, the transfer function and
frequency response equal:
GD(s) = Z2
Z1
= sR2C ,
GD(œâ) = jœâR2C.
(6.80)
In the Bode plot this results in a line with a slope of +1, which intersects the
0 dB level at the unity-gain cross-over frequency œâ0 = 1/R2C and a constant

530
Chapter 6. Analogue Electronics in Mechatronic Systems
Z2
Z1
G ()
+
C (1F)
+
+
_
_
Vi
R1 (0 or 10k)
R2 (10k)
Vo
+
_
G ()
+
_
R (10k)
R (10k)
z){
z¬Ç{
{
¬Ç{
){
Magnitude [dB]
,{
{
,{
1
,{
¬Ç
,{
3
,{
)
{
)¬Å
¬Ö{
Phase [deg]
 
 
Frequency  [Hz]
High pass
\`
Magnitude (abs)
,{
-1
,{
¬Ç
,{
¬Ç
,{
1
1
Figure 6.50: A capacitor in the forward path of an inverting ampliÔ¨Åer creates a
diÔ¨Äerentiator, when the resistance of R1 is zero. A higher value of R1
creates a Ô¨Årst-order high-pass Ô¨Ålter. The Bode plot shows both fre-
quency responses, using the indicated values of the passive elements.
phase lead of 90¬∞over the entire frequency band.
Generally a pure electronic diÔ¨Äerentiator is impossible by deÔ¨Ånition, as the
gain at inÔ¨Ånitely high frequencies would need to become inÔ¨Ånite. It is also
far from practical in reality and measures should be taken to limit the gain
of a diÔ¨Äerentiator at high frequencies. This is accomplished by adding a
series resistor to R1 and this results in a Ô¨Årst-order high-pass Ô¨Ålter. The
related frequency response, including the gain of ‚àí1 of the second inverter,
becomes:
F(œâ) = Vo
Vi
= Z2
Z1
=
R2
1
jœâC + R1
= R2
R1
1
1+
1
jœâR1C
= R2
R1
jœâR1C
1+ jœâR1C .
(6.81)

6.2. Semiconductors and Active Electronics
531
This represents a Ô¨Årst-order Ô¨Ålter with an RC-time constant œÑ = R1C and
a gain of R2/R1 in the pass band above the corner-frequency œâ0 = 1/œÑ. At
œâ0 the gain is -3 dB and at lower frequencies the slope is +1, equal to the
diÔ¨Äerentiator. This is shown in the Bode plot for the indicated values of the
passive elements, resulting in a pass band gain of one and œâ0 = 100 rad/s.
6.2.6
Analogue PID-Controller
Before the creation of fast digital controllers, operational ampliÔ¨Åers were
used to realise the PID-control function. Figure 6.51 shows an example of
such a circuit, consisting of a combination of the diÔ¨Äerentiator and integrator,
which were presented before.
Before deriving the transfer function, Ô¨Årst the three elements of control are
examined using the values of the passive elements in the circuit. They will
appear to be chosen according to the rules of thumb for a PID-controller, as
described in Chapter 4 with a Ô¨Årst-order taming of the D-control action. The
frequency will be presented in Hertz and the magnitude in the Bode plot is
absolute instead of in dB, because this controller is meant to be used in the
domain of mechanical engineering.
Starting at zero Hertz the impedance of the capacitors is inÔ¨Ånite and the
gain of the circuit will be inÔ¨Ånite too, just as expected from an I-control
system. At an increasing frequency the impedance of C2 will dominate the
gain of the controller, because the impedance of C1 can still be neglected
compared to the impedance of the parallel resistor R3. As a result, the gain
will show a ‚àí1 slope in the Bode plot, conform the I-control action. At the
integrator corner-frequency fi = œâi/2œÄ = 1/(2œÄR2C2) ‚âà20 Hz, the impedance of
C2 becomes smaller than the impedance of R2 and the negative slope will
Ô¨Çatten out. At the diÔ¨Äerentiator corner-frequency fd = œâd/2œÄ = 1/(2œÄR3C1) ‚âà
60 Hz, the impedance of C1 becomes smaller than the impedance of R3 and
the corresponding diÔ¨Äerentiating action will show a +1 slope in the Bode plot,
which is terminated (tamed PID-control) as soon as the impedance of C1
becomes smaller than R1. This happens at the taming corner-frequency ft =
œât/2œÄ = 1/(2œÄR1C3) ‚âà600 Hz. An additional pole can be added by a capacitor
C3 over R5 for shifting the phase, like explained in Section 4.4.7.3 on motion
control of complex systems with a resonating eigenmode.
As was presented in Chapter 4 on the PID controller, a diÔ¨Äerentiating action
gives an additional gain at the cross-over frequency. In this example the
second inverter is used to correct the proportional gain for this additional
gain. The maximum phase lead of the controller occurs at the cross-over
frequency of 200 Hz, where the gain is one. This value is chosen for this

532
Chapter 6. Analogue Electronics in Mechatronic Systems
example. In reality in most cases a higher proportional gain is needed, to
compensate the low gain of the plant. The circuit can be adapted to this
gain by changing the resistors of the second inverting ampliÔ¨Åer.
6.2.6.1
PID Transfer Function
The derivation of the transfer function of the electronic PID-controller starts
with the same general transfer function for the inverting ampliÔ¨Åer as with
the previous Ô¨Ålters, but in this case in the Laplace-domain. It includes the
gain ‚àígi of the second inverting ampliÔ¨Åer and the additional pole by C3
parallel to R5 for shifting the phase8:
Cpid(s) = Vo
Vi
= gi
Z2
Z1
= gi
1
sC2
+ R2
1
1
1
sC1
+ R1
+ 1
R3
1
R5C3s+1.
(6.82)
The control terms œÑi,œÑd and œÑt are derived by shifting of the diÔ¨Äerent terms
without the additional Ô¨Årst-order pole by C3 parallel to R5 as this is an
optional pole that can be added when necessary without consequence for
the other control terms:
Cpid(s) = gi

 1
sC2
+ R2

sC1
1+ sR1C1
+ 1
R3

.
(6.83)
At this point the relevant time constants of the controller are chosen accord-
ing to the corner-frequencies, deÔ¨Åned in the previous part. The Ô¨Årst one, œÑi
deÔ¨Ånes the integrator corner-frequency fi. The second one, œÑd deÔ¨Ånes the
diÔ¨Äerentiator corner-frequency fd and the third one œÑt deÔ¨Ånes the taming
corner-frequency ft.
œÑi = 1
œâi
=
1
2œÄfi
= R2C2
[s],
(6.84)
œÑd = 1
œâd
=
1
2œÄfd
= (R1 + R3)C1 ‚âàR3C1
[s],
(6.85)
œÑt = 1
œât
=
1
2œÄft
= R1C1
[s].
8Although a motion controller converts a position input signal into a force signal, the
analogue PID-controller in this example only converts the input voltage into an output voltage.
Therefore the transfer function of this PID Ô¨Ålter is dimensionless. When applied in a motion
system the input voltage should be derived from the position while the output voltage should
be converted to a current in the power ampliÔ¨Åer.

6.2. Semiconductors and Active Electronics
533
Z2
Z1
G ()
+
+
+
_
_
Vi
R1 (820)
R2 (8k2)
Vo
+
_
G ()
+
_
R  (1k)
R  (3k3)
C2 (1F)
C1 (0.33F)
R3 (8k2)
4 
5 
C3 (0.2F)
 
 
 
 
 
 
10
z,
10
0
10
1
10
2
Magnitude (abs)
10
z,
10
0
10
1
10
2
10
3
10
4
z¬Ö{
z)¬Å
0
)¬Å
¬Ö{
Phase [deg]
Frequency [Hz]
fd
ft
fi
40
20
z¬Ç{
0
Magnitude [dB]
Figure 6.51: Analogue PID controller and the Bode plot of its frequency response.
The indicated values of the resistors and capacitors are chosen for
a PID controller, according to the rules of thumb for a mass control
system, with a targeted unity-gain of the controller at the 200 Hz
bandwidth. In reality the proportional gain should be adapted to the
real gain of the plant at 200Hz. The capacitor C3 can be applied when
an additional pole is needed in the system (dashed lines in Bode plot).
The approximation in œÑd is in most cases allowed as R1 ‚â™R3.
By using these terms the following result can be obtained:
Cpid(s) = gi
R2
R3

 1
œÑis +1

sC1R2
1+ sR1C1
+1

= gi
R2
R3

œÑis+1
œÑis

œÑds+1
œÑts+1

. (6.86)
The Ô¨Årst term is a proportional term, the second term the integrator and

534
Chapter 6. Analogue Electronics in Mechatronic Systems
the third term the tamed diÔ¨Äerentiator. As will be shown further on, the
proportional term needs a correction factor, to become equal to the P-control
gain kp
In the Bode plot the frequency response of this controller is shown with the
values as derived from the given components, œÑi = 8.2¬∑10‚àí3, œÑd = 2.7¬∑10‚àí3 and
œÑt = 2.7¬∑10‚àí4.
As presented in Chapter 4, the positive phase in the frequency band where
the lead network is working, creates an eÔ¨Äective damping in a motion control
feedback conÔ¨Åguration, like the servo system in a CD player. The integration
at low frequencies reduces steady state errors, due to constant disturbing
forces like gravity.
By tuning the values for the capacitors and resistors, the controller can be
adapted to the plant by means of loop shaping.
6.2.6.2
PID Control Gains
The control gains kp for P-control, kd for D-control and ki for I-control, can be
related to the time constants and passive component values of this controller.
For this derivation the taming factor 1/(œÑts+1) is not taken into account as
this represents just an additional pole, which is applied without impact on
the standard control gains.
To determine the control gains, Equation (6.86) is written in the additive
way by multiplication of the terms. This gives the following result, which
corresponds to Equation (4.39) from Chapter 4:
Cpid(s) = gi
R2
R3

1+ œÑd
œÑi

+ gi
R2
R3
1
œÑis + gi
R2
R3
œÑds =

kp + ki
s + kds

.
(6.87)
With this relation and applying the approximation in œÑd, the proportional
gain kp is equal to:
kp = gi
R2
R3

1+ œÑd
œÑi

= gi
R2
R3

1+ (R1 + R3)C1
R2C2

‚âàgi

 R2
R3
+ C1
C2

.
(6.88)
The I-control gain is equal to:
ki = gi
R2
R3
1
œÑi
= gi
R2
R3
1
R2C2
= gi
1
R3C2
1/s

.
(6.89)
The D-control gain is equal to:
kd = gi
R2
R3
œÑd = gi
R2
R3
(R1 + R3)C1 ‚âàgiR2C1
[s].
(6.90)
Also in these expressions the approximation is based on the small value of
R1 relative to R3.

6.2. Semiconductors and Active Electronics
535
6.2.6.3
High-Speed PID-Control
Even though digital controllers have taken over many control actions in
modern equipment, still one important advantage of analogue controllers
over digital ones remains and that is the lack of delay due to sampling.
In the digital world diÔ¨Äerentiating is done at any sampling moment by
taking at least two samples, the present and the previous one, and dividing
the diÔ¨Äerence over the sampling time. The result of this operation can
only be supplied to the plant at the next sampling moment so at least one
sample period later and as a result, part of the beneÔ¨Åcial phase lead will be
lost. One of the solutions is to use a model based controller, to predict the
states, as explained in Chapter 4, but in unpredictable circumstances it is
always better to avoid delays in the D-control part. This requirement has
pushed sampling periods to ever smaller values, but in extremely fast control
situations, like with a piezoelectric scanner for a video-rate Atomic Force
Microscope, with bandwidths that exceed the Mega Hertz level, analogue
controllers might still represent the best solution possible.
6.2.7
Higher-order Electronic Filters
In Section 6.1.3 on passive Ô¨Ålters it was shown that inductors are required to
achieve higher order electronic Ô¨Ålters with an adequate frequency response.
Especially in the low-frequency area, the required high values of the self-
inductance lead to large sizes of the components and inductors in general
are rather expensive to manufacture. In this section on electronic Ô¨Ålters
it will be shown with one example how, by using an operational ampliÔ¨Åer,
these Ô¨Ålters can be created with only small size capacitors and resistors. In
principle, these Ô¨Ålters are designed to be applied with low power signals
and not between ampliÔ¨Åers and actuators, so they can be used only in the
path before the power ampliÔ¨Åer.
The example that is presented here is a Sallen-Key Ô¨Ålter named after R.P
Sallen and E.L. Key, two engineers of MIT Lincoln laboratory in 1955. It is
built around a non-inverting unity-gain ampliÔ¨Åer, as shown in Figure 6.52,
where the output signal is positively fed back to the input to create complex
poles in the transfer function with imaginary parts.
The rules are applied again to calculate the transfer function and frequency
response. The positive input is equal to the voltage at the negative input
and also equal to the output voltage, as the operational ampliÔ¨Åer acts as a
unity-gain voltage follower:
V + = Vo
[V].
(6.91)

536
Chapter 6. Analogue Electronics in Mechatronic Systems
G ()
+
Z1
Z2
Vo
Vi
+
+
Z4
Z3
Vx
+
I1
I3
I2
V+
+
_
_
_
_
_
Figure 6.52: Sallen-Key active second-order Ô¨Ålter conÔ¨Åguration with positive feed-
back.
With this information, the circuit is calculated in the Laplace-domain start-
ing with current I2(s):
I2(s) = V +
Z4
= Vo
Z4
[A].
(6.92)
The following step is to determine the voltage Vx(s):
Vx(s) = Vo + I2Z2 = Vo

1+ Z2
Z4

[V].
(6.93)
With this voltage I1(s) and I3(s) can be determined:
I1(s) = Vi ‚àíVx
Z1
=
Vi ‚àíVo

1+ Z2
Z4

Z1
[A],
(6.94)
I3(s) = Vx ‚àíVo
Z3
=
Vo

1+ Z2
Z4
‚àí1

Z1
= Vo
Z2
Z3Z4
[A].
(6.95)
With KirchhoÔ¨Ä‚Äôs Ô¨Årst law on currents, the sum of all currents at the common
node of Z1, Z2 and Z3 equals zero. This means with the deÔ¨Åned directions
according to the arrows:
I1 ‚àíI2 ‚àíI3 = 0 A.
(6.96)
Using the previously found equations for the diÔ¨Äerent currents, with some al-
gebra the following generic transfer function of this conÔ¨Åguration is derived:
Vo
Vi
(s) = F(s) =
1
Z1Z2
Z3Z4
Z1 + Z2
Z4
+1
.
(6.97)

6.2. Semiconductors and Active Electronics
537
With this result the frequency response of the second-order low-pass Ô¨Ålter
of Figure 6.53 will be determined as an example.
6.2.7.1
Second-Order Low-Pass Filter
The following values for the impedances are chosen for this example:
Z1(s) = Z2(s) = R1 = R2 = R ,
Z3(s) =
1
sC1
,
Z4(s) =
1
sC2
[Œ©].
(6.98)
This gives as transfer function and frequency response of the Ô¨Ålter:
Vo
Vi
(s) = F(s) =
1
R2C1C2s2 +2RC2s+1
‚áí
Vo
Vi
(œâ) = F(œâ) =
1
‚àíR2C1C2œâ2 +2jRC2œâ+1 =
1
‚àíœâ2
œâ2
0
+ j
Q
œâ
œâ0
+1
.
(6.99)
with the following values for the corner-frequency and Quality factor:
œâ0 = 2œÄf0 =
1
R
4
C1C2
rad/s

,
Q = 1
2

C1
C2
(6.100)
It appears that the quality-factor Q can be made very high by increasing
the value of the positive feedback capacitor. This clearly shows the eÔ¨Äect on
the real part of the poles of the transfer function by positive feedback.
G ()
+
R1
R2
Vo
Vi
C1
C2
+
+
_
_
_
Figure 6.53: Sallen-Key active second-order low-pass Ô¨Ålter.

538
Chapter 6. Analogue Electronics in Mechatronic Systems
6.2.7.2
DiÔ¨Äerent Types of Active Filters
By choosing suitable values of the resistors and capacitors, electronic Ô¨Ålters
can be created with almost any frequency and level of damping, without the
need for large inductors. They can be combined at will, to realise higher
order Ô¨Ålters of any slope in the attenuation band.
To illustrate this with an example, Figure 6.54 shows three typical, often
used characteristics of a second-order high-pass Ô¨Ålter with the same corner-
frequency of 100 Hz, but with a diÔ¨Äerent amount of damping.
When the damping is aperiodic with a Q of 0.7, the resulting lack of res-
onance and a magnitude of -3dB at the corner-frequency gives the Ô¨Ålter
Butterworth characteristics, named after the British physicist Stephen But-
terworth (1885 ‚Äì1958), who invented this Ô¨Ålter type. This characteristic is
often seen as the most ideal Ô¨Ålter type, because of its aperiodic behaviour,
although the slope in the attenuation band, just below the ‚àí3 dB frequency
determining the bandwidth, is not very steep.
This steepness of the slope at the ‚àí3 dB frequency can be improved with
a higher Q level. For instance a value of Q = 1.35 results in the Chebyshev
characteristics, named after the Russian mathematician Pafnuty Lvovich
Chebyshev (1821 ‚Äì 1894), because the characteristics are derived from his
 
 
 
z){
z[{
z¬Ç{
z,{
{
,{
Magnitude (abs)
 
 
¬í¬ä,[¬Å]
¬í¬ä{¬Ñ'
¬í¬ä{[
,{
,
,{
¬Ç
,{
[
{
¬Ö{
,¬Ü{
6¬ì$¬ù
^¬å¬ì¬Ä¬ç¬ù

$¬ì¬ù
,{
,
,{
¬Ç
,
Figure 6.54: Three typical characteristics of a second-order high-pass Ô¨Ålter with the
same corner-frequency but diÔ¨Äerent levels of damping. For the But-
terworth characteristics the ‚àí3 dB bandwidth is equal to the corner-
frequency of 100Hz of this example. The Chebyshev characteristics
result in a ‚àí3 dB bandwidth at 70 Hz with the steepest slope below
the pass band. The Bessel characteristics result in a ‚àí3 dB bandwidth
at 200 Hz and a very gradual slope below the pass band.

6.2. Semiconductors and Active Electronics
539
polynomials. The Chebyshev characteristic shows a ripple of +3 dB in the
pass band, but also a more steep slope below the ‚àí3 dB frequency.
On the other hand, when phase characteristics need to be as gradual as
possible, like in loudspeaker crossover Ô¨Ålters, a lower value of Q is often
preferred, like with the shown Bessel Ô¨Ålter with Q = 0.3, named after the
German astronomer and mathematician Friedrich Wilhelm Bessel (1784 ‚Äì
1846). The Bessel characteristic shows a constant group delay in the pass
band, representing a linear phase to frequency relationship dœï/df .
The same characteristics can be shown for low-pass Ô¨Ålters and these exam-
ples are only a limited set of the entire range of diÔ¨Äerent Ô¨Ålter conÔ¨Ågurations,
which are designed for very speciÔ¨Åc purposes. Their design belongs to the do-
main of the specialist and with digital control even more transfer functions
can be realised, including variable delay and other tricks. Nevertheless the
mentioned conÔ¨Ågurations are frequently applied and already very suitable
for the design of general mechatronic systems.
6.2.8
Ideal and Real Operational AmpliÔ¨Åers
All the previously shown conÔ¨Ågurations assumed ideal characteristics of the
applied operational ampliÔ¨Åer. One could wonder, why thousands of diÔ¨Äerent
types of these universal building blocks are designed and manufactured,
when one would be suÔ¨Écient. The reason is that like all components, also
the operational ampliÔ¨Åer is not ideal and the more it needs to approach the
ideal behaviour, the higher the cost will be. In this section, diÔ¨Äerent charac-
teristics will be presented that limit the performance of the circuits with
operational ampliÔ¨Åers. In most cases these limitations can be neglected,
but it is important to be aware of them for the more critical applications
with requirements that are impaired by these limitations.
In Figure 6.55 an overview is given of the real characteristics of a typical
high performance operational ampliÔ¨Åer. The parameters, with their inÔ¨Çu-
ence on the performance, will be explained separately. It will become clear
that most limitations result from the basic building blocks of an operational
ampliÔ¨Åer, the transistors, diodes, resistors and capacitors.
First the static and dynamic gain parameters will be presented in a more
thorough way, because of their relatively dominant inÔ¨Çuence on the func-
tionality and stability of mechatronic systems. This is followed by a reduced
presentation of the less impairing limitations.

540
Chapter 6. Analogue Electronics in Mechatronic Systems
OPA627
At TA = +25¬∞C, and VS = ¬±15V, unless otherwise noted.
UNITS
X
A
M
P
Y
T
N
I
M
S
N
O
I
T
I
D
N
O
C
R
E
T
E
M
A
R
A
P
OFFSET VOLTAGE (1)
Input Offset Voltage
40
10
ŒºV
0
5
2
0
0
1
s
e
d
a
r
G
 
U
A
 ,
P
B
 ,
P
A
ŒºV
Average Drift
0.4
0.8
ŒºV/¬∞C
AP, BP, AU Grades
0.8
2
ŒºV/¬∞C
V
n
oitc
eje
R
 ylp
p
u
S
 r
e
w
o
P
S = ¬±4.5 to ¬±18V
106
120
dB
INPUT BIAS CURRENT (2)
Input Bias Current
VCM = 0V
1
5
pA
Over Specified Temperature
VCM = 0V
1
nA
SM Grade
VCM = 0V
50
nA
Over Common-Mode Voltage
VCM = ¬±
A
p
1
V
0
1
V
t
n
e
rr
u
C
 t
e
sff
O
 t
u
p
n
I
CM = 0V
0.5
5
pA
Over Specified Temperature
VCM = 0V
1
nA
SM Grade
50
nA
NOISE
Input Voltage Noise
Noise Density: f = 10Hz
15
40
nV/‚àöHz
f = 100Hz
8
20
nV/‚àöHz
f = 1kHz
5.2
8
nV/‚àöHz
f = 10kHz
4.5
6
nV/‚àöHz
Voltage Noise, BW = 0.1Hz to 10Hz
0.6
1.6
ŒºVp-p
Input Bias Current Noise
Noise Density, f = 100Hz
1.6
2.5
fA/‚àöHz
Current Noise, BW = 0.1Hz to 10Hz
30
60
fAp-p
INPUT IMPEDANCE
Differential
1013 || 8
Œ© || pF
Common-Mode
1013 || 7
Œ© || pF
INPUT VOLTAGE RANGE
Common-Mode Input Range
¬±11
¬±11.5
V
Over Specified Temperature
¬±10.5
¬±11
V
Common-Mode Rejection
VCM = ¬±10.5V
106
116
dB
OPEN-LOOP GAIN
V
nia
G
 
e
g
a
tlo
V
 
p
o
o
L
-
n
e
p
O
O = ¬±10V, RL = 1kŒ©
112
120
dB
Over Specified Temperature
VO = ¬±10V, RL = 1kŒ©
106
117
dB
V
e
d
a
r
G
 
M
S
O = ¬±10V, RL = 1kŒ©
B
d
4
1
1
0
0
1
FREQUENCY RESPONSE
/
V
5
5
0
4
p
e
t
S
 
V
0
1
 ,
1
‚Äì
 
=
 
G
7
2
6
A
P
O
 :
e
t
a
R
 
w
el
S
Œºs
/
V
5
3
1
0
0
1
p
e
t
S
 
V
0
1
 ,
4
‚Äì
 
=
 
G
7
3
6
A
P
O
Œºs
s
n
0
5
5
p
e
t
S
 
V
0
1
 ,
1
‚Äì
 
=
 
G
%
1
0
.
0
 
7
2
6
A
P
O
 :
e
m
i
T
 
g
niltt
e
S
s
n
0
5
4
p
e
t
S
 
V
0
1
 ,
1
‚Äì
 
=
 
G
%
1
.
0
s
n
0
5
4
p
e
t
S
 
V
0
1
 ,
4
‚Äì
 
=
 
G
%
1
0
.
0
 
7
3
6
A
P
O
s
n
0
0
3
p
e
t
S
 
V
0
1
 ,
4
‚Äì
 
=
 
G
%
1
.
0
z
H
M
6
1
1
 
=
 
G
7
2
6
A
P
O
 :tc
u
d
o
r
P
 
h
t
di
w
d
n
a
B
-
nia
G
z
H
M
0
8
0
1
 
=
 
G
7
3
6
A
P
O
%
3
0
0
0
0
.
0
z
H
k
1
 
=
 f ,
1
+
 
=
 
G
e
sio
N
 
+
 
n
oitr
o
tsi
D
 cin
o
m
r
a
H
 la
t
o
T
POWER SUPPLY
Specified Operating Voltage
¬±
V
5
1
Operating Voltage Range
¬±4.5
¬±18
V
Current
¬±7
¬±7.5
OUTPUT
R
t
u
p
t
u
O
 
e
g
a
tlo
V
L = 1kŒ©
¬±11.5
¬±12.3
Over Specified Temperature
¬±11
¬±11.5
V
V
t
u
p
t
u
O
 t
n
e
rr
u
C
O = ¬±10V
¬±
A
m
5
4
Short-Circuit Current
¬±35
+70/‚Äì55
¬±100
5
5
z
H
M
1
p
o
o
L
-
n
e
p
O
 ,
e
c
n
a
d
e
p
m
I t
u
p
t
u
O
Œ©
TEMPERATURE RANGE
5
8
+
5
2
‚Äì
U
A
 ,
M
B
 ,
M
A
 ,
P
B
 ,
P
A
 :
n
oit
a
cific
e
p
S
¬∞C
5
2
1
+
5
5
‚Äì
M
S
¬∞C
0
5
1
+
0
6
‚Äì
M
S
 ,
M
B
 ,
M
A
 :
e
g
a
r
o
t
S
¬∞C
5
2
1
+
0
4
‚Äì
U
A
 ,
P
B
 ,
P
A
¬∞C
Œ∏J-A: AM, BM, SM
0
0
2
¬∞C/W
AP, BP
0
0
1
¬∞C/W
AU
160
¬∞C/W
A
m
A
m
V
Figure 6.55: Characteristics of a typical high performance operational ampliÔ¨Åer.
An extracted version of the original data sheet of the OPA 627 of Burr
Brown. (Courtesy of Texas Instruments)

6.2. Semiconductors and Active Electronics
541
6.2.8.1
Open-Loop Voltage Gain
The inÔ¨Ånite gain that was assumed in an ideal operational ampliÔ¨Åer can
never be reached. Aside from the obvious statement that it would require
an inÔ¨Ånite amount of transistors, it is also necessary to keep the open-loop
voltage gain within certain limits as a too high gain can lead to instability,
which is explained in the next section. Practical values for this open-loop
voltage gain are in the order of 105 ‚Äì 106 (100 ‚Äì120 dB). This lower value of
the open-loop voltage gain has immediate consequences for the reduction of
errors by distortion and noise, characterised by the sensitivity function S(s).
Under reference to the complementary sensitivity function of an operational
ampliÔ¨Åer, as noted in Equation (6.54), a high closed-loop ampliÔ¨Åer gain
Ga,c would require a low voltage gain Ga,f of the feedback path.
T(s) = Ga,c = Vo
Vi
=
1
1
Ga,o
+Ga,f
.
(6.101)
Unfortunately the sensitivity function is also aÔ¨Äected by the feedback gain
as it equals:
S(s) =
1
1+Ga,oGa,f
=
1
1+Ga,l
.
(6.102)
A high total ampliÔ¨Åer open-loop gain Ga,l will give a low sensitivity for dis-
turbances but a low feedback gain will increase this sensitivity. This is
even more the case for higher frequencies where the open-loop gain of the
ampliÔ¨Åer will decrease due to dynamic limitations. For this reason it is of
utmost importance to be aware of this relation between the complementary
sensitivity (closed-loop gain) and the sensitivity. Often it is necessary to use
more than one operational ampliÔ¨Åer to get a suÔ¨Éciently high total voltage
gain over a wide frequency band.
6.2.8.2
Dynamic Limitations
The most important limitation of all is determined by the Ô¨Ånite gain and
speed of an operational ampliÔ¨Åer. Already at the presentation of a diÔ¨Äer-
entiator it was mentioned that an inÔ¨Ånite gain at inÔ¨Ånite frequencies is
impossible. This speed limitation is caused mainly by the parasitic capacitor
over the PN-junctions of the applied transistors. Especially the parasitic
capacitor Ccb between the collector and base is important, as it reduces the
current-ampliÔ¨Åcation at higher frequencies. The eÔ¨Äect of this capacitor on

542
Chapter 6. Analogue Electronics in Mechatronic Systems
Vp
t
Ccb
cb
cb
cb
dV
d
I
C
t

Vcb
R
b
i
M
I
I
I

	
Ii
t
Ic
Figure 6.56: Speed limitation due to the collector base capacitor Ccb. A voltage
swing at the collector causes a current in Ccb, which has to be supplied
by the input voltage. With a voltage ampliÔ¨Åer, this is perceived at the
input as a Miller capacitor with a larger value than Ccb.
a stepwise change in the input current is shown in Figure 6.56).
This input current (Ii) would normally be equal to the base current (Ib)
and cause a proportional change in the collector current (Ic). The collector
current will cause a proportional drop of the collector voltage over resistor
R, inducing a current (Icb) in Ccb, which in its turn reduces the current in
the base:
Ib = Ii ‚àíIcb = Ii ‚àíCcb
dVcb
dt
[A].
(6.103)
To achieve a high speed, additional base current is necessary to compensate
this eÔ¨Äect depending on the capacitor value. This parasitic capacitor is
perceived at the input as a much larger capacitor, the Miller capacitor CM,
because of the relation of the current in Ccb with the voltage swing at the
collector.
CM = Ccb (Gv +1)
[F].
(6.104)
where Gv is equal to the voltage ampliÔ¨Åcation ratio of the transistor. With an
emitter follower this capacitor can be neglected but with a voltage follower
with an ampliÔ¨Åcation of 100 even a value of 4 pF of a normal signal transistor
becomes signiÔ¨Åcant. The resulting Miller capacitor of 400 pF, combined
with a practical input resistor of 10 kŒ©, already limits the bandwidth of the
single transistor voltage ampliÔ¨Åer to f = 1/(2œÄRC)=40 kHz.
Frequency Response
A real operational ampliÔ¨Åer contains many transistors to control the in-
ternal currents and voltages and to protect the operational ampliÔ¨Åer from

6.2. Semiconductors and Active Electronics
543
OUT
Vsup
‚Äì
Vsup
36 pF
37 pF
14 pF
7 pF
15 Œ©
460 Œ©
15 Œ©
IN+
IN‚Äì
T1
T2
T3
T4
T5
T6
T7
T8
+
Figure 6.57: Schematic circuit drawing of the NE5532, a general purpose audio am-
pliÔ¨Åer with bipolar transistor inputs. The transistors from Figure 6.40
are made recognisable and several more transistors are added for con-
trolling the internal currents and voltages and for protection like the
current protection transistors between T7 and T8. The dominant pole
is created by a feedback capacitor of 37 pF around the high gain stage
by T4 and T5. The other capacitors are added for further Ô¨Åne-tuning
the open-loop frequency response.
(Courtesy of Texas Instruments)
overload. As examples the schematic circuit diagram of two real ampliÔ¨Åers,
optimised for diÔ¨Äerent purposes, are shown in Figure 6.57 and Figure 6.58.
The NE5532 is a general purpose audio operational ampliÔ¨Åer, designed for
stability and low cost. The OPA627 is designed as a precision ampliÔ¨Åer with
Field EÔ¨Äect Transistors (FET) at the input to reduce the input currents.
Like a MOSFET, a FET uses an electric Ô¨Åeld to control the current but the
Gate is not insulated by an oxide but by another PN-junction.
The integration of many transistors in an operational ampliÔ¨Åer results by
deÔ¨Ånition in several parasitic capacitances. These capacitances cause prob-
lems in the dynamic performance, because they determine RC-times (poles)
in the transfer function with the associated phase lag of 90¬∞at œâ = 2œÄf = 1/RC
for each capacitor with its source resistance. This eÔ¨Äect is even increased
with the collector-base capacitance of each transistor as explained with the
Miller capacitor. When two or more of these Ô¨Årst-order poles are located
in the frequency range where the gain is larger than one, the closed-loop

544
Chapter 6. Analogue Electronics in Mechatronic Systems
Trim
5
Trim
1
+In
3
‚ÄìIn
2
Output
6
7
+Vsup
‚ÄìVsup
4
C1
C2
¬Æ
OPA627
Figure 6.58: Schematic circuit drawing of the OPA627, a high precision ampliÔ¨Åer
with Field EÔ¨Äect Transistor (FET) inputs to reduce the input current.
The dominant pole is created by increasing the pole of the parasitic
capacitors around the large gain ampliÔ¨Åer stage between C1 and C2.
(Courtesy of Texas Instruments)
transfer function becomes marginally stable or even unstable when some
additional phase lag is introduced by a third pole.
To illustrate this dynamic eÔ¨Äect, an example open-loop frequency response
with marginal stability is shown in Figure 6.59. The red line shows the
frequency response of an ampliÔ¨Åer with an open-loop gain of 106 and two
poles below 1 MHz. The Ô¨Årst pole is located at 100 Hz and the second pole at
10 kHz, where the gain is still 104. The phase margin approaches zero even
below 1MHz, where still some gain is present. This can create problems
when the closed-loop gain is < 100 as a phase margin of approximately 45 is
preferred for a well damped behaviour.
This problem can be solved by limiting the open-loop gain and creating one
dominant pole at a lower frequency. This causes the ampliÔ¨Åcation to go
down with a slope of ‚àí1 from that frequency. The pole can be realised by
placing an internal larger capacitor in the part of the operational ampliÔ¨Åer
most prone to parasitic poles, like those related to the Miller capacitances
in the high voltage gain stage. This capacitor can be placed parallel to
an existing parasitic collector-base capacitance to move the main pole to
a lower frequency, like C2 in the OPA627. But also a feedback capacitor
can be used around the total high gain ampliÔ¨Åer stage, like in the NE5532.
The indicated feedback capacitor of 37 pF cancels one of the parasitic poles
inside the loop and creates a new one, because it gives a diÔ¨Äerentiating

6.2. Semiconductors and Active Electronics
545
 
 
 
 
10
0
10
1
10
2
10
3
10
4
10
5
10
6
Magnitude (abs)
 
 
Uncompensated
Compensated
10
0
10
2
10
4
10
6
z,¬Ü{
z,[¬Å
z¬Ö{
z)¬Å
0
Phase [deg]
Frequency [Hz]
-2
-1
-1
Magnitude [dB]
120
100
¬Ü{
60
40
20
0
Figure 6.59: Poles in the transfer function of an operational ampliÔ¨Åer can be can-
celled by one dominant pole. This example shows two poles in the
uncompensated situation, one at 100 Hz and one at 10 kHz. It is clear
that the phase margin past 100 kHz is very small. With the dominant
pole at 1 Hz in the compensated situation the phase margin becomes
45¬∞.
action inside the loop (a zero).
By placing this pole at a suÔ¨Éciently low frequency, the total gain of the
ampliÔ¨Åer crosses the unity-gain level before other poles have a signiÔ¨Åcant
impact on the phase. With this method, the circuit with an operational
ampliÔ¨Åer is stable at any closed-loop feedback conÔ¨Åguration with a phase
margin of 45¬∞at the unity-gain cross-over frequency of 1 MHz for this ex-
ample, as shown with the blue line in Figure 6.59. This method is called
pole-splitting because of the eÔ¨Äect that the Ô¨Årst pole is moved to the left and
the second pole to the right in the Bode plot.
Gain-Bandwidth Product
The creation of only one dominant pole in the frequency range where the
gain is larger than one is reÔ¨Çected by a continuous ‚àí1 slope in the frequency
response above the corner-frequency that is determined by this pole. As a
consequence the product of the gain and the frequency is constant at any
frequency between the corner-frequency and the unity-gain cross-over fre-
quency. This constant value is called the gain-bandwidth product and with
this value a designer can immediately determine the achieved bandwidth
at a certain closed-loop ampliÔ¨Åcation. Ideally the gain-bandwidth product
is inÔ¨Ånite.

546
Chapter 6. Analogue Electronics in Mechatronic Systems
V
t
Figure 6.60: The slew-rate of an operational ampliÔ¨Åer limits the speed of change of
the output voltage. At high frequencies the output can not follow the
sinusoidal waveform anymore and tracks the signal with its maximum
dV/dt.
Slew Rate
Another consequence of the internal capacitances is the limited speed of
change of the output voltage. This slew-rate is determined by the maximum
current that is available inside the operational ampliÔ¨Åer to change the
voltage over the internal capacitors, when amplifying high-frequency AC
signals. The source of this current is limited by the nature of the design,
which means that the voltage over the capacitors can not change faster, than
a certain value of dV/dt. In practice this means that at high frequencies the
maximum amplitude of the signal is limited. Above these levels a sinusoidal
waveform will change into a phase shifted triangular waveform with Ô¨Åxed
slopes, because of the maximum dV/dt. Ideally the slew-rate is inÔ¨Ånite.
6.2.8.3
Input Related Limitations
Input OÔ¨Äset Voltage and Stability
The input oÔ¨Äset voltage is the voltage needed between the + and - inputs,
to achieve 0 V at the output. This is caused by small diÔ¨Äerences between
the transistors in the diÔ¨Äerential gain stage of the operational ampliÔ¨Åer.
The presence of an oÔ¨Äset voltage means in a feedback circuit that the Ô¨Årst
rule in reality is a bit diÔ¨Äerent. It should have been said that the ampliÔ¨Åer
will do whatever it can to achieve a diÔ¨Äerence between the input voltages
equal to the oÔ¨Äset voltage. The oÔ¨Äset voltage is only important in case
of amplifying very small DC voltages, because in practice this voltage is
smaller than a few mV. In some operational ampliÔ¨Åers it can be adjusted to
near zero volt. The long-term stability of the oÔ¨Äset voltage, also called drift,

6.2. Semiconductors and Active Electronics
547
R2
R1
G ()
+
_
Vo
+
V -
+
_
_
V +
+
_
bias
I 
bias
I 	
Figure 6.61: The bias current in both inputs of an operational ampliÔ¨Åer causes a
voltage drop over the source resistors R1 and R2. When both resistors
are equal the eÔ¨Äect on the output voltage is zero.
is important to know, when very small DC voltages need to be ampliÔ¨Åed
accurately over a long period of time. This drift is mainly caused by the
temperature sensitivity of the transistors.
Ideally the oÔ¨Äset voltage is zero without any drift.
Input Bias and OÔ¨Äset Current
The input bias and oÔ¨Äset current represent the currents that Ô¨Çow into or
out of the input terminals and that are required to operate the ampliÔ¨Åer. In
previous examples, like with the transistor, it was shown that biasing by
applying an additional voltage or current to the circuit input is frequently
needed in order to bring the electronic system in its optimal working condi-
tion. The presence of this current in an operational ampliÔ¨Åer implies that
also the second rule about zero currents in the inputs is not completely true.
In a bipolar transistor input stage, like with the NE5532, the bias current
is necessary to drive the Ô¨Årst transistor with a current level in the order
of several nA. With special transistors like the FETs in the OPA627, the
input current can be reduced to several pA. A low value of the bias current
is important when the path from the inputs to ground has a high resistive
value. This current would otherwise inÔ¨Çuence the output voltage to compen-
sate the related voltage drop over the resistors. The inÔ¨Çuence of the bias
current can be reduced by designing the ampliÔ¨Åer in such a way that the
source (Thevenin) impedance of the circuit around the + input equals the
impedance of the circuit around the ‚àíinput. This is shown in Figure 6.61

548
Chapter 6. Analogue Electronics in Mechatronic Systems
where the output voltage is zero in case of an equal bias current on both
inputs and when both resistors are equal:
V + = 0 ‚àíR1I+
bias
[V],
Vo = V ‚àí+ R2I‚àí
bias
[V],
V + = V ‚àí
=‚áí
Vo = R2I‚àí
bias ‚àíR1I+
bias = 0 V.
(6.105)
It is clear that an oÔ¨Äset in the bias current will result in an oÔ¨Äset voltage at
the output even when the resistors R1 and R2 are equal.
It is especially important to be aware that a capacitor as is applied in the
feedback path of an integrator, is not able to conduct DC-currents like the
bias current.
Ideally the bias current is zero.
Noise Voltage and Current
Stochastic signals are generated in resistances and all other components of
the operational ampliÔ¨Åer because of the temperature. This noise is repre-
sented as a voltage over the inputs and as a current into the input. The noise
voltage is directly translated into a noise voltage to the output, determined
by the feedback circuit and the noise currents are translated to the output
voltage, through the source impedance of the circuits around the inputs. The
noise can be represented by a cumulative value, but is mostly represented
by a noise density value as a function of the frequency area.
Ideally the noise is zero.
Input Resistance
The input resistance is the value that corresponds to the part of the input
current that is dependent on the input voltage so excluding the bias cur-
rent. This property is due to the transistors and resistors around the input
circuits. DiÔ¨Äerential-mode is the resistance between both input terminals
and common-mode is the resistance of both inputs to ground. In case of
a feedback system, the diÔ¨Äerential-mode resistance plays a very limited
role as the voltage between both inputs is kept close to zero. In reality the
diÔ¨Äerential input resistance is reduced with a factor equal to the loop gain.
With an inverting ampliÔ¨Åer also the common-mode resistance is of little
importance as both input voltages are kept at ground level. Only with a non-
inverting conÔ¨Åguration, the common-mode input resistance has inÔ¨Çuence
on the input currents.
Ideally the input resistance is inÔ¨Ånite.

6.2. Semiconductors and Active Electronics
549
Input Voltage Range
In most operational ampliÔ¨Åers, the inputs are not allowed to exceed the
power supply voltage level and normal operation is only guaranteed over
an even smaller range. Often the inputs are protected against occasional
higher voltages by diodes but these will also reduce the input resistance
and for that reason, protective input diodes are not used in very critical
designs. Exceeding these values results in clipping of the output voltage to
the maximum level and it can even cause damage to the device.
Ideally the input voltage range is inÔ¨Ånite.
Common-Mode Rejection Ratio
The purpose of an operational ampliÔ¨Åer is to amplify only the voltage diÔ¨Äer-
ence between the two inputs, the diÔ¨Äerential-mode voltage. This means that
the output voltage should be completely independent of the common-mode
voltage of the input terminals. The ratio between the gain of the diÔ¨Äerential-
mode to the gain of the common-mode is called the common-mode rejection
ratio (CMRR).
Ideally the CMRR is inÔ¨Ånite.
6.2.8.4
Power Supply and Output Limitations
Power Supply Rejection Ratio
Noise and level variations such as ripple of the power supply does preferably
not have have inÔ¨Çuence on the output voltage. The power supply rejection
ratio (PSRR) is deÔ¨Åned as the ratio between a power supply voltage change
and an equivalent input voltage giving the same eÔ¨Äect on the output.
Ideally the PSRR is inÔ¨Ånite.
Open-loop Output Resistance
This determines the change of the output voltage as function of the output
current. In a feedback system this value is reduced by a factor equal to the
loop gain. Also the eÔ¨Äective closed-loop output impedance will be frequency
dependent, because the loop gain is frequency dependent, due to the main
pole. As it increases with frequency, this can be modelled as a very small
series inductor.

550
Chapter 6. Analogue Electronics in Mechatronic Systems
Power Consumption
The power consumption is determined by many factors. The Ô¨Årst factor
is related to the idle current that is needed in the transistors and these
are modulated by the signal. The power consumption is related to the
slew-rate, as a high slew-rate requires a high internal current to charge
the capacitors. Further also the maximum output current determines the
power consumption.
The power consumption should ideally be zero and for portable devices
special operational ampliÔ¨Åers are developed that show a very low idle current
level below 1 mA.
6.2.9
Closing Remarks on Low-Power Electronics
It is demonstrated that low power analogue electronics can be applied in
many diÔ¨Äerent ways that all deal with the manipulation of electric signals
by ampliÔ¨Åcation and Ô¨Åltering. The operational ampliÔ¨Åer has developed
over time into an extremely versatile building block, optimised for diÔ¨Äerent
applications. With the basic knowledge of this chapter, it is possible to
select suitable components in an analogue electronic system without help of
specialists, but still too many things have remained untouched and need
attention to achieve a real solid design. A few of them are summarised
below:
‚Ä¢ The properties of the power supply.
Especially at high frequencies the power supply will not be a very
good voltage source anymore. This requires the addition of ceramic
capacitors between the power supply and ground, as close as possi-
ble to the operational ampliÔ¨Åer, to short high-frequency interference
to ground, combined with a small electrolytic capacitor to dampen
any high-frequency oscillations by its internal parasitic resistance.
Sometimes even local linear power supply stabilisation is required. A
stabilised power supply is a special version of a power ampliÔ¨Åer, which
will be presented in the following chapter. For moderate power levels,
voltage stabilising circuits are available as IC, which can directly be
mounted on a printed circuit board.
‚Ä¢ Mains supply issues.
The power socket of the mains is not really a nice 230 V AC voltage
source. Sometimes the signal hardly looks like a sine wave at all. The
worst are spikes of several kV, due to circuit breakers at other places

6.2. Semiconductors and Active Electronics
551
or even caused by a lightning stroke. The electronic system needs
additional safety components to lead away this excessive voltage from
the sensitive parts.
‚Ä¢ Precautions for Electromagnetic compatibility (EMC).
Electric current runs in loops and magnetic Ô¨Åelds induce voltages in
these loops. These voltages are added to the signal and can cause
errors. This requires a careful lay out of the wiring of an electronic
circuit. This subject will return in Chapter 8 on measurement.
‚Ä¢ Precautions against Electrostatic discharge (ESD).
Especially ICs with MOSFET inputs are sensitive for electrostatic
charge build up, which can damage the thin layer between the Gate and
the channel. Besides careful handling in a discharged environment,
this also means that the electronic circuit needs protective components
to prevent electrostatic charge build up.
‚Ä¢ The eÔ¨Äect of safety grounding.
Most professional electronic equipment is provided with a grounded
housing for human safety. This is not always the most preferred
situation from an interference point of view. Also this subject will
return in Chapter 8.
These and several other issues make the electronic Ô¨Åeld to an important, ex-
citing and rather diÔ¨Écult specialisation, where a vast amount of knowledge
is gained in the last decades.

552
Chapter 6. Analogue Electronics in Mechatronic Systems
6.3
Power AmpliÔ¨Åers for Motion Control
Combined with the actuators and the mechanics, the power ampliÔ¨Åer deter-
mines the dynamic behaviour of the mechatronic plant. Power ampliÔ¨Åers
diÔ¨Äer from the ampliÔ¨Åers in the previous section in their focus on reliable
electrical power delivery and eÔ¨Éciency. As will be demonstrated, this fo-
cus has invoked several special technologies that are only partly or hardly
required in low power signal ampliÔ¨Åcation. With the example of a modern
tube ampliÔ¨Åer according to ancient technology as shown in Figure 6.62 it
is already clear that power has a relation to size and heat but even with
more eÔ¨Écient semiconductor devices like the ones shown in Figure 6.63
a power ampliÔ¨Åer will remain recognisable by the large components that
have to sustain elevated voltages, currents and heat. It is also true to say
that the design of power ampliÔ¨Åers will appear to be quite similar in certain
ways, in spite of these diÔ¨Äerences. Especially the presented topology of the
Figure 6.62: Just half a century ago, proportional electronic control of electric
power could only be achieved by means of electron tubes working in
vacuum at very high voltages with glowing wires heating a cathode
to create free electrons. The shown audio power ampliÔ¨Åer can deliver
two times sixty watt, while producing about the same amount of heat.
Fortunately semiconductors can do the job with less eÔ¨Äort although
also with less beauty.

6.3. Power AmpliÔ¨Åers for Motion Control
553
Figure 6.63: The high power semiconductors as shown on the right can be distin-
guished from signal transistors as shown left by their mechanical
means to connect them with a heat sink in order to keep the tem-
perature of the semiconductor material below the level where the
semiconductor stops working (‚âà150‚àí200‚ó¶).
operational ampliÔ¨Åer can be directly used for the design of linear power
ampliÔ¨Åers.
This section starts with an overview of the requirements of power ampliÔ¨Åers
with an emphasis on the application with electromagnetic actuators. After a
short comment on linear power ampliÔ¨Åers, Switched-mode power ampliÔ¨Åers
are presented in more detail, because they are the preferred power-ampliÔ¨Åer
technology in mechatronic systems due to their high eÔ¨Éciency and energy
recoveruy capabilities.
6.3.1
Required Properties for Actuator Drive
The following main speciÔ¨Åcation items are related to the application of a
power ampliÔ¨Åer in a mechatronic motion system.
‚Ä¢ Power delivery capability.
‚Ä¢ Dynamic properties.
‚Ä¢ Linearity.
‚Ä¢ Voltage or current drive.
‚Ä¢ EÔ¨Éciency.
‚Ä¢ Four-quadrant operation

554
Chapter 6. Analogue Electronics in Mechatronic Systems
6.3.1.1
Power Delivery Capability
A large power implies automatically a high value of the current and voltage.
As it appears to be diÔ¨Écult to integrate high voltage electronics, the power
stages in these ampliÔ¨Åers are often built with active and passive discrete
components. The applied large coils, resistors and power semiconductors
generally produce heat. Silicon semiconductors can withstand temperatures
on the chip of 150 ‚Äì 200 ‚ó¶C, but due to the heat transfer resistance of the
packaging, mostly the temperatures at the outside of the device have to be
kept at a more reduced temperature level.
These thermal issues automatically require eÔ¨Écient methods to remove
the heat from the sensitive electronics. Normally the mechanical design of
small-signal electronics on printed circuit boards is a rather two-dimensional
exercise but the lay-out of a power ampliÔ¨Åer is a real three-dimensional
mechanical challenge. The thermal design with cooling plates and the use
of large parts requires a design that takes the mass and the environmental
mechanical dynamics under serious consideration. Solder joints for instance
are not capable of sustaining high mechanical loads and, while this is a
frequent cause of malfunctioning electronics, this is just an example of the
special skills needed when designing power ampliÔ¨Åers.
Another issue of the high power is the potential interference by magnetic and
electric Ô¨Åelds, the Electro Magnetic Compatibility (EMC), caused by rapidly
changing high voltages and currents. Also this aspect requires a careful
three dimensional lay-out with shielding plates and conscious routing of the
wiring.
6.3.1.2
Dynamic Properties
When a power ampliÔ¨Åer is used in a mechatronic system, it determines a
part of the feedback loop. A signal delay caused by the ampliÔ¨Åer adds one or
more poles with their related phase lag to the open-loop transfer function
and reduces the stability margins. Especially with a digitally controlled
ampliÔ¨Åer (sample time) this is an aspect to pay attention to. In an analogue
ampliÔ¨Åer this delay is only related to the frequency response. Even when
the ampliÔ¨Åer is fast enough under normal resistive loads, the complex load
of an electromagnetic actuator (L,R,C) will inÔ¨Çuence the internal stability
of the ampliÔ¨Åer. For that reason, power ampliÔ¨Åers for high performance
mechatronics need to be designed speciÔ¨Åcally for a certain application.

6.3. Power AmpliÔ¨Åers for Motion Control
555
6.3.1.3
Linearity, Freedom of Distortion
Non-linearity in an ampliÔ¨Åer has several eÔ¨Äects. In audio appliances it is
the source of audible distortion, but in professional mechatronic systems
the non-linearity impairs the behaviour in two other ways. First of all it
changes the gain of the ampliÔ¨Åer as function of the actual value of the output
voltage or current. As a consequence the loop-gain in a feedback system
becomes dependent on the actual output voltage with ultimately a chance
to become unstable. In practice it is not diÔ¨Écult to limit the non-linearity
to such a low level that this instability issue hardly ever occurs, with one
exception: The ultimate non-linearity happens when the output voltage has
reached its maximum level, close to the supply voltage. At that moment
the output voltage ‚Äúclips‚Äù and all control is lost. This eÔ¨Äect was introduced
in Section 4.4.3.2 of Chapter 4, where it was explained how such extreme
clipping can result in an uncontrolled ‚Äúlimit-cycling‚Äù of the motion system.
But even without this extreme example, a small non-linearity can cause
errors with feed forward control. As long as the non-linearity is reproducible
and deterministic it can be compensated, but non-linearity of an ampliÔ¨Åer
is a sign of a non-optimal design and that almost automatically implies the
occurrence of thermal drift.
6.3.1.4
Voltage or Current Drive
Voltage-drive of an actuator with a low output impedance of the ampliÔ¨Åer is
required when damping is necessary, as was presented in Section 5.4.1.3
of Chapter 5. This is for instance the case if the ampliÔ¨Åer is used in com-
bination with loudspeakers, where the amplitude at the lower resonance
frequency needs to be controlled.
Current-drive of an actuator with a high output impedance of the ampliÔ¨Åer
is required when the current and the force needs to be independent of the
movement of the actuator and the self-inductance of the actuator windings.
This is mostly the case in servo-controlled positioning systems with Lorentz
actuators. With a high output impedance there is no force change caused by
a relative velocity of the mover and stator, resulting in a reduced transmis-
sibility between these parts when compared with a low output impedance
ampliÔ¨Åer.

556
Chapter 6. Analogue Electronics in Mechatronic Systems
0
 
 
Current
Voltage
t
I,V
Vsup
+
Vsup
-
V1
1
t
Figure 6.64: With an inductive load, the current from the ampliÔ¨Åer will have a
phase lag with respect to the voltage. This means that the ampliÔ¨Åer
needs to have a four-quadrant capability by delivering positive and
negative currents at any sign of the output voltage.
6.3.1.5
EÔ¨Éciency
An ampliÔ¨Åer transforms a supply voltage and current into an actuator
voltage and current. When this transformation is done by means of a linear
element like a transistor, the actuator current has to run through this
transistor. This actuator current multiplied with the voltage diÔ¨Äerence
between the power supply and the output determines the power that is
dissipated inside the ampliÔ¨Åer.
In most other electric equipment the multiplication of maximum voltage
and current gives a good indication of the maximum power that is involved.
Unfortunately, with power ampliÔ¨Åers that drive inductive loads, like an
electromagnetic actuator, this is not the case. In Section 5.4.1 of Chapter 5 it
was shown that driving a high current in a short time in an electromagnetic
actuator with e certain self-inductance L requires the ampliÔ¨Åer to deliver
a signiÔ¨Åcantly higher voltage to overcome the high values of L(dI/dt) than
is required to deliver the mechanical power in the system, because these
maximum values mostly occur at diÔ¨Äerent moments. The maximum voltage
occurs at the beginning of the acceleration, when the currenty has to rise
sharply, while the maximum power is delivered at the end of the acceleration
when the velocity is high. In that case the maximum voltage times the
maximum current of the ampliÔ¨Åer needs to be far higher than its power
capability. This requirement can have a signiÔ¨Åcant impact in the total
system cost and reliability and is elaborated more in the following section.

6.3. Power AmpliÔ¨Åers for Motion Control
557
6.3.1.6
Four-Quadrant Operation
The self-inductance of an electromagnetic actuator also causes another
problem when the actuator is driven with a periodic signal, because for
a sinusoidal signal the current is out of phase with the voltage. In the
extreme case of a purely reactive load the maximum current needs to be
delivered at zero voltage, while at a quarter of the period a positive current
is delivered with a negative voltage and at another quarter it is just the
other way around, like shown in Figure 6.64. The capability to deliver
currents with a diÔ¨Äerent sign from the voltage at any moment is called a
four-quadrant operation. For instance in Figure 6.64 at time t1 the still high
positive current has to be delivered by the power transistor connected to the
positive power supply, while the output voltage is still negative. The voltage
over the transistor that conducts the current is then as large as V1, which is
more than V +
sup.
Motion Induced Voltage
Driving actuators with sinusoidal currents is more related to audio ampli-
Ô¨Åers than mechatronic motion systems and due to the relatively low levels
of self-inductance of loudspeakers the four-quadrant operation is not a very
large issue.
However, in mechatronic positioning systems with a high moving mass the
real problem is caused by the kinetic energy that is involved. At acceleration,
the motion voltage of the actuator increases in phase with the current and
electric power is inserted in the system and converted into kinetic energy.
The deceleration phase is however completely the opposite. While the mo-
tion voltage still has the same sign as during constant motion, the current
needs to be reversed in order to reverse the energy Ô¨Çow. This means that
the full amount of kinetic energy has to be absorbed by the ampliÔ¨Åer. This
problem is even more severe with electric cars of which part of the eÔ¨Éciency
improvement is the possibility to recharge the car batteries upon braking.
6.3.1.7
Preferred Power AmpliÔ¨Åer Principle
Not surprisingly the requirements are mainly related to power and eÔ¨Éciency.
Especially the four-quadrant operation requirement is an important issue for
heavy fast moving motion systems due to the corresponding kinetic energy
that preferably is not dissipated into heat but re-converted into electric
energy.

558
Chapter 6. Analogue Electronics in Mechatronic Systems
sup
V 	
sup
V 
+
_
o
V
+
_
T2
T3
T1
Da1
Da2
+
_
iV
G ()
+
_
R1
R2
R4
R5
R3
R6
R7
Voltage feedback path
+
_
sup
I 
sup
I 	
\`$$
Level 

Voltage 
$
]
$
Figure 6.65: The basic design of a linear power ampliÔ¨Åer is similar to an operational
ampliÔ¨Åer of which the output stage is build with discrete components
that can withstand high voltages and currents. The operational am-
pliÔ¨Åer in this schematic serves as the diÔ¨Äerential input and gain stage.
The transistors T1, T2 and T3 determine a level-shifter to achieve a
large output voltage range. The push-pull output stage consists of two
so called Darlington pairs Da1, which conducts the positive current I+
(red arrow) and Da2, which conducts the negative current I‚àí(green
arrow). The positive and negative current in the load are both in the
positive direction for the two power supplies.
In principle power ampliÔ¨Åers are designed according to two basic modes of
operation:
‚Ä¢ Linear power conversion.
‚Ä¢ Switched-mode power conversion.
With linear power conversion the output power is controlled by controlling
the value of an impedance between the positive or negative power supply
and the load. Linear9 power ampliÔ¨Åers are in fact a high power version of
an operational ampliÔ¨Åer with feedback.
A basic design of such a power ampliÔ¨Åer, without all bells and whistles
related to an optimal performance and stability is shown in Figure 6.65.
9The term ‚Äúlinear‚Äù to distinguish it from the switched-mode version is related to the
analogue almost linear nature of all elements in the ampliÔ¨Åer, while switched-mode ampliÔ¨Åers
are as linear and analogue as their ‚Äúlinear‚Äù counterpart in respect to the relation between the
input and output signals.

6.3. Power AmpliÔ¨Åers for Motion Control
559
The electric power is supplied by a power supply with a constant voltage.
The high-power output stage consists of a set of Darlington-pair transistors
(Da1,Da2), which have a very high current-ampliÔ¨Åcation ratio. These tran-
sistors are named after the American electrical engineer Sidney Darlington
(1906 ‚Äì 1997), who invented the conÔ¨Åguration. Darlington pairs are two
integrated cascaded emitter followers, able to deliver currents up to several
amp√®res with a current-ampliÔ¨Åcation of more than 1000. The current from
the power supply to the load is conducted to the required level by one of
these Darlington pairs depending on the current direction. Both Darlington
pairs in fact act like controlled resistors as function of the voltage on their
base.
The electronics before the power output stage control the voltage on the base
of the Darlington pairs such that the required current and voltage on the
output is met.
In this example ampliÔ¨Åer voltage drive is achieved by measuring the output
voltage and comparing it after attenuation with the input signal of the
ampliÔ¨Åer. It is also possible to give it a current-drive output characteristic
by measuring the current through the load. In fact a linear power ampliÔ¨Åer
can fulÔ¨Ål the Ô¨Årst fouyr requirements on power capability, dynamics, linear-
ity and driving mode. Unfortunately, this is much less the case with the
requirements on eÔ¨Éciency and four-quadrant operation. This is due to the
fact that Da1 can only conduct the current from the positive supply, while
Da2 can only conduct the current from the negative supply.
In the situation that a negative current needs to be delivered with a positive
output voltage, hence energy is Ô¨Çowing into the ampliÔ¨Åer, this implies
that Da2 needs to conduct the current while the voltage over Da2 is equal to
the voltage diÔ¨Äerence between the positive output voltage and the negative
supply voltage. This means that all energy from the load is dissipated into
heat at Da2, which is not according to the preferred performance of a power
ampliÔ¨Åer.
Fortunately, the introduction of extremely fast switching power semiconduc-
tors like Power MOSFETs enabled the application of the second principle,
where switched-mode power-conversion is applied in the design of power
supplies and ampliÔ¨Åers that can regain the energy from the load, almost
without power loss.
As will be shown this principle allows to design ampliÔ¨Åers where all re-
quirements are fulÔ¨Ålled. For this reason in recent years the switched-mode
power ampliÔ¨Åer has become the de facto standard for power ampliÔ¨Åers in
mechatronic systems.

560
Chapter 6. Analogue Electronics in Mechatronic Systems
6.3.2
Switched-Mode Power AmpliÔ¨Åers
The application of switched-mode electrical power conversion in ampliÔ¨Åers
and power supplies is based on the fundamental understanding that the
output of a slow linear system will settle around an average value when
the input is switched between two values at regular short intervals. Key
in this reasoning is that the switching intervals should be (signiÔ¨Åcantly)
shorter than the reaction time of the process. A well known example of
such a process is the heating of a house by a central heating system that
is switched on and oÔ¨Äby a thermostat. The heating of the house is slow
due to the large heat capacity, which stores the energy. For the switching
frequency of the thermostat the heat capacity also acts as a low-pass Ô¨Ålter,
which mainly transfers the average (DC) value of the heat input by the
heater to the temperature of the room.
This control principle with only two discrete states is called bang-bang
control to emphasise the abrupt way of operation.
As was shown in Section 6.1.3.3, passive low-pass Ô¨Ålters can be designed by
means of a combination of impedances, of which the capacitors and inductors
+
_
0V
Power supply            Ampli%er                              Actuator
+
_
+
_
+
Vo
_
Io
B
Figure 6.66: Switched-mode operation of an ampliÔ¨Åer consists of high frequency
switching the voltage on the input (B) of an LC low-pass Ô¨Ålter between
the positive and the negative power supply. The output voltage Vo
is equal to the average value of the squarewave signal at point B.
By changing the ratio between the duration of the positive and the
negative part of the squarewave the average output voltage can be
varied to any value between the negative and positive power supply
voltage.

6.3. Power AmpliÔ¨Åers for Motion Control
561
are capable of storing electric energy without power loss in dissipation. By
combining a pure L-C low-pass Ô¨Ålter with electronic switches that switch
between diÔ¨Äerent voltages, as shown in Figure 6.66, lossless electric power
conversion can be realised.
In this chapter only the ampliÔ¨Åers are presented, because ampliÔ¨Åers are
an important element in any mechatronic system due to their impact on
the dynamic behaviour of the actuators. Power-supplies are in principle a
special version of a power ampliÔ¨Åer with a Ô¨Åxed output voltage combined
with some special circuit topologies for mains rectiÔ¨Åcation and insulation
by means of transformers. For the understanding of the switched-mode
operation principle the ampliÔ¨Åers are suÔ¨Éciently representative for both
systems.
Two typical switched-mode ampliÔ¨Åers will get an illustrating role in this
section. The Ô¨Årst example is an early prototype of a voltage-drive power
ampliÔ¨Åer, designed around 1980 at Philips ‚ÄúNatLab‚Äù and was used with
the Ô¨Årst electric wafer stage in the Silicon Repeater as was presented in
Chapter 1. This ampliÔ¨Åer delivered moderate output voltages with ¬±30 V
and currents up to 5 A. The second ampliÔ¨Åer is a three-phase high-power
current-drive ampliÔ¨Åer, designed around 1995 at the Philips Centre For
Technology and used to drive the 5 kW long-stroke actuators in the earlier
Twinscan wafer scanners of ASML.
As an important Ô¨Årst step in designing a switched-mode ampliÔ¨Åer Ô¨Årst the
power MOSFET is presented as the main element in the system. This is
followed by an explanation of the diÔ¨Äerent principles to trigger the switching
moments, including Duty-Cycle or pulse-width modulation, self-oscillating
or Ô¨Åxed frequency and output or input referenced switching. Then the Ô¨Årst
example ampliÔ¨Åer is introduced to show the principle on a self-oscillating
output referenced voltage-drive ampliÔ¨Åer. With this basic understanding,
a deeper analysis of current-Ô¨Çows in switching power-output stages is pre-
sented, Ô¨Ånalised by an optimal design method, using the resonant-mode of
the reactive components in the three-phase ultra-high power current-drive
ampliÔ¨Åer of the second example.
6.3.2.1
Power MOSFET, a Fast High-Power Switch
The currents and voltages in switched-mode ampliÔ¨Åers need to be switched
at a very high frequency in the order of 100 ‚Äì 500 kHz An ideal electronic
switch is able to conduct current in both directions, has zero resistance at
closure, can withstand very high currents and voltages and has zero switch-

562
Chapter 6. Analogue Electronics in Mechatronic Systems
ing time. And last but not least an ideal electronic switch does not require
energy to change its state. It is clear that also in this case ‚Äúideal‚Äù does not
exist, although the continuous improvements in electronic technology have
brought us near ideal devices named power MOSFETs.
In precision mechatronic positioning systems, bipolar transistors are seldom
used as switching devices. The reason is that they require a relatively high
base current. Further they are relatively slow, due to the low speed of the
holes as charge carrier and they suÔ¨Äer from a phenomenon called secondary
breakdown, a destructive mode limiting their power capability. On the
other hand their ruggedness has made them popular in power-conversion
systems, which do not need a very high switching frequency. The high base
current has been solved by integrating a MOSFET as input device before the
bipolar transistor. This combined device is called an Insulated Gate Bipolar
Transistor (IGBT) and can switch several kilo volt with several kilo amp√®re
current. IGBTs are not preferred in high precision mechatronic positioning
systems, because of their relatively high switching times in the order of
several tens of microseconds. Instead their main application is found in
electrical transport systems like trains and hybrid cars.
For the more high-frequency applications always N-channel power MOS-
FETs are used, as they oÔ¨Äer switching speeds in the order of a few nanosec-
onds, because they use only electrons as charge carriers. Power MOSFETs
are created by placing millions of small MOSFETs in parallel. This is
allowed as each separate MOSFET behaves like a variable resistor and
resistors can be placed parallel to create a smaller resistor value. This
parallelism requires a special conÔ¨Åguration of the MOSFET elements, dif-
ferent from the horizontal conÔ¨Åguration shown in Figure 6.33. The vertical
structure from Figure 6.67, with the Drain at the bottom side of the chip
and the Source at the top side, enables to directly connect all Drains and all
Sources, while the Gates are connected via an insulated embedded wiring
network spread over the chip.
Even though a MOSFET can in principle conduct current from Drain to
Source in two directions, usually some asymmetry is applied in the design
to optimise the MOSFET for only one current direction. It is also common
practice to connect the Source directly to the substrate, as these will have
the same potential when the current runs from the Drain to the Source in
an N-channel MOSFET. As a consequence of this connection, the junction
between the N-material of the Drain and the P-material of the substrate
acts like a silicon diode between the Source and the Drain. This diode helps
conducting current from the Source to the Drain, opposite to the normal
current direction and it will be demonstrated that this is a very useful

6.3. Power AmpliÔ¨Åers for Motion Control
563
Drain

¬ç
Drain
n+ Substrate
n- Epi Layer
Channels
n+
p
n+
p+
p+
#rce
Gate
Oxide
Pysilicn
Gate
Srce

¬ç
G
S
D
Figure 6.67: A power MOSFET consists of millions of small MOSFETs connected
in parallel. This is accomplished by a vertical design where the Source
and the Drain are at two sides of the chip and the Gates are embedded
in an insulating oxide layer. The symbol shows that the substrate is
connected to the Source. As a direct consequence of this connection,
an additional diode is present between the Drain and the Source,
determined by the junction between the Drain and the substrate. This
diode is used eÔ¨Äectively in switched-mode ampliÔ¨Åers. (Courtesy of
International RectiÔ¨Åer)
property in switching inductive loads.
Like all other elements in electronics, also power MOSFETs suÔ¨Äer from
several parasitic capacitances and for that reason they are not really ideal.
The most important is the capacitance of the Gate, which amounts in the
order of 10 nF for a power MOSFET that can switch more than 200 A of
current. Also the capacitance between the Drain and the Gate plays a sim-
ilar negative role as the collector-base capacitance of a bipolar transistor.
Its Miller capacitance as experienced at the Gate is fortunately less than
the input capacitance, but still the rather large total capacitance requires
a charging and discharging current each time the MOSFET switch needs
to change its state. As a result a net current is Ô¨Çowing in and out of the
Gate. In high power applications the switching voltage at the Gate needs
to be at least 10 V and with a switching frequency fs of 100 kHz, an input
capacitance of 10 nF gives an eÔ¨Äective current Ig to the Gate of:
Ig = fs
1
2CV 2 = 105 ¬∑10‚àí8 ¬∑100 = 0.1 A.
This value needs to be compared with the maximum current of 200 A that
can be switched. It is still below the value of a comparable Darlington pair in

564
Chapter 6. Analogue Electronics in Mechatronic Systems
a continuous current situation, with a current-ampliÔ¨Åcation factor Œ≤ = 1000,
and this is without the additional base current necessary to charge the
Miller capacitance. In fact this current level to the Gate is quite acceptable.
It should be noted however that this current is directly proportional to the
switching speed. It is one of the sources of power dissipation in a switched-
mode power ampliÔ¨Åer.
6.3.2.2
Switching Sequence Generation
Several methods are applied to generate the switching sequence of a switched-
mode ampliÔ¨Åer. Some of them use a Ô¨Åxed frequency from a separate os-
cillator, while others generate the switching frequency by self-oscillation.
Figure 6.68 shows two examples of these approaches. The Ô¨Årst is also known
as pulse-width modulation (PWM) or duty-cycle modulation, because it gen-
erates a square waveform at a Ô¨Åxed frequency with a variable duty cycle and
width of the switching pulses. For a square-wave signal the average value
is zero, when the negative part of the period is equal in time to the positive
part. The ratio between the positive part and the full period is called the
duty-cycle. The average DC value VDC of a square-wave signal is equal to
the following expression, because of this deÔ¨Ånition, where V ‚àíis the negative
voltage of the square-wave signal and V + the positive value:
VDC = V ‚àí+

V + ‚àíV‚àí

¬∑duty‚àícycle
[V].
(6.106)
With V + = ‚àíV ‚àí, which is always the case with ampliÔ¨Åers, a duty-cycle of
50 % gives an average voltage of zero volt.
In this example the input signal is used as reference for the switching
moments, which means that the ampliÔ¨Åer does not use feedback. The main
advantage of this approach is its straightforward simplicity, its inherent
stability due to the absence of feedback and its independent switching
behaviour of the load.
Unfortunately, there are two main disadvantages of this method, which
reduce its use to less demanding applications like variable speed control in
hand tools. These drawbacks are the sensitivity for voltage variations in
the power supply and the short pulses that are required when the output
voltage approaches one of the power supply voltages. A 10% or 90% duty-
cycle at 500 kHz implies a negative or positive pulse of only 0.2Œºs, while the
current levels are mostly high at those high output levels. This increases
power dissipation in the switches. The Ô¨Årst drawback can be reduced by
applying overall feedback but for the short pulses it is better to also reduce

6.3. Power AmpliÔ¨Åers for Motion Control
565
0
a: Switching based on input compared to triangle wave 
triangle wave
0
Upper trigger level
Lower trigger level
Switch sequence
Switch sequence with 50% duty-cycle
b: Switching based on output compared to input with hysteresis 
Output
Scaled input 
lower input => lower duty-cycle 
         => lower average output
Input = triggerlevel
Figure 6.68: Two examples of methods to deÔ¨Åne the switching moments in a
switched-mode ampliÔ¨Åer. a: uses a triangle wave signal with con-
stant amplitude and frequency, where the switching is triggered when
the triangle wave crosses the input signal. It creates a squarewave
signal with variable duty cycle. b: compares the output signal with
a scaled value (gain) of the input signal as setpoint and triggers the
switches when the output signal needs to increase or decrease. A
small diÔ¨Äerence (hysteresis) between the upper and lower trigger lev-
els results in a self-oscillating behaviour that generates a square wave
with variable duty-cycle and frequency.
the frequency when nearing the power supply voltages. In hand tools this
is done by simply switching to the power supply voltage and stopping the
pulses, which is not suitable for a precision ampliÔ¨Åer.
With the second example a gradual reduction of the switching frequency is
achieved by self oscillation, which makes it applicable for high performance
mechatronic systems. It is very much comparable with how the central
heater works with bang-bang control, where the thermostat acts as a non-
linear switch with hysteresis between the trigger temperatures. In example

566
Chapter 6. Analogue Electronics in Mechatronic Systems
b: of Figure 6.68 the output of the ampliÔ¨Åer, which can be a voltage or a
current, is measured and compared to a setpoint value that is proportional
to the input signal. When the output signal drops below the lower trigger
value, slightly below the setpoint, a positive voltage is switched on and the
output will rise. When the output signal rises above the upper trigger value,
slightly above the setpoint, a negative voltage is switched on and the output
will drop.
Several properties of this method are important to mention:
‚Ä¢ First of all, the gain of the ampliÔ¨Åer is equal to the scaling factor that
is applied to the input signal to generate the switching trigger level.
‚Ä¢ Secondly, a non-linear element with a certain level of hysteresis is
required, because the switching frequency is inversely proportional
to the hysteresis between the upper and lower trigger level. The hys-
teresis must be chosen such that the frequency at 0 V output is in a
favourable working range for maximum eÔ¨Éciency and minimum ripple
(noise) at the output. item Thirdly, the measured output can be either
the output voltage or current, which means that the ampliÔ¨Åer can be
chosen to act as a voltage-drive or current-drive ampliÔ¨Åer.
‚Ä¢ Finally and most importantly, the short pulses are never shorter than
half the pulse-width at 0 V output, while the switching frequency is
reduced. This is due to the fact that the slope of the triangle ripple at
the output is determined by the diÔ¨Äerence between the output voltage
and the switching voltage before the LC Ô¨Ålter. At 0 V output this
diÔ¨Äerence is equal to the positive or negative supply voltage. When
the output approaches one of the supply voltages this diÔ¨Äerence rises
to the sum of the negative and positive supply voltages for the short
part of the switching period while it reduces to zero for the long part of
the period. In extremis the frequency will be zero when the ampliÔ¨Åer
clips against one of the supply voltages.
6.3.2.3
Voltage Drive AmpliÔ¨Åer
The Ô¨Årst example ampliÔ¨Åer of Figure 6.69 is a frequency and pulse-width
modulated switched-mode voltage-drive ampliÔ¨Åer. A copy of the original
hand drawing of the circuit diagram from 1980 is shown in Figure 6.70. This
ampliÔ¨Åer was designed for driving the linear electric motors of the wafer
stage, shown on the cover of this book for the Silicon Repeater Mark 2. The
circuit diagram gives an indication of the relative simplicity of the design,

6.3. Power AmpliÔ¨Åers for Motion Control
567
with some digital switching components, like C-MOS integrated circuits
(the little triangles), two operational ampliÔ¨Åers, two normal and four power
MOSFETs, three bipolar transistors and several passive components. The
functionality of every main building block will be illustrated by using the
actual component values and other system properties, which will become
clear in this chapter.
‚Ä¢ The switching frequency fs of this ampliÔ¨Åer is 150 kHz at 0 V output
voltage.
‚Ä¢ The switching output stage consists of two single-ended switching
power units in counter phase using only a single supply voltage of 30 V.
This is equivalent to one single-ended output stage with two supply
voltages of plus and minus 30 V.
‚Ä¢ The output Ô¨Ålter consists of an inductor with a self-inductance of 1 mH
and a capacitor of 0.33 ŒºF, giving a corner-frequency f0 of 8.7 kHz with
a ‚àí2 slope in the attenuation band.
‚Ä¢ The impedance of the actuator consists of a resistor of 5 Œ© in series
with a self-inductance of 8 mH, giving an electric time constant œÑe =
L/R = 1.6 ms
Figure 6.69: The switched-mode power ampliÔ¨Åer that was designed for the Ô¨Årst
electric wafer stage for the Silicon Repeater wafer stepper. The Power
MOSFETs on the cooling plate and inductors of the output Ô¨Ålter are
easily recognisable.

568
Chapter 6. Analogue Electronics in Mechatronic Systems
Figure 6.70: Circuit diagram of the switched-mode power ampliÔ¨Åer (Original hand
drawing from 1980.)

6.3. Power AmpliÔ¨Åers for Motion Control
569
The working principle is based on self-oscillation by means of a non-linear
element in the feedback loop. It is a modulated triangle ‚Äì square-wave
oscillator and will be explained with the help of Figure 6.71.
The heart of the oscillator consists of an inverting integrator and a Schmitt
trigger, a comparator with hysteresis acting as non-linear element. It is
named after the American scientist Otto Herbert Schmitt (1913 ‚Äì 1998) who
invented it. The output of the Schmitt trigger can only have two states. In
this ampliÔ¨Åer one state is a positive voltage and the other state is a negative
voltage, both with an equal magnitude. The output can only change its
state from negative to positive, when the input surpasses a certain positive
trigger level and it can change its state from positive to negative only when
the input comes below a certain negative trigger level. The output of the
Schmitt trigger is used as input for the high power switching stage and the
high-frequency part of the output of that stage is Ô¨Åltered out by a passive
LC-Ô¨Ålter, transferring only the average DC value of the output signal. The
switching output signal before the Ô¨Ålter is fed back to the integrator. First
the principle will be explained when assuming that both outputs are equal,
because this switched output is an almost perfectly scaled duplicate square-
waveform from the output of the Schmitt trigger.
Starting with the Schmitt trigger in the positive output state, the output
of the inverting integrator (1) will show a negative slope over time at a
speed depending on the output voltage of the power output stage, the input
voltage, the capacitor value and the resistor values of R1 and R2. As soon
as the output of the integrator has reached the negative trigger level of the
Schmitt trigger, the latter will switch its state to a negative voltage, driving
the output of the power stage to the negative power supply and the output
of the integrator will start to rise again, until the positive trigger level is
reached. At that moment the Schmitt trigger changes its state back to the
positive output voltage driving the power output stage to the positive power
supply voltage. This process continues, resulting in a square-wave signal at
the output of the power output stage with a corresponding triangle wave
signal at the output of the integrator. When the input voltage equals zero,
the resulting square-wave and triangle wave will be fully symmetrical with
both an average value of zero volt. A soon as a positive input voltage is
applied, the resulting current in R1 in the direction of the minus input of
the integrator will add to the current in R2. As a result the down slope of
the integrator will become steeper relative to the up slope, resulting in a
tilted triangle wave at the output of the integrator with a non-symmetrical
square-wave at the output of the Schmitt trigger. The triangle wave output
of the integrator will always remain zero in average as the gain of the

570
Chapter 6. Analogue Electronics in Mechatronic Systems
+
_
iV
G ()
+
_
R2
R1
+
_
C
1
2
iV
1
2
o
V
+
_
o
V
#'$$
¬ã$

$


$
%
LC-
Vo
Vi
Figure 6.71: pulse-width modulator as used in the switched-mode power ampliÔ¨Åer
of Figure 6.70. The sum of Vi and the output of the balanced switching
output stage is integrated by the inverting integrator. In combination
with the Schmitt trigger in a closed feedback loop, this creates an
oscillator with an average output voltage proportional to the input
voltage.
integrator is inÔ¨Ånite for zero Hertz. This means that the average value of
its inputs also needs to be zero to fulÔ¨Ål rule one of the operational ampliÔ¨Åer.
This implies that the average value of the square-wave output of the power
output stage is proportional to the input voltage in a ratio determined by R1
and R2. By Ô¨Åltering the square-wave by means of the LC-Ô¨Ålter, this average
value is obtained at the output and the system acts like a normal inverting
ampliÔ¨Åer. By measuring the output before the Ô¨Åltering, a signal is obtained
that in case of an ideal power stage would be proportional to the output of
the Schmitt trigger. For the non-ideal reality this feedback of the switched
output signal will help to correct any errors in this stage because of the high
gain of the integrator.
The Schmitt trigger in the example ampliÔ¨Åer of Figure 6.70 is realised with
positive feedback around the second operational ampliÔ¨Åer (IC2).
6.3.2.4
Energy Flow in the Power Output Stage
To investigate the relation between current, voltage and power in the power
output stage, Figure 6.72 gives a detailed overview of its behaviour during

6.3. Power AmpliÔ¨Åers for Motion Control
571
M2
M1
C
L
I
I
I
V
Vsup
+
Vsup
-
L
C
o
o
Vb
M2
M1
C
L
I
I
I
V
Vsup
+
Vsup
-
L
C
o
o
M2
M1
C
L
I
I
I
Vsup
+
Vsup
-
L
C
o
o
M2
M1
C
I
I
I
V
Vsup
+
Vsup
-
L
C
o
o
Step 1: M1 switched on. 
 
 
Step 2: M1 `¬â
2 switching on.
]


]!¬õ$$
2 and decreases.
$

$
Step 3: M2 switched on. 
 
 
Step 4: M2`¬â
1 switching on.
]$
]!¬õ$$
1 and decreases
$$

$     $
IL
Vo
Vb
t0
t
t0
IL
Vo
Vb
t
IL
Vo
Vb
t0
t
IL
Vo
Vb
t0
t
              Step 1: 
 
Step 2: 
 
             Step 3: 
 
Step 4:
+ 30 V
- 30 V
+ 0.05 A
+ 0.1 V
- 0.1 V
- 0.05 A
3.33 s

Vo
Vo
Vo
Vo
IL
IL
IL
IL
0
0
0
0
0
0
0
0
0
0
0
0
L
Io
Io
Io
Io
Io
Io
Bridge
V
+
+
+
+
+
-
-
-
-
-
Vsup
+
Vsup
-
+ 30 V
+ 30 V
+ 30 V
+ 30 V
- 30 V
- 30 V
- 30 V
- 30 V
Figure 6.72: Current Ô¨Çow in a switching power stage of a switched-mode power
ampliÔ¨Åer with power MOSFET switches and an LC-Ô¨Ålter. The red
arrows correspond to the momentary direction of the high-frequency
current within a cycle and the black arrows correspond to the direction
of a positive low-frequency current. One cycle consists of four equal
steps of 1.66 Œºs for each step, corresponding to an average output
voltage of 0 V.

572
Chapter 6. Analogue Electronics in Mechatronic Systems
one switching period, divided in four distinguishable steps.
To illustrate the eÔ¨Äects with real numbers this example shows the signals
with the actual component values of the example ampliÔ¨Åer, a 150 kHz
switching frequency with an output Ô¨Ålter consisting of an inductance of
1 mH and a capacitor of 0.33 ŒºF. An equivalent single-ended output stage is
chosen with equal positive and negative supply voltages of ¬±30 V. A duty-
cycle of 50 % results in an average output voltage of 0 V.
One cycle of 6.66 Œºs is shown in the Ô¨Ågure.
The starting point of the Ô¨Årst step is taken when the current in the inductor
is zero and the Ô¨Årst power MOSFET M1 is just switched on, transferring
the full positive power supply voltage of V +
sup = 30 V to the voltage Vb at
the connecting point between the switches. As will become clear after the
last step, the voltage Vo at the output of the Ô¨Ålter is then at its maximum
negative value of ‚âà‚àí0.1V and never grows bigger than an alternating value
of this same magnitude.
The total voltage diÔ¨Äerence over the inductor is only determined by the
momentary bridge-voltage Vb = V +
sup = 30 V, because of this low value of the
output voltage at this duty-cycle. As a result the current in the inductor of
1 mH will increase in the Ô¨Årst 1.66 Œºs to a maximum level IL,max determined
by:
Vb = L dI
dt
[V]
=‚áí
IL,max =
œÑ

0
Vb(t)
L
dœÑ = Vb
L dt ‚âà0.05 A.
This current Ô¨Çows in the capacitor of 0.33 ŒºF and the voltage change is
calculated by integrating the current over the 1.66 Œºs:
IL = C dVo
dt
[A]
=‚áí
Œ¥Vo =
œÑ

0
IL(t)
C
dœÑ = 0.5 IL,max
C
dt ‚âà0.1 V.
As a result the voltage Vo is zero after the Ô¨Årst step.
In the second step M1 is switched oÔ¨Äand M2 is switched on shortly after
but not immediately, as that could cause a short-circuit current as will be
explained later. However, in spite of this short delay, the voltage Vb will
quite rapidly jump to the negative power supply voltage of V ‚àí
sup = ‚àí30 V after
M1 is switched oÔ¨Ä. This is caused by the current in the inductor, which needs
a voltage to change and will remain running until a negative voltage has
reduced the current level to zero again. The current will Ô¨Årst Ô¨Çow through
the diode of M2 before M2 is switched on completely, because of the delay
in switching of M2. This proves the usefulness of this diode as without
the diode the voltage Vb could be forced to more negative values than V ‚àí
sup,

6.3. Power AmpliÔ¨Åers for Motion Control
573
IL
Vo
Vb
t0
t1
0V
0A
0V
+15 V
  +3 A
+3.05 A
+15.1 V ; +3.02 A
+0.1 V ; +0.02 A
+0.05 A
+30 V
+30 V
Transion from 50 % to 75 % duty cycle at t1
Aer stabilisaon 
Io
Io
Vo
0A
IL+3A
Vb 0V
Vsup
+
Vsup
-
-30 V
V 0V
Io 0A
Figure 6.73: When the ampliÔ¨Åer is loaded with a resistive load of 5 Œ© a change in
the duty-cycle from 50 % to 75 % will cause an average output voltage
of +15 V with a corresponding average output current of 3 A. At the
transition moment t0 Ô¨Årst the current and the voltage will increase
until an equilibrium is reached. The ripple remains almost constant
with only a change of waveform.
leading to damage of the MOSFET.
As a result of the negative voltage over L the current IL will decrease again
until it is zero at the end of the second step.
The third and the fourth step are identical to the Ô¨Årst and second step. Only
the signs are diÔ¨Äerent and as a result the end of the fourth step is identical
to the beginning of the Ô¨Årst step.
In this still quite ideal situation it is clear than no power is dissipated in any
element. The switching MOSFETs either conduct current without a voltage
between their terminals and the reactive elements only store energy.
The reasoning from Figure 6.72 is true for the situation with 50 % duty-cycle
and zero average output voltage. In that case also the average output current
Io to a resistive load is zero. This ampliÔ¨Åer was designed for a 5 Œ© load
and Figure 6.73 shows what happens with the current, when the duty-cycle
is changed to 75 % and the load of 5 Œ© is applied. At that duty-cycle the
average output voltage will be 15 V and the corresponding average output
current is 3 A.
As soon as the duty-cycle is changed, the current IL in the inductor Lc

574
Chapter 6. Analogue Electronics in Mechatronic Systems
will increase, with a corresponding more continuous increase of the output
voltage Vo and output current Io. A higher level of Vo has as consequence
that the voltage diÔ¨Äerence over the inductor at the upward current slope
is reduced and the voltage diÔ¨Äerence at the downward current slope is
increased. This causes these slopes to change until at equilibrium the slopes
just correspond to the diÔ¨Äerence in timing. For instance at 75 % duty-cycle,
the voltage diÔ¨Äerence in the upward current slope in the inductor is 15 V
and the voltage diÔ¨Äerence at the downward current-slope is 45 V, while also
the timing is 1 : 3. This means that the peak to peak AC level of the current
is unchanged and this also means that the peak-to-peak level of the voltage
is not changed. In fact only the shape of the signals is changed.
Magnitude of the Ripple Voltage
The ripple voltage value that was calculated on Page 572 can be veriÔ¨Åed by
using the attenuation of the LC-Ô¨Ålter on the original square-wave signal.
The ‚àí2 slope in the attenuation band of this second-order Ô¨Ålter will reduce
the peak ripple voltage Vp,ripple, due to the peak switching output voltage
Vp,b at the output of the switching MOSFETs to a value, approximately
equal to:
Vp,ripple = Vp,b

 f0
fs
2
= 30

 8.6
150
2
‚âà0.1 V.
This corresponds to the value found in the previous analysis and is about
-50 dB below the maximum voltage level of the switching output. It is
important to note that this ripple voltage is always present, even without a
low-frequency output signal. The only way to reduce this ripple would be by
either increasing the switching frequency, by taking a higher order Ô¨Ålter,
or by lowering the corner-frequency of the Ô¨Ålter. In one way this illustrates
the need for very fast switches when these ampliÔ¨Åers are applied in high
precision positioning systems. On the other hand a signal of 100 mV at
150 kHz is not expected to give much acceleration in a heavy positioning
system and it is also not audible too.
Like with all decisions in mechatronic design, for every speciÔ¨Åc situation it
has to be examined, whether these artefacts would give a problem or not.
6.3.2.5
Intermediate Conclusions and Other Issues
With these results it is shown that in principle an ampliÔ¨Åer can be created,
which gives a low-frequency output signal proportional to the input signal

6.3. Power AmpliÔ¨Åers for Motion Control
575
by modulating a high-frequency switching signal and Ô¨Åltering the high-
frequency components. No power dissipation takes place, because there are
only switches and reactive components and all would be well when there
were not some issues left that still need attention.
‚Ä¢ The Gates of the N-channel MOSFETs need to be driven relative to
the Source.
‚Ä¢ charge-pumping occurs with single-ended output stages.
‚Ä¢ The interaction between the output Ô¨Ålter and the load impedance.
‚Ä¢ Speed limitations of the power MOSFETs.
‚Ä¢ The need for a high output impedance, resulting in current-drive to
the load.
‚Ä¢ The need for three-phase ampliÔ¨Åcation.
These issues are all addressed in the following sections to complete this
chapter on power ampliÔ¨Åers.
6.3.2.6
Driving the Power MOSFETs
A speciÔ¨Åc requirement of power MOSFETs is that they need a voltage of
around 10 V between the Gate and the Source to be switched on. Also the use
of only N-channel MOSFETs poses special requirements on the electronic
circuitry to drive the Gates, while the high input capacitance at the Gate
requires the driver to be capable of delivering a very high current in an
extremely short time. For the MOSFET at the negative supply side, this
means that the switching voltage has to be supplied between the Source
at the negative supply voltage V ‚àí
sup and the Gate. For the MOSFET at the
positive supply side, the Source is even not at a constant voltage as the
bridge-voltage Vb of the output switches from V ‚àí
P to V +
sup. The controller
electronics always operate at a low voltage (5 ‚Äì10 V) around ground level.
As a consequence of these requirements a Ô¨Çoating Gate-drive circuit needs
to be used as shown in Figure 6.74. A Ô¨Çoating Gate-drive circuit has its own
power supply, galvanic insulated from the power supply of the ampliÔ¨Åer and
the switching commands are transferred by an insulating opto-coupler. A
photo coupler consists of an LED with a photo-transistor, which is a bipolar
transistor where the base is exposed to the light that has to be measured.
The photons that fall on the exposed base will excite electrons that act like

576
Chapter 6. Analogue Electronics in Mechatronic Systems
MOSFET
Gate-driver
Opto-coupler
Linear
regulator
Enable
circuit
V   
Po
MOSFET
Gate-driver
Linear
regulator
Enable
circuit
Neg
Output %lter
Po MOSFET switching branch
¬ö$
#FET switching branch
LF output
Bridge
+5V
+5V
sup
+
V   
sup
-
+12V
G
S
D
G
S
D
1
2
3
4
Opto-coupler
1
2
3
4
V   
sup
-
V   
b
V           =
sup,float
-
+12V
V   
b
V           =
sup,float
+
Figure 6.74: Gate drivers for the switching power MOSFETs need to relate the Gate
voltage to the Source voltage, which is either at the negative supply
voltage V ‚àí
sup or at the bridge-voltage Vb. These voltages are diÔ¨Äerent
from ground and the level of Vb switches continuously between both
supply voltages, which means that the Gate driving circuits must
be insulated from the control part, which is done by means of opto-
couplers. The power to the gate driver of each MOSFET is supplied
by a Ô¨Çoating power supply with a voltage of ‚âà12 V above the Source
voltage of the corresponding MOSFET.
(Courtesy of ASML)
the regular base current in a normal transistor, resulting in a current at the
collector when the transistor is supplied with a suitable voltage. One can
also use a photo-diode for this purpose where the photons excite electrons
in the depletion layer between the N- and P-doted silicon but the sensitivity
of a photo-transistor is higher because of the current ampliÔ¨Åcation ratio,
which is often preferred.
The insulation of the power supply is not shown in the Ô¨Ågure. Floating
power supplies can be realised in the main power supply by using an electric
transformer with separate secondary windings for each supply voltage.

6.3. Power AmpliÔ¨Åers for Motion Control
577
6.3.2.7
Charge Pumping
The presented single conÔ¨Åguration with two power supplies appears to give
a problem with these energy sources, because the load is connected between
its output and ground. The problem occurs when the ampliÔ¨Åer delivers a
low-frequency or DC current to the load and is explained with the help of
the black arrows in Figure 6.72.
When a DC current is delivered to the load, this DC current is superimposed
on the high-frequency AC currents as shown with the red arrows. When this
positive current is larger than the amplitude of the high-frequency current,
the total current in the inductor has become unidirectional in all steps of
the switching process. For step one and four that is no problem because
this positive current is supplied by the positive power supply. But in step
two and three this positive current will be supplied from the negative power
supply to ground. This means that the negative power supply delivers a
negative power. Or in other words, the negative power supply receives power.
This is also imaginable when recollecting the fact that the positive current
equals a Ô¨Çow of negatively charged electrons and in step two and three these
electrons move from ground towards the negative power supply. As a result
of this process, the negative power supply gets more charge.
The energy involved in this process originally came from the positive power
supply in step one where it was stored in the inductor and for that reason
this process is called charge-pumping. With a positive DC output current
of the ampliÔ¨Åer, the negative supply should be capable to accept all this
negative charge by delivering this positive current. Like with a linear power
ampliÔ¨Åer, most standard power supplies do not have this four-quadrant
capability where both the positive and negative supply voltage can handle
a positive and negative current. Take for instance the power supply made
with the diode-bridge rectiÔ¨Åer and storage capacitor from Figure 6.29 of the
previous section. A positive current from the negative power supply, which
is caused by charge-pumping, will result in a continuous increase of the
negative supply voltage, because the diodes of the rectiÔ¨Åer can not conduct
current in the reverse direction. This increase of the negative supply volt-
age will continue until damage occurs in the storage capacitor or in other
components.
The same eÔ¨Äect but in the opposite direction happens with a negative DC
current, in which case a continuous charge is transported from the negative
to the positive power supply.
When only alternating currents are to be delivered to the load like in audio
power ampliÔ¨Åers, the storage capacitor can handle the short excess of charge

578
Chapter 6. Analogue Electronics in Mechatronic Systems
in each signal period. Mechatronic systems often require a more extended
period with a DC current component and in that case a solution for this
charge-pumping phenomenon has to be found.
One solution can be to use a power supply with four-quadrant capability. In
that case the resulting energy can for instance be dissipated somewhere in-
side the power supply in a resistor, although then a large part of the beneÔ¨Åt
of the switched-mode ampliÔ¨Åer is lost. The best solution is to transfer the
energy back to the mains supply. This is achieved in special switched-mode
power supplies, which operate with the same principles as a switched-mode
ampliÔ¨Åer. By switching currents and voltages over reactive elements and
the application of high-frequency transformers to change the voltage levels,
they are optimised for DC voltages only, with as much as possible a voltage
source output impedance. With additional switches the conversion from the
mains power to the DC output power can be reversed but power supplies
with that capability are more complex than power supplies that work in only
one direction.
Another good example of a power supply with four-quadrant capability is a
rechargeable battery, as long as the maximum charge level is not exceeded.
When the power supply is not able to handle these currents, which run con-
tinuously in the opposite direction of the voltage, the problem can be solved
in the ampliÔ¨Åer itself, by using the H-bridge or dual-ended conÔ¨Åguration as
is applied in the example ampliÔ¨Åer.
6.3.2.8
H-Bridge ConÔ¨Åguration
In the H-bridge conÔ¨Åguration, one terminal of the load is connected to one
single-ended ampliÔ¨Åer, while the other terminal is connected to a second
single-ended ampliÔ¨Åer. The second ampliÔ¨Åer has to deliver the same voltage
and current as the Ô¨Årst ampliÔ¨Åer but with a diÔ¨Äerent sign. This means that
both ampliÔ¨Åers share the same current at half of the required voltage.
One beneÔ¨Åt of this conÔ¨Åguration is the possibility to use a lower supply
voltage or even a single supply voltage like in the example ampliÔ¨Åer from
Section 6.3.2.3. Using a single power supply reduces the complexity of
the total system as one single-ended output stage is less complex than a
complete second power supply. Human safety is also less aÔ¨Äected because
the maximum voltage diÔ¨Äerence at any location in the ampliÔ¨Åer is only one
time the power supply voltage. Furthermore, the possibility to ground the
Source of the power MOSFET at the negative side avoids the need for an
insulated Gate drive circuit for that power MOSFET.
The second advantage of a dual-ended conÔ¨Åguration in a switched-mode

6.3. Power AmpliÔ¨Åers for Motion Control
579
M2
M1
Vsup
+
Vsup
-
Vsup
+
Vsup
-
M2
M1
Vsup
+
Vsup
-
Vsup
+
Vsup
-
Load
Load
Step 1: M1 and M3"(^¬õ/
Step 2: M1 and M3`"(^¬õ/
M4
M3
M4
M3
Vsup
+
Vsup
-
Vsup
+
Vsup
-
Figure 6.75: In an H-bridge conÔ¨Åguration the load is connected between two single-
ended ampliÔ¨Åers that work in counter phase. The magnetic energy in
the inductors, build up in step one is delivered by both power supplies
and gained back in step two, which avoids charge pumping.
ampliÔ¨Åer is the absence of charge-pumping. In Figure 6.75 it is shown that
the current Ô¨Çows from the positive supply voltage to the negative supply
voltage in the event of a positive DC current to the load at step one. Both
supplies are loaded with the same current and both deliver energy to the
inductors and the load. At step 2 the current Ô¨Çows from the negative supply
to the positive supply, while both supplies regain energy from the stored
magnetic energy of the inductors.
In this conÔ¨Åguration each power supply has to absorb at maximum the
magnetic energy that it inserted in the same switching cycle. This means
that charge-pumping is fully avoided.

580
Chapter 6. Analogue Electronics in Mechatronic Systems
This dual-ended conÔ¨Åguration has become the de-facto standard in the
industry for single-phase ampliÔ¨Åers, which drive only one load with large
currents that include DC.
6.3.2.9
Output Filter
When calculating the damping at the corner-frequency of the applied output
Ô¨Ålter in the example ampliÔ¨Åer, one could have concluded that a 5 Œ© load to
the LC-Ô¨Ålter with an inductor of 1 mH and a capacitor of 0.33Œº F results in
a quality factor of:
Q = R

C
L ‚âà0.1.
(6.107)
This is a very low value and if this load was purely resistive in reality, a Ô¨Ålter
with an inductor of 0.1 mH and a capacitor of 3.3 ŒºF would have been more
appropriate. The load is however an electromagnetic actuator with a series
inductance of 8 mH. This gives an electrical time constant of œÑe = 1.6 ms and
as a result the actual impedance rises above ‚âà100 Hz with a slope of +1 to
become approximately 430 Œ© around the corner-frequency of 8.6 kHz of the
LC-Ô¨Ålter. With that almost purely inductive value the LC-Ô¨Ålter would have
almost no damping anymore and noise on the input of the ampliÔ¨Åer would
be strongly ampliÔ¨Åed at that frequency.
To correct this side-eÔ¨Äect of the complex load impedance, an additional
RC-network needs to be added that determines the load impedance above
approximately 1 kHz with a resistive value of 47 Œ©, giving a Q-factor of
M2
M1
Vsup
+
Vsup
-
Load
1 mH
8 mH
 1
F
F
0.33
Filter
	
	
Figure 6.76: An inductive load requires an additional RC network to correct the
damping of the LC-Ô¨Ålter in a switched-mode ampliÔ¨Åer.

6.3. Power AmpliÔ¨Åers for Motion Control
581
almost one. In principle this resistor will dissipate power at higher frequen-
cies, so it should not be chosen with a too low value. For that reason the
inductor and capacitor values of the LC-Ô¨Ålter were not chosen optimal for a
resistor of 5 Œ© but for this higher resistive value.
With a piezoelectric actuator this problem is quite diÔ¨Äerent, as this kind of
actuator gives a capacitive load, connected parallel to the capacitor of the
LC-Ô¨Ålter. This does not introduce additional stability problems but it also
does not reduce the Q-factor. In that case, next to a parallel RC-network
for damping, it might even be necessary to introduce a series inductor to
the piezoelectric actuator in order to avoid high-frequency currents in the
actuator.
From these short considerations it is clear that also the output Ô¨Ålter section
of a switched-mode ampliÔ¨Åer is subject to dynamic optimisation in respect
to the application.
6.3.3
Resonant-Mode Power AmpliÔ¨Åers
The most important limitation of any component in a mechatronic system
is determined by its dynamic properties. The power MOSFETs provide
no exception to that rule. In this section a method will be presented, the
resonant-mode output stage, which optimises the performance of a switched-
mode output stage for these dynamic limitations by using the resonance of
the inductor of the LC-Ô¨Ålter with an additional capacitor.
Hard-Switching
A major problem of the switched-mode power conversion as described above
is the hard-switching transients that occur over the MOSFETs. At the
moment that a MOSFET is switched oÔ¨Ä, the bridge-voltage changes very fast,
forced by the current in the inductor, which needs a voltage step to change.
This voltage-transient causes a current through the parasitic capacitor
between the Drain and the Gate of the switching MOSFET, which keeps
the MOSFET conducting for a short time, resulting in a less steep voltage-
transient. During this short moment, where the bridge-voltage is not equal
to one of the supply voltages, the current through the MOSFET will cause
power dissipation.
A second hard-switching eÔ¨Äect is related to the conducting diode in step
two and four, when the current Ô¨Çows in the opposite direction through the
MOSFET. Even when the MOSFET is switched on, some current will still

582
Chapter 6. Analogue Electronics in Mechatronic Systems
run through the diode. A semiconductor diode needs time to build up a new
depletion layer to become non-conducting when the current reverses. This
reverse-recovery time of the integrated diode in a MOSFET switching power
transistor amounts up to approximately 100 ‚Äì 500 ns. During this time a
real short-circuit occurs, when the opposing power MOSFET is switched on.
This problem can be alleviated by paying attention to three aspects:
1. Reduction of the current through the intrinsic diodes of the MOSFET.
This can be achieved by adding very fast diodes with a low threshold
voltage parallel to the power MOSFETs. For moderate power levels
the Schottky diodes can serve that purpose. They are diÔ¨Äerent from
normal silicon diodes as they are based on a combination of a metal and
N-doted silicon, to achieve a diode functionality. Unfortunately these
diodes have a rather high leakage current in the reverse direction and
the reverse voltage is limited to below 100 V. For that reason the use of
Schottky diodes is limited to low voltage ampliÔ¨Åers. Fortunately also
other special switching diodes have been developed for this purpose
based on regular N- and P-material.
2. The MOSFETs should switch on with a little delay.
Preferably the MOSFET is switched on, when its intrinsic diode is
conducting, at least after the moment that the diode over the other
MOSFET switch has stopped conducting.
3. The steepness of the transient slope of the bridge-voltage has to be
reduced.
The second condition was already fulÔ¨Ålled in the 50 % duty-cycle situation
of Figure 6.72 but as soon as the duty-cycle is changed to a value, where the
current in the inductor becomes unidirectional, this condition is not fulÔ¨Ålled
anymore.
The entire problem can be solved by tackling all items simultaneously and
this is accomplished with a resonant version of a power output stage as
shown in Figure 6.77. In this conÔ¨Åguration three measures are taken. First
the transient slope of the voltage is controlled by two additional capacitors,
secondly the MOSFET is always switched on at zero current and thirdly
fast parallel diodes are added to transfer the current in the reactive phase.
6.3.3.1
Switching Sequence of the Output Stage
In Figure 6.78 the basic principle of the control of the resonant-mode output
stage is shown for a single-ended output stage with two supply voltages.

6.3. Power AmpliÔ¨Åers for Motion Control
583
Gate-driver 2
Gate-driver 1
Bridge
M2
M1
C
L
V
Vsup
+
Vsup
-
o
I
I
I
L
C
o
C
Cr1
r2
+
-
Figure 6.77: A resonant switching ampliÔ¨Åer uses two additional capacitors Cr1 and
Cr2 parallel to M1 and M2, which reduce the transient speed in
a non-dissipative way to a suÔ¨Éciently low level that the dissi-
pation in the MOSFETs caused by their Drain-Gate capacitors
is largely avoided. The additional parallel diodes are faster
and have a slightly lower threshold voltage than the intrinsic
diodes of the MOSFETs.
(Courtesy of ASML)
This controller is essentially a current-feedback system, because the prob-
lem originates in the current. As a direct consequence of this controller, the
ampliÔ¨Åer becomes a current-drive ampliÔ¨Åer, the preferred conÔ¨Åguration for
many mechatronic positioning systems.
The controller continuously monitors the current IL through the inductor
and switches the MOSFETs when IL has reached certain predetermined
reference levels. These levels are always positive for the MOSFET that
switches the positive voltage and negative for the MOSFET that switches
the negative voltage. In case of a positive output current, the positive ref-
erence level is increased and with a negative output current, the negative
reference level is increased. The MOSFETs are switched on again as soon
as their current is reversed at the moment of zero current.
The switching behaviour with this controller is shown in Figure 6.79. In this
Ô¨Ågure some simpliÔ¨Åcations are applied. First the two capacitors from the
bridge point to the power supplies are replaced by one capacitor to ground.
This is allowed as power supplies have a voltage source characteristic with
an equivalent impedance to ground of 0 Œ©. The second simpliÔ¨Åcation is the
replacement of the capacitor of the output Ô¨Ålter by a voltage source. This is
allowed as the voltage over the capacitor will change only very little within

584
Chapter 6. Analogue Electronics in Mechatronic Systems
 
+
-
-
+
-
+
IL
Iset
IL
Io
Iset
I
Io
Ilim
-
Ilim
+
Ilim
-
Ilim
+
t
Current Controller
Figure 6.78: The controller of a resonant power output stage measures the cur-
rent through the inductor. When this current has reached a certain
limit, deÔ¨Åned by the output current plus an oÔ¨Äset, the MOSFETs are
switched oÔ¨Ä. When the current is zero, the MOSFETs are switched
on. This results in a controlled output current.
(Courtesy of ASML)
one switching cycle of the high-frequent current, as was demonstrated with
the normal switching output stage in Figure 6.72.
The main diÔ¨Äerence with the switching cycle of Figure 6.72 is the moment
when the MOSFETs are switched oÔ¨Ä. This is determined uniquely by a
positive current level for M1 and a negative current level for M2. After the
MOSFETs are switched oÔ¨Ä, the voltage Vb of the bridge will not change ex-
tremely fast, because of the additional capacitor Cr. The slope is determined
by the current level and the capacitor value. During this slope the energy
in the inductor Ô¨Çows partly into the capacitor and the total behaviour is
determined by the capacitor and the inductor only.
In fact it is this short moment in the natural resonating mode of the LC-
combination that gave the name of ‚Äúresonant-mode‚Äù to this conÔ¨Åguration.
The second diÔ¨Äerence is that the MOSFETs will only be switched on, when
the current reverses in the branch, consisting of the MOSFET and his par-
allel diode. That switching moment eÔ¨Äectively cancels all dynamic issues in
either the diodes and the parasitic capacitors. In principle this alleviates
the need for the additional parallel diodes but imperfections in timing will
always remain so they are retained for additional robustness of the design.
One additional interesting observation can be done with this current-controlled

6.3. Power AmpliÔ¨Åers for Motion Control
585
M2
M1
C
V
Vsup
+
Vsup
-
o
M2
M1
C
L
Vsup
+
Vsup
-
M2
M1
C
L
Vsup
+
Vsup
-
M2
M1
C
Vsup
+
Vsup
-
Step 1: M1 switched on,      

L
+
-
r
r
r
r
Vo
+
-
Vo
+
-
Vo
+
-
L
IL
IL
IL
IL
Vb
+
-
Bridge
M2
M1
C
V
Vsup
+
Vsup
-
o
M2
M1
C
L
Vsup
+
Vsup
-
+
-
r
r
Vo
+
-
L
IL
IL
Bridge
IL
Vb
lim
I

lim
I
	
sup
V

sup
V
	
IL
Vb
lim
I

lim
I
	
sup
V

sup
V
	
IL
Vb
lim
I

lim
I
	
sup
V

sup
V
	
IL
Vb
lim
I

lim
I
	
sup
V

sup
V
	
IL
Vb
lim
I

lim
I
	
sup
V

sup
V
	
IL
Vb
lim
I

lim
I
	
sup
V

sup
V
	
IL 
Step 2: M1 `¬â
¬õ$
IL
Step 3: M1`¬â
¬õ$¬ç
IL
Step 4: M2 switched on, 
$
IL
Step 5: M2`¬â
¬õ$
Step 6: M2`¬â
¬õ$¬ç
IL
IL
   
Figure 6.79: In a resonant switching power stage after switching one MOSFET oÔ¨Ä,
the current is taken over by the capacitor and without any dissipation
the bridge-voltage changes in a controlled way. The MOSFETS are
switched on as soon as the current reverses.

586
Chapter 6. Analogue Electronics in Mechatronic Systems
IP
IS
IC
IP
IS
+
_
IC
H
0
V 
+
_
IC
H
H
V
C B

+
_
B
H
V
Figure 6.80: A Hall sensor and a current sensing module, which measures the
current indirectly by measuring its related magnetic Ô¨Åeld with a Hall
sensor. (Courtesy of LEM)
power stage. Like with a normal switching output stage the duty-cycle of
the switching needs to relate to the output voltage. This is true, because
the output voltage of the LC-Ô¨Ålter equals the average of the high-frequency
signal before the Ô¨Ålter and this average is determined by the duty-cycle.
As a consequence of the current-drive behaviour of this output stage, the
duty-cycle becomes a function of the load. In Figure 6.79 the duty-cycle
is 50 % and with a short-circuited output of 0 V, this duty-cycle remains
unchanged, even when the average current is not zero. The situation with a
resistive load was shown in Figure 6.78. In that case both the duty-cycle
and the frequency change.
The detailed description of all properties and signals in such an ampliÔ¨Åer
would go far beyond the goal of this book, unfortunately, but it is interesting
to see how the current sensing can be done in such an ampliÔ¨Åer.
6.3.3.2
Lossless Current Sensing
In very high power positioning systems, where these resonant power ampli-
Ô¨Åers are applied, the voltage levels are very high up to almost 1000 V, with
current levels of several tens of amp√®res. The simple inclusion of a series
resistor to measure the current, would become a bit of a hazard. Further-
more, the three-phase conÔ¨Åguration, which will be presented in the next
section, requires the current to be measured at the high voltage output of
the ampliÔ¨Åer. For this reason a lossless current sensor is used based on
magnetism and active feedback control.

6.3. Power AmpliÔ¨Åers for Motion Control
587
The working principle of this current sensor is shown in Figure 6.80. It
consists of a ferromagnetic ring with a small air-gap placed around the
wire of which the current has to be measured. A Hall sensor measures the
magnetic Ô¨Åeld in the air-gap generated by the current Ip in the wire.
The Hall sensor is named after the American physicist Edwin Robert Hall
(1855 ‚Äì 1938), who discovered the Hall eÔ¨Äect, which determines the working
of this sensor. A current Ic running through a conductive plate would nor-
mally run straight from one terminal to the other. The Hall eÔ¨Äect is related
to the inÔ¨Çuence of a magnetic Ô¨Åeld orthogonal to the surface of the plate
as the Lorentz force on the current drives the electrons to one side of the
plate. This results in an electromotive force, which is measured as a voltage
between two terminals, perpendicular to the current terminals.
The voltage of a Hall sensor is approximately proportional to the magnetic
Ô¨Çux density B.
A compensation circuit is applied consisting of an auxiliary winding on the
ring and an ampliÔ¨Åer with a push-pull output stage, because of the non-
linear behaviour of the Hall sensor. The current Is through the auxiliary
winding is controlled in such a way, that the magnetic Ô¨Åeld measured by the
sensor remains zero. Is will be proportional to Ip, because of the magnetic
coupling of the auxiliary winding and the current conducting wire by the
ferromagnetic ring.
6.3.4
Three-Phase AmpliÔ¨Åers
The need for ever higher accelerations and velocities of advanced mecha-
tronic equipment has resulted in linear motors based on the Lorentz princi-
ple with three-phase electronic commutation having a large range of motion.
An example of such an actuator was presented in Section 5.2.5 of Chapter 5
on electronic commutation.
Generally, actuators in mechatronic positioning systems need to deliver
a force that is only determined by the position controller and not by the
position. It was demonstrated that a position independent force can be
realised, when the three coil segments of a three-phase actuator are driven
by an ampliÔ¨Åer with three current outputs of which the magnitude of the
current at a certain force set point changes sinusoidal as function of the
position, in phase with the B‚Ñìforce factor of the related coil segment.

588
Chapter 6. Analogue Electronics in Mechatronic Systems
6.3.4.1
Concept of Three-Phase AmpliÔ¨Åer
The basic scheme of the second ampliÔ¨Åer example of this chapter, which
was designed for driving a 3 phase motor with 5 kW power, is shown in
Figure 6.81. The digital controller provides a force setpoint via a serial
data link to the ampliÔ¨Åer, while status information is transferred back to
the controller for diagnostic purposes. The force setpoint consists of the
magnitude and the position of the actuator as this is necessary to guarantee
that the currents are in phase with the actual B‚Ñìforce value of each actuator
coil segment.
With this information a mathematical phase transformation is executed that
creates two 120¬∞shifted set point signals R and S with a sinusoidal relation
to the position. The third setpoint signal can be determined by subtracting
R and S from one, because R+S+T=0. The three setpoint values are used as
inputs for a current ampliÔ¨Åer where, after digital to analogue conversion,
each phase of the actuator is driven by a single-ended current-controlled
power stage with a single power supply.
It should be noted that the sum of all output currents from these ampliÔ¨Åers
has to be equal to zero as otherwise the three current sources will work
Three phase
%
current R
set point R 
set point S 
switching control 
serial link 
(data & control)
6
controller 
front 
panel 
info
5 kW
actuator
current S
current T
700 V supply 
24 V supply 
enable / reset / error 
 
magnitude 
Phase 
transformaon 
-
-
Figure 6.81: Functional diagram of a three-phase power ampliÔ¨Åer. The information
from the position controller is transferred with a digital link to the
phase transformation unit that translates the information in a two
phase (R,S) set point for the ampliÔ¨Åers. The third phase (T) is derived
by subtracting the R and S from one. Switching current ampliÔ¨Åers
deliver the current to the high power actuator.
(Courtesy of ASML)

6.3. Power AmpliÔ¨Åers for Motion Control
589
against each other. This would result in an unbalanced system where the
average voltage is not equal to zero, while eventually the output of one
or all of the ampliÔ¨Åers will clip to any of the supply voltages. Only with
ideal ampliÔ¨Åers this requirement is fulÔ¨Ålled when the setpoint values add
to zero but in reality this is never the case. This problem can be solved by a
separate voltage control loop that modiÔ¨Åes the setpoint value of one of the
ampliÔ¨Åers in such a way that the average voltage of the three outputs equals
zero. This means that the corresponding ampliÔ¨Åer is controlled as an overall
voltage source ampliÔ¨Åer with a voltage setpoint of zero volt, while the voltage
measurement in this control loop equals the average voltage of the three
outputs. As a result, the output voltage of this ‚Äúaverage voltage controlled‚Äù
ampliÔ¨Åer will be equal to the inverse sum (-Œ£) of the output voltages of the
other two ampliÔ¨Åers while all currents are determined only by the other
two ampliÔ¨Åers. As an equivalent alternative, the voltage setpoint of the
ampliÔ¨Åer, that needs to control the average voltage, can also be made equal
to the inverse sum of the output voltages of the other two ampliÔ¨Åers. In this
case only its own output voltage should be measured in the voltage control
loop.
6.3.4.2
Three-Phase Switching Power Stages
Figure 6.82 shows how the three-phase actuator is connected to the three
high-power resonant-mode switching output stages. In this conÔ¨Åguration
the three phases of the actuator coils are connected in a star conÔ¨Åguration,
with one central connecting point and the other terminals of the coil sections
are connected to their corresponding phase terminal of the ampliÔ¨Åer. This
ampliÔ¨Åer becomes a special version of the dual-ended ampliÔ¨Åer from Sec-
tion 6.3.2.8, because of the application of only one power supply. The central
point will have a voltage of an almost constant level, equal to approximately
half the supply voltage. This voltage is constant as all currents at this node
add to zero and the Ô¨Årst of KirchhoÔ¨Ä‚Äôs laws is fulÔ¨Ålled.
Charge-Pumping with Three-Phase AmpliÔ¨Åers
One additional advantage of using three-phase ampliÔ¨Åers is that the same
rule of R+S+T=0 means that at any moment in time a positive low-frequency
current in one phase is compensated by the currents in the other phases.
This means also that the charge-pumping from one phase is compensated
by the charge-pumping of the other phases and as a result the net value of
charge-pumping is zero.

590
Chapter 6. Analogue Electronics in Mechatronic Systems
L
L
L
	
	
	
M2
M1
Vsup
+
Vsup
+
M6
M5
M4
M3
Vsup
+
Actuator
Phase R
Phase S
Phase T
z,
z{8
z{6
z{4
z{2
{
{2
{4
{6
{8
1
R
S
T
6
]
Figure 6.82: A three-phase actuator only needs three single-ended output stages.
charge-pumping is avoided because all currents Ô¨Çow between the
positive and negative power supplies, just like with the dual-ended
conÔ¨Åguration.
6.3.5
Some Last Remarks on Power Electronics
The presented overview of power ampliÔ¨Åers is only so far complete that it
covers the most important dynamic eÔ¨Äects of the main design conÔ¨Ågura-
tions in combination with their application. It has been made clear that
the transfer function of the ampliÔ¨Åer can not be neglected when designing
high-performance mechatronic systems. AmpliÔ¨Åers all have some internal
feedback loop that has to be tuned similar to the feedback loop of a mecha-
tronic positioning system. The same stability problems arise and need to be
addressed.
For moderate power delivery and situations where a high eÔ¨Éciency is not
important, linear ampliÔ¨Åers are still preferred, because they avoid the po-
tential interference by the high switching frequency. For high power and
situations where four-quadrant operation is necessary, a switched-mode
ampliÔ¨Åer is in fact the only solution. Although not speciÔ¨Åcally mentioned

6.3. Power AmpliÔ¨Åers for Motion Control
591
anymore, a switched-mode ampliÔ¨Åer has no problems with four-quadrant
usage, as the power dissipation, due to the diÔ¨Äerence between the output
voltage and the supply voltages, is avoided by the switching process and
reactive components. Nevertheless the kinetic energy of a decelerating fast
moving actuator needs to be absorbed somewhere. When that energy is not
converted into heat by dissipation in the ampliÔ¨Åer, this has to be done in
the power supply. The only way to achieve true high eÔ¨Écient four-quadrant
power delivery to an actuator is by a combination of a four-quadrant power
supply and a switched-mode power ampliÔ¨Åer.
Switched-mode power conversion is one of the factors in the high eÔ¨Éciency of
hybrid cars, where rotary actuators are driven by four-quadrant ampliÔ¨Åers
and the batteries serve as four-quadrant power supplies to recuperate the
kinetic energy from the braking actions. A modern hybrid car is indeed
a real full mechatronic positioning system, although the precision is not
extreme.

blank
left
intentionally
page
This

Chapter 7
Optics in Mechatronic
Systems
Robert Munnig Schmidt
Introduction
From the moment that mechatronics became a real precision engineering
discipline, the application of optics was indispensable for achieving its ul-
timate performance. When controlling positioning accuracies in the order
of a micrometre or less, reliable measuring tools are a prerequisite and
only optical sensors can give the required combination of resolution, range
and accuracy. But this is not the only relevant Ô¨Åeld of optics in respect of
mechatronics. Modern imaging systems like telescopes, wafer lithography
exposure systems and modern photographic equipment all need advanced
mechatronic systems to control the imaging properties in both static and
dynamic circumstances. This means that optics represent both a supporting
technology and an application area for mechatronics.
Within its limited boundary conditions, this chapter will mainly focus on
the understanding of several important terms and properties, related with
the use of optics in mechatronic systems. It should help to enable the
mechatronic designer to integrate optical systems in their designs in close
cooperation with optical specialists. Where deemed necessary, based on our
experience, the material is treated more in depth.
The chapter starts in Section 7.1 with the general properties of light and
593

594
Chapter 7. Optics in Mechatronic Systems
light sources. It will introduce the diÔ¨Äerent properties of light sources like
wavelength, coherence and radiance.
Section 7.2 introduces the physical model for reÔ¨Çection and refraction ac-
cording to ‚ÄúFermat‚Äôs principle‚Äù.
Section 7.3 deals with geometric optics. This is a practical method used to
calculate the imaging properties of an optical system, where the light is
approximated by ideal rays (ray tracing) and only the properties of materials
on reÔ¨Çection and refraction are taken under consideration. This method is
useful for a mechatronic engineer when designing simple optical systems,
which might for instance be used in laboratory test setups, made from ‚ÄúoÔ¨Ä
the shelf‚Äù components.
For precision mechatronics the physical optics from Section 7.4 are the most
important. Physical optics deals with the eÔ¨Äects that are based on the wave
character of light, including interference and diÔ¨Äraction. These eÔ¨Äects limit
the ultimate imaging properties of an optical system and are also used for
position measurement with interferometers and encoders, as presented in
the next chapter.
Section 7.5 gives a short introduction on adaptive optics, where active con-
trol is used to correct imaging errors, enabling near-to-perfect imaging
properties of for instance terrestrial telescopes.
Figure 7.1: Light and optics have always been fascinating.

7.1. Properties of Light and Light Sources
595
7.1
Properties of Light and Light Sources
In physics the properties of light are described in two ways, as electromag-
netic waves and as particles. The still mostly applied theory states that
light acts like an electromagnetic wave, as was presented in Chapter 2. This
theory explains the occurrence of interference and most of the observations
that can be done with light.
The more recent theory on quantum optics is based on observations with
extremely low energy levels of the light. The invention of the photomultiplier,
working with a very high voltage, made it possible to detect light at these
very low energy levels, by creating an avalanche of electrons as soon as one
electron is excited by the light. It appeared that below a certain energy
level, light starts to behave like separate particles called photons, each with
a Ô¨Åxed energy that appeared to be equal to:
E = hfp = hc
Œª = hcŒΩ
[J].
(7.1)
with:
h = Planck‚Äôs constant, exactly

6.626 070 15¬∑10‚àí34
[Js],
c = The speed of light, exactly (299 792 458)
[m/s],
fp = The temporal frequency of the photon
[Hz],
Œª = The wavelength of the photon
[m],
ŒΩ = The spatial frequency or wavenumber

m‚àí1
.
When Ô¨Ålling in some real numbers, the extremely low number of roughly
E = 3.5 ¬∑ 10‚àí19 J is obtained for 1 photon of visible light (Œª ‚âà600 nm). A
low level of one ŒºW (ŒºJ/s) of visible light power would hence be equal to
about 3¬∑1012 photons per second. This still immensely high number implies
that it is not always necessary to take this quantum character into account.
Nevertheless, with very sensitive measurements, the noise level is limited
by the photon character and it partly explains why a larger image sensor in
a photographic camera shows a better noise performance.
At several occasions it will appear to be practical to use the photons and
electrons for the explanation of the physical phenomena that are related
with light.

596
Chapter 7. Optics in Mechatronic Systems
7.1.1
Light Generation by Thermal Radiation
Many sources of light exist, ranging from thermal radiation by heated bodies
to secondary emission of photons by electrons changing momentum or state
within an atom. Thermal radiation is often related to the visible light spec-
trum and is caused by the increasingly fast vibrations of charged particles
inside atoms at increasing temperature. These vibrations of charge create
electromagnetic waves, following the Maxwell equations. The induced light
consists of a wide range of wavelength values, because of this thermal na-
ture of origin. The peak in the intensity occurs at a wavelength determined
by the absolute temperature in ‚ó¶K according to ‚ÄúWien‚Äôs displacement law‚Äù,
named after the German Physicist Wilhelm Carl Werner Otto Fritz Franz
Wien (1864 ‚Äì 1928). He stated that the shape of the wavelength distribution
of a black body, deÔ¨Åned as having a surface with a frequency independent
emissivity, is independent of the temperature, while the maximum emission
occurs at a wavelength equal to:
Œª = b
T
[m].
(7.2)
0
1000
2000
3000
Wavelength (nm)
¬ô'
12,000 K
5,500 K
2,000 K
500
600
4000
Visible light
400
700
Figure 7.2: Thermal radiation spectra of a black body at diÔ¨Äerent temperatures.
The visible light spectrum shows to cover only a small area of the wide
spectrum of this kind of light source, explaining the low eÔ¨Éciency of
incandescent lamps.

7.1. Properties of Light and Light Sources
597
With b being the Wien‚Äôs displacement constant of ‚âà2.9¬∑10‚àí3 [mK]. With this
relation a pure black body starts radiating visible red light at a temperature
of about 2000 K. This corresponds to a peak radiation in the wavelength area
of about 1500 nm, so most of the light is still in the invisible infra red region.
At higher temperatures the peak emission will move to shorter wavelengths,
while a black body temperature of 5500K has its peak emission around
530 nm, which equals the mid of the visible spectrum, like the daylight
as emitted by the sun. A higher temperature will shift the peak to even
shorter wavelengths into the invisible ultraviolet region. Figure 7.2 shows
the spectra of these three examples.
7.1.2
Photons by Electron Energy State Variation
The aforementioned spectra from a thermal radiator show an inherently
very wide range of frequencies. Often this is not preferable for technical
applications, because many properties of optical elements are wavelength
dependent. This leads for instance to the separation of sunlight into diÔ¨Äer-
ent colours in the raindrops of a rainbow that is caused by the wavelength
dependent refractive index of water. For that reason monochromatic light
sources are often preferred. Fortunately several alternative light sources
exist, mostly based on the emittance of photons by electrons as these change
their energy state in a well deÔ¨Åned way. Electrons in an atom can possess
diÔ¨Äerent energy levels, also called excitation states. Normally these elec-
trons are in the ‚Äúground state‚Äù, the lowest energy level. When excited by
some external energy source, they move to diÔ¨Äerent higher energy excitation
states, depending on the energy that caused the excitation. These higher
excitation states are generally not stable and the electron will ultimately
fall back to a lower and more stable state or to the ground state, by emitting
a photon of which the frequency is determined by the diÔ¨Äerence in energy
levels of the electron states.
Electrons can be excited by temperature like in plasma gas discharge lamps,
by fast moving other electrons like in Ô¨Çuorescent tubes or by means of other
photons like in a laser. The gas in a plasma gas discharge lamp, like used in
the modern Xenon headlights of a car, is ionised by a very high voltage. As
a result of this ionisation, part of the electrons will be able to move freely,
thereby making the gas conductive and a current will Ô¨Çow. The correspond-
ing electric power will heat the gas and it becomes a plasma with many
free electrons, giving a relatively low resistance path for a high current
to run at a voltage of ‚âà100 V, signiÔ¨Åcantly below the value of ‚âà1000 V
that is necessary to start the process. These plasma gas discharge lamps

598
Chapter 7. Optics in Mechatronic Systems
Figure 7.3: The light power spectrum of a mercury arc gas discharge lamp shows
peaks corresponding to diÔ¨Äerent energy states of the electrons around
the mercury atoms in the plasma.
radiate light at very speciÔ¨Åc wavelengths, determined by the gas atoms
inside the plasma. An industrial mercury gas discharge lamp radiates with
a spectrum as shown in Figure 7.3 with diÔ¨Äerent narrow peaks of which
the peak at 365 nm (I-line), at 405 nm (H-line) and at 436 nm (G-line) were
used in the illumination of the early versions of wafer steppers.
The well-known Ô¨Çuorescent tube is also a Mercury type gas discharge lamp
that works a bit diÔ¨Äerently. It does not work with a real plasma but the
electrons are emitted by heated electrodes at the start and move to the
other electrode through vacuum that is slightly doted with mercury atoms
of which the outer electrons will be excited by the moving electrons. The
230 V AC voltage of the mains is not suÔ¨Éciently high to start the lamp. For
this reason a coil with a large self-inductance is used to both create the high
starting voltage by interrupting the current through the coil by a ‚Äústarter‚Äù
switch and to heat the two electrodes by this starting current, in order to
emit the Ô¨Årst electrons that have to start the process. The peaks at 546 and
579 nm in the visible light region of Mercury are not suÔ¨Écient to give an
acceptable light spectrum for domestic use and most of the light is emitted
in the invisible ultraviolet frequency range. For this reason a Ô¨Çuorescent
tube is coated at the inside with special Ô¨Çuorescent powder that converts the

7.1. Properties of Light and Light Sources
599
UV light into a wider spectrum in the visible light range, increasing both
the eÔ¨Éciency and improving the colour. Although widely used in general
lighting in buildings, these Ô¨Çuorescent tubes are of limited importance as
light sources for precision mechatronic purposes due to their low radiance,
a term that will be deÔ¨Åned later and is related to the large surface that
radiates the light with these lamps.
7.1.2.1
Light Emitting Diodes
Much more interesting for the mechatronic engineering Ô¨Åeld is the laser,
which is the subject of the next section, but also the Light Emitting Diode
(LED) is shown to be of increasing importance. LEDs are already used
for many years as indicator in electronic equipment and only in the last
few years they became known for illumination purposes. The principle of
working of an LED is also based on electrons that change their excitation
state, but now not within a gas but in a solid material. For that reason LEDs
are also called solid-state lamps. An LED is a special kind of semiconductor
diode, of which the working principle was presented in Chapter 6. P and
N material are combined causing either a barrier or a conductive path for
the electric current, depending on the direction of the voltage. In case of
conduction, the electrons recombine with the holes at the transition zone
from n to p material. This recombination implies the Ô¨Ålling of an empty
place around an atom, which corresponds to a change of the energy level.
This would result in emission of a photon, were it not that Si or Ge are
indirect band-gap materials, showing no radiation at recombination. This
means that a normal diode will not emit light nor require the power that
corresponds to that light emission. While this is not a problem for ‚Äúnormal‚Äù
semiconductor diodes it does not create light. Fortunately other materi-
als, composed from materials of adjacent valence bands (III and V) of the
periodic system like Ga,As,In,P and N, have a direct band-gap and they
do result in diodes that emit photons with a wavelength depending on the
material, at the cost of additional electric energy. For instance GaAs gives
infra red light, AlGaAs gives red light and GaAsP gives yellow light.
It has long been quite diÔ¨Écult to create shorter wavelengths, because that
requires a wider band gap and not all material combinations are easily
to manufacture. Eventually GaN appeared to be the right combination to
create blue light. The single colour of an LED and its rather low power of
initially only a few mW has long prevented the application in high power
illumination systems, like domestic lighting. The breakthrough in creating
blue LEDs made it possible to either combine red green and blue LEDs to

600
Chapter 7. Optics in Mechatronic Systems
create white light or use a phosphorescent material, to convert the short
wavelength of the blue light to longer wavelengths. Much research has been
spent on improving the eÔ¨Éciency and power output of both the LEDs them-
selves and on the phosphorescence, resulting in the recently introduced LED
lamps for illumination purposes. The main advantage of a LED as a light
source in engineering applications is its almost monochromatic spectrum
and its relatively small source dimensions. This will prove to be impor-
tant for high resolution imaging as will be shown later when presenting
the term radiance. LEDs are used for instance in the incremental optical
measurement systems (encoders), which will be presented in Chapter 8.
7.1.2.2
Laser as an Ideal Light Source
The ultimate light source is the laser, which was invented in 1960 by the
American physicist Theodore Harold Maiman (1927 ‚Äì 2007) [64]. The name
Laser is an acronym for Light AmpliÔ¨Åcation by Stimulated Emission of
Radiation and its functionality is based on the phenomenon that an electron
at its excited state can be stimulated to drop to its lower state by a photon.
This photon needs to have the same frequency as the frequency of the photon
-
Electron 
Photon 
E0
E1
E2
-
Photon
Photon
Figure 7.4: Light AmpliÔ¨Åcation by Stimulated Emission of Radiation (LASER). An
external source of energy excites the electrons to a higher unstable
state E2, where they Ô¨Årst drop to a more stable state E1 until a photon
with a suitable wavelength passes and triggers the electron to fall back
to its original ground state E0, under emission of a photon with the
same wavelength as that of the trigger photon.

7.1. Properties of Light and Light Sources
601
Opcal power (lin)
Frequency
FWHM
Figure 7.5: DeÔ¨Ånition of the full width at half maximum power gain bandwidth of
a laser light source. The smaller the bandwidth is, the better is the
temporal coherence of the laser.
that the electron would emit by its change of energy state. In other words,
one photon will create another identical photon by ‚Äútriggering‚Äù an excited
electron to drop to a lower energy state. Like shown in Figure 7.4 one photon
could stimulate two or more electrons resulting in three or more photons
with the same frequency and phase!. This phase relationship is called
coherence. This physical process would of course come to an end, when all
electrons have reached their lower state E0. The process of emitting photons,
when lowering the energy level of an electron, is fortunately reversible. This
means that another light source, not necessarily coherent, like a normal
gas discharge lamp, can be applied to excite the electrons to an energy level
E2 above the excitation state E1 needed for the stimulated emission. This
higher energy level E2 is even less stable than E1, so the electrons will drop
to E1, while sending a photon of a frequency that is not used in the lasing
and can be neglected in the considerations. The additional external light
source for exciting the electrons is called an ‚ÄúOptical Pump‚Äù.
It can be concluded that the complete system ampliÔ¨Åes the incoming photons
with a gain that depends on the frequency of the photons. This frequency
is not inÔ¨Ånitely sharply Ô¨Åxed, but has some tolerance due to uncertainty
considerations on the energy levels of the electrons of which the deep treatise
exceeds the scope of this book.
To accommodate this eÔ¨Äect, the term ‚Äúgain bandwidth‚Äù is used, which is
quite diÔ¨Äerent from the gain-bandwidth product that was deÔ¨Åned for an
operational ampliÔ¨Åer. Optics designers often use the term Full-Width at
Half-Maximum (FWHM), the width of the frequency band that covers half
the optical output power, as shown in Figure 7.5. This corresponds to
the well-known -3 dB point on a logarithmic scale of electronic engineers.

602
Chapter 7. Optics in Mechatronic Systems
The gain bandwidth tells something about the capability of the laser to
amplify photons of a speciÔ¨Åc frequency within the bandwidth range and it
automatically determines the bandwidth of the emitted light spectrum from
a laser. Other words in literature for this quality are ‚Äúline width‚Äù of a single
frequency laser and ‚Äúoptical bandwidth‚Äù.
Bandwidth and Coherence
The bandwidth of a laser is one of its determining factors in the suitability
as a light source for technical applications. For imaging purposes a high
bandwidth can result in chromatic aberrations due to the frequency depen-
dent properties of many lens materials. On the other hand a very small
bandwidth can give problems due to the occurrence of scattered speckle,
caused by interference. This phenomenon is known from the light of a laser
pointer, which shows tiny spots over the illuminated area that change as a
function of displacement and angle of the incident light. These spots could
impair the image of an object that is illuminated by a laser.
An other important property of a laser, related to this bandwidth and the
occurrence of speckle, is the coherence. Two kinds of coherence exist namely
spatial coherence and temporal coherence. The spatial coherence relates to
the correlation between the electromagnetic Ô¨Åeld inside the laser beam at a
certain moment in time as function of the location in the beam. It is
a measure for the perfection of the shape of the emitted wavefront, a term
that is explained later. The spatial coherence determines the divergence
of the laser beam and hence the capability to keep a Ô¨Åxed diameter over
a long range. The temporal coherence of a laser relates to the correlation
between the electromagnetic Ô¨Åeld on a certain location inside the laser beam
as function of time. It is related to the bandwidth of the light from a
laser and decreases as a function of the distance from the laser source. The
correlation between the temporal coherence and the bandwidth is illustrated
in Figure 7.6 where 7 graphs are shown of frequencies with a little diÔ¨Äerence
between each frequency. In case all frequencies are in phase at the light
source, which means that all values of the Ô¨Åeld are equally zero at t = 0,
then the coherence disappears at a time t = tc when the light has travelled
some distance from the light source. This time depends on the bandwidth
of the source and the propagation speed. With a wide bandwidth, the time
is very short and with a single frequency source this time is very long. The
time tc that passes until coherence is lost is called the coherence time. This
coherence time directly relates to the more well-known and for technical
applications more useful term coherence length ‚Ñìc, being the coherence time

7.1. Properties of Light and Light Sources
603
Time, distance 
value
Source ( t    0 )
In phase
Out of phase
$
$
$

+
c
c
t
t
=

=
Figure 7.6: Electromagnetic Ô¨Åeld waves as function of time or distance from the
source for light of diÔ¨Äerent wavelengths, starting all in phase at the
source. It shows the loss of phase relationship after a certain propaga-
tion time, the coherence time tc with corresponding coherence length ‚Ñìc.
times the propagation velocity.
Assuming a Gaussian frequency proÔ¨Åle, like shown in Figure 7.5, it is al-
lowed to limit the useful coherence length to the distance from the source
where the phase of the lowest bandwidth frequency with wavelength Œª is œÄ
radians shifted (inverse sign!) relative to the phase of the highest bandwidth
frequency with wavelength Œª+ŒîŒª, where ŒîŒª =FWHM. After n wavelengths
the phase diÔ¨Äerence between both frequencies will equal œï = n2œÄŒîŒª/Œª. The
allowed maximum phase diÔ¨Äerence equals œÄ which means that the maxi-
mum value for n equals nmax = Œª/(2ŒîŒª), resulting in a coherence length of:
‚Ñìc = nmaxŒª = Œª2
2ŒîŒª
[m].
(7.3)
In laser interferometry measurement systems as presented in the next chap-
ter, the required coherence length is often several metres. As an example
to get a feel for the required bandwidth of the light, a coherence length of
ten metres implies that the lowest frequency in the bandwidth will need to
be less than half a period diÔ¨Äerent, just in counter phase with the highest
frequency in the bandwidth over this length of ten metres. One period
of for instance 500 nm relates to 10 m as 5 ¬∑ 10‚àí8, so the bandwidth can
not be more than half of that value, 2.5¬∑10‚àí8 times the average frequency.
This kind of precision is not achieved by the electron-photon physics in the
laser only. Lasers, as used for high precision measurement systems, often
consist of a combination of a laser tube with an optical resonance chamber,
according to the Fabry-Perot principle as will be presented in Section 7.4.2.1.
This resonator consists of two parallel mirrors at a very stable distance,

604
Chapter 7. Optics in Mechatronic Systems
Output
Laser cavity with Helium Neon Gas
+ High Voltage
- High Voltage
High re¬õector
Re¬õector
~1% transmission
Glass envelope
Figure 7.7: Cross section of a Helium Neon Laser. A high voltage creates a plasma
where the electrons of the gas are continuously excited to their higher
energy state. Lasing is induced by photons of only one wavelength,
leading to a maximum emission at 632.8 nm. The two reÔ¨Çectors create
an optical resonator, which further enhances the frequency stability of
the laser.
such that a standing wave occurs between the mirrors. An example of a
laser utilising this principle is the Helium Neon (HeNe) laser as shown
in Figure 7.7, which radiates red light at 632.8 nm. This type of laser is
already for many years used for distance measurement purposes, because
the wavelength can be additionally stabilised by means of Iodine gas that
shows a very narrow-band natural frequency and enables active control of
the distance between the mirrors. It enables the use of this laser as a length
reference for the standard metre. Next to this precision HeNe-laser, a large
amount of diÔ¨Äerent laser types are introduced of which the semiconductor
diode-laser has been instrumental to the optical registration of signals on a
disk like the red laser diode for the CD-player and the blue laser diode for
the Blu-Ray player. These diode-lasers work according to the same principle
as an LED but with additional internal lasing and small mirror facets on the
exit points of the semiconductor material to create a Fabry-Perot resonance
chamber.
7.1.3
Useful Power from a Light Source
Besides the frequency and phase of a light source, also the radiated energy,
the size of the source and the direction of radiation are of importance. These
all inÔ¨Çuence the amount of light that can be captured by an optical system
and transmitted to the area of interest. The illumination power Pi [W] of the
radiated light, sometimes also called the radiant Ô¨Çux [Œ¶], is not suÔ¨Écient to
deÔ¨Åne the usefulness of a light source. First of all it contains all frequencies.
But even when a light source is monochromatic, the pointing direction,
spread and the radiating surface are undeÔ¨Åned. Many terms are introduced
to narrow down these undeÔ¨Åned parameters of a light source in relation to

7.1. Properties of Light and Light Sources
605
the optical system, of which the following are explained here:
‚Ä¢ The radiant emittance and irradiance.
‚Ä¢ The radiance.
‚Ä¢ The optical throughput or etendue.
7.1.3.1
Radiant Emittance and Irradiance
The radiant emittance M from a light source equals the illumination power,
radiated by the source, divided by its radiating surface
W/m2. The radiant
emittance closely relates to the term irradiance, which was deÔ¨Åned in Chap-
ter 2. The irradiance Ir equals the power density of the received, incident
light on a deÔ¨Åned surface
W/m2. Often the term intensity is also used for
this term but the deÔ¨Ånition is not very clear as in optics and radiology the
term intensity is also used for the energy Ô¨Çow per unit of solid angle. For
this reason the term irradiance is preferred in optics.
The irradiance determines all observations in optics as it is the only prop-
erty of the light that can be measured with a sensor or the human eye.
A photo detector with a given surface converts the light power, being the
irradiance times the surface, into an electric current. With a given value
for the radiant emittance of a source, the irradiance, received at a surface
in its neighbourhood, decreases proportional to the squared distance from
the source. Contrary to the terms from the next part, the irradiance can be
increased again by concentrating light on a spot with an optical system.
7.1.3.2
Radiance
The size of a light source relates to its spatial coherence and for that reason
a point source, with an inÔ¨Ånitely small radiating surface, pointing into the
right direction, appears to be the most ideal in respect to the performance of
an optical system. In that respect, a perfect parallel laser beam fulÔ¨Åls that
demand, as it can be modelled as a point source located at inÔ¨Ånity, pointing
in only one direction. The term radiance is used to describe the extent to
which a light source behaves like such an ideal point source. The radiance
is proportional to the radiant emittance and for that reason it is also often
called the brightness of a light source. As will be shown, the radiance also
includes the radiated direction of the light. With a real point source, the
radiance would by deÔ¨Ånition be inÔ¨Ånite.

606
Chapter 7. Optics in Mechatronic Systems
dA
d
 
Normal on dA
Plasma arch
Electrode
Electrode
Glass bulb

Figure 7.8: DeÔ¨Ånition of radiance of a light source into an optical system. As
example a plasma gas discharge lamp is taken, where the plasma arch
is approximated as a light emitting cylinder. (Courtesy of ASML)
In physical terms the radiance L, see Figure 7.8, is deÔ¨Åned with the next
expression for the illumination power, radiated from an inÔ¨Ånitesimal part
of a light source in a certain direction [90]:
dPi = L(x, y,Œ±,Œ≤)dŒ©dAcosœë
[W].
(7.4)
With:
‚Ä¢ A: The radiating surface of the light source.
[m].
‚Ä¢ dŒ©: The solid cone angle as determined by the optical system, which
deÔ¨Ånes the radiating direction of an inÔ¨Ånitesimal radiating surface
element dA.
[sr].
‚Ä¢ dPi: The illumination power, radiated from the inÔ¨Ånitesimal surface
element into its related the solid cone.
[W].
‚Ä¢ L(x, y,Œ±,Œ≤) The radiance of the source at the inÔ¨Ånitesimal surface ele-
ment located at coordinate x, y in the direction Œ±,Œ≤ into its solid cone.
W/m2sr
.
‚Ä¢ œë: The angle between the surface normal and the direction of the
radiating solid cone.
[rad].

7.1. Properties of Light and Light Sources
607
When the radiance is constant over the total surface A and the solid cone
angle is pointing in the direction of the normal on the surface, the expression
of the total illumination power of a light source into a certain direction,
deÔ¨Åned by the solid cone angle Œ©, can be simpliÔ¨Åed into:
Pi,t = LAŒ©
[W].
(7.5)
As previously mentioned, a small surface of the source appears to be better
for the performance of an optical system. This is due to the physical law of
conservation of radiance stating that the radiance, as received by an
optical system, divided by the refractive index squared, can never increase.
At best the radiance remains the same over the optical path of a system1.
The importance of this conservation law of radiance is illustrated with an
example from photography. The amount of energy of the light that is needed
to activate one pixel at a digital camera appears to determine the minimum
radiance level of the light at the source when a certain maximum exposure
time is allowed. To understand this it is Ô¨Årst necessary to be aware that an
image in an optical system acts as a source of light for the next element, in
this case the photo sensitive pixel in the sensor. That means that the total
power of the image spot at that pixel can be calculated with Equation (7.5).
The dimension A is deÔ¨Åned by the imaged object and the solid angle Œ© is
deÔ¨Åned by the aperture of the photographic lens. The illumination power
is determined by the necessary energy to activate the pixel, divided by the
exposure time. These terms together determine the required radiance of
the source:
L ‚â•Pi,t
AŒ©
W/m2sr

.
(7.6)
Another example to underline the eÔ¨Äect of this conservation law is observed,
when imaging a large object like the sun by demagnifying optics like a
burning glass. The image of the sun becomes a very bright spot with an
increased irradiance. On the other hand however, the surface of the image
is much smaller than the surface of the object. corresponding to that demag-
niÔ¨Åcation, the solid angle of the light at the image is proportionally larger
than the solid angle of the incident light rays, as these are almost parallel.
As a result the radiance is not changed. A third example is based on the idea
that the radiance of a light source might be increased by shielding a part of
its surface. That method can be useful in case one needs a smaller radiating
1Normally the refractive index is the same at the source and the image. Only with im-
mersion optics in lithographic exposure systems, the radiance can be increased at the image
because the increased refractive index gives a smaller solid angle at an equal optical power
and minimum spot size (A).

608
Chapter 7. Optics in Mechatronic Systems
surface, but the radiated illumination power will decrease proportionally
and again no gain in radiance is achieved. It can even be proven that con-
centrating the light from all surface elements of a light source onto a small
hole, will not increase the radiance of the resulting spot, even though the
irradiance is high.
7.1.3.3
Etendue
From the previous it can be concluded that the radiance is maximum when
the light is radiated from a very small surface at a very small angle. Unfor-
tunately only an ideal laser is capable of creating such a perfection and in
reality the optical system can only collect a part of the light.
For this reason another quality term is introduced, the optical throughput,
also often named with the French word etendue. The etendue is a measure
for an optical system of its ability to collect as much as possible light from a
source and retain as much as possible of the original radiance.
The full calculation of the etendue requires an integration of the light sent
by all inÔ¨Ånitesimal surface elements of the source and received by all in-
Ô¨Ånitesimal surface elements of the entry-pupil2 of the optical system. In
the practical case of a light source with a small surface, relative to the
entry-pupil of the optical system, where also both surfaces of the radiating
source and the entry-pupil are essentially parallel (œë = 0), the etendue G
can be approximated as:
G = Œ©A

m2sr

.
(7.7)
With Equation (7.5) this results in the following approximating expression
for the illumination power, captured from the source by an optical system:
Pi,c = LG
[W].
(7.8)
With a given amount of necessary illumination power and a given radiance
of the source, this means that the etendue should be maximised. Corre-
sponding to the law of conservation of radiance, this means that the etendue
should be maximum directly at the entry-pupil, as it can not be increased
by optical means after the entry-pupil. This eÔ¨Äect is illustrated with the
last example from above, about shielding a part of the surface of the source.
This would decrease the etendue, resulting in a decrease of the illumination
power.
2As will be explained later, the entry-pupil is the cross section of an optical system that
deÔ¨Ånes which incident light rays are captured.

7.2. ReÔ¨Çection and Refraction
609
7.2
ReÔ¨Çection and Refraction
To introduce the subject of this section it is necessary to remain aware once
more that physical theory is based on observations that have to Ô¨Åt in a valid
model. One of the Ô¨Årst and most striking observations that people have
made on light is that it travels along straight lines as long as the material,
where it works in, has constant properties.
It was the French lawyer! Pierre the Fermat (‚âà1601 - 1665), who postulated
that light follows the path that requires the least time to reach a certain
place. This Fermat‚Äôs principle of least time is still used today and it will
be used in this section to explain phenomena like reÔ¨Çection and refraction.
Before entering in these phenomena it must be mentioned that this again is
a strange theory, as one could wonder how light as a series of photons can
know which path to follow to be Ô¨Årst in time. Well like Richard Feynman
states in his famous ‚ÄúFeynman lectures on physics‚Äù [31]:
But what does it do, how does it Ô¨Ånd out? Does it smell the nearby
paths and check them against each other? The answer is yes, it
does, in a way.
To understand this a bit better it is necessary to revert to the theory of
light, where a photon can also be represented as a continuous wave and this
wave behaviour gives the photons their ‚Äúinformation‚Äù about the path and
the obstructions in the path. This is suÔ¨Écient for the scope of this book to
be able to use it in the next part to describe wavefronts.
Like stated in Chapter 2, reading Richard Feynman‚Äôs work is highly recom-
mended for those readers, who would like to Ô¨Ånd out more about this duality
of light and the related theory, which is based on a probability analysis
on the diÔ¨Äerent possible paths photons can take from source to target. In
principle the photon can take any path but it will most probably follow the
path of least time.
When presenting phase gratings in Section 7.4.3.2 this theory will be used
to explain mirrors that reÔ¨Çect in other directions than as presented in the
next section.

610
Chapter 7. Optics in Mechatronic Systems
7.2.1
ReÔ¨Çection and Refraction according to the Least
Time
In Figure 7.9 a light source A is shown that emits photons.
When determining the path of the photons to place B, according to Fermat
they should follow the path of least time. As photons only move in straight
lines as long as they remain in the same medium, the shortest time corre-
sponds to the shortest distance. This shortest distance is a straight line,
which can be drawn directly from A to B, but that path is obstructed by
screen O and the photons can only arrive at B via the mirror.
Evidently the path via C is not taking the least time and also via D it is
not optimal yet. To determine the exact right place to reÔ¨Çect, a little trick
is used and a mirrored place B‚Äô is drawn. When drawing a straight line
between A and B‚Äô it is known that this is the shortest path so, when the
photon is reÔ¨Çected at the intersection point E, this is the shortest path to B.
With a little bit of trigonometry it becomes clear that the angle of incidence
œëi equals the angle of reÔ¨Çection œër, which corresponds to what was taught
at high school.
This relation is not too diÔ¨Écult to derive for simple reÔ¨Çection, but the real
value of Fermat‚Äôs model is in predicting the path, when the photons go from
one medium to another. For this derivation Figure 7.10 is drawn, where
A
Mirror
B
B‚Äô
C
D
E
O
i
r
 
Figure 7.9: The path of the photons, reÔ¨Çecting from the surface of a mirror derived
by the principle of least time, results in equal angles of incidence œëi and
reÔ¨Çection œër.

7.2. ReÔ¨Çection and Refraction
611
A
B
Air
Glass
C
D
E
F
G
i
t
r
2n
1n



Figure 7.10: The path of photons refracting at the interface between two diÔ¨Äerent
media, derived by the principle of least time, results in unequal angles
of incidence œëi and refraction œët. The shortest path is not the fastest!
Note that also some light is reÔ¨Çected.
photons from the same source A located in a low density medium (air) now
have to reach position B located in a high density medium like glass.
First of all it was stated by Fermat that a more dense medium will slow
down the light. The speed of light (cm) in any medium compares with the
speed of light in vacuum (c) with a factor equal to its refractive index (n).
cm = c
n
[m/s].
(7.9)
This means that it takes more time to propagate in a high density medium,
than it would take in a low density medium for the same distance. To
accommodate this diÔ¨Äerence in speed, the term optical path length (OPL) is
often used, where OPL equals n times the real geometric path length.
In terms of time the method of Fermat is equal to stating that photons
search for the shortest optical path, hence taking the refractive index into
account3.
The shortest path from A would be a straight line intersecting the interface
between the media at C. This geometric path does however not correspond
to the shortest optical path with the least time, as the part from C to B
3One might conclude that photons slow down in a high index medium, but in the present
physical model photons always travel with the same constant speed. The observed delay
is caused by interaction with the electrons in the medium, where the original photons are
exchanged for new photons with a small delay per interaction.

612
Chapter 7. Optics in Mechatronic Systems
would add considerable to the time.
One might say that the photons recognise that it is better to stay a bit longer
in the air and Ô¨Ånd a more optimal path, the shortest optical path.
When moving the intersection point from E to the right, Ô¨Årst the gain
in time from shortening the path from the intersection to B outweighs
the loss of time from lengthening the path from A to the intersection. At
a certain moment however this gain becomes zero and the total time will
increase again. This can be simply understood, when considering an extreme
intersection point, fully to the right in the Ô¨Ågure.
Somewhere in between, the optimal point is found and as a Ô¨Årst assumption
point E is taken. An optimum means that the change of the optical path
length as function of the location on the intersection becomes zero. This
means that the time for following the optimal path, compared with the time
for a nearby path, through for instance intersection point D need to be
almost equal. By drawing two perpendicular lines, one from D to F and
one from E to G, the diÔ¨Äerence in path length though air, when comparing
intersection point D with E, is approximately the length between F and E
‚å©EF‚å™. The diÔ¨Äerence in path length through the glass is approximately the
length between D and G ‚å©DG‚å™. This approximation is valid when distance
between D and E ‚å©DE‚å™is very small. If E is the optimal point then:
OPLair = n1‚å©EF‚å™= OPLglass = n2‚å©DG‚å™
[m].
(7.10)
‚å©EF‚å™equals ‚å©DE‚å™times the sine of the angle between points F, D and E.
From trigonometry it follows that this angle is equal to the angle of incidence
œëi.
Likewise ‚å©DG‚å™equals ‚å©DE‚å™times the sine of the angle between points E,D
and G, being equal to the angle of the transmitted and refracted light œët.
From this all follows:
n1‚å©DE‚å™sinœëi = n2‚å©DE‚å™sinœët.
(7.11)
After cancelling ‚å©DE‚å™, this equation gives the law of Snell, named after the
Dutch mathematician and astronomer Willebrord Snel van Royen(1580 ‚Äì
1626), also known with the Latin name ‚ÄúSnellius‚Äù. When light goes from
a medium with refractive index n1 to a medium with refractive index n2
Snell‚Äôs law becomes as follows:
n1 sinœëi = n2 sinœët.
(7.12)
When calculating the refracted angle from a known incident angle, Snell‚Äôs
law is written as:
sinœët = n1
n2
sinœëi.
(7.13)

7.2. ReÔ¨Çection and Refraction
613
7.2.1.1
Partial ReÔ¨Çection and Refraction
The above reasoning from the least time also shows that reversing the
direction of the photons, so going from glass to air will result in the same
shortest path, followed in the reverse direction. In this reversed situation,
the angle of incidence in the original law of Snell becomes the angle of
refraction and vice versa, resulting for the refracted angle as function of the
incident angle:
sinœët = n2
n1
sinœëi.
(7.14)
Above the critical angle œëi = arcsinn1/n2 no light will refract any more and
total reÔ¨Çection occurs, because sinœët can never be larger than one. This
eÔ¨Äect is known from light guiding in Ô¨Åbres and Ô¨Çat glass or acrylic plates,
when illuminated from the side.
This eÔ¨Äect does of course not occur only at or above the critical angle and
in reality at any optical surface a combination of reÔ¨Çection and refraction
occurs. For reÔ¨Çected light the irradiance ratio to the incident light is given
in the following equation:
Ir,r
Ir,i
= n1 cosœëi ‚àín2 cosœët
n1 cosœëi + n2 cosœët
.
(7.15)
with n1 respectively n2 equalling the refractive index of the medium of
incidence respectively the other medium.
Without the need to be able to derive this formula it shows for instance
that with very small angles of incidence this ratio will be very small, which
means that most of the light will be transmitted. At larger angles this ratio
will become larger until most of the light is reÔ¨Çected.
The equation can be checked, because at a certain angle 100 % reÔ¨Çection
can be achieved, when going from a higher refractive index to a lower value.
This corresponds to the equation as œët will become 90¬∞at the critical angle
œëi = arcsinn1/n2 and cosœët will then be zero resulting in one as the outcome
of the equation.
In practical optics mostly a controlled amount of either reÔ¨Çected or refracted
light is aimed for. This is achieved by coatings on the surface, consisting of
successive thin layers of materials with a diÔ¨Äerent refractive index, which
determine an optical resonator similar to the principle mentioned with the
laser. Such a coating can be tuned to either reÔ¨Çect or transmit light with a
certain wavelength or a range of wavelengths.

614
Chapter 7. Optics in Mechatronic Systems
7.2.2
Concept of Wavefront
Before applying these rules on reÔ¨Çection and refraction, Ô¨Årst the concept of
a wavefront is introduced. When observing a number of photons in vacuum,
all originating from a light source at t = 0, these photons will move with the
same constant speed of light in diÔ¨Äerent directions away from the source.
At any moment in time, they will all be at the same distance from the source
and their position is deÔ¨Åned by a sphere with its centre at the source. The
optical distance that a photon has travelled over a certain time was called
optical path length (OPL), which means that a wavefront connects points
with an equal OPL from the source.
The wave equivalent of this reasoning is as follows. At any moment in time,
light from a monochromatic coherent light source in vacuum will be in phase
on any concentric sphere around the source. For that reason these spheres
are called a wavefront, which is a mixing of the motion character of the
photons and the continuity character of the waves.
When working with this thinking concept of a wavefront, it is necessary to
remain aware that it is a very artiÔ¨Åcial concept as in reality light never is
completely monochromatic nor completely coherent over long ranges, like
was explained with the laser. A coherence length of metres is large, so
light from a star is never coherent. Nevertheless it is a very useful concept,
because it visualises diÔ¨Äerent optical eÔ¨Äects.
It is used to illustrate phase relations and the local direction of the light
Source

Figure 7.11: Wavefront model of the propagation of light. Concentric spheres rep-
resent photons that simultaneously originated at the source in the
centre of the sphere. The distance between the spheres represents
either the wavelength of the light or a proportional value thereof.

7.2. ReÔ¨Çection and Refraction
615
is always orthogonal to the wavefront. A curved wavefront corresponds
to diverging or converging light rays and a Ô¨Çat wavefront corresponds to
parallel rays of light. This is illustrated in two dimensions in Figure 7.11,
where the spheres are approximated by circles. The waves originating from
the point source are depicted, as if they have only one frequency with a
wavelength equal to the distance of the solid or dashed lines, while the
solid lines represent the positive maxima and the dashed lines the negative
maxima of the sine wave.
Often the dashed lines are shown only when the phase relationship is
important. When only the direction is investigated, they often are omitted.
7.2.2.1
A Wavefront is Not Real
In reality the spheres would need to have a very small distance, equal to the
wavelength of the light and they would need to move with the speed of light.
This means by deÔ¨Ånition that a drawing of a wavefront only shows a snapshot
at a distinct moment of a propagating travelling wave. It does by no means
imply that a wavefront drawing represents a standing wave.
When examining interference at a very small scale, like in Section 7.4, the
distance between the spheres is equal to the wavelength. At large scale
optics however, when only the direction of the light matters, often drawings
on wavefronts are used with much larger distances of the lines, where their
distance is only proportional to the real wavelength.
From Figure 7.11 it is clearly observable that the wavefront becomes more
and more Ô¨Çattened out with increasing distance from the source, which
explains the almost parallel rays of light coming from the sun.
Several qualitative statements can be derived with the wavefront model
regarding the eÔ¨Äects of changes in the refractive index of the medium where
the waves pass through. In case these media are not homogeneous, the
waves will partly slow down resulting in a distorted wavefront, like shown
in Figure 7.12. In fact the medium in blue acts like a kind of lens and it
illustrates the observed eÔ¨Äects, when we look through non homogeneous
gas or Ô¨Çuid, like the air above a heated surface.
In Figure 7.13 the previously described reÔ¨Çection and refraction is shown
with Ô¨Çat wavefronts and a shorter wavelength (lower propagation speed) in
the glass. From the fact that at the connection points both reÔ¨Çected and
refracted waves should have a Ô¨Åxed phase relationship, the law of Snell
can also be derived in a graphical way. On purpose, the term ‚ÄúÔ¨Åxed phase
relationship‚Äù is used, instead of ‚Äúthe same phase‚Äù, as at reÔ¨Çection from a
less dense medium to a more dense medium a sign inversion occurs, giving

616
Chapter 7. Optics in Mechatronic Systems
Figure 7.12: Distortion of a Ô¨Çat wavefront caused by the reduced propagation speed
of part of the wave, when passing through a medium with a higher
refractive index.
180¬∞phase diÔ¨Äerence, comparable with the rigidly connected chain of mass
spring systems in Chapter 2. More details on this aspect can be found in
specialised books, dealing with the Fresnel equations.
Air
Glass
Figure 7.13: ReÔ¨Çection and refraction at the interface between two diÔ¨Äerent me-
dia derived by using wavefronts. A higher refractive index causes a
shorter wavelength that at the interface is in phase with the incoming
wavefronts. The reÔ¨Çected wavefront shows 180¬∞sign inversion, because
of the reÔ¨Çection from a low density to a high density medium.

7.3. Geometric Optics
617
7.3
Geometric Optics
Geometric optics is an important area of optics used for predicting imaging
properties of optical systems by approximating the light as an independent
set of separate rays and by neglecting eÔ¨Äects like interference and diÔ¨Ärac-
tion, which relate to the wave character of light. This approximation is only
valid, when the important details of the object to be imaged are essentially
larger than the wavelength of the light, but even in more critical designs
geometric optics can give very useful predictive results.
Optical imaging is based on the two main principles that were introduced
in the previous section, reÔ¨Çection and refraction. In case of refraction, the
transparent optical elements are called lenses and in case of reÔ¨Çection, the
non-transparent optical elements are called mirrors. ReÔ¨Çective systems are
also named catoptric systems and refractive systems dioptric, a term that
relates to the term ‚Äúdioptre‚Äù for the ‚Äústrength‚Äù of a lens, being reciprocal
to the focal length. The term dioptre is mainly used within ophthalmology
for eye glasses. A combination of lenses and mirrors in an imaging system
is called a catadioptric system. As most smaller optics from everyday life
consist of refractive elements, this section will be limited to dioptric optics
only. The treatise is in principle more complicated than with the catoptric
counterpart, due to the refraction involved.
Two essential diÔ¨Äerences however need to be mentioned. First of all, re-
fraction in general is wavelength dependent and as will be shown, this
dependency introduces chromatic aberrations, which do not occur with re-
Ô¨Çection. Secondly an imaging system with only refractive lens elements
is less dependent on small rotations (tilting) of each element around the
axes perpendicular to the optical axis, while any reÔ¨Çective surface is ex-
tremely sensitive for tilting. This property poses severe requirements on
the mounting stability of these reÔ¨Çective elements.
7.3.1
Imaging with Refractive Lens Elements
Parallel rays of light approaching a piece of glass with two parallel planar
surfaces will be refracted and continue their path with the same parallelism
and distance. This is the case, because the refraction at the point of insertion
is compensated by the refraction at the exit point of the glass. This can be
seen in Figure 7.14, which also shows what would happen with a piece of
glass with two curved parallel surfaces with the same curvature. Even in
that case the rays would propagate approximately parallel after the passage
and only their distance will be changed. In order to achieve an optical image

618
Chapter 7. Optics in Mechatronic Systems
A
B
Figure 7.14: Refraction of two pieces of glass with parallel surfaces, one Ô¨Çat and one
curved, shows that only a shift of the lines will occur. The refraction
at point A is reversed at point B
.
it is necessary to use a piece of glass with a varying thickness, slowing down
the rays depending on their incidence angle and position.
The invention of a lens is already more than three thousand years old. By
coincidence of nature it is far more easy to achieve a curved surface than
a Ô¨Çat surface with optical quality. When polishing a piece of glass by a
circular motion against a relatively soft counter surface with abrasive paste,
automatically a curved surface will result. The abrasion takes place most
at the outer part of the piece of glass, because the outer part makes a larger
movement in this process and the force exerted near the edges is also larger,
resulting in an essentially spherical surface.
As a Ô¨Årst step into the modelling of the imaging properties of a lens, the
refraction at a spherical surface with radius R is shown in Figure 7.15.
First the optical axis is deÔ¨Åned as being the axis of rotational symmetry of
the optical system. A ray parallel to the optical axis, entering the surface at
point A, is refracted in the direction of the normal towards the centre of the
surface, according to the law of Snell. A ray drawn at the optical axis would
have an angle of incidence of 90¬∞in the Vertex. As a consequence this ray
would continue its path with the same direction and intersect the Ô¨Årst ray
at F. It can be reasoned that all parallel rays at the same distance from the
optical axis as the Ô¨Årst ray at A will after refraction cross the optical axis
at the same point F, because of the rotational symmetry and the point F is
called the focal point. As a an approximation also rays entering closer to
the optical axis will bend towards the same focal point F with only a small
error causing the ‚Äúspherical aberration‚Äù of a lens. This aberration is small,

7.3. Geometric Optics
619
Vertex 
R
A
F
Focal point
Opcal axis
i
r
Figure 7.15: Refraction at a spherical surface results in converging rays that inter-
sect at the focal point F.
when only those rays are considered that are very close and almost parallel
to the optical axis, the so called paraxial rays.
7.3.1.1
Sign Conventions
Most optical systems are axisymmetric around the optical axis, which means
that the image of an object will not change when the optical system is rotated
around the optical axis. The orthogonal plane to the optical axis where the
object is located is called object plane, while the image plane is a similar
plane located at the image position on the optical axis.
For this reason the treatise on geometric optical imaging can be done by
means of simple 2-dimensional drawings, where a line or spot represent
all objects and images around the optical axis on the same object- or image
plane.
The object- and image plane positions can be at equal or opposite sides of
the optical system with diÔ¨Äerent eÔ¨Äects. In order to avoid errors due to
these positions it is important to introduce some sign conventions to achieve
the right sign for the image, positive for the same side of the optical axis as
the object and negative for the opposite side.
The formal sign convention in imaging systems starts with the light source
or the object positioned at the left side of the system. The convention is
a bit counter intuitive for mechanical engineers, as it does not correspond
to a standard 2D-coordinate system with the positive axis upward (y) and
to the right (x).

620
Chapter 7. Optics in Mechatronic Systems
Biconvex        Biconcave           Posive      Negave         Plano-
Plano-
meniscus   meniscus
concave          convex 
Figure 7.16: DiÔ¨Äerent lenses exist with names that are determined by the curvature
of their two surfaces.
The following is commonly used,:
‚Ä¢ Fo, the distance of Ô¨Årst focal point to lens is positive when located at
the left side of the lens.
‚Ä¢ Fi, the distance of second focal point to the lens is positive when located
at the right side of the lens.
‚Ä¢ So, the distance of object plane to the lens is positive when located at
the left side of the lens.
‚Ä¢ Si, the distance of image plane to the lens is positive when located at
the right side of the lens.
‚Ä¢ y, the vertical axis is positive above the optical axis.
‚Ä¢ R, the radius of the surface of the lens is positive if the centre is located
at the right side of the lens.
As a consequence of these conventions a biconvex lens has for instance one
positive radius (left) and one negative (right).
7.3.1.2
Real Lens Elements
A real lens consists of two surfaces with diÔ¨Äerent curvatures where the
same law of Snell can be applied.
A wide variety of lenses exist, as shown in Figure 7.16. The diÔ¨Äerent names
are derived from the curvature shape. A rounded surface is either convex,
Ô¨Çat (plano) or concave and all combinations can be applied.

7.3. Geometric Optics
621
R1
R2
Focal point
Opcal axis
f
d
R1
R2
Virtual focal point
Opcal axis
f
d
*6
*¬ö$
Figure 7.17: A positive lens, consisting of two convex surfaces, which both converge
the refracted rays to the optical axis, gives a shorter focal length, than
with one convex surface only.
A negative lens, consisting of two concave surfaces, which both diverge
the refracted rays, creates a ‚Äúvirtual‚Äù focal point at the same side as
the object.
A biconvex lens is called a positive lens as it will bend the rays towards
the optical axis (converging). Consequently a biconcave lens is a negative
(diverging) lens, and any other combination is positive or negative depending
on whether the optical path through the lens is largest near the optical axis
or at the outer part of the lens.
A combination of a convex and a concave surface is called a meniscus because
of the similarity with the shape of the human meniscus and it is the standard
conÔ¨Åguration for eye-glasses.
The Ô¨Årst example of imaging optics introduced in this section is the positive
biconvex lens from Figure 7.17. This lens refracts the rays in a converging
direction towards the optical axis. It can be seen that both surfaces refract
the rays that come from the left in the same direction, resulting in a focal
point closer to the lens than would be the case with one surface only. With
a negative biconcave lens the opposite result is obtained. In this case, the

622
Chapter 7. Optics in Mechatronic Systems
rays are refracted away from the optical axis and seem to be originating
from a point located at the left side of the lens. This non-existing point is
called a virtual focal-point, because it is not the real origin of the rays that
is observed at the right side of the lens.
The same method of ‚Äúthe least time‚Äù by Fermat can be used to derive the
equation for the focal length of a lens but it is also possible to use the law of
Snell directly.
Without showing the total derivation, in both cases the following equation
can be derived for the focal length of the lens:
1
f = (n‚àí1)

 1
R1
‚àí1
R2
+ (n‚àí1)d
nR1R2


m‚àí1
.
(7.16)
with:
f = the focal length of the lens [m],
n = the refractive index of the lens material,
R1 = the radius of curvature of the incident lens surface [m],
R2 = the radius of curvature of the exit lens surface [m],
d = the thickness of the lens measured at the optical axis.
(7.17)
With a very thin lens, this equation simpliÔ¨Åes into the thin-lens equation
also called the lensmakers equation:
1
f = (n‚àí1)

 1
R1
‚àí1
R2


m‚àí1
.
(7.18)
In Figure 7.18 the imaging properties of a positive lens are shown4.
The object that is located at a distance So from the left side of the lens is
imaged at a distance Si from the right side. The rays really pass through
the image, which means it is a real image. As will be shown in the next
Ô¨Ågure, a real image can only be realised under the condition that So is larger
than f . With thin lenses the location of the image can be approximately
determined by using two rays of which the path or trace is followed. This
process is called ray tracing. The Ô¨Årst ray is drawn through the middle of
the lens and does not change direction nor position. This is allowed as long
as the lens is very thin. The middle of the lens will then behave like two
parallel surfaces.
4As of this example, the light rays are represented by lines instead of arrows and the light is
assumed always to come in from the left en exit from the right, according to the sign convention.
Further the optical axis is always represented by the centre line like in the previous Ô¨Ågures.

7.3. Geometric Optics
623
Fi
f
Object
Image
f
Fo
Si
So
Figure 7.18: A positive thin lens gives a real image, when the object is further away
than the focal length f .
The second ray is drawn parallel to the optical axis and will be refracted to
the focal point of the lens. The image is found at the intersection of the Ô¨Årst
and second ray.
The relation between So and Si is determined by the focal distance f , follow-
ing a simple relation that can be derived by trigonometry. This relation is
called the Gaussian lens formula:
1
So
+ 1
Si
= 1
f

m‚àí1
.
(7.19)
A simple sanity check proves this formula, as an object at inÔ¨Ånity will result
in an image in the focal point and vice versa. It also is imaginable that a
distance of the object from the lens at twice the focal length results in full
symmetry of object and image.
7.3.1.3
MagniÔ¨Åcation
In the previous example it was shown that the size of the image diÔ¨Äers
in most cases from the size of the object, resulting in a magniÔ¨Åcation M
that depends on the position of the object relative to the focal point of the
lens. This magniÔ¨Åcation can also be derived by means of straightforward
trigonometry, showing that the magniÔ¨Åcation is proportional to the ratio
between the distances. As a consequence of the previously deÔ¨Åned sign
conventions, the magniÔ¨Åcation M of a lens has to be written as follows:
M = ‚àíSi
So
.
(7.20)

624
Chapter 7. Optics in Mechatronic Systems
Fo
Fi
f
Object
Virtual
Image
Si
So
f
Fi
f
Object
Virtual
Image
f
Fo
So
Si
*6
*¬ö$
Figure 7.19: A positive lens will give a virtual image, when the object is closer to
the lens than the focal length. A negative lens always gives a virtual
image, independent of the position of the object.
The minus sign represents the image location at the opposite side of the
optical axis as the location of the object.
As a next step, it is interesting to see what happens when the object comes
closer to the lens. At the image location this will result in an increasing
distance to the right until the object is located at the focal point, resulting
in an image at inÔ¨Ånity. When the object approaches the lens even further,
Ô¨Årst the image jumps from +‚àûto ‚àí‚àûand then the image will approach the
lens again, but now from left as a virtual image. This is illustrated in the
upper drawing of Figure 7.19, where the resulting diverging set of rays at
the right side of the lens seem to originate from the virtual image.
The rules for magniÔ¨Åcation and location of the object and image are still

7.3. Geometric Optics
625
valid in this situation and the sign of the magniÔ¨Åcation becomes positive,
because of the negative value of Si. This corresponds to the position of the
image at the same side of the optical axis as the object. Also the position
of the image can be derived from the Gaussian Lens formula, where Si
becomes negative if So < f .
It is to be expected that a negative lens will give a virtual image, because
of the virtual focal point. This is indeed conÔ¨Årmed in the lower drawing of
Figure 7.19, where the image is derived with the same rays, one parallel to
the optical axis and one through the centre of the lens.
It is however not possible to create a real image with a negative lens by
shifting the object closer to the lens. This can be concluded by examining
the two rays in the Ô¨Ågure, when the object would shift to the right. Even
past the focal point, the rays will remain diverging at the right side of the
lens, while the virtual image always remains closer to the lens then the
object.
7.3.2
Aberrations
The quality of the imaging by optical systems is determined by many fac-
tors. Aside from the inÔ¨Çuence of the wave character of the light as will be
presented in Section 7.4, these errors can consist of aberrations and stray
light, leading to a reduction of contrast and sharpness.
Stray light is caused by reÔ¨Çections on edges and the housing of the lens.
Also insuÔ¨Écient polishing of the optical surface causes the occurrence of
stray light, resulting in Ô¨Çare at the image.
All deviations of the trace of each ray in respect to the ideal trace to the
image location are called aberrations. The three most typical aberrations‚Äû
the Spherical Aberration, Astigmatism and Coma will be presented Ô¨Årst,
followed by the geometric and chromatic aberrations.
7.3.2.1
Spherical Aberration
When presenting refraction at spherical surfaces, it was mentioned that
parallel rays at diÔ¨Äerent distances of the optical axis will refract to almost
the same focal point with only a small error. This error is called the
Spherical Aberration as it is caused by the pure spherical surface shape.
Figure 7.20 illustrates this eÔ¨Äect with the most extreme example of a positive
lens, a full sphere.
In case of a purely spherical surface, the rays at a larger distance are re-
fracted stronger than the rays more close to the optical axis. At a larger

626
Chapter 7. Optics in Mechatronic Systems
d
Figure 7.20: Spherical aberration at a lens with spherical surfaces. Rays at a
diÔ¨Äerent distance from the optical axis have a diÔ¨Äerent focal length.
The pure sphere at the left shows the most extreme example of this
aberration, which makes a sphere unsuitable for normal imaging.
With normal lenses spherical aberration can be solved by means of an
aspheric departure d from the ideal sphere shape.
distance from the optical axis, the angle of incidence both at the entry sur-
face and at the exit surface become increasingly large. The exiting point is
closer to the optical axis where the normal to the surface is more horizontal,
because of the refraction towards the optical axis. As a result, a stronger
refraction occurs at the exit point of the lens than would be needed to reach
the same focal point as where a beam closer to the optical axis is directed.
Ultimately, with the most outer rays, the angles become so large that the
angle of incidence at the exit surface becomes larger than the angle of total
reÔ¨Çection and the light can not escape anymore.
Although the pure sphere is an extreme example, all lenses with spherical
surfaces show spherical aberration, because the radius of curvature at a
larger distance is too small to refract the outer rays to the same unique focal
point. This reasoning implies that an increase of that radius as function of
the distance can solve the problem. This deviation of the spherical surface
is called asphericity with a departure value d as shown in the Ô¨Ågure.
An aspheric surface can not be produced by the standard production meth-
ods for polished optical surfaces. Computer controlled milling, grinding
and polishing machines are used to create these aspherical surfaces. An
example of such a machine is the magneto-rheological polishing machine of
the company QED shown in Figure 7.21. It uses the property of Ô¨Çuids that

7.3. Geometric Optics
627
Magnec %eld gradient
Sheared
¬õuid
Pressure
distribuon
Spindle
Rotaon
Lens 
sweeps 
through
MR Fluid
Pump
Sucon
Electromagnet
Pump
Nozzle
Wheel
MR ¬õuid condioner
Lens
Figure 7.21: Magneto-rheological polishing process used to create aspherical op-
tical surfaces. The abrasive particles are suspended in a magneto-
rheological Ô¨Çuid that stiÔ¨Äens in the magnetic Ô¨Åeld, applied near the
optical surface to be polished. (Courtesy of QED)
stiÔ¨Äen by a magnetic Ô¨Åeld to concentrate the polishing force very precisely
on the surface of the lens where material has to be removed. The Ô¨Çuid is
continuously refreshed and Ô¨Åltered, which means that the process parame-
ters are not inÔ¨Çuenced by wear or Ô¨Çoating glass particles.
The departure magnitude is a signiÔ¨Åcant factor in the total cost of these
optics, because of the high cost level of these production machines.
7.3.2.2
Astigmatism
A second typical aberration is the astigmatism, as shown in Figure 7.22.
This aberration is observed when rays that propagate in one plane through
the optical axis have a diÔ¨Äerent focal distance than rays propagating in an
orthogonal plane through the optical axis.
This aberration occurs, when the radius of curvature of the lens surface is
diÔ¨Äerent for diÔ¨Äerent planes through the centre of the lens. This would for
instance occur with a cylindrical surface shape deviation of the spherical
surface shape of a regular lens. With eye glasses, astigmatism is for this
reason also called a ‚Äúcylinder‚Äù and it is the most frequently observed aber-
ration of the human eye.
The example shown in the drawing image of the Ô¨Ågure illustrates that astig-
matism can even occur for paraxial rays to an image location on the optical

628
Chapter 7. Optics in Mechatronic Systems
F1
F2
IS
#$'
"$
IT
Figure 7.22: Astigmatism is the eÔ¨Äect that is observed, when the rays in one plane
have a diÔ¨Äerent focal point than rays in a perpendicular plane. This
is caused by a cylinder shape superimposed on the spherical shape of
the lens. Astigmatism in the image of an object that is not located on
the optical axis is recognised by diÔ¨Äerent focal distance in two planes,
the sagittal plane with image (IS) and tangential plane with image
(IT).
axis. With non-paraxial rays, the imaging of objects at some distance of the
optical axis is analysed by tracing rays from diÔ¨Äerent points on the object in
two important planes as shown in the lower drawing of the Ô¨Ågure.
The Ô¨Årst plane, the tangential plane, which is also called the meridional
plane, is deÔ¨Åned by the point on the object and the optical axis. The second
plane, the sagittal plane, is orthogonal to this plane and also includes the
point on the object that is analysed. This means that the sagittal plane does
not include the optical axis. With a single lens element it intersects the
optical axis at the centre of the lens.
Rays in the tangential plane are called tangential rays and consequently
rays in the sagittal plane are called sagittal rays. Astigmatism occurs when
the sagittal and tangential rays have a diÔ¨Äerent focal point and this can even
occur with a rotation symmetric lens. In that case however the astigmatism
for an object point on the optical axis would be zero.
A lens with a partly cylinder shape causes even astigmatism on the optical
axis as was shown in the upper drawing of Figure 7.22 because of the non
rotation symmetric shape.

7.3. Geometric Optics
629
7.3.2.3
Coma
While spherical aberration and astigmatism can both occur even with parax-
ial rays and objects at the optical axis, other aberrations only occur with
rays corresponding to an image that is not located on the optical axis. An
example of this kind of aberrations is the coma as shown in Figure 7.23.
Coma is caused by the same phenomenon as spherical aberration. A larger
angle of incidence at the entry surface of a lens results in an excessively
refracted beam at the exit surface. This means that the rays entering the
lower part of the lens, where they are almost perpendicular to the surface,
will be directed to a diÔ¨Äerent focal point at a larger distance than the rays
entering the upper part of the lens.
From the Ô¨Ågure it can be seen that in this case also no real sharp focal point
can be found. The image will look like a comet shape, depending of the
position of the chosen image plane. Coma is recognised by a rather sharp
and intense spot with a Ô¨Çare of decreasing intensity but increasing size in
the direction of the optical axis.
7.3.2.4
Geometric and Chromatic Aberrations
Other aberrations include geometric aberrations like Ô¨Åeld curvature and
distortion, while chromatic aberration is observed when light with diÔ¨Äerent
wavelengths is imaged.
Field curvature means that a Ô¨Çat subject in the object plane is not imaged
sharply Ô¨Çat at the image location but at a curved focal plane. This is shown
in Figure 7.24. The object and image plane are often called a Ô¨Åeld plane to
distinguish them from the aperture plane or the pupil plane, which will be
Image
Figure 7.23: Coma only occurs for non paraxial rays and is caused by a diÔ¨Äerence
in focal length for rays entering the lens at diÔ¨Äerent positions. As a
result the image looks like a ‚Äúcomet-tail‚Äù.

630
Chapter 7. Optics in Mechatronic Systems
Figure 7.24: Field curvature is the eÔ¨Äect that the part of the object that is further
away from the optical axis is imaged at another distance from the lens
than the part that is close to the optical axis. Although again caused
by the same mechanism as spherical aberration and coma it is not the
same phenomenon.
deÔ¨Åned later.
Distortion is an error in the magniÔ¨Åcation of a lens. When the magniÔ¨Åcation
of the lens is depending on the distance of the object to the optical axis, the
shape of the image of a large subject becomes distorted. Figure 7.25 shows
the two most frequently observed distortions in for instance photo cameras,
the barrel distortion where the magniÔ¨Åcation decreases for objects further
away from the optical axis and the Pincushion distortion with the opposite
eÔ¨Äect. These two examples are only Ô¨Årst-order linear types of distortion and
in reality also higher-order distortion eÔ¨Äects can occur.
Chromatic aberration is caused by the diÔ¨Äerence in refractive index of a
transparent material for diÔ¨Äerent wavelengths. This property is called
Figure 7.25: Barrel and Pincushion distortion are caused by a diÔ¨Äerence in mag-
niÔ¨Åcation between parts of the object at a diÔ¨Äerent distance from the
optical axis.

7.3. Geometric Optics
631
Figure 7.26: Chromatic aberration is caused by the wavelength dependent refrac-
tive index of the lens material. DiÔ¨Äerent wavelengths (colours) will
have a diÔ¨Äerent focal length.
chromatic dispersion because it causes the well-known separation of colours
in for instance a rainbow and a glass prism.
In Figure 7.26 an example with a normal dispersion is shown, where the
refractive index increases with decreasing wavelength. This causes the focal
point for blue light to be closer to the positive lens than the focal point for
red light. Often this aberration also results in a wavelength dependent
magniÔ¨Åcation, which is visible in photography as purple fringing at the
outer parts of the image.
7.3.3
Combining Multiple Optical Elements
The mentioned aberrations all have impact on the quality of the image and
hence need to be reduced to an acceptable level, depending on the applica-
tion.
By introducing an aspheric surface it was demonstrated how spherical aber-
ration can be avoided and asphericity can also be used to reduce other errors
like coma.
With low cost optics and in case of severe size limitations, like with the
photo camera in a cell phone, this is the only way to solve these problems.
Another example of such a limited optical system is the lens for the opti-
cal pick-up unit of a CD-player. These lenses are often made from plastic,
molded in the desired aspheric shape.
In high performance imaging systems, this aspheric single-lens solution
is not suÔ¨Écient and a multitude of lens elements, both spherical and as-
pherical, are often combined to create an imaging system that is minimally

632
Chapter 7. Optics in Mechatronic Systems
Crown
Flint
Figure 7.27: By combining a positive lens made of Crown glass and a negative lens
made from Flint glass an achromatic doublet is obtained, where the
chromatic aberration of a single lens element is compensated.
aÔ¨Äected by the mentioned aberrations.
The Ô¨Årst example of a multiple lens element is a combination of two lens
elements made of materials with diÔ¨Äerent refractive properties, to correct
chromatic aberration. When a positive lens, made of Crown glass is com-
bined with a negative lens, made of Flint glass it results in the achromatic
doublet of Figure 7.27.
Crown glass is a material with a very high refractive index and a corre-
sponding high dispersion, while Flint glass has a low refractive index with
a low dispersion. The resulting reduction of the overall dispersion comes at
a price, because the focal length of the combination is larger than the focal
length of the positive lens alone.
Although this combination gives an improvement, more measures are needed
to correct a lens over a wide range of wavelengths. Nevertheless it is a build-
ing block that can be used in combination with more elements in advanced
optical systems.
7.3.3.1
Combining Two Positive Lenses
From the wide variety of combinations with positive and negative lenses,
only the combination of two positive lenses will be explained in this section
as representative example.
Figure 7.28 shows this conÔ¨Åguration, where the distance between the posi-
tive lenses is smaller than the sum of their focal lengths.
The determination of the image location is done in two steps. First the
image I1 is determined that would be created by the Ô¨Årst lens L1 only.
As explained previously, this is achieved by drawing two rays. The Ô¨Årst ray

7.3. Geometric Optics
633
F1,o
F2,o
F1,i
F2,i
f1
f1
f2
f2
O
I1
I2
d
L1
L2
1
3
2
4
Figure 7.28: Optical system, consisting of two positive lenses positioned close to-
gether. The image is determined by Ô¨Årst determining the image by
L1 via ray 1 and 2 and use that intermediate image to construct the
image after L2 by means of an additional ray 3 drawn from I1 through
the centre of L2 combined with ray 4 through both focal points.
is drawn parallel to the optical axis and will be refracted through the focal
point at the image side F1,i. The second ray propagates through the optical
centre of L1 so it is not refracted. At the cross section of these rays, image I1
is drawn in a dashed shape, because in reality the rays will be intercepted
by lens L2.
With the help of image I1, the third ray can be drawn, which is the one that
would pass through the optical centre of L2 and image I1.
As a last step to determine the image, the fourth ray propagates from the
object through the focal point F1,o, resulting in a refracted beam after L1
parallel to the optical axis, which will in its turn be refracted by L2 through
its focal point F2,i.
The image of the combination of the two lenses is found at the intersection
of these last two rays.
The two lenses appear to behave as one single lens and with a bit of trigonom-
etry the following approximative relation for the focal length of the combi-
nation can be derived:
1
f = 1
f1
+ 1
f2
‚àí
d
f1 f2

m‚àí1
.
(7.21)
Which for very small values of d relative to f1 and f2 becomes:
1
f = 1
f1
+ 1
f2

m‚àí1
.
(7.22)
It is also clear that the image is inverted, like with a single positive lens.

634
Chapter 7. Optics in Mechatronic Systems
F1,o
F2,o
F1,i
F2,i
f1
f1
O
I1
I2
d
f2
f2
L1
L2
Ft,i
Figure 7.29: Optical system, consisting of two positive lenses positioned far apart.
The image is also determined by Ô¨Årst determining the intermediate
image by L1. The Ô¨Ånal image is determined straightforward, because
the intermediate image is positioned between the focal points of both
lenses.
A very diÔ¨Äerent situation is shown in Figure 7.29, where the lenses are
positioned further apart such that their distance is larger than the sum of
their focal lengths.
With this conÔ¨Åguration, the image of the object by L1 is positioned between
both lenses and is called the intermediate image. The second image is simply
determined by taking the intermediate image as object for L2 and use the
same rules as with a single lens system.
From the Ô¨Ågure it appears that the inverting eÔ¨Äect of L1 is reversed by L2,
resulting in an image with the same orientation as the object.
By tracing the ray from the object that was parallel to the optical axis, the
focal point of the combination Ft,i is found. When L2 is positioned closer to
L1 in Figure 7.29, it appears that Ft,i will move more to the right. This can
be concluded from the position of the image when the object is kept at a Ô¨Åxed
distance from L1. The three rays that converge at I2 will rapidly diverge.
As a result the magniÔ¨Åcation of the combined two lenses is increased and
the focal point is shifted. This eÔ¨Äect indicates that with two positive lens
elements a zoom lens can be created.
A special situation occurs when L2 is shifted so close to L1 that F2,o becomes
located at the same position as I1. In that situation the second image I2 will
be located at inÔ¨Ånity as I1 is at the focal point of L2.
When L2 is moved even further towards L1, I1 will enter the area between
F2,o and L2 resulting in a virtual image at the left side of the system, similar
to the eÔ¨Äect that was demonstrated a few pages back in Figure 7.19. It is

7.3. Geometric Optics
635
true that the image swept from positive inÔ¨Ånity to negative inÔ¨Ånity at the
very moment of crossing the focal point of L1 and it will again come closer
from the left when L2 is moved even further.
Ultimately at a certain distance between the two lens elements both focal
points will coincide. As a result parallel rays that enter the dual-lens system
at one side will exit the system also parallel at the other side, which means
that the system has no focal point. Such an afocal optical system is very
important in precision mechatronic systems as will be explained after the
introduction of the important aperture stop and pupil.
7.3.4
Aperture Stop and Pupil
All optical imaging systems have one important limitation that is caused
by their constrained dimensions. In Section 7.4 on physical optics it will
be shown, how the ultimate imaging properties of an optical system are
determined by the maximum capture angle of the rays that can pass the
system. This quality of capturing as much as possible light is also directly
related to the law of conservation of radiance, as introduced in Section 7.1.3.
A geometrical measure for this dimensional property is the pupil, which
deÔ¨Ånes which rays are captured and transmitted by the optical system and
which rays are blocked. With a single lens element, this pupil is determined
by the diameter of the element itself. With a more complicated system,
consisting of a multitude of lens elements, the outer rays are in principle
limited in a not well deÔ¨Åned manner, depending on the direction of the rays
and the position and sizes of the diÔ¨Äerent elements. It is not preferable
to determine the pupil by the mountings of the lens elements by means of
metal constructions with either springs, screws and/or glue, because this
would lead to scattering of light in undeÔ¨Åned directions.
To solve these issues, preferably a separate element is added that determines
this pupil. This element is called an aperture stop, often just shortly named
‚Äúthe stop‚Äù. Other names are iris diaphragm or just iris.
Figure 7.30 shows a schematic example of an optical system, consisting of
three lens elements, where an aperture stop is inserted between lens L2
and L3. The Ô¨Årst observation that can be made is that the most outer rays
passing through the system are no longer determined by the size of the
lenses but only by the aperture stop. The second observation is that only
the image of the stop by the lenses between the stop and the observer can
be seen from outside. This image is called the entry-pupil at the object side,
deÔ¨Åning which rays can enter the optical system, and the exit-pupil at the
image side, deÔ¨Åning which rays can contribute to the image.

636
Chapter 7. Optics in Mechatronic Systems
I
L1
L3
L2
O
Aperture stop
Exit-pupil 
Entry-pupil 
Figure 7.30: An optical system with an aperture stop, which limits the outer rays in
the system. The entry-pupil is the image of the aperture stop observed
at the entry of the system, while the exit-pupil equals the image of
the aperture stop as observed at the exit of the optical system.
7.3.5
Telecentricity
When the focal points of two positive lenses coincide, the optical system
will no longer focus parallel incoming rays in a focal point. For that reason
such an optical system is called afocal. An afocal optical system obtains a
special property, called double-telecentricity, when the aperture is located
in the joint focal plane of the two lenses. This property, which makes it a
very useful system for technical purposes, is explained by means of the dual
lens-element optical system of Figure 7.31.
A paraxial ray from O will be refracted by L1 through the joint focal point
(F1,iF2,o) and continue its path towards L2, where it will be refracted parallel
to the optical axis again. The location of the image will be at F2,i, because
all rays of any point of the object will be refracted into a set of parallel rays
in the space between the lenses. As a consequence these rays themselves
will be refracted to the focal point of the second lens element L2. The one
ray from any point of the object that passes through the joint focal point of a
double-telecentric lens is called the chief ray belonging to that object point.
The round aperture stop, located at the joint focal plane, will automatically
limit all rays from any point on the object to a circular surface, orthogonal
to the optical axis with the chief ray running through its centre. With a
double-telecentric system a paraxial ray from any point on the object will be
a chief ray and become also a paraxial ray at the image side of the system.
At the object and image side the other rays run in a cone of light around
the paraxial chief ray for each point of the object where the cone is directed
parallel to the optical axis. This means that a displacement of the object or
the image sensor in any direction left or right from the drawn position in

7.3. Geometric Optics
637
f1
f1
O
I
f2
f2
L1
L2
F1,o
F2,o
F1,i
F2,i
lo
li
Chief ray
Aperture stop
pupil plane
Figure 7.31: When combining two positive lenses with coinciding focal points, an
afocal optical system is obtained. An aperture stop in the joint focal
plane will create a double-telecentric optical system. An object located
at F1,o will be imaged at F2,i with a magniÔ¨Åcation equal to the ratio
of the focal lengths. The chief ray through the joint focal centre is
parallel to the optical axis both at the object and at the image site.
The position of the object or the image sensor has no inÔ¨Çuence on the
magniÔ¨Åcation. A symmetric cone of light from any point of the object
around the chief ray will also create a symmetric cone of light at the
image.
Figure 7.31 will only result in a larger, unsharp spot. Although the image
will be unsharp, the position of the spot will not be changed, because the path
of the chief ray will remain paraxial, not inÔ¨Çuenced by this displacement.
As a consequence, the size of the image is not changed when the image
sensor is not perfectly in focus and the magniÔ¨Åcation of the system is only
determined by the ratio of the focal lengths:
M = ‚àíli
lo
= ‚àíf2
f1
.
(7.23)
which can be derived from the geometrical relations.
These kind of lenses are specially chosen when the requirements on mag-
niÔ¨Åcation are more severe than the requirements on defocus. This is the
case with for instance the projection lens of the waferstepper, which was
introduced in Chapter 1. When the wafer with photo-sensitive resist is
placed at the image location with a slight error in its distance to the lens,
this error will only result in a less than perfectly sharp image but not in a
change of the dimensions, which would lead to relative positioning errors of
the diÔ¨Äerent layers in the integrated circuit.

638
Chapter 7. Optics in Mechatronic Systems
7.3.5.1
Pupil, Aperture and Lens Dimensions
When observing Figure 7.31 it is clear that the optical system can only be
dual-telecentric for all object points when these object points can each be
imaged with the same cone of light, symmetrical around the chief ray. While
the dimension of the cone of light is determined by the aperture stop it is
clear that the lens elements have to be larger than the aperture stop. The
object point that is furthest away from the optical axis determines the most
outer chief ray in the system and the lens elements have to be so much
larger that the full cone of light of that chief ray can be captured. This is
one of the reasons why the object and image of a lithographic projection
lens of a waferstepper can never be very large. The other reason is related
to the opening angle of the cone of light, which needs to be as large as
possible to achieve a high optical resolution. This will be further explained
in Section 7.4.4. The image of the aperture stop of a double-telecentric lens
is at inÔ¨Ånity because of the position at the joint focal point. In practice this
has given cause to the name pupil plane for the orthogonal plane to the
optical axis that is located at the aperture stop.
Also with non-telecentric optics it is preferred that the rays from any spot
on the object propagate parallel at the plane where the aperture stop is
located. This is the case with all optics that need a controllable aperture
stop, like photographic camera lenses. This can be seen from Figure 7.31
when imagining a smaller aperture stop, which will only cut away the outer
rays circular around the chief ray. This will only reduce the total amount of
light from each object point to the image but it will not alter the position
of the image point. The overall image shape is not altered by shadowing a
part of the image, because each point on the object will still be imaged by
means of light rays through the smaller aperture. For that reason also with
non-telecentric lenses this plane where the aperture is located is called a
pupil plane.
With the physical optics of the following section, this pupil plane will further
prove to be a very important area to determine the quality of an imaging
system.
7.3.5.2
Practical Applications and Constraints
The shown example with only two positive lenses represents an almost ideal
situation. When a diÔ¨Äerent number of elements are used like in Figure 7.30,
there is not always a joint focal point deÔ¨Åned. In those cases still single-
telecentricity can be created, depending on the location of the aperture stop

7.3. Geometric Optics
639
inside the lens system.
The Ô¨Årst possibility is an object-space telecentric system, where the aperture
stop is located at the Ô¨Årst focal point inside the system when entering from
the object side. In that case the entry-pupil is located at inÔ¨Ånity.
An example of such an object-space telecentric lens is the measurement
microscope from Chapter 3. A small displacement in the vertical direction
is not allowed to cause an error in the measurement of the object size and
object-space telecentricity prevents this error.
The second possibility is an image-space telecentric system, where the aper-
ture stop is located at the Ô¨Årst focal point inside the system when entering
from the image side. This causes the exit-pupil to be located at inÔ¨Ånity.
Image-space telecentric lenses are preferred in digital photography cameras.
Non-telecentricity at the image sensor has as consequence that the cone of
light to the image is not symmetric around a paraxial ray but tilted under
an angle with the optical axis. This can lead to image artifacts, due to
the stack of a colour Ô¨Ålter and multi-lens array before the image sensor.
Only an image-space telecentric lens guarantees that for instance no red
light ends up at a blue sensor element. Practical photographic lenses can
only approximate telecentricity, because of size constraints and the need to
adapt to objects located in a wide range of distances from the lens. Perfect
telecentricity would require that at any position on the image sensor a full
symmetric cone of light could be delivered by the objective. With the shown
example of Figure 7.31, this requirement would imply that L2 would need
to be much larger than the image sensor and this size would certainly not
Ô¨Åt in a normal camera with a full frame sensor of 24√ó36 mm. As a result
vignetting would occur, a darkening of the outer part of the image. With
a smaller sensor like the APS-C type of 23 √ó 15 mm, the telecentricity is
more easily to approach without increasing vignetting. The telecentricity of
a camera lens can be checked by estimating the distance of the exit-pupil
when looking at the image side through the lens. It should be as far away
as possible but will in most cases not be located much further away than
half-way the lens.

640
Chapter 7. Optics in Mechatronic Systems
7.4
Physical Optics
One of the models to describe the properties of light was shown to be based
on the theory of electromagnetic wave propagation.
In Chapter 2 it was explained that electromagnetic waves consist of a combi-
nation of two oscillating orthogonal vector Ô¨Åelds, an electric E and a magnetic
B Ô¨Åeld. In Chapter 5, the interrelation between magnetic and electric Ô¨Åelds
was deÔ¨Åned by Faraday‚Äôs and Amp√©re‚Äôs law of the Maxwell equations and
these laws are used in dedicated modelling software for the calculation of the
real properties of light in optical systems. In this section the wave character
of the light is used to explain the performance of optical systems without
extensive calculations. Instead, graphical representations will be used of
only one of the two interrelated vector Ô¨Åelds. The electric E-Ô¨Åeld is often
chosen for this purpose and is presented graphical as a sine wave.
An unfortunate fact that is encountered in analysing the physical properties
of optics, is caused by the extreme temporal frequency of the related elec-
tromagnetic waves. Electric or magnetic oscillating Ô¨Åelds with frequencies
in the order of 1015 Hz are impossible to measure directly. As mentioned
before, only the average optical irradiance Ir can be detected by means of
photo detectors, which convert the related Ô¨Çow of photons into an electric
current.
The irradiance of an electromagnetic wave is proportional to the power of
the sinusoidal electric Ô¨Åeld, given by the following expression:
Ir = cnœµ0E2
rms = cnœµ0
2
ÀÜE2
W/m2
.
(7.24)
In the following subsections, Ô¨Årst the concept of polarisation is introduced,
because this concept is widely used in optical measurement systems. This
is followed by the explanation of the interference eÔ¨Äects of the interaction
between diÔ¨Äerent waves and the theory on diÔ¨Äraction and gratings. The
section will be completed by deriving the diÔ¨Äraction limited resolution of an
optical system, where the inÔ¨Çuence of the capture angle on the quality of
the image will be demonstrated.
7.4.1
Polarisation
The polarisation of an electromagnetic Ô¨Åeld is based on its transversal char-
acter and deÔ¨Ånes in which direction the electric Ô¨Åeld is oscillating. To see
what this means, the electric Ô¨Åeld of the light is represented in the 3D
vectorial graph of Figure 7.32. It applies an orthogonal coordinate system,

7.4. Physical Optics
641
x
y
z
x
y
z
Figure 7.32: The electric Ô¨Åeld of linear polarised light, represented in an orthogonal
coordinate system, deÔ¨Åned by x in the direction of propagation of the
wave and y, z under 45¬∞with the polarisation direction of the electric
Ô¨Åeld. The projection on the y ‚Äì z plane is a line. in the upper part
the y and z components are in phase while in the lower part they are
180¬∞out of phase. Shifting the phase of one of the components with
180¬∞results in a rotation of the polarisation direction of 90¬∞on the y ‚Äì z
plane.
with x being the direction of propagation.
In this example, the Ô¨Åeld oscillates in one direction and the coordinate
system is chosen such that the oscillation direction is under 45¬∞with the y
and z axis.

642
Chapter 7. Optics in Mechatronic Systems
The components of the wave in the x ‚Äì y, y ‚Äì z and x ‚Äì z plane are deduced by
simple projection. Projection of the wave in the y ‚Äì z plane gives a straight
line, for which reason this oscillating electric Ô¨Åeld is called linear polarised.
The amplitude of each component in the x ‚Äì y and x ‚Äì z plane depends on
the polarisation direction in respect to the chosen coordinate system, which
in this example results in an equal amplitude.
The polarisation direction of the light emitted from a light source is de-
termined by its origin and generally normal light sources like a light bulb
or the sun are ‚Äúrandomly polarised‚Äù. This means that there is hardly any
phase relationship. In order to create a linearly polarised light source, a po-
lariser can be used, an optical element that only transmits the polarisation
component of the light that corresponds to the orientation of the polariser.
Polarisation is created in nature at reÔ¨Çecting surfaces, because the reÔ¨Çection
of an electromagnetic wave is depending on the polarisation direction rela-
tive to the orientation of the reÔ¨Çecting surface. Light polarised in the plane
of incidence, deÔ¨Åned by the normal and the propagation direction, is called
p-polarised light and reÔ¨Çects less than light polarised in the orthogonal
direction, the s-polarised light. This eÔ¨Äect is maximum at the Brewster‚Äôs
angle œëB = arctan(n2/n1), which for glass amounts to ‚âà56¬∞. For this reason
sunglasses with polarising glass reduce the eÔ¨Äect of reÔ¨Çected light from the
sea or other reÔ¨Çecting surfaces that has become polarised by the reÔ¨Çection.
A laser can be made to emit only one polarisation direction by inserting
a quartz plate at the brewster angle inside the resonating chamber. The
stimulated excitation will result in photons that behave in the frequency-
domain as having almost the same frequency, phase and polarisation as the
photon that caused the excitation. Especially a well designed Helium Neon
laser can create an almost ideal polarisation that can be used in position
measurement systems as will be presented in the Chapter 8.
7.4.1.1
Birefringence
It is often observed that the propagation speed of light inside a transparent
material depends on the polarisation direction. This optical anisotropy is
called birefringence and is caused by the atomic structure of the material.
Especially crystalline materials show this property. Birefringent materials
can be used to change the polarisation direction of light by inserting a cer-
tain length of this material in the beam. Starting with linear polarised light
the anisotropic directions of this birefringent material need to be orientated
under 45¬∞with the polarisation direction of the light according to the coordi-
nate system from Figure 7.32. As a result both polarisation components of

7.4. Physical Optics
643
x
y
z
Figure 7.33: Elliptical polarised light. When the y component relative to the z
component of the electric Ô¨Åeld of an electromagnetic wave is slightly
diÔ¨Äerent from 180 or 0¬∞the projection of the electric Ô¨Åeld in the y ‚Äì z
plane becomes an ellipse.
the wave will no longer have the same phase relationship because one of
them is delayed in respect to the other. What this means is illustrated in
Figure 7.33 where the phase diÔ¨Äerence between both components is slightly
less than 180¬∞. As a result the projection of the combined wave on the y‚àíz
plane will no longer be a straight line but elliptical. For this reason this
electric Ô¨Åeld is called elliptical polarised. The ellipticity is depending on the
phase diÔ¨Äerence and in case the phase diÔ¨Äerence is +/- 90¬∞the projection
on the y‚àíz plane becomes a circle, as shown in Figure 7.34. This circular
polarised light will give an equal amplitude of the projection in any direction
independent of the chosen coordinate system. One can visualise the propa-
gation of a circular polarised vector Ô¨Åeld as a rotating vector v originating
at a point O on the centre line of a perfectly symmetrical spiral pointing
in the propagation direction. The rotation direction of the spiraling vector
depends on the sign of the phase diÔ¨Äerence, which means that two diÔ¨Äerent
versions of elliptical or circular polarised light exist.

644
Chapter 7. Optics in Mechatronic Systems
x
y
z
O
v
Figure 7.34: Circular polarised light. When the phase relationship between the y
and z component of the electric Ô¨Åeld of an electromagnetic wave equals
90¬∞, the projection of the electric Ô¨Åeld in the y ‚àíz plane becomes a
circle. The spiral can rotate left or right handed depending whether
the phase diÔ¨Äerence is positive or negative.
Polarisation is more complicated than explained in this summary but this
basic understanding is suÔ¨Écient to model optical systems for engineering
purposes. In Chapter 8 the manipulation of the polarisation direction by
using thin plates of birefringent material will be applied to enable the
realisation of very accurate incremental optical measurement systems.
7.4.2
Interference
In Chapter 2 it was shown that the momentary values of diÔ¨Äerent Ô¨Åelds at
a certain location can be added together. When two beams of light with an
equal wavelength are combined, the resulting combination will show inter-
ference eÔ¨Äects. These eÔ¨Äects are determined by the electric Ô¨Åeld amplitude
ÀÜE and phase diÔ¨Äerence œï of both beams of light.
For two beams with an equal Ô¨Åeld amplitude, the eÔ¨Äect of the phase dif-
ference is expressed mathematically as follows: When the electric Ô¨Åeld
magnitude of both beams is given by E1 = ÀÜEsin(œât) and E2 = ÀÜEsin(œât+œï), the

7.4. Physical Optics
645
 = 0
I   = 4 I
 =  
I   =  0
 = 0.5 
I   = 2 I
 = 0.75 
I   = 0.6 I
r
r
r
r,c
r,c
r,c
r,c
Figure 7.35: Interference between two waves with the same wavelength and ampli-
tude but diÔ¨Äerent phase. The resulting electric Ô¨Åeld amplitude can
range between zero and twice the amplitude of each wave giving a
combined irradiance Ir,c of maximum four times the irradiance Ir of
each wave.
combined electric Ô¨Åeld becomes:
Ec = ÀÜE

sin(œât)+ sin(œât+œï)

= 2 ÀÜE

sin

2œât+œï
2

cos
‚àíœï
2

= 2 ÀÜEcos
œï
2

sin

œât+ œï
2

V/m

.
(7.25)
First of all it can be concluded that the phase of the resulting wave is the
average of the phase of both waves.
Secondly the amplitude becomes twice the value of the amplitude of one
beam, when œï = 0, and zero, when œï = œÄ or 180‚ó¶. This is shown in Figure 7.35,
where the upper graph shows the situation, when œï = 0. This situation where
both amplitudes add to a double amplitude is called constructive interference.
The lower graph shows the eÔ¨Äect of destructive interference with œï = 180‚ó¶,
where both amplitudes cancel each other.

646
Chapter 7. Optics in Mechatronic Systems
When measuring the resulting electric Ô¨Åeld, only the irradiance can be
observed. The irradiance can be determined by using the amplitude term of
Equation 7.25 in Equation (7.24):
Ir,c = cnœµ0
2
ÀÜE2
c = cnœµ0
2

2 ÀÜEcos
œï
2
2
= 2cnœµ0 ÀÜE2 cos2 œï
2

W/m2
.
(7.26)
After expanding the squared cosine term with its trigonometric identity,
this equation becomes:
Ir,c = 2cnœµ0 ÀÜE2

1+cosœï
2

= cnœµ0 ÀÜE2 
1+cosœï

W/m2
.
(7.27)
The resulting irradiance of the combined electric Ô¨Åeld varies between 2cnœµ0 ÀÜE2,
when œï = 0+ n¬∑2œÄ, and zero, when œï = œÄ+ n¬∑2œÄ, with the integer n ‚â•1.
The irradiance of the separate Ô¨Åelds is equal to:
Ir,1 = Ir,2 = Ir = cnœµ0 ÀÜE2
2
W/m2
.
(7.28)
This irradiance level is a factor four below the irradiance level of the com-
bined Ô¨Åelds at full constructive interference. This is caused by the squared
relation between the double amplitude of the combined Ô¨Åelds and the ir-
radiance. This result seems to be contradicting to the law of conservation
of energy but in reality an optical system that shows constructive interfer-
ence will also show an equal amount of destructive interference at another
location. The energy from the destructive interference area will add to
the energy at the other area and the total energy within the system is not
changed. This eÔ¨Äect will be mentioned at diÔ¨Äerent occasions in the following
pages.
7.4.2.1
Fabry-Perot Interferometer
Interference is frequently used in optical measurement systems to deter-
mine distances and shapes of objects. As an example two beams of light
that originate from the same coherent light source are guided over two
diÔ¨Äerent paths, one Ô¨Åxed and one changing, to one sensor location where
they interfere with each other. The irradiance of the re-combined beams
becomes determined by their path diÔ¨Äerence, which induces a timing or
phase diÔ¨Äerence. By measuring the combined irradiance, the change in the
length of the second path can be determined.
This measurement principle is called an interferometer. Many versions of an
interferometer exist and in the next chapter the Michelson interferometer

7.4. Physical Optics
647
$
2
r
d
$

Mirror 1
Mirror 2
Transmission
Wavelength
100 %
Figure 7.36: Fabry-Perot interferometer consisting of two parallel mirrors at a
Ô¨Åxed distance. The upper graph shows the situation where the dis-
tance of the mirrors equals an integer number of half the wavelength
of the light resulting in a high transmission because of optical reso-
nance. In the middle graph part the wavelength does not ‚ÄúÔ¨Åt‚Äù between
the mirrors so the transmission is zero. the lower graph shows the
transmission as function of the wavelength where the black trace
corresponds to a low Ô¨Ånesse and the red trace with a higher Ô¨Ånesse.
will be introduced to measure distances. Here the Fabry-Perot interferome-
ter is further investigated as an example as this principle was previously
presented as the optical resonator for increasing the coherence of a laser.
Figure 7.36 shows the principle of a Fabry-Perot interferometer. Two mirrors
are positioned perfectly parallel at a Ô¨Åxed distance. Mirrors have always
some transmission. A full 100 % reÔ¨Çection is not possible so some photons
will pass the Ô¨Årst mirror and enter the cavity between the mirrors, where
most of them will be reÔ¨Çected at the second mirror back to the Ô¨Årst mirror,
reÔ¨Çected again and so on.
Something special occurs when the distance d of the mirrors equals an
integer (r) number of half the wavelength of the light (d = rŒª/2), because of
their wave behaviour. In that case the reÔ¨Çected light at the left entry-mirror
will show constructive interference with the light just entering the cavity

648
Chapter 7. Optics in Mechatronic Systems
and as a result a standing wave occurs.
This standing wave manifests itself as if the interferometer becomes fully
transparent for that wavelength as shown in the upper half of the Ô¨Ågure.
Other frequencies that do not fulÔ¨Ål the requirement Œª = 2d/r, will result
in less constructive or even destructive interference and can not pass the
interferometer, depending on the amount of destructive interference. This
system acts like an optical notch Ô¨Ålter.
The capability of this Ô¨Ålter to distinguish diÔ¨Äerent wavelengths is called
Ô¨Ånesse and is determined by the ratio between reÔ¨Çection and transmission
of the mirrors of which the interferometer is made. When the transmission
is large also many other frequencies will pass, because there is hardly any
internal reÔ¨Çection, which would cause destructive interference. This is for
instance the case with glass in a normal window. On the other hand, the
more the mirrors become ideal reÔ¨Çectors the less other frequencies will pass.
A special version of a Fabry-Perot interferometer is the dichroic coating,
which is used to prevent reÔ¨Çections on a lens or increase reÔ¨Çections on a
mirror. It consists of many thin layers of material with a diÔ¨Äerent refractive
index that each determine a very small cavity tuned to a speciÔ¨Åc frequency.
By combining a multitude of layers it is possible to either create an optical
Ô¨Ålter with a very high Ô¨Ånesse or a more wide-band behaviour like with
photographic lenses.
7.4.3
DiÔ¨Äraction
The famous Dutch scientist Christiaan Huygens (1929 ‚Äì 1695) postulated
in his work Trait ¬¥e de la lumi `ere that wave propagation takes place because
every point of incidence of a wave will act as a source of a new spherical wave
with the same spatial frequency in phase with the original wave. With a
multitude of these kind of sources he could construct the resulting wavefront
of light by connecting the wavefronts of each individual source, while having
by deÔ¨Ånition the same phase. A Ô¨Çat wavefront would then consist of an
inÔ¨Ånite amount of separate wavefronts, where only the parallel plane to
the original wavefront would satisfy this phase relationship. His theory
was later rejected for reason of not suÔ¨Écient validity in all cases and the
particle based theory with photons was found more suitable. Nevertheless
the theory of Huygens was not so wrong and it can be used to model the
eÔ¨Äect of diÔ¨Äraction of light at a grating in a graphical way.

7.4. Physical Optics
649
0th order
p
p

1storder
2nd order
-1storder
-2nd order
1
Figure 7.37: DiÔ¨Äraction of light at a transmissive amplitude grating. The holes or
slits behave like separate light sources with a Ô¨Åxed phase relationship,
determined by the incoming wavefront. By drawing lines tangential
to the circles with equal phase of all slits, the wavefront of a diÔ¨Ärac-
tion order is found. In the intermediate directions, wavefronts with
an opposite sign result in destructive interference The angles of the
resulting diÔ¨Äraction orders depend on the ratio between the distance
of the holes (p) and the wavelength of the light. Only for the 2nd order
all tangential lines, connecting the wavefronts of the three holes, are
shown.
7.4.3.1
Amplitude gratings
A Ô¨Årst example of a diÔ¨Äraction grating is the transmissive amplitude grating
as shown in Figure 7.37. The name is based on the property of this grating
that light from an area with a high electric Ô¨Åeld amplitude is combined
with light from a low electric Ô¨Åeld amplitude. The grating in this example
consists of three very small parallel slits that are deÔ¨Åned orthogonal to the
plane of sight in a further completely opaque plate.
A Ô¨Çat wavefront of light with only one wavelength is drawn parallel to the
grating, approaching this grating from below5.
According to Huygens this incoming light will create separate sources of
5Always remember that a wavefront drawing is a snapshot of a normally travelling wave
of the electromagnetic Ô¨Åeld of light. It is used in all examples of diÔ¨Äraction only to show the
phase relationship between the diÔ¨Äerent light waves

650
Chapter 7. Optics in Mechatronic Systems
light at the slits with equal amplitude and phase. Orthogonal to the plane
of sight these sources create a line source so the resulting wavefront will be
like a cylinder of which only the cross section is shown in the Ô¨Ågure.
The resulting wavefronts are found by connecting the wavefronts of the
diÔ¨Äerent line-sources that are mutually in phase. Several favourable ver-
sions of these tangential lines can be found as is shown in the Ô¨Ågure. The
orthogonal directions to each of these tangential lines are directions where
the light from all sources interfere in a constructive way and light will be ob-
served in those directions. The other directions in between show destructive
interference as both light with a positive and a negative phase is combined.
As a result, the diÔ¨Äraction at this grating manifests itself as a series of
separate light beams under an angle œë, determined by the wavelength of
the light and the distance of the slits in the grating. These separate beams
are called diÔ¨Äraction orders with increasing number when starting from the
optical axis. In principle the diÔ¨Äraction is mainly observed at some distance
from the slits, the far Ô¨Åeld. At a closer distance the amplitude of the Ô¨Åeld of
each slit at the location of observation will be diÔ¨Äerent and at a distance
in the order of the period of the grating, the light of only one slit will be
observed to be propagating in all directions.
From the Ô¨Ågure it can be concluded that the angle between the orders will
be larger with a larger wavelength and/or a shorter periodic distance of the
slits. This relation can be derived by trigonometry, which results in:
œëN = arcsin NŒª
p
[rad].
(7.29)
where Œª is the wavelength of the light, p is the periodicity of the grating
(distance of the centres of the slits) and N is an integer, equal to the order
number. N can be positive and negative, which means that the diÔ¨Äraction
occurs at two sides. It can be noted that the maximum number of orders
equals the ratio between p and Œª as the value of a sine is limited to one.
When using light of diÔ¨Äerent wavelengths, diÔ¨Äraction would result in spatial
separation of the diÔ¨Äerent wavelengths, giving the colouring eÔ¨Äects with
visible light as for instance can be observed when looking to a CD-disk.
It is also true that a larger irregular grating, consisting of a number of
sub-gratings with diÔ¨Äerent periodic distances, would result in spatial sepa-
ration of the diÔ¨Äracted parts that belong to the diÔ¨Äerent sub-gratings, even
with one wavelength of light. The shorter periodic distances will have a
larger diÔ¨Äraction angle than larger distances. A shorter periodic distance
corresponds to a higher spatial frequency of the grating lines. The fact that
diÔ¨Äraction distinguishes areas with diÔ¨Äerent spatial frequencies will be
used later when analysing the imaging quality of an optical system.

7.4. Physical Optics
651
The optical eÔ¨Äect of the transmissive amplitude grating with transparent
slits in an opaque plate is also observed with a reÔ¨Çective amplitude grating.
In that case the light approaches the grating from above, while the slits
are replaced by reÔ¨Çecting stripes on a non reÔ¨Çecting surface. The reÔ¨Çective
stripes will each act as a source of light like the slits of a transmission grat-
ing and the resulting diÔ¨Äraction orders can be determined in an identical
way.
7.4.3.2
Phase Gratings
Amplitude gratings have one disadvantage, as they reduce the total amount
of light by the opaque or absorbing part of the surface. This property limits
the maximum reÔ¨Çectivity or transmissivity to approximately 50 %.
One might decrease the loss of light by making the slit wider than the
opaque part, but then the interference will be less. Ultimately the object
becomes just transparent or reÔ¨Çective, which was not the aim of the grating.
Fortunately the 50 % loss of light can be avoided by using a phase grating.
In its reÔ¨Çective form, this kind of grating consists of a row of connected
reÔ¨Çective stripes alternating at two diÔ¨Äerent heights.
ReÔ¨Çective Phase Grating
A phase grating is a bit more complicated to model than an amplitude
grating. The main reason for the complexity is the fact that the height
in relation to the wavelength determines the irradiance ratio between the
diÔ¨Äerent orders. The principle will be explained in two ways. First the same
wavefront and phase relations are used as with the amplitude gratings. The
second method uses the complete wavefront over the entire surface of the
grating.
The example conÔ¨Åguration for the explanation, as shown in Figure 7.38, is a
special version of a phase grating, where the height diÔ¨Äerence of the steps in
the grating equals exactly a quarter of the wavelength of the perpendicular
incoming light. In that case, the orthogonally reÔ¨Çected light coming from
a high area will have a 180¬∞phase diÔ¨Äerence to the reÔ¨Çected light from a
low area, as the latter has to travel two times the height of the grating.
This optical path diÔ¨Äerence results in a phase diÔ¨Äerence of Œª/2 between the
light reÔ¨Çected by both areas. When these areas have an equal surface, the
resulting light at the far Ô¨Åeld in the 0th order direction will be cancelled out
by destructive interference.
Knowing that energy can not get lost and no dissipation takes place, the

652
Chapter 7. Optics in Mechatronic Systems
0th order
p
0.25
1storder
-1storder
Incoming light

 1
Figure 7.38: DiÔ¨Äraction at a reÔ¨Çective phase grating, illuminated perpendicular
to the surface. Light, reÔ¨Çecting straight back from the bottom of the
grating, has to pass two times Œª/4 more distance than light reÔ¨Çecting
from the top. These two will then have Œª/2 = 180¬∞phase relationship,
so destructive interference occurs at the far Ô¨Åeld and no light will be
reÔ¨Çected in the 0th order direction. Under an angle the path diÔ¨Äerences
cancel out, so constructive interference occurs, as can be observed from
the tangential lines of equal phase.
light should show an equal constructive interference in another direction
and indeed, at a certain angle, the travelled distances will be equal again
for all light coming in orthogonal and parting in that diÔ¨Äraction direction
as can be seen with the tangential lines of equal phase in the Ô¨Ågure.
Identical to the previously explained transmission grating this diÔ¨Äraction
angle is equal to Equation (7.29):
œëN = arcsin NŒª
p
[rad].
(7.30)
This means that also with a phase grating higher order diÔ¨Äraction angles
occur, but in practice the geometry of the grating is often chosen such that
these higher orders are limited to N = ¬±1 or only have a very low irradiance.
Although only the eÔ¨Äect of one point in the middle of each surface is shown,
this point is representative for the entire grating as for every point on the
low area a corresponding point at the high area can be found that combines
in the same way. By integration the total eÔ¨Äect can be determined and
with the second method to explain the working principle of the transmissive
version of a phase grating, the total surface is used.

7.4. Physical Optics
653
The total amount of light is retained, because of the fact that with a phase
grating no absorbing surface is present.
Violating the Law of ReÔ¨Çection?
Several readers might wonder if reÔ¨Çective phase gratings can work at all
with a real mirroring surface. With real measurements on these gratings
it indeed appears that the reÔ¨Çected light will act diÔ¨Äerent than would be
expected by applying the law of reÔ¨Çection, which was derived in Section 7.2.
Figure 7.39 shows the reÔ¨Çection at a mirror and a grating. At Ô¨Årst sight only
the middle part of a large mirror is needed for reÔ¨Çection and the photons
emitted by the source in other directions are not useful and can never reach
the point of observation.
With a grating surface however, this is no longer true as the photons can
be reÔ¨Çected in the diÔ¨Äraction orders even with a mirrored surface. This
is due to the fact that the simple wave theory is not suÔ¨Écient to explain
everything. Although the method of least time is useful, another method is
needed to explain what really happens at a mirrored grating. Again, like
also mentioned in Section 7.2, the theory of light acting as particles helps
for this explanation.
In a nutshell this theory states that photons in principle can follow all kind
of diÔ¨Äerent paths to a target point of observation. The probability of a
certain path to this location is however determined by the question whether
other photons from the same source, arriving at that location via diÔ¨Äerent
paths, all have an equal time relation to their temporal periodicity (read,
the same phase). For a reÔ¨Çective grating this means that a photon that
is reÔ¨Çected at one high step should have the same phase at the point of
A
Mirror
B
O
6$$
1     2      3
Figure 7.39: With a reÔ¨Çective phase grating, light can be reÔ¨Çected by a diÔ¨Äerent
location than determined by the law of reÔ¨Çection, as long as the phase
is equal for the diÔ¨Äerent paths (1,2,3) of the grating.

654
Chapter 7. Optics in Mechatronic Systems
observation as any other photon from the same source reÔ¨Çected by another
high area.
This again is an example of a theory that as such is not understandable,
because how can a photon know anything about its colleagues, before it is
arrived at the point of observation?
Nevertheless the theory is useful as it perfectly predicts their behaviour.
Transmission Phase Grating
A transmissive version of the phase grating can be realised in a transparent
plate by a similar surface proÔ¨Åle as shown with the reÔ¨Çective phase grating.
In this case however the height of the steps is diÔ¨Äerent from the reÔ¨Çective
phase grating, in order to obtain the same eÔ¨Äect.
When no light in the 1st order is allowed, a larger step size is needed in order
to create the necessary Œª/2 phase diÔ¨Äerence between the photons that pass
through the area with a shorter optical path length and the photons that
pass through the area with a longer optical path length. This means that
0th order
p
1st order

\
interference
n = 1.5
n = 1
]
interference
Air
Glass
Figure 7.40: DiÔ¨Äraction at a transmission phase grating, illuminated from below
perpendicular to the surface. The step size is such that in air (n = 1) it
equals one wavelength and in the high index material like glass with
n = 1.5 it equals 1.5 times the wavelength. In the 0th order direction
this results in two wavefronts with 180 phase diÔ¨Äerence that cancel
each other out while simultaneously the 1st order direction does not
show any phase diÔ¨Äerence.

7.4. Physical Optics
655
the height is depending on the refractive index of the transparent material.
Figure 7.40 shows such a grating and its principle is explained by using the
second method with the full surface. With this method, the transmitted
wavefronts are drawn as if they remain Ô¨Çat, instead of a point source with a
circular wavefront. This is the extreme other side of the approximation and
shows to give the same result. In this example, the step size is chosen such
that its height corresponds to one wavelength in air and 1.5 wavelength
in the high index material, like glass with n = 1.5. When observing the
0th order the wavefronts from the high and low areas have a 180¬∞phase
diÔ¨Äerence and at the far Ô¨Åeld these wavefronts will cancel each other out
by destructive interference. This is fully comparable with the eÔ¨Äect of the
reÔ¨Çective phase grating.
Phase Shifting
The transmission phase grating is more easy to visualise in a drawing than
the reÔ¨Çective phase grating, because in transmission the incoming light
and the diÔ¨Äracted light are at diÔ¨Äerent sides of the grating. For that reason
the important phase behaviour of a phase grating at diÔ¨Äerent step sizes
is better explained with transparent phase gratings, while the following
reasoning is also valid for reÔ¨Çective phase gratings.
It was shown in Equation (7.25) that the phase of two interfering waves with
equal magnitude will equal the average of the phase of the two waves. For
the phase grating of Figure 7.40 this means that the phase of the resulting
wave of the 0th order would be 90¬∞diÔ¨Äerent from each interfering wave, even
though the amplitude would be zero. The phase of the 1st order wave would
be in phase with both interfering waves.
It is even more interesting to see what happens, when the step size is
diÔ¨Äerent from the above example. This is shown in Figure 7.41. The upper
graph shows the previous situation where the 0th order is cancelled with
90¬∞phase diÔ¨Äerence and the 1st order is in phase with both waves. When the
step size is changed, as shown in Figure 7.41 b: and c:, the phase of the wave
through the high area is less delayed in respect to the wave through the low
area. As a result both orders get a partial positive phase shift. With a
smaller step size, the phase diÔ¨Äerence between the interfering waves in the
0th order direction will be less than 180‚ó¶. Consequently the magnitude of
the irradiance of the resulting wave will no longer be zero, while the phase
delay will be less then 90‚ó¶. At the same time also the waves in the 1st order
direction will be less perfectly in phase, resulting in a phase diÔ¨Äerence of the
resulting wave and a smaller magnitude of the irradiation. Ultimately when

656
Chapter 7. Optics in Mechatronic Systems
0th order
1st order
n = 1.5
n = 1
n = 1.5
n = 1.5
n = 1
n = 1
Average wavefront
Average wavefront
a: Stepsize 1¬∑ in air, 1.5¬∑in glass.
b: Stepsize 0.66¬∑ in air, , 1¬∑in glass.
c: Stepsize 0.33¬∑ in air, 0.5¬∑in glass.
Air
Glass
Air
Glass
Air
Glass
o
0.25¬∑ = 90
{
6
o
< 90
6
Figure 7.41: By varying the step size of the phase grating, the magnitude and
phase of the 0th and 1st order is also varied. A reduced step height (b:
and c:) results in a phase advancement of both orders. The irradiance
of the orders shifts from 100 % in the 1st order at a: to ultimately
100 % in the 0th order, when the step size would be zero.
the step size is zero the phase grating will be just a transparent plate again,

7.4. Physical Optics
657
only transmitting light in the same direction as the incoming light. With
the reÔ¨Çective version of the phase grating this ultimate situation would
simply be a Ô¨Çat mirror.
As a result of this reasoning, the phase of the 0th order will always remain
delayed relative to the phase of the 1st order diÔ¨Äracted wave. While the delay
of 90¬∞from the 0th order relative to the incoming light gradually reduces to
zero, the phase of the 1st order will gradually shift to a positive 90¬∞diÔ¨Äerence
with the incoming light. Regarding the magnitude, following the law of
conservation of energy, the sum of the irradiance of the diÔ¨Äerent orders
always remains equal to the irradiance of the incoming light as the size of
the beams is not aÔ¨Äected by the grating. By choosing the right height it is
for instance possible to create a grating with the same irradiance for the 0th
and the two 1st order beams. In that situation the phase shift of both orders
should be equal. A small approximating calculation shows the eÔ¨Äect using
Equation (7.27) in a simpliÔ¨Åed form:
Ir,o = Ir,i

1+cosœï
2

W/m2
.
(7.31)
with Ir,o equaling the irradiance of an output order and Ir,i being the irra-
diance of the incoming light. When the light going into higher orders is
estimated to be about 25 % of the total irradiance, which is a realistic Ô¨Ågure,
then 25 % is available for each of the three main orders. This level requires
the cosine term to be equal to 0.25 for all three orders, resulting in a phase
angle of:
œï = arccos(2¬∑0.25‚àí1) ‚âà120‚ó¶.
(7.32)
This means for the 0th order that the phase diÔ¨Äerence between the interfering
waves equals 120¬∞and as a consequence the (negative!) phase shift of the
0th order after interference becomes half of that value equaling ‚àí60‚ó¶relative
to phase of the incoming light. For the 1st order the phase is shifted in the
positive direction with the same value of 60‚ó¶relative to 0¬∞.
The phase diÔ¨Äerence of 120¬∞in this special phase grating proves to be very
useful in the advanced interferometry encoders that will be presented in
Chapter 8.

658
Chapter 7. Optics in Mechatronic Systems
7.4.3.3
Direction of the Incoming Light
The shown examples all had a strictly deÔ¨Åned direction of the incoming
beam of light, orthogonal to the surface and one may wonder what happens,
when the light approaches the grating from another direction.
In principle, with a reÔ¨Çective grating, a beam with an angle of incidence œë
results in a 0th order directed with a same angle œë opposite to the normal
fully according to the laws of reÔ¨Çection. In fact as a Ô¨Årst-order approxima-
tion the geometric eÔ¨Äect just linearly combines with the diÔ¨Äraction eÔ¨Äect.
In reality a large angle of incidence of the incoming light will cancel out
certain diÔ¨Äraction orders that would otherwise be directed into the reÔ¨Çecting
material while other orders appear at the opposite side of the normal. The
interested reader can derive this when drawing the diÔ¨Äerent graphs for
other light directions.
One consequence of this reasoning is that the eÔ¨Äect works in two directions.
With for instance a reÔ¨Çective amplitude grating, light that enters under an
angle corresponding to the 1st order will be reÔ¨Çected mainly in the direc-
tion of the 0th order. This reverse eÔ¨Äect can also be explained by reasoning
that the optical path lengths for photons going in the opposite direction are
equal, resulting in equal travelling time and an equal phase for their wave
property.
With transmission versions of the diÔ¨Äerent gratings in principle the same
reasoning is valid as long as the transparent part is planar, without optical
strength or wedge form. Otherwise the angle should be corrected for these
eÔ¨Äects.
7.4.4
Imaging Quality based on DiÔ¨Äraction
In a purely physical manner, an optical object can be approximated as an
accumulation of spatially separated area‚Äôs with a diÔ¨Äerent irradiance. This
irradiance can either originate from local light sources like is the case with
a TV-screen or by transmitted or reÔ¨Çected light from a separate source.
It was shown in the previous section on physical optics that evenly spaced
illuminated lines alternated with dark lines behave like a grating and create
separate beams of light under an angle depending on the wavelength of
the light and the distance of the lines as given by Equation (7.29) which is
repeated here:
œëN = arcsin NŒª
p
[rad].
(7.33)

7.4. Physical Optics
659
Object
Image
1st
0th order
2nd
3rd
-1st
-2nd
-3rd

p
Irradiance
Irradiance
Illuminaon
Pupil plane
Figure 7.42: Imaging of a transparent grating with a square wave irradiance pro-
Ô¨Åle illuminated perpendicular to the grating from the left. It shows
that the higher diÔ¨Äraction orders, which represent the spatial high
frequency content of the image are located at the pupil plane further
away from the optical axis.
A small distance between the lines is equivalent to a high density of the lines.
This density is expressed in the spatial frequency f of the lines, deÔ¨Åned as a
number of lines per unit of length (1/m). Similar to electrical signals, the
spatial frequency distribution of an optical object can be analysed by means
of a Fourier series expansion. Application of the Fourier series expansion to
a periodic optical signal with a spatial frequency f results in its sinusoidal
harmonics, each with a spatial frequency n¬∑ f . Figure 7.42 shows what this
means, when imaging an object that consists of opaque and transparent
stripes at equal distance. It is a transparent amplitude grating, illuminated
from the left perpendicular to the grating.
For this example a double-telecentric imaging system is taken for reason of
simplicity but the following reasoning is applicable for all imaging systems.
Starting at the left side, diÔ¨Äraction orders are generated at the grating,
which are captured by the optical system. In the pupil plane these orders
all cause parallel beams of light, the higher order beam further away from
the optical axis than the lower order beam. After the second lens these
beams recombine to the image. This image has the same shape as the
object at a diÔ¨Äerent size, because of the demagniÔ¨Åcation in this example.
The higher irradiance at the image is caused by the law of conservation of
energy, smaller details will show a higher irradiance.
With diÔ¨Äraction theory it was shown that the angle œë between the diÔ¨Ärac-
tion orders equals arcsinnŒª/d, which means that a higher spatial frequency
(smaller d) should correspond to a larger angle. This is exactly what is ob-
served when the image side is compared with the object side of the system.

660
Chapter 7. Optics in Mechatronic Systems
Object
Image
1st
0th order
2nd
3rd
-1st
-2nd
-3rd
Irradiance
Irradiance
Illuminaon
Pupil plane
Figure 7.43: Imaging of a transparent grating with a square wave irradiance pro-
Ô¨Åle with a small aperture stop at the pupil plane showing the spatial
low-pass Ô¨Åltering of an optical system when blocking the higher diÔ¨Ärac-
tion orders.
What is not shown, because the Ô¨Ågure is erroneous to that respect, is the
eÔ¨Äect of the missing higher orders that are not captured by the lens. With
a real optical system a decrease in steepness and amplitude of the irradi-
ance proÔ¨Åle of the image would be observed. This eÔ¨Äect is illustrated in
Figure 7.43 where a smaller aperture is inserted at the pupil plane in the
optical system, cutting oÔ¨Äall but the 0th and 1st order. The diÔ¨Äraction orders
created by the square wave irradiance proÔ¨Åle each represent a diÔ¨Äerent
harmonic of the spatial frequency. The 0th order represents the average
light irradiance so the DC value of the image, a0 from the Fourier series
expansion. The 1st order represents the sinusoidal spatial frequency of the
image and the higher orders represent the higher frequency components.
It is useful to highlight some diÔ¨Äerences because optical signals are a bit
diÔ¨Äerent from electrical signals. First of all, negative signal values do not
exist for the irradiance as being the magnitude of the electric Ô¨Åeld squared.
This means that when there is an image, there is always an average irradi-
ance value and consequently the 0th order is never zero. Secondly the higher
optical orders correspond to the odd harmonics from the Fourier series ex-
pansion as a square wave consists only of the odd harmonics. In Chapter 2
it was shown that this is true for all signals with a certain symmetry.
The shown examples had a regular square wave pattern but in reality objects
never consist of only one spatial frequency. From Fourier analysis it is also
known that a random signal can be approximated by an inÔ¨Ånite number of
sinusoidal frequency components.
This leads to the following important statements for optical objects in the

7.4. Physical Optics
661
-1
-0.5
0
0.5
1
-1
-0.5
0
0.5
1
0
0.2
0.4
0.6
0.8
1
¬ã|¬á
Figure 7.44: Airy-disk of the image of an ideal point-source created by a diÔ¨Äraction
limited optical system. The fringes around the centre peak are caused
by the sharp Ô¨Åltering of the optical system, which is equivalent to a
higher order dynamic system.
spatial frequency-domain:
‚Ä¢ Any optical object or image can be represented by an inÔ¨Ånite number
of spatial frequencies in three dimensions.
‚Ä¢ The high spatial frequencies represent the details of the object and
they are ‚Äúencoded‚Äù in the area in the pupil plane that is the most
distant from the optical axis.
‚Ä¢ High spatial frequencies require a large capture angle of the optical
system.
In other words, an optical imaging system acts like a spatial low-pass Ô¨Ålter
with a cut oÔ¨Äfrequency that is determined by the capture angle. A small
capture angle results in a lower optical resolution and less sharp images.
An optical system of which the performance is only determined by this
diÔ¨Äraction related limitation is called diÔ¨Äraction limited. In a diÔ¨Äraction
limited optical system all aberrations are smaller than the smallest details
in the image. This is best explained with the image of an ideal point source.
A point source with its inÔ¨Ånitely small size and inÔ¨Ånitely high radiance will
radiate in all directions as a spatial impulse with an inÔ¨Ånite irradiance peak
at one location of the object plane. When imaging a real point source any
optical system will spread the energy of the point source over a larger area.

662
Chapter 7. Optics in Mechatronic Systems
The resulting irradiance proÔ¨Åle as function of the position in the image
plane is called the point-spread function. The diÔ¨Äraction limited image of
a point source is the Airy point-spread function, also called Airy function
or Airy-disk shown in Figure 7.44, named after the English mathematician
and astronomer Sir George Biddell Airy (1835 ‚Äì 1881), who determined
this function. In the Airy-disk the higher order response of the spatial
low-pass Ô¨Åltering by the optical system is visible by the shown oscillations
around the irradiance peak in the centre, a spatial ‚Äúdynamic‚Äù phenomenon.
As soon as the performance of an optical system is not ideally diÔ¨Äraction
limited, the point-spread function of the image of a point source will show
both a wider and lower middle irradiance peak. The ratio between the peak
irradiance level in the point-spread function of a real optical system and
the peak irradiance level with a diÔ¨Äraction limited version of this optical
system is called the Strehl ratio, named after the German physicist Karl
Strehl (1864 ‚Äì 1940). The Strehl ratio is a measure for the quality of an
optical system.
7.4.4.1
Numerical Aperture and f-Number
Two closely related terms are used in optics to relate the above presented
capture angle with the resolution of the imaging system, the Numerical
Aperture (NA) in professional imaging systems and the f-number ‚å©f /#‚å™in
photography. With the help of Figure 7.45 both terms will be explained.
The f-number is the simplest term of the two as it does not take the refractive
index into account and equals just the ratio between the diameter of the
entry-pupil and the focal length.
‚å©f /#‚å™= f
d .
(7.34)
This term is perfectly usable in photographic systems, working in air with
objects that are mostly far away and with an image location near the focal
plane. The maximum entry-pupil of a photographic lens is in practice almost
equal to the diameter of the front lens. Usually the units, also called stops
diÔ¨Äer a factor

2 because the captured light from the object is a function of
the surface area of entry-pupil, being squared proportional to its diameter.
This means that a stop is a factor two in light irradiance.
The f-number values of regular photography lenses range between approxi-
mately f /2.8 and f /22. Often a practical lens design is optimised for aberra-
tions at an f-number around f /8. This already indicates that these lenses
are generally not diÔ¨Äraction limited with the exception of very expensive

7.4. Physical Optics
663

f
d
Entry-pupil 
Figure 7.45: DeÔ¨Ånition of the Numerical Aperture (NA= nsinœë) and the f-number
( ‚å©f /#‚å™= f /d) in an optical system. A large NA or a low ‚å©f /#‚å™correspond
to more captured diÔ¨Äraction orders giving a better resolution. For the
illustration the entry-pupil as used for the f-number with photographic
lenses is drawn just before the lens. With a telecentric lens the pupil
is located at inÔ¨Ånity for which reason the capture angle is taken as
reference for the NA.
professional photographic lenses, which can be used wide open and some-
times even show f-numbers up to f /1. It is obvious that these lenses need to
be very large to achieve such an opening angle and a good example are the
huge lenses used by sports photographers around football stadiums. It also
points convincingly to the inherent limitations in resolution of the small
lenses in pocket-size cameras and cell phones. Contrary to the photographic
application, professional imaging systems like wafer scanners, which are
used for deÔ¨Åning the structures in lithography for IC manufacturing, often
have both the object and the image close by and show signiÔ¨Åcantly higher
capture angles. In this case the Numerical Aperture (NA) is a more suitable
quality value and it is deÔ¨Åned as follows:
NA = nsinœë.
(7.35)
This term includes the refractive index n, which is related to the fact that
the wavelength of light with a speciÔ¨Åc frequency is shorter at a higher
refractive index. As a consequence the angle between the diÔ¨Äraction orders
is smaller. In other words an optical system can capture more orders in a
high refractive index medium like water or oil than in air.
This is the reason for oil-immersion in microscopes and water-immersion in
wafer scanners6.
6The application of immersion Ô¨Çuids in an existing air-based optical design does not
automatically increase the NA but only enables the designer to achieve a higher NA with an
adapted design, which could otherwise not be realised in air.

664
Chapter 7. Optics in Mechatronic Systems
The use of the sine instead of the tangent as with the f-number is more
practical as it clearly limits the value in air to one as the unattainable goal.
With an NA in air equal to one, the object or image should be positioned
inside the lens element, which is not possible. With small angles and an
refractive index of n = 1 the relation between f-number and the NA can be
approximated as follows:
NA = nsinœë = nsinarctan d
2f ‚âà
1
2‚å©f /#‚å™
or
‚å©f /#‚å™‚âà
1
2NA.
(7.36)
The numerical aperture determines the maximum resolution of a lens, also
called Critical Dimension (CD)7, with the following relation [95]:
CD = k1
Œª
NA
[m].
(7.37)
with Œª the wavelength of the light in vacuum because the refractive index
has already been taken into account in the NA value and Œª is mostly known
from the light source. The term k1 is named just like that, the k-one factor
and equals around 0.6 for a not optimised system. With special ‚Äútricks‚Äù,
mainly consisting of methods to concentrate and direct the light at the object
side, the system is able to image at a higher resolution. These methods
are well described in a dedicated book [95] by Alfred Kwok-Kit Wong. One
example of such resolution enhancement techniques is shown in Figure 7.46,
indicating the eÔ¨Äect of illumination from a direction under an angle with
the optical axis, causing a tilting of the diÔ¨Äraction orders. With a perpen-
dicular illumination the higher orders would be blocked at the aperture
stop (the dashed lines) but with this angular illumination both the 0th and
one of the higher orders is able to pass the aperture, giving enough optical
information to create an image. When the object would be illuminated from
two directions under the same angle with the optical axis or even from
all directions in three dimensions (a cone) under the same angle, called
annular illumination even both 1st orders would be captured. Further also
contrast enhancement methods at the image side help to lower this value.
The real minimum value for k1 is 0.25 as this is the situation where not even
a fraction of the 1st order is captured any more with whatever illumination
method. These mentioned methods for achieving a low k1 are applied in
waferscanners as these are not aimed at reproducing a nice representative
7The term (NA) and (CD) are not written as a variable in one italic symbol and strictly it
should be given a diÔ¨Äerent real variable name but the used notation is quite common in those
industries where it is relevant. For this reason the NA and the CD are noted with straight
capitals.

7.4. Physical Optics
665
Object
Image
0th order
-1st
Irradiance
Irradiance
Illuminaon
Pupil plane
Figure 7.46: Illumination under an angle with the optical axis enables imaging
in case the aperture is too small for capturing both 1st order angles
(dashed lines). The changed angles enable the capturing of the 0th
and one of the 1st orders.
image of the object like in photography. Instead, they are designed to pro-
duce an image of a certain structure by optimising all related elements. In
that case the object, also called the mask or reticle, can be adapted to make
optimal use of the possibilities of the entire optical system. The contrast
enhancement techniques at the image are realised in the photosensitive
resist, which sharply distinguishes between diÔ¨Äerent levels of irradiance
within only a few percent. It is needless to say that this requires a tight
control of the average light level, called dose-control.
7.4.4.2
Depth of Focus
The tolerance in positioning of an object or an image sensor along the optical
axis in respect to the optical system has many names and depth of focus is
one of them. Other names like depth of Ô¨Åeld relate often to the tolerance
in position of the object while depth of focus is used at the image side. The
use of the word ‚ÄúÔ¨Åeld‚Äù can be confusing as it also relates to a force Ô¨Åeld
and in imaging the object and image plane are also often named a Ô¨Åeld.
Furthermore both positions have a simple relation depending on the focal
length of the optical system. For these reasons the name depth of focus
(DOF) is used in this book.
When the position of the sensor to the lens is Ô¨Åxated, the object is only
imaged sharply around a small area that depends on several parameters.
This tolerance depends primarily on the aperture angle. This means that a
high NA or low f-number, as would be necessary to achieve the maximum

666
Chapter 7. Optics in Mechatronic Systems
Image
sensor
d
dS
oS
c
f
!
Figure 7.47: The depth of focus (dS) of a photographic camera depends on diÔ¨Äerent
parameters: the distance of the subject to the lens (So), the minimal
resolution (c) and the f-number ( ‚å©f /#‚å™= f /d).
resolution possible, will result in a low depth of focus. With a large aperture
angle only a little displacement away from the focal point will rapidly result
in a larger luminous spot proportional to this displacement. In non critical
optical systems like in photography where the minimum resolution (c) is
higher than the diÔ¨Äraction limited value, the allowable error (dS) in the
focal displacement of the object (S0) in relation to the diameter (d) of the
entry-pupil can be derived from simple geometry as shown in Figure 7.47:
dS
So
= ¬± c
d .
(7.38)
With the f-number ( ‚å©f /#‚å™= f /d) the following relation for the maximum
allowable focal error is derived:
dS = ¬± c S0‚å©f /#‚å™
f
[m].
(7.39)
A large distance, a high f-number, a large minimum resolution value and
a small focal distance all result in a high depth of focus. This corresponds
to the experience of photographers that a telephoto-lens shows a smaller
depth of focus than a wide-angle lens and that a high f-number is required
for landscape pictures with objects both nearby and far oÔ¨Äthat have to
be imaged sharp. It is also the reason that the integrated cameras in
inexpensive cell-phones have often a wide angle lens because a focusing
actuator is not provided. The situation at the image side of an optical
system is shown in Figure 7.48. Although the reasoning is identical as for
the object side, the distance from the image to the lens is in most cases
much smaller so also the allowable error in the positioning of the image
sensor of a photographic camera is far smaller. Fortunately this sensor is
Ô¨Çat and with automatic focusing it is possible to correct for misalignment.

7.4. Physical Optics
667

dS
F
Figure 7.48: Depth of focus with diÔ¨Äraction limited optics. The enlarged picture
at the right shows the irradiance at the focal point. The proÔ¨Åle of an
airy-disk can be observed at the cross section of the focal point, with
dark and light areas next to the central spot. Further it also shows
that the size of the spot remains about the same over a larger range
along the optical axis than expected from the crossing lines, resulting
in a depth of focus (dS) of about 2 ‚Äì 3 times the spot size.
More interesting is the shown eÔ¨Äect at the focal point when observing a
diÔ¨Äraction limited image. In that case it is not possible to simply derive the
tolerance from geometry of the two crossing most outer rays as around the
focal point the wave character shows a very interesting eÔ¨Äect.
It was shown in the previous section that the size of the image at the focal
point can never have an inÔ¨Ånitely small size because of the size of the airy-
disk, which is determined by the numerical aperture.
In spite of this minimum size of the spot in the centre, the maximum
irradiance area spreads over a larger area in the direction of the optical axis
than would be expected from purely geometrical analysis. This results in a
larger focal range according to the following relation:
dS = ¬± nŒª
NA2
[m].
(7.40)
In Chapter 9 it will be shown that because of this phenomenon an optical
resolution in the order of 50 nm can be achieved with a depth of focus in the
order of 100 nm, when using immersion optics with a very high numerical
aperture of ‚âà1,35.

668
Chapter 7. Optics in Mechatronic Systems
7.5
Adaptive Optics
In the past decades, the principles of active control are increasingly applied
in complex imaging systems to achieve the ultimate performance. This
mechatronic Ô¨Åeld of adaptive optics has proven its value in astronomy and
high precision optics for IC lithography but also in medical instrumentation
it became a method to achieve results that were hitherto deemed impossible.
In this section one of the main causes of a less than optimal optical per-
formance of an imaging system is presented, which is the generally strong
temperature dependency of the optical path of the light.
It will be shown that the resulting problems can be reduced by inserting
active optical elements such as deformable mirrors with a suitable measure-
ment and control system.
7.5.1
Thermal EÔ¨Äects in Optical Imaging Systems
Optical systems operate by virtue of diÔ¨Äerences in the velocity of light, rep-
resented by the refractive index of the transparent material. Unfortunately
the refractive index is largely inÔ¨Çuenced by temperature. The impact on the
refractive index by temperature is mainly caused by the changing density
of most materials as function of temperature. In most cases an increasing
temperature will cause a decreasing density. With a lower density there are
fewer atoms to slow down the light over the trajectory, which is equivalent
to a lower refractive index.
This however is not always the case. Especially in glass, the refractive index
can increase or decrease as function of rising temperature due to the com-
position with special elements. Next to this direct eÔ¨Äect on the refractive
index, the size of an object depends on the temperature. For a lens this
means that also its curvature is not constant.
To examine these eÔ¨Äects in a qualitative manner the previously introduced
lens-maker‚Äôs equation can be used:
1
f = (n‚àí1)

 1
R1
‚àí1
R2


m‚àí1
.
(7.41)
At Ô¨Årst sight it might seem possible to select a glass type with such a positive
dn/dT that it compensates the eÔ¨Äect of the increasing radius by the larger
lens size at a higher temperature.
In reality however often this choice is mostly not available while the eÔ¨Äect
on geometry and refractive index of otherwise preferred materials can be
quite diÔ¨Äerent.

7.5. Adaptive Optics
669
Figure 7.49: The car looks as if standing in water while being in the middle of the
Mojave desert at 40 ¬∞C. This mirage is caused by a lens eÔ¨Äect that
refracts light from the sky towards the observer. This lens eÔ¨Äect is
created by the hot air with a low density close to the ground. Also the
turbulence caused by the thermally induced motion of the air is clearly
visible at the telephone poles while the image of the approaching car
at the horizon is even hardly distinguishable.
With for instance the professional lenses for IC lithographic exposure equip-
ment working at the Deep UV wavelength of 193 nm, it is necessary to use
Fused Silica as lens material that shows a large temperature dependency of
the refractive index dn/dT = 15¬∑10‚àí6 while the thermal expansion coeÔ¨Écient
is only ‚âà0.5¬∑10‚àí6.
This means that one ‚ó¶K of temperature could shift the focal plane of a lens
with a focal length of 10 mm with 150 nm, which is not acceptable for such a
precision optical system. Even worse is the situation where the temperature
is not constant over the optical system due to absorption of light causing
additional aberrations.
Another well-known example of thermally induced optical errors is the eÔ¨Äect
of temperature diÔ¨Äerences in air like shown in Figure 7.12 in Section 7.2.2. It
is the cause for the famous phenomenon of a mirage as shown in Figure 7.49.

670
Chapter 7. Optics in Mechatronic Systems
7.5.2
Correcting the Wavefront
The pupil plane inside an optical system is shown to contain all the spatial
information about the object that is imaged. This information is stored in
the diÔ¨Äerent diÔ¨Äraction orders that all propagate parallel for any point on
the subject.
The wavefront at the pupil plane should be Ô¨Çat because of these parallel
rays. This means that at the pupil plane aberrations can be distinguished
as deviations from this Ô¨Çat wavefront. It was further also shown that the
information on the details is spread over the entire pupil plane with the Ô¨Åner
structures more distant from the optical axis. Adaptive Optics is based on
the principle to introduce a controllable optical element in the optical path,
which corrects these deviations from the ideal wavefront after measurement
by a wavefront sensor.
The Ô¨Årst application of adaptive optics has been in terrestrial telescopes
where the turbulence and temperature eÔ¨Äects in the atmosphere determine
changes in the refractive index leading to wavefront errors. Especially with
Figure 7.50: The Extremely Large Telescope of the European Southern Observatory
(E-ELT) has a main mirror with a diameter of just less than 40 metres,
consisting of ‚âà1000 segments, each with a diameter of ‚âà1.4 metres,
that all have to be aligned with an accuracy of Œª/20 ‚âà15 ‚Äì 50 nm. Two
adaptive secondary mirrors are used to correct for wavefront errors
by atmospheric disturbance. (Courtesy of ESO)

7.5. Adaptive Optics
671
the ever larger size of these telescopes, necessary to capture more light
and increase the resolution, the inÔ¨Çuence of the air becomes dominant. As
an example Figure 7.50 shows the E-ELT, the Extreme Large Telescope
of the European Southern observatory, which is planned to be Ô¨Ånished
around 2018. The largest mirror has a diameter of ‚âà40 metres. It is
impossible to manufacture such large mirrors in one piece and it became
customary for telescopes to compose such a large mirror from a multitude
of smaller elements. The main mirror of the E-ELT consists of around 1000
smaller mirror elements of 1.4 metres wide. Each of these mirror-elements
is precisely positioned relative to the other mirrors, such that the light from
each element is in phase with the light of the other elements. Only under
that condition the combined mirrors will act like one large mirror with one
consistent wavefront.
The precision of this matching needs to be better than Œª/20, which is about
15 nm, because light with wavelengths as short as 300 nm has to be imaged.
It is well understandable that a wavefront, passing through more than 50
km of atmosphere, can easily become distorted by more than this 15 nm
and for that reason two of the four other mirrors of the telescope have an
actively controlled surface shape.
In the following two sections, Ô¨Årst the Zernike modes are introduced as a
mathematically description of the wavefront aberrations, while in the second
section the principle of operation of adaptive optics is further explained.
7.5.2.1
Zernike Polynomials
A wavefront error (WFE), being a deviation from an ideal wavefront can
mathematically be described in orthogonal polynomials, called Zernike poly-
nomials, which are deÔ¨Åned in a polar coordinate system over a circular plane
normalised to radius 1 (unit disk) around the optical axis. The full waveform
deviation is then approximated by the summation of a plurality of singular
shapes (modes) of a diÔ¨Äerent order and magnitude. This approximation is
comparable with the Fourier analysis of signal waveforms and modal shapes
of a dynamic system.
The diÔ¨Äerent Zernike polynomials or Zernike modes that deÔ¨Åne these sin-
gular shapes are named after the Dutch scientist and Nobel prize winner
Fritz Zernike (1888-1966), who deÔ¨Åned them. Next to wavefronts, also the
surface of optical elements and the image shape in the Ô¨Åeld plane could
be described by these polynomials, but mostly the use of Zernike modes is
limited to the pupil plane where the ideal wavefront should be Ô¨Çat.

672
Chapter 7. Optics in Mechatronic Systems
There are even and odd Zernike polynomials, where the even ones are deÔ¨Åned
as:
Zq
p(œÅ,œï) = Rq
p(œÅ)cos(qœï).
(7.42)
and the uneven ones as:
Z‚àíq
p (œÅ,œï) = Rq
p(œÅ)sin(qœï).
(7.43)
where both p and q are non negative integer numbers, p ‚àíq are even and
p ‚â•q.
The angle œï is the azimuthal angle, between a reference vector and another
vector that originates in the centre and points towards the location of interest.
The value œÅ is the normalised radial distance on the unit disk with diameter
of 1.
The radial polynomials Rq
p(œÅ) are given by:
Rq
p(œÅ) =
(p‚àíq)/2

k=0
(‚àí1)k(p ‚àík)!
k!((p + q)/2‚àík)!((p ‚àíq)/2‚àík)!œÅp‚àí2k.
(7.44)
This equation results in the following list of radial polynomials for the Ô¨Årst
21 Zernike modes, where p + q is the order of the Zernike mode8:
R0
0(œÅ) = 1,
(7.45)
R1
1(œÅ) = r,
R0
2(œÅ) = 2œÅ2 ‚àí1,
R2
2(œÅ) = œÅ2,
R1
3(œÅ) = 3œÅ3 ‚àí2œÅ,
R3
3(œÅ) = œÅ3,
R0
4(œÅ) = 6œÅ4 ‚àí6œÅ2 +1,
R2
4(œÅ) = 4œÅ4 ‚àí3œÅ2,
R4
4(œÅ) = œÅ4,
R1
5(œÅ) = 10œÅ5 ‚àí12œÅ3 +3œÅ,
R3
5(œÅ) = 5œÅ5 ‚àí4œÅ3,
R5
5(œÅ) = œÅ5.
8Several other deÔ¨Ånitions of these polynomials exist that diÔ¨Äer in details, for instance by
normalising on maximal values at the edge of the circle, like 1 as used here. Also the units
can relate to metric values like [nm] or wavelengths. Further the order is often mentioned
as ‚Äùp‚Äú equalling the radial order and ‚Äùq‚Äú equalling the azimuthal order and the sequence
of numbering is either simply based on an increasing radial order or on a more complicated
expansion with spherical terms for all quadratic numbers. All these deÔ¨Ånitions are correct as
long as maintained consequently in all communication.

7.5. Adaptive Optics
673
Z 0
0
Z -1
1
Z 0
2
Z 1
1
Z 2
2
Z -2
2
Z 0
4
Z -3
3
Z -1
3
Z 1
3
Z 2
4
Z 3
3
Z -2
4
Z -4
4
Z -5
5
Z -3
5
Z -1
5
Z 1
5
Z 3
5
Z 5
5
Z 4
4
Piston
Tip
Tilt
Defocus
$
$
]
Trefoil
Trefoil
#
¬í/
¬í/
Figure 7.51: Height map of the Ô¨Årst 21 Zernike modes describing deviations of
an ideal Ô¨Çat surface in a systematic manner. Generally deviations
of wavefronts can be modelled as a combination of several Zernike
modes with diÔ¨Äerent magnitude. In this chart blue corresponds to 1
representing faster than average photons, green with zero (average)
and red with -1, the slower than average photons.
(Courtesy of Claudio Rocchini)
Is important to iterate another part of the deÔ¨Ånitions of a wavefront for the
explanation of the meaning of these modes in a descriptive form. A wave-
front is a representation of the light coming from an inÔ¨Ånitely small spot
while the photons over the wavefront have a Ô¨Åxed phase relation or equal
timing when starting at the same moment. Delaying part of the photons
will distort the wavefront and as a consequence the direction of the photons
is changed. This all means that each point on the object creates a wavefront
that is Ô¨Çat at the pupil plane and can de distorted by errors in the imaging
system.
In Figure 7.51 a graphical overview of the Ô¨Årst 21 Zernike modes is given to
visualise the diÔ¨Äerent shapes. The upper image corresponding to the zeroth-
order Zernike Z0
0 = 1 is the plane wave term, equal to the mean value of the

674
Chapter 7. Optics in Mechatronic Systems
wavefront. It represents a constant delay of all photons in the wavefront,
caused by for instance a Ô¨Çat piece of glass. One step down, where p = 1, the
two second-order Zernikes represent the eÔ¨Äect of tilting around the vertical
or horizontal axis. These eÔ¨Äects can be caused by a wedge shape piece of
glass, called a prism and means that the main direction of the wavefront is
changed over a tilting angle. The third row with p = 2 shows in the middle
another second-order Zernike Z0
2 representing the eÔ¨Äect of defocus, which
causes a parabolic wavefront in the pupil plane. As a consequence of the
defocusing, the inner rays will be either delayed in respect to the outer rays
or vice versa and they will no longer coincide on the same focal point on the
image. The image becomes unsharp.
In the section on geometric optics three aberrations were introduced, spher-
ical aberration, astigmatism and coma. The examples were shown with
positive single lens elements where the pupil is determined by the size of the
positive lens itself. For linking the aberrations with the images in the Ô¨Ågure
one can imagine the pupil plane with parallel rays to be somewhere inside
the lens element. The primary versions of the three mentioned aberrations
are represented by the 4th order Zernike terms.
Spherical aberration is represented by Z0
4 and a cross section through the
middle looks like a double sine wave. When comparing with Figure 7.20
the outer and inner rays are delayed in respect to the rays in between. It
was shown in that Ô¨Ågure that it should be corrected by adding more glass,
meaning more delay, in that intermediate area.
Astigmatism is represented by Z‚àí2
2
and Z2
2 and can be seen as a saddle shape.
When comparing with Figure 7.22 it is shown that rays in one plane are
delayed in respect to rays on the optical axis while rays in an orthogonal
plane are in advance to the rays at the optical axis.
Coma is represented by Z‚àí1
3
and Z1
3 and its cross section through the low and
high area looks like a single sine wave. When comparing with Figure 7.23
this is less easy to imagine and with the higher order terms it is not useful
to even try, but one thing is certain, the higher the Zernike terms the more
reÔ¨Åned the correction mechanism should be.
Several of the higher order terms can be seen as high spatial frequency
versions of the described primary aberrations. For instance Z2
4 and Z‚àí2
4
represent secondary astigmatism and Z1
5 and Z‚àí1
5
is secondary coma.
The other Zernike modes also have their own name based on their shape
like trefoil for Z3
3 and Z‚àí3
3 , quadrafoil for Z4
4 and Z‚àí4
4 , pentafoil for Z5
5 and
Z‚àí5
5
and consequently Z3
5 and Z‚àí3
5
are called secondary trefoil.

7.5. Adaptive Optics
675
7.5.2.2
Correcting Zernikes by Adaptive Optics
The zeroth- and second-order zernike modes are all correctable with simple
mechanical means, related to the placement and orientation of the diÔ¨Äerent
lens elements. Higher order errors need a more complicated correction
mechanism. Based on the mathematically described deviations of an optical
system, adaptive optical systems are developed as a mechatronic method to
measure and correct the wavefront errors in the pupil plane by means of an
actively controlled optical element, a wavefront sensor and a suitably tuned
control system.
In principle one could consider the second-order Zernike error correction by
automatic focusing of a photo camera as a kind of adaptive optics and indeed
it shows all elements of an active controlled system including sensor, actua-
tor and controller. Generally, however, the term adaptive optics is reserved
for those applications where the curvature of optical elements themselves is
actively controlled in order to reduce the higher-order wavefront errors.
Mul-  lens array
CCD-
image sensor
Beam spli'er
Actuator array
Deformable mirror
Controller
Wavefront 
analyzer
Image
Shack-Hartmann 
wavefront sensor
Distorted wavefront
Figure 7.52: Principle of adaptive optics with feedforward compensation. By in-
serting a beam splitter in the pupil area the distorted wavefront can
be measured and corrected by a deformable mirror. Notice that the
deformation magnitude of the deformable mirror has to be less than
the distortion magnitude of the wavefront depending on the angle of
incidence.

676
Chapter 7. Optics in Mechatronic Systems
7.5.3
Adaptive Optics Principle of Operation
The principle of operation of adaptive optics is shown in Figure 7.52, which
shows a feed forward compensation method. The light with the distorted
wavefront enters the system at the upper left side, as shown by the dashed
line in the pupil area where the light is running parallel.
As a Ô¨Årst step a beam splitter splits the light in two paths. The irradiance
ratio between these paths is not important for the working principle but one
can imagine that with an expensive telescope it would be a waste to send
too many photons to the wavefront sensor.
The wavefront is analysed with a wavefront sensor that is based on the
principle that light propagates in a direction orthogonal to the wavefront.
The most simple version of a wavefront sensor consists of a plate with tiny
holes where the light through the holes will illuminate a CCD image sensor
like used in a digital camera, which is positioned behind the plate. The
position of the illuminated areas is determined by the direction of the light
orthogonal to the local wavefront. With a suitable algorithm the wavefront
can be reconstructed from the position of the spots on the CCD sensor.
This wavefront sensor is called the Hartmann sensor after the German
physicist Johannes Franz Hartmann (1865 ‚Äì 1936) who invented the princi-
ple. It was later improved by The American physicist Roland Shack to the
Shack-Hartmann wavefront sensor by replacing the tiny holes by an array
of small lenses, which are shown in the Ô¨Ågure. In the Ô¨Ågure this principle
is indicated in an exaggerated way, where the distorted waveform results
into the mentioned spatially shifted pattern of spots. Although only Ô¨Åve
lenslets are drawn, in reality many more lenslets are used depending on the
required spatial resolution. This reÔ¨Åned multi-lens array covers two degrees
of freedom in order to precisely analyse the wavefront over the entire pupil
plane.
The obtained wavefront information is used in a controller to adapt a de-
formable mirror in such a way that it compensates the waveform distortion
by introducing Zernike terms with an equal magnitude as the distorted
wavefront but with an opposite sign.
The deformable mirror is equipped with a multitude of actuators, which are
capable of covering all relevant Zernike terms, comparable to the multi-lens
array of the wavefront sensor. At the end of this section an example of such
an actuated mirror will be shown in more detail.
It should be noted that the deformation of this correcting mirror has to be
less than the magnitude of the distortion of the wavefront. This is caused

7.5. Adaptive Optics
677
Acve mirror
Image
Controllerr
Wavefront sensor
Distorted wavefront
Figure 7.53: Principle of adaptive optics with feedback control. The mirror is con-
trolled such that the error on the wavefront sensor is kept as close as
possible to zero.
by the angle of incidence of the light in respect to the surface of the mirror.
When the mirror surface is orthogonal to the incident light the optical path
diÔ¨Äerence of light reÔ¨Çecting on the mirror is twice the displacement of the
surface. When the surface is tilted under an angle of 45¬∞as in the shown
examples the timing diÔ¨Äerence of the light

2 times the displacement. A
larger tilt angle will require a larger deformation magnitude.
Although this kind of feedforward compensation is used in practice, it re-
quires a precisely predictable behaviour of the actuated mirror and a Ô¨Çawless
sensing of the wavefront over a large range. This is only possible with fre-
quent calibration.
For that reason more often a second option is applied by ‚ÄúreshuÔ¨Ñing‚Äù the
parts and creating a real-time feedback loop as is shown in Figure 7.53.
With feedback control the light is reÔ¨Çected Ô¨Årst at the active mirror followed
by the beam splitter with the sensor and the imaging part.
The mirror is controlled in such a way that the deviations as measured in
the sensor are as close as possible to zero. This zeroing tracking-control
approach has as beneÔ¨Åt that the sensor only needs to be calibrated for a
plane wavefront and that the actuators on the mirror only have to be linear
enough to not impair the stability of the feedback loop.
In principle all controlled channels from one measured wavefront location to
the corresponding actuation part are interconnected and mutually interfere
with each other both mechanically and optically so the control algorithm is

678
Chapter 7. Optics in Mechatronic Systems
not obvious. Especially when the errors in large space telescopes need to
be corrected it appears that for a 40 metre telescope around 105 actuators
would be needed. For real-time control this number of channels requires
a multitude of more than 104 FPGA processors when using classic SISO
control. For this reason a real MIMO control system with distributed con-
trol algorithms is preferred, which takes the actions of the neighbouring
elements into account.
7.5.3.1
Active Mirrors
Many possible conÔ¨Ågurations have been investigated to realise controllable
mirrors, often with piezoelectric or electrostatic actuation of a thin plate,
which acts as the deformable mirror. Two examples are shown, the Ô¨Årst
targeted at astronomy where it is used to compensate wavefront errors
due to atmospheric turbulence. The second is targeted as a compensation
method to compensate wavefront errors by thermal expansion in optical
elements due to heating by the imaged light.
Electromagnetic Actuated Mirror
Figure 7.54 shows a design that was realised in the Control Systems Tech-
nology Laboratory at Eindhoven University of Technology during the PhD
research of Roger Hamelinck [38]. This conÔ¨Åguration uses permanent mag-
net biased reluctance actuators to determine the shape of the mirror.
This adaptive-optics mirror-system consists of several layers. The upper
layer is a thin sheet of glass with a suitable reÔ¨Çection coating, which acts as
the mirror. It is connected by thin strands of steel wire to the middle layer,
the moving part of the actuator, consisting of ferromagnetic pieces of metal
that are suspended by a membrane. The lower layer, the stationary part,
consists of a base plate with coaxial permanent magnets and Ô¨Çat wound
coils, creating a magnetic Ô¨Åeld, which can be modulated by the current
in the coils. Without current the permanent magnet secures a certain
pretension. Depending on the current direction, the attraction force to
the ferromagnetic piece of metal is reduced or increased. The mirror can
adapt its shape according to the average position of the actuator, because
of the coupling with the thin wires. The high Ô¨Çexibility of the wires avoids
the introduction of discontinuities at the connection points and their small
cross-section minimises the heat transfer from the actuators to the mirror.

7.5. Adaptive Optics
679
Permanent magnet
Planar coil
Membrane
suspension
^$c material
6¬ö$
!,{
!¬Ñ{
Figure 7.54: Actively controlled mirror with ‚ÄúHybrid‚Äù permanent magnet biased
actuators. The actuator at the left has no current, in the middle
the current direction increases the permanent magnet Ô¨Çux and at
the right the current direction decreases the Ô¨Çux of the permanent
magnet. (Courtesy of Roger Hamelinck, TU/e)
Only a small part of a larger mirror is shown. In the real system the
actuator part will be assembled from a multitude of the shown hexagonal
substructures but the mirror itself will be one larger surface.
Side note: This version of the ‚Äúhybrid‚Äù actuator has the permanent magnet
inserted in series with the Ô¨Çux path of the coil. According to the theory, this
design increases the reluctance of the magnetic Ô¨Çux induced by the current,
resulting in a reduced energy eÔ¨Éciency.
A more preferred hybrid actuator design with the magnet outside the Ô¨Çux
path of the coil would require a symmetric conÔ¨Åguration with an additional
part on the other side of the membrane suspension as described in Sec-
tion 5.3.4. Such a design would complicate the layout excessively and also
the beneÔ¨Åts of a more optimal magnetic conÔ¨Åguration are limited because
of the small size per actuator with its relatively larger reluctance of the air
gaps. For this reason the shown design is more optimal when all factors are
taken into account, including manufacturability.

680
Chapter 7. Optics in Mechatronic Systems
Thermally Actuated Mirror
Figure 7.55 shows a concept of an active mirror that was designed in the
Mechatronic System Design laboratory at Delft University of Technology
during the PhD research of Rudolf Saathof [73]. It is used to compensate or
correct slow thermally-induced deformations of the optical elements in an
EUV lithographic exposure system where high irradiance levels are applied
with a relative high absorption level at the optical surfaces. Instead of a
mirror with a separate actuator, like in the Ô¨Årst example, this concept uses
the same physical eÔ¨Äect that caused the problem by creating a more uniform
and constant heating of the surface. At the left side of Figure 7.55 this
eÔ¨Äect is shown where the mirror is illuminated by light with an uneven
irradiance proÔ¨Åle, having a hot spot at the centre. In order to compensate
the resulting thermal gradient the mirror is also illuminated from the back
side with a spatial controllable heat source of which the energy is absorbed
in a coating located closely below the mirror surface. By controlling the heat
source opposite to the exposed light from above, a uniform total heat input
is achieved, resulting in a stable shape of the mirror.
e ]$
Hot spot
Heat source
W/rt error
Ae Mirror
]
Corr
#l ]rollable
Heat source
Thermal ¬à
¬≠/
Temperature
&¬õ/
Figure 7.55: Thermally actuated active mirror that operates by a thermal gradient
at the mirroring surface, which is created by illumination from the
back side. It can be used to compensate the expansion eÔ¨Äect of an
irregular heating proÔ¨Åle, as shown at the left half of the mirror, or to
correct wavefront errors caused earlier in the optical system.
(Courtesy of Rudolf Saathof, TUDelft)

blank
left
intentionally
page
This

blank
left
intentionally
page
This

Chapter 8
Measurement in
Mechatronic Systems
Robert Munnig Schmidt
Introduction
The precision of mechatronic systems can not be better than the measure-
ment accuracy of all relevant parameters that are needed to control and
adapt the behaviour of the system. The other elements in the system are
never capable of correcting unknown measurement errors.
The Ô¨Åeld of metrology deals with measurement in general and is in itself
quite immense, even when only dealing with mechanical quantities. One of
the reasons for this wide scope is the economic need for undisputed quan-
tities when trading goods. Metrology has been practised from the very
moment that people started to exchange valuable items and this has re-
sulted in agreements and rules on a global scale regarding traceability, the
possibility to relate a measurement value to an agreed standard like the
kilogram and the metre. For the same reason as with the other chapters,
this chapter has to remain limited to the most relevant measurement items
for precision motion systems, being the measurement of forces, position and
motion. This includes sensors for stress, velocity and acceleration, based on
physics principles like piezoelectricity, electromagnetism and optics.
This chapter is divided in seven sections.
Section 8.0.1 is a more general introduction of the basic principles and mod-
683

684
Chapter 8. Measurement in Mechatronic Systems
elling of measurement systems. Also some deÔ¨Ånitions from the traceable
metrology Ô¨Åeld will be introduced, especially regarding measurement uncer-
tainty.
Section 8.1 presents the statistics around random errors by introducing
an important statistical method, called Dynamic Error Budgeting. This
method enables a mechatronic designer to determine the total error in a
dynamic system from diÔ¨Äerent error source contributions. While statistics
are very important for the analysis of measurement errors, this method
is also applicable for the estimation of positioning errors in a mechatronic
motion system.
Section 8.2 concentrates on the electronic signals in the most sensitive
elements of a measurement system. DiÔ¨Äerent sources of errors will be dis-
tinguished and methods are presented to reduce the negative eÔ¨Äects.
Section 8.3 introduces dedicated electronic circuits that are used to add
robustness to weak signals. It strongly builds on the basic theory of opera-
tional ampliÔ¨Åer circuits that was presented in Chapter 6.
Section 8.4 presents the methods to create digital data from the analogue
signals in a reliable way.
Section 8.5 is the Ô¨Årst of three application sections and concentrates on
sensors in short range position measurement systems.
Section 8.6 introduces sensors for the dynamic measurement of mechanical
quantities like force, velocity and acceleration.
Section 8.7 presents the important long range optical position measurement
systems with encoders and laser interferometry.
8.0.1
Measurement Systems
The function of a measurement system is to translate a physical quantity,
the measurand, into a representative engineering quantity. Depending on
the application, this can be an analogue or a digital representation. For
example the pointer of a speedometer in a car is a typical analogue repre-
sentation, while the numerical reading of a fuel pump in a gas station is an
example of a digital representation.
A basic measurement system for controlling a process or function can be mod-
elled to consist of 3 successive functional elements1 as shown in Figure 8.1
that each have very speciÔ¨Åc properties.
1In general literature on measuring a 4th element is often added, describing the data
representation part by means of a display, an analogue pointer, printer or plotter. This element
is omitted here, because of the limitation to measurements for controlling a dynamic process
without an external display.

685
Sensing 
Signal 
Condioning 
Signal 
processing
Physical 
quanty
Technical 
value
Figure 8.1: Measurement systems can be modelled as a series of three elements.
The sensing part translates the physical signal into an electrical signal.
The signal conditioning adds robustness to the sensor signal and the
signal processing translates the signal into a quantitative value.
‚Ä¢ A sensing element, converting a variable quantity of a physical phe-
nomenon (physical signal) into an analogue electrical signal.
‚Ä¢ A signal conditioning element, which adds robustness to the analogue
signal by means of ampliÔ¨Åcation such that it can be transferred to
another location without risk of disturbances by interfering signals.
‚Ä¢ A signal processing element, converting the analogue signal into a
diÔ¨Äerent analogue or into a digital value, which is adapted to the
requirements for active control of a larger system and process.
Examples of sensors are a thermocouple, which creates a voltage as function
of temperature, a light sensitive diode, converting a stream of photons into an
electric current and a moving coil in a magnetic Ô¨Åeld, which gives a voltage
as function of the velocity. Low-power signal ampliÔ¨Åers are typical examples
of signal conditioning elements and an analogue-to-digital converter is a
typical signal processing element.
8.0.2
Errors in Measurement Systems, Uncertainty
All elements of a measurement system show deviations in their intended
performance. These deviations lead to an overall diÔ¨Äerence between the
measured quantity of the measurand and the real value, which would have
been measured with a perfect instrument. This diÔ¨Äerence, called measure-
ment error is the subject of research of many scientists.
In oÔ¨Écial traceable metrology for economic purposes several terms are
deÔ¨Åned to classify and deal with measurement errors. These terms are
laid down in the ‚ÄùGuide to the Expression of Uncertainty in Measurement‚Äú
(GUM) and the ‚ÄùInternational vocabulary of metrology, basic and general
concepts and associated terms‚Äú (VIM) under responsibility of the ‚ÄùJoint
Committee for Guides in Metrology‚Äú (JCGM) where the ‚ÄùBureau Interna-
tional des Poids et Mesures‚Äú (BIPM) from S√®vres near Paris is participating

686
Chapter 8. Measurement in Mechatronic Systems
as international standards organisation. This part of metrology is less
relevant for mechatronic systems, because most controlled motion systems
rather rely on internal references than on external traceable, often also
called absolute standards. Nevertheless it is useful to be aware of these
conventions when using the diÔ¨Äerent terms in communication with others,
for which reason some of these deÔ¨Ånitions will be explained in the following
list:
‚Ä¢ Errors in measurement systems can be divided in two parts, systematic
errors and random errors. Systematic errors are those measurement
errors that in replicate measurements remain constant or vary in a
predictable, deterministic manner. Random errors are those measure-
ment errors that in replicate measurements vary in an unpredictable
manner. As an example of a predictable systematic error one can
think of the inÔ¨Çuence of temperature on the measurement of another
physical quantity. It is often possible to measure the temperature and
compensate for its inÔ¨Çuence, when the physical model of the system
regarding temperature is known. An example of a random error is
for instance the momentary voltage value of the thermal noise in a
resistor. In order to decrease the error in measurement systems it is
obvious that it is necessary to especially reduce the amount of random
errors to a minimum.
‚Ä¢ The measurement uncertainty of a measurement system is quite strictly
deÔ¨Åned as a non-negative parameter, characterising the dispersion
of the quantity values, being attributed to a measurand, based on
the information used. It includes all random and non-compensated
systematic errors. In case of compensation of predictable systematic
errors it also includes random errors in the measurement that is used
for the compensation, like the temperature measurement as mentioned
in the example before.
‚Ä¢ The term measurement accuracy is a relative, mainly qualitative term,
mostly used when indicating the diÔ¨Äerence between two measurements
of which one is more accurate than the other. When quantised the
given numbers are often only relating to the order of magnitude and
as such this term is less strict than measurement uncertainty.
‚Ä¢ The term measurement precision is a relative, quantitative term, usu-
ally expressed numerically by measures of imprecision relative to the
maximum value of the measurand. One can think of the standard devi-
ation, variance, or coeÔ¨Écient of variation under the speciÔ¨Åed conditions

687
of measurement. In fact, measurement precision relates measurement
uncertainty to the real value.
‚Ä¢ Directly related to precision is the term reproduceability which quan-
tiÔ¨Åes the extent to which a repeated measurement gives the same
results.
‚Ä¢ The term measurement resolution refers to the smallest change in
a quantity being measured that causes a perceptible change in the
corresponding indication. It is very important to recognise that the
maximum resolution of a measurement system is quite something
diÔ¨Äerent than uncertainty. In fact the resolution has always the small-
est value of the two, for which reason several suppliers of measuring
systems like to only mention the resolution in their marketing commu-
nication.
Ultimate Uncertainty
Many years ago scientists like Laplace were convinced that somewhere in
the future all physical processes would be exactly predictable.
Quantum mechanics however, has given us other insights with for instance
the Heisenberg uncertainty principle [40], postulated by the German physi-
cist and Nobel prize winner Werner Karl Heisenberg (1901 ‚Äì 1976). His
principle states that the standard deviation in the measurement errors of
two parameters, like place (œÉx) and impulse (œÉp) or energy (œÉE) and time (œÉt),
can not be smaller in combination, than given by the following expression:
œÉxœÉp ‚â•h
4œÄ
and
œÉEœÉt ‚â•h
4œÄ.
(8.1)
with the Planck constant h = 6.62607015¬∑10‚àí34 Js.
Fortunately in the practical world of mechatronic reality this number is so
small that it is in most cases not necessary to take this uncertainty limit
into account. Before reaching these levels of uncertainty there is still ample
room for scientists and engineers to work on improvements in the actual
uncertainty of measurement systems.
8.0.2.1
Uncertainty in Traceable Measurements
As of 2019 all absolute standard units are based on physical constants. A
physical constant is preferred as it can be reproduced without the need
for access to an object. Starting with the second (s), it is deÔ¨Åned by the

688
Chapter 8. Measurement in Mechatronic Systems
Caesium frequency ŒîŒΩCs being exactly 9,192,631,770 Hz, while Hz equals
1/s. With this deÔ¨Ånition of the second. the metre (m) is related to the speed
of light which is deÔ¨Åned as exactly 299.792.458 metre per second. With these
deÔ¨Åned units the kg, which was originally related to a well conserved piece
of Platinum, is now deÔ¨Åned by a newly Ô¨Åxed value of Planck‚Äôs constant h =
6.62607015¬∑10‚àí34 in unit [Js] which is equal to [kgm2s‚àí1]. These seemingly
illogical numbers with many decimals are based on their historic origin
as every new standard has to be approximately equal to the earlier used
standard at the moment of introduction. In spite of these exact deÔ¨Ånitions,
real values of physical properties can only be determined by measuring
them against so called primary standards, which are developed to give
the closest possible match of the measurand with the deÔ¨Åned standards.
The remaining uncertainty in these primary standards is a continuous
Ô¨Åeld of research. The standards that are used by metrology institutes all
over the world are related to these primary standards by means of regular
comparison studies and these derived standards are called secondary or
tertiary standards, indicating their position in the traceability hierarchy to
the primary standard. Presently the primary standard of time is the most
accurate of all with an uncertainty better than 5¬∑10‚àí16, based on the CsF2
caesium fountain clock of NIST, the National Institute of Standardisation
and Technology of the USA [48]. The next best primary standard is the
metre, which is related to the wavelength of an iodine stabilised HeNe laser
(Œª ‚âà633 nm) with an uncertainty in the order of 2¬∑10‚àí11 as determined by
BIPM based on many reported comparison studies like the one from Bernard
cs [7]. Recent developments with pulsed picosecond lasers are expected
to connect the length standard with time, thereby further reducing the
uncertainty [25]. With electricity the original standard of current is not
very accurate as it was based on chemical reactions. For that reason the
voltage is taken as primary standard based on Josephson junction frequency
generation [52]. Derived standards have an uncertainty in the order of
30 nV/V (3 ¬∑ 10‚àí8) according to BIPM. The current is than related to the
voltage by the use of calibrated resistors for DC currents or capacitors
for AC currents, which are available with an uncertainty level of 36 nŒ©/Œ©
(3.6¬∑10‚àí8) according to BIPM. The force is deÔ¨Åned by the acceleration of an
object, using the standards of mass, length and time (N=kgm/s2). Finally
the temperature standard with an absolute uncertainty in the order of 0.5 ‚Äì
1 mK @ ‚âà273 K, as for instance reported in a key comparison between the
Canadian CRC and the Dutch NMI-VSL [41] is based on phase transition
temperatures of several materials like the triple point of water.

689
8.0.3
Functional Model of a Measurement System Ele-
ment
Every element of a measurement system can be modelled as a separate
subsystem with a primary input for the useful information, secondary in-
puts of external error sources and an output. This model is represented in
Figure 8.2.
Ideally an element would only show a proportional linear transfer function
L(i) from the measurand input i to the output o, with a transfer gain of K‚Ñì.
In most sensors however a certain level of non-linearity causes a not fully
proportional output value. This non-linearity can be expressed mathemati-
cally as a series-expanded polynomial that contains the higher-order terms
of the total transfer function of the element.
N(i) =
‚àû

n=2
cnin.
(8.2)
Mostly the used terms are limited to only those, that contribute to the sig-
niÔ¨Åcance of the output value o, as determined by the uncertainty level of
the measurement.
Next to the non-linearity, external inÔ¨Çuences can impair the functionality of
the element in two ways. Firstly, the external disturbance input can result
in an additional value of the output of the element irrespective of the mea-
surand input value. This disturbance input is called the interfering input,
with a transfer gain Ki. The second way of impairing the measurement
output is by changing the proportional gain of the measurand input transfer
function and is called the modifying input, with a transfer gain Km. In prin-
ciple, the interfering input can have a similar non-linear transfer function
as the measurand input, but often the higher-order terms of the related
polynomial can be neglected, as the sensitivity of the interfering input is
mostly much less than the sensitivity of the measurand. In high precision
systems, however, this linearisation is not always allowed, especially when
these eÔ¨Äects need to be compensated.
Many external inÔ¨Çuences show a combination of both eÔ¨Äects. Sometimes
even the gain factors Km and Ki depend on the actual value of the input or
output signal, which makes it even more awkward to model. After compen-
sation of the systematic errors, a precision system generally mainly shows
random interfering errors.
Two other factors that inÔ¨Çuence the output of the element are shown in the
model, the setpoint and the dynamics. The setpoint (a) is an intentional
oÔ¨Äset-value to deÔ¨Åne the range of output values that belongs to a certain
range of input values. For instance with a thermal sensor, a temperature

690
Chapter 8. Measurement in Mechatronic Systems
Linear
Mulplied
Element
Input (i)
Element
Output (o)
Modifying Input (em)
Error source, disturbance
Interfering Input (ei)
Dynamics
Setpoint (a)
+
+


m
m
m
( ,
)
M i e
K
i e


( )
L i
K
i



Added
  

i
i
( )
 
1
n
i
I e
K
f e
n


%


,
 
TF
f t 

Non linearity
  

( )
  
2
n
N i
f i
n

%
Figure 8.2: Functional model of an element in a measurement system. In case of
a sensor the element input is the measurand. Two ways of disturbing
the output signal are shown. The modifying input changes the gain of
the transfer function of the element input, while the interfering input
just adds a signal to the output. Also non-linearity and dynamics can
inÔ¨Çuence the functionality of the element.
range of 5 ‚Äì 25 ‚ó¶C could correspond to an output voltage range of 0 ‚Äì 10 V.
This example would require a linear transfer gain K‚Ñì= 0.5 and a setpoint of
a = 5 V.
The Dynamics box represents the time or frequency dependent behaviour
of the element and can be modelled with dynamic transfer functions. An
typical example of an element with a Ô¨Årst-order dynamic transfer function
is a thermal sensor. The dynamic behaviour is determined by the heat
capacity of the sensor and the heat conductivity between the sensor and the
body to be measured. Second- and higher-order transfer functions are most
often present in mechatronic positioning systems when the position sensor
is located at a diÔ¨Äerent place than the actuator.

8.1. Dynamic Error Budgeting
691
8.1
Dynamic Error Budgeting
Random errors can only be quantiÔ¨Åed by means of statistics because of
their unpredictability. Measurements in mechatronic systems are mostly
continuous and the errors are a combination of a multitude of continuous
interfering random signals. Precision measurements are often repeated
several times to reduce the impact of random measurement errors by av-
eraging. After a short introduction in the general statistics on errors with
repeated single measurements, this section concentrates on the statistics
of signals by introducing the concept2 of Dynamic Error Budgeting (DEB).
This methodology to derive the total error of a system from its diÔ¨Äerent
dynamic contributors, has proven to be extremely valuable in determining
and solving error sources that act on real measurement and positioning
systems.
8.1.1
Error Statistics in Repeated Measurements
In oÔ¨Écial traceable metrology, errors are investigated by means of the analy-
sis of many measurements. The observed distribution of the diÔ¨Äerent values
gives information about the origin of possible error sources, their character
and methods of improvement. The related Ô¨Åeld of probability statistics is
extremely wide with many diÔ¨Äerent distributions that are represented with
a Probability Density Function p(x) (PDF), giving the probability px1,x2 that
a measurement value is observed within a certain range of values from x1
to x2.
px1,x2 =
x2

x1
p(x)dx.
(8.3)
The probability that the measurement can have any value, is by deÔ¨Ånition
equal to one. This implies that the integral from ‚àí‚àûto +‚àûof p(x) always
equals one. The related Cumulative Probability Function (CPF) is deÔ¨Åned
by the integration of p(x) from ‚àí‚àûto x. Often the PDF and the CPF are
represented in a graphical way, like shown in the example of the following
section. This representation clearly illustrates these statistical properties
of the system. On the horizontal axis the range of values is shown while the
vertical axis denotes the probability density or the cumulative probability.
Generally both axes are linear scaled.
2This section is derived from the PhD thesis of Leon Jabben from the Advanced Mecha-
tronics laboratory in Delft University of Technology [47].

692
Chapter 8. Measurement in Mechatronic Systems
8.1.2
The Normal Distribution
In precision positioning systems, errors are observed as deviations in signals
with corresponding frequencies and amplitudes. For a precision measure-
ment system in general, all systematic errors are compensated and cali-
brated. This means that only uncorrelated random signals remain as error
source. As mentioned these errors have mainly an interfering character,
which means that they are independent of the measurand.
Random errors in signals can almost always be represented by means of a
special probability density function, the normal distribution or Gaussian
distribution, named after the same Johann Carl Friedrich Gauss, who postu-
lated two of the Maxwell equations. The normal distribution is characterised
by its mean value x and its variance œÉ2
x, while the square root of the variance
is called the standard deviation œÉx. These terms are deÔ¨Åned in the following
way for multiple measurements:
mean :
x = 1
n
n
i=1
xi,
(8.4)
variance :
œÉ2
x =
1
n‚àí1
n
i=1
(xi ‚àí¬Øx)2 .
(8.5)
For random signals also a third term is introduced, the signal power Ps,
which proves to be useful in combining several error signals. For random
signals the three terms are calculated as follows:
mean :
x = lim
T‚Üí‚àû
1
2T
T

‚àíT
x(t)dt,
(8.6)
power :
Ps = lim
T‚Üí‚àû
1
2T
T

‚àíT
x(t)2 dt,
(8.7)
variance :
œÉ2
x = lim
T‚Üí‚àû
1
2T
T

‚àíT
(x(t)‚àíx)2 dt.
(8.8)
These deÔ¨Ånitions are somewhat extreme as in practice the ‚Äúlim‚Äù term is
never really necessary. Most disturbance signals are quite continuous and
in practice a period T is chosen that suÔ¨Éciently represents these interfering
signals. A practical ‚Äúrule of thumb‚Äù is to take T equal to the period of the
lowest relevant frequency of the spectrum in the disturbance signal. For

8.1. Dynamic Error Budgeting
693
p(x)
0.339

x


2

3


	
2
	
3
	
x
x
x
x
x
x
x
x
x
x
x
x
x
x
cum p(x)
x


2

3


	
2
	
3
	
x
x
x
x
x
x
x
x
x
x
x
x
x
1
0.5
6]
Figure 8.3: The probability density function and cumulative probability function of
a normal distributed random signal with a mean value ¬Øx and a standard
deviation œÉx. The probability that a measurement value is located in a
certain range is equal to the surface enclosed by the graph of the PDF
and the horizontal lines, which correspond to the range boundaries.
this reason in practice the ‚Äúlim‚Äù term can be omitted.
It is also useful to notice that the variance equals the power and the stan-
dard deviation equals the root of the power for signals with a zero mean
value. This standard deviation is then equal to the Root Mean Square value
(RMS) as deÔ¨Åned in Section 2.3.1.2 of Chapter 2.
Figure 8.3 shows a graphical representation of the probability density func-
tion and the cumulative probability function of a normal distributed random
signal.
With the above deÔ¨Ånitions the mathematical expression of the probability
density function is as follows:
p(x) =
1
œÉx

2œÄ
e
‚éõ
‚éù‚àí(x‚àí¬Øx)2
2œÉ2x
‚éû
‚é†
.
(8.9)
The calculation of the probability that the error is between ¬Øx¬±œÉx, ¬Øx¬±2œÉx or
¬Øx¬±3œÉx, results in the following values:
p‚àíœÉx,œÉx =
œÉx
‚àíœÉx
p(x)dx = 0.683,
(8.10)
p‚àí2œÉx,2œÉx =
2œÉx
‚àí2œÉx
p(x)dx = 0.955,
(8.11)
p‚àí3œÉx,3œÉx =
3œÉx
‚àí3œÉx
p(x)dx = 0.997.
(8.12)
These calculations imply that only 68 % of the measured values can be found
in a range of ¬±1œÉ around the mean value. A range of ¬±2œÉ already contains

694
Chapter 8. Measurement in Mechatronic Systems
more than 95 % of all measurements, while at ¬±3œÉ, less than 0.3 % is found
outside the range. For this reason measurement systems are often speciÔ¨Åed
with either 2œÉ or 3œÉ values for the measurement error.
8.1.3
Combining DiÔ¨Äerent Error Sources
Under certain conditions, diÔ¨Äerent error signals can be combined by quite
simple relations. In case of several mutually independent variables, it is
allowed to combine the mean value and standard deviation of each variable
by means of the method of the root of the sum of squares. When Œ±n equals
the proportion of the speciÔ¨Åc variable in the total measurement value, the
following expressions are used to determine the mean value and the standard
variation of the combined measurement:
¬Øxtot = Œ±1 ¬Øx1 +Œ±2 ¬Øx2 +Œ±3 ¬Øx3 +......
(8.13)
œÉtot =

(Œ±1œÉ1)2 +(Œ±2œÉ2)2 +(Œ±3œÉ3)2 +.....
(8.14)
In practice it is often allowed to linearise the diÔ¨Äerent eÔ¨Äects because of the
small variations of the inputs around a certain average value. This allows
the use of simpliÔ¨Åed calculations with systems of which the errors are given
in terms of their mean value and standard deviation.
The linearisation starts with the behaviour of an element according to the
model written as a combination of the diÔ¨Äerent inputs:
o = K‚Ñìi + a+ N(i)+ Kmiem + Kiei.
(8.15)
For small deviations the non-linear term N(i) can be combined with the
linear term L(i) and the equation becomes:
Œ¥o = ‚àÇo
‚àÇi Œ¥i + ‚àÇo
‚àÇem
Œ¥em + ‚àÇo
‚àÇei
Œ¥ei,
(8.16)
where:
‚àÇo
‚àÇi ‚âàK‚Ñì,
‚àÇo
‚àÇem
‚âàKmi,
and
‚àÇo
‚àÇei
‚âàKi.
(8.17)
In most cases the diÔ¨Äerent inputs are independent and their impact can be
statistically combined using the rule of ‚Äúthe root of the sum of squares‚Äù. The
combined standard deviation of the element becomes:
œÉo =

‚àÇo
‚àÇi
2
œÉ2
i +

 ‚àÇo
‚àÇem
2
œÉ2em +

 ‚àÇo
‚àÇei
2
œÉ2ei.
(8.18)
And the median can be derived by simple addition:
¬Øo = K‚Ñì¬Øi + a+ N(i)+ Kmiem + Kiei.
(8.19)

8.1. Dynamic Error Budgeting
695
8.1.4
Power Spectral Density and Cumulative Power
Dynamic error budgeting is a method to derive the total error in a dynamic
system by using the described statistical methods to combine the contri-
butions of all disturbance sources into one error value. The method starts
with ‚Äúthe root of the sum of squares‚Äù, which directly relates to the power of
the diÔ¨Äerent disturbance signals that act on a measurement system. When
the total error of a measuring instrument by diÔ¨Äerent error sources needs
to be determined with this method, it is most useful to use two important
related functions, the Power Spectral Density (PSD) and the Cumulative
Power Spectrum (CPS). The power spectral density P(f ) gives the power3 of
a signal, for instance a position x within a certain frequency range:
Pf1,f2 =
f2

f1
P(f )df
6
m2/Hz
7
.
(8.20)
The cumulative power spectrum is calculated by integrating P(f ) starting
from 0 Hz with increasing frequency until no further increase is observed.
Also these spectra are shown in a graph with the frequency on the horizontal
axis and the magnitude of the power density or the cumulative power on
the vertical axis. The axes of the power spectral density are preferably
double logarithmic, because the error signal characteristics often show a
strong similarity with the Bode plot of the dynamic transfer functions. The
magnitude scale of the cumulative power spectrum is noted on a linear
scale in order to avoid confusion with the contributions of the diÔ¨Äerent error
sources. To illustrate this method of dynamic error budgeting, Figure 8.4
shows as an example the eÔ¨Äect of three error sources on the inspection
microscope that was introduced in Chapter 3.
The Ô¨Årst error source is due to the transmission of Ô¨Çoor vibrations to the
sensitive part of the instrument. To prevent this transmission, a vibration
isolation system is applied, consisting of springs, between the table and the
Ô¨Çoor. This vibration isolation system has a Ô¨Årst eigenfrequency at 2 Hz. The
resulting power spectral density is determined by the unÔ¨Åltered vibrations
of the Ô¨Çoor, the transmissibility transfer function of the vibration isolation
system and the sensitivity of the instrument to this interfering error source.
At low frequencies the microscope acts as a rigid body and the impact is low.
At the resonance of 2 Hz a maximum is reached in the spectral density, with
a negative slope at higher frequencies due to the transmissibility transfer
function of the vibration isolation system. At 160 Hz the resonance of
3Here with power the squared value of the signal is meant!

696
Chapter 8. Measurement in Mechatronic Systems
10
z,
10
0
10
1
10
2
10
3
10
z¬Å
10
0
Frequency [Hz]
P( f )  [nm2/Hz]
total
^

\
10
z,
10
0
10
1
10
2
10
3
0
Frequency [Hz]
 CPS
 CAS
6]
100
10
4
80
8 10
3
60
6 10
3
40
4 10
3
20
2 10
3
0
.
.
.
.
 / RMS   [nm  ]
2
/ RMS  [nm]
M
Object
Table to
Floor vibraon 
2 Hz
,¬Å{¬Ä¬ç



 ~30 nm RMS
 ~90 nm RMS
2


 2
Figure 8.4: The power spectral density, the cumulative power spectrum and the
cumulative amplitude spectrum of an inspection microscope with dif-
ferent error sources, the Ô¨Çoor vibrations, acoustic disturbance forces
acting on the measurement head and the dynamic disturbance from
the measurement head itself. The resonance of the vibration isolation
system at 2 Hz and the resonance of the microscope head at 160 Hz
show to be the main error contributors.
It is clearly shown that the Cumulative Amplitude Spectrum gives a
wrong indication of the magnitude of the contributing error sources
as it seems that the disturbance at 2 Hz has an equal eÔ¨Äect as the
disturbance at 160 Hz, while in reality the high frequency disturbance
is dominant in the total error. When taken alone the 2 Hz disturbance
only causes an error of 30 nm.
(Courtesy of Leon Jabben)
the measurement head shows the typical dynamic decoupling eÔ¨Äect of this
eigenmode.
The second error source originates from acoustical disturbances by for in-

8.1. Dynamic Error Budgeting
697
stance the air conditioning unit of the room. The power spectral density of
the combination of these disturbances with the sensitivity of the instrument
shows a maximum at the resonance frequency of 160 Hz.
The third error source is caused by the dynamic properties of a feedback
controlled positioning system, that moves the measurement head within the
microscope. It causes an increase of the internal resonance of the microscope
head, which is also most disturbing at the 160 Hz resonance frequency.
The total power spectral density is the sum of all PSD graphs and due to
the logarithmic scale, it is equal to the enveloping curve of the three error
contributors. In this example the total error spectrum appears to be only
determined by the Ô¨Çoor vibrations and the dynamic disturbances by the
positioning system of the microscope head. The acoustic disturbance eÔ¨Äect
remains below the error Ô¨Çoor over the full frequency range.
The next step that is necessary to derive the total error is the determination
of the cumulative power spectrum. Starting at low frequencies, a Ô¨Årst rise
in the cumulative spectrum is observed in the graph at 2 Hz and a much
larger second rise at 160 Hz with a Ô¨Ånal power level of ‚âà8.1¬∑103 nm2. This
diÔ¨Äerence in magnitude is confusing at Ô¨Årst sight, as the surface of the
peak in the PSD at 2 Hz is much larger than the surface of the peak at
160 Hz. This is however caused by the logarithmic frequency scale of the
PSD. Integrating the PSD over that low-frequency area only results in a
relatively small cumulative value. To determine the standard deviation of
the Ô¨Ånal error, the root of the total CPS value should be taken, which is
90 nm in the above example. This value is much higher than the 10 nm
error that was calculated in Chapter 3, because of the two eigenmodes in
the system. This diÔ¨Äerence is caused by the two undamped resonances and
the largest contributor to this error is the badly designed controller of the
positioning system of the microscope head.
As was shown in Chapter 4 on motion control, an undamped mass-spring
system can be controlled with a well tuned PD-control setting such that
the resonance is completely suppressed by shifting the poles to the left in
the complex plane. In that case no resonance will occur in the dynamic
disturbance and the step in the CPS at 160 Hz will become negligible. The
remaining error of around 30 nm is then only determined by the Ô¨Çoor vibra-
tions. As a consequence the next improvement measures should be focused
on the vibration isolation system where some damping might be suÔ¨Écient
to suÔ¨Éciently reduce the peak at 2 Hz. Too much damping will however
increase the disturbance by the Ô¨Çoor vibrations at higher frequencies so this
measure should be taken with precaution.

698
Chapter 8. Measurement in Mechatronic Systems
8.1.5
Do not use the Cumulative Amplitude Spectrum!
When trying to achieve the minimum error level in a complete measuring
system, designers often directly convert the CPS graph into a Cumulative
Amplitude Spectrum (CAS)4 graph by deriving the root of the CPS values,
because they think it relates more directly to the total error. Although the
resulting fully cumulated end value remains the same, this representation
is, however, not advisable for problem solving. By taking the root, the impact
of the disturbances at the low-frequency side is visually enlarged, relative
to the impact of the disturbances at higher frequencies.
This is clearly illustrated in Figure 8.4 by the red line of the CAS graph as
compared with the blue line of the CPS graph. When observing the CAS
graph only, a designer could erroneously conclude that the total error can
be reduced with approximately 30 nm by simply adding damping to the
vibration isolation system. Unfortunately however, the PSD would then
only be reduced from ‚âà8.1¬∑103 nm2 to ‚âà7¬∑103 nm2, resulting in an error
amplitude of 83 nm, only an almost negligible 9 nm below the previous
value. This counter intuitive eÔ¨Äect is fully caused by "the root of the sum of
squares".
8.1.6
Variations in Dynamic Error Budgeting
The cumulative power spectrum can in principle also be determined by
starting the integration at higher frequencies and integrating towards
lower frequencies or integrating over a relevant frequency band. The Ô¨Årst
would result in a cumulative power spectrum with the same rise magnitudes
at critical frequencies as when starting integration at low frequencies, so
it would lead to the same conclusions. Such a reversed integration over a
cumulative amplitude spectrum would however look completely diÔ¨Äerent. In
the example case of the inspection microscope the resonance at 160 Hz would
be even more emphasised and the eÔ¨Äect at 2 Hz would almost disappear.
This other integration approach shows once more that only the cumulative
power spectrum should be used for analysing the impact of diÔ¨Äerent error
sources in a high precision mechatronic positioning system.
4It should be noted that the word ‚ÄúAmplitude‚Äù in the CAS is erroneous as not the amplitude
of a signal is calculated, but the standard deviation (œÉ) or the RMS value in the case that the
mean value is zero.

8.1. Dynamic Error Budgeting
699
8.1.7
Sources of Noise and Disturbances
The sources of disturbing signals in mechatronic systems all have either a
mechanical or an electronic nature while many of the observed phenomena
have a thermal root cause. Large scale deformations by heating can partly
be avoided by a careful design, that takes all expansion eÔ¨Äects into account,
but ultimately always some thermal eÔ¨Äects will remain, especially when
the heat Ô¨Çow is not constant. Most probably this direct thermal disturbance
on system accuracy will always remain a limiting factor in the precision of
high performance mechatronics.
Thermal eÔ¨Äects have their dynamic impact also on the small scale as they
are the root cause for the noise in electronic components like resistors.
The large scale deformations by thermal eÔ¨Äects mainly occur in the low-
frequency area. In the following a short overview is given of some important
sources of higher frequency dynamic noise in the mechanical and electronic
domain:
8.1.7.1
Mechanical Noise
The most important source of mechanical dynamic disturbances are vibra-
tions that either are caused by movement of the support, the Ô¨Çoor vibrations,
or by forces from vibrating parts in the machine itself. Floor vibrations
can be caused by traÔ¨Éc, wind, earthquakes and other machines or moving
people in the neighbourhood. The power spectral density of Ô¨Çoor vibrations
can consist of real uncorrelated random signals and of systematic signals
caused for instance by rotating equipment. When the ultimate of precision
is aimed for, it is always necessary to analyse the vibrations on a certain
location with measurements over a representative time span, at least over
a full twenty-four hours period on a busy day. For production equipment
like wafer scanners it is not possible to adapt the machine to all diÔ¨Äerent
locations and it is better to work with a certain standard speciÔ¨Åcation. Fig-
ure 8.5. shows the speciÔ¨Åcation of an ASML wafer scanner in comparison
with the BBN criteria that were deÔ¨Åned by the American company Raytheon
BBN Technologies.

700
Chapter 8. Measurement in Mechatronic Systems
10
0
10
1
10
2
10
z¬Ü
10
z¬Ñ
10
z¬É
10
z¬Å
frequency [Hz]
PSD [(m/s 2)2/Hz]
ASML
BBN C
BBN D
Figure 8.5: Power spectral density of Ô¨Çoor vibration speciÔ¨Åcations from ASML and
BBN.
(Courtesy of Leon Jabben)
8.1.7.2
Electronic Noise
Electronic noise has many origins, which are named after their behaviour,
like thermal, shot, excess, burst and avalanche noise. The most relevant
sources of electric noise that impair precision mechatronic systems is pre-
sented in the following short overview:
Thermal Noise
Any resistor will have a Ô¨Çuctuating potential diÔ¨Äerence across its terminals
that is superimposed on the voltage caused by the current through the
resistor. The Ô¨Çuctuating voltage is caused by the thermally induced random
motion of charge carriers like electrons. Thermal noise has a normal proba-
bility density function and a Ô¨Çat power spectral density, called white noise.
The noise from a resistor can be described as a voltage source in series with
the resistor, with a power spectral density of:
NT = 4kTR
6
V2/Hz
7
,
(8.21)
with k the Boltzmann‚Äôs constant (1.38¬∑10‚àí23 J/K), T the temperature and
R the resistance. To give an example, a resistor of 1 kŒ©, at 20‚ó¶C will show
noise with a RMS value of 0.13 ŒºV from 0 Hz up to 1 kHz.

8.1. Dynamic Error Budgeting
701
Shot Noise
Shot noise results from the random passage of individual charge carriers
across a potential barrier. This is often seen with junctions in a transistor.
The noise has a normal probability density function and has a white spectral
density:
NS = 2qeIDC
6
A2/Hz
7
,
(8.22)
with qe the charge of an electron (1.6¬∑10‚àí19 [C]), IDC the average current
[A]. An average current of 1 A will introduce noise with an RMS value of
18 nA from zero up to one kHz.
Excess Noise
The noise in excess of the thermal and shot noise when a current passes
through a resistor or a semiconductor, is called excess noise. Other names
are Ô¨Çicker noise or one-over-f (1/f ) noise. This noise source results from
Ô¨Çuctuating conductivity due to imperfect contact between two materials.
This is the reason why carbon composition resistors, which are made up
of many tiny particles molded together, show more excess noise than wire
wound resistors. The power spectral density of excess noise increases when
the frequency decreases:
NE = Kf
f Œ±
6
V2/Hz
7
,
(8.23)
where Kf is dependent on the average (DC) voltage drop over the resistor
and the index Œ± is usually between 0.8 and 1.4, and often set to unity for an
approximate calculation. For resistors the excess noise is proportional to
the average voltage drop V over the resistor, which is why manufacturers
typically specify the excess noise as a noise index CR for one frequency
decade:
CR =
œÉ‚àó
V ¬∑106
V
ŒºV/V

.
(8.24)
with œÉ‚àó
V the being the standard deviation over one decade frequency range
of the voltage. For standard resistors the noise index CR typically ranges
from 1 to 10. For example, if the noise index equals 10, an average voltage
drop of one volt introduces noise with an RMS value of 17 ŒºV in a frequency
range from 1 up to 1000 Hz. Note that a frequency range 1 mHz up to 1 Hz
introduces an equal amount of noise because of the low-frequency range!

702
Chapter 8. Measurement in Mechatronic Systems
Using Noise Data from Data-Sheets
The given data on noise in diÔ¨Äerent data-sheets of electronic components
are most frequently given in terms of [V/

Hz] as an RMS density instead
of the power density. This is done to be able to easily calculate the noise-
voltage contribution of one single electronic component. It is important to
emphasise here that these values should Ô¨Årst be squared and then combined
to determine the total power spectral density of the system.
Errors have been made by designers who used the RMS data directly as
PSD, without Ô¨Årst taking their squared value, and as a result they got a
very low disturbance level after taking the root of the CPS. But also a non-
statistical worst-case addition of the noise voltages per electronic element
gives erroneous results as the noise voltages are mostly uncorrelated and
as a consequence the worst-case addition gives a too high calculated total
noise level.
These designer errors either result in an unobserved problem that will pop-
up in the realisation of the mechatronic system, when the measurements
unveil the real total noise, or it will give rise to a too expensive design,
because the calculated worst-case noise value was targeted to remain below
the speciÔ¨Åcation of the total system.
In any case these errors can be avoided by using the method of Dynamic
Error Budgeting in the right way.

8.2. Sensor Signal Sensitivity
703
8.2
Sensor Signal Sensitivity
Most of the information exchange inside and between all elements in a
measurement system takes place in the electronic domain. Figure 8.6
shows a simpliÔ¨Åed electronic model of the measurement system. The input
impedance of every successive element determines the load for the output
of the preceding element. Depending on the diÔ¨Äerent properties of each
element the requirements for the successive element can be quite extreme.
In most cases the output impedance of the sensing element is reasonably
high. A large output current with a high voltage would correspond to a
high power level that has to originate from the physical phenomenon that is
measured. This means that in general the input impedance of the successive
element should be either be as high as possible with a very small input
current or as low as possible with a very small input voltage. In both cases
the input power will be limited.
Also the power supply connections are shown. The power supply of the sens-
ing element is dashed because not all sensing principles need an external
power input. Still all these connections can and will cause errors of a mainly
interfering character, when not designed well.
This section will deal with the most sensitive part of the measurement chain,
the sensing element and its interconnections.
Vs
+
_
+
_
V = GVi
+
_
Zo,a
Zi,a
Zs
Vi,a
Zi,p
+
_
Vi,p
a
Sensing
#$$
Signal processing
    A - D
Converter
Data
V   
p
+
V   
p-
V   
p
+
V   
p-
V   
p
+
V   
p-
Figure 8.6: The electronic model of a measurement system shows the connection
between the three elements and the power supplies. Every successive
element determines a load for the preceding element. The output of
the Ô¨Årst two elements is shown in the Thevenin model with a voltage
source. Depending on the properties of the system also a current source
Norton equivalent model can be applied.

704
Chapter 8. Measurement in Mechatronic Systems
8.2.1
Sensing Element
The sensitivity of a sensing element for a certain physical quantity is based
on the eÔ¨Äect of that quantity on an electrical property of that sensor. Almost
by deÔ¨Ånition this does not exclude sensitivity for other physical phenomena
that will act either as an interfering input, as a modifying input or as a
combination of both. This is the Ô¨Årst problem that a mechatronic designer
encounters, when choosing a suitable sensor. The most prominent example
of this phenomenon is the inÔ¨Çuence of temperature on almost every electri-
cal property of any sensor. Even when measuring the temperature itself,
the measurement is often inÔ¨Çuenced by temperature values elsewhere in
the measurement system.
The following non exhaustive list shows some representative sensing prin-
ciples. They can be distinguished into two diÔ¨Äerent operation principles.
The Ô¨Årst principle relates to the capability of a sensor to directly generate
an electrical signal by converting energy from the physical phenomenon
into electric energy. The second principle is based on the variability of an
electrical impedance by the physical phenomenon.
Examples of direct generation of an electrical signal are:
‚Ä¢ The voltage diÔ¨Äerence between diÔ¨Äerent metals to measure tempera-
ture diÔ¨Äerences.
‚Ä¢ The voltage induced in a coil by a changing magnetic Ô¨Åeld, proportional
to the relative velocity.
‚Ä¢ The voltage induced over a piezoelectric crystal by deformation due to
a force.
‚Ä¢ Electrons in the depletion layer of a diode that are excited by photons
of the incident light and create an electric current.
Examples of a variable electrical impedance are:
‚Ä¢ The change of resistance of a resistor by temperature or strain.
‚Ä¢ The change of the capacitance value of a capacitor by a displacement
of the electrodes.
‚Ä¢ The change of the self inductance of an inductor by a change in the
magnetic geometry.
Not all sensors are capable of directly converting a physical quantity into
electricity. They Ô¨Årst need to create one of the primary eÔ¨Äects from the list

8.2. Sensor Signal Sensitivity
705
above by additional preceding steps. Take for example the measurement
of Force. Force is a physical quantity that can not be directly measured as
it manifests itself either as the acceleration of a mass or by deformation of
material. This means that for measuring a force, it is necessary to measure
either the corresponding acceleration or the deformation. Later in this
chapter it will be shown that acceleration is in most cases measured by
measuring the deformation of a material, caused by the force that is needed
to accelerate a known seismic mass.
8.2.2
Converting an Impedance into an Electric Signal
In the previous section it was shown that sensing principles can be based on
a changing electrical impedance. Before this information can be treated in
the same way as a directly generated electrical signal, it is Ô¨Årst necessary
to convert this impedance into an electrical signal5.
The most simple way to achieve this conversion is by applying Ohm‚Äôs Law
and either supply the impedance with a well-known current and measure
the resulting voltage over the impedance or do just the opposite by applying
a voltage source and measuring the current. An AC source must be used
with a complex impedance like a capacitor or an inductor, but apart from
that, the reasoning is the same.
Although modern electronics can be made rather precise, often special mea-
sures are needed to prevent errors that are related to the low sensitivity
of many sensing impedances. When a potentiometer is used to measure
the displacement of the slider, the output voltage ranges from the supply
voltage Vi to zero. This is a suÔ¨Éciently large signal, when compared with
interfering signals, and generally no further measures are needed. Another
example of a very sensitive resistive sensor is the NTC, a resistor with a
negative temperature coeÔ¨Écient based on semiconductor properties. Its
resistance can for instance range between 50 and 1000 Œ© for a temperature
change from 0 ‚Äì 100 ‚ó¶C. With 1 mA current this results in a sensitivity of
approximately 10 mV/‚ó¶C, which is also suÔ¨Écient for most practical measure-
ments.
Unfortunately most variable impedance sensors have a much lower sensitiv-
ity and the noise in the supply current or voltage will play a much larger role
with those sensors. Take for instance a strain gage, a resistor to measure the
strain in a material by an increase of its resistance, when elongated. With
5Often this conversion is considered as a part of the signal conditioning element. This is
however not logical with the aforementioned deÔ¨Ånition of the sensing element

706
Chapter 8. Measurement in Mechatronic Systems
those elements, the practical resistance change upon load Œ¥R/R is often less
than 1 %. When this strain gage is supplied with a constant current source
Ip, it is very diÔ¨Écult to keep the noise in this source below 10‚àí6 √ó Ip. With
an average value of R = 100 Œ©, this noise causes an error with a constant
RMS value in the measurement of 10‚àí6 √ó100 Œ©. With Œ¥R/R ‚â§0.01, the signal
to noise ratio is less than 104 and because the error signal has a constant
RMS value this is unacceptable for any precision measurement system.
Also the temperature has a large eÔ¨Äect on most resistive sensors and this
inÔ¨Çuence directly interferes with the resistance change of the measurement.
8.2.2.1
Wheatstone Bridge
To reduce the negative eÔ¨Äects associated by the noise in the voltage source
of impedance measurement electronics, sensors like strain gages are mostly
connected in a Wheatstone bridge, named after the British scientist Sir
Charles Wheatstone (1802 - 1875), who popularised its use after the inven-
tion by the British scientist Samuel Hunter Christie (1784 - 1865).
The thinking model behind the usefulness of the Wheatstone bridge is best
explained by means of Figure 8.7. In principle the bridge consists of two
voltage dividers that share the same voltage source. These voltage dividers
+
_
Vp
Z1
Z2
V1
+
_
Z3
Z4
V2
+
_
+
_
Vp
V1
+
_
V2
+
_
+
_
1          2
oV
V
V

	
1
2
3
4
Figure 8.7: A Wheatstone bridge has two branches each consisting of a voltage di-
vider. Only the diÔ¨Äerential voltage between the outputs of both branches
is used as measurement signal. Frequently the Wheatstone bridge is
drawn in a tilted square conÔ¨Åguration as shown right to emphasise
the diÔ¨Äerential output voltage Vo. When all resistors are equal the
diÔ¨Äerential voltage is zero and the common-mode voltage is half the
supply voltage.

8.2. Sensor Signal Sensitivity
707
are also called the two branches of the Wheatstone bridge. The Ô¨Årst branch
consists of Z1 and Z2 with a corresponding output voltage V1. Similarly
the second branch consists of Z3 and Z4 with output voltage V2. The total
measurement signal is obtained by using an ideal diÔ¨Äerential ampliÔ¨Åer to
amplify only the diÔ¨Äerence voltage Vo = V1 ‚àíV2 without loading the bridge.
The beneÔ¨Åt of this conÔ¨Åguration becomes clear when starting in the situa-
tion that all four resistors are equal. This would result in equal voltages
V1 = V2 = 1/2Vp and the voltage diÔ¨Äerence Vo would then be zero. This is
called an ideally balanced bridge and in that case the inÔ¨Çuence of the power
supply voltage Vp would be cancelled in the diÔ¨Äerential voltage. It would
only create a common-mode noise voltage and this will be rejected by the
diÔ¨Äerential ampliÔ¨Åer.
As soon as one of the resistors, for instance Z2, changes its value, it will
cause V1 to change, resulting in a non-zero voltage diÔ¨Äerence Vo. In this
new situation the noise of the voltage source will also be observed in the
diÔ¨Äerential voltage signal but at a much smaller value, proportional to
the measurement signal. With the same sensor and source voltage of the
previous example, this would result in a relative RMS noise level of 10‚àí6 of
the signal value, which is far better than the previously obtained constant
RMS noise level of 10‚àí4 of the maximum signal value.
In theory it is not really necessary that all resistors are equal to realise a
balanced bridge, as long as V1 remains almost equal to V2. This condition
is always met, when the ratios of both branches of the Wheatstone bridge
are equal (Z1 : Z2 = Z3 : Z4). For example one of the branches can consist
of resistors with much higher values than those in the other branch, like
Z1 = Z2 = 2 kŒ© and Z3 = Z4 = 200 Œ©.
In principle also Z1 can be diÔ¨Äerent from Z2 as long as their ratio is equal
to the ratio between Z3 and Z4 but that is in most cases not a preferred situ-
ation. With most sensors the impedance variation is only a small fraction
of the nominal impedance of the sensor, proportional to the measurand i,
so Œ¥Z/Z ‚àùi ‚â™1. For those sensors a maximum sensitivity is obtained when
Z1 = Z2 and Z3 = Z4.
This statement can be proven by calculating the sensitivity of for instance
V1 as function of its measuring impedance Z2 = R +Œ¥R for diÔ¨Äerent values of
the other impedance Z1 = xR. With Œ¥R/R = cmi, where cm is a constant, Œ¥R
can then also be written as Rcmi and the voltage V1 becomes:
V1 = Vp
R +Œ¥R
xR + R +Œ¥R = Vp
R(1+ cmi)
R(x+1+ cmi) = Vp
1+ cmi
x+1+ cmi
[V].
(8.25)
The sensitivity can be approximated as mainly linear because cmi ‚â™1 and
the corresponding value of the linear gain K‚Ñìbecomes equal to the derivative

708
Chapter 8. Measurement in Mechatronic Systems
0
1
2
3
4
5
6
0
0.05
0.1
0.15
0.2
0.25
#/|c )
¬ãx
s
Figure 8.8: The sensitivity factor of a wheatstone bridge is maximum when the
impedance values in each branch are equal (x = 1), resulting in a working
point of half the supply voltage.
of V1 over i:
K‚Ñì= dV1
di = Vp
(x+1+ cmi)(cm)‚àí(1+ cmi)(cm)
(x+1+ cmi)2
= Vp
xcm
(x+1+ cmi)2 ‚âàVpcm
x
(x+1)2 = Vpcmcs.
(8.26)
with cs being the sensitivity factor of the Wheatstone bridge. The mentioned
approximation is allowed when cmi ‚â™1. The maximum sensitivity is found
when the derivative of cs over x becomes zero:
dcs
dx = (x+1)2 ‚àíx(2x+2)
(x+1)4
= (x+1)2 ‚àí2x(x+1)
(x+1)4
=
1‚àíx
(x+1)3 .
(8.27)
This derivative is zero for x = 1 and x = ‚àû, but the second value of x also
gives a zero value for the sensitivity K‚Ñì. This means that only x = 1 is a
useful answer, proving the statement that the values of the impedances in
each branch of the Wheatstone bridge should be approximately equal for a
maximum sensitivity.
This conclusion is further illustrated in Figure 8.8, emphasizing the non-
linear relation between the sensitivity and the ratio of the impedances. Only
in a small area around x = 1 the sensitivity is almost constant.
As a last variation on the Wheatstone bridge, the two branches might diÔ¨Äer
in the kind of impedance that is applied. For instance one branch can
consist of two resistors, while the other branch can consist of two complex
impedances of the same kind, like two capacitors or two inductors. Other

8.2. Sensor Signal Sensitivity
709
combinations with for instance only one capacitor are not allowed as then the
output voltages would show a relative phase shift for AC voltages because
of the Ô¨Åltering. This would result in a measurable voltage diÔ¨Äerence with a
corresponding noticeable noise level, even without measurement signal.
The application of complex impedances will be demonstrated more in detail
in Section 8.5.2 and thereafter with the presentation of capacitive and
inductive proximity sensors.
Temperature Compensation and Linearisation
When all resistors in a balanced resistive Wheatstone bridge share the same
temperature and the same temperature sensitivity, the output voltage is
also no longer aÔ¨Äected by the temperature. This seems attractive at Ô¨Årst
sight, but these conditions are not easily met, because the temperature
of all elements are hardly ever equal. The not-sensing impedances of the
bridge are in most cases located inside the measurement instrument, at
some distance from the measurement location. In principle the requirement
for an equal temperature can be alleviated a bit as only each branch needs to
be isothermal, because in that case the ratio of both branches is not aÔ¨Äected
by the temperature. This means that one of the branches can remain inside
the measuring instrument at an equal temperature, while the other branch
is fully located at the measurement site.
When possible, this second element in the sensor branch of a Wheatstone
bridge should also be used for active measuring the phenomenon of interest.
+
Vp
+
_
o
V
1
2
3
4
+
Vp
+
_
o
V
1
2
3
4
+
Vp
+
_
o
V
1
2
3
4
+
Vp
+
_
o
V
1
2
3
4
             a: Single              b: Double, opposite sign     c: Double, same sign   d:  Two double, opposite sign
R
R
 
R
R
 
R
R
 
R
R
	
R
R
 
R
R
 
R
R
	
R
R
	
R
R
 
R
R
R
R
R
R
R
Figure 8.9: Four conÔ¨Ågurations of a Wheatstone bridge with maximum sensitivity,
showing the diÔ¨Äerent conÔ¨Ågurations that can be chosen when a mul-
tiple of variable impedances are available. Versions a: and c: suÔ¨Äer
from a small non-linearity and both are not temperature compensated.
The other two versions are both linear around the working point and
temperature compensated.

710
Chapter 8. Measurement in Mechatronic Systems
As will be demonstrated in the following this second sensor would be opti-
mally applied, when it gives an opposite change of its impedance with an
equal magnitude as the Ô¨Årst sensor impedance. To investigate this eÔ¨Äect,
Ô¨Årst the sensitivity of the full Wheatstone bridge is written down. The
bridge is assumed optimal in respect to sensitivity so all impedances are
as much as possible equal. Using the notation for the impedances from
Figure 8.9, the output voltage Vo is given by the following generic equation:
Vo = Vp

Z2
Z1 + Z2
‚àí
Z4
Z3 + Z4

[V].
(8.28)
With the given values, the output voltage of the single sensor version with
Z4 = R +Œ¥R and Z1 = Z2 = Z3 = R becomes:
Vo = Vp

1
2 ‚àíR +Œ¥R
2R +Œ¥R

[V].
(8.29)
After combining the terms with a common denominator, this equation can
be written as:
Vo = ‚àíVp
Œ¥R
4R +2Œ¥R ‚âà‚àíVp
Œ¥R
4R
[V].
(8.30)
The approximation is allowed as long as Œ¥R ‚â™2R. In the not approximated
equation the Œ¥R term in the denominator causes a small non-linearity in
the sensitivity. Also the thermal eÔ¨Äects in Z4 are not compensated.
The situation becomes however quite diÔ¨Äerent with two sensing elements
with an opposite sign of the impedance change. This is shown in the second
drawing of Figure 8.9, where the second sensing impedance is located at
the other impedance of the same branch, so Z3 = R ‚àíŒ¥R. With this double
sensing principle the output voltage becomes:
Vo = Vp

1
2 ‚àíR +Œ¥R
2R

= ‚àíVp
Œ¥R
2R
[V].
(8.31)
This equation is fully linear with a double sensitivity, when compared to
the single sensing principle and also the thermal eÔ¨Äects are compensated
as both sensing elements are located at the measurement site.
It should be noted that this linearity is limited to the optimal working point
with all resistors approximately equal.
At Ô¨Årst glance the second sensor could also be located in the other branch
at Z2. With very small impedance changes this indeed would give approx-
imately the same eÔ¨Äect on the diÔ¨Äerential voltage but the non-linearity
would not be cancelled as can be seen by Ô¨Ålling in the data:
Vo = Vp

 R ‚àíŒ¥R
2R ‚àíŒ¥R ‚àíR +Œ¥R
2R +Œ¥R

= ‚àíVp
2RŒ¥R
4R2 ‚àí4RŒ¥R +(Œ¥R)2 ‚âà‚àíVp
Œ¥R
2R
[V]. (8.32)

8.2. Sensor Signal Sensitivity
711
In this case the thermal eÔ¨Äects are still compensated as these work equal in
both branches but the non- linear terms in the not approximated equation
still underline the optimal location of both sensors in the same branch.
The negative eÔ¨Äect of using two sensors in diÔ¨Äerent branches is also demon-
strated in the third conÔ¨Åguration of Figure 8.9. This conÔ¨Åguration is unfor-
tunately the only option, when the second sensing element has the same
sign for its sensitivity as the Ô¨Årst sensing element. In that case for instance
Z1 and Z4 are replaced by the two equally acting sensing impedances R+Œ¥R.
The calculation of the output voltage gives the following result for this
situation:
Vo = Vp
Œ¥R
2R +Œ¥R ‚âàVp
Œ¥R
2R
[V].
(8.33)
Although the sensitivity is also approximately twice the value of the single
sensing principle, the non-linearity is not cancelled. The main disadvantage
is however, that the thermal problem is not solved, because of the diÔ¨Äerent
location of the impedances in their branch. A simultaneous equal change
in the impedance by the temperature will cause a diÔ¨Äerential interfering
voltage adding to the voltage of the useful measurement signal.
It should be noted, that the same result but with a diÔ¨Äerent sign would be
obtained when Z2 and Z3 are replaced by the two sensing elements instead
of Z1 and Z4.
Thinking further on this path, it appears that the most optimal conÔ¨Åguration
is created, when all four impedances of the Wheatstone bridge would be
replaced by sensing elements. This results in a total signal of:
Vo = Vp
R ‚àíŒ¥R
R +Œ¥R + R ‚àíŒ¥R ‚àí
R +Œ¥R
R +Œ¥R + R ‚àíŒ¥R = ‚àíVp
Œ¥R
R
[V].
(8.34)
In this conÔ¨Åguration, both the temperature eÔ¨Äects and the impact of the
noise of the source is minimised, the sensitivity is maximum, the sensor is
linear around the working point and only 4 connections are needed to the
measurement electronics.
It will be shown in Section 8.6.1 how this can be accomplished in an inte-
grated strain gage element.
Remark on non-linearity: The argumentation regarding non-linearity
has become less important over the years with the introduction of digital
data processing. In principle non-linearity is a deterministic error and it
can be compensated with the described model. It is certainly true to say,
that compensation is as good as the model is described and nothing is ideal
so ‚Äúprevention is still always better than curing‚Äù, but in many situations a
less optimal bridge conÔ¨Åguration can be compensated to an acceptable error
level.

712
Chapter 8. Measurement in Mechatronic Systems
8.2.3
Electronic Interconnection of Sensitive Signals
Like mentioned before, in most cases the electrical signals, generated in
a sensing element, are still susceptible to interfering signals from exter-
nal sources of energy, because of their small amplitude and high source
impedance. The sensitivity for these disturbances demands a careful con-
sideration of the interconnection from the sensing element to the signal
conditioning element. Although this interconnection is the most critical in
a measurement system also the other connections can cause problems but
Ô¨Årst the purely analogue most sensitive interconnection will be examined.
All elements have to be interconnected with minimal two wires, because
electricity Ô¨Çows in a loop, and both wires are susceptible to interference.
Figure 8.10 gives an overview of the interconnection between two elements
of a measurement system with the diÔ¨Äerent external disturbance sources
that can act on this interconnection.
8.2.3.1
Magnetic Disturbances
The Ô¨Årst source of disturbances is related to voltages that are induced in a
closed electric loop by changing magnetic Ô¨Åelds from power transformers and
high currents in nearby electronic circuits. For both wires these voltages
have mostly a diÔ¨Äerent value. The reason is, that their corresponding loop
encloses a diÔ¨Äerent surface, resulting in a voltage diÔ¨Äerence V +
n,s ‚àíV ‚àí
n,s that
is added to the output voltage of the Ô¨Årst element. When these voltages
would be equal, the diÔ¨Äerential voltage would be zero and only a common-
mode disturbance input voltage would be present at the next element. This
common-mode voltage was deÔ¨Åned in Chapter 6 with the operational ampli-
Ô¨Åer and represents the average value of both input voltages. This impact
of a common-mode voltage can be reduced by using a diÔ¨Äerential ampliÔ¨Åer
with a high ‚Äúcommon-mode rejection ratio‚Äù in the following element.
Unfortunately it is impossible to have the two wires follow exactly the same
path as then they would make contact and create a short circuit. It is also
not possible to isolate a sensitive system from magnetic Ô¨Åelds as no materi-
als exist with a relative magnetic permeability Œºr of zero, which would be
needed to lead magnetic Ô¨Åelds away from the sensitive electronics. Magnetic
Ô¨Åelds can only be reduced to some extent by fully closed thick layers of fer-
romagnetic material for low-frequency magnetic Ô¨Åelds and by a fully closed
conductive shielding for high-frequency magnetic Ô¨Åelds (eddy-currents), but
that solution is very unpractical in many situations.
To solve this magnetic interference in a more practical way, two methods

8.2. Sensor Signal Sensitivity
713
Vs
+
_
+
_
Vi
+
_
Sensing 
Signal condioning
Magnec interference
+
+
_
Ground 
Vn,g
+
_
Vn,c
Capacive interference
Zc1
Zc2
GVi
+
_
Zo
Ground loop 
Signal loop 
n,s+
     
V
n,s-
     
V
g
d
dt

s
d
dt

1
2
_
Z4
Zs
Zg2
Zg1
Figure 8.10: Overview of diÔ¨Äerent sources of interfering signals acting on the con-
nection between two elements in a measurement system. Changing
electric Ô¨Åelds insert a capacitive current in the connecting cables and
changing magnetic Ô¨Åelds induce a voltage in closed loops. Grounding
at diÔ¨Äerent places includes the voltage diÔ¨Äerences of these places in
the measurement.
are used. For less critical situations the Unshielded Twisted Pair (UTP)
cable can be used as shown in the upper drawing of Figure 8.11. A homo-
geneous changing magnetic Ô¨Åeld will induce an electromotive force in each
loop that encloses a part of this Ô¨Åeld, according to Faraday‚Äôs law. As long as
every twist encloses the same magnetic Ô¨Çux an equal electromotive force
is induced. Every twist is succeeded with a next twist where the wires are
exchanged from position resulting in an exchanging positive and negative
electromotive force in each twist for both wires. These electromotive forces
result in a total potential diÔ¨Äerence at the end of the wires of approximately
zero volt, because of the series connection.
Unfortunately often the magnetic Ô¨Åelds are not really homogeneous and it
is also diÔ¨Écult to keep all twists equal. For that reason the coaxial cable is
frequently used as shown in the lower drawing of Figure 8.11. In principle
the return path of the signal is a tube around the central conductor, which
carries the signal voltage relative to the grounded tube. A magnetically
induced electromotive force at one side of the coaxial cable will be compen-

714
Chapter 8. Measurement in Mechatronic Systems
+
+
+
+
+
d
dt

+
+
+
+
Shielding, return signal or ground
Signal
¬ã
Shielded twisted pair (STP)
Coaxial cable
Grounded shielding
Unshielded twisted pair (UTP)
Figure 8.11: Interference by changing magnetic Ô¨Åelds can be reduced by twisting
the two wires of a signal cable. For each wire the electromotive force
generated in one twist of the cable is directed opposite to the electro-
motive force generated in the adjacent twist, as shown for the blue
wire. These electromotive forces result in a net potential diÔ¨Äerence
of ‚âà0 V over the total twisted pair, because of the series connections.
This beneÔ¨Åcial eÔ¨Äect is maximum when the magnetic Ô¨Åeld is uniform.
Even better is the coaxial cable as shown in the middle as then at all
places both a positive and negative loop is present. When capacitive
disturbances and ground loops cause problems, the shielded twisted
pair is the preferred solution.
sated by the induced electromotive force at the opposite side and as long as
the resistance in the shield is low this compensation is almost perfect. The
word almost is due to the possibility that the magnetic Ô¨Åeld might not be
homogeneous over the cross section of the coaxial cable. A thinner cable is
better in that respect but as a side eÔ¨Äect the capacitance of the cable would
be larger.
8.2.3.2
Capacitive Disturbances
The second source of disturbances is capacitive coupling of electric Ô¨Åelds,
originating from for instance mains power supply lines and high-frequency
circuits of electronic equipment. In principle always some capacitive cou-
pling exists between any electrical wire that carries an alternating voltage
and a wire that carries a sensitive signal. Even with small distances and
large distance a voltage of 230 V @ 50 Hz creates detectable disturbance
values in the mV to ŒºV range in a sensitive, high-impedance electronic

8.2. Sensor Signal Sensitivity
715
Vs
+
_
+
_
Vi
+
_
 
+
_
+
_
Vn,c
Zc1
Zc2
GVi
+
_
Zi
Signal loop 
n,s+
     
V
Z4
Zs
#$$
Sensing
]/
¬à^
Figure 8.12: Capacitive disturbances can be reduced by electrostatic shielding. A
Faraday shield surrounds the entire sensitive part with conductive
material that is either grounded or connected to another trusted con-
stant voltage source. The multitude of parasitic capacitances between
the shielding and the instrument will then hardly cause problems,
because of the very low relative potential diÔ¨Äerence.
circuit as can be observed by touching the input of an audio ampliÔ¨Åer by
hand.
In principle the capacitive coupling can be approximated as a current source
because of the high impedance of the small capacitance value between the
source and the sensitive element. This means that the level of the resulting
voltages depends on this capacitive coupling with the source impedance of
the sensing element and the input impedance of the next element. Often
these impedances are both quite high.
Likewise with the magnetic coupling, the capacitive coupling creates volt-
ages in both wires with a common-mode disturbance part, which can be
cancelled by using a diÔ¨Äerential ampliÔ¨Åer in the next element. Also in this
case the situation for both wires is often diÔ¨Äerent because of the diÔ¨Äerent
locations of the wires.
Fortunately it is very well possible to shield the sensitive element by means
of a conductive layer, creating a Faraday shield around the element that
blocks out electric Ô¨Åelds as shown in Figure 8.12. This shield can be con-
tinuous but also small perforations are often allowed for cooling purposes
depending on the disturbance frequency. Very high frequencies can however
even penetrate in very small holes, depending on their wavelength!
Capacitive coupling can cause a problem with coaxial cables. In principle

716
Chapter 8. Measurement in Mechatronic Systems
the signal wire is well shielded by the return wire but this return wire
receives all capacitive disturbance signals and the resulting voltage appears
at the corresponding input of the next element. A Ô¨Årst solution is often to
choose that input as the grounded input of the measurement system, short
circuiting these disturbance currents to a constant reference voltage. This
is mostly suÔ¨Écient for less critical situations but sometimes the impedance
Zg of this zero volt ground point is not low enough, resulting in a small
detectable disturbance on the input.
8.2.3.3
Ground Loops
An even worse situation occurs when the two sides of the connecting cable
are both grounded. At Ô¨Årst sight one might think that this will short circuit
the capacitive disturbances better but this additional connection creates a
ground loop with a very low impedance, where magnetic disturbances will
create a voltage, which induces signiÔ¨Åcant currents in the loop impedance.
Reducing Zg,1 would even make things worse, because the increased current
by the reduced loop impedance will cause an increased voltage over Zg,2.
These negative eÔ¨Äects are even present inside an electronic instrument,
where the loops are small. Experienced electronic designers are very keen
on avoiding ground loops even on printed circuit boards, by grounding all
electronics at one location.
Especially when the distances between the elements in a measurement
system become large like in a chemical plant, with cables up to hundreds of
metres another problem becomes prominent, the diÔ¨Äerence in potential of
the ground at diÔ¨Äerent locations. This potential diÔ¨Äerence can be caused by
leakage currents of large grounded high-power electrical systems, lightning
and magnetic Ô¨Åelds.
For these reasons double grounding should in principle always be avoided.
Safety regulations however often require the housing of mains fed electronic
systems to be connected to the safety ground. In those cases the internal
electronics are preferably not connected to this grounded casing but often
this connection is present for practical reasons. And even without an internal
hard wired connection, the capacitance between the electronics and the case
creates a capacitive grounding for high frequencies.
To overcome these problems a combination of the coaxial cable and the
twisted pairs can be used, the Shielded Twisted Pair (STP). The two wires
of the twisted pairs conduct the signal including the return path, like with
the unshielded version. By very small and well controlled twists, Ô¨Årmly
embedded in the insulation, the magnetic disturbances are minimised, while

8.2. Sensor Signal Sensitivity
717
+
+
_
Ground 
Vn,g
Zc2
Ground loop 
n,s-
     
V
g
d
dt

1
2
_
Zg2
Zg1
Sensing 
Signal
condioning
sZ
Zc1
Z4
Figure 8.13: Grounding more than one element of a measurement system will
create ground loops, which introduce common-mode magnetic distur-
bances and voltages due to other sources. Even though diÔ¨Äerential
ampliÔ¨Åers can reduce the problem, the related voltage levels can be
very high, especially with large distances, so ground loops should be
avoided.
the shielding has no other function than to cancel the electric Ô¨Åelds.
In Section 8.4.4 the optical Ô¨Åbre is presented, which can be used when the
signals are conditioned to a higher signal energy and digitised to a number.
The use of an optical Ô¨Åbre prevents any galvanic connection with the related
ground loops currents.

718
Chapter 8. Measurement in Mechatronic Systems
8.3
Signal Conditioning
It is preferred to Ô¨Årst add robustness to the electrical signal by placing a
signal conditioning element close to the sensing element because of the
often very high sensitivity of the sensing element. When possible, the very
best solution is created when this element is integrated with the sensor.
As mentioned in the previous section, signal conditioning elements prefer-
ably consist of an ideal diÔ¨Äerential ampliÔ¨Åer with an inÔ¨Ånite common-mode
rejection ratio without oÔ¨Äering a load to the sensing element. Furthermore,
the signal conditioning element can also contain Ô¨Ålters and modulation
principles to reduce the impact of interference.
In this section Ô¨Årst the instrumentation ampliÔ¨Åer will be presented as a
true diÔ¨Äerential ampliÔ¨Åer, followed by a presentation of Ô¨Åltering with a focus
on modulation techniques.
8.3.1
Instrumentation AmpliÔ¨Åer
Generally the input of a signal conditioning element consists of one or more
operational ampliÔ¨Åers. In case of a less critical situation a non-inverting
ampliÔ¨Åer can be suÔ¨Écient, when only the impedance of the source is too
high for transporting the signal. When the sensing element acts like a cur-
rent source as will be shown later with a light sensitive diode, an inverting
ampliÔ¨Åer with a low input impedance can be applied to convert the signal to
a voltage with a low output impedance.
As explained in the previous section however, in most cases a high common-
mode disturbance voltage is present in the signal, due to capacitive coupling
and ground-loops. In those cases a true subtracting diÔ¨Äerential ampliÔ¨Åer is
necessary to only amplify the diÔ¨Äerential voltage to a single ended output
voltage and cancel this common-mode signal. Also in case of a sensor with a
Wheatstone bridge a diÔ¨Äerential-to-single-ended ampliÔ¨Åer is needed. Unfor-
tunately however the simple diÔ¨Äerential ampliÔ¨Åer that is based on a single
operational ampliÔ¨Åer as shown in Figure 8.14 has the disadvantage of a
diÔ¨Äerence of loading of the two inputs. The non-inverting input has a simple
resistive input impedance, but the current in the inverting input depends
both on R1 and on the voltage at the + terminal of the operational ampliÔ¨Åer.
This voltage at the + terminal is equal to the non-inverting input voltage
and as a result, the current at the inverting input depends on the voltage at
the non-inverting input. This would be no problem when both Vi(1) and Vi(2)
are delivered by a source with a source impedance that is signiÔ¨Åcantly lower
than R1. In many sensor elements this is however not the case and the input

8.3. Signal Conditioning
719
G ()
R2
+
R1
R1
R2
Vo
Vi,2
Vi,1
I1
I2
+
+
+
_
_
_
_
Inverng 
Non 
inverng 
Figure 8.14: A simple subtracting ampliÔ¨Åer with one operational ampliÔ¨Åer suf-
fers from diÔ¨Äerent loading of the input signals. The current of the
non-inverting input is determined by R1 + R2, while the current at
the inverting input is determined by R1 and the voltage at the non-
inverting input.
impedance has to be increased by adding additional buÔ¨Äer ampliÔ¨Åers before
the actual diÔ¨Äerential ampliÔ¨Åer. Another reason for introducing additional
ampliÔ¨Åers is the need to apply only small resistor values, because of noise.
The noise in a resistor depends on the resistor value and the temperature
as was shown in Section 8.1. Also the input-current noise of an operational
ampliÔ¨Åer results in a noise voltage at its output that is determined by the
value of the resistors at the input. In practice both inputs of an operational
ampliÔ¨Åer should ‚Äúsee‚Äù a resistive impedance of less than 1 kŒ© to achieve
the minimum noise level and such a low value of the load impedance is not
preferred for many sensing elements. A third reason to adapt the simple
subtracting ampliÔ¨Åer conÔ¨Åguration is based on the common-mode rejection
ratio. In practice it is very expensive to apply resistors with a better tol-
erance than 0.1 %. As a consequence, with these resistor tolerances, the
ampliÔ¨Åcation of the inverting and non-inverting input of the diÔ¨Äerential
ampliÔ¨Åer will also diÔ¨Äer approximately this same amount. As a result. the
common-mode ampliÔ¨Åcation will be only a factor 103 below the diÔ¨Äerential-
mode ampliÔ¨Åcation, which is equal to only ‚àí60 dB. This is far worse than
the standard CMRR of an operational ampliÔ¨Åer, which is often better than
‚àí100 dB.
Figure 8.15 shows an ampliÔ¨Åer that uses two additional operational ampli-
Ô¨Åers at its inputs to solve these problems. This conÔ¨Åguration is called an
instrumentation ampliÔ¨Åer, a name based on its main application in sensitive
measuring instruments. Instead of simply using two voltage follower buÔ¨Äer

720
Chapter 8. Measurement in Mechatronic Systems
+
A3
R3
+
R2
R2
R3
Vo
Vb(1)
Vb(2)
+
+
+
_
_
_
_
A2
R1,2
+
_
A1
R1,1
+
I
_
Vi(1)
+
_
Vi(2)
_
RG
I
I
_ 
+
Vi(d)
I
I
G ()
G ()
G ()
\`$#$
d
d
d
d
d
*
*
Figure 8.15: An instrumentation ampliÔ¨Åer consists of two non-inverting ampliÔ¨Åers
that only amplify the diÔ¨Äerential mode of the input signals, combined
with a standard subtracting ampliÔ¨Åer. Only one resistor RG is used to
set the diÔ¨Äerential gain. The indicated current direction corresponds
to the indicated sign of the input voltage Vi(d).
‚àóThe diÔ¨Äerential current Id does not include the input currents of the
subtracting ampliÔ¨Åer, which are not indicated separately but combine
with Id at the outputs of A1 and A2.
ampliÔ¨Åers, the input ampliÔ¨Åers are conÔ¨Ågured as high-gain non-inverting
voltage ampliÔ¨Åers in order to improve the common-mode rejection ratio. The
second diÔ¨Äerence is the resistor RG between the negative inputs of the two
non-inverting ampliÔ¨Åers, which replaces the normally used resistors from
the negative input of each operational ampliÔ¨Åer to ground.
The instrumentation ampliÔ¨Åer has the following working principle.
As a Ô¨Årst step the gain of the diÔ¨Äerential gain stage is calculated as if it were
not connected to the subtracting ampliÔ¨Åer. All operational ampliÔ¨Åers have
negative feedback. Under normal conditions, the operational ampliÔ¨Åer will
do whatever it can do to adapt its output such that the minus input of the
matches the plus input. As a consequence the voltage over RG will match
the diÔ¨Äerential input voltage Vi(d) of the two non-inverting ampliÔ¨Åers. When
the input currents of the operational ampliÔ¨Åer are neglected, the outputs
of both ampliÔ¨Åers will deliver a current through RG, R1,1 and R1,2, equal
to Id = Vi(d)/RG. When R1,1 = R1,2 = R1, the intermediate voltages after the

8.3. Signal Conditioning
721
non-inverting ampliÔ¨Åers equal:
Vb(1) = Vi(1) + IdR1 = Vi(1) +Vi(d)
R1
RG
[V],
(8.35)
Vb(2) = Vi(2) ‚àíIdR1 = Vi(2) ‚àíVi(d)
R1
RG
[V].
(8.36)
These equations indicate that the common-mode voltage of Vb(1) and Vb(2)
is equal to the common-mode voltage of Vi(1) and Vi(2) while the diÔ¨Äerential
voltage Vi(d) = Vi(1) ‚àíVi(2) is ampliÔ¨Åed with a factor RG/R1 for both Vb(1) and
Vb(2). As a consequence the common-mode rejection ratio of this combination
is improved with this factor RG/R1.
As the second step the outputs of A1 and A2 are connected to the inputs of the
subtracting ampliÔ¨Åer A3. The current into the inputs of this ampliÔ¨Åer will
be delivered by the outputs of A1 and A2 and not run through the resistors
RG,R1,1 and R1,2. This means that the gain of the diÔ¨Äerential gain stage is
not changed by this load. Following the conclusion on the improved common-
mode rejection by the diÔ¨Äerential input stage, this stage should provide most
of the total gain. For that reason the resistors of the subtracting ampliÔ¨Åer
part are often chosen equal, resulting in a unity gain of that part. With
this equal resistor setting the output voltage of the total instrumentation
ampliÔ¨Åer equals:
Vo = Vb(1) ‚àíVb(2) = Vi(1) ‚àíVi(2) +2Vi(d)
R1
RG
= Vi(d)

1+2 R1
RG

[V].
(8.37)
Fully integrated versions of such instrumentation ampliÔ¨Åers exist, where
only the external gain-setting resistor RG must be added to realise a fully
robust signal conditioning ampliÔ¨Åer.
8.3.2
Filtering and Modulation
Even with a careful design it is not always possible to reduce all sources
of random errors to an suÔ¨Éciently low level. In that case it is preferred,
that these errors are Ô¨Årst reduced by Ô¨Åltering, before the signal is further
processed in the measurement system. Simple Ô¨Åltering can be very use-
ful if the disturbance signal has a diÔ¨Äerent frequency spectrum than the
useful signal. In that case the active Ô¨Ålter conÔ¨Ågurations can be used like
described in Section 6.2.7 of Chapter 6. Examples are the reduction of
the high-frequency part of wide-band noise of electronic components and
single frequency disturbances can be Ô¨Åltered by a selective band reject Ô¨Ålter.
The second-order ‚Äútaming‚Äù low-pass Ô¨Ålter in the PID-controller that was

722
Chapter 8. Measurement in Mechatronic Systems
presented in Chapter 4 also serves this same purpose.
Unfortunately often the disturbance signal occurs in the same frequency
band as the measurement signal. This is especially the case with low-
frequency excess noise because most mechanical measurements have also
a strong low-frequent component in their spectrum. This can be solved by
combining the measurement signal with a high-frequency carrier signal
and only amplify the resulting high-frequency combination. This combining
action is called modulation and several types of modulation are applied.
For measurement systems, amplitude modulation (AM) is frequently used.
It is well-known from radio transmission and will be explained more in
detail. Other principles include frequency modulation, which is also used in
radio transmission, pulse-width modulation, which was introduced in Chap-
ter 6 for power ampliÔ¨Åers and phase modulation, which will be presented in
Section 8.7 with incremental optical measurement systems.
8.3.2.1
AM with Square Wave Carrier
One principle of amplitude modulation is shown in Figure 8.16. The high-
frequency carrier signal is a square waveform, alternatingly switching the
input signal between the inverting and non-inverting input of a diÔ¨Äeren-
tial ampliÔ¨Åer. The output of the modulator is a high-frequency amplitude
modulated square wave signal and can be Ô¨Åltered below the carrier wave
frequency without losing information. This Ô¨Åltering is done by means of
a selective ampliÔ¨Åer with a high-pass frequency transfer function. As a
result, disturbances at the connection between the diÔ¨Äerential ampliÔ¨Åer and
the selective ampliÔ¨Åer will not arrive at the input of the demodulator. The
demodulator consists of a similar combination of a switch and a diÔ¨Äerential
ampliÔ¨Åer as the modulator, restoring the original sign of the signal input
by switching synchronous with the modulator. This special demodulation
method is called synchronous demodulation because of the synchronous
switching of the modulator and demodulator.
The ampliÔ¨Åer has to be able to preserve the very high frequencies of the
square wave spectrum, because of the sharp transients of the modulated
square wave signal. For that reason, the use of this version of amplitude
modulation is restricted to relatively low-frequency measurement signals.
For higher frequencies a sine wave carrier frequency is preferred. Instead
of switching, the modulation with a sine wave carrier frequency is achieved
by multiplication. In fact also the switching modulator acts like a multi-
plier of the momentary magnitude of the signal input with the momentary
magnitude of a square wave signal.

8.3. Signal Conditioning
723
Time
t1
t2
t3
t4
t5
t6
t7
t8
t9
t10
Va
+
_
+
_
Vi
Synchronous square wave carrier signal
Vo
+
_
+
_
Vg
#
%
Vi
Va
Vg
Vo
+
_
\`
%
Disturbance
+
_
\`
%
Modulator
Demodulator
Figure 8.16: Synchronous modulation and demodulation is achieved by alternat-
ingly switching the signal input Vi between the inverting and non-
inverting input of a diÔ¨Äerential ampliÔ¨Åer. The resulting high-frequency
signal Va is ampliÔ¨Åed by a selective ampliÔ¨Åer, resulting in Vg. A de-
modulator, switching synchronous with the input switch, inverts the
ampliÔ¨Åed signal again into a low-frequency signal Vo. The disturbance
is cancelled in the selective ampliÔ¨Åer.
8.3.2.2
AM with Sinusoidal Carrier
In radio transmission the sine wave carrier signal is multiplied with a com-
bination of a DC bias voltage and the music signal, as shown in Figure 8.17.
This method has the advantage that demodulation is fairly easy and for that
reason it is also useful in measurement systems, when the measurement
signal does not contain a DC value.
As a Ô¨Årst step, the measurement signal is added to the DC bias voltage,
large enough to keep the voltage always unidirectional. By multiplying this
combined DC+AC signal voltage with the carrier signal, the resulting high-
frequency signal will never get a zero amplitude. This modulated signal can
be ampliÔ¨Åed with a selective ampliÔ¨Åer with a band-pass transfer function
around the carrier frequency.
Demodulation is achieved by simple rectiÔ¨Åcation, followed by a second band-
pass Ô¨Ålter around the measurement signal frequency. This Ô¨Ålter cancels the
DC bias voltage and the high-frequency remains of the carrier frequency.
To determine the transfer function of the selective ampliÔ¨Åer it is useful to

724
Chapter 8. Measurement in Mechatronic Systems
Va
+
_
+
_
Vi
Vo
+
_
+
_
Vg


Interference
&%
#
%
x
Vi
Vg
Vr
Vo
"
Va

%
Vr
+
_
Modulator
Demodulator
Vc
Vc
Figure 8.17: Amplitude modulation by multiplying the input signal with the carrier
signal. The input signal consists of the measurement signal and a
DC bias voltage. As a result, the amplitude of the multiplier output
will never be zero. After amplifying and Ô¨Åltering, the demodulation is
done with a simple rectiÔ¨Åer and a band-pass Ô¨Ålter.
look at the simple mathematics around this modulation principle. When the
input signal with the DC bias voltage equals Vi = VDC +Vi,p sin(œâit) = VDC +
Vi,p sin(2œÄfit) and the carrier signal equals Vc = Vc,p sin(œâct) = Vc,p sin(2œÄfct)
the multiplication results in:
Va = VcVi = Vc,pVDC sin(2œÄfct)+Vc,pVi,p sin(2œÄfct)(sin(2œÄfit))
= Vc,pVDC sin(2œÄfct)+Vc,pVi,p
cos(2œÄ(fc ‚àífi)t)‚àícos(2œÄ(fc + fi)t)
2
[V].
(8.38)
This means that the resulting signal contains three frequencies, the carrier
signal frequency fc and two frequencies equally spaced at both sides of the
carrier frequency at a frequency diÔ¨Äerence equal to fi. These frequencies
are called the side-bands around the sampling frequency and they both
contain the information of the measurement signal at fi.
With this result it can be reasoned that an input signal, that contains diÔ¨Äer-
ent frequencies up to fmax, requires the bandwidth of the selective ampliÔ¨Åer
to range from fc ‚àífmax to fc + fmax. In principle one of the two side-bands
could be Ô¨Åltered out and restored with special measures afterwards, but
that procedure is too specialistic for the purpose of this book.

8.3. Signal Conditioning
725
Va
+
_
+
_
ViVi
Vo
+
_
+
_
Vg


Interference
#
%
x
Vi
Vg
Vr
Vo
"
Va
(
%
Vr
+
_
Modulator
Demodulator


x
Vc
Vc
Vc
Figure 8.18: Synchronous modulation and demodulation with a sinusoidal carrier
signal enables the application of an input signal without a DC bias
voltage. The sign of the ampliÔ¨Åed measurement signal is retrieved
by a second multiplication in the demodulator with the same carrier
frequency.
A drawback of this simple scheme with rectiÔ¨Åer demodulation is the fre-
quency limitation to AC signals. The synchronous demodulation of the Ô¨Årst
example with a square wave signal did not have that drawback. Fortunately
it is also possible to apply synchronous demodulation with a sine wave
carrier signal, as shown in Figure 8.18. It results in the ampliÔ¨Åcation of
frequencies from 0 Hz and above.
The input signal is not added to a DC bias voltage, because also any DC
content of the input signal should be maintained. The resulting signal after
modulation has a zero amplitude at Vi = 0 and shows a phase reversal, when
Vi < 0. Demodulation by rectifying would result in a frequency doubling
with a DC oÔ¨Äset, so the demodulation is done by multiplication with the
same carrier signal.
The average of the resulting signal is equal in shape as the input signal
and can be recovered by a low-pass Ô¨Ålter. This method is also called phase
selective detection or homodyne detection and will return later in this chapter
with diÔ¨Äerent sensing principles.

726
Chapter 8. Measurement in Mechatronic Systems
8.4
Signal Processing
After the signal conditioning element, a strong and robust signal is present,
which can be used in an analogue control system. Modern control electronics
work predominantly in the digital domain, which makes it necessary to
convert the momentary values of the electrical signal into a sequence of
data that suÔ¨Éciently represents the measured value.
Digital systems are characterised by the fact that they work with very
strictly timed events, synchronised by means of an accurate clock frequency
generator, mostly based on a quartz crystal oscillator.
When only the frequency of a periodic signal is important, the analogue
signals can be directly converted into the digital domain. This frequency-
to-digital conversion process is achieved by means of a comparator, a one
bit bistable element, which outputs either a ‚Äúzero‚Äù or a ‚Äúone‚Äù depending
on the voltage level at the input. In chapter 6, a special version of such a
comparator, the Schmitt trigger, was used in the pulse-width modulator of
a switched mode power ampliÔ¨Åer. In measurement systems the Schmitt
trigger is used to suppress disturbances.
With real analogue-to-digital conversion the magnitude of a value needs to be
digitised and that is done by taking a momentary value of the measurement
signal and generate a number to the magnitude of that sample. In the
following sections, Ô¨Årst the Schmitt trigger will be presented, followed by
the process of creating sampled numerical data from the magnitude of a
measurement signal.
8.4.1
Schmitt Trigger
A comparator is a diÔ¨Äerential ampliÔ¨Åer with an inÔ¨Ånite gain. The output
is either a Ô¨Åxed positive value when the plus-input is at a higher voltage
than the minus-input or a Ô¨Åxed negative value in the other case. A Schmitt
trigger is a comparator with a well deÔ¨Åned hysteresis level.
Figure 8.19 shows the functionality of a Schmitt trigger with diÔ¨Äerent sig-
nals. When Ô¨Årst examining the upper graph, without any hysteresis, the
output voltage Vo changes its value any time the input signal crosses the
0 V reference level. This conÔ¨Åguration without hysteresis is only useable,
when the input signal would be without any noise, which is never reality.
The eÔ¨Äect of noise is shown after t0, where a noise signal is added. The
noise will cause additional output transitions at the zero crossing with a
higher frequency than the input signal. When examining the lower graph,
the inÔ¨Çuence of the hysteresis is clearly observed. Starting at a situation

8.4. Signal Processing
727
Vi
Vo
t
t0
Vo
Vi
Vo
t0
t
0
0
Schmi' trigger
Vo
Vi
+
Vo
+
Vo
-
Vo
-
Vr
+
Vr
-
Vr
+
Vr
-
Vr
Figure 8.19: A ‚ÄúSchmitt trigger‚Äù is a comparator with a deÔ¨Åned level of hysteresis,
which converts a periodic signal into a square wave with a reduced sen-
sitivity for noise. The upper right graph shows the diÔ¨Äerent voltages
when no hysteresis is present, while the lower right graph shows the
voltages with a hysteresis level of Vr. The input signal is sinusoidal
and after t0 noise is added to show the diÔ¨Äerence. Note the phase shift
due to the hysteresis.
where Vo is negative, the input signal rises until it surpasses the value of
V +
r . At that moment Vo will transit to the positive side. Only when the
input signal drops below the now negative value of V ‚àí
r , Vo will transit to the
negative side again. This hysteresis has two eÔ¨Äects. Firstly an additional
phase shift occurs between Vo and Vi depending on the amplitude of Vi and
the hysteresis level but the secondly eÔ¨Äect is more important because the
frequency of Vo will not be inÔ¨Çuenced by the noise as long as the peak to
peak value of the noise remains below the hysteresis level.
Comparators in both inverting and non-inverting conÔ¨Ågurations are fre-
quently applied and even when not speciÔ¨Åcally mentioned, they mostly are
provided with some kind of hysteresis. Only when the hysteresis level is
clearly deÔ¨Åned the comparator deserves its name as Schmitt trigger.
8.4.2
Digital Representation of Measurement Data
The physical properties that are measured are always analogue, charac-
terised by a continuous change of the value over time. By consequence
the direct conversion into an electrical signal is also analogue and initially
analogue measurements were used and displayed in the continuous-time-
domain either by metering devices or directly as input in an analogue con-

728
Chapter 8. Measurement in Mechatronic Systems
Analogue input
Digital output
LSB
Analogue input
Digital output
#¬å|¬ï{¬Å(#¬á¬å|¬ï,(#¬á
Figure 8.20: The incremental nature of digitisation introduces a quantisation error
that can range between maximum 0.5 to 1 times the least signiÔ¨Åcant
bit depending on the method of quantisation.
troller. Presently, due to the frequent application of computers, the mea-
sured value is mainly represented by means of a discrete value, mostly in
a decimal or binary notation, depending on the way that the value is used.
The binary code was introduced in Section 4.5.3 on digital motion control.
It consists of a number of n bits, each representing a power of 2 where the
least signiÔ¨Åcant bit equals 20 = 1 and the most signiÔ¨Åcant bit equals 2n‚àí1.
When digitising measurement values, the magnitude represented by the
most signiÔ¨Åcant bit is equal to half the total range of the measurement
value. The magnitude of the least signiÔ¨Åcant bit represents the smallest
increment that can be distinguished between diÔ¨Äerent measurement values.
This incremental property of digitisation determines the Ô¨Årst source of
errors in a measurement system, the quantisation error as shown in Fig-
ure 8.20. Depending on the quantisation method, the error can amount up
to a maximum of one least signiÔ¨Åcant bit (LSB).
8.4.2.1
Gray Code
Although digital numbers oÔ¨Äer in principle an unambiguous representation
of a value, in practice its application can cause problems. This is due to the
fact that a step of one smallest increment can cause a change of more than
one bit, depending on the actual value of the number before the step. With
binary data this eÔ¨Äect is most signiÔ¨Åcant in the situation, where the value
is changed from just below half the range to just above half the range or the
other way around. An increase of one smallest increment would cause the bi-
nary number 011111 to change into 100000, changing all bits of the number

8.4. Signal Processing
729
Lig¬é$
 
]llimatr ls
Phttectr
]$ !
MSB
LSB
Decimal   Gray       Biary 
0 
0000
0000 
1 
0001 
0001 
2 
0011 
0010 
3 
0010 
0011 
4 
0110 
0100 
5 
0111    
6 
0101 
0110 
7 
0100 
0111 
0101 
9
1101 
1001 
10
1111 
1010 
11
1110 
1011 
12
1010 
1100 
13
1011    
14
1001 
1110 
15
1000 
1111 
1101 
8 
1100 
1000 
&
Figure 8.21: With direct measurement of digital data, a binary code can cause prob-
lems by not synchronised changing of all related bits. This is solved
by using a Gray code, which switches only one bit at any increment,
like in this example of an absolute rotary optical encoder. At the right
a 4-bit coding is shown as example.
(Courtesy of Heidenhain)
at the same transition. If for some reason not all bits switch simultaneously
this can lead to an erratic reading. A well-known conÔ¨Åguration, where
this situation can occur, is the direct digital measurement of an angular or
linear position by means of an encoder, a multitude of light beams that pass
through holes, representing the diÔ¨Äerent bits in a coding disk. Figure 8.21
shows an example of such a rotary encoder. Instead of a binary code this
measurement system uses a Gray code, named after the American physicist
Frank Gray. The Gray code is designed such that only one bit is switched at
any incremental change. As shown in the example at the right of the Ô¨Ågure
the least signiÔ¨Åcant bit switches at all uneven decimal numbers, so once in
every two increments. The next bit switches once in every four increments
starting from zero to one at the second decimal value, the third bit switches
on every eight increments, starting at the fourth decimal value and so on.
The use of a Gray code prevents erratic readings, which might otherwise
occur due to the tolerances in the alignment of the slots on the coding disk
with the photo sensitive detectors.
The example of the rotating disk shows the eÔ¨Äect of a position alignment
error but also errors can occur in the time-domain, when not all bits change
at the same time due to a diÔ¨Äerent switching speed of the bits. This timing
problem can be solved by a latch, a memory that holds a digital value for

730
Chapter 8. Measurement in Mechatronic Systems
a certain time and can be read out at the moment that all data are stable.
This is applicable in systems that work with a well deÔ¨Åned clock frequency,
where all digital data are synchronised, like with a computer.
In the following sections electronic analogue-to-digital converters are pre-
sented that translate continuous-time signals into discrete-time values.
Most of these converters need several clock cycles to determine all bits of
the digital value that corresponds to a sample that is taken from the signal.
During this process each determined bit is stored in the latch and only when
all bits are found, the number is transferred to the digital processor in the
last clock cycle.
8.4.2.2
Sampling of Analogue Values
The incremental nature of digital signals is both related to the measurement
value and to the time. Numbers can not change gradual and are only valid
over a certain period. This fact implies that digital numbers represent
samples of a momentary value of the analogue signal, which implies that
the discrete-time value can only approximate the continuous-time value.
Depending on the method of analogue to digital conversion, the sampling
frequency can be constant, synchronous with the clock frequency of the
digital controller or variable depending on the signal value. The latter
can be synchronised afterwards by means of a memory where the data are
written asynchronous but the readout is synchronised.
S0
S1
S2
S3
S4
S5
S6
S7
S8
S9
_
Vi
Vh
Sampling        Hold
Vi
Vh
T
Figure 8.22: Sampling a signal is done with a switch, while a capacitor will keep the
value constant until a new sample is taken after the sampling time T. A
buÔ¨Äer ampliÔ¨Åer before the sampling switch prevents excessive loading
of the input signal by the hold capacitor. The average group delay
between the sampled and analogue value is œÑg = 0.5T

8.4. Signal Processing
731
Samples are by deÔ¨Ånition only exact at the moment of sampling and this
automatically means that intermediate information is lost. In case of a
varying analogue signal, it seems logical that the sampling frequency should
at least be larger than the largest frequency in the signal.
It is important to investigate, what the limitation really is.
8.4.2.3
Nyquist-Shannon Theorem
The low limit of the sampling frequency in a perfect analogue to digital
conversion is determined by the following key rule of any conversion process:
Any conversion is only perfect, when it can be reversed to repro-
duce the original input signal.
With this rule in mind, Ô¨Årst the sampling process itself is considered. Fig-
ure 8.22 shows how sampling can be done in practice. The samples of the
signal are taken with a switch that shortly connects a capacitor to the signal
voltage at the output of a buÔ¨Äer ampliÔ¨Åer. During this sampling moment
the capacitor is charged to the momentary signal voltage. After opening the
switch, the sampled voltage remains stored in the capacitor until the next
sample is taken. As will be shown with the A to D converters further in this
chapter, this sample-and-hold functionality is necessary for those convert-
ers that need the input signal to be constant during the conversion process.
Other converters do not have that requirement as they average the input
signal over each sample. One observation that can be made from the Ô¨Ågure
is the group delay (œÑg) caused by the ‚Äúhold‚Äù functionality which contributes
to the total latency of the converter, which is an important factor when used
in real-time feedback systems. In principle this group delay corresponds to
the fact that information is lost between the samples. The average group
delay by sampling is half the sampling period and unfortunately this delay
can never be compensated! This in itself is an important determining factor
for the minimum sampling frequency when the measurement is used to
control a process with feedback.
Even more important is the eÔ¨Äect of sampling on the frequency spectrum.
In principle, without the hold function, sampling alone is equal to amplitude
modulation of a repeated impulse signal, while the holding action results in
a kind of square wave modulation. With reference to the previous section
on signal conditioning with amplitude modulation, the frequency spectrum
of a sampled signal also shows ‚Äúside bands‚Äù around the sampling frequency.
With a sampled impulse signal this pattern is repeated at n-times the sam-
pling frequency due to the wide frequency spectrum of an impulse.

732
Chapter 8. Measurement in Mechatronic Systems
Frequency
fs
2fs
3fs
Filter
Signal
spectrum
Frequency
fs
2fs
3fs
Filter
Signal
spectrum
4fs
Magnitude
Magnitude
Figure 8.23: Sampling a signal will create mirroring side bands of the frequency
spectrum of the signal around n‚àítimes the sample frequency, where
n is an integer > 0. When fs is smaller than two times the maximum
signal frequency, overlap between the spectra will occur, impairing
the possibility to reproduce the original signal. The eÔ¨Äect of the ‚Äúhold‚Äù
action at higher frequencies is shown in red.
This phenomenon is illustrated in Figure 8.23, where also the eÔ¨Äect of the
"hold" functionality is shown with a low-pass Ô¨Ålter character, reducing the
magnitude of the spectrum at higher harmonics of the sample frequency.
The upper graph in the Ô¨Ågure shows the frequency spectrum in case the
sampling frequency is much higher than the maximum signal frequency.
The original signal spectrum could be simply recovered by Ô¨Åltering away all
sampling related signals above the maximum signal frequency.
The lower graph shows the eÔ¨Äect when the sampling frequency is exactly
two times the maximum signal frequency. The lowest frequency of the Ô¨Årst
sideband around the sampling frequency is equal to the maximum signal fre-
quency and only an inÔ¨Ånitely sharp Ô¨Ålter could prevent that nearby higher
frequencies from the side band are introduced in the original signal. With
an even lower sample frequency this can no longer be avoided and it becomes
not possible anymore to recover the original signal.
Aliasing
Figure 8.24 shows what happens when the sampling frequency is for instance
equal to the maximum frequency of the input signal spectrum. The side
bands around the sampling frequency overlap with the frequency spectrum
of the analogue input signal and any frequency of this spectrum will get
a corresponding alias frequency that is lower than the original frequency,
equal to the frequency diÔ¨Äerence fd = fs ‚àífi. When using these samples

8.4. Signal Processing
733
f +
s
Alias of 
fi
f -
s fi
f 
sf
i
fi
Magnitude
Figure 8.24: An alias frequency is generated when sampling with a frequency fs
that is lower than twice the maximum signal frequency. The fre-
quency component fi of the analogue input spectrum combines with
the sampling frequency into a much lower frequency fs ‚àífi, the alias
frequency. This aliasing eÔ¨Äect is also demonstrated in the lower two
graphs, where the same samples correspond to two diÔ¨Äerent analogue
signal frequencies.
for reconstruction two frequencies would result, the original and its alias,
which has given the name to this eÔ¨Äect. In case the sample frequency is
higher than two times the signal frequency this diÔ¨Äerence frequency remains
larger than the maximum signal frequency and when all frequencies above
the original signal frequency are Ô¨Åltered out, only the original frequency
would remain. Based on the occurrence of aliasing, the Nyquist criterion for
sampling is postulated by the same Harry Nyquist, who created the Nyquist
plot. This criterion was later improved by the American mathematician
Claude Elwood Shannon (1916 ‚Äì 2001) into the Nyquist-Shannon sampling
theorem by incorporating the eÔ¨Äects of noise. The theorem deÔ¨Ånes the
Nyquist frequency fN as half the sampling frequency and the theorem reads
as follows:
When sampling, the signal frequency spectrum is not allowed to
contain frequencies above the Nyquist frequency.

734
Chapter 8. Measurement in Mechatronic Systems
This theorem corresponds to the following expressions:
fi,max < fN = fs
2
‚áê‚áí
fs > 2fi,max
[Hz].
(8.39)
8.4.2.4
Filtering to Prevent Aliasing
In most cases, signals in a measurement system consist of a large spectrum
of frequencies. When fi,max is the maximum frequency of interest in this
spectrum, the sampling frequency fs must at least comply to the Nyquist-
Shannon theorem and the Nyquist frequency fN ‚â•fi,max.
In practical systems it is however better to take some more margin especially
in feedback controlled motion systems, where the phase margin determines
the dynamic performance. This is caused by the need to apply Ô¨Ålters twice
in the loop. The Ô¨Årst Ô¨Ålter, the anti-aliasing Ô¨Ålter, is used to prevent that
non-relevant frequencies higher than fN enter the sampling process. This
Ô¨Ålter can never be inÔ¨Ånitely steep so it is better to keep the sampling fre-
quency a little bit above 2fi,max. The other Ô¨Ålter is used when the analogue
signal needs to be reconstructed between the controller and the power am-
pliÔ¨Åer. The higher frequency components in the sampled signal must be
Ô¨Åltered away as otherwise these frequencies would cause unwanted eÔ¨Äects
in the ampliÔ¨Åer and actuator. All low-pass Ô¨Ålters show a phase delay that
increases with their steepness, especially when overshoot is not allowed
(high damping). For these reasons it is preferred to choose a higher sam-
pling frequency with a lower-order Ô¨Ålter. A nice example of the application
of the Nyquist-Shannon theorem is the digitisation of audio signals for a
Compact Disc. The sample frequency of the Ô¨Årst CD-players and recordings
was set at 44 kHz, only with a small margin of 10 % above two times the
maximum audible frequency of 20 kHz. This caused a lot of criticism at
the introduction of the CD, because it resulted in a ‚Äúharsh‚Äù sound quality
induced by the sharp higher-order Ô¨Ålters needed to prevent sound artifacts
by aliasing. In present days, the increased capability of digital electronics
enabled even in a simple CD-player a digital over-sampling algorithm by
higher-order interpolation to a multiple of the original sample frequency,
like 96 or even 192 kHz. When reconstructing the original signal this high
sampling frequency allows the application of simple second-order Bessel
Ô¨Ålters with a constant group delay, which is far more pleasant to listen to.

8.4. Signal Processing
735
8.4.3
Analogue-to-Digital Converters
In this section three diÔ¨Äerent types of analogue-to-digital converter (ADC)
will be presented. First the most simple version is shown, the dual-slope
ADC that generates sampled values of a variable unidirectional input volt-
age, asynchronous with the heart beat of the digital processing that applies
the measured values for some action. The dual-slope ADC is used in slow,
less critical systems like with controllers for central heating of buildings.
This converter does not require a separate sampling and hold function and
can be realised with only a few components around a microprocessor at a
very low cost. The second converter is the frequently applied successive-
approximation AD converter. It combines an optimal trade-oÔ¨Äbetween
precision and speed and is still a standard in A-to-D conversion for feedback
controllers in mechatronic systems because of its reliable timing with a
low latency. The third converter is the Sigma-Delta converter. Its principle
is derived from the dual-slope ADC, but adapted such that it creates syn-
chronous samples of fast changing signals at a very high sampling frequency.
It is widely used in applications where a high resolution of more than 20
bits is more important than a low latency value, like in digital audio.
8.4.3.1
Dual-Slope ADC
The working principle of a dual-slope ADC is shown in Figure 8.25.
This converter is only suitable for signals with a single polarity. It consists
of an integrator, a comparator and a microprocessor. A switch at the in-
put of the inverting integrator connects this input to either the positive
analogue input signal or to a Ô¨Åxed negative reference signal with a known
value. A dual-level comparator is used to detect the precise moment that
the output voltage of the integrator passes either below a negative refer-
ence voltage Vr or above a voltage of 0 V. As soon as one of these events
occurs, the comparator will give a set- or a reset-pulse to a microprocessor.
A set-pulse corresponds to the moment of reaching 0 V and after that event
the microprocessor will command the switch at the input of the integrator
to connect to the input voltage of the AD converter. The output voltage of
the integrator will then fall at a proportional speed of the analogue input
voltage and the microprocessor measures the time for the integrator to reach
the reference value, which triggers a reset-pulse from the comparator. As
soon as this reset pulse is received, the microprocessor will command the
switch at the input of the integrator to connect to the reference voltage and
starts measuring the corresponding time for the integrator to rise to 0 V

736
Chapter 8. Measurement in Mechatronic Systems
1
2
3
0
-Vr
0
+
_
Vi
+
_
Integrator
Micro-
processor
Data
1
C
0
0 V
2
3
R
System 
clock
-Vr
R
-Vr
Dual-level
Comparator
Reset
Set
Figure 8.25: Dual-slope analogue-to-digital converter. A microprocessor measures
the time in which the output voltage of an integrator changes from
0 V to a negative reference voltage level Vr. This time is proportional
to the positive input voltage and is calibrated with the time that the
integrator needs to reach 0V after switching the input of the integrator
to the negative reference voltage Vr.
again.
The ratio between the two obtained time slots is equal to the ratio between
the absolute values of the reference voltage and the average input voltage
during the integration. With the known value of the reference voltage this
ratio can be converted by the microprocessor into a measurement value.
This dual-slope converter is the most simple of all conÔ¨Ågurations as it can
be made with only a few electronic parts. The integrator acts also as an
anti-aliasing Ô¨Ålter as high frequency signals will be averaged out with a
sampling period. This type of converter is often used for controlling rela-
tively slow processes in microprocessor-controlled devices, like the controller
of a central heating system. Frequently the integrator is replaced by a
simple RC-network while the inputs of the microprocessor are often used as
the comparator inputs. In that case the microprocessor is programmed to
compensate the resulting non-linearity and other anomalies that are related
to this low-cost solution.
The resolution of this converter is limited by the number of clock pulses

8.4. Signal Processing
737
of the microprocessor in one integrator cycle, which reduces its use to less
time-critical applications. If for instance the clock-frequency of the micro-
processor is 1 MHz, a 1 ms integrator-cycle would contain only 103 pulses.
Also with an input voltage close to 0V the cycle time increases, which makes
this converter less suitable for feedback controlled motion systems that need
a low and constant phase delay.
8.4.3.2
Successive-Approximation ADC
A more precise and relatively fast conversion procedure is achieved with
the successive approximation register (SAR) analogue-to-digital converter.
With this method, the output of a digital-to-analogue converter (DAC) is
compared with the input signal, while an eÔ¨Écient algorithm is used to get
the right digital number in the least possible steps. Figure 8.26 shows this
working principle with a DAC based on a R-2R ladder-network.
The R ‚àí2R ladder-network is best understood when starting at the Ô¨Årst sec-
tion with the least signiÔ¨Åcant bit (LSB) switch S1. The source impedance at
point (1) is two times 2R in parallel, which results in a Thevenin impedance
of RTh = R. This is indiÔ¨Äerent of the setting of switch S1. With both settings
a low impedance path to ground is created at the switch, as a voltage source
has a zero source impedance.
The Thevenin voltage Vth(1) of this Ô¨Årst section at point (1) equals either zero
or 0.5Vr, depending on the setting of S1. The Thevenin impedance of the
Ô¨Årst section is loaded by the second section and creates a voltage divider
with the resistances R and 2R of the second section, where the 2R resistor
is connected to ground at S2, either directly or via the voltage source. This
voltage divider results in an attenuation of the Thevenin voltage of the Ô¨Årst
section with a factor two, so either 0 V or 0.25Vr.
The equivalent Thevenin source impedance of this Ô¨Årst and second section
combined also equals R as two 2R resistors are connected in parallel to
ground like with the Ô¨Årst section. When switching S2 to Vr the resulting
Thevenin voltage at point (2) will be the sum of the voltage from S1 (0 or
0.25 √óVr) and the voltage from S2 (0 or 0.5 √óVr) resulting in a total voltage
of 0, 0.25, 0.5 or 0.75 √óVr, depending of the settings of S1 and S2.
This reasoning can be repeated for the next stages to get the total voltage at
point (3) and point (4). While in the Ô¨Ågure only 4 bits are shown, an accurate
multi-bit DA-converter can be designed with only two values of resistors,
which is very suitable for realisation in a precision integrated circuit.
The logic circuit for the AD-converter works as follows:

738
Chapter 8. Measurement in Mechatronic Systems
2R
2R
2R
2R
2R
R
R
R
Vr
+
_
1
0
1
0
1
0
1
0
LSB
MSB
+
_
Logic processor
Vi
+
_
1/0
S1
S2
S3
S4
S1
S2
S3
S4
Th
R
R

Th
R
R

Th
R
R

1
2
3
4
Comparator
1         0        1         0                  0        1         0         1                   0         1        1         1
MSB (8)                 LSB (1)         MSB                          LSB              MSB                         LSB
Time (8 clock pulses)
Time
Time
16 voltage levels
Analogue voltage
set
keep
set
reset
set
keep
set
reset
set
keep
set
reset
set
keep
set
reset
set
keep
set
reset
keep
set
keep
set
Figure 8.26: A 4-bit Analogue-to-Digital converter, based on the principle of suc-
cessive approximation, with an R-2R DA converter, a comparator and
a logic processor. The lower graph shows in three examples how the
four bits are sequentially determined in eight set and decide (keep or
reset) steps.
‚Ä¢ First the most signiÔ¨Åcant bit (MSB) is switched on with an output
voltage of the DAC of half the full scale. When this results in a higher
output voltage than the analogue input voltage, the output of the
comparator will go from 1 to 0 and the processor decides to reset the
MSB back to 0. Otherwise the processor decides to keep the MSB to 1.
‚Ä¢ Then the second signiÔ¨Åcant bit is switched on and the same decision
process takes place: ‚ÄúKeep bit setting if output of DAC is smaller than
input, reject when larger‚Äù.

8.4. Signal Processing
739
‚Ä¢ This step is continued for every bit in sequence of lower signiÔ¨Åcance
until the least signiÔ¨Åcant bit is deÔ¨Åned.
The main advantage of the successive-approximation ADC is its absolute
resolution within one sample period, the reliable timing and the inherent
linearity, which is mainly determined by the applied DAC. As long as the
DAC has enough time to stabilise after each step, the additional errors
can remain below the value of the least signiÔ¨Åcant bit. Note that this
stabilisation of the voltage at the DAC is always necessary because of the
required time to charge parasitic capacitances, which are always present in
any electronic circuit. This is indicated in the Ô¨Ågure by the gradual slope
after the (re-)setting of any bit. This timing requirement inherently leads
to a potential drawback of this method as it requires many steps for a high
number of bits. During these steps the input voltage has to remain constant
until the entire procedure is Ô¨Ånished. This means, as was stated before,
that after the moment of sampling the momentary value of the input voltage
has to be ‚Äúremembered‚Äù as long as necessary with a sample and hold circuit.
Also this process needs time as the conversion process can only start, when
the hold value is stabilised. The consequence of this reasoning is that very
high speed electronics are needed to avoid a high latency.
Monotonicity
An important aspect with SAR-ADCs is the monotonicity of the applied multi-
bit DAC. A DAC is fully monotonic when an increase of the discrete value
at the input always corresponds to an increase of the signal at the output.
If for instance the input changes with only one LSB from the 6-bit binary
number 011111 to 100000, than all bits change. If the error of the combined
other bits is larger than one LSB this change could very well result in a
lowering of the output voltage if the combined error is negative. This error
is comparable with the error presented in Section 8.4.2.1 where a position
uncertainty between the bit transitions of a code-disk could cause an erratic
value. The requirement for monotonicity leads to a strict requirement on
precision of the output value of the all bits, being smaller than the value
of the LSB. The large impact of the MSB translates this requirement in a
precision of better than 0.5√óLSB, necessitating a precise trimming of the
applied resistors, which is rather costly. For this reason SAR-ADCs are
limited in bit depth to maximum approximately 18 bits while 12-16 bits are
more common.

740
Chapter 8. Measurement in Mechatronic Systems
8.4.3.3
Sigma-Delta ADC
The last example of an ADC, the Sigma-Delta (Œ£Œî) analogue-to-digital con-
verter, is based on another principle that combines the cost beneÔ¨Åts of the
dual slope converter with a much higher sampling frequency and makes use
of extreme oversampling. Oversampling means that the signal is sampled
with a frequency that is signiÔ¨Åcantly higher than necessary according to the
‚ÄúNyquist‚Äù criterion of two times the maximum signal frequency. This allows
the use of rather simple electronics, no sample and hold or anti-aliasing
Ô¨Ålter and even only a one bit DAC with just two values, V ‚àí
r and V +
r . This ex-
treme one-bit DAC version is frequently applied in applications that require
a high linearity and resolution without the need for low latency, like with
digital audio. Figure 8.27 shows the basic circuit diagram of this converter
and the signals with a sinusoidal input voltage. The core of a Œ£Œî-ADC is
the Œ£Œî-modulator, which converts the input voltage in a ‚Äúbitstream‚Äù con-
sisting in a timed stream of 1 bit coded signals. A digital processor, the
‚Äúdecimator‚Äù converts this bitstream in a stream of multi-bit decimal data.
The Œ£Œî-modulator is a variation on the pulse-width modulator that was
described in Section 6.3.2 for a switched-mode power ampliÔ¨Åer. The block
diagram of Figure 8.27 shows the main components of a Œ£Œî-modulator:
‚Ä¢ A diÔ¨Äerential ampliÔ¨Åer, shown as a circle, which gives the diÔ¨Äerence
between the analogue input voltage and the output of the 1-bit DAC.
‚Ä¢ A non-inverting integrator, which consists of an inverting integrator
and an inverting ampliÔ¨Åer with a gain of one.
‚Ä¢ A non-inverting comparator with a very small hysteresis.
‚Ä¢ A latch to transfer the momentary value at its input to the output at
the positive edge of the clock.
‚Ä¢ A digital processor to create digital data from the output of the latch.
‚Ä¢ A clock to deÔ¨Åne the timing sequence of the conversion process.
‚Ä¢ A one bit AD-converter with two output states.
The non-inverting integrator integrates (Œ£) the diÔ¨Äerence (Œî) between the
momentary value of the input signal and the output of the 1-bit DA-converter.
The output of the non-inverting integrator will rise when this diÔ¨Äerence
is positive or fall when this diÔ¨Äerence is negative. Like with the pulse-
width modulator, the comparator is used to detect the exact moment that

8.4. Signal Processing
741
Vi
Vr
+
Vr
+
Vr
_
Vr
_
2Vr
+
2Vr
_
\`
,\]
¬ã$

¬ã$


0
,
¬¢{
¬Ø{
0
,



,\]
]!
,
2
3
4
5
6
7
D

+
_
Vi
+
_
L
Di$i
P
]!
Bim
+
_
,iD]
/ 
]m
Vr+ Vr
+
_
,
2
3
4
5
6
7
¬ö$$
+
_

Figure 8.27: Sigma-Delta analogue to digital converter. A non-inverting integrator
integrates the diÔ¨Äerence between the input signal and the output
signal of a one bit DA converter. A positive output of the integrator
results in a one and a negative output in a zero at any clock cycle. The
resulting ‚Äústream‚Äù of bits has an average analogue value equal to the
analogue input signal.
(Courtesy of Uwe Beis)

742
Chapter 8. Measurement in Mechatronic Systems
the output of the integrator crosses a reference value, but in this case the
hysteresis is very small and the reference voltage is 0 V. Another diÔ¨Äerence
is that the moment of switching does not immediately take place after a
change in the output of the comparator but the decision moments are based
on the clock with a latch, which transfers the output of the comparator to
the digital processor at a positive edge of the clock. The output of the latch
will set the 1-bit DAC to give V +
r when the output of the comparator gives a
1, which corresponds to a positive voltage at the output of the integrator.
The 1-bit DAC will be set at V ‚àí
r when the comparator gives a 0 at a negative
output voltage of the integrator. The resulting output of the latch is a
so called bitstream, a continuous stream of bits at a very high frequency.
This bitstream can be converted in normal digital numbers by a suitable
decimation Ô¨Ålter algorithm giving multi-bit decimal data at Ô¨Åxed intervals.
In principle the loop with the integrator-inverter-comparator-latch-DAC-
integrator acts like a negative feedback loop with three times an inversion.
As a result of the integration, the steady state error is zero and the average
value of the output of the 1- bit DAC will be equal to the inverted value of
the input voltage. With a little bit of imagination this is visible in trace (6)
in Figure 8.27. As a consequence, the reconstruction of the original signal
is possible by simple low-pass Ô¨Åltering of this bitstream. This is comparable
with the output Ô¨Åltering in a switched mode PWM power ampliÔ¨Åer.
This direct reconstruction principle is applied in the ultimate audio format,
‚ÄúSuper Audio CD‚Äù with ‚ÄúDirect Stream Digital‚Äù registering maximum 22
kHz audio with 64 times oversampling, which gives 64 ¬∑ 44 ¬∑ 103 = 2.8224
MHz clock sampling. It achieves a dynamic range of 120 dB in the audible
frequency range, while it is allowed to register frequencies up till 100 kHz
at a reduced dynamic range without any aliasing eÔ¨Äects because of the
high sampling frequency. The main beneÔ¨Åt of a Œ£Œî-ADC is its linearity,
high signal-to-noise ratio and low-cost. The low cost is related to the lack
of precision components as there is no multi-bit DAC needed with strict
requirements on monotonicity. The linearity is a direct consequence of the
one-bit DAC where all values are related to the magnitude of this one-bit and
a deviation in this one-bit works relative all measurement values, thereby
avoiding problems related to monotonicity. The high resolution is a direct
consequence of the high sampling rate, which causes the noise to be spread
over the total frequency range below the Nyquist frequency, which is much
higher than the maximum signal frequency, thereby reducing the noise at
the frequencies area of interest. Noise-shaping by the feedback loop via the
1-bit DAC in the Sigma-Delta modulator further shifts the noise to higher
frequencies above the frequency area of interest.

8.4. Signal Processing
743
8.4.3.4
ADC Latency in a Feedback Loop
The low cost and excellent linearity properties of the Sigma-Delta ADC
have replaced other ADC types in many measurement and registration
systems, especially where storage of data is more important than real-
time measurement. This has typically been the case in audio recording
and reproduction. The reason why this principle is less applied with real-
time measurements is the time delay between the bitstream representing
the actual value and the availability of the corresponding value after the
decimation Ô¨Ålter. The resulting latency amounts with a low cost Œ£Œî ADC
approximately twenty times the sampling period of the decimated digital
output. A 50 kHz decimated sampling frequency has a sample period of
20 Œºs, resulting in a total latency of more than 400 Œºs. This would cause
almost 180¬∞phase delay for a 1kHz signal frequency with a 1000 Œºs period,
which is not acceptable with high bandwidth motion-control systems. This
phenomenon clearly illustrates the necessity to distinguish sample frequency
from speed.
The SAR-ADC is still the mostly applied type for data-acquisition and
feedback systems because of its single sample latency. Within one sampling
period the internal SAR clock, working on an n-times higher frequency
than the sampling frequency for n bits, can deliver the exact value of the
sampled signal directly at the end of the sampling period. Presently the
SAR-ADC can be integrated in one IC. The precision trimmed resistors of
the applied DAC are replaced by precision capacitors, applying a working
principle based on charge redistribution. The details of this method are not
important within the scope of this book but the most important beneÔ¨Åt of
this method is the reduced cost because precision capacitors are more easy
to realise in an IC than precision resistors.

744
Chapter 8. Measurement in Mechatronic Systems
8.4.4
Connecting the Less Sensitive Elements
Even though the signal conditioning element serves to create a robust signal,
it is necessary to transport this signal with care in a coaxial or twisted pair
cable. Also the digital data after the A to D conversion should be transported
with a careful choice of the connecting cables. Digital information is mostly
transported by means of serial data over one or two shielded wires. Serial
data transport means that all bits are transmitted sequentially according to
a standardised protocol that describes in which order the bits are transported
and which additional bits are necessary at the beginning or end of each
sample to distinguish the Ô¨Årst and last data-bit of a sample. This means
that the transmission bandwidth has to be at least larger than the sampling
frequency times the number of bits per sample. Next to the reason to prevent
interference by interaction of diÔ¨Äerent data cables, this high transmission
bandwidth poses severe requirements to the connecting cables, especially
when the signals have to be transported over very long distances.
8.4.4.1
Characteristic Impedance
Any combination of two wires will have a certain total capacitance and self-
inductance value. When examining a connecting cable with two wires more
in detail, such a cable can be modelled as an inÔ¨Ånite series of inÔ¨Ånitesimal
LC-Ô¨Ålter elements. Such a combination behaves like a transmission-line
or wave-guide, an electrical equivalent to the travelling wave in the rope
as was presented in Chapter 2. Just like with the mechanical example, a
signal at the input of the cable will arrive with some delay at the output,
but what is more important is that the signal will be reÔ¨Çected back towards
the input, where it will again be reÔ¨Çected. This can cause standing waves
and resonances in the signal.
L
L
L
L
L
L
C
C
C
C
C
C
Figure 8.28: A cable with two wires, like a coaxial cable, is equivalent to a series
of small inductors and capacitors. This combination represents a
characteristic resistive impedance, equal to the required resistive load
to get Q = 1.

8.4. Signal Processing
745
It was shown in Chapter 6 that an LC-Ô¨Ålter can be damped by means of
a resistor and in the same way the reÔ¨Çection of a connecting wire can be
prevented when it is terminated by means of a resistor with a value that
would result in a quality factor Q = 1 in combination with the capacitance
and self-inductance of the cable. With Equation (6.28) the value of this
characteristic impedance Rc can be calculated:
Q = Rc

C
L = 1
=‚áí
Rc =

L
C
[Œ©].
(8.40)
The ratio between L and C is independent for any length of the same cable
as both L and C increase proportional to this length. This means that also
the characteristic impedance is independent of the length of the cable.
A cable with inÔ¨Ånite length shows at its entrance an input impedance equal
to this characteristic impedance Rc. This can be proven by mathematics
but it can also be reasoned when thinking of a short impulse, sent by a
voltage source into the cable. This voltage impulse will create a current in
the wire, depending on the impedance of the cable at its entrance, and the
energy of the impulse will equal the integral of voltage times current during
that impulse. This energy package propagates over the cable as a wave in
the same way as explained for mechanical waves in Section 2.3.3.4 of the
physics chapter. With a lossless inÔ¨Ånitely long cable the impulse will be
propagated until inÔ¨Ånity but when the cable is cut at some position where it
is terminated by Rc, the energy of the impulse will be absorbed by Rc at that
position. This absorption can not be perceived by the source at the entrance,
because the impulse is not reÔ¨Çected and as a consequence the source can not
‚Äúrecognise‚Äù the state of the cable, whether it is inÔ¨Ånite or terminated with
its characteristic impedance. This means that the perceived impedance at
the input of the cable does not depend on the length of the cable, as long as
it is terminated by Rc. This general conclusion implies also that this is true
for any length where the cable is terminated by Rc, even when the cable is
terminated directly at the source. In that case Rc is directly connected to the
source and the source perceives this load as a resistor. From this reasoning
it follows that a cable, terminated by Rc, will be perceived as a resistive
load with a value equal to the characteristic impedance Rc for any length.
This also means that the voltage and current of an electrical signal at the
entrance of a cable, terminated by Rc, will be in phase and a non-inÔ¨Ånite
cable, terminated by Rc, will behave dynamically like an inÔ¨Ånitely long
cable.
A cable has two ends and signals can be generated at both sides, either by
separate sources or by a non perfect termination, causing some remaining

746
Chapter 8. Measurement in Mechatronic Systems
reÔ¨Çection. This means that an optimal connection is only achieved when
both sides of the cable are terminated with Rc, requiring that the output
impedance of the source and the input impedance of the succeeding element,
often called the receiver, are both equal to Rc. When that condition is not
met, a short cable might possibly not raise much problems as it will only
give an undamped response at a very high natural frequency. For example
a coaxial cable with a characteristic impedance of 50 Œ© has a capacitance
of approximately 50 pF per metre. Based on these values the inductance
over one metre would be equal to L = R2
c C = 125 nH. When all capacitance is
approximated to be concentrated at the end of the cable and all inductance is
in series, this combination would act as an LC Ô¨Ålter with a natural frequency
of œâ0 =
1/LC = 4¬∑108, which is approximately 60 MHz. No reÔ¨Çections will
occur as long as the transferred signals do not contain any frequencies at
or above œâ0. Actual wired data connections, however, already transmit
frequencies above 1 Gbit per second so in that case even one metre of cable
should be terminated with the right impedance in order to prevent reÔ¨Çections
and high-frequency attenuation. Longer cables will increase the problem
by lowering the natural frequency proportional to the length of the cable.
The full derivation of the related equations is beyond the scope of this book
but some observations are interesting enough to be added here.
At Ô¨Årst sight the equal output impedance of the source and input impedance
of the receiver will result in a factor two attenuation of the signal. This
however is not bad at all as this level corresponds to the maximum power
that the source can deliver, as was shown in Chapter 6. This is optimal
from an interference point of view as it is related to the interfering energy
relative to the energy in the useful signal. Furthermore, even frequencies
above the natural frequency of a non-terminated cable will be transmitted
equally well because at any position in the cable the signal ‚Äúsees‚Äù only the
resistive characteristic impedance in two directions and resistance is not
frequency dependent.
It should be noted that the real series resistance of the wires in the cable
is not addressed here. In principle this resistance causes a gradual loss
of the signal over the length of the cable, limiting this length to a value
that depends on the available signal level at the input of the cable and the
noise at the receiver. This eÔ¨Äect of the series resistance should certainly
be taken into account when terminating the wire with a low characteristic
impedance like 50 Œ©, but this low value also guarantees a low noise level. In
practical mechatronic systems the eÔ¨Äect of the series resistance can mostly
be neglected, as long as the length of the cables remain in the single digit
metre range.

8.4. Signal Processing
747
8.4.4.2
Non-Galvanic Connection
Although well deÔ¨Åned wired connections are very suitable for many ap-
plications it still suÔ¨Äers from the problems with ground loops and other
disturbances, which were previously presented. A real solution of all these
problems is based on the transfer of information by means of light. In
Section 6.3.2.6 of Chapter 6 the opto-coupler was introduced, consisting
of a light emitting diode (LED) and a light sensitive phototransistor that
are electrically insulated from each other. A current in the LED will give
a proportional light output, which creates a proportional current in the
transistor. The current ampliÔ¨Åcation ratio of the transistor results in a
current level in the same order of magnitude as the current in the LED.
Also light sensitive diodes can be used. They have a higher switching speed
but also a reduced current because they fail the current ampliÔ¨Åcation of
the phototransistor. A clear advantage of the opto-coupler is the galvanic
insulation, which completely cancels any kind of ground loops, although at
very high frequencies some capacitive coupling still remains. The applica-
tion of opto-couplers is mainly limited to the transfer of data in the digital
domain, so after the signal processing element, because of the signiÔ¨Åcant
temperature dependent non-linearity. A special version of the opto-coupler
is the Ô¨Åbre coupling of Figure 8.29. The insertion of an optical Ô¨Åbre between
the LED and the phototransistor completely cancels the capacitive coupling
but more important is the possibility to transport the signal over very long
distances without any electromagnetic interference. When necessary even
a strong semiconductor laser can used as the light source. This technology
has become the de-facto standard for data transfer over very long distances
like with internet.
Ii
Io
($¬é$
%
6
V   
p
+
Figure 8.29: Transfer of a digital signal with a Ô¨Åbre coupling prevents electric
disturbances and errors by ground loops. It consists of a light emit-
ting diode that transmits light through the optical Ô¨Åbre towards a
phototransistor.

748
Chapter 8. Measurement in Mechatronic Systems
8.5
Short-Range Motion Sensors
The Ô¨Årst category of position and motion sensors are those sensors that are
used to determine the relative position of two objects at short ranges and
these sensors are often called a proximity detector. Typical applications
include the boundary detection for long-range actuated systems. Also the
sensors for Ô¨Åxating a position by means of a servo system like in a magnetic
bearing belong to this category. Often only the accuracy at the zero position
is relevant while the sensitivity over the total measurement range is relevant
for the gain of the servo-loop.
The second category consists of those sensors that register motion like
velocity and acceleration. They are applied in many diÔ¨Äerent Ô¨Åelds like in
geophysics to detect earthquakes and in precision equipment for vibration
control.
Out of this wealth of possibilities only a few examples are selected as these
are representative for the entire Ô¨Åeld
8.5.1
Optical Sensors
The Ô¨Årst example of a proximity detector is shown in Figure 8.30. It con-
sists of a light emitting diode and a photo-transistor sensor in one housing
‚Äúlooking‚Äù in the same direction. The working principle of this optical proxim-
ity detector is based on the diÔ¨Äerence in irradiance levels detected at the
photo-transistor as a function of a distance of the object. It is interesting to
see that there are two areas that can be used with an approximately linear
relationship between the position and the current. This is due to the fact
that at zero distance the object will obscure the LED sensor combination
and at inÔ¨Ånite distance no light is reÔ¨Çected anymore. Somewhere in between
there is a maximum of captured light at the detector with two slopes at each
side. The slope at the near side has the highest sensitivity. 6
In order to achieve some level of accuracy both modifying and interfering
error sources of this system must be determined. First of all the current
level of the LED has inÔ¨Çuence as it is directly proportional to the amount of
emitted light. The overall shape of the curve of Figure 8.30 will be unaÔ¨Äected
but the magnitude is linearly proportional to the amount of light from the
6If this detector is applied in a servo system it is necessary to be aware that the two slopes
work with an opposite sign. This means that a stable system working on one slope will be
unstable due to phase sign reversal at the other slope. This necessitates special precautions,
when the system is out of range and the stable point has to be retrieved.

8.5. Short-Range Motion Sensors
749
Detector
(Photo-Transistor)
¬ô'|(¬ô\¬á
¬ô'
Sensor
z
¬±
6
0
Figure 8.30: An optical proximity detector consisting of a Light Emitting Diode
with a sensor that determines the irradiance of the reÔ¨Çected light
from an object. The relation between the current of the sensor and
the distance of the object (blue line) shows two opposite approximately
linear slopes (dashed red line), which are both applicable for position
sensing.
(Courtesy of Jasper Wesselingh)
LED. This means that the current in the LED is both a modifying input as
it changes the slope (sensitivity) and an interfering input as it changes the
value at any position. The eÔ¨Äect of this can be reduced by comparing the
current with a reference current that is proportional to the current in the
LED. Also supplying the LED with a constant current source as presented
in Chapter 6 is a suitable method to reduce the inÔ¨Çuence of the LED.
Other error sources include the reÔ¨Çectivity of the object, the angle of the
object, noise in the detector and ambient light that is detected by the photo-
transistor. The inÔ¨Çuence of the ambient light can be reduced by using an
optical Ô¨Ålter in order to only detect the wavelength of the LED light. To limit
the noise of the detector an ampliÔ¨Åer with a low input noise level must be
located as close as possible near the sensor. Figure 8.31 shows an example
of such a circuit, which is also optimised for high-frequency behaviour as the
transistor is directly connected to the virtual ground at the minus input of
the ampliÔ¨Åer. This means that the current from the transistor is transformed
into a voltage at the output of the ampliÔ¨Åer without causing a voltage change
over the transistor itself, thus avoiding high-frequency current from the
collector to the base by the internal parasitic Miller capacitor.
8.5.1.1
Position Sensitive Detectors
Instead of a single photo-transistor or a photo-diode also a sensor consisting
of a multitude of sensing elements can be used, giving both information on
the irradiance and on the position of the light spot that is directed to the

750
Chapter 8. Measurement in Mechatronic Systems
Vo
G
R
+
_
I
+
_
Vb
Figure 8.31: A photo-transistor works optimal with reduced current noise, when it
is supplied with a constant bias voltage Vb. The virtual ground at the
minus input of the operational ampliÔ¨Åer cancels the AC voltage over
the transistor, which gives a better high-frequency behaviour.
(Courtesy of Jasper Wesselingh)
device. An example of this principle is the four-quadrant detector with 4
photo-diodes, also called a quad-cell, as shown at the left side of Figure 8.32.
Also an analogue version of this four quadrant detector exists as shown on
the right side. The total area of this detector is sensitive to the incident
light but the resulting current is transported to the four external contacts
by means of a material with a high resistivity. This causes the current of
each contact point to be inverse proportional to the distance to the incident
spot of the light.
With both types of PSDs the ratio between the current of each output is
ideally related to the position of a light spot that is exposed on these sensors
according to the following equations:
x = c1
(I2 + I4)‚àí(I1 + I3)
I1 + I2 + I3 + I4
[m],
(8.41)
y = c2
(I1 + I2)‚àí(I3 + I4)
I1 + I2 + I3 + I4
[m],
(8.42)
where c1 and c2 are constants that are determined by the dimensions and
electrical characteristics of the sensor.
By dividing the diÔ¨Äerence of the currents by the sum of all four currents the
resulting value is independent of the irradiance of the light beam, which
would otherwise be a modifying input. In reality, the relation between the

8.5. Short-Range Motion Sensors
751
y
x
I1
I2
I3
I4
I1
I2
I3
I4
Beam of
light
Beam of
light
Quad-cell
Proporonal
Figure 8.32: The four quadrant position sensitive detector either consists of 4 sepa-
rate photo diodes as shown at the left side or of one large photosensitive
area with high resistive paths to the output wires as shown at the
right.
position and the found values also depends on the size of the light beam,
the distribution of the light inside the beam and the character of the sensor.
Generally a four-quadrant detector is used as a zero-sensor in a feedback
system like in the Optical pick-up unit of a CD-player, as around zero the
errors due to diameter and light distribution are minimal. A proportional
sensor is less sensitive for these deviations but it shows more noise due to
the high resistivity.
A more elaborate example of such a sensor is the CCD sensor as used in
digital cameras and the Shack-Hartmann wavefront sensor from Chapter 7.
In order to avoid a large number of wires a CCD sensor has a dedicated
electronic circuit, the charge coupled device, which makes it possible to
read out a row of photo-diodes in series by sequentially transferring the
accumulated charge of each photo-diode (the integral of the current over the
sampling time) to its neighbour like buckets of water that are transferred
by people in a row to empty a well.

752
Chapter 8. Measurement in Mechatronic Systems
8.5.1.2
Optical DeÔ¨Çectometer
A position sensitive detector can be used to measure several mechanical
properties. By deÔ¨Çecting a beam of light oÔ¨Äa surface and projecting it
on the PSD it is possible to determine the angle and/ or the position of
this object as shown in Figure 8.33. This method is called triangulation
because the real displacement depends on the angles and can be calculated
by trigonometry. In this simple set-up the angle can not be distinguished
from the displacement of the surface. This can be solved by focusing the
beam on the surface and imaging that focal spot by a lens on the PSD. In
that case the angle will have no inÔ¨Çuence anymore.
An example where imaging is used to detect the angle of a surface instead
of the height is the DeÔ¨Çectometer of Figure 8.34. This instrument is used
to measure the surface shape of a reÔ¨Çective surface. It works as follows:
A laser beam is directed to a mirror that oscillates around the point of
incidence of the laser beam. The laser beam will be reÔ¨Çected in diÔ¨Äerent
directions between the outer positions as shown in the picture, because
of this oscillation, causing a scanning light spot on the scan lens. This
lens is positioned such that the rotating point of the mirror is in its focal
plane, which means that the rays from the laser beam after the lens are
always running parallel. The angles of these rays are only determined by
the position of the oscillating mirror relative to the optical axis so they are
independent of the momentary angle of the mirror. The surface that must
be measured reÔ¨Çects these parallel rays back to the lens where they will be
focused again to create an image of the original spot on the rotating mirror.
Posion Sensive Detector (PSD)
Mirror surface
ds
dd
Laser
Figure 8.33: Surface displacement measurement with a position sensitive detector
by means of triangulation. A shift of the surface (ds) will cause a shift
(dd) of the laser beam on the PSD.

8.5. Short-Range Motion Sensors
753
Figure 8.34: Optical deÔ¨Çectometer, which measures the shape of a surface by a
scanning beam and suitable optics that images the spot of the oscillat-
ing mirror to the PSD via the surface. Local angular variations of the
surface will result in position diÔ¨Äerences of the spot on the PSD.
The image will be positioned at the same distance7 right of the optical axis,
where the PSD sensor is located, because the rotating mirror is positioned
just left of the optical axis. The position of this image is not inÔ¨Çuenced
by the angle of the mirror as long as the surface that must be measured
is perfectly Ô¨Çat, because the spot of the rotating mirror is imaged on the
PSD. When that is not the case the parallel incident rays on the surface
will not be reÔ¨Çected parallel anymore and an angular deviation at a certain
location on the surface will result in a change of position of the spot on the
PSD. When the corresponding electrical signal is synchronised with the
oscillation of the mirror, this position signal of the PSD gives information
about the slopes at diÔ¨Äerent locations on the surface and by calculation the
shape of that surface can be derived.
7This is a 1:1 optical system as both image and object are in the focal plane and a positive
lens inverts the sign of the position relative to the optical axis.

754
Chapter 8. Measurement in Mechatronic Systems
8.5.2
Capacitive Position Sensors
In Section 6.1.2.2 of Chapter 6 it was shown that a capacitor consists of two
parallel plates, separated by an electrically non-conductive dielectric layer
with a capacitance of:
C = ŒµA
d
[F],
(8.43)
with Œµ = Œµ0Œµr and
Œµ0 ‚âà8.85418781762039¬∑10‚àí12
As/Vm

.
(8.44)
For air Œµr equals approximately one but as will be shown further in this
chapter, this assumption is a cause for errors.
This inverse relationship of the capacitance with the distance is the reason
that this physical property is used to determine displacements between
two objects that are positioned close together. An AC source is necessary
to determine the capacitive value with the complex version of Ohm‚Äôs law
(V = Z ¬∑ I). In Figure 8.35 it is shown that not only the mutual distance
between the plates can be used to measure displacements but also the other
two terms in the simple relation can be made variable corresponding to a
displacement. In case the displacement of one of the plates is in its own
plane the distance remains the same but in this case the shared surface is
changed while in the third example a separate part with another dielectric
value is inserted between the plates, which also gives a change in the
capacitance according to the position of this part relative to the plates. Each
solution has its own advantages. A variation of the distance gives generally
a higher sensitivity than the parallel movement of the plates but the latter
has a better linearity, which can be concluded from the respective transfer
x

A
d
Vs(~)
+
_
Metal plate
Dielectric
d
x
x
Distance                   Area                   Dielectric
1
2   
I (~)
w
l
l
l
l
d
d
d
d
x
&
'
(
)
*
+
d
d
A
x
&
'
(
)
*
+
d
dx

&
'
(
)
*
+
Figure 8.35: Three types of capacitive position sensing by changing the position of
two plates of a capacitor in two directions or changing the dielectric
properties as function of the displacement.

8.5. Short-Range Motion Sensors
755
functions of these three examples:
1: Variable-distance:
C = ŒµA
d + x
[F],
(8.45)
2: Variable-area:
C = Œµ
d (A ‚àíwx)
[F],
(8.46)
3: Variable-dielectric:
C = Œµ0w
d (Œµ2l ‚àí(Œµ2 ‚àíŒµ1)x)
[F].
(8.47)
From these three diÔ¨Äerent sensing principles it can be concluded that a
measurement according to one principle is also inÔ¨Çuenced by the other eÔ¨Äects.
Especially the distance has a very large inÔ¨Çuence on the sensor in case of the
variable-surface and variable-dielectric sensor. With these principles the
distance acts as a modifying error source. In case of the variable distance
sensor the lateral displacement has less inÔ¨Çuence especially if one of the
electrodes is larger than the other. The variable-distance measurement
capacitive sensor is preferred, because of its high sensitivity, but the non-
linearity still is a factor that preferably is avoided. This can be achieved
by means of a diÔ¨Äerential sensor and the previously presented Wheatstone
bridge as shown in Figure 8.36.
8.5.2.1
Linearising by DiÔ¨Äerential Measurement
The diÔ¨Äerential capacitive sensor consists of two stationary electrodes E1,E3
with a moving electrode E2 in between. The capacitance C1 is the combina-
tion of E1 with E2 and the capacitance C2 is the combination of E2 with E3.
When the surface of the electrodes is equal to A the capacitance becomes:
C1 =
AŒµ
d ‚àíx,
C2 =
AŒµ
d + x
[F].
(8.48)
The voltage Vo = V1 ‚àíV2. When applying the rules of a voltage divider this
voltage equals:
Vo = Vp

Z2
Z1 + Z2
‚àí
Z4
Z3 + Z4

[V].
(8.49)
In order to get a positive output voltage with a movement in the positive
x‚àídirection C1 can be located at Z1 and C2 at Z2 to give an increase of V1.
Another option would be when C1 is located at Z4 and C2 at Z3 as in that
case a positive movement in the x‚àídirection gives a decrease of V2. In this
example Z1 and Z2 are chosen and Z3 = Z4 are two equal resistors to balance
the bridge.

756
Chapter 8. Measurement in Mechatronic Systems
+
_
Vp(~)
V1
+
_
V2
+
_
+
_
o
1          2
V
V
V

	
x
E1
E2
E3
C1
C2
d	x
dx
Figure 8.36: A diÔ¨Äerential capacitive sensor has a linear relation between the
displacement x and the voltage Vo.
With this choice the following equation gives the voltage as function of the
displacement:
Vo = Vp
‚éõ
‚éú‚éú‚éù
1
jœâC2
1
jœâC1
+
1
jœâC2
‚àí1
2
‚éû
‚éü‚éü‚é†= Vp

d + x
d ‚àíx+ d + x ‚àí1
2

= x Vp
2d
[V].
(8.50)
This is a linear and frequency independent relation.
8.5.2.2
Accuracy Limits and Improvements
From the previous part it can be concluded that the errors in capacitive
measurement sensors are caused by many external inÔ¨Çuences, summarising:
‚Ä¢ The amplitude and frequency of the source signal.
‚Ä¢ The noise of the sensing electronics.
‚Ä¢ Crosstalk of movements in other directions.
‚Ä¢ Thermal eÔ¨Äects due to change in size of the electrodes.
‚Ä¢ Changes in the dielectric.
‚Ä¢ Inhomogeneity in the electric Ô¨Åeld.
‚Ä¢ External electric Ô¨Åelds.
It is clear that the electric source has a large impact if the values are not
exactly known. Fortunately these electrical parameters can be controlled
to high levels of precision and the measurement result can in most case be

8.5. Short-Range Motion Sensors
757
compensated. This is less the case with the error by the noise of the sensing
electronics. In practice a capacitive sensor has a capacitance in the range of
a few pico-Farad, which requires a very high excitation frequency to create
a suÔ¨Éciently high current level for an acceptable signal to noise ratio. This
sensitivity can be illustrated by using the data of one of the best operational
ampliÔ¨Åers on the market regarding noise, the AD797 from Analog Devices.
It shows a voltage noise of 0.9 nV/
4
Hz and a current noise of 10 pA/
4
Hz.
With a 1 kHz bandwidth this is ‚âà30 nV and ‚âà0.3 nA of noise. When this
ampliÔ¨Åer is used with a capacitive sensor of 6 mm diameter active area
giving a surface area A ‚âà30mm2) and a distance d of 300 Œºm, this results
in a capacitance of ‚âà1 pF. A voltage source of 10V @ 1 MHz will create a
current of ‚âà0.1 mA, a factor 3¬∑105 above the 0.3 nA noise of the ampliÔ¨Åer.
With a distance of 300 Œºm this noise level corresponds to around 1 nm error.
When a lower error value is needed it is only possible to decrease the working
distance and hence limit the range.
The factors on thermal eÔ¨Äects and crosstalk of other movements are directly
related to the mechanical construction of the sensor in combination with
its surrounding parts. An isothermal measurement condition is required
to avoid the thermal errors but in principle it is preferred to design the
mechanics around the sensor in such a way that the so called thermal-
centre is located inside the sensor. The thermal centre in a construction is
deÔ¨Åned as the place where no local movement is observed at a change of
temperature. When the capacitive sensor is located at the thermal centre of
the measurement system, a temperature rise does not aÔ¨Äect the distance of
the plates. This is not always possible to achieve as it requires a thermally
symmetrical construction around the sensor where all other parts move
away from the thermal centre at a temperature rise. Sometimes the use of
materials with a diÔ¨Äerent thermal expansion coeÔ¨Écient can help to achieve
this goal. Aside from a linear movement by temperature rotations and other
movements between the plates have to be avoided by a stable construction.
Changes in the dielectric are present in case the sensor is not used in
vacuum, which is almost always the case. The relative permittivity of air
is a function of its composition and humidity and pressure variations can
be observed in the measurement value. Although this relation is expected
to be quite straightforward, the humidity level has a more direct eÔ¨Äect,
which is not yet completely understood. It is based on the occurrence of thin
layers of water on any object that is in contact with air that contains water.
The layer thickness depends on the partial pressure of the water vapour
(level of saturation). This layer has a far higher permittivity than air and
can in principle be approximated as a continuation of the electrode. This

758
Chapter 8. Measurement in Mechatronic Systems
Transmi¬éng electrode (Moving part)
Sensing electrode
Guard Ring
+
_
Vp(~)
G
R
+
Vo
+
_
Io
Io
_
(~)
()
Figure 8.37: By using a guard ring the electric Ô¨Åeld at the sensing electrode is
homogenised. The capacitance is measured by virtually grounding the
sensing electrode and measuring the current with a transimpedance
ampliÔ¨Åer.
means that the air gap is decreased with the same amount as the water-
layer thickness. Much research is spent on this subject with measured
thickness‚Äôs ranging from 1 nm to almost a Œºm but no concluding results are
found to suÔ¨Éciently model this phenomenon so that it can be compensated.
Though this phenomenon is inÔ¨Çuenced by the hydrophilic properties of the
electrodes, the eÔ¨Äect occurs even with a PTFE layer. For extreme precision
measurements this means that these have to be done in dry air or vacuum.
Short term measurements are less critical as a change in the water layer
by the environmental humidity is generally rather slow, in the range of
minutes, depending on the geometry and diÔ¨Äusion speed.
Inhomogeneity in the electric Ô¨Åeld is caused by edge eÔ¨Äects as the Ô¨Åeld
lines are bent at the edges of the sensor. This can be reduced by a special
conÔ¨Åguration as shown in Figure 8.37 for a single ended sensor. It should
be noted that this sensor does not work with a Wheatstone bridge but in
this case the current of the sensing electrode is measured when grounding
this electrode at the virtual ground of a transimpedance ampliÔ¨Åer.
At the upper side a large electrode is supplied by the electrical supply with
a high-frequency AC voltage relative to ground. The opposing electrode,
the sensing electrode is much smaller and is surrounded by a guard ring,
which is kept to zero volt ground level. The sensing electrode is also kept at
ground level by the transimpedance ampliÔ¨Åer, which means the total lower
plane of the sensor is at ground level and the Ô¨Åeld lines will only bend at
the edges of the guard ring and not at the sense electrode.
The last item of errors is caused by the extremely small measurement
current levels as mentioned before. This makes this sensor type extremely
sensitive for interfering electromagnetic Ô¨Åelds even when only the excitation

8.5. Short-Range Motion Sensors
759
frequency is Ô¨Åltered out with a selective Ô¨Ålter. In case this sensor is applied
in a high bandwidth real time feedback controlled system, all measures for
shielding must be applied, while avoiding loops in the wiring. Furthermore,
the sensing electronics should be located as close as possible to the sensor.
With extreme critical applications this might even requires measures for
cooling the heat that relates to the often high power consumption of the
required low noise ampliÔ¨Åers in order to avoid thermal errors.
8.5.2.3
Sensing to Conductive Moving Plate
The guard ring method can in principle also be applied in a diÔ¨Äerential
sensor to achieve linearity but in some cases it is even necessary to measure
the distance to an object that can not be supplied directly with any electric
current by means of a connected wire. As an example one can think of a
continuously rotating shaft or a fast moving long-range linear positioning
system. In that case it is possible to use a third electrode at the stationary
part as shown in Figure 8.38. In this conÔ¨Åguration a series of two capacitive
sensors is obtained that both depend on the distance to the moving part.
When the total active surface area is unchanged, the capacitance of this
sensor is about a quarter of a normal sensor because the surface of the
electrodes is half and the distance is passed twice. This implies a very small
working distance in the order of 100 Œºm or less for real precision measure-
ments. In this case the guard ring is used to separate the transmitting
electrode from the sensing electrode. This will reduce the currents that
directly Ô¨Çows between both electrodes. When the transmitting electrode is
much larger than the sensing electrode the Ô¨Åeld on the sensing electrode
Transmi¬éng
electrode
Sensing electrode
Guard Ring
+
_
Vp(~)
Moving part
G
R
+
Vo
+
_
Io
_
(~)
()
Figure 8.38: By using two electrodes and a guard ring, the distance to a moving
conducting object can be measured without the need to directly contact
the moving part. In this case the guard ring reduces the current that
Ô¨Çows directly over the capacitance between the transmitting electrode
and the sensing electrode.

760
Chapter 8. Measurement in Mechatronic Systems
will determine the total current and in that case the more homogeneous
Ô¨Åeld at the sensing electrode will be also useful. Also this sensor is used
with virtual grounding by a transimpedance ampliÔ¨Åer.
As a conclusion, a capacitive sensor has the ability to give information about
the relative position of an object without any moving parts that are sus-
ceptible to wear. This means that these sensors can be used where a high
reliability over an extended period of time is required.
8.5.3
Inductive Position Sensors
In Section 5.1 of Chapter 5 the inductor was introduced, consisting of a coil
wound with n windings around a ferromagnetic core creating a magnetic
Ô¨Çux according to the following equation for a homogeneous core:
Œ¶w = nI
‚Ñú= nI AcŒº0Œºr
‚Ñìc
[Wb].
(8.51)
When the magnetic path consists of both a ferromagnetic core and an air
gap, the total reluctance is the sum of the respective reluctances. For the
situation as shown in Figure 8.39 the total reluctance equals:
‚Ñú=
‚Ñìc
AcŒº0Œºr
+
‚Ñìg
AgŒº0
= ‚Ñú0 + c1d
with: c1 =
2
AgŒº0
A/Vs

,
(8.52)
Note that the Ô¨Çux has to pass the air gap twice and that ‚Ñìc consists of two
parts, one part is the core with the windings and one part is the return path
to the object of which the distance d is measured.
The self inductance was deÔ¨Åned as follows:
L =
Œ¶w,t
I
= nŒ¶w
I
= n2
‚Ñú
[H],
(8.53)
g d
Ag
c,1
n windings
Ac
c,2
Ac



Figure 8.39: Distance and velocity sensor based on the variable reluctance of an
air gap.

8.5. Short-Range Motion Sensors
761
V1
+
_
V2
+
_
x
d	x
dx
L1
L2
+
_
1          2
o
V
V
V

	
+
_
Vp(~)
Figure 8.40: A diÔ¨Äerential reluctance sensor has a linear relation between the
displacement x and the voltage Vo.
where Œ¶w,t equals the sum of the Ô¨Çux Œ¶w of each winding. It is further
assumed that Œ¶w is equal for all windings. Using this deÔ¨Ånition, the self
inductance becomes:
L =
n2
‚Ñú0 + c1d =
L0
1+ c2d
with: c2 = c1
‚Ñú0
and: L0 = n2
‚Ñú0
[H].
(8.54)
The voltage over a self inductor is proportional to the change of the total
Ô¨Çux Œ¶w,t over time. This leads to the following relation:
V = dŒ¶w,t
dt
= d
dt LI = L dI
dt + I dL
dt
[V].
(8.55)
This means that an inductive sensor can use two sensing principles: In
case of an AC current through the coil the voltage is directly related to
the position. With a DC current the voltage is proportional to the relative
velocity. This second principle is hardly used for measurement as using
permanent magnets is far more eÔ¨Écient to detect a relative velocity in a coil
as will be explained later. For that reason this principle will not be pursued
any further. The Ô¨Årst term however is important as the self inductance is
inversely proportional to the distance, similar to a single capacitive sensor.
The related non-linearity can be solved in the same way as with a capacitive
sensor by using a Wheatstone bridge and two sensors in a balanced bridge
as shown in Figure 8.40. The impedance of an inductor is proportional to
the frequency (Z = jœâL). For that reason the other branch of the Wheatstone
bridge is taken as with the capacitive sensor in order to get a positive output
voltage with a movement in the positive x‚àídirection. The voltage can be
calculated with Equation (8.54) in the same way as with the diÔ¨Äerential
capacitive sensor:
L1 =
L0
1+ c2(d ‚àíx),
L2 =
L0
1+ c2(d + x)
[H].
(8.56)

762
Chapter 8. Measurement in Mechatronic Systems
The voltage Vo = V1‚àíV2 becomes, when applying the rules of a voltage divider:
Vo = Vp

Z2
Z1 + Z2
‚àí
Z4
Z3 + Z4

[V].
(8.57)
If Z2 = Z1, being just simple resistors in most cases and replacing Z3 and Z4
by the impedance of respectively L1 and L2, the following equation gives the
voltage as function of the displacement:
Vo = Vp

1
2 ‚àí
jœâL2
jœâL1 + jœâL2

= Vp
‚éõ
‚éú‚éú‚éù
1
2 ‚àí
1
1+ c2(d + x)
1+ c2(d ‚àíx) +1
‚éû
‚éü‚éü‚é†=
= Vp

1
2 ‚àí1+ c2d ‚àíc2x
2(1+ c2d)

= Vp
c2x
2(1+ c2d)
[V].
(8.58)
Also this relation is linear and frequency independent.
8.5.3.1
Linear Variable DiÔ¨Äerential Transformer
In laboratory measurements and workshops the Linear Variable DiÔ¨Äerential
Transformer (LVDT) as shown in Figure 8.41 is a frequently used instrument
for measuring small displacements. It is based on the principle of a coupled
alternating magnetic Ô¨Åeld. In Figure 8.42 the working principle is shown in
more detail. The transformer consists of three coils where the middle coil is
supplied with an AC voltage. The two secondary coils are positioned on both
sides in line with the primary coil. Other than with a normal transformer the
core is not closed but consists only of a small ferromagnetic rod with about
Di`erenal
transformer
Ampli%er 
6
Probe
0
50
100
Figure 8.41: A Linear Variable DiÔ¨Äerential Transformer can measure very accu-
rately small displacements around the centre position.

8.5. Short-Range Motion Sensors
763
+
_
Vs(~)
V1
+
_
V2
+
_
Phase sensive detector
1
2
V
V
	
Value Vo
Sign Vo
1
2
s
(
)
V
V
V
	
,
+
_
Vo
Amplitude of  
Top
Middle
Bo'om
Vs
V1
V2
1
2
V
V
	
Vo
Alternang
magnec ¬õux
1
2
s
(
)
V
V
V
	
,
Figure 8.42: Signals in an LVDT. The secondary coils in an LVDT partly share the
Ô¨Çux of the primary coil. In the mid position the induced voltages are
equal. A position change of the core will increase the Ô¨Çux at one coil
while decreasing the voltage in the other. The diÔ¨Äerence voltage is
then proportional to the displacement while the phase corresponds to
the direction.
the same size as the primary coil. In the mid position the ferromagnetic rod
is located just inside the primary coil. The generated magnetic Ô¨Çux from
the primary voltage will only partly be coupled to the secondary coils. The
induced voltage in these coils therefore is small and equal for both coils.
The subtraction of these voltages gives a value of 0 V, corresponding to this
mid-position. When however the core is moved in the direction of either
one of the secondary coils, the coupling with that coil will increase while
the coupling with the other coil will decrease with a corresponding increase
and decrease of the induced voltage. In that case the subtraction of both
voltages results in a voltage with an amplitude that is proportional to the
displacement. Depending on the direction, whether moving towards coil
A or B, the phase of the resulting signal will be inverted or non-inverted

764
Chapter 8. Measurement in Mechatronic Systems
giving the direction of the position. By using a phase selective detector a
DC voltage is obtained with a sign that corresponds to the direction of the
displacement. Phase selective detection can be achieved by taking the sign
of the signal obtained by multiplying the input with the output and use the
rectiÔ¨Åed and low-pass Ô¨Åltered output signal V1 ‚àíV2 to get the amplitude.
This principle was also explained in Section 8.3.2.2 regarding synchronous
demodulation of an amplitude modulated signal.
8.5.3.2
Eddy-Current Sensors
As a last example of an inductive proximity detector the eddy-current sensor
is presented here as it is frequently used in industrial systems to detect
the proximity to an electrically conducting object. Like with the LVDT,
its working principle is based on the interaction of two windings by their
coupled magnetic Ô¨Åeld however in this case one of the windings is the object
itself. When looking at Figure 8.43 the sensor consists of a single primary
coil wound around a ferromagnetic open core. This primary coil is supplied
with an AC voltage. The resulting magnetic Ô¨Åeld exits the core on one end
and enters it at the other. As soon as the sensor approaches the electrically
conducting surface of an object, the alternating magnetic Ô¨Åeld will induce an
alternating voltage in this surface comparable with the secondary winding
in a transformer. This voltage is however short circuited as this secondary
winding is a solid piece of metal resulting in an eddy-current that will sup-
press the magnetic Ô¨Åeld. This causes the current in the primary coil to
Ie
Induced AC eddy-current
Alternang  magnec ¬õux
AC primary current
Figure 8.43: Measuring the distance to a subject by means of an eddy-current sensor.
The magnetic Ô¨Åeld induces a voltage over the conductive object. This
creates a current that will suppress the magnetic Ô¨Åeld resulting in an
increased current in the primary coil.

8.5. Short-Range Motion Sensors
765
increase just like with a regular transformer and by measuring this current,
a value for the distance to an object is obtained. Information on the distance
is available both in the amplitude and in the phase of the primary current
relative to the primary voltage, which is explained as follows. At a large
distance from the conductive object the coil acts as an ideal self inductance
giving a current with a low amplitude that is 90¬∞delayed. As soon as the
distance is smaller the eddy-current will induce a real primary current,
which adds to the imaginary current level because the eddy-current is in
phase with the secondary voltage and consequently with the magnetic Ô¨Çux
and the primary voltage. This also means that the consumed power of the
sensor increases and the total current will be less than 90¬∞out of phase.
Eddy-current sensors are not very precise but measurements with Œºm accu-
racy around a Ô¨Åxed setpoint are well possible like in magnetic bearings.
8.5.4
Pneumatic Proximity Sensor or Air-Gage
Another method to detect distances on short range is by means of pressurised
air that is supplied to a measuring nozzle with a Ô¨Çow restriction to the
environment. This principle is shown in Figure 8.44 in two versions. The
pressure at the outlet of the nozzle depends on the inlet pressure and the
ratio of the Ô¨Çow restriction and the Ô¨Çow resistance of the air gap between
the nozzle and the object to which the distance is measured. By measuring
these pressures a very accurate measurement can be done up to less than a
micrometre.
P
&
$$¬ç¬ç
0!
P
$
            d
    d
*¬ã 


*6¬ï




Pin
Pin
nozzle
nozzle
&
$
0!
    d
Figure 8.44: Measuring the distance to a subject by means of an air gage. The
pressure in the nozzle Pnozzle is determined by the inlet pressure Pin
and the ratio between the Ô¨Çow resistance of the restriction and the air
gap.

766
Chapter 8. Measurement in Mechatronic Systems
8.6
Measurement of Mechanical Dynamics
Mechatronic systems are ruled by dynamic, time varying signals, which
are determined by forces acting on the system. The measurement of these
forces and the related velocity and acceleration of a positioning system is
most important in controlling a positioning system for all states. Also in the
dynamic modal analysis of a mechanical part inside a mechatronic system
these dynamic sensors are frequently applied.
8.6.1
Measurement of Force and Strain
Force is a physical concept as it is only indirectly observed at two diÔ¨Äerent
phenomena, strain and acceleration. The force we ‚Äúfeel‚Äù as a human being
is the result of strain as our body deforms under the inÔ¨Çuence of a external
force and we need to control our muscles to compensate that deformation.
Generally, even with direct measurement of acceleration, the force is trans-
lated into an electrical signal by means of the strain in a material that is
exposed to that force. The strain gage has become the standard method for
this measurement when the measurements need to include static forces.
Piezoelectric sensors are used when dynamic forces are measured and more
recent developments have resulted in a very sophisticated modern optical
method, using a Fibre Bragg Grating. The piezoelectric sensor is mainly
used in accelerometers and will be presented at Section 8.6.3 and the Fibre
Bragg sensor will be presented after the strain gage.
8.6.1.1
Strain Gages
A strain gage is a piece of thin conductive material, which changes its re-
sistance as function of a change of its dimensions. An elongation in the
direction of the current Ô¨Çow will increase the resistance both by the longer
trajectory and by the corresponding contraction of its diameter by the stretch-
ing eÔ¨Äect. These sensors are mainly used in non-destructive measurements
with very limited strain levels. As a consequence the resistive change is
also very limited in the order of less than 1 %.
A strain gage is a passive sensor and needs an external source of electricity
to function. As explained before, the Wheatstone bridge is the best choice
for this kind of sensor and in the following the Wheatstone bridge is taken
as example. It was shown that the temperature eÔ¨Äect in the Wheatstone
bridge can be minimised by using a thermally balanced branch with two

8.6. Measurement of Mechanical Dynamics
767
sensors with an opposite sign in the sensitivity. In Figure 8.45 it is shown
how this can be realised with strain gages by mounting the second strain
gage close to the Ô¨Årst strain gage on a location that either shows an opposite
strain like the reverse side of the bending beam or on the same side but
orthogonal to the Ô¨Årst strain gage where the poisson ratio of the material
will cause the surface to show an opposite strain.
The most optimal conÔ¨Åguration of a strain gage where both temperature
and source noise is minimised relative to the sensitivity is the full Wheat-
stone bridge with four strain gages. This can be realised on one monolithic
part when using the Poisson ratio eÔ¨Äect according to the conÔ¨Åguration of
Figure 8.46. Only 4 connections are needed to the measurement electronics.
This conÔ¨Åguration is frequently used in many force sensors (load-cells) and
is proven to be very reliable.
Table 8.1 shows several materials that are used in strain gages, each with
a diÔ¨Äerent strain sensitivity. While K for most metals ranges between 0.5
and 5 the piezoresistivity eÔ¨Äect in semiconductors gives a sensitivity that
far outweighs the simple straightforward eÔ¨Äect by the volumetric changes
of a material under stress like in metals. This eÔ¨Äect is due to the special
conduction mechanism in semiconductors with holes and electrons, which
is also inÔ¨Çuenced by strain resulting in gage factors of 100 or more. This
has enabled its use in fully integrated MEMS accelerometers, which are
frequently used in cameras and cell-phones for motion detection and sensing
of the gravitational forces of the earth in order to detect the orientation.
F
A
B
C
Figure 8.45: A force sensing bending beam with diÔ¨Äerent locations for the strain
gages. The gage at location A is elongated while the gages at locations
B and C are compressed when applying a force F in the downward
direction.

768
Chapter 8. Measurement in Mechatronic Systems
Vi+
Vb+
Vi-
Vb-
Z1
Z2
Z3
Z4
Figure 8.46: A full bridge strain gage consisting of 4 strain sensitive resistors.
With these materials the full bridge conÔ¨Åguration is even more necessary
because of the also inherent very large temperature sensitivity of Silicon.
Table 8.1: K factors of strain gage materials.
Material
K factor
Platinum-Iridium (Pt 95 %, Ir 5 %)
5.1
Platinum-Tungsten (Pt 92 %, W 8 %)
4.0
Isoelastic (Fe 55.5 %, Ni 36 % Cr 8 %, Mn 0.5 %)
3.6
Constantan / Advance / Copel (Ni 45 %, Cu 55 %)
2.1
Nichrome V (Ni 80 %, Cr 20 %)
2.1
Karma (Ni 74 %, Cr 20 %, Al 3 %, Fe 3 %)
2.0
Advance (Cu 54 %, Mn 1 %, Ni 44 %) 8
2.0
Armour D (Fe 70 %, Cr 20 %, Al 10 %)
2.0
Monel (Ni 67 %, Cu 33 %)
1.9
Manganin (Cu 84 %, Mn 12 %, Ni 4 %)
0.47
N or P type Silicon
120-175!

8.6. Measurement of Mechanical Dynamics
769
8.6.1.2
Fibre Bragg Grating Strain Measurement
The Ô¨Åbre Bragg grating principle is discovered by the British physicist
William Lawrence Bragg (1890 ‚Äì 1971) by research on X-ray diÔ¨Äraction at
crystalline materials, for which he won the Nobel prize. The observed eÔ¨Äect,
the reÔ¨Çection and refraction of certain wavelengths in non homogeneous
material, is closely related to the multiple Fabry-Perot interferometer eÔ¨Äect
of optical coatings as explained in Chapter 7.
An optical Ô¨Åbre Bragg grating is created inside a transparent optical Ô¨Åbre by
introducing small areas of approximately 3 mm with a periodic longitudinal
variation of the index of refraction. When the periodicity is constant, the
grating will cause a reÔ¨Çection of those light wavelengths ŒªB that Ô¨Åt in the
grating period d according to the expression d = nŒªB, where n is an integer
and in most applications equal to one.
The working principle is illustrated in Figure 8.47.
When light from wide-band light source is inserted in the Ô¨Åbre, only the light
B
 -B
Broadband 
light
d  n B
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
 
 
Wavelength [nm]
&¬õ
Transmission
Intensity (abs)
10
z)
10
z¬Ç
10
0
1570
,¬Å¬Ñ¬Ç
,¬Å¬Ñ)
1576
1578
Figure 8.47: A Ô¨Åbre Bragg grating is created inside an optical Ô¨Åbre by means of an
area with a longitudinal periodic variation of the index of refraction.
A standing wave will occur at a wavelength ŒªB of which an integer
number just Ô¨Åts inside the grating period d. The light corresponding
to that standing wave is reÔ¨Çected.
(Courtesy of Technobis Fibre Technologies)

770
Chapter 8. Measurement in Mechatronic Systems
Analiser
G1
G2
G3
Gn
1
2
3
n
Input pulse
Re¬õected pulses
t0
t1
t2
t3
tn
I
"¬ï$
1 2 3
1 2 3
¬ã"'&¬õ
0$¬ï$
Figure 8.48: A Ô¨Åbre Bragg grating can be used to measure strain at long distances
simultaneous at diÔ¨Äerent locations on the Ô¨Åbre, distinguished by the
wavelength. Also the temporal response of the diÔ¨Äerent reÔ¨Çections
gives information of the strain.
(Courtesy of Technobis Fibre Technologies)
with a wavelength equal to ŒªB will be reÔ¨Çected. An elongation of the Ô¨Åbre
will result in a change in the reÔ¨Çected frequency because of this relation,
which makes this frequency a measure for the strain of the Ô¨Åbre. By locating
the Ô¨Åbre on or inside a solid object, the strain can be determined at the
location of the grating.
In principle the grating can be located at a very long distance, but even more
interesting is the fact that more then one grating can be applied in one Ô¨Åbre,
as shown in Figure 8.48. With Wavelength Division Multiplexing (WDM) the
diÔ¨Äerent gratings are distinguished by giving them each a slightly diÔ¨Äerent
grating period as long as the spectral range of the frequencies that Ô¨Åt in
each grating period do not have an overlap.
With some real numbers this becomes more clear.
In practice a light emitting diode (LED) can be used as a light source. In this
example the LED has a wavelength of 850 nm and a spectral bandwidth of
50 nm. This bandwidth is divided in ten equal frequency ranges separated
with 5 nm spectral diÔ¨Äerence with the other areas. Rejecting the outer areas
with a lower irradiance results in practice in eight diÔ¨Äerent sensing areas
per Ô¨Åbre.
The grating period is ‚âà1 Œºm due to the average refractive index of the Ô¨Åbre
giving 3000 periods in the 3 mm measurement area.

8.6. Measurement of Mechanical Dynamics
771
The frequency spectrum is measured by means of a diÔ¨Äraction grating where
the wavelength determines the diÔ¨Äraction angle. The diÔ¨Äracted beam ex-
poses a CCD photo detector at a Ô¨Åxed distance from the grating and the
position of incidence of the diÔ¨Äracted light is measured. This system has a
maximum resolution of a wavelength change of one picometre, correspond-
ing to 1 Œºm per metre strain while the repeatability is better than three
micro-strain.
The electronics are so fast that the dynamic bandwidth equals 20 kHz with
a Ô¨Åxed latency of 50 Œºs.
Next to this spectral diÔ¨Äerence, the distance between the gratings can be
measured by determining the return time of the reÔ¨Çections by a pulsed light
source. This is called Time Division Multiplexing (TDM).
Like with almost all sensing methods also this principle suÔ¨Äers from temper-
ature as an interfering error source. The index of refraction of any material
is temperature dependent to a certain degree but it can be compensated
and even used by combining diÔ¨Äerent Ô¨Åbers with diÔ¨Äerent optical and ther-
mal properties and that enables to measure both temperature and strain
simultaneously.
With both WDM and TDM methods combined, large objects like the wings
of an airplane, the vanes of a windmill and the cables of a hanging bridge
can be measured, but also for measuring less large object this method oÔ¨Äers
ample possibilities.
8.6.2
Velocity Measurement
The measurement of velocity has long relied on the interaction of the mag-
netic Ô¨Åeld of a permanent magnet with a moving conductive element. Before
the onset of the electronic era the standard speedometer in cars and mo-
torbikes all worked according to the principle that a moving conductive
disk inside a magnetic Ô¨Åeld experiences a force that is proportional to the
velocity.
Presently still the majority of cars are equipped with speedometers with
needle pointers but they are no longer driven by moving disks in a magnetic
Ô¨Åeld but by a moving-coil Lorentz type rotating actuator, which is controlled
by electronics that receive the velocity information from diÔ¨Äerent sensors.
These sensors often consist of systems with an incremental character, re-
sulting in a frequency proportional to the velocity.
Incremental velocity sensors can be based on many principles. One exam-
ple is using a light source, a photo sensor and a wheel with holes, which

772
Chapter 8. Measurement in Mechatronic Systems
intermittently blocks the light as function of the angle.
Another example is a rotating permanent magnet, which induces an AC
voltage in a stationary coil with a frequency and amplitude that is propor-
tional to the speed according to the law of Faraday.
These principles will be presented more in depth in Section 8.7 with long
range optical encoders and this subsection will focus on the velocity sensing,
which is needed in feedback systems to control damping.
It is often not necessary to use separate velocity sensors in precision posi-
tioning systems for damping in a full state feedback conÔ¨Åguration. In most
cases damping is achieved with PD-control by diÔ¨Äerentiating the position
measurement signal as was explained in Chapter 4. In certain situations,
however, it is better to use a separate sensor, especially when the reference
for the damping action is undeÔ¨Åned. This is the case with active vibration
isolation systems like will be presented in Chapter 9. In those systems a
damper connected between the isolated part and the vibrating environment
introduces an increase in the transmissibility of the vibrations at higher
frequencies. By using an active control system with a low stiÔ¨Äness actuator
and a velocity sensor, damping can be created without an increase of the
transmissibility as long as the sensor measures the velocity relative to a
reference that is completely free from vibrations.
Such a quiet reference is realised with an inertial velocity sensor like the geo-
phone, which was originally designed to measure low-frequency vibrations
like earthquakes (Geo-phone = sound of earth).
8.6.2.1
Geophone
The operating principle of a geophone is shown in Figure 8.49. A moving
mass, also called seismic mass, consists of a coil in two sections, which is
supported inside a round ferromagnetic casing by means of a very compliant
spring membrane, resulting in a very low resonance frequency in the order
of 1 ‚Äì 10 Hz.
The coil moves inside a magnetic Ô¨Åeld that is created by a permanent magnet
inside the coil, connected to the casing. The magnetic Ô¨Åeld enters one of the
coil sections from the inside and returns via the casing through the other
section from the outside. The coil sections are wound in opposite directions
and as a result their induced voltage will have the same sign. When added,
the total voltage from the coil is proportional to the its relative velocity to
the stationary magnetic Ô¨Åeld, according to Faraday‚Äôs law.
A geophone is used to measure velocity vibrations of an object by mounting
it to the moving object. This means that the output voltage is determined by

8.6. Measurement of Mechanical Dynamics
773
Permanent
Magnet
Casing
Coils
=
Seismic 
mass
Membrane
N
S
Figure 8.49: A geophone has a moving coil system supported by a compliant mem-
brane around a permanent magnet, which induces a magnetic Ô¨Çux
through the coil. The movement of the coil will create an electromotive
force, proportional to the velocity of the movement.
(¬©Aaronia AG, www.aaronia.com)
the transfer function from the velocity of the casing to the velocity diÔ¨Äerence
between the casing and the coils as the latter is proportional to the voltage
of the sensor.
It can be reasoned that under static conditions, at a frequency below the
Ô¨Årst resonance frequency, the seismic mass of the coils will follow the casing
and no voltage will be induced. Above the resonance frequency the seismic
mass will decouple and its amplitude will rapidly drop resulting in a velocity
diÔ¨Äerence and a measurable voltage. With the standard motion equations,
the inÔ¨Çuence of the internal damping on this system can be determined.
This damping is caused by eddy-currents in the coil former, which often is
made from solid copper for increased mass and behaves like a short circuited
coil.
The relation between the velocity diÔ¨Äerence ŒîÀôx = Àôxc ‚àíÀôxm and the velocity of
the casing Àôxc is deÔ¨Åned by the following equation using the rigid body model
from Figure 8.50 and using the Fourier transform for the derivative terms
to obtain the frequency dependent behaviour:
ŒîÀôx
Àôxc
(t) = Àôxc ‚àíÀôxm
Àôxc
=
d
dt(xc ‚àíxm)
d
dt xc
‚áíŒîÀôx
Àôxc
(œâ) = jœâ(xc ‚àíxm)
jœâxc
= xc ‚àíxm
xc
.
(8.59)

774
Chapter 8. Measurement in Mechatronic Systems
k
c
Seismic mass mm
Case mc
m
x
cx
c
m
x
x
x
 
	



Figure 8.50: The dynamic model of a geophone as used for deriving the transfer
function.
With the second law of Newton the force balance on the moving mass mm
leads to the following relation in the frequency-domain:
‚àímmœâ2xm = jœâc(xc ‚àíxm)+ kxc ‚àíkxm = (jœâc + k)(xc ‚àíxm).
(8.60)
From the theory on transmissibility from Chapter 3 the transfer function be-
tween xc and xm is known and that leads to the following frequency response:
xm
xc
(s) =
cs+ k
mms2 + cs+ k ‚áíxm(œâ) = xc(œâ)
jœâc + k
‚àímmœâ2 + jœâc + k ,
(8.61)
which is used to replace xm(œâ) in Equation (8.60), resulting in :
mmœâ2xc

jœâc + k
mmœâ2 + jœâc + k =
(jœâc + k)(xc ‚àíxm),
(8.62)
leading with Equation (8.59)to the following frequency response from the
velocity of the casing to the measured relative velocity of the seismic mass
to the casing:
ŒîÀôx
Àôxc
(œâ) = Àôxc ‚àíÀôxm
Àôxc
= xc ‚àíxm
xc
=
‚àímmœâ2
‚àímms2 + jœâc + k =
mmœâ2
mms2 ‚àíjœâc ‚àík .
(8.63)
When the voltage sensitivity of the moving coil equals Vg = cg(Àôxc‚àíÀôxm), where
cg in Vs/m equals the sensitivity constant of the geophone, using Equa-
tion (8.59) the total frequency response becomes:
Vg
Àôxc
(œâ) = cg(Àôxc ‚àíÀôxm)
Àôxc
= cg
mmœâ2
mmœâ2 ‚àíjœâc ‚àík
Vs/m

.
(8.64)
This equation is a combination of the compliance response of a second-order

8.6. Measurement of Mechanical Dynamics
775
10
z¬É
10
z)
10
z¬Ç
10
0
10
¬Ç
Magnitude (abs)
10
z¬Ç
10
z,
10
0
10
1
10
¬Ç
0
)¬Å
90
,[¬Å
180
Phase [deg]
Frequency  [Hz]
c¬ä¬É
Ns m
/
c = 30  Ns m
/
Figure 8.51: The Bode plot of the frequency response of a geophone with a seismic
mass mm = 1 kg, a spring with a stiÔ¨Äness of k = 1 ¬∑ 102 N/m and two
values of the damping coeÔ¨Écient c = 6 Ns/m (green) and c = 30 Ns/m
(blue) shows the eÔ¨Äect of damping on phase and amplitude and the
low-frequency bandwidth limitation.
mass-spring system with a second-order diÔ¨Äerentiator, acting together as a
second-order high-pass Ô¨Ålter.
In this sensor the damping only inÔ¨Çuences the overshoot at the resonance
frequency and can be chosen such that the overshoot is zero without impact-
ing the high-frequency response as was the case with the transmissibility
response.
In Figure 8.51 a Bode plot of the frequency response of a typical geophone
with a moving mass mm = 1 [kg] and a spring with a stiÔ¨Äness of k = 1¬∑102
[N/m] is shown. The Ô¨Ågure indicates that the overshoot at the resonance
frequency is reduced with increasing damping but also the phase is changed.
Depending on the application, these two aspects can be optimised such that
a Ô¨Çat response above the resonance frequency is obtained with an acceptable
phase response.
It is clear from this example, that the values of the mass and stiÔ¨Äness be-
come impractical when the bandwidth is extended to even lower frequencies.
Under gravity conditions this spring would already need to elongate with

776
Chapter 8. Measurement in Mechatronic Systems
0.1 m to compensate the static gravity-force on the mass, which means that
a pre-stressed spring must be used.
This practical consideration limits the use of this geophone to a Ô¨Åxed orien-
tation in respect to the earth gravity as otherwise a very long coil would be
necessary, which would not be preferable because of the increased noise by
the increased resistance.
In practice the LF-bandwidth limitation can be compensated by a suitable
Ô¨Ålter with integrator characteristics to increase the LF-gain, but this is
limited because of the resulting ampliÔ¨Åcation of LF noise (drift).
The main beneÔ¨Åt of this geophone for the application in vibration isolation
systems is the reference of the velocity to the inertial reference of a seismic
mass as the inertial universe is by deÔ¨Ånition free from vibrations.
An alternative method to obtain this inertial velocity signal is based on
using a sensor that even more directly refers to this inert reference by mea-
suring acceleration. The velocity can then be derived by integration of the
acceleration signal.
8.6.3
Accelerometers
Measurement of acceleration is in principle achieved by measuring force.
The relation between acceleration and force is given by the well-known
second law of Newton:
F = m dv
dt = m Àôv = ma
[N].
(8.65)
By using the force as an intermediate term, the acceleration is related
to the distortion of the spring, which creates the possibility to measure
acceleration by using a combination of a seismic mass with a deforming
support.
Three types of acceleration sensors or accelerometers will be presented
based on this principle.
‚Ä¢ The closed loop feedback accelerometer.
‚Ä¢ The piezoelectric accelerometer.
‚Ä¢ The MEMS accelerometer.
8.6.3.1
Closed-Loop Feedback Accelerometer
A very accurate way to measure a force is by nulling, compensating that
force with the same force by means of an actuator, feedback controlled with a

8.6. Measurement of Mechanical Dynamics
777
sensor that measures the deviation of a zero strain value. When the force to
current ratio of that actuator is known, the current that is necessary for the
compensating force is a reliable measure for this force. In Figure 8.52 this
principle is used in the closed-loop feedback accelerometer. It is build with the
same components as the geophone with the addition of a position sensor and
a control system. In this conÔ¨Åguration the coils function as a linear Lorentz
actuator instead of a sensing element. The position sensor measures the
position of the moving coils relative to the casing. This position sensor can
be any reliable proximity detector as previously presented. The controller
and the ampliÔ¨Åer are tuned to keep the displacement as small as possible
by supplying a current to the coils. This position feedback system creates
an additional stiÔ¨Äness by the proportional gain. The necessary current for
that action is proportional to the force on the mass due to the acceleration.
By measuring the current, a value is obtained for the acceleration
In Chapter 4 it was shown how such a position controller should be made in
order to remain stable by placing the poles of the system on the right location
in the complex plane with an additional D-control action. The system is a
servo-feedback system as the controller has to control the seismic mass to
follow the case just like with the optical pick-up unit of the CD player and
the same PID-control principle can be used here.
The position sensor inside the accelerometer only needs to be accurate
around zero, because of the fact that this servo controlled accelerometer is
a zeroing measurement system. This implies that a relatively simple sensor
can be used with only a low level of the signal drift around zero when static
Permanent
Magnet
Controller
Vs
+
_
I
Ampli%er
Posion
sensor
Seismic 
mass
R
N
S
Figure 8.52: Closed loop feedback accelerometer. The controller suppresses the
movement of the seismic mass relative to the casing with a current
proportional to the acceleration.

778
Chapter 8. Measurement in Mechatronic Systems
accelerations over a longer period must be measured. A second beneÔ¨Åt of
this conÔ¨Åguration is the additional virtual control-stiÔ¨Äness of the spring
due to the feedback, which reduces the inÔ¨Çuence of any non-linearity in the
stiÔ¨Äness of the support structure in the frequency area where the closed-loop
gain is high.
The feedback principle with a high gain at low frequencies makes this
closed-loop feedback accelerometer especially suitable for the measurement
of static or low-frequency accelerations like gravity and the slow motion of
ships or air planes.
It is also a suitable option for low-frequency damping in vibration isolation
systems when the sensor is combined with an integrator to obtain the
inertial velocity. The complete sensor is however quite costly when compared
to the two other accelerometers so the application of a closed-loop feedback
accelerometer is limited to professional use at very low frequencies.
8.6.3.2
Piezoelectric Accelerometer
In Section 5.5 of Chapter 5 the direct piezoelectric eÔ¨Äect was explained.
The internal charge distribution of a piezoelectric material will displace
when deformed because of a special crystal structure with atoms that are
constrained in the lattice. The charge displacement manifests itself as a
voltage on the electrodes of the material. Depending on the crystal orienta-
tion and the polarisation direction, the material is sensitive for shear strain
or compressive strain and both principles are used.
Figure 8.53 shows three diÔ¨Äerent conÔ¨Ågurations of a piezoelectric accelerom-
eter. The shear design is built with the seismic mass around the piezoelec-
tric crystal. Similar to the shown example with one piezoelectric element
also other versions exist of this principle with for instance an assembly
of three Ô¨Çat piezoelectric plates in a triangular conÔ¨Åguration. The main
beneÔ¨Åt of this conÔ¨Åguration is its low sensitivity for residual strain in the
base, which can be caused by the mechanical mounting and by thermal
induced deformations. The rotational symmetric conÔ¨Åguration reduces also
the sensitivity for accelerations in other directions. The drawback of the
shear design is a more complicated assembly process, especially when a
very small conical angle is needed. In assembly, excessive stress must be
avoided, which requires careful handling. The compression design is
quite straightforward. The seismic mass is pressed onto a Ô¨Çat piezoelectric
ring with a bolt of which the force is controlled by a Ô¨Çexible washer. The
compression design is more sensitive for thermal transients, base strain
and accelerations in shear directions. The bending design uses a special

8.6. Measurement of Mechanical Dynamics
779
Shear force
Cover
Socket
Piezo ceramics
Post
Base
Seismic mass
Compression Design:
Compression force
Cover
Piezo ceramics
Base
Socket
Seismic mass
Spring
Bolt
Bending Design:
Bending force
Cover
Fricon coupling
Piezo ceramics
Seismic mass
and damping piston
Base
Spring
Shear Design:
Figure 8.53: Three diÔ¨Äerent mechanical designs of piezoelectric accelerometers.
The shear design is the most modern version with better dynamic
performance.
(Courtesy of ‚ÄúMetra Mess- und Frequenztechnik Radebeul‚Äù)

780
Chapter 8. Measurement in Mechatronic Systems
piezoelectric composition that consists of two layers, called a bimorph. A
bending force from the seismic mass will create compressive strain in one
layer and stretching strain in the other layer. Both layers are polarised in
the opposite direction. As a result the voltages of both layers add together to
one voltage between the two Ô¨Çat sides of the bimorph. The main advantage
of this principle is its high sensitivity-to-mass ratio. Its main drawback is
its relatively low resonance frequency, which limits the application to low
frequencies, as will become clear in the following section.
Mechanical Frequency Limitation
Mechanically a piezoelectric accelerometer behaves like a mass-spring sys-
tem with a resonance frequency, which is determined by the seismic mass
and the stiÔ¨Äness of the piezoelectric crystal. The transfer function can be
derived with the help of Figure 8.54. The voltage Va of the accelerometer is
proportional to the displacement Œîx of the seismic mass, which is caused by
the acceleration a = ¬®xc of the case.
Va
¬®xc
(s) = cv = cd(xc ‚àíxm)
¬®xc
= cd(xc ‚àíxm)
s2xc
6
Vs2/m
7
.
(8.66)
where cv in Vs2/m equals the nominal voltage sensitivity of the accelerometer
and cd in V/m equals the voltage sensitivity of the piezoelectric crystal as
function for its deformation. These values are directly related to Equa-
tion (5.125) of Section 5.5 on piezoelectric actuators, which gives the charge
of a piezoelectric material as function of an externally applied force. With
the capacitance of the sensor the charge corresponds to a voltage.
Equation (8.66) is equal to Equation (8.64) of the geophone, divided by
s2. This means that the mechanical transfer function of a piezoelectric
k
c
Seismic mass mm
x
Case mc
m
x
cx
c
m
x
x
x   

	

c
Piezo

Figure 8.54: The mechanical dynamic model of a piezoelectric accelerometer as
used for deriving the transfer function. The voltage is proportional to
the deformation Œîx of the piezoelectric sensing element and relates to
the acceleration ¬®xc of the case.

8.6. Measurement of Mechanical Dynamics
781
accelerometer can be directly derived from that equation:
Va
¬®xc
(s) = cv(s) = cd(xc ‚àíxm)
s2xc
=
cdmm
mms2 + cs+ k =
cd
mm
k
mm
k s2 + c
k s+1
6
Vs2/m
7
. (8.67)
For low frequencies where s is very small the voltage sensitivity equals:
cv(s) = cd
mm
k
6
Vs2/m
7
.
(8.68)
The transfer function of Equation (8.67) is similar to the compliance re-
sponse of a mass-spring system. Below the resonance frequency the output
voltage is frequency independent. Around and above the resonance fre-
quency the transfer function deviates from the constant value depending on
the damping. In practice the damping is quite low, which means that these
mechanical dynamics limit the high-frequency bandwidth of a piezoelectric
accelerometer to around 0.3√ó the resonance frequency. For the shear and
compression design the support stiÔ¨Äness is rather high, giving practical
values for the usable maximum frequency of several kHz, depending in the
size. The bending design is more compliant. With the same size and mass
as with the other design principles the application of the bending design is
limited to high-sensitive low-frequency measurements until an approximate
maximum of a few hundred Hertz.
For situations where only a very low mass is allowed at the measurement
location, the bending design can still be a better alternative because with a
very small size the resonance frequency can become acceptably high again.
Electrical Frequency Limitation
Electrically a piezoelectric accelerometer behaves like a capacitor with a
variable charge, which is determined by the acceleration ¬®xc. The change
of charge is equivalent to a current, which means that the sensor can be
modelled according to Norton as a current source with a parallel capacitor
as shown in Figure 8.55. Unfortunately the current IN is determined both
by the acceleration amplitude and by the frequency. This is explained as
follows: The location of the charge is determined by the force, which is
proportional to the acceleration. Only a change in the charge location will
cause a current. This means that only a changing acceleration will cause
the force, deformation and charge location to change with a corresponding
current.
With ci being the charge sensitivity for acceleration, also derived by applying

782
Chapter 8. Measurement in Mechatronic Systems
C
Seismic mass mm
Case mc
Piezo
Va
VTh
C
Seismic mass mm
Case mc
Piezo
Va
IN
Norton
Thevenin
+
_
Figure 8.55: The electrical model of a piezoelectric accelerometer is basically a
capacitor with a variable charge. This corresponds to the Norton
equivalent model where the charge equals the integral of the frequency
dependent current IN over time. The Thevenin equivalent model
is more practical to use because the voltage VTh is not frequency
dependent.
Equation (5.125) of Section 5.5 on piezoelectric actuators, the Norton source
current IN becomes:
IN = dQ
dt = ci
d¬®xc
dt = cis ¬®xc = ci jœâ¬®xc
[A].
(8.69)
This means that the Norton model is less practical due to this frequency
dependence. The Thevenin equivalent voltage source VTh can be derived
from the Norton equivalent by taking the voltage of the sensor when no
other load is applied than the internal capacitance:
VTh = INZ = ci jœâ¬®xc
jœâC
= ci ¬®xc
C
= cv ¬®xc
[V].
(8.70)
This is a frequency independent voltage and can be detected by a non-
inverting ampliÔ¨Åer. This ampliÔ¨Åer would need to have a very high input
impedance because the source impedance is capacitive. The high output
voltage of a piezoelectric accelerometer allows the application of a unity-gain
buÔ¨Äer ampliÔ¨Åer as signal conditioning element when the capacitive nature
of the sensor would be the only problem.
Charge AmpliÔ¨Åer
A simple non-inverting buÔ¨Äer ampliÔ¨Åer does not solve all problems as is
indicated by the example of Figure 8.56 with some realistic values of the
components. When the sensor is connected to an ampliÔ¨Åer, a well shielded
coaxial cable is necessary to prevent external interference. This cable will

8.6. Measurement of Mechanical Dynamics
783
have a parasitic capacitance, which acts as a load to the sensor and gives a
proportional reduction of the sensitivity, depending on the ratio between
the cable capacitance and the sensor capacitance. Although this is a not
frequency dependent attenuation, these values should be exactly known in
order to take this attenuation into account with accurate measurements.
This is only possible up to a certain level due to the temperature dependence
of these values.
Another problem is related to a possible parasitic resistance over the connec-
tor, which might be caused by humidity in combination with salt residues
due to manual handling.
Together with the input impedance of the ampliÔ¨Åer and the capacitive source
impedance of the sensor this circuit forms a Ô¨Årst-order high-pass Ô¨Ålter. When
for this example the input resistance Ri equals 50 MŒ©, this low-frequency
limit would be:
fLP = œâLP
2œÄ =
1
2œÄRC =
1
2œÄ¬∑5¬∑107 ¬∑1.1¬∑10‚àí9 ‚âà3
[Hz],
(8.71)
because the total capacitance equals the impedance of the 1 nF and 100 pF
capacitor in parallel.
A second problem is caused by the inherent non-linearity of a piezoelectric
crystal.
As was shown with piezoelectric actuators these crystals exhibit a certain
level of hysteresis between the voltage and the deformation. Fortunately
this hysteresis is far less present in the relation between the charge and the
deformation as the hysteresis is caused by the capacitance. This means that
an optimal way to detect the signal of a piezoelectric accelerometer would
be to directly determine the charge. This can be achieved by ‚Äútapping‚Äù the
Sensor
Vo
+
_
100pF
Ri
` 
ampli%er
Cable
Va
+
_
VTh
1nF
Rp
Figure 8.56: The parasitic capacitance and resistance of a cable and the input
resistance of a buÔ¨Äer ampliÔ¨Åer aÔ¨Äect the sensitivity and frequency
response of a piezoelectric sensor.

784
Chapter 8. Measurement in Mechatronic Systems
G
100 M
+
Vo
+
_
_
10nF
+
_
VTh
100pF
1nF
Rp
Figure 8.57: A piezoelectric accelerometer with a charge ampliÔ¨Åer as signal con-
ditioning element. The charge ampliÔ¨Åer reduces the inÔ¨Çuence of the
cable capacitance and other parasitic impedances by virtually ground-
ing the output of the sensor.
current from the charge displacement by means of the charge ampliÔ¨Åer of
Figure 8.57, before it can cause a change in the voltage. This solution is
especially useful because the charge ampliÔ¨Åer also solves the Ô¨Årst problem
of the sensitivity for the cable capacitance and the parasitic resistance.
A charge ampliÔ¨Åer is an operational ampliÔ¨Åer in an inverting ampliÔ¨Åer
conÔ¨Åguration with only a feedback impedance, which is mainly determined
by a capacitor. The sensor is directly connected to the inverting input of the
operational ampliÔ¨Åer.
For the explanation of the principle Ô¨Årst the eÔ¨Äect of the very large 100
MŒ© feedback resistor can be neglected. The feedback capacitor for this
example has a value of 10 nF. The rules of an operational ampliÔ¨Åer from
Chapter 6 are used to determine the gain of the inverting ampliÔ¨Åer. The
input impedance Z1 is equal to the source impedance of the sensor with a
capacitor value of 1 nF and the feedback impedance Z2 equals the impedance
of the 10 nF capacitor, which was chosen for this example. The frequency
response of this ampliÔ¨Åer can now be written as follows:
G = V0
VTh
(œâ) = ‚àíZ2
Z1
= ‚àí
1
jœâ¬∑10‚àí8
1
jœâ¬∑10‚àí9
= ‚àí0.1.
(8.72)
While the minus sign implies a phase inversion, the number itself does not
look impressive from a magnitude point of view. Nevertheless it is clear that
the eÔ¨Äect of the parasitic impedances is cancelled, because the ampliÔ¨Åer will

8.6. Measurement of Mechanical Dynamics
785
10
z)
10
z¬Ç
10
0
10
¬Ç
Magnitude (abs)
10
z¬Ç
10
z,
10
0
10
1
10
¬Ç
10
3
10
)
10
5
z,¬Ü{
z¬Ö{
0
¬Ö{
Phase [deg]
Frequency  [Hz]
¬ö$`%
]$%
z,¬Ü{
z¬Ç¬Ñ{
z¬Ö{
z[¬É{
Figure 8.58: Typical bode-plot of a piezoelectric accelerometer with a seismic mass
of 20¬∑10‚àí3 kg and a support stiÔ¨Äness of 1¬∑107 N/m showing both the HF
bandwidth limitation by the mechanics and the LF limitation by the
electronics. The amplitude plot is normalised to a value of one in the
pass-band, the response of the blue line corresponds to a non-inverting
buÔ¨Äer ampliÔ¨Åer and the green line with the charge ampliÔ¨Åer. Note
the diÔ¨Äerent phase scale (in green) of the charge ampliÔ¨Åer, because of
the minus sign in Equation (8.72).
keep the voltage at the minus input equal to 0 V, being the voltage at the
grounded positive input. This means that the sensor is virtually grounded
and no voltage is present over the parasitic impedances, while all current of
the sensor Ô¨Çows into the feedback impedance.
As this impedance is merely capacitive the voltage at the output is equal to
the stored charge in the feedback capacitor, divided by its capacitance value.
This charge is equal to the displaced charge of the piezoelectric accelerometer
for which reason this conÔ¨Åguration is called a charge ampliÔ¨Åer. This might
seem strange as the charge itself is not ampliÔ¨Åed and a ‚Äúcharge-to-voltage
converter‚Äù would probably have been a better name.
The reduction of the voltage gain to 0.1 is the direct result of a design
choice, which is related to the maximum attainable value of the parallel
resistor over the feedback capacitor. In theory this resistor is not needed but
the bias current of the operational ampliÔ¨Åer requires a non-inÔ¨Ånite source
impedance at 0 Hz. The bias current level determines the maximum value

786
Chapter 8. Measurement in Mechatronic Systems
of the parallel resistor together with the allowable DC oÔ¨Äset error voltage at
the output. Special ampliÔ¨Åers with MOSFET inputs are developed to achieve
extremely low bias currents in the order of 1 pA, which would give a DC error
of 0.1 mV with the indicated 100 MŒ© resistor. Compared with the voltage
ampliÔ¨Åer situation parasitic impedances parallel to this resistor can more
easily be avoided by careful assembly of the circuit, avoiding contamination
in handling and when necessary, even a protective coating can be applied,
to keep humidity away from the sensitive input of the ampliÔ¨Åer. In this case
the low-frequency limitation of the bandwidth is only determined by the
feedback impedances resulting in the following:
fLP = œâLP
2œÄ =
1
2œÄRC =
1
2œÄ¬∑1¬∑108 ¬∑10¬∑10‚àí9 ‚âà0.16
[Hz].
(8.73)
This is a factor 20 better than with the buÔ¨Äer ampliÔ¨Åer. The sacriÔ¨Åce of
the attenuation is easily solved by an additional voltage ampliÔ¨Åer after the
charge ampliÔ¨Åer. Furthermore, High-frequency voltage noise is no problem
because of the capacitive feedback of the charge ampliÔ¨Åer. The inherent low
impedance for high frequencies results in a low gain for this kind of noise.
In Figure 8.58 a typical Bode plot of a piezoelectric accelerometer with the
two types of signal conditioning ampliÔ¨Åers is shown for comparison reasons.
The data correspond to the examples of Figure 8.56 and Figure 8.57. The
mechanical data of the corresponding sensor are a seismic mass of 20¬∑10‚àí3
kg and a support stiÔ¨Äness of 1¬∑107 N/m giving a resonance frequency of ap-
proximately 3.5 kHz. When using a charge ampliÔ¨Åer, the maximum usable
bandwidth of this example ranges from ‚âà0.2 ‚Äì 1000 Hz.
The piezoelectric accelerometer is used in situations where vibrations in
speciÔ¨Åc frequency bands are investigated like in the dynamic modal analysis
of mechanical structures, taking into account the inherent limitation of the
bandwidth on both the HF and the LF side.
It is a frequently applied instrument in determining improvements in me-
chanics used in precision positioning systems like stages in wafer scanners.
An additional beneÔ¨Åt over other accelerometers is the very large dynamic
range, which is also due to the low HF noise level originating from its
capacitive nature. The only noise, which still can cause problems, is low-
frequency excess noise as that will be ampliÔ¨Åed by the feedback capacitor.
Together with the low-frequency limitation of the sensing principle itself,
this low-frequency noise is one of the problems when using this accelerator
as velocity detector with an additional integration.

8.6. Measurement of Mechanical Dynamics
787
8.6.3.3
MEMS Accelerometer
Micro Electro-Mechanical Systems or MEMS are based on the application
of semiconductor production technology in the realisation of miniature me-
chanical designs.
By using materials like Silicon and Germanium, which not only have very
special electrical properties but also superior mechanical properties due to
their mono crystalline structure, dynamic systems with for instance a very
high Q (resonators and actuators) and an excellent linearity and sensitivity
(sensors) can be realised. The possibility to directly integrate the signal con-
ditioning electronics with the sensor itself on the same material guarantee
a relatively low sensitivity for external magnetic and electrostatic Ô¨Åelds.
For measuring purposes, the MEMS accelerometer, of which a very basic
principle is shown in Figure 8.59, might be the most widely used MEMS
device ever. It is applied in safety devices like the air bag for a car, in photo-
graphic cameras and Personal Digital Assistants (PDAs) to determine the
orientation towards gravity.
Like with the other accelerometers, the MEMS accelerometer applies a
seismic mass, which is supported by a compliant mechanism, consisting of
several Ô¨Çexure leaf springs. The position of the mass can be measured both
with capacitive sensors and with integrated piezoresistive strain gages on
the supporting springs. The capacitive sensing principle is frequently used
in MEMS devices because of the simplicity. With comb structures the capac-
itance sensitivity can be increased and manufacturing these structures is
relatively easy. With capacitive sensing linear accelerations can be detected
in three orthogonal directions.
Measuring strain with integrated piezoresistive strain gages is an alterna-
Strain gage
Seismic mass
Leaf spring
Cutout
Figure 8.59: MEMS accelerometer, which consists of a seismic mass supported by
4 leaf springs provided with semiconductor strain gages. In spite of
the low mass this sensor has a very high sensitivity from 0Hz up till
very high frequencies. (Courtesy of Fredric Creemer, DIMES,TUD).

788
Chapter 8. Measurement in Mechatronic Systems
+
_
_
+
_
_
+
+
Figure 8.60: Vibrations in multiple directions can be measured with a MEMS
accelerometer by using two strain gages per Ô¨Çexure.
tive, which requires a bit more processing but it gives a very high sensitivity
and enables to sense even in six directions including rotational accelerations.
The principle is shown in Figure 8.60.
A representative example of a MEMS accelerometer is the ADXL345 from
Analog Devices of which the functional diagram is shown in Figure 8.61.
This fully integrated sensor works with the capacitive sensing principle
and can measure accelerations in 3 directions to a maximum acceleration
of 160 m/s2 with a resolution of 0.04 m/s2, a non-linearity of 1 % of the full
scale, an oÔ¨Äset of less than 1 m/s2 and a maximum 13 bit wide data-rate
of 3.2 kHz. It is to be expected that these accuracy and noise levels will
continuously improve over time, which means that MEMS accelerometers
will ultimately replace most other acceleration sensors because of their
versatility, reliability, frequency range and low cost.
3-Axis
  Sensor
Sense
   Electronics
     Digital
Filter
ADXL345
Power
Management
Control 
    and
 Interrupt
Logic
Serial I/O
INT1
VS
DD I/O
INT2
SDA/SDI/SDIO
SDO/ALT
Address
SCL/SCLK
GND
ADC
 32 Level
FIFO
CS
 
Figure 8.61: Functional diagram of the three directional MEMS accelerometer
ADXL345 showing the full integration of the sensor, the signal condi-
tioning and signal processing part, which directly outputs the digital
measurement data.
(Courtesy of Analog Devices).

8.7. Optical Long-Range Incremental Position Sensors
789
8.7
Optical Long-Range Incremental Position
Sensors
Analogue measurement of distances over a long range is limited by the
signal to noise ratio of the applied sensor. Noise limits the useful resolution
to a value that is relative to the range, which means that a long range suÔ¨Äers
from a limited resolution. For that reason long distances have always been
measured in an incremental way for instance by counting the number of
revolutions of a wheel or the number of stripes that were passed on a scale.
In the age of electronics, incremental counting is not done anymore with
rotating numbered disks interconnected by gear wheels but with digital
logical circuits and microprocessors. When applying electronics, the only
way to realise a long range high resolution position measurement system, is
to provide a reliable signal with a suÔ¨Éciently Ô¨Åne spaced spatial frequency.
This signal can be generated in diÔ¨Äerent ways. Take for example Figure 8.62
with a permanent magnet inside a coil, which will give a sinusoidal voltage
as a function of the velocity and the angle of a toothed wheel, which creates
an alternating reluctance path for the magnetic Ô¨Åeld. This sinusoidal signal
can be converted into a one bit periodic signal by means of a Schmitt trigger
before counting the pulses. This principle however only works at a certain
velocity, as at stand still no variable reluctance nor Ô¨Çux is observed. This
,

Vc
Vc
Figure 8.62: Incremental inductive rotation sensor giving a sinusoidal output volt-
age with a frequency depending on the rotation speed and the number
of teeth.

790
Chapter 8. Measurement in Mechatronic Systems


I
lamp
r

Figure 8.63: Optical version of the incremental rotation sensor. The magnitude
of the irradiance Ir from the lamp is modulated by the teeth of the
rotating wheel.
can be solved by using light instead of magnetism, as shown in Figure 8.63.
By just using a suÔ¨Éciently small lamp and a detector at the opposite sides
of the rotating disk the detector will receive an alternating irradiance signal
as function of the angle of rotation. This principle is reÔ¨Åned in the optical
encoders of the next section while the generation of an incremental signal
by interference is used in the laser interferometers of the last section of this
chapter. Both principles have presently achieved such high standards of
measurement, that they even can compete in resolution with many short
range analogue sensors while still maintaining long measurement ranges.
8.7.1
Linear Optical Encoders
Optical encoders are widely applied both for angular and linear measure-
ments. This section will restrict to the linear versions, because in precision
mechatronic systems direct linear measurements are most commonly ap-
plied. Nevertheless, the same principles are applied in angular measure-
ment systems.
The most basic example of a linear optical encoder is shown in Figure 8.649.
The working principle is originally based on the idea to compare the position
9This Ô¨Ågure, together with several of the other Ô¨Ågures and the background information in
this section on optical encoders is gracefully provided by Heidenhain, a leading company in
high precision optical encoders.

8.7. Optical Long-Range Incremental Position Sensors
791
Collimator lens
Scale
Photo detector
Reference mark
($¬é$
¬à$
Scanning

Current
level
I
Grang Period
‚ÄòDark‚Äô Current
osion
#%$
Figure 8.64: Basic conÔ¨Åguration of a linear optical encoder. A scanning reticle with
a grating is illuminated with parallel rays of light. The shadow of the
reticle is projected on a scale with an equal grating period connected
to the moving object. A photo detector detects the resulting irradiance,
which alters periodically as function of the displacement.
of one grating with well deÔ¨Åned equidistant slits with the position of another
grating by means of shadow projection.
A parallel beam of light, originating from a light emitting diode and a colli-
mator lens, is projected on the Ô¨Årst grating. The shadow of this grating is
projected on the second grating, which has equal periodicity and is designed
such that it obscures the light when shifted with half a period in respect
to the Ô¨Årst grating while transmitting the light when the gratings are in
phase. This causes the irradiance to be modulated as function of the position

792
Chapter 8. Measurement in Mechatronic Systems
Collimator lens
Reference mark
F%
photetector
Scale

¬à$
($¬é$
#$
Figure 8.65: Four Ô¨Åeld incremental optical encoder giving robustness, directional
and absolute position information with high resolution by interpola-
tion.
with an essentially triangular spatial waveform. As will be explained later,
a more sinusoidal spatial waveform is preferred. This can be created by
spatial low-pass Ô¨Åltering of the triangular waveform. In Chapter 7 the eÔ¨Äect
of low resolution imaging optics was presented to be equivalent to low-pass
spatial Ô¨Åltering. A shadow is only sharp under two conditions. Firstly the
light must be created by a point source. Secondly the details need to be
large relative to the wavelength of the light in order to prevent diÔ¨Äraction
eÔ¨Äects. With a larger surface of the light source a small grating period
pattern becomes blurred, resulting in a more sinusoidal spatial waveform.
With high resolution encoders this diÔ¨Äraction character determines the
functionality, but for simple encoders this is only a side eÔ¨Äect.
One typical property of incremental measurement systems is the relative
character of the data. At a certain known position the counter is set to zero
and, as long as all periods are counted during movement, the new position
is determined relative to the zero position. In case periods are lost due to
noise, the absolute position has to be traced back again to reset the counter.
Several possibilities to create such an absolute position reference are applied
in linear encoders. All options are based on an additional separate reference
mark, which is simultaneously exposed and can range from one simple set of

8.7. Optical Long-Range Incremental Position Sensors
793
1
2
3
4
1
2
3
4
1
4
Measuring 
scale
Scanning
recle
Reference
mark
A
B
C
D
A
B
C
D
Figure 8.66: Sensor signals in the four Ô¨Åeld encoder as function of the relative posi-
tion of the scales. At the left side the four positions of the measuring
scale are shown relative to the scanning reticle, corresponding to the
numbered vertical lines in the signal plot at the right side.
slits to a binary coded pattern, which is read out by a CCD camera. As long
as a transition of the reference mark uniquely points into a speciÔ¨Åc period
of the incremental encoder signal, the absolute position can be deduced by
setting the incremental counter accordingly.
The single Ô¨Åeld encoder has several problems, which need to be addressed.
First of all it is impossible to determine the direction of movement. Further-
more, the inÔ¨Çuence of electrical noise (dark current) and contamination of
the gratings becomes large at the low signal level positions.
Figure 8.65 shows an enhanced version of this principle, which solves these
issues by the following measures:
‚Ä¢ Redundancy by using two sections per phase for the same information
but working in counter phase to have high signal levels at all positions.
‚Ä¢ Two pairs of segments shifted 90¬∞in spatial phase to give directional
information by means of quadrature detection.

794
Chapter 8. Measurement in Mechatronic Systems
0¬∞
90¬∞
180¬∞
270¬∞
360¬∞
0
90
arctan  I
I




I0¬∞
I90¬∞

I0¬∞
I90¬∞
Figure 8.67: Interpolation with two sine functions at 90¬∞phase shift shown graphi-
cally by means of a Lissajous Ô¨Ågure. The angle œï is proportional to the
position within one cycle and can be calculated from both coordinate
values.
The beneÔ¨Åcial eÔ¨Äect of the redundancy is obvious. To better explain the
eÔ¨Äect of the phase shifted sections, Figure 8.66 shows the signal levels of the
diÔ¨Äerent Ô¨Åelds, corresponding to the four positions where one of the Ô¨Åelds
is at its maximum irradiance level. It is shown that signal A will decrease
while signal C has a positive sign when moving to the right from position 1
to position 2. A decrease of A with a negative sign of C (or more reliably a
positive sign of D) corresponds to a movement from 3 to 2, which is in the
left direction. Quadrature detection gives reliable direction information, but
the total system can even be further improved by a vectorial combination of
all signals.
8.7.1.1
Interpolation
In principle the value of the position can be determined by digitising the
current value of the Ô¨Åeld sensor by means of a comparator but then the
resolution would not be better than one grating period.
The spatial sinusoidal character of the signal creates the possibility to make
a reliable estimation of the intermediate positions. This estimation process
is called interpolation and its principle is shown in Figure 8.67.
From the signals of the four Ô¨Åeld encoder two signals are created, one signal
is the diÔ¨Äerence of A and B and the other is the diÔ¨Äerence from C and
D. These signals can be plotted in a four quadrant vectorial representa-

8.7. Optical Long-Range Incremental Position Sensors
795
Interpolaon error 
Signal deviaon
O`set I90
O`set I0
Amplitude error 
I0 / I90
Phase angle
error
Signal wave 
error
Lissajous 
%gure
o
o
o
o
Figure 8.68: Deviations of the signals in their shape, magnitude and average value
cause errors in the interpolation.
tion, called a Lissajous plot after the French mathematician Jules Antoine
Lissajous (1822 ‚Äì 1880). The phase angle œï appears to be equal to:
œï = arctan I90¬∞
I0¬∞
[¬∞].
(8.74)
where I0¬∞ equals the combined signal current of the sensor parts with their
extreme values at 0‚ó¶+ n¬∑180‚ó¶while I90¬∞ equals the combined signal current
of the sensor parts with their extreme values at 90‚ó¶+ n¬∑180‚ó¶.
Originally this calculation was done in the analogue domain by electronic
addition of both signals with diÔ¨Äerent ampliÔ¨Åcation ratios, followed by a
comparator. Nowadays the interpolation is far more easily achieved in the
digital domain by using high resolution AD converters for digitising the
signals followed by a direct calculation of the angle.
Under the condition of a fairly well deÔ¨Åned sinusoidal shape of the signal
an interpolation factor of 1024 until 4096 can be achieved.
Figure 8.68 shows a qualitative overview of the errors that are caused by
deviations from the ideal waveforms. A low interpolation error can only be
achieved by means of careful mounting and positioning of all the optical
parts in the measurement system.

796
Chapter 8. Measurement in Mechatronic Systems
8.7.1.2
Vernier Resolution Enhancement
The previously described conÔ¨Ågurations have two important drawbacks. The
Ô¨Årst is the need for a transparent scale, which requires mounting space of
the sensor parts at both sides while complicating the connection with the
moving object. The second drawback is the need for multiple sensor Ô¨Åelds to
realise both robustness and directional information. The Ô¨Årst issue can be
solved quite simply by using the reÔ¨Çective grating as shown in Figure 8.69.
The conÔ¨Åguration looks quite similar to the one Ô¨Åeld transparent grating and
adds the beneÔ¨Åt of the integration of the illumination and sensor part. This
principle can be used with thin metal reÔ¨Çective scales, which can be glued
to the moving object. The inherent problem of the one Ô¨Åeld sensor regarding
failing directional information and lack of ruggedness to contamination has
been solved in a diÔ¨Äerent way. By using two scales with a slightly diÔ¨Äerent
period a Vernier eÔ¨Äect occurs, named after the French mathematician Pierre
Vernier (1580 ‚Äì 1637) who invented the principle. Like with a Vernier
Condenser lens
Structured
photo detector
Window
Scale
Scanning

¬à$
($¬é$
Figure 8.69: The same properties can be obtained with a reÔ¨Çective scale as with a
transparent scale. This alternative allows to use a very long Ô¨Çexible
metal band scale, which can be glued to the moving object. Directional
information is obtained at the photo detector by a slight diÔ¨Äerence in
periodicity of the gratings, causing a Vernier eÔ¨Äect.

8.7. Optical Long-Range Incremental Position Sensors
797
Vernierperiod ( 800 Œºm)
0
90
270
180
0
90
270
180
0
90
270
180
Recle2: 41 Lines in 0.8 mm
Recle1:  40 Lines in 0.8 mm
Two posions shied half a grang period
Mulple vernier periods 
o
o
o
o
o
o
o
o
o
o
o
o
Figure 8.70: Using Vernier gratings to obtain both directional and interpolation
information with a one Ô¨Åeld CCD camera sensor.
calliper, this eÔ¨Äect increases the position sensitivity and by reading out
the signal with a structured photo detector like a CCD camera sensor, both
directional and interpolation data are obtained.
The Vernier eÔ¨Äect is illustrated in Figure 8.70. The upper half of the Ô¨Ågure
shows the eÔ¨Äect of two gratings that diÔ¨Äer one line over the total width of
the grating of 40 lines. The corresponding Vernier ratio is 40 with a Vernier
period that equals the shown size of the grating. The upper right image
shows the visual eÔ¨Äect when the two gratings are on top of each other in
two situations that diÔ¨Äer in a relative shift with half a grating period. It
is clear that the dark and light zones have moved half the Vernier period
giving a factor 40 more sensitivity over the movement of the grating. The
moving direction of the dark and light zones is related to the relative moving
direction of the gratings, which enables to determine that direction from
the signal of the CCD camera sensor.
Several Vernier regions can be combined to increase the robustness against
contamination as shown in the lower half of Figure 8.70. As the entire
surface of a sensor can only be used once, the designer can decide either for
a very large Vernier ratio or for more Vernier regions for robustness. This

798
Chapter 8. Measurement in Mechatronic Systems
is an optimisation where the outcome depends on the application.
With the resolution enhancement by the Vernier eÔ¨Äect also an additional
interpolation of the position can be done to a factor that depends on the
resolution and noise of the applied CCD camera sensor.
8.7.1.3
Interferometric Optical Encoder
The search for a continuous improvement in resolution, accuracy and robust-
ness has resulted in manufacturing improvements to continuously decrease
the grating period of the applied scales and eventually the grating period
approached the wavelength of the light. As a consequence, simple shadow
projection methods were no longer applicable and diÔ¨Äraction and interfer-
ence eÔ¨Äects had to determine the functionality.
The last example of a linear optical encoder is fully based on this eÔ¨Äect of
interference of light, using the phase gratings as described in Chapter 7
Section 7.4.3.2. This interferometric optical encoder enables resolutions into
the sub-nanometre region and is applied in precision machines like wafer
scanners.
The explanation of this more complex encoder principle will be done in
three steps. First a global overview of the system is given. The second step
explains the phase shift at the moving scale as function of the movement. In
the third step all phase relations are determined that create the interference
pattern on the photo detectors.
For the Ô¨Årst step, Figure 8.71 is used to show the path of the light in three
dimensions. The light source must be monochromatic with a high radiance
to guarantee a clear phase relation of the light at the source. The coherence
length does not need to be very long because the optical path length of all
beams in the system is designed to remain equal. Small path diÔ¨Äerences
may be induced by mechanical tolerances. Therefore the light source may
have a rather short coherence length as long as these tolerances. A light
emitting diode with a coherence length of ‚âà15 Œºm is often suÔ¨Écient but
for more critical applications a solid state laser can be used. The diverging
light from this point source is collimated into parallel rays by a positive lens
and directed to the scanning reticle. The scanning reticle consists of a phase
grating with a depth such that 75 % of the light is equally diÔ¨Äracted in three
orders. The three orders are directed to the scale on the moving part with
a reÔ¨Çective phase grating. The depth of this second phase grating is such
that most of the light is diÔ¨Äracted into the 1st‚àíorder directions. This has
diÔ¨Äerent consequences for the diÔ¨Äracted orders from the scanning reticle.
First of all the 0th‚àíorder from the scanning reticle will be reÔ¨Çected to a +1st‚àí

8.7. Optical Long-Range Incremental Position Sensors
799
-1
0
+1
Collimator lens
Lig¬é$
diode or 
solid state laser 
3 * Photo
detectors
Scale
/`
&¬õ$$
¬à$
#$
"$$
Figure 8.71: A phase grating with a periodicity in the order of the wavelength of
the light result in a very high resolution and a three phase position
signal because of the interference at the detectors.
and ‚àí1st‚àíorder at the scale. Secondly the ¬±1st‚àíorder directions from the
scanning reticle will be reÔ¨Çected back orthogonal to the surface of the scale
according to the fact, that light, entering under an angle corresponding to
the 1st‚àíorder, will be diÔ¨Äracted in the direction of the 0th‚àíorder.
The resulting four beams are recombined at the scanning reticle, because
of the symmetry and the equal diÔ¨Äraction angles in the optical system. Af-
ter recombination they will undergo a third diÔ¨Äraction with equal 0th- and
¬±1st‚àíorders. Only two of these will be used further in the system. The third
is not shown in the drawing and will in reality be projected by the collimator
lens on an area without a sensor. The collimator lens, which originally
created the parallel rays from the light source, will create one focused spot
from all returning parallel rays on a position that is determined by the angle
of these rays according to the principles of optical imaging. Depending on
the angles the rays will come together at three photo detectors.
In the previous chapter on optics, Equation (7.27) showed that the radiance
of the interference of two beams with an equal irradiance is proportional
to 1+cosœï with œï being the phase diÔ¨Äerence of the two beams. This means
that the phase diÔ¨Äerences between all beams at the point of interference
need to be determined.

800
Chapter 8. Measurement in Mechatronic Systems
Posive
phase shi
6
displacement
/4
Grang period 
1 Phase shi @ 
1 period displacement
¬ö$
phase shi
-1st 
order
+1st
order
 (x)
 (x)  
x
p
m
m
x
Figure 8.72: A displacement of the phase grating causes a phase shift of the
diÔ¨Äracted 1st and ‚àí1st‚àíorders with a sign equal to the sign of the
order. One grating period displacement gives one wavelength phase
shift of the diÔ¨Äracted orders.
For this reason in the second step of reasoning the eÔ¨Äect of a displacement of
the reÔ¨Çective phase grating on the phase of the reÔ¨Çected 1st- and ‚àí1st-order
light is determined with the help of Figure 8.72.
During the displacement of the grating with one period the phase of the
diÔ¨Äracted orders have also shifted exactly one period of the light. This means
that the incremental phase shift in the refracted orders as function of an
incremental displacement Œîx is equal to:
Œîœïm(x) = 360Œîx
p
[deg], or:
= 2œÄŒîx
p
[rad],
(8.75)
with a sign depending on the direction of movement relative to the direction
of the order. With the indicated directions in Figure 8.72, the sign is equal
to the sign of the order. The third step uses the graphical representation of
Figure 8.73 where a few simpliÔ¨Åcations are applied in respect to the real
system to enable a more easy understanding of the total phase relation-
ships between the diÔ¨Äerent beams. First the collimator lens is left away.
This is allowed as the collimator lens only creates the parallel beams and
concentrates them again on the sensors. The phase impact of this lens, if
any, is equal for all beams. Secondly the reÔ¨Çective grating is drawn as if it
is a transparent grating. This is only for graphical purposes as otherwise

8.7. Optical Long-Range Incremental Position Sensors
801
Plane
wavefront
#$*
"$$
3 orders 25 %
¬û¬°¬É{

$*
&¬õ$$
+/- 1 order 50 %
¬ö
+60- (x)
m
-60- (x)
m
-60+ (x)
m
-60+ (x)+60
m
+60+ (x)-60
m
-60- (x)+60
m
+60- (x)-60
m
+60
-60
+60
-60+ (x)-60
m
+60- (x)+60
I.1+cos(2( (x)+120))
m
-60- (x)-60
I.1+cos(2( (x)-120))
m
=2 (x) 
m
m
m
=2 (x) 
m
=2( (x)-120)
m
=2( (x)+120)
m
+60+ (x)
m
+60+ (x)+60
m
r,T
r,R
I.1+cos(2 (x)) 
m
r,S
Photo detector (R)
Photo detector (T)
Photo detector (S)
o
,$$

 x
 x
Figure 8.73: Graphical representation of the phase of an interferometric optical
encoder. The phase shift œïm caused by the moving scale gives an
irradiance pattern Ir at the photo detectors, which gives a signal of
two spatial periods for one period movement of the scale. The 60¬∞phase
shifts at the transparent grating create 120¬∞spatial phase diÔ¨Äerence
between the three sensors, resulting in a three phase measurement
signal (R,S,T).
the reÔ¨Çected and incoming beams would overlap. The part right from the
moving scale must be seen as mirrored10 from the left and the second scan-
ning reticle is in fact the same element as the Ô¨Årst. The phase relations
shown correspond to the real reÔ¨Çective grating. The third simpliÔ¨Åcation
is the omission of the phase shift due to the optical path length. Also this
is allowed as the optical path length between the gratings is equal for all
beams. The last simpliÔ¨Åcation is the omission of the diÔ¨Äraction orders that
are not used. This has some consequences as it might seem that not all
orders will keep the same radiance level. Where necessary the eÔ¨Äect is
10This method for graphical presentation of an optical system is often applied in situations
where mirrors are applied.

802
Chapter 8. Measurement in Mechatronic Systems
separately mentioned.
Starting at the left side, Ô¨Årst the incoming light from the light source is
diÔ¨Äracted by the scanning reticle into three orders with an equal irradiance
level of 25 % each. The remainder of the light is emitted in higher orders.
It was shown in Section 7.4.3.2 of Chapter 7 that such a phase grating will
cause a phase shift of +60¬∞at both 1st-orders and a phase shift of ‚àí60¬∞for
the 0th-order. Like presented before, the moving scale is a 50 % diÔ¨Äracting
scale, which does not introduce a phase shift by the diÔ¨Äraction but only by
the incremental movement Œîx. This incremental phase shift is ‚àíŒîœïm(x)
for a diÔ¨Äraction angle opposite to the motion direction and +Œîœïm(x) for a
diÔ¨Äraction angle in the motion direction. As shown in step one, the orig-
inal 1st-orders from the Ô¨Årst transition through the scanning reticle will
be diÔ¨Äracted by the moving scale into the 0th-order direction orthogonal
to the scale and another order that is not used. The orthogonal order is
recombined at the scanning reticle with both 1st-orders that originated from
the 0th-order of the Ô¨Årst transition at the scanning reticle.
The real important phase shifts happen at the second transition through
the scanning reticle. All beams will be diÔ¨Äracted in three orders of which
only two are used. Depending on the diÔ¨Äraction angle there will be an
additional +60¬∞phase shift when diÔ¨Äracted under an angle and a ‚àí60¬∞phase
shift when running in the same direction as the incoming beam. After the
second transition of the scanning reticle, four beams are obtained, each
consisting of two beams with a diÔ¨Äerent phase, determined by the addition
of all phase shifts over their respective optical path. The phase diÔ¨Äerence
between both beams in a pair gives an irradiance value at the photo detec-
tors with a cosine function of double the phase shift by the moving scale.
This doubling is a useful increase of the sensitivity. The three irradiance
signals of the detectors have a 120¬∞phase relation with each other because
of the diÔ¨Äerent 60¬∞phase shifts. This three phase measurement signal is
even more optimal for interpolation, than the 90¬∞shifted signals of the four
Ô¨Åeld encoder. There is even less need for inverse sensors to overcome the
noise at the low irradiance areas because at any position suÔ¨Écient signal
with a high irradiance level is available to increase the signal to noise ratio.
There is also no need for complicated structured sensors with Vernier en-
hancement. Furthermore the sensitivity for contamination is acceptable,
as contamination will only cause a reduction of the irradiance by scattering
of light but the phase relationship is not aÔ¨Äected. The irradiance levels
of the diÔ¨Äerent beams will however inÔ¨Çuence the interpolation and a very
strict adherence to narrow tolerances is required when the interferometric
encoder is used at extreme levels of interpolation.

8.7. Optical Long-Range Incremental Position Sensors
803
8.7.1.4
Concluding Remarks on Linear Encoders
Only a limited overview is presented of the numerous methods to achieve
incremental position information by means of a grating scale with dedicated
sensing optics.
An interesting method that for instance not has been mentioned is the two
dimensional sensing principle of the optical computer mouse. This inexpen-
sive system uses a CCD sensor to determine the displacement of a surface
by means of its surface structure. This structure fulÔ¨Åls the role of grating
and the pattern can be of any shape. Improvements with a laser source to
enhance contrast have made these sensors quite reliable and sensitive up
to sub-micrometre levels. Unfortunately this method is very sensitive for
distance variations, which could be solved with telecentric optics but that
will dramatically increase the cost. Nonetheless, it surely is an option for
future sensors in more advanced applications.
An important beneÔ¨Åt of optical encoders when used in high precision po-
sitioning systems is the small distance between the sensor and the scale.
This largely reduces the sensitivity for changes in the index of refraction of
the intermediate air. This problem is more prominently present in the laser
interferometers, which are presented in the following section.
With a further enhancement of the interferometric encoder principle it is
even possible to measure in more directions with one integrated sensor and
a two dimensional grating. In Chapter 9 such a sensor is used to measure
the position of the wafer stage in a wafer scanner.
Optical encoder measurement systems can be applied to measure very large
displacements with a high resolution as long as the scale can be mounted on
the moving object and the sensor can keep track of the scale. This limitation
is not present with measurement systems that are based on the determina-
tion of the optical path length diÔ¨Äerences by means of laser interferometers.

804
Chapter 8. Measurement in Mechatronic Systems
8.7.2
Laser Interferometer Measurement Systems
In the previous section it was demonstrated that incremental information
on the position can be obtained by interference. In laser interferometry the
interference is not caused by combining diÔ¨Äracted beams of light but by
combining beams of light that passed through optical paths with a diÔ¨Äerent
length. Laser interferometry is an extremely wide Ô¨Åeld of expertise with
countless conÔ¨Ågurations. Two quite diÔ¨Äerent application areas can be dis-
tinguished for geometric measurement.
First of all laser interferometry is the ‚Äúde facto‚Äù standard for the mea-
surement of the surface shape topology of optical elements and precisely
machined objects. By comparison of the phase of a wavefront of light that is
reÔ¨Çected from the measured surface with the phase of the wavefront that
is reÔ¨Çected from a known surface, deviations of up to several picometres
can be determined. These measurements are in principle static and require
extreme precautions for vibrations and stability.
For mechatronic systems, dealing with controlled motion, the second appli-
cation area that focuses on displacement measurement of solid objects is
more important. For this reason this section presents only displacement
measurements of moving objects with even only the most frequently used
principle, the interferometer based on the Michelson conÔ¨Åguration. Though
only one of many possible conÔ¨Ågurations, its understanding gives suÔ¨Écient
background knowledge to understand also the physical principles of the
other interferometers.
Figure 8.74 shows an overview of the main components of a laser interfer-
ometer displacement measurement system11. A laser source is used with a
large coherence length, because of the interference principle. The phase re-
lationship of the light needs to remain coherent over the entire optical path,
which is far longer than with the interferometric encoder of the previous
section. The real measurement of the distance to a moving object takes place
at the interferometer itself where the optical path diÔ¨Äerence (OPD) between
a reference and a measurement beam causes an interference signal, which
is a measure for the change in the OPD. To achieve this the source of light is
split in the interferometer in two beams with a known phase and frequency
relationship. One beam travels to a reference reÔ¨Çector and the other to a
reÔ¨Çector mounted on the object of which the distance is to be measured.
After returning to the interferometer both beams are mixed and interfere op-
11Several of the used Ô¨Ågures and background information in this section are gracefully
provided by Agilent Technologies, a leading company in extreme precision multi-axis laser
interferometer displacement measurement systems.

8.7. Optical Long-Range Incremental Position Sensors
805
Beam delivery
Interferometer
Moving object
Plane 
mirror
Laser source
Opcal Fibre
Opcal 
Part
Receiver
Electrical 
Part
Receiver
Signal 
Processing
Posion 
inf
Measurement
Signal cable
Reference
Signal cable
Figure 8.74: The main components of a laser interferometer measurement system.
The reference signal cable is only used with the heterodyne principle.
tically. The resulting interference pattern is an irradiance-modulated light
signal as function of the phase diÔ¨Äerence between the interfering beams
caused by the OPD. This interference signal is less critical in respect to
wavefront errors so it can be transported to a photo detector via an optical
Ô¨Åbre preceded by an optical part that focuses the light into the Ô¨Åbre. The
Ô¨Åbre is connected to the receiver electronics, which convert the irradiance
of the light into an electrical signal and send it to the signal processing
element.
8.7.2.1
Homodyne Distance Interferometry
The most simple version, the homodyne interferometer is shown in Fig-
ure 8.75 where the term ‚Äúhomodyne‚Äù refers to the use of light with only one
frequency. The monochromatic coherent light of a laser enters the system
from the left and is split in two parts with equal irradiance by a 50 % re-
Ô¨Çecting mirror. The Ô¨Årst part, the reÔ¨Çected light, goes towards the reference
mirror, where it is reÔ¨Çected back to the 50 % mirror, which will again split
the light in two equal parts. One half of the light is reÔ¨Çected back to the

806
Chapter 8. Measurement in Mechatronic Systems
Reference mirror
parallel to wavefront
Measurement mirror
parallel to wavefront
50 % mirror
Photo detector
Plane wavefront
Incident light 
50 %
50 %
25+25 %
100 %
25+25 %
Irradiance
x
x
y
Figure 8.75: Basic homodyne Michelson Interferometer with a 50 % reÔ¨Çecting
mirror, a reference mirror and a measurement mirror. The wavefront
of the reÔ¨Çected light after the reference and measurement mirror is
dashed to show the paths. At the right, the irradiance at the detector
is shown as function of the displacement. Note the phase jumps of
0.5Œª =180¬∞at the mirrors when reÔ¨Çecting from low refractive index to
high refractive index material.
source and not used anymore. The remaining light with an irradiance level
of 25 % of the level at the input of the system, will pass the mirror and reach
the photo detector.
The second part, the transmitted light from the Ô¨Årst encounter with the
50 % mirror, goes towards the measurement mirror and likewise with the
Ô¨Årst part, this beam will be reÔ¨Çected back to the 50 % mirror and again
half of the light is lost and transmitted back to the source with only 25 %
of the light remaining to be reÔ¨Çected at the mirror and reach the photo
detector. When all optical components are well aligned, the wavefronts of
both beams are still parallel at the detector and interference takes place
on the photo detector, either constructive when both beams are in phase or
destructive when both beams are out of phase or partial in the situation in
between. The reference mirror is stationary so only the optical path length
(OPL) of the reÔ¨Çected beam from the measurement mirror is changed with
a corresponding change in the phase of the reÔ¨Çected light. The change in
the optical path diÔ¨Äerence between the reference and the measurement
beam results in a sinusoidal irradiance modulation of the interference at
the photo detector as function of the displacement according to the 1+cosœï
relation from Equation (7.27) in the previous chapter on interference.

8.7. Optical Long-Range Incremental Position Sensors
807
The double-passing of the trajectory from the interferometer to the mea-
surement mirror and back also doubles the incremental change in OPL and
phase shift caused by an incremental movement Œîx of the measurement
mirror:
ŒîOPL = 2Œîx
and
Œîœïm(x) = 2œÄN
Œª
Œîx = 2œÄfpNn
c
Œîx
[rad],
(8.76)
where N equals the interferometer constant deÔ¨Åned as the number of single
trajectories that the measurement beam passes to and from the object, in
this case N = 2. The other terms Œª, fp and c are respectively the wavelength,
the frequency and the propagation velocity of the light in vacuum while n
equals the refractive index of the medium (mostly air with n ‚âà1) between
the interferometer and the moving mirror.
During a movement, the irradiance at the photo detector equals zero once
in every period of the modulated interference when both wavefronts are
in counter phase. Apparently the energy from the source has disappeared
at those positions. In reality the law of conservation of energy is still
true because the light of both beams that is sent back to the source shows
constructive interference when the light at the detector shows destructive
interference and the other way around. This can be checked when realising
that reÔ¨Çection at a surface from a low refractive index medium to a high
refractive index material introduces a sign inversion of the phase. This
happens at the reference mirror and the measurement mirror but only at
one side of the 50 % reÔ¨Çecting mirror, the side on the mirror glass with
the reÔ¨Çective aluminium coating. When counting the number of phase sign
inversions at the mirrors by tracing both beams, it shows that the beam at
the photo detector that was reÔ¨Çected at the reference mirror has undergone
two sign inversions while the beam that was reÔ¨Çected at the measurement
mirror had undergone one sign inversion. This means that the sign of the
phase diÔ¨Äerence between both beams due to the displacement is inverted.
The beams that are reÔ¨Çected back to the source have either one sign inversion
after reÔ¨Çection at the measurement mirror while the beam that was reÔ¨Çected
at the reference mirror got a total of three sign inversions. This means that
both beams have the same sign and as a consequence the sign of the phase
diÔ¨Äerence between both beams due to the displacement is not changed.
This means that the phase diÔ¨Äerence in the beams to the sensor and back to
the source diÔ¨Äer exactly one sign inversion. As a consequence, constructive
interference in one of the two beams corresponds to destructive interference
in the other beam.

808
Chapter 8. Measurement in Mechatronic Systems
Directional Information and Interpolation
The described basic homodyne interferometer is comparable with the basic
optical encoder with only two gratings and one sensor. At standstill the
signal from the detector is a constant value and with a movement. The
signal will vary sinusoidal with a temporal frequency proportional to the
velocity. Unfortunately, like with the basic encoder, there is no directional
information and also at low irradiance levels the noise impairs the accuracy.
One method to solve these problems is shown in Figure 8.76. It is comparable
with the previously presented Vernier encoder method with a structured
sensor. One could say that the Vernier eÔ¨Äect is caused by an imperfection in
the periodicity of the gratings. Along the same line of thoughts the solution
in the interferometer is based on an imperfection in the orientation of the
mirrors. A perfect constructive or destructive interference happens only
when the wavefronts are perfectly Ô¨Çat and aligned. As soon as one of the
mirrors is slightly tilted, fringes are observed at the photo detector as shown
at the right side of Figure 8.76.
Reference mirror
parallel to wavefront
Measurement mirror
$ 
x
50 % mirror
Photo etector
Plane wavefront
Incient light 
50 %
50 %
25+25 %
100 %
Fringes
y
Figure 8.76: Homodyne Michelson Interferometer with a CCD sensor and tilted
measurement mirror. The tilting is highly exaggerated for reasons of
comprehensibility. At the right, the irradiance pattern is shown with
fringes and corresponding wavefronts, which occur at the photo detec-
tor plane when the wavefronts are not running parallel. A movement
of the measurement mirror to the right will increase the phase delay of
the reÔ¨Çected beam. As a result the wavefronts from the measurement
mirror towards the photo detector will move up, which causes the
crossing points of constructive interference with the wavefronts from
the reference mirror to move to the left.

8.7. Optical Long-Range Incremental Position Sensors
809
These are caused by diÔ¨Äerences in path length due to the tilt12.
Their spatial frequency is proportional to the tilt angle according to the
following reasoning:
Tilting of one mirror with angle œë causes a tilted wavefront with angle œë‚Ä≤ = 2œë
relative to the wavefront from the other mirror. A displacement dx on the
photo detector corresponds to a distance diÔ¨Äerence between the wavefronts
of dy = dxsinœë‚Ä≤. For one wavelength shift in the y direction from constructive
to constructive interference, the corresponding fringe distance dx for small
tilting angles is determined as follows:
dy = Œª = dxsinœë‚Ä≤
=‚áí
dx =
Œª
sinœë‚Ä≤ ‚âàŒª
œë‚Ä≤ ‚âàŒª
2œë
[m].
(8.77)
With a single photo detector these fringes would result in a constant average
irradiance over the surface of the sensor when the fringe period is smaller
than the diameter of the sensor. In a normal interferometer this would
require a smaller sensor at the sacriÔ¨Åce of sensitivity but it is far better
to use a structured sensor like a CCD camera. In that case the movement
direction can be detected as these fringes will move over the surface of the
detector when the measurement mirror moves in the x-direction. In the
setup of Figure 8.76 a movement of the mirror to the right will cause a
movement of the fringes to the left. A displacement of Œîx = Œª/N = Œª/2 of
the moving mirror will cause a shift of the fringes with one fringe period.
This enables a good resolution with suÔ¨Écient interpolation capability of the
spatial sinusoidal signal. An interpolation factor of hundred already yields
a resolution of 3 nm with a Helium-Neon laser of 632 nm. Although with
further improvements on interpolation even better results are obtainable,
this principle still has some additional drawbacks, which have challenged
people to create diÔ¨Äerent concepts to solve these. First of all there is the
sensitivity for additional tilt in the mirrors and secondly the signal frequency
ranges from 0 Hz until very high frequencies depending on the displacement
velocity. Especially the low frequency signals will introduce errors due to
electronic drift.
Sensitivity for Tilt Variations
Sensitivity for the tilt variations of the mirrors can only be limited by a very
stable mounting. This would limit its use to systems with only one degree
12Fringes are also used when measuring surfaces with interferometers that compare the
surface with a known reference surface. The fringe shape and distance represents the value of
the surface slope relative to the reference.

810
Chapter 8. Measurement in Mechatronic Systems
f
R=f
Cats-eye
                                     Cube-corner
Figure 8.77: A cats-eye consists of a positive lens with a spherical mirror in the
focal point of the lens. The cube-corner is a prism with three mutually
orthogonal reÔ¨Çecting surfaces. With both optical systems, the light
rays will be reÔ¨Çected in the same direction as where they came from
but shifted to an opposite position of the chief ray through the central
point of the optic entry pupil. This point symmetry is shown in the
photographic picture from three cube-corners with a diÔ¨Äerent orienta-
tion where the reÔ¨Çection of the lens always has the same orientation
to the camera. The text on the lens, however, is mirrored.
of freedom on a perfect straight guiding mechanism, which avoids angular
motion. For interferometers that do not need a tilting mirror for directional
information this problem can be avoided by replacing both mirrors by a
cube-corner retro-reÔ¨Çector, also called just a cube-corner or corner-cube. Also
the cats-eye can serve this purpose. Both optical systems have in common
that they reÔ¨Çect the light back (retro) in the same direction as where it came
from without any optical path diÔ¨Äerence for parallel rays, thus keeping the
reÔ¨Çected wavefront Ô¨Çat and parallel to the incident light. Figure 8.77 shows
both optical systems. A cats-eye consists of a positive lens with a spherical
mirror in its focal point. The radius of the spherical mirror is equal to the
focal length of the mirror causing the chief ray through the centre of the lens
to always be reÔ¨Çected back in the same direction. As the reÔ¨Çecting surface
is positioned in the focal point of the lens all parallel rays will be focused
on one point on the spherical surface and reÔ¨Çected back under the same

8.7. Optical Long-Range Incremental Position Sensors
811
angle with the chief ray, which is always orthogonal to the spherical surface.
After the lens the reÔ¨Çected rays will be re-collimated parallel to the incident
rays. Their position is however mirrored in respect to the point of incidence
of the chief ray. For this reason this system is called point-symmetric. The
main drawback of a cats-eye is the fact that a simple two element cats-eye
can only be used with small apertures and approximately paraxial rays as
otherwise spherical aberration and coma will cause wavefront errors. With
aspheric optics or multiple optical elements these errors can be avoided at
increased cost. The cube-corner has less problems in that respect because
it does not apply curved surfaces. It consists only of a monolithic piece of
transparent material with three mutually perpendicular mirror surfaces,
which internally reÔ¨Çect all rays back in the same direction. Like the cats-eye,
the cube-corner is a point-symmetric retro-reÔ¨Çector.
Wide Frequency Range
In the situation that the measurement mirror is stationary to the interfer-
ometer, the interference pattern does not change and the signals on the
detector are constant. When the measurement mirror is moving the sig-
nals on the sensor will change with a frequency that is determined by the
movement speed, the interferometer constant and the tilting angle, which
causes the fringes. Generally a wide frequency range of the interference
signal from 0 Hz to very high frequencies is not preferred for low signal level
situations, because of noise. This low signal-level situation is often reality
in a multi-axis measurement system where one laser source has to supply a
multitude of interferometers. It is especially important to avoid a DC value
of the signal as all DC measurements show some level of DC drift over time.
In Section 8.3.2 it was shown that by modulating a low-frequency signal, the
spectrum of the measurement signal can be shifted to a higher frequency,
thereby avoiding problems due to drift. With a homodyne interferometer
this modulation can be realised by adding a small high-frequency motion
oscillation to the reference mirror, resulting in a modulated signal at the
detector. This can be synchronously demodulated after ampliÔ¨Åcation.
It is also possible to use polarisers and polarisation dependent optical el-
ements to create two interference signals with 90¬∞phase diÔ¨Äerence to get
the directional information by quadrature detection, which was introduced
with the theory on interpolation of encoder signals.
Ultimately, heterodyne interferometry appeared to be a better solution for
high precision displacement measurements with laser interferometry in
actively controlled positioning systems.

812
Chapter 8. Measurement in Mechatronic Systems
8.7.2.2
Heterodyne Distance Interferometry
The heterodyne distance interferometer solves the above mentioned prob-
lems by using a laser source with two diÔ¨Äerent beams, one for the reference
and one for the measurement path, that have a diÔ¨Äerent frequency and a
mutually orthogonal linear polarisation direction. In most cases the beams
are combined into one beam at the input of the system but the principle can
also work with fully separated beams as long as they have a known phase
and frequency relationship.
The term ‚Äúheterodyne‚Äù refers to the frequency diÔ¨Äerence. This split-frequency
fs can be in the order of several Megahertz. One method to generate a laser
source with such a dual frequency spectrum is based on the Zeeman eÔ¨Äect,
named after the Dutch physicist and Nobel prize winner Pieter Zeeman
(1865 ‚Äì 1943) who discovered the eÔ¨Äect. When the laser cavity of a Helium
Neon laser is inserted in a permanent magnetic Ô¨Åeld, the normally single
laser-frequency radiation is split in two radiation parts with an equal irra-
diance but with two diÔ¨Äerent frequencies and polarisation states. The two
frequencies are symmetrically spaced around the original frequency, called
the centre-frequency fc. The split-frequency is proportional to the magnetic
Ô¨Çux density. The polarisation direction of both radiation components is
circular with opposite directions. This circular polarised light is converted
into two orthogonal linear-polarised radiation components by a birefringent
plate with one quarter of a wavelength delay between the orthogonal polari-
sation directions. This quarter wave plate or Œª/4-plate plays an important
role in the further explanation of the heterodyne interferometer.
A disadvantage of the Zeeman method to create a laser beam with two
frequencies is the limited optical power. This is due to the bandwidth of the
Fabry-Perot cavity from the laser, which is too small to optimally resonate
at both frequencies. This eÔ¨Äect is especially prominent when a very high
split frequency is needed. As will be shown later, measuring displacements
with a very high velocity demands such a high frequency.
In case more power is needed at such a high split-frequency, a suitable
light source can be created by modulation of the light of a single-frequency
laser by means of an acousto-optic modulator. An acousto-optic modulator
contains a piezoelectric actuator, which creates running sound waves in a
material like quartz. The resulting density diÔ¨Äerences act like a modulated
moving refractive-index phase grating. Depending on the intensity of the
modulation, the magnitude of the light in the diÔ¨Äraction orders is modu-
lated in a similar way as was presented on modulation by the depth of a
phase grating. More important is the frequency shift, which is caused by

8.7. Optical Long-Range Incremental Position Sensors
813
/4-plates
f1
p - polarised
|'¬á
f2
s - polarised
|¬õ¬á
Polarising
beam spli'er
Polariser
Photo detetor
Referene mirror
parallel to wavefront
Measurement mirror
parallel to wavefront
x
Polariser
f
1
pol
f
2
pol
Interferene
x
y
x+y
Figure 8.78: Heterodyne Michelson interferometer with a two frequency orthogonal
polarised laser where the polarisation is used to separate the reference
and measurement path by means of a polarising beam splitter and two
Œª/4 plates. At the right side the eÔ¨Äect of the polariser is shown enabling
interference, which otherwise would not occur between orthogonal
polarised beams.
Note that the phase steps of 180¬∞at the reÔ¨Çecting surfaces are not
shown as this is not relevant for this principle.
a Doppler eÔ¨Äect at the moving sound waves, creating diÔ¨Äerent frequencies
for the diÔ¨Äerent diÔ¨Äraction orders. This frequency diÔ¨Äerence equals the
frequency of the sound times the order number.
Figure 8.78 shows the principle of the heterodyne interferometer. The dif-
ferent polarisation directions of the two-frequency beam components are
used to guide the light to the measurement and reference optical path in
the following way:
The combined beam enters the system from the left. The beam component
with frequency f1 is p-polarised in the plane of incidence of the polarising
beam splitter and the beam component with frequency f2 is s-polarised.
S-polarised light will be reÔ¨Çected by the polarising beam splitter and p-
polarised light will be transmitted. As a consequence the s-polarised light
will serve as reference beam. It is reÔ¨Çected towards the reference mirror and
passes a quarter wave plate consisting of a birefringent material. When ori-
ented in the right way to the polarisation direction of the beam, this Œª/4 plate
creates a phase lag of 90¬∞in one of the polarisation directions relative to
the other direction as explained in Section 7.4.1.1 in the previous chapter
and changes the polarisation from linear into circular. After reÔ¨Çection at
the reference mirror the second pass through the Œª/4 plate will convert the

814
Chapter 8. Measurement in Mechatronic Systems
circular polarised light again into linear polarised light but orthogonal to
the original direction. As a consequence the now p-polarised beam will be
transmitted through the polarising beam splitter towards the polariser and
the photo detector.
The p-polarised component of the light from the laser source serves as mea-
surement beam. It is Ô¨Årst transmitted by the polarising beam splitter and
after a passing through a second Œª/4 plate, reÔ¨Çection at the measurement
mirror and a second pass through the Œª/4 plate it has become s-polarised and
is reÔ¨Çected towards the polariser and the photo detector where it recombines
with the reference beam.
The polariser fulÔ¨Åls an important requirement as the vectorial addition of
orthogonal polarised electromagnetic Ô¨Åelds will not show destructive or con-
structive interference. With an accurately oriented polariser under 45¬∞with
both polarisation directions only the component of each beam in the polari-
sation direction of the polariser will pass as shown in the right drawing on
Figure 8.78. This means that after the polariser the Ô¨Åelds of both beams
have an equal direction and the vectorial addition will show interference at
the expense of a factor

2 loss of amplitude, which corresponds to a factor
two of the radiance. It can be reasoned that also in this case constructive in-
terference at one location corresponds to destructive interference at another
place, hence corresponding to the physical law of conservation of energy.
In case x and y are in phase in the direction of the polariser as drawn, the
components of polf1 and polf2 in the orthogonal direction are in counter
phase.
Interference at the Detector
The resulting interference Ô¨Åeld at the detector consists of the combined Ô¨Åelds
of the two laser beams each with an equal irradiance level but with diÔ¨Äerent
frequencies, as shown in Figure 8.79. The Ô¨Åelds are added according to the
following13 equation:
Et = E1 + E2 = Eb,p (sin(2œÄf1t)+sin(2œÄf2t))
V/m

.
(8.78)
where Eb,p equals the peak amplitude of the electric Ô¨Åeld of the beams,
which is equal for both beams in this example.
13The following mathematical analysis including the lock-in quadrature detection is derived
from the PhD thesis of Jonathan Ellis from the Mechatronic System Design laboratory at Delft
University of Technology [28], [29].

8.7. Optical Long-Range Incremental Position Sensors
815
Time
E( f )
1
I 
Phase
Field
Irradiance
E( f )+
1
E( f )
2
E( f )
2
r
+n¬∑2
2+n¬∑2
0+n¬∑2
Phase
1
0
Figure 8.79: Two interfering beams with diÔ¨Äerent frequencies result in an irra-
diance signal, proportional to one plus the cosine of 2œÄ(f1 ‚àíf2). The
phase between both frequencies shifts linear over time.
Using a trigonometric identity and cancellation of the factors two in the
numerator and denominator yields the following equation:
Et = 2Ep sin

2œÄ(f1 + f2)t
2

cos

2œÄ(f1 ‚àíf2)t
2

= 2Ep sin(œÄ(f1 + f2)t)cos(œÄ(f1 ‚àíf2)t) = 2Ep sin(2œÄfct)cos(œÄfst)
V/m

.
(8.79)
From this equation the sine term is the very high-frequent centre frequency.
The cosine term is the much smaller frequency diÔ¨Äerence and can be seen
as the amplitude modulation of the high-frequency term.
The irradiance is proportional14 to the Ô¨Åeld magnitude squared. It becomes
a constant RMS value of

2 that can be left out in the proportional equation,
because the high-frequency term is unmeasurably high, resulting in the
following expression for the irradiance:
Ir ‚àùE2
p cos2 (œÄfst)
‚àùE2
p

1+cos(2œÄfst)
2

‚àùE2
p(1+cos(2œÄfst))
W/m2
.
(8.80)
The resulting signal after the photo detector is a combination of a DC voltage
and a sinusoidal voltage with a frequency, equal to the frequency diÔ¨Äerence
14The constant cnŒµ0 is omitted in these expressions as it does not contribute to the under-
standing of the principle.

816
Chapter 8. Measurement in Mechatronic Systems
of the two beam components that interfered at the sensor.
When comparing this equation with the 1+cosœï relation from Equation (7.27),
which is used with the homodyne interferometer, it is clear that the two
heterodyne frequency components represent a continuous phase shift:
œïs = 2œÄfst
[¬∞].
(8.81)
The phase shift is linear proportional with time at standstill.
It will be shown in the following that this phase relation is also determined
by the optical path diÔ¨Äerence between the measurement and reference beam.
This combination of continuous phase shift and the phase shift by the optical
path diÔ¨Äerence enables the measurement of movements by using only the
AC part of the signal, thereby avoiding induced errors by low-frequency
noise.
Velocity and Position Detection by Doppler Shift
When the measuring mirror in a heterodyne interferometer moves along
the direction of the beams, the measured frequency diÔ¨Äerence after inter-
ference fm becomes diÔ¨Äerent from the frequency diÔ¨Äerence fs at the input
of the interferometer. This phenomenon is called the Doppler shift of the
measurement beam, caused by the Doppler eÔ¨Äect, which was discovered in
1842 by the Austrian physicist Christian Andreas Doppler (1803 ‚Äì 1853).
The Doppler eÔ¨Äect is related to the constant wavelength and propagation
velocity of a travelling wave. At a Ô¨Åxed position a travelling wave with prop-
agation velocity vp and wavelength Œª will be observed as a Ô¨Åxed temporal
frequency f = vp/Œª.
When the position of the observer is changing, the observed frequency is
decreased when moving in the same direction as the wave propagation
and increased when moving in the opposite direction. In fact the spatial
frequency of a wave, as determined by the wavelength, is converted into a
temporal frequency by the movement of the observer. Depending on the
movement direction, this temporal frequency is added to or subtracted from
the temporal frequency of the wave that would be observed at stand still.
A light wave with temporal frequency fc and a propagation velocity vp = c/n,
with n being the refractive index, experiences the Doppler shift in the fre-
quency of the measurement beam by a motion velocity vm equal to the

8.7. Optical Long-Range Incremental Position Sensors
817
Reference
signal 
Measurement
signal 
p1
p2
0V
0V
6`
 (rad) 
0

Figure 8.80: The velocity and position of the measurement mirror can be detected
by measuring the diÔ¨Äerence in the timing period of the reference and
measurement irradiation signal or by measuring the relative phase.
following expression:
fd = fc

1‚àí
vp
vp ¬± Nvm

= fc

1‚àí
c/n
c/n¬± Nvm

= fc

 c/n¬± Nvm‚àí‚àã, cef raccn
c/n¬± Nvm

‚âà¬±fc

 Nnvm
c

[Hz].
(8.82)
The approximation is valid when the motion velocity is very small in respect
to the propagation velocity of the wave, which is in practice true for the
speed of light. N equals the previously deÔ¨Åned interferometer constant and
presents itself as a multiplication factor for the Doppler eÔ¨Äect, correspond-
ing to the number of times that the measurement beam travels the path to
the moving mirror. Furthermore the centre frequency fc is in most cases
allowed to be taken as reference as the split frequency is with even 5 MHz
only a small part ‚âà10‚àí8 of fc. If necessary this small deterministic factor
can be taken into account. More important is the refractive index n, which
shows to be a factor that directly inÔ¨Çuences the observed frequency shift. It
will be shown later that the refractive index induces a serious measurement
uncertainty when measuring in air with extreme requirements on precision.
The Doppler shift is equally present as an oÔ¨Äset in the frequency diÔ¨Äerence
at the measurement sensor fm = fs + fd. This means that fd can be detected
by comparing the detector signal from the interferometer with a reference
signal equal to the split frequency fs of the beam components at the entry of

818
Chapter 8. Measurement in Mechatronic Systems
the interferometer. With a Zeeman laser this diÔ¨Äerence signal is obtained
by creating an interference signal from a small portion of the light via a
beam splitter, a polariser and a detector, similar to the detection after the
interferometer. With an acousto-optic modulated laser the frequency of the
modulator can directly be used as reference.
The detection can be done in several ways. One method uses a comparator
like a Schmitt trigger to detect the zero voltage crossings of the AC part of
the detector signal and the reference signal. When the timing period be-
tween the zero crossings of both signals is precisely measured, as indicated
in Figure 8.80, the diÔ¨Äerence between both signal periods is an accurate
measure for the frequencies and the corresponding velocity.
When this measurement is done at regular intervals, the incremental po-
sition change over that interval is determined by multiplying the interval
period with the found velocity.
In principle the sampling of the zero crossings is equal to a phase measure-
ment as with diÔ¨Äerent frequencies their phase relation shifts proportional
with the time as function of the velocity. When applying Equation (8.81) for
the measured frequency fm, the following relation for the phase is obtained:
œït = 2œÄfmt = 2œÄ(fs + fd)t = œïs +œïd
[¬∞].
(8.83)
The phase term œïs = 2œÄfst is equally present in the reference signal, which
means that, when the measurement and reference frequencies are compared
in phase, only the Doppler phase shift œïd remains. With Equation (8.82)
and neglecting the small error due to the velocity diÔ¨Äerence between the
movement and the speed of light this becomes:
œïd = 2œÄfdt = ¬±2œÄfc

 Nnvmt
c

[¬∞].
(8.84)
Within an incremental time period Œît the incremental displacement equals
Œîx = vmŒît and the incremental phase shift due to this displacement becomes:
Œîœïm(x) = ¬±2œÄfcNn
c
Œîx
[¬∞].
(8.85)
This relation is equal to the phase relation that was found with the homo-
dyne interferometer. This is not without logic as the heterodyne frequency
diÔ¨Äerence only introduces an additional phase shift to the phase shift caused
by the displacement. For this reason the second detection method measures
directly the incremental phase shift as function of an incremental displace-
ment by means of quadrature detection with a lock-in ampliÔ¨Åer.

8.7. Optical Long-Range Incremental Position Sensors
819
Lock-in Quadrature Detection
Figure 8.81 shows a schematic of a typical lock-in ampliÔ¨Åer used to measure
the phase between two signals. Both the measurement (M) and reference
(R) signals are bandpass Ô¨Åltered (BPF) around the frequency fs to remove
their nominal oÔ¨Äset, eliminate the sensitivity to optical power Ô¨Çuctuations,
and provide anti-aliasing Ô¨Åltering for the digital signal processing. After
Ô¨Åltering, the reference signal is sent to a phase-locked loop (PLL). A phase-
locked loop is a feedback controlled variable oscillator of which the frequency
is controlled with a phase detector to track the input frequency with a
next-to-zero phase diÔ¨Äerence. The reason to apply a phase-locked loop is
its possibility to generate two signals with a nominal phase oÔ¨Äset of 90¬∞.
Similar to the Lissajous plot shown with the spatial signals of a decoder
with four sensors, two temporal signals with 90¬∞phase diÔ¨Äerence enable
signal interpolation and directional information. The name quadrature
detection for this method comes from radio transmission practice and is
related to the four quadrant vectorial representation deÔ¨Åned by the phase
diÔ¨Äerence of the signals.
The two outputs with 90¬∞phase diÔ¨Äerence from the phase-locked loop, Rc
and Rs, are multiplied with the measurement signal to generate two signals,
the in-phase I and the quadrature Q signals. These signals relate in the
following way to a phase shift œïm(x) related to the diÔ¨Äerence in optical path
R
M
BPF
PLL
Rc
Rs
BPF
√ó
√ó
I
Q
LPF
LPF
atan
unwrap
gain
x
Figure 8.81: Schematic of a lock-in ampliÔ¨Åer for phase measurements. Two signals
are detected and initially Ô¨Åltered. The reference signal R is sent to a
phase-locked loop (PLL) to generate matched sine and cosine signals.
Those are then multiplied with the Ô¨Åltered measurement signal M
to produce in-phase (I) and quadrature (Q) outputs. Those are then
low-pass Ô¨Åltered and sent to an arctangent function. The phase is
then unwrapped and a gain is applied to determine the displacement
x from the unwrapped phase.
(Courtesy of Jonathan Ellis)

820
Chapter 8. Measurement in Mechatronic Systems
lengths between the reference and measurement beams:
I = RcM = cos(2œÄfst)cos(2œÄfst+œïm(x))
and
(8.86)
Q = RsM = cos

2œÄfst+ œÄ
2

cos(2œÄfst+œïm(x)),
(8.87)
where œïm(x) is the Doppler phase change of the measurement signal, rela-
tive to the reference signal as a function of the displacement. Applying a
trigonometric identity yields:
I = 1
2 cos(4œÄfst+œïm(x))+ 1
2 cos(œïm(x))
and
(8.88)
Q = 1
2 cos

4œÄfst+ œÄ
2 +œïm(x)

+ 1
2 cos
œÄ
2 +œïm(x)

.
(8.89)
If a low-pass Ô¨Ålter is used after both multipliers to provide suÔ¨Écient at-
tenuation to the signal at a frequency of 2fs, then the remaining signals
are
I = 1
2 cosœïm(x)
and
(8.90)
Q = 1
2 cos
œÄ
2 +œïm(x)

.
(8.91)
The phase shift due to the optical path diÔ¨Äerences is then equal to:
œïm(x) = arctan

Q
I

[¬∞].
(8.92)
In order to derive a correct incremental phase shift Œîœïm(x), related to an
incremental displacement Œîx one has to ensure that the sign of the input
values is taken into consideration in order to place the angle in the proper
quadrant at the start and the end of the increment. The last step needed is an
unwrapping function that properly adds or subtracts 2œÄ for each successive
2œÄ phase jump that has passed during the incremental displacement. The
phase can then be scaled to the displacement value with Equation (8.85)
by knowing the refractive index n, the interferometer constant N and the
centre laser frequency fc.
Important remark:
These requirements, regarding the right quadrant and perfectly counting
all 2œÄ phase jumps, point clearly to the fully incremental nature of practical
laser interferometer systems. They all require an initialisation step to set
the position counters and phase pointers to zero.
It is not possible to measure absolute positions along the total trajectory,
like with the separate marks of encoders. To solve this problem, research
is done on interferometry with multiple frequencies, so called frequency

8.7. Optical Long-Range Incremental Position Sensors
821
combs, which are based on a laser with short pulses of only a few hundred
femtoseconds (10‚àí15). This research has not yet resulted in a practical
commercial implementation.
Velocity Limitation of Heterodyne Interferometry
An important limitation to the applicability of heterodyne interferometry is
due to the maximum value that can reliably be realised for the split frequency
of the applied laser beam. When moving in a direction that increases the
frequency diÔ¨Äerence at the measurement detector no real problem will
occur as long as the detector can handle the increased frequency level. A
movement in the opposite direction, however, will Ô¨Årst reduce the frequency
diÔ¨Äerence to a lower frequency depending on the velocity. When increasing
the velocity, at some point the measured frequency diÔ¨Äerence becomes equal
to zero. Above that velocity, the frequency diÔ¨Äerence will increase again
but with a diÔ¨Äerent sign. It is clear that in such a situation all directional
information is lost and the measurement system should be reset again.
The minimum split frequency is determined by Equation (8.82):
fs > fc

 Nnvm
c

[Hz].
(8.93)
The interferometer constant N was equal to two in the previous example
but in the following section, examples will be shown with N = 4. Although a
higher interferometer constant will increase the sensitivity and accuracy it
requires a corresponding increase of the split frequency.
This property of the heterodyne interferometer forces a choice between
accuracy and maximum velocity and has stimulated the development of
acousto-optic laser sources with a large frequency diÔ¨Äerence combined with
high-speed signal conditioning and signal processing electronics.
8.7.2.3
Measurement Uncertainty
There are two major sources of uncertainty in laser interferometer position
measurement systems. The Ô¨Årst is related to the question whether the
interferometer detects only the desired displacement changes. The second
uncertainty source is related to the phase measurement and whether it
converts only the desired phase shift into a measurement signal.
There is a subtle, yet important diÔ¨Äerence between these two uncertainty
sources. The former pertains to the interferometer design and direct com-
pensation or cancellation by balancing the system whereas the latter deals

822
Chapter 8. Measurement in Mechatronic Systems
more with the laser system employed, measurement environment, phase-to-
displacement conversion, and sample properties.
The uncertainty factors related with mechanics will be presented in Sec-
tion 8.7.3 at the end of this chapter. In the following, Ô¨Årst the internal errors
of the interferometer will get attention:
‚Ä¢ Periodic errors, causing a repetitive modifying additional measure-
ment error at the nanometre and sub-nanometre levels.
‚Ä¢ Frequency stability, acting as a modifying error.
‚Ä¢ Wavefront errors and pointing stability due to non-ideal optical
parts.
‚Ä¢ Refractive index changes due to the properties of the medium be-
tween the interferometer and the moving object.
Periodic Errors
The working principle of a heterodyne interferometer is based on the capa-
bility to fully separate the measurement and reference beam by means of
their polarisation. Unfortunately the polarisation direction is never fully
orthogonal due to imperfections in the source or the polarising optics. This
means that there is always a small part of the reference beam that trav-
els along with the measurement beam and the other way around. This
unwanted eÔ¨Äect is called polarisation mixing and causes small changes in
the measured phase between the measurement interference signal and the
reference signal. These changes are a periodic function of the displacement
in relation to the wavelength and are expressed in number of fringes, which
were introduced with the homodyne interferometer. One fringe is equal to
a 2œÄ phase shift corresponding to a displacement of x = Œª/N. These phase
diÔ¨Äerences induce a deterministic periodic error as shown in Figure 8.82,
which can in principle be compensated by means of software and calibration
as long as the conditions don‚Äôt change. This compensation can only be as
good as the stability of the system and in some cases it is better to avoid
them by fully separating both beams directly from the beginning.
Figure 8.83 shows an example of such a system with one degree of freedom,
designed by Ki-Nam Joo and Jonathan Ellis from the Mechatronic System
Design laboratory at Delft University of Technology [49], [50], [51].
Two separate laser beams with a Ô¨Åxed split frequency, originating from an
acousto-optic modulated laser source are inserted in a 50 % beam splitter,

8.7. Optical Long-Range Incremental Position Sensors
823
0
1
2
3
4
5
0
0.4
0.8
1.2
1.6
Fringe
Displacement [Œºm]
No PNL
With PNL
0
1
2
3
4
5
z¬É
z)
z¬Ç
0
2
4
6
Fringe
Error [nm]
Figure 8.82: Comparison between a linear signal and a signal with periodic nonlin-
earity, highly exaggerated for illustrative purposes. The second graph
shows a linear displacement with 5 nm of periodic errors with the
nominal slope removed. The periodic errors typically have a Ô¨Årst-order
component with one cycle per fringe and a second-order component
with two cycles per fringe. Higher-orders may appear from additional
ghost reÔ¨Çections or stray signals.
(Courtesy of Jonathan Ellis)
similar as the one used in a homodyne interferometer. One half of both
beams is reÔ¨Çected as two separate reference beams by a right angle prism,
back towards the beam splitter and the other half is transmitted as two sep-
arate measurement beams towards the movable cube-corner retro-reÔ¨Çector.
The right angle prism has line symmetry, which means that the rays are
reÔ¨Çected in the same plane orthogonal to the edge line of the prism as where
they entered. As a consequence the lower reference beam f1 will stay at the
lower side of the interferometer and the higher reference beam f2 will stay at
the high side. The point symmetry of the cube-corner causes both beams to
change position and the measurement beam f1 arrives at the beam splitter
at the same location as the reference beam f2 while the measurement beam
f2 arrives at the same place as the reference beam f1.
These two beams both interfere at the beam splitter and their interference
signals will show an opposite phase shift as function of the measured dis-
tance between the interferometer and the moving retro-reÔ¨Çector.
The Ô¨Årst advantage of this conÔ¨Åguration is that no polarisation mixing can
occur before the interference takes place as periodic errors are related to the
changing trajectory of the measurement beams to the moving retro-reÔ¨Çector.
The second advantage is the double sensitivity with interferometer constant
N = 4 because of the fact that four beams are travelling the same trajectory
to the moving retro-reÔ¨Çector. The last advantage is that no use has been
made from the polarisation direction. This enables its application in more

824
Chapter 8. Measurement in Mechatronic Systems
Cube corner
¬õ
Photo detector 1
Photo detector 2
¬Å{¬¥'
Right angle 
prism
1
2
f
f
Figure 8.83: Heterodyne interferometer without periodic errors.
Two parallel
beams from the optical source (f1 and f2) travel to the beam split-
ter and the reÔ¨Çected beams travel toward the right angle prism. The
transmitted beam travels to the retro-reÔ¨Çector. Then, the reference
and measurement beams can be recombined by the beam splitter to
create an interference with opposite phase directions, detected by the
photo detectors.
(Courtesy of Ki-Nam Joo)
complex interferometers where the polarisation direction can be used for
other reasons, like for creating a plane-mirror version of this interferometer
along the line of thoughts that are presented in the next section.
Frequency Stability
The uncertainty of the interferometer measurement itself is fully based on
the phase measurement that is expressed in Equation (8.85):
ŒîœÜx = ¬±2œÄfcNn
c
Œîx
[ ].
(8.94)
The Ô¨Årst source of uncertainty is the frequency of the light fc. In princi-
ple lasers can be made with a stable frequency up to 10‚àí11, or 10 pm per
metre, by thermal stabilisation and other methods, which is suÔ¨Écient for
most measurements. Further all factors are constant with the exception
of the refractive index n, which is related to the propagation speed in the
environment where the measurement takes place, which is mostly in air.

8.7. Optical Long-Range Incremental Position Sensors
825
Wavefront Errors and Pointing Stability
Interference of the reference and measurement beam takes place over the
total overlapping area of both beams. As long as both beams have a Ô¨Çat and
parallel wavefront the interference is identical over the total surface but any
deviation to that ideal Ô¨Çat wavefront will cause a phase shift and reduction
of the total observed interference at the photo detector. With the exception of
the purposely applied tilt in the wavefront of the homodyne interferometer
to create moving fringes, normally all wavefronts in a laser-interferometer
measurement system need to be parallel and without any exception always
the wavefronts need to be Ô¨Çat. This poses extreme requirements to both
the spatial coherence of the laser source, the Ô¨Çatness of the optical surfaces
and perfection in the retro-reÔ¨Çectors. In principle optical Ô¨Çats are very
diÔ¨Écult to manufacture with an exponential cost increase as function of
size and maximum allowable surface topology deviation. The deviations can
be expressed using the Zernike modes as described in Section 7.5.2.1 and
have to remain at least below Œª/20 to get an acceptable interference signal
but when lateral beam displacements are present, the deviations in the
surface need to remain below the required measurement accuracy of the
interferometer system.
Next to non-parallelism, a beam that is not pointing to the right direction
will induce a so called cosine error, which is proportional to the cosine of the
angle of the beam with the reÔ¨Çecting surface of the measurement mirror.
This error is minimal when the direction is orthogonal. When initially all
interferometers are mounted such that the measurement beam is as good as
possible aligned, any change in the pointing due to temperature or to other
mechanical instabilities will have an inÔ¨Çuence on the measurement error.
Refractive index Changes
The refractive index of air is inÔ¨Çuenced both by pressure and by temper-
ature and the related measurement uncertainty is a more diÔ¨Écult error
to overcome. This is in a large part due to the systematic uncertainty in
the equations used to calculate the refractive index. Even with ideal en-
vironmental parameter measurements, there still is an uncertainty due
to the equations used and the empirical data from which they are derived.
The typical calculation for refractive index is done with the modiÔ¨Åed Edl√©n
equation, named after the Swedish physicist Bengt Edl√©n (1906 ‚Äì 1993).
After his original deÔ¨Ånition in Metrologia [27] it was improved by several
scientists in an international comparison of interference air refractome-

826
Chapter 8. Measurement in Mechatronic Systems
ters with participants like Piet Schellekens of the Eindhoven university of
technology and Jo Spronck from Van Swinden laboratories who presently
is active in metrology at our University laboratories in Delft. This highly
accurate experimental work was published in Metrologia [74] and reÔ¨Åned
in a successor paper from 1993 [9] by K. Birch and M. Downs, two scientists
of NPL, the metrology institute of Great Britain, with a correction [10] one
year later, because the original article used the old IPTS-1948 temperature
scale standard of BIPM while in 1990 a new international temperature
scale, the ITS-90 [71] was introduced. The following equation is taken from
the corrected version for the refractive index diÔ¨Äerence of air relative to
vacuum:
(n‚àí1)T,P = P(n‚àí1)ŒΩ
96095.43
1+10‚àí8(0.601‚àí0.00972T)P
1+0.003661T
.
(8.95)
The dispersion factor (n‚àí1)ŒΩ is equal to:
(n‚àí1)ŒΩ =

8342.54+ 2406147
130‚àíŒΩ2 +
15998
38.9‚àíŒΩ2

¬∑10‚àí8.
(8.96)
These equations give the refractive index nT,P for dry air as a function of
the wavenumber ŒΩ = 1/Œª in Œºm‚àí1, the temperature T in degrees Celsius
according to the ITS-90 temperature scale and the pressure P in Pascals for
a wavelength in the range of 350 ‚Äì 650 nm.
The refractive index for non-dry air nT,P,Pv is calculated by:
nT,P,Pv ‚àínT,P = ‚àíPv(3.7345‚àí0.0401ŒΩ2)¬∑10‚àí10.
(8.97)
where the vapour pressure Pv is in Pascals.
Using these equations, the traceable uncertainty in the calculated refrac-
tive index is not better then approximately one part in 108 because of the
uncertainty in the measurements of pressure, temperature and humidity.
This value is equal to a traceable uncertainty of 10 nm over a metre, re-
lated to agreed standards with long term stability demands. Fortunately
this uncertainty contains unknown but rather constant errors. When only
short term relative measurements have to be done in the order of minutes
or seconds like is often the case in mechatronic positioning systems, the
uncertainty can be as low as 100 pm.
By taking the partial derivative of the modiÔ¨Åed Edl√©n equation to tempera-
ture, pressure and humidity the individual sensitivity for these modifying
error inputs can be estimated in a certain environmental condition setting.
With an atmospheric pressure of 105 Pa, a temperature around 20 ‚ó¶C and
a wavelength of 600 nm, the equations show the following approximated

8.7. Optical Long-Range Incremental Position Sensors
827
partial derivatives in [‚ó¶C‚àí1] and [Pa‚àí1]:
‚àÇnT,P,Pv
‚àÇT
‚âà1¬∑10‚àí6,
‚àÇnT,P,Pv
‚àÇP
‚âà2.8¬∑10‚àí9,
and
‚àÇnT,P,Pv
‚àÇPv
‚âà3.6¬∑10‚àí10.
This means that the indicated traceable uncertainty of one part in 108 ap-
proximately corresponds to environmental changes of 3.7 Pa total pressure,
10 mK temperature and 27 Pa partial vapour pressure. The value of 27 Pa
partial vapour pressure is about 1 % of the saturation vapour pressure of
water of 2.4¬∑103 Pa. It is clear that of these factors the temperature has the
largest eÔ¨Äect and a temperature diÔ¨Äerence of only 1 mK already gives an
error of 1 nm over 1 metre of optical path length.
With slow moving systems in a thermally controlled environment it is often
possible to determine the refractive index of air at only one location inside
the machine by means of a wavelength tracker. This element consists of
a separate interferometer with a measurement retro-reÔ¨Çector at a Ô¨Åxed
mechanical position relative to the interferometer. Any measured phase
changes of this interferometer can then only be caused by refractive index
changes of the air by the temperature, pressure and humidity.
Fast moving machines however create so much turbulence inside the ma-
chine that, next to an accurate thermal control, also the airÔ¨Çow around the
moving object needs to be controlled. The air needs to Ô¨Çow faster than the
maximum velocity of the moving object in order to avoid mixing of air with
diÔ¨Äerent temperatures due to warm objects like actuators.
This airÔ¨Çow necessitates fast blowing air showers with temperature sta-
bilisation of better then 1 mK for nanometre range errors. The additional
complication of these measures, on top of other requirements like the maxi-
mum allowable vibration forces exerted by the turbulent air, is one of the
reasons for applying encoders instead of laser interferometers in these ap-
plications.
When working in vacuum, these problems do not occur and under that condi-
tion laser interferometers are well suited for the most critical requirements,
for instance with stages for EUV lithography wafer scanners. Also in space
instrumentation distance measurements with laser interferometers is often
the best solution, especially when long distances between satellites have to
be measured.

828
Chapter 8. Measurement in Mechatronic Systems
8.7.2.4
ConÔ¨Ågurations
Several practical conÔ¨Ågurations are applied in laser interferometry. The
examples shown all apply to heterodyne interferometry because of their
application in complex multi-axis measurement systems and the possibility
to direct the beams by virtue of their diÔ¨Äerent polarisation.
The Ô¨Årst example from Figure 8.84 is the most simple heterodyne interfer-
ometer conÔ¨Åguration possible. It is a single-axis single-pass interferometer
and instead of applying Œª/4 plates to direct the light to a detector at another
location the detector is placed aside of the laser source. To prevent colliding
laser beams it uses two cube-corner retro-reÔ¨Çectors.
The light from the source enters at the upper half of the polarising beam
splitter where one of the frequencies is reÔ¨Çected and one is transmitted
based in their polarisation direction. One cube-corner serves as reference
mirror and shifts the beam to the other half of the polarising beam splitter.
The other cube-corner serves as measurement mirror. It prevents wavefront
errors, which would otherwise be caused by angular movements and also
shifts the measurement beam to the other half of the polarising beam split-
ter. In this way the return path does not collide with the entry path and a
detector can be placed next to the laser source.
It should be noted that instead of a cube-corner also a right angle prism
can be used in this conÔ¨Åguration for the reference beam. The main beneÔ¨Åt
of a cube-corner in this conÔ¨Åguration is its insensitivity for rotation in any
direction when mounting the element. A right angle prism needs to be
mounted suÔ¨Éciently well that the reference beam will be pointed at the
Measurement
¬õ
Referene Retr¬õ
Polarising Beam Spli'er
1
2
1
1
1 ¬±f
From Laser
To 
f
f
f
f
1 ¬±f
f
f
2f
2f
2f
Figure 8.84: Basic single-pass heterodyne interferometer with two cube-corner
retro-reÔ¨Çectors to shift the beams and prevent sensitivity for tilt.
Note: The rays are shown shifted and the positions are only indicative.
The polariser before the detector is not shown.

8.7. Optical Long-Range Incremental Position Sensors
829
same location as the measurement return beam.
The measurement retro-reÔ¨Çector always needs to be a cube-corner to avoid
shifting of the beam and the creation of non-coplanar wavefronts due to
angular motions.
Dual-Pass Plane-Mirror Interferometer
The dual-pass plane-mirror interferometer as shown in Figure 8.85 has
been developed to enable measurements in more directions with multiple
interferometers by replacing the cube-corner with a plane mirror. When the
mirror is large, this conÔ¨Åguration allows a displacement of the mirror in a
perpendicular direction to the measurement direction without aÔ¨Äecting the
measurement. This conÔ¨Åguration uses one Œª/4 plate and two cube-corners
at the interferometer. The reference beam follows the same path as with the
Measurement
plane mirror
Reference Retr¬õ
Polarising Beam Spli'er
From Laser
To photo detector

¬õ
Quarter wave plate
1
2
1
1 ¬±f
f
f
f
f
2f
2f
2f
1 ¬±2f
f
1 ¬±2f
f
1f 
Tilt
¬ô`/
Figure 8.85: Basic dual-pass heterodyne interferometer with two cube-corner retro-
reÔ¨Çectors to shift the beams and a plane-mirror as moving element.
One Œª/4 plate changes the polarisation of the measurement beam,
causing it to be reÔ¨Çected at the polarising beam splitter and follow a
second trajectory to the moving mirror. The lower image shows the
eÔ¨Äect of tilting of the measurement mirror on the trajectory of the
measurement beam. Also here the polariser before the detector is not
shown.

830
Chapter 8. Measurement in Mechatronic Systems
Figure 8.86: Tilting of the measurement mirror in a dual-pass plane-mirror inter-
ferometer causes the measurement beam to shift. As a consequence
the measurement beam and the reference beam will not completely
overlap, called ‚Äúbeam walkoÔ¨Ä‚Äù. Interference takes place only in the
overlapping regions.
single-pass interferometer but the measurement beam follows a diÔ¨Äerent
path. After the polarising beam splitter its polarisation is changed from
linear to circular by the Œª/4 plate and after reÔ¨Çection to the moving mirror its
polarisation is converted again in a linear polarisation by the Œª/4 plate but
now in the orthogonal direction. As a consequence, the measurement beam
will be reÔ¨Çected by the polarising beam splitter and the second cube-corner
and is directed a second time towards the moving mirror. In this second
trajectory, its polarisation will be converted via circular to the original lin-
ear polarisation direction enabling it to pass through the polarising beam
splitter and interfere with the reference beam.
The dual-passing means that a movement of the mirror gives a double phase
shift and double Doppler eÔ¨Äect on the measurement beam. The related
interferometer constant equals four, which is confusing with the general
wording of this interferometer as a dual-pass type. The ‚Äúdual-pass‚Äù refers to
the fact that always at least the distance between the object and interferom-
eter has to be passed twice in both directions. The measurement signal will
hence be double sensitive to the movement, because of the interferometer

8.7. Optical Long-Range Incremental Position Sensors
831
constant N = 4, and as mentioned in the previous section this also requires
a higher split frequency to be able to perform a high velocity measurement.
Next to this increased higher sensitivity for movements in the measurement
direction and insensitivity for large movement in the orthogonal directions,
also the sensitivity for tilt of the measurement mirror is zero for small rota-
tions. This can be seen by following the dashed rays in the lower drawing of
Figure 8.85. The ray, returning after the Ô¨Årst reÔ¨Çection will be tilted with
double the tilt angle of the measuring mirror.
The four reÔ¨Çections on the polarising beam splitter and the cube-corner will
return the beam for the second trajectory with the same double tilt angle as
after the Ô¨Årst reÔ¨Çection and the second reÔ¨Çection will add that same amount
of tilt but now in the opposite direction. The result is an unchanged optical
path length of the measurement beam.
Although the optical path length is not changed, the measurement beam
to the photo detector shows a lateral displacement of the rays, called beam
walkoÔ¨Ä(BWO).
With the tilt angle œët in radians [rad] and the measurement mirror at a dis-
tance dm from the interferometer the beam walk oÔ¨Äis equal to the following
expression:
BWO = 4¬∑ dmœët
[m].
(8.98)
Tilting is only allowed as long as the rays are all kept inside the interferom-
eter, because of this beam walkoÔ¨Ä, and as long as the reference beam and
the measurement beam will suÔ¨Éciently overlap to induce interference. Fig-
ure 8.86 shows the eÔ¨Äect of the beam walkoÔ¨Äon the interference eÔ¨Éciency.
The part of the beams that do not overlap will give a DC irradiance signal
to the sensor and with increased beam walkoÔ¨Äthe AC interference part will
become relatively smaller.
By increasing the diameter of the beams a larger tolerance on tilt is al-
lowed, forcing the application of large optical parts. These parts are however
extremely expensive, because of the optical requirements on Ô¨Çatness and
wavefront errors.
Wavefront Distortion
A very important factor related to beam walkoÔ¨Äis the inÔ¨Çuence of wave-
front distortion. Figure 8.87 shows the situation where two beams interfere.
Often the measurement beam suÔ¨Äers most of wavefront distortion but in
principle both beams can be distorted. For this example the measurement

832
Chapter 8. Measurement in Mechatronic Systems
Reference
beam
wavefront
Measure
beam
wavefront
Beam overlap (1)
Beam walko` (2)
(1)
e
(2)
e
Figure 8.87: A distorted wavefront of the measurement beam relative to the refer-
ence beam causes an average phase change œÜe of the light, resulting in
a diÔ¨Äerent measured position. When this distortion shifts outside the
reference beam by beam walkoÔ¨Ä, this diÔ¨Äerence is no longer present,
causing an error in the measured displacement.
beam shows a not perfectly Ô¨Çat wavefront and as a consequence the interfer-
ence between both beams is also no longer perfect, changing the measured
phase relation by the average amount of wavefront deviation. As long as
this deviation is constant, independent of the displacement of the measure-
ment mirror, there is no problem as the system measures a displacement by
relative measurements and the phase contribution of the wavefront error
is equal in any position, which means that it cancels out. This cancella-
tion is however not the case when the overlap of the beams changes by
the displacement of the measurement mirror. In that case the distorted
wavefront can shift outside the other beam, causing a diÔ¨Äerent phase contri-
bution of the wavefront distortion with a corresponding error in the position
measurement.

8.7. Optical Long-Range Incremental Position Sensors
833
8.7.2.5
Multi-Axis Laser Interferometers
It was mentioned that plane-mirror interferometers allow movements in
the orthogonal direction of the measurement direction. This enables their
use in measurements of solid objects like a wafer stage of a wafer scanner
in more directions.
Figure 8.88 shows the lay out of the three degree of freedom wafer stage
from the front page of this book. One interferometer is used for the y dis-
placements and two interferometers are used for the x displacement.
The diÔ¨Äerence between both x measurements is a measure for the rotation
around the Rz axis. This rotation can only be small in view of the remarks
made previously regarding beam walkoÔ¨Äbut still it is suÔ¨Écient for its use
in wafer scanners. By expanding the measurement mirror in the z direction
a full 6-axis measurement system can be realised as will be presented in
Chapter 9.
As a last example, the 3-axis x‚àíy‚àíz measurement system from Figure 8.89
shows the possibilities to direct the light to any measurement location. It
also incorporates a fourth measurement branch with a wavelength tracker
that enables to determine the refractive index changes of the air by temper-
ature or pressure.
x -interferometer
To signal processing
y-interferometer
x-mirror
y-mirror
To signal processing
Laser
33 - 66 % 
'
x - y - R 
stage
x -interferometer
¬û¬Å{¬¥'
To signal processing
1
2
z
Figure 8.88: With three plane-mirror interferometers measurements can be done
in three directions while x1 and x2 deÔ¨Åne both the x displacement and
a rotation Rz around the z-axis.

834
Chapter 8. Measurement in Mechatronic Systems
z-interferometer
Receiver
y-interferometer
Beam bender
33 % 
'
Beam bender
Beam bender
Receiver
Receiver
Beam bender
¬Ç¬Å¬¥'
Plane mirror
¬õ
x-interferometer
Laser source
Wavelength
tracker
Receiver
Plane mirror 
¬õ
Plane mirror 
¬õ
A
B
50 % 
'
Figure 8.89: A three degree of freedom x‚àíy‚àíz measurement system on a gantry
type of machining centre uses diÔ¨Äerent optical components to direct the
light to the measurement locations. The wavelength tracker enables
to compensate for refractive index variations. The metrology loop from
A to B is very long and indirect.
8.7.3
Mechanical Aspects
Position measurement is a relative measurement to a known reference.
With precision long-range measurements, the reference is often made from
thermally solid material mounted on a vibration free environment to prevent
any measurement errors that can occur by deformation of the reference. The
frame holding this stable reference environment is called a metrology frame
and this frame represents the ‚Äúsacred world‚Äù of the precision metrologist.
In Chapter 9 on wafer scanners, this metrology frame is shown to be solidly
connected to the lens in order to guarantee the positioning accuracy of the
image to the wafer. Next to this extreme precision application example, also
in other applications the metrology frame should be well connected to the
reference location, like the position of a work piece in a precision machining
centre. With single-axis positioning systems, this metrology frame can
be positioned quite close to the measurement location but with multi-axis
measurement systems like the gantry type conÔ¨Åguration of Figure 8.89 this

8.7. Optical Long-Range Incremental Position Sensors
835
is no longer possible.
With this conÔ¨Åguration, the metrology frame is not a separate frame but is
consists of the base and the complete gantry. The relative position measure-
ment from the moving part A to the solid table B is done in a very indirect
way, described by means of the metrology loop. The metrology loop is deÔ¨Åned
by the shortest path that carries information about the relative position of
two or more measurement locations and consists of a series of solid objects
measurably connected by position measurement sensors or a calibrated
sliding mechanism. In the example from the Ô¨Ågure, the metrology loop runs
from Position B via the table to the x-interferometer, which connects its
position information to the gantry. The metrology loop runs further through
the gantry to the z-interferometer, which connects the position of the gantry
to the moving part A. All the parts in the loop contribute to the total mea-
surement and as long as all properties of all parts in the entire metrology
loop are exactly known, no errors will happen. Unfortunately reality is far
from ideal and for instance imperfections in the sliding mechanism and
thermal eÔ¨Äects on the solid material inÔ¨Çuence the measurement, often in
an unknown and undesired way.
8.7.3.1
Abbe Error
One important source of errors is based on angular movements combined
with long arms. It was the German physicist Ernst Karl Abbe (1840 ‚Äì 1905)
who introduced the term Abbe error for these errors. He stated the following:
If errors in parallax are to be avoided, the measuring system must
be placed coaxially with the axis along which the displacement
is to be measured on the workpiece.
Based on this general statement it was concluded that either the displace-
ment measuring system should be in line with the object of which the
displacement is to be measured or the angular motions should be measured
separately in order to compensate the eÔ¨Äects. An example of such a solution
is shown in Figure 8.90. In this case the position of a point A on top of the
measurement mirror must be measured but it is not possible to direct the
laser beams coaxial with this position as the mirror needs to be moved also
in the z direction. In that case additional measurement beams can provide
information on the rotation angle around the x-axis.
It is extremely important to be aware that any error in this angular mea-
surement will be converted into a proportional error in the z measurement

836
Chapter 8. Measurement in Mechatronic Systems
1
2
3
e
d
x
z
y
A
ya
Input beam
To receivers
¬ã'
Quarter
wave plates
Cube corners
Measurement
beams, three axes
Figure 8.90: By measuring with multiple interferometer beams, the rotation
around the x, y and z axes can be measured. The Abbe error, caused by
the non-coaxial measurement with the surface plane e and a rotation
around the x-axis, can be compensated by the angular measurement
based on the distance d of two of the interferometer beams. A ‚Äúmono-
lithic‚Äù three axis interferometer of Agilent Technologies is shown that
can accomplish this measurement in one unit. It integrates three inde-
pendent plane-mirror interferometers with the high relative stability,
which is needed for a reliable angular measurement.
direction linearly depending on the distance ya to the point of interest. For
this reason the requirements on stability are even more extreme than for
the linear movements and it is always better, when possible, to measure as
good as possible in Abbe, as it is called in metrology terms.
The interferometer unit of Agilent Technologies clearly demonstrates the
complexity of such an interferometer as all optical parts are fully integrated
to guarantee a stable relation between the three further independent plane-
mirror interferometers. This integration of multiple optical components can
be done by means of adhesives but also direct optical bonding between the
polished surfaces is possible when these surfaces are suÔ¨Éciently Ô¨Çat. Only
by such a high level of integration the necessary accuracy in the angular
measurement can be achieved.
These principles are applied to the extreme in the wafer scanners of ASML,
which are presented as the closing application case of this book.

blank
left
intentionally
page
This

blank
left
intentionally
page
This

Chapter 9
Precision Positioning in
Wafer Scanners
Robert Munnig Schmidt
Introduction
In Chapter 1 the invention of the Ô¨Årst waferstepper, the Silicon Repeater
of Philips Electronics was memorised. This machine was designed for the
purpose of realising the complicated structural lay-out of an integrated
circuit and its successors at ASML1 became an important factor in the
worldwide proliferation of electronics, because of its capability to expose an
image of a reticle on a wafer with very small details. The smallest details in
an integrated circuit are called features and their minimum size is mainly
determined by the resolution of the optical exposure system as indicated
by the Critical Dimension (CD). In Chapter 7 it was explained that the
resolution of an optical system is determined by the wavelength Œª of the
light, the Numerical Aperture (NA) of the lens and a k1-factor, which mainly
is determined by the illumination system. With these variables the critical
dimension was shown to be equal to:
CD = k1
Œª
NA
[m].
(9.1)
1Several of the Ô¨Ågures in this chapter and the background information is gracefully provided
by ASML, market leader in lithographic exposure systems for the semiconductor industry.
839

840
Chapter 9. Precision Positioning in Wafer Scanners
This resolution is a theoretical value that is inÔ¨Çuenced by the surrounding
pattern. The wave character of the light creates an airy-disk Ô¨Åeld proÔ¨Åle
of the diÔ¨Äraction limited feature and the ‚Äúringing‚Äù around the peak will
add vectorial to the airy-disk Ô¨Åeld proÔ¨Åle of neighboring features. As a
result the CD of isolated features is diÔ¨Äerent from the CD of densely packed
features. Several deÔ¨Ånitions for the CD are used for this reason of which
one is chosen to be used further in this chapter, the half-pitch CD. Other
than with isolated features, the half-pitch CD refers to a regular grating of
lines and spaces of which the width of a line equals half the period (pitch).
Based on the basic formula for the CD, research and development on these
machines has always focused on the reduction of the wavelength Œª and the
k-factor and on maximising the NA. The need for a short wavelength has
resulted in a continuous development of light sources with ever smaller
wavelengths, starting with Mercury arc discharge lamps with 436, 405 and
365 nm wavelength, followed by excimer lasers that produce light with a
wavelength of 248 and 193 nm. The application of immersion by a water
layer between lens and wafer increased the NA by the higher index of refrac-
tion of water with a refractive index of ‚âà1.44 at 193 nm. This has increased
the practical value of the numerical aperture to ‚âà1.35 as explained in Sec-
tion 7.4.4.1. After many years of research at the writing of this third edition
the Ô¨Årst real production capable scanners with an extreme ultraviolet (EUV)
light source with 13 nm wavelength are shipped to customers. With EUV
light only catoptric optics with mirrors can be used, because no transparent
material exists for this short wavelength and the entire optical path should
be in vacuum. The improvements to the k-factor have resulted in the de-
velopment of several optical techniques to direct the illumination in such a
way that as many as possible diÔ¨Äractive orders of the image are captured in
the aperture of the lens as was explained in Section 7.4.4.
It was the required high numerical aperture, which originally forced the
industry to cover the wafer in parts and not as a whole. Exposing a large
surface with a high numerical aperture would only be feasible with ex-
tremely expensive lenses with a very large diameter. For that reason it
was assumed more aÔ¨Äordable to use a smaller lens and expose the wafer in
steps. Each separate exposed area is called a die and one die can contain a
multiple of integrated circuits. In practice the size of a die is determined
by the projection lens and with a waferstepper its size was approximately
18 √ó 18 mm square. Wafer steppers have remained the main method for
the most critical layers with the Ô¨Ånest details until circa 1998 when the
waferscanner entered the arena.
The principle of the waferscanner was introduced much earlier by the Amer-

9.1. The Waferscanner
841
ican company Perkin Elmer who applied a scanning principle in an exposure
system with a magniÔ¨Åcation of one from reticle to wafer. Although it re-
quired a reticle with the same size as the wafer it was a good solution for
the contamination and damage problems of the original exposure principle
at that time, which used a reticle in direct contact with the wafer. Like
with a document scanner, a light stripe exposes the reticle in a scanning
motion simultaneous with the wafer. Only in this case both wafer and reticle
are moving relative to the stationary light stripe. The waferscanners of
ASML were based on that same scanning principle while they applied the
demagnifying lens of the wafersteppers to achieve a better resolution.
9.1
The Waferscanner
Figure 9.1 shows in a very schematic way how the exposure of a silicon
wafer by a waferscanner takes place. The illuminator deÔ¨Ånes a light stripe,
called the slit with a certain width with an optimal Ô¨Åt to the projection lens.
Instead of using a stationary reticle, in a waferscanner the reticle is placed
on a reticlestage, which performs a scanning motion while the illumination
system illuminates only one part of the reticle simultaneously. The projec-
tion lens images the reticle on the silicon wafer, which also is placed on a
scanning positioning system, called the waferstage moving synchronously
with the reticlestage. The wafer is Ô¨Årmly clamped to a wafer table on the
waferstage by means of vacuum. The wafer table is also often called the
wafer chuck or just ‚Äúthe chuck‚Äù because it clamps the wafer tightly to the
moving stage. Smaller details can be deÔ¨Åned by a relatively large reticle
when compared with the scanners of Perkin Elmer, because of the four times
demagniÔ¨Åcation of the projection lens and the exposure of only one die simul-
taneously. The disadvantage of this demagniÔ¨Åcation is that the reticle has
to move four times as fast with corresponding high acceleration levels and
reaction forces. In spite of these dynamic drawbacks this demagniÔ¨Åcation is
necessary because of the complexity to create reticles with suÔ¨Écient quality.
The four times larger details enable the electron beam pattern generators
to realise the pattern including the assist features2, small details that are
added to the IC pattern to tweak the imaging and enhance the resolution
around corners and in area‚Äôs where a neighbouring detail is so close that
2It is beyond the scope of this book to enter deeper in the physics behind these assist
features that work by virtue of the wave character of the exposed light. The theory on these
resolution enhancement methods is a real Ô¨Åeld of experts working with highly advanced
modelling software.

842
Chapter 9. Precision Positioning in Wafer Scanners
Figure 9.1: Basic principle of a waferscanner exposure system. A small ‚Äúslit‚Äù of light
exposes a pattern on a transparent reticle and the pattern is imaged on
the wafer by a four times demagnifying projection lens. A simultaneous
movement of reticle and wafer results in a full image of the pattern on
the wafer. To cover the entire wafer, the scanning motion is repeated
with an intermediate stepping motion to the next die position. The size
of the die is increased by utilising the full width of the circular image
Ô¨Åeld of the lens and by maximising the scanning stroke.
short circuiting connections might occur.
The scanning exposure of the reticle has several advantages over the expo-
sure of a stationary reticle as is done in a waferstepper.
The Ô¨Årst advantage of scanning versus stepping is the averaging of small
image position errors. Every point on the reticle is exposed over the full
width of the exposure slit by the scanning motion and small image position
errors by the projection lens, present in one part of the slit, will compensate
an opposite error in on another part of the slit. If the errors are random
they average out.
The second advantage is related to the maximum size of the image Ô¨Åeld.

9.1. The Waferscanner
843
A lens made of round lens elements will have a circular image Ô¨Åeld where
all parts can be exposed with the same numerical aperture. Exposing a
wafer in circular regions is not very practical because in that case parts of
the wafer will not be exposed. Although hexagonal dies could Ô¨Åll the entire
surface this method is highly unpractical when such a die has to be Ô¨Ålled
with rectangular integrated circuits. For these reasons the die always has
a rectangular shape. With a waferstepper the rectangle has to Ô¨Åt in the
circular Ô¨Åeld and a square die will be the maximum surface that Ô¨Åts.
A waferscanner, which uses a slit with a limited height, can utilise a larger
part of the width of the image Ô¨Åeld to approximately 26 mm, without in-
creasing the size and cost of the lens. It even allows optimising the optical
image quality in the slit area. Further, in theory, the size of the image in
the scanning direction could be made inÔ¨Ånitely long but the required large
reticle would become extremely expensive. For that reason the die size in
the scanning direction is limited to approximately 32 mm.
9.1.1
Requirements on Precision
The critical dimension is one of the main drivers of precision in a waferscan-
ner. The continuous reduction of the critical dimension is almost like a law
of nature determined by Moore‚Äôs law.
The American chemist and physicist Gordon Earle Moore (1929), co-founder
of Intel, deÔ¨Åned his law in 1965 based on the observation that the number of
transistors on an Intel processor doubled every two years [66]. Although not
a real law of nature, this postulation has predicted the continuous exponen-
tial growth rate over almost four decades, with a corresponding ‚Äúshrink‚Äù of
the smallest details. The industry has organised itself so well in this respect
that they even use a jointly deÔ¨Åned roadmap, the International Technol-
ogy Roadmap for Semiconductors ITRS [46] from International Sematech,
which describes in full detail the expected developments of the diÔ¨Äerent
parameters that rule this market for a 15 years forecast.
Next to the critical dimension, the overlay is the second main driver for
precision. Overlay is the relative position of any pattern layer in respect to
the other layers and it should be as small as possible. As can be observed in
Figure 9.2, all layers need to be connected by a multitude of small conductive
pillars, the vias.
Errors in the overlay will impact both the electrical properties of the contacts
and the insulation and might even create short circuits.
The maximum allowed overlay value is strongly related to the critical di-
mension. Originally a maximum overlay in the order of 30 % of the critical

844
Chapter 9. Precision Positioning in Wafer Scanners
Via
Wire
Metal 1
Metal 1 Pitch
Via
Wire
Figure 9.2: Cross section of a modern integrated circuit illustrating the multitude
of interconnecting layers, which have to be positioned with strict
requirements on overlay.
(Courtesy of Semiconductor Industry Association. The International
Technology Roadmap for Semiconductors, 2009 Edition. International
SEMATECH:Austin, TX, 2009.)
The right image is a CMOS logic microprocessor IC of IBM.
(Courtesy of IBM Research)
dimension was suÔ¨Écient but recently the overlay requirements were aggra-
vated to a value below approximately 15 % of the CD.
This more severe relative overlay requirement is related to recently intro-
duced special exposure methods like double-patterning or double-exposure,
where lines are exposed in between the lines from a previous exposure cycle.
By slightly underexposing a pattern that can just be imaged by the lens,
the developed pattern shows smaller lines than spacings and it becomes
possible to expose another set of lines in between. These methods enable IC
manufacturers to extend the use of 193 nm wavelength light to ever smaller
dimensions, but it has simultaneously resulted in a strong increase in the
overlay requirements beyond Moore‚Äôs law, as can be seen in Figure 9.3.
The third factor of importance for precision is the productivity. The high cost
of these machines, mainly driven by the optics, requires an ever increasing
speed of operation in order to retain an acceptable return on investment for
the IC manufacturer.
The productivity is deÔ¨Åned in diÔ¨Äerent ways. The throughput of the machine
is the easiest measurable item and tells something about how many wafers

9.1. The Waferscanner
845
20
100
30
80
40
70
60
50
5
10
30
20
2
Logic 
NAND 
Flash
DRAM
Process Overlay Requirement [nm]
Resoluon  Half Pitch  [nm]
Figure 9.3: The requirements on overlay follow a trend that outpaces Moore‚Äôs law.
Soon all layers in an integrated circuit need to be positioned well within
a few nanometres.
can be exposed in one hour. On the other hand the productivity tells nothing
about how successful the exposures are and so for that reason the number of
good exposures per unit of time would be more meaningful for the customer.
Still for practical reasons the throughput is most frequently used during
the design of the machine.
In 2010 a throughput of more than 180 wafers per hour was the state of the
art. This value corresponds to 20 seconds per wafer, including loading and
unloading. The related extreme velocities and accelerations of the stages
and other robotic motion systems cause strong reaction forces with vibration
levels that easily could impair the critical dimensions by fading, lack of
contrast by vibrations during exposure.
All these factors result in a large set of requirements for the waferscan-
ner. The list in Table 9.1 only gives an overview of a selection of the most
important requirements that directly determine the precision positioning-
systems, the waferstage and the reticlestage. The values are approximated
as they are only meant to give an idea of the order of magnitude. Note
that the waferstage position error is divided in a low-frequency part, the
moving average (MA), causing overlay errors and the high-frequency part,
the moving standard deviation (MSD), which causes image fading.

846
Chapter 9. Precision Positioning in Wafer Scanners
Based on these requirements, this chapter focuses on the following important
aspects that determine these extreme performance levels and will pose new
challenges for future developments.
‚Ä¢ Dynamic architecture, preventing disturbing vibrations of the dynam-
ical sensitive parts.
‚Ä¢ Zero-stiÔ¨Äness stage actuation with Lorentz actuators to fulÔ¨Åll the
demands on dynamic performance.
‚Ä¢ Indirect relative position measurement between image and wafer with
alignment marks and long- range sensors.
‚Ä¢ Motion control, with both feedforward and PID-feedback control with
a high level of predictability of the plant dynamics.
Table 9.1: Main requirements on precision of the positioning systems in a wafer-
scanner. This list is updated to more recent data although still only an
indication of the real values.
Requirement
Approximate
value
Critical dimension (CD):
< 10 nm,
Overlay:
< 1 nm,
Wafer stage velocity, stepping:
> 2 m/s,
Wafer stage velocity, scanning:
> 0.5 m/s,
Reticle stage velocity:
> 2 m/s,
Wafer stage acceleration:
> 30 m/s2,
Reticle stage acceleration:
> 120 m/s2,
Wafer stage metrology error:
< 0.2 nm over 20 s,
Wafer stage MA in-plane position error (overlay):
< 0.5 nm,
Wafer stage MSD in-plane position error (fading):
< 2 nm,
Focus error:
< 50 nm,
Settle time:
< 5 ms.

9.2. Dynamic Architecture
847
9.2
Dynamic Architecture
One major rule in precision engineering is to Ô¨Årst prevent problems by
fully mastering the open-loop dynamics of the mechatronic system before
attempting to control its behaviour. For this reason, the dynamic architec-
ture of a waferscanner, as shown in Figure 9.4, is focused on keeping all
non-deterministic dynamic disturbances as good as possible separated from
the optical imaging system.
The Ô¨Årst sources of disturbances originates within the waferscanner itself
due to the large accelerations of the stages. Another important source of
disturbing forces are vibrations, which are caused by other equipment like
the large air conditioning, purifying and processing equipment in the wafer
fab, the usual name for a semiconductor factory.
These vibrations are reduced by a well designed dynamic structure consist-
ing of the mechanical frames, the use of a balance mass to absorb reaction
forces and a vibration isolation system to protect the most sensitive parts.
The basic mechanical structure of a waferscanner consists of several parts.
The Ô¨Årst part is the pedestal, a heavy and stiÔ¨Ästructure, which connects
the waferscanner with the Ô¨Çoor of the wafer fab. This Ô¨Çoor is typically
made from large steel bars and is not extremely stiÔ¨Ärelative to the mass
of the waferscanner. The pedestal is often made from solid concrete and is
located as low as possible on the fab Ô¨Çoor. In this way the pedestal eÔ¨Äectively
grounds the waferscanner on the compliant Ô¨Çoor structure and reduces the
impact of vibrations from inside the machine to the wafer fab.
All the modules of the waferscanner itself are built on a rigid base frame,
which is made of steel. This main structure of the waferscanner is directly
mounted on the pedestal without additional vibration isolation measures.
The projection lens is Ô¨Årmly held in the right position by the metrology
frame, which deÔ¨Ånes the measurement reference of the stages to the image
of the die. The metrology frame is connected to the base frame by means
of three air mounts, air cushion springs with a very low compliance, which
serve to reduce the transmission of base-frame vibrations to the metrology
frame.
The stages are moving in six degrees of freedom and are supported by the
base frame, either on air-bearings or by means of an active magnetic support.
The support of the waferstage in the vertical direction often consists of a
large air bearing, the air foot, which Ô¨Çoats on the Ô¨Çattened surface of a
large granite stone. Granite is a very stable material and often used for
this purpose in precision machines.

848
Chapter 9. Precision Positioning in Wafer Scanners
9.2.1
Balance Masses
The horizontal directions need to move with very high accelerations while
the vertical direction with the rotations have less stringent requirements on
acceleration. These high horizontal acceleration levels of the heavy stages
create reaction forces in the order of several kilo Newton. In the Ô¨Årst gen-
erations of waferscanners, these reaction forces were directed towards a
heavy force frame, which was mounted on the base frame separately from
the other more sensitive parts of the machine.
Although in that way it was expected that the mass of the force frame would
absorb these forces, the coupling of the resulting movements to the base
frame had caused many problems in practice. The remaining vibrations
sometimes excited the dynamics of the fab Ô¨Çoor and could disturb any other
equipment that was located nearby and they still reached the sensitive
parts inside the machine by transmission via the base frame through the
air mounts.
For that reason, it was decided in more recent generations of waferscanners
Metrology frame
Air mounts
Wafer stage
Recle stage
Granite stone
Reacon
forces
Machine pedestal
Balance
mass
Balance
mass
3000 N
6¬±
Base 
frame
Figure 9.4: The dynamic architecture of a waferscanner is based on two principles.
The Ô¨Årst is to create a vibration free environment for the projection
lens and metrology frame and the second is to reduce the vibrations to
this ‚Äúsacred reference‚Äù by balance masses and a well-tuned vibration
isolation system. In reality the balance mass of the waferstage includes
the granite stone that supports the waferstage.

9.2. Dynamic Architecture
849
that the reaction forces of the high acceleration x and y movements should
be absorbed by very heavy balance masses, which are not rigidly connected
to the base frame but horizontally guided on air bearings or compliant mech-
anisms.
The balance masses consist of a seismic mass that is directly connected to
the stator of the linear actuator that drives the stage. The actuation force
from the actuator drives both the stage and the balance mass in opposite
directions and causes the relative movement between the mover and the
stator of the actuator to become larger than would be the case when the
stator was connected to the force frame.
The Ô¨Årst consequence of this increased relative movement is an increase of
the induced EMF over the motor coils, requiring a higher maximum voltage
of the power ampliÔ¨Åers. The second consequence is the need for a longer
movement range of the linear actuator with the associated cost of larger
coils or magnet assembly.
By increasing the mass of the balance mass its maximum displacement
decreases proportionally and for that reason the mass is chosen much larger
than the mass of the stage. With a stage of 80 kg the balance mass can
have a mass of 500 kg or more. A large mass is also large in volume and
measures should be taken to guarantee that the balance mass will not touch
any other part of the machine during its movements. To guarantee the
consistent free movement of the balance mass measures are taken to keep
its average position in the middle of the moving range, compensating the
eÔ¨Äects of gravity and other non alternating forces working on the balance
mass. These measures either consist of a separate actuator with a low
stiÔ¨Äness kp feedback control or of a passive spring with a suÔ¨Éciently low
compliance to prevent excess transmission of vibrations to the base frame.
The method to absorbing reaction forces in a balance mass requires the
forces to act as good as possible in a horizontal plane through the centre of
mass. Any deviation from this ideal situation will result in a proportional
torque around the horizontal axes through the centre of mass with corre-
sponding vibration forces in the vertical direction to the base frame.
A well designed structure with balance masses has helped keeping the trans-
mission of internal vibrations to such a moderate level that the vibration
isolation system is able to further reduce these vibrations to the level that
is required to achieve the maximum imaging quality of the waferscanner.

850
Chapter 9. Precision Positioning in Wafer Scanners
9.2.2
Vibration Isolation
Figure 9.5 shows a rigid body diagram of the parts of the waferscanner that
determine the sensitivity for external and internal vibrations.
The main line of defence against disturbing vibrations is determined by the
transmissibility transfer function of the three air mounts with the combined
mass of the metrology frame and the lens. In principle the air mounts
consist of air cylinders with a large volume of which the pistons are guided
by means of air bearings. These bearings have a suÔ¨Éciently small air gap
that it is not necessary to apply the usual rubber bellows, which would
otherwise introduce an increased transmissibility at higher frequencies
by the intrinsic damping of rubber. The stiÔ¨Äness value of the three air
mounts together can be in the order of 105 N/m. With a combined mass
of the metrology frame and the projection lens of approximately 2500 kg,
the natural frequency with these air mounts is in the order of 1 Hz. The
relatively low stiÔ¨Äness causes a practical problem in relation to changes in
the mass of the isolated body. The total static sag of the spring by the mass
of 2500 kg would be equal to a quarter of a metre and a small variation
of this mass could lead to an unacceptable change in the position of the
Lens
Metrology frame
Base frame
Pedestal
Air mount
Air mount
Granite stone
#`
]/¬õ
#`
6¬±
with internal

Figure 9.5: The frames and springs that determine the sensitivity for external
vibrations. The transmission of vibrations from the fab Ô¨Çoor takes
place via three mass-spring systems in series. The stiÔ¨Äness of the air
mounts and the mass of the metrology frame and lens determine the
low-frequency limitation of the main vibration isolation element. The
stiÔ¨Äness of the connection between the lens and the metrology frame
determines a resonating eigenmode, which will increase the sensitivity
for vibrations at the corresponding eigenfrequency.

9.2. Dynamic Architecture
851
k
Velocity 
to Force
control loop
m
Floor
#
with mass 
¬§`



F
k
m
Floor
#
with mass 
6$
¬∏¬∏!!¬π¬π$
c
xf
xm
xm
.
Figure 9.6: Active ‚Äúskyhook‚Äù damping in a vibration isolation system avoids the
transmission of external vibrations through the damper. An absolute
velocity detector measures the velocity of the sensitive body relative to
an inert seismic mass and its output is used to exert a force opposite to
the velocity.
projection lens. For that reason this position in the vertical direction is
actively controlled by adapting the amount of air in the air cylinders to the
situation. An increased mass would result in a reduced volume with an
increased pressure in the air mount. The volume can be restored by adding
suÔ¨Écient air from an external source by means of an air valve that opens
and closes as function of the vertical position of the metrology frame.
The next problem with this system is the need for damping. At the nat-
ural frequency of 1 Hz the system will resonate, when excited with that
frequency by a force or a movement of the Ô¨Çoor. As explained in Chapter 3 on
transmissibility, a normal viscous damper like a rubber bellows introduces
an unwanted connection, increasing the transmissibility of these vibrations
at frequencies above the natural frequency. For that reason a skyhook active
damper is applied. Figure 9.6 shows the principle that is based on the
measurement of the ‚Äúabsolute‚Äù velocity, relative to a real quiet reference
as if the system is ‚Äùhooked to the sky‚Äú. In practice this quiet reference
consists of an elastically suspended seismic mass inside the velocity sensor.
A suitable sensor for this principle is the geophone as was described in the
previous chapter on measurement, which measures the velocity relative to
the seismic mass, but the velocity signal can also be obtained by integrat-
ing the signal of an accelerometer. The velocity signal is used to create a
proportional damping force, opposite to the velocity, by means of a Lorentz
actuator of which the force is only determined by the current and not by
the position. As a consequence this actuator has no stiÔ¨Äness, which would

852
Chapter 9. Precision Positioning in Wafer Scanners
10
z)
10
z[
10
z¬Ç
10
z,
10
0
10
1
10
¬Ç
Transmissibility  [abs]
10
z,
10
0
10
1
10
¬Ç
10
[
Frequency [Hz]
Low passive damping
$
High passive damping
Figure 9.7: The transfer function of the active skyhook damping shows an increased
attenuation of the vibrations in a frequency band starting at the eigen-
frequency of the mass-spring system.
otherwise add to the stiÔ¨Äness of the supporting mechanical spring k and
increase the transmissibility.
When writing down the equations of motion the transfer function of the
transmissibility can be determined:
m d2xm
dt2
= ‚àícs
d
dt(xm)+ k(xf ‚àíxm)
kgm/s2
.
(9.2)
where cs equals the control gain of the velocity loop.
With the Laplace transform of the diÔ¨Äerentiation, the transfer function of xf
to xm becomes:
xm
xf
=
k
ms2 + cs+ k =
1
m
k s2 + cs
k +1
.
(9.3)
With the known terms for the eigenfrequency œâ0 and damping ratio Œ∂ the
equation becomes:
xm
xf
=
1
s2
œâ2
0
+2Œ∂ s
œâ0
+1
.
(9.4)
This transfer function does not show the diÔ¨Äerentiating term in the nu-
merator, which represented the increased transmissibility in the transfer

9.2. Dynamic Architecture
853
function of a passive damper and as a consequence the Bode plot of Fig-
ure 9.7 shows clearly an increase in attenuation of the external vibrations,
approaching the level as would be obtained without damping.
Although this method of active damping is useful, one should never forget
that its performance is limited by the noise of the sensor. In principle the
sensor needs to detect only very small movements and any noise source will
insert an disturbing signal in the damping loop. In practice this reduces the
positive eÔ¨Äect of the active damping at low frequencies. In reality the power
spectral density of the noise is not equal for all frequencies. A piezoelectric
accelerometer with a charge ampliÔ¨Åer requires an additional integrator
to create an inertial based velocity signal. An integrator will amplify the
noise at very low frequencies more than at high frequencies due to the
feedback capacitor of the ampliÔ¨Åer. As was explained in Chapter 8 this is
especially problematic with excess noise (1/f ). Even though a direct inertial
velocity sensor like the geophone does not need an integrator, additional
ampliÔ¨Åcation at low frequencies might be necessary to achieve a Ô¨Çat velocity
response, suÔ¨Éciently below the natural frequency of the vibration isolation
system.
At several research institutes investigations show promising results in
the optimisation of the active part of vibration isolation systems. These
investigations include the active reduction of the stiÔ¨Äness of the connection
and a virtual connection of the position to a quiet reference. In spite of these
developments it is in practice still preferred to base the main part of the
vibration isolation based on a heavy mass and a compliant spring because
of the low-frequency noise and other dynamic problems in the sensors like
cross-coupling.
9.2.2.1
Eigendynamics of the Sensitive Parts
A large mechanical structure, like the metrology frame with the lens, in-
evitably shows several dynamic eigenmodes with their related eigenfrequen-
cies. Figure 9.5 shows springs between the lens and the metrology frame,
which represent the stiÔ¨Äness of the mutual connection. Even though this
connection is very stiÔ¨Ä, it still results in a signiÔ¨Åcant resonance with the
heavy lens. Also the optical elements inside the lens with their compliant
mechanical mounting determine eigenmodes, which might be excited by
external vibrations. The related eigenfrequencies are often in a rather
low-frequency range around 50 ‚Äì 100 Hz because of the large masses and
for that reason the vibration isolation system should work especially well in
that range.

854
Chapter 9. Precision Positioning in Wafer Scanners
The low amount of damping that generally is present in mechanical mounts
normally creates resonances with high Q levels that increase the vibrations
with a factor thirty or more. Even with a well controlled vibration isolation
system it is necessary to create additional damping to reduce the amplitude
at these eigenfrequencies. Damping in a mechanical mounting structure is
diÔ¨Écult to achieve with passive means because of the high stiÔ¨Äness of the
connection. With the related small movements it is almost impossible to
dissipate much energy in viscosity.
Smart Disk
Damping in stiÔ¨Äconnections can be created actively with actuators and
a suitable control scheme. The Piezoelectric Active Lens Mount (PALM)
of Figure 9.8 is an example that is used to dampen the eigenmode of the
connection of the projection lens with the metrology frame. Three of these
systems are required to create damping in six degrees of freedom.
The basic design of this system is the outcome of a research project at the
University of Twente by Jan Holterman [43] under the guidance of Rien
Koster who invented the smart-disk, which fulÔ¨Åls the key role in this system.
A smart-disk consists of a combination of a piezoelectric actuator and sensor
stacked on top of each other. In principle the sensor measures the forces
Actuator sensor stack
Compliant parallel 
guiding mechanism
Flexure hinges
Figure 9.8: An piezoelectric active lens mount with ‚Äúsmart-disks‚Äù, which consist
of a combined piezoelectric actuator and sensor. By measuring the
deformation a damping force can be generated in an active feedback
loop. (Courtesy of Jan Holterman)

9.2. Dynamic Architecture
855
that act on the stack and the actuator creates a displacement as function of
the applied voltage.
A feedback loop can be created from the sensor to the actuator. Integration
of the measurement signal in the loop (I-control) creates an eÔ¨Äect as if a
damper is inserted in series with the smart-disk according to the following
reasoning.
For damping the force needs to relate to the velocity of the vibrating lens.
When Fd(s) equals the force signal from the sensor in the Laplace-domain,
I-control will generate a displacement xd by the actuator:
xd = ki
s Fd(s)
[m].
=‚áí
sxd
Fd(s) = ki = 1
c
[m/N].
(9.5)
The force by the movement of the lens will generate a proportional velocity
of the actuator, which is the behaviour of a damper with damping coeÔ¨Écient
c = 1/ki in series with the controlled smart-disk.
Anti-Resonator or Tuned-Mass Damper
A second method to reduce vibrations due to eigenmodes is by connecting
an anti-resonator, also called a tuned-mass damper to the sensitive body.
An anti-resonator is a tuned mass-spring system, which is attached to the
sensitive body. The decoupling phenomenon of this additional mass-spring
system causes a typical combination of an anti-resonance and a resonance
in the transfer function from the excitation force to the sensitive body as
described in Section 3.2.5 of Chapter 3. The frequency where the transfer
function equals zero was shown to be:
fa = 1
2œÄ

ka
ma
[Hz],
(9.6)
where ka and ma are equal to the stiÔ¨Äness and mass of the anti-resonator.
The anti-resonance frequency fa is chosen equal to the undamped eigen-
frequency of the lens with its mounting stiÔ¨Äness. The combined transfer
function of the anti-resonator and the regular transmissibility for vibration
forces from the Ô¨Çoor to the movement of the lens via the air mounts is shown
in Figure 9.9. The Bode plot has been derived using the standard equations
of motion from Chapter 3 and it shows that the original resonance at 100 Hz
of this example is replaced by two resonances with a smaller magnitude
depending on the damping of the tuned mass.
The observed shifting of the resonance frequencies is especially useful when

856
Chapter 9. Precision Positioning in Wafer Scanners
 
10
z¬É
10
z¬Å
10
z)
10
z[
10
z¬Ç
Compliance [m/N]
 
 
100
Frequency [Hz]
Low damping
Undamped eigenmode
Medium damping
High damping
m
k
c
F
x
m
k
c
1
1
1
¬Ç
¬Ç
¬Ç
¬Ç{{
[{
¬É{
Figure 9.9: An anti-resonating tuned-mass damper replaces the original undamped
eigenmode of the lens with its support by two resonances and an anti-
resonance. At a certain value of c2 the magnitude of the resonances is
reduced in comparison with the situation without the anti-resonator.
the undamped system resonates in a frequency area where external distur-
bance peaks occur like for instance the 100 Hz hum from high power mains
supply units.
In those cases where the resonance frequency is not Ô¨Åxed it is also possible
to create an actively controlled anti-resonator. By changing the stiÔ¨Äness
with proportional feedback, the tuned-mass damper system can be adapted
to the right resonance frequency.

9.3. Zero-StiÔ¨Äness Stage Actuation
857
9.3
Zero-StiÔ¨Äness Stage Actuation
With the explanation of active vibration isolation a Lorentz actuator was
used to exert the damping forces. This actuator was chosen because a
Lorentz principle shows an almost ideal zero-stiÔ¨Äness behaviour, without
increasing the transmissibility for vibrations from the vibrating base frame
to the sensitive metrology frame.
In a similar way, also the requirements on the accuracy of the stages, with
their high level of velocity and acceleration, require the use of these zero-
stiÔ¨Äness actuators in order to completely avoid any elastic connection be-
tween the moving stage and the surrounding machine parts.
In a fundamental way, the positioning principle of the wafer- and reticlestage
is purely based on the second law of Newton, stating that the acceleration
of a body is proportional to the force and inversely proportional to the mass
of the body. As long as the forces are known and controlled, a body with a
known mass can be accurately positioned by a feedback controller as was
explained in Chapter 4 with the PD-control positioning of the optical disc
readout unit.
In the design of a stage of a waferscanner most of the eÔ¨Äort is invested in
full deterministic control of the forces acting on the moving body, consisting
either of the wafer or of the reticle on their supporting table. As long as
these bodies behave like a rigid body with predictable and reproducible
dynamics, the movement of the body is only determined by the forces acting
on it. With this reasoning, the term ‚Äúzero-stiÔ¨Äness‚Äù is only related to the
mechanical connection to sources of disturbing vibrations and it does not
refer the control stiÔ¨Äness. When zero-stiÔ¨Äness of the actuation is achieved,
the body will behave like an ideal inertial mass and the task of the control
system is to connect the stages as stiÔ¨Äas possible to the optical system.
More precisely stated, the control system needs to connect the reticlestage
as stiÔ¨Äas possible to a planned scanning trajectory, relative to the optical
system. Simultaneously the control system needs to connect the waferstage
as stiÔ¨Äas possible to the scanning image of the moving reticle.
The waferstage is mostly taken as example in the following sections but
the design principles are equally true for the reticlestage. The main diÔ¨Äer-
ence is the higher velocity and acceleration with reduced accuracy of the
reticlestage in respect to the waferstage.

858
Chapter 9. Precision Positioning in Wafer Scanners
9.3.1
Waferstage Actuation Concept
From all possible actuator types, only the mentioned Lorentz actuator almost
ideally complies with the zero-stiÔ¨Äness criterion. Piezoelectric actuators are
stiÔ¨Äby deÔ¨Ånition and reluctance based actuators have a negative stiÔ¨Äness,
which induces a comparable, however inverted, transmission of vibrations
as a positive stiÔ¨Äness. Unfortunately a simple Lorentz actuator oÔ¨Äers only a
small linear range. In order to solve this limitation, electronic commutation
was introduced in Section 5.2.5 of Chapter 5. The shown example of Fig-
ure 5.23 had a long set of three moving coils with a large magnet assembly
and in spite of the electronic commutation the range was still rather limited
because the coil set and magnet assembly both needed to have the same
length in the motion direction.
9.3.1.1
Waferstepper Long-Range Lorentz Actuator
With the design of the Ô¨Årst waferstepper an alternative two phase electronic
commutated Lorentz actuator was designed by one of the authors of this book
at Philips Research laboratories. This extended-range Lorentz actuator was
able to work without the above mentioned limitation and was applied in the
waferstages of all wafersteppers until the introduction of the waferscanner,
which required a better solution. Figure 9.10 shows the thinking steps that
have resulted in this design. It starts with a standard loudspeaker type
Lorentz actuator with the permanent magnet system as moving part. The
Ô¨Årst transformation step (1) is to divide the moving ferromagnetic yoke in a
moving outer part, which slides over the cylindrical inner part holding the
coil. This step reduces the moving mass and is allowed as still the permanent
magnet Ô¨Åeld is moving in respect to the coil, creating a dŒ¶/dx. The sliding
could be an air bearing but in the next steps the slider will be avoided.
Step (2) is the addition of an equal permanent magnet-coil set around the
common central yoke. This step increases the force at a certain current level
and becomes even more useful when the direction of both the permanent
magnetic Ô¨Çux and the current in the coil of one of the actuators is reversed
in step (3). The sliders are deleted in the step (4) because after step three
the Ô¨Çux of both permanent magnets can be shared. This step is essential
as now there is a symmetrical set of two permanent magnets connected by
one simple moving yoke, which moves above two coils that are enlarged in
the step (5) to give a larger range. Unfortunately the large coil will induce a
reluctance force acting on the moving part of the yoke due to the magnetic
Ô¨Åeld of the coil indicated with dashed arrows (6). This force drives the iron

9.3. Zero-StiÔ¨Äness Stage Actuation
859
1
2 
1 
2
1 
2 
1 
1 
2 
1 
2 
1 
2 
1 
1 -
1 +
2 +
1 -
2 +
1 +
2 -
1 
2 
1 
2 
1 
2 
1 
1 
2 
1 
2 
1 
2 
1 
1 
2 
1 
2 
1 
2 
1 
1 
2 
1 
2 
1 
2 
1 
1 
2 
1 
2 
1 
2 
1 
1 
2 
1 
2 
1 
2 
1 
Slider
1: Coil connected with a sliding centre yoke.
2: Take two to create symmetry.
3: Reverse 
4: Connect the stator.
5: Enlarge the coils.
6: &/¬ï
7: Short interleaved coils reduce reluctance force. 8: ]/¬Ç
9: Current in coil 2 is commutated.
10: Further moon is possible.
11: Increased force with two permanent magnet secons.
Current directed
away from reader
Current directed
towards reader
Figure 9.10: Design of a zero-stiÔ¨Äness Lorentz type actuator with long linear-motion
range by electronic commutation. The direction of the current in the
coils corresponds to a force on the moving part to the right. The curved
arrows indicate the direction of the permanent magnetic Ô¨Çux. The
dashed arrows at (6:) indicate the magnetic Ô¨Çux related to the current
in the coils.

860
Chapter 9. Precision Positioning in Wafer Scanners
x
y
Rz
Figure 9.11: The usual way of creating a three-axis positioning system is done by
stacking three single-axis stages on top of each other. The driving
forces are not directed to the centre of mass, resulting in unwanted
torques and rotations. For that reason this conÔ¨Åguration is not suitable
for fast stages with a high precision.
of the mover towards one of the outer positions where the reluctance for the
magnetic Ô¨Åeld of the coil is the least. This problem is largely reduced by
choosing shorter coils, which create a smaller magnetomotive force and by
applying electronic commutation as shown in step (7). The windings around
the ferromagnetic yoke consist of two coils, which are interlaced with an
alternating winding direction. This means that the Ô¨Årst section of coil one
is wound clockwise, followed by a clockwise wound Ô¨Årst section of coil two,
again followed by the counterclockwise wound second section of coil one,
and so on. With commutation, reversing the current direction at any coil,
the sections of that coil that are wound clockwise give a counter clockwise
current and the other way around. This is shown in steps (8 ‚Äì 10) for a
movement to the right. In principle the stator with the coils and the inner
ferromagnetic yoke can be made inÔ¨Ånitely long by adding more sections to
each coil and in step eleven also the moving part is shown to be multiplied
to increase the force.
The main problem of this conÔ¨Åguration is the eÔ¨Éciency, as the current has
to run through the entire coil, including those coil sections that are outside
the permanent magnetic Ô¨Åeld. This disadvantage could be solved by feeding
each coil section with a separate power ampliÔ¨Åer but that was not done in
the real system in order to avoid disturbing forces due to switching the coils
on and oÔ¨Ä. It also would require a lot of separate wires while otherwise one
actuator only needs four wires with two ampliÔ¨Åers to control the current in
a smooth way without disturbing switching moments.
The pulse-width modulated design principle of the applied ampliÔ¨Åers was
presented in Figure 6.70 of Chapter 6.

9.3. Zero-StiÔ¨Äness Stage Actuation
861
9.3.1.2
Multi-Axis Positioning
The diÔ¨Äerent directions in a waferstepper and scanner are deÔ¨Åned in a
metrological coordinate system that is oriented relative to the scanning
direction and the projection lens. The horizontal direction x equals the
stepping direction of the waferstage while y equals the scanning direction
in both wafer and reticlestage. The vertical direction z is directed according
to the optical axis of the projection lens while the rotations around the
translational axes Rx, Ry and Rz determine the remaining directions. In the
Ô¨Årst waferstepper, the described extended-range linear Lorentz actuator
only needed to provide movements in three directions in the horizontal
plane as the wafer was oriented parallel to the image on the wafer chuck
by mechanical means. The standard method at that time for multi-axis
positioning was to stack diÔ¨Äerent single-axis motion systems on top of
each other like shown in Figure 9.11. A three-axis stage, working in the
x‚àíy‚àíRz direction, generally consisted of two linear drives with a rotation
table on top. The driving force could never be directed towards the centre of
mass of the moving system, because of the stacking. The Ô¨Årst actuator had
to drive also the other actuators while only the last actuator was close to the
centre of mass of the moving stage. For this reason a diÔ¨Äerent conÔ¨Åguration
was chosen, named H-drive after the letter ‚ÄúH‚Äù of the alphabet, with one
linear actuator for the linear movement x and two linear actuators y1 and
y2 for the linear movement in the y direction, allowing a limited rotation Rz
by the diÔ¨Äerence of y1 and y2. Figure 9.12 shows this conÔ¨Åguration where
Y1
Y
X
2
Roller
bearings
Figure 9.12: Original 3-D sketch and photographic image of the Ô¨Årst waferstage
with electric linear actuators for a waferstepper in a H-conÔ¨Åguration.
The magnetic mover is supported by roller bearings, which run on rails
alongside of the coil sections while an air-bearing is used to support
the wafer chuck and mirror block, Ô¨Çoating over a Ô¨Çat granite stone.

862
Chapter 9. Precision Positioning in Wafer Scanners
the bearings consisted both of roller bearings to support the permanent
magnetic movers on the coil stator and the air foot, an air bearing Ô¨Çoating
on a Ô¨Çat granite stone surface to support the waferstage itself.
With later versions of the waferstepper many improvements were added to
this basic system with for instance three separate actuators to position the
wafer in the three remaining directions, z ‚àíRx ‚àíRy, which were needed in
order to guarantee the vertical position and Ô¨Çatness of the wafer relative to
the focal plane of the lens.
9.3.1.3
Long- and Short-Stroke Actuation
The single-stroke extended-range Lorentz actuator from the previous section
was suÔ¨Éciently accurate to serve in a waferstepper, which only had to stand
completely still at exposure. With the waferscanner, however, the exposure
takes place during a movement at a constant velocity. Furthermore the
increased requirements on resolution and overlay posed more severe re-
quirements on precision and acceleration. This necessitated the design of a
waferstage without the inherent drawbacks of the linear actuator that was
used in the waferstepper, like the remaining parasitic forces by the commu-
tation and the friction variations of the applied roller bearings. The solution
was to use a non-commutated short-stroke Lorentz actuator in cooperation
with a second actuator, the long-stroke actuator, as shown schematically
Short-stroke Lorentz actuators
Long-stroke actuators
Wafer 
chuck
y
y
x
1
2
Figure 9.13: Schematic presentation of a 3-axis long-stroke, short-stroke wafer-
stage in a H-drive conÔ¨Åguration. Both long-stroke and short-stroke
actuators work in the same plane through the centre of mass of the
wafer table. The rotation along the z‚àíaxis is achieved by the diÔ¨Äerence
in positioning of the y actuators.

9.3. Zero-StiÔ¨Äness Stage Actuation
863
R       S       T
R       S       T
Long-stroke high-power actuator
Mirror block with wafer chuck 
Air foot on granite stone
Figure 9.14: The waferstage of a waferscanner. The three-phase coil section with
ferromagnetic yoke of the powerful long-stroke actuator runs over a
permanent magnet stator. The mirror block is used to measure the
position of the waferstage with a laser interferometer.
in Figure 9.13. This long-stroke actuator is connected to the stationary
part of the short-stroke actuator and only needs to position this part in
such a way that the permanent magnet system of the short-stroke actuator
remains in the ¬±0.1 mm range around the centre of its range with the least
stiÔ¨Äness value. This conÔ¨Åguration allows the long-stroke actuator to oper-
ate at a reduced precision of only this same level of ¬±0.1 mm, even though
the precision of the short-stroke actuator needs to be on sub-nanometre
levels. The movements and vibrations of the long-stroke actuator are hardly
transferred to the sensitive wafer position because of the low stiÔ¨Äness of
the short-stroke actuator. For that reason it is allowed to use strong elec-
tronically commutated three phase actuators with ferromagnetic yokes in
the long-stroke actuation system as shown in Figure 9.14. This actuator
is optimised to force rather than to precision positioning and zero-stiÔ¨Äness
with a ferromagnetic yoke around the coils. This yoke will cause cogging
forces towards those positions where the reluctance for the permanent mag-
net Ô¨Åeld is the least. Cogging forces are perceived as heavy points when
moving the mover by hand over the total stroke. The advantage of the ferro-
magnetic yoke around the coils is the low reluctance path for the magnetic
Ô¨Åeld, which increases the motor constant of the actuator. This actuator
can easily transport the required cables, wires and water cooling tubes for
both the short-stroke coils and the coil section of the long stroke actuator
itself. Fortunately only the in-plane motions are large in a waferscanner,
so only those motions require a corresponding long-stroke actuator. The

864
Chapter 9. Precision Positioning in Wafer Scanners
x 
y
x,y,R -axis
short-stroke
actuators
z
x-axis long-stroke actuator
Top-view wafer stage with
!
z,R  ,R -axis short-stroke
actuators and gravity
compensators
'!
!$
z
x
y
Rz
Rx
Ry
Figure 9.15: The short-stroke actuators are integrated within the mirror block.
The actuation in the horizontal plane is done by Ô¨Çat Lorentz actuators
while the out-of-plane movements are provided by loudspeaker type
Lorentz actuators integrated with magnetic gravity compensators
without a ferromagnetic yoke to prevent non-linearity by reluctance
forces.
out-of-plane Z-axis motions, needed to keep the surface of the wafer in the
focal plane of the lens are realised by separate short-stroke actuators only,
as shown in Figure 9.15. These loudspeaker type Lorentz actuators are
designed without a ferromagnetic yoke in order to prevent reluctance forces
as was explained in Section 5.3 of Chapter 5. In order to cope with the con-
tinuous gravity force, which would require a continuous current through the
actuators with a correspondingly high power consumption, the z-actuators
are integrated with magnetic gravity compensators as shown in Figure 9.16,
which are designed by Sven Hol [42]. The almost constant force on the
mover in the upward direction is based on the magnetic attraction between
the stationary and moving permanent magnets. By carefully optimising
the shape and dimensions of the magnets it is possible to keep the stiÔ¨Äness
between mover and stator below a value of k = 300 N/m, which is required
for a low transmission of external vibrations.

9.3. Zero-StiÔ¨Äness Stage Actuation
865
Centre line
Outer stator magnet ring
Outer mover magnet ring
Inner mover magnet ring
Inner stator magnet ring
Mover
N
N
N
S
S
S
Figure 9.16: The integrated z-actuator with magnetic gravity compensator, based
on magnetic attraction between opposite magnetic poles and repelling
between equal magnetic poles. (Courtesy of Sven Hol)
9.3.2
Full Magnetic Levitation
The guiding of the long-stroke part of the H- conÔ¨Åguration waferstage is
mainly realised by means of air bearings. The air foot provides the support of
the heavy centre piece with the short-stroke actuator coils and is preloaded
by a closed area with vacuum between the air foot and the granite stone
to achieve a suÔ¨Écient stiÔ¨Äness. The long-stroke actuators themselves have
integrated air bearings, which are preloaded by the attracting magnetic
forces between the mover and the stator.
In future waferscanners with EUV light of 13 nm, air is not allowed in the
light path because it absorbs the light. For that reason these machines
are operated in vacuum. Although it is in principle possible to realise air
bearings in a vacuum chamber, by adding special measures to locally extract
the air, which escapes from the side of the air bearings, it is better to avoid
them. For that reason a long-stroke stage has been developed, which uses
an electromagnetic planar actuator, working in six degrees of freedom. Its
working principle is shown in Figure 9.17. A permanent magnetic plat-
form, consisting of a plurality of alternating permanent magnets, creates a
magnetic Ô¨Åeld with diÔ¨Äerent Ô¨Åeld directions. A current-carrying coil will
experience a force of which the direction depends on its position on the
magnetic table and the direction of the current. By using diÔ¨Äerent coils at
diÔ¨Äerent locations a conÔ¨Åguration can be created that is able to exert forces
and torques in all six degrees of freedom at any position of a free moving
stage, when combined with a suitable electronic ampliÔ¨Åer system.

866
Chapter 9. Precision Positioning in Wafer Scanners
N
S
N
S
N
S
N
S
N
N
S
N
S
S
N
S
N
S
N
S
N
S
N
S
N
S
N
S
N
S
N
S
N
N
S
N
S
N
S
S
S
N
S
N
S
N
N
S
N
S
N
S
N
F
F
I
I
F
B
Figure 9.17: The forces acting on a coil, positioned in the magnetic Ô¨Åeld above an
array of alternating permanent magnets. Depending on the position
in the Ô¨Åeld, the forces can be in-plane, perpendicular or a combination
of both.
9.3.3
Acceleration Limits of Reticle Stage
The continuous increase of the acceleration levels of reticlestages poses
several challenges, which are increasingly not trivial. The main issue is
that both the long-stroke and short-stroke actuator are essentially placed
in series, which means that they both need to deliver the same force. This
high force is especially problematic for the Lorentz actuator.
Like any other actuator also a Lorentz actuator has thermally determined
limitations in its force and power capability. The high power dissipation
in the resistance of the windings by the motor current must be removed
by means of a closed water circuit. At a certain level of heat per unit of
volume of the windings, the temperature of the windings will reach the
maximum value that the insulation can sustain, determined by the heat
conductivity of the windings and the cooling circuit. The volume of the
windings is proportional to the size of the moving permanent magnetic
part of the actuator, which leads to a maximum in the amount of force
per unit of moving mass of the actuator itself. This speciÔ¨Åc peak force of a
Lorentz actuator is approximately 650 N/kg and corresponds to the maximum
acceleration that the actuator could realise without the mass of the actuated
body. A direct consequence of this relation is that the total moving mass of
the stage becomes noticeable larger than only the mass of the actuated body
that carries the wafer. For the required maximum acceleration of 120 m/s2
as mentioned in Table 9.1, the mass of the actuator is still below 50 %
of the mass of the actuated body and this can as yet be provided without
much problems, but when more acceleration is needed in the future, the

9.3. Zero-StiÔ¨Äness Stage Actuation
867
200
400
600
800
0.5
1
1.5
2
2.5
3
0
100
200
300
400
500
600
%!/|¬ö¬°!$¬á
¬°
|¬°¬á
2
Figure 9.18: All electric actuators have a limitation in the amount of force per unit
of moving mass of the actuator itself, the speciÔ¨Åc peak force. With a
given mass that has to be actuated, an increase of the acceleration
would require an increase of the mass of the actuator. When following
the graph for a certain maximum speciÔ¨Åc peak force it shows that the
relative added acceleration Ô¨Çattens out at an increasing ratio between
the mass of the actuator and the actuated mass to an acceleration
value equal to the maximum speciÔ¨Åc peak force.
total mass will rapidly increase. For this reason, present developments on
the stages focus on the reduction of the moving mass by the application of
hollow structures with thin plates and reinforced plastics. Unfortunately
this mass reduction does not only have beneÔ¨Åts as the sensitivity for external
disturbing forces by transmission is increased. The counterbalancing eÔ¨Äects
of the mass with on the one hand the need to decrease the mass in order
to increase the maximum acceleration and on the other hand the need to
increase the mass in order to reduce the sensitivity for external disturbing
forces is called the mass dilemma of precision positioning systems. In other
words: ‚ÄùA reduced mass requires improved system dynamics, which enable
a higher control bandwidth to compensate for the increased sensitivity for
external vibrations‚Äú.

868
Chapter 9. Precision Positioning in Wafer Scanners
9.4
Position Measurement
Several position measurement systems are applied in waferscanners. The
following list mentions the most important ones:
‚Ä¢ The alignment system, which measures the position of the wafer rela-
tive to the waferstage with sub-nanometre accuracy.
‚Ä¢ The level sensor, which measures the surface proÔ¨Åle of the wafer
relative to the waferstage with nanometre accuracy.
‚Ä¢ Long-range laser interferometers or encoders for real-time incremental
position measurement of the stages relative to the metrology frame
with sub-nanometre accuracy.
‚Ä¢ Capacitive sensors for small relative measuring distances and ranges
like the vertical position of the reticlestage relative to the metrology
frame with nanometre accuracy.
‚Ä¢ Optical proximity detectors for surface measurement of the wafer with
nanometre accuracy.
‚Ä¢ Conventional encoders for less critical measurements like the in-
ternal position measurement of the long-stroke actuators with sub-
micrometre accuracy.
‚Ä¢ State-of-the-art encoders for extreme-precision measurements of very
small displacements with an accuracy of several picometres, which
are used to measure the relative position of optical elements inside
the projection lens.
The most important and complicated measurement in a waferscanner is
related to the overlay, the position of the previously exposed layers on the
wafer relative to the image of the reticle. The complication in this metrology
loop from image to previous layer is based on the fact that this measurement
consists of several relative measurements of which some are not possible
in real-time. The main cause for this problem is that the projection lens
closely covers the part of the wafer that is exposed, thereby preventing any
direct measurement of the image and the previous layer at that location.
The only alternative to a direct measurement is an indirect measurement
where the position of the previous layers on the wafer and the image location
are separately measured relative to a suÔ¨Éciently stable reference with a
well-known position in the waferscanner. This reference is the real-time

9.4. Position Measurement
869
measured waferstage. The 6-axis incremental position measurement of the
stages is continuously available and deÔ¨Ånes the connection between the
stages and the metrology frame, the central reference that is connected to
the lens. This real-time measurement system is also used for the closed-loop
feedback control and synchronisation of the reticlestage and waferstage
with strict requirements on latency.
A consequence of this indirect measurement is the addition of all mea-
surement errors that occur during the diÔ¨Äerent measurement steps. This
addition can be calculated by means of the ‚Äúroot of the sum of squares‚Äù of the
errors, as explained in the Chapter 8 on measuring, but it requires that the
accuracy of all measurements have to remain well better than the overlay
speciÔ¨Åcation, in practice below one nanometre.
Fortunately the requirements on overlay of a few nanometres are only strictly
relative. There is no traceable relation with the standard metre other than
the order of magnitude. Traceability with a proven uncertainty level over
a long period of time is not important. All calibrations are related to the
previous layers on the wafer and only need to remain stable from the mo-
ment that the previous layer is measured relative to the waferstage until the
moment that the exposure is Ô¨Ånished. Furthermore underlining the relative
nature of the measurements is the fact that the wafer itself is not stable as
during the chemical processing at high temperatures the previously deÔ¨Åned
structures can be moved by deformation of the wafer. By measuring these
deformations both the magniÔ¨Åcation of the lens can be adapted and the
positioning of the stages can be made to accommodate to these deformations.
The following sequence of diÔ¨Äerent steps describes more in detail the total
measurement process from the location of the previous layer to the image
position:
1. The wafer is pre-aligned in the wafer handler with optical sensors to
measure the location of the Ô¨Çat edge or the notch at one location on the
side of the wafer that determines the basic orientation of the wafer.
2. A robot brings the wafer from the pre-alignment chuck to the wafer-
stage. The position of the vacuum gripper of the robot is alternately
referenced to the pre-alignment chuck and the waferstage by a kine-
matically determined mechanical connection. The total resulting po-
sitioning error of the wafer on the waferstage is approximately ten
micrometres.
3. The position of the previous layers on the wafer is measured by means
of alignment marks, which are deÔ¨Åned during the exposure of the Ô¨Årst

870
Chapter 9. Precision Positioning in Wafer Scanners
layer. The number of these reference marks can range from two till
the total number of dies. Similar alignment marks, called Ô¨Åducials,
are also stably attached to the waferstage, close to the wafer. The
alignment system measures the position of the alignment marks on
the wafer relative to the position of the Ô¨Åducials.
4. The waferstage with the aligned wafer moves to the projection lens
under real-time measurement relative to the metrology frame. The
position and focal plane of the image is measured relative to the wafer-
stage with a special image sensor. It is assumed that this information
remains stable during one or several exposure cycles.
5. The Ô¨Åducials of the waferstage are measured either to a reference
inside the lens or relative to alignment marks on the reticle through
the projection lens.
In the following subsections the alignment sensing principle, the measure-
ment of the focal plane and the real-time metrology loop with the long-range
incremental measurement systems will be presented.
9.4.1
Alignment Sensor
The principle of alignment with the alignment marks as reference for the
pattern on the wafer is shown in Figure 9.19. The alignment marks are
phase gratings and the measurement is comparable with the interferometric
encoder of Section 8.7.1.3.
The grating is illuminated with a laser and the phase steps with a height of
0.25Œª create diÔ¨Äraction orders mainly in the two Ô¨Årst orders. Both orders are
recombined at the photo detector after interfering with a second reference
grating. The interference irradiance depends on the phase relationship of
these orders. As was explained with the interferometric encoder, the phase
shift by the movement in the +1st order is opposite and equal in magnitude
to the phase shift of the ‚àí1st order, resulting in a doubling of the combined
diÔ¨Äerential phase shift, thereby increasing the measurement resolution
with a factor two.
The alignment is done by a scanning movement of the waferstage through
the range where optimal alignment should take place and the zero crossings
of the irradiance signal are measured. These zero crossings repeat with
every half grating period due to the doubling eÔ¨Äect of the two diÔ¨Äraction
orders, which limits the range of this alignment system to half a period of
the alignment grating, being 8 Œºm.

9.4. Position Measurement
871
Figure 9.19: The alignment marks are reÔ¨Çective phase gratings with diÔ¨Äerent
periodicity, to increase the capture range. One way to measure the
markers is shown at the right, where both Ô¨Årst orders are imaged on a
reference transparent phase grating and their disturbance is detected
by a sensor. This conÔ¨Åguration increases the position sensitivity with
a factor two. Note the alignment mark in the ASML logo.
This value is too small for the wafer handler to reliably position the wafer
inside the capture range of the alignment system. A misalignment of 8 Œºm
would mean that the entire exposure becomes erroneous.
To avoid this problem and increase the capture range, a Vernier principle is
applied by simultaneously measuring a second grating with a 10 % diÔ¨Äerent
grating period. The zero crossing of the irradiance by the two gratings will
only coincide in one on every ten periods of the irradiance signal of one
grating, increasing the range with a factor ten. In practice a capture range
of approximately 40 Œºm is adhered in order to avoid errors by outliers in
the measurement.
An interesting eÔ¨Äect of the phase grating is that the phase shift by the
displacement remains the same irrespective of the height of the grating.
As was shown with the interferometric encoder, the phase shift is only
determined by the ratio between the displacement and the grating period.
This implies that the position detection is not aÔ¨Äected by the height of the
grating. On the other hand, the irradiance in both 1st orders does depend
on the height of the grating with a maximum at a step height of 0.25¬∑Œª. At
a certain moment Chemical Mechanical Polishing (CMP) of the metal layers
was introduced in IC manufacturing to Ô¨Çatten the surface in order to achieve

872
Chapter 9. Precision Positioning in Wafer Scanners
a better focusing performance and it was feared at the time that this CMP-
process would erase the alignment marks. Fortunately it appeared that a
much shallower grating than the optimal value still provides just suÔ¨Écient
signal for alignment. With some additional measures on sensitivity of the
optical sensors the remaining phase diÔ¨Äerences over the Ô¨Çattened gratings
are still detectable with suÔ¨Écient accuracy.
9.4.2
Keeping the Wafer in Focus
The high numerical aperture, which is necessary for a better resolution,
automatically implies a decreased depth of focus (DOF) as was explained
in Chapter 7. The three dimensional structures on the surface of a wafer,
which are created during the many manufacturing process steps, have
made it increasingly diÔ¨Écult to guarantee a suÔ¨Éciently Ô¨Çat surface to
accommodate this continuously decreasing depth of focus of the projection
lens. Figure 9.20 shows the relation between the depth of focus and the
critical dimension. A focal error of less than 100 nm over a die of 25 mm
is a challenging requirement. To achieve such extreme speciÔ¨Åcations, this
problem is approached from two sides. The Ô¨Årst step is to guarantee a
certain Ô¨Çatness of the wafer. As previously explained the deposited metal
layers for the wiring are often treated by a CMP-process to keep the surface
non-planarity locally within acceptable levels to less than 50 nm over a die.
The second step to achieve a suÔ¨Éciently small focus error is to actively
position the wafer within the focal area at the region of the exposed die.
This process is also called the levelling of the wafer and with the Ô¨Årst
generations of the waferscanner the levelling was done by means of real-
time measurement of the wafer surface ahead of the lens during scanning.
This measurement was done by means of an optical triangulation method
250
200
150
100
50
0
Depth of focus (nm)
]/|¬á
100       90        80        70         65        57        50       45        38        32        26   
¬ã¬ã0/¬õ
Figure 9.20: The required depth of focus (DOF) as function of the critical dimen-
sion. After the introduction of immersion, the requirements were less
stringent.

9.4. Position Measurement
873
Piezoelectric
actuator
array

Figure 9.21: The image can be made better conform the local curvature of the
wafer by curving the image plane. This can be achieved by deforming
an optical element in the projection optics by means of piezoelectric
elements.
(courtesy of Chris Valentin)
like explained in Section 8.5.1.2 of the previous chapter on measurement.
A servo tracking feedback control system kept the surface approximately
parallel to the image in the focal plane. Unfortunately feedback control
can never prevent some remaining focal error due to the positioning system
dynamics and the limited control gain. A better solution was found to
determine the height proÔ¨Åle of the wafer prior to exposure and use that
information in feedforward control at exposure.
With a single waferstage a separate measurement of the surface topology of
the wafer would require a decrease in the productivity due to the additional
time for the measurement. The dual waferstage with parallel measurement
and expose cycles was designed to solve that problem (Boonman cs [13]) but
Ô¨Årst an example of active control of the curvature of a reticle is presented,
which uses piezoelectric actuators with compliant connections to create a
torque.

874
Chapter 9. Precision Positioning in Wafer Scanners
Piezoelectric
actuator
Horizontal
leaf spring
Intermediate
body
Compliance
Interface rods
Vacuum 
area
Opcal element
(b)
(a)
Chrome pa'ern
Opcal element
z
x
y
My
My
Figure 9.22: A torque on the edges of a Ô¨Çat plate will create a curved surface with
a well deÔ¨Åned radius. A piezoelectric actuator can deliver this torque
in combination with a compliant element.
(courtesy of Chris Valentin)
Wafer Curvature Correction on a Die
As a next step to achieve a better focus performance, research has been
done by Chris Valentin [88] from the Mechatronic System Design laboratory
at Delft University of Technology to use a curved focal plane instead of a
Ô¨Çat focal plane as shown in Figure 9.21. The double telecentric projection
optics in these systems allows to achieve the desired curvature correction
by active deformation of an optical element within the exposure system.
The importance of this kind of adaptive optics is expected to increase in the
following years to keep track of the continuous demands on focus.
A main requirement to obtain a well deÔ¨Åned radius over a Ô¨Çat plate is the
presence of a consistent torque over the width of the plate, which can only
be achieved by applying a torque on the edges of the plate as shown in
Figure 9.22. A piezoelectric element is stiÔ¨Äand for that reason it is without
special measures less suitable as a force actuator, which would be required
for exerting a pure torque. By adding a compliant spring and connecting the
actuator to the optical element by means of thin rods and use a multitude
of actuator sets it became possible to create an acceptable evenly spread
torque.

9.4. Position Measurement
875
9.4.3
Dual-Stage Measurement and Exposure
Productivity has been the main driver for the decision to design a waferscan-
ner with parallel processing of the measurement and the exposure cycle.
Next to the possibility to precisely measure all dimensional details of a
speciÔ¨Åc wafer without sacriÔ¨Åcing throughput, the increased utilisation of
the expensive lens is another important reason for this duplication of the
waferstage. With a dual waferstage the lens can expose one wafer during
the time that the other wafer is measured and as a consequence the lens is
continuously utilised. Figure 9.23 shows the process steps of a dual-stage
waferstage. The measurement cycle of one wafer is executed synchronous
with the exposure cycle of another wafer. As a result of the measurement,
the exposure starts with a wafer that is fully known in respect to the position
of the alignment markers to the waferstage and the height proÔ¨Åle of the
surface. This enables a maximum use of feedforward control.
Stage
Swap
Stage
Swap
Stage
Swap
Align
Recle
Exposure 
    cycle
Measurement 
       cycle
Align
wafer
Expose
Wafer
Load
wafer
Unload
Wafer
Map
wafer
Figure 9.23: The process steps in a dual-stage waferscanner between loading and
unloading consist of two cycles. In the measurement cycle the wafer is
aligned to the waferstage and the surface is mapped for focus. In the
exposure cycle the waferstage is aligned to the reticle and the wafer is
exposed.

876
Chapter 9. Precision Positioning in Wafer Scanners
9.4.4
Long-Range Incremental Measurement System
The long-range measurement systems in the wafer- and reticlestage have to
be able to track the position with the speciÔ¨Åed accuracy and velocity levels
without adding latency, which would reduce the accuracy of the synchroni-
sation between the waferstage and reticlestage.
Until the end of the last century only laser interferometer measurement
systems were capable of measuring large distances with nanometre level
resolution and a latency timing that neither limited the bandwidth of the
feedback control nor interfered with the synchronisation of the stages. Sam-
ple rates far above 20 kHz are presently state of the art and with suitable
synchronised phase detection electronics a large number of measurement
axes could be realised, which all worked in parallel.
Figure 9.24 shows the mirror block of a waferstage, showing the laser beams
that are used to realise a six-axis real-time measurement system.
A special conÔ¨Åguration is used to derive the z-axis measurement signal with
a 45¬∞mirror to direct the light upwards from the waferstage. The light is
reÔ¨Çected back by a stationary reference mirror, which is connected to the
metrology frame and returns via the 45¬∞mirror to the interferometer.
With this conÔ¨Åguration, the total optical path length of this beam is de-
termined both by the x and the z distance. By subtracting the directly
measured incremental x movement from another laser beam, the z position
is obtained.
The accuracy of laser interferometer measurement systems is strongly inÔ¨Çu-
enced by the refractive index of air according to the Edl√©n equation (8.95),
which was presented in Section 8.7.2.3 of the previous chapter on mea-
surement. The main problem with interferometer distance measurement
systems is that they measure over a long distance through air. At large
distances, small variations in the light velocity in air, which are induced
by the temperature and/or the pressure, can have a signiÔ¨Åcant inÔ¨Çuence
on the measurement. To keep the accuracy of the measurement on accept-
able levels, air showers are used to condition the air over the full optical
measurement path. The temperature of the air is required to be controlled
within about 1 mK stability over an exposure cycle. Furthermore the air
has to Ô¨Çow at a higher speed than the maximum speed of the stages in
order to prevent mixing of the conditioned air from the air showers with
air coming from elsewhere at a diÔ¨Äerent temperature. These requirements
have resulted in signiÔ¨Åcant developments, which always have just met the
required speciÔ¨Åcations. Still it is assumed that on the long run this method
will no longer be adequate and that also the high speed of the conditioned

9.4. Position Measurement
877
z -axis 
reference mirror
z -axis 
reference mirror
y-R -R -axis 
z
x
y
Rz
Ry
Rx
z
x
x-R -axis 
z
x-axis 
z-axis 
45  mirror
o
1
2
Figure 9.24: A mirror block for 6-axis position measurement by means of laser
interferometry. The z-axis is realised with a mirror under 45¬∞, which
reÔ¨Çects the light upwards to a reference mirror. All axes are dual
path plane mirror interferometers and Ry is determined from two z
interferometers.
air might excite dynamic resonances in the sensitive parts.
Fortunately another solution is found in a planar reÔ¨Çective-encoder system
with a phase grating, which measures in all six directions with a suÔ¨Écient
resolution to be applied as the long-range measurement system of a wafer-
scanner. This alternative has two advantages over the laser interferometer.
First of all the thermally induced refractive index changes have far less
eÔ¨Äect because of the short path through air of less than 15 mm. The thermal
sensitivity is reduced with a factor 100 to ŒîL/L = 2¬∑10‚àí8 per degree Kelvin.
The second advantage has to do with the stability of the real-time metrology
loop as is explained with the help of Figure 9.25.
9.4.4.1
Real-Time Metrology Loop
The real-time metrology loop is a subset of the full metrology loop, which was
deÔ¨Åned at the start of this section and contained also measurements that
were not performed in real-time. The real-time metrology loop assumes that
all alignment steps are done well and remain stable during the exposure.
This means that the real-time metrology loop connects the lens via the
metrology frame to the wafer on the waferstage.

878
Chapter 9. Precision Positioning in Wafer Scanners
Metrology frame
¬à$
#
0/$
6¬±
Metrology frame
0/$
6¬±
Mirror
< 15 mm
100-500 mm
¬ã/
Figure 9.25: Two methods for long-range incremental position measurement. The
laser interferometer, shown at the left has long been the standard but
is partly replaced by the plane encoder system as shown at the right.
The diÔ¨Äerence is seen in the length and stability of the metrology loop
and a reduction of thermally induced instability by refractive index
changes of air.
The Ô¨Årst measurement in this real-time metrology loop is the position of
the lens with respect to the metrology frame. As was shown previously the
connection between the lens and the metrology frame is not inÔ¨Ånitely stiÔ¨Ä
and can even contain active dampers to control vibrations. Separate optical
or capacitive sensors are applied to measure any small displacements of the
lens relative to the metrology frame, because of the insuÔ¨Écient stiÔ¨Äness.
The second measurement in the real-time metrology loop is the position
of the waferstage with respect to the metrology frame by the long-range
measurement system. With laser interferometers, the interferometer part
is Ô¨Årmly connected to the metrology frame at a distance from the optical
axis, determined by the maximum movement range of the waferstage. This
distance requires the metrology frame to be stable over the total distance
from the lens to the interferometer. In principle this problem can be solved
by adding a reference measurement axis from the interferometer to the lens
but that would increase the induced errors by the refractive index variations
of air due to this additional measurement.
With the planar encoder, the measurement grating, called the grid plate is
stationary mounted on the metrology frame and consists of thermally inert
material like Zerodur, a glass ceramic made by Schott with zero thermal
expansion in a limited temperature range. This approach both reduces
the length of the metrology loop through air and decreases the stability

9.4. Position Measurement
879
Figure 9.26: The combination of the H-conÔ¨Åguration with the laser interferometer
measurement system on the top and the plane encoder with the planar
actuation system at the bottom clearly illustrate the diÔ¨Äerences.
requirements of the metrology frame.
The last part of the metrology loop within the waferstage from the measure-
ment mirror to the wafer is quite simple and straightforward for the laser
interferometer option. The mirror block forms a ‚Äúmonolithic‚Äù structure with
the wafer chuck, which holds the wafer Ô¨Årmly attached on the wafer table by
vacuum and this monolithic structure is also made from a thermally inert
material like Zerodur.
The plane encoder version has a more complicated last part of the loop to the
wafer as the sensor part is located on the moving part of the waferstage. The
potential problems regarding stability of this part are solved by both fully
integrating all optical parts in one unit and by continuous calibration with
redundant measurement axes. In principle four sensors are used, which
each determine more degrees of freedom. The superÔ¨Çuous degrees of free-
dom are used to compare and calibrate all sensors at every exposure cycle.
Figure 9.26 shows the diÔ¨Äerent drive and measurement conÔ¨Ågurations for
comparison.

880
Chapter 9. Precision Positioning in Wafer Scanners
9.5
Motion Control
Figure 9.273 shows the basic principle of the motion control of the waferstage.
A modern control expert will miss elements like Multiple Input Multiple
Output (MIMO) controllers, observers and other more recently developed
control approaches.
It is true that the total controller itself consists only of six separate Single
Input Single Output (SISO) controllers for all directions with feedforward
and feedback paths. The feedback controller uses a well tuned classical
Proportional, DiÔ¨Äerentiating and Integrating PID-control algorithm.
The six-axis machine coordinate system for the position measurement and
the controller has its orientation at the centre of the image position because
this location is the important area where exposure takes place and to which
all precision is related. Unfortunately this is not the place where the centre
of mass of the waferstage, nor the actuators of the waferstage are located.
For that reason it is necessary to determine corresponding forces at the
centre of mass and the actuators that combine to the required control forces
at the exposure area. This transformation is done in two steps. First the six
Mechanics
Stage

GB
GS
ActuatorSystem
-
+
Posion
setpoint
Feedforward
control
¬à¬∫
Feedback
control
Fc
Fcom
F
+
+
¬à`
Figure 9.27: The position control of the waferstage is a SISO 6-axis PID-control
system. The gain-scheduling matrix (GS) transforms the control forces
(Fc) in six degrees of freedom, according to the machine coordinate sys-
tem into the forces (Fcom) of the waferstage coordinate system around
the centre of mass. The Gain Balancing matrix (GB) transforms these
forces into the actuator forces (Fa).
3The drawings in this section are kindly provided by Hans Butler, a research fellow from
ASML on dynamics and control and professor at Eindhoven University of Technology. To-
gether with Wilbert Simons from ASML he wrote a nice article on position control of these
machines [20]

9.5. Motion Control
881
control forces Fc are transformed by a gain-scheduling matrix operation into
the forces Fcom that should be exerted at the centre of mass of the positioning
stages. This is the optimal position to determine the dynamic response of
the stage, independent of its actual position. To cancel this inÔ¨Çuence of the
actual position, the gain-scheduling matrix is constantly adapted, hence
its values are scheduled to this actual position of the stage. The second
transformation is applied to determine the corresponding set points of the
actuator forces Fa by means of a Gain Balancing matrix operation. When
all calculations are done well the actuator forces are balanced such that
they optimally combine into the required forces at the centre of mass and
into the control forces at the exposure location. The gain balancing matrix
has to be well tuned to the physical hardware of the waferstage in order to
compensate for performance deviations due to tolerances in the diÔ¨Äerent
functional parts. In principle the gain balancing matrix is static although
it can be adapted by calibration to changes in the hardware.
The reason for this rather simple and straightforward approach with SISO
controllers is twofold. First of all this methodology allows a more direct
investigation of observed errors in the system. This shortens the time for
trouble shooting at the customer site, when the system has failed, or when
parts have been exchanged and the system should be tuned again. The
second reason is that the feedback part only plays a role in the robustness of
the control to deviations of the system parameters from the ideally modelled
situation as will be further explained in the following section.
9.5.1
Feedforward and Feedback Control
A property of feedback control is the fact that it needs an error to act anyway,
so it is allowed to say that Feedback is always (too) late. The related
delay manifests itself in the settle time, which is the time required to reduce
the eÔ¨Äects of an disturbing event to the speciÔ¨Åed maximum error.
Feedback should only be applied to correct errors that could not be avoided
by feedforward control due to random disturbances or uncertainties in the
properties of diÔ¨Äerent elements of the system. In the design of a waferscan-
ner the focus is on creating a dynamic system that behaves as deterministic
as possible, mainly because of the impact of settle time on throughput.
A small example of present state-of-the-art technology can place this re-
quirement in a some perspective.
Imagine a waferstage with the speciÔ¨Åcations as mentioned in the list of
Table 9.1, a mass of 20 kg, accelerating with 50 m/s2 to a maximum speed of
0.5 m/s. With these numbers the required force during acceleration becomes

882
Chapter 9. Precision Positioning in Wafer Scanners
0
0.05
0.1
0.15
-1
-0.8
-0.6
-0.4
-0.2
0
0.2
0.4
0.6
0.8
1
Time [s]
0.0025% Feedforward amplitude mismatch
-80
-60
-40
-20
0
20
40
60
80
Accpro%le [m/s ]
Wafer stage  error [m]
5 ms
{¬Å
Figure 9.28: The waferstage error as function of time induced by a mismatch of
0.0025% of the feedforward force when a well-tuned feedback is ap-
plied.
1000 N and the acceleration time takes ‚âà10 ms.
Assume that this situation is the result of a pure open-loop inertia-based
feedforward controlled system with a maximum error in the force of only
0.025 N (=0.0025 %!). Then a small calculation gives the following position
error after the 17 ms acceleration time.
Œµ = 0.5at2 = 0.5¬∑ 0.0025
20

10¬∑10‚àí32 ‚âà6.25 nm.
This is still a factor 12 above the required 0.5 nm level. This all clearly
indicates the need for an additional feedback control action to reduce the
remaining error and Figure 9.28 shows a realistic graph of the modelled
performance of a waferstage with a well-tuned PID feedback controller,
which illustrates the further improvement that is achieved. The feedback
control starts almost immediately after the beginning of the acceleration
proÔ¨Åle and keeps the overall error below 0.5 nm 5 ms after the acceleration
is terminated, which meets the speciÔ¨Åcations. This proof of the value of
feedback should however not be seen as a reason to reduce the requirements
for the feedforward control. When the accuracy of the feedforward control
action would for instance be reduced with a factor three than the ws error
by the blue graph would be increased with the same factor three and the
settle time to reduce the corresponding higher peak error also with a factor
three to almost 15 ms. This example reduction of the feedforward accuracy
with a factor three has the following consequences for the throughput of the
machine. An average 300 mm wafer has 100 dies so 100 times acceleration

9.5. Motion Control
883
and deceleration. The 10 ms additional settle time per scan would mean
approximately 1 second loss from the 20 seconds total exposure time of the
machine. This 5 % loss reduces directly 5 % of the customer value of the
waferscanner!
As the requirements become ever more strict over the years there are in
principle only two ways to reduce the settle time. The Ô¨Årst is to increase the
control bandwidth frequency. This however requires further improvements
on the mechanical dynamics, which were already assumed to be optimal,
and it is not expected that this can be easily improved without dramatically
further increasing cost. The only other solution that remains is by further
improved accuracy of the feedforward control system. When reducing the
impact of environmental disturbances or compensating them by sensors, the
further errors in the feedforward model are mainly caused by the actions of
the machine itself with for instance changing properties of the actuators
due to temperature. In practice a further error level reduction can only be
maintained by continuously calibrating the total system until the level that
it becomes an adaptive (learning) feedforward controller.
9.5.1.1
Thermal, The Final Frontier
Over the years thermal issues have always been a cause of errors. Already
mentioned is the inÔ¨Çuence on the measurement by laser interferometers in
air but meany other examples can be mentioned, mainly due to dimensional
changes by thermal expansion. In a waferscanner one of the most disturbing
eÔ¨Äects is on the wafer itself. It is a thin object with a large surface and pure
Silicon has a signiÔ¨Åcant coeÔ¨Écient of thermal expansion of ‚âà2.6¬∑10‚àí6 1/‚ó¶C.
This means that one degree temperature rise over a 30 cm wafer would
cause a displacement at the edge relative to the centre of approximately
400 nm. Two sources of heat are applied on the wafer during exposure, the
insertion of heat by the intense light for the exposure and the extraction
of heat by evaporation of the water, which is used for immersion. Both are
not uniformly applied and local deformations of the wafer will occur. To
cope with these eÔ¨Äects the wafer has always been clamped on the wafertable
by vacuum or more recently electrostatic forces, while the wafertable is
provided with small pimples to prevent height diÔ¨Äerences due to particles
and allow the vacuum to spread evenly around. These pimples are spaced at
distances of a few mm and the clamping force is suÔ¨Écient to prevent global
expansion of the wafer but with the ever increasing demands on overlay local
eÔ¨Äects play an ever larger role. One fortunate thing is that these thermal
eÔ¨Äects are relatively slow so they only aÔ¨Äect focus and overlay but a large

884
Chapter 9. Precision Positioning in Wafer Scanners
amount of eÔ¨Äort is continuously spent in modelling the thermal eÔ¨Äects in
a waferscanner of which the aforementioned wafer is only one of the areas
of attention. It is to be expected that these thermal eÔ¨Äects will be the Ô¨Ånal
limiting factor in the precision of these extreme mechatronic machines.
9.5.2
The Mass Dilemma
In Section 9.3.3 the mass dilemma was mentioned where a high mass helps
to reduce errors by transmitted vibrations from the environment but a
low mass is preferred to reduce power consumption and reaction forces
related to accelerations. One might think that a low mass construction will
enable to achieve an increased bandwidth, which would be necessary to
reduce the errors by transmission. Unfortunately this is not a fully correct
assumption as a reduced mass without reduced overall dimensions can
only be realised by a combination of thin structures. Those structures are
not always suÔ¨Éciently stiÔ¨Äin all directions to guarantee the required high
eigenfrequencies. Research is done at several places to compensate these
potentially harmful eigenmodes by means of overactuation. Overactuation
implies the use of more actuators than the number of coordinate directions
that have to be controlled. By optimising the placement of the actuators in
respect to the mode shapes, the excitation of the lower-frequency eigenmodes
can be avoided as presented by Schneiders, vd Molengraft and Steinbuch [78]
of Eindhoven University of Technology.
Another solution to the reduction of positioning errors caused by external
forces is to artiÔ¨Åcially increase the mass by means of acceleration feedback.
This method has been published by Hans Butler [17] from ASML. He utilises
a frequency range split in a feedback and feedforward path, allowing a less
severe requirement on a high bandwidth of the feedback part.

9.6. Future Developments in IC Lithography
885
9.6
Future Developments in IC Lithography
In an article in the Philosophical transactions of the Royal Society on ‚ÄúUltra-
precision engineering in exposure equipment for the semiconductor indus-
try‚Äù [67] the following statement was postulated as closure remark, which
is copied here as being equally valid for this book.
Cited:
At the time of the Ô¨Årst wafer stepper at Philips Research some thirty years
ago, experts were doubting the future of optical lithography systems, due to
the limitations in wavelengths and materials for lenses. Also then, people
were already wondering when it would become impossible to create isolated
structures in silicon at ever smaller sizes. Even nowadays, in spite of the
continuous proof of Moore‚Äôs law, this continues to be a key question in the
community, and Figure 9.2 showed an example how next steps are taken at
IBM to still make this miracle happen.
Will Moore‚Äôs law continue? The most probable answer is: ‚ÄúYes, when neces-
sary!‚Äù
This answer is based on the observation that another more technological law,
one might call it Moore‚Äôs second law, seems to be hidden behind his Ô¨Årst law
and that is:
When an invention is needed for a next step on the semiconductor
roadmap, it will be done!
Knowing that a single atom of silicon is about 0.25 nm diameter, it seems
still a long way before that size becomes a problem, but already now other
materials like ‚Äúgraphene‚Äù and photon switches start to open up new options
for further miniaturisation and increased performance of electronics. One
of those related interesting questions is, whether we will ever be capable of
utilising the full three dimensional space of a silicon wafer. Although many
circuits can be seen as a 2D+ structure, where sometimes even new active
layers are built on top of the other layers, ICs are still mainly two dimensional.
When this limitation is taken away, Moore‚Äôs law could continue without the
need for smaller details. In view of the related diÔ¨Éculties it is however not to
be expected that the present race into ever reÔ¨Åned structures will end in the
near future. The introduction of EUV lithography will enable further steps
until far into the next decade and inventions will be done to make this all
possible. Undoubtedly precision engineering and mechatronics continue to
play an important role in that future.

886
Chapter 9. Precision Positioning in Wafer Scanners
9.7
Main Design Rules for Precision
Next to the purpose of pin-pointing the important value of mechatronics for
a major technological development of this era, this chapter was written to
emphasise some important universal design rules. Following these rules
will help to achieve a high precision when designing high-speed production
systems like wafer scanners:
1. Know your problem. Keep short lines with your customer. Involve
the customer in design decisions and use intermediate solutions to
check the requirements. Make A.S.A.P. sure that the requirements
and speciÔ¨Åcations are clear.
2. Don‚Äôt create your own problem. Potential disturbance sources
should be solved at the source.
3. Know your hardware. The Ô¨Årst design goal is to deÔ¨Åne an extremely
well-balanced hardware concept that oÔ¨Äers the best possible determin-
istic dynamic behaviour of all systems combined. Mechatronics is an
integral approach on design.
4. Do not think that software solves your problem. Changes in
hardware are very expensive and time consuming but need to be done
when the performance is not suÔ¨Écient. In most cases software is only
capable to camouÔ¨Çage Ô¨Çaws in the hardware by introducing longer
waiting times.
5. Feedback only for robustness. Make maximum use of feedforward
control and use feedback only for robustness against real undetermined
error sources.
6. Measuring is knowing. Anything can only be precise when it can
be measured. This means that all aspects of the metrology loop need
to be fully mastered.
7. Timing is essential. Be aware of the timing of all elements in the
control loop. The latency in digital measurement systems can be
detrimental for a stable feedback loop.

blank
left
intentionally
page
This

blank
left
intentionally
page
This

Appendix
References and Recommended Reading
Besides the references in the text regarding used sources of information,
including PhD theses that can be freely downloaded on the internet, the fol-
lowing textbooks provide more in depth knowledge of the diÔ¨Äerent disciplines
within mechatronics.
On physics in general, including light and waves, the ‚ÄùFeynman Lec-
tures on Physics‚Äù by Richard P. Feynman, Robert B. Leighton and Matthew
Sands [31] are most suitable as it presents the diÔ¨Écult material in a clear
manner by examples and an understandable structure of the material.
The following books are a useful addition to the theory on mechanics of
mechatronic systems, because they present mechanisms, transmissions,
bearings and several other aspects of mechanical engineering that are not
presented in this book. The Ô¨Årst book is based on the practical experience
within the engineering departments of Philips Electronics on the dynamics
of mechanisms. The original was written in Dutch by Wim van der Hoek
and was known under specialists as ‚ÄúDes Duivels Prentenboek‚Äù, published
in parts in ‚ÄúDe Constructeur‚Äù over several years around 1980. Later the
complete work was reÔ¨Åned by Rien Koster in a printed book version. Recently
a fully re-written version [83] is published in English by Herman Soemers
from the University of Twente. The second book on mechanical design is
written by Anton van Beek [89] from Delft University of technology with an
emphasis on friction phenomena and bearings.
For dynamics the books by Ewins [30] on modal testing, the classic book
on vibrations by den Hartog [26] and the more recent book on vibrations by
G√©radin and Rixen [37] are highly recommended.
Regarding motion control, many books are available with an in depth
treatise of all aspects of control engineering and that directly connect with
889

890
References and Recommended Reading
the described methodology in Chapter 4, including the relations with the
physical aspects of the controlled plant. Especially several books written
by Karl Johan √Östr√∂m in cooperation with other authors like Tore H√§g-
glund [1,2], Bj√∂rn Wittenmark [4] and Richard M. Murray [3] are highly
recommended.
Two books by Gene F. Franklin and J. David Powell with Abbas Emami-
Naeini on feedback control [34] and with Michael L. Workman on digital
control [35] of dynamic systems are often used at university lectures, while
also the book of Oppenheim and Schafer on Discrete-time Signal processing
is worthwhile reading [70].
When more knowledge is needed on the physical theory and application
of electromechanics, dealing with all electromagnetic forces that work
on objects, the following three books gives these relations with examples
from engineering. The Ô¨Årst book on continuum electromechanics by James
R. Melcher [65] has more emphasis on physics, while the second book on
electromechanical systems and devices by Sergey Edward Lyshevski [63]
and third book on electric machinery by A.E. Fitzgerald, Charles Kingsley
Jr. and Stephen Umans [33] are more focused on the application in a
mechatronic environment including power ampliÔ¨Åers.
For piezoelectric actuators and sensors recently an excellent book is
published on piezoelectric materials and applications by Jan Holterman
and Pim Groen [44].
For electronics one widely recognised reference by Paul Horowitz [45]
covers both analogue and digital electronic circuit design.
For optics the book by Max Born and Emil Wolf [15] and the book by Eugene
Hecht [39] is frequently used as a reference.
For measurement, the book of John P. Bentley [6] has been frequently
used in the lectures.

Bibliography
[1] K. J. √Östr√∂m and T. H√§gglund. PID Controllers, Theory, Design and
Tuning. Instrument Society of America, 1995.
[2] K. J. √Östr√∂m and T. H√§gglund. Advanced PID Control. Instrument
Society of America, 2005.
[3] K. J. √Östr√∂m and R. M. Murray. Feedback systems: An Introduction for
Scientists and Engineers. Princeton University Press, 2008.
[4] K. J. √Östr√∂m and B. Wittenmark. Computer-Controlled Systems: Theory
and Design. Prentice Hall, 1996.
[5] J. Bardeen and W. Brattain. The transistor, a semi-conductor triode.
Physics Review Letters, 74:230 ‚Äì 231, 1948.
[6] J. P. Bentley. Principles of Measurement Systems. Prentice Hall, 2005.
[7] J. E. Bernard, A. A. Madej, K. J. Siemsen, and L. Marmet. Absolute
frequency measurement of the HeNe / I 2 standard at 633 nm. Optics
Communications, 187(January):211 ‚Äì 218, 2001.
[8] B. Binnig and D. P. E. Smith. Single-tube three-dimensional scanner
for scanning tunneling microscopy. Review of ScientiÔ¨Åc Instruments,
57(8):1688 ‚Äì 1689, 1986.
[9] K. P. Birch and M. J. Downs. An Updated Edl√©n Equation for the
Refractive Index of Air. Metrologia, 30:155 ‚Äì 162, 1993.
[10] K. P. Birch and M. J. Downs. Correction to the Updated Edl√©n Equation
for the Refractive Index of Air. Metrologia, 31(4):315 ‚Äì 316, 1994.
[11] H. S. Black. Stabilized feed-back ampliÔ¨Åers. Electrical Engineering,
53(January):114 ‚Äì 120, 1934.
891

892
Bibliography
[12] L. Blanken, F. Boeren, D. Bruijnen, and T. Oomen. Batch-to-Batch
Rational Feedforward Control: From Iterative Learning to IdentiÔ¨Å-
cation Approaches, With Application to a Wafer Stage. IEEE/ASME
Transactions on Mechatronics, 22(2):826‚Äì837, 2017.
[13] M. Boonman, C. vd Ven, S. Tempelaars, R. van Doorn, J. Zimmerman,
P. Teunissen, and A. Minnaert. The performance advantages of dual
stage systems: focus performance at high throughput. In Preedings of
the SPIE 5377, pages 742 ‚Äì 757, 2004.
[14] A. Borisavljevic. Limits, Modeling and Design of High-Speed Permanent
Magnet Machines. Phd thesis, Delft University of Technology, 2011.
[15] M. Born and E. Wolf. Principles of Optics: Electromagnetic Theory of
Propagation, Interference and DiÔ¨Äraction of Light. Cambridge Univer-
sity Press, 1999.
[16] A. G. Bouwer, G. Bouwhuis, H. F. van Heek, and S. Wittekoek. De
Silicon Repeater. Philips Technisch Tijdschrift, 37(11/12):349 ‚Äì 352,
1977.
[17] H. Butler. Acceleration feedback in a lithographic tool. Control Engi-
neering Practice, 20(4):453 ‚Äì 464, apr 2012.
[18] H. Butler. Feedforward signal prediction for accurate motion systems
using digital Ô¨Ålters. Mechatronics, 22(6):827 ‚Äì 835, sep 2012.
[19] H. Butler. Adaptive Feedforward for a Wafer Stage in a Lithographic
Tool. IEEE Transactions on Control Systems Technology, 21(3):875 ‚Äì
881, 2013.
[20] H. Butler and W. Simons. Position control in lithographic equipment.
IEEE Control Systems Magazine, October:28 ‚Äì 47, 2011.
[21] M. F. Byl, S. J. Ludwick, and D. L. Trumper. A loop shaping perspective
for tuning controllers with adaptive feedforward cancellation. Precision
Engineering, 29:27 ‚Äì 40, 2005.
[22] H. B. G. Casimir. Kanttekeningen bij een jubileum. Philips Technisch
Tijdschrift, 43(2/3/4):34 ‚Äì 36, 1986.
[23] R. R. Craig. Structural Dynamics - An Introduction to Computer Meth-
ods. John Wiley & Sons Inc., New York, 1981.

Bibliography
893
[24] E. Csencsics and G. Schitter. Parametric PID controller tuning for
a fast steering mirror. Proceedings of the 2017 IEEE Conference on
Control Technology and Applications (CCTA), 2017.
[25] M. Cui. Distance Metrology in Air with a Femtosecond Frequency Comb
Laser. PhD thesis, 2010.
[26] J. P. den Hartog. Mechanical Vibrations. McGraw-Hill‚Äû New York,
1956.
[27] B. Edl√©n. The Refractive Index of Air. Metrologia, 2(2):71 ‚Äì 80, 1966.
[28] J. D. Ellis.
Optical metrology techniques for dimensional stability
measurements. PhD thesis, Delft University of Technology, dec 2010.
[29] J. D. Ellis, K.-N. Joo, J. W. Spronck, and R.-H. Munnig Schmidt. Bal-
anced interferometric system for stability measurements. Applied
optics, 48(9):1733 ‚Äì 1740, mar 2009.
[30] D. J. Ewins. Modal Testing: Theory, Practice and Application, 2nd
edition. Wiley, 2000.
[31] R. P. Feynman, R. B. Leighton, and M. Sands. The Feynman Lectures
on Physics, boxed set: The New Millenium Edition. Basic Books, 2011.
[32] R. P. Feynman and A. Zee. QED: The Strange Theory of Light and
Matter. Princeton University Press, 2006.
[33] A. E. Fitzgerald, C. J. Kingsley, and S. Umans. Electric machinery.
McGraw-Hill, 2002.
[34] G. Franklin, J. D. Powell, and A. Emami-Naeini. Feedback Control of
Dynamic Systems. Pearson, 2009.
[35] G. Franklin, J. D. Powell, and M. L. Workman. Digital Control of
Dynamic Systems. Addison Wesley, 1998.
[36] A. Geim. Everyone‚Äôs Magnetism. Physics Today, 51(9):36 ‚Äì 39, 1998.
[37] M. G√©radin and D. Rixen. Mechanical Vibrations. John Wiley & Sons
Inc., 2 edition, 1997.
[38] R. F. M. M. Hamelinck. Adaptive deformable mirror based on electro-
magnetic actuators. PhD thesis, Eindhoven University of Technology,
2010.
[39] E. Hecht. Optics. Addison Wesley, 2002.

894
Bibliography
[40] W. Heisenberg. √úber den anschaulichen Inhalt der quantentheoretis-
chen Kinematik und Mechanik. Zeitschrift f√ºr Physik, 43(3-4):172‚Äì198,
1927.
[41] K. D. Hill, A. Peruzzi, and R. Bosma. CCT-K2 . 3 : NRC / NMi-VSL
bilateral comparison of capsule-type standard platinum resistance
thermometers from 13 . 8 K to 273 . 16 K. Metrologia, 49(1A (Technical
Supplement 2012)):1 ‚Äì 15, 2012.
[42] S. Hol. Design and optimization of a magnetic gravity compensator.
PhD thesis, Eindhoven University of Technology, 2004.
[43] J. Holterman. Vibration Control of High-Precision Machines with
Active Structural Elements. PhD thesis, University Twente, 2002.
[44] J. Holterman and P. Groen. An Introduction to Piezoelectric Materials
and Applications. Stichting Applied Piezo, 2013.
[45] P. Horowitz and W. Hill. The Art of Electronics. Cambridge University
Press, 1989.
[46] ITRS. International Technology Roadmap for Semiconductors. lithog-
raphy update. Technical report, International Sematech, 2012.
[47] L. Jabben. Mechatronic Design of a Magnetically Suspended Rotating
Platform. PhD thesis, Delft University of Technology, 2007.
[48] S. R. JeÔ¨Äerts, T. P. Heavner, T. E. Parker, and J. H. Shirley. NIST cesium
Fountains - Current status and future prospects. In Proceedings of
SPIE - The International Society for Optical Engineering, Volume 6673,
page Article nr: 667309, 2007.
[49] K.-N. Joo, J. D. Ellis, E. S. Buice, J. W. Spronck, and R.-H. Munnig
Schmidt. High resolution heterodyne interferometer without detectable
periodic nonlinearity. Optics express, 18(2):1159‚Äì65, jan 2010.
[50] K.-N. Joo, J. D. Ellis, J. W. Spronck, and R.-H. Munnig Schmidt. Real-
time wavelength corrected heterodyne laser interferometry. Precision
Engineering, 35(1):38‚Äì43, jan 2011.
[51] K.-N. Joo, J. D. Ellis, J. W. Spronck, P. J. M. van Kan, and R. H. Munnig
Schmidt. Simple heterodyne laser interferometer with subnanometer
periodic errors. Optics letters, 34(3):386‚Äì8, feb 2009.
[52] B. D. Josephson. Possible new eÔ¨Äects in superconductive tunnelling.
Physics Letters, 1(7):251‚Äì253, 1962.

Bibliography
895
[53] A. Katalenic. Control of reluctance actuators for high-precision posi-
tioning. PhD thesis, Eindhoven University of Technology, 2013.
[54] A. Katalenic, J. de Boeij, H. Butler, and P. P. J. van den Bosch. Lin-
earization of a current-driven reluctance actuator with hysteresis com-
pensation. Mechatronics, 23(2):163 ‚Äì 171, mar 2013.
[55] M. H. Kimman. Design of a micro milling setup with an active magnetic
bearing spindle. PhD thesis, Delft University of Technology, 2010.
[56] M. H. Kimman, H. H. Langen, and R. H. Munnig Schmidt. A miniature
milling spindle with Active Magnetic Bearings. Mechatronics, 20(2):224
‚Äì 235, 2010.
[57] S. Kuiper. Mechatronics and Control Solutions for Increasing the Imag-
ing Speed in Atomic Force Microscopy. PhD thesis, Delft University of
Technology, 2012.
[58] S. Kuiper and G. Schitter. Active damping of a piezoelectric tube
scanner using self-sensing piezo actuation. Mechatronics, 20(6):656 ‚Äì
665, 2010.
[59] L. Ljung. System IdentiÔ¨Åcation: Theory for the User. Prentice Hall,
1999.
[60] X. D. Lu and D. L. Trumper. High bandwidth fast tool servo control.
Proceedings of the 2004 American Control Conference, 1, 2004.
[61] X. D. Lu and D. L. Trumper. Ultrafast Tool Servos for Diamond Turning.
CIRP Annals Manufacturing Technology, 54:383 ‚Äì 388, 2005.
[62] S. J. Ludwick, D. A. Chargin, J. A. Calzaretta, and D. L. Trumper. De-
sign of a rotary fast tool servo for ophthalmic lens fabrication. Precision
Engineering, 23:253 ‚Äì 259, 1999.
[63] S. E. Lyshevski. Electromechanical Systems and Devices. CRC press,
2008.
[64] T. H. Maiman. Stimulated Optical Radiation in Ruby. Nature, 187(Au-
gust):493 ‚Äì 494, 1960.
[65] J. R. Melcher. Continuum Electromechanics. The MIT press, 1981.
[66] G. E. Moore. Cramming More Components onto Integrated Circuits.
Electronics, (38):114 ‚Äì 117, 1965.

896
Bibliography
[67] R. H. Munnig Schmidt. Ultra-precision engineering in lithographic
exposure equipment for the semiconductor industry. Philosophical
transactions. Series A, Mathematical, physical, and engineering sci-
ences, 370(1973):3950 ‚Äì 3972, aug 2012.
[68] R. Noyce. Semiconductor device-and-lead structure, 1961.
[69] T. Oomen. Learning in Machines. Mikroniek, 6:5‚Äì11, 2018.
[70] A. V. Oppenheim and R. W. Schafer. Discrete-time Signal Processing.
Pearson Higher Education, 3rd edition, 2009.
[71] H. Preston-Thomas. The International Temperature Scale of 1990
(ITS-90). Metrologia, 27:3‚Äì10,107, 1990.
[72] L. C. Rogers. Derivatives of Eigenvalues and Eigenvectors. AIAA
Journal, 8(5):943 ‚Äì 944, 1970.
[73] R. Saathof. Adaptive Optics to Counteract Thermal Aberrations - System
Design for EUV-Lithography with sub-nm Precision. PhD thesis, Delft
University of Technology, 2013.
[74] P. Schellekens, G. Wilkening, F. Reinboth, M. J. Downs, K. P. Birch,
and J. W. Spronck. Measurements of the Refractive Index of Air Using
Interference Refractometers. Metrologia, 22:279‚Äì287, 1986.
[75] G. Schitter. Improving the Speed of AFM by Mechatronic Design and
Modern Control Methods. Technisches Messen, 76(5):266 ‚Äì 273, 2009.
[76] G. Schitter, K. J. √Östr√∂m, B. E. DeMartini, P. J. Thurner, K. L. Turner,
and P. K. Hansma. Design and modeling of a high-speed AFM-scanner.
IEEE Transactions on Control Systems Technology, 15(5):906 ‚Äì 915,
2007.
[77] G. Schitter, P. J. Thurner, and P. K. Hansma.
Design and input-
shaping control of a novel scanner for high-speed atomic force mi-
croscopy. Mechatronics, 18(5-6):282 ‚Äì 288, 2008.
[78] M. G. E. Schneiders, M. J. G. van de Molengraft, and M. Steinbuch.
BeneÔ¨Åts of overactuation in motion systems. In Proc. American Control
Conf., pages 505 ‚Äì 510, Boston, 2004.
[79] K. Seto, I. Kajuwara, and A. Nagamatsu. Design of an optical servo
system using a structural optimization method in which controllability
is taken into account. In 66 th Symposium of the Japan Society of
Mechanical Engineers, 1989.

Bibliography
897
[80] K. Seto and S. Mitsuta. A new method for making a reduced order
model of Ô¨Çexible structures using unobservability and uncontrollability
and its application in vibration control. In 1st Int. Conf. on Vibration
and Motion Control, Yokohama, Japan, 1992.
[81] S. Skogestad and I. Postlethwaite. Multivariable Feedback Control:
Analysis and Design. John Wiley & Sons Inc., 1996.
[82] S. W. Smith. The Scientist and Engineer‚Äôs Guide to Digital Signal
Processing. California Technical Publishing, 1997.
[83] H. M. J. R. Soemers. Design Principles for Precision Mechanisms.
T-Point Print VOF, 2010.
[84] K. Teer. Terugkijken op ver zien: Televisietechniek van 1936 tot 1986.
Philips Technisch Tijdschrift, 43(2/3/4):37 ‚Äì 52, 1986.
[85] K. Thorborg, A. D. Unruh, and C. J. Struck. An Improved Electrical
Equivalent Circuit Model for Dynamic Moving Coil Transducers. In
AES Convention paper, Vienna, 2007. Audio Engineering Society.
[86] D. L. Trumper. A vibration isolation platform. Mechatronics, 12:281 ‚Äì
294, 2002.
[87] K. Uchino and S. Hirose. Loss Mechanisms in Piezoelectrics : How to
Measure DiÔ¨Äerent Losses Separately. IEEE Transactions on Ultrason-
ics, Ferroelectrics, and Frequency Control, 48(1):307 ‚Äì 321, 2001.
[88] C. L. Valentin. Curvature Manipulation of Photomasks, Enhancing the
imaging performance of immersion lithography equipment. PhD thesis,
Delft University of Technology, 2013.
[89] A. van Beek. Advanced Engineering Design - lifetime performance and
reliability. Tribos, 2012.
[90] M. van den Brink, H. Jasper, S. Slonaker, P. Wijnhoven, and F. Klaassen.
Step-and-Scan and Step-and-Repeat, a technology comparison. SPIE,
2726:734 ‚Äì 753, jun 1996.
[91] J. C. van Vessem. Van transistor naar IC: een lange weg?
Philips
Technisch Tijdschrift, 43(2/3/4):68 ‚Äì 76, 1986.
[92] C. Verbaan. Robust mass damper design for bandwidth increase of
motion stages. Phd thesis, Eindhoven University of Technology, 2015.

898
Bibliography
[93] B. P. Wang.
Eigensolution Derivatives for Arbitrarily Normalized
Modes. Shock & Vibration, 1(4):395 ‚Äì 399, 1994.
[94] J. J. C. Wei, Q. Zang, R. J. Allemang, and M. L. Wei. Correction of Ô¨Ånite
element models via selected physical parameters. In 13th Seminar on
Modal Analysis, Leuven, belgium, 1988.
[95] A. K.-K. Wong. Resolution Enhancement Techniques in Optical Lithog-
raphy. SPIE-The International Society for Optical Engineering, 2001.

Nomenclature
899
Nomenclature and Abbreviations
Nomenclature
a
m/s2
Acceleration.
A
[-]
Amplitude (General term).
A
[m2]
Surface of Cross Section (SCS).
Ac
[m2]
SCS of a coil.
Ac,w
[m2]
SCS of the windings in a coil.
Ag
[m2]
SCS of an air gap.
Ai
[m2]
SCS of the Ô¨Çux path inside a coil.
Am
[m2]
SCS of a permanent magnet.
Ao
[m2]
SCS of the Ô¨Çux path outside a coil.
Ay
[m2]
SCS of the Ô¨Çux path inside a yoke.
B
[T]
Magnetic Ô¨Åeld.
B
[Pa]
Bulk modulus (elasticity).
B
[T]
Magnetic Ô¨Çux density (MFD).
Bg
[T]
MFD in the air gap.
Bg,c
[T]
MFD in the air gap induced by current.
Bg,m
[T]
MFD in the air gap induced by magnet.
Br
[T]
Remnant MFD.
Bs
[T]
Saturation MFD.
Bw
[T]
MFD inside a coil winding.
By
[T]
MFD inside a ferromagnetic yoke.
cp
[m/s]
propagation speed.
c0
[m/s]
propagation speed of light in vacuum.
c
Ns/m

Damping coeÔ¨Écient.
cd
V/m

Deformation constant piezo accelerometer.
ci
6
Cs2/m
7
Charge sensitivity piezo accelerometer.
cv
6
Vs2/m
7
Voltage sensitivity piezo accelerometer.
C
[F]
Capacitor value.
Cfb(s)
[-]
Transfer function (TF) of feedback controller.
Cpd(s)
[-]
TF of a PD-type feedback controller.
Cpdt(s)
[-]
TF of a tamed PD-type feedback controller.
Cpidt(s)
[-]
TF of a tamed PID-type feedback controller.
Cff(s)
[-]
TF of a feedforward controller.
Cm
[m/N]
Mass compliance.
Cs
[m/N]
Spring compliance.

900
Nomenclature
Ct
[m/N]
System compliance.
Cd
[m/N]
Damper compliance.
CE
6
m2/N
7
SpeciÔ¨Åc compliance matrix (piezo).
d
[m/V]
Piezoelectric coeÔ¨Écient matrix.
D,D
C/m2
Electric Ô¨Çux density or displacement.
E,E
V/m

Electric Ô¨Åeld.
E
[Pa]
Multi dimensional elasticity modulus.
E
[J]
Energy.
EC
[J]
Energy contained in a capacitor.
Ek
[J]
Kinetic energy.
EL
[J]
Energy contained in an inductor.
Em
[J]
Magnetic energy.
Ep
[J]
Potential energy.
f
[Hz]
Spatial or temporal frequency.
f
[m]
Focal length.
f (f ),F(f )
[-]
Temporal frequency response function.
f (s),F(s)
[-]
Transfer function.
f (t),F(t)
[-]
Equation of motion.
f (œâ),F(œâ)
[-]
Angular frequency response function.
f0,1,2,...
[Hz]
Temporal natural, eigen- or corner frequency.
fa
[Hz]
Anti-resonance frequency of decoupling body.
fc
[Hz]
Unity-gain cross-over frequency.
fc
[Hz]
Centre frequency of dual laser beam.
fd
[Hz]
Doppler shift frequency.
fd
[Hz]
DiÔ¨Äerentiating corner frequency of D-control.
fi
[Hz]
Integrating corner frequency of I-control.
fm
[Hz]
Measured frequency.
fN
[Hz]
Nyquist frequency limit of sampling.
fp
[Hz]
Frequency of a photon.
fs
[Hz]
Switching frequency of SMPA.
fs
[Hz]
Split frequency of dual laser beam.
ft
[Hz]
Taming corner frequency of D-control.
F, F
[N]
Force vector or scalar.
Fa
[N]
Force of actuator.
Fb
[N]
Acceleration force of a body.
Fd
[N]
Force of a damper.
Fs
[N]
Force of a spring.
Fe
[V]
Electromotive force.
Fm
[A]
Magnetomotive force.
G(s),(œâ),(f )
[-]
Gain as TF/FRF.

Nomenclature
901
Ga
[-]
Voltage gain of (operational) ampliÔ¨Åer.
Ga,c
[-]
Closed-loop voltage gain of Op-Amp.
Ga,f
[-]
Feedback path voltage gain of Op-Amp .
Ga,l
[-]
Total loop gain of Op-Amp with feedback.
Ga,o
[-]
Open-loop internal voltage gain of Op-Amp.
Gv
[-]
Voltage gain of transistor.
Gt,ff(s)
[-]
Total TF with feedforward controller.
G(s),(œâ),(f )
[m/N]
Process Sensitivity as TF/FRF.
h
[-]
Planck‚Äôs constant.
hc
[m]
Winding height of a coil.
hc,g
[m]
Overlap winding height of a coil and air gap.
hg
[m]
Height of air gap in the motion direction.
H
A/m

Magnetizing Ô¨Åeld.
H
A/m

Magnetic Ô¨Åeld strength.
Hc
A/m

Coercitive magnetic Ô¨Åeld strength.
Hw
A/m

Magnetic Ô¨Åeld strength inside a coil winding.
I
[A]
Electric current.
I
W/m2
Intensity.
Ib
[A]
Base current of a transistor.
Ic
[A]
Collector current of a transistor.
Id
[A]
Diode current.
Ie
[A]
Emitter current of a transistor.
Ig
[A]
Gate current of a MOSFET.
Ii
[A]
Input current of an electronic circuit.
Il
[A]
Current in a load.
Im
[A]
Induced current by movement of actuator.
IN
[A]
Norton Equivalent current.
Io
[A]
Output current of an electronic circuit.
Ip, I‚àó,p
[A]
Peak value or amplitude of alternating current.
Ir
W/m2
Irradiance.
Ir,c
W/m2
Combined Irradiance.
Ir,i
W/m2
Irradiance of incident radiation.
Ir,r
W/m2
Irradiance of reÔ¨Çected radiation.
Is
[A]
Electric current from the source.
Jc
A/m2
Electric current density.
J
A/m2
Electric current density.
k
[1/m]
Angular wavenumber (2œÄŒΩ).
k
[1/m]
Angular wave vector (2œÄŒΩ).
k
N/A

Force-constant of actuator.
k
N/m

StiÔ¨Äness.

902
Nomenclature
kc
N/m

Gain of feedback controller at fc.
kd
N/m

DiÔ¨Äerentiating gain factor of D-control.
kf
N/m

StiÔ¨Äness of Ô¨Çexure spring.
ki
N/m

Integrating gain factor of I-control.
kn
N/m

Negative stiÔ¨Äness of plant.
kp
N/m

Proportional gain factor of P-control.
kpz
N/m

StiÔ¨Äness of piezoelectric actuator.
ks
N/m

Servo stiÔ¨Äness.
kt
N/m

Total gain over a series of control elements.
Ki
[-]
Interfering input gain.
Km
[-]
Modifying input gain.
Ki
N/m

Modal stiÔ¨Äness of eigenmode i.
Keff.i,k
N/m

EÔ¨Äective modal stiÔ¨Äness on DOF k.
‚Ñìc
[m]
Coherence length.
‚Ñìg
[m]
Length of the air gap.
‚Ñìi
[m]
Length of the Ô¨Çux path inside a coil.
‚Ñìm
[m]
Length of the magnet.
‚Ñìo
[m]
Length of the Ô¨Çux path outside a coil.
‚Ñìw
[m]
Wire length of a winding.
‚Ñìw,t
[m]
Total wire length of a coil in PM Ô¨Åeld.
‚Ñìw,a
[m]
Active part of the wire in a coil.
‚Ñìw,p
[m]
Passive part of the wire in a coil.
‚Ñìy
[m]
Length of the Ô¨Çux path inside a yoke.
L
[H]
Self inductance.
La
[H]
Self inductance of actuator.
L
W/m2sr

Radiance of a light source.
L(s),(œâ),(f )
[-]
Feedback loop TF/FRF.
m
[kg]
Mass.
ma
[kg]
Mass of anti-resonator.
mm
[kg]
Mass of mover.
M
[-]
MagniÔ¨Åcation.
M
W/m2
Radiant emittance.
M(s)
[-]
Transfer function of measurement system.
Mi
[kg]
Modal mass of eigenmode i.
Meff.i,k
[kg]
EÔ¨Äective modal mass on DOF k.
n
[-]
Number of, order of TF (integer).
n
[-]
Index of refraction.
N
[-]
Order number or interferometer constant.
NE
6
V2/Hz
7
Excess, Ô¨Çicker or 1/f noise .
NS
6
A2/Hz
7
Shot noise.

Nomenclature
903
NT
6
V2/Hz
7
Thermal noise.
ÀÜn
[-]
Normal vector on deÔ¨Åned surface.
p
[-]
Probability.
P
[Pa]
Pressure.
P
[W]
Power, Intensity.
P
[W]
Average power of alternating signal.
Pi
[W]
Illumination Power of a light source.
Pi,c
[W]
Total captured illumination power.
Pi,t
[W]
Total radiated illumination power.
Pl
[W]
Dissipated Power loss.
Pm
[W]
Mechanical Power.
Pp, P‚àó,p
[W]
Peak Power value of alternating signal.
Ps
[-]
Signal power, squared amplitude.
PL
[W]
Power to create a current in an inductor.
Pv
[Pa]
Vapour pressure.
Q
[-]
Quality factor.
Qm
[-]
Figure of merit.
q
[C]
Electric charge.
qe
[C]
Charge of an electron.
qi
[-]
Generalised or modal coordinate.
R
[Œ©]
Resistance.
Ra
[Œ©]
Resistance of the actuator.
Rc
[Œ©]
Characteristic impedance of a cable.
Rcs
[Œ©]
Current sensing resistor.
Rs
[Œ©]
Output resistance of the source.
Rs,c
[Œ©]
Output resistance of the collector source.
Rs,e
[Œ©]
Output resistance of the emitter source.
Rx,y,z
[rad]
Rotation around x, y, z axis.
R
A/Wb

Magnetic reluctance.
Rg
A/Wb

Magnetic reluctance of the air gap.
Ri
A/Wb

Magnetic reluctance inside a coil.
Rm
A/Wb

Magnetic reluctance of the permanent magnet.
Ro
A/Wb

Magnetic reluctance outside a coil.
Rt
A/Wb

Total magnetic reluctance of the Ô¨Çux path.
Ry
A/Wb

Magnetic reluctance of the ferromagnetic yoke.
s
[-]
Laplace variable.
S,S
[-]
Mechanical strain in piezoelectric material.
S,S
6
N2/W
7
Steepness of an actuator.
S(s),(œâ),(f )
[-]
Sensitivity as TF/FRF.
t
[s]
Time.

904
Nomenclature
tc
[s]
Coherence time.
T
[¬∞C]
Temperature.
T,T
[Pa]
Mechanical stress.
Tc
[¬∞C]
Curie temperature.
T
[s]
Period.
T(s),(œâ),(f )
[-]
Complementary Sensitivity as TF/FRF.
v
[m/s]
Velocity.
vp
[m/s]
Wave propagation or phase velocity.
vm
[m/s]
Motion velocity.
V
[m3]
Volume.
Vpm
[m3]
Volume of permanent magnet.
V
[V]
Potential diÔ¨Äerence, voltage.
Va
[V]
Voltage over an actuator.
Vb
[V]
Voltage at the bridge between two switches.
Vc
[V]
Voltage of carrier frequency.
Vb‚àíe
[V]
Transistor base-emitter voltage.
Vc‚àíe
[V]
Transistor collector-emitter voltage.
Vcs
[V]
Current sensing voltage.
Vc,a
[m3]
Active volume of a coil in a magnetic Ô¨Åeld.
Vd
[V]
Voltage over a diode.
Vg
[V]
Voltage of a geophone.
VC
[V]
Voltage by charge displacement in capacitor.
VL
[V]
Voltage by current change in inductor.
Vi
[V]
Input voltage of an electronic circuit.
Vm
[V]
Voltage by the movement of an actuator.
Vo
[V]
Output voltage of an electronic circuit.
Vsup
[V]
Power supply voltage.
Vp, V‚àó.p
[V]
Peak value or amplitude of alternating voltage.
VR
[V]
Induced voltage by a current in a resistor.
Vs
[V]
Voltage from the source.
Vt
[V]
Total series voltage in an electronic circuit.
Vth
[V]
Base-emitter threshold voltage of transistor.
VTh
[V]
Thevenin equivalent voltage.
x
[m]
Position, distance.
xd
[m]
Displacement.
xp, x‚àó,p
[m]
Peak value or amplitude of alternating position.
Y
[Pa]
Young‚Äôs modulus (elasticity).
Y E
[Pa]
Young‚Äôs modulus with constant electric Ô¨Åeld.
Z
[-]
Impedance.
Œ±
[-]
Proportionality value.

Nomenclature
905
Œ±
[-]
Inter-frequency ratio of a PID controller.
Œ≤
[-]
Current ampliÔ¨Åcation ratio of transistor.
Œ≥
[-]
EÔ¨Äective Ô¨Åll factor of coil windings.
Œ¥,Œî
[-]
Change, DiÔ¨Äerence.
Œµ
[-]
Control error.
Œµ
[-]
Mechanical Strain.
Œµ0
As/Vm

Electric Permittivity (EP) in vacuum.
Œµr
[-]
Relative EP, dielectric constant.
Œ∂
[-]
Damping ratio.
œë
[rad or ¬∞]
Geometric angle.
œëi
[rad or ¬∞]
Angle of incidence.
œër
[rad or ¬∞]
Angle of reÔ¨Çection.
œët
[rad or ¬∞]
Angle of refraction.
Œ∫
[-]
Coupling factor in coils.
Œª
[-]
Loss factor for magnetic stray Ô¨Çux.
Œª
[m]
Wavelength.
ŒªB
[m]
Bragg grating wavelength.
Œº0
Vs/Am

Magnetic permeability of vacuum.
Œºr
[-]
Relative magnetic permeability.
ŒΩ
[-]
Poisson ratio (elasticity)
ŒΩ
1/m

Wavenumber (inverse of wavelength).
œÜi
[-]
Eigenvector in eigenmode i.
œï
[rad or ¬∞]
Temporal and spatial phase or polar angle.
Œ¶
[Wb]
Magnetic Ô¨Çux or radiant Ô¨Çux (optics).
Œ¶e
[C]
Electric charge Ô¨Çux.
Œ¶m
[Wb]
Magnetic Ô¨Çux of magnet.
Œ¶w
[Wb]
Magnetic Ô¨Çux inside coil winding.
Œ¶w,t
[Wb]
Total magnetic Ô¨Çux over all windings.
Œ¶y
[Wb]
Magnetic Ô¨Çux inside a yoke.
œÅm
kg/m3
Mass density.
œÅr
[Œ©m]
Resistivity of material.
œÅq
C/m3
Electric charge density.
œÉ
[Pa]
Mechanical stress.
œÉx
[*]
Standard deviation of variable x with unit [*].
œÉr
S/m

Conductivity of material.
œÑ
[s]
Time constant, RC time.
œÑd
[s]
DiÔ¨Äerentiating time constant (D-control).
œÑe
[s]
Electrical time constant of actuator.
œÑg
[s]
Group delay.
œÑi
[s]
Integrating time constant (I-control).

906
Nomenclature
œÑt
[s]
Taming time constant (D-control).
œâ
rad/s

Angular frequency.
œâ0,1,2,...
rad/s

Angular natural, eigen- or corner frequency.
œâc
rad/s

Angular unity-gain cross-over frequency.
œâd
rad/s

DiÔ¨Äerentiating corner frequency of D-control.
œâi
rad/s

Integrating corner frequency of I-control.
œât
rad/s

Taming corner frequency of D-control.
Œ©
[sr]
Solid angle.
Œ©
V/A

Resistance.

Abbreviations
907
Abbreviations
AC
Alternating Current
ADC
Analogue-to-Digital Converter
AFM
Atomic Force Microscope
AO
Adaptive Optics
BIPM
Bureau International des Poids et Mesures
BJT
Bipolar Junction Transistor
BWO
Beam Walk OÔ¨Ä
CAD
Computer Aided Design
CAS
Cumulative Amplitude Spectrum
CD
Critical Dimension
CCD
Charge Coupled Device (Camera sensor)
CMMR
Common Mode Rejection Ratio
CMP
Chemical Mechanical Polishing
COM
Centre Of Mass
CPF
Cumulative Probability Function
CPS
Cumulative Power Spectrum
DAC
Digital-to-Analogue Converter
DC
Direct Current
DEB
Dynamic Error Budgeting
DFT
Discrete Fourier Transform
DOF
Depth Of Focus
DOF
Degree(s) Of Freedom
DSP
Digital Signal Processor
EMC
Electro-Magnetic Compatibility
EMF
Electromotive Force
EP
Electric permittivity
ESD
Electrostatic Discharge
FBG
Fibre Bragg Grating
FEM
Finite Element Method
FET
Field EÔ¨Äect Transistor
FFT
Fast Fourier Transform
FIR
Finite Impulse Response
FPGA
Field Programmable Gate Array
FRF
Frequency Response Function
FWHM
Full Width Half Maximum
GB
Gain Balancing
GS
Gain Scheduling

908
Abbreviations
GUM
Guide to the expression of Uncertainty in Measurement
HF
High Frequency
HP
High Pass (Ô¨Ålter)
IC
Integrated Circuit
IGBT
Insulated Gate Bipolar Transistor
IIR
InÔ¨Ånite Impulse Response
JCGM
Joint Committee for Guides in Metrology
LF
Low Frequency
LP
Low Pass (Ô¨Ålter)
LSB
Least SigniÔ¨Åcant Bit
LTI
Linear Time-Invariant
LVDT
Linear Variable DiÔ¨Äerential Transformer
MA
Moving Average
MEMS
Micro Electro Mechanical System
MFD
Magnetic Flux Density
MIMO
Multiple Input Multiple Output (control)
MMF
Magnetomotive Force
MOS
Metal Oxide Semiconductor (FET)
MSB
Most SigniÔ¨Åcant Bit
MSD
Moving Standard Deviation
NA
Numerical Aperture
NLTV
Non-Linear Time-Variant
OPD
Optical Path DiÔ¨Äerence
OPL
Optical Path Length
PALM
Piezoelectric Active Lens Mount
PCB
Printed Circuit Board
PDA
Personal Digital Assistant
PDF
Probability Density Function
PLL
Phase Locked Loop
PLZT
Lead Lanthanum Zirconate Titanate (Piezo)
PM
Permanent Magnet
PSD
Power Spectral Density
PSD
Position Sensitive Detector
PSF
Point Spread Function
PSRR
Power Supply Rejection Ratio
PVDF
Polyvinylidene Fluoride (Piezo)
PTFE
PolytetraÔ¨Çuoroethylene, TeÔ¨Çon
PZT
Lead Zirconate Titanate (Piezo)
PWM
Pulse Width Modulation
RMS
Root Mean Square

Index
909
SCS
Surface Cross Section
SISO
Single Input Single Output (control)
SMPA
Switched Mode Power AmpliÔ¨Åer
SNR
Signal to Noise Ratio
SPM
Scanning Probe Microscopy
STM
Scanning Tunnelling Microscopy
STP
Shielded Twisted Pair
TDM
Time Division Multiplexing
TF
Transfer Function
UTP
Unshielded Twisted Pair
VCO
Voltage Controlled Oscillator
VGM
Vector Gain Margin
WDM
Wavelength Division Multiplexing
WFE
WaveFront Error
Index
RC-time, 475
‚ÄúHooke ‚Äì Newton‚Äù law, 48
0 dB level, 120
Abbe error, 835
absolute standards, 686
acausal, 322
achromatic doublet, 632
adaptive feedforward control, 250, 350
adaptive optics, 668
afocal, 635, 636
Agile, 37
aging, 441
air foot, 847
air mounts, 847
air showers, 827, 876
air-gap, 371
Airy-disk, 662
Amp√®re‚Äôs law, 59
amplitude, 67
amplitude grating, 649
amplitude modulation, 722
analogue-to-digital, 321, 735
angular frequency, 67
annular illumination, 664
anti-aliasing, 321
anti-imaging, 322
anti-node, 92
anti-resonance, 115, 167
anti-resonator, 855
anti-windup control, 296
aperiodic damping, 147, 153
aperture plane, 629
aperture stop, 635
asphericity, 626
assist features, 841
Astigmatism, 625
asymptotically stable, 283
atomic force microscope, 245
attenuation-band, 474
avalanche breakdown, 502
azimuthal order, 672
back EMF, 382
balance mass, 847
balanced bridge, 707
bandwidth, 130, 160
bang-bang control, 560

910
Index
barrel distortion, 630
base frame, 847
BBN criteria, 699
beam splitter, 676
beam walkoÔ¨Ä, 831
bias voltage, 504
bimorph, 780
biquad, 317, 333
birefringence, 642
bistable, 726
bits, 324
bitstream, 742
black body, 596
black-box system identiÔ¨Åcation, 347
Bode plot, 116
Bode Sensitivity Integral, 291
boundary conditions, 28
branches, 707
breakdown voltage, 502
Brewster‚Äôs angle, 642
bridge-rectiÔ¨Åer, 495
brightness, 605
Butterworth, 538
C-core, 402
capacitance, 54
capacitors, 75, 470
carrier signal, 722
Cartesian coordinate system, 41
catadioptric, 617
catoptric, 617, 840
cats-eye, 810
causal, 328
cavity, 647
centre-frequency, 812
channel, 500
characteristic impedance, 90, 467, 745
characteristic polynomial, 339
charge ampliÔ¨Åer, 440
charge carriers, 54, 492
charge control, 450
charge redistribution, 743
charge-pumping, 575, 577
Chebyshev, 538
chief ray, 636
chromatic aberration, 629
circular polarised, 643
Class A, 506
clipping, 505, 566
closed-loop control, 241
closed-loop feedback accelerometer,
777
closed-Loop response, 256
coaxial cable, 713
coercive Ô¨Åeld strength, 368
cogging, 863
coherence, 601
coherence length, 602
coherence time, 602
collector follower, 507
collocated, 224, 237
Coma, 625
common collector, 504
common emitter, 507
common-mode rejection ratio, 512,
549
common-mode signal, 509
Compact Disc player, 6
Complementary Sensitivity, 256
compliance, 125, 149, 196
conditional stability, 286, 312
conductivity, 54
conservative systems, 49
constitutive equations, 435
constructive interference, 645
continuous-time, 320, 727
control force, 235, 269
controllability, 223, 347
converse piezoelectric eÔ¨Äect, 431
corkscrew, 379
corner-frequency, 474
cosine error, 825
counter EMF, 382
creep, 438
critical angle, 613
critical damping, 147, 152
critical damping coeÔ¨Écient, 143

Index
911
Critical Dimension, 664, 839
cross-coupling, 335
cross-over distortion, 506
Crown glass, 632
cube-corner retro-reÔ¨Çector, 810
Cumulative Amplitude Spectrum, 698
Cumulative Power Spectrum, 695
Cumulative Probability Function, 691
Curie temperature, 432
current gain, 497
current source, 62
current-drive, 461, 526, 555
cut-oÔ¨Äfrequency, 474
D-control, 274
damped natural frequency, 147, 151,
158
damped resonance frequency, 147,
158
damper-line, 136
Darlington-pair, 559
de-polarisation, 450
decimation Ô¨Ålter, 742
decoupling, 166
DeÔ¨Çectometer, 752
degree of freedom, 41, 335
demagnetisation graph, 368
departure, 626
depletion layer, 493
depletion-mode, 499
depth of Ô¨Åeld, 665
depth of focus, 665, 872
destructive interference, 645
diac, 502
diamagnetic, 364
dichroic coating, 648
die, 840
dielectric constant, 76
dielectric material, 434
diÔ¨Äerential-mode, 511
diÔ¨Äerential-to-single-ended, 718
diÔ¨Äraction, 594
diÔ¨Äraction limited, 661
digital-to-analogue, 321, 737
dioptric, 617
dipole, 75, 431
dirac-function, 110
direct band-gap, 599
direct piezoelectric eÔ¨Äect, 431
discrete components, 489, 554
Discrete Fourier-transform, 101
discrete-time, 335
discrete-time-domain, 234, 320
dispersion, 81, 631
distortion, 629
divergence, 57
Doppler shift, 816
dose-control, 665
double logarithmic, 117
double-telecentricity, 636
Drain electrode, 499
drift, 546
driving point measurement, 224
dual-ended, 578
dual-slope ADC, 735
Dutch School of Mechatronics, 20
duty-cycle modulation, 564
dynamic compliance, 134, 137
dynamic eigenmodes, 126
Dynamic Error Budgeting, 70, 691
dynamic impedance, 73
dynamic stiÔ¨Äness, 137
dynamics, 43
E-core, 402
eddy-current, 397
eÔ¨Äective modal mass, 176
eÔ¨Äective modal stiÔ¨Äness, 176
eigendynamics, 153
eigenfrequency, 42, 167, 172
eigenmodes, 42, 172
eigenvalue, 172
eigenvalues, 153, 339
eigenvector, 172, 181
electric load, 466
electric machine, 354
electric permittivity, 50, 76
electric signals, 66

912
Index
Electro Magnetic Compatibility, 554
electrodes, 60
electromagnetic actuator, 354
electromotive force, 59
electronically commutated, 388
electrostatic force, 50
elementary charge, 50
elliptical polarised, 643
emitter follower, 504
enhancement-mode, 499
entry-pupil, 635
equations of motion, 41, 72, 105
error signal, 235
etendue, 608
Euclidian space, 41
Euler‚Äôs formula, 72, 94
exit-pupil, 635
experimental modal analysis, 212
f-number, 662
Fabry-Perot, 603, 647
fading, 845
far Ô¨Åeld, 650
Faraday shield, 715
Faraday‚Äôs law, 58, 382
Fast Fourier-transform, 102
fast tool servo, 410
features, 839
Feedback-loop response, 257
Feedback-loop Transfer Function, 257
ferromagnetic, 362
Fibre Bragg Grating, 766
Ô¨Åducials, 870
Ô¨Åeld curvature, 629
Ô¨Åeld lines, 51
Ô¨Åeld plane, 629
Ô¨Ågure of merit, 392
Ô¨Åltered reference signal, 235
Ô¨Ånesse, 648
Finite Impulse Response, 326
Ô¨Årst-order, 153
Ô¨Çare, 625
Ô¨Çexure-scanner, 449
Ô¨Çicker noise, 701
Flint glass, 632
Ô¨Çoating, 524, 575
Ô¨Çoor vibrations, 695
Ô¨Çux-linkage, 381
focal plane, 629, 862
force frame, 848
force-constant, 379, 404
forced response, 147
four-quadrant detector, 750
four-quadrant operation, 557
Fourier coeÔ¨Écients, 94
Fourier series, 93
Fourier window, 100
Fourier-transform, 100, 105, 327
fourth-order, 164
free charges, 54
free electrons, 492
free response, 147
free-body diagram, 142
frequency combs, 821
frequency response, 72, 105, 141, 216
frequency spectrum, 70, 100, 596
frequency sweep, 115
frequency-domain, 70, 105, 141, 233
frequency-to-digital conversion, 726
fringes, 808
fringing Ô¨Çux, 373
Full-Width at Half-Maximum, 601
Gain Balancing, 881
gain margin, 262
Gain Scheduling, 230
gain-bandwidth product, 545
gain-scheduling, 265, 881
gang of four, 256
gang of six, 255
Gate electrode, 499
Gauss‚Äôs law magnetic, 58
Gauss‚Äôs law(electric, 57
Gaussian distribution, 692
generalised coordinate system, 41
geometric optics, 594
geometric stiÔ¨Äness matrix, 48
geophone, 772

Index
913
Gray code, 729
grey-box system identiÔ¨Åcation, 347
grid plate, 878
ground loop, 716
group delay, 539, 731
H-bridge, 578
H-drive, 14, 229, 861
half-pitch, 840
Hall eÔ¨Äect, 587
hard-switching, 581
Hartmann sensor, 676
Heisenberg uncertainty principle, 687
heterodyne interferometry, 811
holes, 492
homo-polar, 416
homodyne detection, 725
homodyne interferometer, 805
hot electrons, 497
hybrid reluctance, 409
hydraulic linear motors, 13
hysteresis, 367, 439
I-control, 280
idle current, 505
illumination power, 604
image plane, 619
image-space telecentric, 639
imaging, 617
immersion, 840, 883
impedance, 73
impulse response, 108
in Abbe, 836
in parallel, 411
in series, 413
independent, 174
indirect band-gap, 599
inductors, 75, 472
inertial velocity sensor, 772
InÔ¨Ånite Impulse Response, 326
innovation, 347
input-shaping, 234, 248
instrumentation ampliÔ¨Åer, 719
Insulated Gate Bipolar Transistor,
562
Integrated Circuits, 9
Integrator wind-up, 265
integrator wind-up, 292, 305
integrator windup, 296
intensity, 81
interference, 594, 644
interfering input, 689
interferometer, 646
interferometer constant, 807
intermediate image, 634
inverse piezoelectric eÔ¨Äect, 431
iris diaphragm, 635
irradiance, 82
Iterative Learning Control, 250
jerk, 293, 418
jitter, 323
k-one factor, 664
Kalman-Ô¨Ålter, 348
kinematics, 43
Lagrange equations of motion, 48
Laplace plane, 150
Laplace-domain, 105, 233
Laplace-plane, 106
Laplace-transform, 105
laser, 600
latch, 729
latency, 320, 731
LCR-Ô¨Ålter, 479
lead-lag compensation, 275
Least SigniÔ¨Åcant Bit, 324, 728
lensmakers equation, 622
Lenz‚Äôs law, 59
levelling, 872
limit-cycling, 296, 555
Linear Algebra, 41
linear polarised, 642
Linear Time-Invariant, 122, 141
Lissajous plot, 795
long tailed pair, 511
long-lead items, 33
long-stroke, 19, 862
longitudinal wave, 82
loop-gain, 257

914
Index
loop-shaping design, 266, 313
Lorentz actuator, 132
Lorentz force, 59
low-pass Ô¨Ålter, 154, 301, 321
magnetic bearing, 259
magnetic interference, 712
magnetic permeability, 56, 356
magnetomotive force, 59, 360
majority carriers, 497
marginally stable, 260
mass dilemma, 867, 884
mass-based, 267
measurand, 684
measured output motion, 235
measurement accuracy, 686
measurement error, 685
measurement precision, 686
measurement resolution, 687
measurement uncertainty, 686
measurement value, 235
Mechanical ampliÔ¨Åcation, 447
meridional plane, 628
metrology, 683
metrology frame, 834, 847
metrology loop, 835, 868
Miller capacitor, 542
minimal realisation, 347
minimum phase, 117
minority carriers, 497
mirage, 669
modal analysis, 109, 172
modal coordinate system, 42, 182
modal degree of freedom, 43, 182
modal force, 185, 189
modal mass, 172, 175
modal stiÔ¨Äness, 172, 175
mode-shape, 42, 172
model-based, 245
modiÔ¨Åed Edl√©n, 825
modifying input, 689
modulation, 722
modulus margin, 262
monotonicity, 739
Moore‚Äôs law, 843
Most SigniÔ¨Åcant Bit, 324, 728
motor voltage, 382
mover, 403
multi-lens array, 676
multi-sines, 116
Multiple Input Multiple Output, 335
N-material, 492
negative stiÔ¨Äness, 259, 408
Newton, 48
node, 92
noise, 66
non-collocated, 118, 178, 225
Non-Linear Time-Variable, 122
non-minimum phase, 117, 221, 226,
237
normal distribution, 692
notch Ô¨Ålter, 246, 485
notching, 313
NTC, 705
nulling, 776
Numerical Aperture, 662
Nyquist frequency, 733
Nyquist plot, 120
Nyquist Stability Theorem, 260
Nyquist-Shannon sampling theorem,
321, 733
object plane, 619
object-space telecentric, 639
observability, 223, 347
observer, 347
oÔ¨Ä-the-shelf, 34
oÔ¨Äset, 546
Ohm‚Äôs law, 55, 64
one-over-f (1/f ) noise, 701
Op-Amp, 512
open-loop, 118
open-loop control, 238
open-loop response, 257
Operational AmpliÔ¨Åers, 504
optical axis, 618
optical Ô¨Çats, 825
optical path diÔ¨Äerence, 804

Index
915
optical path length, 611, 614, 806
optical pick-up unit, 5
optical recording, 7
optical throughput, 608
order, 117, 140, 153, 237, 267
order and delivery, 33
over-hung, 386
overactuation, 884
overlay, 843
P-control, 132
parallel-resonant, 480
paramagnetic, 364
parasitic, 469, 471
paraxial rays, 619
pass-band, 474
path-planning, 234, 251
PD-control, 274
pedestal, 847
pentafoil, 674
periodic error, 822
permanent magnet biased, 409
Perovskite structure, 431
phase, 68
phase grating, 651
phase margin, 262
phase selective detection, 725
phase velocity, 81
phase-lag, 237
phase-lead, 274
photons, 595
physical optics, 594
PID-control, 234, 265
piezoelectric, 304
Piezoelectric Active Lens Mount, 854
piezoelectric gain, 436
piezoelectric scanner, 448
piezoelectric stack actuators, 444
piezoelectric transducer, 434
Piezoelectric tube actuator, 443
piezoresistivity, 767
Pincushion distortion, 630
pink noise, 70, 116
plant, 235
plant output motion, 235
platforms, 31
PN-junction, 493
point source, 605
point-spread function, 662
point-symmetric, 811
polarisability, 75
polarisation, 87, 431, 640
polarisation mixing, 822
polariser, 642
polarising beam splitter, 813
pole pieces, 371
pole-splitting, 545
pole-zero cancellation, 239, 316
poles, 105, 147, 149
poles and zeros, 106, 237
potential diÔ¨Äerence, 53
potentiometer, 465
Power Spectral Density, 695
power supply rejection ratio, 549
Pre-loading, 446
Precision Engineering, 19
Preisach model, 440
primary standards, 688
printed circuit board, 470
prism, 674
Probability Density Function, 691
Process Sensitivity, 256, 454
product creation process, 27
propagation, 81
proper, 107
Proportional DiÔ¨Äerential control, 274
proportional gain factor, 133, 268
proximity detector, 748
pulse-width modulation, 564
pupil, 635
pupil plane, 629, 638
purple fringing, 631
Push Pull class AB, 507
Push-Pull class B, 506
quad-cell, 750
quadrafoil, 674
quadrature detection, 793, 811, 818

916
Index
quality factor, 144
quantisation, 321
quantisation error, 728
quarter wave plate, 812
R-2R ladder-network, 737
race track coil, 385
radial order, 672
radiance, 600, 605
radiant emittance, 605
radiant Ô¨Çux, 604
radiant intensity, 82
random errors, 686
ray tracing, 622
RC-Ô¨Ålter, 474
reactive impedance, 74
real force, 235
real value, 685
real-time, 102, 877
receiver, 746
recombination, 493
reference signal, 235
reÔ¨Çection, 89, 594
refraction, 594
Reluctance, 360
reluctance actuator, 402
reluctance force, 395
remanent Ô¨Çux density, 368
reproduceability, 687
requirement budgeting, 29
resistivity, 54
resonance, 91
resonant-mode, 581
reticle, 10, 665
reticlestage, 841
reverse-recovery time, 582
right hand, 379
rigid-body mode, 176, 194
road mapping, 31
robustness, 243
roll-oÔ¨Äfrequency, 139, 278
root of the sum of squares, 694
root-locus, 308
rotation, 57
safety ground, 716
sagittal plane, 628
Sallen-Key, 535
sample-and-hold, 731
samples, 730
saturation, 293
scanner bow, 449
Schmitt trigger, 514, 569
Schottky diodes, 582
Scrum, 37
secondary breakdown, 562
secondary trefoil, 674
seismic mass, 772
selective ampliÔ¨Åer, 722
self-inductance, 398
self-oscillation, 564
Sensitivity, 256, 454
serial scanner, 449
series-resonant, 483
servo-stiÔ¨Äness, 133, 270
servo-system, 6
servo-valves, 13
settle time, 292, 881
Shack-Hartmann, 676
shadow mask, 12
shape-function, 172
Shielded Twisted Pair, 716
short-stroke, 862
side-bands, 724
side-lobes, 103
Sigma-Delta converter, 735
signal, 66
Silicon Repeater, 2
Single Input Single Output, 238
single-ended, 506, 567
single-input single-output, 241
single-phase, 580
skyhook, 851
slew-rate, 293, 546
slit, 841
smart-disk, 854
snap, 250, 293, 421
solid-state lamps, 599

Index
917
Source electrode, 499
space, 335
spatial coherence, 602
spatial frequency, 659
speciÔ¨Åc peak force, 866
speckle, 602
spectral leaking, 103
spectrum, 96, 101
Spectrum Analyser, 102
Spherical Aberration, 625
split-frequency, 812
spring constant, 46, 126
spring-line, 135
Sprints, 37
standard deviation, 692
standing wave, 90
star conÔ¨Åguration, 589
state estimator, 347
state feedback, 340, 344
state-space, 234, 335
state-variables, 335
statics, 43
stator, 403
steady state, 265
Steepness, 392
step response, 108
stiÔ¨Äness, 46
stiÔ¨Äness-line, 135
stimulus, 105
stops, 662
strain gage, 705
Strehl ratio, 662
strictly proper, 107, 237
successive-approximation, 735
super-capacitors, 471
super-spring, 281, 343
Surface Mount Devices, 470
suspension mode, 207
switched-mode, 559
synchronous demodulation, 722
System IdentiÔ¨Åcation, 347
systematic eÔ¨Äects, 70
systematic errors, 686
tamed PD-control, 275
tangential plane, 628
tangential rays, 628
temporal coherence, 602
temporal frequency, 66
temporal or spatial variability, 66
terminals, 60
thermal-centre, 757
thin-lens equation, 622
three-phase, 388
throughput, 844
thyristor, 502
Time Division Multiplexing, 771
time-domain, 70, 105, 233
total quality, 33
traceability, 683, 869
Trait ¬¥e de la lumi `ere, 648
trajectory proÔ¨Åle generation, 251
transconductance, 523
transfer function, 105, 141
transimpedance, 522
transmissibility, 126, 134
transmission-line, 744
transversal wave, 82
trefoil, 674
triac, 502
triangulation, 752
tripod-scanner, 449
tuned-mass damper, 300, 855
tunnelling, 502
Tustin‚Äôs method, 334
unbound charges, 56
undamped natural frequency, 128,
132
undamped resonance frequency, 144
under-hung, 388
unity-gain cross-over frequency, 120,
260, 269
Unshielded Twisted Pair, 713
unstable zeros, 237
V-model of systems engineering, 23
variable reluctance force, 395
vector margin, 262

918
Index
Vernier, 796, 871
vias, 843
vibration isolation, 161, 695, 847
Video Long Play Disk, 2
vignetting, 639
virgin curve, 367
virtual focal-point, 622
virtual ground, 520
virtual image, 624
virtual work, 48
voice coil, 385
voltage, 53
voltage controlled, 450
voltage source, 60
voltage-drive, 555
wafer chuck, 841
wafer fab, 847
wafer table, 841, 879
waferstage, 13, 841
warping problem, 334
waterbed eÔ¨Äect, 265, 290
wave function, 80
wave vector, 81
wave-guide, 744
wavefront, 614
wavefront error, 671
wavelength, 81
Wavelength Division Multiplexing,
770
wavelength tracker, 827
wavenumber, 81, 595, 826
Weiss domains, 366, 432
Wheatstone bridge, 706
white noise, 70, 116, 700
window function, 103
Z-domain, 320
Z-transform, 326
zener diode, 502
Zernike polynomials, 671
zero-stiÔ¨Äness, 20, 265, 267, 857
zeros, 105, 221
zoom lens, 634

blank
left
intentionally
page
This

